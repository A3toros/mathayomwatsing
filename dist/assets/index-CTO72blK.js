var RP=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ire=RP((mre,By)=>{function C3(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Uy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Cp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Uv={exports:{}},Tg={},$v={exports:{}},Hr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wk;function DP(){if(wk)return Hr;wk=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),i=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function g(q){return q===null||typeof q!="object"?null:(q=p&&q[p]||q["@@iterator"],typeof q=="function"?q:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,_={};function b(q,L,M){this.props=q,this.context=L,this.refs=_,this.updater=M||y}b.prototype.isReactComponent={},b.prototype.setState=function(q,L){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,L,"setState")},b.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function N(){}N.prototype=b.prototype;function k(q,L,M){this.props=q,this.context=L,this.refs=_,this.updater=M||y}var w=k.prototype=new N;w.constructor=k,v(w,b.prototype),w.isPureReactComponent=!0;var T=Array.isArray,A=Object.prototype.hasOwnProperty,F={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function E(q,L,M){var X,K={},Z=null,J=null;if(L!=null)for(X in L.ref!==void 0&&(J=L.ref),L.key!==void 0&&(Z=""+L.key),L)A.call(L,X)&&!R.hasOwnProperty(X)&&(K[X]=L[X]);var ne=arguments.length-2;if(ne===1)K.children=M;else if(1<ne){for(var me=Array(ne),xe=0;xe<ne;xe++)me[xe]=arguments[xe+2];K.children=me}if(q&&q.defaultProps)for(X in ne=q.defaultProps,ne)K[X]===void 0&&(K[X]=ne[X]);return{$$typeof:e,type:q,key:Z,ref:J,props:K,_owner:F.current}}function D(q,L){return{$$typeof:e,type:q.type,key:L,ref:q.ref,props:q.props,_owner:q._owner}}function I(q){return typeof q=="object"&&q!==null&&q.$$typeof===e}function G(q){var L={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(M){return L[M]})}var Y=/\/+/g;function ee(q,L){return typeof q=="object"&&q!==null&&q.key!=null?G(""+q.key):L.toString(36)}function ie(q,L,M,X,K){var Z=typeof q;(Z==="undefined"||Z==="boolean")&&(q=null);var J=!1;if(q===null)J=!0;else switch(Z){case"string":case"number":J=!0;break;case"object":switch(q.$$typeof){case e:case t:J=!0}}if(J)return J=q,K=K(J),q=X===""?"."+ee(J,0):X,T(K)?(M="",q!=null&&(M=q.replace(Y,"$&/")+"/"),ie(K,L,M,"",function(xe){return xe})):K!=null&&(I(K)&&(K=D(K,M+(!K.key||J&&J.key===K.key?"":(""+K.key).replace(Y,"$&/")+"/")+q)),L.push(K)),1;if(J=0,X=X===""?".":X+":",T(q))for(var ne=0;ne<q.length;ne++){Z=q[ne];var me=X+ee(Z,ne);J+=ie(Z,L,M,me,K)}else if(me=g(q),typeof me=="function")for(q=me.call(q),ne=0;!(Z=q.next()).done;)Z=Z.value,me=X+ee(Z,ne++),J+=ie(Z,L,M,me,K);else if(Z==="object")throw L=String(q),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.");return J}function re(q,L,M){if(q==null)return q;var X=[],K=0;return ie(q,X,"","",function(Z){return L.call(M,Z,K++)}),X}function se(q){if(q._status===-1){var L=q._result;L=L(),L.then(function(M){(q._status===0||q._status===-1)&&(q._status=1,q._result=M)},function(M){(q._status===0||q._status===-1)&&(q._status=2,q._result=M)}),q._status===-1&&(q._status=0,q._result=L)}if(q._status===1)return q._result.default;throw q._result}var B={current:null},z={transition:null},U={ReactCurrentDispatcher:B,ReactCurrentBatchConfig:z,ReactCurrentOwner:F};function V(){throw Error("act(...) is not supported in production builds of React.")}return Hr.Children={map:re,forEach:function(q,L,M){re(q,function(){L.apply(this,arguments)},M)},count:function(q){var L=0;return re(q,function(){L++}),L},toArray:function(q){return re(q,function(L){return L})||[]},only:function(q){if(!I(q))throw Error("React.Children.only expected to receive a single React element child.");return q}},Hr.Component=b,Hr.Fragment=r,Hr.Profiler=s,Hr.PureComponent=k,Hr.StrictMode=n,Hr.Suspense=c,Hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U,Hr.act=V,Hr.cloneElement=function(q,L,M){if(q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+q+".");var X=v({},q.props),K=q.key,Z=q.ref,J=q._owner;if(L!=null){if(L.ref!==void 0&&(Z=L.ref,J=F.current),L.key!==void 0&&(K=""+L.key),q.type&&q.type.defaultProps)var ne=q.type.defaultProps;for(me in L)A.call(L,me)&&!R.hasOwnProperty(me)&&(X[me]=L[me]===void 0&&ne!==void 0?ne[me]:L[me])}var me=arguments.length-2;if(me===1)X.children=M;else if(1<me){ne=Array(me);for(var xe=0;xe<me;xe++)ne[xe]=arguments[xe+2];X.children=ne}return{$$typeof:e,type:q.type,key:K,ref:Z,props:X,_owner:J}},Hr.createContext=function(q){return q={$$typeof:i,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},q.Provider={$$typeof:a,_context:q},q.Consumer=q},Hr.createElement=E,Hr.createFactory=function(q){var L=E.bind(null,q);return L.type=q,L},Hr.createRef=function(){return{current:null}},Hr.forwardRef=function(q){return{$$typeof:l,render:q}},Hr.isValidElement=I,Hr.lazy=function(q){return{$$typeof:f,_payload:{_status:-1,_result:q},_init:se}},Hr.memo=function(q,L){return{$$typeof:d,type:q,compare:L===void 0?null:L}},Hr.startTransition=function(q){var L=z.transition;z.transition={};try{q()}finally{z.transition=L}},Hr.unstable_act=V,Hr.useCallback=function(q,L){return B.current.useCallback(q,L)},Hr.useContext=function(q){return B.current.useContext(q)},Hr.useDebugValue=function(){},Hr.useDeferredValue=function(q){return B.current.useDeferredValue(q)},Hr.useEffect=function(q,L){return B.current.useEffect(q,L)},Hr.useId=function(){return B.current.useId()},Hr.useImperativeHandle=function(q,L,M){return B.current.useImperativeHandle(q,L,M)},Hr.useInsertionEffect=function(q,L){return B.current.useInsertionEffect(q,L)},Hr.useLayoutEffect=function(q,L){return B.current.useLayoutEffect(q,L)},Hr.useMemo=function(q,L){return B.current.useMemo(q,L)},Hr.useReducer=function(q,L,M){return B.current.useReducer(q,L,M)},Hr.useRef=function(q){return B.current.useRef(q)},Hr.useState=function(q){return B.current.useState(q)},Hr.useSyncExternalStore=function(q,L,M){return B.current.useSyncExternalStore(q,L,M)},Hr.useTransition=function(){return B.current.useTransition()},Hr.version="18.3.1",Hr}var _k;function E1(){return _k||(_k=1,$v.exports=DP()),$v.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bk;function IP(){if(bk)return Tg;bk=1;var e=E1(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function i(l,c,d){var f,p={},g=null,y=null;d!==void 0&&(g=""+d),c.key!==void 0&&(g=""+c.key),c.ref!==void 0&&(y=c.ref);for(f in c)n.call(c,f)&&!a.hasOwnProperty(f)&&(p[f]=c[f]);if(l&&l.defaultProps)for(f in c=l.defaultProps,c)p[f]===void 0&&(p[f]=c[f]);return{$$typeof:t,type:l,key:g,ref:y,props:p,_owner:s.current}}return Tg.Fragment=r,Tg.jsx=i,Tg.jsxs=i,Tg}var Sk;function MP(){return Sk||(Sk=1,Uv.exports=IP()),Uv.exports}var o=MP(),C=E1();const us=Cp(C),OP=C3({__proto__:null,default:us},[C]);var ty={},Wv={exports:{}},Si={},zv={exports:{}},Hv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kk;function LP(){return kk||(kk=1,(function(e){function t(z,U){var V=z.length;z.push(U);e:for(;0<V;){var q=V-1>>>1,L=z[q];if(0<s(L,U))z[q]=U,z[V]=L,V=q;else break e}}function r(z){return z.length===0?null:z[0]}function n(z){if(z.length===0)return null;var U=z[0],V=z.pop();if(V!==U){z[0]=V;e:for(var q=0,L=z.length,M=L>>>1;q<M;){var X=2*(q+1)-1,K=z[X],Z=X+1,J=z[Z];if(0>s(K,V))Z<L&&0>s(J,K)?(z[q]=J,z[Z]=V,q=Z):(z[q]=K,z[X]=V,q=X);else if(Z<L&&0>s(J,V))z[q]=J,z[Z]=V,q=Z;else break e}}return U}function s(z,U){var V=z.sortIndex-U.sortIndex;return V!==0?V:z.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var c=[],d=[],f=1,p=null,g=3,y=!1,v=!1,_=!1,b=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(z){for(var U=r(d);U!==null;){if(U.callback===null)n(d);else if(U.startTime<=z)n(d),U.sortIndex=U.expirationTime,t(c,U);else break;U=r(d)}}function T(z){if(_=!1,w(z),!v)if(r(c)!==null)v=!0,se(A);else{var U=r(d);U!==null&&B(T,U.startTime-z)}}function A(z,U){v=!1,_&&(_=!1,N(E),E=-1),y=!0;var V=g;try{for(w(U),p=r(c);p!==null&&(!(p.expirationTime>U)||z&&!G());){var q=p.callback;if(typeof q=="function"){p.callback=null,g=p.priorityLevel;var L=q(p.expirationTime<=U);U=e.unstable_now(),typeof L=="function"?p.callback=L:p===r(c)&&n(c),w(U)}else n(c);p=r(c)}if(p!==null)var M=!0;else{var X=r(d);X!==null&&B(T,X.startTime-U),M=!1}return M}finally{p=null,g=V,y=!1}}var F=!1,R=null,E=-1,D=5,I=-1;function G(){return!(e.unstable_now()-I<D)}function Y(){if(R!==null){var z=e.unstable_now();I=z;var U=!0;try{U=R(!0,z)}finally{U?ee():(F=!1,R=null)}}else F=!1}var ee;if(typeof k=="function")ee=function(){k(Y)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,re=ie.port2;ie.port1.onmessage=Y,ee=function(){re.postMessage(null)}}else ee=function(){b(Y,0)};function se(z){R=z,F||(F=!0,ee())}function B(z,U){E=b(function(){z(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(z){z.callback=null},e.unstable_continueExecution=function(){v||y||(v=!0,se(A))},e.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<z?Math.floor(1e3/z):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(z){switch(g){case 1:case 2:case 3:var U=3;break;default:U=g}var V=g;g=U;try{return z()}finally{g=V}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(z,U){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var V=g;g=z;try{return U()}finally{g=V}},e.unstable_scheduleCallback=function(z,U,V){var q=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?q+V:q):V=q,z){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=V+L,z={id:f++,callback:U,priorityLevel:z,startTime:V,expirationTime:L,sortIndex:-1},V>q?(z.sortIndex=V,t(d,z),r(c)===null&&z===r(d)&&(_?(N(E),E=-1):_=!0,B(T,V-q))):(z.sortIndex=L,t(c,z),v||y||(v=!0,se(A))),z},e.unstable_shouldYield=G,e.unstable_wrapCallback=function(z){var U=g;return function(){var V=g;g=U;try{return z.apply(this,arguments)}finally{g=V}}}})(Hv)),Hv}var Ck;function w2(){return Ck||(Ck=1,zv.exports=LP()),zv.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tk;function BP(){if(Tk)return Si;Tk=1;var e=E1(),t=w2();function r(u){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+u,S=1;S<arguments.length;S++)h+="&args[]="+encodeURIComponent(arguments[S]);return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function a(u,h){i(u,h),i(u+"Capture",h)}function i(u,h){for(s[u]=h,u=0;u<h.length;u++)n.add(h[u])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(u){return c.call(p,u)?!0:c.call(f,u)?!1:d.test(u)?p[u]=!0:(f[u]=!0,!1)}function y(u,h,S,P){if(S!==null&&S.type===0)return!1;switch(typeof h){case"function":case"symbol":return!0;case"boolean":return P?!1:S!==null?!S.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function v(u,h,S,P){if(h===null||typeof h>"u"||y(u,h,S,P))return!0;if(P)return!1;if(S!==null)switch(S.type){case 3:return!h;case 4:return h===!1;case 5:return isNaN(h);case 6:return isNaN(h)||1>h}return!1}function _(u,h,S,P,W,Q,de){this.acceptsBooleans=h===2||h===3||h===4,this.attributeName=P,this.attributeNamespace=W,this.mustUseProperty=S,this.propertyName=u,this.type=h,this.sanitizeURL=Q,this.removeEmptyString=de}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){b[u]=new _(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var h=u[0];b[h]=new _(h,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){b[u]=new _(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){b[u]=new _(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){b[u]=new _(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){b[u]=new _(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){b[u]=new _(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){b[u]=new _(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){b[u]=new _(u,5,!1,u.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function k(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var h=u.replace(N,k);b[h]=new _(h,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var h=u.replace(N,k);b[h]=new _(h,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var h=u.replace(N,k);b[h]=new _(h,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){b[u]=new _(u,1,!1,u.toLowerCase(),null,!1,!1)}),b.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){b[u]=new _(u,1,!1,u.toLowerCase(),null,!0,!0)});function w(u,h,S,P){var W=b.hasOwnProperty(h)?b[h]:null;(W!==null?W.type!==0:P||!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(v(h,S,W,P)&&(S=null),P||W===null?g(h)&&(S===null?u.removeAttribute(h):u.setAttribute(h,""+S)):W.mustUseProperty?u[W.propertyName]=S===null?W.type===3?!1:"":S:(h=W.attributeName,P=W.attributeNamespace,S===null?u.removeAttribute(h):(W=W.type,S=W===3||W===4&&S===!0?"":""+S,P?u.setAttributeNS(P,h,S):u.setAttribute(h,S))))}var T=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A=Symbol.for("react.element"),F=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),G=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),ee=Symbol.for("react.suspense"),ie=Symbol.for("react.suspense_list"),re=Symbol.for("react.memo"),se=Symbol.for("react.lazy"),B=Symbol.for("react.offscreen"),z=Symbol.iterator;function U(u){return u===null||typeof u!="object"?null:(u=z&&u[z]||u["@@iterator"],typeof u=="function"?u:null)}var V=Object.assign,q;function L(u){if(q===void 0)try{throw Error()}catch(S){var h=S.stack.trim().match(/\n( *(at )?)/);q=h&&h[1]||""}return`
`+q+u}var M=!1;function X(u,h){if(!u||M)return"";M=!0;var S=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(ot){var P=ot}Reflect.construct(u,[],h)}else{try{h.call()}catch(ot){P=ot}u.call(h.prototype)}else{try{throw Error()}catch(ot){P=ot}u()}}catch(ot){if(ot&&P&&typeof ot.stack=="string"){for(var W=ot.stack.split(`
`),Q=P.stack.split(`
`),de=W.length-1,Ae=Q.length-1;1<=de&&0<=Ae&&W[de]!==Q[Ae];)Ae--;for(;1<=de&&0<=Ae;de--,Ae--)if(W[de]!==Q[Ae]){if(de!==1||Ae!==1)do if(de--,Ae--,0>Ae||W[de]!==Q[Ae]){var Re=`
`+W[de].replace(" at new "," at ");return u.displayName&&Re.includes("<anonymous>")&&(Re=Re.replace("<anonymous>",u.displayName)),Re}while(1<=de&&0<=Ae);break}}}finally{M=!1,Error.prepareStackTrace=S}return(u=u?u.displayName||u.name:"")?L(u):""}function K(u){switch(u.tag){case 5:return L(u.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return u=X(u.type,!1),u;case 11:return u=X(u.type.render,!1),u;case 1:return u=X(u.type,!0),u;default:return""}}function Z(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case R:return"Fragment";case F:return"Portal";case D:return"Profiler";case E:return"StrictMode";case ee:return"Suspense";case ie:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case G:return(u.displayName||"Context")+".Consumer";case I:return(u._context.displayName||"Context")+".Provider";case Y:var h=u.render;return u=u.displayName,u||(u=h.displayName||h.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case re:return h=u.displayName||null,h!==null?h:Z(u.type)||"Memo";case se:h=u._payload,u=u._init;try{return Z(u(h))}catch{}}return null}function J(u){var h=u.type;switch(u.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=h.render,u=u.displayName||u.name||"",h.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Z(h);case 8:return h===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function ne(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function me(u){var h=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function xe(u){var h=me(u)?"checked":"value",S=Object.getOwnPropertyDescriptor(u.constructor.prototype,h),P=""+u[h];if(!u.hasOwnProperty(h)&&typeof S<"u"&&typeof S.get=="function"&&typeof S.set=="function"){var W=S.get,Q=S.set;return Object.defineProperty(u,h,{configurable:!0,get:function(){return W.call(this)},set:function(de){P=""+de,Q.call(this,de)}}),Object.defineProperty(u,h,{enumerable:S.enumerable}),{getValue:function(){return P},setValue:function(de){P=""+de},stopTracking:function(){u._valueTracker=null,delete u[h]}}}}function Ne(u){u._valueTracker||(u._valueTracker=xe(u))}function le(u){if(!u)return!1;var h=u._valueTracker;if(!h)return!0;var S=h.getValue(),P="";return u&&(P=me(u)?u.checked?"true":"false":u.value),u=P,u!==S?(h.setValue(u),!0):!1}function ge(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function Ue(u,h){var S=h.checked;return V({},h,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:S??u._wrapperState.initialChecked})}function Ge(u,h){var S=h.defaultValue==null?"":h.defaultValue,P=h.checked!=null?h.checked:h.defaultChecked;S=ne(h.value!=null?h.value:S),u._wrapperState={initialChecked:P,initialValue:S,controlled:h.type==="checkbox"||h.type==="radio"?h.checked!=null:h.value!=null}}function Je(u,h){h=h.checked,h!=null&&w(u,"checked",h,!1)}function He(u,h){Je(u,h);var S=ne(h.value),P=h.type;if(S!=null)P==="number"?(S===0&&u.value===""||u.value!=S)&&(u.value=""+S):u.value!==""+S&&(u.value=""+S);else if(P==="submit"||P==="reset"){u.removeAttribute("value");return}h.hasOwnProperty("value")?rt(u,h.type,S):h.hasOwnProperty("defaultValue")&&rt(u,h.type,ne(h.defaultValue)),h.checked==null&&h.defaultChecked!=null&&(u.defaultChecked=!!h.defaultChecked)}function Ft(u,h,S){if(h.hasOwnProperty("value")||h.hasOwnProperty("defaultValue")){var P=h.type;if(!(P!=="submit"&&P!=="reset"||h.value!==void 0&&h.value!==null))return;h=""+u._wrapperState.initialValue,S||h===u.value||(u.value=h),u.defaultValue=h}S=u.name,S!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,S!==""&&(u.name=S)}function rt(u,h,S){(h!=="number"||ge(u.ownerDocument)!==u)&&(S==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+S&&(u.defaultValue=""+S))}var Ie=Array.isArray;function Pe(u,h,S,P){if(u=u.options,h){h={};for(var W=0;W<S.length;W++)h["$"+S[W]]=!0;for(S=0;S<u.length;S++)W=h.hasOwnProperty("$"+u[S].value),u[S].selected!==W&&(u[S].selected=W),W&&P&&(u[S].defaultSelected=!0)}else{for(S=""+ne(S),h=null,W=0;W<u.length;W++){if(u[W].value===S){u[W].selected=!0,P&&(u[W].defaultSelected=!0);return}h!==null||u[W].disabled||(h=u[W])}h!==null&&(h.selected=!0)}}function Qe(u,h){if(h.dangerouslySetInnerHTML!=null)throw Error(r(91));return V({},h,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function _t(u,h){var S=h.value;if(S==null){if(S=h.children,h=h.defaultValue,S!=null){if(h!=null)throw Error(r(92));if(Ie(S)){if(1<S.length)throw Error(r(93));S=S[0]}h=S}h==null&&(h=""),S=h}u._wrapperState={initialValue:ne(S)}}function gt(u,h){var S=ne(h.value),P=ne(h.defaultValue);S!=null&&(S=""+S,S!==u.value&&(u.value=S),h.defaultValue==null&&u.defaultValue!==S&&(u.defaultValue=S)),P!=null&&(u.defaultValue=""+P)}function Bt(u){var h=u.textContent;h===u._wrapperState.initialValue&&h!==""&&h!==null&&(u.value=h)}function Ut(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function it(u,h){return u==null||u==="http://www.w3.org/1999/xhtml"?Ut(h):u==="http://www.w3.org/2000/svg"&&h==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var Ye,xt=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(h,S,P,W){MSApp.execUnsafeLocalFunction(function(){return u(h,S,P,W)})}:u})(function(u,h){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=h;else{for(Ye=Ye||document.createElement("div"),Ye.innerHTML="<svg>"+h.valueOf().toString()+"</svg>",h=Ye.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;h.firstChild;)u.appendChild(h.firstChild)}});function ut(u,h){if(h){var S=u.firstChild;if(S&&S===u.lastChild&&S.nodeType===3){S.nodeValue=h;return}}u.textContent=h}var wt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$t=["Webkit","ms","Moz","O"];Object.keys(wt).forEach(function(u){$t.forEach(function(h){h=h+u.charAt(0).toUpperCase()+u.substring(1),wt[h]=wt[u]})});function Kt(u,h,S){return h==null||typeof h=="boolean"||h===""?"":S||typeof h!="number"||h===0||wt.hasOwnProperty(u)&&wt[u]?(""+h).trim():h+"px"}function De(u,h){u=u.style;for(var S in h)if(h.hasOwnProperty(S)){var P=S.indexOf("--")===0,W=Kt(S,h[S],P);S==="float"&&(S="cssFloat"),P?u.setProperty(S,W):u[S]=W}}var ct=V({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mt(u,h){if(h){if(ct[u]&&(h.children!=null||h.dangerouslySetInnerHTML!=null))throw Error(r(137,u));if(h.dangerouslySetInnerHTML!=null){if(h.children!=null)throw Error(r(60));if(typeof h.dangerouslySetInnerHTML!="object"||!("__html"in h.dangerouslySetInnerHTML))throw Error(r(61))}if(h.style!=null&&typeof h.style!="object")throw Error(r(62))}}function At(u,h){if(u.indexOf("-")===-1)return typeof h.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lt=null;function rr(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Ee=null,we=null,fe=null;function _e(u){if(u=pd(u)){if(typeof Ee!="function")throw Error(r(280));var h=u.stateNode;h&&(h=js(h),Ee(u.stateNode,u.type,h))}}function $e(u){we?fe?fe.push(u):fe=[u]:we=u}function St(){if(we){var u=we,h=fe;if(fe=we=null,_e(u),h)for(u=0;u<h.length;u++)_e(h[u])}}function pt(u,h){return u(h)}function Xt(){}var Jt=!1;function Yt(u,h,S){if(Jt)return u(h,S);Jt=!0;try{return pt(u,h,S)}finally{Jt=!1,(we!==null||fe!==null)&&(Xt(),St())}}function pr(u,h){var S=u.stateNode;if(S===null)return null;var P=js(S);if(P===null)return null;S=P[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(P=!P.disabled)||(u=u.type,P=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!P;break e;default:u=!1}if(u)return null;if(S&&typeof S!="function")throw Error(r(231,h,typeof S));return S}var Ir=!1;if(l)try{var xr={};Object.defineProperty(xr,"passive",{get:function(){Ir=!0}}),window.addEventListener("test",xr,xr),window.removeEventListener("test",xr,xr)}catch{Ir=!1}function Tr(u,h,S,P,W,Q,de,Ae,Re){var ot=Array.prototype.slice.call(arguments,3);try{h.apply(S,ot)}catch(Nt){this.onError(Nt)}}var Mr=!1,Wr=null,ce=!1,Se=null,pe={onError:function(u){Mr=!0,Wr=u}};function ve(u,h,S,P,W,Q,de,Ae,Re){Mr=!1,Wr=null,Tr.apply(pe,arguments)}function be(u,h,S,P,W,Q,de,Ae,Re){if(ve.apply(this,arguments),Mr){if(Mr){var ot=Wr;Mr=!1,Wr=null}else throw Error(r(198));ce||(ce=!0,Se=ot)}}function ke(u){var h=u,S=u;if(u.alternate)for(;h.return;)h=h.return;else{u=h;do h=u,(h.flags&4098)!==0&&(S=h.return),u=h.return;while(u)}return h.tag===3?S:null}function We(u){if(u.tag===13){var h=u.memoizedState;if(h===null&&(u=u.alternate,u!==null&&(h=u.memoizedState)),h!==null)return h.dehydrated}return null}function dt(u){if(ke(u)!==u)throw Error(r(188))}function Ve(u){var h=u.alternate;if(!h){if(h=ke(u),h===null)throw Error(r(188));return h!==u?null:u}for(var S=u,P=h;;){var W=S.return;if(W===null)break;var Q=W.alternate;if(Q===null){if(P=W.return,P!==null){S=P;continue}break}if(W.child===Q.child){for(Q=W.child;Q;){if(Q===S)return dt(W),u;if(Q===P)return dt(W),h;Q=Q.sibling}throw Error(r(188))}if(S.return!==P.return)S=W,P=Q;else{for(var de=!1,Ae=W.child;Ae;){if(Ae===S){de=!0,S=W,P=Q;break}if(Ae===P){de=!0,P=W,S=Q;break}Ae=Ae.sibling}if(!de){for(Ae=Q.child;Ae;){if(Ae===S){de=!0,S=Q,P=W;break}if(Ae===P){de=!0,P=Q,S=W;break}Ae=Ae.sibling}if(!de)throw Error(r(189))}}if(S.alternate!==P)throw Error(r(190))}if(S.tag!==3)throw Error(r(188));return S.stateNode.current===S?u:h}function oe(u){return u=Ve(u),u!==null?he(u):null}function he(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var h=he(u);if(h!==null)return h;u=u.sibling}return null}var Te=t.unstable_scheduleCallback,je=t.unstable_cancelCallback,qe=t.unstable_shouldYield,at=t.unstable_requestPaint,Le=t.unstable_now,Ct=t.unstable_getCurrentPriorityLevel,Mt=t.unstable_ImmediatePriority,Vt=t.unstable_UserBlockingPriority,dr=t.unstable_NormalPriority,Nn=t.unstable_LowPriority,ln=t.unstable_IdlePriority,In=null,Pr=null;function Or(u){if(Pr&&typeof Pr.onCommitFiberRoot=="function")try{Pr.onCommitFiberRoot(In,u,void 0,(u.current.flags&128)===128)}catch{}}var cr=Math.clz32?Math.clz32:Ce,ae=Math.log,ue=Math.LN2;function Ce(u){return u>>>=0,u===0?32:31-(ae(u)/ue|0)|0}var Oe=64,Xe=4194304;function It(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function ht(u,h){var S=u.pendingLanes;if(S===0)return 0;var P=0,W=u.suspendedLanes,Q=u.pingedLanes,de=S&268435455;if(de!==0){var Ae=de&~W;Ae!==0?P=It(Ae):(Q&=de,Q!==0&&(P=It(Q)))}else de=S&~W,de!==0?P=It(de):Q!==0&&(P=It(Q));if(P===0)return 0;if(h!==0&&h!==P&&(h&W)===0&&(W=P&-P,Q=h&-h,W>=Q||W===16&&(Q&4194240)!==0))return h;if((P&4)!==0&&(P|=S&16),h=u.entangledLanes,h!==0)for(u=u.entanglements,h&=P;0<h;)S=31-cr(h),W=1<<S,P|=u[S],h&=~W;return P}function fr(u,h){switch(u){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mr(u,h){for(var S=u.suspendedLanes,P=u.pingedLanes,W=u.expirationTimes,Q=u.pendingLanes;0<Q;){var de=31-cr(Q),Ae=1<<de,Re=W[de];Re===-1?((Ae&S)===0||(Ae&P)!==0)&&(W[de]=fr(Ae,h)):Re<=h&&(u.expiredLanes|=Ae),Q&=~Ae}}function nt(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function jt(){var u=Oe;return Oe<<=1,(Oe&4194240)===0&&(Oe=64),u}function er(u){for(var h=[],S=0;31>S;S++)h.push(u);return h}function un(u,h,S){u.pendingLanes|=h,h!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,h=31-cr(h),u[h]=S}function Xn(u,h){var S=u.pendingLanes&~h;u.pendingLanes=h,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=h,u.mutableReadLanes&=h,u.entangledLanes&=h,h=u.entanglements;var P=u.eventTimes;for(u=u.expirationTimes;0<S;){var W=31-cr(S),Q=1<<W;h[W]=0,P[W]=-1,u[W]=-1,S&=~Q}}function Mn(u,h){var S=u.entangledLanes|=h;for(u=u.entanglements;S;){var P=31-cr(S),W=1<<P;W&h|u[P]&h&&(u[P]|=h),S&=~W}}var sr=0;function dn(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var Yn,Lr,Nf,rx,Af,jf=!1,Lc=[],mi=null,rl=null,Yi=null,zr=new Map,Bc=new Map,Ji=[],nx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sx(u,h){switch(u){case"focusin":case"focusout":mi=null;break;case"dragenter":case"dragleave":rl=null;break;case"mouseover":case"mouseout":Yi=null;break;case"pointerover":case"pointerout":zr.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bc.delete(h.pointerId)}}function rd(u,h,S,P,W,Q){return u===null||u.nativeEvent!==Q?(u={blockedOn:h,domEventName:S,eventSystemFlags:P,nativeEvent:Q,targetContainers:[W]},h!==null&&(h=pd(h),h!==null&&Lr(h)),u):(u.eventSystemFlags|=P,h=u.targetContainers,W!==null&&h.indexOf(W)===-1&&h.push(W),u)}function Ns(u,h,S,P,W){switch(h){case"focusin":return mi=rd(mi,u,h,S,P,W),!0;case"dragenter":return rl=rd(rl,u,h,S,P,W),!0;case"mouseover":return Yi=rd(Yi,u,h,S,P,W),!0;case"pointerover":var Q=W.pointerId;return zr.set(Q,rd(zr.get(Q)||null,u,h,S,P,W)),!0;case"gotpointercapture":return Q=W.pointerId,Bc.set(Q,rd(Bc.get(Q)||null,u,h,S,P,W)),!0}return!1}function Ff(u){var h=fl(u.target);if(h!==null){var S=ke(h);if(S!==null){if(h=S.tag,h===13){if(h=We(S),h!==null){u.blockedOn=h,Af(u.priority,function(){Nf(S)});return}}else if(h===3&&S.stateNode.current.memoizedState.isDehydrated){u.blockedOn=S.tag===3?S.stateNode.containerInfo:null;return}}}u.blockedOn=null}function Pf(u){if(u.blockedOn!==null)return!1;for(var h=u.targetContainers;0<h.length;){var S=If(u.domEventName,u.eventSystemFlags,h[0],u.nativeEvent);if(S===null){S=u.nativeEvent;var P=new S.constructor(S.type,S);Lt=P,S.target.dispatchEvent(P),Lt=null}else return h=pd(S),h!==null&&Lr(h),u.blockedOn=S,!1;h.shift()}return!0}function Rf(u,h,S){Pf(u)&&S.delete(h)}function uv(){jf=!1,mi!==null&&Pf(mi)&&(mi=null),rl!==null&&Pf(rl)&&(rl=null),Yi!==null&&Pf(Yi)&&(Yi=null),zr.forEach(Rf),Bc.forEach(Rf)}function nl(u,h){u.blockedOn===h&&(u.blockedOn=null,jf||(jf=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,uv)))}function Fa(u){function h(W){return nl(W,u)}if(0<Lc.length){nl(Lc[0],u);for(var S=1;S<Lc.length;S++){var P=Lc[S];P.blockedOn===u&&(P.blockedOn=null)}}for(mi!==null&&nl(mi,u),rl!==null&&nl(rl,u),Yi!==null&&nl(Yi,u),zr.forEach(h),Bc.forEach(h),S=0;S<Ji.length;S++)P=Ji[S],P.blockedOn===u&&(P.blockedOn=null);for(;0<Ji.length&&(S=Ji[0],S.blockedOn===null);)Ff(S),S.blockedOn===null&&Ji.shift()}var Uc=T.ReactCurrentBatchConfig,Df=!0;function Di(u,h,S,P){var W=sr,Q=Uc.transition;Uc.transition=null;try{sr=1,$c(u,h,S,P)}finally{sr=W,Uc.transition=Q}}function Eo(u,h,S,P){var W=sr,Q=Uc.transition;Uc.transition=null;try{sr=4,$c(u,h,S,P)}finally{sr=W,Uc.transition=Q}}function $c(u,h,S,P){if(Df){var W=If(u,h,S,P);if(W===null)Jf(u,h,P,Wc,S),sx(u,P);else if(Ns(W,u,h,S,P))P.stopPropagation();else if(sx(u,P),h&4&&-1<nx.indexOf(u)){for(;W!==null;){var Q=pd(W);if(Q!==null&&Yn(Q),Q=If(u,h,S,P),Q===null&&Jf(u,h,P,Wc,S),Q===W)break;W=Q}W!==null&&P.stopPropagation()}else Jf(u,h,P,null,S)}}var Wc=null;function If(u,h,S,P){if(Wc=null,u=rr(P),u=fl(u),u!==null)if(h=ke(u),h===null)u=null;else if(S=h.tag,S===13){if(u=We(h),u!==null)return u;u=null}else if(S===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;u=null}else h!==u&&(u=null);return Wc=u,null}function ax(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ct()){case Mt:return 1;case Vt:return 4;case dr:case Nn:return 16;case ln:return 536870912;default:return 16}default:return 16}}var Bs=null,sl=null,No=null;function nd(){if(No)return No;var u,h=sl,S=h.length,P,W="value"in Bs?Bs.value:Bs.textContent,Q=W.length;for(u=0;u<S&&h[u]===W[u];u++);var de=S-u;for(P=1;P<=de&&h[S-P]===W[Q-P];P++);return No=W.slice(u,1<P?1-P:void 0)}function Wl(u){var h=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&h===13&&(u=13)):u=h,u===10&&(u=13),32<=u||u===13?u:0}function da(){return!0}function Ya(){return!1}function ps(u){function h(S,P,W,Q,de){this._reactName=S,this._targetInst=W,this.type=P,this.nativeEvent=Q,this.target=de,this.currentTarget=null;for(var Ae in u)u.hasOwnProperty(Ae)&&(S=u[Ae],this[Ae]=S?S(Q):Q[Ae]);return this.isDefaultPrevented=(Q.defaultPrevented!=null?Q.defaultPrevented:Q.returnValue===!1)?da:Ya,this.isPropagationStopped=Ya,this}return V(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var S=this.nativeEvent;S&&(S.preventDefault?S.preventDefault():typeof S.returnValue!="unknown"&&(S.returnValue=!1),this.isDefaultPrevented=da)},stopPropagation:function(){var S=this.nativeEvent;S&&(S.stopPropagation?S.stopPropagation():typeof S.cancelBubble!="unknown"&&(S.cancelBubble=!0),this.isPropagationStopped=da)},persist:function(){},isPersistent:da}),h}var Pa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ii=ps(Pa),Mi=V({},Pa,{view:0,detail:0}),ix=ps(Mi),sd,ad,Us,fa=V({},Mi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hl,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==Us&&(Us&&u.type==="mousemove"?(sd=u.screenX-Us.screenX,ad=u.screenY-Us.screenY):ad=sd=0,Us=u),sd)},movementY:function(u){return"movementY"in u?u.movementY:ad}}),Cn=ps(fa),id=V({},fa,{dataTransfer:0}),Oi=ps(id),ox=V({},Mi,{relatedTarget:0}),Mf=ps(ox),O0=V({},Pa,{animationName:0,elapsedTime:0,pseudoElement:0}),L0=ps(O0),lx=V({},Pa,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),Of=ps(lx),cx=V({},Pa,{data:0}),zl=ps(cx),B0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Lf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fv(u){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(u):(u=Lf[u])?!!h[u]:!1}function Hl(){return fv}var Bf=V({},Mi,{key:function(u){if(u.key){var h=B0[u.key]||u.key;if(h!=="Unidentified")return h}return u.type==="keypress"?(u=Wl(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?dv[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hl,charCode:function(u){return u.type==="keypress"?Wl(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Wl(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),ux=ps(Bf),dx=V({},fa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gl=ps(dx),fx=V({},Mi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hl}),Uf=ps(fx),$f=V({},Pa,{propertyName:0,elapsedTime:0,pseudoElement:0}),zc=ps($f),U0=V({},fa,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),$0=ps(U0),hx=[9,13,27,32],od=l&&"CompositionEvent"in window,Vl=null;l&&"documentMode"in document&&(Vl=document.documentMode);var Hc=l&&"TextEvent"in window&&!Vl,Ja=l&&(!od||Vl&&8<Vl&&11>=Vl),al=" ",Wf=!1;function W0(u,h){switch(u){case"keyup":return hx.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Li(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var Qa=!1;function z0(u,h){switch(u){case"compositionend":return Li(h);case"keypress":return h.which!==32?null:(Wf=!0,al);case"textInput":return u=h.data,u===al&&Wf?null:u;default:return null}}function gx(u,h){if(Qa)return u==="compositionend"||!od&&W0(u,h)?(u=nd(),No=sl=Bs=null,Qa=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return Ja&&h.locale!=="ko"?null:h.data;default:return null}}var Ao={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jo(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h==="input"?!!Ao[u.type]:h==="textarea"}function ld(u,h,S,P){$e(P),h=Qf(h,"onChange"),0<h.length&&(S=new Ii("onChange","change",null,S,P),u.push({event:S,listeners:h}))}var Gc=null,il=null;function mx(u){eg(u,0)}function ol(u){var h=ys(u);if(le(h))return u}function pi(u,h){if(u==="change")return h}var Vc=!1;if(l){var ll;if(l){var xi="oninput"in document;if(!xi){var zf=document.createElement("div");zf.setAttribute("oninput","return;"),xi=typeof zf.oninput=="function"}ll=xi}else ll=!1;Vc=ll&&(!document.documentMode||9<document.documentMode)}function Kl(){Gc&&(Gc.detachEvent("onpropertychange",H0),il=Gc=null)}function H0(u){if(u.propertyName==="value"&&ol(il)){var h=[];ld(h,il,u,rr(u)),Yt(mx,h)}}function G0(u,h,S){u==="focusin"?(Kl(),Gc=h,il=S,Gc.attachEvent("onpropertychange",H0)):u==="focusout"&&Kl()}function On(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return ol(il)}function Hf(u,h){if(u==="click")return ol(h)}function V0(u,h){if(u==="input"||u==="change")return ol(h)}function K0(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var Ra=typeof Object.is=="function"?Object.is:K0;function ql(u,h){if(Ra(u,h))return!0;if(typeof u!="object"||u===null||typeof h!="object"||h===null)return!1;var S=Object.keys(u),P=Object.keys(h);if(S.length!==P.length)return!1;for(P=0;P<S.length;P++){var W=S[P];if(!c.call(h,W)||!Ra(u[W],h[W]))return!1}return!0}function cl(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function An(u,h){var S=cl(u);u=0;for(var P;S;){if(S.nodeType===3){if(P=u+S.textContent.length,u<=h&&P>=h)return{node:S,offset:h-u};u=P}e:{for(;S;){if(S.nextSibling){S=S.nextSibling;break e}S=S.parentNode}S=void 0}S=cl(S)}}function ns(u,h){return u&&h?u===h?!0:u&&u.nodeType===3?!1:h&&h.nodeType===3?ns(u,h.parentNode):"contains"in u?u.contains(h):u.compareDocumentPosition?!!(u.compareDocumentPosition(h)&16):!1:!1}function xs(){for(var u=window,h=ge();h instanceof u.HTMLIFrameElement;){try{var S=typeof h.contentWindow.location.href=="string"}catch{S=!1}if(S)u=h.contentWindow;else break;h=ge(u.document)}return h}function Kc(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h&&(h==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||h==="textarea"||u.contentEditable==="true")}function cd(u){var h=xs(),S=u.focusedElem,P=u.selectionRange;if(h!==S&&S&&S.ownerDocument&&ns(S.ownerDocument.documentElement,S)){if(P!==null&&Kc(S)){if(h=P.start,u=P.end,u===void 0&&(u=h),"selectionStart"in S)S.selectionStart=h,S.selectionEnd=Math.min(u,S.value.length);else if(u=(h=S.ownerDocument||document)&&h.defaultView||window,u.getSelection){u=u.getSelection();var W=S.textContent.length,Q=Math.min(P.start,W);P=P.end===void 0?Q:Math.min(P.end,W),!u.extend&&Q>P&&(W=P,P=Q,Q=W),W=An(S,Q);var de=An(S,P);W&&de&&(u.rangeCount!==1||u.anchorNode!==W.node||u.anchorOffset!==W.offset||u.focusNode!==de.node||u.focusOffset!==de.offset)&&(h=h.createRange(),h.setStart(W.node,W.offset),u.removeAllRanges(),Q>P?(u.addRange(h),u.extend(de.node,de.offset)):(h.setEnd(de.node,de.offset),u.addRange(h)))}}for(h=[],u=S;u=u.parentNode;)u.nodeType===1&&h.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<h.length;S++)u=h[S],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var ud=l&&"documentMode"in document&&11>=document.documentMode,qc=null,As=null,Xl=null,dd=!1;function Gf(u,h,S){var P=S.window===S?S.document:S.nodeType===9?S:S.ownerDocument;dd||qc==null||qc!==ge(P)||(P=qc,"selectionStart"in P&&Kc(P)?P={start:P.selectionStart,end:P.selectionEnd}:(P=(P.ownerDocument&&P.ownerDocument.defaultView||window).getSelection(),P={anchorNode:P.anchorNode,anchorOffset:P.anchorOffset,focusNode:P.focusNode,focusOffset:P.focusOffset}),Xl&&ql(Xl,P)||(Xl=P,P=Qf(As,"onSelect"),0<P.length&&(h=new Ii("onSelect","select",null,h,S),u.push({event:h,listeners:P}),h.target=qc)))}function Za(u,h){var S={};return S[u.toLowerCase()]=h.toLowerCase(),S["Webkit"+u]="webkit"+h,S["Moz"+u]="moz"+h,S}var $s={animationend:Za("Animation","AnimationEnd"),animationiteration:Za("Animation","AnimationIteration"),animationstart:Za("Animation","AnimationStart"),transitionend:Za("Transition","TransitionEnd")},Yl={},Vf={};l&&(Vf=document.createElement("div").style,"AnimationEvent"in window||(delete $s.animationend.animation,delete $s.animationiteration.animation,delete $s.animationstart.animation),"TransitionEvent"in window||delete $s.transitionend.transition);function Xc(u){if(Yl[u])return Yl[u];if(!$s[u])return u;var h=$s[u],S;for(S in h)if(h.hasOwnProperty(S)&&S in Vf)return Yl[u]=h[S];return u}var q0=Xc("animationend"),X0=Xc("animationiteration"),Y0=Xc("animationstart"),J0=Xc("transitionend"),Q0=new Map,Z0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fo(u,h){Q0.set(u,h),a(h,[u])}for(var Kf=0;Kf<Z0.length;Kf++){var Jl=Z0[Kf],px=Jl.toLowerCase(),qf=Jl[0].toUpperCase()+Jl.slice(1);Fo(px,"on"+qf)}Fo(q0,"onAnimationEnd"),Fo(X0,"onAnimationIteration"),Fo(Y0,"onAnimationStart"),Fo("dblclick","onDoubleClick"),Fo("focusin","onFocus"),Fo("focusout","onBlur"),Fo(J0,"onTransitionEnd"),i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ul="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xx=new Set("cancel close invalid load scroll toggle".split(" ").concat(ul));function Xf(u,h,S){var P=u.type||"unknown-event";u.currentTarget=S,be(P,h,void 0,u),u.currentTarget=null}function eg(u,h){h=(h&4)!==0;for(var S=0;S<u.length;S++){var P=u[S],W=P.event;P=P.listeners;e:{var Q=void 0;if(h)for(var de=P.length-1;0<=de;de--){var Ae=P[de],Re=Ae.instance,ot=Ae.currentTarget;if(Ae=Ae.listener,Re!==Q&&W.isPropagationStopped())break e;Xf(W,Ae,ot),Q=Re}else for(de=0;de<P.length;de++){if(Ae=P[de],Re=Ae.instance,ot=Ae.currentTarget,Ae=Ae.listener,Re!==Q&&W.isPropagationStopped())break e;Xf(W,Ae,ot),Q=Re}}}if(ce)throw u=Se,ce=!1,Se=null,u}function vn(u,h){var S=h[eh];S===void 0&&(S=h[eh]=new Set);var P=u+"__bubble";S.has(P)||(tg(h,u,2,!1),S.add(P))}function Yf(u,h,S){var P=0;h&&(P|=4),tg(S,u,P,h)}var fd="_reactListening"+Math.random().toString(36).slice(2);function Ql(u){if(!u[fd]){u[fd]=!0,n.forEach(function(S){S!=="selectionchange"&&(xx.has(S)||Yf(S,!1,u),Yf(S,!0,u))});var h=u.nodeType===9?u:u.ownerDocument;h===null||h[fd]||(h[fd]=!0,Yf("selectionchange",!1,h))}}function tg(u,h,S,P){switch(ax(h)){case 1:var W=Di;break;case 4:W=Eo;break;default:W=$c}S=W.bind(null,h,S,u),W=void 0,!Ir||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(W=!0),P?W!==void 0?u.addEventListener(h,S,{capture:!0,passive:W}):u.addEventListener(h,S,!0):W!==void 0?u.addEventListener(h,S,{passive:W}):u.addEventListener(h,S,!1)}function Jf(u,h,S,P,W){var Q=P;if((h&1)===0&&(h&2)===0&&P!==null)e:for(;;){if(P===null)return;var de=P.tag;if(de===3||de===4){var Ae=P.stateNode.containerInfo;if(Ae===W||Ae.nodeType===8&&Ae.parentNode===W)break;if(de===4)for(de=P.return;de!==null;){var Re=de.tag;if((Re===3||Re===4)&&(Re=de.stateNode.containerInfo,Re===W||Re.nodeType===8&&Re.parentNode===W))return;de=de.return}for(;Ae!==null;){if(de=fl(Ae),de===null)return;if(Re=de.tag,Re===5||Re===6){P=Q=de;continue e}Ae=Ae.parentNode}}P=P.return}Yt(function(){var ot=Q,Nt=rr(S),Rt=[];e:{var Et=Q0.get(u);if(Et!==void 0){var tr=Ii,or=u;switch(u){case"keypress":if(Wl(S)===0)break e;case"keydown":case"keyup":tr=ux;break;case"focusin":or="focus",tr=Mf;break;case"focusout":or="blur",tr=Mf;break;case"beforeblur":case"afterblur":tr=Mf;break;case"click":if(S.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":tr=Cn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":tr=Oi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":tr=Uf;break;case q0:case X0:case Y0:tr=L0;break;case J0:tr=zc;break;case"scroll":tr=ix;break;case"wheel":tr=$0;break;case"copy":case"cut":case"paste":tr=Of;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":tr=Gl}var lr=(h&4)!==0,bs=!lr&&u==="scroll",Ke=lr?Et!==null?Et+"Capture":null:Et;lr=[];for(var Me=ot,tt;Me!==null;){tt=Me;var Ot=tt.stateNode;if(tt.tag===5&&Ot!==null&&(tt=Ot,Ke!==null&&(Ot=pr(Me,Ke),Ot!=null&&lr.push(Yc(Me,Ot,tt)))),bs)break;Me=Me.return}0<lr.length&&(Et=new tr(Et,or,null,S,Nt),Rt.push({event:Et,listeners:lr}))}}if((h&7)===0){e:{if(Et=u==="mouseover"||u==="pointerover",tr=u==="mouseout"||u==="pointerout",Et&&S!==Lt&&(or=S.relatedTarget||S.fromElement)&&(fl(or)||or[Zi]))break e;if((tr||Et)&&(Et=Nt.window===Nt?Nt:(Et=Nt.ownerDocument)?Et.defaultView||Et.parentWindow:window,tr?(or=S.relatedTarget||S.toElement,tr=ot,or=or?fl(or):null,or!==null&&(bs=ke(or),or!==bs||or.tag!==5&&or.tag!==6)&&(or=null)):(tr=null,or=ot),tr!==or)){if(lr=Cn,Ot="onMouseLeave",Ke="onMouseEnter",Me="mouse",(u==="pointerout"||u==="pointerover")&&(lr=Gl,Ot="onPointerLeave",Ke="onPointerEnter",Me="pointer"),bs=tr==null?Et:ys(tr),tt=or==null?Et:ys(or),Et=new lr(Ot,Me+"leave",tr,S,Nt),Et.target=bs,Et.relatedTarget=tt,Ot=null,fl(Nt)===ot&&(lr=new lr(Ke,Me+"enter",or,S,Nt),lr.target=tt,lr.relatedTarget=bs,Ot=lr),bs=Ot,tr&&or)t:{for(lr=tr,Ke=or,Me=0,tt=lr;tt;tt=Zl(tt))Me++;for(tt=0,Ot=Ke;Ot;Ot=Zl(Ot))tt++;for(;0<Me-tt;)lr=Zl(lr),Me--;for(;0<tt-Me;)Ke=Zl(Ke),tt--;for(;Me--;){if(lr===Ke||Ke!==null&&lr===Ke.alternate)break t;lr=Zl(lr),Ke=Zl(Ke)}lr=null}else lr=null;tr!==null&&yx(Rt,Et,tr,lr,!1),or!==null&&bs!==null&&yx(Rt,bs,or,lr,!0)}}e:{if(Et=ot?ys(ot):window,tr=Et.nodeName&&Et.nodeName.toLowerCase(),tr==="select"||tr==="input"&&Et.type==="file")var ur=pi;else if(jo(Et))if(Vc)ur=V0;else{ur=On;var yr=G0}else(tr=Et.nodeName)&&tr.toLowerCase()==="input"&&(Et.type==="checkbox"||Et.type==="radio")&&(ur=Hf);if(ur&&(ur=ur(u,ot))){ld(Rt,ur,S,Nt);break e}yr&&yr(u,Et,ot),u==="focusout"&&(yr=Et._wrapperState)&&yr.controlled&&Et.type==="number"&&rt(Et,"number",Et.value)}switch(yr=ot?ys(ot):window,u){case"focusin":(jo(yr)||yr.contentEditable==="true")&&(qc=yr,As=ot,Xl=null);break;case"focusout":Xl=As=qc=null;break;case"mousedown":dd=!0;break;case"contextmenu":case"mouseup":case"dragend":dd=!1,Gf(Rt,S,Nt);break;case"selectionchange":if(ud)break;case"keydown":case"keyup":Gf(Rt,S,Nt)}var vr;if(od)e:{switch(u){case"compositionstart":var Cr="onCompositionStart";break e;case"compositionend":Cr="onCompositionEnd";break e;case"compositionupdate":Cr="onCompositionUpdate";break e}Cr=void 0}else Qa?W0(u,S)&&(Cr="onCompositionEnd"):u==="keydown"&&S.keyCode===229&&(Cr="onCompositionStart");Cr&&(Ja&&S.locale!=="ko"&&(Qa||Cr!=="onCompositionStart"?Cr==="onCompositionEnd"&&Qa&&(vr=nd()):(Bs=Nt,sl="value"in Bs?Bs.value:Bs.textContent,Qa=!0)),yr=Qf(ot,Cr),0<yr.length&&(Cr=new zl(Cr,u,null,S,Nt),Rt.push({event:Cr,listeners:yr}),vr?Cr.data=vr:(vr=Li(S),vr!==null&&(Cr.data=vr)))),(vr=Hc?z0(u,S):gx(u,S))&&(ot=Qf(ot,"onBeforeInput"),0<ot.length&&(Nt=new zl("onBeforeInput","beforeinput",null,S,Nt),Rt.push({event:Nt,listeners:ot}),Nt.data=vr))}eg(Rt,h)})}function Yc(u,h,S){return{instance:u,listener:h,currentTarget:S}}function Qf(u,h){for(var S=h+"Capture",P=[];u!==null;){var W=u,Q=W.stateNode;W.tag===5&&Q!==null&&(W=Q,Q=pr(u,S),Q!=null&&P.unshift(Yc(u,Q,W)),Q=pr(u,h),Q!=null&&P.push(Yc(u,Q,W))),u=u.return}return P}function Zl(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function yx(u,h,S,P,W){for(var Q=h._reactName,de=[];S!==null&&S!==P;){var Ae=S,Re=Ae.alternate,ot=Ae.stateNode;if(Re!==null&&Re===P)break;Ae.tag===5&&ot!==null&&(Ae=ot,W?(Re=pr(S,Q),Re!=null&&de.unshift(Yc(S,Re,Ae))):W||(Re=pr(S,Q),Re!=null&&de.push(Yc(S,Re,Ae)))),S=S.return}de.length!==0&&u.push({event:h,listeners:de})}var hv=/\r\n?/g,vx=/\u0000|\uFFFD/g;function rg(u){return(typeof u=="string"?u:""+u).replace(hv,`
`).replace(vx,"")}function hd(u,h,S){if(h=rg(h),rg(u)!==h&&S)throw Error(r(425))}function ec(){}var ng=null,sg=null;function ag(u,h){return u==="textarea"||u==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var ei=typeof setTimeout=="function"?setTimeout:void 0,ig=typeof clearTimeout=="function"?clearTimeout:void 0,gd=typeof Promise=="function"?Promise:void 0,wx=typeof queueMicrotask=="function"?queueMicrotask:typeof gd<"u"?function(u){return gd.resolve(null).then(u).catch(_x)}:ei;function _x(u){setTimeout(function(){throw u})}function Zf(u,h){var S=h,P=0;do{var W=S.nextSibling;if(u.removeChild(S),W&&W.nodeType===8)if(S=W.data,S==="/$"){if(P===0){u.removeChild(W),Fa(h);return}P--}else S!=="$"&&S!=="$?"&&S!=="$!"||P++;S=W}while(S);Fa(h)}function Qi(u){for(;u!=null;u=u.nextSibling){var h=u.nodeType;if(h===1||h===3)break;if(h===8){if(h=u.data,h==="$"||h==="$!"||h==="$?")break;if(h==="/$")return null}}return u}function tc(u){u=u.previousSibling;for(var h=0;u;){if(u.nodeType===8){var S=u.data;if(S==="$"||S==="$!"||S==="$?"){if(h===0)return u;h--}else S==="/$"&&h++}u=u.previousSibling}return null}var dl=Math.random().toString(36).slice(2),yi="__reactFiber$"+dl,md="__reactProps$"+dl,Zi="__reactContainer$"+dl,eh="__reactEvents$"+dl,bx="__reactListeners$"+dl,Sx="__reactHandles$"+dl;function fl(u){var h=u[yi];if(h)return h;for(var S=u.parentNode;S;){if(h=S[Zi]||S[yi]){if(S=h.alternate,h.child!==null||S!==null&&S.child!==null)for(u=tc(u);u!==null;){if(S=u[yi])return S;u=tc(u)}return h}u=S,S=u.parentNode}return null}function pd(u){return u=u[yi]||u[Zi],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function ys(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(r(33))}function js(u){return u[md]||null}var th=[],rc=-1;function Po(u){return{current:u}}function wn(u){0>rc||(u.current=th[rc],th[rc]=null,rc--)}function fn(u,h){rc++,th[rc]=u.current,u.current=h}var eo={},Ws=Po(eo),Ys=Po(!1),hl=eo;function nc(u,h){var S=u.type.contextTypes;if(!S)return eo;var P=u.stateNode;if(P&&P.__reactInternalMemoizedUnmaskedChildContext===h)return P.__reactInternalMemoizedMaskedChildContext;var W={},Q;for(Q in S)W[Q]=h[Q];return P&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=h,u.__reactInternalMemoizedMaskedChildContext=W),W}function Js(u){return u=u.childContextTypes,u!=null}function Jc(){wn(Ys),wn(Ws)}function og(u,h,S){if(Ws.current!==eo)throw Error(r(168));fn(Ws,h),fn(Ys,S)}function rh(u,h,S){var P=u.stateNode;if(h=h.childContextTypes,typeof P.getChildContext!="function")return S;P=P.getChildContext();for(var W in P)if(!(W in h))throw Error(r(108,J(u)||"Unknown",W));return V({},S,P)}function sc(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||eo,hl=Ws.current,fn(Ws,u),fn(Ys,Ys.current),!0}function kx(u,h,S){var P=u.stateNode;if(!P)throw Error(r(169));S?(u=rh(u,h,hl),P.__reactInternalMemoizedMergedChildContext=u,wn(Ys),wn(Ws),fn(Ws,u)):wn(Ys),fn(Ys,S)}var to=null,Qc=!1,nh=!1;function xd(u){to===null?to=[u]:to.push(u)}function Ro(u){Qc=!0,xd(u)}function gl(){if(!nh&&to!==null){nh=!0;var u=0,h=sr;try{var S=to;for(sr=1;u<S.length;u++){var P=S[u];do P=P(!0);while(P!==null)}to=null,Qc=!1}catch(W){throw to!==null&&(to=to.slice(u+1)),Te(Mt,gl),W}finally{sr=h,nh=!1}}return null}var ha=[],ac=0,ml=null,pl=0,ga=[],ma=0,xl=null,ti=1,jn="";function ic(u,h){ha[ac++]=pl,ha[ac++]=ml,ml=u,pl=h}function Cx(u,h,S){ga[ma++]=ti,ga[ma++]=jn,ga[ma++]=xl,xl=u;var P=ti;u=jn;var W=32-cr(P)-1;P&=~(1<<W),S+=1;var Q=32-cr(h)+W;if(30<Q){var de=W-W%5;Q=(P&(1<<de)-1).toString(32),P>>=de,W-=de,ti=1<<32-cr(h)+W|S<<W|P,jn=Q+u}else ti=1<<Q|S<<W|P,jn=u}function Zc(u){u.return!==null&&(ic(u,1),Cx(u,1,0))}function Fs(u){for(;u===ml;)ml=ha[--ac],ha[ac]=null,pl=ha[--ac],ha[ac]=null;for(;u===xl;)xl=ga[--ma],ga[ma]=null,jn=ga[--ma],ga[ma]=null,ti=ga[--ma],ga[ma]=null}var ri=null,qt=null,sn=!1,ni=null;function lg(u,h){var S=lo(5,null,null,0);S.elementType="DELETED",S.stateNode=h,S.return=u,h=u.deletions,h===null?(u.deletions=[S],u.flags|=16):h.push(S)}function Tx(u,h){switch(u.tag){case 5:var S=u.type;return h=h.nodeType!==1||S.toLowerCase()!==h.nodeName.toLowerCase()?null:h,h!==null?(u.stateNode=h,ri=u,qt=Qi(h.firstChild),!0):!1;case 6:return h=u.pendingProps===""||h.nodeType!==3?null:h,h!==null?(u.stateNode=h,ri=u,qt=null,!0):!1;case 13:return h=h.nodeType!==8?null:h,h!==null?(S=xl!==null?{id:ti,overflow:jn}:null,u.memoizedState={dehydrated:h,treeContext:S,retryLane:1073741824},S=lo(18,null,null,0),S.stateNode=h,S.return=u,u.child=S,ri=u,qt=null,!0):!1;default:return!1}}function oc(u){return(u.mode&1)!==0&&(u.flags&128)===0}function eu(u){if(sn){var h=qt;if(h){var S=h;if(!Tx(u,h)){if(oc(u))throw Error(r(418));h=Qi(S.nextSibling);var P=ri;h&&Tx(u,h)?lg(P,S):(u.flags=u.flags&-4097|2,sn=!1,ri=u)}}else{if(oc(u))throw Error(r(418));u.flags=u.flags&-4097|2,sn=!1,ri=u}}}function sh(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;ri=u}function yd(u){if(u!==ri)return!1;if(!sn)return sh(u),sn=!0,!1;var h;if((h=u.tag!==3)&&!(h=u.tag!==5)&&(h=u.type,h=h!=="head"&&h!=="body"&&!ag(u.type,u.memoizedProps)),h&&(h=qt)){if(oc(u))throw cg(),Error(r(418));for(;h;)lg(u,h),h=Qi(h.nextSibling)}if(sh(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(r(317));e:{for(u=u.nextSibling,h=0;u;){if(u.nodeType===8){var S=u.data;if(S==="/$"){if(h===0){qt=Qi(u.nextSibling);break e}h--}else S!=="$"&&S!=="$!"&&S!=="$?"||h++}u=u.nextSibling}qt=null}}else qt=ri?Qi(u.stateNode.nextSibling):null;return!0}function cg(){for(var u=qt;u;)u=Qi(u.nextSibling)}function lc(){qt=ri=null,sn=!1}function vd(u){ni===null?ni=[u]:ni.push(u)}var ug=T.ReactCurrentBatchConfig;function Jn(u,h,S){if(u=S.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(S._owner){if(S=S._owner,S){if(S.tag!==1)throw Error(r(309));var P=S.stateNode}if(!P)throw Error(r(147,u));var W=P,Q=""+u;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===Q?h.ref:(h=function(de){var Ae=W.refs;de===null?delete Ae[Q]:Ae[Q]=de},h._stringRef=Q,h)}if(typeof u!="string")throw Error(r(284));if(!S._owner)throw Error(r(290,u))}return u}function Da(u,h){throw u=Object.prototype.toString.call(h),Error(r(31,u==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":u))}function Bi(u){var h=u._init;return h(u._payload)}function ah(u){function h(Ke,Me){if(u){var tt=Ke.deletions;tt===null?(Ke.deletions=[Me],Ke.flags|=16):tt.push(Me)}}function S(Ke,Me){if(!u)return null;for(;Me!==null;)h(Ke,Me),Me=Me.sibling;return null}function P(Ke,Me){for(Ke=new Map;Me!==null;)Me.key!==null?Ke.set(Me.key,Me):Ke.set(Me.index,Me),Me=Me.sibling;return Ke}function W(Ke,Me){return Ke=wu(Ke,Me),Ke.index=0,Ke.sibling=null,Ke}function Q(Ke,Me,tt){return Ke.index=tt,u?(tt=Ke.alternate,tt!==null?(tt=tt.index,tt<Me?(Ke.flags|=2,Me):tt):(Ke.flags|=2,Me)):(Ke.flags|=1048576,Me)}function de(Ke){return u&&Ke.alternate===null&&(Ke.flags|=2),Ke}function Ae(Ke,Me,tt,Ot){return Me===null||Me.tag!==6?(Me=Dv(tt,Ke.mode,Ot),Me.return=Ke,Me):(Me=W(Me,tt),Me.return=Ke,Me)}function Re(Ke,Me,tt,Ot){var ur=tt.type;return ur===R?Nt(Ke,Me,tt.props.children,Ot,tt.key):Me!==null&&(Me.elementType===ur||typeof ur=="object"&&ur!==null&&ur.$$typeof===se&&Bi(ur)===Me.type)?(Ot=W(Me,tt.props),Ot.ref=Jn(Ke,Me,tt),Ot.return=Ke,Ot):(Ot=Kx(tt.type,tt.key,tt.props,null,Ke.mode,Ot),Ot.ref=Jn(Ke,Me,tt),Ot.return=Ke,Ot)}function ot(Ke,Me,tt,Ot){return Me===null||Me.tag!==4||Me.stateNode.containerInfo!==tt.containerInfo||Me.stateNode.implementation!==tt.implementation?(Me=Iv(tt,Ke.mode,Ot),Me.return=Ke,Me):(Me=W(Me,tt.children||[]),Me.return=Ke,Me)}function Nt(Ke,Me,tt,Ot,ur){return Me===null||Me.tag!==7?(Me=jd(tt,Ke.mode,Ot,ur),Me.return=Ke,Me):(Me=W(Me,tt),Me.return=Ke,Me)}function Rt(Ke,Me,tt){if(typeof Me=="string"&&Me!==""||typeof Me=="number")return Me=Dv(""+Me,Ke.mode,tt),Me.return=Ke,Me;if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case A:return tt=Kx(Me.type,Me.key,Me.props,null,Ke.mode,tt),tt.ref=Jn(Ke,null,Me),tt.return=Ke,tt;case F:return Me=Iv(Me,Ke.mode,tt),Me.return=Ke,Me;case se:var Ot=Me._init;return Rt(Ke,Ot(Me._payload),tt)}if(Ie(Me)||U(Me))return Me=jd(Me,Ke.mode,tt,null),Me.return=Ke,Me;Da(Ke,Me)}return null}function Et(Ke,Me,tt,Ot){var ur=Me!==null?Me.key:null;if(typeof tt=="string"&&tt!==""||typeof tt=="number")return ur!==null?null:Ae(Ke,Me,""+tt,Ot);if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case A:return tt.key===ur?Re(Ke,Me,tt,Ot):null;case F:return tt.key===ur?ot(Ke,Me,tt,Ot):null;case se:return ur=tt._init,Et(Ke,Me,ur(tt._payload),Ot)}if(Ie(tt)||U(tt))return ur!==null?null:Nt(Ke,Me,tt,Ot,null);Da(Ke,tt)}return null}function tr(Ke,Me,tt,Ot,ur){if(typeof Ot=="string"&&Ot!==""||typeof Ot=="number")return Ke=Ke.get(tt)||null,Ae(Me,Ke,""+Ot,ur);if(typeof Ot=="object"&&Ot!==null){switch(Ot.$$typeof){case A:return Ke=Ke.get(Ot.key===null?tt:Ot.key)||null,Re(Me,Ke,Ot,ur);case F:return Ke=Ke.get(Ot.key===null?tt:Ot.key)||null,ot(Me,Ke,Ot,ur);case se:var yr=Ot._init;return tr(Ke,Me,tt,yr(Ot._payload),ur)}if(Ie(Ot)||U(Ot))return Ke=Ke.get(tt)||null,Nt(Me,Ke,Ot,ur,null);Da(Me,Ot)}return null}function or(Ke,Me,tt,Ot){for(var ur=null,yr=null,vr=Me,Cr=Me=0,na=null;vr!==null&&Cr<tt.length;Cr++){vr.index>Cr?(na=vr,vr=null):na=vr.sibling;var en=Et(Ke,vr,tt[Cr],Ot);if(en===null){vr===null&&(vr=na);break}u&&vr&&en.alternate===null&&h(Ke,vr),Me=Q(en,Me,Cr),yr===null?ur=en:yr.sibling=en,yr=en,vr=na}if(Cr===tt.length)return S(Ke,vr),sn&&ic(Ke,Cr),ur;if(vr===null){for(;Cr<tt.length;Cr++)vr=Rt(Ke,tt[Cr],Ot),vr!==null&&(Me=Q(vr,Me,Cr),yr===null?ur=vr:yr.sibling=vr,yr=vr);return sn&&ic(Ke,Cr),ur}for(vr=P(Ke,vr);Cr<tt.length;Cr++)na=tr(vr,Ke,Cr,tt[Cr],Ot),na!==null&&(u&&na.alternate!==null&&vr.delete(na.key===null?Cr:na.key),Me=Q(na,Me,Cr),yr===null?ur=na:yr.sibling=na,yr=na);return u&&vr.forEach(function(_u){return h(Ke,_u)}),sn&&ic(Ke,Cr),ur}function lr(Ke,Me,tt,Ot){var ur=U(tt);if(typeof ur!="function")throw Error(r(150));if(tt=ur.call(tt),tt==null)throw Error(r(151));for(var yr=ur=null,vr=Me,Cr=Me=0,na=null,en=tt.next();vr!==null&&!en.done;Cr++,en=tt.next()){vr.index>Cr?(na=vr,vr=null):na=vr.sibling;var _u=Et(Ke,vr,en.value,Ot);if(_u===null){vr===null&&(vr=na);break}u&&vr&&_u.alternate===null&&h(Ke,vr),Me=Q(_u,Me,Cr),yr===null?ur=_u:yr.sibling=_u,yr=_u,vr=na}if(en.done)return S(Ke,vr),sn&&ic(Ke,Cr),ur;if(vr===null){for(;!en.done;Cr++,en=tt.next())en=Rt(Ke,en.value,Ot),en!==null&&(Me=Q(en,Me,Cr),yr===null?ur=en:yr.sibling=en,yr=en);return sn&&ic(Ke,Cr),ur}for(vr=P(Ke,vr);!en.done;Cr++,en=tt.next())en=tr(vr,Ke,Cr,en.value,Ot),en!==null&&(u&&en.alternate!==null&&vr.delete(en.key===null?Cr:en.key),Me=Q(en,Me,Cr),yr===null?ur=en:yr.sibling=en,yr=en);return u&&vr.forEach(function(PP){return h(Ke,PP)}),sn&&ic(Ke,Cr),ur}function bs(Ke,Me,tt,Ot){if(typeof tt=="object"&&tt!==null&&tt.type===R&&tt.key===null&&(tt=tt.props.children),typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case A:e:{for(var ur=tt.key,yr=Me;yr!==null;){if(yr.key===ur){if(ur=tt.type,ur===R){if(yr.tag===7){S(Ke,yr.sibling),Me=W(yr,tt.props.children),Me.return=Ke,Ke=Me;break e}}else if(yr.elementType===ur||typeof ur=="object"&&ur!==null&&ur.$$typeof===se&&Bi(ur)===yr.type){S(Ke,yr.sibling),Me=W(yr,tt.props),Me.ref=Jn(Ke,yr,tt),Me.return=Ke,Ke=Me;break e}S(Ke,yr);break}else h(Ke,yr);yr=yr.sibling}tt.type===R?(Me=jd(tt.props.children,Ke.mode,Ot,tt.key),Me.return=Ke,Ke=Me):(Ot=Kx(tt.type,tt.key,tt.props,null,Ke.mode,Ot),Ot.ref=Jn(Ke,Me,tt),Ot.return=Ke,Ke=Ot)}return de(Ke);case F:e:{for(yr=tt.key;Me!==null;){if(Me.key===yr)if(Me.tag===4&&Me.stateNode.containerInfo===tt.containerInfo&&Me.stateNode.implementation===tt.implementation){S(Ke,Me.sibling),Me=W(Me,tt.children||[]),Me.return=Ke,Ke=Me;break e}else{S(Ke,Me);break}else h(Ke,Me);Me=Me.sibling}Me=Iv(tt,Ke.mode,Ot),Me.return=Ke,Ke=Me}return de(Ke);case se:return yr=tt._init,bs(Ke,Me,yr(tt._payload),Ot)}if(Ie(tt))return or(Ke,Me,tt,Ot);if(U(tt))return lr(Ke,Me,tt,Ot);Da(Ke,tt)}return typeof tt=="string"&&tt!==""||typeof tt=="number"?(tt=""+tt,Me!==null&&Me.tag===6?(S(Ke,Me.sibling),Me=W(Me,tt),Me.return=Ke,Ke=Me):(S(Ke,Me),Me=Dv(tt,Ke.mode,Ot),Me.return=Ke,Ke=Me),de(Ke)):S(Ke,Me)}return bs}var cc=ah(!0),vi=ah(!1),wd=Po(null),si=null,tu=null,ih=null;function oh(){ih=tu=si=null}function lh(u){var h=wd.current;wn(wd),u._currentValue=h}function ch(u,h,S){for(;u!==null;){var P=u.alternate;if((u.childLanes&h)!==h?(u.childLanes|=h,P!==null&&(P.childLanes|=h)):P!==null&&(P.childLanes&h)!==h&&(P.childLanes|=h),u===S)break;u=u.return}}function Do(u,h){si=u,ih=tu=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&h)!==0&&(te=!0),u.firstContext=null)}function pa(u){var h=u._currentValue;if(ih!==u)if(u={context:u,memoizedValue:h,next:null},tu===null){if(si===null)throw Error(r(308));tu=u,si.dependencies={lanes:0,firstContext:u}}else tu=tu.next=u;return h}var ro=null;function ru(u){ro===null?ro=[u]:ro.push(u)}function _d(u,h,S,P){var W=h.interleaved;return W===null?(S.next=S,ru(h)):(S.next=W.next,W.next=S),h.interleaved=S,ai(u,P)}function ai(u,h){u.lanes|=h;var S=u.alternate;for(S!==null&&(S.lanes|=h),S=u,u=u.return;u!==null;)u.childLanes|=h,S=u.alternate,S!==null&&(S.childLanes|=h),S=u,u=u.return;return S.tag===3?S.stateNode:null}var no=!1;function bd(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uh(u,h){u=u.updateQueue,h.updateQueue===u&&(h.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function so(u,h){return{eventTime:u,lane:h,tag:0,payload:null,callback:null,next:null}}function ao(u,h,S){var P=u.updateQueue;if(P===null)return null;if(P=P.shared,(Jr&2)!==0){var W=P.pending;return W===null?h.next=h:(h.next=W.next,W.next=h),P.pending=h,ai(u,S)}return W=P.interleaved,W===null?(h.next=h,ru(P)):(h.next=W.next,W.next=h),P.interleaved=h,ai(u,S)}function dh(u,h,S){if(h=h.updateQueue,h!==null&&(h=h.shared,(S&4194240)!==0)){var P=h.lanes;P&=u.pendingLanes,S|=P,h.lanes=S,Mn(u,S)}}function Sd(u,h){var S=u.updateQueue,P=u.alternate;if(P!==null&&(P=P.updateQueue,S===P)){var W=null,Q=null;if(S=S.firstBaseUpdate,S!==null){do{var de={eventTime:S.eventTime,lane:S.lane,tag:S.tag,payload:S.payload,callback:S.callback,next:null};Q===null?W=Q=de:Q=Q.next=de,S=S.next}while(S!==null);Q===null?W=Q=h:Q=Q.next=h}else W=Q=h;S={baseState:P.baseState,firstBaseUpdate:W,lastBaseUpdate:Q,shared:P.shared,effects:P.effects},u.updateQueue=S;return}u=S.lastBaseUpdate,u===null?S.firstBaseUpdate=h:u.next=h,S.lastBaseUpdate=h}function nu(u,h,S,P){var W=u.updateQueue;no=!1;var Q=W.firstBaseUpdate,de=W.lastBaseUpdate,Ae=W.shared.pending;if(Ae!==null){W.shared.pending=null;var Re=Ae,ot=Re.next;Re.next=null,de===null?Q=ot:de.next=ot,de=Re;var Nt=u.alternate;Nt!==null&&(Nt=Nt.updateQueue,Ae=Nt.lastBaseUpdate,Ae!==de&&(Ae===null?Nt.firstBaseUpdate=ot:Ae.next=ot,Nt.lastBaseUpdate=Re))}if(Q!==null){var Rt=W.baseState;de=0,Nt=ot=Re=null,Ae=Q;do{var Et=Ae.lane,tr=Ae.eventTime;if((P&Et)===Et){Nt!==null&&(Nt=Nt.next={eventTime:tr,lane:0,tag:Ae.tag,payload:Ae.payload,callback:Ae.callback,next:null});e:{var or=u,lr=Ae;switch(Et=h,tr=S,lr.tag){case 1:if(or=lr.payload,typeof or=="function"){Rt=or.call(tr,Rt,Et);break e}Rt=or;break e;case 3:or.flags=or.flags&-65537|128;case 0:if(or=lr.payload,Et=typeof or=="function"?or.call(tr,Rt,Et):or,Et==null)break e;Rt=V({},Rt,Et);break e;case 2:no=!0}}Ae.callback!==null&&Ae.lane!==0&&(u.flags|=64,Et=W.effects,Et===null?W.effects=[Ae]:Et.push(Ae))}else tr={eventTime:tr,lane:Et,tag:Ae.tag,payload:Ae.payload,callback:Ae.callback,next:null},Nt===null?(ot=Nt=tr,Re=Rt):Nt=Nt.next=tr,de|=Et;if(Ae=Ae.next,Ae===null){if(Ae=W.shared.pending,Ae===null)break;Et=Ae,Ae=Et.next,Et.next=null,W.lastBaseUpdate=Et,W.shared.pending=null}}while(!0);if(Nt===null&&(Re=Rt),W.baseState=Re,W.firstBaseUpdate=ot,W.lastBaseUpdate=Nt,h=W.shared.interleaved,h!==null){W=h;do de|=W.lane,W=W.next;while(W!==h)}else Q===null&&(W.shared.lanes=0);Td|=de,u.lanes=de,u.memoizedState=Rt}}function Gn(u,h,S){if(u=h.effects,h.effects=null,u!==null)for(h=0;h<u.length;h++){var P=u[h],W=P.callback;if(W!==null){if(P.callback=null,P=S,typeof W!="function")throw Error(r(191,W));W.call(P)}}}var Ar={},hn=Po(Ar),Fn=Po(Ar),Qn=Po(Ar);function vs(u){if(u===Ar)throw Error(r(174));return u}function yl(u,h){switch(fn(Qn,h),fn(Fn,u),fn(hn,Ar),u=h.nodeType,u){case 9:case 11:h=(h=h.documentElement)?h.namespaceURI:it(null,"");break;default:u=u===8?h.parentNode:h,h=u.namespaceURI||null,u=u.tagName,h=it(h,u)}wn(hn),fn(hn,h)}function Pn(){wn(hn),wn(Fn),wn(Qn)}function su(u){vs(Qn.current);var h=vs(hn.current),S=it(h,u.type);h!==S&&(fn(Fn,u),fn(hn,S))}function Io(u){Fn.current===u&&(wn(hn),wn(Fn))}var _n=Po(0);function au(u){for(var h=u;h!==null;){if(h.tag===13){var S=h.memoizedState;if(S!==null&&(S=S.dehydrated,S===null||S.data==="$?"||S.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var uc=[];function Qs(){for(var u=0;u<uc.length;u++)uc[u]._workInProgressVersionPrimary=null;uc.length=0}var iu=T.ReactCurrentDispatcher,kd=T.ReactCurrentBatchConfig,xa=0,cn=null,Vn=null,ss=null,Ui=!1,vl=!1,wi=0,fh=0;function as(){throw Error(r(321))}function Cd(u,h){if(h===null)return!1;for(var S=0;S<h.length&&S<u.length;S++)if(!Ra(u[S],h[S]))return!1;return!0}function ou(u,h,S,P,W,Q){if(xa=Q,cn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,iu.current=u===null||u.memoizedState===null?mv:bl,u=S(P,W),vl){Q=0;do{if(vl=!1,wi=0,25<=Q)throw Error(r(301));Q+=1,ss=Vn=null,h.updateQueue=null,iu.current=xh,u=S(P,W)}while(vl)}if(iu.current=du,h=Vn!==null&&Vn.next!==null,xa=0,ss=Vn=cn=null,Ui=!1,h)throw Error(r(300));return u}function lu(){var u=wi!==0;return wi=0,u}function Tn(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ss===null?cn.memoizedState=ss=u:ss=ss.next=u,ss}function ws(){if(Vn===null){var u=cn.alternate;u=u!==null?u.memoizedState:null}else u=Vn.next;var h=ss===null?cn.memoizedState:ss.next;if(h!==null)ss=h,Vn=u;else{if(u===null)throw Error(r(310));Vn=u,u={memoizedState:Vn.memoizedState,baseState:Vn.baseState,baseQueue:Vn.baseQueue,queue:Vn.queue,next:null},ss===null?cn.memoizedState=ss=u:ss=ss.next=u}return ss}function Zs(u,h){return typeof h=="function"?h(u):h}function ea(u){var h=ws(),S=h.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=u;var P=Vn,W=P.baseQueue,Q=S.pending;if(Q!==null){if(W!==null){var de=W.next;W.next=Q.next,Q.next=de}P.baseQueue=W=Q,S.pending=null}if(W!==null){Q=W.next,P=P.baseState;var Ae=de=null,Re=null,ot=Q;do{var Nt=ot.lane;if((xa&Nt)===Nt)Re!==null&&(Re=Re.next={lane:0,action:ot.action,hasEagerState:ot.hasEagerState,eagerState:ot.eagerState,next:null}),P=ot.hasEagerState?ot.eagerState:u(P,ot.action);else{var Rt={lane:Nt,action:ot.action,hasEagerState:ot.hasEagerState,eagerState:ot.eagerState,next:null};Re===null?(Ae=Re=Rt,de=P):Re=Re.next=Rt,cn.lanes|=Nt,Td|=Nt}ot=ot.next}while(ot!==null&&ot!==Q);Re===null?de=P:Re.next=Ae,Ra(P,h.memoizedState)||(te=!0),h.memoizedState=P,h.baseState=de,h.baseQueue=Re,S.lastRenderedState=P}if(u=S.interleaved,u!==null){W=u;do Q=W.lane,cn.lanes|=Q,Td|=Q,W=W.next;while(W!==u)}else W===null&&(S.lanes=0);return[h.memoizedState,S.dispatch]}function hh(u){var h=ws(),S=h.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=u;var P=S.dispatch,W=S.pending,Q=h.memoizedState;if(W!==null){S.pending=null;var de=W=W.next;do Q=u(Q,de.action),de=de.next;while(de!==W);Ra(Q,h.memoizedState)||(te=!0),h.memoizedState=Q,h.baseQueue===null&&(h.baseState=Q),S.lastRenderedState=Q}return[Q,P]}function gh(){}function mh(u,h){var S=cn,P=ws(),W=h(),Q=!Ra(P.memoizedState,W);if(Q&&(P.memoizedState=W,te=!0),P=P.queue,gg(dg.bind(null,S,P,u),[u]),P.getSnapshot!==h||Q||ss!==null&&ss.memoizedState.tag&1){if(S.flags|=2048,cu(9,Mo.bind(null,S,P,W,h),void 0,null),ra===null)throw Error(r(349));(xa&30)!==0||Ex(S,h,W)}return W}function Ex(u,h,S){u.flags|=16384,u={getSnapshot:h,value:S},h=cn.updateQueue,h===null?(h={lastEffect:null,stores:null},cn.updateQueue=h,h.stores=[u]):(S=h.stores,S===null?h.stores=[u]:S.push(u))}function Mo(u,h,S,P){h.value=S,h.getSnapshot=P,fg(h)&&ph(u)}function dg(u,h,S){return S(function(){fg(h)&&ph(u)})}function fg(u){var h=u.getSnapshot;u=u.value;try{var S=h();return!Ra(u,S)}catch{return!0}}function ph(u){var h=ai(u,1);h!==null&&Uo(h,u,1,-1)}function wl(u){var h=Tn();return typeof u=="function"&&(u=u()),h.memoizedState=h.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zs,lastRenderedState:u},h.queue=u,u=u.dispatch=Rx.bind(null,cn,u),[h.memoizedState,u]}function cu(u,h,S,P){return u={tag:u,create:h,destroy:S,deps:P,next:null},h=cn.updateQueue,h===null?(h={lastEffect:null,stores:null},cn.updateQueue=h,h.lastEffect=u.next=u):(S=h.lastEffect,S===null?h.lastEffect=u.next=u:(P=S.next,S.next=u,u.next=P,h.lastEffect=u)),u}function hg(){return ws().memoizedState}function uu(u,h,S,P){var W=Tn();cn.flags|=u,W.memoizedState=cu(1|h,S,void 0,P===void 0?null:P)}function dc(u,h,S,P){var W=ws();P=P===void 0?null:P;var Q=void 0;if(Vn!==null){var de=Vn.memoizedState;if(Q=de.destroy,P!==null&&Cd(P,de.deps)){W.memoizedState=cu(h,S,Q,P);return}}cn.flags|=u,W.memoizedState=cu(1|h,S,Q,P)}function Nx(u,h){return uu(8390656,8,u,h)}function gg(u,h){return dc(2048,8,u,h)}function mg(u,h){return dc(4,2,u,h)}function pg(u,h){return dc(4,4,u,h)}function _l(u,h){if(typeof h=="function")return u=u(),h(u),function(){h(null)};if(h!=null)return u=u(),h.current=u,function(){h.current=null}}function Ax(u,h,S){return S=S!=null?S.concat([u]):null,dc(4,4,_l.bind(null,h,u),S)}function Oo(){}function xg(u,h){var S=ws();h=h===void 0?null:h;var P=S.memoizedState;return P!==null&&h!==null&&Cd(h,P[1])?P[0]:(S.memoizedState=[u,h],u)}function En(u,h){var S=ws();h=h===void 0?null:h;var P=S.memoizedState;return P!==null&&h!==null&&Cd(h,P[1])?P[0]:(u=u(),S.memoizedState=[u,h],u)}function jx(u,h,S){return(xa&21)===0?(u.baseState&&(u.baseState=!1,te=!0),u.memoizedState=S):(Ra(S,h)||(S=jt(),cn.lanes|=S,Td|=S,u.baseState=!0),h)}function Fx(u,h){var S=sr;sr=S!==0&&4>S?S:4,u(!0);var P=kd.transition;kd.transition={};try{u(!1),h()}finally{sr=S,kd.transition=P}}function Px(){return ws().memoizedState}function gv(u,h,S){var P=yu(u);if(S={lane:P,action:S,hasEagerState:!1,eagerState:null,next:null},yg(u))Dx(h,S);else if(S=_d(u,h,S,P),S!==null){var W=oi();Uo(S,u,P,W),ii(S,h,P)}}function Rx(u,h,S){var P=yu(u),W={lane:P,action:S,hasEagerState:!1,eagerState:null,next:null};if(yg(u))Dx(h,W);else{var Q=u.alternate;if(u.lanes===0&&(Q===null||Q.lanes===0)&&(Q=h.lastRenderedReducer,Q!==null))try{var de=h.lastRenderedState,Ae=Q(de,S);if(W.hasEagerState=!0,W.eagerState=Ae,Ra(Ae,de)){var Re=h.interleaved;Re===null?(W.next=W,ru(h)):(W.next=Re.next,Re.next=W),h.interleaved=W;return}}catch{}finally{}S=_d(u,h,W,P),S!==null&&(W=oi(),Uo(S,u,P,W),ii(S,h,P))}}function yg(u){var h=u.alternate;return u===cn||h!==null&&h===cn}function Dx(u,h){vl=Ui=!0;var S=u.pending;S===null?h.next=h:(h.next=S.next,S.next=h),u.pending=h}function ii(u,h,S){if((S&4194240)!==0){var P=h.lanes;P&=u.pendingLanes,S|=P,h.lanes=S,Mn(u,S)}}var du={readContext:pa,useCallback:as,useContext:as,useEffect:as,useImperativeHandle:as,useInsertionEffect:as,useLayoutEffect:as,useMemo:as,useReducer:as,useRef:as,useState:as,useDebugValue:as,useDeferredValue:as,useTransition:as,useMutableSource:as,useSyncExternalStore:as,useId:as,unstable_isNewReconciler:!1},mv={readContext:pa,useCallback:function(u,h){return Tn().memoizedState=[u,h===void 0?null:h],u},useContext:pa,useEffect:Nx,useImperativeHandle:function(u,h,S){return S=S!=null?S.concat([u]):null,uu(4194308,4,_l.bind(null,h,u),S)},useLayoutEffect:function(u,h){return uu(4194308,4,u,h)},useInsertionEffect:function(u,h){return uu(4,2,u,h)},useMemo:function(u,h){var S=Tn();return h=h===void 0?null:h,u=u(),S.memoizedState=[u,h],u},useReducer:function(u,h,S){var P=Tn();return h=S!==void 0?S(h):h,P.memoizedState=P.baseState=h,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:h},P.queue=u,u=u.dispatch=gv.bind(null,cn,u),[P.memoizedState,u]},useRef:function(u){var h=Tn();return u={current:u},h.memoizedState=u},useState:wl,useDebugValue:Oo,useDeferredValue:function(u){return Tn().memoizedState=u},useTransition:function(){var u=wl(!1),h=u[0];return u=Fx.bind(null,u[1]),Tn().memoizedState=u,[h,u]},useMutableSource:function(){},useSyncExternalStore:function(u,h,S){var P=cn,W=Tn();if(sn){if(S===void 0)throw Error(r(407));S=S()}else{if(S=h(),ra===null)throw Error(r(349));(xa&30)!==0||Ex(P,h,S)}W.memoizedState=S;var Q={value:S,getSnapshot:h};return W.queue=Q,Nx(dg.bind(null,P,Q,u),[u]),P.flags|=2048,cu(9,Mo.bind(null,P,Q,S,h),void 0,null),S},useId:function(){var u=Tn(),h=ra.identifierPrefix;if(sn){var S=jn,P=ti;S=(P&~(1<<32-cr(P)-1)).toString(32)+S,h=":"+h+"R"+S,S=wi++,0<S&&(h+="H"+S.toString(32)),h+=":"}else S=fh++,h=":"+h+"r"+S.toString(32)+":";return u.memoizedState=h},unstable_isNewReconciler:!1},bl={readContext:pa,useCallback:xg,useContext:pa,useEffect:gg,useImperativeHandle:Ax,useInsertionEffect:mg,useLayoutEffect:pg,useMemo:En,useReducer:ea,useRef:hg,useState:function(){return ea(Zs)},useDebugValue:Oo,useDeferredValue:function(u){var h=ws();return jx(h,Vn.memoizedState,u)},useTransition:function(){var u=ea(Zs)[0],h=ws().memoizedState;return[u,h]},useMutableSource:gh,useSyncExternalStore:mh,useId:Px,unstable_isNewReconciler:!1},xh={readContext:pa,useCallback:xg,useContext:pa,useEffect:gg,useImperativeHandle:Ax,useInsertionEffect:mg,useLayoutEffect:pg,useMemo:En,useReducer:hh,useRef:hg,useState:function(){return hh(Zs)},useDebugValue:Oo,useDeferredValue:function(u){var h=ws();return Vn===null?h.memoizedState=u:jx(h,Vn.memoizedState,u)},useTransition:function(){var u=hh(Zs)[0],h=ws().memoizedState;return[u,h]},useMutableSource:gh,useSyncExternalStore:mh,useId:Px,unstable_isNewReconciler:!1};function zs(u,h){if(u&&u.defaultProps){h=V({},h),u=u.defaultProps;for(var S in u)h[S]===void 0&&(h[S]=u[S]);return h}return h}function fu(u,h,S,P){h=u.memoizedState,S=S(P,h),S=S==null?h:V({},h,S),u.memoizedState=S,u.lanes===0&&(u.updateQueue.baseState=S)}var hu={isMounted:function(u){return(u=u._reactInternals)?ke(u)===u:!1},enqueueSetState:function(u,h,S){u=u._reactInternals;var P=oi(),W=yu(u),Q=so(P,W);Q.payload=h,S!=null&&(Q.callback=S),h=ao(u,Q,W),h!==null&&(Uo(h,u,W,P),dh(h,u,W))},enqueueReplaceState:function(u,h,S){u=u._reactInternals;var P=oi(),W=yu(u),Q=so(P,W);Q.tag=1,Q.payload=h,S!=null&&(Q.callback=S),h=ao(u,Q,W),h!==null&&(Uo(h,u,W,P),dh(h,u,W))},enqueueForceUpdate:function(u,h){u=u._reactInternals;var S=oi(),P=yu(u),W=so(S,P);W.tag=2,h!=null&&(W.callback=h),h=ao(u,W,P),h!==null&&(Uo(h,u,P,S),dh(h,u,P))}};function yh(u,h,S,P,W,Q,de){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(P,Q,de):h.prototype&&h.prototype.isPureReactComponent?!ql(S,P)||!ql(W,Q):!0}function Ix(u,h,S){var P=!1,W=eo,Q=h.contextType;return typeof Q=="object"&&Q!==null?Q=pa(Q):(W=Js(h)?hl:Ws.current,P=h.contextTypes,Q=(P=P!=null)?nc(u,W):eo),h=new h(S,Q),u.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=hu,u.stateNode=h,h._reactInternals=u,P&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=W,u.__reactInternalMemoizedMaskedChildContext=Q),h}function vg(u,h,S,P){u=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(S,P),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(S,P),h.state!==u&&hu.enqueueReplaceState(h,h.state,null)}function vh(u,h,S,P){var W=u.stateNode;W.props=S,W.state=u.memoizedState,W.refs={},bd(u);var Q=h.contextType;typeof Q=="object"&&Q!==null?W.context=pa(Q):(Q=Js(h)?hl:Ws.current,W.context=nc(u,Q)),W.state=u.memoizedState,Q=h.getDerivedStateFromProps,typeof Q=="function"&&(fu(u,h,Q,S),W.state=u.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof W.getSnapshotBeforeUpdate=="function"||typeof W.UNSAFE_componentWillMount!="function"&&typeof W.componentWillMount!="function"||(h=W.state,typeof W.componentWillMount=="function"&&W.componentWillMount(),typeof W.UNSAFE_componentWillMount=="function"&&W.UNSAFE_componentWillMount(),h!==W.state&&hu.enqueueReplaceState(W,W.state,null),nu(u,S,W,P),W.state=u.memoizedState),typeof W.componentDidMount=="function"&&(u.flags|=4194308)}function fc(u,h){try{var S="",P=h;do S+=K(P),P=P.return;while(P);var W=S}catch(Q){W=`
Error generating stack: `+Q.message+`
`+Q.stack}return{value:u,source:h,stack:W,digest:null}}function wh(u,h,S){return{value:u,source:null,stack:S??null,digest:h??null}}function gu(u,h){try{console.error(h.value)}catch(S){setTimeout(function(){throw S})}}var pv=typeof WeakMap=="function"?WeakMap:Map;function Mx(u,h,S){S=so(-1,S),S.tag=3,S.payload={element:null};var P=h.value;return S.callback=function(){$x||($x=!0,Tv=P),gu(u,h)},S}function m(u,h,S){S=so(-1,S),S.tag=3;var P=u.type.getDerivedStateFromError;if(typeof P=="function"){var W=h.value;S.payload=function(){return P(W)},S.callback=function(){gu(u,h)}}var Q=u.stateNode;return Q!==null&&typeof Q.componentDidCatch=="function"&&(S.callback=function(){gu(u,h),typeof P!="function"&&(pu===null?pu=new Set([this]):pu.add(this));var de=h.stack;this.componentDidCatch(h.value,{componentStack:de!==null?de:""})}),S}function x(u,h,S){var P=u.pingCache;if(P===null){P=u.pingCache=new pv;var W=new Set;P.set(h,W)}else W=P.get(h),W===void 0&&(W=new Set,P.set(h,W));W.has(S)||(W.add(S),u=_P.bind(null,u,h,S),h.then(u,u))}function j(u){do{var h;if((h=u.tag===13)&&(h=u.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return u;u=u.return}while(u!==null);return null}function O(u,h,S,P,W){return(u.mode&1)===0?(u===h?u.flags|=65536:(u.flags|=128,S.flags|=131072,S.flags&=-52805,S.tag===1&&(S.alternate===null?S.tag=17:(h=so(-1,1),h.tag=2,ao(S,h,1))),S.lanes|=1),u):(u.flags|=65536,u.lanes=W,u)}var H=T.ReactCurrentOwner,te=!1;function ye(u,h,S,P){h.child=u===null?vi(h,null,S,P):cc(h,u.child,S,P)}function Be(u,h,S,P,W){S=S.render;var Q=h.ref;return Do(h,W),P=ou(u,h,S,P,Q,W),S=lu(),u!==null&&!te?(h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~W,ta(u,h,W)):(sn&&S&&Zc(h),h.flags|=1,ye(u,h,P,W),h.child)}function lt(u,h,S,P,W){if(u===null){var Q=S.type;return typeof Q=="function"&&!Rv(Q)&&Q.defaultProps===void 0&&S.compare===null&&S.defaultProps===void 0?(h.tag=15,h.type=Q,Dt(u,h,Q,P,W)):(u=Kx(S.type,null,P,h,h.mode,W),u.ref=h.ref,u.return=h,h.child=u)}if(Q=u.child,(u.lanes&W)===0){var de=Q.memoizedProps;if(S=S.compare,S=S!==null?S:ql,S(de,P)&&u.ref===h.ref)return ta(u,h,W)}return h.flags|=1,u=wu(Q,P),u.ref=h.ref,u.return=h,h.child=u}function Dt(u,h,S,P,W){if(u!==null){var Q=u.memoizedProps;if(ql(Q,P)&&u.ref===h.ref)if(te=!1,h.pendingProps=P=Q,(u.lanes&W)!==0)(u.flags&131072)!==0&&(te=!0);else return h.lanes=u.lanes,ta(u,h,W)}return Qt(u,h,S,P,W)}function ar(u,h,S){var P=h.pendingProps,W=P.children,Q=u!==null?u.memoizedState:null;if(P.mode==="hidden")if((h.mode&1)===0)h.memoizedState={baseLanes:0,cachePool:null,transitions:null},fn(bh,$i),$i|=S;else{if((S&1073741824)===0)return u=Q!==null?Q.baseLanes|S:S,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:u,cachePool:null,transitions:null},h.updateQueue=null,fn(bh,$i),$i|=u,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},P=Q!==null?Q.baseLanes:S,fn(bh,$i),$i|=P}else Q!==null?(P=Q.baseLanes|S,h.memoizedState=null):P=S,fn(bh,$i),$i|=P;return ye(u,h,W,S),h.child}function Er(u,h){var S=h.ref;(u===null&&S!==null||u!==null&&u.ref!==S)&&(h.flags|=512,h.flags|=2097152)}function Qt(u,h,S,P,W){var Q=Js(S)?hl:Ws.current;return Q=nc(h,Q),Do(h,W),S=ou(u,h,S,P,Q,W),P=lu(),u!==null&&!te?(h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~W,ta(u,h,W)):(sn&&P&&Zc(h),h.flags|=1,ye(u,h,S,W),h.child)}function bn(u,h,S,P,W){if(Js(S)){var Q=!0;sc(h)}else Q=!1;if(Do(h,W),h.stateNode===null)Vr(u,h),Ix(h,S,P),vh(h,S,P,W),P=!0;else if(u===null){var de=h.stateNode,Ae=h.memoizedProps;de.props=Ae;var Re=de.context,ot=S.contextType;typeof ot=="object"&&ot!==null?ot=pa(ot):(ot=Js(S)?hl:Ws.current,ot=nc(h,ot));var Nt=S.getDerivedStateFromProps,Rt=typeof Nt=="function"||typeof de.getSnapshotBeforeUpdate=="function";Rt||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(Ae!==P||Re!==ot)&&vg(h,de,P,ot),no=!1;var Et=h.memoizedState;de.state=Et,nu(h,P,de,W),Re=h.memoizedState,Ae!==P||Et!==Re||Ys.current||no?(typeof Nt=="function"&&(fu(h,S,Nt,P),Re=h.memoizedState),(Ae=no||yh(h,S,Ae,P,Et,Re,ot))?(Rt||typeof de.UNSAFE_componentWillMount!="function"&&typeof de.componentWillMount!="function"||(typeof de.componentWillMount=="function"&&de.componentWillMount(),typeof de.UNSAFE_componentWillMount=="function"&&de.UNSAFE_componentWillMount()),typeof de.componentDidMount=="function"&&(h.flags|=4194308)):(typeof de.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=P,h.memoizedState=Re),de.props=P,de.state=Re,de.context=ot,P=Ae):(typeof de.componentDidMount=="function"&&(h.flags|=4194308),P=!1)}else{de=h.stateNode,uh(u,h),Ae=h.memoizedProps,ot=h.type===h.elementType?Ae:zs(h.type,Ae),de.props=ot,Rt=h.pendingProps,Et=de.context,Re=S.contextType,typeof Re=="object"&&Re!==null?Re=pa(Re):(Re=Js(S)?hl:Ws.current,Re=nc(h,Re));var tr=S.getDerivedStateFromProps;(Nt=typeof tr=="function"||typeof de.getSnapshotBeforeUpdate=="function")||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(Ae!==Rt||Et!==Re)&&vg(h,de,P,Re),no=!1,Et=h.memoizedState,de.state=Et,nu(h,P,de,W);var or=h.memoizedState;Ae!==Rt||Et!==or||Ys.current||no?(typeof tr=="function"&&(fu(h,S,tr,P),or=h.memoizedState),(ot=no||yh(h,S,ot,P,Et,or,Re)||!1)?(Nt||typeof de.UNSAFE_componentWillUpdate!="function"&&typeof de.componentWillUpdate!="function"||(typeof de.componentWillUpdate=="function"&&de.componentWillUpdate(P,or,Re),typeof de.UNSAFE_componentWillUpdate=="function"&&de.UNSAFE_componentWillUpdate(P,or,Re)),typeof de.componentDidUpdate=="function"&&(h.flags|=4),typeof de.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof de.componentDidUpdate!="function"||Ae===u.memoizedProps&&Et===u.memoizedState||(h.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||Ae===u.memoizedProps&&Et===u.memoizedState||(h.flags|=1024),h.memoizedProps=P,h.memoizedState=or),de.props=P,de.state=or,de.context=Re,P=ot):(typeof de.componentDidUpdate!="function"||Ae===u.memoizedProps&&Et===u.memoizedState||(h.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||Ae===u.memoizedProps&&Et===u.memoizedState||(h.flags|=1024),P=!1)}return an(u,h,S,P,Q,W)}function an(u,h,S,P,W,Q){Er(u,h);var de=(h.flags&128)!==0;if(!P&&!de)return W&&kx(h,S,!1),ta(u,h,Q);P=h.stateNode,H.current=h;var Ae=de&&typeof S.getDerivedStateFromError!="function"?null:P.render();return h.flags|=1,u!==null&&de?(h.child=cc(h,u.child,null,Q),h.child=cc(h,null,Ae,Q)):ye(u,h,Ae,Q),h.memoizedState=P.state,W&&kx(h,S,!0),h.child}function ya(u){var h=u.stateNode;h.pendingContext?og(u,h.pendingContext,h.pendingContext!==h.context):h.context&&og(u,h.context,!1),yl(u,h.containerInfo)}function io(u,h,S,P,W){return lc(),vd(W),h.flags|=256,ye(u,h,S,P),h.child}var st={dehydrated:null,treeContext:null,retryLane:0};function ze(u){return{baseLanes:u,cachePool:null,transitions:null}}function ft(u,h,S){var P=h.pendingProps,W=_n.current,Q=!1,de=(h.flags&128)!==0,Ae;if((Ae=de)||(Ae=u!==null&&u.memoizedState===null?!1:(W&2)!==0),Ae?(Q=!0,h.flags&=-129):(u===null||u.memoizedState!==null)&&(W|=1),fn(_n,W&1),u===null)return eu(h),u=h.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((h.mode&1)===0?h.lanes=1:u.data==="$!"?h.lanes=8:h.lanes=1073741824,null):(de=P.children,u=P.fallback,Q?(P=h.mode,Q=h.child,de={mode:"hidden",children:de},(P&1)===0&&Q!==null?(Q.childLanes=0,Q.pendingProps=de):Q=qx(de,P,0,null),u=jd(u,P,S,null),Q.return=h,u.return=h,Q.sibling=u,h.child=Q,h.child.memoizedState=ze(S),h.memoizedState=st,u):Zt(h,de));if(W=u.memoizedState,W!==null&&(Ae=W.dehydrated,Ae!==null))return Rr(u,h,de,P,Ae,W,S);if(Q){Q=P.fallback,de=h.mode,W=u.child,Ae=W.sibling;var Re={mode:"hidden",children:P.children};return(de&1)===0&&h.child!==W?(P=h.child,P.childLanes=0,P.pendingProps=Re,h.deletions=null):(P=wu(W,Re),P.subtreeFlags=W.subtreeFlags&14680064),Ae!==null?Q=wu(Ae,Q):(Q=jd(Q,de,S,null),Q.flags|=2),Q.return=h,P.return=h,P.sibling=Q,h.child=P,P=Q,Q=h.child,de=u.child.memoizedState,de=de===null?ze(S):{baseLanes:de.baseLanes|S,cachePool:null,transitions:de.transitions},Q.memoizedState=de,Q.childLanes=u.childLanes&~S,h.memoizedState=st,P}return Q=u.child,u=Q.sibling,P=wu(Q,{mode:"visible",children:P.children}),(h.mode&1)===0&&(P.lanes=S),P.return=h,P.sibling=null,u!==null&&(S=h.deletions,S===null?(h.deletions=[u],h.flags|=16):S.push(u)),h.child=P,h.memoizedState=null,P}function Zt(u,h){return h=qx({mode:"visible",children:h},u.mode,0,null),h.return=u,u.child=h}function hr(u,h,S,P){return P!==null&&vd(P),cc(h,u.child,null,S),u=Zt(h,h.pendingProps.children),u.flags|=2,h.memoizedState=null,u}function Rr(u,h,S,P,W,Q,de){if(S)return h.flags&256?(h.flags&=-257,P=wh(Error(r(422))),hr(u,h,de,P)):h.memoizedState!==null?(h.child=u.child,h.flags|=128,null):(Q=P.fallback,W=h.mode,P=qx({mode:"visible",children:P.children},W,0,null),Q=jd(Q,W,de,null),Q.flags|=2,P.return=h,Q.return=h,P.sibling=Q,h.child=P,(h.mode&1)!==0&&cc(h,u.child,null,de),h.child.memoizedState=ze(de),h.memoizedState=st,Q);if((h.mode&1)===0)return hr(u,h,de,null);if(W.data==="$!"){if(P=W.nextSibling&&W.nextSibling.dataset,P)var Ae=P.dgst;return P=Ae,Q=Error(r(419)),P=wh(Q,P,void 0),hr(u,h,de,P)}if(Ae=(de&u.childLanes)!==0,te||Ae){if(P=ra,P!==null){switch(de&-de){case 4:W=2;break;case 16:W=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:W=32;break;case 536870912:W=268435456;break;default:W=0}W=(W&(P.suspendedLanes|de))!==0?0:W,W!==0&&W!==Q.retryLane&&(Q.retryLane=W,ai(u,W),Uo(P,u,W,-1))}return Pv(),P=wh(Error(r(421))),hr(u,h,de,P)}return W.data==="$?"?(h.flags|=128,h.child=u.child,h=bP.bind(null,u),W._reactRetry=h,null):(u=Q.treeContext,qt=Qi(W.nextSibling),ri=h,sn=!0,ni=null,u!==null&&(ga[ma++]=ti,ga[ma++]=jn,ga[ma++]=xl,ti=u.id,jn=u.overflow,xl=h),h=Zt(h,P.children),h.flags|=4096,h)}function Nr(u,h,S){u.lanes|=h;var P=u.alternate;P!==null&&(P.lanes|=h),ch(u.return,h,S)}function qr(u,h,S,P,W){var Q=u.memoizedState;Q===null?u.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:P,tail:S,tailMode:W}:(Q.isBackwards=h,Q.rendering=null,Q.renderingStartTime=0,Q.last=P,Q.tail=S,Q.tailMode=W)}function _s(u,h,S){var P=h.pendingProps,W=P.revealOrder,Q=P.tail;if(ye(u,h,P.children,S),P=_n.current,(P&2)!==0)P=P&1|2,h.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=h.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&Nr(u,S,h);else if(u.tag===19)Nr(u,S,h);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===h)break e;for(;u.sibling===null;){if(u.return===null||u.return===h)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}P&=1}if(fn(_n,P),(h.mode&1)===0)h.memoizedState=null;else switch(W){case"forwards":for(S=h.child,W=null;S!==null;)u=S.alternate,u!==null&&au(u)===null&&(W=S),S=S.sibling;S=W,S===null?(W=h.child,h.child=null):(W=S.sibling,S.sibling=null),qr(h,!1,W,S,Q);break;case"backwards":for(S=null,W=h.child,h.child=null;W!==null;){if(u=W.alternate,u!==null&&au(u)===null){h.child=W;break}u=W.sibling,W.sibling=S,S=W,W=u}qr(h,!0,S,null,Q);break;case"together":qr(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function Vr(u,h){(h.mode&1)===0&&u!==null&&(u.alternate=null,h.alternate=null,h.flags|=2)}function ta(u,h,S){if(u!==null&&(h.dependencies=u.dependencies),Td|=h.lanes,(S&h.childLanes)===0)return null;if(u!==null&&h.child!==u.child)throw Error(r(153));if(h.child!==null){for(u=h.child,S=wu(u,u.pendingProps),h.child=S,S.return=h;u.sibling!==null;)u=u.sibling,S=S.sibling=wu(u,u.pendingProps),S.return=h;S.sibling=null}return h.child}function xv(u,h,S){switch(h.tag){case 3:ya(h),lc();break;case 5:su(h);break;case 1:Js(h.type)&&sc(h);break;case 4:yl(h,h.stateNode.containerInfo);break;case 10:var P=h.type._context,W=h.memoizedProps.value;fn(wd,P._currentValue),P._currentValue=W;break;case 13:if(P=h.memoizedState,P!==null)return P.dehydrated!==null?(fn(_n,_n.current&1),h.flags|=128,null):(S&h.child.childLanes)!==0?ft(u,h,S):(fn(_n,_n.current&1),u=ta(u,h,S),u!==null?u.sibling:null);fn(_n,_n.current&1);break;case 19:if(P=(S&h.childLanes)!==0,(u.flags&128)!==0){if(P)return _s(u,h,S);h.flags|=128}if(W=h.memoizedState,W!==null&&(W.rendering=null,W.tail=null,W.lastEffect=null),fn(_n,_n.current),P)break;return null;case 22:case 23:return h.lanes=0,ar(u,h,S)}return ta(u,h,S)}var GS,yv,VS,KS;GS=function(u,h){for(var S=h.child;S!==null;){if(S.tag===5||S.tag===6)u.appendChild(S.stateNode);else if(S.tag!==4&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===h)break;for(;S.sibling===null;){if(S.return===null||S.return===h)return;S=S.return}S.sibling.return=S.return,S=S.sibling}},yv=function(){},VS=function(u,h,S,P){var W=u.memoizedProps;if(W!==P){u=h.stateNode,vs(hn.current);var Q=null;switch(S){case"input":W=Ue(u,W),P=Ue(u,P),Q=[];break;case"select":W=V({},W,{value:void 0}),P=V({},P,{value:void 0}),Q=[];break;case"textarea":W=Qe(u,W),P=Qe(u,P),Q=[];break;default:typeof W.onClick!="function"&&typeof P.onClick=="function"&&(u.onclick=ec)}mt(S,P);var de;S=null;for(ot in W)if(!P.hasOwnProperty(ot)&&W.hasOwnProperty(ot)&&W[ot]!=null)if(ot==="style"){var Ae=W[ot];for(de in Ae)Ae.hasOwnProperty(de)&&(S||(S={}),S[de]="")}else ot!=="dangerouslySetInnerHTML"&&ot!=="children"&&ot!=="suppressContentEditableWarning"&&ot!=="suppressHydrationWarning"&&ot!=="autoFocus"&&(s.hasOwnProperty(ot)?Q||(Q=[]):(Q=Q||[]).push(ot,null));for(ot in P){var Re=P[ot];if(Ae=W?.[ot],P.hasOwnProperty(ot)&&Re!==Ae&&(Re!=null||Ae!=null))if(ot==="style")if(Ae){for(de in Ae)!Ae.hasOwnProperty(de)||Re&&Re.hasOwnProperty(de)||(S||(S={}),S[de]="");for(de in Re)Re.hasOwnProperty(de)&&Ae[de]!==Re[de]&&(S||(S={}),S[de]=Re[de])}else S||(Q||(Q=[]),Q.push(ot,S)),S=Re;else ot==="dangerouslySetInnerHTML"?(Re=Re?Re.__html:void 0,Ae=Ae?Ae.__html:void 0,Re!=null&&Ae!==Re&&(Q=Q||[]).push(ot,Re)):ot==="children"?typeof Re!="string"&&typeof Re!="number"||(Q=Q||[]).push(ot,""+Re):ot!=="suppressContentEditableWarning"&&ot!=="suppressHydrationWarning"&&(s.hasOwnProperty(ot)?(Re!=null&&ot==="onScroll"&&vn("scroll",u),Q||Ae===Re||(Q=[])):(Q=Q||[]).push(ot,Re))}S&&(Q=Q||[]).push("style",S);var ot=Q;(h.updateQueue=ot)&&(h.flags|=4)}},KS=function(u,h,S,P){S!==P&&(h.flags|=4)};function wg(u,h){if(!sn)switch(u.tailMode){case"hidden":h=u.tail;for(var S=null;h!==null;)h.alternate!==null&&(S=h),h=h.sibling;S===null?u.tail=null:S.sibling=null;break;case"collapsed":S=u.tail;for(var P=null;S!==null;)S.alternate!==null&&(P=S),S=S.sibling;P===null?h||u.tail===null?u.tail=null:u.tail.sibling=null:P.sibling=null}}function Ia(u){var h=u.alternate!==null&&u.alternate.child===u.child,S=0,P=0;if(h)for(var W=u.child;W!==null;)S|=W.lanes|W.childLanes,P|=W.subtreeFlags&14680064,P|=W.flags&14680064,W.return=u,W=W.sibling;else for(W=u.child;W!==null;)S|=W.lanes|W.childLanes,P|=W.subtreeFlags,P|=W.flags,W.return=u,W=W.sibling;return u.subtreeFlags|=P,u.childLanes=S,h}function dP(u,h,S){var P=h.pendingProps;switch(Fs(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ia(h),null;case 1:return Js(h.type)&&Jc(),Ia(h),null;case 3:return P=h.stateNode,Pn(),wn(Ys),wn(Ws),Qs(),P.pendingContext&&(P.context=P.pendingContext,P.pendingContext=null),(u===null||u.child===null)&&(yd(h)?h.flags|=4:u===null||u.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,ni!==null&&(Av(ni),ni=null))),yv(u,h),Ia(h),null;case 5:Io(h);var W=vs(Qn.current);if(S=h.type,u!==null&&h.stateNode!=null)VS(u,h,S,P,W),u.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!P){if(h.stateNode===null)throw Error(r(166));return Ia(h),null}if(u=vs(hn.current),yd(h)){P=h.stateNode,S=h.type;var Q=h.memoizedProps;switch(P[yi]=h,P[md]=Q,u=(h.mode&1)!==0,S){case"dialog":vn("cancel",P),vn("close",P);break;case"iframe":case"object":case"embed":vn("load",P);break;case"video":case"audio":for(W=0;W<ul.length;W++)vn(ul[W],P);break;case"source":vn("error",P);break;case"img":case"image":case"link":vn("error",P),vn("load",P);break;case"details":vn("toggle",P);break;case"input":Ge(P,Q),vn("invalid",P);break;case"select":P._wrapperState={wasMultiple:!!Q.multiple},vn("invalid",P);break;case"textarea":_t(P,Q),vn("invalid",P)}mt(S,Q),W=null;for(var de in Q)if(Q.hasOwnProperty(de)){var Ae=Q[de];de==="children"?typeof Ae=="string"?P.textContent!==Ae&&(Q.suppressHydrationWarning!==!0&&hd(P.textContent,Ae,u),W=["children",Ae]):typeof Ae=="number"&&P.textContent!==""+Ae&&(Q.suppressHydrationWarning!==!0&&hd(P.textContent,Ae,u),W=["children",""+Ae]):s.hasOwnProperty(de)&&Ae!=null&&de==="onScroll"&&vn("scroll",P)}switch(S){case"input":Ne(P),Ft(P,Q,!0);break;case"textarea":Ne(P),Bt(P);break;case"select":case"option":break;default:typeof Q.onClick=="function"&&(P.onclick=ec)}P=W,h.updateQueue=P,P!==null&&(h.flags|=4)}else{de=W.nodeType===9?W:W.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=Ut(S)),u==="http://www.w3.org/1999/xhtml"?S==="script"?(u=de.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof P.is=="string"?u=de.createElement(S,{is:P.is}):(u=de.createElement(S),S==="select"&&(de=u,P.multiple?de.multiple=!0:P.size&&(de.size=P.size))):u=de.createElementNS(u,S),u[yi]=h,u[md]=P,GS(u,h,!1,!1),h.stateNode=u;e:{switch(de=At(S,P),S){case"dialog":vn("cancel",u),vn("close",u),W=P;break;case"iframe":case"object":case"embed":vn("load",u),W=P;break;case"video":case"audio":for(W=0;W<ul.length;W++)vn(ul[W],u);W=P;break;case"source":vn("error",u),W=P;break;case"img":case"image":case"link":vn("error",u),vn("load",u),W=P;break;case"details":vn("toggle",u),W=P;break;case"input":Ge(u,P),W=Ue(u,P),vn("invalid",u);break;case"option":W=P;break;case"select":u._wrapperState={wasMultiple:!!P.multiple},W=V({},P,{value:void 0}),vn("invalid",u);break;case"textarea":_t(u,P),W=Qe(u,P),vn("invalid",u);break;default:W=P}mt(S,W),Ae=W;for(Q in Ae)if(Ae.hasOwnProperty(Q)){var Re=Ae[Q];Q==="style"?De(u,Re):Q==="dangerouslySetInnerHTML"?(Re=Re?Re.__html:void 0,Re!=null&&xt(u,Re)):Q==="children"?typeof Re=="string"?(S!=="textarea"||Re!=="")&&ut(u,Re):typeof Re=="number"&&ut(u,""+Re):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(s.hasOwnProperty(Q)?Re!=null&&Q==="onScroll"&&vn("scroll",u):Re!=null&&w(u,Q,Re,de))}switch(S){case"input":Ne(u),Ft(u,P,!1);break;case"textarea":Ne(u),Bt(u);break;case"option":P.value!=null&&u.setAttribute("value",""+ne(P.value));break;case"select":u.multiple=!!P.multiple,Q=P.value,Q!=null?Pe(u,!!P.multiple,Q,!1):P.defaultValue!=null&&Pe(u,!!P.multiple,P.defaultValue,!0);break;default:typeof W.onClick=="function"&&(u.onclick=ec)}switch(S){case"button":case"input":case"select":case"textarea":P=!!P.autoFocus;break e;case"img":P=!0;break e;default:P=!1}}P&&(h.flags|=4)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return Ia(h),null;case 6:if(u&&h.stateNode!=null)KS(u,h,u.memoizedProps,P);else{if(typeof P!="string"&&h.stateNode===null)throw Error(r(166));if(S=vs(Qn.current),vs(hn.current),yd(h)){if(P=h.stateNode,S=h.memoizedProps,P[yi]=h,(Q=P.nodeValue!==S)&&(u=ri,u!==null))switch(u.tag){case 3:hd(P.nodeValue,S,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&hd(P.nodeValue,S,(u.mode&1)!==0)}Q&&(h.flags|=4)}else P=(S.nodeType===9?S:S.ownerDocument).createTextNode(P),P[yi]=h,h.stateNode=P}return Ia(h),null;case 13:if(wn(_n),P=h.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(sn&&qt!==null&&(h.mode&1)!==0&&(h.flags&128)===0)cg(),lc(),h.flags|=98560,Q=!1;else if(Q=yd(h),P!==null&&P.dehydrated!==null){if(u===null){if(!Q)throw Error(r(318));if(Q=h.memoizedState,Q=Q!==null?Q.dehydrated:null,!Q)throw Error(r(317));Q[yi]=h}else lc(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Ia(h),Q=!1}else ni!==null&&(Av(ni),ni=null),Q=!0;if(!Q)return h.flags&65536?h:null}return(h.flags&128)!==0?(h.lanes=S,h):(P=P!==null,P!==(u!==null&&u.memoizedState!==null)&&P&&(h.child.flags|=8192,(h.mode&1)!==0&&(u===null||(_n.current&1)!==0?Hs===0&&(Hs=3):Pv())),h.updateQueue!==null&&(h.flags|=4),Ia(h),null);case 4:return Pn(),yv(u,h),u===null&&Ql(h.stateNode.containerInfo),Ia(h),null;case 10:return lh(h.type._context),Ia(h),null;case 17:return Js(h.type)&&Jc(),Ia(h),null;case 19:if(wn(_n),Q=h.memoizedState,Q===null)return Ia(h),null;if(P=(h.flags&128)!==0,de=Q.rendering,de===null)if(P)wg(Q,!1);else{if(Hs!==0||u!==null&&(u.flags&128)!==0)for(u=h.child;u!==null;){if(de=au(u),de!==null){for(h.flags|=128,wg(Q,!1),P=de.updateQueue,P!==null&&(h.updateQueue=P,h.flags|=4),h.subtreeFlags=0,P=S,S=h.child;S!==null;)Q=S,u=P,Q.flags&=14680066,de=Q.alternate,de===null?(Q.childLanes=0,Q.lanes=u,Q.child=null,Q.subtreeFlags=0,Q.memoizedProps=null,Q.memoizedState=null,Q.updateQueue=null,Q.dependencies=null,Q.stateNode=null):(Q.childLanes=de.childLanes,Q.lanes=de.lanes,Q.child=de.child,Q.subtreeFlags=0,Q.deletions=null,Q.memoizedProps=de.memoizedProps,Q.memoizedState=de.memoizedState,Q.updateQueue=de.updateQueue,Q.type=de.type,u=de.dependencies,Q.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),S=S.sibling;return fn(_n,_n.current&1|2),h.child}u=u.sibling}Q.tail!==null&&Le()>Sh&&(h.flags|=128,P=!0,wg(Q,!1),h.lanes=4194304)}else{if(!P)if(u=au(de),u!==null){if(h.flags|=128,P=!0,S=u.updateQueue,S!==null&&(h.updateQueue=S,h.flags|=4),wg(Q,!0),Q.tail===null&&Q.tailMode==="hidden"&&!de.alternate&&!sn)return Ia(h),null}else 2*Le()-Q.renderingStartTime>Sh&&S!==1073741824&&(h.flags|=128,P=!0,wg(Q,!1),h.lanes=4194304);Q.isBackwards?(de.sibling=h.child,h.child=de):(S=Q.last,S!==null?S.sibling=de:h.child=de,Q.last=de)}return Q.tail!==null?(h=Q.tail,Q.rendering=h,Q.tail=h.sibling,Q.renderingStartTime=Le(),h.sibling=null,S=_n.current,fn(_n,P?S&1|2:S&1),h):(Ia(h),null);case 22:case 23:return Fv(),P=h.memoizedState!==null,u!==null&&u.memoizedState!==null!==P&&(h.flags|=8192),P&&(h.mode&1)!==0?($i&1073741824)!==0&&(Ia(h),h.subtreeFlags&6&&(h.flags|=8192)):Ia(h),null;case 24:return null;case 25:return null}throw Error(r(156,h.tag))}function fP(u,h){switch(Fs(h),h.tag){case 1:return Js(h.type)&&Jc(),u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 3:return Pn(),wn(Ys),wn(Ws),Qs(),u=h.flags,(u&65536)!==0&&(u&128)===0?(h.flags=u&-65537|128,h):null;case 5:return Io(h),null;case 13:if(wn(_n),u=h.memoizedState,u!==null&&u.dehydrated!==null){if(h.alternate===null)throw Error(r(340));lc()}return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 19:return wn(_n),null;case 4:return Pn(),null;case 10:return lh(h.type._context),null;case 22:case 23:return Fv(),null;case 24:return null;default:return null}}var Ox=!1,Ma=!1,hP=typeof WeakSet=="function"?WeakSet:Set,ir=null;function _h(u,h){var S=u.ref;if(S!==null)if(typeof S=="function")try{S(null)}catch(P){is(u,h,P)}else S.current=null}function vv(u,h,S){try{S()}catch(P){is(u,h,P)}}var qS=!1;function gP(u,h){if(ng=Df,u=xs(),Kc(u)){if("selectionStart"in u)var S={start:u.selectionStart,end:u.selectionEnd};else e:{S=(S=u.ownerDocument)&&S.defaultView||window;var P=S.getSelection&&S.getSelection();if(P&&P.rangeCount!==0){S=P.anchorNode;var W=P.anchorOffset,Q=P.focusNode;P=P.focusOffset;try{S.nodeType,Q.nodeType}catch{S=null;break e}var de=0,Ae=-1,Re=-1,ot=0,Nt=0,Rt=u,Et=null;t:for(;;){for(var tr;Rt!==S||W!==0&&Rt.nodeType!==3||(Ae=de+W),Rt!==Q||P!==0&&Rt.nodeType!==3||(Re=de+P),Rt.nodeType===3&&(de+=Rt.nodeValue.length),(tr=Rt.firstChild)!==null;)Et=Rt,Rt=tr;for(;;){if(Rt===u)break t;if(Et===S&&++ot===W&&(Ae=de),Et===Q&&++Nt===P&&(Re=de),(tr=Rt.nextSibling)!==null)break;Rt=Et,Et=Rt.parentNode}Rt=tr}S=Ae===-1||Re===-1?null:{start:Ae,end:Re}}else S=null}S=S||{start:0,end:0}}else S=null;for(sg={focusedElem:u,selectionRange:S},Df=!1,ir=h;ir!==null;)if(h=ir,u=h.child,(h.subtreeFlags&1028)!==0&&u!==null)u.return=h,ir=u;else for(;ir!==null;){h=ir;try{var or=h.alternate;if((h.flags&1024)!==0)switch(h.tag){case 0:case 11:case 15:break;case 1:if(or!==null){var lr=or.memoizedProps,bs=or.memoizedState,Ke=h.stateNode,Me=Ke.getSnapshotBeforeUpdate(h.elementType===h.type?lr:zs(h.type,lr),bs);Ke.__reactInternalSnapshotBeforeUpdate=Me}break;case 3:var tt=h.stateNode.containerInfo;tt.nodeType===1?tt.textContent="":tt.nodeType===9&&tt.documentElement&&tt.removeChild(tt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Ot){is(h,h.return,Ot)}if(u=h.sibling,u!==null){u.return=h.return,ir=u;break}ir=h.return}return or=qS,qS=!1,or}function _g(u,h,S){var P=h.updateQueue;if(P=P!==null?P.lastEffect:null,P!==null){var W=P=P.next;do{if((W.tag&u)===u){var Q=W.destroy;W.destroy=void 0,Q!==void 0&&vv(h,S,Q)}W=W.next}while(W!==P)}}function Lx(u,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var S=h=h.next;do{if((S.tag&u)===u){var P=S.create;S.destroy=P()}S=S.next}while(S!==h)}}function wv(u){var h=u.ref;if(h!==null){var S=u.stateNode;switch(u.tag){case 5:u=S;break;default:u=S}typeof h=="function"?h(u):h.current=u}}function XS(u){var h=u.alternate;h!==null&&(u.alternate=null,XS(h)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(h=u.stateNode,h!==null&&(delete h[yi],delete h[md],delete h[eh],delete h[bx],delete h[Sx])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function YS(u){return u.tag===5||u.tag===3||u.tag===4}function JS(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||YS(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function _v(u,h,S){var P=u.tag;if(P===5||P===6)u=u.stateNode,h?S.nodeType===8?S.parentNode.insertBefore(u,h):S.insertBefore(u,h):(S.nodeType===8?(h=S.parentNode,h.insertBefore(u,S)):(h=S,h.appendChild(u)),S=S._reactRootContainer,S!=null||h.onclick!==null||(h.onclick=ec));else if(P!==4&&(u=u.child,u!==null))for(_v(u,h,S),u=u.sibling;u!==null;)_v(u,h,S),u=u.sibling}function bv(u,h,S){var P=u.tag;if(P===5||P===6)u=u.stateNode,h?S.insertBefore(u,h):S.appendChild(u);else if(P!==4&&(u=u.child,u!==null))for(bv(u,h,S),u=u.sibling;u!==null;)bv(u,h,S),u=u.sibling}var va=null,Lo=!1;function mu(u,h,S){for(S=S.child;S!==null;)QS(u,h,S),S=S.sibling}function QS(u,h,S){if(Pr&&typeof Pr.onCommitFiberUnmount=="function")try{Pr.onCommitFiberUnmount(In,S)}catch{}switch(S.tag){case 5:Ma||_h(S,h);case 6:var P=va,W=Lo;va=null,mu(u,h,S),va=P,Lo=W,va!==null&&(Lo?(u=va,S=S.stateNode,u.nodeType===8?u.parentNode.removeChild(S):u.removeChild(S)):va.removeChild(S.stateNode));break;case 18:va!==null&&(Lo?(u=va,S=S.stateNode,u.nodeType===8?Zf(u.parentNode,S):u.nodeType===1&&Zf(u,S),Fa(u)):Zf(va,S.stateNode));break;case 4:P=va,W=Lo,va=S.stateNode.containerInfo,Lo=!0,mu(u,h,S),va=P,Lo=W;break;case 0:case 11:case 14:case 15:if(!Ma&&(P=S.updateQueue,P!==null&&(P=P.lastEffect,P!==null))){W=P=P.next;do{var Q=W,de=Q.destroy;Q=Q.tag,de!==void 0&&((Q&2)!==0||(Q&4)!==0)&&vv(S,h,de),W=W.next}while(W!==P)}mu(u,h,S);break;case 1:if(!Ma&&(_h(S,h),P=S.stateNode,typeof P.componentWillUnmount=="function"))try{P.props=S.memoizedProps,P.state=S.memoizedState,P.componentWillUnmount()}catch(Ae){is(S,h,Ae)}mu(u,h,S);break;case 21:mu(u,h,S);break;case 22:S.mode&1?(Ma=(P=Ma)||S.memoizedState!==null,mu(u,h,S),Ma=P):mu(u,h,S);break;default:mu(u,h,S)}}function ZS(u){var h=u.updateQueue;if(h!==null){u.updateQueue=null;var S=u.stateNode;S===null&&(S=u.stateNode=new hP),h.forEach(function(P){var W=SP.bind(null,u,P);S.has(P)||(S.add(P),P.then(W,W))})}}function Bo(u,h){var S=h.deletions;if(S!==null)for(var P=0;P<S.length;P++){var W=S[P];try{var Q=u,de=h,Ae=de;e:for(;Ae!==null;){switch(Ae.tag){case 5:va=Ae.stateNode,Lo=!1;break e;case 3:va=Ae.stateNode.containerInfo,Lo=!0;break e;case 4:va=Ae.stateNode.containerInfo,Lo=!0;break e}Ae=Ae.return}if(va===null)throw Error(r(160));QS(Q,de,W),va=null,Lo=!1;var Re=W.alternate;Re!==null&&(Re.return=null),W.return=null}catch(ot){is(W,h,ot)}}if(h.subtreeFlags&12854)for(h=h.child;h!==null;)ek(h,u),h=h.sibling}function ek(u,h){var S=u.alternate,P=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(Bo(h,u),Sl(u),P&4){try{_g(3,u,u.return),Lx(3,u)}catch(lr){is(u,u.return,lr)}try{_g(5,u,u.return)}catch(lr){is(u,u.return,lr)}}break;case 1:Bo(h,u),Sl(u),P&512&&S!==null&&_h(S,S.return);break;case 5:if(Bo(h,u),Sl(u),P&512&&S!==null&&_h(S,S.return),u.flags&32){var W=u.stateNode;try{ut(W,"")}catch(lr){is(u,u.return,lr)}}if(P&4&&(W=u.stateNode,W!=null)){var Q=u.memoizedProps,de=S!==null?S.memoizedProps:Q,Ae=u.type,Re=u.updateQueue;if(u.updateQueue=null,Re!==null)try{Ae==="input"&&Q.type==="radio"&&Q.name!=null&&Je(W,Q),At(Ae,de);var ot=At(Ae,Q);for(de=0;de<Re.length;de+=2){var Nt=Re[de],Rt=Re[de+1];Nt==="style"?De(W,Rt):Nt==="dangerouslySetInnerHTML"?xt(W,Rt):Nt==="children"?ut(W,Rt):w(W,Nt,Rt,ot)}switch(Ae){case"input":He(W,Q);break;case"textarea":gt(W,Q);break;case"select":var Et=W._wrapperState.wasMultiple;W._wrapperState.wasMultiple=!!Q.multiple;var tr=Q.value;tr!=null?Pe(W,!!Q.multiple,tr,!1):Et!==!!Q.multiple&&(Q.defaultValue!=null?Pe(W,!!Q.multiple,Q.defaultValue,!0):Pe(W,!!Q.multiple,Q.multiple?[]:"",!1))}W[md]=Q}catch(lr){is(u,u.return,lr)}}break;case 6:if(Bo(h,u),Sl(u),P&4){if(u.stateNode===null)throw Error(r(162));W=u.stateNode,Q=u.memoizedProps;try{W.nodeValue=Q}catch(lr){is(u,u.return,lr)}}break;case 3:if(Bo(h,u),Sl(u),P&4&&S!==null&&S.memoizedState.isDehydrated)try{Fa(h.containerInfo)}catch(lr){is(u,u.return,lr)}break;case 4:Bo(h,u),Sl(u);break;case 13:Bo(h,u),Sl(u),W=u.child,W.flags&8192&&(Q=W.memoizedState!==null,W.stateNode.isHidden=Q,!Q||W.alternate!==null&&W.alternate.memoizedState!==null||(Cv=Le())),P&4&&ZS(u);break;case 22:if(Nt=S!==null&&S.memoizedState!==null,u.mode&1?(Ma=(ot=Ma)||Nt,Bo(h,u),Ma=ot):Bo(h,u),Sl(u),P&8192){if(ot=u.memoizedState!==null,(u.stateNode.isHidden=ot)&&!Nt&&(u.mode&1)!==0)for(ir=u,Nt=u.child;Nt!==null;){for(Rt=ir=Nt;ir!==null;){switch(Et=ir,tr=Et.child,Et.tag){case 0:case 11:case 14:case 15:_g(4,Et,Et.return);break;case 1:_h(Et,Et.return);var or=Et.stateNode;if(typeof or.componentWillUnmount=="function"){P=Et,S=Et.return;try{h=P,or.props=h.memoizedProps,or.state=h.memoizedState,or.componentWillUnmount()}catch(lr){is(P,S,lr)}}break;case 5:_h(Et,Et.return);break;case 22:if(Et.memoizedState!==null){nk(Rt);continue}}tr!==null?(tr.return=Et,ir=tr):nk(Rt)}Nt=Nt.sibling}e:for(Nt=null,Rt=u;;){if(Rt.tag===5){if(Nt===null){Nt=Rt;try{W=Rt.stateNode,ot?(Q=W.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none"):(Ae=Rt.stateNode,Re=Rt.memoizedProps.style,de=Re!=null&&Re.hasOwnProperty("display")?Re.display:null,Ae.style.display=Kt("display",de))}catch(lr){is(u,u.return,lr)}}}else if(Rt.tag===6){if(Nt===null)try{Rt.stateNode.nodeValue=ot?"":Rt.memoizedProps}catch(lr){is(u,u.return,lr)}}else if((Rt.tag!==22&&Rt.tag!==23||Rt.memoizedState===null||Rt===u)&&Rt.child!==null){Rt.child.return=Rt,Rt=Rt.child;continue}if(Rt===u)break e;for(;Rt.sibling===null;){if(Rt.return===null||Rt.return===u)break e;Nt===Rt&&(Nt=null),Rt=Rt.return}Nt===Rt&&(Nt=null),Rt.sibling.return=Rt.return,Rt=Rt.sibling}}break;case 19:Bo(h,u),Sl(u),P&4&&ZS(u);break;case 21:break;default:Bo(h,u),Sl(u)}}function Sl(u){var h=u.flags;if(h&2){try{e:{for(var S=u.return;S!==null;){if(YS(S)){var P=S;break e}S=S.return}throw Error(r(160))}switch(P.tag){case 5:var W=P.stateNode;P.flags&32&&(ut(W,""),P.flags&=-33);var Q=JS(u);bv(u,Q,W);break;case 3:case 4:var de=P.stateNode.containerInfo,Ae=JS(u);_v(u,Ae,de);break;default:throw Error(r(161))}}catch(Re){is(u,u.return,Re)}u.flags&=-3}h&4096&&(u.flags&=-4097)}function mP(u,h,S){ir=u,tk(u)}function tk(u,h,S){for(var P=(u.mode&1)!==0;ir!==null;){var W=ir,Q=W.child;if(W.tag===22&&P){var de=W.memoizedState!==null||Ox;if(!de){var Ae=W.alternate,Re=Ae!==null&&Ae.memoizedState!==null||Ma;Ae=Ox;var ot=Ma;if(Ox=de,(Ma=Re)&&!ot)for(ir=W;ir!==null;)de=ir,Re=de.child,de.tag===22&&de.memoizedState!==null?sk(W):Re!==null?(Re.return=de,ir=Re):sk(W);for(;Q!==null;)ir=Q,tk(Q),Q=Q.sibling;ir=W,Ox=Ae,Ma=ot}rk(u)}else(W.subtreeFlags&8772)!==0&&Q!==null?(Q.return=W,ir=Q):rk(u)}}function rk(u){for(;ir!==null;){var h=ir;if((h.flags&8772)!==0){var S=h.alternate;try{if((h.flags&8772)!==0)switch(h.tag){case 0:case 11:case 15:Ma||Lx(5,h);break;case 1:var P=h.stateNode;if(h.flags&4&&!Ma)if(S===null)P.componentDidMount();else{var W=h.elementType===h.type?S.memoizedProps:zs(h.type,S.memoizedProps);P.componentDidUpdate(W,S.memoizedState,P.__reactInternalSnapshotBeforeUpdate)}var Q=h.updateQueue;Q!==null&&Gn(h,Q,P);break;case 3:var de=h.updateQueue;if(de!==null){if(S=null,h.child!==null)switch(h.child.tag){case 5:S=h.child.stateNode;break;case 1:S=h.child.stateNode}Gn(h,de,S)}break;case 5:var Ae=h.stateNode;if(S===null&&h.flags&4){S=Ae;var Re=h.memoizedProps;switch(h.type){case"button":case"input":case"select":case"textarea":Re.autoFocus&&S.focus();break;case"img":Re.src&&(S.src=Re.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(h.memoizedState===null){var ot=h.alternate;if(ot!==null){var Nt=ot.memoizedState;if(Nt!==null){var Rt=Nt.dehydrated;Rt!==null&&Fa(Rt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Ma||h.flags&512&&wv(h)}catch(Et){is(h,h.return,Et)}}if(h===u){ir=null;break}if(S=h.sibling,S!==null){S.return=h.return,ir=S;break}ir=h.return}}function nk(u){for(;ir!==null;){var h=ir;if(h===u){ir=null;break}var S=h.sibling;if(S!==null){S.return=h.return,ir=S;break}ir=h.return}}function sk(u){for(;ir!==null;){var h=ir;try{switch(h.tag){case 0:case 11:case 15:var S=h.return;try{Lx(4,h)}catch(Re){is(h,S,Re)}break;case 1:var P=h.stateNode;if(typeof P.componentDidMount=="function"){var W=h.return;try{P.componentDidMount()}catch(Re){is(h,W,Re)}}var Q=h.return;try{wv(h)}catch(Re){is(h,Q,Re)}break;case 5:var de=h.return;try{wv(h)}catch(Re){is(h,de,Re)}}}catch(Re){is(h,h.return,Re)}if(h===u){ir=null;break}var Ae=h.sibling;if(Ae!==null){Ae.return=h.return,ir=Ae;break}ir=h.return}}var pP=Math.ceil,Bx=T.ReactCurrentDispatcher,Sv=T.ReactCurrentOwner,oo=T.ReactCurrentBatchConfig,Jr=0,ra=null,Ps=null,wa=0,$i=0,bh=Po(0),Hs=0,bg=null,Td=0,Ux=0,kv=0,Sg=null,_i=null,Cv=0,Sh=1/0,hc=null,$x=!1,Tv=null,pu=null,Wx=!1,xu=null,zx=0,kg=0,Ev=null,Hx=-1,Gx=0;function oi(){return(Jr&6)!==0?Le():Hx!==-1?Hx:Hx=Le()}function yu(u){return(u.mode&1)===0?1:(Jr&2)!==0&&wa!==0?wa&-wa:ug.transition!==null?(Gx===0&&(Gx=jt()),Gx):(u=sr,u!==0||(u=window.event,u=u===void 0?16:ax(u.type)),u)}function Uo(u,h,S,P){if(50<kg)throw kg=0,Ev=null,Error(r(185));un(u,S,P),((Jr&2)===0||u!==ra)&&(u===ra&&((Jr&2)===0&&(Ux|=S),Hs===4&&vu(u,wa)),bi(u,P),S===1&&Jr===0&&(h.mode&1)===0&&(Sh=Le()+500,Qc&&gl()))}function bi(u,h){var S=u.callbackNode;mr(u,h);var P=ht(u,u===ra?wa:0);if(P===0)S!==null&&je(S),u.callbackNode=null,u.callbackPriority=0;else if(h=P&-P,u.callbackPriority!==h){if(S!=null&&je(S),h===1)u.tag===0?Ro(ik.bind(null,u)):xd(ik.bind(null,u)),wx(function(){(Jr&6)===0&&gl()}),S=null;else{switch(dn(P)){case 1:S=Mt;break;case 4:S=Vt;break;case 16:S=dr;break;case 536870912:S=ln;break;default:S=dr}S=gk(S,ak.bind(null,u))}u.callbackPriority=h,u.callbackNode=S}}function ak(u,h){if(Hx=-1,Gx=0,(Jr&6)!==0)throw Error(r(327));var S=u.callbackNode;if(kh()&&u.callbackNode!==S)return null;var P=ht(u,u===ra?wa:0);if(P===0)return null;if((P&30)!==0||(P&u.expiredLanes)!==0||h)h=Vx(u,P);else{h=P;var W=Jr;Jr|=2;var Q=lk();(ra!==u||wa!==h)&&(hc=null,Sh=Le()+500,Nd(u,h));do try{vP();break}catch(Ae){ok(u,Ae)}while(!0);oh(),Bx.current=Q,Jr=W,Ps!==null?h=0:(ra=null,wa=0,h=Hs)}if(h!==0){if(h===2&&(W=nt(u),W!==0&&(P=W,h=Nv(u,W))),h===1)throw S=bg,Nd(u,0),vu(u,P),bi(u,Le()),S;if(h===6)vu(u,P);else{if(W=u.current.alternate,(P&30)===0&&!xP(W)&&(h=Vx(u,P),h===2&&(Q=nt(u),Q!==0&&(P=Q,h=Nv(u,Q))),h===1))throw S=bg,Nd(u,0),vu(u,P),bi(u,Le()),S;switch(u.finishedWork=W,u.finishedLanes=P,h){case 0:case 1:throw Error(r(345));case 2:Ad(u,_i,hc);break;case 3:if(vu(u,P),(P&130023424)===P&&(h=Cv+500-Le(),10<h)){if(ht(u,0)!==0)break;if(W=u.suspendedLanes,(W&P)!==P){oi(),u.pingedLanes|=u.suspendedLanes&W;break}u.timeoutHandle=ei(Ad.bind(null,u,_i,hc),h);break}Ad(u,_i,hc);break;case 4:if(vu(u,P),(P&4194240)===P)break;for(h=u.eventTimes,W=-1;0<P;){var de=31-cr(P);Q=1<<de,de=h[de],de>W&&(W=de),P&=~Q}if(P=W,P=Le()-P,P=(120>P?120:480>P?480:1080>P?1080:1920>P?1920:3e3>P?3e3:4320>P?4320:1960*pP(P/1960))-P,10<P){u.timeoutHandle=ei(Ad.bind(null,u,_i,hc),P);break}Ad(u,_i,hc);break;case 5:Ad(u,_i,hc);break;default:throw Error(r(329))}}}return bi(u,Le()),u.callbackNode===S?ak.bind(null,u):null}function Nv(u,h){var S=Sg;return u.current.memoizedState.isDehydrated&&(Nd(u,h).flags|=256),u=Vx(u,h),u!==2&&(h=_i,_i=S,h!==null&&Av(h)),u}function Av(u){_i===null?_i=u:_i.push.apply(_i,u)}function xP(u){for(var h=u;;){if(h.flags&16384){var S=h.updateQueue;if(S!==null&&(S=S.stores,S!==null))for(var P=0;P<S.length;P++){var W=S[P],Q=W.getSnapshot;W=W.value;try{if(!Ra(Q(),W))return!1}catch{return!1}}}if(S=h.child,h.subtreeFlags&16384&&S!==null)S.return=h,h=S;else{if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function vu(u,h){for(h&=~kv,h&=~Ux,u.suspendedLanes|=h,u.pingedLanes&=~h,u=u.expirationTimes;0<h;){var S=31-cr(h),P=1<<S;u[S]=-1,h&=~P}}function ik(u){if((Jr&6)!==0)throw Error(r(327));kh();var h=ht(u,0);if((h&1)===0)return bi(u,Le()),null;var S=Vx(u,h);if(u.tag!==0&&S===2){var P=nt(u);P!==0&&(h=P,S=Nv(u,P))}if(S===1)throw S=bg,Nd(u,0),vu(u,h),bi(u,Le()),S;if(S===6)throw Error(r(345));return u.finishedWork=u.current.alternate,u.finishedLanes=h,Ad(u,_i,hc),bi(u,Le()),null}function jv(u,h){var S=Jr;Jr|=1;try{return u(h)}finally{Jr=S,Jr===0&&(Sh=Le()+500,Qc&&gl())}}function Ed(u){xu!==null&&xu.tag===0&&(Jr&6)===0&&kh();var h=Jr;Jr|=1;var S=oo.transition,P=sr;try{if(oo.transition=null,sr=1,u)return u()}finally{sr=P,oo.transition=S,Jr=h,(Jr&6)===0&&gl()}}function Fv(){$i=bh.current,wn(bh)}function Nd(u,h){u.finishedWork=null,u.finishedLanes=0;var S=u.timeoutHandle;if(S!==-1&&(u.timeoutHandle=-1,ig(S)),Ps!==null)for(S=Ps.return;S!==null;){var P=S;switch(Fs(P),P.tag){case 1:P=P.type.childContextTypes,P!=null&&Jc();break;case 3:Pn(),wn(Ys),wn(Ws),Qs();break;case 5:Io(P);break;case 4:Pn();break;case 13:wn(_n);break;case 19:wn(_n);break;case 10:lh(P.type._context);break;case 22:case 23:Fv()}S=S.return}if(ra=u,Ps=u=wu(u.current,null),wa=$i=h,Hs=0,bg=null,kv=Ux=Td=0,_i=Sg=null,ro!==null){for(h=0;h<ro.length;h++)if(S=ro[h],P=S.interleaved,P!==null){S.interleaved=null;var W=P.next,Q=S.pending;if(Q!==null){var de=Q.next;Q.next=W,P.next=de}S.pending=P}ro=null}return u}function ok(u,h){do{var S=Ps;try{if(oh(),iu.current=du,Ui){for(var P=cn.memoizedState;P!==null;){var W=P.queue;W!==null&&(W.pending=null),P=P.next}Ui=!1}if(xa=0,ss=Vn=cn=null,vl=!1,wi=0,Sv.current=null,S===null||S.return===null){Hs=1,bg=h,Ps=null;break}e:{var Q=u,de=S.return,Ae=S,Re=h;if(h=wa,Ae.flags|=32768,Re!==null&&typeof Re=="object"&&typeof Re.then=="function"){var ot=Re,Nt=Ae,Rt=Nt.tag;if((Nt.mode&1)===0&&(Rt===0||Rt===11||Rt===15)){var Et=Nt.alternate;Et?(Nt.updateQueue=Et.updateQueue,Nt.memoizedState=Et.memoizedState,Nt.lanes=Et.lanes):(Nt.updateQueue=null,Nt.memoizedState=null)}var tr=j(de);if(tr!==null){tr.flags&=-257,O(tr,de,Ae,Q,h),tr.mode&1&&x(Q,ot,h),h=tr,Re=ot;var or=h.updateQueue;if(or===null){var lr=new Set;lr.add(Re),h.updateQueue=lr}else or.add(Re);break e}else{if((h&1)===0){x(Q,ot,h),Pv();break e}Re=Error(r(426))}}else if(sn&&Ae.mode&1){var bs=j(de);if(bs!==null){(bs.flags&65536)===0&&(bs.flags|=256),O(bs,de,Ae,Q,h),vd(fc(Re,Ae));break e}}Q=Re=fc(Re,Ae),Hs!==4&&(Hs=2),Sg===null?Sg=[Q]:Sg.push(Q),Q=de;do{switch(Q.tag){case 3:Q.flags|=65536,h&=-h,Q.lanes|=h;var Ke=Mx(Q,Re,h);Sd(Q,Ke);break e;case 1:Ae=Re;var Me=Q.type,tt=Q.stateNode;if((Q.flags&128)===0&&(typeof Me.getDerivedStateFromError=="function"||tt!==null&&typeof tt.componentDidCatch=="function"&&(pu===null||!pu.has(tt)))){Q.flags|=65536,h&=-h,Q.lanes|=h;var Ot=m(Q,Ae,h);Sd(Q,Ot);break e}}Q=Q.return}while(Q!==null)}uk(S)}catch(ur){h=ur,Ps===S&&S!==null&&(Ps=S=S.return);continue}break}while(!0)}function lk(){var u=Bx.current;return Bx.current=du,u===null?du:u}function Pv(){(Hs===0||Hs===3||Hs===2)&&(Hs=4),ra===null||(Td&268435455)===0&&(Ux&268435455)===0||vu(ra,wa)}function Vx(u,h){var S=Jr;Jr|=2;var P=lk();(ra!==u||wa!==h)&&(hc=null,Nd(u,h));do try{yP();break}catch(W){ok(u,W)}while(!0);if(oh(),Jr=S,Bx.current=P,Ps!==null)throw Error(r(261));return ra=null,wa=0,Hs}function yP(){for(;Ps!==null;)ck(Ps)}function vP(){for(;Ps!==null&&!qe();)ck(Ps)}function ck(u){var h=hk(u.alternate,u,$i);u.memoizedProps=u.pendingProps,h===null?uk(u):Ps=h,Sv.current=null}function uk(u){var h=u;do{var S=h.alternate;if(u=h.return,(h.flags&32768)===0){if(S=dP(S,h,$i),S!==null){Ps=S;return}}else{if(S=fP(S,h),S!==null){S.flags&=32767,Ps=S;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{Hs=6,Ps=null;return}}if(h=h.sibling,h!==null){Ps=h;return}Ps=h=u}while(h!==null);Hs===0&&(Hs=5)}function Ad(u,h,S){var P=sr,W=oo.transition;try{oo.transition=null,sr=1,wP(u,h,S,P)}finally{oo.transition=W,sr=P}return null}function wP(u,h,S,P){do kh();while(xu!==null);if((Jr&6)!==0)throw Error(r(327));S=u.finishedWork;var W=u.finishedLanes;if(S===null)return null;if(u.finishedWork=null,u.finishedLanes=0,S===u.current)throw Error(r(177));u.callbackNode=null,u.callbackPriority=0;var Q=S.lanes|S.childLanes;if(Xn(u,Q),u===ra&&(Ps=ra=null,wa=0),(S.subtreeFlags&2064)===0&&(S.flags&2064)===0||Wx||(Wx=!0,gk(dr,function(){return kh(),null})),Q=(S.flags&15990)!==0,(S.subtreeFlags&15990)!==0||Q){Q=oo.transition,oo.transition=null;var de=sr;sr=1;var Ae=Jr;Jr|=4,Sv.current=null,gP(u,S),ek(S,u),cd(sg),Df=!!ng,sg=ng=null,u.current=S,mP(S),at(),Jr=Ae,sr=de,oo.transition=Q}else u.current=S;if(Wx&&(Wx=!1,xu=u,zx=W),Q=u.pendingLanes,Q===0&&(pu=null),Or(S.stateNode),bi(u,Le()),h!==null)for(P=u.onRecoverableError,S=0;S<h.length;S++)W=h[S],P(W.value,{componentStack:W.stack,digest:W.digest});if($x)throw $x=!1,u=Tv,Tv=null,u;return(zx&1)!==0&&u.tag!==0&&kh(),Q=u.pendingLanes,(Q&1)!==0?u===Ev?kg++:(kg=0,Ev=u):kg=0,gl(),null}function kh(){if(xu!==null){var u=dn(zx),h=oo.transition,S=sr;try{if(oo.transition=null,sr=16>u?16:u,xu===null)var P=!1;else{if(u=xu,xu=null,zx=0,(Jr&6)!==0)throw Error(r(331));var W=Jr;for(Jr|=4,ir=u.current;ir!==null;){var Q=ir,de=Q.child;if((ir.flags&16)!==0){var Ae=Q.deletions;if(Ae!==null){for(var Re=0;Re<Ae.length;Re++){var ot=Ae[Re];for(ir=ot;ir!==null;){var Nt=ir;switch(Nt.tag){case 0:case 11:case 15:_g(8,Nt,Q)}var Rt=Nt.child;if(Rt!==null)Rt.return=Nt,ir=Rt;else for(;ir!==null;){Nt=ir;var Et=Nt.sibling,tr=Nt.return;if(XS(Nt),Nt===ot){ir=null;break}if(Et!==null){Et.return=tr,ir=Et;break}ir=tr}}}var or=Q.alternate;if(or!==null){var lr=or.child;if(lr!==null){or.child=null;do{var bs=lr.sibling;lr.sibling=null,lr=bs}while(lr!==null)}}ir=Q}}if((Q.subtreeFlags&2064)!==0&&de!==null)de.return=Q,ir=de;else e:for(;ir!==null;){if(Q=ir,(Q.flags&2048)!==0)switch(Q.tag){case 0:case 11:case 15:_g(9,Q,Q.return)}var Ke=Q.sibling;if(Ke!==null){Ke.return=Q.return,ir=Ke;break e}ir=Q.return}}var Me=u.current;for(ir=Me;ir!==null;){de=ir;var tt=de.child;if((de.subtreeFlags&2064)!==0&&tt!==null)tt.return=de,ir=tt;else e:for(de=Me;ir!==null;){if(Ae=ir,(Ae.flags&2048)!==0)try{switch(Ae.tag){case 0:case 11:case 15:Lx(9,Ae)}}catch(ur){is(Ae,Ae.return,ur)}if(Ae===de){ir=null;break e}var Ot=Ae.sibling;if(Ot!==null){Ot.return=Ae.return,ir=Ot;break e}ir=Ae.return}}if(Jr=W,gl(),Pr&&typeof Pr.onPostCommitFiberRoot=="function")try{Pr.onPostCommitFiberRoot(In,u)}catch{}P=!0}return P}finally{sr=S,oo.transition=h}}return!1}function dk(u,h,S){h=fc(S,h),h=Mx(u,h,1),u=ao(u,h,1),h=oi(),u!==null&&(un(u,1,h),bi(u,h))}function is(u,h,S){if(u.tag===3)dk(u,u,S);else for(;h!==null;){if(h.tag===3){dk(h,u,S);break}else if(h.tag===1){var P=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof P.componentDidCatch=="function"&&(pu===null||!pu.has(P))){u=fc(S,u),u=m(h,u,1),h=ao(h,u,1),u=oi(),h!==null&&(un(h,1,u),bi(h,u));break}}h=h.return}}function _P(u,h,S){var P=u.pingCache;P!==null&&P.delete(h),h=oi(),u.pingedLanes|=u.suspendedLanes&S,ra===u&&(wa&S)===S&&(Hs===4||Hs===3&&(wa&130023424)===wa&&500>Le()-Cv?Nd(u,0):kv|=S),bi(u,h)}function fk(u,h){h===0&&((u.mode&1)===0?h=1:(h=Xe,Xe<<=1,(Xe&130023424)===0&&(Xe=4194304)));var S=oi();u=ai(u,h),u!==null&&(un(u,h,S),bi(u,S))}function bP(u){var h=u.memoizedState,S=0;h!==null&&(S=h.retryLane),fk(u,S)}function SP(u,h){var S=0;switch(u.tag){case 13:var P=u.stateNode,W=u.memoizedState;W!==null&&(S=W.retryLane);break;case 19:P=u.stateNode;break;default:throw Error(r(314))}P!==null&&P.delete(h),fk(u,S)}var hk;hk=function(u,h,S){if(u!==null)if(u.memoizedProps!==h.pendingProps||Ys.current)te=!0;else{if((u.lanes&S)===0&&(h.flags&128)===0)return te=!1,xv(u,h,S);te=(u.flags&131072)!==0}else te=!1,sn&&(h.flags&1048576)!==0&&Cx(h,pl,h.index);switch(h.lanes=0,h.tag){case 2:var P=h.type;Vr(u,h),u=h.pendingProps;var W=nc(h,Ws.current);Do(h,S),W=ou(null,h,P,u,W,S);var Q=lu();return h.flags|=1,typeof W=="object"&&W!==null&&typeof W.render=="function"&&W.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,Js(P)?(Q=!0,sc(h)):Q=!1,h.memoizedState=W.state!==null&&W.state!==void 0?W.state:null,bd(h),W.updater=hu,h.stateNode=W,W._reactInternals=h,vh(h,P,u,S),h=an(null,h,P,!0,Q,S)):(h.tag=0,sn&&Q&&Zc(h),ye(null,h,W,S),h=h.child),h;case 16:P=h.elementType;e:{switch(Vr(u,h),u=h.pendingProps,W=P._init,P=W(P._payload),h.type=P,W=h.tag=CP(P),u=zs(P,u),W){case 0:h=Qt(null,h,P,u,S);break e;case 1:h=bn(null,h,P,u,S);break e;case 11:h=Be(null,h,P,u,S);break e;case 14:h=lt(null,h,P,zs(P.type,u),S);break e}throw Error(r(306,P,""))}return h;case 0:return P=h.type,W=h.pendingProps,W=h.elementType===P?W:zs(P,W),Qt(u,h,P,W,S);case 1:return P=h.type,W=h.pendingProps,W=h.elementType===P?W:zs(P,W),bn(u,h,P,W,S);case 3:e:{if(ya(h),u===null)throw Error(r(387));P=h.pendingProps,Q=h.memoizedState,W=Q.element,uh(u,h),nu(h,P,null,S);var de=h.memoizedState;if(P=de.element,Q.isDehydrated)if(Q={element:P,isDehydrated:!1,cache:de.cache,pendingSuspenseBoundaries:de.pendingSuspenseBoundaries,transitions:de.transitions},h.updateQueue.baseState=Q,h.memoizedState=Q,h.flags&256){W=fc(Error(r(423)),h),h=io(u,h,P,S,W);break e}else if(P!==W){W=fc(Error(r(424)),h),h=io(u,h,P,S,W);break e}else for(qt=Qi(h.stateNode.containerInfo.firstChild),ri=h,sn=!0,ni=null,S=vi(h,null,P,S),h.child=S;S;)S.flags=S.flags&-3|4096,S=S.sibling;else{if(lc(),P===W){h=ta(u,h,S);break e}ye(u,h,P,S)}h=h.child}return h;case 5:return su(h),u===null&&eu(h),P=h.type,W=h.pendingProps,Q=u!==null?u.memoizedProps:null,de=W.children,ag(P,W)?de=null:Q!==null&&ag(P,Q)&&(h.flags|=32),Er(u,h),ye(u,h,de,S),h.child;case 6:return u===null&&eu(h),null;case 13:return ft(u,h,S);case 4:return yl(h,h.stateNode.containerInfo),P=h.pendingProps,u===null?h.child=cc(h,null,P,S):ye(u,h,P,S),h.child;case 11:return P=h.type,W=h.pendingProps,W=h.elementType===P?W:zs(P,W),Be(u,h,P,W,S);case 7:return ye(u,h,h.pendingProps,S),h.child;case 8:return ye(u,h,h.pendingProps.children,S),h.child;case 12:return ye(u,h,h.pendingProps.children,S),h.child;case 10:e:{if(P=h.type._context,W=h.pendingProps,Q=h.memoizedProps,de=W.value,fn(wd,P._currentValue),P._currentValue=de,Q!==null)if(Ra(Q.value,de)){if(Q.children===W.children&&!Ys.current){h=ta(u,h,S);break e}}else for(Q=h.child,Q!==null&&(Q.return=h);Q!==null;){var Ae=Q.dependencies;if(Ae!==null){de=Q.child;for(var Re=Ae.firstContext;Re!==null;){if(Re.context===P){if(Q.tag===1){Re=so(-1,S&-S),Re.tag=2;var ot=Q.updateQueue;if(ot!==null){ot=ot.shared;var Nt=ot.pending;Nt===null?Re.next=Re:(Re.next=Nt.next,Nt.next=Re),ot.pending=Re}}Q.lanes|=S,Re=Q.alternate,Re!==null&&(Re.lanes|=S),ch(Q.return,S,h),Ae.lanes|=S;break}Re=Re.next}}else if(Q.tag===10)de=Q.type===h.type?null:Q.child;else if(Q.tag===18){if(de=Q.return,de===null)throw Error(r(341));de.lanes|=S,Ae=de.alternate,Ae!==null&&(Ae.lanes|=S),ch(de,S,h),de=Q.sibling}else de=Q.child;if(de!==null)de.return=Q;else for(de=Q;de!==null;){if(de===h){de=null;break}if(Q=de.sibling,Q!==null){Q.return=de.return,de=Q;break}de=de.return}Q=de}ye(u,h,W.children,S),h=h.child}return h;case 9:return W=h.type,P=h.pendingProps.children,Do(h,S),W=pa(W),P=P(W),h.flags|=1,ye(u,h,P,S),h.child;case 14:return P=h.type,W=zs(P,h.pendingProps),W=zs(P.type,W),lt(u,h,P,W,S);case 15:return Dt(u,h,h.type,h.pendingProps,S);case 17:return P=h.type,W=h.pendingProps,W=h.elementType===P?W:zs(P,W),Vr(u,h),h.tag=1,Js(P)?(u=!0,sc(h)):u=!1,Do(h,S),Ix(h,P,W),vh(h,P,W,S),an(null,h,P,!0,u,S);case 19:return _s(u,h,S);case 22:return ar(u,h,S)}throw Error(r(156,h.tag))};function gk(u,h){return Te(u,h)}function kP(u,h,S,P){this.tag=u,this.key=S,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=P,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lo(u,h,S,P){return new kP(u,h,S,P)}function Rv(u){return u=u.prototype,!(!u||!u.isReactComponent)}function CP(u){if(typeof u=="function")return Rv(u)?1:0;if(u!=null){if(u=u.$$typeof,u===Y)return 11;if(u===re)return 14}return 2}function wu(u,h){var S=u.alternate;return S===null?(S=lo(u.tag,h,u.key,u.mode),S.elementType=u.elementType,S.type=u.type,S.stateNode=u.stateNode,S.alternate=u,u.alternate=S):(S.pendingProps=h,S.type=u.type,S.flags=0,S.subtreeFlags=0,S.deletions=null),S.flags=u.flags&14680064,S.childLanes=u.childLanes,S.lanes=u.lanes,S.child=u.child,S.memoizedProps=u.memoizedProps,S.memoizedState=u.memoizedState,S.updateQueue=u.updateQueue,h=u.dependencies,S.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},S.sibling=u.sibling,S.index=u.index,S.ref=u.ref,S}function Kx(u,h,S,P,W,Q){var de=2;if(P=u,typeof u=="function")Rv(u)&&(de=1);else if(typeof u=="string")de=5;else e:switch(u){case R:return jd(S.children,W,Q,h);case E:de=8,W|=8;break;case D:return u=lo(12,S,h,W|2),u.elementType=D,u.lanes=Q,u;case ee:return u=lo(13,S,h,W),u.elementType=ee,u.lanes=Q,u;case ie:return u=lo(19,S,h,W),u.elementType=ie,u.lanes=Q,u;case B:return qx(S,W,Q,h);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case I:de=10;break e;case G:de=9;break e;case Y:de=11;break e;case re:de=14;break e;case se:de=16,P=null;break e}throw Error(r(130,u==null?u:typeof u,""))}return h=lo(de,S,h,W),h.elementType=u,h.type=P,h.lanes=Q,h}function jd(u,h,S,P){return u=lo(7,u,P,h),u.lanes=S,u}function qx(u,h,S,P){return u=lo(22,u,P,h),u.elementType=B,u.lanes=S,u.stateNode={isHidden:!1},u}function Dv(u,h,S){return u=lo(6,u,null,h),u.lanes=S,u}function Iv(u,h,S){return h=lo(4,u.children!==null?u.children:[],u.key,h),h.lanes=S,h.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},h}function TP(u,h,S,P,W){this.tag=h,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=er(0),this.expirationTimes=er(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=er(0),this.identifierPrefix=P,this.onRecoverableError=W,this.mutableSourceEagerHydrationData=null}function Mv(u,h,S,P,W,Q,de,Ae,Re){return u=new TP(u,h,S,Ae,Re),h===1?(h=1,Q===!0&&(h|=8)):h=0,Q=lo(3,null,null,h),u.current=Q,Q.stateNode=u,Q.memoizedState={element:P,isDehydrated:S,cache:null,transitions:null,pendingSuspenseBoundaries:null},bd(Q),u}function EP(u,h,S){var P=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:F,key:P==null?null:""+P,children:u,containerInfo:h,implementation:S}}function mk(u){if(!u)return eo;u=u._reactInternals;e:{if(ke(u)!==u||u.tag!==1)throw Error(r(170));var h=u;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(Js(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(r(171))}if(u.tag===1){var S=u.type;if(Js(S))return rh(u,S,h)}return h}function pk(u,h,S,P,W,Q,de,Ae,Re){return u=Mv(S,P,!0,u,W,Q,de,Ae,Re),u.context=mk(null),S=u.current,P=oi(),W=yu(S),Q=so(P,W),Q.callback=h??null,ao(S,Q,W),u.current.lanes=W,un(u,W,P),bi(u,P),u}function Xx(u,h,S,P){var W=h.current,Q=oi(),de=yu(W);return S=mk(S),h.context===null?h.context=S:h.pendingContext=S,h=so(Q,de),h.payload={element:u},P=P===void 0?null:P,P!==null&&(h.callback=P),u=ao(W,h,de),u!==null&&(Uo(u,W,de,Q),dh(u,W,de)),de}function Yx(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function xk(u,h){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var S=u.retryLane;u.retryLane=S!==0&&S<h?S:h}}function Ov(u,h){xk(u,h),(u=u.alternate)&&xk(u,h)}function NP(){return null}var yk=typeof reportError=="function"?reportError:function(u){console.error(u)};function Lv(u){this._internalRoot=u}Jx.prototype.render=Lv.prototype.render=function(u){var h=this._internalRoot;if(h===null)throw Error(r(409));Xx(u,h,null,null)},Jx.prototype.unmount=Lv.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var h=u.containerInfo;Ed(function(){Xx(null,u,null,null)}),h[Zi]=null}};function Jx(u){this._internalRoot=u}Jx.prototype.unstable_scheduleHydration=function(u){if(u){var h=rx();u={blockedOn:null,target:u,priority:h};for(var S=0;S<Ji.length&&h!==0&&h<Ji[S].priority;S++);Ji.splice(S,0,u),S===0&&Ff(u)}};function Bv(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function Qx(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function vk(){}function AP(u,h,S,P,W){if(W){if(typeof P=="function"){var Q=P;P=function(){var ot=Yx(de);Q.call(ot)}}var de=pk(h,P,u,0,null,!1,!1,"",vk);return u._reactRootContainer=de,u[Zi]=de.current,Ql(u.nodeType===8?u.parentNode:u),Ed(),de}for(;W=u.lastChild;)u.removeChild(W);if(typeof P=="function"){var Ae=P;P=function(){var ot=Yx(Re);Ae.call(ot)}}var Re=Mv(u,0,!1,null,null,!1,!1,"",vk);return u._reactRootContainer=Re,u[Zi]=Re.current,Ql(u.nodeType===8?u.parentNode:u),Ed(function(){Xx(h,Re,S,P)}),Re}function Zx(u,h,S,P,W){var Q=S._reactRootContainer;if(Q){var de=Q;if(typeof W=="function"){var Ae=W;W=function(){var Re=Yx(de);Ae.call(Re)}}Xx(h,de,u,W)}else de=AP(S,h,u,W,P);return Yx(de)}Yn=function(u){switch(u.tag){case 3:var h=u.stateNode;if(h.current.memoizedState.isDehydrated){var S=It(h.pendingLanes);S!==0&&(Mn(h,S|1),bi(h,Le()),(Jr&6)===0&&(Sh=Le()+500,gl()))}break;case 13:Ed(function(){var P=ai(u,1);if(P!==null){var W=oi();Uo(P,u,1,W)}}),Ov(u,1)}},Lr=function(u){if(u.tag===13){var h=ai(u,134217728);if(h!==null){var S=oi();Uo(h,u,134217728,S)}Ov(u,134217728)}},Nf=function(u){if(u.tag===13){var h=yu(u),S=ai(u,h);if(S!==null){var P=oi();Uo(S,u,h,P)}Ov(u,h)}},rx=function(){return sr},Af=function(u,h){var S=sr;try{return sr=u,h()}finally{sr=S}},Ee=function(u,h,S){switch(h){case"input":if(He(u,S),h=S.name,S.type==="radio"&&h!=null){for(S=u;S.parentNode;)S=S.parentNode;for(S=S.querySelectorAll("input[name="+JSON.stringify(""+h)+'][type="radio"]'),h=0;h<S.length;h++){var P=S[h];if(P!==u&&P.form===u.form){var W=js(P);if(!W)throw Error(r(90));le(P),He(P,W)}}}break;case"textarea":gt(u,S);break;case"select":h=S.value,h!=null&&Pe(u,!!S.multiple,h,!1)}},pt=jv,Xt=Ed;var jP={usingClientEntryPoint:!1,Events:[pd,ys,js,$e,St,jv]},Cg={findFiberByHostInstance:fl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},FP={bundleType:Cg.bundleType,version:Cg.version,rendererPackageName:Cg.rendererPackageName,rendererConfig:Cg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:T.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=oe(u),u===null?null:u.stateNode},findFiberByHostInstance:Cg.findFiberByHostInstance||NP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ey=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ey.isDisabled&&ey.supportsFiber)try{In=ey.inject(FP),Pr=ey}catch{}}return Si.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jP,Si.createPortal=function(u,h){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Bv(h))throw Error(r(200));return EP(u,h,null,S)},Si.createRoot=function(u,h){if(!Bv(u))throw Error(r(299));var S=!1,P="",W=yk;return h!=null&&(h.unstable_strictMode===!0&&(S=!0),h.identifierPrefix!==void 0&&(P=h.identifierPrefix),h.onRecoverableError!==void 0&&(W=h.onRecoverableError)),h=Mv(u,1,!1,null,null,S,!1,P,W),u[Zi]=h.current,Ql(u.nodeType===8?u.parentNode:u),new Lv(h)},Si.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var h=u._reactInternals;if(h===void 0)throw typeof u.render=="function"?Error(r(188)):(u=Object.keys(u).join(","),Error(r(268,u)));return u=oe(h),u=u===null?null:u.stateNode,u},Si.flushSync=function(u){return Ed(u)},Si.hydrate=function(u,h,S){if(!Qx(h))throw Error(r(200));return Zx(null,u,h,!0,S)},Si.hydrateRoot=function(u,h,S){if(!Bv(u))throw Error(r(405));var P=S!=null&&S.hydratedSources||null,W=!1,Q="",de=yk;if(S!=null&&(S.unstable_strictMode===!0&&(W=!0),S.identifierPrefix!==void 0&&(Q=S.identifierPrefix),S.onRecoverableError!==void 0&&(de=S.onRecoverableError)),h=pk(h,null,u,1,S??null,W,!1,Q,de),u[Zi]=h.current,Ql(u),P)for(u=0;u<P.length;u++)S=P[u],W=S._getVersion,W=W(S._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[S,W]:h.mutableSourceEagerHydrationData.push(S,W);return new Jx(h)},Si.render=function(u,h,S){if(!Qx(h))throw Error(r(200));return Zx(null,u,h,!1,S)},Si.unmountComponentAtNode=function(u){if(!Qx(u))throw Error(r(40));return u._reactRootContainer?(Ed(function(){Zx(null,null,u,!1,function(){u._reactRootContainer=null,u[Zi]=null})}),!0):!1},Si.unstable_batchedUpdates=jv,Si.unstable_renderSubtreeIntoContainer=function(u,h,S,P){if(!Qx(S))throw Error(r(200));if(u==null||u._reactInternals===void 0)throw Error(r(38));return Zx(u,h,S,!1,P)},Si.version="18.3.1-next-f1338f8080-20240426",Si}var Ek;function T3(){if(Ek)return Wv.exports;Ek=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Wv.exports=BP(),Wv.exports}var Nk;function UP(){if(Nk)return ty;Nk=1;var e=T3();return ty.createRoot=e.createRoot,ty.hydrateRoot=e.hydrateRoot,ty}var $P=UP();const WP=Cp($P);var Ak=T3();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Km(){return Km=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Km.apply(this,arguments)}var Eu;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Eu||(Eu={}));const jk="popstate";function zP(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:l}=n.location;return t_("",{pathname:a,search:i,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:N3(s)}return GP(t,r,null,e)}function Ls(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function E3(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function HP(){return Math.random().toString(36).substr(2,8)}function Fk(e,t){return{usr:e.state,key:e.key,idx:t}}function t_(e,t,r,n){return r===void 0&&(r=null),Km({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?x0(t):t,{state:r,key:t&&t.key||n||HP()})}function N3(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function x0(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function GP(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,l=Eu.Pop,c=null,d=f();d==null&&(d=0,i.replaceState(Km({},i.state,{idx:d}),""));function f(){return(i.state||{idx:null}).idx}function p(){l=Eu.Pop;let b=f(),N=b==null?null:b-d;d=b,c&&c({action:l,location:_.location,delta:N})}function g(b,N){l=Eu.Push;let k=t_(_.location,b,N);d=f()+1;let w=Fk(k,d),T=_.createHref(k);try{i.pushState(w,"",T)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;s.location.assign(T)}a&&c&&c({action:l,location:_.location,delta:1})}function y(b,N){l=Eu.Replace;let k=t_(_.location,b,N);d=f();let w=Fk(k,d),T=_.createHref(k);i.replaceState(w,"",T),a&&c&&c({action:l,location:_.location,delta:0})}function v(b){let N=s.location.origin!=="null"?s.location.origin:s.location.href,k=typeof b=="string"?b:N3(b);return k=k.replace(/ $/,"%20"),Ls(N,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,N)}let _={get action(){return l},get location(){return e(s,i)},listen(b){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(jk,p),c=b,()=>{s.removeEventListener(jk,p),c=null}},createHref(b){return t(s,b)},createURL:v,encodeLocation(b){let N=v(b);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:g,replace:y,go(b){return i.go(b)}};return _}var Pk;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Pk||(Pk={}));function VP(e,t,r){return r===void 0&&(r="/"),KP(e,t,r)}function KP(e,t,r,n){let s=typeof t=="string"?x0(t):t,a=F3(s.pathname||"/",r);if(a==null)return null;let i=A3(e);qP(i);let l=null;for(let c=0;l==null&&c<i.length;++c){let d=iR(a);l=nR(i[c],d)}return l}function A3(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(Ls(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=Wd([n,c.relativePath]),f=r.concat(c);a.children&&a.children.length>0&&(Ls(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),A3(a.children,t,f,d)),!(a.path==null&&!a.index)&&t.push({path:d,score:tR(d,a.index),routesMeta:f})};return e.forEach((a,i)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))s(a,i);else for(let c of j3(a.path))s(a,i,c)}),t}function j3(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=j3(n.join("/")),l=[];return l.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...i),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function qP(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:rR(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const XP=/^:[\w-]+$/,YP=3,JP=2,QP=1,ZP=10,eR=-2,Rk=e=>e==="*";function tR(e,t){let r=e.split("/"),n=r.length;return r.some(Rk)&&(n+=eR),t&&(n+=JP),r.filter(s=>!Rk(s)).reduce((s,a)=>s+(XP.test(a)?YP:a===""?QP:ZP),n)}function rR(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function nR(e,t,r){let{routesMeta:n}=e,s={},a="/",i=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,f=a==="/"?t:t.slice(a.length)||"/",p=sR({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},f),g=c.route;if(!p)return null;Object.assign(s,p.params),i.push({params:s,pathname:Wd([a,p.pathname]),pathnameBase:uR(Wd([a,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(a=Wd([a,p.pathnameBase]))}return i}function sR(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=aR(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((d,f,p)=>{let{paramName:g,isOptional:y}=f;if(g==="*"){let _=l[p]||"";i=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const v=l[p];return y&&!v?d[g]=void 0:d[g]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:i,pattern:e}}function aR(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),E3(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function iR(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return E3(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function F3(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function oR(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?x0(e):e;return{pathname:r?r.startsWith("/")?r:lR(r,t):t,search:dR(n),hash:fR(s)}}function lR(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Gv(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function cR(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function P3(e,t){let r=cR(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function R3(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=x0(e):(s=Km({},e),Ls(!s.pathname||!s.pathname.includes("?"),Gv("?","pathname","search",s)),Ls(!s.pathname||!s.pathname.includes("#"),Gv("#","pathname","hash",s)),Ls(!s.search||!s.search.includes("#"),Gv("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,l;if(i==null)l=r;else{let p=t.length-1;if(!n&&i.startsWith("..")){let g=i.split("/");for(;g[0]==="..";)g.shift(),p-=1;s.pathname=g.join("/")}l=p>=0?t[p]:"/"}let c=oR(s,l),d=i&&i!=="/"&&i.endsWith("/"),f=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||f)&&(c.pathname+="/"),c}const Wd=e=>e.join("/").replace(/\/\/+/g,"/"),uR=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),dR=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,fR=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function hR(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const D3=["post","put","patch","delete"];new Set(D3);const gR=["get",...D3];new Set(gR);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qm(){return qm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qm.apply(this,arguments)}const _2=C.createContext(null),mR=C.createContext(null),Tp=C.createContext(null),N1=C.createContext(null),Vu=C.createContext({outlet:null,matches:[],isDataRoute:!1}),I3=C.createContext(null);function Ep(){return C.useContext(N1)!=null}function A1(){return Ep()||Ls(!1),C.useContext(N1).location}function M3(e){C.useContext(Tp).static||C.useLayoutEffect(e)}function Ri(){let{isDataRoute:e}=C.useContext(Vu);return e?NR():pR()}function pR(){Ep()||Ls(!1);let e=C.useContext(_2),{basename:t,future:r,navigator:n}=C.useContext(Tp),{matches:s}=C.useContext(Vu),{pathname:a}=A1(),i=JSON.stringify(P3(s,r.v7_relativeSplatPath)),l=C.useRef(!1);return M3(()=>{l.current=!0}),C.useCallback(function(d,f){if(f===void 0&&(f={}),!l.current)return;if(typeof d=="number"){n.go(d);return}let p=R3(d,JSON.parse(i),a,f.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:Wd([t,p.pathname])),(f.replace?n.replace:n.push)(p,f.state,f)},[t,n,i,a,e])}function j1(){let{matches:e}=C.useContext(Vu),t=e[e.length-1];return t?t.params:{}}function xR(e,t){return yR(e,t)}function yR(e,t,r,n){Ep()||Ls(!1);let{navigator:s}=C.useContext(Tp),{matches:a}=C.useContext(Vu),i=a[a.length-1],l=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let d=A1(),f;if(t){var p;let b=typeof t=="string"?x0(t):t;c==="/"||(p=b.pathname)!=null&&p.startsWith(c)||Ls(!1),f=b}else f=d;let g=f.pathname||"/",y=g;if(c!=="/"){let b=c.replace(/^\//,"").split("/");y="/"+g.replace(/^\//,"").split("/").slice(b.length).join("/")}let v=VP(e,{pathname:y}),_=SR(v&&v.map(b=>Object.assign({},b,{params:Object.assign({},l,b.params),pathname:Wd([c,s.encodeLocation?s.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?c:Wd([c,s.encodeLocation?s.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),a,r,n);return t&&_?C.createElement(N1.Provider,{value:{location:qm({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Eu.Pop}},_):_}function vR(){let e=ER(),t=hR(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},t),r?C.createElement("pre",{style:s},r):null,null)}const wR=C.createElement(vR,null);class _R extends C.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?C.createElement(Vu.Provider,{value:this.props.routeContext},C.createElement(I3.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function bR(e){let{routeContext:t,match:r,children:n}=e,s=C.useContext(_2);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),C.createElement(Vu.Provider,{value:t},n)}function SR(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,l=(s=r)==null?void 0:s.errors;if(l!=null){let f=i.findIndex(p=>p.route.id&&l?.[p.route.id]!==void 0);f>=0||Ls(!1),i=i.slice(0,Math.min(i.length,f+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<i.length;f++){let p=i[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=f),p.route.id){let{loaderData:g,errors:y}=r,v=p.route.loader&&g[p.route.id]===void 0&&(!y||y[p.route.id]===void 0);if(p.route.lazy||v){c=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}return i.reduceRight((f,p,g)=>{let y,v=!1,_=null,b=null;r&&(y=l&&p.route.id?l[p.route.id]:void 0,_=p.route.errorElement||wR,c&&(d<0&&g===0?(AR("route-fallback"),v=!0,b=null):d===g&&(v=!0,b=p.route.hydrateFallbackElement||null)));let N=t.concat(i.slice(0,g+1)),k=()=>{let w;return y?w=_:v?w=b:p.route.Component?w=C.createElement(p.route.Component,null):p.route.element?w=p.route.element:w=f,C.createElement(bR,{match:p,routeContext:{outlet:f,matches:N,isDataRoute:r!=null},children:w})};return r&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?C.createElement(_R,{location:r.location,revalidation:r.revalidation,component:_,error:y,children:k(),routeContext:{outlet:null,matches:N,isDataRoute:!0}}):k()},null)}var O3=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(O3||{}),L3=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(L3||{});function kR(e){let t=C.useContext(_2);return t||Ls(!1),t}function CR(e){let t=C.useContext(mR);return t||Ls(!1),t}function TR(e){let t=C.useContext(Vu);return t||Ls(!1),t}function B3(e){let t=TR(),r=t.matches[t.matches.length-1];return r.route.id||Ls(!1),r.route.id}function ER(){var e;let t=C.useContext(I3),r=CR(),n=B3();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function NR(){let{router:e}=kR(O3.UseNavigateStable),t=B3(L3.UseNavigateStable),r=C.useRef(!1);return M3(()=>{r.current=!0}),C.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,qm({fromRouteId:t},a)))},[e,t])}const Dk={};function AR(e,t,r){Dk[e]||(Dk[e]=!0)}function jR(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath}function a0(e){let{to:t,replace:r,state:n,relative:s}=e;Ep()||Ls(!1);let{future:a,static:i}=C.useContext(Tp),{matches:l}=C.useContext(Vu),{pathname:c}=A1(),d=Ri(),f=R3(t,P3(l,a.v7_relativeSplatPath),c,s==="path"),p=JSON.stringify(f);return C.useEffect(()=>d(JSON.parse(p),{replace:r,state:n,relative:s}),[d,p,s,r,n]),null}function ds(e){Ls(!1)}function FR(e){let{basename:t="/",children:r=null,location:n,navigationType:s=Eu.Pop,navigator:a,static:i=!1,future:l}=e;Ep()&&Ls(!1);let c=t.replace(/^\/*/,"/"),d=C.useMemo(()=>({basename:c,navigator:a,static:i,future:qm({v7_relativeSplatPath:!1},l)}),[c,l,a,i]);typeof n=="string"&&(n=x0(n));let{pathname:f="/",search:p="",hash:g="",state:y=null,key:v="default"}=n,_=C.useMemo(()=>{let b=F3(f,c);return b==null?null:{location:{pathname:b,search:p,hash:g,state:y,key:v},navigationType:s}},[c,f,p,g,y,v,s]);return _==null?null:C.createElement(Tp.Provider,{value:d},C.createElement(N1.Provider,{children:r,value:_}))}function b2(e){let{children:t,location:r}=e;return xR(r_(t),r)}new Promise(()=>{});function r_(e,t){t===void 0&&(t=[]);let r=[];return C.Children.forEach(e,(n,s)=>{if(!C.isValidElement(n))return;let a=[...t,s];if(n.type===C.Fragment){r.push.apply(r,r_(n.props.children,a));return}n.type!==ds&&Ls(!1),!n.props.index||!n.props.children||Ls(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=r_(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const PR="6";try{window.__reactRouterVersion=PR}catch{}const RR="startTransition",Ik=OP[RR];function DR(e){let{basename:t,children:r,future:n,window:s}=e,a=C.useRef();a.current==null&&(a.current=zP({window:s,v5Compat:!0}));let i=a.current,[l,c]=C.useState({action:i.action,location:i.location}),{v7_startTransition:d}=n||{},f=C.useCallback(p=>{d&&Ik?Ik(()=>c(p)):c(p)},[c,d]);return C.useLayoutEffect(()=>i.listen(f),[i,f]),C.useEffect(()=>jR(n),[n]),C.createElement(FR,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:i,future:n})}var Mk;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Mk||(Mk={}));var Ok;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Ok||(Ok={}));const Bn={student_subjects:1800*1e3,student_active_tests:600*1e3,student_results_table:600*1e3,teacher_subjects:900*1e3,teacher_classes:900*1e3,teacher_tests:600*1e3,teacher_results_table:600*1e3,admin_users:1200*1e3,admin_teachers:1200*1e3,admin_subjects:1800*1e3,admin_academic_years:3600*1e3,admin_tests:900*1e3,admin_results_table:null,admin_teacher_id:3600*1e3,all_tests:1200*1e3,subjects_dropdown:1800*1e3,grades_classes:3600*1e3,test_progress:120*1e3,anti_cheating:120*1e3,word_matching_test:600*1e3,speaking_test_data:3600*1e3},Rn=e=>{try{const t=localStorage.getItem(e);if(!t)return console.log(" Cache: No data found for key:",e),null;const{data:r,timestamp:n,ttl:s}=JSON.parse(t),a=Date.now()-n;return a>s?(console.log(" Cache: Data expired for key:",e,"age:",a,"ttl:",s),localStorage.removeItem(e),null):(console.log(" Cache: Data found for key:",e,"age:",a,"ttl:",s),r)}catch(t){return console.log(" Cache: Corrupted data for key:",e,t),localStorage.removeItem(e),null}},Dn=(e,t,r)=>{try{console.log(" Cache: Setting data for key:",e,"ttl:",r),localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached successfully for key:",e)}catch{console.log(" Cache: Storage full, cleaning old data for key:",e),U3();try{localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached after cleanup for key:",e)}catch{console.warn("Storage full, cannot cache data")}}},U3=()=>{const e=Date.now(),t=Object.keys(localStorage);t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i,ttl:l}=JSON.parse(a);e-i>l&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const r=e-10080*60*1e3;t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i}=JSON.parse(a);i<r&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const n=Object.keys(localStorage);if(n.length>0){const s=n.map(i=>{try{const l=localStorage.getItem(i);if(l){const{timestamp:c}=JSON.parse(l);return{key:i,timestamp:c}}}catch{return{key:i,timestamp:0}}return{key:i,timestamp:0}}),a=Math.ceil(s.length*.25);s.sort((i,l)=>i.timestamp-l.timestamp).slice(0,a).forEach(({key:i})=>localStorage.removeItem(i))}},S2=e=>{Object.keys(localStorage).forEach(r=>{r.includes(e)&&localStorage.removeItem(r)})},y0=(e,t,r)=>{const n=`test_progress_${e}_${t}_${r}`,s=`anti_cheating_${e}_${t}_${r}`;if(localStorage.removeItem(n),localStorage.removeItem(s),t==="speaking_test_data"){const a=`speaking_test_data_${e}_${r}`;localStorage.removeItem(a),console.log(`Cleared speaking test data cache for ${r}`)}console.log(`Cleared test data for ${t}_${r}`)},Lh=Object.freeze(Object.defineProperty({__proto__:null,CACHE_TTL:Bn,cleanupOldData:U3,clearTestData:y0,clearUserData:S2,getCachedData:Rn,setCachedData:Dn},Symbol.toStringTag,{value:"Module"})),$3=C.createContext(),W3=({children:e})=>{const[t,r]=C.useState(null),[n,s]=C.useState(null),[a,i]=C.useState(localStorage.getItem("token")),[l,c]=C.useState(!1),[d,f]=C.useState(!0),[p,g]=C.useState(null);C.useEffect(()=>{console.log("[AUTH] Initializing application session..."),b()},[]),C.useEffect(()=>{if(l&&a){console.log("[AUTH] Setting up proactive token refresh...");let q=!1;const L=setInterval(async()=>{if(l&&a&&!q){q=!0;try{const M=a||localStorage.getItem("auth_token");if(M&&y(M))console.log("[AUTH] Token expired, attempting refresh..."),await v()||console.log("[AUTH] Proactive refresh failed, but user remains logged in");else if(M)try{const K=JSON.parse(atob(M.split(".")[1])).exp*1e3,Z=Date.now(),J=K-Z;J<300*1e3&&J>0&&(console.log(`[AUTH] Token expires in ${Math.round(J/1e3)} seconds, refreshing...`),await v()||console.log("[AUTH] Proactive refresh failed, but user remains logged in"))}catch(X){console.error("[AUTH] Error parsing token for expiration check:",X)}}catch(M){console.error("[AUTH] Error in proactive refresh:",M)}finally{q=!1}}},300*1e3);return()=>{console.log("[AUTH] Clearing proactive token refresh interval"),clearInterval(L)}}},[l,a]);const y=q=>{if(!q)return!0;try{const L=JSON.parse(atob(q.split(".")[1])),M=Date.now()/1e3;return L.exp<=M}catch(L){return console.error("[AUTH] Error decoding token:",L),!0}},v=async()=>{const q=localStorage.getItem("refresh_token");if(!q)return console.log("[AUTH] No refresh token found"),!1;try{const L=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:q})});if(L.ok){const M=await L.json();console.log("[AUTH] Token refresh successful"),localStorage.setItem("auth_token",M.accessToken),localStorage.setItem("refresh_token",M.refreshToken),localStorage.setItem("accessToken",M.accessToken);try{window.tokenManager&&(window.tokenManager.setToken(M.accessToken),M.refreshToken&&window.tokenManager.setRefreshToken(M.refreshToken))}catch{}return i(M.accessToken),!0}else return console.error("[AUTH] Token refresh failed:",L.status),!1}catch(L){return console.error("[AUTH] Token refresh error:",L),!1}},_=async(q,L={})=>{const M=a||localStorage.getItem("auth_token");if(!M)throw new Error("No authentication token found");const X={"Content-Type":"application/json",Authorization:`Bearer ${M}`,...L.headers},K=await fetch(q,{...L,headers:X});if(K.status===401)if(console.log("[AUTH] 401 error, attempting token refresh..."),await v()){const J=localStorage.getItem("auth_token");return X.Authorization=`Bearer ${J}`,fetch(q,{...L,headers:X})}else throw console.log("[AUTH] Token refresh failed, returning 401 response"),new Error("Authentication failed - please login again");return K},b=async()=>{try{console.log("[AUTH] Starting session initialization..."),f(!0);const q=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token"),L=localStorage.getItem("user_data")||localStorage.getItem("userData"),M=L?JSON.parse(L).role:null;if(console.log("[AUTH] Found stored data:",{hasToken:!!q,hasUser:!!L,role:M}),q&&M&&L)try{const X=JSON.parse(L);if(y(q))if(console.log("[AUTH] Token expired, attempting refresh..."),await v()){console.log("[AUTH] Token refreshed successfully");const Z=localStorage.getItem("auth_token");i(Z)}else console.log("[AUTH] Token refresh failed, but continuing with existing token..."),i(q);else i(q);s(M),r(X);try{if(window.tokenManager){window.tokenManager.setToken(localStorage.getItem("auth_token"));const K=localStorage.getItem("refresh_token");K&&window.tokenManager.setRefreshToken(K)}}catch{}c(!0),await w(X,M)}catch(X){console.error("[AUTH] Error parsing stored user data:",X),console.log("[AUTH] Invalid user data, but not forcing logout - continuing with empty state"),c(!1)}}catch(q){console.error("[AUTH] Session initialization error:",q),console.log("[AUTH] Initialization error, but not forcing logout - continuing with empty state"),c(!1)}finally{console.log("[AUTH] Session initialization complete"),f(!1)}},N=async q=>{try{if(f(!0),g(null),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),g("Please wait for the logout process to complete.");return}console.log("Attempting login with:",q.username);let L,M;q.username==="admin"?(L={ok:!0,json:()=>({success:!0,token:"test-token"})},M="admin"):(L=await authService.teacherLogin(q),M="teacher");const X=await L.json();await k(L,M,X)}catch(L){E(L)}finally{f(!1)}},k=async(q,L,M)=>{try{if(q.ok&&M.success&&M.token){i(M.token),s(L),r(M),c(!0),localStorage.setItem("auth_token",M.accessToken||M.token),localStorage.setItem("refresh_token",M.refreshToken),localStorage.setItem("user_data",JSON.stringify(M)),localStorage.setItem("accessToken",M.accessToken||M.token);try{const X=Date.now(),K=10080*60*1e3,Z=[];for(let J=0;J<localStorage.length;J++){const ne=localStorage.key(J);if(!(!ne||!(ne.startsWith("test_progress_")||ne.startsWith("test_timer_")||ne.startsWith("test_shuffle_order_")||ne.startsWith("student_results_table_")||ne.startsWith("anti_cheating_"))))try{const xe=localStorage.getItem(ne);if(!xe){Z.push(ne);continue}let Ne=null;if(xe.startsWith("{")||xe.startsWith("[")){const le=JSON.parse(xe),ge=le.timestamp||le.lastSaved||le.lastTickAt||le.createdAt||le.updatedAt||le.startedAt||le.started_at;ge&&(Ne=new Date(ge).getTime())}if(!Ne){const le=`${ne}__ts`,ge=localStorage.getItem(le);ge&&(Ne=parseInt(ge)||null)}if(!Ne)continue;X-Ne>K&&Z.push(ne)}catch{}}Z.forEach(J=>{try{localStorage.removeItem(J)}catch{}})}catch(X){console.warn("LocalStorage cleanup skipped:",X)}return await w(M,L),!0}else{const X=M.message||q.statusText||"Login failed";return E(new Error(X)),!1}}catch(X){return E(X),!1}},w=async(q,L)=>{try{switch(L){case"admin":console.log("Admin login successful, role:",q.role),console.log("Admin logged in:",q);break;case"teacher":console.log("Teacher login successful, role:",q.role),console.log("Teacher data:",q.teacher),await A(q),await R();break;case"student":console.log("Student login successful"),T(q);break;default:console.warn("Unknown user role:",L)}}catch(M){console.error("Post-login actions error:",M)}},T=q=>{r(q),console.log("Student info populated:",q)},A=async q=>{r(q),console.log("Teacher info populated:",q)},F=async()=>{try{console.log("Initializing teacher cabinet...")}catch(q){console.error("Error initializing teacher cabinet:",q)}},R=async()=>{try{console.log("Checking teacher subjects...")}catch(q){console.error("Error checking teacher subjects:",q)}},E=q=>{g(q.message||"Login failed"),D()},D=()=>{g(null),f(!1)},I=C.useCallback(()=>{G()},[]),G=()=>{r(null),s(null),i(null),c(!1),g(null);const q=t?.student_id||t?.teacher_id||t?.admin_id||t?.id;q&&S2(q),localStorage.removeItem("token"),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),localStorage.removeItem("auth_token"),localStorage.removeItem("user_data"),localStorage.removeItem("user_role"),localStorage.removeItem("accessToken"),localStorage.removeItem("testProgress"),localStorage.removeItem("formData"),window.tokenManager&&window.tokenManager.clearAuth(),setTimeout(()=>{Y()},100)},Y=()=>{console.log("Interface reset after session clear - redirecting to login"),window.location.replace("/login")},ee=()=>t?.id||null,ie=()=>n==="admin"?t:null,re=()=>n==="admin",se=()=>re()?t?.admin_id:null,B=()=>n==="teacher"?t?.username:null,z=()=>{console.log("Auth functions available:",{handleUnifiedLogin:typeof N,logout:typeof I,getCurrentTeacherId:typeof ee,isAdmin:typeof re,getCurrentAdmin:typeof ie,getCurrentAdminId:typeof se,getCurrentTeacherUsername:typeof B})};C.useEffect(()=>(window.logout=I,window.getCurrentTeacherId=ee,window.getCurrentAdmin=ie,window.isAdmin=re,window.getCurrentAdminId=se,window.getCurrentTeacherUsername=B,window.checkFunctionAvailability=z,()=>{delete window.logout,delete window.getCurrentTeacherId,delete window.getCurrentAdmin,delete window.isAdmin,delete window.getCurrentAdminId,delete window.getCurrentTeacherUsername,delete window.checkFunctionAvailability}),[I]);const U=C.useCallback(q=>{console.log("Setting user data from external auth:",q),r(q),s(q.role),i(q.token),c(!0),f(!1),g(null),localStorage.setItem("auth_token",q.token),localStorage.setItem("user_data",JSON.stringify(q)),localStorage.setItem("accessToken",q.token)},[]),V={user:t,role:n,token:a,isAuthenticated:l,isLoading:d,error:p,login:N,setUserData:U,logout:I,resetLoginForm:D,forceCompleteLogout:G,initializeApplicationSession:b,makeAuthenticatedRequest:_,populateStudentInfo:T,populateTeacherInfo:A,initializeTeacherCabinet:F,checkTeacherSubjects:R,getCurrentTeacherId:ee,getCurrentAdmin:ie,isAdmin:re,getCurrentAdminId:se,getCurrentTeacherUsername:B,handleLoginResponse:k,handlePostLoginActions:w,handleLoginFailure:E,resetInterfaceAfterSessionClear:Y,checkFunctionAvailability:z};return o.jsx($3.Provider,{value:V,children:e})},Hn=()=>{const e=C.useContext($3);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};class IR{constructor(){this.baseURL="http://localhost:8888/.netlify/functions",this.timeout=1e4,this.retryCount=3,this.retryDelay=1e3}getHeaders(){const t=localStorage.getItem("token");return{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`}}}async sendRequest(t,r){try{return await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(n){throw console.error(" Network error:",n),n}}async request(t,r={}){const n=`${this.baseURL}${t}`,s={method:"GET",headers:this.getHeaders(),timeout:this.timeout,...r};let a;for(let i=0;i<this.retryCount;i++)try{const l=new AbortController,c=setTimeout(()=>l.abort(),this.timeout),d=await fetch(n,{...s,signal:l.signal});if(clearTimeout(c),!d.ok)throw new Error(`HTTP error! status: ${d.status}`);return await d.json()}catch(l){if(a=l,l.name==="AbortError")throw new Error("Request timeout");i<this.retryCount-1&&(console.warn(`Request failed, retrying in ${this.retryDelay}ms... (attempt ${i+1}/${this.retryCount})`),await new Promise(c=>setTimeout(c,this.retryDelay*Math.pow(2,i))))}throw a}async get(t,r={}){return this.request(t,{...r,method:"GET"})}async post(t,r,n={}){return this.request(t,{...n,method:"POST",body:JSON.stringify(r)})}async put(t,r,n={}){return this.request(t,{...n,method:"PUT",body:JSON.stringify(r)})}async delete(t,r={}){return this.request(t,{...r,method:"DELETE"})}async patch(t,r,n={}){return this.request(t,{...n,method:"PATCH",body:JSON.stringify(r)})}async uploadFile(t,r,n={}){const s=new FormData;s.append("file",r);const a=`${this.baseURL}${t}`,i={method:"POST",headers:{...localStorage.getItem("token")&&{Authorization:`Bearer ${localStorage.getItem("token")}`}},body:s,...n};try{const l=await fetch(a,i);if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return await l.json()}catch(l){throw l}}async downloadFile(t,r,n={}){const s=`${this.baseURL}${t}`,a={method:"GET",headers:this.getHeaders(),...n};try{const i=await fetch(s,a);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const l=await i.blob(),c=window.URL.createObjectURL(l),d=document.createElement("a");d.href=c,d.download=r,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(c)}catch(i){throw i}}ensureDebugOutput(){let t=document.getElementById("debug-output");return t||(t=document.createElement("div"),t.id="debug-output",t.className="fixed top-4 right-4 w-96 max-h-96 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-50 overflow-auto",t.innerHTML='<div class="text-sm font-mono text-gray-800">Debug Output</div>',document.body.appendChild(t)),t}async testDbConnection(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/test-db-connection")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Database Connection Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,message:"Database connection successful",data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Database Connection Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,message:"Database connection failed",error:t.message}}}async testStudentLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:"51706",password:"1"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Student Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Student Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testTeacherLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"Aleksandr_Petrov",password:"465"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Teacher Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Teacher Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testAdminLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"admin",password:"admin123"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Admin Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Admin Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetTeacherSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-teacher-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Teacher Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Teacher Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetClassResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-class-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Class Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Class Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentTestResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-test-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Test Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Test Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testEndpoints(){const t=["/debug/test-student-login","/debug/test-teacher-login","/debug/test-admin-login","/debug/test-get-subjects","/debug/test-get-teacher-subjects","/debug/test-get-class-results","/debug/test-get-student-subjects","/debug/test-get-student-test-results"],r={};for(const n of t)try{const s=await this.get(n);r[n]={success:!0,data:s}}catch(s){r[n]={success:!1,error:s.message}}return r}async debugFunction(t){const r=this.ensureDebugOutput();try{let n;switch(t){case"testDbConnection":n=await this.testDbConnection();break;case"testStudentLogin":n=await this.testStudentLogin();break;case"testTeacherLogin":n=await this.testTeacherLogin();break;case"testAdminLogin":n=await this.testAdminLogin();break;case"testGetSubjects":n=await this.testGetSubjects();break;case"testGetTeacherSubjects":n=await this.testGetTeacherSubjects();break;case"testGetClassResults":n=await this.testGetClassResults();break;case"testGetStudentSubjects":n=await this.testGetStudentSubjects();break;case"testGetStudentTestResults":n=await this.testGetStudentTestResults();break;default:throw new Error(`Unknown debug function: ${t}`)}return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Debug Function: ${t}</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),n}catch(n){throw r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Debug Function Error: ${t}</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${n.message}</pre>
        `),n}}showDebugFunctions(){const t=this.ensureDebugOutput(),r=`
      <div class="text-sm font-mono text-gray-800 mb-4">Debug Functions</div>
      <div class="grid grid-cols-2 gap-2 mb-4">
        <button onclick="apiClient.testDbConnection()" class="px-3 py-2 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition-colors">
          Test DB Connection
        </button>
        <button onclick="apiClient.testStudentLogin()" class="px-3 py-2 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors">
          Test Student Login
        </button>
        <button onclick="apiClient.testTeacherLogin()" class="px-3 py-2 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600 transition-colors">
          Test Teacher Login
        </button>
        <button onclick="apiClient.testAdminLogin()" class="px-3 py-2 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors">
          Test Admin Login
        </button>
        <button onclick="apiClient.testGetSubjects()" class="px-3 py-2 bg-purple-500 text-white text-xs rounded hover:bg-purple-600 transition-colors">
          Test Get Subjects
        </button>
        <button onclick="apiClient.testGetTeacherSubjects()" class="px-3 py-2 bg-indigo-500 text-white text-xs rounded hover:bg-indigo-600 transition-colors">
          Test Get Teacher Subjects
        </button>
        <button onclick="apiClient.testGetClassResults()" class="px-3 py-2 bg-pink-500 text-white text-xs rounded hover:bg-pink-600 transition-colors">
          Test Get Class Results
        </button>
        <button onclick="apiClient.testGetStudentSubjects()" class="px-3 py-2 bg-teal-500 text-white text-xs rounded hover:bg-teal-600 transition-colors">
          Test Get Student Subjects
        </button>
        <button onclick="apiClient.testGetStudentTestResults()" class="px-3 py-2 bg-orange-500 text-white text-xs rounded hover:bg-orange-600 transition-colors">
          Test Get Student Test Results
        </button>
        <button onclick="apiClient.testEndpoints()" class="px-3 py-2 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 transition-colors">
          Test All Endpoints
        </button>
      </div>
    `;t.innerHTML=r}}const os=new IR,k2=C.createContext({});function C2(e){const t=C.useRef(null);return t.current===null&&(t.current=e()),t.current}const T2=typeof window<"u",z3=T2?C.useLayoutEffect:C.useEffect,F1=C.createContext(null);function E2(e,t){e.indexOf(t)===-1&&e.push(t)}function N2(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const Nc=(e,t,r)=>r>t?t:r<e?e:r;let A2=()=>{};const Ac={},H3=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function G3(e){return typeof e=="object"&&e!==null}const V3=e=>/^0[^.\s]+$/u.test(e);function j2(e){let t;return()=>(t===void 0&&(t=e()),t)}const _o=e=>e,MR=(e,t)=>r=>t(e(r)),Np=(...e)=>e.reduce(MR),Xm=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class F2{constructor(){this.subscriptions=[]}add(t){return E2(this.subscriptions,t),()=>N2(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let a=0;a<s;a++){const i=this.subscriptions[a];i&&i(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Rl=e=>e*1e3,Dl=e=>e/1e3;function K3(e,t){return t?e*(1e3/t):0}const q3=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,OR=1e-7,LR=12;function BR(e,t,r,n,s){let a,i,l=0;do i=t+(r-t)/2,a=q3(i,n,s)-e,a>0?r=i:t=i;while(Math.abs(a)>OR&&++l<LR);return i}function Ap(e,t,r,n){if(e===t&&r===n)return _o;const s=a=>BR(a,0,1,e,r);return a=>a===0||a===1?a:q3(s(a),t,n)}const X3=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Y3=e=>t=>1-e(1-t),J3=Ap(.33,1.53,.69,.99),P2=Y3(J3),Q3=X3(P2),Z3=e=>(e*=2)<1?.5*P2(e):.5*(2-Math.pow(2,-10*(e-1))),R2=e=>1-Math.sin(Math.acos(e)),e5=Y3(R2),t5=X3(R2),UR=Ap(.42,0,1,1),$R=Ap(0,0,.58,1),r5=Ap(.42,0,.58,1),WR=e=>Array.isArray(e)&&typeof e[0]!="number",n5=e=>Array.isArray(e)&&typeof e[0]=="number",zR={linear:_o,easeIn:UR,easeInOut:r5,easeOut:$R,circIn:R2,circInOut:t5,circOut:e5,backIn:P2,backInOut:Q3,backOut:J3,anticipate:Z3},HR=e=>typeof e=="string",Lk=e=>{if(n5(e)){A2(e.length===4);const[t,r,n,s]=e;return Ap(t,r,n,s)}else if(HR(e))return zR[e];return e},ry=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function GR(e,t){let r=new Set,n=new Set,s=!1,a=!1;const i=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function c(f){i.has(f)&&(d.schedule(f),e()),f(l)}const d={schedule:(f,p=!1,g=!1)=>{const v=g&&s?r:n;return p&&i.add(f),v.has(f)||v.add(f),f},cancel:f=>{n.delete(f),i.delete(f)},process:f=>{if(l=f,s){a=!0;return}s=!0,[r,n]=[n,r],r.forEach(c),r.clear(),s=!1,a&&(a=!1,d.process(f))}};return d}const VR=40;function s5(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=ry.reduce((w,T)=>(w[T]=GR(a),w),{}),{setup:l,read:c,resolveKeyframes:d,preUpdate:f,update:p,preRender:g,render:y,postRender:v}=i,_=()=>{const w=Ac.useManualTiming?s.timestamp:performance.now();r=!1,Ac.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(w-s.timestamp,VR),1)),s.timestamp=w,s.isProcessing=!0,l.process(s),c.process(s),d.process(s),f.process(s),p.process(s),g.process(s),y.process(s),v.process(s),s.isProcessing=!1,r&&t&&(n=!1,e(_))},b=()=>{r=!0,n=!0,s.isProcessing||e(_)};return{schedule:ry.reduce((w,T)=>{const A=i[T];return w[T]=(F,R=!1,E=!1)=>(r||b(),A.schedule(F,R,E)),w},{}),cancel:w=>{for(let T=0;T<ry.length;T++)i[ry[T]].cancel(w)},state:s,steps:i}}const{schedule:Kn,cancel:Lu,state:ba,steps:Vv}=s5(typeof requestAnimationFrame<"u"?requestAnimationFrame:_o,!0);let Ay;function KR(){Ay=void 0}const Ni={now:()=>(Ay===void 0&&Ni.set(ba.isProcessing||Ac.useManualTiming?ba.timestamp:performance.now()),Ay),set:e=>{Ay=e,queueMicrotask(KR)}},a5=e=>t=>typeof t=="string"&&t.startsWith(e),D2=a5("--"),qR=a5("var(--"),I2=e=>qR(e)?XR.test(e.split("/*")[0].trim()):!1,XR=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,v0={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Ym={...v0,transform:e=>Nc(0,1,e)},ny={...v0,default:1},Am=e=>Math.round(e*1e5)/1e5,M2=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function YR(e){return e==null}const JR=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,O2=(e,t)=>r=>!!(typeof r=="string"&&JR.test(r)&&r.startsWith(e)||t&&!YR(r)&&Object.prototype.hasOwnProperty.call(r,t)),i5=(e,t,r)=>n=>{if(typeof n!="string")return n;const[s,a,i,l]=n.match(M2);return{[e]:parseFloat(s),[t]:parseFloat(a),[r]:parseFloat(i),alpha:l!==void 0?parseFloat(l):1}},QR=e=>Nc(0,255,e),Kv={...v0,transform:e=>Math.round(QR(e))},Ld={test:O2("rgb","red"),parse:i5("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+Kv.transform(e)+", "+Kv.transform(t)+", "+Kv.transform(r)+", "+Am(Ym.transform(n))+")"};function ZR(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const n_={test:O2("#"),parse:ZR,transform:Ld.transform},jp=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Cu=jp("deg"),Il=jp("%"),Sr=jp("px"),eD=jp("vh"),tD=jp("vw"),Bk={...Il,parse:e=>Il.parse(e)/100,transform:e=>Il.transform(e*100)},Bh={test:O2("hsl","hue"),parse:i5("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+Il.transform(Am(t))+", "+Il.transform(Am(r))+", "+Am(Ym.transform(n))+")"},Ms={test:e=>Ld.test(e)||n_.test(e)||Bh.test(e),parse:e=>Ld.test(e)?Ld.parse(e):Bh.test(e)?Bh.parse(e):n_.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Ld.transform(e):Bh.transform(e),getAnimatableNone:e=>{const t=Ms.parse(e);return t.alpha=0,Ms.transform(t)}},rD=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function nD(e){return isNaN(e)&&typeof e=="string"&&(e.match(M2)?.length||0)+(e.match(rD)?.length||0)>0}const o5="number",l5="color",sD="var",aD="var(",Uk="${}",iD=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Jm(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},s=[];let a=0;const l=t.replace(iD,c=>(Ms.test(c)?(n.color.push(a),s.push(l5),r.push(Ms.parse(c))):c.startsWith(aD)?(n.var.push(a),s.push(sD),r.push(c)):(n.number.push(a),s.push(o5),r.push(parseFloat(c))),++a,Uk)).split(Uk);return{values:r,split:l,indexes:n,types:s}}function c5(e){return Jm(e).values}function u5(e){const{split:t,types:r}=Jm(e),n=t.length;return s=>{let a="";for(let i=0;i<n;i++)if(a+=t[i],s[i]!==void 0){const l=r[i];l===o5?a+=Am(s[i]):l===l5?a+=Ms.transform(s[i]):a+=s[i]}return a}}const oD=e=>typeof e=="number"?0:Ms.test(e)?Ms.getAnimatableNone(e):e;function lD(e){const t=c5(e);return u5(e)(t.map(oD))}const Bu={test:nD,parse:c5,createTransformer:u5,getAnimatableNone:lD};function qv(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function cD({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,a=0,i=0;if(!t)s=a=i=r;else{const l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;s=qv(c,l,e+1/3),a=qv(c,l,e),i=qv(c,l,e-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:n}}function $y(e,t){return r=>r>0?t:e}const Zn=(e,t,r)=>e+(t-e)*r,Xv=(e,t,r)=>{const n=e*e,s=r*(t*t-n)+n;return s<0?0:Math.sqrt(s)},uD=[n_,Ld,Bh],dD=e=>uD.find(t=>t.test(e));function $k(e){const t=dD(e);if(!t)return!1;let r=t.parse(e);return t===Bh&&(r=cD(r)),r}const Wk=(e,t)=>{const r=$k(e),n=$k(t);if(!r||!n)return $y(e,t);const s={...r};return a=>(s.red=Xv(r.red,n.red,a),s.green=Xv(r.green,n.green,a),s.blue=Xv(r.blue,n.blue,a),s.alpha=Zn(r.alpha,n.alpha,a),Ld.transform(s))},s_=new Set(["none","hidden"]);function fD(e,t){return s_.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function hD(e,t){return r=>Zn(e,t,r)}function L2(e){return typeof e=="number"?hD:typeof e=="string"?I2(e)?$y:Ms.test(e)?Wk:pD:Array.isArray(e)?d5:typeof e=="object"?Ms.test(e)?Wk:gD:$y}function d5(e,t){const r=[...e],n=r.length,s=e.map((a,i)=>L2(a)(a,t[i]));return a=>{for(let i=0;i<n;i++)r[i]=s[i](a);return r}}function gD(e,t){const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=L2(e[s])(e[s],t[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}}function mD(e,t){const r=[],n={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const a=t.types[s],i=e.indexes[a][n[a]],l=e.values[i]??0;r[s]=l,n[a]++}return r}const pD=(e,t)=>{const r=Bu.createTransformer(t),n=Jm(e),s=Jm(t);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?s_.has(e)&&!s.values.length||s_.has(t)&&!n.values.length?fD(e,t):Np(d5(mD(n,s),s.values),r):$y(e,t)};function f5(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?Zn(e,t,r):L2(e)(e,t)}const xD=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>Kn.update(t,r),stop:()=>Lu(t),now:()=>ba.isProcessing?ba.timestamp:Ni.now()}},h5=(e,t,r=10)=>{let n="";const s=Math.max(Math.round(t/r),2);for(let a=0;a<s;a++)n+=Math.round(e(a/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},Wy=2e4;function B2(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<Wy;)t+=r,n=e.next(t);return t>=Wy?1/0:t}function yD(e,t=100,r){const n=r({...e,keyframes:[0,t]}),s=Math.min(B2(n),Wy);return{type:"keyframes",ease:a=>n.next(s*a).value/t,duration:Dl(s)}}const vD=5;function g5(e,t,r){const n=Math.max(t-vD,0);return K3(r-e(n),t-n)}const ls={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Yv=.001;function wD({duration:e=ls.duration,bounce:t=ls.bounce,velocity:r=ls.velocity,mass:n=ls.mass}){let s,a,i=1-t;i=Nc(ls.minDamping,ls.maxDamping,i),e=Nc(ls.minDuration,ls.maxDuration,Dl(e)),i<1?(s=d=>{const f=d*i,p=f*e,g=f-r,y=a_(d,i),v=Math.exp(-p);return Yv-g/y*v},a=d=>{const p=d*i*e,g=p*r+r,y=Math.pow(i,2)*Math.pow(d,2)*e,v=Math.exp(-p),_=a_(Math.pow(d,2),i);return(-s(d)+Yv>0?-1:1)*((g-y)*v)/_}):(s=d=>{const f=Math.exp(-d*e),p=(d-r)*e+1;return-Yv+f*p},a=d=>{const f=Math.exp(-d*e),p=(r-d)*(e*e);return f*p});const l=5/e,c=bD(s,a,l);if(e=Rl(e),isNaN(c))return{stiffness:ls.stiffness,damping:ls.damping,duration:e};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:i*2*Math.sqrt(n*d),duration:e}}}const _D=12;function bD(e,t,r){let n=r;for(let s=1;s<_D;s++)n=n-e(n)/t(n);return n}function a_(e,t){return e*Math.sqrt(1-t*t)}const SD=["duration","bounce"],kD=["stiffness","damping","mass"];function zk(e,t){return t.some(r=>e[r]!==void 0)}function CD(e){let t={velocity:ls.velocity,stiffness:ls.stiffness,damping:ls.damping,mass:ls.mass,isResolvedFromDuration:!1,...e};if(!zk(e,kD)&&zk(e,SD))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,a=2*Nc(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:ls.mass,stiffness:s,damping:a}}else{const r=wD(e);t={...t,...r,mass:ls.mass},t.isResolvedFromDuration=!0}return t}function zy(e=ls.visualDuration,t=ls.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:s}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],l={done:!1,value:a},{stiffness:c,damping:d,mass:f,duration:p,velocity:g,isResolvedFromDuration:y}=CD({...r,velocity:-Dl(r.velocity||0)}),v=g||0,_=d/(2*Math.sqrt(c*f)),b=i-a,N=Dl(Math.sqrt(c/f)),k=Math.abs(b)<5;n||(n=k?ls.restSpeed.granular:ls.restSpeed.default),s||(s=k?ls.restDelta.granular:ls.restDelta.default);let w;if(_<1){const A=a_(N,_);w=F=>{const R=Math.exp(-_*N*F);return i-R*((v+_*N*b)/A*Math.sin(A*F)+b*Math.cos(A*F))}}else if(_===1)w=A=>i-Math.exp(-N*A)*(b+(v+N*b)*A);else{const A=N*Math.sqrt(_*_-1);w=F=>{const R=Math.exp(-_*N*F),E=Math.min(A*F,300);return i-R*((v+_*N*b)*Math.sinh(E)+A*b*Math.cosh(E))/A}}const T={calculatedDuration:y&&p||null,next:A=>{const F=w(A);if(y)l.done=A>=p;else{let R=A===0?v:0;_<1&&(R=A===0?Rl(v):g5(w,A,F));const E=Math.abs(R)<=n,D=Math.abs(i-F)<=s;l.done=E&&D}return l.value=l.done?i:F,l},toString:()=>{const A=Math.min(B2(T),Wy),F=h5(R=>T.next(A*R).value,A,30);return A+"ms "+F},toTransition:()=>{}};return T}zy.applyToOptions=e=>{const t=yD(e,100,zy);return e.ease=t.ease,e.duration=Rl(t.duration),e.type="keyframes",e};function i_({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:i,min:l,max:c,restDelta:d=.5,restSpeed:f}){const p=e[0],g={done:!1,value:p},y=E=>l!==void 0&&E<l||c!==void 0&&E>c,v=E=>l===void 0?c:c===void 0||Math.abs(l-E)<Math.abs(c-E)?l:c;let _=r*t;const b=p+_,N=i===void 0?b:i(b);N!==b&&(_=N-p);const k=E=>-_*Math.exp(-E/n),w=E=>N+k(E),T=E=>{const D=k(E),I=w(E);g.done=Math.abs(D)<=d,g.value=g.done?N:I};let A,F;const R=E=>{y(g.value)&&(A=E,F=zy({keyframes:[g.value,v(g.value)],velocity:g5(w,E,g.value),damping:s,stiffness:a,restDelta:d,restSpeed:f}))};return R(0),{calculatedDuration:null,next:E=>{let D=!1;return!F&&A===void 0&&(D=!0,T(E),R(E)),A!==void 0&&E>=A?F.next(E-A):(!D&&T(E),g)}}}function TD(e,t,r){const n=[],s=r||Ac.mix||f5,a=e.length-1;for(let i=0;i<a;i++){let l=s(e[i],e[i+1]);if(t){const c=Array.isArray(t)?t[i]||_o:t;l=Np(c,l)}n.push(l)}return n}function ED(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const a=e.length;if(A2(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const l=TD(t,n,s),c=l.length,d=f=>{if(i&&f<e[0])return t[0];let p=0;if(c>1)for(;p<e.length-2&&!(f<e[p+1]);p++);const g=Xm(e[p],e[p+1],f);return l[p](g)};return r?f=>d(Nc(e[0],e[a-1],f)):d}function ND(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=Xm(0,t,n);e.push(Zn(r,1,s))}}function AD(e){const t=[0];return ND(t,e.length-1),t}function jD(e,t){return e.map(r=>r*t)}function FD(e,t){return e.map(()=>t||r5).splice(0,e.length-1)}function jm({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=WR(n)?n.map(Lk):Lk(n),a={done:!1,value:t[0]},i=jD(r&&r.length===t.length?r:AD(t),e),l=ED(i,t,{ease:Array.isArray(s)?s:FD(t,s)});return{calculatedDuration:e,next:c=>(a.value=l(c),a.done=c>=e,a)}}const PD=e=>e!==null;function U2(e,{repeat:t,repeatType:r="loop"},n,s=1){const a=e.filter(PD),l=s<0||t&&r!=="loop"&&t%2===1?0:a.length-1;return!l||n===void 0?a[l]:n}const RD={decay:i_,inertia:i_,tween:jm,keyframes:jm,spring:zy};function m5(e){typeof e.type=="string"&&(e.type=RD[e.type])}class $2{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const DD=e=>e/100;class W2 extends $2{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==Ni.now()&&this.tick(Ni.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;m5(t);const{type:r=jm,repeat:n=0,repeatDelay:s=0,repeatType:a,velocity:i=0}=t;let{keyframes:l}=t;const c=r||jm;c!==jm&&typeof l[0]!="number"&&(this.mixKeyframes=Np(DD,f5(l[0],l[1])),l=[0,100]);const d=c({...t,keyframes:l});a==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...l].reverse(),velocity:-i})),d.calculatedDuration===null&&(d.calculatedDuration=B2(d));const{calculatedDuration:f}=d;this.calculatedDuration=f,this.resolvedDuration=f+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=d}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:n,totalDuration:s,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:l,calculatedDuration:c}=this;if(this.startTime===null)return n.next(0);const{delay:d=0,keyframes:f,repeat:p,repeatType:g,repeatDelay:y,type:v,onUpdate:_,finalKeyframe:b}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const N=this.currentTime-d*(this.playbackSpeed>=0?1:-1),k=this.playbackSpeed>=0?N<0:N>s;this.currentTime=Math.max(N,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let w=this.currentTime,T=n;if(p){const E=Math.min(this.currentTime,s)/l;let D=Math.floor(E),I=E%1;!I&&E>=1&&(I=1),I===1&&D--,D=Math.min(D,p+1),!!(D%2)&&(g==="reverse"?(I=1-I,y&&(I-=y/l)):g==="mirror"&&(T=i)),w=Nc(0,1,I)*l}const A=k?{done:!1,value:f[0]}:T.next(w);a&&(A.value=a(A.value));let{done:F}=A;!k&&c!==null&&(F=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const R=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&F);return R&&v!==i_&&(A.value=U2(f,this.options,b,this.speed)),_&&_(A.value),R&&this.finish(),A}then(t,r){return this.finished.then(t,r)}get duration(){return Dl(this.calculatedDuration)}get time(){return Dl(this.currentTime)}set time(t){t=Rl(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Ni.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Dl(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=xD,startTime:r}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),this.options.onPlay?.();const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ni.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function ID(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Bd=e=>e*180/Math.PI,o_=e=>{const t=Bd(Math.atan2(e[1],e[0]));return l_(t)},MD={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:o_,rotateZ:o_,skewX:e=>Bd(Math.atan(e[1])),skewY:e=>Bd(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},l_=e=>(e=e%360,e<0&&(e+=360),e),Hk=o_,Gk=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Vk=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),OD={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Gk,scaleY:Vk,scale:e=>(Gk(e)+Vk(e))/2,rotateX:e=>l_(Bd(Math.atan2(e[6],e[5]))),rotateY:e=>l_(Bd(Math.atan2(-e[2],e[0]))),rotateZ:Hk,rotate:Hk,skewX:e=>Bd(Math.atan(e[4])),skewY:e=>Bd(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function c_(e){return e.includes("scale")?1:0}function u_(e,t){if(!e||e==="none")return c_(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=OD,s=r;else{const l=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=MD,s=l}if(!s)return c_(t);const a=n[t],i=s[1].split(",").map(BD);return typeof a=="function"?a(i):i[a]}const LD=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return u_(r,t)};function BD(e){return parseFloat(e.trim())}const w0=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],_0=new Set(w0),Kk=e=>e===v0||e===Sr,UD=new Set(["x","y","z"]),$D=w0.filter(e=>!UD.has(e));function WD(e){const t=[];return $D.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const zd={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>u_(t,"x"),y:(e,{transform:t})=>u_(t,"y")};zd.translateX=zd.x;zd.translateY=zd.y;const Hd=new Set;let d_=!1,f_=!1,h_=!1;function p5(){if(f_){const e=Array.from(Hd).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const s=WD(n);s.length&&(r.set(n,s),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([a,i])=>{n.getValue(a)?.set(i)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}f_=!1,d_=!1,Hd.forEach(e=>e.complete(h_)),Hd.clear()}function x5(){Hd.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(f_=!0)})}function zD(){h_=!0,x5(),p5(),h_=!1}class z2{constructor(t,r,n,s,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=s,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Hd.add(this),d_||(d_=!0,Kn.read(x5),Kn.resolveKeyframes(p5))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:s}=this;if(t[0]===null){const a=s?.get(),i=t[t.length-1];if(a!==void 0)t[0]=a;else if(n&&r){const l=n.readValue(r,i);l!=null&&(t[0]=l)}t[0]===void 0&&(t[0]=i),s&&a===void 0&&s.set(t[0])}ID(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Hd.delete(this)}cancel(){this.state==="scheduled"&&(Hd.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const HD=e=>e.startsWith("--");function GD(e,t,r){HD(t)?e.style.setProperty(t,r):e.style[t]=r}const VD=j2(()=>window.ScrollTimeline!==void 0),KD={};function qD(e,t){const r=j2(e);return()=>KD[t]??r()}const y5=qD(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Sm=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,qk={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Sm([0,.65,.55,1]),circOut:Sm([.55,0,1,.45]),backIn:Sm([.31,.01,.66,-.59]),backOut:Sm([.33,1.53,.69,.99])};function v5(e,t){if(e)return typeof e=="function"?y5()?h5(e,t):"ease-out":n5(e)?Sm(e):Array.isArray(e)?e.map(r=>v5(r,t)||qk.easeOut):qk[e]}function XD(e,t,r,{delay:n=0,duration:s=300,repeat:a=0,repeatType:i="loop",ease:l="easeOut",times:c}={},d=void 0){const f={[t]:r};c&&(f.offset=c);const p=v5(l,s);Array.isArray(p)&&(f.easing=p);const g={delay:n,duration:s,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return d&&(g.pseudoElement=d),e.animate(f,g)}function w5(e){return typeof e=="function"&&"applyToOptions"in e}function YD({type:e,...t}){return w5(e)&&y5()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class JD extends $2{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:n,keyframes:s,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:l,onComplete:c}=t;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=t,A2(typeof t.type!="string");const d=YD(t);this.animation=XD(r,n,s,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const f=U2(s,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(f):GD(r,n,f),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return Dl(Number(t))}get time(){return Dl(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Rl(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&VD()?(this.animation.timeline=t,_o):r(this)}}const _5={anticipate:Z3,backInOut:Q3,circInOut:t5};function QD(e){return e in _5}function ZD(e){typeof e.ease=="string"&&QD(e.ease)&&(e.ease=_5[e.ease])}const Xk=10;class e7 extends JD{constructor(t){ZD(t),m5(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:n,onComplete:s,element:a,...i}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const l=new W2({...i,autoplay:!1}),c=Rl(this.finishedTime??this.time);r.setWithVelocity(l.sample(c-Xk).value,l.sample(c).value,Xk),l.stop()}}const Yk=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Bu.test(e)||e==="0")&&!e.startsWith("url("));function t7(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function r7(e,t,r,n){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],i=Yk(s,t),l=Yk(a,t);return!i||!l?!1:t7(e)||(r==="spring"||w5(r))&&n}function g_(e){e.duration=0,e.type}const n7=new Set(["opacity","clipPath","filter","transform"]),s7=j2(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function a7(e){const{motionValue:t,name:r,repeatDelay:n,repeatType:s,damping:a,type:i}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:d}=t.owner.getProps();return s7()&&r&&n7.has(r)&&(r!=="transform"||!d)&&!c&&!n&&s!=="mirror"&&a!==0&&i!=="inertia"}const i7=40;class o7 extends $2{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:i="loop",keyframes:l,name:c,motionValue:d,element:f,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Ni.now();const g={autoplay:t,delay:r,type:n,repeat:s,repeatDelay:a,repeatType:i,name:c,motionValue:d,element:f,...p},y=f?.KeyframeResolver||z2;this.keyframeResolver=new y(l,(v,_,b)=>this.onKeyframesResolved(v,_,g,!b),c,d,f),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,r,n,s){this.keyframeResolver=void 0;const{name:a,type:i,velocity:l,delay:c,isHandoff:d,onUpdate:f}=n;this.resolvedAt=Ni.now(),r7(t,a,i,l)||((Ac.instantAnimations||!c)&&f?.(U2(t,n,r)),t[0]=t[t.length-1],g_(n),n.repeat=0);const g={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>i7?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:t},y=!d&&a7(g)?new e7({...g,element:g.motionValue.owner.current}):new W2(g);y.finished.then(()=>this.notifyFinished()).catch(_o),this.pendingTimeline&&(this.stopTimeline=y.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=y}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),zD()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const l7=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function c7(e){const t=l7.exec(e);if(!t)return[,];const[,r,n,s]=t;return[`--${r??n}`,s]}function b5(e,t,r=1){const[n,s]=c7(e);if(!n)return;const a=window.getComputedStyle(t).getPropertyValue(n);if(a){const i=a.trim();return H3(i)?parseFloat(i):i}return I2(s)?b5(s,t,r+1):s}function H2(e,t){return e?.[t]??e?.default??e}const S5=new Set(["width","height","top","left","right","bottom",...w0]),u7={test:e=>e==="auto",parse:e=>e},k5=e=>t=>t.test(e),C5=[v0,Sr,Il,Cu,tD,eD,u7],Jk=e=>C5.find(k5(e));function d7(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||V3(e):!0}const f7=new Set(["brightness","contrast","saturate","opacity"]);function h7(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(M2)||[];if(!n)return e;const s=r.replace(n,"");let a=f7.has(t)?1:0;return n!==r&&(a*=100),t+"("+a+s+")"}const g7=/\b([a-z-]*)\(.*?\)/gu,m_={...Bu,getAnimatableNone:e=>{const t=e.match(g7);return t?t.map(h7).join(" "):e}},Qk={...v0,transform:Math.round},m7={rotate:Cu,rotateX:Cu,rotateY:Cu,rotateZ:Cu,scale:ny,scaleX:ny,scaleY:ny,scaleZ:ny,skew:Cu,skewX:Cu,skewY:Cu,distance:Sr,translateX:Sr,translateY:Sr,translateZ:Sr,x:Sr,y:Sr,z:Sr,perspective:Sr,transformPerspective:Sr,opacity:Ym,originX:Bk,originY:Bk,originZ:Sr},G2={borderWidth:Sr,borderTopWidth:Sr,borderRightWidth:Sr,borderBottomWidth:Sr,borderLeftWidth:Sr,borderRadius:Sr,radius:Sr,borderTopLeftRadius:Sr,borderTopRightRadius:Sr,borderBottomRightRadius:Sr,borderBottomLeftRadius:Sr,width:Sr,maxWidth:Sr,height:Sr,maxHeight:Sr,top:Sr,right:Sr,bottom:Sr,left:Sr,padding:Sr,paddingTop:Sr,paddingRight:Sr,paddingBottom:Sr,paddingLeft:Sr,margin:Sr,marginTop:Sr,marginRight:Sr,marginBottom:Sr,marginLeft:Sr,backgroundPositionX:Sr,backgroundPositionY:Sr,...m7,zIndex:Qk,fillOpacity:Ym,strokeOpacity:Ym,numOctaves:Qk},p7={...G2,color:Ms,backgroundColor:Ms,outlineColor:Ms,fill:Ms,stroke:Ms,borderColor:Ms,borderTopColor:Ms,borderRightColor:Ms,borderBottomColor:Ms,borderLeftColor:Ms,filter:m_,WebkitFilter:m_},T5=e=>p7[e];function E5(e,t){let r=T5(e);return r!==m_&&(r=Bu),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const x7=new Set(["auto","none","0"]);function y7(e,t,r){let n=0,s;for(;n<e.length&&!s;){const a=e[n];typeof a=="string"&&!x7.has(a)&&Jm(a).values.length&&(s=e[n]),n++}if(s&&r)for(const a of t)e[a]=E5(r,s)}class v7 extends z2{constructor(t,r,n,s,a){super(t,r,n,s,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let d=t[c];if(typeof d=="string"&&(d=d.trim(),I2(d))){const f=b5(d,r.current);f!==void 0&&(t[c]=f),c===t.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!S5.has(n)||t.length!==2)return;const[s,a]=t,i=Jk(s),l=Jk(a);if(i!==l)if(Kk(i)&&Kk(l))for(let c=0;c<t.length;c++){const d=t[c];typeof d=="string"&&(t[c]=parseFloat(d))}else zd[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let s=0;s<t.length;s++)(t[s]===null||d7(t[s]))&&n.push(s);n.length&&y7(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=zd[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&t.getValue(n,s).jump(s,!1)}measureEndState(){const{element:t,name:r,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=n.length-1,i=n[a];n[a]=zd[r](t.measureViewportBox(),window.getComputedStyle(t.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),this.removedTransforms?.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function w7(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let n=document;const s=r?.[e]??n.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}const N5=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function A5(e){return G3(e)&&"offsetHeight"in e}const Zk=30,_7=e=>!isNaN(parseFloat(e));class b7{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{const s=Ni.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=Ni.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=_7(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new F2);const n=this.events[t].add(r);return t==="change"?()=>{n(),Kn.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Ni.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Zk)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,Zk);return K3(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function i0(e,t){return new b7(e,t)}const{schedule:V2}=s5(queueMicrotask,!1),zo={x:!1,y:!1};function j5(){return zo.x||zo.y}function S7(e){return e==="x"||e==="y"?zo[e]?null:(zo[e]=!0,()=>{zo[e]=!1}):zo.x||zo.y?null:(zo.x=zo.y=!0,()=>{zo.x=zo.y=!1})}function F5(e,t){const r=w7(e),n=new AbortController,s={passive:!0,...t,signal:n.signal};return[r,s,()=>n.abort()]}function eC(e){return!(e.pointerType==="touch"||j5())}function k7(e,t,r={}){const[n,s,a]=F5(e,r),i=l=>{if(!eC(l))return;const{target:c}=l,d=t(c,l);if(typeof d!="function"||!c)return;const f=p=>{eC(p)&&(d(p),c.removeEventListener("pointerleave",f))};c.addEventListener("pointerleave",f,s)};return n.forEach(l=>{l.addEventListener("pointerenter",i,s)}),a}const P5=(e,t)=>t?e===t?!0:P5(e,t.parentElement):!1,K2=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,C7=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function T7(e){return C7.has(e.tagName)||e.tabIndex!==-1}const jy=new WeakSet;function tC(e){return t=>{t.key==="Enter"&&e(t)}}function Jv(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const E7=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=tC(()=>{if(jy.has(r))return;Jv(r,"down");const s=tC(()=>{Jv(r,"up")}),a=()=>Jv(r,"cancel");r.addEventListener("keyup",s,t),r.addEventListener("blur",a,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function rC(e){return K2(e)&&!j5()}function N7(e,t,r={}){const[n,s,a]=F5(e,r),i=l=>{const c=l.currentTarget;if(!rC(l))return;jy.add(c);const d=t(c,l),f=(y,v)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",g),jy.has(c)&&jy.delete(c),rC(y)&&typeof d=="function"&&d(y,{success:v})},p=y=>{f(y,c===window||c===document||r.useGlobalTarget||P5(c,y.target))},g=y=>{f(y,!1)};window.addEventListener("pointerup",p,s),window.addEventListener("pointercancel",g,s)};return n.forEach(l=>{(r.useGlobalTarget?window:l).addEventListener("pointerdown",i,s),A5(l)&&(l.addEventListener("focus",d=>E7(d,s)),!T7(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),a}function R5(e){return G3(e)&&"ownerSVGElement"in e}function A7(e){return R5(e)&&e.tagName==="svg"}const za=e=>!!(e&&e.getVelocity),j7=[...C5,Ms,Bu],F7=e=>j7.find(k5(e)),q2=C.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class P7 extends C.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=A5(n)&&n.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function R7({children:e,isPresent:t,anchorX:r,root:n}){const s=C.useId(),a=C.useRef(null),i=C.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=C.useContext(q2);return C.useInsertionEffect(()=>{const{width:c,height:d,top:f,left:p,right:g}=i.current;if(t||!a.current||!c||!d)return;const y=r==="left"?`left: ${p}`:`right: ${g}`;a.current.dataset.motionPopId=s;const v=document.createElement("style");l&&(v.nonce=l);const _=n??document.head;return _.appendChild(v),v.sheet&&v.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${d}px !important;
            ${y}px !important;
            top: ${f}px !important;
          }
        `),()=>{_.contains(v)&&_.removeChild(v)}},[t]),o.jsx(P7,{isPresent:t,childRef:a,sizeRef:i,children:C.cloneElement(e,{ref:a})})}const D7=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:i,anchorX:l,root:c})=>{const d=C2(I7),f=C.useId();let p=!0,g=C.useMemo(()=>(p=!1,{id:f,initial:t,isPresent:r,custom:s,onExitComplete:y=>{d.set(y,!0);for(const v of d.values())if(!v)return;n&&n()},register:y=>(d.set(y,!1),()=>d.delete(y))}),[r,d,n]);return a&&p&&(g={...g}),C.useMemo(()=>{d.forEach((y,v)=>d.set(v,!1))},[r]),C.useEffect(()=>{!r&&!d.size&&n&&n()},[r]),i==="popLayout"&&(e=o.jsx(R7,{isPresent:r,anchorX:l,root:c,children:e})),o.jsx(F1.Provider,{value:g,children:e})};function I7(){return new Map}function D5(e=!0){const t=C.useContext(F1);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=t,a=C.useId();C.useEffect(()=>{if(e)return s(a)},[e]);const i=C.useCallback(()=>e&&n&&n(a),[a,n,e]);return!r&&n?[!1,i]:[!0]}const sy=e=>e.key||"";function nC(e){const t=[];return C.Children.forEach(e,r=>{C.isValidElement(r)&&t.push(r)}),t}const Ei=({children:e,custom:t,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:a="sync",propagate:i=!1,anchorX:l="left",root:c})=>{const[d,f]=D5(i),p=C.useMemo(()=>nC(e),[e]),g=i&&!d?[]:p.map(sy),y=C.useRef(!0),v=C.useRef(p),_=C2(()=>new Map),[b,N]=C.useState(p),[k,w]=C.useState(p);z3(()=>{y.current=!1,v.current=p;for(let F=0;F<k.length;F++){const R=sy(k[F]);g.includes(R)?_.delete(R):_.get(R)!==!0&&_.set(R,!1)}},[k,g.length,g.join("-")]);const T=[];if(p!==b){let F=[...p];for(let R=0;R<k.length;R++){const E=k[R],D=sy(E);g.includes(D)||(F.splice(R,0,E),T.push(E))}return a==="wait"&&T.length&&(F=T),w(nC(F)),N(p),null}const{forceRender:A}=C.useContext(k2);return o.jsx(o.Fragment,{children:k.map(F=>{const R=sy(F),E=i&&!d?!1:p===k||g.includes(R),D=()=>{if(_.has(R))_.set(R,!0);else return;let I=!0;_.forEach(G=>{G||(I=!1)}),I&&(A?.(),w(v.current),i&&f?.(),n&&n())};return o.jsx(D7,{isPresent:E,initial:!y.current||r?void 0:!1,custom:t,presenceAffectsLayout:s,mode:a,root:c,onExitComplete:E?void 0:D,anchorX:l,children:F},R)})})},I5=C.createContext({strict:!1}),sC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},o0={};for(const e in sC)o0[e]={isEnabled:t=>sC[e].some(r=>!!t[r])};function M7(e){for(const t in e)o0[t]={...o0[t],...e[t]}}const O7=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Hy(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||O7.has(e)}let M5=e=>!Hy(e);function L7(e){typeof e=="function"&&(M5=t=>t.startsWith("on")?!Hy(t):e(t))}try{L7(require("@emotion/is-prop-valid").default)}catch{}function B7(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(M5(s)||r===!0&&Hy(s)||!t&&!Hy(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}const P1=C.createContext({});function R1(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Qm(e){return typeof e=="string"||Array.isArray(e)}const X2=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Y2=["initial",...X2];function D1(e){return R1(e.animate)||Y2.some(t=>Qm(e[t]))}function O5(e){return!!(D1(e)||e.variants)}function U7(e,t){if(D1(e)){const{initial:r,animate:n}=e;return{initial:r===!1||Qm(r)?r:void 0,animate:Qm(n)?n:void 0}}return e.inherit!==!1?t:{}}function $7(e){const{initial:t,animate:r}=U7(e,C.useContext(P1));return C.useMemo(()=>({initial:t,animate:r}),[aC(t),aC(r)])}function aC(e){return Array.isArray(e)?e.join(" "):e}const Zm={};function W7(e){for(const t in e)Zm[t]=e[t],D2(t)&&(Zm[t].isCSSVariable=!0)}function L5(e,{layout:t,layoutId:r}){return _0.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!Zm[e]||e==="opacity")}const z7={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},H7=w0.length;function G7(e,t,r){let n="",s=!0;for(let a=0;a<H7;a++){const i=w0[a],l=e[i];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(i.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||r){const d=N5(l,G2[i]);if(!c){s=!1;const f=z7[i]||i;n+=`${f}(${d}) `}r&&(t[i]=d)}}return n=n.trim(),r?n=r(t,s?"":n):s&&(n="none"),n}function J2(e,t,r){const{style:n,vars:s,transformOrigin:a}=e;let i=!1,l=!1;for(const c in t){const d=t[c];if(_0.has(c)){i=!0;continue}else if(D2(c)){s[c]=d;continue}else{const f=N5(d,G2[c]);c.startsWith("origin")?(l=!0,a[c]=f):n[c]=f}}if(t.transform||(i||r?n.transform=G7(t,e.transform,r):n.transform&&(n.transform="none")),l){const{originX:c="50%",originY:d="50%",originZ:f=0}=a;n.transformOrigin=`${c} ${d} ${f}`}}const Q2=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function B5(e,t,r){for(const n in t)!za(t[n])&&!L5(n,r)&&(e[n]=t[n])}function V7({transformTemplate:e},t){return C.useMemo(()=>{const r=Q2();return J2(r,t,e),Object.assign({},r.vars,r.style)},[t])}function K7(e,t){const r=e.style||{},n={};return B5(n,r,e),Object.assign(n,V7(e,t)),n}function q7(e,t){const r={},n=K7(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const X7={offset:"stroke-dashoffset",array:"stroke-dasharray"},Y7={offset:"strokeDashoffset",array:"strokeDasharray"};function J7(e,t,r=1,n=0,s=!0){e.pathLength=1;const a=s?X7:Y7;e[a.offset]=Sr.transform(-n);const i=Sr.transform(t),l=Sr.transform(r);e[a.array]=`${i} ${l}`}function U5(e,{attrX:t,attrY:r,attrScale:n,pathLength:s,pathSpacing:a=1,pathOffset:i=0,...l},c,d,f){if(J2(e,l,d),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:p,style:g}=e;p.transform&&(g.transform=p.transform,delete p.transform),(g.transform||p.transformOrigin)&&(g.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),g.transform&&(g.transformBox=f?.transformBox??"fill-box",delete p.transformBox),t!==void 0&&(p.x=t),r!==void 0&&(p.y=r),n!==void 0&&(p.scale=n),s!==void 0&&J7(p,s,a,i,!1)}const $5=()=>({...Q2(),attrs:{}}),W5=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Q7(e,t,r,n){const s=C.useMemo(()=>{const a=$5();return U5(a,t,W5(n),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};B5(a,e.style,e),s.style={...a,...s.style}}return s}const Z7=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Z2(e){return typeof e!="string"||e.includes("-")?!1:!!(Z7.indexOf(e)>-1||/[A-Z]/u.test(e))}function e9(e,t,r,{latestValues:n},s,a=!1){const l=(Z2(e)?Q7:q7)(t,n,s,e),c=B7(t,typeof e=="string",a),d=e!==C.Fragment?{...c,...l,ref:r}:{},{children:f}=t,p=C.useMemo(()=>za(f)?f.get():f,[f]);return C.createElement(e,{...d,children:p})}function iC(e){const t=[{},{}];return e?.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function eb(e,t,r,n){if(typeof t=="function"){const[s,a]=iC(n);t=t(r!==void 0?r:e.custom,s,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,a]=iC(n);t=t(r!==void 0?r:e.custom,s,a)}return t}function Fy(e){return za(e)?e.get():e}function t9({scrapeMotionValuesFromProps:e,createRenderState:t},r,n,s){return{latestValues:r9(r,n,s,e),renderState:t()}}function r9(e,t,r,n){const s={},a=n(e,{});for(const g in a)s[g]=Fy(a[g]);let{initial:i,animate:l}=e;const c=D1(e),d=O5(e);t&&d&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),l===void 0&&(l=t.animate));let f=r?r.initial===!1:!1;f=f||i===!1;const p=f?l:i;if(p&&typeof p!="boolean"&&!R1(p)){const g=Array.isArray(p)?p:[p];for(let y=0;y<g.length;y++){const v=eb(e,g[y]);if(v){const{transitionEnd:_,transition:b,...N}=v;for(const k in N){let w=N[k];if(Array.isArray(w)){const T=f?w.length-1:0;w=w[T]}w!==null&&(s[k]=w)}for(const k in _)s[k]=_[k]}}}return s}const z5=e=>(t,r)=>{const n=C.useContext(P1),s=C.useContext(F1),a=()=>t9(e,t,n,s);return r?a():C2(a)};function tb(e,t,r){const{style:n}=e,s={};for(const a in n)(za(n[a])||t.style&&za(t.style[a])||L5(a,e)||r?.getValue(a)?.liveStyle!==void 0)&&(s[a]=n[a]);return s}const n9=z5({scrapeMotionValuesFromProps:tb,createRenderState:Q2});function H5(e,t,r){const n=tb(e,t,r);for(const s in e)if(za(e[s])||za(t[s])){const a=w0.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[a]=e[s]}return n}const s9=z5({scrapeMotionValuesFromProps:H5,createRenderState:$5}),a9=Symbol.for("motionComponentSymbol");function Uh(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function i9(e,t,r){return C.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):Uh(r)&&(r.current=n))},[t])}const rb=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),o9="framerAppearId",G5="data-"+rb(o9),V5=C.createContext({});function l9(e,t,r,n,s){const{visualElement:a}=C.useContext(P1),i=C.useContext(I5),l=C.useContext(F1),c=C.useContext(q2).reducedMotion,d=C.useRef(null);n=n||i.renderer,!d.current&&n&&(d.current=n(e,{visualState:t,parent:a,props:r,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:c}));const f=d.current,p=C.useContext(V5);f&&!f.projection&&s&&(f.type==="html"||f.type==="svg")&&c9(d.current,r,s,p);const g=C.useRef(!1);C.useInsertionEffect(()=>{f&&g.current&&f.update(r,l)});const y=r[G5],v=C.useRef(!!y&&!window.MotionHandoffIsComplete?.(y)&&window.MotionHasOptimisedAnimation?.(y));return z3(()=>{f&&(g.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),f.scheduleRenderMicrotask(),v.current&&f.animationState&&f.animationState.animateChanges())}),C.useEffect(()=>{f&&(!v.current&&f.animationState&&f.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(y)}),v.current=!1),f.enteringChildren=void 0)}),f}function c9(e,t,r,n){const{layoutId:s,layout:a,drag:i,dragConstraints:l,layoutScroll:c,layoutRoot:d,layoutCrossfade:f}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:K5(e.parent)),e.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!i||l&&Uh(l),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:f,layoutScroll:c,layoutRoot:d})}function K5(e){if(e)return e.options.allowProjection!==!1?e.projection:K5(e.parent)}function Qv(e,{forwardMotionProps:t=!1}={},r,n){r&&M7(r);const s=Z2(e)?s9:n9;function a(l,c){let d;const f={...C.useContext(q2),...l,layoutId:u9(l)},{isStatic:p}=f,g=$7(l),y=s(l,p);if(!p&&T2){d9();const v=f9(f);d=v.MeasureLayout,g.visualElement=l9(e,y,f,n,v.ProjectionNode)}return o.jsxs(P1.Provider,{value:g,children:[d&&g.visualElement?o.jsx(d,{visualElement:g.visualElement,...f}):null,e9(e,l,i9(y,g.visualElement,c),y,p,t)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const i=C.forwardRef(a);return i[a9]=e,i}function u9({layoutId:e}){const t=C.useContext(k2).id;return t&&e!==void 0?t+"-"+e:e}function d9(e,t){C.useContext(I5).strict}function f9(e){const{drag:t,layout:r}=o0;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t?.isEnabled(e)||r?.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function h9(e,t){if(typeof Proxy>"u")return Qv;const r=new Map,n=(a,i)=>Qv(a,i,e,t),s=(a,i)=>n(a,i);return new Proxy(s,{get:(a,i)=>i==="create"?n:(r.has(i)||r.set(i,Qv(i,void 0,e,t)),r.get(i))})}function q5({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function g9({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function m9(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function Zv(e){return e===void 0||e===1}function p_({scale:e,scaleX:t,scaleY:r}){return!Zv(e)||!Zv(t)||!Zv(r)}function Id(e){return p_(e)||X5(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function X5(e){return oC(e.x)||oC(e.y)}function oC(e){return e&&e!=="0%"}function Gy(e,t,r){const n=e-r,s=t*n;return r+s}function lC(e,t,r,n,s){return s!==void 0&&(e=Gy(e,s,n)),Gy(e,r,n)+t}function x_(e,t=0,r=1,n,s){e.min=lC(e.min,t,r,n,s),e.max=lC(e.max,t,r,n,s)}function Y5(e,{x:t,y:r}){x_(e.x,t.translate,t.scale,t.originPoint),x_(e.y,r.translate,r.scale,r.originPoint)}const cC=.999999999999,uC=1.0000000000001;function p9(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let a,i;for(let l=0;l<s;l++){a=r[l],i=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Wh(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,Y5(e,i)),n&&Id(a.latestValues)&&Wh(e,a.latestValues))}t.x<uC&&t.x>cC&&(t.x=1),t.y<uC&&t.y>cC&&(t.y=1)}function $h(e,t){e.min=e.min+t,e.max=e.max+t}function dC(e,t,r,n,s=.5){const a=Zn(e.min,e.max,s);x_(e,t,r,a,n)}function Wh(e,t){dC(e.x,t.x,t.scaleX,t.scale,t.originX),dC(e.y,t.y,t.scaleY,t.scale,t.originY)}function J5(e,t){return q5(m9(e.getBoundingClientRect(),t))}function x9(e,t,r){const n=J5(e,r),{scroll:s}=t;return s&&($h(n.x,s.offset.x),$h(n.y,s.offset.y)),n}const fC=()=>({translate:0,scale:1,origin:0,originPoint:0}),zh=()=>({x:fC(),y:fC()}),hC=()=>({min:0,max:0}),ks=()=>({x:hC(),y:hC()}),y_={current:null},Q5={current:!1};function y9(){if(Q5.current=!0,!!T2)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>y_.current=e.matches;e.addEventListener("change",t),t()}else y_.current=!1}const v9=new WeakMap;function w9(e,t,r){for(const n in t){const s=t[n],a=r[n];if(za(s))e.addValue(n,s);else if(za(a))e.addValue(n,i0(s,{owner:e}));else if(a!==s)if(e.hasValue(n)){const i=e.getValue(n);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=e.getStaticValue(n);e.addValue(n,i0(i!==void 0?i:s,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const gC=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class _9{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:a,visualState:i},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=z2,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=Ni.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,Kn.render(this.render,!1,!0))};const{latestValues:c,renderState:d}=i;this.latestValues=c,this.baseTarget={...c},this.initialValues=r.initial?{...c}:{},this.renderState=d,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=l,this.blockInitialAnimation=!!a,this.isControllingVariants=D1(r),this.isVariantNode=O5(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:f,...p}=this.scrapeMotionValuesFromProps(r,{},this);for(const g in p){const y=p[g];c[g]!==void 0&&za(y)&&y.set(c[g])}}mount(t){this.current=t,v9.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),Q5.current||y9(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:y_.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Lu(this.notifyUpdate),Lu(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=_0.has(t);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&Kn.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{s(),a&&a(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in o0){const r=o0[t];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[t]&&s&&n(this.props)&&(this.features[t]=new s(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ks()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<gC.length;n++){const s=gC[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a="on"+s,i=t[a];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=w9(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=i0(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){let n=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return n!=null&&(typeof n=="string"&&(H3(n)||V3(n))?n=parseFloat(n):!F7(n)&&Bu.test(r)&&(n=E5(t,r)),this.setBaseTarget(t,za(n)?n.get():n)),za(n)?n.get():n}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const a=eb(this.props,r,this.presenceContext?.custom);a&&(n=a[t])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!za(s)?s:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new F2),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){V2.render(this.render)}}class Z5 extends _9{constructor(){super(...arguments),this.KeyframeResolver=v7}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;za(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function e6(e,{style:t,vars:r},n,s){const a=e.style;let i;for(i in t)a[i]=t[i];s?.applyProjectionStyles(a,n);for(i in r)a.setProperty(i,r[i])}function b9(e){return window.getComputedStyle(e)}class S9 extends Z5{constructor(){super(...arguments),this.type="html",this.renderInstance=e6}readValueFromInstance(t,r){if(_0.has(r))return this.projection?.isProjecting?c_(r):LD(t,r);{const n=b9(t),s=(D2(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return J5(t,r)}build(t,r,n){J2(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return tb(t,r,n)}}const t6=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function k9(e,t,r,n){e6(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(t6.has(s)?s:rb(s),t.attrs[s])}class C9 extends Z5{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ks}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(_0.has(r)){const n=T5(r);return n&&n.default||0}return r=t6.has(r)?r:rb(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return H5(t,r,n)}build(t,r,n){U5(t,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(t,r,n,s){k9(t,r,n,s)}mount(t){this.isSVGTag=W5(t.tagName),super.mount(t)}}const T9=(e,t)=>Z2(e)?new C9(t):new S9(t,{allowProjection:e!==C.Fragment});function qh(e,t,r){const n=e.getProps();return eb(n,t,r!==void 0?r:n.custom,e)}const v_=e=>Array.isArray(e);function E9(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,i0(r))}function N9(e){return v_(e)?e[e.length-1]||0:e}function A9(e,t){const r=qh(e,t);let{transitionEnd:n={},transition:s={},...a}=r||{};a={...a,...n};for(const i in a){const l=N9(a[i]);E9(e,i,l)}}function j9(e){return!!(za(e)&&e.add)}function w_(e,t){const r=e.getValue("willChange");if(j9(r))return r.add(t);if(!r&&Ac.WillChange){const n=new Ac.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function r6(e){return e.props[G5]}const F9=e=>e!==null;function P9(e,{repeat:t,repeatType:r="loop"},n){const s=e.filter(F9),a=t&&r!=="loop"&&t%2===1?0:s.length-1;return s[a]}const R9={type:"spring",stiffness:500,damping:25,restSpeed:10},D9=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),I9={type:"keyframes",duration:.8},M9={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},O9=(e,{keyframes:t})=>t.length>2?I9:_0.has(e)?e.startsWith("scale")?D9(t[1]):R9:M9;function L9({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:i,repeatDelay:l,from:c,elapsed:d,...f}){return!!Object.keys(f).length}const nb=(e,t,r,n={},s,a)=>i=>{const l=H2(n,e)||{},c=l.delay||n.delay||0;let{elapsed:d=0}=n;d=d-Rl(c);const f={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...l,delay:-d,onUpdate:g=>{t.set(g),l.onUpdate&&l.onUpdate(g)},onComplete:()=>{i(),l.onComplete&&l.onComplete()},name:e,motionValue:t,element:a?void 0:s};L9(l)||Object.assign(f,O9(e,f)),f.duration&&(f.duration=Rl(f.duration)),f.repeatDelay&&(f.repeatDelay=Rl(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let p=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(g_(f),f.delay===0&&(p=!0)),(Ac.instantAnimations||Ac.skipAnimations)&&(p=!0,g_(f),f.delay=0),f.allowFlatten=!l.type&&!l.ease,p&&!a&&t.get()!==void 0){const g=P9(f.keyframes,l);if(g!==void 0){Kn.update(()=>{f.onUpdate(g),f.onComplete()});return}}return l.isSync?new W2(f):new o7(f)};function B9({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function n6(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:i,...l}=t;n&&(a=n);const c=[],d=s&&e.animationState&&e.animationState.getState()[s];for(const f in l){const p=e.getValue(f,e.latestValues[f]??null),g=l[f];if(g===void 0||d&&B9(d,f))continue;const y={delay:r,...H2(a||{},f)},v=p.get();if(v!==void 0&&!p.isAnimating&&!Array.isArray(g)&&g===v&&!y.velocity)continue;let _=!1;if(window.MotionHandoffAnimation){const N=r6(e);if(N){const k=window.MotionHandoffAnimation(N,f,Kn);k!==null&&(y.startTime=k,_=!0)}}w_(e,f),p.start(nb(f,p,g,e.shouldReduceMotion&&S5.has(f)?{type:!1}:y,e,_));const b=p.animation;b&&c.push(b)}return i&&Promise.all(c).then(()=>{Kn.update(()=>{i&&A9(e,i)})}),c}function s6(e,t,r,n=0,s=1){const a=Array.from(e).sort((d,f)=>d.sortNodePosition(f)).indexOf(t),i=e.size,l=(i-1)*n;return typeof r=="function"?r(a,i):s===1?a*n:l-a*n}function __(e,t,r={}){const n=qh(e,t,r.type==="exit"?e.presenceContext?.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const a=n?()=>Promise.all(n6(e,n,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:p}=s;return U9(e,t,c,d,f,p,r)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,d]=l==="beforeChildren"?[a,i]:[i,a];return c().then(()=>d())}else return Promise.all([a(),i(r.delay)])}function U9(e,t,r=0,n=0,s=0,a=1,i){const l=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),l.push(__(c,t,{...i,delay:r+(typeof n=="function"?0:n)+s6(e.variantChildren,c,n,s,a)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(l)}function $9(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(a=>__(e,a,r));n=Promise.all(s)}else if(typeof t=="string")n=__(e,t,r);else{const s=typeof t=="function"?qh(e,t,r.custom):t;n=Promise.all(n6(e,s,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function a6(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const W9=Y2.length;function i6(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?i6(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<W9;r++){const n=Y2[r],s=e.props[n];(Qm(s)||s===!1)&&(t[n]=s)}return t}const z9=[...X2].reverse(),H9=X2.length;function G9(e){return t=>Promise.all(t.map(({animation:r,options:n})=>$9(e,r,n)))}function V9(e){let t=G9(e),r=mC(),n=!0;const s=c=>(d,f)=>{const p=qh(e,f,c==="exit"?e.presenceContext?.custom:void 0);if(p){const{transition:g,transitionEnd:y,...v}=p;d={...d,...v,...y}}return d};function a(c){t=c(e)}function i(c){const{props:d}=e,f=i6(e.parent)||{},p=[],g=new Set;let y={},v=1/0;for(let b=0;b<H9;b++){const N=z9[b],k=r[N],w=d[N]!==void 0?d[N]:f[N],T=Qm(w),A=N===c?k.isActive:null;A===!1&&(v=b);let F=w===f[N]&&w!==d[N]&&T;if(F&&n&&e.manuallyAnimateOnMount&&(F=!1),k.protectedKeys={...y},!k.isActive&&A===null||!w&&!k.prevProp||R1(w)||typeof w=="boolean")continue;const R=K9(k.prevProp,w);let E=R||N===c&&k.isActive&&!F&&T||b>v&&T,D=!1;const I=Array.isArray(w)?w:[w];let G=I.reduce(s(N),{});A===!1&&(G={});const{prevResolvedValues:Y={}}=k,ee={...Y,...G},ie=B=>{E=!0,g.has(B)&&(D=!0,g.delete(B)),k.needsAnimating[B]=!0;const z=e.getValue(B);z&&(z.liveStyle=!1)};for(const B in ee){const z=G[B],U=Y[B];if(y.hasOwnProperty(B))continue;let V=!1;v_(z)&&v_(U)?V=!a6(z,U):V=z!==U,V?z!=null?ie(B):g.add(B):z!==void 0&&g.has(B)?ie(B):k.protectedKeys[B]=!0}k.prevProp=w,k.prevResolvedValues=G,k.isActive&&(y={...y,...G}),n&&e.blockInitialAnimation&&(E=!1);const re=F&&R;E&&(!re||D)&&p.push(...I.map(B=>{const z={type:N};if(typeof B=="string"&&n&&!re&&e.manuallyAnimateOnMount&&e.parent){const{parent:U}=e,V=qh(U,B);if(U.enteringChildren&&V){const{delayChildren:q}=V.transition||{};z.delay=s6(U.enteringChildren,e,q)}}return{animation:B,options:z}}))}if(g.size){const b={};if(typeof d.initial!="boolean"){const N=qh(e,Array.isArray(d.initial)?d.initial[0]:d.initial);N&&N.transition&&(b.transition=N.transition)}g.forEach(N=>{const k=e.getBaseTarget(N),w=e.getValue(N);w&&(w.liveStyle=!0),b[N]=k??null}),p.push({animation:b})}let _=!!p.length;return n&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(_=!1),n=!1,_?t(p):Promise.resolve()}function l(c,d){if(r[c].isActive===d)return Promise.resolve();e.variantChildren?.forEach(p=>p.animationState?.setActive(c,d)),r[c].isActive=d;const f=i(c);for(const p in r)r[p].protectedKeys={};return f}return{animateChanges:i,setActive:l,setAnimateFunction:a,getState:()=>r,reset:()=>{r=mC(),n=!0}}}function K9(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!a6(t,e):!1}function Fd(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function mC(){return{animate:Fd(!0),whileInView:Fd(),whileHover:Fd(),whileTap:Fd(),whileDrag:Fd(),whileFocus:Fd(),exit:Fd()}}class Ku{constructor(t){this.isMounted=!1,this.node=t}update(){}}class q9 extends Ku{constructor(t){super(t),t.animationState||(t.animationState=V9(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();R1(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let X9=0;class Y9 extends Ku{constructor(){super(...arguments),this.id=X9++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const s=this.node.animationState.setActive("exit",!t);r&&!t&&s.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const J9={animation:{Feature:q9},exit:{Feature:Y9}};function ep(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function Fp(e){return{point:{x:e.pageX,y:e.pageY}}}const Q9=e=>t=>K2(t)&&e(t,Fp(t));function Fm(e,t,r,n){return ep(e,t,Q9(r),n)}const o6=1e-4,Z9=1-o6,eI=1+o6,l6=.01,tI=0-l6,rI=0+l6;function di(e){return e.max-e.min}function nI(e,t,r){return Math.abs(e-t)<=r}function pC(e,t,r,n=.5){e.origin=n,e.originPoint=Zn(t.min,t.max,e.origin),e.scale=di(r)/di(t),e.translate=Zn(r.min,r.max,e.origin)-e.originPoint,(e.scale>=Z9&&e.scale<=eI||isNaN(e.scale))&&(e.scale=1),(e.translate>=tI&&e.translate<=rI||isNaN(e.translate))&&(e.translate=0)}function Pm(e,t,r,n){pC(e.x,t.x,r.x,n?n.originX:void 0),pC(e.y,t.y,r.y,n?n.originY:void 0)}function xC(e,t,r){e.min=r.min+t.min,e.max=e.min+di(t)}function sI(e,t,r){xC(e.x,t.x,r.x),xC(e.y,t.y,r.y)}function yC(e,t,r){e.min=t.min-r.min,e.max=e.min+di(t)}function Rm(e,t,r){yC(e.x,t.x,r.x),yC(e.y,t.y,r.y)}function po(e){return[e("x"),e("y")]}const c6=({current:e})=>e?e.ownerDocument.defaultView:null,vC=(e,t)=>Math.abs(e-t);function aI(e,t){const r=vC(e.x,t.x),n=vC(e.y,t.y);return Math.sqrt(r**2+n**2)}class u6{constructor(t,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=tw(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,v=aI(g.offset,{x:0,y:0})>=this.distanceThreshold;if(!y&&!v)return;const{point:_}=g,{timestamp:b}=ba;this.history.push({..._,timestamp:b});const{onStart:N,onMove:k}=this.handlers;y||(N&&N(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),k&&k(this.lastMoveEvent,g)},this.handlePointerMove=(g,y)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=ew(y,this.transformPagePoint),Kn.update(this.updatePoint,!0)},this.handlePointerUp=(g,y)=>{this.end();const{onEnd:v,onSessionEnd:_,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const N=tw(g.type==="pointercancel"?this.lastMoveEventInfo:ew(y,this.transformPagePoint),this.history);this.startEvent&&v&&v(g,N),_&&_(g,N)},!K2(t))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=s||window;const l=Fp(t),c=ew(l,this.transformPagePoint),{point:d}=c,{timestamp:f}=ba;this.history=[{...d,timestamp:f}];const{onSessionStart:p}=r;p&&p(t,tw(c,this.history)),this.removeListeners=Np(Fm(this.contextWindow,"pointermove",this.handlePointerMove),Fm(this.contextWindow,"pointerup",this.handlePointerUp),Fm(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Lu(this.updatePoint)}}function ew(e,t){return t?{point:t(e.point)}:e}function wC(e,t){return{x:e.x-t.x,y:e.y-t.y}}function tw({point:e},t){return{point:e,delta:wC(e,d6(t)),offset:wC(e,iI(t)),velocity:oI(t,.1)}}function iI(e){return e[0]}function d6(e){return e[e.length-1]}function oI(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=d6(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>Rl(t)));)r--;if(!n)return{x:0,y:0};const a=Dl(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const i={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function lI(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?Zn(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?Zn(r,e,n.max):Math.min(e,r)),e}function _C(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function cI(e,{top:t,left:r,bottom:n,right:s}){return{x:_C(e.x,r,s),y:_C(e.y,t,n)}}function bC(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function uI(e,t){return{x:bC(e.x,t.x),y:bC(e.y,t.y)}}function dI(e,t){let r=.5;const n=di(e),s=di(t);return s>n?r=Xm(t.min,t.max-n,e.min):n>s&&(r=Xm(e.min,e.max-s,t.min)),Nc(0,1,r)}function fI(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const b_=.35;function hI(e=b_){return e===!1?e=0:e===!0&&(e=b_),{x:SC(e,"left","right"),y:SC(e,"top","bottom")}}function SC(e,t,r){return{min:kC(e,t),max:kC(e,r)}}function kC(e,t){return typeof e=="number"?e:e[t]||0}const gI=new WeakMap;class mI{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ks(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const a=p=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Fp(p).point)},i=(p,g)=>{const{drag:y,dragPropagation:v,onDragStart:_}=this.getProps();if(y&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=S7(y),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=g,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),po(N=>{let k=this.getAxisMotionValue(N).get()||0;if(Il.test(k)){const{projection:w}=this.visualElement;if(w&&w.layout){const T=w.layout.layoutBox[N];T&&(k=di(T)*(parseFloat(k)/100))}}this.originPoint[N]=k}),_&&Kn.postRender(()=>_(p,g)),w_(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},l=(p,g)=>{this.latestPointerEvent=p,this.latestPanInfo=g;const{dragPropagation:y,dragDirectionLock:v,onDirectionLock:_,onDrag:b}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:N}=g;if(v&&this.currentDirection===null){this.currentDirection=pI(N),this.currentDirection!==null&&_&&_(this.currentDirection);return}this.updateAxis("x",g.point,N),this.updateAxis("y",g.point,N),this.visualElement.render(),b&&b(p,g)},c=(p,g)=>{this.latestPointerEvent=p,this.latestPanInfo=g,this.stop(p,g),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>po(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:f}=this.getProps();this.panSession=new u6(t,{onSessionStart:a,onStart:i,onMove:l,onSessionEnd:c,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:f,distanceThreshold:n,contextWindow:c6(this.visualElement)})}stop(t,r){const n=t||this.latestPointerEvent,s=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!s||!n)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:l}=this.getProps();l&&Kn.postRender(()=>l(n,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!ay(t,s,this.currentDirection))return;const a=this.getAxisMotionValue(t);let i=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(i=lI(i,this.constraints[t],this.elastic[t])),a.set(i)}resolveConstraints(){const{dragConstraints:t,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;t&&Uh(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=cI(n.layoutBox,t):this.constraints=!1,this.elastic=hI(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&po(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=fI(n.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Uh(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=x9(n,s.root,this.visualElement.getTransformPagePoint());let i=uI(s.layout.layoutBox,a);if(r){const l=r(g9(i));this.hasMutatedConstraints=!!l,l&&(i=q5(l))}return i}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=po(f=>{if(!ay(f,r,this.currentDirection))return;let p=c&&c[f]||{};i&&(p={min:0,max:0});const g=s?200:1e6,y=s?40:1e7,v={type:"inertia",velocity:n?t[f]:0,bounceStiffness:g,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(f,v)});return Promise.all(d).then(l)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return w_(this.visualElement,t),n.start(nb(t,n,0,r,this.visualElement,!1))}stopAnimation(){po(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){po(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){po(r=>{const{drag:n}=this.getProps();if(!ay(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:i,max:l}=s.layout.layoutBox[r];a.set(t[r]-Zn(i,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Uh(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};po(i=>{const l=this.getAxisMotionValue(i);if(l&&this.constraints!==!1){const c=l.get();s[i]=dI({min:c,max:c},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),po(i=>{if(!ay(i,t,null))return;const l=this.getAxisMotionValue(i),{min:c,max:d}=this.constraints[i];l.set(Zn(c,d,s[i]))})}addListeners(){if(!this.visualElement.current)return;gI.set(this.visualElement,this);const t=this.visualElement.current,r=Fm(t,"pointerdown",c=>{const{drag:d,dragListener:f=!0}=this.getProps();d&&f&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();Uh(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Kn.read(n);const i=ep(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(po(f=>{const p=this.getAxisMotionValue(f);p&&(this.originPoint[f]+=c[f].translate,p.set(p.get()+c[f].translate))}),this.visualElement.render())}));return()=>{i(),r(),a(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:i=b_,dragMomentum:l=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:i,dragMomentum:l}}}function ay(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function pI(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class xI extends Ku{constructor(t){super(t),this.removeGroupControls=_o,this.removeListeners=_o,this.controls=new mI(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||_o}unmount(){this.removeGroupControls(),this.removeListeners()}}const CC=e=>(t,r)=>{e&&Kn.postRender(()=>e(t,r))};class yI extends Ku{constructor(){super(...arguments),this.removePointerDownListener=_o}onPointerDown(t){this.session=new u6(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:c6(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:CC(t),onStart:CC(r),onMove:n,onEnd:(a,i)=>{delete this.session,s&&Kn.postRender(()=>s(a,i))}}}mount(){this.removePointerDownListener=Fm(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Py={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function TC(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Eg={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Sr.test(e))e=parseFloat(e);else return e;const r=TC(e,t.target.x),n=TC(e,t.target.y);return`${r}% ${n}%`}},vI={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=Bu.parse(e);if(s.length>5)return n;const a=Bu.createTransformer(e),i=typeof s[0]!="number"?1:0,l=r.x.scale*t.x,c=r.y.scale*t.y;s[0+i]/=l,s[1+i]/=c;const d=Zn(l,c,.5);return typeof s[2+i]=="number"&&(s[2+i]/=d),typeof s[3+i]=="number"&&(s[3+i]/=d),a(s)}};let rw=!1;class wI extends C.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=t;W7(_I),a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),rw&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),Py.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,{projection:i}=n;return i&&(i.isPresent=a,rw=!0,s||t.layoutDependency!==r||r===void 0||t.isPresent!==a?i.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?i.promote():i.relegate()||Kn.postRender(()=>{const l=i.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),V2.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;rw=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function f6(e){const[t,r]=D5(),n=C.useContext(k2);return o.jsx(wI,{...e,layoutGroup:n,switchLayoutGroup:C.useContext(V5),isPresent:t,safeToRemove:r})}const _I={borderRadius:{...Eg,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Eg,borderTopRightRadius:Eg,borderBottomLeftRadius:Eg,borderBottomRightRadius:Eg,boxShadow:vI};function bI(e,t,r){const n=za(e)?e:i0(e);return n.start(nb("",n,t,r)),n.animation}const SI=(e,t)=>e.depth-t.depth;class kI{constructor(){this.children=[],this.isDirty=!1}add(t){E2(this.children,t),this.isDirty=!0}remove(t){N2(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(SI),this.isDirty=!1,this.children.forEach(t)}}function CI(e,t){const r=Ni.now(),n=({timestamp:s})=>{const a=s-r;a>=t&&(Lu(n),e(a-t))};return Kn.setup(n,!0),()=>Lu(n)}const h6=["TopLeft","TopRight","BottomLeft","BottomRight"],TI=h6.length,EC=e=>typeof e=="string"?parseFloat(e):e,NC=e=>typeof e=="number"||Sr.test(e);function EI(e,t,r,n,s,a){s?(e.opacity=Zn(0,r.opacity??1,NI(n)),e.opacityExit=Zn(t.opacity??1,0,AI(n))):a&&(e.opacity=Zn(t.opacity??1,r.opacity??1,n));for(let i=0;i<TI;i++){const l=`border${h6[i]}Radius`;let c=AC(t,l),d=AC(r,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||NC(c)===NC(d)?(e[l]=Math.max(Zn(EC(c),EC(d),n),0),(Il.test(d)||Il.test(c))&&(e[l]+="%")):e[l]=d}(t.rotate||r.rotate)&&(e.rotate=Zn(t.rotate||0,r.rotate||0,n))}function AC(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const NI=g6(0,.5,e5),AI=g6(.5,.95,_o);function g6(e,t,r){return n=>n<e?0:n>t?1:r(Xm(e,t,n))}function jC(e,t){e.min=t.min,e.max=t.max}function co(e,t){jC(e.x,t.x),jC(e.y,t.y)}function FC(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function PC(e,t,r,n,s){return e-=t,e=Gy(e,1/r,n),s!==void 0&&(e=Gy(e,1/s,n)),e}function jI(e,t=0,r=1,n=.5,s,a=e,i=e){if(Il.test(t)&&(t=parseFloat(t),t=Zn(i.min,i.max,t/100)-i.min),typeof t!="number")return;let l=Zn(a.min,a.max,n);e===a&&(l-=t),e.min=PC(e.min,t,r,l,s),e.max=PC(e.max,t,r,l,s)}function RC(e,t,[r,n,s],a,i){jI(e,t[r],t[n],t[s],t.scale,a,i)}const FI=["x","scaleX","originX"],PI=["y","scaleY","originY"];function DC(e,t,r,n){RC(e.x,t,FI,r?r.x:void 0,n?n.x:void 0),RC(e.y,t,PI,r?r.y:void 0,n?n.y:void 0)}function IC(e){return e.translate===0&&e.scale===1}function m6(e){return IC(e.x)&&IC(e.y)}function MC(e,t){return e.min===t.min&&e.max===t.max}function RI(e,t){return MC(e.x,t.x)&&MC(e.y,t.y)}function OC(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function p6(e,t){return OC(e.x,t.x)&&OC(e.y,t.y)}function LC(e){return di(e.x)/di(e.y)}function BC(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class DI{constructor(){this.members=[]}add(t){E2(this.members,t),t.scheduleRender()}remove(t){if(N2(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function II(e,t,r){let n="";const s=e.x.translate/t.x,a=e.y.translate/t.y,i=r?.z||0;if((s||a||i)&&(n=`translate3d(${s}px, ${a}px, ${i}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:d,rotate:f,rotateX:p,rotateY:g,skewX:y,skewY:v}=r;d&&(n=`perspective(${d}px) ${n}`),f&&(n+=`rotate(${f}deg) `),p&&(n+=`rotateX(${p}deg) `),g&&(n+=`rotateY(${g}deg) `),y&&(n+=`skewX(${y}deg) `),v&&(n+=`skewY(${v}deg) `)}const l=e.x.scale*t.x,c=e.y.scale*t.y;return(l!==1||c!==1)&&(n+=`scale(${l}, ${c})`),n||"none"}const nw=["","X","Y","Z"],MI=1e3;let OI=0;function sw(e,t,r,n){const{latestValues:s}=t;s[e]&&(r[e]=s[e],t.setStaticValue(e,0),n&&(n[e]=0))}function x6(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=r6(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Kn,!(s||a))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&x6(n)}function y6({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(i={},l=t?.()){this.id=OI++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(UI),this.nodes.forEach(HI),this.nodes.forEach(GI),this.nodes.forEach($I)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new kI)}addEventListener(i,l){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new F2),this.eventHandlers.get(i).add(l)}notifyListeners(i,...l){const c=this.eventHandlers.get(i);c&&c.notify(...l)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=R5(i)&&!A7(i),this.instance=i;const{layoutId:l,layout:c,visualElement:d}=this.options;if(d&&!d.current&&d.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||l)&&(this.isLayoutDirty=!0),e){let f,p=0;const g=()=>this.root.updateBlockedByResize=!1;Kn.read(()=>{p=window.innerWidth}),e(i,()=>{const y=window.innerWidth;y!==p&&(p=y,this.root.updateBlockedByResize=!0,f&&f(),f=CI(g,250),Py.hasAnimatedSinceResize&&(Py.hasAnimatedSinceResize=!1,this.nodes.forEach(WC)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&d&&(l||c)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:p,hasRelativeLayoutChanged:g,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||d.getDefaultTransition()||YI,{onLayoutAnimationStart:_,onLayoutAnimationComplete:b}=d.getProps(),N=!this.targetLayout||!p6(this.targetLayout,y),k=!p&&g;if(this.options.layoutRoot||this.resumeFrom||k||p&&(N||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const w={...H2(v,"layout"),onPlay:_,onComplete:b};(d.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w),this.setAnimationOrigin(f,k)}else p||WC(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Lu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(VI),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&x6(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const p=this.path[f];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(UC);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach($C);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(zI),this.nodes.forEach(LI),this.nodes.forEach(BI)):this.nodes.forEach($C),this.clearAllSnapshots();const l=Ni.now();ba.delta=Nc(0,1e3/60,l-ba.timestamp),ba.timestamp=l,ba.isProcessing=!0,Vv.update.process(ba),Vv.preRender.process(ba),Vv.render.process(ba),ba.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,V2.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(WI),this.sharedNodes.forEach(KI)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Kn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Kn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!di(this.snapshot.measuredBox.x)&&!di(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ks(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(l=!1),l&&this.instance){const c=n(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!m6(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,f=d!==this.prevTransformTemplateValue;i&&this.instance&&(l||Id(this.latestValues)||f)&&(s(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return i&&(c=this.removeTransform(c)),JI(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:i}=this.options;if(!i)return ks();const l=i.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(QI))){const{scroll:d}=this.root;d&&($h(l.x,d.offset.x),$h(l.y,d.offset.y))}return l}removeElementScroll(i){const l=ks();if(co(l,i),this.scroll?.wasRoot)return l;for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:f,options:p}=d;d!==this.root&&f&&p.layoutScroll&&(f.wasRoot&&co(l,i),$h(l.x,f.offset.x),$h(l.y,f.offset.y))}return l}applyTransform(i,l=!1){const c=ks();co(c,i);for(let d=0;d<this.path.length;d++){const f=this.path[d];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Wh(c,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Id(f.latestValues)&&Wh(c,f.latestValues)}return Id(this.latestValues)&&Wh(c,this.latestValues),c}removeTransform(i){const l=ks();co(l,i);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!Id(d.latestValues))continue;p_(d.latestValues)&&d.updateSnapshot();const f=ks(),p=d.measurePageBox();co(f,p),DC(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,f)}return Id(this.latestValues)&&DC(l,this.latestValues),l}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ba.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(i||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:p}=this.options;if(!(!this.layout||!(f||p))){if(this.resolvedRelativeTargetAt=ba.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ks(),this.relativeTargetOrigin=ks(),Rm(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),co(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ks(),this.targetWithTransforms=ks()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),sI(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):co(this.target,this.layout.layoutBox),Y5(this.target,this.targetDelta)):co(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ks(),this.relativeTargetOrigin=ks(),Rm(this.relativeTargetOrigin,this.target,g.target),co(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||p_(this.parent.latestValues)||X5(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const i=this.getLead(),l=!!this.resumingFrom||this!==i;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===ba.timestamp&&(c=!1),c)return;const{layout:d,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||f))return;co(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,g=this.treeScale.y;p9(this.layoutCorrected,this.treeScale,this.path,l),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=ks());const{target:y}=i;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(FC(this.prevProjectionDelta.x,this.projectionDelta.x),FC(this.prevProjectionDelta.y,this.projectionDelta.y)),Pm(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==g||!BC(this.projectionDelta.x,this.prevProjectionDelta.x)||!BC(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){if(this.options.visualElement?.scheduleRender(),i){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=zh(),this.projectionDelta=zh(),this.projectionDeltaWithTransform=zh()}setAnimationOrigin(i,l=!1){const c=this.snapshot,d=c?c.latestValues:{},f={...this.latestValues},p=zh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const g=ks(),y=c?c.source:void 0,v=this.layout?this.layout.source:void 0,_=y!==v,b=this.getStack(),N=!b||b.members.length<=1,k=!!(_&&!N&&this.options.crossfade===!0&&!this.path.some(XI));this.animationProgress=0;let w;this.mixTargetDelta=T=>{const A=T/1e3;zC(p.x,i.x,A),zC(p.y,i.y,A),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Rm(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),qI(this.relativeTarget,this.relativeTargetOrigin,g,A),w&&RI(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=ks()),co(w,this.relativeTarget)),_&&(this.animationValues=f,EI(f,d,this.latestValues,A,k,N)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=A},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Lu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Kn.update(()=>{Py.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=i0(0)),this.currentAnimation=bI(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:l=>{this.mixTargetDelta(l),i.onUpdate&&i.onUpdate(l)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(MI),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:f}=i;if(!(!l||!c||!d)){if(this!==i&&this.layout&&d&&v6(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||ks();const p=di(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+p;const g=di(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+g}co(l,c),Wh(l,f),Pm(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(i,l){this.sharedNodes.has(i)||this.sharedNodes.set(i,new DI),this.sharedNodes.get(i).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){const{layoutId:i}=this.options;return i?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:i}=this.options;return i?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let l=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const d={};c.z&&sw("z",i,d,this.animationValues);for(let f=0;f<nw.length;f++)sw(`rotate${nw[f]}`,i,d,this.animationValues),sw(`skew${nw[f]}`,i,d,this.animationValues);i.render();for(const f in d)i.setStaticValue(f,d[f]),this.animationValues&&(this.animationValues[f]=d[f]);i.scheduleRender()}applyProjectionStyles(i,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=Fy(l?.pointerEvents)||"",i.transform=c?c(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=Fy(l?.pointerEvents)||""),this.hasProjected&&!Id(this.latestValues)&&(i.transform=c?c({},""):"none",this.hasProjected=!1);return}i.visibility="";const f=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=II(this.projectionDeltaWithTransform,this.treeScale,f);c&&(p=c(f,p)),i.transform=p;const{x:g,y}=this.projectionDelta;i.transformOrigin=`${g.origin*100}% ${y.origin*100}% 0`,d.animationValues?i.opacity=d===this?f.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:i.opacity=d===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const v in Zm){if(f[v]===void 0)continue;const{correct:_,applyTo:b,isCSSVariable:N}=Zm[v],k=p==="none"?f[v]:_(f[v],d);if(b){const w=b.length;for(let T=0;T<w;T++)i[b[T]]=k}else N?this.options.visualElement.renderState.vars[v]=k:i[v]=k}this.options.layoutId&&(i.pointerEvents=d===this?Fy(l?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>i.currentAnimation?.stop()),this.root.nodes.forEach(UC),this.root.sharedNodes.clear()}}}function LI(e){e.updateLayout()}function BI(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:n}=e.layout,{animationType:s}=e.options,a=t.source!==e.layout.source;s==="size"?po(f=>{const p=a?t.measuredBox[f]:t.layoutBox[f],g=di(p);p.min=r[f].min,p.max=p.min+g}):v6(s,t.layoutBox,r)&&po(f=>{const p=a?t.measuredBox[f]:t.layoutBox[f],g=di(r[f]);p.max=p.min+g,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+g)});const i=zh();Pm(i,r,t.layoutBox);const l=zh();a?Pm(l,e.applyTransform(n,!0),t.measuredBox):Pm(l,r,t.layoutBox);const c=!m6(i);let d=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:p,layout:g}=f;if(p&&g){const y=ks();Rm(y,t.layoutBox,p.layoutBox);const v=ks();Rm(v,r,g.layoutBox),p6(y,v)||(d=!0),f.options.layoutRoot&&(e.relativeTarget=v,e.relativeTargetOrigin=y,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:i,hasLayoutChanged:c,hasRelativeLayoutChanged:d})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function UI(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function $I(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function WI(e){e.clearSnapshot()}function UC(e){e.clearMeasurements()}function $C(e){e.isLayoutDirty=!1}function zI(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function WC(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function HI(e){e.resolveTargetDelta()}function GI(e){e.calcProjection()}function VI(e){e.resetSkewAndRotation()}function KI(e){e.removeLeadSnapshot()}function zC(e,t,r){e.translate=Zn(t.translate,0,r),e.scale=Zn(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function HC(e,t,r,n){e.min=Zn(t.min,r.min,n),e.max=Zn(t.max,r.max,n)}function qI(e,t,r,n){HC(e.x,t.x,r.x,n),HC(e.y,t.y,r.y,n)}function XI(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const YI={duration:.45,ease:[.4,0,.1,1]},GC=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),VC=GC("applewebkit/")&&!GC("chrome/")?Math.round:_o;function KC(e){e.min=VC(e.min),e.max=VC(e.max)}function JI(e){KC(e.x),KC(e.y)}function v6(e,t,r){return e==="position"||e==="preserve-aspect"&&!nI(LC(t),LC(r),.2)}function QI(e){return e!==e.root&&e.scroll?.wasRoot}const ZI=y6({attachResizeListener:(e,t)=>ep(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),aw={current:void 0},w6=y6({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!aw.current){const e=new ZI({});e.mount(window),e.setOptions({layoutScroll:!0}),aw.current=e}return aw.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),eM={pan:{Feature:yI},drag:{Feature:xI,ProjectionNode:w6,MeasureLayout:f6}};function qC(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,a=n[s];a&&Kn.postRender(()=>a(t,Fp(t)))}class tM extends Ku{mount(){const{current:t}=this.node;t&&(this.unmount=k7(t,(r,n)=>(qC(this.node,n,"Start"),s=>qC(this.node,s,"End"))))}unmount(){}}class rM extends Ku{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Np(ep(this.node.current,"focus",()=>this.onFocus()),ep(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function XC(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),a=n[s];a&&Kn.postRender(()=>a(t,Fp(t)))}class nM extends Ku{mount(){const{current:t}=this.node;t&&(this.unmount=N7(t,(r,n)=>(XC(this.node,n,"Start"),(s,{success:a})=>XC(this.node,s,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const S_=new WeakMap,iw=new WeakMap,sM=e=>{const t=S_.get(e.target);t&&t(e)},aM=e=>{e.forEach(sM)};function iM({root:e,...t}){const r=e||document;iw.has(r)||iw.set(r,{});const n=iw.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(aM,{root:e,...t})),n[s]}function oM(e,t,r){const n=iM(t);return S_.set(e,r),n.observe(e),()=>{S_.delete(e),n.unobserve(e)}}const lM={some:0,all:1};class cM extends Ku{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=t,i={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:lM[s]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:f,onViewportLeave:p}=this.node.getProps(),g=d?f:p;g&&g(c)};return oM(this.node.current,i,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(uM(t,r))&&this.startObserver()}unmount(){}}function uM({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const dM={inView:{Feature:cM},tap:{Feature:nM},focus:{Feature:rM},hover:{Feature:tM}},fM={layout:{ProjectionNode:w6,MeasureLayout:f6}},hM={...J9,...dM,...eM,...fM},Ze=h9(hM,T9),et=({children:e,variant:t="primary",size:r="md",onClick:n,disabled:s=!1,className:a="",...i})=>{const l="font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer",c={primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",success:"bg-green-600 hover:bg-green-700 text-white focus:ring-green-500",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500",warning:"bg-yellow-600 hover:bg-yellow-700 text-white focus:ring-yellow-500",outline:"bg-transparent text-blue-600 border-2 border-blue-600 hover:bg-blue-600 hover:text-white focus:ring-blue-500",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-500"},d={xs:"px-2 py-1 text-xs",sm:"px-2 py-1 text-xs sm:px-3 sm:py-1.5 sm:text-sm",md:"px-3 py-1.5 text-sm sm:px-4 sm:py-2 sm:text-base",lg:"px-4 py-2 text-base sm:px-6 sm:py-3 sm:text-lg",icon:"p-0 flex items-center justify-center"},f=s?"opacity-50 cursor-not-allowed":"";return o.jsx(Ze.button,{className:`${l} ${c[t]} ${d[r]} ${f} ${a}`,onClick:n,disabled:s,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},...i,children:e})},Fr=({size:e="md",color:t="blue",className:r=""})=>{const n={sm:"w-4 h-4",small:"w-4 h-4",md:"w-6 h-6",medium:"w-6 h-6",lg:"w-8 h-8",large:"w-8 h-8",xl:"w-12 h-12"},s={blue:"border-blue-600",green:"border-green-600",red:"border-red-600",yellow:"border-yellow-600",gray:"border-gray-600"};return o.jsx(Ze.div,{className:`
        inline-block border-2 border-gray-300 border-t-current rounded-full animate-spin
        ${n[e]} ${s[t]} ${r}
      `,animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})},Zo=({type:e="info",message:t="",duration:r=3e3,closable:n=!0,onClose:s,className:a="",...i})=>{const[l,c]=C.useState(!0),[d,f]=C.useState(!1),p=C.useRef(null),g=C.useRef(null);C.useEffect(()=>{if(r>0)return g.current=setTimeout(()=>{y()},r),()=>{g.current&&clearTimeout(g.current)}},[r]);const y=C.useCallback(()=>{d||(f(!0),g.current&&clearTimeout(g.current),setTimeout(()=>{c(!1),s&&s()},300))},[d,s]),v=C.useCallback(N=>{N.key==="Escape"&&y()},[y]);if(!l)return null;const _=["notification",`notification-${e}`,l?"notification-visible":"",d?"notification-exiting":"",a].filter(Boolean).join(" "),b=()=>{switch(e){case"success":return"";case"error":return"";case"warning":return"";case"info":default:return""}};return o.jsx("div",{ref:p,className:_,role:"alert","aria-live":"polite",onKeyDown:v,tabIndex:-1,...i,children:o.jsxs("div",{className:"notification-content",children:[o.jsx("div",{className:"notification-icon","aria-hidden":"true",children:b()}),o.jsx("div",{className:"notification-body",children:o.jsx("div",{className:"notification-message",children:t})}),n&&o.jsx("button",{className:"notification-close",onClick:y,type:"button","aria-label":"Close notification",children:""})]})})},ja=()=>{const[e,t]=C.useState([]),r=C.useCallback((a,i="info",l={})=>{const c=Date.now()+Math.random(),d={id:c,message:a,type:i,...l};return t(f=>[...f,d]),l.duration!==0&&setTimeout(()=>{n(c)},l.duration||3e3),c},[]),n=C.useCallback(a=>{t(i=>i.filter(l=>l.id!==a))},[]),s=C.useCallback(()=>{t([])},[]);return{notifications:e,showNotification:r,removeNotification:n,clearAllNotifications:s}},Xi=()=>{const[e,t]=C.useState(!1),[r,n]=C.useState(null),[s,a]=C.useState(null),i=C.useRef(null);C.useRef(new Map);const l=C.useRef(0),c=3,d=1e3,f=C.useCallback(()=>{i.current&&(i.current.abort(),i.current=null)},[]);C.useEffect(()=>f,[f]);const p=C.useCallback(async(L,M={})=>{try{t(!0),n(null),i.current=new AbortController;const X=M.method||"POST",K={method:X,headers:{"Content-Type":"application/json",...M.headers},signal:i.current.signal,...M};X!=="GET"&&X!=="HEAD"&&(K.body=JSON.stringify(M.data||{})),console.log(`[API] Making request to: ${L}`,K);const Z=await fetch(L,K);if(!Z.ok)throw new Error(`HTTP error! status: ${Z.status}`);const J=await Z.json();if(console.log("[API] Response received:",J),J.success)return a(J),l.current=0,J;throw new Error(J.error||J.message||"Request failed")}catch(X){if(X.name==="AbortError")return console.log("[API] Request was aborted"),null;if(console.error("[API] Request failed:",X),n(X.message||"Request failed"),l.current<c){l.current++;const K=d*Math.pow(2,l.current-1);return console.log(`[API] Retrying in ${K}ms (attempt ${l.current}/${c})`),await new Promise(Z=>setTimeout(Z,K)),p(L,M)}throw X}finally{t(!1),i.current=null}},[]),g=C.useCallback(async(L,M={})=>{try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");return await window.tokenManager.makeAuthenticatedRequest(L,M)}catch(X){throw console.error("[API] Authenticated request failed:",X),X}},[]),y=C.useCallback(async(L,M)=>{try{const X=`/.netlify/functions/get-test-questions?test_type=${L}&test_id=${M}`;console.log(`[API] Getting test info for ${L}_${M}`);const Z=await(await g(X)).json();if(Z.success)return console.log("[API] Test info retrieved successfully:",Z.test_info),Z.test_info;throw new Error(Z.error||"Failed to get test info")}catch(X){throw console.error("[API] Failed to get test info:",X),X}},[g]),v=C.useCallback(async(L,M)=>{try{const X=`/.netlify/functions/get-test-questions?test_type=${L}&test_id=${M}`;console.log(`[API] Getting test questions for ${L}_${M}`);const Z=await(await g(X)).json();if(Z.success)return console.log("[API] Test questions retrieved successfully:",Z.questions),Z.questions;throw new Error(Z.error||"Failed to get test questions")}catch(X){throw console.error("[API] Failed to get test questions:",X),X}},[g]),_=C.useCallback(async()=>{try{const L="/.netlify/functions/get-student-active-tests";console.log("[API] Loading student active tests");const X=await(await g(L)).json();if(X.success)return console.log("[API] Student active tests loaded successfully:",X.tests),X.tests;throw new Error(X.error||"Failed to load student active tests")}catch(L){throw console.error("[API] Failed to load student active tests:",L),L}},[g]),b=C.useCallback(async(L,M,X)=>{try{let K;switch(L){case"true_false":K="/.netlify/functions/submit-true-false-test";break;case"multiple_choice":K="/.netlify/functions/submit-multiple-choice-test";break;case"input":K="/.netlify/functions/submit-input-test";break;case"matching_type":K="/.netlify/functions/submit-matching-type-test";break;case"speaking":K="/.netlify/functions/submit-speaking-test";break;default:throw new Error(`Unknown test type: ${L}`)}console.log(`[API] Submitting ${L} test:`,X);const J=await(await g(K,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)})).json();if(J.success)return console.log("[API] Test submitted successfully:",J),J;throw new Error(J.error||"Failed to submit test")}catch(K){throw console.error("[API] Failed to submit test:",K),K}},[g]),N=C.useCallback(async L=>{try{const M="/.netlify/functions/save-multiple-choice-test";console.log("[API] Saving multiple choice test:",L);const K=await(await g(M,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)})).json();if(K.success)return console.log("[API] Multiple choice test saved successfully:",K),K;throw new Error(K.error||"Failed to save multiple choice test")}catch(M){throw console.error("[API] Failed to save multiple choice test:",M),M}},[g]),k=C.useCallback(async L=>{try{const M="/.netlify/functions/save-true-false-test";console.log("[API] Saving true/false test:",L);const K=await(await g(M,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)})).json();if(K.success)return console.log("[API] True/false test saved successfully:",K),K;throw new Error(K.error||"Failed to save true/false test")}catch(M){throw console.error("[API] Failed to save true/false test:",M),M}},[g]),w=C.useCallback(async L=>{try{const M="/.netlify/functions/save-input-test";console.log("[API] Saving input test:",L);const K=await(await g(M,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)})).json();if(K.success)return console.log("[API] Input test saved successfully:",K),K;throw new Error(K.error||"Failed to save input test")}catch(M){throw console.error("[API] Failed to save input test:",M),M}},[g]),T=C.useCallback(async L=>{try{const M="/.netlify/functions/assign-test";console.log("[API] Assigning test to classes:",L);const K=await(await g(M,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)})).json();if(K.success)return console.log("[API] Test assigned successfully:",K),K;throw new Error(K.error||"Failed to assign test")}catch(M){throw console.error("[API] Failed to assign test:",M),M}},[g]),A=C.useCallback(async()=>{try{const L="/.netlify/functions/get-teacher-active-tests";console.log("[API] Loading teacher active tests");const X=await(await g(L)).json();if(X.success)return console.log("[API] Teacher active tests loaded successfully:",X.tests),X.tests;throw new Error(X.error||"Failed to load teacher active tests")}catch(L){throw console.error("[API] Failed to load teacher active tests:",L),L}},[g]),F=C.useCallback(async()=>{try{const L="/.netlify/functions/get-all-users";console.log("[API] Getting all users");const X=await(await g(L)).json();if(X.success)return console.log("[API] All users loaded successfully:",X.users),X.users;throw new Error(X.error||"Failed to get all users")}catch(L){throw console.error("[API] Failed to get all users:",L),L}},[g]),R=C.useCallback(async()=>{try{const L="/.netlify/functions/get-all-teachers";console.log("[API] Getting all teachers");const X=await(await g(L)).json();if(X.success)return console.log("[API] All teachers loaded successfully:",X.teachers),X.teachers;throw new Error(X.error||"Failed to get all teachers")}catch(L){throw console.error("[API] Failed to get all teachers:",L),L}},[g]),E=C.useCallback(async()=>{try{const L="/.netlify/functions/get-all-subjects";console.log("[API] Getting all subjects");const X=await(await g(L)).json();if(X.success)return console.log("[API] All subjects loaded successfully:",X.subjects),X.subjects;throw new Error(X.error||"Failed to get all subjects")}catch(L){throw console.error("[API] Failed to get all subjects:",L),L}},[g]),D=C.useCallback(()=>{n(null)},[]),I=C.useCallback(()=>{a(null)},[]),G=C.useCallback(()=>{t(!1),n(null),a(null),l.current=0,f()},[f]),Y=C.useCallback(async(L,M={})=>{const K=await(await g(L,{...M,method:"GET"})).json();if(K.success)return K;throw new Error(K.error||"Request failed")},[g]),ee=C.useCallback(async(L,M,X={})=>{const Z=await(await g(L,{...X,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)})).json();if(Z.success)return Z;throw new Error(Z.error||"Request failed")},[g]),ie=C.useCallback(async(L,M,X={})=>{const Z=await(await g(L,{...X,method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)})).json();if(Z.success)return Z;throw new Error(Z.error||"Request failed")},[g]),re=C.useCallback(async(L,M={})=>{const K=await(await g(L,{...M,method:"DELETE"})).json();if(K.success)return K;throw new Error(K.error||"Request failed")},[g]),se=C.useCallback(async L=>{try{const M="/.netlify/functions/submit-speaking-test";console.log("[API] Submitting speaking test:",L);const K=await(await g(M,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)})).json();if(K.success)return console.log("[API] Speaking test submitted successfully:",K),K;throw new Error(K.error||"Failed to submit speaking test")}catch(M){throw console.error("[API] Failed to submit speaking test:",M),M}},[g]),B=C.useCallback(async L=>{try{const M=`/.netlify/functions/get-speaking-test-new?action=test&test_id=${L}`;console.log("[API] Getting speaking test:",L);const K=await(await g(M,{method:"GET"})).json();if(K.success)return console.log("[API] Speaking test loaded successfully:",K),K;throw new Error(K.error||"Failed to load speaking test")}catch(M){throw console.error("[API] Failed to load speaking test:",M),M}},[g]),z=C.useCallback(async L=>{try{const M=`/.netlify/functions/get-speaking-test-new?action=questions&test_id=${L}`;console.log("[API] Getting speaking test questions:",L);const K=await(await g(M,{method:"GET"})).json();if(K.success)return console.log("[API] Speaking test questions loaded successfully:",K),K;throw new Error(K.error||"Failed to load speaking test questions")}catch(M){throw console.error("[API] Failed to load speaking test questions:",M),M}},[g]),U=C.useCallback(async L=>{try{const M="/.netlify/functions/upload-speaking-audio";console.log("[API] Uploading speaking audio");const K=await(await g(M,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)})).json();if(K.success)return console.log("[API] Audio uploaded successfully:",K),K;throw new Error(K.error||"Failed to upload audio")}catch(M){throw console.error("[API] Failed to upload audio:",M),M}},[g]),V=C.useCallback(async L=>{try{const M=`/.netlify/functions/get-speaking-test-new?action=audio&file_path=${encodeURIComponent(L)}`;console.log("[API] Getting speaking audio:",L);const K=await(await g(M,{method:"GET"})).json();if(K.success)return console.log("[API] Audio URL retrieved successfully:",K),K;throw new Error(K.error||"Failed to get audio")}catch(M){throw console.error("[API] Failed to get audio:",M),M}},[g]),q=C.useCallback(async(L,M)=>{try{const X=`/.netlify/functions/check-test-completion?test_id=${L}&test_type=${M}`;console.log("[API] Checking test completion:",L,M);const Z=await(await g(X,{method:"GET"})).json();if(Z.success)return console.log("[API] Test completion status:",Z),Z;throw new Error(Z.error||"Failed to check test completion")}catch(X){throw console.error("[API] Failed to check test completion:",X),X}},[g]);return{loading:e,error:r,data:s,sendRequest:p,makeAuthenticatedRequest:g,get:Y,post:ee,put:ie,delete:re,getTestInfo:y,getTestQuestions:v,loadStudentActiveTests:_,submitTest:b,submitSpeakingTest:se,getSpeakingTest:B,getSpeakingTestQuestions:z,uploadSpeakingAudio:U,getSpeakingAudio:V,checkTestCompletion:q,saveMultipleChoiceTest:N,saveTrueFalseTest:k,saveInputTest:w,assignTestToClasses:T,loadTeacherActiveTests:A,getAllUsers:F,getAllTeachers:R,getAllSubjects:E,clearError:D,clearData:I,reset:G,cleanup:f}},gM="modulepreload",mM=function(e){return"/"+e},YC={},Vo=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){let d=function(f){return Promise.all(f.map(p=>Promise.resolve(p).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};var i=d;document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");s=d(r.map(f=>{if(f=mM(f),f in YC)return;YC[f]=!0;const p=f.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const y=document.createElement("link");if(y.rel=p?"stylesheet":gM,p||(y.as="script"),y.crossOrigin="",y.href=f,c&&y.setAttribute("nonce",c),document.head.appendChild(y),p)return new Promise((v,_)=>{y.addEventListener("load",v),y.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return s.then(l=>{for(const c of l||[])c.status==="rejected"&&a(c.reason);return t().catch(a)})};var Ry={exports:{}},Ng={},ow={},lw={},JC;function $r(){return JC||(JC=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const t=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}e.glob=typeof Uy<"u"?Uy:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},e.Konva={_global:e.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(s){}).toString()),dblClickWindow:400,getAngle(s){return e.Konva.angleDeg?s*t:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva.DD.isDragging},isTransforming(){var s;return(s=e.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!e.Konva.DD.node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(s){e.glob.Konva=s}};const n=s=>{e.Konva[s.prototype.getClassName()]=s};e._registerNode=n,e.Konva._injectGlobal(e.Konva)})(lw)),lw}var cw={},QC;function ms(){return QC||(QC=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const t=$r();class r{constructor(T=[1,0,0,1,0,0]){this.dirty=!1,this.m=T&&T.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(T){T.m[0]=this.m[0],T.m[1]=this.m[1],T.m[2]=this.m[2],T.m[3]=this.m[3],T.m[4]=this.m[4],T.m[5]=this.m[5]}point(T){const A=this.m;return{x:A[0]*T.x+A[2]*T.y+A[4],y:A[1]*T.x+A[3]*T.y+A[5]}}translate(T,A){return this.m[4]+=this.m[0]*T+this.m[2]*A,this.m[5]+=this.m[1]*T+this.m[3]*A,this}scale(T,A){return this.m[0]*=T,this.m[1]*=T,this.m[2]*=A,this.m[3]*=A,this}rotate(T){const A=Math.cos(T),F=Math.sin(T),R=this.m[0]*A+this.m[2]*F,E=this.m[1]*A+this.m[3]*F,D=this.m[0]*-F+this.m[2]*A,I=this.m[1]*-F+this.m[3]*A;return this.m[0]=R,this.m[1]=E,this.m[2]=D,this.m[3]=I,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(T,A){const F=this.m[0]+this.m[2]*A,R=this.m[1]+this.m[3]*A,E=this.m[2]+this.m[0]*T,D=this.m[3]+this.m[1]*T;return this.m[0]=F,this.m[1]=R,this.m[2]=E,this.m[3]=D,this}multiply(T){const A=this.m[0]*T.m[0]+this.m[2]*T.m[1],F=this.m[1]*T.m[0]+this.m[3]*T.m[1],R=this.m[0]*T.m[2]+this.m[2]*T.m[3],E=this.m[1]*T.m[2]+this.m[3]*T.m[3],D=this.m[0]*T.m[4]+this.m[2]*T.m[5]+this.m[4],I=this.m[1]*T.m[4]+this.m[3]*T.m[5]+this.m[5];return this.m[0]=A,this.m[1]=F,this.m[2]=R,this.m[3]=E,this.m[4]=D,this.m[5]=I,this}invert(){const T=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),A=this.m[3]*T,F=-this.m[1]*T,R=-this.m[2]*T,E=this.m[0]*T,D=T*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),I=T*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=A,this.m[1]=F,this.m[2]=R,this.m[3]=E,this.m[4]=D,this.m[5]=I,this}getMatrix(){return this.m}decompose(){const T=this.m[0],A=this.m[1],F=this.m[2],R=this.m[3],E=this.m[4],D=this.m[5],I=T*R-A*F,G={x:E,y:D,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(T!=0||A!=0){const Y=Math.sqrt(T*T+A*A);G.rotation=A>0?Math.acos(T/Y):-Math.acos(T/Y),G.scaleX=Y,G.scaleY=I/Y,G.skewX=(T*F+A*R)/I,G.skewY=0}else if(F!=0||R!=0){const Y=Math.sqrt(F*F+R*R);G.rotation=Math.PI/2-(R>0?Math.acos(-F/Y):-Math.acos(F/Y)),G.scaleX=I/Y,G.scaleY=Y,G.skewX=0,G.skewY=(T*F+A*R)/I}return G.rotation=e.Util._getRotation(G.rotation),G}}e.Transform=r;const n="[object Array]",s="[object Number]",a="[object String]",i="[object Boolean]",l=Math.PI/180,c=180/Math.PI,d="#",f="",p="0",g="Konva warning: ",y="Konva error: ",v="rgb(",_={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},b=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let N=[];const k=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(w){setTimeout(w,60)};e.Util={_isElement(w){return!!(w&&w.nodeType==1)},_isFunction(w){return!!(w&&w.constructor&&w.call&&w.apply)},_isPlainObject(w){return!!w&&w.constructor===Object},_isArray(w){return Object.prototype.toString.call(w)===n},_isNumber(w){return Object.prototype.toString.call(w)===s&&!isNaN(w)&&isFinite(w)},_isString(w){return Object.prototype.toString.call(w)===a},_isBoolean(w){return Object.prototype.toString.call(w)===i},isObject(w){return w instanceof Object},isValidSelector(w){if(typeof w!="string")return!1;const T=w[0];return T==="#"||T==="."||T===T.toUpperCase()},_sign(w){return w===0||w>0?1:-1},requestAnimFrame(w){N.push(w),N.length===1&&k(function(){const T=N;N=[],T.forEach(function(A){A()})})},createCanvasElement(){const w=document.createElement("canvas");try{w.style=w.style||{}}catch{}return w},createImageElement(){return document.createElement("img")},_isInDocument(w){for(;w=w.parentNode;)if(w==document)return!0;return!1},_urlToImage(w,T){const A=e.Util.createImageElement();A.onload=function(){T(A)},A.src=w},_rgbToHex(w,T,A){return((1<<24)+(w<<16)+(T<<8)+A).toString(16).slice(1)},_hexToRgb(w){w=w.replace(d,f);const T=parseInt(w,16);return{r:T>>16&255,g:T>>8&255,b:T&255}},getRandomColor(){let w=(Math.random()*16777215<<0).toString(16);for(;w.length<6;)w=p+w;return d+w},getRGB(w){let T;return w in _?(T=_[w],{r:T[0],g:T[1],b:T[2]}):w[0]===d?this._hexToRgb(w.substring(1)):w.substr(0,4)===v?(T=b.exec(w.replace(/ /g,"")),{r:parseInt(T[1],10),g:parseInt(T[2],10),b:parseInt(T[3],10)}):{r:0,g:0,b:0}},colorToRGBA(w){return w=w||"black",e.Util._namedColorToRBA(w)||e.Util._hex3ColorToRGBA(w)||e.Util._hex4ColorToRGBA(w)||e.Util._hex6ColorToRGBA(w)||e.Util._hex8ColorToRGBA(w)||e.Util._rgbColorToRGBA(w)||e.Util._rgbaColorToRGBA(w)||e.Util._hslColorToRGBA(w)},_namedColorToRBA(w){const T=_[w.toLowerCase()];return T?{r:T[0],g:T[1],b:T[2],a:1}:null},_rgbColorToRGBA(w){if(w.indexOf("rgb(")===0){w=w.match(/rgb\(([^)]+)\)/)[1];const T=w.split(/ *, */).map(Number);return{r:T[0],g:T[1],b:T[2],a:1}}},_rgbaColorToRGBA(w){if(w.indexOf("rgba(")===0){w=w.match(/rgba\(([^)]+)\)/)[1];const T=w.split(/ *, */).map((A,F)=>A.slice(-1)==="%"?F===3?parseInt(A)/100:parseInt(A)/100*255:Number(A));return{r:T[0],g:T[1],b:T[2],a:T[3]}}},_hex8ColorToRGBA(w){if(w[0]==="#"&&w.length===9)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:parseInt(w.slice(7,9),16)/255}},_hex6ColorToRGBA(w){if(w[0]==="#"&&w.length===7)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:1}},_hex4ColorToRGBA(w){if(w[0]==="#"&&w.length===5)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:parseInt(w[4]+w[4],16)/255}},_hex3ColorToRGBA(w){if(w[0]==="#"&&w.length===4)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:1}},_hslColorToRGBA(w){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(w)){const[T,...A]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(w),F=Number(A[0])/360,R=Number(A[1])/100,E=Number(A[2])/100;let D,I,G;if(R===0)return G=E*255,{r:Math.round(G),g:Math.round(G),b:Math.round(G),a:1};E<.5?D=E*(1+R):D=E+R-E*R;const Y=2*E-D,ee=[0,0,0];for(let ie=0;ie<3;ie++)I=F+1/3*-(ie-1),I<0&&I++,I>1&&I--,6*I<1?G=Y+(D-Y)*6*I:2*I<1?G=D:3*I<2?G=Y+(D-Y)*(2/3-I)*6:G=Y,ee[ie]=G*255;return{r:Math.round(ee[0]),g:Math.round(ee[1]),b:Math.round(ee[2]),a:1}}},haveIntersection(w,T){return!(T.x>w.x+w.width||T.x+T.width<w.x||T.y>w.y+w.height||T.y+T.height<w.y)},cloneObject(w){const T={};for(const A in w)this._isPlainObject(w[A])?T[A]=this.cloneObject(w[A]):this._isArray(w[A])?T[A]=this.cloneArray(w[A]):T[A]=w[A];return T},cloneArray(w){return w.slice(0)},degToRad(w){return w*l},radToDeg(w){return w*c},_degToRad(w){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(w)},_radToDeg(w){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(w)},_getRotation(w){return t.Konva.angleDeg?e.Util.radToDeg(w):w},_capitalize(w){return w.charAt(0).toUpperCase()+w.slice(1)},throw(w){throw new Error(y+w)},error(w){console.error(y+w)},warn(w){t.Konva.showWarnings&&console.warn(g+w)},each(w,T){for(const A in w)T(A,w[A])},_inRange(w,T,A){return T<=w&&w<A},_getProjectionToSegment(w,T,A,F,R,E){let D,I,G;const Y=(w-A)*(w-A)+(T-F)*(T-F);if(Y==0)D=w,I=T,G=(R-A)*(R-A)+(E-F)*(E-F);else{const ee=((R-w)*(A-w)+(E-T)*(F-T))/Y;ee<0?(D=w,I=T,G=(w-R)*(w-R)+(T-E)*(T-E)):ee>1?(D=A,I=F,G=(A-R)*(A-R)+(F-E)*(F-E)):(D=w+ee*(A-w),I=T+ee*(F-T),G=(D-R)*(D-R)+(I-E)*(I-E))}return[D,I,G]},_getProjectionToLine(w,T,A){const F=e.Util.cloneObject(w);let R=Number.MAX_VALUE;return T.forEach(function(E,D){if(!A&&D===T.length-1)return;const I=T[(D+1)%T.length],G=e.Util._getProjectionToSegment(E.x,E.y,I.x,I.y,w.x,w.y),Y=G[0],ee=G[1],ie=G[2];ie<R&&(F.x=Y,F.y=ee,R=ie)}),F},_prepareArrayForTween(w,T,A){const F=[],R=[];if(w.length>T.length){const D=T;T=w,w=D}for(let D=0;D<w.length;D+=2)F.push({x:w[D],y:w[D+1]});for(let D=0;D<T.length;D+=2)R.push({x:T[D],y:T[D+1]});const E=[];return R.forEach(function(D){const I=e.Util._getProjectionToLine(D,F,A);E.push(I.x),E.push(I.y)}),E},_prepareToStringify(w){let T;w.visitedByCircularReferenceRemoval=!0;for(const A in w)if(w.hasOwnProperty(A)&&w[A]&&typeof w[A]=="object"){if(T=Object.getOwnPropertyDescriptor(w,A),w[A].visitedByCircularReferenceRemoval||e.Util._isElement(w[A]))if(T.configurable)delete w[A];else return null;else if(e.Util._prepareToStringify(w[A])===null)if(T.configurable)delete w[A];else return null}return delete w.visitedByCircularReferenceRemoval,w},_assign(w,T){for(const A in T)w[A]=T[A];return w},_getFirstPointerId(w){return w.touches?w.changedTouches[0].identifier:w.pointerId||999},releaseCanvas(...w){t.Konva.releaseCanvasOnDestroy&&w.forEach(T=>{T.width=0,T.height=0})},drawRoundedRectPath(w,T,A,F){let R=0,E=0,D=0,I=0;typeof F=="number"?R=E=D=I=Math.min(F,T/2,A/2):(R=Math.min(F[0]||0,T/2,A/2),E=Math.min(F[1]||0,T/2,A/2),I=Math.min(F[2]||0,T/2,A/2),D=Math.min(F[3]||0,T/2,A/2)),w.moveTo(R,0),w.lineTo(T-E,0),w.arc(T-E,E,E,Math.PI*3/2,0,!1),w.lineTo(T,A-I),w.arc(T-I,A-I,I,0,Math.PI/2,!1),w.lineTo(D,A),w.arc(D,A-D,D,Math.PI/2,Math.PI,!1),w.lineTo(0,R),w.arc(R,R,R,Math.PI,Math.PI*3/2,!1)}}})(cw)),cw}var Ag={},gc={},mc={},ZC;function _6(){if(ZC)return mc;ZC=1,Object.defineProperty(mc,"__esModule",{value:!0}),mc.HitContext=mc.SceneContext=mc.Context=void 0;const e=ms(),t=$r();function r(N){const k=[],w=N.length,T=e.Util;for(let A=0;A<w;A++){let F=N[A];T._isNumber(F)?F=Math.round(F*1e3)/1e3:T._isString(F)||(F=F+""),k.push(F)}return k}const n=",",s="(",a=")",i="([",l="])",c=";",d="()",f="=",p=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],g=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],y=100;let v=class{constructor(k){this.canvas=k,t.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(k){k.fillEnabled()&&this._fill(k)}_fill(k){}strokeShape(k){k.hasStroke()&&this._stroke(k)}_stroke(k){}fillStrokeShape(k){k.attrs.fillAfterStrokeEnabled?(this.strokeShape(k),this.fillShape(k)):(this.fillShape(k),this.strokeShape(k))}getTrace(k,w){let T=this.traceArr,A=T.length,F="",R,E,D,I;for(R=0;R<A;R++)E=T[R],D=E.method,D?(I=E.args,F+=D,k?F+=d:e.Util._isArray(I[0])?F+=i+I.join(n)+l:(w&&(I=I.map(G=>typeof G=="number"?Math.floor(G):G)),F+=s+I.join(n)+a)):(F+=E.property,k||(F+=f+E.val)),F+=c;return F}clearTrace(){this.traceArr=[]}_trace(k){let w=this.traceArr,T;w.push(k),T=w.length,T>=y&&w.shift()}reset(){const k=this.getCanvas().getPixelRatio();this.setTransform(1*k,0,0,1*k,0,0)}getCanvas(){return this.canvas}clear(k){const w=this.getCanvas();k?this.clearRect(k.x||0,k.y||0,k.width||0,k.height||0):this.clearRect(0,0,w.getWidth()/w.pixelRatio,w.getHeight()/w.pixelRatio)}_applyLineCap(k){const w=k.attrs.lineCap;w&&this.setAttr("lineCap",w)}_applyOpacity(k){const w=k.getAbsoluteOpacity();w!==1&&this.setAttr("globalAlpha",w)}_applyLineJoin(k){const w=k.attrs.lineJoin;w&&this.setAttr("lineJoin",w)}setAttr(k,w){this._context[k]=w}arc(k,w,T,A,F,R){this._context.arc(k,w,T,A,F,R)}arcTo(k,w,T,A,F){this._context.arcTo(k,w,T,A,F)}beginPath(){this._context.beginPath()}bezierCurveTo(k,w,T,A,F,R){this._context.bezierCurveTo(k,w,T,A,F,R)}clearRect(k,w,T,A){this._context.clearRect(k,w,T,A)}clip(...k){this._context.clip.apply(this._context,k)}closePath(){this._context.closePath()}createImageData(k,w){const T=arguments;if(T.length===2)return this._context.createImageData(k,w);if(T.length===1)return this._context.createImageData(k)}createLinearGradient(k,w,T,A){return this._context.createLinearGradient(k,w,T,A)}createPattern(k,w){return this._context.createPattern(k,w)}createRadialGradient(k,w,T,A,F,R){return this._context.createRadialGradient(k,w,T,A,F,R)}drawImage(k,w,T,A,F,R,E,D,I){const G=arguments,Y=this._context;G.length===3?Y.drawImage(k,w,T):G.length===5?Y.drawImage(k,w,T,A,F):G.length===9&&Y.drawImage(k,w,T,A,F,R,E,D,I)}ellipse(k,w,T,A,F,R,E,D){this._context.ellipse(k,w,T,A,F,R,E,D)}isPointInPath(k,w,T,A){return T?this._context.isPointInPath(T,k,w,A):this._context.isPointInPath(k,w,A)}fill(...k){this._context.fill.apply(this._context,k)}fillRect(k,w,T,A){this._context.fillRect(k,w,T,A)}strokeRect(k,w,T,A){this._context.strokeRect(k,w,T,A)}fillText(k,w,T,A){A?this._context.fillText(k,w,T,A):this._context.fillText(k,w,T)}measureText(k){return this._context.measureText(k)}getImageData(k,w,T,A){return this._context.getImageData(k,w,T,A)}lineTo(k,w){this._context.lineTo(k,w)}moveTo(k,w){this._context.moveTo(k,w)}rect(k,w,T,A){this._context.rect(k,w,T,A)}roundRect(k,w,T,A,F){this._context.roundRect(k,w,T,A,F)}putImageData(k,w,T){this._context.putImageData(k,w,T)}quadraticCurveTo(k,w,T,A){this._context.quadraticCurveTo(k,w,T,A)}restore(){this._context.restore()}rotate(k){this._context.rotate(k)}save(){this._context.save()}scale(k,w){this._context.scale(k,w)}setLineDash(k){this._context.setLineDash?this._context.setLineDash(k):"mozDash"in this._context?this._context.mozDash=k:"webkitLineDash"in this._context&&(this._context.webkitLineDash=k)}getLineDash(){return this._context.getLineDash()}setTransform(k,w,T,A,F,R){this._context.setTransform(k,w,T,A,F,R)}stroke(k){k?this._context.stroke(k):this._context.stroke()}strokeText(k,w,T,A){this._context.strokeText(k,w,T,A)}transform(k,w,T,A,F,R){this._context.transform(k,w,T,A,F,R)}translate(k,w){this._context.translate(k,w)}_enableTrace(){let k=this,w=p.length,T=this.setAttr,A,F;const R=function(E){let D=k[E],I;k[E]=function(){return F=r(Array.prototype.slice.call(arguments,0)),I=D.apply(k,arguments),k._trace({method:E,args:F}),I}};for(A=0;A<w;A++)R(p[A]);k.setAttr=function(){T.apply(k,arguments);const E=arguments[0];let D=arguments[1];(E==="shadowOffsetX"||E==="shadowOffsetY"||E==="shadowBlur")&&(D=D/this.canvas.getPixelRatio()),k._trace({property:E,val:D})}}_applyGlobalCompositeOperation(k){const w=k.attrs.globalCompositeOperation;!w||w==="source-over"||this.setAttr("globalCompositeOperation",w)}};mc.Context=v,g.forEach(function(N){Object.defineProperty(v.prototype,N,{get(){return this._context[N]},set(k){this._context[N]=k}})});class _ extends v{constructor(k,{willReadFrequently:w=!1}={}){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:w})}_fillColor(k){const w=k.fill();this.setAttr("fillStyle",w),k._fillFunc(this)}_fillPattern(k){this.setAttr("fillStyle",k._getFillPattern()),k._fillFunc(this)}_fillLinearGradient(k){const w=k._getLinearGradient();w&&(this.setAttr("fillStyle",w),k._fillFunc(this))}_fillRadialGradient(k){const w=k._getRadialGradient();w&&(this.setAttr("fillStyle",w),k._fillFunc(this))}_fill(k){const w=k.fill(),T=k.getFillPriority();if(w&&T==="color"){this._fillColor(k);return}const A=k.getFillPatternImage();if(A&&T==="pattern"){this._fillPattern(k);return}const F=k.getFillLinearGradientColorStops();if(F&&T==="linear-gradient"){this._fillLinearGradient(k);return}const R=k.getFillRadialGradientColorStops();if(R&&T==="radial-gradient"){this._fillRadialGradient(k);return}w?this._fillColor(k):A?this._fillPattern(k):F?this._fillLinearGradient(k):R&&this._fillRadialGradient(k)}_strokeLinearGradient(k){const w=k.getStrokeLinearGradientStartPoint(),T=k.getStrokeLinearGradientEndPoint(),A=k.getStrokeLinearGradientColorStops(),F=this.createLinearGradient(w.x,w.y,T.x,T.y);if(A){for(let R=0;R<A.length;R+=2)F.addColorStop(A[R],A[R+1]);this.setAttr("strokeStyle",F)}}_stroke(k){const w=k.dash(),T=k.getStrokeScaleEnabled();if(k.hasStroke()){if(!T){this.save();const F=this.getCanvas().getPixelRatio();this.setTransform(F,0,0,F,0,0)}this._applyLineCap(k),w&&k.dashEnabled()&&(this.setLineDash(w),this.setAttr("lineDashOffset",k.dashOffset())),this.setAttr("lineWidth",k.strokeWidth()),k.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),k.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(k):this.setAttr("strokeStyle",k.stroke()),k._strokeFunc(this),T||this.restore()}}_applyShadow(k){var w,T,A;const F=(w=k.getShadowRGBA())!==null&&w!==void 0?w:"black",R=(T=k.getShadowBlur())!==null&&T!==void 0?T:5,E=(A=k.getShadowOffset())!==null&&A!==void 0?A:{x:0,y:0},D=k.getAbsoluteScale(),I=this.canvas.getPixelRatio(),G=D.x*I,Y=D.y*I;this.setAttr("shadowColor",F),this.setAttr("shadowBlur",R*Math.min(Math.abs(G),Math.abs(Y))),this.setAttr("shadowOffsetX",E.x*G),this.setAttr("shadowOffsetY",E.y*Y)}}mc.SceneContext=_;class b extends v{constructor(k){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:!0})}_fill(k){this.save(),this.setAttr("fillStyle",k.colorKey),k._fillFuncHit(this),this.restore()}strokeShape(k){k.hasHitStroke()&&this._stroke(k)}_stroke(k){if(k.hasHitStroke()){const w=k.getStrokeScaleEnabled();if(!w){this.save();const F=this.getCanvas().getPixelRatio();this.setTransform(F,0,0,F,0,0)}this._applyLineCap(k);const T=k.hitStrokeWidth(),A=T==="auto"?k.strokeWidth():T;this.setAttr("lineWidth",A),this.setAttr("strokeStyle",k.colorKey),k._strokeFuncHit(this),w||this.restore()}}}return mc.HitContext=b,mc}var eT;function I1(){if(eT)return gc;eT=1,Object.defineProperty(gc,"__esModule",{value:!0}),gc.HitCanvas=gc.SceneCanvas=gc.Canvas=void 0;const e=ms(),t=_6(),r=$r();let n;function s(){if(n)return n;const c=e.Util.createCanvasElement(),d=c.getContext("2d");return n=(function(){const f=r.Konva._global.devicePixelRatio||1,p=d.webkitBackingStorePixelRatio||d.mozBackingStorePixelRatio||d.msBackingStorePixelRatio||d.oBackingStorePixelRatio||d.backingStorePixelRatio||1;return f/p})(),e.Util.releaseCanvas(c),n}let a=class{constructor(d){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const p=(d||{}).pixelRatio||r.Konva.pixelRatio||s();this.pixelRatio=p,this._canvas=e.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(d){const f=this.pixelRatio;this.pixelRatio=d,this.setSize(this.getWidth()/f,this.getHeight()/f)}setWidth(d){this.width=this._canvas.width=d*this.pixelRatio,this._canvas.style.width=d+"px";const f=this.pixelRatio;this.getContext()._context.scale(f,f)}setHeight(d){this.height=this._canvas.height=d*this.pixelRatio,this._canvas.style.height=d+"px";const f=this.pixelRatio;this.getContext()._context.scale(f,f)}getWidth(){return this.width}getHeight(){return this.height}setSize(d,f){this.setWidth(d||0),this.setHeight(f||0)}toDataURL(d,f){try{return this._canvas.toDataURL(d,f)}catch{try{return this._canvas.toDataURL()}catch(g){return e.Util.error("Unable to get data URL. "+g.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};gc.Canvas=a;class i extends a{constructor(d={width:0,height:0,willReadFrequently:!1}){super(d),this.context=new t.SceneContext(this,{willReadFrequently:d.willReadFrequently}),this.setSize(d.width,d.height)}}gc.SceneCanvas=i;class l extends a{constructor(d={width:0,height:0}){super(d),this.hitCanvas=!0,this.context=new t.HitContext(this),this.setSize(d.width,d.height)}}return gc.HitCanvas=l,gc}var uw={},tT;function sb(){return tT||(tT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const t=$r(),r=ms();e.DD={get isDragging(){let n=!1;return e.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return e.DD._dragElements.forEach(s=>{n=s.node}),n},_dragElements:new Map,_drag(n){const s=[];e.DD._dragElements.forEach((a,i)=>{const{node:l}=a,c=l.getStage();c.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const d=c._changedPointerPositions.find(f=>f.id===a.pointerId);if(d){if(a.dragStatus!=="dragging"){const f=l.dragDistance();if(Math.max(Math.abs(d.x-a.startPointerPos.x),Math.abs(d.y-a.startPointerPos.y))<f||(l.startDrag({evt:n}),!l.isDragging()))return}l._setDragPosition(n,a),s.push(l)}}),s.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const s=[];e.DD._dragElements.forEach(a=>{const{node:i}=a,l=i.getStage();if(n&&l.setPointersPositions(n),!l._changedPointerPositions.find(f=>f.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(e.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,a.dragStatus="stopped");const d=a.node.getLayer()||a.node instanceof t.Konva.Stage&&a.node;d&&s.indexOf(d)===-1&&s.push(d)}),s.forEach(a=>{a.draw()})},_endDragAfter(n){e.DD._dragElements.forEach((s,a)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:n},!0),s.dragStatus!=="dragging"&&e.DD._dragElements.delete(a)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("touchcancel",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1),window.addEventListener("touchcancel",e.DD._endDragAfter,!1))})(uw)),uw}var dw={},ki={},rT;function Xr(){if(rT)return ki;rT=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.RGBComponent=n,ki.alphaComponent=s,ki.getNumberValidator=a,ki.getNumberOrArrayOfNumbersValidator=i,ki.getNumberOrAutoValidator=l,ki.getStringValidator=c,ki.getStringOrGradientValidator=d,ki.getFunctionValidator=f,ki.getNumberArrayValidator=p,ki.getBooleanValidator=g,ki.getComponentValidator=y;const e=$r(),t=ms();function r(v){return t.Util._isString(v)?'"'+v+'"':Object.prototype.toString.call(v)==="[object Number]"||t.Util._isBoolean(v)?v:Object.prototype.toString.call(v)}function n(v){return v>255?255:v<0?0:Math.round(v)}function s(v){return v>1?1:v<1e-4?1e-4:v}function a(){if(e.Konva.isUnminified)return function(v,_){return t.Util._isNumber(v)||t.Util.warn(r(v)+' is a not valid value for "'+_+'" attribute. The value should be a number.'),v}}function i(v){if(e.Konva.isUnminified)return function(_,b){let N=t.Util._isNumber(_),k=t.Util._isArray(_)&&_.length==v;return!N&&!k&&t.Util.warn(r(_)+' is a not valid value for "'+b+'" attribute. The value should be a number or Array<number>('+v+")"),_}}function l(){if(e.Konva.isUnminified)return function(v,_){return t.Util._isNumber(v)||v==="auto"||t.Util.warn(r(v)+' is a not valid value for "'+_+'" attribute. The value should be a number or "auto".'),v}}function c(){if(e.Konva.isUnminified)return function(v,_){return t.Util._isString(v)||t.Util.warn(r(v)+' is a not valid value for "'+_+'" attribute. The value should be a string.'),v}}function d(){if(e.Konva.isUnminified)return function(v,_){const b=t.Util._isString(v),N=Object.prototype.toString.call(v)==="[object CanvasGradient]"||v&&v.addColorStop;return b||N||t.Util.warn(r(v)+' is a not valid value for "'+_+'" attribute. The value should be a string or a native gradient.'),v}}function f(){if(e.Konva.isUnminified)return function(v,_){return t.Util._isFunction(v)||t.Util.warn(r(v)+' is a not valid value for "'+_+'" attribute. The value should be a function.'),v}}function p(){if(e.Konva.isUnminified)return function(v,_){const b=Int8Array?Object.getPrototypeOf(Int8Array):null;return b&&v instanceof b||(t.Util._isArray(v)?v.forEach(function(N){t.Util._isNumber(N)||t.Util.warn('"'+_+'" attribute has non numeric element '+N+". Make sure that all elements are numbers.")}):t.Util.warn(r(v)+' is a not valid value for "'+_+'" attribute. The value should be a array of numbers.')),v}}function g(){if(e.Konva.isUnminified)return function(v,_){return v===!0||v===!1||t.Util.warn(r(v)+' is a not valid value for "'+_+'" attribute. The value should be a boolean.'),v}}function y(v){if(e.Konva.isUnminified)return function(_,b){return _==null||t.Util.isObject(_)||t.Util.warn(r(_)+' is a not valid value for "'+b+'" attribute. The value should be an object with properties '+v),_}}return ki}var nT;function Kr(){return nT||(nT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const t=ms(),r=Xr(),n="get",s="set";e.Factory={addGetterSetter(a,i,l,c,d){e.Factory.addGetter(a,i,l),e.Factory.addSetter(a,i,c,d),e.Factory.addOverloadedGetterSetter(a,i)},addGetter(a,i,l){const c=n+t.Util._capitalize(i);a.prototype[c]=a.prototype[c]||function(){const d=this.attrs[i];return d===void 0?l:d}},addSetter(a,i,l,c){const d=s+t.Util._capitalize(i);a.prototype[d]||e.Factory.overWriteSetter(a,i,l,c)},overWriteSetter(a,i,l,c){const d=s+t.Util._capitalize(i);a.prototype[d]=function(f){return l&&f!==void 0&&f!==null&&(f=l.call(this,f,i)),this._setAttr(i,f),c&&c.call(this),this}},addComponentsGetterSetter(a,i,l,c,d){const f=l.length,p=t.Util._capitalize,g=n+p(i),y=s+p(i);a.prototype[g]=function(){const _={};for(let b=0;b<f;b++){const N=l[b];_[N]=this.getAttr(i+p(N))}return _};const v=(0,r.getComponentValidator)(l);a.prototype[y]=function(_){const b=this.attrs[i];c&&(_=c.call(this,_,i)),v&&v.call(this,_,i);for(const N in _)_.hasOwnProperty(N)&&this._setAttr(i+p(N),_[N]);return _||l.forEach(N=>{this._setAttr(i+p(N),void 0)}),this._fireChangeEvent(i,b,_),d&&d.call(this),this},e.Factory.addOverloadedGetterSetter(a,i)},addOverloadedGetterSetter(a,i){const l=t.Util._capitalize(i),c=s+l,d=n+l;a.prototype[i]=function(){return arguments.length?(this[c](arguments[0]),this):this[d]()}},addDeprecatedGetterSetter(a,i,l,c){t.Util.error("Adding deprecated "+i);const d=n+t.Util._capitalize(i),f=i+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[d]=function(){t.Util.error(f);const p=this.attrs[i];return p===void 0?l:p},e.Factory.addSetter(a,i,c,function(){t.Util.error(f)}),e.Factory.addOverloadedGetterSetter(a,i)},backCompat(a,i){t.Util.each(i,function(l,c){const d=a.prototype[c],f=n+t.Util._capitalize(l),p=s+t.Util._capitalize(l);function g(){d.apply(this,arguments),t.Util.error('"'+l+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}a.prototype[l]=g,a.prototype[f]=g,a.prototype[p]=g})},afterSetFilter(){this._filterUpToDate=!1}}})(dw)),dw}var sT;function Ts(){if(sT)return Ag;sT=1,Object.defineProperty(Ag,"__esModule",{value:!0}),Ag.Node=void 0;const e=I1(),t=sb(),r=Kr(),n=$r(),s=ms(),a=Xr(),i="absoluteOpacity",l="allEventListeners",c="absoluteTransform",d="absoluteScale",f="canvas",p="Change",g="children",y="konva",v="listening",_="mouseenter",b="mouseleave",N="pointerenter",k="pointerleave",w="touchenter",T="touchleave",A="set",F="Shape",R=" ",E="stage",D="transform",I="Stage",G="visible",Y=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(R);let ee=1,ie=class k_{constructor(B){this._id=ee++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(B),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(B){(B===D||B===c)&&this._cache.get(B)?this._cache.get(B).dirty=!0:B?this._cache.delete(B):this._cache.clear()}_getCache(B,z){let U=this._cache.get(B);return(U===void 0||(B===D||B===c)&&U.dirty===!0)&&(U=z.call(this),this._cache.set(B,U)),U}_calculate(B,z,U){if(!this._attachedDepsListeners.get(B)){const V=z.map(q=>q+"Change.konva").join(R);this.on(V,()=>{this._clearCache(B)}),this._attachedDepsListeners.set(B,!0)}return this._getCache(B,U)}_getCanvasCache(){return this._cache.get(f)}_clearSelfAndDescendantCache(B){this._clearCache(B),B===c&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(f)){const{scene:B,filter:z,hit:U,buffer:V}=this._cache.get(f);s.Util.releaseCanvas(B,z,U,V),this._cache.delete(f)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(B){const z=B||{};let U={};(z.x===void 0||z.y===void 0||z.width===void 0||z.height===void 0)&&(U=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let V=Math.ceil(z.width||U.width),q=Math.ceil(z.height||U.height),L=z.pixelRatio,M=z.x===void 0?Math.floor(U.x):z.x,X=z.y===void 0?Math.floor(U.y):z.y,K=z.offset||0,Z=z.drawBorder||!1,J=z.hitCanvasPixelRatio||1;if(!V||!q){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const ne=Math.abs(Math.round(U.x)-M)>.5?1:0,me=Math.abs(Math.round(U.y)-X)>.5?1:0;V+=K*2+ne,q+=K*2+me,M-=K,X-=K;const xe=new e.SceneCanvas({pixelRatio:L,width:V,height:q}),Ne=new e.SceneCanvas({pixelRatio:L,width:0,height:0,willReadFrequently:!0}),le=new e.HitCanvas({pixelRatio:J,width:V,height:q}),ge=xe.getContext(),Ue=le.getContext(),Ge=new e.SceneCanvas({width:xe.width/xe.pixelRatio+Math.abs(M),height:xe.height/xe.pixelRatio+Math.abs(X),pixelRatio:xe.pixelRatio}),Je=Ge.getContext();return le.isCache=!0,xe.isCache=!0,this._cache.delete(f),this._filterUpToDate=!1,z.imageSmoothingEnabled===!1&&(xe.getContext()._context.imageSmoothingEnabled=!1,Ne.getContext()._context.imageSmoothingEnabled=!1),ge.save(),Ue.save(),Je.save(),ge.translate(-M,-X),Ue.translate(-M,-X),Je.translate(-M,-X),Ge.x=M,Ge.y=X,this._isUnderCache=!0,this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(d),this.drawScene(xe,this,Ge),this.drawHit(le,this),this._isUnderCache=!1,ge.restore(),Ue.restore(),Z&&(ge.save(),ge.beginPath(),ge.rect(0,0,V,q),ge.closePath(),ge.setAttr("strokeStyle","red"),ge.setAttr("lineWidth",5),ge.stroke(),ge.restore()),this._cache.set(f,{scene:xe,filter:Ne,hit:le,buffer:Ge,x:M,y:X}),this._requestDraw(),this}isCached(){return this._cache.has(f)}getClientRect(B){throw new Error('abstract "getClientRect" method call')}_transformedRect(B,z){const U=[{x:B.x,y:B.y},{x:B.x+B.width,y:B.y},{x:B.x+B.width,y:B.y+B.height},{x:B.x,y:B.y+B.height}];let V=1/0,q=1/0,L=-1/0,M=-1/0;const X=this.getAbsoluteTransform(z);return U.forEach(function(K){const Z=X.point(K);V===void 0&&(V=L=Z.x,q=M=Z.y),V=Math.min(V,Z.x),q=Math.min(q,Z.y),L=Math.max(L,Z.x),M=Math.max(M,Z.y)}),{x:V,y:q,width:L-V,height:M-q}}_drawCachedSceneCanvas(B){B.save(),B._applyOpacity(this),B._applyGlobalCompositeOperation(this);const z=this._getCanvasCache();B.translate(z.x,z.y);const U=this._getCachedSceneCanvas(),V=U.pixelRatio;B.drawImage(U._canvas,0,0,U.width/V,U.height/V),B.restore()}_drawCachedHitCanvas(B){const z=this._getCanvasCache(),U=z.hit;B.save(),B.translate(z.x,z.y),B.drawImage(U._canvas,0,0,U.width/U.pixelRatio,U.height/U.pixelRatio),B.restore()}_getCachedSceneCanvas(){let B=this.filters(),z=this._getCanvasCache(),U=z.scene,V=z.filter,q=V.getContext(),L,M,X,K;if(B){if(!this._filterUpToDate){const Z=U.pixelRatio;V.setSize(U.width/U.pixelRatio,U.height/U.pixelRatio);try{for(L=B.length,q.clear(),q.drawImage(U._canvas,0,0,U.getWidth()/Z,U.getHeight()/Z),M=q.getImageData(0,0,V.getWidth(),V.getHeight()),X=0;X<L;X++){if(K=B[X],typeof K!="function"){s.Util.error("Filter should be type of function, but got "+typeof K+" instead. Please check correct filters");continue}K.call(this,M),q.putImageData(M,0,0)}}catch(J){s.Util.error("Unable to apply filter. "+J.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return V}return U}on(B,z){if(this._cache&&this._cache.delete(l),arguments.length===3)return this._delegate.apply(this,arguments);const U=B.split(R);for(let V=0;V<U.length;V++){const L=U[V].split("."),M=L[0],X=L[1]||"";this.eventListeners[M]||(this.eventListeners[M]=[]),this.eventListeners[M].push({name:X,handler:z})}return this}off(B,z){let U=(B||"").split(R),V=U.length,q,L,M,X,K,Z;if(this._cache&&this._cache.delete(l),!B)for(L in this.eventListeners)this._off(L);for(q=0;q<V;q++)if(M=U[q],X=M.split("."),K=X[0],Z=X[1],K)this.eventListeners[K]&&this._off(K,Z,z);else for(L in this.eventListeners)this._off(L,Z,z);return this}dispatchEvent(B){const z={target:this,type:B.type,evt:B};return this.fire(B.type,z),this}addEventListener(B,z){return this.on(B,function(U){z.call(this,U.evt)}),this}removeEventListener(B){return this.off(B),this}_delegate(B,z,U){const V=this;this.on(B,function(q){const L=q.target.findAncestors(z,!0,V);for(let M=0;M<L.length;M++)q=s.Util.cloneObject(q),q.currentTarget=L[M],U.call(L[M],q)})}remove(){return this.isDragging()&&this.stopDrag(),t.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(d),this._clearSelfAndDescendantCache(E),this._clearSelfAndDescendantCache(G),this._clearSelfAndDescendantCache(v)}_remove(){this._clearCaches();const B=this.getParent();B&&B.children&&(B.children.splice(this.index,1),B._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(B){const z="get"+s.Util._capitalize(B);return s.Util._isFunction(this[z])?this[z]():this.attrs[B]}getAncestors(){let B=this.getParent(),z=[];for(;B;)z.push(B),B=B.getParent();return z}getAttrs(){return this.attrs||{}}setAttrs(B){return this._batchTransformChanges(()=>{let z,U;if(!B)return this;for(z in B)z!==g&&(U=A+s.Util._capitalize(z),s.Util._isFunction(this[U])?this[U](B[z]):this._setAttr(z,B[z]))}),this}isListening(){return this._getCache(v,this._isListening)}_isListening(B){if(!this.listening())return!1;const U=this.getParent();return U&&U!==B&&this!==B?U._isListening(B):!0}isVisible(){return this._getCache(G,this._isVisible)}_isVisible(B){if(!this.visible())return!1;const U=this.getParent();return U&&U!==B&&this!==B?U._isVisible(B):!0}shouldDrawHit(B,z=!1){if(B)return this._isVisible(B)&&this._isListening(B);const U=this.getLayer();let V=!1;t.DD._dragElements.forEach(L=>{L.dragStatus==="dragging"&&(L.node.nodeType==="Stage"||L.node.getLayer()===U)&&(V=!0)});const q=!z&&!n.Konva.hitOnDragEnabled&&(V||n.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!q}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let B=this.getDepth(),z=this,U=0,V,q,L,M;function X(Z){for(V=[],q=Z.length,L=0;L<q;L++)M=Z[L],U++,M.nodeType!==F&&(V=V.concat(M.getChildren().slice())),M._id===z._id&&(L=q);V.length>0&&V[0].getDepth()<=B&&X(V)}const K=this.getStage();return z.nodeType!==I&&K&&X(K.getChildren()),U}getDepth(){let B=0,z=this.parent;for(;z;)B++,z=z.parent;return B}_batchTransformChanges(B){this._batchingTransformChange=!0,B(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(D),this._clearSelfAndDescendantCache(c)),this._needClearTransformCache=!1}setPosition(B){return this._batchTransformChanges(()=>{this.x(B.x),this.y(B.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const B=this.getStage();if(!B)return null;const z=B.getPointerPosition();if(!z)return null;const U=this.getAbsoluteTransform().copy();return U.invert(),U.point(z)}getAbsolutePosition(B){let z=!1,U=this.parent;for(;U;){if(U.isCached()){z=!0;break}U=U.parent}z&&!B&&(B=!0);const V=this.getAbsoluteTransform(B).getMatrix(),q=new s.Transform,L=this.offset();return q.m=V.slice(),q.translate(L.x,L.y),q.getTranslation()}setAbsolutePosition(B){const{x:z,y:U,...V}=this._clearTransform();this.attrs.x=z,this.attrs.y=U,this._clearCache(D);const q=this._getAbsoluteTransform().copy();return q.invert(),q.translate(B.x,B.y),B={x:this.attrs.x+q.getTranslation().x,y:this.attrs.y+q.getTranslation().y},this._setTransform(V),this.setPosition({x:B.x,y:B.y}),this._clearCache(D),this._clearSelfAndDescendantCache(c),this}_setTransform(B){let z;for(z in B)this.attrs[z]=B[z]}_clearTransform(){const B={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,B}move(B){let z=B.x,U=B.y,V=this.x(),q=this.y();return z!==void 0&&(V+=z),U!==void 0&&(q+=U),this.setPosition({x:V,y:q}),this}_eachAncestorReverse(B,z){let U=[],V=this.getParent(),q,L;if(!(z&&z._id===this._id)){for(U.unshift(this);V&&(!z||V._id!==z._id);)U.unshift(V),V=V.parent;for(q=U.length,L=0;L<q;L++)B(U[L])}}rotate(B){return this.rotation(this.rotation()+B),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const B=this.index,z=this.parent.getChildren().length;return B<z-1?(this.parent.children.splice(B,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const B=this.index,z=this.parent.getChildren().length;return B<z-1?(this.parent.children.splice(B,1),this.parent.children.splice(B+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const B=this.index;return B>0?(this.parent.children.splice(B,1),this.parent.children.splice(B-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const B=this.index;return B>0?(this.parent.children.splice(B,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(B){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(B<0||B>=this.parent.children.length)&&s.Util.warn("Unexpected value "+B+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const z=this.index;return this.parent.children.splice(z,1),this.parent.children.splice(B,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(i,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let B=this.opacity();const z=this.getParent();return z&&!z._isUnderCache&&(B*=z.getAbsoluteOpacity()),B}moveTo(B){return this.getParent()!==B&&(this._remove(),B.add(this)),this}toObject(){let B=this.getAttrs(),z,U,V,q,L;const M={attrs:{},className:this.getClassName()};for(z in B)U=B[z],L=s.Util.isObject(U)&&!s.Util._isPlainObject(U)&&!s.Util._isArray(U),!L&&(V=typeof this[z]=="function"&&this[z],delete B[z],q=V?V.call(this):null,B[z]=U,q!==U&&(M.attrs[z]=U));return s.Util._prepareToStringify(M)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(B,z,U){const V=[];z&&this._isMatch(B)&&V.push(this);let q=this.parent;for(;q;){if(q===U)return V;q._isMatch(B)&&V.push(q),q=q.parent}return V}isAncestorOf(B){return!1}findAncestor(B,z,U){return this.findAncestors(B,z,U)[0]}_isMatch(B){if(!B)return!1;if(typeof B=="function")return B(this);let z=B.replace(/ /g,"").split(","),U=z.length,V,q;for(V=0;V<U;V++)if(q=z[V],s.Util.isValidSelector(q)||(s.Util.warn('Selector "'+q+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),q.charAt(0)==="#"){if(this.id()===q.slice(1))return!0}else if(q.charAt(0)==="."){if(this.hasName(q.slice(1)))return!0}else if(this.className===q||this.nodeType===q)return!0;return!1}getLayer(){const B=this.getParent();return B?B.getLayer():null}getStage(){return this._getCache(E,this._getStage)}_getStage(){const B=this.getParent();return B?B.getStage():null}fire(B,z={},U){return z.target=z.target||this,U?this._fireAndBubble(B,z):this._fire(B,z),this}getAbsoluteTransform(B){return B?this._getAbsoluteTransform(B):this._getCache(c,this._getAbsoluteTransform)}_getAbsoluteTransform(B){let z;if(B)return z=new s.Transform,this._eachAncestorReverse(function(U){const V=U.transformsEnabled();V==="all"?z.multiply(U.getTransform()):V==="position"&&z.translate(U.x()-U.offsetX(),U.y()-U.offsetY())},B),z;{z=this._cache.get(c)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(z):z.reset();const U=this.transformsEnabled();if(U==="all")z.multiply(this.getTransform());else if(U==="position"){const V=this.attrs.x||0,q=this.attrs.y||0,L=this.attrs.offsetX||0,M=this.attrs.offsetY||0;z.translate(V-L,q-M)}return z.dirty=!1,z}}getAbsoluteScale(B){let z=this;for(;z;)z._isUnderCache&&(B=z),z=z.getParent();const V=this.getAbsoluteTransform(B).decompose();return{x:V.scaleX,y:V.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(D,this._getTransform)}_getTransform(){var B,z;const U=this._cache.get(D)||new s.Transform;U.reset();const V=this.x(),q=this.y(),L=n.Konva.getAngle(this.rotation()),M=(B=this.attrs.scaleX)!==null&&B!==void 0?B:1,X=(z=this.attrs.scaleY)!==null&&z!==void 0?z:1,K=this.attrs.skewX||0,Z=this.attrs.skewY||0,J=this.attrs.offsetX||0,ne=this.attrs.offsetY||0;return(V!==0||q!==0)&&U.translate(V,q),L!==0&&U.rotate(L),(K!==0||Z!==0)&&U.skew(K,Z),(M!==1||X!==1)&&U.scale(M,X),(J!==0||ne!==0)&&U.translate(-1*J,-1*ne),U.dirty=!1,U}clone(B){let z=s.Util.cloneObject(this.attrs),U,V,q,L,M;for(U in B)z[U]=B[U];const X=new this.constructor(z);for(U in this.eventListeners)for(V=this.eventListeners[U],q=V.length,L=0;L<q;L++)M=V[L],M.name.indexOf(y)<0&&(X.eventListeners[U]||(X.eventListeners[U]=[]),X.eventListeners[U].push(M));return X}_toKonvaCanvas(B){B=B||{};const z=this.getClientRect(),U=this.getStage(),V=B.x!==void 0?B.x:Math.floor(z.x),q=B.y!==void 0?B.y:Math.floor(z.y),L=B.pixelRatio||1,M=new e.SceneCanvas({width:B.width||Math.ceil(z.width)||(U?U.width():0),height:B.height||Math.ceil(z.height)||(U?U.height():0),pixelRatio:L}),X=M.getContext(),K=new e.SceneCanvas({width:M.width/M.pixelRatio+Math.abs(V),height:M.height/M.pixelRatio+Math.abs(q),pixelRatio:M.pixelRatio});return B.imageSmoothingEnabled===!1&&(X._context.imageSmoothingEnabled=!1),X.save(),(V||q)&&X.translate(-1*V,-1*q),this.drawScene(M,void 0,K),X.restore(),M}toCanvas(B){return this._toKonvaCanvas(B)._canvas}toDataURL(B){B=B||{};const z=B.mimeType||null,U=B.quality||null,V=this._toKonvaCanvas(B).toDataURL(z,U);return B.callback&&B.callback(V),V}toImage(B){return new Promise((z,U)=>{try{const V=B?.callback;V&&delete B.callback,s.Util._urlToImage(this.toDataURL(B),function(q){z(q),V?.(q)})}catch(V){U(V)}})}toBlob(B){return new Promise((z,U)=>{try{const V=B?.callback;V&&delete B.callback,this.toCanvas(B).toBlob(q=>{z(q),V?.(q)},B?.mimeType,B?.quality)}catch(V){U(V)}})}setSize(B){return this.width(B.width),this.height(B.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():n.Konva.dragDistance}_off(B,z,U){let V=this.eventListeners[B],q,L,M;for(q=0;q<V.length;q++)if(L=V[q].name,M=V[q].handler,(L!=="konva"||z==="konva")&&(!z||L===z)&&(!U||U===M)){if(V.splice(q,1),V.length===0){delete this.eventListeners[B];break}q--}}_fireChangeEvent(B,z,U){this._fire(B+p,{oldVal:z,newVal:U})}addName(B){if(!this.hasName(B)){const z=this.name(),U=z?z+" "+B:B;this.name(U)}return this}hasName(B){if(!B)return!1;const z=this.name();return z?(z||"").split(/\s/g).indexOf(B)!==-1:!1}removeName(B){const z=(this.name()||"").split(/\s/g),U=z.indexOf(B);return U!==-1&&(z.splice(U,1),this.name(z.join(" "))),this}setAttr(B,z){const U=this[A+s.Util._capitalize(B)];return s.Util._isFunction(U)?U.call(this,z):this._setAttr(B,z),this}_requestDraw(){if(n.Konva.autoDrawEnabled){const B=this.getLayer()||this.getStage();B?.batchDraw()}}_setAttr(B,z){const U=this.attrs[B];U===z&&!s.Util.isObject(z)||(z==null?delete this.attrs[B]:this.attrs[B]=z,this._shouldFireChangeEvents&&this._fireChangeEvent(B,U,z),this._requestDraw())}_setComponentAttr(B,z,U){let V;U!==void 0&&(V=this.attrs[B],V||(this.attrs[B]=this.getAttr(B)),this.attrs[B][z]=U,this._fireChangeEvent(B,V,U))}_fireAndBubble(B,z,U){z&&this.nodeType===F&&(z.target=this);const V=[_,b,N,k,w,T];if(!(V.indexOf(B)!==-1&&(U&&(this===U||this.isAncestorOf&&this.isAncestorOf(U))||this.nodeType==="Stage"&&!U))){this._fire(B,z);const L=V.indexOf(B)!==-1&&U&&U.isAncestorOf&&U.isAncestorOf(this)&&!U.isAncestorOf(this.parent);(z&&!z.cancelBubble||!z)&&this.parent&&this.parent.isListening()&&!L&&(U&&U.parent?this._fireAndBubble.call(this.parent,B,z,U):this._fireAndBubble.call(this.parent,B,z))}}_getProtoListeners(B){var z,U,V;const q=(z=this._cache.get(l))!==null&&z!==void 0?z:{};let L=q?.[B];if(L===void 0){L=[];let M=Object.getPrototypeOf(this);for(;M;){const X=(V=(U=M.eventListeners)===null||U===void 0?void 0:U[B])!==null&&V!==void 0?V:[];L.push(...X),M=Object.getPrototypeOf(M)}q[B]=L,this._cache.set(l,q)}return L}_fire(B,z){z=z||{},z.currentTarget=this,z.type=B;const U=this._getProtoListeners(B);if(U)for(let q=0;q<U.length;q++)U[q].handler.call(this,z);const V=this.eventListeners[B];if(V)for(let q=0;q<V.length;q++)V[q].handler.call(this,z)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(B){const z=B?B.pointerId:void 0,U=this.getStage(),V=this.getAbsolutePosition();if(!U)return;const q=U._getPointerById(z)||U._changedPointerPositions[0]||V;t.DD._dragElements.set(this._id,{node:this,startPointerPos:q,offset:{x:q.x-V.x,y:q.y-V.y},dragStatus:"ready",pointerId:z})}startDrag(B,z=!0){t.DD._dragElements.has(this._id)||this._createDragElement(B);const U=t.DD._dragElements.get(this._id);U.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:B&&B.evt},z)}_setDragPosition(B,z){const U=this.getStage()._getPointerById(z.pointerId);if(!U)return;let V={x:U.x-z.offset.x,y:U.y-z.offset.y};const q=this.dragBoundFunc();if(q!==void 0){const L=q.call(this,V,B);L?V=L:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==V.x||this._lastPos.y!==V.y)&&(this.setAbsolutePosition(V),this._requestDraw()),this._lastPos=V}stopDrag(B){const z=t.DD._dragElements.get(this._id);z&&(z.dragStatus="stopped"),t.DD._endDragBefore(B),t.DD._endDragAfter(B)}setDraggable(B){this._setAttr("draggable",B),this._dragChange()}isDragging(){const B=t.DD._dragElements.get(this._id);return B?B.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(B){if(!(!(B.evt.button!==void 0)||n.Konva.dragButtons.indexOf(B.evt.button)>=0)||this.isDragging())return;let V=!1;t.DD._dragElements.forEach(q=>{this.isAncestorOf(q.node)&&(V=!0)}),V||this._createDragElement(B)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const z=t.DD._dragElements.get(this._id),U=z&&z.dragStatus==="dragging",V=z&&z.dragStatus==="ready";U?this.stopDrag():V&&t.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(B={x:0,y:0}){const z=this.getStage();if(!z)return!1;const U={x:-B.x,y:-B.y,width:z.width()+2*B.x,height:z.height()+2*B.y};return s.Util.haveIntersection(U,this.getClientRect())}static create(B,z){return s.Util._isString(B)&&(B=JSON.parse(B)),this._createNode(B,z)}static _createNode(B,z){let U=k_.prototype.getClassName.call(B),V=B.children,q,L,M;z&&(B.attrs.container=z),n.Konva[U]||(s.Util.warn('Can not find a node with class name "'+U+'". Fallback to "Shape".'),U="Shape");const X=n.Konva[U];if(q=new X(B.attrs),V)for(L=V.length,M=0;M<L;M++)q.add(k_._createNode(V[M]));return q}};Ag.Node=ie,ie.prototype.nodeType="Node",ie.prototype._attrsAffectingSize=[],ie.prototype.eventListeners={},ie.prototype.on.call(ie.prototype,Y,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(D),this._clearSelfAndDescendantCache(c)}),ie.prototype.on.call(ie.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(G)}),ie.prototype.on.call(ie.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(v)}),ie.prototype.on.call(ie.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(i)});const re=r.Factory.addGetterSetter;return re(ie,"zIndex"),re(ie,"absolutePosition"),re(ie,"position"),re(ie,"x",0,(0,a.getNumberValidator)()),re(ie,"y",0,(0,a.getNumberValidator)()),re(ie,"globalCompositeOperation","source-over",(0,a.getStringValidator)()),re(ie,"opacity",1,(0,a.getNumberValidator)()),re(ie,"name","",(0,a.getStringValidator)()),re(ie,"id","",(0,a.getStringValidator)()),re(ie,"rotation",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(ie,"scale",["x","y"]),re(ie,"scaleX",1,(0,a.getNumberValidator)()),re(ie,"scaleY",1,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(ie,"skew",["x","y"]),re(ie,"skewX",0,(0,a.getNumberValidator)()),re(ie,"skewY",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(ie,"offset",["x","y"]),re(ie,"offsetX",0,(0,a.getNumberValidator)()),re(ie,"offsetY",0,(0,a.getNumberValidator)()),re(ie,"dragDistance",void 0,(0,a.getNumberValidator)()),re(ie,"width",0,(0,a.getNumberValidator)()),re(ie,"height",0,(0,a.getNumberValidator)()),re(ie,"listening",!0,(0,a.getBooleanValidator)()),re(ie,"preventDefault",!0,(0,a.getBooleanValidator)()),re(ie,"filters",void 0,function(se){return this._filterUpToDate=!1,se}),re(ie,"visible",!0,(0,a.getBooleanValidator)()),re(ie,"transformsEnabled","all",(0,a.getStringValidator)()),re(ie,"size"),re(ie,"dragBoundFunc"),re(ie,"draggable",!1,(0,a.getBooleanValidator)()),r.Factory.backCompat(ie,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Ag}var jg={},aT;function M1(){if(aT)return jg;aT=1,Object.defineProperty(jg,"__esModule",{value:!0}),jg.Container=void 0;const e=Kr(),t=Ts(),r=Xr();let n=class extends t.Node{constructor(){super(...arguments),this.children=[]}getChildren(a){const i=this.children||[];return a?i.filter(a):i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.destroy()}),this.children=[],this._requestDraw(),this}add(...a){if(a.length===0)return this;if(a.length>1){for(let l=0;l<a.length;l++)this.add(a[l]);return this}const i=a[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(a){return this._generalFind(a,!1)}findOne(a){const i=this._generalFind(a,!0);return i.length>0?i[0]:void 0}_generalFind(a,i){const l=[];return this._descendants(c=>{const d=c._isMatch(a);return d&&l.push(c),!!(d&&i)}),l}_descendants(a){let i=!1;const l=this.getChildren();for(const c of l){if(i=a(c),i)return!0;if(c.hasChildren()&&(i=c._descendants(a),i))return!0}return!1}toObject(){const a=t.Node.prototype.toObject.call(this);return a.children=[],this.getChildren().forEach(i=>{a.children.push(i.toObject())}),a}isAncestorOf(a){let i=a.getParent();for(;i;){if(i._id===this._id)return!0;i=i.getParent()}return!1}clone(a){const i=t.Node.prototype.clone.call(this,a);return this.getChildren().forEach(function(l){i.add(l.clone())}),i}getAllIntersections(a){const i=[];return this.find("Shape").forEach(l=>{l.isVisible()&&l.intersects(a)&&i.push(l)}),i}_clearSelfAndDescendantCache(a){var i;super._clearSelfAndDescendantCache(a),!this.isCached()&&((i=this.children)===null||i===void 0||i.forEach(function(l){l._clearSelfAndDescendantCache(a)}))}_setChildrenIndices(){var a;(a=this.children)===null||a===void 0||a.forEach(function(i,l){i.index=l}),this._requestDraw()}drawScene(a,i,l){const c=this.getLayer(),d=a||c&&c.getCanvas(),f=d&&d.getContext(),p=this._getCanvasCache(),g=p&&p.scene,y=d&&d.isCache;if(!this.isVisible()&&!y)return this;if(g){f.save();const v=this.getAbsoluteTransform(i).getMatrix();f.transform(v[0],v[1],v[2],v[3],v[4],v[5]),this._drawCachedSceneCanvas(f),f.restore()}else this._drawChildren("drawScene",d,i,l);return this}drawHit(a,i){if(!this.shouldDrawHit(i))return this;const l=this.getLayer(),c=a||l&&l.hitCanvas,d=c&&c.getContext(),f=this._getCanvasCache();if(f&&f.hit){d.save();const g=this.getAbsoluteTransform(i).getMatrix();d.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(d),d.restore()}else this._drawChildren("drawHit",c,i);return this}_drawChildren(a,i,l,c){var d;const f=i&&i.getContext(),p=this.clipWidth(),g=this.clipHeight(),y=this.clipFunc(),v=typeof p=="number"&&typeof g=="number"||y,_=l===this;if(v){f.save();const N=this.getAbsoluteTransform(l);let k=N.getMatrix();f.transform(k[0],k[1],k[2],k[3],k[4],k[5]),f.beginPath();let w;if(y)w=y.call(this,f,this);else{const T=this.clipX(),A=this.clipY();f.rect(T||0,A||0,p,g)}f.clip.apply(f,w),k=N.copy().invert().getMatrix(),f.transform(k[0],k[1],k[2],k[3],k[4],k[5])}const b=!_&&this.globalCompositeOperation()!=="source-over"&&a==="drawScene";b&&(f.save(),f._applyGlobalCompositeOperation(this)),(d=this.children)===null||d===void 0||d.forEach(function(N){N[a](i,l,c)}),b&&f.restore(),v&&f.restore()}getClientRect(a={}){var i;const l=a.skipTransform,c=a.relativeTo;let d,f,p,g,y={x:1/0,y:1/0,width:0,height:0};const v=this;(i=this.children)===null||i===void 0||i.forEach(function(N){if(!N.visible())return;const k=N.getClientRect({relativeTo:v,skipShadow:a.skipShadow,skipStroke:a.skipStroke});k.width===0&&k.height===0||(d===void 0?(d=k.x,f=k.y,p=k.x+k.width,g=k.y+k.height):(d=Math.min(d,k.x),f=Math.min(f,k.y),p=Math.max(p,k.x+k.width),g=Math.max(g,k.y+k.height)))});const _=this.find("Shape");let b=!1;for(let N=0;N<_.length;N++)if(_[N]._isVisible(this)){b=!0;break}return b&&d!==void 0?y={x:d,y:f,width:p-d,height:g-f}:y={x:0,y:0,width:0,height:0},l?y:this._transformedRect(y,c)}};return jg.Container=n,e.Factory.addComponentsGetterSetter(n,"clip",["x","y","width","height"]),e.Factory.addGetterSetter(n,"clipX",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipY",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipWidth",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipHeight",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipFunc"),jg}var fw={},bu={},iT;function b6(){if(iT)return bu;iT=1,Object.defineProperty(bu,"__esModule",{value:!0}),bu.getCapturedShape=n,bu.createEvent=s,bu.hasPointerCapture=a,bu.setPointerCapture=i,bu.releaseCapture=l;const e=$r(),t=new Map,r=e.Konva._global.PointerEvent!==void 0;function n(c){return t.get(c)}function s(c){return{evt:c,pointerId:c.pointerId}}function a(c,d){return t.get(c)===d}function i(c,d){l(c),d.getStage()&&(t.set(c,d),r&&d._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function l(c,d){const f=t.get(c);if(!f)return;const p=f.getStage();p&&p.content,t.delete(c),r&&f._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return bu}var oT;function pM(){return oT||(oT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const t=ms(),r=Kr(),n=M1(),s=$r(),a=I1(),i=sb(),l=$r(),c=b6(),d="Stage",f="string",p="px",g="mouseout",y="mouseleave",v="mouseover",_="mouseenter",b="mousemove",N="mousedown",k="mouseup",w="pointermove",T="pointerdown",A="pointerup",F="pointercancel",R="lostpointercapture",E="pointerout",D="pointerleave",I="pointerover",G="pointerenter",Y="contextmenu",ee="touchstart",ie="touchend",re="touchmove",se="touchcancel",B="wheel",z=5,U=[[_,"_pointerenter"],[N,"_pointerdown"],[b,"_pointermove"],[k,"_pointerup"],[y,"_pointerleave"],[ee,"_pointerdown"],[re,"_pointermove"],[ie,"_pointerup"],[se,"_pointercancel"],[v,"_pointerover"],[B,"_wheel"],[Y,"_contextmenu"],[T,"_pointerdown"],[w,"_pointermove"],[A,"_pointerup"],[F,"_pointercancel"],[D,"_pointerleave"],[R,"_lostpointercapture"]],V={mouse:{[E]:g,[D]:y,[I]:v,[G]:_,[w]:b,[T]:N,[A]:k,[F]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[E]:"touchout",[D]:"touchleave",[I]:"touchover",[G]:"touchenter",[w]:re,[T]:ee,[A]:ie,[F]:se,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[E]:E,[D]:D,[I]:I,[G]:G,[w]:w,[T]:T,[A]:A,[F]:F,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},q=Z=>Z.indexOf("pointer")>=0?"pointer":Z.indexOf("touch")>=0?"touch":"mouse",L=Z=>{const J=q(Z);if(J==="pointer")return s.Konva.pointerEventsEnabled&&V.pointer;if(J==="touch")return V.touch;if(J==="mouse")return V.mouse};function M(Z={}){return(Z.clipFunc||Z.clipWidth||Z.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),Z}const X="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class K extends n.Container{constructor(J){super(M(J)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{M(this.attrs)}),this._checkVisibility()}_validateAdd(J){const ne=J.getType()==="Layer",me=J.getType()==="FastLayer";ne||me||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const J=this.visible()?"":"none";this.content.style.display=J}setContainer(J){if(typeof J===f){let ne;if(J.charAt(0)==="."){const me=J.slice(1);J=document.getElementsByClassName(me)[0]}else J.charAt(0)!=="#"?ne=J:ne=J.slice(1),J=document.getElementById(ne);if(!J)throw"Can not find container in document with id "+ne}return this._setAttr("container",J),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),J.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const J=this.children,ne=J.length;for(let me=0;me<ne;me++)J[me].clear();return this}clone(J){return J||(J={}),J.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,J)}destroy(){super.destroy();const J=this.content;J&&t.Util._isInDocument(J)&&this.container().removeChild(J);const ne=e.stages.indexOf(this);return ne>-1&&e.stages.splice(ne,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const J=this._pointerPositions[0]||this._changedPointerPositions[0];return J?{x:J.x,y:J.y}:(t.Util.warn(X),null)}_getPointerById(J){return this._pointerPositions.find(ne=>ne.id===J)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(J){J=J||{},J.x=J.x||0,J.y=J.y||0,J.width=J.width||this.width(),J.height=J.height||this.height();const ne=new a.SceneCanvas({width:J.width,height:J.height,pixelRatio:J.pixelRatio||1}),me=ne.getContext()._context,xe=this.children;return(J.x||J.y)&&me.translate(-1*J.x,-1*J.y),xe.forEach(function(Ne){if(!Ne.isVisible())return;const le=Ne._toKonvaCanvas(J);me.drawImage(le._canvas,J.x,J.y,le.getWidth()/le.getPixelRatio(),le.getHeight()/le.getPixelRatio())}),ne}getIntersection(J){if(!J)return null;const ne=this.children,me=ne.length,xe=me-1;for(let Ne=xe;Ne>=0;Ne--){const le=ne[Ne].getIntersection(J);if(le)return le}return null}_resizeDOM(){const J=this.width(),ne=this.height();this.content&&(this.content.style.width=J+p,this.content.style.height=ne+p),this.bufferCanvas.setSize(J,ne),this.bufferHitCanvas.setSize(J,ne),this.children.forEach(me=>{me.setSize({width:J,height:ne}),me.draw()})}add(J,...ne){if(arguments.length>1){for(let xe=0;xe<arguments.length;xe++)this.add(arguments[xe]);return this}super.add(J);const me=this.children.length;return me>z&&t.Util.warn("The stage has "+me+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),J.setSize({width:this.width(),height:this.height()}),J.draw(),s.Konva.isBrowser&&this.content.appendChild(J.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(J){return c.hasPointerCapture(J,this)}setPointerCapture(J){c.setPointerCapture(J,this)}releaseCapture(J){c.releaseCapture(J,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&U.forEach(([J,ne])=>{this.content.addEventListener(J,me=>{this[ne](me)},{passive:!1})})}_pointerenter(J){this.setPointersPositions(J);const ne=L(J.type);ne&&this._fire(ne.pointerenter,{evt:J,target:this,currentTarget:this})}_pointerover(J){this.setPointersPositions(J);const ne=L(J.type);ne&&this._fire(ne.pointerover,{evt:J,target:this,currentTarget:this})}_getTargetShape(J){let ne=this[J+"targetShape"];return ne&&!ne.getStage()&&(ne=null),ne}_pointerleave(J){const ne=L(J.type),me=q(J.type);if(!ne)return;this.setPointersPositions(J);const xe=this._getTargetShape(me),Ne=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;xe&&Ne?(xe._fireAndBubble(ne.pointerout,{evt:J}),xe._fireAndBubble(ne.pointerleave,{evt:J}),this._fire(ne.pointerleave,{evt:J,target:this,currentTarget:this}),this[me+"targetShape"]=null):Ne&&(this._fire(ne.pointerleave,{evt:J,target:this,currentTarget:this}),this._fire(ne.pointerout,{evt:J,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(J){const ne=L(J.type),me=q(J.type);if(!ne)return;this.setPointersPositions(J);let xe=!1;this._changedPointerPositions.forEach(Ne=>{const le=this.getIntersection(Ne);if(i.DD.justDragged=!1,s.Konva["_"+me+"ListenClick"]=!0,!le||!le.isListening()){this[me+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&le.setPointerCapture(Ne.id),this[me+"ClickStartShape"]=le,le._fireAndBubble(ne.pointerdown,{evt:J,pointerId:Ne.id}),xe=!0;const ge=J.type.indexOf("touch")>=0;le.preventDefault()&&J.cancelable&&ge&&J.preventDefault()}),xe||this._fire(ne.pointerdown,{evt:J,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(J){const ne=L(J.type),me=q(J.type);if(!ne||(s.Konva.isDragging()&&i.DD.node.preventDefault()&&J.cancelable&&J.preventDefault(),this.setPointersPositions(J),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const Ne={};let le=!1;const ge=this._getTargetShape(me);this._changedPointerPositions.forEach(Ue=>{const Ge=c.getCapturedShape(Ue.id)||this.getIntersection(Ue),Je=Ue.id,He={evt:J,pointerId:Je},Ft=ge!==Ge;if(Ft&&ge&&(ge._fireAndBubble(ne.pointerout,{...He},Ge),ge._fireAndBubble(ne.pointerleave,{...He},Ge)),Ge){if(Ne[Ge._id])return;Ne[Ge._id]=!0}Ge&&Ge.isListening()?(le=!0,Ft&&(Ge._fireAndBubble(ne.pointerover,{...He},ge),Ge._fireAndBubble(ne.pointerenter,{...He},ge),this[me+"targetShape"]=Ge),Ge._fireAndBubble(ne.pointermove,{...He})):ge&&(this._fire(ne.pointerover,{evt:J,target:this,currentTarget:this,pointerId:Je}),this[me+"targetShape"]=null)}),le||this._fire(ne.pointermove,{evt:J,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(J){const ne=L(J.type),me=q(J.type);if(!ne)return;this.setPointersPositions(J);const xe=this[me+"ClickStartShape"],Ne=this[me+"ClickEndShape"],le={};let ge=!1;this._changedPointerPositions.forEach(Ue=>{const Ge=c.getCapturedShape(Ue.id)||this.getIntersection(Ue);if(Ge){if(Ge.releaseCapture(Ue.id),le[Ge._id])return;le[Ge._id]=!0}const Je=Ue.id,He={evt:J,pointerId:Je};let Ft=!1;s.Konva["_"+me+"InDblClickWindow"]?(Ft=!0,clearTimeout(this[me+"DblTimeout"])):i.DD.justDragged||(s.Konva["_"+me+"InDblClickWindow"]=!0,clearTimeout(this[me+"DblTimeout"])),this[me+"DblTimeout"]=setTimeout(function(){s.Konva["_"+me+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),Ge&&Ge.isListening()?(ge=!0,this[me+"ClickEndShape"]=Ge,Ge._fireAndBubble(ne.pointerup,{...He}),s.Konva["_"+me+"ListenClick"]&&xe&&xe===Ge&&(Ge._fireAndBubble(ne.pointerclick,{...He}),Ft&&Ne&&Ne===Ge&&Ge._fireAndBubble(ne.pointerdblclick,{...He}))):(this[me+"ClickEndShape"]=null,s.Konva["_"+me+"ListenClick"]&&this._fire(ne.pointerclick,{evt:J,target:this,currentTarget:this,pointerId:Je}),Ft&&this._fire(ne.pointerdblclick,{evt:J,target:this,currentTarget:this,pointerId:Je}))}),ge||this._fire(ne.pointerup,{evt:J,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+me+"ListenClick"]=!1,J.cancelable&&me!=="touch"&&me!=="pointer"&&J.preventDefault()}_contextmenu(J){this.setPointersPositions(J);const ne=this.getIntersection(this.getPointerPosition());ne&&ne.isListening()?ne._fireAndBubble(Y,{evt:J}):this._fire(Y,{evt:J,target:this,currentTarget:this})}_wheel(J){this.setPointersPositions(J);const ne=this.getIntersection(this.getPointerPosition());ne&&ne.isListening()?ne._fireAndBubble(B,{evt:J}):this._fire(B,{evt:J,target:this,currentTarget:this})}_pointercancel(J){this.setPointersPositions(J);const ne=c.getCapturedShape(J.pointerId)||this.getIntersection(this.getPointerPosition());ne&&ne._fireAndBubble(A,c.createEvent(J)),c.releaseCapture(J.pointerId)}_lostpointercapture(J){c.releaseCapture(J.pointerId)}setPointersPositions(J){const ne=this._getContentPosition();let me=null,xe=null;J=J||window.event,J.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(J.touches,Ne=>{this._pointerPositions.push({id:Ne.identifier,x:(Ne.clientX-ne.left)/ne.scaleX,y:(Ne.clientY-ne.top)/ne.scaleY})}),Array.prototype.forEach.call(J.changedTouches||J.touches,Ne=>{this._changedPointerPositions.push({id:Ne.identifier,x:(Ne.clientX-ne.left)/ne.scaleX,y:(Ne.clientY-ne.top)/ne.scaleY})})):(me=(J.clientX-ne.left)/ne.scaleX,xe=(J.clientY-ne.top)/ne.scaleY,this.pointerPos={x:me,y:xe},this._pointerPositions=[{x:me,y:xe,id:t.Util._getFirstPointerId(J)}],this._changedPointerPositions=[{x:me,y:xe,id:t.Util._getFirstPointerId(J)}])}_setPointerPosition(J){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(J)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const J=this.content.getBoundingClientRect();return{top:J.top,left:J.left,scaleX:J.width/this.content.clientWidth||1,scaleY:J.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const J=this.container();if(!J)throw"Stage has no container. A container is required.";J.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),J.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(J){J.batchDraw()}),this}}e.Stage=K,K.prototype.nodeType=d,(0,l._registerNode)(K),r.Factory.addGetterSetter(K,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{e.stages.forEach(Z=>{Z.batchDraw()})})})(fw)),fw}var Fg={},hw={},lT;function ua(){return lT||(lT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const t=$r(),r=ms(),n=Kr(),s=Ts(),a=Xr(),i=$r(),l=b6(),c="hasShadow",d="shadowRGBA",f="patternImage",p="linearGradient",g="radialGradient";let y;function v(){return y||(y=r.Util.createCanvasElement().getContext("2d"),y)}e.shapes={};function _(D){const I=this.attrs.fillRule;I?D.fill(I):D.fill()}function b(D){D.stroke()}function N(D){const I=this.attrs.fillRule;I?D.fill(I):D.fill()}function k(D){D.stroke()}function w(){this._clearCache(c)}function T(){this._clearCache(d)}function A(){this._clearCache(f)}function F(){this._clearCache(p)}function R(){this._clearCache(g)}class E extends s.Node{constructor(I){super(I);let G;for(;G=r.Util.getRandomColor(),!(G&&!(G in e.shapes)););this.colorKey=G,e.shapes[G]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(f,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const G=v().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(G&&G.setTransform){const Y=new r.Transform;Y.translate(this.fillPatternX(),this.fillPatternY()),Y.rotate(t.Konva.getAngle(this.fillPatternRotation())),Y.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),Y.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const ee=Y.getMatrix(),ie=typeof DOMMatrix>"u"?{a:ee[0],b:ee[1],c:ee[2],d:ee[3],e:ee[4],f:ee[5]}:new DOMMatrix(ee);G.setTransform(ie)}return G}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){const I=this.fillLinearGradientColorStops();if(I){const G=v(),Y=this.fillLinearGradientStartPoint(),ee=this.fillLinearGradientEndPoint(),ie=G.createLinearGradient(Y.x,Y.y,ee.x,ee.y);for(let re=0;re<I.length;re+=2)ie.addColorStop(I[re],I[re+1]);return ie}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){const I=this.fillRadialGradientColorStops();if(I){const G=v(),Y=this.fillRadialGradientStartPoint(),ee=this.fillRadialGradientEndPoint(),ie=G.createRadialGradient(Y.x,Y.y,this.fillRadialGradientStartRadius(),ee.x,ee.y,this.fillRadialGradientEndRadius());for(let re=0;re<I.length;re+=2)ie.addColorStop(I[re],I[re+1]);return ie}}getShadowRGBA(){return this._getCache(d,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const I=r.Util.colorToRGBA(this.shadowColor());if(I)return"rgba("+I.r+","+I.g+","+I.b+","+I.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const I=this.hitStrokeWidth();return I==="auto"?this.hasStroke():this.strokeEnabled()&&!!I}intersects(I){const G=this.getStage();if(!G)return!1;const Y=G.bufferHitCanvas;return Y.getContext().clear(),this.drawHit(Y,void 0,!0),Y.context.getImageData(Math.round(I.x),Math.round(I.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(I){var G;if(!((G=this.attrs.perfectDrawEnabled)!==null&&G!==void 0?G:!0))return!1;const ee=I||this.hasFill(),ie=this.hasStroke(),re=this.getAbsoluteOpacity()!==1;if(ee&&ie&&re)return!0;const se=this.hasShadow(),B=this.shadowForStrokeEnabled();return!!(ee&&ie&&se&&B)}setStrokeHitEnabled(I){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),I?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const I=this.size();return{x:this._centroid?-I.width/2:0,y:this._centroid?-I.height/2:0,width:I.width,height:I.height}}getClientRect(I={}){let G=!1,Y=this.getParent();for(;Y;){if(Y.isCached()){G=!0;break}Y=Y.getParent()}const ee=I.skipTransform,ie=I.relativeTo||G&&this.getStage()||void 0,re=this.getSelfRect(),B=!I.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,z=re.width+B,U=re.height+B,V=!I.skipShadow&&this.hasShadow(),q=V?this.shadowOffsetX():0,L=V?this.shadowOffsetY():0,M=z+Math.abs(q),X=U+Math.abs(L),K=V&&this.shadowBlur()||0,Z=M+K*2,J=X+K*2,ne={width:Z,height:J,x:-(B/2+K)+Math.min(q,0)+re.x,y:-(B/2+K)+Math.min(L,0)+re.y};return ee?ne:this._transformedRect(ne,ie)}drawScene(I,G,Y){const ee=this.getLayer(),ie=I||ee.getCanvas(),re=ie.getContext(),se=this._getCanvasCache(),B=this.getSceneFunc(),z=this.hasShadow();let U;const V=G===this;if(!this.isVisible()&&!V)return this;if(se){re.save();const q=this.getAbsoluteTransform(G).getMatrix();return re.transform(q[0],q[1],q[2],q[3],q[4],q[5]),this._drawCachedSceneCanvas(re),re.restore(),this}if(!B)return this;if(re.save(),this._useBufferCanvas()){U=this.getStage();const q=Y||U.bufferCanvas,L=q.getContext();L.clear(),L.save(),L._applyLineJoin(this);const M=this.getAbsoluteTransform(G).getMatrix();L.transform(M[0],M[1],M[2],M[3],M[4],M[5]),B.call(this,L,this),L.restore();const X=q.pixelRatio;z&&re._applyShadow(this),re._applyOpacity(this),re._applyGlobalCompositeOperation(this),re.drawImage(q._canvas,q.x||0,q.y||0,q.width/X,q.height/X)}else{if(re._applyLineJoin(this),!V){const q=this.getAbsoluteTransform(G).getMatrix();re.transform(q[0],q[1],q[2],q[3],q[4],q[5]),re._applyOpacity(this),re._applyGlobalCompositeOperation(this)}z&&re._applyShadow(this),B.call(this,re,this)}return re.restore(),this}drawHit(I,G,Y=!1){if(!this.shouldDrawHit(G,Y))return this;const ee=this.getLayer(),ie=I||ee.hitCanvas,re=ie&&ie.getContext(),se=this.hitFunc()||this.sceneFunc(),B=this._getCanvasCache(),z=B&&B.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),z){re.save();const V=this.getAbsoluteTransform(G).getMatrix();return re.transform(V[0],V[1],V[2],V[3],V[4],V[5]),this._drawCachedHitCanvas(re),re.restore(),this}if(!se)return this;if(re.save(),re._applyLineJoin(this),!(this===G)){const V=this.getAbsoluteTransform(G).getMatrix();re.transform(V[0],V[1],V[2],V[3],V[4],V[5])}return se.call(this,re,this),re.restore(),this}drawHitFromCache(I=0){const G=this._getCanvasCache(),Y=this._getCachedSceneCanvas(),ee=G.hit,ie=ee.getContext(),re=ee.getWidth(),se=ee.getHeight();ie.clear(),ie.drawImage(Y._canvas,0,0,re,se);try{const B=ie.getImageData(0,0,re,se),z=B.data,U=z.length,V=r.Util._hexToRgb(this.colorKey);for(let q=0;q<U;q+=4)z[q+3]>I?(z[q]=V.r,z[q+1]=V.g,z[q+2]=V.b,z[q+3]=255):z[q+3]=0;ie.putImageData(B,0,0)}catch(B){r.Util.error("Unable to draw hit graph from cached scene canvas. "+B.message)}return this}hasPointerCapture(I){return l.hasPointerCapture(I,this)}setPointerCapture(I){l.setPointerCapture(I,this)}releaseCapture(I){l.releaseCapture(I,this)}}e.Shape=E,E.prototype._fillFunc=_,E.prototype._strokeFunc=b,E.prototype._fillFuncHit=N,E.prototype._strokeFuncHit=k,E.prototype._centroid=!1,E.prototype.nodeType="Shape",(0,i._registerNode)(E),E.prototype.eventListeners={},E.prototype.on.call(E.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),E.prototype.on.call(E.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",T),E.prototype.on.call(E.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",A),E.prototype.on.call(E.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",F),E.prototype.on.call(E.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",R),n.Factory.addGetterSetter(E,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(E,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(E,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(E,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(E,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(E,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(E,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(E,"lineJoin"),n.Factory.addGetterSetter(E,"lineCap"),n.Factory.addGetterSetter(E,"sceneFunc"),n.Factory.addGetterSetter(E,"hitFunc"),n.Factory.addGetterSetter(E,"dash"),n.Factory.addGetterSetter(E,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(E,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(E,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(E,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(E,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(E,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(E,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(E,"fillPatternImage"),n.Factory.addGetterSetter(E,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(E,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(E,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(E,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(E,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(E,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(E,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(E,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(E,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(E,"fillEnabled",!0),n.Factory.addGetterSetter(E,"strokeEnabled",!0),n.Factory.addGetterSetter(E,"shadowEnabled",!0),n.Factory.addGetterSetter(E,"dashEnabled",!0),n.Factory.addGetterSetter(E,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(E,"fillPriority","color"),n.Factory.addComponentsGetterSetter(E,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(E,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(E,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(E,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(E,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(E,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(E,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(E,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(E,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(E,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(E,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(E,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(E,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(E,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(E,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(E,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(E,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(E,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(E,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(E,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(E,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(E,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(E,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(E,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(E,"fillPatternRotation",0),n.Factory.addGetterSetter(E,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(E,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(hw)),hw}var cT;function S6(){if(cT)return Fg;cT=1,Object.defineProperty(Fg,"__esModule",{value:!0}),Fg.Layer=void 0;const e=ms(),t=M1(),r=Ts(),n=Kr(),s=I1(),a=Xr(),i=ua(),l=$r(),c="#",d="beforeDraw",f="draw",p=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],g=p.length;class y extends t.Container{constructor(_){super(_),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(_){return this.getContext().clear(_),this.getHitCanvas().getContext().clear(_),this}setZIndex(_){super.setZIndex(_);const b=this.getStage();return b&&b.content&&(b.content.removeChild(this.getNativeCanvasElement()),_<b.children.length-1?b.content.insertBefore(this.getNativeCanvasElement(),b.children[_+1].getCanvas()._canvas):b.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){r.Node.prototype.moveToTop.call(this);const _=this.getStage();return _&&_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!r.Node.prototype.moveUp.call(this))return!1;const b=this.getStage();return!b||!b.content?!1:(b.content.removeChild(this.getNativeCanvasElement()),this.index<b.children.length-1?b.content.insertBefore(this.getNativeCanvasElement(),b.children[this.index+1].getCanvas()._canvas):b.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(r.Node.prototype.moveDown.call(this)){const _=this.getStage();if(_){const b=_.children;_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.insertBefore(this.getNativeCanvasElement(),b[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(r.Node.prototype.moveToBottom.call(this)){const _=this.getStage();if(_){const b=_.children;_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.insertBefore(this.getNativeCanvasElement(),b[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const _=this.getNativeCanvasElement();return r.Node.prototype.remove.call(this),_&&_.parentNode&&e.Util._isInDocument(_)&&_.parentNode.removeChild(_),this}getStage(){return this.parent}setSize({width:_,height:b}){return this.canvas.setSize(_,b),this.hitCanvas.setSize(_,b),this._setSmoothEnabled(),this}_validateAdd(_){const b=_.getType();b!=="Group"&&b!=="Shape"&&e.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(_){return _=_||{},_.width=_.width||this.getWidth(),_.height=_.height||this.getHeight(),_.x=_.x!==void 0?_.x:this.x(),_.y=_.y!==void 0?_.y:this.y(),r.Node.prototype._toKonvaCanvas.call(this,_)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){e.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){e.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,e.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(_){if(!this.isListening()||!this.isVisible())return null;let b=1,N=!1;for(;;){for(let k=0;k<g;k++){const w=p[k],T=this._getIntersection({x:_.x+w.x*b,y:_.y+w.y*b}),A=T.shape;if(A)return A;if(N=!!T.antialiased,!T.antialiased)break}if(N)b+=1;else return null}}_getIntersection(_){const b=this.hitCanvas.pixelRatio,N=this.hitCanvas.context.getImageData(Math.round(_.x*b),Math.round(_.y*b),1,1).data,k=N[3];if(k===255){const w=e.Util._rgbToHex(N[0],N[1],N[2]),T=i.shapes[c+w];return T?{shape:T}:{antialiased:!0}}else if(k>0)return{antialiased:!0};return{}}drawScene(_,b,N){const k=this.getLayer(),w=_||k&&k.getCanvas();return this._fire(d,{node:this}),this.clearBeforeDraw()&&w.getContext().clear(),t.Container.prototype.drawScene.call(this,w,b,N),this._fire(f,{node:this}),this}drawHit(_,b){const N=this.getLayer(),k=_||N&&N.hitCanvas;return N&&N.clearBeforeDraw()&&N.getHitCanvas().getContext().clear(),t.Container.prototype.drawHit.call(this,k,b),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(_){e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(_)}getHitGraphEnabled(_){return e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const _=this.parent;!!this.hitCanvas._canvas.parentNode?_.content.removeChild(this.hitCanvas._canvas):_.content.appendChild(this.hitCanvas._canvas)}destroy(){return e.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}return Fg.Layer=y,y.prototype.nodeType="Layer",(0,l._registerNode)(y),n.Factory.addGetterSetter(y,"imageSmoothingEnabled",!0),n.Factory.addGetterSetter(y,"clearBeforeDraw",!0),n.Factory.addGetterSetter(y,"hitGraphEnabled",!0,(0,a.getBooleanValidator)()),Fg}var Pg={},uT;function xM(){if(uT)return Pg;uT=1,Object.defineProperty(Pg,"__esModule",{value:!0}),Pg.FastLayer=void 0;const e=ms(),t=S6(),r=$r();class n extends t.Layer{constructor(a){super(a),this.listening(!1),e.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}return Pg.FastLayer=n,n.prototype.nodeType="FastLayer",(0,r._registerNode)(n),Pg}var Rg={},dT;function ab(){if(dT)return Rg;dT=1,Object.defineProperty(Rg,"__esModule",{value:!0}),Rg.Group=void 0;const e=ms(),t=M1(),r=$r();class n extends t.Container{_validateAdd(a){const i=a.getType();i!=="Group"&&i!=="Shape"&&e.Util.throw("You may only add groups and shapes to groups.")}}return Rg.Group=n,n.prototype.nodeType="Group",(0,r._registerNode)(n),Rg}var Dg={},fT;function ib(){if(fT)return Dg;fT=1,Object.defineProperty(Dg,"__esModule",{value:!0}),Dg.Animation=void 0;const e=$r(),t=ms(),r=(function(){return e.glob.performance&&e.glob.performance.now?function(){return e.glob.performance.now()}:function(){return new Date().getTime()}})();let n=class Fh{constructor(a,i){this.id=Fh.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:r(),frameRate:0},this.func=a,this.setLayers(i)}setLayers(a){let i=[];return a&&(i=Array.isArray(a)?a:[a]),this.layers=i,this}getLayers(){return this.layers}addLayer(a){const i=this.layers,l=i.length;for(let c=0;c<l;c++)if(i[c]._id===a._id)return!1;return this.layers.push(a),!0}isRunning(){const i=Fh.animations,l=i.length;for(let c=0;c<l;c++)if(i[c].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=r(),Fh._addAnimation(this),this}stop(){return Fh._removeAnimation(this),this}_updateFrameObject(a){this.frame.timeDiff=a-this.frame.lastTime,this.frame.lastTime=a,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(a){this.animations.push(a),this._handleAnimation()}static _removeAnimation(a){const i=a.id,l=this.animations,c=l.length;for(let d=0;d<c;d++)if(l[d].id===i){this.animations.splice(d,1);break}}static _runFrames(){const a={},i=this.animations;for(let l=0;l<i.length;l++){const c=i[l],d=c.layers,f=c.func;c._updateFrameObject(r());const p=d.length;let g;if(f?g=f.call(c,c.frame)!==!1:g=!0,!!g)for(let y=0;y<p;y++){const v=d[y];v._id!==void 0&&(a[v._id]=v)}}for(const l in a)a.hasOwnProperty(l)&&a[l].batchDraw()}static _animationLoop(){const a=Fh;a.animations.length?(a._runFrames(),t.Util.requestAnimFrame(a._animationLoop)):a.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,t.Util.requestAnimFrame(this._animationLoop))}};return Dg.Animation=n,n.animations=[],n.animIdCounter=0,n.animRunning=!1,Dg}var gw={},hT;function yM(){return hT||(hT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const t=ms(),r=ib(),n=Ts(),s=$r(),a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},i=1,l=2,c=3,d=["fill","stroke","shadowColor"];let f=0;class p{constructor(v,_,b,N,k,w,T){this.prop=v,this.propFunc=_,this.begin=N,this._pos=N,this.duration=w,this._change=0,this.prevPos=0,this.yoyo=T,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=b,this._change=k-this.begin,this.pause()}fire(v){const _=this[v];_&&_()}setTime(v){v>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():v<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=v,this.update())}getTime(){return this._time}setPosition(v){this.prevPos=this._pos,this.propFunc(v),this._pos=v}getPosition(v){return v===void 0&&(v=this._time),this.func(v,this.begin,this._change,this.duration)}play(){this.state=l,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(v){this.pause(),this._time=v,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const v=this.getTimer()-this._startTime;this.state===l?this.setTime(v):this.state===c&&this.setTime(this.duration-v)}pause(){this.state=i,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(v){const _=this,b=v.node,N=b._id,k=v.easing||e.Easings.Linear,w=!!v.yoyo;let T,A;typeof v.duration>"u"?T=.3:v.duration===0?T=.001:T=v.duration,this.node=b,this._id=f++;const F=b.getLayer()||(b instanceof s.Konva.Stage?b.getLayers():null);F||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){_.tween.onEnterFrame()},F),this.tween=new p(A,function(R){_._tweenFunc(R)},k,0,1,T*1e3,w),this._addListeners(),g.attrs[N]||(g.attrs[N]={}),g.attrs[N][this._id]||(g.attrs[N][this._id]={}),g.tweens[N]||(g.tweens[N]={});for(A in v)a[A]===void 0&&this._addAttr(A,v[A]);this.reset(),this.onFinish=v.onFinish,this.onReset=v.onReset,this.onUpdate=v.onUpdate}_addAttr(v,_){const b=this.node,N=b._id;let k,w,T,A,F;const R=g.tweens[N][v];R&&delete g.attrs[N][R][v];let E=b.getAttr(v);if(t.Util._isArray(_))if(k=[],w=Math.max(_.length,E.length),v==="points"&&_.length!==E.length&&(_.length>E.length?(A=E,E=t.Util._prepareArrayForTween(E,_,b.closed())):(T=_,_=t.Util._prepareArrayForTween(_,E,b.closed()))),v.indexOf("fill")===0)for(let D=0;D<w;D++)if(D%2===0)k.push(_[D]-E[D]);else{const I=t.Util.colorToRGBA(E[D]);F=t.Util.colorToRGBA(_[D]),E[D]=I,k.push({r:F.r-I.r,g:F.g-I.g,b:F.b-I.b,a:F.a-I.a})}else for(let D=0;D<w;D++)k.push(_[D]-E[D]);else d.indexOf(v)!==-1?(E=t.Util.colorToRGBA(E),F=t.Util.colorToRGBA(_),k={r:F.r-E.r,g:F.g-E.g,b:F.b-E.b,a:F.a-E.a}):k=_-E;g.attrs[N][this._id][v]={start:E,diff:k,end:_,trueEnd:T,trueStart:A},g.tweens[N][v]=this._id}_tweenFunc(v){const _=this.node,b=g.attrs[_._id][this._id];let N,k,w,T,A,F,R,E;for(N in b){if(k=b[N],w=k.start,T=k.diff,E=k.end,t.Util._isArray(w))if(A=[],R=Math.max(w.length,E.length),N.indexOf("fill")===0)for(F=0;F<R;F++)F%2===0?A.push((w[F]||0)+T[F]*v):A.push("rgba("+Math.round(w[F].r+T[F].r*v)+","+Math.round(w[F].g+T[F].g*v)+","+Math.round(w[F].b+T[F].b*v)+","+(w[F].a+T[F].a*v)+")");else for(F=0;F<R;F++)A.push((w[F]||0)+T[F]*v);else d.indexOf(N)!==-1?A="rgba("+Math.round(w.r+T.r*v)+","+Math.round(w.g+T.g*v)+","+Math.round(w.b+T.b*v)+","+(w.a+T.a*v)+")":A=w+T*v;_.setAttr(N,A)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const v=this.node,_=g.attrs[v._id][this._id];_.points&&_.points.trueEnd&&v.setAttr("points",_.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const v=this.node,_=g.attrs[v._id][this._id];_.points&&_.points.trueStart&&v.points(_.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(v){return this.tween.seek(v*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const v=this.node._id,_=this._id,b=g.tweens[v];this.pause(),this.anim&&this.anim.stop();for(const N in b)delete g.tweens[v][N];delete g.attrs[v][_],g.tweens[v]&&(Object.keys(g.tweens[v]).length===0&&delete g.tweens[v],Object.keys(g.attrs[v]).length===0&&delete g.attrs[v])}}e.Tween=g,g.attrs={},g.tweens={},n.Node.prototype.to=function(y){const v=y.onFinish;y.node=this,y.onFinish=function(){this.destroy(),v&&v()},new g(y).play()},e.Easings={BackEaseIn(y,v,_,b){return _*(y/=b)*y*((1.70158+1)*y-1.70158)+v},BackEaseOut(y,v,_,b){return _*((y=y/b-1)*y*((1.70158+1)*y+1.70158)+1)+v},BackEaseInOut(y,v,_,b){let N=1.70158;return(y/=b/2)<1?_/2*(y*y*(((N*=1.525)+1)*y-N))+v:_/2*((y-=2)*y*(((N*=1.525)+1)*y+N)+2)+v},ElasticEaseIn(y,v,_,b,N,k){let w=0;return y===0?v:(y/=b)===1?v+_:(k||(k=b*.3),!N||N<Math.abs(_)?(N=_,w=k/4):w=k/(2*Math.PI)*Math.asin(_/N),-(N*Math.pow(2,10*(y-=1))*Math.sin((y*b-w)*(2*Math.PI)/k))+v)},ElasticEaseOut(y,v,_,b,N,k){let w=0;return y===0?v:(y/=b)===1?v+_:(k||(k=b*.3),!N||N<Math.abs(_)?(N=_,w=k/4):w=k/(2*Math.PI)*Math.asin(_/N),N*Math.pow(2,-10*y)*Math.sin((y*b-w)*(2*Math.PI)/k)+_+v)},ElasticEaseInOut(y,v,_,b,N,k){let w=0;return y===0?v:(y/=b/2)===2?v+_:(k||(k=b*(.3*1.5)),!N||N<Math.abs(_)?(N=_,w=k/4):w=k/(2*Math.PI)*Math.asin(_/N),y<1?-.5*(N*Math.pow(2,10*(y-=1))*Math.sin((y*b-w)*(2*Math.PI)/k))+v:N*Math.pow(2,-10*(y-=1))*Math.sin((y*b-w)*(2*Math.PI)/k)*.5+_+v)},BounceEaseOut(y,v,_,b){return(y/=b)<1/2.75?_*(7.5625*y*y)+v:y<2/2.75?_*(7.5625*(y-=1.5/2.75)*y+.75)+v:y<2.5/2.75?_*(7.5625*(y-=2.25/2.75)*y+.9375)+v:_*(7.5625*(y-=2.625/2.75)*y+.984375)+v},BounceEaseIn(y,v,_,b){return _-e.Easings.BounceEaseOut(b-y,0,_,b)+v},BounceEaseInOut(y,v,_,b){return y<b/2?e.Easings.BounceEaseIn(y*2,0,_,b)*.5+v:e.Easings.BounceEaseOut(y*2-b,0,_,b)*.5+_*.5+v},EaseIn(y,v,_,b){return _*(y/=b)*y+v},EaseOut(y,v,_,b){return-_*(y/=b)*(y-2)+v},EaseInOut(y,v,_,b){return(y/=b/2)<1?_/2*y*y+v:-_/2*(--y*(y-2)-1)+v},StrongEaseIn(y,v,_,b){return _*(y/=b)*y*y*y*y+v},StrongEaseOut(y,v,_,b){return _*((y=y/b-1)*y*y*y*y+1)+v},StrongEaseInOut(y,v,_,b){return(y/=b/2)<1?_/2*y*y*y*y*y+v:_/2*((y-=2)*y*y*y*y+2)+v},Linear(y,v,_,b){return _*y/b+v}}})(gw)),gw}var gT;function C_(){return gT||(gT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const t=$r(),r=ms(),n=Ts(),s=M1(),a=pM(),i=S6(),l=xM(),c=ab(),d=sb(),f=ua(),p=ib(),g=yM(),y=_6(),v=I1();e.Konva=r.Util._assign(t.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:s.Container,Stage:a.Stage,stages:a.stages,Layer:i.Layer,FastLayer:l.FastLayer,Group:c.Group,DD:d.DD,Shape:f.Shape,shapes:f.shapes,Animation:p.Animation,Tween:g.Tween,Easings:g.Easings,Context:y.Context,Canvas:v.Canvas}),e.default=e.Konva})(ow)),ow}var Ig={},mT;function vM(){if(mT)return Ig;mT=1,Object.defineProperty(Ig,"__esModule",{value:!0}),Ig.Arc=void 0;const e=Kr(),t=ua(),r=$r(),n=Xr(),s=$r();class a extends t.Shape{_sceneFunc(l){const c=r.Konva.getAngle(this.angle()),d=this.clockwise();l.beginPath(),l.arc(0,0,this.outerRadius(),0,c,d),l.arc(0,0,this.innerRadius(),c,0,!d),l.closePath(),l.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(l){this.outerRadius(l/2)}setHeight(l){this.outerRadius(l/2)}getSelfRect(){const l=this.innerRadius(),c=this.outerRadius(),d=this.clockwise(),f=r.Konva.getAngle(d?360-this.angle():this.angle()),p=Math.cos(Math.min(f,Math.PI)),g=1,y=Math.sin(Math.min(Math.max(Math.PI,f),3*Math.PI/2)),v=Math.sin(Math.min(f,Math.PI/2)),_=p*(p>0?l:c),b=g*c,N=y*(y>0?l:c),k=v*(v>0?c:l);return{x:_,y:d?-1*k:N,width:b-_,height:k-N}}}return Ig.Arc=a,a.prototype._centroid=!0,a.prototype.className="Arc",a.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1,(0,n.getBooleanValidator)()),Ig}var Mg={},Og={},pT;function k6(){if(pT)return Og;pT=1,Object.defineProperty(Og,"__esModule",{value:!0}),Og.Line=void 0;const e=Kr(),t=$r(),r=ua(),n=Xr();function s(l,c,d,f,p,g,y){const v=Math.sqrt(Math.pow(d-l,2)+Math.pow(f-c,2)),_=Math.sqrt(Math.pow(p-d,2)+Math.pow(g-f,2)),b=y*v/(v+_),N=y*_/(v+_),k=d-b*(p-l),w=f-b*(g-c),T=d+N*(p-l),A=f+N*(g-c);return[k,w,T,A]}function a(l,c){const d=l.length,f=[];for(let p=2;p<d-2;p+=2){const g=s(l[p-2],l[p-1],l[p],l[p+1],l[p+2],l[p+3],c);isNaN(g[0])||(f.push(g[0]),f.push(g[1]),f.push(l[p]),f.push(l[p+1]),f.push(g[2]),f.push(g[3]))}return f}class i extends r.Shape{constructor(c){super(c),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(c){const d=this.points(),f=d.length,p=this.tension(),g=this.closed(),y=this.bezier();if(!f)return;let v=0;if(c.beginPath(),c.moveTo(d[0],d[1]),p!==0&&f>4){const _=this.getTensionPoints(),b=_.length;for(v=g?0:4,g||c.quadraticCurveTo(_[0],_[1],_[2],_[3]);v<b-2;)c.bezierCurveTo(_[v++],_[v++],_[v++],_[v++],_[v++],_[v++]);g||c.quadraticCurveTo(_[b-2],_[b-1],d[f-2],d[f-1])}else if(y)for(v=2;v<f;)c.bezierCurveTo(d[v++],d[v++],d[v++],d[v++],d[v++],d[v++]);else for(v=2;v<f;v+=2)c.lineTo(d[v],d[v+1]);g?(c.closePath(),c.fillStrokeShape(this)):c.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():a(this.points(),this.tension())}_getTensionPointsClosed(){const c=this.points(),d=c.length,f=this.tension(),p=s(c[d-2],c[d-1],c[0],c[1],c[2],c[3],f),g=s(c[d-4],c[d-3],c[d-2],c[d-1],c[0],c[1],f),y=a(c,f);return[p[2],p[3]].concat(y).concat([g[0],g[1],c[d-2],c[d-1],g[2],g[3],p[0],p[1],c[0],c[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let c=this.points();if(c.length<4)return{x:c[0]||0,y:c[1]||0,width:0,height:0};this.tension()!==0?c=[c[0],c[1],...this._getTensionPoints(),c[c.length-2],c[c.length-1]]:c=this.points();let d=c[0],f=c[0],p=c[1],g=c[1],y,v;for(let _=0;_<c.length/2;_++)y=c[_*2],v=c[_*2+1],d=Math.min(d,y),f=Math.max(f,y),p=Math.min(p,v),g=Math.max(g,v);return{x:d,y:p,width:f-d,height:g-p}}}return Og.Line=i,i.prototype.className="Line",i.prototype._attrsAffectingSize=["points","bezier","tension"],(0,t._registerNode)(i),e.Factory.addGetterSetter(i,"closed",!1),e.Factory.addGetterSetter(i,"bezier",!1),e.Factory.addGetterSetter(i,"tension",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"points",[],(0,n.getNumberArrayValidator)()),Og}var Lg={},mw={},xT;function wM(){return xT||(xT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(i,l,c)=>{let d,f;const g=c/2;d=0;for(let y=0;y<20;y++)f=g*e.tValues[20][y]+g,d+=e.cValues[20][y]*n(i,l,f);return g*d};e.getCubicArcLength=t;const r=(i,l,c)=>{c===void 0&&(c=1);const d=i[0]-2*i[1]+i[2],f=l[0]-2*l[1]+l[2],p=2*i[1]-2*i[0],g=2*l[1]-2*l[0],y=4*(d*d+f*f),v=4*(d*p+f*g),_=p*p+g*g;if(y===0)return c*Math.sqrt(Math.pow(i[2]-i[0],2)+Math.pow(l[2]-l[0],2));const b=v/(2*y),N=_/y,k=c+b,w=N-b*b,T=k*k+w>0?Math.sqrt(k*k+w):0,A=b*b+w>0?Math.sqrt(b*b+w):0,F=b+Math.sqrt(b*b+w)!==0?w*Math.log(Math.abs((k+T)/(b+A))):0;return Math.sqrt(y)/2*(k*T-b*A+F)};e.getQuadraticArcLength=r;function n(i,l,c){const d=s(1,c,i),f=s(1,c,l),p=d*d+f*f;return Math.sqrt(p)}const s=(i,l,c)=>{const d=c.length-1;let f,p;if(d===0)return 0;if(i===0){p=0;for(let g=0;g<=d;g++)p+=e.binomialCoefficients[d][g]*Math.pow(1-l,d-g)*Math.pow(l,g)*c[g];return p}else{f=new Array(d);for(let g=0;g<d;g++)f[g]=d*(c[g+1]-c[g]);return s(i-1,l,f)}},a=(i,l,c)=>{let d=1,f=i/l,p=(i-c(f))/l,g=0;for(;d>.001;){const y=c(f+p),v=Math.abs(i-y)/l;if(v<d)d=v,f+=p;else{const _=c(f-p),b=Math.abs(i-_)/l;b<d?(d=b,f-=p):p/=2}if(g++,g>500)break}return f};e.t2length=a})(mw)),mw}var yT;function ob(){if(yT)return Lg;yT=1,Object.defineProperty(Lg,"__esModule",{value:!0}),Lg.Path=void 0;const e=Kr(),t=$r(),r=ua(),n=wM();class s extends r.Shape{constructor(i){super(i),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=s.parsePathData(this.data()),this.pathLength=s.getPathLength(this.dataArray)}_sceneFunc(i){const l=this.dataArray;i.beginPath();let c=!1;for(let d=0;d<l.length;d++){const f=l[d].command,p=l[d].points;switch(f){case"L":i.lineTo(p[0],p[1]);break;case"M":i.moveTo(p[0],p[1]);break;case"C":i.bezierCurveTo(p[0],p[1],p[2],p[3],p[4],p[5]);break;case"Q":i.quadraticCurveTo(p[0],p[1],p[2],p[3]);break;case"A":const g=p[0],y=p[1],v=p[2],_=p[3],b=p[4],N=p[5],k=p[6],w=p[7],T=v>_?v:_,A=v>_?1:v/_,F=v>_?_/v:1;i.translate(g,y),i.rotate(k),i.scale(A,F),i.arc(0,0,T,b,b+N,1-w),i.scale(1/A,1/F),i.rotate(-k),i.translate(-g,-y);break;case"z":c=!0,i.closePath();break}}!c&&!this.hasFill()?i.strokeShape(this):i.fillStrokeShape(this)}getSelfRect(){let i=[];this.dataArray.forEach(function(y){if(y.command==="A"){const v=y.points[4],_=y.points[5],b=y.points[4]+_;let N=Math.PI/180;if(Math.abs(v-b)<N&&(N=Math.abs(v-b)),_<0)for(let k=v-N;k>b;k-=N){const w=s.getPointOnEllipticalArc(y.points[0],y.points[1],y.points[2],y.points[3],k,0);i.push(w.x,w.y)}else for(let k=v+N;k<b;k+=N){const w=s.getPointOnEllipticalArc(y.points[0],y.points[1],y.points[2],y.points[3],k,0);i.push(w.x,w.y)}}else if(y.command==="C")for(let v=0;v<=1;v+=.01){const _=s.getPointOnCubicBezier(v,y.start.x,y.start.y,y.points[0],y.points[1],y.points[2],y.points[3],y.points[4],y.points[5]);i.push(_.x,_.y)}else i=i.concat(y.points)});let l=i[0],c=i[0],d=i[1],f=i[1],p,g;for(let y=0;y<i.length/2;y++)p=i[y*2],g=i[y*2+1],isNaN(p)||(l=Math.min(l,p),c=Math.max(c,p)),isNaN(g)||(d=Math.min(d,g),f=Math.max(f,g));return{x:l,y:d,width:c-l,height:f-d}}getLength(){return this.pathLength}getPointAtLength(i){return s.getPointAtLengthOfDataArray(i,this.dataArray)}static getLineLength(i,l,c,d){return Math.sqrt((c-i)*(c-i)+(d-l)*(d-l))}static getPathLength(i){let l=0;for(let c=0;c<i.length;++c)l+=i[c].pathLength;return l}static getPointAtLengthOfDataArray(i,l){let c,d=0,f=l.length;if(!f)return null;for(;d<f&&i>l[d].pathLength;)i-=l[d].pathLength,++d;if(d===f)return c=l[d-1].points.slice(-2),{x:c[0],y:c[1]};if(i<.01)return l[d].command==="M"?(c=l[d].points.slice(0,2),{x:c[0],y:c[1]}):{x:l[d].start.x,y:l[d].start.y};const p=l[d],g=p.points;switch(p.command){case"L":return s.getPointOnLine(i,p.start.x,p.start.y,g[0],g[1]);case"C":return s.getPointOnCubicBezier((0,n.t2length)(i,s.getPathLength(l),T=>(0,n.getCubicArcLength)([p.start.x,g[0],g[2],g[4]],[p.start.y,g[1],g[3],g[5]],T)),p.start.x,p.start.y,g[0],g[1],g[2],g[3],g[4],g[5]);case"Q":return s.getPointOnQuadraticBezier((0,n.t2length)(i,s.getPathLength(l),T=>(0,n.getQuadraticArcLength)([p.start.x,g[0],g[2]],[p.start.y,g[1],g[3]],T)),p.start.x,p.start.y,g[0],g[1],g[2],g[3]);case"A":const y=g[0],v=g[1],_=g[2],b=g[3],N=g[5],k=g[6];let w=g[4];return w+=N*i/p.pathLength,s.getPointOnEllipticalArc(y,v,_,b,w,k)}return null}static getPointOnLine(i,l,c,d,f,p,g){p=p??l,g=g??c;const y=this.getLineLength(l,c,d,f);if(y<1e-10)return{x:l,y:c};if(d===l)return{x:p,y:g+(f>c?i:-i)};const v=(f-c)/(d-l),_=Math.sqrt(i*i/(1+v*v))*(d<l?-1:1),b=v*_;if(Math.abs(g-c-v*(p-l))<1e-10)return{x:p+_,y:g+b};const N=((p-l)*(d-l)+(g-c)*(f-c))/(y*y),k=l+N*(d-l),w=c+N*(f-c),T=this.getLineLength(p,g,k,w),A=Math.sqrt(i*i-T*T),F=Math.sqrt(A*A/(1+v*v))*(d<l?-1:1),R=v*F;return{x:k+F,y:w+R}}static getPointOnCubicBezier(i,l,c,d,f,p,g,y,v){function _(A){return A*A*A}function b(A){return 3*A*A*(1-A)}function N(A){return 3*A*(1-A)*(1-A)}function k(A){return(1-A)*(1-A)*(1-A)}const w=y*_(i)+p*b(i)+d*N(i)+l*k(i),T=v*_(i)+g*b(i)+f*N(i)+c*k(i);return{x:w,y:T}}static getPointOnQuadraticBezier(i,l,c,d,f,p,g){function y(k){return k*k}function v(k){return 2*k*(1-k)}function _(k){return(1-k)*(1-k)}const b=p*y(i)+d*v(i)+l*_(i),N=g*y(i)+f*v(i)+c*_(i);return{x:b,y:N}}static getPointOnEllipticalArc(i,l,c,d,f,p){const g=Math.cos(p),y=Math.sin(p),v={x:c*Math.cos(f),y:d*Math.sin(f)};return{x:i+(v.x*g-v.y*y),y:l+(v.x*y+v.y*g)}}static parsePathData(i){if(!i)return[];let l=i;const c=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];l=l.replace(new RegExp(" ","g"),",");for(let b=0;b<c.length;b++)l=l.replace(new RegExp(c[b],"g"),"|"+c[b]);const d=l.split("|"),f=[],p=[];let g=0,y=0;const v=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let _;for(let b=1;b<d.length;b++){let N=d[b],k=N.charAt(0);for(N=N.slice(1),p.length=0;_=v.exec(N);)p.push(_[0]);const w=[];for(let T=0,A=p.length;T<A;T++){if(p[T]==="00"){w.push(0,0);continue}const F=parseFloat(p[T]);isNaN(F)?w.push(0):w.push(F)}for(;w.length>0&&!isNaN(w[0]);){let T="",A=[];const F=g,R=y;let E,D,I,G,Y,ee,ie,re,se,B;switch(k){case"l":g+=w.shift(),y+=w.shift(),T="L",A.push(g,y);break;case"L":g=w.shift(),y=w.shift(),A.push(g,y);break;case"m":const z=w.shift(),U=w.shift();if(g+=z,y+=U,T="M",f.length>2&&f[f.length-1].command==="z"){for(let V=f.length-2;V>=0;V--)if(f[V].command==="M"){g=f[V].points[0]+z,y=f[V].points[1]+U;break}}A.push(g,y),k="l";break;case"M":g=w.shift(),y=w.shift(),T="M",A.push(g,y),k="L";break;case"h":g+=w.shift(),T="L",A.push(g,y);break;case"H":g=w.shift(),T="L",A.push(g,y);break;case"v":y+=w.shift(),T="L",A.push(g,y);break;case"V":y=w.shift(),T="L",A.push(g,y);break;case"C":A.push(w.shift(),w.shift(),w.shift(),w.shift()),g=w.shift(),y=w.shift(),A.push(g,y);break;case"c":A.push(g+w.shift(),y+w.shift(),g+w.shift(),y+w.shift()),g+=w.shift(),y+=w.shift(),T="C",A.push(g,y);break;case"S":D=g,I=y,E=f[f.length-1],E.command==="C"&&(D=g+(g-E.points[2]),I=y+(y-E.points[3])),A.push(D,I,w.shift(),w.shift()),g=w.shift(),y=w.shift(),T="C",A.push(g,y);break;case"s":D=g,I=y,E=f[f.length-1],E.command==="C"&&(D=g+(g-E.points[2]),I=y+(y-E.points[3])),A.push(D,I,g+w.shift(),y+w.shift()),g+=w.shift(),y+=w.shift(),T="C",A.push(g,y);break;case"Q":A.push(w.shift(),w.shift()),g=w.shift(),y=w.shift(),A.push(g,y);break;case"q":A.push(g+w.shift(),y+w.shift()),g+=w.shift(),y+=w.shift(),T="Q",A.push(g,y);break;case"T":D=g,I=y,E=f[f.length-1],E.command==="Q"&&(D=g+(g-E.points[0]),I=y+(y-E.points[1])),g=w.shift(),y=w.shift(),T="Q",A.push(D,I,g,y);break;case"t":D=g,I=y,E=f[f.length-1],E.command==="Q"&&(D=g+(g-E.points[0]),I=y+(y-E.points[1])),g+=w.shift(),y+=w.shift(),T="Q",A.push(D,I,g,y);break;case"A":G=w.shift(),Y=w.shift(),ee=w.shift(),ie=w.shift(),re=w.shift(),se=g,B=y,g=w.shift(),y=w.shift(),T="A",A=this.convertEndpointToCenterParameterization(se,B,g,y,ie,re,G,Y,ee);break;case"a":G=w.shift(),Y=w.shift(),ee=w.shift(),ie=w.shift(),re=w.shift(),se=g,B=y,g+=w.shift(),y+=w.shift(),T="A",A=this.convertEndpointToCenterParameterization(se,B,g,y,ie,re,G,Y,ee);break}f.push({command:T||k,points:A,start:{x:F,y:R},pathLength:this.calcLength(F,R,T||k,A)})}(k==="z"||k==="Z")&&f.push({command:"z",points:[],start:void 0,pathLength:0})}return f}static calcLength(i,l,c,d){let f,p,g,y;const v=s;switch(c){case"L":return v.getLineLength(i,l,d[0],d[1]);case"C":return(0,n.getCubicArcLength)([i,d[0],d[2],d[4]],[l,d[1],d[3],d[5]],1);case"Q":return(0,n.getQuadraticArcLength)([i,d[0],d[2]],[l,d[1],d[3]],1);case"A":f=0;const _=d[4],b=d[5],N=d[4]+b;let k=Math.PI/180;if(Math.abs(_-N)<k&&(k=Math.abs(_-N)),p=v.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],_,0),b<0)for(y=_-k;y>N;y-=k)g=v.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],y,0),f+=v.getLineLength(p.x,p.y,g.x,g.y),p=g;else for(y=_+k;y<N;y+=k)g=v.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],y,0),f+=v.getLineLength(p.x,p.y,g.x,g.y),p=g;return g=v.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],N,0),f+=v.getLineLength(p.x,p.y,g.x,g.y),f}return 0}static convertEndpointToCenterParameterization(i,l,c,d,f,p,g,y,v){const _=v*(Math.PI/180),b=Math.cos(_)*(i-c)/2+Math.sin(_)*(l-d)/2,N=-1*Math.sin(_)*(i-c)/2+Math.cos(_)*(l-d)/2,k=b*b/(g*g)+N*N/(y*y);k>1&&(g*=Math.sqrt(k),y*=Math.sqrt(k));let w=Math.sqrt((g*g*(y*y)-g*g*(N*N)-y*y*(b*b))/(g*g*(N*N)+y*y*(b*b)));f===p&&(w*=-1),isNaN(w)&&(w=0);const T=w*g*N/y,A=w*-y*b/g,F=(i+c)/2+Math.cos(_)*T-Math.sin(_)*A,R=(l+d)/2+Math.sin(_)*T+Math.cos(_)*A,E=function(re){return Math.sqrt(re[0]*re[0]+re[1]*re[1])},D=function(re,se){return(re[0]*se[0]+re[1]*se[1])/(E(re)*E(se))},I=function(re,se){return(re[0]*se[1]<re[1]*se[0]?-1:1)*Math.acos(D(re,se))},G=I([1,0],[(b-T)/g,(N-A)/y]),Y=[(b-T)/g,(N-A)/y],ee=[(-1*b-T)/g,(-1*N-A)/y];let ie=I(Y,ee);return D(Y,ee)<=-1&&(ie=Math.PI),D(Y,ee)>=1&&(ie=0),p===0&&ie>0&&(ie=ie-2*Math.PI),p===1&&ie<0&&(ie=ie+2*Math.PI),[F,R,g,y,G,ie,_,p]}}return Lg.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,t._registerNode)(s),e.Factory.addGetterSetter(s,"data"),Lg}var vT;function _M(){if(vT)return Mg;vT=1,Object.defineProperty(Mg,"__esModule",{value:!0}),Mg.Arrow=void 0;const e=Kr(),t=k6(),r=Xr(),n=$r(),s=ob();class a extends t.Line{_sceneFunc(l){super._sceneFunc(l);const c=Math.PI*2,d=this.points();let f=d;const p=this.tension()!==0&&d.length>4;p&&(f=this.getTensionPoints());const g=this.pointerLength(),y=d.length;let v,_;if(p){const k=[f[f.length-4],f[f.length-3],f[f.length-2],f[f.length-1],d[y-2],d[y-1]],w=s.Path.calcLength(f[f.length-4],f[f.length-3],"C",k),T=s.Path.getPointOnQuadraticBezier(Math.min(1,1-g/w),k[0],k[1],k[2],k[3],k[4],k[5]);v=d[y-2]-T.x,_=d[y-1]-T.y}else v=d[y-2]-d[y-4],_=d[y-1]-d[y-3];const b=(Math.atan2(_,v)+c)%c,N=this.pointerWidth();this.pointerAtEnding()&&(l.save(),l.beginPath(),l.translate(d[y-2],d[y-1]),l.rotate(b),l.moveTo(0,0),l.lineTo(-g,N/2),l.lineTo(-g,-N/2),l.closePath(),l.restore(),this.__fillStroke(l)),this.pointerAtBeginning()&&(l.save(),l.beginPath(),l.translate(d[0],d[1]),p?(v=(f[0]+f[2])/2-d[0],_=(f[1]+f[3])/2-d[1]):(v=d[2]-d[0],_=d[3]-d[1]),l.rotate((Math.atan2(-_,-v)+c)%c),l.moveTo(0,0),l.lineTo(-g,N/2),l.lineTo(-g,-N/2),l.closePath(),l.restore(),this.__fillStroke(l))}__fillStroke(l){const c=this.dashEnabled();c&&(this.attrs.dashEnabled=!1,l.setLineDash([])),l.fillStrokeShape(this),c&&(this.attrs.dashEnabled=!0)}getSelfRect(){const l=super.getSelfRect(),c=this.pointerWidth()/2;return{x:l.x,y:l.y-c,width:l.width,height:l.height+c*2}}}return Mg.Arrow=a,a.prototype.className="Arrow",(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"pointerLength",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerWidth",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerAtBeginning",!1),e.Factory.addGetterSetter(a,"pointerAtEnding",!0),Mg}var Bg={},wT;function bM(){if(wT)return Bg;wT=1,Object.defineProperty(Bg,"__esModule",{value:!0}),Bg.Circle=void 0;const e=Kr(),t=ua(),r=Xr(),n=$r();class s extends t.Shape{_sceneFunc(i){i.beginPath(),i.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius()!==i/2&&this.radius(i/2)}setHeight(i){this.radius()!==i/2&&this.radius(i/2)}}return Bg.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),Bg}var Ug={},_T;function SM(){if(_T)return Ug;_T=1,Object.defineProperty(Ug,"__esModule",{value:!0}),Ug.Ellipse=void 0;const e=Kr(),t=ua(),r=Xr(),n=$r();class s extends t.Shape{_sceneFunc(i){const l=this.radiusX(),c=this.radiusY();i.beginPath(),i.save(),l!==c&&i.scale(1,c/l),i.arc(0,0,l,0,Math.PI*2,!1),i.restore(),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(i){this.radiusX(i/2)}setHeight(i){this.radiusY(i/2)}}return Ug.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,n._registerNode)(s),e.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),e.Factory.addGetterSetter(s,"radiusX",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"radiusY",0,(0,r.getNumberValidator)()),Ug}var $g={},bT;function kM(){if(bT)return $g;bT=1,Object.defineProperty($g,"__esModule",{value:!0}),$g.Image=void 0;const e=ms(),t=Kr(),r=ua(),n=$r(),s=Xr();class a extends r.Shape{constructor(l){super(l),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",c=>{this._removeImageLoad(c.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const l=this.image();l&&l.complete||l&&l.readyState===4||l&&l.addEventListener&&l.addEventListener("load",this._loadListener)}_removeImageLoad(l){l&&l.removeEventListener&&l.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const l=!!this.cornerRadius(),c=this.hasShadow();return l&&c?!0:super._useBufferCanvas(!0)}_sceneFunc(l){const c=this.getWidth(),d=this.getHeight(),f=this.cornerRadius(),p=this.attrs.image;let g;if(p){const y=this.attrs.cropWidth,v=this.attrs.cropHeight;y&&v?g=[p,this.cropX(),this.cropY(),y,v,0,0,c,d]:g=[p,0,0,c,d]}(this.hasFill()||this.hasStroke()||f)&&(l.beginPath(),f?e.Util.drawRoundedRectPath(l,c,d,f):l.rect(0,0,c,d),l.closePath(),l.fillStrokeShape(this)),p&&(f&&l.clip(),l.drawImage.apply(l,g))}_hitFunc(l){const c=this.width(),d=this.height(),f=this.cornerRadius();l.beginPath(),f?e.Util.drawRoundedRectPath(l,c,d,f):l.rect(0,0,c,d),l.closePath(),l.fillStrokeShape(this)}getWidth(){var l,c;return(l=this.attrs.width)!==null&&l!==void 0?l:(c=this.image())===null||c===void 0?void 0:c.width}getHeight(){var l,c;return(l=this.attrs.height)!==null&&l!==void 0?l:(c=this.image())===null||c===void 0?void 0:c.height}static fromURL(l,c,d=null){const f=e.Util.createImageElement();f.onload=function(){const p=new a({image:f});c(p)},f.onerror=d,f.crossOrigin="Anonymous",f.src=l}}return $g.Image=a,a.prototype.className="Image",(0,n._registerNode)(a),t.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),t.Factory.addGetterSetter(a,"image"),t.Factory.addComponentsGetterSetter(a,"crop",["x","y","width","height"]),t.Factory.addGetterSetter(a,"cropX",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropY",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropWidth",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropHeight",0,(0,s.getNumberValidator)()),$g}var Pd={},ST;function CM(){if(ST)return Pd;ST=1,Object.defineProperty(Pd,"__esModule",{value:!0}),Pd.Tag=Pd.Label=void 0;const e=Kr(),t=ua(),r=ab(),n=Xr(),s=$r(),a=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],i="Change.konva",l="none",c="up",d="right",f="down",p="left",g=a.length;class y extends r.Group{constructor(b){super(b),this.on("add.konva",function(N){this._addListeners(N.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(b){let N=this,k;const w=function(){N._sync()};for(k=0;k<g;k++)b.on(a[k]+i,w)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let b=this.getText(),N=this.getTag(),k,w,T,A,F,R,E;if(b&&N){switch(k=b.width(),w=b.height(),T=N.pointerDirection(),A=N.pointerWidth(),E=N.pointerHeight(),F=0,R=0,T){case c:F=k/2,R=-1*E;break;case d:F=k+A,R=w/2;break;case f:F=k/2,R=w+E;break;case p:F=-1*A,R=w/2;break}N.setAttrs({x:-1*F,y:-1*R,width:k,height:w}),b.setAttrs({x:-1*F,y:-1*R})}}}Pd.Label=y,y.prototype.className="Label",(0,s._registerNode)(y);class v extends t.Shape{_sceneFunc(b){const N=this.width(),k=this.height(),w=this.pointerDirection(),T=this.pointerWidth(),A=this.pointerHeight(),F=this.cornerRadius();let R=0,E=0,D=0,I=0;typeof F=="number"?R=E=D=I=Math.min(F,N/2,k/2):(R=Math.min(F[0]||0,N/2,k/2),E=Math.min(F[1]||0,N/2,k/2),I=Math.min(F[2]||0,N/2,k/2),D=Math.min(F[3]||0,N/2,k/2)),b.beginPath(),b.moveTo(R,0),w===c&&(b.lineTo((N-T)/2,0),b.lineTo(N/2,-1*A),b.lineTo((N+T)/2,0)),b.lineTo(N-E,0),b.arc(N-E,E,E,Math.PI*3/2,0,!1),w===d&&(b.lineTo(N,(k-A)/2),b.lineTo(N+T,k/2),b.lineTo(N,(k+A)/2)),b.lineTo(N,k-I),b.arc(N-I,k-I,I,0,Math.PI/2,!1),w===f&&(b.lineTo((N+T)/2,k),b.lineTo(N/2,k+A),b.lineTo((N-T)/2,k)),b.lineTo(D,k),b.arc(D,k-D,D,Math.PI/2,Math.PI,!1),w===p&&(b.lineTo(0,(k+A)/2),b.lineTo(-1*T,k/2),b.lineTo(0,(k-A)/2)),b.lineTo(0,R),b.arc(R,R,R,Math.PI,Math.PI*3/2,!1),b.closePath(),b.fillStrokeShape(this)}getSelfRect(){let b=0,N=0,k=this.pointerWidth(),w=this.pointerHeight(),T=this.pointerDirection(),A=this.width(),F=this.height();return T===c?(N-=w,F+=w):T===f?F+=w:T===p?(b-=k*1.5,A+=k):T===d&&(A+=k*1.5),{x:b,y:N,width:A,height:F}}}return Pd.Tag=v,v.prototype.className="Tag",(0,s._registerNode)(v),e.Factory.addGetterSetter(v,"pointerDirection",l),e.Factory.addGetterSetter(v,"pointerWidth",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(v,"pointerHeight",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(v,"cornerRadius",0,(0,n.getNumberOrArrayOfNumbersValidator)(4)),Pd}var Wg={},kT;function C6(){if(kT)return Wg;kT=1,Object.defineProperty(Wg,"__esModule",{value:!0}),Wg.Rect=void 0;const e=Kr(),t=ua(),r=$r(),n=ms(),s=Xr();class a extends t.Shape{_sceneFunc(l){const c=this.cornerRadius(),d=this.width(),f=this.height();l.beginPath(),c?n.Util.drawRoundedRectPath(l,d,f,c):l.rect(0,0,d,f),l.closePath(),l.fillStrokeShape(this)}}return Wg.Rect=a,a.prototype.className="Rect",(0,r._registerNode)(a),e.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),Wg}var zg={},CT;function TM(){if(CT)return zg;CT=1,Object.defineProperty(zg,"__esModule",{value:!0}),zg.RegularPolygon=void 0;const e=Kr(),t=ua(),r=Xr(),n=$r();class s extends t.Shape{_sceneFunc(i){const l=this._getPoints();i.beginPath(),i.moveTo(l[0].x,l[0].y);for(let c=1;c<l.length;c++)i.lineTo(l[c].x,l[c].y);i.closePath(),i.fillStrokeShape(this)}_getPoints(){const i=this.attrs.sides,l=this.attrs.radius||0,c=[];for(let d=0;d<i;d++)c.push({x:l*Math.sin(d*2*Math.PI/i),y:-1*l*Math.cos(d*2*Math.PI/i)});return c}getSelfRect(){const i=this._getPoints();let l=i[0].x,c=i[0].y,d=i[0].x,f=i[0].y;return i.forEach(p=>{l=Math.min(l,p.x),c=Math.max(c,p.x),d=Math.min(d,p.y),f=Math.max(f,p.y)}),{x:l,y:d,width:c-l,height:f-d}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius(i/2)}setHeight(i){this.radius(i/2)}}return zg.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"sides",0,(0,r.getNumberValidator)()),zg}var Hg={},TT;function EM(){if(TT)return Hg;TT=1,Object.defineProperty(Hg,"__esModule",{value:!0}),Hg.Ring=void 0;const e=Kr(),t=ua(),r=Xr(),n=$r(),s=Math.PI*2;class a extends t.Shape{_sceneFunc(l){l.beginPath(),l.arc(0,0,this.innerRadius(),0,s,!1),l.moveTo(this.outerRadius(),0),l.arc(0,0,this.outerRadius(),s,0,!0),l.closePath(),l.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(l){this.outerRadius(l/2)}setHeight(l){this.outerRadius(l/2)}}return Hg.Ring=a,a.prototype.className="Ring",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,r.getNumberValidator)()),Hg}var Gg={},ET;function NM(){if(ET)return Gg;ET=1,Object.defineProperty(Gg,"__esModule",{value:!0}),Gg.Sprite=void 0;const e=Kr(),t=ua(),r=ib(),n=Xr(),s=$r();class a extends t.Shape{constructor(l){super(l),this._updated=!0,this.anim=new r.Animation(()=>{const c=this._updated;return this._updated=!1,c}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(l){const c=this.animation(),d=this.frameIndex(),f=d*4,p=this.animations()[c],g=this.frameOffsets(),y=p[f+0],v=p[f+1],_=p[f+2],b=p[f+3],N=this.image();if((this.hasFill()||this.hasStroke())&&(l.beginPath(),l.rect(0,0,_,b),l.closePath(),l.fillStrokeShape(this)),N)if(g){const k=g[c],w=d*2;l.drawImage(N,y,v,_,b,k[w+0],k[w+1],_,b)}else l.drawImage(N,y,v,_,b,0,0,_,b)}_hitFunc(l){const c=this.animation(),d=this.frameIndex(),f=d*4,p=this.animations()[c],g=this.frameOffsets(),y=p[f+2],v=p[f+3];if(l.beginPath(),g){const _=g[c],b=d*2;l.rect(_[b+0],_[b+1],y,v)}else l.rect(0,0,y,v);l.closePath(),l.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const l=this;this.interval=setInterval(function(){l._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const l=this.getLayer();this.anim.setLayers(l),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const l=this.frameIndex(),c=this.animation(),d=this.animations(),f=d[c],p=f.length/4;l<p-1?this.frameIndex(l+1):this.frameIndex(0)}}return Gg.Sprite=a,a.prototype.className="Sprite",(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"animation"),e.Factory.addGetterSetter(a,"animations"),e.Factory.addGetterSetter(a,"frameOffsets"),e.Factory.addGetterSetter(a,"image"),e.Factory.addGetterSetter(a,"frameIndex",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"frameRate",17,(0,n.getNumberValidator)()),e.Factory.backCompat(a,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Gg}var Vg={},NT;function AM(){if(NT)return Vg;NT=1,Object.defineProperty(Vg,"__esModule",{value:!0}),Vg.Star=void 0;const e=Kr(),t=ua(),r=Xr(),n=$r();class s extends t.Shape{_sceneFunc(i){const l=this.innerRadius(),c=this.outerRadius(),d=this.numPoints();i.beginPath(),i.moveTo(0,0-c);for(let f=1;f<d*2;f++){const p=f%2===0?c:l,g=p*Math.sin(f*Math.PI/d),y=-1*p*Math.cos(f*Math.PI/d);i.lineTo(g,y)}i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(i){this.outerRadius(i/2)}setHeight(i){this.outerRadius(i/2)}}return Vg.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"numPoints",5,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"outerRadius",0,(0,r.getNumberValidator)()),Vg}var Ch={},AT;function T6(){if(AT)return Ch;AT=1,Object.defineProperty(Ch,"__esModule",{value:!0}),Ch.Text=void 0,Ch.stringToArray=i;const e=ms(),t=Kr(),r=ua(),n=$r(),s=Xr(),a=$r();function i(L){return[...L].reduce((M,X,K,Z)=>{if(new RegExp("\\p{Emoji}","u").test(X)){const J=Z[K+1];J&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(J)?(M.push(X+J),Z[K+1]=""):M.push(X)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(X+(Z[K+1]||""))?M.push(X+Z[K+1]):K>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(X)?M[M.length-1]+=X:X&&M.push(X);return M},[])}const l="auto",c="center",d="inherit",f="justify",p="Change.konva",g="2d",y="-",v="left",_="text",b="Text",N="top",k="bottom",w="middle",T="normal",A="px ",F=" ",R="right",E="rtl",D="word",I="char",G="none",Y="",ee=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],ie=ee.length;function re(L){return L.split(",").map(M=>{M=M.trim();const X=M.indexOf(" ")>=0,K=M.indexOf('"')>=0||M.indexOf("'")>=0;return X&&!K&&(M=`"${M}"`),M}).join(", ")}let se;function B(){return se||(se=e.Util.createCanvasElement().getContext(g),se)}function z(L){L.fillText(this._partialText,this._partialTextX,this._partialTextY)}function U(L){L.setAttr("miterLimit",2),L.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function V(L){return L=L||{},!L.fillLinearGradientColorStops&&!L.fillRadialGradientColorStops&&!L.fillPatternImage&&(L.fill=L.fill||"black"),L}class q extends r.Shape{constructor(M){super(V(M)),this._partialTextX=0,this._partialTextY=0;for(let X=0;X<ie;X++)this.on(ee[X]+p,this._setTextData);this._setTextData()}_sceneFunc(M){const X=this.textArr,K=X.length;if(!this.text())return;let Z=this.padding(),J=this.fontSize(),ne=this.lineHeight()*J,me=this.verticalAlign(),xe=this.direction(),Ne=0,le=this.align(),ge=this.getWidth(),Ue=this.letterSpacing(),Ge=this.fill(),Je=this.textDecoration(),He=Je.indexOf("underline")!==-1,Ft=Je.indexOf("line-through")!==-1,rt;xe=xe===d?M.direction:xe;let Ie=ne/2,Pe=w;if(n.Konva._fixTextRendering){const Qe=this.measureSize("M");Pe="alphabetic",Ie=(Qe.fontBoundingBoxAscent-Qe.fontBoundingBoxDescent)/2+ne/2}for(xe===E&&M.setAttr("direction",xe),M.setAttr("font",this._getContextFont()),M.setAttr("textBaseline",Pe),M.setAttr("textAlign",v),me===w?Ne=(this.getHeight()-K*ne-Z*2)/2:me===k&&(Ne=this.getHeight()-K*ne-Z*2),M.translate(Z,Ne+Z),rt=0;rt<K;rt++){let Qe=0,_t=0;const gt=X[rt],Bt=gt.text,Ut=gt.width,it=gt.lastInParagraph;if(M.save(),le===R?Qe+=ge-Ut-Z*2:le===c&&(Qe+=(ge-Ut-Z*2)/2),He){M.save(),M.beginPath();const Ye=n.Konva._fixTextRendering?Math.round(J/4):Math.round(J/2),xt=Qe,ut=Ie+_t+Ye;M.moveTo(xt,ut);const wt=le===f&&!it?ge-Z*2:Ut;M.lineTo(xt+Math.round(wt),ut),M.lineWidth=J/15;const $t=this._getLinearGradient();M.strokeStyle=$t||Ge,M.stroke(),M.restore()}if(Ft){M.save(),M.beginPath();const Ye=n.Konva._fixTextRendering?-Math.round(J/4):0;M.moveTo(Qe,Ie+_t+Ye);const xt=le===f&&!it?ge-Z*2:Ut;M.lineTo(Qe+Math.round(xt),Ie+_t+Ye),M.lineWidth=J/15;const ut=this._getLinearGradient();M.strokeStyle=ut||Ge,M.stroke(),M.restore()}if(xe!==E&&(Ue!==0||le===f)){const Ye=Bt.split(" ").length-1,xt=i(Bt);for(let ut=0;ut<xt.length;ut++){const wt=xt[ut];wt===" "&&!it&&le===f&&(Qe+=(ge-Z*2-Ut)/Ye),this._partialTextX=Qe,this._partialTextY=Ie+_t,this._partialText=wt,M.fillStrokeShape(this),Qe+=this.measureSize(wt).width+Ue}}else Ue!==0&&M.setAttr("letterSpacing",`${Ue}px`),this._partialTextX=Qe,this._partialTextY=Ie+_t,this._partialText=Bt,M.fillStrokeShape(this);M.restore(),K>1&&(Ie+=ne)}}_hitFunc(M){const X=this.getWidth(),K=this.getHeight();M.beginPath(),M.rect(0,0,X,K),M.closePath(),M.fillStrokeShape(this)}setText(M){const X=e.Util._isString(M)?M:M==null?"":M+"";return this._setAttr(_,X),this}getWidth(){return this.attrs.width===l||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===l||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(M){var X,K,Z,J,ne,me,xe,Ne,le,ge,Ue;let Ge=B(),Je=this.fontSize(),He;Ge.save(),Ge.font=this._getContextFont(),He=Ge.measureText(M),Ge.restore();const Ft=Je/100;return{actualBoundingBoxAscent:(X=He.actualBoundingBoxAscent)!==null&&X!==void 0?X:71.58203125*Ft,actualBoundingBoxDescent:(K=He.actualBoundingBoxDescent)!==null&&K!==void 0?K:0,actualBoundingBoxLeft:(Z=He.actualBoundingBoxLeft)!==null&&Z!==void 0?Z:-7.421875*Ft,actualBoundingBoxRight:(J=He.actualBoundingBoxRight)!==null&&J!==void 0?J:75.732421875*Ft,alphabeticBaseline:(ne=He.alphabeticBaseline)!==null&&ne!==void 0?ne:0,emHeightAscent:(me=He.emHeightAscent)!==null&&me!==void 0?me:100*Ft,emHeightDescent:(xe=He.emHeightDescent)!==null&&xe!==void 0?xe:-20*Ft,fontBoundingBoxAscent:(Ne=He.fontBoundingBoxAscent)!==null&&Ne!==void 0?Ne:91*Ft,fontBoundingBoxDescent:(le=He.fontBoundingBoxDescent)!==null&&le!==void 0?le:21*Ft,hangingBaseline:(ge=He.hangingBaseline)!==null&&ge!==void 0?ge:72.80000305175781*Ft,ideographicBaseline:(Ue=He.ideographicBaseline)!==null&&Ue!==void 0?Ue:-21*Ft,width:He.width,height:Je}}_getContextFont(){return this.fontStyle()+F+this.fontVariant()+F+(this.fontSize()+A)+re(this.fontFamily())}_addTextLine(M){this.align()===f&&(M=M.trim());const K=this._getTextWidth(M);return this.textArr.push({text:M,width:K,lastInParagraph:!1})}_getTextWidth(M){const X=this.letterSpacing(),K=M.length;return B().measureText(M).width+X*K}_setTextData(){let M=this.text().split(`
`),X=+this.fontSize(),K=0,Z=this.lineHeight()*X,J=this.attrs.width,ne=this.attrs.height,me=J!==l&&J!==void 0,xe=ne!==l&&ne!==void 0,Ne=this.padding(),le=J-Ne*2,ge=ne-Ne*2,Ue=0,Ge=this.wrap(),Je=Ge!==G,He=Ge!==I&&Je,Ft=this.ellipsis();this.textArr=[],B().font=this._getContextFont();const rt=Ft?this._getTextWidth(Y):0;for(let Ie=0,Pe=M.length;Ie<Pe;++Ie){let Qe=M[Ie],_t=this._getTextWidth(Qe);if(me&&_t>le)for(;Qe.length>0;){let gt=0,Bt=i(Qe).length,Ut="",it=0;for(;gt<Bt;){const Ye=gt+Bt>>>1,xt=i(Qe),ut=xt.slice(0,Ye+1).join(""),wt=this._getTextWidth(ut);(Ft&&xe&&Ue+Z>ge?wt+rt:wt)<=le?(gt=Ye+1,Ut=ut,it=wt):Bt=Ye}if(Ut){if(He){const ut=i(Qe),wt=i(Ut),$t=ut[wt.length],Kt=$t===F||$t===y;let De;if(Kt&&it<=le)De=wt.length;else{const ct=wt.lastIndexOf(F),mt=wt.lastIndexOf(y);De=Math.max(ct,mt)+1}De>0&&(gt=De,Ut=ut.slice(0,gt).join(""),it=this._getTextWidth(Ut))}if(Ut=Ut.trimRight(),this._addTextLine(Ut),K=Math.max(K,it),Ue+=Z,this._shouldHandleEllipsis(Ue)){this._tryToAddEllipsisToLastLine();break}if(Qe=i(Qe).slice(gt).join("").trimLeft(),Qe.length>0&&(_t=this._getTextWidth(Qe),_t<=le)){this._addTextLine(Qe),Ue+=Z,K=Math.max(K,_t);break}}else break}else this._addTextLine(Qe),Ue+=Z,K=Math.max(K,_t),this._shouldHandleEllipsis(Ue)&&Ie<Pe-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),xe&&Ue+Z>ge)break}this.textHeight=X,this.textWidth=K}_shouldHandleEllipsis(M){const X=+this.fontSize(),K=this.lineHeight()*X,Z=this.attrs.height,J=Z!==l&&Z!==void 0,ne=this.padding(),me=Z-ne*2;return!(this.wrap()!==G)||J&&M+K>me}_tryToAddEllipsisToLastLine(){const M=this.attrs.width,X=M!==l&&M!==void 0,K=this.padding(),Z=M-K*2,J=this.ellipsis(),ne=this.textArr[this.textArr.length-1];!ne||!J||(X&&(this._getTextWidth(ne.text+Y)<Z||(ne.text=ne.text.slice(0,ne.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(ne.text+Y))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const M=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,X=this.hasShadow();return M&&X?!0:super._useBufferCanvas()}}return Ch.Text=q,q.prototype._fillFunc=z,q.prototype._strokeFunc=U,q.prototype.className=b,q.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,a._registerNode)(q),t.Factory.overWriteSetter(q,"width",(0,s.getNumberOrAutoValidator)()),t.Factory.overWriteSetter(q,"height",(0,s.getNumberOrAutoValidator)()),t.Factory.addGetterSetter(q,"direction",d),t.Factory.addGetterSetter(q,"fontFamily","Arial"),t.Factory.addGetterSetter(q,"fontSize",12,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(q,"fontStyle",T),t.Factory.addGetterSetter(q,"fontVariant",T),t.Factory.addGetterSetter(q,"padding",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(q,"align",v),t.Factory.addGetterSetter(q,"verticalAlign",N),t.Factory.addGetterSetter(q,"lineHeight",1,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(q,"wrap",D),t.Factory.addGetterSetter(q,"ellipsis",!1,(0,s.getBooleanValidator)()),t.Factory.addGetterSetter(q,"letterSpacing",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(q,"text","",(0,s.getStringValidator)()),t.Factory.addGetterSetter(q,"textDecoration",""),Ch}var Kg={},jT;function jM(){if(jT)return Kg;jT=1,Object.defineProperty(Kg,"__esModule",{value:!0}),Kg.TextPath=void 0;const e=ms(),t=Kr(),r=ua(),n=ob(),s=T6(),a=Xr(),i=$r(),l="",c="normal";function d(g){g.fillText(this.partialText,0,0)}function f(g){g.strokeText(this.partialText,0,0)}class p extends r.Shape{constructor(y){super(y),this.dummyCanvas=e.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return n.Path.getPathLength(this.dataArray)}_getPointAtLength(y){if(!this.attrs.data)return null;const v=this.pathLength;return y-1>v?null:n.Path.getPointAtLengthOfDataArray(y,this.dataArray)}_readDataAttribute(){this.dataArray=n.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(y){y.setAttr("font",this._getContextFont()),y.setAttr("textBaseline",this.textBaseline()),y.setAttr("textAlign","left"),y.save();const v=this.textDecoration(),_=this.fill(),b=this.fontSize(),N=this.glyphInfo;v==="underline"&&y.beginPath();for(let k=0;k<N.length;k++){y.save();const w=N[k].p0;y.translate(w.x,w.y),y.rotate(N[k].rotation),this.partialText=N[k].text,y.fillStrokeShape(this),v==="underline"&&(k===0&&y.moveTo(0,b/2+1),y.lineTo(b,b/2+1)),y.restore()}v==="underline"&&(y.strokeStyle=_,y.lineWidth=b/20,y.stroke()),y.restore()}_hitFunc(y){y.beginPath();const v=this.glyphInfo;if(v.length>=1){const _=v[0].p0;y.moveTo(_.x,_.y)}for(let _=0;_<v.length;_++){const b=v[_].p1;y.lineTo(b.x,b.y)}y.setAttr("lineWidth",this.fontSize()),y.setAttr("strokeStyle",this.colorKey),y.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(y){return s.Text.prototype.setText.call(this,y)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(y){const _=this.dummyCanvas.getContext("2d");_.save(),_.font=this._getContextFont();const b=_.measureText(y);return _.restore(),{width:b.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:y,height:v}=this._getTextSize(this.attrs.text);if(this.textWidth=y,this.textHeight=v,this.glyphInfo=[],!this.attrs.data)return null;const _=this.letterSpacing(),b=this.align(),N=this.kerningFunc(),k=Math.max(this.textWidth+((this.attrs.text||"").length-1)*_,0);let w=0;b==="center"&&(w=Math.max(0,this.pathLength/2-k/2)),b==="right"&&(w=Math.max(0,this.pathLength-k));const T=(0,s.stringToArray)(this.text());let A=w;for(let F=0;F<T.length;F++){const R=this._getPointAtLength(A);if(!R)return;let E=this._getTextSize(T[F]).width+_;if(T[F]===" "&&b==="justify"){const ie=this.text().split(" ").length-1;E+=(this.pathLength-k)/ie}const D=this._getPointAtLength(A+E);if(!D)return;const I=n.Path.getLineLength(R.x,R.y,D.x,D.y);let G=0;if(N)try{G=N(T[F-1],T[F])*this.fontSize()}catch{G=0}R.x+=G,D.x+=G,this.textWidth+=G;const Y=n.Path.getPointOnLine(G+I/2,R.x,R.y,D.x,D.y),ee=Math.atan2(D.y-R.y,D.x-R.x);this.glyphInfo.push({transposeX:Y.x,transposeY:Y.y,text:T[F],rotation:ee,p0:R,p1:D}),A+=E}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const y=[];this.glyphInfo.forEach(function(A){y.push(A.p0.x),y.push(A.p0.y),y.push(A.p1.x),y.push(A.p1.y)});let v=y[0]||0,_=y[0]||0,b=y[1]||0,N=y[1]||0,k,w;for(let A=0;A<y.length/2;A++)k=y[A*2],w=y[A*2+1],v=Math.min(v,k),_=Math.max(_,k),b=Math.min(b,w),N=Math.max(N,w);const T=this.fontSize();return{x:v-T/2,y:b-T/2,width:_-v+T,height:N-b+T}}destroy(){return e.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}return Kg.TextPath=p,p.prototype._fillFunc=d,p.prototype._strokeFunc=f,p.prototype._fillFuncHit=d,p.prototype._strokeFuncHit=f,p.prototype.className="TextPath",p.prototype._attrsAffectingSize=["text","fontSize","data"],(0,i._registerNode)(p),t.Factory.addGetterSetter(p,"data"),t.Factory.addGetterSetter(p,"fontFamily","Arial"),t.Factory.addGetterSetter(p,"fontSize",12,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(p,"fontStyle",c),t.Factory.addGetterSetter(p,"align","left"),t.Factory.addGetterSetter(p,"letterSpacing",0,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(p,"textBaseline","middle"),t.Factory.addGetterSetter(p,"fontVariant",c),t.Factory.addGetterSetter(p,"text",l),t.Factory.addGetterSetter(p,"textDecoration",""),t.Factory.addGetterSetter(p,"kerningFunc",void 0),Kg}var qg={},FT;function FM(){if(FT)return qg;FT=1,Object.defineProperty(qg,"__esModule",{value:!0}),qg.Transformer=void 0;const e=ms(),t=Kr(),r=Ts(),n=ua(),s=C6(),a=ab(),i=$r(),l=Xr(),c=$r(),d="tr-konva",f=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(E=>E+`.${d}`).join(" "),p="nodesRect",g=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],y={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},v="ontouchstart"in i.Konva._global;function _(E,D,I){if(E==="rotater")return I;D+=e.Util.degToRad(y[E]||0);const G=(e.Util.radToDeg(D)%360+360)%360;return e.Util._inRange(G,315+22.5,360)||e.Util._inRange(G,0,22.5)?"ns-resize":e.Util._inRange(G,45-22.5,45+22.5)?"nesw-resize":e.Util._inRange(G,90-22.5,90+22.5)?"ew-resize":e.Util._inRange(G,135-22.5,135+22.5)?"nwse-resize":e.Util._inRange(G,180-22.5,180+22.5)?"ns-resize":e.Util._inRange(G,225-22.5,225+22.5)?"nesw-resize":e.Util._inRange(G,270-22.5,270+22.5)?"ew-resize":e.Util._inRange(G,315-22.5,315+22.5)?"nwse-resize":(e.Util.error("Transformer has unknown angle for cursor detection: "+G),"pointer")}const b=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function N(E){return{x:E.x+E.width/2*Math.cos(E.rotation)+E.height/2*Math.sin(-E.rotation),y:E.y+E.height/2*Math.cos(E.rotation)+E.width/2*Math.sin(E.rotation)}}function k(E,D,I){const G=I.x+(E.x-I.x)*Math.cos(D)-(E.y-I.y)*Math.sin(D),Y=I.y+(E.x-I.x)*Math.sin(D)+(E.y-I.y)*Math.cos(D);return{...E,rotation:E.rotation+D,x:G,y:Y}}function w(E,D){const I=N(E);return k(E,D,I)}function T(E,D,I){let G=D;for(let Y=0;Y<E.length;Y++){const ee=i.Konva.getAngle(E[Y]),ie=Math.abs(ee-D)%(Math.PI*2);Math.min(ie,Math.PI*2-ie)<I&&(G=ee)}return G}let A=0;class F extends a.Group{constructor(D){super(D),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(f,this.update),this.getNode()&&this.update()}attachTo(D){return this.setNode(D),this}setNode(D){return e.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([D])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return d+this._id}setNodes(D=[]){this._nodes&&this._nodes.length&&this.detach();const I=D.filter(Y=>Y.isAncestorOf(this)?(e.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=D=I,D.length===1&&this.useSingleNodeRotation()?this.rotation(D[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(Y=>{const ee=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(Y._attrsAffectingSize.length){const ie=Y._attrsAffectingSize.map(re=>re+"Change."+this._getEventNamespace()).join(" ");Y.on(ie,ee)}Y.on(g.map(ie=>ie+`.${this._getEventNamespace()}`).join(" "),ee),Y.on(`absoluteTransformChange.${this._getEventNamespace()}`,ee),this._proxyDrag(Y)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(D){let I;D.on(`dragstart.${this._getEventNamespace()}`,G=>{I=D.getAbsolutePosition(),!this.isDragging()&&D!==this.findOne(".back")&&this.startDrag(G,!1)}),D.on(`dragmove.${this._getEventNamespace()}`,G=>{if(!I)return;const Y=D.getAbsolutePosition(),ee=Y.x-I.x,ie=Y.y-I.y;this.nodes().forEach(re=>{if(re===D||re.isDragging())return;const se=re.getAbsolutePosition();re.setAbsolutePosition({x:se.x+ee,y:se.y+ie}),re.startDrag(G)}),I=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(D=>{D.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(p),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(p,this.__getNodeRect)}__getNodeShape(D,I=this.rotation(),G){const Y=D.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),ee=D.getAbsoluteScale(G),ie=D.getAbsolutePosition(G),re=Y.x*ee.x-D.offsetX()*ee.x,se=Y.y*ee.y-D.offsetY()*ee.y,B=(i.Konva.getAngle(D.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),z={x:ie.x+re*Math.cos(B)+se*Math.sin(-B),y:ie.y+se*Math.cos(B)+re*Math.sin(B),width:Y.width*ee.x,height:Y.height*ee.y,rotation:B};return k(z,-i.Konva.getAngle(I),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const I=[];this.nodes().map(B=>{const z=B.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),U=[{x:z.x,y:z.y},{x:z.x+z.width,y:z.y},{x:z.x+z.width,y:z.y+z.height},{x:z.x,y:z.y+z.height}],V=B.getAbsoluteTransform();U.forEach(function(q){const L=V.point(q);I.push(L)})});const G=new e.Transform;G.rotate(-i.Konva.getAngle(this.rotation()));let Y=1/0,ee=1/0,ie=-1/0,re=-1/0;I.forEach(function(B){const z=G.point(B);Y===void 0&&(Y=ie=z.x,ee=re=z.y),Y=Math.min(Y,z.x),ee=Math.min(ee,z.y),ie=Math.max(ie,z.x),re=Math.max(re,z.y)}),G.invert();const se=G.point({x:Y,y:ee});return{x:se.x,y:se.y,width:ie-Y,height:re-ee,rotation:i.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),b.forEach(D=>{this._createAnchor(D)}),this._createAnchor("rotater")}_createAnchor(D){const I=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:D+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:v?10:"auto"}),G=this;I.on("mousedown touchstart",function(Y){G._handleMouseDown(Y)}),I.on("dragstart",Y=>{I.stopDrag(),Y.cancelBubble=!0}),I.on("dragend",Y=>{Y.cancelBubble=!0}),I.on("mouseenter",()=>{const Y=i.Konva.getAngle(this.rotation()),ee=this.rotateAnchorCursor(),ie=_(D,Y,ee);I.getStage().content&&(I.getStage().content.style.cursor=ie),this._cursorChange=!0}),I.on("mouseout",()=>{I.getStage().content&&(I.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(I)}_createBack(){const D=new n.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(I,G){const Y=G.getParent(),ee=Y.padding();I.beginPath(),I.rect(-ee,-ee,G.width()+ee*2,G.height()+ee*2),I.moveTo(G.width()/2,-ee),Y.rotateEnabled()&&Y.rotateLineVisible()&&I.lineTo(G.width()/2,-Y.rotateAnchorOffset()*e.Util._sign(G.height())-ee),I.fillStrokeShape(G)},hitFunc:(I,G)=>{if(!this.shouldOverdrawWholeArea())return;const Y=this.padding();I.beginPath(),I.rect(-Y,-Y,G.width()+Y*2,G.height()+Y*2),I.fillStrokeShape(G)}});this.add(D),this._proxyDrag(D),D.on("dragstart",I=>{I.cancelBubble=!0}),D.on("dragmove",I=>{I.cancelBubble=!0}),D.on("dragend",I=>{I.cancelBubble=!0}),this.on("dragmove",I=>{this.update()})}_handleMouseDown(D){if(this._transforming)return;this._movingAnchorName=D.target.name().split(" ")[0];const I=this._getNodeRect(),G=I.width,Y=I.height,ee=Math.sqrt(Math.pow(G,2)+Math.pow(Y,2));this.sin=Math.abs(Y/ee),this.cos=Math.abs(G/ee),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const ie=D.target.getAbsolutePosition(),re=D.target.getStage().getPointerPosition();this._anchorDragOffset={x:re.x-ie.x,y:re.y-ie.y},A++,this._fire("transformstart",{evt:D.evt,target:this.getNode()}),this._nodes.forEach(se=>{se._fire("transformstart",{evt:D.evt,target:se})})}_handleMouseMove(D){let I,G,Y;const ee=this.findOne("."+this._movingAnchorName),ie=ee.getStage();ie.setPointersPositions(D);const re=ie.getPointerPosition();let se={x:re.x-this._anchorDragOffset.x,y:re.y-this._anchorDragOffset.y};const B=ee.getAbsolutePosition();this.anchorDragBoundFunc()&&(se=this.anchorDragBoundFunc()(B,se,D)),ee.setAbsolutePosition(se);const z=ee.getAbsolutePosition();if(B.x===z.x&&B.y===z.y)return;if(this._movingAnchorName==="rotater"){const Z=this._getNodeRect();I=ee.x()-Z.width/2,G=-ee.y()+Z.height/2;let J=Math.atan2(-G,I)+Math.PI/2;Z.height<0&&(J-=Math.PI);const me=i.Konva.getAngle(this.rotation())+J,xe=i.Konva.getAngle(this.rotationSnapTolerance()),le=T(this.rotationSnaps(),me,xe)-Z.rotation,ge=w(Z,le);this._fitNodesInto(ge,D);return}const U=this.shiftBehavior();let V;U==="inverted"?V=this.keepRatio()&&!D.shiftKey:U==="none"?V=this.keepRatio():V=this.keepRatio()||D.shiftKey;let q=this.centeredScaling()||D.altKey;if(this._movingAnchorName==="top-left"){if(V){const Z=q?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};Y=Math.sqrt(Math.pow(Z.x-ee.x(),2)+Math.pow(Z.y-ee.y(),2));const J=this.findOne(".top-left").x()>Z.x?-1:1,ne=this.findOne(".top-left").y()>Z.y?-1:1;I=Y*this.cos*J,G=Y*this.sin*ne,this.findOne(".top-left").x(Z.x-I),this.findOne(".top-left").y(Z.y-G)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(ee.y());else if(this._movingAnchorName==="top-right"){if(V){const Z=q?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};Y=Math.sqrt(Math.pow(ee.x()-Z.x,2)+Math.pow(Z.y-ee.y(),2));const J=this.findOne(".top-right").x()<Z.x?-1:1,ne=this.findOne(".top-right").y()>Z.y?-1:1;I=Y*this.cos*J,G=Y*this.sin*ne,this.findOne(".top-right").x(Z.x+I),this.findOne(".top-right").y(Z.y-G)}var L=ee.position();this.findOne(".top-left").y(L.y),this.findOne(".bottom-right").x(L.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(ee.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(ee.x());else if(this._movingAnchorName==="bottom-left"){if(V){const Z=q?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};Y=Math.sqrt(Math.pow(Z.x-ee.x(),2)+Math.pow(ee.y()-Z.y,2));const J=Z.x<ee.x()?-1:1,ne=ee.y()<Z.y?-1:1;I=Y*this.cos*J,G=Y*this.sin*ne,ee.x(Z.x-I),ee.y(Z.y+G)}L=ee.position(),this.findOne(".top-left").x(L.x),this.findOne(".bottom-right").y(L.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(ee.y());else if(this._movingAnchorName==="bottom-right"){if(V){const Z=q?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};Y=Math.sqrt(Math.pow(ee.x()-Z.x,2)+Math.pow(ee.y()-Z.y,2));const J=this.findOne(".bottom-right").x()<Z.x?-1:1,ne=this.findOne(".bottom-right").y()<Z.y?-1:1;I=Y*this.cos*J,G=Y*this.sin*ne,this.findOne(".bottom-right").x(Z.x+I),this.findOne(".bottom-right").y(Z.y+G)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(q=this.centeredScaling()||D.altKey,q){const Z=this.findOne(".top-left"),J=this.findOne(".bottom-right"),ne=Z.x(),me=Z.y(),xe=this.getWidth()-J.x(),Ne=this.getHeight()-J.y();J.move({x:-ne,y:-me}),Z.move({x:xe,y:Ne})}const M=this.findOne(".top-left").getAbsolutePosition();I=M.x,G=M.y;const X=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),K=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:I,y:G,width:X,height:K,rotation:i.Konva.getAngle(this.rotation())},D)}_handleMouseUp(D){this._removeEvents(D)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(D){var I;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const G=this.getNode();A--,this._fire("transformend",{evt:D,target:G}),(I=this.getLayer())===null||I===void 0||I.batchDraw(),G&&this._nodes.forEach(Y=>{var ee;Y._fire("transformend",{evt:D,target:Y}),(ee=Y.getLayer())===null||ee===void 0||ee.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(D,I){const G=this._getNodeRect(),Y=1;if(e.Util._inRange(D.width,-this.padding()*2-Y,Y)){this.update();return}if(e.Util._inRange(D.height,-this.padding()*2-Y,Y)){this.update();return}const ee=new e.Transform;if(ee.rotate(i.Konva.getAngle(this.rotation())),this._movingAnchorName&&D.width<0&&this._movingAnchorName.indexOf("left")>=0){const V=ee.point({x:-this.padding()*2,y:0});D.x+=V.x,D.y+=V.y,D.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=V.x,this._anchorDragOffset.y-=V.y}else if(this._movingAnchorName&&D.width<0&&this._movingAnchorName.indexOf("right")>=0){const V=ee.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=V.x,this._anchorDragOffset.y-=V.y,D.width+=this.padding()*2}if(this._movingAnchorName&&D.height<0&&this._movingAnchorName.indexOf("top")>=0){const V=ee.point({x:0,y:-this.padding()*2});D.x+=V.x,D.y+=V.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=V.x,this._anchorDragOffset.y-=V.y,D.height+=this.padding()*2}else if(this._movingAnchorName&&D.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const V=ee.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=V.x,this._anchorDragOffset.y-=V.y,D.height+=this.padding()*2}if(this.boundBoxFunc()){const V=this.boundBoxFunc()(G,D);V?D=V:e.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const ie=1e7,re=new e.Transform;re.translate(G.x,G.y),re.rotate(G.rotation),re.scale(G.width/ie,G.height/ie);const se=new e.Transform,B=D.width/ie,z=D.height/ie;this.flipEnabled()===!1?(se.translate(D.x,D.y),se.rotate(D.rotation),se.translate(D.width<0?D.width:0,D.height<0?D.height:0),se.scale(Math.abs(B),Math.abs(z))):(se.translate(D.x,D.y),se.rotate(D.rotation),se.scale(B,z));const U=se.multiply(re.invert());this._nodes.forEach(V=>{var q;const L=V.getParent().getAbsoluteTransform(),M=V.getTransform().copy();M.translate(V.offsetX(),V.offsetY());const X=new e.Transform;X.multiply(L.copy().invert()).multiply(U).multiply(L).multiply(M);const K=X.decompose();V.setAttrs(K),(q=V.getLayer())===null||q===void 0||q.batchDraw()}),this.rotation(e.Util._getRotation(D.rotation)),this._nodes.forEach(V=>{this._fire("transform",{evt:I,target:V}),V._fire("transform",{evt:I,target:V})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(D,I){this.findOne(D).setAttrs(I)}update(){var D;const I=this._getNodeRect();this.rotation(e.Util._getRotation(I.rotation));const G=I.width,Y=I.height,ee=this.enabledAnchors(),ie=this.resizeEnabled(),re=this.padding(),se=this.anchorSize(),B=this.find("._anchor");B.forEach(U=>{U.setAttrs({width:se,height:se,offsetX:se/2,offsetY:se/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:se/2+re,offsetY:se/2+re,visible:ie&&ee.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:G/2,y:0,offsetY:se/2+re,visible:ie&&ee.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:G,y:0,offsetX:se/2-re,offsetY:se/2+re,visible:ie&&ee.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:Y/2,offsetX:se/2+re,visible:ie&&ee.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:G,y:Y/2,offsetX:se/2-re,visible:ie&&ee.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:Y,offsetX:se/2+re,offsetY:se/2-re,visible:ie&&ee.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:G/2,y:Y,offsetY:se/2-re,visible:ie&&ee.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:G,y:Y,offsetX:se/2-re,offsetY:se/2-re,visible:ie&&ee.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:G/2,y:-this.rotateAnchorOffset()*e.Util._sign(Y)-re,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:G,height:Y,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const z=this.anchorStyleFunc();z&&B.forEach(U=>{z(U)}),(D=this.getLayer())===null||D===void 0||D.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const D=this.findOne("."+this._movingAnchorName);D&&D.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),a.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return r.Node.prototype.toObject.call(this)}clone(D){return r.Node.prototype.clone.call(this,D)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}qg.Transformer=F,F.isTransforming=()=>A>0;function R(E){return E instanceof Array||e.Util.warn("enabledAnchors value should be an array"),E instanceof Array&&E.forEach(function(D){b.indexOf(D)===-1&&e.Util.warn("Unknown anchor name: "+D+". Available names are: "+b.join(", "))}),E||[]}return F.prototype.className="Transformer",(0,c._registerNode)(F),t.Factory.addGetterSetter(F,"enabledAnchors",b,R),t.Factory.addGetterSetter(F,"flipEnabled",!0,(0,l.getBooleanValidator)()),t.Factory.addGetterSetter(F,"resizeEnabled",!0),t.Factory.addGetterSetter(F,"anchorSize",10,(0,l.getNumberValidator)()),t.Factory.addGetterSetter(F,"rotateEnabled",!0),t.Factory.addGetterSetter(F,"rotateLineVisible",!0),t.Factory.addGetterSetter(F,"rotationSnaps",[]),t.Factory.addGetterSetter(F,"rotateAnchorOffset",50,(0,l.getNumberValidator)()),t.Factory.addGetterSetter(F,"rotateAnchorCursor","crosshair"),t.Factory.addGetterSetter(F,"rotationSnapTolerance",5,(0,l.getNumberValidator)()),t.Factory.addGetterSetter(F,"borderEnabled",!0),t.Factory.addGetterSetter(F,"anchorStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(F,"anchorStrokeWidth",1,(0,l.getNumberValidator)()),t.Factory.addGetterSetter(F,"anchorFill","white"),t.Factory.addGetterSetter(F,"anchorCornerRadius",0,(0,l.getNumberValidator)()),t.Factory.addGetterSetter(F,"borderStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(F,"borderStrokeWidth",1,(0,l.getNumberValidator)()),t.Factory.addGetterSetter(F,"borderDash"),t.Factory.addGetterSetter(F,"keepRatio",!0),t.Factory.addGetterSetter(F,"shiftBehavior","default"),t.Factory.addGetterSetter(F,"centeredScaling",!1),t.Factory.addGetterSetter(F,"ignoreStroke",!1),t.Factory.addGetterSetter(F,"padding",0,(0,l.getNumberValidator)()),t.Factory.addGetterSetter(F,"nodes"),t.Factory.addGetterSetter(F,"node"),t.Factory.addGetterSetter(F,"boundBoxFunc"),t.Factory.addGetterSetter(F,"anchorDragBoundFunc"),t.Factory.addGetterSetter(F,"anchorStyleFunc"),t.Factory.addGetterSetter(F,"shouldOverdrawWholeArea",!1),t.Factory.addGetterSetter(F,"useSingleNodeRotation",!0),t.Factory.backCompat(F,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),qg}var Xg={},PT;function PM(){if(PT)return Xg;PT=1,Object.defineProperty(Xg,"__esModule",{value:!0}),Xg.Wedge=void 0;const e=Kr(),t=ua(),r=$r(),n=Xr(),s=$r();class a extends t.Shape{_sceneFunc(l){l.beginPath(),l.arc(0,0,this.radius(),0,r.Konva.getAngle(this.angle()),this.clockwise()),l.lineTo(0,0),l.closePath(),l.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(l){this.radius(l/2)}setHeight(l){this.radius(l/2)}}return Xg.Wedge=a,a.prototype.className="Wedge",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"radius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1),e.Factory.backCompat(a,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Xg}var Yg={},RT;function RM(){if(RT)return Yg;RT=1,Object.defineProperty(Yg,"__esModule",{value:!0}),Yg.Blur=void 0;const e=Kr(),t=Ts(),r=Xr();function n(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],a=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function i(c,d){const f=c.data,p=c.width,g=c.height;let y,v,_,b,N,k,w,T,A,F,R,E,D,I,G,Y,ee,ie,re,se;const B=d+d+1,z=p-1,U=g-1,V=d+1,q=V*(V+1)/2,L=new n,M=s[d],X=a[d];let K=null,Z=L,J=null,ne=null;for(let me=1;me<B;me++)Z=Z.next=new n,me===V&&(K=Z);Z.next=L,_=v=0;for(let me=0;me<g;me++){E=D=I=G=b=N=k=w=0,T=V*(Y=f[v]),A=V*(ee=f[v+1]),F=V*(ie=f[v+2]),R=V*(re=f[v+3]),b+=q*Y,N+=q*ee,k+=q*ie,w+=q*re,Z=L;for(let xe=0;xe<V;xe++)Z.r=Y,Z.g=ee,Z.b=ie,Z.a=re,Z=Z.next;for(let xe=1;xe<V;xe++)y=v+((z<xe?z:xe)<<2),b+=(Z.r=Y=f[y])*(se=V-xe),N+=(Z.g=ee=f[y+1])*se,k+=(Z.b=ie=f[y+2])*se,w+=(Z.a=re=f[y+3])*se,E+=Y,D+=ee,I+=ie,G+=re,Z=Z.next;J=L,ne=K;for(let xe=0;xe<p;xe++)f[v+3]=re=w*M>>X,re!==0?(re=255/re,f[v]=(b*M>>X)*re,f[v+1]=(N*M>>X)*re,f[v+2]=(k*M>>X)*re):f[v]=f[v+1]=f[v+2]=0,b-=T,N-=A,k-=F,w-=R,T-=J.r,A-=J.g,F-=J.b,R-=J.a,y=_+((y=xe+d+1)<z?y:z)<<2,E+=J.r=f[y],D+=J.g=f[y+1],I+=J.b=f[y+2],G+=J.a=f[y+3],b+=E,N+=D,k+=I,w+=G,J=J.next,T+=Y=ne.r,A+=ee=ne.g,F+=ie=ne.b,R+=re=ne.a,E-=Y,D-=ee,I-=ie,G-=re,ne=ne.next,v+=4;_+=p}for(let me=0;me<p;me++){D=I=G=E=N=k=w=b=0,v=me<<2,T=V*(Y=f[v]),A=V*(ee=f[v+1]),F=V*(ie=f[v+2]),R=V*(re=f[v+3]),b+=q*Y,N+=q*ee,k+=q*ie,w+=q*re,Z=L;for(let Ne=0;Ne<V;Ne++)Z.r=Y,Z.g=ee,Z.b=ie,Z.a=re,Z=Z.next;let xe=p;for(let Ne=1;Ne<=d;Ne++)v=xe+me<<2,b+=(Z.r=Y=f[v])*(se=V-Ne),N+=(Z.g=ee=f[v+1])*se,k+=(Z.b=ie=f[v+2])*se,w+=(Z.a=re=f[v+3])*se,E+=Y,D+=ee,I+=ie,G+=re,Z=Z.next,Ne<U&&(xe+=p);v=me,J=L,ne=K;for(let Ne=0;Ne<g;Ne++)y=v<<2,f[y+3]=re=w*M>>X,re>0?(re=255/re,f[y]=(b*M>>X)*re,f[y+1]=(N*M>>X)*re,f[y+2]=(k*M>>X)*re):f[y]=f[y+1]=f[y+2]=0,b-=T,N-=A,k-=F,w-=R,T-=J.r,A-=J.g,F-=J.b,R-=J.a,y=me+((y=Ne+V)<U?y:U)*p<<2,b+=E+=J.r=f[y],N+=D+=J.g=f[y+1],k+=I+=J.b=f[y+2],w+=G+=J.a=f[y+3],J=J.next,T+=Y=ne.r,A+=ee=ne.g,F+=ie=ne.b,R+=re=ne.a,E-=Y,D-=ee,I-=ie,G-=re,ne=ne.next,v+=p}}const l=function(d){const f=Math.round(this.blurRadius());f>0&&i(d,f)};return Yg.Blur=l,e.Factory.addGetterSetter(t.Node,"blurRadius",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Yg}var Jg={},DT;function DM(){if(DT)return Jg;DT=1,Object.defineProperty(Jg,"__esModule",{value:!0}),Jg.Brighten=void 0;const e=Kr(),t=Ts(),r=Xr(),n=function(s){const a=this.brightness()*255,i=s.data,l=i.length;for(let c=0;c<l;c+=4)i[c]+=a,i[c+1]+=a,i[c+2]+=a};return Jg.Brighten=n,e.Factory.addGetterSetter(t.Node,"brightness",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Jg}var Qg={},IT;function IM(){if(IT)return Qg;IT=1,Object.defineProperty(Qg,"__esModule",{value:!0}),Qg.Contrast=void 0;const e=Kr(),t=Ts(),r=Xr(),n=function(s){const a=Math.pow((this.contrast()+100)/100,2),i=s.data,l=i.length;let c=150,d=150,f=150;for(let p=0;p<l;p+=4)c=i[p],d=i[p+1],f=i[p+2],c/=255,c-=.5,c*=a,c+=.5,c*=255,d/=255,d-=.5,d*=a,d+=.5,d*=255,f/=255,f-=.5,f*=a,f+=.5,f*=255,c=c<0?0:c>255?255:c,d=d<0?0:d>255?255:d,f=f<0?0:f>255?255:f,i[p]=c,i[p+1]=d,i[p+2]=f};return Qg.Contrast=n,e.Factory.addGetterSetter(t.Node,"contrast",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Qg}var Zg={},MT;function MM(){if(MT)return Zg;MT=1,Object.defineProperty(Zg,"__esModule",{value:!0}),Zg.Emboss=void 0;const e=Kr(),t=Ts(),r=ms(),n=Xr(),s=function(a){const i=this.embossStrength()*10,l=this.embossWhiteLevel()*255,c=this.embossDirection(),d=this.embossBlend(),f=a.data,p=a.width,g=a.height,y=p*4;let v=0,_=0,b=g;switch(c){case"top-left":v=-1,_=-1;break;case"top":v=-1,_=0;break;case"top-right":v=-1,_=1;break;case"right":v=0,_=1;break;case"bottom-right":v=1,_=1;break;case"bottom":v=1,_=0;break;case"bottom-left":v=1,_=-1;break;case"left":v=0,_=-1;break;default:r.Util.error("Unknown emboss direction: "+c)}do{const N=(b-1)*y;let k=v;b+k<1&&(k=0),b+k>g&&(k=0);const w=(b-1+k)*p*4;let T=p;do{const A=N+(T-1)*4;let F=_;T+F<1&&(F=0),T+F>p&&(F=0);const R=w+(T-1+F)*4,E=f[A]-f[R],D=f[A+1]-f[R+1],I=f[A+2]-f[R+2];let G=E;const Y=G>0?G:-G,ee=D>0?D:-D,ie=I>0?I:-I;if(ee>Y&&(G=D),ie>Y&&(G=I),G*=i,d){const re=f[A]+G,se=f[A+1]+G,B=f[A+2]+G;f[A]=re>255?255:re<0?0:re,f[A+1]=se>255?255:se<0?0:se,f[A+2]=B>255?255:B<0?0:B}else{let re=l-G;re<0?re=0:re>255&&(re=255),f[A]=f[A+1]=f[A+2]=re}}while(--T)}while(--b)};return Zg.Emboss=s,e.Factory.addGetterSetter(t.Node,"embossStrength",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossWhiteLevel",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossDirection","top-left",void 0,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossBlend",!1,void 0,e.Factory.afterSetFilter),Zg}var em={},OT;function OM(){if(OT)return em;OT=1,Object.defineProperty(em,"__esModule",{value:!0}),em.Enhance=void 0;const e=Kr(),t=Ts(),r=Xr();function n(a,i,l,c,d){const f=l-i,p=d-c;if(f===0)return c+p/2;if(p===0)return c;let g=(a-i)/f;return g=p*g+c,g}const s=function(a){const i=a.data,l=i.length;let c=i[0],d=c,f,p=i[1],g=p,y,v=i[2],_=v,b;const N=this.enhance();if(N===0)return;for(let E=0;E<l;E+=4)f=i[E+0],f<c?c=f:f>d&&(d=f),y=i[E+1],y<p?p=y:y>g&&(g=y),b=i[E+2],b<v?v=b:b>_&&(_=b);d===c&&(d=255,c=0),g===p&&(g=255,p=0),_===v&&(_=255,v=0);let k,w,T,A,F,R;if(N>0)k=d+N*(255-d),w=c-N*(c-0),T=g+N*(255-g),A=p-N*(p-0),F=_+N*(255-_),R=v-N*(v-0);else{const E=(d+c)*.5;k=d+N*(d-E),w=c+N*(c-E);const D=(g+p)*.5;T=g+N*(g-D),A=p+N*(p-D);const I=(_+v)*.5;F=_+N*(_-I),R=v+N*(v-I)}for(let E=0;E<l;E+=4)i[E+0]=n(i[E+0],c,d,w,k),i[E+1]=n(i[E+1],p,g,A,T),i[E+2]=n(i[E+2],v,_,R,F)};return em.Enhance=s,e.Factory.addGetterSetter(t.Node,"enhance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),em}var tm={},LT;function LM(){if(LT)return tm;LT=1,Object.defineProperty(tm,"__esModule",{value:!0}),tm.Grayscale=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=.34*r[s]+.5*r[s+1]+.16*r[s+2];r[s]=a,r[s+1]=a,r[s+2]=a}};return tm.Grayscale=e,tm}var rm={},BT;function BM(){if(BT)return rm;BT=1,Object.defineProperty(rm,"__esModule",{value:!0}),rm.HSL=void 0;const e=Kr(),t=Ts(),r=Xr();e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"luminance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter);const n=function(s){const a=s.data,i=a.length,l=1,c=Math.pow(2,this.saturation()),d=Math.abs(this.hue()+360)%360,f=this.luminance()*127,p=l*c*Math.cos(d*Math.PI/180),g=l*c*Math.sin(d*Math.PI/180),y=.299*l+.701*p+.167*g,v=.587*l-.587*p+.33*g,_=.114*l-.114*p-.497*g,b=.299*l-.299*p-.328*g,N=.587*l+.413*p+.035*g,k=.114*l-.114*p+.293*g,w=.299*l-.3*p+1.25*g,T=.587*l-.586*p-1.05*g,A=.114*l+.886*p-.2*g;let F,R,E,D;for(let I=0;I<i;I+=4)F=a[I+0],R=a[I+1],E=a[I+2],D=a[I+3],a[I+0]=y*F+v*R+_*E+f,a[I+1]=b*F+N*R+k*E+f,a[I+2]=w*F+T*R+A*E+f,a[I+3]=D};return rm.HSL=n,rm}var nm={},UT;function UM(){if(UT)return nm;UT=1,Object.defineProperty(nm,"__esModule",{value:!0}),nm.HSV=void 0;const e=Kr(),t=Ts(),r=Xr(),n=function(s){const a=s.data,i=a.length,l=Math.pow(2,this.value()),c=Math.pow(2,this.saturation()),d=Math.abs(this.hue()+360)%360,f=l*c*Math.cos(d*Math.PI/180),p=l*c*Math.sin(d*Math.PI/180),g=.299*l+.701*f+.167*p,y=.587*l-.587*f+.33*p,v=.114*l-.114*f-.497*p,_=.299*l-.299*f-.328*p,b=.587*l+.413*f+.035*p,N=.114*l-.114*f+.293*p,k=.299*l-.3*f+1.25*p,w=.587*l-.586*f-1.05*p,T=.114*l+.886*f-.2*p;for(let A=0;A<i;A+=4){const F=a[A+0],R=a[A+1],E=a[A+2],D=a[A+3];a[A+0]=g*F+y*R+v*E,a[A+1]=_*F+b*R+N*E,a[A+2]=k*F+w*R+T*E,a[A+3]=D}};return nm.HSV=n,e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"value",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),nm}var sm={},$T;function $M(){if($T)return sm;$T=1,Object.defineProperty(sm,"__esModule",{value:!0}),sm.Invert=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4)r[s]=255-r[s],r[s+1]=255-r[s+1],r[s+2]=255-r[s+2]};return sm.Invert=e,sm}var am={},WT;function WM(){if(WT)return am;WT=1,Object.defineProperty(am,"__esModule",{value:!0}),am.Kaleidoscope=void 0;const e=Kr(),t=Ts(),r=ms(),n=Xr(),s=function(l,c,d){const f=l.data,p=c.data,g=l.width,y=l.height,v=d.polarCenterX||g/2,_=d.polarCenterY||y/2;let b=Math.sqrt(v*v+_*_),N=g-v,k=y-_;const w=Math.sqrt(N*N+k*k);b=w>b?w:b;const T=y,A=g,F=360/A*Math.PI/180;for(let R=0;R<A;R+=1){const E=Math.sin(R*F),D=Math.cos(R*F);for(let I=0;I<T;I+=1){N=Math.floor(v+b*I/T*D),k=Math.floor(_+b*I/T*E);let G=(k*g+N)*4;const Y=f[G+0],ee=f[G+1],ie=f[G+2],re=f[G+3];G=(R+I*g)*4,p[G+0]=Y,p[G+1]=ee,p[G+2]=ie,p[G+3]=re}}},a=function(l,c,d){const f=l.data,p=c.data,g=l.width,y=l.height,v=d.polarCenterX||g/2,_=d.polarCenterY||y/2;let b=Math.sqrt(v*v+_*_),N=g-v,k=y-_;const w=Math.sqrt(N*N+k*k);b=w>b?w:b;const T=y,A=g,F=0;let R,E;for(N=0;N<g;N+=1)for(k=0;k<y;k+=1){const D=N-v,I=k-_,G=Math.sqrt(D*D+I*I)*T/b;let Y=(Math.atan2(I,D)*180/Math.PI+360+F)%360;Y=Y*A/360,R=Math.floor(Y),E=Math.floor(G);let ee=(E*g+R)*4;const ie=f[ee+0],re=f[ee+1],se=f[ee+2],B=f[ee+3];ee=(k*g+N)*4,p[ee+0]=ie,p[ee+1]=re,p[ee+2]=se,p[ee+3]=B}},i=function(l){const c=l.width,d=l.height;let f,p,g,y,v,_,b,N,k,w,T=Math.round(this.kaleidoscopePower());const A=Math.round(this.kaleidoscopeAngle()),F=Math.floor(c*(A%360)/360);if(T<1)return;const R=r.Util.createCanvasElement();R.width=c,R.height=d;const E=R.getContext("2d").getImageData(0,0,c,d);r.Util.releaseCanvas(R),s(l,E,{polarCenterX:c/2,polarCenterY:d/2});let D=c/Math.pow(2,T);for(;D<=8;)D=D*2,T-=1;D=Math.ceil(D);let I=D,G=0,Y=I,ee=1;for(F+D>c&&(G=I,Y=0,ee=-1),p=0;p<d;p+=1)for(f=G;f!==Y;f+=ee)g=Math.round(f+F)%c,k=(c*p+g)*4,v=E.data[k+0],_=E.data[k+1],b=E.data[k+2],N=E.data[k+3],w=(c*p+f)*4,E.data[w+0]=v,E.data[w+1]=_,E.data[w+2]=b,E.data[w+3]=N;for(p=0;p<d;p+=1)for(I=Math.floor(D),y=0;y<T;y+=1){for(f=0;f<I+1;f+=1)k=(c*p+f)*4,v=E.data[k+0],_=E.data[k+1],b=E.data[k+2],N=E.data[k+3],w=(c*p+I*2-f-1)*4,E.data[w+0]=v,E.data[w+1]=_,E.data[w+2]=b,E.data[w+3]=N;I*=2}a(E,l,{})};return am.Kaleidoscope=i,e.Factory.addGetterSetter(t.Node,"kaleidoscopePower",2,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"kaleidoscopeAngle",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),am}var im={},zT;function zM(){if(zT)return im;zT=1,Object.defineProperty(im,"__esModule",{value:!0}),im.Mask=void 0;const e=Kr(),t=Ts(),r=Xr();function n(g,y,v){let _=(v*g.width+y)*4;const b=[];return b.push(g.data[_++],g.data[_++],g.data[_++],g.data[_++]),b}function s(g,y){return Math.sqrt(Math.pow(g[0]-y[0],2)+Math.pow(g[1]-y[1],2)+Math.pow(g[2]-y[2],2))}function a(g){const y=[0,0,0];for(let v=0;v<g.length;v++)y[0]+=g[v][0],y[1]+=g[v][1],y[2]+=g[v][2];return y[0]/=g.length,y[1]/=g.length,y[2]/=g.length,y}function i(g,y){const v=n(g,0,0),_=n(g,g.width-1,0),b=n(g,0,g.height-1),N=n(g,g.width-1,g.height-1),k=y||10;if(s(v,_)<k&&s(_,N)<k&&s(N,b)<k&&s(b,v)<k){const w=a([_,v,N,b]),T=[];for(let A=0;A<g.width*g.height;A++){const F=s(w,[g.data[A*4],g.data[A*4+1],g.data[A*4+2]]);T[A]=F<k?0:255}return T}}function l(g,y){for(let v=0;v<g.width*g.height;v++)g.data[4*v+3]=y[v]}function c(g,y,v){const _=[1,1,1,1,0,1,1,1,1],b=Math.round(Math.sqrt(_.length)),N=Math.floor(b/2),k=[];for(let w=0;w<v;w++)for(let T=0;T<y;T++){const A=w*y+T;let F=0;for(let R=0;R<b;R++)for(let E=0;E<b;E++){const D=w+R-N,I=T+E-N;if(D>=0&&D<v&&I>=0&&I<y){const G=D*y+I,Y=_[R*b+E];F+=g[G]*Y}}k[A]=F===2040?255:0}return k}function d(g,y,v){const _=[1,1,1,1,1,1,1,1,1],b=Math.round(Math.sqrt(_.length)),N=Math.floor(b/2),k=[];for(let w=0;w<v;w++)for(let T=0;T<y;T++){const A=w*y+T;let F=0;for(let R=0;R<b;R++)for(let E=0;E<b;E++){const D=w+R-N,I=T+E-N;if(D>=0&&D<v&&I>=0&&I<y){const G=D*y+I,Y=_[R*b+E];F+=g[G]*Y}}k[A]=F>=1020?255:0}return k}function f(g,y,v){const _=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],b=Math.round(Math.sqrt(_.length)),N=Math.floor(b/2),k=[];for(let w=0;w<v;w++)for(let T=0;T<y;T++){const A=w*y+T;let F=0;for(let R=0;R<b;R++)for(let E=0;E<b;E++){const D=w+R-N,I=T+E-N;if(D>=0&&D<v&&I>=0&&I<y){const G=D*y+I,Y=_[R*b+E];F+=g[G]*Y}}k[A]=F}return k}const p=function(g){const y=this.threshold();let v=i(g,y);return v&&(v=c(v,g.width,g.height),v=d(v,g.width,g.height),v=f(v,g.width,g.height),l(g,v)),g};return im.Mask=p,e.Factory.addGetterSetter(t.Node,"threshold",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),im}var om={},HT;function HM(){if(HT)return om;HT=1,Object.defineProperty(om,"__esModule",{value:!0}),om.Noise=void 0;const e=Kr(),t=Ts(),r=Xr(),n=function(s){const a=this.noise()*255,i=s.data,l=i.length,c=a/2;for(let d=0;d<l;d+=4)i[d+0]+=c-2*c*Math.random(),i[d+1]+=c-2*c*Math.random(),i[d+2]+=c-2*c*Math.random()};return om.Noise=n,e.Factory.addGetterSetter(t.Node,"noise",.2,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),om}var lm={},GT;function GM(){if(GT)return lm;GT=1,Object.defineProperty(lm,"__esModule",{value:!0}),lm.Pixelate=void 0;const e=Kr(),t=ms(),r=Ts(),n=Xr(),s=function(a){let i=Math.ceil(this.pixelSize()),l=a.width,c=a.height,d=Math.ceil(l/i),f=Math.ceil(c/i),p=a.data;if(i<=0){t.Util.error("pixelSize value can not be <= 0");return}for(let g=0;g<d;g+=1)for(let y=0;y<f;y+=1){let v=0,_=0,b=0,N=0;const k=g*i,w=k+i,T=y*i,A=T+i;let F=0;for(let R=k;R<w;R+=1)if(!(R>=l))for(let E=T;E<A;E+=1){if(E>=c)continue;const D=(l*E+R)*4;v+=p[D+0],_+=p[D+1],b+=p[D+2],N+=p[D+3],F+=1}v=v/F,_=_/F,b=b/F,N=N/F;for(let R=k;R<w;R+=1)if(!(R>=l))for(let E=T;E<A;E+=1){if(E>=c)continue;const D=(l*E+R)*4;p[D+0]=v,p[D+1]=_,p[D+2]=b,p[D+3]=N}}};return lm.Pixelate=s,e.Factory.addGetterSetter(r.Node,"pixelSize",8,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),lm}var cm={},VT;function VM(){if(VT)return cm;VT=1,Object.defineProperty(cm,"__esModule",{value:!0}),cm.Posterize=void 0;const e=Kr(),t=Ts(),r=Xr(),n=function(s){const a=Math.round(this.levels()*254)+1,i=s.data,l=i.length,c=255/a;for(let d=0;d<l;d+=1)i[d]=Math.floor(i[d]/c)*c};return cm.Posterize=n,e.Factory.addGetterSetter(t.Node,"levels",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),cm}var um={},KT;function KM(){if(KT)return um;KT=1,Object.defineProperty(um,"__esModule",{value:!0}),um.RGB=void 0;const e=Kr(),t=Ts(),r=Xr(),n=function(s){const a=s.data,i=a.length,l=this.red(),c=this.green(),d=this.blue();for(let f=0;f<i;f+=4){const p=(.34*a[f]+.5*a[f+1]+.16*a[f+2])/255;a[f]=p*l,a[f+1]=p*c,a[f+2]=p*d,a[f+3]=a[f+3]}};return um.RGB=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),um}var dm={},qT;function qM(){if(qT)return dm;qT=1,Object.defineProperty(dm,"__esModule",{value:!0}),dm.RGBA=void 0;const e=Kr(),t=Ts(),r=Xr(),n=function(s){const a=s.data,i=a.length,l=this.red(),c=this.green(),d=this.blue(),f=this.alpha();for(let p=0;p<i;p+=4){const g=1-f;a[p]=l*f+a[p]*g,a[p+1]=c*f+a[p+1]*g,a[p+2]=d*f+a[p+2]*g}};return dm.RGBA=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),dm}var fm={},XT;function XM(){if(XT)return fm;XT=1,Object.defineProperty(fm,"__esModule",{value:!0}),fm.Sepia=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=r[s+0],i=r[s+1],l=r[s+2];r[s+0]=Math.min(255,a*.393+i*.769+l*.189),r[s+1]=Math.min(255,a*.349+i*.686+l*.168),r[s+2]=Math.min(255,a*.272+i*.534+l*.131)}};return fm.Sepia=e,fm}var hm={},YT;function YM(){if(YT)return hm;YT=1,Object.defineProperty(hm,"__esModule",{value:!0}),hm.Solarize=void 0;const e=function(t){const r=t.data,n=t.width,s=t.height,a=n*4;let i=s;do{const l=(i-1)*a;let c=n;do{const d=l+(c-1)*4;let f=r[d],p=r[d+1],g=r[d+2];f>127&&(f=255-f),p>127&&(p=255-p),g>127&&(g=255-g),r[d]=f,r[d+1]=p,r[d+2]=g}while(--c)}while(--i)};return hm.Solarize=e,hm}var gm={},JT;function JM(){if(JT)return gm;JT=1,Object.defineProperty(gm,"__esModule",{value:!0}),gm.Threshold=void 0;const e=Kr(),t=Ts(),r=Xr(),n=function(s){const a=this.threshold()*255,i=s.data,l=i.length;for(let c=0;c<l;c+=1)i[c]=i[c]<a?0:255};return gm.Threshold=n,e.Factory.addGetterSetter(t.Node,"threshold",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),gm}var QT;function QM(){if(QT)return Ng;QT=1,Object.defineProperty(Ng,"__esModule",{value:!0}),Ng.Konva=void 0;const e=C_(),t=vM(),r=_M(),n=bM(),s=SM(),a=kM(),i=CM(),l=k6(),c=ob(),d=C6(),f=TM(),p=EM(),g=NM(),y=AM(),v=T6(),_=jM(),b=FM(),N=PM(),k=RM(),w=DM(),T=IM(),A=MM(),F=OM(),R=LM(),E=BM(),D=UM(),I=$M(),G=WM(),Y=zM(),ee=HM(),ie=GM(),re=VM(),se=KM(),B=qM(),z=XM(),U=YM(),V=JM();return Ng.Konva=e.Konva.Util._assign(e.Konva,{Arc:t.Arc,Arrow:r.Arrow,Circle:n.Circle,Ellipse:s.Ellipse,Image:a.Image,Label:i.Label,Tag:i.Tag,Line:l.Line,Path:c.Path,Rect:d.Rect,RegularPolygon:f.RegularPolygon,Ring:p.Ring,Sprite:g.Sprite,Star:y.Star,Text:v.Text,TextPath:_.TextPath,Transformer:b.Transformer,Wedge:N.Wedge,Filters:{Blur:k.Blur,Brighten:w.Brighten,Contrast:T.Contrast,Emboss:A.Emboss,Enhance:F.Enhance,Grayscale:R.Grayscale,HSL:E.HSL,HSV:D.HSV,Invert:I.Invert,Kaleidoscope:G.Kaleidoscope,Mask:Y.Mask,Noise:ee.Noise,Pixelate:ie.Pixelate,Posterize:re.Posterize,RGB:se.RGB,RGBA:B.RGBA,Sepia:z.Sepia,Solarize:U.Solarize,Threshold:V.Threshold}}),Ng}var ZM=Ry.exports,ZT;function eO(){if(ZT)return Ry.exports;ZT=1,Object.defineProperty(ZM,"__esModule",{value:!0});const e=QM();return Ry.exports=e.Konva,Ry.exports}var E6=eO();const tO=Cp(E6),rO=C3({__proto__:null,default:tO},[E6]);var iy={exports:{}},e4;function nO(){return e4||(e4=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var r=C_();Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=C_();e.exports=n.Konva})(iy,iy.exports)),iy.exports}var sO=nO();const tp=Cp(sO);var pw={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xw,t4;function aO(){return t4||(t4=1,xw=function(t){var r={},n=E1(),s=w2(),a=Object.assign;function i(m){for(var x="https://reactjs.org/docs/error-decoder.html?invariant="+m,j=1;j<arguments.length;j++)x+="&args[]="+encodeURIComponent(arguments[j]);return"Minified React error #"+m+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),d=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),v=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),T=Symbol.for("react.offscreen"),A=Symbol.iterator;function F(m){return m===null||typeof m!="object"?null:(m=A&&m[A]||m["@@iterator"],typeof m=="function"?m:null)}function R(m){if(m==null)return null;if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case f:return"Fragment";case d:return"Portal";case g:return"Profiler";case p:return"StrictMode";case b:return"Suspense";case N:return"SuspenseList"}if(typeof m=="object")switch(m.$$typeof){case v:return(m.displayName||"Context")+".Consumer";case y:return(m._context.displayName||"Context")+".Provider";case _:var x=m.render;return m=m.displayName,m||(m=x.displayName||x.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case k:return x=m.displayName||null,x!==null?x:R(m.type)||"Memo";case w:x=m._payload,m=m._init;try{return R(m(x))}catch{}}return null}function E(m){var x=m.type;switch(m.tag){case 24:return"Cache";case 9:return(x.displayName||"Context")+".Consumer";case 10:return(x._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return m=x.render,m=m.displayName||m.name||"",x.displayName||(m!==""?"ForwardRef("+m+")":"ForwardRef");case 7:return"Fragment";case 5:return x;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return R(x);case 8:return x===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x}return null}function D(m){var x=m,j=m;if(m.alternate)for(;x.return;)x=x.return;else{m=x;do x=m,(x.flags&4098)!==0&&(j=x.return),m=x.return;while(m)}return x.tag===3?j:null}function I(m){if(D(m)!==m)throw Error(i(188))}function G(m){var x=m.alternate;if(!x){if(x=D(m),x===null)throw Error(i(188));return x!==m?null:m}for(var j=m,O=x;;){var H=j.return;if(H===null)break;var te=H.alternate;if(te===null){if(O=H.return,O!==null){j=O;continue}break}if(H.child===te.child){for(te=H.child;te;){if(te===j)return I(H),m;if(te===O)return I(H),x;te=te.sibling}throw Error(i(188))}if(j.return!==O.return)j=H,O=te;else{for(var ye=!1,Be=H.child;Be;){if(Be===j){ye=!0,j=H,O=te;break}if(Be===O){ye=!0,O=H,j=te;break}Be=Be.sibling}if(!ye){for(Be=te.child;Be;){if(Be===j){ye=!0,j=te,O=H;break}if(Be===O){ye=!0,O=te,j=H;break}Be=Be.sibling}if(!ye)throw Error(i(189))}}if(j.alternate!==O)throw Error(i(190))}if(j.tag!==3)throw Error(i(188));return j.stateNode.current===j?m:x}function Y(m){return m=G(m),m!==null?ee(m):null}function ee(m){if(m.tag===5||m.tag===6)return m;for(m=m.child;m!==null;){var x=ee(m);if(x!==null)return x;m=m.sibling}return null}function ie(m){if(m.tag===5||m.tag===6)return m;for(m=m.child;m!==null;){if(m.tag!==4){var x=ie(m);if(x!==null)return x}m=m.sibling}return null}var re=Array.isArray,se=t.getPublicInstance,B=t.getRootHostContext,z=t.getChildHostContext,U=t.prepareForCommit,V=t.resetAfterCommit,q=t.createInstance,L=t.appendInitialChild,M=t.finalizeInitialChildren,X=t.prepareUpdate,K=t.shouldSetTextContent,Z=t.createTextInstance,J=t.scheduleTimeout,ne=t.cancelTimeout,me=t.noTimeout,xe=t.isPrimaryRenderer,Ne=t.supportsMutation,le=t.supportsPersistence,ge=t.supportsHydration,Ue=t.getInstanceFromNode,Ge=t.preparePortalMount,Je=t.getCurrentEventPriority,He=t.detachDeletedInstance,Ft=t.supportsMicrotasks,rt=t.scheduleMicrotask,Ie=t.supportsTestSelectors,Pe=t.findFiberRoot,Qe=t.getBoundingRect,_t=t.getTextContent,gt=t.isHiddenSubtree,Bt=t.matchAccessibilityRole,Ut=t.setFocusIfFocusable,it=t.setupIntersectionObserver,Ye=t.appendChild,xt=t.appendChildToContainer,ut=t.commitTextUpdate,wt=t.commitMount,$t=t.commitUpdate,Kt=t.insertBefore,De=t.insertInContainerBefore,ct=t.removeChild,mt=t.removeChildFromContainer,At=t.resetTextContent,Lt=t.hideInstance,rr=t.hideTextInstance,Ee=t.unhideInstance,we=t.unhideTextInstance,fe=t.clearContainer,_e=t.cloneInstance,$e=t.createContainerChildSet,St=t.appendChildToContainerChildSet,pt=t.finalizeContainerChildren,Xt=t.replaceContainerChildren,Jt=t.cloneHiddenInstance,Yt=t.cloneHiddenTextInstance,pr=t.canHydrateInstance,Ir=t.canHydrateTextInstance,xr=t.canHydrateSuspenseInstance,Tr=t.isSuspenseInstancePending,Mr=t.isSuspenseInstanceFallback,Wr=t.getSuspenseInstanceFallbackErrorDetails,ce=t.registerSuspenseInstanceRetry,Se=t.getNextHydratableSibling,pe=t.getFirstHydratableChild,ve=t.getFirstHydratableChildWithinContainer,be=t.getFirstHydratableChildWithinSuspenseInstance,ke=t.hydrateInstance,We=t.hydrateTextInstance,dt=t.hydrateSuspenseInstance,Ve=t.getNextHydratableInstanceAfterSuspenseInstance,oe=t.commitHydratedContainer,he=t.commitHydratedSuspenseInstance,Te=t.clearSuspenseBoundary,je=t.clearSuspenseBoundaryFromContainer,qe=t.shouldDeleteUnhydratedTailInstances,at=t.didNotMatchHydratedContainerTextInstance,Le=t.didNotMatchHydratedTextInstance,Ct;function Mt(m){if(Ct===void 0)try{throw Error()}catch(j){var x=j.stack.trim().match(/\n( *(at )?)/);Ct=x&&x[1]||""}return`
`+Ct+m}var Vt=!1;function dr(m,x){if(!m||Vt)return"";Vt=!0;var j=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(x)if(x=function(){throw Error()},Object.defineProperty(x.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(x,[])}catch(Dt){var O=Dt}Reflect.construct(m,[],x)}else{try{x.call()}catch(Dt){O=Dt}m.call(x.prototype)}else{try{throw Error()}catch(Dt){O=Dt}m()}}catch(Dt){if(Dt&&O&&typeof Dt.stack=="string"){for(var H=Dt.stack.split(`
`),te=O.stack.split(`
`),ye=H.length-1,Be=te.length-1;1<=ye&&0<=Be&&H[ye]!==te[Be];)Be--;for(;1<=ye&&0<=Be;ye--,Be--)if(H[ye]!==te[Be]){if(ye!==1||Be!==1)do if(ye--,Be--,0>Be||H[ye]!==te[Be]){var lt=`
`+H[ye].replace(" at new "," at ");return m.displayName&&lt.includes("<anonymous>")&&(lt=lt.replace("<anonymous>",m.displayName)),lt}while(1<=ye&&0<=Be);break}}}finally{Vt=!1,Error.prepareStackTrace=j}return(m=m?m.displayName||m.name:"")?Mt(m):""}var Nn=Object.prototype.hasOwnProperty,ln=[],In=-1;function Pr(m){return{current:m}}function Or(m){0>In||(m.current=ln[In],ln[In]=null,In--)}function cr(m,x){In++,ln[In]=m.current,m.current=x}var ae={},ue=Pr(ae),Ce=Pr(!1),Oe=ae;function Xe(m,x){var j=m.type.contextTypes;if(!j)return ae;var O=m.stateNode;if(O&&O.__reactInternalMemoizedUnmaskedChildContext===x)return O.__reactInternalMemoizedMaskedChildContext;var H={},te;for(te in j)H[te]=x[te];return O&&(m=m.stateNode,m.__reactInternalMemoizedUnmaskedChildContext=x,m.__reactInternalMemoizedMaskedChildContext=H),H}function It(m){return m=m.childContextTypes,m!=null}function ht(){Or(Ce),Or(ue)}function fr(m,x,j){if(ue.current!==ae)throw Error(i(168));cr(ue,x),cr(Ce,j)}function mr(m,x,j){var O=m.stateNode;if(x=x.childContextTypes,typeof O.getChildContext!="function")return j;O=O.getChildContext();for(var H in O)if(!(H in x))throw Error(i(108,E(m)||"Unknown",H));return a({},j,O)}function nt(m){return m=(m=m.stateNode)&&m.__reactInternalMemoizedMergedChildContext||ae,Oe=ue.current,cr(ue,m),cr(Ce,Ce.current),!0}function jt(m,x,j){var O=m.stateNode;if(!O)throw Error(i(169));j?(m=mr(m,x,Oe),O.__reactInternalMemoizedMergedChildContext=m,Or(Ce),Or(ue),cr(ue,m)):Or(Ce),cr(Ce,j)}var er=Math.clz32?Math.clz32:Mn,un=Math.log,Xn=Math.LN2;function Mn(m){return m>>>=0,m===0?32:31-(un(m)/Xn|0)|0}var sr=64,dn=4194304;function Yn(m){switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return m&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return m}}function Lr(m,x){var j=m.pendingLanes;if(j===0)return 0;var O=0,H=m.suspendedLanes,te=m.pingedLanes,ye=j&268435455;if(ye!==0){var Be=ye&~H;Be!==0?O=Yn(Be):(te&=ye,te!==0&&(O=Yn(te)))}else ye=j&~H,ye!==0?O=Yn(ye):te!==0&&(O=Yn(te));if(O===0)return 0;if(x!==0&&x!==O&&(x&H)===0&&(H=O&-O,te=x&-x,H>=te||H===16&&(te&4194240)!==0))return x;if((O&4)!==0&&(O|=j&16),x=m.entangledLanes,x!==0)for(m=m.entanglements,x&=O;0<x;)j=31-er(x),H=1<<j,O|=m[j],x&=~H;return O}function Nf(m,x){switch(m){case 1:case 2:case 4:return x+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return x+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rx(m,x){for(var j=m.suspendedLanes,O=m.pingedLanes,H=m.expirationTimes,te=m.pendingLanes;0<te;){var ye=31-er(te),Be=1<<ye,lt=H[ye];lt===-1?((Be&j)===0||(Be&O)!==0)&&(H[ye]=Nf(Be,x)):lt<=x&&(m.expiredLanes|=Be),te&=~Be}}function Af(m){return m=m.pendingLanes&-1073741825,m!==0?m:m&1073741824?1073741824:0}function jf(){var m=sr;return sr<<=1,(sr&4194240)===0&&(sr=64),m}function Lc(m){for(var x=[],j=0;31>j;j++)x.push(m);return x}function mi(m,x,j){m.pendingLanes|=x,x!==536870912&&(m.suspendedLanes=0,m.pingedLanes=0),m=m.eventTimes,x=31-er(x),m[x]=j}function rl(m,x){var j=m.pendingLanes&~x;m.pendingLanes=x,m.suspendedLanes=0,m.pingedLanes=0,m.expiredLanes&=x,m.mutableReadLanes&=x,m.entangledLanes&=x,x=m.entanglements;var O=m.eventTimes;for(m=m.expirationTimes;0<j;){var H=31-er(j),te=1<<H;x[H]=0,O[H]=-1,m[H]=-1,j&=~te}}function Yi(m,x){var j=m.entangledLanes|=x;for(m=m.entanglements;j;){var O=31-er(j),H=1<<O;H&x|m[O]&x&&(m[O]|=x),j&=~H}}var zr=0;function Bc(m){return m&=-m,1<m?4<m?(m&268435455)!==0?16:536870912:4:1}var Ji=s.unstable_scheduleCallback,nx=s.unstable_cancelCallback,sx=s.unstable_shouldYield,rd=s.unstable_requestPaint,Ns=s.unstable_now,Ff=s.unstable_ImmediatePriority,Pf=s.unstable_UserBlockingPriority,Rf=s.unstable_NormalPriority,uv=s.unstable_IdlePriority,nl=null,Fa=null;function Uc(m){if(Fa&&typeof Fa.onCommitFiberRoot=="function")try{Fa.onCommitFiberRoot(nl,m,void 0,(m.current.flags&128)===128)}catch{}}function Df(m,x){return m===x&&(m!==0||1/m===1/x)||m!==m&&x!==x}var Di=typeof Object.is=="function"?Object.is:Df,Eo=null,$c=!1,Wc=!1;function If(m){Eo===null?Eo=[m]:Eo.push(m)}function ax(m){$c=!0,If(m)}function Bs(){if(!Wc&&Eo!==null){Wc=!0;var m=0,x=zr;try{var j=Eo;for(zr=1;m<j.length;m++){var O=j[m];do O=O(!0);while(O!==null)}Eo=null,$c=!1}catch(H){throw Eo!==null&&(Eo=Eo.slice(m+1)),Ji(Ff,Bs),H}finally{zr=x,Wc=!1}}return null}var sl=[],No=0,nd=null,Wl=0,da=[],Ya=0,ps=null,Pa=1,Ii="";function Mi(m,x){sl[No++]=Wl,sl[No++]=nd,nd=m,Wl=x}function ix(m,x,j){da[Ya++]=Pa,da[Ya++]=Ii,da[Ya++]=ps,ps=m;var O=Pa;m=Ii;var H=32-er(O)-1;O&=~(1<<H),j+=1;var te=32-er(x)+H;if(30<te){var ye=H-H%5;te=(O&(1<<ye)-1).toString(32),O>>=ye,H-=ye,Pa=1<<32-er(x)+H|j<<H|O,Ii=te+m}else Pa=1<<te|j<<H|O,Ii=m}function sd(m){m.return!==null&&(Mi(m,1),ix(m,1,0))}function ad(m){for(;m===nd;)nd=sl[--No],sl[No]=null,Wl=sl[--No],sl[No]=null;for(;m===ps;)ps=da[--Ya],da[Ya]=null,Ii=da[--Ya],da[Ya]=null,Pa=da[--Ya],da[Ya]=null}var Us=null,fa=null,Cn=!1,id=!1,Oi=null;function ox(m,x){var j=ii(5,null,null,0);j.elementType="DELETED",j.stateNode=x,j.return=m,x=m.deletions,x===null?(m.deletions=[j],m.flags|=16):x.push(j)}function Mf(m,x){switch(m.tag){case 5:return x=pr(x,m.type,m.pendingProps),x!==null?(m.stateNode=x,Us=m,fa=pe(x),!0):!1;case 6:return x=Ir(x,m.pendingProps),x!==null?(m.stateNode=x,Us=m,fa=null,!0):!1;case 13:if(x=xr(x),x!==null){var j=ps!==null?{id:Pa,overflow:Ii}:null;return m.memoizedState={dehydrated:x,treeContext:j,retryLane:1073741824},j=ii(18,null,null,0),j.stateNode=x,j.return=m,m.child=j,Us=m,fa=null,!0}return!1;default:return!1}}function O0(m){return(m.mode&1)!==0&&(m.flags&128)===0}function L0(m){if(Cn){var x=fa;if(x){var j=x;if(!Mf(m,x)){if(O0(m))throw Error(i(418));x=Se(j);var O=Us;x&&Mf(m,x)?ox(O,j):(m.flags=m.flags&-4097|2,Cn=!1,Us=m)}}else{if(O0(m))throw Error(i(418));m.flags=m.flags&-4097|2,Cn=!1,Us=m}}}function lx(m){for(m=m.return;m!==null&&m.tag!==5&&m.tag!==3&&m.tag!==13;)m=m.return;Us=m}function Of(m){if(!ge||m!==Us)return!1;if(!Cn)return lx(m),Cn=!0,!1;if(m.tag!==3&&(m.tag!==5||qe(m.type)&&!K(m.type,m.memoizedProps))){var x=fa;if(x){if(O0(m))throw cx(),Error(i(418));for(;x;)ox(m,x),x=Se(x)}}if(lx(m),m.tag===13){if(!ge)throw Error(i(316));if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));fa=Ve(m)}else fa=Us?Se(m.stateNode):null;return!0}function cx(){for(var m=fa;m;)m=Se(m)}function zl(){ge&&(fa=Us=null,id=Cn=!1)}function B0(m){Oi===null?Oi=[m]:Oi.push(m)}var dv=l.ReactCurrentBatchConfig;function Lf(m,x){if(Di(m,x))return!0;if(typeof m!="object"||m===null||typeof x!="object"||x===null)return!1;var j=Object.keys(m),O=Object.keys(x);if(j.length!==O.length)return!1;for(O=0;O<j.length;O++){var H=j[O];if(!Nn.call(x,H)||!Di(m[H],x[H]))return!1}return!0}function fv(m){switch(m.tag){case 5:return Mt(m.type);case 16:return Mt("Lazy");case 13:return Mt("Suspense");case 19:return Mt("SuspenseList");case 0:case 2:case 15:return m=dr(m.type,!1),m;case 11:return m=dr(m.type.render,!1),m;case 1:return m=dr(m.type,!0),m;default:return""}}function Hl(m,x,j){if(m=j.ref,m!==null&&typeof m!="function"&&typeof m!="object"){if(j._owner){if(j=j._owner,j){if(j.tag!==1)throw Error(i(309));var O=j.stateNode}if(!O)throw Error(i(147,m));var H=O,te=""+m;return x!==null&&x.ref!==null&&typeof x.ref=="function"&&x.ref._stringRef===te?x.ref:(x=function(ye){var Be=H.refs;ye===null?delete Be[te]:Be[te]=ye},x._stringRef=te,x)}if(typeof m!="string")throw Error(i(284));if(!j._owner)throw Error(i(290,m))}return m}function Bf(m,x){throw m=Object.prototype.toString.call(x),Error(i(31,m==="[object Object]"?"object with keys {"+Object.keys(x).join(", ")+"}":m))}function ux(m){var x=m._init;return x(m._payload)}function dx(m){function x(st,ze){if(m){var ft=st.deletions;ft===null?(st.deletions=[ze],st.flags|=16):ft.push(ze)}}function j(st,ze){if(!m)return null;for(;ze!==null;)x(st,ze),ze=ze.sibling;return null}function O(st,ze){for(st=new Map;ze!==null;)ze.key!==null?st.set(ze.key,ze):st.set(ze.index,ze),ze=ze.sibling;return st}function H(st,ze){return st=bl(st,ze),st.index=0,st.sibling=null,st}function te(st,ze,ft){return st.index=ft,m?(ft=st.alternate,ft!==null?(ft=ft.index,ft<ze?(st.flags|=2,ze):ft):(st.flags|=2,ze)):(st.flags|=1048576,ze)}function ye(st){return m&&st.alternate===null&&(st.flags|=2),st}function Be(st,ze,ft,Zt){return ze===null||ze.tag!==6?(ze=hu(ft,st.mode,Zt),ze.return=st,ze):(ze=H(ze,ft),ze.return=st,ze)}function lt(st,ze,ft,Zt){var hr=ft.type;return hr===f?ar(st,ze,ft.props.children,Zt,ft.key):ze!==null&&(ze.elementType===hr||typeof hr=="object"&&hr!==null&&hr.$$typeof===w&&ux(hr)===ze.type)?(Zt=H(ze,ft.props),Zt.ref=Hl(st,ze,ft),Zt.return=st,Zt):(Zt=xh(ft.type,ft.key,ft.props,null,st.mode,Zt),Zt.ref=Hl(st,ze,ft),Zt.return=st,Zt)}function Dt(st,ze,ft,Zt){return ze===null||ze.tag!==4||ze.stateNode.containerInfo!==ft.containerInfo||ze.stateNode.implementation!==ft.implementation?(ze=yh(ft,st.mode,Zt),ze.return=st,ze):(ze=H(ze,ft.children||[]),ze.return=st,ze)}function ar(st,ze,ft,Zt,hr){return ze===null||ze.tag!==7?(ze=zs(ft,st.mode,Zt,hr),ze.return=st,ze):(ze=H(ze,ft),ze.return=st,ze)}function Er(st,ze,ft){if(typeof ze=="string"&&ze!==""||typeof ze=="number")return ze=hu(""+ze,st.mode,ft),ze.return=st,ze;if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case c:return ft=xh(ze.type,ze.key,ze.props,null,st.mode,ft),ft.ref=Hl(st,null,ze),ft.return=st,ft;case d:return ze=yh(ze,st.mode,ft),ze.return=st,ze;case w:var Zt=ze._init;return Er(st,Zt(ze._payload),ft)}if(re(ze)||F(ze))return ze=zs(ze,st.mode,ft,null),ze.return=st,ze;Bf(st,ze)}return null}function Qt(st,ze,ft,Zt){var hr=ze!==null?ze.key:null;if(typeof ft=="string"&&ft!==""||typeof ft=="number")return hr!==null?null:Be(st,ze,""+ft,Zt);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case c:return ft.key===hr?lt(st,ze,ft,Zt):null;case d:return ft.key===hr?Dt(st,ze,ft,Zt):null;case w:return hr=ft._init,Qt(st,ze,hr(ft._payload),Zt)}if(re(ft)||F(ft))return hr!==null?null:ar(st,ze,ft,Zt,null);Bf(st,ft)}return null}function bn(st,ze,ft,Zt,hr){if(typeof Zt=="string"&&Zt!==""||typeof Zt=="number")return st=st.get(ft)||null,Be(ze,st,""+Zt,hr);if(typeof Zt=="object"&&Zt!==null){switch(Zt.$$typeof){case c:return st=st.get(Zt.key===null?ft:Zt.key)||null,lt(ze,st,Zt,hr);case d:return st=st.get(Zt.key===null?ft:Zt.key)||null,Dt(ze,st,Zt,hr);case w:var Rr=Zt._init;return bn(st,ze,ft,Rr(Zt._payload),hr)}if(re(Zt)||F(Zt))return st=st.get(ft)||null,ar(ze,st,Zt,hr,null);Bf(ze,Zt)}return null}function an(st,ze,ft,Zt){for(var hr=null,Rr=null,Nr=ze,qr=ze=0,_s=null;Nr!==null&&qr<ft.length;qr++){Nr.index>qr?(_s=Nr,Nr=null):_s=Nr.sibling;var Vr=Qt(st,Nr,ft[qr],Zt);if(Vr===null){Nr===null&&(Nr=_s);break}m&&Nr&&Vr.alternate===null&&x(st,Nr),ze=te(Vr,ze,qr),Rr===null?hr=Vr:Rr.sibling=Vr,Rr=Vr,Nr=_s}if(qr===ft.length)return j(st,Nr),Cn&&Mi(st,qr),hr;if(Nr===null){for(;qr<ft.length;qr++)Nr=Er(st,ft[qr],Zt),Nr!==null&&(ze=te(Nr,ze,qr),Rr===null?hr=Nr:Rr.sibling=Nr,Rr=Nr);return Cn&&Mi(st,qr),hr}for(Nr=O(st,Nr);qr<ft.length;qr++)_s=bn(Nr,st,qr,ft[qr],Zt),_s!==null&&(m&&_s.alternate!==null&&Nr.delete(_s.key===null?qr:_s.key),ze=te(_s,ze,qr),Rr===null?hr=_s:Rr.sibling=_s,Rr=_s);return m&&Nr.forEach(function(ta){return x(st,ta)}),Cn&&Mi(st,qr),hr}function ya(st,ze,ft,Zt){var hr=F(ft);if(typeof hr!="function")throw Error(i(150));if(ft=hr.call(ft),ft==null)throw Error(i(151));for(var Rr=hr=null,Nr=ze,qr=ze=0,_s=null,Vr=ft.next();Nr!==null&&!Vr.done;qr++,Vr=ft.next()){Nr.index>qr?(_s=Nr,Nr=null):_s=Nr.sibling;var ta=Qt(st,Nr,Vr.value,Zt);if(ta===null){Nr===null&&(Nr=_s);break}m&&Nr&&ta.alternate===null&&x(st,Nr),ze=te(ta,ze,qr),Rr===null?hr=ta:Rr.sibling=ta,Rr=ta,Nr=_s}if(Vr.done)return j(st,Nr),Cn&&Mi(st,qr),hr;if(Nr===null){for(;!Vr.done;qr++,Vr=ft.next())Vr=Er(st,Vr.value,Zt),Vr!==null&&(ze=te(Vr,ze,qr),Rr===null?hr=Vr:Rr.sibling=Vr,Rr=Vr);return Cn&&Mi(st,qr),hr}for(Nr=O(st,Nr);!Vr.done;qr++,Vr=ft.next())Vr=bn(Nr,st,qr,Vr.value,Zt),Vr!==null&&(m&&Vr.alternate!==null&&Nr.delete(Vr.key===null?qr:Vr.key),ze=te(Vr,ze,qr),Rr===null?hr=Vr:Rr.sibling=Vr,Rr=Vr);return m&&Nr.forEach(function(xv){return x(st,xv)}),Cn&&Mi(st,qr),hr}function io(st,ze,ft,Zt){if(typeof ft=="object"&&ft!==null&&ft.type===f&&ft.key===null&&(ft=ft.props.children),typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case c:e:{for(var hr=ft.key,Rr=ze;Rr!==null;){if(Rr.key===hr){if(hr=ft.type,hr===f){if(Rr.tag===7){j(st,Rr.sibling),ze=H(Rr,ft.props.children),ze.return=st,st=ze;break e}}else if(Rr.elementType===hr||typeof hr=="object"&&hr!==null&&hr.$$typeof===w&&ux(hr)===Rr.type){j(st,Rr.sibling),ze=H(Rr,ft.props),ze.ref=Hl(st,Rr,ft),ze.return=st,st=ze;break e}j(st,Rr);break}else x(st,Rr);Rr=Rr.sibling}ft.type===f?(ze=zs(ft.props.children,st.mode,Zt,ft.key),ze.return=st,st=ze):(Zt=xh(ft.type,ft.key,ft.props,null,st.mode,Zt),Zt.ref=Hl(st,ze,ft),Zt.return=st,st=Zt)}return ye(st);case d:e:{for(Rr=ft.key;ze!==null;){if(ze.key===Rr)if(ze.tag===4&&ze.stateNode.containerInfo===ft.containerInfo&&ze.stateNode.implementation===ft.implementation){j(st,ze.sibling),ze=H(ze,ft.children||[]),ze.return=st,st=ze;break e}else{j(st,ze);break}else x(st,ze);ze=ze.sibling}ze=yh(ft,st.mode,Zt),ze.return=st,st=ze}return ye(st);case w:return Rr=ft._init,io(st,ze,Rr(ft._payload),Zt)}if(re(ft))return an(st,ze,ft,Zt);if(F(ft))return ya(st,ze,ft,Zt);Bf(st,ft)}return typeof ft=="string"&&ft!==""||typeof ft=="number"?(ft=""+ft,ze!==null&&ze.tag===6?(j(st,ze.sibling),ze=H(ze,ft),ze.return=st,st=ze):(j(st,ze),ze=hu(ft,st.mode,Zt),ze.return=st,st=ze),ye(st)):j(st,ze)}return io}var Gl=dx(!0),fx=dx(!1),Uf=Pr(null),$f=null,zc=null,U0=null;function $0(){U0=zc=$f=null}function hx(m,x,j){xe?(cr(Uf,x._currentValue),x._currentValue=j):(cr(Uf,x._currentValue2),x._currentValue2=j)}function od(m){var x=Uf.current;Or(Uf),xe?m._currentValue=x:m._currentValue2=x}function Vl(m,x,j){for(;m!==null;){var O=m.alternate;if((m.childLanes&x)!==x?(m.childLanes|=x,O!==null&&(O.childLanes|=x)):O!==null&&(O.childLanes&x)!==x&&(O.childLanes|=x),m===j)break;m=m.return}}function Hc(m,x){$f=m,U0=zc=null,m=m.dependencies,m!==null&&m.firstContext!==null&&((m.lanes&x)!==0&&(ys=!0),m.firstContext=null)}function Ja(m){var x=xe?m._currentValue:m._currentValue2;if(U0!==m)if(m={context:m,memoizedValue:x,next:null},zc===null){if($f===null)throw Error(i(308));zc=m,$f.dependencies={lanes:0,firstContext:m}}else zc=zc.next=m;return x}var al=null;function Wf(m){al===null?al=[m]:al.push(m)}function W0(m,x,j,O){var H=x.interleaved;return H===null?(j.next=j,Wf(x)):(j.next=H.next,H.next=j),x.interleaved=j,Li(m,O)}function Li(m,x){m.lanes|=x;var j=m.alternate;for(j!==null&&(j.lanes|=x),j=m,m=m.return;m!==null;)m.childLanes|=x,j=m.alternate,j!==null&&(j.childLanes|=x),j=m,m=m.return;return j.tag===3?j.stateNode:null}var Qa=!1;function z0(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gx(m,x){m=m.updateQueue,x.updateQueue===m&&(x.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,effects:m.effects})}function Ao(m,x){return{eventTime:m,lane:x,tag:0,payload:null,callback:null,next:null}}function jo(m,x,j){var O=m.updateQueue;if(O===null)return null;if(O=O.shared,(Ar&2)!==0){var H=O.pending;return H===null?x.next=x:(x.next=H.next,H.next=x),O.pending=x,Li(m,j)}return H=O.interleaved,H===null?(x.next=x,Wf(O)):(x.next=H.next,H.next=x),O.interleaved=x,Li(m,j)}function ld(m,x,j){if(x=x.updateQueue,x!==null&&(x=x.shared,(j&4194240)!==0)){var O=x.lanes;O&=m.pendingLanes,j|=O,x.lanes=j,Yi(m,j)}}function Gc(m,x){var j=m.updateQueue,O=m.alternate;if(O!==null&&(O=O.updateQueue,j===O)){var H=null,te=null;if(j=j.firstBaseUpdate,j!==null){do{var ye={eventTime:j.eventTime,lane:j.lane,tag:j.tag,payload:j.payload,callback:j.callback,next:null};te===null?H=te=ye:te=te.next=ye,j=j.next}while(j!==null);te===null?H=te=x:te=te.next=x}else H=te=x;j={baseState:O.baseState,firstBaseUpdate:H,lastBaseUpdate:te,shared:O.shared,effects:O.effects},m.updateQueue=j;return}m=j.lastBaseUpdate,m===null?j.firstBaseUpdate=x:m.next=x,j.lastBaseUpdate=x}function il(m,x,j,O){var H=m.updateQueue;Qa=!1;var te=H.firstBaseUpdate,ye=H.lastBaseUpdate,Be=H.shared.pending;if(Be!==null){H.shared.pending=null;var lt=Be,Dt=lt.next;lt.next=null,ye===null?te=Dt:ye.next=Dt,ye=lt;var ar=m.alternate;ar!==null&&(ar=ar.updateQueue,Be=ar.lastBaseUpdate,Be!==ye&&(Be===null?ar.firstBaseUpdate=Dt:Be.next=Dt,ar.lastBaseUpdate=lt))}if(te!==null){var Er=H.baseState;ye=0,ar=Dt=lt=null,Be=te;do{var Qt=Be.lane,bn=Be.eventTime;if((O&Qt)===Qt){ar!==null&&(ar=ar.next={eventTime:bn,lane:0,tag:Be.tag,payload:Be.payload,callback:Be.callback,next:null});e:{var an=m,ya=Be;switch(Qt=x,bn=j,ya.tag){case 1:if(an=ya.payload,typeof an=="function"){Er=an.call(bn,Er,Qt);break e}Er=an;break e;case 3:an.flags=an.flags&-65537|128;case 0:if(an=ya.payload,Qt=typeof an=="function"?an.call(bn,Er,Qt):an,Qt==null)break e;Er=a({},Er,Qt);break e;case 2:Qa=!0}}Be.callback!==null&&Be.lane!==0&&(m.flags|=64,Qt=H.effects,Qt===null?H.effects=[Be]:Qt.push(Be))}else bn={eventTime:bn,lane:Qt,tag:Be.tag,payload:Be.payload,callback:Be.callback,next:null},ar===null?(Dt=ar=bn,lt=Er):ar=ar.next=bn,ye|=Qt;if(Be=Be.next,Be===null){if(Be=H.shared.pending,Be===null)break;Qt=Be,Be=Qt.next,Qt.next=null,H.lastBaseUpdate=Qt,H.shared.pending=null}}while(!0);if(ar===null&&(lt=Er),H.baseState=lt,H.firstBaseUpdate=Dt,H.lastBaseUpdate=ar,x=H.shared.interleaved,x!==null){H=x;do ye|=H.lane,H=H.next;while(H!==x)}else te===null&&(H.shared.lanes=0);Io|=ye,m.lanes=ye,m.memoizedState=Er}}function mx(m,x,j){if(m=x.effects,x.effects=null,m!==null)for(x=0;x<m.length;x++){var O=m[x],H=O.callback;if(H!==null){if(O.callback=null,O=j,typeof H!="function")throw Error(i(191,H));H.call(O)}}}var ol={},pi=Pr(ol),Vc=Pr(ol),ll=Pr(ol);function xi(m){if(m===ol)throw Error(i(174));return m}function zf(m,x){cr(ll,x),cr(Vc,m),cr(pi,ol),m=B(x),Or(pi),cr(pi,m)}function Kl(){Or(pi),Or(Vc),Or(ll)}function H0(m){var x=xi(ll.current),j=xi(pi.current);x=z(j,m.type,x),j!==x&&(cr(Vc,m),cr(pi,x))}function G0(m){Vc.current===m&&(Or(pi),Or(Vc))}var On=Pr(0);function Hf(m){for(var x=m;x!==null;){if(x.tag===13){var j=x.memoizedState;if(j!==null&&(j=j.dehydrated,j===null||Tr(j)||Mr(j)))return x}else if(x.tag===19&&x.memoizedProps.revealOrder!==void 0){if((x.flags&128)!==0)return x}else if(x.child!==null){x.child.return=x,x=x.child;continue}if(x===m)break;for(;x.sibling===null;){if(x.return===null||x.return===m)return null;x=x.return}x.sibling.return=x.return,x=x.sibling}return null}var V0=[];function K0(){for(var m=0;m<V0.length;m++){var x=V0[m];xe?x._workInProgressVersionPrimary=null:x._workInProgressVersionSecondary=null}V0.length=0}var Ra=l.ReactCurrentDispatcher,ql=l.ReactCurrentBatchConfig,cl=0,An=null,ns=null,xs=null,Kc=!1,cd=!1,ud=0,qc=0;function As(){throw Error(i(321))}function Xl(m,x){if(x===null)return!1;for(var j=0;j<x.length&&j<m.length;j++)if(!Di(m[j],x[j]))return!1;return!0}function dd(m,x,j,O,H,te){if(cl=te,An=x,x.memoizedState=null,x.updateQueue=null,x.lanes=0,Ra.current=m===null||m.memoizedState===null?ng:sg,m=j(O,H),cd){te=0;do{if(cd=!1,ud=0,25<=te)throw Error(i(301));te+=1,xs=ns=null,x.updateQueue=null,Ra.current=ag,m=j(O,H)}while(cd)}if(Ra.current=ec,x=ns!==null&&ns.next!==null,cl=0,xs=ns=An=null,Kc=!1,x)throw Error(i(300));return m}function Gf(){var m=ud!==0;return ud=0,m}function Za(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xs===null?An.memoizedState=xs=m:xs=xs.next=m,xs}function $s(){if(ns===null){var m=An.alternate;m=m!==null?m.memoizedState:null}else m=ns.next;var x=xs===null?An.memoizedState:xs.next;if(x!==null)xs=x,ns=m;else{if(m===null)throw Error(i(310));ns=m,m={memoizedState:ns.memoizedState,baseState:ns.baseState,baseQueue:ns.baseQueue,queue:ns.queue,next:null},xs===null?An.memoizedState=xs=m:xs=xs.next=m}return xs}function Yl(m,x){return typeof x=="function"?x(m):x}function Vf(m){var x=$s(),j=x.queue;if(j===null)throw Error(i(311));j.lastRenderedReducer=m;var O=ns,H=O.baseQueue,te=j.pending;if(te!==null){if(H!==null){var ye=H.next;H.next=te.next,te.next=ye}O.baseQueue=H=te,j.pending=null}if(H!==null){te=H.next,O=O.baseState;var Be=ye=null,lt=null,Dt=te;do{var ar=Dt.lane;if((cl&ar)===ar)lt!==null&&(lt=lt.next={lane:0,action:Dt.action,hasEagerState:Dt.hasEagerState,eagerState:Dt.eagerState,next:null}),O=Dt.hasEagerState?Dt.eagerState:m(O,Dt.action);else{var Er={lane:ar,action:Dt.action,hasEagerState:Dt.hasEagerState,eagerState:Dt.eagerState,next:null};lt===null?(Be=lt=Er,ye=O):lt=lt.next=Er,An.lanes|=ar,Io|=ar}Dt=Dt.next}while(Dt!==null&&Dt!==te);lt===null?ye=O:lt.next=Be,Di(O,x.memoizedState)||(ys=!0),x.memoizedState=O,x.baseState=ye,x.baseQueue=lt,j.lastRenderedState=O}if(m=j.interleaved,m!==null){H=m;do te=H.lane,An.lanes|=te,Io|=te,H=H.next;while(H!==m)}else H===null&&(j.lanes=0);return[x.memoizedState,j.dispatch]}function Xc(m){var x=$s(),j=x.queue;if(j===null)throw Error(i(311));j.lastRenderedReducer=m;var O=j.dispatch,H=j.pending,te=x.memoizedState;if(H!==null){j.pending=null;var ye=H=H.next;do te=m(te,ye.action),ye=ye.next;while(ye!==H);Di(te,x.memoizedState)||(ys=!0),x.memoizedState=te,x.baseQueue===null&&(x.baseState=te),j.lastRenderedState=te}return[te,O]}function q0(){}function X0(m,x){var j=An,O=$s(),H=x(),te=!Di(O.memoizedState,H);if(te&&(O.memoizedState=H,ys=!0),O=O.queue,Xf(Q0.bind(null,j,O,m),[m]),O.getSnapshot!==x||te||xs!==null&&xs.memoizedState.tag&1){if(j.flags|=2048,Jl(9,J0.bind(null,j,O,H,x),void 0,null),hn===null)throw Error(i(349));(cl&30)!==0||Y0(j,x,H)}return H}function Y0(m,x,j){m.flags|=16384,m={getSnapshot:x,value:j},x=An.updateQueue,x===null?(x={lastEffect:null,stores:null},An.updateQueue=x,x.stores=[m]):(j=x.stores,j===null?x.stores=[m]:j.push(m))}function J0(m,x,j,O){x.value=j,x.getSnapshot=O,Z0(x)&&Fo(m)}function Q0(m,x,j){return j(function(){Z0(x)&&Fo(m)})}function Z0(m){var x=m.getSnapshot;m=m.value;try{var j=x();return!Di(m,j)}catch{return!0}}function Fo(m){var x=Li(m,1);x!==null&&Zs(x,m,1,-1)}function Kf(m){var x=Za();return typeof m=="function"&&(m=m()),x.memoizedState=x.baseState=m,m={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yl,lastRenderedState:m},x.queue=m,m=m.dispatch=hv.bind(null,An,m),[x.memoizedState,m]}function Jl(m,x,j,O){return m={tag:m,create:x,destroy:j,deps:O,next:null},x=An.updateQueue,x===null?(x={lastEffect:null,stores:null},An.updateQueue=x,x.lastEffect=m.next=m):(j=x.lastEffect,j===null?x.lastEffect=m.next=m:(O=j.next,j.next=m,m.next=O,x.lastEffect=m)),m}function px(){return $s().memoizedState}function qf(m,x,j,O){var H=Za();An.flags|=m,H.memoizedState=Jl(1|x,j,void 0,O===void 0?null:O)}function ul(m,x,j,O){var H=$s();O=O===void 0?null:O;var te=void 0;if(ns!==null){var ye=ns.memoizedState;if(te=ye.destroy,O!==null&&Xl(O,ye.deps)){H.memoizedState=Jl(x,j,te,O);return}}An.flags|=m,H.memoizedState=Jl(1|x,j,te,O)}function xx(m,x){return qf(8390656,8,m,x)}function Xf(m,x){return ul(2048,8,m,x)}function eg(m,x){return ul(4,2,m,x)}function vn(m,x){return ul(4,4,m,x)}function Yf(m,x){if(typeof x=="function")return m=m(),x(m),function(){x(null)};if(x!=null)return m=m(),x.current=m,function(){x.current=null}}function fd(m,x,j){return j=j!=null?j.concat([m]):null,ul(4,4,Yf.bind(null,x,m),j)}function Ql(){}function tg(m,x){var j=$s();x=x===void 0?null:x;var O=j.memoizedState;return O!==null&&x!==null&&Xl(x,O[1])?O[0]:(j.memoizedState=[m,x],m)}function Jf(m,x){var j=$s();x=x===void 0?null:x;var O=j.memoizedState;return O!==null&&x!==null&&Xl(x,O[1])?O[0]:(m=m(),j.memoizedState=[m,x],m)}function Yc(m,x,j){return(cl&21)===0?(m.baseState&&(m.baseState=!1,ys=!0),m.memoizedState=j):(Di(j,x)||(j=jf(),An.lanes|=j,Io|=j,m.baseState=!0),x)}function Qf(m,x){var j=zr;zr=j!==0&&4>j?j:4,m(!0);var O=ql.transition;ql.transition={};try{m(!1),x()}finally{zr=j,ql.transition=O}}function Zl(){return $s().memoizedState}function yx(m,x,j){var O=ws(m);if(j={lane:O,action:j,hasEagerState:!1,eagerState:null,next:null},vx(m))rg(x,j);else if(j=W0(m,x,j,O),j!==null){var H=Tn();Zs(j,m,O,H),hd(j,x,O)}}function hv(m,x,j){var O=ws(m),H={lane:O,action:j,hasEagerState:!1,eagerState:null,next:null};if(vx(m))rg(x,H);else{var te=m.alternate;if(m.lanes===0&&(te===null||te.lanes===0)&&(te=x.lastRenderedReducer,te!==null))try{var ye=x.lastRenderedState,Be=te(ye,j);if(H.hasEagerState=!0,H.eagerState=Be,Di(Be,ye)){var lt=x.interleaved;lt===null?(H.next=H,Wf(x)):(H.next=lt.next,lt.next=H),x.interleaved=H;return}}catch{}finally{}j=W0(m,x,H,O),j!==null&&(H=Tn(),Zs(j,m,O,H),hd(j,x,O))}}function vx(m){var x=m.alternate;return m===An||x!==null&&x===An}function rg(m,x){cd=Kc=!0;var j=m.pending;j===null?x.next=x:(x.next=j.next,j.next=x),m.pending=x}function hd(m,x,j){if((j&4194240)!==0){var O=x.lanes;O&=m.pendingLanes,j|=O,x.lanes=j,Yi(m,j)}}var ec={readContext:Ja,useCallback:As,useContext:As,useEffect:As,useImperativeHandle:As,useInsertionEffect:As,useLayoutEffect:As,useMemo:As,useReducer:As,useRef:As,useState:As,useDebugValue:As,useDeferredValue:As,useTransition:As,useMutableSource:As,useSyncExternalStore:As,useId:As,unstable_isNewReconciler:!1},ng={readContext:Ja,useCallback:function(m,x){return Za().memoizedState=[m,x===void 0?null:x],m},useContext:Ja,useEffect:xx,useImperativeHandle:function(m,x,j){return j=j!=null?j.concat([m]):null,qf(4194308,4,Yf.bind(null,x,m),j)},useLayoutEffect:function(m,x){return qf(4194308,4,m,x)},useInsertionEffect:function(m,x){return qf(4,2,m,x)},useMemo:function(m,x){var j=Za();return x=x===void 0?null:x,m=m(),j.memoizedState=[m,x],m},useReducer:function(m,x,j){var O=Za();return x=j!==void 0?j(x):x,O.memoizedState=O.baseState=x,m={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:x},O.queue=m,m=m.dispatch=yx.bind(null,An,m),[O.memoizedState,m]},useRef:function(m){var x=Za();return m={current:m},x.memoizedState=m},useState:Kf,useDebugValue:Ql,useDeferredValue:function(m){return Za().memoizedState=m},useTransition:function(){var m=Kf(!1),x=m[0];return m=Qf.bind(null,m[1]),Za().memoizedState=m,[x,m]},useMutableSource:function(){},useSyncExternalStore:function(m,x,j){var O=An,H=Za();if(Cn){if(j===void 0)throw Error(i(407));j=j()}else{if(j=x(),hn===null)throw Error(i(349));(cl&30)!==0||Y0(O,x,j)}H.memoizedState=j;var te={value:j,getSnapshot:x};return H.queue=te,xx(Q0.bind(null,O,te,m),[m]),O.flags|=2048,Jl(9,J0.bind(null,O,te,j,x),void 0,null),j},useId:function(){var m=Za(),x=hn.identifierPrefix;if(Cn){var j=Ii,O=Pa;j=(O&~(1<<32-er(O)-1)).toString(32)+j,x=":"+x+"R"+j,j=ud++,0<j&&(x+="H"+j.toString(32)),x+=":"}else j=qc++,x=":"+x+"r"+j.toString(32)+":";return m.memoizedState=x},unstable_isNewReconciler:!1},sg={readContext:Ja,useCallback:tg,useContext:Ja,useEffect:Xf,useImperativeHandle:fd,useInsertionEffect:eg,useLayoutEffect:vn,useMemo:Jf,useReducer:Vf,useRef:px,useState:function(){return Vf(Yl)},useDebugValue:Ql,useDeferredValue:function(m){var x=$s();return Yc(x,ns.memoizedState,m)},useTransition:function(){var m=Vf(Yl)[0],x=$s().memoizedState;return[m,x]},useMutableSource:q0,useSyncExternalStore:X0,useId:Zl,unstable_isNewReconciler:!1},ag={readContext:Ja,useCallback:tg,useContext:Ja,useEffect:Xf,useImperativeHandle:fd,useInsertionEffect:eg,useLayoutEffect:vn,useMemo:Jf,useReducer:Xc,useRef:px,useState:function(){return Xc(Yl)},useDebugValue:Ql,useDeferredValue:function(m){var x=$s();return ns===null?x.memoizedState=m:Yc(x,ns.memoizedState,m)},useTransition:function(){var m=Xc(Yl)[0],x=$s().memoizedState;return[m,x]},useMutableSource:q0,useSyncExternalStore:X0,useId:Zl,unstable_isNewReconciler:!1};function ei(m,x){if(m&&m.defaultProps){x=a({},x),m=m.defaultProps;for(var j in m)x[j]===void 0&&(x[j]=m[j]);return x}return x}function ig(m,x,j,O){x=m.memoizedState,j=j(O,x),j=j==null?x:a({},x,j),m.memoizedState=j,m.lanes===0&&(m.updateQueue.baseState=j)}var gd={isMounted:function(m){return(m=m._reactInternals)?D(m)===m:!1},enqueueSetState:function(m,x,j){m=m._reactInternals;var O=Tn(),H=ws(m),te=Ao(O,H);te.payload=x,j!=null&&(te.callback=j),x=jo(m,te,H),x!==null&&(Zs(x,m,H,O),ld(x,m,H))},enqueueReplaceState:function(m,x,j){m=m._reactInternals;var O=Tn(),H=ws(m),te=Ao(O,H);te.tag=1,te.payload=x,j!=null&&(te.callback=j),x=jo(m,te,H),x!==null&&(Zs(x,m,H,O),ld(x,m,H))},enqueueForceUpdate:function(m,x){m=m._reactInternals;var j=Tn(),O=ws(m),H=Ao(j,O);H.tag=2,x!=null&&(H.callback=x),x=jo(m,H,O),x!==null&&(Zs(x,m,O,j),ld(x,m,O))}};function wx(m,x,j,O,H,te,ye){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(O,te,ye):x.prototype&&x.prototype.isPureReactComponent?!Lf(j,O)||!Lf(H,te):!0}function _x(m,x,j){var O=!1,H=ae,te=x.contextType;return typeof te=="object"&&te!==null?te=Ja(te):(H=It(x)?Oe:ue.current,O=x.contextTypes,te=(O=O!=null)?Xe(m,H):ae),x=new x(j,te),m.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=gd,m.stateNode=x,x._reactInternals=m,O&&(m=m.stateNode,m.__reactInternalMemoizedUnmaskedChildContext=H,m.__reactInternalMemoizedMaskedChildContext=te),x}function Zf(m,x,j,O){m=x.state,typeof x.componentWillReceiveProps=="function"&&x.componentWillReceiveProps(j,O),typeof x.UNSAFE_componentWillReceiveProps=="function"&&x.UNSAFE_componentWillReceiveProps(j,O),x.state!==m&&gd.enqueueReplaceState(x,x.state,null)}function Qi(m,x,j,O){var H=m.stateNode;H.props=j,H.state=m.memoizedState,H.refs={},z0(m);var te=x.contextType;typeof te=="object"&&te!==null?H.context=Ja(te):(te=It(x)?Oe:ue.current,H.context=Xe(m,te)),H.state=m.memoizedState,te=x.getDerivedStateFromProps,typeof te=="function"&&(ig(m,x,te,j),H.state=m.memoizedState),typeof x.getDerivedStateFromProps=="function"||typeof H.getSnapshotBeforeUpdate=="function"||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(x=H.state,typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount(),x!==H.state&&gd.enqueueReplaceState(H,H.state,null),il(m,j,H,O),H.state=m.memoizedState),typeof H.componentDidMount=="function"&&(m.flags|=4194308)}function tc(m,x){try{var j="",O=x;do j+=fv(O),O=O.return;while(O);var H=j}catch(te){H=`
Error generating stack: `+te.message+`
`+te.stack}return{value:m,source:x,stack:H,digest:null}}function dl(m,x,j){return{value:m,source:null,stack:j??null,digest:x??null}}function yi(m,x){try{console.error(x.value)}catch(j){setTimeout(function(){throw j})}}var md=typeof WeakMap=="function"?WeakMap:Map;function Zi(m,x,j){j=Ao(-1,j),j.tag=3,j.payload={element:null};var O=x.value;return j.callback=function(){Vn||(Vn=!0,ss=O),yi(m,x)},j}function eh(m,x,j){j=Ao(-1,j),j.tag=3;var O=m.type.getDerivedStateFromError;if(typeof O=="function"){var H=x.value;j.payload=function(){return O(H)},j.callback=function(){yi(m,x)}}var te=m.stateNode;return te!==null&&typeof te.componentDidCatch=="function"&&(j.callback=function(){yi(m,x),typeof O!="function"&&(Ui===null?Ui=new Set([this]):Ui.add(this));var ye=x.stack;this.componentDidCatch(x.value,{componentStack:ye!==null?ye:""})}),j}function bx(m,x,j){var O=m.pingCache;if(O===null){O=m.pingCache=new md;var H=new Set;O.set(x,H)}else H=O.get(x),H===void 0&&(H=new Set,O.set(x,H));H.has(j)||(H.add(j),m=jx.bind(null,m,x,j),x.then(m,m))}function Sx(m){do{var x;if((x=m.tag===13)&&(x=m.memoizedState,x=x!==null?x.dehydrated!==null:!0),x)return m;m=m.return}while(m!==null);return null}function fl(m,x,j,O,H){return(m.mode&1)===0?(m===x?m.flags|=65536:(m.flags|=128,j.flags|=131072,j.flags&=-52805,j.tag===1&&(j.alternate===null?j.tag=17:(x=Ao(-1,1),x.tag=2,jo(j,x,1))),j.lanes|=1),m):(m.flags|=65536,m.lanes=H,m)}var pd=l.ReactCurrentOwner,ys=!1;function js(m,x,j,O){x.child=m===null?fx(x,null,j,O):Gl(x,m.child,j,O)}function th(m,x,j,O,H){j=j.render;var te=x.ref;return Hc(x,H),O=dd(m,x,j,O,te,H),j=Gf(),m!==null&&!ys?(x.updateQueue=m.updateQueue,x.flags&=-2053,m.lanes&=~H,Ro(m,x,H)):(Cn&&j&&sd(x),x.flags|=1,js(m,x,O,H),x.child)}function rc(m,x,j,O,H){if(m===null){var te=j.type;return typeof te=="function"&&!du(te)&&te.defaultProps===void 0&&j.compare===null&&j.defaultProps===void 0?(x.tag=15,x.type=te,Po(m,x,te,O,H)):(m=xh(j.type,null,O,x,x.mode,H),m.ref=x.ref,m.return=x,x.child=m)}if(te=m.child,(m.lanes&H)===0){var ye=te.memoizedProps;if(j=j.compare,j=j!==null?j:Lf,j(ye,O)&&m.ref===x.ref)return Ro(m,x,H)}return x.flags|=1,m=bl(te,O),m.ref=x.ref,m.return=x,x.child=m}function Po(m,x,j,O,H){if(m!==null){var te=m.memoizedProps;if(Lf(te,O)&&m.ref===x.ref)if(ys=!1,x.pendingProps=O=te,(m.lanes&H)!==0)(m.flags&131072)!==0&&(ys=!0);else return x.lanes=m.lanes,Ro(m,x,H)}return eo(m,x,j,O,H)}function wn(m,x,j){var O=x.pendingProps,H=O.children,te=m!==null?m.memoizedState:null;if(O.mode==="hidden")if((x.mode&1)===0)x.memoizedState={baseLanes:0,cachePool:null,transitions:null},cr(yl,vs),vs|=j;else{if((j&1073741824)===0)return m=te!==null?te.baseLanes|j:j,x.lanes=x.childLanes=1073741824,x.memoizedState={baseLanes:m,cachePool:null,transitions:null},x.updateQueue=null,cr(yl,vs),vs|=m,null;x.memoizedState={baseLanes:0,cachePool:null,transitions:null},O=te!==null?te.baseLanes:j,cr(yl,vs),vs|=O}else te!==null?(O=te.baseLanes|j,x.memoizedState=null):O=j,cr(yl,vs),vs|=O;return js(m,x,H,j),x.child}function fn(m,x){var j=x.ref;(m===null&&j!==null||m!==null&&m.ref!==j)&&(x.flags|=512,x.flags|=2097152)}function eo(m,x,j,O,H){var te=It(j)?Oe:ue.current;return te=Xe(x,te),Hc(x,H),j=dd(m,x,j,O,te,H),O=Gf(),m!==null&&!ys?(x.updateQueue=m.updateQueue,x.flags&=-2053,m.lanes&=~H,Ro(m,x,H)):(Cn&&O&&sd(x),x.flags|=1,js(m,x,j,H),x.child)}function Ws(m,x,j,O,H){if(It(j)){var te=!0;nt(x)}else te=!1;if(Hc(x,H),x.stateNode===null)xd(m,x),_x(x,j,O),Qi(x,j,O,H),O=!0;else if(m===null){var ye=x.stateNode,Be=x.memoizedProps;ye.props=Be;var lt=ye.context,Dt=j.contextType;typeof Dt=="object"&&Dt!==null?Dt=Ja(Dt):(Dt=It(j)?Oe:ue.current,Dt=Xe(x,Dt));var ar=j.getDerivedStateFromProps,Er=typeof ar=="function"||typeof ye.getSnapshotBeforeUpdate=="function";Er||typeof ye.UNSAFE_componentWillReceiveProps!="function"&&typeof ye.componentWillReceiveProps!="function"||(Be!==O||lt!==Dt)&&Zf(x,ye,O,Dt),Qa=!1;var Qt=x.memoizedState;ye.state=Qt,il(x,O,ye,H),lt=x.memoizedState,Be!==O||Qt!==lt||Ce.current||Qa?(typeof ar=="function"&&(ig(x,j,ar,O),lt=x.memoizedState),(Be=Qa||wx(x,j,Be,O,Qt,lt,Dt))?(Er||typeof ye.UNSAFE_componentWillMount!="function"&&typeof ye.componentWillMount!="function"||(typeof ye.componentWillMount=="function"&&ye.componentWillMount(),typeof ye.UNSAFE_componentWillMount=="function"&&ye.UNSAFE_componentWillMount()),typeof ye.componentDidMount=="function"&&(x.flags|=4194308)):(typeof ye.componentDidMount=="function"&&(x.flags|=4194308),x.memoizedProps=O,x.memoizedState=lt),ye.props=O,ye.state=lt,ye.context=Dt,O=Be):(typeof ye.componentDidMount=="function"&&(x.flags|=4194308),O=!1)}else{ye=x.stateNode,gx(m,x),Be=x.memoizedProps,Dt=x.type===x.elementType?Be:ei(x.type,Be),ye.props=Dt,Er=x.pendingProps,Qt=ye.context,lt=j.contextType,typeof lt=="object"&&lt!==null?lt=Ja(lt):(lt=It(j)?Oe:ue.current,lt=Xe(x,lt));var bn=j.getDerivedStateFromProps;(ar=typeof bn=="function"||typeof ye.getSnapshotBeforeUpdate=="function")||typeof ye.UNSAFE_componentWillReceiveProps!="function"&&typeof ye.componentWillReceiveProps!="function"||(Be!==Er||Qt!==lt)&&Zf(x,ye,O,lt),Qa=!1,Qt=x.memoizedState,ye.state=Qt,il(x,O,ye,H);var an=x.memoizedState;Be!==Er||Qt!==an||Ce.current||Qa?(typeof bn=="function"&&(ig(x,j,bn,O),an=x.memoizedState),(Dt=Qa||wx(x,j,Dt,O,Qt,an,lt)||!1)?(ar||typeof ye.UNSAFE_componentWillUpdate!="function"&&typeof ye.componentWillUpdate!="function"||(typeof ye.componentWillUpdate=="function"&&ye.componentWillUpdate(O,an,lt),typeof ye.UNSAFE_componentWillUpdate=="function"&&ye.UNSAFE_componentWillUpdate(O,an,lt)),typeof ye.componentDidUpdate=="function"&&(x.flags|=4),typeof ye.getSnapshotBeforeUpdate=="function"&&(x.flags|=1024)):(typeof ye.componentDidUpdate!="function"||Be===m.memoizedProps&&Qt===m.memoizedState||(x.flags|=4),typeof ye.getSnapshotBeforeUpdate!="function"||Be===m.memoizedProps&&Qt===m.memoizedState||(x.flags|=1024),x.memoizedProps=O,x.memoizedState=an),ye.props=O,ye.state=an,ye.context=lt,O=Dt):(typeof ye.componentDidUpdate!="function"||Be===m.memoizedProps&&Qt===m.memoizedState||(x.flags|=4),typeof ye.getSnapshotBeforeUpdate!="function"||Be===m.memoizedProps&&Qt===m.memoizedState||(x.flags|=1024),O=!1)}return Ys(m,x,j,O,te,H)}function Ys(m,x,j,O,H,te){fn(m,x);var ye=(x.flags&128)!==0;if(!O&&!ye)return H&&jt(x,j,!1),Ro(m,x,te);O=x.stateNode,pd.current=x;var Be=ye&&typeof j.getDerivedStateFromError!="function"?null:O.render();return x.flags|=1,m!==null&&ye?(x.child=Gl(x,m.child,null,te),x.child=Gl(x,null,Be,te)):js(m,x,Be,te),x.memoizedState=O.state,H&&jt(x,j,!0),x.child}function hl(m){var x=m.stateNode;x.pendingContext?fr(m,x.pendingContext,x.pendingContext!==x.context):x.context&&fr(m,x.context,!1),zf(m,x.containerInfo)}function nc(m,x,j,O,H){return zl(),B0(H),x.flags|=256,js(m,x,j,O),x.child}var Js={dehydrated:null,treeContext:null,retryLane:0};function Jc(m){return{baseLanes:m,cachePool:null,transitions:null}}function og(m,x,j){var O=x.pendingProps,H=On.current,te=!1,ye=(x.flags&128)!==0,Be;if((Be=ye)||(Be=m!==null&&m.memoizedState===null?!1:(H&2)!==0),Be?(te=!0,x.flags&=-129):(m===null||m.memoizedState!==null)&&(H|=1),cr(On,H&1),m===null)return L0(x),m=x.memoizedState,m!==null&&(m=m.dehydrated,m!==null)?((x.mode&1)===0?x.lanes=1:Mr(m)?x.lanes=8:x.lanes=1073741824,null):(ye=O.children,m=O.fallback,te?(O=x.mode,te=x.child,ye={mode:"hidden",children:ye},(O&1)===0&&te!==null?(te.childLanes=0,te.pendingProps=ye):te=fu(ye,O,0,null),m=zs(m,O,j,null),te.return=x,m.return=x,te.sibling=m,x.child=te,x.child.memoizedState=Jc(j),x.memoizedState=Js,m):rh(x,ye));if(H=m.memoizedState,H!==null&&(Be=H.dehydrated,Be!==null))return kx(m,x,ye,O,Be,H,j);if(te){te=O.fallback,ye=x.mode,H=m.child,Be=H.sibling;var lt={mode:"hidden",children:O.children};return(ye&1)===0&&x.child!==H?(O=x.child,O.childLanes=0,O.pendingProps=lt,x.deletions=null):(O=bl(H,lt),O.subtreeFlags=H.subtreeFlags&14680064),Be!==null?te=bl(Be,te):(te=zs(te,ye,j,null),te.flags|=2),te.return=x,O.return=x,O.sibling=te,x.child=O,O=te,te=x.child,ye=m.child.memoizedState,ye=ye===null?Jc(j):{baseLanes:ye.baseLanes|j,cachePool:null,transitions:ye.transitions},te.memoizedState=ye,te.childLanes=m.childLanes&~j,x.memoizedState=Js,O}return te=m.child,m=te.sibling,O=bl(te,{mode:"visible",children:O.children}),(x.mode&1)===0&&(O.lanes=j),O.return=x,O.sibling=null,m!==null&&(j=x.deletions,j===null?(x.deletions=[m],x.flags|=16):j.push(m)),x.child=O,x.memoizedState=null,O}function rh(m,x){return x=fu({mode:"visible",children:x},m.mode,0,null),x.return=m,m.child=x}function sc(m,x,j,O){return O!==null&&B0(O),Gl(x,m.child,null,j),m=rh(x,x.pendingProps.children),m.flags|=2,x.memoizedState=null,m}function kx(m,x,j,O,H,te,ye){if(j)return x.flags&256?(x.flags&=-257,O=dl(Error(i(422))),sc(m,x,ye,O)):x.memoizedState!==null?(x.child=m.child,x.flags|=128,null):(te=O.fallback,H=x.mode,O=fu({mode:"visible",children:O.children},H,0,null),te=zs(te,H,ye,null),te.flags|=2,O.return=x,te.return=x,O.sibling=te,x.child=O,(x.mode&1)!==0&&Gl(x,m.child,null,ye),x.child.memoizedState=Jc(ye),x.memoizedState=Js,te);if((x.mode&1)===0)return sc(m,x,ye,null);if(Mr(H))return O=Wr(H).digest,te=Error(i(419)),O=dl(te,O,void 0),sc(m,x,ye,O);if(j=(ye&m.childLanes)!==0,ys||j){if(O=hn,O!==null){switch(ye&-ye){case 4:H=2;break;case 16:H=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:H=32;break;case 536870912:H=268435456;break;default:H=0}H=(H&(O.suspendedLanes|ye))!==0?0:H,H!==0&&H!==te.retryLane&&(te.retryLane=H,Li(m,H),Zs(O,m,H,-1))}return uu(),O=dl(Error(i(421))),sc(m,x,ye,O)}return Tr(H)?(x.flags|=128,x.child=m.child,x=Px.bind(null,m),ce(H,x),null):(m=te.treeContext,ge&&(fa=be(H),Us=x,Cn=!0,Oi=null,id=!1,m!==null&&(da[Ya++]=Pa,da[Ya++]=Ii,da[Ya++]=ps,Pa=m.id,Ii=m.overflow,ps=x)),x=rh(x,O.children),x.flags|=4096,x)}function to(m,x,j){m.lanes|=x;var O=m.alternate;O!==null&&(O.lanes|=x),Vl(m.return,x,j)}function Qc(m,x,j,O,H){var te=m.memoizedState;te===null?m.memoizedState={isBackwards:x,rendering:null,renderingStartTime:0,last:O,tail:j,tailMode:H}:(te.isBackwards=x,te.rendering=null,te.renderingStartTime=0,te.last=O,te.tail=j,te.tailMode=H)}function nh(m,x,j){var O=x.pendingProps,H=O.revealOrder,te=O.tail;if(js(m,x,O.children,j),O=On.current,(O&2)!==0)O=O&1|2,x.flags|=128;else{if(m!==null&&(m.flags&128)!==0)e:for(m=x.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&to(m,j,x);else if(m.tag===19)to(m,j,x);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===x)break e;for(;m.sibling===null;){if(m.return===null||m.return===x)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}O&=1}if(cr(On,O),(x.mode&1)===0)x.memoizedState=null;else switch(H){case"forwards":for(j=x.child,H=null;j!==null;)m=j.alternate,m!==null&&Hf(m)===null&&(H=j),j=j.sibling;j=H,j===null?(H=x.child,x.child=null):(H=j.sibling,j.sibling=null),Qc(x,!1,H,j,te);break;case"backwards":for(j=null,H=x.child,x.child=null;H!==null;){if(m=H.alternate,m!==null&&Hf(m)===null){x.child=H;break}m=H.sibling,H.sibling=j,j=H,H=m}Qc(x,!0,j,null,te);break;case"together":Qc(x,!1,null,null,void 0);break;default:x.memoizedState=null}return x.child}function xd(m,x){(x.mode&1)===0&&m!==null&&(m.alternate=null,x.alternate=null,x.flags|=2)}function Ro(m,x,j){if(m!==null&&(x.dependencies=m.dependencies),Io|=x.lanes,(j&x.childLanes)===0)return null;if(m!==null&&x.child!==m.child)throw Error(i(153));if(x.child!==null){for(m=x.child,j=bl(m,m.pendingProps),x.child=j,j.return=x;m.sibling!==null;)m=m.sibling,j=j.sibling=bl(m,m.pendingProps),j.return=x;j.sibling=null}return x.child}function gl(m,x,j){switch(x.tag){case 3:hl(x),zl();break;case 5:H0(x);break;case 1:It(x.type)&&nt(x);break;case 4:zf(x,x.stateNode.containerInfo);break;case 10:hx(x,x.type._context,x.memoizedProps.value);break;case 13:var O=x.memoizedState;if(O!==null)return O.dehydrated!==null?(cr(On,On.current&1),x.flags|=128,null):(j&x.child.childLanes)!==0?og(m,x,j):(cr(On,On.current&1),m=Ro(m,x,j),m!==null?m.sibling:null);cr(On,On.current&1);break;case 19:if(O=(j&x.childLanes)!==0,(m.flags&128)!==0){if(O)return nh(m,x,j);x.flags|=128}var H=x.memoizedState;if(H!==null&&(H.rendering=null,H.tail=null,H.lastEffect=null),cr(On,On.current),O)break;return null;case 22:case 23:return x.lanes=0,wn(m,x,j)}return Ro(m,x,j)}function ha(m){m.flags|=4}function ac(m,x){if(m!==null&&m.child===x.child)return!0;if((x.flags&16)!==0)return!1;for(m=x.child;m!==null;){if((m.flags&12854)!==0||(m.subtreeFlags&12854)!==0)return!1;m=m.sibling}return!0}var ml,pl,ga,ma;if(Ne)ml=function(m,x){for(var j=x.child;j!==null;){if(j.tag===5||j.tag===6)L(m,j.stateNode);else if(j.tag!==4&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===x)break;for(;j.sibling===null;){if(j.return===null||j.return===x)return;j=j.return}j.sibling.return=j.return,j=j.sibling}},pl=function(){},ga=function(m,x,j,O,H){if(m=m.memoizedProps,m!==O){var te=x.stateNode,ye=xi(pi.current);j=X(te,j,m,O,H,ye),(x.updateQueue=j)&&ha(x)}},ma=function(m,x,j,O){j!==O&&ha(x)};else if(le){ml=function(m,x,j,O){for(var H=x.child;H!==null;){if(H.tag===5){var te=H.stateNode;j&&O&&(te=Jt(te,H.type,H.memoizedProps,H)),L(m,te)}else if(H.tag===6)te=H.stateNode,j&&O&&(te=Yt(te,H.memoizedProps,H)),L(m,te);else if(H.tag!==4){if(H.tag===22&&H.memoizedState!==null)te=H.child,te!==null&&(te.return=H),ml(m,H,!0,!0);else if(H.child!==null){H.child.return=H,H=H.child;continue}}if(H===x)break;for(;H.sibling===null;){if(H.return===null||H.return===x)return;H=H.return}H.sibling.return=H.return,H=H.sibling}};var xl=function(m,x,j,O){for(var H=x.child;H!==null;){if(H.tag===5){var te=H.stateNode;j&&O&&(te=Jt(te,H.type,H.memoizedProps,H)),St(m,te)}else if(H.tag===6)te=H.stateNode,j&&O&&(te=Yt(te,H.memoizedProps,H)),St(m,te);else if(H.tag!==4){if(H.tag===22&&H.memoizedState!==null)te=H.child,te!==null&&(te.return=H),xl(m,H,!0,!0);else if(H.child!==null){H.child.return=H,H=H.child;continue}}if(H===x)break;for(;H.sibling===null;){if(H.return===null||H.return===x)return;H=H.return}H.sibling.return=H.return,H=H.sibling}};pl=function(m,x){var j=x.stateNode;if(!ac(m,x)){m=j.containerInfo;var O=$e(m);xl(O,x,!1,!1),j.pendingChildren=O,ha(x),pt(m,O)}},ga=function(m,x,j,O,H){var te=m.stateNode,ye=m.memoizedProps;if((m=ac(m,x))&&ye===O)x.stateNode=te;else{var Be=x.stateNode,lt=xi(pi.current),Dt=null;ye!==O&&(Dt=X(Be,j,ye,O,H,lt)),m&&Dt===null?x.stateNode=te:(te=_e(te,Dt,j,ye,O,x,m,Be),M(te,j,O,H,lt)&&ha(x),x.stateNode=te,m?ha(x):ml(te,x,!1,!1))}},ma=function(m,x,j,O){j!==O?(m=xi(ll.current),j=xi(pi.current),x.stateNode=Z(O,m,j,x),ha(x)):x.stateNode=m.stateNode}}else pl=function(){},ga=function(){},ma=function(){};function ti(m,x){if(!Cn)switch(m.tailMode){case"hidden":x=m.tail;for(var j=null;x!==null;)x.alternate!==null&&(j=x),x=x.sibling;j===null?m.tail=null:j.sibling=null;break;case"collapsed":j=m.tail;for(var O=null;j!==null;)j.alternate!==null&&(O=j),j=j.sibling;O===null?x||m.tail===null?m.tail=null:m.tail.sibling=null:O.sibling=null}}function jn(m){var x=m.alternate!==null&&m.alternate.child===m.child,j=0,O=0;if(x)for(var H=m.child;H!==null;)j|=H.lanes|H.childLanes,O|=H.subtreeFlags&14680064,O|=H.flags&14680064,H.return=m,H=H.sibling;else for(H=m.child;H!==null;)j|=H.lanes|H.childLanes,O|=H.subtreeFlags,O|=H.flags,H.return=m,H=H.sibling;return m.subtreeFlags|=O,m.childLanes=j,x}function ic(m,x,j){var O=x.pendingProps;switch(ad(x),x.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jn(x),null;case 1:return It(x.type)&&ht(),jn(x),null;case 3:return j=x.stateNode,Kl(),Or(Ce),Or(ue),K0(),j.pendingContext&&(j.context=j.pendingContext,j.pendingContext=null),(m===null||m.child===null)&&(Of(x)?ha(x):m===null||m.memoizedState.isDehydrated&&(x.flags&256)===0||(x.flags|=1024,Oi!==null&&(mh(Oi),Oi=null))),pl(m,x),jn(x),null;case 5:G0(x),j=xi(ll.current);var H=x.type;if(m!==null&&x.stateNode!=null)ga(m,x,H,O,j),m.ref!==x.ref&&(x.flags|=512,x.flags|=2097152);else{if(!O){if(x.stateNode===null)throw Error(i(166));return jn(x),null}if(m=xi(pi.current),Of(x)){if(!ge)throw Error(i(175));m=ke(x.stateNode,x.type,x.memoizedProps,j,m,x,!id),x.updateQueue=m,m!==null&&ha(x)}else{var te=q(H,O,j,m,x);ml(te,x,!1,!1),x.stateNode=te,M(te,H,O,j,m)&&ha(x)}x.ref!==null&&(x.flags|=512,x.flags|=2097152)}return jn(x),null;case 6:if(m&&x.stateNode!=null)ma(m,x,m.memoizedProps,O);else{if(typeof O!="string"&&x.stateNode===null)throw Error(i(166));if(m=xi(ll.current),j=xi(pi.current),Of(x)){if(!ge)throw Error(i(176));if(m=x.stateNode,j=x.memoizedProps,(O=We(m,j,x,!id))&&(H=Us,H!==null))switch(H.tag){case 3:at(H.stateNode.containerInfo,m,j,(H.mode&1)!==0);break;case 5:Le(H.type,H.memoizedProps,H.stateNode,m,j,(H.mode&1)!==0)}O&&ha(x)}else x.stateNode=Z(O,m,j,x)}return jn(x),null;case 13:if(Or(On),O=x.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(Cn&&fa!==null&&(x.mode&1)!==0&&(x.flags&128)===0)cx(),zl(),x.flags|=98560,H=!1;else if(H=Of(x),O!==null&&O.dehydrated!==null){if(m===null){if(!H)throw Error(i(318));if(!ge)throw Error(i(344));if(H=x.memoizedState,H=H!==null?H.dehydrated:null,!H)throw Error(i(317));dt(H,x)}else zl(),(x.flags&128)===0&&(x.memoizedState=null),x.flags|=4;jn(x),H=!1}else Oi!==null&&(mh(Oi),Oi=null),H=!0;if(!H)return x.flags&65536?x:null}return(x.flags&128)!==0?(x.lanes=j,x):(j=O!==null,j!==(m!==null&&m.memoizedState!==null)&&j&&(x.child.flags|=8192,(x.mode&1)!==0&&(m===null||(On.current&1)!==0?Pn===0&&(Pn=3):uu())),x.updateQueue!==null&&(x.flags|=4),jn(x),null);case 4:return Kl(),pl(m,x),m===null&&Ge(x.stateNode.containerInfo),jn(x),null;case 10:return od(x.type._context),jn(x),null;case 17:return It(x.type)&&ht(),jn(x),null;case 19:if(Or(On),H=x.memoizedState,H===null)return jn(x),null;if(O=(x.flags&128)!==0,te=H.rendering,te===null)if(O)ti(H,!1);else{if(Pn!==0||m!==null&&(m.flags&128)!==0)for(m=x.child;m!==null;){if(te=Hf(m),te!==null){for(x.flags|=128,ti(H,!1),m=te.updateQueue,m!==null&&(x.updateQueue=m,x.flags|=4),x.subtreeFlags=0,m=j,j=x.child;j!==null;)O=j,H=m,O.flags&=14680066,te=O.alternate,te===null?(O.childLanes=0,O.lanes=H,O.child=null,O.subtreeFlags=0,O.memoizedProps=null,O.memoizedState=null,O.updateQueue=null,O.dependencies=null,O.stateNode=null):(O.childLanes=te.childLanes,O.lanes=te.lanes,O.child=te.child,O.subtreeFlags=0,O.deletions=null,O.memoizedProps=te.memoizedProps,O.memoizedState=te.memoizedState,O.updateQueue=te.updateQueue,O.type=te.type,H=te.dependencies,O.dependencies=H===null?null:{lanes:H.lanes,firstContext:H.firstContext}),j=j.sibling;return cr(On,On.current&1|2),x.child}m=m.sibling}H.tail!==null&&Ns()>kd&&(x.flags|=128,O=!0,ti(H,!1),x.lanes=4194304)}else{if(!O)if(m=Hf(te),m!==null){if(x.flags|=128,O=!0,m=m.updateQueue,m!==null&&(x.updateQueue=m,x.flags|=4),ti(H,!0),H.tail===null&&H.tailMode==="hidden"&&!te.alternate&&!Cn)return jn(x),null}else 2*Ns()-H.renderingStartTime>kd&&j!==1073741824&&(x.flags|=128,O=!0,ti(H,!1),x.lanes=4194304);H.isBackwards?(te.sibling=x.child,x.child=te):(m=H.last,m!==null?m.sibling=te:x.child=te,H.last=te)}return H.tail!==null?(x=H.tail,H.rendering=x,H.tail=x.sibling,H.renderingStartTime=Ns(),x.sibling=null,m=On.current,cr(On,O?m&1|2:m&1),x):(jn(x),null);case 22:case 23:return ph(),j=x.memoizedState!==null,m!==null&&m.memoizedState!==null!==j&&(x.flags|=8192),j&&(x.mode&1)!==0?(vs&1073741824)!==0&&(jn(x),Ne&&x.subtreeFlags&6&&(x.flags|=8192)):jn(x),null;case 24:return null;case 25:return null}throw Error(i(156,x.tag))}function Cx(m,x){switch(ad(x),x.tag){case 1:return It(x.type)&&ht(),m=x.flags,m&65536?(x.flags=m&-65537|128,x):null;case 3:return Kl(),Or(Ce),Or(ue),K0(),m=x.flags,(m&65536)!==0&&(m&128)===0?(x.flags=m&-65537|128,x):null;case 5:return G0(x),null;case 13:if(Or(On),m=x.memoizedState,m!==null&&m.dehydrated!==null){if(x.alternate===null)throw Error(i(340));zl()}return m=x.flags,m&65536?(x.flags=m&-65537|128,x):null;case 19:return Or(On),null;case 4:return Kl(),null;case 10:return od(x.type._context),null;case 22:case 23:return ph(),null;case 24:return null;default:return null}}var Zc=!1,Fs=!1,ri=typeof WeakSet=="function"?WeakSet:Set,qt=null;function sn(m,x){var j=m.ref;if(j!==null)if(typeof j=="function")try{j(null)}catch(O){En(m,x,O)}else j.current=null}function ni(m,x,j){try{j()}catch(O){En(m,x,O)}}var lg=!1;function Tx(m,x){for(U(m.containerInfo),qt=x;qt!==null;)if(m=qt,x=m.child,(m.subtreeFlags&1028)!==0&&x!==null)x.return=m,qt=x;else for(;qt!==null;){m=qt;try{var j=m.alternate;if((m.flags&1024)!==0)switch(m.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var O=j.memoizedProps,H=j.memoizedState,te=m.stateNode,ye=te.getSnapshotBeforeUpdate(m.elementType===m.type?O:ei(m.type,O),H);te.__reactInternalSnapshotBeforeUpdate=ye}break;case 3:Ne&&fe(m.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(Be){En(m,m.return,Be)}if(x=m.sibling,x!==null){x.return=m.return,qt=x;break}qt=m.return}return j=lg,lg=!1,j}function oc(m,x,j){var O=x.updateQueue;if(O=O!==null?O.lastEffect:null,O!==null){var H=O=O.next;do{if((H.tag&m)===m){var te=H.destroy;H.destroy=void 0,te!==void 0&&ni(x,j,te)}H=H.next}while(H!==O)}}function eu(m,x){if(x=x.updateQueue,x=x!==null?x.lastEffect:null,x!==null){var j=x=x.next;do{if((j.tag&m)===m){var O=j.create;j.destroy=O()}j=j.next}while(j!==x)}}function sh(m){var x=m.ref;if(x!==null){var j=m.stateNode;switch(m.tag){case 5:m=se(j);break;default:m=j}typeof x=="function"?x(m):x.current=m}}function yd(m){var x=m.alternate;x!==null&&(m.alternate=null,yd(x)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(x=m.stateNode,x!==null&&He(x)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}function cg(m){return m.tag===5||m.tag===3||m.tag===4}function lc(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||cg(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==18;){if(m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function vd(m,x,j){var O=m.tag;if(O===5||O===6)m=m.stateNode,x?De(j,m,x):xt(j,m);else if(O!==4&&(m=m.child,m!==null))for(vd(m,x,j),m=m.sibling;m!==null;)vd(m,x,j),m=m.sibling}function ug(m,x,j){var O=m.tag;if(O===5||O===6)m=m.stateNode,x?Kt(j,m,x):Ye(j,m);else if(O!==4&&(m=m.child,m!==null))for(ug(m,x,j),m=m.sibling;m!==null;)ug(m,x,j),m=m.sibling}var Jn=null,Da=!1;function Bi(m,x,j){for(j=j.child;j!==null;)ah(m,x,j),j=j.sibling}function ah(m,x,j){if(Fa&&typeof Fa.onCommitFiberUnmount=="function")try{Fa.onCommitFiberUnmount(nl,j)}catch{}switch(j.tag){case 5:Fs||sn(j,x);case 6:if(Ne){var O=Jn,H=Da;Jn=null,Bi(m,x,j),Jn=O,Da=H,Jn!==null&&(Da?mt(Jn,j.stateNode):ct(Jn,j.stateNode))}else Bi(m,x,j);break;case 18:Ne&&Jn!==null&&(Da?je(Jn,j.stateNode):Te(Jn,j.stateNode));break;case 4:Ne?(O=Jn,H=Da,Jn=j.stateNode.containerInfo,Da=!0,Bi(m,x,j),Jn=O,Da=H):(le&&(O=j.stateNode.containerInfo,H=$e(O),Xt(O,H)),Bi(m,x,j));break;case 0:case 11:case 14:case 15:if(!Fs&&(O=j.updateQueue,O!==null&&(O=O.lastEffect,O!==null))){H=O=O.next;do{var te=H,ye=te.destroy;te=te.tag,ye!==void 0&&((te&2)!==0||(te&4)!==0)&&ni(j,x,ye),H=H.next}while(H!==O)}Bi(m,x,j);break;case 1:if(!Fs&&(sn(j,x),O=j.stateNode,typeof O.componentWillUnmount=="function"))try{O.props=j.memoizedProps,O.state=j.memoizedState,O.componentWillUnmount()}catch(Be){En(j,x,Be)}Bi(m,x,j);break;case 21:Bi(m,x,j);break;case 22:j.mode&1?(Fs=(O=Fs)||j.memoizedState!==null,Bi(m,x,j),Fs=O):Bi(m,x,j);break;default:Bi(m,x,j)}}function cc(m){var x=m.updateQueue;if(x!==null){m.updateQueue=null;var j=m.stateNode;j===null&&(j=m.stateNode=new ri),x.forEach(function(O){var H=gv.bind(null,m,O);j.has(O)||(j.add(O),O.then(H,H))})}}function vi(m,x){var j=x.deletions;if(j!==null)for(var O=0;O<j.length;O++){var H=j[O];try{var te=m,ye=x;if(Ne){var Be=ye;e:for(;Be!==null;){switch(Be.tag){case 5:Jn=Be.stateNode,Da=!1;break e;case 3:Jn=Be.stateNode.containerInfo,Da=!0;break e;case 4:Jn=Be.stateNode.containerInfo,Da=!0;break e}Be=Be.return}if(Jn===null)throw Error(i(160));ah(te,ye,H),Jn=null,Da=!1}else ah(te,ye,H);var lt=H.alternate;lt!==null&&(lt.return=null),H.return=null}catch(Dt){En(H,x,Dt)}}if(x.subtreeFlags&12854)for(x=x.child;x!==null;)wd(x,m),x=x.sibling}function wd(m,x){var j=m.alternate,O=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:if(vi(x,m),si(m),O&4){try{oc(3,m,m.return),eu(3,m)}catch(Qt){En(m,m.return,Qt)}try{oc(5,m,m.return)}catch(Qt){En(m,m.return,Qt)}}break;case 1:vi(x,m),si(m),O&512&&j!==null&&sn(j,j.return);break;case 5:if(vi(x,m),si(m),O&512&&j!==null&&sn(j,j.return),Ne){if(m.flags&32){var H=m.stateNode;try{At(H)}catch(Qt){En(m,m.return,Qt)}}if(O&4&&(H=m.stateNode,H!=null)){var te=m.memoizedProps;if(j=j!==null?j.memoizedProps:te,O=m.type,x=m.updateQueue,m.updateQueue=null,x!==null)try{$t(H,x,O,j,te,m)}catch(Qt){En(m,m.return,Qt)}}}break;case 6:if(vi(x,m),si(m),O&4&&Ne){if(m.stateNode===null)throw Error(i(162));H=m.stateNode,te=m.memoizedProps,j=j!==null?j.memoizedProps:te;try{ut(H,j,te)}catch(Qt){En(m,m.return,Qt)}}break;case 3:if(vi(x,m),si(m),O&4){if(Ne&&ge&&j!==null&&j.memoizedState.isDehydrated)try{oe(x.containerInfo)}catch(Qt){En(m,m.return,Qt)}if(le){H=x.containerInfo,te=x.pendingChildren;try{Xt(H,te)}catch(Qt){En(m,m.return,Qt)}}}break;case 4:if(vi(x,m),si(m),O&4&&le){te=m.stateNode,H=te.containerInfo,te=te.pendingChildren;try{Xt(H,te)}catch(Qt){En(m,m.return,Qt)}}break;case 13:vi(x,m),si(m),H=m.child,H.flags&8192&&(te=H.memoizedState!==null,H.stateNode.isHidden=te,!te||H.alternate!==null&&H.alternate.memoizedState!==null||(iu=Ns())),O&4&&cc(m);break;case 22:var ye=j!==null&&j.memoizedState!==null;if(m.mode&1?(Fs=(j=Fs)||ye,vi(x,m),Fs=j):vi(x,m),si(m),O&8192){if(j=m.memoizedState!==null,(m.stateNode.isHidden=j)&&!ye&&(m.mode&1)!==0)for(qt=m,O=m.child;O!==null;){for(x=qt=O;qt!==null;){ye=qt;var Be=ye.child;switch(ye.tag){case 0:case 11:case 14:case 15:oc(4,ye,ye.return);break;case 1:sn(ye,ye.return);var lt=ye.stateNode;if(typeof lt.componentWillUnmount=="function"){var Dt=ye,ar=ye.return;try{var Er=Dt;lt.props=Er.memoizedProps,lt.state=Er.memoizedState,lt.componentWillUnmount()}catch(Qt){En(Dt,ar,Qt)}}break;case 5:sn(ye,ye.return);break;case 22:if(ye.memoizedState!==null){lh(x);continue}}Be!==null?(Be.return=ye,qt=Be):lh(x)}O=O.sibling}if(Ne){e:if(O=null,Ne)for(x=m;;){if(x.tag===5){if(O===null){O=x;try{H=x.stateNode,j?Lt(H):Ee(x.stateNode,x.memoizedProps)}catch(Qt){En(m,m.return,Qt)}}}else if(x.tag===6){if(O===null)try{te=x.stateNode,j?rr(te):we(te,x.memoizedProps)}catch(Qt){En(m,m.return,Qt)}}else if((x.tag!==22&&x.tag!==23||x.memoizedState===null||x===m)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===m)break e;for(;x.sibling===null;){if(x.return===null||x.return===m)break e;O===x&&(O=null),x=x.return}O===x&&(O=null),x.sibling.return=x.return,x=x.sibling}}}break;case 19:vi(x,m),si(m),O&4&&cc(m);break;case 21:break;default:vi(x,m),si(m)}}function si(m){var x=m.flags;if(x&2){try{if(Ne){e:{for(var j=m.return;j!==null;){if(cg(j)){var O=j;break e}j=j.return}throw Error(i(160))}switch(O.tag){case 5:var H=O.stateNode;O.flags&32&&(At(H),O.flags&=-33);var te=lc(m);ug(m,te,H);break;case 3:case 4:var ye=O.stateNode.containerInfo,Be=lc(m);vd(m,Be,ye);break;default:throw Error(i(161))}}}catch(lt){En(m,m.return,lt)}m.flags&=-3}x&4096&&(m.flags&=-4097)}function tu(m,x,j){qt=m,ih(m)}function ih(m,x,j){for(var O=(m.mode&1)!==0;qt!==null;){var H=qt,te=H.child;if(H.tag===22&&O){var ye=H.memoizedState!==null||Zc;if(!ye){var Be=H.alternate,lt=Be!==null&&Be.memoizedState!==null||Fs;Be=Zc;var Dt=Fs;if(Zc=ye,(Fs=lt)&&!Dt)for(qt=H;qt!==null;)ye=qt,lt=ye.child,ye.tag===22&&ye.memoizedState!==null?ch(H):lt!==null?(lt.return=ye,qt=lt):ch(H);for(;te!==null;)qt=te,ih(te),te=te.sibling;qt=H,Zc=Be,Fs=Dt}oh(m)}else(H.subtreeFlags&8772)!==0&&te!==null?(te.return=H,qt=te):oh(m)}}function oh(m){for(;qt!==null;){var x=qt;if((x.flags&8772)!==0){var j=x.alternate;try{if((x.flags&8772)!==0)switch(x.tag){case 0:case 11:case 15:Fs||eu(5,x);break;case 1:var O=x.stateNode;if(x.flags&4&&!Fs)if(j===null)O.componentDidMount();else{var H=x.elementType===x.type?j.memoizedProps:ei(x.type,j.memoizedProps);O.componentDidUpdate(H,j.memoizedState,O.__reactInternalSnapshotBeforeUpdate)}var te=x.updateQueue;te!==null&&mx(x,te,O);break;case 3:var ye=x.updateQueue;if(ye!==null){if(j=null,x.child!==null)switch(x.child.tag){case 5:j=se(x.child.stateNode);break;case 1:j=x.child.stateNode}mx(x,ye,j)}break;case 5:var Be=x.stateNode;j===null&&x.flags&4&&wt(Be,x.type,x.memoizedProps,x);break;case 6:break;case 4:break;case 12:break;case 13:if(ge&&x.memoizedState===null){var lt=x.alternate;if(lt!==null){var Dt=lt.memoizedState;if(Dt!==null){var ar=Dt.dehydrated;ar!==null&&he(ar)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}Fs||x.flags&512&&sh(x)}catch(Er){En(x,x.return,Er)}}if(x===m){qt=null;break}if(j=x.sibling,j!==null){j.return=x.return,qt=j;break}qt=x.return}}function lh(m){for(;qt!==null;){var x=qt;if(x===m){qt=null;break}var j=x.sibling;if(j!==null){j.return=x.return,qt=j;break}qt=x.return}}function ch(m){for(;qt!==null;){var x=qt;try{switch(x.tag){case 0:case 11:case 15:var j=x.return;try{eu(4,x)}catch(lt){En(x,j,lt)}break;case 1:var O=x.stateNode;if(typeof O.componentDidMount=="function"){var H=x.return;try{O.componentDidMount()}catch(lt){En(x,H,lt)}}var te=x.return;try{sh(x)}catch(lt){En(x,te,lt)}break;case 5:var ye=x.return;try{sh(x)}catch(lt){En(x,ye,lt)}}}catch(lt){En(x,x.return,lt)}if(x===m){qt=null;break}var Be=x.sibling;if(Be!==null){Be.return=x.return,qt=Be;break}qt=x.return}}var Do=0,pa=1,ro=2,ru=3,_d=4;if(typeof Symbol=="function"&&Symbol.for){var ai=Symbol.for;Do=ai("selector.component"),pa=ai("selector.has_pseudo_class"),ro=ai("selector.role"),ru=ai("selector.test_id"),_d=ai("selector.text")}function no(m){var x=Ue(m);if(x!=null){if(typeof x.memoizedProps["data-testname"]!="string")throw Error(i(364));return x}if(m=Pe(m),m===null)throw Error(i(362));return m.stateNode.current}function bd(m,x){switch(x.$$typeof){case Do:if(m.type===x.value)return!0;break;case pa:e:{x=x.value,m=[m,0];for(var j=0;j<m.length;){var O=m[j++],H=m[j++],te=x[H];if(O.tag!==5||!gt(O)){for(;te!=null&&bd(O,te);)H++,te=x[H];if(H===x.length){x=!0;break e}else for(O=O.child;O!==null;)m.push(O,H),O=O.sibling}}x=!1}return x;case ro:if(m.tag===5&&Bt(m.stateNode,x.value))return!0;break;case _d:if((m.tag===5||m.tag===6)&&(m=_t(m),m!==null&&0<=m.indexOf(x.value)))return!0;break;case ru:if(m.tag===5&&(m=m.memoizedProps["data-testname"],typeof m=="string"&&m.toLowerCase()===x.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function uh(m){switch(m.$$typeof){case Do:return"<"+(R(m.value)||"Unknown")+">";case pa:return":has("+(uh(m)||"")+")";case ro:return'[role="'+m.value+'"]';case _d:return'"'+m.value+'"';case ru:return'[data-testname="'+m.value+'"]';default:throw Error(i(365))}}function so(m,x){var j=[];m=[m,0];for(var O=0;O<m.length;){var H=m[O++],te=m[O++],ye=x[te];if(H.tag!==5||!gt(H)){for(;ye!=null&&bd(H,ye);)te++,ye=x[te];if(te===x.length)j.push(H);else for(H=H.child;H!==null;)m.push(H,te),H=H.sibling}}return j}function ao(m,x){if(!Ie)throw Error(i(363));m=no(m),m=so(m,x),x=[],m=Array.from(m);for(var j=0;j<m.length;){var O=m[j++];if(O.tag===5)gt(O)||x.push(O.stateNode);else for(O=O.child;O!==null;)m.push(O),O=O.sibling}return x}var dh=Math.ceil,Sd=l.ReactCurrentDispatcher,nu=l.ReactCurrentOwner,Gn=l.ReactCurrentBatchConfig,Ar=0,hn=null,Fn=null,Qn=0,vs=0,yl=Pr(0),Pn=0,su=null,Io=0,_n=0,au=0,uc=null,Qs=null,iu=0,kd=1/0,xa=null;function cn(){kd=Ns()+500}var Vn=!1,ss=null,Ui=null,vl=!1,wi=null,fh=0,as=0,Cd=null,ou=-1,lu=0;function Tn(){return(Ar&6)!==0?Ns():ou!==-1?ou:ou=Ns()}function ws(m){return(m.mode&1)===0?1:(Ar&2)!==0&&Qn!==0?Qn&-Qn:dv.transition!==null?(lu===0&&(lu=jf()),lu):(m=zr,m!==0?m:Je())}function Zs(m,x,j,O){if(50<as)throw as=0,Cd=null,Error(i(185));mi(m,j,O),((Ar&2)===0||m!==hn)&&(m===hn&&((Ar&2)===0&&(_n|=j),Pn===4&&Mo(m,Qn)),ea(m,O),j===1&&Ar===0&&(x.mode&1)===0&&(cn(),$c&&Bs()))}function ea(m,x){var j=m.callbackNode;rx(m,x);var O=Lr(m,m===hn?Qn:0);if(O===0)j!==null&&nx(j),m.callbackNode=null,m.callbackPriority=0;else if(x=O&-O,m.callbackPriority!==x){if(j!=null&&nx(j),x===1)m.tag===0?ax(dg.bind(null,m)):If(dg.bind(null,m)),Ft?rt(function(){(Ar&6)===0&&Bs()}):Ji(Ff,Bs),j=null;else{switch(Bc(O)){case 1:j=Ff;break;case 4:j=Pf;break;case 16:j=Rf;break;case 536870912:j=uv;break;default:j=Rf}j=yg(j,hh.bind(null,m))}m.callbackPriority=x,m.callbackNode=j}}function hh(m,x){if(ou=-1,lu=0,(Ar&6)!==0)throw Error(i(327));var j=m.callbackNode;if(Oo()&&m.callbackNode!==j)return null;var O=Lr(m,m===hn?Qn:0);if(O===0)return null;if((O&30)!==0||(O&m.expiredLanes)!==0||x)x=dc(m,O);else{x=O;var H=Ar;Ar|=2;var te=hg();(hn!==m||Qn!==x)&&(xa=null,cn(),wl(m,x));do try{gg();break}catch(Be){cu(m,Be)}while(!0);$0(),Sd.current=te,Ar=H,Fn!==null?x=0:(hn=null,Qn=0,x=Pn)}if(x!==0){if(x===2&&(H=Af(m),H!==0&&(O=H,x=gh(m,H))),x===1)throw j=su,wl(m,0),Mo(m,O),ea(m,Ns()),j;if(x===6)Mo(m,O);else{if(H=m.current.alternate,(O&30)===0&&!Ex(H)&&(x=dc(m,O),x===2&&(te=Af(m),te!==0&&(O=te,x=gh(m,te))),x===1))throw j=su,wl(m,0),Mo(m,O),ea(m,Ns()),j;switch(m.finishedWork=H,m.finishedLanes=O,x){case 0:case 1:throw Error(i(345));case 2:_l(m,Qs,xa);break;case 3:if(Mo(m,O),(O&130023424)===O&&(x=iu+500-Ns(),10<x)){if(Lr(m,0)!==0)break;if(H=m.suspendedLanes,(H&O)!==O){Tn(),m.pingedLanes|=m.suspendedLanes&H;break}m.timeoutHandle=J(_l.bind(null,m,Qs,xa),x);break}_l(m,Qs,xa);break;case 4:if(Mo(m,O),(O&4194240)===O)break;for(x=m.eventTimes,H=-1;0<O;){var ye=31-er(O);te=1<<ye,ye=x[ye],ye>H&&(H=ye),O&=~te}if(O=H,O=Ns()-O,O=(120>O?120:480>O?480:1080>O?1080:1920>O?1920:3e3>O?3e3:4320>O?4320:1960*dh(O/1960))-O,10<O){m.timeoutHandle=J(_l.bind(null,m,Qs,xa),O);break}_l(m,Qs,xa);break;case 5:_l(m,Qs,xa);break;default:throw Error(i(329))}}}return ea(m,Ns()),m.callbackNode===j?hh.bind(null,m):null}function gh(m,x){var j=uc;return m.current.memoizedState.isDehydrated&&(wl(m,x).flags|=256),m=dc(m,x),m!==2&&(x=Qs,Qs=j,x!==null&&mh(x)),m}function mh(m){Qs===null?Qs=m:Qs.push.apply(Qs,m)}function Ex(m){for(var x=m;;){if(x.flags&16384){var j=x.updateQueue;if(j!==null&&(j=j.stores,j!==null))for(var O=0;O<j.length;O++){var H=j[O],te=H.getSnapshot;H=H.value;try{if(!Di(te(),H))return!1}catch{return!1}}}if(j=x.child,x.subtreeFlags&16384&&j!==null)j.return=x,x=j;else{if(x===m)break;for(;x.sibling===null;){if(x.return===null||x.return===m)return!0;x=x.return}x.sibling.return=x.return,x=x.sibling}}return!0}function Mo(m,x){for(x&=~au,x&=~_n,m.suspendedLanes|=x,m.pingedLanes&=~x,m=m.expirationTimes;0<x;){var j=31-er(x),O=1<<j;m[j]=-1,x&=~O}}function dg(m){if((Ar&6)!==0)throw Error(i(327));Oo();var x=Lr(m,0);if((x&1)===0)return ea(m,Ns()),null;var j=dc(m,x);if(m.tag!==0&&j===2){var O=Af(m);O!==0&&(x=O,j=gh(m,O))}if(j===1)throw j=su,wl(m,0),Mo(m,x),ea(m,Ns()),j;if(j===6)throw Error(i(345));return m.finishedWork=m.current.alternate,m.finishedLanes=x,_l(m,Qs,xa),ea(m,Ns()),null}function fg(m){wi!==null&&wi.tag===0&&(Ar&6)===0&&Oo();var x=Ar;Ar|=1;var j=Gn.transition,O=zr;try{if(Gn.transition=null,zr=1,m)return m()}finally{zr=O,Gn.transition=j,Ar=x,(Ar&6)===0&&Bs()}}function ph(){vs=yl.current,Or(yl)}function wl(m,x){m.finishedWork=null,m.finishedLanes=0;var j=m.timeoutHandle;if(j!==me&&(m.timeoutHandle=me,ne(j)),Fn!==null)for(j=Fn.return;j!==null;){var O=j;switch(ad(O),O.tag){case 1:O=O.type.childContextTypes,O!=null&&ht();break;case 3:Kl(),Or(Ce),Or(ue),K0();break;case 5:G0(O);break;case 4:Kl();break;case 13:Or(On);break;case 19:Or(On);break;case 10:od(O.type._context);break;case 22:case 23:ph()}j=j.return}if(hn=m,Fn=m=bl(m.current,null),Qn=vs=x,Pn=0,su=null,au=_n=Io=0,Qs=uc=null,al!==null){for(x=0;x<al.length;x++)if(j=al[x],O=j.interleaved,O!==null){j.interleaved=null;var H=O.next,te=j.pending;if(te!==null){var ye=te.next;te.next=H,O.next=ye}j.pending=O}al=null}return m}function cu(m,x){do{var j=Fn;try{if($0(),Ra.current=ec,Kc){for(var O=An.memoizedState;O!==null;){var H=O.queue;H!==null&&(H.pending=null),O=O.next}Kc=!1}if(cl=0,xs=ns=An=null,cd=!1,ud=0,nu.current=null,j===null||j.return===null){Pn=1,su=x,Fn=null;break}e:{var te=m,ye=j.return,Be=j,lt=x;if(x=Qn,Be.flags|=32768,lt!==null&&typeof lt=="object"&&typeof lt.then=="function"){var Dt=lt,ar=Be,Er=ar.tag;if((ar.mode&1)===0&&(Er===0||Er===11||Er===15)){var Qt=ar.alternate;Qt?(ar.updateQueue=Qt.updateQueue,ar.memoizedState=Qt.memoizedState,ar.lanes=Qt.lanes):(ar.updateQueue=null,ar.memoizedState=null)}var bn=Sx(ye);if(bn!==null){bn.flags&=-257,fl(bn,ye,Be,te,x),bn.mode&1&&bx(te,Dt,x),x=bn,lt=Dt;var an=x.updateQueue;if(an===null){var ya=new Set;ya.add(lt),x.updateQueue=ya}else an.add(lt);break e}else{if((x&1)===0){bx(te,Dt,x),uu();break e}lt=Error(i(426))}}else if(Cn&&Be.mode&1){var io=Sx(ye);if(io!==null){(io.flags&65536)===0&&(io.flags|=256),fl(io,ye,Be,te,x),B0(tc(lt,Be));break e}}te=lt=tc(lt,Be),Pn!==4&&(Pn=2),uc===null?uc=[te]:uc.push(te),te=ye;do{switch(te.tag){case 3:te.flags|=65536,x&=-x,te.lanes|=x;var st=Zi(te,lt,x);Gc(te,st);break e;case 1:Be=lt;var ze=te.type,ft=te.stateNode;if((te.flags&128)===0&&(typeof ze.getDerivedStateFromError=="function"||ft!==null&&typeof ft.componentDidCatch=="function"&&(Ui===null||!Ui.has(ft)))){te.flags|=65536,x&=-x,te.lanes|=x;var Zt=eh(te,Be,x);Gc(te,Zt);break e}}te=te.return}while(te!==null)}pg(j)}catch(hr){x=hr,Fn===j&&j!==null&&(Fn=j=j.return);continue}break}while(!0)}function hg(){var m=Sd.current;return Sd.current=ec,m===null?ec:m}function uu(){(Pn===0||Pn===3||Pn===2)&&(Pn=4),hn===null||(Io&268435455)===0&&(_n&268435455)===0||Mo(hn,Qn)}function dc(m,x){var j=Ar;Ar|=2;var O=hg();(hn!==m||Qn!==x)&&(xa=null,wl(m,x));do try{Nx();break}catch(H){cu(m,H)}while(!0);if($0(),Ar=j,Sd.current=O,Fn!==null)throw Error(i(261));return hn=null,Qn=0,Pn}function Nx(){for(;Fn!==null;)mg(Fn)}function gg(){for(;Fn!==null&&!sx();)mg(Fn)}function mg(m){var x=Rx(m.alternate,m,vs);m.memoizedProps=m.pendingProps,x===null?pg(m):Fn=x,nu.current=null}function pg(m){var x=m;do{var j=x.alternate;if(m=x.return,(x.flags&32768)===0){if(j=ic(j,x,vs),j!==null){Fn=j;return}}else{if(j=Cx(j,x),j!==null){j.flags&=32767,Fn=j;return}if(m!==null)m.flags|=32768,m.subtreeFlags=0,m.deletions=null;else{Pn=6,Fn=null;return}}if(x=x.sibling,x!==null){Fn=x;return}Fn=x=m}while(x!==null);Pn===0&&(Pn=5)}function _l(m,x,j){var O=zr,H=Gn.transition;try{Gn.transition=null,zr=1,Ax(m,x,j,O)}finally{Gn.transition=H,zr=O}return null}function Ax(m,x,j,O){do Oo();while(wi!==null);if((Ar&6)!==0)throw Error(i(327));j=m.finishedWork;var H=m.finishedLanes;if(j===null)return null;if(m.finishedWork=null,m.finishedLanes=0,j===m.current)throw Error(i(177));m.callbackNode=null,m.callbackPriority=0;var te=j.lanes|j.childLanes;if(rl(m,te),m===hn&&(Fn=hn=null,Qn=0),(j.subtreeFlags&2064)===0&&(j.flags&2064)===0||vl||(vl=!0,yg(Rf,function(){return Oo(),null})),te=(j.flags&15990)!==0,(j.subtreeFlags&15990)!==0||te){te=Gn.transition,Gn.transition=null;var ye=zr;zr=1;var Be=Ar;Ar|=4,nu.current=null,Tx(m,j),wd(j,m),V(m.containerInfo),m.current=j,tu(j),rd(),Ar=Be,zr=ye,Gn.transition=te}else m.current=j;if(vl&&(vl=!1,wi=m,fh=H),te=m.pendingLanes,te===0&&(Ui=null),Uc(j.stateNode),ea(m,Ns()),x!==null)for(O=m.onRecoverableError,j=0;j<x.length;j++)H=x[j],O(H.value,{componentStack:H.stack,digest:H.digest});if(Vn)throw Vn=!1,m=ss,ss=null,m;return(fh&1)!==0&&m.tag!==0&&Oo(),te=m.pendingLanes,(te&1)!==0?m===Cd?as++:(as=0,Cd=m):as=0,Bs(),null}function Oo(){if(wi!==null){var m=Bc(fh),x=Gn.transition,j=zr;try{if(Gn.transition=null,zr=16>m?16:m,wi===null)var O=!1;else{if(m=wi,wi=null,fh=0,(Ar&6)!==0)throw Error(i(331));var H=Ar;for(Ar|=4,qt=m.current;qt!==null;){var te=qt,ye=te.child;if((qt.flags&16)!==0){var Be=te.deletions;if(Be!==null){for(var lt=0;lt<Be.length;lt++){var Dt=Be[lt];for(qt=Dt;qt!==null;){var ar=qt;switch(ar.tag){case 0:case 11:case 15:oc(8,ar,te)}var Er=ar.child;if(Er!==null)Er.return=ar,qt=Er;else for(;qt!==null;){ar=qt;var Qt=ar.sibling,bn=ar.return;if(yd(ar),ar===Dt){qt=null;break}if(Qt!==null){Qt.return=bn,qt=Qt;break}qt=bn}}}var an=te.alternate;if(an!==null){var ya=an.child;if(ya!==null){an.child=null;do{var io=ya.sibling;ya.sibling=null,ya=io}while(ya!==null)}}qt=te}}if((te.subtreeFlags&2064)!==0&&ye!==null)ye.return=te,qt=ye;else e:for(;qt!==null;){if(te=qt,(te.flags&2048)!==0)switch(te.tag){case 0:case 11:case 15:oc(9,te,te.return)}var st=te.sibling;if(st!==null){st.return=te.return,qt=st;break e}qt=te.return}}var ze=m.current;for(qt=ze;qt!==null;){ye=qt;var ft=ye.child;if((ye.subtreeFlags&2064)!==0&&ft!==null)ft.return=ye,qt=ft;else e:for(ye=ze;qt!==null;){if(Be=qt,(Be.flags&2048)!==0)try{switch(Be.tag){case 0:case 11:case 15:eu(9,Be)}}catch(hr){En(Be,Be.return,hr)}if(Be===ye){qt=null;break e}var Zt=Be.sibling;if(Zt!==null){Zt.return=Be.return,qt=Zt;break e}qt=Be.return}}if(Ar=H,Bs(),Fa&&typeof Fa.onPostCommitFiberRoot=="function")try{Fa.onPostCommitFiberRoot(nl,m)}catch{}O=!0}return O}finally{zr=j,Gn.transition=x}}return!1}function xg(m,x,j){x=tc(j,x),x=Zi(m,x,1),m=jo(m,x,1),x=Tn(),m!==null&&(mi(m,1,x),ea(m,x))}function En(m,x,j){if(m.tag===3)xg(m,m,j);else for(;x!==null;){if(x.tag===3){xg(x,m,j);break}else if(x.tag===1){var O=x.stateNode;if(typeof x.type.getDerivedStateFromError=="function"||typeof O.componentDidCatch=="function"&&(Ui===null||!Ui.has(O))){m=tc(j,m),m=eh(x,m,1),x=jo(x,m,1),m=Tn(),x!==null&&(mi(x,1,m),ea(x,m));break}}x=x.return}}function jx(m,x,j){var O=m.pingCache;O!==null&&O.delete(x),x=Tn(),m.pingedLanes|=m.suspendedLanes&j,hn===m&&(Qn&j)===j&&(Pn===4||Pn===3&&(Qn&130023424)===Qn&&500>Ns()-iu?wl(m,0):au|=j),ea(m,x)}function Fx(m,x){x===0&&((m.mode&1)===0?x=1:(x=dn,dn<<=1,(dn&130023424)===0&&(dn=4194304)));var j=Tn();m=Li(m,x),m!==null&&(mi(m,x,j),ea(m,j))}function Px(m){var x=m.memoizedState,j=0;x!==null&&(j=x.retryLane),Fx(m,j)}function gv(m,x){var j=0;switch(m.tag){case 13:var O=m.stateNode,H=m.memoizedState;H!==null&&(j=H.retryLane);break;case 19:O=m.stateNode;break;default:throw Error(i(314))}O!==null&&O.delete(x),Fx(m,j)}var Rx;Rx=function(m,x,j){if(m!==null)if(m.memoizedProps!==x.pendingProps||Ce.current)ys=!0;else{if((m.lanes&j)===0&&(x.flags&128)===0)return ys=!1,gl(m,x,j);ys=(m.flags&131072)!==0}else ys=!1,Cn&&(x.flags&1048576)!==0&&ix(x,Wl,x.index);switch(x.lanes=0,x.tag){case 2:var O=x.type;xd(m,x),m=x.pendingProps;var H=Xe(x,ue.current);Hc(x,j),H=dd(null,x,O,m,H,j);var te=Gf();return x.flags|=1,typeof H=="object"&&H!==null&&typeof H.render=="function"&&H.$$typeof===void 0?(x.tag=1,x.memoizedState=null,x.updateQueue=null,It(O)?(te=!0,nt(x)):te=!1,x.memoizedState=H.state!==null&&H.state!==void 0?H.state:null,z0(x),H.updater=gd,x.stateNode=H,H._reactInternals=x,Qi(x,O,m,j),x=Ys(null,x,O,!0,te,j)):(x.tag=0,Cn&&te&&sd(x),js(null,x,H,j),x=x.child),x;case 16:O=x.elementType;e:{switch(xd(m,x),m=x.pendingProps,H=O._init,O=H(O._payload),x.type=O,H=x.tag=mv(O),m=ei(O,m),H){case 0:x=eo(null,x,O,m,j);break e;case 1:x=Ws(null,x,O,m,j);break e;case 11:x=th(null,x,O,m,j);break e;case 14:x=rc(null,x,O,ei(O.type,m),j);break e}throw Error(i(306,O,""))}return x;case 0:return O=x.type,H=x.pendingProps,H=x.elementType===O?H:ei(O,H),eo(m,x,O,H,j);case 1:return O=x.type,H=x.pendingProps,H=x.elementType===O?H:ei(O,H),Ws(m,x,O,H,j);case 3:e:{if(hl(x),m===null)throw Error(i(387));O=x.pendingProps,te=x.memoizedState,H=te.element,gx(m,x),il(x,O,null,j);var ye=x.memoizedState;if(O=ye.element,ge&&te.isDehydrated)if(te={element:O,isDehydrated:!1,cache:ye.cache,pendingSuspenseBoundaries:ye.pendingSuspenseBoundaries,transitions:ye.transitions},x.updateQueue.baseState=te,x.memoizedState=te,x.flags&256){H=tc(Error(i(423)),x),x=nc(m,x,O,j,H);break e}else if(O!==H){H=tc(Error(i(424)),x),x=nc(m,x,O,j,H);break e}else for(ge&&(fa=ve(x.stateNode.containerInfo),Us=x,Cn=!0,Oi=null,id=!1),j=fx(x,null,O,j),x.child=j;j;)j.flags=j.flags&-3|4096,j=j.sibling;else{if(zl(),O===H){x=Ro(m,x,j);break e}js(m,x,O,j)}x=x.child}return x;case 5:return H0(x),m===null&&L0(x),O=x.type,H=x.pendingProps,te=m!==null?m.memoizedProps:null,ye=H.children,K(O,H)?ye=null:te!==null&&K(O,te)&&(x.flags|=32),fn(m,x),js(m,x,ye,j),x.child;case 6:return m===null&&L0(x),null;case 13:return og(m,x,j);case 4:return zf(x,x.stateNode.containerInfo),O=x.pendingProps,m===null?x.child=Gl(x,null,O,j):js(m,x,O,j),x.child;case 11:return O=x.type,H=x.pendingProps,H=x.elementType===O?H:ei(O,H),th(m,x,O,H,j);case 7:return js(m,x,x.pendingProps,j),x.child;case 8:return js(m,x,x.pendingProps.children,j),x.child;case 12:return js(m,x,x.pendingProps.children,j),x.child;case 10:e:{if(O=x.type._context,H=x.pendingProps,te=x.memoizedProps,ye=H.value,hx(x,O,ye),te!==null)if(Di(te.value,ye)){if(te.children===H.children&&!Ce.current){x=Ro(m,x,j);break e}}else for(te=x.child,te!==null&&(te.return=x);te!==null;){var Be=te.dependencies;if(Be!==null){ye=te.child;for(var lt=Be.firstContext;lt!==null;){if(lt.context===O){if(te.tag===1){lt=Ao(-1,j&-j),lt.tag=2;var Dt=te.updateQueue;if(Dt!==null){Dt=Dt.shared;var ar=Dt.pending;ar===null?lt.next=lt:(lt.next=ar.next,ar.next=lt),Dt.pending=lt}}te.lanes|=j,lt=te.alternate,lt!==null&&(lt.lanes|=j),Vl(te.return,j,x),Be.lanes|=j;break}lt=lt.next}}else if(te.tag===10)ye=te.type===x.type?null:te.child;else if(te.tag===18){if(ye=te.return,ye===null)throw Error(i(341));ye.lanes|=j,Be=ye.alternate,Be!==null&&(Be.lanes|=j),Vl(ye,j,x),ye=te.sibling}else ye=te.child;if(ye!==null)ye.return=te;else for(ye=te;ye!==null;){if(ye===x){ye=null;break}if(te=ye.sibling,te!==null){te.return=ye.return,ye=te;break}ye=ye.return}te=ye}js(m,x,H.children,j),x=x.child}return x;case 9:return H=x.type,O=x.pendingProps.children,Hc(x,j),H=Ja(H),O=O(H),x.flags|=1,js(m,x,O,j),x.child;case 14:return O=x.type,H=ei(O,x.pendingProps),H=ei(O.type,H),rc(m,x,O,H,j);case 15:return Po(m,x,x.type,x.pendingProps,j);case 17:return O=x.type,H=x.pendingProps,H=x.elementType===O?H:ei(O,H),xd(m,x),x.tag=1,It(O)?(m=!0,nt(x)):m=!1,Hc(x,j),_x(x,O,H),Qi(x,O,H,j),Ys(null,x,O,!0,m,j);case 19:return nh(m,x,j);case 22:return wn(m,x,j)}throw Error(i(156,x.tag))};function yg(m,x){return Ji(m,x)}function Dx(m,x,j,O){this.tag=m,this.key=j,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=x,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=O,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ii(m,x,j,O){return new Dx(m,x,j,O)}function du(m){return m=m.prototype,!(!m||!m.isReactComponent)}function mv(m){if(typeof m=="function")return du(m)?1:0;if(m!=null){if(m=m.$$typeof,m===_)return 11;if(m===k)return 14}return 2}function bl(m,x){var j=m.alternate;return j===null?(j=ii(m.tag,x,m.key,m.mode),j.elementType=m.elementType,j.type=m.type,j.stateNode=m.stateNode,j.alternate=m,m.alternate=j):(j.pendingProps=x,j.type=m.type,j.flags=0,j.subtreeFlags=0,j.deletions=null),j.flags=m.flags&14680064,j.childLanes=m.childLanes,j.lanes=m.lanes,j.child=m.child,j.memoizedProps=m.memoizedProps,j.memoizedState=m.memoizedState,j.updateQueue=m.updateQueue,x=m.dependencies,j.dependencies=x===null?null:{lanes:x.lanes,firstContext:x.firstContext},j.sibling=m.sibling,j.index=m.index,j.ref=m.ref,j}function xh(m,x,j,O,H,te){var ye=2;if(O=m,typeof m=="function")du(m)&&(ye=1);else if(typeof m=="string")ye=5;else e:switch(m){case f:return zs(j.children,H,te,x);case p:ye=8,H|=8;break;case g:return m=ii(12,j,x,H|2),m.elementType=g,m.lanes=te,m;case b:return m=ii(13,j,x,H),m.elementType=b,m.lanes=te,m;case N:return m=ii(19,j,x,H),m.elementType=N,m.lanes=te,m;case T:return fu(j,H,te,x);default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case y:ye=10;break e;case v:ye=9;break e;case _:ye=11;break e;case k:ye=14;break e;case w:ye=16,O=null;break e}throw Error(i(130,m==null?m:typeof m,""))}return x=ii(ye,j,x,H),x.elementType=m,x.type=O,x.lanes=te,x}function zs(m,x,j,O){return m=ii(7,m,O,x),m.lanes=j,m}function fu(m,x,j,O){return m=ii(22,m,O,x),m.elementType=T,m.lanes=j,m.stateNode={isHidden:!1},m}function hu(m,x,j){return m=ii(6,m,null,x),m.lanes=j,m}function yh(m,x,j){return x=ii(4,m.children!==null?m.children:[],m.key,x),x.lanes=j,x.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},x}function Ix(m,x,j,O,H){this.tag=x,this.containerInfo=m,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=me,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lc(0),this.expirationTimes=Lc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lc(0),this.identifierPrefix=O,this.onRecoverableError=H,ge&&(this.mutableSourceEagerHydrationData=null)}function vg(m,x,j,O,H,te,ye,Be,lt){return m=new Ix(m,x,j,Be,lt),x===1?(x=1,te===!0&&(x|=8)):x=0,te=ii(3,null,null,x),m.current=te,te.stateNode=m,te.memoizedState={element:O,isDehydrated:j,cache:null,transitions:null,pendingSuspenseBoundaries:null},z0(te),m}function vh(m){if(!m)return ae;m=m._reactInternals;e:{if(D(m)!==m||m.tag!==1)throw Error(i(170));var x=m;do{switch(x.tag){case 3:x=x.stateNode.context;break e;case 1:if(It(x.type)){x=x.stateNode.__reactInternalMemoizedMergedChildContext;break e}}x=x.return}while(x!==null);throw Error(i(171))}if(m.tag===1){var j=m.type;if(It(j))return mr(m,j,x)}return x}function fc(m){var x=m._reactInternals;if(x===void 0)throw typeof m.render=="function"?Error(i(188)):(m=Object.keys(m).join(","),Error(i(268,m)));return m=Y(x),m===null?null:m.stateNode}function wh(m,x){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var j=m.retryLane;m.retryLane=j!==0&&j<x?j:x}}function gu(m,x){wh(m,x),(m=m.alternate)&&wh(m,x)}function pv(m){return m=Y(m),m===null?null:m.stateNode}function Mx(){return null}return r.attemptContinuousHydration=function(m){if(m.tag===13){var x=Li(m,134217728);if(x!==null){var j=Tn();Zs(x,m,134217728,j)}gu(m,134217728)}},r.attemptDiscreteHydration=function(m){if(m.tag===13){var x=Li(m,1);if(x!==null){var j=Tn();Zs(x,m,1,j)}gu(m,1)}},r.attemptHydrationAtCurrentPriority=function(m){if(m.tag===13){var x=ws(m),j=Li(m,x);if(j!==null){var O=Tn();Zs(j,m,x,O)}gu(m,x)}},r.attemptSynchronousHydration=function(m){switch(m.tag){case 3:var x=m.stateNode;if(x.current.memoizedState.isDehydrated){var j=Yn(x.pendingLanes);j!==0&&(Yi(x,j|1),ea(x,Ns()),(Ar&6)===0&&(cn(),Bs()))}break;case 13:fg(function(){var O=Li(m,1);if(O!==null){var H=Tn();Zs(O,m,1,H)}}),gu(m,1)}},r.batchedUpdates=function(m,x){var j=Ar;Ar|=1;try{return m(x)}finally{Ar=j,Ar===0&&(cn(),$c&&Bs())}},r.createComponentSelector=function(m){return{$$typeof:Do,value:m}},r.createContainer=function(m,x,j,O,H,te,ye){return vg(m,x,!1,null,j,O,H,te,ye)},r.createHasPseudoClassSelector=function(m){return{$$typeof:pa,value:m}},r.createHydrationContainer=function(m,x,j,O,H,te,ye,Be,lt){return m=vg(j,O,!0,m,H,te,ye,Be,lt),m.context=vh(null),j=m.current,O=Tn(),H=ws(j),te=Ao(O,H),te.callback=x??null,jo(j,te,H),m.current.lanes=H,mi(m,H,O),ea(m,O),m},r.createPortal=function(m,x,j){var O=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:O==null?null:""+O,children:m,containerInfo:x,implementation:j}},r.createRoleSelector=function(m){return{$$typeof:ro,value:m}},r.createTestNameSelector=function(m){return{$$typeof:ru,value:m}},r.createTextSelector=function(m){return{$$typeof:_d,value:m}},r.deferredUpdates=function(m){var x=zr,j=Gn.transition;try{return Gn.transition=null,zr=16,m()}finally{zr=x,Gn.transition=j}},r.discreteUpdates=function(m,x,j,O,H){var te=zr,ye=Gn.transition;try{return Gn.transition=null,zr=1,m(x,j,O,H)}finally{zr=te,Gn.transition=ye,Ar===0&&cn()}},r.findAllNodes=ao,r.findBoundingRects=function(m,x){if(!Ie)throw Error(i(363));x=ao(m,x),m=[];for(var j=0;j<x.length;j++)m.push(Qe(x[j]));for(x=m.length-1;0<x;x--){j=m[x];for(var O=j.x,H=O+j.width,te=j.y,ye=te+j.height,Be=x-1;0<=Be;Be--)if(x!==Be){var lt=m[Be],Dt=lt.x,ar=Dt+lt.width,Er=lt.y,Qt=Er+lt.height;if(O>=Dt&&te>=Er&&H<=ar&&ye<=Qt){m.splice(x,1);break}else if(O!==Dt||j.width!==lt.width||Qt<te||Er>ye){if(!(te!==Er||j.height!==lt.height||ar<O||Dt>H)){Dt>O&&(lt.width+=Dt-O,lt.x=O),ar<H&&(lt.width=H-Dt),m.splice(x,1);break}}else{Er>te&&(lt.height+=Er-te,lt.y=te),Qt<ye&&(lt.height=ye-Er),m.splice(x,1);break}}}return m},r.findHostInstance=fc,r.findHostInstanceWithNoPortals=function(m){return m=G(m),m=m!==null?ie(m):null,m===null?null:m.stateNode},r.findHostInstanceWithWarning=function(m){return fc(m)},r.flushControlled=function(m){var x=Ar;Ar|=1;var j=Gn.transition,O=zr;try{Gn.transition=null,zr=1,m()}finally{zr=O,Gn.transition=j,Ar=x,Ar===0&&(cn(),Bs())}},r.flushPassiveEffects=Oo,r.flushSync=fg,r.focusWithin=function(m,x){if(!Ie)throw Error(i(363));for(m=no(m),x=so(m,x),x=Array.from(x),m=0;m<x.length;){var j=x[m++];if(!gt(j)){if(j.tag===5&&Ut(j.stateNode))return!0;for(j=j.child;j!==null;)x.push(j),j=j.sibling}}return!1},r.getCurrentUpdatePriority=function(){return zr},r.getFindAllNodesFailureDescription=function(m,x){if(!Ie)throw Error(i(363));var j=0,O=[];m=[no(m),0];for(var H=0;H<m.length;){var te=m[H++],ye=m[H++],Be=x[ye];if((te.tag!==5||!gt(te))&&(bd(te,Be)&&(O.push(uh(Be)),ye++,ye>j&&(j=ye)),ye<x.length))for(te=te.child;te!==null;)m.push(te,ye),te=te.sibling}if(j<x.length){for(m=[];j<x.length;j++)m.push(uh(x[j]));return`findAllNodes was able to match part of the selector:
  `+(O.join(" > ")+`

No matching component was found for:
  `)+m.join(" > ")}return null},r.getPublicRootInstance=function(m){if(m=m.current,!m.child)return null;switch(m.child.tag){case 5:return se(m.child.stateNode);default:return m.child.stateNode}},r.injectIntoDevTools=function(m){if(m={bundleType:m.bundleType,version:m.version,rendererPackageName:m.rendererPackageName,rendererConfig:m.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:l.ReactCurrentDispatcher,findHostInstanceByFiber:pv,findFiberByHostInstance:m.findFiberByHostInstance||Mx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")m=!1;else{var x=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(x.isDisabled||!x.supportsFiber)m=!0;else{try{nl=x.inject(m),Fa=x}catch{}m=!!x.checkDCE}}return m},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(m,x,j,O){if(!Ie)throw Error(i(363));m=ao(m,x);var H=it(m,j,O).disconnect;return{disconnect:function(){H()}}},r.registerMutableSourceForHydration=function(m,x){var j=x._getVersion;j=j(x._source),m.mutableSourceEagerHydrationData==null?m.mutableSourceEagerHydrationData=[x,j]:m.mutableSourceEagerHydrationData.push(x,j)},r.runWithPriority=function(m,x){var j=zr;try{return zr=m,x()}finally{zr=j}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(m,x,j,O){var H=x.current,te=Tn(),ye=ws(H);return j=vh(j),x.context===null?x.context=j:x.pendingContext=j,x=Ao(te,ye),x.payload={element:m},O=O===void 0?null:O,O!==null&&(x.callback=O),m=jo(H,x,ye),m!==null&&(Zs(m,H,ye,te),ld(m,H,ye)),ye},r}),xw}var r4;function iO(){return r4||(r4=1,pw.exports=aO()),pw.exports}var oO=iO();const lO=Cp(oO);var yw={exports:{}},Su={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n4;function cO(){return n4||(n4=1,Su.ConcurrentRoot=1,Su.ContinuousEventPriority=4,Su.DefaultEventPriority=16,Su.DiscreteEventPriority=1,Su.IdleEventPriority=536870912,Su.LegacyRoot=0),Su}var s4;function uO(){return s4||(s4=1,yw.exports=cO()),yw.exports}var N6=uO(),dO=$r();const a4={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let i4=!1,o4=!1;const lb=".react-konva-event";let A6=!1;function fO(e){A6=e}const hO=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,gO=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,mO={};function O1(e,t,r=mO){if(!i4&&"zIndex"in t&&(console.warn(gO),i4=!0),!o4&&t.draggable){var n=t.x!==void 0||t.y!==void 0,s=t.onDragEnd||t.onDragMove;n&&!s&&(console.warn(hO),o4=!0)}for(var a in r)if(!a4[a]){var i=a.slice(0,2)==="on",l=r[a]!==t[a];if(i&&l){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e.off(c,r[a])}var d=!t.hasOwnProperty(a);d&&e.setAttr(a,void 0)}var f=A6||t._useStrictMode,p={},g=!1;const y={};for(var a in t)if(!a4[a]){var i=a.slice(0,2)==="on",v=r[a]!==t[a];if(i&&v){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),t[a]&&(y[c]=t[a])}!i&&(t[a]!==r[a]||f&&t[a]!==e.getAttr(a))&&(g=!0,p[a]=t[a])}g&&(e.setAttrs(p),qu(e));for(var c in y)e.on(c+lb,y[c])}function qu(e){if(!dO.Konva.autoDrawEnabled){var t=e.getLayer()||e.getStage();t&&t.batchDraw()}}var vw=w2();const j6={},pO={};tp.Node.prototype._applyProps=O1;function xO(e,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}e.add(t),qu(e)}function yO(e,t,r){let n=tp[e];n||(console.error(`Konva has no node with the type ${e}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${e}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=tp.Group);const s={},a={};for(var i in t){var l=i.slice(0,2)==="on";l?a[i]=t[i]:s[i]=t[i]}const c=new n(s);return O1(c,a),c}function vO(e,t,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${e}"`)}function wO(e,t,r){return!1}function _O(e){return e}function bO(){return null}function SO(){return null}function kO(e,t,r,n){return pO}function CO(){}function TO(e){}function EO(e,t){return!1}function NO(){return j6}function AO(){return j6}const jO=setTimeout,FO=clearTimeout,PO=-1;function RO(e,t){return!1}const DO=!1,IO=!0,MO=!0;function OO(e,t){t.parent===e?t.moveToTop():e.add(t),qu(e)}function LO(e,t){t.parent===e?t.moveToTop():e.add(t),qu(e)}function F6(e,t,r){t._remove(),e.add(t),t.setZIndex(r.getZIndex()),qu(e)}function BO(e,t,r){F6(e,t,r)}function UO(e,t){t.destroy(),t.off(lb),qu(e)}function $O(e,t){t.destroy(),t.off(lb),qu(e)}function WO(e,t,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function zO(e,t,r){}function HO(e,t,r,n,s){O1(e,s,n)}function GO(e){e.hide(),qu(e)}function VO(e){}function KO(e,t){(t.visible==null||t.visible)&&e.show()}function qO(e,t){}function XO(e){}function YO(){}const JO=()=>N6.DefaultEventPriority,QO=Object.freeze(Object.defineProperty({__proto__:null,appendChild:OO,appendChildToContainer:LO,appendInitialChild:xO,cancelTimeout:FO,clearContainer:XO,commitMount:zO,commitTextUpdate:WO,commitUpdate:HO,createInstance:yO,createTextInstance:vO,detachDeletedInstance:YO,finalizeInitialChildren:wO,getChildHostContext:AO,getCurrentEventPriority:JO,getPublicInstance:_O,getRootHostContext:NO,hideInstance:GO,hideTextInstance:VO,idlePriority:vw.unstable_IdlePriority,insertBefore:F6,insertInContainerBefore:BO,isPrimaryRenderer:DO,noTimeout:PO,now:vw.unstable_now,prepareForCommit:bO,preparePortalMount:SO,prepareUpdate:kO,removeChild:UO,removeChildFromContainer:$O,resetAfterCommit:CO,resetTextContent:TO,run:vw.unstable_runWithPriority,scheduleTimeout:jO,shouldDeprioritizeSubtree:EO,shouldSetTextContent:RO,supportsMutation:MO,unhideInstance:KO,unhideTextInstance:qO,warnsIfNotActing:IO},Symbol.toStringTag,{value:"Module"}));var ZO=Object.defineProperty,eL=Object.defineProperties,tL=Object.getOwnPropertyDescriptors,l4=Object.getOwnPropertySymbols,rL=Object.prototype.hasOwnProperty,nL=Object.prototype.propertyIsEnumerable,c4=(e,t,r)=>t in e?ZO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,u4=(e,t)=>{for(var r in t||(t={}))rL.call(t,r)&&c4(e,r,t[r]);if(l4)for(var r of l4(t))nL.call(t,r)&&c4(e,r,t[r]);return e},sL=(e,t)=>eL(e,tL(t)),d4,f4;typeof window<"u"&&((d4=window.document)!=null&&d4.createElement||((f4=window.navigator)==null?void 0:f4.product)==="ReactNative")?C.useLayoutEffect:C.useEffect;function P6(e,t,r){if(!e)return;if(r(e)===!0)return e;let n=e.child;for(;n;){const s=P6(n,t,r);if(s)return s;n=n.sibling}}function R6(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const h4=console.error;console.error=function(){const e=[...arguments].join("");if(e?.startsWith("Warning:")&&e.includes("useContext")){console.error=h4;return}return h4.apply(this,arguments)};const cb=R6(C.createContext(null));class D6 extends C.Component{render(){return C.createElement(cb.Provider,{value:this._reactInternals},this.props.children)}}function aL(){const e=C.useContext(cb);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=C.useId();return C.useMemo(()=>{for(const n of[e,e?.alternate]){if(!n)continue;const s=P6(n,!1,a=>{let i=a.memoizedState;for(;i;){if(i.memoizedState===t)return!0;i=i.next}});if(s)return s}},[e,t])}function iL(){const e=aL(),[t]=C.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&typeof r.type=="object"){const s=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;s&&s!==cb&&!t.has(s)&&t.set(s,C.useContext(R6(s)))}r=r.return}return t}function I6(){const e=iL();return C.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>C.createElement(t,null,C.createElement(r.Provider,sL(u4({},n),{value:e.get(r)}))),t=>C.createElement(D6,u4({},t))),[e])}function oL(e){const t=us.useRef({});return us.useLayoutEffect(()=>{t.current=e}),us.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const lL=e=>{const t=us.useRef(null),r=us.useRef(null),n=us.useRef(null),s=oL(e),a=I6(),i=l=>{const{forwardedRef:c}=e;c&&(typeof c=="function"?c(l):c.current=l)};return us.useLayoutEffect(()=>(r.current=new tp.Stage({width:e.width,height:e.height,container:t.current}),i(r.current),n.current=Hh.createContainer(r.current,N6.LegacyRoot,!1,null),Hh.updateContainer(us.createElement(a,{},e.children),n.current),()=>{tp.isBrowser&&(i(null),Hh.updateContainer(null,n.current,null),r.current.destroy())}),[]),us.useLayoutEffect(()=>{i(r.current),O1(r.current,e,s),Hh.updateContainer(us.createElement(a,{},e.children),n.current,null)}),us.createElement("div",{ref:t,id:e.id,accessKey:e.accessKey,className:e.className,role:e.role,style:e.style,tabIndex:e.tabIndex,title:e.title})},Qd="Layer",cL="FastLayer",Ko="Group",uL="Label",la="Rect",Ru="Circle",dL="Ellipse",fL="Wedge",Sa="Line",hL="Sprite",M6="Image",jl="Text",gL="TextPath",mL="Star",pL="Ring",xL="Arc",yL="Tag",vL="Path",wL="RegularPolygon",T_="Arrow",_L="Shape",O6="Transformer",bL="18.2.13",Hh=lO(QO);Hh.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:us.version,rendererPackageName:"react-konva"});const Zd=us.forwardRef((e,t)=>us.createElement(D6,{},us.createElement(lL,{...e,forwardedRef:t}))),SL=fO,kL=Object.freeze(Object.defineProperty({__proto__:null,Arc:xL,Arrow:T_,Circle:Ru,Ellipse:dL,FastLayer:cL,Group:Ko,Image:M6,KonvaRenderer:Hh,Label:uL,Layer:Qd,Line:Sa,Path:vL,Rect:la,RegularPolygon:wL,Ring:pL,Shape:_L,Sprite:hL,Stage:Zd,Star:mL,Tag:yL,Text:jl,TextPath:gL,Transformer:O6,Wedge:fL,useContextBridge:I6,useStrictMode:SL,version:bL},Symbol.toStringTag,{value:"Module"})),bt=({children:e,hover:t=!0,className:r="",paddingClass:n="p-6",...s})=>{const a=`
    bg-white rounded-xl shadow-md border border-gray-200 ${n}
    ${t?"hover:shadow-lg hover:-translate-y-1 transition-all duration-200":""}
    ${r}
  `;return o.jsx(Ze.div,{className:a,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},...s,children:e})},CL=({children:e,className:t=""})=>o.jsx("div",{className:`border-b border-gray-200 pb-4 mb-4 ${t}`,children:e}),TL=({children:e,className:t=""})=>o.jsx("h3",{className:`text-xl font-semibold text-gray-800 ${t}`,children:e}),EL=({children:e,className:t=""})=>o.jsx("div",{className:`py-4 ${t}`,children:e}),NL=({children:e,className:t=""})=>o.jsx("div",{className:`border-t border-gray-200 pt-4 mt-4 ${t}`,children:e});bt.Header=CL;bt.Title=TL;bt.Body=EL;bt.Footer=NL;const AL=e=>{const[t,r]=C.useState({width:800,height:600}),n=C.useRef(null),s=C.useCallback(()=>{if(e.current){e.current.getBoundingClientRect();const a=Math.min(1200,window.innerWidth*.8),i=Math.min(800,window.innerHeight*.6),l=4/3;let c=a,d=c/l;d>i&&(d=i,c=d*l),r({width:c,height:d})}},[e]);return C.useEffect(()=>(s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)),[s]),{canvasSize:t,stageRef:n,updateCanvasSize:s}},E_={convertToOriginal:(e,t,r)=>r?{x:Number(((e-r.x)/r.scale).toFixed(4)),y:Number(((t-r.y)/r.scale).toFixed(4))}:{x:e,y:t},convertToCanvas:(e,t,r)=>r?{x:Number((r.x+e*r.scale).toFixed(4)),y:Number((r.y+t*r.scale).toFixed(4))}:{x:e,y:t},isPointInImage:(e,t)=>t?e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height:!1,calculateImageScale:(e,t)=>{if(!e||!t)return 1;const r=40,n=t.width-r,s=t.height-r;return Math.min(n/e.width,s/e.height)},calculateImageInfo:(e,t)=>{if(!e||!t)return null;const r=40,n=t.width-r,s=t.height-r,a=Math.min(n/e.width,s/e.height),i=e.width*a,l=e.height*a,c=(t.width-i)/2,d=(t.height-l)/2;return{x:c,y:d,width:i,height:l,scale:a,originalWidth:e.width,originalHeight:e.height}}},jL=(e,t)=>{const[r,n]=C.useState(null),s=C.useCallback((a,i)=>E_.calculateImageInfo(a,i),[]);return C.useEffect(()=>{if(e&&t){const a=s(e,t);n(a)}},[e,t,s]),r},FL=e=>{const t=C.useCallback((n,s)=>E_.convertToOriginal(n,s,e),[e]),r=C.useCallback((n,s)=>E_.convertToCanvas(n,s,e),[e]);return{convertToOriginal:t,convertToCanvas:r}},mm={create:(e,t,r,n,s)=>({id:s,x:e-r/2,y:t-n/2,width:Math.max(r,30),height:Math.max(n,10),fill:"rgba(0, 123, 255, 0.15)",stroke:"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),validate:e=>e.width>0&&e.height>0,findAtPosition:(e,t,r)=>e.find(n=>t>=n.x&&t<=n.x+n.width&&r>=n.y&&r<=n.y+n.height),generateId:()=>`block_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},Ph={create:(e,t,r,n,s,a,i)=>({id:i,startX:e,startY:t,endX:r,endY:n,startBlock:s,endBlock:a,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,pointerLength:10,pointerWidth:10}),snapToNearestBlock:(e,t,r,n=60)=>{let s=null,a=1/0;for(const i of r){const l=i.x+i.width/2,c=i.y+i.height/2,d=Math.sqrt(Math.pow(e-l,2)+Math.pow(t-c,2));d<=n&&d<a&&(a=d,s=i)}return s?{x:s.x+s.width/2,y:s.y+s.height/2,blockId:s.id,block:s,distance:a}:null},validate:(e,t,r,n,s)=>Ph.snapToNearestBlock(e,t,s)!==null,generateId:()=>`arrow_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},ww={create:(e,t,r)=>({id:r,blockId:e,word:t}),update:(e,t,r)=>e.map(n=>n.blockId===t?{...n,word:r}:n),delete:(e,t)=>e.filter(r=>r.blockId!==t),generateId:e=>`word_${e}`,validate:e=>e&&e.trim().length>0},PL={testData:{blocks:[],words:[],arrows:[],imageUrl:null},canvas:{size:{width:800,height:600},image:null,imageInfo:null,selectedTool:"edit"},creation:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null},ui:{selectedBlock:null,showWordPanel:!1,isLoading:!1,error:null}},RL=(e,t)=>{switch(t.type){case"SET_CANVAS_SIZE":return{...e,canvas:{...e.canvas,size:t.payload}};case"SET_IMAGE":return{...e,canvas:{...e.canvas,image:t.payload}};case"SET_IMAGE_INFO":return{...e,canvas:{...e.canvas,imageInfo:t.payload}};case"SET_SELECTED_TOOL":return{...e,canvas:{...e.canvas,selectedTool:t.payload}};case"ADD_BLOCK":return{...e,testData:{...e.testData,blocks:[...e.testData.blocks,t.payload]}};case"ADD_WORD":return{...e,testData:{...e.testData,words:[...e.testData.words,t.payload]}};case"ADD_ARROW":return{...e,testData:{...e.testData,arrows:[...e.testData.arrows,t.payload]}};case"UPDATE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.map(r=>r.id===t.payload.id?{...r,...t.payload.updates}:r)}};case"DELETE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.filter(r=>r.id!==t.payload),words:e.testData.words.filter(r=>r.blockId!==t.payload),arrows:e.testData.arrows.filter(r=>r.startBlock!==t.payload&&r.endBlock!==t.payload)}};case"UPDATE_WORDS":return{...e,testData:{...e.testData,words:t.payload}};case"SET_CREATION_STATE":return{...e,creation:{...e.creation,...t.payload}};case"SET_UI_STATE":return{...e,ui:{...e.ui,...t.payload}};case"SET_LOADING":return{...e,ui:{...e.ui,isLoading:t.payload}};case"SET_ERROR":return{...e,ui:{...e.ui,error:t.payload}};case"RESET_TESTDATA":return{...e,testData:{blocks:[],words:[],arrows:[],imageUrl:e.testData.imageUrl}};default:return e}},DL=({testName:e="",showQuestionCount:t=!0,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const[l,c]=C.useReducer(RL,PL),{showNotification:d}=ja(),{makeAuthenticatedRequest:f}=Xi(),{user:p}=Hn(),g=C.useRef(null),y=C.useRef(null),v=C.useRef(null),_=C.useRef({}),b=C.useRef({}),{canvasSize:N,stageRef:k}=AL(g),w=jL(l.canvas.image,N),{convertToOriginal:T}=FL(w);C.useEffect(()=>{c({type:"SET_CANVAS_SIZE",payload:N})},[N]),C.useEffect(()=>{w&&c({type:"SET_IMAGE_INFO",payload:w})},[w]),C.useEffect(()=>{const re=v.current;if(!re)return;const se=l.ui.selectedBlock?.id?_.current[l.ui.selectedBlock.id]:null;se?(re.nodes([se]),re.getLayer()?.batchDraw()):(re.nodes([]),re.getLayer()?.batchDraw())},[l.ui.selectedBlock]);const A=C.useCallback(()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:null}}),c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null}}),c({type:"RESET_TESTDATA"}),c({type:"SET_ERROR",payload:null})},[]),F=C.useCallback(re=>{const se=re.target.files[0];if(!se||!se.type.startsWith("image/")){d("Please select a valid image file","error");return}const B=new FileReader;B.onload=z=>{const U=z.target.result,V=new Image;V.crossOrigin="anonymous",V.onload=()=>{c({type:"SET_IMAGE",payload:V}),c({type:"SET_UI_STATE",payload:{imageUrl:U}})},V.src=U},B.readAsDataURL(se)},[d]),R=C.useCallback(re=>{const se=k.current;if(!se)return;const B=se.getPointerPosition();if(B){if(l.canvas.selectedTool==="create"){const z=mm.findAtPosition(l.testData.blocks,B.x,B.y);if(z){c({type:"SET_UI_STATE",payload:{selectedBlock:z}});return}c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!0,blockCreationStart:{x:B.x,y:B.y}}})}else if(l.canvas.selectedTool==="edit"){const z=mm.findAtPosition(l.testData.blocks,B.x,B.y);c(z?{type:"SET_UI_STATE",payload:{selectedBlock:z}}:{type:"SET_UI_STATE",payload:{selectedBlock:null}})}else if(l.canvas.selectedTool==="arrow"){const z=re.target===se,U=mm.findAtPosition(l.testData.blocks,B.x,B.y);(z||!U)&&c({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!0,arrowStart:{x:B.x,y:B.y}}})}}},[l.canvas.selectedTool,w,l.testData.blocks]),E=C.useCallback(re=>{if(l.creation.isCreatingBlock&&l.creation.blockCreationStart){const se=k.current;if(!se)return;const B=se.getPointerPosition();if(!B)return;const z=Math.abs(B.x-l.creation.blockCreationStart.x),U=Math.abs(B.y-l.creation.blockCreationStart.y),V=10,q=Math.max(z,V),L=Math.max(U,V);c({type:"SET_CREATION_STATE",payload:{previewBlock:{x:Math.min(B.x,l.creation.blockCreationStart.x),y:Math.min(B.y,l.creation.blockCreationStart.y),width:q,height:L,fill:"rgba(0, 123, 255, 0.3)",stroke:"#007bff",strokeWidth:2,dash:[5,5],opacity:.7}}})}else if(l.creation.isDrawingArrow&&l.creation.arrowStart){const se=k.current;if(!se)return;const B=se.getPointerPosition();if(!B)return;c({type:"SET_CREATION_STATE",payload:{previewArrow:{startX:l.creation.arrowStart.x,startY:l.creation.arrowStart.y,endX:B.x,endY:B.y,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,dash:[5,5],opacity:.7}}})}},[l.creation]),D=C.useCallback(re=>{if(l.creation.isCreatingBlock&&l.creation.blockCreationStart){const se=k.current;if(!se)return;const B=se.getPointerPosition();if(!B)return;const z=Math.abs(B.x-l.creation.blockCreationStart.x),U=Math.abs(B.y-l.creation.blockCreationStart.y),V=10,q=Math.max(z,V),L=Math.max(U,V),M=Math.min(B.x,l.creation.blockCreationStart.x)+q/2,X=Math.min(B.y,l.creation.blockCreationStart.y)+L/2,K=mm.generateId(),Z=mm.create(M,X,q,L,K),J=ww.create(K,`Word ${l.testData.blocks.length+1}`,ww.generateId(K));c({type:"ADD_BLOCK",payload:Z}),c({type:"ADD_WORD",payload:J}),c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,blockCreationStart:null,previewBlock:null}}),l.testData.blocks.length===0&&c({type:"SET_UI_STATE",payload:{showWordPanel:!0}})}else if(l.creation.isDrawingArrow&&l.creation.arrowStart){const se=k.current;if(!se)return;const B=se.getPointerPosition();if(!B)return;if(Ph.validate(l.creation.arrowStart.x,l.creation.arrowStart.y,B.x,B.y,l.testData.blocks)){const z=Ph.snapToNearestBlock(l.creation.arrowStart.x,l.creation.arrowStart.y,l.testData.blocks),U=Ph.snapToNearestBlock(B.x,B.y,l.testData.blocks),V=z?z.x:l.creation.arrowStart.x,q=z?z.y:l.creation.arrowStart.y,L=U?U.x:B.x,M=U?U.y:B.y,X=Ph.generateId(),K=Ph.create(V,q,L,M,z?z.blockId:null,U?U.blockId:null,X);c({type:"ADD_ARROW",payload:K}),d("Arrow created successfully!","success")}else d("Arrow must start near a block!","error");c({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!1,arrowStart:null,previewArrow:null}})}},[l.creation,l.testData.blocks,d]),I=C.useCallback(async()=>{console.log(" [MatchingTestCreator] handleSaveTest clicked");const re=G();if(Object.keys(re).length>0){console.warn(" [MatchingTestCreator] Validation errors:",re),d("Please fix validation errors before saving","error");return}try{console.log(" [MatchingTestCreator] Preparing data to save...",{blocks:l.testData.blocks.length,words:l.testData.words.length,arrows:l.testData.arrows.length,imageUrl:l.ui.imageUrl?"present":"missing"}),c({type:"SET_LOADING",payload:!0});let se=l.ui.imageUrl;if(l.ui.imageUrl&&l.ui.imageUrl.startsWith("data:")){const z=await f("/.netlify/functions/upload-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataUrl:l.ui.imageUrl,folder:"matching_tests"})}),U=await z.json();if(z.ok&&U.success&&U.url)se=U.url;else throw new Error(U.message||"Upload failed")}const B=l.testData.blocks.map((z,U)=>{let V;if(w){const M=T(z.x,z.y),X=T(z.x+z.width,z.y+z.height);V={x:M.x,y:M.y,width:Number((X.x-M.x).toFixed(4)),height:Number((X.y-M.y).toFixed(4))}}else V={x:Number(z.x.toFixed(4)),y:Number(z.y.toFixed(4)),width:Number(z.width.toFixed(4)),height:Number(z.height.toFixed(4))};const q=l.testData.words.find(M=>M.blockId===z.id),L=l.testData.arrows.find(M=>M.startBlock===z.id);return{question_id:U+1,word:q?.word||`Word ${U+1}`,block_coordinates:V,has_arrow:!!L,arrow:L&&w?(()=>{const M=T(L.startX,L.startY),X=T(L.endX,L.endY),K=M.x/w.originalWidth*100,Z=M.y/w.originalHeight*100,J=X.x/w.originalWidth*100,ne=X.y/w.originalHeight*100;return{start_x:Number(M.x.toFixed(4)),start_y:Number(M.y.toFixed(4)),end_x:Number(X.x.toFixed(4)),end_y:Number(X.y.toFixed(4)),rel_start_x:Number(K.toFixed(4)),rel_start_y:Number(Z.toFixed(4)),rel_end_x:Number(J.toFixed(4)),rel_end_y:Number(ne.toFixed(4)),image_width:w.originalWidth,image_height:w.originalHeight,style:L.style||{color:"#dc3545",thickness:3}}})():null}});r&&(console.log(" [MatchingTestCreator] Calling onTestSaved with processed data"),r({success:!0,message:"Test data prepared for assignment",blocks:l.testData.blocks,words:l.testData.words,arrows:l.testData.arrows,imageUrl:se,processedQuestions:B}))}catch(se){console.error("Save error:",se),d(`Error saving test: ${se.message}`,"error")}finally{c({type:"SET_LOADING",payload:!1})}},[l.testData,l.ui.imageUrl,w,T,f,r,d,e,p]),G=C.useCallback(()=>{const re={};return e.trim()||(re.testName="Test name is required"),l.testData.blocks.length===0&&(re.blocks="At least one block is required"),re},[e,l.testData.blocks.length]),Y=()=>o.jsxs("div",{className:"flex flex-wrap gap-2 p-4 bg-gray-50 border-b",children:[o.jsx(et,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"create"}),variant:l.canvas.selectedTool==="create"?"primary":"secondary",size:"sm",children:" Create Blocks"}),o.jsx(et,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"edit"}),variant:l.canvas.selectedTool==="edit"?"primary":"secondary",size:"sm",children:" Edit Blocks"}),o.jsx(et,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"arrow"}),variant:l.canvas.selectedTool==="arrow"?"primary":"secondary",size:"sm",children:" Draw Arrows"}),o.jsx(et,{onClick:A,variant:"secondary",size:"sm",children:" Reset"}),o.jsx(et,{onClick:()=>y.current?.click(),variant:"secondary",size:"sm",children:" Upload Image"})]}),ee=()=>o.jsx(Zd,{width:N.width,height:N.height,ref:k,onMouseDown:R,onMouseMove:E,onMouseUp:D,className:l.canvas.selectedTool==="arrow"||l.canvas.selectedTool==="create"?"cursor-crosshair":"cursor-default",children:o.jsxs(Qd,{children:[l.canvas.image&&w&&o.jsx(M6,{image:l.canvas.image,x:w.x,y:w.y,width:w.width,height:w.height}),l.testData.blocks.map(re=>o.jsxs(Ko,{ref:se=>{se&&(b.current[re.id]=se)},draggable:l.canvas.selectedTool==="edit",x:re.x,y:re.y,onMouseEnter:se=>{const B=se.target.getStage()?.container();B&&(B.style.cursor=l.ui.selectedBlock?.id===re.id?"nwse-resize":"move")},onMouseLeave:se=>{const B=se.target.getStage()?.container();B&&(B.style.cursor=l.canvas.selectedTool==="arrow"?"crosshair":"default")},onDragStart:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:re}})},onDragEnd:se=>{const{x:B,y:z}=se.target.position();c({type:"UPDATE_BLOCK",payload:{id:re.id,updates:{x:B,y:z}}})},onClick:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:re}})},onTap:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:re}})},children:[o.jsx(la,{ref:se=>{se&&(_.current[re.id]=se)},width:re.width,height:re.height,fill:re.fill,stroke:re.stroke,strokeWidth:re.strokeWidth,cornerRadius:re.cornerRadius,shadowColor:re.shadowColor,shadowBlur:re.shadowBlur,shadowOffset:re.shadowOffset,shadowOpacity:re.shadowOpacity,draggable:l.canvas.selectedTool==="edit",onDragEnd:se=>{const{x:B,y:z}=se.target.getParent().position();c({type:"UPDATE_BLOCK",payload:{id:re.id,updates:{x:B,y:z}}})},onMouseEnter:se=>{const B=se.target.getStage()?.container();B&&(B.style.cursor=l.ui.selectedBlock?.id===re.id?"nwse-resize":"move")},onMouseLeave:se=>{const B=se.target.getStage()?.container();B&&(B.style.cursor=l.canvas.selectedTool==="arrow"?"crosshair":"default")},onTransformEnd:se=>{const B=_.current[re.id];if(!B)return;const z=Math.max(10,B.width()*B.scaleX()),U=Math.max(10,B.height()*B.scaleY());B.scaleX(1),B.scaleY(1),c({type:"UPDATE_BLOCK",payload:{id:re.id,updates:{width:z,height:U}}})}}),o.jsx(jl,{x:2,y:2,text:`${l.testData.blocks.indexOf(re)+1}`,fontSize:Math.min(12,Math.max(8,re.width/4)),fontFamily:"Arial",fill:"#333",fontStyle:"bold",listening:!1})]},re.id)),o.jsx(O6,{ref:v,rotateEnabled:!1,flipEnabled:!1,boundBoxFunc:(re,se)=>({...se,width:Math.max(se.width,10),height:Math.max(se.height,10)})}),l.testData.arrows.map(re=>o.jsx(T_,{points:[re.startX,re.startY,re.endX,re.endY],stroke:re.stroke,fill:re.fill,strokeWidth:re.strokeWidth,pointerLength:re.pointerLength,pointerWidth:re.pointerWidth},re.id)),l.creation.previewBlock&&o.jsx(la,{x:l.creation.previewBlock.x,y:l.creation.previewBlock.y,width:l.creation.previewBlock.width,height:l.creation.previewBlock.height,fill:l.creation.previewBlock.fill,stroke:l.creation.previewBlock.stroke,strokeWidth:l.creation.previewBlock.strokeWidth,dash:l.creation.previewBlock.dash,opacity:l.creation.previewBlock.opacity}),l.creation.previewArrow&&o.jsx(T_,{points:[l.creation.previewArrow.startX,l.creation.previewArrow.startY,l.creation.previewArrow.endX,l.creation.previewArrow.endY],stroke:l.creation.previewArrow.stroke,fill:l.creation.previewArrow.fill,strokeWidth:l.creation.previewArrow.strokeWidth,dash:l.creation.previewArrow.dash,opacity:l.creation.previewArrow.opacity})]})}),ie=C.useMemo(()=>l.testData.blocks.length===0?null:o.jsxs("div",{className:"word-panel bg-gray-50 border-t border-gray-200 p-4 w-full",style:{height:"min(400px, 40vh)",overflowY:"auto"},children:[o.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Words (Auto-created with blocks)"}),o.jsx("div",{className:"space-y-2",children:l.testData.words.map(re=>{const se=l.testData.blocks.find(B=>B.id===re.blockId);return o.jsxs("div",{className:"p-2 bg-white rounded border",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsxs("span",{className:"text-xs text-gray-500",children:["Block ",l.testData.blocks.indexOf(se)+1]}),o.jsx("button",{onClick:()=>c({type:"DELETE_BLOCK",payload:se.id}),className:"text-red-500 hover:text-red-700 text-xs",children:""})]}),o.jsx("input",{type:"text",value:re.word,onChange:B=>{const z=ww.update(l.testData.words,re.blockId,B.target.value);c({type:"UPDATE_WORDS",payload:z})},className:"w-full text-sm px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Enter word text"})]},re.blockId)})})]}),[l.testData.words,l.testData.blocks]);return o.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex flex-col h-screen bg-gray-100",children:[o.jsx("div",{className:"bg-white shadow-sm border-b p-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{children:o.jsx("div",{className:"mt-2 text-sm text-gray-600",children:o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("span",{children:[o.jsx("strong",{children:"Test Name:"})," ",e||"Untitled Test"]}),o.jsxs("span",{children:[o.jsx("strong",{children:"Questions:"})," ",l.testData.blocks.length," (auto-generated from blocks)"]})]})})}),o.jsx("div",{className:"flex gap-2",children:o.jsx(et,{onClick:I,disabled:a||l.ui.isLoading,variant:"primary",children:a||l.ui.isLoading?o.jsx(Fr,{size:"sm"}):"Save Test"})})]})}),Y(),o.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[o.jsx("div",{ref:g,className:"bg-white border overflow-auto",style:{minHeight:"400px",maxHeight:"calc(100vh - 200px)",height:"auto"},children:ee()}),ie]}),o.jsx("input",{ref:y,type:"file",accept:"image/*",onChange:F,className:"hidden"})]})},b0=C.createContext(null);function IL(e,t){return{getTheme:function(){return t??null}}}function Bl(){const e=C.useContext(b0);return e==null&&(function(t,...r){const n=new URL("https://lexical.dev/docs/error"),s=new URLSearchParams;s.append("code",t);for(const a of r)s.append("v",a);throw n.search=s.toString(),Error(`Minified Lexical error #${t}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(8),e}function Pt(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const tl=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,ML=tl&&"documentMode"in document?document.documentMode:null,Al=tl&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),ef=tl&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),Vy=!(!tl||!("InputEvent"in window)||ML)&&"getTargetRanges"in new window.InputEvent("input"),rp=tl&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),l0=tl&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,OL=tl&&/Android/.test(navigator.userAgent),L6=tl&&/^(?=.*Chrome).*/i.test(navigator.userAgent),g4=tl&&OL&&L6,Ky=tl&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!L6;function B6(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}const LL=1,BL=3,UL=9,$L=11,tf=0,U6=1,c0=2,WL=0,zL=1,HL=2,qy=4,Xy=8,ub=128,GL=1792|(112|(3|qy|Xy)|ub),db=1,fb=2,hb=3,gb=4,mb=5,pb=6,L1=rp||l0||Ky?"":"",jc=`

`,VL=ef?"":L1,rf={bold:1,capitalize:1024,code:16,highlight:ub,italic:2,lowercase:256,strikethrough:qy,subscript:32,superscript:64,underline:Xy,uppercase:512},KL={directionless:1,unmergeable:2},m4={center:fb,end:pb,justify:gb,left:db,right:hb,start:mb},qL={[fb]:"center",[pb]:"end",[gb]:"justify",[db]:"left",[hb]:"right",[mb]:"start"},XL={normal:0,segmented:2,token:1},YL={[WL]:"normal",[HL]:"segmented",[zL]:"token"},p4="$config";function $6(e,t,r,n,s,a){let i=e.getFirstChild();for(;i!==null;){const l=i.__key;i.__parent===t&&(yt(i)&&$6(i,l,r,n,s,a),r.has(l)||a.delete(l),s.push(l)),i=i.getNextSibling()}}const JL=100;let N_=!1,xb=0;function QL(e){xb=e.timeStamp}function _w(e,t,r){const n=e.nodeName==="BR",s=t.__lexicalLineBreak;return s&&(e===s||n&&e.previousSibling===s)||n&&q1(e,r)!==void 0}function ZL(e,t,r){const n=el(So(r));let s=null,a=null;n!==null&&n.anchorNode===e&&(s=n.anchorOffset,a=n.focusOffset);const i=e.nodeValue;i!==null&&Ob(t,i,s,a,!1)}function eB(e,t,r){if(Tt(e)){const n=e.anchor.getNode();if(n.is(r)&&e.format!==n.getFormat())return!1}return Rc(t)&&r.isAttached()}function tB(e,t,r,n){for(let s=e;s&&!tU(s);s=Lp(s)){const a=q1(s,t);if(a!==void 0){const i=Os(a,r);if(i)return nn(i)||!$n(s)?void 0:[s,i]}else if(s===n)return[n,OA(r)]}}function W6(e,t,r){N_=!0;const n=performance.now()-xb>JL;try{Wi(e,(()=>{const s=Ht()||(function(g){return g.getEditorState().read((()=>{const y=Ht();return y!==null?y.clone():null}))})(e),a=new Map,i=e.getRootElement(),l=e._editorState,c=e._blockCursorElement;let d=!1,f="";for(let g=0;g<t.length;g++){const y=t[g],v=y.type,_=y.target,b=tB(_,e,l,i);if(!b)continue;const[N,k]=b;if(v==="characterData")n&&Gt(k)&&Rc(_)&&eB(s,_,k)&&ZL(_,k,e);else if(v==="childList"){d=!0;const w=y.addedNodes;for(let F=0;F<w.length;F++){const R=w[F],E=IA(R),D=R.parentNode;if(D!=null&&R!==c&&E===null&&!_w(R,D,e)){if(ef){const I=($n(R)?R.innerText:null)||R.nodeValue;I&&(f+=I)}D.removeChild(R)}}const T=y.removedNodes,A=T.length;if(A>0){let F=0;for(let R=0;R<A;R++){const E=T[R];(_w(E,_,e)||c===E)&&(_.appendChild(E),F++)}A!==F&&a.set(N,k)}}}if(a.size>0)for(const[g,y]of a)y.reconcileObservedMutation(g,e);const p=r.takeRecords();if(p.length>0){for(let g=0;g<p.length;g++){const y=p[g],v=y.addedNodes,_=y.target;for(let b=0;b<v.length;b++){const N=v[b],k=N.parentNode;k==null||N.nodeName!=="BR"||_w(N,_,e)||k.removeChild(N)}}r.takeRecords()}s!==null&&(d&&Aa(s),ef&&$A(e)&&s.insertRawText(f))}))}finally{N_=!1}}function z6(e){const t=e._observer;t!==null&&W6(e,t.takeRecords(),t)}function H6(e){(function(t){xb===0&&So(t).addEventListener("textInput",QL,!0)})(e),e._observer=new MutationObserver(((t,r)=>{W6(e,t,r)}))}function rB(e){const t=new Map,r=new Set;for(let n=typeof e=="function"?e:e.replace;n.prototype&&n.prototype.getType!==void 0;n=Object.getPrototypeOf(n)){const{ownNodeConfig:s}=Wb(n);if(s&&s.stateConfigs)for(const a of s.stateConfigs){let i;"stateConfig"in a?(i=a.stateConfig,a.flat&&r.add(i.key)):i=a,t.set(i.key,i)}}return{flatKeys:r,sharedConfigMap:t}}let nB=class G6{constructor(t,r,n=void 0,s=new Map,a=void 0){this.node=t,this.sharedNodeState=r,this.unknownState=n,this.knownState=s;const{sharedConfigMap:i}=this.sharedNodeState,l=a!==void 0?a:(function(c,d,f){let p=f.size;if(d)for(const g in d){const y=c.get(g);y&&f.has(y)||p++}return p})(i,n,s);this.size=l}getValue(t){const r=this.knownState.get(t);if(r!==void 0)return r;this.sharedNodeState.sharedConfigMap.set(t.key,t);let n=t.defaultValue;if(this.unknownState&&t.key in this.unknownState){const s=this.unknownState[t.key];s!==void 0&&(n=t.parse(s)),this.updateFromKnown(t,n)}return n}getInternalState(){return[this.unknownState,this.knownState]}toJSON(){const t={...this.unknownState},r={};for(const[n,s]of this.knownState)n.isEqual(s,n.defaultValue)?delete t[n.key]:t[n.key]=n.unparse(s);for(const n of this.sharedNodeState.flatKeys)n in t&&(r[n]=t[n],delete t[n]);return x4(t)&&(r.$=t),r}getWritable(t){if(this.node===t)return this;const{sharedNodeState:r,unknownState:n}=this,s=new Map(this.knownState);return new G6(t,r,(function(a,i,l){let c;if(l)for(const[d,f]of Object.entries(l)){const p=a.get(d);p?i.has(p)||i.set(p,p.parse(f)):(c=c||{},c[d]=f)}return c})(r.sharedConfigMap,s,n),s,this.size)}updateFromKnown(t,r){const n=t.key;this.sharedNodeState.sharedConfigMap.set(n,t);const{knownState:s,unknownState:a}=this;s.has(t)||a&&n in a||(a&&(delete a[n],this.unknownState=x4(a)),this.size++),s.set(t,r)}updateFromUnknown(t,r){const n=this.sharedNodeState.sharedConfigMap.get(t);n?this.updateFromKnown(n,n.parse(r)):(this.unknownState=this.unknownState||{},t in this.unknownState||this.size++,this.unknownState[t]=r)}updateFromJSON(t){const{knownState:r}=this;for(const n of r.keys())r.set(n,n.defaultValue);if(this.size=r.size,this.unknownState=void 0,t)for(const[n,s]of Object.entries(t))this.updateFromUnknown(n,s)}};function sB(e){const t=e.getWritable(),r=t.__state?t.__state.getWritable(t):new nB(t,V6(t));return t.__state=r,r}function V6(e){return e.__state?e.__state.sharedNodeState:PA(Bp(),e.getType()).sharedNodeState}function x4(e){if(e)for(const t in e)return e}function y4(e,t,r){for(const[n,s]of t.knownState){if(e.has(n.key))continue;e.add(n.key);const a=r?r.getValue(n):n.defaultValue;if(a!==s&&!n.isEqual(a,s))return!0}return!1}function v4(e,t,r){const{unknownState:n}=t,s=r?r.unknownState:void 0;if(n){for(const[a,i]of Object.entries(n))if(!e.has(a)&&(e.add(a),i!==(s?s[a]:void 0)))return!0}return!1}function w4(e,t){const r=e.__state;return r&&r.node===e?r.getWritable(t):r}function _4(e,t){const r=e.__mode,n=e.__format,s=e.__style,a=t.__mode,i=t.__format,l=t.__style,c=e.__state,d=t.__state;return(r===null||r===a)&&(n===null||n===i)&&(s===null||s===l)&&(e.__state===null||c===d||(function(f,p){if(f===p)return!0;if(f&&p&&f.size!==p.size)return!1;const g=new Set;return!(f&&y4(g,f,p)||p&&y4(g,p,f)||f&&v4(g,f,p)||p&&v4(g,p,f))})(c,d))}function b4(e,t){const r=e.mergeWithSibling(t),n=rs()._normalizedNodes;return n.add(e.__key),n.add(t.__key),r}function S4(e){let t,r,n=e;if(n.__text!==""||!n.isSimpleText()||n.isUnmergeable()){for(;(t=n.getPreviousSibling())!==null&&Gt(t)&&t.isSimpleText()&&!t.isUnmergeable();){if(t.__text!==""){if(_4(t,n)){n=b4(t,n);break}break}t.remove()}for(;(r=n.getNextSibling())!==null&&Gt(r)&&r.isSimpleText()&&!r.isUnmergeable();){if(r.__text!==""){if(_4(n,r)){n=b4(n,r);break}break}r.remove()}}else n.remove()}function Yy(e){return k4(e.anchor),k4(e.focus),e}function k4(e){for(;e.type==="element";){const t=e.getNode(),r=e.offset;let n,s;if(r===t.getChildrenSize()?(n=t.getChildAtIndex(r-1),s=!0):(n=t.getChildAtIndex(r),s=!1),Gt(n)){e.set(n.__key,s?n.getTextContentSize():0,"text",!0);break}if(!yt(n))break;e.set(n.__key,s?n.getChildrenSize():0,"element",!0)}}let nf,Ga,np,B1,A_,j_,sf,Yo,F_,sp,Gs="",El=null,Nl="",wc="",Rh=!1,Jy=!1;function Qy(e,t){const r=sf.get(e);if(t!==null){const n=I_(e);n.parentNode===t&&t.removeChild(n)}if(Yo.has(e)||Ga._keyToDOMMap.delete(e),yt(r)){const n=e1(r,sf);P_(n,0,n.length-1,null)}r!==void 0&&Lb(sp,np,B1,r,"destroyed")}function P_(e,t,r,n){let s=t;for(;s<=r;++s){const a=e[s];a!==void 0&&Qy(a,n)}}function Rd(e,t){e.setProperty("text-align",t)}const aB="40px";function K6(e,t){const r=nf.theme.indent;if(typeof r=="string"){const s=e.classList.contains(r);t>0&&!s?e.classList.add(r):t<1&&s&&e.classList.remove(r)}const n=getComputedStyle(e).getPropertyValue("--lexical-indent-base-value")||aB;e.style.setProperty("padding-inline-start",t===0?"":`calc(${t} * ${n})`)}function q6(e,t){const r=e.style;t===0?Rd(r,""):t===db?Rd(r,"left"):t===fb?Rd(r,"center"):t===hb?Rd(r,"right"):t===gb?Rd(r,"justify"):t===mb?Rd(r,"start"):t===pb&&Rd(r,"end")}function R_(e,t){const r=(function(n){const s=n.__dir;if(s!==null)return s;if(qs(n))return null;const a=n.getParentOrThrow();return qs(a)&&a.__dir===null?"auto":null})(t);r!==null?e.dir=r:e.removeAttribute("dir")}function Zy(e,t){const r=Yo.get(e);r===void 0&&Pt(60);const n=r.createDOM(nf,Ga);if((function(s,a,i){const l=i._keyToDOMMap;(function(c,d,f){const p=`__lexicalKey_${d._key}`;c[p]=f})(a,i,s),l.set(s,a)})(e,n,Ga),Gt(r)?n.setAttribute("data-lexical-text","true"):nn(r)&&n.setAttribute("data-lexical-decorator","true"),yt(r)){const s=r.__indent,a=r.__size;if(R_(n,r),s!==0&&K6(n,s),a!==0){const l=a-1;D_(e1(r,Yo),r,0,l,r.getDOMSlot(n))}const i=r.__format;i!==0&&q6(n,i),r.isInline()||X6(null,r,n),X1(r)&&(Gs+=jc,wc+=jc)}else{const s=r.getTextContent();if(nn(r)){const a=r.decorate(Ga,nf);a!==null&&Y6(e,a),n.contentEditable="false"}Gs+=s,wc+=s}return t!==null&&t.insertChild(n),Lb(sp,np,B1,r,"created"),n}function D_(e,t,r,n,s){const a=Gs;Gs="";let i=r;for(;i<=n;++i){Zy(e[i],s);const l=Yo.get(e[i]);l!==null&&Gt(l)&&(El===null&&(El=l.getFormat()),Nl===""&&(Nl=l.getStyle()))}X1(t)&&(Gs+=jc),s.element.__lexicalTextContent=Gs,Gs=a+Gs}function C4(e,t){if(e){const r=e.__last;if(r){const n=t.get(r);if(n)return kc(n)?"line-break":nn(n)&&n.isInline()?"decorator":null}return"empty"}return null}function X6(e,t,r){const n=C4(e,sf),s=C4(t,Yo);n!==s&&t.getDOMSlot(r).setManagedLineBreak(s)}function iB(e,t,r){var n;El=null,Nl="",(function(s,a,i){const l=Gs,c=s.__size,d=a.__size;Gs="";const f=i.element;if(c===1&&d===1){const p=s.__first,g=a.__first;if(p===g)km(p,f);else{const v=I_(p),_=Zy(g,null);try{f.replaceChild(_,v)}catch(b){if(typeof b=="object"&&b!=null){const N=`${b.toString()} Parent: ${f.tagName}, new child: {tag: ${_.tagName} key: ${g}}, old child: {tag: ${v.tagName}, key: ${p}}.`;throw new Error(N)}throw b}Qy(p,null)}const y=Yo.get(g);Gt(y)&&(El===null&&(El=y.getFormat()),Nl===""&&(Nl=y.getStyle()))}else{const p=e1(s,sf),g=e1(a,Yo);if(p.length!==c&&Pt(227),g.length!==d&&Pt(228),c===0)d!==0&&D_(g,a,0,d-1,i);else if(d===0){if(c!==0){const y=i.after==null&&i.before==null&&i.element.__lexicalLineBreak==null;P_(p,0,c-1,y?null:f),y&&(f.textContent="")}}else(function(y,v,_,b,N,k){const w=b-1,T=N-1;let A,F,R=k.getFirstChild(),E=0,D=0;for(;E<=w&&D<=T;){const Y=v[E],ee=_[D];if(Y===ee)R=bw(km(ee,k.element)),E++,D++;else{A===void 0&&(A=new Set(v)),F===void 0&&(F=new Set(_));const re=F.has(Y),se=A.has(ee);if(re)if(se){const B=af(Ga,ee);B===R?R=bw(km(ee,k.element)):(k.withBefore(R).insertChild(B),km(ee,k.element)),E++,D++}else Zy(ee,k.withBefore(R)),D++;else R=bw(I_(Y)),Qy(Y,k.element),E++}const ie=Yo.get(ee);ie!==null&&Gt(ie)&&(El===null&&(El=ie.getFormat()),Nl===""&&(Nl=ie.getStyle()))}const I=E>w,G=D>T;if(I&&!G){const Y=_[T+1],ee=Y===void 0?null:Ga.getElementByKey(Y);D_(_,y,D,T,k.withBefore(ee))}else G&&!I&&P_(v,E,w,k.element)})(a,p,g,c,d,i)}X1(a)&&(Gs+=jc),f.__lexicalTextContent=Gs,Gs=l+Gs})(e,t,t.getDOMSlot(r)),n=t,El==null||El===n.__textFormat||Jy||n.setTextFormat(El),(function(s){Nl===""||Nl===s.__textStyle||Jy||s.setTextStyle(Nl)})(t)}function e1(e,t){const r=[];let n=e.__first;for(;n!==null;){const s=t.get(n);s===void 0&&Pt(101),r.push(n),n=s.__next}return r}function km(e,t){const r=sf.get(e);let n=Yo.get(e);r!==void 0&&n!==void 0||Pt(61);const s=Rh||j_.has(e)||A_.has(e),a=af(Ga,e);if(r===n&&!s){if(yt(r)){const i=a.__lexicalTextContent;i!==void 0&&(Gs+=i,wc+=i)}else{const i=r.getTextContent();wc+=i,Gs+=i}return a}if(r!==n&&s&&Lb(sp,np,B1,n,"updated"),n.updateDOM(r,a,nf)){const i=Zy(e,null);return t===null&&Pt(62),t.replaceChild(i,a),Qy(e,null),i}if(yt(r)&&yt(n)){const i=n.__indent;(Rh||i!==r.__indent)&&K6(a,i);const l=n.__format;if((Rh||l!==r.__format)&&q6(a,l),s&&(iB(r,n,a),qs(n)||n.isInline()||X6(r,n,a)),X1(n)&&(Gs+=jc,wc+=jc),(Rh||n.__dir!==r.__dir)&&(R_(a,n),qs(n)&&!Rh))for(const c of n.getChildren())yt(c)&&R_(af(Ga,c.getKey()),c)}else{const i=n.getTextContent();if(nn(n)){const l=n.decorate(Ga,nf);l!==null&&Y6(e,l)}Gs+=i,wc+=i}if(!Jy&&qs(n)&&n.__cachedText!==wc){const i=n.getWritable();i.__cachedText=wc,n=i}return a}function Y6(e,t){let r=Ga._pendingDecorators;const n=Ga._decorators;if(r===null){if(n[e]===t)return;r=MA(Ga)}r[e]=t}function bw(e){let t=e.nextSibling;return t!==null&&t===Ga._blockCursorElement&&(t=t.nextSibling),t}function oB(e,t,r,n,s,a){Gs="",wc="",Rh=n===c0,Ga=r,nf=r._config,np=r._nodes,B1=Ga._listeners.mutation,A_=s,j_=a,sf=e._nodeMap,Yo=t._nodeMap,Jy=t._readOnly,F_=new Map(r._keyToDOMMap);const i=new Map;return sp=i,km("root",null),Ga=void 0,np=void 0,A_=void 0,j_=void 0,sf=void 0,Yo=void 0,nf=void 0,F_=void 0,sp=void 0,i}function I_(e){const t=F_.get(e);return t===void 0&&Pt(75,e),t}function _r(e){return{type:e}}const J6=_r("SELECTION_CHANGE_COMMAND"),lB=_r("SELECTION_INSERT_CLIPBOARD_NODES_COMMAND"),yb=_r("CLICK_COMMAND"),Gd=_r("DELETE_CHARACTER_COMMAND"),Xh=_r("INSERT_LINE_BREAK_COMMAND"),ap=_r("INSERT_PARAGRAPH_COMMAND"),Yh=_r("CONTROLLED_TEXT_INSERTION_COMMAND"),vb=_r("PASTE_COMMAND"),M_=_r("REMOVE_TEXT_COMMAND"),ip=_r("DELETE_WORD_COMMAND"),op=_r("DELETE_LINE_COMMAND"),Ha=_r("FORMAT_TEXT_COMMAND"),wb=_r("UNDO_COMMAND"),_b=_r("REDO_COMMAND"),cB=_r("KEYDOWN_COMMAND"),Q6=_r("KEY_ARROW_RIGHT_COMMAND"),uB=_r("MOVE_TO_END"),Z6=_r("KEY_ARROW_LEFT_COMMAND"),dB=_r("MOVE_TO_START"),eA=_r("KEY_ARROW_UP_COMMAND"),tA=_r("KEY_ARROW_DOWN_COMMAND"),t1=_r("KEY_ENTER_COMMAND"),rA=_r("KEY_SPACE_COMMAND"),nA=_r("KEY_BACKSPACE_COMMAND"),sA=_r("KEY_ESCAPE_COMMAND"),aA=_r("KEY_DELETE_COMMAND"),iA=_r("KEY_TAB_COMMAND"),fB=_r("INSERT_TAB_COMMAND"),hB=_r("INDENT_CONTENT_COMMAND"),T4=_r("OUTDENT_CONTENT_COMMAND"),oA=_r("DROP_COMMAND"),lA=_r("FORMAT_ELEMENT_COMMAND"),cA=_r("DRAGSTART_COMMAND"),uA=_r("DRAGOVER_COMMAND"),gB=_r("DRAGEND_COMMAND"),U1=_r("COPY_COMMAND"),bb=_r("CUT_COMMAND"),O_=_r("SELECT_ALL_COMMAND"),mB=_r("CLEAR_EDITOR_COMMAND"),pB=_r("CLEAR_HISTORY_COMMAND"),oy=_r("CAN_REDO_COMMAND"),ly=_r("CAN_UNDO_COMMAND"),xB=_r("FOCUS_COMMAND"),yB=_r("BLUR_COMMAND"),vB=_r("KEY_MODIFIER_COMMAND"),pc=Object.freeze({}),L_=30,B_=[["keydown",function(e,t){if(Dm=e.timeStamp,dA=e.key,!t.isComposing()&&!nr(t,cB,e)&&e.key!=null){if(Sw&&eE(e))return Wi(t,(()=>{cy(t,kw)})),Sw=!1,void(kw="");if((function(r){return gn(r,"ArrowRight",{shiftKey:"any"})})(e))nr(t,Q6,e);else if((function(r){return gn(r,"ArrowRight",yc)})(e))nr(t,uB,e);else if((function(r){return gn(r,"ArrowLeft",{shiftKey:"any"})})(e))nr(t,Z6,e);else if((function(r){return gn(r,"ArrowLeft",yc)})(e))nr(t,dB,e);else if((function(r){return gn(r,"ArrowUp",{altKey:"any",shiftKey:"any"})})(e))nr(t,eA,e);else if((function(r){return gn(r,"ArrowDown",{altKey:"any",shiftKey:"any"})})(e))nr(t,tA,e);else if((function(r){return gn(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any",shiftKey:!0})})(e))Im=!0,nr(t,t1,e);else if((function(r){return r.key===" "})(e))nr(t,rA,e);else if((function(r){return Al&&gn(r,"o",{ctrlKey:!0})})(e))e.preventDefault(),Im=!0,nr(t,Xh,!0);else if((function(r){return gn(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any"})})(e))Im=!1,nr(t,t1,e);else if((function(r){return gn(r,"Backspace",{shiftKey:"any"})||Al&&gn(r,"h",{ctrlKey:!0})})(e))eE(e)?nr(t,nA,e):(e.preventDefault(),nr(t,Gd,!0));else if((function(r){return r.key==="Escape"})(e))nr(t,sA,e);else if((function(r){return gn(r,"Delete",{})||Al&&gn(r,"d",{ctrlKey:!0})})(e))(function(r){return r.key==="Delete"})(e)?nr(t,aA,e):(e.preventDefault(),nr(t,Gd,!1));else if((function(r){return gn(r,"Backspace",Z4)})(e))e.preventDefault(),nr(t,ip,!0);else if((function(r){return gn(r,"Delete",Z4)})(e))e.preventDefault(),nr(t,ip,!1);else if((function(r){return Al&&gn(r,"Backspace",{metaKey:!0})})(e))e.preventDefault(),nr(t,op,!0);else if((function(r){return Al&&(gn(r,"Delete",{metaKey:!0})||gn(r,"k",{ctrlKey:!0}))})(e))e.preventDefault(),nr(t,op,!1);else if((function(r){return gn(r,"b",yc)})(e))e.preventDefault(),nr(t,Ha,"bold");else if((function(r){return gn(r,"u",yc)})(e))e.preventDefault(),nr(t,Ha,"underline");else if((function(r){return gn(r,"i",yc)})(e))e.preventDefault(),nr(t,Ha,"italic");else if((function(r){return gn(r,"Tab",{shiftKey:"any"})})(e))nr(t,iA,e);else if((function(r){return gn(r,"z",yc)})(e))e.preventDefault(),nr(t,wb,void 0);else if((function(r){return Al?gn(r,"z",{metaKey:!0,shiftKey:!0}):gn(r,"y",{ctrlKey:!0})||gn(r,"z",{ctrlKey:!0,shiftKey:!0})})(e))e.preventDefault(),nr(t,_b,void 0);else{const r=t._editorState._selection;r===null||Tt(r)?tE(e)&&(e.preventDefault(),nr(t,O_,e)):(function(n){return gn(n,"c",yc)})(e)?(e.preventDefault(),nr(t,U1,e)):(function(n){return gn(n,"x",yc)})(e)?(e.preventDefault(),nr(t,bb,e)):tE(e)&&(e.preventDefault(),nr(t,O_,e))}(function(r){return r.ctrlKey||r.shiftKey||r.altKey||r.metaKey})(e)&&nr(t,vB,e)}}],["pointerdown",function(e,t){const r=e.target,n=e.pointerType;T0(r)&&n!=="touch"&&n!=="pen"&&e.button===0&&Wi(t,(()=>{Y4(r)||($_=!0)}))}],["compositionstart",function(e,t){Wi(t,(()=>{const r=Ht();if(Tt(r)&&!t.isComposing()){const n=r.anchor,s=r.anchor.getNode();Ta(n.key),(e.timeStamp<Dm+L_||n.type==="element"||!r.isCollapsed()||s.getFormat()!==r.format||Gt(s)&&s.getStyle()!==r.style)&&nr(t,Yh,VL)}}))}],["compositionend",function(e,t){ef?pm=!0:l0||!rp&&!Ky?Wi(t,(()=>{cy(t,e.data)})):(Sw=!0,kw=e.data)}],["input",function(e,t){e.stopPropagation(),Wi(t,(()=>{if($n(e.target)&&Y4(e.target))return;const r=Ht(),n=e.data,s=pA(e);if(n!=null&&Tt(r)&&gA(r,s,n,e.timeStamp,!1)){pm&&(cy(t,n),pm=!1);const a=r.anchor.getNode(),i=el(So(t));if(i===null)return;const l=r.isBackward(),c=l?r.anchor.offset:r.focus.offset,d=l?r.focus.offset:r.anchor.offset;Vy&&!r.isCollapsed()&&Gt(a)&&i.anchorNode!==null&&a.getTextContent().slice(0,c)+n+a.getTextContent().slice(c+d)===UA(i.anchorNode)||nr(t,Yh,n);const f=n.length;ef&&f>1&&e.inputType==="insertCompositionText"&&!t.isComposing()&&(r.anchor.offset-=f),rp||l0||Ky||!t.isComposing()||(Dm=0,Ta(null))}else Mb(!1,t,n!==null?n:void 0),pm&&(cy(t,n||void 0),pm=!1);(function(){Ca();const a=rs();z6(a)})()}),{event:e}),Dh=null}],["click",function(e,t){Wi(t,(()=>{const r=Ht(),n=el(So(t)),s=C0();if(n){if(Tt(r)){const a=r.anchor,i=a.getNode();if(a.type==="element"&&a.offset===0&&r.isCollapsed()&&!qs(i)&&qn().getChildrenSize()===1&&i.getTopLevelElementOrThrow().isEmpty()&&s!==null&&r.is(s))n.removeAllRanges(),r.dirty=!0;else if(e.detail===3&&!r.isCollapsed()&&i!==r.focus.getNode()){const l=(function(c,d){let f=c;for(;f!==qn()&&f!=null;){if(d(f))return f;f=f.getParent()}return null})(i,(c=>yt(c)&&!c.isInline()));yt(l)&&l.select(0)}}else if(e.pointerType==="touch"||e.pointerType==="pen"){const a=n.anchorNode;($n(a)||Rc(a))&&Aa(Cb(s,n,t,e))}}nr(t,yb,e)}))}],["cut",pc],["copy",pc],["dragstart",pc],["dragover",pc],["dragend",pc],["paste",pc],["focus",pc],["blur",pc],["drop",pc]];Vy&&B_.push(["beforeinput",(e,t)=>(function(r,n){const s=r.inputType,a=pA(r);s==="deleteCompositionText"||ef&&$A(n)||s!=="insertCompositionText"&&Wi(n,(()=>{const i=Ht();if(s==="deleteContentBackward"){if(i===null){const y=C0();if(!Tt(y))return;Aa(y.clone())}if(Tt(i)){const y=i.anchor.key===i.focus.key;if(l=r.timeStamp,dA==="MediaLast"&&l<Dm+L_&&n.isComposing()&&y){if(Ta(null),Dm=0,setTimeout((()=>{Wi(n,(()=>{Ta(null)}))}),L_),Tt(i)){const v=i.anchor.getNode();v.markDirty(),Gt(v)||Pt(142),mA(i,v)}}else{Ta(null),r.preventDefault();const v=i.anchor.getNode(),_=v.getTextContent(),b=v.canInsertTextAfter(),N=i.anchor.offset===0&&i.focus.offset===_.length;let k=g4&&y&&!N&&b;if(k&&i.isCollapsed()&&(k=!nn(V_(i.anchor,!0))),!k){nr(n,Gd,!0);const w=Ht();g4&&Tt(w)&&w.isCollapsed()&&(Md=w,setTimeout((()=>Md=null)))}}return}}var l;if(!Tt(i))return;const c=r.data;Dh!==null&&Mb(!1,n,Dh),i.dirty&&Dh===null||!i.isCollapsed()||qs(i.anchor.getNode())||a===null||i.applyDOMRange(a),Dh=null;const d=i.anchor,f=i.focus,p=d.getNode(),g=f.getNode();if(s!=="insertText"&&s!=="insertTranspose")switch(r.preventDefault(),s){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":nr(n,Yh,r);break;case"insertFromComposition":Ta(null),nr(n,Yh,r);break;case"insertLineBreak":Ta(null),nr(n,Xh,!1);break;case"insertParagraph":Ta(null),Im&&!l0?(Im=!1,nr(n,Xh,!1)):nr(n,ap,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":nr(n,vb,r);break;case"deleteByComposition":(function(y,v){return y!==v||yt(y)||yt(v)||!Vd(y)||!Vd(v)})(p,g)&&nr(n,M_,r);break;case"deleteByDrag":case"deleteByCut":nr(n,M_,r);break;case"deleteContent":nr(n,Gd,!1);break;case"deleteWordBackward":nr(n,ip,!0);break;case"deleteWordForward":nr(n,ip,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":nr(n,op,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":nr(n,op,!1);break;case"formatStrikeThrough":nr(n,Ha,"strikethrough");break;case"formatBold":nr(n,Ha,"bold");break;case"formatItalic":nr(n,Ha,"italic");break;case"formatUnderline":nr(n,Ha,"underline");break;case"historyUndo":nr(n,wb,void 0);break;case"historyRedo":nr(n,_b,void 0)}else{if(c===`
`)r.preventDefault(),nr(n,Xh,!1);else if(c===jc)r.preventDefault(),nr(n,ap,void 0);else if(c==null&&r.dataTransfer){const y=r.dataTransfer.getData("text/plain");r.preventDefault(),i.insertRawText(y)}else c!=null&&gA(i,a,c,r.timeStamp,!0)?(r.preventDefault(),nr(n,Yh,c)):Dh=c;fA=r.timeStamp}}))})(e,t)]);let Dm=0,dA=null,fA=0,Dh=null;const r1=new WeakMap;let U_=!1,$_=!1,Im=!1,pm=!1,Sw=!1,kw="",Md=null,hA=[0,"",0,"root",0];function gA(e,t,r,n,s){const a=e.anchor,i=e.focus,l=a.getNode(),c=rs(),d=el(So(c)),f=d!==null?d.anchorNode:null,p=a.key,g=c.getElementByKey(p),y=r.length;return p!==i.key||!Gt(l)||(!s&&(!Vy||fA<n+50)||l.isDirty()&&y<2||LA(r))&&a.offset!==i.offset&&!l.isComposing()||vc(l)||l.isDirty()&&y>1||(s||!Vy)&&g!==null&&!l.isComposing()&&f!==u0(g)||d!==null&&t!==null&&(!t.collapsed||t.startContainer!==d.anchorNode||t.startOffset!==d.anchorOffset)||l.getFormat()!==e.format||l.getStyle()!==e.style||(function(v,_){if(_.isSegmented())return!0;if(!v.isCollapsed())return!1;const b=v.anchor.offset,N=_.getParentOrThrow(),k=Vd(_);return b===0?!_.canInsertTextBefore()||!N.canInsertTextBefore()&&!_.isComposing()||k||(function(w){const T=w.getPreviousSibling();return(Gt(T)||yt(T)&&T.isInline())&&!T.canInsertTextAfter()})(_):b===_.getTextContentSize()&&(!_.canInsertTextAfter()||!N.canInsertTextAfter()&&!_.isComposing()||k)})(e,l)}function E4(e,t){return Rc(e)&&e.nodeValue!==null&&t!==0&&t!==e.nodeValue.length}function N4(e,t,r){const{anchorNode:n,anchorOffset:s,focusNode:a,focusOffset:i}=e;U_&&(U_=!1,E4(n,s)&&E4(a,i)&&!Md)||Wi(t,(()=>{if(!r)return void Aa(null);if(!Op(t,n,a))return;let l=Ht();if(Md&&Tt(l)&&l.isCollapsed()){const c=l.anchor,d=Md.anchor;(c.key===d.key&&c.offset===d.offset+1||c.offset===1&&d.getNode().is(c.getNode().getPreviousSibling()))&&(l=Md.clone(),Aa(l))}if(Md=null,Tt(l)){const c=l.anchor,d=c.getNode();if(l.isCollapsed()){e.type==="Range"&&e.anchorNode===e.focusNode&&(l.dirty=!0);const f=So(t).event,p=f?f.timeStamp:performance.now(),[g,y,v,_,b]=hA,N=qn(),k=t.isComposing()===!1&&N.getTextContent()==="";if(p<b+200&&c.offset===v&&c.key===_)Dy(l,g,y);else if(c.type==="text")Gt(d)||Pt(141),mA(l,d);else if(c.type==="element"&&!k){yt(d)||Pt(259);const w=c.getNode();w.isEmpty()?(function(T,A){const F=A.getTextFormat(),R=A.getTextStyle();Dy(T,F,R)})(l,w):Dy(l,0,"")}}else{const f=c.key,p=l.focus.key,g=l.getNodes(),y=g.length,v=l.isBackward(),_=v?i:s,b=v?s:i,N=v?p:f,k=v?f:p;let w=GL,T=!1;for(let A=0;A<y;A++){const F=g[A],R=F.getTextContentSize();if(Gt(F)&&R!==0&&!(A===0&&F.__key===N&&_===R||A===y-1&&F.__key===k&&b===0)&&(T=!0,w&=F.getFormat(),w===0))break}l.format=T?w:0}}nr(t,J6,void 0)}))}function Dy(e,t,r){e.format===t&&e.style===r||(e.format=t,e.style=r,e.dirty=!0)}function mA(e,t){Dy(e,t.getFormat(),t.getStyle())}function pA(e){if(!e.getTargetRanges)return null;const t=e.getTargetRanges();return t.length===0?null:t[0]}function cy(e,t){const r=e._compositionKey;if(Ta(null),r!==null&&t!=null){if(t===""){const n=Os(r),s=u0(e.getElementByKey(r));return void(s!==null&&s.nodeValue!==null&&Gt(n)&&Ob(n,s.nodeValue,null,null,!0))}if(t[t.length-1]===`
`){const n=Ht();if(Tt(n)){const s=n.focus;return n.anchor.set(s.key,s.offset,s.type),void nr(e,t1,null)}}}Mb(!0,e,t)}function xA(e){let t=e.__lexicalEventHandles;return t===void 0&&(t=[],e.__lexicalEventHandles=t),t}const Jh=new Map;function yA(e){const t=QB(e.target);if(t===null)return;const r=RA(t.anchorNode);if(r===null)return;$_&&($_=!1,Wi(r,(()=>{const c=C0(),d=t.anchorNode;($n(d)||Rc(d))&&Aa(Cb(c,t,r,e))})));const n=Ib(r),s=n[n.length-1],a=s._key,i=Jh.get(a),l=i||s;l!==r&&N4(t,l,!1),N4(t,r,!0),r!==s?Jh.set(a,r):i&&Jh.delete(a)}function A4(e){e._lexicalHandled=!0}function j4(e){return e._lexicalHandled===!0}function wB(e){const t=e.ownerDocument,r=r1.get(t);if(r===void 0)return;const n=r-1;n>=0||Pt(164),r1.set(t,n),n===0&&t.removeEventListener("selectionchange",yA);const s=K1(e);Db(s)?((function(i){if(i._parentEditor!==null){const l=Ib(i),c=l[l.length-1]._key;Jh.get(c)===i&&Jh.delete(c)}else Jh.delete(i._key)})(s),e.__lexicalEditor=null):s&&Pt(198);const a=xA(e);for(let i=0;i<a.length;i++)a[i]();e.__lexicalEventHandles=[]}function W_(e,t,r){Ca();const n=e.__key,s=e.getParent();if(s===null)return;const a=(function(l){const c=Ht();if(!Tt(c)||!yt(l))return c;const{anchor:d,focus:f}=c,p=d.getNode(),g=f.getNode();return K_(p,l)&&d.set(l.__key,0,"element"),K_(g,l)&&f.set(l.__key,0,"element"),c})(e);let i=!1;if(Tt(a)&&t){const l=a.anchor,c=a.focus;l.key===n&&(s1(l,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0),c.key===n&&(s1(c,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0)}else La(a)&&t&&e.isSelected()&&e.selectPrevious();if(Tt(a)&&t&&!i){const l=e.getIndexWithinParent();Kd(e),n1(a,s,l,-1)}else Kd(e);r||fi(s)||s.canBeEmpty()||!s.isEmpty()||W_(s,t),t&&a&&qs(s)&&s.isEmpty()&&s.selectEnd()}class S0{static getType(){const{ownNodeType:t}=Wb(this);return t===void 0&&Pt(64,this.name),t}static clone(t){Pt(65,this.name)}$config(){return{}}config(t,r){const n=r.extends||Object.getPrototypeOf(this.constructor);return Object.assign(r,{extends:n,type:t}),{[t]:r}}afterCloneFrom(t){this.__key===t.__key?(this.__parent=t.__parent,this.__next=t.__next,this.__prev=t.__prev,this.__state=t.__state):t.__state&&(this.__state=t.__state.getWritable(this))}constructor(t){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,Object.defineProperty(this,"__state",{configurable:!0,enumerable:!1,value:void 0,writable:!0}),HB(this,t)}getType(){return this.__type}isInline(){Pt(137,this.constructor.name)}isAttached(){let t=this.__key;for(;t!==null;){if(t==="root")return!0;const r=Os(t);if(r===null)break;t=r.__parent}return!1}isSelected(t){const r=t||Ht();if(r==null)return!1;const n=r.getNodes().some((s=>s.__key===this.__key));if(Gt(this))return n;if(Tt(r)&&r.anchor.type==="element"&&r.focus.type==="element"){if(r.isCollapsed())return!1;const s=this.getParent();if(nn(this)&&this.isInline()&&s){const a=r.isBackward()?r.focus:r.anchor;if(s.is(a.getNode())&&a.offset===s.getChildrenSize()&&this.is(s.getLastChild()))return!1}}return n}getKey(){return this.__key}getIndexWithinParent(){const t=this.getParent();if(t===null)return-1;let r=t.getFirstChild(),n=0;for(;r!==null;){if(this.is(r))return n;n++,r=r.getNextSibling()}return-1}getParent(){const t=this.getLatest().__parent;return t===null?null:Os(t)}getParentOrThrow(){const t=this.getParent();return t===null&&Pt(66,this.__key),t}getTopLevelElement(){let t=this;for(;t!==null;){const r=t.getParent();if(fi(r))return yt(t)||t===this&&nn(t)||Pt(194),t;t=r}return null}getTopLevelElementOrThrow(){const t=this.getTopLevelElement();return t===null&&Pt(67,this.__key),t}getParents(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r),r=r.getParent();return t}getParentKeys(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r.__key),r=r.getParent();return t}getPreviousSibling(){const t=this.getLatest().__prev;return t===null?null:Os(t)}getPreviousSiblings(){const t=[],r=this.getParent();if(r===null)return t;let n=r.getFirstChild();for(;n!==null&&!n.is(this);)t.push(n),n=n.getNextSibling();return t}getNextSibling(){const t=this.getLatest().__next;return t===null?null:Os(t)}getNextSiblings(){const t=[];let r=this.getNextSibling();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getCommonAncestor(t){const r=yt(this)?this:this.getParent(),n=yt(t)?t:t.getParent(),s=r&&n?My(r,n):null;return s?s.commonAncestor:null}is(t){return t!=null&&this.__key===t.__key}isBefore(t){const r=My(this,t);return r!==null&&(r.type==="descendant"||(r.type==="branch"?GA(r)===-1:(r.type!=="same"&&r.type!=="ancestor"&&Pt(279),!1)))}isParentOf(t){const r=My(this,t);return r!==null&&r.type==="ancestor"}getNodesBetween(t){const r=this.isBefore(t),n=[],s=new Set;let a=this;for(;a!==null;){const i=a.__key;if(s.has(i)||(s.add(i),n.push(a)),a===t)break;const l=yt(a)?r?a.getFirstChild():a.getLastChild():null;if(l!==null){a=l;continue}const c=r?a.getNextSibling():a.getPreviousSibling();if(c!==null){a=c;continue}const d=a.getParentOrThrow();if(s.has(d.__key)||n.push(d),d===t)break;let f=null,p=d;do{if(p===null&&Pt(68),f=r?p.getNextSibling():p.getPreviousSibling(),p=p.getParent(),p===null)break;f!==null||s.has(p.__key)||n.push(p)}while(f===null);a=f}return r||n.reverse(),n}isDirty(){const t=rs()._dirtyLeaves;return t!==null&&t.has(this.__key)}getLatest(){const t=Os(this.__key);return t===null&&Pt(113),t}getWritable(){Ca();const t=Yu(),r=rs(),n=t._nodeMap,s=this.__key,a=this.getLatest(),i=r._cloneNotNeeded,l=Ht();if(l!==null&&l.setCachedNodes(null),i.has(s))return o1(a),a;const c=Ub(a);return i.add(s),o1(c),n.set(s,c),c}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(t,r){Pt(70)}updateDOM(t,r,n){Pt(71)}exportDOM(t){return{element:this.createDOM(t._config,t)}}exportJSON(){const t=this.__state?this.__state.toJSON():void 0;return{type:this.__type,version:1,...t}}static importJSON(t){Pt(18,this.name)}updateFromJSON(t){return(function(r,n){const s=r.getWritable(),a=n.$;let i=a;for(const l of V6(s).flatKeys)l in n&&(i!==void 0&&i!==a||(i={...a}),i[l]=n[l]);return(s.__state||i)&&sB(r).updateFromJSON(i),s})(this,t)}static transform(){return null}remove(t){W_(this,!0,t)}replace(t,r){Ca();let n=Ht();n!==null&&(n=n.clone()),jw(this,t);const s=this.getLatest(),a=this.__key,i=t.__key,l=t.getWritable(),c=this.getParentOrThrow().getWritable(),d=c.__size;Kd(l);const f=s.getPreviousSibling(),p=s.getNextSibling(),g=s.__prev,y=s.__next,v=s.__parent;if(W_(s,!1,!0),f===null?c.__first=i:f.getWritable().__next=i,l.__prev=g,p===null?c.__last=i:p.getWritable().__prev=i,l.__next=y,l.__parent=v,c.__size=d,r&&(yt(this)&&yt(l)||Pt(139),this.getChildren().forEach((_=>{l.append(_)}))),Tt(n)){Aa(n);const _=n.anchor,b=n.focus;_.key===a&&D4(_,l),b.key===a&&D4(b,l)}return Nu()===a&&Ta(i),l}insertAfter(t,r=!0){Ca(),jw(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.getParent(),i=Ht();let l=!1,c=!1;if(a!==null){const y=t.getIndexWithinParent();if(Kd(s),Tt(i)){const v=a.__key,_=i.anchor,b=i.focus;l=_.type==="element"&&_.key===v&&_.offset===y+1,c=b.type==="element"&&b.key===v&&b.offset===y+1}}const d=this.getNextSibling(),f=this.getParentOrThrow().getWritable(),p=s.__key,g=n.__next;if(d===null?f.__last=p:d.getWritable().__prev=p,f.__size++,n.__next=p,s.__next=g,s.__prev=n.__key,s.__parent=n.__parent,r&&Tt(i)){const y=this.getIndexWithinParent();n1(i,f,y+1);const v=f.__key;l&&i.anchor.set(v,y+2,"element"),c&&i.focus.set(v,y+2,"element")}return t}insertBefore(t,r=!0){Ca(),jw(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.__key;Kd(s);const i=this.getPreviousSibling(),l=this.getParentOrThrow().getWritable(),c=n.__prev,d=this.getIndexWithinParent();i===null?l.__first=a:i.getWritable().__next=a,l.__size++,n.__prev=a,s.__prev=c,s.__next=n.__key,s.__parent=n.__parent;const f=Ht();return r&&Tt(f)&&n1(f,this.getParentOrThrow(),d),t}isParentRequired(){return!1}createParentElementNode(){return Un()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(t,r){Ca();const n=this.getPreviousSibling(),s=this.getParentOrThrow();if(n===null)return s.select(0,0);if(yt(n))return n.select();if(!Gt(n)){const a=n.getIndexWithinParent()+1;return s.select(a,a)}return n.select(t,r)}selectNext(t,r){Ca();const n=this.getNextSibling(),s=this.getParentOrThrow();if(n===null)return s.select();if(yt(n))return n.select(0,0);if(!Gt(n)){const a=n.getIndexWithinParent();return s.select(a,a)}return n.select(t,r)}markDirty(){this.getWritable()}reconcileObservedMutation(t,r){this.markDirty()}}class Pp extends S0{static getType(){return"linebreak"}static clone(t){return new Pp(t.__key)}constructor(t){super(t)}getTextContent(){return`
`}createDOM(){return document.createElement("br")}updateDOM(){return!1}isInline(){return!0}static importDOM(){return{br:t=>(function(r){const n=r.parentElement;if(n!==null&&l1(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&uy(s)){const a=n.lastChild;if(a===r||a.previousSibling===r&&uy(a))return!0}}return!1})(t)||(function(r){const n=r.parentElement;if(n!==null&&l1(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&uy(s))return!1;const a=n.lastChild;if(a===r||a.previousSibling===r&&uy(a))return!0}return!1})(t)?null:{conversion:_B,priority:0}}}static importJSON(t){return Ol().updateFromJSON(t)}}function _B(e){return{node:Ol()}}function Ol(){return gi(new Pp)}function kc(e){return e instanceof Pp}function uy(e){return Rc(e)&&/^( |\t|\r?\n)+$/.test(e.textContent||"")}function Cw(e,t){return 16&t?"code":t&ub?"mark":32&t?"sub":64&t?"sup":null}function Tw(e,t){return 1&t?"strong":2&t?"em":"span"}function vA(e,t,r,n,s){const a=n.classList;let i=Qh(s,"base");i!==void 0&&a.add(...i),i=Qh(s,"underlineStrikethrough");let l=!1;const c=t&Xy&&t&qy;i!==void 0&&(r&Xy&&r&qy?(l=!0,c||a.add(...i)):c&&a.remove(...i));for(const d in rf){const f=rf[d];if(i=Qh(s,d),i!==void 0)if(r&f){if(l&&(d==="underline"||d==="strikethrough")){t&f&&a.remove(...i);continue}t&f&&(!c||d!=="underline")&&d!=="strikethrough"||a.add(...i)}else t&f&&a.remove(...i)}}function wA(e,t,r){const n=t.firstChild,s=r.isComposing(),a=e+(s?L1:"");if(n==null)t.textContent=a;else{const i=n.nodeValue;if(i!==a)if(s||ef){const[l,c,d]=(function(f,p){const g=f.length,y=p.length;let v=0,_=0;for(;v<g&&v<y&&f[v]===p[v];)v++;for(;_+v<g&&_+v<y&&f[g-_-1]===p[y-_-1];)_++;return[v,g-v-_,p.slice(v,y-_)]})(i,a);c!==0&&n.deleteData(l,c),n.insertData(l,d)}else n.nodeValue=a}}function F4(e,t,r,n,s,a){wA(s,e,t);const i=a.theme.text;i!==void 0&&vA(0,0,n,e,i)}function dy(e,t){const r=document.createElement(t);return r.appendChild(e),r}class Xu extends S0{static getType(){return"text"}static clone(t){return new Xu(t.__text,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__text=t.__text,this.__format=t.__format,this.__style=t.__style,this.__mode=t.__mode,this.__detail=t.__detail}constructor(t="",r){super(r),this.__text=t,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const t=this.getLatest();return YL[t.__mode]}getStyle(){return this.getLatest().__style}isToken(){return this.getLatest().__mode===1}isComposing(){return this.__key===Nu()}isSegmented(){return this.getLatest().__mode===2}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(t){const r=rf[t];return!!(this.getFormat()&r)}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(){return this.getLatest().__text}getFormatFlags(t,r){return i1(this.getLatest().__format,t,r)}canHaveFormat(){return!0}isInline(){return!0}createDOM(t,r){const n=this.__format,s=Cw(0,n),a=Tw(0,n),i=s===null?a:s,l=document.createElement(i);let c=l;this.hasFormat("code")&&l.setAttribute("spellcheck","false"),s!==null&&(c=document.createElement(a),l.appendChild(c)),F4(c,this,0,n,this.__text,t);const d=this.__style;return d!==""&&(l.style.cssText=d),l}updateDOM(t,r,n){const s=this.__text,a=t.__format,i=this.__format,l=Cw(0,a),c=Cw(0,i),d=Tw(0,a),f=Tw(0,i);if((l===null?d:l)!==(c===null?f:c))return!0;if(l===c&&d!==f){const _=r.firstChild;_==null&&Pt(48);const b=document.createElement(f);return F4(b,this,0,i,s,n),r.replaceChild(b,_),!1}let p=r;c!==null&&l!==null&&(p=r.firstChild,p==null&&Pt(49)),wA(s,p,this);const g=n.theme.text;g!==void 0&&a!==i&&vA(0,a,i,p,g);const y=t.__style,v=this.__style;return y!==v&&(r.style.cssText=v),!1}static importDOM(){return{"#text":()=>({conversion:CB,priority:0}),b:()=>({conversion:SB,priority:0}),code:()=>({conversion:xc,priority:0}),em:()=>({conversion:xc,priority:0}),i:()=>({conversion:xc,priority:0}),mark:()=>({conversion:xc,priority:0}),s:()=>({conversion:xc,priority:0}),span:()=>({conversion:bB,priority:0}),strong:()=>({conversion:xc,priority:0}),sub:()=>({conversion:xc,priority:0}),sup:()=>({conversion:xc,priority:0}),u:()=>({conversion:xc,priority:0})}}static importJSON(t){return cs().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTextContent(t.text).setFormat(t.format).setDetail(t.detail).setMode(t.mode).setStyle(t.style)}exportDOM(t){let{element:r}=super.exportDOM(t);return $n(r)||Pt(132),r.style.whiteSpace="pre-wrap",this.hasFormat("lowercase")?r.style.textTransform="lowercase":this.hasFormat("uppercase")?r.style.textTransform="uppercase":this.hasFormat("capitalize")&&(r.style.textTransform="capitalize"),this.hasFormat("bold")&&(r=dy(r,"b")),this.hasFormat("italic")&&(r=dy(r,"i")),this.hasFormat("strikethrough")&&(r=dy(r,"s")),this.hasFormat("underline")&&(r=dy(r,"u")),{element:r}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),...super.exportJSON()}}selectionTransform(t,r){}setFormat(t){const r=this.getWritable();return r.__format=typeof t=="string"?rf[t]:t,r}setDetail(t){const r=this.getWritable();return r.__detail=typeof t=="string"?KL[t]:t,r}setStyle(t){const r=this.getWritable();return r.__style=t,r}toggleFormat(t){const r=i1(this.getFormat(),t,null);return this.setFormat(r)}toggleDirectionless(){const t=this.getWritable();return t.__detail^=1,t}toggleUnmergeable(){const t=this.getWritable();return t.__detail^=2,t}setMode(t){const r=XL[t];if(this.__mode===r)return this;const n=this.getWritable();return n.__mode=r,n}setTextContent(t){if(this.__text===t)return this;const r=this.getWritable();return r.__text=t,r}select(t,r){Ca();let n=t,s=r;const a=Ht(),i=this.getTextContent(),l=this.__key;if(typeof i=="string"){const c=i.length;n===void 0&&(n=c),s===void 0&&(s=c)}else n=0,s=0;if(!Tt(a))return SA(l,n,l,s,"text","text");{const c=Nu();c!==a.anchor.key&&c!==a.focus.key||Ta(l),a.setTextNodeRange(this,n,this,s)}return a}selectStart(){return this.select(0,0)}selectEnd(){const t=this.getTextContentSize();return this.select(t,t)}spliceText(t,r,n,s){const a=this.getWritable(),i=a.__text,l=n.length;let c=t;c<0&&(c=l+c,c<0&&(c=0));const d=Ht();if(s&&Tt(d)){const p=t+l;d.setTextNodeRange(a,p,a,p)}const f=i.slice(0,c)+n+i.slice(c+r);return a.__text=f,a}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...t){Ca();const r=this.getLatest(),n=r.getTextContent();if(n==="")return[];const s=r.__key,a=Nu(),i=n.length;t.sort(((E,D)=>E-D)),t.push(i);const l=[],c=t.length;for(let E=0,D=0;E<i&&D<=c;D++){const I=t[D];I>E&&(l.push(n.slice(E,I)),E=I)}const d=l.length;if(d===1)return[r];const f=l[0],p=r.getParent();let g;const y=r.getFormat(),v=r.getStyle(),_=r.__detail;let b=!1,N=null,k=null;const w=Ht();if(Tt(w)){const[E,D]=w.isBackward()?[w.focus,w.anchor]:[w.anchor,w.focus];E.type==="text"&&E.key===s&&(N=E),D.type==="text"&&D.key===s&&(k=D)}r.isSegmented()?(g=cs(f),g.__format=y,g.__style=v,g.__detail=_,g.__state=w4(r,g),b=!0):g=r.setTextContent(f);const T=[g];for(let E=1;E<d;E++){const D=cs(l[E]);D.__format=y,D.__style=v,D.__detail=_,D.__state=w4(r,D);const I=D.__key;a===s&&Ta(I),T.push(D)}const A=N?N.offset:null,F=k?k.offset:null;let R=0;for(const E of T){if(!N&&!k)break;const D=R+E.getTextContentSize();if(N!==null&&A!==null&&A<=D&&A>=R&&(N.set(E.getKey(),A-R,"text"),A<D&&(N=null)),k!==null&&F!==null&&F<=D&&F>=R){k.set(E.getKey(),F-R,"text");break}R=D}if(p!==null){(function(I){const G=I.getPreviousSibling(),Y=I.getNextSibling();G!==null&&o1(G),Y!==null&&o1(Y)})(this);const E=p.getWritable(),D=this.getIndexWithinParent();b?(E.splice(D,0,T),this.remove()):E.splice(D,1,T),Tt(w)&&n1(w,p,D,d-1)}return T}mergeWithSibling(t){const r=t===this.getPreviousSibling();r||t===this.getNextSibling()||Pt(50);const n=this.__key,s=t.__key,a=this.__text,i=a.length;Nu()===s&&Ta(n);const l=Ht();if(Tt(l)){const p=l.anchor,g=l.focus;p!==null&&p.key===s&&$4(p,r,n,t,i),g!==null&&g.key===s&&$4(g,r,n,t,i)}const c=t.__text,d=r?c+a:a+c;this.setTextContent(d);const f=this.getWritable();return t.remove(),f}isTextEntity(){return!1}}function bB(e){return{forChild:Sb(e.style),node:null}}function SB(e){const t=e,r=t.style.fontWeight==="normal";return{forChild:Sb(t.style,r?void 0:"bold"),node:null}}const P4=new WeakMap;function kB(e){if(!$n(e))return!1;if(e.nodeName==="PRE")return!0;const t=e.style.whiteSpace;return typeof t=="string"&&t.startsWith("pre")}function CB(e){const t=e;e.parentElement===null&&Pt(129);let r=t.textContent||"";if((function(n){let s,a=n.parentNode;const i=[n];for(;a!==null&&(s=P4.get(a))===void 0&&!kB(a);)i.push(a),a=a.parentNode;const l=s===void 0?a:s;for(let c=0;c<i.length;c++)P4.set(i[c],l);return l})(t)!==null){const n=r.split(/(\r?\n|\t)/),s=[],a=n.length;for(let i=0;i<a;i++){const l=n[i];l===`
`||l===`\r
`?s.push(Ol()):l==="	"?s.push(k0()):l!==""&&s.push(cs(l))}return{node:s}}if(r=r.replace(/\r/g,"").replace(/[ \t\n]+/g," "),r==="")return{node:null};if(r[0]===" "){let n=t,s=!0;for(;n!==null&&(n=R4(n,!1))!==null;){const a=n.textContent||"";if(a.length>0){/[ \t\n]$/.test(a)&&(r=r.slice(1)),s=!1;break}}s&&(r=r.slice(1))}if(r[r.length-1]===" "){let n=t,s=!0;for(;n!==null&&(n=R4(n,!0))!==null;)if((n.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){s=!1;break}s&&(r=r.slice(0,r.length-1))}return r===""?{node:null}:{node:cs(r)}}function R4(e,t){let r=e;for(;;){let n;for(;(n=t?r.nextSibling:r.previousSibling)===null;){const a=r.parentElement;if(a===null)return null;r=a}if(r=n,$n(r)){const a=r.style.display;if(a===""&&!Y_(r)||a!==""&&!a.startsWith("inline"))return null}let s=r;for(;(s=t?r.firstChild:r.lastChild)!==null;)r=s;if(Rc(r))return r;if(r.nodeName==="BR")return null}}const TB={code:"code",em:"italic",i:"italic",mark:"highlight",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function xc(e){const t=TB[e.nodeName.toLowerCase()];return t===void 0?{node:null}:{forChild:Sb(e.style,t),node:null}}function cs(e=""){return gi(new Xu(e))}function Gt(e){return e instanceof Xu}function Sb(e,t){const r=e.fontWeight,n=e.textDecoration.split(" "),s=r==="700"||r==="bold",a=n.includes("line-through"),i=e.fontStyle==="italic",l=n.includes("underline"),c=e.verticalAlign;return d=>(Gt(d)&&(s&&!d.hasFormat("bold")&&d.toggleFormat("bold"),a&&!d.hasFormat("strikethrough")&&d.toggleFormat("strikethrough"),i&&!d.hasFormat("italic")&&d.toggleFormat("italic"),l&&!d.hasFormat("underline")&&d.toggleFormat("underline"),c!=="sub"||d.hasFormat("subscript")||d.toggleFormat("subscript"),c!=="super"||d.hasFormat("superscript")||d.toggleFormat("superscript"),t&&!d.hasFormat(t)&&d.toggleFormat(t)),d)}class Rp extends Xu{static getType(){return"tab"}static clone(t){return new Rp(t.__key)}constructor(t){super("	",t),this.__detail=2}static importDOM(){return null}createDOM(t){const r=super.createDOM(t),n=Qh(t.theme,"tab");return n!==void 0&&r.classList.add(...n),r}static importJSON(t){return k0().updateFromJSON(t)}setTextContent(t){return t!=="	"&&t!==""&&Pt(126),super.setTextContent("	")}spliceText(t,r,n,s){return n===""&&r===0||n==="	"&&r===1||Pt(286),this}setDetail(t){return t!==2&&Pt(127),this}setMode(t){return t!=="normal"&&Pt(128),this}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function k0(){return gi(new Rp)}function $1(e){return e instanceof Rp}class EB{constructor(t,r,n){this._selection=null,this.key=t,this.offset=r,this.type=n}is(t){return this.key===t.key&&this.offset===t.offset&&this.type===t.type}isBefore(t){return this.key===t.key?this.offset<t.offset:HA(wo(Fc(this,"next")),wo(Fc(t,"next")))<0}getNode(){const t=Os(this.key);return t===null&&Pt(20),t}set(t,r,n,s){const a=this._selection,i=this.key;s&&this.key===t&&this.offset===r&&this.type===n||(this.key=t,this.offset=r,this.type=n,Dp()||(Nu()===i&&Ta(t),a!==null&&(a.setCachedNodes(null),a.dirty=!0)))}}function Ll(e,t,r){return new EB(e,t,r)}function Ew(e,t){let r=t.__key,n=e.offset,s="element";if(Gt(t)){s="text";const a=t.getTextContentSize();n>a&&(n=a)}else if(!yt(t)){const a=t.getNextSibling();if(Gt(a))r=a.__key,n=0,s="text";else{const i=t.getParent();i&&(r=i.__key,n=t.getIndexWithinParent()+1)}}e.set(r,n,s)}function D4(e,t){if(yt(t)){const r=t.getLastDescendant();yt(r)||Gt(r)?Ew(e,r):Ew(e,t)}else Ew(e,t)}class W1{constructor(t){this._cachedNodes=null,this._nodes=t,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){if(!La(t))return!1;const r=this._nodes,n=t._nodes;return r.size===n.size&&Array.from(r).every((s=>n.has(s)))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(t){this.dirty=!0,this._nodes.add(t),this._cachedNodes=null}delete(t){this.dirty=!0,this._nodes.delete(t),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(t){return this._nodes.has(t)}clone(){return new W1(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(t){}insertText(){}insertNodes(t){const r=this.getNodes(),n=r.length,s=r[n-1];let a;if(Gt(s))a=s.select();else{const i=s.getIndexWithinParent()+1;a=s.getParentOrThrow().select(i,i)}a.insertNodes(t);for(let i=0;i<n;i++)r[i].remove()}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=this._nodes,n=[];for(const s of r){const a=Os(s);a!==null&&n.push(a)}return Dp()||(this._cachedNodes=n),n}getTextContent(){const t=this.getNodes();let r="";for(let n=0;n<t.length;n++)r+=t[n].getTextContent();return r}deleteNodes(){const t=this.getNodes();if((Ht()||C0())===this&&t[0]){const r=Na(t[0],"next");dU($u(r,r))}for(const r of t)r.remove()}}function Tt(e){return e instanceof vf}class vf{constructor(t,r,n,s){this.anchor=t,this.focus=r,t._selection=this,r._selection=this,this._cachedNodes=null,this.format=n,this.style=s,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){return!!Tt(t)&&this.anchor.is(t.anchor)&&this.focus.is(t.focus)&&this.format===t.format&&this.style===t.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=(function(n){const s=[],[a,i]=n.getTextSlices();a&&s.push(a.caret.origin);const l=new Set,c=new Set;for(const d of n)if(Ml(d)){const{origin:f}=d;s.length===0?l.add(f):(c.add(f),s.push(f))}else{const{origin:f}=d;yt(f)&&c.has(f)||s.push(f)}if(i&&s.push(i.caret.origin),cf(n.focus)&&yt(n.focus.origin)&&n.focus.getNodeAtCaret()===null)for(let d=ko(n.focus.origin,"previous");Ml(d)&&l.has(d.origin)&&!d.origin.isEmpty()&&d.origin.is(s[s.length-1]);d=Gb(d))l.delete(d.origin),s.pop();for(;s.length>1;){const d=s[s.length-1];if(!yt(d)||c.has(d)||d.isEmpty()||l.has(d))break;s.pop()}if(s.length===0&&n.isCollapsed()){const d=wo(n.anchor),f=wo(n.anchor.getFlipped()),p=y=>Du(y)?y.origin:y.getNodeAtCaret(),g=p(d)||p(f)||(n.anchor.getNodeAtCaret()?d.origin:f.origin);s.push(g)}return s})(KA(oE(this),"next"));return Dp()||(this._cachedNodes=r),r}setTextNodeRange(t,r,n,s){this.anchor.set(t.__key,r,"text"),this.focus.set(n.__key,s,"text")}getTextContent(){const t=this.getNodes();if(t.length===0)return"";const r=t[0],n=t[t.length-1],s=this.anchor,a=this.focus,i=s.isBefore(a),[l,c]=z_(this);let d="",f=!0;for(let p=0;p<t.length;p++){const g=t[p];if(yt(g)&&!g.isInline())f||(d+=`
`),f=!g.isEmpty();else if(f=!1,Gt(g)){let y=g.getTextContent();g===r?g===n?s.type==="element"&&a.type==="element"&&a.offset!==s.offset||(y=l<c?y.slice(l,c):y.slice(c,l)):y=i?y.slice(l):y.slice(c):g===n&&(y=i?y.slice(0,c):y.slice(0,l)),d+=y}else!nn(g)&&!kc(g)||g===n&&this.isCollapsed()||(d+=g.getTextContent())}return d}applyDOMRange(t){const r=rs(),n=r.getEditorState()._selection,s=bA(t.startContainer,t.startOffset,t.endContainer,t.endOffset,r,n);if(s===null)return;const[a,i]=s;this.anchor.set(a.key,a.offset,a.type,!0),this.focus.set(i.key,i.offset,i.type,!0),Yy(this)}clone(){const t=this.anchor,r=this.focus;return new vf(Ll(t.key,t.offset,t.type),Ll(r.key,r.offset,r.type),this.format,this.style)}toggleFormat(t){this.format=i1(this.format,t,null),this.dirty=!0}setFormat(t){this.format=t,this.dirty=!0}setStyle(t){this.style=t,this.dirty=!0}hasFormat(t){const r=rf[t];return!!(this.format&r)}insertRawText(t){const r=t.split(/(\r?\n|\t)/),n=[],s=r.length;for(let a=0;a<s;a++){const i=r[a];i===`
`||i===`\r
`?n.push(Ol()):i==="	"?n.push(k0()):n.push(cs(i))}this.insertNodes(n)}insertText(t){const r=this.anchor,n=this.focus,s=this.format,a=this.style;let i=r,l=n;!this.isCollapsed()&&n.isBefore(r)&&(i=n,l=r),i.type==="element"&&(function(b,N,k,w){const T=b.getNode(),A=T.getChildAtIndex(b.offset),F=cs();if(F.setFormat(k),F.setStyle(w),jb(A))A.splice(0,0,[F]);else{const R=qs(T)?Un().append(F):F;A===null?T.append(R):A.insertBefore(R)}b.is(N)&&N.set(F.__key,0,"text"),b.set(F.__key,0,"text")})(i,l,s,a),l.type==="element"&&df(l,wo(Fc(l,"next")));const c=i.offset;let d=l.offset;const f=this.getNodes(),p=f.length;let g=f[0];Gt(g)||Pt(26);const y=g.getTextContent().length,v=g.getParentOrThrow();let _=f[p-1];if(p===1&&l.type==="element"&&(d=y,l.set(i.key,d,"text")),this.isCollapsed()&&c===y&&(vc(g)||!g.canInsertTextAfter()||!v.canInsertTextAfter()&&g.getNextSibling()===null)){let b=g.getNextSibling();if(Gt(b)&&b.canInsertTextBefore()&&!vc(b)||(b=cs(),b.setFormat(s),b.setStyle(a),v.canInsertTextAfter()?g.insertAfter(b):v.insertAfter(b)),b.select(0,0),g=b,t!=="")return void this.insertText(t)}else if(this.isCollapsed()&&c===0&&(vc(g)||!g.canInsertTextBefore()||!v.canInsertTextBefore()&&g.getPreviousSibling()===null)){let b=g.getPreviousSibling();if(Gt(b)&&!vc(b)||(b=cs(),b.setFormat(s),v.canInsertTextBefore()?g.insertBefore(b):v.insertBefore(b)),b.select(),g=b,t!=="")return void this.insertText(t)}else if(g.isSegmented()&&c!==y){const b=cs(g.getTextContent());b.setFormat(s),g.replace(b),g=b}else if(!this.isCollapsed()&&t!==""){const b=_.getParent();if(!v.canInsertTextBefore()||!v.canInsertTextAfter()||yt(b)&&(!b.canInsertTextBefore()||!b.canInsertTextAfter()))return this.insertText(""),_A(this.anchor,this.focus,null),void this.insertText(t)}if(p===1){if(Vd(g)){const w=cs(t);return w.select(),void g.replace(w)}const b=g.getFormat(),N=g.getStyle();if(c!==d||b===s&&N===a){if($1(g)){const w=cs(t);return w.setFormat(s),w.setStyle(a),w.select(),void g.replace(w)}}else{if(g.getTextContent()!==""){const w=cs(t);if(w.setFormat(s),w.setStyle(a),w.select(),c===0)g.insertBefore(w,!1);else{const[T]=g.splitText(c);T.insertAfter(w,!1)}return void(w.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length))}g.setFormat(s),g.setStyle(a)}const k=d-c;g=g.spliceText(c,k,t,!0),g.getTextContent()===""?g.remove():this.anchor.type==="text"&&(g.isComposing()?this.anchor.offset-=t.length:(this.format=b,this.style=N))}else{const b=new Set([...g.getParentKeys(),..._.getParentKeys()]),N=yt(g)?g:g.getParentOrThrow();let k=yt(_)?_:_.getParentOrThrow(),w=_;if(!N.is(k)&&k.isInline())do w=k,k=k.getParentOrThrow();while(k.isInline());if(l.type==="text"&&(d!==0||_.getTextContent()==="")||l.type==="element"&&_.getIndexWithinParent()<d)if(Gt(_)&&!Vd(_)&&d!==_.getTextContentSize()){if(_.isSegmented()){const E=cs(_.getTextContent());_.replace(E),_=E}qs(l.getNode())||l.type!=="text"||(_=_.spliceText(0,d,"")),b.add(_.__key)}else{const E=_.getParentOrThrow();E.canBeEmpty()||E.getChildrenSize()!==1?_.remove():E.remove()}else b.add(_.__key);const T=k.getChildren(),A=new Set(f),F=N.is(k),R=N.isInline()&&g.getNextSibling()===null?N:g;for(let E=T.length-1;E>=0;E--){const D=T[E];if(D.is(g)||yt(D)&&D.isParentOf(g))break;D.isAttached()&&(!A.has(D)||D.is(w)?F||R.insertAfter(D,!1):D.remove())}if(!F){let E=k,D=null;for(;E!==null;){const I=E.getChildren(),G=I.length;(G===0||I[G-1].is(D))&&(b.delete(E.__key),D=E),E=E.getParent()}}if(Vd(g))if(c===y)g.select();else{const E=cs(t);E.select(),g.replace(E)}else g=g.spliceText(c,y-c,t,!0),g.getTextContent()===""?g.remove():g.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length);for(let E=1;E<p;E++){const D=f[E],I=D.__key;b.has(I)||D.remove()}}}removeText(){const t=Ht()===this;Oy(this,fU(oE(this))),t&&Ht()!==this&&Aa(this)}formatText(t,r=null){if(this.isCollapsed())return this.toggleFormat(t),void Ta(null);const n=this.getNodes(),s=[];for(const T of n)Gt(T)&&s.push(T);const a=T=>{n.forEach((A=>{if(yt(A)){const F=A.getFormatFlags(t,T);A.setTextFormat(F)}}))},i=s.length;if(i===0)return this.toggleFormat(t),Ta(null),void a(r);const l=this.anchor,c=this.focus,d=this.isBackward(),f=d?c:l,p=d?l:c;let g=0,y=s[0],v=f.type==="element"?0:f.offset;if(f.type==="text"&&v===y.getTextContentSize()&&(g=1,y=s[1],v=0),y==null)return;const _=y.getFormatFlags(t,r);a(_);const b=i-1;let N=s[b];const k=p.type==="text"?p.offset:N.getTextContentSize();if(y.is(N)){if(v===k)return;if(vc(y)||v===0&&k===y.getTextContentSize())y.setFormat(_);else{const T=y.splitText(v,k),A=v===0?T[0]:T[1];A.setFormat(_),f.type==="text"&&f.set(A.__key,0,"text"),p.type==="text"&&p.set(A.__key,k-v,"text")}return void(this.format=_)}v===0||vc(y)||([,y]=y.splitText(v),v=0),y.setFormat(_);const w=N.getFormatFlags(t,_);k>0&&(k===N.getTextContentSize()||vc(N)||([N]=N.splitText(k)),N.setFormat(w));for(let T=g+1;T<b;T++){const A=s[T],F=A.getFormatFlags(t,w);A.setFormat(F)}f.type==="text"&&f.set(y.__key,v,"text"),p.type==="text"&&p.set(N.__key,k,"text"),this.format=_|w}insertNodes(t){if(t.length===0)return;if(this.isCollapsed()||this.removeText(),this.anchor.key==="root"){this.insertParagraph();const v=Ht();return Tt(v)||Pt(134),v.insertNodes(t)}const r=(this.isBackward()?this.focus:this.anchor).getNode(),n=Pw(r,vo),s=t[t.length-1];if(yt(n)&&"__language"in n){if("__language"in t[0])this.insertText(t[0].getTextContent());else{const v=Nw(this);n.splice(v,0,t),s.selectEnd()}return}if(!t.some((v=>(yt(v)||nn(v))&&!v.isInline()))){yt(n)||Pt(211,r.constructor.name,r.getType());const v=Nw(this);return n.splice(v,0,t),void s.selectEnd()}const a=(function(v){const _=Un();let b=null;for(let N=0;N<v.length;N++){const k=v[N],w=kc(k);if(w||nn(k)&&k.isInline()||yt(k)&&k.isInline()||Gt(k)||k.isParentRequired()){if(b===null&&(b=k.createParentElementNode(),_.append(b),w))continue;b!==null&&b.append(k)}else _.append(k),b=null}return _})(t),i=a.getLastDescendant(),l=a.getChildren(),c=!yt(n)||!n.isEmpty()?this.insertParagraph():null,d=l[l.length-1];let f=l[0];var p;yt(p=f)&&vo(p)&&!p.isEmpty()&&yt(n)&&(!n.isEmpty()||n.canMergeWhenEmpty())&&(yt(n)||Pt(211,r.constructor.name,r.getType()),n.append(...f.getChildren()),f=l[1]),f&&(n===null&&Pt(212,r.constructor.name,r.getType()),(function(v,_,b){const N=_.getParentOrThrow().getLastChild();let k=_;const w=[_];for(;k!==N;)k.getNextSibling()||Pt(140),k=k.getNextSibling(),w.push(k);let T=v;for(const A of w)T=T.insertAfter(A)})(n,f));const g=Pw(i,vo);c&&yt(g)&&(c.canMergeWhenEmpty()||vo(d))&&(g.append(...c.getChildren()),c.remove()),yt(n)&&n.isEmpty()&&n.remove(),i.selectEnd();const y=yt(n)?n.getLastChild():null;kc(y)&&g!==n&&y.remove()}insertParagraph(){if(this.anchor.key==="root"){const i=Un();return qn().splice(this.anchor.offset,0,[i]),i.select(),i}const t=Nw(this),r=Pw(this.anchor.getNode(),vo);yt(r)||Pt(213);const n=r.getChildAtIndex(t),s=n?[n,...n.getNextSiblings()]:[],a=r.insertNewAfter(this,!1);return a?(a.append(...s),a.selectStart(),a):null}insertLineBreak(t){const r=Ol();if(this.insertNodes([r]),t){const n=r.getParentOrThrow(),s=r.getIndexWithinParent();n.select(s,s)}}extract(){const t=this.getNodes(),r=t.length,n=r-1,s=this.anchor,a=this.focus;let i=t[0],l=t[n];const[c,d]=z_(this);if(r===0)return[];if(r===1){if(Gt(i)&&!this.isCollapsed()){const p=c>d?d:c,g=c>d?c:d,y=i.splitText(p,g),v=p===0?y[0]:y[1];return v!=null?[v]:[]}return[i]}const f=s.isBefore(a);if(Gt(i)){const p=f?c:d;p===i.getTextContentSize()?t.shift():p!==0&&([,i]=i.splitText(p),t[0]=i)}if(Gt(l)){const p=l.getTextContent().length,g=f?d:c;g===0?t.pop():g!==p&&([l]=l.splitText(g),t[n]=l)}return t}modify(t,r,n){if(W4(this,t,r,n))return;const s=t==="move",a=rs(),i=el(So(a));if(!i)return;const l=a._blockCursorElement,c=a._rootElement,d=this.focus.getNode();if(c===null||l===null||!yt(d)||d.isInline()||d.canBeEmpty()||q_(l,a,c),this.dirty){let f=af(a,this.anchor.key),p=af(a,this.focus.key);this.anchor.type==="text"&&(f=u0(f)),this.focus.type==="text"&&(p=u0(p)),f&&p&&kA(i,f,this.anchor.offset,p,this.focus.offset)}if((function(f,p,g,y){f.modify(p,g,y)})(i,t,r?"backward":"forward",n),i.rangeCount>0){const f=i.getRangeAt(0),p=this.anchor.getNode(),g=qs(p)?p:YB(p);if(this.applyDOMRange(f),this.dirty=!0,!s){const y=this.getNodes(),v=[];let _=!1;for(let b=0;b<y.length;b++){const N=y[b];K_(N,g)?v.push(N):_=!0}if(_&&v.length>0)if(r){const b=v[0];yt(b)?b.selectStart():b.getParentOrThrow().selectStart()}else{const b=v[v.length-1];yt(b)?b.selectEnd():b.getParentOrThrow().selectEnd()}i.anchorNode===f.startContainer&&i.anchorOffset===f.startOffset||(function(b){const N=b.focus,k=b.anchor,w=k.key,T=k.offset,A=k.type;k.set(N.key,N.offset,N.type,!0),N.set(w,T,A,!0)})(this)}}n==="lineboundary"&&W4(this,t,r,n,"decorators")}forwardDeletion(t,r,n){if(!n&&(t.type==="element"&&yt(r)&&t.offset===r.getChildrenSize()||t.type==="text"&&t.offset===r.getTextContentSize())){const s=r.getParent(),a=r.getNextSibling()||(s===null?null:s.getNextSibling());if(yt(a)&&a.isShadowRoot())return!0}return!1}deleteCharacter(t){const r=this.isCollapsed();if(this.isCollapsed()){const n=this.anchor;let s=n.getNode();if(this.forwardDeletion(n,s,t))return;const a=Kb(Fc(n,t?"previous":"next"));if(a.getTextSlices().every((l=>l===null||l.distance===0))){let l={type:"initial"};for(const c of a.iterNodeCarets("shadowRoot"))if(Ml(c)){if(!c.origin.isInline()){if(c.origin.isShadowRoot()){if(l.type==="merge-block")break;if(yt(a.anchor.origin)&&a.anchor.origin.isEmpty()){const d=wo(c);Oy(this,$u(d,d)),a.anchor.origin.remove()}return}l.type!=="merge-next-block"&&l.type!=="merge-block"||(l={block:l.block,caret:c,type:"merge-block"})}}else{if(l.type==="merge-block")break;if(cf(c)){if(yt(c.origin)){if(c.origin.isInline()){if(!c.origin.isParentOf(a.anchor.origin))break}else l={block:c.origin,type:"merge-next-block"};continue}if(nn(c.origin)){if(!c.origin.isIsolated())if(l.type==="merge-next-block"&&(c.origin.isKeyboardSelectable()||!c.origin.isInline())&&yt(a.anchor.origin)&&a.anchor.origin.isEmpty()){a.anchor.origin.remove();const d=kb();d.add(c.origin.getKey()),Aa(d)}else c.origin.remove();return}break}}if(l.type==="merge-block"){const{caret:c,block:d}=l;return Oy(this,$u(!c.origin.isEmpty()&&d.isEmpty()?Xb(Na(d,c.direction)):a.anchor,c)),this.removeText()}}const i=this.focus;if(this.modify("extend",t,"character"),this.isCollapsed()){if(t&&n.offset===0&&M4(this,n.getNode()))return}else{const l=i.type==="text"?i.getNode():null;if(s=n.type==="text"?n.getNode():null,l!==null&&l.isSegmented()){const c=i.offset,d=l.getTextContentSize();if(l.is(s)||t&&c!==d||!t&&c!==0)return void O4(l,t,c)}else if(s!==null&&s.isSegmented()){const c=n.offset,d=s.getTextContentSize();if(s.is(l)||t&&c!==0||!t&&c!==d)return void O4(s,t,c)}(function(c,d){const f=c.anchor,p=c.focus,g=f.getNode(),y=p.getNode();if(g===y&&f.type==="text"&&p.type==="text"){const v=f.offset,_=p.offset,b=v<_,N=b?v:_,k=b?_:v,w=k-1;N!==w&&(function(T){return!(LA(T)||NB(T))})(g.getTextContent().slice(N,k))&&(d?p.set(p.key,w,p.type):f.set(f.key,w,f.type))}})(this,t)}}if(this.removeText(),t&&!r&&this.isCollapsed()&&this.anchor.type==="element"&&this.anchor.offset===0){const n=this.anchor.getNode();n.isEmpty()&&qs(n.getParent())&&n.getPreviousSibling()===null&&M4(this,n)}}deleteLine(t){this.isCollapsed()&&this.modify("extend",t,"lineboundary"),this.isCollapsed()?this.deleteCharacter(t):this.removeText()}deleteWord(t){if(this.isCollapsed()){const r=this.anchor,n=r.getNode();if(this.forwardDeletion(r,n,t))return;this.modify("extend",t,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function La(e){return e instanceof W1}function I4(e){const t=e.offset;if(e.type==="text")return t;const r=e.getNode();return t===r.getChildrenSize()?r.getTextContent().length:0}function z_(e){const t=e.getStartEndPoints();if(t===null)return[0,0];const[r,n]=t;return r.type==="element"&&n.type==="element"&&r.key===n.key&&r.offset===n.offset?[0,0]:[I4(r),I4(n)]}function M4(e,t){for(let r=t;r;r=r.getParent()){if(yt(r)){if(r.collapseAtStart(e))return!0;if(fi(r))break}if(r.getPreviousSibling())break}return!1}const NB=(()=>{try{const e=new RegExp("\\p{Emoji}","u"),t=e.test.bind(e);if(t("")&&t("#")&&t(""))return t}catch{}return()=>!1})();function O4(e,t,r){const n=e,s=n.getTextContent().split(/(?=\s)/g),a=s.length;let i=0,l=0;for(let d=0;d<a;d++){const f=d===a-1;if(l=i,i+=s[d].length,t&&i===r||i>r||f){s.splice(d,1),f&&(l=void 0);break}}const c=s.join("").trim();c===""?n.remove():(n.setTextContent(c),n.select(l,l))}function L4(e,t,r,n){let s,a=t;if($n(e)){let i=!1;const l=e.childNodes,c=l.length,d=n._blockCursorElement;a===c&&(i=!0,a=c-1);let f=l[a],p=!1;if(f===d)f=l[a+1],p=!0;else if(d!==null){const g=d.parentNode;e===g&&t>Array.prototype.indexOf.call(g.children,d)&&a--}if(s=Gh(f),Gt(s))a=Iu(s,i?"next":"previous");else{let g=Gh(e);if(g===null)return null;if(yt(g)){const y=n.getElementByKey(g.getKey());y===null&&Pt(214),[g,a]=g.getDOMSlot(y).resolveChildIndex(g,y,e,t),yt(g)||Pt(215),i&&a>=g.getChildrenSize()&&(a=Math.max(0,g.getChildrenSize()-1));let _=g.getChildAtIndex(a);if(yt(_)&&(function(b,N,k){const w=b.getParent();return k===null||w===null||!w.canBeEmpty()||w!==k.getNode()})(_,0,r)){const b=i?_.getLastDescendant():_.getFirstDescendant();b===null?g=_:(_=b,g=yt(_)?_:_.getParentOrThrow()),a=0}Gt(_)?(s=_,g=null,a=Iu(_,i?"next":"previous")):_!==g&&i&&!p&&(yt(g)||Pt(216),a=Math.min(g.getChildrenSize(),a+1))}else{const y=g.getIndexWithinParent();a=t===0&&nn(g)&&Gh(e)===g?y:y+1,g=g.getParentOrThrow()}if(yt(g))return Ll(g.__key,a,"element")}}else s=Gh(e);return Gt(s)?Ll(s.__key,Iu(s,a,"clamp"),"text"):null}function B4(e,t,r){const n=e.offset,s=e.getNode();if(n===0){const a=s.getPreviousSibling(),i=s.getParent();if(t){if((r||!t)&&a===null&&yt(i)&&i.isInline()){const l=i.getPreviousSibling();Gt(l)&&e.set(l.__key,l.getTextContent().length,"text")}}else yt(a)&&!r&&a.isInline()?e.set(a.__key,a.getChildrenSize(),"element"):Gt(a)&&e.set(a.__key,a.getTextContent().length,"text")}else if(n===s.getTextContent().length){const a=s.getNextSibling(),i=s.getParent();if(t&&yt(a)&&a.isInline())e.set(a.__key,0,"element");else if((r||t)&&a===null&&yt(i)&&i.isInline()&&!i.canInsertTextAfter()){const l=i.getNextSibling();Gt(l)&&e.set(l.__key,0,"text")}}}function _A(e,t,r){if(e.type==="text"&&t.type==="text"){const n=e.isBefore(t),s=e.is(t);B4(e,n,s),B4(t,!n,s),s&&t.set(e.key,e.offset,e.type);const a=rs();if(a.isComposing()&&a._compositionKey!==e.key&&Tt(r)){const i=r.anchor,l=r.focus;e.set(i.key,i.offset,i.type,!0),t.set(l.key,l.offset,l.type,!0)}}}function bA(e,t,r,n,s,a){if(e===null||r===null||!Op(s,e,r))return null;const i=L4(e,t,Tt(a)?a.anchor:null,s);if(i===null)return null;const l=L4(r,n,Tt(a)?a.focus:null,s);if(l===null)return null;if(i.type==="element"&&l.type==="element"){const c=Gh(e),d=Gh(r);if(nn(c)&&nn(d))return null}return _A(i,l,a),[i,l]}function H_(e){return yt(e)&&!e.isInline()}function SA(e,t,r,n,s,a){const i=Yu(),l=new vf(Ll(e,t,s),Ll(r,n,a),0,"");return l.dirty=!0,i._selection=l,l}function z1(){const e=Ll("root",0,"element"),t=Ll("root",0,"element");return new vf(e,t,0,"")}function kb(){return new W1(new Set)}function Cb(e,t,r,n){const s=r._window;if(s===null)return null;const a=n||s.event,i=a?a.type:void 0,l=i==="selectionchange",c=!N_&&(l||i==="beforeinput"||i==="compositionstart"||i==="compositionend"||i==="click"&&a&&a.detail===3||i==="drop"||i===void 0);let d,f,p,g;if(Tt(e)&&!c)return e.clone();if(t===null)return null;if(d=t.anchorNode,f=t.focusNode,p=t.anchorOffset,g=t.focusOffset,l&&Tt(e)&&!Op(r,d,f))return e.clone();const y=bA(d,p,f,g,r,e);if(y===null)return null;const[v,_]=y;return new vf(v,_,Tt(e)?e.format:0,Tt(e)?e.style:"")}function Ht(){return Yu()._selection}function C0(){return rs()._editorState._selection}function n1(e,t,r,n=1){const s=e.anchor,a=e.focus,i=s.getNode(),l=a.getNode();if(!t.is(i)&&!t.is(l))return;const c=t.__key;if(e.isCollapsed()){const d=s.offset;if(r<=d&&n>0||r<d&&n<0){const f=Math.max(0,d+n);s.set(c,f,"element"),a.set(c,f,"element"),U4(e)}}else{const d=e.isBackward(),f=d?a:s,p=f.getNode(),g=d?s:a,y=g.getNode();if(t.is(p)){const v=f.offset;(r<=v&&n>0||r<v&&n<0)&&f.set(c,Math.max(0,v+n),"element")}if(t.is(y)){const v=g.offset;(r<=v&&n>0||r<v&&n<0)&&g.set(c,Math.max(0,v+n),"element")}}U4(e)}function U4(e){const t=e.anchor,r=t.offset,n=e.focus,s=n.offset,a=t.getNode(),i=n.getNode();if(e.isCollapsed()){if(!yt(a))return;const l=a.getChildrenSize(),c=r>=l,d=c?a.getChildAtIndex(l-1):a.getChildAtIndex(r);if(Gt(d)){let f=0;c&&(f=d.getTextContentSize()),t.set(d.__key,f,"text"),n.set(d.__key,f,"text")}}else{if(yt(a)){const l=a.getChildrenSize(),c=r>=l,d=c?a.getChildAtIndex(l-1):a.getChildAtIndex(r);if(Gt(d)){let f=0;c&&(f=d.getTextContentSize()),t.set(d.__key,f,"text")}}if(yt(i)){const l=i.getChildrenSize(),c=s>=l,d=c?i.getChildAtIndex(l-1):i.getChildAtIndex(s);if(Gt(d)){let f=0;c&&(f=d.getTextContentSize()),n.set(d.__key,f,"text")}}}}function s1(e,t,r,n,s){let a=null,i=0,l=null;n!==null?(a=n.__key,Gt(n)?(i=n.getTextContentSize(),l="text"):yt(n)&&(i=n.getChildrenSize(),l="element")):s!==null&&(a=s.__key,Gt(s)?l="text":yt(s)&&(l="element")),a!==null&&l!==null?e.set(a,i,l):(i=t.getIndexWithinParent(),i===-1&&(i=r.getChildrenSize()),e.set(r.__key,i,"element"))}function $4(e,t,r,n,s){e.type==="text"?e.set(r,e.offset+(t?0:s),"text"):e.offset>n.getIndexWithinParent()&&e.set(e.key,e.offset-1,"element")}function kA(e,t,r,n,s){try{e.setBaseAndExtent(t,r,n,s)}catch{}}function AB(e,t,r,n,s,a,i){const l=n.anchorNode,c=n.focusNode,d=n.anchorOffset,f=n.focusOffset,p=document.activeElement;if(s.has(jA)&&p!==a||p!==null&&Rb(p))return;if(!Tt(t))return void(e!==null&&Op(r,l,c)&&n.removeAllRanges());const g=t.anchor,y=t.focus,v=g.key,_=y.key,b=af(r,v),N=af(r,_),k=g.offset,w=y.offset,T=t.format,A=t.style,F=t.isCollapsed();let R=b,E=N,D=!1;if(g.type==="text"){R=u0(b);const re=g.getNode();D=re.getFormat()!==T||re.getStyle()!==A}else Tt(e)&&e.anchor.type==="text"&&(D=!0);var I,G,Y,ee,ie;if(y.type==="text"&&(E=u0(N)),R!==null&&E!==null&&(F&&(e===null||D||Tt(e)&&(e.format!==T||e.style!==A))&&(I=T,G=A,Y=k,ee=v,ie=performance.now(),hA=[I,G,Y,ee,ie]),d!==k||f!==w||l!==R||c!==E||n.type==="Range"&&F||(p!==null&&a.contains(p)||a.focus({preventScroll:!0}),g.type==="element"))){if(kA(n,R,k,E,w),!s.has(MB)&&t.isCollapsed()&&a!==null&&a===document.activeElement){const re=Tt(t)&&t.anchor.type==="element"?R.childNodes[k]||null:n.rangeCount>0?n.getRangeAt(0):null;if(re!==null){let se;if(re instanceof Text){const B=document.createRange();B.selectNode(re),se=B.getBoundingClientRect()}else se=re.getBoundingClientRect();(function(B,z,U){const V=WA(U),q=Bb(V);if(V===null||q===null)return;let{top:L,bottom:M}=z,X=0,K=0,Z=U;for(;Z!==null;){const J=Z===V.body;if(J)X=0,K=So(B).innerHeight;else{const me=Z.getBoundingClientRect();X=me.top,K=me.bottom}let ne=0;if(L<X?ne=-(X-L):M>K&&(ne=M-K),ne!==0)if(J)q.scrollBy(0,ne);else{const me=Z.scrollTop;Z.scrollTop+=ne;const xe=Z.scrollTop-me;L-=xe,M-=xe}if(J)break;Z=Lp(Z)}})(r,se,a)}}U_=!0}}function jB(e){let t=Ht()||C0();t===null&&(t=qn().selectEnd()),t.insertNodes(e)}function Nw(e){let t=e;e.isCollapsed()||t.removeText();const r=Ht();Tt(r)&&(t=r),Tt(t)||Pt(161);const n=t.anchor;let s=n.getNode(),a=n.offset;for(;!vo(s);){const i=s;if([s,a]=FB(s,a),i.is(s))break}return a}function FB(e,t){const r=e.getParent();if(!r){const s=Un();return qn().append(s),s.select(),[qn(),0]}if(Gt(e)){const s=e.splitText(t);if(s.length===0)return[r,e.getIndexWithinParent()];const a=t===0?0:1;return[r,s[0].getIndexWithinParent()+a]}if(!yt(e)||t===0)return[r,e.getIndexWithinParent()];const n=e.getChildAtIndex(t);if(n){const s=new vf(Ll(e.__key,t,"element"),Ll(e.__key,t,"element"),0,""),a=e.insertNewAfter(s);a&&a.append(n,...n.getNextSiblings())}return[r,e.getIndexWithinParent()+1]}function W4(e,t,r,n,s="decorators-and-blocks"){if(t==="move"&&n==="character"&&!e.isCollapsed()){const[f,p]=r===e.isBackward()?[e.focus,e.anchor]:[e.anchor,e.focus];return p.set(f.key,f.offset,f.type),!0}const a=Fc(e.focus,r?"previous":"next"),i=n==="lineboundary",l=t==="move";let c=a,d=s==="decorators-and-blocks";if(!VA(c)){for(const f of c){d=!1;const{origin:p}=f;if(!nn(p)||p.isIsolated()||(c=f,!i||!p.isInline()))break}if(d)for(const f of Kb(a).iterNodeCarets(t==="extend"?"shadowRoot":"root")){if(Ml(f))f.origin.isInline()||(c=f);else{if(yt(f.origin))continue;nn(f.origin)&&!f.origin.isInline()&&(c=f)}break}}if(c===a)return!1;if(l&&!i&&nn(c.origin)&&c.origin.isKeyboardSelectable()){const f=kb();return f.add(c.origin.getKey()),Aa(f),!0}return c=wo(c),l&&df(e.anchor,c),df(e.focus,c),d||!i}let aa=null,ia=null,Ai=!1,Aw=!1,Iy=0;const z4={characterData:!0,childList:!0,subtree:!0};function Dp(){return Ai||aa!==null&&aa._readOnly}function Ca(){Ai&&Pt(13)}function CA(){Iy>99&&Pt(14)}function Yu(){return aa===null&&Pt(195,TA()),aa}function rs(){return ia===null&&Pt(196,TA()),ia}function TA(){let e=0;const t=new Set,r=V1.version;if(typeof window<"u")for(const s of document.querySelectorAll("[contenteditable]")){const a=K1(s);if(Db(a))e++;else if(a){let i=String(a.constructor.version||"<0.17.1");i===r&&(i+=" (separately built, likely a bundler configuration issue)"),t.add(i)}}let n=` Detected on the page: ${e} compatible editor(s) with version ${r}`;return t.size&&(n+=` and incompatible editors with versions ${Array.from(t).join(", ")}`),n}function PB(){return ia}function H4(e,t,r){const n=t.__type,s=PA(e,n);let a=r.get(n);a===void 0&&(a=Array.from(s.transforms),r.set(n,a));const i=a.length;for(let l=0;l<i&&(a[l](t),t.isAttached());l++);}function G4(e,t){return e!==void 0&&e.__key!==t&&e.isAttached()}function EA(e,t){if(!t)return;const r=e._updateTags;let n=t;Array.isArray(t)||(n=[t]);for(const s of n)r.add(s)}function RB(e){return Tb(e,rs()._nodes)}function Tb(e,t){const r=e.type,n=t.get(r);n===void 0&&Pt(17,r);const s=n.klass;e.type!==s.getType()&&Pt(18,s.name);const a=s.importJSON(e),i=e.children;if(yt(a)&&Array.isArray(i))for(let l=0;l<i.length;l++){const c=Tb(i[l],t);a.append(c)}return a}function V4(e,t,r){const n=aa,s=Ai,a=ia;aa=t,Ai=!0,ia=e;try{return r()}finally{aa=n,Ai=s,ia=a}}function _c(e,t){const r=e._pendingEditorState,n=e._rootElement,s=e._headless||n===null;if(r===null)return;const a=e._editorState,i=a._selection,l=r._selection,c=e._dirtyType!==tf,d=aa,f=Ai,p=ia,g=e._updating,y=e._observer;let v=null;if(e._pendingEditorState=null,e._editorState=r,!s&&c&&y!==null){ia=e,aa=r,Ai=!1,e._updating=!0;try{const F=e._dirtyType,R=e._dirtyElements,E=e._dirtyLeaves;y.disconnect(),v=oB(a,r,e,F,R,E)}catch(F){if(F instanceof Error&&e._onError(F),Aw)throw F;return FA(e,null,n,r),H6(e),e._dirtyType=c0,Aw=!0,_c(e,a),void(Aw=!1)}finally{y.observe(n,z4),e._updating=g,aa=d,Ai=f,ia=p}}r._readOnly||(r._readOnly=!0);const _=e._dirtyLeaves,b=e._dirtyElements,N=e._normalizedNodes,k=e._updateTags,w=e._deferred;c&&(e._dirtyType=tf,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements=new Map,e._normalizedNodes=new Set,e._updateTags=new Set),(function(F,R){const E=F._decorators;let D=F._pendingDecorators||E;const I=R._nodeMap;let G;for(G in D)I.has(G)||(D===E&&(D=MA(F)),delete D[G])})(e,r);const T=s?null:el(So(e));if(e._editable&&T!==null&&(c||l===null||l.dirty)&&n!==null&&!k.has(OB)){ia=e,aa=r;try{if(y!==null&&y.disconnect(),c||l===null||l.dirty){const F=e._blockCursorElement;F!==null&&q_(F,e,n),AB(i,l,e,T,k,n)}(function(F,R,E){let D=F._blockCursorElement;if(Tt(E)&&E.isCollapsed()&&E.anchor.type==="element"&&R.contains(document.activeElement)){const I=E.anchor,G=I.getNode(),Y=I.offset;let ee=!1,ie=null;if(Y===G.getChildrenSize())Fw(G.getChildAtIndex(Y-1))&&(ee=!0);else{const re=G.getChildAtIndex(Y);if(re!==null&&Fw(re)){const se=re.getPreviousSibling();(se===null||Fw(se))&&(ee=!0,ie=F.getElementByKey(re.__key))}}if(ee){const re=F.getElementByKey(G.__key);return D===null&&(F._blockCursorElement=D=(function(se){const B=se.theme,z=document.createElement("div");z.contentEditable="false",z.setAttribute("data-lexical-cursor","true");let U=B.blockCursor;if(U!==void 0){if(typeof U=="string"){const V=B6(U);U=B.blockCursor=V}U!==void 0&&z.classList.add(...U)}return z})(F._config)),R.style.caretColor="transparent",void(ie===null?re.appendChild(D):re.insertBefore(D,ie))}}D!==null&&q_(D,F,R)})(e,n,l)}finally{y!==null&&y.observe(n,z4),ia=p,aa=d}}v!==null&&(function(F,R,E,D,I){const G=Array.from(F._listeners.mutation),Y=G.length;for(let ee=0;ee<Y;ee++){const[ie,re]=G[ee];for(const se of re){const B=R.get(se);B!==void 0&&ie(B,{dirtyLeaves:D,prevEditorState:I,updateTags:E})}}})(e,v,k,_,a),Tt(l)||l===null||i!==null&&i.is(l)||e.dispatchCommand(J6,void 0);const A=e._pendingDecorators;A!==null&&(e._decorators=A,e._pendingDecorators=null,Mm("decorator",e,!0,A)),(function(F,R,E){const D=J4(R),I=J4(E);D!==I&&Mm("textcontent",F,!0,I)})(e,t||a,r),Mm("update",e,!0,{dirtyElements:b,dirtyLeaves:_,editorState:r,mutatedNodes:v,normalizedNodes:N,prevEditorState:t||a,tags:k}),(function(F,R){if(F._deferred=[],R.length!==0){const E=F._updating;F._updating=!0;try{for(let D=0;D<R.length;D++)R[D]()}finally{F._updating=E}}})(e,w),(function(F){const R=F._updates;if(R.length!==0){const E=R.shift();if(E){const[D,I]=E;H1(F,D,I)}}})(e)}function Mm(e,t,r,...n){const s=t._updating;t._updating=r;try{const a=Array.from(t._listeners[e]);for(let i=0;i<a.length;i++)a[i].apply(null,n)}finally{t._updating=s}}function K4(e,t){const r=e._updates;let n=t||!1;for(;r.length!==0;){const s=r.shift();if(s){const[a,i]=s,l=e._pendingEditorState;let c;i!==void 0&&(c=i.onUpdate,i.skipTransforms&&(n=!0),i.discrete&&(l===null&&Pt(191),l._flushSync=!0),c&&e._deferred.push(c),EA(e,i.tag)),l==null?H1(e,a,i):a()}}return n}function H1(e,t,r){const n=e._updateTags;let s,a=!1,i=!1;r!==void 0&&(s=r.onUpdate,EA(e,r.tag),a=r.skipTransforms||!1,i=r.discrete||!1),s&&e._deferred.push(s);const l=e._editorState;let c=e._pendingEditorState,d=!1;(c===null||c._readOnly)&&(c=e._pendingEditorState=NA(c||l),d=!0),c._flushSync=i;const f=aa,p=Ai,g=ia,y=e._updating;aa=c,Ai=!1,e._updating=!0,ia=e;const v=e._headless||e.getRootElement()===null;Fb(null);try{d&&(v?l._selection!==null&&(c._selection=l._selection.clone()):c._selection=(function(k,w){const T=k.getEditorState()._selection,A=el(So(k));return Tt(T)||T==null?Cb(T,A,k,w):T.clone()})(e,r&&r.event||null));const b=e._compositionKey;t(),a=K4(e,a),(function(k,w){const T=w.getEditorState()._selection,A=k._selection;if(Tt(A)){const F=A.anchor,R=A.focus;let E;if(F.type==="text"&&(E=F.getNode(),E.selectionTransform(T,A)),R.type==="text"){const D=R.getNode();E!==D&&D.selectionTransform(T,A)}}})(c,e),e._dirtyType!==tf&&(a?(function(k,w){const T=w._dirtyLeaves,A=k._nodeMap;for(const F of T){const R=A.get(F);Gt(R)&&R.isAttached()&&R.isSimpleText()&&!R.isUnmergeable()&&S4(R)}})(c,e):(function(k,w){const T=w._dirtyLeaves,A=w._dirtyElements,F=k._nodeMap,R=Nu(),E=new Map;let D=T,I=D.size,G=A,Y=G.size;for(;I>0||Y>0;){if(I>0){w._dirtyLeaves=new Set;for(const ee of D){const ie=F.get(ee);Gt(ie)&&ie.isAttached()&&ie.isSimpleText()&&!ie.isUnmergeable()&&S4(ie),ie!==void 0&&G4(ie,R)&&H4(w,ie,E),T.add(ee)}if(D=w._dirtyLeaves,I=D.size,I>0){Iy++;continue}}w._dirtyLeaves=new Set,w._dirtyElements=new Map,G.delete("root")&&G.set("root",!0);for(const ee of G){const ie=ee[0],re=ee[1];if(A.set(ie,re),!re)continue;const se=F.get(ie);se!==void 0&&G4(se,R)&&H4(w,se,E)}D=w._dirtyLeaves,I=D.size,G=w._dirtyElements,Y=G.size,Iy++}w._dirtyLeaves=T,w._dirtyElements=A})(c,e),K4(e),(function(k,w,T,A){const F=k._nodeMap,R=w._nodeMap,E=[];for(const[D]of A){const I=R.get(D);I!==void 0&&(I.isAttached()||(yt(I)&&$6(I,D,F,R,E,A),F.has(D)||A.delete(D),E.push(D)))}for(const D of E)R.delete(D);for(const D of T){const I=R.get(D);I===void 0||I.isAttached()||(F.has(D)||T.delete(D),R.delete(D))}})(l,c,e._dirtyLeaves,e._dirtyElements)),b!==e._compositionKey&&(c._flushSync=!0);const N=c._selection;if(Tt(N)){const k=c._nodeMap,w=N.anchor.key,T=N.focus.key;k.get(w)!==void 0&&k.get(T)!==void 0||Pt(19)}else La(N)&&N._nodes.size===0&&(c._selection=null)}catch(b){return b instanceof Error&&e._onError(b),e._pendingEditorState=l,e._dirtyType=c0,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),void _c(e)}finally{aa=f,Ai=p,ia=g,e._updating=y,Iy=0}e._dirtyType!==tf||e._deferred.length>0||(function(b,N){const k=N.getEditorState()._selection,w=b._selection;if(w!==null){if(w.dirty||!w.is(k))return!0}else if(k!==null)return!0;return!1})(c,e)?c._flushSync?(c._flushSync=!1,_c(e)):d&&WB((()=>{_c(e)})):(c._flushSync=!1,d&&(n.clear(),e._deferred=[],e._pendingEditorState=null))}function Wi(e,t,r){ia===e&&r===void 0?t():H1(e,t,r)}class Om{constructor(t,r,n){this.element=t,this.before=r||null,this.after=n||null}withBefore(t){return new Om(this.element,t,this.after)}withAfter(t){return new Om(this.element,this.before,t)}withElement(t){return this.element===t?this:new Om(t,this.before,this.after)}insertChild(t){const r=this.before||this.getManagedLineBreak();return r!==null&&r.parentElement!==this.element&&Pt(222),this.element.insertBefore(t,r),this}removeChild(t){return t.parentElement!==this.element&&Pt(223),this.element.removeChild(t),this}replaceChild(t,r){return r.parentElement!==this.element&&Pt(224),this.element.replaceChild(t,r),this}getFirstChild(){const t=this.after?this.after.nextSibling:this.element.firstChild;return t===this.before||t===this.getManagedLineBreak()?null:t}getManagedLineBreak(){return this.element.__lexicalLineBreak||null}setManagedLineBreak(t){if(t===null)this.removeManagedLineBreak();else{const r=t==="decorator"&&(l0||rp);this.insertManagedLineBreak(r)}}removeManagedLineBreak(){const t=this.getManagedLineBreak();if(t){const r=this.element,n=t.nodeName==="IMG"?t.nextSibling:null;n&&r.removeChild(n),r.removeChild(t),r.__lexicalLineBreak=void 0}}insertManagedLineBreak(t){const r=this.getManagedLineBreak();if(r){if(t===(r.nodeName==="IMG"))return;this.removeManagedLineBreak()}const n=this.element,s=this.before,a=document.createElement("br");if(n.insertBefore(a,s),t){const i=document.createElement("img");i.setAttribute("data-lexical-linebreak","true"),i.style.cssText="display: inline !important; border: 0px !important; margin: 0px !important;",i.alt="",n.insertBefore(i,a),n.__lexicalLineBreak=i}else n.__lexicalLineBreak=a}getFirstChildOffset(){let t=0;for(let r=this.after;r!==null;r=r.previousSibling)t++;return t}resolveChildIndex(t,r,n,s){if(n===this.element){const c=this.getFirstChildOffset();return[t,Math.min(c+t.getChildrenSize(),Math.max(c,s))]}const a=q4(r,n);a.push(s);const i=q4(r,this.element);let l=t.getIndexWithinParent();for(let c=0;c<i.length;c++){const d=a[c],f=i[c];if(d===void 0||d<f)break;if(d>f){l+=1;break}}return[t.getParentOrThrow(),l]}}function q4(e,t){const r=[];let n=t;for(;n!==e&&n!==null;n=n.parentNode){let s=0;for(let a=n.previousSibling;a!==null;a=a.previousSibling)s++;r.push(s)}return n!==e&&Pt(225),r.reverse()}class Ka extends S0{constructor(t){super(t),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__style="",this.__indent=0,this.__dir=null,this.__textFormat=0,this.__textStyle=""}afterCloneFrom(t){super.afterCloneFrom(t),this.__key===t.__key&&(this.__first=t.__first,this.__last=t.__last,this.__size=t.__size),this.__indent=t.__indent,this.__format=t.__format,this.__style=t.__style,this.__dir=t.__dir,this.__textFormat=t.__textFormat,this.__textStyle=t.__textStyle}getFormat(){return this.getLatest().__format}getFormatType(){const t=this.getFormat();return qL[t]||""}getStyle(){return this.getLatest().__style}getIndent(){return this.getLatest().__indent}getChildren(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getChildrenKeys(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r.__key),r=r.getNextSibling();return t}getChildrenSize(){return this.getLatest().__size}isEmpty(){return this.getChildrenSize()===0}isDirty(){const t=rs()._dirtyElements;return t!==null&&t.has(this.__key)}isLastChild(){const t=this.getLatest(),r=this.getParentOrThrow().getLastChild();return r!==null&&r.is(t)}getAllTextNodes(){const t=[];let r=this.getFirstChild();for(;r!==null;){if(Gt(r)&&t.push(r),yt(r)){const n=r.getAllTextNodes();t.push(...n)}r=r.getNextSibling()}return t}getFirstDescendant(){let t=this.getFirstChild();for(;yt(t);){const r=t.getFirstChild();if(r===null)break;t=r}return t}getLastDescendant(){let t=this.getLastChild();for(;yt(t);){const r=t.getLastChild();if(r===null)break;t=r}return t}getDescendantByIndex(t){const r=this.getChildren(),n=r.length;if(t>=n){const a=r[n-1];return yt(a)&&a.getLastDescendant()||a||null}const s=r[t];return yt(s)&&s.getFirstDescendant()||s||null}getFirstChild(){const t=this.getLatest().__first;return t===null?null:Os(t)}getFirstChildOrThrow(){const t=this.getFirstChild();return t===null&&Pt(45,this.__key),t}getLastChild(){const t=this.getLatest().__last;return t===null?null:Os(t)}getLastChildOrThrow(){const t=this.getLastChild();return t===null&&Pt(96,this.__key),t}getChildAtIndex(t){const r=this.getChildrenSize();let n,s;if(t<r/2){for(n=this.getFirstChild(),s=0;n!==null&&s<=t;){if(s===t)return n;n=n.getNextSibling(),s++}return null}for(n=this.getLastChild(),s=r-1;n!==null&&s>=t;){if(s===t)return n;n=n.getPreviousSibling(),s--}return null}getTextContent(){let t="";const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContent(),yt(a)&&s!==n-1&&!a.isInline()&&(t+=jc)}return t}getTextContentSize(){let t=0;const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContentSize(),yt(a)&&s!==n-1&&!a.isInline()&&(t+=jc.length)}return t}getDirection(){return this.getLatest().__dir}getTextFormat(){return this.getLatest().__textFormat}hasFormat(t){if(t!==""){const r=m4[t];return!!(this.getFormat()&r)}return!1}hasTextFormat(t){const r=rf[t];return!!(this.getTextFormat()&r)}getFormatFlags(t,r){return i1(this.getLatest().__textFormat,t,r)}getTextStyle(){return this.getLatest().__textStyle}select(t,r){Ca();const n=Ht();let s=t,a=r;const i=this.getChildrenSize();if(!this.canBeEmpty()){if(t===0&&r===0){const c=this.getFirstChild();if(Gt(c)||yt(c))return c.select(0,0)}else if(!(t!==void 0&&t!==i||r!==void 0&&r!==i)){const c=this.getLastChild();if(Gt(c)||yt(c))return c.select()}}s===void 0&&(s=i),a===void 0&&(a=i);const l=this.__key;return Tt(n)?(n.anchor.set(l,s,"element"),n.focus.set(l,a,"element"),n.dirty=!0,n):SA(l,s,l,a,"element","element")}selectStart(){const t=this.getFirstDescendant();return t?t.selectStart():this.select()}selectEnd(){const t=this.getLastDescendant();return t?t.selectEnd():this.select()}clear(){const t=this.getWritable();return this.getChildren().forEach((r=>r.remove())),t}append(...t){return this.splice(this.getChildrenSize(),0,t)}setDirection(t){const r=this.getWritable();return r.__dir=t,r}setFormat(t){return this.getWritable().__format=t!==""?m4[t]:0,this}setStyle(t){return this.getWritable().__style=t||"",this}setTextFormat(t){const r=this.getWritable();return r.__textFormat=t,r}setTextStyle(t){const r=this.getWritable();return r.__textStyle=t,r}setIndent(t){return this.getWritable().__indent=t,this}splice(t,r,n){const s=n.length,a=this.getChildrenSize(),i=this.getWritable();t+r<=a||Pt(226,String(t),String(r),String(a));const l=i.__key,c=[],d=[],f=this.getChildAtIndex(t+r);let p=null,g=a-r+s;if(t!==0)if(t===a)p=this.getLastChild();else{const v=this.getChildAtIndex(t);v!==null&&(p=v.getPreviousSibling())}if(r>0){let v=p===null?this.getFirstChild():p.getNextSibling();for(let _=0;_<r;_++){v===null&&Pt(100);const b=v.getNextSibling(),N=v.__key;Kd(v.getWritable()),d.push(N),v=b}}let y=p;for(let v=0;v<s;v++){const _=n[v];y!==null&&_.is(y)&&(p=y=y.getPreviousSibling());const b=_.getWritable();b.__parent===l&&g--,Kd(b);const N=_.__key;if(y===null)i.__first=N,b.__prev=null;else{const k=y.getWritable();k.__next=N,b.__prev=k.__key}_.__key===l&&Pt(76),b.__parent=l,c.push(N),y=_}if(t+r===a)y!==null&&(y.getWritable().__next=null,i.__last=y.__key);else if(f!==null){const v=f.getWritable();if(y!==null){const _=y.getWritable();v.__prev=y.__key,_.__next=f.__key}else v.__prev=null}if(i.__size=g,d.length){const v=Ht();if(Tt(v)){const _=new Set(d),b=new Set(c),{anchor:N,focus:k}=v;X4(N,_,b)&&s1(N,N.getNode(),this,p,f),X4(k,_,b)&&s1(k,k.getNode(),this,p,f),g!==0||this.canBeEmpty()||fi(this)||this.remove()}}return i}getDOMSlot(t){return new Om(t)}exportDOM(t){const{element:r}=super.exportDOM(t);if($n(r)){const n=this.getIndent();n>0&&(r.style.paddingInlineStart=40*n+"px");const s=this.getDirection();s&&(r.dir=s)}return{element:r}}exportJSON(){const t={children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),...super.exportJSON()},r=this.getTextFormat(),n=this.getTextStyle();return r!==0&&(t.textFormat=r),n!==""&&(t.textStyle=n),t}updateFromJSON(t){return super.updateFromJSON(t).setFormat(t.format).setIndent(t.indent).setDirection(t.direction).setTextFormat(t.textFormat||0).setTextStyle(t.textStyle||"")}insertNewAfter(t,r){return null}canIndent(){return!0}collapseAtStart(t){return!1}excludeFromCopy(t){return!1}canReplaceWith(t){return!0}canInsertAfter(t){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(t){return!1}extractWithChild(t,r,n){return!1}canMergeWhenEmpty(){return!1}reconcileObservedMutation(t,r){const n=this.getDOMSlot(t);let s=n.getFirstChild();for(let a=this.getFirstChild();a;a=a.getNextSibling()){const i=r.getElementByKey(a.getKey());i!==null&&(s==null?(n.insertChild(i),s=i):s!==i&&n.replaceChild(i,s),s=s.nextSibling)}}}function yt(e){return e instanceof Ka}function X4(e,t,r){let n=e.getNode();for(;n;){const s=n.__key;if(t.has(s)&&!r.has(s))return!0;n=n.getParent()}return!1}class Eb extends S0{decorate(t,r){Pt(47)}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function nn(e){return e instanceof Eb}class Ip extends Ka{static getType(){return"root"}static clone(){return new Ip}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){Pt(51)}getTextContent(){const t=this.__cachedText;return!Dp()&&rs()._dirtyType!==tf||t===null?super.getTextContent():t}remove(){Pt(52)}replace(t){Pt(53)}insertBefore(t){Pt(54)}insertAfter(t){Pt(55)}updateDOM(t,r){return!1}splice(t,r,n){for(const s of n)yt(s)||nn(s)||Pt(282);return super.splice(t,r,n)}static importJSON(t){return qn().updateFromJSON(t)}collapseAtStart(){return!0}}function qs(e){return e instanceof Ip}function NA(e){return new G1(new Map(e._nodeMap))}function Nb(){return new G1(new Map([["root",new Ip]]))}function AA(e){const t=e.exportJSON(),r=e.constructor;if(t.type!==r.getType()&&Pt(130,r.name),yt(e)){const n=t.children;Array.isArray(n)||Pt(59,r.name);const s=e.getChildren();for(let a=0;a<s.length;a++){const i=AA(s[a]);n.push(i)}}return t}class G1{constructor(t,r){this._nodeMap=t,this._selection=r||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(t,r){return V4(r&&r.editor||null,this,t)}clone(t){const r=new G1(this._nodeMap,t===void 0?this._selection:t);return r._readOnly=!0,r}toJSON(){return V4(null,this,(()=>({root:AA(qn())})))}}const a1="historic",DB="history-push",Lm="history-merge",IB="paste",jA="collaboration",MB="skip-scroll-into-view",OB="skip-dom-selection";class Ab extends Ka{static getType(){return"artificial"}createDOM(t){return document.createElement("div")}}class Mp extends Ka{static getType(){return"paragraph"}static clone(t){return new Mp(t.__key)}createDOM(t){const r=document.createElement("p"),n=Qh(t.theme,"paragraph");return n!==void 0&&r.classList.add(...n),r}updateDOM(t,r,n){return!1}static importDOM(){return{p:t=>({conversion:LB,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if($n(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n)}return{element:r}}static importJSON(t){return Un().updateFromJSON(t)}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle()}}insertNewAfter(t,r){const n=Un();n.setTextFormat(t.format),n.setTextStyle(t.style);const s=this.getDirection();return n.setDirection(s),n.setFormat(this.getFormatType()),n.setStyle(this.getStyle()),this.insertAfter(n,r),n}collapseAtStart(){const t=this.getChildren();if(t.length===0||Gt(t[0])&&t[0].getTextContent().trim()===""){if(this.getNextSibling()!==null)return this.selectNext(),this.remove(),!0;if(this.getPreviousSibling()!==null)return this.selectPrevious(),this.remove(),!0}return!1}}function LB(e){const t=Un();return e.style&&(t.setFormat(e.style.textAlign),$b(e,t)),{node:t}}function Un(){return gi(new Mp)}function jb(e){return e instanceof Mp}const Yr=0,Ih=1,BB=4;function FA(e,t,r,n){const s=e._keyToDOMMap;s.clear(),e._editorState=Nb(),e._pendingEditorState=n,e._compositionKey=null,e._dirtyType=tf,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),e._normalizedNodes=new Set,e._updateTags=new Set,e._updates=[],e._blockCursorElement=null;const a=e._observer;a!==null&&(a.disconnect(),e._observer=null),t!==null&&(t.textContent=""),r!==null&&(r.textContent="",s.set("root",r))}function UB(e){const t=e||{},r=PB(),n=t.theme||{},s=e===void 0?r:t.parentEditor||null,a=t.disableEvents||!1,i=Nb(),l=t.namespace||(s!==null?s._config.namespace:BA()),c=t.editorState,d=[Ip,Xu,Pp,Rp,Mp,Ab,...t.nodes||[]],{onError:f,html:p}=t,g=t.editable===void 0||t.editable;let y;if(e===void 0&&r!==null)y=r._nodes;else{y=new Map;for(let _=0;_<d.length;_++){let b=d[_],N=null,k=null;if(typeof b!="function"){const R=b;b=R.replace,N=R.with,k=R.withKlass||null}const{ownNodeConfig:w}=Wb(b),T=b.getType(),A=b.transform(),F=new Set;w&&w.$transform&&F.add(w.$transform),A!==null&&F.add(A),y.set(T,{exportDOM:p&&p.export?p.export.get(b):void 0,klass:b,replace:N,replaceWithKlass:k,sharedNodeState:rB(d[_]),transforms:F})}}const v=new V1(i,s,y,{disableEvents:a,namespace:l,theme:n},f||console.error,(function(_,b){const N=new Map,k=new Set,w=T=>{Object.keys(T).forEach((A=>{let F=N.get(A);F===void 0&&(F=[],N.set(A,F)),F.push(T[A])}))};return _.forEach((T=>{const A=T.klass.importDOM;if(A==null||k.has(A))return;k.add(A);const F=A.call(T.klass);F!==null&&w(F)})),b&&w(b),N})(y,p?p.import:void 0),g,e);return c!==void 0&&(v._pendingEditorState=c,v._dirtyType=c0),v}class V1{constructor(t,r,n,s,a,i,l,c){this._createEditorArgs=c,this._parentEditor=r,this._rootElement=null,this._editorState=t,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=s,this._nodes=n,this._decorators={},this._pendingDecorators=null,this._dirtyType=tf,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=BA(),this._onError=a,this._htmlConversions=i,this._editable=l,this._headless=r!==null&&r._headless,this._window=null,this._blockCursorElement=null}isComposing(){return this._compositionKey!=null}registerUpdateListener(t){const r=this._listeners.update;return r.add(t),()=>{r.delete(t)}}registerEditableListener(t){const r=this._listeners.editable;return r.add(t),()=>{r.delete(t)}}registerDecoratorListener(t){const r=this._listeners.decorator;return r.add(t),()=>{r.delete(t)}}registerTextContentListener(t){const r=this._listeners.textcontent;return r.add(t),()=>{r.delete(t)}}registerRootListener(t){const r=this._listeners.root;return t(this._rootElement,null),r.add(t),()=>{t(null,this._rootElement),r.delete(t)}}registerCommand(t,r,n){n===void 0&&Pt(35);const s=this._commands;s.has(t)||s.set(t,[new Set,new Set,new Set,new Set,new Set]);const a=s.get(t);a===void 0&&Pt(36,String(t));const i=a[n];return i.add(r),()=>{i.delete(r),a.every((l=>l.size===0))&&s.delete(t)}}registerMutationListener(t,r,n){const s=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(t)).klass,a=this._listeners.mutation;let i=a.get(r);i===void 0&&(i=new Set,a.set(r,i)),i.add(s);const l=n&&n.skipInitialization;return l!==void 0&&l||this.initializeMutationListener(r,s),()=>{i.delete(s),i.size===0&&a.delete(r)}}getRegisteredNode(t){const r=this._nodes.get(t.getType());return r===void 0&&Pt(37,t.name),r}resolveRegisteredNodeAfterReplacements(t){for(;t.replaceWithKlass;)t=this.getRegisteredNode(t.replaceWithKlass);return t}initializeMutationListener(t,r){const n=this._editorState,s=sE(n).get(r.getType());if(!s)return;const a=new Map;for(const i of s.keys())a.set(i,"created");a.size>0&&t(a,{dirtyLeaves:new Set,prevEditorState:n,updateTags:new Set(["registerMutationListener"])})}registerNodeTransformToKlass(t,r){const n=this.getRegisteredNode(t);return n.transforms.add(r),n}registerNodeTransform(t,r){const n=this.registerNodeTransformToKlass(t,r),s=[n],a=n.replaceWithKlass;if(a!=null){const i=this.registerNodeTransformToKlass(a,r);s.push(i)}return(function(i,l){const c=sE(i.getEditorState()),d=[];for(const f of l){const p=c.get(f);p&&d.push(p)}d.length!==0&&i.update((()=>{for(const f of d)for(const p of f.keys()){const g=Os(p);g&&g.markDirty()}}),i._pendingEditorState===null?{tag:Lm}:void 0)})(this,s.map((i=>i.klass.getType()))),()=>{s.forEach((i=>i.transforms.delete(r)))}}hasNode(t){return this._nodes.has(t.getType())}hasNodes(t){return t.every(this.hasNode.bind(this))}dispatchCommand(t,r){return nr(this,t,r)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(t){const r=this._rootElement;if(t!==r){const n=Qh(this._config.theme,"root"),s=this._pendingEditorState||this._editorState;if(this._rootElement=t,FA(this,r,t,s),r!==null&&(this._config.disableEvents||wB(r),n!=null&&r.classList.remove(...n)),t!==null){const a=Bb(t),i=t.style;i.userSelect="text",i.whiteSpace="pre-wrap",i.wordBreak="break-word",t.setAttribute("data-lexical-editor","true"),this._window=a,this._dirtyType=c0,H6(this),this._updateTags.add(Lm),_c(this),this._config.disableEvents||(function(l,c){const d=l.ownerDocument,f=r1.get(d);(f===void 0||f<1)&&d.addEventListener("selectionchange",yA),r1.set(d,(f||0)+1),l.__lexicalEditor=c;const p=xA(l);for(let g=0;g<B_.length;g++){const[y,v]=B_[g],_=typeof v=="function"?b=>{j4(b)||(A4(b),(c.isEditable()||y==="click")&&v(b,c))}:b=>{if(j4(b))return;A4(b);const N=c.isEditable();switch(y){case"cut":return N&&nr(c,bb,b);case"copy":return nr(c,U1,b);case"paste":return N&&nr(c,vb,b);case"dragstart":return N&&nr(c,cA,b);case"dragover":return N&&nr(c,uA,b);case"dragend":return N&&nr(c,gB,b);case"focus":return N&&nr(c,xB,b);case"blur":return N&&nr(c,yB,b);case"drop":return N&&nr(c,oA,b)}};l.addEventListener(y,_),p.push((()=>{l.removeEventListener(y,_)}))}})(t,this),n!=null&&t.classList.add(...n)}else this._window=null,this._updateTags.add(Lm),_c(this);Mm("root",this,!1,t,r)}}getElementByKey(t){return this._keyToDOMMap.get(t)||null}getEditorState(){return this._editorState}setEditorState(t,r){t.isEmpty()&&Pt(38);let n=t;n._readOnly&&(n=NA(t),n._selection=t._selection?t._selection.clone():null),z6(this);const s=this._pendingEditorState,a=this._updateTags,i=r!==void 0?r.tag:null;s===null||s.isEmpty()||(i!=null&&a.add(i),_c(this)),this._pendingEditorState=n,this._dirtyType=c0,this._dirtyElements.set("root",!1),this._compositionKey=null,i!=null&&a.add(i),this._updating||_c(this)}parseEditorState(t,r){return(function(n,s,a){const i=Nb(),l=aa,c=Ai,d=ia,f=s._dirtyElements,p=s._dirtyLeaves,g=s._cloneNotNeeded,y=s._dirtyType;s._dirtyElements=new Map,s._dirtyLeaves=new Set,s._cloneNotNeeded=new Set,s._dirtyType=0,aa=i,Ai=!1,ia=s,Fb(null);try{const v=s._nodes;Tb(n.root,v),a&&a(),i._readOnly=!0}catch(v){v instanceof Error&&s._onError(v)}finally{s._dirtyElements=f,s._dirtyLeaves=p,s._cloneNotNeeded=g,s._dirtyType=y,aa=l,Ai=c,ia=d}return i})(typeof t=="string"?JSON.parse(t):t,this,r)}read(t){return _c(this),this.getEditorState().read(t,{editor:this})}update(t,r){(function(n,s,a){n._updating?n._updates.push([s,a]):H1(n,s,a)})(this,t,r)}focus(t,r={}){const n=this._rootElement;n!==null&&(n.setAttribute("autocapitalize","off"),Wi(this,(()=>{const s=Ht(),a=qn();s!==null?s.dirty||Aa(s.clone()):a.getChildrenSize()!==0&&(r.defaultSelection==="rootStart"?a.selectStart():a.selectEnd()),KB("focus"),qB((()=>{n.removeAttribute("autocapitalize"),t&&t()}))})),this._pendingEditorState===null&&n.removeAttribute("autocapitalize"))}blur(){const t=this._rootElement;t!==null&&t.blur();const r=el(this._window);r!==null&&r.removeAllRanges()}isEditable(){return this._editable}setEditable(t){this._editable!==t&&(this._editable=t,Mm("editable",this,!0,t))}toJSON(){return{editorState:this._editorState.toJSON()}}}V1.version="0.35.0+prod.esm";let G_=null;function Fb(e){G_=e}let $B=1;function PA(e,t){const r=Pb(e,t);return r===void 0&&Pt(30,t),r}function Pb(e,t){return e._nodes.get(t)}const WB=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)};function Y4(e){return nn(Uu(e))}function Rb(e){const t=document.activeElement;if(!$n(t))return!1;const r=t.nodeName;return nn(Uu(e))&&(r==="INPUT"||r==="TEXTAREA"||t.contentEditable==="true"&&K1(t)==null)}function Op(e,t,r){const n=e.getRootElement();try{return n!==null&&n.contains(t)&&n.contains(r)&&t!==null&&!Rb(t)&&RA(t)===e}catch{return!1}}function Db(e){return e instanceof V1}function RA(e){let t=e;for(;t!=null;){const r=K1(t);if(Db(r))return r;t=Lp(t)}return null}function K1(e){return e?e.__lexicalEditor:null}function Vd(e){return $1(e)||e.isToken()}function vc(e){return Vd(e)||e.isSegmented()}function Rc(e){return T0(e)&&e.nodeType===BL}function zB(e){return T0(e)&&e.nodeType===UL}function u0(e){let t=e;for(;t!=null;){if(Rc(t))return t;t=t.firstChild}return null}function i1(e,t,r){const n=rf[t];if(r!==null&&(e&n)==(r&n))return e;let s=e^n;return t==="subscript"?s&=-65:t==="superscript"?s&=-33:t==="lowercase"?(s&=-513,s&=-1025):t==="uppercase"?(s&=-257,s&=-1025):t==="capitalize"&&(s&=-257,s&=-513),s}function DA(e){return Gt(e)||kc(e)||nn(e)}function HB(e,t){const r=(function(){const i=G_;return G_=null,i})();if((t=t||r&&r.__key)!=null)return void(e.__key=t);Ca(),CA();const n=rs(),s=Yu(),a=""+$B++;s._nodeMap.set(a,e),yt(e)?n._dirtyElements.set(a,!0):n._dirtyLeaves.add(a),n._cloneNotNeeded.add(a),n._dirtyType=U6,e.__key=a}function Kd(e){const t=e.getParent();if(t!==null){const r=e.getWritable(),n=t.getWritable(),s=e.getPreviousSibling(),a=e.getNextSibling(),i=a!==null?a.__key:null,l=s!==null?s.__key:null,c=s!==null?s.getWritable():null,d=a!==null?a.getWritable():null;s===null&&(n.__first=i),a===null&&(n.__last=l),c!==null&&(c.__next=i),d!==null&&(d.__prev=l),r.__prev=null,r.__next=null,r.__parent=null,n.__size--}}function o1(e){CA();const t=e.getLatest(),r=t.__parent,n=Yu(),s=rs(),a=n._nodeMap,i=s._dirtyElements;r!==null&&(function(c,d,f){let p=c;for(;p!==null;){if(f.has(p))return;const g=d.get(p);if(g===void 0)break;f.set(p,!1),p=g.__parent}})(r,a,i);const l=t.__key;s._dirtyType=U6,yt(e)?i.set(l,!0):s._dirtyLeaves.add(l)}function Ta(e){Ca();const t=rs(),r=t._compositionKey;if(e!==r){if(t._compositionKey=e,r!==null){const n=Os(r);n!==null&&n.getWritable()}if(e!==null){const n=Os(e);n!==null&&n.getWritable()}}}function Nu(){return Dp()?null:rs()._compositionKey}function Os(e,t){const r=(t||Yu())._nodeMap.get(e);return r===void 0?null:r}function IA(e,t){const r=q1(e,rs());return r!==void 0?Os(r,t):null}function q1(e,t){return e[`__lexicalKey_${t._key}`]}function Uu(e,t){let r=e;for(;r!=null;){const n=IA(r,t);if(n!==null)return n;r=Lp(r)}return null}function MA(e){const t=e._decorators,r=Object.assign({},t);return e._pendingDecorators=r,r}function J4(e){return e.read((()=>qn().getTextContent()))}function qn(){return OA(Yu())}function OA(e){return e._nodeMap.get("root")}function Aa(e){Ca();const t=Yu();e!==null&&(e.dirty=!0,e.setCachedNodes(null)),t._selection=e}function Gh(e){const t=rs(),r=(function(n,s){let a=n;for(;a!=null;){const i=q1(a,s);if(i!==void 0)return i;a=Lp(a)}return null})(e,t);return r===null?e===t.getRootElement()?Os("root"):null:Os(r)}function LA(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(e)}function Ib(e){const t=[];let r=e;for(;r!==null;)t.push(r),r=r._parentEditor;return t}function BA(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,5)}function UA(e){return Rc(e)?e.nodeValue:null}function Mb(e,t,r){const n=el(So(t));if(n===null)return;const s=n.anchorNode;let{anchorOffset:a,focusOffset:i}=n;if(s!==null){let l=UA(s);const c=Uu(s);if(l!==null&&Gt(c)){if(l===L1&&r){const d=r.length;l=r,a=d,i=d}l!==null&&Ob(c,l,a,i,e)}}}function Ob(e,t,r,n,s){let a=e;if(a.isAttached()&&(s||!a.isDirty())){const i=a.isComposing();let l=t;(i||s)&&t[t.length-1]===L1&&(l=t.slice(0,-1));const c=a.getTextContent();if(s||l!==c){if(l===""){if(Ta(null),rp||l0||Ky)a.remove();else{const _=rs();setTimeout((()=>{_.update((()=>{a.isAttached()&&a.remove()}))}),20)}return}const d=a.getParent(),f=C0(),p=a.getTextContentSize(),g=Nu(),y=a.getKey();if(a.isToken()||g!==null&&y===g&&!i||Tt(f)&&(d!==null&&!d.canInsertTextBefore()&&f.anchor.offset===0||f.anchor.key===e.__key&&f.anchor.offset===0&&!a.canInsertTextBefore()&&!i||f.focus.key===e.__key&&f.focus.offset===p&&!a.canInsertTextAfter()&&!i))return void a.markDirty();const v=Ht();if(!Tt(v)||r===null||n===null)return void Q4(a,l,v);if(v.setTextNodeRange(a,r,a,n),a.isSegmented()){const _=cs(a.getTextContent());a.replace(_),a=_}Q4(a,l,v)}}}function Q4(e,t,r){if(e.setTextContent(t),Tt(r)){const n=e.getKey();for(const s of["anchor","focus"]){const a=r[s];a.type==="text"&&a.key===n&&(a.offset=Iu(e,a.offset,"clamp"))}}}function fy(e,t,r){const n=t[r]||!1;return n==="any"||n===e[r]}function GB(e,t){return fy(e,t,"altKey")&&fy(e,t,"ctrlKey")&&fy(e,t,"shiftKey")&&fy(e,t,"metaKey")}function gn(e,t,r){return GB(e,r)&&e.key.toLowerCase()===t.toLowerCase()}const yc={ctrlKey:!Al,metaKey:Al},Z4={altKey:Al,ctrlKey:!Al};function eE(e){return e.key==="Backspace"}function tE(e){return gn(e,"a",yc)}function VB(e){const t=qn();if(Tt(e)){const r=e.anchor,n=e.focus,s=r.getNode().getTopLevelElementOrThrow().getParentOrThrow();return r.set(s.getKey(),0,"element"),n.set(s.getKey(),s.getChildrenSize(),"element"),Yy(e),e}{const r=t.select(0,t.getChildrenSize());return Aa(Yy(r)),r}}function Qh(e,t){e.__lexicalClassNameCache===void 0&&(e.__lexicalClassNameCache={});const r=e.__lexicalClassNameCache,n=r[t];if(n!==void 0)return n;const s=e[t];if(typeof s=="string"){const a=B6(s);return r[t]=a,a}return s}function Lb(e,t,r,n,s){if(r.size===0)return;const a=n.__type,i=n.__key,l=t.get(a);l===void 0&&Pt(33,a);const c=l.klass;let d=e.get(c);d===void 0&&(d=new Map,e.set(c,d));const f=d.get(i),p=f==="destroyed"&&s==="created";(f===void 0||p)&&d.set(i,p?"updated":s)}function rE(e,t,r){const n=e.getParent();let s=r,a=e;return n!==null&&(t&&r===0?(s=a.getIndexWithinParent(),a=n):t||r!==a.getChildrenSize()||(s=a.getIndexWithinParent()+1,a=n)),a.getChildAtIndex(t?s-1:s)}function V_(e,t){const r=e.offset;if(e.type==="element")return rE(e.getNode(),t,r);{const n=e.getNode();if(t&&r===0||!t&&r===n.getTextContentSize()){const s=t?n.getPreviousSibling():n.getNextSibling();return s===null?rE(n.getParentOrThrow(),t,n.getIndexWithinParent()+(t?0:1)):s}}return null}function $A(e){const t=So(e).event,r=t&&t.inputType;return r==="insertFromPaste"||r==="insertFromPasteAsQuotation"}function nr(e,t,r){return(function(n,s,a){const i=Ib(n);for(let l=4;l>=0;l--)for(let c=0;c<i.length;c++){const d=i[c],f=d._commands.get(s);if(f!==void 0){const p=f[l];if(p!==void 0){const g=Array.from(p),y=g.length;let v=!1;if(Wi(d,(()=>{for(let _=0;_<y;_++)if(g[_](a,n))return void(v=!0)})),v)return v}}}return!1})(e,t,r)}function X1(e){return!qs(e)&&!e.isLastChild()&&!e.isInline()}function af(e,t){const r=e._keyToDOMMap.get(t);return r===void 0&&Pt(75,t),r}function Lp(e){const t=e.assignedSlot||e.parentElement;return X_(t)?t.host:t}function WA(e){return zB(e)?e:$n(e)?e.ownerDocument:null}function KB(e){Ca(),rs()._updateTags.add(e)}function qB(e){Ca(),rs()._deferred.push(e)}function K_(e,t){let r=e.getParent();for(;r!==null;){if(r.is(t))return!0;r=r.getParent()}return!1}function Bb(e){const t=WA(e);return t?t.defaultView:null}function So(e){const t=e._window;return t===null&&Pt(78),t}function XB(e){return yt(e)&&e.isInline()||nn(e)&&e.isInline()}function YB(e){let t=e.getParentOrThrow();for(;t!==null;){if(fi(t))return t;t=t.getParentOrThrow()}return t}function fi(e){return qs(e)||yt(e)&&e.isShadowRoot()}function gi(e){const t=rs(),r=e.getType(),n=Pb(t,r);n===void 0&&Pt(200,e.constructor.name,r);const{replace:s,replaceWithKlass:a}=n;if(s!==null){const i=s(e),l=i.constructor;return a!==null?i instanceof a||Pt(201,a.name,a.getType(),l.name,l.getType(),e.constructor.name,r):i instanceof e.constructor&&l!==e.constructor||Pt(202,l.name,l.getType(),e.constructor.name,r),i.__key===e.__key&&Pt(203,e.constructor.name,r,l.name,l.getType()),i}return e}function jw(e,t){!qs(e.getParent())||yt(t)||nn(t)||Pt(99)}function JB(e){const t=Os(e);return t===null&&Pt(63,e),t}function Fw(e){return(nn(e)||yt(e)&&!e.canBeEmpty())&&!e.isInline()}function q_(e,t,r){r.style.removeProperty("caret-color"),t._blockCursorElement=null;const n=e.parentElement;n!==null&&n.removeChild(e)}function el(e){return tl?(e||window).getSelection():null}function QB(e){const t=Bb(e);return t?t.getSelection():null}function zA(e){return $n(e)&&e.tagName==="A"}function $n(e){return T0(e)&&e.nodeType===LL}function T0(e){return typeof e=="object"&&e!==null&&"nodeType"in e&&typeof e.nodeType=="number"}function X_(e){return T0(e)&&e.nodeType===$L}function Y_(e){const t=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|mark|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return e.nodeName.match(t)!==null}function l1(e){const t=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return e.nodeName.match(t)!==null}function vo(e){if(nn(e)&&!e.isInline())return!0;if(!yt(e)||fi(e))return!1;const t=e.getFirstChild(),r=t===null||kc(t)||Gt(t)||t.isInline();return!e.isInline()&&e.canBeEmpty()!==!1&&r}function Pw(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function Bp(){return rs()}const nE=new WeakMap,ZB=new Map;function sE(e){if(!e._readOnly&&e.isEmpty())return ZB;e._readOnly||Pt(192);let t=nE.get(e);return t||(t=(function(r){const n=new Map;for(const[s,a]of r._nodeMap){const i=a.__type;let l=n.get(i);l||(l=new Map,n.set(i,l)),l.set(s,a)}return n})(e),nE.set(e,t)),t}function Ub(e){const t=e.constructor.clone(e);return t.afterCloneFrom(e),t}function $b(e,t){const r=parseInt(e.style.paddingInlineStart,10)||0,n=Math.round(r/40);t.setIndent(n)}function eU(e){e.__lexicalUnmanaged=!0}function tU(e){return e.__lexicalUnmanaged===!0}function xm(e,t){return(function(r,n){return Object.prototype.hasOwnProperty.call(r,n)})(e,t)&&e[t]!==S0[t]}function Wb(e){const t=p4 in e.prototype?e.prototype[p4]():void 0,r=(function(i){return i===Eb||i===Ka||i===S0})(e),n=!r&&xm(e,"getType")?e.getType():void 0;let s,a=n;if(t)if(n)s=t[n];else for(const[i,l]of Object.entries(t))a=i,s=l;if(!r&&a&&(xm(e,"getType")||(e.getType=()=>a),xm(e,"clone")||(e.clone=i=>(Fb(i),new e)),xm(e,"importJSON")||(e.importJSON=s&&s.$importJSON||(i=>new e().updateFromJSON(i))),!xm(e,"importDOM")&&s)){const{importDOM:i}=s;i&&(e.importDOM=()=>i)}return{ownNodeConfig:s,ownNodeType:a}}function rU(e){const t=Bp();return Ca(),new(t.resolveRegisteredNodeAfterReplacements(t.getRegisteredNode(e))).klass}const nU={next:"previous",previous:"next"};class zb{constructor(t){this.origin=t}[Symbol.iterator](){return qb({hasNext:cf,initial:this.getAdjacentCaret(),map:t=>t,step:t=>t.getAdjacentCaret()})}getAdjacentCaret(){return Na(this.getNodeAtCaret(),this.direction)}getSiblingCaret(){return Na(this.origin,this.direction)}remove(){const t=this.getNodeAtCaret();return t&&t.remove(),this}replaceOrInsert(t,r){const n=this.getNodeAtCaret();return t.is(this.origin)||t.is(n)||(n===null?this.insert(t):n.replace(t,r)),this}splice(t,r,n="next"){const s=n===this.direction?r:Array.from(r).reverse();let a=this;const i=this.getParentAtCaret(),l=new Map;for(let c=a.getAdjacentCaret();c!==null&&l.size<t;c=c.getAdjacentCaret()){const d=c.origin.getWritable();l.set(d.getKey(),d)}for(const c of s){if(l.size>0){const d=a.getNodeAtCaret();if(d){if(l.delete(d.getKey()),l.delete(c.getKey()),!(d.is(c)||a.origin.is(c))){const f=c.getParent();f&&f.is(i)&&c.remove(),d.replace(c)}}else d===null&&Pt(263,Array.from(l).join(" "))}else a.insert(c);a=Na(c,this.direction)}for(const c of l.values())c.remove();return this}}class lp extends zb{type="child";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:ko(t,this.direction)}getParentCaret(t="root"){return Na(Hb(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=E0(this.direction);return Na(this.getNodeAtCaret(),t)||ko(this.origin,t)}getParentAtCaret(){return this.origin}getChildCaret(){return this}isSameNodeCaret(t){return t instanceof lp&&this.direction===t.direction&&this.origin.is(t.origin)}isSamePointCaret(t){return this.isSameNodeCaret(t)}}const sU={root:qs,shadowRoot:fi};function E0(e){return nU[e]}function Hb(e,t="root"){return sU[t](e)?null:e}class of extends zb{type="sibling";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:Na(t,this.direction)}getSiblingCaret(){return this}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return yt(this.origin)?ko(this.origin,this.direction):null}getParentCaret(t="root"){return Na(Hb(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=E0(this.direction);return Na(this.getNodeAtCaret(),t)||ko(this.origin.getParentOrThrow(),t)}isSamePointCaret(t){return t instanceof of&&this.direction===t.direction&&this.origin.is(t.origin)}isSameNodeCaret(t){return(t instanceof of||t instanceof lf)&&this.direction===t.direction&&this.origin.is(t.origin)}}class lf extends zb{type="text";constructor(t,r){super(t),this.offset=r}getLatest(){const t=this.origin.getLatest();return t===this.origin?this:uf(t,this.direction,this.offset)}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return null}getParentCaret(t="root"){return Na(Hb(this.getParentAtCaret(),t),this.direction)}getFlipped(){return uf(this.origin,E0(this.direction),this.offset)}isSamePointCaret(t){return t instanceof lf&&this.direction===t.direction&&this.origin.is(t.origin)&&this.offset===t.offset}isSameNodeCaret(t){return(t instanceof of||t instanceof lf)&&this.direction===t.direction&&this.origin.is(t.origin)}getSiblingCaret(){return Na(this.origin,this.direction)}}function Du(e){return e instanceof lf}function cf(e){return e instanceof of}function Ml(e){return e instanceof lp}const aU={next:class extends lf{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends lf{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},iU={next:class extends of{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends of{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},oU={next:class extends lp{direction="next";getNodeAtCaret(){return this.origin.getFirstChild()}insert(e){return this.origin.splice(0,0,[e]),this}},previous:class extends lp{direction="previous";getNodeAtCaret(){return this.origin.getLastChild()}insert(e){return this.origin.splice(this.origin.getChildrenSize(),0,[e]),this}}};function Na(e,t){return e?new iU[t](e):null}function uf(e,t,r){return e?new aU[t](e,Iu(e,r)):null}function Iu(e,t,r="error"){const n=e.getTextContentSize();let s=t==="next"?n:t==="previous"?0:t;return(s<0||s>n)&&(r!=="clamp"&&(function(a,...i){const l=new URL("https://lexical.dev/docs/error"),c=new URLSearchParams;c.append("code",a);for(const d of i)c.append("v",d);l.search=c.toString(),console.warn(`Minified Lexical warning #${a}; visit ${l.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(284,String(t),String(n),e.getKey()),s=s<0?0:n),s}function aE(e,t){return new cU(e,t)}function ko(e,t){return yt(e)?new oU[t](e):null}function lU(e){return e&&e.getChildCaret()||e}function Gb(e){return e&&lU(e.getAdjacentCaret())}class Vb{type="node-caret-range";constructor(t,r,n){this.anchor=t,this.focus=r,this.direction=n}getLatest(){const t=this.anchor.getLatest(),r=this.focus.getLatest();return t===this.anchor&&r===this.focus?this:new Vb(t,r,this.direction)}isCollapsed(){return this.anchor.isSamePointCaret(this.focus)}getTextSlices(){const t=s=>{const a=this[s].getLatest();return Du(a)?(function(i,l){const{direction:c,origin:d}=i,f=Iu(d,l==="focus"?E0(c):c);return aE(i,f-i.offset)})(a,s):null},r=t("anchor"),n=t("focus");if(r&&n){const{caret:s}=r,{caret:a}=n;if(s.isSameNodeCaret(a))return[aE(s,a.offset-s.offset),null]}return[r,n]}iterNodeCarets(t="root"){const r=Du(this.anchor)?this.anchor.getSiblingCaret():this.anchor.getLatest(),n=this.focus.getLatest(),s=Du(n),a=i=>i.isSameNodeCaret(n)?null:Gb(i)||i.getParentCaret(t);return qb({hasNext:i=>i!==null&&!(s&&n.isSameNodeCaret(i)),initial:r.isSameNodeCaret(n)?null:a(r),map:i=>i,step:a})}[Symbol.iterator](){return this.iterNodeCarets("root")}}class cU{type="slice";constructor(t,r){this.caret=t,this.distance=r}getSliceIndices(){const{distance:t,caret:{offset:r}}=this,n=r+t;return n<r?[n,r]:[r,n]}getTextContent(){const[t,r]=this.getSliceIndices();return this.caret.origin.getTextContent().slice(t,r)}getTextContentSize(){return Math.abs(this.distance)}removeTextSlice(){const{caret:{origin:t,direction:r}}=this,[n,s]=this.getSliceIndices(),a=t.getTextContent();return uf(t.setTextContent(a.slice(0,n)+a.slice(s)),r,n)}}function Kb(e){return $u(e,Na(qn(),e.direction))}function uU(e){return $u(e,e)}function $u(e,t){return e.direction!==t.direction&&Pt(265),new Vb(e,t,e.direction)}function qb(e){const{initial:t,hasNext:r,step:n,map:s}=e;let a=t;return{[Symbol.iterator](){return this},next(){if(!r(a))return{done:!0,value:void 0};const i={done:!1,value:s(a)};return a=n(a),i}}}function HA(e,t){const r=My(e.origin,t.origin);switch(r===null&&Pt(275,e.origin.getKey(),t.origin.getKey()),r.type){case"same":{const n=e.type==="text",s=t.type==="text";return n&&s?(function(a,i){return Math.sign(a-i)})(e.offset,t.offset):e.type===t.type?0:n?-1:s?1:e.type==="child"?-1:1}case"ancestor":return e.type==="child"?-1:1;case"descendant":return t.type==="child"?1:-1;case"branch":return GA(r)}}function GA(e){const{a:t,b:r}=e,n=t.__key,s=r.__key;let a=t,i=r;for(;a&&i;a=a.getNextSibling(),i=i.getNextSibling()){if(a.__key===s)return-1;if(i.__key===n)return 1}return a===null?1:-1}function hy(e,t){return t.is(e)}function iE(e){return yt(e)?[e.getLatest(),null]:[e.getParent(),e.getLatest()]}function My(e,t){if(e.is(t))return{commonAncestor:e,type:"same"};const r=new Map;for(let[n,s]=iE(e);n;s=n,n=n.getParent())r.set(n,s);for(let[n,s]=iE(t);n;s=n,n=n.getParent()){const a=r.get(n);if(a!==void 0)return a===null?(hy(e,n)||Pt(276),{commonAncestor:n,type:"ancestor"}):s===null?(hy(t,n)||Pt(277),{commonAncestor:n,type:"descendant"}):((yt(a)||hy(e,a))&&(yt(s)||hy(t,s))&&n.is(a.getParent())&&n.is(s.getParent())||Pt(278),{a,b:s,commonAncestor:n,type:"branch"})}return null}function Fc(e,t){const{type:r,key:n,offset:s}=e,a=JB(e.key);return r==="text"?(Gt(a)||Pt(266,a.getType(),n),uf(a,t,s)):(yt(a)||Pt(267,a.getType(),n),hU(a,e.offset,t))}function df(e,t){const{origin:r,direction:n}=t,s=n==="next";Du(t)?e.set(r.getKey(),t.offset,"text"):cf(t)?Gt(r)?e.set(r.getKey(),Iu(r,n),"text"):e.set(r.getParentOrThrow().getKey(),r.getIndexWithinParent()+(s?1:0),"element"):(Ml(t)&&yt(r)||Pt(268),e.set(r.getKey(),s?0:r.getChildrenSize(),"element"))}function dU(e){const t=Ht(),r=Tt(t)?t:z1();return Oy(r,e),Aa(r),r}function Oy(e,t){df(e.anchor,t.anchor),df(e.focus,t.focus)}function oE(e){const{anchor:t,focus:r}=e,n=Fc(t,"next"),s=Fc(r,"next"),a=HA(n,s)<=0?"next":"previous";return $u(d0(n,a),d0(s,a))}function Xb(e){const{direction:t,origin:r}=e,n=Na(r,E0(t)).getNodeAtCaret();return n?Na(n,t):ko(r.getParentOrThrow(),t)}function lE(e,t="root"){const r=[e];for(let n=Ml(e)?e.getParentCaret(t):e.getSiblingCaret();n!==null;n=n.getParentCaret(t))r.push(Xb(n));return r}function Rw(e){return!!e&&e.origin.isAttached()}function fU(e,t="removeEmptySlices"){if(e.isCollapsed())return e;const r="root",n="next";let s=t;const a=KA(e,n),i=lE(a.anchor,r),l=lE(a.focus.getFlipped(),r),c=new Set,d=[];for(const v of a.iterNodeCarets(r))if(Ml(v))c.add(v.origin.getKey());else if(cf(v)){const{origin:_}=v;yt(_)&&!c.has(_.getKey())||d.push(_)}for(const v of d)v.remove();for(const v of a.getTextSlices()){if(!v)continue;const{origin:_}=v.caret,b=_.getTextContentSize(),N=Xb(Na(_,n)),k=_.getMode();if(Math.abs(v.distance)===b&&s==="removeEmptySlices"||k==="token"&&v.distance!==0)N.remove();else if(v.distance!==0){s="removeEmptySlices";let w=v.removeTextSlice();const T=v.caret.origin;if(k==="segmented"){const A=w.origin,F=cs(A.getTextContent()).setStyle(A.getStyle()).setFormat(A.getFormat());N.replaceOrInsert(F),w=uf(F,n,w.offset)}T.is(i[0].origin)&&(i[0]=w),T.is(l[0].origin)&&(l[0]=w.getFlipped())}}let f,p;for(const v of i)if(Rw(v)){f=wo(v);break}for(const v of l)if(Rw(v)){p=wo(v);break}const g=(function(v,_,b){if(!v||!_)return null;const N=v.getParentAtCaret(),k=_.getParentAtCaret();if(!N||!k)return null;const w=N.getParents().reverse();w.push(N);const T=k.getParents().reverse();T.push(k);const A=Math.min(w.length,T.length);let F;for(F=0;F<A&&w[F]===T[F];F++);const R=(I,G)=>{let Y;for(let ee=F;ee<I.length;ee++){const ie=I[ee];if(fi(ie))return;!Y&&G(ie)&&(Y=ie)}return Y},E=R(w,vo),D=E&&R(T,(I=>b.has(I.getKey())&&vo(I)));return E&&D?[E,D]:null})(f,p,c);if(g){const[v,_]=g;ko(v,"previous").splice(0,_.getChildren()),_.remove()}const y=[f,p,...i,...l].find(Rw);if(y)return uU(d0(wo(y),e.direction));Pt(269,JSON.stringify(i.map((v=>v.origin.__key))))}function wo(e){const t=(function(s){let a=s;for(;Ml(a);){const i=Gb(a);if(!Ml(i))break;a=i}return a})(e.getLatest()),{direction:r}=t;if(Gt(t.origin))return Du(t)?t:uf(t.origin,r,r);const n=t.getAdjacentCaret();return cf(n)&&Gt(n.origin)?uf(n.origin,r,E0(r)):t}function VA(e){return Du(e)&&e.offset!==Iu(e.origin,e.direction)}function d0(e,t){return e.direction===t?e:e.getFlipped()}function KA(e,t){return e.direction===t?e:$u(d0(e.focus,t),d0(e.anchor,t))}function hU(e,t,r){let n=ko(e,"next");for(let s=0;s<t;s++){const a=n.getAdjacentCaret();if(a===null)break;n=a}return d0(n,r)}const qA=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,gU=qA?C.useLayoutEffect:C.useEffect,gy={tag:Lm};function XA({initialConfig:e,children:t}){const r=C.useMemo((()=>{const{theme:n,namespace:s,nodes:a,onError:i,editorState:l,html:c}=e,d=IL(null,n),f=UB({editable:e.editable,html:c,namespace:s,nodes:a,onError:p=>i(p,f),theme:n});return(function(p,g){if(g!==null){if(g===void 0)p.update((()=>{const y=qn();if(y.isEmpty()){const v=Un();y.append(v);const _=qA?document.activeElement:null;(Ht()!==null||_!==null&&_===p.getRootElement())&&v.select()}}),gy);else if(g!==null)switch(typeof g){case"string":{const y=p.parseEditorState(g);p.setEditorState(y,gy);break}case"object":p.setEditorState(g,gy);break;case"function":p.update((()=>{qn().isEmpty()&&g(p)}),gy)}}})(f,l),[f,d]}),[]);return gU((()=>{const n=e.editable,[s]=r;s.setEditable(n===void 0||n)}),[]),o.jsx(b0.Provider,{value:r,children:t})}const mU=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?C.useLayoutEffect:C.useEffect;function pU(e){return{initialValueFn:()=>e.isEditable(),subscribe:t=>e.registerEditableListener(t)}}function xU(){return(function(e){const[t]=Bl(),r=C.useMemo((()=>e(t)),[t,e]),[n,s]=C.useState((()=>r.initialValueFn())),a=C.useRef(n);return mU((()=>{const{initialValueFn:i,subscribe:l}=r,c=i();return a.current!==c&&(a.current=c,s(c)),l((d=>{a.current=d,s(d)}))}),[r,e]),n})(pU)}function yU(){return qn().getTextContent()}function vU(e,t=!0){if(e)return!1;let r=yU();return t&&(r=r.trim()),r===""}function wU(e){if(!vU(e,!1))return!1;const t=qn().getChildren(),r=t.length;if(r>1)return!1;for(let n=0;n<r;n++){const s=t[n];if(nn(s))return!1;if(yt(s)){if(!jb(s)||s.__indent!==0)return!1;const a=s.getChildren(),i=a.length;for(let l=0;l<i;l++){const c=a[n];if(!Gt(c))return!1}}}return!0}function YA(e){return()=>wU(e)}const J_=new Map;function JA(e){const t={};if(!e)return t;const r=e.split(";");for(const n of r)if(n!==""){const[s,a]=n.split(/:([^]+)/);s&&a&&(t[s.trim()]=a.trim())}return t}function cE(e){let t=J_.get(e);return t===void 0&&(t=JA(e),J_.set(e,t)),t}function QA(e){const t=Bp().getElementByKey(e.getKey());if(t===null)return null;const r=t.ownerDocument.defaultView;return r===null?null:r.getComputedStyle(t)}function ZA(e){return QA(qs(e)?e:e.getParentOrThrow())}function uE(e){const t=ZA(e);return t!==null&&t.direction==="rtl"}function ej(e,t){const r=e.getStartEndPoints();if(t.isSelected(e)&&!vc(t)&&r!==null){const[n,s]=r,a=e.isBackward(),i=n.getNode(),l=s.getNode(),c=t.is(i),d=t.is(l);if(c||d){const[f,p]=z_(e),g=i.is(l),y=t.is(a?l:i),v=t.is(a?i:l);let _,b=0;g?(b=f>p?p:f,_=f>p?f:p):y?(b=a?p:f,_=void 0):v&&(b=0,_=a?f:p),t.__text=t.__text.slice(b,_)}}return t}function _U(e){const t=e.getStyle(),r=JA(t);J_.set(t,r)}function bU(e,t){const r=e.getFormatType(),n=e.getIndent();r!==t.getFormatType()&&t.setFormat(r),n!==t.getIndent()&&t.setIndent(n)}function Zh(e,t,r=bU){if(e===null)return;const n=e.getStartEndPoints(),s=new Map;let a=null;if(n){const[i,l]=n;a=z1(),a.anchor.set(i.key,i.offset,i.type),a.focus.set(l.key,l.offset,l.type);const c=Dw(i.getNode(),vo),d=Dw(l.getNode(),vo);yt(c)&&s.set(c.getKey(),c),yt(d)&&s.set(d.getKey(),d)}for(const i of e.getNodes())if(yt(i)&&vo(i))s.set(i.getKey(),i);else if(n===null){const l=Dw(i,vo);yt(l)&&s.set(l.getKey(),l)}for(const[i,l]of s){const c=t();r(l,c),l.replace(c,!0),a&&(i===a.anchor.key&&a.anchor.set(c.getKey(),a.anchor.offset,a.anchor.type),i===a.focus.key&&a.focus.set(c.getKey(),a.focus.offset,a.focus.type))}a&&e.is(Ht())&&Aa(a)}function tj(e){const t=rj(e);return t!==null&&t.writingMode==="vertical-rl"}function rj(e){const t=e.anchor.getNode();return yt(t)?QA(t):ZA(t)}function dE(e,t){let r=tj(e)?!t:t;nj(e)&&(r=!r);const n=Fc(e.focus,r?"previous":"next");if(VA(n))return!1;for(const s of Kb(n)){if(Ml(s))return!s.origin.isInline();if(!yt(s.origin)){if(nn(s.origin))return!0;break}}return!1}function SU(e,t,r,n){e.modify(t?"extend":"move",r,n)}function nj(e){const t=rj(e);return t!==null&&t.direction==="rtl"}function fE(e,t,r){const n=nj(e);let s;s=tj(e)||n?!r:r,SU(e,t,s,"character")}function Dw(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function kU(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const sj=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,CU=sj&&"documentMode"in document?document.documentMode:null;!(!sj||!("InputEvent"in window)||CU)&&"getTargetRanges"in new window.InputEvent("input");function aj(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}function wf(...e){return()=>{for(let t=e.length-1;t>=0;t--)e[t]();e.length=0}}function Vs(e,...t){const r=aj(...t);r.length>0&&e.classList.add(...r)}function Mu(e,...t){const r=aj(...t);r.length>0&&e.classList.remove(...r)}function TU(e){return e?e.getAdjacentCaret():null}function EU(e,t){let r=e;for(;r!=null;){if(r instanceof t)return r;r=r.getParent()}return null}function NU(e){const t=Y1(e,(r=>yt(r)&&!r.isInline()));return yt(t)||kU(4,e.__key),t}const Y1=(e,t)=>{let r=e;for(;r!==qn()&&r!=null;){if(t(r))return r;r=r.getParent()}return null};function Ud(e,t){return e!==null&&Object.getPrototypeOf(e).constructor.name===t.name}function ij(e,t){const r=[],n=Array.from(e).reverse();for(let s=n.pop();s!==void 0;s=n.pop())if(t(s))r.push(s);else if(yt(s))for(const a of AU(s))n.push(a);return r}function AU(e){return jU(ko(e,"previous"))}function jU(e){return qb({hasNext:cf,initial:e.getAdjacentCaret(),map:t=>t.origin.getLatest(),step:t=>t.getAdjacentCaret()})}function FU(e){const t=window.location.origin,r=n=>{if(n.origin!==t)return;const s=e.getRootElement();if(document.activeElement!==s)return;const a=n.data;if(typeof a=="string"){let i;try{i=JSON.parse(a)}catch{return}if(i&&i.protocol==="nuanria_messaging"&&i.type==="request"){const l=i.payload;if(l&&l.functionId==="makeChanges"){const c=l.args;if(c){const[d,f,p,g,y,v]=c;e.update((()=>{const _=Ht();if(Tt(_)){const b=_.anchor;let N=b.getNode(),k=0,w=0;if(Gt(N)&&d>=0&&f>=0&&(k=d,w=d+f,_.setTextNodeRange(N,k,N,w)),k===w&&p===""||(_.insertRawText(p),N=b.getNode()),Gt(N)){k=g,w=g+y;const T=N.getTextContentSize();k=k>T?T:k,w=w>T?T:w,_.setTextNodeRange(N,k,N,w)}n.stopImmediatePropagation()}}))}}}}};return window.addEventListener("message",r,!0),()=>{window.removeEventListener("message",r,!0)}}function PU(e,t){const r=t.body?t.body.childNodes:[];let n=[];const s=[];for(let a=0;a<r.length;a++){const i=r[a];if(!lj.has(i.nodeName)){const l=cj(i,e,s,!1);l!==null&&(n=n.concat(l))}}return(function(a){for(const i of a)i.getNextSibling()instanceof Ab&&i.insertAfter(Ol());for(const i of a){const l=i.getChildren();for(const c of l)i.insertBefore(c);i.remove()}})(s),n}function RU(e,t){if(typeof document>"u"||typeof window>"u"&&global.window===void 0)throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");const r=document.createElement("div"),n=qn().getChildren();for(let s=0;s<n.length;s++)oj(e,n[s],r,t);return r.innerHTML}function oj(e,t,r,n=null){let s=n===null||t.isSelected(n);const a=yt(t)&&t.excludeFromCopy("html");let i=t;if(n!==null){let y=Ub(t);y=Gt(y)&&n!==null?ej(n,y):y,i=y}const l=yt(i)?i.getChildren():[],c=Pb(e,i.getType());let d;d=c&&c.exportDOM!==void 0?c.exportDOM(e,i):i.exportDOM(e);const{element:f,after:p}=d;if(!f)return!1;const g=document.createDocumentFragment();for(let y=0;y<l.length;y++){const v=l[y],_=oj(e,v,g,n);!s&&yt(t)&&_&&t.extractWithChild(v,n,"html")&&(s=!0)}if(s&&!a){if(($n(f)||X_(f))&&f.append(g),r.append(f),p){const y=p.call(i,f);y&&(X_(f)?f.replaceChildren(y):f.replaceWith(y))}}else r.append(g);return s}const lj=new Set(["STYLE","SCRIPT"]);function cj(e,t,r,n,s=new Map,a){let i=[];if(lj.has(e.nodeName))return i;let l=null;const c=(function(v,_){const{nodeName:b}=v,N=_._htmlConversions.get(b.toLowerCase());let k=null;if(N!==void 0)for(const w of N){const T=w(v);T!==null&&(k===null||(k.priority||0)<=(T.priority||0))&&(k=T)}return k!==null?k.conversion:null})(e,t),d=c?c(e):null;let f=null;if(d!==null){f=d.after;const v=d.node;if(l=Array.isArray(v)?v[v.length-1]:v,l!==null){for(const[,_]of s)if(l=_(l,a),!l)break;l&&i.push(...Array.isArray(v)?v:[l])}d.forChild!=null&&s.set(e.nodeName,d.forChild)}const p=e.childNodes;let g=[];const y=(l==null||!fi(l))&&(l!=null&&H_(l)||n);for(let v=0;v<p.length;v++)g.push(...cj(p[v],t,r,y,new Map(s),l));return f!=null&&(g=f(g)),l1(e)&&(g=DU(e,g,y?()=>{const v=new Ab;return r.push(v),v}:Un)),l==null?g.length>0?i=i.concat(g):l1(e)&&(function(v){return v.nextSibling==null||v.previousSibling==null?!1:Y_(v.nextSibling)&&Y_(v.previousSibling)})(e)&&(i=i.concat(Ol())):yt(l)&&l.append(...g),i}function DU(e,t,r){const n=e.style.textAlign,s=[];let a=[];for(let i=0;i<t.length;i++){const l=t[i];if(H_(l))n&&!l.getFormat()&&l.setFormat(n),s.push(l);else if(a.push(l),i===t.length-1||i<t.length-1&&H_(t[i+1])){const c=r();c.setFormat(n),c.append(...a),s.push(c),a=[]}}return s}function c1(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function IU(e,t=Ht()){return t==null&&c1(166),Tt(t)&&t.isCollapsed()||t.getNodes().length===0?"":RU(e,t)}function MU(e,t=Ht()){return t==null&&c1(166),Tt(t)&&t.isCollapsed()||t.getNodes().length===0?null:JSON.stringify(OU(e,t))}function hE(e,t,r){const n=e.getData("application/x-lexical-editor");if(n)try{const l=JSON.parse(n);if(l.namespace===r._config.namespace&&Array.isArray(l.nodes))return gE(r,LU(l.nodes),t)}catch{}const s=e.getData("text/html"),a=e.getData("text/plain");if(s&&a!==s)try{const l=new DOMParser().parseFromString((function(c){return window.trustedTypes&&window.trustedTypes.createPolicy?window.trustedTypes.createPolicy("lexical",{createHTML:d=>d}).createHTML(c):c})(s),"text/html");return gE(r,PU(r,l),t)}catch{}const i=a||e.getData("text/uri-list");if(i!=null)if(Tt(t)){const l=i.split(/(\r?\n|\t)/);l[l.length-1]===""&&l.pop();for(let c=0;c<l.length;c++){const d=Ht();if(Tt(d)){const f=l[c];f===`
`||f===`\r
`?d.insertParagraph():f==="	"?d.insertNodes([k0()]):d.insertText(f)}}}else t.insertRawText(i)}function gE(e,t,r){e.dispatchCommand(lB,{nodes:t,selection:r})||(r.insertNodes(t),(function(n){if(Tt(n)&&n.isCollapsed()){const s=n.anchor;let a=null;const i=Fc(s,"previous");if(i)if(Du(i))a=i.origin;else{const l=$u(i,ko(qn(),"next").getFlipped());for(const c of l){if(Gt(c.origin)){a=c.origin;break}if(yt(c.origin)&&!c.origin.isInline())break}}if(a&&Gt(a)){const l=a.getFormat(),c=a.getStyle();n.format===l&&n.style===c||(n.format=l,n.style=c,n.dirty=!0)}}})(r))}function uj(e,t,r,n=[]){let s=t===null||r.isSelected(t);const a=yt(r)&&r.excludeFromCopy("html");let i=r;if(t!==null){let d=Ub(r);d=Gt(d)&&t!==null?ej(t,d):d,i=d}const l=yt(i)?i.getChildren():[],c=(function(d){const f=d.exportJSON(),p=d.constructor;if(f.type!==p.getType()&&c1(58,p.name),yt(d)){const g=f.children;Array.isArray(g)||c1(59,p.name)}return f})(i);if(Gt(i)){const d=i.__text;d.length>0?c.text=d:s=!1}for(let d=0;d<l.length;d++){const f=l[d],p=uj(e,t,f,c.children);!s&&yt(r)&&p&&r.extractWithChild(f,t,"clone")&&(s=!0)}if(s&&!a)n.push(c);else if(Array.isArray(c.children))for(let d=0;d<c.children.length;d++){const f=c.children[d];n.push(f)}return s}function OU(e,t){const r=[],n=qn().getChildren();for(let s=0;s<n.length;s++)uj(e,t,n[s],r);return{namespace:e._config.namespace,nodes:r}}function LU(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r],s=RB(n);Gt(s)&&_U(s),t.push(s)}return t}let Th=null;async function mE(e,t,r){if(Th!==null)return!1;if(t!==null)return new Promise(((d,f)=>{e.update((()=>{d(pE(e,t,r))}))}));const n=e.getRootElement(),s=e._window||window,a=window.document,i=el(s);if(n===null||i===null)return!1;const l=a.createElement("span");l.style.cssText="position: fixed; top: -1000px;",l.append(a.createTextNode("#")),n.append(l);const c=new Range;return c.setStart(l,0),c.setEnd(l,1),i.removeAllRanges(),i.addRange(c),new Promise(((d,f)=>{const p=e.registerCommand(U1,(g=>(Ud(g,ClipboardEvent)&&(p(),Th!==null&&(window.clearTimeout(Th),Th=null),d(pE(e,g,r))),!0)),BB);Th=window.setTimeout((()=>{p(),Th=null,d(!1)}),50),a.execCommand("copy"),l.remove()}))}function pE(e,t,r){if(r===void 0){const s=el(e._window);if(!s)return!1;const a=s.anchorNode,i=s.focusNode;if(a!==null&&i!==null&&!Op(e,a,i))return!1;const l=Ht();if(l===null)return!1;r=UU(l)}t.preventDefault();const n=t.clipboardData;return n!==null&&($U(n,r),!0)}const BU=[["text/html",IU],["application/x-lexical-editor",MU]];function UU(e=Ht()){const t={"text/plain":e?e.getTextContent():""};if(e){const r=Bp();for(const[n,s]of BU){const a=s(r,e);a!==null&&(t[n]=a)}}return t}function $U(e,t){for(const r in t){const n=t[r];n!==void 0&&e.setData(r,n)}}function xE(e,t){if(document.caretRangeFromPoint!==void 0){const r=document.caretRangeFromPoint(e,t);return r===null?null:{node:r.startContainer,offset:r.startOffset}}if(document.caretPositionFromPoint!=="undefined"){const r=document.caretPositionFromPoint(e,t);return r===null?null:{node:r.offsetNode,offset:r.offset}}return null}const N0=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,WU=N0&&"documentMode"in document?document.documentMode:null,zU=!(!N0||!("InputEvent"in window)||WU)&&"getTargetRanges"in new window.InputEvent("input"),HU=N0&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),yE=N0&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,GU=N0&&/^(?=.*Chrome).*/i.test(navigator.userAgent),VU=N0&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!GU,vE=_r("DRAG_DROP_PASTE_FILE");let Up=class dj extends Ka{static getType(){return"quote"}static clone(t){return new dj(t.__key)}createDOM(t){const r=document.createElement("blockquote");return Vs(r,t.theme.quote),r}updateDOM(t,r){return!1}static importDOM(){return{blockquote:t=>({conversion:KU,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if($n(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return $p().updateFromJSON(t)}insertNewAfter(t,r){const n=Un(),s=this.getDirection();return n.setDirection(s),this.insertAfter(n,r),n}collapseAtStart(){const t=Un();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}canMergeWhenEmpty(){return!0}};function $p(){return gi(new Up)}function wE(e){return e instanceof Up}let Wp=class fj extends Ka{static getType(){return"heading"}static clone(t){return new fj(t.__tag,t.__key)}constructor(t,r){super(r),this.__tag=t}getTag(){return this.__tag}setTag(t){const r=this.getWritable();return this.__tag=t,r}createDOM(t){const r=this.__tag,n=document.createElement(r),s=t.theme.heading;if(s!==void 0){const a=s[r];Vs(n,a)}return n}updateDOM(t,r,n){return t.__tag!==this.__tag}static importDOM(){return{h1:t=>({conversion:Eh,priority:0}),h2:t=>({conversion:Eh,priority:0}),h3:t=>({conversion:Eh,priority:0}),h4:t=>({conversion:Eh,priority:0}),h5:t=>({conversion:Eh,priority:0}),h6:t=>({conversion:Eh,priority:0}),p:t=>{const r=t.firstChild;return r!==null&&_E(r)?{conversion:()=>({node:null}),priority:3}:null},span:t=>_E(t)?{conversion:r=>({node:Au("h1")}),priority:3}:null}}exportDOM(t){const{element:r}=super.exportDOM(t);if($n(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return Au(t.tag).updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTag(t.tag)}exportJSON(){return{...super.exportJSON(),tag:this.getTag()}}insertNewAfter(t,r=!0){const n=t?t.anchor.offset:0,s=this.getLastDescendant(),a=!s||t&&t.anchor.key===s.getKey()&&n===s.getTextContentSize()||!t?Un():Au(this.getTag()),i=this.getDirection();if(a.setDirection(i),this.insertAfter(a,r),n===0&&!this.isEmpty()&&t){const l=Un();l.select(),this.replace(l,!0)}return a}collapseAtStart(){const t=this.isEmpty()?Un():Au(this.getTag());return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}extractWithChild(){return!0}};function _E(e){return e.nodeName.toLowerCase()==="span"&&e.style.fontSize==="26pt"}function Eh(e){const t=e.nodeName.toLowerCase();let r=null;return t!=="h1"&&t!=="h2"&&t!=="h3"&&t!=="h4"&&t!=="h5"&&t!=="h6"||(r=Au(t),e.style!==null&&($b(e,r),r.setFormat(e.style.textAlign))),{node:r}}function KU(e){const t=$p();return e.style!==null&&(t.setFormat(e.style.textAlign),$b(e,t)),{node:t}}function Au(e="h1"){return gi(new Wp(e))}function qU(e){return e instanceof Wp}function my(e){let t=null;if(Ud(e,DragEvent)?t=e.dataTransfer:Ud(e,ClipboardEvent)&&(t=e.clipboardData),t===null)return[!1,[],!1];const r=t.types,n=r.includes("Files"),s=r.includes("text/html")||r.includes("text/plain");return[n,Array.from(t.files),s]}function bE(e){const t=Ht();if(!Tt(t))return!1;const r=new Set,n=t.getNodes();for(let s=0;s<n.length;s++){const a=n[s],i=a.getKey();if(r.has(i))continue;const l=Y1(a,(d=>yt(d)&&!d.isInline()));if(l===null)continue;const c=l.getKey();l.canIndent()&&!r.has(c)&&(r.add(c),e(l))}return r.size>0}function SE(e){const t=Uu(e);return nn(t)}function Iw(e){for(const t of["lowercase","uppercase","capitalize"])e.hasFormat(t)&&e.toggleFormat(t)}function XU(e){return wf(e.registerCommand(yb,(t=>{const r=Ht();return!!La(r)&&(r.clear(),!0)}),Yr),e.registerCommand(Gd,(t=>{const r=Ht();return Tt(r)?(r.deleteCharacter(t),!0):!!La(r)&&(r.deleteNodes(),!0)}),Yr),e.registerCommand(ip,(t=>{const r=Ht();return!!Tt(r)&&(r.deleteWord(t),!0)}),Yr),e.registerCommand(op,(t=>{const r=Ht();return!!Tt(r)&&(r.deleteLine(t),!0)}),Yr),e.registerCommand(Yh,(t=>{const r=Ht();if(typeof t=="string")r!==null&&r.insertText(t);else{if(r===null)return!1;const n=t.dataTransfer;if(n!=null)hE(n,r,e);else if(Tt(r)){const s=t.data;return s&&r.insertText(s),!0}}return!0}),Yr),e.registerCommand(M_,(()=>{const t=Ht();return!!Tt(t)&&(t.removeText(),!0)}),Yr),e.registerCommand(Ha,(t=>{const r=Ht();return!!Tt(r)&&(r.formatText(t),!0)}),Yr),e.registerCommand(lA,(t=>{const r=Ht();if(!Tt(r)&&!La(r))return!1;const n=r.getNodes();for(const s of n){const a=Y1(s,(i=>yt(i)&&!i.isInline()));a!==null&&a.setFormat(t)}return!0}),Yr),e.registerCommand(Xh,(t=>{const r=Ht();return!!Tt(r)&&(r.insertLineBreak(t),!0)}),Yr),e.registerCommand(ap,(()=>{const t=Ht();return!!Tt(t)&&(t.insertParagraph(),!0)}),Yr),e.registerCommand(fB,(()=>(jB([k0()]),!0)),Yr),e.registerCommand(hB,(()=>bE((t=>{const r=t.getIndent();t.setIndent(r+1)}))),Yr),e.registerCommand(T4,(()=>bE((t=>{const r=t.getIndent();r>0&&t.setIndent(Math.max(0,r-1))}))),Yr),e.registerCommand(eA,(t=>{const r=Ht();if(La(r)){const n=r.getNodes();if(n.length>0)return n[0].selectPrevious(),!0}else if(Tt(r)){const n=V_(r.focus,!0);if(!t.shiftKey&&nn(n)&&!n.isIsolated()&&!n.isInline())return n.selectPrevious(),t.preventDefault(),!0}return!1}),Yr),e.registerCommand(tA,(t=>{const r=Ht();if(La(r)){const n=r.getNodes();if(n.length>0)return n[0].selectNext(0,0),!0}else if(Tt(r)){if((function(s){const a=s.focus;return a.key==="root"&&a.offset===qn().getChildrenSize()})(r))return t.preventDefault(),!0;const n=V_(r.focus,!1);if(!t.shiftKey&&nn(n)&&!n.isIsolated()&&!n.isInline())return n.selectNext(),t.preventDefault(),!0}return!1}),Yr),e.registerCommand(Z6,(t=>{const r=Ht();if(La(r)){const n=r.getNodes();if(n.length>0)return t.preventDefault(),uE(n[0])?n[0].selectNext(0,0):n[0].selectPrevious(),!0}if(!Tt(r))return!1;if(dE(r,!0)){const n=t.shiftKey;return t.preventDefault(),fE(r,n,!0),!0}return!1}),Yr),e.registerCommand(Q6,(t=>{const r=Ht();if(La(r)){const s=r.getNodes();if(s.length>0)return t.preventDefault(),uE(s[0])?s[0].selectPrevious():s[0].selectNext(0,0),!0}if(!Tt(r))return!1;const n=t.shiftKey;return!!dE(r,!1)&&(t.preventDefault(),fE(r,n,!1),!0)}),Yr),e.registerCommand(nA,(t=>{if(SE(t.target))return!1;const r=Ht();if(Tt(r)){if((function(n){if(!n.isCollapsed())return!1;const{anchor:s}=n;if(s.offset!==0)return!1;const a=s.getNode();if(qs(a))return!1;const i=NU(a);return i.getIndent()>0&&(i.is(a)||a.is(i.getFirstDescendant()))})(r))return t.preventDefault(),e.dispatchCommand(T4,void 0);if(yE&&navigator.language==="ko-KR")return!1}else if(!La(r))return!1;return t.preventDefault(),e.dispatchCommand(Gd,!0)}),Yr),e.registerCommand(aA,(t=>{if(SE(t.target))return!1;const r=Ht();return!(!Tt(r)&&!La(r))&&(t.preventDefault(),e.dispatchCommand(Gd,!1))}),Yr),e.registerCommand(t1,(t=>{const r=Ht();if(!Tt(r))return!1;if(Iw(r),t!==null){if((yE||HU||VU)&&zU)return!1;if(t.preventDefault(),t.shiftKey)return e.dispatchCommand(Xh,!1)}return e.dispatchCommand(ap,void 0)}),Yr),e.registerCommand(sA,(()=>{const t=Ht();return!!Tt(t)&&(e.blur(),!0)}),Yr),e.registerCommand(oA,(t=>{const[,r]=my(t);if(r.length>0){const s=xE(t.clientX,t.clientY);if(s!==null){const{offset:a,node:i}=s,l=Uu(i);if(l!==null){const c=z1();if(Gt(l))c.anchor.set(l.getKey(),a,"text"),c.focus.set(l.getKey(),a,"text");else{const f=l.getParentOrThrow().getKey(),p=l.getIndexWithinParent()+1;c.anchor.set(f,p,"element"),c.focus.set(f,p,"element")}const d=Yy(c);Aa(d)}e.dispatchCommand(vE,r)}return t.preventDefault(),!0}const n=Ht();return!!Tt(n)}),Yr),e.registerCommand(cA,(t=>{const[r]=my(t),n=Ht();return!(r&&!Tt(n))}),Yr),e.registerCommand(uA,(t=>{const[r]=my(t),n=Ht();if(r&&!Tt(n))return!1;const s=xE(t.clientX,t.clientY);if(s!==null){const a=Uu(s.node);nn(a)&&t.preventDefault()}return!0}),Yr),e.registerCommand(O_,(()=>(VB(),!0)),Yr),e.registerCommand(U1,(t=>(mE(e,Ud(t,ClipboardEvent)?t:null),!0)),Yr),e.registerCommand(bb,(t=>((async function(r,n){await mE(n,Ud(r,ClipboardEvent)?r:null),n.update((()=>{const s=Ht();Tt(s)?s.removeText():La(s)&&s.getNodes().forEach((a=>a.remove()))}))})(t,e),!0)),Yr),e.registerCommand(vb,(t=>{const[,r,n]=my(t);return r.length>0&&!n?(e.dispatchCommand(vE,r),!0):T0(t.target)&&Rb(t.target)?!1:Ht()!==null&&((function(s,a){s.preventDefault(),a.update((()=>{const i=Ht(),l=Ud(s,InputEvent)||Ud(s,KeyboardEvent)?null:s.clipboardData;l!=null&&i!==null&&hE(l,i,a)}),{tag:IB})})(t,e),!0)}),Yr),e.registerCommand(rA,(t=>{const r=Ht();return Tt(r)&&Iw(r),!1}),Yr),e.registerCommand(iA,(t=>{const r=Ht();return Tt(r)&&Iw(r),!1}),Yr))}const Q_=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?C.useLayoutEffect:C.useEffect;function kE(e){return e.getEditorState().read(YA(e.isComposing()))}function hj({contentEditable:e,placeholder:t=null,ErrorBoundary:r}){const[n]=Bl(),s=(function(a,i){const[l,c]=C.useState((()=>a.getDecorators()));return Q_((()=>a.registerDecoratorListener((d=>{Ak.flushSync((()=>{c(d)}))}))),[a]),C.useEffect((()=>{c(a.getDecorators())}),[a]),C.useMemo((()=>{const d=[],f=Object.keys(l);for(let p=0;p<f.length;p++){const g=f[p],y=o.jsx(i,{onError:_=>a._onError(_),children:o.jsx(C.Suspense,{fallback:null,children:l[g]})}),v=a.getElementByKey(g);v!==null&&d.push(Ak.createPortal(y,v,g))}return d}),[i,l,a])})(n,r);return(function(a){Q_((()=>wf(XU(a),FU(a))),[a])})(n),o.jsxs(o.Fragment,{children:[e,o.jsx(YU,{content:t}),s]})}function YU({content:e}){const[t]=Bl(),r=(function(s){const[a,i]=C.useState((()=>kE(s)));return Q_((()=>{function l(){const c=kE(s);i(c)}return l(),wf(s.registerUpdateListener((()=>{l()})),s.registerEditableListener((()=>{l()})))}),[s]),a})(t),n=xU();return r?typeof e=="function"?e(n):e:null}const gj=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?C.useLayoutEffect:C.useEffect;function JU({editor:e,ariaActiveDescendant:t,ariaAutoComplete:r,ariaControls:n,ariaDescribedBy:s,ariaErrorMessage:a,ariaExpanded:i,ariaInvalid:l,ariaLabel:c,ariaLabelledBy:d,ariaMultiline:f,ariaOwns:p,ariaRequired:g,autoCapitalize:y,className:v,id:_,role:b="textbox",spellCheck:N=!0,style:k,tabIndex:w,"data-testid":T,...A},F){const[R,E]=C.useState(e.isEditable()),D=C.useCallback((G=>{G&&G.ownerDocument&&G.ownerDocument.defaultView?e.setRootElement(G):e.setRootElement(null)}),[e]),I=C.useMemo((()=>(function(...G){return Y=>{G.forEach((ee=>{typeof ee=="function"?ee(Y):ee!=null&&(ee.current=Y)}))}})(F,D)),[D,F]);return gj((()=>(E(e.isEditable()),e.registerEditableListener((G=>{E(G)})))),[e]),o.jsx("div",{"aria-activedescendant":R?t:void 0,"aria-autocomplete":R?r:"none","aria-controls":R?n:void 0,"aria-describedby":s,...a!=null?{"aria-errormessage":a}:{},"aria-expanded":R&&b==="combobox"?!!i:void 0,...l!=null?{"aria-invalid":l}:{},"aria-label":c,"aria-labelledby":d,"aria-multiline":f,"aria-owns":R?p:void 0,"aria-readonly":!R||void 0,"aria-required":g,autoCapitalize:y,className:v,contentEditable:R,"data-testid":T,id:_,ref:I,role:b,spellCheck:N,style:k,tabIndex:w,...A})}const QU=C.forwardRef(JU);function CE(e){return e.getEditorState().read(YA(e.isComposing()))}const mj=C.forwardRef(ZU);function ZU(e,t){const{placeholder:r,...n}=e,[s]=Bl();return o.jsxs(o.Fragment,{children:[o.jsx(QU,{editor:s,...n,ref:t}),r!=null&&o.jsx(e$,{editor:s,content:r})]})}function e$({content:e,editor:t}){const r=(function(i){const[l,c]=C.useState((()=>CE(i)));return gj((()=>{function d(){const f=CE(i);c(f)}return d(),wf(i.registerUpdateListener((()=>{d()})),i.registerEditableListener((()=>{d()})))}),[i]),l})(t),[n,s]=C.useState(t.isEditable());if(C.useLayoutEffect((()=>(s(t.isEditable()),t.registerEditableListener((i=>{s(i)})))),[t]),!r)return null;let a=null;return typeof e=="function"?a=e(n):e!==null&&(a=e),a===null?null:o.jsx("div",{"aria-hidden":!0,children:a})}const py=0,Z_=1,e2=2,Ho=0,t$=1,TE=2,r$=3,n$=4;function s$(e,t,r,n,s){if(e===null||r.size===0&&n.size===0&&!s)return Ho;const a=t._selection,i=e._selection;if(s)return t$;if(!(Tt(a)&&Tt(i)&&i.isCollapsed()&&a.isCollapsed()))return Ho;const l=(function(N,k,w){const T=N._nodeMap,A=[];for(const F of k){const R=T.get(F);R!==void 0&&A.push(R)}for(const[F,R]of w){if(!R)continue;const E=T.get(F);E===void 0||qs(E)||A.push(E)}return A})(t,r,n);if(l.length===0)return Ho;if(l.length>1){const N=t._nodeMap,k=N.get(a.anchor.key),w=N.get(i.anchor.key);return k&&w&&!e._nodeMap.has(k.__key)&&Gt(k)&&k.__text.length===1&&a.anchor.offset===1?TE:Ho}const c=l[0],d=e._nodeMap.get(c.__key);if(!Gt(d)||!Gt(c)||d.__mode!==c.__mode)return Ho;const f=d.__text,p=c.__text;if(f===p)return Ho;const g=a.anchor,y=i.anchor;if(g.key!==y.key||g.type!=="text")return Ho;const v=g.offset,_=y.offset,b=p.length-f.length;return b===1&&_===v-1?TE:b===-1&&_===v+1?r$:b===-1&&_===v?n$:Ho}function a$(e,t){let r=Date.now(),n=Ho;return(s,a,i,l,c,d)=>{const f=Date.now();if(d.has(a1))return n=Ho,r=f,e2;const p=s$(s,a,l,c,e.isComposing()),g=(()=>{const y=i===null||i.editor===e,v=d.has(DB);if(!v&&y&&d.has(Lm))return py;if(s===null)return Z_;const _=a._selection;return l.size>0||c.size>0?v===!1&&p!==Ho&&p===n&&f<r+t&&y||l.size===1&&(function(b,N,k){const w=N._nodeMap.get(b),T=k._nodeMap.get(b),A=N._selection,F=k._selection;return!(Tt(A)&&Tt(F)&&A.anchor.type==="element"&&A.focus.type==="element"&&F.anchor.type==="text"&&F.focus.type==="text"||!Gt(w)||!Gt(T)||w.__parent!==T.__parent)&&JSON.stringify(N.read((()=>w.exportJSON())))===JSON.stringify(k.read((()=>T.exportJSON())))})(Array.from(l)[0],s,a)?py:Z_:_!==null?py:e2})();return r=f,n=p,g}}function EE(e){e.undoStack=[],e.redoStack=[],e.current=null}function i$(e,t,r){const n=a$(e,r);return wf(e.registerCommand(wb,(()=>((function(a,i){const l=i.redoStack,c=i.undoStack;if(c.length!==0){const d=i.current,f=c.pop();d!==null&&(l.push(d),a.dispatchCommand(oy,!0)),c.length===0&&a.dispatchCommand(ly,!1),i.current=f||null,f&&f.editor.setEditorState(f.editorState,{tag:a1})}})(e,t),!0)),Yr),e.registerCommand(_b,(()=>((function(a,i){const l=i.redoStack,c=i.undoStack;if(l.length!==0){const d=i.current;d!==null&&(c.push(d),a.dispatchCommand(ly,!0));const f=l.pop();l.length===0&&a.dispatchCommand(oy,!1),i.current=f||null,f&&f.editor.setEditorState(f.editorState,{tag:a1})}})(e,t),!0)),Yr),e.registerCommand(mB,(()=>(EE(t),!1)),Yr),e.registerCommand(pB,(()=>(EE(t),e.dispatchCommand(oy,!1),e.dispatchCommand(ly,!1),!0)),Yr),e.registerUpdateListener((({editorState:a,prevEditorState:i,dirtyLeaves:l,dirtyElements:c,tags:d})=>{const f=t.current,p=t.redoStack,g=t.undoStack,y=f===null?null:f.editorState;if(f!==null&&a===y)return;const v=n(i,a,f,l,c,d);if(v===Z_)p.length!==0&&(t.redoStack=[],e.dispatchCommand(oy,!1)),f!==null&&(g.push({...f}),e.dispatchCommand(ly,!0));else if(v===e2)return;t.current={editor:e,editorState:a}})))}function o$(){return{current:null,redoStack:[],undoStack:[]}}function pj({delay:e,externalHistoryState:t}){const[r]=Bl();return(function(n,s,a=1e3){const i=C.useMemo((()=>s||o$()),[s]);C.useEffect((()=>i$(n,i,a)),[a,n,i])})(r,t,e),null}function xj({defaultSelection:e}){const[t]=Bl();return C.useEffect((()=>{t.focus((()=>{const r=document.activeElement,n=t.getRootElement();n===null||r!==null&&n.contains(r)||n.focus({preventScroll:!0})}),{defaultSelection:e})}),[e,t]),null}function t2(e,t){return t2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},t2(e,t)}var NE={error:null},l$=(function(e){var t,r;function n(){for(var a,i=arguments.length,l=new Array(i),c=0;c<i;c++)l[c]=arguments[c];return(a=e.call.apply(e,[this].concat(l))||this).state=NE,a.resetErrorBoundary=function(){for(var d,f=arguments.length,p=new Array(f),g=0;g<f;g++)p[g]=arguments[g];a.props.onReset==null||(d=a.props).onReset.apply(d,p),a.reset()},a}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t2(t,r),n.getDerivedStateFromError=function(a){return{error:a}};var s=n.prototype;return s.reset=function(){this.setState(NE)},s.componentDidCatch=function(a,i){var l,c;(l=(c=this.props).onError)==null||l.call(c,a,i)},s.componentDidUpdate=function(a,i){var l,c,d,f,p=this.state.error,g=this.props.resetKeys;p!==null&&i.error!==null&&((d=a.resetKeys)===void 0&&(d=[]),(f=g)===void 0&&(f=[]),d.length!==f.length||d.some((function(y,v){return!Object.is(y,f[v])})))&&((l=(c=this.props).onResetKeysChange)==null||l.call(c,a.resetKeys,g),this.reset())},s.render=function(){var a=this.state.error,i=this.props,l=i.fallbackRender,c=i.FallbackComponent,d=i.fallback;if(a!==null){var f={error:a,resetErrorBoundary:this.resetErrorBoundary};if(C.isValidElement(d))return d;if(typeof l=="function")return l(f);if(c)return C.createElement(c,f);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},n})(C.Component);function yj({children:e,onError:t}){return o.jsx(l$,{fallback:o.jsx("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"},children:"An error was thrown."}),onError:t,children:e})}const Yb=/^(\d+(?:\.\d+)?)px$/,e0={BOTH:3,NO_STATUS:0,ROW:1};class A0 extends Ka{static getType(){return"tablecell"}static clone(t){return new A0(t.__headerState,t.__colSpan,t.__width,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__rowSpan=t.__rowSpan,this.__backgroundColor=t.__backgroundColor,this.__verticalAlign=t.__verticalAlign}static importDOM(){return{td:t=>({conversion:AE,priority:0}),th:t=>({conversion:AE,priority:0})}}static importJSON(t){return vj().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeaderStyles(t.headerState).setColSpan(t.colSpan||1).setRowSpan(t.rowSpan||1).setWidth(t.width||void 0).setBackgroundColor(t.backgroundColor||null).setVerticalAlign(t.verticalAlign||void 0)}constructor(t=e0.NO_STATUS,r=1,n,s){super(s),this.__colSpan=r,this.__rowSpan=1,this.__headerState=t,this.__width=n,this.__backgroundColor=null,this.__verticalAlign=void 0}createDOM(t){const r=document.createElement(this.getTag());return this.__width&&(r.style.width=`${this.__width}px`),this.__colSpan>1&&(r.colSpan=this.__colSpan),this.__rowSpan>1&&(r.rowSpan=this.__rowSpan),this.__backgroundColor!==null&&(r.style.backgroundColor=this.__backgroundColor),r2(this.__verticalAlign)&&(r.style.verticalAlign=this.__verticalAlign),Vs(r,t.theme.tableCell,this.hasHeader()&&t.theme.tableCellHeader),r}exportDOM(t){const r=super.exportDOM(t);if($n(r.element)){const n=r.element;n.setAttribute("data-temporary-table-cell-lexical-key",this.getKey()),n.style.border="1px solid black",this.__colSpan>1&&(n.colSpan=this.__colSpan),this.__rowSpan>1&&(n.rowSpan=this.__rowSpan),n.style.width=`${this.getWidth()||75}px`,n.style.verticalAlign=this.getVerticalAlign()||"top",n.style.textAlign="start",this.__backgroundColor===null&&this.hasHeader()&&(n.style.backgroundColor="#f2f3f5")}return r}exportJSON(){return{...super.exportJSON(),...r2(this.__verticalAlign)&&{verticalAlign:this.__verticalAlign},backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,width:this.getWidth()}}getColSpan(){return this.getLatest().__colSpan}setColSpan(t){const r=this.getWritable();return r.__colSpan=t,r}getRowSpan(){return this.getLatest().__rowSpan}setRowSpan(t){const r=this.getWritable();return r.__rowSpan=t,r}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(t,r=e0.BOTH){const n=this.getWritable();return n.__headerState=t&r|n.__headerState&~r,n}getHeaderStyles(){return this.getLatest().__headerState}setWidth(t){const r=this.getWritable();return r.__width=t,r}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(t){const r=this.getWritable();return r.__backgroundColor=t,r}getVerticalAlign(){return this.getLatest().__verticalAlign}setVerticalAlign(t){const r=this.getWritable();return r.__verticalAlign=t||void 0,r}toggleHeaderStyle(t){const r=this.getWritable();return(r.__headerState&t)===t?r.__headerState-=t:r.__headerState+=t,r}hasHeaderState(t){return(this.getHeaderStyles()&t)===t}hasHeader(){return this.getLatest().__headerState!==e0.NO_STATUS}updateDOM(t){return t.__headerState!==this.__headerState||t.__width!==this.__width||t.__colSpan!==this.__colSpan||t.__rowSpan!==this.__rowSpan||t.__backgroundColor!==this.__backgroundColor||t.__verticalAlign!==this.__verticalAlign}isShadowRoot(){return!0}collapseAtStart(){return!0}canBeEmpty(){return!1}canIndent(){return!1}}function r2(e){return e==="middle"||e==="bottom"}function AE(e){const t=e,r=e.nodeName.toLowerCase();let n;Yb.test(t.style.width)&&(n=parseFloat(t.style.width));const s=vj(r==="th"?e0.ROW:e0.NO_STATUS,t.colSpan,n);s.__rowSpan=t.rowSpan;const a=t.style.backgroundColor;a!==""&&(s.__backgroundColor=a);const i=t.style.verticalAlign;r2(i)&&(s.__verticalAlign=i);const l=t.style,c=(l&&l.textDecoration||"").split(" "),d=l.fontWeight==="700"||l.fontWeight==="bold",f=c.includes("line-through"),p=l.fontStyle==="italic",g=c.includes("underline");return{after:y=>{const v=[];let _=null;const b=()=>{if(_){const N=_.getFirstChild();kc(N)&&_.getChildrenSize()===1&&N.remove()}};for(const N of y)XB(N)||Gt(N)||kc(N)?(Gt(N)&&(d&&N.toggleFormat("bold"),f&&N.toggleFormat("strikethrough"),p&&N.toggleFormat("italic"),g&&N.toggleFormat("underline")),_?_.append(N):(_=Un().append(N),v.push(_))):(v.push(N),b(),_=null);return b(),v.length===0&&v.push(Un()),v},node:s}}function vj(e=e0.NO_STATUS,t=1,r){return gi(new A0(e,t,r))}function cp(e){return e instanceof A0}function n2(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}class j0 extends Ka{static getType(){return"tablerow"}static clone(t){return new j0(t.__height,t.__key)}static importDOM(){return{tr:t=>({conversion:c$,priority:0})}}static importJSON(t){return wj().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeight(t.height)}constructor(t,r){super(r),this.__height=t}exportJSON(){const t=this.getHeight();return{...super.exportJSON(),...t===void 0?void 0:{height:t}}}createDOM(t){const r=document.createElement("tr");return this.__height&&(r.style.height=`${this.__height}px`),Vs(r,t.theme.tableRow),r}extractWithChild(t,r,n){return n==="html"}isShadowRoot(){return!0}setHeight(t){const r=this.getWritable();return r.__height=t,r}getHeight(){return this.getLatest().__height}updateDOM(t){return t.__height!==this.__height}canBeEmpty(){return!1}canIndent(){return!1}}function c$(e){const t=e;let r;return Yb.test(t.style.height)&&(r=parseFloat(t.style.height)),{after:n=>ij(n,cp),node:wj(r)}}function wj(e){return gi(new j0(e))}function _j(e){return e instanceof j0}const bj=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,u$=bj&&"documentMode"in document?document.documentMode:null;bj&&"InputEvent"in window&&!u$&&new window.InputEvent("input");function d$(e,t,r){const n=[];let s=null,a=null;function i(c){let d=n[c];return d===void 0&&(n[c]=d=[]),d}const l=e.getChildren();for(let c=0;c<l.length;c++){const d=l[c];_j(d)||n2(209);const f=i(c);for(let p=d.getFirstChild(),g=0;p!=null;p=p.getNextSibling()){for(cp(p)||n2(147);f[g]!==void 0;)g++;const y={cell:p,startColumn:g,startRow:c},{__rowSpan:v,__colSpan:_}=p;for(let b=0;b<v&&!(c+b>=l.length);b++){const N=i(c+b);for(let k=0;k<_;k++)N[g+k]=y}}}return[n,s,a]}function ym(e){return $n(e)&&e.nodeName==="TABLE"}function f$(e,t){for(let r=t,n=null;r!==null;r=r.getParent()){if(e.is(r))return n;cp(r)&&(n=r)}return null}function h$(e,t,r){return f$(e,Uu(t,r))}function jE(e,t,r){if(!t.theme.tableAlignment)return;const n=[],s=[];for(const a of["center","right"]){const i=t.theme.tableAlignment[a];i&&(a===r?s:n).push(i)}Mu(e,...n),Vs(e,...s)}const g$=new WeakSet;function FE(e=Bp()){return g$.has(e)}class zp extends Ka{static getType(){return"table"}getColWidths(){return this.getLatest().__colWidths}setColWidths(t){const r=this.getWritable();return r.__colWidths=t,r}static clone(t){return new zp(t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__colWidths=t.__colWidths,this.__rowStriping=t.__rowStriping,this.__frozenColumnCount=t.__frozenColumnCount,this.__frozenRowCount=t.__frozenRowCount}static importDOM(){return{table:t=>({conversion:m$,priority:1})}}static importJSON(t){return Sj().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setRowStriping(t.rowStriping||!1).setFrozenColumns(t.frozenColumnCount||0).setFrozenRows(t.frozenRowCount||0).setColWidths(t.colWidths)}constructor(t){super(t),this.__rowStriping=!1,this.__frozenColumnCount=0,this.__frozenRowCount=0}exportJSON(){return{...super.exportJSON(),colWidths:this.getColWidths(),frozenColumnCount:this.__frozenColumnCount?this.__frozenColumnCount:void 0,frozenRowCount:this.__frozenRowCount?this.__frozenRowCount:void 0,rowStriping:this.__rowStriping?this.__rowStriping:void 0}}extractWithChild(t,r,n){return n==="html"}getDOMSlot(t){const r=ym(t)?t:t.querySelector("table");return ym(r)||n2(229),super.getDOMSlot(t).withElement(r).withAfter(r.querySelector("colgroup"))}createDOM(t,r){const n=document.createElement("table");this.__style&&(n.style.cssText=this.__style);const s=document.createElement("colgroup");if(n.appendChild(s),eU(s),Vs(n,t.theme.table),this.updateTableElement(null,n,t),FE(r)){const a=document.createElement("div"),i=t.theme.tableScrollableWrapper;return i?Vs(a,i):a.style.cssText="overflow-x: auto;",a.appendChild(n),this.updateTableWrapper(null,a,n,t),a}return n}updateTableWrapper(t,r,n,s){this.__frozenColumnCount!==(t?t.__frozenColumnCount:0)&&(function(a,i,l,c){c>0?(Vs(a,l.theme.tableFrozenColumn),i.setAttribute("data-lexical-frozen-column","true")):(Mu(a,l.theme.tableFrozenColumn),i.removeAttribute("data-lexical-frozen-column"))})(r,n,s,this.__frozenColumnCount),this.__frozenRowCount!==(t?t.__frozenRowCount:0)&&(function(a,i,l,c){c>0?(Vs(a,l.theme.tableFrozenRow),i.setAttribute("data-lexical-frozen-row","true")):(Mu(a,l.theme.tableFrozenRow),i.removeAttribute("data-lexical-frozen-row"))})(r,n,s,this.__frozenRowCount)}updateTableElement(t,r,n){this.__style!==(t?t.__style:"")&&(r.style.cssText=this.__style),this.__rowStriping!==(!!t&&t.__rowStriping)&&(function(s,a,i){i?(Vs(s,a.theme.tableRowStriping),s.setAttribute("data-lexical-row-striping","true")):(Mu(s,a.theme.tableRowStriping),s.removeAttribute("data-lexical-row-striping"))})(r,n,this.__rowStriping),(function(s,a,i,l){const c=s.querySelector("colgroup");if(!c)return;const d=[];for(let f=0;f<i;f++){const p=document.createElement("col"),g=l&&l[f];g&&(p.style.width=`${g}px`),d.push(p)}c.replaceChildren(...d)})(r,0,this.getColumnCount(),this.getColWidths()),jE(r,n,this.getFormatType())}updateDOM(t,r,n){const s=this.getDOMSlot(r).element;return r===s===FE()||($n(a=r)&&a.nodeName==="DIV"&&this.updateTableWrapper(t,r,s,n),this.updateTableElement(t,s,n),!1);var a}exportDOM(t){const r=super.exportDOM(t),{element:n}=r;return{after:s=>{if(r.after&&(s=r.after(s)),!ym(s)&&$n(s)&&(s=s.querySelector("table")),!ym(s))return null;jE(s,t._config,this.getFormatType());const[a]=d$(this),i=new Map;for(const f of a)for(const p of f){const g=p.cell.getKey();i.has(g)||i.set(g,{colSpan:p.cell.getColSpan(),startColumn:p.startColumn})}const l=new Set;for(const f of s.querySelectorAll(":scope > tr > [data-temporary-table-cell-lexical-key]")){const p=f.getAttribute("data-temporary-table-cell-lexical-key");if(p){const g=i.get(p);if(f.removeAttribute("data-temporary-table-cell-lexical-key"),g){i.delete(p);for(let y=0;y<g.colSpan;y++)l.add(y+g.startColumn)}}}const c=s.querySelector(":scope > colgroup");if(c){const f=Array.from(s.querySelectorAll(":scope > colgroup > col")).filter(((p,g)=>l.has(g)));c.replaceChildren(...f)}const d=s.querySelectorAll(":scope > tr");if(d.length>0){const f=document.createElement("tbody");for(const p of d)f.appendChild(p);s.append(f)}return s},element:!ym(n)&&$n(n)?n.querySelector("table"):n}}canBeEmpty(){return!1}isShadowRoot(){return!0}getCordsFromCellNode(t,r){const{rows:n,domRows:s}=r;for(let a=0;a<n;a++){const i=s[a];if(i!=null)for(let l=0;l<i.length;l++){const c=i[l];if(c==null)continue;const{elem:d}=c,f=h$(this,d);if(f!==null&&t.is(f))return{x:l,y:a}}}throw new Error("Cell not found in table.")}getDOMCellFromCords(t,r,n){const{domRows:s}=n,a=s[r];if(a==null)return null;const i=a[t<a.length?t:a.length-1];return i??null}getDOMCellFromCordsOrThrow(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(!s)throw new Error("Cell not found at cords.");return s}getCellNodeFromCords(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(s==null)return null;const a=Uu(s.elem);return cp(a)?a:null}getCellNodeFromCordsOrThrow(t,r,n){const s=this.getCellNodeFromCords(t,r,n);if(!s)throw new Error("Node at cords not TableCellNode.");return s}getRowStriping(){return!!this.getLatest().__rowStriping}setRowStriping(t){const r=this.getWritable();return r.__rowStriping=t,r}setFrozenColumns(t){const r=this.getWritable();return r.__frozenColumnCount=t,r}getFrozenColumns(){return this.getLatest().__frozenColumnCount}setFrozenRows(t){const r=this.getWritable();return r.__frozenRowCount=t,r}getFrozenRows(){return this.getLatest().__frozenRowCount}canSelectBefore(){return!0}canIndent(){return!1}getColumnCount(){const t=this.getFirstChild();if(!t)return 0;let r=0;return t.getChildren().forEach((n=>{cp(n)&&(r+=n.getColSpan())})),r}}function m$(e){const t=Sj();e.hasAttribute("data-lexical-row-striping")&&t.setRowStriping(!0),e.hasAttribute("data-lexical-frozen-column")&&t.setFrozenColumns(1),e.hasAttribute("data-lexical-frozen-row")&&t.setFrozenRows(1);const r=e.querySelector(":scope > colgroup");if(r){let n=[];for(const s of r.querySelectorAll(":scope > col")){let a=s.style.width||"";if(!Yb.test(a)&&(a=s.getAttribute("width")||"",!/^\d+$/.test(a))){n=void 0;break}n.push(parseFloat(a))}n&&t.setColWidths(n)}return{after:n=>ij(n,_j),node:t}}function Sj(){return gi(new zp)}function ju(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function s2(e){let t=1,r=e.getParent();for(;r!=null;){if(on(r)){const n=r.getParent();if(jr(n)){t++,r=n.getParent();continue}ju(40)}return t}return t}function a2(e){let t=e.getParent();jr(t)||ju(40);let r=t;for(;r!==null;)r=r.getParent(),jr(r)&&(t=r);return t}function kj(e){let t=[];const r=e.getChildren().filter(on);for(let n=0;n<r.length;n++){const s=r[n],a=s.getFirstChild();jr(a)?t=t.concat(kj(a)):t.push(s)}return t}function Fl(e){return on(e)&&jr(e.getFirstChild())}function PE(e){return Ki().append(e)}function Cj(e,t){return on(e)&&(t.length===0||t.length===1&&e.is(t[0])&&e.getChildrenSize()===0)}function RE(e){const t=Ht();if(t!==null){let r=t.getNodes();if(Tt(t)){const s=t.getStartEndPoints();s===null&&ju(143);const[a]=s,i=a.getNode(),l=i.getParent();if(fi(i)){const c=i.getFirstChild();if(c)r=c.selectStart().getNodes();else{const d=Un();i.append(d),r=d.select().getNodes()}}else if(Cj(i,r)){const c=ji(e);if(fi(l)){i.replace(c);const d=Ki();yt(i)&&(d.setFormat(i.getFormatType()),d.setIndent(i.getIndent())),c.append(d)}else if(on(i)){const d=i.getParentOrThrow();ff(c,d.getChildren()),d.replace(c)}return}}const n=new Set;for(let s=0;s<r.length;s++){const a=r[s];if(yt(a)&&a.isEmpty()&&!on(a)&&!n.has(a.getKey())){DE(a,e);continue}let i=DA(a)?a.getParent():on(a)&&a.isEmpty()?a:null;for(;i!=null;){const l=i.getKey();if(jr(i)){if(!n.has(l)){const c=ji(e);ff(c,i.getChildren()),i.replace(c),n.add(l)}break}{const c=i.getParent();if(fi(c)&&!n.has(l)){n.add(l),DE(i,e);break}i=c}}}}}function ff(e,t){e.splice(e.getChildrenSize(),0,t)}function DE(e,t){if(jr(e))return e;const r=e.getPreviousSibling(),n=e.getNextSibling(),s=Ki();let a;if(ff(s,e.getChildren()),jr(r)&&t===r.getListType())r.append(s),jr(n)&&t===n.getListType()&&(ff(r,n.getChildren()),n.remove()),a=r;else if(jr(n)&&t===n.getListType())n.getFirstChildOrThrow().insertBefore(s),a=n;else{const i=ji(t);i.append(s),e.replace(i),a=i}return s.setFormat(e.getFormatType()),s.setIndent(e.getIndent()),e.remove(),a}function Jb(e,t){const r=e.getLastChild(),n=t.getFirstChild();r&&n&&Fl(r)&&Fl(n)&&(Jb(r.getFirstChild(),n.getFirstChild()),n.remove());const s=t.getChildren();s.length>0&&e.append(...s),t.remove()}function p$(){const e=Ht();if(Tt(e)){const t=new Set,r=e.getNodes(),n=e.anchor.getNode();if(Cj(n,r))t.add(a2(n));else for(let s=0;s<r.length;s++){const a=r[s];if(DA(a)){const i=EU(a,Dc);i!=null&&t.add(a2(i))}}for(const s of t){let a=s;const i=kj(s);for(const l of i){const c=Un().setTextStyle(e.style).setTextFormat(e.format);ff(c,l.getChildren()),a.insertAfter(c),a=c,l.__key===e.anchor.key&&df(e.anchor,wo(ko(c,"next"))),l.__key===e.focus.key&&df(e.focus,wo(ko(c,"next"))),l.remove()}s.remove()}}}function Tj(e){const t=e.getListType()!=="check";let r=e.getStart();for(const n of e.getChildren())on(n)&&(n.getValue()!==r&&n.setValue(r),t&&n.getLatest().__checked!=null&&n.setChecked(void 0),jr(n.getFirstChild())||r++)}function x$(e){const t=new Set;if(Fl(e)||t.has(e.getKey()))return;const r=e.getParent(),n=e.getNextSibling(),s=e.getPreviousSibling();if(Fl(n)&&Fl(s)){const a=s.getFirstChild();if(jr(a)){a.append(e);const i=n.getFirstChild();jr(i)&&(ff(a,i.getChildren()),n.remove(),t.add(n.getKey()))}}else if(Fl(n)){const a=n.getFirstChild();if(jr(a)){const i=a.getFirstChild();i!==null&&i.insertBefore(e)}}else if(Fl(s)){const a=s.getFirstChild();jr(a)&&a.append(e)}else if(jr(r)){const a=Ki().setTextFormat(e.getTextFormat()).setTextStyle(e.getTextStyle()),i=ji(r.getListType()).setTextFormat(r.getTextFormat()).setTextStyle(r.getTextStyle());a.append(i),i.append(e),s?s.insertAfter(a):n?n.insertBefore(a):r.append(a)}}function y$(e){if(Fl(e))return;const t=e.getParent(),r=t?t.getParent():void 0;if(jr(r?r.getParent():void 0)&&on(r)&&jr(t)){const n=t?t.getFirstChild():void 0,s=t?t.getLastChild():void 0;if(e.is(n))r.insertBefore(e),t.isEmpty()&&r.remove();else if(e.is(s))r.insertAfter(e),t.isEmpty()&&r.remove();else{const a=t.getListType(),i=Ki(),l=ji(a);i.append(l),e.getPreviousSiblings().forEach((f=>l.append(f)));const c=Ki(),d=ji(a);c.append(d),ff(d,e.getNextSiblings()),r.insertBefore(i),r.insertAfter(c),r.replace(e)}}}function v$(){const e=Ht();if(!Tt(e)||!e.isCollapsed())return!1;const t=e.anchor.getNode();if(!on(t)||t.getChildrenSize()!==0)return!1;const r=a2(t),n=t.getParent();jr(n)||ju(40);const s=n.getParent();let a;if(fi(s))a=Un(),r.insertAfter(a);else{if(!on(s))return!1;a=Ki(),s.insertAfter(a)}a.setTextStyle(e.style).setTextFormat(e.format).select();const i=t.getNextSiblings();if(i.length>0){const l=ji(n.getListType());if(on(a)){const c=Ki();c.append(l),a.insertAfter(c)}else a.insertAfter(l);l.append(...i)}return(function(l){let c=l;for(;c.getNextSibling()==null&&c.getPreviousSibling()==null;){const d=c.getParent();if(d==null||!on(d)&&!jr(d))break;c=d}c.remove()})(t),!0}function u1(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}let Dc=class extends Ka{$config(){return this.config("listitem",{$transform:t=>{if(t.__checked==null)return;const r=t.getParent();jr(r)&&r.getListType()!=="check"&&t.getChecked()!=null&&t.setChecked(void 0)},extends:Ka,importDOM:{li:()=>({conversion:w$,priority:0})}})}constructor(t=1,r=void 0,n){super(n),this.__value=t===void 0?1:t,this.__checked=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__value=t.__value,this.__checked=t.__checked}createDOM(t){const r=document.createElement("li");return this.updateListItemDOM(null,r,t),r}updateListItemDOM(t,r,n){const s=this.getParent();jr(s)&&s.getListType()==="check"&&(function(l,c,d,f){jr(c.getFirstChild())?(l.removeAttribute("role"),l.removeAttribute("tabIndex"),l.removeAttribute("aria-checked")):(l.setAttribute("role","checkbox"),l.setAttribute("tabIndex","-1"),d&&c.__checked===d.__checked||l.setAttribute("aria-checked",c.getChecked()?"true":"false"))})(r,this,t),r.value=this.__value,(function(l,c,d){const f=[],p=[],g=c.list,y=g?g.listitem:void 0;let v;if(g&&g.nested&&(v=g.nested.listitem),y!==void 0&&f.push(...u1(y)),g){const _=d.getParent(),b=jr(_)&&_.getListType()==="check",N=d.getChecked();b&&!N||p.push(g.listitemUnchecked),b&&N||p.push(g.listitemChecked),b&&f.push(N?g.listitemChecked:g.listitemUnchecked)}if(v!==void 0){const _=u1(v);d.getChildren().some((b=>jr(b)))?f.push(..._):p.push(..._)}p.length>0&&Mu(l,...p),f.length>0&&Vs(l,...f)})(r,n.theme,this);const a=t?t.__style:"",i=this.__style;a!==i&&(i===""?r.removeAttribute("style"):r.style.cssText=i),(function(l,c,d){const f=cE(c.__textStyle);for(const p in f)l.style.setProperty(`--listitem-marker-${p}`,f[p]);if(d)for(const p in cE(d.__textStyle))p in f||l.style.removeProperty(`--listitem-marker-${p}`)})(r,this,t)}updateDOM(t,r,n){const s=r;return this.updateListItemDOM(t,s,n),!1}updateFromJSON(t){return super.updateFromJSON(t).setValue(t.value).setChecked(t.checked)}exportDOM(t){const r=this.createDOM(t._config),n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();return s&&(r.dir=s),{element:r}}exportJSON(){return{...super.exportJSON(),checked:this.getChecked(),value:this.getValue()}}append(...t){for(let r=0;r<t.length;r++){const n=t[r];if(yt(n)&&this.canMergeWith(n)){const s=n.getChildren();this.append(...s),n.remove()}else super.append(n)}return this}replace(t,r){if(on(t))return super.replace(t);this.setIndent(0);const n=this.getParentOrThrow();if(!jr(n))return t;if(n.__first===this.getKey())n.insertBefore(t);else if(n.__last===this.getKey())n.insertAfter(t);else{const s=ji(n.getListType());let a=this.getNextSibling();for(;a;){const i=a;a=a.getNextSibling(),s.append(i)}n.insertAfter(t),t.insertAfter(s)}return r&&(yt(t)||ju(139),this.getChildren().forEach((s=>{t.append(s)}))),this.remove(),n.getChildrenSize()===0&&n.remove(),t}insertAfter(t,r=!0){const n=this.getParentOrThrow();if(jr(n)||ju(39),on(t))return super.insertAfter(t,r);const s=this.getNextSiblings();if(n.insertAfter(t,r),s.length!==0){const a=ji(n.getListType());s.forEach((i=>a.append(i))),t.insertAfter(a,r)}return t}remove(t){const r=this.getPreviousSibling(),n=this.getNextSibling();super.remove(t),r&&n&&Fl(r)&&Fl(n)&&(Jb(r.getFirstChild(),n.getFirstChild()),n.remove())}insertNewAfter(t,r=!0){const n=Ki().updateFromJSON(this.exportJSON()).setChecked(!this.getChecked()&&void 0);return this.insertAfter(n,r),n}collapseAtStart(t){const r=Un();this.getChildren().forEach((i=>r.append(i)));const n=this.getParentOrThrow(),s=n.getParentOrThrow(),a=on(s);if(n.getChildrenSize()===1)if(a)n.remove(),s.select();else{n.insertBefore(r),n.remove();const i=t.anchor,l=t.focus,c=r.getKey();i.type==="element"&&i.getNode().is(this)&&i.set(c,i.offset,"element"),l.type==="element"&&l.getNode().is(this)&&l.set(c,l.offset,"element")}else n.insertBefore(r),this.remove();return!0}getValue(){return this.getLatest().__value}setValue(t){const r=this.getWritable();return r.__value=t,r}getChecked(){const t=this.getLatest();let r;const n=this.getParent();return jr(n)&&(r=n.getListType()),r==="check"?!!t.__checked:void 0}setChecked(t){const r=this.getWritable();return r.__checked=t,r}toggleChecked(){const t=this.getWritable();return t.setChecked(!t.__checked)}getIndent(){const t=this.getParent();if(t===null||!this.isAttached())return this.getLatest().__indent;let r=t.getParentOrThrow(),n=0;for(;on(r);)r=r.getParentOrThrow().getParentOrThrow(),n++;return n}setIndent(t){typeof t!="number"&&ju(117),(t=Math.floor(t))>=0||ju(199);let r=this.getIndent();for(;r!==t;)r<t?(x$(this),r++):(y$(this),r--);return this}canInsertAfter(t){return on(t)}canReplaceWith(t){return on(t)}canMergeWith(t){return on(t)||jb(t)}extractWithChild(t,r){if(!Tt(r))return!1;const n=r.anchor.getNode(),s=r.focus.getNode();return this.isParentOf(n)&&this.isParentOf(s)&&this.getTextContent().length===r.getTextContent().length}isParentRequired(){return!0}createParentElementNode(){return ji("bullet")}canMergeWhenEmpty(){return!0}};function w$(e){if(e.classList.contains("task-list-item")){for(const r of e.children)if(r.tagName==="INPUT")return _$(r)}const t=e.getAttribute("aria-checked");return{node:Ki(t==="true"||t!=="false"&&void 0)}}function _$(e){return e.getAttribute("type")!=="checkbox"?{node:null}:{node:Ki(e.hasAttribute("checked"))}}function Ki(e){return gi(new Dc(void 0,e))}function on(e){return e instanceof Dc}let Ju=class extends Ka{$config(){return this.config("list",{$transform:t=>{(function(r){const n=r.getNextSibling();jr(n)&&r.getListType()===n.getListType()&&Jb(r,n)})(t),Tj(t)},extends:Ka,importDOM:{ol:()=>({conversion:ME,priority:0}),ul:()=>({conversion:ME,priority:0})}})}constructor(t="number",r=1,n){super(n);const s=S$[t]||t;this.__listType=s,this.__tag=s==="number"?"ol":"ul",this.__start=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__listType=t.__listType,this.__tag=t.__tag,this.__start=t.__start}getTag(){return this.getLatest().__tag}setListType(t){const r=this.getWritable();return r.__listType=t,r.__tag=t==="number"?"ol":"ul",r}getListType(){return this.getLatest().__listType}getStart(){return this.getLatest().__start}setStart(t){const r=this.getWritable();return r.__start=t,r}createDOM(t,r){const n=this.__tag,s=document.createElement(n);return this.__start!==1&&s.setAttribute("start",String(this.__start)),s.__lexicalListType=this.__listType,IE(s,t.theme,this),s}updateDOM(t,r,n){return t.__tag!==this.__tag||(IE(r,n.theme,this),!1)}updateFromJSON(t){return super.updateFromJSON(t).setListType(t.listType).setStart(t.start)}exportDOM(t){const r=this.createDOM(t._config,t);return $n(r)&&(this.__start!==1&&r.setAttribute("start",String(this.__start)),this.__listType==="check"&&r.setAttribute("__lexicalListType","check")),{element:r}}exportJSON(){return{...super.exportJSON(),listType:this.getListType(),start:this.getStart(),tag:this.getTag()}}canBeEmpty(){return!1}canIndent(){return!1}splice(t,r,n){let s=n;for(let a=0;a<n.length;a++){const i=n[a];on(i)||(s===n&&(s=[...n]),s[a]=Ki().append(!yt(i)||jr(i)||i.isInline()?i:cs(i.getTextContent())))}return super.splice(t,r,s)}extractWithChild(t){return on(t)}};function IE(e,t,r){const n=[],s=[],a=t.list;if(a!==void 0){const i=a[`${r.__tag}Depth`]||[],l=s2(r)-1,c=l%i.length,d=i[c],f=a[r.__tag];let p;const g=a.nested,y=a.checklist;if(g!==void 0&&g.list&&(p=g.list),f!==void 0&&n.push(f),y!==void 0&&r.__listType==="check"&&n.push(y),d!==void 0){n.push(...u1(d));for(let v=0;v<i.length;v++)v!==c&&s.push(r.__tag+v)}if(p!==void 0){const v=u1(p);l>1?n.push(...v):s.push(...v)}}s.length>0&&Mu(e,...s),n.length>0&&Vs(e,...n)}function b$(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];if(on(n)){t.push(n);const s=n.getChildren();s.length>1&&s.forEach((a=>{jr(a)&&t.push(PE(a))}))}else t.push(PE(n))}return t}function ME(e){const t=e.nodeName.toLowerCase();let r=null;return t==="ol"?r=ji("number",e.start):t==="ul"&&(r=(function(n){if(n.getAttribute("__lexicallisttype")==="check"||n.classList.contains("contains-task-list"))return!0;for(const s of n.childNodes)if($n(s)&&s.hasAttribute("aria-checked"))return!0;return!1})(e)?ji("check"):ji("bullet")),{after:b$,node:r}}const S$={ol:"number",ul:"bullet"};function ji(e="number",t=1){return gi(new Ju(e,t))}function jr(e){return e instanceof Ju}const k$=_r("UPDATE_LIST_START_COMMAND"),Qb=_r("INSERT_UNORDERED_LIST_COMMAND"),Zb=_r("INSERT_ORDERED_LIST_COMMAND"),eS=_r("REMOVE_LIST_COMMAND");function C$(e){return wf(e.registerCommand(Zb,(()=>(RE("number"),!0)),Ih),e.registerCommand(k$,(t=>{const{listNodeKey:r,newStart:n}=t,s=Os(r);return!!jr(s)&&(s.getListType()==="number"&&(s.setStart(n),Tj(s)),!0)}),Ih),e.registerCommand(Qb,(()=>(RE("bullet"),!0)),Ih),e.registerCommand(eS,(()=>(p$(),!0)),Ih),e.registerCommand(ap,(()=>v$()),Ih),e.registerNodeTransform(Dc,(t=>{const r=t.getFirstChild();if(r){if(Gt(r)){const n=r.getStyle(),s=r.getFormat();t.getTextStyle()!==n&&t.setTextStyle(n),t.getTextFormat()!==s&&t.setTextFormat(s)}}else{const n=Ht();Tt(n)&&(n.style!==t.getTextStyle()||n.format!==t.getTextFormat())&&n.isCollapsed()&&t.is(n.anchor.getNode())&&t.setTextStyle(n.style).setTextFormat(n.format)}})),e.registerNodeTransform(Xu,(t=>{const r=t.getParent();if(on(r)&&t.is(r.getFirstChild())){const n=t.getStyle(),s=t.getFormat();n===r.getTextStyle()&&s===r.getTextFormat()||r.setTextStyle(n).setTextFormat(s)}})))}function T$(e){const t=r=>{const n=r.getParent();if(jr(r.getFirstChild())||!jr(n))return;const s=Y1(r,(a=>on(a)&&jr(a.getParent())&&on(a.getPreviousSibling())));if(s===null&&r.getIndent()>0)r.setIndent(0);else if(on(s)){const a=s.getPreviousSibling();if(on(a)){const i=(function(c){let d=c,f=d.getFirstChild();for(;jr(f);){const p=f.getLastChild();if(!on(p))break;d=p,f=d.getFirstChild()}return d})(a),l=i.getParent();if(jr(l)){const c=s2(l);c+1<s2(n)&&r.setIndent(c)}}}};return e.registerNodeTransform(Ju,(r=>{const n=[r];for(;n.length>0;){const s=n.shift();if(jr(s)){for(const a of s.getChildren())if(on(a)){t(a);const i=a.getFirstChild();jr(i)&&n.push(i)}}}}))}var Mw={exports:{}},OE;function E$(){return OE||(OE=1,(function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var r=(function(n){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,a=0,i={},l={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function k(w){return w instanceof c?new c(w.type,k(w.content),w.alias):Array.isArray(w)?w.map(k):w.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(k){return Object.prototype.toString.call(k).slice(8,-1)},objId:function(k){return k.__id||Object.defineProperty(k,"__id",{value:++a}),k.__id},clone:function k(w,T){T=T||{};var A,F;switch(l.util.type(w)){case"Object":if(F=l.util.objId(w),T[F])return T[F];A={},T[F]=A;for(var R in w)w.hasOwnProperty(R)&&(A[R]=k(w[R],T));return A;case"Array":return F=l.util.objId(w),T[F]?T[F]:(A=[],T[F]=A,w.forEach(function(E,D){A[D]=k(E,T)}),A);default:return w}},getLanguage:function(k){for(;k;){var w=s.exec(k.className);if(w)return w[1].toLowerCase();k=k.parentElement}return"none"},setLanguage:function(k,w){k.className=k.className.replace(RegExp(s,"gi"),""),k.classList.add("language-"+w)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(A){var k=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(A.stack)||[])[1];if(k){var w=document.getElementsByTagName("script");for(var T in w)if(w[T].src==k)return w[T]}return null}},isActive:function(k,w,T){for(var A="no-"+w;k;){var F=k.classList;if(F.contains(w))return!0;if(F.contains(A))return!1;k=k.parentElement}return!!T}},languages:{plain:i,plaintext:i,text:i,txt:i,extend:function(k,w){var T=l.util.clone(l.languages[k]);for(var A in w)T[A]=w[A];return T},insertBefore:function(k,w,T,A){A=A||l.languages;var F=A[k],R={};for(var E in F)if(F.hasOwnProperty(E)){if(E==w)for(var D in T)T.hasOwnProperty(D)&&(R[D]=T[D]);T.hasOwnProperty(E)||(R[E]=F[E])}var I=A[k];return A[k]=R,l.languages.DFS(l.languages,function(G,Y){Y===I&&G!=k&&(this[G]=R)}),R},DFS:function k(w,T,A,F){F=F||{};var R=l.util.objId;for(var E in w)if(w.hasOwnProperty(E)){T.call(w,E,w[E],A||E);var D=w[E],I=l.util.type(D);I==="Object"&&!F[R(D)]?(F[R(D)]=!0,k(D,T,null,F)):I==="Array"&&!F[R(D)]&&(F[R(D)]=!0,k(D,T,E,F))}}},plugins:{},highlightAll:function(k,w){l.highlightAllUnder(document,k,w)},highlightAllUnder:function(k,w,T){var A={callback:T,container:k,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};l.hooks.run("before-highlightall",A),A.elements=Array.prototype.slice.apply(A.container.querySelectorAll(A.selector)),l.hooks.run("before-all-elements-highlight",A);for(var F=0,R;R=A.elements[F++];)l.highlightElement(R,w===!0,A.callback)},highlightElement:function(k,w,T){var A=l.util.getLanguage(k),F=l.languages[A];l.util.setLanguage(k,A);var R=k.parentElement;R&&R.nodeName.toLowerCase()==="pre"&&l.util.setLanguage(R,A);var E=k.textContent,D={element:k,language:A,grammar:F,code:E};function I(Y){D.highlightedCode=Y,l.hooks.run("before-insert",D),D.element.innerHTML=D.highlightedCode,l.hooks.run("after-highlight",D),l.hooks.run("complete",D),T&&T.call(D.element)}if(l.hooks.run("before-sanity-check",D),R=D.element.parentElement,R&&R.nodeName.toLowerCase()==="pre"&&!R.hasAttribute("tabindex")&&R.setAttribute("tabindex","0"),!D.code){l.hooks.run("complete",D),T&&T.call(D.element);return}if(l.hooks.run("before-highlight",D),!D.grammar){I(l.util.encode(D.code));return}if(w&&n.Worker){var G=new Worker(l.filename);G.onmessage=function(Y){I(Y.data)},G.postMessage(JSON.stringify({language:D.language,code:D.code,immediateClose:!0}))}else I(l.highlight(D.code,D.grammar,D.language))},highlight:function(k,w,T){var A={code:k,grammar:w,language:T};if(l.hooks.run("before-tokenize",A),!A.grammar)throw new Error('The language "'+A.language+'" has no grammar.');return A.tokens=l.tokenize(A.code,A.grammar),l.hooks.run("after-tokenize",A),c.stringify(l.util.encode(A.tokens),A.language)},tokenize:function(k,w){var T=w.rest;if(T){for(var A in T)w[A]=T[A];delete w.rest}var F=new p;return g(F,F.head,k),f(k,F,w,F.head,0),v(F)},hooks:{all:{},add:function(k,w){var T=l.hooks.all;T[k]=T[k]||[],T[k].push(w)},run:function(k,w){var T=l.hooks.all[k];if(!(!T||!T.length))for(var A=0,F;F=T[A++];)F(w)}},Token:c};n.Prism=l;function c(k,w,T,A){this.type=k,this.content=w,this.alias=T,this.length=(A||"").length|0}c.stringify=function k(w,T){if(typeof w=="string")return w;if(Array.isArray(w)){var A="";return w.forEach(function(I){A+=k(I,T)}),A}var F={type:w.type,content:k(w.content,T),tag:"span",classes:["token",w.type],attributes:{},language:T},R=w.alias;R&&(Array.isArray(R)?Array.prototype.push.apply(F.classes,R):F.classes.push(R)),l.hooks.run("wrap",F);var E="";for(var D in F.attributes)E+=" "+D+'="'+(F.attributes[D]||"").replace(/"/g,"&quot;")+'"';return"<"+F.tag+' class="'+F.classes.join(" ")+'"'+E+">"+F.content+"</"+F.tag+">"};function d(k,w,T,A){k.lastIndex=w;var F=k.exec(T);if(F&&A&&F[1]){var R=F[1].length;F.index+=R,F[0]=F[0].slice(R)}return F}function f(k,w,T,A,F,R){for(var E in T)if(!(!T.hasOwnProperty(E)||!T[E])){var D=T[E];D=Array.isArray(D)?D:[D];for(var I=0;I<D.length;++I){if(R&&R.cause==E+","+I)return;var G=D[I],Y=G.inside,ee=!!G.lookbehind,ie=!!G.greedy,re=G.alias;if(ie&&!G.pattern.global){var se=G.pattern.toString().match(/[imsuy]*$/)[0];G.pattern=RegExp(G.pattern.source,se+"g")}for(var B=G.pattern||G,z=A.next,U=F;z!==w.tail&&!(R&&U>=R.reach);U+=z.value.length,z=z.next){var V=z.value;if(w.length>k.length)return;if(!(V instanceof c)){var q=1,L;if(ie){if(L=d(B,U,k,ee),!L||L.index>=k.length)break;var Z=L.index,M=L.index+L[0].length,X=U;for(X+=z.value.length;Z>=X;)z=z.next,X+=z.value.length;if(X-=z.value.length,U=X,z.value instanceof c)continue;for(var K=z;K!==w.tail&&(X<M||typeof K.value=="string");K=K.next)q++,X+=K.value.length;q--,V=k.slice(U,X),L.index-=U}else if(L=d(B,0,V,ee),!L)continue;var Z=L.index,J=L[0],ne=V.slice(0,Z),me=V.slice(Z+J.length),xe=U+V.length;R&&xe>R.reach&&(R.reach=xe);var Ne=z.prev;ne&&(Ne=g(w,Ne,ne),U+=ne.length),y(w,Ne,q);var le=new c(E,Y?l.tokenize(J,Y):J,re,J);if(z=g(w,Ne,le),me&&g(w,z,me),q>1){var ge={cause:E+","+I,reach:xe};f(k,w,T,z.prev,U,ge),R&&ge.reach>R.reach&&(R.reach=ge.reach)}}}}}}function p(){var k={value:null,prev:null,next:null},w={value:null,prev:k,next:null};k.next=w,this.head=k,this.tail=w,this.length=0}function g(k,w,T){var A=w.next,F={value:T,prev:w,next:A};return w.next=F,A.prev=F,k.length++,F}function y(k,w,T){for(var A=w.next,F=0;F<T&&A!==k.tail;F++)A=A.next;w.next=A,A.prev=w,k.length-=F}function v(k){for(var w=[],T=k.head.next;T!==k.tail;)w.push(T.value),T=T.next;return w}if(!n.document)return n.addEventListener&&(l.disableWorkerMessageHandler||n.addEventListener("message",function(k){var w=JSON.parse(k.data),T=w.language,A=w.code,F=w.immediateClose;n.postMessage(l.highlight(A,l.languages[T],T)),F&&n.close()},!1)),l;var _=l.util.currentScript();_&&(l.filename=_.src,_.hasAttribute("data-manual")&&(l.manual=!0));function b(){l.manual||l.highlightAll()}if(!l.manual){var N=document.readyState;N==="loading"||N==="interactive"&&_&&_.defer?document.addEventListener("DOMContentLoaded",b):window.requestAnimationFrame?window.requestAnimationFrame(b):window.setTimeout(b,16)}return l})(t);e.exports&&(e.exports=r),typeof Uy<"u"&&(Uy.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(n){n.type==="entity"&&(n.attributes.title=n.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(s,a){var i={};i["language-"+a]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[a]},i.cdata=/^<!\[CDATA\[|\]\]>$/i;var l={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:i}};l["language-"+a]={pattern:/[\s\S]+/,inside:r.languages[a]};var c={};c[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:l},r.languages.insertBefore("markup","cdata",c)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(n,s){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+n+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:r.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,(function(n){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;n.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},n.languages.css.atrule.inside.rest=n.languages.css;var a=n.languages.markup;a&&(a.tag.addInlined("style","css"),a.tag.addAttribute("style","css"))})(r),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,(function(){if(typeof r>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var n="Loading",s=function(_,b){return" Error "+_+" while fetching file: "+b},a=" Error: File does not exist or is empty",i={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},l="data-src-status",c="loading",d="loaded",f="failed",p="pre[data-src]:not(["+l+'="'+d+'"]):not(['+l+'="'+c+'"])';function g(_,b,N){var k=new XMLHttpRequest;k.open("GET",_,!0),k.onreadystatechange=function(){k.readyState==4&&(k.status<400&&k.responseText?b(k.responseText):k.status>=400?N(s(k.status,k.statusText)):N(a))},k.send(null)}function y(_){var b=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(_||"");if(b){var N=Number(b[1]),k=b[2],w=b[3];return k?w?[N,Number(w)]:[N,void 0]:[N,N]}}r.hooks.add("before-highlightall",function(_){_.selector+=", "+p}),r.hooks.add("before-sanity-check",function(_){var b=_.element;if(b.matches(p)){_.code="",b.setAttribute(l,c);var N=b.appendChild(document.createElement("CODE"));N.textContent=n;var k=b.getAttribute("data-src"),w=_.language;if(w==="none"){var T=(/\.(\w+)$/.exec(k)||[,"none"])[1];w=i[T]||T}r.util.setLanguage(N,w),r.util.setLanguage(b,w);var A=r.plugins.autoloader;A&&A.loadLanguages(w),g(k,function(F){b.setAttribute(l,d);var R=y(b.getAttribute("data-range"));if(R){var E=F.split(/\r\n?|\n/g),D=R[0],I=R[1]==null?E.length:R[1];D<0&&(D+=E.length),D=Math.max(0,Math.min(D-1,E.length)),I<0&&(I+=E.length),I=Math.max(0,Math.min(I,E.length)),F=E.slice(D,I).join(`
`),b.hasAttribute("data-start")||b.setAttribute("data-start",String(D+1))}N.textContent=F,r.highlightElement(N)},function(F){b.setAttribute(l,f),N.textContent=F})}}),r.plugins.fileHighlight={highlight:function(b){for(var N=(b||document).querySelectorAll(p),k=0,w;w=N[k++];)r.highlightElement(w)}};var v=!1;r.fileHighlight=function(){v||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),v=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}})()})(Mw)),Mw.exports}E$();Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript;Prism.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]};Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity;Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup;Prism.hooks.add("wrap",function(e){e.type==="entity"&&(e.attributes.title=e.content.replace(/&amp;/,"&"))});Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function(t,r){var n={};n["language-"+r]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[r]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var s={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};s["language-"+r]={pattern:/[\s\S]+/,inside:Prism.languages[r]};var a={};a[t]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return t}),"i"),lookbehind:!0,greedy:!0,inside:s},Prism.languages.insertBefore("markup","cdata",a)}});Object.defineProperty(Prism.languages.markup.tag,"addAttribute",{value:function(e,t){Prism.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:Prism.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}});Prism.languages.html=Prism.languages.markup;Prism.languages.mathml=Prism.languages.markup;Prism.languages.svg=Prism.languages.markup;Prism.languages.xml=Prism.languages.extend("markup",{});Prism.languages.ssml=Prism.languages.xml;Prism.languages.atom=Prism.languages.xml;Prism.languages.rss=Prism.languages.xml;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function r(f){return f=f.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+f+")")}var n=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return n}),a=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+a+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+a+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(n),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+a+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(n),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:r(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:r(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:r(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:r(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(f){["url","bold","italic","strike","code-snippet"].forEach(function(p){f!==p&&(e.languages.markdown[f].inside.content.inside[p]=e.languages.markdown[p])})}),e.hooks.add("after-tokenize",function(f){if(f.language!=="markdown"&&f.language!=="md")return;function p(g){if(!(!g||typeof g=="string"))for(var y=0,v=g.length;y<v;y++){var _=g[y];if(_.type!=="code"){p(_.content);continue}var b=_.content[1],N=_.content[3];if(b&&N&&b.type==="code-language"&&N.type==="code-block"&&typeof b.content=="string"){var k=b.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");k=(/[a-z][\w-]*/i.exec(k)||[""])[0].toLowerCase();var w="language-"+k;N.alias?typeof N.alias=="string"?N.alias=[N.alias,w]:N.alias.push(w):N.alias=[w]}}}p(f.tokens)}),e.hooks.add("wrap",function(f){if(f.type==="code-block"){for(var p="",g=0,y=f.classes.length;g<y;g++){var v=f.classes[g],_=/language-(.+)/.exec(v);if(_){p=_[1];break}}var b=e.languages[p];if(b)f.content=e.highlight(d(f.content),b,p);else if(p&&p!=="none"&&e.plugins.autoloader){var N="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);f.attributes.id=N,e.plugins.autoloader.loadLanguages(p,function(){var k=document.getElementById(N);k&&(k.innerHTML=e.highlight(k.textContent,e.languages[p],p))})}}});var i=RegExp(e.languages.markup.tag.pattern.source,"gi"),l={amp:"&",lt:"<",gt:">",quot:'"'},c=String.fromCodePoint||String.fromCharCode;function d(f){var p=f.replace(i,"");return p=p.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(g,y){if(y=y.toLowerCase(),y[0]==="#"){var v;return y[1]==="x"?v=parseInt(y.slice(2),16):v=Number(y.slice(1)),c(v)}else{var _=l[y];return _||g}}),p}e.languages.md=e.languages.markdown})(Prism);Prism.languages.c=Prism.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/});Prism.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}});Prism.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},Prism.languages.c.string],char:Prism.languages.c.char,comment:Prism.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:Prism.languages.c}}}});Prism.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/});delete Prism.languages.c.boolean;(function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var r=e.languages.markup;r&&(r.tag.addInlined("style","css"),r.tag.addAttribute("style","css"))})(Prism);Prism.languages.objectivec=Prism.languages.extend("c",{string:{pattern:/@?"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},keyword:/\b(?:asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|in|inline|int|long|register|return|self|short|signed|sizeof|static|struct|super|switch|typedef|typeof|union|unsigned|void|volatile|while)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/});delete Prism.languages.objectivec["class-name"];Prism.languages.objc=Prism.languages.objectivec;Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};(function(e){var t=e.languages.powershell={comment:[{pattern:/(^|[^`])<#[\s\S]*?#>/,lookbehind:!0},{pattern:/(^|[^`])#.*/,lookbehind:!0}],string:[{pattern:/"(?:`[\s\S]|[^`"])*"/,greedy:!0,inside:null},{pattern:/'(?:[^']|'')*'/,greedy:!0}],namespace:/\[[a-z](?:\[(?:\[[^\]]*\]|[^\[\]])*\]|[^\[\]])*\]/i,boolean:/\$(?:false|true)\b/i,variable:/\$\w+\b/,function:[/\b(?:Add|Approve|Assert|Backup|Block|Checkpoint|Clear|Close|Compare|Complete|Compress|Confirm|Connect|Convert|ConvertFrom|ConvertTo|Copy|Debug|Deny|Disable|Disconnect|Dismount|Edit|Enable|Enter|Exit|Expand|Export|Find|ForEach|Format|Get|Grant|Group|Hide|Import|Initialize|Install|Invoke|Join|Limit|Lock|Measure|Merge|Move|New|Open|Optimize|Out|Ping|Pop|Protect|Publish|Push|Read|Receive|Redo|Register|Remove|Rename|Repair|Request|Reset|Resize|Resolve|Restart|Restore|Resume|Revoke|Save|Search|Select|Send|Set|Show|Skip|Sort|Split|Start|Step|Stop|Submit|Suspend|Switch|Sync|Tee|Test|Trace|Unblock|Undo|Uninstall|Unlock|Unprotect|Unpublish|Unregister|Update|Use|Wait|Watch|Where|Write)-[a-z]+\b/i,/\b(?:ac|cat|chdir|clc|cli|clp|clv|compare|copy|cp|cpi|cpp|cvpa|dbp|del|diff|dir|ebp|echo|epal|epcsv|epsn|erase|fc|fl|ft|fw|gal|gbp|gc|gci|gcs|gdr|gi|gl|gm|gp|gps|group|gsv|gu|gv|gwmi|iex|ii|ipal|ipcsv|ipsn|irm|iwmi|iwr|kill|lp|ls|measure|mi|mount|move|mp|mv|nal|ndr|ni|nv|ogv|popd|ps|pushd|pwd|rbp|rd|rdr|ren|ri|rm|rmdir|rni|rnp|rp|rv|rvpa|rwmi|sal|saps|sasv|sbp|sc|select|set|shcm|si|sl|sleep|sls|sort|sp|spps|spsv|start|sv|swmi|tee|trcm|type|write)\b/i],keyword:/\b(?:Begin|Break|Catch|Class|Continue|Data|Define|Do|DynamicParam|Else|ElseIf|End|Exit|Filter|Finally|For|ForEach|From|Function|If|InlineScript|Parallel|Param|Process|Return|Sequence|Switch|Throw|Trap|Try|Until|Using|Var|While|Workflow)\b/i,operator:{pattern:/(^|\W)(?:!|-(?:b?(?:and|x?or)|as|(?:Not)?(?:Contains|In|Like|Match)|eq|ge|gt|is(?:Not)?|Join|le|lt|ne|not|Replace|sh[lr])\b|-[-=]?|\+[+=]?|[*\/%]=?)/i,lookbehind:!0},punctuation:/[|{}[\];(),.]/};t.string[0].inside={function:{pattern:/(^|[^`])\$\((?:\$\([^\r\n()]*\)|(?!\$\()[^\r\n)])*\)/,lookbehind:!0,inside:t},boolean:t.boolean,variable:t.variable}})(Prism);var LE={},BE;function N$(){return BE||(BE=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),LE}N$();var UE={},$E;function A$(){return $E||($E=1,(function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,r=0;r<2;r++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string})(Prism)),UE}A$();Prism.languages.swift={comment:{pattern:/(^|[^\\:])(?:\/\/.*|\/\*(?:[^/*]|\/(?!\*)|\*(?!\/)|\/\*(?:[^*]|\*(?!\/))*\*\/)*\*\/)/,lookbehind:!0,greedy:!0},"string-literal":[{pattern:RegExp(/(^|[^"#])/.source+"(?:"+/"(?:\\(?:\((?:[^()]|\([^()]*\))*\)|\r\n|[^(])|[^\\\r\n"])*"/.source+"|"+/"""(?:\\(?:\((?:[^()]|\([^()]*\))*\)|[^(])|[^\\"]|"(?!""))*"""/.source+")"+/(?!["#])/.source),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\\($/,alias:"punctuation"},punctuation:/\\(?=[\r\n])/,string:/[\s\S]+/}},{pattern:RegExp(/(^|[^"#])(#+)/.source+"(?:"+/"(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|\r\n|[^#])|[^\\\r\n])*?"/.source+"|"+/"""(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|[^#])|[^\\])*?"""/.source+")\\2"),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\#+\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\#+\($/,alias:"punctuation"},string:/[\s\S]+/}}],directive:{pattern:RegExp(/#/.source+"(?:"+(/(?:elseif|if)\b/.source+"(?:[ 	]*"+/(?:![ \t]*)?(?:\b\w+\b(?:[ \t]*\((?:[^()]|\([^()]*\))*\))?|\((?:[^()]|\([^()]*\))*\))(?:[ \t]*(?:&&|\|\|))?/.source+")+")+"|"+/(?:else|endif)\b/.source+")"),alias:"property",inside:{"directive-name":/^#\w+/,boolean:/\b(?:false|true)\b/,number:/\b\d+(?:\.\d+)*\b/,operator:/!|&&|\|\||[<>]=?/,punctuation:/[(),]/}},literal:{pattern:/#(?:colorLiteral|column|dsohandle|file(?:ID|Literal|Path)?|function|imageLiteral|line)\b/,alias:"constant"},"other-directive":{pattern:/#\w+\b/,alias:"property"},attribute:{pattern:/@\w+/,alias:"atrule"},"function-definition":{pattern:/(\bfunc\s+)\w+/,lookbehind:!0,alias:"function"},label:{pattern:/\b(break|continue)\s+\w+|\b[a-zA-Z_]\w*(?=\s*:\s*(?:for|repeat|while)\b)/,lookbehind:!0,alias:"important"},keyword:/\b(?:Any|Protocol|Self|Type|actor|as|assignment|associatedtype|associativity|async|await|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic|else|enum|extension|fallthrough|fileprivate|final|for|func|get|guard|higherThan|if|import|in|indirect|infix|init|inout|internal|is|isolated|lazy|left|let|lowerThan|mutating|none|nonisolated|nonmutating|open|operator|optional|override|postfix|precedencegroup|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|set|some|static|struct|subscript|super|switch|throw|throws|try|typealias|unowned|unsafe|var|weak|where|while|willSet)\b/,boolean:/\b(?:false|true)\b/,nil:{pattern:/\bnil\b/,alias:"constant"},"short-argument":/\$\d+\b/,omit:{pattern:/\b_\b/,alias:"keyword"},number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,"class-name":/\b[A-Z](?:[A-Z_\d]*[a-z]\w*)?\b/,function:/\b[a-z_]\w*(?=\s*\()/i,constant:/\b(?:[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,operator:/[-+*/%=!<>&|^~?]+|\.[.\-+*/%=!<>&|^~?]+/,punctuation:/[{}[\]();,.:\\]/};Prism.languages.swift["string-literal"].forEach(function(e){e.inside.interpolation.inside=Prism.languages.swift});var WE={},zE;function j$(){return zE||(zE=1,(function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript})(Prism)),WE}j$();var HE={},GE;function F$(){return GE||(GE=1,(function(e){var t=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,r=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,n={pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};e.languages.java=e.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[n,{pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:n.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+r+/[A-Z]\w*\b/.source),lookbehind:!0,inside:n.inside}],keyword:t,function:[e.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),e.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),e.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":n,keyword:t,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+r+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:n.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+r+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:n.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0,inside:{punctuation:/\./}}})})(Prism)),HE}F$();var VE={},KE;function P$(){return KE||(KE=1,(function(e){var t=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,r=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,function(){return t.source});e.languages.cpp=e.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:t,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),e.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,function(){return r})+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),e.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e.languages.cpp}}}}),e.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),e.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:e.languages.extend("cpp",{})}}),e.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},e.languages.cpp["base-clause"])})(Prism)),VE}P$();function Ej(e,t){for(const r of e.childNodes){if($n(r)&&r.tagName===t)return!0;Ej(r,t)}return!1}const Cm="data-language",vm="data-highlight-language",xy="data-theme";class _f extends Ka{static getType(){return"code"}static clone(t){return new _f(t.__language,t.__key)}constructor(t,r){super(r),this.__language=t||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(t){super.afterCloneFrom(t),this.__language=t.__language,this.__theme=t.__theme,this.__isSyntaxHighlightSupported=t.__isSyntaxHighlightSupported}createDOM(t){const r=document.createElement("code");Vs(r,t.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(Cm,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(vm,n));const s=this.getTheme();s&&r.setAttribute(xy,s);const a=this.getStyle();return a&&r.setAttribute("style",a),r}updateDOM(t,r,n){const s=this.__language,a=t.__language;s?s!==a&&r.setAttribute(Cm,s):a&&r.removeAttribute(Cm);const i=this.__isSyntaxHighlightSupported;t.__isSyntaxHighlightSupported&&a?i&&s?s!==a&&r.setAttribute(vm,s):r.removeAttribute(vm):i&&s&&r.setAttribute(vm,s);const l=this.__theme,c=t.__theme;l?l!==c&&r.setAttribute(xy,l):c&&r.removeAttribute(xy);const d=this.__style,f=t.__style;return d?d!==f&&r.setAttribute("style",d):f&&r.removeAttribute("style"),!1}exportDOM(t){const r=document.createElement("pre");Vs(r,t._config.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(Cm,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(vm,n));const s=this.getTheme();s&&r.setAttribute(xy,s);const a=this.getStyle();return a&&r.setAttribute("style",a),{element:r}}static importDOM(){return{code:t=>t.textContent!=null&&(/\r?\n/.test(t.textContent)||Ej(t,"BR"))?{conversion:qE,priority:1}:null,div:()=>({conversion:R$,priority:1}),pre:()=>({conversion:qE,priority:0}),table:t=>Ow(t)?{conversion:D$,priority:3}:null,td:t=>{const r=t,n=r.closest("table");return r.classList.contains("js-file-line")||n&&Ow(n)?{conversion:XE,priority:3}:null},tr:t=>{const r=t.closest("table");return r&&Ow(r)?{conversion:XE,priority:3}:null}}}static importJSON(t){return bc().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setLanguage(t.language).setTheme(t.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(t,r=!0){const n=this.getChildren(),s=n.length;if(s>=2&&n[s-1].getTextContent()===`
`&&n[s-2].getTextContent()===`
`&&t.isCollapsed()&&t.anchor.key===this.__key&&t.anchor.offset===s){n[s-1].remove(),n[s-2].remove();const c=Un();return this.insertAfter(c,r),c}const{anchor:a,focus:i}=t,l=(a.isBefore(i)?a:i).getNode();if(Gt(l)){let c=M$(l);const d=[];for(;;)if($1(c))d.push(k0()),c=c.getNextSibling();else{if(!jj(c))break;{let b=0;const N=c.getTextContent(),k=c.getTextContentSize();for(;b<k&&N[b]===" ";)b++;if(b!==0&&d.push(Aj(" ".repeat(b))),b!==k)break;c=c.getNextSibling()}}const f=l.splitText(a.offset)[0],p=a.offset===0?0:1,g=f.getIndexWithinParent()+p,y=l.getParentOrThrow(),v=[Ol(),...d];y.splice(g,0,v);const _=d[d.length-1];_?_.select():a.offset===0?f.selectPrevious():f.getNextSibling().selectNext(0,0)}if(tS(l)){const{offset:c}=t.anchor;l.splice(c,0,[Ol()]),l.select(c+1,c+1)}return null}canIndent(){return!1}collapseAtStart(){const t=Un();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}setLanguage(t){const r=this.getWritable();return r.__language=t||void 0,r}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(t){const r=this.getWritable();return r.__isSyntaxHighlightSupported=t,r}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(t){const r=this.getWritable();return r.__theme=t||void 0,r}getTheme(){return this.getLatest().__theme}}function bc(e,t){return rU(_f).setLanguage(e).setTheme(t)}function tS(e){return e instanceof _f}function qE(e){return{node:bc(e.getAttribute(Cm))}}function R$(e){const t=e,r=YE(t);return r||(function(n){let s=n.parentElement;for(;s!==null;){if(YE(s))return!0;s=s.parentElement}return!1})(t)?{node:r?bc():null}:{node:null}}function D$(){return{node:bc()}}function XE(){return{node:null}}function YE(e){return e.style.fontFamily.match("monospace")!==null}function Ow(e){return e.classList.contains("js-file-line-container")}let J1=class Nj extends Xu{constructor(t="",r,n){super(t,n),this.__highlightType=r}static getType(){return"code-highlight"}static clone(t){return new Nj(t.__text,t.__highlightType||void 0,t.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(t){const r=this.getWritable();return r.__highlightType=t||void 0,r}canHaveFormat(){return!1}createDOM(t){const r=super.createDOM(t),n=Lw(t.theme,this.__highlightType);return Vs(r,n),r}updateDOM(t,r,n){const s=super.updateDOM(t,r,n),a=Lw(n.theme,t.__highlightType),i=Lw(n.theme,this.__highlightType);return a!==i&&(a&&Mu(r,a),i&&Vs(r,i)),s}static importJSON(t){return Aj().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHighlightType(t.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(t){return this}isParentRequired(){return!0}createParentElementNode(){return bc()}};function Lw(e,t){return t&&e&&e.codeHighlight&&e.codeHighlight[t]}function Aj(e="",t){return gi(new J1(e,t))}function jj(e){return e instanceof J1}function I$(e,t){let r=e;for(let n=Na(e,t);n&&(jj(n.origin)||$1(n.origin));n=TU(n))r=n.origin;return r}function M$(e){return I$(e,"previous")}(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach((function(r){var n=t[r],s=[];/^\w+$/.test(r)||s.push(/\w+/.exec(r)[0]),r==="diff"&&s.push("bold"),e.languages.diff[r]={pattern:RegExp("^(?:["+n+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(r)[0]}}}})),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);const O$=new Set(["http:","https:","mailto:","sms:","tel:"]);class Qu extends Ka{static getType(){return"link"}static clone(t){return new Qu(t.__url,{rel:t.__rel,target:t.__target,title:t.__title},t.__key)}constructor(t="",r={},n){super(n);const{target:s=null,rel:a=null,title:i=null}=r;this.__url=t,this.__target=s,this.__rel=a,this.__title=i}createDOM(t){const r=document.createElement("a");return this.updateLinkDOM(null,r,t),Vs(r,t.theme.link),r}updateLinkDOM(t,r,n){if(zA(r)){t&&t.__url===this.__url||(r.href=this.sanitizeUrl(this.__url));for(const s of["target","rel","title"]){const a=`__${s}`,i=this[a];t&&t[a]===i||(i?r[s]=i:r.removeAttribute(s))}}}updateDOM(t,r,n){return this.updateLinkDOM(t,r,n),!1}static importDOM(){return{a:t=>({conversion:L$,priority:1})}}static importJSON(t){return d1().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setURL(t.url).setRel(t.rel||null).setTarget(t.target||null).setTitle(t.title||null)}sanitizeUrl(t){t=QE(t);try{const r=new URL(QE(t));if(!O$.has(r.protocol))return"about:blank"}catch{return t}return t}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),url:this.getURL()}}getURL(){return this.getLatest().__url}setURL(t){const r=this.getWritable();return r.__url=t,r}getTarget(){return this.getLatest().__target}setTarget(t){const r=this.getWritable();return r.__target=t,r}getRel(){return this.getLatest().__rel}setRel(t){const r=this.getWritable();return r.__rel=t,r}getTitle(){return this.getLatest().__title}setTitle(t){const r=this.getWritable();return r.__title=t,r}insertNewAfter(t,r=!0){const n=d1(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(n,r),n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(t,r,n){if(!Tt(r))return!1;const s=r.anchor.getNode(),a=r.focus.getNode();return this.isParentOf(s)&&this.isParentOf(a)&&r.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}}function L$(e){let t=null;if(zA(e)){const r=e.textContent;(r!==null&&r!==""||e.children.length>0)&&(t=d1(e.getAttribute("href")||"",{rel:e.getAttribute("rel"),target:e.getAttribute("target"),title:e.getAttribute("title")}))}return{node:t}}function d1(e="",t){return gi(new Qu(e,t))}function B$(e){return e instanceof Qu}class F0 extends Qu{constructor(t="",r={},n){super(t,r,n),this.__isUnlinked=r.isUnlinked!==void 0&&r.isUnlinked!==null&&r.isUnlinked}static getType(){return"autolink"}static clone(t){return new F0(t.__url,{isUnlinked:t.__isUnlinked,rel:t.__rel,target:t.__target,title:t.__title},t.__key)}getIsUnlinked(){return this.__isUnlinked}setIsUnlinked(t){const r=this.getWritable();return r.__isUnlinked=t,r}createDOM(t){return this.__isUnlinked?document.createElement("span"):super.createDOM(t)}updateDOM(t,r,n){return super.updateDOM(t,r,n)||t.__isUnlinked!==this.__isUnlinked}static importJSON(t){return JE().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setIsUnlinked(t.isUnlinked||!1)}static importDOM(){return null}exportJSON(){return{...super.exportJSON(),isUnlinked:this.__isUnlinked}}insertNewAfter(t,r=!0){const n=this.getParentOrThrow().insertNewAfter(t,r);if(yt(n)){const s=JE(this.__url,{isUnlinked:this.__isUnlinked,rel:this.__rel,target:this.__target,title:this.__title});return n.append(s),s}return null}}function JE(e="",t){return gi(new F0(e,t))}function U$(e){return e instanceof F0}const $$=/^\+?[0-9\s()-]{5,}$/;function QE(e){return e.match(/^[a-z][a-z0-9+.-]*:/i)||e.match(/^[/#.]/)?e:e.includes("@")?`mailto:${e}`:$$.test(e)?`tel:${e}`:`https://${e}`}function i2(e,t){const r={};for(const n of e){const s=t(n);s&&(r[s]?r[s].push(n):r[s]=[n])}return r}function W$(e){const t=i2(e,(r=>r.type));return{element:t.element||[],multilineElement:t["multiline-element"]||[],textFormat:t["text-format"]||[],textMatch:t["text-match"]||[]}}const ZE=/[!-/:-@[-`{-~\s]/;function z$(e){return Gt(e)&&!e.hasFormat("code")}function H$(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function eN(e,t,r){const n=r.length;for(let s=t;s>=n;s--){const a=s-n;if(Fj(e,a,r,0,n)&&e[a+n]!==" ")return a}return-1}function Fj(e,t,r,n,s){for(let a=0;a<s;a++)if(e[t+a]!==r[n+a])return!1;return!0}function G$(e,t=Q1){const r=W$(t),n=i2(r.textFormat,(({tag:i})=>i[i.length-1])),s=i2(r.textMatch,(({trigger:i})=>i));for(const i of t){const l=i.type;if(l==="element"||l==="text-match"||l==="multiline-element"){const c=i.dependencies;for(const d of c)e.hasNode(d)||H$(173,d.getType())}}const a=(i,l,c)=>{(function(d,f,p,g){const y=d.getParent();if(!fi(y)||d.getFirstChild()!==f)return!1;const v=f.getTextContent();if(v[p-1]!==" ")return!1;for(const{regExp:_,replace:b}of g){const N=v.match(_);if(N&&N[0].length===(N[0].endsWith(" ")?p:p-1)){const k=f.getNextSiblings(),[w,T]=f.splitText(p);if(b(d,T?[T,...k]:k,N,!1)!==!1)return w.remove(),!0}}return!1})(i,l,c,r.element)||(function(d,f,p,g){const y=d.getParent();if(!fi(y)||d.getFirstChild()!==f)return!1;const v=f.getTextContent();if(v[p-1]!==" ")return!1;for(const{regExpStart:_,replace:b,regExpEnd:N}of g){if(N&&!("optional"in N)||N&&"optional"in N&&!N.optional)continue;const k=v.match(_);if(k&&k[0].length===(k[0].endsWith(" ")?p:p-1)){const w=f.getNextSiblings(),[T,A]=f.splitText(p);if(b(d,A?[A,...w]:w,k,null,null,!1)!==!1)return T.remove(),!0}}return!1})(i,l,c,r.multilineElement)||(function(d,f,p){let g=d.getTextContent();const y=p[g[f-1]];if(y==null)return!1;f<g.length&&(g=g.slice(0,f));for(const v of y){if(!v.replace||!v.regExp)continue;const _=g.match(v.regExp);if(_===null)continue;const b=_.index||0,N=b+_[0].length;let k;return b===0?[k]=d.splitText(N):[,k]=d.splitText(b,N),k.selectNext(0,0),v.replace(k,_),!0}return!1})(l,c,s)||(function(d,f,p){const g=d.getTextContent(),y=f-1,v=g[y],_=p[v];if(!_)return!1;for(const b of _){const{tag:N}=b,k=N.length,w=y-k+1;if(k>1&&!Fj(g,w,N,0,k)||g[w-1]===" ")continue;const T=g[y+1];if(b.intraword===!1&&T&&!ZE.test(T))continue;const A=d;let F=A,R=eN(g,w,N),E=F;for(;R<0&&(E=E.getPreviousSibling())&&!kc(E);)if(Gt(E)){if(E.hasFormat("code"))continue;const B=E.getTextContent();F=E,R=eN(B,B.length,N)}if(R<0||F===A&&R+k===w)continue;const D=F.getTextContent();if(R>0&&D[R-1]===v)continue;const I=D[R-1];if(b.intraword===!1&&I&&!ZE.test(I))continue;const G=A.getTextContent(),Y=G.slice(0,w)+G.slice(y+1);A.setTextContent(Y);const ee=F===A?Y:D;F.setTextContent(ee.slice(0,R)+ee.slice(R+k));const ie=Ht(),re=z1();Aa(re);const se=y-k*(F===A?2:1)+1;re.anchor.set(F.__key,R,"text"),re.focus.set(A.__key,se,"text");for(const B of b.format)re.hasFormat(B)||re.formatText(B);re.anchor.set(re.focus.key,re.focus.offset,re.focus.type);for(const B of b.format)re.hasFormat(B)&&re.toggleFormat(B);return Tt(ie)&&(re.format=ie.format),!0}})(l,c,n)};return e.registerUpdateListener((({tags:i,dirtyLeaves:l,editorState:c,prevEditorState:d})=>{if(i.has(jA)||i.has(a1)||e.isComposing())return;const f=c.read(Ht),p=d.read(Ht);if(!Tt(p)||!Tt(f)||!f.isCollapsed()||f.is(p))return;const g=f.anchor.key,y=f.anchor.offset,v=c._nodeMap.get(g);!Gt(v)||!l.has(g)||y!==1&&y>p.anchor.offset+1||e.update((()=>{if(!z$(v))return;const _=v.getParent();_===null||tS(_)||a(_,v,f.anchor.offset)}))}))}const V$=/^(\s*)(\d{1,})\.\s/,K$=/^(\s*)[-*+]\s/,q$=/^(#{1,6})\s/,X$=/^>\s/,Y$=/^[ \t]*```([\w-]+)?/,J$=/[ \t]*```$/,Pj=e=>(t,r,n,s)=>{const a=e(n);a.append(...r),t.replace(a),s||a.select(0,0)},Rj=e=>(t,r,n,s)=>{const a=t.getPreviousSibling(),i=t.getNextSibling(),l=Ki(e==="check"?n[3]==="x":void 0);if(jr(i)&&i.getListType()===e){const d=i.getFirstChild();d!==null?d.insertBefore(l):i.append(l),t.remove()}else if(jr(a)&&a.getListType()===e)a.append(l),t.remove();else{const d=ji(e,e==="number"?Number(n[2]):void 0);d.append(l),t.replace(d)}l.append(...r),s||l.select(0,0);const c=(function(d){const f=d.match(/\t/g),p=d.match(/ /g);let g=0;return f&&(g+=f.length),p&&(g+=Math.floor(p.length/4)),g})(n[1]);c&&l.setIndent(c)},rS=(e,t,r)=>{const n=[],s=e.getChildren();let a=0;for(const i of s)if(on(i)){if(i.getChildrenSize()===1){const f=i.getFirstChild();if(jr(f)){n.push(rS(f,t,r+1));continue}}const l=" ".repeat(4*r),c=e.getListType(),d=c==="number"?`${e.getStart()+a}. `:c==="check"?`- [${i.getChecked()?"x":" "}] `:"- ";n.push(l+d+t(i)),a++}return n.join(`
`)},Q$={dependencies:[Wp],export:(e,t)=>{if(!qU(e))return null;const r=Number(e.getTag().slice(1));return"#".repeat(r)+" "+t(e)},regExp:q$,replace:Pj((e=>{const t="h"+e[1].length;return Au(t)})),type:"element"},Z$={dependencies:[Up],export:(e,t)=>{if(!wE(e))return null;const r=t(e).split(`
`),n=[];for(const s of r)n.push("> "+s);return n.join(`
`)},regExp:X$,replace:(e,t,r,n)=>{if(n){const a=e.getPreviousSibling();if(wE(a))return a.splice(a.getChildrenSize(),0,[Ol(),...t]),void e.remove()}const s=$p();s.append(...t),e.replace(s),n||s.select(0,0)},type:"element"},eW={dependencies:[_f],export:e=>{if(!tS(e))return null;const t=e.getTextContent();return"```"+(e.getLanguage()||"")+(t?`
`+t:"")+"\n```"},regExpEnd:{optional:!0,regExp:J$},regExpStart:Y$,replace:(e,t,r,n,s,a)=>{let i,l;if(!t&&s){if(s.length===1)n?(i=bc(),l=r[1]+s[0]):(i=bc(r[1]),l=s[0].startsWith(" ")?s[0].slice(1):s[0]);else{if(i=bc(r[1]),s[0].trim().length===0)for(;s.length>0&&!s[0].length;)s.shift();else s[0]=s[0].startsWith(" ")?s[0].slice(1):s[0];for(;s.length>0&&!s[s.length-1].length;)s.pop();l=s.join(`
`)}const c=cs(l);i.append(c),e.append(i)}else t&&Pj((c=>bc(c?c[1]:void 0)))(e,t,r,a)},type:"multiline-element"},tW={dependencies:[Ju,Dc],export:(e,t)=>jr(e)?rS(e,t,0):null,regExp:K$,replace:Rj("bullet"),type:"element"},rW={dependencies:[Ju,Dc],export:(e,t)=>jr(e)?rS(e,t,0):null,regExp:V$,replace:Rj("number"),type:"element"},nW={format:["code"],tag:"`",type:"text-format"},sW={format:["highlight"],tag:"==",type:"text-format"},aW={format:["bold","italic"],tag:"***",type:"text-format"},iW={format:["bold","italic"],intraword:!1,tag:"___",type:"text-format"},oW={format:["bold"],tag:"**",type:"text-format"},lW={format:["bold"],intraword:!1,tag:"__",type:"text-format"},cW={format:["strikethrough"],tag:"~~",type:"text-format"},uW={format:["italic"],tag:"*",type:"text-format"},dW={format:["italic"],intraword:!1,tag:"_",type:"text-format"},fW={dependencies:[Qu],export:(e,t,r)=>{if(!B$(e)||U$(e))return null;const n=e.getTitle(),s=t(e);return n?`[${s}](${e.getURL()} "${n}")`:`[${s}](${e.getURL()})`},importRegExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))/,regExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))$/,replace:(e,t)=>{const[,r,n,s]=t,a=d1(n,{title:s}),i=r.split("[").length-1,l=r.split("]").length-1;let c=r,d="";if(i<l)return;if(i>l){const p=r.split("[");d="["+p[0],c=p.slice(1).join("[")}const f=cs(c);return f.setFormat(e.getFormat()),a.append(f),e.replace(a),d&&a.insertBefore(cs(d)),f},trigger:")",type:"text-match"},hW=[Q$,Z$,tW,rW],gW=[eW],mW=[nW,aW,iW,oW,lW,sW,uW,dW,cW],pW=[fW],Q1=[...hW,...gW,...mW,...pW];function tN(e,t){return e.getEditorState().read((()=>{const r=Os(t);return r!==null&&r.isSelected()}))}function xW(e){const[t]=Bl(),[r,n]=C.useState((()=>tN(t,e)));return C.useEffect((()=>{let s=!0;const a=t.registerUpdateListener((()=>{s&&n(tN(t,e))}));return()=>{s=!1,a()}}),[t,e]),[r,C.useCallback((s=>{t.update((()=>{let a=Ht();La(a)||(a=kb(),Aa(a)),La(a)&&(s?a.add(e):a.delete(e))}))}),[t,e]),C.useCallback((()=>{t.update((()=>{const s=Ht();La(s)&&s.clear()}))}),[t])]}function yW({nodeKey:e}){const[t]=Bl(),[r,n,s]=xW(e);return C.useEffect((()=>wf(t.registerCommand(yb,(a=>{const i=t.getElementByKey(e);return a.target===i&&(a.shiftKey||s(),n(!r),!0)}),Ih))),[s,t,r,e,n]),C.useEffect((()=>{const a=t.getElementByKey(e),i=t._config.theme.hrSelected??"selected";a!==null&&(r?Vs(a,i):Mu(a,i))}),[t,r,e]),null}class Hp extends Eb{static getType(){return"horizontalrule"}static clone(t){return new Hp(t.__key)}static importJSON(t){return nS().updateFromJSON(t)}static importDOM(){return{hr:()=>({conversion:vW,priority:0})}}exportDOM(){return{element:document.createElement("hr")}}createDOM(t){const r=document.createElement("hr");return Vs(r,t.theme.hr),r}getTextContent(){return`
`}isInline(){return!1}updateDOM(){return!1}decorate(){return o.jsx(yW,{nodeKey:this.__key})}}function vW(){return{node:nS()}}function nS(){return gi(new Hp)}function wW(e){return e instanceof Hp}const _W=[{dependencies:[Hp],export:e=>wW(e)?"***":null,regExp:/^(---|\*\*\*|___)\s?$/,replace:(e,t,r,n)=>{const s=nS();n||e.getNextSibling()!=null?e.replace(s):e.insertBefore(s),s.selectNext()},type:"element"},...Q1];function Dj({transformers:e=_W}){const[t]=Bl();return C.useEffect((()=>G$(t,e)),[t,e]),null}function Ij({hasStrictIndent:e=!1}){const[t]=Bl();return C.useEffect((()=>{if(!t.hasNodes([Ju,Dc]))throw new Error("ListPlugin: ListNode and/or ListItemNode not registered on editor")}),[t]),C.useEffect((()=>{if(e)return T$(t)}),[t,e]),(function(r){C.useEffect((()=>C$(r)),[r])})(t),null}const bW=({onChange:e})=>{const[t]=C.useContext(b0)||[];return C.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{qn().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},SW=()=>{const[e]=C.useContext(b0)||[],t=C.useCallback(()=>{e&&e.dispatchCommand(Ha,"bold")},[e]),r=C.useCallback(()=>{e&&e.dispatchCommand(Ha,"italic")},[e]),n=C.useCallback(()=>{e&&e.dispatchCommand(Ha,"underline")},[e]),s=C.useCallback(()=>{e&&e.dispatchCommand(Ha,"strikethrough")},[e]),a=C.useCallback(y=>{e&&e.update(()=>{const v=Ht();Tt(v)&&Zh(v,()=>Au(y))})},[e]),i=C.useCallback(()=>{e&&e.update(()=>{const y=Ht();Tt(y)&&Zh(y,()=>Un())})},[e]);C.useCallback(()=>{e&&e.update(()=>{const y=Ht();Tt(y)&&Zh(y,()=>$p())})},[e]);const l=C.useCallback(()=>{e&&e.dispatchCommand(Qb)},[e]),c=C.useCallback(()=>{e&&e.dispatchCommand(Zb)},[e]),d=C.useCallback(()=>{e&&e.dispatchCommand(eS)},[e]),f=C.useCallback(y=>{e&&e.update(()=>{const v=Ht();Tt(v)&&v.getNodes().forEach(_=>{Gt(_)&&_.setStyle(`color: ${y}`)})})},[e]),p=C.useCallback(y=>{e&&e.update(()=>{const v=Ht();Tt(v)&&v.getNodes().forEach(b=>{if(Gt(b)){const N=b.getStyle(),k=N?N.replace(/font-size:\s*\d+px;?\s*/g,"").trim():"",w=k?`${k}; font-size: ${y}px;`:`font-size: ${y}px;`;b.setStyle(w)}})})},[e]),g=C.useCallback(y=>{e&&e.dispatchCommand(lA,y)},[e]);return o.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[o.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[o.jsx("button",{type:"button",onClick:t,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),o.jsx("button",{type:"button",onClick:r,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),o.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),o.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),o.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[o.jsx("button",{type:"button",onClick:()=>a("h1"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),o.jsx("button",{type:"button",onClick:()=>a("h2"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),o.jsx("button",{type:"button",onClick:()=>a("h3"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),o.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"})]}),o.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[o.jsx("button",{type:"button",onClick:l,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:" List"}),o.jsx("button",{type:"button",onClick:c,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1. List"}),o.jsx("button",{type:"button",onClick:d,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:"No List"})]}),o.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[o.jsx("span",{className:"text-xs text-gray-600",children:"Color:"}),o.jsx("button",{type:"button",onClick:()=>f("#000000"),className:"w-6 h-6 bg-black border border-gray-300 rounded hover:bg-gray-800",title:"Black"}),o.jsx("button",{type:"button",onClick:()=>f("#ff0000"),className:"w-6 h-6 bg-red-500 border border-gray-300 rounded hover:bg-red-600",title:"Red"}),o.jsx("button",{type:"button",onClick:()=>f("#0000ff"),className:"w-6 h-6 bg-blue-500 border border-gray-300 rounded hover:bg-blue-600",title:"Blue"}),o.jsx("button",{type:"button",onClick:()=>f("#008000"),className:"w-6 h-6 bg-green-500 border border-gray-300 rounded hover:bg-green-600",title:"Green"})]}),o.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[o.jsx("span",{className:"text-xs text-gray-600",children:"Size:"}),o.jsx("button",{type:"button",onClick:()=>p(12),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Small",children:"12px"}),o.jsx("button",{type:"button",onClick:()=>p(16),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Normal",children:"16px"}),o.jsx("button",{type:"button",onClick:()=>p(20),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Large",children:"20px"}),o.jsx("button",{type:"button",onClick:()=>p(24),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Extra Large",children:"24px"})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("span",{className:"text-xs text-gray-600",children:"Align:"}),o.jsx("button",{type:"button",onClick:()=>g("left"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Left",children:""}),o.jsx("button",{type:"button",onClick:()=>g("center"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Center",children:""}),o.jsx("button",{type:"button",onClick:()=>g("right"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Right",children:""})]})]})},kW=({value:e,onChange:t,placeholder:r})=>{const n={namespace:"LexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Wp,Ju,Dc,Up,_f,J1,zp,A0,j0,F0,Qu],onError:s=>{console.error("Lexical error:",s)},editorState:e?(()=>{try{const s=JSON.parse(e);return JSON.stringify(s)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return o.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:o.jsxs(XA,{initialConfig:n,children:[o.jsx(SW,{}),o.jsx(bW,{onChange:t}),o.jsxs("div",{className:"relative",children:[o.jsx(hj,{contentEditable:o.jsx(mj,{className:"p-4 min-h-32 focus:outline-none",placeholder:r}),placeholder:o.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:yj}),o.jsx(pj,{}),o.jsx(xj,{}),o.jsx(Ij,{}),o.jsx(Dj,{transformers:Q1})]})]})})},CW=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=Hn(),{post:l}=Xi(),{showNotification:c}=ja(),[d,f]=C.useState({test_name:e,num_questions:1,passing_score:100,questions:[{id:1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048}]}),[p,g]=C.useState({isLoading:!1,error:null,showPreview:!0});C.useEffect(()=>{f(w=>({...w,test_name:e||""}))},[e]);const y=()=>{if(d.num_questions>=3){g(A=>({...A,error:"Maximum 3 questions allowed for performance reasons"}));return}const T={id:Math.max(...d.questions.map(A=>A.id))+1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048};f(A=>({...A,num_questions:A.num_questions+1,questions:[...A.questions,T]}))},v=w=>{d.questions.length<=1||f(T=>({...T,num_questions:T.num_questions-1,questions:T.questions.filter(A=>A.id!==w)}))},_=(w,T)=>{f(A=>({...A,questions:A.questions.map(F=>F.id===w?{...F,question_json:T}:F)}))},b=(w,T,A)=>{f(F=>({...F,questions:F.questions.map(R=>R.id===w?{...R,canvas_width:T,canvas_height:A}:R)}))},N=(w,T,A)=>{f(F=>({...F,questions:F.questions.map(R=>R.id===w?{...R,max_canvas_width:T,max_canvas_height:A}:R)}))},k=async()=>{if(!d.test_name.trim()){g(w=>({...w,error:"Test name is required"}));return}if(d.questions.some(w=>!w.question_json.trim())){g(w=>({...w,error:"All questions must have content"}));return}g(w=>({...w,isLoading:!0,error:null}));try{const w={test_name:d.test_name,num_questions:d.num_questions,passing_score:d.passing_score,questions:d.questions.map((T,A)=>({question_id:A+1,question_json:T.question_json,canvas_width:T.canvas_width,canvas_height:T.canvas_height,max_canvas_width:T.max_canvas_width,max_canvas_height:T.max_canvas_height}))};t&&t(w)}catch(w){console.error("Error preparing drawing test:",w),g(T=>({...T,error:"Failed to prepare drawing test. Please try again."})),c("Failed to prepare drawing test","error")}finally{g(w=>({...w,isLoading:!1}))}};return o.jsx("div",{className:"drawing-test-creator max-w-4xl mx-auto p-6",children:o.jsxs(bt,{className:"p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Drawing Test"}),o.jsx("p",{className:"text-gray-600",children:"Create a test where students draw based on your instructions"})]}),o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Drawing Questions (",d.num_questions,"/3)"]}),o.jsx("p",{className:"text-sm text-gray-500",children:"Maximum 3 questions for optimal performance"})]}),o.jsxs(et,{onClick:y,disabled:d.num_questions>=3,variant:"primary",size:"sm",className:"flex items-center gap-2",children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Question"]})]}),o.jsx("div",{className:"space-y-4",children:d.questions.map((w,T)=>o.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[o.jsxs("div",{className:"flex justify-between items-center mb-3",children:[o.jsxs("h4",{className:"text-md font-medium text-gray-800",children:["Text ",T+1]}),d.questions.length>1&&o.jsx(et,{onClick:()=>v(w.id),variant:"secondary",size:"sm",className:"text-red-600 hover:text-red-700",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Content *"}),o.jsx(kW,{value:w.question_json,onChange:A=>_(w.id,A),placeholder:""})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Canvas Dimensions"}),o.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Canvas is the actual drawing area, viewport is the initial display size"}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Viewport Width"}),o.jsx("input",{type:"number",value:w.canvas_width,onChange:A=>b(w.id,parseInt(A.target.value),w.canvas_height),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"2048"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Viewport Height"}),o.jsx("input",{type:"number",value:w.canvas_height,onChange:A=>b(w.id,w.canvas_width,parseInt(A.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"2048"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Canvas Width"}),o.jsx("input",{type:"number",value:w.max_canvas_width,onChange:A=>N(w.id,parseInt(A.target.value),w.max_canvas_height),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"4096"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Canvas Height"}),o.jsx("input",{type:"number",value:w.max_canvas_height,onChange:A=>N(w.id,w.max_canvas_width,parseInt(A.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"4096"})]})]})]})]},w.id))})]}),p.error&&o.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-700",children:p.error}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx(et,{onClick:r,variant:"secondary",disabled:p.isLoading,children:"Cancel"}),o.jsx(et,{onClick:k,variant:"primary",disabled:p.isLoading||!d.test_name.trim(),className:"flex items-center gap-2",children:p.isLoading?o.jsxs(o.Fragment,{children:[o.jsx(Fr,{size:"sm",color:"white"}),"Saving..."]}):"Save Test"})]})]})})},TW=({onChange:e})=>{const[t]=C.useContext(b0)||[];return C.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{qn().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},EW=({onAddBlank:e,blankCount:t})=>{const[r]=C.useContext(b0)||[],n=C.useCallback(()=>{r&&r.dispatchCommand(Ha,"bold")},[r]),s=C.useCallback(()=>{r&&r.dispatchCommand(Ha,"italic")},[r]),a=C.useCallback(()=>{r&&r.dispatchCommand(Ha,"underline")},[r]),i=C.useCallback(()=>{r&&r.dispatchCommand(Ha,"strikethrough")},[r]),l=C.useCallback(v=>{r&&r.update(()=>{const _=Ht();Tt(_)&&Zh(_,()=>Au(v))})},[r]),c=C.useCallback(()=>{r&&r.update(()=>{const v=Ht();Tt(v)&&Zh(v,()=>Un())})},[r]),d=C.useCallback(()=>{r&&r.update(()=>{const v=Ht();Tt(v)&&Zh(v,()=>$p())})},[r]),f=C.useCallback(()=>{r&&r.dispatchCommand(Qb)},[r]),p=C.useCallback(()=>{r&&r.dispatchCommand(Zb)},[r]),g=C.useCallback(()=>{r&&r.dispatchCommand(eS)},[r]),y=C.useCallback(()=>{!r||!e||(r.update(()=>{const v=Ht();if(Tt(v)){const b=`${t+1}_________`,N=cs(b);N.setStyle("background-color: #f0f9ff; border: 1px dashed #3b82f6; padding: 2px 4px; border-radius: 4px; font-family: monospace;"),v.insertNodes([N])}}),e())},[r,e,t]);return o.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[o.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[o.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),o.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),o.jsx("button",{type:"button",onClick:a,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),o.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),o.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[o.jsx("button",{type:"button",onClick:()=>l("h1"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),o.jsx("button",{type:"button",onClick:()=>l("h2"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),o.jsx("button",{type:"button",onClick:()=>l("h3"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),o.jsx("button",{type:"button",onClick:c,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"}),o.jsx("button",{type:"button",onClick:d,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Quote",children:'"'})]}),o.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[o.jsx("button",{type:"button",onClick:f,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:""}),o.jsx("button",{type:"button",onClick:p,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1."}),o.jsx("button",{type:"button",onClick:g,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:""})]}),e&&o.jsx("div",{className:"flex items-center gap-1 border-l border-gray-300 pl-2",children:o.jsxs("button",{type:"button",onClick:y,className:"px-3 py-1 text-sm font-medium bg-blue-500 text-white border border-blue-600 rounded hover:bg-blue-600 transition-colors",title:"Add Blank",children:[o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",className:"inline mr-1",children:o.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Blank"]})})]})},NW=({value:e,onChange:t,placeholder:r,onAddBlank:n,blankCount:s=0})=>{const a={namespace:"FillBlanksLexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Wp,Ju,Dc,Up,_f,J1,zp,A0,j0,F0,Qu],onError:i=>{console.error("Lexical error:",i)},editorState:e?(()=>{try{const i=JSON.parse(e);return JSON.stringify(i)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return o.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:o.jsxs(XA,{initialConfig:a,children:[o.jsx(EW,{onAddBlank:n,blankCount:s}),o.jsx(TW,{onChange:t}),o.jsxs("div",{className:"relative",children:[o.jsx(hj,{contentEditable:o.jsx(mj,{className:"p-4 min-h-32 focus:outline-none"}),placeholder:o.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:yj}),o.jsx(pj,{}),o.jsx(xj,{}),o.jsx(Ij,{}),o.jsx(Dj,{transformers:Q1})]})]})})},AW=({testName:e="",allowedTime:t=null,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const{user:l}=Hn(),{post:c}=Xi(),{showNotification:d}=ja(),[f,p]=C.useState({test_name:e,test_text:"",num_questions:1,num_blanks:0,passing_score:100,separate_type:!0,allowed_time:t,blanks:[]}),[g,y]=C.useState({isLoading:!1,error:null,showPreview:!0});C.useEffect(()=>{p(R=>({...R,test_name:e||"",allowed_time:t}))},[e,t]);const v=R=>{p(E=>({...E,test_text:R}))},_=()=>{const E={id:f.blanks.length+1,position:0,question:"",options:["","","",""],correct_answer:""};p(D=>({...D,blanks:[...D.blanks,E],num_blanks:D.num_blanks+1}))},b=R=>{p(E=>({...E,blanks:E.blanks.filter(D=>D.id!==R),num_blanks:E.num_blanks-1}))},N=R=>{p(E=>({...E,blanks:E.blanks.map(D=>D.id===R?{...D,options:[...D.options,""]}:D)}))},k=(R,E)=>{p(D=>({...D,blanks:D.blanks.map(I=>I.id===R?{...I,options:I.options.filter((G,Y)=>Y!==E),correct_answer:I.correct_answer===String.fromCharCode(65+E)?"":I.correct_answer}:I)}))},w=(R,E,D)=>{p(I=>({...I,blanks:I.blanks.map(G=>G.id===R?{...G,options:G.options.map((Y,ee)=>ee===E?D:Y)}:G)}))},T=(R,E)=>{console.log(" [DEBUG] updateBlankQuestion called:",{blankId:R,question:E}),p(D=>({...D,blanks:D.blanks.map(I=>I.id===R?{...I,question:E}:I)})),console.log(" [DEBUG] updateBlankQuestion completed")},A=(R,E)=>{p(D=>({...D,blanks:D.blanks.map(I=>I.id===R?{...I,correct_answer:E}:I)}))},F=async()=>{if(!f.test_name.trim()){y(R=>({...R,error:"Test name is required"}));return}if(!f.test_text.trim()){y(R=>({...R,error:"Test text is required"}));return}if(f.blanks.length===0){y(R=>({...R,error:"At least one blank is required"}));return}if(console.log(" [DEBUG] Validating blanks:",f.blanks),f.blanks.forEach((R,E)=>{console.log(` [DEBUG] Blank ${E+1}:`,{question:R.question,questionTrimmed:R.question?.trim(),correct_answer:R.correct_answer,options:R.options})}),f.separate_type===!1){if(f.blanks.some(R=>!R.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing correct answer"),y(R=>({...R,error:"All blanks must have correct answers"}));return}}else if(f.blanks.some(R=>!R.question.trim()||!R.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing question or correct answer"),y(R=>({...R,error:"All blanks must have question text and correct answer"}));return}console.log(" [DEBUG] Validation passed - all blanks have question and correct answer"),y(R=>({...R,isLoading:!0,error:null}));try{const R={test_name:f.test_name,test_text:f.test_text,num_questions:f.blanks.length,num_blanks:f.blanks.length,separate_type:f.separate_type,passing_score:f.passing_score,allowed_time:f.allowed_time,blanks:f.blanks.map((E,D)=>({question_id:D+1,question_json:E.question,question:E.question,options:E.options,correct_answer:E.correct_answer,blank_positions:{},blank_options:E.options||[],correct_answers:[E.correct_answer]}))};console.log(" [DEBUG] Calling onTestSaved with data:",R),r?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),r(R),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(R){console.error("Error preparing fill blanks test:",R),y(E=>({...E,error:"Failed to prepare fill blanks test. Please try again."})),d("Failed to prepare fill blanks test","error")}finally{y(R=>({...R,isLoading:!1}))}};return o.jsx("div",{className:"fill-blanks-test-creator max-w-4xl mx-auto p-6",children:o.jsxs(bt,{className:"p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Fill Blanks Test"}),o.jsx("p",{className:"text-gray-600",children:"Create a test with rich text content and multiple choice blanks"}),o.jsx("div",{className:"mt-2 text-sm text-gray-600",children:o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("span",{children:[o.jsx("strong",{children:"Test Name:"})," ",e||"Untitled Test"]}),o.jsxs("span",{children:[o.jsx("strong",{children:"Blanks:"})," ",f.num_blanks," (auto-calculated)"]}),o.jsxs("span",{children:[o.jsx("strong",{children:"Timer:"})," ",f.allowed_time?`${f.allowed_time} minutes`:"No timer"]})]})}),g.error&&o.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:o.jsx("p",{className:"text-red-600 text-sm",children:g.error})})]}),o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Text Content with Blanks"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Type your text and add blanks where needed"})]}),o.jsx("div",{className:"flex items-center space-x-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Mode:"}),o.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[o.jsx("button",{onClick:()=>p(R=>({...R,separate_type:!0})),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors ${f.separate_type===!0?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Separate"}),o.jsx("button",{onClick:()=>p(R=>({...R,separate_type:!1})),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors ${f.separate_type===!1?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Inline"})]})]})})]}),o.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:o.jsxs("p",{className:"text-sm text-blue-800",children:[o.jsx("strong",{children:f.separate_type===!0?"Separate Mode:":"Inline Mode:"})," ",f.separate_type===!0?"Students see numbered blanks in text and answer questions below":"Students see clickable blanks in text with dropdown options"]})}),o.jsx(NW,{value:f.test_text,onChange:v,placeholder:"Type your text here. Use the 'Add Blank' button in the toolbar to insert blanks.",onAddBlank:_,blankCount:f.blanks.length})]}),f.separate_type===!0&&o.jsx("div",{className:"space-y-4",children:f.blanks.map((R,E)=>o.jsxs(bt,{className:"p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h4",{className:"text-md font-medium",children:["Blank ",R.id," Configuration"]}),o.jsx(et,{variant:"danger",size:"small",onClick:()=>b(R.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Question Text for Blank ",R.id," *"]}),o.jsx("input",{type:"text",placeholder:"Enter question text for this blank",value:R.question,onChange:D=>T(R.id,D.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),R.options.map((D,I)=>o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+I)}),o.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+I)}`,value:D||"",onChange:G=>w(R.id,I,G.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),R.options.length>2&&o.jsx(et,{variant:"danger",size:"small",onClick:()=>k(R.id,I),className:"px-2 py-1 text-sm",children:""})]},I)),R.options.length<6&&o.jsx(et,{variant:"secondary",size:"small",onClick:()=>N(R.id),className:"w-full",children:"+ Add Option"})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),o.jsxs("select",{value:R.correct_answer||"",onChange:D=>A(R.id,D.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Select correct answer"}),R.options.filter(D=>D.trim().length>0).map((D,I)=>o.jsxs("option",{value:String.fromCharCode(65+I),children:[String.fromCharCode(65+I),") ",D]},I))]})]})]},R.id))}),f.separate_type===!1&&o.jsx("div",{className:"space-y-4",children:f.blanks.map((R,E)=>o.jsxs(bt,{className:"p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h4",{className:"text-md font-medium",children:["Blank ",R.id," Options"]}),o.jsx(et,{variant:"danger",size:"small",onClick:()=>b(R.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),R.options.map((D,I)=>o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+I)}),o.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+I)}`,value:D||"",onChange:G=>w(R.id,I,G.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),R.options.length>2&&o.jsx(et,{variant:"danger",size:"small",onClick:()=>k(R.id,I),className:"px-2 py-1 text-sm",children:""})]},I)),R.options.length<6&&o.jsx(et,{variant:"secondary",size:"small",onClick:()=>N(R.id),className:"w-full",children:"+ Add Option"})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),o.jsxs("select",{value:R.correct_answer||"",onChange:D=>A(R.id,D.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Select correct answer"}),R.options.filter(D=>D.trim().length>0).map((D,I)=>o.jsxs("option",{value:String.fromCharCode(65+I),children:[String.fromCharCode(65+I),") ",D]},I))]})]})]},R.id))}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx(et,{onClick:n,variant:"secondary",disabled:a,children:"Cancel"}),o.jsx(et,{onClick:F,variant:"primary",disabled:a||f.blanks.length===0,children:a?o.jsx(Fr,{size:"sm"}):"Save Test"})]})]})})},jW=[{value:"A1",label:"A1 (Beginner)",description:"Basic vocabulary, simple sentences"},{value:"A2",label:"A2 (Elementary)",description:"Everyday vocabulary, present/past tenses"},{value:"B1",label:"B1 (Intermediate)",description:"Varied vocabulary, complex sentences"},{value:"B2",label:"B2 (Upper-Intermediate)",description:"Advanced vocabulary, sophisticated structures"},{value:"C1",label:"C1 (Advanced)",description:"Nuanced vocabulary, complex discourse"},{value:"C2",label:"C2 (Proficiency)",description:"Native-like fluency and accuracy"}],FW=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{showNotification:i}=ja(),[l,c]=C.useState({min_words:50,questions:[{question_id:1,prompt:"",expected_duration:null,difficulty_level:"B1"}]}),[d,f]=C.useState(!1),p=C.useCallback((N,k)=>{c(w=>({...w,[N]:k}))},[]),g=C.useCallback((N,k,w)=>{c(T=>({...T,questions:T.questions.map((A,F)=>F===N?{...A,[k]:w}:A)}))},[]),y=C.useCallback(()=>{c(N=>({...N,questions:[...N.questions,{question_id:N.questions.length+1,prompt:"",expected_duration:null,difficulty_level:"B1"}]}))},[]),v=C.useCallback(N=>{l.questions.length>1&&c(k=>({...k,questions:k.questions.filter((w,T)=>T!==N)}))},[l.questions.length]),_=C.useCallback(()=>{const N={};return l.min_words<10&&(N.min_words="Minimum word count must be at least 10 words"),l.questions.forEach((k,w)=>{k.prompt.trim()||(N[`question_${w}_prompt`]="Question prompt is required")}),N},[l]),b=C.useCallback(async N=>{N.preventDefault();const k=_();if(Object.keys(k).length>0){i("Please fix the validation errors","error");return}f(!0);try{const w={test_name:e,time_limit:300,min_duration:30,max_duration:600,max_attempts:3,min_words:l.min_words,passing_score:50,allowed_time:null,questions:l.questions.map((T,A)=>({question_id:A+1,prompt:T.prompt,expected_duration:T.expected_duration,difficulty_level:T.difficulty_level}))};console.log(" [DEBUG] Calling onTestSaved with data:",w),t?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),t(w),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(w){console.error("Error preparing speaking test:",w),i("Failed to prepare speaking test","error")}finally{f(!1)}},[l,_,i,t,e]);return d||s?o.jsxs("div",{className:"flex items-center justify-center p-8",children:[o.jsx(Fr,{}),o.jsx("span",{className:"ml-2",children:"Creating speaking test..."})]}):o.jsxs("div",{className:"speaking-test-creator max-w-4xl mx-auto",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Speaking Test"}),o.jsx("p",{className:"text-gray-600",children:"Create a speaking test where students record audio responses with AI-powered feedback"})]}),o.jsxs("form",{onSubmit:b,className:"space-y-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Scoring Settings"}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Word Count *"}),o.jsx("input",{type:"number",min:"10",max:"1000",value:l.min_words,onChange:N=>p("min_words",parseInt(N.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.min_words&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.min_words})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Questions"}),o.jsx(et,{type:"button",variant:"outline",onClick:y,children:"Add Question"})]}),l.questions.length>1&&o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:o.jsxs("div",{className:"flex items-start",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Multiple Questions Detected"}),o.jsx("div",{className:"mt-1 text-sm text-blue-700",children:o.jsxs("p",{children:["You have ",l.questions.length," questions in this test.",o.jsx("strong",{children:" Only one question will be randomly selected"})," and shown to each student. This ensures fair distribution across your question pool."]})})]})]})}),l.questions.map((N,k)=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-3",children:[o.jsxs("h4",{className:"font-medium",children:["Question ",k+1]}),l.questions.length>1&&o.jsx(et,{type:"button",variant:"outline",size:"sm",onClick:()=>v(k),className:"text-red-600 hover:text-red-700",children:"Remove"})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Prompt *"}),o.jsx("textarea",{value:N.prompt,onChange:w=>g(k,"prompt",w.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Enter the question prompt for students"}),a[`question_${k}_prompt`]&&o.jsx("p",{className:"text-red-500 text-sm mt-1",children:a[`question_${k}_prompt`]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected Duration (seconds)"}),o.jsx("input",{type:"number",min:"10",max:"600",value:N.expected_duration||"",onChange:w=>g(k,"expected_duration",w.target.value?parseInt(w.target.value):null),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CEFR Level"}),o.jsx("select",{value:N.difficulty_level,onChange:w=>g(k,"difficulty_level",w.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:jW.map(w=>o.jsxs("option",{value:w.value,children:[w.label," - ",w.description]},w.value))}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the appropriate CEFR level for this question. This will be used by AI to evaluate students appropriately."})]})]})]})]},k))]}),o.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[o.jsx(et,{type:"button",variant:"secondary",onClick:r,children:"Cancel"}),o.jsx(et,{type:"submit",variant:"primary",disabled:d||s,children:d||s?"Creating...":"Create Speaking Test"})]})]})]})},Mj=(e,t)=>{const[r,n]=C.useState(()=>{try{const i=window.localStorage.getItem(e);return i?JSON.parse(i):t}catch(i){return console.error(`Error reading localStorage key "${e}":`,i),t}}),s=C.useCallback(i=>{try{const l=i instanceof Function?i(r):i;n(l),window.localStorage.setItem(e,JSON.stringify(l))}catch(l){console.error(`Error setting localStorage key "${e}":`,l)}},[e,r]),a=C.useCallback(()=>{try{window.localStorage.removeItem(e),n(t)}catch(i){console.error(`Error removing localStorage key "${e}":`,i)}},[e,t]);return[r,s,a]},Z1=()=>{const e=C.useCallback((c,d=null)=>{try{const f=window.localStorage.getItem(c);return f?JSON.parse(f):d}catch(f){return console.error(`Error reading localStorage key "${c}":`,f),d}},[]),t=C.useCallback((c,d)=>{try{window.localStorage.setItem(c,JSON.stringify(d))}catch(f){console.error(`Error setting localStorage key "${c}":`,f)}},[]),r=C.useCallback(c=>{try{window.localStorage.removeItem(c)}catch(d){console.error(`Error removing localStorage key "${c}":`,d)}},[]),n=C.useCallback(()=>{if(confirm("Are you sure you want to clear all local storage? This cannot be undone."))try{window.localStorage.clear(),window.showNotification?window.showNotification("All local storage cleared!","success"):console.log("All local storage cleared!")}catch(c){console.error("Error clearing localStorage:",c)}},[]),s=C.useCallback(()=>{try{const c={};for(let g=0;g<window.localStorage.length;g++){const y=window.localStorage.key(g);y&&(c[y]=window.localStorage.getItem(y))}const d=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),f=URL.createObjectURL(d),p=document.createElement("a");p.href=f,p.download="localStorage_backup.json",p.click(),URL.revokeObjectURL(f),window.showNotification?window.showNotification("Local storage exported!","success"):console.log("Local storage exported!")}catch(c){console.error("Error exporting localStorage data:",c)}},[]),a=C.useCallback(()=>{try{window.localStorage.clear()}catch(c){console.error("Error clearing localStorage:",c)}},[]),i=C.useCallback(()=>{try{const c={};for(let d=0;d<window.localStorage.length;d++){const f=window.localStorage.key(d);f&&(c[f]=window.localStorage.getItem(f))}return c}catch(c){return console.error("Error exporting localStorage data:",c),{}}},[]),l=C.useCallback(c=>{try{Object.entries(c).forEach(([d,f])=>{window.localStorage.setItem(d,f)})}catch(d){console.error("Error importing localStorage data:",d)}},[]);return{getItem:e,setItem:t,removeItem:r,clearAll:a,clearAllLocalStorage:n,exportLocalStorage:s,exportData:i,importData:l}},PW=({question:e,testId:t,testType:r="true_false",mode:n="student",displayNumber:s,onAnswerChange:a,onQuestionChange:i,onSave:l,isEditing:c=!1,isSaving:d=!1,validationErrors:f={},showCorrectAnswers:p=!1,studentId:g=null})=>{const{getItem:y,setItem:v}=Z1();ja(),C.useRef(null);const[_,b]=C.useState(""),[N,k]=C.useState(""),[w,T]=C.useState(""),[A,F]=C.useState(!1),[R,E]=C.useState(!0),[D,I]=C.useState(""),[G,Y]=C.useState(!1),[ee,ie]=C.useState(null);C.useEffect(()=>{if(e&&(T(e.question||""),k(e.correct_answer||""),n==="student"&&g)){const K=y(`test_progress_${g}_${r}_${t}_${e.question_id}`);K&&b(K)}},[e,t,r,n,y]),C.useEffect(()=>{if(n==="student"&&_&&t&&e?.question_id&&g){const K=setTimeout(()=>{Y(!0),v(`test_progress_${g}_${r}_${t}_${e.question_id}`,_),ie(new Date().toLocaleTimeString()),setTimeout(()=>Y(!1),1e3)},1e3);return()=>clearTimeout(K)}},[_,t,r,e?.question_id,n,g,v]),C.useEffect(()=>{if(n==="teacher"&&(w||N)){const K=setTimeout(()=>{Y(!0);const Z={question:w,correct_answer:N,timestamp:Date.now()};v(`teacher_form_${r}_${t}`,Z),ie(new Date().toLocaleTimeString()),setTimeout(()=>Y(!1),1e3)},2e3);return()=>clearTimeout(K)}},[w,N,t,r,n,v]);const re=C.useCallback(K=>{n==="student"&&(b(K),a&&a(e.question_id,K),z(K))},[n,e?.question_id,a]),se=C.useCallback(K=>{T(K),i&&i(e.question_id,K),U(K)},[e?.question_id,i]),B=C.useCallback(K=>{k(K),i&&i(e.question_id,{...e,correct_answer:K}),V(K)},[e,i]),z=C.useCallback(K=>{if(n==="student"){if(!K){E(!1),I("Please select an answer");return}E(!0),I("")}},[n]),U=C.useCallback(K=>{if(n==="teacher"){if(!K||K.trim().length<10){E(!1),I("Question must be at least 10 characters long");return}E(!0),I("")}},[n]),V=C.useCallback(K=>{if(n==="teacher"){if(!K){E(!1),I("Please select a correct answer");return}E(!0),I("")}},[n]),q=C.useCallback(()=>{if(n!=="teacher"||!l)return;const K={question_id:e.question_id,question:w,correct_answer:N,type:"true_false"};l(K)},[n,l,e?.question_id,w,N]),L=C.useCallback(K=>K?K.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]),M=()=>o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:e?.question_id]}),o.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[G&&o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(Fr,{size:"small"}),o.jsx("span",{children:"Saving..."})]}),ee&&!G&&o.jsxs("div",{className:"text-green-600",children:[" Saved at ",ee]})]})]}),o.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:L(w)}}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${_==="true"?"border-blue-500 bg-blue-50":"border-gray-200"} ${p&&N==="true"?"ring-2 ring-green-400":""}`,children:[o.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"true",checked:_==="true",onChange:()=>re("true"),className:"sr-only","aria-label":"True"}),o.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${_==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:_==="true"&&o.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),o.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),o.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${_==="false"?"border-blue-500 bg-blue-50":"border-gray-200"} ${p&&N==="false"?"ring-2 ring-green-400":""}`,children:[o.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"false",checked:_==="false",onChange:()=>re("false"),className:"sr-only","aria-label":"False"}),o.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${_==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:_==="false"&&o.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),o.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]}),!R&&D&&o.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:D})]}),X=()=>o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),o.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[G&&o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(Fr,{size:"small"}),o.jsx("span",{children:"Saving..."})]}),ee&&!G&&o.jsxs("div",{className:"text-green-600",children:[" Saved at ",ee]})]})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),o.jsx("textarea",{id:`question_${e?.question_id}`,value:w,onChange:K=>se(K.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Correct Answer *"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${N==="true"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[o.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"true",checked:N==="true",onChange:()=>B("true"),className:"sr-only","aria-label":"True"}),o.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${N==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:N==="true"&&o.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),o.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),o.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${N==="false"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[o.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"false",checked:N==="false",onChange:()=>B("false"),className:"sr-only","aria-label":"False"}),o.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${N==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:N==="false"&&o.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),o.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]})]})]}),!R&&D&&o.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:D}),o.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:o.jsx(et,{variant:"success",onClick:q,disabled:!R||d,className:"w-full sm:w-auto",children:d?o.jsx(Fr,{size:"small"}):"Save Question"})})]});return o.jsx("div",{className:"true-false-question-container",children:n==="student"?M():X()})},RW=({question:e,testId:t,testType:r="multiple_choice",mode:n="student",onAnswerChange:s,onQuestionChange:a,onOptionAdd:i,onOptionRemove:l,onSave:c,isEditing:d=!1,isSaving:f=!1,validationErrors:p={},showCorrectAnswers:g=!1,studentId:y=null,displayNumber:v})=>{const{getItem:_,setItem:b}=Z1(),{showNotification:N}=ja();C.useRef(null);const[k,w]=C.useState(""),[T,A]=C.useState(["","","",""]),[F,R]=C.useState(""),[E,D]=C.useState(""),[I,G]=C.useState(!1),[Y,ee]=C.useState(!0),[ie,re]=C.useState(""),[se,B]=C.useState(!1),[z,U]=C.useState(null);C.useEffect(()=>{if(e&&(D(e.question||""),A(e.options||["","","",""]),R(e.correct_answer||""),n==="student"&&y)){const ge=_(`test_progress_${y}_${r}_${t}_${e.question_id}`);ge&&w(ge)}},[e,t,r,n,_]),C.useEffect(()=>{if(n==="student"&&k&&t&&e?.question_id&&y){const ge=setTimeout(()=>{B(!0),b(`test_progress_${y}_${r}_${t}_${e.question_id}`,k),U(new Date().toLocaleTimeString()),setTimeout(()=>B(!1),1e3)},1e3);return()=>clearTimeout(ge)}},[k,t,r,e?.question_id,n,y,b]),C.useEffect(()=>{if(n==="teacher"&&(E||T.some(ge=>ge.trim()))){const ge=setTimeout(()=>{B(!0);const Ue={question:E,options:T,correct_answer:F,timestamp:Date.now()};b(`teacher_form_${r}_${t}`,Ue),U(new Date().toLocaleTimeString()),setTimeout(()=>B(!1),1e3)},2e3);return()=>clearTimeout(ge)}},[E,T,F,t,r,n,b]),C.useCallback(ge=>{if(n!=="student")return;const Ue=String(ge);w(Ue),s&&s(e.question_id,Ue),K(Ue)},[n,e?.question_id,s]);const V=C.useCallback(ge=>{D(ge),a&&a(e.question_id,ge),Z(ge)},[e?.question_id,a]),q=C.useCallback((ge,Ue)=>{const Ge=[...T];Ge[ge]=Ue,A(Ge),a&&a(e.question_id,{...e,options:Ge}),J(Ge)},[T,e,a]),L=C.useCallback(ge=>{R(ge),a&&a(e.question_id,{...e,correct_answer:ge}),ne(ge)},[e,a]),M=C.useCallback(()=>{if(T.length<6){const ge=[...T,""];A(ge),i&&i(e.question_id,ge)}else N("Maximum 6 options allowed","warning")},[T,e?.question_id,i,N]),X=C.useCallback(ge=>{if(T.length>2){const Ue=T.filter((Ge,Je)=>Je!==ge);if(A(Ue),F===String.fromCharCode(65+ge))R("");else if(F&&String.fromCharCode(65+ge)<F){const Ge=String.fromCharCode(65+ge-1);R(Ge)}l&&l(e.question_id,Ue)}else N("Minimum 2 options required","warning")},[T,F,e?.question_id,l,N]),K=C.useCallback(ge=>{if(n==="student"){if(!ge){ee(!1),re("Please select an answer");return}ee(!0),e?.correct_answer&&ge===e.correct_answer?re(" Correct answer!"):e?.correct_answer?re(" Incorrect answer"):re("Answer selected")}},[n,e?.correct_answer]),Z=C.useCallback(ge=>!ge||ge.trim().length<10?(ee(!1),re("Question must be at least 10 characters long"),!1):(ee(!0),re(""),!0),[]),J=C.useCallback(ge=>{if(n!=="teacher")return;if(ge.filter(Ge=>Ge.trim().length>0).length<2){ee(!1),re("At least 2 options must be filled");return}if(ge.some(Ge=>Ge.trim().length>0&&Ge.trim().length<3)){ee(!1),re("Each option must be at least 3 characters long");return}ee(!0),re("")},[n]),ne=C.useCallback(ge=>{if(n==="teacher"){if(!ge){ee(!1),re("Please select a correct answer");return}ee(!0),re("")}},[n]),me=C.useCallback(()=>{if(n!=="teacher"||!c)return;const ge={question_id:e.question_id,question:E,options:T.filter(Ue=>Ue.trim().length>0),correct_answer:F,type:"multiple_choice"};c(ge)},[n,c,e?.question_id,E,T,F]),xe=C.useCallback(ge=>ge?ge.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]);return n==="teacher"?o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),o.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[se&&o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(Fr,{size:"small"}),o.jsx("span",{children:"Saving..."})]}),z&&!se&&o.jsxs("div",{className:"text-green-600",children:[" Saved at ",z]})]})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),o.jsx("textarea",{id:`question_${e?.question_id}`,value:E,onChange:ge=>V(ge.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Answer Options *"}),o.jsx(et,{variant:"secondary",size:"small",onClick:M,disabled:T.length>=6,className:"px-3 py-1 text-sm",children:"+ Add Option"})]}),o.jsx("div",{className:"space-y-3",children:T.map((ge,Ue)=>o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+Ue)}),o.jsx("input",{type:"text",value:ge,onChange:Ge=>q(Ue,Ge.target.value),placeholder:`Option ${String.fromCharCode(65+Ue)}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0}),T.length>2&&o.jsx(et,{variant:"danger",size:"small",onClick:()=>X(Ue),className:"px-2 py-1 text-sm",children:""})]},Ue))})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:`correct_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),o.jsxs("select",{id:`correct_${e?.question_id}`,value:F,onChange:ge=>L(ge.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0,children:[o.jsx("option",{value:"",children:"Select correct answer"}),T.map((ge,Ue)=>{if(!ge.trim())return null;const Ge=String.fromCharCode(65+Ue);return o.jsxs("option",{value:Ge,children:[Ge,") ",ge]},Ue)})]})]})]}),!Y&&ie&&o.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:ie}),o.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:o.jsx(et,{variant:"success",onClick:me,disabled:!Y||f,className:"w-full sm:w-auto",children:f?o.jsx(Fr,{size:"small"}):"Save Question"})})]}):o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof v=="number"?v:e?.question_id]}),o.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[se&&o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(Fr,{size:"small"}),o.jsx("span",{children:"Saving..."})]}),z&&!se&&o.jsxs("div",{className:"text-green-600",children:[" Saved at ",z]})]})]}),o.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:xe(E)}}),o.jsx("div",{className:"space-y-3",children:T.map((ge,Ue)=>o.jsxs("label",{className:`flex items-center p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ${k===String.fromCharCode(65+Ue)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[o.jsx("input",{type:"radio",name:`mcq_${t}_${e?.question_id}`,value:String.fromCharCode(65+Ue),checked:k===String.fromCharCode(65+Ue),onChange:Ge=>{w(Ge.target.value),s&&s(e?.question_id,Ge.target.value)},className:"mr-3"}),o.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600 mr-3",children:String.fromCharCode(65+Ue)}),o.jsx("span",{className:"flex-1",children:ge||`Option ${String.fromCharCode(65+Ue)}`})]},Ue))}),!Y&&ie&&o.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:ie})]})},DW=({question:e,testId:t,testType:r="input",mode:n="student",displayNumber:s,onAnswerChange:a,onQuestionChange:i,onAnswerAdd:l,onAnswerRemove:c,onSave:d,isEditing:f=!1,isSaving:p=!1,validationErrors:g={},showCorrectAnswers:y=!1,studentId:v=null})=>{const{getItem:_,setItem:b}=Z1(),{showNotification:N}=ja(),k=C.useRef(null),[w,T]=C.useState(""),[A,F]=C.useState([""]),[R,E]=C.useState(!1),[D,I]=C.useState(!0),[G,Y]=C.useState(""),[ee,ie]=C.useState(!1);C.useEffect(()=>{if(n==="student"&&e?.question_id&&t&&r&&v){const Z=`test_progress_${v}_${r}_${t}_${e.question_id}`,J=_(Z);J&&T(J)}},[e?.question_id,r,t,n,v,_]),C.useEffect(()=>{n==="teacher"&&e?.answers&&F(e.answers.length>0?e.answers:[""])},[e?.answers,n]),C.useEffect(()=>{if(n==="student"&&w&&e?.question_id&&t&&r&&v){const Z=setTimeout(()=>{ie(!0),b(`test_progress_${v}_${r}_${t}_${e.question_id}`,w),setTimeout(()=>ie(!1),1e3)},1e3);return()=>clearTimeout(Z)}},[w,e?.question_id,r,t,n,v,b]),C.useEffect(()=>{if(n==="teacher"&&A&&i){const Z=setTimeout(()=>{i({...e,answers:A.filter(J=>J.trim())})},500);return()=>clearTimeout(Z)}},[A,e,n,i]);const re=C.useCallback(Z=>{T(Z);const J=Z.trim().length>0;I(J),Y(J?"":"Please enter an answer"),a&&a(e.question_id,Z)},[e?.question_id,a]),se=C.useCallback((Z,J)=>{const ne=[...A];ne[Z]=J,F(ne),a&&a(e.question_id,ne)},[A,e?.question_id,a]),B=C.useCallback(()=>{if(n==="teacher"){const Z=[...A,""];F(Z),l&&l(e.question_id,Z)}},[A,e?.question_id,n,l]),z=C.useCallback(Z=>{if(n==="teacher"&&A.length>1){const J=A.filter((ne,me)=>me!==Z);F(J),c&&c(e.question_id,J)}},[A,e?.question_id,n,c]),U=C.useCallback(()=>{if(n==="student"){const Z=w.trim().length>0;return I(Z),Y(Z?"":"Please enter an answer"),Z}else if(n==="teacher"){const Z=A.some(J=>J.trim().length>0);return I(Z),Y(Z?"":"Please enter at least one correct answer"),Z}return!0},[w,A,n]),V=C.useCallback(Z=>Z?Z.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>"):"",[]),q=C.useCallback(()=>{E(!0)},[]),L=C.useCallback(()=>{E(!1),U()},[U]),M=C.useCallback(Z=>{Z.key==="Enter"&&n==="student"&&w.trim()&&(b(`test_progress_${r}_${t}_${e.question_id}`,w),N("Answer saved","success"))},[w,r,t,e?.question_id,n,b,N]),X=()=>o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:e.question_id]}),ee&&o.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[o.jsx(Fr,{size:"small"}),o.jsx("span",{children:"Saving..."})]})]}),o.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:V(e.question)}}),o.jsx("div",{className:"space-y-3",children:o.jsx("input",{ref:k,type:"text",id:`input_${e.question_id}`,placeholder:"Enter your answer here...",value:w,onChange:Z=>re(Z.target.value),onFocus:q,onBlur:L,onKeyPress:M,className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${D?R?"border-blue-500":"border-gray-300 hover:border-gray-400":"border-red-300 focus:border-red-500 focus:ring-red-500"}`,"data-question-id":e.question_id,"aria-label":`Answer for question ${e.question_id}`,"aria-invalid":!D,"aria-describedby":D?void 0:`error-${e.question_id}`})}),y&&e.correct_answers&&o.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[o.jsx("h5",{className:"text-sm font-semibold text-green-800 mb-2",children:"Correct Answers:"}),o.jsx("ul",{className:"space-y-1",children:e.correct_answers.map((Z,J)=>o.jsxs("li",{className:"text-green-700 text-sm",children:[" ",Z]},J))})]})]}),K=()=>o.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e.question_id||"New"]}),p&&o.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[o.jsx(Fr,{size:"small"}),o.jsx("span",{children:"Saving..."})]})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:`question_${e.question_id||"new"}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),o.jsx("input",{type:"text",id:`question_${e.question_id||"new"}`,value:e.question||"",onChange:Z=>i&&i({...e,question:Z.target.value}),placeholder:"Enter question text",className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${g.question?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 hover:border-gray-400 focus:border-blue-500"}`}),g.question&&o.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:g.question})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Correct Answers *"}),o.jsx(et,{type:"button",variant:"secondary",size:"small",onClick:B,className:"px-3 py-1 text-sm",children:"+ Add Answer"})]}),o.jsx("div",{className:"space-y-3",children:A.map((Z,J)=>o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:J+1}),o.jsx("input",{type:"text",value:Z,onChange:ne=>se(J,ne.target.value),placeholder:`Correct answer ${J+1}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200","data-question-id":e.question_id,"data-answer-index":J}),A.length>1&&o.jsx(et,{type:"button",variant:"danger",size:"small",onClick:()=>z(J),className:"px-2 py-1 text-sm",children:" Remove"})]},J))}),g.answers&&o.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:g.answers})]})]}),d&&o.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:o.jsx(et,{type:"button",variant:"success",onClick:d,disabled:p,className:"w-full sm:w-auto",children:p?o.jsx(Fr,{size:"small"}):"Save Question"})})]});return o.jsx("div",{className:`input-question-container ${n} ${R?"focused":""}`,children:n==="student"?X():K()})},Go=({isOpen:e=!1,onClose:t,title:r="",children:n,size:s="medium",showCloseButton:a=!0,closeOnBackdropClick:i=!0,className:l="",...c})=>{if(!e)return null;const d=p=>{i&&p.target===p.currentTarget&&t()};us.useEffect(()=>{const p=g=>{g.key==="Escape"&&t()};return e&&(document.addEventListener("keydown",p),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",p),document.body.style.overflow="unset"}},[e,t]);const f={small:"max-w-sm",medium:"max-w-md",large:"max-w-2xl"};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:d,role:"dialog","aria-modal":"true","aria-label":r,...c,children:o.jsxs("div",{className:`
          bg-white rounded-xl shadow-md border border-gray-200 p-6
          hover:shadow-lg hover:-translate-y-1 transition-all duration-200
          w-full ${f[s]} mx-auto
          ${l}
        `,onClick:p=>p.stopPropagation(),children:[(r||a)&&o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r&&o.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:r}),a&&o.jsx(et,{variant:"secondary",size:"small",onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200","aria-label":"Close modal",children:""})]}),o.jsx("div",{className:"space-y-6",children:n})]})})},Gp=(e,t,r)=>{const[n,s]=C.useState(!1),[a,i]=C.useState(0),[l,c]=C.useState(!1),d=C.useRef(!1);C.useEffect(()=>{if(!e||!t||!r)return;const b=`anti_cheating_${r}_${e}_${t}`,N=Rn(b);N&&(i(N.tabSwitches||0),c(N.isCheating||!1))},[e,t,r]);const f=C.useCallback(()=>{if(console.log(" handleTabSwitch called - isTracking:",d.current),!d.current){console.log(" Not tracking, returning early");return}console.log(" Tab switch detected - starting 7 second timer...");const b=Date.now();setTimeout(()=>{const N=Date.now()-b;console.log(" Timer completed - time hidden:",N,"ms"),N>=6500?(console.log(" Tab was hidden for sufficient time - counting as tab switch"),i(k=>{const w=k+1,T=w>=2;console.log(" Tab switch count updated:",{newCount:w,cheating:T}),c(T);const A=`anti_cheating_${r}_${e}_${t}`;return Dn(A,{tabSwitches:w,isCheating:T},120*1e3),w})):console.log(" Tab was not hidden long enough - not counting as switch")},7e3)},[e,t,r]),p=C.useCallback(()=>{d.current&&(console.log(" Visibility change detected:",{hidden:document.hidden,isTracking:d.current}),document.hidden?f():console.log(" Tab became visible"))},[f]),g=C.useCallback(()=>{console.log(" startTracking called - setting up anti-cheating detection"),console.log(" Current document.hidden state:",document.hidden),console.log(" Current document.visibilityState:",document.visibilityState),s(!0),d.current=!0,document.addEventListener("visibilitychange",p),console.log(" Anti-cheating event listeners added (visibilitychange only)")},[p]),y=C.useCallback(()=>{console.log(" stopTracking called - removing anti-cheating detection"),s(!1),d.current=!1,document.removeEventListener("visibilitychange",p),console.log(" Anti-cheating event listeners removed")},[p]),v=C.useCallback(()=>{const b={caught_cheating:l,visibility_change_times:a};return console.log(" getCheatingData called:",b),b},[l,a]),_=C.useCallback(()=>{r&&e&&t&&y0(r,e,t),i(0),c(!1),console.log(" Anti-cheating data deleted from localStorage")},[r,e,t]);return{startTracking:g,stopTracking:y,clearData:_,getCheatingData:v,tabSwitches:a,isCheating:l,isTracking:n}},IW=({testData:e,onTestComplete:t,onBackToCabinet:r,isTestComplete:n=!1,testScore:s=null})=>{const[a,i]=C.useState(null),[l,c]=C.useState(null);C.useEffect(()=>{(async()=>{try{const[Pe,Qe]=await Promise.all([Vo(()=>Promise.resolve().then(()=>kL),void 0),Vo(()=>Promise.resolve().then(()=>rO),void 0)]);i(Pe),c(Qe.default)}catch(Pe){console.error("Failed to load Konva:",Pe)}})()},[]);const d=()=>a?{Stage:a.Stage,Layer:a.Layer,Rect:a.Rect,Arrow:a.Arrow,KonvaImage:a.Image,KonvaText:a.Text,Group:a.Group}:null,[f,p]=C.useState({}),[g,y]=C.useState({}),[v,_]=C.useState(0),[b,N]=C.useState(!1),[k,w]=C.useState(null),[T,A]=C.useState(0),[F,R]=C.useState(0),[E,D]=C.useState(null),[I,G]=C.useState(null),[Y,ee]=C.useState(!1),[ie,re]=C.useState(!1),{showNotification:se}=ja(),{makeAuthenticatedRequest:B}=Xi(),{user:z}=Hn(),{startTracking:U,stopTracking:V,getCheatingData:q,clearData:L}=Gp("matching_type",e?.id,z?.student_id||z?.id),M=C.useRef(null),X=C.useRef(null),K=C.useRef(null),Z=C.useRef(0),[J,ne]=C.useState(400);C.useRef({});const me=C.useCallback(()=>{ee(!0)},[]),xe=C.useCallback(()=>{y({}),p({}),ee(!1)},[]),Ne=C.useCallback(()=>{re(!0)},[]),le=C.useCallback(()=>{re(!1),r()},[r]),ge=C.useMemo(()=>{if(!e)return null;const Ie=e.blocks.map(_t=>{let gt=_t.coordinates;if(typeof gt=="string")try{gt=JSON.parse(gt)}catch(Bt){console.error(" Failed to parse coordinates:",Bt),gt={x:0,y:0,width:100,height:100}}return gt={x:(typeof gt.x=="number"?gt.x:Number(gt.x))||0,y:(typeof gt.y=="number"?gt.y:Number(gt.y))||0,width:(typeof gt.width=="number"?gt.width:Number(gt.width))||30,height:(typeof gt.height=="number"?gt.height:Number(gt.height))||10},{id:_t.id,word:_t.word,coordinates:gt,hasArrow:_t.hasArrow,arrow:_t.arrow}}),Pe=Array.isArray(e.arrows)?e.arrows:[],Qe=e.words.map(_t=>({id:_t.id,word:_t.word,blockId:null,isPlaced:!1,isCorrect:!1}));return{blocks:Ie,arrows:Pe,words:Qe}},[e]);C.useEffect(()=>{if(!e?.image_url)return;const Ie=new Image;Ie.crossOrigin="anonymous",Ie.onload=()=>{console.log(" Image loaded successfully"),A(Ie.width),R(Ie.height);const Pe=M.current?.clientWidth||800,Qe=M.current?.clientHeight||600,_t=Pe/Ie.width,gt=Qe/Ie.height,Bt=Math.min(_t,gt,1),Ut=Ie.width*Bt,it=Ie.height*Bt,Ye=(Pe-Ut)/2,xt=(Qe-it)/2;w({x:Ye,y:xt,width:Ut,height:it,scaleX:Bt,scaleY:Bt,scale:Bt,image:Ie}),Z.current=M.current?.clientWidth||800,console.log(" Image info calculated:",{x:Ye,y:xt,width:Ut,height:it,scaleX:Bt,scaleY:Bt})},Ie.onerror=()=>{console.error(" Failed to load image"),se("Failed to load test image","error")},Ie.src=e.image_url},[e?.image_url,se]),C.useEffect(()=>{if(!ge||!k)return;const Ie=Z.current||M.current?.clientWidth||800,Pe=12,Qe=38;let _t=k.x,gt=k.y+k.height+Pe;const Bt=k.x+k.width,Ut={};ge.words.forEach(xt=>{if(!Object.prototype.hasOwnProperty.call(g,xt.id)){const ut=typeof xt.word=="string"?xt.word:"",wt=Math.max(60,ut.length*8+20);_t+wt>Math.min(Ie-Pe,Bt)&&(_t=k.x,gt+=Qe),f[xt.id]||(Ut[xt.id]={x:_t,y:gt}),_t+=wt+Pe}}),Object.keys(Ut).length&&p(xt=>({...xt,...Ut}));const it=Object.values(Ut).reduce((xt,ut)=>Math.max(xt,ut.y),gt),Ye=Math.max(k.y+k.height+Pe,it+Qe+Pe);ne(Math.max(400,Math.ceil(Ye)))},[ge,k,g,f]);const Ue=C.useCallback(()=>{if(!k||!ge)return[];const Ie=d();return Ie?ge.blocks.map(Pe=>{const Qe=Pe.coordinates;let _t,gt,Bt,Ut;_t=k.x+Qe.x*(k.scale??k.scaleX),gt=k.y+Qe.y*(k.scale??k.scaleY),Bt=Qe.width*(k.scale??k.scaleX),Ut=Qe.height*(k.scale??k.scaleY);const it=g[Pe.id];return o.jsxs(Ie.Group,{children:[o.jsx(Ie.Rect,{x:_t,y:gt,width:Bt,height:Ut,fill:it?"rgba(40, 167, 69, 0.4)":E===Pe.id?"rgba(0, 123, 255, 0.25)":"rgba(0, 123, 255, 0.15)",stroke:it?"#28a745":E===Pe.id?"#0056b3":"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:it?"rgba(40, 167, 69, 0.3)":"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),it&&o.jsx(Ie.KonvaText,{x:_t+5,y:gt+Ut/2-10,width:Bt-10,height:20,text:ge.words.find(Ye=>Ye.id===it)?.word||"",fontSize:Math.min(12,Bt/8),fontFamily:"Arial",fill:"#2c3e50",align:"center",verticalAlign:"middle",listening:!1})]},Pe.id)}):[]},[k,ge,g,a]),Ge=C.useCallback(()=>{if(!k||!ge)return[];const Ie=d();return Ie?(console.log(" Processing arrows:",ge.arrows),ge.arrows.map(Pe=>{if(console.log(" Arrow data:",Pe),!Pe.start||!Pe.end)return console.warn(" Arrow missing start/end coordinates:",Pe),null;let Qe,_t,gt,Bt;if(Pe.rel_start_x!==null&&Pe.rel_start_y!==null&&Pe.rel_end_x!==null&&Pe.rel_end_y!==null&&Pe.image_width&&Pe.image_height&&Pe.image_width>0&&Pe.image_height>0){const Ut=Pe.image_width,it=Pe.image_height,Ye=k.width/Ut,xt=k.height/it;Qe=k.x+Number(Pe.rel_start_x)/100*Ut*Ye,_t=k.y+Number(Pe.rel_start_y)/100*it*xt,gt=k.x+Number(Pe.rel_end_x)/100*Ut*Ye,Bt=k.y+Number(Pe.rel_end_y)/100*it*xt}else{const Ut=k.scale??k.scaleX??1,it=Number(Pe.start.x),Ye=Number(Pe.start.y),xt=Number(Pe.end.x),ut=Number(Pe.end.y);it<=k.width+1&&xt<=k.width+1&&Ye<=k.height+1&&ut<=k.height+1?(Qe=k.x+(isNaN(it)?0:it),_t=k.y+(isNaN(Ye)?0:Ye),gt=k.x+(isNaN(xt)?0:xt),Bt=k.y+(isNaN(ut)?0:ut)):(Qe=k.x+(isNaN(it)?0:it)*Ut,_t=k.y+(isNaN(Ye)?0:Ye)*Ut,gt=k.x+(isNaN(xt)?0:xt)*Ut,Bt=k.y+(isNaN(ut)?0:ut)*Ut)}return o.jsx(Ie.Arrow,{points:[Qe,_t,gt,Bt],stroke:Pe.style?.color||"#dc3545",fill:Pe.style?.color||"#dc3545",strokeWidth:Pe.style?.thickness||3,pointerLength:10,pointerWidth:10},Pe.id)}).filter(Boolean)):[]},[k,ge,a]),Je=C.useCallback(()=>{if(!ge)return[];const Ie=d();return Ie?ge.words.map(Pe=>{const Qe=f[Pe.id]||{x:0,y:0},_t=typeof Pe.word=="string"?Pe.word:"",gt=Math.max(60,_t.length*8+20);return Object.values(g).includes(Pe.id)?null:o.jsxs(Ie.Group,{x:Qe.x,y:Qe.y,draggable:!0,onDragEnd:Ut=>He(Ut,Pe.id),children:[o.jsx(Ie.Rect,{width:gt,height:34,fill:"#ffffff",stroke:"#ced4da",strokeWidth:1,cornerRadius:4,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5,shadowOffset:{x:0,y:2},shadowOpacity:.3,listening:!0}),o.jsx(Ie.KonvaText,{text:_t,fontSize:14,fontFamily:"Arial",fill:"#343a40",padding:8,align:"center",verticalAlign:"middle",width:gt,height:34,listening:!1})]},Pe.id)}):[]},[ge,f,g,k,a]),He=C.useCallback((Ie,Pe)=>{const Qe=Ie.target.x(),_t=Ie.target.y();if(p(wt=>({...wt,[Pe]:{x:Qe,y:_t}})),!k||!ge)return;const gt=ge.words.find(wt=>wt.id===Pe);if(!gt)return;const Bt=typeof gt.word=="string"?gt.word:"",Ut=Math.max(60,Bt.length*8+20),it={x:Qe,y:_t,width:Ut,height:34},Ye=k.scale??k.scaleX??1,xt=(wt,$t)=>!($t.x>wt.x+wt.width||$t.x+$t.width<wt.x||$t.y>wt.y+wt.height||$t.y+$t.height<wt.y),ut=ge.blocks.find(wt=>{const $t=wt.coordinates,Kt={x:k.x+$t.x*Ye,y:k.y+$t.y*Ye,width:$t.width*Ye,height:$t.height*Ye};return xt(it,Kt)});if(ut){y(mt=>({...mt,[ut.id]:Pe}));const wt=ut.coordinates,$t=k.x+wt.x*Ye,Kt=k.y+wt.y*Ye,De=wt.width*Ye,ct=wt.height*Ye;p(mt=>({...mt,[Pe]:{x:$t+(De-Ut)/2,y:Kt+(ct-34)/2}})),se(`Word "${gt.word}" placed in block`,"success")}},[k,ge,se]),Ft=C.useCallback(()=>{if(!ge)return 0;const Ie=ge.words.length,Pe=Object.keys(g).length;return Ie>0?Pe/Ie*100:0},[ge,g]);C.useEffect(()=>{const Ie=Ft();_(Ie)},[Ft]),C.useEffect(()=>{if(e&&!I){const Ie=new Date;G(Ie),console.log(" Test timer started at:",Ie.toISOString()),U(),console.log(" Anti-cheating tracking started")}},[e,I,U]);const rt=C.useCallback(async()=>{if(ge){N(!0);try{const Ie=ge.words.length;let Pe=0;console.log(" Scoring check - placedWords:",g),console.log(" Scoring check - blocks:",ge.blocks.map(De=>({id:De.id,word:De.word}))),console.log(" Scoring check - words:",ge.words.map(De=>({id:De.id,word:De.word}))),ge.blocks.forEach(De=>{const ct=g[De.id];if(console.log(` Block ${De.id} (expects "${De.word}") has placed word ID: ${ct}`),ct){const mt=ge.words.find(At=>At.id===ct);console.log(" Placed word:",mt),mt&&mt.word===De.word?(Pe++,console.log(` Correct! Block ${De.id} has correct word "${mt.word}"`)):console.log(` Incorrect! Block ${De.id} expected "${De.word}" but got "${mt?.word||"nothing"}"`)}else console.log(` Block ${De.id} has no word placed`)});const Qe=Pe,_t=Ie;console.log(` Final Score: ${Qe}/${_t} (${Math.round(Qe/_t*100)}%)`);const gt=new Date,Bt=I?Math.round((gt-I)/1e3):0,Ut=I?I.toISOString():gt.toISOString();console.log(" Test timing:",{startedAt:Ut,endTime:gt.toISOString(),timeTaken:`${Bt} seconds`});const it=q();console.log(" Anti-cheating data for submission:",it);const Ye=z.student_id,xt=`retest_assignment_id_${Ye}_matching_type_${e.id}`,ut=localStorage.getItem(xt),wt={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:Ye,answers:g,score:Qe,maxScore:_t,time_taken:Bt,started_at:Ut,submitted_at:gt.toISOString(),caught_cheating:it.caught_cheating,visibility_change_times:it.visibility_change_times,retest_assignment_id:ut?Number(ut):null,parent_test_id:e.id};console.log(" Submitting test data:",wt);const Kt=await(await B("/.netlify/functions/submit-matching-type-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(wt)})).json();if(console.log(" Submission response:",Kt),Kt.success){if(se("Test submitted successfully!","success"),V(),L(),z?.student_id&&y0(z.student_id,"matching_type",e.id),z?.student_id){const ct=`test_completed_${z.student_id}_matching_type_${e.id}`;localStorage.setItem(ct,"true"),console.log(" Test marked as completed in localStorage:",ct)}if(z?.student_id){const{setCachedData:ct,CACHE_TTL:mt}=await Vo(async()=>{const{setCachedData:Lt,CACHE_TTL:rr}=await Promise.resolve().then(()=>Lh);return{setCachedData:Lt,CACHE_TTL:rr}},void 0),At=`student_results_table_${z.student_id}`;ct(At,Kt,mt.student_results_table),console.log(" Test results cached with key:",At)}const De=`retest1_${Ye}_matching_type_${e.id}`;localStorage.removeItem(De),localStorage.removeItem(xt),t&&t(Qe)}else throw new Error(Kt.message||"Failed to submit test")}catch(Ie){console.error(" Error submitting test:",Ie),se(`Error submitting test: ${Ie.message}`,"error")}finally{N(!1)}}},[ge,g,e,z,I,B,se,t]);return!e||!ge?o.jsx(Fr,{}):o.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:o.jsxs("div",{className:"max-w-6xl mx-auto",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("div",{children:o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e.test_name})}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-sm text-gray-500",children:"Progress"}),o.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(v),"%"]})]})]}),o.jsx("div",{className:"mt-4 w-full bg-gray-200 rounded-full h-2",children:o.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${v}%`}})})]}),o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:o.jsx("div",{className:"lg:col-span-3",children:o.jsxs(bt,{className:"p-4",children:[o.jsxs("div",{className:"mb-4 text-center space-x-4",children:[o.jsx(et,{onClick:me,variant:"secondary",children:"Reset"}),o.jsx(et,{onClick:Ne,variant:"secondary",children:"Back to Cabinet"})]}),o.jsx("div",{ref:M,className:"w-full bg-gray-100 rounded-lg overflow-hidden",style:{height:`${J}px`},children:k&&a?(()=>{const{Stage:Ie,Layer:Pe,KonvaImage:Qe}=d();return o.jsxs(Ie,{ref:X,width:M.current?.clientWidth||800,height:J,children:[o.jsxs(Pe,{children:[o.jsx(Qe,{ref:K,image:k.image,x:k.x,y:k.y,width:k.width,height:k.height,listening:!1}),Ue(),Ge()]}),o.jsx(Pe,{listening:!0,children:Je()})]})})():k?o.jsxs("div",{className:"flex items-center justify-center h-full",children:[o.jsx(Fr,{size:"lg"}),o.jsx("span",{className:"ml-2 text-gray-600",children:"Loading Konva canvas..."})]}):null}),o.jsx("div",{className:"mt-4 text-center",children:o.jsx(et,{onClick:rt,disabled:b||v<100,children:b?"Submitting...":"Submit Test"})})]})})}),o.jsx(Go,{isOpen:Y,onClose:()=>ee(!1),title:"Reset Test",size:"small",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and placed words."}),o.jsxs("div",{className:"flex gap-3 justify-center",children:[o.jsx(et,{onClick:()=>ee(!1),variant:"secondary",children:"Cancel"}),o.jsx(et,{onClick:xe,variant:"primary",children:"Reset"})]})]})}),o.jsx(Go,{isOpen:ie,onClose:()=>re(!1),title:"Exit Test",size:"small",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet? Your progress will be saved but you will exit the test."}),o.jsxs("div",{className:"flex gap-3 justify-center",children:[o.jsx(et,{onClick:()=>re(!1),variant:"secondary",children:"Cancel"}),o.jsx(et,{onClick:le,variant:"primary",children:"Go Back"})]})]})})]})})},MW=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=Hn(),{makeAuthenticatedRequest:l}=Xi(),{showNotification:c}=ja(),[d,f]=C.useState([{leftWord:"",rightWord:""},{leftWord:"",rightWord:""},{leftWord:"",rightWord:""}]),[p,g]=C.useState("drag"),[y,v]=C.useState(!1),[_,b]=C.useState(null),N=C.useCallback(()=>{f(R=>[...R,{leftWord:"",rightWord:""}])},[]),k=C.useCallback(R=>{d.length>1&&f(E=>E.filter((D,I)=>I!==R))},[d.length]),w=C.useCallback((R,E)=>{f(D=>D.map((I,G)=>G===R?{...I,leftWord:E}:I))},[]),T=C.useCallback((R,E)=>{f(D=>D.map((I,G)=>G===R?{...I,rightWord:E}:I))},[]),A=C.useCallback(()=>d.every(R=>R.leftWord.trim()&&R.rightWord.trim()),[d]),F=C.useCallback(async()=>{if(!A()){c("Please fill in all word pairs","error");return}v(!0),b(null);try{const R=d.map((D,I)=>({question_id:I+1,left_word:D.leftWord.trim(),right_word:D.rightWord.trim()})),E={test_name:e,num_questions:R.length,interaction_type:p,questions:R};console.log(" Saving word matching test:",E),t({testName:e,numQuestions:R.length,interactionType:p,wordPairs:d,questions:R})}catch(R){console.error("Error saving word matching test:",R),b(R.message),c("Failed to save test: "+R.message,"error")}finally{v(!1)}},[e,d,p,A,l,c,t]);return o.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-6xl mx-auto p-6",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Word Matching Test"}),o.jsx("p",{className:"text-gray-600",children:"Enter word pairs - position 1 left matches position 1 right"})]}),o.jsx(bt,{className:"mb-6",children:o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Choose Interaction Type"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${p==="drag"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>g("drag"),children:[o.jsxs("div",{className:"flex items-center mb-2",children:[o.jsx("input",{type:"radio",checked:p==="drag",onChange:()=>g("drag"),className:"mr-3"}),o.jsx("h4",{className:"font-medium",children:"Drag & Drop"})]}),o.jsx("p",{className:"text-sm text-gray-600",children:"Students drag words from left list to right list"}),o.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" Easier for younger students",o.jsx("br",{})," Visual feedback on placement",o.jsx("br",{})," Mobile-friendly"]})]}),o.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${p==="arrow"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>g("arrow"),children:[o.jsxs("div",{className:"flex items-center mb-2",children:[o.jsx("input",{type:"radio",checked:p==="arrow",onChange:()=>g("arrow"),className:"mr-3"}),o.jsx("h4",{className:"font-medium",children:"Draw Arrows"})]}),o.jsx("p",{className:"text-sm text-gray-600",children:"Students draw arrows connecting matching words"}),o.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" More challenging",o.jsx("br",{})," Better for visual learners",o.jsx("br",{})," Requires precision"]})]})]})]})}),o.jsx(bt,{className:"mb-6",children:o.jsxs("div",{className:"word-pairs-section",children:[o.jsxs("div",{className:"pairs-header flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Word Pairs"}),o.jsx(et,{onClick:N,size:"sm",children:"+ Add Pair"})]}),o.jsx("div",{className:"pairs-list space-y-3",children:d.map((R,E)=>o.jsxs("div",{className:"word-pair-row flex items-center space-x-4 p-4 bg-gray-50 rounded-lg border",children:[o.jsx("div",{className:"pair-number flex-shrink-0",children:o.jsx("span",{className:"number-badge w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-semibold",children:E+1})}),o.jsx("div",{className:"left-word flex-1",children:o.jsx("input",{type:"text",value:R.leftWord,onChange:D=>w(E,D.target.value),placeholder:"Left word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),o.jsx("div",{className:"pair-arrow flex-shrink-0 text-gray-500 text-xl",children:""}),o.jsx("div",{className:"right-word flex-1",children:o.jsx("input",{type:"text",value:R.rightWord,onChange:D=>T(E,D.target.value),placeholder:"Right word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),o.jsx("div",{className:"pair-actions flex-shrink-0",children:o.jsx(et,{onClick:()=>k(E),variant:"outline",size:"sm",className:"remove-btn w-8 h-8 p-0 text-red-500 hover:bg-red-50",disabled:d.length<=1,children:""})})]},E))})]})}),o.jsx(bt,{className:"mb-6",children:o.jsxs("div",{className:"preview-section",children:[o.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Preview"}),o.jsx("div",{className:"preview-pairs space-y-2",children:d.map((R,E)=>o.jsxs("div",{className:"preview-pair flex items-center space-x-2 text-sm",children:[o.jsxs("span",{className:"preview-number font-semibold text-blue-600",children:[E+1,"."]}),o.jsx("span",{className:"preview-left px-2 py-1 bg-white rounded border",children:R.leftWord||"Left word"}),o.jsx("span",{className:"preview-arrow text-gray-500",children:""}),o.jsx("span",{className:"preview-right px-2 py-1 bg-white rounded border",children:R.rightWord||"Right word"})]},E))})]})}),o.jsxs("div",{className:"flex justify-center space-x-4",children:[o.jsx(et,{onClick:F,disabled:!A()||y,className:"px-8",children:y?o.jsxs(o.Fragment,{children:[o.jsx(Fr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test"}),o.jsx(et,{onClick:r,variant:"secondary",children:"Cancel"})]}),_&&o.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:o.jsx("p",{className:"text-red-600",children:_})})]})},OW=(e,t)=>{const[r,n,s]=Mj(`test_progress_${e}_${t}`,{}),[a,i]=C.useState(!1),[l,c]=C.useState(0),[d,f]=C.useState(0),[p,g]=C.useState(!1),[y,v]=C.useState(null),_=C.useRef(null),b=C.useRef(null),N=C.useCallback((U,V)=>{if(!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}n(q=>({...q,[U]:V})),console.log(`Saved progress for question ${U}:`,V)},[n]),k=C.useCallback(U=>!window.tokenManager||!window.tokenManager.isAuthenticated()?(console.warn("[WARN] Cannot get progress: No valid JWT token"),null):r[U]||null,[r]),w=C.useCallback(()=>{if(console.log(`[DEBUG] clearTestProgress called with testType: ${e}, testId: ${t}`),!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const U=`test_progress_${e}_${t}`;console.log(`[DEBUG] Removing localStorage key: ${U}`);const V=Object.keys(r).length>0;s(),console.log(V?`[DEBUG] Progress cleared for test ${e}_${t}`:`[DEBUG] No progress found to clear for test ${e}_${t}`)},[s,e,t,r]),T=C.useCallback(()=>{_.current&&(T(_.current),_.current=null),b.current&&(T(b.current),b.current=null)},[]),A=C.useCallback(()=>{console.log(`[DEBUG] setupProgressTrackingForPage called with testType: ${e}, testId: ${t}`),b.current=setInterval(()=>{console.log("[DEBUG] Auto-saving progress..."),I()},3e4),console.log("[DEBUG] Progress tracking interval set up (30 seconds)")},[e,t]),F=C.useCallback(()=>{console.log(`[DEBUG] updateProgressDisplayForPage called with testType: ${e}, testId: ${t}`);const U=D(),V=d>0?Math.round(U/d*100):0;return console.log(`[DEBUG] Progress: ${U}/${d} questions answered`),console.log(`[DEBUG] Progress bar updated: ${V}%`),{answeredQuestions:U,totalQuestions:d,percentage:V}},[e,t,d]),R=C.useCallback(()=>{console.log("[DEBUG] updateSubmitButtonStateForPage called");const U=D();console.log(`[DEBUG] Submit button state check: ${U}/${d} questions answered`);const V=U===d&&d>0;return console.log(V?"[DEBUG] Submit button enabled - all questions answered":"[DEBUG] Submit button disabled - not all questions answered"),V},[d]),E=C.useCallback(()=>{console.log(`[DEBUG] loadSavedProgressForPage called with testType: ${e}, testId: ${t}`);try{if(console.log("[DEBUG] Loaded progress from localStorage:",r),Object.keys(r).length===0){console.log("[DEBUG] No saved progress found");return}const U=Object.keys(r).length;c(U),console.log(`[DEBUG] Restored ${U} answered questions`)}catch(U){console.error("[ERROR] Failed to load saved progress:",U),v(U.message)}},[e,t,r]),D=C.useCallback(()=>{console.log(`[DEBUG] getAnsweredQuestionsCountForPage called with testType: ${e}`);const U=Object.keys(r).length;return c(U),console.log(`[DEBUG] Found ${U} answered questions`),U},[e,r]),I=C.useCallback(()=>{console.log(`[DEBUG] saveProgressForPage called with testType: ${e}, testId: ${t}`);try{console.log("[DEBUG] Progress saved:",r)}catch(U){console.error("[ERROR] Failed to save progress:",U),v(U.message)}},[e,t,r]),G=C.useCallback(()=>{try{const U=`test_completed_${e}_${t}`,V=localStorage.getItem(U)==="true";return i(V),V}catch(U){return console.error("Error checking test completion:",U),!1}},[e,t]),Y=C.useCallback(()=>{try{const U=`test_completed_${e}_${t}`;localStorage.setItem(U,"true"),i(!0),console.log(`Test ${e}_${t} marked as completed`)}catch(U){console.error("Error marking test completed:",U)}},[e,t]),ee=C.useCallback(()=>{console.log("Marking test completed in UI:",{testType:e,testId:t}),Y()},[e,t,Y]),ie=C.useCallback(U=>{try{const V=`test_creation_state_${e}_${t}`;localStorage.setItem(V,JSON.stringify(U)),console.log("Test creation state saved:",U)}catch(V){console.error("Error saving test creation state:",V)}},[e,t]),re=C.useCallback(()=>{try{const U=`test_creation_state_${e}_${t}`;localStorage.removeItem(U),console.log("Test creation state cleared")}catch(U){console.error("Error clearing test creation state:",U)}},[e,t]),se=C.useCallback((U,V)=>{try{const q=`test_step_${e}_${t}_${U}`;localStorage.setItem(q,JSON.stringify(V)),console.log(`Step ${U} data saved:`,V)}catch(q){console.error(`Error saving step ${U} data:`,q)}},[e,t]),B=C.useCallback(U=>{try{const V=`test_step_${e}_${t}_${U}`,q=localStorage.getItem(V);return q?JSON.parse(q):null}catch(V){return console.error(`Error restoring step ${U} data:`,V),null}},[e,t]),z=C.useCallback(()=>{try{const U=`test_creation_state_${e}_${t}`,V=localStorage.getItem(U);return V?JSON.parse(V):null}catch(U){return console.error("Error restoring test creation state:",U),null}},[e,t]);return C.useEffect(()=>()=>{T()},[e,t,A,E,T]),C.useEffect(()=>{D()},[r,D]),{progress:r,isCompleted:a,answeredCount:l,totalQuestions:d,isLoading:p,error:y,saveProgress:N,getProgress:k,clearProgress:w,clearInterval:T,setupProgressTracking:A,updateProgress:F,updateSubmitButton:R,loadProgress:E,getAnsweredCount:D,saveProgressForPage:I,checkCompleted:G,markCompleted:Y,markCompletedUI:ee,saveState:ie,clearState:re,saveStepData:se,restoreStepData:B,restoreState:z,setTotalQuestions:f,setError:v}},LW=({testData:e,onTestComplete:t,onBackToCabinet:r})=>{const{user:n}=Hn(),{makeAuthenticatedRequest:s}=Xi(),[a,i]=C.useState({width:window.innerWidth,height:window.innerHeight});C.useEffect(()=>{const Ie=()=>{i({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",Ie),()=>window.removeEventListener("resize",Ie)},[]);const{getCheatingData:l,stopTracking:c,clearData:d}=Gp(),[f,p]=C.useState(null),[g,y]=C.useState({}),[v,_]=C.useState(null),b=C.useRef(null),[N,k]=C.useState(800),w={VERY_SMALL:400,MOBILE:600,TABLET:900},T={VERY_SMALL:.6,MOBILE:.8,TABLET:.9,DESKTOP:1},A={CANVAS_HEIGHT:400,BLOCK_WIDTH:140,BLOCK_HEIGHT:50,BLOCK_SPACING:100,MARGIN:50,PADDING:20},F=a.width<w.VERY_SMALL,R=a.width>=w.VERY_SMALL&&a.width<w.MOBILE,E=a.width>=w.MOBILE&&a.width<w.TABLET;a.width>=w.TABLET;const D=F?T.VERY_SMALL:R?T.MOBILE:E?T.TABLET:T.DESKTOP;C.useEffect(()=>{const Ie=()=>{if(b.current){const Qe=b.current.clientWidth;console.log(" Container width detected:",Qe),Qe>0&&k(Qe)}};Ie();const Pe=[setTimeout(Ie,50),setTimeout(Ie,100),setTimeout(Ie,200),setTimeout(Ie,500)];return window.addEventListener("resize",Ie),()=>{Pe.forEach(Qe=>clearTimeout(Qe)),window.removeEventListener("resize",Ie)}},[f]);const I=Math.max(A.CANVAS_HEIGHT*D,(f?.leftWords?.length||3)*A.BLOCK_SPACING*D+A.PADDING*2),G=A.BLOCK_WIDTH*D,Y=A.BLOCK_HEIGHT*D,ee=A.BLOCK_SPACING*D,ie=A.MARGIN*D,re=ie;console.log(" Mobile Debug:",{screenWidth:a.width,containerWidth:b.current?.clientWidth,canvasWidth:N,scale:D,blockWidth:G,margin:ie,leftBlockX:re,displayDataLoaded:!!f});const se=re+G+20+G+ie,B=se<=N;let z,U=G,V=Y;if(B)z=Math.min(Math.max(re+G+20,N-G-ie),N-G-ie);else{const Ie=N-ie*2,Pe=Math.floor((Ie-20)/2);U=Math.max(60,Pe),V=Math.max(30,V*(U/G)),z=re+U+20,console.log(" Very small screen - adjusted block size:",{availableWidth:Ie,maxBlockWidth:Pe,actualBlockWidth:U,actualBlockHeight:V})}console.log(" Right Block Position:",{rightBlockX:z,rightBlockRightEdge:z+U,canvasWidth:N,fits:z+U<=N,canFitSideBySide:B,minRequiredWidth:se});const q=ie,L={DRAGGED_WORD:Math.max(8,14*D),ORIGINAL_WORD:Math.max(10,16*D),LEFT_WORD:Math.max(10,14*D)},M=Math.max(1,3*D),[X,K]=C.useState([]),[Z,J]=C.useState(!1),[ne,me]=C.useState(null),[xe,Ne]=C.useState(!1),[le,ge]=C.useState(!1);C.useEffect(()=>{if(e&&(p(e),me(new Date),n?.student_id)){const Ie=`test_progress_${n.student_id}_word_matching_${e.id}`,Pe=Rn(Ie);Pe&&(y(Pe.answers||{}),K(Pe.arrows||[]),me(new Date(Pe.startTime)),console.log(" Test progress restored:",Pe))}},[e,n?.student_id]),C.useEffect(()=>{if(f&&ne&&n?.student_id){const Ie=setInterval(()=>{const Pe={answers:g,arrows:X,startTime:ne.toISOString()},Qe=`test_progress_${n.student_id}_word_matching_${e.id}`;Dn(Qe,Pe,Bn.test_progress),console.log(" Progress auto-saved")},3e4);return()=>clearInterval(Ie)}},[f,g,X,ne,n?.student_id,e?.id]);const Ue=C.useCallback((Ie,Pe)=>{if(e.interaction_type==="arrow")if(v){if(v.side===Ie&&v.index===Pe)_(null);else if(v.side!==Ie){const Qe={id:Date.now().toString(),startWord:v,endWord:{side:Ie,index:Pe},color:"#3B82F6"};K(_t=>[..._t,Qe]),y(_t=>({..._t,[v.index]:Pe})),_(null)}}else _({side:Ie,index:Pe})},[v,e?.interaction_type]);C.useCallback((Ie,Pe)=>{e.interaction_type==="drag"&&y(Qe=>({...Qe,[Ie]:Pe}))},[e?.interaction_type]);const Ge=C.useCallback(()=>{Ne(!0)},[]),Je=C.useCallback(()=>{y({}),K([]),_(null),Ne(!1)},[]),He=C.useCallback(()=>{ge(!0)},[]),Ft=C.useCallback(()=>{ge(!1),r&&r()},[r]),rt=C.useCallback(async()=>{if(f){J(!0);try{const Ie=f.leftWords.length;let Pe=0,Qe={};e.interaction_type==="drag"?Object.entries(g).forEach(([ct,mt])=>{const At=f.correctPairs[ct];mt===At&&Pe++,Qe[ct]=mt}):X.forEach(ct=>{const mt=ct.startWord.side==="left"?ct.startWord.index:ct.endWord.index,At=ct.startWord.side==="right"?ct.startWord.index:ct.endWord.index;f.correctPairs[mt]===At&&Pe++,Qe[mt]=At});const _t=Pe,gt=Ie;console.log(` Final Score: ${_t}/${gt} (${Math.round(_t/gt*100)}%)`);const Bt=new Date,Ut=ne?Math.round((Bt-ne)/1e3):0,it=ne?ne.toISOString():Bt.toISOString(),Ye=l(),xt=n.student_id,ut=`retest_assignment_id_${xt}_word_matching_${e.id}`,wt=localStorage.getItem(ut),$t={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:xt,parent_test_id:e.id,retest_assignment_id:wt?Number(wt):null,interaction_type:e.interaction_type,answers:Qe,score:_t,maxScore:gt,time_taken:Ut,started_at:it,submitted_at:Bt.toISOString(),caught_cheating:Ye.caught_cheating,visibility_change_times:Ye.visibility_change_times};console.log(" Submission data being sent:",$t),console.log(" TestData structure:",e),console.log(" Submitting test results...");const Kt=await s("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($t)});console.log(" Submission response received:",Kt.status);const De=await Kt.json();if(De.success){if(c(),d(),n?.student_id){const ct=`test_completed_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(ct,"true"),console.log(" Test marked as completed in localStorage:",ct);const mt=`retest1_${xt}_word_matching_${e.id}`;localStorage.removeItem(mt),localStorage.removeItem(ut),y0(n.student_id,"word_matching",e.id),console.log(" Test data cleared from cache");const At=`student_results_table_${n.student_id}`;Dn(At,De,Bn.student_results_table),console.log(" Test results cached with key:",At)}setTimeout(()=>{t&&t(_t)},2e3)}else throw new Error(De.message||"Failed to submit test")}catch(Ie){console.error("Error submitting test:",Ie)}finally{J(!1)}}},[f,g,X,e,n,ne,l,c,d,s,t]);return f?o.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-4xl mx-auto p-6",children:[o.jsx(Go,{isOpen:Z,onClose:()=>{},title:"Submitting",size:"small",children:o.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[o.jsx(Fr,{size:"lg",className:"mb-3"}),o.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Submitting test..."}),o.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your results"})]})}),o.jsx(bt,{className:"mb-6",children:o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:e.test_name}),o.jsx("p",{className:"text-gray-600",children:e.interaction_type==="drag"?"Drag words from left to right to match them":"Click on the word or phrase on the left, then click on the matching word or phrase on the right to connect them"})]})}),e.interaction_type==="drag"?o.jsx(bt,{className:"mb-6",children:o.jsx("div",{ref:b,className:"relative w-full",children:o.jsx(Zd,{width:N,height:I,className:`border-2 border-gray-200 rounded-lg ${Z?"pointer-events-none opacity-50":""}`,children:o.jsxs(Qd,{children:[f.leftWords.map((Ie,Pe)=>{const Qe=g[Pe]!==void 0,_t=q+Pe*ee;return o.jsxs(Ko,{x:re,y:_t,draggable:!Qe,onDragStart:gt=>{gt.target.moveToTop()},onDragEnd:gt=>{gt.target.getStage();const Bt=f.rightWords,Ut=U+60,it=V+30,Ye=z-30,xt=q-15;console.log(" Drop detection - Word dropped at:",gt.target.x(),gt.target.y());for(let ut=0;ut<Bt.length;ut++){const wt=xt+ut*ee,$t=Ye,Kt=Ye+Ut,De=wt,ct=wt+it;if(console.log(` Checking drop zone ${ut}:`,{left:$t,right:Kt,top:De,bottom:ct,word:Bt[ut]}),gt.target.x()>=$t&&gt.target.x()<=Kt&&gt.target.y()>=De&&gt.target.y()<=ct){console.log(` Match found! Word "${f.leftWords[Pe]}" matched with "${Bt[ut]}"`),y(mt=>({...mt,[Pe]:ut}));break}}console.log(" No match found, resetting position"),gt.target.position({x:re,y:_t})},children:[o.jsx(la,{width:U,height:V,fill:Qe?"#e5e7eb":"#3b82f6",stroke:Qe?"#9ca3af":"#1d4ed8",strokeWidth:2,cornerRadius:8,opacity:Qe?.5:1}),o.jsx(jl,{text:Ie,x:U/2,y:V/2,fontSize:L.LEFT_WORD,fontFamily:"Arial",fill:Qe?"#dc2626":"white",align:"center",verticalAlign:"middle",width:U,offsetX:U/2,offsetY:V/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${Pe}`)}),f.rightWords.map((Ie,Pe)=>{const Qe=q+Pe*ee,_t=Object.keys(g).find(gt=>g[gt]===Pe);return o.jsxs(Ko,{x:z,y:Qe,children:[o.jsx(la,{width:U,height:V,fill:_t?"#10b981":"#f3f4f6",stroke:_t?"#059669":"#d1d5db",strokeWidth:2,cornerRadius:8}),o.jsx(jl,{text:Ie,x:U/2,y:V/2,fontSize:L.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:U,offsetX:U/2,offsetY:V/2,wrap:"word",ellipsis:!0,listening:!1}),_t&&o.jsx(jl,{text:f.leftWords[_t],x:G/2,y:Y/4,fontSize:L.DRAGGED_WORD,fontFamily:"Arial",fill:"#dc2626",align:"center",verticalAlign:"middle",width:U,offsetX:U/2,offsetY:V/8,wrap:"word",ellipsis:!0})]},`right-${Pe}`)})]})})})}):o.jsx(bt,{className:"mb-6",children:o.jsx("div",{ref:b,className:"relative w-full",children:o.jsx(Zd,{width:N,height:I,className:`border-2 border-gray-200 rounded-lg ${Z?"pointer-events-none opacity-50":""}`,children:o.jsxs(Qd,{children:[f.leftWords.map((Ie,Pe)=>{const Qe=q+Pe*ee,_t=v?.side==="left"&&v?.index===Pe;return o.jsxs(Ko,{x:re,y:Qe,onClick:()=>Ue("left",Pe),children:[o.jsx(la,{width:U,height:V,fill:_t?"#3b82f6":"#f3f4f6",stroke:_t?"#1d4ed8":"#d1d5db",strokeWidth:_t?3:2,cornerRadius:8}),o.jsx(jl,{text:Ie,x:G/2,y:Y/2,fontSize:L.LEFT_WORD,fontFamily:"Arial",fill:_t?"white":"#374151",align:"center",verticalAlign:"middle",width:U,offsetX:U/2,offsetY:V/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${Pe}`)}),f.rightWords.map((Ie,Pe)=>{const Qe=q+Pe*ee,_t=v?.side==="right"&&v?.index===Pe;return o.jsxs(Ko,{x:z,y:Qe,onClick:()=>Ue("right",Pe),children:[o.jsx(la,{width:U,height:V,fill:_t?"#3b82f6":"#f3f4f6",stroke:_t?"#1d4ed8":"#d1d5db",strokeWidth:_t?3:2,cornerRadius:8}),o.jsx(jl,{text:Ie,x:G/2,y:Y/2,fontSize:L.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:U,offsetX:U/2,offsetY:V/2,wrap:"word",ellipsis:!0,listening:!1})]},`right-${Pe}`)}),X.map((Ie,Pe)=>{const Qe=q+Ie.startWord.index*ee+Y/2,_t=q+Ie.endWord.index*ee+Y/2;return o.jsx(Sa,{points:[re+G+20,Qe,z-20,_t],stroke:Ie.color||"#3b82f6",strokeWidth:M,lineCap:"round",lineJoin:"round"},Pe)})]})})})}),o.jsx(bt,{children:o.jsxs("div",{className:`submit-section flex justify-center space-x-4 ${Z?"pointer-events-none opacity-50":""}`,children:[o.jsx(et,{onClick:Ge,variant:"outline",disabled:Z,children:"Reset"}),o.jsx(et,{onClick:He,variant:"outline",disabled:Z,children:"Back to Cabinet"}),o.jsx(et,{onClick:rt,disabled:Z,className:"px-8",children:Z?o.jsxs(o.Fragment,{children:[o.jsx(Fr,{size:"sm",color:"white",className:"mr-2"}),"Submitting..."]}):"Submit Test"})]})}),o.jsx(Go,{isOpen:xe&&!Z,onClose:()=>Ne(!1),title:"Reset Test",size:"small",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and answers."}),o.jsxs("div",{className:"flex gap-3 justify-center",children:[o.jsx(et,{onClick:()=>Ne(!1),variant:"secondary",children:"Cancel"}),o.jsx(et,{onClick:Je,variant:"primary",children:"Reset"})]})]})}),o.jsx(Go,{isOpen:le&&!Z,onClose:()=>ge(!1),title:"Exit Test",size:"small",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to leave the test? Your progress will be saved."}),o.jsxs("div",{className:"flex gap-3 justify-center",children:[o.jsx(et,{onClick:()=>ge(!1),variant:"secondary",children:"Cancel"}),o.jsx(et,{onClick:Ft,variant:"primary",children:"Leave"})]})]})})]}):o.jsx("div",{className:"flex justify-center items-center min-h-screen",children:o.jsx(Fr,{size:"lg"})})},BW=({id:e,x:t,y:r,width:n,height:s,text:a,fontSize:i,color:l,isSelected:c,onSelect:d,onUpdate:f,onDelete:p})=>{const g=v=>{v.cancelBubble=!0,f(e,{isEditing:!0})},y=v=>{f(e,{x:v.target.x(),y:v.target.y()})};return o.jsxs(Ko,{x:t,y:r,draggable:!0,onClick:v=>{v.cancelBubble=!0,d(e)},onDblClick:g,onDragEnd:y,children:[o.jsx(la,{width:n,height:s,fill:c?"#fef3c7":"#ffffff",stroke:c?"#f59e0b":"#d1d5db",strokeWidth:c?2:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}}),o.jsx(jl,{text:a,width:n,height:s,padding:8,align:"left",verticalAlign:"top",fontSize:i,fill:l,wrap:"word"})]})},UW=({x:e,y:t,width:r,height:n,initialText:s,onSave:a,onCancel:i})=>{const l=C.useRef(null);C.useEffect(()=>{l.current&&(l.current.focus(),l.current.select())},[]);const c=d=>{d.key==="Enter"&&!d.shiftKey?(d.preventDefault(),a(l.current.value)):d.key==="Escape"&&i()};return o.jsx("textarea",{ref:l,defaultValue:s,style:{position:"absolute",top:t,left:e,width:r,height:n,fontSize:"14px",border:"2px solid #f59e0b",borderRadius:"6px",padding:"8px",background:"white",resize:"none",outline:"none",fontFamily:"inherit",lineHeight:"1.4",zIndex:1e3},onKeyDown:c,onBlur:()=>a(l.current.value)})},$W=({width:e,height:t,lines:r,onDrawingChange:n,currentTool:s,currentColor:a,currentThickness:i,zoom:l,onZoomChange:c,isPanning:d,isFullscreen:f,constrainPanPosition:p,handleWheel:g,stageRef:y,setIsPanning:v,responsiveDimensions:_,canvasSize:b,question:N,textBoxes:k,setTextBoxes:w,selectedTextBox:T,setSelectedTextBox:A,handleTextBoxSelect:F,handleTextBoxUpdate:R,handleTextBoxDelete:E,isEditingText:D,editingTextBox:I,setIsEditingText:G,setEditingTextBox:Y,setCurrentTool:ee})=>{const[ie,re]=C.useState(!1),[se,B]=C.useState([]),[z,U]=C.useState(null),[V,q]=C.useState(null),L=C.useRef(null),[M,X]=C.useState(.25),[K,Z]=C.useState({x:0,y:0});C.useEffect(()=>{const fe=()=>{const _e=L.current;if(!_e)return;const $e=_e.clientWidth||1,St=_e.clientHeight||1,pt=Math.min($e/(b.width||1),St/(b.height||1));X(Math.min(pt,1))};return fe(),window.addEventListener("resize",fe),()=>window.removeEventListener("resize",fe)},[b.width,b.height,f]);const J=fe=>{const _e=y.current,$e=_e.getPointerPosition();if(s==="pan")return;if(s==="text"){const pt={x:($e.x-_e.x())/_e.scaleX(),y:($e.y-_e.y())/_e.scaleY()},Xt={id:Date.now(),x:pt.x,y:pt.y,width:150,height:60,text:"Double-click to edit",fontSize:14,color:"#000000"};w(Jt=>[...Jt,Xt]),A(Xt.id),ee("pan");return}re(!0);const St={x:($e.x-_e.x())/_e.scaleX(),y:($e.y-_e.y())/_e.scaleY()};q(St),s==="pencil"?B([{x:St.x,y:St.y,color:a,thickness:i}]):s==="eraser"?B([{x:St.x,y:St.y,color:a,thickness:i,tool:"eraser"}]):["line","rectangle","circle"].includes(s)&&U({type:s,startX:St.x,startY:St.y,endX:St.x,endY:St.y,color:a,thickness:i})},ne=fe=>{const _e=y.current,$e=_e.getPointerPosition(),St={x:($e.x-_e.x())/_e.scaleX(),y:($e.y-_e.y())/_e.scaleY()};if(Z(St),s!=="pan"&&ie)if(s==="pencil"){const pt=[...se,{x:St.x,y:St.y,color:a,thickness:i}];B(pt)}else if(s==="eraser"){const pt=[...se,{x:St.x,y:St.y,color:a,thickness:i,tool:"eraser"}];B(pt)}else["line","rectangle","circle"].includes(s)&&z&&U({...z,endX:St.x,endY:St.y})},me=()=>{if(s!=="pan"&&ie){if(s==="pencil"){const fe=[...r,se];n(fe),B([])}else if(s==="eraser"){const fe=[...r,se];n(fe),B([])}else if(["line","rectangle","circle"].includes(s)&&z){const fe=[...r,z];n(fe),U(null)}re(!1),q(null)}},[xe,Ne]=C.useState(null),[le,ge]=C.useState(null),[Ue,Ge]=C.useState(!1),[Je,He]=C.useState(null),[Ft,rt]=C.useState(!1),[Ie,Pe]=C.useState(!1),[Qe,_t]=C.useState([]),[gt,Bt]=C.useState(null),[Ut,it]=C.useState({totalGestures:0,zoomGestures:0,panGestures:0,combinedGestures:0,averageResponseTime:0});let Ye=null;const ut=(window.devicePixelRatio||1)>1.5,wt={scaleDelta:ut?.03:.04,centerDelta:ut?4:6,minTouchDistance:8,gestureHysteresis:.02},$t=()=>{rt(!1),He(null),Ne(null),ge(null),re(!1),q(null),Pe(!1),Bt(null),Ye&&(cancelAnimationFrame(Ye),Ye=null),y.current&&y.current.stop()},Kt=fe=>{if(fe.length<2)return 0;const _e=fe[0],$e=fe[1];return Math.sqrt(Math.pow($e.clientX-_e.clientX,2)+Math.pow($e.clientY-_e.clientY,2))},De=fe=>{if(fe.length<2)return null;const _e=fe[0],$e=fe[1];return{x:(_e.clientX+$e.clientX)/2,y:(_e.clientY+$e.clientY)/2}},ct=fe=>{_t(_e=>[..._e,{type:fe,timestamp:Date.now()}].slice(-5))},mt=()=>{const fe=Date.now(),_e=Qe.filter(pt=>fe-pt.timestamp<500);if(_e.length<2)return 0;const $e=_e[_e.length-1],St=_e[_e.length-2];return $e.type===St.type?wt.gestureHysteresis:0},At=(fe,_e)=>{it($e=>({totalGestures:$e.totalGestures+1,zoomGestures:fe.includes("zoom")?$e.zoomGestures+1:$e.zoomGestures,panGestures:fe.includes("pan")?$e.panGestures+1:$e.panGestures,combinedGestures:fe==="zoom+pan"?$e.combinedGestures+1:$e.combinedGestures,averageResponseTime:($e.averageResponseTime+_e)/2}))},Lt=(fe,_e,$e,St)=>{const pt=y.current,Xt=pt.scaleX(),Jt=pt.position();let Yt=Xt,pr=Jt;if(fe){const Tr=$e/xe,Mr=Xt*Tr,Wr=N?.max_canvas_width||1536,ce=N?.max_canvas_height||2048,Se=Wr/b.width,pe=ce/b.height,ve=Math.min(Se,pe,1);Yt=Math.max(.25,Math.min(ve,Mr));const be=St,ke={x:(be.x-pt.x())/Xt,y:(be.y-pt.y())/Xt};pr={x:be.x-ke.x*Yt,y:be.y-ke.y*Yt}}if(_e){const Tr=St.x-le.x,Mr=St.y-le.y;fe?pr={x:pr.x+Tr,y:pr.y+Mr}:pr={x:Jt.x+Tr,y:Jt.y+Mr}}Ye||(Ye=requestAnimationFrame(()=>{pt.scale({x:Yt,y:Yt}),pt.position(pr),pt.batchDraw(),Ye=null})),fe&&_e?(He("zoom+pan"),Pe(!0)):fe?(He("zoom"),Pe(!0)):_e&&He("pan");const xr=Date.now()-(gt||Date.now());At(fe&&_e?"zoom+pan":fe?"zoom":"pan",xr),console.log(" Combined gesture",{doZoom:fe,doPan:_e,scale:Yt.toFixed(2),pos:pr})},rr=fe=>{const _e=fe.evt.touches;_e.length===2?(fe.evt.preventDefault(),rt(!0),He(null),Ne(Kt(_e)),ge(De(_e)),re(!1),Bt(Date.now())):_e.length===1&&(rt(!1),He(null),J())},Ee=fe=>{const _e=fe.evt.touches;if(_e.length===2&&Ft){fe.evt.preventDefault();const $e=y.current,St=Kt(_e),pt=De(_e);if(xe&&le&&$e&&St>wt.minTouchDistance){const Xt=Math.abs(St/xe-1),Jt=Math.sqrt(Math.pow(pt.x-le.x,2)+Math.pow(pt.y-le.y,2)),Yt=mt(),pr=wt.scaleDelta-Yt,Ir=wt.centerDelta-Yt*10,xr=Xt>pr,Tr=Jt>Ir;(xr||Tr)&&(Lt(xr,Tr,St,pt),xr&&Tr?ct("zoom+pan"):xr?ct("zoom"):Tr&&ct("pan")),console.log(" Gesture Debug",{scaleDelta:Xt.toFixed(3),centerDelta:Jt.toFixed(1),doZoom:xr,doPan:Tr,hysteresis:Yt.toFixed(3),adjustedScaleDelta:pr.toFixed(3),adjustedCenterDelta:Ir.toFixed(1),gestureHistory:Qe.slice(-3)})}Ne(St),ge(pt)}else _e.length===1&&!Ft&&(fe.evt.preventDefault(),ne())},we=fe=>{const _e=fe.evt.touches;_e.length===0?(me(),$t(),Pe(!1)):_e.length===1&&(rt(!1),He(null),Ne(null),ge(null),Pe(!1))};return o.jsx("div",{className:"relative w-full block sm:flex sm:justify-center",children:o.jsx("div",{className:"w-full max-w-full block sm:flex sm:justify-center",children:o.jsxs("div",{className:"relative",style:{border:f&&(_.width<window.innerWidth-40||_.height<window.innerHeight-40)?"2px solid #000000":"none",borderRadius:"8px",overflow:"hidden"},children:[o.jsx("div",{ref:L,className:"w-full h-full",children:o.jsx(Zd,{ref:y,width:_.width,height:_.height,scaleX:f?_.zoom:l,scaleY:f?_.zoom:l,onMouseDown:J,onMousemove:ne,onMouseup:me,onTouchStart:rr,onTouchMove:Ee,onTouchEnd:we,onWheel:g||(()=>{}),onDragStart:()=>{console.log(" Drag started"),s==="pan"&&v(!0)},onDragEnd:()=>{if(console.log(" Drag ended"),s==="pan"&&(v(!1),p)){const fe=y.current,_e=L.current,$e=_e?.clientWidth||_.width,St=_e?.clientHeight||_.height,pt=b.width*fe.scaleX(),Xt=b.height*fe.scaleY(),Jt=fe.x(),Yt=fe.y();(Jt>$e||Jt<-pt||Yt>St||Yt<-Xt)&&p(fe)}},draggable:s==="pan"&&l>.25,className:`border-0 rounded-none shadow-none sm:border sm:rounded-lg sm:shadow-sm ${s==="pan"?"cursor-grab":d?"cursor-grabbing":"cursor-crosshair"}`,style:{width:"100%",height:"auto"},onLoad:()=>{console.log(" DrawingTestStudent - Stage loaded with dimensions:",_.width,"x",_.height),console.log(" DrawingTestStudent - Canvas size:",b.width,"x",b.height),console.log(" DrawingTestStudent - Current zoom level:",l),console.log(" DrawingTestStudent - Effective display size:",Math.round(b.width*l),"x",Math.round(b.height*l)),console.log(" DrawingTestStudent - Total pixels displayed:",Math.round(b.width*l*b.height*l))},children:o.jsxs(Qd,{children:[o.jsx(la,{x:0,y:0,width:b.width,height:b.height,fill:"white"}),r.map((fe,_e)=>{if(Array.isArray(fe)){const $e=fe[0]?.tool==="eraser";return o.jsx(Sa,{points:fe.flatMap(St=>[St.x,St.y]),stroke:$e?"black":fe[0]?.color||"#000000",strokeWidth:$e?(fe[0]?.thickness||2)*7:fe[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:$e?"destination-out":"source-over"},_e)}else{if(fe.type==="line")return o.jsx(Sa,{points:[fe.startX,fe.startY,fe.endX,fe.endY],stroke:fe.color,strokeWidth:fe.thickness,lineCap:"round"},_e);if(fe.type==="rectangle"){const $e=Math.abs(fe.endX-fe.startX),St=Math.abs(fe.endY-fe.startY),pt=Math.min(fe.startX,fe.endX),Xt=Math.min(fe.startY,fe.endY);return o.jsx(la,{x:pt,y:Xt,width:$e,height:St,stroke:fe.color,strokeWidth:fe.thickness,fill:"transparent"},_e)}else if(fe.type==="circle"){const $e=Math.sqrt(Math.pow(fe.endX-fe.startX,2)+Math.pow(fe.endY-fe.startY,2))/2,St=(fe.startX+fe.endX)/2,pt=(fe.startY+fe.endY)/2;return o.jsx(Ru,{x:St,y:pt,radius:$e,stroke:fe.color,strokeWidth:fe.thickness,fill:"transparent"},_e)}}return null}),k.map(fe=>o.jsx(BW,{...fe,isSelected:T===fe.id,onSelect:F,onUpdate:R,onDelete:E},fe.id)),s==="pencil"&&o.jsx(Sa,{points:se.flatMap(fe=>[fe.x,fe.y]),stroke:a,strokeWidth:i,tension:.5,lineCap:"round",lineJoin:"round"}),s==="eraser"&&o.jsx(Sa,{points:se.flatMap(fe=>[fe.x,fe.y]),stroke:"black",strokeWidth:i*7,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:"destination-out"}),z&&z.type==="line"&&o.jsx(Sa,{points:[z.startX,z.startY,z.endX,z.endY],stroke:z.color,strokeWidth:z.thickness,lineCap:"round"}),z&&z.type==="rectangle"&&o.jsx(la,{x:Math.min(z.startX,z.endX),y:Math.min(z.startY,z.endY),width:Math.abs(z.endX-z.startX),height:Math.abs(z.endY-z.startY),stroke:z.color,strokeWidth:z.thickness,fill:"transparent"}),z&&z.type==="circle"&&o.jsx(Ru,{x:(z.startX+z.endX)/2,y:(z.startY+z.endY)/2,radius:Math.sqrt(Math.pow(z.endX-z.startX,2)+Math.pow(z.endY-z.startY,2))/2,stroke:z.color,strokeWidth:z.thickness,fill:"transparent"}),s==="eraser"&&o.jsx(Ru,{x:K.x,y:K.y,radius:i*7/2,stroke:"#666666",strokeWidth:2,fill:"rgba(102, 102, 102, 0.2)",dash:[5,5],listening:!1}),s==="pencil"&&o.jsx(Sa,{points:[K.x-10,K.y,K.x+10,K.y,K.x,K.y-10,K.x,K.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="line"&&o.jsx(Sa,{points:[K.x-10,K.y,K.x+10,K.y,K.x,K.y-10,K.x,K.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="rectangle"&&o.jsx(Sa,{points:[K.x-10,K.y,K.x+10,K.y,K.x,K.y-10,K.x,K.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="circle"&&o.jsx(Sa,{points:[K.x-10,K.y,K.x+10,K.y,K.x,K.y-10,K.x,K.y+10],stroke:"#666666",strokeWidth:1,listening:!1})]})})}),D&&I&&o.jsx(UW,{x:I.x,y:I.y,width:I.width,height:I.height,initialText:I.text,onSave:fe=>{R(I.id,{text:fe}),G(!1),Y(null)},onCancel:()=>{G(!1),Y(null)}}),o.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1",children:[o.jsx("button",{onClick:()=>{const fe=y.current,_e=fe.scaleX(),$e=N?.max_canvas_width||1536,St=N?.max_canvas_height||2048,pt=$e/b.width,Xt=St/b.height,Jt=Math.min(pt,Xt,5),Yt=Math.min(Jt,fe.scaleX()*1.2);fe.scale({x:Yt,y:Yt}),fe.batchDraw(),console.log(" DrawingTestStudent - Zoom In button:",_e.toFixed(2),"->",Yt.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(b.width*Yt),"x",Math.round(b.height*Yt)),console.log(" DrawingTestStudent - New resolution:",Math.round(b.width*Yt*b.height*Yt),"pixels"),c(Yt)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom In",children:"+"}),o.jsx("button",{onClick:()=>{const fe=y.current,_e=fe.scaleX(),$e=Math.max(.25,fe.scaleX()*.8);fe.scale({x:$e,y:$e}),fe.batchDraw(),console.log(" DrawingTestStudent - Zoom Out button:",_e.toFixed(2),"->",$e.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(b.width*$e),"x",Math.round(b.height*$e)),console.log(" DrawingTestStudent - New resolution:",Math.round(b.width*$e*b.height*$e),"pixels"),c($e)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom Out",children:""}),o.jsx("button",{onClick:()=>{const fe=y.current,_e=fe.scaleX();fe.scale({x:1,y:1}),fe.position({x:0,y:0}),fe.batchDraw(),console.log(" DrawingTestStudent - Reset zoom:",_e.toFixed(2),"-> 1.00"),console.log(" DrawingTestStudent - Reset effective size:",b.width,"x",b.height),console.log(" DrawingTestStudent - Reset resolution:",b.width*b.height,"pixels"),c(1)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 text-xs",title:"Reset Zoom",children:"1:1"})]}),o.jsxs("div",{className:"absolute bottom-2 left-2 bg-white border border-gray-300 rounded px-2 py-1 text-xs text-gray-600 shadow-sm",children:[Math.round(l*100),"%"]})]})})})},WW=({content:e})=>{if(!e)return o.jsx("div",{className:"text-gray-500 italic",children:"No instructions provided"});const t=n=>{if(!n)return"";if(n.type==="text"){let s=n.text||"";if(n.format&&(n.format&1&&(s=`<strong>${s}</strong>`),n.format&2&&(s=`<em>${s}</em>`),n.format&8&&(s=`<u>${s}</u>`),n.format&16&&(s=`<s>${s}</s>`)),n.style){const a=n.style.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}if(n.textStyle){const a=n.textStyle.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}return s}if(n.type==="paragraph"){const s=n.children?n.children.map(t).join(""):"";let a="text-left";return n.format&&(n.format==="center"?a="text-center":n.format==="right"?a="text-right":n.format==="left"&&(a="text-left")),`<p class="${a}">${s}</p>`}if(n.type==="heading"){const s=n.tag||"h1",a=n.children?n.children.map(t).join(""):"";return`<${s}>${a}</${s}>`}if(n.type==="list"){const s=n.listType==="bullet"?"ul":"ol",a=n.children?n.children.map(i=>{if(i.type==="listitem"){const l=i.children?i.children.map(t).join(""):"";let c="margin: 4px 0; display: list-item;";return i.format&&(i.format==="center"?c+=" text-align: center;":i.format==="right"?c+=" text-align: right;":i.format==="left"&&(c+=" text-align: left;")),`<li style="${c}">${l}</li>`}return""}).join(""):"";return`<${s} style="margin: 8px 0; padding-left: 20px; list-style-type: ${n.listType==="bullet"?"disc":"decimal"}; display: block;">${a}</${s}>`}return n.children?n.children.map(t).join(""):""};let r=e;if(typeof e=="string"&&e.startsWith("{"))try{const n=JSON.parse(e);n.text?r=n.text:n.content?r=n.content:n.root&&n.root.children&&(r=n.root.children.map(t).join(""))}catch(n){console.log("Failed to parse Lexical content:",n)}return o.jsx("div",{className:"max-w-none rich-text-content",style:{lineHeight:"1.6",fontSize:"14px"},dangerouslySetInnerHTML:{__html:r}})},zW=({question:e,questionIndex:t,studentAnswer:r,onAnswerChange:n,mode:s,testId:a,testType:i})=>{ja();const[l,c]=C.useState([]),[d,f]=C.useState(!0),[p,g]=C.useState("pencil"),[y,v]=C.useState("#000000"),[_,b]=C.useState(2),[N,k]=C.useState([]),[w,T]=C.useState(-1),[A,F]=C.useState({width:600,height:800}),[R,E]=C.useState(1),[D,I]=C.useState(!1),[G,Y]=C.useState(!1),[ee,ie]=C.useState(!1),[re,se]=C.useState([]),[B,z]=C.useState(null),[U,V]=C.useState(!1),[q,L]=C.useState(null),M=w>0,X=w<N.length-1,[K,Z]=C.useState(!1),J=C.useRef(null),ne=C.useRef(null),[me,xe]=C.useState({width:600,height:800}),Ne=C.useRef(!1),[le,ge]=C.useState(.25),Ue=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#008000","#808080","#FFC0CB","#A52A2A","#000080"];C.useEffect(()=>{const it=()=>{ie(window.innerWidth>=1024)};return it(),window.addEventListener("resize",it),()=>window.removeEventListener("resize",it)},[]),C.useEffect(()=>{if(e){const it=e.max_canvas_width||1536,Ye=e.max_canvas_height||2048,xt=e.canvas_width||600,ut=e.canvas_height||800;if(F({width:it,height:Ye}),Ne.current)console.log(" DrawingTestStudent - Preserving user zoom:",R.toFixed(2));else{E(1),Ne.current=!0;const $t=(xt-it*1)/2,Kt=(ut-Ye*1)/2;if(!isNaN($t)&&!isNaN(Kt)&&J.current){const De={x:$t,y:Kt};J.current.position(De),J.current.batchDraw()}console.log(" DrawingTestStudent - Canvas size set:",it,"x",Ye),console.log(" DrawingTestStudent - Viewport size:",xt,"x",ut),console.log(" DrawingTestStudent - Initial zoom:",1 .toFixed(2)),console.log(" DrawingTestStudent - Image resolution:",it*Ye,"pixels"),console.log(" DrawingTestStudent - Aspect ratio:",(it/Ye).toFixed(2))}if(r&&typeof r=="string")try{const wt=JSON.parse(r);wt.lines?c(wt.lines):c(wt),wt.textBoxes&&se(wt.textBoxes)}catch{console.log("No valid drawing data found")}f(!1)}},[e,r]),C.useEffect(()=>{const it=()=>{const Ye=ne.current;if(!Ye)return;const xt=Ye.clientWidth||1,ut=Ye.clientHeight||1,wt=Math.min(xt/(A.width||1),ut/(A.height||1));ge(Math.min(wt,1))};return it(),window.addEventListener("resize",it),()=>window.removeEventListener("resize",it)},[A.width,A.height,K]);const Ge=it=>{c(it);const Ye={lines:it,textBoxes:re};n(e.question_id,JSON.stringify(Ye)),Je(it,re)},Je=(it,Ye=re)=>{const xt=N.slice(0,w+1);xt.push({lines:[...it],textBoxes:[...Ye]}),k(xt),T(xt.length-1)},He=()=>{if(M){const it=w-1,Ye=N[it];if(Ye&&typeof Ye=="object"&&Ye.lines){c([...Ye.lines]),se([...Ye.textBoxes]);const xt={lines:Ye.lines,textBoxes:Ye.textBoxes};n(e.question_id,JSON.stringify(xt))}else{const xt=Ye||[];c([...xt]),n(e.question_id,JSON.stringify(xt))}T(it)}},Ft=()=>{if(X){const it=w+1,Ye=N[it];if(Ye&&typeof Ye=="object"&&Ye.lines){c([...Ye.lines]),se([...Ye.textBoxes]);const xt={lines:Ye.lines,textBoxes:Ye.textBoxes};n(e.question_id,JSON.stringify(xt))}else{const xt=Ye||[];c([...xt]),n(e.question_id,JSON.stringify(xt))}T(it)}},rt=()=>{c([]),se([]),z(null),n(e.question_id,"")},Ie=it=>{z(it)},Pe=(it,Ye)=>{const xt=re.map(wt=>wt.id===it?{...wt,...Ye}:wt);se(xt),Je(l,xt);const ut={lines:l,textBoxes:xt};if(n(e.question_id,JSON.stringify(ut)),Ye.isEditing){const wt=re.find($t=>$t.id===it);L(wt),V(!0)}},Qe=it=>{const Ye=re.filter(ut=>ut.id!==it);se(Ye),B===it&&z(null),Je(l,Ye);const xt={lines:l,textBoxes:Ye};n(e.question_id,JSON.stringify(xt))},_t=()=>{if(K){const xt=e?.canvas_width||600,ut=e?.canvas_height||800,wt=window.innerWidth-40,$t=window.innerHeight-40,Kt=wt/xt,De=$t/ut,ct=Math.min(Kt,De,1);return{width:xt,height:ut,zoom:ct}}const it=e?.canvas_width||600,Ye=e?.canvas_height||800;return{width:it,height:Ye,zoom:1}};C.useEffect(()=>{const it=()=>{xe(_t())};return it(),window.addEventListener("resize",it),()=>window.removeEventListener("resize",it)},[K,A]);const gt=it=>{it.evt.preventDefault();const Ye=J.current,xt=Ye.scaleX(),ut=Ye.getPointerPosition(),wt={x:(ut.x-Ye.x())/xt,y:(ut.y-Ye.y())/xt},$t=it.evt.deltaY>0?xt*.9:xt*1.1,Kt=e?.max_canvas_width||1536,De=e?.max_canvas_height||2048,ct=Kt/A.width,mt=De/A.height,At=Math.min(ct,mt,1),Lt=Math.max(le,Math.min(At,$t)),rr={x:ut.x-wt.x*Lt,y:ut.y-wt.y*Lt};if(Lt<=le&&ne.current){const Ee=ne.current.clientWidth||1,we=ne.current.clientHeight||1;rr.x=(Ee-A.width*Lt)/2,rr.y=(we-A.height*Lt)/2}Ye.scale({x:Lt,y:Lt}),Ye.position(rr),Ye.batchDraw(),console.log(" DrawingTestStudent - Wheel zoom:",xt.toFixed(2),"->",Lt.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(A.width*Lt),"x",Math.round(A.height*Lt)),console.log(" DrawingTestStudent - New resolution:",Math.round(A.width*Lt*A.height*Lt),"pixels"),E(Lt),Ne.current=!0},Bt=it=>{const Ye=it.scaleX(),xt=ne.current,ut=xt?.clientWidth||me.width,wt=xt?.clientHeight||me.height,$t=A.width*Ye,Kt=A.height*Ye;if(Ye<=le){const fe=(ut-$t)/2,_e=(wt-Kt)/2;it.position({x:fe,y:_e}),it.batchDraw();return}if($t<=ut&&Kt<=wt){const fe=(ut-$t)/2,_e=(wt-Kt)/2;it.position({x:fe,y:_e}),it.batchDraw();return}const De=Math.max(0,$t-ut),ct=Math.max(0,Kt-wt),mt=-De,At=-ct,Lt=it.x(),rr=it.y(),Ee=Math.max(mt,Math.min(De,Lt)),we=Math.max(At,Math.min(ct,rr));(Ee!==Lt||we!==rr)&&(it.position({x:Ee,y:we}),it.batchDraw())},Ut=()=>{if(K)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();else{const it=document.querySelector(".drawing-canvas-container");it&&(it.requestFullscreen?it.requestFullscreen():it.webkitRequestFullscreen?it.webkitRequestFullscreen():it.msRequestFullscreen&&it.msRequestFullscreen())}};return C.useEffect(()=>{const it=()=>{Z(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",it),document.addEventListener("webkitfullscreenchange",it),document.addEventListener("msfullscreenchange",it),()=>{document.removeEventListener("fullscreenchange",it),document.removeEventListener("webkitfullscreenchange",it),document.removeEventListener("msfullscreenchange",it)}},[]),C.useEffect(()=>()=>{J.current&&J.current.stop()},[]),d?o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsx(Fr,{})}):e?o.jsxs("div",{className:`drawing-question w-full max-w-full mx-0 p-0 sm:p-2 ${K?"fixed inset-0 z-50 bg-white overflow-y-auto":""}`,children:[!K&&o.jsx("div",{className:"mb-4",children:o.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",t+1]})}),!K&&e.question_json&&e.question_json.trim()&&o.jsxs("div",{className:"mb-2 p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[o.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Task:"}),o.jsx("div",{className:"text-gray-700",children:o.jsx(WW,{content:e.question_json})})]}),!K&&o.jsx(bt,{className:"p-1 sm:p-2 mb-2",children:o.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-wrap",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{className:"hidden sm:block text-sm text-gray-700",children:"Tool:"}),o.jsxs("div",{className:"flex flex-nowrap sm:flex-wrap gap-1 overflow-x-auto",children:[o.jsx("button",{onClick:()=>g("pencil"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="pencil"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pencil (Freehand drawing)",children:""}),o.jsx("button",{onClick:()=>g("line"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="line"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Line",children:""}),o.jsx("button",{onClick:()=>g("rectangle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="rectangle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Rectangle",children:""}),o.jsx("button",{onClick:()=>g("circle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="circle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Circle",children:""}),o.jsx("button",{onClick:()=>g("eraser"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="eraser"?"bg-red-500 text-white border-red-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Eraser",children:""}),o.jsx("button",{onClick:()=>g("text"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="text"?"bg-green-500 text-white border-green-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Text Box",children:""}),o.jsx("button",{onClick:()=>g("pan"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="pan"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pan (Move canvas)",children:""})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{className:"text-sm text-gray-700",children:"History:"}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:He,disabled:!M,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${M?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Undo (Ctrl+Z)",children:""}),o.jsx("button",{onClick:Ft,disabled:!X,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${X?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Redo (Ctrl+Y)",children:""})]})]}),o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>I(!D),className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 sm:py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[o.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:y}}),o.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:"Color"})]}),D&&o.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-white border border-gray-300 rounded-lg shadow-lg z-30 min-w-max",children:o.jsx("div",{className:"flex flex-wrap gap-2 max-w-xs",children:Ue.map(it=>o.jsx("button",{onClick:()=>{v(it),I(!1)},className:`w-10 h-10 rounded border-2 hover:scale-110 transition-transform flex-shrink-0 ${y===it?"border-gray-800":"border-gray-300"}`,style:{backgroundColor:it},title:it},it))})})]}),o.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[o.jsx("label",{className:"text-xs sm:text-sm text-gray-700",children:"Thickness:"}),o.jsx("input",{type:"range",min:"1",max:"10",value:_,onChange:it=>b(parseInt(it.target.value)),className:"w-16 sm:w-20"}),o.jsxs("span",{className:"text-xs text-gray-500 w-6 sm:w-8",children:[_,"px"]})]}),o.jsx(et,{onClick:rt,variant:"secondary",size:"sm",children:"Clear"})]})}),o.jsx(bt,{paddingClass:"p-0 sm:p-2",children:o.jsxs("div",{className:"w-full drawing-canvas-container relative p-0 m-0",children:[o.jsx($W,{width:A.width,height:A.height,lines:l,onDrawingChange:Ge,currentTool:p,currentColor:y,currentThickness:_,zoom:R,onZoomChange:E,isPanning:G,isFullscreen:K,constrainPanPosition:Bt,handleWheel:gt,stageRef:J,setIsPanning:Y,responsiveDimensions:me,canvasSize:A,question:e,textBoxes:re,setTextBoxes:se,selectedTextBox:B,setSelectedTextBox:z,handleTextBoxSelect:Ie,handleTextBoxUpdate:Pe,handleTextBoxDelete:Qe,isEditingText:U,editingTextBox:q,setIsEditingText:V,setEditingTextBox:L,setCurrentTool:g}),o.jsx("button",{onClick:Ut,className:"absolute top-2 left-2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white p-2 rounded-lg transition-all duration-200 z-10",title:K?"Exit Fullscreen":"Enter Fullscreen",children:K?o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})}):o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]})})]}):o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsx("div",{className:"text-center",children:o.jsx("p",{className:"text-gray-500",children:"No drawing question data available"})})})},Bw={enhanceUserData(e,t){const r={id:e.id||e.student_id||e.teacher_id,username:e.username||e.student_id,name:e.name||e.first_name,surname:e.surname||e.last_name,nickname:e.nickname,role:t,is_active:e.is_active!==void 0?e.is_active:!0,created_at:e.created_at,updated_at:e.updated_at};switch(t){case"student":return{...r,student_id:e.student_id,grade:e.grade,class:e.class,number:e.number,subjects:e.subjects||[]};case"teacher":return{...r,teacher_id:e.teacher_id,first_name:e.first_name,last_name:e.last_name,email:e.email,phone:e.phone,subjects:e.subjects||[]};case"admin":return{...r,admin_id:e.admin_id,permissions:e.permissions||["all"]};default:return r}},async studentLogin(e){console.log("Trying student login...");try{const t=await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:e.username,password:e.password})}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.student,role:"student",response:t};throw new Error(r.message||"Student login failed")}catch(t){throw console.error("Student login error:",t),new Error(t.message||"Student login failed")}},async teacherLogin(e){console.log("Trying teacher login...");try{const t=await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.teacher,role:"teacher",response:t};throw new Error(r.message||"Teacher login failed")}catch(t){throw console.error("Teacher login error:",t),new Error(t.message||"Teacher login failed")}},async adminLogin(e){console.log("Trying admin login...");try{const t=await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.admin,role:"admin",response:t};throw new Error(r.message||"Admin login failed")}catch(t){throw console.error("Admin login error:",t),new Error(t.message||"Admin login failed")}},async login(e){const{username:t,password:r}=e;console.log("Attempting login with:",t,r);try{if(t==="admin"){const l=await this.adminLogin(e),c=await l.json();return await this.handleLoginResponse(l,"admin",c)}const n=await this.teacherLogin(e),s=await n.json();if(n.ok&&s.success)return await this.handleLoginResponse(n,"teacher",s);const a=await this.studentLogin(e),i=await a.json();return a.ok&&i.success?await this.handleLoginResponse(a,"student",i):(this.handleLoginFailure(),{success:!1,message:"Login failed. Please check your credentials and try again."})}catch(n){return console.error("Login error:",n),this.handleLoginFailure(),{success:!1,message:n.message||"Login failed"}}},async handleLoginResponse(e,t,r){if(e.ok&&r.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),this.handleLoginFailure(),{success:!1,message:"JWT system not available"};if(r.accessToken&&r.role)try{window.tokenManager.setTokens(r.accessToken,r.role),window.roleBasedLoader.setupAccessAfterLogin()}catch(n){return console.error("[ERROR] Failed to initialize JWT system:",n),this.handleLoginFailure(),{success:!1,message:"Failed to initialize JWT system"}}return this.resetLoginForm(),await this.handlePostLoginActions(r,t),{success:!0,data:r,role:t}}return{success:!1,message:"Login failed"}},async handlePostLoginActions(e,t){console.log(`Handling post-login actions for role: ${t}`);try{switch(t){case"student":e.student&&(this.populateStudentInfo(e.student),window.loadStudentData&&await window.loadStudentData());break;case"teacher":e.teacher&&(this.populateTeacherInfo(e.teacher),window.loadTeacherData&&await window.loadTeacherData());break;case"admin":e.admin&&window.loadAdminData&&await window.loadAdminData();break;default:console.warn(`Unknown role for post-login actions: ${t}`)}}catch(r){console.error("Error in post-login actions:",r)}},handleLoginFailure(){console.log("All login attempts failed"),this.resetLoginForm(),window.showNotification&&window.showNotification("Login failed. Please check your credentials and try again.","error")},resetLoginForm(){const e=document.getElementById("unifiedLoginForm");if(e){e.querySelectorAll("input").forEach(n=>{n.disabled=!1,n.style.opacity="1",n.style.cursor="text",n.removeAttribute("readonly"),n.style.pointerEvents="auto"});const r=e.querySelector('button[type="submit"]');r&&(r.disabled=!1,r.style.opacity="1",r.style.cursor="pointer",r.style.pointerEvents="auto",r.innerHTML="Login"),e.classList.remove("test-submitting","disabled"),e.style.pointerEvents="auto",console.log("Login form reset successfully - all inputs re-enabled")}},async logout(){console.log(" Logout initiated...");try{return window.tokenManager&&window.tokenManager.logout(),window.roleBasedLoader&&window.roleBasedLoader.reloadRoleAccess(),window.clearTestLocalStorage&&window.clearTestLocalStorage(),this.resetInterfaceAfterSessionClear(),console.log(" Logout completed - user session cleared, test data cleared, and interface reset"),{success:!0}}catch(e){return console.error("Logout error:",e),this.resetInterfaceAfterSessionClear(),{success:!0}}},resetInterfaceAfterSessionClear(){try{window.forceLogout=!0,window.preventAutoLogin=!0,window.isClearingSession=!0,window.forceLogoutComplete=!0,document.querySelectorAll(".section").forEach(s=>{s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0"}),document.querySelectorAll('[id$="-cabinet"], [id$="-container"], [id*="cabinet"], [id*="container"]').forEach(s=>{s.id&&s.id!=="login-section"&&(s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0")}),document.body.classList.remove("student-logged-in","teacher-logged-in","admin-logged-in"),document.body.classList.add("force-logout");const r=document.getElementById("login-section");r&&(r.classList.add("active"),r.style.display="block",r.style.visibility="visible",r.style.opacity="1"),document.querySelectorAll("input, select, textarea").forEach(s=>{s.type!=="hidden"&&(s.value="",s.checked=!1)}),console.log(" Interface reset to login state")}catch(e){console.error("Error resetting interface:",e),localStorage.clear(),sessionStorage.clear(),window.location.reload()}},async changePassword(e){try{return{success:!0,message:(await os.post("/auth/change-password",{currentPassword:e.currentPassword,newPassword:e.newPassword,confirmPassword:e.confirmPassword})).data.message}}catch(t){throw new Error(t.response?.data?.message||"Password change failed")}},async verifyToken(e){try{const t=await os.get("/auth/verify",{headers:{Authorization:`Bearer ${e}`}});return{success:!0,valid:t.data.valid,user:t.data.user}}catch(t){return{success:!1,valid:!1,error:t.message}}},async refreshToken(e){try{const t=await os.post("/auth/refresh",{refreshToken:e});return{success:!0,token:t.data.token,refreshToken:t.data.refreshToken}}catch(t){throw new Error(t.response?.data?.message||"Token refresh failed")}},async getUserProfile(){try{return{success:!0,user:(await os.get("/auth/profile")).data.user}}catch(e){throw new Error(e.response?.data?.message||"Failed to get user profile")}},async updateUserProfile(e){try{return{success:!0,user:(await os.put("/auth/profile",e)).data.user}}catch(t){throw new Error(t.response?.data?.message||"Failed to update user profile")}},populateStudentInfo(e){console.log("=== populateStudentInfo called ==="),console.log("Student object:",e);const t=document.getElementById("studentName");if(t){const s=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=s,console.log("Set student name to:",s)}const r=document.getElementById("studentGrade");r&&(r.textContent=e?.grade||"",console.log("Set student grade to:",e?.grade));const n=document.getElementById("studentClass");n&&(n.textContent=e?.class||"",console.log("Set student class to:",e?.class)),console.log("Student info populated successfully")},populateTeacherInfo(e){console.log("=== populateTeacherInfo called ==="),console.log("Teacher object:",e);const t=document.getElementById("teacherName");if(t){const n=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=n,console.log("Set teacher name to:",n)}const r=document.getElementById("teacherUsername");r&&(r.textContent=e?.username||"",console.log("Set teacher username to:",e?.username)),console.log("Teacher info populated successfully")},getCurrentTeacherId(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.sub?e.role==="teacher"?(console.log(`[DEBUG] Found teacher ID from JWT: ${e.sub}`),e.sub):(console.warn(`[WARN] Unsupported role for teacher function: ${e.role}`),null):(console.warn("[WARN] No teacher ID found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher ID from JWT:",e),null}},getCurrentAdmin(){const e=window.tokenManager?.getToken();if(!e)return null;const t=window.tokenManager.decodeToken(e);if(!t||t.role!=="admin")throw new Error("getCurrentAdmin() called by non-admin user");return{id:t.sub,username:t.username,role:t.role}},getCurrentTeacherUsername(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.username?(console.log(`[DEBUG] Found teacher username from JWT: ${e.username}`),e.username):(console.warn("[WARN] No teacher username found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher username from JWT:",e),null}},isAdmin(){try{const e=window.tokenManager?.getToken();if(!e)return!1;const t=window.tokenManager.decodeToken(e);return t&&t.role==="admin"}catch(e){return console.error("[ERROR] Error checking admin status:",e),!1}},getCurrentAdminId(){try{const e=this.getCurrentAdmin();return e?e.id:null}catch(e){return console.error("[ERROR] Error getting admin ID:",e),null}}},HW=()=>{const e=Ri(),{login:t,setUserData:r,isAuthenticated:n,user:s}=Hn(),[a,i]=C.useState({username:"",password:""}),[l,c]=C.useState(!1),[d,f]=C.useState(""),[p,g]=C.useState([]),[y,v]=C.useState(!1);C.useEffect(()=>{_()},[]);const _=C.useCallback(()=>{console.log("Checking for existing JWT session...");try{(window.forceLogout||window.preventAutoLogin)&&(window.forceLogout=!1,window.preventAutoLogin=!1)}catch{}if(window.tokenManager&&window.tokenManager.isAuthenticated()){console.log("JWT session valid, checking user role...");try{const G=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());G&&G.role?console.log("User role from JWT:",G.role):console.log("No valid role found in JWT, showing login")}catch(G){console.error("Error decoding JWT token:",G)}}else console.log("No valid JWT session found, showing login")},[]),b=C.useCallback(async G=>{if(G.preventDefault(),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),E("Please wait for the logout process to complete.","warning");return}const{username:Y,password:ee}=a;if(!Y||!ee){f("Please enter both username and password");return}c(!0),f("");try{let ie,re;Y==="admin"?(ie=await Bw.adminLogin({username:Y,password:ee}),re=ui.ADMIN):/^\d+$/.test(Y)?(ie=await Bw.studentLogin({username:Y,password:ee}),re=ui.STUDENT):(ie=await Bw.teacherLogin({username:Y,password:ee}),re=ui.TEACHER);let se,B;if(ie.response?(se=ie,B=ie.response):(se=await ie.json(),B=ie),await N(B,re,se)){E("Login successful!","success");try{window.forceLogout=!1,window.preventAutoLogin=!1}catch{}}}catch(ie){console.error("Login error:",ie),f("Invalid username or password")}finally{c(!1)}},[a]),N=C.useCallback(async(G,Y,ee)=>{if(G.ok&&ee.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),F(),!1;try{ee.token&&(window.tokenManager.setTokens(ee.token,Y),ee.refreshToken&&window.tokenManager.setRefreshToken(ee.refreshToken),console.log("JWT token stored successfully"));const ie={...ee.data,...ee,role:Y};return r(ie),await k(ie),!0}catch(ie){return console.error("Error handling login response:",ie),F(ie),!1}}else return console.error("Login failed:",ee.error||"Unknown error"),f(ee.error||"Login failed. Please check your credentials."),!1},[t]),k=C.useCallback(async G=>{if(console.log("Handling post-login actions for role:",G.role),y){console.log(" Post-login already handled, skipping");return}v(!0);try{switch(G.role){case ui.STUDENT:await w(G),e("/student");break;case ui.TEACHER:await T(G),e("/teacher");break;case ui.ADMIN:await A(G),e("/admin");break;default:console.error("Unknown user role:",G.role),F()}}catch(Y){console.error("Error in post-login actions:",Y),F(Y)}},[e,y]);C.useEffect(()=>{n||v(!1)},[n]);const w=C.useCallback(async G=>{console.log("Populating student info:",G)},[]),T=C.useCallback(async G=>{console.log("Populating teacher info:",G)},[]),A=C.useCallback(async G=>{console.log("Populating admin info:",G)},[]),F=C.useCallback((G=null)=>{console.error("Login failure:",G),f("Login failed. Please check your credentials and try again."),R()},[]),R=C.useCallback(()=>{i({username:"",password:""}),f(""),c(!1)},[]),E=C.useCallback((G,Y)=>{const ee={id:Date.now(),message:G,type:Y,timestamp:new Date};g(ie=>[...ie,ee]),setTimeout(()=>{g(ie=>ie.filter(re=>re.id!==ee.id))},Ti.NOTIFICATION_DURATION)},[]),D=C.useCallback(G=>{const{name:Y,value:ee}=G.target;i(ie=>({...ie,[Y]:ee})),d&&f("")},[d]),I=C.useCallback(G=>{G.key==="Enter"&&!l&&b(G)},[b,l]);return o.jsxs(Ze.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[o.jsxs(Ze.div,{className:"w-full max-w-md",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[o.jsxs(Ze.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3,duration:.5},children:[o.jsx(Ze.div,{className:"flex justify-center mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.5,type:"spring"},children:o.jsx("img",{src:"/pics/logo_mws.png",alt:"MWS Logo",className:"h-16 w-16 object-contain"})}),o.jsx(Ze.h1,{className:"text-3xl font-bold text-gray-900 mb-2",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.3},children:"Mathayom Watsing School"}),o.jsx(Ze.p,{className:"text-lg text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.3},children:"Test Management System"})]}),o.jsxs(Ze.div,{className:"bg-white rounded-xl shadow-2xl p-8",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.7,duration:.5,type:"spring"},children:[o.jsx(Ze.h2,{className:"text-2xl font-semibold text-gray-900 text-center mb-6",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.8,duration:.3},children:"Login"}),o.jsxs("form",{onSubmit:b,className:"space-y-6",children:[o.jsxs(Ze.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.9,duration:.3},children:[o.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Student ID"}),o.jsx(Ze.input,{type:"text",id:"username",name:"username",value:a.username,onChange:D,onKeyDown:I,placeholder:"Enter student ID",required:!0,autoComplete:"username",disabled:l,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":d?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),o.jsxs(Ze.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1,duration:.3},children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),o.jsx(Ze.input,{type:"password",id:"password",name:"password",value:a.password,onChange:D,onKeyDown:I,placeholder:"Enter your password",required:!0,autoComplete:"current-password",disabled:l,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":d?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),o.jsx(Ei,{children:d&&o.jsx(Ze.div,{id:"error-message",className:"bg-red-50 border border-red-200 rounded-lg p-3",role:"alert","aria-live":"polite",initial:{opacity:0,height:0,y:-10},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:-10},transition:{duration:.3},children:o.jsx("p",{className:"text-sm text-red-600",children:d})})}),o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.1,duration:.3},children:o.jsx(et,{type:"submit",variant:"primary",size:"lg",disabled:l,className:"w-full",children:l?o.jsxs(o.Fragment,{children:[o.jsx(Fr,{size:"sm",className:"mr-2"}),"Logging in..."]}):"Login"})})]})]}),Ti.DEBUG_MODE]}),o.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:o.jsx(Ei,{children:p.map(G=>o.jsx(Ze.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{duration:.3,type:"spring"},children:o.jsx(Zo,{type:G.type,message:G.message,onClose:()=>g(Y=>Y.filter(ee=>ee.id!==G.id))})},G.id))})})]})},Sn={async getStudentData(){console.log("getStudentData called - loading student subjects");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-subjects")).json();if(t.success)return console.log("Student data loaded successfully:",t.subjects),t.subjects;throw new Error(t.error||"Failed to load student data")}catch(e){throw console.error("Error loading student data:",e),e}},getStudentSubjects(e){return console.log("getStudentSubjects called with subjects:",e),e.map(t=>({id:t.id||t.subject_id,name:t.subject,grade:t.grade,class:t.class,testResults:t.test_results||[]}))},async getTeacherData(){console.log("getTeacherData called - loading teacher subjects");try{const e=await this.getCurrentTeacherId();if(!e)throw new Error("No valid teacher session found");const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-subjects")).json();if(r.success)return console.log("Teacher data loaded successfully:",r.subjects),{teacher_id:e,subjects:r.subjects,hasSubjects:r.subjects.length>0};throw new Error(r.error||"Failed to load teacher data")}catch(e){throw console.error("Error loading teacher data:",e),e}},getTeacherSubjects(e){return console.log("getTeacherSubjects called with subjects:",e),e.map(t=>{let r=[];return t.classes&&Array.isArray(t.classes)&&(r=t.classes.map(n=>({grade:n.grade,class:n.class,className:n.class}))),{id:t.subject_id,name:t.subject,classes:r,assignments:t.assignments||[],description:t.description||""}})},getGradeButtons(){return console.log("getGradeButtons called"),["M1","M2","M3","M4","M5","M6"].map(t=>({id:t,name:t,classes:this.generateClassButtons(t)}))},generateClassButtons(e){const t=[];for(let r=1;r<=10;r++)t.push({id:`${e}_${r}`,name:`${e}/${r}`,grade:e,class:r});return t},async getAdminData(){console.log("getAdminData called - loading admin data");try{if(!await this.getCurrentAdminId())throw new Error("No valid admin session found");const[t,r,n,s]=await Promise.allSettled([this.getAllTeachers(),this.getAllSubjects(),this.getAcademicYear(),this.getAllUsers()]);return{teachers:t.status==="fulfilled"?t.value:[],subjects:r.status==="fulfilled"?r.value:[],academicYear:n.status==="fulfilled"?n.value:[],users:s.status==="fulfilled"?s.value:[],loadedAt:new Date().toISOString()}}catch(e){throw console.error("Error loading admin data:",e),e}},async saveTeacherSubjects(e){console.log("saveTeacherSubjects called with subjects:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-teacher-subjects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subjects:e})})).json();if(r.success)return console.log("Teacher subjects saved successfully"),r;throw new Error(r.error||"Failed to save teacher subjects")}catch(t){throw console.error("Error saving teacher subjects:",t),t}},async deleteTeacherSubject(e){console.log("deleteTeacherSubject called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/delete-teacher-subject",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher subject assignment deleted successfully"),r;throw new Error(r.error||"Failed to delete teacher subject assignment")}catch(t){throw console.error("Error deleting teacher subject assignment:",t),t}},async getSubjectsDropdown(){console.log("getSubjectsDropdown called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("Subjects dropdown data loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,value:r.subject_name}));throw new Error(t.error||"Failed to load subjects dropdown")}catch(e){throw console.error("Error loading subjects dropdown:",e),e}},async getGradesAndClasses(){console.log("getGradesAndClasses called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-grades-classes")).json();if(t.success)return console.log("Grades and classes loaded successfully"),t.data;throw new Error(t.message||"Failed to load grades and classes")}catch(e){throw console.error("Error loading grades and classes:",e),e}},async saveSubjectClasses(e,t){console.log("saveSubjectClasses called with subjectId:",e,"classes:",t);try{const r=await this.getCurrentTeacherId();if(!r)throw new Error("No valid teacher session found");const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-subject-classes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacher_id:r,subject_id:e,classes:t})})).json();if(s.success)return console.log("Subject classes saved successfully"),s;throw new Error(s.error||"Failed to save subject classes")}catch(r){throw console.error("Error saving subject classes:",r),r}},async getAllSubjects(){console.log("getAllSubjects called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("All subjects loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,description:r.description||"",created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all subjects")}catch(e){throw console.error("Error loading all subjects:",e),e}},async getSubjectsForSelection(){console.log("getSubjectsForSelection called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-subjects")).json();if(t.success)return console.log("Subjects for selection loaded successfully"),t.subjects;throw new Error(t.message||"Failed to load subjects for selection")}catch(e){throw console.error("Error loading subjects for selection:",e),e}},async getAcademicYear(){console.log("getAcademicYear called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-academic-year")).json();if(t.success)return console.log("Academic year loaded successfully"),t.academic_years.map(r=>({id:r.id,year:r.academic_year,semester:r.semester,term:r.term,start_date:r.start_date,end_date:r.end_date,is_current:r.is_current}));throw new Error(t.error||"Failed to load academic year")}catch(e){throw console.error("Error loading academic year:",e),e}},async addAcademicYear(e){console.log("addAcademicYear called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/add-academic-year",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Academic year added successfully"),r;throw new Error(r.error||"Failed to add academic year")}catch(t){throw console.error("Error adding academic year:",t),t}},async getAllUsers(){console.log("getAllUsers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-users")).json();if(t.success)return console.log("All users loaded successfully"),t.users.map(r=>({id:r.id,student_id:r.student_id,grade:r.grade,class:r.class,number:r.number,name:r.name,surname:r.surname,nickname:r.nickname,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all users")}catch(e){throw console.error("Error loading all users:",e),e}},async getAllTeachers(){console.log("getAllTeachers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-teachers")).json();if(t.success)return console.log("All teachers loaded successfully"),t.teachers.map(r=>({id:r.id,teacher_id:r.teacher_id,username:r.username,name:r.name,surname:r.surname,email:r.email,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all teachers")}catch(e){throw console.error("Error loading all teachers:",e),e}},async createUser(e){console.log("createUser called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("User created successfully"),r;throw new Error(r.error||"Failed to create user")}catch(t){throw console.error("Error creating user:",t),t}},async updateUser(e,t){console.log("updateUser called with userId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-user/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("User updated successfully"),n;throw new Error(n.error||"Failed to update user")}catch(r){throw console.error("Error updating user:",r),r}},async createTeacher(e){console.log("createTeacher called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-teacher",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher created successfully"),r;throw new Error(r.error||"Failed to create teacher")}catch(t){throw console.error("Error creating teacher:",t),t}},async updateTeacher(e,t){console.log("updateTeacher called with teacherId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-teacher/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("Teacher updated successfully"),n;throw new Error(n.error||"Failed to update teacher")}catch(r){throw console.error("Error updating teacher:",r),r}},async updateStudentInfo(e){console.log("updateStudentInfo called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-student-info",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Student info updated successfully"),r;throw new Error(r.error||"Failed to update student info")}catch(t){throw console.error("Error updating student info:",t),t}},async changePassword(e){console.log("changePassword called");let t;if(e.studentId)t="/.netlify/functions/change-student-password";else if(e.username)t="/.netlify/functions/change-teacher-password";else throw new Error("Invalid password data: missing studentId or username");try{const n=await(await window.tokenManager.makeAuthenticatedRequest(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(n.success)return console.log("Password changed successfully"),n;throw new Error(n.error||"Failed to change password")}catch(r){throw console.error("Error changing password:",r),r}},async getCurrentTeacherId(){try{const e=localStorage.getItem("accessToken");if(!e)return null;const t=JSON.parse(atob(e.split(".")[1]));return t.teacher_id||t.sub||null}catch(e){return console.error("Error getting current teacher ID:",e),null}},async getCurrentAdminId(){try{const e=localStorage.getItem("accessToken");if(!e)return null;const t=JSON.parse(atob(e.split(".")[1]));return t.admin_id||t.sub||null}catch(e){return console.error("Error getting current admin ID:",e),null}}},Oj=C.createContext(),Lj=({children:e})=>{const[t,r]=C.useState(null),[n,s]=C.useState([]),[a,i]=C.useState([]),[l,c]=C.useState([]),[d,f]=C.useState([]),[p,g]=C.useState([]),[y,v]=C.useState([]),[_,b]=C.useState([]),[N,k]=C.useState(!1),[w,T]=C.useState(null),[A,F]=C.useState(!1),[R,E]=C.useState(!1),[D,I]=C.useState(!1),[G,Y]=C.useState(null),[ee,ie]=C.useState(null),[re,se]=C.useState(null),B=C.useCallback(async()=>{try{k(!0),T(null);const fe=`student_subjects_${t?.student_id||t?.id||""}`;console.log(" UserContext: Checking cache for key:",fe);const _e=Rn(fe);if(_e){console.log(" UserContext: Cache HIT! Using cached student data"),s(_e),z(_e);return}console.log(" UserContext: Cache MISS! Fetching from API");const $e=await Sn.getStudentData();if($e)s($e),z($e),console.log(" UserContext: Caching student data with key:",fe),Dn(fe,$e,Bn.student_subjects);else throw new Error("No subjects data received")}catch(we){T(we.message||"Failed to load student data"),console.error("Error loading student data:",we)}finally{k(!1)}},[t?.student_id,t?.id]),z=we=>{console.log("Displaying student subjects:",we),s(we)},U=C.useCallback(async()=>{try{if(k(!0),T(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid teacher session found in loadTeacherData, redirecting to login"),T("No valid teacher session found");return}const fe=`teacher_subjects_${t?.teacher_id||t?.id||""}`,_e=Rn(fe);if(_e){s(_e),_e.length===0?ct():V(_e);return}const $e=await Sn.getTeacherSubjects();if($e.success)s($e.subjects),Dn(fe,$e.subjects,Bn.teacher_subjects),$e.subjects.length===0?ct():V($e.subjects);else throw new Error($e.message||"Failed to load teacher data")}catch(we){T(we.message||"Failed to load teacher data"),console.error("Error loading teacher data:",we)}finally{k(!1)}},[t?.teacher_id,t?.id]),V=we=>{console.log("Showing main cabinet with subjects:",we),s(we)},q=we=>{console.log("Displaying grade buttons:",we),c(we)},L=async()=>{try{if(k(!0),T(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid admin session found in loadAdminData, redirecting to login"),T("No valid admin session found");return}await Promise.all([ge(),Pe(),Ye(),Z()])}catch(we){T(we.message||"Failed to load admin data"),console.error("Error loading admin data:",we)}finally{k(!1)}},M=we=>{console.log(" populateStudentInfoDirectly called with:",we);try{r(we),console.log(" Set student profile:",we)}catch(fe){console.error("Error populating student info:",fe)}},X=we=>{console.log("=== populateStudentInfo called ==="),r(we)},K=we=>{console.log("=== populateTeacherInfo called ==="),r(we)},Z=C.useCallback(async()=>{try{k(!0);const we="admin_users_",fe=Rn(we);if(fe){f(fe),J(fe);return}const _e=await Sn.getAllUsers();if(_e.success)f(_e.users),J(_e.users),Dn(we,_e.users,Bn.admin_users);else throw new Error(_e.message||"Failed to load users")}catch(we){T(we.message||"Failed to load users"),console.error("Error loading users:",we)}finally{k(!1)}},[]),J=we=>{console.log("Displaying all users:",we),f(we)},ne=(we,fe)=>{console.log("Displaying users table:",we,fe),f(we)},me=()=>{console.log("Toggling users content")},xe=()=>{console.log("Showing add user form"),F(!0)},Ne=()=>{console.log("Hiding add user form"),F(!1)},le=we=>{console.log("Editing user row:",we);const fe=d.find(_e=>_e.id===we);Y(fe)},ge=C.useCallback(async()=>{try{const we="admin_teachers_",fe=Rn(we);if(fe){g(fe),Ue(fe);return}const _e=await Sn.getAllTeachers();if(_e.success)g(_e.teachers),Ue(_e.teachers),Dn(we,_e.teachers,Bn.admin_teachers);else throw new Error(_e.message||"Failed to load teachers")}catch(we){T(we.message||"Failed to load teachers"),console.error("Error loading teachers:",we)}},[]),Ue=we=>{console.log("Displaying all teachers:",we),g(we)},Ge=(we,fe)=>{console.log("Displaying teachers table:",we,fe),g(we)},Je=()=>{console.log("Toggling teachers content")},He=()=>{console.log("Showing add teacher form"),E(!0)},Ft=()=>{console.log("Hiding add teacher form"),E(!1)},rt=we=>{console.log("Editing teacher:",we);const fe=p.find(_e=>_e.id===we);ie(fe)},Ie=we=>{console.log("Editing teacher row:",we);const fe=p.find(_e=>_e.id===we);ie(fe)},Pe=C.useCallback(async()=>{try{const we="admin_subjects_",fe=Rn(we);if(fe){v(fe),Qe(fe);return}const _e=await Sn.getAllSubjects();if(_e.success)v(_e.subjects),Qe(_e.subjects),Dn(we,_e.subjects,Bn.admin_subjects);else throw new Error(_e.message||"Failed to load subjects")}catch(we){T(we.message||"Failed to load subjects"),console.error("Error loading subjects:",we)}},[]),Qe=we=>{console.log("Displaying all subjects:",we),v(we)},_t=(we,fe)=>{console.log("Displaying subjects table:",we,fe),v(we)},gt=()=>{console.log("Toggling subjects content")},Bt=()=>{console.log("Showing add subject form"),I(!0)},Ut=()=>{console.log("Hiding add subject form"),I(!1)},it=we=>{console.log("Editing subject row:",we);const fe=y.find(_e=>_e.id===we);se(fe)},Ye=C.useCallback(async()=>{try{const we="admin_academic_years_",fe=Rn(we);if(fe){b(fe),xt(fe);return}const _e=await Sn.getAcademicYear();if(_e.success)b(_e.academicYears),xt(_e.academicYears),Dn(we,_e.academicYears,Bn.admin_academic_years);else throw new Error(_e.message||"Failed to load academic year")}catch(we){T(we.message||"Failed to load academic year"),console.error("Error loading academic year:",we)}},[]),xt=we=>{console.log("Displaying academic year:",we),b(we)},ut=()=>{console.log("Showing add academic year form")},wt=()=>{console.log("Hiding add academic year form")},$t=we=>{console.log("Handling add academic year:",we)},Kt=()=>{console.log("Toggling academic year content")},De=()=>{console.log("Showing academic year editor")},ct=()=>{console.log("Showing subject selection")},mt=()=>{console.log("Showing main cabinet")},At=we=>{r(fe=>({...fe,...we}))},Lt=()=>{r(null),s([]),i([]),c([]),f([]),g([]),v([]),b([]),T(null)},rr=C.useCallback(we=>{Lt(),we&&S2(we)},[]),Ee={userProfile:t,userSubjects:n,userClasses:a,userGrades:l,allUsers:d,allTeachers:p,allSubjects:y,academicYears:_,isLoading:N,error:w,showUserForm:A,showTeacherForm:R,showSubjectForm:D,editingUser:G,editingTeacher:ee,editingSubject:re,loadStudentData:B,displayStudentSubjects:z,populateStudentInfoDirectly:M,populateStudentInfo:X,loadTeacherData:U,showMainCabinetWithSubjects:V,displayGradeButtons:q,populateTeacherInfo:K,showSubjectSelection:ct,showMainCabinet:mt,loadAdminData:L,getAllUsers:Z,displayAllUsers:J,displayUsersTable:ne,toggleUsersContent:me,showAddUserForm:xe,hideAddUserForm:Ne,editUserRow:le,loadAllTeachers:ge,displayAllTeachers:Ue,displayTeachersTable:Ge,toggleTeachersContent:Je,showAddTeacherForm:He,hideAddTeacherForm:Ft,editTeacher:rt,editTeacherRow:Ie,loadAllSubjects:Pe,displayAllSubjects:Qe,displaySubjectsTable:_t,toggleSubjectsContent:gt,showAddSubjectForm:Bt,hideAddSubjectForm:Ut,editSubjectRow:it,loadAcademicYear:Ye,displayAcademicYear:xt,showAddAcademicYearForm:ut,hideAddAcademicYearForm:wt,handleAddAcademicYear:$t,toggleAcademicYearContent:Kt,showAcademicYearEditor:De,updateUserProfile:At,clearUserData:Lt,clearUserDataWithCache:rr,setUserProfile:r,setUserSubjects:s,setUserClasses:i,setUserGrades:c,setAllUsers:f,setAllTeachers:g,setAllSubjects:v,setAcademicYears:b,setError:T};return o.jsx(Oj.Provider,{value:Ee,children:e})},ev=()=>{const e=C.useContext(Oj);if(!e)throw new Error("useUser must be used within a UserProvider");return e},wm={STUDENT_LOGIN:"/.netlify/functions/student-login",TEACHER_LOGIN:"/.netlify/functions/teacher-login",ADMIN_LOGIN:"/.netlify/functions/admin-login",CHANGE_PASSWORD:"/.netlify/functions/change-password",GET_TEST_QUESTIONS:"/.netlify/functions/get-test-questions",SUBMIT_MULTIPLE_CHOICE_TEST:"/.netlify/functions/submit-multiple-choice-test",SUBMIT_TRUE_FALSE_TEST:"/.netlify/functions/submit-true-false-test",SUBMIT_INPUT_TEST:"/.netlify/functions/submit-input-test",SUBMIT_MATCHING_TEST:"/.netlify/functions/submit-matching-test",SUBMIT_DRAWING_TEST:"/.netlify/functions/submit-drawing-test",GET_STUDENT_SUBJECTS:"/.netlify/functions/get-student-subjects",GET_TEACHER_SUBJECTS:"/.netlify/functions/get-teacher-subjects",GET_ALL_USERS:"/.netlify/functions/get-all-users",GET_ALL_TEACHERS:"/.netlify/functions/get-all-teachers",GET_ALL_SUBJECTS:"/.netlify/functions/get-all-subjects",GET_ACADEMIC_YEAR:"/.netlify/functions/get-academic-year",SAVE_MULTIPLE_CHOICE_TEST:"/.netlify/functions/save-multiple-choice-test",SAVE_TRUE_FALSE_TEST:"/.netlify/functions/save-true-false-test",SAVE_INPUT_TEST:"/.netlify/functions/save-input-test",SAVE_MATCHING_TEST:"/.netlify/functions/save-matching-test",SAVE_DRAWING_TEST:"/.netlify/functions/save-drawing-test",UPDATE_DRAWING_TEST_SCORE:"/.netlify/functions/update-drawing-test-score",UPDATE_SPEAKING_TEST_SCORE:"/.netlify/functions/update-speaking-test-score",ASSIGN_TEST_TO_CLASSES:"/.netlify/functions/assign-test-to-classes",GET_TEACHER_ACTIVE_TESTS:"/.netlify/functions/get-teacher-active-tests",GET_STUDENT_ACTIVE_TESTS:"/.netlify/functions/get-student-active-tests"},pn={MULTIPLE_CHOICE:"multiple_choice",TRUE_FALSE:"true_false",INPUT:"input",MATCHING:"matching_type",WORD_MATCHING:"word_matching",DRAWING:"drawing",FILL_BLANKS:"fill_blanks"},ui={STUDENT:"student",TEACHER:"teacher",ADMIN:"admin"};Array.from({length:10},(e,t)=>t+1);const Ti={API_BASE_URL:"",APP_NAME:"Mathayom Watsing Test System",VERSION:"2.0.0",DEBUG_MODE:!1,AUTO_SAVE_INTERVAL:3e4,NOTIFICATION_DURATION:3e3,MAX_TEST_QUESTIONS:50,MIN_TEST_QUESTIONS:1,ITEMS_PER_PAGE:20,CACHE_DURATION:3e5,CURRENT_ACADEMIC_YEAR:"2025-2026",CURRENT_SEMESTER:1},Ou=(e,t,r)=>{if(!e||!Array.isArray(e)||e.length===0)return{score:0,total:0,percentage:0};let n=0;return e.forEach((s,a)=>{const i=Array.isArray(t)?t[a]:t[String(s.question_id||s.id||a)];i!=null&&f0(s,i,r)&&n++}),{score:n,total:e.length,percentage:Math.round(n/e.length*100)}},up=(e,t)=>{console.log(" Getting correct answer for question:",e,"testType:",t);let r="";switch(t){case pn.TRUE_FALSE:r=e.correct_answer?"true":"false",console.log(" TRUE_FALSE correct_answer from question:",r,typeof r);break;case pn.MULTIPLE_CHOICE:const n=e.correct_answer.charCodeAt(0)-65,s=`option_${String.fromCharCode(97+n)}`,a=e[s];a?r=a:r=`Option ${e.correct_answer}`;break;case pn.INPUT:e.correct_answers&&Array.isArray(e.correct_answers)?r=e.correct_answers.join(", "):r=e.correct_answer||"Unknown";break;case pn.MATCHING:r=e.correct_answer||e.answer;break;case pn.WORD_MATCHING:r=e.correct_answer||e.answer;break;case pn.DRAWING:r="Drawing required";break;case pn.FILL_BLANKS:e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?r=e.correct_answers[0]:r=e.correct_answer||"Unknown";break;default:r="Unknown"}return console.log(" Correct answer:",r),r},f0=(e,t,r)=>{if(console.log("[DEBUG] checkAnswerCorrectness called for question:",e,"studentAnswer:",t,"testType:",r),!t||t==="")return console.log("[DEBUG] No student answer provided"),!1;let n=!1;switch(r){case pn.TRUE_FALSE:n=t.toLowerCase()==="true"===e.correct_answer;break;case pn.MULTIPLE_CHOICE:let a="";if(typeof t=="string"){const l=t.trim();if(/^[a-z]$/i.test(l))a=l.toUpperCase();else if(/^\d+$/.test(l)){const c=parseInt(l,10),d=c>=0?c:NaN;Number.isNaN(d)||(a=String.fromCharCode(65+d))}}else if(typeof t=="number"){const l=t;Number.isNaN(l)||(a=String.fromCharCode(65+l))}n=a!==""&&a===String(e.correct_answer||"").toUpperCase();break;case pn.INPUT:if(e.correct_answers&&Array.isArray(e.correct_answers)){const l=t.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();n=e.correct_answers.some(c=>{const d=c.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();return l===d})}else n=t.toLowerCase().trim()===e.correct_answer.toLowerCase().trim();break;case pn.MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const l=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(l)===JSON.stringify(e.correct_answer)}break;case pn.WORD_MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const l=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(l)===JSON.stringify(e.correct_answer)}break;case pn.DRAWING:console.warn("Drawing tests should not be auto-scored!"),n=!1;break;case pn.FILL_BLANKS:const i=e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?e.correct_answers[0]:e.correct_answer;if(i&&t){let l="";if(typeof t=="string"){const c=t.trim();if(/^[a-z]$/i.test(c))l=c.toUpperCase();else if(/^\d+$/.test(c)){const d=parseInt(c,10),f=d>=0?d:NaN;Number.isNaN(f)||(l=String.fromCharCode(65+f))}}else if(typeof t=="number"){const c=t;Number.isNaN(c)||(l=String.fromCharCode(65+c))}n=l!==""&&l===String(i||"").toUpperCase()}break;default:console.warn(`[WARN] Unknown test type for answer checking: ${r}`),n=!1}return console.log(`[DEBUG] Answer correctness: ${n}`),n},rn={async getTestInfo(e,t){console.log(`[DEBUG] getTestInfo called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test info from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test info data received:",s),s.success)return console.log("[DEBUG] Test info retrieved successfully"),s.test_info;throw new Error(s.error||"Failed to get test info")}catch(r){throw console.error("[ERROR] Failed to get test info:",r),r}},async getTestQuestions(e,t){console.log(`[DEBUG] getTestQuestions called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test questions from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test questions data received:",s),s.success)return console.log("[DEBUG] Test questions retrieved successfully"),s.questions;throw new Error(s.error||"Failed to get test questions")}catch(r){throw console.error("[ERROR] Failed to get test questions:",r),r}},async getActiveTests(){console.log("getActiveTests called - extracting studentId from JWT token");try{const e="/.netlify/functions/get-student-active-tests";console.log("[DEBUG] Fetching active tests from:",e);const t=await window.tokenManager.makeAuthenticatedRequest(e);if(console.log("[DEBUG] Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(console.log("[DEBUG] Active tests data received:",r),r.success)return console.log("[DEBUG] Active tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get active tests")}catch(e){throw console.error("[ERROR] Failed to get active tests:",e),e}},async getTeacherTests(){console.log("getTeacherTests called - extracting teacherId from JWT token");try{const e="/.netlify/functions/get-teacher-active-tests";console.log("[DEBUG] Fetching teacher tests from:",e);const t=await window.tokenManager.makeAuthenticatedRequest(e);if(console.log("[DEBUG] Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(console.log("[DEBUG] Teacher tests data received:",r),r.success)return console.log("[DEBUG] Teacher tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get teacher tests")}catch(e){throw console.error("[ERROR] Failed to get teacher tests:",e),e}},async submitTest(e,t,r,n={},s=null){console.log("Submitting test:",{testType:e,testId:t});try{if(Object.keys(r).length===0)throw new Error("Please answer at least one question before submitting.");let a;try{const k=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`)).json();if(k.success)a=k.test_info;else throw new Error("Failed to get test information")}catch(N){console.error("Error getting test info:",N);const k=await this.getTestQuestions(e,t);a={test_name:`Test ${t}`,num_questions:k.length}}const i=await this.getTestQuestions(e,t);let l,c;if(e==="drawing")l=null,c=null;else{const N=n?.answers_by_id?n.answers_by_id:r;l=Ou(i,N,e).score,c=a.num_questions}const d=this.transformAnswersForSubmission(r,e),f=a.teacher_id||null,p=a.subject_id||null,g=s?.student_id||s?.id||(window.tokenManager?.getCurrentUser?window.tokenManager.getCurrentUser()?.student_id||window.tokenManager.getCurrentUser()?.id:null),y={test_id:t,test_name:a.test_name,test_type:e,teacher_id:f,subject_id:p,student_id:g,answers:d,score:l,maxScore:c,time_taken:n.time_taken||null,started_at:n.started_at||null,submitted_at:n.submitted_at||new Date().toISOString(),caught_cheating:n.caught_cheating||!1,visibility_change_times:n.visibility_change_times||0,answers_by_id:n.answers_by_id||null,question_order:n.question_order||null,retest_assignment_id:n.retest_assignment_id||null,parent_test_id:n.parent_test_id||t};console.log(" testService retest_assignment_id:",n.retest_assignment_id),console.log(" testService timingData:",n),console.log(" testService commonData.retest_assignment_id:",y.retest_assignment_id);let v;switch(e){case"multiple_choice":v="/.netlify/functions/submit-multiple-choice-test";break;case"true_false":v="/.netlify/functions/submit-true-false-test";break;case"input":v="/.netlify/functions/submit-input-test";break;case"matching_type":v="/.netlify/functions/submit-matching-type-test";break;case"word_matching":v="/.netlify/functions/submit-word-matching-test";break;case"drawing":v="/.netlify/functions/submit-drawing-test";break;case"fill_blanks":v="/.netlify/functions/submit-fill-blanks-test";break;default:throw new Error(`Unsupported test type: ${e}`)}console.log("Submitting to:",v),console.log("Submission data:",y),console.log("Submission data JSON:",JSON.stringify(y,null,2)),console.log(" Final submission retest_assignment_id:",y.retest_assignment_id);const _=await window.tokenManager.makeAuthenticatedRequest(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)});if(!_.ok)throw new Error(`HTTP error! status: ${_.status}`);const b=await _.json();if(console.log("Test submission result:",b),b.success)return this.clearTestProgress(e,t),{success:!0,score:l,maxScore:c,result:b};throw new Error(b.error||"Failed to submit test")}catch(a){throw console.error("Error submitting test:",a),a}},async createTest(e){try{return(await os.post("/tests/create",e)).data}catch(t){throw new Error(t.message||"Failed to create test")}},async updateTest(e,t,r){try{return(await os.put(`/tests/${e}/${t}`,r)).data}catch(n){throw new Error(n.message||"Failed to update test")}},async deleteTest(e,t){try{return(await os.delete(`/tests/${e}/${t}`)).data}catch(r){throw new Error(r.message||"Failed to delete test")}},async duplicateTest(e,t){try{return(await os.post(`/tests/${e}/${t}/duplicate`)).data}catch(r){throw new Error(r.message||"Failed to duplicate test")}},async publishTest(e,t){try{return(await os.post(`/tests/${e}/${t}/publish`)).data}catch(r){throw new Error(r.message||"Failed to publish test")}},async unpublishTest(e,t){try{return(await os.post(`/tests/${e}/${t}/unpublish`)).data}catch(r){throw new Error(r.message||"Failed to unpublish test")}},async removeClassAssignment(e,t,r){try{return(await os.delete(`/tests/${e}/${t}/assignments/${r}`)).data}catch(n){throw new Error(n.message||"Failed to remove class assignment")}},async getTestStatistics(e,t){try{return(await os.get(`/tests/${e}/${t}/statistics`)).data}catch(r){throw new Error(r.message||"Failed to get test statistics")}},async exportTest(e,t,r="json"){try{return(await os.get(`/tests/${e}/${t}/export?format=${r}`)).data}catch(n){throw new Error(n.message||"Failed to export test")}},async importTest(e,t){try{return(await os.uploadFile(`/tests/import?type=${t}`,e)).data}catch(r){throw new Error(r.message||"Failed to import test")}},async getTestResults(e,t){try{return(await os.get(`/tests/${e}/${t}/results`)).data}catch(r){throw new Error(r.message||"Failed to get test results")}},async getStudentTestResults(){try{console.log("[DEBUG] Fetching student test results from: /.netlify/functions/get-student-test-results");const e=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-test-results");if(console.log("[DEBUG] Response status:",e.status),!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();if(console.log("[DEBUG] Student test results data received:",t),t.success)return console.log("[DEBUG] Student test results retrieved successfully"),t;throw new Error(t.error||"Failed to get student test results")}catch(e){throw console.error("[ERROR] Failed to get student test results:",e),new Error(e.message||"Failed to get student test results")}},async getClassResults(e,t,r){try{return(await os.get(`/tests/class-results/${e}/${t}/${r}`)).data}catch(n){throw new Error(n.message||"Failed to get class results")}},async saveTestProgress(e,t,r){try{return(await os.post(`/tests/${e}/${t}/progress`,{progress:r})).data}catch(n){throw new Error(n.message||"Failed to save test progress")}},async getTestProgress(e,t){try{return(await os.get(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to get test progress")}},async clearTestProgress(e,t){try{return(await os.delete(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to clear test progress")}},async validateTestData(e){try{return(await os.post("/tests/validate",e)).data}catch(t){throw new Error(t.message||"Failed to validate test data")}},async getTestPreview(e,t){try{return(await os.get(`/tests/${e}/${t}/preview`)).data}catch(r){throw new Error(r.message||"Failed to get test preview")}},isAnswerCorrect(e,t,r,n){switch(n){case"multiple_choice":return String.fromCharCode(65+parseInt(t))===r.correct_answer;case"true_false":return t.toLowerCase()==="true"===r.correct_answer;case"input":return(r.correct_answers||[]).some(l=>t.toLowerCase().trim()===l.toLowerCase().trim());case"matching_type":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"word_matching":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"drawing":return t&&t!=="No answer";default:return!1}},transformAnswersForSubmission(e,t){switch(t){case"multiple_choice":return e;case"true_false":return e;case"input":return e;case"matching_type":return e;case"word_matching":return e;case"drawing":if(Array.isArray(e)&&e.length>0)try{const r=e[0];return typeof r=="string"&&r.startsWith("[")?JSON.parse(r):e}catch(r){return console.warn("Failed to parse drawing answers:",r),e}return e;default:return e}},async markTestCompleted(e,t){try{console.log(`[DEBUG] markTestCompleted called with testType: ${e}, testId: ${t}`);const r=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/mark-test-completed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_type:e,test_id:t})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();if(console.log("[DEBUG] Mark test completed response:",n),n.success)return console.log(`Test ${e}_${t} marked as completed successfully`),{success:!0,message:n.message};throw new Error(n.error||"Failed to mark test as completed")}catch(r){throw console.error("Error marking test completed:",r),r}},clearTestProgress(e,t){try{const r=`test_progress_${e}_${t}`;localStorage.removeItem(r),console.log(`Test progress cleared for ${e}_${t}`)}catch(r){console.error("Error clearing test progress:",r)}},async saveMultipleChoiceTest(e){console.log("[DEBUG] saveMultipleChoiceTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-multiple-choice-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save multiple choice test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving multiple choice test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveTrueFalseTest(e){console.log("[DEBUG] saveTrueFalseTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-true-false-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save true/false test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving true/false test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveInputTest(e){console.log("[DEBUG] saveInputTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-input-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save input test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving input test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveMatchingTest(e){console.log("[DEBUG] saveMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"matching_type",num_questions:e.num_blocks})})).json();return console.log("[DEBUG] Save matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveWordMatchingTest(e){console.log("[DEBUG] saveWordMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"word_matching"})})).json();return console.log("[DEBUG] Save word matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving word matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveDrawingTest(e){console.log("[DEBUG] saveDrawingTest called with:",e);try{const t={...e,test_type:"drawing"},n=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save drawing test response:",n),n.success?{success:!0,data:{test_id:n.test_id}}:{success:!1,message:n.message||"Failed to save test"}}catch(t){return console.error("Error saving drawing test:",t),{success:!1,message:"Error saving test: "+t.message}}},async getDrawingTest(e){console.log("[DEBUG] getDrawingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-drawing-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get drawing test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting drawing test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitDrawingTest(e,t,r,n){console.log("[DEBUG] submitDrawingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-drawing-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit drawing test response:",a),a.success?{success:!0,data:a.data}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting drawing test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async updateDrawingTestScore(e,t,r){console.log("[DEBUG] updateDrawingTestScore called with:",{resultId:e,score:t,maxScore:r});try{const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-drawing-test-score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({result_id:e,score:t,max_score:r})})).json();return console.log("[DEBUG] Update drawing test score response:",s),s.success?{success:!0,data:s.data}:{success:!1,message:s.message||"Failed to update score"}}catch(n){return console.error("Error updating drawing test score:",n),{success:!1,message:"Error updating score: "+n.message}}},async getWordMatchingTest(e){console.log("[DEBUG] getWordMatchingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-word-matching-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get word matching test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting word matching test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitWordMatchingTest(e,t,r,n){console.log("[DEBUG] submitWordMatchingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit word matching test response:",a),a.success?{success:!0,result:a.result}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting word matching test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async assignTestToClasses(e){console.log("[DEBUG] assignTestToClasses called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save test with assignments response:",r),r.success?{success:!0,message:"Test assigned successfully"}:{success:!1,message:r.message||"Failed to assign test"}}catch(t){return console.error("Error assigning test to classes:",t),{success:!1,message:"Error assigning test: "+t.message}}},async removeClassAssignment(e){console.log("[DEBUG] removeClassAssignment called with assignmentId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/remove-class-assignment?assignment_id=${e}`,{method:"DELETE"})).json();return console.log("[DEBUG] Remove class assignment response:",r),r.success?{success:!0,message:"Assignment removed successfully"}:{success:!1,message:r.message||"Failed to remove assignment"}}catch(t){return console.error("Error removing class assignment:",t),{success:!1,message:"Error removing assignment: "+t.message}}}},Bj=C.createContext(),Uj=({children:e})=>{const[t,r]=C.useState(null),[n,s]=C.useState([]),[a,i]=C.useState({}),[l,c]=C.useState({}),[d,f]=C.useState(!1),[p,g]=C.useState(null),[y,v]=C.useState([]),[_,b]=C.useState(!1),[N,k]=C.useState(null),[w,T]=C.useState({isOpen:!1,testType:null,testId:null,testName:null,questions:[]}),[A,F]=C.useState(null),[R,E]=C.useState(0),{getItem:D,setItem:I,removeItem:G}=Mj();C.useEffect(()=>{let Ee;return d&&A&&(Ee=setInterval(()=>{const we=Math.floor((Date.now()-A)/1e3);E(we)},1e3)),()=>{Ee&&clearInterval(Ee)}},[d,A]);const Y=async(Ee,we)=>{try{b(!0),k(null),console.log(`[DEBUG] loadTestForPage called with testType: ${Ee}, testId: ${we}`);const fe=await rn.getTestInfo(Ee,we);console.log("[DEBUG] Test info retrieved:",fe);const _e=await rn.getTestQuestions(Ee,we);console.log("[DEBUG] Test questions retrieved:",_e),r({...fe,testType:Ee,testId:we}),s(_e),f(!0),F(Date.now()),E(0),ee(Ee,we),console.log("[DEBUG] Test loaded successfully")}catch(fe){k(fe.message||"Failed to load test"),console.error("Error loading test:",fe)}finally{b(!1)}},ee=(Ee,we)=>{try{const fe=`test_progress_${Ee}_${we}`,_e=D(fe);_e&&(i(_e.answers||{}),c(_e.progress||{}))}catch(fe){console.error("Error loading saved progress:",fe)}},ie=(Ee,we,fe,_e)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}const St=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${Ee}_${we}`,pt={...a,[fe]:_e},Xt={...l,[fe]:{answered:!0,timestamp:Date.now()}};i(pt),c(Xt),I(St,{answers:pt,progress:Xt,lastSaved:Date.now()}),console.log(`Saved progress for question ${fe}:`,_e)}catch($e){console.error("Error saving test progress:",$e)}},re=(Ee,we,fe)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated())return console.warn("[WARN] Cannot get progress: No valid JWT token"),null;const $e=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${Ee}_${we}`;return D($e)?.answers?.[fe]||null}catch(_e){return console.error("Error getting test progress:",_e),null}},se=(Ee,we)=>{try{if(console.log(`[DEBUG] clearTestProgress called with testType: ${Ee}, testId: ${we}`),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const fe=window.tokenManager?.getDecodedToken()?.sub||"unknown",_e=`test_progress_${fe}_${Ee}_${we}`;console.log(`[DEBUG] Removing localStorage key: ${_e}`);const $e=D(_e)!==null;G(_e),i({}),c({});for(let St=0;St<localStorage.length;St++){const pt=localStorage.key(St);pt&&pt.startsWith(`test_progress_${fe}_${Ee}_${we}_`)&&(localStorage.removeItem(pt),console.log(`[DEBUG] Cleared individual question key: ${pt}`))}console.log($e?`[DEBUG] Progress cleared for test ${Ee}_${we}`:`[DEBUG] No progress found to clear for test ${Ee}_${we}`)}catch(fe){console.error("Error clearing test progress:",fe)}},B=async(Ee,we,fe="")=>{try{b(!0),k(null),console.log("Submitting test:",{testType:Ee,testId:we});const _e=Z(Ee,we);if(Object.keys(_e).length===0){k("Please answer at least one question before submitting.");return}let $e;try{$e=await rn.getTestInfo(Ee,we)}catch(Ir){console.error("Error getting test info:",Ir);const xr=await rn.getTestQuestions(Ee,we);$e={test_name:`Test ${we}`,num_questions:xr.length}}const St=await rn.getTestQuestions(Ee,we),pt=Ou(St,_e,Ee),Xt=$e.num_questions,Jt=ne(_e,Ee),Yt={test_id:we,test_name:$e.test_name,score:pt,maxScore:Xt,answers:Jt},pr=await rn.submitTest(Ee,we,Yt);if(pr.success){if(g(pr.result),q(Ee,we,fe),se(Ee,we),fe){const Ir=`student_results_table_${fe}`;console.log(" TestContext: Caching test results after submission with key:",Ir),Dn(Ir,pr.result,Bn.student_results_table)}return fe&&y0(fe,Ee,we),f(!1),pr.results}else throw new Error(pr.message||"Test submission failed")}catch(_e){throw k(_e.message||"Failed to submit test"),_e}finally{b(!1)}},z=(Ee,we,fe)=>{g({testType:Ee,testId:we,answers:fe}),f(!1)},U=()=>{r(null),s([]),i({}),c({}),f(!1),g(null),k(null),F(null),E(0)},V=(Ee,we,fe="")=>{try{const _e=`test_completed_${fe}_${Ee}_${we}`;return D(_e)===!0}catch(_e){return console.error("Error checking test completion:",_e),!1}},q=(Ee,we,fe="")=>{try{const _e=`test_completed_${fe}_${Ee}_${we}`;I(_e,!0)}catch(_e){console.error("Error marking test completed:",_e)}},L=Ee=>Object.keys(a).length,M=()=>{const Ee=L(t?.testType),we=n.length;return{canSubmit:Ee===we,answeredCount:Ee,totalQuestions:we}},X=()=>{t&&se(t.testType,t.testId),U()},K=(Ee="")=>{try{const we=`student_results_table_${Ee}`;console.log(" TestContext: Clearing test results cache:",we),localStorage.removeItem(we),console.log(" TestContext: Test results cache cleared")}catch(we){console.error("Error clearing test results cache:",we)}},Z=(Ee,we)=>({...a}),J=(Ee,we,fe=null)=>{try{if(!Ee)return"No answer";switch(we){case"true_false":return Ee?"True":"False";case"multiple_choice":if(fe&&typeof Ee=="string"&&!isNaN(parseInt(Ee))){const _e=parseInt(Ee),$e=`option_${String.fromCharCode(97+_e)}`,St=fe[$e];if(St)return St}return String(Ee).toUpperCase();case"input":return String(Ee);case"matching_type":return typeof Ee=="object"?Object.entries(Ee).map(([_e,$e])=>`${_e}  ${$e}`).join(", "):String(Ee);case"word_matching":return typeof Ee=="object"?Object.entries(Ee).map(([_e,$e])=>`${_e}  ${$e}`).join(", "):String(Ee);case"drawing":return"Drawing submitted";default:return String(Ee)}}catch(_e){return console.error("Error formatting student answer:",_e),"Error displaying answer"}},ne=(Ee,we)=>{try{if(!Ee||typeof Ee!="object")return{};const fe={};return Object.entries(Ee).forEach(([_e,$e])=>{if($e!=null)switch(we){case"true_false":fe[_e]=!!$e;break;case"multiple_choice":fe[_e]=String($e).toUpperCase();break;case"input":fe[_e]=String($e).trim();break;case"matching_type":typeof $e=="object"?fe[_e]=$e:fe[_e]=String($e);break;case"word_matching":typeof $e=="object"?fe[_e]=$e:fe[_e]=String($e);break;case"drawing":fe[_e]=$e;break;default:fe[_e]=$e}}),fe}catch(fe){return console.error("Error transforming answers for submission:",fe),Ee||{}}},me=C.useCallback(async(Ee="")=>{try{b(!0);const we=`student_active_tests_${Ee}`,fe=Rn(we);if(fe)return v(fe),fe;const _e=await rn.getActiveTests();return v(_e),Dn(we,_e,Bn.student_active_tests),_e}catch(we){return k(we.message||"Failed to load active tests"),v([]),[]}finally{b(!1)}},[]),xe=async()=>{try{return b(!0),await rn.getTeacherTests()}catch(Ee){return k(Ee.message||"Failed to load teacher tests"),[]}finally{b(!1)}},Ne=async Ee=>{try{return b(!0),await rn.createTest(Ee)}catch(we){throw k(we.message||"Failed to create test"),we}finally{b(!1)}},le=async(Ee,we)=>{try{return b(!0),await rn.deleteTest(Ee,we)}catch(fe){throw k(fe.message||"Failed to delete test"),fe}finally{b(!1)}},ge=async(Ee,we)=>{try{return await rn.getTestInfo(Ee,we)}catch(fe){throw console.error("Error getting test info:",fe),fe}},Ue=async(Ee,we)=>{try{return await rn.getTestQuestions(Ee,we)}catch(fe){throw console.error("Error getting test questions:",fe),fe}},Ge=async(Ee,we,fe)=>{try{console.log("Showing test results:",{testType:Ee,testId:we,studentAnswers:fe});const _e=await ge(Ee,we),$e=await Ue(Ee,we);Ft(_e,$e,Ee,fe),f(!1),console.log("Test results displayed successfully")}catch(_e){console.error("Error showing test results:",_e),k("Failed to display test results"),g({testType:Ee,testId:we,answers:fe,showResults:!0,error:"Could not load detailed results"}),f(!1)}},Je=async(Ee,we,fe)=>{try{b(!0);const _e=await ge(Ee,we),$e=await Ue(Ee,we);Ft(_e,$e,Ee,fe)}catch(_e){k(_e.message||"Failed to load test results")}finally{b(!1)}},He=C.useCallback(async(Ee="")=>{try{b(!0);const we=`student_results_table_${Ee}`;console.log(" TestContext: Checking cache for key:",we);const fe=Rn(we);if(fe)return console.log(" TestContext: Cache HIT! Using cached test results"),g(fe),fe;console.log(" TestContext: Cache MISS! Fetching from API");const _e=await rn.getStudentTestResults();return console.log(" TestContext: Test results loaded:",_e),console.log(" TestContext: Results data:",_e?.results||_e),console.log(" TestContext: Results length:",_e?.results?.length||0),g(_e),console.log(" TestContext: Caching test results with key:",we),console.log(" TestContext: Results being cached:",_e),console.log(" TestContext: Results.results being cached:",_e.results),Dn(we,_e,Bn.student_results_table),_e}catch(we){throw console.error("Error loading test results:",we),k(we.message||"Failed to load test results"),we}finally{b(!1)}},[]),Ft=(Ee,we,fe,_e)=>{try{console.log("Displaying test results:",{testInfo:Ee,questions:we,testType:fe,studentAnswers:_e});const $e=Ou(we,_e,fe),St=Ee?.num_questions||we?.length||0,pt=St>0?Math.round($e/St*100):0,Xt=pt>=60,Jt=we.map((Yt,pr)=>{const Ir=Yt.question_id||Yt.id,xr=_e[Ir],Tr=f0(Yt,xr,fe);return{questionNumber:pr+1,question:Yt.question||Yt.question_text,userAnswer:J(xr,fe),correctAnswer:up(Yt,fe),isCorrect:Tr,questionType:fe}});g({testInfo:Ee,questions:we,testType:fe,studentAnswers:_e,showResults:!0,score:$e,totalQuestions:St,percentage:pt,passed:Xt,questionAnalysis:Jt,timestamp:new Date().toISOString()}),c(Yt=>({...Yt,score:$e,totalQuestions:St,percentage:pt,passed:Xt,lastUpdated:Date.now()})),rt(),console.log(`Test results displayed: ${$e}/${St} (${pt}%) - ${Xt?"PASSED":"FAILED"}`)}catch($e){console.error("Error displaying test results:",$e),k("Failed to display test results")}},rt=C.useCallback(()=>{try{console.log("Setting up test results page event listeners");const Ee=St=>{if(St.key==="Escape"&&X(),St.ctrlKey&&St.key==="p"&&(St.preventDefault(),window.print()),St.key==="Enter"&&p&&!p.passed){const pt=document.getElementById("retake-test-button");pt&&pt.click()}},we=()=>{window.print()},fe=()=>{if(p){const St=`Test: ${p.testInfo?.test_name||"Test"}
Score: ${p.score}/${p.totalQuestions} (${p.percentage}%)
Status: ${p.passed?"PASSED":"FAILED"}
Completed: ${new Date(p.timestamp).toLocaleString()}`;navigator.clipboard.writeText(St).then(()=>{console.log("Results copied to clipboard")}).catch(pt=>{console.error("Failed to copy results:",pt)})}};document.addEventListener("keydown",Ee);const _e=document.getElementById("print-results");_e&&_e.addEventListener("click",we);const $e=document.getElementById("copy-results");return $e&&$e.addEventListener("click",fe),()=>{document.removeEventListener("keydown",Ee),_e&&_e.removeEventListener("click",we),$e&&$e.removeEventListener("click",fe)}}catch(Ee){console.error("Error setting up test results page event listeners:",Ee)}},[X,p]),Ie=async(Ee,we,fe)=>{try{b(!0),k(null),console.log("Viewing test details:",{testType:Ee,testId:we,testName:fe}),T({isOpen:!0,testType:Ee,testId:we,testName:fe,questions:[],isLoading:!0});const _e=await rn.getTestQuestions(Ee,we);_e&&_e.length>0?(T({isOpen:!0,testType:Ee,testId:we,testName:fe,questions:_e,isLoading:!1}),console.log(`Test details loaded: ${_e.length} questions`)):(k("Could not load test questions. Please try again."),T({isOpen:!0,testType:Ee,testId:we,testName:fe,questions:[],isLoading:!1,error:"No questions available for this test"}))}catch(_e){console.error("Error loading test details:",_e),k("Error loading test details. Please try again."),T({isOpen:!0,testType:Ee,testId:we,testName:fe,questions:[],isLoading:!1,error:_e.message||"Failed to load test details"})}finally{b(!1)}},Pe=(Ee,we,fe,_e)=>{try{console.log("Showing test details modal:",{testType:Ee,testId:we,testName:fe,questions:_e}),T({isOpen:!0,testType:Ee,testId:we,testName:fe,questions:_e||[],isLoading:!1,error:null})}catch($e){console.error("Error showing test details modal:",$e),k("Failed to show test details modal")}},Qe=()=>{try{console.log("Closing test details modal"),T({isOpen:!1,testType:null,testId:null,testName:null,questions:[],isLoading:!1,error:null})}catch(Ee){console.error("Error closing test details modal:",Ee)}},_t=(Ee,we)=>{try{switch(we){case"multiple_choice":return o.jsxs("div",{className:"answer-options",children:[o.jsx("p",{children:o.jsx("strong",{children:"Options:"})}),o.jsxs("p",{children:["A) ",Ee.option_a||"No text"]}),o.jsxs("p",{children:["B) ",Ee.option_b||"No text"]}),Ee.option_c&&o.jsxs("p",{children:["C) ",Ee.option_c]}),Ee.option_d&&o.jsxs("p",{children:["D) ",Ee.option_d]}),Ee.option_e&&o.jsxs("p",{children:["E) ",Ee.option_e]}),Ee.option_f&&o.jsxs("p",{children:["F) ",Ee.option_f]}),o.jsx("p",{className:"correct-answer",children:o.jsxs("strong",{children:["Correct Answer: ",Ee.correct_answer||"Not specified"]})})]});case"true_false":return o.jsx("div",{className:"answer-options",children:o.jsx("p",{className:"correct-answer",children:o.jsxs("strong",{children:["Correct Answer: ",Ee.correct_answer?"True":"False"]})})});case"input":return o.jsx("div",{className:"answer-options",children:o.jsx("p",{className:"correct-answer",children:o.jsxs("strong",{children:["Correct Answer: ",Ee.correct_answer||"Not specified"]})})});case"matching_type":return o.jsx("div",{className:"answer-options",children:o.jsx("p",{className:"correct-answer",children:o.jsxs("strong",{children:["Correct Answer: ",Ee.correct_answer?JSON.stringify(Ee.correct_answer):"Not specified"]})})});case"word_matching":return o.jsx("div",{className:"answer-options",children:o.jsx("p",{className:"correct-answer",children:o.jsxs("strong",{children:["Correct Answer: ",Ee.correct_answer?JSON.stringify(Ee.correct_answer):"Not specified"]})})});default:return o.jsx("p",{children:"Unknown question type"})}}catch(fe){return console.error("Error formatting question answer display:",fe),o.jsx("p",{children:"Error displaying question"})}},gt=(Ee,we)=>{try{console.log("Navigating to test:",{testType:Ee,testId:we}),r({testType:Ee,testId:we}),f(!0),Y(Ee,we)}catch(fe){console.error("Error navigating to test:",fe),k("Failed to navigate to test")}},Bt=()=>{try{console.log("Hiding test sections"),r(null),s([]),i({}),c({}),f(!1),g(null),k(null)}catch(Ee){console.error("Error hiding test sections:",Ee)}},Ut=(Ee,we,fe,_e)=>{try{console.log("Displaying test on page:",{testInfo:Ee,questions:we,testType:fe,testId:_e}),r({...Ee,testType:fe,testId:_e}),s(we),f(!0),ee(fe,_e),Kt(fe,_e),wt(fe,_e)}catch($e){console.error("Error displaying test on page:",$e),k("Failed to display test on page")}},it=(Ee,we,fe)=>{try{return console.log("Rendering questions for page:",{questions:Ee,testType:we,testId:fe}),!Ee||!Array.isArray(Ee)?(console.warn("Invalid questions array for rendering"),[]):Ee.map((_e,$e)=>{const St=pt=>{const Xt={...a,[_e.question_id]:pt};i(Xt),ie(we,fe,_e.question_id,pt)};return{question:_e,index:$e,testType:we,testId:fe,studentAnswer:a[_e.question_id]||"",onAnswerChange:St}})}catch(_e){return console.error("Error rendering questions for page:",_e),[]}},Ye=C.useCallback((Ee,we)=>{try{if(!Ee||!we){console.warn("Cannot save progress: missing testType or testId");return}const fe=`test_progress_${Ee}_${we}`,_e={answers:a,progress:l,lastSaved:Date.now(),testType:Ee,testId:we};I(fe,_e),console.log(`Progress saved for test ${Ee}_${we}:`,_e)}catch(fe){console.error("Error saving progress for page:",fe)}},[a,l,I]),xt=C.useCallback(Ee=>{try{return!a||Object.keys(a).length===0?0:Object.values(a).filter(fe=>fe==null?!1:typeof fe=="string"?fe.trim()!=="":typeof fe=="object"?Object.keys(fe).length>0:!0).length}catch(we){return console.error("Error getting answered questions count for page:",we),0}},[a]),ut=C.useCallback((Ee,we)=>{try{console.log("Updating progress display for page:",{testType:Ee,testId:we});const fe=xt(Ee),_e=n.length,$e=_e>0?Math.round(fe/_e*100):0,St=fe===_e&&_e>0;c(Yt=>({...Yt,answeredCount:fe,totalQuestions:_e,percentage:$e,canSubmit:St,remainingQuestions:_e-fe,lastUpdated:Date.now()}));const pt=document.getElementById("progress-bar"),Xt=document.getElementById("progress-text"),Jt=document.getElementById("submit-test-button");return pt&&(pt.style.width=`${$e}%`,pt.className=pt.className.replace(/bg-\w+-\d+/,""),$e>=100?pt.classList.add("bg-green-500"):$e>=80?pt.classList.add("bg-blue-500"):$e>=60?pt.classList.add("bg-yellow-500"):$e>=40?pt.classList.add("bg-orange-500"):pt.classList.add("bg-red-500")),Xt&&(Xt.textContent=`${fe}/${_e} questions answered (${$e}%)`),Jt&&(Jt.disabled=!St,St?(Jt.textContent=" Submit Test",Jt.classList.remove("bg-gray-400"),Jt.classList.add("bg-green-600","hover:bg-green-700")):(Jt.textContent=` Complete ${_e-fe} more question${_e-fe!==1?"s":""}`,Jt.classList.remove("bg-green-600","hover:bg-green-700"),Jt.classList.add("bg-gray-400"))),{answeredCount:fe,totalQuestions:_e,percentage:$e,canSubmit:St}}catch(fe){return console.error("Error updating progress display for page:",fe),{answeredCount:0,totalQuestions:0,percentage:0,canSubmit:!1}}},[n.length,xt]),wt=C.useCallback((Ee,we)=>{try{console.log("Setting up test page event listeners:",{testType:Ee,testId:we});const fe=setInterval(()=>{Object.keys(a).length>0&&(Ye(Ee,we),console.log("Auto-saved progress for test:",Ee,we))},3e4),_e=setInterval(()=>{ut(Ee,we)},2e3),$e=Yt=>{Yt.key==="Escape"&&window.confirm("Are you sure you want to exit the test? Your progress will be saved.")&&X(),Yt.ctrlKey&&Yt.key==="s"&&(Yt.preventDefault(),Ye(Ee,we),console.log("Manual save triggered")),Yt.key},St=Yt=>{Object.keys(a).length>0&&(Yt.preventDefault(),Yt.returnValue="Your test progress will be saved. Are you sure you want to leave?")},pt=()=>{document.hidden&&(console.log("Tab became hidden - saving progress"),Ye(Ee,we))},Xt=()=>{console.log("Window focused - updating progress"),ut(Ee,we)},Jt=()=>{console.log("Window blurred - saving progress"),Ye(Ee,we)};return document.addEventListener("keydown",$e),window.addEventListener("beforeunload",St),document.addEventListener("visibilitychange",pt),window.addEventListener("focus",Xt),window.addEventListener("blur",Jt),window.testIntervals||(window.testIntervals={}),window.testIntervals[`autosave_${Ee}_${we}`]=fe,window.testIntervals[`progress_${Ee}_${we}`]=_e,()=>{clearInterval(fe),clearInterval(_e),document.removeEventListener("keydown",$e),window.removeEventListener("beforeunload",St),document.removeEventListener("visibilitychange",pt),window.removeEventListener("focus",Xt),window.removeEventListener("blur",Jt),window.testIntervals&&(delete window.testIntervals[`autosave_${Ee}_${we}`],delete window.testIntervals[`progress_${Ee}_${we}`])}}catch(fe){console.error("Error setting up test page event listeners:",fe)}},[a,Ye,ut,X]),$t=C.useCallback(()=>{try{const Ee=xt(t?.testType),we=n.length,fe=Ee===we&&we>0,_e=document.getElementById("submit-test-button");return _e&&(_e.disabled=!fe,_e.textContent=fe?"Submit Test":`Complete ${we-Ee} more questions`),{canSubmit:fe,answeredCount:Ee,totalQuestions:we}}catch(Ee){return console.error("Error updating submit button state for page:",Ee),{canSubmit:!1,answeredCount:0,totalQuestions:0}}},[t,n.length,xt]),Kt=C.useCallback((Ee,we)=>{try{console.log("Setting up progress tracking for page:",{testType:Ee,testId:we});const fe=setInterval(()=>{ut(Ee,we),$t()},1e3),_e=setInterval(()=>{Object.keys(a).length>0&&Ye(Ee,we)},3e4);return window.testIntervals||(window.testIntervals={}),window.testIntervals[`progress_${Ee}_${we}`]=fe,window.testIntervals[`autosave_${Ee}_${we}`]=_e,()=>{clearInterval(fe),clearInterval(_e),window.testIntervals&&(delete window.testIntervals[`progress_${Ee}_${we}`],delete window.testIntervals[`autosave_${Ee}_${we}`])}}catch(fe){console.error("Error setting up progress tracking for page:",fe)}},[a,ut,$t,Ye]),De=C.useCallback(async(Ee,we)=>{const fe=document.getElementById("submit-test-button");try{const _e=xt(Ee),$e=n.length;if(_e<$e){k(`Please answer all ${$e} questions before submitting.`);return}if(!window.confirm("Are you sure you want to submit your test? This action cannot be undone."))return;fe&&(fe.disabled=!0,fe.innerHTML=`
          <div class="flex items-center justify-center space-x-2">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
            <span>Submitting...</span>
          </div>
        `),await B(Ee,we)&&(se(Ee,we),z(Ee,we,a),console.log("Test submitted successfully!"))}catch(_e){console.error("Error submitting test from page:",_e),k("Failed to submit test. Please try again."),fe&&(fe.disabled=!1,fe.textContent="Submit Test")}},[xt,n.length,B,se,z,a]),ct=C.useCallback(()=>{try{if(!t)return null;const Ee=["true_false","multiple_choice","input","matching_type","word_matching"];return Ee.includes(t.testType)?t.testType:Ee.includes(t.test_type)?t.test_type:null}catch(Ee){return console.error("Error getting current test type:",Ee),null}},[t]),mt=C.useCallback((Ee,we)=>{try{console.log("Clearing progress tracking interval:",{testType:Ee,testId:we});const fe=`progress_interval_${Ee}_${we}`,_e=`autosave_interval_${Ee}_${we}`;window.testIntervals&&(window.testIntervals[fe]&&(clearInterval(window.testIntervals[fe]),delete window.testIntervals[fe]),window.testIntervals[_e]&&(clearInterval(window.testIntervals[_e]),delete window.testIntervals[_e])),console.log(`Cleared progress tracking intervals for test ${Ee}_${we}`)}catch(fe){console.error("Error clearing progress tracking interval:",fe)}},[]),rr={currentTest:t,testQuestions:n,studentAnswers:a,testProgress:l,isTestActive:d,testResults:p,activeTests:y,isLoading:_,error:N,testDetailsModal:w,testStartTime:A,timeElapsed:R,loadTestForPage:Y,submitTest:B,navigateToTestResults:z,navigateBackToCabinet:U,clearTestDataAndReturnToCabinet:X,saveTestProgress:ie,getTestProgress:re,clearTestProgress:se,loadSavedProgressForPage:ee,isTestCompleted:V,markTestCompleted:q,markTestCompletedInUI:(Ee,we)=>{console.log("Marking test completed in UI:",{testType:Ee,testId:we}),q(Ee,we)},getAnsweredQuestionsCount:L,updateSubmitButtonState:M,updateSubmitButtonStateForPage:$t,loadStudentActiveTests:me,loadActiveTests:me,loadTeacherActiveTests:xe,getTestInfo:ge,getTestQuestions:Ue,createTest:Ne,deleteTest:le,showTestResults:Ge,loadTestResults:He,loadTestResultsForPage:Je,displayTestResultsOnPage:Ft,setupTestResultsPageEventListeners:rt,clearTestResultsCache:K,viewTestDetails:Ie,showTestDetailsModal:Pe,closeTestDetailsModal:Qe,getQuestionAnswerDisplay:_t,navigateToTest:gt,hideTestSections:Bt,displayTestOnPage:Ut,renderQuestionsForPage:it,setupTestPageEventListeners:wt,setupProgressTrackingForPage:Kt,updateProgressDisplayForPage:ut,submitTestFromPage:De,getAnsweredQuestionsCountForPage:xt,getCurrentTestType:ct,saveProgressForPage:Ye,clearProgressTrackingInterval:mt,collectTestAnswers:Z,calculateTestScore:Ou,checkAnswerCorrectness:f0,formatStudentAnswerForDisplay:J,getCorrectAnswer:up,transformAnswersForSubmission:ne,clearAllTestData:()=>{try{console.log("Clearing old test data from localStorage (older than 15 days)...");const we=Date.now()-360*60*60*1e3,fe=[];for(let _e=0;_e<localStorage.length;_e++){const $e=localStorage.key(_e);if(!(!$e||!(($e.startsWith("test_")||$e.startsWith("student_")||$e.startsWith("teacher_")||$e.startsWith("admin_")||$e.includes("progress")||$e.includes("answers"))&&!$e.includes("test_completed_"))))try{const pt=localStorage.getItem($e);if(!pt){fe.push($e);continue}let Xt=null;if(pt.startsWith("{")||pt.startsWith("[")){const Jt=JSON.parse(pt),Yt=Jt.timestamp||Jt.lastSaved||Jt.lastTickAt||Jt.createdAt||Jt.updatedAt||Jt.startedAt||Jt.started_at||Jt.created_at;Yt&&(Xt=new Date(Yt).getTime())}if(!Xt){const Jt=`${$e}__ts`,Yt=localStorage.getItem(Jt);Yt&&(Xt=parseInt(Yt)||null)}if(!Xt)continue;Xt<we&&fe.push($e)}catch{continue}}return fe.forEach(_e=>{console.log(`Removing old localStorage key: ${_e}`),G(_e)}),console.log(`Cleared ${fe.length} old test-related items from localStorage`),{success:!0,clearedCount:fe.length}}catch(Ee){return console.error("Error clearing old test data:",Ee),{success:!1,error:Ee.message}}},setCurrentTest:r,setTestQuestions:s,setStudentAnswers:i,setTestProgress:c,setIsTestActive:f,setTestResults:g,setError:k};return o.jsx(Bj.Provider,{value:rr,children:e})},Vp=()=>{const e=C.useContext(Bj);if(!e)throw new Error("useTest must be used within a TestProvider");return e},Kp=({testResults:e,onBackToCabinet:t,onRetakeTest:r,isLoading:n=!1,caught_cheating:s=!1,visibility_change_times:a=0})=>{if(!e||!e.showResults)return o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsx("div",{className:"text-center",children:o.jsx("p",{className:"text-gray-500",children:"No test results to display"})})});const{testInfo:i,testType:l,score:c,totalQuestions:d,percentage:f,passed:p,questionAnalysis:g,timestamp:y}=e,v=N=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[N]||N,_=N=>N>=80?"text-green-600 bg-green-50":N>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",b=N=>N?"text-green-600 bg-green-100 border-green-200":"text-red-600 bg-red-100 border-red-200";return n?o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading test results..."})]})}):o.jsx("div",{className:"bg-gray-50 py-8 overflow-y-auto",children:o.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsxs(Ze.div,{className:"bg-white rounded-lg shadow-lg p-6 mb-6",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(e?.caught_cheating||s)&&o.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mb-6",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),o.jsx("div",{className:"ml-3",children:o.jsxs("p",{className:"text-sm text-red-700",children:[o.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",e?.visibility_change_times||a||0," times during the test."]})})]})}),o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Test Results"}),o.jsx("h2",{className:"text-xl text-gray-700 mb-1",children:i?.test_name||"Test"}),o.jsxs("p",{className:"text-sm text-gray-500",children:[v(l),"  Completed on ",new Date(y).toLocaleDateString()]})]}),o.jsx("div",{className:"text-right",children:o.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium border ${b(p)}`,children:p?" PASSED":" FAILED"})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:"text-3xl font-bold text-gray-900",children:c}),o.jsx("div",{className:"text-sm text-gray-600",children:"Correct Answers"})]}),o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:"text-3xl font-bold text-gray-900",children:d}),o.jsx("div",{className:"text-sm text-gray-600",children:"Total Questions"})]}),o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:`text-3xl font-bold ${_(f).split(" ")[0]}`,children:[f,"%"]}),o.jsx("div",{className:"text-sm text-gray-600",children:"Score"})]})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-6",children:o.jsx(Ze.div,{className:`h-3 rounded-full ${_(f).split(" ")[1]}`,initial:{width:0},animate:{width:`${f}%`},transition:{duration:1,ease:"easeOut"}})}),o.jsx("div",{className:"flex flex-wrap gap-3",children:o.jsx(et,{onClick:t,variant:"primary",className:"flex items-center gap-2",children:" Back to Cabinet"})})]}),l!=="matching_type"&&l!=="word_matching"&&o.jsxs(Ze.div,{className:"bg-white rounded-lg shadow-lg p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[o.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Question Review"}),o.jsx("div",{className:"space-y-4",children:g.map((N,k)=>o.jsxs(Ze.div,{className:`p-4 rounded-lg border-2 ${N.isCorrect?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:k*.1},children:[o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:["Question ",N.questionNumber]}),o.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${N.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:N.isCorrect?" Correct":" Incorrect"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Question:"}),o.jsx("p",{className:"text-gray-700 bg-gray-100 p-3 rounded",children:N.question})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Your Answer:"}),o.jsx("p",{className:`p-3 rounded ${N.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:N.userAnswer||"No answer provided"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Correct Answer:"}),o.jsx("p",{className:"bg-blue-100 text-blue-800 p-3 rounded",children:N.correctAnswer})]})]})]},k))})]}),o.jsxs(Ze.div,{className:"bg-white rounded-lg shadow-lg p-6 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[o.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Summary Statistics"}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:g.filter(N=>N.isCorrect).length}),o.jsx("div",{className:"text-sm text-blue-600",children:"Correct"})]}),o.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-red-600",children:g.filter(N=>!N.isCorrect).length}),o.jsx("div",{className:"text-sm text-red-600",children:"Incorrect"})]}),o.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[o.jsxs("div",{className:"text-2xl font-bold text-gray-600",children:[Math.round(g.filter(N=>N.isCorrect).length/d*100),"%"]}),o.jsx("div",{className:"text-sm text-gray-600",children:"Accuracy"})]}),o.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-purple-600",children:d}),o.jsx("div",{className:"text-sm text-purple-600",children:"Total"})]})]})]})]})})},$j=({isOpen:e,onClose:t,testType:r,testId:n,testName:s,questions:a=[],isLoading:i=!1})=>{if(!e)return null;const l=p=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[p]||p,c=p=>({multiple_choice:"",true_false:"",input:"",matching_type:""})[p]||"",d=(p,g)=>{switch(g){case"multiple_choice":return o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),o.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[p.option_a&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"A"}),o.jsx("span",{className:"text-gray-700",children:p.option_a})]}),p.option_b&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"B"}),o.jsx("span",{className:"text-gray-700",children:p.option_b})]}),p.option_c&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"C"}),o.jsx("span",{className:"text-gray-700",children:p.option_c})]}),p.option_d&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"D"}),o.jsx("span",{className:"text-gray-700",children:p.option_d})]}),p.option_e&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"E"}),o.jsx("span",{className:"text-gray-700",children:p.option_e})]}),p.option_f&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),o.jsx("span",{className:"text-gray-700",children:p.option_f})]})]})]});case"true_false":return o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),o.jsxs("div",{className:"flex space-x-4",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"T"}),o.jsx("span",{className:"text-gray-700",children:"True"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),o.jsx("span",{className:"text-gray-700",children:"False"})]})]})]});case"input":return o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Answer Format:"}),o.jsx("div",{className:"bg-gray-100 p-3 rounded",children:o.jsx("span",{className:"text-gray-600 italic",children:"Type your answer in the text input field"})})]});case"matching_type":return o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Instructions:"}),o.jsx("div",{className:"bg-gray-100 p-3 rounded",children:o.jsx("span",{className:"text-gray-600 italic",children:"Match the items by connecting them with lines or selecting pairs"})})]});default:return null}},f=(p,g)=>{if(!p.correct_answer)return null;let y="";switch(g){case"multiple_choice":y=p.correct_answer.toUpperCase();break;case"true_false":y=p.correct_answer?"True":"False";break;case"input":y=p.correct_answer;break;case"matching_type":y=typeof p.correct_answer=="object"?JSON.stringify(p.correct_answer):p.correct_answer;break;default:y=String(p.correct_answer)}return o.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded",children:[o.jsx("p",{className:"font-medium text-green-800 mb-1",children:"Correct Answer:"}),o.jsx("p",{className:"text-green-700 font-mono",children:y})]})};return o.jsx(Ei,{children:o.jsxs(Ze.div,{className:"fixed inset-0 z-50 overflow-y-auto",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[o.jsx(Ze.div,{className:"fixed inset-0 bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t}),o.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:o.jsxs(Ze.div,{className:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.3},children:[o.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("span",{className:"text-2xl",children:c(r)}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s||"Test Details"}),o.jsxs("p",{className:"text-sm text-gray-600",children:[l(r),"  ",a.length," Questions"]})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(et,{onClick:()=>window.print(),variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Print"}),o.jsx(et,{onClick:t,variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Close"})]})]}),o.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:i?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading test details..."})]})}):a.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"text-6xl mb-4",children:""}),o.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Questions Available"}),o.jsx("p",{className:"text-gray-500",children:"This test doesn't have any questions yet."})]}):o.jsx("div",{className:"space-y-6",children:a.map((p,g)=>o.jsxs(Ze.div,{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:g*.1,duration:.3},children:[o.jsx("div",{className:"flex items-start justify-between mb-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full",children:["Question ",g+1]}),o.jsx("span",{className:"text-gray-500 text-sm",children:l(r)})]})}),o.jsx("div",{className:"mb-4",children:o.jsx("p",{className:"text-gray-800 font-medium text-lg leading-relaxed",children:p.question||p.question_text})}),d(p,r),f(p,r)]},p.id||p.question_id||g))})}),o.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[o.jsx("div",{className:"text-sm text-gray-600",children:a.length>0&&o.jsxs("span",{children:["Showing ",a.length," question",a.length!==1?"s":""]})}),o.jsx("div",{className:"flex items-center space-x-3",children:o.jsx(et,{onClick:t,variant:"primary",className:"flex items-center space-x-2",children:"Close"})})]})]})})]})})},GW=({answeredCount:e=0,totalQuestions:t=0,timeElapsed:r=0,onSubmitTest:n,isSubmitting:s=!1,canSubmit:a=!1,className:i=""})=>{const l=t>0?Math.round(e/t*100):0,c=t-e,d=g=>{const y=Math.floor(g/3600),v=Math.floor(g%3600/60),_=g%60;return y>0?`${y}:${v.toString().padStart(2,"0")}:${_.toString().padStart(2,"0")}`:`${v}:${_.toString().padStart(2,"0")}`},f=g=>g>=100?"bg-green-500":g>=80?"bg-blue-500":g>=60?"bg-yellow-500":g>=40?"bg-orange-500":"bg-red-500",p=g=>g>=100?"text-green-600":g>=80?"text-blue-600":g>=60?"text-yellow-600":g>=40?"text-orange-600":"text-red-600";return o.jsxs("div",{className:`bg-white rounded-lg shadow-lg p-6 ${i}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Progress"}),o.jsx("div",{className:"flex items-center space-x-4",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-2xl",children:""}),o.jsx("span",{className:"text-sm font-mono text-gray-600",children:d(r)})]})})]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),o.jsxs("span",{className:`text-sm font-semibold ${p(l)}`,children:[l,"%"]})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:o.jsx(Ze.div,{className:`h-full ${f(l)} transition-colors duration-300`,initial:{width:0},animate:{width:`${l}%`},transition:{duration:.5,ease:"easeOut"}})})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 mb-4",children:[o.jsxs("div",{className:"text-center p-2 sm:p-3 bg-blue-50 rounded-lg",children:[o.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:e}),o.jsx("div",{className:"text-xs text-blue-600",children:"Answered"})]}),o.jsxs("div",{className:"text-center p-2 sm:p-3 bg-gray-50 rounded-lg",children:[o.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-600",children:c}),o.jsx("div",{className:"text-xs text-gray-600",children:"Remaining"})]}),o.jsxs("div",{className:"text-center p-2 sm:p-3 bg-purple-50 rounded-lg",children:[o.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:t}),o.jsx("div",{className:"text-xs text-purple-600",children:"Total"})]})]}),o.jsx("div",{className:"mb-4",children:e===t?o.jsx(Ze.div,{className:"flex items-center justify-center p-3 bg-green-50 border border-green-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:o.jsx("span",{className:"text-green-600 font-medium",children:" All questions answered! Ready to submit."})}):c===1?o.jsx(Ze.div,{className:"flex items-center justify-center p-3 bg-yellow-50 border border-yellow-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:o.jsx("span",{className:"text-yellow-600 font-medium",children:"Almost there! 1 question remaining."})}):o.jsx("div",{className:"flex items-center justify-center p-3 bg-gray-50 border border-gray-200 rounded-lg",children:o.jsxs("span",{className:"text-gray-600 font-medium",children:[c," questions remaining"]})})}),a&&o.jsx("div",{className:"flex justify-center",children:o.jsx(Ze.button,{onClick:n,disabled:s,className:`px-8 py-3 rounded-lg font-semibold text-white transition-all duration-300 ${s?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 shadow-lg hover:shadow-xl"}`,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},children:s?o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),o.jsx("span",{children:"Submitting..."})]}):o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{children:""}),o.jsx("span",{children:"Submit Test"})]})})})]})},VW=({testText:e,blanks:t,separateType:r=!0,testId:n,testName:s="Unknown Test",teacherId:a="Unknown Teacher",subjectId:i,onTestComplete:l,onAnswerChange:c})=>{if(console.log(" FillBlanksTestStudent Props Debug:"),console.log("- testText:",e),console.log("- blanks:",t),console.log("- separateType:",r),console.log("- testId:",n),console.log("- testName:",s),console.log("- teacherId:",a),console.log("- subjectId:",i),!e||!t||!Array.isArray(t))return console.log(" FillBlanksTestStudent: Missing test data"),o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsx(bt,{className:"max-w-md w-full",children:o.jsxs(bt.Body,{className:"text-center",children:[o.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),o.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load fill blanks test data"}),o.jsx(et,{onClick:()=>window.history.back(),variant:"primary",children:"Back to Dashboard"})]})})});const[d,f]=C.useState({}),[p,g]=C.useState(!1),[y,v]=C.useState(null),[_,b]=C.useState(null),[N,k]=C.useState(!1),[w,T]=C.useState(null),{showNotification:A}=ja(),{makeAuthenticatedRequest:F}=Xi(),{user:R}=Hn(),{startTracking:E,stopTracking:D,getCheatingData:I,clearData:G}=Gp("fill_blanks",n,R?.student_id||R?.id);Z1();const Y=C.useCallback((se,B)=>{try{let z=se;if(typeof se=="string"&&se.startsWith("{"))try{const L=JSON.parse(se);L.root&&L.root.children&&(z=L.root.children.map(M=>M.children?M.children.map(X=>X.style&&X.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":X.text||"").join(""):"").join(" "))}catch(L){console.error("Error parsing Lexical JSON:",L)}let U=z;B.forEach((L,M)=>{const X=`[${M+1}_________]`;U=U.replace("[BLANK_PLACEHOLDER]",X)});const q=U.split(/(\[\d+_________\])/).map((L,M)=>L.match(/\[\d+_________\]/)?o.jsx("span",{className:"inline-block px-3 py-1 mx-1 bg-purple-100 text-purple-800 border-2 border-purple-400 rounded-lg font-mono font-bold shadow-sm",children:L},M):o.jsx("span",{children:L},M));return o.jsx("div",{className:"prose max-w-none mb-6",children:o.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:q})})}catch(z){return console.error("Error rendering text with blanks:",z),o.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[]),ee=C.useCallback((se,B)=>{try{let z=se;if(typeof se=="string"&&se.startsWith("{"))try{const L=JSON.parse(se);L.root&&L.root.children&&(z=L.root.children.map(M=>M.children?M.children.map(X=>X.style&&X.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":X.text||"").join(""):"").join(" "))}catch(L){console.error("Error parsing Lexical JSON:",L)}const U=[];B.forEach((L,M)=>{const X=d[L.id],K=X?L.options[X.charCodeAt(0)-65]:null,Z=K?o.jsx("span",{className:"inline-block px-3 py-2 bg-green-100 text-green-800 rounded-lg border-2 border-green-400 cursor-pointer hover:bg-green-200 hover:border-green-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>b(L.id),children:K},M):o.jsxs("span",{className:"inline-block px-3 py-2 bg-purple-100 text-purple-800 rounded-lg border-2 border-purple-400 cursor-pointer hover:bg-purple-200 hover:border-purple-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>b(L.id),children:[M+1,"_________"]},M);U.push(Z),z=z.replace("[BLANK_PLACEHOLDER]",`__BLANK_${L.id}__`)});const V=z.split(/__BLANK_\d+__/),q=[];for(let L=0;L<V.length;L++)V[L]&&q.push(o.jsx("span",{children:V[L]},`text-${L}`)),L<U.length&&q.push(U[L]);return o.jsx("div",{className:"prose max-w-none mb-6",children:o.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:q})})}catch(z){return console.error("Error rendering text with inline blanks:",z),o.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[d]),ie=C.useCallback((se,B)=>{const z={...d,[se]:B};f(z),c&&c(se,B)},[d,c]),re=C.useCallback(se=>o.jsx("div",{className:"space-y-6",children:se.map((B,z)=>{const U=B.blank_options||B.options||[];B.correct_answers;const V=B.question_json||B.question||`Blank ${z+1}`;return console.log(` Blank ${z+1} question text:`,V),o.jsxs(bt,{className:"p-4",children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",z+1]}),o.jsx("p",{className:"text-gray-600 mb-4",children:V})]}),o.jsx("div",{className:"space-y-3",children:U.filter(q=>q&&q.trim().length>0).map((q,L)=>o.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-gray-50 p-2 rounded-lg transition-colors",children:[o.jsx("input",{type:"radio",name:`blank_${B.question_id||B.id||z}`,value:String.fromCharCode(65+L),checked:d[B.question_id||B.id||z]===String.fromCharCode(65+L),onChange:M=>ie(B.question_id||B.id||z,M.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),o.jsxs("span",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+L)}),o.jsx("span",{className:"text-gray-700",children:q})]})]},L))})]},B.question_id||B.id||z)})}),[d,ie]);return C.useEffect(()=>{if(n&&R?.student_id){v(new Date),E(),console.log(" Anti-cheating tracking started for fill blanks test");const B=`test_progress_${R.student_id}_fill_blanks_${n}`,z=Rn(B);z&&(f(z.answers||{}),v(new Date(z.startTime)),console.log(" Fill blanks test progress restored:",z))}},[n,R?.student_id,t,E]),C.useEffect(()=>{if(y&&R?.student_id&&n){const se=setInterval(()=>{const B={answers:d,startTime:y.toISOString()},z=`test_progress_${R.student_id}_fill_blanks_${n}`;Dn(z,B,Bn.test_progress),console.log(" Fill blanks progress auto-saved")},3e4);return()=>clearInterval(se)}},[y,d,R?.student_id,n]),C.useEffect(()=>()=>{D(),G(),console.log(" Fill blanks test component unmounted - anti-cheating cleanup")},[D,G]),C.useCallback(async()=>{g(!0);try{const se=t.length;let B=0;t.forEach((xe,Ne)=>{const le=d[xe.id];le&&le===xe.correct_answer&&B++});const z=B,U=se;console.log(` Fill Blanks Score: ${z}/${U} (${Math.round(z/U*100)}%)`);const V=new Date,q=y?Math.round((V-y)/1e3):0,L=y?y.toISOString():V.toISOString(),M=I();console.log(" Anti-cheating data for fill blanks submission:",M);const X=R.student_id,K=`retest_assignment_id_${X}_fill_blanks_${n}`,Z=localStorage.getItem(K),J={test_id:n,test_name:s,teacher_id:a||null,subject_id:i||null,student_id:X,parent_test_id:n,retest_assignment_id:Z?Number(Z):null,answers:d,score:z,maxScore:U,time_taken:q,started_at:L,submitted_at:V.toISOString(),caught_cheating:M.caught_cheating,visibility_change_times:M.visibility_change_times};console.log(" Submitting fill blanks test:",J);const me=await(await F("/.netlify/functions/submit-fill-blanks-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)})).json();if(me.success){if(A("Test submitted successfully!","success"),D(),G(),console.log(" Anti-cheating tracking stopped and data cleared for fill blanks test"),R?.student_id&&(y0(R.student_id,"fill_blanks",n),console.log(" Fill blanks test data cleared from cache")),R?.student_id){const xe=`test_completed_${R.student_id}_fill_blanks_${n}`;localStorage.setItem(xe,"true"),console.log(" Fill blanks test marked as completed in localStorage:",xe);const Ne=`retest1_${X}_fill_blanks_${n}`;localStorage.removeItem(Ne),localStorage.removeItem(K)}if(R?.student_id){const xe=`student_results_table_${R.student_id}`;Dn(xe,me,Bn.student_results_table),console.log(" Fill blanks test results cached with key:",xe)}setShowSubmitModal(!1),setTimeout(()=>{l&&l(z)},2e3)}else throw new Error(me.message||"Failed to submit test")}catch(se){console.error("Error submitting test:",se),A("Error submitting test. Please try again.","error")}finally{g(!1)}},[d,t,n,s,a,i,y,I,D,G,F,A,l,R]),o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:o.jsxs(bt,{children:[p&&o.jsx(bt.Header,{children:o.jsx("div",{className:"flex items-center justify-center",children:o.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[o.jsx(Fr,{size:"small"}),o.jsx("span",{children:"Submitting..."})]})})}),o.jsx(bt.Body,{children:r===!0?o.jsxs(o.Fragment,{children:[Y(e,t),re(t)]}):o.jsx(o.Fragment,{children:ee(e,t)})}),r===!1&&_&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[o.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Select Answer"}),o.jsx("div",{className:"space-y-2",children:t.find(se=>se.id===_)?.options.filter(se=>se.trim().length>0).map((se,B)=>o.jsxs("button",{onClick:()=>{ie(_,String.fromCharCode(65+B)),b(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-100 rounded-lg border border-gray-200",children:[o.jsxs("span",{className:"font-semibold text-blue-600 mr-2",children:[String.fromCharCode(65+B),")"]}),se]},B))}),o.jsx("div",{className:"mt-4 flex justify-end",children:o.jsx(et,{onClick:()=>b(null),variant:"secondary",size:"sm",children:"Cancel"})})]})}),o.jsx(bt.Footer,{children:o.jsx("div",{className:"flex gap-3"})})]})})};let KW=class{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}setToken(t){localStorage.setItem(this.tokenKey,t)}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){this.setToken(t),this.setUserData({role:r}),localStorage.setItem("accessToken",t)}isAuthenticated(){const t=this.getToken();if(!t)return!1;try{const r=JSON.parse(atob(t.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const t=this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(t,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json();return this.setToken(n.accessToken),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(t){try{return JSON.parse(atob(t.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}};const h0=new KW;window.tokenManager=h0;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{h0.init()}):h0.init());const Wj=async(e,t,r,n,s)=>{try{console.log(" Fetching teacher student results:",{teacherId:e,grade:t,className:r,semester:n,academicPeriodId:s});const i=await(await h0.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-student-results?teacher_id=${e}&grade=${t}&class=${r}&semester=${n}&academic_period_id=${s}`)).json();if(i.success)return console.log(" Teacher student results loaded:",i.results.length,"results"),console.log(" Students loaded:",i.students?.length||0,"students"),{success:!0,results:i.results,students:i.students||[],count:i.results.length,student_count:i.student_count||0};throw new Error(i.error||"Failed to load teacher student results")}catch(a){return console.error("Error fetching teacher student results:",a),{success:!1,error:a.message,results:[]}}},zj=async(e,t)=>{try{console.log(" Fetching student results view:",{studentId:e,academicPeriodId:t});const r=t?`&academic_period_id=${t}`:"",s=await(await h0.makeAuthenticatedRequest(`/.netlify/functions/get-student-results-view?student_id=${e}${r}`)).json();if(s.success)return console.log(" Student results view loaded:",s.results.length,"results"),{success:!0,results:s.results,count:s.results.length};throw new Error(s.error||"Failed to load student results view")}catch(r){return console.error("Error fetching student results view:",r),{success:!1,error:r.message,results:[]}}},qW=async(e,t,r,n)=>{try{console.log(" Fetching class summary:",{teacherId:e,grade:t,className:r,academicPeriodId:n});const a=await(await h0.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary?teacher_id=${e}&grade=${t}&class=${r}&academic_period_id=${n}`)).json();if(a.success)return console.log(" Class summary loaded:",a.summary),{success:!0,summary:a.summary,hasData:!!a.summary};throw new Error(a.error||"Failed to load class summary")}catch(s){return console.error("Error fetching class summary:",s),{success:!1,error:s.message,summary:null}}},XW=async(e,t,r,n,s,a={})=>{try{const i=await Wj(e,t,r,n,s);if(!i.success)return i;let l=i.results;return a.subject&&(l=l.filter(c=>c.subject&&c.subject.toLowerCase().includes(a.subject.toLowerCase()))),a.testType&&(l=l.filter(c=>c.test_type===a.testType)),a.minScore!==void 0&&(l=l.filter(c=>c.score/c.max_score*100>=a.minScore)),a.maxScore!==void 0&&(l=l.filter(c=>c.score/c.max_score*100<=a.maxScore)),a.passed!==void 0&&(l=l.filter(c=>c.score>=c.passing_score===a.passed)),{success:!0,results:l,count:l.length,originalCount:i.results.length}}catch(i){return console.error("Error filtering teacher student results:",i),{success:!1,error:i.message,results:[]}}},YW=async(e,t,r={})=>{try{const n=await zj(e,t);if(!n.success)return n;let s=n.results;return r.subject&&(s=s.filter(a=>a.subject&&a.subject.toLowerCase().includes(r.subject.toLowerCase()))),r.testType&&(s=s.filter(a=>a.test_type===r.testType)),r.semester&&(s=s.filter(a=>a.semester===r.semester)),r.passed!==void 0&&(s=s.filter(a=>a.score>=a.passing_score===r.passed)),{success:!0,results:s,count:s.length,originalCount:n.results.length}}catch(n){return console.error("Error filtering student results view:",n),{success:!1,error:n.message,results:[]}}},JW={getTeacherStudentResults:Wj,getStudentResultsView:zj,getClassSummary:qW,getTeacherStudentResultsFiltered:XW,getStudentResultsViewFiltered:YW};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QW=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ZW=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),rN=e=>{const t=ZW(e);return t.charAt(0).toUpperCase()+t.slice(1)},Hj=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),ez=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var tz={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rz=C.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...l},c)=>C.createElement("svg",{ref:c,...tz,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:Hj("lucide",s),...!a&&!ez(l)&&{"aria-hidden":"true"},...l},[...i.map(([d,f])=>C.createElement(d,f)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P0=(e,t)=>{const r=C.forwardRef(({className:n,...s},a)=>C.createElement(rz,{ref:a,iconNode:t,className:Hj(`lucide-${QW(rN(e))}`,`lucide-${e}`,n),...s}));return r.displayName=rN(e),r};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],sz=P0("download",nz);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],iz=P0("maximize-2",az);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oz=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],lz=P0("rotate-cw",oz);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cz=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Gj=P0("x",cz);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uz=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],dz=P0("zoom-in",uz);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fz=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],hz=P0("zoom-out",fz),$o={WIDTH:1536,HEIGHT:2048,ASPECT_RATIO:1536/2048},Vj={MIN:.25,MAX:1,INITIAL:.25,STEP:.1},Dd={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",ERASER:"eraser"},nN={CURSOR_COLOR:"#ff0000",CURSOR_OPACITY:.3},sN={ERASER_TO_THICKNESS_RATIO:2.5,THICKNESS_TO_ERASER_RATIO:.4},f1={MAX_ENTRIES:10,MAX_MEMORY_KB:500,COMPRESSION_THRESHOLD:200},Kj=e=>{try{const t=JSON.stringify(e);return new Blob([t]).size/1024}catch(t){return console.warn("Error calculating memory usage:",t),0}},gz=e=>Array.isArray(e)?e.map(t=>Array.isArray(t)?mz(t):t):e,mz=e=>{if(e.length<=2)return e;const t=[e[0]],r=2;for(let n=1;n<e.length-1;n++){const s=e[n-1],a=e[n];e[n+1],Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))>r&&t.push(a)}return t.push(e[e.length-1]),t},pz=(e,t=Date.now())=>{const r=Kj(e);return{data:[...e],timestamp:t,memoryUsage:r,compressed:r>f1.COMPRESSION_THRESHOLD}},aN=(e,t,r)=>{const n=pz(t),s=Kj(t),a=e.slice(0,r+1);a.push(n);let i=a;return s>f1.MAX_MEMORY_KB&&(i=xz(a)),i.length>f1.MAX_ENTRIES&&(i=i.slice(-10)),{history:i,index:i.length-1}},xz=e=>e.map(t=>t.memoryUsage>f1.COMPRESSION_THRESHOLD?{...t,data:gz(t.data),compressed:!0}:t),iN=(e,t)=>{if(t<0||t>=e.length)return[];const r=e[t];return r?r.compressed?yz(r.data):[...r.data]:[]},yz=e=>[...e],oN=e=>e>0,lN=(e,t)=>e<t-1,vz=()=>({history:[],index:-1}),wz=()=>{const[e,t]=C.useState({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null}),[r,n]=C.useState([]),[s,a]=C.useState([]),i=C.useCallback(A=>{t(F=>({...F,...A}))},[]),l=C.useCallback(()=>{t({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null})},[]),c=C.useCallback(A=>{const F={x:A.x,y:A.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(R=>({...R,isDrawing:!0,currentLine:[F]})):["line","rectangle","circle"].includes(e.currentTool)&&t(R=>({...R,isDrawing:!0,currentShape:{type:e.currentTool,startX:A.x,startY:A.y,endX:A.x,endY:A.y,color:e.currentColor,thickness:e.currentThickness}}))},[e.currentTool,e.currentColor,e.currentThickness]),d=C.useCallback(A=>{if(!e.isDrawing)return;const F={x:A.x,y:A.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(R=>({...R,currentLine:[...R.currentLine,F]})):e.currentShape&&t(R=>({...R,currentShape:{...R.currentShape,endX:A.x,endY:A.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape]),f=C.useCallback(()=>{if(!e.isDrawing)return;let A=r;if(e.currentTool==="pencil"&&e.currentLine.length>0?(A=[...r,e.currentLine],n(A)):e.currentShape&&(A=[...r,e.currentShape],n(A)),A!==r){const F=aN(e.drawingHistory,A,e.historyIndex);t(R=>({...R,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:F.history,historyIndex:F.index}))}else t(F=>({...F,isDrawing:!1,currentLine:[],currentShape:null}))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape,r,e.drawingHistory,e.historyIndex]),p=C.useCallback(A=>Math.round(A*sN.ERASER_TO_THICKNESS_RATIO),[]),g=C.useCallback(A=>Math.round(A*sN.THICKNESS_TO_ERASER_RATIO),[]),y=C.useCallback(A=>{t(F=>({...F,currentThickness:A,eraserSize:p(A)}))},[p]),v=C.useCallback(A=>{t(F=>({...F,eraserSize:A,currentThickness:g(A)}))},[g]),_=C.useCallback(A=>{const F=aN(e.drawingHistory,A,e.historyIndex);t(R=>({...R,drawingHistory:F.history,historyIndex:F.index}))},[e.drawingHistory,e.historyIndex]),b=C.useCallback(()=>{if(oN(e.historyIndex)){const A=e.historyIndex-1,F=iN(e.drawingHistory,A);n([...F]),t(R=>({...R,historyIndex:A}))}},[e.historyIndex,e.drawingHistory]),N=C.useCallback(()=>{if(lN(e.historyIndex,e.drawingHistory.length)){const A=e.historyIndex+1,F=iN(e.drawingHistory,A);n([...F]),t(R=>({...R,historyIndex:A}))}},[e.historyIndex,e.drawingHistory]),k=C.useCallback(()=>{const A=vz();t(F=>({...F,drawingHistory:A.history,historyIndex:A.index}))},[]),w=oN(e.historyIndex),T=lN(e.historyIndex,e.drawingHistory.length);return{drawingState:e,setDrawingState:t,drawingData:r,setDrawingData:n,textBoxes:s,setTextBoxes:a,updateDrawingState:i,resetDrawingState:l,startDrawing:c,continueDrawing:d,finishDrawing:f,handleThicknessChange:y,handleEraserSizeChange:v,saveToHistoryState:_,undo:b,redo:N,clearHistoryState:k,canUndoState:w,canRedoState:T}},cN={SCALE_DELTA:.05,CENTER_DELTA:20},Vh=e=>{if(e.length<2)return 0;const t=e[0],r=e[1];return Math.sqrt(Math.pow(r.clientX-t.clientX,2)+Math.pow(r.clientY-t.clientY,2))},Tu=e=>{if(e.length<2)return null;const t=e[0],r=e[1];return{x:(t.clientX+r.clientX)/2,y:(t.clientY+r.clientY)/2}},_z=(e,t)=>{if(e.length!==2||!t)return null;const r=Vh(e),n=Vh(t),s=Tu(e),a=Tu(t);if(n===0)return null;const i=Math.abs(r/n-1),l=Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2));return i>cN.SCALE_DELTA?"zoom":l>cN.CENTER_DELTA?"pan":null},bz=e=>{let t;return function(){const r=arguments,n=this;t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{e.apply(n,r),t=null})}},Mh=(e,t)=>{const r=t.getPointerPosition();return{x:(r.x-t.x())/t.scaleX(),y:(r.y-t.y())/t.scaleY()}},uo={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",PAN:"pan"},h1={color:"#000000",thickness:2},uN=(e,t,r)=>({x:e.x,y:e.y,color:t||h1.color,thickness:r||h1.thickness}),Sz=(e,t,r,n,s)=>({type:e,startX:t.x,startY:t.y,endX:r.x,endY:r.y,color:n||h1.color,thickness:s||h1.thickness}),qj=(e,t,r,n,s,a)=>{const i=e-r,l=t-n,c=s-r,d=a-n,f=i*c+l*d,p=c*c+d*d;let g=-1;p!==0&&(g=f/p);let y,v;g<0?(y=r,v=n):g>1?(y=s,v=a):(y=r+g*c,v=n+g*d);const _=e-y,b=t-v;return Math.sqrt(_*_+b*b)},kz=(e,t)=>{if(t.length===0)return[e];const r=t.sort((a,i)=>a.index-i.index),n=[];let s=0;for(const a of r)a.index>s&&n.push(e.slice(s,a.index+1)),s=a.index+1;return s<e.length&&n.push(e.slice(s)),n.filter(a=>a.length>0)},Cz=(e,t,r,n)=>{const s=[],a=r/2;for(let i=0;i<n.length-1;i++){const l=n[i],c=n[i+1],d=qj(e,t,l.x,l.y,c.x,c.y);d<=a&&s.push({index:i,point:{x:l.x,y:l.y},distance:d})}return s},Tz=(e,t,r,n)=>{const s=Cz(t,r,n,e);return s.length===0?[e]:kz(e,s)},Ez=(e,t,r,n)=>{if(n.type==="rectangle"){const s=Math.min(n.startX,n.endX),a=Math.min(n.startY,n.endY),i=Math.abs(n.endX-n.startX),l=Math.abs(n.endY-n.startY);return e>=s&&e<=s+i&&t>=a&&t<=a+l}else if(n.type==="circle"){const s=(n.startX+n.endX)/2,a=(n.startY+n.endY)/2,i=Math.sqrt(Math.pow(n.endX-n.startX,2)+Math.pow(n.endY-n.startY,2))/2;return Math.sqrt(Math.pow(e-s,2)+Math.pow(t-a,2))<=i}return!1},dN=(e,t,r,n)=>{const s=[];for(const a of n)if(Array.isArray(a)){const i=Tz(a,e,t,r);s.push(...i)}else a.type==="line"?qj(e,t,a.startX,a.startY,a.endX,a.endY)>r/2&&s.push(a):(a.type==="rectangle"||a.type==="circle")&&(Ez(e,t,r,a)||s.push(a));return s},Nz=(e,t,r,n,s,a,i,l,c)=>{const[d,f]=C.useState({isActive:!1,type:null,lastDistance:null,lastCenter:null}),p=C.useCallback(F=>{if(F.evt.preventDefault(),F.evt.stopPropagation(),e.currentTool===uo.PAN)return;const R=F.target.getStage(),E=Mh(F,R),D=uN(E,e.currentColor,e.currentThickness);e.currentTool===uo.PENCIL?t(I=>({...I,isDrawing:!0,currentLine:[D]})):[uo.LINE,uo.RECTANGLE,uo.CIRCLE].includes(e.currentTool)&&t(I=>({...I,isDrawing:!0,currentShape:Sz(e.currentTool,E,E,e.currentColor,e.currentThickness)}))},[e.currentTool,e.currentColor,e.currentThickness,t]),g=C.useCallback(F=>{const R=dN(F.x,F.y,e.eraserSize,r);n(R),s(R)},[e.eraserSize,r,n,s]),y=C.useCallback(F=>{l&&(a(),_("Undo",F))},[l,a]),v=C.useCallback(F=>{c&&(i(),_("Redo",F))},[c,i]),_=C.useCallback((F,R)=>{const E=R.target.getStage(),D=Mh(R,E),I=new Konva.Circle({x:D.x,y:D.y,radius:20,stroke:"#4CAF50",strokeWidth:3,opacity:.8,listening:!1});E.add(I),I.to({scaleX:2,scaleY:2,opacity:0,duration:.3,onFinish:()=>{I.destroy()}})},[]),b=C.useCallback(F=>{if(F.evt.preventDefault(),F.evt.stopPropagation(),!e.isDrawing)return;const R=F.target.getStage(),E=Mh(F,R),D=uN(E,e.currentColor,e.currentThickness);e.currentTool===uo.PENCIL?t(I=>({...I,currentLine:[...I.currentLine,D]})):e.currentShape&&t(I=>({...I,currentShape:{...I.currentShape,endX:E.x,endY:E.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape,t]),N=C.useCallback(F=>{F&&F.evt&&(F.evt.preventDefault(),F.evt.stopPropagation()),e.isDrawing&&(e.currentTool===uo.PENCIL&&e.currentLine.length>0?n(R=>[...R,e.currentLine]):e.currentShape&&n(R=>[...R,e.currentShape]),t(R=>({...R,isDrawing:!1,currentLine:[],currentShape:null})))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape,n,t]),k=C.useCallback(F=>{F.evt.preventDefault(),F.evt.stopPropagation();const R=F.evt.touches;if(R.length===2)f({isActive:!0,type:"pan",lastDistance:Vh(R),lastCenter:Tu(R)});else if(R.length===1)if(e.currentTool===uo.ERASER){const E=F.target.getStage(),D=Mh(F,E);g(D)}else e.currentTool===uo.UNDO?y(F):e.currentTool===uo.REDO?v(F):p(F)},[Vh,Tu,p,e.currentTool,g,y,v]),w=C.useCallback(bz(F=>{F.evt.preventDefault(),F.evt.stopPropagation();const R=F.evt.touches;if(R.length===2&&d.isActive){const E=_z(R,d);if(E==="zoom"){const D=Vh(R),I=Tu(R),G=D/d.lastDistance,Y=Math.max(.25,Math.min(1,e.zoom*G));t(ee=>({...ee,zoom:Y,position:{x:I.x-(I.x-ee.position.x)*(Y/ee.zoom),y:I.y-(I.y-ee.position.y)*(Y/ee.zoom)}}))}else if(E==="pan"){const D=Tu(R),I=D.x-d.lastCenter.x,G=D.y-d.lastCenter.y;t(Y=>({...Y,position:{x:Y.position.x+I,y:Y.position.y+G}}))}f(D=>({...D,lastDistance:Vh(R),lastCenter:Tu(R)}))}else if(R.length===1)if(e.currentTool===uo.ERASER){const E=F.target.getStage(),D=Mh(F,E),I=dN(D.x,D.y,e.eraserSize,r);n(I)}else if(e.currentTool===uo.PAN){const E=Tu(R),D=E.x-d.lastCenter.x,I=E.y-d.lastCenter.y;t(G=>({...G,position:{x:G.position.x+D,y:G.position.y+I}})),f(G=>({...G,lastCenter:E}))}else b(F)}),[d,e.zoom,t,b]),T=C.useCallback(F=>{w(F)},[w]),A=C.useCallback(F=>{F.evt.preventDefault(),F.evt.stopPropagation();const R=F.evt.touches;R.length===0?(N(F),f({isActive:!1,type:null,lastDistance:null,lastCenter:null})):R.length===1&&f(E=>({...E,isActive:!1}))},[N]);return{handleTouchStart:k,handleTouchMove:T,handleTouchEnd:A,handleEraserStart:g,handleUndoTouch:y,handleRedoTouch:v,showTouchFeedback:_}},Az=(e,t)=>{const[r,n]=C.useState(e.MIN),[s,a]=C.useState({x:0,y:0}),i=C.useCallback((g,y,v)=>{const _=Math.max(e.MIN,Math.min(e.MAX,g));if(y){const b=_/r,N={x:y.x-(y.x-s.x)*b,y:y.y-(y.y-s.y)*b};return{zoom:_,position:N}}else{const b=t.width*_,N=t.height*_,k={x:(v.width-b)/2,y:(v.height-N)/2};return{zoom:_,position:k}}},[r,s,e,t]),l=C.useCallback(()=>{const g=Math.min(r*(1+e.STEP),e.MAX);n(g)},[r,e]),c=C.useCallback(()=>{const g=Math.max(r/(1+e.STEP),e.MIN);n(g)},[r,e]),d=C.useCallback((g,y,v)=>{const _=i(g,y,v);n(_.zoom),a(_.position)},[i]),f=C.useCallback((g,y)=>{a(v=>({x:v.x+g,y:v.y+y}))},[]),p=C.useCallback(()=>{n(e.INITIAL),a({x:0,y:0})},[e.INITIAL]);return{zoom:r,setZoom:n,position:s,setPosition:a,handleZoomIn:l,handleZoomOut:c,handleZoomToPoint:d,handlePan:f,resetZoom:p}},jz=e=>{const[t,r]=C.useState([]),[n,s]=C.useState(0),a=C.useCallback(p=>{if(console.log("parseDrawingData - input drawing:",p),console.log("parseDrawingData - drawing.answers:",p?.answers),!p?.answers)return console.log("parseDrawingData - no answers found, returning empty array"),[];try{if(typeof p.answers=="string"){console.log("parseDrawingData - parsing string answers");const g=JSON.parse(p.answers);return console.log("parseDrawingData - parsed string result:",g),g&&typeof g=="object"&&g.lines&&console.log("parseDrawingData - new format detected with lines and textBoxes"),g}if(p.answers&&typeof p.answers=="object"&&p.answers.lines)return console.log("parseDrawingData - answers is new format object"),p.answers;if(Array.isArray(p.answers)){if(console.log("parseDrawingData - answers is array"),p.answers.every(y=>typeof y=="string"))try{const y=p.answers.map(v=>{try{return JSON.parse(v)}catch{return v}});return console.log("parseDrawingData - parsed array elements"),y}catch{return console.log("parseDrawingData - failed to parse array elements, returning raw"),p.answers}return p.answers}return console.log("parseDrawingData - answers is neither string nor array, returning empty array"),[]}catch(g){return console.error("Error parsing drawing data:",g),[]}},[]),i=C.useCallback(p=>{if(console.log("processQuestions - input answers:",p),console.log("processQuestions - answers type:",typeof p),console.log("processQuestions - answers isArray:",Array.isArray(p)),p&&typeof p=="object"&&p.lines){console.log("processQuestions - new format detected with lines and textBoxes"),console.log("processQuestions - lines count:",p.lines?.length),console.log("processQuestions - textBoxes count:",p.textBoxes?.length);const y=l(p.lines);return console.log("processQuestions - canvas groups:",y),console.log("processQuestions - number of canvas groups:",y.length),y.map((v,_)=>(console.log(`processQuestions - canvas ${_} strokes:`,v),console.log(`processQuestions - canvas ${_} stroke count:`,v.length),{questionNumber:_+1,drawingData:v,textBoxes:p.textBoxes||[]}))}if(Array.isArray(p)&&p.every(y=>y&&typeof y=="object"&&y.lines))return console.log("processQuestions - array of {lines,textBoxes} detected"),p.map((y,v)=>({questionNumber:v+1,drawingData:y.lines||[],textBoxes:y.textBoxes||[]}));if(!Array.isArray(p))return console.log("processQuestions - answers is not array or object, returning empty array"),[];console.log("processQuestions - processing",p.length,"answers (old format)");const g=l(p);return console.log("processQuestions - canvas groups:",g),console.log("processQuestions - number of canvas groups:",g.length),g.map((y,v)=>(console.log(`processQuestions - canvas ${v} strokes:`,y),console.log(`processQuestions - canvas ${v} stroke count:`,y.length),{questionNumber:v+1,drawingData:y,textBoxes:[]}))},[]),l=C.useCallback(p=>{console.log("groupStrokesByCanvas - input answers:",p);const g=c(p);return console.log("groupStrokesByCanvas - using strategy:",g),g==="by_question_boundary"?d(p):g==="by_stroke_type"?f(p):[p]},[]),c=C.useCallback(p=>{console.log("determineGroupingStrategy - analyzing answers:",p);let g=0,y=0;return p.forEach(v=>{Array.isArray(v)?g++:typeof v=="object"&&y++}),console.log("determineGroupingStrategy - arrayCount:",g,"objectCount:",y),g>0&&y>0?"by_stroke_type":p.length>3?"by_question_boundary":"single_canvas"},[]),d=C.useCallback(p=>{console.log("groupByQuestionBoundary - grouping answers:",p);const g=[];let y=[];const v=Math.ceil(p.length/2);for(let _=0;_<p.length;_++)y.push(p[_]),(_+1)%v===0&&_<p.length-1&&(g.push([...y]),y=[]);return y.length>0&&g.push(y),console.log("groupByQuestionBoundary - result:",g),g},[]),f=C.useCallback(p=>{console.log("groupByStrokeType - grouping answers:",p);const g=[],y=[];p.forEach(_=>{Array.isArray(_)?g.push(_):typeof _=="object"&&y.push(_)});const v=[];return g.length>0&&v.push(g),y.length>0&&v.push(y),console.log("groupByStrokeType - result:",v),v},[]);return C.useEffect(()=>{if(e){console.log("useDataParsing - drawing object:",e),console.log("useDataParsing - drawing.answers:",e.answers),console.log("useDataParsing - drawing.answers type:",typeof e.answers),console.log("useDataParsing - drawing.answers length:",e.answers?.length);const p=a(e);console.log("useDataParsing - parsed answers:",p),console.log("useDataParsing - parsed answers type:",typeof p),console.log("useDataParsing - parsed answers length:",p?.length);const g=i(p);console.log("useDataParsing - processed questions:",g),console.log("useDataParsing - processed questions length:",g?.length),g.length>0&&(console.log("useDataParsing - first question drawingData:",g[0]?.drawingData),console.log("useDataParsing - first question drawingData length:",g[0]?.drawingData?.length)),r(g),s(0)}},[e,a,i]),{questionsData:t,setQuestionsData:r,currentQuestionIndex:n,setCurrentQuestionIndex:s,parseDrawingData:a,processQuestions:i}},fN={MIN:.25,INITIAL:1},Fz=(e,t)=>{const[r,n]=C.useState(!1),[s,a]=C.useState(null),i=C.useCallback(()=>{document.fullscreenElement||(a({zoom:e.zoom,position:{...e.position}}),document.documentElement.requestFullscreen().then(()=>{n(!0),t(c=>({...c,zoom:fN.MIN,position:{x:0,y:0},isFullscreen:!0}))}).catch(c=>{console.error("Error entering fullscreen:",c)}))},[e.zoom,e.position,t]),l=C.useCallback(()=>{document.fullscreenElement&&document.exitFullscreen().then(()=>{n(!1),s?(t(c=>({...c,zoom:s.zoom,position:s.position,isFullscreen:!1})),a(null)):t(c=>({...c,zoom:fN.INITIAL,position:{x:0,y:0},isFullscreen:!1}))}).catch(c=>{console.error("Error exiting fullscreen:",c)})},[s,t]);return{isFullscreen:r,enterFullscreen:i,exitFullscreen:l}},Xj=C.forwardRef(({drawingData:e,textBoxes:t=[],drawingState:r,canvasSize:n,zoom:s,position:a,onTouchStart:i,onTouchMove:l,onTouchEnd:c,mousePosition:d,isMouseOverCanvas:f,isEraserDrawing:p},g)=>{const y=C.useRef(null),[v,_]=C.useState(.25),[b,N]=C.useState(null),[k,w]=C.useState({x:0,y:0}),[T,A]=C.useState(!1),F=C.useCallback(({x:V,y:q,size:L,visible:M,isDrawing:X})=>!M||!V||!q?null:o.jsx(Ru,{x:V,y:q,radius:L/2,stroke:nN.CURSOR_COLOR,strokeWidth:2,dash:[5,5],opacity:X?.8:nN.CURSOR_OPACITY,listening:!1,zIndex:1e3}),[]),R=C.useCallback(V=>{if(r.currentTool===Dd.ERASER){const q=V.target.getStage(),L=Mh(V,q);w(L)}},[r.currentTool]),E=C.useCallback(()=>{r.currentTool===Dd.ERASER&&A(!0)},[r.currentTool]),D=C.useCallback(()=>{A(!1)},[]);C.useEffect(()=>{const V=g.current;if(V)return V.on("mousemove",R),V.on("mouseenter",E),V.on("mouseleave",D),()=>{V.off("mousemove",R),V.off("mouseenter",E),V.off("mouseleave",D)}},[R,E,D,g]),C.useEffect(()=>{const V=n.width??n.WIDTH,q=n.height??n.HEIGHT,L=()=>{const M=y.current;if(!M)return;const X=M.clientWidth||1,K=M.clientHeight||1,Z=Math.abs(r.rotation%180)===90,J=Z?q:V,ne=Z?V:q,me=Math.min(X/(J||1),K/(ne||1));_(Math.min(me,1))};return L(),window.addEventListener("resize",L),()=>window.removeEventListener("resize",L)},[n.width,n.height,n.WIDTH,n.HEIGHT,r.rotation]);const I=C.useMemo(()=>{const V=y.current;if(!V||!b)return 0;const q=V.clientWidth||1,L=V.clientHeight||1,M=Math.min(q/Math.max(b.width,1),L/Math.max(b.height,1));return Math.min(M,Vj.MAX)},[b]),G=C.useMemo(()=>Math.max(s,v||1),[s,v]),Y=C.useMemo(()=>{const V=n.width??n.WIDTH,q=n.height??n.HEIGHT;if(!y.current)return{x:0,y:0};const L=y.current.clientWidth||1,M=y.current.clientHeight||1,X=(L-V*G)/2,K=(M-q*G)/2;return s<=v?{x:X,y:K}:{x:a.x!==void 0?a.x:X,y:a.y!==void 0?a.y:K}},[a,s,v,G,n.width,n.height,b,I]);C.useEffect(()=>{if(!Array.isArray(e)||e.length===0){N(null);return}let V=1/0,q=1/0,L=-1/0,M=-1/0;const X=(ne,me)=>{Number.isFinite(ne)&&Number.isFinite(me)&&(ne<V&&(V=ne),me<q&&(q=me),ne>L&&(L=ne),me>M&&(M=me))};if(e.forEach(ne=>{if(Array.isArray(ne))ne.forEach(me=>X(me.x,me.y));else if(ne&&typeof ne=="object"){if(ne.type==="line")X(ne.startX,ne.startY),X(ne.endX,ne.endY);else if(ne.type==="rectangle")X(ne.startX,ne.startY),X(ne.endX,ne.endY);else if(ne.type==="circle"){const me=Math.sqrt(Math.pow(ne.endX-ne.startX,2)+Math.pow(ne.endY-ne.startY,2))/2,xe=(ne.startX+ne.endX)/2,Ne=(ne.startY+ne.endY)/2;X(xe-me,Ne-me),X(xe+me,Ne+me)}}}),!Number.isFinite(V)||!Number.isFinite(q)||!Number.isFinite(L)||!Number.isFinite(M)){N(null);return}const K=16,Z=Math.max(1,L-V+K*2),J=Math.max(1,M-q+K*2);N({minX:V-K,minY:q-K,width:Z,height:J})},[e]),C.useEffect(()=>{console.log("CanvasViewer - drawingData:",e),console.log("CanvasViewer - drawingData length:",e?.length),console.log("CanvasViewer - textBoxes:",t),console.log("CanvasViewer - textBoxes length:",t?.length),e&&e.length>0&&console.log("CanvasViewer - first item:",e[0]),t&&t.length>0&&console.log("CanvasViewer - first textBox:",t[0])},[e,t]),C.useEffect(()=>{const V=n.width??n.WIDTH,q=n.height??n.HEIGHT;console.log("CanvasViewer - canvas dimensions:",{width:V,height:q}),console.log("CanvasViewer - zoom:",s,"fitZoom:",v,"displayScale:",G),console.log("CanvasViewer - stagePosition:",Y)},[n,s,v,G,Y]);const ee=(V,q)=>{if(console.log(`CanvasViewer - rendering element ${q}:`,V),Array.isArray(V))return console.log(`CanvasViewer - rendering line with ${V.length} points`),o.jsx(Sa,{points:V.flatMap(L=>[L.x,L.y]),stroke:V[0]?.color||"#000000",strokeWidth:V[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},q);if(V.type==="line")return o.jsx(Sa,{points:[V.startX,V.startY,V.endX,V.endY],stroke:V.color,strokeWidth:V.thickness,lineCap:"round"},q);if(V.type==="rectangle"){const L=Math.abs(V.endX-V.startX),M=Math.abs(V.endY-V.startY),X=Math.min(V.startX,V.endX),K=Math.min(V.startY,V.endY);return o.jsx(la,{x:X,y:K,width:L,height:M,stroke:V.color,strokeWidth:V.thickness,fill:"transparent"},q)}else if(V.type==="circle"){const L=Math.sqrt(Math.pow(V.endX-V.startX,2)+Math.pow(V.endY-V.startY,2))/2,M=(V.startX+V.endX)/2,X=(V.startY+V.endY)/2;return o.jsx(Ru,{x:M,y:X,radius:L,stroke:V.color,strokeWidth:V.thickness,fill:"transparent"},q)}return null},ie=()=>{if(!r.isDrawing)return null;if(r.currentTool===Dd.PENCIL&&r.currentLine.length>0)return o.jsx(Sa,{points:r.currentLine.flatMap(V=>[V.x,V.y]),stroke:r.currentColor,strokeWidth:r.currentThickness,tension:.5,lineCap:"round",lineJoin:"round"});if(r.currentShape){const{type:V,startX:q,startY:L,endX:M,endY:X,color:K,thickness:Z}=r.currentShape;if(V===Dd.LINE)return o.jsx(Sa,{points:[q,L,M,X],stroke:K,strokeWidth:Z,lineCap:"round"});if(V===Dd.RECTANGLE){const J=Math.abs(M-q),ne=Math.abs(X-L),me=Math.min(q,M),xe=Math.min(L,X);return o.jsx(la,{x:me,y:xe,width:J,height:ne,stroke:K,strokeWidth:Z,fill:"transparent"})}else if(V===Dd.CIRCLE){const J=Math.sqrt(Math.pow(M-q,2)+Math.pow(X-L,2))/2,ne=(q+M)/2,me=(L+X)/2;return o.jsx(Ru,{x:ne,y:me,radius:J,stroke:K,strokeWidth:Z,fill:"transparent"})}}return null},re=r.isFullscreen?{position:"fixed",inset:0,width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",zIndex:60}:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent"},se={transform:`rotate(${r.rotation}deg)`,transformOrigin:"center center"},B=C.useCallback(V=>{V.preventDefault(),V.stopPropagation()},[]),z=C.useCallback(V=>{V.preventDefault(),V.stopPropagation()},[]),U=C.useCallback(V=>{V.preventDefault(),V.stopPropagation()},[]);return o.jsx("div",{style:{...re,touchAction:"none",WebkitTouchCallout:"none"},ref:y,className:"select-none",onTouchStart:B,onTouchMove:z,onTouchEnd:U,children:o.jsx("div",{style:{...se,touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onTouchStart:B,onTouchMove:z,onTouchEnd:U,children:o.jsx(Zd,{ref:g,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),scaleX:G,scaleY:G,x:Y.x,y:Y.y,onTouchStart:i,onTouchMove:l,onTouchEnd:c,children:o.jsxs(Qd,{children:[o.jsx(la,{x:0,y:0,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),fill:"white"}),e.map((V,q)=>(console.log(`CanvasViewer - mapping item ${q}:`,V),ee(V,q))),t&&t.map((V,q)=>o.jsx(la,{x:V.x,y:V.y,width:V.width,height:V.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}},`textbox-${q}`)),t&&t.map((V,q)=>o.jsx(jl,{x:V.x+8,y:V.y+8,width:V.width-16,height:V.height-16,text:V.text,fontSize:V.fontSize||14,fill:V.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"},`text-${q}`)),ie(),r.currentTool===Dd.ERASER&&o.jsx(F,{x:k.x,y:k.y,size:r.eraserSize,visible:T,isDrawing:p})]})})})})});Xj.displayName="CanvasViewer";function Pz({containerRef:e,canvasSize:t,rotation:r=0}){const[n,s]=C.useState(1),[a,i]=C.useState({x:0,y:0}),l=C.useRef({width:1,height:1}),c=C.useRef(.01),d=C.useRef(0),f=C.useRef(!1),p=C.useCallback(()=>{const T=t?.width??t?.WIDTH??0,A=t?.height??t?.HEIGHT??0,F=Math.abs(r%180)===90;return{width:F?A:T,height:F?T:A}},[t,r]),g=C.useCallback(()=>{const T=e?.current;if(!T)return{width:1,height:1};const A=T.clientWidth||1,F=T.clientHeight||1;return l.current={width:A,height:F},{width:A,height:F}},[e]),y=C.useCallback(()=>{const{width:T,height:A}=l.current,{width:F,height:R}=p(),E=T/Math.max(F,1),D=A/Math.max(R,1);return Math.min(E,D,1)*.98},[p]),v=C.useCallback(T=>{const{width:A,height:F}=l.current,{width:R,height:E}=p(),D=Math.max(c.current,Math.min(T,1.5));let I=(A-R*D)/2,G=(F-E*D)/2;const Y=A-R*D,ee=F-E*D;I=Math.min(Math.max(0,I),Math.max(0,Y)),G=Math.min(Math.max(0,G),Math.max(0,ee));try{console.log("[Camera] centerAtScale",{targetScale:T,clampedScale:D,container:{containerW:A,containerH:F},canvas:{canvasW:R,canvasH:E},translate:{x:I,y:G},rotation:r})}catch{}i({x:I,y:G}),s(D)},[p]),_=C.useCallback(()=>{const{width:T,height:A}=g(),{width:F,height:R}=p(),E=y();let D=(T-F*E)/2,I=(A-R*E)/2;const G=T-F*E,Y=A-R*E;D=Math.min(Math.max(0,D),Math.max(0,G)),I=Math.min(Math.max(0,I),Math.max(0,Y));try{console.log("[Camera] fitCanvas",{scale:E,container:{containerW:T,containerH:A},canvas:{canvasW:F,canvasH:R},translate:{x:D,y:I},rotation:r})}catch{}s(E),i({x:D,y:I}),c.current=E,f.current=!1},[p,g,y]),b=C.useCallback(()=>{const{width:T,height:A}=g(),{width:F,height:R}=p(),E=(T-F)/2,D=(A-R)/2;s(1),i({x:E,y:D})},[p,g]),N=C.useCallback((T,A)=>{const{width:F,height:R}=l.current,{width:E,height:D}=p(),I=Math.max(c.current,Math.min(T,1.5));if(A&&Number.isFinite(A.x)&&Number.isFinite(A.y)){const G={x:(A.x-a.x)/n,y:(A.y-a.y)/n},Y=A.x-G.x*I,ee=A.y-G.y*I;try{console.log("[Camera] zoomTo(pointer) ->",{from:n,to:I})}catch{}s(I),i({x:Y,y:ee}),d.current=Date.now()+400,f.current=!0}else{let G=(F-E*I)/2,Y=(R-D*I)/2;const ee=F-E*I,ie=R-D*I;G=Math.min(Math.max(0,G),Math.max(0,ee)),Y=Math.min(Math.max(0,Y),Math.max(0,ie));try{console.log("[Camera] zoomTo(center) ->",{from:n,to:I})}catch{}s(I),i({x:G,y:Y}),d.current=Date.now()+400,f.current=!0}},[p,n,a]),k=C.useCallback((T,A)=>{const F=n*T,{width:R,height:E}=l.current,D={x:R/2,y:E/2};N(F,A||D)},[n,N]),w=C.useCallback((T,A)=>{i(F=>({x:F.x+T,y:F.y+A})),d.current=Date.now()+200,f.current=!0},[]);return C.useEffect(()=>{const T=e?.current;if(!T)return;const A=new ResizeObserver(()=>{g();const F=y();if(c.current=F,!(Date.now()<d.current)&&!f.current){try{console.log("[Camera] resize centerAtScale",{scale:n})}catch{}v(n)}});return A.observe(T),g(),()=>A.disconnect()},[e,g,y,v,n]),C.useEffect(()=>{f.current=!1,c.current=y(),v(n)},[r,t?.width,t?.height,t?.WIDTH,t?.HEIGHT,y,v,n]),C.useMemo(()=>({scale:n,translate:a,setScale:s,setTranslate:i,centerAtScale:v,fitCanvas:_,oneToOne:b,zoomTo:N,zoomByFactor:k,panBy:w}),[n,a,v,_,b,N,k,w])}const _m=new Map,Yj=C.forwardRef(({drawingData:e,textBoxes:t=[],canvasSize:r,rotation:n=0,onScaleChange:s,persistKey:a="viewer",onTextBoxEdit:i},l)=>{const c=C.useRef(null),d=C.useRef(null),f=Pz({containerRef:c,canvasSize:r,rotation:n}),[p,g]=C.useState({width:1,height:1}),y=C.useRef(null),v=C.useRef(null),[_,b]=C.useState(null);C.useEffect(()=>{console.log("[ViewerCanvas] drawingData received:",e),console.log("[ViewerCanvas] drawingData length:",e?.length),e&&e.length>0&&console.log("[ViewerCanvas] First drawing element:",e[0]),console.log("[ViewerCanvas] textBoxes:",t),console.log("[ViewerCanvas] textBoxes length:",t?.length)},[e]),C.useEffect(()=>{typeof s=="function"&&s(f.scale);try{console.log("[ViewerCanvas] scale changed",{scale:f.scale})}catch{}if(a){const M=_m.get(a)||{};_m.set(a,{...M,scale:f.scale})}},[f.scale,s]),C.useEffect(()=>{if(a){const M=_m.get(a)||{};_m.set(a,{...M,translate:{x:f.translate.x,y:f.translate.y}})}},[a,f.translate.x,f.translate.y]),C.useImperativeHandle(l,()=>({zoomIn:M=>f.zoomByFactor(1.1,M),zoomOut:M=>f.zoomByFactor(1/1.1,M),fitCanvas:()=>f.fitCanvas(),oneToOne:()=>f.oneToOne(),getScale:()=>f.scale,getStage:()=>d.current,getPointerPosition:()=>d.current?.getPointerPosition?.(),exportPNGFullCanvas:()=>{const M=d.current;if(!M)return null;const X=r?.width??r?.WIDTH??1536,K=r?.height??r?.HEIGHT??2048,Z={scaleX:M.scaleX(),scaleY:M.scaleY(),x:M.x(),y:M.y(),width:M.width(),height:M.height()},J=y.current,ne=v.current,me=J?{x:J.x(),y:J.y(),scaleX:J.scaleX(),scaleY:J.scaleY()}:null,xe=ne?{x:ne.x(),y:ne.y(),rotation:ne.rotation()}:null;try{return M.scale({x:1,y:1}),M.position({x:0,y:0}),M.size({width:X,height:K}),J&&(J.position({x:0,y:0}),J.scale({x:1,y:1})),ne&&(ne.position({x:0,y:0}),ne.rotation(0)),M.batchDraw(),M.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:X,height:K})}finally{ne&&xe&&(ne.position({x:xe.x,y:xe.y}),ne.rotation(xe.rotation)),J&&me&&(J.position({x:me.x,y:me.y}),J.scale({x:me.scaleX,y:me.scaleY})),M.scale({x:Z.scaleX,y:Z.scaleY}),M.position({x:Z.x,y:Z.y}),M.size({width:Z.width,height:Z.height}),M.batchDraw()}}}),[f]),C.useEffect(()=>{const M=c.current;if(!M)return;const X=()=>{g({width:M.clientWidth||1,height:M.clientHeight||1})};X();const K=new ResizeObserver(X);return K.observe(M),()=>K.disconnect()},[]),C.useEffect(()=>{if(!Array.isArray(e)||e.length===0){b(null);return}let M=1/0,X=1/0,K=-1/0,Z=-1/0;const J=(Ne,le)=>{Number.isFinite(Ne)&&Number.isFinite(le)&&(Ne<M&&(M=Ne),le<X&&(X=le),Ne>K&&(K=Ne),le>Z&&(Z=le))};if(e.forEach(Ne=>{if(Array.isArray(Ne))Ne.forEach(le=>J(le.x,le.y));else if(Ne&&typeof Ne=="object"){if(Ne.type==="line")J(Ne.startX,Ne.startY),J(Ne.endX,Ne.endY);else if(Ne.type==="rectangle")J(Ne.startX,Ne.startY),J(Ne.endX,Ne.endY);else if(Ne.type==="circle"){const le=Math.hypot(Ne.endX-Ne.startX,Ne.endY-Ne.startY)/2,ge=(Ne.startX+Ne.endX)/2,Ue=(Ne.startY+Ne.endY)/2;J(ge-le,Ue-le),J(ge+le,Ue+le)}}}),!Number.isFinite(M)||!Number.isFinite(X)||!Number.isFinite(K)||!Number.isFinite(Z)){b(null);return}const ne=16,me=Math.max(1,K-M+ne*2),xe=Math.max(1,Z-X+ne*2);b({minX:M-ne,minY:X-ne,width:me,height:xe,centerX:M-ne+me/2,centerY:X-ne+xe/2})},[e]);const N=C.useMemo(()=>{if(!_)return{scale:1,x:0,y:0};const M=r?.width??r?.WIDTH??1536,X=r?.height??r?.HEIGHT??2048,K=Math.min(M/Math.max(1,_.width),X/Math.max(1,_.height),1),Z=_.width*K,J=_.height*K,ne=(M-Z)/2,me=(X-J)/2,xe=ne-_.minX*K,Ne=me-_.minY*K;return{scale:K,x:xe,y:Ne}},[_,r?.width,r?.height,r?.WIDTH,r?.HEIGHT]),k=C.useRef(!1);C.useEffect(()=>{if(k.current)return;const M=a?_m.get(a):null;M&&Number.isFinite(M.scale)&&M.translate&&Number.isFinite(M.translate.x)&&Number.isFinite(M.translate.y)?(f.setScale(M.scale),f.setTranslate(M.translate)):f.fitCanvas(),k.current=!0},[a,f]),C.useEffect(()=>{try{console.log("[ViewerCanvas] rotation changed",{rotation:n,scale:f.scale,translate:f.translate})}catch{}f.fitCanvas()},[n]),C.useEffect(()=>{f.centerAtScale(f.scale)},[n]);const w=M=>{M.evt.preventDefault();const X=d.current;if(!X)return;const K=X.getPointerPosition(),Z=Math.pow(1.0015,-M.evt.deltaY);f.zoomByFactor(Z,K)},T=C.useRef(!1),A=C.useRef({x:0,y:0}),F=C.useRef(new Set),R=C.useRef(new Map),E=C.useCallback(M=>{const X=new Set(F.current);X.add(M),F.current=X,setScale(K=>({...K}))},[]),D=C.useCallback(M=>{if(!F.current.has(M))return;const X=new Set(F.current);X.delete(M),F.current=X,setScale(K=>({...K}))},[]),I=()=>{const M=c.current;if(!M)return 1;const X=M.clientWidth||1,K=M.clientHeight||1,Z=r?.width??r?.WIDTH??1,J=r?.height??r?.HEIGHT??1,ne=Math.abs(n%180)===90,me=ne?J:Z,xe=ne?Z:J,Ne=Math.min(X/me,K/xe);return Math.min(Ne,1)},G=M=>{const X=I();f.scale<=X||(T.current=!0,A.current={x:M.evt.clientX,y:M.evt.clientY})},Y=M=>{if(!T.current)return;const X=M.evt.clientX-A.current.x,K=M.evt.clientY-A.current.y;A.current={x:M.evt.clientX,y:M.evt.clientY},f.panBy(X,K)},ee=()=>{T.current=!1},ie=1536,re=2048,se=(M,X)=>{if(console.log(`[ViewerCanvas] Rendering drawing element ${X}:`,M),Array.isArray(M))return console.log(`[ViewerCanvas] Array item with ${M.length} points:`,M.slice(0,3)),o.jsx(Sa,{points:M.flatMap(K=>[K.x,K.y]),stroke:M[0]?.color||"#000000",strokeWidth:M[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},X);if(M?.type==="line")return o.jsx(Sa,{points:[M.startX,M.startY,M.endX,M.endY],stroke:M.color,strokeWidth:M.thickness,lineCap:"round"},X);if(M?.type==="rectangle"){const K=Math.abs(M.endX-M.startX),Z=Math.abs(M.endY-M.startY),J=Math.min(M.startX,M.endX),ne=Math.min(M.startY,M.endY);return o.jsx(la,{x:J,y:ne,width:K,height:Z,stroke:M.color,strokeWidth:M.thickness,fill:"transparent"},X)}else if(M?.type==="circle"){const K=Math.sqrt(Math.pow(M.endX-M.startX,2)+Math.pow(M.endY-M.startY,2))/2,Z=(M.startX+M.endX)/2,J=(M.startY+M.endY)/2;return o.jsx(Ru,{x:Z,y:J,radius:K,stroke:M.color,strokeWidth:M.thickness,fill:"transparent"},X)}return null},B=C.useRef(new Map),z=C.useRef(null),U=C.useRef({x:0,y:0}),V=C.useCallback(M=>{const X=c.current;X&&(X.setPointerCapture?.(M.pointerId),B.current.set(M.pointerId,{x:M.clientX,y:M.clientY}),A.current={x:M.clientX,y:M.clientY})},[]),q=C.useCallback(M=>{const X=B.current;if(X.has(M.pointerId)){if(X.set(M.pointerId,{x:M.clientX,y:M.clientY}),X.size===2){const K=Array.from(X.values()),Z=K[1].x-K[0].x,J=K[1].y-K[0].y,ne=Math.hypot(Z,J),me={x:(K[0].x+K[1].x)/2,y:(K[0].y+K[1].y)/2},xe=d.current,Ne=xe&&xe.getPointerPosition()||me;if(z.current!=null){const le=ne/Math.max(1,z.current);f.zoomByFactor(le,Ne)}z.current=ne,U.current=Ne}else if(X.size===1){const K=I();if(f.scale<=K)return;const Z=M.clientX-A.current.x,J=M.clientY-A.current.y;A.current={x:M.clientX,y:M.clientY},f.panBy(Z,J)}}},[]),L=C.useCallback(M=>{const X=c.current;X&&(X.releasePointerCapture?.(M.pointerId),B.current.delete(M.pointerId),B.current.size<2&&(z.current=null),T.current=!1)},[]);return o.jsx("div",{ref:c,style:{width:"100%",height:"100%",display:"block",backgroundColor:"transparent",touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onPointerDown:V,onPointerMove:q,onPointerUp:L,children:o.jsx(Zd,{ref:d,width:p.width,height:p.height,onWheel:w,onMouseDown:G,onMouseMove:Y,onMouseUp:ee,onMouseLeave:ee,children:o.jsx(Qd,{children:o.jsx(Ko,{ref:y,x:f.translate.x,y:f.translate.y,scaleX:f.scale,scaleY:f.scale,children:(()=>{const M=(n%360+360)%360;let X=0,K=0;M===90?X=re:M===180?(X=ie,K=re):M===270&&(K=ie);try{console.log("[ViewerCanvas] rotatedGroup offset",{rotation:n,norm:M,tx:X,ty:K,canvasW:ie,canvasH:re})}catch{}return o.jsxs(Ko,{ref:v,x:X,y:K,rotation:n,children:[o.jsx(la,{x:0,y:0,width:ie,height:re,fill:"white"}),o.jsxs(Ko,{x:N.x,y:N.y,scaleX:N.scale,scaleY:N.scale,children:[Array.isArray(e)?(console.log("[ViewerCanvas] Rendering",e.length,"drawing elements"),e.map((Z,J)=>se(Z,J))):null,Array.isArray(t)&&t.map((Z,J)=>o.jsxs(Ko,{x:Z.x,y:Z.y,draggable:F.current.has(J),onPointerDown:ne=>{ne.cancelBubble=!0;const me=setTimeout(()=>{E(J)},400);R.current.set(J,me)},onPointerUp:ne=>{ne.cancelBubble=!0;const me=R.current.get(J);me&&(clearTimeout(me),R.current.delete(J)),setTimeout(()=>D(J),0)},onPointerLeave:()=>{const ne=R.current.get(J);ne&&(clearTimeout(ne),R.current.delete(J)),D(J)},onDblClick:ne=>{ne.cancelBubble=!0,typeof i=="function"&&i({index:J,textBox:Z,event:ne});try{window.dispatchEvent(new CustomEvent("drawingTextEdit",{detail:{index:J,textBox:Z}}))}catch{}},onDblTap:ne=>{ne.cancelBubble=!0,typeof i=="function"&&i({index:J,textBox:Z,event:ne});try{window.dispatchEvent(new CustomEvent("drawingTextEdit",{detail:{index:J,textBox:Z}}))}catch{}},children:[o.jsx(la,{width:Z.width,height:Z.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}}),o.jsx(jl,{text:Z.text,x:8,y:8,width:Math.max(0,(Z.width||0)-16),height:Math.max(0,(Z.height||0)-16),fontSize:Z.fontSize||14,fill:Z.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"})]},`tb-${J}`))]})]})})()})})})})});Yj.displayName="ViewerCanvas";const Rz=({zoom:e,onZoomIn:t,onZoomOut:r,onRotate:n,onDownload:s,onFullscreen:a,isFullscreen:i})=>o.jsxs("div",{className:"absolute top-4 right-4 flex flex-col space-y-2 items-center justify-center",children:[o.jsx(et,{onClick:t,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom In",children:o.jsx(dz,{className:"w-4 h-4 mx-auto my-auto"})}),o.jsx(et,{onClick:r,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom Out",children:o.jsx(hz,{className:"w-4 h-4 mx-auto my-auto"})}),o.jsx(et,{onClick:n,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Rotate",children:o.jsx(lz,{className:"w-4 h-4 mx-auto my-auto"})}),o.jsx(et,{onClick:s,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Download",children:o.jsx(sz,{className:"w-4 h-4 mx-auto my-auto"})}),o.jsx(et,{onClick:a,variant:"secondary",size:"icon",className:"w-10 h-10",title:i?"Exit Fullscreen":"Enter Fullscreen",children:i?o.jsx(Gj,{className:"w-4 h-4 mx-auto my-auto"}):o.jsx(iz,{className:"w-4 h-4 mx-auto my-auto"})})]}),Dz=({currentQuestion:e,totalQuestions:t,onPrevious:r,onNext:n,drawingDataLength:s})=>t<=1?null:o.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(et,{onClick:r,disabled:e===0,variant:"outline",size:"sm",children:"Previous"}),o.jsxs("span",{className:"text-sm text-gray-600",children:["Question ",e+1," of ",t]}),o.jsx(et,{onClick:n,disabled:e===t-1,variant:"outline",size:"sm",children:"Next"})]}),o.jsxs("div",{className:"text-sm text-gray-500",children:[s," lines"]})]})}),Jj=({drawing:e,isOpen:t,onClose:r,onScoreChange:n,onMaxScoreChange:s,isTeacherView:a=!1,onSaveScore:i})=>{const{drawingState:l,setDrawingState:c,drawingData:d,setDrawingData:f,textBoxes:p,setTextBoxes:g,saveToHistoryState:y,undo:v,redo:_,canUndoState:b,canRedoState:N}=wz(),{questionsData:k,currentQuestionIndex:w,setCurrentQuestionIndex:T}=jz(e),{zoom:A,position:F,handleZoomIn:R,handleZoomOut:E}=Az(Vj,$o),{isFullscreen:D,enterFullscreen:I,exitFullscreen:G}=Fz(l,c),{handleTouchStart:Y,handleTouchMove:ee,handleTouchEnd:ie}=Nz(l,c,d,f,y,v,_,b,N),re=C.useRef(null),se=C.useRef(null),[B,z]=C.useState(1),[U,V]=C.useState(""),[q,L]=C.useState("");C.useEffect(()=>{if(console.log("DrawingModal - questionsData:",k),console.log("DrawingModal - currentQuestionIndex:",w),k.length>0){const xe=k[w]?.drawingData||[],Ne=k[w]?.textBoxes||[];console.log("DrawingModal - setting drawingData:",xe),console.log("DrawingModal - setting textBoxes:",Ne),f(xe),g(Ne)}},[k,w,f,g]),C.useEffect(()=>{t&&e&&(V((Number.isFinite(e.score)?e.score:0).toString()),L("10"))},[t,e]);const M=()=>{w>0&&T(w-1)},X=()=>{w<k.length-1&&T(w+1)},K=()=>{b&&v()},Z=()=>{N&&_()};C.useEffect(()=>{const xe=Ne=>{(Ne.ctrlKey||Ne.metaKey)&&(Ne.key==="z"&&!Ne.shiftKey?(Ne.preventDefault(),K()):(Ne.key==="y"||Ne.key==="z"&&Ne.shiftKey)&&(Ne.preventDefault(),Z()))};return document.addEventListener("keydown",xe),()=>document.removeEventListener("keydown",xe)},[K,Z]);const J=()=>{c(xe=>({...xe,rotation:(xe.rotation+90)%360}))},ne=()=>{if(a&&se.current){const ge=se.current.exportPNGFullCanvas();if(!ge)return;const Ue=document.createElement("a");Ue.href=ge,Ue.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(Ue),Ue.click(),document.body.removeChild(Ue);return}const xe=re.current;if(!xe)return;const Ne=xe.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:$o.WIDTH,height:$o.HEIGHT}),le=document.createElement("a");le.href=Ne,le.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(le),le.click(),document.body.removeChild(le)},me=async()=>{if(!a)return r();const xe=parseInt(U,10),Ne=10;Number.isFinite(xe)&&(typeof i=="function"?await i({resultId:e.id,score:Math.max(0,Math.min(10,xe)),maxScore:Ne}):(n&&n(e.id,xe),s&&s(e.id,Ne))),r()};return!t||!e?null:o.jsx(Ei,{children:o.jsx(Ze.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,children:o.jsxs(Ze.div,{className:"bg-white rounded-lg shadow-xl max-w-4xl h-[90vh] w-full mx-4 flex flex-col select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:xe=>xe.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Drawing Submission"}),o.jsxs("p",{className:"text-sm text-gray-600",children:[e.name," ",e.surname," - ",e.test_name]})]}),o.jsx(et,{onClick:r,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-600",children:o.jsx(Gj,{className:"w-5 h-5"})})]}),k.length>1&&o.jsx(Dz,{currentQuestion:w,totalQuestions:k.length,onPrevious:M,onNext:X,drawingDataLength:k[w]?.drawingData?.length||0}),o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[o.jsxs("div",{className:"flex-1 min-h-0 relative overflow-hidden bg-gray-100 p-0 sm:p-4 select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},children:[a?o.jsx(Yj,{ref:se,drawingData:d,textBoxes:p,canvasSize:{width:$o.WIDTH,height:$o.HEIGHT,WIDTH:$o.WIDTH,HEIGHT:$o.HEIGHT},rotation:l.rotation,onScaleChange:z}):o.jsx(Xj,{ref:re,drawingData:d,textBoxes:p,drawingState:l,canvasSize:{width:$o.WIDTH,height:$o.HEIGHT,WIDTH:$o.WIDTH,HEIGHT:$o.HEIGHT},zoom:A,position:F,onTouchStart:Y,onTouchMove:ee,onTouchEnd:ie,mousePosition:{x:0,y:0},isMouseOverCanvas:!1,isEraserDrawing:!1}),o.jsx(Rz,{zoom:a?B:A,onZoomIn:()=>{if(a&&se.current){try{console.log("[ZoomButton] ZoomIn click (teacher)",{before:se.current.getScale?.()})}catch{}se.current.zoomIn(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomIn after",{after:se.current.getScale?.()})}catch{}},0)}else R()},onZoomOut:()=>{if(a&&se.current){try{console.log("[ZoomButton] ZoomOut click (teacher)",{before:se.current.getScale?.()})}catch{}se.current.zoomOut(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomOut after",{after:se.current.getScale?.()})}catch{}},0)}else E()},onRotate:J,onDownload:ne,onFullscreen:D?G:I,isFullscreen:D}),o.jsxs("div",{className:"absolute bottom-4 left-4 bg-gray-800 bg-opacity-70 text-white px-3 py-1 rounded-full text-sm",children:[Math.round((a?B:A)*100),"%"]})]}),a&&o.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Score:"}),o.jsx("input",{type:"number",min:"0",max:10,value:U,onChange:xe=>V(xe.target.value),className:"w-20 px-3 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Max:"}),o.jsx("input",{type:"number",value:10,disabled:!0,className:"w-20 px-3 py-1 text-sm border border-gray-300 rounded bg-gray-100"})]}),o.jsx(et,{onClick:me,variant:"primary",size:"sm",children:"Save"})]})})]})]})})})},Qj=({testType:e,testId:t,studentAnswers:r,onBackToCabinet:n,compact:s=!1,showAll:a=!1,onToggleShowAll:i,maxInitial:l=3})=>{const c=Ri(),{user:d,isAuthenticated:f}=Hn(),{testResults:p,loadTestResults:g}=Vp(),[y,v]=C.useState(!0),[_,b]=C.useState(""),[N,k]=C.useState([]),[w,T]=C.useState([]),[A,F]=C.useState(null),[R,E]=C.useState([]),[D,I]=C.useState(0),[G,Y]=C.useState(0),[ee,ie]=C.useState(!1),[re,se]=C.useState(null);C.useEffect(()=>{B()},[e,t]),C.useEffect(()=>{!e&&!t&&(p&&p.results?(console.log(" Using cached test results from TestContext"),T(p.results),v(!1)):U())},[e,t,p]);const B=C.useCallback(async()=>{console.log(" Initializing Student Results...");try{if(v(!0),b(""),!f||!d){console.log(" User not authenticated"),b("User not authenticated");return}if(d.role!==ui.STUDENT){console.error(" Invalid user role for student results:",d.role),b("Access denied. Student role required.");return}console.log(" Loading test results..."),await g(d?.student_id||d?.id||""),e&&t&&r&&(console.log(" Loading specific test results..."),await z(e,t,r)),console.log(" Student Results initialization complete!")}catch(Z){console.error(" Error initializing student results:",Z),b("Failed to initialize student results")}finally{v(!1)}},[f,d,e,t,r,g]),z=C.useCallback(async(Z,J,ne)=>{console.log(" Loading specific test results:",Z,J);try{const me=await rn.getTestInfo(Z,J);console.log(" Test info loaded:",me),F(me);const xe=await rn.getTestQuestions(Z,J);console.log(" Test questions loaded:",xe),E(xe);const Ne=Ou(xe,ne,Z).score,le=xe.length>0?Math.round(Ne/xe.length*100):0;I(Ne),Y(le),console.log(" Test results calculated:",{score:Ne,percentage:le})}catch(me){throw console.error(" Error loading specific test results:",me),me}},[]),U=C.useCallback(async(Z=0)=>{console.log(" Loading all student results using existing test results API...",Z>0?`(retry ${Z})`:"");try{if(!(d?.student_id||d?.sub))throw new Error("Student ID not found");const ne=await rn.getStudentTestResults();if(ne.success){console.log(" All student results loaded:",ne.results.length,"results");const me=ne.results.map(xe=>({...xe,caught_cheating:xe.caught_cheating||!1,visibility_change_times:xe.visibility_change_times||0}));T(me),se(new Date),ne.results.length===0&&Z===0&&(console.log(" No results found, retrying in 2 seconds..."),setTimeout(()=>{U(1)},2e3))}else throw new Error(ne.error||"Failed to load student results")}catch(J){console.error(" Error loading all student results:",J),b(J.message)}},[d]),V=C.useCallback(Z=>({"Listening and Speaking":"L&S","Reading and Writing":"R&W","English for Career":"Eng for Career","Science Fundamental":"Science F","Science Supplementary":"Science S","Math Fundamental":"Math F","Math Supplementary":"Math S","English for Communication":"Eng for Comm"})[Z]||Z,[]),q=C.useCallback(Z=>{if(!Z||Z.length===0)return o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:"No results available"})});const J=a?Z:Z.slice(0,l);return o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),o.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),o.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),o.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Result"}),o.jsx("th",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:J.map((ne,me)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs font-medium text-gray-900",children:o.jsx("span",{className:"bg-blue-100 text-blue-800 px-0.5 sm:px-2 py-0.5 rounded text-xs",children:V(ne.subject)})}),o.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-12 sm:max-w-none",children:ne.teacher_name}),o.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-16 sm:max-w-none",children:ne.test_name}),o.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500",children:o.jsx("div",{className:"flex flex-col items-center space-y-1",children:ne.test_type==="drawing"?ne.score!==null?o.jsxs("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${Math.round(ne.score/ne.max_score*100)>=80?"bg-green-100 text-green-800":Math.round(ne.score/ne.max_score*100)>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[ne.score,"/",ne.max_score," (",Math.round(ne.score/ne.max_score*100),"%)"]}):o.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):ne.test_type==="speaking"?ne.score!==null?o.jsxs("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${Math.round(ne.score/ne.max_score*100)>=80?"bg-green-100 text-green-800":Math.round(ne.score/ne.max_score*100)>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[ne.score,"/",ne.max_score," (",Math.round(ne.score/ne.max_score*100),"%)"]}):o.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):o.jsxs("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${Math.round(ne.score/ne.max_score*100)>=80?"bg-green-100 text-green-800":Math.round(ne.score/ne.max_score*100)>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[ne.score,"/",ne.max_score," (",Math.round(ne.score/ne.max_score*100),"%)"]})})}),o.jsx("td",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:new Date(ne.submitted_at).toLocaleDateString()})]},me))})]}),Z.length>l&&i&&o.jsx("div",{className:"text-center pt-4",children:o.jsx("button",{onClick:i,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:a?"Show Less":`Show ${Z.length-l} More`})})]})},[V,a,l,i]),L=C.useCallback((Z,J)=>{if(console.log(" formatAnswer called with:",{answer:Z,testType:J,answerType:typeof Z}),!Z)return"No answer";switch(J){case"true_false":const ne=typeof Z=="boolean"?Z:Z==="true";return console.log(" Boolean answer processed:",ne),ne?"True":"False";case"multiple_choice":return Z.toUpperCase();case"input":return Z;case"word_matching":return typeof Z=="object"?Object.entries(Z).map(([me,xe])=>`${me}  ${xe}`).join(", "):Z;case"drawing":return"Drawing submitted";default:return Z}},[]),M=C.useCallback(()=>!A||!R||!r?null:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:["Test Results: ",A.test_name||A.title||"Test"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-3xl font-bold text-blue-600",children:D}),o.jsx("p",{className:"text-sm text-gray-500",children:"Correct Answers"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-3xl font-bold text-gray-900",children:R.length}),o.jsx("p",{className:"text-sm text-gray-500",children:"Total Questions"})]}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:`text-3xl font-bold ${G>=80?"text-green-600":G>=60?"text-yellow-600":"text-red-600"}`,children:[G,"%"]}),o.jsx("p",{className:"text-sm text-gray-500",children:"Score"})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Questions Review"}),o.jsx("div",{className:"space-y-4",children:R.map((Z,J)=>{const ne=r[J],me=up(Z,e),xe=f0(Z,ne,e);return o.jsxs("div",{className:`border rounded-lg p-4 ${xe?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[o.jsxs("div",{className:"flex justify-between items-start mb-2",children:[o.jsxs("h4",{className:"font-medium text-gray-900",children:["Question ",J+1]}),o.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${xe?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:xe?"Correct":"Incorrect"})]}),o.jsx("p",{className:"text-gray-700 mb-3",children:Z.question}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Your Answer:"}),o.jsx("p",{className:"text-sm text-gray-900",children:L(ne,e)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Correct Answer:"}),o.jsx("p",{className:"text-sm text-gray-900",children:L(me,e)})]})]})]},J)})})]})]}),[A,R,r,e,D,G,up,f0,L]),X=C.useCallback(()=>{if(!w||w.length===0)return o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:"No test results available yet."})});const Z={};return w.forEach(J=>{const ne=J.subject||"Unknown Subject";Z[ne]||(Z[ne]=[]),Z[ne].push(J)}),o.jsx("div",{className:"space-y-6",children:Object.entries(Z).map(([J,ne])=>o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:J})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ne.map((me,xe)=>{const Ne=Math.round(me.score/me.max_score*100),le=Ne>=80?"text-green-600":Ne>=60?"text-yellow-600":"text-red-600";return o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:me.test_name}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:me.teacher_name||"Unknown"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:o.jsxs("span",{className:le,children:[me.score,"/",me.max_score," (",Ne,"%)"]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(me.submitted_at).toLocaleDateString()})]},xe)})})]})})]},J))})},[w]);C.useCallback(()=>{console.log(" Clearing test data and returning to cabinet..."),F(null),E([]),setStudentAnswers(null),I(0),Y(0),ie(!1),n?n():c("/student")},[n,c]);const K=C.useCallback(()=>{console.log(" Navigating back to cabinet..."),n?n():c("/student")},[n,c]);return C.useCallback((Z,J)=>{const ne={id:Date.now(),message:Z,type:J,timestamp:new Date};k(me=>[...me,ne]),setTimeout(()=>{k(me=>me.filter(xe=>xe.id!==ne.id))},Ti.NOTIFICATION_DURATION)},[]),y?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Fr,{size:"lg"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Student Results..."})]})}):_?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsx("div",{className:"text-center",children:o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[o.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),o.jsx("p",{className:"text-red-600 mb-4",children:_}),o.jsx(et,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?o.jsxs("div",{children:[y?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Fr,{size:"md"}),o.jsx("p",{className:"mt-2 text-gray-600",children:"Loading results..."})]}):_?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"text-red-500 text-4xl mb-2",children:""}),o.jsx("p",{className:"text-red-600",children:_})]}):q(w),o.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:N.map(Z=>o.jsx(Zo,{type:Z.type,message:Z.message,onClose:()=>k(J=>J.filter(ne=>ne.id!==Z.id))},Z.id))})]}):o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx("div",{className:"bg-white shadow-sm border-b",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center py-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Results"}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",re?re.toLocaleString():"Never"]})]}),o.jsxs("div",{className:"flex space-x-3",children:[A&&o.jsx(et,{variant:"outline",onClick:()=>ie(!ee),children:ee?"Hide Details":"Show Details"}),o.jsx(et,{variant:"outline",onClick:K,children:"Back to Cabinet"})]})]})})}),o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:ee&&A?M():X()}),o.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:N.map(Z=>o.jsx(Zo,{type:Z.type,message:Z.message,onClose:()=>k(J=>J.filter(ne=>ne.id!==Z.id))},Z.id))}),selectedDrawing&&o.jsx(Jj,{drawing:selectedDrawing,isOpen:isDrawingModalOpen,onClose:()=>setIsDrawingModalOpen(!1)})]})},Iz=({isMenuOpen:e,onToggleMenu:t,onShowPasswordChange:r})=>{const n=Ri(),{user:s,isAuthenticated:a,logout:i}=Hn(),{studentData:l,loadStudentData:c}=ev(),{activeTests:d,testResults:f,loadActiveTests:p,loadTestResults:g,viewTestDetails:y,testDetailsModal:v,closeTestDetailsModal:_}=Vp(),[b,N]=C.useState(!0),[k,w]=C.useState(""),[T,A]=C.useState([]),[F,R]=C.useState(null),[E,D]=C.useState(!1),[I,G]=C.useState(null),[Y,ee]=C.useState(null),[ie,re]=C.useState(new Set),[se,B]=C.useState(!1),[z,U]=C.useState(!1),[V,q]=C.useState(!1),[L,M]=C.useState(!1);C.useEffect(()=>{X()},[]),C.useEffect(()=>()=>{q(!1)},[]),C.useEffect(()=>{if(V){const ge=setTimeout(()=>{q(!1)},1e3);return()=>clearTimeout(ge)}},[V]);const X=C.useCallback(async()=>{console.log(" Initializing Student Cabinet...");try{if(N(!0),w(""),!a||!s){console.log(" User not authenticated, redirecting to login"),n("/login");return}if(s.role!==ui.STUDENT){console.error(" Invalid user role for student cabinet:",s.role),w("Access denied. Student role required.");return}console.log(" Loading student data, active tests, and results in parallel...");const ge=s?.student_id||s?.id||"";await c();try{const Ue=`student_active_tests_${ge}`,Ge=`student_results_table_${ge}`;localStorage.removeItem(Ue),localStorage.removeItem(Ge)}catch{}await Promise.all([p(ge),g(ge)]),console.log(" Calculating average score..."),await K(),console.log(" Student Cabinet initialization complete!")}catch(ge){console.error(" Error initializing student cabinet:",ge),w("Failed to initialize student cabinet")}finally{N(!1)}},[a,s,n]),K=C.useCallback(async()=>{console.log(" Calculating average score...");try{if(f&&f.length>0){const ge=f.reduce((Ge,Je)=>typeof Je.score=="number"&&typeof Je.max_score=="number"&&Je.max_score>0?Ge+Math.round(Je.score/Je.max_score*100):Ge,0),Ue=Math.round(ge/f.length);ee(Ue),console.log(" Average score calculated:",Ue)}}catch(ge){console.error(" Error calculating average score:",ge)}},[f]);C.useEffect(()=>{if(V){console.log(" Skipping completed tests initialization during navigation");return}const ge=s?.student_id||s?.id;if(!ge){console.log(" Student ID not available yet, skipping localStorage initialization");return}const Ue=new Set;for(let Ge=0;Ge<localStorage.length;Ge++){const Je=localStorage.key(Ge);if(Je&&Je.startsWith(`test_completed_${ge}_`)&&localStorage.getItem(Je)==="true"){const Ft=Je.replace(`test_completed_${ge}_`,"").split("_");if(Ft.length>=2){const rt=Ft[0],Ie=Ft.slice(1).join("_"),Pe=`${rt}_${Ie}`;Ue.add(Pe),console.log(" Found completed test in localStorage:",Pe)}}}re(Ue),M(!0),console.log(" Initialized completed tests from localStorage:",Array.from(Ue))},[s?.student_id,s?.id,V]),C.useEffect(()=>{console.log(" testResults structure:",f);const ge=f?.results||f;if(console.log(" resultsArray:",ge),ge&&ge.length>0){const Ue=s?.student_id||s?.id||"",Ge=new Set;ge.forEach(Je=>{const He=`${Je.test_type}_${Je.test_id}`;Ge.add(He),localStorage.setItem(`test_completed_${Ue}_${Je.test_type}_${Je.test_id}`,"true")}),re(Je=>{const He=new Set([...Je,...Ge]);return console.log(" Updated completed tests (merged):",Array.from(He)),He})}},[f,s?.student_id,s?.id]);const Z=C.useCallback(async(ge,Ue,Ge=!1,Je=null)=>{console.log(" Checking test completion:",ge,Ue,"retestAvailable:",Ge);try{const He=s?.student_id||s?.id||"";if(Ge){console.log(" Retest available from backend, checking attempt limits.");const Pe=[];for(let gt=1;gt<=10;gt++){const Bt=`retest_attempt${gt}_${He}_${ge}_${Ue}`;localStorage.getItem(Bt)==="true"&&Pe.push(Bt)}const Qe=Pe.length,_t=Je?.retest_attempts_left||Je?.max_attempts||3;return console.log(" Current attempts:",Qe,"Max attempts:",_t,"Attempt keys:",Pe),Qe>=_t?(console.log(" Maximum retest attempts reached in localStorage"),!0):(console.log(" Retest attempts available, allowing start."),!1)}const Ft=`test_completed_${He}_${ge}_${Ue}`,rt=localStorage.getItem(Ft);if(console.log(" localStorage key:",Ft),console.log(" localStorage value:",rt),ge==="word_matching"){console.log(" Debug: All localStorage keys for student",He);for(let Pe=0;Pe<localStorage.length;Pe++){const Qe=localStorage.key(Pe);Qe&&Qe.includes(He)&&Qe.includes("word_matching")&&console.log(" Found word_matching key:",Qe,"=",localStorage.getItem(Qe))}}if(rt==="true")return console.log(" Found completion status in local storage:",rt),!0;const Ie=f?.results||f;return Ie&&Ie.length>0&&(console.log(" Checking database results:",Ie.length,"results"),Ie.some(Qe=>(console.log(" Checking result:",Qe.test_type,Qe.test_id,"vs",ge,Ue),Qe.test_type===ge&&Qe.test_id===Ue)))?(console.log(" Found completion status in database results"),localStorage.setItem(Ft,"true"),!0):(console.log(" Test not completed according to local storage or database"),!1)}catch(He){return console.error(" Error checking test completion:",He),!1}},[f,s?.student_id,s?.id]),J=C.useCallback((ge,Ue)=>{const Ge={id:Date.now(),message:ge,type:Ue,timestamp:new Date};A(Je=>[...Je,Ge]),setTimeout(()=>{A(Je=>Je.filter(He=>He.id!==Ge.id))},Ti.NOTIFICATION_DURATION)},[]),ne=C.useCallback(async ge=>{console.log(" Showing test details:",ge);try{await y(ge.test_type,ge.test_id,ge.test_name)}catch(Ue){console.error("Error loading test details:",Ue),J("Failed to load test details","error")}},[y,J]),me=C.useCallback(ge=>{console.log(" Starting test:",ge);const Ue=`${ge.test_type}_${ge.test_id}`;if(ie.has(Ue)&&!ge?.retest_available){J("This test has already been completed","warning");return}if(console.log(" Checking retest conditions:"),console.log(" test.retest_available:",ge?.retest_available),console.log(" testKey:",Ue),console.log(" completedTests.has(testKey):",ie.has(Ue)),console.log(" completedTests:",Array.from(ie)),ge?.retest_available){const Ge=s?.student_id||s?.id||"",Je=`retest1_${Ge}_${ge.test_type}_${ge.test_id}`;if(localStorage.setItem(Je,"true"),console.log(" Set retest key:",Je),console.log(" Test retest_assignment_id:",ge.retest_assignment_id),console.log(" Test retest_assignment_id type:",typeof ge.retest_assignment_id),ge?.retest_assignment_id){const He=`retest_assignment_id_${Ge}_${ge.test_type}_${ge.test_id}`;localStorage.setItem(He,String(ge.retest_assignment_id)),console.log(" Set retest assignment ID:",He,"=",ge.retest_assignment_id)}else console.log(" No retest assignment ID found in test data")}else console.log(" Retest assignment ID storage skipped - retest not available");if(q(!0),console.log(" Set isStartingTest to true for test:",ge.test_type),ge.test_type==="matching_type"){console.log(" Redirecting to matching test page for testId:",ge.test_id),n(`/student/matching-test/${ge.test_id}`);return}if(ge.test_type==="word_matching"){console.log(" Redirecting to word matching test page for testId:",ge.test_id),n(`/student/word-matching-test/${ge.test_id}`);return}if(ge.test_type==="speaking"){console.log(" Redirecting to speaking test page for testId:",ge.test_id),n(`/student/speaking-test/${ge.test_id}`);return}n(`/student/test/${ge.test_type}/${ge.test_id}`)},[n,ie,J,s?.student_id,s?.id]),xe=C.useCallback(()=>{B(ge=>!ge)},[]),Ne=C.useCallback(()=>{U(ge=>!ge)},[]),le=C.useCallback(async ge=>{if(console.log(" Starting test:",ge),V){console.log(" Test already starting, ignoring click");return}try{if(await Z(ge.test_type,ge.test_id,ge?.retest_available,ge)&&!ge?.retest_available){J("This test has already been completed","warning");return}me(ge)}catch(Ue){console.error(" Error starting test:",Ue),J("Failed to start test. Please try again.","error")}},[Z,me,J,V]);return C.useCallback(ge=>{console.log(" Viewing test details:",ge),ne(ge)},[ne]),b?o.jsx(Ze.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:o.jsxs(Ze.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[o.jsx(Fr,{size:"lg"}),o.jsx(Ze.p,{className:"mt-4 text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.3},children:"Loading Student Cabinet..."})]})}):k?o.jsx(Ze.div,{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:o.jsx(Ze.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:o.jsxs(Ze.div,{className:"bg-white border border-red-200 rounded-xl p-8 max-w-md shadow-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,duration:.3},children:[o.jsx(Ze.div,{className:"text-4xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.3,type:"spring"},children:""}),o.jsx("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Cabinet Error"}),o.jsx("p",{className:"text-red-600 mb-6",children:k}),o.jsx(et,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):o.jsxs(Ze.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[o.jsx(Ze.div,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center py-6",children:[o.jsxs(Ze.div,{className:"flex items-center space-x-4",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(Ze.div,{className:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:o.jsx("span",{className:"text-white font-semibold text-xl",children:s?.name?.charAt(0)||"S"})})}),o.jsxs("div",{children:[o.jsxs("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold text-white",children:[s?.name," ",s?.surname]}),o.jsxs("p",{className:"text-blue-100 text-sm sm:text-base md:text-lg",children:["Grade ",s?.grade," - Class ",s?.class]})]})]}),o.jsxs(Ze.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[o.jsxs("button",{onClick:t,className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",style:{zIndex:1e3},children:[o.jsx("span",{className:"hidden sm:inline",children:"Menu"}),o.jsx(Ze.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:e?180:0},transition:{duration:.2},children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),o.jsx(Ei,{children:e&&o.jsx(Ze.div,{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:o.jsxs("div",{className:"py-2",children:[o.jsx(Ze.button,{onClick:r,className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),o.jsx(Ze.button,{onClick:()=>{t(),i()},className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),o.jsxs(Ze.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:[o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:o.jsx("div",{className:"lg:col-span-1 space-y-6",children:Y!==null&&o.jsx(Ze.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7,duration:.5},children:o.jsxs(bt,{children:[o.jsx(bt.Header,{children:o.jsx(bt.Title,{children:"Average Score"})}),o.jsx(bt.Body,{children:o.jsxs(Ze.div,{className:"text-center",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.8,duration:.3},children:[o.jsxs(Ze.div,{className:"text-4xl font-bold text-blue-600 mb-2",initial:{scale:0},animate:{scale:1},transition:{delay:.9,duration:.5,type:"spring"},children:[Y,"%"]}),o.jsx("p",{className:"text-sm text-gray-500",children:"Overall Performance"})]})})]})})})}),o.jsxs("div",{className:"space-y-6",children:[o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:o.jsxs(bt,{children:[o.jsx(bt.Header,{children:o.jsx(bt.Title,{className:"text-center",children:"Active Tests"})}),o.jsx(bt.Body,{children:d&&d.length>0?o.jsxs("div",{className:"relative",children:[console.log(" Rendering overlay, isStartingTest:",V),V&&o.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50 rounded-lg border-2 border-blue-200",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Starting test..."}),o.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait..."})]})}),o.jsxs("div",{className:"space-y-4",children:[(se?d:d.slice(0,3)).map((ge,Ue)=>o.jsx(Ze.div,{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:se?0:.7+Ue*.1,duration:.3},whileHover:{scale:1.02},children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsx("div",{className:"flex-1",children:o.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[o.jsx("h3",{className:"text-sm sm:text-lg font-medium text-gray-900 w-16 sm:w-auto break-words leading-tight line-clamp-2 sm:line-clamp-none",children:ge.test_name}),o.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:ge.subject}),o.jsx("span",{className:"text-gray-500",children:ge.teacher_name}),o.jsxs("span",{className:"text-gray-500",children:[o.jsx("span",{className:"sm:hidden",children:new Date(ge.assigned_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}),o.jsx("span",{className:"hidden sm:inline",children:new Date(ge.assigned_at).toLocaleDateString()})]})]})}),o.jsx("div",{className:"flex space-x-2 ml-4",children:(()=>{const Ge=`${ge.test_type}_${ge.test_id}`,Je=ie.has(Ge);return L?Je&&ge?.retest_available?o.jsx(et,{variant:"primary",size:"sm",onClick:()=>le(ge),disabled:V,children:"Start Retest"}):Je?o.jsx(et,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):(console.log(" Button render, isStartingTest:",V,"test:",ge.test_type),o.jsx(et,{variant:"primary",size:"sm",onClick:()=>le(ge),disabled:V,children:"Start Test"})):o.jsx(et,{variant:"secondary",size:"sm",disabled:!0,className:"bg-gray-100 text-gray-500 border-gray-200",children:"Loading..."})})()})]})},`${ge.test_type}_${ge.test_id}`)),d.length>3&&o.jsx("div",{className:"text-center pt-2",children:o.jsx("button",{onClick:xe,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:se?"Show Less":`Show ${d.length-3} More`})})]})]}):o.jsxs(Ze.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.3},children:[o.jsx(Ze.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.8,duration:.5,type:"spring"},children:""}),o.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Active Tests"}),o.jsx("p",{className:"text-gray-500",children:"No active tests available for your class at the moment."})]})})]})}),o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:o.jsxs(bt,{children:[o.jsx(bt.Header,{children:o.jsx(bt.Title,{children:"Test Results"})}),o.jsx(bt.Body,{children:f&&f.showResults?o.jsx(Kp,{testResults:f,onBackToCabinet:()=>{setTestResults(null)},onRetakeTest:(ge,Ue)=>{p(),setTestResults(null)},isLoading:b}):o.jsx(Qj,{compact:!0,showAll:z,onToggleShowAll:Ne,maxInitial:3})})]})})]})]}),o.jsx($j,{isOpen:v.isOpen,onClose:_,testType:v.testType,testId:v.testId,testName:v.testName,questions:v.questions||[],isLoading:v.isLoading||!1}),o.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:T.map(ge=>o.jsx(Zo,{type:ge.type,message:ge.message,onClose:()=>A(Ue=>Ue.filter(Ge=>Ge.id!==ge.id))},ge.id))})]})},Mz=({testInfo:e,questions:t,testType:r,studentAnswers:n,onBackToCabinet:s,checkAnswerCorrectness:a,formatStudentAnswerForDisplay:i,getCorrectAnswer:l})=>{const[c,d]=C.useState(0),[f,p]=C.useState(0),[g,y]=C.useState(!0);if(C.useEffect(()=>{const b=()=>{try{const N=Ou(t,n,r).score,k=e?.num_questions||t?.length||0,w=k>0?Math.round(N/k*100):0;d(N),p(w),y(!1)}catch(N){console.error("Error calculating test results:",N),d(0),p(0),y(!1)}};t&&t.length>0?b():y(!1)},[t,n,r,e,Ou]),g)return o.jsx("div",{className:"flex justify-center items-center min-h-64",children:o.jsx("div",{className:"text-lg",children:"Calculating results..."})});const v=e?.num_questions||t?.length||0,_=e?.test_name||e?.title||"Test";return o.jsxs("div",{className:"test-results-page max-w-4xl mx-auto p-6 overflow-y-auto min-h-screen",children:[o.jsx(bt,{className:"mb-6",children:o.jsxs("div",{className:"results-header text-center",children:[o.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:["Test Results: ",_]}),o.jsx("p",{className:"text-gray-600",children:r==="matching_type"?"Matching Test":r==="multiple_choice"?"Multiple Choice Test":r==="true_false"?"True/False Test":r==="input"?"Input Test":r==="drawing"?"Drawing Test":"Test"})]})}),o.jsx(bt,{className:"mb-6",children:o.jsxs("div",{className:"results-summary",children:[o.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 text-center",children:["Your Score: ",c," / ",v," (",f,"%)"]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-4",children:o.jsx("div",{className:`h-4 rounded-full transition-all duration-500 ${f>=80?"bg-green-500":f>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${f}%`}})}),o.jsx("div",{className:"text-center",children:o.jsx("p",{className:`text-lg font-medium ${f>=80?"text-green-600":f>=60?"text-yellow-600":"text-red-600"}`,children:f>=80?"Excellent!":f>=60?"Good job!":"Keep practicing!"})})]})}),t&&t.length>0&&o.jsx(bt,{className:"mb-6",children:o.jsxs("div",{className:"questions-review",children:[o.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Question Review"}),o.jsx("div",{className:"space-y-4",children:t.map((b,N)=>{const k=n[String(b.question_id)]||"No answer";console.log(" TestResultsDisplay - Question",N+1,":",{question:b,studentAnswer:k,testType:r});const w=a(b,k,r);return console.log(" TestResultsDisplay - isCorrect result:",w),o.jsxs("div",{className:`question-review p-4 rounded-lg border-2 ${w?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[o.jsxs("div",{className:"question-review-header flex justify-between items-start mb-3",children:[o.jsxs("h4",{className:"text-lg font-medium text-gray-800",children:["Question ",N+1]}),o.jsx("span",{className:`text-2xl font-bold ${w?"text-green-600":"text-red-600"}`,children:w?"":""})]}),o.jsx("div",{className:"question-text mb-3",children:o.jsx("p",{className:"text-gray-700 font-medium",children:b.question})}),o.jsxs("div",{className:"answer-section space-y-2",children:[o.jsxs("p",{className:"student-answer",children:[o.jsx("strong",{className:"text-gray-600",children:"Your Answer:"})," ",o.jsx("span",{className:`font-medium ${w?"text-green-700":"text-red-700"}`,children:i(k,r,b)})]}),!w&&o.jsxs("p",{className:"correct-answer",children:[o.jsx("strong",{className:"text-gray-600",children:"Correct Answer:"})," ",o.jsx("span",{className:"text-green-700 font-medium",children:r==="multiple_choice"?String(b.correct_answer||"").toUpperCase():i(l(b,r),r,b)})]})]})]},b.question_id||N)})})]})}),o.jsx(bt,{children:o.jsx("div",{className:"results-actions text-center",children:o.jsx(et,{onClick:s,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 text-lg font-medium",children:"Back to Cabinet"})})})]})},Oz=({onBackToCabinet:e,currentTest:t})=>{const r=Ri(),{user:n,isAuthenticated:s}=Hn(),{activeTests:a,loadActiveTests:i}=Vp(),l=C.useCallback((De,ct,mt)=>{try{const Lt=`test_progress_${n?.student_id||n?.id||"unknown"}_${De}_${ct}`;localStorage.setItem(Lt,JSON.stringify(mt)),console.log(`Saved test progress for ${De}_${ct}:`,mt)}catch(At){console.error("Error saving test progress:",At)}},[n?.student_id,n?.id]),c=C.useCallback((De,ct)=>{try{const At=`test_progress_${n?.student_id||n?.id||"unknown"}_${De}_${ct}`,Lt=localStorage.getItem(At);return Lt?JSON.parse(Lt):null}catch(mt){return console.error("Error getting test progress:",mt),null}},[n?.student_id,n?.id]),d=C.useCallback((De,ct)=>{try{const mt=n?.student_id||n?.id||"unknown",At=`test_progress_${mt}_${De}_${ct}`;localStorage.removeItem(At);for(let Lt=0;Lt<localStorage.length;Lt++){const rr=localStorage.key(Lt);rr&&rr.startsWith(`test_progress_${mt}_${De}_${ct}_`)&&(localStorage.removeItem(rr),console.log(` Cleared individual question key: ${rr}`))}console.log(`Cleared test progress for ${De}_${ct}`)}catch(mt){console.error("Error clearing test progress:",mt)}},[n?.student_id,n?.id]),[f,p]=C.useState(!0),[g,y]=C.useState(!1),[v,_]=C.useState(""),[b,N]=C.useState(!1),[k,w]=C.useState(""),[T,A]=C.useState([]),[F,R]=C.useState(t?"test":"list"),[E,D]=C.useState(null),[I,G]=C.useState(null),[Y,ee]=C.useState(null),[ie,re]=C.useState([]),[se,B]=C.useState([]),[z,U]=C.useState(0),[V,q]=C.useState(0),[L,M]=C.useState(null),X=us.useRef(null),K=us.useRef(null),[Z,J]=C.useState(!1),[ne,me]=C.useState(!1),[xe,Ne]=C.useState(null),[le,ge]=C.useState(null),{startTracking:Ue,stopTracking:Ge,getCheatingData:Je,clearData:He,isCheating:Ft,tabSwitches:rt}=Gp(E?.test_type,E?.test_id,n?.student_id||n?.id);C.useEffect(()=>{(()=>{const ct=[];for(let mt=0;mt<localStorage.length;mt++){const At=localStorage.key(mt);if(At&&At.startsWith("test_progress_")&&!At.includes("_51712_")&&!At.includes("_51736_")){const Lt=At.split("_");Lt.length===4&&Lt[0]==="test"&&Lt[1]==="progress"&&ct.push(At)}}ct.forEach(mt=>{localStorage.removeItem(mt),console.log(" Cleared old cache key:",mt)})})()},[]),C.useEffect(()=>{Ie()},[]),C.useEffect(()=>{t&&(console.log(" Auto-starting test from prop:",t),N(!0),_t(t))},[t]);const Ie=C.useCallback(async()=>{console.log(" Initializing Student Tests...");try{if(p(!0),w(""),!s||!n){console.log(" User not authenticated"),w("User not authenticated");return}if(n.role!==ui.STUDENT){console.error(" Invalid user role for student tests:",n.role),w("Access denied. Student role required.");return}console.log(" Loading active tests..."),await i(),console.log(" Student Tests initialization complete!")}catch(De){console.error(" Error initializing student tests:",De),w("Failed to initialize student tests")}finally{p(!1)}},[s,n,i]);C.useCallback(async()=>{console.log(" Loading student active tests...");try{const De=await rn.getActiveTests();console.log(" Active tests loaded:",De);const ct=De.map(mt=>({...mt,subject_id:mt.subject_id||mt.subjectId,teacher_id:mt.teacher_id||mt.teacherId,is_active:mt.is_active!==void 0?mt.is_active:!0,created_at:mt.created_at||mt.createdAt,updated_at:mt.updated_at||mt.updatedAt}));return ge(new Date),ct}catch(De){throw console.error(" Error loading active tests:",De),De}},[]),C.useCallback(async(De,ct)=>{console.log(" Checking test completion:",De,ct);try{const mt=c(De,ct);return mt&&mt.completed}catch(mt){return console.error(" Error checking test completion:",mt),!1}},[c]),C.useEffect(()=>{if(ie.length>0&&E?.test_id){const De=setTimeout(()=>{let ct=!1;const mt=new Array(ie.length).fill("");if(ie.forEach((At,Lt)=>{const Ee=`test_progress_${n?.student_id||n?.id||"unknown"}_${I}_${E?.test_id}_${At.question_id}`,we=localStorage.getItem(Ee);if(we){const fe=we.replace(/^"(.*)"$/,"$1");mt[Lt]=fe,ct=!0}}),ct){B(mt);const At=mt.filter(rr=>rr&&typeof rr=="string"&&rr.trim()!=="").length,Lt=ie.length>0?At/ie.length*100:0;U(Lt)}},100);return()=>clearTimeout(De)}},[ie,I,E?.test_id]);const Pe=C.useCallback(async(De,ct)=>{console.log(" Marking test as completed:",De,ct);try{const mt=c(De,ct)||{};mt.completed=!0,mt.completedAt=new Date().toISOString(),l(De,ct,mt);const Lt=`test_completed_${n?.student_id||n?.id||""}_${De}_${ct}`;localStorage.setItem(Lt,"true"),console.log(" Test completion marked in localStorage:",Lt),console.log(" localStorage value after setting:",localStorage.getItem(Lt)),xt("Test marked as completed","success")}catch(mt){console.error(" Error marking test as completed:",mt),xt("Failed to mark test as completed","error")}},[c,l]),Qe=C.useCallback(De=>{console.log(" Showing test details:",De),Ne(De),me(!0)},[]),_t=C.useCallback(async De=>{console.log(" Starting test:",De);let ct=Date.now(),mt;try{_(""),y(!0),ct=Date.now();const At=()=>{const xr=Date.now()-ct,Mr=Math.max(0,250-xr);setTimeout(()=>{p(!1),y(!1)},Mr)};let Lt=!1;mt=setTimeout(()=>{Lt=!0,_("Loading is taking longer than expected...")},15e3);const Ee=`test_completed_${n?.student_id||n?.id||""}_${De.test_type}_${De.test_id}`,we=localStorage.getItem(Ee)==="true";if(we&&!De?.retest_available){console.log(" Test already completed, redirecting to main cabinet"),xt("This test has already been completed","info"),r("/student");return}if(we&&De?.retest_available&&console.log(" Test completed but retest available, allowing retest"),De.test_type===pn.MATCHING){console.log(" Redirecting to matching test page for testId:",De.test_id),r(`/student/matching-test/${De.test_id}`);return}if(De.test_type===pn.WORD_MATCHING){console.log(" Redirecting to word matching test page for testId:",De.test_id),r(`/student/word-matching-test/${De.test_id}`);return}D(De),G(De.test_type);const[fe,_e]=await Promise.all([rn.getTestInfo(De.test_type,De.test_id),rn.getTestQuestions(De.test_type,De.test_id)]);ee(fe);let $e=_e;try{if(!!fe?.is_shuffled){const Tr=n?.student_id||n?.id||"unknown",Mr=`${Tr}:${De.test_type}:${De.test_id}`,Wr=Array.from(Mr).reduce((pe,ve)=>(pe<<5)-pe+ve.charCodeAt(0),0)>>>0,ce=`test_shuffle_order_${Tr}_${De.test_type}_${De.test_id}`,Se=localStorage.getItem(ce);if(Se){const pe=JSON.parse(Se),ve=new Map(_e.map(be=>[be.question_id,be]));$e=pe.map(be=>ve.get(be)).filter(Boolean)}else{const ve=function(ke){return function(){var We=ke+=1831565813;return We=Math.imul(We^We>>>15,We|1),We^=We+Math.imul(We^We>>>7,We|61),((We^We>>>14)>>>0)/4294967296}}(Wr);$e=[..._e];for(let ke=$e.length-1;ke>0;ke--){const We=Math.floor(ve()*(ke+1));[$e[ke],$e[We]]=[$e[We],$e[ke]]}const be=$e.map(ke=>ke.question_id);localStorage.setItem(ce,JSON.stringify(be))}}}catch(xr){console.error("Shuffle error (ignored):",xr)}re($e),At();let pt=c(De.test_type,De.test_id)?.answers||new Array(_e.length).fill("");_e.forEach((xr,Tr)=>{const Wr=`test_progress_${n?.student_id||n?.id||"unknown"}_${De.test_type}_${De.test_id}_${xr.question_id}`,ce=localStorage.getItem(Wr);console.log(` Checking individual answer for question ${xr.question_id}:`,ce),ce&&(pt[Tr]=ce,console.log(` Loaded individual answer for question ${xr.question_id}:`,ce))}),console.log(" Initial answers after loading individual saves:",pt),B(pt);const Xt=pt.filter(xr=>xr&&typeof xr=="string"&&xr.trim()!=="").length,Jt=_e.length>0?Xt/_e.length*100:0;console.log(" Calculated progress:",Xt,"answered out of",_e.length,"=",Jt+"%"),U(Jt);const Yt=Number(fe?.allowed_time||0),pr=n?.student_id||n?.id||"unknown";if(X.current=`test_timer_${pr}_${De.test_type}_${De.test_id}`,Yt>0)try{const xr=localStorage.getItem(X.current),Tr=Date.now();if(xr){const Mr=JSON.parse(xr),Wr=Math.floor((Tr-new Date(Mr.lastTickAt).getTime())/1e3),ce=Math.max(0,Number(Mr.remainingSeconds||Yt)-Math.max(0,Wr));q(ce),K.current=Tr}else q(Yt),K.current=Tr,localStorage.setItem(X.current,JSON.stringify({remainingSeconds:Yt,lastTickAt:new Date(Tr).toISOString(),startedAt:new Date(Tr).toISOString()}))}catch(xr){console.error("Timer cache init error:",xr),q(Yt)}else q(0);const Ir=new Date;M(Ir),console.log(" Test timer started at:",Ir.toISOString()),Ue(),console.log(" Anti-cheating tracking started"),R("test"),console.log(" Test started successfully")}catch(At){console.error(" Error starting test:",At),xt("Failed to start test","error"),_("Failed to load test data. Please try again.")}finally{const At=Date.now()-ct,rr=Math.max(0,250-At);setTimeout(()=>{p(!1),y(!1)},rr),N(!1);try{mt&&clearTimeout(mt)}catch{}}},[c]),gt=C.useCallback(async()=>{if(!E||!Y||!ie||!se){xt("No test data to submit","error");return}console.log(" Submitting test:",E);try{J(!0);const De=Ou(ie,se,E.test_type),ct=new Date,mt=L?Math.round((ct-L)/1e3):0,At=L?L.toISOString():ct.toISOString();console.log(" Test timing:",{startedAt:At,endTime:ct.toISOString(),timeTaken:`${mt} seconds`});const Lt=Je();console.log(" Anti-cheating data for submission:",Lt);const rr={};ie.forEach((we,fe)=>{rr[we.question_id]=se[fe]??""}),E.test_type==="drawing"&&(console.log(" Drawing test answers being submitted:",se),console.log(" Drawing test answers type:",typeof se[0]),console.log(" Drawing test answers content:",se[0]));const Ee=await rn.submitTest(E.test_type,E.test_id,se,{time_taken:(()=>{const we=Number(Y?.allowed_time||0);return we>0?Math.min(mt,we):mt})(),started_at:At,submitted_at:ct.toISOString(),answers_by_id:rr,question_order:ie.map(we=>we.question_id),caught_cheating:Lt.caught_cheating,visibility_change_times:Lt.visibility_change_times,retest_assignment_id:(()=>{const fe=`retest_assignment_id_${n?.student_id||n?.id||""}_${E.test_type}_${E.test_id}`,_e=localStorage.getItem(fe);return console.log(" Frontend retest key:",fe),console.log(" Frontend retest assignment ID from localStorage:",_e),console.log(" Frontend retest assignment ID converted:",_e?Number(_e):null),console.log(" Frontend current test data:",E),console.log(" Frontend current test retest_assignment_id:",E.retest_assignment_id),_e?Number(_e):null})(),parent_test_id:E.test_id},n);if(console.log(" Test submission result:",Ee),Ee.success){const we=n?.student_id||n?.id||"",fe=`retest1_${we}_${E.test_type}_${E.test_id}`;if(localStorage.getItem(fe)==="true"){const pt=E?.retest_attempts_left||E?.max_attempts||3;if((Ee?.percentage_score??0)>=50){const Jt=`retest_attempt${pt}_${we}_${E.test_type}_${E.test_id}`;localStorage.setItem(Jt,"true"),console.log(" Passed retest, marking last-slot key:",Jt),localStorage.removeItem(fe)}else{let Jt=1;for(let pr=1;pr<=10;pr++){const Ir=`retest_attempt${pr}_${we}_${E.test_type}_${E.test_id}`;if(localStorage.getItem(Ir)!=="true"){Jt=pr;break}}const Yt=`retest_attempt${Jt}_${we}_${E.test_type}_${E.test_id}`;localStorage.setItem(Yt,"true"),console.log(" Marked retest attempt as completed:",Yt),Jt>=pt&&localStorage.removeItem(fe)}}if(console.log(" Marking test as completed..."),await Pe(E.test_type,E.test_id),E.test_type!=="drawing"){console.log(" Caching test results after submission...");const Xt=`student_results_table_${n?.student_id||n?.id||"unknown"}`,{setCachedData:Jt,CACHE_TTL:Yt}=await Vo(async()=>{const{setCachedData:pr,CACHE_TTL:Ir}=await Promise.resolve().then(()=>Lh);return{setCachedData:pr,CACHE_TTL:Ir}},void 0);Jt(Xt,Ee,Yt.student_results_table),console.log(" Test results cached with key:",Xt)}else console.log(" Drawing test submitted - not caching results (will appear after teacher grades)");console.log(" Clearing test progress..."),d(E.test_type,E.test_id);try{const pt=n?.student_id||n?.id||"unknown",Xt=`test_timer_${pt}_${E.test_type}_${E.test_id}`;localStorage.removeItem(Xt);const Jt=`test_shuffle_order_${pt}_${E.test_type}_${E.test_id}`;localStorage.removeItem(Jt)}catch{}if(n?.student_id){const pt=`test_completed_${n.student_id}_${E.test_type}_${E.test_id}`;localStorage.setItem(pt,"true"),console.log(" Test marked as completed in localStorage:",pt)}try{const pt=n?.student_id||n?.id||"",Xt=`retest1_${pt}_${E.test_type}_${E.test_id}`,Jt=`retest_assignment_id_${pt}_${E.test_type}_${E.test_id}`;localStorage.removeItem(Xt),localStorage.removeItem(Jt),console.log(" Cleared retest keys:",Xt,Jt)}catch(pt){console.warn("Failed to clear retest keys:",pt)}console.log(" Clearing test progress and anti-cheating data...");const $e=n?.student_id||n?.id||"unknown",St=[];for(let pt=0;pt<localStorage.length;pt++){const Xt=localStorage.key(pt);Xt&&(Xt.startsWith(`test_progress_${$e}_`)||Xt.startsWith(`anti_cheating_${$e}_`))&&St.push(Xt)}St.forEach(pt=>{localStorage.removeItem(pt),console.log(` Cleared: ${pt}`)}),console.log(" Clearing anti-cheating data..."),Ge(),He(),E.test_type!=="drawing"?R("results"):r("/student"),xt("Test submitted successfully!","success"),console.log(" Test submitted successfully")}else throw console.error(" Test submission failed:",Ee.error),new Error(Ee.error||"Failed to submit test")}catch(De){console.error(" Error submitting test:",De),xt("Failed to submit test","error")}finally{J(!1)}},[E,Y,ie,se,Pe,d]);C.useCallback(()=>(console.log(" Collecting test answers..."),se),[se]);const Bt=C.useCallback(()=>{if(!ie||!se)return;const De=se.filter(mt=>mt&&typeof mt=="string"&&mt.trim()!=="").length,ct=ie.length>0?De/ie.length*100:0;if(U(ct),console.log(` Progress updated: ${De}/${ie.length} questions answered (${Math.round(ct)}%)`),E){const mt={answers:se,progress:ct,lastSaved:new Date().toISOString()};l(E.test_type,E.test_id,mt)}},[ie,se,E,l]);C.useEffect(()=>{Bt()},[Bt]);const Ut=C.useCallback(()=>{if(!se)return 0;const De=se.filter(ct=>ct&&typeof ct=="string"&&ct.trim()!=="").length;return console.log(" getAnsweredCount:",{studentAnswers:se,answeredCount:De,totalQuestions:ie?.length}),De},[se,ie]),it=C.useCallback(()=>{console.log(" Navigating back to cabinet..."),e?e():r("/student")},[e,r]);C.useCallback(()=>{console.log(" Showing test results..."),R("results")},[]);const Ye=C.useCallback((De,ct,mt=null)=>{switch(console.log(" Formatting student answer for display:",De,"testType:",ct,"question:",mt),ct){case pn.MULTIPLE_CHOICE:if(De.toString().startsWith("Option "))return De;if(mt&&typeof De=="string"&&!isNaN(parseInt(De))){const At=parseInt(De),Lt=`option_${String.fromCharCode(97+At)}`,rr=mt[Lt];if(rr)return console.log(" Converted",De,"to option text:",rr),rr;{const Ee=String.fromCharCode(65+At);return console.log(" Converted",De,"to",Ee),Ee}}else{if(typeof De=="string"&&isNaN(parseInt(De)))return console.log(" Already formatted text:",De),De;{const At=String.fromCharCode(65+parseInt(De));return console.log(" Converted",De,"to",At),At}}case pn.TRUE_FALSE:return De==="true"?"True":"False";case pn.INPUT:return De;case pn.MATCHING:return typeof De=="object"?JSON.stringify(De):De;case pn.WORD_MATCHING:return typeof De=="object"?JSON.stringify(De):De;case pn.DRAWING:return De&&De.trim()!==""?"Drawing submitted":"No drawing";case pn.FILL_BLANKS:return De;default:return console.warn(" Unknown test type for answer formatting:",ct),De}},[]),xt=C.useCallback((De,ct)=>{const mt={id:Date.now(),message:De,type:ct,timestamp:new Date};A(At=>[...At,mt]),setTimeout(()=>{A(At=>At.filter(Lt=>Lt.id!==mt.id))},Ti.NOTIFICATION_DURATION)},[]);C.useEffect(()=>{Bt()},[Bt]),C.useEffect(()=>{if(F!=="test")return;const De=Number(Y?.allowed_time||0);if(!De)return;const ct=setInterval(()=>{q(mt=>{const At=Math.max(0,mt-1);try{const Lt=Date.now();K.current||(K.current=Lt),X.current&&localStorage.setItem(X.current,JSON.stringify({remainingSeconds:At,lastTickAt:new Date(Lt).toISOString(),startedAt:L?L.toISOString():new Date(Lt-(De-At)*1e3).toISOString()}))}catch{}return At===0&&gt(),At})},1e3);return()=>clearInterval(ct)},[F,Y?.allowed_time,gt,L]);const ut=C.useCallback((De,ct)=>{if(!De)return null;const mt=(At,Lt)=>{const rr=[...se];rr[ct]=Lt,B(rr),console.log(` Answer changed: question ${At} = ${Lt}`),console.log(" Updated studentAnswers:",rr)};switch(E.test_type){case pn.TRUE_FALSE:return o.jsx(PW,{question:De,questionIndex:ct,studentAnswer:se[ct]||"",onAnswerChange:mt,mode:"student",testId:E?.test_id,testType:I,displayNumber:ct+1});case pn.MULTIPLE_CHOICE:return o.jsx(RW,{question:De,questionIndex:ct,studentAnswer:se[ct]||"",onAnswerChange:mt,mode:"student",testId:E?.test_id,testType:I,displayNumber:ct+1});case pn.INPUT:return o.jsx(DW,{question:De,questionIndex:ct,studentAnswer:se[ct]||"",onAnswerChange:mt,mode:"student",testId:E?.test_id,testType:I,displayNumber:ct+1});case pn.MATCHING:return console.error("Matching test reached renderQuestion - this should not happen"),o.jsxs("div",{className:"text-center p-8",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-600 mb-4",children:"Matching Test"}),o.jsx("p",{className:"text-gray-500 mb-4",children:"Redirecting to matching test page..."}),o.jsx(et,{onClick:()=>r("/student"),variant:"primary",children:"Back to Dashboard"})]});case pn.DRAWING:return o.jsx(zW,{question:De,questionIndex:ct,studentAnswer:se[ct]||"",onAnswerChange:mt,mode:"student",testId:E?.test_id,testType:I});case pn.FILL_BLANKS:return ct===0?o.jsx(VW,{testText:Y?.test_text,blanks:(ie||[]).map((At,Lt)=>({id:At.question_id||Lt+1,options:At.blank_options||[],correct_answer:At.correct_answers?.[0]||At.correct_answer,question:At.question_json||""})),separateType:Y?.separate_type,testId:E?.test_id,testName:Y?.test_name||E?.test_name,teacherId:Y?.teacher_id||E?.teacher_id,subjectId:Y?.subject_id||E?.subject_id,onTestComplete:gt,onAnswerChange:(At,Lt)=>{const rr=ie.findIndex(Ee=>Ee.question_id===At);if(rr!==-1){const Ee=[...se];Ee[rr]=Lt,B(Ee),console.log(` Fill Blanks answer changed: question ${At} = ${Lt}`)}}},`fill-blanks-${E?.test_id}-${Y?.test_name}`):null;default:return o.jsx("div",{children:"Unsupported question type"})}},[E,se,I]);function wt(){return!E||!Y||!ie?null:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("div",{className:"flex justify-between items-center mb-4",children:o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:Y.test_name||Y.title||"Test"})}),o.jsx("div",{className:"mb-4",children:o.jsx(GW,{answeredCount:Ut(),totalQuestions:ie.length,percentage:Math.round(z),timeElapsed:Number(Y?.allowed_time||0)>0?V:0,showDetails:!0})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Answer all questions below:"}),o.jsx("div",{className:"space-y-8",children:ie.map((De,ct)=>o.jsx("div",{className:"question-container",children:ut(De,ct)},De.question_id||ct))})]}),o.jsx("div",{className:"flex justify-center",children:o.jsx(et,{variant:"primary",size:"lg",onClick:gt,disabled:Z||Ut()<ie.length,loading:Z,children:Z?"Submitting...":`Submit Test (${Ut()}/${ie.length})`})})]})}if(f)return o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Fr,{size:"lg"}),o.jsx("p",{className:"mt-4 text-gray-600",children:t?"Starting Test...":"Loading Student Tests..."})]})});if(k)return o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsx("div",{className:"text-center",children:o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[o.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Tests Error"}),o.jsx("p",{className:"text-red-600 mb-4",children:k}),o.jsx(et,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return o.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[o.jsx("div",{className:"bg-white shadow-sm border-b",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center py-4",children:[o.jsx("div",{children:o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Test"})}),o.jsx(et,{variant:"outline",onClick:it,children:"Back to Cabinet"})]})})}),Ft&&F==="results"&&o.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mx-4 sm:mx-6 lg:mx-8 mt-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),o.jsx("div",{className:"ml-3",children:o.jsxs("p",{className:"text-sm text-red-700",children:[o.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",rt," times during the test."]})})]})}),o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 overflow-y-auto",children:[!t&&F==="list"&&$t(),F==="test"&&wt(),F==="results"&&Kt()]}),F==="test"&&g&&o.jsxs("div",{className:"fixed inset-0 bg-white/80 backdrop-blur-[1px] flex flex-col items-center justify-center z-50",children:[o.jsx(Fr,{size:"lg"}),o.jsx("p",{className:"mt-3 text-gray-700",children:"Preparing your test"}),v&&o.jsx("div",{className:"mt-3 text-sm text-gray-500",children:v})]}),o.jsx($j,{isOpen:ne,onClose:()=>me(!1),testType:xe?.test_type,testId:xe?.test_id,testName:xe?.test_name,questions:xe?.questions,isLoading:f}),o.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:T.map(De=>o.jsx(Zo,{type:De.type,message:De.message,onClose:()=>A(ct=>ct.filter(mt=>mt.id!==De.id))},De.id))})]});function $t(){return!a||a.length===0?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:"No active tests available for your class."})}):o.jsx("div",{className:"space-y-6",children:a.map((De,ct)=>o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:De.test_name}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Subject:"})," ",De.subject]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Teacher:"})," ",De.teacher_name]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Type:"})," ",De.test_type]})]}),o.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Assigned: ",new Date(De.assigned_at).toLocaleDateString()]})]}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx(et,{variant:"outline",onClick:()=>Qe(De),disabled:b||f,children:"View Details"}),o.jsx(et,{variant:"primary",onClick:()=>_t(De),disabled:b||f,children:b?"Starting...":"Start Test"})]})]})},ct))})}function Kt(){if(!E||!Y||!ie||!se)return null;const De={};return se.forEach((ct,mt)=>{if(ie[mt]){const At=ie[mt].question_id||ie[mt].id||mt;De[String(At)]=ct,console.log(" Converting answer:",{index:mt,questionId:At,answer:ct,question:ie[mt]})}}),console.log(" Final answersObject:",De),console.log(" Questions structure:",ie.map(ct=>({id:ct.question_id,correct_answer:ct.correct_answer}))),o.jsx(Mz,{testInfo:Y,questions:ie,testType:E.test_type,studentAnswers:De,onBackToCabinet:it,checkAnswerCorrectness:f0,formatStudentAnswerForDisplay:Ye,getCorrectAnswer:up})}},Lz=()=>{const{testId:e}=j1(),t=Ri(),{user:r}=Hn(),{makeAuthenticatedRequest:n}=Xi(),{showNotification:s}=ja(),[a,i]=C.useState(null),[l,c]=C.useState(!0),[d,f]=C.useState(null),[p,g]=C.useState(null),[y,v]=C.useState(!1);Gp("matching_type",a?.id);const _=C.useCallback(()=>{if(!r?.student_id||!e)return!1;const T=`test_completed_${r.student_id}_matching_type_${e}`,A=localStorage.getItem(T)==="true",F=`retest1_${r.student_id}_matching_type_${e}`,R=localStorage.getItem(F)==="true";return A&&!R?(console.log(" Test already completed, redirecting to cabinet"),s("This test has already been completed","info"),t("/student"),!0):!1},[r?.student_id,e,t,s]),b=C.useCallback(async()=>{if(!e){f("Test ID is required"),c(!1);return}if(!_())try{c(!0),f(null);const T=await n(`/.netlify/functions/get-matching-type-test?test_id=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!T.ok)throw new Error("Failed to load test data");const A=await T.json();if(!A.success)throw new Error(A.message||"Failed to load test");const F=A.data;console.log(" Test data from get-matching-type-test:",F);const R=await n(`/.netlify/functions/get-test-questions?test_id=${e}&test_type=matching_type`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!R.ok)throw new Error("Failed to load test questions");const E=await R.json();if(!E.success)throw new Error(E.message||"Failed to load test questions");console.log(" Questions data from get-test-questions:",E);const D={id:F.test_id,test_name:F.test_name,teacher_id:F.teacher_id,subject_id:F.subject_id,image_url:F.image_url,image:null,blocks:(()=>{if(Array.isArray(E.questions)&&E.questions.length>0){const I=E.questions[0];return Array.isArray(I.blocks)?I.blocks.map((G,Y)=>{let ee=G.block_coordinates||G.coordinates||(typeof G.x=="number"?{x:G.x,y:G.y,width:G.width,height:G.height}:null);if(typeof ee=="string")try{ee=JSON.parse(ee)}catch{ee=null}return(!ee||typeof ee!="object")&&(ee={x:0,y:0,width:30,height:10}),ee={x:(typeof ee.x=="number"?ee.x:Number(ee.x))||0,y:(typeof ee.y=="number"?ee.y:Number(ee.y))||0,width:(typeof ee.width=="number"?ee.width:Number(ee.width))||30,height:(typeof ee.height=="number"?ee.height:Number(ee.height))||10},{id:G.block_id||G.question_id||G.id||Y+1,word:G.word||`Word ${Y+1}`,coordinates:ee,hasArrow:!!G.has_arrow,arrow:G.arrow||null}}):E.questions.map(G=>{console.log(" Processing question:",G);let Y;try{Y=typeof G.block_coordinates=="string"?JSON.parse(G.block_coordinates):G.block_coordinates}catch{Y={x:0,y:0,width:100,height:100}}return(!Y||typeof Y!="object")&&(Y={x:0,y:0,width:100,height:100}),Y={x:(typeof Y.x=="number"?Y.x:Number(Y.x))||0,y:(typeof Y.y=="number"?Y.y:Number(Y.y))||0,width:(typeof Y.width=="number"?Y.width:Number(Y.width))||100,height:(typeof Y.height=="number"?Y.height:Number(Y.height))||100},{id:G.question_id,word:G.word,coordinates:Y,hasArrow:G.has_arrow,arrow:G.arrow}})}return[]})(),words:(()=>{if(Array.isArray(E.questions)&&E.questions.length>0){const I=E.questions[0];if(Array.isArray(I.words)){const G=I.words,Y=Array.isArray(I.blocks)?I.blocks:[];return typeof G[0]=="string"?G.map((ie,re)=>({id:`w_${Y[re]?.question_id||Y[re]?.block_id||E.questions[re]?.question_id||re+1}_${re}`,word:String(ie),blockId:null,isPlaced:!1,isCorrect:!1})):G.map((ie,re)=>({id:`w_${ie.question_id||ie.id||re+1}_${re}`,word:ie.word||String(ie.text||""),blockId:null,isPlaced:!1,isCorrect:!1}))}return E.questions.map(G=>({id:`w_${G.question_id}`,word:G.word,blockId:null,isPlaced:!1,isCorrect:!1}))}return[]})(),arrows:F.arrows?F.arrows.map(I=>(console.log(" Processing arrow:",I),{id:I.id,questionId:I.question_id,blockId:I.block_id||I.question_id,start:{x:Number(I.start_x)||0,y:Number(I.start_y)||0},end:{x:Number(I.end_x)||0,y:Number(I.end_y)||0},rel_start_x:I.rel_start_x!==null?Number(I.rel_start_x):null,rel_start_y:I.rel_start_y!==null?Number(I.rel_start_y):null,rel_end_x:I.rel_end_x!==null?Number(I.rel_end_x):null,rel_end_y:I.rel_end_y!==null?Number(I.rel_end_y):null,image_width:I.image_width?Number(I.image_width):null,image_height:I.image_height?Number(I.image_height):null,style:(typeof I.style=="string"?JSON.parse(I.style):I.style)||{color:"#dc3545",thickness:3}})):[]};if(F.image_url){const I=new Image;I.crossOrigin="anonymous",I.onload=()=>{D.image=I,i(D),c(!1)},I.onerror=()=>{console.warn("Failed to load test image"),i(D),c(!1)},I.src=F.image_url}else i(D),c(!1)}catch(T){console.error("Error loading test data:",T),f(T.message||"Failed to load test"),c(!1)}},[e,n]);C.useEffect(()=>{r?.student_id&&b()},[b,r?.student_id]);const N=C.useCallback(async T=>{console.log("Test completed:",T),s("Test completed successfully!","success");const A=parseInt(T)||0,F=a?.blocks?.length||a?.words?.length||0,R=F>0?Math.round(A/F*100):0,E={showResults:!0,testInfo:{test_name:a?.test_name||"Test",id:a?.id,test_id:a?.id},testType:"matching_type",score:A,totalQuestions:F,percentage:R,passed:R>=60,questionAnalysis:a?.questions?.map((D,I)=>({questionNumber:I+1,isCorrect:I<A,userAnswer:I<A?`Matched: ${D.word}`:"Not answered",correctAnswer:`Match: ${D.word}`}))||Array.from({length:F},(D,I)=>({questionNumber:I+1,isCorrect:I<A,userAnswer:I<A?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};console.log(" Using test results data:",E),g(E),v(!0)},[a,s]),k=C.useCallback(()=>{t("/student")},[t]),w=C.useCallback(()=>{v(!1),g(null),b()},[b]);return l?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsx(bt,{className:"max-w-md w-full",children:o.jsxs(bt.Body,{className:"text-center",children:[o.jsx(Fr,{size:"lg"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Loading test..."})]})})}):d?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsx(bt,{className:"max-w-md w-full",children:o.jsxs(bt.Body,{className:"text-center",children:[o.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),o.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Test"}),o.jsx("p",{className:"text-gray-600 mb-4",children:d}),o.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})}):a?y&&p?o.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:o.jsx(Kp,{testResults:p,onBackToCabinet:k,onRetakeTest:w,isLoading:!1})}):o.jsx(IW,{testData:a,onTestComplete:N,onBackToCabinet:k}):o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsx(bt,{className:"max-w-md w-full",children:o.jsxs(bt.Body,{className:"text-center",children:[o.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),o.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load test data"}),o.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})})},Bz=()=>{const{testId:e}=j1(),t=Ri(),{user:r}=Hn(),{makeAuthenticatedRequest:n}=Xi(),{showNotification:s}=ja(),[a,i]=C.useState(null),[l,c]=C.useState(!0),[d,f]=C.useState(null),[p,g]=C.useState(null),[y,v]=C.useState(!1),_=C.useCallback(()=>{if(!r?.student_id||!e)return!1;const w=`test_completed_${r.student_id}_word_matching_${e}`,T=`retest1_${r.student_id}_word_matching_${e}`;return localStorage.getItem(T)==="true"?!1:localStorage.getItem(w)==="true"},[r?.student_id,e]),b=C.useCallback(async()=>{if(!e){f("Test ID is required"),c(!1);return}if(_()){s("This test has already been completed","warning"),t("/student");return}c(!0),f(null);try{const w=`word_matching_test_${e}`,T=Rn(w);if(T){if(console.log(" Word matching test loaded from cache:",T),T.id){let R=T;if(Array.isArray(R.rightWords)&&Array.isArray(R.correctPairs)){const E=R.rightWords.map((Y,ee)=>ee);for(let Y=E.length-1;Y>0;Y--){const ee=Math.floor(Math.random()*(Y+1));[E[Y],E[ee]]=[E[ee],E[Y]]}const D=E.map(Y=>R.rightWords[Y]),I=new Map(E.map((Y,ee)=>[Y,ee])),G=R.correctPairs.map(Y=>I.get(Y));R={...R,rightWords:D,correctPairs:G}}i(R)}else{let E={id:T.test_id,test_id:T.test_id,test_name:T.test_name,teacher_id:T.teacher_id,subject_id:T.subject_id,num_questions:T.num_questions,interaction_type:T.interaction_type,passing_score:T.passing_score,created_at:T.created_at,updated_at:T.updated_at,leftWords:T.leftWords,rightWords:T.rightWords,correctPairs:T.correctPairs,originalPairs:T.originalPairs};if(Array.isArray(E.rightWords)&&Array.isArray(E.correctPairs)){const D=E.rightWords.map((ee,ie)=>ie);for(let ee=D.length-1;ee>0;ee--){const ie=Math.floor(Math.random()*(ee+1));[D[ee],D[ie]]=[D[ie],D[ee]]}const I=D.map(ee=>E.rightWords[ee]),G=new Map(D.map((ee,ie)=>[ee,ie])),Y=E.correctPairs.map(ee=>G.get(ee));E={...E,rightWords:I,correctPairs:Y}}i(E)}c(!1);return}const F=await(await n(`/.netlify/functions/get-word-matching-test?test_id=${e}`)).json();if(F.success){const R={id:F.data.test_id,test_id:F.data.test_id,test_name:F.data.test_name,teacher_id:F.data.teacher_id,subject_id:F.data.subject_id,num_questions:F.data.num_questions,interaction_type:F.data.interaction_type,passing_score:F.data.passing_score,created_at:F.data.created_at,updated_at:F.data.updated_at,leftWords:F.data.leftWords,rightWords:F.data.rightWords,correctPairs:F.data.correctPairs,originalPairs:F.data.originalPairs};let E=R;if(Array.isArray(E.rightWords)&&Array.isArray(E.correctPairs)){const D=E.rightWords.map((ee,ie)=>ie);for(let ee=D.length-1;ee>0;ee--){const ie=Math.floor(Math.random()*(ee+1));[D[ee],D[ie]]=[D[ie],D[ee]]}const I=D.map(ee=>E.rightWords[ee]),G=new Map(D.map((ee,ie)=>[ee,ie])),Y=E.correctPairs.map(ee=>G.get(ee));E={...E,rightWords:I,correctPairs:Y}}i(E),Dn(w,E,Bn.word_matching_test),console.log(" Word matching test loaded from API and cached:",R)}else throw new Error(F.message||"Failed to load test")}catch(w){console.error("Error loading word matching test:",w),f(w.message),s("Failed to load test: "+w.message,"error")}finally{c(!1)}},[e,_,n,s,t]),N=C.useCallback(async w=>{console.log("Test completed:",w),s("Test completed successfully!","success");const T=parseInt(w)||0,A=a?.num_questions||0,F=A>0?Math.round(T/A*100):0,R={showResults:!0,testInfo:{test_name:a?.test_name||"Test",id:a?.id,test_id:a?.id},testType:"word_matching",score:T,totalQuestions:A,percentage:F,passed:F>=60,questionAnalysis:Array.isArray(a?.correctPairs)?a.correctPairs.map((E,D)=>({questionNumber:D+1,isCorrect:D<T,userAnswer:D<T?`${E.left}  ${E.right}`:"Not answered",correctAnswer:`${E.left}  ${E.right}`})):Array.from({length:A},(E,D)=>({questionNumber:D+1,isCorrect:D<T,userAnswer:D<T?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};console.log(" Using test results data:",R),g(R),v(!0)},[a,s]),k=C.useCallback(()=>{t("/student")},[t]);return C.useEffect(()=>{b()},[b]),l?o.jsx("div",{className:"flex justify-center items-center min-h-screen",children:o.jsxs(bt,{className:"p-8 text-center",children:[o.jsx(Fr,{size:"lg",className:"mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading word matching test..."})]})}):d?o.jsx("div",{className:"flex justify-center items-center min-h-screen",children:o.jsx(bt,{className:"p-8 text-center",children:o.jsxs("div",{className:"text-red-600 mb-4",children:[o.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),o.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error Loading Test"}),o.jsx("p",{className:"text-gray-600 mb-4",children:d}),o.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})}):a?y&&p?o.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:o.jsx(Kp,{testResults:p,onBackToCabinet:()=>{g(null),v(!1),t("/student")},onRetakeTest:(w,T)=>{g(null),v(!1),b()},isLoading:!1})}):o.jsx(Ze.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"min-h-screen bg-gray-50 py-8",children:o.jsx(LW,{testData:a,onTestComplete:N,onBackToCabinet:k})}):o.jsx("div",{className:"flex justify-center items-center min-h-screen",children:o.jsx(bt,{className:"p-8 text-center",children:o.jsxs("div",{className:"text-gray-600 mb-4",children:[o.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),o.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Test Not Found"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"The requested test could not be found."}),o.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})})},Uz=C.forwardRef(({onRecordingComplete:e,minDuration:t=0,maxDuration:r=600,minWords:n=50,maxAttempts:s=3,currentAttempt:a=1},i)=>{const[l,c]=C.useState(!1),[d,f]=C.useState(!1),[p,g]=C.useState(0),[y,v]=C.useState(null),[_,b]=C.useState(null),[N,k]=C.useState("good"),w=C.useRef(null),T=C.useRef([]),A=C.useRef(null),F=C.useRef(null),R=C.useRef(null),E=C.useRef(null),D=C.useRef(null);C.useImperativeHandle(i,()=>({startRecording:()=>I(),stopRecording:()=>G(),pauseRecording:()=>Y(),resumeRecording:()=>ee()}));const I=C.useCallback(async()=>{try{if(b(null),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox.");if(!window.isSecureContext&&!window.location.hostname.includes("localhost"))throw new Error("Microphone access requires HTTPS. Please use a secure connection.");const z=window.AudioContext||window.webkitAudioContext;R.current||(R.current=new z),R.current.state!=="running"&&await R.current.resume().catch(()=>{}),console.log(" Requesting microphone permission...");const U=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,channelCount:1}});console.log(" Microphone permission granted"),A.current=U;try{let X=document.getElementById("ios-audio-sink");X||(X=document.createElement("audio"),X.id="ios-audio-sink",X.muted=!0,X.playsInline=!0,X.style.display="none",document.body.appendChild(X)),X.srcObject=U,await X.play().catch(()=>{})}catch{}const V=R.current.createAnalyser();R.current.createMediaStreamSource(U).connect(V),V.fftSize=256,E.current=V,ie();let L="audio/webm;codecs=opus";typeof MediaRecorder<"u"&&MediaRecorder.isTypeSupported&&!MediaRecorder.isTypeSupported(L)&&(MediaRecorder.isTypeSupported("audio/mp4")?L="audio/mp4":MediaRecorder.isTypeSupported("audio/aac")?L="audio/aac":L="");const M=new MediaRecorder(U,L?{mimeType:L}:void 0);w.current=M,T.current=[],M.ondataavailable=X=>{X.data.size>0&&T.current.push(X.data)},M.onstop=()=>{const X=L&&L.startsWith("audio/")?L:"audio/webm",K=new Blob(T.current,{type:X});v(K),e(K,p),A.current&&A.current.getTracks().forEach(Z=>Z.stop()),D.current&&cancelAnimationFrame(D.current)},M.start(1e3),c(!0),g(0),F.current=setInterval(()=>{g(X=>{const K=X+1;return K>=r&&G(),K})},1e3)}catch(z){console.error("Error starting recording:",z);const U=/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1;z.name==="NotAllowedError"?b(U?"Microphone access denied. Please go to Settings > Safari > Microphone and allow access, then refresh the page.":"Microphone access denied. Please allow microphone access in your browser settings and try again."):z.name==="NotFoundError"?b("No microphone found. Please connect a microphone and try again."):z.name==="NotSupportedError"?b("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox."):z.message.includes("HTTPS")?b("Microphone access requires HTTPS. Please use a secure connection."):b(`Failed to access microphone: ${z.message}`)}},[r]),G=C.useCallback(()=>{if(w.current&&l&&(w.current.stop(),c(!1),f(!1),F.current&&clearInterval(F.current),p<t)){b(`Recording must be at least ${t} seconds long.`);return}},[l,p,t,y,e]),Y=C.useCallback(()=>{w.current&&l&&!d&&(w.current.pause(),f(!0),F.current&&clearInterval(F.current))},[l,d]),ee=C.useCallback(()=>{w.current&&l&&d&&(w.current.resume(),f(!1),F.current=setInterval(()=>{g(z=>{const U=z+1;return U>=r&&G(),U})},1e3))},[l,d,r,G]),ie=C.useCallback(()=>{if(!E.current)return;const z=E.current,U=new Uint8Array(z.frequencyBinCount),V=()=>{z.getByteFrequencyData(U);const q=U.reduce((L,M)=>L+M,0)/U.length;q<10?k("poor"):q<30?k("fair"):k("good"),l&&(D.current=requestAnimationFrame(V))};V()},[l]),re=z=>{const U=Math.floor(z/60),V=z%60;return`${U}:${V.toString().padStart(2,"0")}`},se=()=>{switch(N){case"poor":return"text-red-600";case"fair":return"text-yellow-600";case"good":return"text-green-600";default:return"text-gray-600"}},B=()=>{switch(N){case"poor":return"Poor audio quality - speak closer to microphone";case"fair":return"Fair audio quality - good for recording";case"good":return"Excellent audio quality";default:return"Monitoring audio quality..."}};return o.jsxs("div",{className:"audio-recorder bg-white rounded-lg shadow-lg p-3 sm:p-6",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Record Your Response"}),o.jsx("p",{className:"text-gray-600",children:"Speak clearly and at a normal pace. You can pause and resume if needed."})]}),o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:re(p)}),o.jsx("div",{className:`text-sm ${se()}`,children:B()}),d&&o.jsx("div",{className:"text-yellow-600 font-semibold mt-2",children:" Recording Paused"})]}),l&&o.jsx("div",{className:"mb-6",children:o.jsx("div",{className:"flex justify-center items-center space-x-1 h-8",children:Array.from({length:20},(z,U)=>o.jsx("div",{className:"bg-blue-400 rounded-sm",style:{width:"4px",height:`${Math.random()*20+4}px`,animation:"pulse 0.5s ease-in-out infinite"}},U))})}),o.jsx("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-center mb-6",children:l?o.jsxs(o.Fragment,{children:[d?o.jsxs("button",{onClick:ee,className:"w-full sm:w-auto bg-green-600 text-white px-6 py-4 rounded-full hover:bg-green-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[o.jsx("span",{className:"text-xl",children:""}),o.jsx("span",{children:"Resume"})]}):o.jsxs("button",{onClick:Y,className:"w-full sm:w-auto bg-yellow-600 text-white px-6 py-4 rounded-full hover:bg-yellow-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[o.jsx("span",{className:"text-xl",children:""}),o.jsx("span",{children:"Pause"})]}),o.jsxs("button",{onClick:G,className:"w-full sm:w-auto bg-gray-600 text-white px-6 py-4 rounded-full hover:bg-gray-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[o.jsx("span",{className:"text-xl",children:""}),o.jsx("span",{children:"Stop & Submit"})]})]}):o.jsxs("button",{onClick:I,className:"w-full sm:w-auto bg-red-600 text-white px-6 py-4 rounded-full hover:bg-red-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[o.jsx("span",{className:"text-xl",children:""}),o.jsx("span",{children:"Start Recording"})]})}),_&&o.jsx("div",{className:"mt-4 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg",children:o.jsx("p",{className:"text-red-800",children:_})}),o.jsxs("div",{className:"mt-4 text-center text-sm text-gray-600",children:["Attempt ",a," of ",s,a<s&&o.jsx("span",{className:"ml-2 text-blue-600",children:"(You can re-record if needed)"})]})]})}),Zj=({audioBlob:e,audioUrl:t,recordingTime:r,className:n=""})=>{const[s,a]=C.useState(!1),[i,l]=C.useState(0),[c,d]=C.useState(0),[f,p]=C.useState(1),[g,y]=C.useState(1),[v,_]=C.useState(!0),[b,N]=C.useState(""),[k,w]=C.useState(!1),[T,A]=C.useState(null),[F,R]=C.useState(!1),E=C.useRef(null),D=C.useRef(null),I=C.useRef(!1);C.useEffect(()=>()=>{I.current=!0},[]),C.useEffect(()=>{let U=!1;if(t)U||N(t);else if(e){if(!e||e.size===0){U||_(!1);return}if(!(e instanceof Blob)){console.error("audioBlob is not a Blob:",typeof e,e),U||_(!1);return}const V=URL.createObjectURL(e);return U||N(V),()=>{U=!0,URL.revokeObjectURL(V)}}return()=>{U=!0}},[e,t]),C.useEffect(()=>{let U=!1;const V=L=>{try{const M=new URL(L);return/\/storage\/v1\/object\/public\//.test(M.pathname)}catch{return!1}};async function q(L){if(!L||F||/\/object\/sign\//.test(L)||!V(L))return L;try{const X=new URL(L).pathname.replace(/^\/storage\/v1\/object\/public\//,""),K=X.split("/")[0],Z=X.substring(K.length+1),J=await fetch(`/.netlify/functions/get-speaking-test-new?action=sign-audio&bucket=${encodeURIComponent(K)}&file_path=${encodeURIComponent(Z)}`);if(J.ok){const{url:ne}=await J.json();return!U&&!I.current&&(R(!0),N(ne)),ne}}catch{}return L}return(async()=>{if(t){const L=await q(t);!U&&!I.current&&!F&&N(L)}})(),()=>{U=!0}},[t,F]),C.useEffect(()=>{let U=!1;return b&&(U||(w(!1),A(null),_(!0))),()=>{U=!0}},[b]),C.useEffect(()=>{if(E.current&&b){const U=E.current;let V=!1;try{U.src=b}catch{}U.load();const q=()=>{if(V||I.current)return;let le=U.duration;if(le===1/0)try{U.currentTime=1e101,U.ontimeupdate=()=>{if(V||I.current)return;U.ontimeupdate=null;const ge=U.duration;V||(d(isFinite(ge)&&ge>0?ge:0),U.currentTime=0,_(!1))};return}catch(ge){console.warn("Seek trick failed:",ge)}if(isNaN(le)||!isFinite(le)||le<=0){const ge=U.seekable&&U.seekable.length>0&&isFinite(U.seekable.end(0)),Ue=!ge&&U.buffered&&U.buffered.length>0&&isFinite(U.buffered.end(U.buffered.length-1));ge?le=U.seekable.end(0):Ue&&(le=U.buffered.end(U.buffered.length-1))}isNaN(le)||!isFinite(le)||le<=0?(console.warn("Invalid audio duration after fallbacks:",le),r&&r>0?V||d(r):V||d(0)):V||d(le),V||_(!1)},L=()=>{V||I.current||q()},M=()=>{V||I.current||q()},X=()=>{V||I.current||q()},K=()=>{V||I.current||q()},Z=()=>{V||I.current||l(U.currentTime)},J=()=>{V||I.current||(a(!1),l(0))},ne=()=>{V||I.current||a(!0)},me=()=>{V||I.current||a(!1)},xe=le=>{if(V||I.current)return;console.error("Audio loading error:",le),console.error("Audio error details:",{error:U.error,networkState:U.networkState,readyState:U.readyState,src:U.src,currentSrc:U.currentSrc});const ge=U.error?.code;ge===4&&w(!0),A(U.error||{code:ge}),_(!1)},Ne=setTimeout(()=>{V||I.current||U.readyState===0&&_(!1)},6e3);return U.addEventListener("loadedmetadata",L),U.addEventListener("durationchange",M),U.addEventListener("canplay",X),U.addEventListener("canplaythrough",K),U.addEventListener("timeupdate",Z),U.addEventListener("ended",J),U.addEventListener("play",ne),U.addEventListener("pause",me),U.addEventListener("error",xe),()=>{V=!0,clearTimeout(Ne),U.removeEventListener("loadedmetadata",L),U.removeEventListener("durationchange",M),U.removeEventListener("canplay",X),U.removeEventListener("canplaythrough",K),U.removeEventListener("timeupdate",Z),U.removeEventListener("ended",J),U.removeEventListener("play",ne),U.removeEventListener("pause",me),U.removeEventListener("error",xe),U.pause(),U.src="",U.load()}}},[b,r]),C.useEffect(()=>{let U=!1;return r&&r>0&&(isNaN(c)||!isFinite(c)||c<=0)&&(U||d(r)),()=>{U=!0}},[r,c]);const G=()=>{E.current&&(s?E.current.pause():E.current.play().catch(U=>{console.error("Play failed:",U)}))},Y=U=>{if(E.current&&D.current&&c>0){const V=D.current.getBoundingClientRect(),q=U.clientX-V.left,L=V.width,M=Math.max(0,Math.min(c,q/L*c));isFinite(M)&&M>=0&&(E.current.currentTime=M,l(M))}},ee=U=>{const V=parseFloat(U.target.value);p(V),E.current&&(E.current.volume=V)},ie=U=>{const V=parseFloat(U.target.value);y(V),E.current&&(E.current.playbackRate=V)},re=U=>{if(isNaN(U))return"0:00";const V=Math.floor(U/60),q=Math.floor(U%60);return`${V}:${q.toString().padStart(2,"0")}`};if(!e&&!t)return o.jsx("div",{className:`audio-player ${n}`,children:o.jsx("div",{className:"text-center text-gray-500 py-8",children:"No audio available"})});const B=(U=>{try{const q=(U||"").toLowerCase().split("?")[0].split("#")[0];return q.endsWith(".webm")?"audio/webm":q.endsWith(".mp3")?"audio/mpeg":q.endsWith(".m4a")?"audio/mp4":q.endsWith(".aac")?"audio/aac":q.endsWith(".wav")?"audio/wav":void 0}catch{return}})(b||t),z=us.useMemo(()=>typeof window>"u"?!0:document.createElement("audio").canPlayType("audio/webm")!=="",[]);return o.jsxs("div",{className:`audio-player bg-gray-50 rounded-lg p-4 ${n}`,children:[o.jsx("audio",{ref:E,preload:"metadata",controls:!1,style:{display:"none"},crossOrigin:"anonymous",children:o.jsx("source",{src:b,type:B})}),v?o.jsxs("div",{className:"text-center py-4",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),o.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Loading audio..."})]}):k?o.jsxs("div",{className:"text-center py-4",children:[o.jsx("p",{className:"text-sm text-red-600",children:"This audio format isn't supported by your browser."}),b?o.jsx("a",{href:b,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline text-sm",children:"Open in new tab"}):null,B?o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Detected type: ",B]}):null,o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Browser WebM support: ",z?"Yes":"No",!z&&" - Try using Chrome, Firefox, or Edge"]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Preferred format: WebM"})]}):T?o.jsxs("div",{className:"text-center py-4",children:[o.jsx("p",{className:"text-sm text-red-600",children:"Playback failed. Please try opening the audio directly."}),b?o.jsx("a",{href:b,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline text-sm",children:"Open in new tab"}):null,B?o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Detected type: ",B]}):null]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("div",{ref:D,className:"w-full bg-gray-200 rounded-full h-3 cursor-pointer hover:h-4 transition-all min-h-[24px]",onClick:Y,children:o.jsx("div",{className:"bg-blue-600 h-3 rounded-full transition-all",style:{width:`${i/c*100}%`}})}),o.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mt-2 font-medium",children:[o.jsx("span",{children:re(i)}),o.jsx("span",{children:re(c)})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("button",{onClick:G,className:"bg-blue-600 text-white p-3 rounded-full hover:bg-blue-700 transition-colors min-h-[44px] min-w-[44px] flex items-center justify-center",children:s?o.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}):o.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.617 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.617l3.766-3.793a1 1 0 011.617.793zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z",clipRule:"evenodd"})}),o.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:f,onChange:ee,className:"w-24 h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer min-h-[20px]"}),o.jsxs("span",{className:"text-sm text-gray-600 w-10 font-medium",children:[Math.round(f*100),"%"]})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Speed:"}),o.jsxs("select",{value:g,onChange:ie,className:"text-sm border border-gray-300 rounded px-2 py-1",children:[o.jsx("option",{value:"0.5",children:"0.5x"}),o.jsx("option",{value:"0.75",children:"0.75x"}),o.jsx("option",{value:"1",children:"1x"}),o.jsx("option",{value:"1.25",children:"1.25x"}),o.jsx("option",{value:"1.5",children:"1.5x"}),o.jsx("option",{value:"2",children:"2x"})]})]})]})]})]})},$z=({transcript:e,scores:t,audioBlob:r,recordingTime:n,onReRecord:s,onFinalSubmit:a,canReRecord:i,attemptNumber:l,maxAttempts:c,isSubmitting:d=!1})=>{const[f,p]=C.useState(!1);console.log(" FeedbackDisplay received recordingTime:",n);const g=(b,N)=>{const k=b/N*100;return k>=80?"text-green-600":k>=60?"text-yellow-600":"text-red-600"},y=(b,N)=>{const k=b/N*100;return k>=90?"A+":k>=80?"A":k>=70?"B":k>=60?"C":k>=50?"D":"F"},v=()=>y(t?.overall_score||0,100),_=()=>g(t?.overall_score||0,100);return console.log(" FeedbackDisplay received scores:",t),console.log(" Individual score values:",{grammar_score:t?.grammar_score,vocabulary_score:t?.vocabulary_score,pronunciation_score:t?.pronunciation_score,fluency_score:t?.fluency_score,content_score:t?.content_score}),o.jsxs("div",{className:"feedback-display bg-white rounded-lg shadow-lg p-3 sm:p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Speaking Test Results"}),o.jsx("p",{className:"text-gray-600",children:"Review your performance and decide whether to submit or re-record."})]}),o.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 p-3 sm:p-6 rounded-lg mb-6",children:o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:`text-4xl font-bold ${_()}`,children:[t?.overall_score||0,"/100"]}),o.jsxs("div",{className:`text-2xl font-semibold ${_()} mt-2`,children:["Grade: ",v()]}),o.jsx("div",{className:"text-gray-600 mt-2",children:t?.overall_score>=80?"Excellent work!":t?.overall_score>=60?"Good job!":t?.overall_score>=50?"Not bad, but could be better.":"Keep practicing!"})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[o.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("span",{className:"font-semibold text-gray-700",children:"Grammar"}),o.jsxs("span",{className:`font-bold ${g(t?.grammar_score||0,25)}`,children:[t?.grammar_score||0,"/25"]})]}),o.jsxs("div",{className:"text-sm text-gray-600",children:[t?.grammar_mistakes||0," mistakes found"]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:o.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${Math.min((t?.grammar_score||0)/25*100,100)}%`}})})]}),o.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("span",{className:"font-semibold text-gray-700",children:"Vocabulary"}),o.jsxs("span",{className:`font-bold ${g(t?.vocabulary_score||0,20)}`,children:[t?.vocabulary_score||0,"/20"]})]}),o.jsxs("div",{className:"text-sm text-gray-600",children:[t?.vocabulary_mistakes||0," vocabulary issues"]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:o.jsx("div",{className:"bg-purple-600 h-2 rounded-full",style:{width:`${Math.min((t?.vocabulary_score||0)/20*100,100)}%`}})})]}),o.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("span",{className:"font-semibold text-gray-700",children:"Pronunciation"}),o.jsxs("span",{className:`font-bold ${g(t?.pronunciation_score||0,15)}`,children:[t?.pronunciation_score||0,"/15"]})]}),o.jsx("div",{className:"text-sm text-gray-600",children:"Clarity and accuracy"}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:o.jsx("div",{className:"bg-orange-600 h-2 rounded-full",style:{width:`${Math.min((t?.pronunciation_score||0)/15*100,100)}%`}})})]}),o.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("span",{className:"font-semibold text-gray-700",children:"Fluency"}),o.jsxs("span",{className:`font-bold ${g(t?.fluency_score||0,20)}`,children:[t?.fluency_score||0,"/20"]})]}),o.jsx("div",{className:"text-sm text-gray-600",children:"Pace, pauses, and flow"}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:o.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min((t?.fluency_score||0)/20*100,100)}%`}})})]}),o.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("span",{className:"font-semibold text-gray-700",children:"Content"}),o.jsxs("span",{className:`font-bold ${g(t?.content_score||0,20)}`,children:[t?.content_score||0,"/20"]})]}),o.jsx("div",{className:"text-sm text-gray-600",children:"How well addressed the prompt"}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:o.jsx("div",{className:"bg-indigo-600 h-2 rounded-full",style:{width:`${Math.min((t?.content_score||0)/20*100,100)}%`}})})]}),o.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("span",{className:"font-semibold text-gray-700",children:"Word Count"}),o.jsxs("span",{className:"font-bold text-gray-700",children:[t?.word_count||0," words"]})]}),o.jsx("div",{className:"text-sm text-gray-600",children:"Total words spoken"}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:o.jsx("div",{className:"bg-gray-600 h-2 rounded-full",style:{width:`${Math.min((t?.word_count||0)/100*100,100)}%`}})})]})]}),r&&o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Your Recording"}),o.jsx(Zj,{audioBlob:r,recordingTime:n})]}),t?.feedback&&o.jsx("div",{className:"mb-6 bg-gradient-to-r from-green-50 to-blue-50 p-3 sm:p-6 rounded-lg border border-green-200",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("span",{className:"text-green-600 text-2xl",children:""}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-semibold text-green-800 mb-3 text-lg",children:"AI Feedback"}),o.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.feedback})]})]})}),t?.improved_transcript&&o.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4",children:[o.jsxs("div",{className:"flex items-start space-x-2 mb-3",children:[o.jsx("span",{className:"text-green-600 text-lg",children:""}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold text-green-800 mb-2",children:"Improved Version"}),o.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Here's how your response could be improved with better grammar and vocabulary:"})]})]}),o.jsx("div",{className:"bg-white border border-green-200 rounded p-3",children:o.jsx("p",{className:"text-gray-800 leading-relaxed",children:t.improved_transcript})})]}),o.jsx("div",{className:"mb-6",children:o.jsx("button",{onClick:()=>p(!f),className:"text-blue-600 hover:text-blue-800 text-sm",children:f?"Hide Details":"Show Details"})}),f&&o.jsxs("div",{className:"mb-6 bg-blue-50 p-3 sm:p-4 rounded-lg",children:[o.jsx("h4",{className:"font-semibold mb-3",children:"Detailed Analysis"}),o.jsxs("div",{className:"space-y-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Word Count Analysis:"}),o.jsxs("span",{className:"ml-2 text-gray-700",children:["You spoke ",t?.word_count||0," words.",t?.word_count>=50?" Great job meeting the minimum requirement!":" Consider speaking more to meet the minimum word requirement."]})]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Grammar Analysis:"}),o.jsx("span",{className:"ml-2 text-gray-700",children:t?.grammar_mistakes===0?"Perfect grammar!":`Found ${t?.grammar_mistakes||0} grammar ${t?.grammar_mistakes===1?"mistake":"mistakes"}.`}),t?.grammar_corrections&&t.grammar_corrections.length>0&&o.jsx("div",{className:"mt-2 space-y-2",children:t.grammar_corrections.map((b,N)=>o.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-2 sm:p-3",children:o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx("span",{className:"text-red-600 font-mono text-sm",children:""}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"text-sm",children:[o.jsx("span",{className:"font-medium text-red-600",children:b.mistake}),o.jsx("span",{className:"mx-2",children:""}),o.jsx("span",{className:"font-medium text-green-600",children:b.correction})]}),o.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[o.jsx("strong",{children:"Explanation:"})," ",b.explanation]})]})]})},N))})]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Vocabulary Analysis:"}),o.jsx("span",{className:"ml-2 text-gray-700",children:t?.vocabulary_mistakes===0?"Excellent vocabulary usage!":`Found ${t?.vocabulary_mistakes||0} vocabulary ${t?.vocabulary_mistakes===1?"issue":"issues"}.`}),t?.vocabulary_corrections&&t.vocabulary_corrections.length>0&&o.jsx("div",{className:"mt-2 space-y-2",children:t.vocabulary_corrections.map((b,N)=>o.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded p-2 sm:p-3",children:o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx("span",{className:"text-purple-600 font-mono text-sm",children:""}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"text-sm",children:[o.jsx("span",{className:"font-medium text-purple-600",children:b.mistake}),o.jsx("span",{className:"mx-2",children:""}),o.jsx("span",{className:"font-medium text-green-600",children:b.correction})]}),o.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[o.jsx("strong",{children:"Explanation:"})," ",b.explanation]})]})]})},N))})]})]})]}),o.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:["Attempt ",l," of ",c]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-center justify-center",children:[i&&o.jsxs("button",{onClick:s,className:"w-full sm:w-auto bg-yellow-600 text-white px-4 py-2.5 rounded-lg hover:bg-yellow-700 flex items-center justify-center space-x-2 min-h-[40px] text-base font-medium",children:[o.jsx("span",{children:""}),o.jsx("span",{children:"Re-record"})]}),o.jsx("button",{onClick:a,disabled:d,className:`w-full sm:w-auto px-4 py-2.5 rounded-lg flex items-center justify-center space-x-2 min-h-[40px] text-base font-medium ${d?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"} text-white`,children:d?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),o.jsx("span",{children:"Submitting..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{children:"Submit Final"})]})})]}),!i&&o.jsx("div",{className:"mt-4 p-2 sm:p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:o.jsxs("p",{className:"text-yellow-800 text-sm",children:[o.jsx("strong",{children:"Maximum attempts reached."}),' This is your final attempt. Click "Submit Final" to complete the test.']})})]})},Wz=({testData:e,onComplete:t,onExit:r,onTestComplete:n})=>{const[s,a]=C.useState("recording"),[i,l]=C.useState(null),[c,d]=C.useState(""),[f,p]=C.useState(null),[g,y]=C.useState(!1),[v,_]=C.useState(null),[b,N]=C.useState(1),[k]=C.useState(e.max_attempts||3),[w,T]=C.useState(!1),[A,F]=C.useState(0),R=()=>/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,[E,D]=C.useState(0),[I,G]=C.useState(null),Y=Xi(),{user:ee}=Hn(),{makeAuthenticatedRequest:ie}=Y,re=C.useRef(null);C.useEffect(()=>{if(e?.test_id&&ee?.student_id){const K=`speaking_attempts_${ee.student_id}_${e.test_id}`,Z=localStorage.getItem(K);if(Z){const J=parseInt(Z,10);J>0&&J<=k&&(N(J),console.log(" Loaded attempts from localStorage:",J))}}},[e,ee,k]),C.useEffect(()=>{if(e&&!I){const K=new Date;G(K),console.log(" Speaking test timer started at:",K.toISOString())}},[e,I]),C.useEffect(()=>{let K=0;s==="recording"?K=25:s==="processing"?K=50:s==="feedback"?K=75:s==="completed"&&(K=100),D(K)},[s]),C.useEffect(()=>{(async()=>{try{if(console.log(" Automatically requesting microphone permission..."),!window.isSecureContext&&!window.location.hostname.includes("localhost")){_("Microphone access requires HTTPS. Please use a secure connection.");return}if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){_("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox.");return}if(R())return;const Z=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});console.log(" Microphone permission granted!"),T(!0),Z.getTracks().forEach(J=>J.stop())}catch(Z){console.error(" Microphone permission denied:",Z),Z.name==="NotAllowedError"?_("Microphone access denied. Please allow microphone access in your browser settings and refresh the page."):Z.name==="NotFoundError"?_("No microphone found. Please connect a microphone and try again."):_("Microphone access failed. Please check your browser settings and try again.")}})()},[]),C.useEffect(()=>{const K=setInterval(()=>{i&&s==="recording"&&se()},3e4);return()=>clearInterval(K)},[i,s]);const se=C.useCallback(async()=>{try{const K={test_id:e.test_id,audio_blob:i?await B(i):null,attempt_number:b,step:s,timestamp:new Date().toISOString()};localStorage.setItem(`speaking_progress_${e.test_id}`,JSON.stringify(K))}catch(K){console.error("Failed to save progress:",K)}},[e.test_id,i,b,s]),B=K=>new Promise((Z,J)=>{const ne=new FileReader;ne.onloadend=()=>{const xe=ne.result.split(",")[1];Z(xe)},ne.onerror=J,ne.readAsDataURL(K)}),z=C.useCallback(K=>{if(e?.test_id&&ee?.student_id){const Z=`speaking_attempts_${ee.student_id}_${e.test_id}`;localStorage.setItem(Z,K.toString()),console.log(" Saved attempts to localStorage:",K)}},[e,ee]),U=C.useCallback(async(K,Z,J,ne,me)=>{if(e?.test_id&&ee?.student_id)try{const{setCachedData:xe,CACHE_TTL:Ne}=await Vo(async()=>{const{setCachedData:Ge,CACHE_TTL:Je}=await Promise.resolve().then(()=>Lh);return{setCachedData:Ge,CACHE_TTL:Je}},void 0),le=`speaking_test_data_${ee.student_id}_${e.test_id}`,Ue={audioBlob:K?await B(K):null,transcript:Z,scores:J,recordingTime:ne,currentStep:me,timestamp:Date.now()};xe(le,Ue,Ne.speaking_test_data),console.log(" Saved speaking test data to cache:",le)}catch(xe){console.error("Failed to save speaking test data to cache:",xe)}},[e,ee]),V=C.useCallback(async()=>{if(e?.test_id&&ee?.student_id)try{const{getCachedData:K}=await Vo(async()=>{const{getCachedData:ne}=await Promise.resolve().then(()=>Lh);return{getCachedData:ne}},void 0),Z=`speaking_test_data_${ee.student_id}_${e.test_id}`,J=K(Z);if(J){if(console.log(" Loaded speaking test data from cache:",J),J.audioBlob){const ne=new Blob([Uint8Array.from(atob(J.audioBlob),me=>me.charCodeAt(0))],{type:"audio/webm"});l(ne)}return J.transcript&&d(J.transcript),J.scores&&p(J.scores),J.recordingTime&&F(J.recordingTime),J.currentStep&&a(J.currentStep),!0}}catch(K){console.error("Failed to load speaking test data from cache:",K)}return!1},[e,ee]);C.useEffect(()=>{e?.test_id&&ee?.student_id&&V()},[e,ee,V]),C.useEffect(()=>{e?.test_id&&ee?.student_id&&(i||c||f)&&U(i,c,f,A,s)},[i,c,f,A,s,e,ee,U]);const q=C.useCallback(async(K,Z)=>{console.log(" Recording completed, duration:",Z),l(K),F(Z),a("processing"),_(null);try{const J=await B(K),ne=new Date,me=e.start_time?Math.round((ne-e.start_time)/1e3):0,xe=e.start_time?new Date(e.start_time).toISOString():ne.toISOString(),Ne=ee.student_id,le=`retest_assignment_id_${Ne}_speaking_${e.test_id}`,ge=localStorage.getItem(le),Ue={test_id:e.test_id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:Ne,question_id:e.question_id||1,audio_blob:J,audio_duration:K.duration||0,time_taken:me,started_at:xe,submitted_at:ne.toISOString(),caught_cheating:!1,visibility_change_times:0,is_completed:!0,retest_assignment_id:ge?Number(ge):null,parent_test_id:e.test_id};console.log(" Submitting speaking test:",Ue),console.log(" Processing audio with AI...");try{const Je=await(await ie("/.netlify/functions/process-speaking-audio-ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e.test_id,question_id:e.question_id||1,audio_blob:J})})).json();if(Je.success){console.log(" AI Analysis Result:",Je),d(Je.transcript);const He=Je.transcript?Je.transcript.split(/\s+/).filter(Ie=>Ie.length>0).length:0;console.log(" Word Count Verification:",{aiCount:Je.word_count,actualCount:He,transcript:Je.transcript});const Ft=He,rt={overall_score:Je.overall_score,word_count:Ft,grammar_score:Je.grammar_score,vocabulary_score:Je.vocabulary_score,pronunciation_score:Je.pronunciation_score,fluency_score:Je.fluency_score,content_score:Je.content_score,grammar_mistakes:Je.grammar_mistakes,vocabulary_mistakes:Je.vocabulary_mistakes,feedback:Je.feedback,improved_transcript:Je.improved_transcript,grammar_corrections:Je.grammar_corrections||[],vocabulary_corrections:Je.vocabulary_corrections||[],ai_feedback:Je.ai_feedback||null};console.log(" Mapped Scores:",rt),console.log(" Individual scores check:",{grammar_score:Je.grammar_score,vocabulary_score:Je.vocabulary_score,pronunciation_score:Je.pronunciation_score,fluency_score:Je.fluency_score,content_score:Je.content_score}),p(rt),a("feedback")}else throw new Error(Je.message||"Failed to process audio with AI");localStorage.removeItem(`speaking_progress_${e.test_id}`)}catch(Ge){console.error("Speaking test submission error:",Ge),Ge.message.includes("No valid authentication token found")?(_("Your session has expired. Please refresh the page and try again."),setTimeout(()=>{window.location.reload()},3e3)):_(Ge.message),a("recording")}}catch(J){console.error("Speaking test submission error:",J),_(J.message),a("recording")}},[e,ee,ie,b,z]),L=C.useCallback(()=>{if(b<k){l(null),d(""),p(null),_(null);const K=b+1;N(K),z(K),a("recording")}else _("Maximum attempts reached")},[b,k,z]),M=C.useCallback(async()=>{if(!(!c||!f)){y(!0);try{const K=new Date,Z=e.start_time?Math.round((K-e.start_time)/1e3):0,J=e.start_time?new Date(e.start_time).toISOString():K.toISOString(),ne=ee.student_id,me=`retest_assignment_id_${ne}_speaking_${e.test_id}`,xe=localStorage.getItem(me),Ne={test_id:e.test_id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:ne,question_id:e.question_id||1,audio_blob:i?await B(i):null,audio_duration:i?.duration||0,time_taken:Z,started_at:J,submitted_at:K.toISOString(),caught_cheating:!1,visibility_change_times:0,is_completed:!0,retest_assignment_id:xe?Number(xe):null,parent_test_id:e.test_id,transcript:c,scores:f,final_submission:!0};console.log(" Final submission:",Ne),console.log(" Making final submission request...");const le=await ie("/.netlify/functions/submit-speaking-test-final",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ne)});console.log(" Final submission response status:",le.status);const ge=await le.json();if(console.log(" Final submission result:",ge),ge.success){if(ee?.student_id){const Ie=`test_completed_${ee.student_id}_speaking_${e.test_id}`;localStorage.setItem(Ie,"true"),console.log(" Speaking test marked as completed in localStorage:",Ie);const Pe=`speaking_attempts_${ee.student_id}_${e.test_id}`;localStorage.removeItem(Pe),console.log(" Cleared attempts from localStorage upon submission");const{clearTestData:Qe}=await Vo(async()=>{const{clearTestData:_t}=await Promise.resolve().then(()=>Lh);return{clearTestData:_t}},void 0);Qe(ee.student_id,"speaking_test_data",e.test_id),console.log(" Cleared speaking test data from cache upon submission")}console.log(" Caching speaking test results after submission...");const Ge=`student_results_table_${ee?.student_id||ee?.id||"unknown"}`,{setCachedData:Je,CACHE_TTL:He,clearTestData:Ft}=await Vo(async()=>{const{setCachedData:Ie,CACHE_TTL:Pe,clearTestData:Qe}=await Promise.resolve().then(()=>Lh);return{setCachedData:Ie,CACHE_TTL:Pe,clearTestData:Qe}},void 0),rt={success:!0,results:[{id:Date.now(),test_id:e.test_id,test_type:"speaking",test_name:e.test_name,score:Math.round(f.overall_score/10),max_score:10,percentage:f.overall_score,caught_cheating:!1,visibility_change_times:0,is_completed:!0,submitted_at:new Date().toISOString(),academic_period_id:3,subject:"Listening and Speaking",teacher_name:e.teacher_name||"Unknown"}]};Je(Ge,rt,He.student_results_table),console.log(" Speaking test results cached with key:",Ge),ee?.student_id&&Ft(ee.student_id,"speaking",e.test_id),a("completed"),t({test_id:e.test_id,transcript:c,scores:f,attempt_number:b}),n&&n(f.overall_score)}else throw new Error(ge.message||"Failed to submit speaking test")}catch(K){console.error("Speaking test submission error:",K),_(K.message)}finally{y(!1)}}},[e,ee,ie,c,f,i,b,t]);C.useCallback(()=>{a("completed"),t({test_id:e.test_id,transcript:c,scores:f,attempt_number:b})},[e.test_id,c,f,b,t]);const X=()=>{switch(s){case"recording":return o.jsxs("div",{className:"speaking-test-recording",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4 text-center",children:e.test_name}),o.jsxs("div",{className:"mb-6 text-center",children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Instructions:"}),o.jsx("p",{className:"text-gray-700 mb-4",children:e.prompt}),o.jsx("div",{className:"bg-blue-50 p-3 sm:p-4 rounded-lg",children:o.jsxs("p",{className:"text-sm text-blue-800",children:[o.jsx("strong",{children:"Requirements:"})," Minimum ",e.min_words||50," words, 0-",e.max_duration||600," seconds duration"]})})]}),o.jsx(Uz,{ref:re,onRecordingComplete:q,minDuration:0,maxDuration:e.max_duration||600,minWords:e.min_words||50,maxAttempts:k,currentAttempt:b}),v&&o.jsx("div",{className:"mt-4 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg",children:o.jsx("p",{className:"text-red-800",children:v})})]});case"processing":return o.jsxs("div",{className:"transcription-status bg-white rounded-lg shadow-lg p-4 sm:p-8 text-center",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("div",{className:"text-6xl mb-4",children:""}),o.jsx("h3",{className:"text-2xl font-semibold mb-2",children:"Processing Your Speech"}),o.jsx("p",{className:"text-lg text-blue-600",children:"Please wait while we process your audio..."})]}),o.jsxs("div",{className:"inline-flex space-x-1",children:[o.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),o.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),o.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]});case"feedback":return console.log(" Rendering feedback step with Submit Final button"),o.jsx($z,{transcript:c,scores:f,audioBlob:i,recordingTime:A,onReRecord:L,onFinalSubmit:M,canReRecord:b<k,attemptNumber:b,maxAttempts:k,isSubmitting:g});case"completed":const K={showResults:!0,testInfo:{test_name:e?.test_name||"Speaking Test",id:e?.test_id,test_id:e?.test_id},testType:"speaking",score:f?.overall_score||0,totalQuestions:1,percentage:f?.overall_score||0,passed:(f?.overall_score||0)>=50,questionAnalysis:[{questionNumber:1,userAnswer:c,correctAnswer:"Speaking test completed",isCorrect:!0,score:f?.overall_score||0,maxScore:100,feedback:`Word Count: ${f?.word_count||0}, Grammar: ${f?.grammar_score||0}/40, Vocabulary: ${f?.vocab_score||0}/30`}],timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};return o.jsx("div",{className:"speaking-test-completed",children:o.jsx(Kp,{testResults:K,onBackToCabinet:r,onRetakeTest:()=>{a("recording"),d(""),p(null),l(null),N(1)},isLoading:!1})});default:return null}};return o.jsx("div",{children:o.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-3 sm:p-6",children:[v&&o.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:o.jsx("p",{className:"text-red-800",children:v})}),X()]})})},zz=()=>{const{testId:e}=j1(),t=Ri(),{user:r}=Hn(),n=Xi(),[s,a]=C.useState(null),[i,l]=C.useState([]),[c,d]=C.useState(!0),[f,p]=C.useState(null),[g,y]=C.useState(!1),[v,_]=C.useState(null);C.useEffect(()=>{b(),N()},[e]);const b=async()=>{try{d(!0);const A=await n.getSpeakingTest(e);if(A.success)a(A.test);else throw new Error(A.message||"Failed to load test");const F=await n.getSpeakingTestQuestions(e);F.success&&l(F.questions)}catch(A){console.error("Error loading test data:",A),p(A.message)}finally{d(!1)}},N=()=>{const F=`test_completed_${r?.student_id||r?.id}_speaking_${e}`;if(localStorage.getItem(F)==="true"){y(!0);const E=localStorage.getItem(`speaking_test_result_${e}`);E&&_(JSON.parse(E))}},k=async A=>{try{y(!0),_(A),localStorage.setItem(`speaking_test_result_${e}`,JSON.stringify(A)),window.dispatchEvent(new CustomEvent("testCompleted",{detail:{testId:e,testType:"speaking"}})),setTimeout(()=>{t("/student")},2e3)}catch(F){console.error("Error handling test completion:",F)}},w=()=>{t("/student")};if(c)return o.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[o.jsx("div",{className:"bg-white shadow-sm border-b",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center py-4",children:[o.jsx("div",{children:o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),o.jsx(et,{variant:"outline",onClick:w,children:"Back to Cabinet"})]})})}),o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:o.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),o.jsx("p",{className:"text-gray-600 mt-4",children:"Loading speaking test..."})]})})})]});if(f)return o.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[o.jsx("div",{className:"bg-white shadow-sm border-b",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center py-4",children:[o.jsx("div",{children:o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),o.jsx(et,{variant:"outline",onClick:w,children:"Back to Cabinet"})]})})}),o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:o.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-red-600 text-6xl mb-4",children:""}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Test"}),o.jsx("p",{className:"text-gray-600 mb-6",children:f})]})})})]});if(g&&v)return o.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[o.jsx("div",{className:"bg-white shadow-sm border-b",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center py-4",children:[o.jsx("div",{children:o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test Results"})}),o.jsx(et,{variant:"outline",onClick:w,children:"Back to Cabinet"})]})})}),o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:o.jsx(Kp,{testType:"speaking",testData:s,result:v,onRetake:()=>{y(!1),_(null);const A=JSON.parse(localStorage.getItem("userData")||"{}").student_id;localStorage.removeItem(`test_completed_${A}_speaking_${e}`)}})})]});if(!s||i.length===0)return o.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[o.jsx("div",{className:"bg-white shadow-sm border-b",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center py-4",children:[o.jsx("div",{children:o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),o.jsx(et,{variant:"outline",onClick:w,children:"Back to Cabinet"})]})})}),o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:o.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"No Test Data"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Unable to load test information"})]})})})]});const T=i[0];return o.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[o.jsx("div",{className:"bg-white shadow-sm border-b",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center py-4",children:[o.jsx("div",{children:o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),o.jsx(et,{variant:"outline",onClick:w,children:"Back to Cabinet"})]})})}),o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:o.jsx(Wz,{testData:{...s,test_id:parseInt(e),question_id:T?.id,prompt:T?.prompt,start_time:Date.now()},onComplete:k,onExit:w,onTestComplete:k})})]})},Hz=()=>{const{testType:e,testId:t}=j1(),r=Ri(),{activeTests:n}=Vp(),s=()=>{r("/student")},a=n.find(i=>i.test_type===e&&i.test_id===parseInt(t));return o.jsx(Oz,{onBackToCabinet:s,currentTest:a||{test_type:e,test_id:parseInt(t)}})},Gz=()=>{const e=Ri(),{user:t,isAuthenticated:r,isLoading:n}=Hn(),[s,a]=C.useState(!1),[i,l]=C.useState(!0),[c,d]=C.useState(""),[f,p]=C.useState([]),[g,y]=C.useState(!1),[v,_]=C.useState(!1),[b,N]=C.useState({currentPassword:"",newPassword:"",confirmPassword:""}),k=C.useCallback(async()=>{console.log(" Initializing Student Application...");try{if(l(!0),d(""),!r||!t){console.log(" User not authenticated, redirecting to login"),e("/login");return}if(t.role!==ui.STUDENT){console.error(" Invalid user role for student app:",t.role),d("Access denied. Student role required.");return}console.log(" Initializing event listeners..."),w(),console.log(" Setting up back to cabinet button listeners..."),T(),console.log(" Setting up password change form listener..."),A(),console.log(" Loading student data..."),await F(),console.log(" Exposing student functions globally..."),R(),console.log(" Populating student info from user data..."),ee(t),a(!0),console.log(" Student Application initialization complete!")}catch(se){console.error(" Error initializing student app:",se),d("Failed to initialize student application")}finally{l(!1)}},[r,t,e]);C.useEffect(()=>{n||k()},[n,r,t,k]);const w=C.useCallback(()=>{console.log(" Setting up student event listeners...");const se=z=>{g&&!z.target.closest(".student-menu")&&y(!1)},B=z=>{z.key==="Escape"&&g&&y(!1)};return document.addEventListener("click",se),document.addEventListener("keydown",B),()=>{document.removeEventListener("click",se),document.removeEventListener("keydown",B)}},[g]),T=C.useCallback(()=>{console.log(" Setting up back to cabinet listeners...")},[]),A=C.useCallback(()=>{console.log(" Setting up password change form...")},[]),F=C.useCallback(async()=>{console.log(" Loading student data...");try{console.log(" Student data loaded successfully")}catch(se){throw console.error(" Error loading student data:",se),se}},[]),R=C.useCallback(()=>{console.log(" Exposing student functions globally..."),window.toggleStudentMenu=E,window.showChangePasswordTab=D,window.hideChangePasswordTab=I,window.navigateBackToCabinet=Y,window.handlePasswordChange=G,window.populateStudentInfoDirectly=ee,console.log(" All student functions exposed globally")},[]),E=C.useCallback(()=>{console.log(" toggleStudentMenu called"),y(se=>{const B=!se;return console.log(" Menu state changed from",se,"to",B),B}),console.log(" Toggled dropdown menu")},[]),D=C.useCallback(()=>{console.log(" showChangePasswordTab called"),_(!0),y(!1)},[]),I=C.useCallback(()=>{console.log(" hideChangePasswordTab called"),_(!1),N({currentPassword:"",newPassword:"",confirmPassword:""})},[]),G=C.useCallback(async se=>{se.preventDefault(),console.log(" handlePasswordChange called");const{currentPassword:B,newPassword:z,confirmPassword:U}=b;if(!B||!z||!U){ie("Please fill in all fields","error");return}if(z!==U){ie("New passwords do not match","error");return}if(z.length<6){ie("New password must be at least 6 characters long","error");return}const V=/[a-zA-Z]/.test(z),q=/[0-9]/.test(z);if(!V||!q){ie("New password must contain both letters and numbers","error");return}if(!t||!t.student_id){ie("Session expired. Please login again.","error");return}const L=t.student_id;if(window.confirm("Are you sure you want to change your password?"))try{l(!0);const M=await Sn.changePassword({studentId:L,currentPassword:B,newPassword:z});M.success?(ie("Password changed successfully!","success"),I()):ie(M.message||"Failed to change password","error")}catch(M){console.error("Password change error:",M),ie("Failed to change password. Please try again.","error")}finally{l(!1)}},[b,t]),Y=C.useCallback(()=>{if(console.log("[DEBUG] navigateBackToCabinet called"),!r||!t){console.warn("[WARN] No valid user found, redirecting to login"),e("/login");return}t.role===ui.STUDENT?(console.log("[DEBUG] Navigating to student cabinet"),e("/student")):(console.warn("[WARN] Unknown user role, redirecting to login"),e("/login"))},[r,t,e]),ee=C.useCallback(se=>{console.log(" populateStudentInfoDirectly called with:",se);try{console.log(" Student info populated successfully")}catch(B){console.error(" Error populating student info:",B)}},[]),ie=C.useCallback((se,B)=>{const z={id:Date.now(),message:se,type:B,timestamp:new Date};p(U=>[...U,z]),setTimeout(()=>{p(U=>U.filter(V=>V.id!==z.id))},Ti.NOTIFICATION_DURATION)},[]),re=C.useCallback(se=>{const{name:B,value:z}=se.target;N(U=>({...U,[B]:z}))},[]);return i?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Fr,{size:"lg"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Initializing Student Application..."})]})}):c?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsx("div",{className:"text-center",children:o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[o.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Initialization Error"}),o.jsx("p",{className:"text-red-600 mb-4",children:c}),o.jsx(et,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?o.jsxs("div",{className:"bg-gray-50",children:[o.jsxs(b2,{children:[o.jsx(ds,{path:"/",element:o.jsxs("div",{className:"student-app",children:[o.jsx(Iz,{isMenuOpen:g,onToggleMenu:E,onShowPasswordChange:D}),v&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Change Password"}),o.jsxs("form",{onSubmit:G,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),o.jsx("input",{type:"password",id:"currentPassword",name:"currentPassword",value:b.currentPassword,onChange:re,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),o.jsx("input",{type:"password",id:"newPassword",name:"newPassword",value:b.newPassword,onChange:re,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),o.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:b.confirmPassword,onChange:re,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),o.jsxs("div",{className:"flex space-x-3 pt-4",children:[o.jsx(et,{type:"button",variant:"secondary",onClick:I,className:"flex-1",children:"Cancel"}),o.jsx(et,{type:"submit",variant:"primary",disabled:i,className:"flex-1",children:i?o.jsxs(o.Fragment,{children:[o.jsx(Fr,{size:"sm",className:"mr-2"}),"Changing..."]}):"Change Password"})]})]})]})})]})}),o.jsx(ds,{path:"/test/:testType/:testId",element:o.jsx(Hz,{})}),o.jsx(ds,{path:"matching-test/:testId",element:o.jsx(Lz,{})}),o.jsx(ds,{path:"word-matching-test/:testId",element:o.jsx(Bz,{})}),o.jsx(ds,{path:"speaking-test/:testId",element:o.jsx(zz,{})}),o.jsx(ds,{path:"/results",element:o.jsx(Qj,{})})]}),o.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:f.map(se=>o.jsx(Zo,{type:se.type,message:se.message,onClose:()=>p(B=>B.filter(z=>z.id!==se.id))},se.id))})]}):o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Fr,{size:"lg"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Setting up Student Application..."})]})})},Vz=()=>o.jsx(W3,{children:o.jsx(Uj,{children:o.jsx(Lj,{children:o.jsx(Gz,{})})})}),Kz=({result:e,isOpen:t,onClose:r,initialTab:n="overview",editingSpeakingScore:s,tempSpeakingScore:a,isSavingSpeakingScore:i,onStartSpeakingScoreEdit:l,onSaveSpeakingScore:c,onCancelSpeakingScoreEdit:d,onTempSpeakingScoreChange:f})=>{const[p,g]=C.useState(n),y=C.useRef(!1);if(C.useEffect(()=>()=>{y.current=!0},[]),C.useEffect(()=>{t&&g(n)},[t,n]),!t||!e)return null;const v={test_id:e.test_id,test_name:e.test_name,subject_id:e.subject_id};let _=e?.__audioUrl||void 0;const b=_?void 0:e?.answers;typeof b=="string"?_=b:b&&typeof b=="object"&&(_=b.audio_url),C.useEffect(()=>{console.log("[SpeakingReview] Transcript sources",{fromResult:e?.transcript,fromAnswersObject:typeof b=="object"&&b?.transcript?b.transcript:void 0,hasAnswers:!!b,test_id:e?.test_id,student_id:e?.student_id})},[e?.test_id,e?.student_id]);const[N,k]=C.useState("");C.useEffect(()=>{const T=new AbortController;let A=!1;const F=e?.__studentId||e?.student_id;return!e?.transcript&&!(typeof b=="object"&&b?.transcript)&&e?.test_id&&F&&(async()=>{try{const R=`/.netlify/functions/get-speaking-test-new?action=transcript&test_id=${encodeURIComponent(e.test_id)}&student_id=${encodeURIComponent(F)}`;console.log("[SpeakingReview] Fetching transcript from API:",{url:R});const E=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token"),D=await fetch(R,{headers:{Authorization:E?`Bearer ${E}`:""},signal:T.signal});console.log("[SpeakingReview] Transcript API response:",{ok:D.ok,status:D.status});const I=await D.json().catch(()=>({}));console.log("[SpeakingReview] Transcript API body:",I),!A&&!y.current&&(D.ok?k(I.transcript||""):console.warn("[SpeakingReview] Transcript API failed:",I?.error||"unknown error"))}catch(R){R.name!=="AbortError"&&!y.current&&console.error("[SpeakingReview] Transcript fetch error:",R)}})(),()=>{A=!0;try{T.abort()}catch{}}},[e]);const w={score:e.score,max_score:e.max_score,percentage:e.percentage,audio_url:_,transcript:e.transcript||N||(typeof b=="object"&&b?.transcript?b.transcript:void 0),time_taken:e.time_taken,started_at:e.started_at,submitted_at:e.submitted_at};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[o.jsxs("div",{className:"bg-blue-600 text-white px-6 py-4 flex justify-between items-center",children:[o.jsxs("h2",{className:"text-xl font-semibold",children:["Speaking Test Review - ",v.test_name]}),o.jsx("button",{onClick:r,className:"text-white hover:text-gray-200 text-2xl font-bold",children:""})]}),o.jsx("div",{className:"border-b border-gray-200",children:o.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"audio",label:"Audio"},{id:"transcript",label:"Transcript"},{id:"analysis",label:"AI Analysis"},{id:"scoring",label:"Scoring"}].map(T=>o.jsx("button",{onClick:()=>g(T.id),className:`py-4 px-1 border-b-2 font-medium text-sm ${p===T.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:T.label},T.id))})}),o.jsxs("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:[p==="overview"&&o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Test Name"}),o.jsx("p",{className:"mt-1 text-sm text-gray-900",children:v.test_name})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Score"}),o.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[w.score," / ",w.max_score]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Time Taken"}),o.jsx("p",{className:"mt-1 text-sm text-gray-900",children:w.time_taken?`${Math.floor(w.time_taken/60)}:${(w.time_taken%60).toString().padStart(2,"0")}`:"N/A"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Submitted At"}),o.jsx("p",{className:"mt-1 text-sm text-gray-900",children:w.submitted_at?new Date(w.submitted_at).toLocaleString():"N/A"})]})]})}),p==="audio"&&o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Audio Recording"}),w.audio_url?o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Click the play button to listen to the student's recording:"}),o.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:o.jsx(Zj,{audioUrl:w.audio_url,className:"w-full"})})]}):o.jsx("div",{className:"text-center py-8 text-gray-500",children:o.jsx("p",{children:"No audio recording available"})})]}),p==="transcript"&&o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Transcript"}),w.transcript?o.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:o.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:w.transcript})}):o.jsx("div",{className:"text-center py-8 text-gray-500",children:o.jsx("p",{children:"No transcript available"})})]}),p==="analysis"&&o.jsxs("div",{className:"space-y-6",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"AI Analysis Results"}),(()=>{let T=e.ai_feedback;if(T&&typeof T=="string")try{T=JSON.parse(T)}catch{T=null}return T?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[o.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-4",children:"Overall Performance"}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-3xl font-bold text-gray-800",children:T.overall_score||0}),o.jsx("div",{className:"text-sm text-gray-600",children:"Overall Score (0-100)"})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[o.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-4",children:"Category Breakdown"}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[T.grammar_score||0,"/25"]}),o.jsx("div",{className:"text-xs text-gray-600",children:"Grammar"})]}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"text-lg font-bold text-green-600",children:[T.vocabulary_score||0,"/20"]}),o.jsx("div",{className:"text-xs text-gray-600",children:"Vocabulary"})]}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[T.pronunciation_score||0,"/15"]}),o.jsx("div",{className:"text-xs text-gray-600",children:"Pronunciation"})]}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"text-lg font-bold text-orange-600",children:[T.fluency_score||0,"/20"]}),o.jsx("div",{className:"text-xs text-gray-600",children:"Fluency"})]}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"text-lg font-bold text-red-600",children:[T.content_score||0,"/20"]}),o.jsx("div",{className:"text-xs text-gray-600",children:"Content"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[o.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Performance Metrics"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Word Count:"}),o.jsx("span",{className:"text-sm font-medium",children:T.word_count||0})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Grammar Mistakes:"}),o.jsx("span",{className:"text-sm font-medium text-red-600",children:T.grammar_mistakes||0})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Vocabulary Issues:"}),o.jsx("span",{className:"text-sm font-medium text-red-600",children:T.vocabulary_mistakes||0})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-sm text-gray-600",children:"Difficulty Level:"}),o.jsx("span",{className:"text-sm font-medium",children:T.difficulty_level||"N/A"})]})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[o.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"AI Feedback"}),T.feedback?o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:o.jsx("p",{className:"text-sm text-gray-700",children:T.feedback})}):o.jsx("div",{className:"text-center py-4 text-gray-500",children:o.jsx("p",{className:"text-sm",children:"No AI feedback available"})})]})]}),T.improved_transcript&&o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[o.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Improved Transcript"}),o.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:o.jsx("p",{className:"text-sm text-gray-700",children:T.improved_transcript})})]}),T.grammar_corrections&&T.grammar_corrections.length>0&&o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[o.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Grammar Corrections"}),o.jsx("div",{className:"space-y-3",children:T.grammar_corrections.map((A,F)=>o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[o.jsxs("div",{className:"text-sm",children:[o.jsx("span",{className:"font-medium text-red-800",children:"Mistake:"})," ",A.mistake]}),o.jsxs("div",{className:"text-sm mt-1",children:[o.jsx("span",{className:"font-medium text-green-800",children:"Correction:"})," ",A.correction]}),A.explanation&&o.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[o.jsx("span",{className:"font-medium",children:"Explanation:"})," ",A.explanation]})]},F))})]}),T.vocabulary_corrections&&T.vocabulary_corrections.length>0&&o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[o.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Vocabulary Improvements"}),o.jsx("div",{className:"space-y-3",children:T.vocabulary_corrections.map((A,F)=>o.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[o.jsxs("div",{className:"text-sm",children:[o.jsx("span",{className:"font-medium text-yellow-800",children:"Original:"})," ",A.mistake]}),o.jsxs("div",{className:"text-sm mt-1",children:[o.jsx("span",{className:"font-medium text-green-800",children:"Better:"})," ",A.correction]}),A.explanation&&o.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[o.jsx("span",{className:"font-medium",children:"Explanation:"})," ",A.explanation]})]},F))})]})]}):o.jsx("div",{className:"text-center py-8 text-gray-500",children:o.jsx("p",{children:"No AI analysis available for this result"})})})()]}),p==="scoring"&&o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 text-center",children:"Score Details"}),s?o.jsxs("div",{className:"space-y-4 text-center",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 place-items-center",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Score"}),o.jsx("input",{type:"number",min:"0",max:w.max_score,value:a,onChange:T=>f(T.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Max Score"}),o.jsxs("p",{className:"mt-1 text-sm text-gray-900 text-center",children:[w.max_score," (Fixed)"]})]})]}),o.jsxs("div",{className:"flex justify-center space-x-3",children:[o.jsx("button",{onClick:c,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:i?"Saving...":"Save Score"}),o.jsx("button",{onClick:d,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Cancel"})]})]}):o.jsxs("div",{className:"space-y-4 text-center",children:[o.jsx("div",{className:"grid grid-cols-1 place-items-center gap-2",children:o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Current Score"}),o.jsxs("p",{className:"mt-1 text-sm text-gray-900 text-center",children:[w.score," / ",w.max_score]})]})}),o.jsx("button",{onClick:()=>l(e.id,w.score),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 mx-auto",children:"Edit Score"})]})]})]}),o.jsx("div",{className:"bg-gray-50 px-6 py-4 flex justify-end space-x-3",children:o.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Close"})})]})})};class hN extends us.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){if(console.error("ErrorBoundary caught an error:",t,r),t.message&&t.message.includes("Minified React error #300")){console.warn("React error #300 caught and handled by ErrorBoundary");return}}render(){return this.state.hasError?o.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[o.jsx("h3",{className:"text-red-800 font-medium",children:"Something went wrong"}),o.jsx("p",{className:"text-red-600 text-sm mt-1",children:"An error occurred while rendering this component."})]}):this.props.children}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var g1={};g1.version="0.18.5";var e8=1252,qz=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],sS={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},aS=function(e){qz.indexOf(e)!=-1&&(e8=sS[0]=e)};function Xz(){aS(1252)}var qo=function(e){aS(e)};function iS(){qo(1200),Xz()}function gN(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Yz(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function t8(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Tm=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Yz(e.slice(2)):t==254&&r==255?t8(e.slice(2)):t==65279?e.slice(1):e},yy=function(t){return String.fromCharCode(t)},mN=function(t){return String.fromCharCode(t)},dp,Fu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function fp(e){for(var t="",r=0,n=0,s=0,a=0,i=0,l=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),a=r>>2,n=e.charCodeAt(d++),i=(r&3)<<4|n>>4,s=e.charCodeAt(d++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),t+=Fu.charAt(a)+Fu.charAt(i)+Fu.charAt(l)+Fu.charAt(c);return t}function qi(e){var t="",r=0,n=0,s=0,a=0,i=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)a=Fu.indexOf(e.charAt(d++)),i=Fu.indexOf(e.charAt(d++)),r=a<<2|i>>4,t+=String.fromCharCode(r),l=Fu.indexOf(e.charAt(d++)),n=(i&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Fu.indexOf(e.charAt(d++)),s=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Ur=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ic=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Wu(e){return Ur?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function pN(e){return Ur?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Gi=function(t){return Ur?Ic(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function tv(e){if(typeof ArrayBuffer>"u")return Gi(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Zu(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Jz(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function oS(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return oS(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var oa=Ur?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ic(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Qz(e){for(var t=[],r=0,n=e.length+250,s=Wu(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var l=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|l>>6&15|(i&3)<<4,s[r++]=128|l&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Wu(65535),n=65530)}return t.push(s.slice(0,r)),oa(t)}var hi=/\u0000/g,Em=/[\u0001-\u0006]/g;function t0(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Xo(e,t){var r=""+e;return r.length>=t?r:fs("0",t-r.length)+r}function lS(e,t){var r=""+e;return r.length>=t?r:fs(" ",t-r.length)+r}function m1(e,t){var r=""+e;return r.length>=t?r:r+fs(" ",t-r.length)}function Zz(e,t){var r=""+Math.round(e);return r.length>=t?r:fs("0",t-r.length)+r}function eH(e,t){var r=""+e;return r.length>=t?r:fs("0",t-r.length)+r}var xN=Math.pow(2,32);function Nh(e,t){if(e>xN||e<-xN)return Zz(e,t);var r=Math.round(e);return eH(r,t)}function p1(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var yN=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Uw=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function tH(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var wr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},vN={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},rH={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function x1(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,l=0,c=1,d=0,f=0,p=Math.floor(s);d<t&&(p=Math.floor(s),l=p*i+a,f=p*d+c,!(s-p<5e-8));)s=1/(s-p),a=i,i=l,c=d,d=f;if(f>t&&(d>t?(f=c,l=a):(f=d,l=i)),!r)return[0,n*l,f];var g=Math.floor(n*l/f);return[g,n*l-g*f,f]}function $d(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],l={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=lH(c,i))}return l.y=i[0],l.m=i[1],l.d=i[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=a,l}var r8=new Date(1899,11,31,0,0,0),nH=r8.getTime(),sH=new Date(1900,2,1,0,0,0);function n8(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=sH&&(r+=1440*60*1e3),(r-(nH+(e.getTimezoneOffset()-r8.getTimezoneOffset())*6e4))/(1440*60*1e3)}function cS(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function aH(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function iH(e){var t=e<0?12:11,r=cS(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function oH(e){var t=cS(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function hp(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=iH(e):t===10?r=e.toFixed(10).substr(0,12):r=oH(e),cS(aH(r.toUpperCase()))}function hf(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):hp(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Co(14,n8(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function lH(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function cH(e,t,r,n){var s="",a=0,i=0,l=r.y,c,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return Uw[r.m-1][1];case 5:return Uw[r.m-1][0];default:return Uw[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return yN[r.q][0];default:return yN[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Xo(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=Xo(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=l,d=1;break}var f=d>0?Xo(c,d):"";return f}function Pu(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var s8=/%/g;function uH(e,t,r){var n=t.replace(s8,""),s=t.length-n.length;return Cc(e,n,r*Math.pow(10,2*s))+fs("%",s)}function dH(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Cc(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function a8(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+a8(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,f){return c+d+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var i8=/# (\?+)( ?)\/( ?)(\d+)/;function fH(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,l=n;return r+(a===0?"":""+a)+" "+(i===0?fs(" ",e[1].length+1+e[4].length):lS(i,e[1].length)+e[2]+"/"+e[3]+Xo(l,e[4].length))}function hH(e,t,r){return r+(t===0?"":""+t)+fs(" ",e[1].length+2+e[4].length)}var o8=/^#*0*\.([0#]+)/,l8=/\).*[0#]/,c8=/\(###\) ###\\?-####/;function li(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function wN(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function _N(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function gH(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function mH(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ho(e,t,r){if(e.charCodeAt(0)===40&&!t.match(l8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ho("n",n,r):"("+ho("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return dH(e,t,r);if(t.indexOf("%")!==-1)return uH(e,t,r);if(t.indexOf("E")!==-1)return a8(t,r);if(t.charCodeAt(0)===36)return"$"+ho(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Nh(c,t.length);if(t.match(/^[#?]+$/))return s=Nh(r,0),s==="0"&&(s=""),s.length>t.length?s:li(t.substr(0,t.length-s.length))+s;if(a=t.match(i8))return fH(a,c,d);if(t.match(/^#+0+$/))return d+Nh(c,t.length-t.indexOf("0"));if(a=t.match(o8))return s=wN(r,a[1].length).replace(/^([^\.]+)$/,"$1."+li(a[1])).replace(/\.$/,"."+li(a[1])).replace(/\.(\d*)$/,function(v,_){return"."+_+fs("0",li(a[1]).length-_.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return d+wN(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return d+Pu(Nh(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ho(e,t,-r):Pu(""+(Math.floor(r)+gH(r,a[1].length)))+"."+Xo(_N(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return ho(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=t0(ho(e,t.replace(/[\\-]/g,""),r)),i=0,t0(t0(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(t.match(c8))return s=ho(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),l=x1(c,Math.pow(10,i)-1,!1),s=""+d,f=Cc("n",a[1],l[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=m1(l[2],i),f.length<a[4].length&&(f=li(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),l=x1(c,Math.pow(10,i)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?lS(l[1],i)+a[2]+"/"+a[3]+m1(l[2],i):fs(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=Nh(r,0),t.length<=s.length?s:li(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var p=t.indexOf(".")-i,g=t.length-s.length-p;return li(t.substr(0,p)+s+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=_N(r,a[1].length),r<0?"-"+ho(e,t,-r):Pu(mH(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Xo(0,3-v.length):"")+v})+"."+Xo(i,a[1].length);switch(t){case"###,##0.00":return ho(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=Pu(Nh(c,0));return y!=="0"?d+y:"";case"###,###.00":return ho(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ho(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function pH(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Cc(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function xH(e,t,r){var n=t.replace(s8,""),s=t.length-n.length;return Cc(e,n,r*Math.pow(10,2*s))+fs("%",s)}function u8(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+u8(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,f){return c+d+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Cl(e,t,r){if(e.charCodeAt(0)===40&&!t.match(l8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Cl("n",n,r):"("+Cl("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return pH(e,t,r);if(t.indexOf("%")!==-1)return xH(e,t,r);if(t.indexOf("E")!==-1)return u8(t,r);if(t.charCodeAt(0)===36)return"$"+Cl(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Xo(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:li(t.substr(0,t.length-s.length))+s;if(a=t.match(i8))return hH(a,c,d);if(t.match(/^#+0+$/))return d+Xo(c,t.length-t.indexOf("0"));if(a=t.match(o8))return s=(""+r).replace(/^([^\.]+)$/,"$1."+li(a[1])).replace(/\.$/,"."+li(a[1])),s=s.replace(/\.(\d*)$/,function(v,_){return"."+_+fs("0",li(a[1]).length-_.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return d+Pu(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Cl(e,t,-r):Pu(""+r)+"."+fs("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Cl(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=t0(Cl(e,t.replace(/[\\-]/g,""),r)),i=0,t0(t0(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(t.match(c8))return s=Cl(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),l=x1(c,Math.pow(10,i)-1,!1),s=""+d,f=Cc("n",a[1],l[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=m1(l[2],i),f.length<a[4].length&&(f=li(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),l=x1(c,Math.pow(10,i)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?lS(l[1],i)+a[2]+"/"+a[3]+m1(l[2],i):fs(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:li(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var p=t.indexOf(".")-i,g=t.length-s.length-p;return li(t.substr(0,p)+s+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Cl(e,t,-r):Pu(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Xo(0,3-v.length):"")+v})+"."+Xo(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=Pu(""+c);return y!=="0"?d+y:"";default:if(t.match(/\.[0#?]*$/))return Cl(e,t.slice(0,t.lastIndexOf(".")),r)+li(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Cc(e,t,r){return(r|0)===r?Cl(e,t,r):ho(e,t,r)}function yH(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var d8=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function R0(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":p1(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(d8))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function vH(e,t,r,n){for(var s=[],a="",i=0,l="",c="t",d,f,p,g="H";i<e.length;)switch(l=e.charAt(i)){case"G":if(!p1(e,i))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(p=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(p);s[s.length]={t:"t",v:a},++i;break;case"\\":var y=e.charAt(++i),v=y==="("||y===")"?y:"t";s[s.length]={t:v,v:y},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(d==null&&(d=$d(t,r,e.charAt(i+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},c=l,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=$d(t,r),d==null))return"";for(a=l;++i<e.length&&e.charAt(i).toLowerCase()===l;)a+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=g),s[s.length]={t:l,v:a},c=l;break;case"A":case"a":case"":var _={t:l,v:l};if(d==null&&(d=$d(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(d!=null&&(_.v=d.H>=12?"P":"A"),_.t="T",g="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(d!=null&&(_.v=d.H>=12?"PM":"AM"),_.t="T",i+=5,g="h"):e.substr(i,5).toUpperCase()==="/"?(d!=null&&(_.v=d.H>=12?"":""),_.t="T",i+=5,g="h"):(_.t="t",++i),d==null&&_.t==="T")return"";s[s.length]=_,c=l;break;case"[":for(a=l;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(d8)){if(d==null&&(d=$d(t,r),d==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",R0(e)||(s[s.length]={t:"t",v:a}));break;case".":if(d!=null){for(a=l;++i<e.length&&(l=e.charAt(i))==="0";)a+=l;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++i<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(i))>-1;)a+=l;s[s.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++i)===l;)a+=l;s[s.length]={t:l,v:a},c=l;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:l,v:l},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++i;break}var b=0,N=0,k;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=g,c="h",b<1&&(b=1);break;case"s":(k=s[i].v.match(/\.0+$/))&&(N=Math.max(N,k[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&s[i].v.match(/[Hh]/)&&(b=1),b<2&&s[i].v.match(/[Mm]/)&&(b=2),b<3&&s[i].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var w="",T;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=cH(s[i].t.charCodeAt(0),s[i].v,d,N),s[i].t="t";break;case"n":case"?":for(T=i+1;s[T]!=null&&((l=s[T].t)==="?"||l==="D"||(l===" "||l==="t")&&s[T+1]!=null&&(s[T+1].t==="?"||s[T+1].t==="t"&&s[T+1].v==="/")||s[i].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[T].v==="/"||s[T].v===" "&&s[T+1]!=null&&s[T+1].t=="?"));)s[i].v+=s[T].v,s[T]={v:"",t:";"},++T;w+=s[i].v,i=T-1;break;case"G":s[i].t="t",s[i].v=hf(t,r);break}var A="",F,R;if(w.length>0){w.charCodeAt(0)==40?(F=t<0&&w.charCodeAt(0)===45?-t:t,R=Cc("n",w,F)):(F=t<0&&n>1?-t:t,R=Cc("n",w,F),F<0&&s[0]&&s[0].t=="t"&&(R=R.substr(1),s[0].v="-"+s[0].v)),T=R.length-1;var E=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){E=i;break}var D=s.length;if(E===s.length&&R.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(T>=s[i].v.length-1?(T-=s[i].v.length,s[i].v=R.substr(T+1,s[i].v.length)):T<0?s[i].v="":(s[i].v=R.substr(0,T+1),T=-1),s[i].t="t",D=i);T>=0&&D<s.length&&(s[D].v=R.substr(0,T+1)+s[D].v)}else if(E!==s.length&&R.indexOf("E")===-1){for(T=R.indexOf(".")-1,i=E;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(f=s[i].v.indexOf(".")>-1&&i===E?s[i].v.indexOf(".")-1:s[i].v.length-1,A=s[i].v.substr(f+1);f>=0;--f)T>=0&&(s[i].v.charAt(f)==="0"||s[i].v.charAt(f)==="#")&&(A=R.charAt(T--)+A);s[i].v=A,s[i].t="t",D=i}for(T>=0&&D<s.length&&(s[D].v=R.substr(0,T+1)+s[D].v),T=R.indexOf(".")+1,i=E;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==E)){for(f=s[i].v.indexOf(".")>-1&&i===E?s[i].v.indexOf(".")+1:0,A=s[i].v.substr(0,f);f<s[i].v.length;++f)T<R.length&&(A+=R.charAt(T++));s[i].v=A,s[i].t="t",D=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(F=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=Cc(s[i].t,s[i].v,F),s[i].t="t");var I="";for(i=0;i!==s.length;++i)s[i]!=null&&(I+=s[i].v);return I}var bN=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function SN(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function wH(e,t){var r=yH(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(bN),l=r[1].match(bN);return SN(t,i)?[n,r[0]]:SN(t,l)?[n,r[1]]:[n,r[i!=null&&l!=null?2:1]]}return[n,a]}function Co(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:wr)[e],n==null&&(n=r.table&&r.table[vN[e]]||wr[vN[e]]),n==null&&(n=rH[e]||"General");break}if(p1(n,0))return hf(t,r);t instanceof Date&&(t=n8(t,r.date1904));var s=wH(n,t);if(p1(s[1]))return hf(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return vH(s[1],t,r,s[0])}function Tc(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(wr[r]==null){t<0&&(t=r);continue}if(wr[r]==e){t=r;break}}t<0&&(t=391)}return wr[t]=e,t}function rv(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Tc(e[t],t)}function D0(){wr=tH()}var _H={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},f8=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function bH(e){var t=typeof e=="number"?wr[e]:e;return t=t.replace(f8,"(\\d+)"),new RegExp("^"+t+"$")}function SH(e,t,r){var n=-1,s=-1,a=-1,i=-1,l=-1,c=-1;(t.match(f8)||[]).forEach(function(p,g){var y=parseInt(r[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=y;break;case"d":a=y;break;case"h":i=y;break;case"s":c=y;break;case"m":i>=0?l=y:s=y;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&l==-1&&c==-1?d:n==-1&&s==-1&&a==-1?f:d+"T"+f}var kH=(function(){var e={};e.version="1.2.0";function t(){for(var R=0,E=new Array(256),D=0;D!=256;++D)R=D,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,E[D]=R;return typeof Int32Array<"u"?new Int32Array(E):E}var r=t();function n(R){var E=0,D=0,I=0,G=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)G[I]=R[I];for(I=0;I!=256;++I)for(D=R[I],E=256+I;E<4096;E+=256)D=G[E]=D>>>8^R[D&255];var Y=[];for(I=1;I!=16;++I)Y[I-1]=typeof Int32Array<"u"?G.subarray(I*256,I*256+256):G.slice(I*256,I*256+256);return Y}var s=n(r),a=s[0],i=s[1],l=s[2],c=s[3],d=s[4],f=s[5],p=s[6],g=s[7],y=s[8],v=s[9],_=s[10],b=s[11],N=s[12],k=s[13],w=s[14];function T(R,E){for(var D=E^-1,I=0,G=R.length;I<G;)D=D>>>8^r[(D^R.charCodeAt(I++))&255];return~D}function A(R,E){for(var D=E^-1,I=R.length-15,G=0;G<I;)D=w[R[G++]^D&255]^k[R[G++]^D>>8&255]^N[R[G++]^D>>16&255]^b[R[G++]^D>>>24]^_[R[G++]]^v[R[G++]]^y[R[G++]]^g[R[G++]]^p[R[G++]]^f[R[G++]]^d[R[G++]]^c[R[G++]]^l[R[G++]]^i[R[G++]]^a[R[G++]]^r[R[G++]];for(I+=15;G<I;)D=D>>>8^r[(D^R[G++])&255];return~D}function F(R,E){for(var D=E^-1,I=0,G=R.length,Y=0,ee=0;I<G;)Y=R.charCodeAt(I++),Y<128?D=D>>>8^r[(D^Y)&255]:Y<2048?(D=D>>>8^r[(D^(192|Y>>6&31))&255],D=D>>>8^r[(D^(128|Y&63))&255]):Y>=55296&&Y<57344?(Y=(Y&1023)+64,ee=R.charCodeAt(I++)&1023,D=D>>>8^r[(D^(240|Y>>8&7))&255],D=D>>>8^r[(D^(128|Y>>2&63))&255],D=D>>>8^r[(D^(128|ee>>6&15|(Y&3)<<4))&255],D=D>>>8^r[(D^(128|ee&63))&255]):(D=D>>>8^r[(D^(224|Y>>12&15))&255],D=D>>>8^r[(D^(128|Y>>6&63))&255],D=D>>>8^r[(D^(128|Y&63))&255]);return~D}return e.table=r,e.bstr=T,e.buf=A,e.str=F,e})(),gr=(function(){var t={};t.version="1.2.1";function r(ce,Se){for(var pe=ce.split("/"),ve=Se.split("/"),be=0,ke=0,We=Math.min(pe.length,ve.length);be<We;++be){if(ke=pe[be].length-ve[be].length)return ke;if(pe[be]!=ve[be])return pe[be]<ve[be]?-1:1}return pe.length-ve.length}function n(ce){if(ce.charAt(ce.length-1)=="/")return ce.slice(0,-1).indexOf("/")===-1?ce:n(ce.slice(0,-1));var Se=ce.lastIndexOf("/");return Se===-1?ce:ce.slice(0,Se+1)}function s(ce){if(ce.charAt(ce.length-1)=="/")return s(ce.slice(0,-1));var Se=ce.lastIndexOf("/");return Se===-1?ce:ce.slice(Se+1)}function a(ce,Se){typeof Se=="string"&&(Se=new Date(Se));var pe=Se.getHours();pe=pe<<6|Se.getMinutes(),pe=pe<<5|Se.getSeconds()>>>1,ce.write_shift(2,pe);var ve=Se.getFullYear()-1980;ve=ve<<4|Se.getMonth()+1,ve=ve<<5|Se.getDate(),ce.write_shift(2,ve)}function i(ce){var Se=ce.read_shift(2)&65535,pe=ce.read_shift(2)&65535,ve=new Date,be=pe&31;pe>>>=5;var ke=pe&15;pe>>>=4,ve.setMilliseconds(0),ve.setFullYear(pe+1980),ve.setMonth(ke-1),ve.setDate(be);var We=Se&31;Se>>>=5;var dt=Se&63;return Se>>>=6,ve.setHours(Se),ve.setMinutes(dt),ve.setSeconds(We<<1),ve}function l(ce){ka(ce,0);for(var Se={},pe=0;ce.l<=ce.length-4;){var ve=ce.read_shift(2),be=ce.read_shift(2),ke=ce.l+be,We={};switch(ve){case 21589:pe=ce.read_shift(1),pe&1&&(We.mtime=ce.read_shift(4)),be>5&&(pe&2&&(We.atime=ce.read_shift(4)),pe&4&&(We.ctime=ce.read_shift(4))),We.mtime&&(We.mt=new Date(We.mtime*1e3));break}ce.l=ke,Se[ve]=We}return Se}var c;function d(){return c||(c={})}function f(ce,Se){if(ce[0]==80&&ce[1]==75)return Ee(ce,Se);if((ce[0]|32)==109&&(ce[1]|32)==105)return Yt(ce,Se);if(ce.length<512)throw new Error("CFB file size "+ce.length+" < 512");var pe=3,ve=512,be=0,ke=0,We=0,dt=0,Ve=0,oe=[],he=ce.slice(0,512);ka(he,0);var Te=p(he);switch(pe=Te[0],pe){case 3:ve=512;break;case 4:ve=4096;break;case 0:if(Te[1]==0)return Ee(ce,Se);default:throw new Error("Major Version: Expected 3 or 4 saw "+pe)}ve!==512&&(he=ce.slice(0,ve),ka(he,28));var je=ce.slice(0,ve);g(he,pe);var qe=he.read_shift(4,"i");if(pe===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);he.l+=4,We=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),dt=he.read_shift(4,"i"),be=he.read_shift(4,"i"),Ve=he.read_shift(4,"i"),ke=he.read_shift(4,"i");for(var at=-1,Le=0;Le<109&&(at=he.read_shift(4,"i"),!(at<0));++Le)oe[Le]=at;var Ct=y(ce,ve);b(Ve,ke,Ct,ve,oe);var Mt=k(Ct,We,oe,ve);Mt[We].name="!Directory",be>0&&dt!==ee&&(Mt[dt].name="!MiniFAT"),Mt[oe[0]].name="!FAT",Mt.fat_addrs=oe,Mt.ssz=ve;var Vt={},dr=[],Nn=[],ln=[];w(We,Mt,Ct,dr,be,Vt,Nn,dt),v(Nn,ln,dr),dr.shift();var In={FileIndex:Nn,FullPaths:ln};return Se&&Se.raw&&(In.raw={header:je,sectors:Ct}),In}function p(ce){if(ce[ce.l]==80&&ce[ce.l+1]==75)return[0,0];ce.chk(ie,"Header Signature: "),ce.l+=16;var Se=ce.read_shift(2,"u");return[ce.read_shift(2,"u"),Se]}function g(ce,Se){var pe=9;switch(ce.l+=2,pe=ce.read_shift(2)){case 9:if(Se!=3)throw new Error("Sector Shift: Expected 9 saw "+pe);break;case 12:if(Se!=4)throw new Error("Sector Shift: Expected 12 saw "+pe);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+pe)}ce.chk("0600","Mini Sector Shift: "),ce.chk("000000000000","Reserved: ")}function y(ce,Se){for(var pe=Math.ceil(ce.length/Se)-1,ve=[],be=1;be<pe;++be)ve[be-1]=ce.slice(be*Se,(be+1)*Se);return ve[pe-1]=ce.slice(pe*Se),ve}function v(ce,Se,pe){for(var ve=0,be=0,ke=0,We=0,dt=0,Ve=pe.length,oe=[],he=[];ve<Ve;++ve)oe[ve]=he[ve]=ve,Se[ve]=pe[ve];for(;dt<he.length;++dt)ve=he[dt],be=ce[ve].L,ke=ce[ve].R,We=ce[ve].C,oe[ve]===ve&&(be!==-1&&oe[be]!==be&&(oe[ve]=oe[be]),ke!==-1&&oe[ke]!==ke&&(oe[ve]=oe[ke])),We!==-1&&(oe[We]=ve),be!==-1&&ve!=oe[ve]&&(oe[be]=oe[ve],he.lastIndexOf(be)<dt&&he.push(be)),ke!==-1&&ve!=oe[ve]&&(oe[ke]=oe[ve],he.lastIndexOf(ke)<dt&&he.push(ke));for(ve=1;ve<Ve;++ve)oe[ve]===ve&&(ke!==-1&&oe[ke]!==ke?oe[ve]=oe[ke]:be!==-1&&oe[be]!==be&&(oe[ve]=oe[be]));for(ve=1;ve<Ve;++ve)if(ce[ve].type!==0){if(dt=ve,dt!=oe[dt])do dt=oe[dt],Se[ve]=Se[dt]+"/"+Se[ve];while(dt!==0&&oe[dt]!==-1&&dt!=oe[dt]);oe[ve]=-1}for(Se[0]+="/",ve=1;ve<Ve;++ve)ce[ve].type!==2&&(Se[ve]+="/")}function _(ce,Se,pe){for(var ve=ce.start,be=ce.size,ke=[],We=ve;pe&&be>0&&We>=0;)ke.push(Se.slice(We*Y,We*Y+Y)),be-=Y,We=Od(pe,We*4);return ke.length===0?vt(0):oa(ke).slice(0,ce.size)}function b(ce,Se,pe,ve,be){var ke=ee;if(ce===ee){if(Se!==0)throw new Error("DIFAT chain shorter than expected")}else if(ce!==-1){var We=pe[ce],dt=(ve>>>2)-1;if(!We)return;for(var Ve=0;Ve<dt&&(ke=Od(We,Ve*4))!==ee;++Ve)be.push(ke);b(Od(We,ve-4),Se-1,pe,ve,be)}}function N(ce,Se,pe,ve,be){var ke=[],We=[];be||(be=[]);var dt=ve-1,Ve=0,oe=0;for(Ve=Se;Ve>=0;){be[Ve]=!0,ke[ke.length]=Ve,We.push(ce[Ve]);var he=pe[Math.floor(Ve*4/ve)];if(oe=Ve*4&dt,ve<4+oe)throw new Error("FAT boundary crossed: "+Ve+" 4 "+ve);if(!ce[he])break;Ve=Od(ce[he],oe)}return{nodes:ke,data:IN([We])}}function k(ce,Se,pe,ve){var be=ce.length,ke=[],We=[],dt=[],Ve=[],oe=ve-1,he=0,Te=0,je=0,qe=0;for(he=0;he<be;++he)if(dt=[],je=he+Se,je>=be&&(je-=be),!We[je]){Ve=[];var at=[];for(Te=je;Te>=0;){at[Te]=!0,We[Te]=!0,dt[dt.length]=Te,Ve.push(ce[Te]);var Le=pe[Math.floor(Te*4/ve)];if(qe=Te*4&oe,ve<4+qe)throw new Error("FAT boundary crossed: "+Te+" 4 "+ve);if(!ce[Le]||(Te=Od(ce[Le],qe),at[Te]))break}ke[je]={nodes:dt,data:IN([Ve])}}return ke}function w(ce,Se,pe,ve,be,ke,We,dt){for(var Ve=0,oe=ve.length?2:0,he=Se[ce].data,Te=0,je=0,qe;Te<he.length;Te+=128){var at=he.slice(Te,Te+128);ka(at,64),je=at.read_shift(2),qe=pS(at,0,je-oe),ve.push(qe);var Le={name:qe,type:at.read_shift(1),color:at.read_shift(1),L:at.read_shift(4,"i"),R:at.read_shift(4,"i"),C:at.read_shift(4,"i"),clsid:at.read_shift(16),state:at.read_shift(4,"i"),start:0,size:0},Ct=at.read_shift(2)+at.read_shift(2)+at.read_shift(2)+at.read_shift(2);Ct!==0&&(Le.ct=T(at,at.l-8));var Mt=at.read_shift(2)+at.read_shift(2)+at.read_shift(2)+at.read_shift(2);Mt!==0&&(Le.mt=T(at,at.l-8)),Le.start=at.read_shift(4,"i"),Le.size=at.read_shift(4,"i"),Le.size<0&&Le.start<0&&(Le.size=Le.type=0,Le.start=ee,Le.name=""),Le.type===5?(Ve=Le.start,be>0&&Ve!==ee&&(Se[Ve].name="!StreamData")):Le.size>=4096?(Le.storage="fat",Se[Le.start]===void 0&&(Se[Le.start]=N(pe,Le.start,Se.fat_addrs,Se.ssz)),Se[Le.start].name=Le.name,Le.content=Se[Le.start].data.slice(0,Le.size)):(Le.storage="minifat",Le.size<0?Le.size=0:Ve!==ee&&Le.start!==ee&&Se[Ve]&&(Le.content=_(Le,Se[Ve].data,(Se[dt]||{}).data))),Le.content&&ka(Le.content,0),ke[qe]=Le,We.push(Le)}}function T(ce,Se){return new Date((Hi(ce,Se+4)/1e7*Math.pow(2,32)+Hi(ce,Se)/1e7-11644473600)*1e3)}function A(ce,Se){return d(),f(c.readFileSync(ce),Se)}function F(ce,Se){var pe=Se&&Se.type;switch(pe||Ur&&Buffer.isBuffer(ce)&&(pe="buffer"),pe||"base64"){case"file":return A(ce,Se);case"base64":return f(Gi(qi(ce)),Se);case"binary":return f(Gi(ce),Se)}return f(ce,Se)}function R(ce,Se){var pe=Se||{},ve=pe.root||"Root Entry";if(ce.FullPaths||(ce.FullPaths=[]),ce.FileIndex||(ce.FileIndex=[]),ce.FullPaths.length!==ce.FileIndex.length)throw new Error("inconsistent CFB structure");ce.FullPaths.length===0&&(ce.FullPaths[0]=ve+"/",ce.FileIndex[0]={name:ve,type:5}),pe.CLSID&&(ce.FileIndex[0].clsid=pe.CLSID),E(ce)}function E(ce){var Se="Sh33tJ5";if(!gr.find(ce,"/"+Se)){var pe=vt(4);pe[0]=55,pe[1]=pe[3]=50,pe[2]=54,ce.FileIndex.push({name:Se,type:2,content:pe,size:4,L:69,R:69,C:69}),ce.FullPaths.push(ce.FullPaths[0]+Se),D(ce)}}function D(ce,Se){R(ce);for(var pe=!1,ve=!1,be=ce.FullPaths.length-1;be>=0;--be){var ke=ce.FileIndex[be];switch(ke.type){case 0:ve?pe=!0:(ce.FileIndex.pop(),ce.FullPaths.pop());break;case 1:case 2:case 5:ve=!0,isNaN(ke.R*ke.L*ke.C)&&(pe=!0),ke.R>-1&&ke.L>-1&&ke.R==ke.L&&(pe=!0);break;default:pe=!0;break}}if(!(!pe&&!Se)){var We=new Date(1987,1,19),dt=0,Ve=Object.create?Object.create(null):{},oe=[];for(be=0;be<ce.FullPaths.length;++be)Ve[ce.FullPaths[be]]=!0,ce.FileIndex[be].type!==0&&oe.push([ce.FullPaths[be],ce.FileIndex[be]]);for(be=0;be<oe.length;++be){var he=n(oe[be][0]);ve=Ve[he],ve||(oe.push([he,{name:s(he).replace("/",""),type:1,clsid:se,ct:We,mt:We,content:null}]),Ve[he]=!0)}for(oe.sort(function(qe,at){return r(qe[0],at[0])}),ce.FullPaths=[],ce.FileIndex=[],be=0;be<oe.length;++be)ce.FullPaths[be]=oe[be][0],ce.FileIndex[be]=oe[be][1];for(be=0;be<oe.length;++be){var Te=ce.FileIndex[be],je=ce.FullPaths[be];if(Te.name=s(je).replace("/",""),Te.L=Te.R=Te.C=-(Te.color=1),Te.size=Te.content?Te.content.length:0,Te.start=0,Te.clsid=Te.clsid||se,be===0)Te.C=oe.length>1?1:-1,Te.size=0,Te.type=5;else if(je.slice(-1)=="/"){for(dt=be+1;dt<oe.length&&n(ce.FullPaths[dt])!=je;++dt);for(Te.C=dt>=oe.length?-1:dt,dt=be+1;dt<oe.length&&n(ce.FullPaths[dt])!=n(je);++dt);Te.R=dt>=oe.length?-1:dt,Te.type=1}else n(ce.FullPaths[be+1]||"")==n(je)&&(Te.R=be+1),Te.type=2}}}function I(ce,Se){var pe=Se||{};if(pe.fileType=="mad")return pr(ce,pe);switch(D(ce),pe.fileType){case"zip":return fe(ce,pe)}var ve=(function(qe){for(var at=0,Le=0,Ct=0;Ct<qe.FileIndex.length;++Ct){var Mt=qe.FileIndex[Ct];if(Mt.content){var Vt=Mt.content.length;Vt>0&&(Vt<4096?at+=Vt+63>>6:Le+=Vt+511>>9)}}for(var dr=qe.FullPaths.length+3>>2,Nn=at+7>>3,ln=at+127>>7,In=Nn+Le+dr+ln,Pr=In+127>>7,Or=Pr<=109?0:Math.ceil((Pr-109)/127);In+Pr+Or+127>>7>Pr;)Or=++Pr<=109?0:Math.ceil((Pr-109)/127);var cr=[1,Or,Pr,ln,dr,Le,at,0];return qe.FileIndex[0].size=at<<6,cr[7]=(qe.FileIndex[0].start=cr[0]+cr[1]+cr[2]+cr[3]+cr[4]+cr[5])+(cr[6]+7>>3),cr})(ce),be=vt(ve[7]<<9),ke=0,We=0;{for(ke=0;ke<8;++ke)be.write_shift(1,re[ke]);for(ke=0;ke<8;++ke)be.write_shift(2,0);for(be.write_shift(2,62),be.write_shift(2,3),be.write_shift(2,65534),be.write_shift(2,9),be.write_shift(2,6),ke=0;ke<3;++ke)be.write_shift(2,0);for(be.write_shift(4,0),be.write_shift(4,ve[2]),be.write_shift(4,ve[0]+ve[1]+ve[2]+ve[3]-1),be.write_shift(4,0),be.write_shift(4,4096),be.write_shift(4,ve[3]?ve[0]+ve[1]+ve[2]-1:ee),be.write_shift(4,ve[3]),be.write_shift(-4,ve[1]?ve[0]-1:ee),be.write_shift(4,ve[1]),ke=0;ke<109;++ke)be.write_shift(-4,ke<ve[2]?ve[1]+ke:-1)}if(ve[1])for(We=0;We<ve[1];++We){for(;ke<236+We*127;++ke)be.write_shift(-4,ke<ve[2]?ve[1]+ke:-1);be.write_shift(-4,We===ve[1]-1?ee:We+1)}var dt=function(qe){for(We+=qe;ke<We-1;++ke)be.write_shift(-4,ke+1);qe&&(++ke,be.write_shift(-4,ee))};for(We=ke=0,We+=ve[1];ke<We;++ke)be.write_shift(-4,B.DIFSECT);for(We+=ve[2];ke<We;++ke)be.write_shift(-4,B.FATSECT);dt(ve[3]),dt(ve[4]);for(var Ve=0,oe=0,he=ce.FileIndex[0];Ve<ce.FileIndex.length;++Ve)he=ce.FileIndex[Ve],he.content&&(oe=he.content.length,!(oe<4096)&&(he.start=We,dt(oe+511>>9)));for(dt(ve[6]+7>>3);be.l&511;)be.write_shift(-4,B.ENDOFCHAIN);for(We=ke=0,Ve=0;Ve<ce.FileIndex.length;++Ve)he=ce.FileIndex[Ve],he.content&&(oe=he.content.length,!(!oe||oe>=4096)&&(he.start=We,dt(oe+63>>6)));for(;be.l&511;)be.write_shift(-4,B.ENDOFCHAIN);for(ke=0;ke<ve[4]<<2;++ke){var Te=ce.FullPaths[ke];if(!Te||Te.length===0){for(Ve=0;Ve<17;++Ve)be.write_shift(4,0);for(Ve=0;Ve<3;++Ve)be.write_shift(4,-1);for(Ve=0;Ve<12;++Ve)be.write_shift(4,0);continue}he=ce.FileIndex[ke],ke===0&&(he.start=he.size?he.start-1:ee);var je=ke===0&&pe.root||he.name;if(oe=2*(je.length+1),be.write_shift(64,je,"utf16le"),be.write_shift(2,oe),be.write_shift(1,he.type),be.write_shift(1,he.color),be.write_shift(-4,he.L),be.write_shift(-4,he.R),be.write_shift(-4,he.C),he.clsid)be.write_shift(16,he.clsid,"hex");else for(Ve=0;Ve<4;++Ve)be.write_shift(4,0);be.write_shift(4,he.state||0),be.write_shift(4,0),be.write_shift(4,0),be.write_shift(4,0),be.write_shift(4,0),be.write_shift(4,he.start),be.write_shift(4,he.size),be.write_shift(4,0)}for(ke=1;ke<ce.FileIndex.length;++ke)if(he=ce.FileIndex[ke],he.size>=4096)if(be.l=he.start+1<<9,Ur&&Buffer.isBuffer(he.content))he.content.copy(be,be.l,0,he.size),be.l+=he.size+511&-512;else{for(Ve=0;Ve<he.size;++Ve)be.write_shift(1,he.content[Ve]);for(;Ve&511;++Ve)be.write_shift(1,0)}for(ke=1;ke<ce.FileIndex.length;++ke)if(he=ce.FileIndex[ke],he.size>0&&he.size<4096)if(Ur&&Buffer.isBuffer(he.content))he.content.copy(be,be.l,0,he.size),be.l+=he.size+63&-64;else{for(Ve=0;Ve<he.size;++Ve)be.write_shift(1,he.content[Ve]);for(;Ve&63;++Ve)be.write_shift(1,0)}if(Ur)be.l=be.length;else for(;be.l<be.length;)be.write_shift(1,0);return be}function G(ce,Se){var pe=ce.FullPaths.map(function(Ve){return Ve.toUpperCase()}),ve=pe.map(function(Ve){var oe=Ve.split("/");return oe[oe.length-(Ve.slice(-1)=="/"?2:1)]}),be=!1;Se.charCodeAt(0)===47?(be=!0,Se=pe[0].slice(0,-1)+Se):be=Se.indexOf("/")!==-1;var ke=Se.toUpperCase(),We=be===!0?pe.indexOf(ke):ve.indexOf(ke);if(We!==-1)return ce.FileIndex[We];var dt=!ke.match(Em);for(ke=ke.replace(hi,""),dt&&(ke=ke.replace(Em,"!")),We=0;We<pe.length;++We)if((dt?pe[We].replace(Em,"!"):pe[We]).replace(hi,"")==ke||(dt?ve[We].replace(Em,"!"):ve[We]).replace(hi,"")==ke)return ce.FileIndex[We];return null}var Y=64,ee=-2,ie="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],se="00000000000000000000000000000000",B={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ee,FREESECT:-1,HEADER_SIGNATURE:ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function z(ce,Se,pe){d();var ve=I(ce,pe);c.writeFileSync(Se,ve)}function U(ce){for(var Se=new Array(ce.length),pe=0;pe<ce.length;++pe)Se[pe]=String.fromCharCode(ce[pe]);return Se.join("")}function V(ce,Se){var pe=I(ce,Se);switch(Se&&Se.type||"buffer"){case"file":return d(),c.writeFileSync(Se.filename,pe),pe;case"binary":return typeof pe=="string"?pe:U(pe);case"base64":return fp(typeof pe=="string"?pe:U(pe));case"buffer":if(Ur)return Buffer.isBuffer(pe)?pe:Ic(pe);case"array":return typeof pe=="string"?Gi(pe):pe}return pe}var q;function L(ce){try{var Se=ce.InflateRaw,pe=new Se;if(pe._processChunk(new Uint8Array([3,0]),pe._finishFlushFlag),pe.bytesRead)q=ce;else throw new Error("zlib does not expose bytesRead")}catch(ve){console.error("cannot use native zlib: "+(ve.message||ve))}}function M(ce,Se){if(!q)return Lt(ce,Se);var pe=q.InflateRaw,ve=new pe,be=ve._processChunk(ce.slice(ce.l),ve._finishFlushFlag);return ce.l+=ve.bytesRead,be}function X(ce){return q?q.deflateRawSync(ce):ut(ce)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ne(ce){var Se=(ce<<1|ce<<11)&139536|(ce<<5|ce<<15)&558144;return(Se>>16|Se>>8|Se)&255}for(var me=typeof Uint8Array<"u",xe=me?new Uint8Array(256):[],Ne=0;Ne<256;++Ne)xe[Ne]=ne(Ne);function le(ce,Se){var pe=xe[ce&255];return Se<=8?pe>>>8-Se:(pe=pe<<8|xe[ce>>8&255],Se<=16?pe>>>16-Se:(pe=pe<<8|xe[ce>>16&255],pe>>>24-Se))}function ge(ce,Se){var pe=Se&7,ve=Se>>>3;return(ce[ve]|(pe<=6?0:ce[ve+1]<<8))>>>pe&3}function Ue(ce,Se){var pe=Se&7,ve=Se>>>3;return(ce[ve]|(pe<=5?0:ce[ve+1]<<8))>>>pe&7}function Ge(ce,Se){var pe=Se&7,ve=Se>>>3;return(ce[ve]|(pe<=4?0:ce[ve+1]<<8))>>>pe&15}function Je(ce,Se){var pe=Se&7,ve=Se>>>3;return(ce[ve]|(pe<=3?0:ce[ve+1]<<8))>>>pe&31}function He(ce,Se){var pe=Se&7,ve=Se>>>3;return(ce[ve]|(pe<=1?0:ce[ve+1]<<8))>>>pe&127}function Ft(ce,Se,pe){var ve=Se&7,be=Se>>>3,ke=(1<<pe)-1,We=ce[be]>>>ve;return pe<8-ve||(We|=ce[be+1]<<8-ve,pe<16-ve)||(We|=ce[be+2]<<16-ve,pe<24-ve)||(We|=ce[be+3]<<24-ve),We&ke}function rt(ce,Se,pe){var ve=Se&7,be=Se>>>3;return ve<=5?ce[be]|=(pe&7)<<ve:(ce[be]|=pe<<ve&255,ce[be+1]=(pe&7)>>8-ve),Se+3}function Ie(ce,Se,pe){var ve=Se&7,be=Se>>>3;return pe=(pe&1)<<ve,ce[be]|=pe,Se+1}function Pe(ce,Se,pe){var ve=Se&7,be=Se>>>3;return pe<<=ve,ce[be]|=pe&255,pe>>>=8,ce[be+1]=pe,Se+8}function Qe(ce,Se,pe){var ve=Se&7,be=Se>>>3;return pe<<=ve,ce[be]|=pe&255,pe>>>=8,ce[be+1]=pe&255,ce[be+2]=pe>>>8,Se+16}function _t(ce,Se){var pe=ce.length,ve=2*pe>Se?2*pe:Se+5,be=0;if(pe>=Se)return ce;if(Ur){var ke=pN(ve);if(ce.copy)ce.copy(ke);else for(;be<ce.length;++be)ke[be]=ce[be];return ke}else if(me){var We=new Uint8Array(ve);if(We.set)We.set(ce);else for(;be<pe;++be)We[be]=ce[be];return We}return ce.length=ve,ce}function gt(ce){for(var Se=new Array(ce),pe=0;pe<ce;++pe)Se[pe]=0;return Se}function Bt(ce,Se,pe){var ve=1,be=0,ke=0,We=0,dt=0,Ve=ce.length,oe=me?new Uint16Array(32):gt(32);for(ke=0;ke<32;++ke)oe[ke]=0;for(ke=Ve;ke<pe;++ke)ce[ke]=0;Ve=ce.length;var he=me?new Uint16Array(Ve):gt(Ve);for(ke=0;ke<Ve;++ke)oe[be=ce[ke]]++,ve<be&&(ve=be),he[ke]=0;for(oe[0]=0,ke=1;ke<=ve;++ke)oe[ke+16]=dt=dt+oe[ke-1]<<1;for(ke=0;ke<Ve;++ke)dt=ce[ke],dt!=0&&(he[ke]=oe[dt+16]++);var Te=0;for(ke=0;ke<Ve;++ke)if(Te=ce[ke],Te!=0)for(dt=le(he[ke],ve)>>ve-Te,We=(1<<ve+4-Te)-1;We>=0;--We)Se[dt|We<<Te]=Te&15|ke<<4;return ve}var Ut=me?new Uint16Array(512):gt(512),it=me?new Uint16Array(32):gt(32);if(!me){for(var Ye=0;Ye<512;++Ye)Ut[Ye]=0;for(Ye=0;Ye<32;++Ye)it[Ye]=0}(function(){for(var ce=[],Se=0;Se<32;Se++)ce.push(5);Bt(ce,it,32);var pe=[];for(Se=0;Se<=143;Se++)pe.push(8);for(;Se<=255;Se++)pe.push(9);for(;Se<=279;Se++)pe.push(7);for(;Se<=287;Se++)pe.push(8);Bt(pe,Ut,288)})();var xt=(function(){for(var Se=me?new Uint8Array(32768):[],pe=0,ve=0;pe<J.length-1;++pe)for(;ve<J[pe+1];++ve)Se[ve]=pe;for(;ve<32768;++ve)Se[ve]=29;var be=me?new Uint8Array(259):[];for(pe=0,ve=0;pe<Z.length-1;++pe)for(;ve<Z[pe+1];++ve)be[ve]=pe;function ke(dt,Ve){for(var oe=0;oe<dt.length;){var he=Math.min(65535,dt.length-oe),Te=oe+he==dt.length;for(Ve.write_shift(1,+Te),Ve.write_shift(2,he),Ve.write_shift(2,~he&65535);he-- >0;)Ve[Ve.l++]=dt[oe++]}return Ve.l}function We(dt,Ve){for(var oe=0,he=0,Te=me?new Uint16Array(32768):[];he<dt.length;){var je=Math.min(65535,dt.length-he);if(je<10){for(oe=rt(Ve,oe,+(he+je==dt.length)),oe&7&&(oe+=8-(oe&7)),Ve.l=oe/8|0,Ve.write_shift(2,je),Ve.write_shift(2,~je&65535);je-- >0;)Ve[Ve.l++]=dt[he++];oe=Ve.l*8;continue}oe=rt(Ve,oe,+(he+je==dt.length)+2);for(var qe=0;je-- >0;){var at=dt[he];qe=(qe<<5^at)&32767;var Le=-1,Ct=0;if((Le=Te[qe])&&(Le|=he&-32768,Le>he&&(Le-=32768),Le<he))for(;dt[Le+Ct]==dt[he+Ct]&&Ct<250;)++Ct;if(Ct>2){at=be[Ct],at<=22?oe=Pe(Ve,oe,xe[at+1]>>1)-1:(Pe(Ve,oe,3),oe+=5,Pe(Ve,oe,xe[at-23]>>5),oe+=3);var Mt=at<8?0:at-4>>2;Mt>0&&(Qe(Ve,oe,Ct-Z[at]),oe+=Mt),at=Se[he-Le],oe=Pe(Ve,oe,xe[at]>>3),oe-=3;var Vt=at<4?0:at-2>>1;Vt>0&&(Qe(Ve,oe,he-Le-J[at]),oe+=Vt);for(var dr=0;dr<Ct;++dr)Te[qe]=he&32767,qe=(qe<<5^dt[he])&32767,++he;je-=Ct-1}else at<=143?at=at+48:oe=Ie(Ve,oe,1),oe=Pe(Ve,oe,xe[at]),Te[qe]=he&32767,++he}oe=Pe(Ve,oe,0)-1}return Ve.l=(oe+7)/8|0,Ve.l}return function(Ve,oe){return Ve.length<8?ke(Ve,oe):We(Ve,oe)}})();function ut(ce){var Se=vt(50+Math.floor(ce.length*1.1)),pe=xt(ce,Se);return Se.slice(0,pe)}var wt=me?new Uint16Array(32768):gt(32768),$t=me?new Uint16Array(32768):gt(32768),Kt=me?new Uint16Array(128):gt(128),De=1,ct=1;function mt(ce,Se){var pe=Je(ce,Se)+257;Se+=5;var ve=Je(ce,Se)+1;Se+=5;var be=Ge(ce,Se)+4;Se+=4;for(var ke=0,We=me?new Uint8Array(19):gt(19),dt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ve=1,oe=me?new Uint8Array(8):gt(8),he=me?new Uint8Array(8):gt(8),Te=We.length,je=0;je<be;++je)We[K[je]]=ke=Ue(ce,Se),Ve<ke&&(Ve=ke),oe[ke]++,Se+=3;var qe=0;for(oe[0]=0,je=1;je<=Ve;++je)he[je]=qe=qe+oe[je-1]<<1;for(je=0;je<Te;++je)(qe=We[je])!=0&&(dt[je]=he[qe]++);var at=0;for(je=0;je<Te;++je)if(at=We[je],at!=0){qe=xe[dt[je]]>>8-at;for(var Le=(1<<7-at)-1;Le>=0;--Le)Kt[qe|Le<<at]=at&7|je<<3}var Ct=[];for(Ve=1;Ct.length<pe+ve;)switch(qe=Kt[He(ce,Se)],Se+=qe&7,qe>>>=3){case 16:for(ke=3+ge(ce,Se),Se+=2,qe=Ct[Ct.length-1];ke-- >0;)Ct.push(qe);break;case 17:for(ke=3+Ue(ce,Se),Se+=3;ke-- >0;)Ct.push(0);break;case 18:for(ke=11+He(ce,Se),Se+=7;ke-- >0;)Ct.push(0);break;default:Ct.push(qe),Ve<qe&&(Ve=qe);break}var Mt=Ct.slice(0,pe),Vt=Ct.slice(pe);for(je=pe;je<286;++je)Mt[je]=0;for(je=ve;je<30;++je)Vt[je]=0;return De=Bt(Mt,wt,286),ct=Bt(Vt,$t,30),Se}function At(ce,Se){if(ce[0]==3&&!(ce[1]&3))return[Wu(Se),2];for(var pe=0,ve=0,be=pN(Se||1<<18),ke=0,We=be.length>>>0,dt=0,Ve=0;(ve&1)==0;){if(ve=Ue(ce,pe),pe+=3,ve>>>1)ve>>1==1?(dt=9,Ve=5):(pe=mt(ce,pe),dt=De,Ve=ct);else{pe&7&&(pe+=8-(pe&7));var oe=ce[pe>>>3]|ce[(pe>>>3)+1]<<8;if(pe+=32,oe>0)for(!Se&&We<ke+oe&&(be=_t(be,ke+oe),We=be.length);oe-- >0;)be[ke++]=ce[pe>>>3],pe+=8;continue}for(;;){!Se&&We<ke+32767&&(be=_t(be,ke+32767),We=be.length);var he=Ft(ce,pe,dt),Te=ve>>>1==1?Ut[he]:wt[he];if(pe+=Te&15,Te>>>=4,(Te>>>8&255)===0)be[ke++]=Te;else{if(Te==256)break;Te-=257;var je=Te<8?0:Te-4>>2;je>5&&(je=0);var qe=ke+Z[Te];je>0&&(qe+=Ft(ce,pe,je),pe+=je),he=Ft(ce,pe,Ve),Te=ve>>>1==1?it[he]:$t[he],pe+=Te&15,Te>>>=4;var at=Te<4?0:Te-2>>1,Le=J[Te];for(at>0&&(Le+=Ft(ce,pe,at),pe+=at),!Se&&We<qe&&(be=_t(be,qe+100),We=be.length);ke<qe;)be[ke]=be[ke-Le],++ke}}}return Se?[be,pe+7>>>3]:[be.slice(0,ke),pe+7>>>3]}function Lt(ce,Se){var pe=ce.slice(ce.l||0),ve=At(pe,Se);return ce.l+=ve[1],ve[0]}function rr(ce,Se){if(ce)typeof console<"u"&&console.error(Se);else throw new Error(Se)}function Ee(ce,Se){var pe=ce;ka(pe,0);var ve=[],be=[],ke={FileIndex:ve,FullPaths:be};R(ke,{root:Se.root});for(var We=pe.length-4;(pe[We]!=80||pe[We+1]!=75||pe[We+2]!=5||pe[We+3]!=6)&&We>=0;)--We;pe.l=We+4,pe.l+=4;var dt=pe.read_shift(2);pe.l+=6;var Ve=pe.read_shift(4);for(pe.l=Ve,We=0;We<dt;++We){pe.l+=20;var oe=pe.read_shift(4),he=pe.read_shift(4),Te=pe.read_shift(2),je=pe.read_shift(2),qe=pe.read_shift(2);pe.l+=8;var at=pe.read_shift(4),Le=l(pe.slice(pe.l+Te,pe.l+Te+je));pe.l+=Te+je+qe;var Ct=pe.l;pe.l=at+4,we(pe,oe,he,ke,Le),pe.l=Ct}return ke}function we(ce,Se,pe,ve,be){ce.l+=2;var ke=ce.read_shift(2),We=ce.read_shift(2),dt=i(ce);if(ke&8257)throw new Error("Unsupported ZIP encryption");for(var Ve=ce.read_shift(4),oe=ce.read_shift(4),he=ce.read_shift(4),Te=ce.read_shift(2),je=ce.read_shift(2),qe="",at=0;at<Te;++at)qe+=String.fromCharCode(ce[ce.l++]);if(je){var Le=l(ce.slice(ce.l,ce.l+je));(Le[21589]||{}).mt&&(dt=Le[21589].mt),((be||{})[21589]||{}).mt&&(dt=be[21589].mt)}ce.l+=je;var Ct=ce.slice(ce.l,ce.l+oe);switch(We){case 8:Ct=M(ce,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+We)}var Mt=!1;ke&8&&(Ve=ce.read_shift(4),Ve==134695760&&(Ve=ce.read_shift(4),Mt=!0),oe=ce.read_shift(4),he=ce.read_shift(4)),oe!=Se&&rr(Mt,"Bad compressed size: "+Se+" != "+oe),he!=pe&&rr(Mt,"Bad uncompressed size: "+pe+" != "+he),xr(ve,qe,Ct,{unsafe:!0,mt:dt})}function fe(ce,Se){var pe=Se||{},ve=[],be=[],ke=vt(1),We=pe.compression?8:0,dt=0,Ve=0,oe=0,he=0,Te=0,je=ce.FullPaths[0],qe=je,at=ce.FileIndex[0],Le=[],Ct=0;for(Ve=1;Ve<ce.FullPaths.length;++Ve)if(qe=ce.FullPaths[Ve].slice(je.length),at=ce.FileIndex[Ve],!(!at.size||!at.content||qe=="Sh33tJ5")){var Mt=he,Vt=vt(qe.length);for(oe=0;oe<qe.length;++oe)Vt.write_shift(1,qe.charCodeAt(oe)&127);Vt=Vt.slice(0,Vt.l),Le[Te]=kH.buf(at.content,0);var dr=at.content;We==8&&(dr=X(dr)),ke=vt(30),ke.write_shift(4,67324752),ke.write_shift(2,20),ke.write_shift(2,dt),ke.write_shift(2,We),at.mt?a(ke,at.mt):ke.write_shift(4,0),ke.write_shift(-4,Le[Te]),ke.write_shift(4,dr.length),ke.write_shift(4,at.content.length),ke.write_shift(2,Vt.length),ke.write_shift(2,0),he+=ke.length,ve.push(ke),he+=Vt.length,ve.push(Vt),he+=dr.length,ve.push(dr),ke=vt(46),ke.write_shift(4,33639248),ke.write_shift(2,0),ke.write_shift(2,20),ke.write_shift(2,dt),ke.write_shift(2,We),ke.write_shift(4,0),ke.write_shift(-4,Le[Te]),ke.write_shift(4,dr.length),ke.write_shift(4,at.content.length),ke.write_shift(2,Vt.length),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(4,0),ke.write_shift(4,Mt),Ct+=ke.l,be.push(ke),Ct+=Vt.length,be.push(Vt),++Te}return ke=vt(22),ke.write_shift(4,101010256),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,Te),ke.write_shift(2,Te),ke.write_shift(4,Ct),ke.write_shift(4,he),ke.write_shift(2,0),oa([oa(ve),oa(be),ke])}var _e={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function $e(ce,Se){if(ce.ctype)return ce.ctype;var pe=ce.name||"",ve=pe.match(/\.([^\.]+)$/);return ve&&_e[ve[1]]||Se&&(ve=(pe=Se).match(/[\.\\]([^\.\\])+$/),ve&&_e[ve[1]])?_e[ve[1]]:"application/octet-stream"}function St(ce){for(var Se=fp(ce),pe=[],ve=0;ve<Se.length;ve+=76)pe.push(Se.slice(ve,ve+76));return pe.join(`\r
`)+`\r
`}function pt(ce){var Se=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var he=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});Se=Se.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Se.charAt(0)==`
`&&(Se="=0D"+Se.slice(1)),Se=Se.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var pe=[],ve=Se.split(`\r
`),be=0;be<ve.length;++be){var ke=ve[be];if(ke.length==0){pe.push("");continue}for(var We=0;We<ke.length;){var dt=76,Ve=ke.slice(We,We+dt);Ve.charAt(dt-1)=="="?dt--:Ve.charAt(dt-2)=="="?dt-=2:Ve.charAt(dt-3)=="="&&(dt-=3),Ve=ke.slice(We,We+dt),We+=dt,We<ke.length&&(Ve+="="),pe.push(Ve)}}return pe.join(`\r
`)}function Xt(ce){for(var Se=[],pe=0;pe<ce.length;++pe){for(var ve=ce[pe];pe<=ce.length&&ve.charAt(ve.length-1)=="=";)ve=ve.slice(0,ve.length-1)+ce[++pe];Se.push(ve)}for(var be=0;be<Se.length;++be)Se[be]=Se[be].replace(/[=][0-9A-Fa-f]{2}/g,function(ke){return String.fromCharCode(parseInt(ke.slice(1),16))});return Gi(Se.join(`\r
`))}function Jt(ce,Se,pe){for(var ve="",be="",ke="",We,dt=0;dt<10;++dt){var Ve=Se[dt];if(!Ve||Ve.match(/^\s*$/))break;var oe=Ve.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":ve=oe[2].trim();break;case"content-type":ke=oe[2].trim();break;case"content-transfer-encoding":be=oe[2].trim();break}}switch(++dt,be.toLowerCase()){case"base64":We=Gi(qi(Se.slice(dt).join("")));break;case"quoted-printable":We=Xt(Se.slice(dt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+be)}var he=xr(ce,ve.slice(pe.length),We,{unsafe:!0});ke&&(he.ctype=ke)}function Yt(ce,Se){if(U(ce.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var pe=Se&&Se.root||"",ve=(Ur&&Buffer.isBuffer(ce)?ce.toString("binary"):U(ce)).split(`\r
`),be=0,ke="";for(be=0;be<ve.length;++be)if(ke=ve[be],!!/^Content-Location:/i.test(ke)&&(ke=ke.slice(ke.indexOf("file")),pe||(pe=ke.slice(0,ke.lastIndexOf("/")+1)),ke.slice(0,pe.length)!=pe))for(;pe.length>0&&(pe=pe.slice(0,pe.length-1),pe=pe.slice(0,pe.lastIndexOf("/")+1),ke.slice(0,pe.length)!=pe););var We=(ve[1]||"").match(/boundary="(.*?)"/);if(!We)throw new Error("MAD cannot find boundary");var dt="--"+(We[1]||""),Ve=[],oe=[],he={FileIndex:Ve,FullPaths:oe};R(he);var Te,je=0;for(be=0;be<ve.length;++be){var qe=ve[be];qe!==dt&&qe!==dt+"--"||(je++&&Jt(he,ve.slice(Te,be),pe),Te=be)}return he}function pr(ce,Se){var pe=Se||{},ve=pe.boundary||"SheetJS";ve="------="+ve;for(var be=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ve.slice(2)+'"',"","",""],ke=ce.FullPaths[0],We=ke,dt=ce.FileIndex[0],Ve=1;Ve<ce.FullPaths.length;++Ve)if(We=ce.FullPaths[Ve].slice(ke.length),dt=ce.FileIndex[Ve],!(!dt.size||!dt.content||We=="Sh33tJ5")){We=We.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ct){return"_x"+Ct.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ct){return"_u"+Ct.charCodeAt(0).toString(16)+"_"});for(var oe=dt.content,he=Ur&&Buffer.isBuffer(oe)?oe.toString("binary"):U(oe),Te=0,je=Math.min(1024,he.length),qe=0,at=0;at<=je;++at)(qe=he.charCodeAt(at))>=32&&qe<128&&++Te;var Le=Te>=je*4/5;be.push(ve),be.push("Content-Location: "+(pe.root||"file:///C:/SheetJS/")+We),be.push("Content-Transfer-Encoding: "+(Le?"quoted-printable":"base64")),be.push("Content-Type: "+$e(dt,We)),be.push(""),be.push(Le?pt(he):St(he))}return be.push(ve+`--\r
`),be.join(`\r
`)}function Ir(ce){var Se={};return R(Se,ce),Se}function xr(ce,Se,pe,ve){var be=ve&&ve.unsafe;be||R(ce);var ke=!be&&gr.find(ce,Se);if(!ke){var We=ce.FullPaths[0];Se.slice(0,We.length)==We?We=Se:(We.slice(-1)!="/"&&(We+="/"),We=(We+Se).replace("//","/")),ke={name:s(Se),type:2},ce.FileIndex.push(ke),ce.FullPaths.push(We),be||gr.utils.cfb_gc(ce)}return ke.content=pe,ke.size=pe?pe.length:0,ve&&(ve.CLSID&&(ke.clsid=ve.CLSID),ve.mt&&(ke.mt=ve.mt),ve.ct&&(ke.ct=ve.ct)),ke}function Tr(ce,Se){R(ce);var pe=gr.find(ce,Se);if(pe){for(var ve=0;ve<ce.FileIndex.length;++ve)if(ce.FileIndex[ve]==pe)return ce.FileIndex.splice(ve,1),ce.FullPaths.splice(ve,1),!0}return!1}function Mr(ce,Se,pe){R(ce);var ve=gr.find(ce,Se);if(ve){for(var be=0;be<ce.FileIndex.length;++be)if(ce.FileIndex[be]==ve)return ce.FileIndex[be].name=s(pe),ce.FullPaths[be]=pe,!0}return!1}function Wr(ce){D(ce,!0)}return t.find=G,t.read=F,t.parse=f,t.write=V,t.writeFile=z,t.utils={cfb_new:Ir,cfb_add:xr,cfb_del:Tr,cfb_mov:Mr,cfb_gc:Wr,ReadShift:Bm,CheckField:D8,prep_blob:ka,bconcat:oa,use_zlib:L,_deflateRaw:ut,_inflateRaw:Lt,consts:B},t})();function CH(e){return typeof e=="string"?tv(e):Array.isArray(e)?Jz(e):e}function qp(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=tv(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Pl(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([CH(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Zu(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function TH(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function gs(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function kN(e,t){for(var r=[],n=gs(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function nv(e){for(var t=[],r=gs(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function sv(e){for(var t=[],r=gs(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function EH(e){for(var t=[],r=gs(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var y1=new Date(1899,11,30,0,0,0);function Xs(e,t){var r=e.getTime(),n=y1.getTime()+(e.getTimezoneOffset()-y1.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var h8=new Date,NH=y1.getTime()+(h8.getTimezoneOffset()-y1.getTimezoneOffset())*6e4,CN=h8.getTimezoneOffset();function av(e){var t=new Date;return t.setTime(e*24*60*60*1e3+NH),t.getTimezoneOffset()!==CN&&t.setTime(t.getTime()+(t.getTimezoneOffset()-CN)*6e4),t}function AH(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var TN=new Date("2017-02-19T19:06:09.000Z"),g8=isNaN(TN.getFullYear())?new Date("2/19/17"):TN,jH=g8.getFullYear()==2017;function Wn(e,t){var r=new Date(e);if(jH)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(g8.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function gf(e,t){if(Ur&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Pl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Pl(t8(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Pl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Pl(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function zn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=zn(e[r]));return t}function fs(e,t){for(var r="";r.length<t;)r+=e;return r}function Jo(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var FH=["january","february","march","april","may","june","july","august","september","october","november","december"];function g0(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&FH.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var PH=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],l=1;l<a.length;++l)i.push(s),i.push(a[l]);return i}})();function m8(e){return e?e.content&&e.type?gf(e.content,!0):e.data?Tm(e.data):e.asNodeBuffer&&Ur?Tm(e.asNodeBuffer().toString("binary")):e.asBinary?Tm(e.asBinary()):e._data&&e._data.getContent?Tm(gf(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function p8(e){if(!e)return null;if(e.data)return gN(e.data);if(e.asNodeBuffer&&Ur)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?gN(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function RH(e){return e&&e.name.slice(-4)===".bin"?p8(e):m8(e)}function xo(e,t){for(var r=e.FullPaths||gs(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function uS(e,t){var r=xo(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Ds(e,t,r){if(!r)return RH(uS(e,t));if(!t)return null;try{return Ds(e,t)}catch{return null}}function Vi(e,t,r){if(!r)return m8(uS(e,t));if(!t)return null;try{return Vi(e,t)}catch{return null}}function DH(e,t,r){return p8(uS(e,t))}function EN(e){for(var t=e.FullPaths||gs(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Br(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ur?n=Ic(r):n=Qz(r),gr.utils.cfb_add(e,t,n)}gr.utils.cfb_add(e,t,r)}else e.file(t,r)}function dS(){return gr.utils.cfb_new()}function x8(e,t){switch(t.type){case"base64":return gr.read(e,{type:"base64"});case"binary":return gr.read(e,{type:"binary"});case"buffer":case"array":return gr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Nm(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Es=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,IH=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,NN=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,MH=/<[^>]*>/g,Xa=Es.match(NN)?NN:MH,OH=/<\w*:/,LH=/<(\/?)\w+:/;function kr(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(IH),l=0,c="",d=0,f="",p="",g=1;if(i)for(d=0;d!=i.length;++d){for(p=i[d],a=0;a!=p.length&&p.charCodeAt(a)!==61;++a);for(f=p.slice(0,a).trim();p.charCodeAt(a+1)==32;)++a;for(g=(s=p.charCodeAt(a+1))==34||s==39?1:0,c=p.slice(a+1+g,p.length-g),l=0;l!=f.length&&f.charCodeAt(l)!==58;++l);if(l===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,n[f.toLowerCase()]=c;else{var y=(l===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(l+1);if(n[y]&&f.slice(l-3,l)=="ext")continue;n[y]=c,n[y.toLowerCase()]=c}}return n}function Ul(e){return e.replace(LH,"<$1")}var y8={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},fS=nv(y8),Qr=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(l,c){return y8[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}})(),hS=/[&<>'"]/g,BH=/[\u0000-\u0008\u000b-\u001f]/g;function yn(e){var t=e+"";return t.replace(hS,function(r){return fS[r]}).replace(BH,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function AN(e){return yn(e).replace(/ /g,"_x0020_")}var v8=/[\u0000-\u001f]/g;function gS(e){var t=e+"";return t.replace(hS,function(r){return fS[r]}).replace(/\n/g,"<br/>").replace(v8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function UH(e){var t=e+"";return t.replace(hS,function(r){return fS[r]}).replace(v8,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var jN=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function $H(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ln(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function $w(e){for(var t="",r=0,n=0,s=0,a=0,i=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function FN(e){var t=Wu(2*e.length),r,n,s=1,a=0,i=0,l;for(n=0;n<e.length;n+=s)s=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function PN(e){return Ic(e,"binary").toString("utf8")}var vy="foo bar baz",kn=Ur&&(PN(vy)==$w(vy)&&PN||FN(vy)==$w(vy)&&FN)||$w,Pl=Ur?function(e){return Ic(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},gp=(function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),w8=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}})(),WH=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),zH=/<\/?(?:vt:)?variant>/g,HH=/<(?:vt:)([^>]*)>([\s\S]*)</;function RN(e,t){var r=kr(e),n=e.match(WH(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(zH,"").match(HH);i&&s.push({v:kn(i[2]),t:i[1]})}),s}var _8=/(^\s|\s$|\n)/;function Ea(e,t){return"<"+e+(t.match(_8)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function mp(e){return gs(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Wt(e,t,r){return"<"+e+(r!=null?mp(r):"")+(t!=null?(t.match(_8)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function o2(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function GH(e,t){switch(typeof e){case"string":var r=Wt("vt:lpwstr",yn(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Wt((e|0)==e?"vt:i4":"vt:r8",yn(String(e)));case"boolean":return Wt("vt:bool",e?"true":"false")}if(e instanceof Date)return Wt("vt:filetime",o2(e));throw new Error("Unable to serialize "+e)}function mS(e){if(Ur&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return kn(Zu(oS(e)));throw new Error("Bad input format: expected Buffer or string")}var pp=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ks={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},bf=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],zi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function VH(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function KH(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var l=0;l<=5;++l,a/=256)e[r+l]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var DN=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},IN=Ur?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ic(t)})):DN(e)}:DN,MN=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Sc(e,s)));return n.join("").replace(hi,"")},pS=Ur?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(hi,""):MN(e,t,r)}:MN,ON=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},b8=Ur?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ON(e,t,r)}:ON,LN=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Oh(e,s)));return n.join("")},Xp=Ur?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):LN(t,r,n)}:LN,S8=function(e,t){var r=Hi(e,t);return r>0?Xp(e,t+4,t+4+r-1):""},k8=S8,C8=function(e,t){var r=Hi(e,t);return r>0?Xp(e,t+4,t+4+r-1):""},T8=C8,E8=function(e,t){var r=2*Hi(e,t);return r>0?Xp(e,t+4,t+4+r-1):""},N8=E8,A8=function(t,r){var n=Hi(t,r);return n>0?pS(t,r+4,r+4+n):""},j8=A8,F8=function(e,t){var r=Hi(e,t);return r>0?Xp(e,t+4,t+4+r):""},P8=F8,R8=function(e,t){return VH(e,t)},v1=R8,xS=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ur&&(k8=function(t,r){if(!Buffer.isBuffer(t))return S8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},T8=function(t,r){if(!Buffer.isBuffer(t))return C8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},N8=function(t,r){if(!Buffer.isBuffer(t))return E8(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},j8=function(t,r){if(!Buffer.isBuffer(t))return A8(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},P8=function(t,r){if(!Buffer.isBuffer(t))return F8(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},v1=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):R8(t,r)},xS=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Oh=function(e,t){return e[t]},Sc=function(e,t){return e[t+1]*256+e[t]},qH=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Hi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Od=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},XH=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Bm(e,t){var r="",n,s,a=[],i,l,c,d;switch(t){case"dbcs":if(d=this.l,Ur&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Sc(this,d)),d+=2;e*=2;break;case"utf8":r=Xp(this,this.l,this.l+e);break;case"utf16le":e*=2,r=pS(this,this.l,this.l+e);break;case"wstr":return Bm.call(this,e,"dbcs");case"lpstr-ansi":r=k8(this,this.l),e=4+Hi(this,this.l);break;case"lpstr-cp":r=T8(this,this.l),e=4+Hi(this,this.l);break;case"lpwstr":r=N8(this,this.l),e=4+2*Hi(this,this.l);break;case"lpp4":e=4+Hi(this,this.l),r=j8(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Hi(this,this.l),r=P8(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Oh(this,this.l+e++))!==0;)a.push(yy(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=Sc(this,this.l+e))!==0;)a.push(yy(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return i=Oh(this,d),this.l=d+1,l=Bm.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(yy(Sc(this,d))),d+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return i=Oh(this,d),this.l=d+1,l=Bm.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(yy(Oh(this,d))),d+=1}r=a.join("");break;default:switch(e){case 1:return n=Oh(this,this.l),this.l++,n;case 2:return n=(t==="i"?qH:Sc)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Od:XH)(this,this.l),this.l+=4,n):(s=Hi(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=v1(this,this.l):s=v1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=b8(this,this.l,e);break}}return this.l+=e,r}var YH=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},JH=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},QH=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function ZH(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)QH(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,YH(this,t,this.l);break;case 8:if(n=8,r==="f"){KH(this,t,this.l);break}case 16:break;case-4:n=4,JH(this,t,this.l);break}return this.l+=n,this}function D8(e,t){var r=b8(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ka(e,t){e.l=t,e.read_shift=Bm,e.chk=D8,e.write_shift=ZH}function qa(e,t){e.l+=t}function vt(e){var t=Wu(e);return ka(t,0),t}function Mc(e,t,r){if(e){var n,s,a;ka(e,e.l||0);for(var i=e.length,l=0,c=0;e.l<i;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var d=bp[l]||bp[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var f=d.f&&d.f(e,a,r);if(e.l=c,t(f,d,l))return}}}function Fi(){var e=[],t=Ur?256:2048,r=function(d){var f=vt(d);return ka(f,0),f},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(d){return n&&d<n.length-n.l?n:(s(),n=r(Math.max(d+1,t)))},i=function(){return s(),oa(e)},l=function(d){s(),n=d,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:l,end:i,_bufs:e}}function kt(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=bp[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&xS(r)&&e.push(r)}}function Um(e,t,r){var n=zn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function BN(e,t,r){var n=zn(e);return n.s=Um(n.s,t.s,r),n.e=Um(n.e,t.s,r),n}function $m(e,t){if(e.cRel&&e.c<0)for(e=zn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=zn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=br(e);return!e.cRel&&e.cRel!=null&&(r=rG(r)),!e.rRel&&e.rRel!=null&&(r=eG(r)),r}function Ww(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+es(e.s.c)+":"+(e.e.cRel?"":"$")+es(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Cs(e.s.r)+":"+(e.e.rRel?"":"$")+Cs(e.e.r):$m(e.s,t.biff)+":"+$m(e.e,t.biff)}function yS(e){return parseInt(tG(e),10)-1}function Cs(e){return""+(e+1)}function eG(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function tG(e){return e.replace(/\$(\d+)$/,"$1")}function vS(e){for(var t=nG(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function es(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function rG(e){return e.replace(/^([A-Z])/,"$$$1")}function nG(e){return e.replace(/^\$([A-Z])/,"$1")}function sG(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ts(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function br(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Pi(e){var t=e.indexOf(":");return t==-1?{s:ts(e),e:ts(e)}:{s:ts(e.slice(0,t)),e:ts(e.slice(t+1))}}function Dr(e,t){return typeof t>"u"||typeof t=="number"?Dr(e.s,e.e):(typeof e!="string"&&(e=br(e)),typeof t!="string"&&(t=br(t)),e==t?e:e+":"+t)}function Zr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function UN(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Co(e.z,r?Xs(t):t)}catch{}try{return e.w=Co((e.XF||{}).numFmtId||(r?14:0),r?Xs(t):t)}catch{return""+t}}function Pc(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Oc[e.v]||e.v:t==null?UN(e,e.v):UN(e,t))}function ed(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function I8(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,l=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?ts(n.origin):n.origin;i=c.r,l=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=Zr(a["!ref"]);d.s.c=f.s.c,d.s.r=f.s.r,d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(d.e.r=i=f.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[p].length;++g)if(!(typeof t[p][g]>"u")){var y={v:t[p][g]},v=i+p,_=l+g;if(d.s.r>v&&(d.s.r=v),d.s.c>_&&(d.s.c=_),d.e.r<v&&(d.e.r=v),d.e.c<_&&(d.e.c=_),t[p][g]&&typeof t[p][g]=="object"&&!Array.isArray(t[p][g])&&!(t[p][g]instanceof Date))y=t[p][g];else if(Array.isArray(y.v)&&(y.f=t[p][g][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||wr[14],n.cellDates?(y.t="d",y.w=Co(y.z,Xs(y.v))):(y.t="n",y.v=Xs(y.v),y.w=Co(y.z,y.v))):y.t="s";if(s)a[v]||(a[v]=[]),a[v][_]&&a[v][_].z&&(y.z=a[v][_].z),a[v][_]=y;else{var b=br({c:_,r:v});a[b]&&a[b].z&&(y.z=a[b].z),a[b]=y}}}return d.s.c<1e7&&(a["!ref"]=Dr(d)),a}function I0(e,t){return I8(null,e,t)}function aG(e){return e.read_shift(4,"i")}function Qo(e,t){return t||(t=vt(4)),t.write_shift(4,e),t}function Va(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ca(e,t){var r=!1;return t==null&&(r=!0,t=vt(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function iG(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function oG(e,t){return t||(t=vt(4)),t.write_shift(2,0),t.write_shift(2,0),t}function wS(e,t){var r=e.l,n=e.read_shift(1),s=Va(e),a=[],i={t:s,h:s};if((n&1)!==0){for(var l=e.read_shift(4),c=0;c!=l;++c)a.push(iG(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function lG(e,t){var r=!1;return t==null&&(r=!0,t=vt(15+4*e.t.length)),t.write_shift(1,0),ca(e.t,t),r?t.slice(0,t.l):t}var cG=wS;function uG(e,t){var r=!1;return t==null&&(r=!0,t=vt(23+4*e.t.length)),t.write_shift(1,1),ca(e.t,t),t.write_shift(4,1),oG({},t),r?t.slice(0,t.l):t}function To(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Sf(e,t){return t==null&&(t=vt(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function kf(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Cf(e,t){return t==null&&(t=vt(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var dG=Va,M8=ca;function _S(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function w1(e,t){var r=!1;return t==null&&(r=!0,t=vt(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var fG=Va,l2=_S,bS=w1;function SS(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?v1([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Od(t,0)>>2;return r?s/100:s}function O8(e,t){t==null&&(t=vt(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function L8(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function hG(e,t){return t||(t=vt(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Tf=L8,M0=hG;function Wa(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function mf(e,t){return(t||vt(8)).write_shift(8,e,"f")}function gG(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var d=qd[s];d&&(t.rgb=yp(d));break;case 2:t.rgb=yp([i,l,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function _1(e,t){if(t||(t=vt(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function mG(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function pG(e,t){t||(t=vt(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function B8(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function xG(e){return B8(e,1)}function yG(e){return B8(e,2)}var kS=2,Ci=3,wy=11,$N=12,b1=19,_y=64,vG=65,wG=71,_G=4108,bG=4126,sa=80,U8=81,SG=[sa,U8],c2={1:{n:"CodePage",t:kS},2:{n:"Category",t:sa},3:{n:"PresentationFormat",t:sa},4:{n:"ByteCount",t:Ci},5:{n:"LineCount",t:Ci},6:{n:"ParagraphCount",t:Ci},7:{n:"SlideCount",t:Ci},8:{n:"NoteCount",t:Ci},9:{n:"HiddenCount",t:Ci},10:{n:"MultimediaClipCount",t:Ci},11:{n:"ScaleCrop",t:wy},12:{n:"HeadingPairs",t:_G},13:{n:"TitlesOfParts",t:bG},14:{n:"Manager",t:sa},15:{n:"Company",t:sa},16:{n:"LinksUpToDate",t:wy},17:{n:"CharacterCount",t:Ci},19:{n:"SharedDoc",t:wy},22:{n:"HyperlinksChanged",t:wy},23:{n:"AppVersion",t:Ci,p:"version"},24:{n:"DigSig",t:vG},26:{n:"ContentType",t:sa},27:{n:"ContentStatus",t:sa},28:{n:"Language",t:sa},29:{n:"Version",t:sa},255:{},2147483648:{n:"Locale",t:b1},2147483651:{n:"Behavior",t:b1},1919054434:{}},u2={1:{n:"CodePage",t:kS},2:{n:"Title",t:sa},3:{n:"Subject",t:sa},4:{n:"Author",t:sa},5:{n:"Keywords",t:sa},6:{n:"Comments",t:sa},7:{n:"Template",t:sa},8:{n:"LastAuthor",t:sa},9:{n:"RevNumber",t:sa},10:{n:"EditTime",t:_y},11:{n:"LastPrinted",t:_y},12:{n:"CreatedDate",t:_y},13:{n:"ModifiedDate",t:_y},14:{n:"PageCount",t:Ci},15:{n:"WordCount",t:Ci},16:{n:"CharCount",t:Ci},17:{n:"Thumbnail",t:wG},18:{n:"Application",t:sa},19:{n:"DocSecurity",t:Ci},255:{},2147483648:{n:"Locale",t:b1},2147483651:{n:"Behavior",t:b1},1919054434:{}},WN={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},kG=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function CG(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var TG=CG([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),qd=zn(TG),Oc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},$8={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},d2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},by={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function CS(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function EG(e){var t=CS();if(!e||!e.match)return t;var r={};if((e.match(Xa)||[]).forEach(function(n){var s=kr(n);switch(s[0].replace(OH,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[d2[s.ContentType]]!==void 0&&t[d2[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Ks.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function W8(e,t){var r=EH(d2),n=[],s;n[n.length]=Es,n[n.length]=Wt("Types",null,{xmlns:Ks.CT,"xmlns:xsd":Ks.xsd,"xmlns:xsi":Ks.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Wt("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=Wt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:by[c][t.bookType]||by[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(d){n[n.length]=Wt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:by[c][t.bookType]||by[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(d){n[n.length]=Wt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),i("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Gr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function xp(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Wm(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Xa)||[]).forEach(function(s){var a=kr(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var l=a.TargetMode==="External"?a.Target:Nm(a.Target,t);r[l]=i,n[a.Id]=i}}),r["!id"]=n,r}function r0(e){var t=[Es,Wt("Relationships",null,{xmlns:Ks.RELS})];return gs(e["!id"]).forEach(function(r){t[t.length]=Wt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function xn(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[Gr.HLINK,Gr.XPATH,Gr.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var NG="application/vnd.oasis.opendocument.spreadsheet";function AG(e,t){for(var r=mS(e),n,s;n=pp.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=kr(n[0],!1),s.path=="/"&&s.type!==NG)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function jG(e){var t=[Es];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function zN(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function FG(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function PG(e){var t=[Es];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(zN(e[r][0],e[r][1])),t.push(FG("",e[r][0]));return t.push(zN("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function z8(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+g1.version+"</meta:generator></office:meta></office:document-meta>"}var bo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],RG=(function(){for(var e=new Array(bo.length),t=0;t<bo.length;++t){var r=bo[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function H8(e){var t={};e=kn(e);for(var r=0;r<bo.length;++r){var n=bo[r],s=e.match(RG[r]);s!=null&&s.length>0&&(t[n[1]]=Qr(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Wn(t[n[1]]))}return t}function zw(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=yn(t),n[n.length]=r?Wt(e,t,r):Ea(e,t))}function G8(e,t){var r=t||{},n=[Es,Wt("cp:coreProperties",null,{"xmlns:cp":Ks.CORE_PROPS,"xmlns:dc":Ks.dc,"xmlns:dcterms":Ks.dcterms,"xmlns:dcmitype":Ks.dcmitype,"xmlns:xsi":Ks.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&zw("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:o2(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&zw("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:o2(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=bo.length;++a){var i=bo[a],l=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&zw(i[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Xd=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],V8=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function K8(e,t,r,n){var s=[];if(typeof e=="string")s=RN(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(f){return{v:f}}));var i=typeof t=="string"?RN(t,n).map(function(f){return f.v}):t,l=0,c=0;if(i.length>0)for(var d=0;d!==s.length;d+=2){switch(c=+s[d+1].v,s[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(l,l+c);break}l+=c}}function DG(e,t,r){var n={};return t||(t={}),e=kn(e),Xd.forEach(function(s){var a=(e.match(gp(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=Qr(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&K8(n.HeadingPairs,n.TitlesOfParts,t,r),t}function q8(e){var t=[],r=Wt;return e||(e={}),e.Application="SheetJS",t[t.length]=Es,t[t.length]=Wt("Properties",null,{xmlns:Ks.EXT_PROPS,"xmlns:vt":Ks.vt}),Xd.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=yn(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+yn(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var IG=/<[^>]+>[^<]*/g;function MG(e,t){var r={},n="",s=e.match(IG);if(s)for(var a=0;a!=s.length;++a){var i=s[a],l=kr(i);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Qr(l.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),d=c[0].slice(4),f=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Qr(f);break;case"bool":r[n]=Ln(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Wn(f);break;case"cy":case"error":r[n]=Qr(f);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,d,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function X8(e){var t=[Es,Wt("Properties",null,{xmlns:Ks.CUST_PROPS,"xmlns:vt":Ks.vt})];if(!e)return t.join("");var r=1;return gs(e).forEach(function(s){++r,t[t.length]=Wt("property",GH(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:yn(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var f2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Hw;function OG(e,t,r){Hw||(Hw=nv(f2)),t=Hw[t]||t,e[t]=r}function LG(e,t){var r=[];return gs(f2).map(function(n){for(var s=0;s<bo.length;++s)if(bo[s][1]==n)return bo[s];for(s=0;s<Xd.length;++s)if(Xd[s][1]==n)return Xd[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Ea(f2[n[1]]||n[1],s))}}),Wt("DocumentProperties",r.join(""),{xmlns:zi.o})}function BG(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&gs(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<bo.length;++i)if(a==bo[i][1])return;for(i=0;i<Xd.length;++i)if(a==Xd[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var l=e[a],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(Wt(AN(a),l,{"dt:dt":c}))}}),t&&gs(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],l="string";typeof i=="number"?(l="float",i=String(i)):i===!0||i===!1?(l="boolean",i=i?"1":"0"):i instanceof Date?(l="dateTime.tz",i=i.toISOString()):i=String(i),s.push(Wt(AN(a),i,{"dt:dt":l}))}}),"<"+n+' xmlns="'+zi.o+'">'+s.join("")+"</"+n+">"}function TS(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function UG(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=vt(8);return i.write_shift(4,n),i.write_shift(4,s),i}function Y8(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function J8(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Q8(e,t,r){return t===31?J8(e):Y8(e,t,r)}function h2(e,t,r){return Q8(e,t,r===!1?0:4)}function $G(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Q8(e,t,0)}function WG(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(hi,""),e.l-s&2&&(e.l+=2)}return r}function zG(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(hi,"");return r}function HG(e){var t=e.l,r=S1(e,U8);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=S1(e,Ci);return[r,n]}function GG(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(HG(e));return r}function HN(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(hi,"").replace(Em,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Z8(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function VG(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function S1(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==$N&&n!==t&&SG.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===$N?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Y8(e,n,4).replace(hi,"");case 31:return J8(e);case 64:return TS(e);case 65:return Z8(e);case 71:return VG(e);case 80:return h2(e,n,!a.raw).replace(hi,"");case 81:return $G(e,n).replace(hi,"");case 4108:return GG(e);case 4126:case 4127:return n==4127?WG(e):zG(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function GN(e,t){var r=vt(4),n=vt(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=vt(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=UG(t);break;case 31:case 80:for(n=vt(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return oa([r,n])}function VN(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,l=0,c=-1,d={};for(i=0;i!=s;++i){var f=e.read_shift(4),p=e.read_shift(4);a[i]=[f,p+r]}a.sort(function(k,w){return k[1]-w[1]});var g={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var y=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,y=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],y=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],y=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(y=!1,e.l=a[i][1]),y)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var v=t[a[i][0]];if(g[v.n]=S1(e,v.t,{raw:!0}),v.p==="version"&&(g[v.n]=String(g[v.n]>>16)+"."+("0000"+String(g[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(g[v.n]){case 0:g[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:qo(l=g[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[v.n])}}else if(a[i][0]===1){if(l=g.CodePage=S1(e,kS),qo(l),c!==-1){var _=e.l;e.l=a[c][1],d=HN(e,l),e.l=_}}else if(a[i][0]===0){if(l===0){c=i,e.l=a[i+1][1];continue}d=HN(e,l)}else{var b=d[a[i][0]],N;switch(e[e.l]){case 65:e.l+=4,N=Z8(e);break;case 30:e.l+=4,N=h2(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,N=h2(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,N=e.read_shift(4,"i");break;case 19:e.l+=4,N=e.read_shift(4);break;case 5:e.l+=4,N=e.read_shift(8,"f");break;case 11:e.l+=4,N=Ss(e,4);break;case 64:e.l+=4,N=Wn(TS(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[b]=N}}return e.l=r+n,g}var eF=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function KG(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function KN(e,t,r){var n=vt(8),s=[],a=[],i=8,l=0,c=vt(8),d=vt(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),a.push(c),s.push(d),i+=8+c.length,!t){d=vt(8),d.write_shift(4,0),s.unshift(d);var f=[vt(4)];for(f[0].write_shift(4,e.length),l=0;l<e.length;++l){var p=e[l][0];for(c=vt(8+2*(p.length+1)+(p.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,p.length+1),c.write_shift(0,p,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=oa(f),a.unshift(c),i+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(eF.indexOf(e[l][0])>-1||V8.indexOf(e[l][0])>-1)&&e[l][1]!=null){var g=e[l][1],y=0;if(t){y=+t[e[l][0]];var v=r[y];if(v.p=="version"&&typeof g=="string"){var _=g.split(".");g=(+_[0]<<16)+(+_[1]||0)}c=GN(v.t,g)}else{var b=KG(g);b==-1&&(b=31,g=String(g)),c=GN(b,g)}a.push(c),d=vt(8),d.write_shift(4,t?y:2+l),s.push(d),i+=8+c.length}var N=8*(a.length+1);for(l=0;l<a.length;++l)s[l].write_shift(4,N),N+=a[l].length;return n.write_shift(4,i),n.write_shift(4,a.length),oa([n].concat(s).concat(a))}function qN(e,t,r){var n=e.content;if(!n)return{};ka(n,0);var s,a,i,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),f=n.read_shift(16);if(f!==gr.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),l=n.read_shift(4),s===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var p=VN(n,t),g={SystemIdentifier:d};for(var y in p)g[y]=p[y];if(g.FMTID=a,s===1)return g;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var v;try{v=VN(n,null)}catch{}for(y in v)g[y]=v[y];return g.FMTID=[a,i],g}function XN(e,t,r,n,s,a){var i=vt(s?68:48),l=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,gr.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var c=KN(e,r,n);if(l.push(c),s){var d=KN(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),l.push(d)}return oa(l)}function ku(e,t){return e.read_shift(t),null}function qG(e,t){t||(t=vt(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function XG(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Ss(e,t){return e.read_shift(t)===1}function ci(e,t){return t||(t=vt(2)),t.write_shift(2,+!!e),t}function Is(e){return e.read_shift(2,"u")}function yo(e,t){return t||(t=vt(2)),t.write_shift(2,e),t}function tF(e,t){return XG(e,t,Is)}function YG(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function rF(e,t,r){return r||(r=vt(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Yp(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function JG(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,l,c={};s&&(i=e.read_shift(2)),n&&(l=e.read_shift(4));var d=a==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,d);return s&&(e.l+=4*i),n&&(e.l+=l),c.t=f,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function QG(e){var t=e.t||"",r=vt(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=vt(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return oa(s)}function pf(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Jp(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):pf(e,n,r)}function Ef(e,t,r){if(r.biff>5)return Jp(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function nF(e,t,r){return r||(r=vt(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function ZG(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function eV(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(hi,"");return n&&(e.l+=24),s}function tV(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(hi,"");return r+i}function rV(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return eV(e);case"0303000000000000c000000000000046":return tV(e);default:throw new Error("Unsupported Moniker "+r)}}function Sy(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(hi,""):"";return r}function YN(e,t){t||(t=vt(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function nV(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,l,c,d="",f,p;s&16&&(a=Sy(e,r-e.l)),s&128&&(i=Sy(e,r-e.l)),(s&257)===257&&(l=Sy(e,r-e.l)),(s&257)===1&&(c=rV(e,r-e.l)),s&8&&(d=Sy(e,r-e.l)),s&32&&(f=e.read_shift(16)),s&64&&(p=TS(e)),e.l=r;var g=i||l||c||"";g&&d&&(g+="#"+d),g||(g="#"+d),s&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var y={Target:g};return f&&(y.guid=f),p&&(y.time=p),a&&(y.Tooltip=a),y}function sV(e){var t=vt(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),YN(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var l=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),a&8&&YN(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function sF(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function aF(e,t){var r=sF(e);return r[3]=0,r}function $l(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function xf(e,t,r,n){return n||(n=vt(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function aV(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function iV(e,t,r){return t===0?"":Ef(e,t,r)}function oV(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function iF(e){var t=e.read_shift(2),r=SS(e);return[t,r]}function lV(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=Yp(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function iv(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function oF(e,t){return t||(t=vt(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function lF(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var cV=lF;function cF(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function uV(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function dV(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Oa(e){e.l+=2,e.l+=e.read_shift(2)}var fV={0:Oa,4:Oa,5:Oa,6:Oa,7:dV,8:Oa,9:Oa,10:Oa,11:Oa,12:Oa,13:uV,14:Oa,15:Oa,16:Oa,17:Oa,18:Oa,19:Oa,20:Oa,21:cF};function hV(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(fV[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function ky(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function ES(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=vt(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function gV(e,t){return t===0||e.read_shift(2),1200}function mV(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=Ef(e,0,r);return e.read_shift(t+n-e.l),s}function pV(e,t){var r=!t||t.biff==8,n=vt(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function xV(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function yV(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Yp(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function vV(e,t){var r=!t||t.biff>=8?2:1,n=vt(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function wV(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(JG(e));return a.Count=n,a.Unique=s,a}function _V(e,t){var r=vt(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=QG(e[s]);var a=oa([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function bV(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function SV(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function kV(e){var t=aV(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function CV(e){return e.read_shift(2),e.read_shift(4)}function JN(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function TV(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:l,Selected:c,TabRatio:d}}function EV(){var e=vt(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function NV(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function AV(e){var t=vt(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function jV(){}function FV(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Yp(e,0,r),n}function PV(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=vt(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function RV(e){var t=$l(e);return t.isst=e.read_shift(4),t}function DV(e,t,r,n){var s=vt(10);return xf(e,t,n,s),s.write_shift(4,r),s}function IV(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=$l(e);r.biff==2&&e.l++;var a=Jp(e,n-e.l,r);return s.val=a,s}function MV(e,t,r,n,s){var a=!s||s.biff==8,i=vt(8+ +a+(1+a)*r.length);return xf(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function OV(e,t,r){var n=e.read_shift(2),s=Ef(e,0,r);return[n,s]}function LV(e,t,r,n){var s=r&&r.biff==5;n||(n=vt(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var BV=Ef;function QN(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:l},e:{r:i,c}}}function UV(e,t){var r=t.biff==8||!t.biff?4:2,n=vt(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function $V(e){var t=e.read_shift(2),r=e.read_shift(2),n=iF(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function WV(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(iF(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function zV(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function HV(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return s.patternType=kG[l>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function GV(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=HV(e,t,n.fStyle,r),n}function ZN(e,t,r,n){var s=r&&r.biff==5;n||(n=vt(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function VV(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function KV(e){var t=vt(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function e3(e,t,r){var n=$l(e);(r.biff==2||t==9)&&++e.l;var s=YG(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function qV(e,t,r,n,s,a){var i=vt(8);return xf(e,t,n,i),rF(r,a,i),i}function XV(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=$l(e),s=Wa(e);return n.val=s,n}function YV(e,t,r,n){var s=vt(14);return xf(e,t,n,s),mf(r,s),s}var t3=iV;function JV(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=pf(e,a),l=[];n>e.l;)l.push(Jp(e));return[a,s,i,l]}function r3(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=lV(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var QV=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function n3(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=pf(e,i,r);s&32&&(d=QV[d.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var p=n==e.l||l===0||!(f>0)?[]:hJ(e,f,r,l);return{chKey:a,Name:d,itab:c,rgce:p}}function uF(e,t,r){if(r.biff<8)return ZV(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(oV(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function ZV(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Yp(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function eK(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=pf(e,n,r),i=pf(e,s,r);return[a,i]}function tK(e,t,r){var n=lF(e);e.l++;var s=e.read_shift(1);return t-=8,[gJ(e,t,r),s,n]}function s3(e,t,r){var n=cV(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,dJ(e,t,r)]}function rK(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function nK(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),l=Ef(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},l,i,a]}}function sK(e,t,r){return nK(e,t,r)}function aK(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(iv(e));return r}function iK(e){var t=vt(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)oF(e[r],t);return t}function oK(e,t,r){if(r&&r.biff<8)return cK(e,t,r);var n=cF(e),s=hV(e,t-22,n[1]);return{cmo:n,ft:s}}var lK={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function cK(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((lK[n]||qa)(e,t,r)),{cmo:[s,n,a],ft:i}}function uK(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=ZG(e,6,r);var l=e.read_shift(2);e.read_shift(2),Is(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var f=e[e.l],p=pf(e,e.lens[d+1]-e.lens[d]-1);if(s+=p,s.length>=(f?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function dK(e,t){var r=iv(e);e.l+=16;var n=nV(e,t-24);return[r,n]}function fK(e){var t=vt(24),r=ts(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return oa([t,sV(e[1])])}function hK(e,t){e.read_shift(2);var r=iv(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(hi,""),[r,n]}function gK(e){var t=e[1].Tooltip,r=vt(10+2*(t.length+1));r.write_shift(2,2048);var n=ts(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function mK(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=WN[r]||r,r=e.read_shift(2),t[1]=WN[r]||r,t}function pK(e){return e||(e=vt(4)),e.write_shift(2,1),e.write_shift(2,1),e}function xK(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(aF(e));return r}function yK(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(aF(e));return r}function vK(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function dF(e,t,r){if(!r.cellStyles)return qa(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var d={s,e:a,w:i,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function wK(e,t){var r=vt(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function _K(e,t){var r={};return t<32||(e.l+=16,r.header=Wa(e),r.footer=Wa(e),e.l+=2),r}function bK(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function SK(e){for(var t=vt(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var kK=$l,CK=tF,TK=Jp;function EK(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function NK(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=$l(e);++e.l;var s=Ef(e,t-7,r);return n.t="str",n.val=s,n}function AK(e){var t=$l(e);++e.l;var r=Wa(e);return t.t="n",t.val=r,t}function jK(e,t,r){var n=vt(15);return tx(n,e,t),n.write_shift(8,r,"f"),n}function FK(e){var t=$l(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function PK(e,t,r){var n=vt(9);return tx(n,e,t),n.write_shift(2,r),n}function RK(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function DK(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function IK(e,t,r){var n=e.l+t,s=$l(e),a=e.read_shift(2),i=pf(e,a,r);return e.l=n,s.t="str",s.val=i,s}var MK=[2,3,48,49,131,139,140,245],g2=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=nv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],f=Wu(1);switch(c.type){case"base64":f=Gi(qi(l));break;case"binary":f=Gi(l);break;case"buffer":case"array":f=l;break}ka(f,0);var p=f.read_shift(1),g=!!(p&136),y=!1,v=!1;switch(p){case 2:break;case 3:break;case 48:y=!0,g=!0;break;case 49:y=!0,g=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var _=0,b=521;p==2&&(_=f.read_shift(2)),f.l+=3,p!=2&&(_=f.read_shift(4)),_>1048576&&(_=1e6),p!=2&&(b=f.read_shift(2));var N=f.read_shift(2),k=c.codepage||1252;p!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(k=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var w=[],T={},A=Math.min(f.length,p==2?521:b-10-(y?264:0)),F=v?32:11;f.l<A&&f[f.l]!=13;)switch(T={},T.name=dp.utils.decode(k,f.slice(f.l,f.l+F)).replace(/[\u0000\r\n].*$/g,""),f.l+=F,T.type=String.fromCharCode(f.read_shift(1)),p!=2&&!v&&(T.offset=f.read_shift(4)),T.len=f.read_shift(1),p==2&&(T.offset=f.read_shift(2)),T.dec=f.read_shift(1),T.name.length&&w.push(T),p!=2&&(f.l+=v?13:14),T.type){case"B":(!y||T.len!=8)&&c.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(f[f.l]!==13&&(f.l=b-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=b;var R=0,E=0;for(d[0]=[],E=0;E!=w.length;++E)d[0][E]=w[E].name;for(;_-- >0;){if(f[f.l]===42){f.l+=N;continue}for(++f.l,d[++R]=[],E=0,E=0;E!=w.length;++E){var D=f.slice(f.l,f.l+w[E].len);f.l+=w[E].len,ka(D,0);var I=dp.utils.decode(k,D);switch(w[E].type){case"C":I.trim().length&&(d[R][E]=I.replace(/\s+$/,""));break;case"D":I.length===8?d[R][E]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):d[R][E]=I;break;case"F":d[R][E]=parseFloat(I.trim());break;case"+":case"I":d[R][E]=v?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":d[R][E]=!0;break;case"N":case"F":d[R][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));d[R][E]="##MEMO##"+(v?parseInt(I.trim(),10):D.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(d[R][E]=+I||0);break;case"@":d[R][E]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":d[R][E]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":d[R][E]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[R][E]=-D.read_shift(-8,"f");break;case"B":if(y&&w[E].len==8){d[R][E]=D.read_shift(8,"f");break}case"G":case"P":D.l+=w[E].len;break;case"0":if(w[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[E].type)}}}if(p!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=w,d}function n(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var f=I0(r(l,d),d);return f["!cols"]=d.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete d.DBF,f}function s(l,c){try{return ed(n(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(l,c){var d=c||{};if(+d.codepage>=0&&qo(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var f=Fi(),p=T1(l,{header:1,raw:!0,cellDates:!0}),g=p[0],y=p.slice(1),v=l["!cols"]||[],_=0,b=0,N=0,k=1;for(_=0;_<g.length;++_){if(((v[_]||{}).DBF||{}).name){g[_]=v[_].DBF.name,++N;continue}if(g[_]!=null){if(++N,typeof g[_]=="number"&&(g[_]=g[_].toString(10)),typeof g[_]!="string")throw new Error("DBF Invalid column name "+g[_]+" |"+typeof g[_]+"|");if(g.indexOf(g[_])!==_){for(b=0;b<1024;++b)if(g.indexOf(g[_]+"_"+b)==-1){g[_]+="_"+b;break}}}}var w=Zr(l["!ref"]),T=[],A=[],F=[];for(_=0;_<=w.e.c-w.s.c;++_){var R="",E="",D=0,I=[];for(b=0;b<y.length;++b)y[b][_]!=null&&I.push(y[b][_]);if(I.length==0||g[_]==null){T[_]="?";continue}for(b=0;b<I.length;++b){switch(typeof I[b]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=I[b]instanceof Date?"D":"C";break;default:E="C"}D=Math.max(D,String(I[b]).length),R=R&&R!=E?"C":E}D>250&&(D=250),E=((v[_]||{}).DBF||{}).type,E=="C"&&v[_].DBF.len>D&&(D=v[_].DBF.len),R=="B"&&E=="N"&&(R="N",F[_]=v[_].DBF.dec,D=v[_].DBF.len),A[_]=R=="C"||E=="N"?D:a[R]||0,k+=A[_],T[_]=R}var G=f.next(32);for(G.write_shift(4,318902576),G.write_shift(4,y.length),G.write_shift(2,296+32*N),G.write_shift(2,k),_=0;_<4;++_)G.write_shift(4,0);for(G.write_shift(4,0|(+t[e8]||3)<<8),_=0,b=0;_<g.length;++_)if(g[_]!=null){var Y=f.next(32),ee=(g[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Y.write_shift(1,ee,"sbcs"),Y.write_shift(1,T[_]=="?"?"C":T[_],"sbcs"),Y.write_shift(4,b),Y.write_shift(1,A[_]||a[T[_]]||0),Y.write_shift(1,F[_]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),b+=A[_]||a[T[_]]||0}var ie=f.next(264);for(ie.write_shift(4,13),_=0;_<65;++_)ie.write_shift(4,0);for(_=0;_<y.length;++_){var re=f.next(k);for(re.write_shift(1,0),b=0;b<g.length;++b)if(g[b]!=null)switch(T[b]){case"L":re.write_shift(1,y[_][b]==null?63:y[_][b]?84:70);break;case"B":re.write_shift(8,y[_][b]||0,"f");break;case"N":var se="0";for(typeof y[_][b]=="number"&&(se=y[_][b].toFixed(F[b]||0)),N=0;N<A[b]-se.length;++N)re.write_shift(1,32);re.write_shift(1,se,"sbcs");break;case"D":y[_][b]?(re.write_shift(4,("0000"+y[_][b].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(y[_][b].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+y[_][b].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var B=String(y[_][b]!=null?y[_][b]:"").slice(0,A[b]);for(re.write_shift(1,B,"sbcs"),N=0;N<A[b]-B.length;++N)re.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}})(),fF=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+gs(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,y){var v=e[y];return typeof v=="number"?mN(v):v},n=function(g,y,v){var _=y.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return _==59?g:mN(_)};e["|"]=254;function s(g,y){switch(y.type){case"base64":return a(qi(g),y);case"binary":return a(g,y);case"buffer":return a(Ur&&Buffer.isBuffer(g)?g.toString("binary"):Zu(g),y);case"array":return a(gf(g),y)}throw new Error("Unrecognized type "+y.type)}function a(g,y){var v=g.split(/[\n\r]+/),_=-1,b=-1,N=0,k=0,w=[],T=[],A=null,F={},R=[],E=[],D=[],I=0,G;for(+y.codepage>=0&&qo(+y.codepage);N!==v.length;++N){I=0;var Y=v[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ee=Y.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),ie=ee[0],re;if(Y.length>0)switch(ie){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ee[1].charAt(0)=="P"&&T.push(Y.slice(3).replace(/;;/g,";"));break;case"C":var se=!1,B=!1,z=!1,U=!1,V=-1,q=-1;for(k=1;k<ee.length;++k)switch(ee[k].charAt(0)){case"A":break;case"X":b=parseInt(ee[k].slice(1))-1,B=!0;break;case"Y":for(_=parseInt(ee[k].slice(1))-1,B||(b=0),G=w.length;G<=_;++G)w[G]=[];break;case"K":re=ee[k].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(Jo(re))?isNaN(g0(re).getDate())||(re=Wn(re)):(re=Jo(re),A!==null&&R0(A)&&(re=av(re))),se=!0;break;case"E":U=!0;var L=n0(ee[k].slice(1),{r:_,c:b});w[_][b]=[w[_][b],L];break;case"S":z=!0,w[_][b]=[w[_][b],"S5S"];break;case"G":break;case"R":V=parseInt(ee[k].slice(1))-1;break;case"C":q=parseInt(ee[k].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+Y)}if(se&&(w[_][b]&&w[_][b].length==2?w[_][b][0]=re:w[_][b]=re,A=null),z){if(U)throw new Error("SYLK shared formula cannot have own formula");var M=V>-1&&w[V][q];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");w[_][b][1]=jF(M[1],{r:_-V,c:b-q})}break;case"F":var X=0;for(k=1;k<ee.length;++k)switch(ee[k].charAt(0)){case"X":b=parseInt(ee[k].slice(1))-1,++X;break;case"Y":for(_=parseInt(ee[k].slice(1))-1,G=w.length;G<=_;++G)w[G]=[];break;case"M":I=parseInt(ee[k].slice(1))/20;break;case"F":break;case"G":break;case"P":A=T[parseInt(ee[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=ee[k].slice(1).split(" "),G=parseInt(D[0],10);G<=parseInt(D[1],10);++G)I=parseInt(D[2],10),E[G-1]=I===0?{hidden:!0}:{wch:I},zu(E[G-1]);break;case"C":b=parseInt(ee[k].slice(1))-1,E[b]||(E[b]={});break;case"R":_=parseInt(ee[k].slice(1))-1,R[_]||(R[_]={}),I>0?(R[_].hpt=I,R[_].hpx=p0(I)):I===0&&(R[_].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+Y)}X<1&&(A=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+Y)}}return R.length>0&&(F["!rows"]=R),E.length>0&&(F["!cols"]=E),y&&y.sheetRows&&(w=w.slice(0,y.sheetRows)),[w,F]}function i(g,y){var v=s(g,y),_=v[0],b=v[1],N=I0(_,y);return gs(b).forEach(function(k){N[k]=b[k]}),N}function l(g,y){return ed(i(g,y),y)}function c(g,y,v,_){var b="C;Y"+(v+1)+";X"+(_+1)+";K";switch(g.t){case"n":b+=g.v||0,g.f&&!g.F&&(b+=";E"+RS(g.f,{r:v,c:_}));break;case"b":b+=g.v?"TRUE":"FALSE";break;case"e":b+=g.w||g.v;break;case"d":b+='"'+(g.w||g.v)+'"';break;case"s":b+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function d(g,y){y.forEach(function(v,_){var b="F;W"+(_+1)+" "+(_+1)+" ";v.hidden?b+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=vp(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=wp(v.wpx)),typeof v.wch=="number"&&(b+=Math.round(v.wch))),b.charAt(b.length-1)!=" "&&g.push(b)})}function f(g,y){y.forEach(function(v,_){var b="F;";v.hidden?b+="M0;":v.hpt?b+="M"+20*v.hpt+";":v.hpx&&(b+="M"+20*_p(v.hpx)+";"),b.length>2&&g.push(b+"R"+(_+1))})}function p(g,y){var v=["ID;PWXL;N;E"],_=[],b=Zr(g["!ref"]),N,k=Array.isArray(g),w=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),g["!cols"]&&d(v,g["!cols"]),g["!rows"]&&f(v,g["!rows"]),v.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var T=b.s.r;T<=b.e.r;++T)for(var A=b.s.c;A<=b.e.c;++A){var F=br({r:T,c:A});N=k?(g[T]||[])[A]:g[F],!(!N||N.v==null&&(!N.f||N.F))&&_.push(c(N,g,T,A))}return v.join(w)+w+_.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:i,from_sheet:p}})(),hF=(function(){function e(a,i){switch(i.type){case"base64":return t(qi(a),i);case"binary":return t(a,i);case"buffer":return t(Ur&&Buffer.isBuffer(a)?a.toString("binary"):Zu(a),i);case"array":return t(gf(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var l=a.split(`
`),c=-1,d=-1,f=0,p=[];f!==l.length;++f){if(l[f].trim()==="BOT"){p[++c]=[],d=0;continue}if(!(c<0)){var g=l[f].trim().split(","),y=g[0],v=g[1];++f;for(var _=l[f]||"";(_.match(/["]/g)||[]).length&1&&f<l.length-1;)_+=`
`+l[++f];switch(_=_.trim(),+y){case-1:if(_==="BOT"){p[++c]=[],d=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?p[c][d]=!0:_==="FALSE"?p[c][d]=!1:isNaN(Jo(v))?isNaN(g0(v).getDate())?p[c][d]=v:p[c][d]=Wn(v):p[c][d]=Jo(v),++d;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),p[c][d++]=_!==""?_:null;break}if(_==="EOD")break}}return i&&i.sheetRows&&(p=p.slice(0,i.sheetRows)),p}function r(a,i){return I0(e(a,i),i)}function n(a,i){return ed(r(a,i),i)}var s=(function(){var a=function(c,d,f,p,g){c.push(d),c.push(f+","+p),c.push('"'+g.replace(/"/g,'""')+'"')},i=function(c,d,f,p){c.push(d+","+f),c.push(d==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(c){var d=[],f=Zr(c["!ref"]),p,g=Array.isArray(c);a(d,"TABLE",0,1,"sheetjs"),a(d,"VECTORS",0,f.e.r-f.s.r+1,""),a(d,"TUPLES",0,f.e.c-f.s.c+1,""),a(d,"DATA",0,0,"");for(var y=f.s.r;y<=f.e.r;++y){i(d,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var _=br({r:y,c:v});if(p=g?(c[y]||[])[v]:c[_],!p){i(d,1,0,"");continue}switch(p.t){case"n":var b=p.w;!b&&p.v!=null&&(b=p.v),b==null?p.f&&!p.F?i(d,1,0,"="+p.f):i(d,1,0,""):i(d,0,b,"V");break;case"b":i(d,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":i(d,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Co(p.z||wr[14],Xs(Wn(p.v)))),i(d,0,p.w,"V");break;default:i(d,1,0,"")}}}i(d,-1,0,"EOD");var N=`\r
`,k=d.join(N);return k}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),gF=(function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,g){for(var y=p.split(`
`),v=-1,_=-1,b=0,N=[];b!==y.length;++b){var k=y[b].trim().split(":");if(k[0]==="cell"){var w=ts(k[1]);if(N.length<=w.r)for(v=N.length;v<=w.r;++v)N[v]||(N[v]=[]);switch(v=w.r,_=w.c,k[2]){case"t":N[v][_]=e(k[3]);break;case"v":N[v][_]=+k[3];break;case"vtf":var T=k[k.length-1];case"vtc":switch(k[3]){case"nl":N[v][_]=!!+k[4];break;default:N[v][_]=+k[4];break}k[2]=="vtf"&&(N[v][_]=[N[v][_],T])}}}return g&&g.sheetRows&&(N=N.slice(0,g.sheetRows)),N}function n(p,g){return I0(r(p,g),g)}function s(p,g){return ed(n(p,g),g)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(p){if(!p||!p["!ref"])return"";for(var g=[],y=[],v,_="",b=Pi(p["!ref"]),N=Array.isArray(p),k=b.s.r;k<=b.e.r;++k)for(var w=b.s.c;w<=b.e.c;++w)if(_=br({r:k,c:w}),v=N?(p[k]||[])[w]:p[_],!(!v||v.v==null||v.t==="z")){switch(y=["cell",_,"t"],v.t){case"s":case"str":y.push(t(v.v));break;case"n":v.f?(y[2]="vtf",y[3]="n",y[4]=v.v,y[5]=t(v.f)):(y[2]="v",y[3]=v.v);break;case"b":y[2]="vt"+(v.f?"f":"c"),y[3]="nl",y[4]=v.v?"1":"0",y[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var T=Xs(Wn(v.v));y[2]="vtc",y[3]="nd",y[4]=""+T,y[5]=v.w||Co(v.z||wr[14],T);break;case"e":continue}g.push(y.join(":"))}return g.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function f(p){return[a,i,l,i,d(p),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}})(),m0=(function(){function e(f,p,g,y,v){v.raw?p[g][y]=f:f===""||(f==="TRUE"?p[g][y]=!0:f==="FALSE"?p[g][y]=!1:isNaN(Jo(f))?isNaN(g0(f).getDate())?p[g][y]=f:p[g][y]=Wn(f):p[g][y]=Jo(f))}function t(f,p){var g=p||{},y=[];if(!f||f.length===0)return y;for(var v=f.split(/[\r\n]/),_=v.length-1;_>=0&&v[_].length===0;)--_;for(var b=10,N=0,k=0;k<=_;++k)N=v[k].indexOf(" "),N==-1?N=v[k].length:N++,b=Math.max(b,N);for(k=0;k<=_;++k){y[k]=[];var w=0;for(e(v[k].slice(0,b).trim(),y,k,w,g),w=1;w<=(v[k].length-b)/10+1;++w)e(v[k].slice(b+(w-1)*10,b+w*10).trim(),y,k,w,g)}return g.sheetRows&&(y=y.slice(0,g.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var p={},g=!1,y=0,v=0;y<f.length;++y)(v=f.charCodeAt(y))==34?g=!g:!g&&v in r&&(p[v]=(p[v]||0)+1);v=[];for(y in p)Object.prototype.hasOwnProperty.call(p,y)&&v.push([p[y],y]);if(!v.length){p=n;for(y in p)Object.prototype.hasOwnProperty.call(p,y)&&v.push([p[y],y])}return v.sort(function(_,b){return _[0]-b[0]||n[_[1]]-n[b[1]]}),r[v.pop()[1]]||44}function a(f,p){var g=p||{},y="",v=g.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(y=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(y=f.charAt(4),f=f.slice(6)):y=s(f.slice(0,1024)):g&&g.FS?y=g.FS:y=s(f.slice(0,1024));var b=0,N=0,k=0,w=0,T=0,A=y.charCodeAt(0),F=!1,R=0,E=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var D=g.dateNF!=null?bH(g.dateNF):null;function I(){var G=f.slice(w,T),Y={};if(G.charAt(0)=='"'&&G.charAt(G.length-1)=='"'&&(G=G.slice(1,-1).replace(/""/g,'"')),G.length===0)Y.t="z";else if(g.raw)Y.t="s",Y.v=G;else if(G.trim().length===0)Y.t="s",Y.v=G;else if(G.charCodeAt(0)==61)G.charCodeAt(1)==34&&G.charCodeAt(G.length-1)==34?(Y.t="s",Y.v=G.slice(2,-1).replace(/""/g,'"')):JX(G)?(Y.t="n",Y.f=G.slice(1)):(Y.t="s",Y.v=G);else if(G=="TRUE")Y.t="b",Y.v=!0;else if(G=="FALSE")Y.t="b",Y.v=!1;else if(!isNaN(k=Jo(G)))Y.t="n",g.cellText!==!1&&(Y.w=G),Y.v=k;else if(!isNaN(g0(G).getDate())||D&&G.match(D)){Y.z=g.dateNF||wr[14];var ee=0;D&&G.match(D)&&(G=SH(G,g.dateNF,G.match(D)||[]),ee=1),g.cellDates?(Y.t="d",Y.v=Wn(G,ee)):(Y.t="n",Y.v=Xs(Wn(G,ee))),g.cellText!==!1&&(Y.w=Co(Y.z,Y.v instanceof Date?Xs(Y.v):Y.v)),g.cellNF||delete Y.z}else Y.t="s",Y.v=G;if(Y.t=="z"||(g.dense?(v[b]||(v[b]=[]),v[b][N]=Y):v[br({c:N,r:b})]=Y),w=T+1,E=f.charCodeAt(w),_.e.c<N&&(_.e.c=N),_.e.r<b&&(_.e.r=b),R==A)++N;else if(N=0,++b,g.sheetRows&&g.sheetRows<=b)return!0}e:for(;T<f.length;++T)switch(R=f.charCodeAt(T)){case 34:E===34&&(F=!F);break;case A:case 10:case 13:if(!F&&I())break e;break}return T-w>0&&I(),v["!ref"]=Dr(_),v}function i(f,p){return!(p&&p.PRN)||p.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,p):I0(t(f,p),p)}function l(f,p){var g="",y=p.type=="string"?[0,0,0,0]:$S(f,p);switch(p.type){case"base64":g=qi(f);break;case"binary":g=f;break;case"buffer":p.codepage==65001?g=f.toString("utf8"):p.codepage&&typeof dp<"u"||(g=Ur&&Buffer.isBuffer(f)?f.toString("binary"):Zu(f));break;case"array":g=gf(f);break;case"string":g=f;break;default:throw new Error("Unrecognized type "+p.type)}return y[0]==239&&y[1]==187&&y[2]==191?g=kn(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=kn(g):p.type=="binary"&&typeof dp<"u",g.slice(0,19)=="socialcalc:version:"?gF.to_sheet(p.type=="string"?g:kn(g),p):i(g,p)}function c(f,p){return ed(l(f,p),p)}function d(f){for(var p=[],g=Zr(f["!ref"]),y,v=Array.isArray(f),_=g.s.r;_<=g.e.r;++_){for(var b=[],N=g.s.c;N<=g.e.c;++N){var k=br({r:_,c:N});if(y=v?(f[_]||[])[N]:f[k],!y||y.v==null){b.push("          ");continue}for(var w=(y.w||(Pc(y),y.w)||"").slice(0,10);w.length<10;)w+=" ";b.push(w+(N===0?" ":""))}p.push(b.join(""))}return p.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}})();function OK(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=fF.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return m0.to_workbook(e,t)}}var Yd=(function(){function e(L,M,X){if(L){ka(L,L.l||0);for(var K=X.Enum||V;L.l<L.length;){var Z=L.read_shift(2),J=K[Z]||K[65535],ne=L.read_shift(2),me=L.l+ne,xe=J.f&&J.f(L,ne,X);if(L.l=me,M(xe,J,Z))return}}}function t(L,M){switch(M.type){case"base64":return r(Gi(qi(L)),M);case"binary":return r(Gi(L),M);case"buffer":case"array":return r(L,M)}throw"Unsupported type "+M.type}function r(L,M){if(!L)return L;var X=M||{},K=X.dense?[]:{},Z="Sheet1",J="",ne=0,me={},xe=[],Ne=[],le={s:{r:0,c:0},e:{r:0,c:0}},ge=X.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)X.Enum=V,e(L,function(He,Ft,rt){switch(rt){case 0:X.vers=He,He>=4096&&(X.qpro=!0);break;case 6:le=He;break;case 204:He&&(J=He);break;case 222:J=He;break;case 15:case 51:X.qpro||(He[1].v=He[1].v.slice(1));case 13:case 14:case 16:rt==14&&(He[2]&112)==112&&(He[2]&15)>1&&(He[2]&15)<15&&(He[1].z=X.dateNF||wr[14],X.cellDates&&(He[1].t="d",He[1].v=av(He[1].v))),X.qpro&&He[3]>ne&&(K["!ref"]=Dr(le),me[Z]=K,xe.push(Z),K=X.dense?[]:{},le={s:{r:0,c:0},e:{r:0,c:0}},ne=He[3],Z=J||"Sheet"+(ne+1),J="");var Ie=X.dense?(K[He[0].r]||[])[He[0].c]:K[br(He[0])];if(Ie){Ie.t=He[1].t,Ie.v=He[1].v,He[1].z!=null&&(Ie.z=He[1].z),He[1].f!=null&&(Ie.f=He[1].f);break}X.dense?(K[He[0].r]||(K[He[0].r]=[]),K[He[0].r][He[0].c]=He[1]):K[br(He[0])]=He[1];break}},X);else if(L[2]==26||L[2]==14)X.Enum=q,L[2]==14&&(X.qpro=!0,L.l=0),e(L,function(He,Ft,rt){switch(rt){case 204:Z=He;break;case 22:He[1].v=He[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(He[3]>ne&&(K["!ref"]=Dr(le),me[Z]=K,xe.push(Z),K=X.dense?[]:{},le={s:{r:0,c:0},e:{r:0,c:0}},ne=He[3],Z="Sheet"+(ne+1)),ge>0&&He[0].r>=ge)break;X.dense?(K[He[0].r]||(K[He[0].r]=[]),K[He[0].r][He[0].c]=He[1]):K[br(He[0])]=He[1],le.e.c<He[0].c&&(le.e.c=He[0].c),le.e.r<He[0].r&&(le.e.r=He[0].r);break;case 27:He[14e3]&&(Ne[He[14e3][0]]=He[14e3][1]);break;case 1537:Ne[He[0]]=He[1],He[0]==ne&&(Z=He[1]);break}},X);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(K["!ref"]=Dr(le),me[J||Z]=K,xe.push(J||Z),!Ne.length)return{SheetNames:xe,Sheets:me};for(var Ue={},Ge=[],Je=0;Je<Ne.length;++Je)me[xe[Je]]?(Ge.push(Ne[Je]||xe[Je]),Ue[Ne[Je]]=me[Ne[Je]]||me[xe[Je]]):(Ge.push(Ne[Je]),Ue[Ne[Je]]={"!ref":"A1"});return{SheetNames:Ge,Sheets:Ue}}function n(L,M){var X=M||{};if(+X.codepage>=0&&qo(+X.codepage),X.type=="string")throw new Error("Cannot write WK1 to JS string");var K=Fi(),Z=Zr(L["!ref"]),J=Array.isArray(L),ne=[];zt(K,0,a(1030)),zt(K,6,c(Z));for(var me=Math.min(Z.e.r,8191),xe=Z.s.r;xe<=me;++xe)for(var Ne=Cs(xe),le=Z.s.c;le<=Z.e.c;++le){xe===Z.s.r&&(ne[le]=es(le));var ge=ne[le]+Ne,Ue=J?(L[xe]||[])[le]:L[ge];if(!(!Ue||Ue.t=="z"))if(Ue.t=="n")(Ue.v|0)==Ue.v&&Ue.v>=-32768&&Ue.v<=32767?zt(K,13,y(xe,le,Ue.v)):zt(K,14,_(xe,le,Ue.v));else{var Ge=Pc(Ue);zt(K,15,p(xe,le,Ge.slice(0,239)))}}return zt(K,1),K.end()}function s(L,M){var X=M||{};if(+X.codepage>=0&&qo(+X.codepage),X.type=="string")throw new Error("Cannot write WK3 to JS string");var K=Fi();zt(K,0,i(L));for(var Z=0,J=0;Z<L.SheetNames.length;++Z)(L.Sheets[L.SheetNames[Z]]||{})["!ref"]&&zt(K,27,U(L.SheetNames[Z],J++));var ne=0;for(Z=0;Z<L.SheetNames.length;++Z){var me=L.Sheets[L.SheetNames[Z]];if(!(!me||!me["!ref"])){for(var xe=Zr(me["!ref"]),Ne=Array.isArray(me),le=[],ge=Math.min(xe.e.r,8191),Ue=xe.s.r;Ue<=ge;++Ue)for(var Ge=Cs(Ue),Je=xe.s.c;Je<=xe.e.c;++Je){Ue===xe.s.r&&(le[Je]=es(Je));var He=le[Je]+Ge,Ft=Ne?(me[Ue]||[])[Je]:me[He];if(!(!Ft||Ft.t=="z"))if(Ft.t=="n")zt(K,23,I(Ue,Je,ne,Ft.v));else{var rt=Pc(Ft);zt(K,22,R(Ue,Je,ne,rt.slice(0,239)))}}++ne}}return zt(K,1),K.end()}function a(L){var M=vt(2);return M.write_shift(2,L),M}function i(L){var M=vt(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var X=0,K=0,Z=0,J=0;J<L.SheetNames.length;++J){var ne=L.SheetNames[J],me=L.Sheets[ne];if(!(!me||!me["!ref"])){++Z;var xe=Pi(me["!ref"]);X<xe.e.r&&(X=xe.e.r),K<xe.e.c&&(K=xe.e.c)}}return X>8191&&(X=8191),M.write_shift(2,X),M.write_shift(1,Z),M.write_shift(1,K),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}function l(L,M,X){var K={s:{c:0,r:0},e:{c:0,r:0}};return M==8&&X.qpro?(K.s.c=L.read_shift(1),L.l++,K.s.r=L.read_shift(2),K.e.c=L.read_shift(1),L.l++,K.e.r=L.read_shift(2),K):(K.s.c=L.read_shift(2),K.s.r=L.read_shift(2),M==12&&X.qpro&&(L.l+=2),K.e.c=L.read_shift(2),K.e.r=L.read_shift(2),M==12&&X.qpro&&(L.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function c(L){var M=vt(8);return M.write_shift(2,L.s.c),M.write_shift(2,L.s.r),M.write_shift(2,L.e.c),M.write_shift(2,L.e.r),M}function d(L,M,X){var K=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&X.vers!=20768?(K[0].c=L.read_shift(1),K[3]=L.read_shift(1),K[0].r=L.read_shift(2),L.l+=2):(K[2]=L.read_shift(1),K[0].c=L.read_shift(2),K[0].r=L.read_shift(2)),K}function f(L,M,X){var K=L.l+M,Z=d(L,M,X);if(Z[1].t="s",X.vers==20768){L.l++;var J=L.read_shift(1);return Z[1].v=L.read_shift(J,"utf8"),Z}return X.qpro&&L.l++,Z[1].v=L.read_shift(K-L.l,"cstr"),Z}function p(L,M,X){var K=vt(7+X.length);K.write_shift(1,255),K.write_shift(2,M),K.write_shift(2,L),K.write_shift(1,39);for(var Z=0;Z<K.length;++Z){var J=X.charCodeAt(Z);K.write_shift(1,J>=128?95:J)}return K.write_shift(1,0),K}function g(L,M,X){var K=d(L,M,X);return K[1].v=L.read_shift(2,"i"),K}function y(L,M,X){var K=vt(7);return K.write_shift(1,255),K.write_shift(2,M),K.write_shift(2,L),K.write_shift(2,X,"i"),K}function v(L,M,X){var K=d(L,M,X);return K[1].v=L.read_shift(8,"f"),K}function _(L,M,X){var K=vt(13);return K.write_shift(1,255),K.write_shift(2,M),K.write_shift(2,L),K.write_shift(8,X,"f"),K}function b(L,M,X){var K=L.l+M,Z=d(L,M,X);if(Z[1].v=L.read_shift(8,"f"),X.qpro)L.l=K;else{var J=L.read_shift(2);T(L.slice(L.l,L.l+J),Z),L.l+=J}return Z}function N(L,M,X){var K=M&32768;return M&=-32769,M=(K?L:0)+(M>=8192?M-16384:M),(K?"":"$")+(X?es(M):Cs(M))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(L,M){ka(L,0);for(var X=[],K=0,Z="",J="",ne="",me="";L.l<L.length;){var xe=L[L.l++];switch(xe){case 0:X.push(L.read_shift(8,"f"));break;case 1:J=N(M[0].c,L.read_shift(2),!0),Z=N(M[0].r,L.read_shift(2),!1),X.push(J+Z);break;case 2:{var Ne=N(M[0].c,L.read_shift(2),!0),le=N(M[0].r,L.read_shift(2),!1);J=N(M[0].c,L.read_shift(2),!0),Z=N(M[0].r,L.read_shift(2),!1),X.push(Ne+le+":"+J+Z)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(L.read_shift(2));break;case 6:{for(var ge="";xe=L[L.l++];)ge+=String.fromCharCode(xe);X.push('"'+ge.replace(/"/g,'""')+'"')}break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:me=X.pop(),ne=X.pop(),X.push(["AND","OR"][xe-20]+"("+ne+","+me+")");break;default:if(xe<32&&w[xe])me=X.pop(),ne=X.pop(),X.push(ne+w[xe]+me);else if(k[xe]){if(K=k[xe][1],K==69&&(K=L[L.l++]),K>X.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+X.join("|")+"|");return}var Ue=X.slice(-K);X.length-=K,X.push(k[xe][0]+"("+Ue.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}X.length==1?M[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")}function A(L){var M=[{c:0,r:0},{t:"n",v:0},0];return M[0].r=L.read_shift(2),M[3]=L[L.l++],M[0].c=L[L.l++],M}function F(L,M){var X=A(L);return X[1].t="s",X[1].v=L.read_shift(M-4,"cstr"),X}function R(L,M,X,K){var Z=vt(6+K.length);Z.write_shift(2,L),Z.write_shift(1,X),Z.write_shift(1,M),Z.write_shift(1,39);for(var J=0;J<K.length;++J){var ne=K.charCodeAt(J);Z.write_shift(1,ne>=128?95:ne)}return Z.write_shift(1,0),Z}function E(L,M){var X=A(L);X[1].v=L.read_shift(2);var K=X[1].v>>1;if(X[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return X[1].v=K,X}function D(L,M){var X=A(L),K=L.read_shift(4),Z=L.read_shift(4),J=L.read_shift(2);if(J==65535)return K===0&&Z===3221225472?(X[1].t="e",X[1].v=15):K===0&&Z===3489660928?(X[1].t="e",X[1].v=42):X[1].v=0,X;var ne=J&32768;return J=(J&32767)-16446,X[1].v=(1-ne*2)*(Z*Math.pow(2,J+32)+K*Math.pow(2,J)),X}function I(L,M,X,K){var Z=vt(14);if(Z.write_shift(2,L),Z.write_shift(1,X),Z.write_shift(1,M),K==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var J=0,ne=0,me=0,xe=0;return K<0&&(J=1,K=-K),ne=Math.log2(K)|0,K/=Math.pow(2,ne-31),xe=K>>>0,(xe&2147483648)==0&&(K/=2,++ne,xe=K>>>0),K-=xe,xe|=2147483648,xe>>>=0,K*=Math.pow(2,32),me=K>>>0,Z.write_shift(4,me),Z.write_shift(4,xe),ne+=16383+(J?32768:0),Z.write_shift(2,ne),Z}function G(L,M){var X=D(L);return L.l+=M-14,X}function Y(L,M){var X=A(L),K=L.read_shift(4);return X[1].v=K>>6,X}function ee(L,M){var X=A(L),K=L.read_shift(8,"f");return X[1].v=K,X}function ie(L,M){var X=ee(L);return L.l+=M-10,X}function re(L,M){return L[L.l+M-1]==0?L.read_shift(M,"cstr"):""}function se(L,M){var X=L[L.l++];X>M-1&&(X=M-1);for(var K="";K.length<X;)K+=String.fromCharCode(L[L.l++]);return K}function B(L,M,X){if(!(!X.qpro||M<21)){var K=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var Z=L.read_shift(M-21,"cstr");return[K,Z]}}function z(L,M){for(var X={},K=L.l+M;L.l<K;){var Z=L.read_shift(2);if(Z==14e3){for(X[Z]=[0,""],X[Z][0]=L.read_shift(2);L[L.l];)X[Z][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return X}function U(L,M){var X=vt(5+L.length);X.write_shift(2,14e3),X.write_shift(2,M);for(var K=0;K<L.length;++K){var Z=L.charCodeAt(K);X[X.l++]=Z>127?95:Z}return X[X.l++]=0,X}var V={0:{n:"BOF",f:Is},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:se},65535:{n:""}},q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Y},38:{n:"??"},39:{n:"NUMBER27",f:ee},40:{n:"FORMULA28",f:ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:B},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}})();function LK(e){var t={},r=e.match(Xa),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=kr(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=sS[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var BK=(function(){var e=gp("t"),t=gp("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var l={t:"s",v:Qr(i[1])},c=a.match(t);return c&&(l.s=LK(c[1])),l}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(l){return l.v})}})(),UK=(function(){var t=/(\r\n|\n)/g;function r(s,a,i){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}})(),$K=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,WK=/<(?:\w+:)?r>/,zK=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function NS(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Qr(kn(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=kn(e),r&&(n.h=gS(n.t))):e.match(WK)&&(n.r=kn(e),n.t=Qr(kn((e.replace(zK,"").match($K)||[]).join("").replace(Xa,""))),r&&(n.h=UK(BK(n.r)))),n):{t:""}}var HK=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,GK=/<(?:\w+:)?(?:si|sstItem)>/g,VK=/<\/(?:\w+:)?(?:si|sstItem)>/;function KK(e,t){var r=[],n="";if(!e)return r;var s=e.match(HK);if(s){n=s[2].replace(GK,"").split(VK);for(var a=0;a!=n.length;++a){var i=NS(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=kr(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var qK=/^\s|\s$|[\t\n\r]/;function mF(e,t){if(!t.bookSST)return"";var r=[Es];r[r.length]=Wt("sst",null,{xmlns:bf[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(qK)&&(a+=' xml:space="preserve"'),a+=">"+yn(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function XK(e){return[e.read_shift(4),e.read_shift(4)]}function YK(e,t){var r=[],n=!1;return Mc(e,function(a,i,l){switch(l){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function JK(e,t){return t||(t=vt(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var QK=lG;function ZK(e){var t=Fi();kt(t,159,JK(e));for(var r=0;r<e.length;++r)kt(t,19,QK(e[r]));return kt(t,160),t.end()}function pF(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ec(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function eq(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ec(e,4),t.U=Ec(e,4),t.W=Ec(e,4),t}function tq(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function rq(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(tq(e));return t}function nq(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function sq(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ec(e,4),t.U=Ec(e,4),t.W=Ec(e,4),t}function aq(e){var t=sq(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function xF(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function yF(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function iq(e){var t=Ec(e);switch(t.Minor){case 2:return[t.Minor,oq(e)];case 3:return[t.Minor,lq()];case 4:return[t.Minor,cq(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function oq(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=xF(e,r),s=yF(e,e.length-e.l);return{t:"Std",h:n,v:s}}function lq(){throw new Error("File is password-protected: ECMA-376 Extensible")}function cq(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Xa,function(a){var i=kr(a);switch(Ul(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=i[l]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function uq(e,t){var r={},n=r.EncryptionVersionInfo=Ec(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=xF(e,s),t-=s,r.EncryptionVerifier=yF(e,t),r}function dq(e){var t={},r=t.EncryptionVersionInfo=Ec(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function AS(e){var t=0,r,n=pF(e),s=n.length+1,a,i,l,c,d;for(r=Wu(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],l=(t&16384)===0?0:1,c=t<<1&32767,d=l|c,t=d^i;return t^52811}var vF=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,l){return n(i^l)},a=function(i){for(var l=t[i.length-1],c=104,d=i.length-1;d>=0;--d)for(var f=i[d],p=0;p!=7;++p)f&64&&(l^=r[c]),f*=2,--c;return l};return function(i){for(var l=pF(i),c=a(l),d=l.length,f=Wu(16),p=0;p!=16;++p)f[p]=0;var g,y,v;for((d&1)===1&&(g=c>>8,f[d]=s(e[0],g),--d,g=c&255,y=l[l.length-1],f[d]=s(y,g));d>0;)--d,g=c>>8,f[d]=s(l[d],g),--d,g=c&255,f[d]=s(l[d],g);for(d=15,v=15-l.length;v>0;)g=c>>8,f[d]=s(e[v],g),--d,--v,g=c&255,f[d]=s(l[d],g),--d,--v;return f}})(),fq=function(e,t,r,n,s){s||(s=t),n||(n=vF(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},hq=function(e){var t=0,r=vF(e);return function(n){var s=fq("",n,t,r);return t=s[1],s[0]}};function gq(e,t,r,n){var s={key:Is(e),verificationBytes:Is(e)};return r.password&&(s.verifier=AS(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=hq(r.password)),s}function mq(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=dq(e):n.Data=uq(e,t),n}function pq(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?mq(e,t-2,n):gq(e,r.biff>=8?t:t-2,r,n),n}var wF=(function(){function e(s,a){switch(a.type){case"base64":return t(qi(s),a);case"binary":return t(s,a);case"buffer":return t(Ur&&Buffer.isBuffer(s)?s.toString("binary"):Zu(s),a);case"array":return t(gf(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},l=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,p){Array.isArray(l)&&(l[p]=[]);for(var g=/\\\w+\b/g,y=0,v,_=-1;v=g.exec(f);){switch(v[0]){case"\\cell":var b=f.slice(y,g.lastIndex-v[0].length);if(b[0]==" "&&(b=b.slice(1)),++_,b.length){var N={v:b,t:"s"};Array.isArray(l)?l[p][_]=N:l[br({r:p,c:_})]=N}break}y=g.lastIndex}_>d.e.c&&(d.e.c=_)}),l["!ref"]=Dr(d),l}function r(s,a){return ed(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=Zr(s["!ref"]),l,c=Array.isArray(s),d=i.s.r;d<=i.e.r;++d){a.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var p=br({r:d,c:f});l=c?(s[d]||[])[f]:s[p],!(!l||l.v==null&&(!l.f||l.F))&&(a.push(" "+(l.w||(Pc(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function xq(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function yp(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function yq(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var l=0,c=0,d=s+a;switch(c=i/(d>1?2-d:d),s){case t:l=((r-n)/i+6)%6;break;case r:l=(n-t)/i+2;break;case n:l=(t-r)/i+4;break}return[l/6,c,d/2]}function vq(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-l),i[0]+=c,i[1]+=s;break;case 2:c=s*(l-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-l),i[1]+=c,i[2]+=s;break;case 4:c=s*(l-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-l),i[2]+=c,i[0]+=s;break}for(var d=0;d!=3;++d)i[d]=Math.round(i[d]*255);return i}function k1(e,t){if(t===0)return e;var r=yq(xq(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),yp(vq(r))}var _F=6,wq=15,_q=1,$a=_F;function vp(e){return Math.floor((e+Math.round(128/$a)/256)*$a)}function wp(e){return Math.floor((e-5)/$a*100+.5)/100}function C1(e){return Math.round((e*$a+5)/$a*256)/256}function Gw(e){return C1(wp(vp(e)))}function jS(e){var t=Math.abs(e-Gw(e)),r=$a;if(t>.005)for($a=_q;$a<wq;++$a)Math.abs(e-Gw(e))<=t&&(t=Math.abs(e-Gw(e)),r=$a);$a=r}function zu(e){e.width?(e.wpx=vp(e.width),e.wch=wp(e.wpx),e.MDW=$a):e.wpx?(e.wch=wp(e.wpx),e.width=C1(e.wch),e.MDW=$a):typeof e.wch=="number"&&(e.width=C1(e.wch),e.wpx=vp(e.width),e.MDW=$a),e.customWidth&&delete e.customWidth}var bq=96,bF=bq;function _p(e){return e*96/bF}function p0(e){return e*bF/96}var Sq={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function kq(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Xa)||[]).forEach(function(i){var l=kr(i);switch(Ul(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=Ln(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=Ln(l.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}function Cq(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Xa)||[]).forEach(function(i){var l=kr(i);switch(Ul(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}function Tq(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Xa)||[]).forEach(function(i){var l=kr(i);switch(Ul(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=kn(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?Ln(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?Ln(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?Ln(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?Ln(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?Ln(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?Ln(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?Ln(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=sS[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=Ln(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=qd[s.color.index];s.color.index==81&&(c=qd[1]),c||(c=qd[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=k1(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}function Eq(e,t,r){t.NumberFmt=[];for(var n=gs(wr),s=0;s<n.length;++s)t.NumberFmt[n[s]]=wr[n[s]];var a=e[0].match(Xa);if(a)for(s=0;s<a.length;++s){var i=kr(a[s]);switch(Ul(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Qr(kn(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}Tc(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function Nq(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Wt("numFmt",null,{numFmtId:n,formatCode:yn(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Wt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Cy=["numFmtId","fillId","fontId","borderId","xfId"],Ty=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Aq(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Xa)||[]).forEach(function(a){var i=kr(a),l=0;switch(Ul(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],l=0;l<Cy.length;++l)n[Cy[l]]&&(n[Cy[l]]=parseInt(n[Cy[l]],10));for(l=0;l<Ty.length;++l)n[Ty[l]]&&(n[Ty[l]]=Ln(n[Ty[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=Ln(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function jq(e){var t=[];return t[t.length]=Wt("cellXfs",null),e.forEach(function(r){t[t.length]=Wt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Wt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Fq=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,d){var f={};if(!l)return f;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=l.match(t))&&Eq(p,f,d),(p=l.match(s))&&Tq(p,f,c,d),(p=l.match(n))&&Cq(p,f,c,d),(p=l.match(a))&&kq(p,f,c,d),(p=l.match(r))&&Aq(p,f,d),f}})();function SF(e,t){var r=[Es,Wt("styleSheet",null,{xmlns:bf[0],"xmlns:vt":Ks.vt})],n;return e.SSF&&(n=Nq(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=jq(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Pq(e,t){var r=e.read_shift(2),n=Va(e);return[r,n]}function Rq(e,t,r){r||(r=vt(6+4*t.length)),r.write_shift(2,e),ca(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Dq(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=mG(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=gG(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Va(e),n}function Iq(e,t){t||(t=vt(153)),t.write_shift(2,e.sz*20),pG(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),_1(e.color,t);var n=0;return n=2,t.write_shift(1,n),ca(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Mq=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Vw,Oq=qa;function a3(e,t){t||(t=vt(84)),Vw||(Vw=nv(Mq));var r=Vw[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(_1({auto:1},t),_1({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Lq(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function kF(e,t,r){r||(r=vt(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function bm(e,t){return t||(t=vt(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Bq=qa;function Uq(e,t){return t||(t=vt(51)),t.write_shift(1,0),bm(null,t),bm(null,t),bm(null,t),bm(null,t),bm(null,t),t.length>t.l?t.slice(0,t.l):t}function $q(e,t){return t||(t=vt(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),w1(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Wq(e,t,r){var n=vt(2052);return n.write_shift(4,e),w1(t,n),w1(r,n),n.length>n.l?n.slice(0,n.l):n}function zq(e,t,r){var n={};n.NumberFmt=[];for(var s in wr)n.NumberFmt[s]=wr[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return Mc(e,function(c,d,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],Tc(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=k1(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(f),i=!0;break;case 38:a.pop(),i=!1;break;default:if(d.T>0)a.push(f);else if(d.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function Hq(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(kt(e,615,Qo(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&kt(e,44,Rq(s,t[s]))}),kt(e,616))}}function Gq(e){var t=1;kt(e,611,Qo(t)),kt(e,43,Iq({sz:12,color:{theme:1},name:"Calibri",family:2})),kt(e,612)}function Vq(e){var t=2;kt(e,603,Qo(t)),kt(e,45,a3({patternType:"none"})),kt(e,45,a3({patternType:"gray125"})),kt(e,604)}function Kq(e){var t=1;kt(e,613,Qo(t)),kt(e,46,Uq()),kt(e,614)}function qq(e){var t=1;kt(e,626,Qo(t)),kt(e,47,kF({numFmtId:0},65535)),kt(e,627)}function Xq(e,t){kt(e,617,Qo(t.length)),t.forEach(function(r){kt(e,47,kF(r,0))}),kt(e,618)}function Yq(e){var t=1;kt(e,619,Qo(t)),kt(e,48,$q({xfId:0,name:"Normal"})),kt(e,620)}function Jq(e){var t=0;kt(e,505,Qo(t)),kt(e,506)}function Qq(e){var t=0;kt(e,508,Wq(t,"TableStyleMedium9","PivotStyleMedium4")),kt(e,509)}function Zq(e,t){var r=Fi();return kt(r,278),Hq(r,e.SSF),Gq(r),Vq(r),Kq(r),qq(r),Xq(r,t.cellXfs),Yq(r),Jq(r),Qq(r),kt(r,279),r.end()}var eX=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function tX(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Xa)||[]).forEach(function(s){var a=kr(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[eX.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function rX(){}function nX(){}var sX=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,aX=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,iX=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function oX(e,t,r){t.themeElements={};var n;[["clrScheme",sX,tX],["fontScheme",aX,rX],["fmtScheme",iX,nX]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var lX=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function CF(e,t){(!e||e.length===0)&&(e=FS());var r,n={};if(!(r=e.match(lX)))throw new Error("themeElements not found in theme");return oX(r[0],n,t),n.raw=e,n}function FS(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Es];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function cX(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=x8(a,{type:"array"})}catch{return}var l=Vi(i,"theme/theme/theme1.xml",!0);if(l)return CF(l,r)}}function uX(e){return e.read_shift(4)}function dX(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=fX(e,4);break;case 2:t.xclrValue=sF(e);break;case 3:t.xclrValue=uX(e);break;case 4:e.l+=4;break}return e.l+=8,t}function fX(e,t){return qa(e,t)}function hX(e,t){return qa(e,t)}function gX(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=dX(e);break;case 6:n[1]=hX(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function mX(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(gX(e,r-e.l));return{ixfe:n,ext:a}}function pX(e,t){t.forEach(function(r){r[0]})}function xX(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Va(e)}}function yX(e){var t=vt(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ca(e.name,t),t.slice(0,t.l)}function vX(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function wX(e){var t=vt(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function _X(e,t){var r=vt(8+2*t.length);return r.write_shift(4,e),ca(t,r),r.slice(0,r.l)}function bX(e){return e.l+=4,e.read_shift(4)!=0}function SX(e,t){var r=vt(8);return r.write_shift(4,e),r.write_shift(4,1),r}function kX(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,l=2;return Mc(e,function(c,d,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(p){l==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):l==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:a.push(f),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!d.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function CX(){var e=Fi();return kt(e,332),kt(e,334,Qo(1)),kt(e,335,yX({name:"XLDAPR",version:12e4,flags:3496657072})),kt(e,336),kt(e,339,_X(1,"XLDAPR")),kt(e,52),kt(e,35,Qo(514)),kt(e,4096,Qo(0)),kt(e,4097,yo(1)),kt(e,36),kt(e,53),kt(e,340),kt(e,337,SX(1)),kt(e,51,wX([[1,0]])),kt(e,338),kt(e,333),e.end()}function TX(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(Xa,function(l){var c=kr(l);switch(Ul(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==c.name&&(i=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function TF(){var e=[Es];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function EX(e){var t=[];if(!e)return t;var r=1;return(e.match(Xa)||[]).forEach(function(n){var s=kr(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function NX(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=br(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function AX(e,t,r){var n=[];return Mc(e,function(a,i,l){switch(l){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function jX(e,t,r,n){if(!e)return e;var s=n||{},a=!1;Mc(e,function(l,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function FX(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Kh=1024;function EF(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Wt("xml",null,{"xmlns:v":zi.v,"xmlns:o":zi.o,"xmlns:x":zi.x,"xmlns:mv":zi.mv}).replace(/\/>/,">"),Wt("o:shapelayout",Wt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Wt("v:shapetype",[Wt("v:stroke",null,{joinstyle:"miter"}),Wt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Kh<e*1e3;)Kh+=1e3;return t.forEach(function(a){var i=ts(a[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Wt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Wt("v:fill",c,l),f={on:"t",obscured:"t"};++Kh,s=s.concat(["<v:shape"+mp({id:"_x0000_s"+Kh,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Wt("v:shadow",null,f),Wt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ea("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Ea("x:AutoFill","False"),Ea("x:Row",String(i.r)),Ea("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function i3(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var l=ts(i.ref);if(s?(e[l.r]||(e[l.r]=[]),a=e[l.r][l.c]):a=e[i.ref],!a){a={t:"z"},s?e[l.r][l.c]=a:e[i.ref]=a;var c=Zr(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var d=Dr(c);d!==e["!ref"]&&(e["!ref"]=d)}a.c||(a.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var p=a.c.length-1;p>=0;--p){if(!r&&a.c[p].T)return;r&&!a.c[p].T&&a.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(f.a==n[p].id){f.a=n[p].name||f.a;break}}a.c.push(f)})}function PX(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var l=i.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=kr(l[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=ts(c.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var p=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&NS(p[1])||{r:"",t:"",h:""};d.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),d.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=g.h),n.push(d)}}}}),n}function NF(e){var t=[Es,Wt("comments",null,{xmlns:bf[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=yn(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(yn(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(Ea("t",yn(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,l=1;l<a.length;++l)i+=`Reply:
    `+a[l]+`
`;t.push(Ea("t",yn(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function RX(e,t){var r=[],n=!1,s={},a=0;return e.replace(Xa,function(l,c){var d=kr(l);switch(Ul(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+l.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function DX(e,t,r){var n=[Es,Wt("ThreadedComments",null,{xmlns:Ks.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,l){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(Wt("threadedComment",Ea("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function IX(e,t){var r=[],n=!1;return e.replace(Xa,function(a){var i=kr(a);switch(Ul(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function MX(e){var t=[Es,Wt("personList",null,{xmlns:Ks.TCMNT,"xmlns:x":bf[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Wt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function OX(e){var t={};t.iauthor=e.read_shift(4);var r=Tf(e);return t.rfx=r.s,t.ref=br(r.s),e.l+=16,t}function LX(e,t){return t==null&&(t=vt(36)),t.write_shift(4,e[1].iauthor),M0(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var BX=Va;function UX(e){return ca(e.slice(0,54))}function $X(e,t){var r=[],n=[],s={},a=!1;return Mc(e,function(l,c,d){switch(d){case 632:n.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function WX(e){var t=Fi(),r=[];return kt(t,628),kt(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),kt(t,632,UX(s.a)))})}),kt(t,631),kt(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:ts(n[0]),e:ts(n[0])};kt(t,635,LX([a,s])),s.t&&s.t.length>0&&kt(t,637,uG(s)),kt(t,636),delete s.iauthor})}),kt(t,634),kt(t,629),t.end()}var zX="application/vnd.ms-office.vbaProject";function HX(e){var t=gr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");gr.utils.cfb_add(t,s,e.FileIndex[n].content)}}),gr.write(t)}function GX(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&gr.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var AF=["xlsb","xlsm","xlam","biff8","xla"];function VX(){return{"!type":"dialog"}}function KX(){return{"!type":"dialog"}}function qX(){return{"!type":"macro"}}function XX(){return{"!type":"macro"}}var n0=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var l=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1));var d=a.length>0?parseInt(a,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return l?f+=t.c:--f,c?d+=t.r:--d,s+(l?"":"$")+es(f)+(c?"":"$")+Cs(d)}return function(s,a){return t=a,s.replace(e,r)}})(),PS=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,RS=(function(){return function(t,r){return t.replace(PS,function(n,s,a,i,l,c){var d=vS(i)-(a?0:r.c),f=yS(c)-(l?0:r.r),p=f==0?"":l?f+1:"["+f+"]",g=d==0?"":a?d+1:"["+d+"]";return s+"R"+p+"C"+g})}})();function jF(e,t){return e.replace(PS,function(r,n,s,a,i,l){return n+(s=="$"?s+a:es(vS(a)+t.c))+(i=="$"?i+l:Cs(yS(l)+t.r))})}function YX(e,t,r){var n=Pi(t),s=n.s,a=ts(r),i={r:a.r-s.r,c:a.c-s.c};return jF(e,i)}function JX(e){return e.length!=1}function o3(e){return e.replace(/_xlfn\./g,"")}function Rs(e){e.l+=1}function Hu(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function FF(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return PF(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=Hu(e),l=Hu(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function PF(e){var t=Hu(e),r=Hu(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function QX(e,t,r){if(r.biff<8)return PF(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Hu(e),i=Hu(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function RF(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return ZX(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Hu(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function ZX(e){var t=Hu(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function eY(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function tY(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return rY(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:l}}function rY(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function nY(e,t,r){var n=(e[e.l++]&96)>>5,s=FF(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function sY(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=FF(e,a,r);return[n,s,i]}function aY(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function iY(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function oY(e,t,r){var n=(e[e.l++]&96)>>5,s=QX(e,t-1,r);return[n,s]}function lY(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function l3(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function cY(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function uY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function dY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function fY(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function hY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function DF(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function gY(e){return e.read_shift(2),DF(e)}function mY(e){return e.read_shift(2),DF(e)}function pY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=RF(e,0,r);return[n,s]}function xY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=tY(e,0,r);return[n,s]}function yY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=RF(e,0,r);return[n,s,a]}function vY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[bJ[s],OF[s],n]}function wY(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:_Y(e);return[s,(a[0]===0?OF:_J)[a[1]]]}function _Y(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function bY(e,t,r){e.l+=r&&r.biff==2?3:4}function SY(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function kY(e){return e.l++,Oc[e.read_shift(1)]}function CY(e){return e.l++,e.read_shift(2)}function TY(e){return e.l++,e.read_shift(1)!==0}function EY(e){return e.l++,Wa(e)}function NY(e,t,r){return e.l++,Yp(e,t-1,r)}function AY(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ss(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Oc[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Wa(e);break;case 2:r[1]=Ef(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function jY(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?Tf:iv)(e));return s}function FY(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var l=0;l!=s;++l)i[a][l]=AY(e,r.biff);return i}function PY(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function RY(e,t,r){if(r.biff==5)return DY(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function DY(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function IY(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function MY(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function OY(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function LY(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var BY=qa,UY=qa,$Y=qa;function Qp(e,t,r){return e.l+=2,[eY(e)]}function DS(e){return e.l+=6,[]}var WY=Qp,zY=DS,HY=DS,GY=Qp;function IF(e){return e.l+=2,[Is(e),e.read_shift(2)&1]}var VY=Qp,KY=IF,qY=DS,XY=Qp,YY=Qp,JY=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function QY(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=JY[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function ZY(e){return e.l+=2,[e.read_shift(4)]}function eJ(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function tJ(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function rJ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function nJ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function sJ(e){return e.l+=4,[0,0]}var c3={1:{n:"PtgExp",f:SY},2:{n:"PtgTbl",f:$Y},3:{n:"PtgAdd",f:Rs},4:{n:"PtgSub",f:Rs},5:{n:"PtgMul",f:Rs},6:{n:"PtgDiv",f:Rs},7:{n:"PtgPower",f:Rs},8:{n:"PtgConcat",f:Rs},9:{n:"PtgLt",f:Rs},10:{n:"PtgLe",f:Rs},11:{n:"PtgEq",f:Rs},12:{n:"PtgGe",f:Rs},13:{n:"PtgGt",f:Rs},14:{n:"PtgNe",f:Rs},15:{n:"PtgIsect",f:Rs},16:{n:"PtgUnion",f:Rs},17:{n:"PtgRange",f:Rs},18:{n:"PtgUplus",f:Rs},19:{n:"PtgUminus",f:Rs},20:{n:"PtgPercent",f:Rs},21:{n:"PtgParen",f:Rs},22:{n:"PtgMissArg",f:Rs},23:{n:"PtgStr",f:NY},26:{n:"PtgSheet",f:eJ},27:{n:"PtgEndSheet",f:tJ},28:{n:"PtgErr",f:kY},29:{n:"PtgBool",f:TY},30:{n:"PtgInt",f:CY},31:{n:"PtgNum",f:EY},32:{n:"PtgArray",f:lY},33:{n:"PtgFunc",f:vY},34:{n:"PtgFuncVar",f:wY},35:{n:"PtgName",f:PY},36:{n:"PtgRef",f:pY},37:{n:"PtgArea",f:nY},38:{n:"PtgMemArea",f:IY},39:{n:"PtgMemErr",f:BY},40:{n:"PtgMemNoMem",f:UY},41:{n:"PtgMemFunc",f:MY},42:{n:"PtgRefErr",f:OY},43:{n:"PtgAreaErr",f:aY},44:{n:"PtgRefN",f:xY},45:{n:"PtgAreaN",f:oY},46:{n:"PtgMemAreaN",f:rJ},47:{n:"PtgMemNoMemN",f:nJ},57:{n:"PtgNameX",f:RY},58:{n:"PtgRef3d",f:yY},59:{n:"PtgArea3d",f:sY},60:{n:"PtgRefErr3d",f:LY},61:{n:"PtgAreaErr3d",f:iY},255:{}},aJ={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},iJ={1:{n:"PtgElfLel",f:IF},2:{n:"PtgElfRw",f:XY},3:{n:"PtgElfCol",f:WY},6:{n:"PtgElfRwV",f:YY},7:{n:"PtgElfColV",f:GY},10:{n:"PtgElfRadical",f:VY},11:{n:"PtgElfRadicalS",f:qY},13:{n:"PtgElfColS",f:zY},15:{n:"PtgElfColSV",f:HY},16:{n:"PtgElfRadicalLel",f:KY},25:{n:"PtgList",f:QY},29:{n:"PtgSxName",f:ZY},255:{}},oJ={0:{n:"PtgAttrNoop",f:sJ},1:{n:"PtgAttrSemi",f:hY},2:{n:"PtgAttrIf",f:dY},4:{n:"PtgAttrChoose",f:cY},8:{n:"PtgAttrGoto",f:uY},16:{n:"PtgAttrSum",f:bY},32:{n:"PtgAttrBaxcel",f:l3},33:{n:"PtgAttrBaxcel",f:l3},64:{n:"PtgAttrSpace",f:gY},65:{n:"PtgAttrSpaceSemi",f:mY},128:{n:"PtgAttrIfError",f:fY},255:{}};function Zp(e,t,r,n){if(n.biff<8)return qa(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=FY(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=jY(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(qa(e,t)),a}function ex(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=c3[a]||c3[aJ[a]],(a===24||a===25)&&(s=(a===24?iJ:oJ)[e[e.l+1]]),!s||!s.f?qa(e,t):i.push([s.n,s.f(e,t,r)]);return i}function lJ(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var cJ={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function uJ(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function MF(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function u3(e,t,r){var n=MF(e,t,r);return n=="#REF"?n:uJ(n,r)}function Ua(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},l=[],c,d,f,p=0,g=0,y,v="";if(!e[0]||!e[0][0])return"";for(var _=-1,b="",N=0,k=e[0].length;N<k;++N){var w=e[0][N];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),_>=0){switch(e[0][_][1][0]){case 0:b=fs(" ",e[0][_][1][1]);break;case 1:b=fs("\r",e[0][_][1][1]);break;default:if(b="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}d=d+b,_=-1}l.push(d+cJ[w[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Um(w[1][1],i,s),l.push($m(f,a));break;case"PtgRefN":f=r?Um(w[1][1],r,s):w[1][1],l.push($m(f,a));break;case"PtgRef3d":p=w[1][1],f=Um(w[1][2],i,s),v=u3(n,p,s),l.push(v+"!"+$m(f,a));break;case"PtgFunc":case"PtgFuncVar":var T=w[1][0],A=w[1][1];T||(T=0),T&=127;var F=T==0?[]:l.slice(-T);l.length-=T,A==="User"&&(A=F.shift()),l.push(A+"("+F.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":y=BN(w[1][1],r?{s:r}:i,s),l.push(Ww(y,s));break;case"PtgArea":y=BN(w[1][1],i,s),l.push(Ww(y,s));break;case"PtgArea3d":p=w[1][1],y=w[1][2],v=u3(n,p,s),l.push(v+"!"+Ww(y,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=w[1][2];var R=(n.names||[])[g-1]||(n[0]||[])[g],E=R?R.Name:"SH33TJSNAME"+String(g);E&&E.slice(0,6)=="_xlfn."&&!s.xlfn&&(E=E.slice(6)),l.push(E);break;case"PtgNameX":var D=w[1][1];g=w[1][2];var I;if(s.biff<=5)D<0&&(D=-D),n[D]&&(I=n[D][g]);else{var G="";if(((n[D]||[])[0]||[])[0]==14849||(((n[D]||[])[0]||[])[0]==1025?n[D][g]&&n[D][g].itab>0&&(G=n.SheetNames[n[D][g].itab-1]+"!"):G=n.SheetNames[g-1]+"!"),n[D]&&n[D][g])G+=n[D][g].Name;else if(n[0]&&n[0][g])G+=n[0][g].Name;else{var Y=(MF(n,D,s)||"").split(";;");Y[g-1]?G=Y[g-1]:G+="SH33TJSERRX"}l.push(G);break}I||(I={Name:"SH33TJSERRY"}),l.push(I.Name);break;case"PtgParen":var ee="(",ie=")";if(_>=0){switch(b="",e[0][_][1][0]){case 2:ee=fs(" ",e[0][_][1][1])+ee;break;case 3:ee=fs("\r",e[0][_][1][1])+ee;break;case 4:ie=fs(" ",e[0][_][1][1])+ie;break;case 5:ie=fs("\r",e[0][_][1][1])+ie;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}_=-1}l.push(ee+l.pop()+ie);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":f={c:w[1][1],r:w[1][0]};var re={c:r.c,r:r.r};if(n.sharedf[br(f)]){var se=n.sharedf[br(f)];l.push(Ua(se,i,re,n,s))}else{var B=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(f.c<d[0].s.c||f.c>d[0].e.c)&&!(f.r<d[0].s.r||f.r>d[0].e.r)){l.push(Ua(d[1],i,re,n,s)),B=!0;break}B||l.push(w[1])}break;case"PtgArray":l.push("{"+lJ(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=N;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&_>=0&&z.indexOf(e[0][N][0])==-1){w=e[0][_];var U=!0;switch(w[1][0]){case 4:U=!1;case 0:b=fs(" ",w[1][1]);break;case 5:U=!1;case 1:b=fs("\r",w[1][1]);break;default:if(b="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((U?b:"")+l.pop()+(U?"":b)),_=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function dJ(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],qa(e,t-2)];var l=ex(e,i,r);return t!==i+s&&(a=Zp(e,t-i-s,l,r)),e.l=n,[l,a]}function fJ(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],qa(e,t-2)];var l=ex(e,i,r);return t!==i+s&&(a=Zp(e,t-i-s,l,r)),e.l=n,[l,a]}function hJ(e,t,r,n){var s=e.l+t,a=ex(e,n,r),i;return s!==e.l&&(i=Zp(e,s-e.l,a,r)),[a,i]}function gJ(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=ex(e,a,r);return a==65535?[[],qa(e,t-2)]:(t!==a+2&&(s=Zp(e,n-a-2,i,r)),[i,s])}function mJ(e){var t;if(Sc(e,e.l+6)!==65535)return[Wa(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function pJ(e){if(e==null){var t=vt(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return mf(e);return mf(0)}function Kw(e,t,r){var n=e.l+t,s=$l(e);r.biff==2&&++e.l;var a=mJ(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=fJ(e,n-e.l,r);return{cell:s,val:a[0],formula:l,shared:i>>3&1,tt:a[1]}}function xJ(e,t,r,n,s){var a=xf(t,r,s),i=pJ(e.v),l=vt(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=vt(e.bf.length),f=0;f<e.bf.length;++f)d[f]=e.bf[f];var p=oa([a,i,l,d]);return p}function ov(e,t,r){var n=e.read_shift(4),s=ex(e,n,r),a=e.read_shift(4),i=a>0?Zp(e,a,s,r):null;return[s,i]}var yJ=ov,lv=ov,vJ=ov,wJ=ov,_J={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},OF={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},bJ={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function d3(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function SJ(e){var t="of:="+e.replace(PS,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function qw(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function kJ(e){return e.replace(/\./,"!")}var zm={},s0={},Hm=typeof Map<"u";function IS(e,t,r){var n=0,s=e.length;if(r){if(Hm?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Hm?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Hm?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function cv(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&($a=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=wp(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=C1(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Jd(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function td(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Tc(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function LF(e,t,r,n,s,a){try{n.cellNF&&(e.z=wr[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Wn(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(wr[t]==null&&Tc(_H[t]||"General",t),e.t==="e")e.w=e.w||Oc[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=hp(e.v);else if(e.t==="d"){var i=Xs(e.v);(i|0)===i?e.w=i.toString(10):e.w=hp(i)}else{if(e.v===void 0)return"";e.w=hf(e.v,s0)}else e.t==="d"?e.w=Co(t,Xs(e.v),s0):e.w=Co(t,e.v,s0)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=k1(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=k1(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&a.Fills)throw l}}}function CJ(e,t,r){if(e&&e["!ref"]){var n=Zr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function TJ(e,t){var r=Zr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Dr(r))}var EJ=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,NJ=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,AJ=/<(?:\w:)?hyperlink [^>]*>/mg,jJ=/"(\w*:\w*)"/,FJ=/<(?:\w:)?col\b[^>]*[\/]?>/g,PJ=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,RJ=/<(?:\w:)?pageMargins[^>]*\/>/g,BF=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,DJ=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,IJ=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function MJ(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",f="",p=e.match(NJ);p?(d=e.slice(0,p.index),f=e.slice(p.index+p[0].length)):d=f=e;var g=d.match(BF);g?MS(g[0],l,s,r):(g=d.match(DJ))&&LJ(g[0],g[1]||"",l,s,r);var y=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var v=d.slice(y,y+50).match(jJ);v&&TJ(l,v[1])}var _=d.match(IJ);_&&_[1]&&JJ(_[1],s);var b=[];if(t.cellStyles){var N=d.match(FJ);N&&VJ(b,N)}p&&eQ(p[1],l,t,c,a,i);var k=f.match(PJ);k&&(l["!autofilter"]=qJ(k[0]));var w=[],T=f.match(EJ);if(T)for(y=0;y!=T.length;++y)w[y]=Zr(T[y].slice(T[y].indexOf('"')+1));var A=f.match(AJ);A&&zJ(l,A,n);var F=f.match(RJ);if(F&&(l["!margins"]=HJ(kr(F[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Dr(c)),t.sheetRows>0&&l["!ref"]){var R=Zr(l["!ref"]);t.sheetRows<=+R.e.r&&(R.e.r=t.sheetRows-1,R.e.r>c.e.r&&(R.e.r=c.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>c.e.c&&(R.e.c=c.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Dr(R))}return b.length>0&&(l["!cols"]=b),w.length>0&&(l["!merges"]=w),l}function OJ(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Dr(e[r])+'"/>';return t+"</mergeCells>"}function MS(e,t,r,n){var s=kr(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Qr(kn(s.codeName)))}function LJ(e,t,r,n,s){MS(e.slice(0,e.indexOf(">")),r,n,s)}function BJ(e,t,r,n,s){var a=!1,i={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=Pl(yn(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),l=(l||"")+Wt("outlinePr",null,d)}!a&&!l||(s[s.length]=Wt("sheetPr",l,i))}var UJ=["objects","scenarios","selectLockedCells","selectUnlockedCells"],$J=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function WJ(e){var t={sheet:1};return UJ.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),$J.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=AS(e.password).toString(16).toUpperCase()),Wt("sheetProtection",null,t)}function zJ(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=kr(kn(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+Qr(a.location))):(a.Target="#"+Qr(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=Zr(a.ref),c=l.s.r;c<=l.e.r;++c)for(var d=l.s.c;d<=l.e.c;++d){var f=br({c:d,r:c});n?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=a):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=a)}}}function HJ(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function GJ(e){return Jd(e),Wt("pageMargins",null,e)}function VJ(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=kr(t[n],!0);s.hidden&&(s.hidden=Ln(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,jS(s.width)),zu(s);a<=i;)e[a++]=zn(s)}}function KJ(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Wt("col",null,cv(s,n)));return r[r.length]="</cols>",r.join("")}function qJ(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function XJ(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Dr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Pi(s);i.s.r==i.e.r&&(i.e.r=Pi(t["!ref"]).e.r,s=Dr(i));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Wt("autoFilter",null,{ref:s})}var YJ=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function JJ(e,t){t.Views||(t.Views=[{}]),(e.match(YJ)||[]).forEach(function(r,n){var s=kr(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Ln(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function QJ(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Wt("sheetViews",Wt("sheetView",null,s),{})}function ZJ(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Oc[e.v];break;case"d":n&&n.cellDates?s=Wn(e.v,-1).toISOString():(e=zn(e),e.t="n",s=""+(e.v=Xs(Wn(e.v)))),typeof e.z>"u"&&(e.z=wr[14]);break;default:s=e.v;break}var l=Ea("v",yn(s)),c={r:t},d=td(n.cellXfs,e,n);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=Ea("v",""+IS(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Wt("f",yn(e.f),f)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Wt("c",l,c)}var eQ=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=gp("v"),i=gp("f");return function(c,d,f,p,g,y){for(var v=0,_="",b=[],N=[],k=0,w=0,T=0,A="",F,R,E=0,D=0,I,G,Y=0,ee=0,ie=Array.isArray(y.CellXf),re,se=[],B=[],z=Array.isArray(d),U=[],V={},q=!1,L=!!f.sheetStubs,M=c.split(t),X=0,K=M.length;X!=K;++X){_=M[X].trim();var Z=_.length;if(Z!==0){var J=0;e:for(v=0;v<Z;++v)switch(_[v]){case">":if(_[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(R=kr(_.slice(J,v),!0),E=R.r!=null?parseInt(R.r,10):E+1,D=-1,f.sheetRows&&f.sheetRows<E)continue;V={},q=!1,R.ht&&(q=!0,V.hpt=parseFloat(R.ht),V.hpx=p0(V.hpt)),R.hidden=="1"&&(q=!0,V.hidden=!0),R.outlineLevel!=null&&(q=!0,V.level=+R.outlineLevel),q&&(U[E-1]=V)}break;case"<":J=v;break}if(J>=v)break;if(R=kr(_.slice(J,v),!0),E=R.r!=null?parseInt(R.r,10):E+1,D=-1,!(f.sheetRows&&f.sheetRows<E)){p.s.r>E-1&&(p.s.r=E-1),p.e.r<E-1&&(p.e.r=E-1),f&&f.cellStyles&&(V={},q=!1,R.ht&&(q=!0,V.hpt=parseFloat(R.ht),V.hpx=p0(V.hpt)),R.hidden=="1"&&(q=!0,V.hidden=!0),R.outlineLevel!=null&&(q=!0,V.level=+R.outlineLevel),q&&(U[E-1]=V)),b=_.slice(v).split(e);for(var ne=0;ne!=b.length&&b[ne].trim().charAt(0)=="<";++ne);for(b=b.slice(ne),v=0;v!=b.length;++v)if(_=b[v].trim(),_.length!==0){if(N=_.match(r),k=v,w=0,T=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,N!=null&&N.length===2){for(k=0,A=N[1],w=0;w!=A.length&&!((T=A.charCodeAt(w)-64)<1||T>26);++w)k=26*k+T;--k,D=k}else++D;for(w=0;w!=_.length&&_.charCodeAt(w)!==62;++w);if(++w,R=kr(_.slice(0,w),!0),R.r||(R.r=br({r:E-1,c:D})),A=_.slice(w),F={t:""},(N=A.match(a))!=null&&N[1]!==""&&(F.v=Qr(N[1])),f.cellFormula){if((N=A.match(i))!=null&&N[1]!==""){if(F.f=Qr(kn(N[1])).replace(/\r\n/g,`
`),f.xlfn||(F.f=o3(F.f)),N[0].indexOf('t="array"')>-1)F.F=(A.match(s)||[])[1],F.F.indexOf(":")>-1&&se.push([Zr(F.F),F.F]);else if(N[0].indexOf('t="shared"')>-1){G=kr(N[0]);var me=Qr(kn(N[1]));f.xlfn||(me=o3(me)),B[parseInt(G.si,10)]=[G,me,R.r]}}else(N=A.match(/<f[^>]*\/>/))&&(G=kr(N[0]),B[G.si]&&(F.f=YX(B[G.si][1],B[G.si][2],R.r)));var xe=ts(R.r);for(w=0;w<se.length;++w)xe.r>=se[w][0].s.r&&xe.r<=se[w][0].e.r&&xe.c>=se[w][0].s.c&&xe.c<=se[w][0].e.c&&(F.F=se[w][1])}if(R.t==null&&F.v===void 0)if(F.f||F.F)F.v=0,F.t="n";else if(L)F.t="z";else continue;else F.t=R.t||"n";switch(p.s.c>D&&(p.s.c=D),p.e.c<D&&(p.e.c=D),F.t){case"n":if(F.v==""||F.v==null){if(!L)continue;F.t="z"}else F.v=parseFloat(F.v);break;case"s":if(typeof F.v>"u"){if(!L)continue;F.t="z"}else I=zm[parseInt(F.v,10)],F.v=I.t,F.r=I.r,f.cellHTML&&(F.h=I.h);break;case"str":F.t="s",F.v=F.v!=null?kn(F.v):"",f.cellHTML&&(F.h=gS(F.v));break;case"inlineStr":N=A.match(n),F.t="s",N!=null&&(I=NS(N[1]))?(F.v=I.t,f.cellHTML&&(F.h=I.h)):F.v="";break;case"b":F.v=Ln(F.v);break;case"d":f.cellDates?F.v=Wn(F.v,1):(F.v=Xs(Wn(F.v,1)),F.t="n");break;case"e":(!f||f.cellText!==!1)&&(F.w=F.v),F.v=$8[F.v];break}if(Y=ee=0,re=null,ie&&R.s!==void 0&&(re=y.CellXf[R.s],re!=null&&(re.numFmtId!=null&&(Y=re.numFmtId),f.cellStyles&&re.fillId!=null&&(ee=re.fillId))),LF(F,Y,ee,f,g,y),f.cellDates&&ie&&F.t=="n"&&R0(wr[Y])&&(F.t="d",F.v=av(F.v)),R.cm&&f.xlmeta){var Ne=(f.xlmeta.Cell||[])[+R.cm-1];Ne&&Ne.type=="XLDAPR"&&(F.D=!0)}if(z){var le=ts(R.r);d[le.r]||(d[le.r]=[]),d[le.r][le.c]=F}else d[R.r]=F}}}}U.length>0&&(d["!rows"]=U)}})();function tQ(e,t,r,n){var s=[],a=[],i=Zr(e["!ref"]),l="",c,d="",f=[],p=0,g=0,y=e["!rows"],v=Array.isArray(e),_={r:d},b,N=-1;for(g=i.s.c;g<=i.e.c;++g)f[g]=es(g);for(p=i.s.r;p<=i.e.r;++p){for(a=[],d=Cs(p),g=i.s.c;g<=i.e.c;++g){c=f[g]+d;var k=v?(e[p]||[])[g]:e[c];k!==void 0&&(l=ZJ(k,c,e,t))!=null&&a.push(l)}(a.length>0||y&&y[p])&&(_={r:d},y&&y[p]&&(b=y[p],b.hidden&&(_.hidden=1),N=-1,b.hpx?N=_p(b.hpx):b.hpt&&(N=b.hpt),N>-1&&(_.ht=N,_.customHeight=1),b.level&&(_.outlineLevel=b.level)),s[s.length]=Wt("row",a.join(""),_))}if(y)for(;p<y.length;++p)y&&y[p]&&(_={r:p+1},b=y[p],b.hidden&&(_.hidden=1),N=-1,b.hpx?N=_p(b.hpx):b.hpt&&(N=b.hpt),N>-1&&(_.ht=N,_.customHeight=1),b.level&&(_.outlineLevel=b.level),s[s.length]=Wt("row","",_));return s.join("")}function UF(e,t,r,n){var s=[Es,Wt("worksheet",null,{xmlns:bf[0],"xmlns:r":Ks.r})],a=r.SheetNames[e],i=0,l="",c=r.Sheets[a];c==null&&(c={});var d=c["!ref"]||"A1",f=Zr(d);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),d=Dr(f)}n||(n={}),c["!comments"]=[];var p=[];BJ(c,r,e,t,s),s[s.length]=Wt("dimension",null,{ref:d}),s[s.length]=QJ(c,t,e,r),t.sheetFormat&&(s[s.length]=Wt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=KJ(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=tQ(c,t),l.length>0&&(s[s.length]=l)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=WJ(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=XJ(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=OJ(c["!merges"]));var g=-1,y,v=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(_){_[1].Target&&(y={ref:_[0]},_[1].Target.charAt(0)!="#"&&(v=xn(n,-1,yn(_[1].Target).replace(/#.*$/,""),Gr.HLINK),y["r:id"]="rId"+v),(g=_[1].Target.indexOf("#"))>-1&&(y.location=yn(_[1].Target.slice(g+1))),_[1].Tooltip&&(y.tooltip=yn(_[1].Tooltip)),s[s.length]=Wt("hyperlink",null,y))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=GJ(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Ea("ignoredErrors",Wt("ignoredError",null,{numberStoredAsText:1,sqref:d}))),p.length>0&&(v=xn(n,-1,"../drawings/drawing"+(e+1)+".xml",Gr.DRAW),s[s.length]=Wt("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=p),c["!comments"].length>0&&(v=xn(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Gr.VML),s[s.length]=Wt("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function rQ(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function nQ(e,t,r){var n=vt(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=_p(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var d={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var p=-1,g=-1,y=f<<10;y<f+1<<10;++y){d.c=y;var v=Array.isArray(r)?(r[d.r]||[])[d.c]:r[br(d)];v&&(p<0&&(p=y),g=y)}p<0||(++l,n.write_shift(4,p),n.write_shift(4,g))}var _=n.l;return n.l=c,n.write_shift(4,l),n.l=_,n.length>n.l?n.slice(0,n.l):n}function sQ(e,t,r,n){var s=nQ(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&kt(e,0,s)}var aQ=Tf,iQ=M0;function oQ(){}function lQ(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=dG(e),r}function cQ(e,t,r){r==null&&(r=vt(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return _1({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),M8(e,r),r.slice(0,r.l)}function uQ(e){var t=To(e);return[t]}function dQ(e,t,r){return r==null&&(r=vt(8)),Sf(t,r)}function fQ(e){var t=kf(e);return[t]}function hQ(e,t,r){return r==null&&(r=vt(4)),Cf(t,r)}function gQ(e){var t=To(e),r=e.read_shift(1);return[t,r,"b"]}function mQ(e,t,r){return r==null&&(r=vt(9)),Sf(t,r),r.write_shift(1,e.v?1:0),r}function pQ(e){var t=kf(e),r=e.read_shift(1);return[t,r,"b"]}function xQ(e,t,r){return r==null&&(r=vt(5)),Cf(t,r),r.write_shift(1,e.v?1:0),r}function yQ(e){var t=To(e),r=e.read_shift(1);return[t,r,"e"]}function vQ(e,t,r){return r==null&&(r=vt(9)),Sf(t,r),r.write_shift(1,e.v),r}function wQ(e){var t=kf(e),r=e.read_shift(1);return[t,r,"e"]}function _Q(e,t,r){return r==null&&(r=vt(8)),Cf(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function bQ(e){var t=To(e),r=e.read_shift(4);return[t,r,"s"]}function SQ(e,t,r){return r==null&&(r=vt(12)),Sf(t,r),r.write_shift(4,t.v),r}function kQ(e){var t=kf(e),r=e.read_shift(4);return[t,r,"s"]}function CQ(e,t,r){return r==null&&(r=vt(8)),Cf(t,r),r.write_shift(4,t.v),r}function TQ(e){var t=To(e),r=Wa(e);return[t,r,"n"]}function EQ(e,t,r){return r==null&&(r=vt(16)),Sf(t,r),mf(e.v,r),r}function $F(e){var t=kf(e),r=Wa(e);return[t,r,"n"]}function NQ(e,t,r){return r==null&&(r=vt(12)),Cf(t,r),mf(e.v,r),r}function AQ(e){var t=To(e),r=SS(e);return[t,r,"n"]}function jQ(e,t,r){return r==null&&(r=vt(12)),Sf(t,r),O8(e.v,r),r}function FQ(e){var t=kf(e),r=SS(e);return[t,r,"n"]}function PQ(e,t,r){return r==null&&(r=vt(8)),Cf(t,r),O8(e.v,r),r}function RQ(e){var t=To(e),r=wS(e);return[t,r,"is"]}function DQ(e){var t=To(e),r=Va(e);return[t,r,"str"]}function IQ(e,t,r){return r==null&&(r=vt(12+4*e.v.length)),Sf(t,r),ca(e.v,r),r.length>r.l?r.slice(0,r.l):r}function MQ(e){var t=kf(e),r=Va(e);return[t,r,"str"]}function OQ(e,t,r){return r==null&&(r=vt(8+4*e.v.length)),Cf(t,r),ca(e.v,r),r.length>r.l?r.slice(0,r.l):r}function LQ(e,t,r){var n=e.l+t,s=To(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var l=lv(e,n-e.l,r);i[3]=Ua(l,null,s,r.supbooks,r)}else e.l=n;return i}function BQ(e,t,r){var n=e.l+t,s=To(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var l=lv(e,n-e.l,r);i[3]=Ua(l,null,s,r.supbooks,r)}else e.l=n;return i}function UQ(e,t,r){var n=e.l+t,s=To(e);s.r=r["!row"];var a=Wa(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var l=lv(e,n-e.l,r);i[3]=Ua(l,null,s,r.supbooks,r)}else e.l=n;return i}function $Q(e,t,r){var n=e.l+t,s=To(e);s.r=r["!row"];var a=Va(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var l=lv(e,n-e.l,r);i[3]=Ua(l,null,s,r.supbooks,r)}else e.l=n;return i}var WQ=Tf,zQ=M0;function HQ(e,t){return t==null&&(t=vt(4)),t.write_shift(4,e),t}function GQ(e,t){var r=e.l+t,n=Tf(e),s=_S(e),a=Va(e),i=Va(e),l=Va(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:l};return i&&(c.Tooltip=i),c}function VQ(e,t){var r=vt(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));M0({s:ts(e[0]),e:ts(e[0])},r),bS("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return ca(s||"",r),ca(e[1].Tooltip||"",r),ca("",r),r.slice(0,r.l)}function KQ(){}function qQ(e,t,r){var n=e.l+t,s=L8(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var l=yJ(e,n-e.l,r);i[1]=l}else e.l=n;return i}function XQ(e,t,r){var n=e.l+t,s=Tf(e),a=[s];if(r.cellFormula){var i=wJ(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function YQ(e,t,r){r==null&&(r=vt(18));var n=cv(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var WF=["left","right","top","bottom","header","footer"];function JQ(e){var t={};return WF.forEach(function(r){t[r]=Wa(e)}),t}function QQ(e,t){return t==null&&(t=vt(48)),Jd(e),WF.forEach(function(r){mf(e[r],t)}),t}function ZQ(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function eZ(e,t,r){r==null&&(r=vt(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function tZ(e){var t=vt(24);return t.write_shift(4,4),t.write_shift(4,1),M0(e,t),t}function rZ(e,t){return t==null&&(t=vt(66)),t.write_shift(2,e.password?AS(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function nZ(){}function sZ(){}function aZ(e,t,r,n,s,a,i){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},d,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,g=!1,y,v,_,b,N,k,w,T,A,F=[];l.biff=12,l["!row"]=0;var R=0,E=!1,D=[],I={},G=l.supbooks||s.supbooks||[[]];if(G.sharedf=I,G.arrayf=D,G.SheetNames=s.SheetNames||s.Sheets.map(function(z){return z.name}),!l.supbooks&&(l.supbooks=G,s.Names))for(var Y=0;Y<s.Names.length;++Y)G[0][Y+1]=s.Names[Y];var ee=[],ie=[],re=!1;bp[16]={n:"BrtShortReal",f:$F};var se;if(Mc(e,function(U,V,q){if(!g)switch(q){case 148:d=U;break;case 0:y=U,l.sheetRows&&l.sheetRows<=y.r&&(g=!0),T=Cs(b=y.r),l["!row"]=y.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=p0(U.hpt)),ie[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:U[2]},U[2]){case"n":v.v=U[1];break;case"s":w=zm[U[1]],v.v=w.t,v.r=w.r;break;case"b":v.v=!!U[1];break;case"e":v.v=U[1],l.cellText!==!1&&(v.w=Oc[v.v]);break;case"str":v.t="s",v.v=U[1];break;case"is":v.t="s",v.v=U[1].t;break}if((_=i.CellXf[U[0].iStyleRef])&&LF(v,_.numFmtId,null,l,a,i),N=U[0].c==-1?N+1:U[0].c,l.dense?(c[b]||(c[b]=[]),c[b][N]=v):c[es(N)+T]=v,l.cellFormula){for(E=!1,R=0;R<D.length;++R){var L=D[R];y.r>=L[0].s.r&&y.r<=L[0].e.r&&N>=L[0].s.c&&N<=L[0].e.c&&(v.F=Dr(L[0]),E=!0)}!E&&U.length>3&&(v.f=U[3])}if(f.s.r>y.r&&(f.s.r=y.r),f.s.c>N&&(f.s.c=N),f.e.r<y.r&&(f.e.r=y.r),f.e.c<N&&(f.e.c=N),l.cellDates&&_&&v.t=="n"&&R0(wr[_.numFmtId])){var M=$d(v.v);M&&(v.t="d",v.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}se&&(se.type=="XLDAPR"&&(v.D=!0),se=void 0);break;case 1:case 12:if(!l.sheetStubs||p)break;v={t:"z",v:void 0},N=U[0].c==-1?N+1:U[0].c,l.dense?(c[b]||(c[b]=[]),c[b][N]=v):c[es(N)+T]=v,f.s.r>y.r&&(f.s.r=y.r),f.s.c>N&&(f.s.c=N),f.e.r<y.r&&(f.e.r=y.r),f.e.c<N&&(f.e.c=N),se&&(se.type=="XLDAPR"&&(v.D=!0),se=void 0);break;case 176:F.push(U);break;case 49:se=((l.xlmeta||{}).Cell||[])[U-1];break;case 494:var X=n["!id"][U.relId];for(X?(U.Target=X.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=X):U.relId==""&&(U.Target="#"+U.loc),b=U.rfx.s.r;b<=U.rfx.e.r;++b)for(N=U.rfx.s.c;N<=U.rfx.e.c;++N)l.dense?(c[b]||(c[b]=[]),c[b][N]||(c[b][N]={t:"z",v:void 0}),c[b][N].l=U):(k=br({c:N,r:b}),c[k]||(c[k]={t:"z",v:void 0}),c[k].l=U);break;case 426:if(!l.cellFormula)break;D.push(U),A=l.dense?c[b][N]:c[es(N)+T],A.f=Ua(U[1],f,{r:y.r,c:N},G,l),A.F=Dr(U[0]);break;case 427:if(!l.cellFormula)break;I[br(U[0].s)]=U[1],A=l.dense?c[b][N]:c[es(N)+T],A.f=Ua(U[1],f,{r:y.r,c:N},G,l);break;case 60:if(!l.cellStyles)break;for(;U.e>=U.s;)ee[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},re||(re=!0,jS(U.w/256)),zu(ee[U.e+1]);break;case 161:c["!autofilter"]={ref:Dr(U)};break;case 476:c["!margins"]=U;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),U.name&&(s.Sheets[r].CodeName=U.name),(U.above||U.left)&&(c["!outline"]={above:U.above,left:U.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),U.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!V.T){if(!p||l.WTF)throw new Error("Unexpected record 0x"+q.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(f.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=Dr(d||f)),l.sheetRows&&c["!ref"]){var B=Zr(c["!ref"]);l.sheetRows<=+B.e.r&&(B.e.r=l.sheetRows-1,B.e.r>f.e.r&&(B.e.r=f.e.r),B.e.r<B.s.r&&(B.s.r=B.e.r),B.e.c>f.e.c&&(B.e.c=f.e.c),B.e.c<B.s.c&&(B.s.c=B.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Dr(B))}return F.length>0&&(c["!merges"]=F),ee.length>0&&(c["!cols"]=ee),ie.length>0&&(c["!rows"]=ie),c}function iZ(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=zn(t),t.z=t.z||wr[14],t.v=Xs(Wn(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=td(s.cellXfs,t,s),t.l&&a["!links"].push([br(c),t.l]),t.c&&a["!comments"].push([br(c),t.c]),t.t){case"s":case"str":return s.bookSST?(l=IS(s.Strings,t.v,s.revStrings),c.t="s",c.v=l,i?kt(e,18,CQ(t,c)):kt(e,7,SQ(t,c))):(c.t="str",i?kt(e,17,OQ(t,c)):kt(e,6,IQ(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?kt(e,13,PQ(t,c)):kt(e,2,jQ(t,c)):i?kt(e,16,NQ(t,c)):kt(e,5,EQ(t,c)),!0;case"b":return c.t="b",i?kt(e,15,xQ(t,c)):kt(e,4,mQ(t,c)),!0;case"e":return c.t="e",i?kt(e,14,_Q(t,c)):kt(e,3,vQ(t,c)),!0}return i?kt(e,12,hQ(t,c)):kt(e,1,dQ(t,c)),!0}function oZ(e,t,r,n){var s=Zr(t["!ref"]||"A1"),a,i="",l=[];kt(e,145);var c=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var f=s.s.r;f<=d;++f){i=Cs(f),sQ(e,t,s,f);var p=!1;if(f<=s.e.r)for(var g=s.s.c;g<=s.e.c;++g){f===s.s.r&&(l[g]=es(g)),a=l[g]+i;var y=c?(t[f]||[])[g]:t[a];if(!y){p=!1;continue}p=iZ(e,y,f,g,n,t,p)}}kt(e,146)}function lZ(e,t){!t||!t["!merges"]||(kt(e,177,HQ(t["!merges"].length)),t["!merges"].forEach(function(r){kt(e,176,zQ(r))}),kt(e,178))}function cZ(e,t){!t||!t["!cols"]||(kt(e,390),t["!cols"].forEach(function(r,n){r&&kt(e,60,YQ(n,r))}),kt(e,391))}function uZ(e,t){!t||!t["!ref"]||(kt(e,648),kt(e,649,tZ(Zr(t["!ref"]))),kt(e,650))}function dZ(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=xn(r,-1,n[1].Target.replace(/#.*$/,""),Gr.HLINK);kt(e,494,VQ(n,s))}}),delete t["!links"]}function fZ(e,t,r,n){if(t["!comments"].length>0){var s=xn(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Gr.VML);kt(e,551,bS("rId"+s)),t["!legacy"]=s}}function hZ(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Dr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=Pi(a);l.s.r==l.e.r&&(l.e.r=Pi(t["!ref"]).e.r,a=Dr(l));for(var c=0;c<i.length;++c){var d=i[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),kt(e,161,M0(Zr(a))),kt(e,162)}}function gZ(e,t,r){kt(e,133),kt(e,137,eZ(t,r)),kt(e,138),kt(e,134)}function mZ(e,t){t["!protect"]&&kt(e,535,rZ(t["!protect"]))}function pZ(e,t,r,n){var s=Fi(),a=r.SheetNames[e],i=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=Zr(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],kt(s,129),(r.vbaraw||i["!outline"])&&kt(s,147,cQ(l,i["!outline"])),kt(s,148,iQ(c)),gZ(s,i,r.Workbook),cZ(s,i),oZ(s,i,e,t),mZ(s,i),hZ(s,i,r,e),lZ(s,i),dZ(s,i,n),i["!margins"]&&kt(s,476,QQ(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&uZ(s,i),fZ(s,i,e,n),kt(s,130),s.end()}function xZ(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=Qr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function yZ(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var l=0,c=0,d="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=xZ(p);f.s.r=f.s.c=0,f.e.c=l,d=es(l),g[0].forEach(function(y,v){i[d+Cs(v)]={t:"n",v:y,z:g[1]},c=v}),f.e.r<c&&(f.e.r=c),++l}),l>0&&(i["!ref"]=Dr(f)),i}function vZ(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,l=e.match(BF);return l&&MS(l[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function wZ(e,t){e.l+=10;var r=Va(e);return{name:r}}function _Z(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Mc(e,function(c,d,f){switch(f){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var OS=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],bZ=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SZ=[],kZ=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function f3(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Ln(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function h3(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ln(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function zF(e){h3(e.WBProps,OS),h3(e.CalcPr,kZ),f3(e.WBView,bZ),f3(e.Sheets,SZ),s0.date1904=Ln(e.WBProps.date1904)}function CZ(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ln(e.Workbook.WBProps.date1904)?"true":"false"}var TZ="][*?/\\".split("");function HF(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return TZ.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function EZ(e,t,r){e.forEach(function(n,s){HF(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function NZ(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];EZ(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)CJ(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var AZ=/<\w+:workbook/;function jZ(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(Xa,function(c,d){var f=kr(c);switch(Ul(f[0])){case"<?xml":break;case"<workbook":c.match(AZ)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":OS.forEach(function(p){if(f[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=Ln(f[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(f[p[0]],10);break;default:r.WBProps[p[0]]=f[p[0]]}}),f.codeName&&(r.WBProps.CodeName=kn(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Qr(kn(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=kn(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),Ln(f.hidden||"0")&&(a.Hidden=!0),i=d+c.length;break;case"</definedName>":a.Ref=Qr(kn(e.slice(i,d))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),bf.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return zF(r),r}function GF(e){var t=[Es];t[t.length]=Wt("workbook",null,{xmlns:bf[0],"xmlns:r":Ks.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(OS.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Wt("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:yn(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=Wt("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Wt("definedName",yn(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function FZ(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=l2(e),r.name=Va(e),r}function PZ(e,t){return t||(t=vt(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),bS(e.strRelID,t),ca(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function RZ(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Va(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function DZ(e,t){t||(t=vt(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),M8(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function IZ(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function MZ(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=fG(e),i=vJ(e,0,r),l=_S(e);e.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function OZ(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],bp[16]={n:"BrtFRTArchID$",f:IZ},Mc(e,function(c,d,f){switch(f){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Ua(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,c]):i[0]=[f,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),zF(r),r.Names=a,r.supbooks=i,r}function LZ(e,t){kt(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};kt(e,156,PZ(s))}kt(e,144)}function BZ(e,t){t||(t=vt(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return ca("SheetJS",t),ca(g1.version,t),ca(g1.version,t),ca("7262",t),t.length>t.l?t.slice(0,t.l):t}function UZ(e,t){t||(t=vt(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function $Z(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(kt(e,135),kt(e,158,UZ(s)),kt(e,136))}}function WZ(e,t){var r=Fi();return kt(r,131),kt(r,128,BZ()),kt(r,153,DZ(e.Workbook&&e.Workbook.WBProps||null)),$Z(r,e),LZ(r,e),kt(r,132),r.end()}function zZ(e,t,r){return t.slice(-4)===".bin"?OZ(e,r):jZ(e,r)}function HZ(e,t,r,n,s,a,i,l){return t.slice(-4)===".bin"?aZ(e,n,r,s,a,i,l):MJ(e,n,r,s,a,i,l)}function GZ(e,t,r,n,s,a,i,l){return t.slice(-4)===".bin"?_Z(e,n,r,s,a):vZ(e,n,r,s,a)}function VZ(e,t,r,n,s,a,i,l){return t.slice(-4)===".bin"?qX():XX()}function KZ(e,t,r,n,s,a,i,l){return t.slice(-4)===".bin"?VX():KX()}function qZ(e,t,r,n){return t.slice(-4)===".bin"?zq(e,r,n):Fq(e,r,n)}function XZ(e,t,r){return CF(e,r)}function YZ(e,t,r){return t.slice(-4)===".bin"?YK(e,r):KK(e,r)}function JZ(e,t,r){return t.slice(-4)===".bin"?$X(e,r):PX(e,r)}function QZ(e,t,r){return t.slice(-4)===".bin"?AX(e):EX(e)}function ZZ(e,t,r,n){return r.slice(-4)===".bin"?jX(e,t,r,n):void 0}function eee(e,t,r){return t.slice(-4)===".bin"?kX(e,t,r):TX(e,t,r)}function tee(e,t,r){return(t.slice(-4)===".bin"?WZ:GF)(e)}function ree(e,t,r,n,s){return(t.slice(-4)===".bin"?pZ:UF)(e,r,n,s)}function nee(e,t,r){return(t.slice(-4)===".bin"?Zq:SF)(e,r)}function see(e,t,r){return(t.slice(-4)===".bin"?ZK:mF)(e,r)}function aee(e,t,r){return(t.slice(-4)===".bin"?WX:NF)(e)}function iee(e){return(e.slice(-4)===".bin"?CX:TF)()}var VF=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,KF=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Wo(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(VF),a,i,l,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(KF),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(i+1),n[l]=a[2].slice(1,a[2].length-1));return n}function oee(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(VF),s,a,i,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match(KF),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var Gm;function lee(e,t){var r=Gm[e]||Qr(e);return r==="General"?hf(t):Co(r,t)}function cee(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Ln(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Wn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Qr(t)]=s}function uee(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Oc[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=hp(e.v):e.w=hf(e.v):e.w=lee(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=Gm[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&R0(n)){var s=$d(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function dee(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Sq[n.Pattern]||n.Pattern)}e[t.ID]=t}function fee(e,t,r,n,s,a,i,l,c,d){var f="General",p=n.StyleID,g={};d=d||{};var y=[],v=0;for(p===void 0&&l&&(p=l.StyleID),p===void 0&&i&&(p=i.StyleID);a[p]!==void 0&&(a[p].nf&&(f=a[p].nf),a[p].Interior&&y.push(a[p].Interior),!!a[p].Parent);)p=a[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ln(e);break;case"String":n.t="s",n.r=jN(Qr(e)),n.v=e.indexOf("<")>-1?Qr(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Wn(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Qr(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=$8[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=jN(t||e));break}if(uee(n,f,d),d.cellFormula!==!1)if(n.Formula){var _=Qr(n.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),n.f=n0(_,s),delete n.Formula,n.ArrayRange=="RC"?n.F=n0("RC:RC",s):n.ArrayRange&&(n.F=n0(n.ArrayRange,s),c.push([Zr(n.F),n.F]))}else for(v=0;v<c.length;++v)s.r>=c[v][0].s.r&&s.r<=c[v][0].e.r&&s.c>=c[v][0].s.c&&s.c<=c[v][0].e.c&&(n.F=c[v][1]);d.cellStyles&&(y.forEach(function(b){!g.patternType&&b.patternType&&(g.patternType=b.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function hee(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Xw(e,t){var r=t||{};D0();var n=Tm(mS(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=kn(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=zn(r);return i.type="string",m0.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ft){s.indexOf("<"+Ft)>=0&&(a=!0)}),a)return Qee(n,r);Gm={"General Number":"General","General Date":wr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":wr[15],"Short Date":wr[14],"Long Time":wr[19],"Medium Time":wr[18],"Short Time":wr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:wr[2],Standard:wr[4],Percent:wr[10],Scientific:wr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],d,f={},p=[],g=r.dense?[]:{},y="",v={},_={},b=Wo('<Data ss:Type="String">'),N=0,k=0,w=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},F={},R="",E=0,D=[],I={},G={},Y=0,ee=[],ie=[],re={},se=[],B,z=!1,U=[],V=[],q={},L=0,M=0,X={Sheets:[],WBProps:{date1904:!1}},K={};pp.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Z="";l=pp.exec(n);)switch(l[3]=(Z=l[3]).toLowerCase()){case"data":if(Z=="data"){if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?fee(n.slice(N,l.index),R,b,c[c.length-1][0]=="comment"?re:v,{c:k,r:w},A,se[k],_,U,r):(R="",b=Wo(l[0]),N=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(ie.length>0&&(v.c=ie),(!r.sheetRows||r.sheetRows>w)&&v.v!==void 0&&(r.dense?(g[w]||(g[w]=[]),g[w][k]=v):g[es(k)+Cs(w)]=v),v.HRef&&(v.l={Target:Qr(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(L=k+(parseInt(v.MergeAcross,10)|0),M=w+(parseInt(v.MergeDown,10)|0),D.push({s:{c:k,r:w},e:{c:L,r:M}})),!r.sheetStubs)v.MergeAcross?k=L+1:++k;else if(v.MergeAcross||v.MergeDown){for(var J=k;J<=L;++J)for(var ne=w;ne<=M;++ne)(J>k||ne>w)&&(r.dense?(g[ne]||(g[ne]=[]),g[ne][J]={t:"z"}):g[es(J)+Cs(ne)]={t:"z"});k=L+1}else++k;else v=oee(l[0]),v.Index&&(k=+v.Index-1),k<T.s.c&&(T.s.c=k),k>T.e.c&&(T.e.c=k),l[0].slice(-2)==="/>"&&++k,ie=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<T.s.r&&(T.s.r=w),w>T.e.r&&(T.e.r=w),l[0].slice(-2)==="/>"&&(_=Wo(l[0]),_.Index&&(w=+_.Index-1)),k=0,++w):(_=Wo(l[0]),_.Index&&(w=+_.Index-1),q={},(_.AutoFitHeight=="0"||_.Height)&&(q.hpx=parseInt(_.Height,10),q.hpt=_p(q.hpx),V[w]=q),_.Hidden=="1"&&(q.hidden=!0,V[w]=q));break;case"worksheet":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));p.push(y),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(g["!ref"]=Dr(T),r.sheetRows&&r.sheetRows<=T.e.r&&(g["!fullref"]=g["!ref"],T.e.r=r.sheetRows-1,g["!ref"]=Dr(T))),D.length&&(g["!merges"]=D),se.length>0&&(g["!cols"]=se),V.length>0&&(g["!rows"]=V),f[y]=g}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=k=0,c.push([l[3],!1]),d=Wo(l[0]),y=Qr(d.Name),g=r.dense?[]:{},D=[],U=[],V=[],K={name:y,Hidden:0},X.Sheets.push(K);break;case"table":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),se=[],z=!1}break;case"style":l[1]==="/"?dee(A,F,r):F=Wo(l[0]);break;case"numberformat":F.nf=Qr(Wo(l[0]).Format||"General"),Gm[F.nf]&&(F.nf=Gm[F.nf]);for(var me=0;me!=392&&wr[me]!=F.nf;++me);if(me==392){for(me=57;me!=392;++me)if(wr[me]==null){Tc(F.nf,me);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(B=Wo(l[0]),B.Hidden&&(B.hidden=!0,delete B.Hidden),B.Width&&(B.wpx=parseInt(B.Width,10)),!z&&B.wpx>10){z=!0,$a=_F;for(var xe=0;xe<se.length;++xe)se[xe]&&zu(se[xe])}z&&zu(B),se[B.Index-1||se.length]=B;for(var Ne=0;Ne<+B.Span;++Ne)se[se.length]=zn(B);break;case"namedrange":if(l[1]==="/")break;X.Names||(X.Names=[]);var le=kr(l[0]),ge={Name:le.Name,Ref:n0(le.RefersTo.slice(1),{r:0,c:0})};X.Sheets.length>0&&(ge.Sheet=X.Sheets.length-1),X.Names.push(ge);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?R+=n.slice(E,l.index):E=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;F.Interior=Wo(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?OG(I,Z,n.slice(Y,l.index)):Y=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));hee(re),ie.push(re)}else c.push([l[3],!1]),d=Wo(l[0]),re={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Ue=Wo(l[0]);g["!autofilter"]={ref:n0(Ue.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return y3(n,r);var Ge=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ge=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ge=!1}break;case"excelworkbook":switch(l[3]){case"date1904":X.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ge=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Ge=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(Y,l.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else Y=l.index+l[0].length;break;case"header":g["!margins"]||Jd(g["!margins"]={},"xlml"),isNaN(+kr(l[0]).Margin)||(g["!margins"].header=+kr(l[0]).Margin);break;case"footer":g["!margins"]||Jd(g["!margins"]={},"xlml"),isNaN(+kr(l[0]).Margin)||(g["!margins"].footer=+kr(l[0]).Margin);break;case"pagemargins":var Je=kr(l[0]);g["!margins"]||Jd(g["!margins"]={},"xlml"),isNaN(+Je.Top)||(g["!margins"].top=+Je.Top),isNaN(+Je.Left)||(g["!margins"].left=+Je.Left),isNaN(+Je.Right)||(g["!margins"].right=+Je.Right),isNaN(+Je.Bottom)||(g["!margins"].bottom=+Je.Bottom);break;case"displayrighttoleft":X.Views||(X.Views=[]),X.Views[0]||(X.Views[0]={}),X.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ge=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ge=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ge=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ge=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ge=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ge=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ge=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ge=!1}break;case"smarttags":break;default:Ge=!1;break}if(Ge||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?cee(G,Z,ee,n.slice(Y,l.index)):(ee=l,Y=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var He={};return!r.bookSheets&&!r.bookProps&&(He.Sheets=f),He.SheetNames=p,He.Workbook=X,He.SSF=zn(wr),He.Props=I,He.Custprops=G,He}function m2(e,t){switch(BS(t=t||{}),t.type||"base64"){case"base64":return Xw(qi(e),t);case"binary":case"buffer":case"file":return Xw(e,t);case"array":return Xw(Zu(e),t)}}function gee(e,t){var r=[];return e.Props&&r.push(LG(e.Props,t)),e.Custprops&&r.push(BG(e.Props,e.Custprops)),r.join("")}function mee(){return""}function pee(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(Wt("NumberFormat",null,{"ss:Format":yn(wr[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(Wt("Style",a.join(""),i))}),Wt("Styles",r.join(""))}function qF(e){return Wt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+RS(e.Ref,{r:0,c:0})})}function xee(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(qF(s)))}return Wt("Names",r.join(""))}function yee(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var l=s[i];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(qF(l)))}return a.join("")}function vee(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Wt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Wt("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Wt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Wt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Ea("ProtectContents","True")),e["!protect"].objects&&s.push(Ea("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Ea("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Ea("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Ea("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":Wt("WorksheetOptions",s.join(""),{xmlns:zi.x})}function wee(e){return e.map(function(t){var r=$H(t.t||""),n=Wt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Wt("Comment",n,{"ss:Author":t.a})}).join("")}function _ee(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+yn(RS(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=ts(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=yn(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=yn(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],f=0;f!=d.length;++f)d[f].s.c!=i.c||d[f].s.r!=i.r||(d[f].e.c>d[f].s.c&&(l["ss:MergeAcross"]=d[f].e.c-d[f].s.c),d[f].e.r>d[f].s.r&&(l["ss:MergeDown"]=d[f].e.r-d[f].s.r));var p="",g="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",g=String(e.v);break;case"b":p="Boolean",g=e.v?"1":"0";break;case"e":p="Error",g=Oc[e.v];break;case"d":p="DateTime",g=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||wr[14]);break;case"s":p="String",g=UH(e.v||"");break}var y=td(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+y),l["ss:Index"]=i.c+1;var v=e.v!=null?g:"",_=e.t=="z"?"":'<Data ss:Type="'+p+'">'+v+"</Data>";return(e.c||[]).length>0&&(_+=wee(e.c)),Wt("Cell",_,l)}function bee(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=p0(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function See(e,t,r,n){if(!e["!ref"])return"";var s=Zr(e["!ref"]),a=e["!merges"]||[],i=0,l=[];e["!cols"]&&e["!cols"].forEach(function(b,N){zu(b);var k=!!b.width,w=cv(N,b),T={"ss:Index":N+1};k&&(T["ss:Width"]=vp(w.width)),b.hidden&&(T["ss:Hidden"]="1"),l.push(Wt("Column",null,T))});for(var c=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var f=[bee(d,(e["!rows"]||[])[d])],p=s.s.c;p<=s.e.c;++p){var g=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>p)&&!(a[i].s.r>d)&&!(a[i].e.c<p)&&!(a[i].e.r<d)){(a[i].s.c!=p||a[i].s.r!=d)&&(g=!0);break}if(!g){var y={r:d,c:p},v=br(y),_=c?(e[d]||[])[p]:e[v];f.push(_ee(_,v,e,t,r,n,y))}}f.push("</Row>"),f.length>2&&l.push(f.join(""))}return l.join("")}function kee(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?yee(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?See(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(vee(a,t,e,r)),n.join("")}function Cee(e,t){t||(t={}),e.SSF||(e.SSF=zn(wr)),e.SSF&&(D0(),rv(e.SSF),t.revssf=sv(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],td(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(gee(e,t)),r.push(mee()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Wt("Worksheet",kee(n,t,e),{"ss:Name":yn(e.SheetNames[n])}));return r[2]=pee(e,t),r[3]=xee(e),Es+Wt("Workbook",r.join(""),{xmlns:zi.ss,"xmlns:o":zi.o,"xmlns:x":zi.x,"xmlns:ss":zi.ss,"xmlns:dt":zi.dt,"xmlns:html":zi.html})}function Tee(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=xG(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=yG(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Eee=[60,1084,2066,2165,2175];function Nee(e,t,r,n,s){var a=n,i=[],l=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}i.push(l),r.l+=a;for(var c=Sc(r,r.l),d=p2[c],f=0;d!=null&&Eee.indexOf(c)>-1;)a=Sc(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),l=r.slice(f,r.l+4+a),i.push(l),r.l+=4+a,d=p2[c=Sc(r,r.l)];var p=oa(i);ka(p,0);var g=0;p.lens=[];for(var y=0;y<i.length;++y)p.lens.push(g),g+=i[y].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,s)}function kl(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=wr[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Oc[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=hp(e.v):e.w=hf(e.v):e.w=Co(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&R0(wr[n]||String(n))){var s=$d(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Ey(e,t,r){return{v:e,ixfe:t,t:r}}function Aee(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},l=null,c=[],d="",f={},p,g="",y,v,_,b,N={},k=[],w,T,A=[],F=[],R={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},D=function(ut){return ut<8?qd[ut]:ut<64&&F[ut-8]||qd[ut]},I=function(ut,wt,$t){var Kt=wt.XF.data;if(!(!Kt||!Kt.patternType||!$t||!$t.cellStyles)){wt.s={},wt.s.patternType=Kt.patternType;var De;(De=yp(D(Kt.icvFore)))&&(wt.s.fgColor={rgb:De}),(De=yp(D(Kt.icvBack)))&&(wt.s.bgColor={rgb:De})}},G=function(ut,wt,$t){if(!(q>1)&&!($t.sheetRows&&ut.r>=$t.sheetRows)){if($t.cellStyles&&wt.XF&&wt.XF.data&&I(ut,wt,$t),delete wt.ixfe,delete wt.XF,p=ut,g=br(ut),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),ut.r<i.s.r&&(i.s.r=ut.r),ut.c<i.s.c&&(i.s.c=ut.c),ut.r+1>i.e.r&&(i.e.r=ut.r+1),ut.c+1>i.e.c&&(i.e.c=ut.c+1),$t.cellFormula&&wt.f){for(var Kt=0;Kt<k.length;++Kt)if(!(k[Kt][0].s.c>ut.c||k[Kt][0].s.r>ut.r)&&!(k[Kt][0].e.c<ut.c||k[Kt][0].e.r<ut.r)){wt.F=Dr(k[Kt][0]),(k[Kt][0].s.c!=ut.c||k[Kt][0].s.r!=ut.r)&&delete wt.f,wt.f&&(wt.f=""+Ua(k[Kt][1],i,ut,U,Y));break}}$t.dense?(s[ut.r]||(s[ut.r]=[]),s[ut.r][ut.c]=wt):s[g]=wt}},Y={enc:!1,sbcch:0,snames:[],sharedf:N,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Y.password=t.password);var ee,ie=[],re=[],se=[],B=[],z=!1,U=[];U.SheetNames=Y.snames,U.sharedf=Y.sharedf,U.arrayf=Y.arrayf,U.names=[],U.XTI=[];var V=0,q=0,L=0,M=[],X=[],K;Y.codepage=1200,qo(1200);for(var Z=!1;e.l<e.length-1;){var J=e.l,ne=e.read_shift(2);if(ne===0&&V===10)break;var me=e.l===e.length?0:e.read_shift(2),xe=p2[ne];if(xe&&xe.f){if(t.bookSheets&&V===133&&ne!==133)break;if(V=ne,xe.r===2||xe.r==12){var Ne=e.read_shift(2);if(me-=2,!Y.enc&&Ne!==ne&&((Ne&255)<<8|Ne>>8)!==ne)throw new Error("rt mismatch: "+Ne+"!="+ne);xe.r==12&&(e.l+=10,me-=10)}var le={};if(ne===10?le=xe.f(e,me,Y):le=Nee(ne,xe,e,me,Y),q==0&&[9,521,1033,2057].indexOf(V)===-1)continue;switch(ne){case 34:r.opts.Date1904=R.WBProps.date1904=le;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Y.enc||(e.l=0),Y.enc=le,!t.password)throw new Error("File is password-protected");if(le.valid==null)throw new Error("Encryption scheme unsupported");if(!le.valid)throw new Error("Password is incorrect");break;case 92:Y.lastuser=le;break;case 66:var ge=Number(le);switch(ge){case 21010:ge=1200;break;case 32768:ge=1e4;break;case 32769:ge=1252;break}qo(Y.codepage=ge),Z=!0;break;case 317:Y.rrtabid=le;break;case 25:Y.winlocked=le;break;case 439:r.opts.RefreshAll=le;break;case 12:r.opts.CalcCount=le;break;case 16:r.opts.CalcDelta=le;break;case 17:r.opts.CalcIter=le;break;case 13:r.opts.CalcMode=le;break;case 14:r.opts.CalcPrecision=le;break;case 95:r.opts.CalcSaveRecalc=le;break;case 15:Y.CalcRefMode=le;break;case 2211:r.opts.FullCalc=le;break;case 129:le.fDialog&&(s["!type"]="dialog"),le.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),le.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:A.push(le);break;case 430:U.push([le]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(le);break;case 24:case 536:K={Name:le.Name,Ref:Ua(le.rgce,i,null,U,Y)},le.itab>0&&(K.Sheet=le.itab-1),U.names.push(K),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(le),le.Name=="_xlnm._FilterDatabase"&&le.itab>0&&le.rgce&&le.rgce[0]&&le.rgce[0][0]&&le.rgce[0][0][0]=="PtgArea3d"&&(X[le.itab-1]={ref:Dr(le.rgce[0][0][1][2])});break;case 22:Y.ExternCount=le;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(le),U.XTI=U.XTI.concat(le);break;case 2196:if(Y.biff<8)break;K!=null&&(K.Comment=le[1]);break;case 18:s["!protect"]=le;break;case 19:le!==0&&Y.WTF&&console.error("Password verifier: "+le);break;case 133:a[le.pos]=le,Y.snames.push(le.name);break;case 10:{if(--q)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Dr(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ue=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Dr(i),i.e.r=Ue}i.e.r++,i.e.c++}ie.length>0&&(s["!merges"]=ie),re.length>0&&(s["!objects"]=re),se.length>0&&(s["!cols"]=se),B.length>0&&(s["!rows"]=B),R.Sheets.push(E)}d===""?f=s:n[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Y.biff===8&&(Y.biff={9:2,521:3,1033:4}[ne]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[le.BIFFVer]||8),Y.biffguess=le.BIFFVer==0,le.BIFFVer==0&&le.dt==4096&&(Y.biff=5,Z=!0,qo(Y.codepage=28591)),Y.biff==8&&le.BIFFVer==0&&le.dt==16&&(Y.biff=2),q++)break;if(s=t.dense?[]:{},Y.biff<8&&!Z&&(Z=!0,qo(Y.codepage=t.codepage||1252)),Y.biff<5||le.BIFFVer==0&&le.dt==4096){d===""&&(d="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ge={pos:e.l-me,name:d};a[Ge.pos]=Ge,Y.snames.push(d)}else d=(a[J]||{name:""}).name;le.dt==32&&(s["!type"]="chart"),le.dt==64&&(s["!type"]="macro"),ie=[],re=[],Y.arrayf=k=[],se=[],B=[],z=!1,E={Hidden:(a[J]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[le.r]||[])[le.c]:s[br({c:le.c,r:le.r})])&&++le.c,w={ixfe:le.ixfe,XF:A[le.ixfe]||{},v:le.val,t:"n"},L>0&&(w.z=M[w.ixfe>>8&63]),kl(w,t,r.opts.Date1904),G({c:le.c,r:le.r},w,t);break;case 5:case 517:w={ixfe:le.ixfe,XF:A[le.ixfe],v:le.val,t:le.t},L>0&&(w.z=M[w.ixfe>>8&63]),kl(w,t,r.opts.Date1904),G({c:le.c,r:le.r},w,t);break;case 638:w={ixfe:le.ixfe,XF:A[le.ixfe],v:le.rknum,t:"n"},L>0&&(w.z=M[w.ixfe>>8&63]),kl(w,t,r.opts.Date1904),G({c:le.c,r:le.r},w,t);break;case 189:for(var Je=le.c;Je<=le.C;++Je){var He=le.rkrec[Je-le.c][0];w={ixfe:He,XF:A[He],v:le.rkrec[Je-le.c][1],t:"n"},L>0&&(w.z=M[w.ixfe>>8&63]),kl(w,t,r.opts.Date1904),G({c:Je,r:le.r},w,t)}break;case 6:case 518:case 1030:{if(le.val=="String"){l=le;break}if(w=Ey(le.val,le.cell.ixfe,le.tt),w.XF=A[w.ixfe],t.cellFormula){var Ft=le.formula;if(Ft&&Ft[0]&&Ft[0][0]&&Ft[0][0][0]=="PtgExp"){var rt=Ft[0][0][1][0],Ie=Ft[0][0][1][1],Pe=br({r:rt,c:Ie});N[Pe]?w.f=""+Ua(le.formula,i,le.cell,U,Y):w.F=((t.dense?(s[rt]||[])[Ie]:s[Pe])||{}).F}else w.f=""+Ua(le.formula,i,le.cell,U,Y)}L>0&&(w.z=M[w.ixfe>>8&63]),kl(w,t,r.opts.Date1904),G(le.cell,w,t),l=le}break;case 7:case 519:if(l)l.val=le,w=Ey(le,l.cell.ixfe,"s"),w.XF=A[w.ixfe],t.cellFormula&&(w.f=""+Ua(l.formula,i,l.cell,U,Y)),L>0&&(w.z=M[w.ixfe>>8&63]),kl(w,t,r.opts.Date1904),G(l.cell,w,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(le);var Qe=br(le[0].s);if(y=t.dense?(s[le[0].s.r]||[])[le[0].s.c]:s[Qe],t.cellFormula&&y){if(!l||!Qe||!y)break;y.f=""+Ua(le[1],i,le[0],U,Y),y.F=Dr(le[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!l)break;N[br(l.cell)]=le[0],y=t.dense?(s[l.cell.r]||[])[l.cell.c]:s[br(l.cell)],(y||{}).f=""+Ua(le[0],i,p,U,Y)}}break;case 253:w=Ey(c[le.isst].t,le.ixfe,"s"),c[le.isst].h&&(w.h=c[le.isst].h),w.XF=A[w.ixfe],L>0&&(w.z=M[w.ixfe>>8&63]),kl(w,t,r.opts.Date1904),G({c:le.c,r:le.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:le.ixfe,XF:A[le.ixfe],t:"z"},L>0&&(w.z=M[w.ixfe>>8&63]),kl(w,t,r.opts.Date1904),G({c:le.c,r:le.r},w,t));break;case 190:if(t.sheetStubs)for(var _t=le.c;_t<=le.C;++_t){var gt=le.ixfe[_t-le.c];w={ixfe:gt,XF:A[gt],t:"z"},L>0&&(w.z=M[w.ixfe>>8&63]),kl(w,t,r.opts.Date1904),G({c:_t,r:le.r},w,t)}break;case 214:case 516:case 4:w=Ey(le.val,le.ixfe,"s"),w.XF=A[w.ixfe],L>0&&(w.z=M[w.ixfe>>8&63]),kl(w,t,r.opts.Date1904),G({c:le.c,r:le.r},w,t);break;case 0:case 512:q===1&&(i=le);break;case 252:c=le;break;case 1054:if(Y.biff==4){M[L++]=le[1];for(var Bt=0;Bt<L+163&&wr[Bt]!=le[1];++Bt);Bt>=163&&Tc(le[1],L+163)}else Tc(le[1],le[0]);break;case 30:{M[L++]=le;for(var Ut=0;Ut<L+163&&wr[Ut]!=le;++Ut);Ut>=163&&Tc(le,L+163)}break;case 229:ie=ie.concat(le);break;case 93:re[le.cmo[0]]=Y.lastobj=le;break;case 438:Y.lastobj.TxO=le;break;case 127:Y.lastobj.ImData=le;break;case 440:for(b=le[0].s.r;b<=le[0].e.r;++b)for(_=le[0].s.c;_<=le[0].e.c;++_)y=t.dense?(s[b]||[])[_]:s[br({c:_,r:b})],y&&(y.l=le[1]);break;case 2048:for(b=le[0].s.r;b<=le[0].e.r;++b)for(_=le[0].s.c;_<=le[0].e.c;++_)y=t.dense?(s[b]||[])[_]:s[br({c:_,r:b})],y&&y.l&&(y.l.Tooltip=le[1]);break;case 28:{if(Y.biff<=5&&Y.biff>=2)break;y=t.dense?(s[le[0].r]||[])[le[0].c]:s[br(le[0])];var it=re[le[2]];y||(t.dense?(s[le[0].r]||(s[le[0].r]=[]),y=s[le[0].r][le[0].c]={t:"z"}):y=s[br(le[0])]={t:"z"},i.e.r=Math.max(i.e.r,le[0].r),i.s.r=Math.min(i.s.r,le[0].r),i.e.c=Math.max(i.e.c,le[0].c),i.s.c=Math.min(i.s.c,le[0].c)),y.c||(y.c=[]),v={a:le[1],t:it.TxO.t},y.c.push(v)}break;case 2173:pX(A[le.ixfe],le.ext);break;case 125:{if(!Y.cellStyles)break;for(;le.e>=le.s;)se[le.e--]={width:le.w/256,level:le.level||0,hidden:!!(le.flags&1)},z||(z=!0,jS(le.w/256)),zu(se[le.e+1])}break;case 520:{var Ye={};le.level!=null&&(B[le.r]=Ye,Ye.level=le.level),le.hidden&&(B[le.r]=Ye,Ye.hidden=!0),le.hpt&&(B[le.r]=Ye,Ye.hpt=le.hpt,Ye.hpx=p0(le.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Jd(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ne]]=le;break;case 161:s["!margins"]||Jd(s["!margins"]={}),s["!margins"].header=le.header,s["!margins"].footer=le.footer;break;case 574:le.RTL&&(R.Views[0].RTL=!0);break;case 146:F=le;break;case 2198:ee=le;break;case 140:T=le;break;case 442:d?E.CodeName=le||E.name:R.WBProps.CodeName=le||"ThisWorkbook";break}}else xe||console.error("Missing Info for XLS Record 0x"+ne.toString(16)),e.l+=me}return r.SheetNames=gs(a).sort(function(xt,ut){return Number(xt)-Number(ut)}).map(function(xt){return a[xt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&X.forEach(function(xt,ut){r.Sheets[r.SheetNames[ut]]["!autofilter"]=xt}),r.Strings=c,r.SSF=zn(wr),Y.enc&&(r.Encryption=Y.enc),ee&&(r.Themes=ee),r.Metadata={},T!==void 0&&(r.Metadata.Country=T),U.names.length>0&&(R.Names=U.names),r.Workbook=R,r}var Vm={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function jee(e,t,r){var n=gr.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=qN(n,c2,Vm.DSI);for(var a in s)t[a]=s[a]}catch(d){if(r.WTF)throw d}var i=gr.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var l=qN(i,u2,Vm.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(K8(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Fee(e,t){var r=[],n=[],s=[],a=0,i,l=kN(c2,"n"),c=kN(u2,"n");if(e.Props)for(i=gs(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(l,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=gs(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(l,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var d=[];for(a=0;a<s.length;++a)eF.indexOf(s[a][0])>-1||V8.indexOf(s[a][0])>-1||s[a][1]!=null&&d.push(s[a]);n.length&&gr.utils.cfb_add(t,"/SummaryInformation",XN(n,Vm.SI,c,u2)),(r.length||d.length)&&gr.utils.cfb_add(t,"/DocumentSummaryInformation",XN(r,Vm.DSI,l,c2,d.length?d:null,Vm.UDI))}function XF(e,t){t||(t={}),BS(t),iS(),t.codepage&&aS(t.codepage);var r,n;if(e.FullPaths){if(gr.find(e,"/encryption"))throw new Error("File is password-protected");r=gr.find(e,"!CompObj"),n=gr.find(e,"/Workbook")||gr.find(e,"/Book")}else{switch(t.type){case"base64":e=Gi(qi(e));break;case"binary":e=Gi(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ka(e,0),n={content:e}}var s,a;if(r&&Tee(r),t.bookProps&&!t.bookSheets)s={};else{var i=Ur?"buffer":"array";if(n&&n.content)s=Aee(n.content,t);else if((a=gr.find(e,"PerfectOffice_MAIN"))&&a.content)s=Yd.to_workbook(a.content,(t.type=i,t));else if((a=gr.find(e,"NativeContent_MAIN"))&&a.content)s=Yd.to_workbook(a.content,(t.type=i,t));else throw(a=gr.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&gr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=HX(e))}var l={};return e.FullPaths&&jee(e,l,t),s.Props=s.Custprops=l,t.bookFiles&&(s.cfb=e),s}function Pee(e,t){var r=t||{},n=gr.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return gr.utils.cfb_add(n,s,YF(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Fee(e,n),r.biff==8&&e.vbaraw&&GX(n,gr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var bp={0:{f:rQ},1:{f:uQ},2:{f:AQ},3:{f:yQ},4:{f:gQ},5:{f:TQ},6:{f:DQ},7:{f:bQ},8:{f:$Q},9:{f:UQ},10:{f:LQ},11:{f:BQ},12:{f:fQ},13:{f:FQ},14:{f:wQ},15:{f:pQ},16:{f:$F},17:{f:MQ},18:{f:kQ},19:{f:wS},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:MZ},40:{},42:{},43:{f:Dq},44:{f:Pq},45:{f:Oq},46:{f:Bq},47:{f:Lq},48:{},49:{f:aG},50:{},51:{f:vX},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:dF},62:{f:RQ},63:{f:NX},64:{f:nZ},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ZQ},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:lQ},148:{f:aQ,p:16},151:{f:KQ},152:{},153:{f:RZ},154:{},155:{},156:{f:FZ},157:{},158:{},159:{T:1,f:XK},160:{T:-1},161:{T:1,f:Tf},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:WQ},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:xX},336:{T:-1},337:{f:bX,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:l2},357:{},358:{},359:{},360:{T:1},361:{},362:{f:uF},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:qQ},427:{f:XQ},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:JQ},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:oQ},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:GQ},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:l2},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:BX},633:{T:1},634:{T:-1},635:{T:1,f:OX},636:{T:-1},637:{f:cG},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:wZ},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:sZ},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},p2={6:{f:Kw},10:{f:ku},12:{f:Is},13:{f:Is},14:{f:Ss},15:{f:Ss},16:{f:Wa},17:{f:Ss},18:{f:Ss},19:{f:Is},20:{f:t3},21:{f:t3},23:{f:uF},24:{f:n3},25:{f:Ss},26:{},27:{},28:{f:sK},29:{},34:{f:Ss},35:{f:r3},38:{f:Wa},39:{f:Wa},40:{f:Wa},41:{f:Wa},42:{f:Ss},43:{f:Ss},47:{f:pq},49:{f:FV},51:{f:Is},60:{},61:{f:TV},64:{f:Ss},65:{f:jV},66:{f:Is},77:{},80:{},81:{},82:{},85:{f:Is},89:{},90:{},91:{},92:{f:mV},93:{f:oK},94:{},95:{f:Ss},96:{},97:{},99:{f:Ss},125:{f:dF},128:{f:VV},129:{f:xV},130:{f:Is},131:{f:Ss},132:{f:Ss},133:{f:yV},134:{},140:{f:mK},141:{f:Is},144:{},146:{f:yK},151:{},152:{},153:{},154:{},155:{},156:{f:Is},157:{},158:{},160:{f:CK},161:{f:_K},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:WV},190:{f:zV},193:{f:ku},197:{},198:{},199:{},200:{},201:{},202:{f:Ss},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Is},220:{},221:{f:Ss},222:{},224:{f:GV},225:{f:gV},226:{f:ku},227:{},229:{f:aK},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:wV},253:{f:RV},255:{f:bV},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:tF},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ss},353:{f:ku},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:JV},431:{f:Ss},432:{},433:{},434:{},437:{},438:{f:uK},439:{f:Ss},440:{f:dK},441:{},442:{f:Jp},443:{},444:{f:Is},445:{},446:{},448:{f:ku},449:{f:CV,r:2},450:{f:ku},512:{f:QN},513:{f:kK},515:{f:XV},516:{f:IV},517:{f:e3},519:{f:TK},520:{f:SV},523:{},545:{f:s3},549:{f:JN},566:{},574:{f:NV},638:{f:$V},659:{},1048:{},1054:{f:OV},1084:{},1212:{f:tK},2048:{f:hK},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ky},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ku},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:vK,r:12},2173:{f:mX,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ss,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:eK,r:12},2197:{},2198:{f:cX,r:12},2199:{},2200:{},2201:{},2202:{f:rK,r:12},2203:{f:ku},2204:{},2205:{},2206:{},2207:{},2211:{f:kV},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Is},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:bK},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:xK},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:QN},1:{},2:{f:FK},3:{f:AK},4:{f:NK},5:{f:e3},7:{f:RK},8:{},9:{f:ky},11:{},22:{f:Is},30:{f:BV},31:{},32:{},33:{f:s3},36:{},37:{f:JN},50:{f:DK},62:{},52:{},67:{},68:{f:Is},69:{},86:{},126:{},127:{f:EK},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:IK},223:{},234:{},354:{},421:{},518:{f:Kw},521:{f:ky},536:{f:n3},547:{f:r3},561:{},579:{},1030:{f:Kw},1033:{f:ky},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function zt(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&xS(r)&&e.push(r)}}function Ree(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return zt(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],l=0,c=0,d=0;d+(i[l]||8224)<=8224;)d+=i[l]||8224,l++;var f=e.next(4);for(f.write_shift(2,a),f.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<s;){for(f=e.next(4),f.write_shift(2,60),d=0;d+(i[l]||8224)<=8224;)d+=i[l]||8224,l++;f.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function tx(e,t,r){return e||(e=vt(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Dee(e,t,r,n){var s=vt(9);return tx(s,e,t),rF(r,n||"b",s),s}function Iee(e,t,r){var n=vt(8+2*r.length);return tx(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Mee(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Xs(Wn(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?zt(e,2,PK(r,n,s)):zt(e,3,jK(r,n,s));return;case"b":case"e":zt(e,5,Dee(r,n,t.v,t.t));return;case"s":case"str":zt(e,4,Iee(r,n,(t.v||"").slice(0,255)));return}zt(e,1,tx(null,r,n))}function Oee(e,t,r,n){var s=Array.isArray(t),a=Zr(t["!ref"]||"A1"),i,l="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=Dr(a)}for(var d=a.s.r;d<=a.e.r;++d){l=Cs(d);for(var f=a.s.c;f<=a.e.c;++f){d===a.s.r&&(c[f]=es(f)),i=c[f]+l;var p=s?(t[d]||[])[f]:t[i];p&&Mee(e,p,d,f)}}}function Lee(e,t){for(var r=t||{},n=Fi(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return zt(n,r.biff==4?1033:r.biff==3?521:9,ES(e,16,r)),Oee(n,e.Sheets[e.SheetNames[s]],s,r),zt(n,10),n.end()}function Bee(e,t,r){zt(e,49,PV({sz:12,name:"Arial"},r))}function Uee(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&zt(e,1054,LV(s,t[s],r))})}function $ee(e,t){var r=vt(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),zt(e,2151,r),r=vt(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),oF(Zr(t["!ref"]||"A1"),r),r.write_shift(4,4),zt(e,2152,r)}function Wee(e,t){for(var r=0;r<16;++r)zt(e,224,ZN({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){zt(e,224,ZN(n,0,t))})}function zee(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];zt(e,440,fK(n)),n[1].Tooltip&&zt(e,2048,gK(n))}delete t["!links"]}function Hee(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&zt(e,125,wK(cv(s,n),s))})}}function Gee(e,t,r,n,s){var a=16+td(s.cellXfs,t,s);if(t.v==null&&!t.bf){zt(e,513,xf(r,n,a));return}if(t.bf)zt(e,6,xJ(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?Xs(Wn(t.v)):t.v;zt(e,515,YV(r,n,i,a));break;case"b":case"e":zt(e,517,qV(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var l=IS(s.Strings,t.v,s.revStrings);zt(e,253,DV(r,n,l,a))}else zt(e,516,MV(r,n,(t.v||"").slice(0,255),a,s));break;default:zt(e,513,xf(r,n,a))}}function Vee(e,t,r){var n=Fi(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},l=(i.Sheets||[])[e]||{},c=Array.isArray(a),d=t.biff==8,f,p="",g=[],y=Zr(a["!ref"]||"A1"),v=d?65536:16384;if(y.e.c>255||y.e.r>=v){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,v-1)}zt(n,2057,ES(r,16,t)),zt(n,13,yo(1)),zt(n,12,yo(100)),zt(n,15,ci(!0)),zt(n,17,ci(!1)),zt(n,16,mf(.001)),zt(n,95,ci(!0)),zt(n,42,ci(!1)),zt(n,43,ci(!1)),zt(n,130,yo(1)),zt(n,128,KV()),zt(n,131,ci(!1)),zt(n,132,ci(!1)),d&&Hee(n,a["!cols"]),zt(n,512,UV(y,t)),d&&(a["!links"]=[]);for(var _=y.s.r;_<=y.e.r;++_){p=Cs(_);for(var b=y.s.c;b<=y.e.c;++b){_===y.s.r&&(g[b]=es(b)),f=g[b]+p;var N=c?(a[_]||[])[b]:a[f];N&&(Gee(n,N,_,b,t),d&&N.l&&a["!links"].push([f,N.l]))}}var k=l.CodeName||l.name||s;return d&&zt(n,574,AV((i.Views||[])[0])),d&&(a["!merges"]||[]).length&&zt(n,229,iK(a["!merges"])),d&&zee(n,a),zt(n,442,nF(k)),d&&$ee(n,a),zt(n,10),n.end()}function Kee(e,t,r){var n=Fi(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(zt(n,2057,ES(e,5,r)),r.bookType=="xla"&&zt(n,135),zt(n,225,l?yo(1200):null),zt(n,193,qG(2)),c&&zt(n,191),c&&zt(n,192),zt(n,226),zt(n,92,pV("SheetJS",r)),zt(n,66,yo(l?1200:1252)),l&&zt(n,353,yo(0)),l&&zt(n,448),zt(n,317,SK(e.SheetNames.length)),l&&e.vbaraw&&zt(n,211),l&&e.vbaraw){var d=i.CodeName||"ThisWorkbook";zt(n,442,nF(d))}zt(n,156,yo(17)),zt(n,25,ci(!1)),zt(n,18,ci(!1)),zt(n,19,yo(0)),l&&zt(n,431,ci(!1)),l&&zt(n,444,yo(0)),zt(n,61,EV()),zt(n,64,ci(!1)),zt(n,141,yo(0)),zt(n,34,ci(CZ(e)=="true")),zt(n,14,ci(!0)),l&&zt(n,439,ci(!1)),zt(n,218,yo(0)),Bee(n,e,r),Uee(n,e.SSF,r),Wee(n,r),l&&zt(n,352,ci(!1));var f=n.end(),p=Fi();l&&zt(p,140,pK()),l&&r.Strings&&Ree(p,252,_V(r.Strings)),zt(p,10);var g=p.end(),y=Fi(),v=0,_=0;for(_=0;_<e.SheetNames.length;++_)v+=(l?12:11)+(l?2:1)*e.SheetNames[_].length;var b=f.length+v+g.length;for(_=0;_<e.SheetNames.length;++_){var N=a[_]||{};zt(y,133,vV({pos:b,hs:N.Hidden||0,dt:0,name:e.SheetNames[_]},r)),b+=t[_].length}var k=y.end();if(v!=k.length)throw new Error("BS8 "+v+" != "+k.length);var w=[];return f.length&&w.push(f),k.length&&w.push(k),g.length&&w.push(g),oa(w)}function qee(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=zn(wr)),e&&e.SSF&&(D0(),rv(e.SSF),r.revssf=sv(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,US(r),r.cellXfs=[],td(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=Vee(s,r,e);return n.unshift(Kee(e,n,r)),oa(n)}function YF(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Pi(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return qee(e,t);case 4:case 3:case 2:return Lee(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function g3(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,l=a&&a.index||e.length,c=PH(e.slice(i,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,f=0,p=0,g=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(i=0;i<c.length;++i){var _=c[i].trim(),b=_.slice(0,3).toLowerCase();if(b=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}f=0;continue}if(!(b!="<td"&&b!="<th")){var N=_.split(/<\/t[dh]>/i);for(l=0;l<N.length;++l){var k=N[l].trim();if(k.match(/<t[dh]/i)){for(var w=k,T=0;w.charAt(0)=="<"&&(T=w.indexOf(">"))>-1;)w=w.slice(T+1);for(var A=0;A<v.length;++A){var F=v[A];F.s.c==f&&F.s.r<d&&d<=F.e.r&&(f=F.e.c+1,A=-1)}var R=kr(k.slice(0,k.indexOf(">")));g=R.colspan?+R.colspan:1,((p=+R.rowspan)>1||g>1)&&v.push({s:{r:d,c:f},e:{r:d+(p||1)-1,c:f+g-1}});var E=R.t||R["data-t"]||"";if(!w.length){f+=g;continue}if(w=w8(w),y.s.r>d&&(y.s.r=d),y.e.r<d&&(y.e.r=d),y.s.c>f&&(y.s.c=f),y.e.c<f&&(y.e.c=f),!w.length){f+=g;continue}var D={t:"s",v:w};r.raw||!w.trim().length||E=="s"||(w==="TRUE"?D={t:"b",v:!0}:w==="FALSE"?D={t:"b",v:!1}:isNaN(Jo(w))?isNaN(g0(w).getDate())||(D={t:"d",v:Wn(w)},r.cellDates||(D={t:"n",v:Xs(D.v)}),D.z=r.dateNF||wr[14]):D={t:"n",v:Jo(w)}),r.dense?(n[d]||(n[d]=[]),n[d][f]=D):n[br({r:d,c:f})]=D,f+=g}}}}return n["!ref"]=Dr(y),v.length&&(n["!merges"]=v),n}function Xee(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var l=0,c=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>i)&&!(s[d].e.r<r||s[d].e.c<i)){if(s[d].s.r<r||s[d].s.c<i){l=-1;break}l=s[d].e.r-s[d].s.r+1,c=s[d].e.c-s[d].s.c+1;break}if(!(l<0)){var f=br({r,c:i}),p=n.dense?(e[r]||[])[i]:e[f],g=p&&p.v!=null&&(p.h||gS(p.w||(Pc(p),p.w)||""))||"",y={};l>1&&(y.rowspan=l),c>1&&(y.colspan=c),n.editable?g='<span contenteditable="true">'+g+"</span>":p&&(y["data-t"]=p&&p.t||"z",p.v!=null&&(y["data-v"]=p.v),p.z!=null&&(y["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),y.id=(n.id||"sjs")+"-"+f,a.push(Wt("td",g,y))}}var v="<tr>";return v+a.join("")+"</tr>"}var Yee='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Jee="</body></html>";function Qee(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ed(g3(r[0],t),t);var n=zS();return r.forEach(function(s,a){HS(n,g3(s,t),"Sheet"+(a+1))}),n}function Zee(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function JF(e,t){var r=t||{},n=r.header!=null?r.header:Yee,s=r.footer!=null?r.footer:Jee,a=[n],i=Pi(e["!ref"]);r.dense=Array.isArray(e),a.push(Zee(e,i,r));for(var l=i.s.r;l<=i.e.r;++l)a.push(Xee(e,i,l,r));return a.push("</table>"+s),a.join("")}function QF(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?ts(n.origin):n.origin;s=i.r,a=i.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var f=Pi(e["!ref"]);d.s.r=Math.min(d.s.r,f.s.r),d.s.c=Math.min(d.s.c,f.s.c),d.e.r=Math.max(d.e.r,f.e.r),d.e.c=Math.max(d.e.c,f.e.c),s==-1&&(d.e.r=s=f.e.r+1)}var p=[],g=0,y=e["!rows"]||(e["!rows"]=[]),v=0,_=0,b=0,N=0,k=0,w=0;for(e["!cols"]||(e["!cols"]=[]);v<l.length&&_<c;++v){var T=l[v];if(m3(T)){if(n.display)continue;y[_]={hidden:!0}}var A=T.children;for(b=N=0;b<A.length;++b){var F=A[b];if(!(n.display&&m3(F))){var R=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):w8(F.innerHTML),E=F.getAttribute("data-z")||F.getAttribute("z");for(g=0;g<p.length;++g){var D=p[g];D.s.c==N+a&&D.s.r<_+s&&_+s<=D.e.r&&(N=D.e.c+1-a,g=-1)}w=+F.getAttribute("colspan")||1,((k=+F.getAttribute("rowspan")||1)>1||w>1)&&p.push({s:{r:_+s,c:N+a},e:{r:_+s+(k||1)-1,c:N+a+(w||1)-1}});var I={t:"s",v:R},G=F.getAttribute("data-t")||F.getAttribute("t")||"";R!=null&&(R.length==0?I.t=G||"z":n.raw||R.trim().length==0||G=="s"||(R==="TRUE"?I={t:"b",v:!0}:R==="FALSE"?I={t:"b",v:!1}:isNaN(Jo(R))?isNaN(g0(R).getDate())||(I={t:"d",v:Wn(R)},n.cellDates||(I={t:"n",v:Xs(I.v)}),I.z=n.dateNF||wr[14]):I={t:"n",v:Jo(R)})),I.z===void 0&&E!=null&&(I.z=E);var Y="",ee=F.getElementsByTagName("A");if(ee&&ee.length)for(var ie=0;ie<ee.length&&!(ee[ie].hasAttribute("href")&&(Y=ee[ie].getAttribute("href"),Y.charAt(0)!="#"));++ie);Y&&Y.charAt(0)!="#"&&(I.l={Target:Y}),n.dense?(e[_+s]||(e[_+s]=[]),e[_+s][N+a]=I):e[br({c:N+a,r:_+s})]=I,d.e.c<N+a&&(d.e.c=N+a),N+=w}}++_}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),d.e.r=Math.max(d.e.r,_-1+s),e["!ref"]=Dr(d),_>=c&&(e["!fullref"]=Dr((d.e.r=l.length-v+_-1+s,d))),e}function ZF(e,t){var r=t||{},n=r.dense?[]:{};return QF(n,e,t)}function ete(e,t){return ed(ZF(e,t),t)}function m3(e){var t="",r=tte(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function tte(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function rte(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Qr(t.replace(/<[^>]*>/g,""));return[r]}var p3={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function eP(e,t){var r=t||{},n=mS(e),s=[],a,i,l={name:""},c="",d=0,f,p,g={},y=[],v=r.dense?[]:{},_,b,N={value:""},k="",w=0,T=[],A=-1,F=-1,R={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,D={},I=[],G={},Y=0,ee=0,ie=[],re=1,se=1,B=[],z={Names:[]},U={},V=["",""],q=[],L={},M="",X=0,K=!1,Z=!1,J=0;for(pp.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=pp.exec(n);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"":_[1]==="/"?(R.e.c>=R.s.c&&R.e.r>=R.s.r?v["!ref"]=Dr(R):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=R.e.r&&(v["!fullref"]=v["!ref"],R.e.r=r.sheetRows-1,v["!ref"]=Dr(R)),I.length&&(v["!merges"]=I),ie.length&&(v["!rows"]=ie),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),y.push(f.name),g[f.name]=v,Z=!1):_[0].charAt(_[0].length-2)!=="/"&&(f=kr(_[0],!1),A=F=-1,R.s.r=R.s.c=1e7,R.e.r=R.e.c=0,v=r.dense?[]:{},I=[],ie=[],Z=!0);break;case"table-row-group":_[1]==="/"?--E:++E;break;case"table-row":case"":if(_[1]==="/"){A+=re,re=1;break}if(p=kr(_[0],!1),p.?A=p.-1:A==-1&&(A=0),re=+p["number-rows-repeated"]||1,re<10)for(J=0;J<re;++J)E>0&&(ie[A+J]={level:E});F=-1;break;case"covered-table-cell":_[1]!=="/"&&++F,r.sheetStubs&&(r.dense?(v[A]||(v[A]=[]),v[A][F]={t:"z"}):v[br({r:A,c:F})]={t:"z"}),k="",T=[];break;case"table-cell":case"":if(_[0].charAt(_[0].length-2)==="/")++F,N=kr(_[0],!1),se=parseInt(N["number-columns-repeated"]||"1",10),b={t:"z",v:null},N.formula&&r.cellFormula!=!1&&(b.f=d3(Qr(N.formula))),(N.||N["value-type"])=="string"&&(b.t="s",b.v=Qr(N["string-value"]||""),r.dense?(v[A]||(v[A]=[]),v[A][F]=b):v[br({r:A,c:F})]=b),F+=se-1;else if(_[1]!=="/"){++F,k="",w=0,T=[],se=1;var ne=re?A+re-1:A;if(F>R.e.c&&(R.e.c=F),F<R.s.c&&(R.s.c=F),A<R.s.r&&(R.s.r=A),ne>R.e.r&&(R.e.r=ne),N=kr(_[0],!1),q=[],L={},b={t:N.||N["value-type"],v:null},r.cellFormula)if(N.formula&&(N.formula=Qr(N.formula)),N["number-matrix-columns-spanned"]&&N["number-matrix-rows-spanned"]&&(Y=parseInt(N["number-matrix-rows-spanned"],10)||0,ee=parseInt(N["number-matrix-columns-spanned"],10)||0,G={s:{r:A,c:F},e:{r:A+Y-1,c:F+ee-1}},b.F=Dr(G),B.push([G,b.F])),N.formula)b.f=d3(N.formula);else for(J=0;J<B.length;++J)A>=B[J][0].s.r&&A<=B[J][0].e.r&&F>=B[J][0].s.c&&F<=B[J][0].e.c&&(b.F=B[J][1]);switch((N["number-columns-spanned"]||N["number-rows-spanned"])&&(Y=parseInt(N["number-rows-spanned"],10)||0,ee=parseInt(N["number-columns-spanned"],10)||0,G={s:{r:A,c:F},e:{r:A+Y-1,c:F+ee-1}},I.push(G)),N["number-columns-repeated"]&&(se=parseInt(N["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=Ln(N["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(N.value);break;case"percentage":b.t="n",b.v=parseFloat(N.value);break;case"currency":b.t="n",b.v=parseFloat(N.value);break;case"date":b.t="d",b.v=Wn(N["date-value"]),r.cellDates||(b.t="n",b.v=Xs(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=AH(N["time-value"])/86400,r.cellDates&&(b.t="d",b.v=av(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(N.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",N["string-value"]!=null&&(k=Qr(N["string-value"]),T=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(K=!1,b.t==="s"&&(b.v=k||"",T.length&&(b.R=T),K=w==0),U.Target&&(b.l=U),q.length>0&&(b.c=q,q=[]),k&&r.cellText!==!1&&(b.w=k),K&&(b.t="z",delete b.v),(!K||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=A))for(var me=0;me<re;++me){if(se=parseInt(N["number-columns-repeated"]||"1",10),r.dense)for(v[A+me]||(v[A+me]=[]),v[A+me][F]=me==0?b:zn(b);--se>0;)v[A+me][F+se]=zn(b);else for(v[br({r:A+me,c:F})]=b;--se>0;)v[br({r:A+me,c:F+se})]=zn(b);R.e.c<=F&&(R.e.c=F)}se=parseInt(N["number-columns-repeated"]||"1",10),F+=se-1,se=0,b={},k="",T=[]}U={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((a=s.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&s.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((a=s.pop())[0]!==_[3])throw"Bad state: "+a;L.t=k,T.length&&(L.R=T),L.a=M,q.push(L)}else _[0].charAt(_[0].length-2)!=="/"&&s.push([_[3],!1]);M="",X=0,k="",w=0,T=[];break;case"creator":_[1]==="/"?M=n.slice(X,_.index):X=_.index+_[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((a=s.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&s.push([_[3],!1]);k="",w=0,T=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(D[l.name]=c,(a=s.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&(c="",l=kr(_[0],!1),s.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=kr(_[0],!1),c+=p3[_[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=kr(_[0],!1),c+=p3[_[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(d,_.index);break}else d=_.index+_[0].length;break;case"named-range":i=kr(_[0],!1),V=qw(i["cell-range-address"]);var xe={Name:i.name,Ref:V[0]+"!"+V[1]};Z&&(xe.Sheet=y.length),z.Names.push(xe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(_[1]==="/"&&(!N||!N["string-value"])){var Ne=rte(n.slice(w,_.index));k=(k.length>0?k+`
`:"")+Ne[0]}else kr(_[0],!1),w=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{V=qw(kr(_[0])["target-range-address"]),g[V[0]]["!autofilter"]={ref:V[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(U=kr(_[0],!1),!U.href)break;U.Target=Qr(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(V=qw(U.Target.slice(1)),U.Target="#"+V[0]+"!"+V[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(_)}}var le={Sheets:g,SheetNames:y,Workbook:z};return r.bookSheets&&delete le.Sheets,le}function x3(e,t){t=t||{},xo(e,"META-INF/manifest.xml")&&AG(Ds(e,"META-INF/manifest.xml"),t);var r=Vi(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=eP(kn(r),t);return xo(e,"meta.xml")&&(n.Props=H8(Ds(e,"meta.xml"))),n}function y3(e,t){return eP(e,t)}var nte=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+mp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Es+t}})(),v3=(function(){var e=function(a){return yn(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,l){var c=[];c.push('      <table:table table:name="'+yn(i.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,f=0,p=Pi(a["!ref"]||"A1"),g=a["!merges"]||[],y=0,v=Array.isArray(a);if(a["!cols"])for(f=0;f<=p.e.c;++f)c.push("        <table:table-column"+(a["!cols"][f]?' table:style-name="co'+a["!cols"][f].ods+'"':"")+`></table:table-column>
`);var _="",b=a["!rows"]||[];for(d=0;d<p.s.r;++d)_=b[d]?' table:style-name="ro'+b[d].ods+'"':"",c.push("        <table:table-row"+_+`></table:table-row>
`);for(;d<=p.e.r;++d){for(_=b[d]?' table:style-name="ro'+b[d].ods+'"':"",c.push("        <table:table-row"+_+`>
`),f=0;f<p.s.c;++f)c.push(t);for(;f<=p.e.c;++f){var N=!1,k={},w="";for(y=0;y!=g.length;++y)if(!(g[y].s.c>f)&&!(g[y].s.r>d)&&!(g[y].e.c<f)&&!(g[y].e.r<d)){(g[y].s.c!=f||g[y].s.r!=d)&&(N=!0),k["table:number-columns-spanned"]=g[y].e.c-g[y].s.c+1,k["table:number-rows-spanned"]=g[y].e.r-g[y].s.r+1;break}if(N){c.push(r);continue}var T=br({r:d,c:f}),A=v?(a[d]||[])[f]:a[T];if(A&&A.f&&(k["table:formula"]=yn(SJ(A.f)),A.F&&A.F.slice(0,T.length)==T)){var F=Pi(A.F);k["table:number-matrix-columns-spanned"]=F.e.c-F.s.c+1,k["table:number-matrix-rows-spanned"]=F.e.r-F.s.r+1}if(!A){c.push(t);continue}switch(A.t){case"b":w=A.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=A.v?"true":"false";break;case"n":w=A.w||String(A.v||0),k["office:value-type"]="float",k["office:value"]=A.v||0;break;case"s":case"str":w=A.v==null?"":A.v,k["office:value-type"]="string";break;case"d":w=A.w||Wn(A.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=Wn(A.v).toISOString(),k["table:style-name"]="ce1";break;default:c.push(t);continue}var R=e(w);if(A.l&&A.l.Target){var E=A.l.Target;E=E.charAt(0)=="#"?"#"+kJ(E.slice(1)):E,E.charAt(0)!="#"&&!E.match(/^\w+:/)&&(E="../"+E),R=Wt("text:a",R,{"xlink:href":E.replace(/&/g,"&amp;")})}c.push("          "+Wt("table:table-cell",Wt("text:p",R,{}),k)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var l=0;i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var f=0;f<d["!cols"].length;++f)if(d["!cols"][f]){var p=d["!cols"][f];if(p.width==null&&p.wpx==null&&p.wch==null)continue;zu(p),p.ods=l;var g=d["!cols"][f].wpx+"px";a.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),a.push(`  </style:style>
`),++l}}});var c=0;i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var f=0;f<d["!rows"].length;++f)if(d["!rows"][f]){d["!rows"][f].ods=c;var p=d["!rows"][f].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,l){var c=[Es],d=mp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=mp({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+d+f+`>
`),c.push(z8().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),s(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var p=0;p!=i.SheetNames.length;++p)c.push(n(i.Sheets[i.SheetNames[p]],i,p));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function tP(e,t){if(t.bookType=="fods")return v3(e,t);var r=dS(),n="",s=[],a=[];return n="mimetype",Br(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Br(r,n,v3(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Br(r,n,nte(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Br(r,n,Es+z8()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Br(r,n,PG(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Br(r,n,jG(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function yf(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function x2(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):kn(Zu(e))}function ste(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Gi(Pl(e))}function ate(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Gu(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function w3(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function ite(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function ote(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function Sp(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function mn(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function hs(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function tn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=Sp(e,r),a=s&7;s=Math.floor(s/8);var i=0,l;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:i=4,l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Sp(e,r),l=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var d={data:l,type:a};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function _a(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(mn(n*8+s.type)),s.type==2&&t.push(mn(s.data.length)),t.push(s.data))})}),Gu(t)}function LS(e,t){return e?.map(function(r){return t(r.data)})||[]}function go(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=Sp(e,n),a=tn(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:hs(a[1][0].data),messages:[]};a[2].forEach(function(l){var c=tn(l.data),d=hs(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=a[3])!=null&&t[0]&&(i.merge=hs(a[3][0].data)>>>0>0),r.push(i)}return r}function Ah(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:mn(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:mn(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:mn(i.data.length)}],n[2].push({data:_a(i.meta),type:2})});var a=_a(n);t.push(mn(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),Gu(t)}function lte(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Sp(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var l=i-59;i=t[r[0]],l>1&&(i|=t[r[0]+1]<<8),l>2&&(i|=t[r[0]+2]<<16),l>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=l}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,d=0;if(a==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Gu(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(s.push(s[0].slice(-c)),d-=c;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-c,-c+d))}}var f=Gu(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function mo(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(lte(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Gu(t)}function jh(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=mn(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Gu(t)}function cte(e,t,r,n){var s=yf(e),a=s.getUint32(4,!0),i=(n>1?12:8)+w3(a&(n>1?3470:398))*4,l=-1,c=-1,d=NaN,f=new Date(2001,0,1);a&512&&(l=s.getUint32(i,!0),i+=4),i+=w3(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(d=s.getFloat64(i,!0),i+=8),a&64&&(f.setTime(f.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:d};break;case 3:p={t:"s",v:t[c]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(l>-1)p={t:"s",v:r[l]};else if(c>-1)p={t:"s",v:t[c]};else if(!isNaN(d))p={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function ute(e,t,r){var n=yf(e),s=n.getUint32(8,!0),a=12,i=-1,l=-1,c=NaN,d=NaN,f=new Date(2001,0,1);s&1&&(c=ite(e,a),a+=16),s&2&&(d=n.getFloat64(a,!0),a+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(l=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:c};break;case 3:p={t:"s",v:t[l]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(i>-1)p={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return p}function Yw(e,t){var r=new Uint8Array(32),n=yf(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,ote(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function Jw(e,t){var r=new Uint8Array(32),n=yf(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function dte(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return cte(e,t,r,e[0]);case 5:return ute(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ba(e){var t=tn(e);return Sp(t[1][0].data)}function _3(e,t){var r=tn(t.data),n=hs(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var l=tn(i.data),c=hs(l[1][0].data)>>>0;switch(n){case 1:a[c]=x2(l[3][0].data);break;case 8:{var d=e[Ba(l[9][0].data)][0],f=tn(d.data),p=e[Ba(f[1][0].data)][0],g=hs(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var y=tn(p.data);a[c]=y[3].map(function(v){return x2(v.data)}).join("")}break}}),a}function fte(e,t){var r,n,s,a,i,l,c,d,f,p,g,y,v,_,b=tn(e),N=hs(b[1][0].data)>>>0,k=hs(b[2][0].data)>>>0,w=((n=(r=b[8])==null?void 0:r[0])==null?void 0:n.data)&&hs(b[8][0].data)>0||!1,T,A;if((a=(s=b[7])==null?void 0:s[0])!=null&&a.data&&t!=0)T=(l=(i=b[7])==null?void 0:i[0])==null?void 0:l.data,A=(d=(c=b[6])==null?void 0:c[0])==null?void 0:d.data;else if((p=(f=b[4])==null?void 0:f[0])!=null&&p.data&&t!=1)T=(y=(g=b[4])==null?void 0:g[0])==null?void 0:y.data,A=(_=(v=b[3])==null?void 0:v[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var F=w?4:1,R=yf(T),E=[],D=0;D<T.length/2;++D){var I=R.getUint16(D*2,!0);I<65535&&E.push([D,I])}if(E.length!=k)throw"Expected ".concat(k," cells, found ").concat(E.length);var G=[];for(D=0;D<E.length-1;++D)G[E[D][0]]=A.subarray(E[D][1]*F,E[D+1][1]*F);return E.length>=1&&(G[E[E.length-1][0]]=A.subarray(E[E.length-1][1]*F)),{R:N,cells:G}}function hte(e,t){var r,n=tn(t.data),s=(r=n?.[7])!=null&&r[0]?hs(n[7][0].data)>>>0>0?1:0:-1,a=LS(n[5],function(i){return fte(i,s)});return{nrows:hs(n[4][0].data)>>>0,data:a.reduce(function(i,l){return i[l.R]||(i[l.R]=[]),l.cells.forEach(function(c,d){if(i[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));i[l.R][d]=c}),i},[])}}function gte(e,t,r){var n,s=tn(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(hs(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(hs(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Dr(a);var i=tn(s[4][0].data),l=_3(e,e[Ba(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?_3(e,e[Ba(i[17][0].data)][0]):[],d=tn(i[3][0].data),f=0;d[1].forEach(function(p){var g=tn(p.data),y=e[Ba(g[2][0].data)][0],v=hs(y.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var _=hte(e,y);_.data.forEach(function(b,N){b.forEach(function(k,w){var T=br({r:f+N,c:w}),A=dte(k,l,c);A&&(r[T]=A)})}),f+=_.nrows})}function mte(e,t){var r=tn(t.data),n={"!ref":"A1"},s=e[Ba(r[2][0].data)],a=hs(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return gte(e,s[0],n),n}function pte(e,t){var r,n=tn(t.data),s={name:(r=n[1])!=null&&r[0]?x2(n[1][0].data):"",sheets:[]},a=LS(n[2],Ba);return a.forEach(function(i){e[i].forEach(function(l){var c=hs(l.meta[1][0].data);c==6e3&&s.sheets.push(mte(e,l))})}),s}function xte(e,t){var r=zS(),n=tn(t.data),s=LS(n[1],Ba);if(s.forEach(function(a){e[a].forEach(function(i){var l=hs(i.meta[1][0].data);if(l==2){var c=pte(e,i);c.sheets.forEach(function(d,f){HS(r,d,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Qw(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=mo(c.content)}catch(p){return console.log("?? "+c.content.length+" "+(p.message||p))}var f;try{f=go(d)}catch(p){return console.log("## "+(p.message||p))}f.forEach(function(p){a[p.id]=p.messages,i.push(p.id)})}}),!i.length)throw new Error("File has no messages");var l=((s=(n=(r=(t=a?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&hs(a[1][0].meta[1][0].data)==1&&a[1][0];if(l||i.forEach(function(c){a[c].forEach(function(d){var f=hs(d.meta[1][0].data)>>>0;if(f==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return xte(a,l)}function yte(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&hs(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,d=yf(e[7][0].data),f=0,p=[],g=yf(e[4][0].data),y=0,v=[],_=0;_<t.length;++_){if(t[_]==null){d.setUint16(_*2,65535,!0),g.setUint16(_*2,65535);continue}d.setUint16(_*2,f,!0),g.setUint16(_*2,y,!0);var b,N;switch(typeof t[_]){case"string":b=Yw({t:"s",v:t[_]},r),N=Jw({t:"s",v:t[_]},r);break;case"number":b=Yw({t:"n",v:t[_]},r),N=Jw({t:"n",v:t[_]},r);break;case"boolean":b=Yw({t:"b",v:t[_]},r),N=Jw({t:"b",v:t[_]},r);break;default:throw new Error("Unsupported value "+t[_])}p.push(b),f+=b.length,v.push(N),y+=N.length,++c}for(e[2][0].data=mn(c);_<e[7][0].data.length/2;++_)d.setUint16(_*2,65535,!0),g.setUint16(_*2,65535,!0);return e[6][0].data=Gu(p),e[3][0].data=Gu(v),c}function vte(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Pi(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Dr(n)));var a=T1(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(M){return M.forEach(function(X){typeof X=="string"&&i.push(X)})});var l={},c=[],d=gr.read(t.numbers,{type:"base64"});d.FileIndex.map(function(M,X){return[M,d.FullPaths[X]]}).forEach(function(M){var X=M[0],K=M[1];if(X.type==2&&X.name.match(/\.iwa/)){var Z=X.content,J=mo(Z),ne=go(J);ne.forEach(function(me){c.push(me.id),l[me.id]={deps:[],location:K,type:hs(me.messages[0].meta[1][0].data)}})}}),c.sort(function(M,X){return M-X});var f=c.filter(function(M){return M>1}).map(function(M){return[M,mn(M)]});d.FileIndex.map(function(M,X){return[M,d.FullPaths[X]]}).forEach(function(M){var X=M[0];if(M[1],!!X.name.match(/\.iwa/)){var K=go(mo(X.content));K.forEach(function(Z){Z.messages.forEach(function(J){f.forEach(function(ne){Z.messages.some(function(me){return hs(me.meta[1][0].data)!=11006&&ate(me.data,ne[1])})&&l[ne[0]].deps.push(Z.id)})})})}});for(var p=gr.find(d,l[1].location),g=go(mo(p.content)),y,v=0;v<g.length;++v){var _=g[v];_.id==1&&(y=_)}var b=Ba(tn(y.messages[0].data)[1][0].data);for(p=gr.find(d,l[b].location),g=go(mo(p.content)),v=0;v<g.length;++v)_=g[v],_.id==b&&(y=_);for(b=Ba(tn(y.messages[0].data)[2][0].data),p=gr.find(d,l[b].location),g=go(mo(p.content)),v=0;v<g.length;++v)_=g[v],_.id==b&&(y=_);for(b=Ba(tn(y.messages[0].data)[2][0].data),p=gr.find(d,l[b].location),g=go(mo(p.content)),v=0;v<g.length;++v)_=g[v],_.id==b&&(y=_);var N=tn(y.messages[0].data);{N[6][0].data=mn(n.e.r+1),N[7][0].data=mn(n.e.c+1);var k=Ba(N[46][0].data),w=gr.find(d,l[k].location),T=go(mo(w.content));{for(var A=0;A<T.length&&T[A].id!=k;++A);if(T[A].id!=k)throw"Bad ColumnRowUIDMapArchive";var F=tn(T[A].messages[0].data);F[1]=[],F[2]=[],F[3]=[];for(var R=0;R<=n.e.c;++R){var E=[];E[1]=E[2]=[{type:0,data:mn(R+420690)}],F[1].push({type:2,data:_a(E)}),F[2].push({type:0,data:mn(R)}),F[3].push({type:0,data:mn(R)})}F[4]=[],F[5]=[],F[6]=[];for(var D=0;D<=n.e.r;++D)E=[],E[1]=E[2]=[{type:0,data:mn(D+726270)}],F[4].push({type:2,data:_a(E)}),F[5].push({type:0,data:mn(D)}),F[6].push({type:0,data:mn(D)});T[A].messages[0].data=_a(F)}w.content=jh(Ah(T)),w.size=w.content.length,delete N[46];var I=tn(N[4][0].data);{I[7][0].data=mn(n.e.r+1);var G=tn(I[1][0].data),Y=Ba(G[2][0].data);w=gr.find(d,l[Y].location),T=go(mo(w.content));{if(T[0].id!=Y)throw"Bad HeaderStorageBucket";var ee=tn(T[0].messages[0].data);for(D=0;D<a.length;++D){var ie=tn(ee[2][0].data);ie[1][0].data=mn(D),ie[4][0].data=mn(a[D].length),ee[2][D]={type:ee[2][0].type,data:_a(ie)}}T[0].messages[0].data=_a(ee)}w.content=jh(Ah(T)),w.size=w.content.length;var re=Ba(I[2][0].data);w=gr.find(d,l[re].location),T=go(mo(w.content));{if(T[0].id!=re)throw"Bad HeaderStorageBucket";for(ee=tn(T[0].messages[0].data),R=0;R<=n.e.c;++R)ie=tn(ee[2][0].data),ie[1][0].data=mn(R),ie[4][0].data=mn(n.e.r+1),ee[2][R]={type:ee[2][0].type,data:_a(ie)};T[0].messages[0].data=_a(ee)}w.content=jh(Ah(T)),w.size=w.content.length;var se=Ba(I[4][0].data);(function(){for(var M=gr.find(d,l[se].location),X=go(mo(M.content)),K,Z=0;Z<X.length;++Z){var J=X[Z];J.id==se&&(K=J)}var ne=tn(K.messages[0].data);{ne[3]=[];var me=[];i.forEach(function(le,ge){me[1]=[{type:0,data:mn(ge)}],me[2]=[{type:0,data:mn(1)}],me[3]=[{type:2,data:ste(le)}],ne[3].push({type:2,data:_a(me)})})}K.messages[0].data=_a(ne);var xe=Ah(X),Ne=jh(xe);M.content=Ne,M.size=M.content.length})();var B=tn(I[3][0].data);{var z=B[1][0];delete B[2];var U=tn(z.data);{var V=Ba(U[2][0].data);(function(){for(var M=gr.find(d,l[V].location),X=go(mo(M.content)),K,Z=0;Z<X.length;++Z){var J=X[Z];J.id==V&&(K=J)}var ne=tn(K.messages[0].data);{delete ne[6],delete B[7];var me=new Uint8Array(ne[5][0].data);ne[5]=[];for(var xe=0,Ne=0;Ne<=n.e.r;++Ne){var le=tn(me);xe+=yte(le,a[Ne],i),le[1][0].data=mn(Ne),ne[5].push({data:_a(le),type:2})}ne[1]=[{type:0,data:mn(n.e.c+1)}],ne[2]=[{type:0,data:mn(n.e.r+1)}],ne[3]=[{type:0,data:mn(xe)}],ne[4]=[{type:0,data:mn(n.e.r+1)}]}K.messages[0].data=_a(ne);var ge=Ah(X),Ue=jh(ge);M.content=Ue,M.size=M.content.length})()}z.data=_a(U)}I[3][0].data=_a(B)}N[4][0].data=_a(I)}y.messages[0].data=_a(N);var q=Ah(g),L=jh(q);return p.content=L,p.size=p.content.length,d}function rP(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function BS(e){rP([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function US(e){rP([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function wte(e){return Gr.WS.indexOf(e)>-1?"sheet":e==Gr.CS?"chart":e==Gr.DS?"dialog":e==Gr.MS?"macro":e&&e.length?e:"sheet"}function _te(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,wte(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function bte(e,t,r,n,s,a,i,l,c,d,f,p){try{a[n]=Wm(Vi(e,r,!0),t);var g=Ds(e,t),y;switch(l){case"sheet":y=HZ(g,t,s,c,a[n],d,f,p);break;case"chart":if(y=GZ(g,t,s,c,a[n],d,f,p),!y||!y["!drawel"])break;var v=Nm(y["!drawel"].Target,t),_=xp(v),b=FX(Vi(e,v,!0),Wm(Vi(e,_,!0),v)),N=Nm(b,v),k=xp(N);y=yZ(Vi(e,N,!0),N,c,Wm(Vi(e,k,!0),N),d,y);break;case"macro":y=VZ(g,t,s,c,a[n],d,f,p);break;case"dialog":y=KZ(g,t,s,c,a[n],d,f,p);break;default:throw new Error("Unrecognized sheet type "+l)}i[n]=y;var w=[];a&&a[n]&&gs(a[n]).forEach(function(T){var A="";if(a[n][T].Type==Gr.CMNT){A=Nm(a[n][T].Target,t);var F=JZ(Ds(e,A,!0),A,c);if(!F||!F.length)return;i3(y,F,!1)}a[n][T].Type==Gr.TCMNT&&(A=Nm(a[n][T].Target,t),w=w.concat(RX(Ds(e,A,!0),c)))}),w&&w.length&&i3(y,w,!0,c.people||[])}catch(T){if(c.WTF)throw T}}function fo(e){return e.charAt(0)=="/"?e.slice(1):e}function Ste(e,t){if(D0(),t=t||{},BS(t),xo(e,"META-INF/manifest.xml")||xo(e,"objectdata.xml"))return x3(e,t);if(xo(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Qw<"u"){if(e.FileIndex)return Qw(e);var r=gr.utils.cfb_new();return EN(e).forEach(function(ie){Br(r,ie,DH(e,ie))}),Qw(r)}throw new Error("Unsupported NUMBERS file")}if(!xo(e,"[Content_Types].xml"))throw xo(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):xo(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=EN(e),s=EG(Vi(e,"[Content_Types].xml")),a=!1,i,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",Ds(e,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!Ds(e,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(zm=[],s.sst)try{zm=YZ(Ds(e,fo(s.sst)),s.sst,t)}catch(ie){if(t.WTF)throw ie}t.cellStyles&&s.themes.length&&(c=XZ(Vi(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=qZ(Ds(e,fo(s.style)),s.style,c,t))}s.links.map(function(ie){try{var re=Wm(Vi(e,xp(fo(ie))),ie);return ZZ(Ds(e,fo(ie)),re,ie,t)}catch{}});var f=zZ(Ds(e,fo(s.workbooks[0])),s.workbooks[0],t),p={},g="";s.coreprops.length&&(g=Ds(e,fo(s.coreprops[0]),!0),g&&(p=H8(g)),s.extprops.length!==0&&(g=Ds(e,fo(s.extprops[0]),!0),g&&DG(g,p,t)));var y={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(g=Vi(e,fo(s.custprops[0]),!0),g&&(y=MG(g,t)));var v={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(re){return re.name}):p.Worksheets&&p.SheetNames.length>0&&(i=p.SheetNames),t.bookProps&&(v.Props=p,v.Custprops=y),t.bookSheets&&typeof i<"u"&&(v.SheetNames=i),t.bookSheets?v.SheetNames:t.bookProps))return v;i={};var _={};t.bookDeps&&s.calcchain&&(_=QZ(Ds(e,fo(s.calcchain)),s.calcchain));var b=0,N={},k,w;{var T=f.Sheets;p.Worksheets=T.length,p.SheetNames=[];for(var A=0;A!=T.length;++A)p.SheetNames[A]=T[A].name}var F=a?"bin":"xml",R=s.workbooks[0].lastIndexOf("/"),E=(s.workbooks[0].slice(0,R+1)+"_rels/"+s.workbooks[0].slice(R+1)+".rels").replace(/^\//,"");xo(e,E)||(E="xl/_rels/workbook."+F+".rels");var D=Wm(Vi(e,E,!0),E.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=eee(Ds(e,fo(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=IX(Ds(e,fo(s.people[0])),t)),D&&(D=_te(D,f.Sheets));var I=Ds(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=p.Worksheets;++b){var G="sheet";if(D&&D[b]?(k="xl/"+D[b][1].replace(/[\/]?xl\//,""),xo(e,k)||(k=D[b][1]),xo(e,k)||(k=E.replace(/_rels\/.*$/,"")+D[b][1]),G=D[b][2]):(k="xl/worksheets/sheet"+(b+1-I)+"."+F,k=k.replace(/sheet0\./,"sheet.")),w=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(p.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Y=!1,ee=0;ee!=t.sheets.length;++ee)typeof t.sheets[ee]=="number"&&t.sheets[ee]==b&&(Y=1),typeof t.sheets[ee]=="string"&&t.sheets[ee].toLowerCase()==p.SheetNames[b].toLowerCase()&&(Y=1);if(!Y)continue e}}bte(e,k,w,p.SheetNames[b],b,N,i,G,t,f,c,d)}return v={Directory:s,Workbook:f,Props:p,Custprops:y,Deps:_,Sheets:i,SheetNames:p.SheetNames,Strings:zm,Styles:d,Themes:c,SSF:zn(wr)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(ie,re){ie=ie.replace(/^Root Entry[\/]/,""),v.keys.push(ie),v.files[ie]=e.FileIndex[re]}))),t&&t.bookVBA&&(s.vba.length>0?v.vbaraw=Ds(e,fo(s.vba[0]),!0):s.defaults&&s.defaults.bin===zX&&(v.vbaraw=Ds(e,"xl/vbaProject.bin",!0))),v}function kte(e,t){var r=t||{},n="Workbook",s=gr.find(e,n);try{if(n="/!DataSpaces/Version",s=gr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(eq(s.content),n="/!DataSpaces/DataSpaceMap",s=gr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=rq(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=gr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=nq(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=gr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);aq(s.content)}catch{}if(n="/EncryptionInfo",s=gr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=iq(s.content);if(n="/EncryptedPackage",s=gr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Cte(e,t){return t.bookType=="ods"?tP(e,t):t.bookType=="numbers"?vte(e,t):t.bookType=="xlsb"?Tte(e,t):Ete(e,t)}function Tte(e,t){Kh=1024,e&&!e.SSF&&(e.SSF=zn(wr)),e&&e.SSF&&(D0(),rv(e.SSF),t.revssf=sv(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hm?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=AF.indexOf(t.bookType)>-1,s=CS();US(t=t||{});var a=dS(),i="",l=0;if(t.cellXfs=[],td(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Br(a,i,G8(e.Props,t)),s.coreprops.push(i),xn(t.rels,2,i,Gr.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Br(a,i,q8(e.Props)),s.extprops.push(i),xn(t.rels,3,i,Gr.EXT_PROPS),e.Custprops!==e.Props&&gs(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Br(a,i,X8(e.Custprops)),s.custprops.push(i),xn(t.rels,4,i,Gr.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},p=e.Sheets[e.SheetNames[l-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,Br(a,i,ree(l-1,i,t,e,f)),s.sheets.push(i),xn(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Gr.WS[0])}if(p){var y=p["!comments"],v=!1,_="";y&&y.length>0&&(_="xl/comments"+l+"."+r,Br(a,_,aee(y,_)),s.comments.push(_),xn(f,-1,"../comments"+l+"."+r,Gr.CMNT),v=!0),p["!legacy"]&&v&&Br(a,"xl/drawings/vmlDrawing"+l+".vml",EF(l,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&Br(a,xp(i),r0(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Br(a,i,see(t.Strings,i,t)),s.strs.push(i),xn(t.wbrels,-1,"sharedStrings."+r,Gr.SST)),i="xl/workbook."+r,Br(a,i,tee(e,i)),s.workbooks.push(i),xn(t.rels,1,i,Gr.WB),i="xl/theme/theme1.xml",Br(a,i,FS(e.Themes,t)),s.themes.push(i),xn(t.wbrels,-1,"theme/theme1.xml",Gr.THEME),i="xl/styles."+r,Br(a,i,nee(e,i,t)),s.styles.push(i),xn(t.wbrels,-1,"styles."+r,Gr.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Br(a,i,e.vbaraw),s.vba.push(i),xn(t.wbrels,-1,"vbaProject.bin",Gr.VBA)),i="xl/metadata."+r,Br(a,i,iee(i)),s.metadata.push(i),xn(t.wbrels,-1,"metadata."+r,Gr.XLMETA),Br(a,"[Content_Types].xml",W8(s,t)),Br(a,"_rels/.rels",r0(t.rels)),Br(a,"xl/_rels/workbook."+r+".rels",r0(t.wbrels)),delete t.revssf,delete t.ssf,a}function Ete(e,t){Kh=1024,e&&!e.SSF&&(e.SSF=zn(wr)),e&&e.SSF&&(D0(),rv(e.SSF),t.revssf=sv(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hm?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=AF.indexOf(t.bookType)>-1,s=CS();US(t=t||{});var a=dS(),i="",l=0;if(t.cellXfs=[],td(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Br(a,i,G8(e.Props,t)),s.coreprops.push(i),xn(t.rels,2,i,Gr.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Br(a,i,q8(e.Props)),s.extprops.push(i),xn(t.rels,3,i,Gr.EXT_PROPS),e.Custprops!==e.Props&&gs(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Br(a,i,X8(e.Custprops)),s.custprops.push(i),xn(t.rels,4,i,Gr.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var p={"!id":{}},g=e.Sheets[e.SheetNames[l-1]],y=(g||{})["!type"]||"sheet";switch(y){case"chart":default:i="xl/worksheets/sheet"+l+"."+r,Br(a,i,UF(l-1,t,e,p)),s.sheets.push(i),xn(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Gr.WS[0])}if(g){var v=g["!comments"],_=!1,b="";if(v&&v.length>0){var N=!1;v.forEach(function(k){k[1].forEach(function(w){w.T==!0&&(N=!0)})}),N&&(b="xl/threadedComments/threadedComment"+l+"."+r,Br(a,b,DX(v,f,t)),s.threadedcomments.push(b),xn(p,-1,"../threadedComments/threadedComment"+l+"."+r,Gr.TCMNT)),b="xl/comments"+l+"."+r,Br(a,b,NF(v)),s.comments.push(b),xn(p,-1,"../comments"+l+"."+r,Gr.CMNT),_=!0}g["!legacy"]&&_&&Br(a,"xl/drawings/vmlDrawing"+l+".vml",EF(l,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&Br(a,xp(i),r0(p))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Br(a,i,mF(t.Strings,t)),s.strs.push(i),xn(t.wbrels,-1,"sharedStrings."+r,Gr.SST)),i="xl/workbook."+r,Br(a,i,GF(e)),s.workbooks.push(i),xn(t.rels,1,i,Gr.WB),i="xl/theme/theme1.xml",Br(a,i,FS(e.Themes,t)),s.themes.push(i),xn(t.wbrels,-1,"theme/theme1.xml",Gr.THEME),i="xl/styles."+r,Br(a,i,SF(e,t)),s.styles.push(i),xn(t.wbrels,-1,"styles."+r,Gr.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Br(a,i,e.vbaraw),s.vba.push(i),xn(t.wbrels,-1,"vbaProject.bin",Gr.VBA)),i="xl/metadata."+r,Br(a,i,TF()),s.metadata.push(i),xn(t.wbrels,-1,"metadata."+r,Gr.XLMETA),f.length>1&&(i="xl/persons/person.xml",Br(a,i,MX(f)),s.people.push(i),xn(t.wbrels,-1,"persons/person.xml",Gr.PEOPLE)),Br(a,"[Content_Types].xml",W8(s,t)),Br(a,"_rels/.rels",r0(t.rels)),Br(a,"xl/_rels/workbook."+r+".rels",r0(t.wbrels)),delete t.revssf,delete t.ssf,a}function $S(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=qi(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Nte(e,t){return gr.find(e,"EncryptedPackage")?kte(e,t):XF(e,t)}function Ate(e,t){var r,n=e,s=t||{};return s.type||(s.type=Ur&&Buffer.isBuffer(e)?"buffer":"base64"),r=x8(n,s),Ste(r,s)}function nP(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return m2(e.slice(r),t);default:break e}return m0.to_workbook(e,t)}function jte(e,t){var r="",n=$S(e,t);switch(t.type){case"base64":r=qi(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=gf(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=kn(r)),t.type="binary",nP(r,t)}function Fte(e,t){var r=e;return t.type=="base64"&&(r=qi(r)),r=dp.utils.decode(1200,r.slice(2),"str"),t.type="binary",nP(r,t)}function Pte(e){return e.match(/[^\x00-\x7F]/)?Pl(e):e}function Zw(e,t,r,n){return n?(r.type="string",m0.to_workbook(e,r)):m0.to_workbook(t,r)}function y2(e,t){iS();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return y2(new Uint8Array(e),(r=zn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),s0={},r.dateNF&&(s0.dateNF=r.dateNF),r.type||(r.type=Ur&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ur?"buffer":"binary",n=TH(e),typeof Uint8Array<"u"&&!Ur&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=Pte(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),l=new Uint8Array(i);if(l.foo="bar",!l.foo)return r=zn(r),r.type="array",y2(oS(n),r)}switch((s=$S(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Nte(gr.read(n,r),r);break;case 9:if(s[1]<=8)return XF(n,r);break;case 60:return m2(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return OK(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return hF.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Ate(n,r):Zw(e,n,r,a);case 239:return s[3]===60?m2(n,r):Zw(e,n,r,a);case 255:if(s[1]===254)return Fte(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Yd.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Yd.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return g2.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return wF.to_workbook(n,r);break;case 10:case 13:case 32:return jte(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return MK.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?g2.to_workbook(n,r):Zw(e,n,r,a)}function sP(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return qp(t.file,gr.write(e,{type:Ur?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return gr.write(e,t)}function Rte(e,t){var r=zn(t||{}),n=Cte(e,r);return Dte(n,r)}function Dte(e,t){var r={},n=Ur?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?gr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(tv(s))}return t.password&&typeof encrypt_agile<"u"?sP(encrypt_agile(s,t.password),t):t.type==="file"?qp(t.file,s):t.type=="string"?kn(s):s}function Ite(e,t){var r=t||{},n=Pee(e,r);return sP(n,r)}function Tl(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return fp(Pl(n));case"binary":return Pl(n);case"string":return e;case"file":return qp(t.file,n,"utf8");case"buffer":return Ur?Ic(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Tl(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Mte(e,t){switch(t.type){case"base64":return fp(e);case"binary":return e;case"string":return e;case"file":return qp(t.file,e,"binary");case"buffer":return Ur?Ic(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ny(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?fp(r):t.type=="string"?kn(r):r;case"file":return qp(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function aP(e,t){iS(),NZ(e);var r=zn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=aP(e,r);return r.type="array",tv(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Tl(Cee(e,r),r);case"slk":case"sylk":return Tl(fF.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Tl(JF(e.Sheets[e.SheetNames[s]],r),r);case"txt":return Mte(iP(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Tl(WS(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Tl(hF.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Ny(g2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Tl(m0.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Tl(wF.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Tl(gF.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Tl(tP(e,r),r);case"wk1":return Ny(Yd.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Ny(Yd.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Ny(YF(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Ite(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Rte(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Ote(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Lte(e,t,r){var n={};return n.type="file",n.file=t,Ote(n),aP(e,n)}function Bte(e,t,r,n,s,a,i,l){var c=Cs(r),d=l.defval,f=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),p=!0,g=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!i||e[r])for(var y=t.s.c;y<=t.e.c;++y){var v=i?e[r][y]:e[n[y]+c];if(v===void 0||v.t===void 0){if(d===void 0)continue;a[y]!=null&&(g[a[y]]=d);continue}var _=v.v;switch(v.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[y]!=null){if(_==null)if(v.t=="e"&&_===null)g[a[y]]=null;else if(d!==void 0)g[a[y]]=d;else if(f&&_===null)g[a[y]]=null;else continue;else g[a[y]]=f&&(v.t!=="n"||v.t==="n"&&l.rawNumbers!==!1)?_:Pc(v,_,l);_!=null&&(p=!1)}}return{row:g,isempty:p}}function T1(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},f=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof f){case"string":c=Zr(f);break;case"number":c=Zr(e["!ref"]),c.s.r=f;break;default:c=f}n>0&&(s=0);var p=Cs(c.s.r),g=[],y=[],v=0,_=0,b=Array.isArray(e),N=c.s.r,k=0,w={};b&&!e[N]&&(e[N]=[]);var T=d.skipHidden&&e["!cols"]||[],A=d.skipHidden&&e["!rows"]||[];for(k=c.s.c;k<=c.e.c;++k)if(!(T[k]||{}).hidden)switch(g[k]=es(k),r=b?e[N][k]:e[g[k]+p],n){case 1:a[k]=k-c.s.c;break;case 2:a[k]=g[k];break;case 3:a[k]=d.header[k-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=i=Pc(r,null,d),_=w[i]||0,!_)w[i]=1;else{do l=i+"_"+_++;while(w[l]);w[i]=_,w[l]=1}a[k]=l}for(N=c.s.r+s;N<=c.e.r;++N)if(!(A[N]||{}).hidden){var F=Bte(e,c,N,g,n,a,b,d);(F.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(y[v++]=F.row)}return y.length=v,y}var b3=/"/g;function Ute(e,t,r,n,s,a,i,l){for(var c=!0,d=[],f="",p=Cs(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var y=l.dense?(e[r]||[])[g]:e[n[g]+p];if(y==null)f="";else if(y.v!=null){c=!1,f=""+(l.rawNumbers&&y.t=="n"?y.v:Pc(y,null,l));for(var v=0,_=0;v!==f.length;++v)if((_=f.charCodeAt(v))===s||_===a||_===34||l.forceQuotes){f='"'+f.replace(b3,'""')+'"';break}f=="ID"&&(f='"ID"')}else y.f!=null&&!y.F?(c=!1,f="="+y.f,f.indexOf(",")>=0&&(f='"'+f.replace(b3,'""')+'"')):f="";d.push(f)}return l.blankrows===!1&&c?null:d.join(i)}function WS(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=Zr(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),d=new RegExp((a=="|"?"\\|":a)+"+$"),f="",p=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],y=n.skipHidden&&e["!rows"]||[],v=s.s.c;v<=s.e.c;++v)(g[v]||{}).hidden||(p[v]=es(v));for(var _=0,b=s.s.r;b<=s.e.r;++b)(y[b]||{}).hidden||(f=Ute(e,s,b,p,i,c,a,n),f!=null&&(n.strip&&(f=f.replace(d,"")),(f||n.blankrows!==!1)&&r.push((_++?l:"")+f)));return delete n.dense,r.join("")}function iP(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=WS(e,t);return r}function $te(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=Zr(e["!ref"]),a="",i=[],l,c=[],d=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)i[l]=es(l);for(var f=s.s.r;f<=s.e.r;++f)for(a=Cs(f),l=s.s.c;l<=s.e.c;++l)if(t=i[l]+a,r=d?(e[f]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function oP(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,l=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?ts(n.origin):n.origin;i=c.r,l=c.c}var d,f={s:{c:0,r:0},e:{c:l,r:i+t.length-1+s}};if(a["!ref"]){var p=Zr(a["!ref"]);f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),i==-1&&(i=p.e.r+1,f.e.r=i+t.length-1+s)}else i==-1&&(i=0,f.e.r=t.length-1+s);var g=n.header||[],y=0;t.forEach(function(_,b){gs(_).forEach(function(N){(y=g.indexOf(N))==-1&&(g[y=g.length]=N);var k=_[N],w="z",T="",A=br({c:l+y,r:i+b+s});d=kp(a,A),k&&typeof k=="object"&&!(k instanceof Date)?a[A]=k:(typeof k=="number"?w="n":typeof k=="boolean"?w="b":typeof k=="string"?w="s":k instanceof Date?(w="d",n.cellDates||(w="n",k=Xs(k)),T=n.dateNF||wr[14]):k===null&&n.nullError&&(w="e",k=0),d?(d.t=w,d.v=k,delete d.w,delete d.R,T&&(d.z=T)):a[A]=d={t:w,v:k},T&&(d.z=T))})}),f.e.c=Math.max(f.e.c,l+g.length-1);var v=Cs(i);if(s)for(y=0;y<g.length;++y)a[es(y+l)+v]={t:"s",v:g[y]};return a["!ref"]=Dr(f),a}function Wte(e,t){return oP(null,e,t)}function kp(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=ts(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?kp(e,br(t)):kp(e,br({r:t,c:r||0}))}function zte(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function zS(){return{SheetNames:[],Sheets:{}}}function HS(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(HF(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Hte(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=zte(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Gte(e,t){return e.z=t,e}function lP(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Vte(e,t,r){return lP(e,"#"+t,r)}function Kte(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function qte(e,t,r,n){for(var s=typeof t!="string"?t:Zr(t),a=typeof t=="string"?t:Dr(t),i=s.s.r;i<=s.e.r;++i)for(var l=s.s.c;l<=s.e.c;++l){var c=kp(e,i,l);c.t="n",c.F=a,delete c.v,i==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Ly={encode_col:es,encode_row:Cs,encode_cell:br,encode_range:Dr,decode_col:vS,decode_row:yS,split_cell:sG,decode_cell:ts,decode_range:Pi,format_cell:Pc,sheet_add_aoa:I8,sheet_add_json:oP,sheet_add_dom:QF,aoa_to_sheet:I0,json_to_sheet:Wte,table_to_sheet:ZF,table_to_book:ete,sheet_to_csv:WS,sheet_to_txt:iP,sheet_to_json:T1,sheet_to_html:JF,sheet_to_formulae:$te,sheet_to_row_object_array:T1,sheet_get_cell:kp,book_new:zS,book_append_sheet:HS,book_set_sheet_visibility:Hte,cell_set_number_format:Gte,cell_set_hyperlink:lP,cell_set_internal_link:Vte,cell_add_comment:Kte,sheet_set_array_formula:qte,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const cP=({onBackToCabinet:e,selectedGrade:t,selectedClass:r,openRetestModal:n})=>{Ri(),A1();const{user:s,isAuthenticated:a}=Hn(),{showNotification:i}=ja(),l=C.useCallback(ue=>{let Ce=null;if(typeof ue?.percentage=="number"&&!Number.isNaN(ue.percentage))return Ce=Math.round(ue.percentage),console.debug("[TeacherResults] Using provided percentage",{percentage:ue.percentage,rounded:Ce,result:ue}),Ce;const Oe=ue?.retest_best_score??ue?.score,Xe=ue?.retest_best_max_score??ue?.max_score,It=Number(Oe??0),ht=Number(Xe??0);return ht>0&&(Ce=Math.round(It/ht*100)),console.debug("[TeacherResults] Computed percentage",{score:ue?.score,max_score:ue?.max_score,retest_best_score:ue?.retest_best_score,retest_best_max_score:ue?.retest_best_max_score,derived:Ce,result:ue}),Ce},[]);C.useCallback(ue=>{const Ce=l(ue);return Ce===null?"bg-gray-100 text-gray-800":Ce<50?"bg-red-100 text-red-700":Ce<70?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"},[l]),C.useCallback(ue=>{const Ce=l(ue);return Ce!==null&&Ce<50},[l]);const[c,d]=C.useState(null),[f,p]=C.useState(!0),[g,y]=C.useState(""),[v,_]=C.useState([]),[b,N]=C.useState(null),[k,w]=C.useState(!1),[T,A]=C.useState([]),[F,R]=C.useState([]),[E,D]=C.useState([1,2]),[I,G]=C.useState(null),[Y,ee]=C.useState(null),[ie,re]=C.useState(null),[se,B]=C.useState("main"),[z,U]=C.useState(null),[V,q]=C.useState(null),L=z||t,M=V||r,[X,K]=C.useState(null),[Z,J]=C.useState({}),[ne,me]=C.useState(!1),[xe,Ne]=C.useState(new Set),[le,ge]=C.useState(!0),[Ue,Ge]=C.useState(!1),[Je,He]=C.useState(!1),Ft=C.useRef(null),[rt,Ie]=C.useState(null),[Pe,Qe]=C.useState(!1),[_t,gt]=C.useState(null),[Bt,Ut]=C.useState(!1),[it,Ye]=C.useState(null),[xt,ut]=C.useState(""),[wt,$t]=C.useState(""),[Kt,De]=C.useState(!1),[ct,mt]=C.useState(!1),[At,Lt]=C.useState(null),[rr,Ee]=C.useState(""),[we,fe]=C.useState(!1),[_e,$e]=C.useState(new Set),[St,pt]=C.useState({}),[Xt,Jt]=C.useState(!1),[Yt,pr]=C.useState(null),[Ir,xr]=C.useState(""),[Tr,Mr]=C.useState(!1),Wr=C.useRef(new Set),ce=C.useRef({}),Se=C.useRef(null);C.useEffect(()=>{console.log(" editingColumns state changed:",Array.from(_e)),Wr.current=_e},[_e]),C.useEffect(()=>{console.log(" columnScores state changed:",St),ce.current=St},[St]);const pe=C.useCallback(ue=>{console.log(" Toggling test collapse for:",ue),Ne(Ce=>{const Oe=new Set(Ce);return Oe.has(ue)?(Oe.delete(ue),console.log(" Expanding test:",ue)):(Oe.add(ue),console.log(" Collapsing test:",ue)),console.log(" New collapsed tests:",Array.from(Oe)),Oe})},[]),ve=C.useCallback(()=>{if(Ft.current){const{scrollLeft:ue,scrollWidth:Ce,clientWidth:Oe}=Ft.current;Ge(ue>0),He(ue<Ce-Oe-1)}},[]);C.useEffect(()=>{We()},[]),C.useEffect(()=>{if(I&&Ft.current){const ue=setTimeout(ve,100);return()=>clearTimeout(ue)}},[I,ve]),C.useEffect(()=>{console.log(" Current collapsed tests state:",Array.from(xe))},[xe]);const be=C.useCallback(async(ue,Ce,Oe)=>{console.log(" Loading class results for:",ue,Ce,Oe),me(!0);try{const Xe=`${ue}/${Ce}`;console.log(" Formatted class name:",Xe);let It=c;It||(console.log(" Teacher data not loaded, loading now..."),It=await Sn.getTeacherData(),d(It));const ht=s?.teacher_id;let fr=null,mr=Y;if(mr||(console.log(" Academic year data not loaded, loading now..."),mr=await oe()),mr&&Array.isArray(mr)&&mr.length>0){const jt=parseInt(Oe);console.log(" Looking for semester",jt,"in current academic year");const er=new Date,un=mr.find(Yn=>{const Lr=new Date(Yn.start_date),Nf=new Date(Yn.end_date);return er>=Lr&&er<=Nf}),Xn=un?un.academic_year:mr[0].academic_year;console.log(" Current academic year:",Xn);const Mn=mr.filter(Yn=>Yn.academic_year===Xn);console.log(" Current year periods:",Mn);const sr=Mn.filter(Yn=>parseInt(Yn.semester)===1),dn=Mn.filter(Yn=>parseInt(Yn.semester)===2);if(console.log(" Semester 1 periods:",sr),console.log(" Semester 2 periods:",dn),jt===1?(fr=sr[0]?.id,console.log(" Using semester 1 period:",sr[0])):jt===2&&(fr=dn[0]?.id,console.log(" Using semester 2 period:",dn[0])),!fr)throw new Error(`No ${jt===1?"Semester 1":"Semester 2"} data available for academic year ${Xn}`)}if(!ht||!fr)throw console.error(" Missing data:",{teacherId:ht,academicPeriodId:fr,academicYear:Y}),new Error("Missing teacher ID or academic period ID");const nt=await JW.getTeacherStudentResults(ht,ue,Xe,Oe,fr);if(console.log(" Class results response:",nt),nt.success){console.log(" API Response details:",{results:nt.results,students:nt.students,count:nt.count,student_count:nt.student_count});const jt=[],er=new Set,un=new Set;nt.results&&nt.results.length>0&&nt.results.forEach(sr=>{sr.test_name&&!er.has(sr.test_name)&&(er.add(sr.test_name),jt.push({test_name:sr.test_name,test_type:sr.test_type,subject:sr.subject})),sr.subject&&un.add(sr.subject)}),console.log(" RAW RESULTS DATA:",nt.results),console.log(" RAW STUDENTS DATA:",nt.students);const Xn=(nt.students||[]).map(sr=>{const dn={};return(nt.results||[]).filter(Lr=>(console.log(` Checking result ${Lr.id} for student ${sr.student_id}:`,{result_student_id:Lr.student_id,student_id:sr.student_id,match:Lr.student_id===sr.student_id,test_type:Lr.test_type}),Lr.student_id===sr.student_id)).forEach(Lr=>{console.log(` Mapping result ${Lr.id} (${Lr.test_type}) to student ${sr.student_id}:`,{test_name:Lr.test_name,test_type:Lr.test_type,score:Lr.score,answers:Lr.answers}),Lr.test_name&&(dn[Lr.test_name]={id:Lr.id,test_type:Lr.test_type,test_id:Lr.test_id,subject_id:Lr.subject_id,score:Lr.score,max_score:Lr.max_score,retest_offered:Lr.retest_offered,caught_cheating:Lr.caught_cheating,visibility_change_times:Lr.visibility_change_times,answers:Lr.answers,ai_feedback:Lr.ai_feedback,name:Lr.name,surname:Lr.surname,test_name:Lr.test_name},console.log(` MAPPED: ${Lr.test_name} -> student ${sr.student_id}:`,dn[Lr.test_name]))}),{...sr,...dn}}),Mn={results:nt.results||[],students:Xn,class:Xn,unique_tests:jt,subjects:Array.from(un),count:nt.count||0,student_count:nt.student_count||0};console.log(" Processed results data:",{uniqueTests:jt.length,subjects:Array.from(un),resultsCount:nt.results?.length||0,studentsWithScores:Xn.length,sampleStudent:Xn[0]}),G(Mn),J(Mn),re(new Date),nt.students&&nt.students.length>0?(console.log(" Student list loaded:",nt.students.length,"students"),console.log(" Sample student:",nt.students[0])):console.log(" No students found for this class")}else console.log(" API call failed for this class"),G(null),J(null)}catch(Xe){console.error(" Error loading class results:",Xe),i("Error loading class results","error"),G(null),J(null)}finally{me(!1)}},[c,s,Y,i]),ke=C.useCallback(async(ue,Ce)=>{console.log(" Determining current semester for:",ue,Ce);try{if(Y&&Y.length>0){const Oe=new Date;let Xe=1,It=null;for(const ht of Y){const fr=new Date(ht.start_date),mr=new Date(ht.end_date);if(console.log(" Checking period:",{period:ht,semester:ht.semester,semesterType:typeof ht.semester,startDate:fr,endDate:mr,currentDate:Oe,isInRange:Oe>=fr&&Oe<=mr}),Oe>=fr&&Oe<=mr){It=ht,Xe=ht.semester,console.log(" Found matching period:",{period:ht,semester:ht.semester,semesterType:typeof ht.semester});break}}if(It){console.log(" Current academic period found:",It),console.log(" Current semester:",Xe);const ht=Xe&&!isNaN(Xe)?Xe:1;console.log(" Using semester:",ht),N(ht),await be(ue,Ce,ht)}else console.log(" No current academic period found, using default semester 1"),N(1),await be(ue,Ce,1)}else console.log(" No academic year data, using default semester 1"),N(1),await be(ue,Ce,1)}catch(Oe){console.error(" Error determining current semester:",Oe),N(1),await be(ue,Ce,1)}},[Y,be]);C.useEffect(()=>{t&&r&&(console.log(" Props detected:",{grade:t,class:r}),ke(t,r))},[t,r,ke]);const We=C.useCallback(async()=>{console.log(" Initializing teacher results...");try{if(p(!0),y(""),!a||!s){console.log(" User not authenticated"),y("User not authenticated");return}if(s.role!==ui.TEACHER){console.error(" Invalid user role for teacher results:",s.role),y("Access denied. Teacher role required.");return}console.log(" Loading teacher assignments..."),await dt(),console.log(" Loading academic year data..."),await Ve(),console.log(" Teacher results initialization complete!")}catch(ue){console.error(" Error initializing teacher results:",ue),y("Failed to initialize teacher results")}finally{p(!1)}},[a,s]),dt=C.useCallback(async()=>{console.log(" Loading teacher assignments...");try{const ue=`teacher_data_${s?.teacher_id||s?.id||""}`;let Ce=Rn(ue);Ce?console.log(" Cache HIT! Using cached teacher data"):(console.log(" Cache MISS! Fetching teacher data from API"),Ce=await Sn.getTeacherData(),console.log(" Teacher data loaded:",Ce),Dn(ue,Ce,Bn.teacher_subjects)),d(Ce);const Oe=[];Ce&&Ce.subjects&&Ce.subjects.forEach(mr=>{mr.classes&&mr.classes.forEach(nt=>{nt.grade&&nt.class&&Oe.push({grade:nt.grade,class:nt.class,subject:mr.name})})}),R(Oe),console.log(" Available classes from teacher data:",Oe);const Xe=`teacher_tests_${s?.teacher_id||s?.id||""}`,It=Rn(Xe);It&&It.some(mr=>mr.test_type==="drawing")&&(console.log(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(Xe));let ht=Rn(Xe);ht?console.log(" Cache HIT! Using cached teacher tests"):(console.log(" Cache MISS! Fetching teacher tests from API"),ht=await rn.getTeacherTests(),console.log(" Teacher tests loaded:",ht),Dn(Xe,ht,Bn.teacher_tests));const fr=ht.flatMap(mr=>mr.assignments||[]);_(fr),console.log(" Raw assignments data:",fr),console.log(" Teacher assignments loaded:",fr.length)}catch(ue){console.error(" Error loading teacher assignments:",ue),i("Failed to load teacher assignments","error")}},[i]),Ve=C.useCallback(async()=>{console.log(" Loading academic year data...");try{const ue="admin_academic_years_";let Ce=Rn(ue);Ce?console.log(" Cache HIT! Using cached academic year data"):(console.log(" Cache MISS! Fetching academic year from API"),Ce=await Sn.getAcademicYear(),console.log(" Academic year response:",Ce),Dn(ue,Ce,Bn.admin_academic_years)),console.log(" First academic year record:",Ce?.[0]||Ce?.academic_years?.[0]),Ce&&Array.isArray(Ce)?(ee(Ce),console.log(" Academic year data loaded:",Ce.length),console.log(" Sample record fields:",Object.keys(Ce[0]||{}))):Ce&&Ce.academic_years?(ee(Ce.academic_years),console.log(" Academic year data loaded:",Ce.academic_years.length),console.log(" Sample record fields:",Object.keys(Ce.academic_years[0]||{}))):console.warn(" Failed to load academic year data:",Ce?.error||"No data received")}catch(ue){console.error(" Error loading academic year data:",ue)}},[]),oe=C.useCallback(async()=>{console.log(" Loading academic year data (direct return)...");try{const ue="admin_academic_years_";let Ce=Rn(ue);return Ce?console.log(" Cache HIT! Using cached academic year data"):(console.log(" Cache MISS! Fetching academic year from API"),Ce=await Sn.getAcademicYear(),console.log(" Academic year response:",Ce),Dn(ue,Ce,Bn.admin_academic_years)),Ce&&Array.isArray(Ce)?(console.log(" Returning academic year data:",Ce.length),Ce):Ce&&Ce.academic_years?(console.log(" Returning academic year data:",Ce.academic_years.length),Ce.academic_years):(console.warn(" Failed to load academic year data:",Ce?.error||"No data received"),null)}catch(ue){return console.error(" Error loading academic year data:",ue),null}},[]),he=C.useCallback(async(ue,Ce)=>{console.log(" Showing classes for grade:",ue,"class:",Ce),U(ue),q(Ce),N(null),G(null),ue&&Ce&&await ke(ue,Ce)},[ke]);C.useCallback((ue,Ce)=>{console.log(" Showing semesters for class:",ue,Ce),N(null),G(null),ke(ue,Ce)},[]),C.useCallback((ue,Ce)=>{console.log(" Class clicked:",ue,Ce),w(!0),ke(ue,Ce)},[]);const Te=C.useCallback(async ue=>{!L||!M||(console.log(" Loading results for semester:",ue),N(ue),await be(L,M,ue))},[L,M,be]);C.useCallback(()=>{let ue=1;if(Y&&Y.length>0){const Ce=new Date;for(const Oe of Y){const Xe=new Date(Oe.start_date),It=new Date(Oe.end_date);if(Ce>=Xe&&Ce<=It){ue=Oe.semester;break}}}return o.jsx("div",{className:"flex space-x-4 mb-6",children:[1,2].map(Ce=>o.jsxs(Ze.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${b===Ce?"bg-blue-600 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>Te(Ce),whileHover:{scale:1.05},whileTap:{scale:.95},children:["Semester ",Ce,Ce===ue&&o.jsx("span",{className:"ml-2 text-xs",children:"(Current)"})]},Ce))})},[b,Te,Y]),C.useCallback(ue=>ue.reduce((Ce,Oe)=>(Ce[Oe.student_id]||(Ce[Oe.student_id]=[]),Ce[Oe.student_id].push(Oe),Ce),{}),[]),C.useCallback(ue=>{if(ue.length===0)return 0;const Ce=ue.reduce((Oe,Xe)=>Oe+(Xe.percentage||0),0);return Math.round(Ce/ue.length)},[]),C.useCallback(ue=>{ue.score<ue.passing_score&&window.confirm("Give another try?")&&je(ue.student_id,ue.test_id)},[]);const je=C.useCallback(async(ue,Ce)=>{try{(await fetch("/.netlify/functions/reset-test-attempt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:ue,testId:Ce})})).ok&&(M&&Te(b),i("Test made accessible to student","success"))}catch(Oe){console.error("Error resetting test attempt:",Oe),i("Failed to reset test attempt","error")}},[M,b,Te,i]),qe=C.useCallback((ue,Ce)=>{if(ue===null||Ce===null)return"";const Oe=Math.round(ue/Ce*100);return Oe>=80?"text-green-600 bg-green-50":Oe>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50"},[]),at=C.useCallback(ue=>{Ie(ue),Qe(!0)},[]),Le=C.useCallback((ue,Ce="overview",Oe)=>{try{const It=!!ue?.ai_feedback,ht=typeof ue?.ai_feedback;let fr=[];if(It)if(ht==="string")try{fr=Object.keys(JSON.parse(ue.ai_feedback))}catch{fr=["<invalid json>"]}else ht==="object"&&(fr=Object.keys(ue.ai_feedback||{}));console.log("[AI DEBUG] Opening speaking result",{hasAi:It,aiType:ht,aiKeys:fr})}catch{}const Xe={...ue,__initialTab:Ce};Oe&&(Xe.__audioUrl=Oe),gt(Xe),Ut(!0)},[]);C.useCallback((ue,Ce,Oe)=>{Ye({resultId:ue,score:Ce,maxScore:Oe}),ut(Ce?.toString()||""),$t(Oe?.toString()||""),mt(!0)},[]),C.useCallback(ue=>{ut(ue)},[]),C.useCallback(ue=>{$t(ue)},[]),C.useCallback(async()=>{if(it){De(!0);try{const ue={resultId:it.resultId,score:parseInt(xt)||0,maxScore:parseInt(wt)||1};(await fetch(wm.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ue)})).ok?(i("Score updated successfully","success"),M&&Te(b),Ye(null),ut(""),$t(""),mt(!1)):i("Failed to update score","error")}catch(ue){console.error("Error updating score:",ue),i("Failed to update score","error")}finally{De(!1)}}},[it,xt,wt,M,b,Te,i]),C.useCallback(()=>{Ye(null),ut(""),$t(""),mt(!1)},[]);const Ct=C.useCallback((ue,Ce)=>{Lt({resultId:ue,score:Ce}),Ee(Ce.toString())},[]),Mt=C.useCallback(async()=>{if(At){fe(!0);try{const ue={resultId:At.resultId,score:parseInt(rr)||0},Ce=await fetch(wm.UPDATE_SPEAKING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ue)});if(Ce.ok){const Oe=await Ce.json();i("Speaking test score updated successfully","success"),_t&&gt(Xe=>({...Xe,score:Oe.score,percentage:Oe.percentage})),M&&Te(b),Lt(null),Ee("")}else{const Oe=await Ce.json();i(Oe.error||"Failed to update speaking test score","error")}}catch(ue){console.error("Error updating speaking test score:",ue),i("Failed to update speaking test score","error")}finally{fe(!1)}}},[At,rr,M,b,Te,i]),Vt=C.useCallback(()=>{Lt(null),Ee("")},[]),dr=(ue,Ce)=>{console.log(" Starting column editing for drawing test:",ue),console.log(" Current editingColumns before update:",Array.from(_e)),console.log(" Results data passed to function:",Ce),$e(Oe=>{const Xe=new Set(Oe).add(ue);return console.log(" Updated editingColumns:",Array.from(Xe)),Xe}),console.log(" Initializing column scores for test:",ue),console.log(" Results data:",Ce),console.log(" Results.class:","null"),console.log(" No results or class data available")},Nn=C.useCallback(ue=>{$e(Ce=>{const Oe=new Set(Ce);return Oe.delete(ue),Oe}),pt(Ce=>{const Oe={...Ce};return delete Oe[ue],Oe})},[]),ln=C.useCallback((ue,Ce,Oe,Xe)=>{const It=Xe.toString();ce.current[ue]||(ce.current[ue]={}),ce.current[ue][Ce]||(ce.current[ue][Ce]={}),ce.current[ue][Ce][Oe]=It;const ht=parseInt(Xe)||0;pt(fr=>({...fr,[ue]:{...fr[ue],[Ce]:{...fr[ue]?.[Ce],[Oe]:ht}}}))},[]),In=C.useCallback(async ue=>{if(ce.current[ue]){Jt(!0);try{const Ce=Object.entries(ce.current[ue]).map(([ht,fr])=>({resultId:fr.resultId,score:parseInt(fr.score)||0,maxScore:parseInt(fr.maxScore)||100}));console.log(" Saving column scores for",ue,":",Ce);const Oe=Ce.map(ht=>(console.log(" Sending update:",ht),fetch(wm.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ht)})));(await Promise.all(Oe)).every(ht=>ht.ok)?(i(`Scores updated successfully for ${ue}`,"success"),M&&Te(b),Nn(ue)):i("Failed to update some scores","error")}catch(Ce){console.error("Error updating column scores:",Ce),i("Failed to update scores","error")}finally{Jt(!1)}}},[St,M,b,Te,i,Nn]),Pr=C.useCallback((ue,Ce,Oe)=>!Ce||Ce.length===0?o.jsx(Ze.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:o.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):o.jsx(Ze.div,{className:"relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:o.jsxs(Ze.div,{className:"bg-white rounded-lg shadow-lg overflow-hidden",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4,delay:.1},children:[o.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:Xe=>{Ft.current&&(Ft.current.scrollLeft=Xe.target.scrollLeft)},children:o.jsx("div",{className:"min-w-full h-1",children:o.jsx("div",{className:"h-1",style:{width:`${(Oe.length+5)*120}px`}})})}),o.jsx("div",{ref:Ft,className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:Xe=>{ve(Xe);const It=Xe.target.previousElementSibling;It&&(It.scrollLeft=Xe.target.scrollLeft)},children:o.jsxs("table",{className:"min-w-full border-collapse text-sm min-w-max",children:[o.jsx("thead",{children:o.jsxs(Ze.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[o.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-20 text-center",children:"Student ID"}),o.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 ${le?"w-8 min-w-[32px] max-w-[32px] bg-gray-100 cursor-pointer select-none":"min-w-[180px] bg-blue-50 cursor-pointer select-none"}`,onClick:Xe=>{Xe.preventDefault(),Xe.stopPropagation(),ge(!le)},title:"Toggle student name columns",children:le?o.jsx("div",{className:"flex justify-center",children:o.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"truncate",title:"Student Name",children:"Student Name"}),o.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),o.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-16 text-center",children:"No."}),o.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[100px]",children:"Nickname"}),Oe.map((Xe,It)=>{const ht=xe.has(Xe.test_name),fr=Xe.test_type==="drawing",mr=Wr.current.has(Xe.test_name);return console.log(` Rendering test ${Xe.test_name}:`,{isDrawingTest:fr,isEditingColumn:mr,editingColumns:Array.from(Wr.current),test_type:Xe.test_type}),o.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 cursor-pointer hover:bg-blue-200 transition-colors select-none ${ht?"w-8 min-w-[32px] max-w-[32px] bg-gray-100":"min-w-[100px] bg-blue-50"}`,onClick:nt=>{nt.preventDefault(),nt.stopPropagation(),pe(Xe.test_name)},children:ht?o.jsx("div",{className:"flex justify-center",children:o.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"truncate",title:Xe.test_name,children:Xe.test_name.length>8?Xe.test_name.substring(0,8)+"...":Xe.test_name}),o.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})},It)})]})}),o.jsx("tbody",{children:o.jsx(Ei,{children:Ce.map((Xe,It)=>o.jsxs(Ze.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${It%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1+It*.05,ease:"easeOut"},whileHover:{scale:1.01,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.99},children:[o.jsx(Ze.td,{className:"border-b border-gray-100 px-4 py-4 text-center font-semibold text-gray-900",whileHover:{scale:1.05},transition:{duration:.2},children:Xe.student_id}),le?o.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:o.jsx("div",{className:"flex justify-center",children:o.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:ht=>{ht.preventDefault(),ht.stopPropagation(),ge(!1)},children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}):o.jsxs(o.Fragment,{children:[o.jsx(Ze.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:Xe.name}),o.jsx(Ze.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:Xe.surname})]}),o.jsx(Ze.td,{className:"border-b border-gray-100 px-4 py-4 text-center text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:Xe.number??It+1}),o.jsx(Ze.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-600",whileHover:{scale:1.02},transition:{duration:.2},children:Xe.nickname||"-"}),Oe.map((ht,fr)=>{const mr=xe.has(ht.test_name),nt=Xe[ht.test_name];return mr?(console.log(" Rendering collapsed column for test:",ht.test_name),o.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:o.jsx("div",{className:"flex justify-center",children:o.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:jt=>{jt.preventDefault(),jt.stopPropagation(),console.log(" Clicked on collapsed arrow for:",ht.test_name),pe(ht.test_name)},children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},fr)):o.jsx(Ze.td,{className:"border-b border-gray-100 px-2 py-4 text-sm min-w-[100px]",initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},transition:{duration:.3},whileHover:{scale:1.02},onClick:jt=>{if(console.debug("[TeacherResults] Main table TD clicked",{testResult:nt,student:Xe.student_id}),nt?.retest_offered){i("Retest is already offered","info");return}const er=l(nt);er!==null&&er<50&&(console.debug("[TeacherResults] Main table TD -> opening retest modal",{studentId:Xe.student_id,test:ht}),n({failedStudentIds:[Xe.student_id],test_type:ht.test_type,original_test_id:nt?.test_id||ht.test_id,subject_id:nt?.subject_id||ht.subject_id,grade:t,class:r}))},children:nt&&nt.test_type==="drawing"?o.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[o.jsx("button",{onClick:()=>at(nt),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"View Drawing"}),(()=>{const jt=`${ht.test_name}|${Xe.student_id}`,er=Yt===jt,un=Number.isFinite(nt?.score)?nt.score:0,Xn=10;return er?o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("input",{type:"number",min:"0",max:10,value:Ir,onChange:Mn=>xr(Mn.target.value),onBlur:async()=>{const Mn=Math.max(0,Math.min(10,parseFloat(Ir||"0")));Mr(!0);try{const sr={resultId:nt?.id,score:Mn,maxScore:10},dn=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token");if(!(await fetch(wm.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:dn?`Bearer ${dn}`:""},body:JSON.stringify(sr)})).ok)throw new Error("Failed to save")}catch{}finally{Mr(!1),pr(null),Te(b)}},onKeyDown:async Mn=>{Mn.key==="Enter"?Mn.currentTarget.blur():Mn.key==="Escape"&&pr(null)},className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",disabled:Tr}),o.jsx("span",{className:"text-xs text-gray-500",children:"/"}),o.jsx("input",{type:"number",value:10,className:"w-12 px-2 py-1 text-xs border border-gray-300 bg-gray-100 rounded",disabled:!0})]}):o.jsxs("div",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors",onClick:()=>{pr(jt),xr(String(un))},title:"Click to edit score",children:[un,"/",Xn]})})(),nt.caught_cheating&&nt.visibility_change_times&&o.jsxs("span",{className:"text-xs text-red-600",children:["(",nt.visibility_change_times,")"]})]}):nt&&(nt.test_type==="speaking"||ht.test_type==="speaking")?o.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[(()=>{const jt=nt?.answers;let er;if(typeof jt=="string")if(/^https?:\/\//i.test(jt))er=jt;else try{er=JSON.parse(jt)?.audio_url}catch{}else jt&&typeof jt=="object"&&(er=jt.audio_url);return!er&&nt?.audio_url&&(er=nt.audio_url),console.log(" Final computed audioUrl (main table):",{studentId:Xe.student_id,testName:ht.test_name,audioUrl:er}),o.jsx(o.Fragment,{children:o.jsx("button",{onClick:()=>Le({...nt,__studentId:Xe.student_id},"audio",er),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"Results"})})})(),(()=>{const jt=Wr.current.has(ht.test_name);return console.log(` Score cell for ${ht.test_name}:`,{isEditing:jt,editingColumns:Array.from(Wr.current),test_name:ht.test_name}),jt})()?o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("input",{type:"number",min:"0",max:nt.max_score||100,value:ce.current[ht.test_name]?.[Xe.student_id]?.score||nt.score||"",onChange:jt=>ln(ht.test_name,Xe.student_id,"score",jt.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),o.jsx("span",{className:"text-xs text-gray-500",children:"/"}),o.jsx("input",{type:"number",min:"1",value:ce.current[ht.test_name]?.[Xe.student_id]?.maxScore||nt.max_score||100,onChange:jt=>ln(ht.test_name,Xe.student_id,"maxScore",jt.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):o.jsxs("div",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors",onDoubleClick:()=>{console.log(" Double-clicked on speaking test score:",ht.test_name),console.log(" Results state at double-click:",I),console.log(" Test result:",nt),console.log(" Student:",Xe),console.log(" Test:",ht),nt&&nt.id?(console.log(" Starting column editing for speaking test:",ht.test_name),dr(ht.test_name)):console.log(" No test result ID found, cannot edit")},title:"Double-click to edit scores",children:[(()=>{const jt=l(nt),er=jt!==null&&jt<50,un=jt!==null&&jt>=50&&jt<70,Xn=nt.retest_offered,Mn=jt===null?"text-gray-600":er?"text-red-600 font-semibold":un?"text-yellow-600":"text-green-600";return o.jsxs(Ze.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${Mn} ${er?"cursor-pointer hover:opacity-90":""} ${Xn?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:er?{color:"#b91c1c"}:void 0,whileHover:{scale:er?1.1:1.05},transition:{duration:.2},onClick:()=>{er&&!Xn&&(console.log(" Offering retest for speaking test:",ht.test_name),n({failedStudentIds:[Xe.student_id],test_type:ht.test_type,original_test_id:nt?.test_id||ht.test_id,subject_id:nt?.subject_id||ht.subject_id,grade:t,class:r}))},title:Xn?"Retest offered":er?"Offer retest":"",children:[(()=>{const sr=nt.retest_best_score??nt.score,dn=nt.retest_best_max_score??nt.max_score;return o.jsxs(o.Fragment,{children:[o.jsx("span",{className:er?"text-red-700":"",children:sr}),"/",o.jsx("span",{children:dn})]})})(),nt.caught_cheating&&o.jsx("span",{className:"ml-1",children:""})]})})(),nt.caught_cheating&&nt.visibility_change_times&&o.jsxs("span",{className:"text-xs text-red-600",children:["(",nt.visibility_change_times,")"]})]})]}):nt&&nt.score!==null&&nt.score!==void 0?o.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[(()=>{const jt=l(nt),er=jt!==null&&jt<50,un=jt!==null&&jt>=50&&jt<70,Xn=jt!==null&&jt>=70;console.debug("[TeacherResults] Main table pill",{studentId:Xe.student_id,pct:jt,isRed:er,isYellow:un,isGreen:Xn,testResult:nt});const Mn=jt===null?"text-gray-600":er?"text-red-600 font-semibold":un?"text-yellow-600":"text-green-600",sr=nt?.retest_offered===!0;return o.jsxs(Ze.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${Mn} ${er?"cursor-pointer hover:opacity-90":""} ${sr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:er?{color:"#b91c1c"}:void 0,whileHover:{scale:er?1.1:1.05},transition:{duration:.2},onClick:dn=>{if(dn.preventDefault(),dn.stopPropagation(),nt?.retest_offered){i("Retest is already offered","info");return}er&&(console.debug("[TeacherResults] Main table pill clicked -> opening retest modal",{studentId:Xe.student_id,test:ht}),n({failedStudentIds:[Xe.student_id],test_type:ht.test_type,original_test_id:nt?.test_id||ht.test_id,subject_id:nt?.subject_id||ht.subject_id,grade:t,class:r}))},title:sr?"Retest offered":er?"Offer retest":"",children:[(()=>{const dn=nt.retest_best_score??nt.score,Yn=nt.retest_best_max_score??nt.max_score;return o.jsxs(o.Fragment,{children:[o.jsx("span",{className:er?"text-red-700":"",children:dn}),"/",o.jsx("span",{children:Yn})]})})(),nt.caught_cheating&&o.jsx("span",{className:"ml-1",children:""})]})})(),nt.caught_cheating&&nt.visibility_change_times&&o.jsxs("span",{className:"text-xs text-red-600",children:["(",nt.visibility_change_times,")"]})]}):o.jsx("span",{className:"text-gray-400",children:"-"})},fr)})]},It))})})]})})]})}),[qe,xe,pe,le]),Or=C.useCallback((ue,Ce,Oe)=>!Ce||Ce.length===0?o.jsx(Ze.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:o.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):o.jsx(Ze.div,{className:"w-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},children:o.jsx(Ze.div,{className:"overflow-x-auto -mx-4 px-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.1},children:o.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden min-w-max",children:o.jsxs("table",{className:"w-full border-collapse text-xs min-w-max",children:[o.jsx("thead",{children:o.jsxs(Ze.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.2,delay:.2},children:[o.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-16 text-center",children:"ID"}),o.jsx("th",{className:`border-b border-gray-200 px-2 py-3 text-left font-semibold text-gray-700 ${le?"w-8 min-w-[32px] max-w-[32px] bg-gray-100 cursor-pointer select-none":"min-w-[160px] bg-blue-50 cursor-pointer select-none"}`,onClick:Xe=>{Xe.preventDefault(),Xe.stopPropagation(),ge(!le)},title:"Toggle student name columns",children:le?o.jsx("div",{className:"flex justify-center",children:o.jsx("svg",{className:"w-3 h-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"truncate",title:"Student Name",children:"Student Name"}),o.jsx("svg",{className:"w-3 h-3 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),o.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-12 text-center",children:"No."}),o.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[80px]",children:"Nickname"}),Oe.map((Xe,It)=>{const ht=Xe.test_type==="drawing",fr=Wr.current.has(Xe.test_name);return o.jsx(Ze.th,{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.3+It*.05},children:o.jsxs("div",{className:"flex flex-col space-y-1",children:[ht&&o.jsx("div",{className:"flex justify-center",children:fr?o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:mr=>{mr.preventDefault(),mr.stopPropagation(),In(Xe.test_name)},disabled:Xt,className:"px-1 py-0.5 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:Xt?"Saving...":"Save"}),o.jsx("button",{onClick:mr=>{mr.preventDefault(),mr.stopPropagation(),Nn(Xe.test_name)},disabled:Xt,className:"px-1 py-0.5 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):o.jsx("button",{onClick:mr=>{mr.preventDefault(),mr.stopPropagation(),dr(Xe.test_name)},className:"px-1 py-0.5 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:"Edit"})}),o.jsx("span",{className:"text-xs",children:Xe.test_name.length>10?Xe.test_name.substring(0,10)+"...":Xe.test_name})]})},It)})]})}),o.jsx("tbody",{children:o.jsx(Ei,{children:Ce.map((Xe,It)=>o.jsxs(Ze.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${It%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.1+It*.03,ease:"easeOut"},whileHover:{scale:1.005,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.995},children:[o.jsx(Ze.td,{className:"border-b border-gray-100 px-3 py-3 text-center font-semibold text-gray-900",whileHover:{scale:1.03},transition:{duration:.15},children:Xe.student_id}),le?o.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-xs w-8 min-w-[32px] max-w-[32px]",children:o.jsx("div",{className:"flex justify-center",children:o.jsx("svg",{className:"w-3 h-3 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:ht=>{ht.preventDefault(),ht.stopPropagation(),ge(!1)},children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}):o.jsxs(o.Fragment,{children:[o.jsx(Ze.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:Xe.name}),o.jsx(Ze.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:Xe.surname})]}),o.jsx(Ze.td,{className:"border-b border-gray-100 px-3 py-3 text-center text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:Xe.number??It+1}),o.jsx(Ze.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-600 whitespace-normal break-words",whileHover:{scale:1.01},transition:{duration:.15},children:Xe.nickname||"-"}),Oe.map((ht,fr)=>{const mr=xe.has(ht.test_name),nt=Xe[ht.test_name];return mr?o.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-sm w-8 min-w-[32px] max-w-[32px]",children:o.jsx("div",{className:"flex justify-center",children:o.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:jt=>{jt.preventDefault(),jt.stopPropagation(),pe(ht.test_name)},children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},fr):o.jsx(Ze.td,{className:"border-b border-gray-100 px-3 py-3 text-sm",whileHover:{scale:1.01},transition:{duration:.15},onClick:jt=>{console.debug("[TeacherResults] TD clicked",{testResult:nt,student:Xe.student_id});const er=l(nt);if(er!==null&&er<50){if(nt?.retest_offered){i("Retest is already offered","info");return}console.debug("[TeacherResults] TD -> opening retest modal",{studentId:Xe.student_id}),n({failedStudentIds:[Xe.student_id],grade:t,class:r})}},children:nt&&nt.score!==null&&nt.score!==void 0?o.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[nt.test_type==="drawing"?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>at(nt),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View"}),Wr.current.has(ht.test_name)?o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("input",{type:"number",min:"0",max:nt.max_score||100,value:ce.current[ht.test_name]?.[Xe.student_id]?.score||nt.score||"",onChange:jt=>ln(ht.test_name,Xe.student_id,"score",jt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),o.jsx("span",{className:"text-xs text-gray-500",children:"/"}),o.jsx("input",{type:"number",min:"1",value:ce.current[ht.test_name]?.[Xe.student_id]?.maxScore||nt.max_score||100,onChange:jt=>ln(ht.test_name,Xe.student_id,"maxScore",jt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):o.jsxs(Ze.div,{className:`px-1 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors ${nt.caught_cheating?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-800"}`,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>dr(ht.test_name),title:"Double-click to edit column",children:[nt.score,"/",nt.max_score,nt.caught_cheating&&o.jsx("span",{className:"ml-1",children:""})]})]}):nt.test_type==="speaking"||ht.test_type==="speaking"?o.jsxs(o.Fragment,{children:[console.log(" Rendering speaking link (compact table):",{studentId:Xe.student_id,testName:ht.test_name,testType:nt?.test_type,answers:nt?.answers}),o.jsx("button",{onClick:()=>Le({...nt,__studentId:Xe.student_id},"audio"),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View Audio"}),Wr.current.has(ht.test_name)?o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("input",{type:"number",min:"0",max:nt.max_score||100,value:ce.current[ht.test_name]?.[Xe.student_id]?.score||nt.score||"",onChange:jt=>ln(ht.test_name,Xe.student_id,"score",jt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),o.jsx("span",{className:"text-xs text-gray-500",children:"/"}),o.jsx("input",{type:"number",min:"1",value:ce.current[ht.test_name]?.[Xe.student_id]?.maxScore||nt.max_score||100,onChange:jt=>ln(ht.test_name,Xe.student_id,"maxScore",jt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):o.jsxs(Ze.div,{className:`px-1 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors ${nt.caught_cheating?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-800"}`,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>dr(ht.test_name),title:"Double-click to edit scores",children:[nt.score||0,"/",nt.max_score||100,nt.caught_cheating&&o.jsx("span",{className:"ml-1",children:""})]})]}):(()=>{const jt=l(nt),er=jt!==null&&jt<50,un=jt!==null&&jt>=50&&jt<70,Xn=jt!==null&&jt>=70;console.debug("[TeacherResults] Render pill",{studentId:Xe.student_id,pct:jt,isRed:er,isYellow:un,isGreen:Xn,score:nt.score,max:nt.max_score,percentageField:nt.percentage});const sr=`px-1 py-0.5 rounded text-xs font-medium ${jt===null?"text-gray-600":er?"text-red-600 font-semibold":un?"text-yellow-600":"text-green-600"} ${er?"cursor-pointer hover:opacity-90 pointer-events-auto":""}`;return console.debug("[TeacherResults] Pill classes",{classNameStr:sr,pct:jt,isRed:er,isYellow:un,isGreen:Xn}),o.jsxs(Ze.div,{className:sr,style:er?{color:"#b91c1c"}:void 0,whileHover:{scale:er?1.05:1},transition:{duration:.15},onClick:er?dn=>{dn.preventDefault(),dn.stopPropagation();const Yn=window.getComputedStyle(dn.currentTarget).color;console.debug("[TeacherResults] Red pill clicked -> opening retest modal",{studentId:Xe.student_id,className:sr,computedColor:Yn}),n({failedStudentIds:[Xe.student_id],grade:t,class:r})}:void 0,title:er?"Offer retest":"",children:[o.jsx("span",{className:er?"text-red-700":"",children:nt.score}),"/",o.jsx("span",{children:nt.max_score}),nt.caught_cheating&&o.jsx("span",{className:"ml-1",children:""})]})})(),nt.caught_cheating&&nt.visibility_change_times&&o.jsxs("span",{className:"text-xs text-red-600",children:["(",nt.visibility_change_times,")"]})]}):o.jsx("span",{className:"text-gray-400",children:"-"})},fr)})]},It))})})]})})})}),[qe,xe,pe,le]),cr=C.useCallback(()=>{if(!I)return null;console.log(" renderResults - results:",I),console.log(" renderResults - results.class:",I.class),console.log(" renderResults - results.unique_tests:",I.unique_tests);const ue=I.class&&Array.isArray(I.class)&&I.class.length>0;if(console.log(" renderResults - hasStudentData:",ue),!ue)return console.log(" renderResults - No student data, showing no students message"),o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:"No students found for this class and semester."})});const Ce=I.unique_tests||[];return console.log(" renderResults - uniqueTests:",Ce),Se.current=I,o.jsxs("div",{className:"space-y-6",children:[o.jsxs(Ze.div,{className:"bg-gradient-to-r from-red-500 to-pink-500 rounded-lg p-6 text-white",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[o.jsxs(Ze.h2,{className:"text-2xl font-bold mb-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.1},children:["Test Results - Grade M",L,", Class ",L,"/",M,", Semester ",b]}),o.jsxs(Ze.p,{className:"text-cyan-100",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.2},children:["Viewing results for ",I.subjects?.length||0," subject(s)"]}),o.jsxs(Ze.div,{className:"mt-4 flex gap-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:[o.jsx("button",{onClick:()=>{const Oe=I.unique_tests?.map(Xe=>Xe.test_name)||[];Ne(new Set(Oe))},className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Collapse All Tests"}),o.jsx("button",{onClick:()=>Ne(new Set),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Expand All Tests"})]})]}),o.jsxs(Ze.div,{className:"bg-white rounded-lg shadow p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},children:[o.jsx(Ze.h3,{className:"text-lg font-semibold text-gray-900 mb-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},children:"Class Results"}),o.jsx("div",{className:"hidden md:block",children:Pr("All Subjects",I.class,Ce)}),o.jsx("div",{className:"md:hidden",children:Or("All Subjects",I.class,Ce)})]})]})},[I,Pr,L,M,b]),ae=C.useCallback(()=>{if(!I||!I.class||!I.unique_tests)return;const ue=["Student ID","Name","Surname","No.","Nickname",...I.unique_tests.map(fr=>fr.test_name)],Ce=I.class.map((fr,mr)=>{const nt=[];return nt.push(fr.student_id),nt.push(fr.name),nt.push(fr.surname),nt.push(fr.number??mr+1),nt.push(fr.nickname||"-"),I.unique_tests.forEach(jt=>{const er=fr[jt.test_name];er&&er.score!==null&&er.score!==void 0?nt.push(`${er.score}/${er.max_score}`):nt.push("-")}),nt}),Oe=Ly.aoa_to_sheet([ue,...Ce]),Xe=Ly.book_new(),It=[{wch:10},{wch:15},{wch:15},{wch:6},{wch:12},...I.unique_tests.map(()=>({wch:15}))];Oe["!cols"]=It,Ly.book_append_sheet(Xe,Oe,"Class Results");const ht=`class-results-${L}-${M}-semester-${b}.xlsx`;Lte(Xe,ht),i("Excel file exported successfully!","success")},[I,L,M,b,i]);return f?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Fr,{size:"lg"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Results..."})]})}):g?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsx("div",{className:"text-center",children:o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[o.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),o.jsx("p",{className:"text-red-600 mb-4",children:g}),o.jsx(et,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx("div",{className:"bg-white shadow-sm border-b",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsx("div",{className:"flex justify-between items-center py-4",children:o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Class Results"}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",ie?ie.toLocaleString():"Never"]})]})})})}),o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Class"}),F.length>0?o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:F.map((ue,Ce)=>o.jsxs(et,{variant:L===ue.grade&&M===ue.class?"primary":"outline",onClick:()=>he(ue.grade,ue.class),className:"w-full",children:[ue.grade,"/",ue.class]},`${ue.grade}-${ue.class}-${Ce}`))}):o.jsx("p",{className:"text-gray-500",children:"No classes available"})]}),M&&o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Select Semester for ",L,"/",M]}),o.jsx("div",{className:"flex space-x-4",children:[1,2].map(ue=>{let Ce=1;if(Y&&Y.length>0){const Oe=new Date;for(const Xe of Y){const It=new Date(Xe.start_date),ht=new Date(Xe.end_date);if(Oe>=It&&Oe<=ht){Ce=Xe.semester;break}}}return o.jsxs(Ze.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${b===ue?"bg-blue-600 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>Te(ue),whileHover:{scale:1.05},whileTap:{scale:.95},children:["Semester ",ue,ue===Ce&&o.jsx("span",{className:"ml-2 text-xs",children:"(Current)"})]},ue)})})]}),M&&I&&o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[L," ",M," - Test Results (Semester ",b,")"]}),o.jsx("div",{className:"flex space-x-3",children:o.jsxs("button",{type:"button",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-2",onClick:ae,children:[o.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-4 h-4 object-contain"}),o.jsx("span",{className:"font-medium text-sm",children:"Export Excel"})]})})]}),cr()]}),M&&!I&&o.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-500",children:"No test results available for this class and semester."})})})]})}),rt&&Pe&&o.jsx(hN,{children:o.jsx(Jj,{drawing:rt,isOpen:Pe,onClose:()=>Qe(!1),isTeacherView:!0,onSaveScore:async({resultId:ue,score:Ce,maxScore:Oe})=>{try{const Xe=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token");if(!(await fetch(wm.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:Xe?`Bearer ${Xe}`:""},body:JSON.stringify({resultId:ue,score:Ce,maxScore:Oe})})).ok)throw new Error("Failed to save");await Te(b)}catch{i("Failed to save drawing score","error")}}})}),_t&&Bt&&o.jsx(hN,{children:o.jsx(Kz,{result:_t,isOpen:Bt,onClose:()=>Ut(!1),initialTab:_t.__initialTab||"overview",editingSpeakingScore:At,tempSpeakingScore:rr,isSavingSpeakingScore:we,onStartSpeakingScoreEdit:Ct,onSaveSpeakingScore:Mt,onCancelSpeakingScoreEdit:Vt,onTempSpeakingScoreChange:Ee})})]})},S3=({onBackToLogin:e})=>{const t=Ri(),{user:r,isAuthenticated:n,logout:s,getCurrentTeacherUsername:a}=Hn(),{teacherData:i,loadTeacherData:l}=ev(),{activeTests:c,loadActiveTests:d}=Vp(),{showNotification:f,notifications:p}=ja(),[g,y]=C.useState(!0),[v,_]=C.useState(""),[b,N]=C.useState("main"),[k,w]=C.useState([]),[T,A]=C.useState([]),[F,R]=C.useState(null),[E,D]=C.useState(null),[I,G]=C.useState(null),[Y,ee]=C.useState(!1),[ie,re]=C.useState(!1),[se,B]=C.useState(null),[z,U]=C.useState(!1),[V,q]=C.useState(null),[L,M]=C.useState(!1),[X,K]=C.useState(null),[Z,J]=C.useState(null),[ne,me]=C.useState([]),[xe,Ne]=C.useState(!1),[le,ge]=C.useState(null),[Ue,Ge]=C.useState({}),[Je,He]=C.useState(!1),[Ft,rt]=C.useState(!1),[Ie,Pe]=C.useState(0),[Qe,_t]=C.useState(!1),[gt,Bt]=C.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[Ut,it]=C.useState([]),[Ye,xt]=C.useState([]),[ut,wt]=C.useState(!1),[$t,Kt]=C.useState(null),[De,ct]=C.useState([]),[mt,At]=C.useState(!1),[Lt,rr]=C.useState("subject");C.useEffect(()=>{Xt()},[]),C.useEffect(()=>{const ae=ue=>{Je&&!ue.target.closest(".relative")&&He(!1),Ft&&!ue.target.closest(".relative")&&rt(!1)};return document.addEventListener("mousedown",ae),()=>{document.removeEventListener("mousedown",ae)}},[Je,Ft]);const Ee=C.useCallback(()=>{console.log(" showChangePasswordTab called"),_t(!0),He(!1),rt(!1)},[]),we=C.useCallback(()=>{console.log(" hideChangePasswordTab called"),_t(!1),Bt({currentPassword:"",newPassword:"",confirmPassword:""})},[]),fe=C.useCallback(async()=>{if(!r)return;const{currentPassword:ae,newPassword:ue,confirmPassword:Ce}=gt;if(!ae||!ue||!Ce){f("Please fill in all fields","error");return}if(ue!==Ce){f("New passwords do not match","error");return}if(ue.length<6){f("New password must be at least 6 characters long","error");return}const Oe=/[a-zA-Z]/.test(ue),Xe=/[0-9]/.test(ue);if(!Oe||!Xe){f("New password must contain both letters and numbers","error");return}try{const It=await Sn.changePassword({username:r.username,currentPassword:ae,newPassword:ue});It.success?(f("Password changed successfully!","success"),we()):f(It.message||"Failed to change password","error")}catch(It){console.error("Password change error:",It),f("Failed to change password. Please try again.","error")}},[r,gt,f]),_e=C.useCallback(ae=>{const{name:ue,value:Ce}=ae.target;Bt(Oe=>({...Oe,[ue]:Ce}))},[]),$e=C.useCallback(async()=>{console.log(" Loading teacher data...");try{const ae=await Sn.getTeacherData();return console.log(" Teacher data loaded:",ae),J(new Date),ae}catch(ae){throw console.error(" Error loading teacher data:",ae),ae}},[]),St=C.useCallback(async()=>{console.log(" Loading teacher subjects...");try{const ae=`teacher_subjects_${r?.teacher_id||r?.id||""}`,ue=Rn(ae);if(ue)return console.log(" Using cached teacher subjects"),w(ue),ue;const Ce=await Sn.getTeacherData();console.log(" Raw teacher data:",Ce);const Oe=Sn.getTeacherSubjects(Ce.subjects);return console.log(" Teacher subjects loaded:",Oe),w(Oe),Dn(ae,Oe,Bn.teacher_subjects),console.log(" Available classes for performance chart:",Oe[0]?.classes||[]),console.log(" Performance chart will load when user clicks on a class"),Oe}catch(ae){throw console.error(" Error loading teacher subjects:",ae),ae}},[r?.teacher_id,r?.id]),pt=C.useCallback(async()=>{console.log(" Loading teacher active tests...");try{const ae=`teacher_tests_${r?.teacher_id||r?.id||""}`,ue=Rn(ae);ue&&ue.some(Xe=>Xe.test_type==="drawing")&&(console.log(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(ae));const Ce=Rn(ae);if(Ce)return console.log(" Using cached teacher tests"),A(Ce),Ce;const Oe=await rn.getTeacherTests();return console.log(" Teacher tests loaded:",Oe),A(Oe),Dn(ae,Oe,Bn.teacher_tests),Oe}catch(ae){throw console.error(" Error loading teacher tests:",ae),ae}},[r?.teacher_id,r?.id]),Xt=C.useCallback(async()=>{console.log(" Initializing Teacher Cabinet...");try{if(y(!0),_(""),!n||!r){console.log(" User not authenticated"),_("User not authenticated");return}if(r.role!==ui.TEACHER){console.error(" Invalid user role for teacher cabinet:",r.role),_("Access denied. Teacher role required.");return}console.log(" Loading teacher data..."),await $e(),console.log(" Loading teacher subjects..."),await St(),console.log(" Loading active tests..."),await pt(),console.log(" Teacher Cabinet initialization complete!")}catch(ae){console.error(" Error initializing teacher cabinet:",ae),_("Failed to initialize teacher cabinet")}finally{y(!1)}},[n,r,$e,St,pt]),Jt=C.useCallback(()=>{console.log(" Showing subject selection prompt..."),ee(!0),Yt(),rr("subject")},[]),Yt=C.useCallback(async()=>{console.log(" Loading available subjects..."),wt(!0);try{const ae=await Sn.getSubjectsForSelection();it(ae),console.log(" Available subjects loaded:",ae)}catch(ae){console.error(" Error loading available subjects:",ae),f("Failed to load subjects","error")}finally{wt(!1)}},[]),pr=C.useCallback(ae=>{if(!ae){Kt(null);return}const ue=Ut.find(Ce=>Ce.subject_id==ae);ue&&(Kt(ue),ct([]),rr("classes"))},[Ut]),Ir=C.useCallback((ae,ue)=>{ct(Ce=>Ce.some(Oe=>Oe.grade===ae&&Oe.class===ue)?Ce.filter(Oe=>!(Oe.grade===ae&&Oe.class===ue)):[...Ce,{grade:ae,class:ue}])},[]),xr=C.useCallback(()=>{if(!$t||De.length===0){f("Please select at least one class","warning");return}const ae={subject_id:parseInt($t.subject_id),subject_name:$t.subject,classes:De};xt(ue=>[...ue,ae]),Kt(null),ct([]),rr("subject"),f(`Added ${$t.subject} with ${De.length} classes`,"success")},[$t,De]),Tr=C.useCallback(ae=>{xt(ue=>ue.filter((Ce,Oe)=>Oe!==ae))},[]),Mr=C.useCallback(async(ae,ue,Ce)=>{console.log(" Deleting teacher subject:",{subjectId:ae,grade:ue,classNumber:Ce});try{const Oe={subjectId:ae,grade:ue,class:Ce};console.log(" Sending delete request with data:",Oe);const Xe=await Sn.deleteTeacherSubject(Oe);if(Xe.success)f("Subject assignment deleted successfully!","success"),await St();else throw new Error(Xe.error||"Failed to delete subject assignment")}catch(Oe){console.error(" Error deleting subject assignment:",Oe),f("Error deleting subject assignment. Please try again.","error")}},[St,f]),Wr=C.useCallback((ae,ue,Ce,Oe)=>{K({subjectId:ae,subjectName:ue,grade:Ce,classNumber:Oe}),M(!0)},[]),ce=C.useCallback(async()=>{X&&(await Mr(X.subjectId,X.grade,X.classNumber),M(!1),K(null))},[X,Mr]),Se=C.useCallback(()=>{M(!1),K(null)},[]),pe=C.useCallback(async()=>{if(Ye.length===0){f("Please select at least one subject","warning");return}try{const ae=await Sn.saveTeacherSubjects(Ye);if(ae.success)f("Subjects saved successfully!","success"),ee(!1),xt([]),rr("subject"),await St();else throw new Error(ae.error||"Failed to save subjects")}catch(ae){console.error(" Error saving teacher subjects:",ae),f("Failed to save subjects","error")}},[Ye,St]);C.useCallback(async ae=>{console.log(" Saving teacher subjects:",ae);try{const ue=await Sn.saveTeacherSubjects(ae);if(ue.success)f("Subjects saved successfully!","success"),await St(),ee(!1);else throw new Error(ue.error||"Failed to save subjects")}catch(ue){console.error(" Error saving teacher subjects:",ue),f("Failed to save subjects","error")}},[St]);const ve=C.useCallback(()=>{console.log(" Showing active tests..."),N("tests")},[]),be=C.useCallback(ae=>{console.log(" Showing test details:",ae),B(ae),re(!0)},[]);C.useCallback(async(ae,ue,Ce)=>{console.log(" Removing class assignment:",ae,ue,Ce);try{const Oe=await rn.removeClassAssignment(ae,ue,Ce);if(Oe.success)f("Assignment removed successfully!","success"),await pt();else throw new Error(Oe.error||"Failed to remove assignment")}catch(Oe){console.error(" Error removing class assignment:",Oe),f("Failed to remove assignment","error")}},[pt]);const ke=C.useCallback(async(ae,ue)=>{console.log(" Marking test as completed:",ae,ue);try{const Ce=await rn.markTestCompleted(ae,ue);if(Ce.success){f("Test marked as completed!","success");const Oe=`teacher_tests_${r?.teacher_id||r?.id||""}`;localStorage.removeItem(Oe),console.log(" Cleared teacher tests cache"),await pt()}else throw new Error(Ce.error||"Failed to mark test as completed")}catch(Ce){console.error(" Error marking test as completed:",Ce),f("Failed to mark test as completed","error")}},[pt,f,r?.teacher_id,r?.id]),We=C.useCallback(async()=>{console.log(" Refreshing active tests data...");try{await pt(),f("Tests refreshed successfully!","success")}catch(ae){console.error(" Error refreshing tests:",ae),f("Failed to refresh tests","error")}},[pt]),[dt,Ve]=C.useState(!1),oe=C.useCallback(async ae=>{console.log(" Loading performance data for class:",ae),console.log(" Current selectedClassForChart:",le);try{Ve(!0);const[ue,Ce]=ae.split("/"),Oe=ue.startsWith("M")?ue:`M${ue}`,Xe=`class_summary_${r.teacher_id}_${Oe}_${Ce}_${Ti.CURRENT_ACADEMIC_YEAR}_${Ti.CURRENT_SEMESTER}`,It=Rn(Xe);if((It?Date.now()-It.timestamp:1/0)>36e5)try{await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/refresh-class-summary-semester")}catch(jt){console.warn("Materialized view refresh failed (continuing):",jt.message)}const mr=await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary-semester?teacher_id=${r.teacher_id}&grade=${Oe}&class=${Ce}&semester=${Ti.CURRENT_SEMESTER}&academic_year=${Ti.CURRENT_ACADEMIC_YEAR}`);console.log(" API response status:",mr.status);const nt=await mr.json();if(console.log(" Performance API response:",nt),console.log(" API success:",nt.success),console.log(" API summary:",nt.summary),nt.success&&nt.summary){console.log(" Processing semester performance data:",nt.summary);const jt=nt.summary;console.log(" Semester summary:",{total_students:jt.total_students,total_tests:jt.total_tests,completed_tests:jt.completed_tests,average_class_score:jt.average_class_score,pass_rate:jt.pass_rate,cheating_incidents:jt.cheating_incidents});const er={summary:jt,semester:Ti.CURRENT_SEMESTER,academicYear:Ti.CURRENT_ACADEMIC_YEAR,overallAverage:jt.average_class_score||0,totalTests:jt.total_tests||0,completedTests:jt.completed_tests||0,passRate:jt.pass_rate||0,cheatingIncidents:jt.cheating_incidents||0,lastTestDate:jt.last_test_date,semesterProgress:he(jt)};console.log(" Semester performance data:",er),Ge(un=>({...un,[ae]:er}))}else console.log(" No performance data available for class:",ae),Ge(jt=>({...jt,[ae]:{tests:[],overallAverage:0}}))}catch(ue){console.error(" Error loading performance data:",ue),console.error(" Error details:",ue.message),Ge(Ce=>({...Ce,[ae]:{tests:[],overallAverage:0}}))}finally{Ve(!1)}},[r]),he=C.useCallback(ae=>{if(!ae.last_test_date)return 0;const ue=new Date("2025-05-01"),Ce=new Date("2025-09-30"),Oe=new Date,Xe=Ce-ue,It=Math.min(Oe-ue,Xe);return Math.round(It/Xe*100)},[]);C.useCallback((ae,ue)=>{console.log(" Showing class results:",ae,ue),console.log(" Class click - grade:",ae,"className:",ue),D(ae),G(ue),N("results");const Ce=`${ae}/${ue}`;console.log(" Loading performance data for clicked class:",Ce),ge(Ce),oe(Ce)},[oe]);const[Te,je]=C.useState([]),[qe,at]=C.useState([]),Le=C.useCallback(async()=>{try{const ue=await(await Vo(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestAssignments(r.teacher_id);je(ue)}catch(ae){console.warn("Failed to load retests",ae)}},[r]);C.useCallback(async ae=>{try{const Ce=await(await Vo(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestTargets(ae);at(Ce)}catch(ue){console.warn("Failed to load retest targets",ue)}},[]);const[Ct,Mt]=C.useState(!1);C.useEffect(()=>{console.debug("[TeacherCabinet] showRetestModal state changed:",Ct)},[Ct]);const[Vt,dr]=C.useState({test_type:"",original_test_id:"",subject_id:"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:[]}),Nn=C.useCallback(async ae=>{console.debug("[TeacherCabinet] openRetestModal called with:",ae);const{test_type:ue,original_test_id:Ce,subject_id:Oe,failedStudentIds:Xe=[],grade:It,class:ht}=ae||{};dr({test_type:ue||"multiple_choice",original_test_id:Ce||"",subject_id:Oe||"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:Xe}),It!==void 0&&D(It),ht!==void 0&&G(ht),console.debug("[TeacherCabinet] Setting showRetestModal to true"),Mt(!0)},[]),ln=C.useCallback(async()=>{try{const ae=await Vo(()=>import("./retestService-C6b0YDiD.js"),[]),ue=new Date,Ce=new Date(ue.getTime()+Vt.window_days*24*60*60*1e3),Oe={...Vt,grade:E,class:I,window_start:ue.toISOString(),window_end:Ce.toISOString()};await ae.retestService.createRetestAssignment(Oe),f("Retest created","success"),Mt(!1),Le(),Pe(Xe=>Xe+1)}catch(ae){console.error("Create retest error",ae),f(ae.message||"Failed to create retest","error")}},[Vt,E,I,Le]),In=C.useCallback(ae=>{if(!ae)return o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),o.jsx("p",{className:"text-gray-500",children:"Click on a class to view performance data"})]});const Ce=(Ue[ae]||{}).summary;return Ce?o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[o.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[Ce.average_class_score?.toFixed(1)||0,"%"]}),o.jsx("div",{className:"text-sm text-blue-600",children:"Class Average"})]}),o.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[o.jsx("div",{className:"text-3xl font-bold text-green-600",children:Ce.total_tests||0}),o.jsx("div",{className:"text-sm text-green-600",children:"Total Tests"})]}),o.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[o.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:[Ce.pass_rate?.toFixed(1)||0,"%"]}),o.jsx("div",{className:"text-sm text-purple-600",children:"Pass Rate"})]}),o.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[o.jsx("div",{className:"text-3xl font-bold text-red-600",children:Ce.cheating_incidents||0}),o.jsx("div",{className:"text-sm text-red-600",children:"Cheating Incidents"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[o.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:Ce.completed_tests||0}),o.jsx("div",{className:"text-sm text-yellow-600",children:"Completed Tests"})]}),o.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4",children:[o.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:Ce.highest_score||0}),o.jsx("div",{className:"text-sm text-indigo-600",children:"Highest Score"})]}),o.jsxs("div",{className:"bg-pink-50 rounded-lg p-4",children:[o.jsx("div",{className:"text-2xl font-bold text-pink-600",children:Ce.total_students||0}),o.jsx("div",{className:"text-sm text-pink-600",children:"Total Students"})]})]}),dt&&o.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-4 w-full max-w-xs text-center",children:[o.jsx("div",{className:"animate-spin h-6 w-6 border-2 border-gray-300 border-t-transparent rounded-full mx-auto mb-2"}),o.jsx("div",{className:"text-sm text-gray-700",children:"Loading latest class summary..."})]})})]}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),o.jsx("p",{className:"text-gray-500",children:"No performance data available for this class"})]})},[Ue]);if(g)return o.jsxs("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:[o.jsxs("div",{className:"text-center",children:[o.jsx(Fr,{size:"lg"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Cabinet..."})]}),o.jsx("div",{className:"flex flex-wrap gap-2"})]});if(v)return o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsx("div",{className:"text-center",children:o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[o.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Cabinet Error"}),o.jsx("p",{className:"text-red-600 mb-4",children:v}),o.jsx(et,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return o.jsxs(Ze.div,{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[o.jsx(Ze.div,{className:"bg-gradient-to-r from-sky-400 to-sky-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center py-6",children:[o.jsxs(Ze.div,{className:"flex-1 text-center",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[o.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white mb-2",children:"Teacher Cabinet"}),o.jsxs("p",{className:"text-sky-100 text-sm sm:text-base md:text-lg",children:["Welcome, Teacher ",a()||""]})]}),o.jsxs(Ze.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[o.jsx("div",{className:"hidden md:block",children:o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>He(!Je),className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border border-white/20 text-white hover:bg-white/20 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:[o.jsx("span",{className:"hidden sm:inline text-xs sm:text-sm font-medium",children:"Menu"}),o.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 transition-transform duration-200",style:{transform:Je?"rotate(180deg)":"rotate(0deg)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),Je&&o.jsxs(Ze.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[o.jsxs("button",{onClick:()=>{He(!1),Ee()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),o.jsx("span",{children:"Change Password"})]}),o.jsxs("button",{onClick:()=>{He(!1),e?e():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),o.jsx("span",{children:"Logout"})]})]})]})}),o.jsxs("div",{className:"md:hidden",children:[o.jsx("button",{onClick:()=>rt(!Ft),className:"flex items-center justify-center w-10 h-10 bg-white/10 border border-white/20 text-white hover:bg-white/20 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),Ft&&o.jsxs(Ze.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[o.jsxs("div",{className:"px-4 py-2 border-b border-gray-200",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:a()||"Teacher"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Teacher Account"})]}),o.jsxs("button",{onClick:()=>{rt(!1),Ee()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),o.jsx("span",{children:"Change Password"})]}),o.jsxs("button",{onClick:()=>{rt(!1),e?e():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),o.jsx("span",{children:"Logout"})]})]})]})]})]})})}),o.jsx(Ze.div,{className:"bg-white border-b shadow-sm",initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},children:o.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:o.jsx("nav",{className:"flex space-x-1 sm:space-x-8 overflow-x-auto",children:[{key:"main",label:"Main Dashboard",shortLabel:"Dashboard"},{key:"tests",label:"Test Management",shortLabel:"Tests"},{key:"results",label:"Class Results",shortLabel:"Results"},{key:"subjects",label:"Subject Management",shortLabel:"Subjects"}].map((ae,ue)=>o.jsxs(Ze.button,{onClick:()=>ae.key==="tests"?ve():N(ae.key),className:`py-2 sm:py-4 px-2 sm:px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors duration-200 whitespace-nowrap flex-shrink-0 ${b===ae.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5+ue*.1,duration:.3},whileHover:{scale:1.05},whileTap:{scale:.95},children:[o.jsx("span",{className:"sm:hidden",children:ae.shortLabel}),o.jsx("span",{className:"hidden sm:inline",children:ae.label})]},ae.key))})})}),o.jsx(Ze.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:o.jsxs(Ei,{mode:"wait",children:[b==="main"&&o.jsx(Ze.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Pr()},"main"),b==="subjects"&&o.jsx(Ze.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Or()},"subjects"),b==="tests"&&o.jsx(Ze.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:cr()},"tests"),b==="results"&&o.jsx(Ze.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:o.jsx(cP,{selectedGrade:E,selectedClass:I,onBackToCabinet:()=>N("main"),openRetestModal:Nn},Ie)},"results")]})}),Y&&o.jsx(Go,{isOpen:Y,onClose:()=>{ee(!1),rr("subject"),xt([]),Kt(null),ct([])},title:"Select Subjects and Classes",size:"large",children:o.jsxs("div",{className:"space-y-6 px-4 max-h-[80vh] overflow-y-auto",children:[Lt==="subject"&&o.jsxs(Ze.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Step 1: Select Subject"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the subject you want to teach:"}),ut?o.jsxs("div",{className:"flex items-center justify-center py-8",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),o.jsx("span",{className:"ml-2 text-gray-600",children:"Loading subjects..."})]}):o.jsxs("select",{value:$t?.subject_id||"",onChange:ae=>pr(ae.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"Select a subject"}),Ut.map(ae=>o.jsx("option",{value:ae.subject_id,children:ae.subject},ae.subject_id))]})]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx(et,{variant:"outline",onClick:()=>ee(!1),children:"Cancel"}),o.jsx(et,{variant:"primary",onClick:()=>rr("classes"),disabled:!$t,children:"Next: Select Classes"})]})]}),Lt==="classes"&&$t&&o.jsxs(Ze.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["Step 2: Select Classes for ",$t.subject]}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the classes you teach for this subject:"}),o.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:o.jsx("div",{className:"grid grid-cols-3 gap-3",children:[1,2,3,4,5,6].map(ae=>o.jsxs("div",{className:"space-y-2",children:[o.jsxs("h4",{className:"font-medium text-gray-700 text-sm",children:["Grade ",ae]}),o.jsx("div",{className:"space-y-1",children:[15,16].map(ue=>o.jsxs("label",{className:"flex items-center space-x-2 py-1",children:[o.jsx("input",{type:"checkbox",checked:De.some(Ce=>Ce.grade===ae.toString()&&Ce.class===ue.toString()),onChange:()=>Ir(ae.toString(),ue.toString()),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),o.jsxs("span",{className:"text-xs text-gray-700",children:["Class ",ue]})]},ue))})]},ae))})})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx(et,{variant:"outline",onClick:()=>rr("subject"),children:"Back to Subjects"}),o.jsxs("div",{className:"space-x-3",children:[o.jsx(et,{variant:"outline",onClick:()=>ee(!1),children:"Cancel"}),o.jsx(et,{variant:"primary",onClick:xr,disabled:De.length===0,children:"Add Subject"})]})]})]}),Ye.length>0&&o.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Selected Subjects"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Review your selected subjects and classes:"}),o.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:Ye.map((ae,ue)=>o.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-gray-900",children:ae.subject_name}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Classes: ",ae.classes.map(Ce=>`Grade ${Ce.grade} Class ${Ce.class}`).join(", ")]})]}),o.jsx("button",{onClick:()=>Tr(ue),className:"text-red-600 hover:text-red-800 p-1",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},ue))})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx(et,{variant:"outline",onClick:()=>rr("subject"),children:"Add More Subjects"}),o.jsxs("div",{className:"space-x-3",children:[o.jsx(et,{variant:"outline",onClick:()=>ee(!1),children:"Cancel"}),o.jsx(et,{variant:"primary",onClick:pe,children:"Save All Subjects"})]})]})]})]})}),Ct&&o.jsxs(Go,{isOpen:Ct,onClose:()=>Mt(!1),title:"Create Retest",size:"medium",children:[o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Retest Window"}),o.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:Vt.window_days,onChange:ae=>dr(ue=>({...ue,window_days:Number(ae.target.value)})),children:[o.jsx("option",{value:1,children:"1 day"}),o.jsx("option",{value:2,children:"2 days"}),o.jsx("option",{value:3,children:"3 days"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Attempts"}),o.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:Vt.max_attempts,onChange:ae=>dr(ue=>({...ue,max_attempts:Number(ae.target.value)})),children:[o.jsx("option",{value:1,children:"1 attempt"}),o.jsx("option",{value:2,children:"2 attempts"}),o.jsx("option",{value:3,children:"3 attempts"})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Students can retry immediately if they fail"})]})]})}),o.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[o.jsx("button",{onClick:()=>Mt(!1),className:"px-4 py-2 text-sm rounded border border-gray-300 hover:bg-gray-50",children:"Cancel"}),o.jsx("button",{onClick:ln,className:"px-4 py-2 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700",children:"Create Retest"})]})]}),ie&&se&&o.jsxs(Go,{isOpen:ie,onClose:()=>re(!1),title:"Test Details",size:"large",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Name:"}),o.jsx("p",{className:"text-sm text-gray-900",children:se.test_name})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Subject:"}),o.jsx("p",{className:"text-sm text-gray-900",children:se.subject})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Type:"}),o.jsx("p",{className:"text-sm text-gray-900",children:se.test_type})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Created:"}),o.jsx("p",{className:"text-sm text-gray-900",children:new Date(se.created_at).toLocaleDateString()})]})]}),o.jsx("div",{className:"flex justify-end space-x-3 mt-6",children:o.jsx(et,{variant:"outline",onClick:()=>re(!1),children:"Close"})})]}),L&&X&&o.jsx(Go,{isOpen:L,onClose:Se,title:"Delete Subject Assignment",size:"small",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:o.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Subject Assignment"}),o.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Are you sure you want to delete the assignment for"," ",o.jsx("span",{className:"font-semibold text-gray-900",children:X.subjectName})," ","in Grade ",X.grade,", Class ",X.classNumber,"?"]}),o.jsx("p",{className:"text-xs text-red-600",children:"This action cannot be undone."})]}),o.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o.jsx(et,{variant:"outline",onClick:Se,children:"Cancel"}),o.jsx(et,{variant:"danger",onClick:ce,children:"Delete Assignment"})]})]})}),o.jsx(Ze.div,{className:"fixed top-4 right-4 space-y-2 z-50",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.8,duration:.5},children:p.map(ae=>o.jsx(Ze.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.3},children:o.jsx("div",{className:`p-4 rounded-lg shadow-lg ${ae.type==="success"?"bg-green-600 text-white":ae.type==="error"?"bg-red-600 text-white":ae.type==="warning"?"bg-yellow-600 text-white":"bg-blue-600 text-white"}`,children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{children:ae.message}),o.jsx("button",{onClick:()=>setNotifications(ue=>ue.filter(Ce=>Ce.id!==ae.id)),className:"ml-4 text-white hover:text-gray-200",children:""})]})})},ae.id))}),Qe&&o.jsx(Go,{isOpen:Qe,onClose:we,title:"Change Password",size:"sm",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),o.jsx("input",{type:"password",name:"currentPassword",value:gt.currentPassword,onChange:_e,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter current password"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),o.jsx("input",{type:"password",name:"newPassword",value:gt.newPassword,onChange:_e,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter new password"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),o.jsx("input",{type:"password",name:"confirmPassword",value:gt.confirmPassword,onChange:_e,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Confirm new password"})]}),o.jsxs("div",{className:"flex space-x-3 pt-4",children:[o.jsx(et,{type:"button",variant:"secondary",onClick:we,className:"flex-1",children:"Cancel"}),o.jsx(et,{type:"button",onClick:fe,className:"flex-1",children:"Change Password"})]})]})})]});function Pr(){return o.jsxs("div",{className:"space-y-8",children:[o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:o.jsxs(bt,{children:[o.jsx(bt.Header,{children:o.jsx(bt.Title,{children:"My Subjects & Classes"})}),o.jsx(bt.Body,{children:k.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned"}),o.jsx("p",{className:"text-gray-500 mb-4",children:"You don't have any subjects assigned yet."}),o.jsx(et,{variant:"outline",onClick:()=>N("subjects"),children:"Manage Subjects"})]}):o.jsx("div",{className:"space-y-6",children:k.map((ae,ue)=>o.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+ue*.1,duration:.3},className:"border border-gray-200 rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ae.name}),o.jsxs("span",{className:"text-sm text-gray-500",children:[ae.classes?.length||0," classes"]})]}),ae.classes&&ae.classes.length>0?o.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:ae.classes.map((Ce,Oe)=>o.jsx(Ze.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3+ue*.1+Oe*.05,duration:.2},whileHover:{scale:1.05},whileTap:{scale:.95},children:o.jsxs(et,{variant:"outline",size:"sm",onClick:()=>{D(Ce.grade),G(Ce.class),N("results")},className:"font-medium",children:[Ce.grade,"/",Ce.class]})},Oe))}):o.jsx("div",{className:"text-center py-4 text-gray-500",children:o.jsx("span",{className:"text-sm",children:"No classes assigned to this subject"})})]},ae.id))})})]})}),o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},children:o.jsxs(bt,{children:[o.jsxs(bt.Header,{children:[o.jsx(bt.Title,{children:"Test Performance Overview"}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Average scores across all tests by class"})]}),o.jsx(bt.Body,{children:k.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),o.jsx("p",{className:"text-gray-500",children:"No subjects assigned - no performance data available"})]}):o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"flex flex-wrap gap-2 border-b border-gray-200",children:(()=>{const ae=[];return k.forEach(ue=>{ue.classes&&ue.classes.forEach(Ce=>{const Oe=`${Ce.grade}/${Ce.class}`;ae.find(Xe=>Xe.key===Oe)||ae.push({key:Oe,grade:Ce.grade,class:Ce.class,subject:ue.name})})}),ae})().map((ae,ue)=>o.jsxs("button",{onClick:()=>{console.log(" Class button clicked:",ae.key),ge(ae.key),oe(ae.key)},className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${le===ae.key?"bg-blue-100 text-blue-700 border-b-2 border-blue-500":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[ae.grade,"/",ae.class]},ae.key))}),o.jsx("div",{className:"mt-4",children:In(le)})]})})]})})]})}function Or(){return o.jsxs("div",{className:"space-y-8",children:[o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:o.jsx(bt,{children:o.jsx(bt.Header,{children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx(bt.Title,{children:"Subject Management"}),o.jsx(et,{variant:"primary",onClick:Jt,children:"Add Subject"})]})})})}),k.length===0?o.jsx(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:o.jsx(bt,{children:o.jsx(bt.Body,{children:o.jsxs("div",{className:"text-center p-12",children:[o.jsx(Ze.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No subjects assigned yet"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Add your first subject to get started with creating tests and managing classes."}),o.jsx(et,{variant:"primary",onClick:Jt,size:"lg",children:"Add Your First Subject"})]})})})}):o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:o.jsxs(bt,{children:[o.jsx(bt.Header,{children:o.jsx(bt.Title,{children:"Your Subjects"})}),o.jsx(bt.Body,{children:o.jsx("div",{className:"space-y-4",children:k.map((ae,ue)=>o.jsx(Ze.div,{className:"p-4 bg-gray-50 rounded-lg border-l-4 border-green-500",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3+ue*.1,duration:.3},whileHover:{scale:1.02,backgroundColor:"#f9fafb"},children:o.jsx("div",{className:"flex justify-between items-start",children:o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:ae.name}),o.jsx("div",{className:"flex flex-wrap gap-2",children:ae.classes?.map((Ce,Oe)=>o.jsxs(Ze.div,{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-800 text-xs rounded-full px-3 py-1",initial:{scale:0},animate:{scale:1},transition:{delay:.4+ue*.1+Oe*.05,duration:.2},whileHover:{scale:1.1},children:[o.jsxs("span",{children:[Ce.grade," - ",Ce.className]}),o.jsx("button",{onClick:()=>Wr(ae.id,ae.name,Ce.grade,Ce.class),className:"ml-1 text-red-600 hover:text-red-800 transition-colors",title:"Delete this subject assignment",children:o.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},Oe))||o.jsx("span",{className:"text-gray-500 text-sm",children:"No classes assigned"})})]})})},ue))})})]})})]})}function cr(){return o.jsxs("div",{className:"space-y-8",children:[o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:o.jsx(bt,{children:o.jsx(bt.Header,{children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx(bt.Title,{children:"Active Tests"}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx(et,{variant:"outline",onClick:We,children:"Refresh"}),o.jsx(et,{variant:"primary",onClick:()=>t("/teacher/tests/create"),children:"Create New Test"})]})]})})})}),T.length===0?o.jsx(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:o.jsx(bt,{children:o.jsx(bt.Body,{children:o.jsxs("div",{className:"text-center p-12",children:[o.jsx(Ze.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No active tests found"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first test to get started with assessments."}),o.jsx(et,{variant:"primary",onClick:()=>t("/teacher/tests/create"),size:"lg",children:"Create Your First Test"})]})})})}):o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"space-y-4",children:T.map((ae,ue)=>o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3+ue*.1,duration:.3},whileHover:{scale:1.01},children:o.jsx(bt,{children:o.jsx(bt.Body,{children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{className:"flex-1 flex items-center space-x-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 min-w-0 flex-shrink-0",children:ae.test_name}),o.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium flex-shrink-0",children:ae.test_type}),o.jsxs("div",{className:"hidden sm:flex items-center space-x-4",children:[o.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[o.jsx("span",{className:"font-medium",children:"Assignments:"}),o.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:ae.assignments?.length||0})]}),ae.assignments&&ae.assignments.length>0&&o.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[o.jsx("span",{className:"font-medium",children:"Classes:"}),o.jsx("div",{className:"flex flex-wrap gap-1",children:ae.assignments.map((Ce,Oe)=>o.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:[Ce.grade,"/",Ce.class]},Oe))})]}),o.jsx("div",{className:"text-sm text-gray-500 flex-shrink-0",children:new Date(ae.created_at).toLocaleDateString()})]})]}),o.jsxs("div",{className:"flex gap-2 ml-4 flex-shrink-0",children:[o.jsx("div",{className:"sm:hidden",children:o.jsx(et,{variant:"outline",onClick:()=>be(ae),size:"sm",className:"text-xs",title:`Assignments: ${ae.assignments?.length||0} | Classes: ${ae.assignments?.map(Ce=>`${Ce.grade}/${Ce.class}`).join(", ")||"None"} | ${new Date(ae.created_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}`,children:"Details"})}),o.jsx("div",{className:"hidden sm:block",children:o.jsx(et,{variant:"outline",onClick:()=>be(ae),size:"sm",children:"Details"})}),o.jsx(et,{variant:"success",onClick:()=>ke(ae.test_type,ae.test_id),size:"sm",children:"Complete"})]})]})})})},ue))})]})}},Xte={multipleChoice:"multiple_choice",trueFalse:"true_false",input:"input",matching:"matching_type",wordMatching:"word_matching",drawing:"drawing",fillBlanks:"fill_blanks",speaking:"speaking"},k3=()=>{const{user:e}=Hn();OW();const{notifications:t,showNotification:r,removeNotification:n}=ja(),[s,a]=C.useState(!1),[i,l]=C.useState(!1),[c,d]=C.useState("typeSelection"),[f,p]=C.useState(!1),[g,y]=C.useState(null),[v,_]=C.useState([]),[b,N]=C.useState(!1),[k,w]=C.useState(!1),[T,A]=C.useState(!1),[F,R]=C.useState(!1),[E,D]=C.useState({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:"",isShuffled:!1}),[I,G]=C.useState([]),[Y,ee]=C.useState(null);C.useRef(null),C.useRef(null),C.useRef(null),C.useRef(null),C.useRef(null),C.useRef(null),C.useRef(null);const ie=C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in initializeTestCreation, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" Setting up test creation event listeners..."),q(),console.log(" Test creation initialization complete")},[e,r]),re=C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestTypeSelection, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" showTestTypeSelection called - starting new test creation"),l(!1),console.log(" Reset testAssignmentCompleted flag to false"),a(!0),console.log(" Set isInTestCreation flag to true"),se(),d("typeSelection"),z("testTypeSelection")},[e,r]),se=C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in disableNavigationButtons, redirecting to login");return}console.log(" Disabling navigation buttons..."),p(!0)},[e]),B=C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in enableNavigationButtons, redirecting to login");return}console.log(" Enabling navigation buttons..."),p(!1)},[e]),z=C.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveTestCreationState, redirecting to login");return}console.log("  saveTestCreationState called with step:",oe),console.log("  Call stack:",new Error().stack);const he={multipleChoice:{buttonVisible:!0,hintVisible:!1},trueFalse:{buttonVisible:!0,hintVisible:!1},input:{buttonVisible:!0,hintVisible:!1}},Te={isInTestCreation:!0,currentStep:oe,timestamp:Date.now(),excelState:he};localStorage.setItem("test_creation_state",JSON.stringify(Te)),console.log(" Saved test creation state:",Te);const je={};switch(oe){case"testTypeSelection":break;case"multipleChoiceForm":je.testName=E.testName||"",je.numQuestions=E.numQuestions||"",je.numOptions=E.numOptions||"",je.questions=E.questions||{};break;case"trueFalseForm":je.testName=E.testName||"",je.numQuestions=E.numQuestions||"",je.questions=E.questions||{};break;case"inputForm":je.testName=E.testName||"",je.numQuestions=E.numQuestions||"",je.questions=E.questions||{};break;case"formCreation":je.testName=E.testName||"",je.numQuestions=E.numQuestions||"",je.numOptions=E.numOptions||"",je.questions=E.questions||{},je.enableTimer=!!E.enableTimer,je.timerMinutes=E.timerMinutes||"",je.isShuffled=!!E.isShuffled;break;case"assignment":case"testAssignment":je.testName=E.testName||"",je.numQuestions=E.numQuestions||"",je.numOptions=E.numOptions||"",je.questions=E.questions||{};break;default:console.log(" Unknown step in saveTestCreationState:",oe);break}Object.keys(je).length>0&&(localStorage.setItem(`form_data_${oe}`,JSON.stringify(je)),console.log(" Saved form data for step:",oe,je))},[e,E]),U=C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearTestCreationState, redirecting to login");return}localStorage.removeItem("test_creation_state"),localStorage.removeItem("test_creation_form_data");const oe=[];for(let he=0;he<localStorage.length;he++){const Te=localStorage.key(he);Te&&(Te.includes("test")||Te.includes("form")||Te.includes("question"))&&oe.push(Te)}oe.forEach(he=>{localStorage.removeItem(he),console.log(" Removed localStorage key:",he)}),console.log(" Cleared test creation state from localStorage")},[e]);C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearAllTestFields, redirecting to login");return}console.log(" Clearing all test form fields..."),D({testName:"",numQuestions:0,numOptions:0,questions:{}}),y(null),G([]),ee(null),console.log(" Cleared all test form fields")},[e]);const V=C.useCallback(()=>{console.log(" Resetting Excel upload state..."),wt({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),["multiple-choice","true-false","input","word-matching"].forEach(he=>{const Te=document.querySelector(`.excel-upload-btn[data-test-type="${he}"]`);Te&&(Te.style.display="none",console.log(" Excel button hidden for:",he));const je=document.querySelector(`.excel-hint[data-test-type="${he}"]`);je&&(je.style.display="none",console.log(" Excel hint hidden for:",he));const qe=document.querySelector(`.excel-file-input[data-test-type="${he}"]`);qe&&(qe.value="",console.log(" File input cleared for:",he))}),console.log(" Excel upload state reset complete")},[]),q=C.useCallback(()=>{console.log(" Setting up auto-save listeners for initial form fields..."),["testName","numQuestions","numOptions","enableTimer","timerMinutes","isShuffled"].forEach(he=>{const Te=document.getElementById(he);Te&&Te.addEventListener("input",()=>{console.log(` Auto-save triggered for field: ${he}`)})}),console.log(" Form auto-save setup complete")},[]);C.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveFormDataForStep, redirecting to login");return}console.log("  saveFormDataForStep called with step:",oe),console.log("  Call stack:",new Error().stack);const he={};switch(oe){case"testTypeSelection":break;case"multipleChoiceForm":he.testName=E.testName||"",he.numQuestions=E.numQuestions||"",he.numOptions=E.numOptions||"",he.questions=E.questions||{};break;case"trueFalseForm":he.testName=E.testName||"",he.numQuestions=E.numQuestions||"",he.questions=E.questions||{};break;case"inputForm":he.testName=E.testName||"",he.numQuestions=E.numQuestions||"",he.questions=E.questions||{};break;case"formCreation":he.testName=E.testName||"",he.numQuestions=E.numQuestions||"",he.numOptions=E.numOptions||"",he.questions=E.questions||{};break;default:console.log(" Unknown step for form data save:",oe);return}localStorage.setItem("test_creation_form_data",JSON.stringify({step:oe,data:he,timestamp:Date.now()})),console.log(" Saved form data for step:",oe,he)},[e,E]);const L=C.useCallback(async oe=>{console.log(" Restoring form data for step:",oe);try{const he=localStorage.getItem(`form_data_${oe}`);if(he){const Te=JSON.parse(he);console.log(" Restored form data:",Te),D(je=>{const qe={...je,...Te};return console.log(" Updated formData with restored data:",qe),console.log(" Matching test data in restored data:",qe.matchingTestData),qe}),Object.keys(Te).forEach(je=>{const qe=document.getElementById(je);qe&&Te[je]!==void 0&&(qe.value=Te[je])}),console.log(" Form data restored for step:",oe)}else console.log(" No saved data found for step:",oe)}catch(he){console.error(" Error restoring form data:",he)}},[e]),M=C.useCallback(()=>{console.log(" Setting up multiple choice form auto-save..."),["mcNumOptions"].forEach(Te=>{const je=document.getElementById(Te);je&&je.addEventListener("input",()=>{console.log(` Auto-save triggered for MC field: ${Te}`)})}),document.querySelectorAll("#mcQuestionsContainer input, #mcQuestionsContainer textarea, #mcQuestionsContainer select").forEach(Te=>{Te.addEventListener("input",()=>{console.log(" Auto-save triggered for MC question field")})}),console.log(" Multiple choice form auto-save setup complete")},[]),X=C.useCallback(()=>{console.log(" Setting up true/false form auto-save..."),document.querySelectorAll("#tfQuestionsContainer input, #tfQuestionsContainer textarea, #tfQuestionsContainer select").forEach(he=>{he.addEventListener("input",()=>{console.log(" Auto-save triggered for TF question field")})}),console.log(" True/false form auto-save setup complete")},[]),K=C.useCallback(()=>{console.log(" Setting up input form auto-save..."),document.querySelectorAll("#inputQuestionsContainer input, #inputQuestionsContainer textarea, #inputQuestionsContainer select").forEach(he=>{he.addEventListener("input",()=>{console.log(" Auto-save triggered for Input question field")})}),console.log(" Input form auto-save setup complete")},[]),Z=C.useCallback(oe=>{console.log(" showExcelUploadButton called with testType:",oe);const he=oe==="multiple-choice"?"multipleChoice":oe==="true-false"?"trueFalse":oe==="input"?"input":oe;wt(Te=>({...Te,[he]:{...Te[he],buttonVisible:!0}}))},[]),J=C.useCallback(oe=>{console.log(" showExcelHint called with testType:",oe);const he=oe==="multiple-choice"?"multipleChoice":oe==="true-false"?"trueFalse":oe==="input"?"input":oe;wt(Te=>({...Te,[he]:{...Te[he],hintVisible:!0}}))},[]),ne=C.useCallback(async(oe,he,Te)=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTestAssignmentOptions, redirecting to login");return}console.log("displayTestAssignmentOptions called with:",{classes:oe,testType:he,testId:Te}),_(oe),console.log(" Test assignment options displayed for:",{testType:he,testId:Te,classesCount:oe.length})},[e]),me=C.useCallback(async(oe,he)=>{try{if(console.log("Loading teacher grades and classes for test assignment"),!e||!e.teacher_id){console.error("No valid teacher session found, redirecting to login");return}console.log("Teacher ID:",e.teacher_id);const je=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${e.teacher_id}`)).json();console.log("Teacher subjects response:",je),je.success&&je.subjects&&je.subjects.length>0?(console.log("Teacher subjects loaded:",je.subjects),_(je.subjects),ne(je.subjects,oe,he)):(console.log("No teacher subjects found"),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(Te){console.error("Error loading teacher grades and classes:",Te),r("Error loading teacher grades and classes","error")}},[e,r,ne]),xe=C.useCallback(async()=>{console.log(" Loading available classes...");try{const oe=await Sn.getGradesAndClasses();if(console.log(" Raw grades/classes data:",oe),!oe||oe.length===0){_([]);return}const he=new Map;oe.forEach(je=>{const qe=je.subject_id,at=je.subject||`Subject ${qe}`;he.has(qe)||he.set(qe,{subject_id:qe,subject:at,classes:[]}),he.get(qe).classes.push({grade:je.grade,class:je.class})});const Te=Array.from(he.values());_(Te),console.log(" Transformed available classes:",Te)}catch(oe){console.error(" Error loading available classes:",oe),r("Failed to load available classes","error")}},[r]);C.useCallback(async(oe,he)=>{if(i){l(!1);return}if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestAssignment, redirecting to login");return}se(),z("testAssignment"),ee(he),y(oe),d("testAssignment"),me(oe,he),xe(),console.log(" Test assignment interface shown for:",{testType:oe,testId:he})},[i,e,se,z,me,xe]);const Ne=C.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTeacherActiveTests, redirecting to login");return}if(console.log(" Displaying teacher active tests:",oe),oe.length===0){He([]);return}He(oe),console.log(" Active tests displayed:",oe.length,"tests")},[e]);C.useCallback(async(oe,he)=>{try{console.log(" Loading test questions for:",{testType:oe,testId:he});const Te=await rn.getTestQuestions(he,oe);return console.log(" Test questions loaded:",Te),Te}catch(Te){throw console.error("Error loading test questions:",Te),Te}},[]),C.useCallback((oe,he,Te,je)=>{console.log(" Showing teacher test details modal:",{testType:oe,testId:he,testName:Te,questionsCount:je.length}),console.log("Test Details:",{testType:oe,testId:he,testName:Te,questions:je.map(qe=>({id:qe.question_id,question:qe.question,correctAnswer:qe.correct_answer}))}),r(`Test details for "${Te}" loaded successfully.`,"success")},[r]);const le=C.useCallback(async()=>{console.log(" DEBUG: loadTeacherActiveTests called");try{console.log(" DEBUG: Fetching teacher active tests using JWT authentication...");const oe=await rn.getTeacherTests();console.log(" DEBUG: Tests loaded:",oe),oe&&oe.length>0?(console.log(" DEBUG: Success! Displaying",oe.length,"tests"),Ne(oe)):(console.log(" DEBUG: No tests found"),He([]))}catch(oe){console.error(" DEBUG: Error loading active tests:",oe),r("Error loading active tests.","error")}},[r,Ne]),ge=C.useCallback(()=>{console.log("showTestCreationSuccessMessage called"),r("Test created and assigned successfully!","success"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}}),G([]),l(!1),a(!1),U()},[r,U]),Ue=C.useCallback(async(oe,he)=>{if(console.log(" === ASSIGN TEST TO CLASSES DEBUG START ==="),console.log(" Test Type:",oe),console.log(" Test ID:",he),console.log(" Current formData:",E),console.log(" Selected Classes:",I),console.log(" User:",e),!e||!e.teacher_id){console.error(" No valid teacher session found in assignTestToClasses, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}if(console.log(" Teacher ID:",e.teacher_id),I.length===0){console.warn(" No classes selected"),r("Please select at least one class.","warning");return}try{console.log(" Preparing test + assignment request...");const Te=I.map(Le=>{const Ct={grade:parseInt(Le.grade),class:parseInt(Le.class),subject_id:parseInt(Le.subject_id),academic_period_id:8,due_date:null};return console.log(" Created assignment:",Ct),Ct});if(console.log(" Final assignments array:",Te),oe==="matching"){console.log(" Processing matching test..."),console.log(" Setting isAssigningTest to true for matching test..."),R(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(dr=>setTimeout(dr,100));const Le=E.matchingTestData;if(console.log(" Matching test data from formData:",Le),!Le){console.error(" Matching test data not found in formData"),r("Matching test data not found. Please recreate the test.","error");return}console.log(" Matching test data found, processing...");let Ct;Le.processedQuestions?(console.log(" Using pre-processed questions from MatchingTestCreator"),Ct=Le.processedQuestions):(console.log(" Converting blocks to questions (fallback)..."),console.log(" Blocks:",Le.blocks),console.log(" Words:",Le.words),console.log(" Arrows:",Le.arrows),Ct=Le.blocks.map((dr,Nn)=>{const ln=Le.words.find(cr=>cr.blockId===dr.id)?.word||`Word ${Nn+1}`,In=Le.arrows.some(cr=>cr.startBlock===dr.id),Pr=Le.arrows.find(cr=>cr.startBlock===dr.id)||null,Or={question_id:Nn+1,word:ln,block_coordinates:{x:dr.x,y:dr.y,width:dr.width,height:dr.height},has_arrow:In,arrow:Pr?{startX:Pr.startX,startY:Pr.startY,endX:Pr.endX,endY:Pr.endY,style:Pr.style||{}}:null};return console.log(` Question ${Nn+1}:`,Or),Or})),console.log(" Final questions array:",Ct);const Mt={teacher_id:e.teacher_id,test_name:E.testName,image_url:Le.imageUrl,num_blocks:Le.blocks.length,questions:Ct,allowed_time:E.enableTimer?Math.max(0,Math.floor(Number(E.timerMinutes||0)*60)):null,assignments:Te};console.log(" Final matching test data payload:",Mt),console.log(" Calling testService.saveMatchingTest...");const Vt=await rn.saveMatchingTest(Mt);console.log(" API Response:",Vt),Vt.success?(console.log(" Matching test created and assigned successfully!"),r("Matching test created and assigned successfully!","success"),console.log("Matching test created and assigned successfully"),l(!0),Ge()):(console.error(" Failed to create matching test:",Vt.message),r("Error creating and assigning matching test: "+Vt.message,"error")),R(!1);return}if(oe==="wordMatching"){console.log(" Processing word matching test..."),console.log(" Setting isAssigningTest to true for word matching test..."),R(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(dr=>setTimeout(dr,100));const Le=E.wordMatchingData;if(console.log(" Word matching test data from formData:",Le),!Le){console.error(" Word matching test data not found in formData"),r("Word matching test data not found. Please recreate the test.","error");return}console.log(" Word matching test data found, processing...");const Ct=Le.wordPairs.map((dr,Nn)=>({question_id:Nn+1,left_word:dr.leftWord,right_word:dr.rightWord}));console.log(" Final word matching questions array:",Ct);const Mt={teacher_id:e.teacher_id,test_type:"word_matching",test_name:E.testName,num_questions:Le.wordPairs.length,interaction_type:Le.interactionType||"drag",questions:Ct,allowed_time:E.enableTimer?Math.max(0,Math.floor(Number(E.timerMinutes||0)*60)):null,assignments:Te};console.log(" Final word matching test data payload:",Mt),console.log(" Calling testService.assignTestToClasses for word matching...");const Vt=await rn.assignTestToClasses(Mt);console.log(" API Response:",Vt),Vt.success?(console.log(" Word matching test created and assigned successfully!"),r("Word matching test created and assigned successfully!","success"),console.log("Word matching test created and assigned successfully"),l(!0),Ge()):(console.error(" Failed to create word matching test:",Vt.message),r("Error creating and assigning word matching test: "+Vt.message,"error")),R(!1);return}if(oe==="drawing"){console.log(" Processing drawing test..."),console.log(" Setting isAssigningTest to true for drawing test..."),R(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(dr=>setTimeout(dr,100));const Le=E.drawingData;if(console.log(" Drawing test data from formData:",Le),!Le){console.error(" Drawing test data not found in formData"),r("Drawing test data not found. Please recreate the test.","error");return}console.log(" Drawing test data found, processing...");const Ct=Le.questions||[];console.log(" Drawing questions array:",Ct);const Mt={teacher_id:e.teacher_id,test_type:"drawing",test_name:E.testName,num_questions:Le.num_questions,passing_score:Le.passing_score,questions:Ct,allowed_time:E.enableTimer?Math.max(0,Math.floor(Number(E.timerMinutes||0)*60)):null,assignments:Te};console.log(" Final drawing test data payload:",Mt),console.log(" Calling testService.assignTestToClasses...");const Vt=await rn.assignTestToClasses(Mt);console.log(" API Response:",Vt),Vt.success?(console.log(" Drawing test created and assigned successfully!"),r("Drawing test created and assigned successfully!","success"),l(!0),Ge()):(console.error(" Failed to create drawing test:",Vt.message),r("Error creating and assigning drawing test: "+Vt.message,"error")),R(!1);return}if(oe==="fillBlanks"){console.log(" Processing fill blanks test..."),console.log(" Setting isAssigningTest to true for fill blanks test..."),R(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(dr=>setTimeout(dr,100));const Le=E.fillBlanksData;if(console.log(" Fill blanks test data from formData:",Le),!Le){console.error(" Fill blanks test data not found in formData"),r("Fill blanks test data not found. Please recreate the test.","error");return}console.log(" Fill blanks test data found, processing...");const Ct=Le.blanks||[];console.log(" Fill blanks questions array:",Ct);const Mt={teacher_id:e.teacher_id,test_type:"fill_blanks",test_name:E.testName,test_text:Le.test_text,num_questions:Le.num_questions,num_blanks:Le.num_blanks,separate_type:Le.separate_type,allowed_time:E.enableTimer?Math.max(0,Math.floor(Number(E.timerMinutes||0)*60)):null,questions:Ct,assignments:Te};console.log(" Final fill blanks test data payload:",Mt),console.log(" Calling testService.assignTestToClasses...");const Vt=await rn.assignTestToClasses(Mt);console.log(" API Response:",Vt),Vt.success?(console.log(" Fill blanks test created and assigned successfully!"),r("Fill blanks test created and assigned successfully!","success"),l(!0),Ge()):(console.error(" Failed to create fill blanks test:",Vt.message),r("Error creating and assigning fill blanks test: "+Vt.message,"error")),R(!1);return}if(oe==="speaking"){console.log(" Processing speaking test..."),console.log(" Setting isAssigningTest to true for speaking test..."),R(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(dr=>setTimeout(dr,100));const Le=E.speakingData;if(console.log(" Speaking test data from formData:",Le),!Le){console.error(" Speaking test data not found in formData"),r("Speaking test data not found. Please recreate the test.","error");return}console.log(" Speaking test data found, processing...");const Ct={teacher_id:e.teacher_id,test_type:"speaking",test_name:E.testName,time_limit:Le.time_limit,min_duration:Le.min_duration,max_duration:Le.max_duration,max_attempts:Le.max_attempts,min_words:Le.min_words,passing_score:Le.passing_score,allowed_time:E.enableTimer?Math.max(0,Math.floor(Number(E.timerMinutes||0)*60)):null,questions:Le.questions,assignments:Te};console.log(" Final speaking test data payload:",Ct),console.log(" Calling save-speaking-test-with-assignments for speaking test...");const Vt=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-speaking-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ct)})).json();console.log(" API Response:",Vt),Vt.success?(console.log(" Speaking test created and assigned successfully!"),r("Speaking test created and assigned successfully!","success"),l(!0),Ge()):(console.error(" Failed to create speaking test:",Vt.message),r("Error creating and assigning speaking test: "+Vt.message,"error")),R(!1);return}console.log(" Processing non-matching test..."),console.log(" Form data questions:",E.questions);const je=Object.keys(E.questions).map(Le=>{const Ct=E.questions[Le];console.log(` Processing question ${Le}:`,Ct);let Mt;oe==="input"?Mt={correct_answers:Ct.correct_answers||[Ct.correctAnswer||""]}:Mt={correct_answer:Ct.correctAnswer||Ct.correct_answers?.[0]||""};const Vt={question_id:parseInt(Le),question:Ct.question,...Mt,options:Ct.options||[]};return console.log(` Question ${Le} correct_answers:`,Ct.correct_answers),console.log(` Question ${Le} correctAnswer:`,Ct.correctAnswer),console.log(` Converted question ${Le}:`,Vt),Vt});console.log(" Final questions array:",je);const qe={teacher_id:e.teacher_id,test_type:Xte[oe],test_name:E.testName,num_questions:E.numQuestions,num_options:E.numOptions,questions:je,allowed_time:E.enableTimer?Math.max(0,Math.floor(Number(E.timerMinutes||0)*60)):null,is_shuffled:!!E.isShuffled,assignments:Te};console.log(" Final test data payload:",qe),console.log(" Setting isAssigningTest to true..."),R(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Le=>setTimeout(Le,100)),console.log(" Calling testService.assignTestToClasses...");const at=await rn.assignTestToClasses(qe);console.log(" API Response:",at),at.success?(console.log(" Test created and assigned successfully!"),r("Test created and assigned successfully!","success"),console.log("Test created and assigned successfully"),l(!0),Ge()):(console.error(" Failed to create and assign test:",at.message),r("Error creating and assigning test: "+at.message,"error"))}catch(Te){console.error(" Exception in assignTestToClasses:",Te),console.error("Error creating and assigning test:",Te),r("Error creating and assigning test. Please try again.","error")}finally{R(!1)}console.log(" === ASSIGN TEST TO CLASSES DEBUG END ===")},[e,I,E,r,ge]),Ge=C.useCallback(async()=>{console.log("returnToMainCabinet called - restoring main cabinet view");try{a(!1),l(!1),d("typeSelection"),y(null),ee(null),G([]),B(),U(),ge(),console.log(" Returned to main cabinet")}catch(oe){console.error("Error returning to main cabinet:",oe)}},[B,U,ge]),[Je,He]=C.useState([]),[Ft,rt]=C.useState(!1);C.useCallback(async()=>{console.log(" Refreshing active tests data...");try{await le(),r("Active tests data refreshed.","success")}catch(oe){console.error("Error refreshing active tests data:",oe),r("Error refreshing data.","error")}},[le,r]);const[Ie,Pe]=C.useState([]),[Qe,_t]=C.useState([]),[gt,Bt]=C.useState(!1),[Ut,it]=C.useState(!1),Ye=C.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayExistingSubjectsInSelection, redirecting to login");return}console.log("Displaying existing subjects in selection interface:",oe),Pe(oe),console.log(" Existing subjects displayed in selection:",oe.length,"subjects")},[e]);C.useCallback(async()=>{try{console.log("Loading existing subjects...");const oe=await Sn.getTeacherSubjects();console.log("Existing subjects loaded:",oe),oe&&oe.length>0?Ye(oe):(console.log("No existing subjects found"),Pe([]))}catch(oe){console.error("Error loading existing subjects:",oe),r("Error loading subjects.","error")}},[r,Ye]);const xt=C.useCallback(oe=>{console.log("Checking for outside click...");const he=document.getElementById("dropdownMenu"),Te=document.querySelector("[data-menu-button]");he&&!he.contains(oe.target)&&!Te?.contains(oe.target)&&(console.log("Outside click detected, closing menu"),he.classList.remove("show"),document.removeEventListener("click",xt))},[]),[ut,wt]=C.useState({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),$t=C.useCallback((oe,he)=>{const Te=oe.target.files[0];if(!Te)return;if(!Te.name.match(/\.(xlsx|xls)$/i)){r("Please select a valid Excel file (.xlsx or .xls)","error"),oe.target.value="";return}if(Te.size>5*1024*1024){r("File is too large. Please select a file smaller than 5MB.","error"),oe.target.value="";return}A(!0);const je=new FileReader;je.onload=function(qe){try{console.log(" File loaded, processing data...");const at=new Uint8Array(qe.target.result),Le=y2(at,{type:"array"}),Ct=Le.SheetNames[0],Mt=Le.Sheets[Ct],Vt=Ly.sheet_to_json(Mt,{header:1});console.log(" Parsed Excel data:",Vt),De(Vt,he),A(!1)}catch(at){console.error("Error processing Excel file:",at),r("Error reading Excel file: "+at.message,"error"),oe.target.value="",A(!1)}},je.onerror=function(){r("Failed to read file","error"),oe.target.value="",A(!1)},je.readAsArrayBuffer(Te)},[r]),Kt=C.useCallback(()=>{console.log(" Initializing Excel upload for all test types...");const oe=document.querySelectorAll(".excel-upload-btn");console.log(` Found ${oe.length} Excel upload buttons`),oe.forEach((he,Te)=>{const je=he.dataset.testType,qe=document.querySelector(`.excel-file-input[data-test-type="${je}"]`);console.log(` Processing button ${Te+1}: testType=${je}, fileInput=${qe?"found":"not found"}`),qe?(he._excelClickHandler&&he.removeEventListener("click",he._excelClickHandler),qe._excelChangeHandler&&qe.removeEventListener("change",qe._excelChangeHandler),he._excelClickHandler=()=>{console.log(` Excel upload button clicked for test type: ${je}`),qe.click()},qe._excelChangeHandler=at=>{console.log(` File input changed for test type: ${je}`),$t(at,je)},he.addEventListener("click",he._excelClickHandler),qe.addEventListener("change",qe._excelChangeHandler),console.log(` Excel upload initialized for test type: ${je}`)):console.warn(` File input not found for test type: ${je}`)}),console.log(" Excel upload initialization complete")},[$t]),De=C.useCallback((oe,he)=>{const Te=oe.filter(Mt=>Array.isArray(Mt)&&Mt.length>0&&Mt.some(Vt=>Vt&&Vt.toString().trim()!==""));console.log(" Original Excel data rows:",oe.length),console.log(" Filtered Excel data rows:",Te.length);const qe=ct(Te,he).dataRows;if(qe.length===0){const Mt="No data rows found after header processing. Please check your Excel file.";r(Mt,"error"),alert(Mt),fe(he);return}console.log(` Processing Excel data for test type: ${he}`),console.log(" Data rows after header processing:",qe);const at=Lt(qe,he);if(console.log(" Recognition result:",at),!at.recognized){console.log(` Excel data recognition failed for test type: ${he}`);const Mt="Excel data recognition failed. Please check your file format.";r(Mt,"error"),alert(Mt),fe(he);return}console.log(` Excel data recognition successful for test type: ${he}`);const Le=qe.length,Ct=we(he);if(Ct===0)console.log(` No question count specified, using CSV count: ${Le}`),D(Mt=>({...Mt,numQuestions:Le}));else if(Le!==Ct){const Mt=`Your CSV file has ${Le} data rows, but you specified ${Ct} questions.

Please either:
1. Change your question count to ${Le}, or
2. Fix your CSV file to have exactly ${Ct} data rows

Then try uploading again.`;r(Mt,"error"),fe(he);return}_e(qe,he)},[r]),ct=C.useCallback((oe,he)=>{if(oe.length===0)return{hasHeaders:!1,headerRow:null,dataRows:oe};const Te=oe[0],je=mt(he);if(At(Te,je).isLikelyHeader){const at=`The first row of your Excel file looks like it contains headers:

"${Te.join(" | ")}"

Does the first row contain column headers?

Click "OK" if YES (headers will be removed)
Click "Cancel" if NO (first row will be treated as data)`;if(window.confirm(at))return{hasHeaders:!0,headerRow:Te,dataRows:oe.slice(1)}}return{hasHeaders:!1,headerRow:null,dataRows:oe}},[]),mt=C.useCallback(oe=>{switch(oe){case"multipleChoice":return{keywords:["question","answer","correct","option","a","b","c","d","e","f"],expectedColumns:4};case"trueFalse":return{keywords:["question","answer","correct","true","false"],expectedColumns:2};case"input":return{keywords:["question","answer","correct"],expectedColumns:2};default:return{keywords:[],expectedColumns:0}}},[]),At=C.useCallback((oe,he)=>{if(!oe||oe.length===0)return{isLikelyHeader:!1};if(oe.length<he.expectedColumns)return{isLikelyHeader:!1};const Te=oe.join(" ").toLowerCase(),je=he.keywords.filter(at=>Te.includes(at.toLowerCase()));return{isLikelyHeader:je.length>he.keywords.length/2,keywordMatches:je}},[]),Lt=C.useCallback((oe,he)=>{if(oe.length===0)return r("No data rows found. Please check your Excel file.","error"),{recognized:!1,data:[]};console.log(` Checking data pattern for test type: ${he}`),console.log(" Excel data to validate:",oe);const Te=rr(oe,he);if(console.log(" Recognition result:",Te),!Te.matches){const je=`Your Excel file doesn't match the expected format.

Required format:
${Ee(he)}

Please review your Excel file and make sure it follows this format exactly.

Then try uploading again.`;return console.log(" Data pattern validation failed:",je),console.log(" Calling showNotification with message:",je),r(je,"error"),console.log(" showNotification called"),alert(je),{recognized:!1,data:[]}}return console.log(` Data pattern validation passed for test type: ${he}`),{recognized:!0,data:oe}},[r]),rr=C.useCallback((oe,he)=>{if(he==="multipleChoice")for(let Te=0;Te<oe.length;Te++){const je=oe[Te];if(je.length<4)return{matches:!1,issue:`Row ${Te+1} has ${je.length} columns but needs at least 4`};if(!je[0]||je[0].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no question in column 1`};if(!je[1]||je[1].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no correct answer in column 2`}}else if(he==="trueFalse")for(let Te=0;Te<oe.length;Te++){const je=oe[Te];if(je.length<2)return{matches:!1,issue:`Row ${Te+1} has ${je.length} columns but needs at least 2`};if(!je[0]||je[0].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no question in column 1`};const qe=je[1]?.toString().trim().toLowerCase();if(!qe||!["true","false","t","f"].includes(qe))return{matches:!1,issue:`Row ${Te+1} has invalid correct answer in column 2 (must be True/False)`}}else if(he==="input")for(let Te=0;Te<oe.length;Te++){const je=oe[Te];if(je.length<2)return{matches:!1,issue:`Row ${Te+1} has ${je.length} columns but needs at least 2`};if(!je[0]||je[0].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no question in column 1`};if(!je[1]||je[1].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no correct answer in column 2`}}return{matches:!0}},[]),Ee=C.useCallback(oe=>{switch(oe){case"multipleChoice":return`Column 1: Question
Column 2: Correct Answer (A, B, C, D, E, or F)
Column 3: Option A
Column 4: Option B
Column 5: Option C (optional)
Column 6: Option D (optional)
Column 7: Option E (optional)
Column 8: Option F (optional)`;case"trueFalse":return`Column 1: Question
Column 2: Correct Answer (True or False)`;case"input":return`Column 1: Question
Column 2: Correct Answer`;default:return"Unknown test type"}},[]),we=C.useCallback(oe=>E.numQuestions||0,[E.numQuestions]),fe=C.useCallback(oe=>{console.log(` Clearing file input for test type: ${oe}`)},[]),_e=C.useCallback((oe,he)=>{switch(console.log(` populateFromExcelForTestType called with testType: ${he}`),he){case"multipleChoice":case"multiple-choice":$e(oe);break;case"trueFalse":case"true-false":St(oe);break;case"input":pt(oe);break;default:console.log(` Unknown test type: ${he}`)}},[]),$e=C.useCallback(oe=>{console.log(" populateMultipleChoiceFromExcel called with:",oe);const he=Math.max(...oe.map(qe=>qe.length-2)),Te=Math.min(he,6);console.log(` Excel data has ${he} option columns, using ${Te} options`),D(qe=>({...qe,numOptions:Te}));const je={};oe.forEach((qe,at)=>{const Le=at+1;console.log(` Row ${at+1} data:`,qe);const Ct={question:(qe[0]||"").toString().trim(),options:[],correctAnswer:(qe[1]||"").toString().trim().toUpperCase()};console.log(` Question ${Le} correctAnswer:`,Ct.correctAnswer),["A","B","C","D","E","F"].slice(0,Te).forEach((dr,Nn)=>{const ln=(qe[Nn+2]||"").toString().trim();console.log(` Option ${Nn} (${dr}):`,ln),Ct.options.push(ln)}),je[Le]=Ct}),D(qe=>{const at={...qe,questions:je};return console.log(" Updating form data with:",at),at}),console.log(" Populated multiple choice questions from Excel:",je),r(`Successfully loaded ${oe.length} questions from CSV file!`,"success"),M(),Xt("multiple-choice")},[E.numOptions,M,r]),St=C.useCallback(oe=>{console.log(" populateTrueFalseFromExcel called with:",oe);const he={};oe.forEach((Te,je)=>{const qe=je+1,at={question:(Te[0]||"").toString().trim(),correctAnswer:Te[1]?.toString().trim().toLowerCase()==="true"?"true":"false"};he[qe]=at}),D(Te=>({...Te,questions:he})),console.log(" Populated true/false questions from Excel:",he),r(`Successfully loaded ${oe.length} questions from CSV file!`,"success"),X(),Xt("true-false")},[X,r]),pt=C.useCallback(oe=>{console.log(" populateInputFromExcel called with:",oe);const he={};oe.forEach((Te,je)=>{const qe=je+1,at=[];for(let Ct=1;Ct<Te.length;Ct++){const Mt=(Te[Ct]||"").toString().trim();Mt&&at.push(Mt)}const Le={question:(Te[0]||"").toString().trim(),correctAnswer:at[0]||"",correct_answers:at};console.log(` Excel question ${qe} data:`,Le),he[qe]=Le}),D(Te=>({...Te,questions:he})),console.log(" Populated input questions from Excel:",he),r(`Successfully loaded ${oe.length} questions from Excel file!`,"success"),K(),Xt("input")},[K,r]),Xt=C.useCallback(oe=>{switch(console.log(` Reattaching form event listeners for test type: ${oe}`),document.querySelectorAll('[data-listener-attached="true"]').forEach(Te=>{Te.removeEventListener("input",()=>{}),Te.removeAttribute("data-listener-attached")}),oe){case"multiple-choice":M();break;case"true-false":X();break;case"input":K();break;default:console.warn("Unknown test type for event listener reattachment:",oe)}console.log(` Form event listeners reattached for test type: ${oe}`)},[M,X,K]),Jt=C.useCallback(()=>{const oe=localStorage.getItem("test_creation_state");if(!oe)return console.log(" No test creation state found in localStorage"),!1;try{const he=JSON.parse(oe);console.log(" Found test creation state:",he);const Te=Date.now()-he.timestamp,je=1800*1e3;if(Te>je)return console.log(" Test creation state is too old, clearing it"),U(),!1;switch(a(!0),console.log(" Restored isInTestCreation flag to true"),se(),he.excelState&&V(),he.currentStep){case"testTypeSelection":console.log(" Restoring test type selection step"),d("typeSelection");break;case"multipleChoiceForm":console.log(" Restoring multiple choice form step"),y("multipleChoice"),d("formCreation");break;case"trueFalseForm":console.log(" Restoring true/false form step"),y("trueFalse"),d("formCreation");break;case"inputForm":console.log(" Restoring input form step"),y("input"),d("formCreation");break;case"testAssignment":case"assignment":console.log(" Restoring test assignment step"),console.log(" Cannot restore test assignment step without test data, going back to type selection"),d("typeSelection");break;default:console.log(" Unknown step in state, defaulting to type selection"),d("typeSelection")}return L(he.currentStep),!0}catch(he){return console.error(" Error restoring test creation state:",he),U(),!1}},[U,se,V,L]);C.useEffect(()=>{console.log(" Initializing Teacher Tests..."),ie(),Jt(),xe(),Kt()},[ie,Jt,xe,Kt]),C.useEffect(()=>{E.numQuestions>0&&g&&g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&(console.log(" Excel upload buttons rendered, initializing event listeners..."),setTimeout(()=>{Kt()},100))},[E.numQuestions,g,Kt]);const Yt=oe=>{console.log(" Test type selected:",oe),console.log(" Setting testType to:",oe),y(oe),d("formCreation"),D({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:""}),z("formCreation"),setTimeout(()=>{Kt()},100)},pr=(oe,he)=>{D(Te=>({...Te,[oe]:he}))},Ir=(oe,he,Te)=>{D(je=>({...je,questions:{...je.questions,[oe]:{...je.questions[oe],[he]:Te}}}))},xr=(oe,he,Te,je=0)=>{const qe={};for(let at=1;at<=Te;at++)oe==="multipleChoice"?qe[at]={question:"",options:Array.from({length:je},()=>""),correctAnswer:""}:oe==="trueFalse"?qe[at]={question:"",correctAnswer:""}:oe==="input"&&(qe[at]={question:"",correct_answers:[""]});D(at=>({...at,questions:qe})),oe==="multipleChoice"?(Z("multiple-choice"),J("multiple-choice")):oe==="trueFalse"?(Z("true-false"),J("true-false")):oe==="input"&&(Z("input"),J("input"))},Tr=async()=>{if(!g||!E.testName||!E.numQuestions){r("Please fill in all required fields","error");return}console.log(" Test form completed, proceeding to assignment step"),z("testAssignment",E),d("testAssignment"),r("Test form completed! Now select classes and subjects.","success")},Mr=(oe,he,Te,je,qe)=>{G(Te?at=>[...at,{grade:oe,class:he,subject_id:je,subject:qe}]:at=>at.filter(Le=>!(Le.grade===oe&&Le.class===he&&Le.subject_id===je)))},Wr=C.useCallback(async oe=>{console.log(" [DEBUG] handleMatchingTestSave called"),console.log(" [DEBUG] Received testData:",oe),console.log(" [DEBUG] Current formData:",E),console.log(" [DEBUG] Current testType:",g),console.log(" [DEBUG] Current user:",e),console.log(" [DEBUG] Current currentStep:",c),w(!0);try{const he=oe.blocks.map((qe,at)=>{const Le=oe.words.find(Vt=>Vt.blockId===qe.id)?.word||`Word ${at+1}`,Ct=oe.arrows.some(Vt=>Vt.startBlock===qe.id),Mt=oe.arrows.find(Vt=>Vt.startBlock===qe.id)||null;return{question_id:at+1,word:Le,block_coordinates:{x:qe.x,y:qe.y,width:qe.width,height:qe.height},has_arrow:Ct,arrow:Mt?{startX:Mt.startX,startY:Mt.startY,endX:Mt.endX,endY:Mt.endY,style:Mt.style||{}}:null}}),Te={teacher_id:e.teacher_id,test_name:E.testName||`Matching Test - ${new Date().toLocaleString()}`,image_url:oe.imageUrl,num_blocks:oe.blocks.length,questions:he,assignments:[]};console.log(" Sending matching test payload:",Te);const je={...E,testName:Te.test_name,numQuestions:Te.num_blocks,numOptions:0,questions:he.reduce((qe,at,Le)=>(qe[Le+1]={question:at.word,correctAnswer:at.word,options:[]},qe),{}),matchingTestData:oe};console.log(" Assignment form data:",je),D(je),z("testAssignment",je),console.log(" Setting current step to testAssignment"),d("testAssignment"),r("Matching test data saved! Now select classes and subjects.","success")}catch(he){console.error(" Error saving matching test:",he),r("Failed to save matching test: "+he.message,"error")}finally{w(!1)}},[e,E,g,r,z]),ce=C.useCallback(()=>{console.log(" Cancelling matching test creation"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),Se=C.useCallback(async oe=>{console.log(" [DEBUG] handleWordMatchingTestSave called"),console.log(" [DEBUG] Received testData:",oe),w(!0);try{D(he=>({...he,wordMatchingData:oe,numQuestions:oe.numQuestions||oe.wordPairs?.length||0})),d("testAssignment"),r("Word matching test created! Now assign it to classes.","success")}catch(he){console.error("Error saving word matching test:",he),r("Failed to save word matching test: "+he.message,"error")}finally{w(!1)}},[r]),pe=C.useCallback(()=>{console.log(" Cancelling word matching test creation"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),ve=C.useCallback(async oe=>{console.log(" [DEBUG] handleDrawingTestSave called"),console.log(" [DEBUG] Received testData:",oe),w(!0);try{D(he=>({...he,drawingData:oe,numQuestions:oe.num_questions||oe.questions?.length||0})),d("testAssignment"),r("Drawing test created! Now assign it to classes.","success")}catch(he){console.error(" Error saving drawing test:",he),r("Error saving drawing test","error")}finally{w(!1)}},[r]),be=C.useCallback(()=>{console.log(" Cancelling drawing test creation"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),ke=C.useCallback(()=>{console.log(" Cancelling fill blanks test creation"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),We=C.useCallback(async oe=>{console.log(" [DEBUG] handleFillBlanksTestSave called"),console.log(" [DEBUG] Received testData:",oe),w(!0);try{D(he=>({...he,fillBlanksData:oe,numQuestions:oe.num_questions||oe.blanks?.length||0})),d("testAssignment"),r("Fill blanks test created! Now assign it to classes.","success")}catch(he){console.error(" Error saving fill blanks test:",he),r("Error saving fill blanks test","error")}finally{w(!1)}},[r]),dt=C.useCallback(()=>{console.log(" Cancelling speaking test creation"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),Ve=C.useCallback(async oe=>{console.log(" [DEBUG] handleSpeakingTestSave called"),console.log(" [DEBUG] Received testData:",oe),w(!0);try{D(he=>({...he,speakingData:oe,numQuestions:oe.questions?.length||0})),d("testAssignment"),r("Speaking test created! Now assign it to classes.","success")}catch(he){console.error(" Error saving speaking test:",he),r("Error saving speaking test","error")}finally{w(!1)}},[r]);return o.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[o.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs(Ei,{mode:"wait",children:[c==="typeSelection"&&o.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs(et,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),o.jsx("span",{children:"Back to Main"})]}),o.jsx("div",{className:"flex-1"})]}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Create New Test"}),o.jsx("p",{className:"text-gray-600",children:"Choose the type of test you want to create"})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{type:"multipleChoice",title:"Multiple Choice",description:"Questions with multiple answer options",icon:"/pics/multiple-choice.png"},{type:"trueFalse",title:"True/False",description:"Questions with true or false answers",icon:"/pics/true-false.png"},{type:"input",title:"Input",description:"Questions requiring text input",icon:"/pics/input.png"},{type:"matching",title:"Picture Matching",description:"Labeling pictures",icon:"/pics/matching.png"},{type:"wordMatching",title:"Word Matching",description:"Matching word pairs by dragging or drawing arrows",icon:"/pics/matching-words.png"},{type:"drawing",title:"Drawing Test",description:"Interactive drawing tests with canvas for students",icon:"/pics/drawing.png"},{type:"fillBlanks",title:"Fill Blanks",description:"Text with multiple choice blanks",icon:"/pics/fill-blanks.png"},{type:"speaking",title:"Speaking Test",description:"Audio recording with AI-powered feedback",icon:"/pics/speaking.png"}].map(({type:oe,title:he,description:Te,icon:je})=>o.jsx(Ze.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"cursor-pointer",onClick:()=>Yt(oe),children:o.jsxs(bt,{className:"h-full text-center hover:shadow-lg transition-shadow",children:[o.jsx("div",{className:"mb-3 flex justify-center",children:o.jsx("img",{src:je,alt:he,className:"w-12 h-12 object-contain"})}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:he}),o.jsx("p",{className:"text-sm text-gray-600",children:Te})]})},oe))})]}),c==="formCreation"&&o.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:"flex space-x-2",children:o.jsx(et,{variant:"outline",onClick:re,children:" Back to Test Types"})}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Create ",g==="multipleChoice"?"Multiple Choice":g==="trueFalse"?"True/False":g==="input"?"Input":g==="drawing"?"Drawing":g==="fillBlanks"?"Fill Blanks":g==="wordMatching"?"Word Matching":g==="speaking"?"Speaking":"Picture Matching"," Test"]}),o.jsx("p",{className:"text-gray-600",children:"Fill in the test details and questions"})]})]})}),o.jsx(bt,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Information"}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Name"}),o.jsx("input",{type:"text",value:E.testName,onChange:oe=>pr("testName",oe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter test name"})]}),g!=="matching"&&g!=="wordMatching"&&g!=="drawing"&&g!=="fillBlanks"&&g!=="speaking"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Questions"}),o.jsx("input",{type:"number",min:"1",max:"50",value:E.numQuestions,onChange:oe=>{const he=parseInt(oe.target.value)||0;pr("numQuestions",he),he>0&&xr(g,E.testName,he,E.numOptions)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of questions"})]}),g==="multipleChoice"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Options per Question"}),o.jsx("input",{type:"number",min:"2",max:"6",value:E.numOptions,onChange:oe=>{const he=parseInt(oe.target.value)||0;pr("numOptions",he),he>0&&he<2&&r("Multiple choice tests require at least 2 options per question. Please enter 2 or more.","warning"),E.numQuestions>0&&xr(g,E.testName,E.numQuestions,he)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of options (2-6)"})]}),g!=="speaking"&&o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs("label",{className:"inline-flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",checked:!!E.enableTimer,onChange:oe=>pr("enableTimer",oe.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Enable timer for this test"})]}),E.enableTimer&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("label",{className:"text-sm text-gray-700",children:"Time (minutes):"}),o.jsx("input",{type:"number",min:"1",max:"1440",value:E.timerMinutes,onChange:oe=>pr("timerMinutes",oe.target.value.replace(/[^0-9]/g,"")),className:"w-28 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 30"})]}),g!=="drawing"&&g!=="matching"&&g!=="wordMatching"&&g!=="fillBlanks"&&g!=="speaking"&&o.jsxs("label",{className:"inline-flex items-center space-x-2 ml-6",children:[o.jsx("input",{type:"checkbox",checked:!!E.isShuffled,onChange:oe=>pr("isShuffled",oe.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Shuffle questions during test"})]})]})]})}),g==="matching"&&o.jsx(bt,{children:o.jsxs("div",{className:"space-y-4 text-center",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Picture Matching Test"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Upload an image and create interactive matching blocks with words."}),o.jsx(DL,{testName:E.testName,onTestSaved:Wr,onCancel:ce,onBackToCabinet:Ge,isSaving:k,validationErrors:{}})]})}),g==="wordMatching"&&o.jsx(bt,{children:o.jsxs("div",{className:"space-y-4 text-center",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Word Matching Test"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Create word pairs for students to match by dragging or drawing arrows."}),o.jsx(MW,{testName:E.testName,onTestSaved:Se,onCancel:pe,onBackToCabinet:Ge,isSaving:k,validationErrors:{}})]})}),g==="drawing"&&o.jsxs("div",{className:"drawing-test-section",children:[console.log(" Rendering DrawingTestCreator, testType:",g),o.jsx(CW,{testName:E.testName,onTestSaved:ve,onCancel:be,onBackToCabinet:Ge,isSaving:k,validationErrors:{}})]}),g==="fillBlanks"&&o.jsxs("div",{className:"fill-blanks-test-section",children:[console.log(" Rendering FillBlanksTestCreator, testType:",g),o.jsx(AW,{testName:E.testName,allowedTime:E.enableTimer&&parseInt(E.timerMinutes)||null,onTestSaved:We,onCancel:ke,onBackToCabinet:Ge,isSaving:k,validationErrors:{}})]}),g==="speaking"&&o.jsxs(bt,{children:[console.log(" Rendering SpeakingTestCreator, testType:",g),o.jsx(FW,{testName:E.testName,onTestSaved:Ve,onCancel:dt,onBackToCabinet:Ge,isSaving:k,validationErrors:{}})]}),g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&g!=="speaking"&&E.numQuestions>0&&o.jsx(bt,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Excel Upload"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Upload an Excel file to automatically populate questions, or fill them in manually below."}),o.jsxs("div",{className:"space-y-6",children:[g==="multipleChoice"&&ut.multipleChoice?.buttonVisible&&o.jsxs("div",{className:"flex items-start space-x-4",children:[o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"multiple-choice",disabled:T,children:T?o.jsxs(o.Fragment,{children:[o.jsx(Fr,{size:"sm",color:"white"}),o.jsx("span",{className:"font-medium",children:"Processing..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),o.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),o.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"multiple-choice"})]}),o.jsx("div",{className:"w-fit",children:o.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:o.jsxs("div",{className:"text-sm text-blue-800",children:[o.jsx("strong",{children:"Multiple Choice Format:"}),o.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[o.jsx("div",{children:"Column 1: Question"}),o.jsx("div",{children:"Column 2: Correct Answer (A-F)"}),o.jsx("div",{children:"Column 3: Option A text"}),o.jsx("div",{children:"Column 4: Option B text"}),o.jsx("div",{children:"Column 5: Option C text"}),o.jsx("div",{children:"Column 6: Option D text"})]})]})})})]}),g==="trueFalse"&&ut.trueFalse?.buttonVisible&&o.jsxs("div",{className:"flex items-start space-x-4",children:[o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"true-false",disabled:T,children:T?o.jsxs(o.Fragment,{children:[o.jsx(Fr,{size:"sm",color:"white"}),o.jsx("span",{className:"font-medium",children:"Processing..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),o.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),o.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"true-false"})]}),o.jsx("div",{className:"w-fit",children:o.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:o.jsxs("div",{className:"text-xs text-blue-800",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Format:"})," Question | Answer (true/false)"]}),o.jsxs("div",{className:"mt-1",children:[o.jsx("strong",{children:"Example:"})," The Earth is round | true"]}),o.jsxs("div",{className:"mt-1",children:[o.jsx("strong",{children:"Note:"})," Headers are optional"]})]})})})]}),g==="input"&&ut.input?.buttonVisible&&o.jsxs("div",{className:"flex items-start space-x-4",children:[o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"input",disabled:T,children:T?o.jsxs(o.Fragment,{children:[o.jsx(Fr,{size:"sm",color:"white"}),o.jsx("span",{className:"font-medium",children:"Processing..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),o.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),o.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"input"})]}),o.jsx("div",{className:"w-fit",children:o.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:o.jsxs("div",{className:"text-sm text-blue-800",children:[o.jsx("strong",{children:"Input Test Format:"}),o.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[o.jsx("div",{children:"Column 1: Question"}),o.jsx("div",{children:"Column 2: Answer 1"}),o.jsx("div",{children:"Column 3: Answer 2 (optional)"})]})]})})})]})]})]})}),g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&E.numQuestions>0&&o.jsx(bt,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Manual Question Entry"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Fill in the questions manually using the form below."})]})}),E.numQuestions>0&&o.jsx(bt,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Questions"}),o.jsx("div",{className:"space-y-6",children:Object.keys(E.questions).map(oe=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[o.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Question ",oe]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text"}),o.jsx("textarea",{value:E.questions[oe]?.question||"",onChange:he=>Ir(oe,"question",he.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"2",placeholder:"Enter the question text"})]}),g==="multipleChoice"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Answer Options"}),o.jsx("div",{className:"space-y-2",children:E.questions[oe]?.options?.map((he,Te)=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("span",{className:"w-6 text-sm font-medium text-gray-700",children:[String.fromCharCode(65+Te),":"]}),o.jsx("input",{type:"text",value:he,onChange:je=>{const qe=[...E.questions[oe].options];qe[Te]=je.target.value,Ir(oe,"options",qe)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Option ${String.fromCharCode(65+Te)}`})]},Te))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer"}),g==="multipleChoice"?o.jsx("div",{children:o.jsxs("select",{value:E.questions[oe]?.correctAnswer||"",onChange:he=>Ir(oe,"correctAnswer",he.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"",children:"Select correct answer"}),E.questions[oe]?.options?.map((he,Te)=>o.jsx("option",{value:String.fromCharCode(65+Te),children:String.fromCharCode(65+Te)},Te))]})}):g==="trueFalse"?o.jsxs("select",{value:E.questions[oe]?.correctAnswer||"",onChange:he=>Ir(oe,"correctAnswer",he.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsx("option",{value:"true",children:"True"}),o.jsx("option",{value:"false",children:"False"})]}):o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer(s)"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("input",{type:"text",value:E.questions[oe]?.correct_answers?.[0]||"",onChange:he=>{const je=[...E.questions[oe]?.correct_answers||[""]];je[0]=he.target.value,Ir(oe,"correct_answers",je)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter the primary correct answer"}),E.questions[oe]?.correct_answers?.slice(1).map((he,Te)=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"text",value:he,onChange:je=>{const qe=[...E.questions[oe]?.correct_answers||[]];qe[Te+1]=je.target.value,Ir(oe,"correct_answers",qe)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Alternative answer ${Te+2}`}),o.jsx("button",{type:"button",onClick:()=>{const je=[...E.questions[oe]?.correct_answers||[]];je.splice(Te+1,1),Ir(oe,"correct_answers",je)},className:"px-2 py-1 text-red-600 hover:text-red-800 text-sm",children:"Remove"})]},Te))||[],o.jsx("button",{type:"button",onClick:()=>{const Te=[...E.questions[oe]?.correct_answers||[""],""];Ir(oe,"correct_answers",Te)},className:"px-3 py-1 text-blue-600 hover:text-blue-800 text-sm border border-blue-300 rounded-md hover:bg-blue-50",children:"+ Add Alternative Answer"})]}),o.jsx("p",{className:"text-xs text-gray-500",children:"You can add multiple correct answers for the same question. Students will get credit for any of them."})]})]})]})]},oe))})]})}),E.testName&&E.numQuestions>0&&o.jsx("div",{className:"flex justify-end",children:o.jsx(et,{onClick:Tr,disabled:k,className:"px-8",children:k?o.jsxs(o.Fragment,{children:[o.jsx(Fr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test & Continue to Assignment"})})]}),c==="testAssignment"&&o.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsxs(et,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),o.jsx("span",{children:"Back to Main"})]}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Assign Test to Classes"}),o.jsx("p",{className:"text-gray-600",children:"Select which classes should take this test"})]})]}),o.jsx(et,{variant:"outline",onClick:()=>d("formCreation"),children:" Back to Test Form"})]}),o.jsx(bt,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Available Classes"}),v.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"text-6xl mb-4",children:""}),o.jsx("p",{className:"text-gray-500 text-lg",children:"No subjects available for assignment."}),o.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You need to assign subjects to grades and classes first."}),o.jsx("div",{className:"mt-4",children:o.jsx(et,{onClick:()=>window.location.href="/teacher/subjects",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Go to Subjects Page"})})]}):o.jsx("div",{className:"space-y-6",children:v.map(oe=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[o.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:oe.subject}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2",children:oe.classes.map(he=>o.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:I.some(Te=>Te.grade===he.grade&&Te.class===he.class&&Te.subject_id===oe.subject_id),onChange:Te=>Mr(he.grade,he.class,Te.target.checked,oe.subject_id,oe.subject),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsxs("span",{className:"text-sm text-gray-700",children:[he.grade,"/",he.class]})]},`${he.grade}-${he.class}-${oe.subject_id}`))})]},oe.subject_id))})]})}),I.length>0&&o.jsx("div",{className:"flex justify-end",children:o.jsx(et,{onClick:()=>Ue(g,null),disabled:b,className:"px-8",children:b?o.jsxs(o.Fragment,{children:[o.jsx(Fr,{size:"sm",color:"white",className:"mr-2"}),"Assigning Test..."]}):`Assign Test to ${I.length} Class${I.length>1?"es":""}`})})]})]})}),console.log(" Checking isAssigningTest:",F),F&&o.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Assigning test to classes..."}),o.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your assignment"})]})}),k&&o.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Saving test..."}),o.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we save your test"})]})}),o.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:t.map(oe=>o.jsx(Zo,{type:oe.type,message:oe.message,duration:oe.duration,onClose:()=>n(oe.id)},oe.id))})]})},Yte=({onDataLoaded:e,onError:t})=>{const r=Ri(),{user:n,isAuthenticated:s}=Hn(),{teacherData:a,loadTeacherData:i}=ev(),[l,c]=C.useState(!0),[d,f]=C.useState(""),[p,g]=C.useState([]),[y,v]=C.useState(null),[_,b]=C.useState([]),[N,k]=C.useState([]),[w,T]=C.useState([]),[A,F]=C.useState(null),[R,E]=C.useState(0);C.useEffect(()=>{ie()},[]),C.useCallback(async se=>{console.log(" Teacher login attempt...");try{const B=await Sn.teacherLogin(se);if(B.success)return ee("Login successful!","success"),await D(),B;throw new Error(B.error||"Login failed")}catch(B){throw console.error(" Teacher login error:",B),ee("Login failed. Please check your credentials.","error"),B}},[]);const D=C.useCallback(async()=>{console.log(" Loading teacher data...");try{if(c(!0),f(""),!s||!n){console.log(" User not authenticated"),f("User not authenticated");return}if(n.role!==ui.TEACHER){console.error(" Invalid user role for teacher data:",n.role),f("Access denied. Teacher role required.");return}console.log(" Fetching teacher data from service...");const se=await Sn.getTeacherData();if(se&&se.success)console.log(" Teacher data loaded successfully:",se),v(se.teacher||n),se.subjects&&(b(se.subjects),console.log(" Teacher subjects loaded:",se.subjects.length)),se.grades&&k(se.grades),se.classes&&T(se.classes),F(new Date),E(B=>B+1),e&&e(se),ee("Teacher data loaded successfully!","success");else throw new Error(se?.error||"Failed to load teacher data")}catch(se){console.error(" Error loading teacher data:",se);const B=se.message||"Failed to load teacher data";f(B),t&&t(se),ee(B,"error")}finally{c(!1)}},[s,n,e,t]),I=C.useCallback(()=>{console.log(" Returning to main cabinet..."),r("/teacher/cabinet")},[r]);C.useCallback(se=>{console.log(" Showing main cabinet with subjects:",se),se&&b(se),r("/teacher/cabinet")},[r]);const G=C.useCallback(()=>(console.log(" Rendering grade buttons..."),["M1","M2","M3","M4","M5","M6"].map(B=>({id:B,name:`Grade ${B}`,classes:Y(B)}))),[]),Y=C.useCallback(se=>Array.from({length:10},(z,U)=>U+1).map(z=>({id:`${se}-${z}`,name:`Class ${z}`,grade:se,classNumber:z})),[]),ee=C.useCallback((se,B)=>{const z={id:Date.now(),message:se,type:B,timestamp:new Date};g(U=>[...U,z]),setTimeout(()=>{g(U=>U.filter(V=>V.id!==z.id))},Ti.NOTIFICATION_DURATION)},[]),ie=C.useCallback(async()=>{console.log(" Initializing teacher data..."),await D()},[D]),re=C.useCallback(async()=>{console.log(" Refreshing teacher data..."),await D()},[D]);return C.useCallback(async se=>{console.log(" Updating teacher profile:",se);try{const B=await Sn.updateUserProfile(se);if(B.success)return v(z=>({...z,...se})),ee("Profile updated successfully!","success"),B;throw new Error(B.error||"Failed to update profile")}catch(B){throw console.error(" Error updating teacher profile:",B),ee("Failed to update profile","error"),B}},[]),C.useCallback(async se=>{console.log(" Changing teacher password...");try{const B=await Sn.changePassword(se);if(B.success)return ee("Password changed successfully!","success"),B;throw new Error(B.error||"Failed to change password")}catch(B){throw console.error(" Error changing teacher password:",B),ee("Failed to change password","error"),B}},[]),l?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Fr,{size:"lg"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Data..."})]})}):d?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsx("div",{className:"text-center",children:o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[o.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Data Error"}),o.jsx("p",{className:"text-red-600 mb-4",children:d}),o.jsxs("div",{className:"flex space-x-3 justify-center",children:[o.jsx(et,{variant:"primary",onClick:re,children:"Retry"}),o.jsx(et,{variant:"outline",onClick:I,children:"Go Back"})]})]})})}):o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx("div",{className:"bg-white shadow-sm border-b",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center py-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teacher Data"}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",A?A.toLocaleString():"Never"," | Version: ",R]})]}),o.jsxs("div",{className:"flex space-x-3",children:[o.jsx(et,{variant:"outline",onClick:re,children:"Refresh Data"}),o.jsx(et,{variant:"outline",onClick:I,children:"Back to Cabinet"})]})]})})}),o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teacher Information"}),y?o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Name:"}),o.jsx("p",{className:"text-sm text-gray-900",children:y.name||"N/A"})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Username:"}),o.jsx("p",{className:"text-sm text-gray-900",children:y.username||"N/A"})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Email:"}),o.jsx("p",{className:"text-sm text-gray-900",children:y.email||"N/A"})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Role:"}),o.jsx("p",{className:"text-sm text-gray-900",children:y.role||"N/A"})]})]}):o.jsx("p",{className:"text-gray-500",children:"No teacher information available"})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Subjects (",_.length,")"]}),_.length>0?o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:_.map((se,B)=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[o.jsx("h3",{className:"font-medium text-gray-900",children:se.name}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:se.description||"No description"}),se.classes&&se.classes.length>0&&o.jsxs("div",{className:"mt-2",children:[o.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Classes:"}),o.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:se.classes.map((z,U)=>o.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:[z.grade," - ",z.className]},U))})]})]},B))}):o.jsx("p",{className:"text-gray-500",children:"No subjects assigned"})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Grade Levels"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:G().map(se=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[o.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:se.name}),o.jsx("div",{className:"grid grid-cols-5 gap-1",children:se.classes.map(B=>o.jsx("button",{className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded transition-colors",onClick:()=>console.log("Class clicked:",B),children:B.classNumber},B.id))})]},se.id))})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Statistics"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-2xl font-semibold text-blue-600",children:_.length}),o.jsx("p",{className:"text-sm text-gray-500",children:"Subjects"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-2xl font-semibold text-green-600",children:N.length}),o.jsx("p",{className:"text-sm text-gray-500",children:"Grades"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-2xl font-semibold text-yellow-600",children:w.length}),o.jsx("p",{className:"text-sm text-gray-500",children:"Classes"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-2xl font-semibold text-purple-600",children:R}),o.jsx("p",{className:"text-sm text-gray-500",children:"Data Version"})]})]})]})]})}),o.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:p.map(se=>o.jsx(Zo,{type:se.type,message:se.message,onClose:()=>g(B=>B.filter(z=>z.id!==se.id))},se.id))})]})},Jte=({onBackToCabinet:e})=>{const t=Ri(),{user:r,isAuthenticated:n}=Hn(),{teacherData:s}=ev(),[a,i]=C.useState(!0),[l,c]=C.useState(""),[d,f]=C.useState([]),[p,g]=C.useState([]),[y,v]=C.useState([]),[_,b]=C.useState([]),[N,k]=C.useState(null),[w,T]=C.useState([]),[A,F]=C.useState(!1),[R,E]=C.useState(!1),[D,I]=C.useState(!1),[G,Y]=C.useState(!1),[ee,ie]=C.useState(null),[re,se]=C.useState(!0),[B,z]=C.useState(null);C.useEffect(()=>{He()},[]),C.useCallback(rt=>{console.log(" Rendering existing subjects:",rt),g(rt)},[]);const U=C.useCallback(()=>{console.log(" Showing subject selection prompt..."),F(!0),se(!1),V()},[]),V=C.useCallback(async()=>{console.log(" Loading existing subjects...");try{const rt=await Sn.getTeacherSubjects();rt.success&&rt.subjects&&rt.subjects.length>0?(console.log(" Existing subjects found:",rt.subjects),q(rt.subjects)):(console.log(" No existing subjects found"),b([]))}catch(rt){console.error(" Error loading existing subjects:",rt),Je("Failed to load existing subjects","error")}},[]),q=C.useCallback(rt=>{console.log(" Rendering subject selection:",rt);const Ie=[];rt.forEach(Pe=>{Pe.classes&&Array.isArray(Pe.classes)&&Pe.classes.forEach(Qe=>{Ie.push({id:`${Pe.subject_id}-${Qe.grade}-${Qe.class}`,subjectId:Pe.subject_id,subjectName:Pe.subject,grade:Qe.grade,class:Qe.class,displayText:`${Pe.subject} - ${Qe.grade}/${Qe.class}`})})}),b(Ie),console.log(" Processed subjects for selection:",Ie)},[]),L=C.useCallback(async rt=>{if(console.log(" Saving teacher subjects:",rt),!rt||rt.length===0){Je("Please select at least one subject and class combination.","warning");return}try{const Ie=rt.reduce((Qe,_t)=>{const gt=Qe.find(Bt=>Bt.subject_id===_t.subjectId);return gt?gt.classes.push({grade:_t.grade,class:_t.class}):Qe.push({subject_id:_t.subjectId,classes:[{grade:_t.grade,class:_t.class}]}),Qe},[]);console.log(" Transformed data for backend:",Ie);const Pe=await Sn.saveTeacherSubjects(Ie);if(Pe.success)Je("Subjects saved successfully!","success"),F(!1),se(!0),z(new Date),await V();else throw new Error(Pe.error||"Failed to save subjects")}catch(Ie){console.error(" Error saving subjects:",Ie),Je("Error saving subjects. Please try again.","error")}},[]),M=C.useCallback(()=>{console.log(" Toggling subject dropdown..."),E(rt=>!rt),I(!1)},[]),X=C.useCallback(async()=>{console.log(" Loading subjects for dropdown...");try{const rt=await Sn.getAllSubjects();if(rt.success)v(rt.subjects||[]),console.log(" Available subjects loaded:",rt.subjects?.length||0);else throw new Error(rt.error||"Failed to load subjects")}catch(rt){console.error(" Error loading subjects for dropdown:",rt),Je("Failed to load subjects","error")}},[]),K=C.useCallback(rt=>{console.log(" Subject selected:",rt);const Ie=y.find(Pe=>Pe.subject_id===parseInt(rt));Ie&&(k(Ie),I(!0),E(!1),Z())},[y]),Z=C.useCallback(()=>{console.log(" Loading grades and classes...")},[]),J=C.useCallback((rt,Ie)=>{console.log(" Saving classes for subject:",rt,Ie);const Pe={id:`${rt.subject_id}-${Date.now()}`,subjectId:rt.subject_id,subjectName:rt.subject,grade:Ie.grade,class:Ie.class,displayText:`${rt.subject} - ${Ie.grade}/${Ie.class}`};b(Qe=>[...Qe,Pe]),k(null),T([]),I(!1),me(`Added ${rt.subject} for ${Ie.grade}/${Ie.class}`)},[]),ne=C.useCallback(()=>{console.log(" Resetting subject selection..."),k(null),T([]),E(!1),I(!1)},[]),me=C.useCallback(rt=>{console.log(" Showing message:",rt),Je(rt,"success")},[]),xe=C.useCallback(rt=>{console.log(" Showing confirmation modal:",rt),ie(rt),Y(!0)},[]),Ne=C.useCallback(()=>{console.log(" Hiding confirmation modal..."),Y(!1),ie(null)},[]),le=C.useCallback(()=>{console.log(" Confirming save subjects..."),Ne(),L(_)},[_,L,Ne]),ge=C.useCallback(()=>{console.log(" Cancelling save subjects..."),Ne()},[Ne]),Ue=C.useCallback(rt=>{console.log(" Removing subject:",rt),b(Ie=>Ie.filter(Pe=>Pe.id!==rt)),Je("Subject removed","info")},[]);C.useCallback(()=>{console.log(" Showing edit subjects button..."),se(!0)},[]),C.useCallback(()=>{console.log(" Hiding edit subjects button..."),se(!1)},[]);const Ge=C.useCallback(rt=>{console.log(" Generating class buttons for grade:",rt);let Ie;return rt===1||rt===2?Ie=["15","16"]:rt===3?Ie=["15","16"]:rt===4?Ie=["13","14"]:rt===5||rt===6?Ie=["13","14"]:Ie=[],Ie.map(Pe=>({id:`${rt}-${Pe}`,grade:rt,class:Pe,displayText:`${rt}/${Pe}`}))},[]);C.useCallback((rt,Ie)=>{console.log(" Showing class results:",rt,Ie),t("/teacher/results")},[t]);const Je=C.useCallback((rt,Ie)=>{const Pe={id:Date.now(),message:rt,type:Ie,timestamp:new Date};f(Qe=>[...Qe,Pe]),setTimeout(()=>{f(Qe=>Qe.filter(_t=>_t.id!==Pe.id))},Ti.NOTIFICATION_DURATION)},[]),He=C.useCallback(async()=>{console.log(" Initializing teacher subjects...");try{if(i(!0),c(""),!n||!r){console.log(" User not authenticated"),c("User not authenticated");return}if(r.role!==ui.TEACHER){console.error(" Invalid user role for teacher subjects:",r.role),c("Access denied. Teacher role required.");return}await V(),await X(),console.log(" Teacher subjects initialization complete!")}catch(rt){console.error(" Error initializing teacher subjects:",rt),c("Failed to initialize teacher subjects")}finally{i(!1)}},[n,r,V,X]),Ft=C.useCallback(()=>{e?e():t("/teacher/cabinet")},[e,t]);return a?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Fr,{size:"lg"}),o.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Subjects..."})]})}):l?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsx("div",{className:"text-center",children:o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[o.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Subjects Error"}),o.jsx("p",{className:"text-red-600 mb-4",children:l}),o.jsx(et,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx("div",{className:"bg-white shadow-sm border-b",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center py-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Subject Management"}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",B?B.toLocaleString():"Never"]})]}),o.jsxs("div",{className:"flex space-x-3",children:[re&&o.jsx(et,{variant:"primary",onClick:U,children:"Edit Subjects"}),o.jsx(et,{variant:"outline",onClick:Ft,children:"Back to Cabinet"})]})]})})}),o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:o.jsxs("div",{className:"space-y-6",children:[!A&&o.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Your Assigned Subjects"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your teaching subjects and class assignments"})]}),o.jsx("div",{className:"flex space-x-3",children:o.jsxs(et,{variant:"primary",onClick:U,className:"px-6 py-2",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Subjects"]})})]}),p.length>0?o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map((rt,Ie)=>o.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:rt.subject}),rt.classes&&rt.classes.length>0&&o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Assigned Classes:"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:rt.classes.map((Pe,Qe)=>o.jsxs("span",{className:"px-3 py-1 bg-blue-500 text-white text-sm font-medium rounded-full",children:["Grade ",Pe.grade," - Class ",Pe.class]},Qe))})]})]}),o.jsx("div",{className:"ml-4",children:o.jsx(et,{variant:"outline",size:"sm",onClick:()=>Ue(rt.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]})},Ie))}):o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:o.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned yet"}),o.jsx("p",{className:"text-gray-500 mb-6",children:"Get started by adding your teaching subjects and class assignments"}),o.jsxs(et,{variant:"primary",onClick:U,className:"px-6 py-3",children:[o.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Your First Subject"]})]})]}),A&&o.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Select Subjects and Classes"}),o.jsx("p",{className:"text-gray-600",children:"Choose the subjects you want to teach and assign them to specific classes"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"mb-8",children:[o.jsxs("div",{className:"flex items-center mb-4",children:[o.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:o.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:"1"})}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-lg font-semibold text-gray-900",children:"Select Subject"}),o.jsx("p",{className:"text-gray-600",children:"Choose the subject you want to teach"})]})]}),o.jsxs("div",{className:"relative",children:[o.jsxs(et,{variant:"outline",onClick:M,className:"w-full justify-between p-4 h-auto text-left border-2 border-gray-200 hover:border-blue-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white rounded-xl shadow-sm",children:[o.jsx("span",{className:"text-gray-900 font-medium",children:N?N.subject:"Select a subject"}),o.jsx("svg",{className:"w-5 h-5 ml-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),R&&o.jsx("div",{className:"absolute z-10 w-full mt-2 bg-white border-2 border-gray-200 rounded-xl shadow-xl max-h-60 overflow-y-auto",children:y.map(rt=>o.jsx("button",{onClick:()=>K(rt.subject_id),className:"w-full px-4 py-4 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 border-b border-gray-100 last:border-b-0",children:o.jsx("span",{className:"text-gray-900 font-medium",children:rt.subject})},rt.subject_id))})]})]}),D&&N&&o.jsxs("div",{className:"mb-8",children:[o.jsxs("div",{className:"flex items-center mb-6",children:[o.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3",children:o.jsx("span",{className:"text-green-600 font-semibold text-sm",children:"2"})}),o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Select Classes for ",N.subject]}),o.jsx("p",{className:"text-gray-600",children:"Choose which classes you want to teach this subject to"})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(rt=>o.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:[o.jsxs("div",{className:"flex items-center mb-4",children:[o.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-2",children:o.jsx("span",{className:"text-white font-bold text-xs",children:rt})}),o.jsxs("h4",{className:"font-semibold text-gray-900",children:["Grade ",rt]})]}),o.jsx("div",{className:"space-y-3",children:Ge(rt).map(Ie=>o.jsx(et,{variant:"outline",size:"sm",onClick:()=>J(N,Ie),className:"w-full text-sm py-2 px-4 border-green-300 hover:border-green-400 hover:bg-green-100 focus:ring-2 focus:ring-green-500 rounded-lg font-medium",children:Ie.displayText},Ie.id))})]},rt))})]}),_.length>0&&o.jsxs("div",{className:"mb-8",children:[o.jsxs("div",{className:"flex items-center mb-4",children:[o.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-3",children:o.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:"3"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Selected Subjects"}),o.jsx("p",{className:"text-gray-600",children:"Review your subject and class selections"})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:_.map(rt=>o.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-4 hover:shadow-md transition-shadow duration-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"flex-1",children:o.jsx("span",{className:"text-sm font-semibold text-purple-900",children:rt.displayText})}),o.jsx(et,{variant:"outline",size:"sm",onClick:()=>Ue(rt.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300 focus:ring-2 focus:ring-red-500 rounded-lg",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},rt.id))})]}),o.jsxs("div",{className:"flex justify-between items-center pt-6 border-t-2 border-gray-100",children:[o.jsx("div",{className:"text-sm text-gray-500",children:_.length>0?`${_.length} subject${_.length>1?"s":""} selected`:"No subjects selected"}),o.jsxs("div",{className:"flex space-x-4",children:[o.jsxs(et,{variant:"outline",onClick:()=>{F(!1),se(!0),ne()},className:"px-6 py-3 text-sm font-medium text-gray-700 bg-white border-2 border-gray-300 hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 rounded-xl",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Cancel"]}),o.jsxs(et,{variant:"primary",onClick:()=>xe({type:"save",data:_}),disabled:_.length===0,className:"px-8 py-3 text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-indigo-600 border border-transparent rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),D?"Next: Select Classes":"Save Subjects"]})]})]})]})]})]})}),G&&o.jsx(Go,{isOpen:G,onClose:Ne,title:"Confirm Save",variant:"confirmation",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to save ",ee?.data?.length||0," subject assignments?"]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx(et,{variant:"outline",onClick:ge,children:"Cancel"}),o.jsx(et,{variant:"primary",onClick:le,children:"Save"})]})]})}),o.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:d.map(rt=>o.jsx(Zo,{type:rt.type,message:rt.message,onClose:()=>f(Ie=>Ie.filter(Pe=>Pe.id!==rt.id))},rt.id))})]})},Qte=()=>{const{user:e,role:t,isAuthenticated:r,isLoading:n}=Hn(),[s,a]=C.useState("cabinet");return!r||t!=="teacher"?o.jsx(a0,{to:"/login",replace:!0}):n?o.jsxs("div",{className:"teacher-app-loading",children:[o.jsx(Fr,{}),o.jsx("p",{children:"Loading teacher interface..."})]}):o.jsx("div",{className:"teacher-app",children:o.jsxs(b2,{children:[o.jsx(ds,{path:"/",element:o.jsx(S3,{})}),o.jsx(ds,{path:"/cabinet",element:o.jsx(S3,{})}),o.jsx(ds,{path:"/tests",element:o.jsx(k3,{})}),o.jsx(ds,{path:"/tests/create",element:o.jsx(k3,{})}),o.jsx(ds,{path:"/data",element:o.jsx(Yte,{})}),o.jsx(ds,{path:"/subjects",element:o.jsx(Jte,{})}),o.jsx(ds,{path:"/results",element:o.jsx(cP,{})}),o.jsx(ds,{path:"*",element:o.jsx(a0,{to:"/teacher",replace:!0})})]})})},Fe={container:"min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100",mainContainer:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",header:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg",headerContent:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",headerFlex:"flex justify-between items-center",adminInfo:"flex items-center space-x-4",adminAvatar:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",adminText:"text-lg sm:text-xl md:text-2xl font-bold text-white",adminSubtext:"text-purple-100 text-sm sm:text-base md:text-lg",menuContainer:"relative admin-menu",menuButton:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",menuDropdown:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",menuItem:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-purple-50 transition-colors",menuItemLogout:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",cardContainer:"bg-white rounded-xl shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-300",cardHeader:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-indigo-50",cardTitle:"text-xl font-bold text-gray-800",cardBody:"p-6",buttonGroup:"flex flex-wrap gap-3 mb-6",buttonPrimary:"bg-purple-600 hover:bg-purple-700 text-white font-medium px-4 py-2 rounded-lg transition-colors duration-200",buttonSecondary:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium px-4 py-2 rounded-lg transition-colors duration-200",formContainer:"bg-gray-50 rounded-lg p-6 border border-gray-200",formGrid:"grid grid-cols-1 md:grid-cols-2 gap-4",formGroup:"space-y-2",formLabel:"block text-sm font-medium text-gray-700",formInput:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors duration-200",formCheckbox:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded",formActions:"flex space-x-3 pt-4",table:"min-w-full divide-y divide-gray-200",tableHeader:"bg-gray-50",tableHeaderCell:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",tableBody:"bg-white divide-y divide-gray-200",tableRow:"hover:bg-gray-50 transition-colors duration-150",tableCell:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",statusActive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",statusInactive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",modalOverlay:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",modalContent:"bg-white rounded-lg p-6 w-full max-w-md mx-4 shadow-xl",modalTitle:"text-xl font-semibold text-gray-900 mb-4",modalActions:"flex space-x-3 pt-4"},Zte=()=>{const{user:e,isAdmin:t,logout:r}=Hn(),{get:n,post:s,delete:a}=Xi(),i=C.useCallback(async()=>{try{y({type:"info",message:"Refreshing class summary view..."});const ae=await s("/.netlify/functions/refresh-class-summary-semester",{});ae&&(ae.success||ae.message)?y({type:"success",message:"Class summary view refreshed."}):y({type:"error",message:ae?.error||"Failed to refresh view"})}catch(ae){y({type:"error",message:"Failed to refresh view"}),console.error("Refresh class summary error:",ae)}},[s]),l=C.useCallback(async()=>{try{y({type:"info",message:"Checking for overdue assignments..."});const ae=await s("/.netlify/functions/check-overdue-assignments",{});if(ae&&ae.success){const ue=ae.overdue_count||0;ue>0?y({type:"success",message:`Found and marked ${ue} overdue assignments as inactive.`}):y({type:"info",message:"No overdue assignments found."})}else y({type:"error",message:ae?.error||"Failed to check assignments"})}catch(ae){y({type:"error",message:"Failed to check assignments"}),console.error("Check overdue assignments error:",ae)}},[s]),[c,d]=C.useState(!1),[f,p]=C.useState(null),[g,y]=C.useState(null),[v,_]=C.useState(!1),[b,N]=C.useState(!1),[k,w]=C.useState(!1),[T,A]=C.useState(!1),[F,R]=C.useState(""),[E,D]=C.useState(null),[I,G]=C.useState({}),[Y,ee]=C.useState(null),[ie,re]=C.useState({}),[se,B]=C.useState(null),[z,U]=C.useState({}),[V,q]=C.useState([]),[L,M]=C.useState(""),[X,K]=C.useState(""),[Z,J]=C.useState(""),[ne,me]=C.useState(!0),[xe,Ne]=C.useState(!1),[le,ge]=C.useState([]),[Ue,Ge]=C.useState(""),[Je,He]=C.useState(""),[Ft,rt]=C.useState(""),[Ie,Pe]=C.useState(!1),[Qe,_t]=C.useState(!1),[gt,Bt]=C.useState([]),[Ut,it]=C.useState([]),[Ye,xt]=C.useState([]),[ut,wt]=C.useState([]),[$t,Kt]=C.useState(!1),[De,ct]=C.useState(!1),[mt,At]=C.useState(!1),[Lt,rr]=C.useState(!1),[Ee,we]=C.useState({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),[fe,_e]=C.useState({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),[$e,St]=C.useState({subject_id:"",subject:"",description:"",is_active:!0}),[pt,Xt]=C.useState({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""});C.useEffect(()=>{console.log(" AdminCabinet component mounted - initializing..."),Jt()},[]),C.useEffect(()=>{const ae=ue=>{Ie&&!ue.target.closest(".admin-menu")&&Pe(!1)};return document.addEventListener("mousedown",ae),()=>{document.removeEventListener("mousedown",ae)}},[Ie]);const Jt=C.useCallback(async()=>{try{d(!0),await xr(),console.log("Admin app initialized")}catch(ae){p("Failed to initialize admin app"),console.error("Admin app initialization error:",ae)}finally{d(!1)}},[]),Yt=C.useCallback(()=>{Pe(ae=>!ae)},[]),pr=C.useCallback(()=>{_t(!0),Pe(!1)},[]),Ir=C.useCallback(()=>{_t(!1)},[]),xr=C.useCallback(async()=>{try{await Promise.all([Tr(),Mr(),Wr(),ce()])}catch(ae){console.error("Error loading admin data:",ae),p("Failed to load admin data")}},[]),Tr=C.useCallback(async()=>{try{const ae="admin_users_",ue=Rn(ae);if(ue){console.log(" Using cached users data"),Bt(ue);return}const Ce=await n("/.netlify/functions/get-all-users");console.log(" Users response:",Ce);const Oe=Ce.users||[];Bt(Oe),Dn(ae,Oe,Bn.admin_users),console.log(" Users set to state:",Oe)}catch(ae){console.error("Error loading users:",ae)}},[n]),Mr=C.useCallback(async()=>{try{const ae="admin_teachers_",ue=Rn(ae);if(ue){console.log(" Using cached teachers data"),it(ue);return}const Ce=await n("/.netlify/functions/get-all-teachers");console.log(" Teachers response:",Ce);const Oe=Ce.teachers||[];it(Oe),Dn(ae,Oe,Bn.admin_teachers),console.log(" Teachers set to state:",Oe)}catch(ae){console.error("Error loading teachers:",ae)}},[n]),Wr=C.useCallback(async()=>{try{const ae="admin_subjects_",ue=Rn(ae);if(ue){console.log(" Using cached subjects data"),xt(ue);return}const Ce=await n("/.netlify/functions/get-all-subjects");console.log(" Subjects response:",Ce);const Oe=Ce.subjects||[];xt(Oe),Dn(ae,Oe,Bn.admin_subjects),console.log(" Subjects set to state:",Oe)}catch(ae){console.error("Error loading subjects:",ae)}},[n]),ce=C.useCallback(async()=>{try{const ae="admin_academic_years_",ue=Rn(ae);if(ue){console.log(" Using cached academic years data"),wt(ue);return}const Oe=(await n("/.netlify/functions/get-academic-year")).academic_years||[];wt(Oe),Dn(ae,Oe,Bn.admin_academic_years)}catch(ae){console.error("Error loading academic year:",ae)}},[n]),Se=C.useCallback(async()=>{try{if(A(!T),!T){const[ae,ue]=await Promise.all([n("/.netlify/functions/get-all-tests"),n("/.netlify/functions/get-test-assignments")]);console.log(" Active tests response:",ae),console.log(" Assignments response:",ue);const Ce=ae.tests||[],Xe=(ue.assignments||[]).reduce((ht,fr)=>{const mr=`${fr.test_type}-${fr.test_id}`;return ht[mr]||(ht[mr]=[]),ht[mr].push(fr),ht},{}),It=Ce.map(ht=>{const fr=`${ht.test_type}-${ht.test_id}`,mr=Xe[fr]||[],nt=mr.some(jt=>jt.is_active);return{...ht,is_active:nt,assignments:mr}});q(It),console.log(" All tests with status set to state:",It)}}catch(ae){console.error("Error loading tests:",ae),y({type:"error",message:"Failed to load tests"})}},[n,T]),pe=C.useCallback((ae,ue)=>{we(Ce=>({...Ce,[ae]:ue}))},[]),ve=C.useCallback((ae,ue)=>{_e(Ce=>({...Ce,[ae]:ue}))},[]),be=C.useCallback((ae,ue)=>{St(Ce=>({...Ce,[ae]:ue}))},[]);C.useCallback(()=>{console.log(" Testing local storage...");try{const ae={test:"data",timestamp:Date.now()};localStorage.setItem("test",JSON.stringify(ae));const ue=JSON.parse(localStorage.getItem("test"));console.log(" Local storage test successful:",ue),y({type:"success",message:"Local storage test successful"})}catch(ae){console.error(" Local storage test failed:",ae),y({type:"error",message:"Local storage test failed"})}},[]),C.useCallback(()=>{console.log(" Clearing local storage...");try{localStorage.clear(),console.log(" Local storage cleared"),y({type:"success",message:"Local storage cleared"})}catch(ae){console.error(" Error clearing local storage:",ae),y({type:"error",message:"Error clearing local storage"})}},[]),C.useCallback(async()=>{console.log(" Checking teacher subjects...");try{const ue=(await n("/.netlify/functions/get-all-teachers")).data||[];console.log(" Teachers data:",ue),y({type:"success",message:`Found ${ue.length} teachers`})}catch(ae){console.error(" Error checking teacher subjects:",ae),y({type:"error",message:"Error checking teacher subjects"})}},[n]);const ke=C.useCallback(async ae=>{ae.preventDefault();try{console.log(" Submitting user:",Ee);const ue=await s("/.netlify/functions/add-user",Ee);ue.success?(y({type:"success",message:"User added successfully"}),Kt(!1),we({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),Tr()):y({type:"error",message:ue.message||"Failed to add user"})}catch(ue){console.error(" Error adding user:",ue),y({type:"error",message:"Error adding user"})}},[Ee,s,Tr]),We=C.useCallback(async ae=>{ae.preventDefault();try{console.log(" Submitting teacher:",fe);const ue=await s("/.netlify/functions/add-teacher",fe);ue.success?(y({type:"success",message:"Teacher added successfully"}),ct(!1),_e({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),Mr()):y({type:"error",message:ue.message||"Failed to add teacher"})}catch(ue){console.error(" Error adding teacher:",ue),y({type:"error",message:"Error adding teacher"})}},[fe,s,Mr]),dt=C.useCallback(async ae=>{ae.preventDefault();try{console.log(" Submitting subject:",$e);const ue=await s("/.netlify/functions/add-subject",$e);ue.success?(y({type:"success",message:"Subject added successfully"}),At(!1),St({subject_id:"",subject:"",description:"",is_active:!0}),Wr()):y({type:"error",message:ue.message||"Failed to add subject"})}catch(ue){console.error(" Error adding subject:",ue),y({type:"error",message:"Error adding subject"})}},[$e,s,Wr]),Ve=C.useCallback(ae=>{D(ae),G({name:ae.name||"",surname:ae.surname||"",grade:ae.grade||"",class:ae.class||"",student_id:ae.student_id||"",nickname:ae.nickname||"",password:ae.password||"",is_active:ae.is_active!==void 0?ae.is_active:!0})},[]),oe=C.useCallback(async()=>{try{const ae=[];Object.keys(I).forEach(ue=>{ue!=="student_id"&&I[ue]!==E[ue]&&ae.push({fieldName:ue,newValue:I[ue]})});for(const ue of ae)await s("/.netlify/functions/update-user",{userId:E.student_id,fieldName:ue.fieldName,newValue:ue.newValue});y({type:"success",message:"User updated successfully!"}),D(null),G({}),Tr()}catch{y({type:"error",message:"Failed to update user"})}},[I,E,s,Tr]),he=C.useCallback(async ae=>{if(window.confirm("Are you sure you want to delete this user?"))try{(await s("/.netlify/functions/delete-user",{userId:ae})).success&&(y({type:"success",message:"User deleted successfully!"}),Tr())}catch{y({type:"error",message:"Failed to delete user"})}},[s,Tr]),Te=C.useCallback(ae=>{ee(ae),re({teacher_id:ae.teacher_id||"",username:ae.username||"",password:ae.password||"",first_name:ae.first_name||"",last_name:ae.last_name||"",is_active:ae.is_active!==void 0?ae.is_active:!0})},[]),je=C.useCallback(async()=>{try{const ae=[];Object.keys(ie).forEach(ue=>{ue!=="teacher_id"&&ie[ue]!==Y[ue]&&ae.push({fieldName:ue,newValue:ie[ue]})});for(const ue of ae)await s("/.netlify/functions/update-teacher",{teacherId:Y.teacher_id,fieldName:ue.fieldName,newValue:ue.newValue});y({type:"success",message:"Teacher updated successfully!"}),ee(null),re({}),Mr()}catch{y({type:"error",message:"Failed to update teacher"})}},[ie,Y,s,Mr]),qe=C.useCallback(async ae=>{if(window.confirm("Are you sure you want to delete this teacher?"))try{(await s("/.netlify/functions/delete-teacher",{teacherId:ae})).success&&(y({type:"success",message:"Teacher deleted successfully!"}),Mr())}catch{y({type:"error",message:"Failed to delete teacher"})}},[s,Mr]),at=C.useCallback(ae=>{B(ae),U({subject_id:ae.subject_id||"",subject:ae.subject||""})},[]),Le=C.useCallback(async()=>{try{const ae=[];Object.keys(z).forEach(ue=>{ue!=="subject_id"&&z[ue]!==se[ue]&&ae.push({fieldName:ue,newValue:z[ue]})});for(const ue of ae)await s("/.netlify/functions/update-subject",{subjectId:se.subject_id,fieldName:ue.fieldName,newValue:ue.newValue});y({type:"success",message:"Subject updated successfully!"}),B(null),U({}),Wr()}catch{y({type:"error",message:"Failed to update subject"})}},[z,se,s,Wr]),Ct=C.useCallback(async ae=>{if(window.confirm("Are you sure you want to delete this subject?"))try{const ue=await s("/.netlify/functions/delete-subject",{subjectId:ae});ue.success?(y({type:"success",message:"Subject deleted successfully!"}),Wr()):y({type:"error",message:ue.message||"Failed to delete subject"})}catch{y({type:"error",message:"Failed to delete subject"})}},[s,Wr]),Mt=C.useCallback((ae,ue)=>{Xt(Ce=>({...Ce,[ae]:ue}))},[]),Vt=C.useCallback(async ae=>{if(ae.preventDefault(),!pt.startDate||!pt.endDate||!pt.teacherId){y({type:"error",message:"Please fill in all required fields (Start Date, End Date, Teacher ID)"});return}if(window.confirm("Are you sure you want to delete all test data for the selected criteria? This action cannot be undone."))try{const ue=await s("/.netlify/functions/delete-test-data",pt);ue.success?(y({type:"success",message:`Successfully deleted ${ue.deletedCount} test records!`}),rr(!1),Xt({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""})):y({type:"error",message:ue.message||"Failed to delete test data"})}catch{y({type:"error",message:"Failed to delete test data"})}},[pt,s]),dr=C.useCallback(async(ae,ue,Ce)=>{try{const Oe=await n("/.netlify/functions/get-test-assignments");if(Oe.success&&Oe.assignments){const Xe=Oe.assignments.filter(It=>It.test_id===parseInt(ae)&&It.test_type===ue);if(Xe.length===0){y({type:"error",message:"No assignments found for this test"});return}for(const It of Xe){const ht=await s("/.netlify/functions/remove-assignment",{teacher_id:Ce,assignment_id:It.assignment_id,test_type:ue,test_id:ae});if(!ht.success){y({type:"error",message:`Failed to complete test: ${ht.message}`});return}}y({type:"success",message:"Test marked as complete successfully!"}),await Se()}else y({type:"error",message:"Failed to get test assignments"})}catch(Oe){console.error("Error completing test:",Oe),y({type:"error",message:"Failed to complete test"})}},[s,n,Se]),Nn=C.useCallback(async(ae,ue,Ce)=>{try{const Oe=await n("/.netlify/functions/get-test-assignments");if(Oe.success&&Oe.assignments){const Xe=Oe.assignments.filter(It=>It.test_id===parseInt(ae)&&It.test_type===ue);if(Xe.length===0){y({type:"error",message:"No assignments found for this test"});return}for(const It of Xe){const ht=await s("/.netlify/functions/remove-assignment",{teacher_id:Ce,assignment_id:It.assignment_id,test_type:ue,test_id:ae,mark_active:!0});if(!ht.success){y({type:"error",message:`Failed to reactivate test: ${ht.message}`});return}}y({type:"success",message:"Test marked as active successfully!"}),await Se()}else y({type:"error",message:"Failed to get test assignments"})}catch(Oe){console.error("Error reactivating test:",Oe),y({type:"error",message:"Failed to reactivate test"})}},[s,n,Se]),ln=C.useCallback(async()=>{try{if(Ne(!xe),!xe){const ae=await n("/.netlify/functions/get-all-tests");console.log(" Actual tests response:",ae),ge(ae.tests||[]),console.log(" Actual tests set to state:",ae.tests||[])}}catch(ae){console.error("Error loading actual tests:",ae),y({type:"error",message:"Failed to load tests"})}},[n,xe]),In=C.useCallback(async(ae,ue,Ce)=>{try{const Oe=await s("/.netlify/functions/delete-test",{test_id:ae,test_type:ue,teacher_id:Ce});Oe.success?(y({type:"success",message:"Test deleted successfully!"}),await ln()):y({type:"error",message:`Failed to delete test: ${Oe.message}`})}catch(Oe){console.error("Error deleting test:",Oe),y({type:"error",message:"Failed to delete test"})}},[s,ln]),Pr=F?gt.filter(ae=>ae.grade.toString()===F):gt,Or=V.filter(ae=>{const ue=!L||ae.teacher_id===L,Ce=!X||new Date(ae.created_at)>=new Date(X),Oe=!Z||new Date(ae.created_at)<=new Date(Z+"T23:59:59"),Xe=ne?ae.is_active:!ae.is_active;return ue&&Ce&&Oe&&Xe}),cr=le.filter(ae=>{const ue=!Ue||ae.teacher_id===Ue,Ce=!Je||new Date(ae.created_at)>=new Date(Je),Oe=!Ft||new Date(ae.created_at)<=new Date(Ft+"T23:59:59");return ue&&Ce&&Oe});return o.jsxs(Ze.div,{id:"admin-cabinet-main",className:Fe.container,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[o.jsx(Ze.div,{className:Fe.header,initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:o.jsx("div",{className:Fe.headerContent,children:o.jsxs("div",{className:Fe.headerFlex,children:[o.jsxs(Ze.div,{className:Fe.adminInfo,initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(Ze.div,{className:Fe.adminAvatar,initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:o.jsx("span",{className:"text-white font-semibold text-xl",children:e?.username?.charAt(0)||"A"})})}),o.jsxs("div",{children:[o.jsx("h1",{className:Fe.adminText,children:e?.username||"Administrator"}),o.jsx("p",{className:Fe.adminSubtext,children:"Administrator Dashboard"})]})]}),o.jsxs(Ze.div,{className:Fe.menuContainer,initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[o.jsxs("button",{onClick:Yt,className:Fe.menuButton,style:{zIndex:1e3},children:[o.jsx("span",{className:"hidden sm:inline",children:"Menu"}),o.jsx(Ze.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:Ie?180:0},transition:{duration:.2},children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),o.jsx(Ei,{children:Ie&&o.jsx(Ze.div,{className:Fe.menuDropdown,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:o.jsxs("div",{className:"py-2",children:[o.jsx(Ze.button,{onClick:pr,className:Fe.menuItem,whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),o.jsx(Ze.button,{onClick:()=>{Yt(),r()},className:Fe.menuItemLogout,whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),c&&o.jsx(Fr,{text:"Loading..."}),f&&o.jsx(Zo,{type:"error",message:f,onClose:()=>p(null)}),g&&o.jsx(Zo,{type:g.type,message:g.message,onClose:()=>y(null)}),Qe&&o.jsx("div",{className:Fe.modalOverlay,children:o.jsxs("div",{className:Fe.modalContent,children:[o.jsx("h2",{className:Fe.modalTitle,children:"Change Password"}),o.jsxs("form",{className:"space-y-4",children:[o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{htmlFor:"currentPassword",className:Fe.formLabel,children:"Current Password"}),o.jsx("input",{type:"password",id:"currentPassword",className:Fe.formInput})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{htmlFor:"newPassword",className:Fe.formLabel,children:"New Password"}),o.jsx("input",{type:"password",id:"newPassword",className:Fe.formInput})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{htmlFor:"confirmPassword",className:Fe.formLabel,children:"Confirm New Password"}),o.jsx("input",{type:"password",id:"confirmPassword",className:Fe.formInput})]}),o.jsxs("div",{className:Fe.modalActions,children:[o.jsx(et,{type:"button",variant:"secondary",onClick:Ir,className:"flex-1",children:"Cancel"}),o.jsx(et,{type:"submit",variant:"primary",className:"flex-1 bg-purple-600 hover:bg-purple-700",children:"Change Password"})]})]})]})}),o.jsx(Ze.div,{className:Fe.mainContainer,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:o.jsxs("div",{className:"space-y-6",children:[o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},children:o.jsxs(bt,{className:Fe.cardContainer,children:[o.jsx(bt.Header,{className:Fe.cardHeader,children:o.jsx(bt.Title,{className:Fe.cardTitle,children:"User Management"})}),o.jsxs(bt.Body,{className:Fe.cardBody,children:[o.jsxs("div",{className:Fe.buttonGroup,children:[o.jsx(et,{variant:"primary",onClick:()=>Kt(!0),className:Fe.buttonPrimary,children:"Add User"}),o.jsx(et,{variant:"secondary",onClick:()=>{Tr(),_(!v)},className:Fe.buttonSecondary,children:v?"Hide Users Table":"Get All Users "})]}),o.jsx(Ei,{children:$t&&o.jsxs(Ze.div,{className:Fe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New User"}),o.jsxs("form",{onSubmit:ke,className:"space-y-4",children:[o.jsxs("div",{className:Fe.formGrid,children:[o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Grade"}),o.jsx("input",{type:"text",value:Ee.grade,onChange:ae=>pe("grade",ae.target.value),className:Fe.formInput,placeholder:"Enter grade"})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Class"}),o.jsx("input",{type:"text",value:Ee.class,onChange:ae=>pe("class",ae.target.value),className:Fe.formInput,placeholder:"Enter class"})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Number"}),o.jsx("input",{type:"text",value:Ee.number,onChange:ae=>pe("number",ae.target.value),className:Fe.formInput,placeholder:"Enter number"})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Student ID"}),o.jsx("input",{type:"text",value:Ee.student_id,onChange:ae=>pe("student_id",ae.target.value),className:Fe.formInput,placeholder:"Enter student ID"})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Name"}),o.jsx("input",{type:"text",value:Ee.name,onChange:ae=>pe("name",ae.target.value),className:Fe.formInput,placeholder:"Enter name"})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Surname"}),o.jsx("input",{type:"text",value:Ee.surname,onChange:ae=>pe("surname",ae.target.value),className:Fe.formInput,placeholder:"Enter surname"})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Nickname"}),o.jsx("input",{type:"text",value:Ee.nickname,onChange:ae=>pe("nickname",ae.target.value),className:Fe.formInput,placeholder:"Enter nickname"})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Password"}),o.jsx("input",{type:"password",value:Ee.password,onChange:ae=>pe("password",ae.target.value),className:Fe.formInput,placeholder:"Enter password"})]})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",id:"userActive",checked:Ee.is_active,onChange:ae=>pe("is_active",ae.target.checked),className:Fe.formCheckbox}),o.jsx("label",{htmlFor:"userActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),o.jsxs("div",{className:Fe.formActions,children:[o.jsx(et,{type:"button",variant:"secondary",onClick:()=>Kt(!1),className:Fe.buttonSecondary,children:"Cancel"}),o.jsx(et,{type:"submit",variant:"primary",className:Fe.buttonPrimary,children:"Add User"})]})]})]})}),v&&o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Users (",Pr.length," of ",gt.length,")"]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Filter by Grade:"}),o.jsxs("select",{value:F,onChange:ae=>R(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All Grades"}),[...new Set(gt.map(ae=>ae.grade))].sort().map(ae=>o.jsxs("option",{value:ae,children:["Grade ",ae]},ae))]})]})]}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto max-h-[600px]",children:o.jsxs("table",{className:Fe.table,children:[o.jsx("thead",{className:Fe.tableHeader,children:o.jsxs("tr",{children:[o.jsx("th",{className:Fe.tableHeaderCell,children:"Name"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Grade"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Class"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Student ID"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Number"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Nickname"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Actions"})]})}),o.jsx("tbody",{className:Fe.tableBody,children:Pr.map((ae,ue)=>o.jsxs("tr",{className:Fe.tableRow,children:[o.jsxs("td",{className:Fe.tableCell,children:[ae.name," ",ae.surname]}),o.jsx("td",{className:Fe.tableCell,children:ae.grade}),o.jsx("td",{className:Fe.tableCell,children:ae.class}),o.jsx("td",{className:Fe.tableCell,children:ae.student_id}),o.jsx("td",{className:Fe.tableCell,children:ae.number}),o.jsx("td",{className:Fe.tableCell,children:ae.nickname}),o.jsx("td",{className:Fe.tableCell,children:o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>Ve(ae),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),o.jsx("button",{onClick:()=>he(ae.student_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},ae.id||ue))})]})})})]})]})]})}),o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:o.jsxs(bt,{className:Fe.cardContainer,children:[o.jsxs(bt.Header,{className:Fe.cardHeader,children:[o.jsx(bt.Title,{className:Fe.cardTitle,children:"Teacher Management"}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsx("button",{onClick:i,className:"px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-xs whitespace-nowrap",title:"Refresh materialized class summary view",children:"Refresh Class Summary View"}),o.jsx("button",{onClick:l,className:"px-3 py-1.5 bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors text-xs whitespace-nowrap",title:"Check and mark overdue assignments (7+ days old) as inactive",children:"Check Overdue Assignments"}),o.jsx(et,{variant:"primary",onClick:()=>ct(!0),className:"text-xs whitespace-nowrap",children:"Add Teacher"}),o.jsx(et,{variant:"secondary",onClick:()=>{Mr(),N(!b)},className:"text-xs whitespace-nowrap",children:b?"Hide Teachers Table":"Get All Teachers "})]})]}),o.jsxs(bt.Body,{className:Fe.cardBody,children:[o.jsx(Ei,{children:De&&o.jsxs(Ze.div,{className:Fe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Teacher"}),o.jsxs("form",{onSubmit:We,className:"space-y-4",children:[o.jsxs("div",{className:Fe.formGrid,children:[o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Teacher ID"}),o.jsx("input",{type:"text",value:fe.teacher_id,onChange:ae=>ve("teacher_id",ae.target.value),className:Fe.formInput,placeholder:"Enter teacher ID"})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Username"}),o.jsx("input",{type:"text",value:fe.username,onChange:ae=>ve("username",ae.target.value),className:Fe.formInput,placeholder:"Enter username"})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Password"}),o.jsx("input",{type:"password",value:fe.password,onChange:ae=>ve("password",ae.target.value),className:Fe.formInput,placeholder:"Enter password"})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"First Name"}),o.jsx("input",{type:"text",value:fe.first_name,onChange:ae=>ve("first_name",ae.target.value),className:Fe.formInput,placeholder:"Enter first name"})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Last Name"}),o.jsx("input",{type:"text",value:fe.last_name,onChange:ae=>ve("last_name",ae.target.value),className:Fe.formInput,placeholder:"Enter last name"})]})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",id:"teacherActive",checked:fe.is_active,onChange:ae=>ve("is_active",ae.target.checked),className:Fe.formCheckbox}),o.jsx("label",{htmlFor:"teacherActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),o.jsxs("div",{className:Fe.formActions,children:[o.jsx(et,{type:"button",variant:"secondary",onClick:()=>ct(!1),className:Fe.buttonSecondary,children:"Cancel"}),o.jsx(et,{type:"submit",variant:"primary",className:Fe.buttonPrimary,children:"Add Teacher"})]})]})]})}),E&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit User"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),o.jsx("input",{type:"text",value:I.name,onChange:ae=>G({...I,name:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Surname"}),o.jsx("input",{type:"text",value:I.surname,onChange:ae=>G({...I,surname:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grade"}),o.jsx("input",{type:"number",value:I.grade,onChange:ae=>G({...I,grade:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),o.jsx("input",{type:"number",value:I.class,onChange:ae=>G({...I,class:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),o.jsx("input",{type:"text",value:I.student_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Student ID cannot be changed"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nickname"}),o.jsx("input",{type:"text",value:I.nickname,onChange:ae=>G({...I,nickname:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),o.jsx("input",{type:"text",value:I.password,onChange:ae=>G({...I,password:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",id:"is_active",checked:I.is_active,onChange:ae=>G({...I,is_active:ae.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),o.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),o.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[o.jsx("button",{onClick:()=>{D(null),G({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),o.jsx("button",{onClick:oe,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update User"})]})]})}),b&&o.jsxs("div",{className:"mt-6",children:[o.jsx("div",{className:"mb-4",children:o.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Teachers (",Ut.length,")"]})}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto max-h-96",children:o.jsxs("table",{className:Fe.table,children:[o.jsx("thead",{className:Fe.tableHeader,children:o.jsxs("tr",{children:[o.jsx("th",{className:Fe.tableHeaderCell,children:"Teacher ID"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Name"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Username"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Password"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Status"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Created"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Actions"})]})}),o.jsx("tbody",{className:Fe.tableBody,children:Ut.map((ae,ue)=>o.jsxs("tr",{className:Fe.tableRow,children:[o.jsx("td",{className:Fe.tableCell,children:ae.teacher_id}),o.jsxs("td",{className:Fe.tableCell,children:[ae.first_name," ",ae.last_name]}),o.jsx("td",{className:Fe.tableCell,children:ae.username}),o.jsx("td",{className:Fe.tableCell,children:ae.password}),o.jsx("td",{className:Fe.tableCell,children:o.jsx("span",{className:ae.is_active?Fe.statusActive:Fe.statusInactive,children:ae.is_active?"Active":"Inactive"})}),o.jsx("td",{className:Fe.tableCell,children:new Date(ae.created_at).toLocaleDateString()}),o.jsx("td",{className:Fe.tableCell,children:o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>Te(ae),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),o.jsx("button",{onClick:()=>qe(ae.teacher_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},ae.teacher_id||ue))})]})})})]})]})]})}),o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7,duration:.5},children:o.jsxs(bt,{className:Fe.cardContainer,children:[o.jsx(bt.Header,{className:Fe.cardHeader,children:o.jsx(bt.Title,{className:Fe.cardTitle,children:"Subject Management"})}),o.jsxs(bt.Body,{className:Fe.cardBody,children:[o.jsxs("div",{className:Fe.buttonGroup,children:[o.jsx(et,{variant:"primary",onClick:()=>At(!0),className:Fe.buttonPrimary,children:"Add Subject"}),o.jsx(et,{variant:"secondary",onClick:()=>{Wr(),w(!k)},className:Fe.buttonSecondary,children:k?"Hide Subjects Table":"Get All Subjects "})]}),o.jsx(Ei,{children:mt&&o.jsxs(Ze.div,{className:Fe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Subject"}),o.jsxs("form",{onSubmit:dt,className:"space-y-4",children:[o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Subject Name"}),o.jsx("input",{type:"text",value:$e.subject,onChange:ae=>be("subject",ae.target.value),className:Fe.formInput,placeholder:"Enter subject name",required:!0}),o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Subject ID will be automatically generated"})]}),o.jsxs("div",{className:Fe.formActions,children:[o.jsx(et,{type:"button",variant:"secondary",onClick:()=>At(!1),className:Fe.buttonSecondary,children:"Cancel"}),o.jsx(et,{type:"submit",variant:"primary",className:Fe.buttonPrimary,children:"Add Subject"})]})]})]})}),Y&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Teacher"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teacher ID"}),o.jsx("input",{type:"text",value:ie.teacher_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Teacher ID cannot be changed"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),o.jsx("input",{type:"text",value:ie.username,onChange:ae=>re({...ie,username:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),o.jsx("input",{type:"text",value:ie.password,onChange:ae=>re({...ie,password:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),o.jsx("input",{type:"text",value:ie.first_name,onChange:ae=>re({...ie,first_name:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),o.jsx("input",{type:"text",value:ie.last_name,onChange:ae=>re({...ie,last_name:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",id:"teacher_is_active",checked:ie.is_active,onChange:ae=>re({...ie,is_active:ae.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),o.jsx("label",{htmlFor:"teacher_is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),o.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[o.jsx("button",{onClick:()=>{ee(null),re({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),o.jsx("button",{onClick:je,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update Teacher"})]})]})}),se&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Subject"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject ID"}),o.jsx("input",{type:"text",value:z.subject_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Subject ID cannot be changed"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),o.jsx("input",{type:"text",value:z.subject,onChange:ae=>U({...z,subject:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]})]}),o.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[o.jsx("button",{onClick:()=>B(null),className:"px-4 py-2 text-gray-600 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),o.jsx("button",{onClick:Le,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:"Update Subject"})]})]})}),k&&o.jsxs("div",{className:"mt-6",children:[o.jsx("div",{className:"mb-4",children:o.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Subjects (",Ye.length,")"]})}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto max-h-96",children:o.jsxs("table",{className:Fe.table,children:[o.jsx("thead",{className:Fe.tableHeader,children:o.jsxs("tr",{children:[o.jsx("th",{className:Fe.tableHeaderCell,children:"Subject ID"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Subject Name"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Actions"})]})}),o.jsx("tbody",{className:Fe.tableBody,children:Ye.map((ae,ue)=>o.jsxs("tr",{className:Fe.tableRow,children:[o.jsx("td",{className:Fe.tableCell,children:ae.subject_id}),o.jsx("td",{className:Fe.tableCell,children:ae.subject}),o.jsx("td",{className:Fe.tableCell,children:o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>at(ae),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),o.jsx("button",{onClick:()=>Ct(ae.subject_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},ae.subject_id||ue))})]})})})]})]})]})}),o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:o.jsxs(bt,{className:Fe.cardContainer,children:[o.jsx(bt.Header,{className:Fe.cardHeader,children:o.jsx(bt.Title,{className:Fe.cardTitle,children:"Test Data Deletion"})}),o.jsxs(bt.Body,{className:Fe.cardBody,children:[o.jsx("div",{className:Fe.buttonGroup,children:o.jsx(et,{variant:"danger",onClick:()=>rr(!0),className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})}),o.jsx(Ei,{children:Lt&&o.jsxs(Ze.div,{className:Fe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Delete Test Data by Date Range"}),o.jsxs("form",{onSubmit:Vt,className:"space-y-4",children:[o.jsxs("div",{className:Fe.formGrid,children:[o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Start Date *"}),o.jsx("input",{type:"date",value:pt.startDate,onChange:ae=>Mt("startDate",ae.target.value),className:Fe.formInput,required:!0})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"End Date *"}),o.jsx("input",{type:"date",value:pt.endDate,onChange:ae=>Mt("endDate",ae.target.value),className:Fe.formInput,required:!0})]})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Teacher ID *"}),o.jsxs("select",{value:pt.teacherId,onChange:ae=>Mt("teacherId",ae.target.value),className:Fe.formInput,required:!0,children:[o.jsx("option",{value:"",children:"Select a teacher"}),Ut.map(ae=>o.jsxs("option",{value:ae.teacher_id,children:[ae.teacher_id," - ",ae.first_name," ",ae.last_name]},ae.teacher_id))]})]}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Subject (Optional)"}),o.jsxs("select",{value:pt.subjectId,onChange:ae=>Mt("subjectId",ae.target.value),className:Fe.formInput,children:[o.jsx("option",{value:"",children:"All subjects"}),Ye.map(ae=>o.jsx("option",{value:ae.subject_id,children:ae.subject},ae.subject_id))]})]}),o.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Warning: This action cannot be undone"}),o.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[o.jsx("p",{children:"This will permanently delete:"}),o.jsxs("ul",{className:"list-disc list-inside mt-1",children:[o.jsx("li",{children:"All test records within the date range"}),o.jsx("li",{children:"All test questions and answers"}),o.jsx("li",{children:"All test results and submissions"}),o.jsx("li",{children:"All test assignments"}),o.jsx("li",{children:"Associated Cloudinary images (for matching tests)"})]})]})]})]})}),o.jsxs("div",{className:Fe.formActions,children:[o.jsx(et,{type:"button",variant:"secondary",onClick:()=>rr(!1),className:Fe.buttonSecondary,children:"Cancel"}),o.jsx(et,{type:"submit",variant:"danger",className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})]})]})]})})]})]})}),o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.85,duration:.5},children:o.jsxs(bt,{className:Fe.cardContainer,children:[o.jsx(bt.Header,{className:Fe.cardHeader,children:o.jsx(bt.Title,{className:Fe.cardTitle,children:"Assignments Management"})}),o.jsxs(bt.Body,{className:Fe.cardBody,children:[o.jsx("div",{className:"mb-4",children:o.jsx(et,{variant:"primary",onClick:Se,className:Fe.buttonPrimary,children:T?"Hide Assignments Table":"Get All Assignments "})}),T&&o.jsx("div",{className:"mb-6",children:o.jsx("div",{className:"border-b border-gray-200",children:o.jsxs("nav",{className:"-mb-px flex space-x-8",children:[o.jsx("button",{onClick:()=>me(!0),className:`py-2 px-1 border-b-2 font-medium text-sm ${ne?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Active Assignments"}),o.jsx("button",{onClick:()=>me(!1),className:`py-2 px-1 border-b-2 font-medium text-sm ${ne?"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300":"border-purple-500 text-purple-600"}`,children:"Inactive Assignments"})]})})}),T&&o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:[ne?"Active":"Inactive"," Assignments (",Or.length," of ",V.filter(ae=>ne?ae.is_active:!ae.is_active).length,")"]}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs("select",{value:L,onChange:ae=>M(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All Teachers"}),Ut.map(ae=>o.jsxs("option",{value:ae.teacher_id,children:[ae.first_name," ",ae.last_name]},ae.teacher_id))]}),o.jsx("input",{type:"date",value:X,onChange:ae=>K(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),o.jsx("input",{type:"date",value:Z,onChange:ae=>J(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto max-h-96",children:o.jsxs("table",{className:Fe.table,children:[o.jsx("thead",{className:Fe.tableHeader,children:o.jsxs("tr",{children:[o.jsx("th",{className:Fe.tableHeaderCell,children:"Test Name"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Type"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Teacher"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Questions"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Created"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Actions"})]})}),o.jsx("tbody",{className:Fe.tableBody,children:Or.map((ae,ue)=>o.jsxs("tr",{className:Fe.tableRow,children:[o.jsx("td",{className:Fe.tableCell,children:ae.test_name}),o.jsx("td",{className:Fe.tableCell,children:o.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:ae.test_type.replace("_"," ").toUpperCase()})}),o.jsx("td",{className:Fe.tableCell,children:ae.teacher_name}),o.jsx("td",{className:Fe.tableCell,children:ae.num_questions}),o.jsx("td",{className:Fe.tableCell,children:new Date(ae.created_at).toLocaleDateString()}),o.jsx("td",{className:Fe.tableCell,children:o.jsx("div",{className:"flex space-x-2",children:ne?o.jsx("button",{onClick:()=>dr(ae.test_id,ae.test_type,ae.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-orange-100 text-orange-700 hover:bg-orange-200",children:"Mark Complete"}):o.jsx("button",{onClick:()=>Nn(ae.test_id,ae.test_type,ae.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",children:"Mark Active"})})})]},`${ae.test_type}-${ae.test_id}-${ue}`))})]})})})]})]})]})}),o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:o.jsxs(bt,{className:Fe.cardContainer,children:[o.jsx(bt.Header,{className:Fe.cardHeader,children:o.jsx(bt.Title,{className:Fe.cardTitle,children:"Test Management"})}),o.jsxs(bt.Body,{className:Fe.cardBody,children:[o.jsx("div",{className:"mb-4",children:o.jsx(et,{variant:"primary",onClick:ln,className:Fe.buttonPrimary,children:xe?"Hide Tests Table":"Get All Tests "})}),xe&&o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Tests (",cr.length," of ",le.length,")"]}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs("select",{value:Ue,onChange:ae=>Ge(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[o.jsx("option",{value:"",children:"All Teachers"}),Ut.map(ae=>o.jsxs("option",{value:ae.teacher_id,children:[ae.first_name," ",ae.last_name]},ae.teacher_id))]}),o.jsx("input",{type:"date",value:Je,onChange:ae=>He(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),o.jsx("input",{type:"date",value:Ft,onChange:ae=>rt(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),o.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto max-h-96",children:o.jsxs("table",{className:Fe.table,children:[o.jsx("thead",{className:Fe.tableHeader,children:o.jsxs("tr",{children:[o.jsx("th",{className:Fe.tableHeaderCell,children:"Test Name"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Type"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Teacher"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Questions"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Created"}),o.jsx("th",{className:Fe.tableHeaderCell,children:"Actions"})]})}),o.jsx("tbody",{className:Fe.tableBody,children:cr.map((ae,ue)=>o.jsxs("tr",{className:Fe.tableRow,children:[o.jsx("td",{className:Fe.tableCell,children:ae.test_name}),o.jsx("td",{className:Fe.tableCell,children:o.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:ae.test_type.replace("_"," ").toUpperCase()})}),o.jsx("td",{className:Fe.tableCell,children:ae.teacher_name}),o.jsx("td",{className:Fe.tableCell,children:ae.num_questions}),o.jsx("td",{className:Fe.tableCell,children:new Date(ae.created_at).toLocaleDateString()}),o.jsx("td",{className:Fe.tableCell,children:o.jsx("div",{className:"flex space-x-2",children:o.jsx("button",{onClick:()=>In(ae.test_id,ae.test_type,ae.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200",children:"Delete Test"})})})]},`${ae.test_type}-${ae.test_id}-${ue}`))})]})})})]})]})]})}),o.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:o.jsxs(bt,{className:Fe.cardContainer,children:[o.jsx(bt.Header,{className:Fe.cardHeader,children:o.jsx(bt.Title,{className:Fe.cardTitle,children:"Debug & Testing"})}),o.jsx(bt.Body,{className:Fe.cardBody})]})})]})})]})},ere=()=>{const{isAdmin:e,getCurrentAdminId:t,logout:r}=Hn(),{get:n}=Xi(),{showNotification:s}=ja();C.useEffect(()=>{a()},[]);const a=C.useCallback(async()=>{if(console.log(" Initializing Admin Application..."),!e()){console.error(" User is not an admin, redirecting to login"),s("Access Denied: You are not an administrator.","error"),r();return}try{i(),await l(),c(),d(),console.log(" Admin Application initialized successfully"),s("Admin dashboard loaded successfully","success")}catch(f){console.error(" Error initializing admin app:",f),s("Failed to initialize admin dashboard","error")}},[e,t,r,s,n]),i=C.useCallback(()=>{console.log(" Initializing global event listeners...");const f=p=>{p.ctrlKey&&p.key==="k"&&(p.preventDefault(),console.log("Admin search shortcut triggered"))};return document.addEventListener("keydown",f),()=>{document.removeEventListener("keydown",f)}},[]),l=C.useCallback(async()=>{try{console.log(" Loading admin data...");const[f,p,g,y]=await Promise.allSettled([n("/.netlify/functions/get-all-users"),n("/.netlify/functions/get-all-teachers"),n("/.netlify/functions/get-all-subjects"),n("/.netlify/functions/get-academic-year")]);f.status==="fulfilled"&&f.value?.success&&console.log(" Users loaded:",f.value.users?.length||0),p.status==="fulfilled"&&p.value?.success&&console.log(" Teachers loaded:",p.value.teachers?.length||0),g.status==="fulfilled"&&g.value?.success&&console.log(" Subjects loaded:",g.value.subjects?.length||0),y.status==="fulfilled"&&y.value?.success&&console.log(" Academic years loaded:",y.value.academic_years?.length||0),console.log(" Admin data loading completed")}catch(f){throw console.error(" Error loading admin data:",f),f}},[n]),c=C.useCallback(()=>{console.log(" Initializing test deletion functionality..."),console.log(" Test deletion functionality initialized")},[]),d=C.useCallback(()=>{console.log(" Exposing admin functions globally..."),window.toggleSubjectsContent=()=>{const p=document.getElementById("allSubjectsContainer"),g=document.querySelector('button[onclick="toggleSubjectsContent()"]');if(!p){console.error(" allSubjectsContainer not found");return}if(!g){console.error(" Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",g.textContent=y?"Show Subjects":"Hide Subjects"},window.showAddSubjectForm=()=>{const p=document.getElementById("addSubjectForm");p&&(p.style.display="block")},window.hideAddSubjectForm=()=>{const p=document.getElementById("addSubjectForm"),g=document.getElementById("newSubjectForm");p&&(p.style.display="none"),g&&g.reset()},window.showAddAcademicYearForm=()=>{const p=document.getElementById("addAcademicYearForm");p&&(p.style.display="block")},window.hideAddAcademicYearForm=()=>{const p=document.getElementById("addAcademicYearForm"),g=document.getElementById("newAcademicYearForm");p&&(p.style.display="none"),g&&g.reset()},window.toggleUsersContent=()=>{const p=document.getElementById("allUsersContainer"),g=document.querySelector('button[onclick="toggleUsersContent()"]');if(!p){console.error(" allUsersContainer not found");return}if(!g){console.error(" Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",g.textContent=y?"Show Users":"Hide Users"},window.showAddUserForm=()=>{const p=document.getElementById("addUserForm");p&&(p.style.display="block")},window.hideAddUserForm=()=>{const p=document.getElementById("addUserForm"),g=document.getElementById("newUserForm");p&&(p.style.display="none"),g&&g.reset()},window.showAddTeacherForm=()=>{const p=document.getElementById("addTeacherForm");p&&(p.style.display="block")},window.hideAddTeacherForm=()=>{const p=document.getElementById("addTeacherForm"),g=document.getElementById("newTeacherForm");p&&(p.style.display="none"),g&&g.reset()},window.toggleTeachersContent=()=>{const p=document.getElementById("allTeachersContainer"),g=document.querySelector('button[onclick="toggleTeachersContent()"]');if(!p){console.error(" allTeachersContainer not found");return}if(!g){console.error(" Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",g.textContent=y?"Show Teachers":"Hide Teachers"},window.toggleTestsContent=()=>{const p=document.getElementById("allTestsContainer"),g=document.querySelector('button[onclick="toggleTestsContent()"]');if(!p){console.error(" allTestsContainer not found");return}if(!g){console.error(" Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",g.textContent=y?"Show Tests":"Hide Tests"},window.toggleAssignmentsContent=()=>{const p=document.getElementById("allAssignmentsContainer"),g=document.querySelector('button[onclick="toggleAssignmentsContent()"]');if(!p){console.error(" allAssignmentsContainer not found");return}if(!g){console.error(" Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",g.textContent=y?"Show Assignments":"Hide Assignments"},window.toggleResultsContent=()=>{const p=document.getElementById("allResultsContainer"),g=document.querySelector('button[onclick="toggleResultsContent()"]');if(!p){console.error(" allResultsContainer not found");return}if(!g){console.error(" Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",g.textContent=y?"Show Results":"Hide Results"};const f={};window.toggleSection=p=>{console.log(` toggleSection called with sectionId: ${p}`);const g=Date.now();if(f[p]&&g-f[p]<300){console.log(` Ignoring rapid successive call for ${p}`);return}f[p]=g;const y=document.getElementById(p);if(!y){console.error(` Section with id '${p}' not found!`);return}const v=y.style.display!=="none";y.style.display=v?"none":"block";const _=document.querySelector(`button[onclick="toggleSection('${p}')"]`);_&&(_.textContent=v?"Show":"Hide")},window.addClickListeners=()=>{console.log(" Adding click listeners to section headers...");const p=document.querySelectorAll(".section-header");console.log(` Found ${p.length} section headers`),p.forEach((g,y)=>{const v=g.textContent.trim();if(console.log(` Processing header ${y+1}:`,v),g.dataset.listenerAdded==="true"){console.log(` Skipping header ${v} - listener already added`);return}g.addEventListener("click",()=>{const _=g.dataset.sectionId;_&&window.toggleSection(_)}),g.dataset.listenerAdded="true",console.log(` Added click listener to header: ${v}`)})},window.makeFieldEditable=p=>{const g=p.textContent;p.dataset.field;const y=document.createElement("input");y.type="text",y.value=g,y.className="editable-input";const v=document.createElement("button");v.textContent="Save",v.className="btn-save",v.onclick=()=>window.saveField(p,y,v,_);const _=document.createElement("button");_.textContent="Cancel",_.className="btn-cancel",_.onclick=()=>{p.textContent=g,p.style.display="block",y.remove(),v.remove(),_.remove()},p.style.display="none",p.parentNode.insertBefore(y,p),p.parentNode.insertBefore(v,p),p.parentNode.insertBefore(_,p)},window.saveField=(p,g,y,v)=>{const _=g.value.trim(),b=p.dataset.field,N=p.dataset.recordId;if(!_){alert("Field cannot be empty");return}console.log(`Saving field ${b} for record ${N} with value: ${_}`),p.textContent=_,p.style.display="block",g.remove(),y.remove(),v.remove()},window.showTestDataDeletion=()=>console.log("showTestDataDeletion called"),window.hideTestDataDeletionForm=()=>console.log("hideTestDataDeletionForm called"),window.loadTeacherGradesClasses=()=>console.log("loadTeacherGradesClasses called"),window.checkTeacherSubjects=()=>console.log("checkTeacherSubjects called"),window.initializeTestDeletion=()=>console.log("initializeTestDeletion called"),window.handleAssignmentDeletion=()=>console.log("handleAssignmentDeletion called"),window.handleTestDataDeletion=()=>console.log("handleTestDataDeletion called"),window.getSelectedGradesClasses=()=>console.log("getSelectedGradesClasses called"),window.hideAssignmentDeletionForm=()=>console.log("hideAssignmentDeletionForm called"),window.addKeyboardAccessibility=()=>console.log("addKeyboardAccessibility called"),window.testToggleSection=()=>console.log("testToggleSection called"),window.testAllToggles=()=>console.log("testAllToggles called"),window.manualToggleTest=()=>console.log("manualToggleTest called"),window.addEditableFieldListeners=()=>console.log("addEditableFieldListeners called"),window.deleteTest=()=>console.log("deleteTest called"),window.testLocalStorage=()=>{console.log("Testing localStorage...");try{localStorage.setItem("test","value");const p=localStorage.getItem("test");return localStorage.removeItem("test"),console.log(" localStorage is working"),!0}catch(p){return console.error(" localStorage error:",p),!1}},window.clearAllLocalStorage=()=>{console.log("Clearing all localStorage..."),localStorage.clear(),console.log(" localStorage cleared")},window.exportLocalStorage=()=>{console.log("Exporting localStorage...");const p={};for(let _=0;_<localStorage.length;_++){const b=localStorage.key(_);p[b]=localStorage.getItem(b)}const g=new Blob([JSON.stringify(p,null,2)],{type:"application/json"}),y=URL.createObjectURL(g),v=document.createElement("a");v.href=y,v.download="localStorage-backup.json",v.click(),URL.revokeObjectURL(y)},console.log(" Admin functions exposed globally")},[]);return e()?o.jsx(Zte,{}):o.jsxs("div",{className:"admin-error",children:[o.jsx("h2",{children:"Access Denied"}),o.jsx("p",{children:"You don't have permission to access the admin dashboard."}),o.jsx("button",{onClick:r,children:"Return to Login"})]})},e_=({children:e,allowedRoles:t})=>{const{isAuthenticated:r,role:n,isLoading:s}=Hn();return s?o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):r?t&&!t.includes(n)?o.jsx(a0,{to:"/unauthorized",replace:!0}):e:o.jsx(a0,{to:"/login",replace:!0})},tre=()=>o.jsxs("div",{className:"unauthorized-page",children:[o.jsx("h1",{children:"Access Denied"}),o.jsx("p",{children:"You don't have permission to access this page."})]}),rre=()=>o.jsx(W3,{children:o.jsx(Uj,{children:o.jsx(Lj,{children:o.jsx(DR,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:o.jsx("div",{className:"app",children:o.jsxs(b2,{children:[o.jsx(ds,{path:"/login",element:o.jsx(HW,{})}),o.jsx(ds,{path:"/unauthorized",element:o.jsx(tre,{})}),o.jsx(ds,{path:"/student/*",element:o.jsx(e_,{allowedRoles:["student"],children:o.jsx(Vz,{})})}),o.jsx(ds,{path:"/teacher/*",element:o.jsx(e_,{allowedRoles:["teacher"],children:o.jsx(Qte,{})})}),o.jsx(ds,{path:"/admin/*",element:o.jsx(e_,{allowedRoles:["admin"],children:o.jsx(ere,{})})}),o.jsx(ds,{path:"/",element:o.jsx(a0,{to:"/login",replace:!0})}),o.jsx(ds,{path:"*",element:o.jsx(a0,{to:"/login",replace:!0})})]})})})})})});class nre{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}setToken(t){localStorage.setItem(this.tokenKey,t)}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){this.setToken(t),this.setUserData({role:r}),localStorage.setItem("accessToken",t)}isAuthenticated(){const t=this.getToken();if(!t)return!1;try{const r=JSON.parse(atob(t.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const t=this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(t,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json();return this.setToken(n.token),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(t){try{return JSON.parse(atob(t.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}}const v2=new nre;window.tokenManager=v2;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{v2.init()}):v2.init());class uP{constructor(){this.currentRole=null,this.loadedFunctions=new Set,this.blockedFunctions=new Set,this.initialized=!1,this.retryCount=0,this.maxRetries=20}initialize(){if(this.initialized){console.log("[DEBUG] Role-based loader already initialized, skipping...");return}if(this.retryCount>=this.maxRetries){console.warn("[DEBUG] Max retries reached, stopping role-based loader initialization");return}if(this.retryCount++,(this.retryCount%5===1||this.retryCount===this.maxRetries)&&console.log(`[DEBUG] Role-based loader initializing... (attempt ${this.retryCount}/${this.maxRetries})`),console.log("[DEBUG] Token manager available:",!!window.tokenManager),window.tokenManager&&window.tokenManager.isAuthenticated()){const t=window.tokenManager.getUserRole();console.log("[DEBUG] Role from token manager:",t),console.log("[DEBUG] Access token exists:",!!window.tokenManager.getAccessToken()),t?(this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess()):(console.log("[DEBUG] No role found, waiting for role to be set..."),setTimeout(()=>this.initialize(),500))}else console.log("[DEBUG] Token manager not available or not authenticated, waiting..."),setTimeout(()=>this.initialize(),500)}setupRoleBasedAccess(){this.currentRole||(console.warn("No role detected, defaulting to student access"),this.currentRole="student");let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check:",r),t=!1}console.log(`Role-based loader initialized for: ${this.currentRole}${t?" (admin)":""}`),this.loadRoleSpecificFunctions(),this.setupRoleBasedUI(),this.replaceBlockedFunctions()}loadRoleSpecificFunctions(){this.currentRole==="teacher"?this.loadTeacherFunctions():this.currentRole==="student"&&this.loadStudentFunctions()}loadTeacherFunctions(){console.log("Teacher functions already available in main script")}loadStudentFunctions(){console.log("Student functions already available in main script")}loadFunction(t,r){console.log(`Function ${t} already available in main script for ${r}`),this.loadedFunctions.add(t)}setupRoleBasedUI(){let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check in UI:",r),t=!1}this.currentRole==="student"&&this.hideTeacherElements(),this.currentRole==="teacher"&&!t&&this.hideStudentElements()}hideTeacherElements(){[".teacher-cabinet",".test-creation-panel",".grade-management-panel",".class-management-panel",'[data-role="teacher"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}hideStudentElements(){[".student-cabinet",".test-taking-panel",".results-viewing-panel",'[data-role="student"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}replaceBlockedFunctions(){this.currentRole==="student"?this.blockTeacherFunctions():this.currentRole==="teacher"&&this.blockStudentFunctions()}blockTeacherFunctions(){Object.entries({createTest:()=>this.showAccessDenied("teacher"),assignTest:()=>this.showAccessDenied("teacher"),gradeTest:()=>this.showAccessDenied("teacher"),manageClasses:()=>this.showAccessDenied("teacher"),viewAllResults:()=>this.showAccessDenied("teacher")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}blockStudentFunctions(){Object.entries({takeTest:()=>this.showAccessDenied("student"),submitTest:()=>this.showAccessDenied("student"),viewMyResults:()=>this.showAccessDenied("student")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}showAccessDenied(t){const r=`Access denied. This function requires ${t} role.`;console.warn(r),typeof showNotification=="function"?showNotification(r,"warning"):alert(r)}isFunctionBlocked(t){return this.blockedFunctions.has(t)}isFunctionLoaded(t){return this.loadedFunctions.has(t)}getCurrentRole(){return this.currentRole}hasRole(t){return this.currentRole===t}reloadRoleAccess(){this.initialize()}setupAccessAfterLogin(){if(console.log("[DEBUG] Setting up role-based access after login..."),console.log("[DEBUG] Role-based loader will now initialize (no more retry loop before login)"),!window.tokenManager)return console.error("[ERROR] Token manager not available during setupAccessAfterLogin"),!1;if(!window.tokenManager.isAuthenticated())return console.error("[ERROR] User not authenticated during setupAccessAfterLogin"),!1;const t=window.tokenManager.getUserRole();return t?(console.log("[DEBUG] Setting role after login:",t),this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess(),console.log("[DEBUG] Role-based access setup completed successfully for role:",t),!0):(console.error("[ERROR] No role found in token during setupAccessAfterLogin"),!1)}}window.roleBasedLoader=new uP;typeof By<"u"&&By.exports&&(By.exports=uP);const sre=()=>{console.log("[DEBUG] Initializing application with new structure");const e={schemaVersion:"2.0",enhancedFeatures:!0,newUserStructure:!0,newTestStructure:!0};localStorage.setItem("app_init_data",JSON.stringify(e)),console.log("[DEBUG] Application initialized with enhanced features")},are=()=>{console.log("[DEBUG] Starting main application"),sre(),WP.createRoot(document.getElementById("root")).render(o.jsx(us.StrictMode,{children:o.jsx(rre,{})}))};are()});export default ire();
