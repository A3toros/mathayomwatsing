var OO=Object.defineProperty;var BO=(t,e,r)=>e in t?OO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var UO=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Za=(t,e,r)=>BO(t,typeof e!="symbol"?e+"":e,r);var yge=UO((zge,Hx)=>{function bj(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Gx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function iy(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Sj={exports:{}},oy={},kj={exports:{}},fr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qg=Symbol.for("react.element"),$O=Symbol.for("react.portal"),WO=Symbol.for("react.fragment"),zO=Symbol.for("react.strict_mode"),HO=Symbol.for("react.profiler"),GO=Symbol.for("react.provider"),VO=Symbol.for("react.context"),KO=Symbol.for("react.forward_ref"),XO=Symbol.for("react.suspense"),YO=Symbol.for("react.memo"),JO=Symbol.for("react.lazy"),d3=Symbol.iterator;function QO(t){return t===null||typeof t!="object"?null:(t=d3&&t[d3]||t["@@iterator"],typeof t=="function"?t:null)}var Cj={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Tj=Object.assign,Ej={};function nh(t,e,r){this.props=t,this.context=e,this.refs=Ej,this.updater=r||Cj}nh.prototype.isReactComponent={};nh.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};nh.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Nj(){}Nj.prototype=nh.prototype;function tk(t,e,r){this.props=t,this.context=e,this.refs=Ej,this.updater=r||Cj}var rk=tk.prototype=new Nj;rk.constructor=tk;Tj(rk,nh.prototype);rk.isPureReactComponent=!0;var f3=Array.isArray,Aj=Object.prototype.hasOwnProperty,nk={current:null},jj={key:!0,ref:!0,__self:!0,__source:!0};function Fj(t,e,r){var n,s={},a=null,i=null;if(e!=null)for(n in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(a=""+e.key),e)Aj.call(e,n)&&!jj.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Qg,type:t,key:a,ref:i,props:s,_owner:nk.current}}function qO(t,e){return{$$typeof:Qg,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function sk(t){return typeof t=="object"&&t!==null&&t.$$typeof===Qg}function ZO(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var h3=/\/+/g;function t_(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ZO(""+t.key):e.toString(36)}function _x(t,e,r,n,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Qg:case $O:i=!0}}if(i)return i=t,s=s(i),t=n===""?"."+t_(i,0):n,f3(s)?(r="",t!=null&&(r=t.replace(h3,"$&/")+"/"),_x(s,e,r,"",function(u){return u})):s!=null&&(sk(s)&&(s=qO(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(h3,"$&/")+"/")+t)),e.push(s)),1;if(i=0,n=n===""?".":n+":",f3(t))for(var o=0;o<t.length;o++){a=t[o];var l=n+t_(a,o);i+=_x(a,e,r,l,s)}else if(l=QO(t),typeof l=="function")for(t=l.call(t),o=0;!(a=t.next()).done;)a=a.value,l=n+t_(a,o++),i+=_x(a,e,r,l,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Ep(t,e,r){if(t==null)return t;var n=[],s=0;return _x(t,n,"","",function(a){return e.call(r,a,s++)}),n}function eB(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var la={current:null},bx={transition:null},tB={ReactCurrentDispatcher:la,ReactCurrentBatchConfig:bx,ReactCurrentOwner:nk};function Pj(){throw Error("act(...) is not supported in production builds of React.")}fr.Children={map:Ep,forEach:function(t,e,r){Ep(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Ep(t,function(){e++}),e},toArray:function(t){return Ep(t,function(e){return e})||[]},only:function(t){if(!sk(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fr.Component=nh;fr.Fragment=WO;fr.Profiler=HO;fr.PureComponent=tk;fr.StrictMode=zO;fr.Suspense=XO;fr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tB;fr.act=Pj;fr.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Tj({},t.props),s=t.key,a=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,i=nk.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)Aj.call(e,l)&&!jj.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Qg,type:t.type,key:s,ref:a,props:n,_owner:i}};fr.createContext=function(t){return t={$$typeof:VO,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:GO,_context:t},t.Consumer=t};fr.createElement=Fj;fr.createFactory=function(t){var e=Fj.bind(null,t);return e.type=t,e};fr.createRef=function(){return{current:null}};fr.forwardRef=function(t){return{$$typeof:KO,render:t}};fr.isValidElement=sk;fr.lazy=function(t){return{$$typeof:JO,_payload:{_status:-1,_result:t},_init:eB}};fr.memo=function(t,e){return{$$typeof:YO,type:t,compare:e===void 0?null:e}};fr.startTransition=function(t){var e=bx.transition;bx.transition={};try{t()}finally{bx.transition=e}};fr.unstable_act=Pj;fr.useCallback=function(t,e){return la.current.useCallback(t,e)};fr.useContext=function(t){return la.current.useContext(t)};fr.useDebugValue=function(){};fr.useDeferredValue=function(t){return la.current.useDeferredValue(t)};fr.useEffect=function(t,e){return la.current.useEffect(t,e)};fr.useId=function(){return la.current.useId()};fr.useImperativeHandle=function(t,e,r){return la.current.useImperativeHandle(t,e,r)};fr.useInsertionEffect=function(t,e){return la.current.useInsertionEffect(t,e)};fr.useLayoutEffect=function(t,e){return la.current.useLayoutEffect(t,e)};fr.useMemo=function(t,e){return la.current.useMemo(t,e)};fr.useReducer=function(t,e,r){return la.current.useReducer(t,e,r)};fr.useRef=function(t){return la.current.useRef(t)};fr.useState=function(t){return la.current.useState(t)};fr.useSyncExternalStore=function(t,e,r){return la.current.useSyncExternalStore(t,e,r)};fr.useTransition=function(){return la.current.useTransition()};fr.version="18.3.1";kj.exports=fr;var b=kj.exports;const Wn=iy(b),rB=bj({__proto__:null,default:Wn},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nB=b,sB=Symbol.for("react.element"),aB=Symbol.for("react.fragment"),iB=Object.prototype.hasOwnProperty,oB=nB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,lB={key:!0,ref:!0,__self:!0,__source:!0};function Dj(t,e,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(i=e.ref);for(n in e)iB.call(e,n)&&!lB.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:sB,type:t,key:a,ref:i,props:s,_owner:oB.current}}oy.Fragment=aB;oy.jsx=Dj;oy.jsxs=Dj;Sj.exports=oy;var c=Sj.exports,R2={},Rj={exports:{}},Wa={},Mj={exports:{}},Lj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(U,L){var ne=U.length;U.push(L);e:for(;0<ne;){var de=ne-1>>>1,G=U[de];if(0<s(G,L))U[de]=L,U[ne]=G,ne=de;else break e}}function r(U){return U.length===0?null:U[0]}function n(U){if(U.length===0)return null;var L=U[0],ne=U.pop();if(ne!==L){U[0]=ne;e:for(var de=0,G=U.length,K=G>>>1;de<K;){var Q=2*(de+1)-1,q=U[Q],se=Q+1,W=U[se];if(0>s(q,ne))se<G&&0>s(W,q)?(U[de]=W,U[se]=ne,de=se):(U[de]=q,U[Q]=ne,de=Q);else if(se<G&&0>s(W,ne))U[de]=W,U[se]=ne,de=se;else break e}}return L}function s(U,L){var ne=U.sortIndex-L.sortIndex;return ne!==0?ne:U.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var l=[],u=[],d=1,g=null,h=3,p=!1,x=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(U){for(var L=r(u);L!==null;){if(L.callback===null)n(u);else if(L.startTime<=U)n(u),L.sortIndex=L.expirationTime,e(l,L);else break;L=r(u)}}function k(U){if(v=!1,y(U),!x)if(r(l)!==null)x=!0,z(N);else{var L=r(u);L!==null&&H(k,L.startTime-U)}}function N(U,L){x=!1,v&&(v=!1,S(C),C=-1),p=!0;var ne=h;try{for(y(L),g=r(l);g!==null&&(!(g.expirationTime>L)||U&&!R());){var de=g.callback;if(typeof de=="function"){g.callback=null,h=g.priorityLevel;var G=de(g.expirationTime<=L);L=t.unstable_now(),typeof G=="function"?g.callback=G:g===r(l)&&n(l),y(L)}else n(l);g=r(l)}if(g!==null)var K=!0;else{var Q=r(u);Q!==null&&H(k,Q.startTime-L),K=!1}return K}finally{g=null,h=ne,p=!1}}var E=!1,A=null,C=-1,F=5,D=-1;function R(){return!(t.unstable_now()-D<F)}function M(){if(A!==null){var U=t.unstable_now();D=U;var L=!0;try{L=A(!0,U)}finally{L?B():(E=!1,A=null)}}else E=!1}var B;if(typeof _=="function")B=function(){_(M)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,X=J.port2;J.port1.onmessage=M,B=function(){X.postMessage(null)}}else B=function(){w(M,0)};function z(U){A=U,E||(E=!0,B())}function H(U,L){C=w(function(){U(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_continueExecution=function(){x||p||(x=!0,z(N))},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(U){switch(h){case 1:case 2:case 3:var L=3;break;default:L=h}var ne=h;h=L;try{return U()}finally{h=ne}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(U,L){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var ne=h;h=U;try{return L()}finally{h=ne}},t.unstable_scheduleCallback=function(U,L,ne){var de=t.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?de+ne:de):ne=de,U){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=ne+G,U={id:d++,callback:L,priorityLevel:U,startTime:ne,expirationTime:G,sortIndex:-1},ne>de?(U.sortIndex=ne,e(u,U),r(l)===null&&U===r(u)&&(v?(S(C),C=-1):v=!0,H(k,ne-de))):(U.sortIndex=G,e(l,U),x||p||(x=!0,z(N))),U},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(U){var L=h;return function(){var ne=h;h=L;try{return U.apply(this,arguments)}finally{h=ne}}}})(Lj);Mj.exports=Lj;var T0=Mj.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cB=b,Ba=T0;function ft(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ij=new Set,eg={};function td(t,e){Rf(t,e),Rf(t+"Capture",e)}function Rf(t,e){for(eg[t]=e,t=0;t<e.length;t++)Ij.add(e[t])}var ul=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),M2=Object.prototype.hasOwnProperty,uB=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g3={},m3={};function dB(t){return M2.call(m3,t)?!0:M2.call(g3,t)?!1:uB.test(t)?m3[t]=!0:(g3[t]=!0,!1)}function fB(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function hB(t,e,r,n){if(e===null||typeof e>"u"||fB(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ca(t,e,r,n,s,a,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=i}var Es={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Es[t]=new ca(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Es[e]=new ca(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Es[t]=new ca(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Es[t]=new ca(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Es[t]=new ca(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Es[t]=new ca(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Es[t]=new ca(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Es[t]=new ca(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Es[t]=new ca(t,5,!1,t.toLowerCase(),null,!1,!1)});var ak=/[\-:]([a-z])/g;function ik(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ak,ik);Es[e]=new ca(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ak,ik);Es[e]=new ca(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ak,ik);Es[e]=new ca(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Es[t]=new ca(t,1,!1,t.toLowerCase(),null,!1,!1)});Es.xlinkHref=new ca("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Es[t]=new ca(t,1,!1,t.toLowerCase(),null,!0,!0)});function ok(t,e,r,n){var s=Es.hasOwnProperty(e)?Es[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(hB(e,r,s,n)&&(r=null),n||s===null?dB(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var vl=cB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Np=Symbol.for("react.element"),Yd=Symbol.for("react.portal"),Jd=Symbol.for("react.fragment"),lk=Symbol.for("react.strict_mode"),L2=Symbol.for("react.profiler"),Oj=Symbol.for("react.provider"),Bj=Symbol.for("react.context"),ck=Symbol.for("react.forward_ref"),I2=Symbol.for("react.suspense"),O2=Symbol.for("react.suspense_list"),uk=Symbol.for("react.memo"),zl=Symbol.for("react.lazy"),Uj=Symbol.for("react.offscreen"),p3=Symbol.iterator;function Qh(t){return t===null||typeof t!="object"?null:(t=p3&&t[p3]||t["@@iterator"],typeof t=="function"?t:null)}var mn=Object.assign,r_;function p0(t){if(r_===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);r_=e&&e[1]||""}return`
`+r_+t}var n_=!1;function s_(t,e){if(!t||n_)return"";n_=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=o);break}}}finally{n_=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?p0(t):""}function gB(t){switch(t.tag){case 5:return p0(t.type);case 16:return p0("Lazy");case 13:return p0("Suspense");case 19:return p0("SuspenseList");case 0:case 2:case 15:return t=s_(t.type,!1),t;case 11:return t=s_(t.type.render,!1),t;case 1:return t=s_(t.type,!0),t;default:return""}}function B2(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Jd:return"Fragment";case Yd:return"Portal";case L2:return"Profiler";case lk:return"StrictMode";case I2:return"Suspense";case O2:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Bj:return(t.displayName||"Context")+".Consumer";case Oj:return(t._context.displayName||"Context")+".Provider";case ck:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case uk:return e=t.displayName||null,e!==null?e:B2(t.type)||"Memo";case zl:e=t._payload,t=t._init;try{return B2(t(e))}catch{}}return null}function mB(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B2(e);case 8:return e===lk?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function hc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function $j(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function pB(t){var e=$j(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ap(t){t._valueTracker||(t._valueTracker=pB(t))}function Wj(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=$j(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Vx(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function U2(t,e){var r=e.checked;return mn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function x3(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=hc(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function zj(t,e){e=e.checked,e!=null&&ok(t,"checked",e,!1)}function $2(t,e){zj(t,e);var r=hc(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?W2(t,e.type,r):e.hasOwnProperty("defaultValue")&&W2(t,e.type,hc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function y3(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function W2(t,e,r){(e!=="number"||Vx(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var x0=Array.isArray;function xf(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+hc(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function z2(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ft(91));return mn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function v3(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(ft(92));if(x0(r)){if(1<r.length)throw Error(ft(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:hc(r)}}function Hj(t,e){var r=hc(e.value),n=hc(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function w3(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Gj(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function H2(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Gj(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var jp,Vj=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(jp=jp||document.createElement("div"),jp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=jp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function tg(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var E0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xB=["Webkit","ms","Moz","O"];Object.keys(E0).forEach(function(t){xB.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),E0[e]=E0[t]})});function Kj(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||E0.hasOwnProperty(t)&&E0[t]?(""+e).trim():e+"px"}function Xj(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Kj(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var yB=mn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function G2(t,e){if(e){if(yB[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ft(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ft(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ft(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ft(62))}}function V2(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var K2=null;function dk(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var X2=null,yf=null,vf=null;function _3(t){if(t=em(t)){if(typeof X2!="function")throw Error(ft(280));var e=t.stateNode;e&&(e=fy(e),X2(t.stateNode,t.type,e))}}function Yj(t){yf?vf?vf.push(t):vf=[t]:yf=t}function Jj(){if(yf){var t=yf,e=vf;if(vf=yf=null,_3(t),e)for(t=0;t<e.length;t++)_3(e[t])}}function Qj(t,e){return t(e)}function qj(){}var a_=!1;function Zj(t,e,r){if(a_)return t(e,r);a_=!0;try{return Qj(t,e,r)}finally{a_=!1,(yf!==null||vf!==null)&&(qj(),Jj())}}function rg(t,e){var r=t.stateNode;if(r===null)return null;var n=fy(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(ft(231,e,typeof r));return r}var Y2=!1;if(ul)try{var qh={};Object.defineProperty(qh,"passive",{get:function(){Y2=!0}}),window.addEventListener("test",qh,qh),window.removeEventListener("test",qh,qh)}catch{Y2=!1}function vB(t,e,r,n,s,a,i,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var N0=!1,Kx=null,Xx=!1,J2=null,wB={onError:function(t){N0=!0,Kx=t}};function _B(t,e,r,n,s,a,i,o,l){N0=!1,Kx=null,vB.apply(wB,arguments)}function bB(t,e,r,n,s,a,i,o,l){if(_B.apply(this,arguments),N0){if(N0){var u=Kx;N0=!1,Kx=null}else throw Error(ft(198));Xx||(Xx=!0,J2=u)}}function rd(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function eF(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function b3(t){if(rd(t)!==t)throw Error(ft(188))}function SB(t){var e=t.alternate;if(!e){if(e=rd(t),e===null)throw Error(ft(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return b3(s),t;if(a===n)return b3(s),e;a=a.sibling}throw Error(ft(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(ft(189))}}if(r.alternate!==n)throw Error(ft(190))}if(r.tag!==3)throw Error(ft(188));return r.stateNode.current===r?t:e}function tF(t){return t=SB(t),t!==null?rF(t):null}function rF(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=rF(t);if(e!==null)return e;t=t.sibling}return null}var nF=Ba.unstable_scheduleCallback,S3=Ba.unstable_cancelCallback,kB=Ba.unstable_shouldYield,CB=Ba.unstable_requestPaint,Pn=Ba.unstable_now,TB=Ba.unstable_getCurrentPriorityLevel,fk=Ba.unstable_ImmediatePriority,sF=Ba.unstable_UserBlockingPriority,Yx=Ba.unstable_NormalPriority,EB=Ba.unstable_LowPriority,aF=Ba.unstable_IdlePriority,ly=null,_o=null;function NB(t){if(_o&&typeof _o.onCommitFiberRoot=="function")try{_o.onCommitFiberRoot(ly,t,void 0,(t.current.flags&128)===128)}catch{}}var $i=Math.clz32?Math.clz32:FB,AB=Math.log,jB=Math.LN2;function FB(t){return t>>>=0,t===0?32:31-(AB(t)/jB|0)|0}var Fp=64,Pp=4194304;function y0(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Jx(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,a=t.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=y0(o):(a&=i,a!==0&&(n=y0(a)))}else i=r&~s,i!==0?n=y0(i):a!==0&&(n=y0(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-$i(e),s=1<<r,n|=t[r],e&=~s;return n}function PB(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function DB(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var i=31-$i(a),o=1<<i,l=s[i];l===-1?(!(o&r)||o&n)&&(s[i]=PB(o,e)):l<=e&&(t.expiredLanes|=o),a&=~o}}function Q2(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function iF(){var t=Fp;return Fp<<=1,!(Fp&4194240)&&(Fp=64),t}function i_(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function qg(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-$i(e),t[e]=r}function RB(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-$i(r),a=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~a}}function hk(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-$i(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var Lr=0;function oF(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var lF,gk,cF,uF,dF,q2=!1,Dp=[],tc=null,rc=null,nc=null,ng=new Map,sg=new Map,Gl=[],MB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function k3(t,e){switch(t){case"focusin":case"focusout":tc=null;break;case"dragenter":case"dragleave":rc=null;break;case"mouseover":case"mouseout":nc=null;break;case"pointerover":case"pointerout":ng.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":sg.delete(e.pointerId)}}function Zh(t,e,r,n,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},e!==null&&(e=em(e),e!==null&&gk(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function LB(t,e,r,n,s){switch(e){case"focusin":return tc=Zh(tc,t,e,r,n,s),!0;case"dragenter":return rc=Zh(rc,t,e,r,n,s),!0;case"mouseover":return nc=Zh(nc,t,e,r,n,s),!0;case"pointerover":var a=s.pointerId;return ng.set(a,Zh(ng.get(a)||null,t,e,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,sg.set(a,Zh(sg.get(a)||null,t,e,r,n,s)),!0}return!1}function fF(t){var e=uu(t.target);if(e!==null){var r=rd(e);if(r!==null){if(e=r.tag,e===13){if(e=eF(r),e!==null){t.blockedOn=e,dF(t.priority,function(){cF(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Sx(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Z2(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);K2=n,r.target.dispatchEvent(n),K2=null}else return e=em(r),e!==null&&gk(e),t.blockedOn=r,!1;e.shift()}return!0}function C3(t,e,r){Sx(t)&&r.delete(e)}function IB(){q2=!1,tc!==null&&Sx(tc)&&(tc=null),rc!==null&&Sx(rc)&&(rc=null),nc!==null&&Sx(nc)&&(nc=null),ng.forEach(C3),sg.forEach(C3)}function e0(t,e){t.blockedOn===e&&(t.blockedOn=null,q2||(q2=!0,Ba.unstable_scheduleCallback(Ba.unstable_NormalPriority,IB)))}function ag(t){function e(s){return e0(s,t)}if(0<Dp.length){e0(Dp[0],t);for(var r=1;r<Dp.length;r++){var n=Dp[r];n.blockedOn===t&&(n.blockedOn=null)}}for(tc!==null&&e0(tc,t),rc!==null&&e0(rc,t),nc!==null&&e0(nc,t),ng.forEach(e),sg.forEach(e),r=0;r<Gl.length;r++)n=Gl[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Gl.length&&(r=Gl[0],r.blockedOn===null);)fF(r),r.blockedOn===null&&Gl.shift()}var wf=vl.ReactCurrentBatchConfig,Qx=!0;function OB(t,e,r,n){var s=Lr,a=wf.transition;wf.transition=null;try{Lr=1,mk(t,e,r,n)}finally{Lr=s,wf.transition=a}}function BB(t,e,r,n){var s=Lr,a=wf.transition;wf.transition=null;try{Lr=4,mk(t,e,r,n)}finally{Lr=s,wf.transition=a}}function mk(t,e,r,n){if(Qx){var s=Z2(t,e,r,n);if(s===null)p_(t,e,n,qx,r),k3(t,n);else if(LB(s,t,e,r,n))n.stopPropagation();else if(k3(t,n),e&4&&-1<MB.indexOf(t)){for(;s!==null;){var a=em(s);if(a!==null&&lF(a),a=Z2(t,e,r,n),a===null&&p_(t,e,n,qx,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else p_(t,e,n,null,r)}}var qx=null;function Z2(t,e,r,n){if(qx=null,t=dk(n),t=uu(t),t!==null)if(e=rd(t),e===null)t=null;else if(r=e.tag,r===13){if(t=eF(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return qx=t,null}function hF(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(TB()){case fk:return 1;case sF:return 4;case Yx:case EB:return 16;case aF:return 536870912;default:return 16}default:return 16}}var Kl=null,pk=null,kx=null;function gF(){if(kx)return kx;var t,e=pk,r=e.length,n,s="value"in Kl?Kl.value:Kl.textContent,a=s.length;for(t=0;t<r&&e[t]===s[t];t++);var i=r-t;for(n=1;n<=i&&e[r-n]===s[a-n];n++);return kx=s.slice(t,1<n?1-n:void 0)}function Cx(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Rp(){return!0}function T3(){return!1}function za(t){function e(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Rp:T3,this.isPropagationStopped=T3,this}return mn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Rp)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Rp)},persist:function(){},isPersistent:Rp}),e}var sh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xk=za(sh),Zg=mn({},sh,{view:0,detail:0}),UB=za(Zg),o_,l_,t0,cy=mn({},Zg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yk,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==t0&&(t0&&t.type==="mousemove"?(o_=t.screenX-t0.screenX,l_=t.screenY-t0.screenY):l_=o_=0,t0=t),o_)},movementY:function(t){return"movementY"in t?t.movementY:l_}}),E3=za(cy),$B=mn({},cy,{dataTransfer:0}),WB=za($B),zB=mn({},Zg,{relatedTarget:0}),c_=za(zB),HB=mn({},sh,{animationName:0,elapsedTime:0,pseudoElement:0}),GB=za(HB),VB=mn({},sh,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),KB=za(VB),XB=mn({},sh,{data:0}),N3=za(XB),YB={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},JB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},QB={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qB(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=QB[t])?!!e[t]:!1}function yk(){return qB}var ZB=mn({},Zg,{key:function(t){if(t.key){var e=YB[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Cx(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?JB[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yk,charCode:function(t){return t.type==="keypress"?Cx(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Cx(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),eU=za(ZB),tU=mn({},cy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),A3=za(tU),rU=mn({},Zg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yk}),nU=za(rU),sU=mn({},sh,{propertyName:0,elapsedTime:0,pseudoElement:0}),aU=za(sU),iU=mn({},cy,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),oU=za(iU),lU=[9,13,27,32],vk=ul&&"CompositionEvent"in window,A0=null;ul&&"documentMode"in document&&(A0=document.documentMode);var cU=ul&&"TextEvent"in window&&!A0,mF=ul&&(!vk||A0&&8<A0&&11>=A0),j3=" ",F3=!1;function pF(t,e){switch(t){case"keyup":return lU.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xF(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Qd=!1;function uU(t,e){switch(t){case"compositionend":return xF(e);case"keypress":return e.which!==32?null:(F3=!0,j3);case"textInput":return t=e.data,t===j3&&F3?null:t;default:return null}}function dU(t,e){if(Qd)return t==="compositionend"||!vk&&pF(t,e)?(t=gF(),kx=pk=Kl=null,Qd=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return mF&&e.locale!=="ko"?null:e.data;default:return null}}var fU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function P3(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!fU[t.type]:e==="textarea"}function yF(t,e,r,n){Yj(n),e=Zx(e,"onChange"),0<e.length&&(r=new xk("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var j0=null,ig=null;function hU(t){AF(t,0)}function uy(t){var e=ef(t);if(Wj(e))return t}function gU(t,e){if(t==="change")return e}var vF=!1;if(ul){var u_;if(ul){var d_="oninput"in document;if(!d_){var D3=document.createElement("div");D3.setAttribute("oninput","return;"),d_=typeof D3.oninput=="function"}u_=d_}else u_=!1;vF=u_&&(!document.documentMode||9<document.documentMode)}function R3(){j0&&(j0.detachEvent("onpropertychange",wF),ig=j0=null)}function wF(t){if(t.propertyName==="value"&&uy(ig)){var e=[];yF(e,ig,t,dk(t)),Zj(hU,e)}}function mU(t,e,r){t==="focusin"?(R3(),j0=e,ig=r,j0.attachEvent("onpropertychange",wF)):t==="focusout"&&R3()}function pU(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return uy(ig)}function xU(t,e){if(t==="click")return uy(e)}function yU(t,e){if(t==="input"||t==="change")return uy(e)}function vU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ki=typeof Object.is=="function"?Object.is:vU;function og(t,e){if(Ki(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!M2.call(e,s)||!Ki(t[s],e[s]))return!1}return!0}function M3(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function L3(t,e){var r=M3(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=M3(r)}}function _F(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?_F(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function bF(){for(var t=window,e=Vx();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Vx(t.document)}return e}function wk(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function wU(t){var e=bF(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&_F(r.ownerDocument.documentElement,r)){if(n!==null&&wk(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!t.extend&&a>n&&(s=n,n=a,a=s),s=L3(r,a);var i=L3(r,n);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var _U=ul&&"documentMode"in document&&11>=document.documentMode,qd=null,eb=null,F0=null,tb=!1;function I3(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;tb||qd==null||qd!==Vx(n)||(n=qd,"selectionStart"in n&&wk(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),F0&&og(F0,n)||(F0=n,n=Zx(eb,"onSelect"),0<n.length&&(e=new xk("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=qd)))}function Mp(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Zd={animationend:Mp("Animation","AnimationEnd"),animationiteration:Mp("Animation","AnimationIteration"),animationstart:Mp("Animation","AnimationStart"),transitionend:Mp("Transition","TransitionEnd")},f_={},SF={};ul&&(SF=document.createElement("div").style,"AnimationEvent"in window||(delete Zd.animationend.animation,delete Zd.animationiteration.animation,delete Zd.animationstart.animation),"TransitionEvent"in window||delete Zd.transitionend.transition);function dy(t){if(f_[t])return f_[t];if(!Zd[t])return t;var e=Zd[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in SF)return f_[t]=e[r];return t}var kF=dy("animationend"),CF=dy("animationiteration"),TF=dy("animationstart"),EF=dy("transitionend"),NF=new Map,O3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kc(t,e){NF.set(t,e),td(e,[t])}for(var h_=0;h_<O3.length;h_++){var g_=O3[h_],bU=g_.toLowerCase(),SU=g_[0].toUpperCase()+g_.slice(1);kc(bU,"on"+SU)}kc(kF,"onAnimationEnd");kc(CF,"onAnimationIteration");kc(TF,"onAnimationStart");kc("dblclick","onDoubleClick");kc("focusin","onFocus");kc("focusout","onBlur");kc(EF,"onTransitionEnd");Rf("onMouseEnter",["mouseout","mouseover"]);Rf("onMouseLeave",["mouseout","mouseover"]);Rf("onPointerEnter",["pointerout","pointerover"]);Rf("onPointerLeave",["pointerout","pointerover"]);td("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));td("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));td("onBeforeInput",["compositionend","keypress","textInput","paste"]);td("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));td("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));td("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var v0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kU=new Set("cancel close invalid load scroll toggle".split(" ").concat(v0));function B3(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,bB(n,e,void 0,t),t.currentTarget=null}function AF(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;B3(s,o,u),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,u=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;B3(s,o,u),a=l}}}if(Xx)throw t=J2,Xx=!1,J2=null,t}function Vr(t,e){var r=e[ib];r===void 0&&(r=e[ib]=new Set);var n=t+"__bubble";r.has(n)||(jF(e,t,2,!1),r.add(n))}function m_(t,e,r){var n=0;e&&(n|=4),jF(r,t,n,e)}var Lp="_reactListening"+Math.random().toString(36).slice(2);function lg(t){if(!t[Lp]){t[Lp]=!0,Ij.forEach(function(r){r!=="selectionchange"&&(kU.has(r)||m_(r,!1,t),m_(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Lp]||(e[Lp]=!0,m_("selectionchange",!1,e))}}function jF(t,e,r,n){switch(hF(e)){case 1:var s=OB;break;case 4:s=BB;break;default:s=mk}r=s.bind(null,e,r,t),s=void 0,!Y2||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function p_(t,e,r,n,s){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=uu(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}Zj(function(){var u=a,d=dk(r),g=[];e:{var h=NF.get(t);if(h!==void 0){var p=xk,x=t;switch(t){case"keypress":if(Cx(r)===0)break e;case"keydown":case"keyup":p=eU;break;case"focusin":x="focus",p=c_;break;case"focusout":x="blur",p=c_;break;case"beforeblur":case"afterblur":p=c_;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=E3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=WB;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=nU;break;case kF:case CF:case TF:p=GB;break;case EF:p=aU;break;case"scroll":p=UB;break;case"wheel":p=oU;break;case"copy":case"cut":case"paste":p=KB;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=A3}var v=(e&4)!==0,w=!v&&t==="scroll",S=v?h!==null?h+"Capture":null:h;v=[];for(var _=u,y;_!==null;){y=_;var k=y.stateNode;if(y.tag===5&&k!==null&&(y=k,S!==null&&(k=rg(_,S),k!=null&&v.push(cg(_,k,y)))),w)break;_=_.return}0<v.length&&(h=new p(h,x,null,r,d),g.push({event:h,listeners:v}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&r!==K2&&(x=r.relatedTarget||r.fromElement)&&(uu(x)||x[dl]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=u,x=x?uu(x):null,x!==null&&(w=rd(x),x!==w||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=u),p!==x)){if(v=E3,k="onMouseLeave",S="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(v=A3,k="onPointerLeave",S="onPointerEnter",_="pointer"),w=p==null?h:ef(p),y=x==null?h:ef(x),h=new v(k,_+"leave",p,r,d),h.target=w,h.relatedTarget=y,k=null,uu(d)===u&&(v=new v(S,_+"enter",x,r,d),v.target=y,v.relatedTarget=w,k=v),w=k,p&&x)t:{for(v=p,S=x,_=0,y=v;y;y=Rd(y))_++;for(y=0,k=S;k;k=Rd(k))y++;for(;0<_-y;)v=Rd(v),_--;for(;0<y-_;)S=Rd(S),y--;for(;_--;){if(v===S||S!==null&&v===S.alternate)break t;v=Rd(v),S=Rd(S)}v=null}else v=null;p!==null&&U3(g,h,p,v,!1),x!==null&&w!==null&&U3(g,w,x,v,!0)}}e:{if(h=u?ef(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var N=gU;else if(P3(h))if(vF)N=yU;else{N=pU;var E=mU}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(N=xU);if(N&&(N=N(t,u))){yF(g,N,r,d);break e}E&&E(t,h,u),t==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&W2(h,"number",h.value)}switch(E=u?ef(u):window,t){case"focusin":(P3(E)||E.contentEditable==="true")&&(qd=E,eb=u,F0=null);break;case"focusout":F0=eb=qd=null;break;case"mousedown":tb=!0;break;case"contextmenu":case"mouseup":case"dragend":tb=!1,I3(g,r,d);break;case"selectionchange":if(_U)break;case"keydown":case"keyup":I3(g,r,d)}var A;if(vk)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Qd?pF(t,r)&&(C="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(mF&&r.locale!=="ko"&&(Qd||C!=="onCompositionStart"?C==="onCompositionEnd"&&Qd&&(A=gF()):(Kl=d,pk="value"in Kl?Kl.value:Kl.textContent,Qd=!0)),E=Zx(u,C),0<E.length&&(C=new N3(C,t,null,r,d),g.push({event:C,listeners:E}),A?C.data=A:(A=xF(r),A!==null&&(C.data=A)))),(A=cU?uU(t,r):dU(t,r))&&(u=Zx(u,"onBeforeInput"),0<u.length&&(d=new N3("onBeforeInput","beforeinput",null,r,d),g.push({event:d,listeners:u}),d.data=A))}AF(g,e)})}function cg(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Zx(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=rg(t,r),a!=null&&n.unshift(cg(t,a,s)),a=rg(t,e),a!=null&&n.push(cg(t,a,s))),t=t.return}return n}function Rd(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function U3(t,e,r,n,s){for(var a=e._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,s?(l=rg(r,a),l!=null&&i.unshift(cg(r,l,o))):s||(l=rg(r,a),l!=null&&i.push(cg(r,l,o)))),r=r.return}i.length!==0&&t.push({event:e,listeners:i})}var CU=/\r\n?/g,TU=/\u0000|\uFFFD/g;function $3(t){return(typeof t=="string"?t:""+t).replace(CU,`
`).replace(TU,"")}function Ip(t,e,r){if(e=$3(e),$3(t)!==e&&r)throw Error(ft(425))}function e1(){}var rb=null,nb=null;function sb(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ab=typeof setTimeout=="function"?setTimeout:void 0,EU=typeof clearTimeout=="function"?clearTimeout:void 0,W3=typeof Promise=="function"?Promise:void 0,NU=typeof queueMicrotask=="function"?queueMicrotask:typeof W3<"u"?function(t){return W3.resolve(null).then(t).catch(AU)}:ab;function AU(t){setTimeout(function(){throw t})}function x_(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),ag(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);ag(e)}function sc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function z3(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var ah=Math.random().toString(36).slice(2),po="__reactFiber$"+ah,ug="__reactProps$"+ah,dl="__reactContainer$"+ah,ib="__reactEvents$"+ah,jU="__reactListeners$"+ah,FU="__reactHandles$"+ah;function uu(t){var e=t[po];if(e)return e;for(var r=t.parentNode;r;){if(e=r[dl]||r[po]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=z3(t);t!==null;){if(r=t[po])return r;t=z3(t)}return e}t=r,r=t.parentNode}return null}function em(t){return t=t[po]||t[dl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ef(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ft(33))}function fy(t){return t[ug]||null}var ob=[],tf=-1;function Cc(t){return{current:t}}function Yr(t){0>tf||(t.current=ob[tf],ob[tf]=null,tf--)}function Hr(t,e){tf++,ob[tf]=t.current,t.current=e}var gc={},Vs=Cc(gc),ba=Cc(!1),ju=gc;function Mf(t,e){var r=t.type.contextTypes;if(!r)return gc;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Sa(t){return t=t.childContextTypes,t!=null}function t1(){Yr(ba),Yr(Vs)}function H3(t,e,r){if(Vs.current!==gc)throw Error(ft(168));Hr(Vs,e),Hr(ba,r)}function FF(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(ft(108,mB(t)||"Unknown",s));return mn({},r,n)}function r1(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||gc,ju=Vs.current,Hr(Vs,t),Hr(ba,ba.current),!0}function G3(t,e,r){var n=t.stateNode;if(!n)throw Error(ft(169));r?(t=FF(t,e,ju),n.__reactInternalMemoizedMergedChildContext=t,Yr(ba),Yr(Vs),Hr(Vs,t)):Yr(ba),Hr(ba,r)}var Yo=null,hy=!1,y_=!1;function PF(t){Yo===null?Yo=[t]:Yo.push(t)}function PU(t){hy=!0,PF(t)}function Tc(){if(!y_&&Yo!==null){y_=!0;var t=0,e=Lr;try{var r=Yo;for(Lr=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Yo=null,hy=!1}catch(s){throw Yo!==null&&(Yo=Yo.slice(t+1)),nF(fk,Tc),s}finally{Lr=e,y_=!1}}return null}var rf=[],nf=0,n1=null,s1=0,ci=[],ui=0,Fu=null,Zo=1,el="";function ru(t,e){rf[nf++]=s1,rf[nf++]=n1,n1=t,s1=e}function DF(t,e,r){ci[ui++]=Zo,ci[ui++]=el,ci[ui++]=Fu,Fu=t;var n=Zo;t=el;var s=32-$i(n)-1;n&=~(1<<s),r+=1;var a=32-$i(e)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Zo=1<<32-$i(e)+s|r<<s|n,el=a+t}else Zo=1<<a|r<<s|n,el=t}function _k(t){t.return!==null&&(ru(t,1),DF(t,1,0))}function bk(t){for(;t===n1;)n1=rf[--nf],rf[nf]=null,s1=rf[--nf],rf[nf]=null;for(;t===Fu;)Fu=ci[--ui],ci[ui]=null,el=ci[--ui],ci[ui]=null,Zo=ci[--ui],ci[ui]=null}var Oa=null,Ia=null,rn=!1,Oi=null;function RF(t,e){var r=fi(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function V3(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Oa=t,Ia=sc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Oa=t,Ia=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Fu!==null?{id:Zo,overflow:el}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=fi(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Oa=t,Ia=null,!0):!1;default:return!1}}function lb(t){return(t.mode&1)!==0&&(t.flags&128)===0}function cb(t){if(rn){var e=Ia;if(e){var r=e;if(!V3(t,e)){if(lb(t))throw Error(ft(418));e=sc(r.nextSibling);var n=Oa;e&&V3(t,e)?RF(n,r):(t.flags=t.flags&-4097|2,rn=!1,Oa=t)}}else{if(lb(t))throw Error(ft(418));t.flags=t.flags&-4097|2,rn=!1,Oa=t}}}function K3(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Oa=t}function Op(t){if(t!==Oa)return!1;if(!rn)return K3(t),rn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!sb(t.type,t.memoizedProps)),e&&(e=Ia)){if(lb(t))throw MF(),Error(ft(418));for(;e;)RF(t,e),e=sc(e.nextSibling)}if(K3(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ft(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ia=sc(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ia=null}}else Ia=Oa?sc(t.stateNode.nextSibling):null;return!0}function MF(){for(var t=Ia;t;)t=sc(t.nextSibling)}function Lf(){Ia=Oa=null,rn=!1}function Sk(t){Oi===null?Oi=[t]:Oi.push(t)}var DU=vl.ReactCurrentBatchConfig;function r0(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ft(309));var n=r.stateNode}if(!n)throw Error(ft(147,t));var s=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},e._stringRef=a,e)}if(typeof t!="string")throw Error(ft(284));if(!r._owner)throw Error(ft(290,t))}return t}function Bp(t,e){throw t=Object.prototype.toString.call(e),Error(ft(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function X3(t){var e=t._init;return e(t._payload)}function LF(t){function e(S,_){if(t){var y=S.deletions;y===null?(S.deletions=[_],S.flags|=16):y.push(_)}}function r(S,_){if(!t)return null;for(;_!==null;)e(S,_),_=_.sibling;return null}function n(S,_){for(S=new Map;_!==null;)_.key!==null?S.set(_.key,_):S.set(_.index,_),_=_.sibling;return S}function s(S,_){return S=lc(S,_),S.index=0,S.sibling=null,S}function a(S,_,y){return S.index=y,t?(y=S.alternate,y!==null?(y=y.index,y<_?(S.flags|=2,_):y):(S.flags|=2,_)):(S.flags|=1048576,_)}function i(S){return t&&S.alternate===null&&(S.flags|=2),S}function o(S,_,y,k){return _===null||_.tag!==6?(_=C_(y,S.mode,k),_.return=S,_):(_=s(_,y),_.return=S,_)}function l(S,_,y,k){var N=y.type;return N===Jd?d(S,_,y.props.children,k,y.key):_!==null&&(_.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===zl&&X3(N)===_.type)?(k=s(_,y.props),k.ref=r0(S,_,y),k.return=S,k):(k=Px(y.type,y.key,y.props,null,S.mode,k),k.ref=r0(S,_,y),k.return=S,k)}function u(S,_,y,k){return _===null||_.tag!==4||_.stateNode.containerInfo!==y.containerInfo||_.stateNode.implementation!==y.implementation?(_=T_(y,S.mode,k),_.return=S,_):(_=s(_,y.children||[]),_.return=S,_)}function d(S,_,y,k,N){return _===null||_.tag!==7?(_=yu(y,S.mode,k,N),_.return=S,_):(_=s(_,y),_.return=S,_)}function g(S,_,y){if(typeof _=="string"&&_!==""||typeof _=="number")return _=C_(""+_,S.mode,y),_.return=S,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Np:return y=Px(_.type,_.key,_.props,null,S.mode,y),y.ref=r0(S,null,_),y.return=S,y;case Yd:return _=T_(_,S.mode,y),_.return=S,_;case zl:var k=_._init;return g(S,k(_._payload),y)}if(x0(_)||Qh(_))return _=yu(_,S.mode,y,null),_.return=S,_;Bp(S,_)}return null}function h(S,_,y,k){var N=_!==null?_.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return N!==null?null:o(S,_,""+y,k);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Np:return y.key===N?l(S,_,y,k):null;case Yd:return y.key===N?u(S,_,y,k):null;case zl:return N=y._init,h(S,_,N(y._payload),k)}if(x0(y)||Qh(y))return N!==null?null:d(S,_,y,k,null);Bp(S,y)}return null}function p(S,_,y,k,N){if(typeof k=="string"&&k!==""||typeof k=="number")return S=S.get(y)||null,o(_,S,""+k,N);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Np:return S=S.get(k.key===null?y:k.key)||null,l(_,S,k,N);case Yd:return S=S.get(k.key===null?y:k.key)||null,u(_,S,k,N);case zl:var E=k._init;return p(S,_,y,E(k._payload),N)}if(x0(k)||Qh(k))return S=S.get(y)||null,d(_,S,k,N,null);Bp(_,k)}return null}function x(S,_,y,k){for(var N=null,E=null,A=_,C=_=0,F=null;A!==null&&C<y.length;C++){A.index>C?(F=A,A=null):F=A.sibling;var D=h(S,A,y[C],k);if(D===null){A===null&&(A=F);break}t&&A&&D.alternate===null&&e(S,A),_=a(D,_,C),E===null?N=D:E.sibling=D,E=D,A=F}if(C===y.length)return r(S,A),rn&&ru(S,C),N;if(A===null){for(;C<y.length;C++)A=g(S,y[C],k),A!==null&&(_=a(A,_,C),E===null?N=A:E.sibling=A,E=A);return rn&&ru(S,C),N}for(A=n(S,A);C<y.length;C++)F=p(A,S,C,y[C],k),F!==null&&(t&&F.alternate!==null&&A.delete(F.key===null?C:F.key),_=a(F,_,C),E===null?N=F:E.sibling=F,E=F);return t&&A.forEach(function(R){return e(S,R)}),rn&&ru(S,C),N}function v(S,_,y,k){var N=Qh(y);if(typeof N!="function")throw Error(ft(150));if(y=N.call(y),y==null)throw Error(ft(151));for(var E=N=null,A=_,C=_=0,F=null,D=y.next();A!==null&&!D.done;C++,D=y.next()){A.index>C?(F=A,A=null):F=A.sibling;var R=h(S,A,D.value,k);if(R===null){A===null&&(A=F);break}t&&A&&R.alternate===null&&e(S,A),_=a(R,_,C),E===null?N=R:E.sibling=R,E=R,A=F}if(D.done)return r(S,A),rn&&ru(S,C),N;if(A===null){for(;!D.done;C++,D=y.next())D=g(S,D.value,k),D!==null&&(_=a(D,_,C),E===null?N=D:E.sibling=D,E=D);return rn&&ru(S,C),N}for(A=n(S,A);!D.done;C++,D=y.next())D=p(A,S,C,D.value,k),D!==null&&(t&&D.alternate!==null&&A.delete(D.key===null?C:D.key),_=a(D,_,C),E===null?N=D:E.sibling=D,E=D);return t&&A.forEach(function(M){return e(S,M)}),rn&&ru(S,C),N}function w(S,_,y,k){if(typeof y=="object"&&y!==null&&y.type===Jd&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Np:e:{for(var N=y.key,E=_;E!==null;){if(E.key===N){if(N=y.type,N===Jd){if(E.tag===7){r(S,E.sibling),_=s(E,y.props.children),_.return=S,S=_;break e}}else if(E.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===zl&&X3(N)===E.type){r(S,E.sibling),_=s(E,y.props),_.ref=r0(S,E,y),_.return=S,S=_;break e}r(S,E);break}else e(S,E);E=E.sibling}y.type===Jd?(_=yu(y.props.children,S.mode,k,y.key),_.return=S,S=_):(k=Px(y.type,y.key,y.props,null,S.mode,k),k.ref=r0(S,_,y),k.return=S,S=k)}return i(S);case Yd:e:{for(E=y.key;_!==null;){if(_.key===E)if(_.tag===4&&_.stateNode.containerInfo===y.containerInfo&&_.stateNode.implementation===y.implementation){r(S,_.sibling),_=s(_,y.children||[]),_.return=S,S=_;break e}else{r(S,_);break}else e(S,_);_=_.sibling}_=T_(y,S.mode,k),_.return=S,S=_}return i(S);case zl:return E=y._init,w(S,_,E(y._payload),k)}if(x0(y))return x(S,_,y,k);if(Qh(y))return v(S,_,y,k);Bp(S,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,_!==null&&_.tag===6?(r(S,_.sibling),_=s(_,y),_.return=S,S=_):(r(S,_),_=C_(y,S.mode,k),_.return=S,S=_),i(S)):r(S,_)}return w}var If=LF(!0),IF=LF(!1),a1=Cc(null),i1=null,sf=null,kk=null;function Ck(){kk=sf=i1=null}function Tk(t){var e=a1.current;Yr(a1),t._currentValue=e}function ub(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function _f(t,e){i1=t,kk=sf=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(wa=!0),t.firstContext=null)}function yi(t){var e=t._currentValue;if(kk!==t)if(t={context:t,memoizedValue:e,next:null},sf===null){if(i1===null)throw Error(ft(308));sf=t,i1.dependencies={lanes:0,firstContext:t}}else sf=sf.next=t;return e}var du=null;function Ek(t){du===null?du=[t]:du.push(t)}function OF(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,Ek(e)):(r.next=s.next,s.next=r),e.interleaved=r,fl(t,n)}function fl(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Hl=!1;function Nk(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function BF(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function sl(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ac(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,vr&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,fl(t,r)}return s=n.interleaved,s===null?(e.next=e,Ek(n)):(e.next=s.next,s.next=e),n.interleaved=e,fl(t,r)}function Tx(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,hk(t,r)}}function Y3(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=e:a=a.next=e}else s=a=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function o1(t,e,r,n){var s=t.updateQueue;Hl=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,u=l.next;l.next=null,i===null?a=u:i.next=u,i=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==i&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=l))}if(a!==null){var g=s.baseState;i=0,d=u=l=null,o=a;do{var h=o.lane,p=o.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=t,v=o;switch(h=e,p=r,v.tag){case 1:if(x=v.payload,typeof x=="function"){g=x.call(p,g,h);break e}g=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=v.payload,h=typeof x=="function"?x.call(p,g,h):x,h==null)break e;g=mn({},g,h);break e;case 2:Hl=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,h=s.effects,h===null?s.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=p,l=g):d=d.next=p,i|=h;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;h=o,o=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(d===null&&(l=g),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);Du|=i,t.lanes=i,t.memoizedState=g}}function J3(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(ft(191,s));s.call(n)}}}var tm={},bo=Cc(tm),dg=Cc(tm),fg=Cc(tm);function fu(t){if(t===tm)throw Error(ft(174));return t}function Ak(t,e){switch(Hr(fg,e),Hr(dg,t),Hr(bo,tm),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:H2(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=H2(e,t)}Yr(bo),Hr(bo,e)}function Of(){Yr(bo),Yr(dg),Yr(fg)}function UF(t){fu(fg.current);var e=fu(bo.current),r=H2(e,t.type);e!==r&&(Hr(dg,t),Hr(bo,r))}function jk(t){dg.current===t&&(Yr(bo),Yr(dg))}var un=Cc(0);function l1(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var v_=[];function Fk(){for(var t=0;t<v_.length;t++)v_[t]._workInProgressVersionPrimary=null;v_.length=0}var Ex=vl.ReactCurrentDispatcher,w_=vl.ReactCurrentBatchConfig,Pu=0,gn=null,Yn=null,us=null,c1=!1,P0=!1,hg=0,RU=0;function Ds(){throw Error(ft(321))}function Pk(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Ki(t[r],e[r]))return!1;return!0}function Dk(t,e,r,n,s,a){if(Pu=a,gn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ex.current=t===null||t.memoizedState===null?OU:BU,t=r(n,s),P0){a=0;do{if(P0=!1,hg=0,25<=a)throw Error(ft(301));a+=1,us=Yn=null,e.updateQueue=null,Ex.current=UU,t=r(n,s)}while(P0)}if(Ex.current=u1,e=Yn!==null&&Yn.next!==null,Pu=0,us=Yn=gn=null,c1=!1,e)throw Error(ft(300));return t}function Rk(){var t=hg!==0;return hg=0,t}function fo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return us===null?gn.memoizedState=us=t:us=us.next=t,us}function vi(){if(Yn===null){var t=gn.alternate;t=t!==null?t.memoizedState:null}else t=Yn.next;var e=us===null?gn.memoizedState:us.next;if(e!==null)us=e,Yn=t;else{if(t===null)throw Error(ft(310));Yn=t,t={memoizedState:Yn.memoizedState,baseState:Yn.baseState,baseQueue:Yn.baseQueue,queue:Yn.queue,next:null},us===null?gn.memoizedState=us=t:us=us.next=t}return us}function gg(t,e){return typeof e=="function"?e(t):e}function __(t){var e=vi(),r=e.queue;if(r===null)throw Error(ft(311));r.lastRenderedReducer=t;var n=Yn,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,u=a;do{var d=u.lane;if((Pu&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var g={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=g,i=n):l=l.next=g,gn.lanes|=d,Du|=d}u=u.next}while(u!==null&&u!==a);l===null?i=n:l.next=o,Ki(n,e.memoizedState)||(wa=!0),e.memoizedState=n,e.baseState=i,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do a=s.lane,gn.lanes|=a,Du|=a,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function b_(t){var e=vi(),r=e.queue;if(r===null)throw Error(ft(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,a=e.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=t(a,i.action),i=i.next;while(i!==s);Ki(a,e.memoizedState)||(wa=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function $F(){}function WF(t,e){var r=gn,n=vi(),s=e(),a=!Ki(n.memoizedState,s);if(a&&(n.memoizedState=s,wa=!0),n=n.queue,Mk(GF.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||us!==null&&us.memoizedState.tag&1){if(r.flags|=2048,mg(9,HF.bind(null,r,n,s,e),void 0,null),ms===null)throw Error(ft(349));Pu&30||zF(r,e,s)}return s}function zF(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=gn.updateQueue,e===null?(e={lastEffect:null,stores:null},gn.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function HF(t,e,r,n){e.value=r,e.getSnapshot=n,VF(e)&&KF(t)}function GF(t,e,r){return r(function(){VF(e)&&KF(t)})}function VF(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Ki(t,r)}catch{return!0}}function KF(t){var e=fl(t,1);e!==null&&Wi(e,t,1,-1)}function Q3(t){var e=fo();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gg,lastRenderedState:t},e.queue=t,t=t.dispatch=IU.bind(null,gn,t),[e.memoizedState,t]}function mg(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=gn.updateQueue,e===null?(e={lastEffect:null,stores:null},gn.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function XF(){return vi().memoizedState}function Nx(t,e,r,n){var s=fo();gn.flags|=t,s.memoizedState=mg(1|e,r,void 0,n===void 0?null:n)}function gy(t,e,r,n){var s=vi();n=n===void 0?null:n;var a=void 0;if(Yn!==null){var i=Yn.memoizedState;if(a=i.destroy,n!==null&&Pk(n,i.deps)){s.memoizedState=mg(e,r,a,n);return}}gn.flags|=t,s.memoizedState=mg(1|e,r,a,n)}function q3(t,e){return Nx(8390656,8,t,e)}function Mk(t,e){return gy(2048,8,t,e)}function YF(t,e){return gy(4,2,t,e)}function JF(t,e){return gy(4,4,t,e)}function QF(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function qF(t,e,r){return r=r!=null?r.concat([t]):null,gy(4,4,QF.bind(null,e,t),r)}function Lk(){}function ZF(t,e){var r=vi();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Pk(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function eP(t,e){var r=vi();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Pk(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function tP(t,e,r){return Pu&21?(Ki(r,e)||(r=iF(),gn.lanes|=r,Du|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,wa=!0),t.memoizedState=r)}function MU(t,e){var r=Lr;Lr=r!==0&&4>r?r:4,t(!0);var n=w_.transition;w_.transition={};try{t(!1),e()}finally{Lr=r,w_.transition=n}}function rP(){return vi().memoizedState}function LU(t,e,r){var n=oc(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},nP(t))sP(e,r);else if(r=OF(t,e,r,n),r!==null){var s=aa();Wi(r,t,n,s),aP(r,e,n)}}function IU(t,e,r){var n=oc(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(nP(t))sP(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var i=e.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,Ki(o,i)){var l=e.interleaved;l===null?(s.next=s,Ek(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}r=OF(t,e,s,n),r!==null&&(s=aa(),Wi(r,t,n,s),aP(r,e,n))}}function nP(t){var e=t.alternate;return t===gn||e!==null&&e===gn}function sP(t,e){P0=c1=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function aP(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,hk(t,r)}}var u1={readContext:yi,useCallback:Ds,useContext:Ds,useEffect:Ds,useImperativeHandle:Ds,useInsertionEffect:Ds,useLayoutEffect:Ds,useMemo:Ds,useReducer:Ds,useRef:Ds,useState:Ds,useDebugValue:Ds,useDeferredValue:Ds,useTransition:Ds,useMutableSource:Ds,useSyncExternalStore:Ds,useId:Ds,unstable_isNewReconciler:!1},OU={readContext:yi,useCallback:function(t,e){return fo().memoizedState=[t,e===void 0?null:e],t},useContext:yi,useEffect:q3,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Nx(4194308,4,QF.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Nx(4194308,4,t,e)},useInsertionEffect:function(t,e){return Nx(4,2,t,e)},useMemo:function(t,e){var r=fo();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=fo();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=LU.bind(null,gn,t),[n.memoizedState,t]},useRef:function(t){var e=fo();return t={current:t},e.memoizedState=t},useState:Q3,useDebugValue:Lk,useDeferredValue:function(t){return fo().memoizedState=t},useTransition:function(){var t=Q3(!1),e=t[0];return t=MU.bind(null,t[1]),fo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=gn,s=fo();if(rn){if(r===void 0)throw Error(ft(407));r=r()}else{if(r=e(),ms===null)throw Error(ft(349));Pu&30||zF(n,e,r)}s.memoizedState=r;var a={value:r,getSnapshot:e};return s.queue=a,q3(GF.bind(null,n,a,t),[t]),n.flags|=2048,mg(9,HF.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=fo(),e=ms.identifierPrefix;if(rn){var r=el,n=Zo;r=(n&~(1<<32-$i(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=hg++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=RU++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},BU={readContext:yi,useCallback:ZF,useContext:yi,useEffect:Mk,useImperativeHandle:qF,useInsertionEffect:YF,useLayoutEffect:JF,useMemo:eP,useReducer:__,useRef:XF,useState:function(){return __(gg)},useDebugValue:Lk,useDeferredValue:function(t){var e=vi();return tP(e,Yn.memoizedState,t)},useTransition:function(){var t=__(gg)[0],e=vi().memoizedState;return[t,e]},useMutableSource:$F,useSyncExternalStore:WF,useId:rP,unstable_isNewReconciler:!1},UU={readContext:yi,useCallback:ZF,useContext:yi,useEffect:Mk,useImperativeHandle:qF,useInsertionEffect:YF,useLayoutEffect:JF,useMemo:eP,useReducer:b_,useRef:XF,useState:function(){return b_(gg)},useDebugValue:Lk,useDeferredValue:function(t){var e=vi();return Yn===null?e.memoizedState=t:tP(e,Yn.memoizedState,t)},useTransition:function(){var t=b_(gg)[0],e=vi().memoizedState;return[t,e]},useMutableSource:$F,useSyncExternalStore:WF,useId:rP,unstable_isNewReconciler:!1};function Mi(t,e){if(t&&t.defaultProps){e=mn({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function db(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:mn({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var my={isMounted:function(t){return(t=t._reactInternals)?rd(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=aa(),s=oc(t),a=sl(n,s);a.payload=e,r!=null&&(a.callback=r),e=ac(t,a,s),e!==null&&(Wi(e,t,s,n),Tx(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=aa(),s=oc(t),a=sl(n,s);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=ac(t,a,s),e!==null&&(Wi(e,t,s,n),Tx(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=aa(),n=oc(t),s=sl(r,n);s.tag=2,e!=null&&(s.callback=e),e=ac(t,s,n),e!==null&&(Wi(e,t,n,r),Tx(e,t,n))}};function Z3(t,e,r,n,s,a,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,i):e.prototype&&e.prototype.isPureReactComponent?!og(r,n)||!og(s,a):!0}function iP(t,e,r){var n=!1,s=gc,a=e.contextType;return typeof a=="object"&&a!==null?a=yi(a):(s=Sa(e)?ju:Vs.current,n=e.contextTypes,a=(n=n!=null)?Mf(t,s):gc),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=my,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function eN(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&my.enqueueReplaceState(e,e.state,null)}function fb(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},Nk(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=yi(a):(a=Sa(e)?ju:Vs.current,s.context=Mf(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(db(t,e,a,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&my.enqueueReplaceState(s,s.state,null),o1(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Bf(t,e){try{var r="",n=e;do r+=gB(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function S_(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function hb(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var $U=typeof WeakMap=="function"?WeakMap:Map;function oP(t,e,r){r=sl(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){f1||(f1=!0,Sb=n),hb(t,e)},r}function lP(t,e,r){r=sl(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){hb(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){hb(t,e),typeof n!="function"&&(ic===null?ic=new Set([this]):ic.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),r}function tN(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new $U;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=t$.bind(null,t,e,r),e.then(t,t))}function rN(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function nN(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=sl(-1,1),e.tag=2,ac(r,e,1))),r.lanes|=1),t)}var WU=vl.ReactCurrentOwner,wa=!1;function Zs(t,e,r,n){e.child=t===null?IF(e,null,r,n):If(e,t.child,r,n)}function sN(t,e,r,n,s){r=r.render;var a=e.ref;return _f(e,s),n=Dk(t,e,r,n,a,s),r=Rk(),t!==null&&!wa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,hl(t,e,s)):(rn&&r&&_k(e),e.flags|=1,Zs(t,e,n,s),e.child)}function aN(t,e,r,n,s){if(t===null){var a=r.type;return typeof a=="function"&&!Hk(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,cP(t,e,a,n,s)):(t=Px(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:og,r(i,n)&&t.ref===e.ref)return hl(t,e,s)}return e.flags|=1,t=lc(a,n),t.ref=e.ref,t.return=e,e.child=t}function cP(t,e,r,n,s){if(t!==null){var a=t.memoizedProps;if(og(a,n)&&t.ref===e.ref)if(wa=!1,e.pendingProps=n=a,(t.lanes&s)!==0)t.flags&131072&&(wa=!0);else return e.lanes=t.lanes,hl(t,e,s)}return gb(t,e,r,n,s)}function uP(t,e,r){var n=e.pendingProps,s=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Hr(of,Fa),Fa|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Hr(of,Fa),Fa|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Hr(of,Fa),Fa|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,Hr(of,Fa),Fa|=n;return Zs(t,e,s,r),e.child}function dP(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function gb(t,e,r,n,s){var a=Sa(r)?ju:Vs.current;return a=Mf(e,a),_f(e,s),r=Dk(t,e,r,n,a,s),n=Rk(),t!==null&&!wa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,hl(t,e,s)):(rn&&n&&_k(e),e.flags|=1,Zs(t,e,r,s),e.child)}function iN(t,e,r,n,s){if(Sa(r)){var a=!0;r1(e)}else a=!1;if(_f(e,s),e.stateNode===null)Ax(t,e),iP(e,r,n),fb(e,r,n,s),n=!0;else if(t===null){var i=e.stateNode,o=e.memoizedProps;i.props=o;var l=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=yi(u):(u=Sa(r)?ju:Vs.current,u=Mf(e,u));var d=r.getDerivedStateFromProps,g=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";g||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==u)&&eN(e,i,n,u),Hl=!1;var h=e.memoizedState;i.state=h,o1(e,n,i,s),l=e.memoizedState,o!==n||h!==l||ba.current||Hl?(typeof d=="function"&&(db(e,r,d,n),l=e.memoizedState),(o=Hl||Z3(e,r,o,n,h,l,u))?(g||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),i.props=n,i.state=l,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{i=e.stateNode,BF(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:Mi(e.type,o),i.props=u,g=e.pendingProps,h=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=yi(l):(l=Sa(r)?ju:Vs.current,l=Mf(e,l));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==g||h!==l)&&eN(e,i,n,l),Hl=!1,h=e.memoizedState,i.state=h,o1(e,n,i,s);var x=e.memoizedState;o!==g||h!==x||ba.current||Hl?(typeof p=="function"&&(db(e,r,p,n),x=e.memoizedState),(u=Hl||Z3(e,r,u,n,h,x,l)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,x,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,x,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=x),i.props=n,i.state=x,i.context=l,n=u):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),n=!1)}return mb(t,e,r,n,a,s)}function mb(t,e,r,n,s,a){dP(t,e);var i=(e.flags&128)!==0;if(!n&&!i)return s&&G3(e,r,!1),hl(t,e,a);n=e.stateNode,WU.current=e;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&i?(e.child=If(e,t.child,null,a),e.child=If(e,null,o,a)):Zs(t,e,o,a),e.memoizedState=n.state,s&&G3(e,r,!0),e.child}function fP(t){var e=t.stateNode;e.pendingContext?H3(t,e.pendingContext,e.pendingContext!==e.context):e.context&&H3(t,e.context,!1),Ak(t,e.containerInfo)}function oN(t,e,r,n,s){return Lf(),Sk(s),e.flags|=256,Zs(t,e,r,n),e.child}var pb={dehydrated:null,treeContext:null,retryLane:0};function xb(t){return{baseLanes:t,cachePool:null,transitions:null}}function hP(t,e,r){var n=e.pendingProps,s=un.current,a=!1,i=(e.flags&128)!==0,o;if((o=i)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Hr(un,s&1),t===null)return cb(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=n.children,t=n.fallback,a?(n=e.mode,a=e.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=yy(i,n,0,null),t=yu(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=xb(r),e.memoizedState=pb,t):Ik(e,i));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return zU(t,e,i,n,o,s,r);if(a){a=n.fallback,i=e.mode,s=t.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=lc(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=lc(o,a):(a=yu(a,i,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,i=t.child.memoizedState,i=i===null?xb(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=t.childLanes&~r,e.memoizedState=pb,n}return a=t.child,t=a.sibling,n=lc(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Ik(t,e){return e=yy({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Up(t,e,r,n){return n!==null&&Sk(n),If(e,t.child,null,r),t=Ik(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function zU(t,e,r,n,s,a,i){if(r)return e.flags&256?(e.flags&=-257,n=S_(Error(ft(422))),Up(t,e,i,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,s=e.mode,n=yy({mode:"visible",children:n.children},s,0,null),a=yu(a,s,i,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&If(e,t.child,null,i),e.child.memoizedState=xb(i),e.memoizedState=pb,a);if(!(e.mode&1))return Up(t,e,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(ft(419)),n=S_(a,n,void 0),Up(t,e,i,n)}if(o=(i&t.childLanes)!==0,wa||o){if(n=ms,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,fl(t,s),Wi(n,t,s,-1))}return zk(),n=S_(Error(ft(421))),Up(t,e,i,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=r$.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,Ia=sc(s.nextSibling),Oa=e,rn=!0,Oi=null,t!==null&&(ci[ui++]=Zo,ci[ui++]=el,ci[ui++]=Fu,Zo=t.id,el=t.overflow,Fu=e),e=Ik(e,n.children),e.flags|=4096,e)}function lN(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),ub(t.return,e,r)}function k_(t,e,r,n,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function gP(t,e,r){var n=e.pendingProps,s=n.revealOrder,a=n.tail;if(Zs(t,e,n.children,r),n=un.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&lN(t,r,e);else if(t.tag===19)lN(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Hr(un,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&l1(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),k_(e,!1,s,r,a);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&l1(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}k_(e,!0,r,null,a);break;case"together":k_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ax(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function hl(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Du|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ft(153));if(e.child!==null){for(t=e.child,r=lc(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=lc(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function HU(t,e,r){switch(e.tag){case 3:fP(e),Lf();break;case 5:UF(e);break;case 1:Sa(e.type)&&r1(e);break;case 4:Ak(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Hr(a1,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Hr(un,un.current&1),e.flags|=128,null):r&e.child.childLanes?hP(t,e,r):(Hr(un,un.current&1),t=hl(t,e,r),t!==null?t.sibling:null);Hr(un,un.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return gP(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Hr(un,un.current),n)break;return null;case 22:case 23:return e.lanes=0,uP(t,e,r)}return hl(t,e,r)}var mP,yb,pP,xP;mP=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};yb=function(){};pP=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,fu(bo.current);var a=null;switch(r){case"input":s=U2(t,s),n=U2(t,n),a=[];break;case"select":s=mn({},s,{value:void 0}),n=mn({},n,{value:void 0}),a=[];break;case"textarea":s=z2(t,s),n=z2(t,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=e1)}G2(r,n);var i;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(eg.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var l=n[u];if(o=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(eg.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Vr("scroll",t),a||o===l||(a=[])):(a=a||[]).push(u,l))}r&&(a=a||[]).push("style",r);var u=a;(e.updateQueue=u)&&(e.flags|=4)}};xP=function(t,e,r,n){r!==n&&(e.flags|=4)};function n0(t,e){if(!rn)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Rs(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function GU(t,e,r){var n=e.pendingProps;switch(bk(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rs(e),null;case 1:return Sa(e.type)&&t1(),Rs(e),null;case 3:return n=e.stateNode,Of(),Yr(ba),Yr(Vs),Fk(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Op(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Oi!==null&&(Tb(Oi),Oi=null))),yb(t,e),Rs(e),null;case 5:jk(e);var s=fu(fg.current);if(r=e.type,t!==null&&e.stateNode!=null)pP(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(ft(166));return Rs(e),null}if(t=fu(bo.current),Op(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[po]=e,n[ug]=a,t=(e.mode&1)!==0,r){case"dialog":Vr("cancel",n),Vr("close",n);break;case"iframe":case"object":case"embed":Vr("load",n);break;case"video":case"audio":for(s=0;s<v0.length;s++)Vr(v0[s],n);break;case"source":Vr("error",n);break;case"img":case"image":case"link":Vr("error",n),Vr("load",n);break;case"details":Vr("toggle",n);break;case"input":x3(n,a),Vr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Vr("invalid",n);break;case"textarea":v3(n,a),Vr("invalid",n)}G2(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Ip(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Ip(n.textContent,o,t),s=["children",""+o]):eg.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Vr("scroll",n)}switch(r){case"input":Ap(n),y3(n,a,!0);break;case"textarea":Ap(n),w3(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=e1)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Gj(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=i.createElement(r,{is:n.is}):(t=i.createElement(r),r==="select"&&(i=t,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):t=i.createElementNS(t,r),t[po]=e,t[ug]=n,mP(t,e,!1,!1),e.stateNode=t;e:{switch(i=V2(r,n),r){case"dialog":Vr("cancel",t),Vr("close",t),s=n;break;case"iframe":case"object":case"embed":Vr("load",t),s=n;break;case"video":case"audio":for(s=0;s<v0.length;s++)Vr(v0[s],t);s=n;break;case"source":Vr("error",t),s=n;break;case"img":case"image":case"link":Vr("error",t),Vr("load",t),s=n;break;case"details":Vr("toggle",t),s=n;break;case"input":x3(t,n),s=U2(t,n),Vr("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=mn({},n,{value:void 0}),Vr("invalid",t);break;case"textarea":v3(t,n),s=z2(t,n),Vr("invalid",t);break;default:s=n}G2(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?Xj(t,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Vj(t,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&tg(t,l):typeof l=="number"&&tg(t,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(eg.hasOwnProperty(a)?l!=null&&a==="onScroll"&&Vr("scroll",t):l!=null&&ok(t,a,l,i))}switch(r){case"input":Ap(t),y3(t,n,!1);break;case"textarea":Ap(t),w3(t);break;case"option":n.value!=null&&t.setAttribute("value",""+hc(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?xf(t,!!n.multiple,a,!1):n.defaultValue!=null&&xf(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=e1)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Rs(e),null;case 6:if(t&&e.stateNode!=null)xP(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(ft(166));if(r=fu(fg.current),fu(bo.current),Op(e)){if(n=e.stateNode,r=e.memoizedProps,n[po]=e,(a=n.nodeValue!==r)&&(t=Oa,t!==null))switch(t.tag){case 3:Ip(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ip(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[po]=e,e.stateNode=n}return Rs(e),null;case 13:if(Yr(un),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(rn&&Ia!==null&&e.mode&1&&!(e.flags&128))MF(),Lf(),e.flags|=98560,a=!1;else if(a=Op(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(ft(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ft(317));a[po]=e}else Lf(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Rs(e),a=!1}else Oi!==null&&(Tb(Oi),Oi=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||un.current&1?Zn===0&&(Zn=3):zk())),e.updateQueue!==null&&(e.flags|=4),Rs(e),null);case 4:return Of(),yb(t,e),t===null&&lg(e.stateNode.containerInfo),Rs(e),null;case 10:return Tk(e.type._context),Rs(e),null;case 17:return Sa(e.type)&&t1(),Rs(e),null;case 19:if(Yr(un),a=e.memoizedState,a===null)return Rs(e),null;if(n=(e.flags&128)!==0,i=a.rendering,i===null)if(n)n0(a,!1);else{if(Zn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=l1(t),i!==null){for(e.flags|=128,n0(a,!1),n=i.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,t=i.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Hr(un,un.current&1|2),e.child}t=t.sibling}a.tail!==null&&Pn()>Uf&&(e.flags|=128,n=!0,n0(a,!1),e.lanes=4194304)}else{if(!n)if(t=l1(i),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),n0(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!rn)return Rs(e),null}else 2*Pn()-a.renderingStartTime>Uf&&r!==1073741824&&(e.flags|=128,n=!0,n0(a,!1),e.lanes=4194304);a.isBackwards?(i.sibling=e.child,e.child=i):(r=a.last,r!==null?r.sibling=i:e.child=i,a.last=i)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Pn(),e.sibling=null,r=un.current,Hr(un,n?r&1|2:r&1),e):(Rs(e),null);case 22:case 23:return Wk(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Fa&1073741824&&(Rs(e),e.subtreeFlags&6&&(e.flags|=8192)):Rs(e),null;case 24:return null;case 25:return null}throw Error(ft(156,e.tag))}function VU(t,e){switch(bk(e),e.tag){case 1:return Sa(e.type)&&t1(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Of(),Yr(ba),Yr(Vs),Fk(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return jk(e),null;case 13:if(Yr(un),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ft(340));Lf()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Yr(un),null;case 4:return Of(),null;case 10:return Tk(e.type._context),null;case 22:case 23:return Wk(),null;case 24:return null;default:return null}}var $p=!1,Bs=!1,KU=typeof WeakSet=="function"?WeakSet:Set,Lt=null;function af(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){bn(t,e,n)}else r.current=null}function vb(t,e,r){try{r()}catch(n){bn(t,e,n)}}var cN=!1;function XU(t,e){if(rb=Qx,t=bF(),wk(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,u=0,d=0,g=t,h=null;t:for(;;){for(var p;g!==r||s!==0&&g.nodeType!==3||(o=i+s),g!==a||n!==0&&g.nodeType!==3||(l=i+n),g.nodeType===3&&(i+=g.nodeValue.length),(p=g.firstChild)!==null;)h=g,g=p;for(;;){if(g===t)break t;if(h===r&&++u===s&&(o=i),h===a&&++d===n&&(l=i),(p=g.nextSibling)!==null)break;g=h,h=g.parentNode}g=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(nb={focusedElem:t,selectionRange:r},Qx=!1,Lt=e;Lt!==null;)if(e=Lt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Lt=t;else for(;Lt!==null;){e=Lt;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var v=x.memoizedProps,w=x.memoizedState,S=e.stateNode,_=S.getSnapshotBeforeUpdate(e.elementType===e.type?v:Mi(e.type,v),w);S.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ft(163))}}catch(k){bn(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,Lt=t;break}Lt=e.return}return x=cN,cN=!1,x}function D0(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&vb(e,r,a)}s=s.next}while(s!==n)}}function py(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function wb(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function yP(t){var e=t.alternate;e!==null&&(t.alternate=null,yP(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[po],delete e[ug],delete e[ib],delete e[jU],delete e[FU])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function vP(t){return t.tag===5||t.tag===3||t.tag===4}function uN(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||vP(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function _b(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=e1));else if(n!==4&&(t=t.child,t!==null))for(_b(t,e,r),t=t.sibling;t!==null;)_b(t,e,r),t=t.sibling}function bb(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(bb(t,e,r),t=t.sibling;t!==null;)bb(t,e,r),t=t.sibling}var vs=null,Ii=!1;function Ol(t,e,r){for(r=r.child;r!==null;)wP(t,e,r),r=r.sibling}function wP(t,e,r){if(_o&&typeof _o.onCommitFiberUnmount=="function")try{_o.onCommitFiberUnmount(ly,r)}catch{}switch(r.tag){case 5:Bs||af(r,e);case 6:var n=vs,s=Ii;vs=null,Ol(t,e,r),vs=n,Ii=s,vs!==null&&(Ii?(t=vs,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):vs.removeChild(r.stateNode));break;case 18:vs!==null&&(Ii?(t=vs,r=r.stateNode,t.nodeType===8?x_(t.parentNode,r):t.nodeType===1&&x_(t,r),ag(t)):x_(vs,r.stateNode));break;case 4:n=vs,s=Ii,vs=r.stateNode.containerInfo,Ii=!0,Ol(t,e,r),vs=n,Ii=s;break;case 0:case 11:case 14:case 15:if(!Bs&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&vb(r,e,i),s=s.next}while(s!==n)}Ol(t,e,r);break;case 1:if(!Bs&&(af(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){bn(r,e,o)}Ol(t,e,r);break;case 21:Ol(t,e,r);break;case 22:r.mode&1?(Bs=(n=Bs)||r.memoizedState!==null,Ol(t,e,r),Bs=n):Ol(t,e,r);break;default:Ol(t,e,r)}}function dN(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new KU),e.forEach(function(n){var s=n$.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function ji(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=t,i=e,o=i;e:for(;o!==null;){switch(o.tag){case 5:vs=o.stateNode,Ii=!1;break e;case 3:vs=o.stateNode.containerInfo,Ii=!0;break e;case 4:vs=o.stateNode.containerInfo,Ii=!0;break e}o=o.return}if(vs===null)throw Error(ft(160));wP(a,i,s),vs=null,Ii=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){bn(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)_P(e,t),e=e.sibling}function _P(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ji(e,t),oo(t),n&4){try{D0(3,t,t.return),py(3,t)}catch(v){bn(t,t.return,v)}try{D0(5,t,t.return)}catch(v){bn(t,t.return,v)}}break;case 1:ji(e,t),oo(t),n&512&&r!==null&&af(r,r.return);break;case 5:if(ji(e,t),oo(t),n&512&&r!==null&&af(r,r.return),t.flags&32){var s=t.stateNode;try{tg(s,"")}catch(v){bn(t,t.return,v)}}if(n&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,i=r!==null?r.memoizedProps:a,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&zj(s,a),V2(o,i);var u=V2(o,a);for(i=0;i<l.length;i+=2){var d=l[i],g=l[i+1];d==="style"?Xj(s,g):d==="dangerouslySetInnerHTML"?Vj(s,g):d==="children"?tg(s,g):ok(s,d,g,u)}switch(o){case"input":$2(s,a);break;case"textarea":Hj(s,a);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?xf(s,!!a.multiple,p,!1):h!==!!a.multiple&&(a.defaultValue!=null?xf(s,!!a.multiple,a.defaultValue,!0):xf(s,!!a.multiple,a.multiple?[]:"",!1))}s[ug]=a}catch(v){bn(t,t.return,v)}}break;case 6:if(ji(e,t),oo(t),n&4){if(t.stateNode===null)throw Error(ft(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(v){bn(t,t.return,v)}}break;case 3:if(ji(e,t),oo(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ag(e.containerInfo)}catch(v){bn(t,t.return,v)}break;case 4:ji(e,t),oo(t);break;case 13:ji(e,t),oo(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Uk=Pn())),n&4&&dN(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Bs=(u=Bs)||d,ji(e,t),Bs=u):ji(e,t),oo(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Lt=t,d=t.child;d!==null;){for(g=Lt=d;Lt!==null;){switch(h=Lt,p=h.child,h.tag){case 0:case 11:case 14:case 15:D0(4,h,h.return);break;case 1:af(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){n=h,r=h.return;try{e=n,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(v){bn(n,r,v)}}break;case 5:af(h,h.return);break;case 22:if(h.memoizedState!==null){hN(g);continue}}p!==null?(p.return=h,Lt=p):hN(g)}d=d.sibling}e:for(d=null,g=t;;){if(g.tag===5){if(d===null){d=g;try{s=g.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=g.stateNode,l=g.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Kj("display",i))}catch(v){bn(t,t.return,v)}}}else if(g.tag===6){if(d===null)try{g.stateNode.nodeValue=u?"":g.memoizedProps}catch(v){bn(t,t.return,v)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;d===g&&(d=null),g=g.return}d===g&&(d=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:ji(e,t),oo(t),n&4&&dN(t);break;case 21:break;default:ji(e,t),oo(t)}}function oo(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(vP(r)){var n=r;break e}r=r.return}throw Error(ft(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(tg(s,""),n.flags&=-33);var a=uN(t);bb(t,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=uN(t);_b(t,o,i);break;default:throw Error(ft(161))}}catch(l){bn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function YU(t,e,r){Lt=t,bP(t)}function bP(t,e,r){for(var n=(t.mode&1)!==0;Lt!==null;){var s=Lt,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||$p;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||Bs;o=$p;var u=Bs;if($p=i,(Bs=l)&&!u)for(Lt=s;Lt!==null;)i=Lt,l=i.child,i.tag===22&&i.memoizedState!==null?gN(s):l!==null?(l.return=i,Lt=l):gN(s);for(;a!==null;)Lt=a,bP(a),a=a.sibling;Lt=s,$p=o,Bs=u}fN(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Lt=a):fN(t)}}function fN(t){for(;Lt!==null;){var e=Lt;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Bs||py(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Bs)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Mi(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&J3(e,a,n);break;case 3:var i=e.updateQueue;if(i!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}J3(e,i,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var g=d.dehydrated;g!==null&&ag(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ft(163))}Bs||e.flags&512&&wb(e)}catch(h){bn(e,e.return,h)}}if(e===t){Lt=null;break}if(r=e.sibling,r!==null){r.return=e.return,Lt=r;break}Lt=e.return}}function hN(t){for(;Lt!==null;){var e=Lt;if(e===t){Lt=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Lt=r;break}Lt=e.return}}function gN(t){for(;Lt!==null;){var e=Lt;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{py(4,e)}catch(l){bn(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(l){bn(e,s,l)}}var a=e.return;try{wb(e)}catch(l){bn(e,a,l)}break;case 5:var i=e.return;try{wb(e)}catch(l){bn(e,i,l)}}}catch(l){bn(e,e.return,l)}if(e===t){Lt=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Lt=o;break}Lt=e.return}}var JU=Math.ceil,d1=vl.ReactCurrentDispatcher,Ok=vl.ReactCurrentOwner,mi=vl.ReactCurrentBatchConfig,vr=0,ms=null,zn=null,Cs=0,Fa=0,of=Cc(0),Zn=0,pg=null,Du=0,xy=0,Bk=0,R0=null,xa=null,Uk=0,Uf=1/0,Ko=null,f1=!1,Sb=null,ic=null,Wp=!1,Xl=null,h1=0,M0=0,kb=null,jx=-1,Fx=0;function aa(){return vr&6?Pn():jx!==-1?jx:jx=Pn()}function oc(t){return t.mode&1?vr&2&&Cs!==0?Cs&-Cs:DU.transition!==null?(Fx===0&&(Fx=iF()),Fx):(t=Lr,t!==0||(t=window.event,t=t===void 0?16:hF(t.type)),t):1}function Wi(t,e,r,n){if(50<M0)throw M0=0,kb=null,Error(ft(185));qg(t,r,n),(!(vr&2)||t!==ms)&&(t===ms&&(!(vr&2)&&(xy|=r),Zn===4&&Vl(t,Cs)),ka(t,n),r===1&&vr===0&&!(e.mode&1)&&(Uf=Pn()+500,hy&&Tc()))}function ka(t,e){var r=t.callbackNode;DB(t,e);var n=Jx(t,t===ms?Cs:0);if(n===0)r!==null&&S3(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&S3(r),e===1)t.tag===0?PU(mN.bind(null,t)):PF(mN.bind(null,t)),NU(function(){!(vr&6)&&Tc()}),r=null;else{switch(oF(n)){case 1:r=fk;break;case 4:r=sF;break;case 16:r=Yx;break;case 536870912:r=aF;break;default:r=Yx}r=jP(r,SP.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function SP(t,e){if(jx=-1,Fx=0,vr&6)throw Error(ft(327));var r=t.callbackNode;if(bf()&&t.callbackNode!==r)return null;var n=Jx(t,t===ms?Cs:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=g1(t,n);else{e=n;var s=vr;vr|=2;var a=CP();(ms!==t||Cs!==e)&&(Ko=null,Uf=Pn()+500,xu(t,e));do try{ZU();break}catch(o){kP(t,o)}while(!0);Ck(),d1.current=a,vr=s,zn!==null?e=0:(ms=null,Cs=0,e=Zn)}if(e!==0){if(e===2&&(s=Q2(t),s!==0&&(n=s,e=Cb(t,s))),e===1)throw r=pg,xu(t,0),Vl(t,n),ka(t,Pn()),r;if(e===6)Vl(t,n);else{if(s=t.current.alternate,!(n&30)&&!QU(s)&&(e=g1(t,n),e===2&&(a=Q2(t),a!==0&&(n=a,e=Cb(t,a))),e===1))throw r=pg,xu(t,0),Vl(t,n),ka(t,Pn()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(ft(345));case 2:nu(t,xa,Ko);break;case 3:if(Vl(t,n),(n&130023424)===n&&(e=Uk+500-Pn(),10<e)){if(Jx(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){aa(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=ab(nu.bind(null,t,xa,Ko),e);break}nu(t,xa,Ko);break;case 4:if(Vl(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var i=31-$i(n);a=1<<i,i=e[i],i>s&&(s=i),n&=~a}if(n=s,n=Pn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*JU(n/1960))-n,10<n){t.timeoutHandle=ab(nu.bind(null,t,xa,Ko),n);break}nu(t,xa,Ko);break;case 5:nu(t,xa,Ko);break;default:throw Error(ft(329))}}}return ka(t,Pn()),t.callbackNode===r?SP.bind(null,t):null}function Cb(t,e){var r=R0;return t.current.memoizedState.isDehydrated&&(xu(t,e).flags|=256),t=g1(t,e),t!==2&&(e=xa,xa=r,e!==null&&Tb(e)),t}function Tb(t){xa===null?xa=t:xa.push.apply(xa,t)}function QU(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!Ki(a(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Vl(t,e){for(e&=~Bk,e&=~xy,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-$i(e),n=1<<r;t[r]=-1,e&=~n}}function mN(t){if(vr&6)throw Error(ft(327));bf();var e=Jx(t,0);if(!(e&1))return ka(t,Pn()),null;var r=g1(t,e);if(t.tag!==0&&r===2){var n=Q2(t);n!==0&&(e=n,r=Cb(t,n))}if(r===1)throw r=pg,xu(t,0),Vl(t,e),ka(t,Pn()),r;if(r===6)throw Error(ft(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,nu(t,xa,Ko),ka(t,Pn()),null}function $k(t,e){var r=vr;vr|=1;try{return t(e)}finally{vr=r,vr===0&&(Uf=Pn()+500,hy&&Tc())}}function Ru(t){Xl!==null&&Xl.tag===0&&!(vr&6)&&bf();var e=vr;vr|=1;var r=mi.transition,n=Lr;try{if(mi.transition=null,Lr=1,t)return t()}finally{Lr=n,mi.transition=r,vr=e,!(vr&6)&&Tc()}}function Wk(){Fa=of.current,Yr(of)}function xu(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,EU(r)),zn!==null)for(r=zn.return;r!==null;){var n=r;switch(bk(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&t1();break;case 3:Of(),Yr(ba),Yr(Vs),Fk();break;case 5:jk(n);break;case 4:Of();break;case 13:Yr(un);break;case 19:Yr(un);break;case 10:Tk(n.type._context);break;case 22:case 23:Wk()}r=r.return}if(ms=t,zn=t=lc(t.current,null),Cs=Fa=e,Zn=0,pg=null,Bk=xy=Du=0,xa=R0=null,du!==null){for(e=0;e<du.length;e++)if(r=du[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}du=null}return t}function kP(t,e){do{var r=zn;try{if(Ck(),Ex.current=u1,c1){for(var n=gn.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}c1=!1}if(Pu=0,us=Yn=gn=null,P0=!1,hg=0,Ok.current=null,r===null||r.return===null){Zn=1,pg=e,zn=null;break}e:{var a=t,i=r.return,o=r,l=e;if(e=Cs,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=o,g=d.tag;if(!(d.mode&1)&&(g===0||g===11||g===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=rN(i);if(p!==null){p.flags&=-257,nN(p,i,o,a,e),p.mode&1&&tN(a,u,e),e=p,l=u;var x=e.updateQueue;if(x===null){var v=new Set;v.add(l),e.updateQueue=v}else x.add(l);break e}else{if(!(e&1)){tN(a,u,e),zk();break e}l=Error(ft(426))}}else if(rn&&o.mode&1){var w=rN(i);if(w!==null){!(w.flags&65536)&&(w.flags|=256),nN(w,i,o,a,e),Sk(Bf(l,o));break e}}a=l=Bf(l,o),Zn!==4&&(Zn=2),R0===null?R0=[a]:R0.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var S=oP(a,l,e);Y3(a,S);break e;case 1:o=l;var _=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof _.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ic===null||!ic.has(y)))){a.flags|=65536,e&=-e,a.lanes|=e;var k=lP(a,o,e);Y3(a,k);break e}}a=a.return}while(a!==null)}EP(r)}catch(N){e=N,zn===r&&r!==null&&(zn=r=r.return);continue}break}while(!0)}function CP(){var t=d1.current;return d1.current=u1,t===null?u1:t}function zk(){(Zn===0||Zn===3||Zn===2)&&(Zn=4),ms===null||!(Du&268435455)&&!(xy&268435455)||Vl(ms,Cs)}function g1(t,e){var r=vr;vr|=2;var n=CP();(ms!==t||Cs!==e)&&(Ko=null,xu(t,e));do try{qU();break}catch(s){kP(t,s)}while(!0);if(Ck(),vr=r,d1.current=n,zn!==null)throw Error(ft(261));return ms=null,Cs=0,Zn}function qU(){for(;zn!==null;)TP(zn)}function ZU(){for(;zn!==null&&!kB();)TP(zn)}function TP(t){var e=AP(t.alternate,t,Fa);t.memoizedProps=t.pendingProps,e===null?EP(t):zn=e,Ok.current=null}function EP(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=VU(r,e),r!==null){r.flags&=32767,zn=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Zn=6,zn=null;return}}else if(r=GU(r,e,Fa),r!==null){zn=r;return}if(e=e.sibling,e!==null){zn=e;return}zn=e=t}while(e!==null);Zn===0&&(Zn=5)}function nu(t,e,r){var n=Lr,s=mi.transition;try{mi.transition=null,Lr=1,e$(t,e,r,n)}finally{mi.transition=s,Lr=n}return null}function e$(t,e,r,n){do bf();while(Xl!==null);if(vr&6)throw Error(ft(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(ft(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(RB(t,a),t===ms&&(zn=ms=null,Cs=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Wp||(Wp=!0,jP(Yx,function(){return bf(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=mi.transition,mi.transition=null;var i=Lr;Lr=1;var o=vr;vr|=4,Ok.current=null,XU(t,r),_P(r,t),wU(nb),Qx=!!rb,nb=rb=null,t.current=r,YU(r),CB(),vr=o,Lr=i,mi.transition=a}else t.current=r;if(Wp&&(Wp=!1,Xl=t,h1=s),a=t.pendingLanes,a===0&&(ic=null),NB(r.stateNode),ka(t,Pn()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(f1)throw f1=!1,t=Sb,Sb=null,t;return h1&1&&t.tag!==0&&bf(),a=t.pendingLanes,a&1?t===kb?M0++:(M0=0,kb=t):M0=0,Tc(),null}function bf(){if(Xl!==null){var t=oF(h1),e=mi.transition,r=Lr;try{if(mi.transition=null,Lr=16>t?16:t,Xl===null)var n=!1;else{if(t=Xl,Xl=null,h1=0,vr&6)throw Error(ft(331));var s=vr;for(vr|=4,Lt=t.current;Lt!==null;){var a=Lt,i=a.child;if(Lt.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(Lt=u;Lt!==null;){var d=Lt;switch(d.tag){case 0:case 11:case 15:D0(8,d,a)}var g=d.child;if(g!==null)g.return=d,Lt=g;else for(;Lt!==null;){d=Lt;var h=d.sibling,p=d.return;if(yP(d),d===u){Lt=null;break}if(h!==null){h.return=p,Lt=h;break}Lt=p}}}var x=a.alternate;if(x!==null){var v=x.child;if(v!==null){x.child=null;do{var w=v.sibling;v.sibling=null,v=w}while(v!==null)}}Lt=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Lt=i;else e:for(;Lt!==null;){if(a=Lt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:D0(9,a,a.return)}var S=a.sibling;if(S!==null){S.return=a.return,Lt=S;break e}Lt=a.return}}var _=t.current;for(Lt=_;Lt!==null;){i=Lt;var y=i.child;if(i.subtreeFlags&2064&&y!==null)y.return=i,Lt=y;else e:for(i=_;Lt!==null;){if(o=Lt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:py(9,o)}}catch(N){bn(o,o.return,N)}if(o===i){Lt=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,Lt=k;break e}Lt=o.return}}if(vr=s,Tc(),_o&&typeof _o.onPostCommitFiberRoot=="function")try{_o.onPostCommitFiberRoot(ly,t)}catch{}n=!0}return n}finally{Lr=r,mi.transition=e}}return!1}function pN(t,e,r){e=Bf(r,e),e=oP(t,e,1),t=ac(t,e,1),e=aa(),t!==null&&(qg(t,1,e),ka(t,e))}function bn(t,e,r){if(t.tag===3)pN(t,t,r);else for(;e!==null;){if(e.tag===3){pN(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ic===null||!ic.has(n))){t=Bf(r,t),t=lP(e,t,1),e=ac(e,t,1),t=aa(),e!==null&&(qg(e,1,t),ka(e,t));break}}e=e.return}}function t$(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=aa(),t.pingedLanes|=t.suspendedLanes&r,ms===t&&(Cs&r)===r&&(Zn===4||Zn===3&&(Cs&130023424)===Cs&&500>Pn()-Uk?xu(t,0):Bk|=r),ka(t,e)}function NP(t,e){e===0&&(t.mode&1?(e=Pp,Pp<<=1,!(Pp&130023424)&&(Pp=4194304)):e=1);var r=aa();t=fl(t,e),t!==null&&(qg(t,e,r),ka(t,r))}function r$(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),NP(t,r)}function n$(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(ft(314))}n!==null&&n.delete(e),NP(t,r)}var AP;AP=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||ba.current)wa=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return wa=!1,HU(t,e,r);wa=!!(t.flags&131072)}else wa=!1,rn&&e.flags&1048576&&DF(e,s1,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Ax(t,e),t=e.pendingProps;var s=Mf(e,Vs.current);_f(e,r),s=Dk(null,e,n,t,s,r);var a=Rk();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Sa(n)?(a=!0,r1(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Nk(e),s.updater=my,e.stateNode=s,s._reactInternals=e,fb(e,n,t,r),e=mb(null,e,n,!0,a,r)):(e.tag=0,rn&&a&&_k(e),Zs(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Ax(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=a$(n),t=Mi(n,t),s){case 0:e=gb(null,e,n,t,r);break e;case 1:e=iN(null,e,n,t,r);break e;case 11:e=sN(null,e,n,t,r);break e;case 14:e=aN(null,e,n,Mi(n.type,t),r);break e}throw Error(ft(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Mi(n,s),gb(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Mi(n,s),iN(t,e,n,s,r);case 3:e:{if(fP(e),t===null)throw Error(ft(387));n=e.pendingProps,a=e.memoizedState,s=a.element,BF(t,e),o1(e,n,null,r);var i=e.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=Bf(Error(ft(423)),e),e=oN(t,e,n,r,s);break e}else if(n!==s){s=Bf(Error(ft(424)),e),e=oN(t,e,n,r,s);break e}else for(Ia=sc(e.stateNode.containerInfo.firstChild),Oa=e,rn=!0,Oi=null,r=IF(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Lf(),n===s){e=hl(t,e,r);break e}Zs(t,e,n,r)}e=e.child}return e;case 5:return UF(e),t===null&&cb(e),n=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,i=s.children,sb(n,s)?i=null:a!==null&&sb(n,a)&&(e.flags|=32),dP(t,e),Zs(t,e,i,r),e.child;case 6:return t===null&&cb(e),null;case 13:return hP(t,e,r);case 4:return Ak(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=If(e,null,n,r):Zs(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Mi(n,s),sN(t,e,n,s,r);case 7:return Zs(t,e,e.pendingProps,r),e.child;case 8:return Zs(t,e,e.pendingProps.children,r),e.child;case 12:return Zs(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,a=e.memoizedProps,i=s.value,Hr(a1,n._currentValue),n._currentValue=i,a!==null)if(Ki(a.value,i)){if(a.children===s.children&&!ba.current){e=hl(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=sl(-1,r&-r),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),ub(a.return,r,e),o.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===e.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(ft(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),ub(i,r,e),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===e){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Zs(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,_f(e,r),s=yi(s),n=n(s),e.flags|=1,Zs(t,e,n,r),e.child;case 14:return n=e.type,s=Mi(n,e.pendingProps),s=Mi(n.type,s),aN(t,e,n,s,r);case 15:return cP(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Mi(n,s),Ax(t,e),e.tag=1,Sa(n)?(t=!0,r1(e)):t=!1,_f(e,r),iP(e,n,s),fb(e,n,s,r),mb(null,e,n,!0,t,r);case 19:return gP(t,e,r);case 22:return uP(t,e,r)}throw Error(ft(156,e.tag))};function jP(t,e){return nF(t,e)}function s$(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(t,e,r,n){return new s$(t,e,r,n)}function Hk(t){return t=t.prototype,!(!t||!t.isReactComponent)}function a$(t){if(typeof t=="function")return Hk(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ck)return 11;if(t===uk)return 14}return 2}function lc(t,e){var r=t.alternate;return r===null?(r=fi(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Px(t,e,r,n,s,a){var i=2;if(n=t,typeof t=="function")Hk(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Jd:return yu(r.children,s,a,e);case lk:i=8,s|=8;break;case L2:return t=fi(12,r,e,s|2),t.elementType=L2,t.lanes=a,t;case I2:return t=fi(13,r,e,s),t.elementType=I2,t.lanes=a,t;case O2:return t=fi(19,r,e,s),t.elementType=O2,t.lanes=a,t;case Uj:return yy(r,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Oj:i=10;break e;case Bj:i=9;break e;case ck:i=11;break e;case uk:i=14;break e;case zl:i=16,n=null;break e}throw Error(ft(130,t==null?t:typeof t,""))}return e=fi(i,r,e,s),e.elementType=t,e.type=n,e.lanes=a,e}function yu(t,e,r,n){return t=fi(7,t,n,e),t.lanes=r,t}function yy(t,e,r,n){return t=fi(22,t,n,e),t.elementType=Uj,t.lanes=r,t.stateNode={isHidden:!1},t}function C_(t,e,r){return t=fi(6,t,null,e),t.lanes=r,t}function T_(t,e,r){return e=fi(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function i$(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=i_(0),this.expirationTimes=i_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=i_(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Gk(t,e,r,n,s,a,i,o,l){return t=new i$(t,e,r,o,l),e===1?(e=1,a===!0&&(e|=8)):e=0,a=fi(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nk(a),t}function o$(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Yd,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function FP(t){if(!t)return gc;t=t._reactInternals;e:{if(rd(t)!==t||t.tag!==1)throw Error(ft(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Sa(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ft(171))}if(t.tag===1){var r=t.type;if(Sa(r))return FF(t,r,e)}return e}function PP(t,e,r,n,s,a,i,o,l){return t=Gk(r,n,!0,t,s,a,i,o,l),t.context=FP(null),r=t.current,n=aa(),s=oc(r),a=sl(n,s),a.callback=e??null,ac(r,a,s),t.current.lanes=s,qg(t,s,n),ka(t,n),t}function vy(t,e,r,n){var s=e.current,a=aa(),i=oc(s);return r=FP(r),e.context===null?e.context=r:e.pendingContext=r,e=sl(a,i),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=ac(s,e,i),t!==null&&(Wi(t,s,i,a),Tx(t,s,i)),i}function m1(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function xN(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Vk(t,e){xN(t,e),(t=t.alternate)&&xN(t,e)}function l$(){return null}var DP=typeof reportError=="function"?reportError:function(t){console.error(t)};function Kk(t){this._internalRoot=t}wy.prototype.render=Kk.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ft(409));vy(t,e,null,null)};wy.prototype.unmount=Kk.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ru(function(){vy(null,t,null,null)}),e[dl]=null}};function wy(t){this._internalRoot=t}wy.prototype.unstable_scheduleHydration=function(t){if(t){var e=uF();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Gl.length&&e!==0&&e<Gl[r].priority;r++);Gl.splice(r,0,t),r===0&&fF(t)}};function Xk(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function _y(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function yN(){}function c$(t,e,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=m1(i);a.call(u)}}var i=PP(e,n,t,0,null,!1,!1,"",yN);return t._reactRootContainer=i,t[dl]=i.current,lg(t.nodeType===8?t.parentNode:t),Ru(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var u=m1(l);o.call(u)}}var l=Gk(t,0,!1,null,null,!1,!1,"",yN);return t._reactRootContainer=l,t[dl]=l.current,lg(t.nodeType===8?t.parentNode:t),Ru(function(){vy(e,l,r,n)}),l}function by(t,e,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=m1(i);o.call(l)}}vy(e,i,t,s)}else i=c$(r,e,t,s,n);return m1(i)}lF=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=y0(e.pendingLanes);r!==0&&(hk(e,r|1),ka(e,Pn()),!(vr&6)&&(Uf=Pn()+500,Tc()))}break;case 13:Ru(function(){var n=fl(t,1);if(n!==null){var s=aa();Wi(n,t,1,s)}}),Vk(t,1)}};gk=function(t){if(t.tag===13){var e=fl(t,134217728);if(e!==null){var r=aa();Wi(e,t,134217728,r)}Vk(t,134217728)}};cF=function(t){if(t.tag===13){var e=oc(t),r=fl(t,e);if(r!==null){var n=aa();Wi(r,t,e,n)}Vk(t,e)}};uF=function(){return Lr};dF=function(t,e){var r=Lr;try{return Lr=t,e()}finally{Lr=r}};X2=function(t,e,r){switch(e){case"input":if($2(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=fy(n);if(!s)throw Error(ft(90));Wj(n),$2(n,s)}}}break;case"textarea":Hj(t,r);break;case"select":e=r.value,e!=null&&xf(t,!!r.multiple,e,!1)}};Qj=$k;qj=Ru;var u$={usingClientEntryPoint:!1,Events:[em,ef,fy,Yj,Jj,$k]},s0={findFiberByHostInstance:uu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},d$={bundleType:s0.bundleType,version:s0.version,rendererPackageName:s0.rendererPackageName,rendererConfig:s0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=tF(t),t===null?null:t.stateNode},findFiberByHostInstance:s0.findFiberByHostInstance||l$,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zp.isDisabled&&zp.supportsFiber)try{ly=zp.inject(d$),_o=zp}catch{}}Wa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=u$;Wa.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xk(e))throw Error(ft(200));return o$(t,e,null,r)};Wa.createRoot=function(t,e){if(!Xk(t))throw Error(ft(299));var r=!1,n="",s=DP;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Gk(t,1,!1,null,null,r,!1,n,s),t[dl]=e.current,lg(t.nodeType===8?t.parentNode:t),new Kk(e)};Wa.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ft(188)):(t=Object.keys(t).join(","),Error(ft(268,t)));return t=tF(e),t=t===null?null:t.stateNode,t};Wa.flushSync=function(t){return Ru(t)};Wa.hydrate=function(t,e,r){if(!_y(e))throw Error(ft(200));return by(null,t,e,!0,r)};Wa.hydrateRoot=function(t,e,r){if(!Xk(t))throw Error(ft(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=DP;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),e=PP(e,null,t,1,r??null,s,!1,a,i),t[dl]=e.current,lg(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new wy(e)};Wa.render=function(t,e,r){if(!_y(e))throw Error(ft(200));return by(null,t,e,!1,r)};Wa.unmountComponentAtNode=function(t){if(!_y(t))throw Error(ft(40));return t._reactRootContainer?(Ru(function(){by(null,null,t,!1,function(){t._reactRootContainer=null,t[dl]=null})}),!0):!1};Wa.unstable_batchedUpdates=$k;Wa.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!_y(r))throw Error(ft(200));if(t==null||t._reactInternals===void 0)throw Error(ft(38));return by(t,e,r,!1,n)};Wa.version="18.3.1-next-f1338f8080-20240426";function RP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(RP)}catch(t){console.error(t)}}RP(),Rj.exports=Wa;var Eb=Rj.exports,vN=Eb;R2.createRoot=vN.createRoot,R2.hydrateRoot=vN.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xg(){return xg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},xg.apply(this,arguments)}var Yl;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Yl||(Yl={}));const wN="popstate";function f$(t){t===void 0&&(t={});function e(n,s){let{pathname:a,search:i,hash:o}=n.location;return Nb("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:LP(s)}return g$(e,r,null,t)}function Gn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function MP(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function h$(){return Math.random().toString(36).substr(2,8)}function _N(t,e){return{usr:t.state,key:t.key,idx:e}}function Nb(t,e,r,n){return r===void 0&&(r=null),xg({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ih(e):e,{state:r,key:e&&e.key||n||h$()})}function LP(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ih(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function g$(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=Yl.Pop,l=null,u=d();u==null&&(u=0,i.replaceState(xg({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function g(){o=Yl.Pop;let w=d(),S=w==null?null:w-u;u=w,l&&l({action:o,location:v.location,delta:S})}function h(w,S){o=Yl.Push;let _=Nb(v.location,w,S);u=d()+1;let y=_N(_,u),k=v.createHref(_);try{i.pushState(y,"",k)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;s.location.assign(k)}a&&l&&l({action:o,location:v.location,delta:1})}function p(w,S){o=Yl.Replace;let _=Nb(v.location,w,S);u=d();let y=_N(_,u),k=v.createHref(_);i.replaceState(y,"",k),a&&l&&l({action:o,location:v.location,delta:0})}function x(w){let S=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof w=="string"?w:LP(w);return _=_.replace(/ $/,"%20"),Gn(S,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,S)}let v={get action(){return o},get location(){return t(s,i)},listen(w){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(wN,g),l=w,()=>{s.removeEventListener(wN,g),l=null}},createHref(w){return e(s,w)},createURL:x,encodeLocation(w){let S=x(w);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:h,replace:p,go(w){return i.go(w)}};return v}var bN;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(bN||(bN={}));function m$(t,e,r){return r===void 0&&(r="/"),p$(t,e,r)}function p$(t,e,r,n){let s=typeof e=="string"?ih(e):e,a=BP(s.pathname||"/",r);if(a==null)return null;let i=IP(t);x$(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let u=A$(a);o=T$(i[l],u)}return o}function IP(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(Gn(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=vu([n,l.relativePath]),d=r.concat(l);a.children&&a.children.length>0&&(Gn(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),IP(a.children,e,d,u)),!(a.path==null&&!a.index)&&e.push({path:u,score:k$(u,a.index),routesMeta:d})};return t.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let l of OP(a.path))s(a,i,l)}),e}function OP(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=OP(n.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),s&&o.push(...i),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function x$(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:C$(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const y$=/^:[\w-]+$/,v$=3,w$=2,_$=1,b$=10,S$=-2,SN=t=>t==="*";function k$(t,e){let r=t.split("/"),n=r.length;return r.some(SN)&&(n+=S$),e&&(n+=w$),r.filter(s=>!SN(s)).reduce((s,a)=>s+(y$.test(a)?v$:a===""?_$:b$),n)}function C$(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function T$(t,e,r){let{routesMeta:n}=t,s={},a="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,d=a==="/"?e:e.slice(a.length)||"/",g=E$({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),h=l.route;if(!g)return null;Object.assign(s,g.params),i.push({params:s,pathname:vu([a,g.pathname]),pathnameBase:D$(vu([a,g.pathnameBase])),route:h}),g.pathnameBase!=="/"&&(a=vu([a,g.pathnameBase]))}return i}function E$(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=N$(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,d,g)=>{let{paramName:h,isOptional:p}=d;if(h==="*"){let v=o[g]||"";i=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const x=o[g];return p&&!x?u[h]=void 0:u[h]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:t}}function N$(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),MP(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function A$(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return MP(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function BP(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function j$(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?ih(t):t;return{pathname:r?r.startsWith("/")?r:F$(r,e):e,search:R$(n),hash:M$(s)}}function F$(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function E_(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function P$(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function UP(t,e){let r=P$(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function $P(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=ih(t):(s=xg({},t),Gn(!s.pathname||!s.pathname.includes("?"),E_("?","pathname","search",s)),Gn(!s.pathname||!s.pathname.includes("#"),E_("#","pathname","hash",s)),Gn(!s.search||!s.search.includes("#"),E_("#","search","hash",s)));let a=t===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let g=e.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),g-=1;s.pathname=h.join("/")}o=g>=0?e[g]:"/"}let l=j$(s,o),u=i&&i!=="/"&&i.endsWith("/"),d=(a||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const vu=t=>t.join("/").replace(/\/\/+/g,"/"),D$=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),R$=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,M$=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function L$(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const WP=["post","put","patch","delete"];new Set(WP);const I$=["get",...WP];new Set(I$);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yg(){return yg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},yg.apply(this,arguments)}const Yk=b.createContext(null),O$=b.createContext(null),rm=b.createContext(null),Sy=b.createContext(null),Ec=b.createContext({outlet:null,matches:[],isDataRoute:!1}),zP=b.createContext(null);function nm(){return b.useContext(Sy)!=null}function ky(){return nm()||Gn(!1),b.useContext(Sy).location}function HP(t){b.useContext(rm).static||b.useLayoutEffect(t)}function Ha(){let{isDataRoute:t}=b.useContext(Ec);return t?Q$():B$()}function B$(){nm()||Gn(!1);let t=b.useContext(Yk),{basename:e,future:r,navigator:n}=b.useContext(rm),{matches:s}=b.useContext(Ec),{pathname:a}=ky(),i=JSON.stringify(UP(s,r.v7_relativeSplatPath)),o=b.useRef(!1);return HP(()=>{o.current=!0}),b.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let g=$P(u,JSON.parse(i),a,d.relative==="path");t==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:vu([e,g.pathname])),(d.replace?n.replace:n.push)(g,d.state,d)},[e,n,i,a,t])}function Jk(){let{matches:t}=b.useContext(Ec),e=t[t.length-1];return e?e.params:{}}function U$(t,e){return $$(t,e)}function $$(t,e,r,n){nm()||Gn(!1);let{navigator:s}=b.useContext(rm),{matches:a}=b.useContext(Ec),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let u=ky(),d;if(e){var g;let w=typeof e=="string"?ih(e):e;l==="/"||(g=w.pathname)!=null&&g.startsWith(l)||Gn(!1),d=w}else d=u;let h=d.pathname||"/",p=h;if(l!=="/"){let w=l.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(w.length).join("/")}let x=m$(t,{pathname:p}),v=V$(x&&x.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:vu([l,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?l:vu([l,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),a,r,n);return e&&v?b.createElement(Sy.Provider,{value:{location:yg({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Yl.Pop}},v):v}function W$(){let t=J$(),e=L$(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),r?b.createElement("pre",{style:s},r):null,null)}const z$=b.createElement(W$,null);class H$ extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?b.createElement(Ec.Provider,{value:this.props.routeContext},b.createElement(zP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function G$(t){let{routeContext:e,match:r,children:n}=t,s=b.useContext(Yk);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),b.createElement(Ec.Provider,{value:e},n)}function V$(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=i.findIndex(g=>g.route.id&&(o==null?void 0:o[g.route.id])!==void 0);d>=0||Gn(!1),i=i.slice(0,Math.min(i.length,d+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<i.length;d++){let g=i[d];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(u=d),g.route.id){let{loaderData:h,errors:p}=r,x=g.route.loader&&h[g.route.id]===void 0&&(!p||p[g.route.id]===void 0);if(g.route.lazy||x){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,g,h)=>{let p,x=!1,v=null,w=null;r&&(p=o&&g.route.id?o[g.route.id]:void 0,v=g.route.errorElement||z$,l&&(u<0&&h===0?(q$("route-fallback"),x=!0,w=null):u===h&&(x=!0,w=g.route.hydrateFallbackElement||null)));let S=e.concat(i.slice(0,h+1)),_=()=>{let y;return p?y=v:x?y=w:g.route.Component?y=b.createElement(g.route.Component,null):g.route.element?y=g.route.element:y=d,b.createElement(G$,{match:g,routeContext:{outlet:d,matches:S,isDataRoute:r!=null},children:y})};return r&&(g.route.ErrorBoundary||g.route.errorElement||h===0)?b.createElement(H$,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:_(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):_()},null)}var GP=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(GP||{}),VP=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(VP||{});function K$(t){let e=b.useContext(Yk);return e||Gn(!1),e}function X$(t){let e=b.useContext(O$);return e||Gn(!1),e}function Y$(t){let e=b.useContext(Ec);return e||Gn(!1),e}function KP(t){let e=Y$(),r=e.matches[e.matches.length-1];return r.route.id||Gn(!1),r.route.id}function J$(){var t;let e=b.useContext(zP),r=X$(),n=KP();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function Q$(){let{router:t}=K$(GP.UseNavigateStable),e=KP(VP.UseNavigateStable),r=b.useRef(!1);return HP(()=>{r.current=!0}),b.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,yg({fromRouteId:e},a)))},[t,e])}const kN={};function q$(t,e,r){kN[t]||(kN[t]=!0)}function Z$(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function $f(t){let{to:e,replace:r,state:n,relative:s}=t;nm()||Gn(!1);let{future:a,static:i}=b.useContext(rm),{matches:o}=b.useContext(Ec),{pathname:l}=ky(),u=Ha(),d=$P(e,UP(o,a.v7_relativeSplatPath),l,s==="path"),g=JSON.stringify(d);return b.useEffect(()=>u(JSON.parse(g),{replace:r,state:n,relative:s}),[u,g,s,r,n]),null}function Fn(t){Gn(!1)}function eW(t){let{basename:e="/",children:r=null,location:n,navigationType:s=Yl.Pop,navigator:a,static:i=!1,future:o}=t;nm()&&Gn(!1);let l=e.replace(/^\/*/,"/"),u=b.useMemo(()=>({basename:l,navigator:a,static:i,future:yg({v7_relativeSplatPath:!1},o)}),[l,o,a,i]);typeof n=="string"&&(n=ih(n));let{pathname:d="/",search:g="",hash:h="",state:p=null,key:x="default"}=n,v=b.useMemo(()=>{let w=BP(d,l);return w==null?null:{location:{pathname:w,search:g,hash:h,state:p,key:x},navigationType:s}},[l,d,g,h,p,x,s]);return v==null?null:b.createElement(rm.Provider,{value:u},b.createElement(Sy.Provider,{children:r,value:v}))}function Qk(t){let{children:e,location:r}=t;return U$(Ab(e),r)}new Promise(()=>{});function Ab(t,e){e===void 0&&(e=[]);let r=[];return b.Children.forEach(t,(n,s)=>{if(!b.isValidElement(n))return;let a=[...e,s];if(n.type===b.Fragment){r.push.apply(r,Ab(n.props.children,a));return}n.type!==Fn&&Gn(!1),!n.props.index||!n.props.children||Gn(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Ab(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const tW="6";try{window.__reactRouterVersion=tW}catch{}const rW="startTransition",CN=rB[rW];function nW(t){let{basename:e,children:r,future:n,window:s}=t,a=b.useRef();a.current==null&&(a.current=f$({window:s,v5Compat:!0}));let i=a.current,[o,l]=b.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},d=b.useCallback(g=>{u&&CN?CN(()=>l(g)):l(g)},[l,u]);return b.useLayoutEffect(()=>i.listen(d),[i,d]),b.useEffect(()=>Z$(n),[n]),b.createElement(eW,{basename:e,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}var TN;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(TN||(TN={}));var EN;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(EN||(EN={}));const Xr={student_subjects:30*60*1e3,student_active_tests:10*60*1e3,student_results_table:10*60*1e3,teacher_subjects:15*60*1e3,teacher_classes:15*60*1e3,teacher_tests:10*60*1e3,teacher_results_table:10*60*1e3,admin_users:20*60*1e3,admin_teachers:20*60*1e3,admin_subjects:30*60*1e3,admin_academic_years:60*60*1e3,admin_tests:15*60*1e3,admin_results_table:null,admin_teacher_id:60*60*1e3,all_tests:20*60*1e3,subjects_dropdown:30*60*1e3,grades_classes:60*60*1e3,test_progress:2*60*1e3,anti_cheating:2*60*1e3,word_matching_test:10*60*1e3},nn=t=>{try{const e=localStorage.getItem(t);if(!e)return console.log(" Cache: No data found for key:",t),null;const{data:r,timestamp:n,ttl:s}=JSON.parse(e),a=Date.now()-n;return a>s?(console.log(" Cache: Data expired for key:",t,"age:",a,"ttl:",s),localStorage.removeItem(t),null):(console.log(" Cache: Data found for key:",t,"age:",a,"ttl:",s),r)}catch(e){return console.log(" Cache: Corrupted data for key:",t,e),localStorage.removeItem(t),null}},zr=(t,e,r)=>{try{console.log(" Cache: Setting data for key:",t,"ttl:",r),localStorage.setItem(t,JSON.stringify({data:e,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached successfully for key:",t)}catch{console.log(" Cache: Storage full, cleaning old data for key:",t),XP();try{localStorage.setItem(t,JSON.stringify({data:e,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached after cleanup for key:",t)}catch{console.warn("Storage full, cannot cache data")}}},XP=()=>{const t=Date.now(),e=Object.keys(localStorage);e.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i,ttl:o}=JSON.parse(a);t-i>o&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const r=t-7*24*60*60*1e3;e.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i}=JSON.parse(a);i<r&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const n=Object.keys(localStorage);if(n.length>0){const s=n.map(i=>{try{const o=localStorage.getItem(i);if(o){const{timestamp:l}=JSON.parse(o);return{key:i,timestamp:l}}}catch{return{key:i,timestamp:0}}return{key:i,timestamp:0}}),a=Math.ceil(s.length*.25);s.sort((i,o)=>i.timestamp-o.timestamp).slice(0,a).forEach(({key:i})=>localStorage.removeItem(i))}},qk=t=>{Object.keys(localStorage).forEach(r=>{r.includes(t)&&localStorage.removeItem(r)})},oh=(t,e,r)=>{const n=`test_progress_${t}_${e}_${r}`,s=`anti_cheating_${t}_${e}_${r}`;localStorage.removeItem(n),localStorage.removeItem(s),console.log(`Cleared test data for ${e}_${r}`)},YP=Object.freeze(Object.defineProperty({__proto__:null,CACHE_TTL:Xr,cleanupOldData:XP,clearTestData:oh,clearUserData:qk,getCachedData:nn,setCachedData:zr},Symbol.toStringTag,{value:"Module"})),JP=b.createContext(),QP=({children:t})=>{const[e,r]=b.useState(null),[n,s]=b.useState(null),[a,i]=b.useState(localStorage.getItem("token")),[o,l]=b.useState(!1),[u,d]=b.useState(!0),[g,h]=b.useState(null);b.useEffect(()=>{console.log("[AUTH] Initializing application session..."),w()},[]),b.useEffect(()=>{if(o&&a){console.log("[AUTH] Setting up proactive token refresh...");let de=!1;const G=setInterval(async()=>{if(o&&a&&!de){de=!0;try{const K=a||localStorage.getItem("auth_token");if(K&&p(K))console.log("[AUTH] Token expired, attempting refresh..."),await x()||console.log("[AUTH] Proactive refresh failed, but user remains logged in");else if(K)try{const q=JSON.parse(atob(K.split(".")[1])).exp*1e3,se=Date.now(),W=q-se;W<5*60*1e3&&W>0&&(console.log(`[AUTH] Token expires in ${Math.round(W/1e3)} seconds, refreshing...`),await x()||console.log("[AUTH] Proactive refresh failed, but user remains logged in"))}catch(Q){console.error("[AUTH] Error parsing token for expiration check:",Q)}}catch(K){console.error("[AUTH] Error in proactive refresh:",K)}finally{de=!1}}},5*60*1e3);return()=>{console.log("[AUTH] Clearing proactive token refresh interval"),clearInterval(G)}}},[o,a]);const p=de=>{if(!de)return!0;try{const G=JSON.parse(atob(de.split(".")[1])),K=Date.now()/1e3;return G.exp<=K}catch(G){return console.error("[AUTH] Error decoding token:",G),!0}},x=async()=>{const de=localStorage.getItem("refresh_token");if(!de)return console.log("[AUTH] No refresh token found"),!1;try{const G=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:de})});if(G.ok){const K=await G.json();console.log("[AUTH] Token refresh successful"),localStorage.setItem("auth_token",K.accessToken),localStorage.setItem("refresh_token",K.refreshToken),localStorage.setItem("accessToken",K.accessToken);try{window.tokenManager&&(window.tokenManager.setToken(K.accessToken),K.refreshToken&&window.tokenManager.setRefreshToken(K.refreshToken))}catch{}return i(K.accessToken),!0}else return console.error("[AUTH] Token refresh failed:",G.status),!1}catch(G){return console.error("[AUTH] Token refresh error:",G),!1}},v=async(de,G={})=>{const K=a||localStorage.getItem("auth_token");if(!K)throw new Error("No authentication token found");const Q={"Content-Type":"application/json",Authorization:`Bearer ${K}`,...G.headers},q=await fetch(de,{...G,headers:Q});if(q.status===401)if(console.log("[AUTH] 401 error, attempting token refresh..."),await x()){const W=localStorage.getItem("auth_token");return Q.Authorization=`Bearer ${W}`,fetch(de,{...G,headers:Q})}else throw console.log("[AUTH] Token refresh failed, returning 401 response"),new Error("Authentication failed - please login again");return q},w=async()=>{try{console.log("[AUTH] Starting session initialization..."),d(!0);const de=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token"),G=localStorage.getItem("user_data")||localStorage.getItem("userData"),K=G?JSON.parse(G).role:null;if(console.log("[AUTH] Found stored data:",{hasToken:!!de,hasUser:!!G,role:K}),de&&K&&G)try{const Q=JSON.parse(G);if(p(de))if(console.log("[AUTH] Token expired, attempting refresh..."),await x()){console.log("[AUTH] Token refreshed successfully");const se=localStorage.getItem("auth_token");i(se)}else console.log("[AUTH] Token refresh failed, but continuing with existing token..."),i(de);else i(de);s(K),r(Q);try{if(window.tokenManager){window.tokenManager.setToken(localStorage.getItem("auth_token"));const q=localStorage.getItem("refresh_token");q&&window.tokenManager.setRefreshToken(q)}}catch{}l(!0),await y(Q,K)}catch(Q){console.error("[AUTH] Error parsing stored user data:",Q),console.log("[AUTH] Invalid user data, but not forcing logout - continuing with empty state"),l(!1)}}catch(de){console.error("[AUTH] Session initialization error:",de),console.log("[AUTH] Initialization error, but not forcing logout - continuing with empty state"),l(!1)}finally{console.log("[AUTH] Session initialization complete"),d(!1)}},S=async de=>{try{if(d(!0),h(null),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),h("Please wait for the logout process to complete.");return}console.log("Attempting login with:",de.username);let G,K;de.username==="admin"?(G={ok:!0,json:()=>({success:!0,token:"test-token"})},K="admin"):(G=await authService.teacherLogin(de),K="teacher");const Q=await G.json();await _(G,K,Q)}catch(G){C(G)}finally{d(!1)}},_=async(de,G,K)=>{try{if(de.ok&&K.success&&K.token){i(K.token),s(G),r(K),l(!0),localStorage.setItem("auth_token",K.accessToken||K.token),localStorage.setItem("refresh_token",K.refreshToken),localStorage.setItem("user_data",JSON.stringify(K)),localStorage.setItem("accessToken",K.accessToken||K.token);try{const Q=Date.now(),q=7*24*60*60*1e3,se=[];for(let W=0;W<localStorage.length;W++){const ee=localStorage.key(W);if(!(!ee||!(ee.startsWith("test_progress_")||ee.startsWith("test_timer_")||ee.startsWith("test_shuffle_order_")||ee.startsWith("student_results_table_")||ee.startsWith("anti_cheating_"))))try{const _e=localStorage.getItem(ee);if(!_e){se.push(ee);continue}let Le=null;if(_e.startsWith("{")||_e.startsWith("[")){const te=JSON.parse(_e),Ne=te.timestamp||te.lastSaved||te.lastTickAt||te.createdAt||te.updatedAt||te.startedAt||te.started_at;Ne&&(Le=new Date(Ne).getTime())}if(!Le){const te=`${ee}__ts`,Ne=localStorage.getItem(te);Ne&&(Le=parseInt(Ne)||null)}if(!Le)continue;Q-Le>q&&se.push(ee)}catch{}}se.forEach(W=>{try{localStorage.removeItem(W)}catch{}})}catch(Q){console.warn("LocalStorage cleanup skipped:",Q)}return await y(K,G),!0}else{const Q=K.message||de.statusText||"Login failed";return C(new Error(Q)),!1}}catch(Q){return C(Q),!1}},y=async(de,G)=>{try{switch(G){case"admin":console.log("Admin login successful, role:",de.role),console.log("Admin logged in:",de);break;case"teacher":console.log("Teacher login successful, role:",de.role),console.log("Teacher data:",de.teacher),await N(de),await A();break;case"student":console.log("Student login successful"),k(de);break;default:console.warn("Unknown user role:",G)}}catch(K){console.error("Post-login actions error:",K)}},k=de=>{r(de),console.log("Student info populated:",de)},N=async de=>{r(de),console.log("Teacher info populated:",de)},E=async()=>{try{console.log("Initializing teacher cabinet...")}catch(de){console.error("Error initializing teacher cabinet:",de)}},A=async()=>{try{console.log("Checking teacher subjects...")}catch(de){console.error("Error checking teacher subjects:",de)}},C=de=>{h(de.message||"Login failed"),F()},F=()=>{h(null),d(!1)},D=b.useCallback(()=>{R()},[]),R=()=>{r(null),s(null),i(null),l(!1),h(null);const de=(e==null?void 0:e.student_id)||(e==null?void 0:e.teacher_id)||(e==null?void 0:e.admin_id)||(e==null?void 0:e.id);de&&qk(de),localStorage.removeItem("token"),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),localStorage.removeItem("auth_token"),localStorage.removeItem("user_data"),localStorage.removeItem("user_role"),localStorage.removeItem("accessToken"),localStorage.removeItem("testProgress"),localStorage.removeItem("formData"),window.tokenManager&&window.tokenManager.clearAuth(),setTimeout(()=>{M()},100)},M=()=>{console.log("Interface reset after session clear - redirecting to login"),window.location.replace("/login")},B=()=>(e==null?void 0:e.id)||null,J=()=>n==="admin"?e:null,X=()=>n==="admin",z=()=>X()?e==null?void 0:e.admin_id:null,H=()=>n==="teacher"?e==null?void 0:e.username:null,U=()=>{console.log("Auth functions available:",{handleUnifiedLogin:typeof S,logout:typeof D,getCurrentTeacherId:typeof B,isAdmin:typeof X,getCurrentAdmin:typeof J,getCurrentAdminId:typeof z,getCurrentTeacherUsername:typeof H})};b.useEffect(()=>(window.logout=D,window.getCurrentTeacherId=B,window.getCurrentAdmin=J,window.isAdmin=X,window.getCurrentAdminId=z,window.getCurrentTeacherUsername=H,window.checkFunctionAvailability=U,()=>{delete window.logout,delete window.getCurrentTeacherId,delete window.getCurrentAdmin,delete window.isAdmin,delete window.getCurrentAdminId,delete window.getCurrentTeacherUsername,delete window.checkFunctionAvailability}),[D]);const L=b.useCallback(de=>{console.log("Setting user data from external auth:",de),r(de),s(de.role),i(de.token),l(!0),d(!1),h(null),localStorage.setItem("auth_token",de.token),localStorage.setItem("user_data",JSON.stringify(de)),localStorage.setItem("accessToken",de.token)},[]),ne={user:e,role:n,token:a,isAuthenticated:o,isLoading:u,error:g,login:S,setUserData:L,logout:D,resetLoginForm:F,forceCompleteLogout:R,initializeApplicationSession:w,makeAuthenticatedRequest:v,populateStudentInfo:k,populateTeacherInfo:N,initializeTeacherCabinet:E,checkTeacherSubjects:A,getCurrentTeacherId:B,getCurrentAdmin:J,isAdmin:X,getCurrentAdminId:z,getCurrentTeacherUsername:H,handleLoginResponse:_,handlePostLoginActions:y,handleLoginFailure:C,resetInterfaceAfterSessionClear:M,checkFunctionAvailability:U};return c.jsx(JP.Provider,{value:ne,children:t})},xn=()=>{const t=b.useContext(JP);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t};class sW{constructor(){this.baseURL="http://localhost:8888/.netlify/functions",this.timeout=1e4,this.retryCount=3,this.retryDelay=1e3}getHeaders(){const e=localStorage.getItem("token");return{"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`}}}async sendRequest(e,r){try{return await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(n){throw console.error(" Network error:",n),n}}async request(e,r={}){const n=`${this.baseURL}${e}`,s={method:"GET",headers:this.getHeaders(),timeout:this.timeout,...r};let a;for(let i=0;i<this.retryCount;i++)try{const o=new AbortController,l=setTimeout(()=>o.abort(),this.timeout),u=await fetch(n,{...s,signal:o.signal});if(clearTimeout(l),!u.ok)throw new Error(`HTTP error! status: ${u.status}`);return await u.json()}catch(o){if(a=o,o.name==="AbortError")throw new Error("Request timeout");i<this.retryCount-1&&(console.warn(`Request failed, retrying in ${this.retryDelay}ms... (attempt ${i+1}/${this.retryCount})`),await new Promise(l=>setTimeout(l,this.retryDelay*Math.pow(2,i))))}throw a}async get(e,r={}){return this.request(e,{...r,method:"GET"})}async post(e,r,n={}){return this.request(e,{...n,method:"POST",body:JSON.stringify(r)})}async put(e,r,n={}){return this.request(e,{...n,method:"PUT",body:JSON.stringify(r)})}async delete(e,r={}){return this.request(e,{...r,method:"DELETE"})}async patch(e,r,n={}){return this.request(e,{...n,method:"PATCH",body:JSON.stringify(r)})}async uploadFile(e,r,n={}){const s=new FormData;s.append("file",r);const a=`${this.baseURL}${e}`,i={method:"POST",headers:{...localStorage.getItem("token")&&{Authorization:`Bearer ${localStorage.getItem("token")}`}},body:s,...n};try{const o=await fetch(a,i);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw o}}async downloadFile(e,r,n={}){const s=`${this.baseURL}${e}`,a={method:"GET",headers:this.getHeaders(),...n};try{const i=await fetch(s,a);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const o=await i.blob(),l=window.URL.createObjectURL(o),u=document.createElement("a");u.href=l,u.download=r,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(l)}catch(i){throw i}}ensureDebugOutput(){let e=document.getElementById("debug-output");return e||(e=document.createElement("div"),e.id="debug-output",e.className="fixed top-4 right-4 w-96 max-h-96 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-50 overflow-auto",e.innerHTML='<div class="text-sm font-mono text-gray-800">Debug Output</div>',document.body.appendChild(e)),e}async testDbConnection(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/test-db-connection")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Database Connection Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,message:"Database connection successful",data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Database Connection Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,message:"Database connection failed",error:e.message}}}async testStudentLogin(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:"51706",password:"1"})})).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Student Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Student Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testTeacherLogin(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"Aleksandr_Petrov",password:"465"})})).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Teacher Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Teacher Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testAdminLogin(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"admin",password:"admin123"})})).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Admin Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Admin Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testGetSubjects(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-subjects")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testGetTeacherSubjects(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-teacher-subjects")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Teacher Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Teacher Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testGetClassResults(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-class-results")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Class Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Class Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testGetStudentSubjects(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-subjects")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testGetStudentTestResults(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-test-results")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Test Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Test Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testEndpoints(){const e=["/debug/test-student-login","/debug/test-teacher-login","/debug/test-admin-login","/debug/test-get-subjects","/debug/test-get-teacher-subjects","/debug/test-get-class-results","/debug/test-get-student-subjects","/debug/test-get-student-test-results"],r={};for(const n of e)try{const s=await this.get(n);r[n]={success:!0,data:s}}catch(s){r[n]={success:!1,error:s.message}}return r}async debugFunction(e){const r=this.ensureDebugOutput();try{let n;switch(e){case"testDbConnection":n=await this.testDbConnection();break;case"testStudentLogin":n=await this.testStudentLogin();break;case"testTeacherLogin":n=await this.testTeacherLogin();break;case"testAdminLogin":n=await this.testAdminLogin();break;case"testGetSubjects":n=await this.testGetSubjects();break;case"testGetTeacherSubjects":n=await this.testGetTeacherSubjects();break;case"testGetClassResults":n=await this.testGetClassResults();break;case"testGetStudentSubjects":n=await this.testGetStudentSubjects();break;case"testGetStudentTestResults":n=await this.testGetStudentTestResults();break;default:throw new Error(`Unknown debug function: ${e}`)}return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Debug Function: ${e}</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),n}catch(n){throw r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Debug Function Error: ${e}</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${n.message}</pre>
        `),n}}showDebugFunctions(){const e=this.ensureDebugOutput(),r=`
      <div class="text-sm font-mono text-gray-800 mb-4">Debug Functions</div>
      <div class="grid grid-cols-2 gap-2 mb-4">
        <button onclick="apiClient.testDbConnection()" class="px-3 py-2 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition-colors">
          Test DB Connection
        </button>
        <button onclick="apiClient.testStudentLogin()" class="px-3 py-2 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors">
          Test Student Login
        </button>
        <button onclick="apiClient.testTeacherLogin()" class="px-3 py-2 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600 transition-colors">
          Test Teacher Login
        </button>
        <button onclick="apiClient.testAdminLogin()" class="px-3 py-2 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors">
          Test Admin Login
        </button>
        <button onclick="apiClient.testGetSubjects()" class="px-3 py-2 bg-purple-500 text-white text-xs rounded hover:bg-purple-600 transition-colors">
          Test Get Subjects
        </button>
        <button onclick="apiClient.testGetTeacherSubjects()" class="px-3 py-2 bg-indigo-500 text-white text-xs rounded hover:bg-indigo-600 transition-colors">
          Test Get Teacher Subjects
        </button>
        <button onclick="apiClient.testGetClassResults()" class="px-3 py-2 bg-pink-500 text-white text-xs rounded hover:bg-pink-600 transition-colors">
          Test Get Class Results
        </button>
        <button onclick="apiClient.testGetStudentSubjects()" class="px-3 py-2 bg-teal-500 text-white text-xs rounded hover:bg-teal-600 transition-colors">
          Test Get Student Subjects
        </button>
        <button onclick="apiClient.testGetStudentTestResults()" class="px-3 py-2 bg-orange-500 text-white text-xs rounded hover:bg-orange-600 transition-colors">
          Test Get Student Test Results
        </button>
        <button onclick="apiClient.testEndpoints()" class="px-3 py-2 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 transition-colors">
          Test All Endpoints
        </button>
      </div>
    `;e.innerHTML=r}}const vn=new sW,Zk=b.createContext({});function eC(t){const e=b.useRef(null);return e.current===null&&(e.current=t()),e.current}const tC=typeof window<"u",qP=tC?b.useLayoutEffect:b.useEffect,Cy=b.createContext(null);function rC(t,e){t.indexOf(e)===-1&&t.push(e)}function nC(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}const gl=(t,e,r)=>r>e?e:r<t?t:r;let sC=()=>{};const ml={},ZP=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function e7(t){return typeof t=="object"&&t!==null}const t7=t=>/^0[^.\s]+$/u.test(t);function aC(t){let e;return()=>(e===void 0&&(e=t()),e)}const pi=t=>t,aW=(t,e)=>r=>e(t(r)),sm=(...t)=>t.reduce(aW),vg=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n};class iC{constructor(){this.subscriptions=[]}add(e){return rC(this.subscriptions,e),()=>nC(this.subscriptions,e)}notify(e,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,r,n);else for(let a=0;a<s;a++){const i=this.subscriptions[a];i&&i(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const So=t=>t*1e3,ko=t=>t/1e3;function r7(t,e){return e?t*(1e3/e):0}const n7=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,iW=1e-7,oW=12;function lW(t,e,r,n,s){let a,i,o=0;do i=e+(r-e)/2,a=n7(i,n,s)-t,a>0?r=i:e=i;while(Math.abs(a)>iW&&++o<oW);return i}function am(t,e,r,n){if(t===e&&r===n)return pi;const s=a=>lW(a,0,1,t,r);return a=>a===0||a===1?a:n7(s(a),e,n)}const s7=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,a7=t=>e=>1-t(1-e),i7=am(.33,1.53,.69,.99),oC=a7(i7),o7=s7(oC),l7=t=>(t*=2)<1?.5*oC(t):.5*(2-Math.pow(2,-10*(t-1))),lC=t=>1-Math.sin(Math.acos(t)),c7=a7(lC),u7=s7(lC),cW=am(.42,0,1,1),uW=am(0,0,.58,1),d7=am(.42,0,.58,1),dW=t=>Array.isArray(t)&&typeof t[0]!="number",f7=t=>Array.isArray(t)&&typeof t[0]=="number",fW={linear:pi,easeIn:cW,easeInOut:d7,easeOut:uW,circIn:lC,circInOut:u7,circOut:c7,backIn:oC,backInOut:o7,backOut:i7,anticipate:l7},hW=t=>typeof t=="string",NN=t=>{if(f7(t)){sC(t.length===4);const[e,r,n,s]=t;return am(e,r,n,s)}else if(hW(t))return fW[t];return t},Hp=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function gW(t,e){let r=new Set,n=new Set,s=!1,a=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(d){i.has(d)&&(u.schedule(d),t()),d(o)}const u={schedule:(d,g=!1,h=!1)=>{const x=h&&s?r:n;return g&&i.add(d),x.has(d)||x.add(d),d},cancel:d=>{n.delete(d),i.delete(d)},process:d=>{if(o=d,s){a=!0;return}s=!0,[r,n]=[n,r],r.forEach(l),r.clear(),s=!1,a&&(a=!1,u.process(d))}};return u}const mW=40;function h7(t,e){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=Hp.reduce((y,k)=>(y[k]=gW(a),y),{}),{setup:o,read:l,resolveKeyframes:u,preUpdate:d,update:g,preRender:h,render:p,postRender:x}=i,v=()=>{const y=ml.useManualTiming?s.timestamp:performance.now();r=!1,ml.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(y-s.timestamp,mW),1)),s.timestamp=y,s.isProcessing=!0,o.process(s),l.process(s),u.process(s),d.process(s),g.process(s),h.process(s),p.process(s),x.process(s),s.isProcessing=!1,r&&e&&(n=!1,t(v))},w=()=>{r=!0,n=!0,s.isProcessing||t(v)};return{schedule:Hp.reduce((y,k)=>{const N=i[k];return y[k]=(E,A=!1,C=!1)=>(r||w(),N.schedule(E,A,C)),y},{}),cancel:y=>{for(let k=0;k<Hp.length;k++)i[Hp[k]].cancel(y)},state:s,steps:i}}const{schedule:sn,cancel:mc,state:ws,steps:N_}=h7(typeof requestAnimationFrame<"u"?requestAnimationFrame:pi,!0);let Dx;function pW(){Dx=void 0}const _a={now:()=>(Dx===void 0&&_a.set(ws.isProcessing||ml.useManualTiming?ws.timestamp:performance.now()),Dx),set:t=>{Dx=t,queueMicrotask(pW)}},g7=t=>e=>typeof e=="string"&&e.startsWith(t),cC=g7("--"),xW=g7("var(--"),uC=t=>xW(t)?yW.test(t.split("/*")[0].trim()):!1,yW=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,lh={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},wg={...lh,transform:t=>gl(0,1,t)},Gp={...lh,default:1},L0=t=>Math.round(t*1e5)/1e5,dC=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function vW(t){return t==null}const wW=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,fC=(t,e)=>r=>!!(typeof r=="string"&&wW.test(r)&&r.startsWith(t)||e&&!vW(r)&&Object.prototype.hasOwnProperty.call(r,e)),m7=(t,e,r)=>n=>{if(typeof n!="string")return n;const[s,a,i,o]=n.match(dC);return{[t]:parseFloat(s),[e]:parseFloat(a),[r]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},_W=t=>gl(0,255,t),A_={...lh,transform:t=>Math.round(_W(t))},hu={test:fC("rgb","red"),parse:m7("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+A_.transform(t)+", "+A_.transform(e)+", "+A_.transform(r)+", "+L0(wg.transform(n))+")"};function bW(t){let e="",r="",n="",s="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),s=t.substring(4,5),e+=e,r+=r,n+=n,s+=s),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const jb={test:fC("#"),parse:bW,transform:hu.transform},im=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),$l=im("deg"),Co=im("%"),Xt=im("px"),SW=im("vh"),kW=im("vw"),AN={...Co,parse:t=>Co.parse(t)/100,transform:t=>Co.transform(t*100)},lf={test:fC("hsl","hue"),parse:m7("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+Co.transform(L0(e))+", "+Co.transform(L0(r))+", "+L0(wg.transform(n))+")"},$n={test:t=>hu.test(t)||jb.test(t)||lf.test(t),parse:t=>hu.test(t)?hu.parse(t):lf.test(t)?lf.parse(t):jb.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?hu.transform(t):lf.transform(t),getAnimatableNone:t=>{const e=$n.parse(t);return e.alpha=0,$n.transform(e)}},CW=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function TW(t){var e,r;return isNaN(t)&&typeof t=="string"&&(((e=t.match(dC))==null?void 0:e.length)||0)+(((r=t.match(CW))==null?void 0:r.length)||0)>0}const p7="number",x7="color",EW="var",NW="var(",jN="${}",AW=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function _g(t){const e=t.toString(),r=[],n={color:[],number:[],var:[]},s=[];let a=0;const o=e.replace(AW,l=>($n.test(l)?(n.color.push(a),s.push(x7),r.push($n.parse(l))):l.startsWith(NW)?(n.var.push(a),s.push(EW),r.push(l)):(n.number.push(a),s.push(p7),r.push(parseFloat(l))),++a,jN)).split(jN);return{values:r,split:o,indexes:n,types:s}}function y7(t){return _g(t).values}function v7(t){const{split:e,types:r}=_g(t),n=e.length;return s=>{let a="";for(let i=0;i<n;i++)if(a+=e[i],s[i]!==void 0){const o=r[i];o===p7?a+=L0(s[i]):o===x7?a+=$n.transform(s[i]):a+=s[i]}return a}}const jW=t=>typeof t=="number"?0:$n.test(t)?$n.getAnimatableNone(t):t;function FW(t){const e=y7(t);return v7(t)(e.map(jW))}const pc={test:TW,parse:y7,createTransformer:v7,getAnimatableNone:FW};function j_(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function PW({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let s=0,a=0,i=0;if(!e)s=a=i=r;else{const o=r<.5?r*(1+e):r+e-r*e,l=2*r-o;s=j_(l,o,t+1/3),a=j_(l,o,t),i=j_(l,o,t-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:n}}function p1(t,e){return r=>r>0?e:t}const dn=(t,e,r)=>t+(e-t)*r,F_=(t,e,r)=>{const n=t*t,s=r*(e*e-n)+n;return s<0?0:Math.sqrt(s)},DW=[jb,hu,lf],RW=t=>DW.find(e=>e.test(t));function FN(t){const e=RW(t);if(!e)return!1;let r=e.parse(t);return e===lf&&(r=PW(r)),r}const PN=(t,e)=>{const r=FN(t),n=FN(e);if(!r||!n)return p1(t,e);const s={...r};return a=>(s.red=F_(r.red,n.red,a),s.green=F_(r.green,n.green,a),s.blue=F_(r.blue,n.blue,a),s.alpha=dn(r.alpha,n.alpha,a),hu.transform(s))},Fb=new Set(["none","hidden"]);function MW(t,e){return Fb.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function LW(t,e){return r=>dn(t,e,r)}function hC(t){return typeof t=="number"?LW:typeof t=="string"?uC(t)?p1:$n.test(t)?PN:BW:Array.isArray(t)?w7:typeof t=="object"?$n.test(t)?PN:IW:p1}function w7(t,e){const r=[...t],n=r.length,s=t.map((a,i)=>hC(a)(a,e[i]));return a=>{for(let i=0;i<n;i++)r[i]=s[i](a);return r}}function IW(t,e){const r={...t,...e},n={};for(const s in r)t[s]!==void 0&&e[s]!==void 0&&(n[s]=hC(t[s])(t[s],e[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}}function OW(t,e){const r=[],n={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],i=t.indexes[a][n[a]],o=t.values[i]??0;r[s]=o,n[a]++}return r}const BW=(t,e)=>{const r=pc.createTransformer(e),n=_g(t),s=_g(e);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?Fb.has(t)&&!s.values.length||Fb.has(e)&&!n.values.length?MW(t,e):sm(w7(OW(n,s),s.values),r):p1(t,e)};function _7(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?dn(t,e,r):hC(t)(t,e)}const UW=t=>{const e=({timestamp:r})=>t(r);return{start:(r=!0)=>sn.update(e,r),stop:()=>mc(e),now:()=>ws.isProcessing?ws.timestamp:_a.now()}},b7=(t,e,r=10)=>{let n="";const s=Math.max(Math.round(e/r),2);for(let a=0;a<s;a++)n+=Math.round(t(a/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},x1=2e4;function gC(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<x1;)e+=r,n=t.next(e);return e>=x1?1/0:e}function $W(t,e=100,r){const n=r({...t,keyframes:[0,e]}),s=Math.min(gC(n),x1);return{type:"keyframes",ease:a=>n.next(s*a).value/e,duration:ko(s)}}const WW=5;function S7(t,e,r){const n=Math.max(e-WW,0);return r7(r-t(n),e-n)}const wn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},P_=.001;function zW({duration:t=wn.duration,bounce:e=wn.bounce,velocity:r=wn.velocity,mass:n=wn.mass}){let s,a,i=1-e;i=gl(wn.minDamping,wn.maxDamping,i),t=gl(wn.minDuration,wn.maxDuration,ko(t)),i<1?(s=u=>{const d=u*i,g=d*t,h=d-r,p=Pb(u,i),x=Math.exp(-g);return P_-h/p*x},a=u=>{const g=u*i*t,h=g*r+r,p=Math.pow(i,2)*Math.pow(u,2)*t,x=Math.exp(-g),v=Pb(Math.pow(u,2),i);return(-s(u)+P_>0?-1:1)*((h-p)*x)/v}):(s=u=>{const d=Math.exp(-u*t),g=(u-r)*t+1;return-P_+d*g},a=u=>{const d=Math.exp(-u*t),g=(r-u)*(t*t);return d*g});const o=5/t,l=GW(s,a,o);if(t=So(t),isNaN(l))return{stiffness:wn.stiffness,damping:wn.damping,duration:t};{const u=Math.pow(l,2)*n;return{stiffness:u,damping:i*2*Math.sqrt(n*u),duration:t}}}const HW=12;function GW(t,e,r){let n=r;for(let s=1;s<HW;s++)n=n-t(n)/e(n);return n}function Pb(t,e){return t*Math.sqrt(1-e*e)}const VW=["duration","bounce"],KW=["stiffness","damping","mass"];function DN(t,e){return e.some(r=>t[r]!==void 0)}function XW(t){let e={velocity:wn.velocity,stiffness:wn.stiffness,damping:wn.damping,mass:wn.mass,isResolvedFromDuration:!1,...t};if(!DN(t,KW)&&DN(t,VW))if(t.visualDuration){const r=t.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,a=2*gl(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:wn.mass,stiffness:s,damping:a}}else{const r=zW(t);e={...e,...r,mass:wn.mass},e.isResolvedFromDuration=!0}return e}function y1(t=wn.visualDuration,e=wn.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:s}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],o={done:!1,value:a},{stiffness:l,damping:u,mass:d,duration:g,velocity:h,isResolvedFromDuration:p}=XW({...r,velocity:-ko(r.velocity||0)}),x=h||0,v=u/(2*Math.sqrt(l*d)),w=i-a,S=ko(Math.sqrt(l/d)),_=Math.abs(w)<5;n||(n=_?wn.restSpeed.granular:wn.restSpeed.default),s||(s=_?wn.restDelta.granular:wn.restDelta.default);let y;if(v<1){const N=Pb(S,v);y=E=>{const A=Math.exp(-v*S*E);return i-A*((x+v*S*w)/N*Math.sin(N*E)+w*Math.cos(N*E))}}else if(v===1)y=N=>i-Math.exp(-S*N)*(w+(x+S*w)*N);else{const N=S*Math.sqrt(v*v-1);y=E=>{const A=Math.exp(-v*S*E),C=Math.min(N*E,300);return i-A*((x+v*S*w)*Math.sinh(C)+N*w*Math.cosh(C))/N}}const k={calculatedDuration:p&&g||null,next:N=>{const E=y(N);if(p)o.done=N>=g;else{let A=N===0?x:0;v<1&&(A=N===0?So(x):S7(y,N,E));const C=Math.abs(A)<=n,F=Math.abs(i-E)<=s;o.done=C&&F}return o.value=o.done?i:E,o},toString:()=>{const N=Math.min(gC(k),x1),E=b7(A=>k.next(N*A).value,N,30);return N+"ms "+E},toTransition:()=>{}};return k}y1.applyToOptions=t=>{const e=$W(t,100,y1);return t.ease=e.ease,t.duration=So(e.duration),t.type="keyframes",t};function Db({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:i,min:o,max:l,restDelta:u=.5,restSpeed:d}){const g=t[0],h={done:!1,value:g},p=C=>o!==void 0&&C<o||l!==void 0&&C>l,x=C=>o===void 0?l:l===void 0||Math.abs(o-C)<Math.abs(l-C)?o:l;let v=r*e;const w=g+v,S=i===void 0?w:i(w);S!==w&&(v=S-g);const _=C=>-v*Math.exp(-C/n),y=C=>S+_(C),k=C=>{const F=_(C),D=y(C);h.done=Math.abs(F)<=u,h.value=h.done?S:D};let N,E;const A=C=>{p(h.value)&&(N=C,E=y1({keyframes:[h.value,x(h.value)],velocity:S7(y,C,h.value),damping:s,stiffness:a,restDelta:u,restSpeed:d}))};return A(0),{calculatedDuration:null,next:C=>{let F=!1;return!E&&N===void 0&&(F=!0,k(C),A(C)),N!==void 0&&C>=N?E.next(C-N):(!F&&k(C),h)}}}function YW(t,e,r){const n=[],s=r||ml.mix||_7,a=t.length-1;for(let i=0;i<a;i++){let o=s(t[i],t[i+1]);if(e){const l=Array.isArray(e)?e[i]||pi:e;o=sm(l,o)}n.push(o)}return n}function JW(t,e,{clamp:r=!0,ease:n,mixer:s}={}){const a=t.length;if(sC(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const i=t[0]===t[1];t[0]>t[a-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=YW(e,n,s),l=o.length,u=d=>{if(i&&d<t[0])return e[0];let g=0;if(l>1)for(;g<t.length-2&&!(d<t[g+1]);g++);const h=vg(t[g],t[g+1],d);return o[g](h)};return r?d=>u(gl(t[0],t[a-1],d)):u}function QW(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const s=vg(0,e,n);t.push(dn(r,1,s))}}function qW(t){const e=[0];return QW(e,t.length-1),e}function ZW(t,e){return t.map(r=>r*e)}function ez(t,e){return t.map(()=>e||d7).splice(0,t.length-1)}function I0({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const s=dW(n)?n.map(NN):NN(n),a={done:!1,value:e[0]},i=ZW(r&&r.length===e.length?r:qW(e),t),o=JW(i,e,{ease:Array.isArray(s)?s:ez(e,s)});return{calculatedDuration:t,next:l=>(a.value=o(l),a.done=l>=t,a)}}const tz=t=>t!==null;function mC(t,{repeat:e,repeatType:r="loop"},n,s=1){const a=t.filter(tz),o=s<0||e&&r!=="loop"&&e%2===1?0:a.length-1;return!o||n===void 0?a[o]:n}const rz={decay:Db,inertia:Db,tween:I0,keyframes:I0,spring:y1};function k7(t){typeof t.type=="string"&&(t.type=rz[t.type])}class pC{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}const nz=t=>t/100;class xC extends pC{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var n,s;const{motionValue:r}=this.options;r&&r.updatedAt!==_a.now()&&this.tick(_a.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(s=(n=this.options).onStop)==null||s.call(n))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;k7(e);const{type:r=I0,repeat:n=0,repeatDelay:s=0,repeatType:a,velocity:i=0}=e;let{keyframes:o}=e;const l=r||I0;l!==I0&&typeof o[0]!="number"&&(this.mixKeyframes=sm(nz,_7(o[0],o[1])),o=[0,100]);const u=l({...e,keyframes:o});a==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...o].reverse(),velocity:-i})),u.calculatedDuration===null&&(u.calculatedDuration=gC(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=u}updateTime(e){const r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){const{generator:n,totalDuration:s,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return n.next(0);const{delay:u=0,keyframes:d,repeat:g,repeatType:h,repeatDelay:p,type:x,onUpdate:v,finalKeyframe:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);const S=this.currentTime-u*(this.playbackSpeed>=0?1:-1),_=this.playbackSpeed>=0?S<0:S>s;this.currentTime=Math.max(S,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let y=this.currentTime,k=n;if(g){const C=Math.min(this.currentTime,s)/o;let F=Math.floor(C),D=C%1;!D&&C>=1&&(D=1),D===1&&F--,F=Math.min(F,g+1),!!(F%2)&&(h==="reverse"?(D=1-D,p&&(D-=p/o)):h==="mirror"&&(k=i)),y=gl(0,1,D)*o}const N=_?{done:!1,value:d[0]}:k.next(y);a&&(N.value=a(N.value));let{done:E}=N;!_&&l!==null&&(E=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&E);return A&&x!==Db&&(N.value=mC(d,this.options,w,this.speed)),v&&v(N.value),A&&this.finish(),N}then(e,r){return this.finished.then(e,r)}get duration(){return ko(this.calculatedDuration)}get time(){return ko(this.currentTime)}set time(e){var r;e=So(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(_a.now());const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=ko(this.currentTime))}play(){var s,a;if(this.isStopped)return;const{driver:e=UW,startTime:r}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),(a=(s=this.options).onPlay)==null||a.call(s);const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(_a.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(e=this.options).onComplete)==null||r.call(e)}cancel(){var e,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(e=this.options).onCancel)==null||r.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),e.observe(this)}}function sz(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const gu=t=>t*180/Math.PI,Rb=t=>{const e=gu(Math.atan2(t[1],t[0]));return Mb(e)},az={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Rb,rotateZ:Rb,skewX:t=>gu(Math.atan(t[1])),skewY:t=>gu(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Mb=t=>(t=t%360,t<0&&(t+=360),t),RN=Rb,MN=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),LN=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),iz={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:MN,scaleY:LN,scale:t=>(MN(t)+LN(t))/2,rotateX:t=>Mb(gu(Math.atan2(t[6],t[5]))),rotateY:t=>Mb(gu(Math.atan2(-t[2],t[0]))),rotateZ:RN,rotate:RN,skewX:t=>gu(Math.atan(t[4])),skewY:t=>gu(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Lb(t){return t.includes("scale")?1:0}function Ib(t,e){if(!t||t==="none")return Lb(e);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=iz,s=r;else{const o=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=az,s=o}if(!s)return Lb(e);const a=n[e],i=s[1].split(",").map(lz);return typeof a=="function"?a(i):i[a]}const oz=(t,e)=>{const{transform:r="none"}=getComputedStyle(t);return Ib(r,e)};function lz(t){return parseFloat(t.trim())}const ch=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],uh=new Set(ch),IN=t=>t===lh||t===Xt,cz=new Set(["x","y","z"]),uz=ch.filter(t=>!cz.has(t));function dz(t){const e=[];return uz.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e}const wu={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>Ib(e,"x"),y:(t,{transform:e})=>Ib(e,"y")};wu.translateX=wu.x;wu.translateY=wu.y;const _u=new Set;let Ob=!1,Bb=!1,Ub=!1;function C7(){if(Bb){const t=Array.from(_u).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),r=new Map;e.forEach(n=>{const s=dz(n);s.length&&(r.set(n,s),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([a,i])=>{var o;(o=n.getValue(a))==null||o.set(i)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}Bb=!1,Ob=!1,_u.forEach(t=>t.complete(Ub)),_u.clear()}function T7(){_u.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Bb=!0)})}function fz(){Ub=!0,T7(),C7(),Ub=!1}class yC{constructor(e,r,n,s,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=n,this.motionValue=s,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(_u.add(this),Ob||(Ob=!0,sn.read(T7),sn.resolveKeyframes(C7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:n,motionValue:s}=this;if(e[0]===null){const a=s==null?void 0:s.get(),i=e[e.length-1];if(a!==void 0)e[0]=a;else if(n&&r){const o=n.readValue(r,i);o!=null&&(e[0]=o)}e[0]===void 0&&(e[0]=i),s&&a===void 0&&s.set(e[0])}sz(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),_u.delete(this)}cancel(){this.state==="scheduled"&&(_u.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const hz=t=>t.startsWith("--");function gz(t,e,r){hz(e)?t.style.setProperty(e,r):t.style[e]=r}const mz=aC(()=>window.ScrollTimeline!==void 0),pz={};function xz(t,e){const r=aC(t);return()=>pz[e]??r()}const E7=xz(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),w0=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,ON={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:w0([0,.65,.55,1]),circOut:w0([.55,0,1,.45]),backIn:w0([.31,.01,.66,-.59]),backOut:w0([.33,1.53,.69,.99])};function N7(t,e){if(t)return typeof t=="function"?E7()?b7(t,e):"ease-out":f7(t)?w0(t):Array.isArray(t)?t.map(r=>N7(r,e)||ON.easeOut):ON[t]}function yz(t,e,r,{delay:n=0,duration:s=300,repeat:a=0,repeatType:i="loop",ease:o="easeOut",times:l}={},u=void 0){const d={[e]:r};l&&(d.offset=l);const g=N7(o,s);Array.isArray(g)&&(d.easing=g);const h={delay:n,duration:s,easing:Array.isArray(g)?"linear":g,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return u&&(h.pseudoElement=u),t.animate(d,h)}function A7(t){return typeof t=="function"&&"applyToOptions"in t}function vz({type:t,...e}){return A7(t)&&E7()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class wz extends pC{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:r,name:n,keyframes:s,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:o,onComplete:l}=e;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=e,sC(typeof e.type!="string");const u=vz(e);this.animation=yz(r,n,s,u,a),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const d=mC(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(d):gz(r,n,d),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,r;(r=(e=this.animation).finish)==null||r.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,r;this.isPseudoElement||(r=(e=this.animation).commitStyles)==null||r.call(e)}get duration(){var r,n;const e=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return ko(Number(e))}get time(){return ko(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=So(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&mz()?(this.animation.timeline=e,pi):r(this)}}const j7={anticipate:l7,backInOut:o7,circInOut:u7};function _z(t){return t in j7}function bz(t){typeof t.ease=="string"&&_z(t.ease)&&(t.ease=j7[t.ease])}const BN=10;class Sz extends wz{constructor(e){bz(e),k7(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:r,onUpdate:n,onComplete:s,element:a,...i}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}const o=new xC({...i,autoplay:!1}),l=So(this.finishedTime??this.time);r.setWithVelocity(o.sample(l-BN).value,o.sample(l).value,BN),o.stop()}}const UN=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(pc.test(t)||t==="0")&&!t.startsWith("url("));function kz(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function Cz(t,e,r,n){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const a=t[t.length-1],i=UN(s,e),o=UN(a,e);return!i||!o?!1:kz(t)||(r==="spring"||A7(r))&&n}function $b(t){t.duration=0,t.type}const Tz=new Set(["opacity","clipPath","filter","transform"]),Ez=aC(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Nz(t){var d;const{motionValue:e,name:r,repeatDelay:n,repeatType:s,damping:a,type:i}=t;if(!(((d=e==null?void 0:e.owner)==null?void 0:d.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=e.owner.getProps();return Ez()&&r&&Tz.has(r)&&(r!=="transform"||!u)&&!l&&!n&&s!=="mirror"&&a!==0&&i!=="inertia"}const Az=40;class jz extends pC{constructor({autoplay:e=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:i="loop",keyframes:o,name:l,motionValue:u,element:d,...g}){var x;super(),this.stop=()=>{var v,w;this._animation&&(this._animation.stop(),(v=this.stopTimeline)==null||v.call(this)),(w=this.keyframeResolver)==null||w.cancel()},this.createdAt=_a.now();const h={autoplay:e,delay:r,type:n,repeat:s,repeatDelay:a,repeatType:i,name:l,motionValue:u,element:d,...g},p=(d==null?void 0:d.KeyframeResolver)||yC;this.keyframeResolver=new p(o,(v,w,S)=>this.onKeyframesResolved(v,w,h,!S),l,u,d),(x=this.keyframeResolver)==null||x.scheduleResolve()}onKeyframesResolved(e,r,n,s){this.keyframeResolver=void 0;const{name:a,type:i,velocity:o,delay:l,isHandoff:u,onUpdate:d}=n;this.resolvedAt=_a.now(),Cz(e,a,i,o)||((ml.instantAnimations||!l)&&(d==null||d(mC(e,n,r))),e[0]=e[e.length-1],$b(n),n.repeat=0);const h={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>Az?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:e},p=!u&&Nz(h)?new Sz({...h,element:h.motionValue.owner.current}):new xC(h);p.finished.then(()=>this.notifyFinished()).catch(pi),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),fz()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const Fz=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Pz(t){const e=Fz.exec(t);if(!e)return[,];const[,r,n,s]=e;return[`--${r??n}`,s]}function F7(t,e,r=1){const[n,s]=Pz(t);if(!n)return;const a=window.getComputedStyle(e).getPropertyValue(n);if(a){const i=a.trim();return ZP(i)?parseFloat(i):i}return uC(s)?F7(s,e,r+1):s}function vC(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const P7=new Set(["width","height","top","left","right","bottom",...ch]),Dz={test:t=>t==="auto",parse:t=>t},D7=t=>e=>e.test(t),R7=[lh,Xt,Co,$l,kW,SW,Dz],$N=t=>R7.find(D7(t));function Rz(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||t7(t):!0}const Mz=new Set(["brightness","contrast","saturate","opacity"]);function Lz(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match(dC)||[];if(!n)return t;const s=r.replace(n,"");let a=Mz.has(e)?1:0;return n!==r&&(a*=100),e+"("+a+s+")"}const Iz=/\b([a-z-]*)\(.*?\)/gu,Wb={...pc,getAnimatableNone:t=>{const e=t.match(Iz);return e?e.map(Lz).join(" "):t}},WN={...lh,transform:Math.round},Oz={rotate:$l,rotateX:$l,rotateY:$l,rotateZ:$l,scale:Gp,scaleX:Gp,scaleY:Gp,scaleZ:Gp,skew:$l,skewX:$l,skewY:$l,distance:Xt,translateX:Xt,translateY:Xt,translateZ:Xt,x:Xt,y:Xt,z:Xt,perspective:Xt,transformPerspective:Xt,opacity:wg,originX:AN,originY:AN,originZ:Xt},wC={borderWidth:Xt,borderTopWidth:Xt,borderRightWidth:Xt,borderBottomWidth:Xt,borderLeftWidth:Xt,borderRadius:Xt,radius:Xt,borderTopLeftRadius:Xt,borderTopRightRadius:Xt,borderBottomRightRadius:Xt,borderBottomLeftRadius:Xt,width:Xt,maxWidth:Xt,height:Xt,maxHeight:Xt,top:Xt,right:Xt,bottom:Xt,left:Xt,padding:Xt,paddingTop:Xt,paddingRight:Xt,paddingBottom:Xt,paddingLeft:Xt,margin:Xt,marginTop:Xt,marginRight:Xt,marginBottom:Xt,marginLeft:Xt,backgroundPositionX:Xt,backgroundPositionY:Xt,...Oz,zIndex:WN,fillOpacity:wg,strokeOpacity:wg,numOctaves:WN},Bz={...wC,color:$n,backgroundColor:$n,outlineColor:$n,fill:$n,stroke:$n,borderColor:$n,borderTopColor:$n,borderRightColor:$n,borderBottomColor:$n,borderLeftColor:$n,filter:Wb,WebkitFilter:Wb},M7=t=>Bz[t];function L7(t,e){let r=M7(t);return r!==Wb&&(r=pc),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const Uz=new Set(["auto","none","0"]);function $z(t,e,r){let n=0,s;for(;n<t.length&&!s;){const a=t[n];typeof a=="string"&&!Uz.has(a)&&_g(a).values.length&&(s=t[n]),n++}if(s&&r)for(const a of e)t[a]=L7(r,s)}class Wz extends yC{constructor(e,r,n,s,a){super(e,r,n,s,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),uC(u))){const d=F7(u,r.current);d!==void 0&&(e[l]=d),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!P7.has(n)||e.length!==2)return;const[s,a]=e,i=$N(s),o=$N(a);if(i!==o)if(IN(i)&&IN(o))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else wu[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,n=[];for(let s=0;s<e.length;s++)(e[s]===null||Rz(e[s]))&&n.push(s);n.length&&$z(e,n,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=wu[n](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&e.getValue(n,s).jump(s,!1)}measureEndState(){var o;const{element:e,name:r,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const s=e.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=n.length-1,i=n[a];n[a]=wu[r](e.measureViewportBox(),window.getComputedStyle(e.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,u])=>{e.getValue(l).set(u)}),this.resolveNoneKeyframes()}}function zz(t,e,r){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let n=document;const s=(r==null?void 0:r[t])??n.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t)}const I7=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function O7(t){return e7(t)&&"offsetHeight"in t}const zN=30,Hz=t=>!isNaN(parseFloat(t));class Gz{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{var a;const s=_a.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current),this.dependents))for(const i of this.dependents)i.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=_a.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Hz(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new iC);const n=this.events[e].add(r);return e==="change"?()=>{n(),sn.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=_a.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>zN)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,zN);return r7(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,r;(e=this.dependents)==null||e.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Wf(t,e){return new Gz(t,e)}const{schedule:_C}=h7(queueMicrotask,!1),Di={x:!1,y:!1};function B7(){return Di.x||Di.y}function Vz(t){return t==="x"||t==="y"?Di[t]?null:(Di[t]=!0,()=>{Di[t]=!1}):Di.x||Di.y?null:(Di.x=Di.y=!0,()=>{Di.x=Di.y=!1})}function U7(t,e){const r=zz(t),n=new AbortController,s={passive:!0,...e,signal:n.signal};return[r,s,()=>n.abort()]}function HN(t){return!(t.pointerType==="touch"||B7())}function Kz(t,e,r={}){const[n,s,a]=U7(t,r),i=o=>{if(!HN(o))return;const{target:l}=o,u=e(l,o);if(typeof u!="function"||!l)return;const d=g=>{HN(g)&&(u(g),l.removeEventListener("pointerleave",d))};l.addEventListener("pointerleave",d,s)};return n.forEach(o=>{o.addEventListener("pointerenter",i,s)}),a}const $7=(t,e)=>e?t===e?!0:$7(t,e.parentElement):!1,bC=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,Xz=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Yz(t){return Xz.has(t.tagName)||t.tabIndex!==-1}const Rx=new WeakSet;function GN(t){return e=>{e.key==="Enter"&&t(e)}}function D_(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Jz=(t,e)=>{const r=t.currentTarget;if(!r)return;const n=GN(()=>{if(Rx.has(r))return;D_(r,"down");const s=GN(()=>{D_(r,"up")}),a=()=>D_(r,"cancel");r.addEventListener("keyup",s,e),r.addEventListener("blur",a,e)});r.addEventListener("keydown",n,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),e)};function VN(t){return bC(t)&&!B7()}function Qz(t,e,r={}){const[n,s,a]=U7(t,r),i=o=>{const l=o.currentTarget;if(!VN(o))return;Rx.add(l);const u=e(l,o),d=(p,x)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",h),Rx.has(l)&&Rx.delete(l),VN(p)&&typeof u=="function"&&u(p,{success:x})},g=p=>{d(p,l===window||l===document||r.useGlobalTarget||$7(l,p.target))},h=p=>{d(p,!1)};window.addEventListener("pointerup",g,s),window.addEventListener("pointercancel",h,s)};return n.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",i,s),O7(o)&&(o.addEventListener("focus",u=>Jz(u,s)),!Yz(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),a}function W7(t){return e7(t)&&"ownerSVGElement"in t}function qz(t){return W7(t)&&t.tagName==="svg"}const Ws=t=>!!(t&&t.getVelocity),Zz=[...R7,$n,pc],eH=t=>Zz.find(D7(t)),SC=b.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class tH extends b.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=O7(n)&&n.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function rH({children:t,isPresent:e,anchorX:r,root:n}){const s=b.useId(),a=b.useRef(null),i=b.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=b.useContext(SC);return b.useInsertionEffect(()=>{const{width:l,height:u,top:d,left:g,right:h}=i.current;if(e||!a.current||!l||!u)return;const p=r==="left"?`left: ${g}`:`right: ${h}`;a.current.dataset.motionPopId=s;const x=document.createElement("style");o&&(x.nonce=o);const v=n??document.head;return v.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${u}px !important;
            ${p}px !important;
            top: ${d}px !important;
          }
        `),()=>{v.contains(x)&&v.removeChild(x)}},[e]),c.jsx(tH,{isPresent:e,childRef:a,sizeRef:i,children:b.cloneElement(t,{ref:a})})}const nH=({children:t,initial:e,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:i,anchorX:o,root:l})=>{const u=eC(sH),d=b.useId();let g=!0,h=b.useMemo(()=>(g=!1,{id:d,initial:e,isPresent:r,custom:s,onExitComplete:p=>{u.set(p,!0);for(const x of u.values())if(!x)return;n&&n()},register:p=>(u.set(p,!1),()=>u.delete(p))}),[r,u,n]);return a&&g&&(h={...h}),b.useMemo(()=>{u.forEach((p,x)=>u.set(x,!1))},[r]),b.useEffect(()=>{!r&&!u.size&&n&&n()},[r]),i==="popLayout"&&(t=c.jsx(rH,{isPresent:r,anchorX:o,root:l,children:t})),c.jsx(Cy.Provider,{value:h,children:t})};function sH(){return new Map}function z7(t=!0){const e=b.useContext(Cy);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=e,a=b.useId();b.useEffect(()=>{if(t)return s(a)},[t]);const i=b.useCallback(()=>t&&n&&n(a),[a,n,t]);return!r&&n?[!1,i]:[!0]}const Vp=t=>t.key||"";function KN(t){const e=[];return b.Children.forEach(t,r=>{b.isValidElement(r)&&e.push(r)}),e}const va=({children:t,custom:e,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:a="sync",propagate:i=!1,anchorX:o="left",root:l})=>{const[u,d]=z7(i),g=b.useMemo(()=>KN(t),[t]),h=i&&!u?[]:g.map(Vp),p=b.useRef(!0),x=b.useRef(g),v=eC(()=>new Map),[w,S]=b.useState(g),[_,y]=b.useState(g);qP(()=>{p.current=!1,x.current=g;for(let E=0;E<_.length;E++){const A=Vp(_[E]);h.includes(A)?v.delete(A):v.get(A)!==!0&&v.set(A,!1)}},[_,h.length,h.join("-")]);const k=[];if(g!==w){let E=[...g];for(let A=0;A<_.length;A++){const C=_[A],F=Vp(C);h.includes(F)||(E.splice(A,0,C),k.push(C))}return a==="wait"&&k.length&&(E=k),y(KN(E)),S(g),null}const{forceRender:N}=b.useContext(Zk);return c.jsx(c.Fragment,{children:_.map(E=>{const A=Vp(E),C=i&&!u?!1:g===_||h.includes(A),F=()=>{if(v.has(A))v.set(A,!0);else return;let D=!0;v.forEach(R=>{R||(D=!1)}),D&&(N==null||N(),y(x.current),i&&(d==null||d()),n&&n())};return c.jsx(nH,{isPresent:C,initial:!p.current||r?void 0:!1,custom:e,presenceAffectsLayout:s,mode:a,root:l,onExitComplete:C?void 0:F,anchorX:o,children:E},A)})})},H7=b.createContext({strict:!1}),XN={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},zf={};for(const t in XN)zf[t]={isEnabled:e=>XN[t].some(r=>!!e[r])};function aH(t){for(const e in t)zf[e]={...zf[e],...t[e]}}const iH=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function v1(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||iH.has(t)}let G7=t=>!v1(t);function oH(t){typeof t=="function"&&(G7=e=>e.startsWith("on")?!v1(e):t(e))}try{oH(require("@emotion/is-prop-valid").default)}catch{}function lH(t,e,r){const n={};for(const s in t)s==="values"&&typeof t.values=="object"||(G7(s)||r===!0&&v1(s)||!e&&!v1(s)||t.draggable&&s.startsWith("onDrag"))&&(n[s]=t[s]);return n}const Ty=b.createContext({});function Ey(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function bg(t){return typeof t=="string"||Array.isArray(t)}const kC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],CC=["initial",...kC];function Ny(t){return Ey(t.animate)||CC.some(e=>bg(t[e]))}function V7(t){return!!(Ny(t)||t.variants)}function cH(t,e){if(Ny(t)){const{initial:r,animate:n}=t;return{initial:r===!1||bg(r)?r:void 0,animate:bg(n)?n:void 0}}return t.inherit!==!1?e:{}}function uH(t){const{initial:e,animate:r}=cH(t,b.useContext(Ty));return b.useMemo(()=>({initial:e,animate:r}),[YN(e),YN(r)])}function YN(t){return Array.isArray(t)?t.join(" "):t}const Sg={};function dH(t){for(const e in t)Sg[e]=t[e],cC(e)&&(Sg[e].isCSSVariable=!0)}function K7(t,{layout:e,layoutId:r}){return uh.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!Sg[t]||t==="opacity")}const fH={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},hH=ch.length;function gH(t,e,r){let n="",s=!0;for(let a=0;a<hH;a++){const i=ch[a],o=t[i];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(i.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||r){const u=I7(o,wC[i]);if(!l){s=!1;const d=fH[i]||i;n+=`${d}(${u}) `}r&&(e[i]=u)}}return n=n.trim(),r?n=r(e,s?"":n):s&&(n="none"),n}function TC(t,e,r){const{style:n,vars:s,transformOrigin:a}=t;let i=!1,o=!1;for(const l in e){const u=e[l];if(uh.has(l)){i=!0;continue}else if(cC(l)){s[l]=u;continue}else{const d=I7(u,wC[l]);l.startsWith("origin")?(o=!0,a[l]=d):n[l]=d}}if(e.transform||(i||r?n.transform=gH(e,t.transform,r):n.transform&&(n.transform="none")),o){const{originX:l="50%",originY:u="50%",originZ:d=0}=a;n.transformOrigin=`${l} ${u} ${d}`}}const EC=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function X7(t,e,r){for(const n in e)!Ws(e[n])&&!K7(n,r)&&(t[n]=e[n])}function mH({transformTemplate:t},e){return b.useMemo(()=>{const r=EC();return TC(r,e,t),Object.assign({},r.vars,r.style)},[e])}function pH(t,e){const r=t.style||{},n={};return X7(n,r,t),Object.assign(n,mH(t,e)),n}function xH(t,e){const r={},n=pH(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=n,r}const yH={offset:"stroke-dashoffset",array:"stroke-dasharray"},vH={offset:"strokeDashoffset",array:"strokeDasharray"};function wH(t,e,r=1,n=0,s=!0){t.pathLength=1;const a=s?yH:vH;t[a.offset]=Xt.transform(-n);const i=Xt.transform(e),o=Xt.transform(r);t[a.array]=`${i} ${o}`}function Y7(t,{attrX:e,attrY:r,attrScale:n,pathLength:s,pathSpacing:a=1,pathOffset:i=0,...o},l,u,d){if(TC(t,o,u),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:g,style:h}=t;g.transform&&(h.transform=g.transform,delete g.transform),(h.transform||g.transformOrigin)&&(h.transformOrigin=g.transformOrigin??"50% 50%",delete g.transformOrigin),h.transform&&(h.transformBox=(d==null?void 0:d.transformBox)??"fill-box",delete g.transformBox),e!==void 0&&(g.x=e),r!==void 0&&(g.y=r),n!==void 0&&(g.scale=n),s!==void 0&&wH(g,s,a,i,!1)}const J7=()=>({...EC(),attrs:{}}),Q7=t=>typeof t=="string"&&t.toLowerCase()==="svg";function _H(t,e,r,n){const s=b.useMemo(()=>{const a=J7();return Y7(a,e,Q7(n),t.transformTemplate,t.style),{...a.attrs,style:{...a.style}}},[e]);if(t.style){const a={};X7(a,t.style,t),s.style={...a,...s.style}}return s}const bH=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function NC(t){return typeof t!="string"||t.includes("-")?!1:!!(bH.indexOf(t)>-1||/[A-Z]/u.test(t))}function SH(t,e,r,{latestValues:n},s,a=!1){const o=(NC(t)?_H:xH)(e,n,s,t),l=lH(e,typeof t=="string",a),u=t!==b.Fragment?{...l,...o,ref:r}:{},{children:d}=e,g=b.useMemo(()=>Ws(d)?d.get():d,[d]);return b.createElement(t,{...u,children:g})}function JN(t){const e=[{},{}];return t==null||t.values.forEach((r,n)=>{e[0][n]=r.get(),e[1][n]=r.getVelocity()}),e}function AC(t,e,r,n){if(typeof e=="function"){const[s,a]=JN(n);e=e(r!==void 0?r:t.custom,s,a)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,a]=JN(n);e=e(r!==void 0?r:t.custom,s,a)}return e}function Mx(t){return Ws(t)?t.get():t}function kH({scrapeMotionValuesFromProps:t,createRenderState:e},r,n,s){return{latestValues:CH(r,n,s,t),renderState:e()}}function CH(t,e,r,n){const s={},a=n(t,{});for(const h in a)s[h]=Mx(a[h]);let{initial:i,animate:o}=t;const l=Ny(t),u=V7(t);e&&u&&!l&&t.inherit!==!1&&(i===void 0&&(i=e.initial),o===void 0&&(o=e.animate));let d=r?r.initial===!1:!1;d=d||i===!1;const g=d?o:i;if(g&&typeof g!="boolean"&&!Ey(g)){const h=Array.isArray(g)?g:[g];for(let p=0;p<h.length;p++){const x=AC(t,h[p]);if(x){const{transitionEnd:v,transition:w,...S}=x;for(const _ in S){let y=S[_];if(Array.isArray(y)){const k=d?y.length-1:0;y=y[k]}y!==null&&(s[_]=y)}for(const _ in v)s[_]=v[_]}}}return s}const q7=t=>(e,r)=>{const n=b.useContext(Ty),s=b.useContext(Cy),a=()=>kH(t,e,n,s);return r?a():eC(a)};function jC(t,e,r){var a;const{style:n}=t,s={};for(const i in n)(Ws(n[i])||e.style&&Ws(e.style[i])||K7(i,t)||((a=r==null?void 0:r.getValue(i))==null?void 0:a.liveStyle)!==void 0)&&(s[i]=n[i]);return s}const TH=q7({scrapeMotionValuesFromProps:jC,createRenderState:EC});function Z7(t,e,r){const n=jC(t,e,r);for(const s in t)if(Ws(t[s])||Ws(e[s])){const a=ch.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[a]=t[s]}return n}const EH=q7({scrapeMotionValuesFromProps:Z7,createRenderState:J7}),NH=Symbol.for("motionComponentSymbol");function cf(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function AH(t,e,r){return b.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),r&&(typeof r=="function"?r(n):cf(r)&&(r.current=n))},[e])}const FC=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),jH="framerAppearId",e9="data-"+FC(jH),t9=b.createContext({});function FH(t,e,r,n,s){var v,w;const{visualElement:a}=b.useContext(Ty),i=b.useContext(H7),o=b.useContext(Cy),l=b.useContext(SC).reducedMotion,u=b.useRef(null);n=n||i.renderer,!u.current&&n&&(u.current=n(t,{visualState:e,parent:a,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const d=u.current,g=b.useContext(t9);d&&!d.projection&&s&&(d.type==="html"||d.type==="svg")&&PH(u.current,r,s,g);const h=b.useRef(!1);b.useInsertionEffect(()=>{d&&h.current&&d.update(r,o)});const p=r[e9],x=b.useRef(!!p&&!((v=window.MotionHandoffIsComplete)!=null&&v.call(window,p))&&((w=window.MotionHasOptimisedAnimation)==null?void 0:w.call(window,p)));return qP(()=>{d&&(h.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),x.current&&d.animationState&&d.animationState.animateChanges())}),b.useEffect(()=>{d&&(!x.current&&d.animationState&&d.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var S;(S=window.MotionHandoffMarkAsComplete)==null||S.call(window,p)}),x.current=!1),d.enteringChildren=void 0)}),d}function PH(t,e,r,n){const{layoutId:s,layout:a,drag:i,dragConstraints:o,layoutScroll:l,layoutRoot:u,layoutCrossfade:d}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:r9(t.parent)),t.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!i||o&&cf(o),visualElement:t,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:d,layoutScroll:l,layoutRoot:u})}function r9(t){if(t)return t.options.allowProjection!==!1?t.projection:r9(t.parent)}function R_(t,{forwardMotionProps:e=!1}={},r,n){r&&aH(r);const s=NC(t)?EH:TH;function a(o,l){let u;const d={...b.useContext(SC),...o,layoutId:DH(o)},{isStatic:g}=d,h=uH(o),p=s(o,g);if(!g&&tC){RH();const x=MH(d);u=x.MeasureLayout,h.visualElement=FH(t,p,d,n,x.ProjectionNode)}return c.jsxs(Ty.Provider,{value:h,children:[u&&h.visualElement?c.jsx(u,{visualElement:h.visualElement,...d}):null,SH(t,o,AH(p,h.visualElement,l),p,g,e)]})}a.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const i=b.forwardRef(a);return i[NH]=t,i}function DH({layoutId:t}){const e=b.useContext(Zk).id;return e&&t!==void 0?e+"-"+t:t}function RH(t,e){b.useContext(H7).strict}function MH(t){const{drag:e,layout:r}=zf;if(!e&&!r)return{};const n={...e,...r};return{MeasureLayout:e!=null&&e.isEnabled(t)||r!=null&&r.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function LH(t,e){if(typeof Proxy>"u")return R_;const r=new Map,n=(a,i)=>R_(a,i,t,e),s=(a,i)=>n(a,i);return new Proxy(s,{get:(a,i)=>i==="create"?n:(r.has(i)||r.set(i,R_(i,void 0,t,e)),r.get(i))})}function n9({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function IH({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function OH(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function M_(t){return t===void 0||t===1}function zb({scale:t,scaleX:e,scaleY:r}){return!M_(t)||!M_(e)||!M_(r)}function su(t){return zb(t)||s9(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function s9(t){return QN(t.x)||QN(t.y)}function QN(t){return t&&t!=="0%"}function w1(t,e,r){const n=t-r,s=e*n;return r+s}function qN(t,e,r,n,s){return s!==void 0&&(t=w1(t,s,n)),w1(t,r,n)+e}function Hb(t,e=0,r=1,n,s){t.min=qN(t.min,e,r,n,s),t.max=qN(t.max,e,r,n,s)}function a9(t,{x:e,y:r}){Hb(t.x,e.translate,e.scale,e.originPoint),Hb(t.y,r.translate,r.scale,r.originPoint)}const ZN=.999999999999,e5=1.0000000000001;function BH(t,e,r,n=!1){const s=r.length;if(!s)return;e.x=e.y=1;let a,i;for(let o=0;o<s;o++){a=r[o],i=a.projectionDelta;const{visualElement:l}=a.options;l&&l.props.style&&l.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&df(t,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(e.x*=i.x.scale,e.y*=i.y.scale,a9(t,i)),n&&su(a.latestValues)&&df(t,a.latestValues))}e.x<e5&&e.x>ZN&&(e.x=1),e.y<e5&&e.y>ZN&&(e.y=1)}function uf(t,e){t.min=t.min+e,t.max=t.max+e}function t5(t,e,r,n,s=.5){const a=dn(t.min,t.max,s);Hb(t,e,r,a,n)}function df(t,e){t5(t.x,e.x,e.scaleX,e.scale,e.originX),t5(t.y,e.y,e.scaleY,e.scale,e.originY)}function i9(t,e){return n9(OH(t.getBoundingClientRect(),e))}function UH(t,e,r){const n=i9(t,r),{scroll:s}=e;return s&&(uf(n.x,s.offset.x),uf(n.y,s.offset.y)),n}const r5=()=>({translate:0,scale:1,origin:0,originPoint:0}),ff=()=>({x:r5(),y:r5()}),n5=()=>({min:0,max:0}),jn=()=>({x:n5(),y:n5()}),Gb={current:null},o9={current:!1};function $H(){if(o9.current=!0,!!tC)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Gb.current=t.matches;t.addEventListener("change",e),e()}else Gb.current=!1}const WH=new WeakMap;function zH(t,e,r){for(const n in e){const s=e[n],a=r[n];if(Ws(s))t.addValue(n,s);else if(Ws(a))t.addValue(n,Wf(s,{owner:t}));else if(a!==s)if(t.hasValue(n)){const i=t.getValue(n);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=t.getStaticValue(n);t.addValue(n,Wf(i!==void 0?i:s,{owner:t}))}}for(const n in r)e[n]===void 0&&t.removeValue(n);return e}const s5=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class HH{scrapeMotionValuesFromProps(e,r,n){return{}}constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:a,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=yC,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=_a.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,sn.render(this.render,!1,!0))};const{latestValues:l,renderState:u}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!a,this.isControllingVariants=Ny(r),this.isVariantNode=V7(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...g}=this.scrapeMotionValuesFromProps(r,{},this);for(const h in g){const p=g[h];l[h]!==void 0&&Ws(p)&&p.set(l[h])}}mount(e){var r;this.current=e,WH.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),o9.current||$H(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Gb.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),mc(this.notifyUpdate),mc(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const n=this.features[r];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=uh.has(e);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",i=>{this.latestValues[e]=i,this.props.onUpdate&&sn.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{s(),a&&a(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in zf){const r=zf[e];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[e]&&s&&n(this.props)&&(this.features[e]=new s(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):jn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<s5.length;n++){const s=s5[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a="on"+s,i=e[a];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=zH(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const n=this.values.get(e);r!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=Wf(r===null?void 0:r,{owner:this}),this.addValue(e,n)),n}readValue(e,r){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&(ZP(n)||t7(n))?n=parseFloat(n):!eH(n)&&pc.test(r)&&(n=L7(e,r)),this.setBaseTarget(e,Ws(n)?n.get():n)),Ws(n)?n.get():n}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var a;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const i=AC(this.props,r,(a=this.presenceContext)==null?void 0:a.custom);i&&(n=i[e])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Ws(s)?s:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new iC),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}scheduleRenderMicrotask(){_C.render(this.render)}}class l9 extends HH{constructor(){super(...arguments),this.KeyframeResolver=Wz}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ws(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function c9(t,{style:e,vars:r},n,s){const a=t.style;let i;for(i in e)a[i]=e[i];s==null||s.applyProjectionStyles(a,n);for(i in r)a.setProperty(i,r[i])}function GH(t){return window.getComputedStyle(t)}class VH extends l9{constructor(){super(...arguments),this.type="html",this.renderInstance=c9}readValueFromInstance(e,r){var n;if(uh.has(r))return(n=this.projection)!=null&&n.isProjecting?Lb(r):oz(e,r);{const s=GH(e),a=(cC(r)?s.getPropertyValue(r):s[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(e,{transformPagePoint:r}){return i9(e,r)}build(e,r,n){TC(e,r,n.transformTemplate)}scrapeMotionValuesFromProps(e,r,n){return jC(e,r,n)}}const u9=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function KH(t,e,r,n){c9(t,e,void 0,n);for(const s in e.attrs)t.setAttribute(u9.has(s)?s:FC(s),e.attrs[s])}class XH extends l9{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=jn}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(uh.has(r)){const n=M7(r);return n&&n.default||0}return r=u9.has(r)?r:FC(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,n){return Z7(e,r,n)}build(e,r,n){Y7(e,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,r,n,s){KH(e,r,n,s)}mount(e){this.isSVGTag=Q7(e.tagName),super.mount(e)}}const YH=(t,e)=>NC(t)?new XH(e):new VH(e,{allowProjection:t!==b.Fragment});function Sf(t,e,r){const n=t.getProps();return AC(n,e,r!==void 0?r:n.custom,t)}const Vb=t=>Array.isArray(t);function JH(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,Wf(r))}function QH(t){return Vb(t)?t[t.length-1]||0:t}function qH(t,e){const r=Sf(t,e);let{transitionEnd:n={},transition:s={},...a}=r||{};a={...a,...n};for(const i in a){const o=QH(a[i]);JH(t,i,o)}}function ZH(t){return!!(Ws(t)&&t.add)}function Kb(t,e){const r=t.getValue("willChange");if(ZH(r))return r.add(e);if(!r&&ml.WillChange){const n=new ml.WillChange("auto");t.addValue("willChange",n),n.add(e)}}function d9(t){return t.props[e9]}const eG=t=>t!==null;function tG(t,{repeat:e,repeatType:r="loop"},n){const s=t.filter(eG),a=e&&r!=="loop"&&e%2===1?0:s.length-1;return s[a]}const rG={type:"spring",stiffness:500,damping:25,restSpeed:10},nG=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),sG={type:"keyframes",duration:.8},aG={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},iG=(t,{keyframes:e})=>e.length>2?sG:uh.has(t)?t.startsWith("scale")?nG(e[1]):rG:aG;function oG({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:i,repeatDelay:o,from:l,elapsed:u,...d}){return!!Object.keys(d).length}const PC=(t,e,r,n={},s,a)=>i=>{const o=vC(n,t)||{},l=o.delay||n.delay||0;let{elapsed:u=0}=n;u=u-So(l);const d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-u,onUpdate:h=>{e.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:t,motionValue:e,element:a?void 0:s};oG(o)||Object.assign(d,iG(t,d)),d.duration&&(d.duration=So(d.duration)),d.repeatDelay&&(d.repeatDelay=So(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let g=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&($b(d),d.delay===0&&(g=!0)),(ml.instantAnimations||ml.skipAnimations)&&(g=!0,$b(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,g&&!a&&e.get()!==void 0){const h=tG(d.keyframes,o);if(h!==void 0){sn.update(()=>{d.onUpdate(h),d.onComplete()});return}}return o.isSync?new xC(d):new jz(d)};function lG({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function f9(t,e,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:a=t.getDefaultTransition(),transitionEnd:i,...o}=e;n&&(a=n);const l=[],u=s&&t.animationState&&t.animationState.getState()[s];for(const d in o){const g=t.getValue(d,t.latestValues[d]??null),h=o[d];if(h===void 0||u&&lG(u,d))continue;const p={delay:r,...vC(a||{},d)},x=g.get();if(x!==void 0&&!g.isAnimating&&!Array.isArray(h)&&h===x&&!p.velocity)continue;let v=!1;if(window.MotionHandoffAnimation){const S=d9(t);if(S){const _=window.MotionHandoffAnimation(S,d,sn);_!==null&&(p.startTime=_,v=!0)}}Kb(t,d),g.start(PC(d,g,h,t.shouldReduceMotion&&P7.has(d)?{type:!1}:p,t,v));const w=g.animation;w&&l.push(w)}return i&&Promise.all(l).then(()=>{sn.update(()=>{i&&qH(t,i)})}),l}function h9(t,e,r,n=0,s=1){const a=Array.from(t).sort((u,d)=>u.sortNodePosition(d)).indexOf(e),i=t.size,o=(i-1)*n;return typeof r=="function"?r(a,i):s===1?a*n:o-a*n}function Xb(t,e,r={}){var l;const n=Sf(t,e,r.type==="exit"?(l=t.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const a=n?()=>Promise.all(f9(t,n,r)):()=>Promise.resolve(),i=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:g,staggerDirection:h}=s;return cG(t,e,u,d,g,h,r)}:()=>Promise.resolve(),{when:o}=s;if(o){const[u,d]=o==="beforeChildren"?[a,i]:[i,a];return u().then(()=>d())}else return Promise.all([a(),i(r.delay)])}function cG(t,e,r=0,n=0,s=0,a=1,i){const o=[];for(const l of t.variantChildren)l.notify("AnimationStart",e),o.push(Xb(l,e,{...i,delay:r+(typeof n=="function"?0:n)+h9(t.variantChildren,l,n,s,a)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(o)}function uG(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const s=e.map(a=>Xb(t,a,r));n=Promise.all(s)}else if(typeof e=="string")n=Xb(t,e,r);else{const s=typeof e=="function"?Sf(t,e,r.custom):e;n=Promise.all(f9(t,s,r))}return n.then(()=>{t.notify("AnimationComplete",e)})}function g9(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}const dG=CC.length;function m9(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?m9(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<dG;r++){const n=CC[r],s=t.props[n];(bg(s)||s===!1)&&(e[n]=s)}return e}const fG=[...kC].reverse(),hG=kC.length;function gG(t){return e=>Promise.all(e.map(({animation:r,options:n})=>uG(t,r,n)))}function mG(t){let e=gG(t),r=a5(),n=!0;const s=l=>(u,d)=>{var h;const g=Sf(t,d,l==="exit"?(h=t.presenceContext)==null?void 0:h.custom:void 0);if(g){const{transition:p,transitionEnd:x,...v}=g;u={...u,...v,...x}}return u};function a(l){e=l(t)}function i(l){const{props:u}=t,d=m9(t.parent)||{},g=[],h=new Set;let p={},x=1/0;for(let w=0;w<hG;w++){const S=fG[w],_=r[S],y=u[S]!==void 0?u[S]:d[S],k=bg(y),N=S===l?_.isActive:null;N===!1&&(x=w);let E=y===d[S]&&y!==u[S]&&k;if(E&&n&&t.manuallyAnimateOnMount&&(E=!1),_.protectedKeys={...p},!_.isActive&&N===null||!y&&!_.prevProp||Ey(y)||typeof y=="boolean")continue;const A=pG(_.prevProp,y);let C=A||S===l&&_.isActive&&!E&&k||w>x&&k,F=!1;const D=Array.isArray(y)?y:[y];let R=D.reduce(s(S),{});N===!1&&(R={});const{prevResolvedValues:M={}}=_,B={...M,...R},J=H=>{C=!0,h.has(H)&&(F=!0,h.delete(H)),_.needsAnimating[H]=!0;const U=t.getValue(H);U&&(U.liveStyle=!1)};for(const H in B){const U=R[H],L=M[H];if(p.hasOwnProperty(H))continue;let ne=!1;Vb(U)&&Vb(L)?ne=!g9(U,L):ne=U!==L,ne?U!=null?J(H):h.add(H):U!==void 0&&h.has(H)?J(H):_.protectedKeys[H]=!0}_.prevProp=y,_.prevResolvedValues=R,_.isActive&&(p={...p,...R}),n&&t.blockInitialAnimation&&(C=!1);const X=E&&A;C&&(!X||F)&&g.push(...D.map(H=>{const U={type:S};if(typeof H=="string"&&n&&!X&&t.manuallyAnimateOnMount&&t.parent){const{parent:L}=t,ne=Sf(L,H);if(L.enteringChildren&&ne){const{delayChildren:de}=ne.transition||{};U.delay=h9(L.enteringChildren,t,de)}}return{animation:H,options:U}}))}if(h.size){const w={};if(typeof u.initial!="boolean"){const S=Sf(t,Array.isArray(u.initial)?u.initial[0]:u.initial);S&&S.transition&&(w.transition=S.transition)}h.forEach(S=>{const _=t.getBaseTarget(S),y=t.getValue(S);y&&(y.liveStyle=!0),w[S]=_??null}),g.push({animation:w})}let v=!!g.length;return n&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(v=!1),n=!1,v?e(g):Promise.resolve()}function o(l,u){var g;if(r[l].isActive===u)return Promise.resolve();(g=t.variantChildren)==null||g.forEach(h=>{var p;return(p=h.animationState)==null?void 0:p.setActive(l,u)}),r[l].isActive=u;const d=i(l);for(const h in r)r[h].protectedKeys={};return d}return{animateChanges:i,setActive:o,setAnimateFunction:a,getState:()=>r,reset:()=>{r=a5(),n=!0}}}function pG(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!g9(e,t):!1}function qc(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function a5(){return{animate:qc(!0),whileInView:qc(),whileHover:qc(),whileTap:qc(),whileDrag:qc(),whileFocus:qc(),exit:qc()}}class Nc{constructor(e){this.isMounted=!1,this.node=e}update(){}}class xG extends Nc{constructor(e){super(e),e.animationState||(e.animationState=mG(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Ey(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let yG=0;class vG extends Nc{constructor(){super(...arguments),this.id=yG++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const s=this.node.animationState.setActive("exit",!e);r&&!e&&s.then(()=>{r(this.id)})}mount(){const{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const wG={animation:{Feature:xG},exit:{Feature:vG}};function kg(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}function om(t){return{point:{x:t.pageX,y:t.pageY}}}const _G=t=>e=>bC(e)&&t(e,om(e));function O0(t,e,r,n){return kg(t,e,_G(r),n)}const p9=1e-4,bG=1-p9,SG=1+p9,x9=.01,kG=0-x9,CG=0+x9;function na(t){return t.max-t.min}function TG(t,e,r){return Math.abs(t-e)<=r}function i5(t,e,r,n=.5){t.origin=n,t.originPoint=dn(e.min,e.max,t.origin),t.scale=na(r)/na(e),t.translate=dn(r.min,r.max,t.origin)-t.originPoint,(t.scale>=bG&&t.scale<=SG||isNaN(t.scale))&&(t.scale=1),(t.translate>=kG&&t.translate<=CG||isNaN(t.translate))&&(t.translate=0)}function B0(t,e,r,n){i5(t.x,e.x,r.x,n?n.originX:void 0),i5(t.y,e.y,r.y,n?n.originY:void 0)}function o5(t,e,r){t.min=r.min+e.min,t.max=t.min+na(e)}function EG(t,e,r){o5(t.x,e.x,r.x),o5(t.y,e.y,r.y)}function l5(t,e,r){t.min=e.min-r.min,t.max=t.min+na(e)}function U0(t,e,r){l5(t.x,e.x,r.x),l5(t.y,e.y,r.y)}function ii(t){return[t("x"),t("y")]}const y9=({current:t})=>t?t.ownerDocument.defaultView:null,c5=(t,e)=>Math.abs(t-e);function NG(t,e){const r=c5(t.x,e.x),n=c5(t.y,e.y);return Math.sqrt(r**2+n**2)}class v9{constructor(e,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=I_(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,x=NG(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!x)return;const{point:v}=h,{timestamp:w}=ws;this.history.push({...v,timestamp:w});const{onStart:S,onMove:_}=this.handlers;p||(S&&S(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),_&&_(this.lastMoveEvent,h)},this.handlePointerMove=(h,p)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=L_(p,this.transformPagePoint),sn.update(this.updatePoint,!0)},this.handlePointerUp=(h,p)=>{this.end();const{onEnd:x,onSessionEnd:v,resumeAnimation:w}=this.handlers;if(this.dragSnapToOrigin&&w&&w(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const S=I_(h.type==="pointercancel"?this.lastMoveEventInfo:L_(p,this.transformPagePoint),this.history);this.startEvent&&x&&x(h,S),v&&v(h,S)},!bC(e))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=s||window;const o=om(e),l=L_(o,this.transformPagePoint),{point:u}=l,{timestamp:d}=ws;this.history=[{...u,timestamp:d}];const{onSessionStart:g}=r;g&&g(e,I_(l,this.history)),this.removeListeners=sm(O0(this.contextWindow,"pointermove",this.handlePointerMove),O0(this.contextWindow,"pointerup",this.handlePointerUp),O0(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),mc(this.updatePoint)}}function L_(t,e){return e?{point:e(t.point)}:t}function u5(t,e){return{x:t.x-e.x,y:t.y-e.y}}function I_({point:t},e){return{point:t,delta:u5(t,w9(e)),offset:u5(t,AG(e)),velocity:jG(e,.1)}}function AG(t){return t[0]}function w9(t){return t[t.length-1]}function jG(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const s=w9(t);for(;r>=0&&(n=t[r],!(s.timestamp-n.timestamp>So(e)));)r--;if(!n)return{x:0,y:0};const a=ko(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const i={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function FG(t,{min:e,max:r},n){return e!==void 0&&t<e?t=n?dn(e,t,n.min):Math.max(t,e):r!==void 0&&t>r&&(t=n?dn(r,t,n.max):Math.min(t,r)),t}function d5(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function PG(t,{top:e,left:r,bottom:n,right:s}){return{x:d5(t.x,r,s),y:d5(t.y,e,n)}}function f5(t,e){let r=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,n]=[n,r]),{min:r,max:n}}function DG(t,e){return{x:f5(t.x,e.x),y:f5(t.y,e.y)}}function RG(t,e){let r=.5;const n=na(t),s=na(e);return s>n?r=vg(e.min,e.max-n,t.min):n>s&&(r=vg(t.min,t.max-s,e.min)),gl(0,1,r)}function MG(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const Yb=.35;function LG(t=Yb){return t===!1?t=0:t===!0&&(t=Yb),{x:h5(t,"left","right"),y:h5(t,"top","bottom")}}function h5(t,e,r){return{min:g5(t,e),max:g5(t,r)}}function g5(t,e){return typeof t=="number"?t:t[e]||0}const IG=new WeakMap;class OG{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=jn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const a=g=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(om(g).point)},i=(g,h)=>{const{drag:p,dragPropagation:x,onDragStart:v}=this.getProps();if(p&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Vz(p),!this.openDragLock))return;this.latestPointerEvent=g,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ii(S=>{let _=this.getAxisMotionValue(S).get()||0;if(Co.test(_)){const{projection:y}=this.visualElement;if(y&&y.layout){const k=y.layout.layoutBox[S];k&&(_=na(k)*(parseFloat(_)/100))}}this.originPoint[S]=_}),v&&sn.postRender(()=>v(g,h)),Kb(this.visualElement,"transform");const{animationState:w}=this.visualElement;w&&w.setActive("whileDrag",!0)},o=(g,h)=>{this.latestPointerEvent=g,this.latestPanInfo=h;const{dragPropagation:p,dragDirectionLock:x,onDirectionLock:v,onDrag:w}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:S}=h;if(x&&this.currentDirection===null){this.currentDirection=BG(S),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",h.point,S),this.updateAxis("y",h.point,S),this.visualElement.render(),w&&w(g,h)},l=(g,h)=>{this.latestPointerEvent=g,this.latestPanInfo=h,this.stop(g,h),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>ii(g=>{var h;return this.getAnimationState(g)==="paused"&&((h=this.getAxisMotionValue(g).animation)==null?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new v9(e,{onSessionStart:a,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:n,contextWindow:y9(this.visualElement)})}stop(e,r){const n=e||this.latestPointerEvent,s=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!s||!n)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&sn.postRender(()=>o(n,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,n){const{drag:s}=this.getProps();if(!n||!Kp(e,s,this.currentDirection))return;const a=this.getAxisMotionValue(e);let i=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(i=FG(i,this.constraints[e],this.elastic[e])),a.set(i)}resolveConstraints(){var a;const{dragConstraints:e,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(a=this.visualElement.projection)==null?void 0:a.layout,s=this.constraints;e&&cf(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=PG(n.layoutBox,e):this.constraints=!1,this.elastic=LG(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&ii(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=MG(n.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!cf(e))return!1;const n=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=UH(n,s.root,this.visualElement.getTransformPagePoint());let i=DG(s.layout.layoutBox,a);if(r){const o=r(IH(i));this.hasMutatedConstraints=!!o,o&&(i=n9(o))}return i}startAnimation(e){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},u=ii(d=>{if(!Kp(d,r,this.currentDirection))return;let g=l&&l[d]||{};i&&(g={min:0,max:0});const h=s?200:1e6,p=s?40:1e7,x={type:"inertia",velocity:n?e[d]:0,bounceStiffness:h,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...a,...g};return this.startAxisValueAnimation(d,x)});return Promise.all(u).then(o)}startAxisValueAnimation(e,r){const n=this.getAxisMotionValue(e);return Kb(this.visualElement,e),n.start(PC(e,n,0,r,this.visualElement,!1))}stopAnimation(){ii(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ii(e=>{var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.pause()})}getAnimationState(e){var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){ii(r=>{const{drag:n}=this.getProps();if(!Kp(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:i,max:o}=s.layout.layoutBox[r];a.set(e[r]-dn(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!cf(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};ii(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const l=o.get();s[i]=RG({min:l,max:l},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),ii(i=>{if(!Kp(i,e,null))return;const o=this.getAxisMotionValue(i),{min:l,max:u}=this.constraints[i];o.set(dn(l,u,s[i]))})}addListeners(){if(!this.visualElement.current)return;IG.set(this.visualElement,this);const e=this.visualElement.current,r=O0(e,"pointerdown",l=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();cf(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),sn.read(n);const i=kg(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(ii(d=>{const g=this.getAxisMotionValue(d);g&&(this.originPoint[d]+=l[d].translate,g.set(g.get()+l[d].translate))}),this.visualElement.render())});return()=>{i(),r(),a(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:i=Yb,dragMomentum:o=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:i,dragMomentum:o}}}function Kp(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function BG(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class UG extends Nc{constructor(e){super(e),this.removeGroupControls=pi,this.removeListeners=pi,this.controls=new OG(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||pi}unmount(){this.removeGroupControls(),this.removeListeners()}}const m5=t=>(e,r)=>{t&&sn.postRender(()=>t(e,r))};class $G extends Nc{constructor(){super(...arguments),this.removePointerDownListener=pi}onPointerDown(e){this.session=new v9(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:y9(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:m5(e),onStart:m5(r),onMove:n,onEnd:(a,i)=>{delete this.session,s&&sn.postRender(()=>s(a,i))}}}mount(){this.removePointerDownListener=O0(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Lx={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function p5(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const a0={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Xt.test(t))t=parseFloat(t);else return t;const r=p5(t,e.target.x),n=p5(t,e.target.y);return`${r}% ${n}%`}},WG={correct:(t,{treeScale:e,projectionDelta:r})=>{const n=t,s=pc.parse(t);if(s.length>5)return n;const a=pc.createTransformer(t),i=typeof s[0]!="number"?1:0,o=r.x.scale*e.x,l=r.y.scale*e.y;s[0+i]/=o,s[1+i]/=l;const u=dn(o,l,.5);return typeof s[2+i]=="number"&&(s[2+i]/=u),typeof s[3+i]=="number"&&(s[3+i]/=u),a(s)}};let O_=!1;class zG extends b.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=e;dH(HG),a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),O_&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),Lx.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,{projection:i}=n;return i&&(i.isPresent=a,O_=!0,s||e.layoutDependency!==r||r===void 0||e.isPresent!==a?i.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?i.promote():i.relegate()||sn.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),_C.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=e;O_=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function _9(t){const[e,r]=z7(),n=b.useContext(Zk);return c.jsx(zG,{...t,layoutGroup:n,switchLayoutGroup:b.useContext(t9),isPresent:e,safeToRemove:r})}const HG={borderRadius:{...a0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:a0,borderTopRightRadius:a0,borderBottomLeftRadius:a0,borderBottomRightRadius:a0,boxShadow:WG};function GG(t,e,r){const n=Ws(t)?t:Wf(t);return n.start(PC("",n,e,r)),n.animation}const VG=(t,e)=>t.depth-e.depth;class KG{constructor(){this.children=[],this.isDirty=!1}add(e){rC(this.children,e),this.isDirty=!0}remove(e){nC(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(VG),this.isDirty=!1,this.children.forEach(e)}}function XG(t,e){const r=_a.now(),n=({timestamp:s})=>{const a=s-r;a>=e&&(mc(n),t(a-e))};return sn.setup(n,!0),()=>mc(n)}const b9=["TopLeft","TopRight","BottomLeft","BottomRight"],YG=b9.length,x5=t=>typeof t=="string"?parseFloat(t):t,y5=t=>typeof t=="number"||Xt.test(t);function JG(t,e,r,n,s,a){s?(t.opacity=dn(0,r.opacity??1,QG(n)),t.opacityExit=dn(e.opacity??1,0,qG(n))):a&&(t.opacity=dn(e.opacity??1,r.opacity??1,n));for(let i=0;i<YG;i++){const o=`border${b9[i]}Radius`;let l=v5(e,o),u=v5(r,o);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||y5(l)===y5(u)?(t[o]=Math.max(dn(x5(l),x5(u),n),0),(Co.test(u)||Co.test(l))&&(t[o]+="%")):t[o]=u}(e.rotate||r.rotate)&&(t.rotate=dn(e.rotate||0,r.rotate||0,n))}function v5(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const QG=S9(0,.5,c7),qG=S9(.5,.95,pi);function S9(t,e,r){return n=>n<t?0:n>e?1:r(vg(t,e,n))}function w5(t,e){t.min=e.min,t.max=e.max}function ei(t,e){w5(t.x,e.x),w5(t.y,e.y)}function _5(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function b5(t,e,r,n,s){return t-=e,t=w1(t,1/r,n),s!==void 0&&(t=w1(t,1/s,n)),t}function ZG(t,e=0,r=1,n=.5,s,a=t,i=t){if(Co.test(e)&&(e=parseFloat(e),e=dn(i.min,i.max,e/100)-i.min),typeof e!="number")return;let o=dn(a.min,a.max,n);t===a&&(o-=e),t.min=b5(t.min,e,r,o,s),t.max=b5(t.max,e,r,o,s)}function S5(t,e,[r,n,s],a,i){ZG(t,e[r],e[n],e[s],e.scale,a,i)}const eV=["x","scaleX","originX"],tV=["y","scaleY","originY"];function k5(t,e,r,n){S5(t.x,e,eV,r?r.x:void 0,n?n.x:void 0),S5(t.y,e,tV,r?r.y:void 0,n?n.y:void 0)}function C5(t){return t.translate===0&&t.scale===1}function k9(t){return C5(t.x)&&C5(t.y)}function T5(t,e){return t.min===e.min&&t.max===e.max}function rV(t,e){return T5(t.x,e.x)&&T5(t.y,e.y)}function E5(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function C9(t,e){return E5(t.x,e.x)&&E5(t.y,e.y)}function N5(t){return na(t.x)/na(t.y)}function A5(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class nV{constructor(){this.members=[]}add(e){rC(this.members,e),e.scheduleRender()}remove(e){if(nC(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(s=>e===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(e,r){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function sV(t,e,r){let n="";const s=t.x.translate/e.x,a=t.y.translate/e.y,i=(r==null?void 0:r.z)||0;if((s||a||i)&&(n=`translate3d(${s}px, ${a}px, ${i}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:u,rotate:d,rotateX:g,rotateY:h,skewX:p,skewY:x}=r;u&&(n=`perspective(${u}px) ${n}`),d&&(n+=`rotate(${d}deg) `),g&&(n+=`rotateX(${g}deg) `),h&&(n+=`rotateY(${h}deg) `),p&&(n+=`skewX(${p}deg) `),x&&(n+=`skewY(${x}deg) `)}const o=t.x.scale*e.x,l=t.y.scale*e.y;return(o!==1||l!==1)&&(n+=`scale(${o}, ${l})`),n||"none"}const B_=["","X","Y","Z"],aV=1e3;let iV=0;function U_(t,e,r,n){const{latestValues:s}=e;s[t]&&(r[t]=s[t],e.setStaticValue(t,0),n&&(n[t]=0))}function T9(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=d9(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:a}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",sn,!(s||a))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&T9(n)}function E9({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(i={},o=e==null?void 0:e()){this.id=iV++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(cV),this.nodes.forEach(hV),this.nodes.forEach(gV),this.nodes.forEach(uV)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new KG)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new iC),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const l=this.eventHandlers.get(i);l&&l.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=W7(i)&&!qz(i),this.instance=i;const{layoutId:o,layout:l,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),t){let d,g=0;const h=()=>this.root.updateBlockedByResize=!1;sn.read(()=>{g=window.innerWidth}),t(i,()=>{const p=window.innerWidth;p!==g&&(g=p,this.root.updateBlockedByResize=!0,d&&d(),d=XG(h,250),Lx.hasAnimatedSinceResize&&(Lx.hasAnimatedSinceResize=!1,this.nodes.forEach(P5)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||l)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:g,hasRelativeLayoutChanged:h,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||u.getDefaultTransition()||vV,{onLayoutAnimationStart:v,onLayoutAnimationComplete:w}=u.getProps(),S=!this.targetLayout||!C9(this.targetLayout,p),_=!g&&h;if(this.options.layoutRoot||this.resumeFrom||_||g&&(S||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const y={...vC(x,"layout"),onPlay:v,onComplete:w};(u.shouldReduceMotion||this.options.layoutRoot)&&(y.delay=0,y.type=!1),this.startAnimation(y),this.setAnimationOrigin(d,_)}else g||P5(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),mc(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(mV),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&T9(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const g=this.path[d];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(j5);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(F5);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(fV),this.nodes.forEach(oV),this.nodes.forEach(lV)):this.nodes.forEach(F5),this.clearAllSnapshots();const o=_a.now();ws.delta=gl(0,1e3/60,o-ws.timestamp),ws.timestamp=o,ws.isProcessing=!0,N_.update.process(ws),N_.preRender.process(ws),N_.render.process(ws),ws.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,_C.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(dV),this.sharedNodes.forEach(pV)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,sn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){sn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!na(this.snapshot.measuredBox.x)&&!na(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=jn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o&&this.instance){const l=n(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:l,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!k9(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;i&&this.instance&&(o||su(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return i&&(l=this.removeTransform(l)),wV(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:i}=this.options;if(!i)return jn();const o=i.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(_V))){const{scroll:d}=this.root;d&&(uf(o.x,d.offset.x),uf(o.y,d.offset.y))}return o}removeElementScroll(i){var l;const o=jn();if(ei(o,i),(l=this.scroll)!=null&&l.wasRoot)return o;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:g,options:h}=d;d!==this.root&&g&&h.layoutScroll&&(g.wasRoot&&ei(o,i),uf(o.x,g.offset.x),uf(o.y,g.offset.y))}return o}applyTransform(i,o=!1){const l=jn();ei(l,i);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&df(l,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),su(d.latestValues)&&df(l,d.latestValues)}return su(this.latestValues)&&df(l,this.latestValues),l}removeTransform(i){const o=jn();ei(o,i);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!su(u.latestValues))continue;zb(u.latestValues)&&u.updateSnapshot();const d=jn(),g=u.measurePageBox();ei(d,g),k5(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return su(this.latestValues)&&k5(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ws.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var h;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(i||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:g}=this.options;if(!(!this.layout||!(d||g))){if(this.resolvedRelativeTargetAt=ws.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=jn(),this.relativeTargetOrigin=jn(),U0(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),ei(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=jn(),this.targetWithTransforms=jn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),EG(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ei(this.target,this.layout.layoutBox),a9(this.target,this.targetDelta)):ei(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=jn(),this.relativeTargetOrigin=jn(),U0(this.relativeTargetOrigin,this.target,p.target),ei(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||zb(this.parent.latestValues)||s9(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var x;const i=this.getLead(),o=!!this.resumingFrom||this!==i;let l=!0;if((this.isProjectionDirty||(x=this.parent)!=null&&x.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===ws.timestamp&&(l=!1),l)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;ei(this.layoutCorrected,this.layout.layoutBox);const g=this.treeScale.x,h=this.treeScale.y;BH(this.layoutCorrected,this.treeScale,this.path,o),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=jn());const{target:p}=i;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(_5(this.prevProjectionDelta.x,this.projectionDelta.x),_5(this.prevProjectionDelta.y,this.projectionDelta.y)),B0(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==g||this.treeScale.y!==h||!A5(this.projectionDelta.x,this.prevProjectionDelta.x)||!A5(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),i){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ff(),this.projectionDelta=ff(),this.projectionDeltaWithTransform=ff()}setAnimationOrigin(i,o=!1){const l=this.snapshot,u=l?l.latestValues:{},d={...this.latestValues},g=ff();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=jn(),p=l?l.source:void 0,x=this.layout?this.layout.source:void 0,v=p!==x,w=this.getStack(),S=!w||w.members.length<=1,_=!!(v&&!S&&this.options.crossfade===!0&&!this.path.some(yV));this.animationProgress=0;let y;this.mixTargetDelta=k=>{const N=k/1e3;D5(g.x,i.x,N),D5(g.y,i.y,N),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(U0(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),xV(this.relativeTarget,this.relativeTargetOrigin,h,N),y&&rV(this.relativeTarget,y)&&(this.isProjectionDirty=!1),y||(y=jn()),ei(y,this.relativeTarget)),v&&(this.animationValues=d,JG(d,u,this.latestValues,N,_,S)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=N},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){var o,l,u;this.notifyListeners("animationStart"),(o=this.currentAnimation)==null||o.stop(),(u=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||u.stop(),this.pendingAnimation&&(mc(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=sn.update(()=>{Lx.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Wf(0)),this.currentAnimation=GG(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:d=>{this.mixTargetDelta(d),i.onUpdate&&i.onUpdate(d)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(aV),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:l,layout:u,latestValues:d}=i;if(!(!o||!l||!u)){if(this!==i&&this.layout&&u&&N9(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||jn();const g=na(this.layout.layoutBox.x);l.x.min=i.target.x.min,l.x.max=l.x.min+g;const h=na(this.layout.layoutBox.y);l.y.min=i.target.y.min,l.y.max=l.y.min+h}ei(o,l),df(o,d),B0(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new nV),this.sharedNodes.get(i).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var o;const{layoutId:i}=this.options;return i?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:i}=this.options;return i?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:l}=i;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const u={};l.z&&U_("z",i,u,this.animationValues);for(let d=0;d<B_.length;d++)U_(`rotate${B_[d]}`,i,u,this.animationValues),U_(`skew${B_[d]}`,i,u,this.animationValues);i.render();for(const d in u)i.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);i.scheduleRender()}applyProjectionStyles(i,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=Mx(o==null?void 0:o.pointerEvents)||"",i.transform=l?l(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=Mx(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!su(this.latestValues)&&(i.transform=l?l({},""):"none",this.hasProjected=!1);return}i.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let g=sV(this.projectionDeltaWithTransform,this.treeScale,d);l&&(g=l(d,g)),i.transform=g;const{x:h,y:p}=this.projectionDelta;i.transformOrigin=`${h.origin*100}% ${p.origin*100}% 0`,u.animationValues?i.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:i.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const x in Sg){if(d[x]===void 0)continue;const{correct:v,applyTo:w,isCSSVariable:S}=Sg[x],_=g==="none"?d[x]:v(d[x],u);if(w){const y=w.length;for(let k=0;k<y;k++)i[w[k]]=_}else S?this.options.visualElement.renderState.vars[x]=_:i[x]=_}this.options.layoutId&&(i.pointerEvents=u===this?Mx(o==null?void 0:o.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var o;return(o=i.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(j5),this.root.sharedNodes.clear()}}}function oV(t){t.updateLayout()}function lV(t){var r;const e=((r=t.resumeFrom)==null?void 0:r.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=t.layout,{animationType:a}=t.options,i=e.source!==t.layout.source;a==="size"?ii(g=>{const h=i?e.measuredBox[g]:e.layoutBox[g],p=na(h);h.min=n[g].min,h.max=h.min+p}):N9(a,e.layoutBox,n)&&ii(g=>{const h=i?e.measuredBox[g]:e.layoutBox[g],p=na(n[g]);h.max=h.min+p,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[g].max=t.relativeTarget[g].min+p)});const o=ff();B0(o,n,e.layoutBox);const l=ff();i?B0(l,t.applyTransform(s,!0),e.measuredBox):B0(l,n,e.layoutBox);const u=!k9(o);let d=!1;if(!t.resumeFrom){const g=t.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:h,layout:p}=g;if(h&&p){const x=jn();U0(x,e.layoutBox,h.layoutBox);const v=jn();U0(v,n,p.layoutBox),C9(x,v)||(d=!0),g.options.layoutRoot&&(t.relativeTarget=v,t.relativeTargetOrigin=x,t.relativeParent=g)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function cV(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function uV(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function dV(t){t.clearSnapshot()}function j5(t){t.clearMeasurements()}function F5(t){t.isLayoutDirty=!1}function fV(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function P5(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function hV(t){t.resolveTargetDelta()}function gV(t){t.calcProjection()}function mV(t){t.resetSkewAndRotation()}function pV(t){t.removeLeadSnapshot()}function D5(t,e,r){t.translate=dn(e.translate,0,r),t.scale=dn(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function R5(t,e,r,n){t.min=dn(e.min,r.min,n),t.max=dn(e.max,r.max,n)}function xV(t,e,r,n){R5(t.x,e.x,r.x,n),R5(t.y,e.y,r.y,n)}function yV(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const vV={duration:.45,ease:[.4,0,.1,1]},M5=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),L5=M5("applewebkit/")&&!M5("chrome/")?Math.round:pi;function I5(t){t.min=L5(t.min),t.max=L5(t.max)}function wV(t){I5(t.x),I5(t.y)}function N9(t,e,r){return t==="position"||t==="preserve-aspect"&&!TG(N5(e),N5(r),.2)}function _V(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const bV=E9({attachResizeListener:(t,e)=>kg(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),$_={current:void 0},A9=E9({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!$_.current){const t=new bV({});t.mount(window),t.setOptions({layoutScroll:!0}),$_.current=t}return $_.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),SV={pan:{Feature:$G},drag:{Feature:UG,ProjectionNode:A9,MeasureLayout:_9}};function O5(t,e,r){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,a=n[s];a&&sn.postRender(()=>a(e,om(e)))}class kV extends Nc{mount(){const{current:e}=this.node;e&&(this.unmount=Kz(e,(r,n)=>(O5(this.node,n,"Start"),s=>O5(this.node,s,"End"))))}unmount(){}}class CV extends Nc{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=sm(kg(this.node.current,"focus",()=>this.onFocus()),kg(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function B5(t,e,r){const{props:n}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),a=n[s];a&&sn.postRender(()=>a(e,om(e)))}class TV extends Nc{mount(){const{current:e}=this.node;e&&(this.unmount=Qz(e,(r,n)=>(B5(this.node,n,"Start"),(s,{success:a})=>B5(this.node,s,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Jb=new WeakMap,W_=new WeakMap,EV=t=>{const e=Jb.get(t.target);e&&e(t)},NV=t=>{t.forEach(EV)};function AV({root:t,...e}){const r=t||document;W_.has(r)||W_.set(r,{});const n=W_.get(r),s=JSON.stringify(e);return n[s]||(n[s]=new IntersectionObserver(NV,{root:t,...e})),n[s]}function jV(t,e,r){const n=AV(e);return Jb.set(t,r),n.observe(t),()=>{Jb.delete(t),n.unobserve(t)}}const FV={some:0,all:1};class PV extends Nc{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=e,i={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:FV[s]},o=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:g}=this.node.getProps(),h=u?d:g;h&&h(l)};return jV(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(DV(e,r))&&this.startObserver()}unmount(){}}function DV({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const RV={inView:{Feature:PV},tap:{Feature:TV},focus:{Feature:CV},hover:{Feature:kV}},MV={layout:{ProjectionNode:A9,MeasureLayout:_9}},LV={...wG,...RV,...SV,...MV},Be=LH(LV,YH),He=({children:t,variant:e="primary",size:r="md",onClick:n,disabled:s=!1,className:a="",...i})=>{const o="font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer",l={primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",success:"bg-green-600 hover:bg-green-700 text-white focus:ring-green-500",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500",warning:"bg-yellow-600 hover:bg-yellow-700 text-white focus:ring-yellow-500",outline:"bg-transparent text-blue-600 border-2 border-blue-600 hover:bg-blue-600 hover:text-white focus:ring-blue-500",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-500"},u={xs:"px-2 py-1 text-xs",sm:"px-2 py-1 text-xs sm:px-3 sm:py-1.5 sm:text-sm",md:"px-3 py-1.5 text-sm sm:px-4 sm:py-2 sm:text-base",lg:"px-4 py-2 text-base sm:px-6 sm:py-3 sm:text-lg",icon:"p-0 flex items-center justify-center"},d=s?"opacity-50 cursor-not-allowed":"";return c.jsx(Be.button,{className:`${o} ${l[e]} ${u[r]} ${d} ${a}`,onClick:n,disabled:s,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},...i,children:t})},nr=({size:t="md",color:e="blue",className:r=""})=>{const n={sm:"w-4 h-4",small:"w-4 h-4",md:"w-6 h-6",medium:"w-6 h-6",lg:"w-8 h-8",large:"w-8 h-8",xl:"w-12 h-12"},s={blue:"border-blue-600",green:"border-green-600",red:"border-red-600",yellow:"border-yellow-600",gray:"border-gray-600"};return c.jsx(Be.div,{className:`
        inline-block border-2 border-gray-300 border-t-current rounded-full animate-spin
        ${n[t]} ${s[e]} ${r}
      `,animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})},Xi=({type:t="info",message:e="",duration:r=3e3,closable:n=!0,onClose:s,className:a="",...i})=>{const[o,l]=b.useState(!0),[u,d]=b.useState(!1),g=b.useRef(null),h=b.useRef(null);b.useEffect(()=>{if(r>0)return h.current=setTimeout(()=>{p()},r),()=>{h.current&&clearTimeout(h.current)}},[r]);const p=b.useCallback(()=>{u||(d(!0),h.current&&clearTimeout(h.current),setTimeout(()=>{l(!1),s&&s()},300))},[u,s]),x=b.useCallback(S=>{S.key==="Escape"&&p()},[p]);if(!o)return null;const v=["notification",`notification-${t}`,o?"notification-visible":"",u?"notification-exiting":"",a].filter(Boolean).join(" "),w=()=>{switch(t){case"success":return"";case"error":return"";case"warning":return"";case"info":default:return""}};return c.jsx("div",{ref:g,className:v,role:"alert","aria-live":"polite",onKeyDown:x,tabIndex:-1,...i,children:c.jsxs("div",{className:"notification-content",children:[c.jsx("div",{className:"notification-icon","aria-hidden":"true",children:w()}),c.jsx("div",{className:"notification-body",children:c.jsx("div",{className:"notification-message",children:e})}),n&&c.jsx("button",{className:"notification-close",onClick:p,type:"button","aria-label":"Close notification",children:""})]})})},Ys=()=>{const[t,e]=b.useState([]),r=b.useCallback((a,i="info",o={})=>{const l=Date.now()+Math.random(),u={id:l,message:a,type:i,...o};return e(d=>[...d,u]),o.duration!==0&&setTimeout(()=>{n(l)},o.duration||3e3),l},[]),n=b.useCallback(a=>{e(i=>i.filter(o=>o.id!==a))},[]),s=b.useCallback(()=>{e([])},[]);return{notifications:t,showNotification:r,removeNotification:n,clearAllNotifications:s}},Ji=()=>{const[t,e]=b.useState(!1),[r,n]=b.useState(null),[s,a]=b.useState(null),i=b.useRef(null);b.useRef(new Map);const o=b.useRef(0),l=3,u=1e3,d=b.useCallback(()=>{i.current&&(i.current.abort(),i.current=null)},[]);b.useEffect(()=>d,[d]);const g=b.useCallback(async(z,H={})=>{try{e(!0),n(null),i.current=new AbortController;const U=H.method||"POST",L={method:U,headers:{"Content-Type":"application/json",...H.headers},signal:i.current.signal,...H};U!=="GET"&&U!=="HEAD"&&(L.body=JSON.stringify(H.data||{})),console.log(`[API] Making request to: ${z}`,L);const ne=await fetch(z,L);if(!ne.ok)throw new Error(`HTTP error! status: ${ne.status}`);const de=await ne.json();if(console.log("[API] Response received:",de),de.success)return a(de),o.current=0,de;throw new Error(de.error||de.message||"Request failed")}catch(U){if(U.name==="AbortError")return console.log("[API] Request was aborted"),null;if(console.error("[API] Request failed:",U),n(U.message||"Request failed"),o.current<l){o.current++;const L=u*Math.pow(2,o.current-1);return console.log(`[API] Retrying in ${L}ms (attempt ${o.current}/${l})`),await new Promise(ne=>setTimeout(ne,L)),g(z,H)}throw U}finally{e(!1),i.current=null}},[]),h=b.useCallback(async(z,H={})=>{try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");return await window.tokenManager.makeAuthenticatedRequest(z,H)}catch(U){throw console.error("[API] Authenticated request failed:",U),U}},[]),p=b.useCallback(async(z,H)=>{try{const U=`/.netlify/functions/get-test-questions?test_type=${z}&test_id=${H}`;console.log(`[API] Getting test info for ${z}_${H}`);const ne=await(await h(U)).json();if(ne.success)return console.log("[API] Test info retrieved successfully:",ne.test_info),ne.test_info;throw new Error(ne.error||"Failed to get test info")}catch(U){throw console.error("[API] Failed to get test info:",U),U}},[h]),x=b.useCallback(async(z,H)=>{try{const U=`/.netlify/functions/get-test-questions?test_type=${z}&test_id=${H}`;console.log(`[API] Getting test questions for ${z}_${H}`);const ne=await(await h(U)).json();if(ne.success)return console.log("[API] Test questions retrieved successfully:",ne.questions),ne.questions;throw new Error(ne.error||"Failed to get test questions")}catch(U){throw console.error("[API] Failed to get test questions:",U),U}},[h]),v=b.useCallback(async()=>{try{const z="/.netlify/functions/get-student-active-tests";console.log("[API] Loading student active tests");const U=await(await h(z)).json();if(U.success)return console.log("[API] Student active tests loaded successfully:",U.tests),U.tests;throw new Error(U.error||"Failed to load student active tests")}catch(z){throw console.error("[API] Failed to load student active tests:",z),z}},[h]),w=b.useCallback(async(z,H,U)=>{try{let L;switch(z){case"true_false":L="/.netlify/functions/submit-true-false-test";break;case"multiple_choice":L="/.netlify/functions/submit-multiple-choice-test";break;case"input":L="/.netlify/functions/submit-input-test";break;case"matching_type":L="/.netlify/functions/submit-matching-type-test";break;default:throw new Error(`Unknown test type: ${z}`)}console.log(`[API] Submitting ${z} test:`,U);const de=await(await h(L,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)})).json();if(de.success)return console.log("[API] Test submitted successfully:",de),de;throw new Error(de.error||"Failed to submit test")}catch(L){throw console.error("[API] Failed to submit test:",L),L}},[h]),S=b.useCallback(async z=>{try{const H="/.netlify/functions/save-multiple-choice-test";console.log("[API] Saving multiple choice test:",z);const L=await(await h(H,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)})).json();if(L.success)return console.log("[API] Multiple choice test saved successfully:",L),L;throw new Error(L.error||"Failed to save multiple choice test")}catch(H){throw console.error("[API] Failed to save multiple choice test:",H),H}},[h]),_=b.useCallback(async z=>{try{const H="/.netlify/functions/save-true-false-test";console.log("[API] Saving true/false test:",z);const L=await(await h(H,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)})).json();if(L.success)return console.log("[API] True/false test saved successfully:",L),L;throw new Error(L.error||"Failed to save true/false test")}catch(H){throw console.error("[API] Failed to save true/false test:",H),H}},[h]),y=b.useCallback(async z=>{try{const H="/.netlify/functions/save-input-test";console.log("[API] Saving input test:",z);const L=await(await h(H,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)})).json();if(L.success)return console.log("[API] Input test saved successfully:",L),L;throw new Error(L.error||"Failed to save input test")}catch(H){throw console.error("[API] Failed to save input test:",H),H}},[h]),k=b.useCallback(async z=>{try{const H="/.netlify/functions/assign-test";console.log("[API] Assigning test to classes:",z);const L=await(await h(H,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)})).json();if(L.success)return console.log("[API] Test assigned successfully:",L),L;throw new Error(L.error||"Failed to assign test")}catch(H){throw console.error("[API] Failed to assign test:",H),H}},[h]),N=b.useCallback(async()=>{try{const z="/.netlify/functions/get-teacher-active-tests";console.log("[API] Loading teacher active tests");const U=await(await h(z)).json();if(U.success)return console.log("[API] Teacher active tests loaded successfully:",U.tests),U.tests;throw new Error(U.error||"Failed to load teacher active tests")}catch(z){throw console.error("[API] Failed to load teacher active tests:",z),z}},[h]),E=b.useCallback(async()=>{try{const z="/.netlify/functions/get-all-users";console.log("[API] Getting all users");const U=await(await h(z)).json();if(U.success)return console.log("[API] All users loaded successfully:",U.users),U.users;throw new Error(U.error||"Failed to get all users")}catch(z){throw console.error("[API] Failed to get all users:",z),z}},[h]),A=b.useCallback(async()=>{try{const z="/.netlify/functions/get-all-teachers";console.log("[API] Getting all teachers");const U=await(await h(z)).json();if(U.success)return console.log("[API] All teachers loaded successfully:",U.teachers),U.teachers;throw new Error(U.error||"Failed to get all teachers")}catch(z){throw console.error("[API] Failed to get all teachers:",z),z}},[h]),C=b.useCallback(async()=>{try{const z="/.netlify/functions/get-all-subjects";console.log("[API] Getting all subjects");const U=await(await h(z)).json();if(U.success)return console.log("[API] All subjects loaded successfully:",U.subjects),U.subjects;throw new Error(U.error||"Failed to get all subjects")}catch(z){throw console.error("[API] Failed to get all subjects:",z),z}},[h]),F=b.useCallback(()=>{n(null)},[]),D=b.useCallback(()=>{a(null)},[]),R=b.useCallback(()=>{e(!1),n(null),a(null),o.current=0,d()},[d]),M=b.useCallback(async(z,H={})=>{const L=await(await h(z,{...H,method:"GET"})).json();if(L.success)return L;throw new Error(L.error||"Request failed")},[h]),B=b.useCallback(async(z,H,U={})=>{const ne=await(await h(z,{...U,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(H)})).json();if(ne.success)return ne;throw new Error(ne.error||"Request failed")},[h]),J=b.useCallback(async(z,H,U={})=>{const ne=await(await h(z,{...U,method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(H)})).json();if(ne.success)return ne;throw new Error(ne.error||"Request failed")},[h]),X=b.useCallback(async(z,H={})=>{const L=await(await h(z,{...H,method:"DELETE"})).json();if(L.success)return L;throw new Error(L.error||"Request failed")},[h]);return{loading:t,error:r,data:s,sendRequest:g,makeAuthenticatedRequest:h,get:M,post:B,put:J,delete:X,getTestInfo:p,getTestQuestions:x,loadStudentActiveTests:v,submitTest:w,saveMultipleChoiceTest:S,saveTrueFalseTest:_,saveInputTest:y,assignTestToClasses:k,loadTeacherActiveTests:N,getAllUsers:E,getAllTeachers:A,getAllSubjects:C,clearError:F,clearData:D,reset:R,cleanup:d}},IV="modulepreload",OV=function(t){return"/"+t},U5={},bu=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(r.map(l=>{if(l=OV(l),l in U5)return;U5[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":IV,u||(g.as="script"),g.crossOrigin="",g.href=l,o&&g.setAttribute("nonce",o),document.head.appendChild(g),u)return new Promise((h,p)=>{g.addEventListener("load",h),g.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})};var DC={exports:{}},Ay={},_1={},or={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof Gx<"u"?Gx:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(s){}).toString()),dblClickWindow:400,getAngle(s){return t.Konva.angleDeg?s*e:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var s;return(s=t.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(s){t.glob.Konva=s}};const n=s=>{t.Konva[s.prototype.getClassName()]=s};t._registerNode=n,t.Konva._injectGlobal(t.Konva)})(or);var yn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=or;class r{constructor(k=[1,0,0,1,0,0]){this.dirty=!1,this.m=k&&k.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(k){k.m[0]=this.m[0],k.m[1]=this.m[1],k.m[2]=this.m[2],k.m[3]=this.m[3],k.m[4]=this.m[4],k.m[5]=this.m[5]}point(k){const N=this.m;return{x:N[0]*k.x+N[2]*k.y+N[4],y:N[1]*k.x+N[3]*k.y+N[5]}}translate(k,N){return this.m[4]+=this.m[0]*k+this.m[2]*N,this.m[5]+=this.m[1]*k+this.m[3]*N,this}scale(k,N){return this.m[0]*=k,this.m[1]*=k,this.m[2]*=N,this.m[3]*=N,this}rotate(k){const N=Math.cos(k),E=Math.sin(k),A=this.m[0]*N+this.m[2]*E,C=this.m[1]*N+this.m[3]*E,F=this.m[0]*-E+this.m[2]*N,D=this.m[1]*-E+this.m[3]*N;return this.m[0]=A,this.m[1]=C,this.m[2]=F,this.m[3]=D,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(k,N){const E=this.m[0]+this.m[2]*N,A=this.m[1]+this.m[3]*N,C=this.m[2]+this.m[0]*k,F=this.m[3]+this.m[1]*k;return this.m[0]=E,this.m[1]=A,this.m[2]=C,this.m[3]=F,this}multiply(k){const N=this.m[0]*k.m[0]+this.m[2]*k.m[1],E=this.m[1]*k.m[0]+this.m[3]*k.m[1],A=this.m[0]*k.m[2]+this.m[2]*k.m[3],C=this.m[1]*k.m[2]+this.m[3]*k.m[3],F=this.m[0]*k.m[4]+this.m[2]*k.m[5]+this.m[4],D=this.m[1]*k.m[4]+this.m[3]*k.m[5]+this.m[5];return this.m[0]=N,this.m[1]=E,this.m[2]=A,this.m[3]=C,this.m[4]=F,this.m[5]=D,this}invert(){const k=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),N=this.m[3]*k,E=-this.m[1]*k,A=-this.m[2]*k,C=this.m[0]*k,F=k*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),D=k*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=N,this.m[1]=E,this.m[2]=A,this.m[3]=C,this.m[4]=F,this.m[5]=D,this}getMatrix(){return this.m}decompose(){const k=this.m[0],N=this.m[1],E=this.m[2],A=this.m[3],C=this.m[4],F=this.m[5],D=k*A-N*E,R={x:C,y:F,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(k!=0||N!=0){const M=Math.sqrt(k*k+N*N);R.rotation=N>0?Math.acos(k/M):-Math.acos(k/M),R.scaleX=M,R.scaleY=D/M,R.skewX=(k*E+N*A)/D,R.skewY=0}else if(E!=0||A!=0){const M=Math.sqrt(E*E+A*A);R.rotation=Math.PI/2-(A>0?Math.acos(-E/M):-Math.acos(E/M)),R.scaleX=D/M,R.scaleY=M,R.skewX=0,R.skewY=(k*E+N*A)/D}return R.rotation=t.Util._getRotation(R.rotation),R}}t.Transform=r;const n="[object Array]",s="[object Number]",a="[object String]",i="[object Boolean]",o=Math.PI/180,l=180/Math.PI,u="#",d="",g="0",h="Konva warning: ",p="Konva error: ",x="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},w=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let S=[];const _=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(y){setTimeout(y,60)};t.Util={_isElement(y){return!!(y&&y.nodeType==1)},_isFunction(y){return!!(y&&y.constructor&&y.call&&y.apply)},_isPlainObject(y){return!!y&&y.constructor===Object},_isArray(y){return Object.prototype.toString.call(y)===n},_isNumber(y){return Object.prototype.toString.call(y)===s&&!isNaN(y)&&isFinite(y)},_isString(y){return Object.prototype.toString.call(y)===a},_isBoolean(y){return Object.prototype.toString.call(y)===i},isObject(y){return y instanceof Object},isValidSelector(y){if(typeof y!="string")return!1;const k=y[0];return k==="#"||k==="."||k===k.toUpperCase()},_sign(y){return y===0||y>0?1:-1},requestAnimFrame(y){S.push(y),S.length===1&&_(function(){const k=S;S=[],k.forEach(function(N){N()})})},createCanvasElement(){const y=document.createElement("canvas");try{y.style=y.style||{}}catch{}return y},createImageElement(){return document.createElement("img")},_isInDocument(y){for(;y=y.parentNode;)if(y==document)return!0;return!1},_urlToImage(y,k){const N=t.Util.createImageElement();N.onload=function(){k(N)},N.src=y},_rgbToHex(y,k,N){return((1<<24)+(y<<16)+(k<<8)+N).toString(16).slice(1)},_hexToRgb(y){y=y.replace(u,d);const k=parseInt(y,16);return{r:k>>16&255,g:k>>8&255,b:k&255}},getRandomColor(){let y=(Math.random()*16777215<<0).toString(16);for(;y.length<6;)y=g+y;return u+y},getRGB(y){let k;return y in v?(k=v[y],{r:k[0],g:k[1],b:k[2]}):y[0]===u?this._hexToRgb(y.substring(1)):y.substr(0,4)===x?(k=w.exec(y.replace(/ /g,"")),{r:parseInt(k[1],10),g:parseInt(k[2],10),b:parseInt(k[3],10)}):{r:0,g:0,b:0}},colorToRGBA(y){return y=y||"black",t.Util._namedColorToRBA(y)||t.Util._hex3ColorToRGBA(y)||t.Util._hex4ColorToRGBA(y)||t.Util._hex6ColorToRGBA(y)||t.Util._hex8ColorToRGBA(y)||t.Util._rgbColorToRGBA(y)||t.Util._rgbaColorToRGBA(y)||t.Util._hslColorToRGBA(y)},_namedColorToRBA(y){const k=v[y.toLowerCase()];return k?{r:k[0],g:k[1],b:k[2],a:1}:null},_rgbColorToRGBA(y){if(y.indexOf("rgb(")===0){y=y.match(/rgb\(([^)]+)\)/)[1];const k=y.split(/ *, */).map(Number);return{r:k[0],g:k[1],b:k[2],a:1}}},_rgbaColorToRGBA(y){if(y.indexOf("rgba(")===0){y=y.match(/rgba\(([^)]+)\)/)[1];const k=y.split(/ *, */).map((N,E)=>N.slice(-1)==="%"?E===3?parseInt(N)/100:parseInt(N)/100*255:Number(N));return{r:k[0],g:k[1],b:k[2],a:k[3]}}},_hex8ColorToRGBA(y){if(y[0]==="#"&&y.length===9)return{r:parseInt(y.slice(1,3),16),g:parseInt(y.slice(3,5),16),b:parseInt(y.slice(5,7),16),a:parseInt(y.slice(7,9),16)/255}},_hex6ColorToRGBA(y){if(y[0]==="#"&&y.length===7)return{r:parseInt(y.slice(1,3),16),g:parseInt(y.slice(3,5),16),b:parseInt(y.slice(5,7),16),a:1}},_hex4ColorToRGBA(y){if(y[0]==="#"&&y.length===5)return{r:parseInt(y[1]+y[1],16),g:parseInt(y[2]+y[2],16),b:parseInt(y[3]+y[3],16),a:parseInt(y[4]+y[4],16)/255}},_hex3ColorToRGBA(y){if(y[0]==="#"&&y.length===4)return{r:parseInt(y[1]+y[1],16),g:parseInt(y[2]+y[2],16),b:parseInt(y[3]+y[3],16),a:1}},_hslColorToRGBA(y){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(y)){const[k,...N]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(y),E=Number(N[0])/360,A=Number(N[1])/100,C=Number(N[2])/100;let F,D,R;if(A===0)return R=C*255,{r:Math.round(R),g:Math.round(R),b:Math.round(R),a:1};C<.5?F=C*(1+A):F=C+A-C*A;const M=2*C-F,B=[0,0,0];for(let J=0;J<3;J++)D=E+1/3*-(J-1),D<0&&D++,D>1&&D--,6*D<1?R=M+(F-M)*6*D:2*D<1?R=F:3*D<2?R=M+(F-M)*(2/3-D)*6:R=M,B[J]=R*255;return{r:Math.round(B[0]),g:Math.round(B[1]),b:Math.round(B[2]),a:1}}},haveIntersection(y,k){return!(k.x>y.x+y.width||k.x+k.width<y.x||k.y>y.y+y.height||k.y+k.height<y.y)},cloneObject(y){const k={};for(const N in y)this._isPlainObject(y[N])?k[N]=this.cloneObject(y[N]):this._isArray(y[N])?k[N]=this.cloneArray(y[N]):k[N]=y[N];return k},cloneArray(y){return y.slice(0)},degToRad(y){return y*o},radToDeg(y){return y*l},_degToRad(y){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(y)},_radToDeg(y){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(y)},_getRotation(y){return e.Konva.angleDeg?t.Util.radToDeg(y):y},_capitalize(y){return y.charAt(0).toUpperCase()+y.slice(1)},throw(y){throw new Error(p+y)},error(y){console.error(p+y)},warn(y){e.Konva.showWarnings&&console.warn(h+y)},each(y,k){for(const N in y)k(N,y[N])},_inRange(y,k,N){return k<=y&&y<N},_getProjectionToSegment(y,k,N,E,A,C){let F,D,R;const M=(y-N)*(y-N)+(k-E)*(k-E);if(M==0)F=y,D=k,R=(A-N)*(A-N)+(C-E)*(C-E);else{const B=((A-y)*(N-y)+(C-k)*(E-k))/M;B<0?(F=y,D=k,R=(y-A)*(y-A)+(k-C)*(k-C)):B>1?(F=N,D=E,R=(N-A)*(N-A)+(E-C)*(E-C)):(F=y+B*(N-y),D=k+B*(E-k),R=(F-A)*(F-A)+(D-C)*(D-C))}return[F,D,R]},_getProjectionToLine(y,k,N){const E=t.Util.cloneObject(y);let A=Number.MAX_VALUE;return k.forEach(function(C,F){if(!N&&F===k.length-1)return;const D=k[(F+1)%k.length],R=t.Util._getProjectionToSegment(C.x,C.y,D.x,D.y,y.x,y.y),M=R[0],B=R[1],J=R[2];J<A&&(E.x=M,E.y=B,A=J)}),E},_prepareArrayForTween(y,k,N){const E=[],A=[];if(y.length>k.length){const F=k;k=y,y=F}for(let F=0;F<y.length;F+=2)E.push({x:y[F],y:y[F+1]});for(let F=0;F<k.length;F+=2)A.push({x:k[F],y:k[F+1]});const C=[];return A.forEach(function(F){const D=t.Util._getProjectionToLine(F,E,N);C.push(D.x),C.push(D.y)}),C},_prepareToStringify(y){let k;y.visitedByCircularReferenceRemoval=!0;for(const N in y)if(y.hasOwnProperty(N)&&y[N]&&typeof y[N]=="object"){if(k=Object.getOwnPropertyDescriptor(y,N),y[N].visitedByCircularReferenceRemoval||t.Util._isElement(y[N]))if(k.configurable)delete y[N];else return null;else if(t.Util._prepareToStringify(y[N])===null)if(k.configurable)delete y[N];else return null}return delete y.visitedByCircularReferenceRemoval,y},_assign(y,k){for(const N in k)y[N]=k[N];return y},_getFirstPointerId(y){return y.touches?y.changedTouches[0].identifier:y.pointerId||999},releaseCanvas(...y){e.Konva.releaseCanvasOnDestroy&&y.forEach(k=>{k.width=0,k.height=0})},drawRoundedRectPath(y,k,N,E){let A=0,C=0,F=0,D=0;typeof E=="number"?A=C=F=D=Math.min(E,k/2,N/2):(A=Math.min(E[0]||0,k/2,N/2),C=Math.min(E[1]||0,k/2,N/2),D=Math.min(E[2]||0,k/2,N/2),F=Math.min(E[3]||0,k/2,N/2)),y.moveTo(A,0),y.lineTo(k-C,0),y.arc(k-C,C,C,Math.PI*3/2,0,!1),y.lineTo(k,N-D),y.arc(k-D,N-D,D,0,Math.PI/2,!1),y.lineTo(F,N),y.arc(F,N-F,F,Math.PI/2,Math.PI,!1),y.lineTo(0,A),y.arc(A,A,A,Math.PI,Math.PI*3/2,!1)}}})(yn);var on={},zi={},al={};Object.defineProperty(al,"__esModule",{value:!0});al.HitContext=al.SceneContext=al.Context=void 0;const j9=yn,BV=or;function UV(t){const e=[],r=t.length,n=j9.Util;for(let s=0;s<r;s++){let a=t[s];n._isNumber(a)?a=Math.round(a*1e3)/1e3:n._isString(a)||(a=a+""),e.push(a)}return e}const $5=",",$V="(",WV=")",zV="([",HV="])",GV=";",VV="()",KV="=",W5=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],XV=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],YV=100;class jy{constructor(e){this.canvas=e,BV.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,r){let n=this.traceArr,s=n.length,a="",i,o,l,u;for(i=0;i<s;i++)o=n[i],l=o.method,l?(u=o.args,a+=l,e?a+=VV:j9.Util._isArray(u[0])?a+=zV+u.join($5)+HV:(r&&(u=u.map(d=>typeof d=="number"?Math.floor(d):d)),a+=$V+u.join($5)+WV)):(a+=o.property,e||(a+=KV+o.val)),a+=GV;return a}clearTrace(){this.traceArr=[]}_trace(e){let r=this.traceArr,n;r.push(e),n=r.length,n>=YV&&r.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const r=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,r.getWidth()/r.pixelRatio,r.getHeight()/r.pixelRatio)}_applyLineCap(e){const r=e.attrs.lineCap;r&&this.setAttr("lineCap",r)}_applyOpacity(e){const r=e.getAbsoluteOpacity();r!==1&&this.setAttr("globalAlpha",r)}_applyLineJoin(e){const r=e.attrs.lineJoin;r&&this.setAttr("lineJoin",r)}setAttr(e,r){this._context[e]=r}arc(e,r,n,s,a,i){this._context.arc(e,r,n,s,a,i)}arcTo(e,r,n,s,a){this._context.arcTo(e,r,n,s,a)}beginPath(){this._context.beginPath()}bezierCurveTo(e,r,n,s,a,i){this._context.bezierCurveTo(e,r,n,s,a,i)}clearRect(e,r,n,s){this._context.clearRect(e,r,n,s)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,r){const n=arguments;if(n.length===2)return this._context.createImageData(e,r);if(n.length===1)return this._context.createImageData(e)}createLinearGradient(e,r,n,s){return this._context.createLinearGradient(e,r,n,s)}createPattern(e,r){return this._context.createPattern(e,r)}createRadialGradient(e,r,n,s,a,i){return this._context.createRadialGradient(e,r,n,s,a,i)}drawImage(e,r,n,s,a,i,o,l,u){const d=arguments,g=this._context;d.length===3?g.drawImage(e,r,n):d.length===5?g.drawImage(e,r,n,s,a):d.length===9&&g.drawImage(e,r,n,s,a,i,o,l,u)}ellipse(e,r,n,s,a,i,o,l){this._context.ellipse(e,r,n,s,a,i,o,l)}isPointInPath(e,r,n,s){return n?this._context.isPointInPath(n,e,r,s):this._context.isPointInPath(e,r,s)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,r,n,s){this._context.fillRect(e,r,n,s)}strokeRect(e,r,n,s){this._context.strokeRect(e,r,n,s)}fillText(e,r,n,s){s?this._context.fillText(e,r,n,s):this._context.fillText(e,r,n)}measureText(e){return this._context.measureText(e)}getImageData(e,r,n,s){return this._context.getImageData(e,r,n,s)}lineTo(e,r){this._context.lineTo(e,r)}moveTo(e,r){this._context.moveTo(e,r)}rect(e,r,n,s){this._context.rect(e,r,n,s)}roundRect(e,r,n,s,a){this._context.roundRect(e,r,n,s,a)}putImageData(e,r,n){this._context.putImageData(e,r,n)}quadraticCurveTo(e,r,n,s){this._context.quadraticCurveTo(e,r,n,s)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,r){this._context.scale(e,r)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,r,n,s,a,i){this._context.setTransform(e,r,n,s,a,i)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,r,n,s){this._context.strokeText(e,r,n,s)}transform(e,r,n,s,a,i){this._context.transform(e,r,n,s,a,i)}translate(e,r){this._context.translate(e,r)}_enableTrace(){let e=this,r=W5.length,n=this.setAttr,s,a;const i=function(o){let l=e[o],u;e[o]=function(){return a=UV(Array.prototype.slice.call(arguments,0)),u=l.apply(e,arguments),e._trace({method:o,args:a}),u}};for(s=0;s<r;s++)i(W5[s]);e.setAttr=function(){n.apply(e,arguments);const o=arguments[0];let l=arguments[1];(o==="shadowOffsetX"||o==="shadowOffsetY"||o==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),e._trace({property:o,val:l})}}_applyGlobalCompositeOperation(e){const r=e.attrs.globalCompositeOperation;!r||r==="source-over"||this.setAttr("globalCompositeOperation",r)}}al.Context=jy;XV.forEach(function(t){Object.defineProperty(jy.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})});class JV extends jy{constructor(e,{willReadFrequently:r=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:r})}_fillColor(e){const r=e.fill();this.setAttr("fillStyle",r),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const r=e._getLinearGradient();r&&(this.setAttr("fillStyle",r),e._fillFunc(this))}_fillRadialGradient(e){const r=e._getRadialGradient();r&&(this.setAttr("fillStyle",r),e._fillFunc(this))}_fill(e){const r=e.fill(),n=e.getFillPriority();if(r&&n==="color"){this._fillColor(e);return}const s=e.getFillPatternImage();if(s&&n==="pattern"){this._fillPattern(e);return}const a=e.getFillLinearGradientColorStops();if(a&&n==="linear-gradient"){this._fillLinearGradient(e);return}const i=e.getFillRadialGradientColorStops();if(i&&n==="radial-gradient"){this._fillRadialGradient(e);return}r?this._fillColor(e):s?this._fillPattern(e):a?this._fillLinearGradient(e):i&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const r=e.getStrokeLinearGradientStartPoint(),n=e.getStrokeLinearGradientEndPoint(),s=e.getStrokeLinearGradientColorStops(),a=this.createLinearGradient(r.x,r.y,n.x,n.y);if(s){for(let i=0;i<s.length;i+=2)a.addColorStop(s[i],s[i+1]);this.setAttr("strokeStyle",a)}}_stroke(e){const r=e.dash(),n=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!n){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e),r&&e.dashEnabled()&&(this.setLineDash(r),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),n||this.restore()}}_applyShadow(e){var r,n,s;const a=(r=e.getShadowRGBA())!==null&&r!==void 0?r:"black",i=(n=e.getShadowBlur())!==null&&n!==void 0?n:5,o=(s=e.getShadowOffset())!==null&&s!==void 0?s:{x:0,y:0},l=e.getAbsoluteScale(),u=this.canvas.getPixelRatio(),d=l.x*u,g=l.y*u;this.setAttr("shadowColor",a),this.setAttr("shadowBlur",i*Math.min(Math.abs(d),Math.abs(g))),this.setAttr("shadowOffsetX",o.x*d),this.setAttr("shadowOffsetY",o.y*g)}}al.SceneContext=JV;class QV extends jy{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const r=e.getStrokeScaleEnabled();if(!r){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e);const n=e.hitStrokeWidth(),s=n==="auto"?e.strokeWidth():n;this.setAttr("lineWidth",s),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),r||this.restore()}}}al.HitContext=QV;Object.defineProperty(zi,"__esModule",{value:!0});zi.HitCanvas=zi.SceneCanvas=zi.Canvas=void 0;const b1=yn,F9=al,P9=or;let Xp;function qV(){if(Xp)return Xp;const t=b1.Util.createCanvasElement(),e=t.getContext("2d");return Xp=function(){const r=P9.Konva._global.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return r/n}(),b1.Util.releaseCanvas(t),Xp}class RC{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const n=(e||{}).pixelRatio||P9.Konva.pixelRatio||qV();this.pixelRatio=n,this._canvas=b1.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const r=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/r,this.getHeight()/r)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,r){this.setWidth(e||0),this.setHeight(r||0)}toDataURL(e,r){try{return this._canvas.toDataURL(e,r)}catch{try{return this._canvas.toDataURL()}catch(s){return b1.Util.error("Unable to get data URL. "+s.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}zi.Canvas=RC;class ZV extends RC{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new F9.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}zi.SceneCanvas=ZV;class eK extends RC{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new F9.HitContext(this),this.setSize(e.width,e.height)}}zi.HitCanvas=eK;var Fy={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=or,r=yn;t.DD={get isDragging(){let n=!1;return t.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return t.DD._dragElements.forEach(s=>{n=s.node}),n},_dragElements:new Map,_drag(n){const s=[];t.DD._dragElements.forEach((a,i)=>{const{node:o}=a,l=o.getStage();l.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const u=l._changedPointerPositions.find(d=>d.id===a.pointerId);if(u){if(a.dragStatus!=="dragging"){const d=o.dragDistance();if(Math.max(Math.abs(u.x-a.startPointerPos.x),Math.abs(u.y-a.startPointerPos.y))<d||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),s.push(o)}}),s.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const s=[];t.DD._dragElements.forEach(a=>{const{node:i}=a,o=i.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(d=>d.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,a.dragStatus="stopped");const u=a.node.getLayer()||a.node instanceof e.Konva.Stage&&a.node;u&&s.indexOf(u)===-1&&s.push(u)}),s.forEach(a=>{a.draw()})},_endDragAfter(n){t.DD._dragElements.forEach((s,a)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:n},!0),s.dragStatus!=="dragging"&&t.DD._dragElements.delete(a)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))})(Fy);var dr={},Jt={};Object.defineProperty(Jt,"__esModule",{value:!0});Jt.RGBComponent=tK;Jt.alphaComponent=rK;Jt.getNumberValidator=nK;Jt.getNumberOrArrayOfNumbersValidator=sK;Jt.getNumberOrAutoValidator=aK;Jt.getStringValidator=iK;Jt.getStringOrGradientValidator=oK;Jt.getFunctionValidator=lK;Jt.getNumberArrayValidator=cK;Jt.getBooleanValidator=uK;Jt.getComponentValidator=dK;const wl=or,kn=yn;function _l(t){return kn.Util._isString(t)?'"'+t+'"':Object.prototype.toString.call(t)==="[object Number]"||kn.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function tK(t){return t>255?255:t<0?0:Math.round(t)}function rK(t){return t>1?1:t<1e-4?1e-4:t}function nK(){if(wl.Konva.isUnminified)return function(t,e){return kn.Util._isNumber(t)||kn.Util.warn(_l(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function sK(t){if(wl.Konva.isUnminified)return function(e,r){let n=kn.Util._isNumber(e),s=kn.Util._isArray(e)&&e.length==t;return!n&&!s&&kn.Util.warn(_l(e)+' is a not valid value for "'+r+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function aK(){if(wl.Konva.isUnminified)return function(t,e){return kn.Util._isNumber(t)||t==="auto"||kn.Util.warn(_l(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function iK(){if(wl.Konva.isUnminified)return function(t,e){return kn.Util._isString(t)||kn.Util.warn(_l(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function oK(){if(wl.Konva.isUnminified)return function(t,e){const r=kn.Util._isString(t),n=Object.prototype.toString.call(t)==="[object CanvasGradient]"||t&&t.addColorStop;return r||n||kn.Util.warn(_l(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function lK(){if(wl.Konva.isUnminified)return function(t,e){return kn.Util._isFunction(t)||kn.Util.warn(_l(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}function cK(){if(wl.Konva.isUnminified)return function(t,e){const r=Int8Array?Object.getPrototypeOf(Int8Array):null;return r&&t instanceof r||(kn.Util._isArray(t)?t.forEach(function(n){kn.Util._isNumber(n)||kn.Util.warn('"'+e+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):kn.Util.warn(_l(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}}function uK(){if(wl.Konva.isUnminified)return function(t,e){return t===!0||t===!1||kn.Util.warn(_l(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}function dK(t){if(wl.Konva.isUnminified)return function(e,r){return e==null||kn.Util.isObject(e)||kn.Util.warn(_l(e)+' is a not valid value for "'+r+'" attribute. The value should be an object with properties '+t),e}}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=yn,r=Jt,n="get",s="set";t.Factory={addGetterSetter(a,i,o,l,u){t.Factory.addGetter(a,i,o),t.Factory.addSetter(a,i,l,u),t.Factory.addOverloadedGetterSetter(a,i)},addGetter(a,i,o){const l=n+e.Util._capitalize(i);a.prototype[l]=a.prototype[l]||function(){const u=this.attrs[i];return u===void 0?o:u}},addSetter(a,i,o,l){const u=s+e.Util._capitalize(i);a.prototype[u]||t.Factory.overWriteSetter(a,i,o,l)},overWriteSetter(a,i,o,l){const u=s+e.Util._capitalize(i);a.prototype[u]=function(d){return o&&d!==void 0&&d!==null&&(d=o.call(this,d,i)),this._setAttr(i,d),l&&l.call(this),this}},addComponentsGetterSetter(a,i,o,l,u){const d=o.length,g=e.Util._capitalize,h=n+g(i),p=s+g(i);a.prototype[h]=function(){const v={};for(let w=0;w<d;w++){const S=o[w];v[S]=this.getAttr(i+g(S))}return v};const x=(0,r.getComponentValidator)(o);a.prototype[p]=function(v){const w=this.attrs[i];l&&(v=l.call(this,v,i)),x&&x.call(this,v,i);for(const S in v)v.hasOwnProperty(S)&&this._setAttr(i+g(S),v[S]);return v||o.forEach(S=>{this._setAttr(i+g(S),void 0)}),this._fireChangeEvent(i,w,v),u&&u.call(this),this},t.Factory.addOverloadedGetterSetter(a,i)},addOverloadedGetterSetter(a,i){const o=e.Util._capitalize(i),l=s+o,u=n+o;a.prototype[i]=function(){return arguments.length?(this[l](arguments[0]),this):this[u]()}},addDeprecatedGetterSetter(a,i,o,l){e.Util.error("Adding deprecated "+i);const u=n+e.Util._capitalize(i),d=i+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[u]=function(){e.Util.error(d);const g=this.attrs[i];return g===void 0?o:g},t.Factory.addSetter(a,i,l,function(){e.Util.error(d)}),t.Factory.addOverloadedGetterSetter(a,i)},backCompat(a,i){e.Util.each(i,function(o,l){const u=a.prototype[l],d=n+e.Util._capitalize(o),g=s+e.Util._capitalize(o);function h(){u.apply(this,arguments),e.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}a.prototype[o]=h,a.prototype[d]=h,a.prototype[g]=h})},afterSetFilter(){this._filterUpToDate=!1}}})(dr);Object.defineProperty(on,"__esModule",{value:!0});on.Node=void 0;const Md=zi,ti=Fy,lm=dr,Bl=or,gr=yn,Rn=Jt,Ix="absoluteOpacity",Yp="allEventListeners",Go="absoluteTransform",z5="absoluteScale",Zc="canvas",fK="Change",hK="children",gK="konva",Qb="listening",mK="mouseenter",pK="mouseleave",xK="pointerenter",yK="pointerleave",vK="touchenter",wK="touchleave",H5="set",G5="Shape",Ox=" ",V5="stage",Wl="transform",_K="Stage",qb="visible",bK=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Ox);let SK=1;class Zt{constructor(e){this._id=SK++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===Wl||e===Go)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,r){let n=this._cache.get(e);return(n===void 0||(e===Wl||e===Go)&&n.dirty===!0)&&(n=r.call(this),this._cache.set(e,n)),n}_calculate(e,r,n){if(!this._attachedDepsListeners.get(e)){const s=r.map(a=>a+"Change.konva").join(Ox);this.on(s,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,n)}_getCanvasCache(){return this._cache.get(Zc)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Go&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Zc)){const{scene:e,filter:r,hit:n,buffer:s}=this._cache.get(Zc);gr.Util.releaseCanvas(e,r,n,s),this._cache.delete(Zc)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const r=e||{};let n={};(r.x===void 0||r.y===void 0||r.width===void 0||r.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let s=Math.ceil(r.width||n.width),a=Math.ceil(r.height||n.height),i=r.pixelRatio,o=r.x===void 0?Math.floor(n.x):r.x,l=r.y===void 0?Math.floor(n.y):r.y,u=r.offset||0,d=r.drawBorder||!1,g=r.hitCanvasPixelRatio||1;if(!s||!a){gr.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const h=Math.abs(Math.round(n.x)-o)>.5?1:0,p=Math.abs(Math.round(n.y)-l)>.5?1:0;s+=u*2+h,a+=u*2+p,o-=u,l-=u;const x=new Md.SceneCanvas({pixelRatio:i,width:s,height:a}),v=new Md.SceneCanvas({pixelRatio:i,width:0,height:0,willReadFrequently:!0}),w=new Md.HitCanvas({pixelRatio:g,width:s,height:a}),S=x.getContext(),_=w.getContext(),y=new Md.SceneCanvas({width:x.width/x.pixelRatio+Math.abs(o),height:x.height/x.pixelRatio+Math.abs(l),pixelRatio:x.pixelRatio}),k=y.getContext();return w.isCache=!0,x.isCache=!0,this._cache.delete(Zc),this._filterUpToDate=!1,r.imageSmoothingEnabled===!1&&(x.getContext()._context.imageSmoothingEnabled=!1,v.getContext()._context.imageSmoothingEnabled=!1),S.save(),_.save(),k.save(),S.translate(-o,-l),_.translate(-o,-l),k.translate(-o,-l),y.x=o,y.y=l,this._isUnderCache=!0,this._clearSelfAndDescendantCache(Ix),this._clearSelfAndDescendantCache(z5),this.drawScene(x,this,y),this.drawHit(w,this),this._isUnderCache=!1,S.restore(),_.restore(),d&&(S.save(),S.beginPath(),S.rect(0,0,s,a),S.closePath(),S.setAttr("strokeStyle","red"),S.setAttr("lineWidth",5),S.stroke(),S.restore()),this._cache.set(Zc,{scene:x,filter:v,hit:w,buffer:y,x:o,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(Zc)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,r){const n=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let s=1/0,a=1/0,i=-1/0,o=-1/0;const l=this.getAbsoluteTransform(r);return n.forEach(function(u){const d=l.point(u);s===void 0&&(s=i=d.x,a=o=d.y),s=Math.min(s,d.x),a=Math.min(a,d.y),i=Math.max(i,d.x),o=Math.max(o,d.y)}),{x:s,y:a,width:i-s,height:o-a}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const r=this._getCanvasCache();e.translate(r.x,r.y);const n=this._getCachedSceneCanvas(),s=n.pixelRatio;e.drawImage(n._canvas,0,0,n.width/s,n.height/s),e.restore()}_drawCachedHitCanvas(e){const r=this._getCanvasCache(),n=r.hit;e.save(),e.translate(r.x,r.y),e.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),r=this._getCanvasCache(),n=r.scene,s=r.filter,a=s.getContext(),i,o,l,u;if(e){if(!this._filterUpToDate){const d=n.pixelRatio;s.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(i=e.length,a.clear(),a.drawImage(n._canvas,0,0,n.getWidth()/d,n.getHeight()/d),o=a.getImageData(0,0,s.getWidth(),s.getHeight()),l=0;l<i;l++){if(u=e[l],typeof u!="function"){gr.Util.error("Filter should be type of function, but got "+typeof u+" instead. Please check correct filters");continue}u.call(this,o),a.putImageData(o,0,0)}}catch(g){gr.Util.error("Unable to apply filter. "+g.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return s}return n}on(e,r){if(this._cache&&this._cache.delete(Yp),arguments.length===3)return this._delegate.apply(this,arguments);const n=e.split(Ox);for(let s=0;s<n.length;s++){const i=n[s].split("."),o=i[0],l=i[1]||"";this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:l,handler:r})}return this}off(e,r){let n=(e||"").split(Ox),s=n.length,a,i,o,l,u,d;if(this._cache&&this._cache.delete(Yp),!e)for(i in this.eventListeners)this._off(i);for(a=0;a<s;a++)if(o=n[a],l=o.split("."),u=l[0],d=l[1],u)this.eventListeners[u]&&this._off(u,d,r);else for(i in this.eventListeners)this._off(i,d,r);return this}dispatchEvent(e){const r={target:this,type:e.type,evt:e};return this.fire(e.type,r),this}addEventListener(e,r){return this.on(e,function(n){r.call(this,n.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,r,n){const s=this;this.on(e,function(a){const i=a.target.findAncestors(r,!0,s);for(let o=0;o<i.length;o++)a=gr.Util.cloneObject(a),a.currentTarget=i[o],n.call(i[o],a)})}remove(){return this.isDragging()&&this.stopDrag(),ti.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Go),this._clearSelfAndDescendantCache(Ix),this._clearSelfAndDescendantCache(z5),this._clearSelfAndDescendantCache(V5),this._clearSelfAndDescendantCache(qb),this._clearSelfAndDescendantCache(Qb)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const r="get"+gr.Util._capitalize(e);return gr.Util._isFunction(this[r])?this[r]():this.attrs[e]}getAncestors(){let e=this.getParent(),r=[];for(;e;)r.push(e),e=e.getParent();return r}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let r,n;if(!e)return this;for(r in e)r!==hK&&(n=H5+gr.Util._capitalize(r),gr.Util._isFunction(this[n])?this[n](e[r]):this._setAttr(r,e[r]))}),this}isListening(){return this._getCache(Qb,this._isListening)}_isListening(e){if(!this.listening())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isListening(e):!0}isVisible(){return this._getCache(qb,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isVisible(e):!0}shouldDrawHit(e,r=!1){if(e)return this._isVisible(e)&&this._isListening(e);const n=this.getLayer();let s=!1;ti.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(i.node.nodeType==="Stage"||i.node.getLayer()===n)&&(s=!0)});const a=!r&&!Bl.Konva.hitOnDragEnabled&&(s||Bl.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!a}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),r=this,n=0,s,a,i,o;function l(d){for(s=[],a=d.length,i=0;i<a;i++)o=d[i],n++,o.nodeType!==G5&&(s=s.concat(o.getChildren().slice())),o._id===r._id&&(i=a);s.length>0&&s[0].getDepth()<=e&&l(s)}const u=this.getStage();return r.nodeType!==_K&&u&&l(u.getChildren()),n}getDepth(){let e=0,r=this.parent;for(;r;)e++,r=r.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Wl),this._clearSelfAndDescendantCache(Go)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const r=e.getPointerPosition();if(!r)return null;const n=this.getAbsoluteTransform().copy();return n.invert(),n.point(r)}getAbsolutePosition(e){let r=!1,n=this.parent;for(;n;){if(n.isCached()){r=!0;break}n=n.parent}r&&!e&&(e=!0);const s=this.getAbsoluteTransform(e).getMatrix(),a=new gr.Transform,i=this.offset();return a.m=s.slice(),a.translate(i.x,i.y),a.getTranslation()}setAbsolutePosition(e){const{x:r,y:n,...s}=this._clearTransform();this.attrs.x=r,this.attrs.y=n,this._clearCache(Wl);const a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(e.x,e.y),e={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(s),this.setPosition({x:e.x,y:e.y}),this._clearCache(Wl),this._clearSelfAndDescendantCache(Go),this}_setTransform(e){let r;for(r in e)this.attrs[r]=e[r]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let r=e.x,n=e.y,s=this.x(),a=this.y();return r!==void 0&&(s+=r),n!==void 0&&(a+=n),this.setPosition({x:s,y:a}),this}_eachAncestorReverse(e,r){let n=[],s=this.getParent(),a,i;if(!(r&&r._id===this._id)){for(n.unshift(this);s&&(!r||s._id!==r._id);)n.unshift(s),s=s.parent;for(a=n.length,i=0;i<a;i++)e(n[i])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return gr.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,r=this.parent.getChildren().length;return e<r-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return gr.Util.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,r=this.parent.getChildren().length;return e<r-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return gr.Util.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return gr.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return gr.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&gr.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const r=this.index;return this.parent.children.splice(r,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Ix,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const r=this.getParent();return r&&!r._isUnderCache&&(e*=r.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),r,n,s,a,i;const o={attrs:{},className:this.getClassName()};for(r in e)n=e[r],i=gr.Util.isObject(n)&&!gr.Util._isPlainObject(n)&&!gr.Util._isArray(n),!i&&(s=typeof this[r]=="function"&&this[r],delete e[r],a=s?s.call(this):null,e[r]=n,a!==n&&(o.attrs[r]=n));return gr.Util._prepareToStringify(o)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,r,n){const s=[];r&&this._isMatch(e)&&s.push(this);let a=this.parent;for(;a;){if(a===n)return s;a._isMatch(e)&&s.push(a),a=a.parent}return s}isAncestorOf(e){return!1}findAncestor(e,r,n){return this.findAncestors(e,r,n)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let r=e.replace(/ /g,"").split(","),n=r.length,s,a;for(s=0;s<n;s++)if(a=r[s],gr.Util.isValidSelector(a)||(gr.Util.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),gr.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),gr.Util.warn("Konva is awesome, right?")),a.charAt(0)==="#"){if(this.id()===a.slice(1))return!0}else if(a.charAt(0)==="."){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(V5,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,r={},n){return r.target=r.target||this,n?this._fireAndBubble(e,r):this._fire(e,r),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Go,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let r;if(e)return r=new gr.Transform,this._eachAncestorReverse(function(n){const s=n.transformsEnabled();s==="all"?r.multiply(n.getTransform()):s==="position"&&r.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},e),r;{r=this._cache.get(Go)||new gr.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(r):r.reset();const n=this.transformsEnabled();if(n==="all")r.multiply(this.getTransform());else if(n==="position"){const s=this.attrs.x||0,a=this.attrs.y||0,i=this.attrs.offsetX||0,o=this.attrs.offsetY||0;r.translate(s-i,a-o)}return r.dirty=!1,r}}getAbsoluteScale(e){let r=this;for(;r;)r._isUnderCache&&(e=r),r=r.getParent();const s=this.getAbsoluteTransform(e).decompose();return{x:s.scaleX,y:s.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Wl,this._getTransform)}_getTransform(){var e,r;const n=this._cache.get(Wl)||new gr.Transform;n.reset();const s=this.x(),a=this.y(),i=Bl.Konva.getAngle(this.rotation()),o=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,l=(r=this.attrs.scaleY)!==null&&r!==void 0?r:1,u=this.attrs.skewX||0,d=this.attrs.skewY||0,g=this.attrs.offsetX||0,h=this.attrs.offsetY||0;return(s!==0||a!==0)&&n.translate(s,a),i!==0&&n.rotate(i),(u!==0||d!==0)&&n.skew(u,d),(o!==1||l!==1)&&n.scale(o,l),(g!==0||h!==0)&&n.translate(-1*g,-1*h),n.dirty=!1,n}clone(e){let r=gr.Util.cloneObject(this.attrs),n,s,a,i,o;for(n in e)r[n]=e[n];const l=new this.constructor(r);for(n in this.eventListeners)for(s=this.eventListeners[n],a=s.length,i=0;i<a;i++)o=s[i],o.name.indexOf(gK)<0&&(l.eventListeners[n]||(l.eventListeners[n]=[]),l.eventListeners[n].push(o));return l}_toKonvaCanvas(e){e=e||{};const r=this.getClientRect(),n=this.getStage(),s=e.x!==void 0?e.x:Math.floor(r.x),a=e.y!==void 0?e.y:Math.floor(r.y),i=e.pixelRatio||1,o=new Md.SceneCanvas({width:e.width||Math.ceil(r.width)||(n?n.width():0),height:e.height||Math.ceil(r.height)||(n?n.height():0),pixelRatio:i}),l=o.getContext(),u=new Md.SceneCanvas({width:o.width/o.pixelRatio+Math.abs(s),height:o.height/o.pixelRatio+Math.abs(a),pixelRatio:o.pixelRatio});return e.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(s||a)&&l.translate(-1*s,-1*a),this.drawScene(o,void 0,u),l.restore(),o}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const r=e.mimeType||null,n=e.quality||null,s=this._toKonvaCanvas(e).toDataURL(r,n);return e.callback&&e.callback(s),s}toImage(e){return new Promise((r,n)=>{try{const s=e==null?void 0:e.callback;s&&delete e.callback,gr.Util._urlToImage(this.toDataURL(e),function(a){r(a),s==null||s(a)})}catch(s){n(s)}})}toBlob(e){return new Promise((r,n)=>{try{const s=e==null?void 0:e.callback;s&&delete e.callback,this.toCanvas(e).toBlob(a=>{r(a),s==null||s(a)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(s){n(s)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Bl.Konva.dragDistance}_off(e,r,n){let s=this.eventListeners[e],a,i,o;for(a=0;a<s.length;a++)if(i=s[a].name,o=s[a].handler,(i!=="konva"||r==="konva")&&(!r||i===r)&&(!n||n===o)){if(s.splice(a,1),s.length===0){delete this.eventListeners[e];break}a--}}_fireChangeEvent(e,r,n){this._fire(e+fK,{oldVal:r,newVal:n})}addName(e){if(!this.hasName(e)){const r=this.name(),n=r?r+" "+e:e;this.name(n)}return this}hasName(e){if(!e)return!1;const r=this.name();return r?(r||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const r=(this.name()||"").split(/\s/g),n=r.indexOf(e);return n!==-1&&(r.splice(n,1),this.name(r.join(" "))),this}setAttr(e,r){const n=this[H5+gr.Util._capitalize(e)];return gr.Util._isFunction(n)?n.call(this,r):this._setAttr(e,r),this}_requestDraw(){if(Bl.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,r){const n=this.attrs[e];n===r&&!gr.Util.isObject(r)||(r==null?delete this.attrs[e]:this.attrs[e]=r,this._shouldFireChangeEvents&&this._fireChangeEvent(e,n,r),this._requestDraw())}_setComponentAttr(e,r,n){let s;n!==void 0&&(s=this.attrs[e],s||(this.attrs[e]=this.getAttr(e)),this.attrs[e][r]=n,this._fireChangeEvent(e,s,n))}_fireAndBubble(e,r,n){r&&this.nodeType===G5&&(r.target=this);const s=[mK,pK,xK,yK,vK,wK];if(!(s.indexOf(e)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(e,r);const i=s.indexOf(e)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(r&&!r.cancelBubble||!r)&&this.parent&&this.parent.isListening()&&!i&&(n&&n.parent?this._fireAndBubble.call(this.parent,e,r,n):this._fireAndBubble.call(this.parent,e,r))}}_getProtoListeners(e){var r,n,s;const a=(r=this._cache.get(Yp))!==null&&r!==void 0?r:{};let i=a==null?void 0:a[e];if(i===void 0){i=[];let o=Object.getPrototypeOf(this);for(;o;){const l=(s=(n=o.eventListeners)===null||n===void 0?void 0:n[e])!==null&&s!==void 0?s:[];i.push(...l),o=Object.getPrototypeOf(o)}a[e]=i,this._cache.set(Yp,a)}return i}_fire(e,r){r=r||{},r.currentTarget=this,r.type=e;const n=this._getProtoListeners(e);if(n)for(let a=0;a<n.length;a++)n[a].handler.call(this,r);const s=this.eventListeners[e];if(s)for(let a=0;a<s.length;a++)s[a].handler.call(this,r)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const r=e?e.pointerId:void 0,n=this.getStage(),s=this.getAbsolutePosition();if(!n)return;const a=n._getPointerById(r)||n._changedPointerPositions[0]||s;ti.DD._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-s.x,y:a.y-s.y},dragStatus:"ready",pointerId:r})}startDrag(e,r=!0){ti.DD._dragElements.has(this._id)||this._createDragElement(e);const n=ti.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},r)}_setDragPosition(e,r){const n=this.getStage()._getPointerById(r.pointerId);if(!n)return;let s={x:n.x-r.offset.x,y:n.y-r.offset.y};const a=this.dragBoundFunc();if(a!==void 0){const i=a.call(this,s,e);i?s=i:gr.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==s.x||this._lastPos.y!==s.y)&&(this.setAbsolutePosition(s),this._requestDraw()),this._lastPos=s}stopDrag(e){const r=ti.DD._dragElements.get(this._id);r&&(r.dragStatus="stopped"),ti.DD._endDragBefore(e),ti.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=ti.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||Bl.Konva.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let s=!1;ti.DD._dragElements.forEach(a=>{this.isAncestorOf(a.node)&&(s=!0)}),s||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const r=ti.DD._dragElements.get(this._id),n=r&&r.dragStatus==="dragging",s=r&&r.dragStatus==="ready";n?this.stopDrag():s&&ti.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const r=this.getStage();if(!r)return!1;const n={x:-e.x,y:-e.y,width:r.width()+2*e.x,height:r.height()+2*e.y};return gr.Util.haveIntersection(n,this.getClientRect())}static create(e,r){return gr.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,r)}static _createNode(e,r){let n=Zt.prototype.getClassName.call(e),s=e.children,a,i,o;r&&(e.attrs.container=r),Bl.Konva[n]||(gr.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");const l=Bl.Konva[n];if(a=new l(e.attrs),s)for(i=s.length,o=0;o<i;o++)a.add(Zt._createNode(s[o]));return a}}on.Node=Zt;Zt.prototype.nodeType="Node";Zt.prototype._attrsAffectingSize=[];Zt.prototype.eventListeners={};Zt.prototype.on.call(Zt.prototype,bK,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Wl),this._clearSelfAndDescendantCache(Go)});Zt.prototype.on.call(Zt.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(qb)});Zt.prototype.on.call(Zt.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Qb)});Zt.prototype.on.call(Zt.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Ix)});const Wr=lm.Factory.addGetterSetter;Wr(Zt,"zIndex");Wr(Zt,"absolutePosition");Wr(Zt,"position");Wr(Zt,"x",0,(0,Rn.getNumberValidator)());Wr(Zt,"y",0,(0,Rn.getNumberValidator)());Wr(Zt,"globalCompositeOperation","source-over",(0,Rn.getStringValidator)());Wr(Zt,"opacity",1,(0,Rn.getNumberValidator)());Wr(Zt,"name","",(0,Rn.getStringValidator)());Wr(Zt,"id","",(0,Rn.getStringValidator)());Wr(Zt,"rotation",0,(0,Rn.getNumberValidator)());lm.Factory.addComponentsGetterSetter(Zt,"scale",["x","y"]);Wr(Zt,"scaleX",1,(0,Rn.getNumberValidator)());Wr(Zt,"scaleY",1,(0,Rn.getNumberValidator)());lm.Factory.addComponentsGetterSetter(Zt,"skew",["x","y"]);Wr(Zt,"skewX",0,(0,Rn.getNumberValidator)());Wr(Zt,"skewY",0,(0,Rn.getNumberValidator)());lm.Factory.addComponentsGetterSetter(Zt,"offset",["x","y"]);Wr(Zt,"offsetX",0,(0,Rn.getNumberValidator)());Wr(Zt,"offsetY",0,(0,Rn.getNumberValidator)());Wr(Zt,"dragDistance",void 0,(0,Rn.getNumberValidator)());Wr(Zt,"width",0,(0,Rn.getNumberValidator)());Wr(Zt,"height",0,(0,Rn.getNumberValidator)());Wr(Zt,"listening",!0,(0,Rn.getBooleanValidator)());Wr(Zt,"preventDefault",!0,(0,Rn.getBooleanValidator)());Wr(Zt,"filters",void 0,function(t){return this._filterUpToDate=!1,t});Wr(Zt,"visible",!0,(0,Rn.getBooleanValidator)());Wr(Zt,"transformsEnabled","all",(0,Rn.getStringValidator)());Wr(Zt,"size");Wr(Zt,"dragBoundFunc");Wr(Zt,"draggable",!1,(0,Rn.getBooleanValidator)());lm.Factory.backCompat(Zt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var nd={};Object.defineProperty(nd,"__esModule",{value:!0});nd.Container=void 0;const dh=dr,z_=on,Py=Jt;class sd extends z_.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){const r=this.children||[];return e?r.filter(e):r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let n=0;n<e.length;n++)this.add(e[n]);return this}const r=e[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const r=this._generalFind(e,!0);return r.length>0?r[0]:void 0}_generalFind(e,r){const n=[];return this._descendants(s=>{const a=s._isMatch(e);return a&&n.push(s),!!(a&&r)}),n}_descendants(e){let r=!1;const n=this.getChildren();for(const s of n){if(r=e(s),r)return!0;if(s.hasChildren()&&(r=s._descendants(e),r))return!0}return!1}toObject(){const e=z_.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(r=>{e.children.push(r.toObject())}),e}isAncestorOf(e){let r=e.getParent();for(;r;){if(r._id===this._id)return!0;r=r.getParent()}return!1}clone(e){const r=z_.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(n){r.add(n.clone())}),r}getAllIntersections(e){const r=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(e)&&r.push(n)}),r}_clearSelfAndDescendantCache(e){var r;super._clearSelfAndDescendantCache(e),!this.isCached()&&((r=this.children)===null||r===void 0||r.forEach(function(n){n._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(r,n){r.index=n}),this._requestDraw()}drawScene(e,r,n){const s=this.getLayer(),a=e||s&&s.getCanvas(),i=a&&a.getContext(),o=this._getCanvasCache(),l=o&&o.scene,u=a&&a.isCache;if(!this.isVisible()&&!u)return this;if(l){i.save();const d=this.getAbsoluteTransform(r).getMatrix();i.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(i),i.restore()}else this._drawChildren("drawScene",a,r,n);return this}drawHit(e,r){if(!this.shouldDrawHit(r))return this;const n=this.getLayer(),s=e||n&&n.hitCanvas,a=s&&s.getContext(),i=this._getCanvasCache();if(i&&i.hit){a.save();const l=this.getAbsoluteTransform(r).getMatrix();a.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(a),a.restore()}else this._drawChildren("drawHit",s,r);return this}_drawChildren(e,r,n,s){var a;const i=r&&r.getContext(),o=this.clipWidth(),l=this.clipHeight(),u=this.clipFunc(),d=typeof o=="number"&&typeof l=="number"||u,g=n===this;if(d){i.save();const p=this.getAbsoluteTransform(n);let x=p.getMatrix();i.transform(x[0],x[1],x[2],x[3],x[4],x[5]),i.beginPath();let v;if(u)v=u.call(this,i,this);else{const w=this.clipX(),S=this.clipY();i.rect(w||0,S||0,o,l)}i.clip.apply(i,v),x=p.copy().invert().getMatrix(),i.transform(x[0],x[1],x[2],x[3],x[4],x[5])}const h=!g&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";h&&(i.save(),i._applyGlobalCompositeOperation(this)),(a=this.children)===null||a===void 0||a.forEach(function(p){p[e](r,n,s)}),h&&i.restore(),d&&i.restore()}getClientRect(e={}){var r;const n=e.skipTransform,s=e.relativeTo;let a,i,o,l,u={x:1/0,y:1/0,width:0,height:0};const d=this;(r=this.children)===null||r===void 0||r.forEach(function(p){if(!p.visible())return;const x=p.getClientRect({relativeTo:d,skipShadow:e.skipShadow,skipStroke:e.skipStroke});x.width===0&&x.height===0||(a===void 0?(a=x.x,i=x.y,o=x.x+x.width,l=x.y+x.height):(a=Math.min(a,x.x),i=Math.min(i,x.y),o=Math.max(o,x.x+x.width),l=Math.max(l,x.y+x.height)))});const g=this.find("Shape");let h=!1;for(let p=0;p<g.length;p++)if(g[p]._isVisible(this)){h=!0;break}return h&&a!==void 0?u={x:a,y:i,width:o-a,height:l-i}:u={x:0,y:0,width:0,height:0},n?u:this._transformedRect(u,s)}}nd.Container=sd;dh.Factory.addComponentsGetterSetter(sd,"clip",["x","y","width","height"]);dh.Factory.addGetterSetter(sd,"clipX",void 0,(0,Py.getNumberValidator)());dh.Factory.addGetterSetter(sd,"clipY",void 0,(0,Py.getNumberValidator)());dh.Factory.addGetterSetter(sd,"clipWidth",void 0,(0,Py.getNumberValidator)());dh.Factory.addGetterSetter(sd,"clipHeight",void 0,(0,Py.getNumberValidator)());dh.Factory.addGetterSetter(sd,"clipFunc");var D9={},Ac={};Object.defineProperty(Ac,"__esModule",{value:!0});Ac.getCapturedShape=CK;Ac.createEvent=MC;Ac.hasPointerCapture=TK;Ac.setPointerCapture=EK;Ac.releaseCapture=M9;const kK=or,Cg=new Map,R9=kK.Konva._global.PointerEvent!==void 0;function CK(t){return Cg.get(t)}function MC(t){return{evt:t,pointerId:t.pointerId}}function TK(t,e){return Cg.get(t)===e}function EK(t,e){M9(t),e.getStage()&&(Cg.set(t,e),R9&&e._fire("gotpointercapture",MC(new PointerEvent("gotpointercapture"))))}function M9(t,e){const r=Cg.get(t);if(!r)return;const n=r.getStage();n&&n.content,Cg.delete(t),R9&&r._fire("lostpointercapture",MC(new PointerEvent("lostpointercapture")))}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=yn,r=dr,n=nd,s=or,a=zi,i=Fy,o=or,l=Ac,u="Stage",d="string",g="px",h="mouseout",p="mouseleave",x="mouseover",v="mouseenter",w="mousemove",S="mousedown",_="mouseup",y="pointermove",k="pointerdown",N="pointerup",E="pointercancel",A="lostpointercapture",C="pointerout",F="pointerleave",D="pointerover",R="pointerenter",M="contextmenu",B="touchstart",J="touchend",X="touchmove",z="touchcancel",H="wheel",U=5,L=[[v,"_pointerenter"],[S,"_pointerdown"],[w,"_pointermove"],[_,"_pointerup"],[p,"_pointerleave"],[B,"_pointerdown"],[X,"_pointermove"],[J,"_pointerup"],[z,"_pointercancel"],[x,"_pointerover"],[H,"_wheel"],[M,"_contextmenu"],[k,"_pointerdown"],[y,"_pointermove"],[N,"_pointerup"],[E,"_pointercancel"],[F,"_pointerleave"],[A,"_lostpointercapture"]],ne={mouse:{[C]:h,[F]:p,[D]:x,[R]:v,[y]:w,[k]:S,[N]:_,[E]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[C]:"touchout",[F]:"touchleave",[D]:"touchover",[R]:"touchenter",[y]:X,[k]:B,[N]:J,[E]:z,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[C]:C,[F]:F,[D]:D,[R]:R,[y]:y,[k]:k,[N]:N,[E]:E,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},de=se=>se.indexOf("pointer")>=0?"pointer":se.indexOf("touch")>=0?"touch":"mouse",G=se=>{const W=de(se);if(W==="pointer")return s.Konva.pointerEventsEnabled&&ne.pointer;if(W==="touch")return ne.touch;if(W==="mouse")return ne.mouse};function K(se={}){return(se.clipFunc||se.clipWidth||se.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),se}const Q="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class q extends n.Container{constructor(W){super(K(W)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{K(this.attrs)}),this._checkVisibility()}_validateAdd(W){const ee=W.getType()==="Layer",ve=W.getType()==="FastLayer";ee||ve||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const W=this.visible()?"":"none";this.content.style.display=W}setContainer(W){if(typeof W===d){let ee;if(W.charAt(0)==="."){const ve=W.slice(1);W=document.getElementsByClassName(ve)[0]}else W.charAt(0)!=="#"?ee=W:ee=W.slice(1),W=document.getElementById(ee);if(!W)throw"Can not find container in document with id "+ee}return this._setAttr("container",W),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),W.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const W=this.children,ee=W.length;for(let ve=0;ve<ee;ve++)W[ve].clear();return this}clone(W){return W||(W={}),W.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,W)}destroy(){super.destroy();const W=this.content;W&&e.Util._isInDocument(W)&&this.container().removeChild(W);const ee=t.stages.indexOf(this);return ee>-1&&t.stages.splice(ee,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const W=this._pointerPositions[0]||this._changedPointerPositions[0];return W?{x:W.x,y:W.y}:(e.Util.warn(Q),null)}_getPointerById(W){return this._pointerPositions.find(ee=>ee.id===W)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(W){W=W||{},W.x=W.x||0,W.y=W.y||0,W.width=W.width||this.width(),W.height=W.height||this.height();const ee=new a.SceneCanvas({width:W.width,height:W.height,pixelRatio:W.pixelRatio||1}),ve=ee.getContext()._context,_e=this.children;return(W.x||W.y)&&ve.translate(-1*W.x,-1*W.y),_e.forEach(function(Le){if(!Le.isVisible())return;const te=Le._toKonvaCanvas(W);ve.drawImage(te._canvas,W.x,W.y,te.getWidth()/te.getPixelRatio(),te.getHeight()/te.getPixelRatio())}),ee}getIntersection(W){if(!W)return null;const ee=this.children,ve=ee.length,_e=ve-1;for(let Le=_e;Le>=0;Le--){const te=ee[Le].getIntersection(W);if(te)return te}return null}_resizeDOM(){const W=this.width(),ee=this.height();this.content&&(this.content.style.width=W+g,this.content.style.height=ee+g),this.bufferCanvas.setSize(W,ee),this.bufferHitCanvas.setSize(W,ee),this.children.forEach(ve=>{ve.setSize({width:W,height:ee}),ve.draw()})}add(W,...ee){if(arguments.length>1){for(let _e=0;_e<arguments.length;_e++)this.add(arguments[_e]);return this}super.add(W);const ve=this.children.length;return ve>U&&e.Util.warn("The stage has "+ve+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),W.setSize({width:this.width(),height:this.height()}),W.draw(),s.Konva.isBrowser&&this.content.appendChild(W.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(W){return l.hasPointerCapture(W,this)}setPointerCapture(W){l.setPointerCapture(W,this)}releaseCapture(W){l.releaseCapture(W,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&L.forEach(([W,ee])=>{this.content.addEventListener(W,ve=>{this[ee](ve)},{passive:!1})})}_pointerenter(W){this.setPointersPositions(W);const ee=G(W.type);ee&&this._fire(ee.pointerenter,{evt:W,target:this,currentTarget:this})}_pointerover(W){this.setPointersPositions(W);const ee=G(W.type);ee&&this._fire(ee.pointerover,{evt:W,target:this,currentTarget:this})}_getTargetShape(W){let ee=this[W+"targetShape"];return ee&&!ee.getStage()&&(ee=null),ee}_pointerleave(W){const ee=G(W.type),ve=de(W.type);if(!ee)return;this.setPointersPositions(W);const _e=this._getTargetShape(ve),Le=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;_e&&Le?(_e._fireAndBubble(ee.pointerout,{evt:W}),_e._fireAndBubble(ee.pointerleave,{evt:W}),this._fire(ee.pointerleave,{evt:W,target:this,currentTarget:this}),this[ve+"targetShape"]=null):Le&&(this._fire(ee.pointerleave,{evt:W,target:this,currentTarget:this}),this._fire(ee.pointerout,{evt:W,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(W){const ee=G(W.type),ve=de(W.type);if(!ee)return;this.setPointersPositions(W);let _e=!1;this._changedPointerPositions.forEach(Le=>{const te=this.getIntersection(Le);if(i.DD.justDragged=!1,s.Konva["_"+ve+"ListenClick"]=!0,!te||!te.isListening()){this[ve+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&te.setPointerCapture(Le.id),this[ve+"ClickStartShape"]=te,te._fireAndBubble(ee.pointerdown,{evt:W,pointerId:Le.id}),_e=!0;const Ne=W.type.indexOf("touch")>=0;te.preventDefault()&&W.cancelable&&Ne&&W.preventDefault()}),_e||this._fire(ee.pointerdown,{evt:W,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(W){const ee=G(W.type),ve=de(W.type);if(!ee||(s.Konva.isDragging()&&i.DD.node.preventDefault()&&W.cancelable&&W.preventDefault(),this.setPointersPositions(W),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const Le={};let te=!1;const Ne=this._getTargetShape(ve);this._changedPointerPositions.forEach(Ce=>{const We=l.getCapturedShape(Ce.id)||this.getIntersection(Ce),nt=Ce.id,$e={evt:W,pointerId:nt},De=Ne!==We;if(De&&Ne&&(Ne._fireAndBubble(ee.pointerout,{...$e},We),Ne._fireAndBubble(ee.pointerleave,{...$e},We)),We){if(Le[We._id])return;Le[We._id]=!0}We&&We.isListening()?(te=!0,De&&(We._fireAndBubble(ee.pointerover,{...$e},Ne),We._fireAndBubble(ee.pointerenter,{...$e},Ne),this[ve+"targetShape"]=We),We._fireAndBubble(ee.pointermove,{...$e})):Ne&&(this._fire(ee.pointerover,{evt:W,target:this,currentTarget:this,pointerId:nt}),this[ve+"targetShape"]=null)}),te||this._fire(ee.pointermove,{evt:W,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(W){const ee=G(W.type),ve=de(W.type);if(!ee)return;this.setPointersPositions(W);const _e=this[ve+"ClickStartShape"],Le=this[ve+"ClickEndShape"],te={};let Ne=!1;this._changedPointerPositions.forEach(Ce=>{const We=l.getCapturedShape(Ce.id)||this.getIntersection(Ce);if(We){if(We.releaseCapture(Ce.id),te[We._id])return;te[We._id]=!0}const nt=Ce.id,$e={evt:W,pointerId:nt};let De=!1;s.Konva["_"+ve+"InDblClickWindow"]?(De=!0,clearTimeout(this[ve+"DblTimeout"])):i.DD.justDragged||(s.Konva["_"+ve+"InDblClickWindow"]=!0,clearTimeout(this[ve+"DblTimeout"])),this[ve+"DblTimeout"]=setTimeout(function(){s.Konva["_"+ve+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),We&&We.isListening()?(Ne=!0,this[ve+"ClickEndShape"]=We,We._fireAndBubble(ee.pointerup,{...$e}),s.Konva["_"+ve+"ListenClick"]&&_e&&_e===We&&(We._fireAndBubble(ee.pointerclick,{...$e}),De&&Le&&Le===We&&We._fireAndBubble(ee.pointerdblclick,{...$e}))):(this[ve+"ClickEndShape"]=null,s.Konva["_"+ve+"ListenClick"]&&this._fire(ee.pointerclick,{evt:W,target:this,currentTarget:this,pointerId:nt}),De&&this._fire(ee.pointerdblclick,{evt:W,target:this,currentTarget:this,pointerId:nt}))}),Ne||this._fire(ee.pointerup,{evt:W,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+ve+"ListenClick"]=!1,W.cancelable&&ve!=="touch"&&ve!=="pointer"&&W.preventDefault()}_contextmenu(W){this.setPointersPositions(W);const ee=this.getIntersection(this.getPointerPosition());ee&&ee.isListening()?ee._fireAndBubble(M,{evt:W}):this._fire(M,{evt:W,target:this,currentTarget:this})}_wheel(W){this.setPointersPositions(W);const ee=this.getIntersection(this.getPointerPosition());ee&&ee.isListening()?ee._fireAndBubble(H,{evt:W}):this._fire(H,{evt:W,target:this,currentTarget:this})}_pointercancel(W){this.setPointersPositions(W);const ee=l.getCapturedShape(W.pointerId)||this.getIntersection(this.getPointerPosition());ee&&ee._fireAndBubble(N,l.createEvent(W)),l.releaseCapture(W.pointerId)}_lostpointercapture(W){l.releaseCapture(W.pointerId)}setPointersPositions(W){const ee=this._getContentPosition();let ve=null,_e=null;W=W||window.event,W.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(W.touches,Le=>{this._pointerPositions.push({id:Le.identifier,x:(Le.clientX-ee.left)/ee.scaleX,y:(Le.clientY-ee.top)/ee.scaleY})}),Array.prototype.forEach.call(W.changedTouches||W.touches,Le=>{this._changedPointerPositions.push({id:Le.identifier,x:(Le.clientX-ee.left)/ee.scaleX,y:(Le.clientY-ee.top)/ee.scaleY})})):(ve=(W.clientX-ee.left)/ee.scaleX,_e=(W.clientY-ee.top)/ee.scaleY,this.pointerPos={x:ve,y:_e},this._pointerPositions=[{x:ve,y:_e,id:e.Util._getFirstPointerId(W)}],this._changedPointerPositions=[{x:ve,y:_e,id:e.Util._getFirstPointerId(W)}])}_setPointerPosition(W){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(W)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const W=this.content.getBoundingClientRect();return{top:W.top,left:W.left,scaleX:W.width/this.content.clientWidth||1,scaleY:W.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const W=this.container();if(!W)throw"Stage has no container. A container is required.";W.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),W.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(W){W.batchDraw()}),this}}t.Stage=q,q.prototype.nodeType=u,(0,o._registerNode)(q),r.Factory.addGetterSetter(q,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(se=>{se.batchDraw()})})})(D9);var cm={},rs={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=or,r=yn,n=dr,s=on,a=Jt,i=or,o=Ac,l="hasShadow",u="shadowRGBA",d="patternImage",g="linearGradient",h="radialGradient";let p;function x(){return p||(p=r.Util.createCanvasElement().getContext("2d"),p)}t.shapes={};function v(F){const D=this.attrs.fillRule;D?F.fill(D):F.fill()}function w(F){F.stroke()}function S(F){const D=this.attrs.fillRule;D?F.fill(D):F.fill()}function _(F){F.stroke()}function y(){this._clearCache(l)}function k(){this._clearCache(u)}function N(){this._clearCache(d)}function E(){this._clearCache(g)}function A(){this._clearCache(h)}class C extends s.Node{constructor(D){super(D);let R;for(;R=r.Util.getRandomColor(),!(R&&!(R in t.shapes)););this.colorKey=R,t.shapes[R]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const R=x().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(R&&R.setTransform){const M=new r.Transform;M.translate(this.fillPatternX(),this.fillPatternY()),M.rotate(e.Konva.getAngle(this.fillPatternRotation())),M.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),M.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const B=M.getMatrix(),J=typeof DOMMatrix>"u"?{a:B[0],b:B[1],c:B[2],d:B[3],e:B[4],f:B[5]}:new DOMMatrix(B);R.setTransform(J)}return R}}_getLinearGradient(){return this._getCache(g,this.__getLinearGradient)}__getLinearGradient(){const D=this.fillLinearGradientColorStops();if(D){const R=x(),M=this.fillLinearGradientStartPoint(),B=this.fillLinearGradientEndPoint(),J=R.createLinearGradient(M.x,M.y,B.x,B.y);for(let X=0;X<D.length;X+=2)J.addColorStop(D[X],D[X+1]);return J}}_getRadialGradient(){return this._getCache(h,this.__getRadialGradient)}__getRadialGradient(){const D=this.fillRadialGradientColorStops();if(D){const R=x(),M=this.fillRadialGradientStartPoint(),B=this.fillRadialGradientEndPoint(),J=R.createRadialGradient(M.x,M.y,this.fillRadialGradientStartRadius(),B.x,B.y,this.fillRadialGradientEndRadius());for(let X=0;X<D.length;X+=2)J.addColorStop(D[X],D[X+1]);return J}}getShadowRGBA(){return this._getCache(u,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const D=r.Util.colorToRGBA(this.shadowColor());if(D)return"rgba("+D.r+","+D.g+","+D.b+","+D.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const D=this.hitStrokeWidth();return D==="auto"?this.hasStroke():this.strokeEnabled()&&!!D}intersects(D){const R=this.getStage();if(!R)return!1;const M=R.bufferHitCanvas;return M.getContext().clear(),this.drawHit(M,void 0,!0),M.context.getImageData(Math.round(D.x),Math.round(D.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(D){var R;if(!((R=this.attrs.perfectDrawEnabled)!==null&&R!==void 0?R:!0))return!1;const B=D||this.hasFill(),J=this.hasStroke(),X=this.getAbsoluteOpacity()!==1;if(B&&J&&X)return!0;const z=this.hasShadow(),H=this.shadowForStrokeEnabled();return!!(B&&J&&z&&H)}setStrokeHitEnabled(D){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),D?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const D=this.size();return{x:this._centroid?-D.width/2:0,y:this._centroid?-D.height/2:0,width:D.width,height:D.height}}getClientRect(D={}){let R=!1,M=this.getParent();for(;M;){if(M.isCached()){R=!0;break}M=M.getParent()}const B=D.skipTransform,J=D.relativeTo||R&&this.getStage()||void 0,X=this.getSelfRect(),H=!D.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,U=X.width+H,L=X.height+H,ne=!D.skipShadow&&this.hasShadow(),de=ne?this.shadowOffsetX():0,G=ne?this.shadowOffsetY():0,K=U+Math.abs(de),Q=L+Math.abs(G),q=ne&&this.shadowBlur()||0,se=K+q*2,W=Q+q*2,ee={width:se,height:W,x:-(H/2+q)+Math.min(de,0)+X.x,y:-(H/2+q)+Math.min(G,0)+X.y};return B?ee:this._transformedRect(ee,J)}drawScene(D,R,M){const B=this.getLayer(),J=D||B.getCanvas(),X=J.getContext(),z=this._getCanvasCache(),H=this.getSceneFunc(),U=this.hasShadow();let L;const ne=R===this;if(!this.isVisible()&&!ne)return this;if(z){X.save();const de=this.getAbsoluteTransform(R).getMatrix();return X.transform(de[0],de[1],de[2],de[3],de[4],de[5]),this._drawCachedSceneCanvas(X),X.restore(),this}if(!H)return this;if(X.save(),this._useBufferCanvas()){L=this.getStage();const de=M||L.bufferCanvas,G=de.getContext();G.clear(),G.save(),G._applyLineJoin(this);const K=this.getAbsoluteTransform(R).getMatrix();G.transform(K[0],K[1],K[2],K[3],K[4],K[5]),H.call(this,G,this),G.restore();const Q=de.pixelRatio;U&&X._applyShadow(this),X._applyOpacity(this),X._applyGlobalCompositeOperation(this),X.drawImage(de._canvas,de.x||0,de.y||0,de.width/Q,de.height/Q)}else{if(X._applyLineJoin(this),!ne){const de=this.getAbsoluteTransform(R).getMatrix();X.transform(de[0],de[1],de[2],de[3],de[4],de[5]),X._applyOpacity(this),X._applyGlobalCompositeOperation(this)}U&&X._applyShadow(this),H.call(this,X,this)}return X.restore(),this}drawHit(D,R,M=!1){if(!this.shouldDrawHit(R,M))return this;const B=this.getLayer(),J=D||B.hitCanvas,X=J&&J.getContext(),z=this.hitFunc()||this.sceneFunc(),H=this._getCanvasCache(),U=H&&H.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),U){X.save();const ne=this.getAbsoluteTransform(R).getMatrix();return X.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5]),this._drawCachedHitCanvas(X),X.restore(),this}if(!z)return this;if(X.save(),X._applyLineJoin(this),!(this===R)){const ne=this.getAbsoluteTransform(R).getMatrix();X.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5])}return z.call(this,X,this),X.restore(),this}drawHitFromCache(D=0){const R=this._getCanvasCache(),M=this._getCachedSceneCanvas(),B=R.hit,J=B.getContext(),X=B.getWidth(),z=B.getHeight();J.clear(),J.drawImage(M._canvas,0,0,X,z);try{const H=J.getImageData(0,0,X,z),U=H.data,L=U.length,ne=r.Util._hexToRgb(this.colorKey);for(let de=0;de<L;de+=4)U[de+3]>D?(U[de]=ne.r,U[de+1]=ne.g,U[de+2]=ne.b,U[de+3]=255):U[de+3]=0;J.putImageData(H,0,0)}catch(H){r.Util.error("Unable to draw hit graph from cached scene canvas. "+H.message)}return this}hasPointerCapture(D){return o.hasPointerCapture(D,this)}setPointerCapture(D){o.setPointerCapture(D,this)}releaseCapture(D){o.releaseCapture(D,this)}}t.Shape=C,C.prototype._fillFunc=v,C.prototype._strokeFunc=w,C.prototype._fillFuncHit=S,C.prototype._strokeFuncHit=_,C.prototype._centroid=!1,C.prototype.nodeType="Shape",(0,i._registerNode)(C),C.prototype.eventListeners={},C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",y),C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",k),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",N),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",E),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",A),n.Factory.addGetterSetter(C,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(C,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(C,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(C,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(C,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(C,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(C,"lineJoin"),n.Factory.addGetterSetter(C,"lineCap"),n.Factory.addGetterSetter(C,"sceneFunc"),n.Factory.addGetterSetter(C,"hitFunc"),n.Factory.addGetterSetter(C,"dash"),n.Factory.addGetterSetter(C,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(C,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(C,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(C,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"fillPatternImage"),n.Factory.addGetterSetter(C,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(C,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(C,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(C,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(C,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(C,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(C,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(C,"fillEnabled",!0),n.Factory.addGetterSetter(C,"strokeEnabled",!0),n.Factory.addGetterSetter(C,"shadowEnabled",!0),n.Factory.addGetterSetter(C,"dashEnabled",!0),n.Factory.addGetterSetter(C,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(C,"fillPriority","color"),n.Factory.addComponentsGetterSetter(C,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(C,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(C,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(C,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(C,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(C,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(C,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(C,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(C,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(C,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(C,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(C,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(C,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(C,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(C,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(C,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(C,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(C,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(C,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(C,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(C,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(C,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(C,"fillPatternRotation",0),n.Factory.addGetterSetter(C,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(C,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(rs);Object.defineProperty(cm,"__esModule",{value:!0});cm.Layer=void 0;const Wo=yn,H_=nd,Ld=on,LC=dr,K5=zi,NK=Jt,AK=rs,jK=or,FK="#",PK="beforeDraw",DK="draw",L9=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],RK=L9.length;let fh=class extends H_.Container{constructor(e){super(e),this.canvas=new K5.SceneCanvas,this.hitCanvas=new K5.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const r=this.getStage();return r&&r.content&&(r.content.removeChild(this.getNativeCanvasElement()),e<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[e+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Ld.Node.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Ld.Node.prototype.moveUp.call(this))return!1;const r=this.getStage();return!r||!r.content?!1:(r.content.removeChild(this.getNativeCanvasElement()),this.index<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[this.index+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Ld.Node.prototype.moveDown.call(this)){const e=this.getStage();if(e){const r=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),r[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Ld.Node.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const r=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),r[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return Ld.Node.prototype.remove.call(this),e&&e.parentNode&&Wo.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:r}){return this.canvas.setSize(e,r),this.hitCanvas.setSize(e,r),this._setSmoothEnabled(),this}_validateAdd(e){const r=e.getType();r!=="Group"&&r!=="Shape"&&Wo.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),Ld.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Wo.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Wo.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Wo.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let r=1,n=!1;for(;;){for(let s=0;s<RK;s++){const a=L9[s],i=this._getIntersection({x:e.x+a.x*r,y:e.y+a.y*r}),o=i.shape;if(o)return o;if(n=!!i.antialiased,!i.antialiased)break}if(n)r+=1;else return null}}_getIntersection(e){const r=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(e.x*r),Math.round(e.y*r),1,1).data,s=n[3];if(s===255){const a=Wo.Util._rgbToHex(n[0],n[1],n[2]),i=AK.shapes[FK+a];return i?{shape:i}:{antialiased:!0}}else if(s>0)return{antialiased:!0};return{}}drawScene(e,r,n){const s=this.getLayer(),a=e||s&&s.getCanvas();return this._fire(PK,{node:this}),this.clearBeforeDraw()&&a.getContext().clear(),H_.Container.prototype.drawScene.call(this,a,r,n),this._fire(DK,{node:this}),this}drawHit(e,r){const n=this.getLayer(),s=e||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),H_.Container.prototype.drawHit.call(this,s,r),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){Wo.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return Wo.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return Wo.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};cm.Layer=fh;fh.prototype.nodeType="Layer";(0,jK._registerNode)(fh);LC.Factory.addGetterSetter(fh,"imageSmoothingEnabled",!0);LC.Factory.addGetterSetter(fh,"clearBeforeDraw",!0);LC.Factory.addGetterSetter(fh,"hitGraphEnabled",!0,(0,NK.getBooleanValidator)());var Dy={};Object.defineProperty(Dy,"__esModule",{value:!0});Dy.FastLayer=void 0;const MK=yn,LK=cm,IK=or;let IC=class extends LK.Layer{constructor(e){super(e),this.listening(!1),MK.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};Dy.FastLayer=IC;IC.prototype.nodeType="FastLayer";(0,IK._registerNode)(IC);var hh={};Object.defineProperty(hh,"__esModule",{value:!0});hh.Group=void 0;const OK=yn,BK=nd,UK=or;let OC=class extends BK.Container{_validateAdd(e){const r=e.getType();r!=="Group"&&r!=="Shape"&&OK.Util.throw("You may only add groups and shapes to groups.")}};hh.Group=OC;OC.prototype.nodeType="Group";(0,UK._registerNode)(OC);var gh={};Object.defineProperty(gh,"__esModule",{value:!0});gh.Animation=void 0;const G_=or,X5=yn,V_=function(){return G_.glob.performance&&G_.glob.performance.now?function(){return G_.glob.performance.now()}:function(){return new Date().getTime()}}();class xo{constructor(e,r){this.id=xo.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:V_(),frameRate:0},this.func=e,this.setLayers(r)}setLayers(e){let r=[];return e&&(r=Array.isArray(e)?e:[e]),this.layers=r,this}getLayers(){return this.layers}addLayer(e){const r=this.layers,n=r.length;for(let s=0;s<n;s++)if(r[s]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const r=xo.animations,n=r.length;for(let s=0;s<n;s++)if(r[s].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=V_(),xo._addAnimation(this),this}stop(){return xo._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const r=e.id,n=this.animations,s=n.length;for(let a=0;a<s;a++)if(n[a].id===r){this.animations.splice(a,1);break}}static _runFrames(){const e={},r=this.animations;for(let n=0;n<r.length;n++){const s=r[n],a=s.layers,i=s.func;s._updateFrameObject(V_());const o=a.length;let l;if(i?l=i.call(s,s.frame)!==!1:l=!0,!!l)for(let u=0;u<o;u++){const d=a[u];d._id!==void 0&&(e[d._id]=d)}}for(const n in e)e.hasOwnProperty(n)&&e[n].batchDraw()}static _animationLoop(){const e=xo;e.animations.length?(e._runFrames(),X5.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,X5.Util.requestAnimFrame(this._animationLoop))}}gh.Animation=xo;xo.animations=[];xo.animIdCounter=0;xo.animRunning=!1;var I9={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=yn,r=gh,n=on,s=or,a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},i=1,o=2,l=3,u=["fill","stroke","shadowColor"];let d=0;class g{constructor(x,v,w,S,_,y,k){this.prop=x,this.propFunc=v,this.begin=S,this._pos=S,this.duration=y,this._change=0,this.prevPos=0,this.yoyo=k,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=w,this._change=_-this.begin,this.pause()}fire(x){const v=this[x];v&&v()}setTime(x){x>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():x<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=x,this.update())}getTime(){return this._time}setPosition(x){this.prevPos=this._pos,this.propFunc(x),this._pos=x}getPosition(x){return x===void 0&&(x=this._time),this.func(x,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(x){this.pause(),this._time=x,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const x=this.getTimer()-this._startTime;this.state===o?this.setTime(x):this.state===l&&this.setTime(this.duration-x)}pause(){this.state=i,this.fire("onPause")}getTimer(){return new Date().getTime()}}class h{constructor(x){const v=this,w=x.node,S=w._id,_=x.easing||t.Easings.Linear,y=!!x.yoyo;let k,N;typeof x.duration>"u"?k=.3:x.duration===0?k=.001:k=x.duration,this.node=w,this._id=d++;const E=w.getLayer()||(w instanceof s.Konva.Stage?w.getLayers():null);E||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){v.tween.onEnterFrame()},E),this.tween=new g(N,function(A){v._tweenFunc(A)},_,0,1,k*1e3,y),this._addListeners(),h.attrs[S]||(h.attrs[S]={}),h.attrs[S][this._id]||(h.attrs[S][this._id]={}),h.tweens[S]||(h.tweens[S]={});for(N in x)a[N]===void 0&&this._addAttr(N,x[N]);this.reset(),this.onFinish=x.onFinish,this.onReset=x.onReset,this.onUpdate=x.onUpdate}_addAttr(x,v){const w=this.node,S=w._id;let _,y,k,N,E;const A=h.tweens[S][x];A&&delete h.attrs[S][A][x];let C=w.getAttr(x);if(e.Util._isArray(v))if(_=[],y=Math.max(v.length,C.length),x==="points"&&v.length!==C.length&&(v.length>C.length?(N=C,C=e.Util._prepareArrayForTween(C,v,w.closed())):(k=v,v=e.Util._prepareArrayForTween(v,C,w.closed()))),x.indexOf("fill")===0)for(let F=0;F<y;F++)if(F%2===0)_.push(v[F]-C[F]);else{const D=e.Util.colorToRGBA(C[F]);E=e.Util.colorToRGBA(v[F]),C[F]=D,_.push({r:E.r-D.r,g:E.g-D.g,b:E.b-D.b,a:E.a-D.a})}else for(let F=0;F<y;F++)_.push(v[F]-C[F]);else u.indexOf(x)!==-1?(C=e.Util.colorToRGBA(C),E=e.Util.colorToRGBA(v),_={r:E.r-C.r,g:E.g-C.g,b:E.b-C.b,a:E.a-C.a}):_=v-C;h.attrs[S][this._id][x]={start:C,diff:_,end:v,trueEnd:k,trueStart:N},h.tweens[S][x]=this._id}_tweenFunc(x){const v=this.node,w=h.attrs[v._id][this._id];let S,_,y,k,N,E,A,C;for(S in w){if(_=w[S],y=_.start,k=_.diff,C=_.end,e.Util._isArray(y))if(N=[],A=Math.max(y.length,C.length),S.indexOf("fill")===0)for(E=0;E<A;E++)E%2===0?N.push((y[E]||0)+k[E]*x):N.push("rgba("+Math.round(y[E].r+k[E].r*x)+","+Math.round(y[E].g+k[E].g*x)+","+Math.round(y[E].b+k[E].b*x)+","+(y[E].a+k[E].a*x)+")");else for(E=0;E<A;E++)N.push((y[E]||0)+k[E]*x);else u.indexOf(S)!==-1?N="rgba("+Math.round(y.r+k.r*x)+","+Math.round(y.g+k.g*x)+","+Math.round(y.b+k.b*x)+","+(y.a+k.a*x)+")":N=y+k*x;v.setAttr(S,N)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const x=this.node,v=h.attrs[x._id][this._id];v.points&&v.points.trueEnd&&x.setAttr("points",v.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const x=this.node,v=h.attrs[x._id][this._id];v.points&&v.points.trueStart&&x.points(v.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(x){return this.tween.seek(x*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const x=this.node._id,v=this._id,w=h.tweens[x];this.pause(),this.anim&&this.anim.stop();for(const S in w)delete h.tweens[x][S];delete h.attrs[x][v],h.tweens[x]&&(Object.keys(h.tweens[x]).length===0&&delete h.tweens[x],Object.keys(h.attrs[x]).length===0&&delete h.attrs[x])}}t.Tween=h,h.attrs={},h.tweens={},n.Node.prototype.to=function(p){const x=p.onFinish;p.node=this,p.onFinish=function(){this.destroy(),x&&x()},new h(p).play()},t.Easings={BackEaseIn(p,x,v,w){return v*(p/=w)*p*((1.70158+1)*p-1.70158)+x},BackEaseOut(p,x,v,w){return v*((p=p/w-1)*p*((1.70158+1)*p+1.70158)+1)+x},BackEaseInOut(p,x,v,w){let S=1.70158;return(p/=w/2)<1?v/2*(p*p*(((S*=1.525)+1)*p-S))+x:v/2*((p-=2)*p*(((S*=1.525)+1)*p+S)+2)+x},ElasticEaseIn(p,x,v,w,S,_){let y=0;return p===0?x:(p/=w)===1?x+v:(_||(_=w*.3),!S||S<Math.abs(v)?(S=v,y=_/4):y=_/(2*Math.PI)*Math.asin(v/S),-(S*Math.pow(2,10*(p-=1))*Math.sin((p*w-y)*(2*Math.PI)/_))+x)},ElasticEaseOut(p,x,v,w,S,_){let y=0;return p===0?x:(p/=w)===1?x+v:(_||(_=w*.3),!S||S<Math.abs(v)?(S=v,y=_/4):y=_/(2*Math.PI)*Math.asin(v/S),S*Math.pow(2,-10*p)*Math.sin((p*w-y)*(2*Math.PI)/_)+v+x)},ElasticEaseInOut(p,x,v,w,S,_){let y=0;return p===0?x:(p/=w/2)===2?x+v:(_||(_=w*(.3*1.5)),!S||S<Math.abs(v)?(S=v,y=_/4):y=_/(2*Math.PI)*Math.asin(v/S),p<1?-.5*(S*Math.pow(2,10*(p-=1))*Math.sin((p*w-y)*(2*Math.PI)/_))+x:S*Math.pow(2,-10*(p-=1))*Math.sin((p*w-y)*(2*Math.PI)/_)*.5+v+x)},BounceEaseOut(p,x,v,w){return(p/=w)<1/2.75?v*(7.5625*p*p)+x:p<2/2.75?v*(7.5625*(p-=1.5/2.75)*p+.75)+x:p<2.5/2.75?v*(7.5625*(p-=2.25/2.75)*p+.9375)+x:v*(7.5625*(p-=2.625/2.75)*p+.984375)+x},BounceEaseIn(p,x,v,w){return v-t.Easings.BounceEaseOut(w-p,0,v,w)+x},BounceEaseInOut(p,x,v,w){return p<w/2?t.Easings.BounceEaseIn(p*2,0,v,w)*.5+x:t.Easings.BounceEaseOut(p*2-w,0,v,w)*.5+v*.5+x},EaseIn(p,x,v,w){return v*(p/=w)*p+x},EaseOut(p,x,v,w){return-v*(p/=w)*(p-2)+x},EaseInOut(p,x,v,w){return(p/=w/2)<1?v/2*p*p+x:-v/2*(--p*(p-2)-1)+x},StrongEaseIn(p,x,v,w){return v*(p/=w)*p*p*p*p+x},StrongEaseOut(p,x,v,w){return v*((p=p/w-1)*p*p*p*p+1)+x},StrongEaseInOut(p,x,v,w){return(p/=w/2)<1?v/2*p*p*p*p*p+x:v/2*((p-=2)*p*p*p*p+2)+x},Linear(p,x,v,w){return v*p/w+x}}})(I9);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=or,r=yn,n=on,s=nd,a=D9,i=cm,o=Dy,l=hh,u=Fy,d=rs,g=gh,h=I9,p=al,x=zi;t.Konva=r.Util._assign(e.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:s.Container,Stage:a.Stage,stages:a.stages,Layer:i.Layer,FastLayer:o.FastLayer,Group:l.Group,DD:u.DD,Shape:d.Shape,shapes:d.shapes,Animation:g.Animation,Tween:h.Tween,Easings:h.Easings,Context:p.Context,Canvas:x.Canvas}),t.default=t.Konva})(_1);var Ry={};Object.defineProperty(Ry,"__esModule",{value:!0});Ry.Arc=void 0;const My=dr,$K=rs,Y5=or,Ly=Jt,WK=or;let bl=class extends $K.Shape{_sceneFunc(e){const r=Y5.Konva.getAngle(this.angle()),n=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,r,n),e.arc(0,0,this.innerRadius(),r,0,!n),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),r=this.outerRadius(),n=this.clockwise(),s=Y5.Konva.getAngle(n?360-this.angle():this.angle()),a=Math.cos(Math.min(s,Math.PI)),i=1,o=Math.sin(Math.min(Math.max(Math.PI,s),3*Math.PI/2)),l=Math.sin(Math.min(s,Math.PI/2)),u=a*(a>0?e:r),d=i*r,g=o*(o>0?e:r),h=l*(l>0?r:e);return{x:u,y:n?-1*h:g,width:d-u,height:h-g}}};Ry.Arc=bl;bl.prototype._centroid=!0;bl.prototype.className="Arc";bl.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,WK._registerNode)(bl);My.Factory.addGetterSetter(bl,"innerRadius",0,(0,Ly.getNumberValidator)());My.Factory.addGetterSetter(bl,"outerRadius",0,(0,Ly.getNumberValidator)());My.Factory.addGetterSetter(bl,"angle",0,(0,Ly.getNumberValidator)());My.Factory.addGetterSetter(bl,"clockwise",!1,(0,Ly.getBooleanValidator)());var Iy={},um={};Object.defineProperty(um,"__esModule",{value:!0});um.Line=void 0;const Oy=dr,zK=or,HK=rs,O9=Jt;function Zb(t,e,r,n,s,a,i){const o=Math.sqrt(Math.pow(r-t,2)+Math.pow(n-e,2)),l=Math.sqrt(Math.pow(s-r,2)+Math.pow(a-n,2)),u=i*o/(o+l),d=i*l/(o+l),g=r-u*(s-t),h=n-u*(a-e),p=r+d*(s-t),x=n+d*(a-e);return[g,h,p,x]}function J5(t,e){const r=t.length,n=[];for(let s=2;s<r-2;s+=2){const a=Zb(t[s-2],t[s-1],t[s],t[s+1],t[s+2],t[s+3],e);isNaN(a[0])||(n.push(a[0]),n.push(a[1]),n.push(t[s]),n.push(t[s+1]),n.push(a[2]),n.push(a[3]))}return n}let jc=class extends HK.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){const r=this.points(),n=r.length,s=this.tension(),a=this.closed(),i=this.bezier();if(!n)return;let o=0;if(e.beginPath(),e.moveTo(r[0],r[1]),s!==0&&n>4){const l=this.getTensionPoints(),u=l.length;for(o=a?0:4,a||e.quadraticCurveTo(l[0],l[1],l[2],l[3]);o<u-2;)e.bezierCurveTo(l[o++],l[o++],l[o++],l[o++],l[o++],l[o++]);a||e.quadraticCurveTo(l[u-2],l[u-1],r[n-2],r[n-1])}else if(i)for(o=2;o<n;)e.bezierCurveTo(r[o++],r[o++],r[o++],r[o++],r[o++],r[o++]);else for(o=2;o<n;o+=2)e.lineTo(r[o],r[o+1]);a?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():J5(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),r=e.length,n=this.tension(),s=Zb(e[r-2],e[r-1],e[0],e[1],e[2],e[3],n),a=Zb(e[r-4],e[r-3],e[r-2],e[r-1],e[0],e[1],n),i=J5(e,n);return[s[2],s[3]].concat(i).concat([a[0],a[1],e[r-2],e[r-1],a[2],a[3],s[0],s[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let r=e[0],n=e[0],s=e[1],a=e[1],i,o;for(let l=0;l<e.length/2;l++)i=e[l*2],o=e[l*2+1],r=Math.min(r,i),n=Math.max(n,i),s=Math.min(s,o),a=Math.max(a,o);return{x:r,y:s,width:n-r,height:a-s}}};um.Line=jc;jc.prototype.className="Line";jc.prototype._attrsAffectingSize=["points","bezier","tension"];(0,zK._registerNode)(jc);Oy.Factory.addGetterSetter(jc,"closed",!1);Oy.Factory.addGetterSetter(jc,"bezier",!1);Oy.Factory.addGetterSetter(jc,"tension",0,(0,O9.getNumberValidator)());Oy.Factory.addGetterSetter(jc,"points",[],(0,O9.getNumberArrayValidator)());var mh={},B9={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(i,o,l)=>{let u,d;const h=l/2;u=0;for(let p=0;p<20;p++)d=h*t.tValues[20][p]+h,u+=t.cValues[20][p]*n(i,o,d);return h*u};t.getCubicArcLength=e;const r=(i,o,l)=>{l===void 0&&(l=1);const u=i[0]-2*i[1]+i[2],d=o[0]-2*o[1]+o[2],g=2*i[1]-2*i[0],h=2*o[1]-2*o[0],p=4*(u*u+d*d),x=4*(u*g+d*h),v=g*g+h*h;if(p===0)return l*Math.sqrt(Math.pow(i[2]-i[0],2)+Math.pow(o[2]-o[0],2));const w=x/(2*p),S=v/p,_=l+w,y=S-w*w,k=_*_+y>0?Math.sqrt(_*_+y):0,N=w*w+y>0?Math.sqrt(w*w+y):0,E=w+Math.sqrt(w*w+y)!==0?y*Math.log(Math.abs((_+k)/(w+N))):0;return Math.sqrt(p)/2*(_*k-w*N+E)};t.getQuadraticArcLength=r;function n(i,o,l){const u=s(1,l,i),d=s(1,l,o),g=u*u+d*d;return Math.sqrt(g)}const s=(i,o,l)=>{const u=l.length-1;let d,g;if(u===0)return 0;if(i===0){g=0;for(let h=0;h<=u;h++)g+=t.binomialCoefficients[u][h]*Math.pow(1-o,u-h)*Math.pow(o,h)*l[h];return g}else{d=new Array(u);for(let h=0;h<u;h++)d[h]=u*(l[h+1]-l[h]);return s(i-1,o,d)}},a=(i,o,l)=>{let u=1,d=i/o,g=(i-l(d))/o,h=0;for(;u>.001;){const p=l(d+g),x=Math.abs(i-p)/o;if(x<u)u=x,d+=g;else{const v=l(d-g),w=Math.abs(i-v)/o;w<u?(u=w,d-=g):g/=2}if(h++,h>500)break}return d};t.t2length=a})(B9);Object.defineProperty(mh,"__esModule",{value:!0});mh.Path=void 0;const GK=dr,VK=or,KK=rs,Id=B9;let dm=class ma extends KK.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=ma.parsePathData(this.data()),this.pathLength=ma.getPathLength(this.dataArray)}_sceneFunc(e){const r=this.dataArray;e.beginPath();let n=!1;for(let s=0;s<r.length;s++){const a=r[s].command,i=r[s].points;switch(a){case"L":e.lineTo(i[0],i[1]);break;case"M":e.moveTo(i[0],i[1]);break;case"C":e.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);break;case"Q":e.quadraticCurveTo(i[0],i[1],i[2],i[3]);break;case"A":const o=i[0],l=i[1],u=i[2],d=i[3],g=i[4],h=i[5],p=i[6],x=i[7],v=u>d?u:d,w=u>d?1:u/d,S=u>d?d/u:1;e.translate(o,l),e.rotate(p),e.scale(w,S),e.arc(0,0,v,g,g+h,1-x),e.scale(1/w,1/S),e.rotate(-p),e.translate(-o,-l);break;case"z":n=!0,e.closePath();break}}!n&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(l){if(l.command==="A"){const u=l.points[4],d=l.points[5],g=l.points[4]+d;let h=Math.PI/180;if(Math.abs(u-g)<h&&(h=Math.abs(u-g)),d<0)for(let p=u-h;p>g;p-=h){const x=ma.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],p,0);e.push(x.x,x.y)}else for(let p=u+h;p<g;p+=h){const x=ma.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],p,0);e.push(x.x,x.y)}}else if(l.command==="C")for(let u=0;u<=1;u+=.01){const d=ma.getPointOnCubicBezier(u,l.start.x,l.start.y,l.points[0],l.points[1],l.points[2],l.points[3],l.points[4],l.points[5]);e.push(d.x,d.y)}else e=e.concat(l.points)});let r=e[0],n=e[0],s=e[1],a=e[1],i,o;for(let l=0;l<e.length/2;l++)i=e[l*2],o=e[l*2+1],isNaN(i)||(r=Math.min(r,i),n=Math.max(n,i)),isNaN(o)||(s=Math.min(s,o),a=Math.max(a,o));return{x:r,y:s,width:n-r,height:a-s}}getLength(){return this.pathLength}getPointAtLength(e){return ma.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,r,n,s){return Math.sqrt((n-e)*(n-e)+(s-r)*(s-r))}static getPathLength(e){let r=0;for(let n=0;n<e.length;++n)r+=e[n].pathLength;return r}static getPointAtLengthOfDataArray(e,r){let n,s=0,a=r.length;if(!a)return null;for(;s<a&&e>r[s].pathLength;)e-=r[s].pathLength,++s;if(s===a)return n=r[s-1].points.slice(-2),{x:n[0],y:n[1]};if(e<.01)return r[s].command==="M"?(n=r[s].points.slice(0,2),{x:n[0],y:n[1]}):{x:r[s].start.x,y:r[s].start.y};const i=r[s],o=i.points;switch(i.command){case"L":return ma.getPointOnLine(e,i.start.x,i.start.y,o[0],o[1]);case"C":return ma.getPointOnCubicBezier((0,Id.t2length)(e,ma.getPathLength(r),v=>(0,Id.getCubicArcLength)([i.start.x,o[0],o[2],o[4]],[i.start.y,o[1],o[3],o[5]],v)),i.start.x,i.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return ma.getPointOnQuadraticBezier((0,Id.t2length)(e,ma.getPathLength(r),v=>(0,Id.getQuadraticArcLength)([i.start.x,o[0],o[2]],[i.start.y,o[1],o[3]],v)),i.start.x,i.start.y,o[0],o[1],o[2],o[3]);case"A":const l=o[0],u=o[1],d=o[2],g=o[3],h=o[5],p=o[6];let x=o[4];return x+=h*e/i.pathLength,ma.getPointOnEllipticalArc(l,u,d,g,x,p)}return null}static getPointOnLine(e,r,n,s,a,i,o){i=i??r,o=o??n;const l=this.getLineLength(r,n,s,a);if(l<1e-10)return{x:r,y:n};if(s===r)return{x:i,y:o+(a>n?e:-e)};const u=(a-n)/(s-r),d=Math.sqrt(e*e/(1+u*u))*(s<r?-1:1),g=u*d;if(Math.abs(o-n-u*(i-r))<1e-10)return{x:i+d,y:o+g};const h=((i-r)*(s-r)+(o-n)*(a-n))/(l*l),p=r+h*(s-r),x=n+h*(a-n),v=this.getLineLength(i,o,p,x),w=Math.sqrt(e*e-v*v),S=Math.sqrt(w*w/(1+u*u))*(s<r?-1:1),_=u*S;return{x:p+S,y:x+_}}static getPointOnCubicBezier(e,r,n,s,a,i,o,l,u){function d(w){return w*w*w}function g(w){return 3*w*w*(1-w)}function h(w){return 3*w*(1-w)*(1-w)}function p(w){return(1-w)*(1-w)*(1-w)}const x=l*d(e)+i*g(e)+s*h(e)+r*p(e),v=u*d(e)+o*g(e)+a*h(e)+n*p(e);return{x,y:v}}static getPointOnQuadraticBezier(e,r,n,s,a,i,o){function l(p){return p*p}function u(p){return 2*p*(1-p)}function d(p){return(1-p)*(1-p)}const g=i*l(e)+s*u(e)+r*d(e),h=o*l(e)+a*u(e)+n*d(e);return{x:g,y:h}}static getPointOnEllipticalArc(e,r,n,s,a,i){const o=Math.cos(i),l=Math.sin(i),u={x:n*Math.cos(a),y:s*Math.sin(a)};return{x:e+(u.x*o-u.y*l),y:r+(u.x*l+u.y*o)}}static parsePathData(e){if(!e)return[];let r=e;const n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];r=r.replace(new RegExp(" ","g"),",");for(let g=0;g<n.length;g++)r=r.replace(new RegExp(n[g],"g"),"|"+n[g]);const s=r.split("|"),a=[],i=[];let o=0,l=0;const u=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let d;for(let g=1;g<s.length;g++){let h=s[g],p=h.charAt(0);for(h=h.slice(1),i.length=0;d=u.exec(h);)i.push(d[0]);const x=[];for(let v=0,w=i.length;v<w;v++){if(i[v]==="00"){x.push(0,0);continue}const S=parseFloat(i[v]);isNaN(S)?x.push(0):x.push(S)}for(;x.length>0&&!isNaN(x[0]);){let v="",w=[];const S=o,_=l;let y,k,N,E,A,C,F,D,R,M;switch(p){case"l":o+=x.shift(),l+=x.shift(),v="L",w.push(o,l);break;case"L":o=x.shift(),l=x.shift(),w.push(o,l);break;case"m":const B=x.shift(),J=x.shift();if(o+=B,l+=J,v="M",a.length>2&&a[a.length-1].command==="z"){for(let X=a.length-2;X>=0;X--)if(a[X].command==="M"){o=a[X].points[0]+B,l=a[X].points[1]+J;break}}w.push(o,l),p="l";break;case"M":o=x.shift(),l=x.shift(),v="M",w.push(o,l),p="L";break;case"h":o+=x.shift(),v="L",w.push(o,l);break;case"H":o=x.shift(),v="L",w.push(o,l);break;case"v":l+=x.shift(),v="L",w.push(o,l);break;case"V":l=x.shift(),v="L",w.push(o,l);break;case"C":w.push(x.shift(),x.shift(),x.shift(),x.shift()),o=x.shift(),l=x.shift(),w.push(o,l);break;case"c":w.push(o+x.shift(),l+x.shift(),o+x.shift(),l+x.shift()),o+=x.shift(),l+=x.shift(),v="C",w.push(o,l);break;case"S":k=o,N=l,y=a[a.length-1],y.command==="C"&&(k=o+(o-y.points[2]),N=l+(l-y.points[3])),w.push(k,N,x.shift(),x.shift()),o=x.shift(),l=x.shift(),v="C",w.push(o,l);break;case"s":k=o,N=l,y=a[a.length-1],y.command==="C"&&(k=o+(o-y.points[2]),N=l+(l-y.points[3])),w.push(k,N,o+x.shift(),l+x.shift()),o+=x.shift(),l+=x.shift(),v="C",w.push(o,l);break;case"Q":w.push(x.shift(),x.shift()),o=x.shift(),l=x.shift(),w.push(o,l);break;case"q":w.push(o+x.shift(),l+x.shift()),o+=x.shift(),l+=x.shift(),v="Q",w.push(o,l);break;case"T":k=o,N=l,y=a[a.length-1],y.command==="Q"&&(k=o+(o-y.points[0]),N=l+(l-y.points[1])),o=x.shift(),l=x.shift(),v="Q",w.push(k,N,o,l);break;case"t":k=o,N=l,y=a[a.length-1],y.command==="Q"&&(k=o+(o-y.points[0]),N=l+(l-y.points[1])),o+=x.shift(),l+=x.shift(),v="Q",w.push(k,N,o,l);break;case"A":E=x.shift(),A=x.shift(),C=x.shift(),F=x.shift(),D=x.shift(),R=o,M=l,o=x.shift(),l=x.shift(),v="A",w=this.convertEndpointToCenterParameterization(R,M,o,l,F,D,E,A,C);break;case"a":E=x.shift(),A=x.shift(),C=x.shift(),F=x.shift(),D=x.shift(),R=o,M=l,o+=x.shift(),l+=x.shift(),v="A",w=this.convertEndpointToCenterParameterization(R,M,o,l,F,D,E,A,C);break}a.push({command:v||p,points:w,start:{x:S,y:_},pathLength:this.calcLength(S,_,v||p,w)})}(p==="z"||p==="Z")&&a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(e,r,n,s){let a,i,o,l;const u=ma;switch(n){case"L":return u.getLineLength(e,r,s[0],s[1]);case"C":return(0,Id.getCubicArcLength)([e,s[0],s[2],s[4]],[r,s[1],s[3],s[5]],1);case"Q":return(0,Id.getQuadraticArcLength)([e,s[0],s[2]],[r,s[1],s[3]],1);case"A":a=0;const d=s[4],g=s[5],h=s[4]+g;let p=Math.PI/180;if(Math.abs(d-h)<p&&(p=Math.abs(d-h)),i=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],d,0),g<0)for(l=d-p;l>h;l-=p)o=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),a+=u.getLineLength(i.x,i.y,o.x,o.y),i=o;else for(l=d+p;l<h;l+=p)o=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),a+=u.getLineLength(i.x,i.y,o.x,o.y),i=o;return o=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],h,0),a+=u.getLineLength(i.x,i.y,o.x,o.y),a}return 0}static convertEndpointToCenterParameterization(e,r,n,s,a,i,o,l,u){const d=u*(Math.PI/180),g=Math.cos(d)*(e-n)/2+Math.sin(d)*(r-s)/2,h=-1*Math.sin(d)*(e-n)/2+Math.cos(d)*(r-s)/2,p=g*g/(o*o)+h*h/(l*l);p>1&&(o*=Math.sqrt(p),l*=Math.sqrt(p));let x=Math.sqrt((o*o*(l*l)-o*o*(h*h)-l*l*(g*g))/(o*o*(h*h)+l*l*(g*g)));a===i&&(x*=-1),isNaN(x)&&(x=0);const v=x*o*h/l,w=x*-l*g/o,S=(e+n)/2+Math.cos(d)*v-Math.sin(d)*w,_=(r+s)/2+Math.sin(d)*v+Math.cos(d)*w,y=function(D){return Math.sqrt(D[0]*D[0]+D[1]*D[1])},k=function(D,R){return(D[0]*R[0]+D[1]*R[1])/(y(D)*y(R))},N=function(D,R){return(D[0]*R[1]<D[1]*R[0]?-1:1)*Math.acos(k(D,R))},E=N([1,0],[(g-v)/o,(h-w)/l]),A=[(g-v)/o,(h-w)/l],C=[(-1*g-v)/o,(-1*h-w)/l];let F=N(A,C);return k(A,C)<=-1&&(F=Math.PI),k(A,C)>=1&&(F=0),i===0&&F>0&&(F=F-2*Math.PI),i===1&&F<0&&(F=F+2*Math.PI),[S,_,o,l,E,F,d,i]}};mh.Path=dm;dm.prototype.className="Path";dm.prototype._attrsAffectingSize=["data"];(0,VK._registerNode)(dm);GK.Factory.addGetterSetter(dm,"data");Object.defineProperty(Iy,"__esModule",{value:!0});Iy.Arrow=void 0;const By=dr,XK=um,U9=Jt,YK=or,Q5=mh;let ad=class extends XK.Line{_sceneFunc(e){super._sceneFunc(e);const r=Math.PI*2,n=this.points();let s=n;const a=this.tension()!==0&&n.length>4;a&&(s=this.getTensionPoints());const i=this.pointerLength(),o=n.length;let l,u;if(a){const h=[s[s.length-4],s[s.length-3],s[s.length-2],s[s.length-1],n[o-2],n[o-1]],p=Q5.Path.calcLength(s[s.length-4],s[s.length-3],"C",h),x=Q5.Path.getPointOnQuadraticBezier(Math.min(1,1-i/p),h[0],h[1],h[2],h[3],h[4],h[5]);l=n[o-2]-x.x,u=n[o-1]-x.y}else l=n[o-2]-n[o-4],u=n[o-1]-n[o-3];const d=(Math.atan2(u,l)+r)%r,g=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(n[o-2],n[o-1]),e.rotate(d),e.moveTo(0,0),e.lineTo(-i,g/2),e.lineTo(-i,-g/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(n[0],n[1]),a?(l=(s[0]+s[2])/2-n[0],u=(s[1]+s[3])/2-n[1]):(l=n[2]-n[0],u=n[3]-n[1]),e.rotate((Math.atan2(-u,-l)+r)%r),e.moveTo(0,0),e.lineTo(-i,g/2),e.lineTo(-i,-g/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const r=this.dashEnabled();r&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),r&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),r=this.pointerWidth()/2;return{x:e.x,y:e.y-r,width:e.width,height:e.height+r*2}}};Iy.Arrow=ad;ad.prototype.className="Arrow";(0,YK._registerNode)(ad);By.Factory.addGetterSetter(ad,"pointerLength",10,(0,U9.getNumberValidator)());By.Factory.addGetterSetter(ad,"pointerWidth",10,(0,U9.getNumberValidator)());By.Factory.addGetterSetter(ad,"pointerAtBeginning",!1);By.Factory.addGetterSetter(ad,"pointerAtEnding",!0);var Uy={};Object.defineProperty(Uy,"__esModule",{value:!0});Uy.Circle=void 0;const JK=dr,QK=rs,qK=Jt,ZK=or;let ph=class extends QK.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}};Uy.Circle=ph;ph.prototype._centroid=!0;ph.prototype.className="Circle";ph.prototype._attrsAffectingSize=["radius"];(0,ZK._registerNode)(ph);JK.Factory.addGetterSetter(ph,"radius",0,(0,qK.getNumberValidator)());var $y={};Object.defineProperty($y,"__esModule",{value:!0});$y.Ellipse=void 0;const BC=dr,eX=rs,$9=Jt,tX=or;let Fc=class extends eX.Shape{_sceneFunc(e){const r=this.radiusX(),n=this.radiusY();e.beginPath(),e.save(),r!==n&&e.scale(1,n/r),e.arc(0,0,r,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}};$y.Ellipse=Fc;Fc.prototype.className="Ellipse";Fc.prototype._centroid=!0;Fc.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,tX._registerNode)(Fc);BC.Factory.addComponentsGetterSetter(Fc,"radius",["x","y"]);BC.Factory.addGetterSetter(Fc,"radiusX",0,(0,$9.getNumberValidator)());BC.Factory.addGetterSetter(Fc,"radiusY",0,(0,$9.getNumberValidator)());var Wy={};Object.defineProperty(Wy,"__esModule",{value:!0});Wy.Image=void 0;const K_=yn,id=dr,rX=rs,nX=or,fm=Jt;let Ao=class W9 extends rX.Shape{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",r=>{this._removeImageLoad(r.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),r=this.hasShadow();return e&&r?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const r=this.getWidth(),n=this.getHeight(),s=this.cornerRadius(),a=this.attrs.image;let i;if(a){const o=this.attrs.cropWidth,l=this.attrs.cropHeight;o&&l?i=[a,this.cropX(),this.cropY(),o,l,0,0,r,n]:i=[a,0,0,r,n]}(this.hasFill()||this.hasStroke()||s)&&(e.beginPath(),s?K_.Util.drawRoundedRectPath(e,r,n,s):e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)),a&&(s&&e.clip(),e.drawImage.apply(e,i))}_hitFunc(e){const r=this.width(),n=this.height(),s=this.cornerRadius();e.beginPath(),s?K_.Util.drawRoundedRectPath(e,r,n,s):e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,r;return(e=this.attrs.width)!==null&&e!==void 0?e:(r=this.image())===null||r===void 0?void 0:r.width}getHeight(){var e,r;return(e=this.attrs.height)!==null&&e!==void 0?e:(r=this.image())===null||r===void 0?void 0:r.height}static fromURL(e,r,n=null){const s=K_.Util.createImageElement();s.onload=function(){const a=new W9({image:s});r(a)},s.onerror=n,s.crossOrigin="Anonymous",s.src=e}};Wy.Image=Ao;Ao.prototype.className="Image";(0,nX._registerNode)(Ao);id.Factory.addGetterSetter(Ao,"cornerRadius",0,(0,fm.getNumberOrArrayOfNumbersValidator)(4));id.Factory.addGetterSetter(Ao,"image");id.Factory.addComponentsGetterSetter(Ao,"crop",["x","y","width","height"]);id.Factory.addGetterSetter(Ao,"cropX",0,(0,fm.getNumberValidator)());id.Factory.addGetterSetter(Ao,"cropY",0,(0,fm.getNumberValidator)());id.Factory.addGetterSetter(Ao,"cropWidth",0,(0,fm.getNumberValidator)());id.Factory.addGetterSetter(Ao,"cropHeight",0,(0,fm.getNumberValidator)());var Hf={};Object.defineProperty(Hf,"__esModule",{value:!0});Hf.Tag=Hf.Label=void 0;const zy=dr,sX=rs,aX=hh,UC=Jt,z9=or,H9=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],iX="Change.konva",oX="none",eS="up",tS="right",rS="down",nS="left",lX=H9.length;let $C=class extends aX.Group{constructor(e){super(e),this.on("add.konva",function(r){this._addListeners(r.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let r=this,n;const s=function(){r._sync()};for(n=0;n<lX;n++)e.on(H9[n]+iX,s)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),r=this.getTag(),n,s,a,i,o,l,u;if(e&&r){switch(n=e.width(),s=e.height(),a=r.pointerDirection(),i=r.pointerWidth(),u=r.pointerHeight(),o=0,l=0,a){case eS:o=n/2,l=-1*u;break;case tS:o=n+i,l=s/2;break;case rS:o=n/2,l=s+u;break;case nS:o=-1*i,l=s/2;break}r.setAttrs({x:-1*o,y:-1*l,width:n,height:s}),e.setAttrs({x:-1*o,y:-1*l})}}};Hf.Label=$C;$C.prototype.className="Label";(0,z9._registerNode)($C);let od=class extends sX.Shape{_sceneFunc(e){const r=this.width(),n=this.height(),s=this.pointerDirection(),a=this.pointerWidth(),i=this.pointerHeight(),o=this.cornerRadius();let l=0,u=0,d=0,g=0;typeof o=="number"?l=u=d=g=Math.min(o,r/2,n/2):(l=Math.min(o[0]||0,r/2,n/2),u=Math.min(o[1]||0,r/2,n/2),g=Math.min(o[2]||0,r/2,n/2),d=Math.min(o[3]||0,r/2,n/2)),e.beginPath(),e.moveTo(l,0),s===eS&&(e.lineTo((r-a)/2,0),e.lineTo(r/2,-1*i),e.lineTo((r+a)/2,0)),e.lineTo(r-u,0),e.arc(r-u,u,u,Math.PI*3/2,0,!1),s===tS&&(e.lineTo(r,(n-i)/2),e.lineTo(r+a,n/2),e.lineTo(r,(n+i)/2)),e.lineTo(r,n-g),e.arc(r-g,n-g,g,0,Math.PI/2,!1),s===rS&&(e.lineTo((r+a)/2,n),e.lineTo(r/2,n+i),e.lineTo((r-a)/2,n)),e.lineTo(d,n),e.arc(d,n-d,d,Math.PI/2,Math.PI,!1),s===nS&&(e.lineTo(0,(n+i)/2),e.lineTo(-1*a,n/2),e.lineTo(0,(n-i)/2)),e.lineTo(0,l),e.arc(l,l,l,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,r=0,n=this.pointerWidth(),s=this.pointerHeight(),a=this.pointerDirection(),i=this.width(),o=this.height();return a===eS?(r-=s,o+=s):a===rS?o+=s:a===nS?(e-=n*1.5,i+=n):a===tS&&(i+=n*1.5),{x:e,y:r,width:i,height:o}}};Hf.Tag=od;od.prototype.className="Tag";(0,z9._registerNode)(od);zy.Factory.addGetterSetter(od,"pointerDirection",oX);zy.Factory.addGetterSetter(od,"pointerWidth",0,(0,UC.getNumberValidator)());zy.Factory.addGetterSetter(od,"pointerHeight",0,(0,UC.getNumberValidator)());zy.Factory.addGetterSetter(od,"cornerRadius",0,(0,UC.getNumberOrArrayOfNumbersValidator)(4));var hm={};Object.defineProperty(hm,"__esModule",{value:!0});hm.Rect=void 0;const cX=dr,uX=rs,dX=or,fX=yn,hX=Jt;let Hy=class extends uX.Shape{_sceneFunc(e){const r=this.cornerRadius(),n=this.width(),s=this.height();e.beginPath(),r?fX.Util.drawRoundedRectPath(e,n,s,r):e.rect(0,0,n,s),e.closePath(),e.fillStrokeShape(this)}};hm.Rect=Hy;Hy.prototype.className="Rect";(0,dX._registerNode)(Hy);cX.Factory.addGetterSetter(Hy,"cornerRadius",0,(0,hX.getNumberOrArrayOfNumbersValidator)(4));var Gy={};Object.defineProperty(Gy,"__esModule",{value:!0});Gy.RegularPolygon=void 0;const G9=dr,gX=rs,V9=Jt,mX=or;let ld=class extends gX.Shape{_sceneFunc(e){const r=this._getPoints();e.beginPath(),e.moveTo(r[0].x,r[0].y);for(let n=1;n<r.length;n++)e.lineTo(r[n].x,r[n].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,r=this.attrs.radius||0,n=[];for(let s=0;s<e;s++)n.push({x:r*Math.sin(s*2*Math.PI/e),y:-1*r*Math.cos(s*2*Math.PI/e)});return n}getSelfRect(){const e=this._getPoints();let r=e[0].x,n=e[0].y,s=e[0].x,a=e[0].y;return e.forEach(i=>{r=Math.min(r,i.x),n=Math.max(n,i.x),s=Math.min(s,i.y),a=Math.max(a,i.y)}),{x:r,y:s,width:n-r,height:a-s}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}};Gy.RegularPolygon=ld;ld.prototype.className="RegularPolygon";ld.prototype._centroid=!0;ld.prototype._attrsAffectingSize=["radius"];(0,mX._registerNode)(ld);G9.Factory.addGetterSetter(ld,"radius",0,(0,V9.getNumberValidator)());G9.Factory.addGetterSetter(ld,"sides",0,(0,V9.getNumberValidator)());var Vy={};Object.defineProperty(Vy,"__esModule",{value:!0});Vy.Ring=void 0;const K9=dr,pX=rs,X9=Jt,xX=or,q5=Math.PI*2;let cd=class extends pX.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,q5,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),q5,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}};Vy.Ring=cd;cd.prototype.className="Ring";cd.prototype._centroid=!0;cd.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,xX._registerNode)(cd);K9.Factory.addGetterSetter(cd,"innerRadius",0,(0,X9.getNumberValidator)());K9.Factory.addGetterSetter(cd,"outerRadius",0,(0,X9.getNumberValidator)());var Ky={};Object.defineProperty(Ky,"__esModule",{value:!0});Ky.Sprite=void 0;const ud=dr,yX=rs,vX=gh,Y9=Jt,wX=or;let jo=class extends yX.Shape{constructor(e){super(e),this._updated=!0,this.anim=new vX.Animation(()=>{const r=this._updated;return this._updated=!1,r}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const r=this.animation(),n=this.frameIndex(),s=n*4,a=this.animations()[r],i=this.frameOffsets(),o=a[s+0],l=a[s+1],u=a[s+2],d=a[s+3],g=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,u,d),e.closePath(),e.fillStrokeShape(this)),g)if(i){const h=i[r],p=n*2;e.drawImage(g,o,l,u,d,h[p+0],h[p+1],u,d)}else e.drawImage(g,o,l,u,d,0,0,u,d)}_hitFunc(e){const r=this.animation(),n=this.frameIndex(),s=n*4,a=this.animations()[r],i=this.frameOffsets(),o=a[s+2],l=a[s+3];if(e.beginPath(),i){const u=i[r],d=n*2;e.rect(u[d+0],u[d+1],o,l)}else e.rect(0,0,o,l);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),r=this.animation(),n=this.animations(),s=n[r],a=s.length/4;e<a-1?this.frameIndex(e+1):this.frameIndex(0)}};Ky.Sprite=jo;jo.prototype.className="Sprite";(0,wX._registerNode)(jo);ud.Factory.addGetterSetter(jo,"animation");ud.Factory.addGetterSetter(jo,"animations");ud.Factory.addGetterSetter(jo,"frameOffsets");ud.Factory.addGetterSetter(jo,"image");ud.Factory.addGetterSetter(jo,"frameIndex",0,(0,Y9.getNumberValidator)());ud.Factory.addGetterSetter(jo,"frameRate",17,(0,Y9.getNumberValidator)());ud.Factory.backCompat(jo,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Xy={};Object.defineProperty(Xy,"__esModule",{value:!0});Xy.Star=void 0;const WC=dr,_X=rs,zC=Jt,bX=or;let Pc=class extends _X.Shape{_sceneFunc(e){const r=this.innerRadius(),n=this.outerRadius(),s=this.numPoints();e.beginPath(),e.moveTo(0,0-n);for(let a=1;a<s*2;a++){const i=a%2===0?n:r,o=i*Math.sin(a*Math.PI/s),l=-1*i*Math.cos(a*Math.PI/s);e.lineTo(o,l)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}};Xy.Star=Pc;Pc.prototype.className="Star";Pc.prototype._centroid=!0;Pc.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,bX._registerNode)(Pc);WC.Factory.addGetterSetter(Pc,"numPoints",5,(0,zC.getNumberValidator)());WC.Factory.addGetterSetter(Pc,"innerRadius",0,(0,zC.getNumberValidator)());WC.Factory.addGetterSetter(Pc,"outerRadius",0,(0,zC.getNumberValidator)());var xh={};Object.defineProperty(xh,"__esModule",{value:!0});xh.Text=void 0;xh.stringToArray=au;const sS=yn,Js=dr,SX=rs,X_=or,Dc=Jt,kX=or;function au(t){return[...t].reduce((e,r,n,s)=>{if(new RegExp("\\p{Emoji}","u").test(r)){const a=s[n+1];a&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(a)?(e.push(r+a),s[n+1]=""):e.push(r)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(r+(s[n+1]||""))?e.push(r+s[n+1]):n>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(r)?e[e.length-1]+=r:r&&e.push(r);return e},[])}const Od="auto",CX="center",J9="inherit",i0="justify",TX="Change.konva",EX="2d",Z5="-",Q9="left",NX="text",AX="Text",jX="top",FX="bottom",e6="middle",q9="normal",PX="px ",Jp=" ",DX="right",t6="rtl",RX="word",MX="char",r6="none",Y_="",Z9=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],LX=Z9.length;function IX(t){return t.split(",").map(e=>{e=e.trim();const r=e.indexOf(" ")>=0,n=e.indexOf('"')>=0||e.indexOf("'")>=0;return r&&!n&&(e=`"${e}"`),e}).join(", ")}let Qp;function J_(){return Qp||(Qp=sS.Util.createCanvasElement().getContext(EX),Qp)}function OX(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function BX(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function UX(t){return t=t||{},!t.fillLinearGradientColorStops&&!t.fillRadialGradientColorStops&&!t.fillPatternImage&&(t.fill=t.fill||"black"),t}let En=class extends SX.Shape{constructor(e){super(UX(e)),this._partialTextX=0,this._partialTextY=0;for(let r=0;r<LX;r++)this.on(Z9[r]+TX,this._setTextData);this._setTextData()}_sceneFunc(e){const r=this.textArr,n=r.length;if(!this.text())return;let s=this.padding(),a=this.fontSize(),i=this.lineHeight()*a,o=this.verticalAlign(),l=this.direction(),u=0,d=this.align(),g=this.getWidth(),h=this.letterSpacing(),p=this.fill(),x=this.textDecoration(),v=x.indexOf("underline")!==-1,w=x.indexOf("line-through")!==-1,S;l=l===J9?e.direction:l;let _=i/2,y=e6;if(X_.Konva._fixTextRendering){const k=this.measureSize("M");y="alphabetic",_=(k.fontBoundingBoxAscent-k.fontBoundingBoxDescent)/2+i/2}for(l===t6&&e.setAttr("direction",l),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",y),e.setAttr("textAlign",Q9),o===e6?u=(this.getHeight()-n*i-s*2)/2:o===FX&&(u=this.getHeight()-n*i-s*2),e.translate(s,u+s),S=0;S<n;S++){let k=0,N=0;const E=r[S],A=E.text,C=E.width,F=E.lastInParagraph;if(e.save(),d===DX?k+=g-C-s*2:d===CX&&(k+=(g-C-s*2)/2),v){e.save(),e.beginPath();const D=X_.Konva._fixTextRendering?Math.round(a/4):Math.round(a/2),R=k,M=_+N+D;e.moveTo(R,M);const B=d===i0&&!F?g-s*2:C;e.lineTo(R+Math.round(B),M),e.lineWidth=a/15;const J=this._getLinearGradient();e.strokeStyle=J||p,e.stroke(),e.restore()}if(w){e.save(),e.beginPath();const D=X_.Konva._fixTextRendering?-Math.round(a/4):0;e.moveTo(k,_+N+D);const R=d===i0&&!F?g-s*2:C;e.lineTo(k+Math.round(R),_+N+D),e.lineWidth=a/15;const M=this._getLinearGradient();e.strokeStyle=M||p,e.stroke(),e.restore()}if(l!==t6&&(h!==0||d===i0)){const D=A.split(" ").length-1,R=au(A);for(let M=0;M<R.length;M++){const B=R[M];B===" "&&!F&&d===i0&&(k+=(g-s*2-C)/D),this._partialTextX=k,this._partialTextY=_+N,this._partialText=B,e.fillStrokeShape(this),k+=this.measureSize(B).width+h}}else h!==0&&e.setAttr("letterSpacing",`${h}px`),this._partialTextX=k,this._partialTextY=_+N,this._partialText=A,e.fillStrokeShape(this);e.restore(),n>1&&(_+=i)}}_hitFunc(e){const r=this.getWidth(),n=this.getHeight();e.beginPath(),e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)}setText(e){const r=sS.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(NX,r),this}getWidth(){return this.attrs.width===Od||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Od||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return sS.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var r,n,s,a,i,o,l,u,d,g,h;let p=J_(),x=this.fontSize(),v;p.save(),p.font=this._getContextFont(),v=p.measureText(e),p.restore();const w=x/100;return{actualBoundingBoxAscent:(r=v.actualBoundingBoxAscent)!==null&&r!==void 0?r:71.58203125*w,actualBoundingBoxDescent:(n=v.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(s=v.actualBoundingBoxLeft)!==null&&s!==void 0?s:-7.421875*w,actualBoundingBoxRight:(a=v.actualBoundingBoxRight)!==null&&a!==void 0?a:75.732421875*w,alphabeticBaseline:(i=v.alphabeticBaseline)!==null&&i!==void 0?i:0,emHeightAscent:(o=v.emHeightAscent)!==null&&o!==void 0?o:100*w,emHeightDescent:(l=v.emHeightDescent)!==null&&l!==void 0?l:-20*w,fontBoundingBoxAscent:(u=v.fontBoundingBoxAscent)!==null&&u!==void 0?u:91*w,fontBoundingBoxDescent:(d=v.fontBoundingBoxDescent)!==null&&d!==void 0?d:21*w,hangingBaseline:(g=v.hangingBaseline)!==null&&g!==void 0?g:72.80000305175781*w,ideographicBaseline:(h=v.ideographicBaseline)!==null&&h!==void 0?h:-21*w,width:v.width,height:x}}_getContextFont(){return this.fontStyle()+Jp+this.fontVariant()+Jp+(this.fontSize()+PX)+IX(this.fontFamily())}_addTextLine(e){this.align()===i0&&(e=e.trim());const n=this._getTextWidth(e);return this.textArr.push({text:e,width:n,lastInParagraph:!1})}_getTextWidth(e){const r=this.letterSpacing(),n=e.length;return J_().measureText(e).width+r*n}_setTextData(){let e=this.text().split(`
`),r=+this.fontSize(),n=0,s=this.lineHeight()*r,a=this.attrs.width,i=this.attrs.height,o=a!==Od&&a!==void 0,l=i!==Od&&i!==void 0,u=this.padding(),d=a-u*2,g=i-u*2,h=0,p=this.wrap(),x=p!==r6,v=p!==MX&&x,w=this.ellipsis();this.textArr=[],J_().font=this._getContextFont();const S=w?this._getTextWidth(Y_):0;for(let _=0,y=e.length;_<y;++_){let k=e[_],N=this._getTextWidth(k);if(o&&N>d)for(;k.length>0;){let E=0,A=au(k).length,C="",F=0;for(;E<A;){const D=E+A>>>1,R=au(k),M=R.slice(0,D+1).join(""),B=this._getTextWidth(M);(w&&l&&h+s>g?B+S:B)<=d?(E=D+1,C=M,F=B):A=D}if(C){if(v){const M=au(k),B=au(C),J=M[B.length],X=J===Jp||J===Z5;let z;if(X&&F<=d)z=B.length;else{const H=B.lastIndexOf(Jp),U=B.lastIndexOf(Z5);z=Math.max(H,U)+1}z>0&&(E=z,C=M.slice(0,E).join(""),F=this._getTextWidth(C))}if(C=C.trimRight(),this._addTextLine(C),n=Math.max(n,F),h+=s,this._shouldHandleEllipsis(h)){this._tryToAddEllipsisToLastLine();break}if(k=au(k).slice(E).join("").trimLeft(),k.length>0&&(N=this._getTextWidth(k),N<=d)){this._addTextLine(k),h+=s,n=Math.max(n,N);break}}else break}else this._addTextLine(k),h+=s,n=Math.max(n,N),this._shouldHandleEllipsis(h)&&_<y-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&h+s>g)break}this.textHeight=r,this.textWidth=n}_shouldHandleEllipsis(e){const r=+this.fontSize(),n=this.lineHeight()*r,s=this.attrs.height,a=s!==Od&&s!==void 0,i=this.padding(),o=s-i*2;return!(this.wrap()!==r6)||a&&e+n>o}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,r=e!==Od&&e!==void 0,n=this.padding(),s=e-n*2,a=this.ellipsis(),i=this.textArr[this.textArr.length-1];!i||!a||(r&&(this._getTextWidth(i.text+Y_)<s||(i.text=i.text.slice(0,i.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(i.text+Y_))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,r=this.hasShadow();return e&&r?!0:super._useBufferCanvas()}};xh.Text=En;En.prototype._fillFunc=OX;En.prototype._strokeFunc=BX;En.prototype.className=AX;En.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,kX._registerNode)(En);Js.Factory.overWriteSetter(En,"width",(0,Dc.getNumberOrAutoValidator)());Js.Factory.overWriteSetter(En,"height",(0,Dc.getNumberOrAutoValidator)());Js.Factory.addGetterSetter(En,"direction",J9);Js.Factory.addGetterSetter(En,"fontFamily","Arial");Js.Factory.addGetterSetter(En,"fontSize",12,(0,Dc.getNumberValidator)());Js.Factory.addGetterSetter(En,"fontStyle",q9);Js.Factory.addGetterSetter(En,"fontVariant",q9);Js.Factory.addGetterSetter(En,"padding",0,(0,Dc.getNumberValidator)());Js.Factory.addGetterSetter(En,"align",Q9);Js.Factory.addGetterSetter(En,"verticalAlign",jX);Js.Factory.addGetterSetter(En,"lineHeight",1,(0,Dc.getNumberValidator)());Js.Factory.addGetterSetter(En,"wrap",RX);Js.Factory.addGetterSetter(En,"ellipsis",!1,(0,Dc.getBooleanValidator)());Js.Factory.addGetterSetter(En,"letterSpacing",0,(0,Dc.getNumberValidator)());Js.Factory.addGetterSetter(En,"text","",(0,Dc.getStringValidator)());Js.Factory.addGetterSetter(En,"textDecoration","");var Yy={};Object.defineProperty(Yy,"__esModule",{value:!0});Yy.TextPath=void 0;const Q_=yn,Qi=dr,$X=rs,o0=mh,q_=xh,eD=Jt,WX=or,zX="",tD="normal";function rD(t){t.fillText(this.partialText,0,0)}function nD(t){t.strokeText(this.partialText,0,0)}let ns=class extends $X.Shape{constructor(e){super(e),this.dummyCanvas=Q_.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return o0.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const r=this.pathLength;return e-1>r?null:o0.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=o0.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const r=this.textDecoration(),n=this.fill(),s=this.fontSize(),a=this.glyphInfo;r==="underline"&&e.beginPath();for(let i=0;i<a.length;i++){e.save();const o=a[i].p0;e.translate(o.x,o.y),e.rotate(a[i].rotation),this.partialText=a[i].text,e.fillStrokeShape(this),r==="underline"&&(i===0&&e.moveTo(0,s/2+1),e.lineTo(s,s/2+1)),e.restore()}r==="underline"&&(e.strokeStyle=n,e.lineWidth=s/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const r=this.glyphInfo;if(r.length>=1){const n=r[0].p0;e.moveTo(n.x,n.y)}for(let n=0;n<r.length;n++){const s=r[n].p1;e.lineTo(s.x,s.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return Q_.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return q_.Text.prototype.setText.call(this,e)}_getContextFont(){return q_.Text.prototype._getContextFont.call(this)}_getTextSize(e){const n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();const s=n.measureText(e);return n.restore(),{width:s.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const n=this.letterSpacing(),s=this.align(),a=this.kerningFunc(),i=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);let o=0;s==="center"&&(o=Math.max(0,this.pathLength/2-i/2)),s==="right"&&(o=Math.max(0,this.pathLength-i));const l=(0,q_.stringToArray)(this.text());let u=o;for(let d=0;d<l.length;d++){const g=this._getPointAtLength(u);if(!g)return;let h=this._getTextSize(l[d]).width+n;if(l[d]===" "&&s==="justify"){const _=this.text().split(" ").length-1;h+=(this.pathLength-i)/_}const p=this._getPointAtLength(u+h);if(!p)return;const x=o0.Path.getLineLength(g.x,g.y,p.x,p.y);let v=0;if(a)try{v=a(l[d-1],l[d])*this.fontSize()}catch{v=0}g.x+=v,p.x+=v,this.textWidth+=v;const w=o0.Path.getPointOnLine(v+x/2,g.x,g.y,p.x,p.y),S=Math.atan2(p.y-g.y,p.x-g.x);this.glyphInfo.push({transposeX:w.x,transposeY:w.y,text:l[d],rotation:S,p0:g,p1:p}),u+=h}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(u){e.push(u.p0.x),e.push(u.p0.y),e.push(u.p1.x),e.push(u.p1.y)});let r=e[0]||0,n=e[0]||0,s=e[1]||0,a=e[1]||0,i,o;for(let u=0;u<e.length/2;u++)i=e[u*2],o=e[u*2+1],r=Math.min(r,i),n=Math.max(n,i),s=Math.min(s,o),a=Math.max(a,o);const l=this.fontSize();return{x:r-l/2,y:s-l/2,width:n-r+l,height:a-s+l}}destroy(){return Q_.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};Yy.TextPath=ns;ns.prototype._fillFunc=rD;ns.prototype._strokeFunc=nD;ns.prototype._fillFuncHit=rD;ns.prototype._strokeFuncHit=nD;ns.prototype.className="TextPath";ns.prototype._attrsAffectingSize=["text","fontSize","data"];(0,WX._registerNode)(ns);Qi.Factory.addGetterSetter(ns,"data");Qi.Factory.addGetterSetter(ns,"fontFamily","Arial");Qi.Factory.addGetterSetter(ns,"fontSize",12,(0,eD.getNumberValidator)());Qi.Factory.addGetterSetter(ns,"fontStyle",tD);Qi.Factory.addGetterSetter(ns,"align","left");Qi.Factory.addGetterSetter(ns,"letterSpacing",0,(0,eD.getNumberValidator)());Qi.Factory.addGetterSetter(ns,"textBaseline","middle");Qi.Factory.addGetterSetter(ns,"fontVariant",tD);Qi.Factory.addGetterSetter(ns,"text",zX);Qi.Factory.addGetterSetter(ns,"textDecoration","");Qi.Factory.addGetterSetter(ns,"kerningFunc",void 0);var Jy={};Object.defineProperty(Jy,"__esModule",{value:!0});Jy.Transformer=void 0;const Ir=yn,jr=dr,n6=on,HX=rs,GX=hm,s6=hh,Ri=or,Rc=Jt,VX=or,sD="tr-konva",KX=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(t=>t+`.${sD}`).join(" "),a6="nodesRect",XX=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],YX={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},JX="ontouchstart"in Ri.Konva._global;function QX(t,e,r){if(t==="rotater")return r;e+=Ir.Util.degToRad(YX[t]||0);const n=(Ir.Util.radToDeg(e)%360+360)%360;return Ir.Util._inRange(n,315+22.5,360)||Ir.Util._inRange(n,0,22.5)?"ns-resize":Ir.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":Ir.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":Ir.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":Ir.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":Ir.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":Ir.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":Ir.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(Ir.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}const S1=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function qX(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function aD(t,e,r){const n=r.x+(t.x-r.x)*Math.cos(e)-(t.y-r.y)*Math.sin(e),s=r.y+(t.x-r.x)*Math.sin(e)+(t.y-r.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:n,y:s}}function ZX(t,e){const r=qX(t);return aD(t,e,r)}function eY(t,e,r){let n=e;for(let s=0;s<t.length;s++){const a=Ri.Konva.getAngle(t[s]),i=Math.abs(a-e)%(Math.PI*2);Math.min(i,Math.PI*2-i)<r&&(n=a)}return n}let aS=0,mr=class extends s6.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(KX,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return Ir.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return sD+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const r=e.filter(s=>s.isAncestorOf(this)?(Ir.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=r,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(s=>{const a=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(s._attrsAffectingSize.length){const i=s._attrsAffectingSize.map(o=>o+"Change."+this._getEventNamespace()).join(" ");s.on(i,a)}s.on(XX.map(i=>i+`.${this._getEventNamespace()}`).join(" "),a),s.on(`absoluteTransformChange.${this._getEventNamespace()}`,a),this._proxyDrag(s)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let r;e.on(`dragstart.${this._getEventNamespace()}`,n=>{r=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(n,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!r)return;const s=e.getAbsolutePosition(),a=s.x-r.x,i=s.y-r.y;this.nodes().forEach(o=>{if(o===e||o.isDragging())return;const l=o.getAbsolutePosition();o.setAbsolutePosition({x:l.x+a,y:l.y+i}),o.startDrag(n)}),r=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(a6),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(a6,this.__getNodeRect)}__getNodeShape(e,r=this.rotation(),n){const s=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),a=e.getAbsoluteScale(n),i=e.getAbsolutePosition(n),o=s.x*a.x-e.offsetX()*a.x,l=s.y*a.y-e.offsetY()*a.y,u=(Ri.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),d={x:i.x+o*Math.cos(u)+l*Math.sin(-u),y:i.y+l*Math.cos(u)+o*Math.sin(u),width:s.width*a.x,height:s.height*a.y,rotation:u};return aD(d,-Ri.Konva.getAngle(r),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const r=[];this.nodes().map(u=>{const d=u.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),g=[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}],h=u.getAbsoluteTransform();g.forEach(function(p){const x=h.point(p);r.push(x)})});const n=new Ir.Transform;n.rotate(-Ri.Konva.getAngle(this.rotation()));let s=1/0,a=1/0,i=-1/0,o=-1/0;r.forEach(function(u){const d=n.point(u);s===void 0&&(s=i=d.x,a=o=d.y),s=Math.min(s,d.x),a=Math.min(a,d.y),i=Math.max(i,d.x),o=Math.max(o,d.y)}),n.invert();const l=n.point({x:s,y:a});return{x:l.x,y:l.y,width:i-s,height:o-a,rotation:Ri.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),S1.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const r=new GX.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:JX?10:"auto"}),n=this;r.on("mousedown touchstart",function(s){n._handleMouseDown(s)}),r.on("dragstart",s=>{r.stopDrag(),s.cancelBubble=!0}),r.on("dragend",s=>{s.cancelBubble=!0}),r.on("mouseenter",()=>{const s=Ri.Konva.getAngle(this.rotation()),a=this.rotateAnchorCursor(),i=QX(e,s,a);r.getStage().content&&(r.getStage().content.style.cursor=i),this._cursorChange=!0}),r.on("mouseout",()=>{r.getStage().content&&(r.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(r)}_createBack(){const e=new HX.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(r,n){const s=n.getParent(),a=s.padding();r.beginPath(),r.rect(-a,-a,n.width()+a*2,n.height()+a*2),r.moveTo(n.width()/2,-a),s.rotateEnabled()&&s.rotateLineVisible()&&r.lineTo(n.width()/2,-s.rotateAnchorOffset()*Ir.Util._sign(n.height())-a),r.fillStrokeShape(n)},hitFunc:(r,n)=>{if(!this.shouldOverdrawWholeArea())return;const s=this.padding();r.beginPath(),r.rect(-s,-s,n.width()+s*2,n.height()+s*2),r.fillStrokeShape(n)}});this.add(e),this._proxyDrag(e),e.on("dragstart",r=>{r.cancelBubble=!0}),e.on("dragmove",r=>{r.cancelBubble=!0}),e.on("dragend",r=>{r.cancelBubble=!0}),this.on("dragmove",r=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const r=this._getNodeRect(),n=r.width,s=r.height,a=Math.sqrt(Math.pow(n,2)+Math.pow(s,2));this.sin=Math.abs(s/a),this.cos=Math.abs(n/a),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const i=e.target.getAbsolutePosition(),o=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-i.x,y:o.y-i.y},aS++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(l=>{l._fire("transformstart",{evt:e.evt,target:l})})}_handleMouseMove(e){let r,n,s;const a=this.findOne("."+this._movingAnchorName),i=a.getStage();i.setPointersPositions(e);const o=i.getPointerPosition();let l={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const u=a.getAbsolutePosition();this.anchorDragBoundFunc()&&(l=this.anchorDragBoundFunc()(u,l,e)),a.setAbsolutePosition(l);const d=a.getAbsolutePosition();if(u.x===d.x&&u.y===d.y)return;if(this._movingAnchorName==="rotater"){const _=this._getNodeRect();r=a.x()-_.width/2,n=-a.y()+_.height/2;let y=Math.atan2(-n,r)+Math.PI/2;_.height<0&&(y-=Math.PI);const N=Ri.Konva.getAngle(this.rotation())+y,E=Ri.Konva.getAngle(this.rotationSnapTolerance()),C=eY(this.rotationSnaps(),N,E)-_.rotation,F=ZX(_,C);this._fitNodesInto(F,e);return}const g=this.shiftBehavior();let h;g==="inverted"?h=this.keepRatio()&&!e.shiftKey:g==="none"?h=this.keepRatio():h=this.keepRatio()||e.shiftKey;let p=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(h){const _=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};s=Math.sqrt(Math.pow(_.x-a.x(),2)+Math.pow(_.y-a.y(),2));const y=this.findOne(".top-left").x()>_.x?-1:1,k=this.findOne(".top-left").y()>_.y?-1:1;r=s*this.cos*y,n=s*this.sin*k,this.findOne(".top-left").x(_.x-r),this.findOne(".top-left").y(_.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(a.y());else if(this._movingAnchorName==="top-right"){if(h){const _=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};s=Math.sqrt(Math.pow(a.x()-_.x,2)+Math.pow(_.y-a.y(),2));const y=this.findOne(".top-right").x()<_.x?-1:1,k=this.findOne(".top-right").y()>_.y?-1:1;r=s*this.cos*y,n=s*this.sin*k,this.findOne(".top-right").x(_.x+r),this.findOne(".top-right").y(_.y-n)}var x=a.position();this.findOne(".top-left").y(x.y),this.findOne(".bottom-right").x(x.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(a.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(a.x());else if(this._movingAnchorName==="bottom-left"){if(h){const _=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};s=Math.sqrt(Math.pow(_.x-a.x(),2)+Math.pow(a.y()-_.y,2));const y=_.x<a.x()?-1:1,k=a.y()<_.y?-1:1;r=s*this.cos*y,n=s*this.sin*k,a.x(_.x-r),a.y(_.y+n)}x=a.position(),this.findOne(".top-left").x(x.x),this.findOne(".bottom-right").y(x.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(a.y());else if(this._movingAnchorName==="bottom-right"){if(h){const _=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};s=Math.sqrt(Math.pow(a.x()-_.x,2)+Math.pow(a.y()-_.y,2));const y=this.findOne(".bottom-right").x()<_.x?-1:1,k=this.findOne(".bottom-right").y()<_.y?-1:1;r=s*this.cos*y,n=s*this.sin*k,this.findOne(".bottom-right").x(_.x+r),this.findOne(".bottom-right").y(_.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(p=this.centeredScaling()||e.altKey,p){const _=this.findOne(".top-left"),y=this.findOne(".bottom-right"),k=_.x(),N=_.y(),E=this.getWidth()-y.x(),A=this.getHeight()-y.y();y.move({x:-k,y:-N}),_.move({x:E,y:A})}const v=this.findOne(".top-left").getAbsolutePosition();r=v.x,n=v.y;const w=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),S=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:r,y:n,width:w,height:S,rotation:Ri.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var r;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const n=this.getNode();aS--,this._fire("transformend",{evt:e,target:n}),(r=this.getLayer())===null||r===void 0||r.batchDraw(),n&&this._nodes.forEach(s=>{var a;s._fire("transformend",{evt:e,target:s}),(a=s.getLayer())===null||a===void 0||a.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,r){const n=this._getNodeRect(),s=1;if(Ir.Util._inRange(e.width,-this.padding()*2-s,s)){this.update();return}if(Ir.Util._inRange(e.height,-this.padding()*2-s,s)){this.update();return}const a=new Ir.Transform;if(a.rotate(Ri.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const h=a.point({x:-this.padding()*2,y:0});e.x+=h.x,e.y+=h.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const h=a.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const h=a.point({x:0,y:-this.padding()*2});e.x+=h.x,e.y+=h.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const h=a.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const h=this.boundBoxFunc()(n,e);h?e=h:Ir.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const i=1e7,o=new Ir.Transform;o.translate(n.x,n.y),o.rotate(n.rotation),o.scale(n.width/i,n.height/i);const l=new Ir.Transform,u=e.width/i,d=e.height/i;this.flipEnabled()===!1?(l.translate(e.x,e.y),l.rotate(e.rotation),l.translate(e.width<0?e.width:0,e.height<0?e.height:0),l.scale(Math.abs(u),Math.abs(d))):(l.translate(e.x,e.y),l.rotate(e.rotation),l.scale(u,d));const g=l.multiply(o.invert());this._nodes.forEach(h=>{var p;const x=h.getParent().getAbsoluteTransform(),v=h.getTransform().copy();v.translate(h.offsetX(),h.offsetY());const w=new Ir.Transform;w.multiply(x.copy().invert()).multiply(g).multiply(x).multiply(v);const S=w.decompose();h.setAttrs(S),(p=h.getLayer())===null||p===void 0||p.batchDraw()}),this.rotation(Ir.Util._getRotation(e.rotation)),this._nodes.forEach(h=>{this._fire("transform",{evt:r,target:h}),h._fire("transform",{evt:r,target:h})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,r){this.findOne(e).setAttrs(r)}update(){var e;const r=this._getNodeRect();this.rotation(Ir.Util._getRotation(r.rotation));const n=r.width,s=r.height,a=this.enabledAnchors(),i=this.resizeEnabled(),o=this.padding(),l=this.anchorSize(),u=this.find("._anchor");u.forEach(g=>{g.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+o,offsetY:l/2+o,visible:i&&a.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:l/2+o,visible:i&&a.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:l/2-o,offsetY:l/2+o,visible:i&&a.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:s/2,offsetX:l/2+o,visible:i&&a.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:s/2,offsetX:l/2-o,visible:i&&a.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:s,offsetX:l/2+o,offsetY:l/2-o,visible:i&&a.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:s,offsetY:l/2-o,visible:i&&a.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:s,offsetX:l/2-o,offsetY:l/2-o,visible:i&&a.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*Ir.Util._sign(s)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:s,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const d=this.anchorStyleFunc();d&&u.forEach(g=>{d(g)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),s6.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return n6.Node.prototype.toObject.call(this)}clone(e){return n6.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Jy.Transformer=mr;mr.isTransforming=()=>aS>0;function tY(t){return t instanceof Array||Ir.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(e){S1.indexOf(e)===-1&&Ir.Util.warn("Unknown anchor name: "+e+". Available names are: "+S1.join(", "))}),t||[]}mr.prototype.className="Transformer";(0,VX._registerNode)(mr);jr.Factory.addGetterSetter(mr,"enabledAnchors",S1,tY);jr.Factory.addGetterSetter(mr,"flipEnabled",!0,(0,Rc.getBooleanValidator)());jr.Factory.addGetterSetter(mr,"resizeEnabled",!0);jr.Factory.addGetterSetter(mr,"anchorSize",10,(0,Rc.getNumberValidator)());jr.Factory.addGetterSetter(mr,"rotateEnabled",!0);jr.Factory.addGetterSetter(mr,"rotateLineVisible",!0);jr.Factory.addGetterSetter(mr,"rotationSnaps",[]);jr.Factory.addGetterSetter(mr,"rotateAnchorOffset",50,(0,Rc.getNumberValidator)());jr.Factory.addGetterSetter(mr,"rotateAnchorCursor","crosshair");jr.Factory.addGetterSetter(mr,"rotationSnapTolerance",5,(0,Rc.getNumberValidator)());jr.Factory.addGetterSetter(mr,"borderEnabled",!0);jr.Factory.addGetterSetter(mr,"anchorStroke","rgb(0, 161, 255)");jr.Factory.addGetterSetter(mr,"anchorStrokeWidth",1,(0,Rc.getNumberValidator)());jr.Factory.addGetterSetter(mr,"anchorFill","white");jr.Factory.addGetterSetter(mr,"anchorCornerRadius",0,(0,Rc.getNumberValidator)());jr.Factory.addGetterSetter(mr,"borderStroke","rgb(0, 161, 255)");jr.Factory.addGetterSetter(mr,"borderStrokeWidth",1,(0,Rc.getNumberValidator)());jr.Factory.addGetterSetter(mr,"borderDash");jr.Factory.addGetterSetter(mr,"keepRatio",!0);jr.Factory.addGetterSetter(mr,"shiftBehavior","default");jr.Factory.addGetterSetter(mr,"centeredScaling",!1);jr.Factory.addGetterSetter(mr,"ignoreStroke",!1);jr.Factory.addGetterSetter(mr,"padding",0,(0,Rc.getNumberValidator)());jr.Factory.addGetterSetter(mr,"nodes");jr.Factory.addGetterSetter(mr,"node");jr.Factory.addGetterSetter(mr,"boundBoxFunc");jr.Factory.addGetterSetter(mr,"anchorDragBoundFunc");jr.Factory.addGetterSetter(mr,"anchorStyleFunc");jr.Factory.addGetterSetter(mr,"shouldOverdrawWholeArea",!1);jr.Factory.addGetterSetter(mr,"useSingleNodeRotation",!0);jr.Factory.backCompat(mr,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var Qy={};Object.defineProperty(Qy,"__esModule",{value:!0});Qy.Wedge=void 0;const qy=dr,rY=rs,nY=or,iD=Jt,sY=or;let Sl=class extends rY.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,nY.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}};Qy.Wedge=Sl;Sl.prototype.className="Wedge";Sl.prototype._centroid=!0;Sl.prototype._attrsAffectingSize=["radius"];(0,sY._registerNode)(Sl);qy.Factory.addGetterSetter(Sl,"radius",0,(0,iD.getNumberValidator)());qy.Factory.addGetterSetter(Sl,"angle",0,(0,iD.getNumberValidator)());qy.Factory.addGetterSetter(Sl,"clockwise",!1);qy.Factory.backCompat(Sl,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var Zy={};Object.defineProperty(Zy,"__esModule",{value:!0});Zy.Blur=void 0;const i6=dr,aY=on,iY=Jt;function o6(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const oY=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],lY=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function cY(t,e){const r=t.data,n=t.width,s=t.height;let a,i,o,l,u,d,g,h,p,x,v,w,S,_,y,k,N,E,A,C;const F=e+e+1,D=n-1,R=s-1,M=e+1,B=M*(M+1)/2,J=new o6,X=oY[e],z=lY[e];let H=null,U=J,L=null,ne=null;for(let de=1;de<F;de++)U=U.next=new o6,de===M&&(H=U);U.next=J,o=i=0;for(let de=0;de<s;de++){w=S=_=y=l=u=d=g=0,h=M*(k=r[i]),p=M*(N=r[i+1]),x=M*(E=r[i+2]),v=M*(A=r[i+3]),l+=B*k,u+=B*N,d+=B*E,g+=B*A,U=J;for(let G=0;G<M;G++)U.r=k,U.g=N,U.b=E,U.a=A,U=U.next;for(let G=1;G<M;G++)a=i+((D<G?D:G)<<2),l+=(U.r=k=r[a])*(C=M-G),u+=(U.g=N=r[a+1])*C,d+=(U.b=E=r[a+2])*C,g+=(U.a=A=r[a+3])*C,w+=k,S+=N,_+=E,y+=A,U=U.next;L=J,ne=H;for(let G=0;G<n;G++)r[i+3]=A=g*X>>z,A!==0?(A=255/A,r[i]=(l*X>>z)*A,r[i+1]=(u*X>>z)*A,r[i+2]=(d*X>>z)*A):r[i]=r[i+1]=r[i+2]=0,l-=h,u-=p,d-=x,g-=v,h-=L.r,p-=L.g,x-=L.b,v-=L.a,a=o+((a=G+e+1)<D?a:D)<<2,w+=L.r=r[a],S+=L.g=r[a+1],_+=L.b=r[a+2],y+=L.a=r[a+3],l+=w,u+=S,d+=_,g+=y,L=L.next,h+=k=ne.r,p+=N=ne.g,x+=E=ne.b,v+=A=ne.a,w-=k,S-=N,_-=E,y-=A,ne=ne.next,i+=4;o+=n}for(let de=0;de<n;de++){S=_=y=w=u=d=g=l=0,i=de<<2,h=M*(k=r[i]),p=M*(N=r[i+1]),x=M*(E=r[i+2]),v=M*(A=r[i+3]),l+=B*k,u+=B*N,d+=B*E,g+=B*A,U=J;for(let K=0;K<M;K++)U.r=k,U.g=N,U.b=E,U.a=A,U=U.next;let G=n;for(let K=1;K<=e;K++)i=G+de<<2,l+=(U.r=k=r[i])*(C=M-K),u+=(U.g=N=r[i+1])*C,d+=(U.b=E=r[i+2])*C,g+=(U.a=A=r[i+3])*C,w+=k,S+=N,_+=E,y+=A,U=U.next,K<R&&(G+=n);i=de,L=J,ne=H;for(let K=0;K<s;K++)a=i<<2,r[a+3]=A=g*X>>z,A>0?(A=255/A,r[a]=(l*X>>z)*A,r[a+1]=(u*X>>z)*A,r[a+2]=(d*X>>z)*A):r[a]=r[a+1]=r[a+2]=0,l-=h,u-=p,d-=x,g-=v,h-=L.r,p-=L.g,x-=L.b,v-=L.a,a=de+((a=K+M)<R?a:R)*n<<2,l+=w+=L.r=r[a],u+=S+=L.g=r[a+1],d+=_+=L.b=r[a+2],g+=y+=L.a=r[a+3],L=L.next,h+=k=ne.r,p+=N=ne.g,x+=E=ne.b,v+=A=ne.a,w-=k,S-=N,_-=E,y-=A,ne=ne.next,i+=n}}const uY=function(e){const r=Math.round(this.blurRadius());r>0&&cY(e,r)};Zy.Blur=uY;i6.Factory.addGetterSetter(aY.Node,"blurRadius",0,(0,iY.getNumberValidator)(),i6.Factory.afterSetFilter);var ev={};Object.defineProperty(ev,"__esModule",{value:!0});ev.Brighten=void 0;const l6=dr,dY=on,fY=Jt,hY=function(t){const e=this.brightness()*255,r=t.data,n=r.length;for(let s=0;s<n;s+=4)r[s]+=e,r[s+1]+=e,r[s+2]+=e};ev.Brighten=hY;l6.Factory.addGetterSetter(dY.Node,"brightness",0,(0,fY.getNumberValidator)(),l6.Factory.afterSetFilter);var tv={};Object.defineProperty(tv,"__esModule",{value:!0});tv.Contrast=void 0;const c6=dr,gY=on,mY=Jt,pY=function(t){const e=Math.pow((this.contrast()+100)/100,2),r=t.data,n=r.length;let s=150,a=150,i=150;for(let o=0;o<n;o+=4)s=r[o],a=r[o+1],i=r[o+2],s/=255,s-=.5,s*=e,s+=.5,s*=255,a/=255,a-=.5,a*=e,a+=.5,a*=255,i/=255,i-=.5,i*=e,i+=.5,i*=255,s=s<0?0:s>255?255:s,a=a<0?0:a>255?255:a,i=i<0?0:i>255?255:i,r[o]=s,r[o+1]=a,r[o+2]=i};tv.Contrast=pY;c6.Factory.addGetterSetter(gY.Node,"contrast",0,(0,mY.getNumberValidator)(),c6.Factory.afterSetFilter);var rv={};Object.defineProperty(rv,"__esModule",{value:!0});rv.Emboss=void 0;const xc=dr,nv=on,xY=yn,oD=Jt,yY=function(t){const e=this.embossStrength()*10,r=this.embossWhiteLevel()*255,n=this.embossDirection(),s=this.embossBlend(),a=t.data,i=t.width,o=t.height,l=i*4;let u=0,d=0,g=o;switch(n){case"top-left":u=-1,d=-1;break;case"top":u=-1,d=0;break;case"top-right":u=-1,d=1;break;case"right":u=0,d=1;break;case"bottom-right":u=1,d=1;break;case"bottom":u=1,d=0;break;case"bottom-left":u=1,d=-1;break;case"left":u=0,d=-1;break;default:xY.Util.error("Unknown emboss direction: "+n)}do{const h=(g-1)*l;let p=u;g+p<1&&(p=0),g+p>o&&(p=0);const x=(g-1+p)*i*4;let v=i;do{const w=h+(v-1)*4;let S=d;v+S<1&&(S=0),v+S>i&&(S=0);const _=x+(v-1+S)*4,y=a[w]-a[_],k=a[w+1]-a[_+1],N=a[w+2]-a[_+2];let E=y;const A=E>0?E:-E,C=k>0?k:-k,F=N>0?N:-N;if(C>A&&(E=k),F>A&&(E=N),E*=e,s){const D=a[w]+E,R=a[w+1]+E,M=a[w+2]+E;a[w]=D>255?255:D<0?0:D,a[w+1]=R>255?255:R<0?0:R,a[w+2]=M>255?255:M<0?0:M}else{let D=r-E;D<0?D=0:D>255&&(D=255),a[w]=a[w+1]=a[w+2]=D}}while(--v)}while(--g)};rv.Emboss=yY;xc.Factory.addGetterSetter(nv.Node,"embossStrength",.5,(0,oD.getNumberValidator)(),xc.Factory.afterSetFilter);xc.Factory.addGetterSetter(nv.Node,"embossWhiteLevel",.5,(0,oD.getNumberValidator)(),xc.Factory.afterSetFilter);xc.Factory.addGetterSetter(nv.Node,"embossDirection","top-left",void 0,xc.Factory.afterSetFilter);xc.Factory.addGetterSetter(nv.Node,"embossBlend",!1,void 0,xc.Factory.afterSetFilter);var sv={};Object.defineProperty(sv,"__esModule",{value:!0});sv.Enhance=void 0;const u6=dr,vY=on,wY=Jt;function Z_(t,e,r,n,s){const a=r-e,i=s-n;if(a===0)return n+i/2;if(i===0)return n;let o=(t-e)/a;return o=i*o+n,o}const _Y=function(t){const e=t.data,r=e.length;let n=e[0],s=n,a,i=e[1],o=i,l,u=e[2],d=u,g;const h=this.enhance();if(h===0)return;for(let y=0;y<r;y+=4)a=e[y+0],a<n?n=a:a>s&&(s=a),l=e[y+1],l<i?i=l:l>o&&(o=l),g=e[y+2],g<u?u=g:g>d&&(d=g);s===n&&(s=255,n=0),o===i&&(o=255,i=0),d===u&&(d=255,u=0);let p,x,v,w,S,_;if(h>0)p=s+h*(255-s),x=n-h*(n-0),v=o+h*(255-o),w=i-h*(i-0),S=d+h*(255-d),_=u-h*(u-0);else{const y=(s+n)*.5;p=s+h*(s-y),x=n+h*(n-y);const k=(o+i)*.5;v=o+h*(o-k),w=i+h*(i-k);const N=(d+u)*.5;S=d+h*(d-N),_=u+h*(u-N)}for(let y=0;y<r;y+=4)e[y+0]=Z_(e[y+0],n,s,x,p),e[y+1]=Z_(e[y+1],i,o,w,v),e[y+2]=Z_(e[y+2],u,d,_,S)};sv.Enhance=_Y;u6.Factory.addGetterSetter(vY.Node,"enhance",0,(0,wY.getNumberValidator)(),u6.Factory.afterSetFilter);var av={};Object.defineProperty(av,"__esModule",{value:!0});av.Grayscale=void 0;const bY=function(t){const e=t.data,r=e.length;for(let n=0;n<r;n+=4){const s=.34*e[n]+.5*e[n+1]+.16*e[n+2];e[n]=s,e[n+1]=s,e[n+2]=s}};av.Grayscale=bY;var iv={};Object.defineProperty(iv,"__esModule",{value:!0});iv.HSL=void 0;const Gf=dr,HC=on,GC=Jt;Gf.Factory.addGetterSetter(HC.Node,"hue",0,(0,GC.getNumberValidator)(),Gf.Factory.afterSetFilter);Gf.Factory.addGetterSetter(HC.Node,"saturation",0,(0,GC.getNumberValidator)(),Gf.Factory.afterSetFilter);Gf.Factory.addGetterSetter(HC.Node,"luminance",0,(0,GC.getNumberValidator)(),Gf.Factory.afterSetFilter);const SY=function(t){const e=t.data,r=e.length,n=1,s=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,i=this.luminance()*127,o=n*s*Math.cos(a*Math.PI/180),l=n*s*Math.sin(a*Math.PI/180),u=.299*n+.701*o+.167*l,d=.587*n-.587*o+.33*l,g=.114*n-.114*o-.497*l,h=.299*n-.299*o-.328*l,p=.587*n+.413*o+.035*l,x=.114*n-.114*o+.293*l,v=.299*n-.3*o+1.25*l,w=.587*n-.586*o-1.05*l,S=.114*n+.886*o-.2*l;let _,y,k,N;for(let E=0;E<r;E+=4)_=e[E+0],y=e[E+1],k=e[E+2],N=e[E+3],e[E+0]=u*_+d*y+g*k+i,e[E+1]=h*_+p*y+x*k+i,e[E+2]=v*_+w*y+S*k+i,e[E+3]=N};iv.HSL=SY;var ov={};Object.defineProperty(ov,"__esModule",{value:!0});ov.HSV=void 0;const Vf=dr,VC=on,KC=Jt,kY=function(t){const e=t.data,r=e.length,n=Math.pow(2,this.value()),s=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,i=n*s*Math.cos(a*Math.PI/180),o=n*s*Math.sin(a*Math.PI/180),l=.299*n+.701*i+.167*o,u=.587*n-.587*i+.33*o,d=.114*n-.114*i-.497*o,g=.299*n-.299*i-.328*o,h=.587*n+.413*i+.035*o,p=.114*n-.114*i+.293*o,x=.299*n-.3*i+1.25*o,v=.587*n-.586*i-1.05*o,w=.114*n+.886*i-.2*o;for(let S=0;S<r;S+=4){const _=e[S+0],y=e[S+1],k=e[S+2],N=e[S+3];e[S+0]=l*_+u*y+d*k,e[S+1]=g*_+h*y+p*k,e[S+2]=x*_+v*y+w*k,e[S+3]=N}};ov.HSV=kY;Vf.Factory.addGetterSetter(VC.Node,"hue",0,(0,KC.getNumberValidator)(),Vf.Factory.afterSetFilter);Vf.Factory.addGetterSetter(VC.Node,"saturation",0,(0,KC.getNumberValidator)(),Vf.Factory.afterSetFilter);Vf.Factory.addGetterSetter(VC.Node,"value",0,(0,KC.getNumberValidator)(),Vf.Factory.afterSetFilter);var lv={};Object.defineProperty(lv,"__esModule",{value:!0});lv.Invert=void 0;const CY=function(t){const e=t.data,r=e.length;for(let n=0;n<r;n+=4)e[n]=255-e[n],e[n+1]=255-e[n+1],e[n+2]=255-e[n+2]};lv.Invert=CY;var cv={};Object.defineProperty(cv,"__esModule",{value:!0});cv.Kaleidoscope=void 0;const k1=dr,lD=on,d6=yn,cD=Jt,TY=function(t,e,r){const n=t.data,s=e.data,a=t.width,i=t.height,o=r.polarCenterX||a/2,l=r.polarCenterY||i/2;let u=Math.sqrt(o*o+l*l),d=a-o,g=i-l;const h=Math.sqrt(d*d+g*g);u=h>u?h:u;const p=i,x=a,v=360/x*Math.PI/180;for(let w=0;w<x;w+=1){const S=Math.sin(w*v),_=Math.cos(w*v);for(let y=0;y<p;y+=1){d=Math.floor(o+u*y/p*_),g=Math.floor(l+u*y/p*S);let k=(g*a+d)*4;const N=n[k+0],E=n[k+1],A=n[k+2],C=n[k+3];k=(w+y*a)*4,s[k+0]=N,s[k+1]=E,s[k+2]=A,s[k+3]=C}}},EY=function(t,e,r){const n=t.data,s=e.data,a=t.width,i=t.height,o=r.polarCenterX||a/2,l=r.polarCenterY||i/2;let u=Math.sqrt(o*o+l*l),d=a-o,g=i-l;const h=Math.sqrt(d*d+g*g);u=h>u?h:u;const p=i,x=a,v=0;let w,S;for(d=0;d<a;d+=1)for(g=0;g<i;g+=1){const _=d-o,y=g-l,k=Math.sqrt(_*_+y*y)*p/u;let N=(Math.atan2(y,_)*180/Math.PI+360+v)%360;N=N*x/360,w=Math.floor(N),S=Math.floor(k);let E=(S*a+w)*4;const A=n[E+0],C=n[E+1],F=n[E+2],D=n[E+3];E=(g*a+d)*4,s[E+0]=A,s[E+1]=C,s[E+2]=F,s[E+3]=D}},NY=function(t){const e=t.width,r=t.height;let n,s,a,i,o,l,u,d,g,h,p=Math.round(this.kaleidoscopePower());const x=Math.round(this.kaleidoscopeAngle()),v=Math.floor(e*(x%360)/360);if(p<1)return;const w=d6.Util.createCanvasElement();w.width=e,w.height=r;const S=w.getContext("2d").getImageData(0,0,e,r);d6.Util.releaseCanvas(w),TY(t,S,{polarCenterX:e/2,polarCenterY:r/2});let _=e/Math.pow(2,p);for(;_<=8;)_=_*2,p-=1;_=Math.ceil(_);let y=_,k=0,N=y,E=1;for(v+_>e&&(k=y,N=0,E=-1),s=0;s<r;s+=1)for(n=k;n!==N;n+=E)a=Math.round(n+v)%e,g=(e*s+a)*4,o=S.data[g+0],l=S.data[g+1],u=S.data[g+2],d=S.data[g+3],h=(e*s+n)*4,S.data[h+0]=o,S.data[h+1]=l,S.data[h+2]=u,S.data[h+3]=d;for(s=0;s<r;s+=1)for(y=Math.floor(_),i=0;i<p;i+=1){for(n=0;n<y+1;n+=1)g=(e*s+n)*4,o=S.data[g+0],l=S.data[g+1],u=S.data[g+2],d=S.data[g+3],h=(e*s+y*2-n-1)*4,S.data[h+0]=o,S.data[h+1]=l,S.data[h+2]=u,S.data[h+3]=d;y*=2}EY(S,t,{})};cv.Kaleidoscope=NY;k1.Factory.addGetterSetter(lD.Node,"kaleidoscopePower",2,(0,cD.getNumberValidator)(),k1.Factory.afterSetFilter);k1.Factory.addGetterSetter(lD.Node,"kaleidoscopeAngle",0,(0,cD.getNumberValidator)(),k1.Factory.afterSetFilter);var uv={};Object.defineProperty(uv,"__esModule",{value:!0});uv.Mask=void 0;const f6=dr,AY=on,jY=Jt;function qp(t,e,r){let n=(r*t.width+e)*4;const s=[];return s.push(t.data[n++],t.data[n++],t.data[n++],t.data[n++]),s}function l0(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function FY(t){const e=[0,0,0];for(let r=0;r<t.length;r++)e[0]+=t[r][0],e[1]+=t[r][1],e[2]+=t[r][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function PY(t,e){const r=qp(t,0,0),n=qp(t,t.width-1,0),s=qp(t,0,t.height-1),a=qp(t,t.width-1,t.height-1),i=e||10;if(l0(r,n)<i&&l0(n,a)<i&&l0(a,s)<i&&l0(s,r)<i){const o=FY([n,r,a,s]),l=[];for(let u=0;u<t.width*t.height;u++){const d=l0(o,[t.data[u*4],t.data[u*4+1],t.data[u*4+2]]);l[u]=d<i?0:255}return l}}function DY(t,e){for(let r=0;r<t.width*t.height;r++)t.data[4*r+3]=e[r]}function RY(t,e,r){const n=[1,1,1,1,0,1,1,1,1],s=Math.round(Math.sqrt(n.length)),a=Math.floor(s/2),i=[];for(let o=0;o<r;o++)for(let l=0;l<e;l++){const u=o*e+l;let d=0;for(let g=0;g<s;g++)for(let h=0;h<s;h++){const p=o+g-a,x=l+h-a;if(p>=0&&p<r&&x>=0&&x<e){const v=p*e+x,w=n[g*s+h];d+=t[v]*w}}i[u]=d===255*8?255:0}return i}function MY(t,e,r){const n=[1,1,1,1,1,1,1,1,1],s=Math.round(Math.sqrt(n.length)),a=Math.floor(s/2),i=[];for(let o=0;o<r;o++)for(let l=0;l<e;l++){const u=o*e+l;let d=0;for(let g=0;g<s;g++)for(let h=0;h<s;h++){const p=o+g-a,x=l+h-a;if(p>=0&&p<r&&x>=0&&x<e){const v=p*e+x,w=n[g*s+h];d+=t[v]*w}}i[u]=d>=255*4?255:0}return i}function LY(t,e,r){const n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],s=Math.round(Math.sqrt(n.length)),a=Math.floor(s/2),i=[];for(let o=0;o<r;o++)for(let l=0;l<e;l++){const u=o*e+l;let d=0;for(let g=0;g<s;g++)for(let h=0;h<s;h++){const p=o+g-a,x=l+h-a;if(p>=0&&p<r&&x>=0&&x<e){const v=p*e+x,w=n[g*s+h];d+=t[v]*w}}i[u]=d}return i}const IY=function(t){const e=this.threshold();let r=PY(t,e);return r&&(r=RY(r,t.width,t.height),r=MY(r,t.width,t.height),r=LY(r,t.width,t.height),DY(t,r)),t};uv.Mask=IY;f6.Factory.addGetterSetter(AY.Node,"threshold",0,(0,jY.getNumberValidator)(),f6.Factory.afterSetFilter);var dv={};Object.defineProperty(dv,"__esModule",{value:!0});dv.Noise=void 0;const h6=dr,OY=on,BY=Jt,UY=function(t){const e=this.noise()*255,r=t.data,n=r.length,s=e/2;for(let a=0;a<n;a+=4)r[a+0]+=s-2*s*Math.random(),r[a+1]+=s-2*s*Math.random(),r[a+2]+=s-2*s*Math.random()};dv.Noise=UY;h6.Factory.addGetterSetter(OY.Node,"noise",.2,(0,BY.getNumberValidator)(),h6.Factory.afterSetFilter);var fv={};Object.defineProperty(fv,"__esModule",{value:!0});fv.Pixelate=void 0;const g6=dr,$Y=yn,WY=on,zY=Jt,HY=function(t){let e=Math.ceil(this.pixelSize()),r=t.width,n=t.height,s=Math.ceil(r/e),a=Math.ceil(n/e),i=t.data;if(e<=0){$Y.Util.error("pixelSize value can not be <= 0");return}for(let o=0;o<s;o+=1)for(let l=0;l<a;l+=1){let u=0,d=0,g=0,h=0;const p=o*e,x=p+e,v=l*e,w=v+e;let S=0;for(let _=p;_<x;_+=1)if(!(_>=r))for(let y=v;y<w;y+=1){if(y>=n)continue;const k=(r*y+_)*4;u+=i[k+0],d+=i[k+1],g+=i[k+2],h+=i[k+3],S+=1}u=u/S,d=d/S,g=g/S,h=h/S;for(let _=p;_<x;_+=1)if(!(_>=r))for(let y=v;y<w;y+=1){if(y>=n)continue;const k=(r*y+_)*4;i[k+0]=u,i[k+1]=d,i[k+2]=g,i[k+3]=h}}};fv.Pixelate=HY;g6.Factory.addGetterSetter(WY.Node,"pixelSize",8,(0,zY.getNumberValidator)(),g6.Factory.afterSetFilter);var hv={};Object.defineProperty(hv,"__esModule",{value:!0});hv.Posterize=void 0;const m6=dr,GY=on,VY=Jt,KY=function(t){const e=Math.round(this.levels()*254)+1,r=t.data,n=r.length,s=255/e;for(let a=0;a<n;a+=1)r[a]=Math.floor(r[a]/s)*s};hv.Posterize=KY;m6.Factory.addGetterSetter(GY.Node,"levels",.5,(0,VY.getNumberValidator)(),m6.Factory.afterSetFilter);var gv={};Object.defineProperty(gv,"__esModule",{value:!0});gv.RGB=void 0;const C1=dr,XC=on,XY=Jt,YY=function(t){const e=t.data,r=e.length,n=this.red(),s=this.green(),a=this.blue();for(let i=0;i<r;i+=4){const o=(.34*e[i]+.5*e[i+1]+.16*e[i+2])/255;e[i]=o*n,e[i+1]=o*s,e[i+2]=o*a,e[i+3]=e[i+3]}};gv.RGB=YY;C1.Factory.addGetterSetter(XC.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});C1.Factory.addGetterSetter(XC.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});C1.Factory.addGetterSetter(XC.Node,"blue",0,XY.RGBComponent,C1.Factory.afterSetFilter);var mv={};Object.defineProperty(mv,"__esModule",{value:!0});mv.RGBA=void 0;const Tg=dr,pv=on,JY=Jt,QY=function(t){const e=t.data,r=e.length,n=this.red(),s=this.green(),a=this.blue(),i=this.alpha();for(let o=0;o<r;o+=4){const l=1-i;e[o]=n*i+e[o]*l,e[o+1]=s*i+e[o+1]*l,e[o+2]=a*i+e[o+2]*l}};mv.RGBA=QY;Tg.Factory.addGetterSetter(pv.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Tg.Factory.addGetterSetter(pv.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Tg.Factory.addGetterSetter(pv.Node,"blue",0,JY.RGBComponent,Tg.Factory.afterSetFilter);Tg.Factory.addGetterSetter(pv.Node,"alpha",1,function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t});var xv={};Object.defineProperty(xv,"__esModule",{value:!0});xv.Sepia=void 0;const qY=function(t){const e=t.data,r=e.length;for(let n=0;n<r;n+=4){const s=e[n+0],a=e[n+1],i=e[n+2];e[n+0]=Math.min(255,s*.393+a*.769+i*.189),e[n+1]=Math.min(255,s*.349+a*.686+i*.168),e[n+2]=Math.min(255,s*.272+a*.534+i*.131)}};xv.Sepia=qY;var yv={};Object.defineProperty(yv,"__esModule",{value:!0});yv.Solarize=void 0;const ZY=function(t){const e=t.data,r=t.width,n=t.height,s=r*4;let a=n;do{const i=(a-1)*s;let o=r;do{const l=i+(o-1)*4;let u=e[l],d=e[l+1],g=e[l+2];u>127&&(u=255-u),d>127&&(d=255-d),g>127&&(g=255-g),e[l]=u,e[l+1]=d,e[l+2]=g}while(--o)}while(--a)};yv.Solarize=ZY;var vv={};Object.defineProperty(vv,"__esModule",{value:!0});vv.Threshold=void 0;const p6=dr,eJ=on,tJ=Jt,rJ=function(t){const e=this.threshold()*255,r=t.data,n=r.length;for(let s=0;s<n;s+=1)r[s]=r[s]<e?0:255};vv.Threshold=rJ;p6.Factory.addGetterSetter(eJ.Node,"threshold",.5,(0,tJ.getNumberValidator)(),p6.Factory.afterSetFilter);Object.defineProperty(Ay,"__esModule",{value:!0});Ay.Konva=void 0;const x6=_1,nJ=Ry,sJ=Iy,aJ=Uy,iJ=$y,oJ=Wy,y6=Hf,lJ=um,cJ=mh,uJ=hm,dJ=Gy,fJ=Vy,hJ=Ky,gJ=Xy,mJ=xh,pJ=Yy,xJ=Jy,yJ=Qy,vJ=Zy,wJ=ev,_J=tv,bJ=rv,SJ=sv,kJ=av,CJ=iv,TJ=ov,EJ=lv,NJ=cv,AJ=uv,jJ=dv,FJ=fv,PJ=hv,DJ=gv,RJ=mv,MJ=xv,LJ=yv,IJ=vv;Ay.Konva=x6.Konva.Util._assign(x6.Konva,{Arc:nJ.Arc,Arrow:sJ.Arrow,Circle:aJ.Circle,Ellipse:iJ.Ellipse,Image:oJ.Image,Label:y6.Label,Tag:y6.Tag,Line:lJ.Line,Path:cJ.Path,Rect:uJ.Rect,RegularPolygon:dJ.RegularPolygon,Ring:fJ.Ring,Sprite:hJ.Sprite,Star:gJ.Star,Text:mJ.Text,TextPath:pJ.TextPath,Transformer:xJ.Transformer,Wedge:yJ.Wedge,Filters:{Blur:vJ.Blur,Brighten:wJ.Brighten,Contrast:_J.Contrast,Emboss:bJ.Emboss,Enhance:SJ.Enhance,Grayscale:kJ.Grayscale,HSL:CJ.HSL,HSV:TJ.HSV,Invert:EJ.Invert,Kaleidoscope:NJ.Kaleidoscope,Mask:AJ.Mask,Noise:jJ.Noise,Pixelate:FJ.Pixelate,Posterize:PJ.Posterize,RGB:DJ.RGB,RGBA:RJ.RGBA,Sepia:MJ.Sepia,Solarize:LJ.Solarize,Threshold:IJ.Threshold}});var OJ=DC.exports;Object.defineProperty(OJ,"__esModule",{value:!0});const BJ=Ay;DC.exports=BJ.Konva;var uD=DC.exports;const UJ=iy(uD),$J=bj({__proto__:null,default:UJ},[uD]);var iS={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var r=_1;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=_1;t.exports=n.Konva})(iS,iS.exports);var WJ=iS.exports;const Eg=iy(WJ);var dD={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zJ=function(e){var r={},n=b,s=T0,a=Object.assign;function i(f){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+f,T=1;T<arguments.length;T++)m+="&args[]="+encodeURIComponent(arguments[T]);return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),u=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),x=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),k=Symbol.for("react.offscreen"),N=Symbol.iterator;function E(f){return f===null||typeof f!="object"?null:(f=N&&f[N]||f["@@iterator"],typeof f=="function"?f:null)}function A(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case d:return"Fragment";case u:return"Portal";case h:return"Profiler";case g:return"StrictMode";case w:return"Suspense";case S:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case x:return(f.displayName||"Context")+".Consumer";case p:return(f._context.displayName||"Context")+".Provider";case v:var m=f.render;return f=f.displayName,f||(f=m.displayName||m.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case _:return m=f.displayName||null,m!==null?m:A(f.type)||"Memo";case y:m=f._payload,f=f._init;try{return A(f(m))}catch{}}return null}function C(f){var m=f.type;switch(f.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=m.render,f=f.displayName||f.name||"",m.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return A(m);case 8:return m===g?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function F(f){var m=f,T=f;if(f.alternate)for(;m.return;)m=m.return;else{f=m;do m=f,m.flags&4098&&(T=m.return),f=m.return;while(f)}return m.tag===3?T:null}function D(f){if(F(f)!==f)throw Error(i(188))}function R(f){var m=f.alternate;if(!m){if(m=F(f),m===null)throw Error(i(188));return m!==f?null:f}for(var T=f,j=m;;){var P=T.return;if(P===null)break;var O=P.alternate;if(O===null){if(j=P.return,j!==null){T=j;continue}break}if(P.child===O.child){for(O=P.child;O;){if(O===T)return D(P),f;if(O===j)return D(P),m;O=O.sibling}throw Error(i(188))}if(T.return!==j.return)T=P,j=O;else{for(var le=!1,Pe=P.child;Pe;){if(Pe===T){le=!0,T=P,j=O;break}if(Pe===j){le=!0,j=P,T=O;break}Pe=Pe.sibling}if(!le){for(Pe=O.child;Pe;){if(Pe===T){le=!0,T=O,j=P;break}if(Pe===j){le=!0,j=O,T=P;break}Pe=Pe.sibling}if(!le)throw Error(i(189))}}if(T.alternate!==j)throw Error(i(190))}if(T.tag!==3)throw Error(i(188));return T.stateNode.current===T?f:m}function M(f){return f=R(f),f!==null?B(f):null}function B(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var m=B(f);if(m!==null)return m;f=f.sibling}return null}function J(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){if(f.tag!==4){var m=J(f);if(m!==null)return m}f=f.sibling}return null}var X=Array.isArray,z=e.getPublicInstance,H=e.getRootHostContext,U=e.getChildHostContext,L=e.prepareForCommit,ne=e.resetAfterCommit,de=e.createInstance,G=e.appendInitialChild,K=e.finalizeInitialChildren,Q=e.prepareUpdate,q=e.shouldSetTextContent,se=e.createTextInstance,W=e.scheduleTimeout,ee=e.cancelTimeout,ve=e.noTimeout,_e=e.isPrimaryRenderer,Le=e.supportsMutation,te=e.supportsPersistence,Ne=e.supportsHydration,Ce=e.getInstanceFromNode,We=e.preparePortalMount,nt=e.getCurrentEventPriority,$e=e.detachDeletedInstance,De=e.supportsMicrotasks,at=e.scheduleMicrotask,Se=e.supportsTestSelectors,Ae=e.findFiberRoot,Me=e.getBoundingRect,Ie=e.getTextContent,Ge=e.isHiddenSubtree,tt=e.matchAccessibilityRole,kt=e.setFocusIfFocusable,zt=e.setupIntersectionObserver,bt=e.appendChild,Dt=e.appendChildToContainer,it=e.commitTextUpdate,ht=e.commitMount,Ct=e.commitUpdate,jt=e.insertBefore,Fe=e.insertInContainerBefore,et=e.removeChild,Ze=e.removeChildFromContainer,rt=e.resetTextContent,dt=e.hideInstance,Tt=e.hideTextInstance,xe=e.unhideInstance,ue=e.unhideTextInstance,ye=e.clearContainer,be=e.cloneInstance,Ve=e.createContainerChildSet,Nt=e.appendChildToContainerChildSet,yt=e.finalizeContainerChildren,$t=e.replaceContainerChildren,Ft=e.cloneHiddenInstance,Ot=e.cloneHiddenTextInstance,xr=e.canHydrateInstance,yr=e.canHydrateTextInstance,qt=e.canHydrateSuspenseInstance,hr=e.isSuspenseInstancePending,Nr=e.isSuspenseInstanceFallback,Ln=e.getSuspenseInstanceFallbackErrorDetails,Y=e.registerSuspenseInstanceRetry,fe=e.getNextHydratableSibling,ae=e.getFirstHydratableChild,ce=e.getFirstHydratableChildWithinContainer,ge=e.getFirstHydratableChildWithinSuspenseInstance,V=e.hydrateInstance,ie=e.hydrateTextInstance,we=e.hydrateSuspenseInstance,me=e.getNextHydratableInstanceAfterSuspenseInstance,Te=e.commitHydratedContainer,I=e.commitHydratedSuspenseInstance,Z=e.clearSuspenseBoundary,pe=e.clearSuspenseBoundaryFromContainer,oe=e.shouldDeleteUnhydratedTailInstances,Ee=e.didNotMatchHydratedContainerTextInstance,Ue=e.didNotMatchHydratedTextInstance,Oe;function ut(f){if(Oe===void 0)try{throw Error()}catch(T){var m=T.stack.trim().match(/\n( *(at )?)/);Oe=m&&m[1]||""}return`
`+Oe+f}var he=!1;function je(f,m){if(!f||he)return"";he=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch(gt){var j=gt}Reflect.construct(f,[],m)}else{try{m.call()}catch(gt){j=gt}f.call(m.prototype)}else{try{throw Error()}catch(gt){j=gt}f()}}catch(gt){if(gt&&j&&typeof gt.stack=="string"){for(var P=gt.stack.split(`
`),O=j.stack.split(`
`),le=P.length-1,Pe=O.length-1;1<=le&&0<=Pe&&P[le]!==O[Pe];)Pe--;for(;1<=le&&0<=Pe;le--,Pe--)if(P[le]!==O[Pe]){if(le!==1||Pe!==1)do if(le--,Pe--,0>Pe||P[le]!==O[Pe]){var Ke=`
`+P[le].replace(" at new "," at ");return f.displayName&&Ke.includes("<anonymous>")&&(Ke=Ke.replace("<anonymous>",f.displayName)),Ke}while(1<=le&&0<=Pe);break}}}finally{he=!1,Error.prepareStackTrace=T}return(f=f?f.displayName||f.name:"")?ut(f):""}var Ye=Object.prototype.hasOwnProperty,mt=[],pt=-1;function Bt(f){return{current:f}}function Et(f){0>pt||(f.current=mt[pt],mt[pt]=null,pt--)}function St(f,m){pt++,mt[pt]=f.current,f.current=m}var re={},Xe=Bt(re),Ut=Bt(!1),Qt=re;function ss(f,m){var T=f.type.contextTypes;if(!T)return re;var j=f.stateNode;if(j&&j.__reactInternalMemoizedUnmaskedChildContext===m)return j.__reactInternalMemoizedMaskedChildContext;var P={},O;for(O in T)P[O]=m[O];return j&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=m,f.__reactInternalMemoizedMaskedChildContext=P),P}function Br(f){return f=f.childContextTypes,f!=null}function Vn(){Et(Ut),Et(Xe)}function Al(f,m,T){if(Xe.current!==re)throw Error(i(168));St(Xe,m),St(Ut,T)}function Ro(f,m,T){var j=f.stateNode;if(m=m.childContextTypes,typeof j.getChildContext!="function")return T;j=j.getChildContext();for(var P in j)if(!(P in m))throw Error(i(108,C(f)||"Unknown",P));return a({},T,j)}function _d(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||re,Qt=Xe.current,St(Xe,f),St(Ut,Ut.current),!0}function Im(f,m,T){var j=f.stateNode;if(!j)throw Error(i(169));T?(f=Ro(f,m,Qt),j.__reactInternalMemoizedMergedChildContext=f,Et(Ut),Et(Xe),St(Xe,f)):Et(Ut),St(Ut,T)}var ki=Math.clz32?Math.clz32:YI,KI=Math.log,XI=Math.LN2;function YI(f){return f>>>=0,f===0?32:31-(KI(f)/XI|0)|0}var Om=64,Bm=4194304;function Dh(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function Um(f,m){var T=f.pendingLanes;if(T===0)return 0;var j=0,P=f.suspendedLanes,O=f.pingedLanes,le=T&268435455;if(le!==0){var Pe=le&~P;Pe!==0?j=Dh(Pe):(O&=le,O!==0&&(j=Dh(O)))}else le=T&~P,le!==0?j=Dh(le):O!==0&&(j=Dh(O));if(j===0)return 0;if(m!==0&&m!==j&&!(m&P)&&(P=j&-j,O=m&-m,P>=O||P===16&&(O&4194240)!==0))return m;if(j&4&&(j|=T&16),m=f.entangledLanes,m!==0)for(f=f.entanglements,m&=j;0<m;)T=31-ki(m),P=1<<T,j|=f[T],m&=~P;return j}function JI(f,m){switch(f){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function QI(f,m){for(var T=f.suspendedLanes,j=f.pingedLanes,P=f.expirationTimes,O=f.pendingLanes;0<O;){var le=31-ki(O),Pe=1<<le,Ke=P[le];Ke===-1?(!(Pe&T)||Pe&j)&&(P[le]=JI(Pe,m)):Ke<=m&&(f.expiredLanes|=Pe),O&=~Pe}}function Kv(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function D4(){var f=Om;return Om<<=1,!(Om&4194240)&&(Om=64),f}function Xv(f){for(var m=[],T=0;31>T;T++)m.push(f);return m}function Rh(f,m,T){f.pendingLanes|=m,m!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,m=31-ki(m),f[m]=T}function qI(f,m){var T=f.pendingLanes&~m;f.pendingLanes=m,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=m,f.mutableReadLanes&=m,f.entangledLanes&=m,m=f.entanglements;var j=f.eventTimes;for(f=f.expirationTimes;0<T;){var P=31-ki(T),O=1<<P;m[P]=0,j[P]=-1,f[P]=-1,T&=~O}}function Yv(f,m){var T=f.entangledLanes|=m;for(f=f.entanglements;T;){var j=31-ki(T),P=1<<j;P&m|f[j]&m&&(f[j]|=m),T&=~P}}var br=0;function R4(f){return f&=-f,1<f?4<f?f&268435455?16:536870912:4:1}var Jv=s.unstable_scheduleCallback,M4=s.unstable_cancelCallback,ZI=s.unstable_shouldYield,eO=s.unstable_requestPaint,as=s.unstable_now,Qv=s.unstable_ImmediatePriority,tO=s.unstable_UserBlockingPriority,qv=s.unstable_NormalPriority,rO=s.unstable_IdlePriority,$m=null,Zi=null;function nO(f){if(Zi&&typeof Zi.onCommitFiberRoot=="function")try{Zi.onCommitFiberRoot($m,f,void 0,(f.current.flags&128)===128)}catch{}}function sO(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var Ci=typeof Object.is=="function"?Object.is:sO,Mo=null,Wm=!1,Zv=!1;function L4(f){Mo===null?Mo=[f]:Mo.push(f)}function aO(f){Wm=!0,L4(f)}function eo(){if(!Zv&&Mo!==null){Zv=!0;var f=0,m=br;try{var T=Mo;for(br=1;f<T.length;f++){var j=T[f];do j=j(!0);while(j!==null)}Mo=null,Wm=!1}catch(P){throw Mo!==null&&(Mo=Mo.slice(f+1)),Jv(Qv,eo),P}finally{br=m,Zv=!1}}return null}var bd=[],Sd=0,zm=null,Hm=0,Ga=[],Va=0,zc=null,Lo=1,Io="";function Hc(f,m){bd[Sd++]=Hm,bd[Sd++]=zm,zm=f,Hm=m}function I4(f,m,T){Ga[Va++]=Lo,Ga[Va++]=Io,Ga[Va++]=zc,zc=f;var j=Lo;f=Io;var P=32-ki(j)-1;j&=~(1<<P),T+=1;var O=32-ki(m)+P;if(30<O){var le=P-P%5;O=(j&(1<<le)-1).toString(32),j>>=le,P-=le,Lo=1<<32-ki(m)+P|T<<P|j,Io=O+f}else Lo=1<<O|T<<P|j,Io=f}function ew(f){f.return!==null&&(Hc(f,1),I4(f,1,0))}function tw(f){for(;f===zm;)zm=bd[--Sd],bd[Sd]=null,Hm=bd[--Sd],bd[Sd]=null;for(;f===zc;)zc=Ga[--Va],Ga[Va]=null,Io=Ga[--Va],Ga[Va]=null,Lo=Ga[--Va],Ga[Va]=null}var Aa=null,Ka=null,en=!1,Mh=!1,Ti=null;function O4(f,m){var T=qa(5,null,null,0);T.elementType="DELETED",T.stateNode=m,T.return=f,m=f.deletions,m===null?(f.deletions=[T],f.flags|=16):m.push(T)}function B4(f,m){switch(f.tag){case 5:return m=xr(m,f.type,f.pendingProps),m!==null?(f.stateNode=m,Aa=f,Ka=ae(m),!0):!1;case 6:return m=yr(m,f.pendingProps),m!==null?(f.stateNode=m,Aa=f,Ka=null,!0):!1;case 13:if(m=qt(m),m!==null){var T=zc!==null?{id:Lo,overflow:Io}:null;return f.memoizedState={dehydrated:m,treeContext:T,retryLane:1073741824},T=qa(18,null,null,0),T.stateNode=m,T.return=f,f.child=T,Aa=f,Ka=null,!0}return!1;default:return!1}}function rw(f){return(f.mode&1)!==0&&(f.flags&128)===0}function nw(f){if(en){var m=Ka;if(m){var T=m;if(!B4(f,m)){if(rw(f))throw Error(i(418));m=fe(T);var j=Aa;m&&B4(f,m)?O4(j,T):(f.flags=f.flags&-4097|2,en=!1,Aa=f)}}else{if(rw(f))throw Error(i(418));f.flags=f.flags&-4097|2,en=!1,Aa=f}}}function U4(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;Aa=f}function Gm(f){if(!Ne||f!==Aa)return!1;if(!en)return U4(f),en=!0,!1;if(f.tag!==3&&(f.tag!==5||oe(f.type)&&!q(f.type,f.memoizedProps))){var m=Ka;if(m){if(rw(f))throw $4(),Error(i(418));for(;m;)O4(f,m),m=fe(m)}}if(U4(f),f.tag===13){if(!Ne)throw Error(i(316));if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));Ka=me(f)}else Ka=Aa?fe(f.stateNode):null;return!0}function $4(){for(var f=Ka;f;)f=fe(f)}function kd(){Ne&&(Ka=Aa=null,Mh=en=!1)}function sw(f){Ti===null?Ti=[f]:Ti.push(f)}var iO=o.ReactCurrentBatchConfig;function Vm(f,m){if(Ci(f,m))return!0;if(typeof f!="object"||f===null||typeof m!="object"||m===null)return!1;var T=Object.keys(f),j=Object.keys(m);if(T.length!==j.length)return!1;for(j=0;j<T.length;j++){var P=T[j];if(!Ye.call(m,P)||!Ci(f[P],m[P]))return!1}return!0}function oO(f){switch(f.tag){case 5:return ut(f.type);case 16:return ut("Lazy");case 13:return ut("Suspense");case 19:return ut("SuspenseList");case 0:case 2:case 15:return f=je(f.type,!1),f;case 11:return f=je(f.type.render,!1),f;case 1:return f=je(f.type,!0),f;default:return""}}function Lh(f,m,T){if(f=T.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(T._owner){if(T=T._owner,T){if(T.tag!==1)throw Error(i(309));var j=T.stateNode}if(!j)throw Error(i(147,f));var P=j,O=""+f;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===O?m.ref:(m=function(le){var Pe=P.refs;le===null?delete Pe[O]:Pe[O]=le},m._stringRef=O,m)}if(typeof f!="string")throw Error(i(284));if(!T._owner)throw Error(i(290,f))}return f}function Km(f,m){throw f=Object.prototype.toString.call(m),Error(i(31,f==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":f))}function W4(f){var m=f._init;return m(f._payload)}function z4(f){function m(ze,Re){if(f){var Je=ze.deletions;Je===null?(ze.deletions=[Re],ze.flags|=16):Je.push(Re)}}function T(ze,Re){if(!f)return null;for(;Re!==null;)m(ze,Re),Re=Re.sibling;return null}function j(ze,Re){for(ze=new Map;Re!==null;)Re.key!==null?ze.set(Re.key,Re):ze.set(Re.index,Re),Re=Re.sibling;return ze}function P(ze,Re){return ze=Ll(ze,Re),ze.index=0,ze.sibling=null,ze}function O(ze,Re,Je){return ze.index=Je,f?(Je=ze.alternate,Je!==null?(Je=Je.index,Je<Re?(ze.flags|=2,Re):Je):(ze.flags|=2,Re)):(ze.flags|=1048576,Re)}function le(ze){return f&&ze.alternate===null&&(ze.flags|=2),ze}function Pe(ze,Re,Je,Pt){return Re===null||Re.tag!==6?(Re=Zw(Je,ze.mode,Pt),Re.return=ze,Re):(Re=P(Re,Je),Re.return=ze,Re)}function Ke(ze,Re,Je,Pt){var Ht=Je.type;return Ht===d?It(ze,Re,Je.props.children,Pt,Je.key):Re!==null&&(Re.elementType===Ht||typeof Ht=="object"&&Ht!==null&&Ht.$$typeof===y&&W4(Ht)===Re.type)?(Pt=P(Re,Je.props),Pt.ref=Lh(ze,Re,Je),Pt.return=ze,Pt):(Pt=kp(Je.type,Je.key,Je.props,null,ze.mode,Pt),Pt.ref=Lh(ze,Re,Je),Pt.return=ze,Pt)}function gt(ze,Re,Je,Pt){return Re===null||Re.tag!==4||Re.stateNode.containerInfo!==Je.containerInfo||Re.stateNode.implementation!==Je.implementation?(Re=e_(Je,ze.mode,Pt),Re.return=ze,Re):(Re=P(Re,Je.children||[]),Re.return=ze,Re)}function It(ze,Re,Je,Pt,Ht){return Re===null||Re.tag!==7?(Re=Qc(Je,ze.mode,Pt,Ht),Re.return=ze,Re):(Re=P(Re,Je),Re.return=ze,Re)}function tr(ze,Re,Je){if(typeof Re=="string"&&Re!==""||typeof Re=="number")return Re=Zw(""+Re,ze.mode,Je),Re.return=ze,Re;if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case l:return Je=kp(Re.type,Re.key,Re.props,null,ze.mode,Je),Je.ref=Lh(ze,null,Re),Je.return=ze,Je;case u:return Re=e_(Re,ze.mode,Je),Re.return=ze,Re;case y:var Pt=Re._init;return tr(ze,Pt(Re._payload),Je)}if(X(Re)||E(Re))return Re=Qc(Re,ze.mode,Je,null),Re.return=ze,Re;Km(ze,Re)}return null}function At(ze,Re,Je,Pt){var Ht=Re!==null?Re.key:null;if(typeof Je=="string"&&Je!==""||typeof Je=="number")return Ht!==null?null:Pe(ze,Re,""+Je,Pt);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case l:return Je.key===Ht?Ke(ze,Re,Je,Pt):null;case u:return Je.key===Ht?gt(ze,Re,Je,Pt):null;case y:return Ht=Je._init,At(ze,Re,Ht(Je._payload),Pt)}if(X(Je)||E(Je))return Ht!==null?null:It(ze,Re,Je,Pt,null);Km(ze,Je)}return null}function Gr(ze,Re,Je,Pt,Ht){if(typeof Pt=="string"&&Pt!==""||typeof Pt=="number")return ze=ze.get(Je)||null,Pe(Re,ze,""+Pt,Ht);if(typeof Pt=="object"&&Pt!==null){switch(Pt.$$typeof){case l:return ze=ze.get(Pt.key===null?Je:Pt.key)||null,Ke(Re,ze,Pt,Ht);case u:return ze=ze.get(Pt.key===null?Je:Pt.key)||null,gt(Re,ze,Pt,Ht);case y:var ir=Pt._init;return Gr(ze,Re,Je,ir(Pt._payload),Ht)}if(X(Pt)||E(Pt))return ze=ze.get(Je)||null,It(Re,ze,Pt,Ht,null);Km(Re,Pt)}return null}function Ur(ze,Re,Je,Pt){for(var Ht=null,ir=null,rr=Re,Sr=Re=0,ls=null;rr!==null&&Sr<Je.length;Sr++){rr.index>Sr?(ls=rr,rr=null):ls=rr.sibling;var kr=At(ze,rr,Je[Sr],Pt);if(kr===null){rr===null&&(rr=ls);break}f&&rr&&kr.alternate===null&&m(ze,rr),Re=O(kr,Re,Sr),ir===null?Ht=kr:ir.sibling=kr,ir=kr,rr=ls}if(Sr===Je.length)return T(ze,rr),en&&Hc(ze,Sr),Ht;if(rr===null){for(;Sr<Je.length;Sr++)rr=tr(ze,Je[Sr],Pt),rr!==null&&(Re=O(rr,Re,Sr),ir===null?Ht=rr:ir.sibling=rr,ir=rr);return en&&Hc(ze,Sr),Ht}for(rr=j(ze,rr);Sr<Je.length;Sr++)ls=Gr(rr,ze,Sr,Je[Sr],Pt),ls!==null&&(f&&ls.alternate!==null&&rr.delete(ls.key===null?Sr:ls.key),Re=O(ls,Re,Sr),ir===null?Ht=ls:ir.sibling=ls,ir=ls);return f&&rr.forEach(function(Il){return m(ze,Il)}),en&&Hc(ze,Sr),Ht}function ga(ze,Re,Je,Pt){var Ht=E(Je);if(typeof Ht!="function")throw Error(i(150));if(Je=Ht.call(Je),Je==null)throw Error(i(151));for(var ir=Ht=null,rr=Re,Sr=Re=0,ls=null,kr=Je.next();rr!==null&&!kr.done;Sr++,kr=Je.next()){rr.index>Sr?(ls=rr,rr=null):ls=rr.sibling;var Il=At(ze,rr,kr.value,Pt);if(Il===null){rr===null&&(rr=ls);break}f&&rr&&Il.alternate===null&&m(ze,rr),Re=O(Il,Re,Sr),ir===null?Ht=Il:ir.sibling=Il,ir=Il,rr=ls}if(kr.done)return T(ze,rr),en&&Hc(ze,Sr),Ht;if(rr===null){for(;!kr.done;Sr++,kr=Je.next())kr=tr(ze,kr.value,Pt),kr!==null&&(Re=O(kr,Re,Sr),ir===null?Ht=kr:ir.sibling=kr,ir=kr);return en&&Hc(ze,Sr),Ht}for(rr=j(ze,rr);!kr.done;Sr++,kr=Je.next())kr=Gr(rr,ze,Sr,kr.value,Pt),kr!==null&&(f&&kr.alternate!==null&&rr.delete(kr.key===null?Sr:kr.key),Re=O(kr,Re,Sr),ir===null?Ht=kr:ir.sibling=kr,ir=kr);return f&&rr.forEach(function(IO){return m(ze,IO)}),en&&Hc(ze,Sr),Ht}function $o(ze,Re,Je,Pt){if(typeof Je=="object"&&Je!==null&&Je.type===d&&Je.key===null&&(Je=Je.props.children),typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case l:e:{for(var Ht=Je.key,ir=Re;ir!==null;){if(ir.key===Ht){if(Ht=Je.type,Ht===d){if(ir.tag===7){T(ze,ir.sibling),Re=P(ir,Je.props.children),Re.return=ze,ze=Re;break e}}else if(ir.elementType===Ht||typeof Ht=="object"&&Ht!==null&&Ht.$$typeof===y&&W4(Ht)===ir.type){T(ze,ir.sibling),Re=P(ir,Je.props),Re.ref=Lh(ze,ir,Je),Re.return=ze,ze=Re;break e}T(ze,ir);break}else m(ze,ir);ir=ir.sibling}Je.type===d?(Re=Qc(Je.props.children,ze.mode,Pt,Je.key),Re.return=ze,ze=Re):(Pt=kp(Je.type,Je.key,Je.props,null,ze.mode,Pt),Pt.ref=Lh(ze,Re,Je),Pt.return=ze,ze=Pt)}return le(ze);case u:e:{for(ir=Je.key;Re!==null;){if(Re.key===ir)if(Re.tag===4&&Re.stateNode.containerInfo===Je.containerInfo&&Re.stateNode.implementation===Je.implementation){T(ze,Re.sibling),Re=P(Re,Je.children||[]),Re.return=ze,ze=Re;break e}else{T(ze,Re);break}else m(ze,Re);Re=Re.sibling}Re=e_(Je,ze.mode,Pt),Re.return=ze,ze=Re}return le(ze);case y:return ir=Je._init,$o(ze,Re,ir(Je._payload),Pt)}if(X(Je))return Ur(ze,Re,Je,Pt);if(E(Je))return ga(ze,Re,Je,Pt);Km(ze,Je)}return typeof Je=="string"&&Je!==""||typeof Je=="number"?(Je=""+Je,Re!==null&&Re.tag===6?(T(ze,Re.sibling),Re=P(Re,Je),Re.return=ze,ze=Re):(T(ze,Re),Re=Zw(Je,ze.mode,Pt),Re.return=ze,ze=Re),le(ze)):T(ze,Re)}return $o}var Cd=z4(!0),H4=z4(!1),Xm=Bt(null),Ym=null,Td=null,aw=null;function iw(){aw=Td=Ym=null}function G4(f,m,T){_e?(St(Xm,m._currentValue),m._currentValue=T):(St(Xm,m._currentValue2),m._currentValue2=T)}function ow(f){var m=Xm.current;Et(Xm),_e?f._currentValue=m:f._currentValue2=m}function lw(f,m,T){for(;f!==null;){var j=f.alternate;if((f.childLanes&m)!==m?(f.childLanes|=m,j!==null&&(j.childLanes|=m)):j!==null&&(j.childLanes&m)!==m&&(j.childLanes|=m),f===T)break;f=f.return}}function Ed(f,m){Ym=f,aw=Td=null,f=f.dependencies,f!==null&&f.firstContext!==null&&(f.lanes&m&&(da=!0),f.firstContext=null)}function Xa(f){var m=_e?f._currentValue:f._currentValue2;if(aw!==f)if(f={context:f,memoizedValue:m,next:null},Td===null){if(Ym===null)throw Error(i(308));Td=f,Ym.dependencies={lanes:0,firstContext:f}}else Td=Td.next=f;return m}var Gc=null;function cw(f){Gc===null?Gc=[f]:Gc.push(f)}function V4(f,m,T,j){var P=m.interleaved;return P===null?(T.next=T,cw(m)):(T.next=P.next,P.next=T),m.interleaved=T,to(f,j)}function to(f,m){f.lanes|=m;var T=f.alternate;for(T!==null&&(T.lanes|=m),T=f,f=f.return;f!==null;)f.childLanes|=m,T=f.alternate,T!==null&&(T.childLanes|=m),T=f,f=f.return;return T.tag===3?T.stateNode:null}var jl=!1;function uw(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function K4(f,m){f=f.updateQueue,m.updateQueue===f&&(m.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function Oo(f,m){return{eventTime:f,lane:m,tag:0,payload:null,callback:null,next:null}}function Fl(f,m,T){var j=f.updateQueue;if(j===null)return null;if(j=j.shared,cr&2){var P=j.pending;return P===null?m.next=m:(m.next=P.next,P.next=m),j.pending=m,to(f,T)}return P=j.interleaved,P===null?(m.next=m,cw(j)):(m.next=P.next,P.next=m),j.interleaved=m,to(f,T)}function Jm(f,m,T){if(m=m.updateQueue,m!==null&&(m=m.shared,(T&4194240)!==0)){var j=m.lanes;j&=f.pendingLanes,T|=j,m.lanes=T,Yv(f,T)}}function X4(f,m){var T=f.updateQueue,j=f.alternate;if(j!==null&&(j=j.updateQueue,T===j)){var P=null,O=null;if(T=T.firstBaseUpdate,T!==null){do{var le={eventTime:T.eventTime,lane:T.lane,tag:T.tag,payload:T.payload,callback:T.callback,next:null};O===null?P=O=le:O=O.next=le,T=T.next}while(T!==null);O===null?P=O=m:O=O.next=m}else P=O=m;T={baseState:j.baseState,firstBaseUpdate:P,lastBaseUpdate:O,shared:j.shared,effects:j.effects},f.updateQueue=T;return}f=T.lastBaseUpdate,f===null?T.firstBaseUpdate=m:f.next=m,T.lastBaseUpdate=m}function Qm(f,m,T,j){var P=f.updateQueue;jl=!1;var O=P.firstBaseUpdate,le=P.lastBaseUpdate,Pe=P.shared.pending;if(Pe!==null){P.shared.pending=null;var Ke=Pe,gt=Ke.next;Ke.next=null,le===null?O=gt:le.next=gt,le=Ke;var It=f.alternate;It!==null&&(It=It.updateQueue,Pe=It.lastBaseUpdate,Pe!==le&&(Pe===null?It.firstBaseUpdate=gt:Pe.next=gt,It.lastBaseUpdate=Ke))}if(O!==null){var tr=P.baseState;le=0,It=gt=Ke=null,Pe=O;do{var At=Pe.lane,Gr=Pe.eventTime;if((j&At)===At){It!==null&&(It=It.next={eventTime:Gr,lane:0,tag:Pe.tag,payload:Pe.payload,callback:Pe.callback,next:null});e:{var Ur=f,ga=Pe;switch(At=m,Gr=T,ga.tag){case 1:if(Ur=ga.payload,typeof Ur=="function"){tr=Ur.call(Gr,tr,At);break e}tr=Ur;break e;case 3:Ur.flags=Ur.flags&-65537|128;case 0:if(Ur=ga.payload,At=typeof Ur=="function"?Ur.call(Gr,tr,At):Ur,At==null)break e;tr=a({},tr,At);break e;case 2:jl=!0}}Pe.callback!==null&&Pe.lane!==0&&(f.flags|=64,At=P.effects,At===null?P.effects=[Pe]:At.push(Pe))}else Gr={eventTime:Gr,lane:At,tag:Pe.tag,payload:Pe.payload,callback:Pe.callback,next:null},It===null?(gt=It=Gr,Ke=tr):It=It.next=Gr,le|=At;if(Pe=Pe.next,Pe===null){if(Pe=P.shared.pending,Pe===null)break;At=Pe,Pe=At.next,At.next=null,P.lastBaseUpdate=At,P.shared.pending=null}}while(!0);if(It===null&&(Ke=tr),P.baseState=Ke,P.firstBaseUpdate=gt,P.lastBaseUpdate=It,m=P.shared.interleaved,m!==null){P=m;do le|=P.lane,P=P.next;while(P!==m)}else O===null&&(P.shared.lanes=0);Kc|=le,f.lanes=le,f.memoizedState=tr}}function Y4(f,m,T){if(f=m.effects,m.effects=null,f!==null)for(m=0;m<f.length;m++){var j=f[m],P=j.callback;if(P!==null){if(j.callback=null,j=T,typeof P!="function")throw Error(i(191,P));P.call(j)}}}var Ih={},Ya=Bt(Ih),Oh=Bt(Ih),Nd=Bt(Ih);function ro(f){if(f===Ih)throw Error(i(174));return f}function dw(f,m){St(Nd,m),St(Oh,f),St(Ya,Ih),f=H(m),Et(Ya),St(Ya,f)}function Ad(){Et(Ya),Et(Oh),Et(Nd)}function J4(f){var m=ro(Nd.current),T=ro(Ya.current);m=U(T,f.type,m),T!==m&&(St(Oh,f),St(Ya,m))}function fw(f){Oh.current===f&&(Et(Ya),Et(Oh))}var ln=Bt(0);function qm(f){for(var m=f;m!==null;){if(m.tag===13){var T=m.memoizedState;if(T!==null&&(T=T.dehydrated,T===null||hr(T)||Nr(T)))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if(m.flags&128)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===f)break;for(;m.sibling===null;){if(m.return===null||m.return===f)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var hw=[];function gw(){for(var f=0;f<hw.length;f++){var m=hw[f];_e?m._workInProgressVersionPrimary=null:m._workInProgressVersionSecondary=null}hw.length=0}var Zm=o.ReactCurrentDispatcher,mw=o.ReactCurrentBatchConfig,Vc=0,cn=null,Kn=null,is=null,ep=!1,Bh=!1,Uh=0,lO=0;function As(){throw Error(i(321))}function pw(f,m){if(m===null)return!1;for(var T=0;T<m.length&&T<f.length;T++)if(!Ci(f[T],m[T]))return!1;return!0}function xw(f,m,T,j,P,O){if(Vc=O,cn=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,Zm.current=f===null||f.memoizedState===null?fO:hO,f=T(j,P),Bh){O=0;do{if(Bh=!1,Uh=0,25<=O)throw Error(i(301));O+=1,is=Kn=null,m.updateQueue=null,Zm.current=gO,f=T(j,P)}while(Bh)}if(Zm.current=np,m=Kn!==null&&Kn.next!==null,Vc=0,is=Kn=cn=null,ep=!1,m)throw Error(i(300));return f}function yw(){var f=Uh!==0;return Uh=0,f}function no(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return is===null?cn.memoizedState=is=f:is=is.next=f,is}function Ja(){if(Kn===null){var f=cn.alternate;f=f!==null?f.memoizedState:null}else f=Kn.next;var m=is===null?cn.memoizedState:is.next;if(m!==null)is=m,Kn=f;else{if(f===null)throw Error(i(310));Kn=f,f={memoizedState:Kn.memoizedState,baseState:Kn.baseState,baseQueue:Kn.baseQueue,queue:Kn.queue,next:null},is===null?cn.memoizedState=is=f:is=is.next=f}return is}function $h(f,m){return typeof m=="function"?m(f):m}function vw(f){var m=Ja(),T=m.queue;if(T===null)throw Error(i(311));T.lastRenderedReducer=f;var j=Kn,P=j.baseQueue,O=T.pending;if(O!==null){if(P!==null){var le=P.next;P.next=O.next,O.next=le}j.baseQueue=P=O,T.pending=null}if(P!==null){O=P.next,j=j.baseState;var Pe=le=null,Ke=null,gt=O;do{var It=gt.lane;if((Vc&It)===It)Ke!==null&&(Ke=Ke.next={lane:0,action:gt.action,hasEagerState:gt.hasEagerState,eagerState:gt.eagerState,next:null}),j=gt.hasEagerState?gt.eagerState:f(j,gt.action);else{var tr={lane:It,action:gt.action,hasEagerState:gt.hasEagerState,eagerState:gt.eagerState,next:null};Ke===null?(Pe=Ke=tr,le=j):Ke=Ke.next=tr,cn.lanes|=It,Kc|=It}gt=gt.next}while(gt!==null&&gt!==O);Ke===null?le=j:Ke.next=Pe,Ci(j,m.memoizedState)||(da=!0),m.memoizedState=j,m.baseState=le,m.baseQueue=Ke,T.lastRenderedState=j}if(f=T.interleaved,f!==null){P=f;do O=P.lane,cn.lanes|=O,Kc|=O,P=P.next;while(P!==f)}else P===null&&(T.lanes=0);return[m.memoizedState,T.dispatch]}function ww(f){var m=Ja(),T=m.queue;if(T===null)throw Error(i(311));T.lastRenderedReducer=f;var j=T.dispatch,P=T.pending,O=m.memoizedState;if(P!==null){T.pending=null;var le=P=P.next;do O=f(O,le.action),le=le.next;while(le!==P);Ci(O,m.memoizedState)||(da=!0),m.memoizedState=O,m.baseQueue===null&&(m.baseState=O),T.lastRenderedState=O}return[O,j]}function Q4(){}function q4(f,m){var T=cn,j=Ja(),P=m(),O=!Ci(j.memoizedState,P);if(O&&(j.memoizedState=P,da=!0),j=j.queue,_w(tE.bind(null,T,j,f),[f]),j.getSnapshot!==m||O||is!==null&&is.memoizedState.tag&1){if(T.flags|=2048,Wh(9,eE.bind(null,T,j,P,m),void 0,null),os===null)throw Error(i(349));Vc&30||Z4(T,m,P)}return P}function Z4(f,m,T){f.flags|=16384,f={getSnapshot:m,value:T},m=cn.updateQueue,m===null?(m={lastEffect:null,stores:null},cn.updateQueue=m,m.stores=[f]):(T=m.stores,T===null?m.stores=[f]:T.push(f))}function eE(f,m,T,j){m.value=T,m.getSnapshot=j,rE(m)&&nE(f)}function tE(f,m,T){return T(function(){rE(m)&&nE(f)})}function rE(f){var m=f.getSnapshot;f=f.value;try{var T=m();return!Ci(f,T)}catch{return!0}}function nE(f){var m=to(f,1);m!==null&&Qa(m,f,1,-1)}function sE(f){var m=no();return typeof f=="function"&&(f=f()),m.memoizedState=m.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$h,lastRenderedState:f},m.queue=f,f=f.dispatch=dO.bind(null,cn,f),[m.memoizedState,f]}function Wh(f,m,T,j){return f={tag:f,create:m,destroy:T,deps:j,next:null},m=cn.updateQueue,m===null?(m={lastEffect:null,stores:null},cn.updateQueue=m,m.lastEffect=f.next=f):(T=m.lastEffect,T===null?m.lastEffect=f.next=f:(j=T.next,T.next=f,f.next=j,m.lastEffect=f)),f}function aE(){return Ja().memoizedState}function tp(f,m,T,j){var P=no();cn.flags|=f,P.memoizedState=Wh(1|m,T,void 0,j===void 0?null:j)}function rp(f,m,T,j){var P=Ja();j=j===void 0?null:j;var O=void 0;if(Kn!==null){var le=Kn.memoizedState;if(O=le.destroy,j!==null&&pw(j,le.deps)){P.memoizedState=Wh(m,T,O,j);return}}cn.flags|=f,P.memoizedState=Wh(1|m,T,O,j)}function iE(f,m){return tp(8390656,8,f,m)}function _w(f,m){return rp(2048,8,f,m)}function oE(f,m){return rp(4,2,f,m)}function lE(f,m){return rp(4,4,f,m)}function cE(f,m){if(typeof m=="function")return f=f(),m(f),function(){m(null)};if(m!=null)return f=f(),m.current=f,function(){m.current=null}}function uE(f,m,T){return T=T!=null?T.concat([f]):null,rp(4,4,cE.bind(null,m,f),T)}function bw(){}function dE(f,m){var T=Ja();m=m===void 0?null:m;var j=T.memoizedState;return j!==null&&m!==null&&pw(m,j[1])?j[0]:(T.memoizedState=[f,m],f)}function fE(f,m){var T=Ja();m=m===void 0?null:m;var j=T.memoizedState;return j!==null&&m!==null&&pw(m,j[1])?j[0]:(f=f(),T.memoizedState=[f,m],f)}function hE(f,m,T){return Vc&21?(Ci(T,m)||(T=D4(),cn.lanes|=T,Kc|=T,f.baseState=!0),m):(f.baseState&&(f.baseState=!1,da=!0),f.memoizedState=T)}function cO(f,m){var T=br;br=T!==0&&4>T?T:4,f(!0);var j=mw.transition;mw.transition={};try{f(!1),m()}finally{br=T,mw.transition=j}}function gE(){return Ja().memoizedState}function uO(f,m,T){var j=Rl(f);if(T={lane:j,action:T,hasEagerState:!1,eagerState:null,next:null},mE(f))pE(m,T);else if(T=V4(f,m,T,j),T!==null){var P=Ps();Qa(T,f,j,P),xE(T,m,j)}}function dO(f,m,T){var j=Rl(f),P={lane:j,action:T,hasEagerState:!1,eagerState:null,next:null};if(mE(f))pE(m,P);else{var O=f.alternate;if(f.lanes===0&&(O===null||O.lanes===0)&&(O=m.lastRenderedReducer,O!==null))try{var le=m.lastRenderedState,Pe=O(le,T);if(P.hasEagerState=!0,P.eagerState=Pe,Ci(Pe,le)){var Ke=m.interleaved;Ke===null?(P.next=P,cw(m)):(P.next=Ke.next,Ke.next=P),m.interleaved=P;return}}catch{}finally{}T=V4(f,m,P,j),T!==null&&(P=Ps(),Qa(T,f,j,P),xE(T,m,j))}}function mE(f){var m=f.alternate;return f===cn||m!==null&&m===cn}function pE(f,m){Bh=ep=!0;var T=f.pending;T===null?m.next=m:(m.next=T.next,T.next=m),f.pending=m}function xE(f,m,T){if(T&4194240){var j=m.lanes;j&=f.pendingLanes,T|=j,m.lanes=T,Yv(f,T)}}var np={readContext:Xa,useCallback:As,useContext:As,useEffect:As,useImperativeHandle:As,useInsertionEffect:As,useLayoutEffect:As,useMemo:As,useReducer:As,useRef:As,useState:As,useDebugValue:As,useDeferredValue:As,useTransition:As,useMutableSource:As,useSyncExternalStore:As,useId:As,unstable_isNewReconciler:!1},fO={readContext:Xa,useCallback:function(f,m){return no().memoizedState=[f,m===void 0?null:m],f},useContext:Xa,useEffect:iE,useImperativeHandle:function(f,m,T){return T=T!=null?T.concat([f]):null,tp(4194308,4,cE.bind(null,m,f),T)},useLayoutEffect:function(f,m){return tp(4194308,4,f,m)},useInsertionEffect:function(f,m){return tp(4,2,f,m)},useMemo:function(f,m){var T=no();return m=m===void 0?null:m,f=f(),T.memoizedState=[f,m],f},useReducer:function(f,m,T){var j=no();return m=T!==void 0?T(m):m,j.memoizedState=j.baseState=m,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:m},j.queue=f,f=f.dispatch=uO.bind(null,cn,f),[j.memoizedState,f]},useRef:function(f){var m=no();return f={current:f},m.memoizedState=f},useState:sE,useDebugValue:bw,useDeferredValue:function(f){return no().memoizedState=f},useTransition:function(){var f=sE(!1),m=f[0];return f=cO.bind(null,f[1]),no().memoizedState=f,[m,f]},useMutableSource:function(){},useSyncExternalStore:function(f,m,T){var j=cn,P=no();if(en){if(T===void 0)throw Error(i(407));T=T()}else{if(T=m(),os===null)throw Error(i(349));Vc&30||Z4(j,m,T)}P.memoizedState=T;var O={value:T,getSnapshot:m};return P.queue=O,iE(tE.bind(null,j,O,f),[f]),j.flags|=2048,Wh(9,eE.bind(null,j,O,T,m),void 0,null),T},useId:function(){var f=no(),m=os.identifierPrefix;if(en){var T=Io,j=Lo;T=(j&~(1<<32-ki(j)-1)).toString(32)+T,m=":"+m+"R"+T,T=Uh++,0<T&&(m+="H"+T.toString(32)),m+=":"}else T=lO++,m=":"+m+"r"+T.toString(32)+":";return f.memoizedState=m},unstable_isNewReconciler:!1},hO={readContext:Xa,useCallback:dE,useContext:Xa,useEffect:_w,useImperativeHandle:uE,useInsertionEffect:oE,useLayoutEffect:lE,useMemo:fE,useReducer:vw,useRef:aE,useState:function(){return vw($h)},useDebugValue:bw,useDeferredValue:function(f){var m=Ja();return hE(m,Kn.memoizedState,f)},useTransition:function(){var f=vw($h)[0],m=Ja().memoizedState;return[f,m]},useMutableSource:Q4,useSyncExternalStore:q4,useId:gE,unstable_isNewReconciler:!1},gO={readContext:Xa,useCallback:dE,useContext:Xa,useEffect:_w,useImperativeHandle:uE,useInsertionEffect:oE,useLayoutEffect:lE,useMemo:fE,useReducer:ww,useRef:aE,useState:function(){return ww($h)},useDebugValue:bw,useDeferredValue:function(f){var m=Ja();return Kn===null?m.memoizedState=f:hE(m,Kn.memoizedState,f)},useTransition:function(){var f=ww($h)[0],m=Ja().memoizedState;return[f,m]},useMutableSource:Q4,useSyncExternalStore:q4,useId:gE,unstable_isNewReconciler:!1};function Ei(f,m){if(f&&f.defaultProps){m=a({},m),f=f.defaultProps;for(var T in f)m[T]===void 0&&(m[T]=f[T]);return m}return m}function Sw(f,m,T,j){m=f.memoizedState,T=T(j,m),T=T==null?m:a({},m,T),f.memoizedState=T,f.lanes===0&&(f.updateQueue.baseState=T)}var sp={isMounted:function(f){return(f=f._reactInternals)?F(f)===f:!1},enqueueSetState:function(f,m,T){f=f._reactInternals;var j=Ps(),P=Rl(f),O=Oo(j,P);O.payload=m,T!=null&&(O.callback=T),m=Fl(f,O,P),m!==null&&(Qa(m,f,P,j),Jm(m,f,P))},enqueueReplaceState:function(f,m,T){f=f._reactInternals;var j=Ps(),P=Rl(f),O=Oo(j,P);O.tag=1,O.payload=m,T!=null&&(O.callback=T),m=Fl(f,O,P),m!==null&&(Qa(m,f,P,j),Jm(m,f,P))},enqueueForceUpdate:function(f,m){f=f._reactInternals;var T=Ps(),j=Rl(f),P=Oo(T,j);P.tag=2,m!=null&&(P.callback=m),m=Fl(f,P,j),m!==null&&(Qa(m,f,j,T),Jm(m,f,j))}};function yE(f,m,T,j,P,O,le){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(j,O,le):m.prototype&&m.prototype.isPureReactComponent?!Vm(T,j)||!Vm(P,O):!0}function vE(f,m,T){var j=!1,P=re,O=m.contextType;return typeof O=="object"&&O!==null?O=Xa(O):(P=Br(m)?Qt:Xe.current,j=m.contextTypes,O=(j=j!=null)?ss(f,P):re),m=new m(T,O),f.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=sp,f.stateNode=m,m._reactInternals=f,j&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=P,f.__reactInternalMemoizedMaskedChildContext=O),m}function wE(f,m,T,j){f=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(T,j),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(T,j),m.state!==f&&sp.enqueueReplaceState(m,m.state,null)}function kw(f,m,T,j){var P=f.stateNode;P.props=T,P.state=f.memoizedState,P.refs={},uw(f);var O=m.contextType;typeof O=="object"&&O!==null?P.context=Xa(O):(O=Br(m)?Qt:Xe.current,P.context=ss(f,O)),P.state=f.memoizedState,O=m.getDerivedStateFromProps,typeof O=="function"&&(Sw(f,m,O,T),P.state=f.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(m=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),m!==P.state&&sp.enqueueReplaceState(P,P.state,null),Qm(f,T,P,j),P.state=f.memoizedState),typeof P.componentDidMount=="function"&&(f.flags|=4194308)}function jd(f,m){try{var T="",j=m;do T+=oO(j),j=j.return;while(j);var P=T}catch(O){P=`
Error generating stack: `+O.message+`
`+O.stack}return{value:f,source:m,stack:P,digest:null}}function Cw(f,m,T){return{value:f,source:null,stack:T??null,digest:m??null}}function Tw(f,m){try{console.error(m.value)}catch(T){setTimeout(function(){throw T})}}var mO=typeof WeakMap=="function"?WeakMap:Map;function _E(f,m,T){T=Oo(-1,T),T.tag=3,T.payload={element:null};var j=m.value;return T.callback=function(){yp||(yp=!0,Vw=j),Tw(f,m)},T}function bE(f,m,T){T=Oo(-1,T),T.tag=3;var j=f.type.getDerivedStateFromError;if(typeof j=="function"){var P=m.value;T.payload=function(){return j(P)},T.callback=function(){Tw(f,m)}}var O=f.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(T.callback=function(){Tw(f,m),typeof j!="function"&&(Pl===null?Pl=new Set([this]):Pl.add(this));var le=m.stack;this.componentDidCatch(m.value,{componentStack:le!==null?le:""})}),T}function SE(f,m,T){var j=f.pingCache;if(j===null){j=f.pingCache=new mO;var P=new Set;j.set(m,P)}else P=j.get(m),P===void 0&&(P=new Set,j.set(m,P));P.has(T)||(P.add(T),f=AO.bind(null,f,m,T),m.then(f,f))}function kE(f){do{var m;if((m=f.tag===13)&&(m=f.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return f;f=f.return}while(f!==null);return null}function CE(f,m,T,j,P){return f.mode&1?(f.flags|=65536,f.lanes=P,f):(f===m?f.flags|=65536:(f.flags|=128,T.flags|=131072,T.flags&=-52805,T.tag===1&&(T.alternate===null?T.tag=17:(m=Oo(-1,1),m.tag=2,Fl(T,m,1))),T.lanes|=1),f)}var pO=o.ReactCurrentOwner,da=!1;function qs(f,m,T,j){m.child=f===null?H4(m,null,T,j):Cd(m,f.child,T,j)}function TE(f,m,T,j,P){T=T.render;var O=m.ref;return Ed(m,P),j=xw(f,m,T,j,O,P),T=yw(),f!==null&&!da?(m.updateQueue=f.updateQueue,m.flags&=-2053,f.lanes&=~P,Bo(f,m,P)):(en&&T&&ew(m),m.flags|=1,qs(f,m,j,P),m.child)}function EE(f,m,T,j,P){if(f===null){var O=T.type;return typeof O=="function"&&!qw(O)&&O.defaultProps===void 0&&T.compare===null&&T.defaultProps===void 0?(m.tag=15,m.type=O,NE(f,m,O,j,P)):(f=kp(T.type,null,j,m,m.mode,P),f.ref=m.ref,f.return=m,m.child=f)}if(O=f.child,!(f.lanes&P)){var le=O.memoizedProps;if(T=T.compare,T=T!==null?T:Vm,T(le,j)&&f.ref===m.ref)return Bo(f,m,P)}return m.flags|=1,f=Ll(O,j),f.ref=m.ref,f.return=m,m.child=f}function NE(f,m,T,j,P){if(f!==null){var O=f.memoizedProps;if(Vm(O,j)&&f.ref===m.ref)if(da=!1,m.pendingProps=j=O,(f.lanes&P)!==0)f.flags&131072&&(da=!0);else return m.lanes=f.lanes,Bo(f,m,P)}return Ew(f,m,T,j,P)}function AE(f,m,T){var j=m.pendingProps,P=j.children,O=f!==null?f.memoizedState:null;if(j.mode==="hidden")if(!(m.mode&1))m.memoizedState={baseLanes:0,cachePool:null,transitions:null},St(Pd,ja),ja|=T;else{if(!(T&1073741824))return f=O!==null?O.baseLanes|T:T,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:f,cachePool:null,transitions:null},m.updateQueue=null,St(Pd,ja),ja|=f,null;m.memoizedState={baseLanes:0,cachePool:null,transitions:null},j=O!==null?O.baseLanes:T,St(Pd,ja),ja|=j}else O!==null?(j=O.baseLanes|T,m.memoizedState=null):j=T,St(Pd,ja),ja|=j;return qs(f,m,P,T),m.child}function jE(f,m){var T=m.ref;(f===null&&T!==null||f!==null&&f.ref!==T)&&(m.flags|=512,m.flags|=2097152)}function Ew(f,m,T,j,P){var O=Br(T)?Qt:Xe.current;return O=ss(m,O),Ed(m,P),T=xw(f,m,T,j,O,P),j=yw(),f!==null&&!da?(m.updateQueue=f.updateQueue,m.flags&=-2053,f.lanes&=~P,Bo(f,m,P)):(en&&j&&ew(m),m.flags|=1,qs(f,m,T,P),m.child)}function FE(f,m,T,j,P){if(Br(T)){var O=!0;_d(m)}else O=!1;if(Ed(m,P),m.stateNode===null)ip(f,m),vE(m,T,j),kw(m,T,j,P),j=!0;else if(f===null){var le=m.stateNode,Pe=m.memoizedProps;le.props=Pe;var Ke=le.context,gt=T.contextType;typeof gt=="object"&&gt!==null?gt=Xa(gt):(gt=Br(T)?Qt:Xe.current,gt=ss(m,gt));var It=T.getDerivedStateFromProps,tr=typeof It=="function"||typeof le.getSnapshotBeforeUpdate=="function";tr||typeof le.UNSAFE_componentWillReceiveProps!="function"&&typeof le.componentWillReceiveProps!="function"||(Pe!==j||Ke!==gt)&&wE(m,le,j,gt),jl=!1;var At=m.memoizedState;le.state=At,Qm(m,j,le,P),Ke=m.memoizedState,Pe!==j||At!==Ke||Ut.current||jl?(typeof It=="function"&&(Sw(m,T,It,j),Ke=m.memoizedState),(Pe=jl||yE(m,T,Pe,j,At,Ke,gt))?(tr||typeof le.UNSAFE_componentWillMount!="function"&&typeof le.componentWillMount!="function"||(typeof le.componentWillMount=="function"&&le.componentWillMount(),typeof le.UNSAFE_componentWillMount=="function"&&le.UNSAFE_componentWillMount()),typeof le.componentDidMount=="function"&&(m.flags|=4194308)):(typeof le.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=j,m.memoizedState=Ke),le.props=j,le.state=Ke,le.context=gt,j=Pe):(typeof le.componentDidMount=="function"&&(m.flags|=4194308),j=!1)}else{le=m.stateNode,K4(f,m),Pe=m.memoizedProps,gt=m.type===m.elementType?Pe:Ei(m.type,Pe),le.props=gt,tr=m.pendingProps,At=le.context,Ke=T.contextType,typeof Ke=="object"&&Ke!==null?Ke=Xa(Ke):(Ke=Br(T)?Qt:Xe.current,Ke=ss(m,Ke));var Gr=T.getDerivedStateFromProps;(It=typeof Gr=="function"||typeof le.getSnapshotBeforeUpdate=="function")||typeof le.UNSAFE_componentWillReceiveProps!="function"&&typeof le.componentWillReceiveProps!="function"||(Pe!==tr||At!==Ke)&&wE(m,le,j,Ke),jl=!1,At=m.memoizedState,le.state=At,Qm(m,j,le,P);var Ur=m.memoizedState;Pe!==tr||At!==Ur||Ut.current||jl?(typeof Gr=="function"&&(Sw(m,T,Gr,j),Ur=m.memoizedState),(gt=jl||yE(m,T,gt,j,At,Ur,Ke)||!1)?(It||typeof le.UNSAFE_componentWillUpdate!="function"&&typeof le.componentWillUpdate!="function"||(typeof le.componentWillUpdate=="function"&&le.componentWillUpdate(j,Ur,Ke),typeof le.UNSAFE_componentWillUpdate=="function"&&le.UNSAFE_componentWillUpdate(j,Ur,Ke)),typeof le.componentDidUpdate=="function"&&(m.flags|=4),typeof le.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof le.componentDidUpdate!="function"||Pe===f.memoizedProps&&At===f.memoizedState||(m.flags|=4),typeof le.getSnapshotBeforeUpdate!="function"||Pe===f.memoizedProps&&At===f.memoizedState||(m.flags|=1024),m.memoizedProps=j,m.memoizedState=Ur),le.props=j,le.state=Ur,le.context=Ke,j=gt):(typeof le.componentDidUpdate!="function"||Pe===f.memoizedProps&&At===f.memoizedState||(m.flags|=4),typeof le.getSnapshotBeforeUpdate!="function"||Pe===f.memoizedProps&&At===f.memoizedState||(m.flags|=1024),j=!1)}return Nw(f,m,T,j,O,P)}function Nw(f,m,T,j,P,O){jE(f,m);var le=(m.flags&128)!==0;if(!j&&!le)return P&&Im(m,T,!1),Bo(f,m,O);j=m.stateNode,pO.current=m;var Pe=le&&typeof T.getDerivedStateFromError!="function"?null:j.render();return m.flags|=1,f!==null&&le?(m.child=Cd(m,f.child,null,O),m.child=Cd(m,null,Pe,O)):qs(f,m,Pe,O),m.memoizedState=j.state,P&&Im(m,T,!0),m.child}function PE(f){var m=f.stateNode;m.pendingContext?Al(f,m.pendingContext,m.pendingContext!==m.context):m.context&&Al(f,m.context,!1),dw(f,m.containerInfo)}function DE(f,m,T,j,P){return kd(),sw(P),m.flags|=256,qs(f,m,T,j),m.child}var Aw={dehydrated:null,treeContext:null,retryLane:0};function jw(f){return{baseLanes:f,cachePool:null,transitions:null}}function RE(f,m,T){var j=m.pendingProps,P=ln.current,O=!1,le=(m.flags&128)!==0,Pe;if((Pe=le)||(Pe=f!==null&&f.memoizedState===null?!1:(P&2)!==0),Pe?(O=!0,m.flags&=-129):(f===null||f.memoizedState!==null)&&(P|=1),St(ln,P&1),f===null)return nw(m),f=m.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?(m.mode&1?Nr(f)?m.lanes=8:m.lanes=1073741824:m.lanes=1,null):(le=j.children,f=j.fallback,O?(j=m.mode,O=m.child,le={mode:"hidden",children:le},!(j&1)&&O!==null?(O.childLanes=0,O.pendingProps=le):O=Cp(le,j,0,null),f=Qc(f,j,T,null),O.return=m,f.return=m,O.sibling=f,m.child=O,m.child.memoizedState=jw(T),m.memoizedState=Aw,f):Fw(m,le));if(P=f.memoizedState,P!==null&&(Pe=P.dehydrated,Pe!==null))return xO(f,m,le,j,Pe,P,T);if(O){O=j.fallback,le=m.mode,P=f.child,Pe=P.sibling;var Ke={mode:"hidden",children:j.children};return!(le&1)&&m.child!==P?(j=m.child,j.childLanes=0,j.pendingProps=Ke,m.deletions=null):(j=Ll(P,Ke),j.subtreeFlags=P.subtreeFlags&14680064),Pe!==null?O=Ll(Pe,O):(O=Qc(O,le,T,null),O.flags|=2),O.return=m,j.return=m,j.sibling=O,m.child=j,j=O,O=m.child,le=f.child.memoizedState,le=le===null?jw(T):{baseLanes:le.baseLanes|T,cachePool:null,transitions:le.transitions},O.memoizedState=le,O.childLanes=f.childLanes&~T,m.memoizedState=Aw,j}return O=f.child,f=O.sibling,j=Ll(O,{mode:"visible",children:j.children}),!(m.mode&1)&&(j.lanes=T),j.return=m,j.sibling=null,f!==null&&(T=m.deletions,T===null?(m.deletions=[f],m.flags|=16):T.push(f)),m.child=j,m.memoizedState=null,j}function Fw(f,m){return m=Cp({mode:"visible",children:m},f.mode,0,null),m.return=f,f.child=m}function ap(f,m,T,j){return j!==null&&sw(j),Cd(m,f.child,null,T),f=Fw(m,m.pendingProps.children),f.flags|=2,m.memoizedState=null,f}function xO(f,m,T,j,P,O,le){if(T)return m.flags&256?(m.flags&=-257,j=Cw(Error(i(422))),ap(f,m,le,j)):m.memoizedState!==null?(m.child=f.child,m.flags|=128,null):(O=j.fallback,P=m.mode,j=Cp({mode:"visible",children:j.children},P,0,null),O=Qc(O,P,le,null),O.flags|=2,j.return=m,O.return=m,j.sibling=O,m.child=j,m.mode&1&&Cd(m,f.child,null,le),m.child.memoizedState=jw(le),m.memoizedState=Aw,O);if(!(m.mode&1))return ap(f,m,le,null);if(Nr(P))return j=Ln(P).digest,O=Error(i(419)),j=Cw(O,j,void 0),ap(f,m,le,j);if(T=(le&f.childLanes)!==0,da||T){if(j=os,j!==null){switch(le&-le){case 4:P=2;break;case 16:P=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:P=32;break;case 536870912:P=268435456;break;default:P=0}P=P&(j.suspendedLanes|le)?0:P,P!==0&&P!==O.retryLane&&(O.retryLane=P,to(f,P),Qa(j,f,P,-1))}return Qw(),j=Cw(Error(i(421))),ap(f,m,le,j)}return hr(P)?(m.flags|=128,m.child=f.child,m=jO.bind(null,f),Y(P,m),null):(f=O.treeContext,Ne&&(Ka=ge(P),Aa=m,en=!0,Ti=null,Mh=!1,f!==null&&(Ga[Va++]=Lo,Ga[Va++]=Io,Ga[Va++]=zc,Lo=f.id,Io=f.overflow,zc=m)),m=Fw(m,j.children),m.flags|=4096,m)}function ME(f,m,T){f.lanes|=m;var j=f.alternate;j!==null&&(j.lanes|=m),lw(f.return,m,T)}function Pw(f,m,T,j,P){var O=f.memoizedState;O===null?f.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:j,tail:T,tailMode:P}:(O.isBackwards=m,O.rendering=null,O.renderingStartTime=0,O.last=j,O.tail=T,O.tailMode=P)}function LE(f,m,T){var j=m.pendingProps,P=j.revealOrder,O=j.tail;if(qs(f,m,j.children,T),j=ln.current,j&2)j=j&1|2,m.flags|=128;else{if(f!==null&&f.flags&128)e:for(f=m.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&ME(f,T,m);else if(f.tag===19)ME(f,T,m);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===m)break e;for(;f.sibling===null;){if(f.return===null||f.return===m)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}j&=1}if(St(ln,j),!(m.mode&1))m.memoizedState=null;else switch(P){case"forwards":for(T=m.child,P=null;T!==null;)f=T.alternate,f!==null&&qm(f)===null&&(P=T),T=T.sibling;T=P,T===null?(P=m.child,m.child=null):(P=T.sibling,T.sibling=null),Pw(m,!1,P,T,O);break;case"backwards":for(T=null,P=m.child,m.child=null;P!==null;){if(f=P.alternate,f!==null&&qm(f)===null){m.child=P;break}f=P.sibling,P.sibling=T,T=P,P=f}Pw(m,!0,T,null,O);break;case"together":Pw(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function ip(f,m){!(m.mode&1)&&f!==null&&(f.alternate=null,m.alternate=null,m.flags|=2)}function Bo(f,m,T){if(f!==null&&(m.dependencies=f.dependencies),Kc|=m.lanes,!(T&m.childLanes))return null;if(f!==null&&m.child!==f.child)throw Error(i(153));if(m.child!==null){for(f=m.child,T=Ll(f,f.pendingProps),m.child=T,T.return=m;f.sibling!==null;)f=f.sibling,T=T.sibling=Ll(f,f.pendingProps),T.return=m;T.sibling=null}return m.child}function yO(f,m,T){switch(m.tag){case 3:PE(m),kd();break;case 5:J4(m);break;case 1:Br(m.type)&&_d(m);break;case 4:dw(m,m.stateNode.containerInfo);break;case 10:G4(m,m.type._context,m.memoizedProps.value);break;case 13:var j=m.memoizedState;if(j!==null)return j.dehydrated!==null?(St(ln,ln.current&1),m.flags|=128,null):T&m.child.childLanes?RE(f,m,T):(St(ln,ln.current&1),f=Bo(f,m,T),f!==null?f.sibling:null);St(ln,ln.current&1);break;case 19:if(j=(T&m.childLanes)!==0,f.flags&128){if(j)return LE(f,m,T);m.flags|=128}var P=m.memoizedState;if(P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),St(ln,ln.current),j)break;return null;case 22:case 23:return m.lanes=0,AE(f,m,T)}return Bo(f,m,T)}function so(f){f.flags|=4}function IE(f,m){if(f!==null&&f.child===m.child)return!0;if(m.flags&16)return!1;for(f=m.child;f!==null;){if(f.flags&12854||f.subtreeFlags&12854)return!1;f=f.sibling}return!0}var zh,Hh,op,lp;if(Le)zh=function(f,m){for(var T=m.child;T!==null;){if(T.tag===5||T.tag===6)G(f,T.stateNode);else if(T.tag!==4&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===m)break;for(;T.sibling===null;){if(T.return===null||T.return===m)return;T=T.return}T.sibling.return=T.return,T=T.sibling}},Hh=function(){},op=function(f,m,T,j,P){if(f=f.memoizedProps,f!==j){var O=m.stateNode,le=ro(Ya.current);T=Q(O,T,f,j,P,le),(m.updateQueue=T)&&so(m)}},lp=function(f,m,T,j){T!==j&&so(m)};else if(te){zh=function(f,m,T,j){for(var P=m.child;P!==null;){if(P.tag===5){var O=P.stateNode;T&&j&&(O=Ft(O,P.type,P.memoizedProps,P)),G(f,O)}else if(P.tag===6)O=P.stateNode,T&&j&&(O=Ot(O,P.memoizedProps,P)),G(f,O);else if(P.tag!==4){if(P.tag===22&&P.memoizedState!==null)O=P.child,O!==null&&(O.return=P),zh(f,P,!0,!0);else if(P.child!==null){P.child.return=P,P=P.child;continue}}if(P===m)break;for(;P.sibling===null;){if(P.return===null||P.return===m)return;P=P.return}P.sibling.return=P.return,P=P.sibling}};var OE=function(f,m,T,j){for(var P=m.child;P!==null;){if(P.tag===5){var O=P.stateNode;T&&j&&(O=Ft(O,P.type,P.memoizedProps,P)),Nt(f,O)}else if(P.tag===6)O=P.stateNode,T&&j&&(O=Ot(O,P.memoizedProps,P)),Nt(f,O);else if(P.tag!==4){if(P.tag===22&&P.memoizedState!==null)O=P.child,O!==null&&(O.return=P),OE(f,P,!0,!0);else if(P.child!==null){P.child.return=P,P=P.child;continue}}if(P===m)break;for(;P.sibling===null;){if(P.return===null||P.return===m)return;P=P.return}P.sibling.return=P.return,P=P.sibling}};Hh=function(f,m){var T=m.stateNode;if(!IE(f,m)){f=T.containerInfo;var j=Ve(f);OE(j,m,!1,!1),T.pendingChildren=j,so(m),yt(f,j)}},op=function(f,m,T,j,P){var O=f.stateNode,le=f.memoizedProps;if((f=IE(f,m))&&le===j)m.stateNode=O;else{var Pe=m.stateNode,Ke=ro(Ya.current),gt=null;le!==j&&(gt=Q(Pe,T,le,j,P,Ke)),f&&gt===null?m.stateNode=O:(O=be(O,gt,T,le,j,m,f,Pe),K(O,T,j,P,Ke)&&so(m),m.stateNode=O,f?so(m):zh(O,m,!1,!1))}},lp=function(f,m,T,j){T!==j?(f=ro(Nd.current),T=ro(Ya.current),m.stateNode=se(j,f,T,m),so(m)):m.stateNode=f.stateNode}}else Hh=function(){},op=function(){},lp=function(){};function Gh(f,m){if(!en)switch(f.tailMode){case"hidden":m=f.tail;for(var T=null;m!==null;)m.alternate!==null&&(T=m),m=m.sibling;T===null?f.tail=null:T.sibling=null;break;case"collapsed":T=f.tail;for(var j=null;T!==null;)T.alternate!==null&&(j=T),T=T.sibling;j===null?m||f.tail===null?f.tail=null:f.tail.sibling=null:j.sibling=null}}function js(f){var m=f.alternate!==null&&f.alternate.child===f.child,T=0,j=0;if(m)for(var P=f.child;P!==null;)T|=P.lanes|P.childLanes,j|=P.subtreeFlags&14680064,j|=P.flags&14680064,P.return=f,P=P.sibling;else for(P=f.child;P!==null;)T|=P.lanes|P.childLanes,j|=P.subtreeFlags,j|=P.flags,P.return=f,P=P.sibling;return f.subtreeFlags|=j,f.childLanes=T,m}function vO(f,m,T){var j=m.pendingProps;switch(tw(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return js(m),null;case 1:return Br(m.type)&&Vn(),js(m),null;case 3:return T=m.stateNode,Ad(),Et(Ut),Et(Xe),gw(),T.pendingContext&&(T.context=T.pendingContext,T.pendingContext=null),(f===null||f.child===null)&&(Gm(m)?so(m):f===null||f.memoizedState.isDehydrated&&!(m.flags&256)||(m.flags|=1024,Ti!==null&&(Yw(Ti),Ti=null))),Hh(f,m),js(m),null;case 5:fw(m),T=ro(Nd.current);var P=m.type;if(f!==null&&m.stateNode!=null)op(f,m,P,j,T),f.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!j){if(m.stateNode===null)throw Error(i(166));return js(m),null}if(f=ro(Ya.current),Gm(m)){if(!Ne)throw Error(i(175));f=V(m.stateNode,m.type,m.memoizedProps,T,f,m,!Mh),m.updateQueue=f,f!==null&&so(m)}else{var O=de(P,j,T,f,m);zh(O,m,!1,!1),m.stateNode=O,K(O,P,j,T,f)&&so(m)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return js(m),null;case 6:if(f&&m.stateNode!=null)lp(f,m,f.memoizedProps,j);else{if(typeof j!="string"&&m.stateNode===null)throw Error(i(166));if(f=ro(Nd.current),T=ro(Ya.current),Gm(m)){if(!Ne)throw Error(i(176));if(f=m.stateNode,T=m.memoizedProps,(j=ie(f,T,m,!Mh))&&(P=Aa,P!==null))switch(P.tag){case 3:Ee(P.stateNode.containerInfo,f,T,(P.mode&1)!==0);break;case 5:Ue(P.type,P.memoizedProps,P.stateNode,f,T,(P.mode&1)!==0)}j&&so(m)}else m.stateNode=se(j,f,T,m)}return js(m),null;case 13:if(Et(ln),j=m.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(en&&Ka!==null&&m.mode&1&&!(m.flags&128))$4(),kd(),m.flags|=98560,P=!1;else if(P=Gm(m),j!==null&&j.dehydrated!==null){if(f===null){if(!P)throw Error(i(318));if(!Ne)throw Error(i(344));if(P=m.memoizedState,P=P!==null?P.dehydrated:null,!P)throw Error(i(317));we(P,m)}else kd(),!(m.flags&128)&&(m.memoizedState=null),m.flags|=4;js(m),P=!1}else Ti!==null&&(Yw(Ti),Ti=null),P=!0;if(!P)return m.flags&65536?m:null}return m.flags&128?(m.lanes=T,m):(T=j!==null,T!==(f!==null&&f.memoizedState!==null)&&T&&(m.child.flags|=8192,m.mode&1&&(f===null||ln.current&1?Xn===0&&(Xn=3):Qw())),m.updateQueue!==null&&(m.flags|=4),js(m),null);case 4:return Ad(),Hh(f,m),f===null&&We(m.stateNode.containerInfo),js(m),null;case 10:return ow(m.type._context),js(m),null;case 17:return Br(m.type)&&Vn(),js(m),null;case 19:if(Et(ln),P=m.memoizedState,P===null)return js(m),null;if(j=(m.flags&128)!==0,O=P.rendering,O===null)if(j)Gh(P,!1);else{if(Xn!==0||f!==null&&f.flags&128)for(f=m.child;f!==null;){if(O=qm(f),O!==null){for(m.flags|=128,Gh(P,!1),f=O.updateQueue,f!==null&&(m.updateQueue=f,m.flags|=4),m.subtreeFlags=0,f=T,T=m.child;T!==null;)j=T,P=f,j.flags&=14680066,O=j.alternate,O===null?(j.childLanes=0,j.lanes=P,j.child=null,j.subtreeFlags=0,j.memoizedProps=null,j.memoizedState=null,j.updateQueue=null,j.dependencies=null,j.stateNode=null):(j.childLanes=O.childLanes,j.lanes=O.lanes,j.child=O.child,j.subtreeFlags=0,j.deletions=null,j.memoizedProps=O.memoizedProps,j.memoizedState=O.memoizedState,j.updateQueue=O.updateQueue,j.type=O.type,P=O.dependencies,j.dependencies=P===null?null:{lanes:P.lanes,firstContext:P.firstContext}),T=T.sibling;return St(ln,ln.current&1|2),m.child}f=f.sibling}P.tail!==null&&as()>Gw&&(m.flags|=128,j=!0,Gh(P,!1),m.lanes=4194304)}else{if(!j)if(f=qm(O),f!==null){if(m.flags|=128,j=!0,f=f.updateQueue,f!==null&&(m.updateQueue=f,m.flags|=4),Gh(P,!0),P.tail===null&&P.tailMode==="hidden"&&!O.alternate&&!en)return js(m),null}else 2*as()-P.renderingStartTime>Gw&&T!==1073741824&&(m.flags|=128,j=!0,Gh(P,!1),m.lanes=4194304);P.isBackwards?(O.sibling=m.child,m.child=O):(f=P.last,f!==null?f.sibling=O:m.child=O,P.last=O)}return P.tail!==null?(m=P.tail,P.rendering=m,P.tail=m.sibling,P.renderingStartTime=as(),m.sibling=null,f=ln.current,St(ln,j?f&1|2:f&1),m):(js(m),null);case 22:case 23:return Jw(),T=m.memoizedState!==null,f!==null&&f.memoizedState!==null!==T&&(m.flags|=8192),T&&m.mode&1?ja&1073741824&&(js(m),Le&&m.subtreeFlags&6&&(m.flags|=8192)):js(m),null;case 24:return null;case 25:return null}throw Error(i(156,m.tag))}function wO(f,m){switch(tw(m),m.tag){case 1:return Br(m.type)&&Vn(),f=m.flags,f&65536?(m.flags=f&-65537|128,m):null;case 3:return Ad(),Et(Ut),Et(Xe),gw(),f=m.flags,f&65536&&!(f&128)?(m.flags=f&-65537|128,m):null;case 5:return fw(m),null;case 13:if(Et(ln),f=m.memoizedState,f!==null&&f.dehydrated!==null){if(m.alternate===null)throw Error(i(340));kd()}return f=m.flags,f&65536?(m.flags=f&-65537|128,m):null;case 19:return Et(ln),null;case 4:return Ad(),null;case 10:return ow(m.type._context),null;case 22:case 23:return Jw(),null;case 24:return null;default:return null}}var cp=!1,Fs=!1,_O=typeof WeakSet=="function"?WeakSet:Set,Mt=null;function Fd(f,m){var T=f.ref;if(T!==null)if(typeof T=="function")try{T(null)}catch(j){tn(f,m,j)}else T.current=null}function Dw(f,m,T){try{T()}catch(j){tn(f,m,j)}}var BE=!1;function bO(f,m){for(L(f.containerInfo),Mt=m;Mt!==null;)if(f=Mt,m=f.child,(f.subtreeFlags&1028)!==0&&m!==null)m.return=f,Mt=m;else for(;Mt!==null;){f=Mt;try{var T=f.alternate;if(f.flags&1024)switch(f.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var j=T.memoizedProps,P=T.memoizedState,O=f.stateNode,le=O.getSnapshotBeforeUpdate(f.elementType===f.type?j:Ei(f.type,j),P);O.__reactInternalSnapshotBeforeUpdate=le}break;case 3:Le&&ye(f.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(Pe){tn(f,f.return,Pe)}if(m=f.sibling,m!==null){m.return=f.return,Mt=m;break}Mt=f.return}return T=BE,BE=!1,T}function Vh(f,m,T){var j=m.updateQueue;if(j=j!==null?j.lastEffect:null,j!==null){var P=j=j.next;do{if((P.tag&f)===f){var O=P.destroy;P.destroy=void 0,O!==void 0&&Dw(m,T,O)}P=P.next}while(P!==j)}}function up(f,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var T=m=m.next;do{if((T.tag&f)===f){var j=T.create;T.destroy=j()}T=T.next}while(T!==m)}}function Rw(f){var m=f.ref;if(m!==null){var T=f.stateNode;switch(f.tag){case 5:f=z(T);break;default:f=T}typeof m=="function"?m(f):m.current=f}}function UE(f){var m=f.alternate;m!==null&&(f.alternate=null,UE(m)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(m=f.stateNode,m!==null&&$e(m)),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function $E(f){return f.tag===5||f.tag===3||f.tag===4}function WE(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||$E(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function Mw(f,m,T){var j=f.tag;if(j===5||j===6)f=f.stateNode,m?Fe(T,f,m):Dt(T,f);else if(j!==4&&(f=f.child,f!==null))for(Mw(f,m,T),f=f.sibling;f!==null;)Mw(f,m,T),f=f.sibling}function Lw(f,m,T){var j=f.tag;if(j===5||j===6)f=f.stateNode,m?jt(T,f,m):bt(T,f);else if(j!==4&&(f=f.child,f!==null))for(Lw(f,m,T),f=f.sibling;f!==null;)Lw(f,m,T),f=f.sibling}var ps=null,Ni=!1;function ao(f,m,T){for(T=T.child;T!==null;)Iw(f,m,T),T=T.sibling}function Iw(f,m,T){if(Zi&&typeof Zi.onCommitFiberUnmount=="function")try{Zi.onCommitFiberUnmount($m,T)}catch{}switch(T.tag){case 5:Fs||Fd(T,m);case 6:if(Le){var j=ps,P=Ni;ps=null,ao(f,m,T),ps=j,Ni=P,ps!==null&&(Ni?Ze(ps,T.stateNode):et(ps,T.stateNode))}else ao(f,m,T);break;case 18:Le&&ps!==null&&(Ni?pe(ps,T.stateNode):Z(ps,T.stateNode));break;case 4:Le?(j=ps,P=Ni,ps=T.stateNode.containerInfo,Ni=!0,ao(f,m,T),ps=j,Ni=P):(te&&(j=T.stateNode.containerInfo,P=Ve(j),$t(j,P)),ao(f,m,T));break;case 0:case 11:case 14:case 15:if(!Fs&&(j=T.updateQueue,j!==null&&(j=j.lastEffect,j!==null))){P=j=j.next;do{var O=P,le=O.destroy;O=O.tag,le!==void 0&&(O&2||O&4)&&Dw(T,m,le),P=P.next}while(P!==j)}ao(f,m,T);break;case 1:if(!Fs&&(Fd(T,m),j=T.stateNode,typeof j.componentWillUnmount=="function"))try{j.props=T.memoizedProps,j.state=T.memoizedState,j.componentWillUnmount()}catch(Pe){tn(T,m,Pe)}ao(f,m,T);break;case 21:ao(f,m,T);break;case 22:T.mode&1?(Fs=(j=Fs)||T.memoizedState!==null,ao(f,m,T),Fs=j):ao(f,m,T);break;default:ao(f,m,T)}}function zE(f){var m=f.updateQueue;if(m!==null){f.updateQueue=null;var T=f.stateNode;T===null&&(T=f.stateNode=new _O),m.forEach(function(j){var P=FO.bind(null,f,j);T.has(j)||(T.add(j),j.then(P,P))})}}function Ai(f,m){var T=m.deletions;if(T!==null)for(var j=0;j<T.length;j++){var P=T[j];try{var O=f,le=m;if(Le){var Pe=le;e:for(;Pe!==null;){switch(Pe.tag){case 5:ps=Pe.stateNode,Ni=!1;break e;case 3:ps=Pe.stateNode.containerInfo,Ni=!0;break e;case 4:ps=Pe.stateNode.containerInfo,Ni=!0;break e}Pe=Pe.return}if(ps===null)throw Error(i(160));Iw(O,le,P),ps=null,Ni=!1}else Iw(O,le,P);var Ke=P.alternate;Ke!==null&&(Ke.return=null),P.return=null}catch(gt){tn(P,m,gt)}}if(m.subtreeFlags&12854)for(m=m.child;m!==null;)HE(m,f),m=m.sibling}function HE(f,m){var T=f.alternate,j=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(Ai(m,f),io(f),j&4){try{Vh(3,f,f.return),up(3,f)}catch(At){tn(f,f.return,At)}try{Vh(5,f,f.return)}catch(At){tn(f,f.return,At)}}break;case 1:Ai(m,f),io(f),j&512&&T!==null&&Fd(T,T.return);break;case 5:if(Ai(m,f),io(f),j&512&&T!==null&&Fd(T,T.return),Le){if(f.flags&32){var P=f.stateNode;try{rt(P)}catch(At){tn(f,f.return,At)}}if(j&4&&(P=f.stateNode,P!=null)){var O=f.memoizedProps;if(T=T!==null?T.memoizedProps:O,j=f.type,m=f.updateQueue,f.updateQueue=null,m!==null)try{Ct(P,m,j,T,O,f)}catch(At){tn(f,f.return,At)}}}break;case 6:if(Ai(m,f),io(f),j&4&&Le){if(f.stateNode===null)throw Error(i(162));P=f.stateNode,O=f.memoizedProps,T=T!==null?T.memoizedProps:O;try{it(P,T,O)}catch(At){tn(f,f.return,At)}}break;case 3:if(Ai(m,f),io(f),j&4){if(Le&&Ne&&T!==null&&T.memoizedState.isDehydrated)try{Te(m.containerInfo)}catch(At){tn(f,f.return,At)}if(te){P=m.containerInfo,O=m.pendingChildren;try{$t(P,O)}catch(At){tn(f,f.return,At)}}}break;case 4:if(Ai(m,f),io(f),j&4&&te){O=f.stateNode,P=O.containerInfo,O=O.pendingChildren;try{$t(P,O)}catch(At){tn(f,f.return,At)}}break;case 13:Ai(m,f),io(f),P=f.child,P.flags&8192&&(O=P.memoizedState!==null,P.stateNode.isHidden=O,!O||P.alternate!==null&&P.alternate.memoizedState!==null||(Hw=as())),j&4&&zE(f);break;case 22:var le=T!==null&&T.memoizedState!==null;if(f.mode&1?(Fs=(T=Fs)||le,Ai(m,f),Fs=T):Ai(m,f),io(f),j&8192){if(T=f.memoizedState!==null,(f.stateNode.isHidden=T)&&!le&&f.mode&1)for(Mt=f,j=f.child;j!==null;){for(m=Mt=j;Mt!==null;){le=Mt;var Pe=le.child;switch(le.tag){case 0:case 11:case 14:case 15:Vh(4,le,le.return);break;case 1:Fd(le,le.return);var Ke=le.stateNode;if(typeof Ke.componentWillUnmount=="function"){var gt=le,It=le.return;try{var tr=gt;Ke.props=tr.memoizedProps,Ke.state=tr.memoizedState,Ke.componentWillUnmount()}catch(At){tn(gt,It,At)}}break;case 5:Fd(le,le.return);break;case 22:if(le.memoizedState!==null){KE(m);continue}}Pe!==null?(Pe.return=le,Mt=Pe):KE(m)}j=j.sibling}if(Le){e:if(j=null,Le)for(m=f;;){if(m.tag===5){if(j===null){j=m;try{P=m.stateNode,T?dt(P):xe(m.stateNode,m.memoizedProps)}catch(At){tn(f,f.return,At)}}}else if(m.tag===6){if(j===null)try{O=m.stateNode,T?Tt(O):ue(O,m.memoizedProps)}catch(At){tn(f,f.return,At)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===f)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===f)break e;for(;m.sibling===null;){if(m.return===null||m.return===f)break e;j===m&&(j=null),m=m.return}j===m&&(j=null),m.sibling.return=m.return,m=m.sibling}}}break;case 19:Ai(m,f),io(f),j&4&&zE(f);break;case 21:break;default:Ai(m,f),io(f)}}function io(f){var m=f.flags;if(m&2){try{if(Le){e:{for(var T=f.return;T!==null;){if($E(T)){var j=T;break e}T=T.return}throw Error(i(160))}switch(j.tag){case 5:var P=j.stateNode;j.flags&32&&(rt(P),j.flags&=-33);var O=WE(f);Lw(f,O,P);break;case 3:case 4:var le=j.stateNode.containerInfo,Pe=WE(f);Mw(f,Pe,le);break;default:throw Error(i(161))}}}catch(Ke){tn(f,f.return,Ke)}f.flags&=-3}m&4096&&(f.flags&=-4097)}function SO(f,m,T){Mt=f,GE(f)}function GE(f,m,T){for(var j=(f.mode&1)!==0;Mt!==null;){var P=Mt,O=P.child;if(P.tag===22&&j){var le=P.memoizedState!==null||cp;if(!le){var Pe=P.alternate,Ke=Pe!==null&&Pe.memoizedState!==null||Fs;Pe=cp;var gt=Fs;if(cp=le,(Fs=Ke)&&!gt)for(Mt=P;Mt!==null;)le=Mt,Ke=le.child,le.tag===22&&le.memoizedState!==null?XE(P):Ke!==null?(Ke.return=le,Mt=Ke):XE(P);for(;O!==null;)Mt=O,GE(O),O=O.sibling;Mt=P,cp=Pe,Fs=gt}VE(f)}else P.subtreeFlags&8772&&O!==null?(O.return=P,Mt=O):VE(f)}}function VE(f){for(;Mt!==null;){var m=Mt;if(m.flags&8772){var T=m.alternate;try{if(m.flags&8772)switch(m.tag){case 0:case 11:case 15:Fs||up(5,m);break;case 1:var j=m.stateNode;if(m.flags&4&&!Fs)if(T===null)j.componentDidMount();else{var P=m.elementType===m.type?T.memoizedProps:Ei(m.type,T.memoizedProps);j.componentDidUpdate(P,T.memoizedState,j.__reactInternalSnapshotBeforeUpdate)}var O=m.updateQueue;O!==null&&Y4(m,O,j);break;case 3:var le=m.updateQueue;if(le!==null){if(T=null,m.child!==null)switch(m.child.tag){case 5:T=z(m.child.stateNode);break;case 1:T=m.child.stateNode}Y4(m,le,T)}break;case 5:var Pe=m.stateNode;T===null&&m.flags&4&&ht(Pe,m.type,m.memoizedProps,m);break;case 6:break;case 4:break;case 12:break;case 13:if(Ne&&m.memoizedState===null){var Ke=m.alternate;if(Ke!==null){var gt=Ke.memoizedState;if(gt!==null){var It=gt.dehydrated;It!==null&&I(It)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}Fs||m.flags&512&&Rw(m)}catch(tr){tn(m,m.return,tr)}}if(m===f){Mt=null;break}if(T=m.sibling,T!==null){T.return=m.return,Mt=T;break}Mt=m.return}}function KE(f){for(;Mt!==null;){var m=Mt;if(m===f){Mt=null;break}var T=m.sibling;if(T!==null){T.return=m.return,Mt=T;break}Mt=m.return}}function XE(f){for(;Mt!==null;){var m=Mt;try{switch(m.tag){case 0:case 11:case 15:var T=m.return;try{up(4,m)}catch(Ke){tn(m,T,Ke)}break;case 1:var j=m.stateNode;if(typeof j.componentDidMount=="function"){var P=m.return;try{j.componentDidMount()}catch(Ke){tn(m,P,Ke)}}var O=m.return;try{Rw(m)}catch(Ke){tn(m,O,Ke)}break;case 5:var le=m.return;try{Rw(m)}catch(Ke){tn(m,le,Ke)}}}catch(Ke){tn(m,m.return,Ke)}if(m===f){Mt=null;break}var Pe=m.sibling;if(Pe!==null){Pe.return=m.return,Mt=Pe;break}Mt=m.return}}var dp=0,fp=1,hp=2,gp=3,mp=4;if(typeof Symbol=="function"&&Symbol.for){var Kh=Symbol.for;dp=Kh("selector.component"),fp=Kh("selector.has_pseudo_class"),hp=Kh("selector.role"),gp=Kh("selector.test_id"),mp=Kh("selector.text")}function Ow(f){var m=Ce(f);if(m!=null){if(typeof m.memoizedProps["data-testname"]!="string")throw Error(i(364));return m}if(f=Ae(f),f===null)throw Error(i(362));return f.stateNode.current}function Bw(f,m){switch(m.$$typeof){case dp:if(f.type===m.value)return!0;break;case fp:e:{m=m.value,f=[f,0];for(var T=0;T<f.length;){var j=f[T++],P=f[T++],O=m[P];if(j.tag!==5||!Ge(j)){for(;O!=null&&Bw(j,O);)P++,O=m[P];if(P===m.length){m=!0;break e}else for(j=j.child;j!==null;)f.push(j,P),j=j.sibling}}m=!1}return m;case hp:if(f.tag===5&&tt(f.stateNode,m.value))return!0;break;case mp:if((f.tag===5||f.tag===6)&&(f=Ie(f),f!==null&&0<=f.indexOf(m.value)))return!0;break;case gp:if(f.tag===5&&(f=f.memoizedProps["data-testname"],typeof f=="string"&&f.toLowerCase()===m.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function Uw(f){switch(f.$$typeof){case dp:return"<"+(A(f.value)||"Unknown")+">";case fp:return":has("+(Uw(f)||"")+")";case hp:return'[role="'+f.value+'"]';case mp:return'"'+f.value+'"';case gp:return'[data-testname="'+f.value+'"]';default:throw Error(i(365))}}function YE(f,m){var T=[];f=[f,0];for(var j=0;j<f.length;){var P=f[j++],O=f[j++],le=m[O];if(P.tag!==5||!Ge(P)){for(;le!=null&&Bw(P,le);)O++,le=m[O];if(O===m.length)T.push(P);else for(P=P.child;P!==null;)f.push(P,O),P=P.sibling}}return T}function $w(f,m){if(!Se)throw Error(i(363));f=Ow(f),f=YE(f,m),m=[],f=Array.from(f);for(var T=0;T<f.length;){var j=f[T++];if(j.tag===5)Ge(j)||m.push(j.stateNode);else for(j=j.child;j!==null;)f.push(j),j=j.sibling}return m}var kO=Math.ceil,pp=o.ReactCurrentDispatcher,Ww=o.ReactCurrentOwner,Nn=o.ReactCurrentBatchConfig,cr=0,os=null,In=null,xs=0,ja=0,Pd=Bt(0),Xn=0,Xh=null,Kc=0,xp=0,zw=0,Yh=null,fa=null,Hw=0,Gw=1/0,Uo=null;function Dd(){Gw=as()+500}var yp=!1,Vw=null,Pl=null,vp=!1,Dl=null,wp=0,Jh=0,Kw=null,_p=-1,bp=0;function Ps(){return cr&6?as():_p!==-1?_p:_p=as()}function Rl(f){return f.mode&1?cr&2&&xs!==0?xs&-xs:iO.transition!==null?(bp===0&&(bp=D4()),bp):(f=br,f!==0?f:nt()):1}function Qa(f,m,T,j){if(50<Jh)throw Jh=0,Kw=null,Error(i(185));Rh(f,T,j),(!(cr&2)||f!==os)&&(f===os&&(!(cr&2)&&(xp|=T),Xn===4&&Ml(f,xs)),ha(f,j),T===1&&cr===0&&!(m.mode&1)&&(Dd(),Wm&&eo()))}function ha(f,m){var T=f.callbackNode;QI(f,m);var j=Um(f,f===os?xs:0);if(j===0)T!==null&&M4(T),f.callbackNode=null,f.callbackPriority=0;else if(m=j&-j,f.callbackPriority!==m){if(T!=null&&M4(T),m===1)f.tag===0?aO(QE.bind(null,f)):L4(QE.bind(null,f)),De?at(function(){!(cr&6)&&eo()}):Jv(Qv,eo),T=null;else{switch(R4(j)){case 1:T=Qv;break;case 4:T=tO;break;case 16:T=qv;break;case 536870912:T=rO;break;default:T=qv}T=i3(T,JE.bind(null,f))}f.callbackPriority=m,f.callbackNode=T}}function JE(f,m){if(_p=-1,bp=0,cr&6)throw Error(i(327));var T=f.callbackNode;if(Jc()&&f.callbackNode!==T)return null;var j=Um(f,f===os?xs:0);if(j===0)return null;if(j&30||j&f.expiredLanes||m)m=Sp(f,j);else{m=j;var P=cr;cr|=2;var O=e3();(os!==f||xs!==m)&&(Uo=null,Dd(),Xc(f,m));do try{EO();break}catch(Pe){ZE(f,Pe)}while(!0);iw(),pp.current=O,cr=P,In!==null?m=0:(os=null,xs=0,m=Xn)}if(m!==0){if(m===2&&(P=Kv(f),P!==0&&(j=P,m=Xw(f,P))),m===1)throw T=Xh,Xc(f,0),Ml(f,j),ha(f,as()),T;if(m===6)Ml(f,j);else{if(P=f.current.alternate,!(j&30)&&!CO(P)&&(m=Sp(f,j),m===2&&(O=Kv(f),O!==0&&(j=O,m=Xw(f,O))),m===1))throw T=Xh,Xc(f,0),Ml(f,j),ha(f,as()),T;switch(f.finishedWork=P,f.finishedLanes=j,m){case 0:case 1:throw Error(i(345));case 2:Yc(f,fa,Uo);break;case 3:if(Ml(f,j),(j&130023424)===j&&(m=Hw+500-as(),10<m)){if(Um(f,0)!==0)break;if(P=f.suspendedLanes,(P&j)!==j){Ps(),f.pingedLanes|=f.suspendedLanes&P;break}f.timeoutHandle=W(Yc.bind(null,f,fa,Uo),m);break}Yc(f,fa,Uo);break;case 4:if(Ml(f,j),(j&4194240)===j)break;for(m=f.eventTimes,P=-1;0<j;){var le=31-ki(j);O=1<<le,le=m[le],le>P&&(P=le),j&=~O}if(j=P,j=as()-j,j=(120>j?120:480>j?480:1080>j?1080:1920>j?1920:3e3>j?3e3:4320>j?4320:1960*kO(j/1960))-j,10<j){f.timeoutHandle=W(Yc.bind(null,f,fa,Uo),j);break}Yc(f,fa,Uo);break;case 5:Yc(f,fa,Uo);break;default:throw Error(i(329))}}}return ha(f,as()),f.callbackNode===T?JE.bind(null,f):null}function Xw(f,m){var T=Yh;return f.current.memoizedState.isDehydrated&&(Xc(f,m).flags|=256),f=Sp(f,m),f!==2&&(m=fa,fa=T,m!==null&&Yw(m)),f}function Yw(f){fa===null?fa=f:fa.push.apply(fa,f)}function CO(f){for(var m=f;;){if(m.flags&16384){var T=m.updateQueue;if(T!==null&&(T=T.stores,T!==null))for(var j=0;j<T.length;j++){var P=T[j],O=P.getSnapshot;P=P.value;try{if(!Ci(O(),P))return!1}catch{return!1}}}if(T=m.child,m.subtreeFlags&16384&&T!==null)T.return=m,m=T;else{if(m===f)break;for(;m.sibling===null;){if(m.return===null||m.return===f)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function Ml(f,m){for(m&=~zw,m&=~xp,f.suspendedLanes|=m,f.pingedLanes&=~m,f=f.expirationTimes;0<m;){var T=31-ki(m),j=1<<T;f[T]=-1,m&=~j}}function QE(f){if(cr&6)throw Error(i(327));Jc();var m=Um(f,0);if(!(m&1))return ha(f,as()),null;var T=Sp(f,m);if(f.tag!==0&&T===2){var j=Kv(f);j!==0&&(m=j,T=Xw(f,j))}if(T===1)throw T=Xh,Xc(f,0),Ml(f,m),ha(f,as()),T;if(T===6)throw Error(i(345));return f.finishedWork=f.current.alternate,f.finishedLanes=m,Yc(f,fa,Uo),ha(f,as()),null}function qE(f){Dl!==null&&Dl.tag===0&&!(cr&6)&&Jc();var m=cr;cr|=1;var T=Nn.transition,j=br;try{if(Nn.transition=null,br=1,f)return f()}finally{br=j,Nn.transition=T,cr=m,!(cr&6)&&eo()}}function Jw(){ja=Pd.current,Et(Pd)}function Xc(f,m){f.finishedWork=null,f.finishedLanes=0;var T=f.timeoutHandle;if(T!==ve&&(f.timeoutHandle=ve,ee(T)),In!==null)for(T=In.return;T!==null;){var j=T;switch(tw(j),j.tag){case 1:j=j.type.childContextTypes,j!=null&&Vn();break;case 3:Ad(),Et(Ut),Et(Xe),gw();break;case 5:fw(j);break;case 4:Ad();break;case 13:Et(ln);break;case 19:Et(ln);break;case 10:ow(j.type._context);break;case 22:case 23:Jw()}T=T.return}if(os=f,In=f=Ll(f.current,null),xs=ja=m,Xn=0,Xh=null,zw=xp=Kc=0,fa=Yh=null,Gc!==null){for(m=0;m<Gc.length;m++)if(T=Gc[m],j=T.interleaved,j!==null){T.interleaved=null;var P=j.next,O=T.pending;if(O!==null){var le=O.next;O.next=P,j.next=le}T.pending=j}Gc=null}return f}function ZE(f,m){do{var T=In;try{if(iw(),Zm.current=np,ep){for(var j=cn.memoizedState;j!==null;){var P=j.queue;P!==null&&(P.pending=null),j=j.next}ep=!1}if(Vc=0,is=Kn=cn=null,Bh=!1,Uh=0,Ww.current=null,T===null||T.return===null){Xn=1,Xh=m,In=null;break}e:{var O=f,le=T.return,Pe=T,Ke=m;if(m=xs,Pe.flags|=32768,Ke!==null&&typeof Ke=="object"&&typeof Ke.then=="function"){var gt=Ke,It=Pe,tr=It.tag;if(!(It.mode&1)&&(tr===0||tr===11||tr===15)){var At=It.alternate;At?(It.updateQueue=At.updateQueue,It.memoizedState=At.memoizedState,It.lanes=At.lanes):(It.updateQueue=null,It.memoizedState=null)}var Gr=kE(le);if(Gr!==null){Gr.flags&=-257,CE(Gr,le,Pe,O,m),Gr.mode&1&&SE(O,gt,m),m=Gr,Ke=gt;var Ur=m.updateQueue;if(Ur===null){var ga=new Set;ga.add(Ke),m.updateQueue=ga}else Ur.add(Ke);break e}else{if(!(m&1)){SE(O,gt,m),Qw();break e}Ke=Error(i(426))}}else if(en&&Pe.mode&1){var $o=kE(le);if($o!==null){!($o.flags&65536)&&($o.flags|=256),CE($o,le,Pe,O,m),sw(jd(Ke,Pe));break e}}O=Ke=jd(Ke,Pe),Xn!==4&&(Xn=2),Yh===null?Yh=[O]:Yh.push(O),O=le;do{switch(O.tag){case 3:O.flags|=65536,m&=-m,O.lanes|=m;var ze=_E(O,Ke,m);X4(O,ze);break e;case 1:Pe=Ke;var Re=O.type,Je=O.stateNode;if(!(O.flags&128)&&(typeof Re.getDerivedStateFromError=="function"||Je!==null&&typeof Je.componentDidCatch=="function"&&(Pl===null||!Pl.has(Je)))){O.flags|=65536,m&=-m,O.lanes|=m;var Pt=bE(O,Pe,m);X4(O,Pt);break e}}O=O.return}while(O!==null)}r3(T)}catch(Ht){m=Ht,In===T&&T!==null&&(In=T=T.return);continue}break}while(!0)}function e3(){var f=pp.current;return pp.current=np,f===null?np:f}function Qw(){(Xn===0||Xn===3||Xn===2)&&(Xn=4),os===null||!(Kc&268435455)&&!(xp&268435455)||Ml(os,xs)}function Sp(f,m){var T=cr;cr|=2;var j=e3();(os!==f||xs!==m)&&(Uo=null,Xc(f,m));do try{TO();break}catch(P){ZE(f,P)}while(!0);if(iw(),cr=T,pp.current=j,In!==null)throw Error(i(261));return os=null,xs=0,Xn}function TO(){for(;In!==null;)t3(In)}function EO(){for(;In!==null&&!ZI();)t3(In)}function t3(f){var m=a3(f.alternate,f,ja);f.memoizedProps=f.pendingProps,m===null?r3(f):In=m,Ww.current=null}function r3(f){var m=f;do{var T=m.alternate;if(f=m.return,m.flags&32768){if(T=wO(T,m),T!==null){T.flags&=32767,In=T;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{Xn=6,In=null;return}}else if(T=vO(T,m,ja),T!==null){In=T;return}if(m=m.sibling,m!==null){In=m;return}In=m=f}while(m!==null);Xn===0&&(Xn=5)}function Yc(f,m,T){var j=br,P=Nn.transition;try{Nn.transition=null,br=1,NO(f,m,T,j)}finally{Nn.transition=P,br=j}return null}function NO(f,m,T,j){do Jc();while(Dl!==null);if(cr&6)throw Error(i(327));T=f.finishedWork;var P=f.finishedLanes;if(T===null)return null;if(f.finishedWork=null,f.finishedLanes=0,T===f.current)throw Error(i(177));f.callbackNode=null,f.callbackPriority=0;var O=T.lanes|T.childLanes;if(qI(f,O),f===os&&(In=os=null,xs=0),!(T.subtreeFlags&2064)&&!(T.flags&2064)||vp||(vp=!0,i3(qv,function(){return Jc(),null})),O=(T.flags&15990)!==0,T.subtreeFlags&15990||O){O=Nn.transition,Nn.transition=null;var le=br;br=1;var Pe=cr;cr|=4,Ww.current=null,bO(f,T),HE(T,f),ne(f.containerInfo),f.current=T,SO(T),eO(),cr=Pe,br=le,Nn.transition=O}else f.current=T;if(vp&&(vp=!1,Dl=f,wp=P),O=f.pendingLanes,O===0&&(Pl=null),nO(T.stateNode),ha(f,as()),m!==null)for(j=f.onRecoverableError,T=0;T<m.length;T++)P=m[T],j(P.value,{componentStack:P.stack,digest:P.digest});if(yp)throw yp=!1,f=Vw,Vw=null,f;return wp&1&&f.tag!==0&&Jc(),O=f.pendingLanes,O&1?f===Kw?Jh++:(Jh=0,Kw=f):Jh=0,eo(),null}function Jc(){if(Dl!==null){var f=R4(wp),m=Nn.transition,T=br;try{if(Nn.transition=null,br=16>f?16:f,Dl===null)var j=!1;else{if(f=Dl,Dl=null,wp=0,cr&6)throw Error(i(331));var P=cr;for(cr|=4,Mt=f.current;Mt!==null;){var O=Mt,le=O.child;if(Mt.flags&16){var Pe=O.deletions;if(Pe!==null){for(var Ke=0;Ke<Pe.length;Ke++){var gt=Pe[Ke];for(Mt=gt;Mt!==null;){var It=Mt;switch(It.tag){case 0:case 11:case 15:Vh(8,It,O)}var tr=It.child;if(tr!==null)tr.return=It,Mt=tr;else for(;Mt!==null;){It=Mt;var At=It.sibling,Gr=It.return;if(UE(It),It===gt){Mt=null;break}if(At!==null){At.return=Gr,Mt=At;break}Mt=Gr}}}var Ur=O.alternate;if(Ur!==null){var ga=Ur.child;if(ga!==null){Ur.child=null;do{var $o=ga.sibling;ga.sibling=null,ga=$o}while(ga!==null)}}Mt=O}}if(O.subtreeFlags&2064&&le!==null)le.return=O,Mt=le;else e:for(;Mt!==null;){if(O=Mt,O.flags&2048)switch(O.tag){case 0:case 11:case 15:Vh(9,O,O.return)}var ze=O.sibling;if(ze!==null){ze.return=O.return,Mt=ze;break e}Mt=O.return}}var Re=f.current;for(Mt=Re;Mt!==null;){le=Mt;var Je=le.child;if(le.subtreeFlags&2064&&Je!==null)Je.return=le,Mt=Je;else e:for(le=Re;Mt!==null;){if(Pe=Mt,Pe.flags&2048)try{switch(Pe.tag){case 0:case 11:case 15:up(9,Pe)}}catch(Ht){tn(Pe,Pe.return,Ht)}if(Pe===le){Mt=null;break e}var Pt=Pe.sibling;if(Pt!==null){Pt.return=Pe.return,Mt=Pt;break e}Mt=Pe.return}}if(cr=P,eo(),Zi&&typeof Zi.onPostCommitFiberRoot=="function")try{Zi.onPostCommitFiberRoot($m,f)}catch{}j=!0}return j}finally{br=T,Nn.transition=m}}return!1}function n3(f,m,T){m=jd(T,m),m=_E(f,m,1),f=Fl(f,m,1),m=Ps(),f!==null&&(Rh(f,1,m),ha(f,m))}function tn(f,m,T){if(f.tag===3)n3(f,f,T);else for(;m!==null;){if(m.tag===3){n3(m,f,T);break}else if(m.tag===1){var j=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof j.componentDidCatch=="function"&&(Pl===null||!Pl.has(j))){f=jd(T,f),f=bE(m,f,1),m=Fl(m,f,1),f=Ps(),m!==null&&(Rh(m,1,f),ha(m,f));break}}m=m.return}}function AO(f,m,T){var j=f.pingCache;j!==null&&j.delete(m),m=Ps(),f.pingedLanes|=f.suspendedLanes&T,os===f&&(xs&T)===T&&(Xn===4||Xn===3&&(xs&130023424)===xs&&500>as()-Hw?Xc(f,0):zw|=T),ha(f,m)}function s3(f,m){m===0&&(f.mode&1?(m=Bm,Bm<<=1,!(Bm&130023424)&&(Bm=4194304)):m=1);var T=Ps();f=to(f,m),f!==null&&(Rh(f,m,T),ha(f,T))}function jO(f){var m=f.memoizedState,T=0;m!==null&&(T=m.retryLane),s3(f,T)}function FO(f,m){var T=0;switch(f.tag){case 13:var j=f.stateNode,P=f.memoizedState;P!==null&&(T=P.retryLane);break;case 19:j=f.stateNode;break;default:throw Error(i(314))}j!==null&&j.delete(m),s3(f,T)}var a3;a3=function(f,m,T){if(f!==null)if(f.memoizedProps!==m.pendingProps||Ut.current)da=!0;else{if(!(f.lanes&T)&&!(m.flags&128))return da=!1,yO(f,m,T);da=!!(f.flags&131072)}else da=!1,en&&m.flags&1048576&&I4(m,Hm,m.index);switch(m.lanes=0,m.tag){case 2:var j=m.type;ip(f,m),f=m.pendingProps;var P=ss(m,Xe.current);Ed(m,T),P=xw(null,m,j,f,P,T);var O=yw();return m.flags|=1,typeof P=="object"&&P!==null&&typeof P.render=="function"&&P.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,Br(j)?(O=!0,_d(m)):O=!1,m.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,uw(m),P.updater=sp,m.stateNode=P,P._reactInternals=m,kw(m,j,f,T),m=Nw(null,m,j,!0,O,T)):(m.tag=0,en&&O&&ew(m),qs(null,m,P,T),m=m.child),m;case 16:j=m.elementType;e:{switch(ip(f,m),f=m.pendingProps,P=j._init,j=P(j._payload),m.type=j,P=m.tag=DO(j),f=Ei(j,f),P){case 0:m=Ew(null,m,j,f,T);break e;case 1:m=FE(null,m,j,f,T);break e;case 11:m=TE(null,m,j,f,T);break e;case 14:m=EE(null,m,j,Ei(j.type,f),T);break e}throw Error(i(306,j,""))}return m;case 0:return j=m.type,P=m.pendingProps,P=m.elementType===j?P:Ei(j,P),Ew(f,m,j,P,T);case 1:return j=m.type,P=m.pendingProps,P=m.elementType===j?P:Ei(j,P),FE(f,m,j,P,T);case 3:e:{if(PE(m),f===null)throw Error(i(387));j=m.pendingProps,O=m.memoizedState,P=O.element,K4(f,m),Qm(m,j,null,T);var le=m.memoizedState;if(j=le.element,Ne&&O.isDehydrated)if(O={element:j,isDehydrated:!1,cache:le.cache,pendingSuspenseBoundaries:le.pendingSuspenseBoundaries,transitions:le.transitions},m.updateQueue.baseState=O,m.memoizedState=O,m.flags&256){P=jd(Error(i(423)),m),m=DE(f,m,j,T,P);break e}else if(j!==P){P=jd(Error(i(424)),m),m=DE(f,m,j,T,P);break e}else for(Ne&&(Ka=ce(m.stateNode.containerInfo),Aa=m,en=!0,Ti=null,Mh=!1),T=H4(m,null,j,T),m.child=T;T;)T.flags=T.flags&-3|4096,T=T.sibling;else{if(kd(),j===P){m=Bo(f,m,T);break e}qs(f,m,j,T)}m=m.child}return m;case 5:return J4(m),f===null&&nw(m),j=m.type,P=m.pendingProps,O=f!==null?f.memoizedProps:null,le=P.children,q(j,P)?le=null:O!==null&&q(j,O)&&(m.flags|=32),jE(f,m),qs(f,m,le,T),m.child;case 6:return f===null&&nw(m),null;case 13:return RE(f,m,T);case 4:return dw(m,m.stateNode.containerInfo),j=m.pendingProps,f===null?m.child=Cd(m,null,j,T):qs(f,m,j,T),m.child;case 11:return j=m.type,P=m.pendingProps,P=m.elementType===j?P:Ei(j,P),TE(f,m,j,P,T);case 7:return qs(f,m,m.pendingProps,T),m.child;case 8:return qs(f,m,m.pendingProps.children,T),m.child;case 12:return qs(f,m,m.pendingProps.children,T),m.child;case 10:e:{if(j=m.type._context,P=m.pendingProps,O=m.memoizedProps,le=P.value,G4(m,j,le),O!==null)if(Ci(O.value,le)){if(O.children===P.children&&!Ut.current){m=Bo(f,m,T);break e}}else for(O=m.child,O!==null&&(O.return=m);O!==null;){var Pe=O.dependencies;if(Pe!==null){le=O.child;for(var Ke=Pe.firstContext;Ke!==null;){if(Ke.context===j){if(O.tag===1){Ke=Oo(-1,T&-T),Ke.tag=2;var gt=O.updateQueue;if(gt!==null){gt=gt.shared;var It=gt.pending;It===null?Ke.next=Ke:(Ke.next=It.next,It.next=Ke),gt.pending=Ke}}O.lanes|=T,Ke=O.alternate,Ke!==null&&(Ke.lanes|=T),lw(O.return,T,m),Pe.lanes|=T;break}Ke=Ke.next}}else if(O.tag===10)le=O.type===m.type?null:O.child;else if(O.tag===18){if(le=O.return,le===null)throw Error(i(341));le.lanes|=T,Pe=le.alternate,Pe!==null&&(Pe.lanes|=T),lw(le,T,m),le=O.sibling}else le=O.child;if(le!==null)le.return=O;else for(le=O;le!==null;){if(le===m){le=null;break}if(O=le.sibling,O!==null){O.return=le.return,le=O;break}le=le.return}O=le}qs(f,m,P.children,T),m=m.child}return m;case 9:return P=m.type,j=m.pendingProps.children,Ed(m,T),P=Xa(P),j=j(P),m.flags|=1,qs(f,m,j,T),m.child;case 14:return j=m.type,P=Ei(j,m.pendingProps),P=Ei(j.type,P),EE(f,m,j,P,T);case 15:return NE(f,m,m.type,m.pendingProps,T);case 17:return j=m.type,P=m.pendingProps,P=m.elementType===j?P:Ei(j,P),ip(f,m),m.tag=1,Br(j)?(f=!0,_d(m)):f=!1,Ed(m,T),vE(m,j,P),kw(m,j,P,T),Nw(null,m,j,!0,f,T);case 19:return LE(f,m,T);case 22:return AE(f,m,T)}throw Error(i(156,m.tag))};function i3(f,m){return Jv(f,m)}function PO(f,m,T,j){this.tag=f,this.key=T,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=j,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qa(f,m,T,j){return new PO(f,m,T,j)}function qw(f){return f=f.prototype,!(!f||!f.isReactComponent)}function DO(f){if(typeof f=="function")return qw(f)?1:0;if(f!=null){if(f=f.$$typeof,f===v)return 11;if(f===_)return 14}return 2}function Ll(f,m){var T=f.alternate;return T===null?(T=qa(f.tag,m,f.key,f.mode),T.elementType=f.elementType,T.type=f.type,T.stateNode=f.stateNode,T.alternate=f,f.alternate=T):(T.pendingProps=m,T.type=f.type,T.flags=0,T.subtreeFlags=0,T.deletions=null),T.flags=f.flags&14680064,T.childLanes=f.childLanes,T.lanes=f.lanes,T.child=f.child,T.memoizedProps=f.memoizedProps,T.memoizedState=f.memoizedState,T.updateQueue=f.updateQueue,m=f.dependencies,T.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},T.sibling=f.sibling,T.index=f.index,T.ref=f.ref,T}function kp(f,m,T,j,P,O){var le=2;if(j=f,typeof f=="function")qw(f)&&(le=1);else if(typeof f=="string")le=5;else e:switch(f){case d:return Qc(T.children,P,O,m);case g:le=8,P|=8;break;case h:return f=qa(12,T,m,P|2),f.elementType=h,f.lanes=O,f;case w:return f=qa(13,T,m,P),f.elementType=w,f.lanes=O,f;case S:return f=qa(19,T,m,P),f.elementType=S,f.lanes=O,f;case k:return Cp(T,P,O,m);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case p:le=10;break e;case x:le=9;break e;case v:le=11;break e;case _:le=14;break e;case y:le=16,j=null;break e}throw Error(i(130,f==null?f:typeof f,""))}return m=qa(le,T,m,P),m.elementType=f,m.type=j,m.lanes=O,m}function Qc(f,m,T,j){return f=qa(7,f,j,m),f.lanes=T,f}function Cp(f,m,T,j){return f=qa(22,f,j,m),f.elementType=k,f.lanes=T,f.stateNode={isHidden:!1},f}function Zw(f,m,T){return f=qa(6,f,null,m),f.lanes=T,f}function e_(f,m,T){return m=qa(4,f.children!==null?f.children:[],f.key,m),m.lanes=T,m.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},m}function RO(f,m,T,j,P){this.tag=m,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ve,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xv(0),this.expirationTimes=Xv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xv(0),this.identifierPrefix=j,this.onRecoverableError=P,Ne&&(this.mutableSourceEagerHydrationData=null)}function o3(f,m,T,j,P,O,le,Pe,Ke){return f=new RO(f,m,T,Pe,Ke),m===1?(m=1,O===!0&&(m|=8)):m=0,O=qa(3,null,null,m),f.current=O,O.stateNode=f,O.memoizedState={element:j,isDehydrated:T,cache:null,transitions:null,pendingSuspenseBoundaries:null},uw(O),f}function l3(f){if(!f)return re;f=f._reactInternals;e:{if(F(f)!==f||f.tag!==1)throw Error(i(170));var m=f;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(Br(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(i(171))}if(f.tag===1){var T=f.type;if(Br(T))return Ro(f,T,m)}return m}function c3(f){var m=f._reactInternals;if(m===void 0)throw typeof f.render=="function"?Error(i(188)):(f=Object.keys(f).join(","),Error(i(268,f)));return f=M(m),f===null?null:f.stateNode}function u3(f,m){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var T=f.retryLane;f.retryLane=T!==0&&T<m?T:m}}function Tp(f,m){u3(f,m),(f=f.alternate)&&u3(f,m)}function MO(f){return f=M(f),f===null?null:f.stateNode}function LO(){return null}return r.attemptContinuousHydration=function(f){if(f.tag===13){var m=to(f,134217728);if(m!==null){var T=Ps();Qa(m,f,134217728,T)}Tp(f,134217728)}},r.attemptDiscreteHydration=function(f){if(f.tag===13){var m=to(f,1);if(m!==null){var T=Ps();Qa(m,f,1,T)}Tp(f,1)}},r.attemptHydrationAtCurrentPriority=function(f){if(f.tag===13){var m=Rl(f),T=to(f,m);if(T!==null){var j=Ps();Qa(T,f,m,j)}Tp(f,m)}},r.attemptSynchronousHydration=function(f){switch(f.tag){case 3:var m=f.stateNode;if(m.current.memoizedState.isDehydrated){var T=Dh(m.pendingLanes);T!==0&&(Yv(m,T|1),ha(m,as()),!(cr&6)&&(Dd(),eo()))}break;case 13:qE(function(){var j=to(f,1);if(j!==null){var P=Ps();Qa(j,f,1,P)}}),Tp(f,1)}},r.batchedUpdates=function(f,m){var T=cr;cr|=1;try{return f(m)}finally{cr=T,cr===0&&(Dd(),Wm&&eo())}},r.createComponentSelector=function(f){return{$$typeof:dp,value:f}},r.createContainer=function(f,m,T,j,P,O,le){return o3(f,m,!1,null,T,j,P,O,le)},r.createHasPseudoClassSelector=function(f){return{$$typeof:fp,value:f}},r.createHydrationContainer=function(f,m,T,j,P,O,le,Pe,Ke){return f=o3(T,j,!0,f,P,O,le,Pe,Ke),f.context=l3(null),T=f.current,j=Ps(),P=Rl(T),O=Oo(j,P),O.callback=m??null,Fl(T,O,P),f.current.lanes=P,Rh(f,P,j),ha(f,j),f},r.createPortal=function(f,m,T){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:j==null?null:""+j,children:f,containerInfo:m,implementation:T}},r.createRoleSelector=function(f){return{$$typeof:hp,value:f}},r.createTestNameSelector=function(f){return{$$typeof:gp,value:f}},r.createTextSelector=function(f){return{$$typeof:mp,value:f}},r.deferredUpdates=function(f){var m=br,T=Nn.transition;try{return Nn.transition=null,br=16,f()}finally{br=m,Nn.transition=T}},r.discreteUpdates=function(f,m,T,j,P){var O=br,le=Nn.transition;try{return Nn.transition=null,br=1,f(m,T,j,P)}finally{br=O,Nn.transition=le,cr===0&&Dd()}},r.findAllNodes=$w,r.findBoundingRects=function(f,m){if(!Se)throw Error(i(363));m=$w(f,m),f=[];for(var T=0;T<m.length;T++)f.push(Me(m[T]));for(m=f.length-1;0<m;m--){T=f[m];for(var j=T.x,P=j+T.width,O=T.y,le=O+T.height,Pe=m-1;0<=Pe;Pe--)if(m!==Pe){var Ke=f[Pe],gt=Ke.x,It=gt+Ke.width,tr=Ke.y,At=tr+Ke.height;if(j>=gt&&O>=tr&&P<=It&&le<=At){f.splice(m,1);break}else if(j!==gt||T.width!==Ke.width||At<O||tr>le){if(!(O!==tr||T.height!==Ke.height||It<j||gt>P)){gt>j&&(Ke.width+=gt-j,Ke.x=j),It<P&&(Ke.width=P-gt),f.splice(m,1);break}}else{tr>O&&(Ke.height+=tr-O,Ke.y=O),At<le&&(Ke.height=le-tr),f.splice(m,1);break}}}return f},r.findHostInstance=c3,r.findHostInstanceWithNoPortals=function(f){return f=R(f),f=f!==null?J(f):null,f===null?null:f.stateNode},r.findHostInstanceWithWarning=function(f){return c3(f)},r.flushControlled=function(f){var m=cr;cr|=1;var T=Nn.transition,j=br;try{Nn.transition=null,br=1,f()}finally{br=j,Nn.transition=T,cr=m,cr===0&&(Dd(),eo())}},r.flushPassiveEffects=Jc,r.flushSync=qE,r.focusWithin=function(f,m){if(!Se)throw Error(i(363));for(f=Ow(f),m=YE(f,m),m=Array.from(m),f=0;f<m.length;){var T=m[f++];if(!Ge(T)){if(T.tag===5&&kt(T.stateNode))return!0;for(T=T.child;T!==null;)m.push(T),T=T.sibling}}return!1},r.getCurrentUpdatePriority=function(){return br},r.getFindAllNodesFailureDescription=function(f,m){if(!Se)throw Error(i(363));var T=0,j=[];f=[Ow(f),0];for(var P=0;P<f.length;){var O=f[P++],le=f[P++],Pe=m[le];if((O.tag!==5||!Ge(O))&&(Bw(O,Pe)&&(j.push(Uw(Pe)),le++,le>T&&(T=le)),le<m.length))for(O=O.child;O!==null;)f.push(O,le),O=O.sibling}if(T<m.length){for(f=[];T<m.length;T++)f.push(Uw(m[T]));return`findAllNodes was able to match part of the selector:
  `+(j.join(" > ")+`

No matching component was found for:
  `)+f.join(" > ")}return null},r.getPublicRootInstance=function(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return z(f.child.stateNode);default:return f.child.stateNode}},r.injectIntoDevTools=function(f){if(f={bundleType:f.bundleType,version:f.version,rendererPackageName:f.rendererPackageName,rendererConfig:f.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:MO,findFiberByHostInstance:f.findFiberByHostInstance||LO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")f=!1;else{var m=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(m.isDisabled||!m.supportsFiber)f=!0;else{try{$m=m.inject(f),Zi=m}catch{}f=!!m.checkDCE}}return f},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(f,m,T,j){if(!Se)throw Error(i(363));f=$w(f,m);var P=zt(f,T,j).disconnect;return{disconnect:function(){P()}}},r.registerMutableSourceForHydration=function(f,m){var T=m._getVersion;T=T(m._source),f.mutableSourceEagerHydrationData==null?f.mutableSourceEagerHydrationData=[m,T]:f.mutableSourceEagerHydrationData.push(m,T)},r.runWithPriority=function(f,m){var T=br;try{return br=f,m()}finally{br=T}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(f,m,T,j){var P=m.current,O=Ps(),le=Rl(P);return T=l3(T),m.context===null?m.context=T:m.pendingContext=T,m=Oo(O,le),m.payload={element:f},j=j===void 0?null:j,j!==null&&(m.callback=j),f=Fl(P,m,le),f!==null&&(Qa(f,P,le,O),Jm(f,P,le)),le},r};dD.exports=zJ;var HJ=dD.exports;const GJ=iy(HJ);var fD={exports:{}},dd={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */dd.ConcurrentRoot=1;dd.ContinuousEventPriority=4;dd.DefaultEventPriority=16;dd.DiscreteEventPriority=1;dd.IdleEventPriority=536870912;dd.LegacyRoot=0;fD.exports=dd;var hD=fD.exports;const v6={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let w6=!1,_6=!1;const YC=".react-konva-event";let gD=!1;function VJ(t){gD=t}const KJ=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,XJ=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,YJ={};function wv(t,e,r=YJ){if(!w6&&"zIndex"in e&&(console.warn(XJ),w6=!0),!_6&&e.draggable){var n=e.x!==void 0||e.y!==void 0,s=e.onDragEnd||e.onDragMove;n&&!s&&(console.warn(KJ),_6=!0)}for(var a in r)if(!v6[a]){var i=a.slice(0,2)==="on",o=r[a]!==e[a];if(i&&o){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),t.off(l,r[a])}var u=!e.hasOwnProperty(a);u&&t.setAttr(a,void 0)}var d=gD||e._useStrictMode,g={},h=!1;const p={};for(var a in e)if(!v6[a]){var i=a.slice(0,2)==="on",x=r[a]!==e[a];if(i&&x){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),e[a]&&(p[l]=e[a])}!i&&(e[a]!==r[a]||d&&e[a]!==t.getAttr(a))&&(h=!0,g[a]=e[a])}h&&(t.setAttrs(g),Mc(t));for(var l in p)t.on(l+YC,p[l])}function Mc(t){if(!or.Konva.autoDrawEnabled){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}}const mD={},JJ={};Eg.Node.prototype._applyProps=wv;function QJ(t,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}t.add(e),Mc(t)}function qJ(t,e,r){let n=Eg[t];n||(console.error(`Konva has no node with the type ${t}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${t}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=Eg.Group);const s={},a={};for(var i in e){var o=i.slice(0,2)==="on";o?a[i]=e[i]:s[i]=e[i]}const l=new n(s);return wv(l,a),l}function ZJ(t,e,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${t}"`)}function eQ(t,e,r){return!1}function tQ(t){return t}function rQ(){return null}function nQ(){return null}function sQ(t,e,r,n){return JJ}function aQ(){}function iQ(t){}function oQ(t,e){return!1}function lQ(){return mD}function cQ(){return mD}const uQ=setTimeout,dQ=clearTimeout,fQ=-1;function hQ(t,e){return!1}const gQ=!1,mQ=!0,pQ=!0;function xQ(t,e){e.parent===t?e.moveToTop():t.add(e),Mc(t)}function yQ(t,e){e.parent===t?e.moveToTop():t.add(e),Mc(t)}function pD(t,e,r){e._remove(),t.add(e),e.setZIndex(r.getZIndex()),Mc(t)}function vQ(t,e,r){pD(t,e,r)}function wQ(t,e){e.destroy(),e.off(YC),Mc(t)}function _Q(t,e){e.destroy(),e.off(YC),Mc(t)}function bQ(t,e,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function SQ(t,e,r){}function kQ(t,e,r,n,s){wv(t,s,n)}function CQ(t){t.hide(),Mc(t)}function TQ(t){}function EQ(t,e){(e.visible==null||e.visible)&&t.show()}function NQ(t,e){}function AQ(t){}function jQ(){}const FQ=()=>hD.DefaultEventPriority,PQ=Object.freeze(Object.defineProperty({__proto__:null,appendChild:xQ,appendChildToContainer:yQ,appendInitialChild:QJ,cancelTimeout:dQ,clearContainer:AQ,commitMount:SQ,commitTextUpdate:bQ,commitUpdate:kQ,createInstance:qJ,createTextInstance:ZJ,detachDeletedInstance:jQ,finalizeInitialChildren:eQ,getChildHostContext:cQ,getCurrentEventPriority:FQ,getPublicInstance:tQ,getRootHostContext:lQ,hideInstance:CQ,hideTextInstance:TQ,idlePriority:T0.unstable_IdlePriority,insertBefore:pD,insertInContainerBefore:vQ,isPrimaryRenderer:gQ,noTimeout:fQ,now:T0.unstable_now,prepareForCommit:rQ,preparePortalMount:nQ,prepareUpdate:sQ,removeChild:wQ,removeChildFromContainer:_Q,resetAfterCommit:aQ,resetTextContent:iQ,run:T0.unstable_runWithPriority,scheduleTimeout:uQ,shouldDeprioritizeSubtree:oQ,shouldSetTextContent:hQ,supportsMutation:pQ,unhideInstance:EQ,unhideTextInstance:NQ,warnsIfNotActing:mQ},Symbol.toStringTag,{value:"Module"}));var DQ=Object.defineProperty,RQ=Object.defineProperties,MQ=Object.getOwnPropertyDescriptors,b6=Object.getOwnPropertySymbols,LQ=Object.prototype.hasOwnProperty,IQ=Object.prototype.propertyIsEnumerable,S6=(t,e,r)=>e in t?DQ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,k6=(t,e)=>{for(var r in e||(e={}))LQ.call(e,r)&&S6(t,r,e[r]);if(b6)for(var r of b6(e))IQ.call(e,r)&&S6(t,r,e[r]);return t},OQ=(t,e)=>RQ(t,MQ(e)),C6,T6;typeof window<"u"&&((C6=window.document)!=null&&C6.createElement||((T6=window.navigator)==null?void 0:T6.product)==="ReactNative")?b.useLayoutEffect:b.useEffect;function xD(t,e,r){if(!t)return;if(r(t)===!0)return t;let n=t.child;for(;n;){const s=xD(n,e,r);if(s)return s;n=n.sibling}}function yD(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const E6=console.error;console.error=function(){const t=[...arguments].join("");if(t!=null&&t.startsWith("Warning:")&&t.includes("useContext")){console.error=E6;return}return E6.apply(this,arguments)};const JC=yD(b.createContext(null));class vD extends b.Component{render(){return b.createElement(JC.Provider,{value:this._reactInternals},this.props.children)}}function BQ(){const t=b.useContext(JC);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=b.useId();return b.useMemo(()=>{for(const n of[t,t==null?void 0:t.alternate]){if(!n)continue;const s=xD(n,!1,a=>{let i=a.memoizedState;for(;i;){if(i.memoizedState===e)return!0;i=i.next}});if(s)return s}},[t,e])}function UQ(){const t=BQ(),[e]=b.useState(()=>new Map);e.clear();let r=t;for(;r;){if(r.type&&typeof r.type=="object"){const s=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;s&&s!==JC&&!e.has(s)&&e.set(s,b.useContext(yD(s)))}r=r.return}return e}function wD(){const t=UQ();return b.useMemo(()=>Array.from(t.keys()).reduce((e,r)=>n=>b.createElement(e,null,b.createElement(r.Provider,OQ(k6({},n),{value:t.get(r)}))),e=>b.createElement(vD,k6({},e))),[t])}function $Q(t){const e=Wn.useRef({});return Wn.useLayoutEffect(()=>{e.current=t}),Wn.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const WQ=t=>{const e=Wn.useRef(null),r=Wn.useRef(null),n=Wn.useRef(null),s=$Q(t),a=wD(),i=o=>{const{forwardedRef:l}=t;l&&(typeof l=="function"?l(o):l.current=o)};return Wn.useLayoutEffect(()=>(r.current=new Eg.Stage({width:t.width,height:t.height,container:e.current}),i(r.current),n.current=hf.createContainer(r.current,hD.LegacyRoot,!1,null),hf.updateContainer(Wn.createElement(a,{},t.children),n.current),()=>{Eg.isBrowser&&(i(null),hf.updateContainer(null,n.current,null),r.current.destroy())}),[]),Wn.useLayoutEffect(()=>{i(r.current),wv(r.current,t,s),hf.updateContainer(Wn.createElement(a,{},t.children),n.current,null)}),Wn.createElement("div",{ref:e,id:t.id,accessKey:t.accessKey,className:t.className,role:t.role,style:t.style,tabIndex:t.tabIndex,title:t.title})},Mu="Layer",zQ="FastLayer",tl="Group",HQ="Label",sa="Rect",Kf="Circle",GQ="Ellipse",VQ="Wedge",hi="Line",KQ="Sprite",_D="Image",iu="Text",XQ="TextPath",YQ="Star",JQ="Ring",QQ="Arc",qQ="Tag",ZQ="Path",eq="RegularPolygon",oS="Arrow",tq="Shape",bD="Transformer",rq="18.2.13",hf=GJ(PQ);hf.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Wn.version,rendererPackageName:"react-konva"});const Lu=Wn.forwardRef((t,e)=>Wn.createElement(vD,{},Wn.createElement(WQ,{...t,forwardedRef:e}))),nq=VJ,sq=Object.freeze(Object.defineProperty({__proto__:null,Arc:QQ,Arrow:oS,Circle:Kf,Ellipse:GQ,FastLayer:zQ,Group:tl,Image:_D,KonvaRenderer:hf,Label:HQ,Layer:Mu,Line:hi,Path:ZQ,Rect:sa,RegularPolygon:eq,Ring:JQ,Shape:tq,Sprite:KQ,Stage:Lu,Star:YQ,Tag:qQ,Text:iu,TextPath:XQ,Transformer:bD,Wedge:VQ,useContextBridge:wD,useStrictMode:nq,version:rq},Symbol.toStringTag,{value:"Module"})),st=({children:t,hover:e=!0,className:r="",...n})=>{const s=`
    bg-white rounded-xl shadow-md border border-gray-200 p-6
    ${e?"hover:shadow-lg hover:-translate-y-1 transition-all duration-200":""}
    ${r}
  `;return c.jsx(Be.div,{className:s,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},...n,children:t})},aq=({children:t,className:e=""})=>c.jsx("div",{className:`border-b border-gray-200 pb-4 mb-4 ${e}`,children:t}),iq=({children:t,className:e=""})=>c.jsx("h3",{className:`text-xl font-semibold text-gray-800 ${e}`,children:t}),oq=({children:t,className:e=""})=>c.jsx("div",{className:`py-4 ${e}`,children:t}),lq=({children:t,className:e=""})=>c.jsx("div",{className:`border-t border-gray-200 pt-4 mt-4 ${e}`,children:t});st.Header=aq;st.Title=iq;st.Body=oq;st.Footer=lq;const cq=t=>{const[e,r]=b.useState({width:800,height:600}),n=b.useRef(null),s=b.useCallback(()=>{if(t.current){t.current.getBoundingClientRect();const a=Math.min(1200,window.innerWidth*.8),i=Math.min(800,window.innerHeight*.6),o=4/3;let l=a,u=l/o;u>i&&(u=i,l=u*o),r({width:l,height:u})}},[t]);return b.useEffect(()=>(s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)),[s]),{canvasSize:e,stageRef:n,updateCanvasSize:s}},lS={convertToOriginal:(t,e,r)=>r?{x:Number(((t-r.x)/r.scale).toFixed(4)),y:Number(((e-r.y)/r.scale).toFixed(4))}:{x:t,y:e},convertToCanvas:(t,e,r)=>r?{x:Number((r.x+t*r.scale).toFixed(4)),y:Number((r.y+e*r.scale).toFixed(4))}:{x:t,y:e},isPointInImage:(t,e)=>e?t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height:!1,calculateImageScale:(t,e)=>{if(!t||!e)return 1;const r=40,n=e.width-r,s=e.height-r;return Math.min(n/t.width,s/t.height)},calculateImageInfo:(t,e)=>{if(!t||!e)return null;const r=40,n=e.width-r,s=e.height-r,a=Math.min(n/t.width,s/t.height),i=t.width*a,o=t.height*a,l=(e.width-i)/2,u=(e.height-o)/2;return{x:l,y:u,width:i,height:o,scale:a,originalWidth:t.width,originalHeight:t.height}}},uq=(t,e)=>{const[r,n]=b.useState(null),s=b.useCallback((a,i)=>lS.calculateImageInfo(a,i),[]);return b.useEffect(()=>{if(t&&e){const a=s(t,e);n(a)}},[t,e,s]),r},dq=t=>{const e=b.useCallback((n,s)=>lS.convertToOriginal(n,s,t),[t]),r=b.useCallback((n,s)=>lS.convertToCanvas(n,s,t),[t]);return{convertToOriginal:e,convertToCanvas:r}},c0={create:(t,e,r,n,s)=>({id:s,x:t-r/2,y:e-n/2,width:Math.max(r,30),height:Math.max(n,10),fill:"rgba(0, 123, 255, 0.15)",stroke:"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),validate:t=>t.width>0&&t.height>0,findAtPosition:(t,e,r)=>t.find(n=>e>=n.x&&e<=n.x+n.width&&r>=n.y&&r<=n.y+n.height),generateId:()=>`block_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},Hd={create:(t,e,r,n,s,a,i)=>({id:i,startX:t,startY:e,endX:r,endY:n,startBlock:s,endBlock:a,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,pointerLength:10,pointerWidth:10}),snapToNearestBlock:(t,e,r,n=60)=>{let s=null,a=1/0;for(const i of r){const o=i.x+i.width/2,l=i.y+i.height/2,u=Math.sqrt(Math.pow(t-o,2)+Math.pow(e-l,2));u<=n&&u<a&&(a=u,s=i)}return s?{x:s.x+s.width/2,y:s.y+s.height/2,blockId:s.id,block:s,distance:a}:null},validate:(t,e,r,n,s)=>Hd.snapToNearestBlock(t,e,s)!==null,generateId:()=>`arrow_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},e2={create:(t,e,r)=>({id:r,blockId:t,word:e}),update:(t,e,r)=>t.map(n=>n.blockId===e?{...n,word:r}:n),delete:(t,e)=>t.filter(r=>r.blockId!==e),generateId:t=>`word_${t}`,validate:t=>t&&t.trim().length>0},fq={testData:{blocks:[],words:[],arrows:[],imageUrl:null},canvas:{size:{width:800,height:600},image:null,imageInfo:null,selectedTool:"edit"},creation:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null},ui:{selectedBlock:null,showWordPanel:!1,isLoading:!1,error:null}},hq=(t,e)=>{switch(e.type){case"SET_CANVAS_SIZE":return{...t,canvas:{...t.canvas,size:e.payload}};case"SET_IMAGE":return{...t,canvas:{...t.canvas,image:e.payload}};case"SET_IMAGE_INFO":return{...t,canvas:{...t.canvas,imageInfo:e.payload}};case"SET_SELECTED_TOOL":return{...t,canvas:{...t.canvas,selectedTool:e.payload}};case"ADD_BLOCK":return{...t,testData:{...t.testData,blocks:[...t.testData.blocks,e.payload]}};case"ADD_WORD":return{...t,testData:{...t.testData,words:[...t.testData.words,e.payload]}};case"ADD_ARROW":return{...t,testData:{...t.testData,arrows:[...t.testData.arrows,e.payload]}};case"UPDATE_BLOCK":return{...t,testData:{...t.testData,blocks:t.testData.blocks.map(r=>r.id===e.payload.id?{...r,...e.payload.updates}:r)}};case"DELETE_BLOCK":return{...t,testData:{...t.testData,blocks:t.testData.blocks.filter(r=>r.id!==e.payload),words:t.testData.words.filter(r=>r.blockId!==e.payload),arrows:t.testData.arrows.filter(r=>r.startBlock!==e.payload&&r.endBlock!==e.payload)}};case"UPDATE_WORDS":return{...t,testData:{...t.testData,words:e.payload}};case"SET_CREATION_STATE":return{...t,creation:{...t.creation,...e.payload}};case"SET_UI_STATE":return{...t,ui:{...t.ui,...e.payload}};case"SET_LOADING":return{...t,ui:{...t.ui,isLoading:e.payload}};case"SET_ERROR":return{...t,ui:{...t.ui,error:e.payload}};case"RESET_TESTDATA":return{...t,testData:{blocks:[],words:[],arrows:[],imageUrl:t.testData.imageUrl}};default:return t}},gq=({testName:t="",showQuestionCount:e=!0,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const[o,l]=b.useReducer(hq,fq),{showNotification:u}=Ys(),{makeAuthenticatedRequest:d}=Ji(),{user:g}=xn(),h=b.useRef(null),p=b.useRef(null),x=b.useRef(null),v=b.useRef({}),w=b.useRef({}),{canvasSize:S,stageRef:_}=cq(h),y=uq(o.canvas.image,S),{convertToOriginal:k}=dq(y);b.useEffect(()=>{l({type:"SET_CANVAS_SIZE",payload:S})},[S]),b.useEffect(()=>{y&&l({type:"SET_IMAGE_INFO",payload:y})},[y]),b.useEffect(()=>{var H,U,L;const X=x.current;if(!X)return;const z=(H=o.ui.selectedBlock)!=null&&H.id?v.current[o.ui.selectedBlock.id]:null;z?(X.nodes([z]),(U=X.getLayer())==null||U.batchDraw()):(X.nodes([]),(L=X.getLayer())==null||L.batchDraw())},[o.ui.selectedBlock]);const N=b.useCallback(()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:null}}),l({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null}}),l({type:"RESET_TESTDATA"}),l({type:"SET_ERROR",payload:null})},[]),E=b.useCallback(X=>{const z=X.target.files[0];if(!z||!z.type.startsWith("image/")){u("Please select a valid image file","error");return}const H=new FileReader;H.onload=U=>{const L=U.target.result,ne=new Image;ne.crossOrigin="anonymous",ne.onload=()=>{l({type:"SET_IMAGE",payload:ne}),l({type:"SET_UI_STATE",payload:{imageUrl:L}})},ne.src=L},H.readAsDataURL(z)},[u]),A=b.useCallback(X=>{const z=_.current;if(!z)return;const H=z.getPointerPosition();if(H){if(o.canvas.selectedTool==="create"){const U=c0.findAtPosition(o.testData.blocks,H.x,H.y);if(U){l({type:"SET_UI_STATE",payload:{selectedBlock:U}});return}l({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!0,blockCreationStart:{x:H.x,y:H.y}}})}else if(o.canvas.selectedTool==="edit"){const U=c0.findAtPosition(o.testData.blocks,H.x,H.y);l(U?{type:"SET_UI_STATE",payload:{selectedBlock:U}}:{type:"SET_UI_STATE",payload:{selectedBlock:null}})}else if(o.canvas.selectedTool==="arrow"){const U=X.target===z,L=c0.findAtPosition(o.testData.blocks,H.x,H.y);(U||!L)&&l({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!0,arrowStart:{x:H.x,y:H.y}}})}}},[o.canvas.selectedTool,y,o.testData.blocks]),C=b.useCallback(X=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const z=_.current;if(!z)return;const H=z.getPointerPosition();if(!H)return;const U=Math.abs(H.x-o.creation.blockCreationStart.x),L=Math.abs(H.y-o.creation.blockCreationStart.y),ne=10,de=Math.max(U,ne),G=Math.max(L,ne);l({type:"SET_CREATION_STATE",payload:{previewBlock:{x:Math.min(H.x,o.creation.blockCreationStart.x),y:Math.min(H.y,o.creation.blockCreationStart.y),width:de,height:G,fill:"rgba(0, 123, 255, 0.3)",stroke:"#007bff",strokeWidth:2,dash:[5,5],opacity:.7}}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const z=_.current;if(!z)return;const H=z.getPointerPosition();if(!H)return;l({type:"SET_CREATION_STATE",payload:{previewArrow:{startX:o.creation.arrowStart.x,startY:o.creation.arrowStart.y,endX:H.x,endY:H.y,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,dash:[5,5],opacity:.7}}})}},[o.creation]),F=b.useCallback(X=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const z=_.current;if(!z)return;const H=z.getPointerPosition();if(!H)return;const U=Math.abs(H.x-o.creation.blockCreationStart.x),L=Math.abs(H.y-o.creation.blockCreationStart.y),ne=10,de=Math.max(U,ne),G=Math.max(L,ne),K=Math.min(H.x,o.creation.blockCreationStart.x)+de/2,Q=Math.min(H.y,o.creation.blockCreationStart.y)+G/2,q=c0.generateId(),se=c0.create(K,Q,de,G,q),W=e2.create(q,`Word ${o.testData.blocks.length+1}`,e2.generateId(q));l({type:"ADD_BLOCK",payload:se}),l({type:"ADD_WORD",payload:W}),l({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,blockCreationStart:null,previewBlock:null}}),o.testData.blocks.length===0&&l({type:"SET_UI_STATE",payload:{showWordPanel:!0}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const z=_.current;if(!z)return;const H=z.getPointerPosition();if(!H)return;if(Hd.validate(o.creation.arrowStart.x,o.creation.arrowStart.y,H.x,H.y,o.testData.blocks)){const U=Hd.snapToNearestBlock(o.creation.arrowStart.x,o.creation.arrowStart.y,o.testData.blocks),L=Hd.snapToNearestBlock(H.x,H.y,o.testData.blocks),ne=U?U.x:o.creation.arrowStart.x,de=U?U.y:o.creation.arrowStart.y,G=L?L.x:H.x,K=L?L.y:H.y,Q=Hd.generateId(),q=Hd.create(ne,de,G,K,U?U.blockId:null,L?L.blockId:null,Q);l({type:"ADD_ARROW",payload:q}),u("Arrow created successfully!","success")}else u("Arrow must start near a block!","error");l({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!1,arrowStart:null,previewArrow:null}})}},[o.creation,o.testData.blocks,u]),D=b.useCallback(async()=>{console.log(" [MatchingTestCreator] handleSaveTest clicked");const X=R();if(Object.keys(X).length>0){console.warn(" [MatchingTestCreator] Validation errors:",X),u("Please fix validation errors before saving","error");return}try{console.log(" [MatchingTestCreator] Preparing data to save...",{blocks:o.testData.blocks.length,words:o.testData.words.length,arrows:o.testData.arrows.length,imageUrl:o.ui.imageUrl?"present":"missing"}),l({type:"SET_LOADING",payload:!0});let z=o.ui.imageUrl;if(o.ui.imageUrl&&o.ui.imageUrl.startsWith("data:")){const U=await d("/.netlify/functions/upload-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataUrl:o.ui.imageUrl,folder:"matching_tests"})}),L=await U.json();if(U.ok&&L.success&&L.url)z=L.url;else throw new Error(L.message||"Upload failed")}const H=o.testData.blocks.map((U,L)=>{let ne;if(y){const K=k(U.x,U.y),Q=k(U.x+U.width,U.y+U.height);ne={x:K.x,y:K.y,width:Number((Q.x-K.x).toFixed(4)),height:Number((Q.y-K.y).toFixed(4))}}else ne={x:Number(U.x.toFixed(4)),y:Number(U.y.toFixed(4)),width:Number(U.width.toFixed(4)),height:Number(U.height.toFixed(4))};const de=o.testData.words.find(K=>K.blockId===U.id),G=o.testData.arrows.find(K=>K.startBlock===U.id);return{question_id:L+1,word:(de==null?void 0:de.word)||`Word ${L+1}`,block_coordinates:ne,has_arrow:!!G,arrow:G&&y?(()=>{const K=k(G.startX,G.startY),Q=k(G.endX,G.endY),q=K.x/y.originalWidth*100,se=K.y/y.originalHeight*100,W=Q.x/y.originalWidth*100,ee=Q.y/y.originalHeight*100;return{start_x:Number(K.x.toFixed(4)),start_y:Number(K.y.toFixed(4)),end_x:Number(Q.x.toFixed(4)),end_y:Number(Q.y.toFixed(4)),rel_start_x:Number(q.toFixed(4)),rel_start_y:Number(se.toFixed(4)),rel_end_x:Number(W.toFixed(4)),rel_end_y:Number(ee.toFixed(4)),image_width:y.originalWidth,image_height:y.originalHeight,style:G.style||{color:"#dc3545",thickness:3}}})():null}});r&&(console.log(" [MatchingTestCreator] Calling onTestSaved with processed data"),r({success:!0,message:"Test data prepared for assignment",blocks:o.testData.blocks,words:o.testData.words,arrows:o.testData.arrows,imageUrl:z,processedQuestions:H}))}catch(z){console.error("Save error:",z),u(`Error saving test: ${z.message}`,"error")}finally{l({type:"SET_LOADING",payload:!1})}},[o.testData,o.ui.imageUrl,y,k,d,r,u,t,g]),R=b.useCallback(()=>{const X={};return t.trim()||(X.testName="Test name is required"),o.testData.blocks.length===0&&(X.blocks="At least one block is required"),X},[t,o.testData.blocks.length]),M=()=>c.jsxs("div",{className:"flex flex-wrap gap-2 p-4 bg-gray-50 border-b",children:[c.jsx(He,{onClick:()=>l({type:"SET_SELECTED_TOOL",payload:"create"}),variant:o.canvas.selectedTool==="create"?"primary":"secondary",size:"sm",children:" Create Blocks"}),c.jsx(He,{onClick:()=>l({type:"SET_SELECTED_TOOL",payload:"edit"}),variant:o.canvas.selectedTool==="edit"?"primary":"secondary",size:"sm",children:" Edit Blocks"}),c.jsx(He,{onClick:()=>l({type:"SET_SELECTED_TOOL",payload:"arrow"}),variant:o.canvas.selectedTool==="arrow"?"primary":"secondary",size:"sm",children:" Draw Arrows"}),c.jsx(He,{onClick:N,variant:"secondary",size:"sm",children:" Reset"}),c.jsx(He,{onClick:()=>{var X;return(X=p.current)==null?void 0:X.click()},variant:"secondary",size:"sm",children:" Upload Image"})]}),B=()=>c.jsx(Lu,{width:S.width,height:S.height,ref:_,onMouseDown:A,onMouseMove:C,onMouseUp:F,className:o.canvas.selectedTool==="arrow"||o.canvas.selectedTool==="create"?"cursor-crosshair":"cursor-default",children:c.jsxs(Mu,{children:[o.canvas.image&&y&&c.jsx(_D,{image:o.canvas.image,x:y.x,y:y.y,width:y.width,height:y.height}),o.testData.blocks.map(X=>c.jsxs(tl,{ref:z=>{z&&(w.current[X.id]=z)},draggable:o.canvas.selectedTool==="edit",x:X.x,y:X.y,onMouseEnter:z=>{var U,L;const H=(U=z.target.getStage())==null?void 0:U.container();H&&(H.style.cursor=((L=o.ui.selectedBlock)==null?void 0:L.id)===X.id?"nwse-resize":"move")},onMouseLeave:z=>{var U;const H=(U=z.target.getStage())==null?void 0:U.container();H&&(H.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onDragStart:()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:X}})},onDragEnd:z=>{const{x:H,y:U}=z.target.position();l({type:"UPDATE_BLOCK",payload:{id:X.id,updates:{x:H,y:U}}})},onClick:()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:X}})},onTap:()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:X}})},children:[c.jsx(sa,{ref:z=>{z&&(v.current[X.id]=z)},width:X.width,height:X.height,fill:X.fill,stroke:X.stroke,strokeWidth:X.strokeWidth,cornerRadius:X.cornerRadius,shadowColor:X.shadowColor,shadowBlur:X.shadowBlur,shadowOffset:X.shadowOffset,shadowOpacity:X.shadowOpacity,draggable:o.canvas.selectedTool==="edit",onDragEnd:z=>{const{x:H,y:U}=z.target.getParent().position();l({type:"UPDATE_BLOCK",payload:{id:X.id,updates:{x:H,y:U}}})},onMouseEnter:z=>{var U,L;const H=(U=z.target.getStage())==null?void 0:U.container();H&&(H.style.cursor=((L=o.ui.selectedBlock)==null?void 0:L.id)===X.id?"nwse-resize":"move")},onMouseLeave:z=>{var U;const H=(U=z.target.getStage())==null?void 0:U.container();H&&(H.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onTransformEnd:z=>{const H=v.current[X.id];if(!H)return;const U=Math.max(10,H.width()*H.scaleX()),L=Math.max(10,H.height()*H.scaleY());H.scaleX(1),H.scaleY(1),l({type:"UPDATE_BLOCK",payload:{id:X.id,updates:{width:U,height:L}}})}}),c.jsx(iu,{x:2,y:2,text:`${o.testData.blocks.indexOf(X)+1}`,fontSize:Math.min(12,Math.max(8,X.width/4)),fontFamily:"Arial",fill:"#333",fontStyle:"bold",listening:!1})]},X.id)),c.jsx(bD,{ref:x,rotateEnabled:!1,flipEnabled:!1,boundBoxFunc:(X,z)=>({...z,width:Math.max(z.width,10),height:Math.max(z.height,10)})}),o.testData.arrows.map(X=>c.jsx(oS,{points:[X.startX,X.startY,X.endX,X.endY],stroke:X.stroke,fill:X.fill,strokeWidth:X.strokeWidth,pointerLength:X.pointerLength,pointerWidth:X.pointerWidth},X.id)),o.creation.previewBlock&&c.jsx(sa,{x:o.creation.previewBlock.x,y:o.creation.previewBlock.y,width:o.creation.previewBlock.width,height:o.creation.previewBlock.height,fill:o.creation.previewBlock.fill,stroke:o.creation.previewBlock.stroke,strokeWidth:o.creation.previewBlock.strokeWidth,dash:o.creation.previewBlock.dash,opacity:o.creation.previewBlock.opacity}),o.creation.previewArrow&&c.jsx(oS,{points:[o.creation.previewArrow.startX,o.creation.previewArrow.startY,o.creation.previewArrow.endX,o.creation.previewArrow.endY],stroke:o.creation.previewArrow.stroke,fill:o.creation.previewArrow.fill,strokeWidth:o.creation.previewArrow.strokeWidth,dash:o.creation.previewArrow.dash,opacity:o.creation.previewArrow.opacity})]})}),J=b.useMemo(()=>o.testData.blocks.length===0?null:c.jsxs("div",{className:"word-panel bg-gray-50 border-t border-gray-200 p-4 w-full",style:{height:"min(400px, 40vh)",overflowY:"auto"},children:[c.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Words (Auto-created with blocks)"}),c.jsx("div",{className:"space-y-2",children:o.testData.words.map(X=>{const z=o.testData.blocks.find(H=>H.id===X.blockId);return c.jsxs("div",{className:"p-2 bg-white rounded border",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsxs("span",{className:"text-xs text-gray-500",children:["Block ",o.testData.blocks.indexOf(z)+1]}),c.jsx("button",{onClick:()=>l({type:"DELETE_BLOCK",payload:z.id}),className:"text-red-500 hover:text-red-700 text-xs",children:""})]}),c.jsx("input",{type:"text",value:X.word,onChange:H=>{const U=e2.update(o.testData.words,X.blockId,H.target.value);l({type:"UPDATE_WORDS",payload:U})},className:"w-full text-sm px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Enter word text"})]},X.blockId)})})]}),[o.testData.words,o.testData.blocks]);return c.jsxs(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex flex-col h-screen bg-gray-100",children:[c.jsx("div",{className:"bg-white shadow-sm border-b p-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:c.jsx("div",{className:"mt-2 text-sm text-gray-600",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("span",{children:[c.jsx("strong",{children:"Test Name:"})," ",t||"Untitled Test"]}),c.jsxs("span",{children:[c.jsx("strong",{children:"Questions:"})," ",o.testData.blocks.length," (auto-generated from blocks)"]})]})})}),c.jsx("div",{className:"flex gap-2",children:c.jsx(He,{onClick:D,disabled:a||o.ui.isLoading,variant:"primary",children:a||o.ui.isLoading?c.jsx(nr,{size:"sm"}):"Save Test"})})]})}),M(),c.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[c.jsx("div",{ref:h,className:"bg-white border overflow-auto",style:{minHeight:"400px",maxHeight:"calc(100vh - 200px)",height:"auto"},children:B()}),J]}),c.jsx("input",{ref:p,type:"file",accept:"image/*",onChange:E,className:"hidden"})]})},yh=b.createContext(null);function mq(t,e){return{getTheme:function(){return e??null}}}function Fo(){const t=b.useContext(yh);return t==null&&function(e,...r){const n=new URL("https://lexical.dev/docs/error"),s=new URLSearchParams;s.append("code",e);for(const a of r)s.append("v",a);throw n.search=s.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(8),t}function ct(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const qi=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,pq=qi&&"documentMode"in document?document.documentMode:null,mo=qi&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),Iu=qi&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),T1=!(!qi||!("InputEvent"in window)||pq)&&"getTargetRanges"in new window.InputEvent("input"),Ng=qi&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),Xf=qi&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,xq=qi&&/Android/.test(navigator.userAgent),SD=qi&&/^(?=.*Chrome).*/i.test(navigator.userAgent),N6=qi&&xq&&SD,E1=qi&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!SD;function kD(...t){const e=[];for(const r of t)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))e.push(n);return e}const yq=1,vq=3,wq=9,_q=11,Ou=0,CD=1,Yf=2,bq=0,Sq=1,kq=2,N1=4,A1=8,QC=128,Cq=1792|(112|(3|N1|A1)|QC),qC=1,ZC=2,eT=3,tT=4,rT=5,nT=6,_v=Ng||Xf||E1?"":"",pl=`

`,Tq=Iu?"":_v,Bu={bold:1,capitalize:1024,code:16,highlight:QC,italic:2,lowercase:256,strikethrough:N1,subscript:32,superscript:64,underline:A1,uppercase:512},Eq={directionless:1,unmergeable:2},A6={center:ZC,end:nT,justify:tT,left:qC,right:eT,start:rT},Nq={[ZC]:"center",[nT]:"end",[tT]:"justify",[qC]:"left",[eT]:"right",[rT]:"start"},Aq={normal:0,segmented:2,token:1},jq={[bq]:"normal",[kq]:"segmented",[Sq]:"token"},j6="$config";function TD(t,e,r,n,s,a){let i=t.getFirstChild();for(;i!==null;){const o=i.__key;i.__parent===e&&(Qe(i)&&TD(i,o,r,n,s,a),r.has(o)||a.delete(o),s.push(o)),i=i.getNextSibling()}}const Fq=100;let cS=!1,sT=0;function Pq(t){sT=t.timeStamp}function t2(t,e,r){const n=t.nodeName==="BR",s=e.__lexicalLineBreak;return s&&(t===s||n&&t.previousSibling===s)||n&&Fv(t,r)!==void 0}function Dq(t,e,r){const n=Yi(wi(r));let s=null,a=null;n!==null&&n.anchorNode===t&&(s=n.anchorOffset,a=n.focusOffset);const i=t.nodeValue;i!==null&&kT(e,i,s,a,!1)}function Rq(t,e,r){if(lt(t)){const n=t.anchor.getNode();if(n.is(r)&&t.format!==n.getFormat())return!1}return kl(e)&&r.isAttached()}function Mq(t,e,r,n){for(let s=t;s&&!MZ(s);s=wm(s)){const a=Fv(s,e);if(a!==void 0){const i=Hn(a,r);if(i)return Er(i)||!Qr(s)?void 0:[s,i]}else if(s===n)return[n,bR(r)]}}function ED(t,e,r){cS=!0;const n=performance.now()-sT>Fq;try{Pa(t,()=>{const s=wt()||function(h){return h.getEditorState().read(()=>{const p=wt();return p!==null?p.clone():null})}(t),a=new Map,i=t.getRootElement(),o=t._editorState,l=t._blockCursorElement;let u=!1,d="";for(let h=0;h<e.length;h++){const p=e[h],x=p.type,v=p.target,w=Mq(v,t,o,i);if(!w)continue;const[S,_]=w;if(x==="characterData")n&&_t(_)&&kl(v)&&Rq(s,v,_)&&Dq(v,_,t);else if(x==="childList"){u=!0;const y=p.addedNodes;for(let E=0;E<y.length;E++){const A=y[E],C=wR(A),F=A.parentNode;if(F!=null&&A!==l&&C===null&&!t2(A,F,t)){if(Iu){const D=(Qr(A)?A.innerText:null)||A.nodeValue;D&&(d+=D)}F.removeChild(A)}}const k=p.removedNodes,N=k.length;if(N>0){let E=0;for(let A=0;A<N;A++){const C=k[A];(t2(C,v,t)||l===C)&&(v.appendChild(C),E++)}N!==E&&a.set(S,_)}}}if(a.size>0)for(const[h,p]of a)p.reconcileObservedMutation(h,t);const g=r.takeRecords();if(g.length>0){for(let h=0;h<g.length;h++){const p=g[h],x=p.addedNodes,v=p.target;for(let w=0;w<x.length;w++){const S=x[w],_=S.parentNode;_==null||S.nodeName!=="BR"||t2(S,v,t)||_.removeChild(S)}}r.takeRecords()}s!==null&&(u&&Ns(s),Iu&&TR(t)&&s.insertRawText(d))})}finally{cS=!1}}function ND(t){const e=t._observer;e!==null&&ED(t,e.takeRecords(),e)}function AD(t){(function(e){sT===0&&wi(e).addEventListener("textInput",Pq,!0)})(t),t._observer=new MutationObserver((e,r)=>{ED(t,e,r)})}function Lq(t){const e=new Map,r=new Set;for(let n=typeof t=="function"?t:t.replace;n.prototype&&n.prototype.getType!==void 0;n=Object.getPrototypeOf(n)){const{ownNodeConfig:s}=AT(n);if(s&&s.stateConfigs)for(const a of s.stateConfigs){let i;"stateConfig"in a?(i=a.stateConfig,a.flat&&r.add(i.key)):i=a,e.set(i.key,i)}}return{flatKeys:r,sharedConfigMap:e}}let Iq=class jD{constructor(e,r,n=void 0,s=new Map,a=void 0){this.node=e,this.sharedNodeState=r,this.unknownState=n,this.knownState=s;const{sharedConfigMap:i}=this.sharedNodeState,o=a!==void 0?a:function(l,u,d){let g=d.size;if(u)for(const h in u){const p=l.get(h);p&&d.has(p)||g++}return g}(i,n,s);this.size=o}getValue(e){const r=this.knownState.get(e);if(r!==void 0)return r;this.sharedNodeState.sharedConfigMap.set(e.key,e);let n=e.defaultValue;if(this.unknownState&&e.key in this.unknownState){const s=this.unknownState[e.key];s!==void 0&&(n=e.parse(s)),this.updateFromKnown(e,n)}return n}getInternalState(){return[this.unknownState,this.knownState]}toJSON(){const e={...this.unknownState},r={};for(const[n,s]of this.knownState)n.isEqual(s,n.defaultValue)?delete e[n.key]:e[n.key]=n.unparse(s);for(const n of this.sharedNodeState.flatKeys)n in e&&(r[n]=e[n],delete e[n]);return F6(e)&&(r.$=e),r}getWritable(e){if(this.node===e)return this;const{sharedNodeState:r,unknownState:n}=this,s=new Map(this.knownState);return new jD(e,r,function(a,i,o){let l;if(o)for(const[u,d]of Object.entries(o)){const g=a.get(u);g?i.has(g)||i.set(g,g.parse(d)):(l=l||{},l[u]=d)}return l}(r.sharedConfigMap,s,n),s,this.size)}updateFromKnown(e,r){const n=e.key;this.sharedNodeState.sharedConfigMap.set(n,e);const{knownState:s,unknownState:a}=this;s.has(e)||a&&n in a||(a&&(delete a[n],this.unknownState=F6(a)),this.size++),s.set(e,r)}updateFromUnknown(e,r){const n=this.sharedNodeState.sharedConfigMap.get(e);n?this.updateFromKnown(n,n.parse(r)):(this.unknownState=this.unknownState||{},e in this.unknownState||this.size++,this.unknownState[e]=r)}updateFromJSON(e){const{knownState:r}=this;for(const n of r.keys())r.set(n,n.defaultValue);if(this.size=r.size,this.unknownState=void 0,e)for(const[n,s]of Object.entries(e))this.updateFromUnknown(n,s)}};function Oq(t){const e=t.getWritable(),r=e.__state?e.__state.getWritable(e):new Iq(e,FD(e));return e.__state=r,r}function FD(t){return t.__state?t.__state.sharedNodeState:xR(_m(),t.getType()).sharedNodeState}function F6(t){if(t)for(const e in t)return t}function P6(t,e,r){for(const[n,s]of e.knownState){if(t.has(n.key))continue;t.add(n.key);const a=r?r.getValue(n):n.defaultValue;if(a!==s&&!n.isEqual(a,s))return!0}return!1}function D6(t,e,r){const{unknownState:n}=e,s=r?r.unknownState:void 0;if(n){for(const[a,i]of Object.entries(n))if(!t.has(a)&&(t.add(a),i!==(s?s[a]:void 0)))return!0}return!1}function R6(t,e){const r=t.__state;return r&&r.node===t?r.getWritable(e):r}function M6(t,e){const r=t.__mode,n=t.__format,s=t.__style,a=e.__mode,i=e.__format,o=e.__style,l=t.__state,u=e.__state;return(r===null||r===a)&&(n===null||n===i)&&(s===null||s===o)&&(t.__state===null||l===u||function(d,g){if(d===g)return!0;if(d&&g&&d.size!==g.size)return!1;const h=new Set;return!(d&&P6(h,d,g)||g&&P6(h,g,d)||d&&D6(h,d,g)||g&&D6(h,g,d))}(l,u))}function L6(t,e){const r=t.mergeWithSibling(e),n=pn()._normalizedNodes;return n.add(t.__key),n.add(e.__key),r}function I6(t){let e,r,n=t;if(n.__text!==""||!n.isSimpleText()||n.isUnmergeable()){for(;(e=n.getPreviousSibling())!==null&&_t(e)&&e.isSimpleText()&&!e.isUnmergeable();){if(e.__text!==""){if(M6(e,n)){n=L6(e,n);break}break}e.remove()}for(;(r=n.getNextSibling())!==null&&_t(r)&&r.isSimpleText()&&!r.isUnmergeable();){if(r.__text!==""){if(M6(n,r)){n=L6(n,r);break}break}r.remove()}}else n.remove()}function j1(t){return O6(t.anchor),O6(t.focus),t}function O6(t){for(;t.type==="element";){const e=t.getNode(),r=t.offset;let n,s;if(r===e.getChildrenSize()?(n=e.getChildAtIndex(r-1),s=!0):(n=e.getChildAtIndex(r),s=!1),_t(n)){t.set(n.__key,s?n.getTextContentSize():0,"text",!0);break}if(!Qe(n))break;t.set(n.__key,s?n.getChildrenSize():0,"element",!0)}}let Uu,Hs,Ag,bv,uS,dS,$u,Hi,fS,jg,Jn="",ho=null,go="",Jo="",Gd=!1,F1=!1;function P1(t,e){const r=$u.get(t);if(e!==null){const n=pS(t);n.parentNode===e&&e.removeChild(n)}if(Hi.has(t)||Hs._keyToDOMMap.delete(t),Qe(r)){const n=R1(r,$u);hS(n,0,n.length-1,null)}r!==void 0&&CT(jg,Ag,bv,r,"destroyed")}function hS(t,e,r,n){let s=e;for(;s<=r;++s){const a=t[s];a!==void 0&&P1(a,n)}}function eu(t,e){t.setProperty("text-align",e)}const Bq="40px";function PD(t,e){const r=Uu.theme.indent;if(typeof r=="string"){const s=t.classList.contains(r);e>0&&!s?t.classList.add(r):e<1&&s&&t.classList.remove(r)}const n=getComputedStyle(t).getPropertyValue("--lexical-indent-base-value")||Bq;t.style.setProperty("padding-inline-start",e===0?"":`calc(${e} * ${n})`)}function DD(t,e){const r=t.style;e===0?eu(r,""):e===qC?eu(r,"left"):e===ZC?eu(r,"center"):e===eT?eu(r,"right"):e===tT?eu(r,"justify"):e===rT?eu(r,"start"):e===nT&&eu(r,"end")}function gS(t,e){const r=function(n){const s=n.__dir;if(s!==null)return s;if(es(n))return null;const a=n.getParentOrThrow();return es(a)&&a.__dir===null?"auto":null}(e);r!==null?t.dir=r:t.removeAttribute("dir")}function D1(t,e){const r=Hi.get(t);r===void 0&&ct(60);const n=r.createDOM(Uu,Hs);if(function(s,a,i){const o=i._keyToDOMMap;(function(l,u,d){const g=`__lexicalKey_${u._key}`;l[g]=d})(a,i,s),o.set(s,a)}(t,n,Hs),_t(r)?n.setAttribute("data-lexical-text","true"):Er(r)&&n.setAttribute("data-lexical-decorator","true"),Qe(r)){const s=r.__indent,a=r.__size;if(gS(n,r),s!==0&&PD(n,s),a!==0){const o=a-1;mS(R1(r,Hi),r,0,o,r.getDOMSlot(n))}const i=r.__format;i!==0&&DD(n,i),r.isInline()||RD(null,r,n),Pv(r)&&(Jn+=pl,Jo+=pl)}else{const s=r.getTextContent();if(Er(r)){const a=r.decorate(Hs,Uu);a!==null&&MD(t,a),n.contentEditable="false"}Jn+=s,Jo+=s}return e!==null&&e.insertChild(n),CT(jg,Ag,bv,r,"created"),n}function mS(t,e,r,n,s){const a=Jn;Jn="";let i=r;for(;i<=n;++i){D1(t[i],s);const o=Hi.get(t[i]);o!==null&&_t(o)&&(ho===null&&(ho=o.getFormat()),go===""&&(go=o.getStyle()))}Pv(e)&&(Jn+=pl),s.element.__lexicalTextContent=Jn,Jn=a+Jn}function B6(t,e){if(t){const r=t.__last;if(r){const n=e.get(r);if(n)return il(n)?"line-break":Er(n)&&n.isInline()?"decorator":null}return"empty"}return null}function RD(t,e,r){const n=B6(t,$u),s=B6(e,Hi);n!==s&&e.getDOMSlot(r).setManagedLineBreak(s)}function Uq(t,e,r){var n;ho=null,go="",function(s,a,i){const o=Jn,l=s.__size,u=a.__size;Jn="";const d=i.element;if(l===1&&u===1){const g=s.__first,h=a.__first;if(g===h)_0(g,d);else{const x=pS(g),v=D1(h,null);try{d.replaceChild(v,x)}catch(w){if(typeof w=="object"&&w!=null){const S=`${w.toString()} Parent: ${d.tagName}, new child: {tag: ${v.tagName} key: ${h}}, old child: {tag: ${x.tagName}, key: ${g}}.`;throw new Error(S)}throw w}P1(g,null)}const p=Hi.get(h);_t(p)&&(ho===null&&(ho=p.getFormat()),go===""&&(go=p.getStyle()))}else{const g=R1(s,$u),h=R1(a,Hi);if(g.length!==l&&ct(227),h.length!==u&&ct(228),l===0)u!==0&&mS(h,a,0,u-1,i);else if(u===0){if(l!==0){const p=i.after==null&&i.before==null&&i.element.__lexicalLineBreak==null;hS(g,0,l-1,p?null:d),p&&(d.textContent="")}}else(function(p,x,v,w,S,_){const y=w-1,k=S-1;let N,E,A=_.getFirstChild(),C=0,F=0;for(;C<=y&&F<=k;){const M=x[C],B=v[F];if(M===B)A=r2(_0(B,_.element)),C++,F++;else{N===void 0&&(N=new Set(x)),E===void 0&&(E=new Set(v));const X=E.has(M),z=N.has(B);if(X)if(z){const H=Wu(Hs,B);H===A?A=r2(_0(B,_.element)):(_.withBefore(A).insertChild(H),_0(B,_.element)),C++,F++}else D1(B,_.withBefore(A)),F++;else A=r2(pS(M)),P1(M,_.element),C++}const J=Hi.get(B);J!==null&&_t(J)&&(ho===null&&(ho=J.getFormat()),go===""&&(go=J.getStyle()))}const D=C>y,R=F>k;if(D&&!R){const M=v[k+1],B=M===void 0?null:Hs.getElementByKey(M);mS(v,p,F,k,_.withBefore(B))}else R&&!D&&hS(x,C,y,_.element)})(a,g,h,l,u,i)}Pv(a)&&(Jn+=pl),d.__lexicalTextContent=Jn,Jn=o+Jn}(t,e,e.getDOMSlot(r)),n=e,ho==null||ho===n.__textFormat||F1||n.setTextFormat(ho),function(s){go===""||go===s.__textStyle||F1||s.setTextStyle(go)}(e)}function R1(t,e){const r=[];let n=t.__first;for(;n!==null;){const s=e.get(n);s===void 0&&ct(101),r.push(n),n=s.__next}return r}function _0(t,e){const r=$u.get(t);let n=Hi.get(t);r!==void 0&&n!==void 0||ct(61);const s=Gd||dS.has(t)||uS.has(t),a=Wu(Hs,t);if(r===n&&!s){if(Qe(r)){const i=a.__lexicalTextContent;i!==void 0&&(Jn+=i,Jo+=i)}else{const i=r.getTextContent();Jo+=i,Jn+=i}return a}if(r!==n&&s&&CT(jg,Ag,bv,n,"updated"),n.updateDOM(r,a,Uu)){const i=D1(t,null);return e===null&&ct(62),e.replaceChild(i,a),P1(t,null),i}if(Qe(r)&&Qe(n)){const i=n.__indent;(Gd||i!==r.__indent)&&PD(a,i);const o=n.__format;if((Gd||o!==r.__format)&&DD(a,o),s&&(Uq(r,n,a),es(n)||n.isInline()||RD(r,n,a)),Pv(n)&&(Jn+=pl,Jo+=pl),(Gd||n.__dir!==r.__dir)&&(gS(a,n),es(n)&&!Gd))for(const l of n.getChildren())Qe(l)&&gS(Wu(Hs,l.getKey()),l)}else{const i=n.getTextContent();if(Er(n)){const o=n.decorate(Hs,Uu);o!==null&&MD(t,o)}Jn+=i,Jo+=i}if(!F1&&es(n)&&n.__cachedText!==Jo){const i=n.getWritable();i.__cachedText=Jo,n=i}return a}function MD(t,e){let r=Hs._pendingDecorators;const n=Hs._decorators;if(r===null){if(n[t]===e)return;r=_R(Hs)}r[t]=e}function r2(t){let e=t.nextSibling;return e!==null&&e===Hs._blockCursorElement&&(e=e.nextSibling),e}function $q(t,e,r,n,s,a){Jn="",Jo="",Gd=n===Yf,Hs=r,Uu=r._config,Ag=r._nodes,bv=Hs._listeners.mutation,uS=s,dS=a,$u=t._nodeMap,Hi=e._nodeMap,F1=e._readOnly,fS=new Map(r._keyToDOMMap);const i=new Map;return jg=i,_0("root",null),Hs=void 0,Ag=void 0,uS=void 0,dS=void 0,$u=void 0,Hi=void 0,Uu=void 0,fS=void 0,jg=void 0,i}function pS(t){const e=fS.get(t);return e===void 0&&ct(75,t),e}function Vt(t){return{type:t}}const LD=Vt("SELECTION_CHANGE_COMMAND"),Wq=Vt("SELECTION_INSERT_CLIPBOARD_NODES_COMMAND"),aT=Vt("CLICK_COMMAND"),Su=Vt("DELETE_CHARACTER_COMMAND"),kf=Vt("INSERT_LINE_BREAK_COMMAND"),Fg=Vt("INSERT_PARAGRAPH_COMMAND"),Cf=Vt("CONTROLLED_TEXT_INSERTION_COMMAND"),iT=Vt("PASTE_COMMAND"),xS=Vt("REMOVE_TEXT_COMMAND"),Pg=Vt("DELETE_WORD_COMMAND"),Dg=Vt("DELETE_LINE_COMMAND"),zs=Vt("FORMAT_TEXT_COMMAND"),oT=Vt("UNDO_COMMAND"),lT=Vt("REDO_COMMAND"),zq=Vt("KEYDOWN_COMMAND"),ID=Vt("KEY_ARROW_RIGHT_COMMAND"),Hq=Vt("MOVE_TO_END"),OD=Vt("KEY_ARROW_LEFT_COMMAND"),Gq=Vt("MOVE_TO_START"),BD=Vt("KEY_ARROW_UP_COMMAND"),UD=Vt("KEY_ARROW_DOWN_COMMAND"),M1=Vt("KEY_ENTER_COMMAND"),$D=Vt("KEY_SPACE_COMMAND"),WD=Vt("KEY_BACKSPACE_COMMAND"),zD=Vt("KEY_ESCAPE_COMMAND"),HD=Vt("KEY_DELETE_COMMAND"),GD=Vt("KEY_TAB_COMMAND"),Vq=Vt("INSERT_TAB_COMMAND"),Kq=Vt("INDENT_CONTENT_COMMAND"),U6=Vt("OUTDENT_CONTENT_COMMAND"),VD=Vt("DROP_COMMAND"),KD=Vt("FORMAT_ELEMENT_COMMAND"),XD=Vt("DRAGSTART_COMMAND"),YD=Vt("DRAGOVER_COMMAND"),Xq=Vt("DRAGEND_COMMAND"),Sv=Vt("COPY_COMMAND"),cT=Vt("CUT_COMMAND"),yS=Vt("SELECT_ALL_COMMAND"),Yq=Vt("CLEAR_EDITOR_COMMAND"),Jq=Vt("CLEAR_HISTORY_COMMAND"),Zp=Vt("CAN_REDO_COMMAND"),ex=Vt("CAN_UNDO_COMMAND"),Qq=Vt("FOCUS_COMMAND"),qq=Vt("BLUR_COMMAND"),Zq=Vt("KEY_MODIFIER_COMMAND"),zo=Object.freeze({}),vS=30,wS=[["keydown",function(t,e){if($0=t.timeStamp,JD=t.key,!e.isComposing()&&!Rt(e,zq,t)&&t.key!=null){if(n2&&gA(t))return Pa(e,()=>{tx(e,s2)}),n2=!1,void(s2="");if(function(r){return Fr(r,"ArrowRight",{shiftKey:"any"})}(t))Rt(e,ID,t);else if(function(r){return Fr(r,"ArrowRight",Vo)}(t))Rt(e,Hq,t);else if(function(r){return Fr(r,"ArrowLeft",{shiftKey:"any"})}(t))Rt(e,OD,t);else if(function(r){return Fr(r,"ArrowLeft",Vo)}(t))Rt(e,Gq,t);else if(function(r){return Fr(r,"ArrowUp",{altKey:"any",shiftKey:"any"})}(t))Rt(e,BD,t);else if(function(r){return Fr(r,"ArrowDown",{altKey:"any",shiftKey:"any"})}(t))Rt(e,UD,t);else if(function(r){return Fr(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any",shiftKey:!0})}(t))W0=!0,Rt(e,M1,t);else if(function(r){return r.key===" "}(t))Rt(e,$D,t);else if(function(r){return mo&&Fr(r,"o",{ctrlKey:!0})}(t))t.preventDefault(),W0=!0,Rt(e,kf,!0);else if(function(r){return Fr(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any"})}(t))W0=!1,Rt(e,M1,t);else if(function(r){return Fr(r,"Backspace",{shiftKey:"any"})||mo&&Fr(r,"h",{ctrlKey:!0})}(t))gA(t)?Rt(e,WD,t):(t.preventDefault(),Rt(e,Su,!0));else if(function(r){return r.key==="Escape"}(t))Rt(e,zD,t);else if(function(r){return Fr(r,"Delete",{})||mo&&Fr(r,"d",{ctrlKey:!0})}(t))(function(r){return r.key==="Delete"})(t)?Rt(e,HD,t):(t.preventDefault(),Rt(e,Su,!1));else if(function(r){return Fr(r,"Backspace",hA)}(t))t.preventDefault(),Rt(e,Pg,!0);else if(function(r){return Fr(r,"Delete",hA)}(t))t.preventDefault(),Rt(e,Pg,!1);else if(function(r){return mo&&Fr(r,"Backspace",{metaKey:!0})}(t))t.preventDefault(),Rt(e,Dg,!0);else if(function(r){return mo&&(Fr(r,"Delete",{metaKey:!0})||Fr(r,"k",{ctrlKey:!0}))}(t))t.preventDefault(),Rt(e,Dg,!1);else if(function(r){return Fr(r,"b",Vo)}(t))t.preventDefault(),Rt(e,zs,"bold");else if(function(r){return Fr(r,"u",Vo)}(t))t.preventDefault(),Rt(e,zs,"underline");else if(function(r){return Fr(r,"i",Vo)}(t))t.preventDefault(),Rt(e,zs,"italic");else if(function(r){return Fr(r,"Tab",{shiftKey:"any"})}(t))Rt(e,GD,t);else if(function(r){return Fr(r,"z",Vo)}(t))t.preventDefault(),Rt(e,oT,void 0);else if(function(r){return mo?Fr(r,"z",{metaKey:!0,shiftKey:!0}):Fr(r,"y",{ctrlKey:!0})||Fr(r,"z",{ctrlKey:!0,shiftKey:!0})}(t))t.preventDefault(),Rt(e,lT,void 0);else{const r=e._editorState._selection;r===null||lt(r)?mA(t)&&(t.preventDefault(),Rt(e,yS,t)):function(n){return Fr(n,"c",Vo)}(t)?(t.preventDefault(),Rt(e,Sv,t)):function(n){return Fr(n,"x",Vo)}(t)?(t.preventDefault(),Rt(e,cT,t)):mA(t)&&(t.preventDefault(),Rt(e,yS,t))}(function(r){return r.ctrlKey||r.shiftKey||r.altKey||r.metaKey})(t)&&Rt(e,Zq,t)}}],["pointerdown",function(t,e){const r=t.target,n=t.pointerType;bh(r)&&n!=="touch"&&n!=="pen"&&t.button===0&&Pa(e,()=>{uA(r)||(bS=!0)})}],["compositionstart",function(t,e){Pa(e,()=>{const r=wt();if(lt(r)&&!e.isComposing()){const n=r.anchor,s=r.anchor.getNode();Ss(n.key),(t.timeStamp<$0+vS||n.type==="element"||!r.isCollapsed()||s.getFormat()!==r.format||_t(s)&&s.getStyle()!==r.style)&&Rt(e,Cf,Tq)}})}],["compositionend",function(t,e){Iu?u0=!0:Xf||!Ng&&!E1?Pa(e,()=>{tx(e,t.data)}):(n2=!0,s2=t.data)}],["input",function(t,e){t.stopPropagation(),Pa(e,()=>{if(Qr(t.target)&&uA(t.target))return;const r=wt(),n=t.data,s=tR(t);if(n!=null&&lt(r)&&ZD(r,s,n,t.timeStamp,!1)){u0&&(tx(e,n),u0=!1);const a=r.anchor.getNode(),i=Yi(wi(e));if(i===null)return;const o=r.isBackward(),l=o?r.anchor.offset:r.focus.offset,u=o?r.focus.offset:r.anchor.offset;T1&&!r.isCollapsed()&&_t(a)&&i.anchorNode!==null&&a.getTextContent().slice(0,l)+n+a.getTextContent().slice(l+u)===CR(i.anchorNode)||Rt(e,Cf,n);const d=n.length;Iu&&d>1&&t.inputType==="insertCompositionText"&&!e.isComposing()&&(r.anchor.offset-=d),Ng||Xf||E1||!e.isComposing()||($0=0,Ss(null))}else ST(!1,e,n!==null?n:void 0),u0&&(tx(e,n||void 0),u0=!1);(function(){bs();const a=pn();ND(a)})()},{event:t}),Vd=null}],["click",function(t,e){Pa(e,()=>{const r=wt(),n=Yi(wi(e)),s=_h();if(n){if(lt(r)){const a=r.anchor,i=a.getNode();if(a.type==="element"&&a.offset===0&&r.isCollapsed()&&!es(i)&&an().getChildrenSize()===1&&i.getTopLevelElementOrThrow().isEmpty()&&s!==null&&r.is(s))n.removeAllRanges(),r.dirty=!0;else if(t.detail===3&&!r.isCollapsed()&&i!==r.focus.getNode()){const o=function(l,u){let d=l;for(;d!==an()&&d!=null;){if(u(d))return d;d=d.getParent()}return null}(i,l=>Qe(l)&&!l.isInline());Qe(o)&&o.select(0)}}else if(t.pointerType==="touch"||t.pointerType==="pen"){const a=n.anchorNode;(Qr(a)||kl(a))&&Ns(fT(s,n,e,t))}}Rt(e,aT,t)})}],["cut",zo],["copy",zo],["dragstart",zo],["dragover",zo],["dragend",zo],["paste",zo],["focus",zo],["blur",zo],["drop",zo]];T1&&wS.push(["beforeinput",(t,e)=>function(r,n){const s=r.inputType,a=tR(r);s==="deleteCompositionText"||Iu&&TR(n)||s!=="insertCompositionText"&&Pa(n,()=>{const i=wt();if(s==="deleteContentBackward"){if(i===null){const p=_h();if(!lt(p))return;Ns(p.clone())}if(lt(i)){const p=i.anchor.key===i.focus.key;if(o=r.timeStamp,JD==="MediaLast"&&o<$0+vS&&n.isComposing()&&p){if(Ss(null),$0=0,setTimeout(()=>{Pa(n,()=>{Ss(null)})},vS),lt(i)){const x=i.anchor.getNode();x.markDirty(),_t(x)||ct(142),eR(i,x)}}else{Ss(null),r.preventDefault();const x=i.anchor.getNode(),v=x.getTextContent(),w=x.canInsertTextAfter(),S=i.anchor.offset===0&&i.focus.offset===v.length;let _=N6&&p&&!S&&w;if(_&&i.isCollapsed()&&(_=!Er(ES(i.anchor,!0))),!_){Rt(n,Su,!0);const y=wt();N6&&lt(y)&&y.isCollapsed()&&(ou=y,setTimeout(()=>ou=null))}}return}}var o;if(!lt(i))return;const l=r.data;Vd!==null&&ST(!1,n,Vd),i.dirty&&Vd===null||!i.isCollapsed()||es(i.anchor.getNode())||a===null||i.applyDOMRange(a),Vd=null;const u=i.anchor,d=i.focus,g=u.getNode(),h=d.getNode();if(s!=="insertText"&&s!=="insertTranspose")switch(r.preventDefault(),s){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":Rt(n,Cf,r);break;case"insertFromComposition":Ss(null),Rt(n,Cf,r);break;case"insertLineBreak":Ss(null),Rt(n,kf,!1);break;case"insertParagraph":Ss(null),W0&&!Xf?(W0=!1,Rt(n,kf,!1)):Rt(n,Fg,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":Rt(n,iT,r);break;case"deleteByComposition":(function(p,x){return p!==x||Qe(p)||Qe(x)||!ku(p)||!ku(x)})(g,h)&&Rt(n,xS,r);break;case"deleteByDrag":case"deleteByCut":Rt(n,xS,r);break;case"deleteContent":Rt(n,Su,!1);break;case"deleteWordBackward":Rt(n,Pg,!0);break;case"deleteWordForward":Rt(n,Pg,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":Rt(n,Dg,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":Rt(n,Dg,!1);break;case"formatStrikeThrough":Rt(n,zs,"strikethrough");break;case"formatBold":Rt(n,zs,"bold");break;case"formatItalic":Rt(n,zs,"italic");break;case"formatUnderline":Rt(n,zs,"underline");break;case"historyUndo":Rt(n,oT,void 0);break;case"historyRedo":Rt(n,lT,void 0)}else{if(l===`
`)r.preventDefault(),Rt(n,kf,!1);else if(l===pl)r.preventDefault(),Rt(n,Fg,void 0);else if(l==null&&r.dataTransfer){const p=r.dataTransfer.getData("text/plain");r.preventDefault(),i.insertRawText(p)}else l!=null&&ZD(i,a,l,r.timeStamp,!0)?(r.preventDefault(),Rt(n,Cf,l)):Vd=l;QD=r.timeStamp}})}(t,e)]);let $0=0,JD=null,QD=0,Vd=null;const L1=new WeakMap;let _S=!1,bS=!1,W0=!1,u0=!1,n2=!1,s2="",ou=null,qD=[0,"",0,"root",0];function ZD(t,e,r,n,s){const a=t.anchor,i=t.focus,o=a.getNode(),l=pn(),u=Yi(wi(l)),d=u!==null?u.anchorNode:null,g=a.key,h=l.getElementByKey(g),p=r.length;return g!==i.key||!_t(o)||(!s&&(!T1||QD<n+50)||o.isDirty()&&p<2||SR(r))&&a.offset!==i.offset&&!o.isComposing()||Xo(o)||o.isDirty()&&p>1||(s||!T1)&&h!==null&&!o.isComposing()&&d!==Jf(h)||u!==null&&e!==null&&(!e.collapsed||e.startContainer!==u.anchorNode||e.startOffset!==u.anchorOffset)||o.getFormat()!==t.format||o.getStyle()!==t.style||function(x,v){if(v.isSegmented())return!0;if(!x.isCollapsed())return!1;const w=x.anchor.offset,S=v.getParentOrThrow(),_=ku(v);return w===0?!v.canInsertTextBefore()||!S.canInsertTextBefore()&&!v.isComposing()||_||function(y){const k=y.getPreviousSibling();return(_t(k)||Qe(k)&&k.isInline())&&!k.canInsertTextAfter()}(v):w===v.getTextContentSize()&&(!v.canInsertTextAfter()||!S.canInsertTextAfter()&&!v.isComposing()||_)}(t,o)}function $6(t,e){return kl(t)&&t.nodeValue!==null&&e!==0&&e!==t.nodeValue.length}function W6(t,e,r){const{anchorNode:n,anchorOffset:s,focusNode:a,focusOffset:i}=t;_S&&(_S=!1,$6(n,s)&&$6(a,i)&&!ou)||Pa(e,()=>{if(!r)return void Ns(null);if(!vm(e,n,a))return;let o=wt();if(ou&&lt(o)&&o.isCollapsed()){const l=o.anchor,u=ou.anchor;(l.key===u.key&&l.offset===u.offset+1||l.offset===1&&u.getNode().is(l.getNode().getPreviousSibling()))&&(o=ou.clone(),Ns(o))}if(ou=null,lt(o)){const l=o.anchor,u=l.getNode();if(o.isCollapsed()){t.type==="Range"&&t.anchorNode===t.focusNode&&(o.dirty=!0);const d=wi(e).event,g=d?d.timeStamp:performance.now(),[h,p,x,v,w]=qD,S=an(),_=e.isComposing()===!1&&S.getTextContent()==="";if(g<w+200&&l.offset===x&&l.key===v)Bx(o,h,p);else if(l.type==="text")_t(u)||ct(141),eR(o,u);else if(l.type==="element"&&!_){Qe(u)||ct(259);const y=l.getNode();y.isEmpty()?function(k,N){const E=N.getTextFormat(),A=N.getTextStyle();Bx(k,E,A)}(o,y):Bx(o,0,"")}}else{const d=l.key,g=o.focus.key,h=o.getNodes(),p=h.length,x=o.isBackward(),v=x?i:s,w=x?s:i,S=x?g:d,_=x?d:g;let y=Cq,k=!1;for(let N=0;N<p;N++){const E=h[N],A=E.getTextContentSize();if(_t(E)&&A!==0&&!(N===0&&E.__key===S&&v===A||N===p-1&&E.__key===_&&w===0)&&(k=!0,y&=E.getFormat(),y===0))break}o.format=k?y:0}}Rt(e,LD,void 0)})}function Bx(t,e,r){t.format===e&&t.style===r||(t.format=e,t.style=r,t.dirty=!0)}function eR(t,e){Bx(t,e.getFormat(),e.getStyle())}function tR(t){if(!t.getTargetRanges)return null;const e=t.getTargetRanges();return e.length===0?null:e[0]}function tx(t,e){const r=t._compositionKey;if(Ss(null),r!==null&&e!=null){if(e===""){const n=Hn(r),s=Jf(t.getElementByKey(r));return void(s!==null&&s.nodeValue!==null&&_t(n)&&kT(n,s.nodeValue,null,null,!0))}if(e[e.length-1]===`
`){const n=wt();if(lt(n)){const s=n.focus;return n.anchor.set(s.key,s.offset,s.type),void Rt(t,M1,null)}}}ST(!0,t,e)}function rR(t){let e=t.__lexicalEventHandles;return e===void 0&&(e=[],t.__lexicalEventHandles=e),e}const Tf=new Map;function nR(t){const e=PZ(t.target);if(e===null)return;const r=yR(e.anchorNode);if(r===null)return;bS&&(bS=!1,Pa(r,()=>{const l=_h(),u=e.anchorNode;(Qr(u)||kl(u))&&Ns(fT(l,e,r,t))}));const n=bT(r),s=n[n.length-1],a=s._key,i=Tf.get(a),o=i||s;o!==r&&W6(e,o,!1),W6(e,r,!0),r!==s?Tf.set(a,r):i&&Tf.delete(a)}function z6(t){t._lexicalHandled=!0}function H6(t){return t._lexicalHandled===!0}function eZ(t){const e=t.ownerDocument,r=L1.get(e);if(r===void 0)return;const n=r-1;n>=0||ct(164),L1.set(e,n),n===0&&e.removeEventListener("selectionchange",nR);const s=jv(t);_T(s)?(function(i){if(i._parentEditor!==null){const o=bT(i),l=o[o.length-1]._key;Tf.get(l)===i&&Tf.delete(l)}else Tf.delete(i._key)}(s),t.__lexicalEditor=null):s&&ct(198);const a=rR(t);for(let i=0;i<a.length;i++)a[i]();t.__lexicalEventHandles=[]}function SS(t,e,r){bs();const n=t.__key,s=t.getParent();if(s===null)return;const a=function(o){const l=wt();if(!lt(l)||!Qe(o))return l;const{anchor:u,focus:d}=l,g=u.getNode(),h=d.getNode();return NS(g,o)&&u.set(o.__key,0,"element"),NS(h,o)&&d.set(o.__key,0,"element"),l}(t);let i=!1;if(lt(a)&&e){const o=a.anchor,l=a.focus;o.key===n&&(O1(o,t,s,t.getPreviousSibling(),t.getNextSibling()),i=!0),l.key===n&&(O1(l,t,s,t.getPreviousSibling(),t.getNextSibling()),i=!0)}else Ls(a)&&e&&t.isSelected()&&t.selectPrevious();if(lt(a)&&e&&!i){const o=t.getIndexWithinParent();Cu(t),I1(a,s,o,-1)}else Cu(t);r||ia(s)||s.canBeEmpty()||!s.isEmpty()||SS(s,e),e&&a&&es(s)&&s.isEmpty()&&s.selectEnd()}class vh{static getType(){const{ownNodeType:e}=AT(this);return e===void 0&&ct(64,this.name),e}static clone(e){ct(65,this.name)}$config(){return{}}config(e,r){const n=r.extends||Object.getPrototypeOf(this.constructor);return Object.assign(r,{extends:n,type:e}),{[e]:r}}afterCloneFrom(e){this.__key===e.__key?(this.__parent=e.__parent,this.__next=e.__next,this.__prev=e.__prev,this.__state=e.__state):e.__state&&(this.__state=e.__state.getWritable(this))}constructor(e){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,Object.defineProperty(this,"__state",{configurable:!0,enumerable:!1,value:void 0,writable:!0}),kZ(this,e)}getType(){return this.__type}isInline(){ct(137,this.constructor.name)}isAttached(){let e=this.__key;for(;e!==null;){if(e==="root")return!0;const r=Hn(e);if(r===null)break;e=r.__parent}return!1}isSelected(e){const r=e||wt();if(r==null)return!1;const n=r.getNodes().some(s=>s.__key===this.__key);if(_t(this))return n;if(lt(r)&&r.anchor.type==="element"&&r.focus.type==="element"){if(r.isCollapsed())return!1;const s=this.getParent();if(Er(this)&&this.isInline()&&s){const a=r.isBackward()?r.focus:r.anchor;if(s.is(a.getNode())&&a.offset===s.getChildrenSize()&&this.is(s.getLastChild()))return!1}}return n}getKey(){return this.__key}getIndexWithinParent(){const e=this.getParent();if(e===null)return-1;let r=e.getFirstChild(),n=0;for(;r!==null;){if(this.is(r))return n;n++,r=r.getNextSibling()}return-1}getParent(){const e=this.getLatest().__parent;return e===null?null:Hn(e)}getParentOrThrow(){const e=this.getParent();return e===null&&ct(66,this.__key),e}getTopLevelElement(){let e=this;for(;e!==null;){const r=e.getParent();if(ia(r))return Qe(e)||e===this&&Er(e)||ct(194),e;e=r}return null}getTopLevelElementOrThrow(){const e=this.getTopLevelElement();return e===null&&ct(67,this.__key),e}getParents(){const e=[];let r=this.getParent();for(;r!==null;)e.push(r),r=r.getParent();return e}getParentKeys(){const e=[];let r=this.getParent();for(;r!==null;)e.push(r.__key),r=r.getParent();return e}getPreviousSibling(){const e=this.getLatest().__prev;return e===null?null:Hn(e)}getPreviousSiblings(){const e=[],r=this.getParent();if(r===null)return e;let n=r.getFirstChild();for(;n!==null&&!n.is(this);)e.push(n),n=n.getNextSibling();return e}getNextSibling(){const e=this.getLatest().__next;return e===null?null:Hn(e)}getNextSiblings(){const e=[];let r=this.getNextSibling();for(;r!==null;)e.push(r),r=r.getNextSibling();return e}getCommonAncestor(e){const r=Qe(this)?this:this.getParent(),n=Qe(e)?e:e.getParent(),s=r&&n?$x(r,n):null;return s?s.commonAncestor:null}is(e){return e!=null&&this.__key===e.__key}isBefore(e){const r=$x(this,e);return r!==null&&(r.type==="descendant"||(r.type==="branch"?jR(r)===-1:(r.type!=="same"&&r.type!=="ancestor"&&ct(279),!1)))}isParentOf(e){const r=$x(this,e);return r!==null&&r.type==="ancestor"}getNodesBetween(e){const r=this.isBefore(e),n=[],s=new Set;let a=this;for(;a!==null;){const i=a.__key;if(s.has(i)||(s.add(i),n.push(a)),a===e)break;const o=Qe(a)?r?a.getFirstChild():a.getLastChild():null;if(o!==null){a=o;continue}const l=r?a.getNextSibling():a.getPreviousSibling();if(l!==null){a=l;continue}const u=a.getParentOrThrow();if(s.has(u.__key)||n.push(u),u===e)break;let d=null,g=u;do{if(g===null&&ct(68),d=r?g.getNextSibling():g.getPreviousSibling(),g=g.getParent(),g===null)break;d!==null||s.has(g.__key)||n.push(g)}while(d===null);a=d}return r||n.reverse(),n}isDirty(){const e=pn()._dirtyLeaves;return e!==null&&e.has(this.__key)}getLatest(){const e=Hn(this.__key);return e===null&&ct(113),e}getWritable(){bs();const e=Ic(),r=pn(),n=e._nodeMap,s=this.__key,a=this.getLatest(),i=r._cloneNotNeeded,o=wt();if(o!==null&&o.setCachedNodes(null),i.has(s))return $1(a),a;const l=ET(a);return i.add(s),$1(l),n.set(s,l),l}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(e,r){ct(70)}updateDOM(e,r,n){ct(71)}exportDOM(e){return{element:this.createDOM(e._config,e)}}exportJSON(){const e=this.__state?this.__state.toJSON():void 0;return{type:this.__type,version:1,...e}}static importJSON(e){ct(18,this.name)}updateFromJSON(e){return function(r,n){const s=r.getWritable(),a=n.$;let i=a;for(const o of FD(s).flatKeys)o in n&&(i!==void 0&&i!==a||(i={...a}),i[o]=n[o]);return(s.__state||i)&&Oq(r).updateFromJSON(i),s}(this,e)}static transform(){return null}remove(e){SS(this,!0,e)}replace(e,r){bs();let n=wt();n!==null&&(n=n.clone()),u2(this,e);const s=this.getLatest(),a=this.__key,i=e.__key,o=e.getWritable(),l=this.getParentOrThrow().getWritable(),u=l.__size;Cu(o);const d=s.getPreviousSibling(),g=s.getNextSibling(),h=s.__prev,p=s.__next,x=s.__parent;if(SS(s,!1,!0),d===null?l.__first=i:d.getWritable().__next=i,o.__prev=h,g===null?l.__last=i:g.getWritable().__prev=i,o.__next=p,o.__parent=x,l.__size=u,r&&(Qe(this)&&Qe(o)||ct(139),this.getChildren().forEach(v=>{o.append(v)})),lt(n)){Ns(n);const v=n.anchor,w=n.focus;v.key===a&&X6(v,o),w.key===a&&X6(w,o)}return Jl()===a&&Ss(i),o}insertAfter(e,r=!0){bs(),u2(this,e);const n=this.getWritable(),s=e.getWritable(),a=s.getParent(),i=wt();let o=!1,l=!1;if(a!==null){const p=e.getIndexWithinParent();if(Cu(s),lt(i)){const x=a.__key,v=i.anchor,w=i.focus;o=v.type==="element"&&v.key===x&&v.offset===p+1,l=w.type==="element"&&w.key===x&&w.offset===p+1}}const u=this.getNextSibling(),d=this.getParentOrThrow().getWritable(),g=s.__key,h=n.__next;if(u===null?d.__last=g:u.getWritable().__prev=g,d.__size++,n.__next=g,s.__next=h,s.__prev=n.__key,s.__parent=n.__parent,r&&lt(i)){const p=this.getIndexWithinParent();I1(i,d,p+1);const x=d.__key;o&&i.anchor.set(x,p+2,"element"),l&&i.focus.set(x,p+2,"element")}return e}insertBefore(e,r=!0){bs(),u2(this,e);const n=this.getWritable(),s=e.getWritable(),a=s.__key;Cu(s);const i=this.getPreviousSibling(),o=this.getParentOrThrow().getWritable(),l=n.__prev,u=this.getIndexWithinParent();i===null?o.__first=a:i.getWritable().__next=a,o.__size++,n.__prev=a,s.__prev=l,s.__next=n.__key,s.__parent=n.__parent;const d=wt();return r&&lt(d)&&I1(d,this.getParentOrThrow(),u),e}isParentRequired(){return!1}createParentElementNode(){return Jr()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(e,r){bs();const n=this.getPreviousSibling(),s=this.getParentOrThrow();if(n===null)return s.select(0,0);if(Qe(n))return n.select();if(!_t(n)){const a=n.getIndexWithinParent()+1;return s.select(a,a)}return n.select(e,r)}selectNext(e,r){bs();const n=this.getNextSibling(),s=this.getParentOrThrow();if(n===null)return s.select();if(Qe(n))return n.select(0,0);if(!_t(n)){const a=n.getIndexWithinParent();return s.select(a,a)}return n.select(e,r)}markDirty(){this.getWritable()}reconcileObservedMutation(e,r){this.markDirty()}}class gm extends vh{static getType(){return"linebreak"}static clone(e){return new gm(e.__key)}constructor(e){super(e)}getTextContent(){return`
`}createDOM(){return document.createElement("br")}updateDOM(){return!1}isInline(){return!0}static importDOM(){return{br:e=>function(r){const n=r.parentElement;if(n!==null&&W1(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&rx(s)){const a=n.lastChild;if(a===r||a.previousSibling===r&&rx(a))return!0}}return!1}(e)||function(r){const n=r.parentElement;if(n!==null&&W1(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&rx(s))return!1;const a=n.lastChild;if(a===r||a.previousSibling===r&&rx(a))return!0}return!1}(e)?null:{conversion:tZ,priority:0}}}static importJSON(e){return Eo().updateFromJSON(e)}}function tZ(t){return{node:Eo()}}function Eo(){return ua(new gm)}function il(t){return t instanceof gm}function rx(t){return kl(t)&&/^( |\t|\r?\n)+$/.test(t.textContent||"")}function a2(t,e){return 16&e?"code":e&QC?"mark":32&e?"sub":64&e?"sup":null}function i2(t,e){return 1&e?"strong":2&e?"em":"span"}function sR(t,e,r,n,s){const a=n.classList;let i=Ef(s,"base");i!==void 0&&a.add(...i),i=Ef(s,"underlineStrikethrough");let o=!1;const l=e&A1&&e&N1;i!==void 0&&(r&A1&&r&N1?(o=!0,l||a.add(...i)):l&&a.remove(...i));for(const u in Bu){const d=Bu[u];if(i=Ef(s,u),i!==void 0)if(r&d){if(o&&(u==="underline"||u==="strikethrough")){e&d&&a.remove(...i);continue}e&d&&(!l||u!=="underline")&&u!=="strikethrough"||a.add(...i)}else e&d&&a.remove(...i)}}function aR(t,e,r){const n=e.firstChild,s=r.isComposing(),a=t+(s?_v:"");if(n==null)e.textContent=a;else{const i=n.nodeValue;if(i!==a)if(s||Iu){const[o,l,u]=function(d,g){const h=d.length,p=g.length;let x=0,v=0;for(;x<h&&x<p&&d[x]===g[x];)x++;for(;v+x<h&&v+x<p&&d[h-v-1]===g[p-v-1];)v++;return[x,h-x-v,g.slice(x,p-v)]}(i,a);l!==0&&n.deleteData(o,l),n.insertData(o,u)}else n.nodeValue=a}}function G6(t,e,r,n,s,a){aR(s,t,e);const i=a.theme.text;i!==void 0&&sR(0,0,n,t,i)}function nx(t,e){const r=document.createElement(e);return r.appendChild(t),r}class Lc extends vh{static getType(){return"text"}static clone(e){return new Lc(e.__text,e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__text=e.__text,this.__format=e.__format,this.__style=e.__style,this.__mode=e.__mode,this.__detail=e.__detail}constructor(e="",r){super(r),this.__text=e,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const e=this.getLatest();return jq[e.__mode]}getStyle(){return this.getLatest().__style}isToken(){return this.getLatest().__mode===1}isComposing(){return this.__key===Jl()}isSegmented(){return this.getLatest().__mode===2}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(e){const r=Bu[e];return!!(this.getFormat()&r)}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(){return this.getLatest().__text}getFormatFlags(e,r){return U1(this.getLatest().__format,e,r)}canHaveFormat(){return!0}isInline(){return!0}createDOM(e,r){const n=this.__format,s=a2(0,n),a=i2(0,n),i=s===null?a:s,o=document.createElement(i);let l=o;this.hasFormat("code")&&o.setAttribute("spellcheck","false"),s!==null&&(l=document.createElement(a),o.appendChild(l)),G6(l,this,0,n,this.__text,e);const u=this.__style;return u!==""&&(o.style.cssText=u),o}updateDOM(e,r,n){const s=this.__text,a=e.__format,i=this.__format,o=a2(0,a),l=a2(0,i),u=i2(0,a),d=i2(0,i);if((o===null?u:o)!==(l===null?d:l))return!0;if(o===l&&u!==d){const v=r.firstChild;v==null&&ct(48);const w=document.createElement(d);return G6(w,this,0,i,s,n),r.replaceChild(w,v),!1}let g=r;l!==null&&o!==null&&(g=r.firstChild,g==null&&ct(49)),aR(s,g,this);const h=n.theme.text;h!==void 0&&a!==i&&sR(0,a,i,g,h);const p=e.__style,x=this.__style;return p!==x&&(r.style.cssText=x),!1}static importDOM(){return{"#text":()=>({conversion:aZ,priority:0}),b:()=>({conversion:nZ,priority:0}),code:()=>({conversion:Ho,priority:0}),em:()=>({conversion:Ho,priority:0}),i:()=>({conversion:Ho,priority:0}),mark:()=>({conversion:Ho,priority:0}),s:()=>({conversion:Ho,priority:0}),span:()=>({conversion:rZ,priority:0}),strong:()=>({conversion:Ho,priority:0}),sub:()=>({conversion:Ho,priority:0}),sup:()=>({conversion:Ho,priority:0}),u:()=>({conversion:Ho,priority:0})}}static importJSON(e){return _n().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setTextContent(e.text).setFormat(e.format).setDetail(e.detail).setMode(e.mode).setStyle(e.style)}exportDOM(e){let{element:r}=super.exportDOM(e);return Qr(r)||ct(132),r.style.whiteSpace="pre-wrap",this.hasFormat("lowercase")?r.style.textTransform="lowercase":this.hasFormat("uppercase")?r.style.textTransform="uppercase":this.hasFormat("capitalize")&&(r.style.textTransform="capitalize"),this.hasFormat("bold")&&(r=nx(r,"b")),this.hasFormat("italic")&&(r=nx(r,"i")),this.hasFormat("strikethrough")&&(r=nx(r,"s")),this.hasFormat("underline")&&(r=nx(r,"u")),{element:r}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),...super.exportJSON()}}selectionTransform(e,r){}setFormat(e){const r=this.getWritable();return r.__format=typeof e=="string"?Bu[e]:e,r}setDetail(e){const r=this.getWritable();return r.__detail=typeof e=="string"?Eq[e]:e,r}setStyle(e){const r=this.getWritable();return r.__style=e,r}toggleFormat(e){const r=U1(this.getFormat(),e,null);return this.setFormat(r)}toggleDirectionless(){const e=this.getWritable();return e.__detail^=1,e}toggleUnmergeable(){const e=this.getWritable();return e.__detail^=2,e}setMode(e){const r=Aq[e];if(this.__mode===r)return this;const n=this.getWritable();return n.__mode=r,n}setTextContent(e){if(this.__text===e)return this;const r=this.getWritable();return r.__text=e,r}select(e,r){bs();let n=e,s=r;const a=wt(),i=this.getTextContent(),o=this.__key;if(typeof i=="string"){const l=i.length;n===void 0&&(n=l),s===void 0&&(s=l)}else n=0,s=0;if(!lt(a))return lR(o,n,o,s,"text","text");{const l=Jl();l!==a.anchor.key&&l!==a.focus.key||Ss(o),a.setTextNodeRange(this,n,this,s)}return a}selectStart(){return this.select(0,0)}selectEnd(){const e=this.getTextContentSize();return this.select(e,e)}spliceText(e,r,n,s){const a=this.getWritable(),i=a.__text,o=n.length;let l=e;l<0&&(l=o+l,l<0&&(l=0));const u=wt();if(s&&lt(u)){const g=e+o;u.setTextNodeRange(a,g,a,g)}const d=i.slice(0,l)+n+i.slice(l+r);return a.__text=d,a}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...e){bs();const r=this.getLatest(),n=r.getTextContent();if(n==="")return[];const s=r.__key,a=Jl(),i=n.length;e.sort((C,F)=>C-F),e.push(i);const o=[],l=e.length;for(let C=0,F=0;C<i&&F<=l;F++){const D=e[F];D>C&&(o.push(n.slice(C,D)),C=D)}const u=o.length;if(u===1)return[r];const d=o[0],g=r.getParent();let h;const p=r.getFormat(),x=r.getStyle(),v=r.__detail;let w=!1,S=null,_=null;const y=wt();if(lt(y)){const[C,F]=y.isBackward()?[y.focus,y.anchor]:[y.anchor,y.focus];C.type==="text"&&C.key===s&&(S=C),F.type==="text"&&F.key===s&&(_=F)}r.isSegmented()?(h=_n(d),h.__format=p,h.__style=x,h.__detail=v,h.__state=R6(r,h),w=!0):h=r.setTextContent(d);const k=[h];for(let C=1;C<u;C++){const F=_n(o[C]);F.__format=p,F.__style=x,F.__detail=v,F.__state=R6(r,F);const D=F.__key;a===s&&Ss(D),k.push(F)}const N=S?S.offset:null,E=_?_.offset:null;let A=0;for(const C of k){if(!S&&!_)break;const F=A+C.getTextContentSize();if(S!==null&&N!==null&&N<=F&&N>=A&&(S.set(C.getKey(),N-A,"text"),N<F&&(S=null)),_!==null&&E!==null&&E<=F&&E>=A){_.set(C.getKey(),E-A,"text");break}A=F}if(g!==null){(function(D){const R=D.getPreviousSibling(),M=D.getNextSibling();R!==null&&$1(R),M!==null&&$1(M)})(this);const C=g.getWritable(),F=this.getIndexWithinParent();w?(C.splice(F,0,k),this.remove()):C.splice(F,1,k),lt(y)&&I1(y,g,F,u-1)}return k}mergeWithSibling(e){const r=e===this.getPreviousSibling();r||e===this.getNextSibling()||ct(50);const n=this.__key,s=e.__key,a=this.__text,i=a.length;Jl()===s&&Ss(n);const o=wt();if(lt(o)){const g=o.anchor,h=o.focus;g!==null&&g.key===s&&tA(g,r,n,e,i),h!==null&&h.key===s&&tA(h,r,n,e,i)}const l=e.__text,u=r?l+a:a+l;this.setTextContent(u);const d=this.getWritable();return e.remove(),d}isTextEntity(){return!1}}function rZ(t){return{forChild:uT(t.style),node:null}}function nZ(t){const e=t,r=e.style.fontWeight==="normal";return{forChild:uT(e.style,r?void 0:"bold"),node:null}}const V6=new WeakMap;function sZ(t){if(!Qr(t))return!1;if(t.nodeName==="PRE")return!0;const e=t.style.whiteSpace;return typeof e=="string"&&e.startsWith("pre")}function aZ(t){const e=t;t.parentElement===null&&ct(129);let r=e.textContent||"";if(function(n){let s,a=n.parentNode;const i=[n];for(;a!==null&&(s=V6.get(a))===void 0&&!sZ(a);)i.push(a),a=a.parentNode;const o=s===void 0?a:s;for(let l=0;l<i.length;l++)V6.set(i[l],o);return o}(e)!==null){const n=r.split(/(\r?\n|\t)/),s=[],a=n.length;for(let i=0;i<a;i++){const o=n[i];o===`
`||o===`\r
`?s.push(Eo()):o==="	"?s.push(wh()):o!==""&&s.push(_n(o))}return{node:s}}if(r=r.replace(/\r/g,"").replace(/[ \t\n]+/g," "),r==="")return{node:null};if(r[0]===" "){let n=e,s=!0;for(;n!==null&&(n=K6(n,!1))!==null;){const a=n.textContent||"";if(a.length>0){/[ \t\n]$/.test(a)&&(r=r.slice(1)),s=!1;break}}s&&(r=r.slice(1))}if(r[r.length-1]===" "){let n=e,s=!0;for(;n!==null&&(n=K6(n,!0))!==null;)if((n.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){s=!1;break}s&&(r=r.slice(0,r.length-1))}return r===""?{node:null}:{node:_n(r)}}function K6(t,e){let r=t;for(;;){let n;for(;(n=e?r.nextSibling:r.previousSibling)===null;){const a=r.parentElement;if(a===null)return null;r=a}if(r=n,Qr(r)){const a=r.style.display;if(a===""&&!FS(r)||a!==""&&!a.startsWith("inline"))return null}let s=r;for(;(s=e?r.firstChild:r.lastChild)!==null;)r=s;if(kl(r))return r;if(r.nodeName==="BR")return null}}const iZ={code:"code",em:"italic",i:"italic",mark:"highlight",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function Ho(t){const e=iZ[t.nodeName.toLowerCase()];return e===void 0?{node:null}:{forChild:uT(t.style,e),node:null}}function _n(t=""){return ua(new Lc(t))}function _t(t){return t instanceof Lc}function uT(t,e){const r=t.fontWeight,n=t.textDecoration.split(" "),s=r==="700"||r==="bold",a=n.includes("line-through"),i=t.fontStyle==="italic",o=n.includes("underline"),l=t.verticalAlign;return u=>(_t(u)&&(s&&!u.hasFormat("bold")&&u.toggleFormat("bold"),a&&!u.hasFormat("strikethrough")&&u.toggleFormat("strikethrough"),i&&!u.hasFormat("italic")&&u.toggleFormat("italic"),o&&!u.hasFormat("underline")&&u.toggleFormat("underline"),l!=="sub"||u.hasFormat("subscript")||u.toggleFormat("subscript"),l!=="super"||u.hasFormat("superscript")||u.toggleFormat("superscript"),e&&!u.hasFormat(e)&&u.toggleFormat(e)),u)}class mm extends Lc{static getType(){return"tab"}static clone(e){return new mm(e.__key)}constructor(e){super("	",e),this.__detail=2}static importDOM(){return null}createDOM(e){const r=super.createDOM(e),n=Ef(e.theme,"tab");return n!==void 0&&r.classList.add(...n),r}static importJSON(e){return wh().updateFromJSON(e)}setTextContent(e){return e!=="	"&&e!==""&&ct(126),super.setTextContent("	")}spliceText(e,r,n,s){return n===""&&r===0||n==="	"&&r===1||ct(286),this}setDetail(e){return e!==2&&ct(127),this}setMode(e){return e!=="normal"&&ct(128),this}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function wh(){return ua(new mm)}function kv(t){return t instanceof mm}class oZ{constructor(e,r,n){this._selection=null,this.key=e,this.offset=r,this.type=n}is(e){return this.key===e.key&&this.offset===e.offset&&this.type===e.type}isBefore(e){return this.key===e.key?this.offset<e.offset:AR(gi(xl(this,"next")),gi(xl(e,"next")))<0}getNode(){const e=Hn(this.key);return e===null&&ct(20),e}set(e,r,n,s){const a=this._selection,i=this.key;s&&this.key===e&&this.offset===r&&this.type===n||(this.key=e,this.offset=r,this.type=n,pm()||(Jl()===i&&Ss(e),a!==null&&(a.setCachedNodes(null),a.dirty=!0)))}}function No(t,e,r){return new oZ(t,e,r)}function o2(t,e){let r=e.__key,n=t.offset,s="element";if(_t(e)){s="text";const a=e.getTextContentSize();n>a&&(n=a)}else if(!Qe(e)){const a=e.getNextSibling();if(_t(a))r=a.__key,n=0,s="text";else{const i=e.getParent();i&&(r=i.__key,n=e.getIndexWithinParent()+1)}}t.set(r,n,s)}function X6(t,e){if(Qe(e)){const r=e.getLastDescendant();Qe(r)||_t(r)?o2(t,r):o2(t,e)}else o2(t,e)}class Cv{constructor(e){this._cachedNodes=null,this._nodes=e,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){if(!Ls(e))return!1;const r=this._nodes,n=e._nodes;return r.size===n.size&&Array.from(r).every(s=>n.has(s))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(e){this.dirty=!0,this._nodes.add(e),this._cachedNodes=null}delete(e){this.dirty=!0,this._nodes.delete(e),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(e){return this._nodes.has(e)}clone(){return new Cv(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(e){}insertText(){}insertNodes(e){const r=this.getNodes(),n=r.length,s=r[n-1];let a;if(_t(s))a=s.select();else{const i=s.getIndexWithinParent()+1;a=s.getParentOrThrow().select(i,i)}a.insertNodes(e);for(let i=0;i<n;i++)r[i].remove()}getNodes(){const e=this._cachedNodes;if(e!==null)return e;const r=this._nodes,n=[];for(const s of r){const a=Hn(s);a!==null&&n.push(a)}return pm()||(this._cachedNodes=n),n}getTextContent(){const e=this.getNodes();let r="";for(let n=0;n<e.length;n++)r+=e[n].getTextContent();return r}deleteNodes(){const e=this.getNodes();if((wt()||_h())===this&&e[0]){const r=Ts(e[0],"next");GZ(vc(r,r))}for(const r of e)r.remove()}}function lt(t){return t instanceof fd}class fd{constructor(e,r,n,s){this.anchor=e,this.focus=r,e._selection=this,r._selection=this,this._cachedNodes=null,this.format=n,this.style=s,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){return!!lt(e)&&this.anchor.is(e.anchor)&&this.focus.is(e.focus)&&this.format===e.format&&this.style===e.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const e=this._cachedNodes;if(e!==null)return e;const r=function(n){const s=[],[a,i]=n.getTextSlices();a&&s.push(a.caret.origin);const o=new Set,l=new Set;for(const u of n)if(To(u)){const{origin:d}=u;s.length===0?o.add(d):(l.add(d),s.push(d))}else{const{origin:d}=u;Qe(d)&&l.has(d)||s.push(d)}if(i&&s.push(i.caret.origin),Gu(n.focus)&&Qe(n.focus.origin)&&n.focus.getNodeAtCaret()===null)for(let u=_i(n.focus.origin,"previous");To(u)&&o.has(u.origin)&&!u.origin.isEmpty()&&u.origin.is(s[s.length-1]);u=PT(u))o.delete(u.origin),s.pop();for(;s.length>1;){const u=s[s.length-1];if(!Qe(u)||l.has(u)||u.isEmpty()||o.has(u))break;s.pop()}if(s.length===0&&n.isCollapsed()){const u=gi(n.anchor),d=gi(n.anchor.getFlipped()),g=p=>cc(p)?p.origin:p.getNodeAtCaret(),h=g(u)||g(d)||(n.anchor.getNodeAtCaret()?u.origin:d.origin);s.push(h)}return s}(PR(_A(this),"next"));return pm()||(this._cachedNodes=r),r}setTextNodeRange(e,r,n,s){this.anchor.set(e.__key,r,"text"),this.focus.set(n.__key,s,"text")}getTextContent(){const e=this.getNodes();if(e.length===0)return"";const r=e[0],n=e[e.length-1],s=this.anchor,a=this.focus,i=s.isBefore(a),[o,l]=kS(this);let u="",d=!0;for(let g=0;g<e.length;g++){const h=e[g];if(Qe(h)&&!h.isInline())d||(u+=`
`),d=!h.isEmpty();else if(d=!1,_t(h)){let p=h.getTextContent();h===r?h===n?s.type==="element"&&a.type==="element"&&a.offset!==s.offset||(p=o<l?p.slice(o,l):p.slice(l,o)):p=i?p.slice(o):p.slice(l):h===n&&(p=i?p.slice(0,l):p.slice(0,o)),u+=p}else!Er(h)&&!il(h)||h===n&&this.isCollapsed()||(u+=h.getTextContent())}return u}applyDOMRange(e){const r=pn(),n=r.getEditorState()._selection,s=oR(e.startContainer,e.startOffset,e.endContainer,e.endOffset,r,n);if(s===null)return;const[a,i]=s;this.anchor.set(a.key,a.offset,a.type,!0),this.focus.set(i.key,i.offset,i.type,!0),j1(this)}clone(){const e=this.anchor,r=this.focus;return new fd(No(e.key,e.offset,e.type),No(r.key,r.offset,r.type),this.format,this.style)}toggleFormat(e){this.format=U1(this.format,e,null),this.dirty=!0}setFormat(e){this.format=e,this.dirty=!0}setStyle(e){this.style=e,this.dirty=!0}hasFormat(e){const r=Bu[e];return!!(this.format&r)}insertRawText(e){const r=e.split(/(\r?\n|\t)/),n=[],s=r.length;for(let a=0;a<s;a++){const i=r[a];i===`
`||i===`\r
`?n.push(Eo()):i==="	"?n.push(wh()):n.push(_n(i))}this.insertNodes(n)}insertText(e){const r=this.anchor,n=this.focus,s=this.format,a=this.style;let i=r,o=n;!this.isCollapsed()&&n.isBefore(r)&&(i=n,o=r),i.type==="element"&&function(w,S,_,y){const k=w.getNode(),N=k.getChildAtIndex(w.offset),E=_n();if(E.setFormat(_),E.setStyle(y),xT(N))N.splice(0,0,[E]);else{const A=es(k)?Jr().append(E):E;N===null?k.append(A):N.insertBefore(A)}w.is(S)&&S.set(E.__key,0,"text"),w.set(E.__key,0,"text")}(i,o,s,a),o.type==="element"&&Ku(o,gi(xl(o,"next")));const l=i.offset;let u=o.offset;const d=this.getNodes(),g=d.length;let h=d[0];_t(h)||ct(26);const p=h.getTextContent().length,x=h.getParentOrThrow();let v=d[g-1];if(g===1&&o.type==="element"&&(u=p,o.set(i.key,u,"text")),this.isCollapsed()&&l===p&&(Xo(h)||!h.canInsertTextAfter()||!x.canInsertTextAfter()&&h.getNextSibling()===null)){let w=h.getNextSibling();if(_t(w)&&w.canInsertTextBefore()&&!Xo(w)||(w=_n(),w.setFormat(s),w.setStyle(a),x.canInsertTextAfter()?h.insertAfter(w):x.insertAfter(w)),w.select(0,0),h=w,e!=="")return void this.insertText(e)}else if(this.isCollapsed()&&l===0&&(Xo(h)||!h.canInsertTextBefore()||!x.canInsertTextBefore()&&h.getPreviousSibling()===null)){let w=h.getPreviousSibling();if(_t(w)&&!Xo(w)||(w=_n(),w.setFormat(s),x.canInsertTextBefore()?h.insertBefore(w):x.insertBefore(w)),w.select(),h=w,e!=="")return void this.insertText(e)}else if(h.isSegmented()&&l!==p){const w=_n(h.getTextContent());w.setFormat(s),h.replace(w),h=w}else if(!this.isCollapsed()&&e!==""){const w=v.getParent();if(!x.canInsertTextBefore()||!x.canInsertTextAfter()||Qe(w)&&(!w.canInsertTextBefore()||!w.canInsertTextAfter()))return this.insertText(""),iR(this.anchor,this.focus,null),void this.insertText(e)}if(g===1){if(ku(h)){const y=_n(e);return y.select(),void h.replace(y)}const w=h.getFormat(),S=h.getStyle();if(l!==u||w===s&&S===a){if(kv(h)){const y=_n(e);return y.setFormat(s),y.setStyle(a),y.select(),void h.replace(y)}}else{if(h.getTextContent()!==""){const y=_n(e);if(y.setFormat(s),y.setStyle(a),y.select(),l===0)h.insertBefore(y,!1);else{const[k]=h.splitText(l);k.insertAfter(y,!1)}return void(y.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=e.length))}h.setFormat(s),h.setStyle(a)}const _=u-l;h=h.spliceText(l,_,e,!0),h.getTextContent()===""?h.remove():this.anchor.type==="text"&&(h.isComposing()?this.anchor.offset-=e.length:(this.format=w,this.style=S))}else{const w=new Set([...h.getParentKeys(),...v.getParentKeys()]),S=Qe(h)?h:h.getParentOrThrow();let _=Qe(v)?v:v.getParentOrThrow(),y=v;if(!S.is(_)&&_.isInline())do y=_,_=_.getParentOrThrow();while(_.isInline());if(o.type==="text"&&(u!==0||v.getTextContent()==="")||o.type==="element"&&v.getIndexWithinParent()<u)if(_t(v)&&!ku(v)&&u!==v.getTextContentSize()){if(v.isSegmented()){const C=_n(v.getTextContent());v.replace(C),v=C}es(o.getNode())||o.type!=="text"||(v=v.spliceText(0,u,"")),w.add(v.__key)}else{const C=v.getParentOrThrow();C.canBeEmpty()||C.getChildrenSize()!==1?v.remove():C.remove()}else w.add(v.__key);const k=_.getChildren(),N=new Set(d),E=S.is(_),A=S.isInline()&&h.getNextSibling()===null?S:h;for(let C=k.length-1;C>=0;C--){const F=k[C];if(F.is(h)||Qe(F)&&F.isParentOf(h))break;F.isAttached()&&(!N.has(F)||F.is(y)?E||A.insertAfter(F,!1):F.remove())}if(!E){let C=_,F=null;for(;C!==null;){const D=C.getChildren(),R=D.length;(R===0||D[R-1].is(F))&&(w.delete(C.__key),F=C),C=C.getParent()}}if(ku(h))if(l===p)h.select();else{const C=_n(e);C.select(),h.replace(C)}else h=h.spliceText(l,p-l,e,!0),h.getTextContent()===""?h.remove():h.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=e.length);for(let C=1;C<g;C++){const F=d[C],D=F.__key;w.has(D)||F.remove()}}}removeText(){const e=wt()===this;Wx(this,VZ(_A(this))),e&&wt()!==this&&Ns(this)}formatText(e,r=null){if(this.isCollapsed())return this.toggleFormat(e),void Ss(null);const n=this.getNodes(),s=[];for(const k of n)_t(k)&&s.push(k);const a=k=>{n.forEach(N=>{if(Qe(N)){const E=N.getFormatFlags(e,k);N.setTextFormat(E)}})},i=s.length;if(i===0)return this.toggleFormat(e),Ss(null),void a(r);const o=this.anchor,l=this.focus,u=this.isBackward(),d=u?l:o,g=u?o:l;let h=0,p=s[0],x=d.type==="element"?0:d.offset;if(d.type==="text"&&x===p.getTextContentSize()&&(h=1,p=s[1],x=0),p==null)return;const v=p.getFormatFlags(e,r);a(v);const w=i-1;let S=s[w];const _=g.type==="text"?g.offset:S.getTextContentSize();if(p.is(S)){if(x===_)return;if(Xo(p)||x===0&&_===p.getTextContentSize())p.setFormat(v);else{const k=p.splitText(x,_),N=x===0?k[0]:k[1];N.setFormat(v),d.type==="text"&&d.set(N.__key,0,"text"),g.type==="text"&&g.set(N.__key,_-x,"text")}return void(this.format=v)}x===0||Xo(p)||([,p]=p.splitText(x),x=0),p.setFormat(v);const y=S.getFormatFlags(e,v);_>0&&(_===S.getTextContentSize()||Xo(S)||([S]=S.splitText(_)),S.setFormat(y));for(let k=h+1;k<w;k++){const N=s[k],E=N.getFormatFlags(e,y);N.setFormat(E)}d.type==="text"&&d.set(p.__key,x,"text"),g.type==="text"&&g.set(S.__key,_,"text"),this.format=v|y}insertNodes(e){if(e.length===0)return;if(this.isCollapsed()||this.removeText(),this.anchor.key==="root"){this.insertParagraph();const x=wt();return lt(x)||ct(134),x.insertNodes(e)}const r=(this.isBackward()?this.focus:this.anchor).getNode(),n=f2(r,di),s=e[e.length-1];if(Qe(n)&&"__language"in n){if("__language"in e[0])this.insertText(e[0].getTextContent());else{const x=l2(this);n.splice(x,0,e),s.selectEnd()}return}if(!e.some(x=>(Qe(x)||Er(x))&&!x.isInline())){Qe(n)||ct(211,r.constructor.name,r.getType());const x=l2(this);return n.splice(x,0,e),void s.selectEnd()}const a=function(x){const v=Jr();let w=null;for(let S=0;S<x.length;S++){const _=x[S],y=il(_);if(y||Er(_)&&_.isInline()||Qe(_)&&_.isInline()||_t(_)||_.isParentRequired()){if(w===null&&(w=_.createParentElementNode(),v.append(w),y))continue;w!==null&&w.append(_)}else v.append(_),w=null}return v}(e),i=a.getLastDescendant(),o=a.getChildren(),l=!Qe(n)||!n.isEmpty()?this.insertParagraph():null,u=o[o.length-1];let d=o[0];var g;Qe(g=d)&&di(g)&&!g.isEmpty()&&Qe(n)&&(!n.isEmpty()||n.canMergeWhenEmpty())&&(Qe(n)||ct(211,r.constructor.name,r.getType()),n.append(...d.getChildren()),d=o[1]),d&&(n===null&&ct(212,r.constructor.name,r.getType()),function(x,v,w){const S=v.getParentOrThrow().getLastChild();let _=v;const y=[v];for(;_!==S;)_.getNextSibling()||ct(140),_=_.getNextSibling(),y.push(_);let k=x;for(const N of y)k=k.insertAfter(N)}(n,d));const h=f2(i,di);l&&Qe(h)&&(l.canMergeWhenEmpty()||di(u))&&(h.append(...l.getChildren()),l.remove()),Qe(n)&&n.isEmpty()&&n.remove(),i.selectEnd();const p=Qe(n)?n.getLastChild():null;il(p)&&h!==n&&p.remove()}insertParagraph(){if(this.anchor.key==="root"){const i=Jr();return an().splice(this.anchor.offset,0,[i]),i.select(),i}const e=l2(this),r=f2(this.anchor.getNode(),di);Qe(r)||ct(213);const n=r.getChildAtIndex(e),s=n?[n,...n.getNextSiblings()]:[],a=r.insertNewAfter(this,!1);return a?(a.append(...s),a.selectStart(),a):null}insertLineBreak(e){const r=Eo();if(this.insertNodes([r]),e){const n=r.getParentOrThrow(),s=r.getIndexWithinParent();n.select(s,s)}}extract(){const e=this.getNodes(),r=e.length,n=r-1,s=this.anchor,a=this.focus;let i=e[0],o=e[n];const[l,u]=kS(this);if(r===0)return[];if(r===1){if(_t(i)&&!this.isCollapsed()){const g=l>u?u:l,h=l>u?l:u,p=i.splitText(g,h),x=g===0?p[0]:p[1];return x!=null?[x]:[]}return[i]}const d=s.isBefore(a);if(_t(i)){const g=d?l:u;g===i.getTextContentSize()?e.shift():g!==0&&([,i]=i.splitText(g),e[0]=i)}if(_t(o)){const g=o.getTextContent().length,h=d?u:l;h===0?e.pop():h!==g&&([o]=o.splitText(h),e[n]=o)}return e}modify(e,r,n){if(rA(this,e,r,n))return;const s=e==="move",a=pn(),i=Yi(wi(a));if(!i)return;const o=a._blockCursorElement,l=a._rootElement,u=this.focus.getNode();if(l===null||o===null||!Qe(u)||u.isInline()||u.canBeEmpty()||AS(o,a,l),this.dirty){let d=Wu(a,this.anchor.key),g=Wu(a,this.focus.key);this.anchor.type==="text"&&(d=Jf(d)),this.focus.type==="text"&&(g=Jf(g)),d&&g&&cR(i,d,this.anchor.offset,g,this.focus.offset)}if(function(d,g,h,p){d.modify(g,h,p)}(i,e,r?"backward":"forward",n),i.rangeCount>0){const d=i.getRangeAt(0),g=this.anchor.getNode(),h=es(g)?g:jZ(g);if(this.applyDOMRange(d),this.dirty=!0,!s){const p=this.getNodes(),x=[];let v=!1;for(let w=0;w<p.length;w++){const S=p[w];NS(S,h)?x.push(S):v=!0}if(v&&x.length>0)if(r){const w=x[0];Qe(w)?w.selectStart():w.getParentOrThrow().selectStart()}else{const w=x[x.length-1];Qe(w)?w.selectEnd():w.getParentOrThrow().selectEnd()}i.anchorNode===d.startContainer&&i.anchorOffset===d.startOffset||function(w){const S=w.focus,_=w.anchor,y=_.key,k=_.offset,N=_.type;_.set(S.key,S.offset,S.type,!0),S.set(y,k,N,!0)}(this)}}n==="lineboundary"&&rA(this,e,r,n,"decorators")}forwardDeletion(e,r,n){if(!n&&(e.type==="element"&&Qe(r)&&e.offset===r.getChildrenSize()||e.type==="text"&&e.offset===r.getTextContentSize())){const s=r.getParent(),a=r.getNextSibling()||(s===null?null:s.getNextSibling());if(Qe(a)&&a.isShadowRoot())return!0}return!1}deleteCharacter(e){const r=this.isCollapsed();if(this.isCollapsed()){const n=this.anchor;let s=n.getNode();if(this.forwardDeletion(n,s,e))return;const a=RT(xl(n,e?"previous":"next"));if(a.getTextSlices().every(o=>o===null||o.distance===0)){let o={type:"initial"};for(const l of a.iterNodeCarets("shadowRoot"))if(To(l)){if(!l.origin.isInline()){if(l.origin.isShadowRoot()){if(o.type==="merge-block")break;if(Qe(a.anchor.origin)&&a.anchor.origin.isEmpty()){const u=gi(l);Wx(this,vc(u,u)),a.anchor.origin.remove()}return}o.type!=="merge-next-block"&&o.type!=="merge-block"||(o={block:o.block,caret:l,type:"merge-block"})}}else{if(o.type==="merge-block")break;if(Gu(l)){if(Qe(l.origin)){if(l.origin.isInline()){if(!l.origin.isParentOf(a.anchor.origin))break}else o={block:l.origin,type:"merge-next-block"};continue}if(Er(l.origin)){if(!l.origin.isIsolated())if(o.type==="merge-next-block"&&(l.origin.isKeyboardSelectable()||!l.origin.isInline())&&Qe(a.anchor.origin)&&a.anchor.origin.isEmpty()){a.anchor.origin.remove();const u=dT();u.add(l.origin.getKey()),Ns(u)}else l.origin.remove();return}break}}if(o.type==="merge-block"){const{caret:l,block:u}=o;return Wx(this,vc(!l.origin.isEmpty()&&u.isEmpty()?LT(Ts(u,l.direction)):a.anchor,l)),this.removeText()}}const i=this.focus;if(this.modify("extend",e,"character"),this.isCollapsed()){if(e&&n.offset===0&&J6(this,n.getNode()))return}else{const o=i.type==="text"?i.getNode():null;if(s=n.type==="text"?n.getNode():null,o!==null&&o.isSegmented()){const l=i.offset,u=o.getTextContentSize();if(o.is(s)||e&&l!==u||!e&&l!==0)return void Q6(o,e,l)}else if(s!==null&&s.isSegmented()){const l=n.offset,u=s.getTextContentSize();if(s.is(o)||e&&l!==0||!e&&l!==u)return void Q6(s,e,l)}(function(l,u){const d=l.anchor,g=l.focus,h=d.getNode(),p=g.getNode();if(h===p&&d.type==="text"&&g.type==="text"){const x=d.offset,v=g.offset,w=x<v,S=w?x:v,_=w?v:x,y=_-1;S!==y&&function(k){return!(SR(k)||lZ(k))}(h.getTextContent().slice(S,_))&&(u?g.set(g.key,y,g.type):d.set(d.key,y,d.type))}})(this,e)}}if(this.removeText(),e&&!r&&this.isCollapsed()&&this.anchor.type==="element"&&this.anchor.offset===0){const n=this.anchor.getNode();n.isEmpty()&&es(n.getParent())&&n.getPreviousSibling()===null&&J6(this,n)}}deleteLine(e){this.isCollapsed()&&this.modify("extend",e,"lineboundary"),this.isCollapsed()?this.deleteCharacter(e):this.removeText()}deleteWord(e){if(this.isCollapsed()){const r=this.anchor,n=r.getNode();if(this.forwardDeletion(r,n,e))return;this.modify("extend",e,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function Ls(t){return t instanceof Cv}function Y6(t){const e=t.offset;if(t.type==="text")return e;const r=t.getNode();return e===r.getChildrenSize()?r.getTextContent().length:0}function kS(t){const e=t.getStartEndPoints();if(e===null)return[0,0];const[r,n]=e;return r.type==="element"&&n.type==="element"&&r.key===n.key&&r.offset===n.offset?[0,0]:[Y6(r),Y6(n)]}function J6(t,e){for(let r=e;r;r=r.getParent()){if(Qe(r)){if(r.collapseAtStart(t))return!0;if(ia(r))break}if(r.getPreviousSibling())break}return!1}const lZ=(()=>{try{const t=new RegExp("\\p{Emoji}","u"),e=t.test.bind(t);if(e("")&&e("#")&&e(""))return e}catch{}return()=>!1})();function Q6(t,e,r){const n=t,s=n.getTextContent().split(/(?=\s)/g),a=s.length;let i=0,o=0;for(let u=0;u<a;u++){const d=u===a-1;if(o=i,i+=s[u].length,e&&i===r||i>r||d){s.splice(u,1),d&&(o=void 0);break}}const l=s.join("").trim();l===""?n.remove():(n.setTextContent(l),n.select(o,o))}function q6(t,e,r,n){let s,a=e;if(Qr(t)){let i=!1;const o=t.childNodes,l=o.length,u=n._blockCursorElement;a===l&&(i=!0,a=l-1);let d=o[a],g=!1;if(d===u)d=o[a+1],g=!0;else if(u!==null){const h=u.parentNode;t===h&&e>Array.prototype.indexOf.call(h.children,u)&&a--}if(s=gf(d),_t(s))a=uc(s,i?"next":"previous");else{let h=gf(t);if(h===null)return null;if(Qe(h)){const p=n.getElementByKey(h.getKey());p===null&&ct(214),[h,a]=h.getDOMSlot(p).resolveChildIndex(h,p,t,e),Qe(h)||ct(215),i&&a>=h.getChildrenSize()&&(a=Math.max(0,h.getChildrenSize()-1));let v=h.getChildAtIndex(a);if(Qe(v)&&function(w,S,_){const y=w.getParent();return _===null||y===null||!y.canBeEmpty()||y!==_.getNode()}(v,0,r)){const w=i?v.getLastDescendant():v.getFirstDescendant();w===null?h=v:(v=w,h=Qe(v)?v:v.getParentOrThrow()),a=0}_t(v)?(s=v,h=null,a=uc(v,i?"next":"previous")):v!==h&&i&&!g&&(Qe(h)||ct(216),a=Math.min(h.getChildrenSize(),a+1))}else{const p=h.getIndexWithinParent();a=e===0&&Er(h)&&gf(t)===h?p:p+1,h=h.getParentOrThrow()}if(Qe(h))return No(h.__key,a,"element")}}else s=gf(t);return _t(s)?No(s.__key,uc(s,a,"clamp"),"text"):null}function Z6(t,e,r){const n=t.offset,s=t.getNode();if(n===0){const a=s.getPreviousSibling(),i=s.getParent();if(e){if((r||!e)&&a===null&&Qe(i)&&i.isInline()){const o=i.getPreviousSibling();_t(o)&&t.set(o.__key,o.getTextContent().length,"text")}}else Qe(a)&&!r&&a.isInline()?t.set(a.__key,a.getChildrenSize(),"element"):_t(a)&&t.set(a.__key,a.getTextContent().length,"text")}else if(n===s.getTextContent().length){const a=s.getNextSibling(),i=s.getParent();if(e&&Qe(a)&&a.isInline())t.set(a.__key,0,"element");else if((r||e)&&a===null&&Qe(i)&&i.isInline()&&!i.canInsertTextAfter()){const o=i.getNextSibling();_t(o)&&t.set(o.__key,0,"text")}}}function iR(t,e,r){if(t.type==="text"&&e.type==="text"){const n=t.isBefore(e),s=t.is(e);Z6(t,n,s),Z6(e,!n,s),s&&e.set(t.key,t.offset,t.type);const a=pn();if(a.isComposing()&&a._compositionKey!==t.key&&lt(r)){const i=r.anchor,o=r.focus;t.set(i.key,i.offset,i.type,!0),e.set(o.key,o.offset,o.type,!0)}}}function oR(t,e,r,n,s,a){if(t===null||r===null||!vm(s,t,r))return null;const i=q6(t,e,lt(a)?a.anchor:null,s);if(i===null)return null;const o=q6(r,n,lt(a)?a.focus:null,s);if(o===null)return null;if(i.type==="element"&&o.type==="element"){const l=gf(t),u=gf(r);if(Er(l)&&Er(u))return null}return iR(i,o,a),[i,o]}function CS(t){return Qe(t)&&!t.isInline()}function lR(t,e,r,n,s,a){const i=Ic(),o=new fd(No(t,e,s),No(r,n,a),0,"");return o.dirty=!0,i._selection=o,o}function Tv(){const t=No("root",0,"element"),e=No("root",0,"element");return new fd(t,e,0,"")}function dT(){return new Cv(new Set)}function fT(t,e,r,n){const s=r._window;if(s===null)return null;const a=n||s.event,i=a?a.type:void 0,o=i==="selectionchange",l=!cS&&(o||i==="beforeinput"||i==="compositionstart"||i==="compositionend"||i==="click"&&a&&a.detail===3||i==="drop"||i===void 0);let u,d,g,h;if(lt(t)&&!l)return t.clone();if(e===null)return null;if(u=e.anchorNode,d=e.focusNode,g=e.anchorOffset,h=e.focusOffset,o&&lt(t)&&!vm(r,u,d))return t.clone();const p=oR(u,g,d,h,r,t);if(p===null)return null;const[x,v]=p;return new fd(x,v,lt(t)?t.format:0,lt(t)?t.style:"")}function wt(){return Ic()._selection}function _h(){return pn()._editorState._selection}function I1(t,e,r,n=1){const s=t.anchor,a=t.focus,i=s.getNode(),o=a.getNode();if(!e.is(i)&&!e.is(o))return;const l=e.__key;if(t.isCollapsed()){const u=s.offset;if(r<=u&&n>0||r<u&&n<0){const d=Math.max(0,u+n);s.set(l,d,"element"),a.set(l,d,"element"),eA(t)}}else{const u=t.isBackward(),d=u?a:s,g=d.getNode(),h=u?s:a,p=h.getNode();if(e.is(g)){const x=d.offset;(r<=x&&n>0||r<x&&n<0)&&d.set(l,Math.max(0,x+n),"element")}if(e.is(p)){const x=h.offset;(r<=x&&n>0||r<x&&n<0)&&h.set(l,Math.max(0,x+n),"element")}}eA(t)}function eA(t){const e=t.anchor,r=e.offset,n=t.focus,s=n.offset,a=e.getNode(),i=n.getNode();if(t.isCollapsed()){if(!Qe(a))return;const o=a.getChildrenSize(),l=r>=o,u=l?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(_t(u)){let d=0;l&&(d=u.getTextContentSize()),e.set(u.__key,d,"text"),n.set(u.__key,d,"text")}}else{if(Qe(a)){const o=a.getChildrenSize(),l=r>=o,u=l?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(_t(u)){let d=0;l&&(d=u.getTextContentSize()),e.set(u.__key,d,"text")}}if(Qe(i)){const o=i.getChildrenSize(),l=s>=o,u=l?i.getChildAtIndex(o-1):i.getChildAtIndex(s);if(_t(u)){let d=0;l&&(d=u.getTextContentSize()),n.set(u.__key,d,"text")}}}}function O1(t,e,r,n,s){let a=null,i=0,o=null;n!==null?(a=n.__key,_t(n)?(i=n.getTextContentSize(),o="text"):Qe(n)&&(i=n.getChildrenSize(),o="element")):s!==null&&(a=s.__key,_t(s)?o="text":Qe(s)&&(o="element")),a!==null&&o!==null?t.set(a,i,o):(i=e.getIndexWithinParent(),i===-1&&(i=r.getChildrenSize()),t.set(r.__key,i,"element"))}function tA(t,e,r,n,s){t.type==="text"?t.set(r,t.offset+(e?0:s),"text"):t.offset>n.getIndexWithinParent()&&t.set(t.key,t.offset-1,"element")}function cR(t,e,r,n,s){try{t.setBaseAndExtent(e,r,n,s)}catch{}}function cZ(t,e,r,n,s,a,i){const o=n.anchorNode,l=n.focusNode,u=n.anchorOffset,d=n.focusOffset,g=document.activeElement;if(s.has(mR)&&g!==a||g!==null&&wT(g))return;if(!lt(e))return void(t!==null&&vm(r,o,l)&&n.removeAllRanges());const h=e.anchor,p=e.focus,x=h.key,v=p.key,w=Wu(r,x),S=Wu(r,v),_=h.offset,y=p.offset,k=e.format,N=e.style,E=e.isCollapsed();let A=w,C=S,F=!1;if(h.type==="text"){A=Jf(w);const X=h.getNode();F=X.getFormat()!==k||X.getStyle()!==N}else lt(t)&&t.anchor.type==="text"&&(F=!0);var D,R,M,B,J;if(p.type==="text"&&(C=Jf(S)),A!==null&&C!==null&&(E&&(t===null||F||lt(t)&&(t.format!==k||t.style!==N))&&(D=k,R=N,M=_,B=x,J=performance.now(),qD=[D,R,M,B,J]),u!==_||d!==y||o!==A||l!==C||n.type==="Range"&&E||(g!==null&&a.contains(g)||a.focus({preventScroll:!0}),h.type==="element"))){if(cR(n,A,_,C,y),!s.has(pZ)&&e.isCollapsed()&&a!==null&&a===document.activeElement){const X=lt(e)&&e.anchor.type==="element"?A.childNodes[_]||null:n.rangeCount>0?n.getRangeAt(0):null;if(X!==null){let z;if(X instanceof Text){const H=document.createRange();H.selectNode(X),z=H.getBoundingClientRect()}else z=X.getBoundingClientRect();(function(H,U,L){const ne=ER(L),de=TT(ne);if(ne===null||de===null)return;let{top:G,bottom:K}=U,Q=0,q=0,se=L;for(;se!==null;){const W=se===ne.body;if(W)Q=0,q=wi(H).innerHeight;else{const ve=se.getBoundingClientRect();Q=ve.top,q=ve.bottom}let ee=0;if(G<Q?ee=-(Q-G):K>q&&(ee=K-q),ee!==0)if(W)de.scrollBy(0,ee);else{const ve=se.scrollTop;se.scrollTop+=ee;const _e=se.scrollTop-ve;G-=_e,K-=_e}if(W)break;se=wm(se)}})(r,z,a)}}_S=!0}}function uZ(t){let e=wt()||_h();e===null&&(e=an().selectEnd()),e.insertNodes(t)}function l2(t){let e=t;t.isCollapsed()||e.removeText();const r=wt();lt(r)&&(e=r),lt(e)||ct(161);const n=e.anchor;let s=n.getNode(),a=n.offset;for(;!di(s);){const i=s;if([s,a]=dZ(s,a),i.is(s))break}return a}function dZ(t,e){const r=t.getParent();if(!r){const s=Jr();return an().append(s),s.select(),[an(),0]}if(_t(t)){const s=t.splitText(e);if(s.length===0)return[r,t.getIndexWithinParent()];const a=e===0?0:1;return[r,s[0].getIndexWithinParent()+a]}if(!Qe(t)||e===0)return[r,t.getIndexWithinParent()];const n=t.getChildAtIndex(e);if(n){const s=new fd(No(t.__key,e,"element"),No(t.__key,e,"element"),0,""),a=t.insertNewAfter(s);a&&a.append(n,...n.getNextSiblings())}return[r,t.getIndexWithinParent()+1]}function rA(t,e,r,n,s="decorators-and-blocks"){if(e==="move"&&n==="character"&&!t.isCollapsed()){const[d,g]=r===t.isBackward()?[t.focus,t.anchor]:[t.anchor,t.focus];return g.set(d.key,d.offset,d.type),!0}const a=xl(t.focus,r?"previous":"next"),i=n==="lineboundary",o=e==="move";let l=a,u=s==="decorators-and-blocks";if(!FR(l)){for(const d of l){u=!1;const{origin:g}=d;if(!Er(g)||g.isIsolated()||(l=d,!i||!g.isInline()))break}if(u)for(const d of RT(a).iterNodeCarets(e==="extend"?"shadowRoot":"root")){if(To(d))d.origin.isInline()||(l=d);else{if(Qe(d.origin))continue;Er(d.origin)&&!d.origin.isInline()&&(l=d)}break}}if(l===a)return!1;if(o&&!i&&Er(l.origin)&&l.origin.isKeyboardSelectable()){const d=dT();return d.add(l.origin.getKey()),Ns(d),!0}return l=gi(l),o&&Ku(t.anchor,l),Ku(t.focus,l),u||!i}let ds=null,fs=null,Ca=!1,c2=!1,Ux=0;const nA={characterData:!0,childList:!0,subtree:!0};function pm(){return Ca||ds!==null&&ds._readOnly}function bs(){Ca&&ct(13)}function uR(){Ux>99&&ct(14)}function Ic(){return ds===null&&ct(195,dR()),ds}function pn(){return fs===null&&ct(196,dR()),fs}function dR(){let t=0;const e=new Set,r=Av.version;if(typeof window<"u")for(const s of document.querySelectorAll("[contenteditable]")){const a=jv(s);if(_T(a))t++;else if(a){let i=String(a.constructor.version||"<0.17.1");i===r&&(i+=" (separately built, likely a bundler configuration issue)"),e.add(i)}}let n=` Detected on the page: ${t} compatible editor(s) with version ${r}`;return e.size&&(n+=` and incompatible editors with versions ${Array.from(e).join(", ")}`),n}function fZ(){return fs}function sA(t,e,r){const n=e.__type,s=xR(t,n);let a=r.get(n);a===void 0&&(a=Array.from(s.transforms),r.set(n,a));const i=a.length;for(let o=0;o<i&&(a[o](e),e.isAttached());o++);}function aA(t,e){return t!==void 0&&t.__key!==e&&t.isAttached()}function fR(t,e){if(!e)return;const r=t._updateTags;let n=e;Array.isArray(e)||(n=[e]);for(const s of n)r.add(s)}function hZ(t){return hT(t,pn()._nodes)}function hT(t,e){const r=t.type,n=e.get(r);n===void 0&&ct(17,r);const s=n.klass;t.type!==s.getType()&&ct(18,s.name);const a=s.importJSON(t),i=t.children;if(Qe(a)&&Array.isArray(i))for(let o=0;o<i.length;o++){const l=hT(i[o],e);a.append(l)}return a}function iA(t,e,r){const n=ds,s=Ca,a=fs;ds=e,Ca=!0,fs=t;try{return r()}finally{ds=n,Ca=s,fs=a}}function Qo(t,e){const r=t._pendingEditorState,n=t._rootElement,s=t._headless||n===null;if(r===null)return;const a=t._editorState,i=a._selection,o=r._selection,l=t._dirtyType!==Ou,u=ds,d=Ca,g=fs,h=t._updating,p=t._observer;let x=null;if(t._pendingEditorState=null,t._editorState=r,!s&&l&&p!==null){fs=t,ds=r,Ca=!1,t._updating=!0;try{const E=t._dirtyType,A=t._dirtyElements,C=t._dirtyLeaves;p.disconnect(),x=$q(a,r,t,E,A,C)}catch(E){if(E instanceof Error&&t._onError(E),c2)throw E;return pR(t,null,n,r),AD(t),t._dirtyType=Yf,c2=!0,Qo(t,a),void(c2=!1)}finally{p.observe(n,nA),t._updating=h,ds=u,Ca=d,fs=g}}r._readOnly||(r._readOnly=!0);const v=t._dirtyLeaves,w=t._dirtyElements,S=t._normalizedNodes,_=t._updateTags,y=t._deferred;l&&(t._dirtyType=Ou,t._cloneNotNeeded.clear(),t._dirtyLeaves=new Set,t._dirtyElements=new Map,t._normalizedNodes=new Set,t._updateTags=new Set),function(E,A){const C=E._decorators;let F=E._pendingDecorators||C;const D=A._nodeMap;let R;for(R in F)D.has(R)||(F===C&&(F=_R(E)),delete F[R])}(t,r);const k=s?null:Yi(wi(t));if(t._editable&&k!==null&&(l||o===null||o.dirty)&&n!==null&&!_.has(xZ)){fs=t,ds=r;try{if(p!==null&&p.disconnect(),l||o===null||o.dirty){const E=t._blockCursorElement;E!==null&&AS(E,t,n),cZ(i,o,t,k,_,n)}(function(E,A,C){let F=E._blockCursorElement;if(lt(C)&&C.isCollapsed()&&C.anchor.type==="element"&&A.contains(document.activeElement)){const D=C.anchor,R=D.getNode(),M=D.offset;let B=!1,J=null;if(M===R.getChildrenSize())d2(R.getChildAtIndex(M-1))&&(B=!0);else{const X=R.getChildAtIndex(M);if(X!==null&&d2(X)){const z=X.getPreviousSibling();(z===null||d2(z))&&(B=!0,J=E.getElementByKey(X.__key))}}if(B){const X=E.getElementByKey(R.__key);return F===null&&(E._blockCursorElement=F=function(z){const H=z.theme,U=document.createElement("div");U.contentEditable="false",U.setAttribute("data-lexical-cursor","true");let L=H.blockCursor;if(L!==void 0){if(typeof L=="string"){const ne=kD(L);L=H.blockCursor=ne}L!==void 0&&U.classList.add(...L)}return U}(E._config)),A.style.caretColor="transparent",void(J===null?X.appendChild(F):X.insertBefore(F,J))}}F!==null&&AS(F,E,A)})(t,n,o)}finally{p!==null&&p.observe(n,nA),fs=g,ds=u}}x!==null&&function(E,A,C,F,D){const R=Array.from(E._listeners.mutation),M=R.length;for(let B=0;B<M;B++){const[J,X]=R[B];for(const z of X){const H=A.get(z);H!==void 0&&J(H,{dirtyLeaves:F,prevEditorState:D,updateTags:C})}}}(t,x,_,v,a),lt(o)||o===null||i!==null&&i.is(o)||t.dispatchCommand(LD,void 0);const N=t._pendingDecorators;N!==null&&(t._decorators=N,t._pendingDecorators=null,z0("decorator",t,!0,N)),function(E,A,C){const F=dA(A),D=dA(C);F!==D&&z0("textcontent",E,!0,D)}(t,e||a,r),z0("update",t,!0,{dirtyElements:w,dirtyLeaves:v,editorState:r,mutatedNodes:x,normalizedNodes:S,prevEditorState:e||a,tags:_}),function(E,A){if(E._deferred=[],A.length!==0){const C=E._updating;E._updating=!0;try{for(let F=0;F<A.length;F++)A[F]()}finally{E._updating=C}}}(t,y),function(E){const A=E._updates;if(A.length!==0){const C=A.shift();if(C){const[F,D]=C;Ev(E,F,D)}}}(t)}function z0(t,e,r,...n){const s=e._updating;e._updating=r;try{const a=Array.from(e._listeners[t]);for(let i=0;i<a.length;i++)a[i].apply(null,n)}finally{e._updating=s}}function oA(t,e){const r=t._updates;let n=e||!1;for(;r.length!==0;){const s=r.shift();if(s){const[a,i]=s,o=t._pendingEditorState;let l;i!==void 0&&(l=i.onUpdate,i.skipTransforms&&(n=!0),i.discrete&&(o===null&&ct(191),o._flushSync=!0),l&&t._deferred.push(l),fR(t,i.tag)),o==null?Ev(t,a,i):a()}}return n}function Ev(t,e,r){const n=t._updateTags;let s,a=!1,i=!1;r!==void 0&&(s=r.onUpdate,fR(t,r.tag),a=r.skipTransforms||!1,i=r.discrete||!1),s&&t._deferred.push(s);const o=t._editorState;let l=t._pendingEditorState,u=!1;(l===null||l._readOnly)&&(l=t._pendingEditorState=hR(l||o),u=!0),l._flushSync=i;const d=ds,g=Ca,h=fs,p=t._updating;ds=l,Ca=!1,t._updating=!0,fs=t;const x=t._headless||t.getRootElement()===null;yT(null);try{u&&(x?o._selection!==null&&(l._selection=o._selection.clone()):l._selection=function(_,y){const k=_.getEditorState()._selection,N=Yi(wi(_));return lt(k)||k==null?fT(k,N,_,y):k.clone()}(t,r&&r.event||null));const w=t._compositionKey;e(),a=oA(t,a),function(_,y){const k=y.getEditorState()._selection,N=_._selection;if(lt(N)){const E=N.anchor,A=N.focus;let C;if(E.type==="text"&&(C=E.getNode(),C.selectionTransform(k,N)),A.type==="text"){const F=A.getNode();C!==F&&F.selectionTransform(k,N)}}}(l,t),t._dirtyType!==Ou&&(a?function(_,y){const k=y._dirtyLeaves,N=_._nodeMap;for(const E of k){const A=N.get(E);_t(A)&&A.isAttached()&&A.isSimpleText()&&!A.isUnmergeable()&&I6(A)}}(l,t):function(_,y){const k=y._dirtyLeaves,N=y._dirtyElements,E=_._nodeMap,A=Jl(),C=new Map;let F=k,D=F.size,R=N,M=R.size;for(;D>0||M>0;){if(D>0){y._dirtyLeaves=new Set;for(const B of F){const J=E.get(B);_t(J)&&J.isAttached()&&J.isSimpleText()&&!J.isUnmergeable()&&I6(J),J!==void 0&&aA(J,A)&&sA(y,J,C),k.add(B)}if(F=y._dirtyLeaves,D=F.size,D>0){Ux++;continue}}y._dirtyLeaves=new Set,y._dirtyElements=new Map,R.delete("root")&&R.set("root",!0);for(const B of R){const J=B[0],X=B[1];if(N.set(J,X),!X)continue;const z=E.get(J);z!==void 0&&aA(z,A)&&sA(y,z,C)}F=y._dirtyLeaves,D=F.size,R=y._dirtyElements,M=R.size,Ux++}y._dirtyLeaves=k,y._dirtyElements=N}(l,t),oA(t),function(_,y,k,N){const E=_._nodeMap,A=y._nodeMap,C=[];for(const[F]of N){const D=A.get(F);D!==void 0&&(D.isAttached()||(Qe(D)&&TD(D,F,E,A,C,N),E.has(F)||N.delete(F),C.push(F)))}for(const F of C)A.delete(F);for(const F of k){const D=A.get(F);D===void 0||D.isAttached()||(E.has(F)||k.delete(F),A.delete(F))}}(o,l,t._dirtyLeaves,t._dirtyElements)),w!==t._compositionKey&&(l._flushSync=!0);const S=l._selection;if(lt(S)){const _=l._nodeMap,y=S.anchor.key,k=S.focus.key;_.get(y)!==void 0&&_.get(k)!==void 0||ct(19)}else Ls(S)&&S._nodes.size===0&&(l._selection=null)}catch(w){return w instanceof Error&&t._onError(w),t._pendingEditorState=o,t._dirtyType=Yf,t._cloneNotNeeded.clear(),t._dirtyLeaves=new Set,t._dirtyElements.clear(),void Qo(t)}finally{ds=d,Ca=g,fs=h,t._updating=p,Ux=0}t._dirtyType!==Ou||t._deferred.length>0||function(w,S){const _=S.getEditorState()._selection,y=w._selection;if(y!==null){if(y.dirty||!y.is(_))return!0}else if(_!==null)return!0;return!1}(l,t)?l._flushSync?(l._flushSync=!1,Qo(t)):u&&bZ(()=>{Qo(t)}):(l._flushSync=!1,u&&(n.clear(),t._deferred=[],t._pendingEditorState=null))}function Pa(t,e,r){fs===t&&r===void 0?e():Ev(t,e,r)}class H0{constructor(e,r,n){this.element=e,this.before=r||null,this.after=n||null}withBefore(e){return new H0(this.element,e,this.after)}withAfter(e){return new H0(this.element,this.before,e)}withElement(e){return this.element===e?this:new H0(e,this.before,this.after)}insertChild(e){const r=this.before||this.getManagedLineBreak();return r!==null&&r.parentElement!==this.element&&ct(222),this.element.insertBefore(e,r),this}removeChild(e){return e.parentElement!==this.element&&ct(223),this.element.removeChild(e),this}replaceChild(e,r){return r.parentElement!==this.element&&ct(224),this.element.replaceChild(e,r),this}getFirstChild(){const e=this.after?this.after.nextSibling:this.element.firstChild;return e===this.before||e===this.getManagedLineBreak()?null:e}getManagedLineBreak(){return this.element.__lexicalLineBreak||null}setManagedLineBreak(e){if(e===null)this.removeManagedLineBreak();else{const r=e==="decorator"&&(Xf||Ng);this.insertManagedLineBreak(r)}}removeManagedLineBreak(){const e=this.getManagedLineBreak();if(e){const r=this.element,n=e.nodeName==="IMG"?e.nextSibling:null;n&&r.removeChild(n),r.removeChild(e),r.__lexicalLineBreak=void 0}}insertManagedLineBreak(e){const r=this.getManagedLineBreak();if(r){if(e===(r.nodeName==="IMG"))return;this.removeManagedLineBreak()}const n=this.element,s=this.before,a=document.createElement("br");if(n.insertBefore(a,s),e){const i=document.createElement("img");i.setAttribute("data-lexical-linebreak","true"),i.style.cssText="display: inline !important; border: 0px !important; margin: 0px !important;",i.alt="",n.insertBefore(i,a),n.__lexicalLineBreak=i}else n.__lexicalLineBreak=a}getFirstChildOffset(){let e=0;for(let r=this.after;r!==null;r=r.previousSibling)e++;return e}resolveChildIndex(e,r,n,s){if(n===this.element){const l=this.getFirstChildOffset();return[e,Math.min(l+e.getChildrenSize(),Math.max(l,s))]}const a=lA(r,n);a.push(s);const i=lA(r,this.element);let o=e.getIndexWithinParent();for(let l=0;l<i.length;l++){const u=a[l],d=i[l];if(u===void 0||u<d)break;if(u>d){o+=1;break}}return[e.getParentOrThrow(),o]}}function lA(t,e){const r=[];let n=e;for(;n!==t&&n!==null;n=n.parentNode){let s=0;for(let a=n.previousSibling;a!==null;a=a.previousSibling)s++;r.push(s)}return n!==t&&ct(225),r.reverse()}class Ks extends vh{constructor(e){super(e),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__style="",this.__indent=0,this.__dir=null,this.__textFormat=0,this.__textStyle=""}afterCloneFrom(e){super.afterCloneFrom(e),this.__key===e.__key&&(this.__first=e.__first,this.__last=e.__last,this.__size=e.__size),this.__indent=e.__indent,this.__format=e.__format,this.__style=e.__style,this.__dir=e.__dir,this.__textFormat=e.__textFormat,this.__textStyle=e.__textStyle}getFormat(){return this.getLatest().__format}getFormatType(){const e=this.getFormat();return Nq[e]||""}getStyle(){return this.getLatest().__style}getIndent(){return this.getLatest().__indent}getChildren(){const e=[];let r=this.getFirstChild();for(;r!==null;)e.push(r),r=r.getNextSibling();return e}getChildrenKeys(){const e=[];let r=this.getFirstChild();for(;r!==null;)e.push(r.__key),r=r.getNextSibling();return e}getChildrenSize(){return this.getLatest().__size}isEmpty(){return this.getChildrenSize()===0}isDirty(){const e=pn()._dirtyElements;return e!==null&&e.has(this.__key)}isLastChild(){const e=this.getLatest(),r=this.getParentOrThrow().getLastChild();return r!==null&&r.is(e)}getAllTextNodes(){const e=[];let r=this.getFirstChild();for(;r!==null;){if(_t(r)&&e.push(r),Qe(r)){const n=r.getAllTextNodes();e.push(...n)}r=r.getNextSibling()}return e}getFirstDescendant(){let e=this.getFirstChild();for(;Qe(e);){const r=e.getFirstChild();if(r===null)break;e=r}return e}getLastDescendant(){let e=this.getLastChild();for(;Qe(e);){const r=e.getLastChild();if(r===null)break;e=r}return e}getDescendantByIndex(e){const r=this.getChildren(),n=r.length;if(e>=n){const a=r[n-1];return Qe(a)&&a.getLastDescendant()||a||null}const s=r[e];return Qe(s)&&s.getFirstDescendant()||s||null}getFirstChild(){const e=this.getLatest().__first;return e===null?null:Hn(e)}getFirstChildOrThrow(){const e=this.getFirstChild();return e===null&&ct(45,this.__key),e}getLastChild(){const e=this.getLatest().__last;return e===null?null:Hn(e)}getLastChildOrThrow(){const e=this.getLastChild();return e===null&&ct(96,this.__key),e}getChildAtIndex(e){const r=this.getChildrenSize();let n,s;if(e<r/2){for(n=this.getFirstChild(),s=0;n!==null&&s<=e;){if(s===e)return n;n=n.getNextSibling(),s++}return null}for(n=this.getLastChild(),s=r-1;n!==null&&s>=e;){if(s===e)return n;n=n.getPreviousSibling(),s--}return null}getTextContent(){let e="";const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];e+=a.getTextContent(),Qe(a)&&s!==n-1&&!a.isInline()&&(e+=pl)}return e}getTextContentSize(){let e=0;const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];e+=a.getTextContentSize(),Qe(a)&&s!==n-1&&!a.isInline()&&(e+=pl.length)}return e}getDirection(){return this.getLatest().__dir}getTextFormat(){return this.getLatest().__textFormat}hasFormat(e){if(e!==""){const r=A6[e];return!!(this.getFormat()&r)}return!1}hasTextFormat(e){const r=Bu[e];return!!(this.getTextFormat()&r)}getFormatFlags(e,r){return U1(this.getLatest().__textFormat,e,r)}getTextStyle(){return this.getLatest().__textStyle}select(e,r){bs();const n=wt();let s=e,a=r;const i=this.getChildrenSize();if(!this.canBeEmpty()){if(e===0&&r===0){const l=this.getFirstChild();if(_t(l)||Qe(l))return l.select(0,0)}else if(!(e!==void 0&&e!==i||r!==void 0&&r!==i)){const l=this.getLastChild();if(_t(l)||Qe(l))return l.select()}}s===void 0&&(s=i),a===void 0&&(a=i);const o=this.__key;return lt(n)?(n.anchor.set(o,s,"element"),n.focus.set(o,a,"element"),n.dirty=!0,n):lR(o,s,o,a,"element","element")}selectStart(){const e=this.getFirstDescendant();return e?e.selectStart():this.select()}selectEnd(){const e=this.getLastDescendant();return e?e.selectEnd():this.select()}clear(){const e=this.getWritable();return this.getChildren().forEach(r=>r.remove()),e}append(...e){return this.splice(this.getChildrenSize(),0,e)}setDirection(e){const r=this.getWritable();return r.__dir=e,r}setFormat(e){return this.getWritable().__format=e!==""?A6[e]:0,this}setStyle(e){return this.getWritable().__style=e||"",this}setTextFormat(e){const r=this.getWritable();return r.__textFormat=e,r}setTextStyle(e){const r=this.getWritable();return r.__textStyle=e,r}setIndent(e){return this.getWritable().__indent=e,this}splice(e,r,n){const s=n.length,a=this.getChildrenSize(),i=this.getWritable();e+r<=a||ct(226,String(e),String(r),String(a));const o=i.__key,l=[],u=[],d=this.getChildAtIndex(e+r);let g=null,h=a-r+s;if(e!==0)if(e===a)g=this.getLastChild();else{const x=this.getChildAtIndex(e);x!==null&&(g=x.getPreviousSibling())}if(r>0){let x=g===null?this.getFirstChild():g.getNextSibling();for(let v=0;v<r;v++){x===null&&ct(100);const w=x.getNextSibling(),S=x.__key;Cu(x.getWritable()),u.push(S),x=w}}let p=g;for(let x=0;x<s;x++){const v=n[x];p!==null&&v.is(p)&&(g=p=p.getPreviousSibling());const w=v.getWritable();w.__parent===o&&h--,Cu(w);const S=v.__key;if(p===null)i.__first=S,w.__prev=null;else{const _=p.getWritable();_.__next=S,w.__prev=_.__key}v.__key===o&&ct(76),w.__parent=o,l.push(S),p=v}if(e+r===a)p!==null&&(p.getWritable().__next=null,i.__last=p.__key);else if(d!==null){const x=d.getWritable();if(p!==null){const v=p.getWritable();x.__prev=p.__key,v.__next=d.__key}else x.__prev=null}if(i.__size=h,u.length){const x=wt();if(lt(x)){const v=new Set(u),w=new Set(l),{anchor:S,focus:_}=x;cA(S,v,w)&&O1(S,S.getNode(),this,g,d),cA(_,v,w)&&O1(_,_.getNode(),this,g,d),h!==0||this.canBeEmpty()||ia(this)||this.remove()}}return i}getDOMSlot(e){return new H0(e)}exportDOM(e){const{element:r}=super.exportDOM(e);if(Qr(r)){const n=this.getIndent();n>0&&(r.style.paddingInlineStart=40*n+"px");const s=this.getDirection();s&&(r.dir=s)}return{element:r}}exportJSON(){const e={children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),...super.exportJSON()},r=this.getTextFormat(),n=this.getTextStyle();return r!==0&&(e.textFormat=r),n!==""&&(e.textStyle=n),e}updateFromJSON(e){return super.updateFromJSON(e).setFormat(e.format).setIndent(e.indent).setDirection(e.direction).setTextFormat(e.textFormat||0).setTextStyle(e.textStyle||"")}insertNewAfter(e,r){return null}canIndent(){return!0}collapseAtStart(e){return!1}excludeFromCopy(e){return!1}canReplaceWith(e){return!0}canInsertAfter(e){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(e){return!1}extractWithChild(e,r,n){return!1}canMergeWhenEmpty(){return!1}reconcileObservedMutation(e,r){const n=this.getDOMSlot(e);let s=n.getFirstChild();for(let a=this.getFirstChild();a;a=a.getNextSibling()){const i=r.getElementByKey(a.getKey());i!==null&&(s==null?(n.insertChild(i),s=i):s!==i&&n.replaceChild(i,s),s=s.nextSibling)}}}function Qe(t){return t instanceof Ks}function cA(t,e,r){let n=t.getNode();for(;n;){const s=n.__key;if(e.has(s)&&!r.has(s))return!0;n=n.getParent()}return!1}class gT extends vh{decorate(e,r){ct(47)}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function Er(t){return t instanceof gT}class xm extends Ks{static getType(){return"root"}static clone(){return new xm}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){ct(51)}getTextContent(){const e=this.__cachedText;return!pm()&&pn()._dirtyType!==Ou||e===null?super.getTextContent():e}remove(){ct(52)}replace(e){ct(53)}insertBefore(e){ct(54)}insertAfter(e){ct(55)}updateDOM(e,r){return!1}splice(e,r,n){for(const s of n)Qe(s)||Er(s)||ct(282);return super.splice(e,r,n)}static importJSON(e){return an().updateFromJSON(e)}collapseAtStart(){return!0}}function es(t){return t instanceof xm}function hR(t){return new Nv(new Map(t._nodeMap))}function mT(){return new Nv(new Map([["root",new xm]]))}function gR(t){const e=t.exportJSON(),r=t.constructor;if(e.type!==r.getType()&&ct(130,r.name),Qe(t)){const n=e.children;Array.isArray(n)||ct(59,r.name);const s=t.getChildren();for(let a=0;a<s.length;a++){const i=gR(s[a]);n.push(i)}}return e}class Nv{constructor(e,r){this._nodeMap=e,this._selection=r||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(e,r){return iA(r&&r.editor||null,this,e)}clone(e){const r=new Nv(this._nodeMap,e===void 0?this._selection:e);return r._readOnly=!0,r}toJSON(){return iA(null,this,()=>({root:gR(an())}))}}const B1="historic",gZ="history-push",G0="history-merge",mZ="paste",mR="collaboration",pZ="skip-scroll-into-view",xZ="skip-dom-selection";class pT extends Ks{static getType(){return"artificial"}createDOM(e){return document.createElement("div")}}class ym extends Ks{static getType(){return"paragraph"}static clone(e){return new ym(e.__key)}createDOM(e){const r=document.createElement("p"),n=Ef(e.theme,"paragraph");return n!==void 0&&r.classList.add(...n),r}updateDOM(e,r,n){return!1}static importDOM(){return{p:e=>({conversion:yZ,priority:0})}}exportDOM(e){const{element:r}=super.exportDOM(e);if(Qr(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n)}return{element:r}}static importJSON(e){return Jr().updateFromJSON(e)}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle()}}insertNewAfter(e,r){const n=Jr();n.setTextFormat(e.format),n.setTextStyle(e.style);const s=this.getDirection();return n.setDirection(s),n.setFormat(this.getFormatType()),n.setStyle(this.getStyle()),this.insertAfter(n,r),n}collapseAtStart(){const e=this.getChildren();if(e.length===0||_t(e[0])&&e[0].getTextContent().trim()===""){if(this.getNextSibling()!==null)return this.selectNext(),this.remove(),!0;if(this.getPreviousSibling()!==null)return this.selectPrevious(),this.remove(),!0}return!1}}function yZ(t){const e=Jr();return t.style&&(e.setFormat(t.style.textAlign),NT(t,e)),{node:e}}function Jr(){return ua(new ym)}function xT(t){return t instanceof ym}const pr=0,Kd=1,vZ=4;function pR(t,e,r,n){const s=t._keyToDOMMap;s.clear(),t._editorState=mT(),t._pendingEditorState=n,t._compositionKey=null,t._dirtyType=Ou,t._cloneNotNeeded.clear(),t._dirtyLeaves=new Set,t._dirtyElements.clear(),t._normalizedNodes=new Set,t._updateTags=new Set,t._updates=[],t._blockCursorElement=null;const a=t._observer;a!==null&&(a.disconnect(),t._observer=null),e!==null&&(e.textContent=""),r!==null&&(r.textContent="",s.set("root",r))}function wZ(t){const e=t||{},r=fZ(),n=e.theme||{},s=t===void 0?r:e.parentEditor||null,a=e.disableEvents||!1,i=mT(),o=e.namespace||(s!==null?s._config.namespace:kR()),l=e.editorState,u=[xm,Lc,gm,mm,ym,pT,...e.nodes||[]],{onError:d,html:g}=e,h=e.editable===void 0||e.editable;let p;if(t===void 0&&r!==null)p=r._nodes;else{p=new Map;for(let v=0;v<u.length;v++){let w=u[v],S=null,_=null;if(typeof w!="function"){const A=w;w=A.replace,S=A.with,_=A.withKlass||null}const{ownNodeConfig:y}=AT(w),k=w.getType(),N=w.transform(),E=new Set;y&&y.$transform&&E.add(y.$transform),N!==null&&E.add(N),p.set(k,{exportDOM:g&&g.export?g.export.get(w):void 0,klass:w,replace:S,replaceWithKlass:_,sharedNodeState:Lq(u[v]),transforms:E})}}const x=new Av(i,s,p,{disableEvents:a,namespace:o,theme:n},d||console.error,function(v,w){const S=new Map,_=new Set,y=k=>{Object.keys(k).forEach(N=>{let E=S.get(N);E===void 0&&(E=[],S.set(N,E)),E.push(k[N])})};return v.forEach(k=>{const N=k.klass.importDOM;if(N==null||_.has(N))return;_.add(N);const E=N.call(k.klass);E!==null&&y(E)}),w&&y(w),S}(p,g?g.import:void 0),h,t);return l!==void 0&&(x._pendingEditorState=l,x._dirtyType=Yf),x}class Av{constructor(e,r,n,s,a,i,o,l){this._createEditorArgs=l,this._parentEditor=r,this._rootElement=null,this._editorState=e,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=s,this._nodes=n,this._decorators={},this._pendingDecorators=null,this._dirtyType=Ou,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=kR(),this._onError=a,this._htmlConversions=i,this._editable=o,this._headless=r!==null&&r._headless,this._window=null,this._blockCursorElement=null}isComposing(){return this._compositionKey!=null}registerUpdateListener(e){const r=this._listeners.update;return r.add(e),()=>{r.delete(e)}}registerEditableListener(e){const r=this._listeners.editable;return r.add(e),()=>{r.delete(e)}}registerDecoratorListener(e){const r=this._listeners.decorator;return r.add(e),()=>{r.delete(e)}}registerTextContentListener(e){const r=this._listeners.textcontent;return r.add(e),()=>{r.delete(e)}}registerRootListener(e){const r=this._listeners.root;return e(this._rootElement,null),r.add(e),()=>{e(null,this._rootElement),r.delete(e)}}registerCommand(e,r,n){n===void 0&&ct(35);const s=this._commands;s.has(e)||s.set(e,[new Set,new Set,new Set,new Set,new Set]);const a=s.get(e);a===void 0&&ct(36,String(e));const i=a[n];return i.add(r),()=>{i.delete(r),a.every(o=>o.size===0)&&s.delete(e)}}registerMutationListener(e,r,n){const s=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(e)).klass,a=this._listeners.mutation;let i=a.get(r);i===void 0&&(i=new Set,a.set(r,i)),i.add(s);const o=n&&n.skipInitialization;return o!==void 0&&o||this.initializeMutationListener(r,s),()=>{i.delete(s),i.size===0&&a.delete(r)}}getRegisteredNode(e){const r=this._nodes.get(e.getType());return r===void 0&&ct(37,e.name),r}resolveRegisteredNodeAfterReplacements(e){for(;e.replaceWithKlass;)e=this.getRegisteredNode(e.replaceWithKlass);return e}initializeMutationListener(e,r){const n=this._editorState,s=yA(n).get(r.getType());if(!s)return;const a=new Map;for(const i of s.keys())a.set(i,"created");a.size>0&&e(a,{dirtyLeaves:new Set,prevEditorState:n,updateTags:new Set(["registerMutationListener"])})}registerNodeTransformToKlass(e,r){const n=this.getRegisteredNode(e);return n.transforms.add(r),n}registerNodeTransform(e,r){const n=this.registerNodeTransformToKlass(e,r),s=[n],a=n.replaceWithKlass;if(a!=null){const i=this.registerNodeTransformToKlass(a,r);s.push(i)}return function(i,o){const l=yA(i.getEditorState()),u=[];for(const d of o){const g=l.get(d);g&&u.push(g)}u.length!==0&&i.update(()=>{for(const d of u)for(const g of d.keys()){const h=Hn(g);h&&h.markDirty()}},i._pendingEditorState===null?{tag:G0}:void 0)}(this,s.map(i=>i.klass.getType())),()=>{s.forEach(i=>i.transforms.delete(r))}}hasNode(e){return this._nodes.has(e.getType())}hasNodes(e){return e.every(this.hasNode.bind(this))}dispatchCommand(e,r){return Rt(this,e,r)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(e){const r=this._rootElement;if(e!==r){const n=Ef(this._config.theme,"root"),s=this._pendingEditorState||this._editorState;if(this._rootElement=e,pR(this,r,e,s),r!==null&&(this._config.disableEvents||eZ(r),n!=null&&r.classList.remove(...n)),e!==null){const a=TT(e),i=e.style;i.userSelect="text",i.whiteSpace="pre-wrap",i.wordBreak="break-word",e.setAttribute("data-lexical-editor","true"),this._window=a,this._dirtyType=Yf,AD(this),this._updateTags.add(G0),Qo(this),this._config.disableEvents||function(o,l){const u=o.ownerDocument,d=L1.get(u);(d===void 0||d<1)&&u.addEventListener("selectionchange",nR),L1.set(u,(d||0)+1),o.__lexicalEditor=l;const g=rR(o);for(let h=0;h<wS.length;h++){const[p,x]=wS[h],v=typeof x=="function"?w=>{H6(w)||(z6(w),(l.isEditable()||p==="click")&&x(w,l))}:w=>{if(H6(w))return;z6(w);const S=l.isEditable();switch(p){case"cut":return S&&Rt(l,cT,w);case"copy":return Rt(l,Sv,w);case"paste":return S&&Rt(l,iT,w);case"dragstart":return S&&Rt(l,XD,w);case"dragover":return S&&Rt(l,YD,w);case"dragend":return S&&Rt(l,Xq,w);case"focus":return S&&Rt(l,Qq,w);case"blur":return S&&Rt(l,qq,w);case"drop":return S&&Rt(l,VD,w)}};o.addEventListener(p,v),g.push(()=>{o.removeEventListener(p,v)})}}(e,this),n!=null&&e.classList.add(...n)}else this._window=null,this._updateTags.add(G0),Qo(this);z0("root",this,!1,e,r)}}getElementByKey(e){return this._keyToDOMMap.get(e)||null}getEditorState(){return this._editorState}setEditorState(e,r){e.isEmpty()&&ct(38);let n=e;n._readOnly&&(n=hR(e),n._selection=e._selection?e._selection.clone():null),ND(this);const s=this._pendingEditorState,a=this._updateTags,i=r!==void 0?r.tag:null;s===null||s.isEmpty()||(i!=null&&a.add(i),Qo(this)),this._pendingEditorState=n,this._dirtyType=Yf,this._dirtyElements.set("root",!1),this._compositionKey=null,i!=null&&a.add(i),this._updating||Qo(this)}parseEditorState(e,r){return function(n,s,a){const i=mT(),o=ds,l=Ca,u=fs,d=s._dirtyElements,g=s._dirtyLeaves,h=s._cloneNotNeeded,p=s._dirtyType;s._dirtyElements=new Map,s._dirtyLeaves=new Set,s._cloneNotNeeded=new Set,s._dirtyType=0,ds=i,Ca=!1,fs=s,yT(null);try{const x=s._nodes;hT(n.root,x),a&&a(),i._readOnly=!0}catch(x){x instanceof Error&&s._onError(x)}finally{s._dirtyElements=d,s._dirtyLeaves=g,s._cloneNotNeeded=h,s._dirtyType=p,ds=o,Ca=l,fs=u}return i}(typeof e=="string"?JSON.parse(e):e,this,r)}read(e){return Qo(this),this.getEditorState().read(e,{editor:this})}update(e,r){(function(n,s,a){n._updating?n._updates.push([s,a]):Ev(n,s,a)})(this,e,r)}focus(e,r={}){const n=this._rootElement;n!==null&&(n.setAttribute("autocapitalize","off"),Pa(this,()=>{const s=wt(),a=an();s!==null?s.dirty||Ns(s.clone()):a.getChildrenSize()!==0&&(r.defaultSelection==="rootStart"?a.selectStart():a.selectEnd()),EZ("focus"),NZ(()=>{n.removeAttribute("autocapitalize"),e&&e()})}),this._pendingEditorState===null&&n.removeAttribute("autocapitalize"))}blur(){const e=this._rootElement;e!==null&&e.blur();const r=Yi(this._window);r!==null&&r.removeAllRanges()}isEditable(){return this._editable}setEditable(e){this._editable!==e&&(this._editable=e,z0("editable",this,!0,e))}toJSON(){return{editorState:this._editorState.toJSON()}}}Av.version="0.35.0+prod.esm";let TS=null;function yT(t){TS=t}let _Z=1;function xR(t,e){const r=vT(t,e);return r===void 0&&ct(30,e),r}function vT(t,e){return t._nodes.get(e)}const bZ=typeof queueMicrotask=="function"?queueMicrotask:t=>{Promise.resolve().then(t)};function uA(t){return Er(yc(t))}function wT(t){const e=document.activeElement;if(!Qr(e))return!1;const r=e.nodeName;return Er(yc(t))&&(r==="INPUT"||r==="TEXTAREA"||e.contentEditable==="true"&&jv(e)==null)}function vm(t,e,r){const n=t.getRootElement();try{return n!==null&&n.contains(e)&&n.contains(r)&&e!==null&&!wT(e)&&yR(e)===t}catch{return!1}}function _T(t){return t instanceof Av}function yR(t){let e=t;for(;e!=null;){const r=jv(e);if(_T(r))return r;e=wm(e)}return null}function jv(t){return t?t.__lexicalEditor:null}function ku(t){return kv(t)||t.isToken()}function Xo(t){return ku(t)||t.isSegmented()}function kl(t){return bh(t)&&t.nodeType===vq}function SZ(t){return bh(t)&&t.nodeType===wq}function Jf(t){let e=t;for(;e!=null;){if(kl(e))return e;e=e.firstChild}return null}function U1(t,e,r){const n=Bu[e];if(r!==null&&(t&n)==(r&n))return t;let s=t^n;return e==="subscript"?s&=-65:e==="superscript"?s&=-33:e==="lowercase"?(s&=-513,s&=-1025):e==="uppercase"?(s&=-257,s&=-1025):e==="capitalize"&&(s&=-257,s&=-513),s}function vR(t){return _t(t)||il(t)||Er(t)}function kZ(t,e){const r=function(){const i=TS;return TS=null,i}();if((e=e||r&&r.__key)!=null)return void(t.__key=e);bs(),uR();const n=pn(),s=Ic(),a=""+_Z++;s._nodeMap.set(a,t),Qe(t)?n._dirtyElements.set(a,!0):n._dirtyLeaves.add(a),n._cloneNotNeeded.add(a),n._dirtyType=CD,t.__key=a}function Cu(t){const e=t.getParent();if(e!==null){const r=t.getWritable(),n=e.getWritable(),s=t.getPreviousSibling(),a=t.getNextSibling(),i=a!==null?a.__key:null,o=s!==null?s.__key:null,l=s!==null?s.getWritable():null,u=a!==null?a.getWritable():null;s===null&&(n.__first=i),a===null&&(n.__last=o),l!==null&&(l.__next=i),u!==null&&(u.__prev=o),r.__prev=null,r.__next=null,r.__parent=null,n.__size--}}function $1(t){uR();const e=t.getLatest(),r=e.__parent,n=Ic(),s=pn(),a=n._nodeMap,i=s._dirtyElements;r!==null&&function(l,u,d){let g=l;for(;g!==null;){if(d.has(g))return;const h=u.get(g);if(h===void 0)break;d.set(g,!1),g=h.__parent}}(r,a,i);const o=e.__key;s._dirtyType=CD,Qe(t)?i.set(o,!0):s._dirtyLeaves.add(o)}function Ss(t){bs();const e=pn(),r=e._compositionKey;if(t!==r){if(e._compositionKey=t,r!==null){const n=Hn(r);n!==null&&n.getWritable()}if(t!==null){const n=Hn(t);n!==null&&n.getWritable()}}}function Jl(){return pm()?null:pn()._compositionKey}function Hn(t,e){const r=(e||Ic())._nodeMap.get(t);return r===void 0?null:r}function wR(t,e){const r=Fv(t,pn());return r!==void 0?Hn(r,e):null}function Fv(t,e){return t[`__lexicalKey_${e._key}`]}function yc(t,e){let r=t;for(;r!=null;){const n=wR(r,e);if(n!==null)return n;r=wm(r)}return null}function _R(t){const e=t._decorators,r=Object.assign({},e);return t._pendingDecorators=r,r}function dA(t){return t.read(()=>an().getTextContent())}function an(){return bR(Ic())}function bR(t){return t._nodeMap.get("root")}function Ns(t){bs();const e=Ic();t!==null&&(t.dirty=!0,t.setCachedNodes(null)),e._selection=t}function gf(t){const e=pn(),r=function(n,s){let a=n;for(;a!=null;){const i=Fv(a,s);if(i!==void 0)return i;a=wm(a)}return null}(t,e);return r===null?t===e.getRootElement()?Hn("root"):null:Hn(r)}function SR(t){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(t)}function bT(t){const e=[];let r=t;for(;r!==null;)e.push(r),r=r._parentEditor;return e}function kR(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,5)}function CR(t){return kl(t)?t.nodeValue:null}function ST(t,e,r){const n=Yi(wi(e));if(n===null)return;const s=n.anchorNode;let{anchorOffset:a,focusOffset:i}=n;if(s!==null){let o=CR(s);const l=yc(s);if(o!==null&&_t(l)){if(o===_v&&r){const u=r.length;o=r,a=u,i=u}o!==null&&kT(l,o,a,i,t)}}}function kT(t,e,r,n,s){let a=t;if(a.isAttached()&&(s||!a.isDirty())){const i=a.isComposing();let o=e;(i||s)&&e[e.length-1]===_v&&(o=e.slice(0,-1));const l=a.getTextContent();if(s||o!==l){if(o===""){if(Ss(null),Ng||Xf||E1)a.remove();else{const v=pn();setTimeout(()=>{v.update(()=>{a.isAttached()&&a.remove()})},20)}return}const u=a.getParent(),d=_h(),g=a.getTextContentSize(),h=Jl(),p=a.getKey();if(a.isToken()||h!==null&&p===h&&!i||lt(d)&&(u!==null&&!u.canInsertTextBefore()&&d.anchor.offset===0||d.anchor.key===t.__key&&d.anchor.offset===0&&!a.canInsertTextBefore()&&!i||d.focus.key===t.__key&&d.focus.offset===g&&!a.canInsertTextAfter()&&!i))return void a.markDirty();const x=wt();if(!lt(x)||r===null||n===null)return void fA(a,o,x);if(x.setTextNodeRange(a,r,a,n),a.isSegmented()){const v=_n(a.getTextContent());a.replace(v),a=v}fA(a,o,x)}}}function fA(t,e,r){if(t.setTextContent(e),lt(r)){const n=t.getKey();for(const s of["anchor","focus"]){const a=r[s];a.type==="text"&&a.key===n&&(a.offset=uc(t,a.offset,"clamp"))}}}function sx(t,e,r){const n=e[r]||!1;return n==="any"||n===t[r]}function CZ(t,e){return sx(t,e,"altKey")&&sx(t,e,"ctrlKey")&&sx(t,e,"shiftKey")&&sx(t,e,"metaKey")}function Fr(t,e,r){return CZ(t,r)&&t.key.toLowerCase()===e.toLowerCase()}const Vo={ctrlKey:!mo,metaKey:mo},hA={altKey:mo,ctrlKey:!mo};function gA(t){return t.key==="Backspace"}function mA(t){return Fr(t,"a",Vo)}function TZ(t){const e=an();if(lt(t)){const r=t.anchor,n=t.focus,s=r.getNode().getTopLevelElementOrThrow().getParentOrThrow();return r.set(s.getKey(),0,"element"),n.set(s.getKey(),s.getChildrenSize(),"element"),j1(t),t}{const r=e.select(0,e.getChildrenSize());return Ns(j1(r)),r}}function Ef(t,e){t.__lexicalClassNameCache===void 0&&(t.__lexicalClassNameCache={});const r=t.__lexicalClassNameCache,n=r[e];if(n!==void 0)return n;const s=t[e];if(typeof s=="string"){const a=kD(s);return r[e]=a,a}return s}function CT(t,e,r,n,s){if(r.size===0)return;const a=n.__type,i=n.__key,o=e.get(a);o===void 0&&ct(33,a);const l=o.klass;let u=t.get(l);u===void 0&&(u=new Map,t.set(l,u));const d=u.get(i),g=d==="destroyed"&&s==="created";(d===void 0||g)&&u.set(i,g?"updated":s)}function pA(t,e,r){const n=t.getParent();let s=r,a=t;return n!==null&&(e&&r===0?(s=a.getIndexWithinParent(),a=n):e||r!==a.getChildrenSize()||(s=a.getIndexWithinParent()+1,a=n)),a.getChildAtIndex(e?s-1:s)}function ES(t,e){const r=t.offset;if(t.type==="element")return pA(t.getNode(),e,r);{const n=t.getNode();if(e&&r===0||!e&&r===n.getTextContentSize()){const s=e?n.getPreviousSibling():n.getNextSibling();return s===null?pA(n.getParentOrThrow(),e,n.getIndexWithinParent()+(e?0:1)):s}}return null}function TR(t){const e=wi(t).event,r=e&&e.inputType;return r==="insertFromPaste"||r==="insertFromPasteAsQuotation"}function Rt(t,e,r){return function(n,s,a){const i=bT(n);for(let o=4;o>=0;o--)for(let l=0;l<i.length;l++){const u=i[l],d=u._commands.get(s);if(d!==void 0){const g=d[o];if(g!==void 0){const h=Array.from(g),p=h.length;let x=!1;if(Pa(u,()=>{for(let v=0;v<p;v++)if(h[v](a,n))return void(x=!0)}),x)return x}}}return!1}(t,e,r)}function Pv(t){return!es(t)&&!t.isLastChild()&&!t.isInline()}function Wu(t,e){const r=t._keyToDOMMap.get(e);return r===void 0&&ct(75,e),r}function wm(t){const e=t.assignedSlot||t.parentElement;return jS(e)?e.host:e}function ER(t){return SZ(t)?t:Qr(t)?t.ownerDocument:null}function EZ(t){bs(),pn()._updateTags.add(t)}function NZ(t){bs(),pn()._deferred.push(t)}function NS(t,e){let r=t.getParent();for(;r!==null;){if(r.is(e))return!0;r=r.getParent()}return!1}function TT(t){const e=ER(t);return e?e.defaultView:null}function wi(t){const e=t._window;return e===null&&ct(78),e}function AZ(t){return Qe(t)&&t.isInline()||Er(t)&&t.isInline()}function jZ(t){let e=t.getParentOrThrow();for(;e!==null;){if(ia(e))return e;e=e.getParentOrThrow()}return e}function ia(t){return es(t)||Qe(t)&&t.isShadowRoot()}function ua(t){const e=pn(),r=t.getType(),n=vT(e,r);n===void 0&&ct(200,t.constructor.name,r);const{replace:s,replaceWithKlass:a}=n;if(s!==null){const i=s(t),o=i.constructor;return a!==null?i instanceof a||ct(201,a.name,a.getType(),o.name,o.getType(),t.constructor.name,r):i instanceof t.constructor&&o!==t.constructor||ct(202,o.name,o.getType(),t.constructor.name,r),i.__key===t.__key&&ct(203,t.constructor.name,r,o.name,o.getType()),i}return t}function u2(t,e){!es(t.getParent())||Qe(e)||Er(e)||ct(99)}function FZ(t){const e=Hn(t);return e===null&&ct(63,t),e}function d2(t){return(Er(t)||Qe(t)&&!t.canBeEmpty())&&!t.isInline()}function AS(t,e,r){r.style.removeProperty("caret-color"),e._blockCursorElement=null;const n=t.parentElement;n!==null&&n.removeChild(t)}function Yi(t){return qi?(t||window).getSelection():null}function PZ(t){const e=TT(t);return e?e.getSelection():null}function NR(t){return Qr(t)&&t.tagName==="A"}function Qr(t){return bh(t)&&t.nodeType===yq}function bh(t){return typeof t=="object"&&t!==null&&"nodeType"in t&&typeof t.nodeType=="number"}function jS(t){return bh(t)&&t.nodeType===_q}function FS(t){const e=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|mark|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return t.nodeName.match(e)!==null}function W1(t){const e=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return t.nodeName.match(e)!==null}function di(t){if(Er(t)&&!t.isInline())return!0;if(!Qe(t)||ia(t))return!1;const e=t.getFirstChild(),r=e===null||il(e)||_t(e)||e.isInline();return!t.isInline()&&t.canBeEmpty()!==!1&&r}function f2(t,e){let r=t;for(;r!==null&&r.getParent()!==null&&!e(r);)r=r.getParentOrThrow();return e(r)?r:null}function _m(){return pn()}const xA=new WeakMap,DZ=new Map;function yA(t){if(!t._readOnly&&t.isEmpty())return DZ;t._readOnly||ct(192);let e=xA.get(t);return e||(e=function(r){const n=new Map;for(const[s,a]of r._nodeMap){const i=a.__type;let o=n.get(i);o||(o=new Map,n.set(i,o)),o.set(s,a)}return n}(t),xA.set(t,e)),e}function ET(t){const e=t.constructor.clone(t);return e.afterCloneFrom(t),e}function NT(t,e){const r=parseInt(t.style.paddingInlineStart,10)||0,n=Math.round(r/40);e.setIndent(n)}function RZ(t){t.__lexicalUnmanaged=!0}function MZ(t){return t.__lexicalUnmanaged===!0}function d0(t,e){return function(r,n){return Object.prototype.hasOwnProperty.call(r,n)}(t,e)&&t[e]!==vh[e]}function AT(t){const e=j6 in t.prototype?t.prototype[j6]():void 0,r=function(i){return i===gT||i===Ks||i===vh}(t),n=!r&&d0(t,"getType")?t.getType():void 0;let s,a=n;if(e)if(n)s=e[n];else for(const[i,o]of Object.entries(e))a=i,s=o;if(!r&&a&&(d0(t,"getType")||(t.getType=()=>a),d0(t,"clone")||(t.clone=i=>(yT(i),new t)),d0(t,"importJSON")||(t.importJSON=s&&s.$importJSON||(i=>new t().updateFromJSON(i))),!d0(t,"importDOM")&&s)){const{importDOM:i}=s;i&&(t.importDOM=()=>i)}return{ownNodeConfig:s,ownNodeType:a}}function LZ(t){const e=_m();return bs(),new(e.resolveRegisteredNodeAfterReplacements(e.getRegisteredNode(t))).klass}const IZ={next:"previous",previous:"next"};class jT{constructor(e){this.origin=e}[Symbol.iterator](){return MT({hasNext:Gu,initial:this.getAdjacentCaret(),map:e=>e,step:e=>e.getAdjacentCaret()})}getAdjacentCaret(){return Ts(this.getNodeAtCaret(),this.direction)}getSiblingCaret(){return Ts(this.origin,this.direction)}remove(){const e=this.getNodeAtCaret();return e&&e.remove(),this}replaceOrInsert(e,r){const n=this.getNodeAtCaret();return e.is(this.origin)||e.is(n)||(n===null?this.insert(e):n.replace(e,r)),this}splice(e,r,n="next"){const s=n===this.direction?r:Array.from(r).reverse();let a=this;const i=this.getParentAtCaret(),o=new Map;for(let l=a.getAdjacentCaret();l!==null&&o.size<e;l=l.getAdjacentCaret()){const u=l.origin.getWritable();o.set(u.getKey(),u)}for(const l of s){if(o.size>0){const u=a.getNodeAtCaret();if(u){if(o.delete(u.getKey()),o.delete(l.getKey()),!(u.is(l)||a.origin.is(l))){const d=l.getParent();d&&d.is(i)&&l.remove(),u.replace(l)}}else u===null&&ct(263,Array.from(o).join(" "))}else a.insert(l);a=Ts(l,this.direction)}for(const l of o.values())l.remove();return this}}class Rg extends jT{constructor(){super(...arguments);Za(this,"type","child")}getLatest(){const r=this.origin.getLatest();return r===this.origin?this:_i(r,this.direction)}getParentCaret(r="root"){return Ts(FT(this.getParentAtCaret(),r),this.direction)}getFlipped(){const r=Sh(this.direction);return Ts(this.getNodeAtCaret(),r)||_i(this.origin,r)}getParentAtCaret(){return this.origin}getChildCaret(){return this}isSameNodeCaret(r){return r instanceof Rg&&this.direction===r.direction&&this.origin.is(r.origin)}isSamePointCaret(r){return this.isSameNodeCaret(r)}}const OZ={root:es,shadowRoot:ia};function Sh(t){return IZ[t]}function FT(t,e="root"){return OZ[e](t)?null:t}class zu extends jT{constructor(){super(...arguments);Za(this,"type","sibling")}getLatest(){const r=this.origin.getLatest();return r===this.origin?this:Ts(r,this.direction)}getSiblingCaret(){return this}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return Qe(this.origin)?_i(this.origin,this.direction):null}getParentCaret(r="root"){return Ts(FT(this.getParentAtCaret(),r),this.direction)}getFlipped(){const r=Sh(this.direction);return Ts(this.getNodeAtCaret(),r)||_i(this.origin.getParentOrThrow(),r)}isSamePointCaret(r){return r instanceof zu&&this.direction===r.direction&&this.origin.is(r.origin)}isSameNodeCaret(r){return(r instanceof zu||r instanceof Hu)&&this.direction===r.direction&&this.origin.is(r.origin)}}class Hu extends jT{constructor(r,n){super(r);Za(this,"type","text");this.offset=n}getLatest(){const r=this.origin.getLatest();return r===this.origin?this:Vu(r,this.direction,this.offset)}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return null}getParentCaret(r="root"){return Ts(FT(this.getParentAtCaret(),r),this.direction)}getFlipped(){return Vu(this.origin,Sh(this.direction),this.offset)}isSamePointCaret(r){return r instanceof Hu&&this.direction===r.direction&&this.origin.is(r.origin)&&this.offset===r.offset}isSameNodeCaret(r){return(r instanceof zu||r instanceof Hu)&&this.direction===r.direction&&this.origin.is(r.origin)}getSiblingCaret(){return Ts(this.origin,this.direction)}}function cc(t){return t instanceof Hu}function Gu(t){return t instanceof zu}function To(t){return t instanceof Rg}const BZ={next:class extends Hu{constructor(){super(...arguments);Za(this,"direction","next")}getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends Hu{constructor(){super(...arguments);Za(this,"direction","previous")}getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},UZ={next:class extends zu{constructor(){super(...arguments);Za(this,"direction","next")}getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends zu{constructor(){super(...arguments);Za(this,"direction","previous")}getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},$Z={next:class extends Rg{constructor(){super(...arguments);Za(this,"direction","next")}getNodeAtCaret(){return this.origin.getFirstChild()}insert(e){return this.origin.splice(0,0,[e]),this}},previous:class extends Rg{constructor(){super(...arguments);Za(this,"direction","previous")}getNodeAtCaret(){return this.origin.getLastChild()}insert(e){return this.origin.splice(this.origin.getChildrenSize(),0,[e]),this}}};function Ts(t,e){return t?new UZ[e](t):null}function Vu(t,e,r){return t?new BZ[e](t,uc(t,r)):null}function uc(t,e,r="error"){const n=t.getTextContentSize();let s=e==="next"?n:e==="previous"?0:e;return(s<0||s>n)&&(r!=="clamp"&&function(a,...i){const o=new URL("https://lexical.dev/docs/error"),l=new URLSearchParams;l.append("code",a);for(const u of i)l.append("v",u);o.search=l.toString(),console.warn(`Minified Lexical warning #${a}; visit ${o.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(284,String(e),String(n),t.getKey()),s=s<0?0:n),s}function vA(t,e){return new zZ(t,e)}function _i(t,e){return Qe(t)?new $Z[e](t):null}function WZ(t){return t&&t.getChildCaret()||t}function PT(t){return t&&WZ(t.getAdjacentCaret())}class DT{constructor(e,r,n){Za(this,"type","node-caret-range");this.anchor=e,this.focus=r,this.direction=n}getLatest(){const e=this.anchor.getLatest(),r=this.focus.getLatest();return e===this.anchor&&r===this.focus?this:new DT(e,r,this.direction)}isCollapsed(){return this.anchor.isSamePointCaret(this.focus)}getTextSlices(){const e=s=>{const a=this[s].getLatest();return cc(a)?function(i,o){const{direction:l,origin:u}=i,d=uc(u,o==="focus"?Sh(l):l);return vA(i,d-i.offset)}(a,s):null},r=e("anchor"),n=e("focus");if(r&&n){const{caret:s}=r,{caret:a}=n;if(s.isSameNodeCaret(a))return[vA(s,a.offset-s.offset),null]}return[r,n]}iterNodeCarets(e="root"){const r=cc(this.anchor)?this.anchor.getSiblingCaret():this.anchor.getLatest(),n=this.focus.getLatest(),s=cc(n),a=i=>i.isSameNodeCaret(n)?null:PT(i)||i.getParentCaret(e);return MT({hasNext:i=>i!==null&&!(s&&n.isSameNodeCaret(i)),initial:r.isSameNodeCaret(n)?null:a(r),map:i=>i,step:a})}[Symbol.iterator](){return this.iterNodeCarets("root")}}class zZ{constructor(e,r){Za(this,"type","slice");this.caret=e,this.distance=r}getSliceIndices(){const{distance:e,caret:{offset:r}}=this,n=r+e;return n<r?[n,r]:[r,n]}getTextContent(){const[e,r]=this.getSliceIndices();return this.caret.origin.getTextContent().slice(e,r)}getTextContentSize(){return Math.abs(this.distance)}removeTextSlice(){const{caret:{origin:e,direction:r}}=this,[n,s]=this.getSliceIndices(),a=e.getTextContent();return Vu(e.setTextContent(a.slice(0,n)+a.slice(s)),r,n)}}function RT(t){return vc(t,Ts(an(),t.direction))}function HZ(t){return vc(t,t)}function vc(t,e){return t.direction!==e.direction&&ct(265),new DT(t,e,t.direction)}function MT(t){const{initial:e,hasNext:r,step:n,map:s}=t;let a=e;return{[Symbol.iterator](){return this},next(){if(!r(a))return{done:!0,value:void 0};const i={done:!1,value:s(a)};return a=n(a),i}}}function AR(t,e){const r=$x(t.origin,e.origin);switch(r===null&&ct(275,t.origin.getKey(),e.origin.getKey()),r.type){case"same":{const n=t.type==="text",s=e.type==="text";return n&&s?function(a,i){return Math.sign(a-i)}(t.offset,e.offset):t.type===e.type?0:n?-1:s?1:t.type==="child"?-1:1}case"ancestor":return t.type==="child"?-1:1;case"descendant":return e.type==="child"?1:-1;case"branch":return jR(r)}}function jR(t){const{a:e,b:r}=t,n=e.__key,s=r.__key;let a=e,i=r;for(;a&&i;a=a.getNextSibling(),i=i.getNextSibling()){if(a.__key===s)return-1;if(i.__key===n)return 1}return a===null?1:-1}function ax(t,e){return e.is(t)}function wA(t){return Qe(t)?[t.getLatest(),null]:[t.getParent(),t.getLatest()]}function $x(t,e){if(t.is(e))return{commonAncestor:t,type:"same"};const r=new Map;for(let[n,s]=wA(t);n;s=n,n=n.getParent())r.set(n,s);for(let[n,s]=wA(e);n;s=n,n=n.getParent()){const a=r.get(n);if(a!==void 0)return a===null?(ax(t,n)||ct(276),{commonAncestor:n,type:"ancestor"}):s===null?(ax(e,n)||ct(277),{commonAncestor:n,type:"descendant"}):((Qe(a)||ax(t,a))&&(Qe(s)||ax(e,s))&&n.is(a.getParent())&&n.is(s.getParent())||ct(278),{a,b:s,commonAncestor:n,type:"branch"})}return null}function xl(t,e){const{type:r,key:n,offset:s}=t,a=FZ(t.key);return r==="text"?(_t(a)||ct(266,a.getType(),n),Vu(a,e,s)):(Qe(a)||ct(267,a.getType(),n),KZ(a,t.offset,e))}function Ku(t,e){const{origin:r,direction:n}=e,s=n==="next";cc(e)?t.set(r.getKey(),e.offset,"text"):Gu(e)?_t(r)?t.set(r.getKey(),uc(r,n),"text"):t.set(r.getParentOrThrow().getKey(),r.getIndexWithinParent()+(s?1:0),"element"):(To(e)&&Qe(r)||ct(268),t.set(r.getKey(),s?0:r.getChildrenSize(),"element"))}function GZ(t){const e=wt(),r=lt(e)?e:Tv();return Wx(r,t),Ns(r),r}function Wx(t,e){Ku(t.anchor,e.anchor),Ku(t.focus,e.focus)}function _A(t){const{anchor:e,focus:r}=t,n=xl(e,"next"),s=xl(r,"next"),a=AR(n,s)<=0?"next":"previous";return vc(Qf(n,a),Qf(s,a))}function LT(t){const{direction:e,origin:r}=t,n=Ts(r,Sh(e)).getNodeAtCaret();return n?Ts(n,e):_i(r.getParentOrThrow(),e)}function bA(t,e="root"){const r=[t];for(let n=To(t)?t.getParentCaret(e):t.getSiblingCaret();n!==null;n=n.getParentCaret(e))r.push(LT(n));return r}function h2(t){return!!t&&t.origin.isAttached()}function VZ(t,e="removeEmptySlices"){if(t.isCollapsed())return t;const r="root",n="next";let s=e;const a=PR(t,n),i=bA(a.anchor,r),o=bA(a.focus.getFlipped(),r),l=new Set,u=[];for(const x of a.iterNodeCarets(r))if(To(x))l.add(x.origin.getKey());else if(Gu(x)){const{origin:v}=x;Qe(v)&&!l.has(v.getKey())||u.push(v)}for(const x of u)x.remove();for(const x of a.getTextSlices()){if(!x)continue;const{origin:v}=x.caret,w=v.getTextContentSize(),S=LT(Ts(v,n)),_=v.getMode();if(Math.abs(x.distance)===w&&s==="removeEmptySlices"||_==="token"&&x.distance!==0)S.remove();else if(x.distance!==0){s="removeEmptySlices";let y=x.removeTextSlice();const k=x.caret.origin;if(_==="segmented"){const N=y.origin,E=_n(N.getTextContent()).setStyle(N.getStyle()).setFormat(N.getFormat());S.replaceOrInsert(E),y=Vu(E,n,y.offset)}k.is(i[0].origin)&&(i[0]=y),k.is(o[0].origin)&&(o[0]=y.getFlipped())}}let d,g;for(const x of i)if(h2(x)){d=gi(x);break}for(const x of o)if(h2(x)){g=gi(x);break}const h=function(x,v,w){if(!x||!v)return null;const S=x.getParentAtCaret(),_=v.getParentAtCaret();if(!S||!_)return null;const y=S.getParents().reverse();y.push(S);const k=_.getParents().reverse();k.push(_);const N=Math.min(y.length,k.length);let E;for(E=0;E<N&&y[E]===k[E];E++);const A=(D,R)=>{let M;for(let B=E;B<D.length;B++){const J=D[B];if(ia(J))return;!M&&R(J)&&(M=J)}return M},C=A(y,di),F=C&&A(k,D=>w.has(D.getKey())&&di(D));return C&&F?[C,F]:null}(d,g,l);if(h){const[x,v]=h;_i(x,"previous").splice(0,v.getChildren()),v.remove()}const p=[d,g,...i,...o].find(h2);if(p)return HZ(Qf(gi(p),t.direction));ct(269,JSON.stringify(i.map(x=>x.origin.__key)))}function gi(t){const e=function(s){let a=s;for(;To(a);){const i=PT(a);if(!To(i))break;a=i}return a}(t.getLatest()),{direction:r}=e;if(_t(e.origin))return cc(e)?e:Vu(e.origin,r,r);const n=e.getAdjacentCaret();return Gu(n)&&_t(n.origin)?Vu(n.origin,r,Sh(r)):e}function FR(t){return cc(t)&&t.offset!==uc(t.origin,t.direction)}function Qf(t,e){return t.direction===e?t:t.getFlipped()}function PR(t,e){return t.direction===e?t:vc(Qf(t.focus,e),Qf(t.anchor,e))}function KZ(t,e,r){let n=_i(t,"next");for(let s=0;s<e;s++){const a=n.getAdjacentCaret();if(a===null)break;n=a}return Qf(n,r)}const DR=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,XZ=DR?b.useLayoutEffect:b.useEffect,ix={tag:G0};function RR({initialConfig:t,children:e}){const r=b.useMemo(()=>{const{theme:n,namespace:s,nodes:a,onError:i,editorState:o,html:l}=t,u=mq(null,n),d=wZ({editable:t.editable,html:l,namespace:s,nodes:a,onError:g=>i(g,d),theme:n});return function(g,h){if(h!==null){if(h===void 0)g.update(()=>{const p=an();if(p.isEmpty()){const x=Jr();p.append(x);const v=DR?document.activeElement:null;(wt()!==null||v!==null&&v===g.getRootElement())&&x.select()}},ix);else if(h!==null)switch(typeof h){case"string":{const p=g.parseEditorState(h);g.setEditorState(p,ix);break}case"object":g.setEditorState(h,ix);break;case"function":g.update(()=>{an().isEmpty()&&h(g)},ix)}}}(d,o),[d,u]},[]);return XZ(()=>{const n=t.editable,[s]=r;s.setEditable(n===void 0||n)},[]),c.jsx(yh.Provider,{value:r,children:e})}const YZ=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?b.useLayoutEffect:b.useEffect;function JZ(t){return{initialValueFn:()=>t.isEditable(),subscribe:e=>t.registerEditableListener(e)}}function QZ(){return function(t){const[e]=Fo(),r=b.useMemo(()=>t(e),[e,t]),[n,s]=b.useState(()=>r.initialValueFn()),a=b.useRef(n);return YZ(()=>{const{initialValueFn:i,subscribe:o}=r,l=i();return a.current!==l&&(a.current=l,s(l)),o(u=>{a.current=u,s(u)})},[r,t]),n}(JZ)}function qZ(){return an().getTextContent()}function ZZ(t,e=!0){if(t)return!1;let r=qZ();return e&&(r=r.trim()),r===""}function eee(t){if(!ZZ(t,!1))return!1;const e=an().getChildren(),r=e.length;if(r>1)return!1;for(let n=0;n<r;n++){const s=e[n];if(Er(s))return!1;if(Qe(s)){if(!xT(s)||s.__indent!==0)return!1;const a=s.getChildren(),i=a.length;for(let o=0;o<i;o++){const l=a[n];if(!_t(l))return!1}}}return!0}function MR(t){return()=>eee(t)}const PS=new Map;function LR(t){const e={};if(!t)return e;const r=t.split(";");for(const n of r)if(n!==""){const[s,a]=n.split(/:([^]+)/);s&&a&&(e[s.trim()]=a.trim())}return e}function SA(t){let e=PS.get(t);return e===void 0&&(e=LR(t),PS.set(t,e)),e}function IR(t){const e=_m().getElementByKey(t.getKey());if(e===null)return null;const r=e.ownerDocument.defaultView;return r===null?null:r.getComputedStyle(e)}function OR(t){return IR(es(t)?t:t.getParentOrThrow())}function kA(t){const e=OR(t);return e!==null&&e.direction==="rtl"}function BR(t,e){const r=t.getStartEndPoints();if(e.isSelected(t)&&!Xo(e)&&r!==null){const[n,s]=r,a=t.isBackward(),i=n.getNode(),o=s.getNode(),l=e.is(i),u=e.is(o);if(l||u){const[d,g]=kS(t),h=i.is(o),p=e.is(a?o:i),x=e.is(a?i:o);let v,w=0;h?(w=d>g?g:d,v=d>g?d:g):p?(w=a?g:d,v=void 0):x&&(w=0,v=a?d:g),e.__text=e.__text.slice(w,v)}}return e}function tee(t){const e=t.getStyle(),r=LR(e);PS.set(e,r)}function ree(t,e){const r=t.getFormatType(),n=t.getIndent();r!==e.getFormatType()&&e.setFormat(r),n!==e.getIndent()&&e.setIndent(n)}function Nf(t,e,r=ree){if(t===null)return;const n=t.getStartEndPoints(),s=new Map;let a=null;if(n){const[i,o]=n;a=Tv(),a.anchor.set(i.key,i.offset,i.type),a.focus.set(o.key,o.offset,o.type);const l=g2(i.getNode(),di),u=g2(o.getNode(),di);Qe(l)&&s.set(l.getKey(),l),Qe(u)&&s.set(u.getKey(),u)}for(const i of t.getNodes())if(Qe(i)&&di(i))s.set(i.getKey(),i);else if(n===null){const o=g2(i,di);Qe(o)&&s.set(o.getKey(),o)}for(const[i,o]of s){const l=e();r(o,l),o.replace(l,!0),a&&(i===a.anchor.key&&a.anchor.set(l.getKey(),a.anchor.offset,a.anchor.type),i===a.focus.key&&a.focus.set(l.getKey(),a.focus.offset,a.focus.type))}a&&t.is(wt())&&Ns(a)}function UR(t){const e=$R(t);return e!==null&&e.writingMode==="vertical-rl"}function $R(t){const e=t.anchor.getNode();return Qe(e)?IR(e):OR(e)}function CA(t,e){let r=UR(t)?!e:e;WR(t)&&(r=!r);const n=xl(t.focus,r?"previous":"next");if(FR(n))return!1;for(const s of RT(n)){if(To(s))return!s.origin.isInline();if(!Qe(s.origin)){if(Er(s.origin))return!0;break}}return!1}function nee(t,e,r,n){t.modify(e?"extend":"move",r,n)}function WR(t){const e=$R(t);return e!==null&&e.direction==="rtl"}function TA(t,e,r){const n=WR(t);let s;s=UR(t)||n?!r:r,nee(t,e,s,"character")}function g2(t,e){let r=t;for(;r!==null&&r.getParent()!==null&&!e(r);)r=r.getParentOrThrow();return e(r)?r:null}function see(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const zR=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,aee=zR&&"documentMode"in document?document.documentMode:null;!(!zR||!("InputEvent"in window)||aee)&&"getTargetRanges"in new window.InputEvent("input");function HR(...t){const e=[];for(const r of t)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))e.push(n);return e}function hd(...t){return()=>{for(let e=t.length-1;e>=0;e--)t[e]();t.length=0}}function Qn(t,...e){const r=HR(...e);r.length>0&&t.classList.add(...r)}function dc(t,...e){const r=HR(...e);r.length>0&&t.classList.remove(...r)}function iee(t){return t?t.getAdjacentCaret():null}function oee(t,e){let r=t;for(;r!=null;){if(r instanceof e)return r;r=r.getParent()}return null}function lee(t){const e=Dv(t,r=>Qe(r)&&!r.isInline());return Qe(e)||see(4,t.__key),e}const Dv=(t,e)=>{let r=t;for(;r!==an()&&r!=null;){if(e(r))return r;r=r.getParent()}return null};function mu(t,e){return t!==null&&Object.getPrototypeOf(t).constructor.name===e.name}function GR(t,e){const r=[],n=Array.from(t).reverse();for(let s=n.pop();s!==void 0;s=n.pop())if(e(s))r.push(s);else if(Qe(s))for(const a of cee(s))n.push(a);return r}function cee(t){return uee(_i(t,"previous"))}function uee(t){return MT({hasNext:Gu,initial:t.getAdjacentCaret(),map:e=>e.origin.getLatest(),step:e=>e.getAdjacentCaret()})}function dee(t){const e=window.location.origin,r=n=>{if(n.origin!==e)return;const s=t.getRootElement();if(document.activeElement!==s)return;const a=n.data;if(typeof a=="string"){let i;try{i=JSON.parse(a)}catch{return}if(i&&i.protocol==="nuanria_messaging"&&i.type==="request"){const o=i.payload;if(o&&o.functionId==="makeChanges"){const l=o.args;if(l){const[u,d,g,h,p,x]=l;t.update(()=>{const v=wt();if(lt(v)){const w=v.anchor;let S=w.getNode(),_=0,y=0;if(_t(S)&&u>=0&&d>=0&&(_=u,y=u+d,v.setTextNodeRange(S,_,S,y)),_===y&&g===""||(v.insertRawText(g),S=w.getNode()),_t(S)){_=h,y=h+p;const k=S.getTextContentSize();_=_>k?k:_,y=y>k?k:y,v.setTextNodeRange(S,_,S,y)}n.stopImmediatePropagation()}})}}}}};return window.addEventListener("message",r,!0),()=>{window.removeEventListener("message",r,!0)}}function fee(t,e){const r=e.body?e.body.childNodes:[];let n=[];const s=[];for(let a=0;a<r.length;a++){const i=r[a];if(!KR.has(i.nodeName)){const o=XR(i,t,s,!1);o!==null&&(n=n.concat(o))}}return function(a){for(const i of a)i.getNextSibling()instanceof pT&&i.insertAfter(Eo());for(const i of a){const o=i.getChildren();for(const l of o)i.insertBefore(l);i.remove()}}(s),n}function hee(t,e){if(typeof document>"u"||typeof window>"u"&&global.window===void 0)throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");const r=document.createElement("div"),n=an().getChildren();for(let s=0;s<n.length;s++)VR(t,n[s],r,e);return r.innerHTML}function VR(t,e,r,n=null){let s=n===null||e.isSelected(n);const a=Qe(e)&&e.excludeFromCopy("html");let i=e;if(n!==null){let p=ET(e);p=_t(p)&&n!==null?BR(n,p):p,i=p}const o=Qe(i)?i.getChildren():[],l=vT(t,i.getType());let u;u=l&&l.exportDOM!==void 0?l.exportDOM(t,i):i.exportDOM(t);const{element:d,after:g}=u;if(!d)return!1;const h=document.createDocumentFragment();for(let p=0;p<o.length;p++){const x=o[p],v=VR(t,x,h,n);!s&&Qe(e)&&v&&e.extractWithChild(x,n,"html")&&(s=!0)}if(s&&!a){if((Qr(d)||jS(d))&&d.append(h),r.append(d),g){const p=g.call(i,d);p&&(jS(d)?d.replaceChildren(p):d.replaceWith(p))}}else r.append(h);return s}const KR=new Set(["STYLE","SCRIPT"]);function XR(t,e,r,n,s=new Map,a){let i=[];if(KR.has(t.nodeName))return i;let o=null;const l=function(x,v){const{nodeName:w}=x,S=v._htmlConversions.get(w.toLowerCase());let _=null;if(S!==void 0)for(const y of S){const k=y(x);k!==null&&(_===null||(_.priority||0)<=(k.priority||0))&&(_=k)}return _!==null?_.conversion:null}(t,e),u=l?l(t):null;let d=null;if(u!==null){d=u.after;const x=u.node;if(o=Array.isArray(x)?x[x.length-1]:x,o!==null){for(const[,v]of s)if(o=v(o,a),!o)break;o&&i.push(...Array.isArray(x)?x:[o])}u.forChild!=null&&s.set(t.nodeName,u.forChild)}const g=t.childNodes;let h=[];const p=(o==null||!ia(o))&&(o!=null&&CS(o)||n);for(let x=0;x<g.length;x++)h.push(...XR(g[x],e,r,p,new Map(s),o));return d!=null&&(h=d(h)),W1(t)&&(h=gee(t,h,p?()=>{const x=new pT;return r.push(x),x}:Jr)),o==null?h.length>0?i=i.concat(h):W1(t)&&function(x){return x.nextSibling==null||x.previousSibling==null?!1:FS(x.nextSibling)&&FS(x.previousSibling)}(t)&&(i=i.concat(Eo())):Qe(o)&&o.append(...h),i}function gee(t,e,r){const n=t.style.textAlign,s=[];let a=[];for(let i=0;i<e.length;i++){const o=e[i];if(CS(o))n&&!o.getFormat()&&o.setFormat(n),s.push(o);else if(a.push(o),i===e.length-1||i<e.length-1&&CS(e[i+1])){const l=r();l.setFormat(n),l.append(...a),s.push(l),a=[]}}return s}function z1(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function mee(t,e=wt()){return e==null&&z1(166),lt(e)&&e.isCollapsed()||e.getNodes().length===0?"":hee(t,e)}function pee(t,e=wt()){return e==null&&z1(166),lt(e)&&e.isCollapsed()||e.getNodes().length===0?null:JSON.stringify(xee(t,e))}function EA(t,e,r){const n=t.getData("application/x-lexical-editor");if(n)try{const o=JSON.parse(n);if(o.namespace===r._config.namespace&&Array.isArray(o.nodes))return NA(r,yee(o.nodes),e)}catch{}const s=t.getData("text/html"),a=t.getData("text/plain");if(s&&a!==s)try{const o=new DOMParser().parseFromString(function(l){return window.trustedTypes&&window.trustedTypes.createPolicy?window.trustedTypes.createPolicy("lexical",{createHTML:u=>u}).createHTML(l):l}(s),"text/html");return NA(r,fee(r,o),e)}catch{}const i=a||t.getData("text/uri-list");if(i!=null)if(lt(e)){const o=i.split(/(\r?\n|\t)/);o[o.length-1]===""&&o.pop();for(let l=0;l<o.length;l++){const u=wt();if(lt(u)){const d=o[l];d===`
`||d===`\r
`?u.insertParagraph():d==="	"?u.insertNodes([wh()]):u.insertText(d)}}}else e.insertRawText(i)}function NA(t,e,r){t.dispatchCommand(Wq,{nodes:e,selection:r})||(r.insertNodes(e),function(n){if(lt(n)&&n.isCollapsed()){const s=n.anchor;let a=null;const i=xl(s,"previous");if(i)if(cc(i))a=i.origin;else{const o=vc(i,_i(an(),"next").getFlipped());for(const l of o){if(_t(l.origin)){a=l.origin;break}if(Qe(l.origin)&&!l.origin.isInline())break}}if(a&&_t(a)){const o=a.getFormat(),l=a.getStyle();n.format===o&&n.style===l||(n.format=o,n.style=l,n.dirty=!0)}}}(r))}function YR(t,e,r,n=[]){let s=e===null||r.isSelected(e);const a=Qe(r)&&r.excludeFromCopy("html");let i=r;if(e!==null){let u=ET(r);u=_t(u)&&e!==null?BR(e,u):u,i=u}const o=Qe(i)?i.getChildren():[],l=function(u){const d=u.exportJSON(),g=u.constructor;if(d.type!==g.getType()&&z1(58,g.name),Qe(u)){const h=d.children;Array.isArray(h)||z1(59,g.name)}return d}(i);if(_t(i)){const u=i.__text;u.length>0?l.text=u:s=!1}for(let u=0;u<o.length;u++){const d=o[u],g=YR(t,e,d,l.children);!s&&Qe(r)&&g&&r.extractWithChild(d,e,"clone")&&(s=!0)}if(s&&!a)n.push(l);else if(Array.isArray(l.children))for(let u=0;u<l.children.length;u++){const d=l.children[u];n.push(d)}return s}function xee(t,e){const r=[],n=an().getChildren();for(let s=0;s<n.length;s++)YR(t,e,n[s],r);return{namespace:t._config.namespace,nodes:r}}function yee(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r],s=hZ(n);_t(s)&&tee(s),e.push(s)}return e}let Bd=null;async function AA(t,e,r){if(Bd!==null)return!1;if(e!==null)return new Promise((u,d)=>{t.update(()=>{u(jA(t,e,r))})});const n=t.getRootElement(),s=t._window||window,a=window.document,i=Yi(s);if(n===null||i===null)return!1;const o=a.createElement("span");o.style.cssText="position: fixed; top: -1000px;",o.append(a.createTextNode("#")),n.append(o);const l=new Range;return l.setStart(o,0),l.setEnd(o,1),i.removeAllRanges(),i.addRange(l),new Promise((u,d)=>{const g=t.registerCommand(Sv,h=>(mu(h,ClipboardEvent)&&(g(),Bd!==null&&(window.clearTimeout(Bd),Bd=null),u(jA(t,h,r))),!0),vZ);Bd=window.setTimeout(()=>{g(),Bd=null,u(!1)},50),a.execCommand("copy"),o.remove()})}function jA(t,e,r){if(r===void 0){const s=Yi(t._window);if(!s)return!1;const a=s.anchorNode,i=s.focusNode;if(a!==null&&i!==null&&!vm(t,a,i))return!1;const o=wt();if(o===null)return!1;r=wee(o)}e.preventDefault();const n=e.clipboardData;return n!==null&&(_ee(n,r),!0)}const vee=[["text/html",mee],["application/x-lexical-editor",pee]];function wee(t=wt()){const e={"text/plain":t?t.getTextContent():""};if(t){const r=_m();for(const[n,s]of vee){const a=s(r,t);a!==null&&(e[n]=a)}}return e}function _ee(t,e){for(const r in e){const n=e[r];n!==void 0&&t.setData(r,n)}}function FA(t,e){if(document.caretRangeFromPoint!==void 0){const r=document.caretRangeFromPoint(t,e);return r===null?null:{node:r.startContainer,offset:r.startOffset}}if(document.caretPositionFromPoint!=="undefined"){const r=document.caretPositionFromPoint(t,e);return r===null?null:{node:r.offsetNode,offset:r.offset}}return null}const kh=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,bee=kh&&"documentMode"in document?document.documentMode:null,See=!(!kh||!("InputEvent"in window)||bee)&&"getTargetRanges"in new window.InputEvent("input"),kee=kh&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),PA=kh&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,Cee=kh&&/^(?=.*Chrome).*/i.test(navigator.userAgent),Tee=kh&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!Cee,DA=Vt("DRAG_DROP_PASTE_FILE");let bm=class JR extends Ks{static getType(){return"quote"}static clone(e){return new JR(e.__key)}createDOM(e){const r=document.createElement("blockquote");return Qn(r,e.theme.quote),r}updateDOM(e,r){return!1}static importDOM(){return{blockquote:e=>({conversion:Eee,priority:0})}}exportDOM(e){const{element:r}=super.exportDOM(e);if(Qr(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(e){return Sm().updateFromJSON(e)}insertNewAfter(e,r){const n=Jr(),s=this.getDirection();return n.setDirection(s),this.insertAfter(n,r),n}collapseAtStart(){const e=Jr();return this.getChildren().forEach(r=>e.append(r)),this.replace(e),!0}canMergeWhenEmpty(){return!0}};function Sm(){return ua(new bm)}function RA(t){return t instanceof bm}let km=class QR extends Ks{static getType(){return"heading"}static clone(e){return new QR(e.__tag,e.__key)}constructor(e,r){super(r),this.__tag=e}getTag(){return this.__tag}setTag(e){const r=this.getWritable();return this.__tag=e,r}createDOM(e){const r=this.__tag,n=document.createElement(r),s=e.theme.heading;if(s!==void 0){const a=s[r];Qn(n,a)}return n}updateDOM(e,r,n){return e.__tag!==this.__tag}static importDOM(){return{h1:e=>({conversion:Ud,priority:0}),h2:e=>({conversion:Ud,priority:0}),h3:e=>({conversion:Ud,priority:0}),h4:e=>({conversion:Ud,priority:0}),h5:e=>({conversion:Ud,priority:0}),h6:e=>({conversion:Ud,priority:0}),p:e=>{const r=e.firstChild;return r!==null&&MA(r)?{conversion:()=>({node:null}),priority:3}:null},span:e=>MA(e)?{conversion:r=>({node:Ql("h1")}),priority:3}:null}}exportDOM(e){const{element:r}=super.exportDOM(e);if(Qr(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(e){return Ql(e.tag).updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setTag(e.tag)}exportJSON(){return{...super.exportJSON(),tag:this.getTag()}}insertNewAfter(e,r=!0){const n=e?e.anchor.offset:0,s=this.getLastDescendant(),a=!s||e&&e.anchor.key===s.getKey()&&n===s.getTextContentSize()||!e?Jr():Ql(this.getTag()),i=this.getDirection();if(a.setDirection(i),this.insertAfter(a,r),n===0&&!this.isEmpty()&&e){const o=Jr();o.select(),this.replace(o,!0)}return a}collapseAtStart(){const e=this.isEmpty()?Jr():Ql(this.getTag());return this.getChildren().forEach(r=>e.append(r)),this.replace(e),!0}extractWithChild(){return!0}};function MA(t){return t.nodeName.toLowerCase()==="span"&&t.style.fontSize==="26pt"}function Ud(t){const e=t.nodeName.toLowerCase();let r=null;return e!=="h1"&&e!=="h2"&&e!=="h3"&&e!=="h4"&&e!=="h5"&&e!=="h6"||(r=Ql(e),t.style!==null&&(NT(t,r),r.setFormat(t.style.textAlign))),{node:r}}function Eee(t){const e=Sm();return t.style!==null&&(e.setFormat(t.style.textAlign),NT(t,e)),{node:e}}function Ql(t="h1"){return ua(new km(t))}function Nee(t){return t instanceof km}function ox(t){let e=null;if(mu(t,DragEvent)?e=t.dataTransfer:mu(t,ClipboardEvent)&&(e=t.clipboardData),e===null)return[!1,[],!1];const r=e.types,n=r.includes("Files"),s=r.includes("text/html")||r.includes("text/plain");return[n,Array.from(e.files),s]}function LA(t){const e=wt();if(!lt(e))return!1;const r=new Set,n=e.getNodes();for(let s=0;s<n.length;s++){const a=n[s],i=a.getKey();if(r.has(i))continue;const o=Dv(a,u=>Qe(u)&&!u.isInline());if(o===null)continue;const l=o.getKey();o.canIndent()&&!r.has(l)&&(r.add(l),t(o))}return r.size>0}function IA(t){const e=yc(t);return Er(e)}function m2(t){for(const e of["lowercase","uppercase","capitalize"])t.hasFormat(e)&&t.toggleFormat(e)}function Aee(t){return hd(t.registerCommand(aT,e=>{const r=wt();return!!Ls(r)&&(r.clear(),!0)},pr),t.registerCommand(Su,e=>{const r=wt();return lt(r)?(r.deleteCharacter(e),!0):!!Ls(r)&&(r.deleteNodes(),!0)},pr),t.registerCommand(Pg,e=>{const r=wt();return!!lt(r)&&(r.deleteWord(e),!0)},pr),t.registerCommand(Dg,e=>{const r=wt();return!!lt(r)&&(r.deleteLine(e),!0)},pr),t.registerCommand(Cf,e=>{const r=wt();if(typeof e=="string")r!==null&&r.insertText(e);else{if(r===null)return!1;const n=e.dataTransfer;if(n!=null)EA(n,r,t);else if(lt(r)){const s=e.data;return s&&r.insertText(s),!0}}return!0},pr),t.registerCommand(xS,()=>{const e=wt();return!!lt(e)&&(e.removeText(),!0)},pr),t.registerCommand(zs,e=>{const r=wt();return!!lt(r)&&(r.formatText(e),!0)},pr),t.registerCommand(KD,e=>{const r=wt();if(!lt(r)&&!Ls(r))return!1;const n=r.getNodes();for(const s of n){const a=Dv(s,i=>Qe(i)&&!i.isInline());a!==null&&a.setFormat(e)}return!0},pr),t.registerCommand(kf,e=>{const r=wt();return!!lt(r)&&(r.insertLineBreak(e),!0)},pr),t.registerCommand(Fg,()=>{const e=wt();return!!lt(e)&&(e.insertParagraph(),!0)},pr),t.registerCommand(Vq,()=>(uZ([wh()]),!0),pr),t.registerCommand(Kq,()=>LA(e=>{const r=e.getIndent();e.setIndent(r+1)}),pr),t.registerCommand(U6,()=>LA(e=>{const r=e.getIndent();r>0&&e.setIndent(Math.max(0,r-1))}),pr),t.registerCommand(BD,e=>{const r=wt();if(Ls(r)){const n=r.getNodes();if(n.length>0)return n[0].selectPrevious(),!0}else if(lt(r)){const n=ES(r.focus,!0);if(!e.shiftKey&&Er(n)&&!n.isIsolated()&&!n.isInline())return n.selectPrevious(),e.preventDefault(),!0}return!1},pr),t.registerCommand(UD,e=>{const r=wt();if(Ls(r)){const n=r.getNodes();if(n.length>0)return n[0].selectNext(0,0),!0}else if(lt(r)){if(function(s){const a=s.focus;return a.key==="root"&&a.offset===an().getChildrenSize()}(r))return e.preventDefault(),!0;const n=ES(r.focus,!1);if(!e.shiftKey&&Er(n)&&!n.isIsolated()&&!n.isInline())return n.selectNext(),e.preventDefault(),!0}return!1},pr),t.registerCommand(OD,e=>{const r=wt();if(Ls(r)){const n=r.getNodes();if(n.length>0)return e.preventDefault(),kA(n[0])?n[0].selectNext(0,0):n[0].selectPrevious(),!0}if(!lt(r))return!1;if(CA(r,!0)){const n=e.shiftKey;return e.preventDefault(),TA(r,n,!0),!0}return!1},pr),t.registerCommand(ID,e=>{const r=wt();if(Ls(r)){const s=r.getNodes();if(s.length>0)return e.preventDefault(),kA(s[0])?s[0].selectPrevious():s[0].selectNext(0,0),!0}if(!lt(r))return!1;const n=e.shiftKey;return!!CA(r,!1)&&(e.preventDefault(),TA(r,n,!1),!0)},pr),t.registerCommand(WD,e=>{if(IA(e.target))return!1;const r=wt();if(lt(r)){if(function(n){if(!n.isCollapsed())return!1;const{anchor:s}=n;if(s.offset!==0)return!1;const a=s.getNode();if(es(a))return!1;const i=lee(a);return i.getIndent()>0&&(i.is(a)||a.is(i.getFirstDescendant()))}(r))return e.preventDefault(),t.dispatchCommand(U6,void 0);if(PA&&navigator.language==="ko-KR")return!1}else if(!Ls(r))return!1;return e.preventDefault(),t.dispatchCommand(Su,!0)},pr),t.registerCommand(HD,e=>{if(IA(e.target))return!1;const r=wt();return!(!lt(r)&&!Ls(r))&&(e.preventDefault(),t.dispatchCommand(Su,!1))},pr),t.registerCommand(M1,e=>{const r=wt();if(!lt(r))return!1;if(m2(r),e!==null){if((PA||kee||Tee)&&See)return!1;if(e.preventDefault(),e.shiftKey)return t.dispatchCommand(kf,!1)}return t.dispatchCommand(Fg,void 0)},pr),t.registerCommand(zD,()=>{const e=wt();return!!lt(e)&&(t.blur(),!0)},pr),t.registerCommand(VD,e=>{const[,r]=ox(e);if(r.length>0){const s=FA(e.clientX,e.clientY);if(s!==null){const{offset:a,node:i}=s,o=yc(i);if(o!==null){const l=Tv();if(_t(o))l.anchor.set(o.getKey(),a,"text"),l.focus.set(o.getKey(),a,"text");else{const d=o.getParentOrThrow().getKey(),g=o.getIndexWithinParent()+1;l.anchor.set(d,g,"element"),l.focus.set(d,g,"element")}const u=j1(l);Ns(u)}t.dispatchCommand(DA,r)}return e.preventDefault(),!0}const n=wt();return!!lt(n)},pr),t.registerCommand(XD,e=>{const[r]=ox(e),n=wt();return!(r&&!lt(n))},pr),t.registerCommand(YD,e=>{const[r]=ox(e),n=wt();if(r&&!lt(n))return!1;const s=FA(e.clientX,e.clientY);if(s!==null){const a=yc(s.node);Er(a)&&e.preventDefault()}return!0},pr),t.registerCommand(yS,()=>(TZ(),!0),pr),t.registerCommand(Sv,e=>(AA(t,mu(e,ClipboardEvent)?e:null),!0),pr),t.registerCommand(cT,e=>(async function(r,n){await AA(n,mu(r,ClipboardEvent)?r:null),n.update(()=>{const s=wt();lt(s)?s.removeText():Ls(s)&&s.getNodes().forEach(a=>a.remove())})}(e,t),!0),pr),t.registerCommand(iT,e=>{const[,r,n]=ox(e);return r.length>0&&!n?(t.dispatchCommand(DA,r),!0):bh(e.target)&&wT(e.target)?!1:wt()!==null&&(function(s,a){s.preventDefault(),a.update(()=>{const i=wt(),o=mu(s,InputEvent)||mu(s,KeyboardEvent)?null:s.clipboardData;o!=null&&i!==null&&EA(o,i,a)},{tag:mZ})}(e,t),!0)},pr),t.registerCommand($D,e=>{const r=wt();return lt(r)&&m2(r),!1},pr),t.registerCommand(GD,e=>{const r=wt();return lt(r)&&m2(r),!1},pr))}const DS=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?b.useLayoutEffect:b.useEffect;function OA(t){return t.getEditorState().read(MR(t.isComposing()))}function qR({contentEditable:t,placeholder:e=null,ErrorBoundary:r}){const[n]=Fo(),s=function(a,i){const[o,l]=b.useState(()=>a.getDecorators());return DS(()=>a.registerDecoratorListener(u=>{Eb.flushSync(()=>{l(u)})}),[a]),b.useEffect(()=>{l(a.getDecorators())},[a]),b.useMemo(()=>{const u=[],d=Object.keys(o);for(let g=0;g<d.length;g++){const h=d[g],p=c.jsx(i,{onError:v=>a._onError(v),children:c.jsx(b.Suspense,{fallback:null,children:o[h]})}),x=a.getElementByKey(h);x!==null&&u.push(Eb.createPortal(p,x,h))}return u},[i,o,a])}(n,r);return function(a){DS(()=>hd(Aee(a),dee(a)),[a])}(n),c.jsxs(c.Fragment,{children:[t,c.jsx(jee,{content:e}),s]})}function jee({content:t}){const[e]=Fo(),r=function(s){const[a,i]=b.useState(()=>OA(s));return DS(()=>{function o(){const l=OA(s);i(l)}return o(),hd(s.registerUpdateListener(()=>{o()}),s.registerEditableListener(()=>{o()}))},[s]),a}(e),n=QZ();return r?typeof t=="function"?t(n):t:null}const ZR=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?b.useLayoutEffect:b.useEffect;function Fee({editor:t,ariaActiveDescendant:e,ariaAutoComplete:r,ariaControls:n,ariaDescribedBy:s,ariaErrorMessage:a,ariaExpanded:i,ariaInvalid:o,ariaLabel:l,ariaLabelledBy:u,ariaMultiline:d,ariaOwns:g,ariaRequired:h,autoCapitalize:p,className:x,id:v,role:w="textbox",spellCheck:S=!0,style:_,tabIndex:y,"data-testid":k,...N},E){const[A,C]=b.useState(t.isEditable()),F=b.useCallback(R=>{R&&R.ownerDocument&&R.ownerDocument.defaultView?t.setRootElement(R):t.setRootElement(null)},[t]),D=b.useMemo(()=>function(...R){return M=>{R.forEach(B=>{typeof B=="function"?B(M):B!=null&&(B.current=M)})}}(E,F),[F,E]);return ZR(()=>(C(t.isEditable()),t.registerEditableListener(R=>{C(R)})),[t]),c.jsx("div",{"aria-activedescendant":A?e:void 0,"aria-autocomplete":A?r:"none","aria-controls":A?n:void 0,"aria-describedby":s,...a!=null?{"aria-errormessage":a}:{},"aria-expanded":A&&w==="combobox"?!!i:void 0,...o!=null?{"aria-invalid":o}:{},"aria-label":l,"aria-labelledby":u,"aria-multiline":d,"aria-owns":A?g:void 0,"aria-readonly":!A||void 0,"aria-required":h,autoCapitalize:p,className:x,contentEditable:A,"data-testid":k,id:v,ref:D,role:w,spellCheck:S,style:_,tabIndex:y,...N})}const Pee=b.forwardRef(Fee);function BA(t){return t.getEditorState().read(MR(t.isComposing()))}const eM=b.forwardRef(Dee);function Dee(t,e){const{placeholder:r,...n}=t,[s]=Fo();return c.jsxs(c.Fragment,{children:[c.jsx(Pee,{editor:s,...n,ref:e}),r!=null&&c.jsx(Ree,{editor:s,content:r})]})}function Ree({content:t,editor:e}){const r=function(i){const[o,l]=b.useState(()=>BA(i));return ZR(()=>{function u(){const d=BA(i);l(d)}return u(),hd(i.registerUpdateListener(()=>{u()}),i.registerEditableListener(()=>{u()}))},[i]),o}(e),[n,s]=b.useState(e.isEditable());if(b.useLayoutEffect(()=>(s(e.isEditable()),e.registerEditableListener(i=>{s(i)})),[e]),!r)return null;let a=null;return typeof t=="function"?a=t(n):t!==null&&(a=t),a===null?null:c.jsx("div",{"aria-hidden":!0,children:a})}const lx=0,RS=1,MS=2,Li=0,Mee=1,UA=2,Lee=3,Iee=4;function Oee(t,e,r,n,s){if(t===null||r.size===0&&n.size===0&&!s)return Li;const a=e._selection,i=t._selection;if(s)return Mee;if(!(lt(a)&&lt(i)&&i.isCollapsed()&&a.isCollapsed()))return Li;const o=function(S,_,y){const k=S._nodeMap,N=[];for(const E of _){const A=k.get(E);A!==void 0&&N.push(A)}for(const[E,A]of y){if(!A)continue;const C=k.get(E);C===void 0||es(C)||N.push(C)}return N}(e,r,n);if(o.length===0)return Li;if(o.length>1){const S=e._nodeMap,_=S.get(a.anchor.key),y=S.get(i.anchor.key);return _&&y&&!t._nodeMap.has(_.__key)&&_t(_)&&_.__text.length===1&&a.anchor.offset===1?UA:Li}const l=o[0],u=t._nodeMap.get(l.__key);if(!_t(u)||!_t(l)||u.__mode!==l.__mode)return Li;const d=u.__text,g=l.__text;if(d===g)return Li;const h=a.anchor,p=i.anchor;if(h.key!==p.key||h.type!=="text")return Li;const x=h.offset,v=p.offset,w=g.length-d.length;return w===1&&v===x-1?UA:w===-1&&v===x+1?Lee:w===-1&&v===x?Iee:Li}function Bee(t,e){let r=Date.now(),n=Li;return(s,a,i,o,l,u)=>{const d=Date.now();if(u.has(B1))return n=Li,r=d,MS;const g=Oee(s,a,o,l,t.isComposing()),h=(()=>{const p=i===null||i.editor===t,x=u.has(gZ);if(!x&&p&&u.has(G0))return lx;if(s===null)return RS;const v=a._selection;return o.size>0||l.size>0?x===!1&&g!==Li&&g===n&&d<r+e&&p||o.size===1&&function(w,S,_){const y=S._nodeMap.get(w),k=_._nodeMap.get(w),N=S._selection,E=_._selection;return!(lt(N)&&lt(E)&&N.anchor.type==="element"&&N.focus.type==="element"&&E.anchor.type==="text"&&E.focus.type==="text"||!_t(y)||!_t(k)||y.__parent!==k.__parent)&&JSON.stringify(S.read(()=>y.exportJSON()))===JSON.stringify(_.read(()=>k.exportJSON()))}(Array.from(o)[0],s,a)?lx:RS:v!==null?lx:MS})();return r=d,n=g,h}}function $A(t){t.undoStack=[],t.redoStack=[],t.current=null}function Uee(t,e,r){const n=Bee(t,r);return hd(t.registerCommand(oT,()=>(function(a,i){const o=i.redoStack,l=i.undoStack;if(l.length!==0){const u=i.current,d=l.pop();u!==null&&(o.push(u),a.dispatchCommand(Zp,!0)),l.length===0&&a.dispatchCommand(ex,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:B1})}}(t,e),!0),pr),t.registerCommand(lT,()=>(function(a,i){const o=i.redoStack,l=i.undoStack;if(o.length!==0){const u=i.current;u!==null&&(l.push(u),a.dispatchCommand(ex,!0));const d=o.pop();o.length===0&&a.dispatchCommand(Zp,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:B1})}}(t,e),!0),pr),t.registerCommand(Yq,()=>($A(e),!1),pr),t.registerCommand(Jq,()=>($A(e),t.dispatchCommand(Zp,!1),t.dispatchCommand(ex,!1),!0),pr),t.registerUpdateListener(({editorState:a,prevEditorState:i,dirtyLeaves:o,dirtyElements:l,tags:u})=>{const d=e.current,g=e.redoStack,h=e.undoStack,p=d===null?null:d.editorState;if(d!==null&&a===p)return;const x=n(i,a,d,o,l,u);if(x===RS)g.length!==0&&(e.redoStack=[],t.dispatchCommand(Zp,!1)),d!==null&&(h.push({...d}),t.dispatchCommand(ex,!0));else if(x===MS)return;e.current={editor:t,editorState:a}}))}function $ee(){return{current:null,redoStack:[],undoStack:[]}}function tM({delay:t,externalHistoryState:e}){const[r]=Fo();return function(n,s,a=1e3){const i=b.useMemo(()=>s||$ee(),[s]);b.useEffect(()=>Uee(n,i,a),[a,n,i])}(r,e,t),null}function rM({defaultSelection:t}){const[e]=Fo();return b.useEffect(()=>{e.focus(()=>{const r=document.activeElement,n=e.getRootElement();n===null||r!==null&&n.contains(r)||n.focus({preventScroll:!0})},{defaultSelection:t})},[t,e]),null}function LS(t,e){return LS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},LS(t,e)}var WA={error:null},Wee=function(t){var e,r;function n(){for(var a,i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return(a=t.call.apply(t,[this].concat(o))||this).state=WA,a.resetErrorBoundary=function(){for(var u,d=arguments.length,g=new Array(d),h=0;h<d;h++)g[h]=arguments[h];a.props.onReset==null||(u=a.props).onReset.apply(u,g),a.reset()},a}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,LS(e,r),n.getDerivedStateFromError=function(a){return{error:a}};var s=n.prototype;return s.reset=function(){this.setState(WA)},s.componentDidCatch=function(a,i){var o,l;(o=(l=this.props).onError)==null||o.call(l,a,i)},s.componentDidUpdate=function(a,i){var o,l,u,d,g=this.state.error,h=this.props.resetKeys;g!==null&&i.error!==null&&((u=a.resetKeys)===void 0&&(u=[]),(d=h)===void 0&&(d=[]),u.length!==d.length||u.some(function(p,x){return!Object.is(p,d[x])}))&&((o=(l=this.props).onResetKeysChange)==null||o.call(l,a.resetKeys,h),this.reset())},s.render=function(){var a=this.state.error,i=this.props,o=i.fallbackRender,l=i.FallbackComponent,u=i.fallback;if(a!==null){var d={error:a,resetErrorBoundary:this.resetErrorBoundary};if(b.isValidElement(u))return u;if(typeof o=="function")return o(d);if(l)return b.createElement(l,d);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},n}(b.Component);function nM({children:t,onError:e}){return c.jsx(Wee,{fallback:c.jsx("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"},children:"An error was thrown."}),onError:e,children:t})}const IT=/^(\d+(?:\.\d+)?)px$/,Af={BOTH:3,NO_STATUS:0,ROW:1};class Ch extends Ks{static getType(){return"tablecell"}static clone(e){return new Ch(e.__headerState,e.__colSpan,e.__width,e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__rowSpan=e.__rowSpan,this.__backgroundColor=e.__backgroundColor,this.__verticalAlign=e.__verticalAlign}static importDOM(){return{td:e=>({conversion:zA,priority:0}),th:e=>({conversion:zA,priority:0})}}static importJSON(e){return sM().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHeaderStyles(e.headerState).setColSpan(e.colSpan||1).setRowSpan(e.rowSpan||1).setWidth(e.width||void 0).setBackgroundColor(e.backgroundColor||null).setVerticalAlign(e.verticalAlign||void 0)}constructor(e=Af.NO_STATUS,r=1,n,s){super(s),this.__colSpan=r,this.__rowSpan=1,this.__headerState=e,this.__width=n,this.__backgroundColor=null,this.__verticalAlign=void 0}createDOM(e){const r=document.createElement(this.getTag());return this.__width&&(r.style.width=`${this.__width}px`),this.__colSpan>1&&(r.colSpan=this.__colSpan),this.__rowSpan>1&&(r.rowSpan=this.__rowSpan),this.__backgroundColor!==null&&(r.style.backgroundColor=this.__backgroundColor),IS(this.__verticalAlign)&&(r.style.verticalAlign=this.__verticalAlign),Qn(r,e.theme.tableCell,this.hasHeader()&&e.theme.tableCellHeader),r}exportDOM(e){const r=super.exportDOM(e);if(Qr(r.element)){const n=r.element;n.setAttribute("data-temporary-table-cell-lexical-key",this.getKey()),n.style.border="1px solid black",this.__colSpan>1&&(n.colSpan=this.__colSpan),this.__rowSpan>1&&(n.rowSpan=this.__rowSpan),n.style.width=`${this.getWidth()||75}px`,n.style.verticalAlign=this.getVerticalAlign()||"top",n.style.textAlign="start",this.__backgroundColor===null&&this.hasHeader()&&(n.style.backgroundColor="#f2f3f5")}return r}exportJSON(){return{...super.exportJSON(),...IS(this.__verticalAlign)&&{verticalAlign:this.__verticalAlign},backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,width:this.getWidth()}}getColSpan(){return this.getLatest().__colSpan}setColSpan(e){const r=this.getWritable();return r.__colSpan=e,r}getRowSpan(){return this.getLatest().__rowSpan}setRowSpan(e){const r=this.getWritable();return r.__rowSpan=e,r}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(e,r=Af.BOTH){const n=this.getWritable();return n.__headerState=e&r|n.__headerState&~r,n}getHeaderStyles(){return this.getLatest().__headerState}setWidth(e){const r=this.getWritable();return r.__width=e,r}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(e){const r=this.getWritable();return r.__backgroundColor=e,r}getVerticalAlign(){return this.getLatest().__verticalAlign}setVerticalAlign(e){const r=this.getWritable();return r.__verticalAlign=e||void 0,r}toggleHeaderStyle(e){const r=this.getWritable();return(r.__headerState&e)===e?r.__headerState-=e:r.__headerState+=e,r}hasHeaderState(e){return(this.getHeaderStyles()&e)===e}hasHeader(){return this.getLatest().__headerState!==Af.NO_STATUS}updateDOM(e){return e.__headerState!==this.__headerState||e.__width!==this.__width||e.__colSpan!==this.__colSpan||e.__rowSpan!==this.__rowSpan||e.__backgroundColor!==this.__backgroundColor||e.__verticalAlign!==this.__verticalAlign}isShadowRoot(){return!0}collapseAtStart(){return!0}canBeEmpty(){return!1}canIndent(){return!1}}function IS(t){return t==="middle"||t==="bottom"}function zA(t){const e=t,r=t.nodeName.toLowerCase();let n;IT.test(e.style.width)&&(n=parseFloat(e.style.width));const s=sM(r==="th"?Af.ROW:Af.NO_STATUS,e.colSpan,n);s.__rowSpan=e.rowSpan;const a=e.style.backgroundColor;a!==""&&(s.__backgroundColor=a);const i=e.style.verticalAlign;IS(i)&&(s.__verticalAlign=i);const o=e.style,l=(o&&o.textDecoration||"").split(" "),u=o.fontWeight==="700"||o.fontWeight==="bold",d=l.includes("line-through"),g=o.fontStyle==="italic",h=l.includes("underline");return{after:p=>{const x=[];let v=null;const w=()=>{if(v){const S=v.getFirstChild();il(S)&&v.getChildrenSize()===1&&S.remove()}};for(const S of p)AZ(S)||_t(S)||il(S)?(_t(S)&&(u&&S.toggleFormat("bold"),d&&S.toggleFormat("strikethrough"),g&&S.toggleFormat("italic"),h&&S.toggleFormat("underline")),v?v.append(S):(v=Jr().append(S),x.push(v))):(x.push(S),w(),v=null);return w(),x.length===0&&x.push(Jr()),x},node:s}}function sM(t=Af.NO_STATUS,e=1,r){return ua(new Ch(t,e,r))}function Mg(t){return t instanceof Ch}function OS(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}class Th extends Ks{static getType(){return"tablerow"}static clone(e){return new Th(e.__height,e.__key)}static importDOM(){return{tr:e=>({conversion:zee,priority:0})}}static importJSON(e){return aM().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHeight(e.height)}constructor(e,r){super(r),this.__height=e}exportJSON(){const e=this.getHeight();return{...super.exportJSON(),...e===void 0?void 0:{height:e}}}createDOM(e){const r=document.createElement("tr");return this.__height&&(r.style.height=`${this.__height}px`),Qn(r,e.theme.tableRow),r}extractWithChild(e,r,n){return n==="html"}isShadowRoot(){return!0}setHeight(e){const r=this.getWritable();return r.__height=e,r}getHeight(){return this.getLatest().__height}updateDOM(e){return e.__height!==this.__height}canBeEmpty(){return!1}canIndent(){return!1}}function zee(t){const e=t;let r;return IT.test(e.style.height)&&(r=parseFloat(e.style.height)),{after:n=>GR(n,Mg),node:aM(r)}}function aM(t){return ua(new Th(t))}function iM(t){return t instanceof Th}const oM=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Hee=oM&&"documentMode"in document?document.documentMode:null;oM&&"InputEvent"in window&&!Hee&&new window.InputEvent("input");function Gee(t,e,r){const n=[];let s=null,a=null;function i(l){let u=n[l];return u===void 0&&(n[l]=u=[]),u}const o=t.getChildren();for(let l=0;l<o.length;l++){const u=o[l];iM(u)||OS(209);const d=i(l);for(let g=u.getFirstChild(),h=0;g!=null;g=g.getNextSibling()){for(Mg(g)||OS(147);d[h]!==void 0;)h++;const p={cell:g,startColumn:h,startRow:l},{__rowSpan:x,__colSpan:v}=g;for(let w=0;w<x&&!(l+w>=o.length);w++){const S=i(l+w);for(let _=0;_<v;_++)S[h+_]=p}}}return[n,s,a]}function f0(t){return Qr(t)&&t.nodeName==="TABLE"}function Vee(t,e){for(let r=e,n=null;r!==null;r=r.getParent()){if(t.is(r))return n;Mg(r)&&(n=r)}return null}function Kee(t,e,r){return Vee(t,yc(e,r))}function HA(t,e,r){if(!e.theme.tableAlignment)return;const n=[],s=[];for(const a of["center","right"]){const i=e.theme.tableAlignment[a];i&&(a===r?s:n).push(i)}dc(t,...n),Qn(t,...s)}const Xee=new WeakSet;function GA(t=_m()){return Xee.has(t)}class Cm extends Ks{static getType(){return"table"}getColWidths(){return this.getLatest().__colWidths}setColWidths(e){const r=this.getWritable();return r.__colWidths=e,r}static clone(e){return new Cm(e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__colWidths=e.__colWidths,this.__rowStriping=e.__rowStriping,this.__frozenColumnCount=e.__frozenColumnCount,this.__frozenRowCount=e.__frozenRowCount}static importDOM(){return{table:e=>({conversion:Yee,priority:1})}}static importJSON(e){return lM().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setRowStriping(e.rowStriping||!1).setFrozenColumns(e.frozenColumnCount||0).setFrozenRows(e.frozenRowCount||0).setColWidths(e.colWidths)}constructor(e){super(e),this.__rowStriping=!1,this.__frozenColumnCount=0,this.__frozenRowCount=0}exportJSON(){return{...super.exportJSON(),colWidths:this.getColWidths(),frozenColumnCount:this.__frozenColumnCount?this.__frozenColumnCount:void 0,frozenRowCount:this.__frozenRowCount?this.__frozenRowCount:void 0,rowStriping:this.__rowStriping?this.__rowStriping:void 0}}extractWithChild(e,r,n){return n==="html"}getDOMSlot(e){const r=f0(e)?e:e.querySelector("table");return f0(r)||OS(229),super.getDOMSlot(e).withElement(r).withAfter(r.querySelector("colgroup"))}createDOM(e,r){const n=document.createElement("table");this.__style&&(n.style.cssText=this.__style);const s=document.createElement("colgroup");if(n.appendChild(s),RZ(s),Qn(n,e.theme.table),this.updateTableElement(null,n,e),GA(r)){const a=document.createElement("div"),i=e.theme.tableScrollableWrapper;return i?Qn(a,i):a.style.cssText="overflow-x: auto;",a.appendChild(n),this.updateTableWrapper(null,a,n,e),a}return n}updateTableWrapper(e,r,n,s){this.__frozenColumnCount!==(e?e.__frozenColumnCount:0)&&function(a,i,o,l){l>0?(Qn(a,o.theme.tableFrozenColumn),i.setAttribute("data-lexical-frozen-column","true")):(dc(a,o.theme.tableFrozenColumn),i.removeAttribute("data-lexical-frozen-column"))}(r,n,s,this.__frozenColumnCount),this.__frozenRowCount!==(e?e.__frozenRowCount:0)&&function(a,i,o,l){l>0?(Qn(a,o.theme.tableFrozenRow),i.setAttribute("data-lexical-frozen-row","true")):(dc(a,o.theme.tableFrozenRow),i.removeAttribute("data-lexical-frozen-row"))}(r,n,s,this.__frozenRowCount)}updateTableElement(e,r,n){this.__style!==(e?e.__style:"")&&(r.style.cssText=this.__style),this.__rowStriping!==(!!e&&e.__rowStriping)&&function(s,a,i){i?(Qn(s,a.theme.tableRowStriping),s.setAttribute("data-lexical-row-striping","true")):(dc(s,a.theme.tableRowStriping),s.removeAttribute("data-lexical-row-striping"))}(r,n,this.__rowStriping),function(s,a,i,o){const l=s.querySelector("colgroup");if(!l)return;const u=[];for(let d=0;d<i;d++){const g=document.createElement("col"),h=o&&o[d];h&&(g.style.width=`${h}px`),u.push(g)}l.replaceChildren(...u)}(r,0,this.getColumnCount(),this.getColWidths()),HA(r,n,this.getFormatType())}updateDOM(e,r,n){const s=this.getDOMSlot(r).element;return r===s===GA()||(Qr(a=r)&&a.nodeName==="DIV"&&this.updateTableWrapper(e,r,s,n),this.updateTableElement(e,s,n),!1);var a}exportDOM(e){const r=super.exportDOM(e),{element:n}=r;return{after:s=>{if(r.after&&(s=r.after(s)),!f0(s)&&Qr(s)&&(s=s.querySelector("table")),!f0(s))return null;HA(s,e._config,this.getFormatType());const[a]=Gee(this),i=new Map;for(const d of a)for(const g of d){const h=g.cell.getKey();i.has(h)||i.set(h,{colSpan:g.cell.getColSpan(),startColumn:g.startColumn})}const o=new Set;for(const d of s.querySelectorAll(":scope > tr > [data-temporary-table-cell-lexical-key]")){const g=d.getAttribute("data-temporary-table-cell-lexical-key");if(g){const h=i.get(g);if(d.removeAttribute("data-temporary-table-cell-lexical-key"),h){i.delete(g);for(let p=0;p<h.colSpan;p++)o.add(p+h.startColumn)}}}const l=s.querySelector(":scope > colgroup");if(l){const d=Array.from(s.querySelectorAll(":scope > colgroup > col")).filter((g,h)=>o.has(h));l.replaceChildren(...d)}const u=s.querySelectorAll(":scope > tr");if(u.length>0){const d=document.createElement("tbody");for(const g of u)d.appendChild(g);s.append(d)}return s},element:!f0(n)&&Qr(n)?n.querySelector("table"):n}}canBeEmpty(){return!1}isShadowRoot(){return!0}getCordsFromCellNode(e,r){const{rows:n,domRows:s}=r;for(let a=0;a<n;a++){const i=s[a];if(i!=null)for(let o=0;o<i.length;o++){const l=i[o];if(l==null)continue;const{elem:u}=l,d=Kee(this,u);if(d!==null&&e.is(d))return{x:o,y:a}}}throw new Error("Cell not found in table.")}getDOMCellFromCords(e,r,n){const{domRows:s}=n,a=s[r];if(a==null)return null;const i=a[e<a.length?e:a.length-1];return i??null}getDOMCellFromCordsOrThrow(e,r,n){const s=this.getDOMCellFromCords(e,r,n);if(!s)throw new Error("Cell not found at cords.");return s}getCellNodeFromCords(e,r,n){const s=this.getDOMCellFromCords(e,r,n);if(s==null)return null;const a=yc(s.elem);return Mg(a)?a:null}getCellNodeFromCordsOrThrow(e,r,n){const s=this.getCellNodeFromCords(e,r,n);if(!s)throw new Error("Node at cords not TableCellNode.");return s}getRowStriping(){return!!this.getLatest().__rowStriping}setRowStriping(e){const r=this.getWritable();return r.__rowStriping=e,r}setFrozenColumns(e){const r=this.getWritable();return r.__frozenColumnCount=e,r}getFrozenColumns(){return this.getLatest().__frozenColumnCount}setFrozenRows(e){const r=this.getWritable();return r.__frozenRowCount=e,r}getFrozenRows(){return this.getLatest().__frozenRowCount}canSelectBefore(){return!0}canIndent(){return!1}getColumnCount(){const e=this.getFirstChild();if(!e)return 0;let r=0;return e.getChildren().forEach(n=>{Mg(n)&&(r+=n.getColSpan())}),r}}function Yee(t){const e=lM();t.hasAttribute("data-lexical-row-striping")&&e.setRowStriping(!0),t.hasAttribute("data-lexical-frozen-column")&&e.setFrozenColumns(1),t.hasAttribute("data-lexical-frozen-row")&&e.setFrozenRows(1);const r=t.querySelector(":scope > colgroup");if(r){let n=[];for(const s of r.querySelectorAll(":scope > col")){let a=s.style.width||"";if(!IT.test(a)&&(a=s.getAttribute("width")||"",!/^\d+$/.test(a))){n=void 0;break}n.push(parseFloat(a))}n&&e.setColWidths(n)}return{after:n=>GR(n,iM),node:e}}function lM(){return ua(new Cm)}function ql(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function BS(t){let e=1,r=t.getParent();for(;r!=null;){if(Ar(r)){const n=r.getParent();if(er(n)){e++,r=n.getParent();continue}ql(40)}return e}return e}function US(t){let e=t.getParent();er(e)||ql(40);let r=e;for(;r!==null;)r=r.getParent(),er(r)&&(e=r);return e}function cM(t){let e=[];const r=t.getChildren().filter(Ar);for(let n=0;n<r.length;n++){const s=r[n],a=s.getFirstChild();er(a)?e=e.concat(cM(a)):e.push(s)}return e}function yo(t){return Ar(t)&&er(t.getFirstChild())}function VA(t){return Ua().append(t)}function uM(t,e){return Ar(t)&&(e.length===0||e.length===1&&t.is(e[0])&&t.getChildrenSize()===0)}function KA(t){const e=wt();if(e!==null){let r=e.getNodes();if(lt(e)){const s=e.getStartEndPoints();s===null&&ql(143);const[a]=s,i=a.getNode(),o=i.getParent();if(ia(i)){const l=i.getFirstChild();if(l)r=l.selectStart().getNodes();else{const u=Jr();i.append(u),r=u.select().getNodes()}}else if(uM(i,r)){const l=Ta(t);if(ia(o)){i.replace(l);const u=Ua();Qe(i)&&(u.setFormat(i.getFormatType()),u.setIndent(i.getIndent())),l.append(u)}else if(Ar(i)){const u=i.getParentOrThrow();Xu(l,u.getChildren()),u.replace(l)}return}}const n=new Set;for(let s=0;s<r.length;s++){const a=r[s];if(Qe(a)&&a.isEmpty()&&!Ar(a)&&!n.has(a.getKey())){XA(a,t);continue}let i=vR(a)?a.getParent():Ar(a)&&a.isEmpty()?a:null;for(;i!=null;){const o=i.getKey();if(er(i)){if(!n.has(o)){const l=Ta(t);Xu(l,i.getChildren()),i.replace(l),n.add(o)}break}{const l=i.getParent();if(ia(l)&&!n.has(o)){n.add(o),XA(i,t);break}i=l}}}}}function Xu(t,e){t.splice(t.getChildrenSize(),0,e)}function XA(t,e){if(er(t))return t;const r=t.getPreviousSibling(),n=t.getNextSibling(),s=Ua();let a;if(Xu(s,t.getChildren()),er(r)&&e===r.getListType())r.append(s),er(n)&&e===n.getListType()&&(Xu(r,n.getChildren()),n.remove()),a=r;else if(er(n)&&e===n.getListType())n.getFirstChildOrThrow().insertBefore(s),a=n;else{const i=Ta(e);i.append(s),t.replace(i),a=i}return s.setFormat(t.getFormatType()),s.setIndent(t.getIndent()),t.remove(),a}function OT(t,e){const r=t.getLastChild(),n=e.getFirstChild();r&&n&&yo(r)&&yo(n)&&(OT(r.getFirstChild(),n.getFirstChild()),n.remove());const s=e.getChildren();s.length>0&&t.append(...s),e.remove()}function Jee(){const t=wt();if(lt(t)){const e=new Set,r=t.getNodes(),n=t.anchor.getNode();if(uM(n,r))e.add(US(n));else for(let s=0;s<r.length;s++){const a=r[s];if(vR(a)){const i=oee(a,Cl);i!=null&&e.add(US(i))}}for(const s of e){let a=s;const i=cM(s);for(const o of i){const l=Jr().setTextStyle(t.style).setTextFormat(t.format);Xu(l,o.getChildren()),a.insertAfter(l),a=l,o.__key===t.anchor.key&&Ku(t.anchor,gi(_i(l,"next"))),o.__key===t.focus.key&&Ku(t.focus,gi(_i(l,"next"))),o.remove()}s.remove()}}}function dM(t){const e=t.getListType()!=="check";let r=t.getStart();for(const n of t.getChildren())Ar(n)&&(n.getValue()!==r&&n.setValue(r),e&&n.getLatest().__checked!=null&&n.setChecked(void 0),er(n.getFirstChild())||r++)}function Qee(t){const e=new Set;if(yo(t)||e.has(t.getKey()))return;const r=t.getParent(),n=t.getNextSibling(),s=t.getPreviousSibling();if(yo(n)&&yo(s)){const a=s.getFirstChild();if(er(a)){a.append(t);const i=n.getFirstChild();er(i)&&(Xu(a,i.getChildren()),n.remove(),e.add(n.getKey()))}}else if(yo(n)){const a=n.getFirstChild();if(er(a)){const i=a.getFirstChild();i!==null&&i.insertBefore(t)}}else if(yo(s)){const a=s.getFirstChild();er(a)&&a.append(t)}else if(er(r)){const a=Ua().setTextFormat(t.getTextFormat()).setTextStyle(t.getTextStyle()),i=Ta(r.getListType()).setTextFormat(r.getTextFormat()).setTextStyle(r.getTextStyle());a.append(i),i.append(t),s?s.insertAfter(a):n?n.insertBefore(a):r.append(a)}}function qee(t){if(yo(t))return;const e=t.getParent(),r=e?e.getParent():void 0;if(er(r?r.getParent():void 0)&&Ar(r)&&er(e)){const n=e?e.getFirstChild():void 0,s=e?e.getLastChild():void 0;if(t.is(n))r.insertBefore(t),e.isEmpty()&&r.remove();else if(t.is(s))r.insertAfter(t),e.isEmpty()&&r.remove();else{const a=e.getListType(),i=Ua(),o=Ta(a);i.append(o),t.getPreviousSiblings().forEach(d=>o.append(d));const l=Ua(),u=Ta(a);l.append(u),Xu(u,t.getNextSiblings()),r.insertBefore(i),r.insertAfter(l),r.replace(t)}}}function Zee(){const t=wt();if(!lt(t)||!t.isCollapsed())return!1;const e=t.anchor.getNode();if(!Ar(e)||e.getChildrenSize()!==0)return!1;const r=US(e),n=e.getParent();er(n)||ql(40);const s=n.getParent();let a;if(ia(s))a=Jr(),r.insertAfter(a);else{if(!Ar(s))return!1;a=Ua(),s.insertAfter(a)}a.setTextStyle(t.style).setTextFormat(t.format).select();const i=e.getNextSiblings();if(i.length>0){const o=Ta(n.getListType());if(Ar(a)){const l=Ua();l.append(o),a.insertAfter(l)}else a.insertAfter(o);o.append(...i)}return function(o){let l=o;for(;l.getNextSibling()==null&&l.getPreviousSibling()==null;){const u=l.getParent();if(u==null||!Ar(u)&&!er(u))break;l=u}l.remove()}(e),!0}function H1(...t){const e=[];for(const r of t)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))e.push(n);return e}let Cl=class extends Ks{$config(){return this.config("listitem",{$transform:e=>{if(e.__checked==null)return;const r=e.getParent();er(r)&&r.getListType()!=="check"&&e.getChecked()!=null&&e.setChecked(void 0)},extends:Ks,importDOM:{li:()=>({conversion:ete,priority:0})}})}constructor(e=1,r=void 0,n){super(n),this.__value=e===void 0?1:e,this.__checked=r}afterCloneFrom(e){super.afterCloneFrom(e),this.__value=e.__value,this.__checked=e.__checked}createDOM(e){const r=document.createElement("li");return this.updateListItemDOM(null,r,e),r}updateListItemDOM(e,r,n){const s=this.getParent();er(s)&&s.getListType()==="check"&&function(o,l,u,d){er(l.getFirstChild())?(o.removeAttribute("role"),o.removeAttribute("tabIndex"),o.removeAttribute("aria-checked")):(o.setAttribute("role","checkbox"),o.setAttribute("tabIndex","-1"),u&&l.__checked===u.__checked||o.setAttribute("aria-checked",l.getChecked()?"true":"false"))}(r,this,e),r.value=this.__value,function(o,l,u){const d=[],g=[],h=l.list,p=h?h.listitem:void 0;let x;if(h&&h.nested&&(x=h.nested.listitem),p!==void 0&&d.push(...H1(p)),h){const v=u.getParent(),w=er(v)&&v.getListType()==="check",S=u.getChecked();w&&!S||g.push(h.listitemUnchecked),w&&S||g.push(h.listitemChecked),w&&d.push(S?h.listitemChecked:h.listitemUnchecked)}if(x!==void 0){const v=H1(x);u.getChildren().some(w=>er(w))?d.push(...v):g.push(...v)}g.length>0&&dc(o,...g),d.length>0&&Qn(o,...d)}(r,n.theme,this);const a=e?e.__style:"",i=this.__style;a!==i&&(i===""?r.removeAttribute("style"):r.style.cssText=i),function(o,l,u){const d=SA(l.__textStyle);for(const g in d)o.style.setProperty(`--listitem-marker-${g}`,d[g]);if(u)for(const g in SA(u.__textStyle))g in d||o.style.removeProperty(`--listitem-marker-${g}`)}(r,this,e)}updateDOM(e,r,n){const s=r;return this.updateListItemDOM(e,s,n),!1}updateFromJSON(e){return super.updateFromJSON(e).setValue(e.value).setChecked(e.checked)}exportDOM(e){const r=this.createDOM(e._config),n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();return s&&(r.dir=s),{element:r}}exportJSON(){return{...super.exportJSON(),checked:this.getChecked(),value:this.getValue()}}append(...e){for(let r=0;r<e.length;r++){const n=e[r];if(Qe(n)&&this.canMergeWith(n)){const s=n.getChildren();this.append(...s),n.remove()}else super.append(n)}return this}replace(e,r){if(Ar(e))return super.replace(e);this.setIndent(0);const n=this.getParentOrThrow();if(!er(n))return e;if(n.__first===this.getKey())n.insertBefore(e);else if(n.__last===this.getKey())n.insertAfter(e);else{const s=Ta(n.getListType());let a=this.getNextSibling();for(;a;){const i=a;a=a.getNextSibling(),s.append(i)}n.insertAfter(e),e.insertAfter(s)}return r&&(Qe(e)||ql(139),this.getChildren().forEach(s=>{e.append(s)})),this.remove(),n.getChildrenSize()===0&&n.remove(),e}insertAfter(e,r=!0){const n=this.getParentOrThrow();if(er(n)||ql(39),Ar(e))return super.insertAfter(e,r);const s=this.getNextSiblings();if(n.insertAfter(e,r),s.length!==0){const a=Ta(n.getListType());s.forEach(i=>a.append(i)),e.insertAfter(a,r)}return e}remove(e){const r=this.getPreviousSibling(),n=this.getNextSibling();super.remove(e),r&&n&&yo(r)&&yo(n)&&(OT(r.getFirstChild(),n.getFirstChild()),n.remove())}insertNewAfter(e,r=!0){const n=Ua().updateFromJSON(this.exportJSON()).setChecked(!this.getChecked()&&void 0);return this.insertAfter(n,r),n}collapseAtStart(e){const r=Jr();this.getChildren().forEach(i=>r.append(i));const n=this.getParentOrThrow(),s=n.getParentOrThrow(),a=Ar(s);if(n.getChildrenSize()===1)if(a)n.remove(),s.select();else{n.insertBefore(r),n.remove();const i=e.anchor,o=e.focus,l=r.getKey();i.type==="element"&&i.getNode().is(this)&&i.set(l,i.offset,"element"),o.type==="element"&&o.getNode().is(this)&&o.set(l,o.offset,"element")}else n.insertBefore(r),this.remove();return!0}getValue(){return this.getLatest().__value}setValue(e){const r=this.getWritable();return r.__value=e,r}getChecked(){const e=this.getLatest();let r;const n=this.getParent();return er(n)&&(r=n.getListType()),r==="check"?!!e.__checked:void 0}setChecked(e){const r=this.getWritable();return r.__checked=e,r}toggleChecked(){const e=this.getWritable();return e.setChecked(!e.__checked)}getIndent(){const e=this.getParent();if(e===null||!this.isAttached())return this.getLatest().__indent;let r=e.getParentOrThrow(),n=0;for(;Ar(r);)r=r.getParentOrThrow().getParentOrThrow(),n++;return n}setIndent(e){typeof e!="number"&&ql(117),(e=Math.floor(e))>=0||ql(199);let r=this.getIndent();for(;r!==e;)r<e?(Qee(this),r++):(qee(this),r--);return this}canInsertAfter(e){return Ar(e)}canReplaceWith(e){return Ar(e)}canMergeWith(e){return Ar(e)||xT(e)}extractWithChild(e,r){if(!lt(r))return!1;const n=r.anchor.getNode(),s=r.focus.getNode();return this.isParentOf(n)&&this.isParentOf(s)&&this.getTextContent().length===r.getTextContent().length}isParentRequired(){return!0}createParentElementNode(){return Ta("bullet")}canMergeWhenEmpty(){return!0}};function ete(t){if(t.classList.contains("task-list-item")){for(const r of t.children)if(r.tagName==="INPUT")return tte(r)}const e=t.getAttribute("aria-checked");return{node:Ua(e==="true"||e!=="false"&&void 0)}}function tte(t){return t.getAttribute("type")!=="checkbox"?{node:null}:{node:Ua(t.hasAttribute("checked"))}}function Ua(t){return ua(new Cl(void 0,t))}function Ar(t){return t instanceof Cl}let Oc=class extends Ks{$config(){return this.config("list",{$transform:e=>{(function(r){const n=r.getNextSibling();er(n)&&r.getListType()===n.getListType()&&OT(r,n)})(e),dM(e)},extends:Ks,importDOM:{ol:()=>({conversion:JA,priority:0}),ul:()=>({conversion:JA,priority:0})}})}constructor(e="number",r=1,n){super(n);const s=nte[e]||e;this.__listType=s,this.__tag=s==="number"?"ol":"ul",this.__start=r}afterCloneFrom(e){super.afterCloneFrom(e),this.__listType=e.__listType,this.__tag=e.__tag,this.__start=e.__start}getTag(){return this.getLatest().__tag}setListType(e){const r=this.getWritable();return r.__listType=e,r.__tag=e==="number"?"ol":"ul",r}getListType(){return this.getLatest().__listType}getStart(){return this.getLatest().__start}setStart(e){const r=this.getWritable();return r.__start=e,r}createDOM(e,r){const n=this.__tag,s=document.createElement(n);return this.__start!==1&&s.setAttribute("start",String(this.__start)),s.__lexicalListType=this.__listType,YA(s,e.theme,this),s}updateDOM(e,r,n){return e.__tag!==this.__tag||(YA(r,n.theme,this),!1)}updateFromJSON(e){return super.updateFromJSON(e).setListType(e.listType).setStart(e.start)}exportDOM(e){const r=this.createDOM(e._config,e);return Qr(r)&&(this.__start!==1&&r.setAttribute("start",String(this.__start)),this.__listType==="check"&&r.setAttribute("__lexicalListType","check")),{element:r}}exportJSON(){return{...super.exportJSON(),listType:this.getListType(),start:this.getStart(),tag:this.getTag()}}canBeEmpty(){return!1}canIndent(){return!1}splice(e,r,n){let s=n;for(let a=0;a<n.length;a++){const i=n[a];Ar(i)||(s===n&&(s=[...n]),s[a]=Ua().append(!Qe(i)||er(i)||i.isInline()?i:_n(i.getTextContent())))}return super.splice(e,r,s)}extractWithChild(e){return Ar(e)}};function YA(t,e,r){const n=[],s=[],a=e.list;if(a!==void 0){const i=a[`${r.__tag}Depth`]||[],o=BS(r)-1,l=o%i.length,u=i[l],d=a[r.__tag];let g;const h=a.nested,p=a.checklist;if(h!==void 0&&h.list&&(g=h.list),d!==void 0&&n.push(d),p!==void 0&&r.__listType==="check"&&n.push(p),u!==void 0){n.push(...H1(u));for(let x=0;x<i.length;x++)x!==l&&s.push(r.__tag+x)}if(g!==void 0){const x=H1(g);o>1?n.push(...x):s.push(...x)}}s.length>0&&dc(t,...s),n.length>0&&Qn(t,...n)}function rte(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r];if(Ar(n)){e.push(n);const s=n.getChildren();s.length>1&&s.forEach(a=>{er(a)&&e.push(VA(a))})}else e.push(VA(n))}return e}function JA(t){const e=t.nodeName.toLowerCase();let r=null;return e==="ol"?r=Ta("number",t.start):e==="ul"&&(r=function(n){if(n.getAttribute("__lexicallisttype")==="check"||n.classList.contains("contains-task-list"))return!0;for(const s of n.childNodes)if(Qr(s)&&s.hasAttribute("aria-checked"))return!0;return!1}(t)?Ta("check"):Ta("bullet")),{after:rte,node:r}}const nte={ol:"number",ul:"bullet"};function Ta(t="number",e=1){return ua(new Oc(t,e))}function er(t){return t instanceof Oc}const ste=Vt("UPDATE_LIST_START_COMMAND"),BT=Vt("INSERT_UNORDERED_LIST_COMMAND"),UT=Vt("INSERT_ORDERED_LIST_COMMAND"),$T=Vt("REMOVE_LIST_COMMAND");function ate(t){return hd(t.registerCommand(UT,()=>(KA("number"),!0),Kd),t.registerCommand(ste,e=>{const{listNodeKey:r,newStart:n}=e,s=Hn(r);return!!er(s)&&(s.getListType()==="number"&&(s.setStart(n),dM(s)),!0)},Kd),t.registerCommand(BT,()=>(KA("bullet"),!0),Kd),t.registerCommand($T,()=>(Jee(),!0),Kd),t.registerCommand(Fg,()=>Zee(),Kd),t.registerNodeTransform(Cl,e=>{const r=e.getFirstChild();if(r){if(_t(r)){const n=r.getStyle(),s=r.getFormat();e.getTextStyle()!==n&&e.setTextStyle(n),e.getTextFormat()!==s&&e.setTextFormat(s)}}else{const n=wt();lt(n)&&(n.style!==e.getTextStyle()||n.format!==e.getTextFormat())&&n.isCollapsed()&&e.is(n.anchor.getNode())&&e.setTextStyle(n.style).setTextFormat(n.format)}}),t.registerNodeTransform(Lc,e=>{const r=e.getParent();if(Ar(r)&&e.is(r.getFirstChild())){const n=e.getStyle(),s=e.getFormat();n===r.getTextStyle()&&s===r.getTextFormat()||r.setTextStyle(n).setTextFormat(s)}}))}function ite(t){const e=r=>{const n=r.getParent();if(er(r.getFirstChild())||!er(n))return;const s=Dv(r,a=>Ar(a)&&er(a.getParent())&&Ar(a.getPreviousSibling()));if(s===null&&r.getIndent()>0)r.setIndent(0);else if(Ar(s)){const a=s.getPreviousSibling();if(Ar(a)){const i=function(l){let u=l,d=u.getFirstChild();for(;er(d);){const g=d.getLastChild();if(!Ar(g))break;u=g,d=u.getFirstChild()}return u}(a),o=i.getParent();if(er(o)){const l=BS(o);l+1<BS(n)&&r.setIndent(l)}}}};return t.registerNodeTransform(Oc,r=>{const n=[r];for(;n.length>0;){const s=n.shift();if(er(s)){for(const a of s.getChildren())if(Ar(a)){e(a);const i=a.getFirstChild();er(i)&&n.push(i)}}}})}var ote={exports:{}};(function(t){var e=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var r=function(n){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,a=0,i={},o={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function _(y){return y instanceof l?new l(y.type,_(y.content),y.alias):Array.isArray(y)?y.map(_):y.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(_){return Object.prototype.toString.call(_).slice(8,-1)},objId:function(_){return _.__id||Object.defineProperty(_,"__id",{value:++a}),_.__id},clone:function _(y,k){k=k||{};var N,E;switch(o.util.type(y)){case"Object":if(E=o.util.objId(y),k[E])return k[E];N={},k[E]=N;for(var A in y)y.hasOwnProperty(A)&&(N[A]=_(y[A],k));return N;case"Array":return E=o.util.objId(y),k[E]?k[E]:(N=[],k[E]=N,y.forEach(function(C,F){N[F]=_(C,k)}),N);default:return y}},getLanguage:function(_){for(;_;){var y=s.exec(_.className);if(y)return y[1].toLowerCase();_=_.parentElement}return"none"},setLanguage:function(_,y){_.className=_.className.replace(RegExp(s,"gi"),""),_.classList.add("language-"+y)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(N){var _=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(N.stack)||[])[1];if(_){var y=document.getElementsByTagName("script");for(var k in y)if(y[k].src==_)return y[k]}return null}},isActive:function(_,y,k){for(var N="no-"+y;_;){var E=_.classList;if(E.contains(y))return!0;if(E.contains(N))return!1;_=_.parentElement}return!!k}},languages:{plain:i,plaintext:i,text:i,txt:i,extend:function(_,y){var k=o.util.clone(o.languages[_]);for(var N in y)k[N]=y[N];return k},insertBefore:function(_,y,k,N){N=N||o.languages;var E=N[_],A={};for(var C in E)if(E.hasOwnProperty(C)){if(C==y)for(var F in k)k.hasOwnProperty(F)&&(A[F]=k[F]);k.hasOwnProperty(C)||(A[C]=E[C])}var D=N[_];return N[_]=A,o.languages.DFS(o.languages,function(R,M){M===D&&R!=_&&(this[R]=A)}),A},DFS:function _(y,k,N,E){E=E||{};var A=o.util.objId;for(var C in y)if(y.hasOwnProperty(C)){k.call(y,C,y[C],N||C);var F=y[C],D=o.util.type(F);D==="Object"&&!E[A(F)]?(E[A(F)]=!0,_(F,k,null,E)):D==="Array"&&!E[A(F)]&&(E[A(F)]=!0,_(F,k,C,E))}}},plugins:{},highlightAll:function(_,y){o.highlightAllUnder(document,_,y)},highlightAllUnder:function(_,y,k){var N={callback:k,container:_,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",N),N.elements=Array.prototype.slice.apply(N.container.querySelectorAll(N.selector)),o.hooks.run("before-all-elements-highlight",N);for(var E=0,A;A=N.elements[E++];)o.highlightElement(A,y===!0,N.callback)},highlightElement:function(_,y,k){var N=o.util.getLanguage(_),E=o.languages[N];o.util.setLanguage(_,N);var A=_.parentElement;A&&A.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(A,N);var C=_.textContent,F={element:_,language:N,grammar:E,code:C};function D(M){F.highlightedCode=M,o.hooks.run("before-insert",F),F.element.innerHTML=F.highlightedCode,o.hooks.run("after-highlight",F),o.hooks.run("complete",F),k&&k.call(F.element)}if(o.hooks.run("before-sanity-check",F),A=F.element.parentElement,A&&A.nodeName.toLowerCase()==="pre"&&!A.hasAttribute("tabindex")&&A.setAttribute("tabindex","0"),!F.code){o.hooks.run("complete",F),k&&k.call(F.element);return}if(o.hooks.run("before-highlight",F),!F.grammar){D(o.util.encode(F.code));return}if(y&&n.Worker){var R=new Worker(o.filename);R.onmessage=function(M){D(M.data)},R.postMessage(JSON.stringify({language:F.language,code:F.code,immediateClose:!0}))}else D(o.highlight(F.code,F.grammar,F.language))},highlight:function(_,y,k){var N={code:_,grammar:y,language:k};if(o.hooks.run("before-tokenize",N),!N.grammar)throw new Error('The language "'+N.language+'" has no grammar.');return N.tokens=o.tokenize(N.code,N.grammar),o.hooks.run("after-tokenize",N),l.stringify(o.util.encode(N.tokens),N.language)},tokenize:function(_,y){var k=y.rest;if(k){for(var N in k)y[N]=k[N];delete y.rest}var E=new g;return h(E,E.head,_),d(_,E,y,E.head,0),x(E)},hooks:{all:{},add:function(_,y){var k=o.hooks.all;k[_]=k[_]||[],k[_].push(y)},run:function(_,y){var k=o.hooks.all[_];if(!(!k||!k.length))for(var N=0,E;E=k[N++];)E(y)}},Token:l};n.Prism=o;function l(_,y,k,N){this.type=_,this.content=y,this.alias=k,this.length=(N||"").length|0}l.stringify=function _(y,k){if(typeof y=="string")return y;if(Array.isArray(y)){var N="";return y.forEach(function(D){N+=_(D,k)}),N}var E={type:y.type,content:_(y.content,k),tag:"span",classes:["token",y.type],attributes:{},language:k},A=y.alias;A&&(Array.isArray(A)?Array.prototype.push.apply(E.classes,A):E.classes.push(A)),o.hooks.run("wrap",E);var C="";for(var F in E.attributes)C+=" "+F+'="'+(E.attributes[F]||"").replace(/"/g,"&quot;")+'"';return"<"+E.tag+' class="'+E.classes.join(" ")+'"'+C+">"+E.content+"</"+E.tag+">"};function u(_,y,k,N){_.lastIndex=y;var E=_.exec(k);if(E&&N&&E[1]){var A=E[1].length;E.index+=A,E[0]=E[0].slice(A)}return E}function d(_,y,k,N,E,A){for(var C in k)if(!(!k.hasOwnProperty(C)||!k[C])){var F=k[C];F=Array.isArray(F)?F:[F];for(var D=0;D<F.length;++D){if(A&&A.cause==C+","+D)return;var R=F[D],M=R.inside,B=!!R.lookbehind,J=!!R.greedy,X=R.alias;if(J&&!R.pattern.global){var z=R.pattern.toString().match(/[imsuy]*$/)[0];R.pattern=RegExp(R.pattern.source,z+"g")}for(var H=R.pattern||R,U=N.next,L=E;U!==y.tail&&!(A&&L>=A.reach);L+=U.value.length,U=U.next){var ne=U.value;if(y.length>_.length)return;if(!(ne instanceof l)){var de=1,G;if(J){if(G=u(H,L,_,B),!G||G.index>=_.length)break;var se=G.index,K=G.index+G[0].length,Q=L;for(Q+=U.value.length;se>=Q;)U=U.next,Q+=U.value.length;if(Q-=U.value.length,L=Q,U.value instanceof l)continue;for(var q=U;q!==y.tail&&(Q<K||typeof q.value=="string");q=q.next)de++,Q+=q.value.length;de--,ne=_.slice(L,Q),G.index-=L}else if(G=u(H,0,ne,B),!G)continue;var se=G.index,W=G[0],ee=ne.slice(0,se),ve=ne.slice(se+W.length),_e=L+ne.length;A&&_e>A.reach&&(A.reach=_e);var Le=U.prev;ee&&(Le=h(y,Le,ee),L+=ee.length),p(y,Le,de);var te=new l(C,M?o.tokenize(W,M):W,X,W);if(U=h(y,Le,te),ve&&h(y,U,ve),de>1){var Ne={cause:C+","+D,reach:_e};d(_,y,k,U.prev,L,Ne),A&&Ne.reach>A.reach&&(A.reach=Ne.reach)}}}}}}function g(){var _={value:null,prev:null,next:null},y={value:null,prev:_,next:null};_.next=y,this.head=_,this.tail=y,this.length=0}function h(_,y,k){var N=y.next,E={value:k,prev:y,next:N};return y.next=E,N.prev=E,_.length++,E}function p(_,y,k){for(var N=y.next,E=0;E<k&&N!==_.tail;E++)N=N.next;y.next=N,N.prev=y,_.length-=E}function x(_){for(var y=[],k=_.head.next;k!==_.tail;)y.push(k.value),k=k.next;return y}if(!n.document)return n.addEventListener&&(o.disableWorkerMessageHandler||n.addEventListener("message",function(_){var y=JSON.parse(_.data),k=y.language,N=y.code,E=y.immediateClose;n.postMessage(o.highlight(N,o.languages[k],k)),E&&n.close()},!1)),o;var v=o.util.currentScript();v&&(o.filename=v.src,v.hasAttribute("data-manual")&&(o.manual=!0));function w(){o.manual||o.highlightAll()}if(!o.manual){var S=document.readyState;S==="loading"||S==="interactive"&&v&&v.defer?document.addEventListener("DOMContentLoaded",w):window.requestAnimationFrame?window.requestAnimationFrame(w):window.setTimeout(w,16)}return o}(e);t.exports&&(t.exports=r),typeof Gx<"u"&&(Gx.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(n){n.type==="entity"&&(n.attributes.title=n.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(s,a){var i={};i["language-"+a]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[a]},i.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:i}};o["language-"+a]={pattern:/[\s\S]+/,inside:r.languages[a]};var l={};l[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},r.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(n,s){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+n+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:r.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,function(n){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;n.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},n.languages.css.atrule.inside.rest=n.languages.css;var a=n.languages.markup;a&&(a.tag.addInlined("style","css"),a.tag.addAttribute("style","css"))}(r),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,function(){if(typeof r>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var n="Loading",s=function(v,w){return" Error "+v+" while fetching file: "+w},a=" Error: File does not exist or is empty",i={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",u="loaded",d="failed",g="pre[data-src]:not(["+o+'="'+u+'"]):not(['+o+'="'+l+'"])';function h(v,w,S){var _=new XMLHttpRequest;_.open("GET",v,!0),_.onreadystatechange=function(){_.readyState==4&&(_.status<400&&_.responseText?w(_.responseText):_.status>=400?S(s(_.status,_.statusText)):S(a))},_.send(null)}function p(v){var w=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(v||"");if(w){var S=Number(w[1]),_=w[2],y=w[3];return _?y?[S,Number(y)]:[S,void 0]:[S,S]}}r.hooks.add("before-highlightall",function(v){v.selector+=", "+g}),r.hooks.add("before-sanity-check",function(v){var w=v.element;if(w.matches(g)){v.code="",w.setAttribute(o,l);var S=w.appendChild(document.createElement("CODE"));S.textContent=n;var _=w.getAttribute("data-src"),y=v.language;if(y==="none"){var k=(/\.(\w+)$/.exec(_)||[,"none"])[1];y=i[k]||k}r.util.setLanguage(S,y),r.util.setLanguage(w,y);var N=r.plugins.autoloader;N&&N.loadLanguages(y),h(_,function(E){w.setAttribute(o,u);var A=p(w.getAttribute("data-range"));if(A){var C=E.split(/\r\n?|\n/g),F=A[0],D=A[1]==null?C.length:A[1];F<0&&(F+=C.length),F=Math.max(0,Math.min(F-1,C.length)),D<0&&(D+=C.length),D=Math.max(0,Math.min(D,C.length)),E=C.slice(F,D).join(`
`),w.hasAttribute("data-start")||w.setAttribute("data-start",String(F+1))}S.textContent=E,r.highlightElement(S)},function(E){w.setAttribute(o,d),S.textContent=E})}}),r.plugins.fileHighlight={highlight:function(w){for(var S=(w||document).querySelectorAll(g),_=0,y;y=S[_++];)r.highlightElement(y)}};var x=!1;r.fileHighlight=function(){x||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),x=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}}()})(ote);Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript;Prism.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]};Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity;Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup;Prism.hooks.add("wrap",function(t){t.type==="entity"&&(t.attributes.title=t.content.replace(/&amp;/,"&"))});Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function(e,r){var n={};n["language-"+r]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[r]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var s={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};s["language-"+r]={pattern:/[\s\S]+/,inside:Prism.languages[r]};var a={};a[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return e}),"i"),lookbehind:!0,greedy:!0,inside:s},Prism.languages.insertBefore("markup","cdata",a)}});Object.defineProperty(Prism.languages.markup.tag,"addAttribute",{value:function(t,e){Prism.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+t+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[e,"language-"+e],inside:Prism.languages[e]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}});Prism.languages.html=Prism.languages.markup;Prism.languages.mathml=Prism.languages.markup;Prism.languages.svg=Prism.languages.markup;Prism.languages.xml=Prism.languages.extend("markup",{});Prism.languages.ssml=Prism.languages.xml;Prism.languages.atom=Prism.languages.xml;Prism.languages.rss=Prism.languages.xml;(function(t){var e=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function r(d){return d=d.replace(/<inner>/g,function(){return e}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+d+")")}var n=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return n}),a=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;t.languages.markdown=t.languages.extend("markup",{}),t.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:t.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+a+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+a+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(n),inside:t.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+a+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(n),alias:"important",inside:t.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:r(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:r(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:r(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:r(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(d){["url","bold","italic","strike","code-snippet"].forEach(function(g){d!==g&&(t.languages.markdown[d].inside.content.inside[g]=t.languages.markdown[g])})}),t.hooks.add("after-tokenize",function(d){if(d.language!=="markdown"&&d.language!=="md")return;function g(h){if(!(!h||typeof h=="string"))for(var p=0,x=h.length;p<x;p++){var v=h[p];if(v.type!=="code"){g(v.content);continue}var w=v.content[1],S=v.content[3];if(w&&S&&w.type==="code-language"&&S.type==="code-block"&&typeof w.content=="string"){var _=w.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");_=(/[a-z][\w-]*/i.exec(_)||[""])[0].toLowerCase();var y="language-"+_;S.alias?typeof S.alias=="string"?S.alias=[S.alias,y]:S.alias.push(y):S.alias=[y]}}}g(d.tokens)}),t.hooks.add("wrap",function(d){if(d.type==="code-block"){for(var g="",h=0,p=d.classes.length;h<p;h++){var x=d.classes[h],v=/language-(.+)/.exec(x);if(v){g=v[1];break}}var w=t.languages[g];if(w)d.content=t.highlight(u(d.content),w,g);else if(g&&g!=="none"&&t.plugins.autoloader){var S="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);d.attributes.id=S,t.plugins.autoloader.loadLanguages(g,function(){var _=document.getElementById(S);_&&(_.innerHTML=t.highlight(_.textContent,t.languages[g],g))})}}});var i=RegExp(t.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;function u(d){var g=d.replace(i,"");return g=g.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(h,p){if(p=p.toLowerCase(),p[0]==="#"){var x;return p[1]==="x"?x=parseInt(p.slice(2),16):x=Number(p.slice(1)),l(x)}else{var v=o[p];return v||h}}),g}t.languages.md=t.languages.markdown})(Prism);Prism.languages.c=Prism.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/});Prism.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}});Prism.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},Prism.languages.c.string],char:Prism.languages.c.char,comment:Prism.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:Prism.languages.c}}}});Prism.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/});delete Prism.languages.c.boolean;(function(t){var e=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;t.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+e.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+e.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+e.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+e.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:e,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},t.languages.css.atrule.inside.rest=t.languages.css;var r=t.languages.markup;r&&(r.tag.addInlined("style","css"),r.tag.addAttribute("style","css"))})(Prism);Prism.languages.objectivec=Prism.languages.extend("c",{string:{pattern:/@?"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},keyword:/\b(?:asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|in|inline|int|long|register|return|self|short|signed|sizeof|static|struct|super|switch|typedef|typeof|union|unsigned|void|volatile|while)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/});delete Prism.languages.objectivec["class-name"];Prism.languages.objc=Prism.languages.objectivec;Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};(function(t){var e=t.languages.powershell={comment:[{pattern:/(^|[^`])<#[\s\S]*?#>/,lookbehind:!0},{pattern:/(^|[^`])#.*/,lookbehind:!0}],string:[{pattern:/"(?:`[\s\S]|[^`"])*"/,greedy:!0,inside:null},{pattern:/'(?:[^']|'')*'/,greedy:!0}],namespace:/\[[a-z](?:\[(?:\[[^\]]*\]|[^\[\]])*\]|[^\[\]])*\]/i,boolean:/\$(?:false|true)\b/i,variable:/\$\w+\b/,function:[/\b(?:Add|Approve|Assert|Backup|Block|Checkpoint|Clear|Close|Compare|Complete|Compress|Confirm|Connect|Convert|ConvertFrom|ConvertTo|Copy|Debug|Deny|Disable|Disconnect|Dismount|Edit|Enable|Enter|Exit|Expand|Export|Find|ForEach|Format|Get|Grant|Group|Hide|Import|Initialize|Install|Invoke|Join|Limit|Lock|Measure|Merge|Move|New|Open|Optimize|Out|Ping|Pop|Protect|Publish|Push|Read|Receive|Redo|Register|Remove|Rename|Repair|Request|Reset|Resize|Resolve|Restart|Restore|Resume|Revoke|Save|Search|Select|Send|Set|Show|Skip|Sort|Split|Start|Step|Stop|Submit|Suspend|Switch|Sync|Tee|Test|Trace|Unblock|Undo|Uninstall|Unlock|Unprotect|Unpublish|Unregister|Update|Use|Wait|Watch|Where|Write)-[a-z]+\b/i,/\b(?:ac|cat|chdir|clc|cli|clp|clv|compare|copy|cp|cpi|cpp|cvpa|dbp|del|diff|dir|ebp|echo|epal|epcsv|epsn|erase|fc|fl|ft|fw|gal|gbp|gc|gci|gcs|gdr|gi|gl|gm|gp|gps|group|gsv|gu|gv|gwmi|iex|ii|ipal|ipcsv|ipsn|irm|iwmi|iwr|kill|lp|ls|measure|mi|mount|move|mp|mv|nal|ndr|ni|nv|ogv|popd|ps|pushd|pwd|rbp|rd|rdr|ren|ri|rm|rmdir|rni|rnp|rp|rv|rvpa|rwmi|sal|saps|sasv|sbp|sc|select|set|shcm|si|sl|sleep|sls|sort|sp|spps|spsv|start|sv|swmi|tee|trcm|type|write)\b/i],keyword:/\b(?:Begin|Break|Catch|Class|Continue|Data|Define|Do|DynamicParam|Else|ElseIf|End|Exit|Filter|Finally|For|ForEach|From|Function|If|InlineScript|Parallel|Param|Process|Return|Sequence|Switch|Throw|Trap|Try|Until|Using|Var|While|Workflow)\b/i,operator:{pattern:/(^|\W)(?:!|-(?:b?(?:and|x?or)|as|(?:Not)?(?:Contains|In|Like|Match)|eq|ge|gt|is(?:Not)?|Join|le|lt|ne|not|Replace|sh[lr])\b|-[-=]?|\+[+=]?|[*\/%]=?)/i,lookbehind:!0},punctuation:/[|{}[\];(),.]/};e.string[0].inside={function:{pattern:/(^|[^`])\$\((?:\$\([^\r\n()]*\)|(?!\$\()[^\r\n)])*\)/,lookbehind:!0,inside:e},boolean:e.boolean,variable:e.variable}})(Prism);Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/};Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python;Prism.languages.py=Prism.languages.python;(function(t){for(var e=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,r=0;r<2;r++)e=e.replace(/<self>/g,function(){return e});e=e.replace(/<self>/g,function(){return/[^\s\S]/.source}),t.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+e),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},t.languages.rust["closure-params"].inside.rest=t.languages.rust,t.languages.rust.attribute.inside.string=t.languages.rust.string})(Prism);Prism.languages.swift={comment:{pattern:/(^|[^\\:])(?:\/\/.*|\/\*(?:[^/*]|\/(?!\*)|\*(?!\/)|\/\*(?:[^*]|\*(?!\/))*\*\/)*\*\/)/,lookbehind:!0,greedy:!0},"string-literal":[{pattern:RegExp(/(^|[^"#])/.source+"(?:"+/"(?:\\(?:\((?:[^()]|\([^()]*\))*\)|\r\n|[^(])|[^\\\r\n"])*"/.source+"|"+/"""(?:\\(?:\((?:[^()]|\([^()]*\))*\)|[^(])|[^\\"]|"(?!""))*"""/.source+")"+/(?!["#])/.source),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\\($/,alias:"punctuation"},punctuation:/\\(?=[\r\n])/,string:/[\s\S]+/}},{pattern:RegExp(/(^|[^"#])(#+)/.source+"(?:"+/"(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|\r\n|[^#])|[^\\\r\n])*?"/.source+"|"+/"""(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|[^#])|[^\\])*?"""/.source+")\\2"),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\#+\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\#+\($/,alias:"punctuation"},string:/[\s\S]+/}}],directive:{pattern:RegExp(/#/.source+"(?:"+(/(?:elseif|if)\b/.source+"(?:[ 	]*"+/(?:![ \t]*)?(?:\b\w+\b(?:[ \t]*\((?:[^()]|\([^()]*\))*\))?|\((?:[^()]|\([^()]*\))*\))(?:[ \t]*(?:&&|\|\|))?/.source+")+")+"|"+/(?:else|endif)\b/.source+")"),alias:"property",inside:{"directive-name":/^#\w+/,boolean:/\b(?:false|true)\b/,number:/\b\d+(?:\.\d+)*\b/,operator:/!|&&|\|\||[<>]=?/,punctuation:/[(),]/}},literal:{pattern:/#(?:colorLiteral|column|dsohandle|file(?:ID|Literal|Path)?|function|imageLiteral|line)\b/,alias:"constant"},"other-directive":{pattern:/#\w+\b/,alias:"property"},attribute:{pattern:/@\w+/,alias:"atrule"},"function-definition":{pattern:/(\bfunc\s+)\w+/,lookbehind:!0,alias:"function"},label:{pattern:/\b(break|continue)\s+\w+|\b[a-zA-Z_]\w*(?=\s*:\s*(?:for|repeat|while)\b)/,lookbehind:!0,alias:"important"},keyword:/\b(?:Any|Protocol|Self|Type|actor|as|assignment|associatedtype|associativity|async|await|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic|else|enum|extension|fallthrough|fileprivate|final|for|func|get|guard|higherThan|if|import|in|indirect|infix|init|inout|internal|is|isolated|lazy|left|let|lowerThan|mutating|none|nonisolated|nonmutating|open|operator|optional|override|postfix|precedencegroup|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|set|some|static|struct|subscript|super|switch|throw|throws|try|typealias|unowned|unsafe|var|weak|where|while|willSet)\b/,boolean:/\b(?:false|true)\b/,nil:{pattern:/\bnil\b/,alias:"constant"},"short-argument":/\$\d+\b/,omit:{pattern:/\b_\b/,alias:"keyword"},number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,"class-name":/\b[A-Z](?:[A-Z_\d]*[a-z]\w*)?\b/,function:/\b[a-z_]\w*(?=\s*\()/i,constant:/\b(?:[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,operator:/[-+*/%=!<>&|^~?]+|\.[.\-+*/%=!<>&|^~?]+/,punctuation:/[{}[\]();,.:\\]/};Prism.languages.swift["string-literal"].forEach(function(t){t.inside.interpolation.inside=Prism.languages.swift});(function(t){t.languages.typescript=t.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),t.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete t.languages.typescript.parameter,delete t.languages.typescript["literal-property"];var e=t.languages.extend("typescript",{});delete e["class-name"],t.languages.typescript["class-name"].inside=e,t.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e}}}}),t.languages.ts=t.languages.typescript})(Prism);(function(t){var e=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,r=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,n={pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};t.languages.java=t.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[n,{pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:n.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+r+/[A-Z]\w*\b/.source),lookbehind:!0,inside:n.inside}],keyword:e,function:[t.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),t.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),t.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":n,keyword:e,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+r+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:n.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+r+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:n.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,function(){return e.source})),lookbehind:!0,inside:{punctuation:/\./}}})})(Prism);(function(t){var e=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,r=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,function(){return e.source});t.languages.cpp=t.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,function(){return e.source})),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:e,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),t.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,function(){return r})+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),t.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t.languages.cpp}}}}),t.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),t.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:t.languages.extend("cpp",{})}}),t.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},t.languages.cpp["base-clause"])})(Prism);function fM(t,e){for(const r of t.childNodes){if(Qr(r)&&r.tagName===e)return!0;fM(r,e)}return!1}const b0="data-language",h0="data-highlight-language",cx="data-theme";class gd extends Ks{static getType(){return"code"}static clone(e){return new gd(e.__language,e.__key)}constructor(e,r){super(r),this.__language=e||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(e){super.afterCloneFrom(e),this.__language=e.__language,this.__theme=e.__theme,this.__isSyntaxHighlightSupported=e.__isSyntaxHighlightSupported}createDOM(e){const r=document.createElement("code");Qn(r,e.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(b0,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(h0,n));const s=this.getTheme();s&&r.setAttribute(cx,s);const a=this.getStyle();return a&&r.setAttribute("style",a),r}updateDOM(e,r,n){const s=this.__language,a=e.__language;s?s!==a&&r.setAttribute(b0,s):a&&r.removeAttribute(b0);const i=this.__isSyntaxHighlightSupported;e.__isSyntaxHighlightSupported&&a?i&&s?s!==a&&r.setAttribute(h0,s):r.removeAttribute(h0):i&&s&&r.setAttribute(h0,s);const o=this.__theme,l=e.__theme;o?o!==l&&r.setAttribute(cx,o):l&&r.removeAttribute(cx);const u=this.__style,d=e.__style;return u?u!==d&&r.setAttribute("style",u):d&&r.removeAttribute("style"),!1}exportDOM(e){const r=document.createElement("pre");Qn(r,e._config.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(b0,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(h0,n));const s=this.getTheme();s&&r.setAttribute(cx,s);const a=this.getStyle();return a&&r.setAttribute("style",a),{element:r}}static importDOM(){return{code:e=>e.textContent!=null&&(/\r?\n/.test(e.textContent)||fM(e,"BR"))?{conversion:QA,priority:1}:null,div:()=>({conversion:lte,priority:1}),pre:()=>({conversion:QA,priority:0}),table:e=>p2(e)?{conversion:cte,priority:3}:null,td:e=>{const r=e,n=r.closest("table");return r.classList.contains("js-file-line")||n&&p2(n)?{conversion:qA,priority:3}:null},tr:e=>{const r=e.closest("table");return r&&p2(r)?{conversion:qA,priority:3}:null}}}static importJSON(e){return rl().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setLanguage(e.language).setTheme(e.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(e,r=!0){const n=this.getChildren(),s=n.length;if(s>=2&&n[s-1].getTextContent()===`
`&&n[s-2].getTextContent()===`
`&&e.isCollapsed()&&e.anchor.key===this.__key&&e.anchor.offset===s){n[s-1].remove(),n[s-2].remove();const l=Jr();return this.insertAfter(l,r),l}const{anchor:a,focus:i}=e,o=(a.isBefore(i)?a:i).getNode();if(_t(o)){let l=dte(o);const u=[];for(;;)if(kv(l))u.push(wh()),l=l.getNextSibling();else{if(!mM(l))break;{let w=0;const S=l.getTextContent(),_=l.getTextContentSize();for(;w<_&&S[w]===" ";)w++;if(w!==0&&u.push(gM(" ".repeat(w))),w!==_)break;l=l.getNextSibling()}}const d=o.splitText(a.offset)[0],g=a.offset===0?0:1,h=d.getIndexWithinParent()+g,p=o.getParentOrThrow(),x=[Eo(),...u];p.splice(h,0,x);const v=u[u.length-1];v?v.select():a.offset===0?d.selectPrevious():d.getNextSibling().selectNext(0,0)}if(WT(o)){const{offset:l}=e.anchor;o.splice(l,0,[Eo()]),o.select(l+1,l+1)}return null}canIndent(){return!1}collapseAtStart(){const e=Jr();return this.getChildren().forEach(r=>e.append(r)),this.replace(e),!0}setLanguage(e){const r=this.getWritable();return r.__language=e||void 0,r}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(e){const r=this.getWritable();return r.__isSyntaxHighlightSupported=e,r}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(e){const r=this.getWritable();return r.__theme=e||void 0,r}getTheme(){return this.getLatest().__theme}}function rl(t,e){return LZ(gd).setLanguage(t).setTheme(e)}function WT(t){return t instanceof gd}function QA(t){return{node:rl(t.getAttribute(b0))}}function lte(t){const e=t,r=ZA(e);return r||function(n){let s=n.parentElement;for(;s!==null;){if(ZA(s))return!0;s=s.parentElement}return!1}(e)?{node:r?rl():null}:{node:null}}function cte(){return{node:rl()}}function qA(){return{node:null}}function ZA(t){return t.style.fontFamily.match("monospace")!==null}function p2(t){return t.classList.contains("js-file-line-container")}let Rv=class hM extends Lc{constructor(e="",r,n){super(e,n),this.__highlightType=r}static getType(){return"code-highlight"}static clone(e){return new hM(e.__text,e.__highlightType||void 0,e.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(e){const r=this.getWritable();return r.__highlightType=e||void 0,r}canHaveFormat(){return!1}createDOM(e){const r=super.createDOM(e),n=x2(e.theme,this.__highlightType);return Qn(r,n),r}updateDOM(e,r,n){const s=super.updateDOM(e,r,n),a=x2(n.theme,e.__highlightType),i=x2(n.theme,this.__highlightType);return a!==i&&(a&&dc(r,a),i&&Qn(r,i)),s}static importJSON(e){return gM().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHighlightType(e.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(e){return this}isParentRequired(){return!0}createParentElementNode(){return rl()}};function x2(t,e){return e&&t&&t.codeHighlight&&t.codeHighlight[e]}function gM(t="",e){return ua(new Rv(t,e))}function mM(t){return t instanceof Rv}function ute(t,e){let r=t;for(let n=Ts(t,e);n&&(mM(n.origin)||kv(n.origin));n=iee(n))r=n.origin;return r}function dte(t){return ute(t,"previous")}(function(t){t.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var e={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(e).forEach(function(r){var n=e[r],s=[];/^\w+$/.test(r)||s.push(/\w+/.exec(r)[0]),r==="diff"&&s.push("bold"),t.languages.diff[r]={pattern:RegExp("^(?:["+n+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(r)[0]}}}}),Object.defineProperty(t.languages.diff,"PREFIXES",{value:e})})(Prism);const fte=new Set(["http:","https:","mailto:","sms:","tel:"]);class Bc extends Ks{static getType(){return"link"}static clone(e){return new Bc(e.__url,{rel:e.__rel,target:e.__target,title:e.__title},e.__key)}constructor(e="",r={},n){super(n);const{target:s=null,rel:a=null,title:i=null}=r;this.__url=e,this.__target=s,this.__rel=a,this.__title=i}createDOM(e){const r=document.createElement("a");return this.updateLinkDOM(null,r,e),Qn(r,e.theme.link),r}updateLinkDOM(e,r,n){if(NR(r)){e&&e.__url===this.__url||(r.href=this.sanitizeUrl(this.__url));for(const s of["target","rel","title"]){const a=`__${s}`,i=this[a];e&&e[a]===i||(i?r[s]=i:r.removeAttribute(s))}}}updateDOM(e,r,n){return this.updateLinkDOM(e,r,n),!1}static importDOM(){return{a:e=>({conversion:hte,priority:1})}}static importJSON(e){return G1().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setURL(e.url).setRel(e.rel||null).setTarget(e.target||null).setTitle(e.title||null)}sanitizeUrl(e){e=t8(e);try{const r=new URL(t8(e));if(!fte.has(r.protocol))return"about:blank"}catch{return e}return e}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),url:this.getURL()}}getURL(){return this.getLatest().__url}setURL(e){const r=this.getWritable();return r.__url=e,r}getTarget(){return this.getLatest().__target}setTarget(e){const r=this.getWritable();return r.__target=e,r}getRel(){return this.getLatest().__rel}setRel(e){const r=this.getWritable();return r.__rel=e,r}getTitle(){return this.getLatest().__title}setTitle(e){const r=this.getWritable();return r.__title=e,r}insertNewAfter(e,r=!0){const n=G1(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(n,r),n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(e,r,n){if(!lt(r))return!1;const s=r.anchor.getNode(),a=r.focus.getNode();return this.isParentOf(s)&&this.isParentOf(a)&&r.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}}function hte(t){let e=null;if(NR(t)){const r=t.textContent;(r!==null&&r!==""||t.children.length>0)&&(e=G1(t.getAttribute("href")||"",{rel:t.getAttribute("rel"),target:t.getAttribute("target"),title:t.getAttribute("title")}))}return{node:e}}function G1(t="",e){return ua(new Bc(t,e))}function gte(t){return t instanceof Bc}class Eh extends Bc{constructor(e="",r={},n){super(e,r,n),this.__isUnlinked=r.isUnlinked!==void 0&&r.isUnlinked!==null&&r.isUnlinked}static getType(){return"autolink"}static clone(e){return new Eh(e.__url,{isUnlinked:e.__isUnlinked,rel:e.__rel,target:e.__target,title:e.__title},e.__key)}getIsUnlinked(){return this.__isUnlinked}setIsUnlinked(e){const r=this.getWritable();return r.__isUnlinked=e,r}createDOM(e){return this.__isUnlinked?document.createElement("span"):super.createDOM(e)}updateDOM(e,r,n){return super.updateDOM(e,r,n)||e.__isUnlinked!==this.__isUnlinked}static importJSON(e){return e8().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setIsUnlinked(e.isUnlinked||!1)}static importDOM(){return null}exportJSON(){return{...super.exportJSON(),isUnlinked:this.__isUnlinked}}insertNewAfter(e,r=!0){const n=this.getParentOrThrow().insertNewAfter(e,r);if(Qe(n)){const s=e8(this.__url,{isUnlinked:this.__isUnlinked,rel:this.__rel,target:this.__target,title:this.__title});return n.append(s),s}return null}}function e8(t="",e){return ua(new Eh(t,e))}function mte(t){return t instanceof Eh}const pte=/^\+?[0-9\s()-]{5,}$/;function t8(t){return t.match(/^[a-z][a-z0-9+.-]*:/i)||t.match(/^[/#.]/)?t:t.includes("@")?`mailto:${t}`:pte.test(t)?`tel:${t}`:`https://${t}`}function $S(t,e){const r={};for(const n of t){const s=e(n);s&&(r[s]?r[s].push(n):r[s]=[n])}return r}function xte(t){const e=$S(t,r=>r.type);return{element:e.element||[],multilineElement:e["multiline-element"]||[],textFormat:e["text-format"]||[],textMatch:e["text-match"]||[]}}const r8=/[!-/:-@[-`{-~\s]/;function yte(t){return _t(t)&&!t.hasFormat("code")}function vte(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function n8(t,e,r){const n=r.length;for(let s=e;s>=n;s--){const a=s-n;if(pM(t,a,r,0,n)&&t[a+n]!==" ")return a}return-1}function pM(t,e,r,n,s){for(let a=0;a<s;a++)if(t[e+a]!==r[n+a])return!1;return!0}function wte(t,e=Mv){const r=xte(e),n=$S(r.textFormat,({tag:i})=>i[i.length-1]),s=$S(r.textMatch,({trigger:i})=>i);for(const i of e){const o=i.type;if(o==="element"||o==="text-match"||o==="multiline-element"){const l=i.dependencies;for(const u of l)t.hasNode(u)||vte(173,u.getType())}}const a=(i,o,l)=>{(function(u,d,g,h){const p=u.getParent();if(!ia(p)||u.getFirstChild()!==d)return!1;const x=d.getTextContent();if(x[g-1]!==" ")return!1;for(const{regExp:v,replace:w}of h){const S=x.match(v);if(S&&S[0].length===(S[0].endsWith(" ")?g:g-1)){const _=d.getNextSiblings(),[y,k]=d.splitText(g);if(w(u,k?[k,..._]:_,S,!1)!==!1)return y.remove(),!0}}return!1})(i,o,l,r.element)||function(u,d,g,h){const p=u.getParent();if(!ia(p)||u.getFirstChild()!==d)return!1;const x=d.getTextContent();if(x[g-1]!==" ")return!1;for(const{regExpStart:v,replace:w,regExpEnd:S}of h){if(S&&!("optional"in S)||S&&"optional"in S&&!S.optional)continue;const _=x.match(v);if(_&&_[0].length===(_[0].endsWith(" ")?g:g-1)){const y=d.getNextSiblings(),[k,N]=d.splitText(g);if(w(u,N?[N,...y]:y,_,null,null,!1)!==!1)return k.remove(),!0}}return!1}(i,o,l,r.multilineElement)||function(u,d,g){let h=u.getTextContent();const p=g[h[d-1]];if(p==null)return!1;d<h.length&&(h=h.slice(0,d));for(const x of p){if(!x.replace||!x.regExp)continue;const v=h.match(x.regExp);if(v===null)continue;const w=v.index||0,S=w+v[0].length;let _;return w===0?[_]=u.splitText(S):[,_]=u.splitText(w,S),_.selectNext(0,0),x.replace(_,v),!0}return!1}(o,l,s)||function(u,d,g){const h=u.getTextContent(),p=d-1,x=h[p],v=g[x];if(!v)return!1;for(const w of v){const{tag:S}=w,_=S.length,y=p-_+1;if(_>1&&!pM(h,y,S,0,_)||h[y-1]===" ")continue;const k=h[p+1];if(w.intraword===!1&&k&&!r8.test(k))continue;const N=u;let E=N,A=n8(h,y,S),C=E;for(;A<0&&(C=C.getPreviousSibling())&&!il(C);)if(_t(C)){if(C.hasFormat("code"))continue;const H=C.getTextContent();E=C,A=n8(H,H.length,S)}if(A<0||E===N&&A+_===y)continue;const F=E.getTextContent();if(A>0&&F[A-1]===x)continue;const D=F[A-1];if(w.intraword===!1&&D&&!r8.test(D))continue;const R=N.getTextContent(),M=R.slice(0,y)+R.slice(p+1);N.setTextContent(M);const B=E===N?M:F;E.setTextContent(B.slice(0,A)+B.slice(A+_));const J=wt(),X=Tv();Ns(X);const z=p-_*(E===N?2:1)+1;X.anchor.set(E.__key,A,"text"),X.focus.set(N.__key,z,"text");for(const H of w.format)X.hasFormat(H)||X.formatText(H);X.anchor.set(X.focus.key,X.focus.offset,X.focus.type);for(const H of w.format)X.hasFormat(H)&&X.toggleFormat(H);return lt(J)&&(X.format=J.format),!0}}(o,l,n)};return t.registerUpdateListener(({tags:i,dirtyLeaves:o,editorState:l,prevEditorState:u})=>{if(i.has(mR)||i.has(B1)||t.isComposing())return;const d=l.read(wt),g=u.read(wt);if(!lt(g)||!lt(d)||!d.isCollapsed()||d.is(g))return;const h=d.anchor.key,p=d.anchor.offset,x=l._nodeMap.get(h);!_t(x)||!o.has(h)||p!==1&&p>g.anchor.offset+1||t.update(()=>{if(!yte(x))return;const v=x.getParent();v===null||WT(v)||a(v,x,d.anchor.offset)})})}const _te=/^(\s*)(\d{1,})\.\s/,bte=/^(\s*)[-*+]\s/,Ste=/^(#{1,6})\s/,kte=/^>\s/,Cte=/^[ \t]*```([\w-]+)?/,Tte=/[ \t]*```$/,xM=t=>(e,r,n,s)=>{const a=t(n);a.append(...r),e.replace(a),s||a.select(0,0)},yM=t=>(e,r,n,s)=>{const a=e.getPreviousSibling(),i=e.getNextSibling(),o=Ua(t==="check"?n[3]==="x":void 0);if(er(i)&&i.getListType()===t){const u=i.getFirstChild();u!==null?u.insertBefore(o):i.append(o),e.remove()}else if(er(a)&&a.getListType()===t)a.append(o),e.remove();else{const u=Ta(t,t==="number"?Number(n[2]):void 0);u.append(o),e.replace(u)}o.append(...r),s||o.select(0,0);const l=function(u){const d=u.match(/\t/g),g=u.match(/ /g);let h=0;return d&&(h+=d.length),g&&(h+=Math.floor(g.length/4)),h}(n[1]);l&&o.setIndent(l)},zT=(t,e,r)=>{const n=[],s=t.getChildren();let a=0;for(const i of s)if(Ar(i)){if(i.getChildrenSize()===1){const d=i.getFirstChild();if(er(d)){n.push(zT(d,e,r+1));continue}}const o=" ".repeat(4*r),l=t.getListType(),u=l==="number"?`${t.getStart()+a}. `:l==="check"?`- [${i.getChecked()?"x":" "}] `:"- ";n.push(o+u+e(i)),a++}return n.join(`
`)},Ete={dependencies:[km],export:(t,e)=>{if(!Nee(t))return null;const r=Number(t.getTag().slice(1));return"#".repeat(r)+" "+e(t)},regExp:Ste,replace:xM(t=>{const e="h"+t[1].length;return Ql(e)}),type:"element"},Nte={dependencies:[bm],export:(t,e)=>{if(!RA(t))return null;const r=e(t).split(`
`),n=[];for(const s of r)n.push("> "+s);return n.join(`
`)},regExp:kte,replace:(t,e,r,n)=>{if(n){const a=t.getPreviousSibling();if(RA(a))return a.splice(a.getChildrenSize(),0,[Eo(),...e]),void t.remove()}const s=Sm();s.append(...e),t.replace(s),n||s.select(0,0)},type:"element"},Ate={dependencies:[gd],export:t=>{if(!WT(t))return null;const e=t.getTextContent();return"```"+(t.getLanguage()||"")+(e?`
`+e:"")+"\n```"},regExpEnd:{optional:!0,regExp:Tte},regExpStart:Cte,replace:(t,e,r,n,s,a)=>{let i,o;if(!e&&s){if(s.length===1)n?(i=rl(),o=r[1]+s[0]):(i=rl(r[1]),o=s[0].startsWith(" ")?s[0].slice(1):s[0]);else{if(i=rl(r[1]),s[0].trim().length===0)for(;s.length>0&&!s[0].length;)s.shift();else s[0]=s[0].startsWith(" ")?s[0].slice(1):s[0];for(;s.length>0&&!s[s.length-1].length;)s.pop();o=s.join(`
`)}const l=_n(o);i.append(l),t.append(i)}else e&&xM(l=>rl(l?l[1]:void 0))(t,e,r,a)},type:"multiline-element"},jte={dependencies:[Oc,Cl],export:(t,e)=>er(t)?zT(t,e,0):null,regExp:bte,replace:yM("bullet"),type:"element"},Fte={dependencies:[Oc,Cl],export:(t,e)=>er(t)?zT(t,e,0):null,regExp:_te,replace:yM("number"),type:"element"},Pte={format:["code"],tag:"`",type:"text-format"},Dte={format:["highlight"],tag:"==",type:"text-format"},Rte={format:["bold","italic"],tag:"***",type:"text-format"},Mte={format:["bold","italic"],intraword:!1,tag:"___",type:"text-format"},Lte={format:["bold"],tag:"**",type:"text-format"},Ite={format:["bold"],intraword:!1,tag:"__",type:"text-format"},Ote={format:["strikethrough"],tag:"~~",type:"text-format"},Bte={format:["italic"],tag:"*",type:"text-format"},Ute={format:["italic"],intraword:!1,tag:"_",type:"text-format"},$te={dependencies:[Bc],export:(t,e,r)=>{if(!gte(t)||mte(t))return null;const n=t.getTitle(),s=e(t);return n?`[${s}](${t.getURL()} "${n}")`:`[${s}](${t.getURL()})`},importRegExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))/,regExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))$/,replace:(t,e)=>{const[,r,n,s]=e,a=G1(n,{title:s}),i=r.split("[").length-1,o=r.split("]").length-1;let l=r,u="";if(i<o)return;if(i>o){const g=r.split("[");u="["+g[0],l=g.slice(1).join("[")}const d=_n(l);return d.setFormat(t.getFormat()),a.append(d),t.replace(a),u&&a.insertBefore(_n(u)),d},trigger:")",type:"text-match"},Wte=[Ete,Nte,jte,Fte],zte=[Ate],Hte=[Pte,Rte,Mte,Lte,Ite,Dte,Bte,Ute,Ote],Gte=[$te],Mv=[...Wte,...zte,...Hte,...Gte];function s8(t,e){return t.getEditorState().read(()=>{const r=Hn(e);return r!==null&&r.isSelected()})}function Vte(t){const[e]=Fo(),[r,n]=b.useState(()=>s8(e,t));return b.useEffect(()=>{let s=!0;const a=e.registerUpdateListener(()=>{s&&n(s8(e,t))});return()=>{s=!1,a()}},[e,t]),[r,b.useCallback(s=>{e.update(()=>{let a=wt();Ls(a)||(a=dT(),Ns(a)),Ls(a)&&(s?a.add(t):a.delete(t))})},[e,t]),b.useCallback(()=>{e.update(()=>{const s=wt();Ls(s)&&s.clear()})},[e])]}function Kte({nodeKey:t}){const[e]=Fo(),[r,n,s]=Vte(t);return b.useEffect(()=>hd(e.registerCommand(aT,a=>{const i=e.getElementByKey(t);return a.target===i&&(a.shiftKey||s(),n(!r),!0)},Kd)),[s,e,r,t,n]),b.useEffect(()=>{const a=e.getElementByKey(t),i=e._config.theme.hrSelected??"selected";a!==null&&(r?Qn(a,i):dc(a,i))},[e,r,t]),null}class Tm extends gT{static getType(){return"horizontalrule"}static clone(e){return new Tm(e.__key)}static importJSON(e){return HT().updateFromJSON(e)}static importDOM(){return{hr:()=>({conversion:Xte,priority:0})}}exportDOM(){return{element:document.createElement("hr")}}createDOM(e){const r=document.createElement("hr");return Qn(r,e.theme.hr),r}getTextContent(){return`
`}isInline(){return!1}updateDOM(){return!1}decorate(){return c.jsx(Kte,{nodeKey:this.__key})}}function Xte(){return{node:HT()}}function HT(){return ua(new Tm)}function Yte(t){return t instanceof Tm}const Jte=[{dependencies:[Tm],export:t=>Yte(t)?"***":null,regExp:/^(---|\*\*\*|___)\s?$/,replace:(t,e,r,n)=>{const s=HT();n||t.getNextSibling()!=null?t.replace(s):t.insertBefore(s),s.selectNext()},type:"element"},...Mv];function vM({transformers:t=Jte}){const[e]=Fo();return b.useEffect(()=>wte(e,t),[e,t]),null}function wM({hasStrictIndent:t=!1}){const[e]=Fo();return b.useEffect(()=>{if(!e.hasNodes([Oc,Cl]))throw new Error("ListPlugin: ListNode and/or ListItemNode not registered on editor")},[e]),b.useEffect(()=>{if(t)return ite(e)},[e,t]),function(r){b.useEffect(()=>ate(r),[r])}(e),null}const Qte=({onChange:t})=>{const[e]=b.useContext(yh)||[];return b.useEffect(()=>{if(t&&e)return e.registerUpdateListener(({editorState:r})=>{r.read(()=>{an().getTextContent();const s=r.toJSON();t(JSON.stringify(s))})})},[e,t]),null},qte=()=>{const[t]=b.useContext(yh)||[],e=b.useCallback(()=>{t&&t.dispatchCommand(zs,"bold")},[t]),r=b.useCallback(()=>{t&&t.dispatchCommand(zs,"italic")},[t]),n=b.useCallback(()=>{t&&t.dispatchCommand(zs,"underline")},[t]),s=b.useCallback(()=>{t&&t.dispatchCommand(zs,"strikethrough")},[t]),a=b.useCallback(p=>{t&&t.update(()=>{const x=wt();lt(x)&&Nf(x,()=>Ql(p))})},[t]),i=b.useCallback(()=>{t&&t.update(()=>{const p=wt();lt(p)&&Nf(p,()=>Jr())})},[t]);b.useCallback(()=>{t&&t.update(()=>{const p=wt();lt(p)&&Nf(p,()=>Sm())})},[t]);const o=b.useCallback(()=>{t&&t.dispatchCommand(BT)},[t]),l=b.useCallback(()=>{t&&t.dispatchCommand(UT)},[t]),u=b.useCallback(()=>{t&&t.dispatchCommand($T)},[t]),d=b.useCallback(p=>{t&&t.update(()=>{const x=wt();lt(x)&&x.getNodes().forEach(v=>{_t(v)&&v.setStyle(`color: ${p}`)})})},[t]),g=b.useCallback(p=>{t&&t.update(()=>{const x=wt();lt(x)&&x.getNodes().forEach(w=>{if(_t(w)){const S=w.getStyle(),_=S?S.replace(/font-size:\s*\d+px;?\s*/g,"").trim():"",y=_?`${_}; font-size: ${p}px;`:`font-size: ${p}px;`;w.setStyle(y)}})})},[t]),h=b.useCallback(p=>{t&&t.dispatchCommand(KD,p)},[t]);return c.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:e,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),c.jsx("button",{type:"button",onClick:r,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),c.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),c.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:()=>a("h1"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),c.jsx("button",{type:"button",onClick:()=>a("h2"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),c.jsx("button",{type:"button",onClick:()=>a("h3"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),c.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:o,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:" List"}),c.jsx("button",{type:"button",onClick:l,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1. List"}),c.jsx("button",{type:"button",onClick:u,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:"No List"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("span",{className:"text-xs text-gray-600",children:"Color:"}),c.jsx("button",{type:"button",onClick:()=>d("#000000"),className:"w-6 h-6 bg-black border border-gray-300 rounded hover:bg-gray-800",title:"Black"}),c.jsx("button",{type:"button",onClick:()=>d("#ff0000"),className:"w-6 h-6 bg-red-500 border border-gray-300 rounded hover:bg-red-600",title:"Red"}),c.jsx("button",{type:"button",onClick:()=>d("#0000ff"),className:"w-6 h-6 bg-blue-500 border border-gray-300 rounded hover:bg-blue-600",title:"Blue"}),c.jsx("button",{type:"button",onClick:()=>d("#008000"),className:"w-6 h-6 bg-green-500 border border-gray-300 rounded hover:bg-green-600",title:"Green"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("span",{className:"text-xs text-gray-600",children:"Size:"}),c.jsx("button",{type:"button",onClick:()=>g(12),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Small",children:"12px"}),c.jsx("button",{type:"button",onClick:()=>g(16),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Normal",children:"16px"}),c.jsx("button",{type:"button",onClick:()=>g(20),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Large",children:"20px"}),c.jsx("button",{type:"button",onClick:()=>g(24),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Extra Large",children:"24px"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-xs text-gray-600",children:"Align:"}),c.jsx("button",{type:"button",onClick:()=>h("left"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Left",children:""}),c.jsx("button",{type:"button",onClick:()=>h("center"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Center",children:""}),c.jsx("button",{type:"button",onClick:()=>h("right"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Right",children:""})]})]})},Zte=({value:t,onChange:e,placeholder:r})=>{const n={namespace:"LexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[km,Oc,Cl,bm,gd,Rv,Cm,Ch,Th,Eh,Bc],onError:s=>{console.error("Lexical error:",s)},editorState:t?(()=>{try{const s=JSON.parse(t);return JSON.stringify(s)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:t,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return c.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:c.jsxs(RR,{initialConfig:n,children:[c.jsx(qte,{}),c.jsx(Qte,{onChange:e}),c.jsxs("div",{className:"relative",children:[c.jsx(qR,{contentEditable:c.jsx(eM,{className:"p-4 min-h-32 focus:outline-none",placeholder:r}),placeholder:c.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:nM}),c.jsx(tM,{}),c.jsx(rM,{}),c.jsx(wM,{}),c.jsx(vM,{transformers:Mv})]})]})})},ere=({testName:t="",onTestSaved:e,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=xn();Ji();const{showNotification:o}=Ys(),[l,u]=b.useState({test_name:t,num_questions:1,passing_score:100,questions:[{id:1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048}]}),[d,g]=b.useState({isLoading:!1,error:null,showPreview:!0});b.useEffect(()=>{u(_=>({..._,test_name:t||""}))},[t]);const h=()=>{if(l.num_questions>=3){g(k=>({...k,error:"Maximum 3 questions allowed for performance reasons"}));return}const y={id:Math.max(...l.questions.map(k=>k.id))+1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048};u(k=>({...k,num_questions:k.num_questions+1,questions:[...k.questions,y]}))},p=_=>{l.questions.length<=1||u(y=>({...y,num_questions:y.num_questions-1,questions:y.questions.filter(k=>k.id!==_)}))},x=(_,y)=>{u(k=>({...k,questions:k.questions.map(N=>N.id===_?{...N,question_json:y}:N)}))},v=(_,y,k)=>{u(N=>({...N,questions:N.questions.map(E=>E.id===_?{...E,canvas_width:y,canvas_height:k}:E)}))},w=(_,y,k)=>{u(N=>({...N,questions:N.questions.map(E=>E.id===_?{...E,max_canvas_width:y,max_canvas_height:k}:E)}))},S=async()=>{if(!l.test_name.trim()){g(_=>({..._,error:"Test name is required"}));return}if(l.questions.some(_=>!_.question_json.trim())){g(_=>({..._,error:"All questions must have content"}));return}g(_=>({..._,isLoading:!0,error:null}));try{const _={test_name:l.test_name,num_questions:l.num_questions,passing_score:l.passing_score,questions:l.questions.map((y,k)=>({question_id:k+1,question_json:y.question_json,canvas_width:y.canvas_width,canvas_height:y.canvas_height,max_canvas_width:y.max_canvas_width,max_canvas_height:y.max_canvas_height}))};e&&e(_)}catch(_){console.error("Error preparing drawing test:",_),g(y=>({...y,error:"Failed to prepare drawing test. Please try again."})),o("Failed to prepare drawing test","error")}finally{g(_=>({..._,isLoading:!1}))}};return c.jsx("div",{className:"drawing-test-creator max-w-4xl mx-auto p-6",children:c.jsxs(st,{className:"p-6",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Drawing Test"}),c.jsx("p",{className:"text-gray-600",children:"Create a test where students draw based on your instructions"})]}),c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Drawing Questions (",l.num_questions,"/3)"]}),c.jsx("p",{className:"text-sm text-gray-500",children:"Maximum 3 questions for optimal performance"})]}),c.jsxs(He,{onClick:h,disabled:l.num_questions>=3,variant:"primary",size:"sm",className:"flex items-center gap-2",children:[c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:c.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Question"]})]}),c.jsx("div",{className:"space-y-4",children:l.questions.map((_,y)=>c.jsxs(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsxs("h4",{className:"text-md font-medium text-gray-800",children:["Text ",y+1]}),l.questions.length>1&&c.jsx(He,{onClick:()=>p(_.id),variant:"secondary",size:"sm",className:"text-red-600 hover:text-red-700",children:c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:c.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Content *"}),c.jsx(Zte,{value:_.question_json,onChange:k=>x(_.id,k),placeholder:""})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Canvas Dimensions"}),c.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Canvas is the actual drawing area, viewport is the initial display size"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Viewport Width"}),c.jsx("input",{type:"number",value:_.canvas_width,onChange:k=>v(_.id,parseInt(k.target.value),_.canvas_height),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"2048"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Viewport Height"}),c.jsx("input",{type:"number",value:_.canvas_height,onChange:k=>v(_.id,_.canvas_width,parseInt(k.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"2048"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Canvas Width"}),c.jsx("input",{type:"number",value:_.max_canvas_width,onChange:k=>w(_.id,parseInt(k.target.value),_.max_canvas_height),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"4096"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Canvas Height"}),c.jsx("input",{type:"number",value:_.max_canvas_height,onChange:k=>w(_.id,_.max_canvas_width,parseInt(k.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"4096"})]})]})]})]},_.id))})]}),d.error&&c.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-700",children:d.error}),c.jsxs("div",{className:"flex justify-end gap-3",children:[c.jsx(He,{onClick:r,variant:"secondary",disabled:d.isLoading,children:"Cancel"}),c.jsx(He,{onClick:S,variant:"primary",disabled:d.isLoading||!l.test_name.trim(),className:"flex items-center gap-2",children:d.isLoading?c.jsxs(c.Fragment,{children:[c.jsx(nr,{size:"sm",color:"white"}),"Saving..."]}):"Save Test"})]})]})})},tre=({onChange:t})=>{const[e]=b.useContext(yh)||[];return b.useEffect(()=>{if(t&&e)return e.registerUpdateListener(({editorState:r})=>{r.read(()=>{an().getTextContent();const s=r.toJSON();t(JSON.stringify(s))})})},[e,t]),null},rre=({onAddBlank:t,blankCount:e})=>{const[r]=b.useContext(yh)||[],n=b.useCallback(()=>{r&&r.dispatchCommand(zs,"bold")},[r]),s=b.useCallback(()=>{r&&r.dispatchCommand(zs,"italic")},[r]),a=b.useCallback(()=>{r&&r.dispatchCommand(zs,"underline")},[r]),i=b.useCallback(()=>{r&&r.dispatchCommand(zs,"strikethrough")},[r]),o=b.useCallback(x=>{r&&r.update(()=>{const v=wt();lt(v)&&Nf(v,()=>Ql(x))})},[r]),l=b.useCallback(()=>{r&&r.update(()=>{const x=wt();lt(x)&&Nf(x,()=>Jr())})},[r]),u=b.useCallback(()=>{r&&r.update(()=>{const x=wt();lt(x)&&Nf(x,()=>Sm())})},[r]),d=b.useCallback(()=>{r&&r.dispatchCommand(BT)},[r]),g=b.useCallback(()=>{r&&r.dispatchCommand(UT)},[r]),h=b.useCallback(()=>{r&&r.dispatchCommand($T)},[r]),p=b.useCallback(()=>{!r||!t||(r.update(()=>{const x=wt();if(lt(x)){const w=`${e+1}_________`,S=_n(w);S.setStyle("background-color: #f0f9ff; border: 1px dashed #3b82f6; padding: 2px 4px; border-radius: 4px; font-family: monospace;"),x.insertNodes([S])}}),t())},[r,t,e]);return c.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),c.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),c.jsx("button",{type:"button",onClick:a,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),c.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:()=>o("h1"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),c.jsx("button",{type:"button",onClick:()=>o("h2"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),c.jsx("button",{type:"button",onClick:()=>o("h3"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),c.jsx("button",{type:"button",onClick:l,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"}),c.jsx("button",{type:"button",onClick:u,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Quote",children:'"'})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:d,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:""}),c.jsx("button",{type:"button",onClick:g,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1."}),c.jsx("button",{type:"button",onClick:h,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:""})]}),t&&c.jsx("div",{className:"flex items-center gap-1 border-l border-gray-300 pl-2",children:c.jsxs("button",{type:"button",onClick:p,className:"px-3 py-1 text-sm font-medium bg-blue-500 text-white border border-blue-600 rounded hover:bg-blue-600 transition-colors",title:"Add Blank",children:[c.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",className:"inline mr-1",children:c.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Blank"]})})]})},nre=({value:t,onChange:e,placeholder:r,onAddBlank:n,blankCount:s=0})=>{const a={namespace:"FillBlanksLexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[km,Oc,Cl,bm,gd,Rv,Cm,Ch,Th,Eh,Bc],onError:i=>{console.error("Lexical error:",i)},editorState:t?(()=>{try{const i=JSON.parse(t);return JSON.stringify(i)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:t,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return c.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:c.jsxs(RR,{initialConfig:a,children:[c.jsx(rre,{onAddBlank:n,blankCount:s}),c.jsx(tre,{onChange:e}),c.jsxs("div",{className:"relative",children:[c.jsx(qR,{contentEditable:c.jsx(eM,{className:"p-4 min-h-32 focus:outline-none"}),placeholder:c.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:nM}),c.jsx(tM,{}),c.jsx(rM,{}),c.jsx(wM,{}),c.jsx(vM,{transformers:Mv})]})]})})},sre=({testName:t="",allowedTime:e=null,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const{user:o}=xn();Ji();const{showNotification:l}=Ys(),[u,d]=b.useState({test_name:t,test_text:"",num_questions:1,num_blanks:0,passing_score:100,separate_type:!0,allowed_time:e,blanks:[]}),[g,h]=b.useState({isLoading:!1,error:null,showPreview:!0});b.useEffect(()=>{d(E=>({...E,test_name:t||"",allowed_time:e}))},[t,e]);const p=E=>{d(A=>({...A,test_text:E}))},x=()=>{const A={id:u.blanks.length+1,position:0,question:"",options:["","","",""],correct_answer:""};d(C=>({...C,blanks:[...C.blanks,A],num_blanks:C.num_blanks+1}))},v=E=>{d(A=>({...A,blanks:A.blanks.filter(C=>C.id!==E),num_blanks:A.num_blanks-1}))},w=E=>{d(A=>({...A,blanks:A.blanks.map(C=>C.id===E?{...C,options:[...C.options,""]}:C)}))},S=(E,A)=>{d(C=>({...C,blanks:C.blanks.map(F=>F.id===E?{...F,options:F.options.filter((D,R)=>R!==A),correct_answer:F.correct_answer===String.fromCharCode(65+A)?"":F.correct_answer}:F)}))},_=(E,A,C)=>{d(F=>({...F,blanks:F.blanks.map(D=>D.id===E?{...D,options:D.options.map((R,M)=>M===A?C:R)}:D)}))},y=(E,A)=>{console.log(" [DEBUG] updateBlankQuestion called:",{blankId:E,question:A}),d(C=>({...C,blanks:C.blanks.map(F=>F.id===E?{...F,question:A}:F)})),console.log(" [DEBUG] updateBlankQuestion completed")},k=(E,A)=>{d(C=>({...C,blanks:C.blanks.map(F=>F.id===E?{...F,correct_answer:A}:F)}))},N=async()=>{if(!u.test_name.trim()){h(E=>({...E,error:"Test name is required"}));return}if(!u.test_text.trim()){h(E=>({...E,error:"Test text is required"}));return}if(u.blanks.length===0){h(E=>({...E,error:"At least one blank is required"}));return}if(console.log(" [DEBUG] Validating blanks:",u.blanks),u.blanks.forEach((E,A)=>{var C;console.log(` [DEBUG] Blank ${A+1}:`,{question:E.question,questionTrimmed:(C=E.question)==null?void 0:C.trim(),correct_answer:E.correct_answer,options:E.options})}),u.separate_type===!1){if(u.blanks.some(E=>!E.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing correct answer"),h(E=>({...E,error:"All blanks must have correct answers"}));return}}else if(u.blanks.some(E=>!E.question.trim()||!E.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing question or correct answer"),h(E=>({...E,error:"All blanks must have question text and correct answer"}));return}console.log(" [DEBUG] Validation passed - all blanks have question and correct answer"),h(E=>({...E,isLoading:!0,error:null}));try{const E={test_name:u.test_name,test_text:u.test_text,num_questions:u.blanks.length,num_blanks:u.blanks.length,separate_type:u.separate_type,passing_score:u.passing_score,allowed_time:u.allowed_time,blanks:u.blanks.map((A,C)=>({question_id:C+1,question_json:A.question,question:A.question,options:A.options,correct_answer:A.correct_answer,blank_positions:{},blank_options:A.options||[],correct_answers:[A.correct_answer]}))};console.log(" [DEBUG] Calling onTestSaved with data:",E),r?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),r(E),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(E){console.error("Error preparing fill blanks test:",E),h(A=>({...A,error:"Failed to prepare fill blanks test. Please try again."})),l("Failed to prepare fill blanks test","error")}finally{h(E=>({...E,isLoading:!1}))}};return c.jsx("div",{className:"fill-blanks-test-creator max-w-4xl mx-auto p-6",children:c.jsxs(st,{className:"p-6",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Fill Blanks Test"}),c.jsx("p",{className:"text-gray-600",children:"Create a test with rich text content and multiple choice blanks"}),c.jsx("div",{className:"mt-2 text-sm text-gray-600",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("span",{children:[c.jsx("strong",{children:"Test Name:"})," ",t||"Untitled Test"]}),c.jsxs("span",{children:[c.jsx("strong",{children:"Blanks:"})," ",u.num_blanks," (auto-calculated)"]}),c.jsxs("span",{children:[c.jsx("strong",{children:"Timer:"})," ",u.allowed_time?`${u.allowed_time} minutes`:"No timer"]})]})}),g.error&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-red-600 text-sm",children:g.error})})]}),c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Text Content with Blanks"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Type your text and add blanks where needed"})]}),c.jsx("div",{className:"flex items-center space-x-4",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Mode:"}),c.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[c.jsx("button",{onClick:()=>d(E=>({...E,separate_type:!0})),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors ${u.separate_type===!0?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Separate"}),c.jsx("button",{onClick:()=>d(E=>({...E,separate_type:!1})),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors ${u.separate_type===!1?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Inline"})]})]})})]}),c.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:c.jsxs("p",{className:"text-sm text-blue-800",children:[c.jsx("strong",{children:u.separate_type===!0?"Separate Mode:":"Inline Mode:"})," ",u.separate_type===!0?"Students see numbered blanks in text and answer questions below":"Students see clickable blanks in text with dropdown options"]})}),c.jsx(nre,{value:u.test_text,onChange:p,placeholder:"Type your text here. Use the 'Add Blank' button in the toolbar to insert blanks.",onAddBlank:x,blankCount:u.blanks.length})]}),u.separate_type===!0&&c.jsx("div",{className:"space-y-4",children:u.blanks.map((E,A)=>c.jsxs(st,{className:"p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-md font-medium",children:["Blank ",E.id," Configuration"]}),c.jsx(He,{variant:"danger",size:"small",onClick:()=>v(E.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Question Text for Blank ",E.id," *"]}),c.jsx("input",{type:"text",placeholder:"Enter question text for this blank",value:E.question,onChange:C=>y(E.id,C.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),E.options.map((C,F)=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+F)}),c.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+F)}`,value:C||"",onChange:D=>_(E.id,F,D.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),E.options.length>2&&c.jsx(He,{variant:"danger",size:"small",onClick:()=>S(E.id,F),className:"px-2 py-1 text-sm",children:""})]},F)),E.options.length<6&&c.jsx(He,{variant:"secondary",size:"small",onClick:()=>w(E.id),className:"w-full",children:"+ Add Option"})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),c.jsxs("select",{value:E.correct_answer||"",onChange:C=>k(E.id,C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[c.jsx("option",{value:"",children:"Select correct answer"}),E.options.filter(C=>C.trim().length>0).map((C,F)=>c.jsxs("option",{value:String.fromCharCode(65+F),children:[String.fromCharCode(65+F),") ",C]},F))]})]})]},E.id))}),u.separate_type===!1&&c.jsx("div",{className:"space-y-4",children:u.blanks.map((E,A)=>c.jsxs(st,{className:"p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-md font-medium",children:["Blank ",E.id," Options"]}),c.jsx(He,{variant:"danger",size:"small",onClick:()=>v(E.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),E.options.map((C,F)=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+F)}),c.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+F)}`,value:C||"",onChange:D=>_(E.id,F,D.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),E.options.length>2&&c.jsx(He,{variant:"danger",size:"small",onClick:()=>S(E.id,F),className:"px-2 py-1 text-sm",children:""})]},F)),E.options.length<6&&c.jsx(He,{variant:"secondary",size:"small",onClick:()=>w(E.id),className:"w-full",children:"+ Add Option"})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),c.jsxs("select",{value:E.correct_answer||"",onChange:C=>k(E.id,C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[c.jsx("option",{value:"",children:"Select correct answer"}),E.options.filter(C=>C.trim().length>0).map((C,F)=>c.jsxs("option",{value:String.fromCharCode(65+F),children:[String.fromCharCode(65+F),") ",C]},F))]})]})]},E.id))}),c.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[c.jsx(He,{onClick:n,variant:"secondary",disabled:a,children:"Cancel"}),c.jsx(He,{onClick:N,variant:"primary",disabled:a||u.blanks.length===0,children:a?c.jsx(nr,{size:"sm"}):"Save Test"})]})]})})},_M=(t,e)=>{const[r,n]=b.useState(()=>{try{const i=window.localStorage.getItem(t);return i?JSON.parse(i):e}catch(i){return console.error(`Error reading localStorage key "${t}":`,i),e}}),s=b.useCallback(i=>{try{const o=i instanceof Function?i(r):i;n(o),window.localStorage.setItem(t,JSON.stringify(o))}catch(o){console.error(`Error setting localStorage key "${t}":`,o)}},[t,r]),a=b.useCallback(()=>{try{window.localStorage.removeItem(t),n(e)}catch(i){console.error(`Error removing localStorage key "${t}":`,i)}},[t,e]);return[r,s,a]},Lv=()=>{const t=b.useCallback((l,u=null)=>{try{const d=window.localStorage.getItem(l);return d?JSON.parse(d):u}catch(d){return console.error(`Error reading localStorage key "${l}":`,d),u}},[]),e=b.useCallback((l,u)=>{try{window.localStorage.setItem(l,JSON.stringify(u))}catch(d){console.error(`Error setting localStorage key "${l}":`,d)}},[]),r=b.useCallback(l=>{try{window.localStorage.removeItem(l)}catch(u){console.error(`Error removing localStorage key "${l}":`,u)}},[]),n=b.useCallback(()=>{if(confirm("Are you sure you want to clear all local storage? This cannot be undone."))try{window.localStorage.clear(),window.showNotification?window.showNotification("All local storage cleared!","success"):console.log("All local storage cleared!")}catch(l){console.error("Error clearing localStorage:",l)}},[]),s=b.useCallback(()=>{try{const l={};for(let h=0;h<window.localStorage.length;h++){const p=window.localStorage.key(h);p&&(l[p]=window.localStorage.getItem(p))}const u=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),d=URL.createObjectURL(u),g=document.createElement("a");g.href=d,g.download="localStorage_backup.json",g.click(),URL.revokeObjectURL(d),window.showNotification?window.showNotification("Local storage exported!","success"):console.log("Local storage exported!")}catch(l){console.error("Error exporting localStorage data:",l)}},[]),a=b.useCallback(()=>{try{window.localStorage.clear()}catch(l){console.error("Error clearing localStorage:",l)}},[]),i=b.useCallback(()=>{try{const l={};for(let u=0;u<window.localStorage.length;u++){const d=window.localStorage.key(u);d&&(l[d]=window.localStorage.getItem(d))}return l}catch(l){return console.error("Error exporting localStorage data:",l),{}}},[]),o=b.useCallback(l=>{try{Object.entries(l).forEach(([u,d])=>{window.localStorage.setItem(u,d)})}catch(u){console.error("Error importing localStorage data:",u)}},[]);return{getItem:t,setItem:e,removeItem:r,clearAll:a,clearAllLocalStorage:n,exportLocalStorage:s,exportData:i,importData:o}},are=({question:t,testId:e,testType:r="true_false",mode:n="student",displayNumber:s,onAnswerChange:a,onQuestionChange:i,onSave:o,isEditing:l=!1,isSaving:u=!1,validationErrors:d={},showCorrectAnswers:g=!1,studentId:h=null})=>{const{getItem:p,setItem:x}=Lv();Ys(),b.useRef(null);const[v,w]=b.useState(""),[S,_]=b.useState(""),[y,k]=b.useState(""),[N,E]=b.useState(!1),[A,C]=b.useState(!0),[F,D]=b.useState(""),[R,M]=b.useState(!1),[B,J]=b.useState(null);b.useEffect(()=>{if(t&&(k(t.question||""),_(t.correct_answer||""),n==="student"&&h)){const q=p(`test_progress_${h}_${r}_${e}_${t.question_id}`);q&&w(q)}},[t,e,r,n,p]),b.useEffect(()=>{if(n==="student"&&v&&e&&(t!=null&&t.question_id)&&h){const q=setTimeout(()=>{M(!0),x(`test_progress_${h}_${r}_${e}_${t.question_id}`,v),J(new Date().toLocaleTimeString()),setTimeout(()=>M(!1),1e3)},1e3);return()=>clearTimeout(q)}},[v,e,r,t==null?void 0:t.question_id,n,h,x]),b.useEffect(()=>{if(n==="teacher"&&(y||S)){const q=setTimeout(()=>{M(!0);const se={question:y,correct_answer:S,timestamp:Date.now()};x(`teacher_form_${r}_${e}`,se),J(new Date().toLocaleTimeString()),setTimeout(()=>M(!1),1e3)},2e3);return()=>clearTimeout(q)}},[y,S,e,r,n,x]);const X=b.useCallback(q=>{n==="student"&&(w(q),a&&a(t.question_id,q),U(q))},[n,t==null?void 0:t.question_id,a]),z=b.useCallback(q=>{k(q),i&&i(t.question_id,q),L(q)},[t==null?void 0:t.question_id,i]),H=b.useCallback(q=>{_(q),i&&i(t.question_id,{...t,correct_answer:q}),ne(q)},[t,i]),U=b.useCallback(q=>{if(n==="student"){if(!q){C(!1),D("Please select an answer");return}C(!0),D("")}},[n]),L=b.useCallback(q=>{if(n==="teacher"){if(!q||q.trim().length<10){C(!1),D("Question must be at least 10 characters long");return}C(!0),D("")}},[n]),ne=b.useCallback(q=>{if(n==="teacher"){if(!q){C(!1),D("Please select a correct answer");return}C(!0),D("")}},[n]),de=b.useCallback(()=>{if(n!=="teacher"||!o)return;const q={question_id:t.question_id,question:y,correct_answer:S,type:"true_false"};o(q)},[n,o,t==null?void 0:t.question_id,y,S]),G=b.useCallback(q=>q?q.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]),K=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:t==null?void 0:t.question_id]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[R&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(nr,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),B&&!R&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",B]})]})]}),c.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:G(y)}}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${v==="true"?"border-blue-500 bg-blue-50":"border-gray-200"} ${g&&S==="true"?"ring-2 ring-green-400":""}`,children:[c.jsx("input",{type:"radio",name:`question_${t==null?void 0:t.question_id}`,value:"true",checked:v==="true",onChange:()=>X("true"),className:"sr-only","aria-label":"True"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${v==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:v==="true"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${v==="false"?"border-blue-500 bg-blue-50":"border-gray-200"} ${g&&S==="false"?"ring-2 ring-green-400":""}`,children:[c.jsx("input",{type:"radio",name:`question_${t==null?void 0:t.question_id}`,value:"false",checked:v==="false",onChange:()=>X("false"),className:"sr-only","aria-label":"False"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${v==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:v==="false"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]}),!A&&F&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:F})]}),Q=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",(t==null?void 0:t.question_id)||"New Question"]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[R&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(nr,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),B&&!R&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",B]})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:`question_${t==null?void 0:t.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),c.jsx("textarea",{id:`question_${t==null?void 0:t.question_id}`,value:y,onChange:q=>z(q.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Correct Answer *"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${S==="true"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[c.jsx("input",{type:"radio",name:`correct_${t==null?void 0:t.question_id}`,value:"true",checked:S==="true",onChange:()=>H("true"),className:"sr-only","aria-label":"True"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${S==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:S==="true"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${S==="false"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[c.jsx("input",{type:"radio",name:`correct_${t==null?void 0:t.question_id}`,value:"false",checked:S==="false",onChange:()=>H("false"),className:"sr-only","aria-label":"False"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${S==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:S==="false"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]})]})]}),!A&&F&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:F}),c.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:c.jsx(He,{variant:"success",onClick:de,disabled:!A||u,className:"w-full sm:w-auto",children:u?c.jsx(nr,{size:"small"}):"Save Question"})})]});return c.jsx("div",{className:"true-false-question-container",children:n==="student"?K():Q()})},ire=({question:t,testId:e,testType:r="multiple_choice",mode:n="student",onAnswerChange:s,onQuestionChange:a,onOptionAdd:i,onOptionRemove:o,onSave:l,isEditing:u=!1,isSaving:d=!1,validationErrors:g={},showCorrectAnswers:h=!1,studentId:p=null,displayNumber:x})=>{const{getItem:v,setItem:w}=Lv(),{showNotification:S}=Ys();b.useRef(null);const[_,y]=b.useState(""),[k,N]=b.useState(["","","",""]),[E,A]=b.useState(""),[C,F]=b.useState(""),[D,R]=b.useState(!1),[M,B]=b.useState(!0),[J,X]=b.useState(""),[z,H]=b.useState(!1),[U,L]=b.useState(null);b.useEffect(()=>{if(t&&(F(t.question||""),N(t.options||["","","",""]),A(t.correct_answer||""),n==="student"&&p)){const Ne=v(`test_progress_${p}_${r}_${e}_${t.question_id}`);Ne&&y(Ne)}},[t,e,r,n,v]),b.useEffect(()=>{if(n==="student"&&_&&e&&(t!=null&&t.question_id)&&p){const Ne=setTimeout(()=>{H(!0),w(`test_progress_${p}_${r}_${e}_${t.question_id}`,_),L(new Date().toLocaleTimeString()),setTimeout(()=>H(!1),1e3)},1e3);return()=>clearTimeout(Ne)}},[_,e,r,t==null?void 0:t.question_id,n,p,w]),b.useEffect(()=>{if(n==="teacher"&&(C||k.some(Ne=>Ne.trim()))){const Ne=setTimeout(()=>{H(!0);const Ce={question:C,options:k,correct_answer:E,timestamp:Date.now()};w(`teacher_form_${r}_${e}`,Ce),L(new Date().toLocaleTimeString()),setTimeout(()=>H(!1),1e3)},2e3);return()=>clearTimeout(Ne)}},[C,k,E,e,r,n,w]),b.useCallback(Ne=>{if(n!=="student")return;const Ce=String(Ne);y(Ce),s&&s(t.question_id,Ce),q(Ce)},[n,t==null?void 0:t.question_id,s]);const ne=b.useCallback(Ne=>{F(Ne),a&&a(t.question_id,Ne),se(Ne)},[t==null?void 0:t.question_id,a]),de=b.useCallback((Ne,Ce)=>{const We=[...k];We[Ne]=Ce,N(We),a&&a(t.question_id,{...t,options:We}),W(We)},[k,t,a]),G=b.useCallback(Ne=>{A(Ne),a&&a(t.question_id,{...t,correct_answer:Ne}),ee(Ne)},[t,a]),K=b.useCallback(()=>{if(k.length<6){const Ne=[...k,""];N(Ne),i&&i(t.question_id,Ne)}else S("Maximum 6 options allowed","warning")},[k,t==null?void 0:t.question_id,i,S]),Q=b.useCallback(Ne=>{if(k.length>2){const Ce=k.filter((We,nt)=>nt!==Ne);if(N(Ce),E===String.fromCharCode(65+Ne))A("");else if(E&&String.fromCharCode(65+Ne)<E){const We=String.fromCharCode(65+Ne-1);A(We)}o&&o(t.question_id,Ce)}else S("Minimum 2 options required","warning")},[k,E,t==null?void 0:t.question_id,o,S]),q=b.useCallback(Ne=>{if(n==="student"){if(!Ne){B(!1),X("Please select an answer");return}B(!0),t!=null&&t.correct_answer&&Ne===t.correct_answer?X(" Correct answer!"):t!=null&&t.correct_answer?X(" Incorrect answer"):X("Answer selected")}},[n,t==null?void 0:t.correct_answer]),se=b.useCallback(Ne=>!Ne||Ne.trim().length<10?(B(!1),X("Question must be at least 10 characters long"),!1):(B(!0),X(""),!0),[]),W=b.useCallback(Ne=>{if(n!=="teacher")return;if(Ne.filter(We=>We.trim().length>0).length<2){B(!1),X("At least 2 options must be filled");return}if(Ne.some(We=>We.trim().length>0&&We.trim().length<3)){B(!1),X("Each option must be at least 3 characters long");return}B(!0),X("")},[n]),ee=b.useCallback(Ne=>{if(n==="teacher"){if(!Ne){B(!1),X("Please select a correct answer");return}B(!0),X("")}},[n]),ve=b.useCallback(()=>{if(n!=="teacher"||!l)return;const Ne={question_id:t.question_id,question:C,options:k.filter(Ce=>Ce.trim().length>0),correct_answer:E,type:"multiple_choice"};l(Ne)},[n,l,t==null?void 0:t.question_id,C,k,E]),_e=b.useCallback(Ne=>Ne?Ne.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]);return n==="teacher"?c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",(t==null?void 0:t.question_id)||"New Question"]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[z&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(nr,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),U&&!z&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",U]})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:`question_${t==null?void 0:t.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),c.jsx("textarea",{id:`question_${t==null?void 0:t.question_id}`,value:C,onChange:Ne=>ne(Ne.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Answer Options *"}),c.jsx(He,{variant:"secondary",size:"small",onClick:K,disabled:k.length>=6,className:"px-3 py-1 text-sm",children:"+ Add Option"})]}),c.jsx("div",{className:"space-y-3",children:k.map((Ne,Ce)=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+Ce)}),c.jsx("input",{type:"text",value:Ne,onChange:We=>de(Ce,We.target.value),placeholder:`Option ${String.fromCharCode(65+Ce)}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0}),k.length>2&&c.jsx(He,{variant:"danger",size:"small",onClick:()=>Q(Ce),className:"px-2 py-1 text-sm",children:""})]},Ce))})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:`correct_${t==null?void 0:t.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),c.jsxs("select",{id:`correct_${t==null?void 0:t.question_id}`,value:E,onChange:Ne=>G(Ne.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0,children:[c.jsx("option",{value:"",children:"Select correct answer"}),k.map((Ne,Ce)=>{if(!Ne.trim())return null;const We=String.fromCharCode(65+Ce);return c.jsxs("option",{value:We,children:[We,") ",Ne]},Ce)})]})]})]}),!M&&J&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:J}),c.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:c.jsx(He,{variant:"success",onClick:ve,disabled:!M||d,className:"w-full sm:w-auto",children:d?c.jsx(nr,{size:"small"}):"Save Question"})})]}):c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof x=="number"?x:t==null?void 0:t.question_id]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[z&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(nr,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),U&&!z&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",U]})]})]}),c.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:_e(C)}}),c.jsx("div",{className:"space-y-3",children:k.map((Ne,Ce)=>c.jsxs("label",{className:`flex items-center p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ${_===String.fromCharCode(65+Ce)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[c.jsx("input",{type:"radio",name:`mcq_${e}_${t==null?void 0:t.question_id}`,value:String.fromCharCode(65+Ce),checked:_===String.fromCharCode(65+Ce),onChange:We=>{y(We.target.value),s&&s(t==null?void 0:t.question_id,We.target.value)},className:"mr-3"}),c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600 mr-3",children:String.fromCharCode(65+Ce)}),c.jsx("span",{className:"flex-1",children:Ne||`Option ${String.fromCharCode(65+Ce)}`})]},Ce))}),!M&&J&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:J})]})},ore=({question:t,testId:e,testType:r="input",mode:n="student",displayNumber:s,onAnswerChange:a,onQuestionChange:i,onAnswerAdd:o,onAnswerRemove:l,onSave:u,isEditing:d=!1,isSaving:g=!1,validationErrors:h={},showCorrectAnswers:p=!1,studentId:x=null})=>{const{getItem:v,setItem:w}=Lv(),{showNotification:S}=Ys(),_=b.useRef(null),[y,k]=b.useState(""),[N,E]=b.useState([""]),[A,C]=b.useState(!1),[F,D]=b.useState(!0),[R,M]=b.useState(""),[B,J]=b.useState(!1);b.useEffect(()=>{if(n==="student"&&(t!=null&&t.question_id)&&e&&r&&x){const se=`test_progress_${x}_${r}_${e}_${t.question_id}`,W=v(se);W&&k(W)}},[t==null?void 0:t.question_id,r,e,n,x,v]),b.useEffect(()=>{n==="teacher"&&(t!=null&&t.answers)&&E(t.answers.length>0?t.answers:[""])},[t==null?void 0:t.answers,n]),b.useEffect(()=>{if(n==="student"&&y&&(t!=null&&t.question_id)&&e&&r&&x){const se=setTimeout(()=>{J(!0),w(`test_progress_${x}_${r}_${e}_${t.question_id}`,y),setTimeout(()=>J(!1),1e3)},1e3);return()=>clearTimeout(se)}},[y,t==null?void 0:t.question_id,r,e,n,x,w]),b.useEffect(()=>{if(n==="teacher"&&N&&i){const se=setTimeout(()=>{i({...t,answers:N.filter(W=>W.trim())})},500);return()=>clearTimeout(se)}},[N,t,n,i]);const X=b.useCallback(se=>{k(se);const W=se.trim().length>0;D(W),M(W?"":"Please enter an answer"),a&&a(t.question_id,se)},[t==null?void 0:t.question_id,a]),z=b.useCallback((se,W)=>{const ee=[...N];ee[se]=W,E(ee),a&&a(t.question_id,ee)},[N,t==null?void 0:t.question_id,a]),H=b.useCallback(()=>{if(n==="teacher"){const se=[...N,""];E(se),o&&o(t.question_id,se)}},[N,t==null?void 0:t.question_id,n,o]),U=b.useCallback(se=>{if(n==="teacher"&&N.length>1){const W=N.filter((ee,ve)=>ve!==se);E(W),l&&l(t.question_id,W)}},[N,t==null?void 0:t.question_id,n,l]),L=b.useCallback(()=>{if(n==="student"){const se=y.trim().length>0;return D(se),M(se?"":"Please enter an answer"),se}else if(n==="teacher"){const se=N.some(W=>W.trim().length>0);return D(se),M(se?"":"Please enter at least one correct answer"),se}return!0},[y,N,n]),ne=b.useCallback(se=>se?se.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>"):"",[]),de=b.useCallback(()=>{C(!0)},[]),G=b.useCallback(()=>{C(!1),L()},[L]),K=b.useCallback(se=>{se.key==="Enter"&&n==="student"&&y.trim()&&(w(`test_progress_${r}_${e}_${t.question_id}`,y),S("Answer saved","success"))},[y,r,e,t==null?void 0:t.question_id,n,w,S]),Q=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:t.question_id]}),B&&c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[c.jsx(nr,{size:"small"}),c.jsx("span",{children:"Saving..."})]})]}),c.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:ne(t.question)}}),c.jsx("div",{className:"space-y-3",children:c.jsx("input",{ref:_,type:"text",id:`input_${t.question_id}`,placeholder:"Enter your answer here...",value:y,onChange:se=>X(se.target.value),onFocus:de,onBlur:G,onKeyPress:K,className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${F?A?"border-blue-500":"border-gray-300 hover:border-gray-400":"border-red-300 focus:border-red-500 focus:ring-red-500"}`,"data-question-id":t.question_id,"aria-label":`Answer for question ${t.question_id}`,"aria-invalid":!F,"aria-describedby":F?void 0:`error-${t.question_id}`})}),p&&t.correct_answers&&c.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[c.jsx("h5",{className:"text-sm font-semibold text-green-800 mb-2",children:"Correct Answers:"}),c.jsx("ul",{className:"space-y-1",children:t.correct_answers.map((se,W)=>c.jsxs("li",{className:"text-green-700 text-sm",children:[" ",se]},W))})]})]}),q=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",t.question_id||"New"]}),g&&c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[c.jsx(nr,{size:"small"}),c.jsx("span",{children:"Saving..."})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:`question_${t.question_id||"new"}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),c.jsx("input",{type:"text",id:`question_${t.question_id||"new"}`,value:t.question||"",onChange:se=>i&&i({...t,question:se.target.value}),placeholder:"Enter question text",className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${h.question?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 hover:border-gray-400 focus:border-blue-500"}`}),h.question&&c.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:h.question})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Correct Answers *"}),c.jsx(He,{type:"button",variant:"secondary",size:"small",onClick:H,className:"px-3 py-1 text-sm",children:"+ Add Answer"})]}),c.jsx("div",{className:"space-y-3",children:N.map((se,W)=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:W+1}),c.jsx("input",{type:"text",value:se,onChange:ee=>z(W,ee.target.value),placeholder:`Correct answer ${W+1}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200","data-question-id":t.question_id,"data-answer-index":W}),N.length>1&&c.jsx(He,{type:"button",variant:"danger",size:"small",onClick:()=>U(W),className:"px-2 py-1 text-sm",children:" Remove"})]},W))}),h.answers&&c.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:h.answers})]})]}),u&&c.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:c.jsx(He,{type:"button",variant:"success",onClick:u,disabled:g,className:"w-full sm:w-auto",children:g?c.jsx(nr,{size:"small"}):"Save Question"})})]});return c.jsx("div",{className:`input-question-container ${n} ${A?"focused":""}`,children:n==="student"?Q():q()})},vo=({isOpen:t=!1,onClose:e,title:r="",children:n,size:s="medium",showCloseButton:a=!0,closeOnBackdropClick:i=!0,className:o="",...l})=>{if(!t)return null;const u=g=>{i&&g.target===g.currentTarget&&e()};Wn.useEffect(()=>{const g=h=>{h.key==="Escape"&&e()};return t&&(document.addEventListener("keydown",g),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",g),document.body.style.overflow="unset"}},[t,e]);const d={small:"max-w-sm",medium:"max-w-md",large:"max-w-2xl"};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:u,role:"dialog","aria-modal":"true","aria-label":r,...l,children:c.jsxs("div",{className:`
          bg-white rounded-xl shadow-md border border-gray-200 p-6
          hover:shadow-lg hover:-translate-y-1 transition-all duration-200
          w-full ${d[s]} mx-auto
          ${o}
        `,onClick:g=>g.stopPropagation(),children:[(r||a)&&c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r&&c.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:r}),a&&c.jsx(He,{variant:"secondary",size:"small",onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200","aria-label":"Close modal",children:""})]}),c.jsx("div",{className:"space-y-6",children:n})]})})},Em=(t,e,r)=>{const[n,s]=b.useState(!1),[a,i]=b.useState(0),[o,l]=b.useState(!1),u=b.useRef(!1);b.useEffect(()=>{if(!t||!e||!r)return;const w=`anti_cheating_${r}_${t}_${e}`,S=nn(w);S&&(i(S.tabSwitches||0),l(S.isCheating||!1))},[t,e,r]);const d=b.useCallback(()=>{if(console.log(" handleTabSwitch called - isTracking:",u.current),!u.current){console.log(" Not tracking, returning early");return}console.log(" Tab switch detected - starting 7 second timer...");const w=Date.now();setTimeout(()=>{const S=Date.now()-w;console.log(" Timer completed - time hidden:",S,"ms"),S>=6500?(console.log(" Tab was hidden for sufficient time - counting as tab switch"),i(_=>{const y=_+1,k=y>=2;console.log(" Tab switch count updated:",{newCount:y,cheating:k}),l(k);const N=`anti_cheating_${r}_${t}_${e}`;return zr(N,{tabSwitches:y,isCheating:k},2*60*1e3),y})):console.log(" Tab was not hidden long enough - not counting as switch")},7e3)},[t,e,r]),g=b.useCallback(()=>{u.current&&(console.log(" Visibility change detected:",{hidden:document.hidden,isTracking:u.current}),document.hidden?d():console.log(" Tab became visible"))},[d]),h=b.useCallback(()=>{console.log(" startTracking called - setting up anti-cheating detection"),console.log(" Current document.hidden state:",document.hidden),console.log(" Current document.visibilityState:",document.visibilityState),s(!0),u.current=!0,document.addEventListener("visibilitychange",g),console.log(" Anti-cheating event listeners added (visibilitychange only)")},[g]),p=b.useCallback(()=>{console.log(" stopTracking called - removing anti-cheating detection"),s(!1),u.current=!1,document.removeEventListener("visibilitychange",g),console.log(" Anti-cheating event listeners removed")},[g]),x=b.useCallback(()=>{const w={caught_cheating:o,visibility_change_times:a};return console.log(" getCheatingData called:",w),w},[o,a]),v=b.useCallback(()=>{r&&t&&e&&oh(r,t,e),i(0),l(!1),console.log(" Anti-cheating data deleted from localStorage")},[r,t,e]);return{startTracking:h,stopTracking:p,clearData:v,getCheatingData:x,tabSwitches:a,isCheating:o,isTracking:n}},lre=({testData:t,onTestComplete:e,onBackToCabinet:r,isTestComplete:n=!1,testScore:s=null})=>{const[a,i]=b.useState(null),[o,l]=b.useState(null);b.useEffect(()=>{(async()=>{try{const[Ae,Me]=await Promise.all([bu(()=>Promise.resolve().then(()=>sq),void 0),bu(()=>Promise.resolve().then(()=>$J),void 0)]);i(Ae),l(Me.default)}catch(Ae){console.error("Failed to load Konva:",Ae)}})()},[]);const u=()=>a?{Stage:a.Stage,Layer:a.Layer,Rect:a.Rect,Arrow:a.Arrow,KonvaImage:a.Image,KonvaText:a.Text,Group:a.Group}:null,[d,g]=b.useState({}),[h,p]=b.useState({}),[x,v]=b.useState(0),[w,S]=b.useState(!1),[_,y]=b.useState(null),[k,N]=b.useState(0),[E,A]=b.useState(0),[C,F]=b.useState(null),[D,R]=b.useState(null),[M,B]=b.useState(!1),[J,X]=b.useState(!1),{showNotification:z}=Ys(),{makeAuthenticatedRequest:H}=Ji(),{user:U}=xn(),{startTracking:L,stopTracking:ne,getCheatingData:de,clearData:G}=Em("matching_type",t==null?void 0:t.id,(U==null?void 0:U.student_id)||(U==null?void 0:U.id)),K=b.useRef(null),Q=b.useRef(null),q=b.useRef(null),se=b.useRef(0),[W,ee]=b.useState(400);b.useRef({});const ve=b.useCallback(()=>{B(!0)},[]),_e=b.useCallback(()=>{p({}),g({}),B(!1)},[]),Le=b.useCallback(()=>{X(!0)},[]),te=b.useCallback(()=>{X(!1),r()},[r]),Ne=b.useMemo(()=>{if(!t)return null;const Se=t.blocks.map(Ie=>{let Ge=Ie.coordinates;if(typeof Ge=="string")try{Ge=JSON.parse(Ge)}catch(tt){console.error(" Failed to parse coordinates:",tt),Ge={x:0,y:0,width:100,height:100}}return Ge={x:(typeof Ge.x=="number"?Ge.x:Number(Ge.x))||0,y:(typeof Ge.y=="number"?Ge.y:Number(Ge.y))||0,width:(typeof Ge.width=="number"?Ge.width:Number(Ge.width))||30,height:(typeof Ge.height=="number"?Ge.height:Number(Ge.height))||10},{id:Ie.id,word:Ie.word,coordinates:Ge,hasArrow:Ie.hasArrow,arrow:Ie.arrow}}),Ae=Array.isArray(t.arrows)?t.arrows:[],Me=t.words.map(Ie=>({id:Ie.id,word:Ie.word,blockId:null,isPlaced:!1,isCorrect:!1}));return{blocks:Se,arrows:Ae,words:Me}},[t]);b.useEffect(()=>{if(!(t!=null&&t.image_url))return;const Se=new Image;Se.crossOrigin="anonymous",Se.onload=()=>{var it,ht,Ct;console.log(" Image loaded successfully"),N(Se.width),A(Se.height);const Ae=((it=K.current)==null?void 0:it.clientWidth)||800,Me=((ht=K.current)==null?void 0:ht.clientHeight)||600,Ie=Ae/Se.width,Ge=Me/Se.height,tt=Math.min(Ie,Ge,1),kt=Se.width*tt,zt=Se.height*tt,bt=(Ae-kt)/2,Dt=(Me-zt)/2;y({x:bt,y:Dt,width:kt,height:zt,scaleX:tt,scaleY:tt,scale:tt,image:Se}),se.current=((Ct=K.current)==null?void 0:Ct.clientWidth)||800,console.log(" Image info calculated:",{x:bt,y:Dt,width:kt,height:zt,scaleX:tt,scaleY:tt})},Se.onerror=()=>{console.error(" Failed to load image"),z("Failed to load test image","error")},Se.src=t.image_url},[t==null?void 0:t.image_url,z]),b.useEffect(()=>{var Dt;if(!Ne||!_)return;const Se=se.current||((Dt=K.current)==null?void 0:Dt.clientWidth)||800,Ae=12,Me=38;let Ie=_.x,Ge=_.y+_.height+Ae;const tt=_.x+_.width,kt={};Ne.words.forEach(it=>{if(!Object.prototype.hasOwnProperty.call(h,it.id)){const ht=typeof it.word=="string"?it.word:"",Ct=Math.max(60,ht.length*8+20);Ie+Ct>Math.min(Se-Ae,tt)&&(Ie=_.x,Ge+=Me),d[it.id]||(kt[it.id]={x:Ie,y:Ge}),Ie+=Ct+Ae}}),Object.keys(kt).length&&g(it=>({...it,...kt}));const zt=Object.values(kt).reduce((it,ht)=>Math.max(it,ht.y),Ge),bt=Math.max(_.y+_.height+Ae,zt+Me+Ae);ee(Math.max(400,Math.ceil(bt)))},[Ne,_,h,d]);const Ce=b.useCallback(()=>{if(!_||!Ne)return[];const Se=u();return Se?Ne.blocks.map(Ae=>{var bt;const Me=Ae.coordinates;let Ie,Ge,tt,kt;Ie=_.x+Me.x*(_.scale??_.scaleX),Ge=_.y+Me.y*(_.scale??_.scaleY),tt=Me.width*(_.scale??_.scaleX),kt=Me.height*(_.scale??_.scaleY);const zt=h[Ae.id];return c.jsxs(Se.Group,{children:[c.jsx(Se.Rect,{x:Ie,y:Ge,width:tt,height:kt,fill:zt?"rgba(40, 167, 69, 0.4)":C===Ae.id?"rgba(0, 123, 255, 0.25)":"rgba(0, 123, 255, 0.15)",stroke:zt?"#28a745":C===Ae.id?"#0056b3":"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:zt?"rgba(40, 167, 69, 0.3)":"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),zt&&c.jsx(Se.KonvaText,{x:Ie+5,y:Ge+kt/2-10,width:tt-10,height:20,text:((bt=Ne.words.find(Dt=>Dt.id===zt))==null?void 0:bt.word)||"",fontSize:Math.min(12,tt/8),fontFamily:"Arial",fill:"#2c3e50",align:"center",verticalAlign:"middle",listening:!1})]},Ae.id)}):[]},[_,Ne,h,a]),We=b.useCallback(()=>{if(!_||!Ne)return[];const Se=u();return Se?(console.log(" Processing arrows:",Ne.arrows),Ne.arrows.map(Ae=>{var kt,zt,bt;if(console.log(" Arrow data:",Ae),!Ae.start||!Ae.end)return console.warn(" Arrow missing start/end coordinates:",Ae),null;let Me,Ie,Ge,tt;if(Ae.rel_start_x!==null&&Ae.rel_start_y!==null&&Ae.rel_end_x!==null&&Ae.rel_end_y!==null&&Ae.image_width&&Ae.image_height&&Ae.image_width>0&&Ae.image_height>0){const Dt=Ae.image_width,it=Ae.image_height,ht=_.width/Dt,Ct=_.height/it;Me=_.x+Number(Ae.rel_start_x)/100*Dt*ht,Ie=_.y+Number(Ae.rel_start_y)/100*it*Ct,Ge=_.x+Number(Ae.rel_end_x)/100*Dt*ht,tt=_.y+Number(Ae.rel_end_y)/100*it*Ct}else{const Dt=_.scale??_.scaleX??1,it=Number(Ae.start.x),ht=Number(Ae.start.y),Ct=Number(Ae.end.x),jt=Number(Ae.end.y);it<=_.width+1&&Ct<=_.width+1&&ht<=_.height+1&&jt<=_.height+1?(Me=_.x+(isNaN(it)?0:it),Ie=_.y+(isNaN(ht)?0:ht),Ge=_.x+(isNaN(Ct)?0:Ct),tt=_.y+(isNaN(jt)?0:jt)):(Me=_.x+(isNaN(it)?0:it)*Dt,Ie=_.y+(isNaN(ht)?0:ht)*Dt,Ge=_.x+(isNaN(Ct)?0:Ct)*Dt,tt=_.y+(isNaN(jt)?0:jt)*Dt)}return c.jsx(Se.Arrow,{points:[Me,Ie,Ge,tt],stroke:((kt=Ae.style)==null?void 0:kt.color)||"#dc3545",fill:((zt=Ae.style)==null?void 0:zt.color)||"#dc3545",strokeWidth:((bt=Ae.style)==null?void 0:bt.thickness)||3,pointerLength:10,pointerWidth:10},Ae.id)}).filter(Boolean)):[]},[_,Ne,a]),nt=b.useCallback(()=>{if(!Ne)return[];const Se=u();return Se?Ne.words.map(Ae=>{const Me=d[Ae.id]||{x:0,y:0},Ie=typeof Ae.word=="string"?Ae.word:"",Ge=Math.max(60,Ie.length*8+20);return Object.values(h).includes(Ae.id)?null:c.jsxs(Se.Group,{x:Me.x,y:Me.y,draggable:!0,onDragEnd:kt=>$e(kt,Ae.id),children:[c.jsx(Se.Rect,{width:Ge,height:34,fill:"#ffffff",stroke:"#ced4da",strokeWidth:1,cornerRadius:4,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5,shadowOffset:{x:0,y:2},shadowOpacity:.3,listening:!0}),c.jsx(Se.KonvaText,{text:Ie,fontSize:14,fontFamily:"Arial",fill:"#343a40",padding:8,align:"center",verticalAlign:"middle",width:Ge,height:34,listening:!1})]},Ae.id)}):[]},[Ne,d,h,_,a]),$e=b.useCallback((Se,Ae)=>{const Me=Se.target.x(),Ie=Se.target.y();if(g(ht=>({...ht,[Ae]:{x:Me,y:Ie}})),!_||!Ne)return;const Ge=Ne.words.find(ht=>ht.id===Ae);if(!Ge)return;const tt=typeof Ge.word=="string"?Ge.word:"",kt=Math.max(60,tt.length*8+20),zt={x:Me,y:Ie,width:kt,height:34},bt=_.scale??_.scaleX??1,Dt=(ht,Ct)=>!(Ct.x>ht.x+ht.width||Ct.x+Ct.width<ht.x||Ct.y>ht.y+ht.height||Ct.y+Ct.height<ht.y),it=Ne.blocks.find(ht=>{const Ct=ht.coordinates,jt={x:_.x+Ct.x*bt,y:_.y+Ct.y*bt,width:Ct.width*bt,height:Ct.height*bt};return Dt(zt,jt)});if(it){p(Ze=>({...Ze,[it.id]:Ae}));const ht=it.coordinates,Ct=_.x+ht.x*bt,jt=_.y+ht.y*bt,Fe=ht.width*bt,et=ht.height*bt;g(Ze=>({...Ze,[Ae]:{x:Ct+(Fe-kt)/2,y:jt+(et-34)/2}})),z(`Word "${Ge.word}" placed in block`,"success")}},[_,Ne,z]),De=b.useCallback(()=>{if(!Ne)return 0;const Se=Ne.words.length,Ae=Object.keys(h).length;return Se>0?Ae/Se*100:0},[Ne,h]);b.useEffect(()=>{const Se=De();v(Se)},[De]),b.useEffect(()=>{if(t&&!D){const Se=new Date;R(Se),console.log(" Test timer started at:",Se.toISOString()),L(),console.log(" Anti-cheating tracking started")}},[t,D,L]);const at=b.useCallback(async()=>{if(Ne){S(!0);try{const Se=Ne.words.length;let Ae=0;console.log(" Scoring check - placedWords:",h),console.log(" Scoring check - blocks:",Ne.blocks.map(Fe=>({id:Fe.id,word:Fe.word}))),console.log(" Scoring check - words:",Ne.words.map(Fe=>({id:Fe.id,word:Fe.word}))),Ne.blocks.forEach(Fe=>{const et=h[Fe.id];if(console.log(` Block ${Fe.id} (expects "${Fe.word}") has placed word ID: ${et}`),et){const Ze=Ne.words.find(rt=>rt.id===et);console.log(" Placed word:",Ze),Ze&&Ze.word===Fe.word?(Ae++,console.log(` Correct! Block ${Fe.id} has correct word "${Ze.word}"`)):console.log(` Incorrect! Block ${Fe.id} expected "${Fe.word}" but got "${(Ze==null?void 0:Ze.word)||"nothing"}"`)}else console.log(` Block ${Fe.id} has no word placed`)});const Me=Ae,Ie=Se;console.log(` Final Score: ${Me}/${Ie} (${Math.round(Me/Ie*100)}%)`);const Ge=new Date,tt=D?Math.round((Ge-D)/1e3):0,kt=D?D.toISOString():Ge.toISOString();console.log(" Test timing:",{startedAt:kt,endTime:Ge.toISOString(),timeTaken:`${tt} seconds`});const zt=de();console.log(" Anti-cheating data for submission:",zt);const bt=U.student_id,Dt=`retest_assignment_id_${bt}_matching_type_${t.id}`,it=localStorage.getItem(Dt),ht={test_id:t.id,test_name:t.test_name,teacher_id:t.teacher_id||null,subject_id:t.subject_id||null,student_id:bt,answers:h,score:Me,maxScore:Ie,time_taken:tt,started_at:kt,submitted_at:Ge.toISOString(),caught_cheating:zt.caught_cheating,visibility_change_times:zt.visibility_change_times,retest_assignment_id:it?Number(it):null,parent_test_id:t.id};console.log(" Submitting test data:",ht);const jt=await(await H("/.netlify/functions/submit-matching-type-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ht)})).json();if(console.log(" Submission response:",jt),jt.success){if(z("Test submitted successfully!","success"),ne(),G(),U!=null&&U.student_id&&oh(U.student_id,"matching_type",t.id),U!=null&&U.student_id){const et=`test_completed_${U.student_id}_matching_type_${t.id}`;localStorage.setItem(et,"true"),console.log(" Test marked as completed in localStorage:",et)}if(U!=null&&U.student_id){const{setCachedData:et,CACHE_TTL:Ze}=await bu(async()=>{const{setCachedData:dt,CACHE_TTL:Tt}=await Promise.resolve().then(()=>YP);return{setCachedData:dt,CACHE_TTL:Tt}},void 0),rt=`student_results_table_${U.student_id}`;et(rt,jt,Ze.student_results_table),console.log(" Test results cached with key:",rt)}const Fe=`retest1_${bt}_matching_type_${t.id}`;localStorage.removeItem(Fe),localStorage.removeItem(Dt),e&&e(Me)}else throw new Error(jt.message||"Failed to submit test")}catch(Se){console.error(" Error submitting test:",Se),z(`Error submitting test: ${Se.message}`,"error")}finally{S(!1)}}},[Ne,h,t,U,D,H,z,e]);return!t||!Ne?c.jsx(nr,{}):c.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:c.jsxs("div",{className:"max-w-6xl mx-auto",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("div",{children:c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.test_name})}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-sm text-gray-500",children:"Progress"}),c.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(x),"%"]})]})]}),c.jsx("div",{className:"mt-4 w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${x}%`}})})]}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:c.jsx("div",{className:"lg:col-span-3",children:c.jsxs(st,{className:"p-4",children:[c.jsxs("div",{className:"mb-4 text-center space-x-4",children:[c.jsx(He,{onClick:ve,variant:"secondary",children:"Reset"}),c.jsx(He,{onClick:Le,variant:"secondary",children:"Back to Cabinet"})]}),c.jsx("div",{ref:K,className:"w-full bg-gray-100 rounded-lg overflow-hidden",style:{height:`${W}px`},children:_&&a?(()=>{var Ie;const{Stage:Se,Layer:Ae,KonvaImage:Me}=u();return c.jsxs(Se,{ref:Q,width:((Ie=K.current)==null?void 0:Ie.clientWidth)||800,height:W,children:[c.jsxs(Ae,{children:[c.jsx(Me,{ref:q,image:_.image,x:_.x,y:_.y,width:_.width,height:_.height,listening:!1}),Ce(),We()]}),c.jsx(Ae,{listening:!0,children:nt()})]})})():_?c.jsxs("div",{className:"flex items-center justify-center h-full",children:[c.jsx(nr,{size:"lg"}),c.jsx("span",{className:"ml-2 text-gray-600",children:"Loading Konva canvas..."})]}):null}),c.jsx("div",{className:"mt-4 text-center",children:c.jsx(He,{onClick:at,disabled:w||x<100,children:w?"Submitting...":"Submit Test"})})]})})}),c.jsx(vo,{isOpen:M,onClose:()=>B(!1),title:"Reset Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and placed words."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(He,{onClick:()=>B(!1),variant:"secondary",children:"Cancel"}),c.jsx(He,{onClick:_e,variant:"primary",children:"Reset"})]})]})}),c.jsx(vo,{isOpen:J,onClose:()=>X(!1),title:"Exit Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet? Your progress will be saved but you will exit the test."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(He,{onClick:()=>X(!1),variant:"secondary",children:"Cancel"}),c.jsx(He,{onClick:te,variant:"primary",children:"Go Back"})]})]})})]})})},cre=({testName:t="",onTestSaved:e,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=xn(),{makeAuthenticatedRequest:o}=Ji(),{showNotification:l}=Ys(),[u,d]=b.useState([{leftWord:"",rightWord:""},{leftWord:"",rightWord:""},{leftWord:"",rightWord:""}]),[g,h]=b.useState("drag"),[p,x]=b.useState(!1),[v,w]=b.useState(null),S=b.useCallback(()=>{d(A=>[...A,{leftWord:"",rightWord:""}])},[]),_=b.useCallback(A=>{u.length>1&&d(C=>C.filter((F,D)=>D!==A))},[u.length]),y=b.useCallback((A,C)=>{d(F=>F.map((D,R)=>R===A?{...D,leftWord:C}:D))},[]),k=b.useCallback((A,C)=>{d(F=>F.map((D,R)=>R===A?{...D,rightWord:C}:D))},[]),N=b.useCallback(()=>u.every(A=>A.leftWord.trim()&&A.rightWord.trim()),[u]),E=b.useCallback(async()=>{if(!N()){l("Please fill in all word pairs","error");return}x(!0),w(null);try{const A=u.map((F,D)=>({question_id:D+1,left_word:F.leftWord.trim(),right_word:F.rightWord.trim()})),C={test_name:t,num_questions:A.length,interaction_type:g,questions:A};console.log(" Saving word matching test:",C),e({testName:t,numQuestions:A.length,interactionType:g,wordPairs:u,questions:A})}catch(A){console.error("Error saving word matching test:",A),w(A.message),l("Failed to save test: "+A.message,"error")}finally{x(!1)}},[t,u,g,N,o,l,e]);return c.jsxs(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-6xl mx-auto p-6",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Word Matching Test"}),c.jsx("p",{className:"text-gray-600",children:"Enter word pairs - position 1 left matches position 1 right"})]}),c.jsx(st,{className:"mb-6",children:c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Choose Interaction Type"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${g==="drag"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>h("drag"),children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx("input",{type:"radio",checked:g==="drag",onChange:()=>h("drag"),className:"mr-3"}),c.jsx("h4",{className:"font-medium",children:"Drag & Drop"})]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Students drag words from left list to right list"}),c.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" Easier for younger students",c.jsx("br",{})," Visual feedback on placement",c.jsx("br",{})," Mobile-friendly"]})]}),c.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${g==="arrow"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>h("arrow"),children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx("input",{type:"radio",checked:g==="arrow",onChange:()=>h("arrow"),className:"mr-3"}),c.jsx("h4",{className:"font-medium",children:"Draw Arrows"})]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Students draw arrows connecting matching words"}),c.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" More challenging",c.jsx("br",{})," Better for visual learners",c.jsx("br",{})," Requires precision"]})]})]})]})}),c.jsx(st,{className:"mb-6",children:c.jsxs("div",{className:"word-pairs-section",children:[c.jsxs("div",{className:"pairs-header flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Word Pairs"}),c.jsx(He,{onClick:S,size:"sm",children:"+ Add Pair"})]}),c.jsx("div",{className:"pairs-list space-y-3",children:u.map((A,C)=>c.jsxs("div",{className:"word-pair-row flex items-center space-x-4 p-4 bg-gray-50 rounded-lg border",children:[c.jsx("div",{className:"pair-number flex-shrink-0",children:c.jsx("span",{className:"number-badge w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-semibold",children:C+1})}),c.jsx("div",{className:"left-word flex-1",children:c.jsx("input",{type:"text",value:A.leftWord,onChange:F=>y(C,F.target.value),placeholder:"Left word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),c.jsx("div",{className:"pair-arrow flex-shrink-0 text-gray-500 text-xl",children:""}),c.jsx("div",{className:"right-word flex-1",children:c.jsx("input",{type:"text",value:A.rightWord,onChange:F=>k(C,F.target.value),placeholder:"Right word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),c.jsx("div",{className:"pair-actions flex-shrink-0",children:c.jsx(He,{onClick:()=>_(C),variant:"outline",size:"sm",className:"remove-btn w-8 h-8 p-0 text-red-500 hover:bg-red-50",disabled:u.length<=1,children:""})})]},C))})]})}),c.jsx(st,{className:"mb-6",children:c.jsxs("div",{className:"preview-section",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Preview"}),c.jsx("div",{className:"preview-pairs space-y-2",children:u.map((A,C)=>c.jsxs("div",{className:"preview-pair flex items-center space-x-2 text-sm",children:[c.jsxs("span",{className:"preview-number font-semibold text-blue-600",children:[C+1,"."]}),c.jsx("span",{className:"preview-left px-2 py-1 bg-white rounded border",children:A.leftWord||"Left word"}),c.jsx("span",{className:"preview-arrow text-gray-500",children:""}),c.jsx("span",{className:"preview-right px-2 py-1 bg-white rounded border",children:A.rightWord||"Right word"})]},C))})]})}),c.jsxs("div",{className:"flex justify-center space-x-4",children:[c.jsx(He,{onClick:E,disabled:!N()||p,className:"px-8",children:p?c.jsxs(c.Fragment,{children:[c.jsx(nr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test"}),c.jsx(He,{onClick:r,variant:"secondary",children:"Cancel"})]}),v&&c.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-red-600",children:v})})]})},ure=(t,e)=>{const[r,n,s]=_M(`test_progress_${t}_${e}`,{}),[a,i]=b.useState(!1),[o,l]=b.useState(0),[u,d]=b.useState(0),[g,h]=b.useState(!1),[p,x]=b.useState(null),v=b.useRef(null),w=b.useRef(null),S=b.useCallback((L,ne)=>{if(!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}n(de=>({...de,[L]:ne})),console.log(`Saved progress for question ${L}:`,ne)},[n]),_=b.useCallback(L=>!window.tokenManager||!window.tokenManager.isAuthenticated()?(console.warn("[WARN] Cannot get progress: No valid JWT token"),null):r[L]||null,[r]),y=b.useCallback(()=>{if(console.log(`[DEBUG] clearTestProgress called with testType: ${t}, testId: ${e}`),!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const L=`test_progress_${t}_${e}`;console.log(`[DEBUG] Removing localStorage key: ${L}`);const ne=Object.keys(r).length>0;s(),console.log(ne?`[DEBUG] Progress cleared for test ${t}_${e}`:`[DEBUG] No progress found to clear for test ${t}_${e}`)},[s,t,e,r]),k=b.useCallback(()=>{v.current&&(k(v.current),v.current=null),w.current&&(k(w.current),w.current=null)},[]),N=b.useCallback(()=>{console.log(`[DEBUG] setupProgressTrackingForPage called with testType: ${t}, testId: ${e}`),w.current=setInterval(()=>{console.log("[DEBUG] Auto-saving progress..."),D()},3e4),console.log("[DEBUG] Progress tracking interval set up (30 seconds)")},[t,e]),E=b.useCallback(()=>{console.log(`[DEBUG] updateProgressDisplayForPage called with testType: ${t}, testId: ${e}`);const L=F(),ne=u>0?Math.round(L/u*100):0;return console.log(`[DEBUG] Progress: ${L}/${u} questions answered`),console.log(`[DEBUG] Progress bar updated: ${ne}%`),{answeredQuestions:L,totalQuestions:u,percentage:ne}},[t,e,u]),A=b.useCallback(()=>{console.log("[DEBUG] updateSubmitButtonStateForPage called");const L=F();console.log(`[DEBUG] Submit button state check: ${L}/${u} questions answered`);const ne=L===u&&u>0;return console.log(ne?"[DEBUG] Submit button enabled - all questions answered":"[DEBUG] Submit button disabled - not all questions answered"),ne},[u]),C=b.useCallback(()=>{console.log(`[DEBUG] loadSavedProgressForPage called with testType: ${t}, testId: ${e}`);try{if(console.log("[DEBUG] Loaded progress from localStorage:",r),Object.keys(r).length===0){console.log("[DEBUG] No saved progress found");return}const L=Object.keys(r).length;l(L),console.log(`[DEBUG] Restored ${L} answered questions`)}catch(L){console.error("[ERROR] Failed to load saved progress:",L),x(L.message)}},[t,e,r]),F=b.useCallback(()=>{console.log(`[DEBUG] getAnsweredQuestionsCountForPage called with testType: ${t}`);const L=Object.keys(r).length;return l(L),console.log(`[DEBUG] Found ${L} answered questions`),L},[t,r]),D=b.useCallback(()=>{console.log(`[DEBUG] saveProgressForPage called with testType: ${t}, testId: ${e}`);try{console.log("[DEBUG] Progress saved:",r)}catch(L){console.error("[ERROR] Failed to save progress:",L),x(L.message)}},[t,e,r]),R=b.useCallback(()=>{try{const L=`test_completed_${t}_${e}`,ne=localStorage.getItem(L)==="true";return i(ne),ne}catch(L){return console.error("Error checking test completion:",L),!1}},[t,e]),M=b.useCallback(()=>{try{const L=`test_completed_${t}_${e}`;localStorage.setItem(L,"true"),i(!0),console.log(`Test ${t}_${e} marked as completed`)}catch(L){console.error("Error marking test completed:",L)}},[t,e]),B=b.useCallback(()=>{console.log("Marking test completed in UI:",{testType:t,testId:e}),M()},[t,e,M]),J=b.useCallback(L=>{try{const ne=`test_creation_state_${t}_${e}`;localStorage.setItem(ne,JSON.stringify(L)),console.log("Test creation state saved:",L)}catch(ne){console.error("Error saving test creation state:",ne)}},[t,e]),X=b.useCallback(()=>{try{const L=`test_creation_state_${t}_${e}`;localStorage.removeItem(L),console.log("Test creation state cleared")}catch(L){console.error("Error clearing test creation state:",L)}},[t,e]),z=b.useCallback((L,ne)=>{try{const de=`test_step_${t}_${e}_${L}`;localStorage.setItem(de,JSON.stringify(ne)),console.log(`Step ${L} data saved:`,ne)}catch(de){console.error(`Error saving step ${L} data:`,de)}},[t,e]),H=b.useCallback(L=>{try{const ne=`test_step_${t}_${e}_${L}`,de=localStorage.getItem(ne);return de?JSON.parse(de):null}catch(ne){return console.error(`Error restoring step ${L} data:`,ne),null}},[t,e]),U=b.useCallback(()=>{try{const L=`test_creation_state_${t}_${e}`,ne=localStorage.getItem(L);return ne?JSON.parse(ne):null}catch(L){return console.error("Error restoring test creation state:",L),null}},[t,e]);return b.useEffect(()=>()=>{k()},[t,e,N,C,k]),b.useEffect(()=>{F()},[r,F]),{progress:r,isCompleted:a,answeredCount:o,totalQuestions:u,isLoading:g,error:p,saveProgress:S,getProgress:_,clearProgress:y,clearInterval:k,setupProgressTracking:N,updateProgress:E,updateSubmitButton:A,loadProgress:C,getAnsweredCount:F,saveProgressForPage:D,checkCompleted:R,markCompleted:M,markCompletedUI:B,saveState:J,clearState:X,saveStepData:z,restoreStepData:H,restoreState:U,setTotalQuestions:d,setError:x}},dre=({testData:t,onTestComplete:e,onBackToCabinet:r})=>{var Se,Ae;const{user:n}=xn(),{makeAuthenticatedRequest:s}=Ji(),[a,i]=b.useState({width:window.innerWidth,height:window.innerHeight});b.useEffect(()=>{const Me=()=>{i({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",Me),()=>window.removeEventListener("resize",Me)},[]);const{getCheatingData:o,stopTracking:l,clearData:u}=Em(),[d,g]=b.useState(null),[h,p]=b.useState({}),[x,v]=b.useState(null),w=b.useRef(null),[S,_]=b.useState(800),y={VERY_SMALL:400,MOBILE:600,TABLET:900},k={VERY_SMALL:.6,MOBILE:.8,TABLET:.9,DESKTOP:1},N={CANVAS_HEIGHT:400,BLOCK_WIDTH:140,BLOCK_HEIGHT:50,BLOCK_SPACING:100,MARGIN:50,PADDING:20},E=a.width<y.VERY_SMALL,A=a.width>=y.VERY_SMALL&&a.width<y.MOBILE,C=a.width>=y.MOBILE&&a.width<y.TABLET;a.width>=y.TABLET;const F=E?k.VERY_SMALL:A?k.MOBILE:C?k.TABLET:k.DESKTOP;b.useEffect(()=>{const Me=()=>{if(w.current){const Ge=w.current.clientWidth;console.log(" Container width detected:",Ge),Ge>0&&_(Ge)}};Me();const Ie=[setTimeout(Me,50),setTimeout(Me,100),setTimeout(Me,200),setTimeout(Me,500)];return window.addEventListener("resize",Me),()=>{Ie.forEach(Ge=>clearTimeout(Ge)),window.removeEventListener("resize",Me)}},[d]);const D=Math.max(N.CANVAS_HEIGHT*F,(((Se=d==null?void 0:d.leftWords)==null?void 0:Se.length)||3)*N.BLOCK_SPACING*F+N.PADDING*2),R=N.BLOCK_WIDTH*F,M=N.BLOCK_HEIGHT*F,B=N.BLOCK_SPACING*F,J=N.MARGIN*F,X=J;console.log(" Mobile Debug:",{screenWidth:a.width,containerWidth:(Ae=w.current)==null?void 0:Ae.clientWidth,canvasWidth:S,scale:F,blockWidth:R,margin:J,leftBlockX:X,displayDataLoaded:!!d});const z=X+R+20+R+J,H=z<=S;let U,L=R,ne=M;if(H)U=Math.min(Math.max(X+R+20,S-R-J),S-R-J);else{const Me=S-J*2,Ie=Math.floor((Me-20)/2);L=Math.max(60,Ie),ne=Math.max(30,ne*(L/R)),U=X+L+20,console.log(" Very small screen - adjusted block size:",{availableWidth:Me,maxBlockWidth:Ie,actualBlockWidth:L,actualBlockHeight:ne})}console.log(" Right Block Position:",{rightBlockX:U,rightBlockRightEdge:U+L,canvasWidth:S,fits:U+L<=S,canFitSideBySide:H,minRequiredWidth:z});const de=J,G={DRAGGED_WORD:Math.max(8,14*F),ORIGINAL_WORD:Math.max(10,16*F),LEFT_WORD:Math.max(10,14*F)},K=Math.max(1,3*F),[Q,q]=b.useState([]),[se,W]=b.useState(!1),[ee,ve]=b.useState(null),[_e,Le]=b.useState(!1),[te,Ne]=b.useState(!1);b.useEffect(()=>{if(t&&(g(t),ve(new Date),n!=null&&n.student_id)){const Me=`test_progress_${n.student_id}_word_matching_${t.id}`,Ie=nn(Me);Ie&&(p(Ie.answers||{}),q(Ie.arrows||[]),ve(new Date(Ie.startTime)),console.log(" Test progress restored:",Ie))}},[t,n==null?void 0:n.student_id]),b.useEffect(()=>{if(d&&ee&&(n!=null&&n.student_id)){const Me=setInterval(()=>{const Ie={answers:h,arrows:Q,startTime:ee.toISOString()},Ge=`test_progress_${n.student_id}_word_matching_${t.id}`;zr(Ge,Ie,Xr.test_progress),console.log(" Progress auto-saved")},3e4);return()=>clearInterval(Me)}},[d,h,Q,ee,n==null?void 0:n.student_id,t==null?void 0:t.id]);const Ce=b.useCallback((Me,Ie)=>{if(t.interaction_type==="arrow")if(x){if(x.side===Me&&x.index===Ie)v(null);else if(x.side!==Me){const Ge={id:Date.now().toString(),startWord:x,endWord:{side:Me,index:Ie},color:"#3B82F6"};q(tt=>[...tt,Ge]),p(tt=>({...tt,[x.index]:Ie})),v(null)}}else v({side:Me,index:Ie})},[x,t==null?void 0:t.interaction_type]);b.useCallback((Me,Ie)=>{t.interaction_type==="drag"&&p(Ge=>({...Ge,[Me]:Ie}))},[t==null?void 0:t.interaction_type]);const We=b.useCallback(()=>{Le(!0)},[]),nt=b.useCallback(()=>{p({}),q([]),v(null),Le(!1)},[]),$e=b.useCallback(()=>{Ne(!0)},[]),De=b.useCallback(()=>{Ne(!1),r&&r()},[r]),at=b.useCallback(async()=>{if(d){W(!0);try{const Me=d.leftWords.length;let Ie=0,Ge={};t.interaction_type==="drag"?Object.entries(h).forEach(([rt,dt])=>{const Tt=d.correctPairs[rt];dt===Tt&&Ie++,Ge[rt]=dt}):Q.forEach(rt=>{const dt=rt.startWord.side==="left"?rt.startWord.index:rt.endWord.index,Tt=rt.startWord.side==="right"?rt.startWord.index:rt.endWord.index;d.correctPairs[dt]===Tt&&Ie++,Ge[dt]=Tt});const tt=Ie,kt=Me;console.log(` Final Score: ${tt}/${kt} (${Math.round(tt/kt*100)}%)`);const zt=new Date,bt=ee?Math.round((zt-ee)/1e3):0,Dt=ee?ee.toISOString():zt.toISOString(),it=o(),ht=n.student_id,Ct=`retest_assignment_id_${ht}_word_matching_${t.id}`,jt=localStorage.getItem(Ct),Fe={test_id:t.id,test_name:t.test_name,teacher_id:t.teacher_id||null,subject_id:t.subject_id||null,student_id:ht,parent_test_id:t.id,retest_assignment_id:jt?Number(jt):null,interaction_type:t.interaction_type,answers:Ge,score:tt,maxScore:kt,time_taken:bt,started_at:Dt,submitted_at:zt.toISOString(),caught_cheating:it.caught_cheating,visibility_change_times:it.visibility_change_times};console.log(" Submission data being sent:",Fe),console.log(" TestData structure:",t),console.log(" Submitting test results...");const et=await s("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Fe)});console.log(" Submission response received:",et.status);const Ze=await et.json();if(Ze.success){if(l(),u(),n!=null&&n.student_id){const rt=`test_completed_${n.student_id}_word_matching_${t.id}`;localStorage.setItem(rt,"true"),console.log(" Test marked as completed in localStorage:",rt);const dt=`retest1_${ht}_word_matching_${t.id}`;localStorage.removeItem(dt),localStorage.removeItem(Ct),oh(n.student_id,"word_matching",t.id),console.log(" Test data cleared from cache");const Tt=`student_results_table_${n.student_id}`;zr(Tt,Ze,Xr.student_results_table),console.log(" Test results cached with key:",Tt)}setTimeout(()=>{e&&e(tt)},2e3)}else throw new Error(Ze.message||"Failed to submit test")}catch(Me){console.error("Error submitting test:",Me)}finally{W(!1)}}},[d,h,Q,t,n,ee,o,l,u,s,e]);return d?c.jsxs(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-4xl mx-auto p-6",children:[c.jsx(vo,{isOpen:se,onClose:()=>{},title:"Submitting",size:"small",children:c.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[c.jsx(nr,{size:"lg",className:"mb-3"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Submitting test..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your results"})]})}),c.jsx(st,{className:"mb-6",children:c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:t.test_name}),c.jsx("p",{className:"text-gray-600",children:t.interaction_type==="drag"?"Drag words from left to right to match them":"Click on the word or phrase on the left, then click on the matching word or phrase on the right to connect them"})]})}),t.interaction_type==="drag"?c.jsx(st,{className:"mb-6",children:c.jsx("div",{ref:w,className:"relative w-full",children:c.jsx(Lu,{width:S,height:D,className:`border-2 border-gray-200 rounded-lg ${se?"pointer-events-none opacity-50":""}`,children:c.jsxs(Mu,{children:[d.leftWords.map((Me,Ie)=>{const Ge=h[Ie]!==void 0,tt=de+Ie*B;return c.jsxs(tl,{x:X,y:tt,draggable:!Ge,onDragStart:kt=>{kt.target.moveToTop()},onDragEnd:kt=>{kt.target.getStage();const zt=d.rightWords,bt=L+60,Dt=ne+30,it=U-30,ht=de-15;console.log(" Drop detection - Word dropped at:",kt.target.x(),kt.target.y());for(let Ct=0;Ct<zt.length;Ct++){const jt=ht+Ct*B,Fe=it,et=it+bt,Ze=jt,rt=jt+Dt;if(console.log(` Checking drop zone ${Ct}:`,{left:Fe,right:et,top:Ze,bottom:rt,word:zt[Ct]}),kt.target.x()>=Fe&&kt.target.x()<=et&&kt.target.y()>=Ze&&kt.target.y()<=rt){console.log(` Match found! Word "${d.leftWords[Ie]}" matched with "${zt[Ct]}"`),p(dt=>({...dt,[Ie]:Ct}));break}}console.log(" No match found, resetting position"),kt.target.position({x:X,y:tt})},children:[c.jsx(sa,{width:L,height:ne,fill:Ge?"#e5e7eb":"#3b82f6",stroke:Ge?"#9ca3af":"#1d4ed8",strokeWidth:2,cornerRadius:8,opacity:Ge?.5:1}),c.jsx(iu,{text:Me,x:L/2,y:ne/2,fontSize:G.LEFT_WORD,fontFamily:"Arial",fill:Ge?"#dc2626":"white",align:"center",verticalAlign:"middle",width:L,offsetX:L/2,offsetY:ne/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${Ie}`)}),d.rightWords.map((Me,Ie)=>{const Ge=de+Ie*B,tt=Object.keys(h).find(kt=>h[kt]===Ie);return c.jsxs(tl,{x:U,y:Ge,children:[c.jsx(sa,{width:L,height:ne,fill:tt?"#10b981":"#f3f4f6",stroke:tt?"#059669":"#d1d5db",strokeWidth:2,cornerRadius:8}),c.jsx(iu,{text:Me,x:L/2,y:ne/2,fontSize:G.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:L,offsetX:L/2,offsetY:ne/2,wrap:"word",ellipsis:!0,listening:!1}),tt&&c.jsx(iu,{text:d.leftWords[tt],x:R/2,y:M/4,fontSize:G.DRAGGED_WORD,fontFamily:"Arial",fill:"#dc2626",align:"center",verticalAlign:"middle",width:L,offsetX:L/2,offsetY:ne/8,wrap:"word",ellipsis:!0})]},`right-${Ie}`)})]})})})}):c.jsx(st,{className:"mb-6",children:c.jsx("div",{ref:w,className:"relative w-full",children:c.jsx(Lu,{width:S,height:D,className:`border-2 border-gray-200 rounded-lg ${se?"pointer-events-none opacity-50":""}`,children:c.jsxs(Mu,{children:[d.leftWords.map((Me,Ie)=>{const Ge=de+Ie*B,tt=(x==null?void 0:x.side)==="left"&&(x==null?void 0:x.index)===Ie;return c.jsxs(tl,{x:X,y:Ge,onClick:()=>Ce("left",Ie),children:[c.jsx(sa,{width:L,height:ne,fill:tt?"#3b82f6":"#f3f4f6",stroke:tt?"#1d4ed8":"#d1d5db",strokeWidth:tt?3:2,cornerRadius:8}),c.jsx(iu,{text:Me,x:R/2,y:M/2,fontSize:G.LEFT_WORD,fontFamily:"Arial",fill:tt?"white":"#374151",align:"center",verticalAlign:"middle",width:L,offsetX:L/2,offsetY:ne/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${Ie}`)}),d.rightWords.map((Me,Ie)=>{const Ge=de+Ie*B,tt=(x==null?void 0:x.side)==="right"&&(x==null?void 0:x.index)===Ie;return c.jsxs(tl,{x:U,y:Ge,onClick:()=>Ce("right",Ie),children:[c.jsx(sa,{width:L,height:ne,fill:tt?"#3b82f6":"#f3f4f6",stroke:tt?"#1d4ed8":"#d1d5db",strokeWidth:tt?3:2,cornerRadius:8}),c.jsx(iu,{text:Me,x:R/2,y:M/2,fontSize:G.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:L,offsetX:L/2,offsetY:ne/2,wrap:"word",ellipsis:!0,listening:!1})]},`right-${Ie}`)}),Q.map((Me,Ie)=>{const Ge=de+Me.startWord.index*B+M/2,tt=de+Me.endWord.index*B+M/2;return c.jsx(hi,{points:[X+R+20,Ge,U-20,tt],stroke:Me.color||"#3b82f6",strokeWidth:K,lineCap:"round",lineJoin:"round"},Ie)})]})})})}),c.jsx(st,{children:c.jsxs("div",{className:`submit-section flex justify-center space-x-4 ${se?"pointer-events-none opacity-50":""}`,children:[c.jsx(He,{onClick:We,variant:"outline",disabled:se,children:"Reset"}),c.jsx(He,{onClick:$e,variant:"outline",disabled:se,children:"Back to Cabinet"}),c.jsx(He,{onClick:at,disabled:se,className:"px-8",children:se?c.jsxs(c.Fragment,{children:[c.jsx(nr,{size:"sm",color:"white",className:"mr-2"}),"Submitting..."]}):"Submit Test"})]})}),c.jsx(vo,{isOpen:_e&&!se,onClose:()=>Le(!1),title:"Reset Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and answers."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(He,{onClick:()=>Le(!1),variant:"secondary",children:"Cancel"}),c.jsx(He,{onClick:nt,variant:"primary",children:"Reset"})]})]})}),c.jsx(vo,{isOpen:te&&!se,onClose:()=>Ne(!1),title:"Exit Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to leave the test? Your progress will be saved."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(He,{onClick:()=>Ne(!1),variant:"secondary",children:"Cancel"}),c.jsx(He,{onClick:De,variant:"primary",children:"Leave"})]})]})})]}):c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsx(nr,{size:"lg"})})},fre=({width:t,height:e,lines:r,onDrawingChange:n,currentTool:s,currentColor:a,currentThickness:i,zoom:o,onZoomChange:l,isPanning:u,isFullscreen:d,constrainPanPosition:g,handleWheel:h,stageRef:p,setIsPanning:x,responsiveDimensions:v,canvasSize:w,question:S})=>{const[_,y]=b.useState(!1),[k,N]=b.useState([]),[E,A]=b.useState(null),[C,F]=b.useState(null),D=b.useRef(null),[R,M]=b.useState(.25);b.useEffect(()=>{const De=()=>{const at=D.current;if(!at)return;const Se=at.clientWidth||1,Ae=at.clientHeight||1,Me=Math.min(Se/(w.width||1),Ae/(w.height||1));M(Math.min(Me,1))};return De(),window.addEventListener("resize",De),()=>window.removeEventListener("resize",De)},[w.width,w.height,d]);const B=De=>{const at=p.current,Se=at.getPointerPosition();if(s==="pan")return;y(!0);const Ae={x:(Se.x-at.x())/at.scaleX(),y:(Se.y-at.y())/at.scaleY()};F(Ae),s==="pencil"?N([{x:Ae.x,y:Ae.y,color:a,thickness:i}]):["line","rectangle","circle"].includes(s)&&A({type:s,startX:Ae.x,startY:Ae.y,endX:Ae.x,endY:Ae.y,color:a,thickness:i})},J=De=>{const at=p.current,Se=at.getPointerPosition();if(s==="pan"||!_)return;const Ae={x:(Se.x-at.x())/at.scaleX(),y:(Se.y-at.y())/at.scaleY()};if(s==="pencil"){const Me=[...k,{x:Ae.x,y:Ae.y,color:a,thickness:i}];N(Me)}else["line","rectangle","circle"].includes(s)&&E&&A({...E,endX:Ae.x,endY:Ae.y})},X=()=>{if(s!=="pan"&&_){if(s==="pencil"){const De=[...r,k];n(De),N([])}else if(["line","rectangle","circle"].includes(s)&&E){const De=[...r,E];n(De),A(null)}y(!1),F(null)}},[z,H]=b.useState(null),[U,L]=b.useState(null),[ne,de]=b.useState(!1),[G,K]=b.useState(null),[Q,q]=b.useState(!1),[se,W]=b.useState(!1);let ee=null;const _e=(window.devicePixelRatio||1)>1.5,Le={scaleDelta:_e?.06:.08,centerDelta:_e?8:12,minTouchDistance:10},te=()=>{q(!1),K(null),H(null),L(null),y(!1),F(null),ee&&(cancelAnimationFrame(ee),ee=null),p.current&&p.current.stop()},Ne=De=>{if(De.length<2)return 0;const at=De[0],Se=De[1];return Math.sqrt(Math.pow(Se.clientX-at.clientX,2)+Math.pow(Se.clientY-at.clientY,2))},Ce=De=>{if(De.length<2)return null;const at=De[0],Se=De[1];return{x:(at.clientX+Se.clientX)/2,y:(at.clientY+Se.clientY)/2}},We=De=>{De.evt.preventDefault();const at=De.evt.touches;at.length===2?(q(!0),K(null),H(Ne(at)),L(Ce(at)),y(!1)):at.length===1&&(q(!1),K(null),B())},nt=De=>{De.evt.preventDefault();const at=De.evt.touches;if(at.length===2&&Q){const Se=p.current,Ae=Ne(at),Me=Ce(at);if(z&&U&&Se&&Ae>Le.minTouchDistance){const Ie=Math.abs(Ae/z-1),Ge=Math.sqrt(Math.pow(Me.x-U.x,2)+Math.pow(Me.y-U.y,2)),tt=Se.scaleX(),kt=Ae/z,zt=tt*kt,bt=(S==null?void 0:S.max_canvas_width)||1536,Dt=(S==null?void 0:S.max_canvas_height)||2048,it=bt/w.width,ht=Dt/w.height,Ct=Math.min(it,ht,1),jt=Math.max(.25,Math.min(Ct,zt)),Fe=Me.x-U.x,et=Me.y-U.y,Ze=Se.position();let rt={x:Ze.x,y:Ze.y};const dt=.25,Tt=Se.scaleX();if(Tt<=dt){const be=v.width,Ve=v.height,Nt=w.width*Tt,yt=w.height*Tt;rt={x:(be-Nt)/2,y:(Ve-yt)/2}}else rt={x:Ze.x+Fe,y:Ze.y+et};const xe=Ie>Le.scaleDelta,ue=Ge>Le.centerDelta;ee||(ee=requestAnimationFrame(()=>{if(xe){const be=Me,Ve={x:(be.x-Se.x())/tt,y:(be.y-Se.y())/tt};rt={x:be.x-Ve.x*jt,y:be.y-Ve.y*jt},Se.scale({x:jt,y:jt}),l(jt)}ue&&Se.position(rt),Se.batchDraw(),ee=null})),xe&&ue?(K("zoom+pan"),W(!0),x(!0)):xe?(K("zoom"),W(!0)):ue&&(K("pan"),x(!0)),console.log(" Gesture",{scaleDelta:Ie.toFixed(3),centerDelta:Ge.toFixed(1),doZoom:xe,doPan:ue,clampedScale:jt.toFixed(2),newPos:rt})}H(Ae),L(Me)}else at.length===1&&!Q&&J()},$e=De=>{De.evt.preventDefault();const at=De.evt.touches;at.length===0?(X(),te(),W(!1),x(!1)):at.length===1&&(q(!1),K(null),H(null),L(null),W(!1),x(!1))};return c.jsx("div",{className:"relative w-full flex justify-center",children:c.jsx("div",{className:"w-full max-w-full flex justify-center",children:c.jsxs("div",{className:"relative",style:{border:d&&(v.width<window.innerWidth-40||v.height<window.innerHeight-40)?"2px solid #000000":"none",borderRadius:"8px",overflow:"hidden"},children:[c.jsx("div",{ref:D,className:"w-full h-full",children:c.jsx(Lu,{ref:p,width:v.width,height:v.height,scaleX:d?v.zoom:o,scaleY:d?v.zoom:o,onMouseDown:B,onMousemove:J,onMouseup:X,onTouchStart:We,onTouchMove:nt,onTouchEnd:$e,onWheel:h||(()=>{}),onDragStart:()=>{console.log(" Drag started"),s==="pan"&&x(!0)},onDragEnd:()=>{if(console.log(" Drag ended"),s==="pan"&&(x(!1),g)){const De=p.current,at=D.current,Se=(at==null?void 0:at.clientWidth)||v.width,Ae=(at==null?void 0:at.clientHeight)||v.height,Me=w.width*De.scaleX(),Ie=w.height*De.scaleY(),Ge=De.x(),tt=De.y();(Ge>Se||Ge<-Me||tt>Ae||tt<-Ie)&&g(De)}},draggable:s==="pan"&&o>.25,className:`border border-gray-300 rounded-lg shadow-sm ${s==="pan"?"cursor-grab":u?"cursor-grabbing":"cursor-crosshair"}`,style:{maxWidth:"100%",height:"auto"},onLoad:()=>{console.log(" DrawingTestStudent - Stage loaded with dimensions:",v.width,"x",v.height),console.log(" DrawingTestStudent - Canvas size:",w.width,"x",w.height),console.log(" DrawingTestStudent - Current zoom level:",o),console.log(" DrawingTestStudent - Effective display size:",Math.round(w.width*o),"x",Math.round(w.height*o)),console.log(" DrawingTestStudent - Total pixels displayed:",Math.round(w.width*o*w.height*o))},children:c.jsxs(Mu,{children:[c.jsx(sa,{x:0,y:0,width:w.width,height:w.height,fill:"white"}),r.map((De,at)=>{var Se,Ae;if(Array.isArray(De))return c.jsx(hi,{points:De.flatMap(Me=>[Me.x,Me.y]),stroke:((Se=De[0])==null?void 0:Se.color)||"#000000",strokeWidth:((Ae=De[0])==null?void 0:Ae.thickness)||2,tension:.5,lineCap:"round",lineJoin:"round"},at);if(De.type==="line")return c.jsx(hi,{points:[De.startX,De.startY,De.endX,De.endY],stroke:De.color,strokeWidth:De.thickness,lineCap:"round"},at);if(De.type==="rectangle"){const Me=Math.abs(De.endX-De.startX),Ie=Math.abs(De.endY-De.startY),Ge=Math.min(De.startX,De.endX),tt=Math.min(De.startY,De.endY);return c.jsx(sa,{x:Ge,y:tt,width:Me,height:Ie,stroke:De.color,strokeWidth:De.thickness,fill:"transparent"},at)}else if(De.type==="circle"){const Me=Math.sqrt(Math.pow(De.endX-De.startX,2)+Math.pow(De.endY-De.startY,2))/2,Ie=(De.startX+De.endX)/2,Ge=(De.startY+De.endY)/2;return c.jsx(Kf,{x:Ie,y:Ge,radius:Me,stroke:De.color,strokeWidth:De.thickness,fill:"transparent"},at)}return null}),s==="pencil"&&c.jsx(hi,{points:k.flatMap(De=>[De.x,De.y]),stroke:a,strokeWidth:i,tension:.5,lineCap:"round",lineJoin:"round"}),E&&E.type==="line"&&c.jsx(hi,{points:[E.startX,E.startY,E.endX,E.endY],stroke:E.color,strokeWidth:E.thickness,lineCap:"round"}),E&&E.type==="rectangle"&&c.jsx(sa,{x:Math.min(E.startX,E.endX),y:Math.min(E.startY,E.endY),width:Math.abs(E.endX-E.startX),height:Math.abs(E.endY-E.startY),stroke:E.color,strokeWidth:E.thickness,fill:"transparent"}),E&&E.type==="circle"&&c.jsx(Kf,{x:(E.startX+E.endX)/2,y:(E.startY+E.endY)/2,radius:Math.sqrt(Math.pow(E.endX-E.startX,2)+Math.pow(E.endY-E.startY,2))/2,stroke:E.color,strokeWidth:E.thickness,fill:"transparent"})]})})}),c.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1",children:[c.jsx("button",{onClick:()=>{const De=p.current,at=De.scaleX(),Se=(S==null?void 0:S.max_canvas_width)||1536,Ae=(S==null?void 0:S.max_canvas_height)||2048,Me=Se/w.width,Ie=Ae/w.height,Ge=Math.min(Me,Ie,5),tt=Math.min(Ge,De.scaleX()*1.2);De.scale({x:tt,y:tt}),De.batchDraw(),console.log(" DrawingTestStudent - Zoom In button:",at.toFixed(2),"->",tt.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(w.width*tt),"x",Math.round(w.height*tt)),console.log(" DrawingTestStudent - New resolution:",Math.round(w.width*tt*w.height*tt),"pixels"),l(tt)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom In",children:"+"}),c.jsx("button",{onClick:()=>{const De=p.current,at=De.scaleX(),Se=Math.max(.25,De.scaleX()*.8);De.scale({x:Se,y:Se}),De.batchDraw(),console.log(" DrawingTestStudent - Zoom Out button:",at.toFixed(2),"->",Se.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(w.width*Se),"x",Math.round(w.height*Se)),console.log(" DrawingTestStudent - New resolution:",Math.round(w.width*Se*w.height*Se),"pixels"),l(Se)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom Out",children:""}),c.jsx("button",{onClick:()=>{const De=p.current,at=De.scaleX();De.scale({x:1,y:1}),De.position({x:0,y:0}),De.batchDraw(),console.log(" DrawingTestStudent - Reset zoom:",at.toFixed(2),"-> 1.00"),console.log(" DrawingTestStudent - Reset effective size:",w.width,"x",w.height),console.log(" DrawingTestStudent - Reset resolution:",w.width*w.height,"pixels"),l(1)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 text-xs",title:"Reset Zoom",children:"1:1"})]}),c.jsxs("div",{className:"absolute bottom-2 left-2 bg-white border border-gray-300 rounded px-2 py-1 text-xs text-gray-600 shadow-sm",children:[Math.round(o*100),"%"]})]})})})},hre=({content:t})=>{if(!t)return c.jsx("div",{className:"text-gray-500 italic",children:"No instructions provided"});const e=n=>{if(!n)return"";if(n.type==="text"){let s=n.text||"";if(n.format&&(n.format&1&&(s=`<strong>${s}</strong>`),n.format&2&&(s=`<em>${s}</em>`),n.format&8&&(s=`<u>${s}</u>`),n.format&16&&(s=`<s>${s}</s>`)),n.style){const a=n.style.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}if(n.textStyle){const a=n.textStyle.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}return s}if(n.type==="paragraph"){const s=n.children?n.children.map(e).join(""):"";let a="text-left";return n.format&&(n.format==="center"?a="text-center":n.format==="right"?a="text-right":n.format==="left"&&(a="text-left")),`<p class="${a}">${s}</p>`}if(n.type==="heading"){const s=n.tag||"h1",a=n.children?n.children.map(e).join(""):"";return`<${s}>${a}</${s}>`}if(n.type==="list"){const s=n.listType==="bullet"?"ul":"ol",a=n.children?n.children.map(i=>{if(i.type==="listitem"){const o=i.children?i.children.map(e).join(""):"";let l="margin: 4px 0; display: list-item;";return i.format&&(i.format==="center"?l+=" text-align: center;":i.format==="right"?l+=" text-align: right;":i.format==="left"&&(l+=" text-align: left;")),`<li style="${l}">${o}</li>`}return""}).join(""):"";return`<${s} style="margin: 8px 0; padding-left: 20px; list-style-type: ${n.listType==="bullet"?"disc":"decimal"}; display: block;">${a}</${s}>`}return n.children?n.children.map(e).join(""):""};let r=t;if(typeof t=="string"&&t.startsWith("{"))try{const n=JSON.parse(t);n.text?r=n.text:n.content?r=n.content:n.root&&n.root.children&&(r=n.root.children.map(e).join(""))}catch(n){console.log("Failed to parse Lexical content:",n)}return c.jsx("div",{className:"max-w-none rich-text-content",style:{lineHeight:"1.6",fontSize:"14px"},dangerouslySetInnerHTML:{__html:r}})},gre=({question:t,questionIndex:e,studentAnswer:r,onAnswerChange:n,mode:s,testId:a,testType:i})=>{Ys();const[o,l]=b.useState([]),[u,d]=b.useState(!0),[g,h]=b.useState("pencil"),[p,x]=b.useState("#000000"),[v,w]=b.useState(2),[S,_]=b.useState({width:600,height:800}),[y,k]=b.useState(1),[N,E]=b.useState(!1),[A,C]=b.useState(!1),[F,D]=b.useState(!1),[R,M]=b.useState(!1),B=b.useRef(null),J=b.useRef(null),[X,z]=b.useState({width:600,height:800}),H=b.useRef(!1),[U,L]=b.useState(.25),ne=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#008000","#808080","#FFC0CB","#A52A2A","#000080"];b.useEffect(()=>{const W=()=>{D(window.innerWidth>=1024)};return W(),window.addEventListener("resize",W),()=>window.removeEventListener("resize",W)},[]),b.useEffect(()=>{if(t){const W=t.max_canvas_width||1536,ee=t.max_canvas_height||2048,ve=t.canvas_width||600,_e=t.canvas_height||800;if(_({width:W,height:ee}),H.current)console.log(" DrawingTestStudent - Preserving user zoom:",y.toFixed(2));else{k(1),H.current=!0;const te=(ve-W*1)/2,Ne=(_e-ee*1)/2;if(!isNaN(te)&&!isNaN(Ne)&&B.current){const Ce={x:te,y:Ne};B.current.position(Ce),B.current.batchDraw()}console.log(" DrawingTestStudent - Canvas size set:",W,"x",ee),console.log(" DrawingTestStudent - Viewport size:",ve,"x",_e),console.log(" DrawingTestStudent - Initial zoom:",1 .toFixed(2)),console.log(" DrawingTestStudent - Image resolution:",W*ee,"pixels"),console.log(" DrawingTestStudent - Aspect ratio:",(W/ee).toFixed(2))}if(r&&typeof r=="string")try{const Le=JSON.parse(r);l(Le)}catch{console.log("No valid drawing data found")}d(!1)}},[t,r]),b.useEffect(()=>{const W=()=>{const ee=J.current;if(!ee)return;const ve=ee.clientWidth||1,_e=ee.clientHeight||1,Le=Math.min(ve/(S.width||1),_e/(S.height||1));L(Math.min(Le,1))};return W(),window.addEventListener("resize",W),()=>window.removeEventListener("resize",W)},[S.width,S.height,R]);const de=W=>{l(W),n(t.question_id,JSON.stringify(W))},G=()=>{l([]),n(t.question_id,"")},K=()=>{if(R){const ve=(t==null?void 0:t.canvas_width)||600,_e=(t==null?void 0:t.canvas_height)||800,Le=window.innerWidth-40,te=window.innerHeight-40,Ne=Le/ve,Ce=te/_e,We=Math.min(Ne,Ce,1);return{width:ve,height:_e,zoom:We}}const W=(t==null?void 0:t.canvas_width)||600,ee=(t==null?void 0:t.canvas_height)||800;return{width:W,height:ee,zoom:1}};b.useEffect(()=>{const W=()=>{z(K())};return W(),window.addEventListener("resize",W),()=>window.removeEventListener("resize",W)},[R,S]);const Q=W=>{W.evt.preventDefault();const ee=B.current,ve=ee.scaleX(),_e=ee.getPointerPosition(),Le={x:(_e.x-ee.x())/ve,y:(_e.y-ee.y())/ve},te=W.evt.deltaY>0?ve*.9:ve*1.1,Ne=(t==null?void 0:t.max_canvas_width)||1536,Ce=(t==null?void 0:t.max_canvas_height)||2048,We=Ne/S.width,nt=Ce/S.height,$e=Math.min(We,nt,1),De=Math.max(U,Math.min($e,te)),at={x:_e.x-Le.x*De,y:_e.y-Le.y*De};if(De<=U&&J.current){const Se=J.current.clientWidth||1,Ae=J.current.clientHeight||1;at.x=(Se-S.width*De)/2,at.y=(Ae-S.height*De)/2}ee.scale({x:De,y:De}),ee.position(at),ee.batchDraw(),console.log(" DrawingTestStudent - Wheel zoom:",ve.toFixed(2),"->",De.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(S.width*De),"x",Math.round(S.height*De)),console.log(" DrawingTestStudent - New resolution:",Math.round(S.width*De*S.height*De),"pixels"),k(De),H.current=!0},q=W=>{const ee=W.scaleX(),ve=J.current,_e=(ve==null?void 0:ve.clientWidth)||X.width,Le=(ve==null?void 0:ve.clientHeight)||X.height,te=S.width*ee,Ne=S.height*ee;if(ee<=U){const Me=(_e-te)/2,Ie=(Le-Ne)/2;W.position({x:Me,y:Ie}),W.batchDraw();return}if(te<=_e&&Ne<=Le){const Me=(_e-te)/2,Ie=(Le-Ne)/2;W.position({x:Me,y:Ie}),W.batchDraw();return}const Ce=Math.max(0,te-_e),We=Math.max(0,Ne-Le),nt=-Ce,$e=-We,De=W.x(),at=W.y(),Se=Math.max(nt,Math.min(Ce,De)),Ae=Math.max($e,Math.min(We,at));(Se!==De||Ae!==at)&&(W.position({x:Se,y:Ae}),W.batchDraw())},se=()=>{if(R)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();else{const W=document.querySelector(".drawing-canvas-container");W&&(W.requestFullscreen?W.requestFullscreen():W.webkitRequestFullscreen?W.webkitRequestFullscreen():W.msRequestFullscreen&&W.msRequestFullscreen())}};return b.useEffect(()=>{const W=()=>{M(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",W),document.addEventListener("webkitfullscreenchange",W),document.addEventListener("msfullscreenchange",W),()=>{document.removeEventListener("fullscreenchange",W),document.removeEventListener("webkitfullscreenchange",W),document.removeEventListener("msfullscreenchange",W)}},[]),b.useEffect(()=>()=>{B.current&&B.current.stop()},[]),u?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx(nr,{})}):t?c.jsxs("div",{className:`drawing-question max-w-6xl mx-auto p-1 sm:p-2 ${R?"fixed inset-0 z-50 bg-white overflow-y-auto":""}`,children:[!R&&c.jsx("div",{className:"mb-4",children:c.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",e+1]})}),!R&&t.question_json&&t.question_json.trim()&&c.jsxs("div",{className:"mb-2 p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Task:"}),c.jsx("div",{className:"text-gray-700",children:c.jsx(hre,{content:t.question_json})})]}),!R&&c.jsx(st,{className:"p-1 sm:p-2 mb-2",children:c.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-wrap",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"text-sm text-gray-700",children:"Tool:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>h("pencil"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${g==="pencil"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pencil (Freehand drawing)",children:""}),c.jsx("button",{onClick:()=>h("line"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${g==="line"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Line",children:""}),c.jsx("button",{onClick:()=>h("rectangle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${g==="rectangle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Rectangle",children:""}),c.jsx("button",{onClick:()=>h("circle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${g==="circle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Circle",children:""}),F&&c.jsx("button",{onClick:()=>h("pan"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${g==="pan"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pan (Move canvas)",children:""})]})]}),c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>E(!N),className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 sm:py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[c.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:p}}),c.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:"Color"})]}),N&&c.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-white border border-gray-300 rounded-lg shadow-lg z-30 min-w-max",children:c.jsx("div",{className:"flex flex-wrap gap-2 max-w-xs",children:ne.map(W=>c.jsx("button",{onClick:()=>{x(W),E(!1)},className:`w-10 h-10 rounded border-2 hover:scale-110 transition-transform flex-shrink-0 ${p===W?"border-gray-800":"border-gray-300"}`,style:{backgroundColor:W},title:W},W))})})]}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[c.jsx("label",{className:"text-xs sm:text-sm text-gray-700",children:"Thickness:"}),c.jsx("input",{type:"range",min:"1",max:"10",value:v,onChange:W=>w(parseInt(W.target.value)),className:"w-16 sm:w-20"}),c.jsxs("span",{className:"text-xs text-gray-500 w-6 sm:w-8",children:[v,"px"]})]}),c.jsx(He,{onClick:G,variant:"secondary",size:"sm",children:"Clear"})]})}),c.jsx(st,{className:"p-1 sm:p-2",children:c.jsxs("div",{className:"w-full drawing-canvas-container relative",children:[c.jsx(fre,{width:S.width,height:S.height,lines:o,onDrawingChange:de,currentTool:g,currentColor:p,currentThickness:v,zoom:y,onZoomChange:k,isPanning:A,isFullscreen:R,constrainPanPosition:q,handleWheel:Q,stageRef:B,setIsPanning:C,responsiveDimensions:X,canvasSize:S,question:t}),c.jsx("button",{onClick:se,className:"absolute top-2 left-2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white p-2 rounded-lg transition-all duration-200 z-10",title:R?"Exit Fullscreen":"Enter Fullscreen",children:R?c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})}):c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]})})]}):c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"text-center",children:c.jsx("p",{className:"text-gray-500",children:"No drawing question data available"})})})},y2={enhanceUserData(t,e){const r={id:t.id||t.student_id||t.teacher_id,username:t.username||t.student_id,name:t.name||t.first_name,surname:t.surname||t.last_name,nickname:t.nickname,role:e,is_active:t.is_active!==void 0?t.is_active:!0,created_at:t.created_at,updated_at:t.updated_at};switch(e){case"student":return{...r,student_id:t.student_id,grade:t.grade,class:t.class,number:t.number,subjects:t.subjects||[]};case"teacher":return{...r,teacher_id:t.teacher_id,first_name:t.first_name,last_name:t.last_name,email:t.email,phone:t.phone,subjects:t.subjects||[]};case"admin":return{...r,admin_id:t.admin_id,permissions:t.permissions||["all"]};default:return r}},async studentLogin(t){console.log("Trying student login...");try{const e=await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:t.username,password:t.password})}),r=await e.json();if(e.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.student,role:"student",response:e};throw new Error(r.message||"Student login failed")}catch(e){throw console.error("Student login error:",e),new Error(e.message||"Student login failed")}},async teacherLogin(t){console.log("Trying teacher login...");try{const e=await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await e.json();if(e.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.teacher,role:"teacher",response:e};throw new Error(r.message||"Teacher login failed")}catch(e){throw console.error("Teacher login error:",e),new Error(e.message||"Teacher login failed")}},async adminLogin(t){console.log("Trying admin login...");try{const e=await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await e.json();if(e.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.admin,role:"admin",response:e};throw new Error(r.message||"Admin login failed")}catch(e){throw console.error("Admin login error:",e),new Error(e.message||"Admin login failed")}},async login(t){const{username:e,password:r}=t;console.log("Attempting login with:",e,r);try{if(e==="admin"){const o=await this.adminLogin(t),l=await o.json();return await this.handleLoginResponse(o,"admin",l)}const n=await this.teacherLogin(t),s=await n.json();if(n.ok&&s.success)return await this.handleLoginResponse(n,"teacher",s);const a=await this.studentLogin(t),i=await a.json();return a.ok&&i.success?await this.handleLoginResponse(a,"student",i):(this.handleLoginFailure(),{success:!1,message:"Login failed. Please check your credentials and try again."})}catch(n){return console.error("Login error:",n),this.handleLoginFailure(),{success:!1,message:n.message||"Login failed"}}},async handleLoginResponse(t,e,r){if(t.ok&&r.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),this.handleLoginFailure(),{success:!1,message:"JWT system not available"};if(r.accessToken&&r.role)try{window.tokenManager.setTokens(r.accessToken,r.role),window.roleBasedLoader.setupAccessAfterLogin()}catch(n){return console.error("[ERROR] Failed to initialize JWT system:",n),this.handleLoginFailure(),{success:!1,message:"Failed to initialize JWT system"}}return this.resetLoginForm(),await this.handlePostLoginActions(r,e),{success:!0,data:r,role:e}}return{success:!1,message:"Login failed"}},async handlePostLoginActions(t,e){console.log(`Handling post-login actions for role: ${e}`);try{switch(e){case"student":t.student&&(this.populateStudentInfo(t.student),window.loadStudentData&&await window.loadStudentData());break;case"teacher":t.teacher&&(this.populateTeacherInfo(t.teacher),window.loadTeacherData&&await window.loadTeacherData());break;case"admin":t.admin&&window.loadAdminData&&await window.loadAdminData();break;default:console.warn(`Unknown role for post-login actions: ${e}`)}}catch(r){console.error("Error in post-login actions:",r)}},handleLoginFailure(){console.log("All login attempts failed"),this.resetLoginForm(),window.showNotification&&window.showNotification("Login failed. Please check your credentials and try again.","error")},resetLoginForm(){const t=document.getElementById("unifiedLoginForm");if(t){t.querySelectorAll("input").forEach(n=>{n.disabled=!1,n.style.opacity="1",n.style.cursor="text",n.removeAttribute("readonly"),n.style.pointerEvents="auto"});const r=t.querySelector('button[type="submit"]');r&&(r.disabled=!1,r.style.opacity="1",r.style.cursor="pointer",r.style.pointerEvents="auto",r.innerHTML="Login"),t.classList.remove("test-submitting","disabled"),t.style.pointerEvents="auto",console.log("Login form reset successfully - all inputs re-enabled")}},async logout(){console.log(" Logout initiated...");try{return window.tokenManager&&window.tokenManager.logout(),window.roleBasedLoader&&window.roleBasedLoader.reloadRoleAccess(),window.clearTestLocalStorage&&window.clearTestLocalStorage(),this.resetInterfaceAfterSessionClear(),console.log(" Logout completed - user session cleared, test data cleared, and interface reset"),{success:!0}}catch(t){return console.error("Logout error:",t),this.resetInterfaceAfterSessionClear(),{success:!0}}},resetInterfaceAfterSessionClear(){try{window.forceLogout=!0,window.preventAutoLogin=!0,window.isClearingSession=!0,window.forceLogoutComplete=!0,document.querySelectorAll(".section").forEach(s=>{s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0"}),document.querySelectorAll('[id$="-cabinet"], [id$="-container"], [id*="cabinet"], [id*="container"]').forEach(s=>{s.id&&s.id!=="login-section"&&(s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0")}),document.body.classList.remove("student-logged-in","teacher-logged-in","admin-logged-in"),document.body.classList.add("force-logout");const r=document.getElementById("login-section");r&&(r.classList.add("active"),r.style.display="block",r.style.visibility="visible",r.style.opacity="1"),document.querySelectorAll("input, select, textarea").forEach(s=>{s.type!=="hidden"&&(s.value="",s.checked=!1)}),console.log(" Interface reset to login state")}catch(t){console.error("Error resetting interface:",t),localStorage.clear(),sessionStorage.clear(),window.location.reload()}},async changePassword(t){var e,r;try{return{success:!0,message:(await vn.post("/auth/change-password",{currentPassword:t.currentPassword,newPassword:t.newPassword,confirmPassword:t.confirmPassword})).data.message}}catch(n){throw new Error(((r=(e=n.response)==null?void 0:e.data)==null?void 0:r.message)||"Password change failed")}},async verifyToken(t){try{const e=await vn.get("/auth/verify",{headers:{Authorization:`Bearer ${t}`}});return{success:!0,valid:e.data.valid,user:e.data.user}}catch(e){return{success:!1,valid:!1,error:e.message}}},async refreshToken(t){var e,r;try{const n=await vn.post("/auth/refresh",{refreshToken:t});return{success:!0,token:n.data.token,refreshToken:n.data.refreshToken}}catch(n){throw new Error(((r=(e=n.response)==null?void 0:e.data)==null?void 0:r.message)||"Token refresh failed")}},async getUserProfile(){var t,e;try{return{success:!0,user:(await vn.get("/auth/profile")).data.user}}catch(r){throw new Error(((e=(t=r.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to get user profile")}},async updateUserProfile(t){var e,r;try{return{success:!0,user:(await vn.put("/auth/profile",t)).data.user}}catch(n){throw new Error(((r=(e=n.response)==null?void 0:e.data)==null?void 0:r.message)||"Failed to update user profile")}},populateStudentInfo(t){console.log("=== populateStudentInfo called ==="),console.log("Student object:",t);const e=document.getElementById("studentName");if(e){const s=`${(t==null?void 0:t.name)||""} ${(t==null?void 0:t.surname)||""}`.trim();e.textContent=s,console.log("Set student name to:",s)}const r=document.getElementById("studentGrade");r&&(r.textContent=(t==null?void 0:t.grade)||"",console.log("Set student grade to:",t==null?void 0:t.grade));const n=document.getElementById("studentClass");n&&(n.textContent=(t==null?void 0:t.class)||"",console.log("Set student class to:",t==null?void 0:t.class)),console.log("Student info populated successfully")},populateTeacherInfo(t){console.log("=== populateTeacherInfo called ==="),console.log("Teacher object:",t);const e=document.getElementById("teacherName");if(e){const n=`${(t==null?void 0:t.name)||""} ${(t==null?void 0:t.surname)||""}`.trim();e.textContent=n,console.log("Set teacher name to:",n)}const r=document.getElementById("teacherUsername");r&&(r.textContent=(t==null?void 0:t.username)||"",console.log("Set teacher username to:",t==null?void 0:t.username)),console.log("Teacher info populated successfully")},getCurrentTeacherId(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const t=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return t&&t.sub?t.role==="teacher"?(console.log(`[DEBUG] Found teacher ID from JWT: ${t.sub}`),t.sub):(console.warn(`[WARN] Unsupported role for teacher function: ${t.role}`),null):(console.warn("[WARN] No teacher ID found in JWT token"),null)}catch(t){return console.error("[ERROR] Error getting current teacher ID from JWT:",t),null}},getCurrentAdmin(){var r;const t=(r=window.tokenManager)==null?void 0:r.getToken();if(!t)return null;const e=window.tokenManager.decodeToken(t);if(!e||e.role!=="admin")throw new Error("getCurrentAdmin() called by non-admin user");return{id:e.sub,username:e.username,role:e.role}},getCurrentTeacherUsername(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const t=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return t&&t.username?(console.log(`[DEBUG] Found teacher username from JWT: ${t.username}`),t.username):(console.warn("[WARN] No teacher username found in JWT token"),null)}catch(t){return console.error("[ERROR] Error getting current teacher username from JWT:",t),null}},isAdmin(){var t;try{const e=(t=window.tokenManager)==null?void 0:t.getToken();if(!e)return!1;const r=window.tokenManager.decodeToken(e);return r&&r.role==="admin"}catch(e){return console.error("[ERROR] Error checking admin status:",e),!1}},getCurrentAdminId(){try{const t=this.getCurrentAdmin();return t?t.id:null}catch(t){return console.error("[ERROR] Error getting admin ID:",t),null}}},mre=()=>{const t=Ha(),{login:e,setUserData:r,isAuthenticated:n,user:s}=xn(),[a,i]=b.useState({username:"",password:""}),[o,l]=b.useState(!1),[u,d]=b.useState(""),[g,h]=b.useState([]),[p,x]=b.useState(!1);b.useEffect(()=>{v()},[]);const v=b.useCallback(()=>{console.log("Checking for existing JWT session...");try{(window.forceLogout||window.preventAutoLogin)&&(window.forceLogout=!1,window.preventAutoLogin=!1)}catch{}if(window.tokenManager&&window.tokenManager.isAuthenticated()){console.log("JWT session valid, checking user role...");try{const R=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());R&&R.role?console.log("User role from JWT:",R.role):console.log("No valid role found in JWT, showing login")}catch(R){console.error("Error decoding JWT token:",R)}}else console.log("No valid JWT session found, showing login")},[]),w=b.useCallback(async R=>{if(R.preventDefault(),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),C("Please wait for the logout process to complete.","warning");return}const{username:M,password:B}=a;if(!M||!B){d("Please enter both username and password");return}l(!0),d("");try{let J,X;M==="admin"?(J=await y2.adminLogin({username:M,password:B}),X=ra.ADMIN):/^\d+$/.test(M)?(J=await y2.studentLogin({username:M,password:B}),X=ra.STUDENT):(J=await y2.teacherLogin({username:M,password:B}),X=ra.TEACHER);let z,H;if(J.response?(z=J,H=J.response):(z=await J.json(),H=J),await S(H,X,z)){C("Login successful!","success");try{window.forceLogout=!1,window.preventAutoLogin=!1}catch{}}}catch(J){console.error("Login error:",J),E(J)}finally{l(!1)}},[a]),S=b.useCallback(async(R,M,B)=>{if(R.ok&&B.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),E(),!1;try{B.token&&(window.tokenManager.setTokens(B.token,M),B.refreshToken&&window.tokenManager.setRefreshToken(B.refreshToken),console.log("JWT token stored successfully"));const J={...B.data,...B,role:M};return r(J),await _(J),!0}catch(J){return console.error("Error handling login response:",J),E(J),!1}}else return console.error("Login failed:",B.error||"Unknown error"),d(B.error||"Login failed. Please check your credentials."),!1},[e]),_=b.useCallback(async R=>{if(console.log("Handling post-login actions for role:",R.role),p){console.log(" Post-login already handled, skipping");return}x(!0);try{switch(R.role){case ra.STUDENT:await y(R),t("/student");break;case ra.TEACHER:await k(R),t("/teacher");break;case ra.ADMIN:await N(R),t("/admin");break;default:console.error("Unknown user role:",R.role),E()}}catch(M){console.error("Error in post-login actions:",M),E(M)}},[t,p]);b.useEffect(()=>{n||x(!1)},[n]);const y=b.useCallback(async R=>{console.log("Populating student info:",R)},[]),k=b.useCallback(async R=>{console.log("Populating teacher info:",R)},[]),N=b.useCallback(async R=>{console.log("Populating admin info:",R)},[]),E=b.useCallback((R=null)=>{console.error("Login failure:",R),d("Login failed. Please check your credentials and try again."),A()},[]),A=b.useCallback(()=>{i({username:"",password:""}),d(""),l(!1)},[]),C=b.useCallback((R,M)=>{const B={id:Date.now(),message:R,type:M,timestamp:new Date};h(J=>[...J,B]),setTimeout(()=>{h(J=>J.filter(X=>X.id!==B.id))},ya.NOTIFICATION_DURATION)},[]),F=b.useCallback(R=>{const{name:M,value:B}=R.target;i(J=>({...J,[M]:B})),u&&d("")},[u]),D=b.useCallback(R=>{R.key==="Enter"&&!o&&w(R)},[w,o]);return c.jsxs(Be.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsxs(Be.div,{className:"w-full max-w-md",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsxs(Be.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsx(Be.div,{className:"flex justify-center mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.5,type:"spring"},children:c.jsx("img",{src:"/pics/logo_mws.png",alt:"MWS Logo",className:"h-16 w-16 object-contain"})}),c.jsx(Be.h1,{className:"text-3xl font-bold text-gray-900 mb-2",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.3},children:"Mathayom Watsing School"}),c.jsx(Be.p,{className:"text-lg text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.3},children:"Test Management System"})]}),c.jsxs(Be.div,{className:"bg-white rounded-xl shadow-2xl p-8",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.7,duration:.5,type:"spring"},children:[c.jsx(Be.h2,{className:"text-2xl font-semibold text-gray-900 text-center mb-6",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.8,duration:.3},children:"Login"}),c.jsxs("form",{onSubmit:w,className:"space-y-6",children:[c.jsxs(Be.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.9,duration:.3},children:[c.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Student ID"}),c.jsx(Be.input,{type:"text",id:"username",name:"username",value:a.username,onChange:F,onKeyDown:D,placeholder:"Enter student ID",required:!0,autoComplete:"username",disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),c.jsxs(Be.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1,duration:.3},children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),c.jsx(Be.input,{type:"password",id:"password",name:"password",value:a.password,onChange:F,onKeyDown:D,placeholder:"Enter your password",required:!0,autoComplete:"current-password",disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),c.jsx(va,{children:u&&c.jsx(Be.div,{id:"error-message",className:"bg-red-50 border border-red-200 rounded-lg p-3",role:"alert","aria-live":"polite",initial:{opacity:0,height:0,y:-10},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:-10},transition:{duration:.3},children:c.jsx("p",{className:"text-sm text-red-600",children:u})})}),c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.1,duration:.3},children:c.jsx(He,{type:"submit",variant:"primary",size:"lg",disabled:o,className:"w-full",children:o?c.jsxs(c.Fragment,{children:[c.jsx(nr,{size:"sm",className:"mr-2"}),"Logging in..."]}):"Login"})})]})]}),ya.DEBUG_MODE]}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:c.jsx(va,{children:g.map(R=>c.jsx(Be.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{duration:.3,type:"spring"},children:c.jsx(Xi,{type:R.type,message:R.message,onClose:()=>h(M=>M.filter(B=>B.id!==R.id))})},R.id))})})]})},$r={async getStudentData(){console.log("getStudentData called - loading student subjects");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-subjects")).json();if(e.success)return console.log("Student data loaded successfully:",e.subjects),e.subjects;throw new Error(e.error||"Failed to load student data")}catch(t){throw console.error("Error loading student data:",t),t}},getStudentSubjects(t){return console.log("getStudentSubjects called with subjects:",t),t.map(e=>({id:e.id||e.subject_id,name:e.subject,grade:e.grade,class:e.class,testResults:e.test_results||[]}))},async getTeacherData(){console.log("getTeacherData called - loading teacher subjects");try{const t=await this.getCurrentTeacherId();if(!t)throw new Error("No valid teacher session found");const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-subjects")).json();if(r.success)return console.log("Teacher data loaded successfully:",r.subjects),{teacher_id:t,subjects:r.subjects,hasSubjects:r.subjects.length>0};throw new Error(r.error||"Failed to load teacher data")}catch(t){throw console.error("Error loading teacher data:",t),t}},getTeacherSubjects(t){return console.log("getTeacherSubjects called with subjects:",t),t.map(e=>{let r=[];return e.classes&&Array.isArray(e.classes)&&(r=e.classes.map(n=>({grade:n.grade,class:n.class,className:n.class}))),{id:e.subject_id,name:e.subject,classes:r,assignments:e.assignments||[],description:e.description||""}})},getGradeButtons(){return console.log("getGradeButtons called"),["M1","M2","M3","M4","M5","M6"].map(e=>({id:e,name:e,classes:this.generateClassButtons(e)}))},generateClassButtons(t){const e=[];for(let r=1;r<=10;r++)e.push({id:`${t}_${r}`,name:`${t}/${r}`,grade:t,class:r});return e},async getAdminData(){console.log("getAdminData called - loading admin data");try{if(!await this.getCurrentAdminId())throw new Error("No valid admin session found");const[e,r,n,s]=await Promise.allSettled([this.getAllTeachers(),this.getAllSubjects(),this.getAcademicYear(),this.getAllUsers()]);return{teachers:e.status==="fulfilled"?e.value:[],subjects:r.status==="fulfilled"?r.value:[],academicYear:n.status==="fulfilled"?n.value:[],users:s.status==="fulfilled"?s.value:[],loadedAt:new Date().toISOString()}}catch(t){throw console.error("Error loading admin data:",t),t}},async saveTeacherSubjects(t){console.log("saveTeacherSubjects called with subjects:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-teacher-subjects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subjects:t})})).json();if(r.success)return console.log("Teacher subjects saved successfully"),r;throw new Error(r.error||"Failed to save teacher subjects")}catch(e){throw console.error("Error saving teacher subjects:",e),e}},async deleteTeacherSubject(t){console.log("deleteTeacherSubject called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/delete-teacher-subject",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("Teacher subject assignment deleted successfully"),r;throw new Error(r.error||"Failed to delete teacher subject assignment")}catch(e){throw console.error("Error deleting teacher subject assignment:",e),e}},async getSubjectsDropdown(){console.log("getSubjectsDropdown called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(e.success)return console.log("Subjects dropdown data loaded successfully"),e.subjects.map(r=>({id:r.id,name:r.subject_name,value:r.subject_name}));throw new Error(e.error||"Failed to load subjects dropdown")}catch(t){throw console.error("Error loading subjects dropdown:",t),t}},async getGradesAndClasses(){console.log("getGradesAndClasses called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-grades-classes")).json();if(e.success)return console.log("Grades and classes loaded successfully"),e.data;throw new Error(e.message||"Failed to load grades and classes")}catch(t){throw console.error("Error loading grades and classes:",t),t}},async saveSubjectClasses(t,e){console.log("saveSubjectClasses called with subjectId:",t,"classes:",e);try{const r=await this.getCurrentTeacherId();if(!r)throw new Error("No valid teacher session found");const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-subject-classes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacher_id:r,subject_id:t,classes:e})})).json();if(s.success)return console.log("Subject classes saved successfully"),s;throw new Error(s.error||"Failed to save subject classes")}catch(r){throw console.error("Error saving subject classes:",r),r}},async getAllSubjects(){console.log("getAllSubjects called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(e.success)return console.log("All subjects loaded successfully"),e.subjects.map(r=>({id:r.id,name:r.subject_name,description:r.description||"",created_at:r.created_at,updated_at:r.updated_at}));throw new Error(e.error||"Failed to load all subjects")}catch(t){throw console.error("Error loading all subjects:",t),t}},async getSubjectsForSelection(){console.log("getSubjectsForSelection called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-subjects")).json();if(e.success)return console.log("Subjects for selection loaded successfully"),e.subjects;throw new Error(e.message||"Failed to load subjects for selection")}catch(t){throw console.error("Error loading subjects for selection:",t),t}},async getAcademicYear(){console.log("getAcademicYear called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-academic-year")).json();if(e.success)return console.log("Academic year loaded successfully"),e.academic_years.map(r=>({id:r.id,year:r.academic_year,semester:r.semester,term:r.term,start_date:r.start_date,end_date:r.end_date,is_current:r.is_current}));throw new Error(e.error||"Failed to load academic year")}catch(t){throw console.error("Error loading academic year:",t),t}},async addAcademicYear(t){console.log("addAcademicYear called with data:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/add-academic-year",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("Academic year added successfully"),r;throw new Error(r.error||"Failed to add academic year")}catch(e){throw console.error("Error adding academic year:",e),e}},async getAllUsers(){console.log("getAllUsers called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-users")).json();if(e.success)return console.log("All users loaded successfully"),e.users.map(r=>({id:r.id,student_id:r.student_id,grade:r.grade,class:r.class,number:r.number,name:r.name,surname:r.surname,nickname:r.nickname,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(e.error||"Failed to load all users")}catch(t){throw console.error("Error loading all users:",t),t}},async getAllTeachers(){console.log("getAllTeachers called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-teachers")).json();if(e.success)return console.log("All teachers loaded successfully"),e.teachers.map(r=>({id:r.id,teacher_id:r.teacher_id,username:r.username,name:r.name,surname:r.surname,email:r.email,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(e.error||"Failed to load all teachers")}catch(t){throw console.error("Error loading all teachers:",t),t}},async createUser(t){console.log("createUser called with data:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("User created successfully"),r;throw new Error(r.error||"Failed to create user")}catch(e){throw console.error("Error creating user:",e),e}},async updateUser(t,e){console.log("updateUser called with userId:",t,"data:",e);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-user/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(n.success)return console.log("User updated successfully"),n;throw new Error(n.error||"Failed to update user")}catch(r){throw console.error("Error updating user:",r),r}},async createTeacher(t){console.log("createTeacher called with data:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-teacher",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("Teacher created successfully"),r;throw new Error(r.error||"Failed to create teacher")}catch(e){throw console.error("Error creating teacher:",e),e}},async updateTeacher(t,e){console.log("updateTeacher called with teacherId:",t,"data:",e);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-teacher/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(n.success)return console.log("Teacher updated successfully"),n;throw new Error(n.error||"Failed to update teacher")}catch(r){throw console.error("Error updating teacher:",r),r}},async updateStudentInfo(t){console.log("updateStudentInfo called with data:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-student-info",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("Student info updated successfully"),r;throw new Error(r.error||"Failed to update student info")}catch(e){throw console.error("Error updating student info:",e),e}},async changePassword(t){console.log("changePassword called");try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("Password changed successfully"),r;throw new Error(r.error||"Failed to change password")}catch(e){throw console.error("Error changing password:",e),e}},async getCurrentTeacherId(){try{const t=localStorage.getItem("accessToken");if(!t)return null;const e=JSON.parse(atob(t.split(".")[1]));return e.teacher_id||e.sub||null}catch(t){return console.error("Error getting current teacher ID:",t),null}},async getCurrentAdminId(){try{const t=localStorage.getItem("accessToken");if(!t)return null;const e=JSON.parse(atob(t.split(".")[1]));return e.admin_id||e.sub||null}catch(t){return console.error("Error getting current admin ID:",t),null}}},bM=b.createContext(),SM=({children:t})=>{const[e,r]=b.useState(null),[n,s]=b.useState([]),[a,i]=b.useState([]),[o,l]=b.useState([]),[u,d]=b.useState([]),[g,h]=b.useState([]),[p,x]=b.useState([]),[v,w]=b.useState([]),[S,_]=b.useState(!1),[y,k]=b.useState(null),[N,E]=b.useState(!1),[A,C]=b.useState(!1),[F,D]=b.useState(!1),[R,M]=b.useState(null),[B,J]=b.useState(null),[X,z]=b.useState(null),H=b.useCallback(async()=>{try{_(!0),k(null);const ye=`student_subjects_${(e==null?void 0:e.student_id)||(e==null?void 0:e.id)||""}`;console.log(" UserContext: Checking cache for key:",ye);const be=nn(ye);if(be){console.log(" UserContext: Cache HIT! Using cached student data"),s(be),U(be);return}console.log(" UserContext: Cache MISS! Fetching from API");const Ve=await $r.getStudentData();if(Ve)s(Ve),U(Ve),console.log(" UserContext: Caching student data with key:",ye),zr(ye,Ve,Xr.student_subjects);else throw new Error("No subjects data received")}catch(ue){k(ue.message||"Failed to load student data"),console.error("Error loading student data:",ue)}finally{_(!1)}},[e==null?void 0:e.student_id,e==null?void 0:e.id]),U=ue=>{console.log("Displaying student subjects:",ue),s(ue)},L=b.useCallback(async()=>{try{if(_(!0),k(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid teacher session found in loadTeacherData, redirecting to login"),k("No valid teacher session found");return}const ye=`teacher_subjects_${(e==null?void 0:e.teacher_id)||(e==null?void 0:e.id)||""}`,be=nn(ye);if(be){s(be),be.length===0?et():ne(be);return}const Ve=await $r.getTeacherSubjects();if(Ve.success)s(Ve.subjects),zr(ye,Ve.subjects,Xr.teacher_subjects),Ve.subjects.length===0?et():ne(Ve.subjects);else throw new Error(Ve.message||"Failed to load teacher data")}catch(ue){k(ue.message||"Failed to load teacher data"),console.error("Error loading teacher data:",ue)}finally{_(!1)}},[e==null?void 0:e.teacher_id,e==null?void 0:e.id]),ne=ue=>{console.log("Showing main cabinet with subjects:",ue),s(ue)},de=ue=>{console.log("Displaying grade buttons:",ue),l(ue)},G=async()=>{try{if(_(!0),k(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid admin session found in loadAdminData, redirecting to login"),k("No valid admin session found");return}await Promise.all([Ne(),Ae(),bt(),se()])}catch(ue){k(ue.message||"Failed to load admin data"),console.error("Error loading admin data:",ue)}finally{_(!1)}},K=ue=>{console.log(" populateStudentInfoDirectly called with:",ue);try{r(ue),console.log(" Set student profile:",ue)}catch(ye){console.error("Error populating student info:",ye)}},Q=ue=>{console.log("=== populateStudentInfo called ==="),r(ue)},q=ue=>{console.log("=== populateTeacherInfo called ==="),r(ue)},se=b.useCallback(async()=>{try{_(!0);const ue="admin_users_",ye=nn(ue);if(ye){d(ye),W(ye);return}const be=await $r.getAllUsers();if(be.success)d(be.users),W(be.users),zr(ue,be.users,Xr.admin_users);else throw new Error(be.message||"Failed to load users")}catch(ue){k(ue.message||"Failed to load users"),console.error("Error loading users:",ue)}finally{_(!1)}},[]),W=ue=>{console.log("Displaying all users:",ue),d(ue)},ee=(ue,ye)=>{console.log("Displaying users table:",ue,ye),d(ue)},ve=()=>{console.log("Toggling users content")},_e=()=>{console.log("Showing add user form"),E(!0)},Le=()=>{console.log("Hiding add user form"),E(!1)},te=ue=>{console.log("Editing user row:",ue);const ye=u.find(be=>be.id===ue);M(ye)},Ne=b.useCallback(async()=>{try{const ue="admin_teachers_",ye=nn(ue);if(ye){h(ye),Ce(ye);return}const be=await $r.getAllTeachers();if(be.success)h(be.teachers),Ce(be.teachers),zr(ue,be.teachers,Xr.admin_teachers);else throw new Error(be.message||"Failed to load teachers")}catch(ue){k(ue.message||"Failed to load teachers"),console.error("Error loading teachers:",ue)}},[]),Ce=ue=>{console.log("Displaying all teachers:",ue),h(ue)},We=(ue,ye)=>{console.log("Displaying teachers table:",ue,ye),h(ue)},nt=()=>{console.log("Toggling teachers content")},$e=()=>{console.log("Showing add teacher form"),C(!0)},De=()=>{console.log("Hiding add teacher form"),C(!1)},at=ue=>{console.log("Editing teacher:",ue);const ye=g.find(be=>be.id===ue);J(ye)},Se=ue=>{console.log("Editing teacher row:",ue);const ye=g.find(be=>be.id===ue);J(ye)},Ae=b.useCallback(async()=>{try{const ue="admin_subjects_",ye=nn(ue);if(ye){x(ye),Me(ye);return}const be=await $r.getAllSubjects();if(be.success)x(be.subjects),Me(be.subjects),zr(ue,be.subjects,Xr.admin_subjects);else throw new Error(be.message||"Failed to load subjects")}catch(ue){k(ue.message||"Failed to load subjects"),console.error("Error loading subjects:",ue)}},[]),Me=ue=>{console.log("Displaying all subjects:",ue),x(ue)},Ie=(ue,ye)=>{console.log("Displaying subjects table:",ue,ye),x(ue)},Ge=()=>{console.log("Toggling subjects content")},tt=()=>{console.log("Showing add subject form"),D(!0)},kt=()=>{console.log("Hiding add subject form"),D(!1)},zt=ue=>{console.log("Editing subject row:",ue);const ye=p.find(be=>be.id===ue);z(ye)},bt=b.useCallback(async()=>{try{const ue="admin_academic_years_",ye=nn(ue);if(ye){w(ye),Dt(ye);return}const be=await $r.getAcademicYear();if(be.success)w(be.academicYears),Dt(be.academicYears),zr(ue,be.academicYears,Xr.admin_academic_years);else throw new Error(be.message||"Failed to load academic year")}catch(ue){k(ue.message||"Failed to load academic year"),console.error("Error loading academic year:",ue)}},[]),Dt=ue=>{console.log("Displaying academic year:",ue),w(ue)},it=()=>{console.log("Showing add academic year form")},ht=()=>{console.log("Hiding add academic year form")},Ct=ue=>{console.log("Handling add academic year:",ue)},jt=()=>{console.log("Toggling academic year content")},Fe=()=>{console.log("Showing academic year editor")},et=()=>{console.log("Showing subject selection")},Ze=()=>{console.log("Showing main cabinet")},rt=ue=>{r(ye=>({...ye,...ue}))},dt=()=>{r(null),s([]),i([]),l([]),d([]),h([]),x([]),w([]),k(null)},Tt=b.useCallback(ue=>{dt(),ue&&qk(ue)},[]),xe={userProfile:e,userSubjects:n,userClasses:a,userGrades:o,allUsers:u,allTeachers:g,allSubjects:p,academicYears:v,isLoading:S,error:y,showUserForm:N,showTeacherForm:A,showSubjectForm:F,editingUser:R,editingTeacher:B,editingSubject:X,loadStudentData:H,displayStudentSubjects:U,populateStudentInfoDirectly:K,populateStudentInfo:Q,loadTeacherData:L,showMainCabinetWithSubjects:ne,displayGradeButtons:de,populateTeacherInfo:q,showSubjectSelection:et,showMainCabinet:Ze,loadAdminData:G,getAllUsers:se,displayAllUsers:W,displayUsersTable:ee,toggleUsersContent:ve,showAddUserForm:_e,hideAddUserForm:Le,editUserRow:te,loadAllTeachers:Ne,displayAllTeachers:Ce,displayTeachersTable:We,toggleTeachersContent:nt,showAddTeacherForm:$e,hideAddTeacherForm:De,editTeacher:at,editTeacherRow:Se,loadAllSubjects:Ae,displayAllSubjects:Me,displaySubjectsTable:Ie,toggleSubjectsContent:Ge,showAddSubjectForm:tt,hideAddSubjectForm:kt,editSubjectRow:zt,loadAcademicYear:bt,displayAcademicYear:Dt,showAddAcademicYearForm:it,hideAddAcademicYearForm:ht,handleAddAcademicYear:Ct,toggleAcademicYearContent:jt,showAcademicYearEditor:Fe,updateUserProfile:rt,clearUserData:dt,clearUserDataWithCache:Tt,setUserProfile:r,setUserSubjects:s,setUserClasses:i,setUserGrades:l,setAllUsers:d,setAllTeachers:h,setAllSubjects:x,setAcademicYears:w,setError:k};return c.jsx(bM.Provider,{value:xe,children:t})},Iv=()=>{const t=b.useContext(bM);if(!t)throw new Error("useUser must be used within a UserProvider");return t},a8={STUDENT_LOGIN:"/.netlify/functions/student-login",TEACHER_LOGIN:"/.netlify/functions/teacher-login",ADMIN_LOGIN:"/.netlify/functions/admin-login",CHANGE_PASSWORD:"/.netlify/functions/change-password",GET_TEST_QUESTIONS:"/.netlify/functions/get-test-questions",SUBMIT_MULTIPLE_CHOICE_TEST:"/.netlify/functions/submit-multiple-choice-test",SUBMIT_TRUE_FALSE_TEST:"/.netlify/functions/submit-true-false-test",SUBMIT_INPUT_TEST:"/.netlify/functions/submit-input-test",SUBMIT_MATCHING_TEST:"/.netlify/functions/submit-matching-test",SUBMIT_DRAWING_TEST:"/.netlify/functions/submit-drawing-test",GET_STUDENT_SUBJECTS:"/.netlify/functions/get-student-subjects",GET_TEACHER_SUBJECTS:"/.netlify/functions/get-teacher-subjects",GET_ALL_USERS:"/.netlify/functions/get-all-users",GET_ALL_TEACHERS:"/.netlify/functions/get-all-teachers",GET_ALL_SUBJECTS:"/.netlify/functions/get-all-subjects",GET_ACADEMIC_YEAR:"/.netlify/functions/get-academic-year",SAVE_MULTIPLE_CHOICE_TEST:"/.netlify/functions/save-multiple-choice-test",SAVE_TRUE_FALSE_TEST:"/.netlify/functions/save-true-false-test",SAVE_INPUT_TEST:"/.netlify/functions/save-input-test",SAVE_MATCHING_TEST:"/.netlify/functions/save-matching-test",SAVE_DRAWING_TEST:"/.netlify/functions/save-drawing-test",UPDATE_DRAWING_TEST_SCORE:"/.netlify/functions/update-drawing-test-score",ASSIGN_TEST_TO_CLASSES:"/.netlify/functions/assign-test-to-classes",GET_TEACHER_ACTIVE_TESTS:"/.netlify/functions/get-teacher-active-tests",GET_STUDENT_ACTIVE_TESTS:"/.netlify/functions/get-student-active-tests"},Dr={MULTIPLE_CHOICE:"multiple_choice",TRUE_FALSE:"true_false",INPUT:"input",MATCHING:"matching_type",WORD_MATCHING:"word_matching",DRAWING:"drawing",FILL_BLANKS:"fill_blanks"},ra={STUDENT:"student",TEACHER:"teacher",ADMIN:"admin"};Array.from({length:10},(t,e)=>e+1);const ya={API_BASE_URL:"",APP_NAME:"Mathayom Watsing Test System",VERSION:"2.0.0",DEBUG_MODE:!1,AUTO_SAVE_INTERVAL:3e4,NOTIFICATION_DURATION:3e3,MAX_TEST_QUESTIONS:50,MIN_TEST_QUESTIONS:1,ITEMS_PER_PAGE:20,CACHE_DURATION:3e5,CURRENT_ACADEMIC_YEAR:"2025-2026",CURRENT_SEMESTER:1},fc=(t,e,r)=>{if(!t||!Array.isArray(t)||t.length===0)return{score:0,total:0,percentage:0};let n=0;return t.forEach((s,a)=>{const i=Array.isArray(e)?e[a]:e[String(s.question_id||s.id||a)];i!=null&&qf(s,i,r)&&n++}),{score:n,total:t.length,percentage:Math.round(n/t.length*100)}},Lg=(t,e)=>{console.log(" Getting correct answer for question:",t,"testType:",e);let r="";switch(e){case Dr.TRUE_FALSE:r=t.correct_answer?"true":"false",console.log(" TRUE_FALSE correct_answer from question:",r,typeof r);break;case Dr.MULTIPLE_CHOICE:const n=t.correct_answer.charCodeAt(0)-65,s=`option_${String.fromCharCode(97+n)}`,a=t[s];a?r=a:r=`Option ${t.correct_answer}`;break;case Dr.INPUT:t.correct_answers&&Array.isArray(t.correct_answers)?r=t.correct_answers.join(", "):r=t.correct_answer||"Unknown";break;case Dr.MATCHING:r=t.correct_answer||t.answer;break;case Dr.WORD_MATCHING:r=t.correct_answer||t.answer;break;case Dr.DRAWING:r="Drawing required";break;case Dr.FILL_BLANKS:t.correct_answers&&Array.isArray(t.correct_answers)&&t.correct_answers.length>0?r=t.correct_answers[0]:r=t.correct_answer||"Unknown";break;default:r="Unknown"}return console.log(" Correct answer:",r),r},qf=(t,e,r)=>{if(console.log("[DEBUG] checkAnswerCorrectness called for question:",t,"studentAnswer:",e,"testType:",r),!e||e==="")return console.log("[DEBUG] No student answer provided"),!1;let n=!1;switch(r){case Dr.TRUE_FALSE:n=e.toLowerCase()==="true"===t.correct_answer;break;case Dr.MULTIPLE_CHOICE:let a="";if(typeof e=="string"){const o=e.trim();if(/^[a-z]$/i.test(o))a=o.toUpperCase();else if(/^\d+$/.test(o)){const l=parseInt(o,10),u=l>=0?l:NaN;Number.isNaN(u)||(a=String.fromCharCode(65+u))}}else if(typeof e=="number"){const o=e;Number.isNaN(o)||(a=String.fromCharCode(65+o))}n=a!==""&&a===String(t.correct_answer||"").toUpperCase();break;case Dr.INPUT:if(t.correct_answers&&Array.isArray(t.correct_answers)){const o=e.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();n=t.correct_answers.some(l=>{const u=l.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();return o===u})}else n=e.toLowerCase().trim()===t.correct_answer.toLowerCase().trim();break;case Dr.MATCHING:if(t.correct_answer&&typeof t.correct_answer=="object"){const o=typeof e=="string"?JSON.parse(e||"{}"):e;n=JSON.stringify(o)===JSON.stringify(t.correct_answer)}break;case Dr.WORD_MATCHING:if(t.correct_answer&&typeof t.correct_answer=="object"){const o=typeof e=="string"?JSON.parse(e||"{}"):e;n=JSON.stringify(o)===JSON.stringify(t.correct_answer)}break;case Dr.DRAWING:console.warn("Drawing tests should not be auto-scored!"),n=!1;break;case Dr.FILL_BLANKS:const i=t.correct_answers&&Array.isArray(t.correct_answers)&&t.correct_answers.length>0?t.correct_answers[0]:t.correct_answer;if(i&&e){let o="";if(typeof e=="string"){const l=e.trim();if(/^[a-z]$/i.test(l))o=l.toUpperCase();else if(/^\d+$/.test(l)){const u=parseInt(l,10),d=u>=0?u:NaN;Number.isNaN(d)||(o=String.fromCharCode(65+d))}}else if(typeof e=="number"){const l=e;Number.isNaN(l)||(o=String.fromCharCode(65+l))}n=o!==""&&o===String(i||"").toUpperCase()}break;default:console.warn(`[WARN] Unknown test type for answer checking: ${r}`),n=!1}return console.log(`[DEBUG] Answer correctness: ${n}`),n},Tr={async getTestInfo(t,e){console.log(`[DEBUG] getTestInfo called with testType: ${t}, testId: ${e}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${t}&test_id=${e}`;console.log("[DEBUG] Fetching test info from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test info data received:",s),s.success)return console.log("[DEBUG] Test info retrieved successfully"),s.test_info;throw new Error(s.error||"Failed to get test info")}catch(r){throw console.error("[ERROR] Failed to get test info:",r),r}},async getTestQuestions(t,e){console.log(`[DEBUG] getTestQuestions called with testType: ${t}, testId: ${e}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${t}&test_id=${e}`;console.log("[DEBUG] Fetching test questions from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test questions data received:",s),s.success)return console.log("[DEBUG] Test questions retrieved successfully"),s.questions;throw new Error(s.error||"Failed to get test questions")}catch(r){throw console.error("[ERROR] Failed to get test questions:",r),r}},async getActiveTests(){console.log("getActiveTests called - extracting studentId from JWT token");try{const t="/.netlify/functions/get-student-active-tests";console.log("[DEBUG] Fetching active tests from:",t);const e=await window.tokenManager.makeAuthenticatedRequest(t);if(console.log("[DEBUG] Response status:",e.status),!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const r=await e.json();if(console.log("[DEBUG] Active tests data received:",r),r.success)return console.log("[DEBUG] Active tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get active tests")}catch(t){throw console.error("[ERROR] Failed to get active tests:",t),t}},async getTeacherTests(){console.log("getTeacherTests called - extracting teacherId from JWT token");try{const t="/.netlify/functions/get-teacher-active-tests";console.log("[DEBUG] Fetching teacher tests from:",t);const e=await window.tokenManager.makeAuthenticatedRequest(t);if(console.log("[DEBUG] Response status:",e.status),!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const r=await e.json();if(console.log("[DEBUG] Teacher tests data received:",r),r.success)return console.log("[DEBUG] Teacher tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get teacher tests")}catch(t){throw console.error("[ERROR] Failed to get teacher tests:",t),t}},async submitTest(t,e,r,n={},s=null){var a,i,o;console.log("Submitting test:",{testType:t,testId:e});try{if(Object.keys(r).length===0)throw new Error("Please answer at least one question before submitting.");let l;try{const N=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-test-questions?test_type=${t}&test_id=${e}`)).json();if(N.success)l=N.test_info;else throw new Error("Failed to get test information")}catch(k){console.error("Error getting test info:",k);const N=await this.getTestQuestions(t,e);l={test_name:`Test ${e}`,num_questions:N.length}}const u=await this.getTestQuestions(t,e);let d,g;if(t==="drawing")d=null,g=null;else{const k=n!=null&&n.answers_by_id?n.answers_by_id:r;d=fc(u,k,t).score,g=l.num_questions}const h=this.transformAnswersForSubmission(r,t),p=l.teacher_id||null,x=l.subject_id||null,v=(s==null?void 0:s.student_id)||(s==null?void 0:s.id)||((a=window.tokenManager)!=null&&a.getCurrentUser?((i=window.tokenManager.getCurrentUser())==null?void 0:i.student_id)||((o=window.tokenManager.getCurrentUser())==null?void 0:o.id):null),w={test_id:e,test_name:l.test_name,test_type:t,teacher_id:p,subject_id:x,student_id:v,answers:h,score:d,maxScore:g,time_taken:n.time_taken||null,started_at:n.started_at||null,submitted_at:n.submitted_at||new Date().toISOString(),caught_cheating:n.caught_cheating||!1,visibility_change_times:n.visibility_change_times||0,answers_by_id:n.answers_by_id||null,question_order:n.question_order||null,retest_assignment_id:n.retest_assignment_id||null,parent_test_id:n.parent_test_id||e};let S;switch(t){case"multiple_choice":S="/.netlify/functions/submit-multiple-choice-test";break;case"true_false":S="/.netlify/functions/submit-true-false-test";break;case"input":S="/.netlify/functions/submit-input-test";break;case"matching_type":S="/.netlify/functions/submit-matching-type-test";break;case"word_matching":S="/.netlify/functions/submit-word-matching-test";break;case"drawing":S="/.netlify/functions/submit-drawing-test";break;case"fill_blanks":S="/.netlify/functions/submit-fill-blanks-test";break;default:throw new Error(`Unsupported test type: ${t}`)}console.log("Submitting to:",S),console.log("Submission data:",w),console.log("Submission data JSON:",JSON.stringify(w,null,2));const _=await window.tokenManager.makeAuthenticatedRequest(S,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)});if(!_.ok)throw new Error(`HTTP error! status: ${_.status}`);const y=await _.json();if(console.log("Test submission result:",y),y.success)return this.clearTestProgress(t,e),{success:!0,score:d,maxScore:g,result:y};throw new Error(y.error||"Failed to submit test")}catch(l){throw console.error("Error submitting test:",l),l}},async createTest(t){try{return(await vn.post("/tests/create",t)).data}catch(e){throw new Error(e.message||"Failed to create test")}},async updateTest(t,e,r){try{return(await vn.put(`/tests/${t}/${e}`,r)).data}catch(n){throw new Error(n.message||"Failed to update test")}},async deleteTest(t,e){try{return(await vn.delete(`/tests/${t}/${e}`)).data}catch(r){throw new Error(r.message||"Failed to delete test")}},async duplicateTest(t,e){try{return(await vn.post(`/tests/${t}/${e}/duplicate`)).data}catch(r){throw new Error(r.message||"Failed to duplicate test")}},async publishTest(t,e){try{return(await vn.post(`/tests/${t}/${e}/publish`)).data}catch(r){throw new Error(r.message||"Failed to publish test")}},async unpublishTest(t,e){try{return(await vn.post(`/tests/${t}/${e}/unpublish`)).data}catch(r){throw new Error(r.message||"Failed to unpublish test")}},async removeClassAssignment(t,e,r){try{return(await vn.delete(`/tests/${t}/${e}/assignments/${r}`)).data}catch(n){throw new Error(n.message||"Failed to remove class assignment")}},async getTestStatistics(t,e){try{return(await vn.get(`/tests/${t}/${e}/statistics`)).data}catch(r){throw new Error(r.message||"Failed to get test statistics")}},async exportTest(t,e,r="json"){try{return(await vn.get(`/tests/${t}/${e}/export?format=${r}`)).data}catch(n){throw new Error(n.message||"Failed to export test")}},async importTest(t,e){try{return(await vn.uploadFile(`/tests/import?type=${e}`,t)).data}catch(r){throw new Error(r.message||"Failed to import test")}},async getTestResults(t,e){try{return(await vn.get(`/tests/${t}/${e}/results`)).data}catch(r){throw new Error(r.message||"Failed to get test results")}},async getStudentTestResults(){try{console.log("[DEBUG] Fetching student test results from: /.netlify/functions/get-student-test-results");const t=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-test-results");if(console.log("[DEBUG] Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=await t.json();if(console.log("[DEBUG] Student test results data received:",e),e.success)return console.log("[DEBUG] Student test results retrieved successfully"),e;throw new Error(e.error||"Failed to get student test results")}catch(t){throw console.error("[ERROR] Failed to get student test results:",t),new Error(t.message||"Failed to get student test results")}},async getClassResults(t,e,r){try{return(await vn.get(`/tests/class-results/${t}/${e}/${r}`)).data}catch(n){throw new Error(n.message||"Failed to get class results")}},async saveTestProgress(t,e,r){try{return(await vn.post(`/tests/${t}/${e}/progress`,{progress:r})).data}catch(n){throw new Error(n.message||"Failed to save test progress")}},async getTestProgress(t,e){try{return(await vn.get(`/tests/${t}/${e}/progress`)).data}catch(r){throw new Error(r.message||"Failed to get test progress")}},async clearTestProgress(t,e){try{return(await vn.delete(`/tests/${t}/${e}/progress`)).data}catch(r){throw new Error(r.message||"Failed to clear test progress")}},async validateTestData(t){try{return(await vn.post("/tests/validate",t)).data}catch(e){throw new Error(e.message||"Failed to validate test data")}},async getTestPreview(t,e){try{return(await vn.get(`/tests/${t}/${e}/preview`)).data}catch(r){throw new Error(r.message||"Failed to get test preview")}},isAnswerCorrect(t,e,r,n){switch(n){case"multiple_choice":return String.fromCharCode(65+parseInt(e))===r.correct_answer;case"true_false":return e.toLowerCase()==="true"===r.correct_answer;case"input":return(r.correct_answers||[]).some(o=>e.toLowerCase().trim()===o.toLowerCase().trim());case"matching_type":return JSON.stringify(e)===JSON.stringify(r.correct_answer);case"word_matching":return JSON.stringify(e)===JSON.stringify(r.correct_answer);case"drawing":return e&&e!=="No answer";default:return!1}},transformAnswersForSubmission(t,e){switch(e){case"multiple_choice":return t;case"true_false":return t;case"input":return t;case"matching_type":return t;case"word_matching":return t;case"drawing":if(Array.isArray(t)&&t.length>0)try{const r=t[0];return typeof r=="string"&&r.startsWith("[")?JSON.parse(r):t}catch(r){return console.warn("Failed to parse drawing answers:",r),t}return t;default:return t}},async markTestCompleted(t,e){try{console.log(`[DEBUG] markTestCompleted called with testType: ${t}, testId: ${e}`);const r=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/mark-test-completed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_type:t,test_id:e})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();if(console.log("[DEBUG] Mark test completed response:",n),n.success)return console.log(`Test ${t}_${e} marked as completed successfully`),{success:!0,message:n.message};throw new Error(n.error||"Failed to mark test as completed")}catch(r){throw console.error("Error marking test completed:",r),r}},clearTestProgress(t,e){try{const r=`test_progress_${t}_${e}`;localStorage.removeItem(r),console.log(`Test progress cleared for ${t}_${e}`)}catch(r){console.error("Error clearing test progress:",r)}},async saveMultipleChoiceTest(t){console.log("[DEBUG] saveMultipleChoiceTest called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-multiple-choice-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save multiple choice test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(e){return console.error("Error saving multiple choice test:",e),{success:!1,message:"Error saving test: "+e.message}}},async saveTrueFalseTest(t){console.log("[DEBUG] saveTrueFalseTest called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-true-false-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save true/false test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(e){return console.error("Error saving true/false test:",e),{success:!1,message:"Error saving test: "+e.message}}},async saveInputTest(t){console.log("[DEBUG] saveInputTest called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-input-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save input test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(e){return console.error("Error saving input test:",e),{success:!1,message:"Error saving test: "+e.message}}},async saveMatchingTest(t){console.log("[DEBUG] saveMatchingTest called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,test_type:"matching_type",num_questions:t.num_blocks})})).json();return console.log("[DEBUG] Save matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(e){return console.error("Error saving matching test:",e),{success:!1,message:"Error saving test: "+e.message}}},async saveWordMatchingTest(t){console.log("[DEBUG] saveWordMatchingTest called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,test_type:"word_matching"})})).json();return console.log("[DEBUG] Save word matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(e){return console.error("Error saving word matching test:",e),{success:!1,message:"Error saving test: "+e.message}}},async saveDrawingTest(t){console.log("[DEBUG] saveDrawingTest called with:",t);try{const e={...t,test_type:"drawing"},n=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save drawing test response:",n),n.success?{success:!0,data:{test_id:n.test_id}}:{success:!1,message:n.message||"Failed to save test"}}catch(e){return console.error("Error saving drawing test:",e),{success:!1,message:"Error saving test: "+e.message}}},async getDrawingTest(t){console.log("[DEBUG] getDrawingTest called with testId:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-drawing-test?test_id=${t}`,{method:"GET"})).json();return console.log("[DEBUG] Get drawing test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(e){return console.error("Error getting drawing test:",e),{success:!1,message:"Error getting test: "+e.message}}},async submitDrawingTest(t,e,r,n){console.log("[DEBUG] submitDrawingTest called with:",{testId:t,answers:e,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-drawing-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:t,answers:e,time_taken:r,caught_cheating:(n==null?void 0:n.caught_cheating)||!1,visibility_change_times:(n==null?void 0:n.visibility_change_times)||0})})).json();return console.log("[DEBUG] Submit drawing test response:",a),a.success?{success:!0,data:a.data}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting drawing test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async updateDrawingTestScore(t,e,r){console.log("[DEBUG] updateDrawingTestScore called with:",{resultId:t,score:e,maxScore:r});try{const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-drawing-test-score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({result_id:t,score:e,max_score:r})})).json();return console.log("[DEBUG] Update drawing test score response:",s),s.success?{success:!0,data:s.data}:{success:!1,message:s.message||"Failed to update score"}}catch(n){return console.error("Error updating drawing test score:",n),{success:!1,message:"Error updating score: "+n.message}}},async getWordMatchingTest(t){console.log("[DEBUG] getWordMatchingTest called with testId:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-word-matching-test?test_id=${t}`,{method:"GET"})).json();return console.log("[DEBUG] Get word matching test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(e){return console.error("Error getting word matching test:",e),{success:!1,message:"Error getting test: "+e.message}}},async submitWordMatchingTest(t,e,r,n){console.log("[DEBUG] submitWordMatchingTest called with:",{testId:t,answers:e,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:t,answers:e,time_taken:r,caught_cheating:(n==null?void 0:n.caught_cheating)||!1,visibility_change_times:(n==null?void 0:n.visibility_change_times)||0})})).json();return console.log("[DEBUG] Submit word matching test response:",a),a.success?{success:!0,result:a.result}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting word matching test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async assignTestToClasses(t){console.log("[DEBUG] assignTestToClasses called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save test with assignments response:",r),r.success?{success:!0,message:"Test assigned successfully"}:{success:!1,message:r.message||"Failed to assign test"}}catch(e){return console.error("Error assigning test to classes:",e),{success:!1,message:"Error assigning test: "+e.message}}},async removeClassAssignment(t){console.log("[DEBUG] removeClassAssignment called with assignmentId:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/remove-class-assignment?assignment_id=${t}`,{method:"DELETE"})).json();return console.log("[DEBUG] Remove class assignment response:",r),r.success?{success:!0,message:"Assignment removed successfully"}:{success:!1,message:r.message||"Failed to remove assignment"}}catch(e){return console.error("Error removing class assignment:",e),{success:!1,message:"Error removing assignment: "+e.message}}}},kM=b.createContext(),CM=({children:t})=>{const[e,r]=b.useState(null),[n,s]=b.useState([]),[a,i]=b.useState({}),[o,l]=b.useState({}),[u,d]=b.useState(!1),[g,h]=b.useState(null),[p,x]=b.useState([]),[v,w]=b.useState(!1),[S,_]=b.useState(null),[y,k]=b.useState({isOpen:!1,testType:null,testId:null,testName:null,questions:[]}),[N,E]=b.useState(null),[A,C]=b.useState(0),{getItem:F,setItem:D,removeItem:R}=_M();b.useEffect(()=>{let xe;return u&&N&&(xe=setInterval(()=>{const ue=Math.floor((Date.now()-N)/1e3);C(ue)},1e3)),()=>{xe&&clearInterval(xe)}},[u,N]);const M=async(xe,ue)=>{try{w(!0),_(null),console.log(`[DEBUG] loadTestForPage called with testType: ${xe}, testId: ${ue}`);const ye=await Tr.getTestInfo(xe,ue);console.log("[DEBUG] Test info retrieved:",ye);const be=await Tr.getTestQuestions(xe,ue);console.log("[DEBUG] Test questions retrieved:",be),r({...ye,testType:xe,testId:ue}),s(be),d(!0),E(Date.now()),C(0),B(xe,ue),console.log("[DEBUG] Test loaded successfully")}catch(ye){_(ye.message||"Failed to load test"),console.error("Error loading test:",ye)}finally{w(!1)}},B=(xe,ue)=>{try{const ye=`test_progress_${xe}_${ue}`,be=F(ye);be&&(i(be.answers||{}),l(be.progress||{}))}catch(ye){console.error("Error loading saved progress:",ye)}},J=(xe,ue,ye,be)=>{var Ve,Nt;try{if(window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}const $t=`test_progress_${((Nt=(Ve=window.tokenManager)==null?void 0:Ve.getDecodedToken())==null?void 0:Nt.sub)||"unknown"}_${xe}_${ue}`,Ft={...a,[ye]:be},Ot={...o,[ye]:{answered:!0,timestamp:Date.now()}};i(Ft),l(Ot),D($t,{answers:Ft,progress:Ot,lastSaved:Date.now()}),console.log(`Saved progress for question ${ye}:`,be)}catch(yt){console.error("Error saving test progress:",yt)}},X=(xe,ue,ye)=>{var be,Ve,Nt;try{if(window.tokenManager&&!window.tokenManager.isAuthenticated())return console.warn("[WARN] Cannot get progress: No valid JWT token"),null;const $t=`test_progress_${((Ve=(be=window.tokenManager)==null?void 0:be.getDecodedToken())==null?void 0:Ve.sub)||"unknown"}_${xe}_${ue}`,Ft=F($t);return((Nt=Ft==null?void 0:Ft.answers)==null?void 0:Nt[ye])||null}catch(yt){return console.error("Error getting test progress:",yt),null}},z=(xe,ue)=>{var ye,be;try{if(console.log(`[DEBUG] clearTestProgress called with testType: ${xe}, testId: ${ue}`),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const Ve=((be=(ye=window.tokenManager)==null?void 0:ye.getDecodedToken())==null?void 0:be.sub)||"unknown",Nt=`test_progress_${Ve}_${xe}_${ue}`;console.log(`[DEBUG] Removing localStorage key: ${Nt}`);const yt=F(Nt)!==null;R(Nt),i({}),l({});for(let $t=0;$t<localStorage.length;$t++){const Ft=localStorage.key($t);Ft&&Ft.startsWith(`test_progress_${Ve}_${xe}_${ue}_`)&&(localStorage.removeItem(Ft),console.log(`[DEBUG] Cleared individual question key: ${Ft}`))}console.log(yt?`[DEBUG] Progress cleared for test ${xe}_${ue}`:`[DEBUG] No progress found to clear for test ${xe}_${ue}`)}catch(Ve){console.error("Error clearing test progress:",Ve)}},H=async(xe,ue,ye="")=>{try{w(!0),_(null),console.log("Submitting test:",{testType:xe,testId:ue});const be=se(xe,ue);if(Object.keys(be).length===0){_("Please answer at least one question before submitting.");return}let Ve;try{Ve=await Tr.getTestInfo(xe,ue)}catch(yr){console.error("Error getting test info:",yr);const qt=await Tr.getTestQuestions(xe,ue);Ve={test_name:`Test ${ue}`,num_questions:qt.length}}const Nt=await Tr.getTestQuestions(xe,ue),yt=fc(Nt,be,xe),$t=Ve.num_questions,Ft=ee(be,xe),Ot={test_id:ue,test_name:Ve.test_name,score:yt,maxScore:$t,answers:Ft},xr=await Tr.submitTest(xe,ue,Ot);if(xr.success){if(h(xr.result),de(xe,ue,ye),z(xe,ue),ye){const yr=`student_results_table_${ye}`;console.log(" TestContext: Caching test results after submission with key:",yr),zr(yr,xr.result,Xr.student_results_table)}return ye&&oh(ye,xe,ue),d(!1),xr.results}else throw new Error(xr.message||"Test submission failed")}catch(be){throw _(be.message||"Failed to submit test"),be}finally{w(!1)}},U=(xe,ue,ye)=>{h({testType:xe,testId:ue,answers:ye}),d(!1)},L=()=>{r(null),s([]),i({}),l({}),d(!1),h(null),_(null),E(null),C(0)},ne=(xe,ue,ye="")=>{try{const be=`test_completed_${ye}_${xe}_${ue}`;return F(be)===!0}catch(be){return console.error("Error checking test completion:",be),!1}},de=(xe,ue,ye="")=>{try{const be=`test_completed_${ye}_${xe}_${ue}`;D(be,!0)}catch(be){console.error("Error marking test completed:",be)}},G=xe=>Object.keys(a).length,K=()=>{const xe=G(e==null?void 0:e.testType),ue=n.length;return{canSubmit:xe===ue,answeredCount:xe,totalQuestions:ue}},Q=()=>{e&&z(e.testType,e.testId),L()},q=(xe="")=>{try{const ue=`student_results_table_${xe}`;console.log(" TestContext: Clearing test results cache:",ue),localStorage.removeItem(ue),console.log(" TestContext: Test results cache cleared")}catch(ue){console.error("Error clearing test results cache:",ue)}},se=(xe,ue)=>({...a}),W=(xe,ue,ye=null)=>{try{if(!xe)return"No answer";switch(ue){case"true_false":return xe?"True":"False";case"multiple_choice":if(ye&&typeof xe=="string"&&!isNaN(parseInt(xe))){const be=parseInt(xe),Ve=`option_${String.fromCharCode(97+be)}`,Nt=ye[Ve];if(Nt)return Nt}return String(xe).toUpperCase();case"input":return String(xe);case"matching_type":return typeof xe=="object"?Object.entries(xe).map(([be,Ve])=>`${be}  ${Ve}`).join(", "):String(xe);case"word_matching":return typeof xe=="object"?Object.entries(xe).map(([be,Ve])=>`${be}  ${Ve}`).join(", "):String(xe);case"drawing":return"Drawing submitted";default:return String(xe)}}catch(be){return console.error("Error formatting student answer:",be),"Error displaying answer"}},ee=(xe,ue)=>{try{if(!xe||typeof xe!="object")return{};const ye={};return Object.entries(xe).forEach(([be,Ve])=>{if(Ve!=null)switch(ue){case"true_false":ye[be]=!!Ve;break;case"multiple_choice":ye[be]=String(Ve).toUpperCase();break;case"input":ye[be]=String(Ve).trim();break;case"matching_type":typeof Ve=="object"?ye[be]=Ve:ye[be]=String(Ve);break;case"word_matching":typeof Ve=="object"?ye[be]=Ve:ye[be]=String(Ve);break;case"drawing":ye[be]=Ve;break;default:ye[be]=Ve}}),ye}catch(ye){return console.error("Error transforming answers for submission:",ye),xe||{}}},ve=b.useCallback(async(xe="")=>{try{w(!0);const ue=`student_active_tests_${xe}`,ye=nn(ue);if(ye)return x(ye),ye;const be=await Tr.getActiveTests();return x(be),zr(ue,be,Xr.student_active_tests),be}catch(ue){return _(ue.message||"Failed to load active tests"),x([]),[]}finally{w(!1)}},[]),_e=async()=>{try{return w(!0),await Tr.getTeacherTests()}catch(xe){return _(xe.message||"Failed to load teacher tests"),[]}finally{w(!1)}},Le=async xe=>{try{return w(!0),await Tr.createTest(xe)}catch(ue){throw _(ue.message||"Failed to create test"),ue}finally{w(!1)}},te=async(xe,ue)=>{try{return w(!0),await Tr.deleteTest(xe,ue)}catch(ye){throw _(ye.message||"Failed to delete test"),ye}finally{w(!1)}},Ne=async(xe,ue)=>{try{return await Tr.getTestInfo(xe,ue)}catch(ye){throw console.error("Error getting test info:",ye),ye}},Ce=async(xe,ue)=>{try{return await Tr.getTestQuestions(xe,ue)}catch(ye){throw console.error("Error getting test questions:",ye),ye}},We=async(xe,ue,ye)=>{try{console.log("Showing test results:",{testType:xe,testId:ue,studentAnswers:ye});const be=await Ne(xe,ue),Ve=await Ce(xe,ue);De(be,Ve,xe,ye),d(!1),console.log("Test results displayed successfully")}catch(be){console.error("Error showing test results:",be),_("Failed to display test results"),h({testType:xe,testId:ue,answers:ye,showResults:!0,error:"Could not load detailed results"}),d(!1)}},nt=async(xe,ue,ye)=>{try{w(!0);const be=await Ne(xe,ue),Ve=await Ce(xe,ue);De(be,Ve,xe,ye)}catch(be){_(be.message||"Failed to load test results")}finally{w(!1)}},$e=b.useCallback(async(xe="")=>{var ue;try{w(!0);const ye=`student_results_table_${xe}`;console.log(" TestContext: Checking cache for key:",ye);const be=nn(ye);if(be)return console.log(" TestContext: Cache HIT! Using cached test results"),h(be),be;console.log(" TestContext: Cache MISS! Fetching from API");const Ve=await Tr.getStudentTestResults();return console.log(" TestContext: Test results loaded:",Ve),console.log(" TestContext: Results data:",(Ve==null?void 0:Ve.results)||Ve),console.log(" TestContext: Results length:",((ue=Ve==null?void 0:Ve.results)==null?void 0:ue.length)||0),h(Ve),console.log(" TestContext: Caching test results with key:",ye),console.log(" TestContext: Results being cached:",Ve),console.log(" TestContext: Results.results being cached:",Ve.results),zr(ye,Ve,Xr.student_results_table),Ve}catch(ye){throw console.error("Error loading test results:",ye),_(ye.message||"Failed to load test results"),ye}finally{w(!1)}},[]),De=(xe,ue,ye,be)=>{try{console.log("Displaying test results:",{testInfo:xe,questions:ue,testType:ye,studentAnswers:be});const Ve=fc(ue,be,ye),Nt=(xe==null?void 0:xe.num_questions)||(ue==null?void 0:ue.length)||0,yt=Nt>0?Math.round(Ve/Nt*100):0,$t=yt>=60,Ft=ue.map((Ot,xr)=>{const yr=Ot.question_id||Ot.id,qt=be[yr],hr=qf(Ot,qt,ye);return{questionNumber:xr+1,question:Ot.question||Ot.question_text,userAnswer:W(qt,ye),correctAnswer:Lg(Ot,ye),isCorrect:hr,questionType:ye}});h({testInfo:xe,questions:ue,testType:ye,studentAnswers:be,showResults:!0,score:Ve,totalQuestions:Nt,percentage:yt,passed:$t,questionAnalysis:Ft,timestamp:new Date().toISOString()}),l(Ot=>({...Ot,score:Ve,totalQuestions:Nt,percentage:yt,passed:$t,lastUpdated:Date.now()})),at(),console.log(`Test results displayed: ${Ve}/${Nt} (${yt}%) - ${$t?"PASSED":"FAILED"}`)}catch(Ve){console.error("Error displaying test results:",Ve),_("Failed to display test results")}},at=b.useCallback(()=>{try{console.log("Setting up test results page event listeners");const xe=Nt=>{if(Nt.key==="Escape"&&Q(),Nt.ctrlKey&&Nt.key==="p"&&(Nt.preventDefault(),window.print()),Nt.key==="Enter"&&g&&!g.passed){const yt=document.getElementById("retake-test-button");yt&&yt.click()}},ue=()=>{window.print()},ye=()=>{var Nt;if(g){const yt=`Test: ${((Nt=g.testInfo)==null?void 0:Nt.test_name)||"Test"}
Score: ${g.score}/${g.totalQuestions} (${g.percentage}%)
Status: ${g.passed?"PASSED":"FAILED"}
Completed: ${new Date(g.timestamp).toLocaleString()}`;navigator.clipboard.writeText(yt).then(()=>{console.log("Results copied to clipboard")}).catch($t=>{console.error("Failed to copy results:",$t)})}};document.addEventListener("keydown",xe);const be=document.getElementById("print-results");be&&be.addEventListener("click",ue);const Ve=document.getElementById("copy-results");return Ve&&Ve.addEventListener("click",ye),()=>{document.removeEventListener("keydown",xe),be&&be.removeEventListener("click",ue),Ve&&Ve.removeEventListener("click",ye)}}catch(xe){console.error("Error setting up test results page event listeners:",xe)}},[Q,g]),Se=async(xe,ue,ye)=>{try{w(!0),_(null),console.log("Viewing test details:",{testType:xe,testId:ue,testName:ye}),k({isOpen:!0,testType:xe,testId:ue,testName:ye,questions:[],isLoading:!0});const be=await Tr.getTestQuestions(xe,ue);be&&be.length>0?(k({isOpen:!0,testType:xe,testId:ue,testName:ye,questions:be,isLoading:!1}),console.log(`Test details loaded: ${be.length} questions`)):(_("Could not load test questions. Please try again."),k({isOpen:!0,testType:xe,testId:ue,testName:ye,questions:[],isLoading:!1,error:"No questions available for this test"}))}catch(be){console.error("Error loading test details:",be),_("Error loading test details. Please try again."),k({isOpen:!0,testType:xe,testId:ue,testName:ye,questions:[],isLoading:!1,error:be.message||"Failed to load test details"})}finally{w(!1)}},Ae=(xe,ue,ye,be)=>{try{console.log("Showing test details modal:",{testType:xe,testId:ue,testName:ye,questions:be}),k({isOpen:!0,testType:xe,testId:ue,testName:ye,questions:be||[],isLoading:!1,error:null})}catch(Ve){console.error("Error showing test details modal:",Ve),_("Failed to show test details modal")}},Me=()=>{try{console.log("Closing test details modal"),k({isOpen:!1,testType:null,testId:null,testName:null,questions:[],isLoading:!1,error:null})}catch(xe){console.error("Error closing test details modal:",xe)}},Ie=(xe,ue)=>{try{switch(ue){case"multiple_choice":return c.jsxs("div",{className:"answer-options",children:[c.jsx("p",{children:c.jsx("strong",{children:"Options:"})}),c.jsxs("p",{children:["A) ",xe.option_a||"No text"]}),c.jsxs("p",{children:["B) ",xe.option_b||"No text"]}),xe.option_c&&c.jsxs("p",{children:["C) ",xe.option_c]}),xe.option_d&&c.jsxs("p",{children:["D) ",xe.option_d]}),xe.option_e&&c.jsxs("p",{children:["E) ",xe.option_e]}),xe.option_f&&c.jsxs("p",{children:["F) ",xe.option_f]}),c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",xe.correct_answer||"Not specified"]})})]});case"true_false":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",xe.correct_answer?"True":"False"]})})});case"input":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",xe.correct_answer||"Not specified"]})})});case"matching_type":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",xe.correct_answer?JSON.stringify(xe.correct_answer):"Not specified"]})})});case"word_matching":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",xe.correct_answer?JSON.stringify(xe.correct_answer):"Not specified"]})})});default:return c.jsx("p",{children:"Unknown question type"})}}catch(ye){return console.error("Error formatting question answer display:",ye),c.jsx("p",{children:"Error displaying question"})}},Ge=(xe,ue)=>{try{console.log("Navigating to test:",{testType:xe,testId:ue}),r({testType:xe,testId:ue}),d(!0),M(xe,ue)}catch(ye){console.error("Error navigating to test:",ye),_("Failed to navigate to test")}},tt=()=>{try{console.log("Hiding test sections"),r(null),s([]),i({}),l({}),d(!1),h(null),_(null)}catch(xe){console.error("Error hiding test sections:",xe)}},kt=(xe,ue,ye,be)=>{try{console.log("Displaying test on page:",{testInfo:xe,questions:ue,testType:ye,testId:be}),r({...xe,testType:ye,testId:be}),s(ue),d(!0),B(ye,be),jt(ye,be),ht(ye,be)}catch(Ve){console.error("Error displaying test on page:",Ve),_("Failed to display test on page")}},zt=(xe,ue,ye)=>{try{return console.log("Rendering questions for page:",{questions:xe,testType:ue,testId:ye}),!xe||!Array.isArray(xe)?(console.warn("Invalid questions array for rendering"),[]):xe.map((be,Ve)=>{const Nt=yt=>{const $t={...a,[be.question_id]:yt};i($t),J(ue,ye,be.question_id,yt)};return{question:be,index:Ve,testType:ue,testId:ye,studentAnswer:a[be.question_id]||"",onAnswerChange:Nt}})}catch(be){return console.error("Error rendering questions for page:",be),[]}},bt=b.useCallback((xe,ue)=>{try{if(!xe||!ue){console.warn("Cannot save progress: missing testType or testId");return}const ye=`test_progress_${xe}_${ue}`,be={answers:a,progress:o,lastSaved:Date.now(),testType:xe,testId:ue};D(ye,be),console.log(`Progress saved for test ${xe}_${ue}:`,be)}catch(ye){console.error("Error saving progress for page:",ye)}},[a,o,D]),Dt=b.useCallback(xe=>{try{return!a||Object.keys(a).length===0?0:Object.values(a).filter(ye=>ye==null?!1:typeof ye=="string"?ye.trim()!=="":typeof ye=="object"?Object.keys(ye).length>0:!0).length}catch(ue){return console.error("Error getting answered questions count for page:",ue),0}},[a]),it=b.useCallback((xe,ue)=>{try{console.log("Updating progress display for page:",{testType:xe,testId:ue});const ye=Dt(xe),be=n.length,Ve=be>0?Math.round(ye/be*100):0,Nt=ye===be&&be>0;l(Ot=>({...Ot,answeredCount:ye,totalQuestions:be,percentage:Ve,canSubmit:Nt,remainingQuestions:be-ye,lastUpdated:Date.now()}));const yt=document.getElementById("progress-bar"),$t=document.getElementById("progress-text"),Ft=document.getElementById("submit-test-button");return yt&&(yt.style.width=`${Ve}%`,yt.className=yt.className.replace(/bg-\w+-\d+/,""),Ve>=100?yt.classList.add("bg-green-500"):Ve>=80?yt.classList.add("bg-blue-500"):Ve>=60?yt.classList.add("bg-yellow-500"):Ve>=40?yt.classList.add("bg-orange-500"):yt.classList.add("bg-red-500")),$t&&($t.textContent=`${ye}/${be} questions answered (${Ve}%)`),Ft&&(Ft.disabled=!Nt,Nt?(Ft.textContent=" Submit Test",Ft.classList.remove("bg-gray-400"),Ft.classList.add("bg-green-600","hover:bg-green-700")):(Ft.textContent=` Complete ${be-ye} more question${be-ye!==1?"s":""}`,Ft.classList.remove("bg-green-600","hover:bg-green-700"),Ft.classList.add("bg-gray-400"))),{answeredCount:ye,totalQuestions:be,percentage:Ve,canSubmit:Nt}}catch(ye){return console.error("Error updating progress display for page:",ye),{answeredCount:0,totalQuestions:0,percentage:0,canSubmit:!1}}},[n.length,Dt]),ht=b.useCallback((xe,ue)=>{try{console.log("Setting up test page event listeners:",{testType:xe,testId:ue});const ye=setInterval(()=>{Object.keys(a).length>0&&(bt(xe,ue),console.log("Auto-saved progress for test:",xe,ue))},3e4),be=setInterval(()=>{it(xe,ue)},2e3),Ve=Ot=>{Ot.key==="Escape"&&window.confirm("Are you sure you want to exit the test? Your progress will be saved.")&&Q(),Ot.ctrlKey&&Ot.key==="s"&&(Ot.preventDefault(),bt(xe,ue),console.log("Manual save triggered")),Ot.key},Nt=Ot=>{Object.keys(a).length>0&&(Ot.preventDefault(),Ot.returnValue="Your test progress will be saved. Are you sure you want to leave?")},yt=()=>{document.hidden&&(console.log("Tab became hidden - saving progress"),bt(xe,ue))},$t=()=>{console.log("Window focused - updating progress"),it(xe,ue)},Ft=()=>{console.log("Window blurred - saving progress"),bt(xe,ue)};return document.addEventListener("keydown",Ve),window.addEventListener("beforeunload",Nt),document.addEventListener("visibilitychange",yt),window.addEventListener("focus",$t),window.addEventListener("blur",Ft),window.testIntervals||(window.testIntervals={}),window.testIntervals[`autosave_${xe}_${ue}`]=ye,window.testIntervals[`progress_${xe}_${ue}`]=be,()=>{clearInterval(ye),clearInterval(be),document.removeEventListener("keydown",Ve),window.removeEventListener("beforeunload",Nt),document.removeEventListener("visibilitychange",yt),window.removeEventListener("focus",$t),window.removeEventListener("blur",Ft),window.testIntervals&&(delete window.testIntervals[`autosave_${xe}_${ue}`],delete window.testIntervals[`progress_${xe}_${ue}`])}}catch(ye){console.error("Error setting up test page event listeners:",ye)}},[a,bt,it,Q]),Ct=b.useCallback(()=>{try{const xe=Dt(e==null?void 0:e.testType),ue=n.length,ye=xe===ue&&ue>0,be=document.getElementById("submit-test-button");return be&&(be.disabled=!ye,be.textContent=ye?"Submit Test":`Complete ${ue-xe} more questions`),{canSubmit:ye,answeredCount:xe,totalQuestions:ue}}catch(xe){return console.error("Error updating submit button state for page:",xe),{canSubmit:!1,answeredCount:0,totalQuestions:0}}},[e,n.length,Dt]),jt=b.useCallback((xe,ue)=>{try{console.log("Setting up progress tracking for page:",{testType:xe,testId:ue});const ye=setInterval(()=>{it(xe,ue),Ct()},1e3),be=setInterval(()=>{Object.keys(a).length>0&&bt(xe,ue)},3e4);return window.testIntervals||(window.testIntervals={}),window.testIntervals[`progress_${xe}_${ue}`]=ye,window.testIntervals[`autosave_${xe}_${ue}`]=be,()=>{clearInterval(ye),clearInterval(be),window.testIntervals&&(delete window.testIntervals[`progress_${xe}_${ue}`],delete window.testIntervals[`autosave_${xe}_${ue}`])}}catch(ye){console.error("Error setting up progress tracking for page:",ye)}},[a,it,Ct,bt]),Fe=b.useCallback(async(xe,ue)=>{const ye=document.getElementById("submit-test-button");try{const be=Dt(xe),Ve=n.length;if(be<Ve){_(`Please answer all ${Ve} questions before submitting.`);return}if(!window.confirm("Are you sure you want to submit your test? This action cannot be undone."))return;ye&&(ye.disabled=!0,ye.innerHTML=`
          <div class="flex items-center justify-center space-x-2">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
            <span>Submitting...</span>
          </div>
        `),await H(xe,ue)&&(z(xe,ue),U(xe,ue,a),console.log("Test submitted successfully!"))}catch(be){console.error("Error submitting test from page:",be),_("Failed to submit test. Please try again."),ye&&(ye.disabled=!1,ye.textContent="Submit Test")}},[Dt,n.length,H,z,U,a]),et=b.useCallback(()=>{try{if(!e)return null;const xe=["true_false","multiple_choice","input","matching_type","word_matching"];return xe.includes(e.testType)?e.testType:xe.includes(e.test_type)?e.test_type:null}catch(xe){return console.error("Error getting current test type:",xe),null}},[e]),Ze=b.useCallback((xe,ue)=>{try{console.log("Clearing progress tracking interval:",{testType:xe,testId:ue});const ye=`progress_interval_${xe}_${ue}`,be=`autosave_interval_${xe}_${ue}`;window.testIntervals&&(window.testIntervals[ye]&&(clearInterval(window.testIntervals[ye]),delete window.testIntervals[ye]),window.testIntervals[be]&&(clearInterval(window.testIntervals[be]),delete window.testIntervals[be])),console.log(`Cleared progress tracking intervals for test ${xe}_${ue}`)}catch(ye){console.error("Error clearing progress tracking interval:",ye)}},[]),Tt={currentTest:e,testQuestions:n,studentAnswers:a,testProgress:o,isTestActive:u,testResults:g,activeTests:p,isLoading:v,error:S,testDetailsModal:y,testStartTime:N,timeElapsed:A,loadTestForPage:M,submitTest:H,navigateToTestResults:U,navigateBackToCabinet:L,clearTestDataAndReturnToCabinet:Q,saveTestProgress:J,getTestProgress:X,clearTestProgress:z,loadSavedProgressForPage:B,isTestCompleted:ne,markTestCompleted:de,markTestCompletedInUI:(xe,ue)=>{console.log("Marking test completed in UI:",{testType:xe,testId:ue}),de(xe,ue)},getAnsweredQuestionsCount:G,updateSubmitButtonState:K,updateSubmitButtonStateForPage:Ct,loadStudentActiveTests:ve,loadActiveTests:ve,loadTeacherActiveTests:_e,getTestInfo:Ne,getTestQuestions:Ce,createTest:Le,deleteTest:te,showTestResults:We,loadTestResults:$e,loadTestResultsForPage:nt,displayTestResultsOnPage:De,setupTestResultsPageEventListeners:at,clearTestResultsCache:q,viewTestDetails:Se,showTestDetailsModal:Ae,closeTestDetailsModal:Me,getQuestionAnswerDisplay:Ie,navigateToTest:Ge,hideTestSections:tt,displayTestOnPage:kt,renderQuestionsForPage:zt,setupTestPageEventListeners:ht,setupProgressTrackingForPage:jt,updateProgressDisplayForPage:it,submitTestFromPage:Fe,getAnsweredQuestionsCountForPage:Dt,getCurrentTestType:et,saveProgressForPage:bt,clearProgressTrackingInterval:Ze,collectTestAnswers:se,calculateTestScore:fc,checkAnswerCorrectness:qf,formatStudentAnswerForDisplay:W,getCorrectAnswer:Lg,transformAnswersForSubmission:ee,clearAllTestData:()=>{try{console.log("Clearing old test data from localStorage (older than 15 days)...");const ue=Date.now()-15*24*60*60*1e3,ye=[];for(let be=0;be<localStorage.length;be++){const Ve=localStorage.key(be);if(!(!Ve||!((Ve.startsWith("test_")||Ve.startsWith("student_")||Ve.startsWith("teacher_")||Ve.startsWith("admin_")||Ve.includes("progress")||Ve.includes("answers"))&&!Ve.includes("test_completed_"))))try{const yt=localStorage.getItem(Ve);if(!yt){ye.push(Ve);continue}let $t=null;if(yt.startsWith("{")||yt.startsWith("[")){const Ft=JSON.parse(yt),Ot=Ft.timestamp||Ft.lastSaved||Ft.lastTickAt||Ft.createdAt||Ft.updatedAt||Ft.startedAt||Ft.started_at||Ft.created_at;Ot&&($t=new Date(Ot).getTime())}if(!$t){const Ft=`${Ve}__ts`,Ot=localStorage.getItem(Ft);Ot&&($t=parseInt(Ot)||null)}if(!$t)continue;$t<ue&&ye.push(Ve)}catch{continue}}return ye.forEach(be=>{console.log(`Removing old localStorage key: ${be}`),R(be)}),console.log(`Cleared ${ye.length} old test-related items from localStorage`),{success:!0,clearedCount:ye.length}}catch(xe){return console.error("Error clearing old test data:",xe),{success:!1,error:xe.message}}},setCurrentTest:r,setTestQuestions:s,setStudentAnswers:i,setTestProgress:l,setIsTestActive:d,setTestResults:h,setError:_};return c.jsx(kM.Provider,{value:Tt,children:t})},Nm=()=>{const t=b.useContext(kM);if(!t)throw new Error("useTest must be used within a TestProvider");return t},GT=({testResults:t,onBackToCabinet:e,onRetakeTest:r,isLoading:n=!1,caught_cheating:s=!1,visibility_change_times:a=0})=>{if(!t||!t.showResults)return c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"text-center",children:c.jsx("p",{className:"text-gray-500",children:"No test results to display"})})});const{testInfo:i,testType:o,score:l,totalQuestions:u,percentage:d,passed:g,questionAnalysis:h,timestamp:p}=t,x=S=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[S]||S,v=S=>S>=80?"text-green-600 bg-green-50":S>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",w=S=>S?"text-green-600 bg-green-100 border-green-200":"text-red-600 bg-red-100 border-red-200";return n?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading test results..."})]})}):c.jsx("div",{className:"bg-gray-50 py-8 overflow-y-auto",children:c.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs(Be.div,{className:"bg-white rounded-lg shadow-lg p-6 mb-6",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[((t==null?void 0:t.caught_cheating)||s)&&c.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mb-6",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),c.jsx("div",{className:"ml-3",children:c.jsxs("p",{className:"text-sm text-red-700",children:[c.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",(t==null?void 0:t.visibility_change_times)||a||0," times during the test."]})})]})}),c.jsxs("div",{className:"flex justify-between items-start mb-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Test Results"}),c.jsx("h2",{className:"text-xl text-gray-700 mb-1",children:(i==null?void 0:i.test_name)||"Test"}),c.jsxs("p",{className:"text-sm text-gray-500",children:[x(o),"  Completed on ",new Date(p).toLocaleDateString()]})]}),c.jsx("div",{className:"text-right",children:c.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium border ${w(g)}`,children:g?" PASSED":" FAILED"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsx("div",{className:"text-3xl font-bold text-gray-900",children:l}),c.jsx("div",{className:"text-sm text-gray-600",children:"Correct Answers"})]}),c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsx("div",{className:"text-3xl font-bold text-gray-900",children:u}),c.jsx("div",{className:"text-sm text-gray-600",children:"Total Questions"})]}),c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:`text-3xl font-bold ${v(d).split(" ")[0]}`,children:[d,"%"]}),c.jsx("div",{className:"text-sm text-gray-600",children:"Score"})]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-6",children:c.jsx(Be.div,{className:`h-3 rounded-full ${v(d).split(" ")[1]}`,initial:{width:0},animate:{width:`${d}%`},transition:{duration:1,ease:"easeOut"}})}),c.jsx("div",{className:"flex flex-wrap gap-3",children:c.jsx(He,{onClick:e,variant:"primary",className:"flex items-center gap-2",children:" Back to Cabinet"})})]}),o!=="matching_type"&&o!=="word_matching"&&c.jsxs(Be.div,{className:"bg-white rounded-lg shadow-lg p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[c.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Question Review"}),c.jsx("div",{className:"space-y-4",children:h.map((S,_)=>c.jsxs(Be.div,{className:`p-4 rounded-lg border-2 ${S.isCorrect?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:_*.1},children:[c.jsxs("div",{className:"flex items-start justify-between mb-3",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:["Question ",S.questionNumber]}),c.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${S.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:S.isCorrect?" Correct":" Incorrect"})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Question:"}),c.jsx("p",{className:"text-gray-700 bg-gray-100 p-3 rounded",children:S.question})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Your Answer:"}),c.jsx("p",{className:`p-3 rounded ${S.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:S.userAnswer||"No answer provided"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Correct Answer:"}),c.jsx("p",{className:"bg-blue-100 text-blue-800 p-3 rounded",children:S.correctAnswer})]})]})]},_))})]}),c.jsxs(Be.div,{className:"bg-white rounded-lg shadow-lg p-6 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[c.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Summary Statistics"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-blue-600",children:h.filter(S=>S.isCorrect).length}),c.jsx("div",{className:"text-sm text-blue-600",children:"Correct"})]}),c.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-red-600",children:h.filter(S=>!S.isCorrect).length}),c.jsx("div",{className:"text-sm text-red-600",children:"Incorrect"})]}),c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:"text-2xl font-bold text-gray-600",children:[Math.round(h.filter(S=>S.isCorrect).length/u*100),"%"]}),c.jsx("div",{className:"text-sm text-gray-600",children:"Accuracy"})]}),c.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-purple-600",children:u}),c.jsx("div",{className:"text-sm text-purple-600",children:"Total"})]})]})]})]})})},TM=({isOpen:t,onClose:e,testType:r,testId:n,testName:s,questions:a=[],isLoading:i=!1})=>{if(!t)return null;const o=g=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[g]||g,l=g=>({multiple_choice:"",true_false:"",input:"",matching_type:""})[g]||"",u=(g,h)=>{switch(h){case"multiple_choice":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),c.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[g.option_a&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"A"}),c.jsx("span",{className:"text-gray-700",children:g.option_a})]}),g.option_b&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"B"}),c.jsx("span",{className:"text-gray-700",children:g.option_b})]}),g.option_c&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"C"}),c.jsx("span",{className:"text-gray-700",children:g.option_c})]}),g.option_d&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"D"}),c.jsx("span",{className:"text-gray-700",children:g.option_d})]}),g.option_e&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"E"}),c.jsx("span",{className:"text-gray-700",children:g.option_e})]}),g.option_f&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),c.jsx("span",{className:"text-gray-700",children:g.option_f})]})]})]});case"true_false":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"T"}),c.jsx("span",{className:"text-gray-700",children:"True"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),c.jsx("span",{className:"text-gray-700",children:"False"})]})]})]});case"input":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Answer Format:"}),c.jsx("div",{className:"bg-gray-100 p-3 rounded",children:c.jsx("span",{className:"text-gray-600 italic",children:"Type your answer in the text input field"})})]});case"matching_type":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Instructions:"}),c.jsx("div",{className:"bg-gray-100 p-3 rounded",children:c.jsx("span",{className:"text-gray-600 italic",children:"Match the items by connecting them with lines or selecting pairs"})})]});default:return null}},d=(g,h)=>{if(!g.correct_answer)return null;let p="";switch(h){case"multiple_choice":p=g.correct_answer.toUpperCase();break;case"true_false":p=g.correct_answer?"True":"False";break;case"input":p=g.correct_answer;break;case"matching_type":p=typeof g.correct_answer=="object"?JSON.stringify(g.correct_answer):g.correct_answer;break;default:p=String(g.correct_answer)}return c.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded",children:[c.jsx("p",{className:"font-medium text-green-800 mb-1",children:"Correct Answer:"}),c.jsx("p",{className:"text-green-700 font-mono",children:p})]})};return c.jsx(va,{children:c.jsxs(Be.div,{className:"fixed inset-0 z-50 overflow-y-auto",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[c.jsx(Be.div,{className:"fixed inset-0 bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),c.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:c.jsxs(Be.div,{className:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.3},children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("span",{className:"text-2xl",children:l(r)}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s||"Test Details"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[o(r),"  ",a.length," Questions"]})]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(He,{onClick:()=>window.print(),variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Print"}),c.jsx(He,{onClick:e,variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Close"})]})]}),c.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:i?c.jsx("div",{className:"flex items-center justify-center py-12",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading test details..."})]})}):a.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx("div",{className:"text-6xl mb-4",children:""}),c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Questions Available"}),c.jsx("p",{className:"text-gray-500",children:"This test doesn't have any questions yet."})]}):c.jsx("div",{className:"space-y-6",children:a.map((g,h)=>c.jsxs(Be.div,{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:h*.1,duration:.3},children:[c.jsx("div",{className:"flex items-start justify-between mb-4",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full",children:["Question ",h+1]}),c.jsx("span",{className:"text-gray-500 text-sm",children:o(r)})]})}),c.jsx("div",{className:"mb-4",children:c.jsx("p",{className:"text-gray-800 font-medium text-lg leading-relaxed",children:g.question||g.question_text})}),u(g,r),d(g,r)]},g.id||g.question_id||h))})}),c.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[c.jsx("div",{className:"text-sm text-gray-600",children:a.length>0&&c.jsxs("span",{children:["Showing ",a.length," question",a.length!==1?"s":""]})}),c.jsx("div",{className:"flex items-center space-x-3",children:c.jsx(He,{onClick:e,variant:"primary",className:"flex items-center space-x-2",children:"Close"})})]})]})})]})})},pre=({answeredCount:t=0,totalQuestions:e=0,timeElapsed:r=0,onSubmitTest:n,isSubmitting:s=!1,canSubmit:a=!1,className:i=""})=>{const o=e>0?Math.round(t/e*100):0,l=e-t,u=h=>{const p=Math.floor(h/3600),x=Math.floor(h%3600/60),v=h%60;return p>0?`${p}:${x.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}`:`${x}:${v.toString().padStart(2,"0")}`},d=h=>h>=100?"bg-green-500":h>=80?"bg-blue-500":h>=60?"bg-yellow-500":h>=40?"bg-orange-500":"bg-red-500",g=h=>h>=100?"text-green-600":h>=80?"text-blue-600":h>=60?"text-yellow-600":h>=40?"text-orange-600":"text-red-600";return c.jsxs("div",{className:`bg-white rounded-lg shadow-lg p-6 ${i}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Progress"}),c.jsx("div",{className:"flex items-center space-x-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-2xl",children:""}),c.jsx("span",{className:"text-sm font-mono text-gray-600",children:u(r)})]})})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),c.jsxs("span",{className:`text-sm font-semibold ${g(o)}`,children:[o,"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:c.jsx(Be.div,{className:`h-full ${d(o)} transition-colors duration-300`,initial:{width:0},animate:{width:`${o}%`},transition:{duration:.5,ease:"easeOut"}})})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 mb-4",children:[c.jsxs("div",{className:"text-center p-2 sm:p-3 bg-blue-50 rounded-lg",children:[c.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:t}),c.jsx("div",{className:"text-xs text-blue-600",children:"Answered"})]}),c.jsxs("div",{className:"text-center p-2 sm:p-3 bg-gray-50 rounded-lg",children:[c.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-600",children:l}),c.jsx("div",{className:"text-xs text-gray-600",children:"Remaining"})]}),c.jsxs("div",{className:"text-center p-2 sm:p-3 bg-purple-50 rounded-lg",children:[c.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:e}),c.jsx("div",{className:"text-xs text-purple-600",children:"Total"})]})]}),c.jsx("div",{className:"mb-4",children:t===e?c.jsx(Be.div,{className:"flex items-center justify-center p-3 bg-green-50 border border-green-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:c.jsx("span",{className:"text-green-600 font-medium",children:" All questions answered! Ready to submit."})}):l===1?c.jsx(Be.div,{className:"flex items-center justify-center p-3 bg-yellow-50 border border-yellow-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:c.jsx("span",{className:"text-yellow-600 font-medium",children:"Almost there! 1 question remaining."})}):c.jsx("div",{className:"flex items-center justify-center p-3 bg-gray-50 border border-gray-200 rounded-lg",children:c.jsxs("span",{className:"text-gray-600 font-medium",children:[l," questions remaining"]})})}),a&&c.jsx("div",{className:"flex justify-center",children:c.jsx(Be.button,{onClick:n,disabled:s,className:`px-8 py-3 rounded-lg font-semibold text-white transition-all duration-300 ${s?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 shadow-lg hover:shadow-xl"}`,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},children:s?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),c.jsx("span",{children:"Submitting..."})]}):c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{children:""}),c.jsx("span",{children:"Submit Test"})]})})})]})},xre=({testText:t,blanks:e,separateType:r=!0,testId:n,testName:s="Unknown Test",teacherId:a="Unknown Teacher",subjectId:i,onTestComplete:o,onAnswerChange:l})=>{var z;if(console.log(" FillBlanksTestStudent Props Debug:"),console.log("- testText:",t),console.log("- blanks:",e),console.log("- separateType:",r),console.log("- testId:",n),console.log("- testName:",s),console.log("- teacherId:",a),console.log("- subjectId:",i),!t||!e||!Array.isArray(e))return console.log(" FillBlanksTestStudent: Missing test data"),c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(st,{className:"max-w-md w-full",children:c.jsxs(st.Body,{className:"text-center",children:[c.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load fill blanks test data"}),c.jsx(He,{onClick:()=>window.history.back(),variant:"primary",children:"Back to Dashboard"})]})})});const[u,d]=b.useState({}),[g,h]=b.useState(!1),[p,x]=b.useState(null),[v,w]=b.useState(null),[S,_]=b.useState(!1),[y,k]=b.useState(null),{showNotification:N}=Ys(),{makeAuthenticatedRequest:E}=Ji(),{user:A}=xn(),{startTracking:C,stopTracking:F,getCheatingData:D,clearData:R}=Em("fill_blanks",n,(A==null?void 0:A.student_id)||(A==null?void 0:A.id));Lv();const M=b.useCallback((H,U)=>{try{let L=H;if(typeof H=="string"&&H.startsWith("{"))try{const K=JSON.parse(H);K.root&&K.root.children&&(L=K.root.children.map(Q=>Q.children?Q.children.map(q=>q.style&&q.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":q.text||"").join(""):"").join(" "))}catch(K){console.error("Error parsing Lexical JSON:",K)}let ne=L;U.forEach((K,Q)=>{const q=`[${Q+1}_________]`;ne=ne.replace("[BLANK_PLACEHOLDER]",q)});const G=ne.split(/(\[\d+_________\])/).map((K,Q)=>K.match(/\[\d+_________\]/)?c.jsx("span",{className:"inline-block px-3 py-1 mx-1 bg-purple-100 text-purple-800 border-2 border-purple-400 rounded-lg font-mono font-bold shadow-sm",children:K},Q):c.jsx("span",{children:K},Q));return c.jsx("div",{className:"prose max-w-none mb-6",children:c.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:G})})}catch(L){return console.error("Error rendering text with blanks:",L),c.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[]),B=b.useCallback((H,U)=>{try{let L=H;if(typeof H=="string"&&H.startsWith("{"))try{const K=JSON.parse(H);K.root&&K.root.children&&(L=K.root.children.map(Q=>Q.children?Q.children.map(q=>q.style&&q.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":q.text||"").join(""):"").join(" "))}catch(K){console.error("Error parsing Lexical JSON:",K)}const ne=[];U.forEach((K,Q)=>{const q=u[K.id],se=q?K.options[q.charCodeAt(0)-65]:null,W=se?c.jsx("span",{className:"inline-block px-3 py-2 bg-green-100 text-green-800 rounded-lg border-2 border-green-400 cursor-pointer hover:bg-green-200 hover:border-green-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>w(K.id),children:se},Q):c.jsxs("span",{className:"inline-block px-3 py-2 bg-purple-100 text-purple-800 rounded-lg border-2 border-purple-400 cursor-pointer hover:bg-purple-200 hover:border-purple-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>w(K.id),children:[Q+1,"_________"]},Q);ne.push(W),L=L.replace("[BLANK_PLACEHOLDER]",`__BLANK_${K.id}__`)});const de=L.split(/__BLANK_\d+__/),G=[];for(let K=0;K<de.length;K++)de[K]&&G.push(c.jsx("span",{children:de[K]},`text-${K}`)),K<ne.length&&G.push(ne[K]);return c.jsx("div",{className:"prose max-w-none mb-6",children:c.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:G})})}catch(L){return console.error("Error rendering text with inline blanks:",L),c.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[u]),J=b.useCallback((H,U)=>{const L={...u,[H]:U};d(L),l&&l(H,U)},[u,l]),X=b.useCallback(H=>c.jsx("div",{className:"space-y-6",children:H.map((U,L)=>{const ne=U.blank_options||U.options||[];U.correct_answers;const de=U.question_json||U.question||`Blank ${L+1}`;return console.log(` Blank ${L+1} question text:`,de),c.jsxs(st,{className:"p-4",children:[c.jsxs("div",{className:"mb-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",L+1]}),c.jsx("p",{className:"text-gray-600 mb-4",children:de})]}),c.jsx("div",{className:"space-y-3",children:ne.filter(G=>G&&G.trim().length>0).map((G,K)=>c.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-gray-50 p-2 rounded-lg transition-colors",children:[c.jsx("input",{type:"radio",name:`blank_${U.question_id||U.id||L}`,value:String.fromCharCode(65+K),checked:u[U.question_id||U.id||L]===String.fromCharCode(65+K),onChange:Q=>J(U.question_id||U.id||L,Q.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),c.jsxs("span",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+K)}),c.jsx("span",{className:"text-gray-700",children:G})]})]},K))})]},U.question_id||U.id||L)})}),[u,J]);return b.useEffect(()=>{if(n&&(A!=null&&A.student_id)){x(new Date),C(),console.log(" Anti-cheating tracking started for fill blanks test");const U=`test_progress_${A.student_id}_fill_blanks_${n}`,L=nn(U);L&&(d(L.answers||{}),x(new Date(L.startTime)),console.log(" Fill blanks test progress restored:",L))}},[n,A==null?void 0:A.student_id,e,C]),b.useEffect(()=>{if(p&&(A!=null&&A.student_id)&&n){const H=setInterval(()=>{const U={answers:u,startTime:p.toISOString()},L=`test_progress_${A.student_id}_fill_blanks_${n}`;zr(L,U,Xr.test_progress),console.log(" Fill blanks progress auto-saved")},3e4);return()=>clearInterval(H)}},[p,u,A==null?void 0:A.student_id,n]),b.useEffect(()=>()=>{F(),R(),console.log(" Fill blanks test component unmounted - anti-cheating cleanup")},[F,R]),b.useCallback(async()=>{h(!0);try{const H=e.length;let U=0;e.forEach((Le,te)=>{const Ne=u[Le.id];Ne&&Ne===Le.correct_answer&&U++});const L=U,ne=H;console.log(` Fill Blanks Score: ${L}/${ne} (${Math.round(L/ne*100)}%)`);const de=new Date,G=p?Math.round((de-p)/1e3):0,K=p?p.toISOString():de.toISOString(),Q=D();console.log(" Anti-cheating data for fill blanks submission:",Q);const q=A.student_id,se=`retest_assignment_id_${q}_fill_blanks_${n}`,W=localStorage.getItem(se),ee={test_id:n,test_name:s,teacher_id:a||null,subject_id:i||null,student_id:q,parent_test_id:n,retest_assignment_id:W?Number(W):null,answers:u,score:L,maxScore:ne,time_taken:G,started_at:K,submitted_at:de.toISOString(),caught_cheating:Q.caught_cheating,visibility_change_times:Q.visibility_change_times};console.log(" Submitting fill blanks test:",ee);const _e=await(await E("/.netlify/functions/submit-fill-blanks-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ee)})).json();if(_e.success){if(N("Test submitted successfully!","success"),F(),R(),console.log(" Anti-cheating tracking stopped and data cleared for fill blanks test"),A!=null&&A.student_id&&(oh(A.student_id,"fill_blanks",n),console.log(" Fill blanks test data cleared from cache")),A!=null&&A.student_id){const Le=`test_completed_${A.student_id}_fill_blanks_${n}`;localStorage.setItem(Le,"true"),console.log(" Fill blanks test marked as completed in localStorage:",Le);const te=`retest1_${q}_fill_blanks_${n}`;localStorage.removeItem(te),localStorage.removeItem(se)}if(A!=null&&A.student_id){const Le=`student_results_table_${A.student_id}`;zr(Le,_e,Xr.student_results_table),console.log(" Fill blanks test results cached with key:",Le)}setShowSubmitModal(!1),setTimeout(()=>{o&&o(L)},2e3)}else throw new Error(_e.message||"Failed to submit test")}catch(H){console.error("Error submitting test:",H),N("Error submitting test. Please try again.","error")}finally{h(!1)}},[u,e,n,s,a,i,p,D,F,R,E,N,o,A]),c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:c.jsxs(st,{children:[g&&c.jsx(st.Header,{children:c.jsx("div",{className:"flex items-center justify-center",children:c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[c.jsx(nr,{size:"small"}),c.jsx("span",{children:"Submitting..."})]})})}),c.jsx(st.Body,{children:r===!0?c.jsxs(c.Fragment,{children:[M(t,e),X(e)]}):c.jsx(c.Fragment,{children:B(t,e)})}),r===!1&&v&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Select Answer"}),c.jsx("div",{className:"space-y-2",children:(z=e.find(H=>H.id===v))==null?void 0:z.options.filter(H=>H.trim().length>0).map((H,U)=>c.jsxs("button",{onClick:()=>{J(v,String.fromCharCode(65+U)),w(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-100 rounded-lg border border-gray-200",children:[c.jsxs("span",{className:"font-semibold text-blue-600 mr-2",children:[String.fromCharCode(65+U),")"]}),H]},U))}),c.jsx("div",{className:"mt-4 flex justify-end",children:c.jsx(He,{onClick:()=>w(null),variant:"secondary",size:"sm",children:"Cancel"})})]})}),c.jsx(st.Footer,{children:c.jsx("div",{className:"flex gap-3"})})]})})};let yre=class{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const e=localStorage.getItem(this.userKey);return e?JSON.parse(e):null}setToken(e){localStorage.setItem(this.tokenKey,e)}setRefreshToken(e){localStorage.setItem(this.refreshTokenKey,e)}setUserData(e){localStorage.setItem(this.userKey,JSON.stringify(e))}setTokens(e,r){this.setToken(e),this.setUserData({role:r}),localStorage.setItem("accessToken",e)}isAuthenticated(){const e=this.getToken();if(!e)return!1;try{const r=JSON.parse(atob(e.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const e=this.getUserData();return e?e.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const e=this.getToken();return e?`Bearer ${e}`:null}async makeAuthenticatedRequest(e,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(e,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(e,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const e=this.getRefreshToken();if(!e)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(r.ok){const n=await r.json();return this.setToken(n.accessToken),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(e){try{return JSON.parse(atob(e.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},50*60*1e3)}};const Zf=new yre;window.tokenManager=Zf;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{Zf.init()}):Zf.init());const EM=async(t,e,r,n,s)=>{var a;try{console.log(" Fetching teacher student results:",{teacherId:t,grade:e,className:r,semester:n,academicPeriodId:s});const o=await(await Zf.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-student-results?teacher_id=${t}&grade=${e}&class=${r}&semester=${n}&academic_period_id=${s}`)).json();if(o.success)return console.log(" Teacher student results loaded:",o.results.length,"results"),console.log(" Students loaded:",((a=o.students)==null?void 0:a.length)||0,"students"),{success:!0,results:o.results,students:o.students||[],count:o.results.length,student_count:o.student_count||0};throw new Error(o.error||"Failed to load teacher student results")}catch(i){return console.error("Error fetching teacher student results:",i),{success:!1,error:i.message,results:[]}}},NM=async(t,e)=>{try{console.log(" Fetching student results view:",{studentId:t,academicPeriodId:e});const r=e?`&academic_period_id=${e}`:"",s=await(await Zf.makeAuthenticatedRequest(`/.netlify/functions/get-student-results-view?student_id=${t}${r}`)).json();if(s.success)return console.log(" Student results view loaded:",s.results.length,"results"),{success:!0,results:s.results,count:s.results.length};throw new Error(s.error||"Failed to load student results view")}catch(r){return console.error("Error fetching student results view:",r),{success:!1,error:r.message,results:[]}}},vre=async(t,e,r,n)=>{try{console.log(" Fetching class summary:",{teacherId:t,grade:e,className:r,academicPeriodId:n});const a=await(await Zf.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary?teacher_id=${t}&grade=${e}&class=${r}&academic_period_id=${n}`)).json();if(a.success)return console.log(" Class summary loaded:",a.summary),{success:!0,summary:a.summary,hasData:!!a.summary};throw new Error(a.error||"Failed to load class summary")}catch(s){return console.error("Error fetching class summary:",s),{success:!1,error:s.message,summary:null}}},wre=async(t,e,r,n,s,a={})=>{try{const i=await EM(t,e,r,n,s);if(!i.success)return i;let o=i.results;return a.subject&&(o=o.filter(l=>l.subject&&l.subject.toLowerCase().includes(a.subject.toLowerCase()))),a.testType&&(o=o.filter(l=>l.test_type===a.testType)),a.minScore!==void 0&&(o=o.filter(l=>l.score/l.max_score*100>=a.minScore)),a.maxScore!==void 0&&(o=o.filter(l=>l.score/l.max_score*100<=a.maxScore)),a.passed!==void 0&&(o=o.filter(l=>l.score>=l.passing_score===a.passed)),{success:!0,results:o,count:o.length,originalCount:i.results.length}}catch(i){return console.error("Error filtering teacher student results:",i),{success:!1,error:i.message,results:[]}}},_re=async(t,e,r={})=>{try{const n=await NM(t,e);if(!n.success)return n;let s=n.results;return r.subject&&(s=s.filter(a=>a.subject&&a.subject.toLowerCase().includes(r.subject.toLowerCase()))),r.testType&&(s=s.filter(a=>a.test_type===r.testType)),r.semester&&(s=s.filter(a=>a.semester===r.semester)),r.passed!==void 0&&(s=s.filter(a=>a.score>=a.passing_score===r.passed)),{success:!0,results:s,count:s.length,originalCount:n.results.length}}catch(n){return console.error("Error filtering student results view:",n),{success:!1,error:n.message,results:[]}}},bre={getTeacherStudentResults:EM,getStudentResultsView:NM,getClassSummary:vre,getTeacherStudentResultsFiltered:wre,getStudentResultsViewFiltered:_re};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sre=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),kre=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),i8=t=>{const e=kre(t);return e.charAt(0).toUpperCase()+e.slice(1)},AM=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),Cre=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Tre={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ere=b.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},l)=>b.createElement("svg",{ref:l,...Tre,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:AM("lucide",s),...!a&&!Cre(o)&&{"aria-hidden":"true"},...o},[...i.map(([u,d])=>b.createElement(u,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nh=(t,e)=>{const r=b.forwardRef(({className:n,...s},a)=>b.createElement(Ere,{ref:a,iconNode:e,className:AM(`lucide-${Sre(i8(t))}`,`lucide-${t}`,n),...s}));return r.displayName=i8(t),r};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nre=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Are=Nh("download",Nre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jre=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Fre=Nh("maximize-2",jre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pre=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Dre=Nh("rotate-cw",Pre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rre=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],jM=Nh("x",Rre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mre=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Lre=Nh("zoom-in",Mre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ire=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Ore=Nh("zoom-out",Ire),Bre=()=>{const[t,e]=b.useState({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,isDrawing:!1,currentLine:[],currentShape:null,isFullscreen:!1,preFullscreenState:null}),[r,n]=b.useState([]),s=b.useCallback(u=>{e(d=>({...d,...u}))},[]),a=b.useCallback(()=>{e({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,isDrawing:!1,currentLine:[],currentShape:null,isFullscreen:!1,preFullscreenState:null})},[]),i=b.useCallback(u=>{const d={x:u.x,y:u.y,color:t.currentColor,thickness:t.currentThickness};t.currentTool==="pencil"?e(g=>({...g,isDrawing:!0,currentLine:[d]})):["line","rectangle","circle"].includes(t.currentTool)&&e(g=>({...g,isDrawing:!0,currentShape:{type:t.currentTool,startX:u.x,startY:u.y,endX:u.x,endY:u.y,color:t.currentColor,thickness:t.currentThickness}}))},[t.currentTool,t.currentColor,t.currentThickness]),o=b.useCallback(u=>{if(!t.isDrawing)return;const d={x:u.x,y:u.y,color:t.currentColor,thickness:t.currentThickness};t.currentTool==="pencil"?e(g=>({...g,currentLine:[...g.currentLine,d]})):t.currentShape&&e(g=>({...g,currentShape:{...g.currentShape,endX:u.x,endY:u.y}}))},[t.isDrawing,t.currentTool,t.currentColor,t.currentThickness,t.currentShape]),l=b.useCallback(()=>{t.isDrawing&&(t.currentTool==="pencil"&&t.currentLine.length>0?n(u=>[...u,t.currentLine]):t.currentShape&&n(u=>[...u,t.currentShape]),e(u=>({...u,isDrawing:!1,currentLine:[],currentShape:null})))},[t.isDrawing,t.currentTool,t.currentLine,t.currentShape]);return{drawingState:t,setDrawingState:e,drawingData:r,setDrawingData:n,updateDrawingState:s,resetDrawingState:a,startDrawing:i,continueDrawing:o,finishDrawing:l}},o8={SCALE_DELTA:.05,CENTER_DELTA:20},mf=t=>{if(t.length<2)return 0;const e=t[0],r=t[1];return Math.sqrt(Math.pow(r.clientX-e.clientX,2)+Math.pow(r.clientY-e.clientY,2))},lu=t=>{if(t.length<2)return null;const e=t[0],r=t[1];return{x:(e.clientX+r.clientX)/2,y:(e.clientY+r.clientY)/2}},Ure=(t,e)=>{if(t.length!==2||!e)return null;const r=mf(t),n=mf(e),s=lu(t),a=lu(e);if(n===0)return null;const i=Math.abs(r/n-1),o=Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2));return i>o8.SCALE_DELTA?"zoom":o>o8.CENTER_DELTA?"pan":null},$re=t=>{let e;return function(){const r=arguments,n=this;e&&cancelAnimationFrame(e),e=requestAnimationFrame(()=>{t.apply(n,r),e=null})}},l8=(t,e)=>{const r=e.getPointerPosition();return{x:(r.x-e.x())/e.scaleX(),y:(r.y-e.y())/e.scaleY()}},tu={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",PAN:"pan"},V1={color:"#000000",thickness:2},c8=(t,e,r)=>({x:t.x,y:t.y,color:e||V1.color,thickness:r||V1.thickness}),Wre=(t,e,r,n,s)=>({type:t,startX:e.x,startY:e.y,endX:r.x,endY:r.y,color:n||V1.color,thickness:s||V1.thickness}),zre=(t,e,r,n)=>{const[s,a]=b.useState({isActive:!1,type:null,lastDistance:null,lastCenter:null}),i=b.useCallback(p=>{if(t.currentTool===tu.PAN)return;const x=p.target.getStage(),v=l8(p,x),w=c8(v,t.currentColor,t.currentThickness);t.currentTool===tu.PENCIL?e(S=>({...S,isDrawing:!0,currentLine:[w]})):[tu.LINE,tu.RECTANGLE,tu.CIRCLE].includes(t.currentTool)&&e(S=>({...S,isDrawing:!0,currentShape:Wre(t.currentTool,v,v,t.currentColor,t.currentThickness)}))},[t.currentTool,t.currentColor,t.currentThickness,e]),o=b.useCallback(p=>{if(!t.isDrawing)return;const x=p.target.getStage(),v=l8(p,x),w=c8(v,t.currentColor,t.currentThickness);t.currentTool===tu.PENCIL?e(S=>({...S,currentLine:[...S.currentLine,w]})):t.currentShape&&e(S=>({...S,currentShape:{...S.currentShape,endX:v.x,endY:v.y}}))},[t.isDrawing,t.currentTool,t.currentColor,t.currentThickness,t.currentShape,e]),l=b.useCallback(()=>{t.isDrawing&&(t.currentTool===tu.PENCIL&&t.currentLine.length>0?n(p=>[...p,t.currentLine]):t.currentShape&&n(p=>[...p,t.currentShape]),e(p=>({...p,isDrawing:!1,currentLine:[],currentShape:null})))},[t.isDrawing,t.currentTool,t.currentLine,t.currentShape,n,e]),u=b.useCallback(p=>{p.evt.preventDefault();const x=p.evt.touches;x.length===2?a({isActive:!0,type:null,lastDistance:mf(x),lastCenter:lu(x)}):x.length===1&&i(p)},[mf,lu,i]),d=b.useCallback($re(p=>{p.evt.preventDefault();const x=p.evt.touches;if(x.length===2&&s.isActive){const v=Ure(x,s);if(v==="zoom"){const w=mf(x),S=lu(x),_=w/s.lastDistance,y=Math.max(.25,Math.min(1,t.zoom*_));e(k=>({...k,zoom:y,position:{x:S.x-(S.x-k.position.x)*(y/k.zoom),y:S.y-(S.y-k.position.y)*(y/k.zoom)}}))}else if(v==="pan"){const w=lu(x),S=w.x-s.lastCenter.x,_=w.y-s.lastCenter.y;e(y=>({...y,position:{x:y.position.x+S,y:y.position.y+_}}))}a(w=>({...w,lastDistance:mf(x),lastCenter:lu(x)}))}else x.length===1&&o(p)}),[s,t.zoom,e,o]),g=b.useCallback(p=>{d(p)},[d]),h=b.useCallback(p=>{p.evt.preventDefault();const x=p.evt.touches;x.length===0?(l(),a({isActive:!1,type:null,lastDistance:null,lastCenter:null})):x.length===1&&a(v=>({...v,isActive:!1}))},[l]);return{handleTouchStart:u,handleTouchMove:g,handleTouchEnd:h}},Hre=(t,e)=>{const[r,n]=b.useState(t.MIN),[s,a]=b.useState({x:0,y:0}),i=b.useCallback((h,p,x)=>{const v=Math.max(t.MIN,Math.min(t.MAX,h));if(p){const w=v/r,S={x:p.x-(p.x-s.x)*w,y:p.y-(p.y-s.y)*w};return{zoom:v,position:S}}else{const w=e.width*v,S=e.height*v,_={x:(x.width-w)/2,y:(x.height-S)/2};return{zoom:v,position:_}}},[r,s,t,e]),o=b.useCallback(()=>{const h=Math.min(r*(1+t.STEP),t.MAX);n(h)},[r,t]),l=b.useCallback(()=>{const h=Math.max(r/(1+t.STEP),t.MIN);n(h)},[r,t]),u=b.useCallback((h,p,x)=>{const v=i(h,p,x);n(v.zoom),a(v.position)},[i]),d=b.useCallback((h,p)=>{a(x=>({x:x.x+h,y:x.y+p}))},[]),g=b.useCallback(()=>{n(t.INITIAL),a({x:0,y:0})},[t.INITIAL]);return{zoom:r,setZoom:n,position:s,setPosition:a,handleZoomIn:o,handleZoomOut:l,handleZoomToPoint:u,handlePan:d,resetZoom:g}},Gre=t=>{const[e,r]=b.useState([]),[n,s]=b.useState(0),a=b.useCallback(o=>{if(!(o!=null&&o.answers))return[];try{return typeof o.answers=="string"?JSON.parse(o.answers):Array.isArray(o.answers)?o.answers:[]}catch(l){return console.error("Error parsing drawing data:",l),[]}},[]),i=b.useCallback(o=>Array.isArray(o)?o.map((l,u)=>{let d=[];if(typeof l=="string")try{const g=JSON.parse(l);d=Array.isArray(g)?g:[g]}catch(g){console.error("Error parsing answer JSON:",g),d=[]}else Array.isArray(l)?d=l:d=[l];return console.log(`useDataParsing - processed answer ${u}:`,d),{questionNumber:u+1,drawingData:d}}):[],[]);return b.useEffect(()=>{if(t){console.log("useDataParsing - drawing object:",t),console.log("useDataParsing - drawing.answers:",t.answers);const o=a(t);console.log("useDataParsing - parsed answers:",o);const l=i(o);console.log("useDataParsing - processed questions:",l),r(l),s(0)}},[t,a,i]),{questionsData:e,setQuestionsData:r,currentQuestionIndex:n,setCurrentQuestionIndex:s,parseDrawingData:a,processQuestions:i}},u8={MIN:.25,INITIAL:1},Vre=(t,e)=>{const[r,n]=b.useState(!1),[s,a]=b.useState(null),i=b.useCallback(()=>{document.fullscreenElement||(a({zoom:t.zoom,position:{...t.position}}),document.documentElement.requestFullscreen().then(()=>{n(!0),e(l=>({...l,zoom:u8.MIN,position:{x:0,y:0},isFullscreen:!0}))}).catch(l=>{console.error("Error entering fullscreen:",l)}))},[t.zoom,t.position,e]),o=b.useCallback(()=>{document.fullscreenElement&&document.exitFullscreen().then(()=>{n(!1),s?(e(l=>({...l,zoom:s.zoom,position:s.position,isFullscreen:!1})),a(null)):e(l=>({...l,zoom:u8.INITIAL,position:{x:0,y:0},isFullscreen:!1}))}).catch(l=>{console.error("Error exiting fullscreen:",l)})},[s,e]);return{isFullscreen:r,enterFullscreen:i,exitFullscreen:o}},Fi={WIDTH:1536,HEIGHT:2048,ASPECT_RATIO:1536/2048},FM={MIN:.25,MAX:1,INITIAL:.25,STEP:.1},qo={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",PAN:"pan"},Kre=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500"],PM=b.forwardRef(({drawingData:t,drawingState:e,canvasSize:r,zoom:n,position:s,onTouchStart:a,onTouchMove:i,onTouchEnd:o},l)=>{const u=b.useRef(null),[d,g]=b.useState(.25),[h,p]=b.useState(null);b.useEffect(()=>{const N=r.width??r.WIDTH,E=r.height??r.HEIGHT,A=()=>{const C=u.current;if(!C)return;const F=C.clientWidth||1,D=C.clientHeight||1,R=Math.abs(e.rotation%180)===90,M=R?E:N,B=R?N:E,J=Math.min(F/(M||1),D/(B||1));g(Math.min(J,1))};return A(),window.addEventListener("resize",A),()=>window.removeEventListener("resize",A)},[r.width,r.height,r.WIDTH,r.HEIGHT,e.rotation]);const x=b.useMemo(()=>{const N=u.current;if(!N||!h)return 0;const E=N.clientWidth||1,A=N.clientHeight||1,C=Math.min(E/Math.max(h.width,1),A/Math.max(h.height,1));return Math.min(C,FM.MAX)},[h]),v=b.useMemo(()=>Math.max(n,d||1),[n,d]),w=b.useMemo(()=>{const N=r.width??r.WIDTH,E=r.height??r.HEIGHT;if(!u.current)return{x:0,y:0};const A=u.current.clientWidth||1,C=u.current.clientHeight||1,F=(A-N*v)/2,D=(C-E*v)/2;return n<=d?{x:F,y:D}:{x:s.x!==void 0?s.x:F,y:s.y!==void 0?s.y:D}},[s,n,d,v,r.width,r.height,h,x]);b.useEffect(()=>{if(!Array.isArray(t)||t.length===0){p(null);return}let N=1/0,E=1/0,A=-1/0,C=-1/0;const F=(B,J)=>{Number.isFinite(B)&&Number.isFinite(J)&&(B<N&&(N=B),J<E&&(E=J),B>A&&(A=B),J>C&&(C=J))};if(t.forEach(B=>{if(Array.isArray(B))B.forEach(J=>F(J.x,J.y));else if(B&&typeof B=="object"){if(B.type==="line")F(B.startX,B.startY),F(B.endX,B.endY);else if(B.type==="rectangle")F(B.startX,B.startY),F(B.endX,B.endY);else if(B.type==="circle"){const J=Math.sqrt(Math.pow(B.endX-B.startX,2)+Math.pow(B.endY-B.startY,2))/2,X=(B.startX+B.endX)/2,z=(B.startY+B.endY)/2;F(X-J,z-J),F(X+J,z+J)}}}),!Number.isFinite(N)||!Number.isFinite(E)||!Number.isFinite(A)||!Number.isFinite(C)){p(null);return}const D=16,R=Math.max(1,A-N+D*2),M=Math.max(1,C-E+D*2);p({minX:N-D,minY:E-D,width:R,height:M})},[t]),b.useEffect(()=>{console.log("CanvasViewer - drawingData:",t),console.log("CanvasViewer - drawingData length:",t==null?void 0:t.length),t&&t.length>0&&console.log("CanvasViewer - first item:",t[0])},[t]),b.useEffect(()=>{const N=r.width??r.WIDTH,E=r.height??r.HEIGHT;console.log("CanvasViewer - canvas dimensions:",{width:N,height:E}),console.log("CanvasViewer - zoom:",n,"fitZoom:",d,"displayScale:",v),console.log("CanvasViewer - stagePosition:",w)},[r,n,d,v,w]);const S=(N,E)=>{var A,C;if(console.log(`CanvasViewer - rendering element ${E}:`,N),Array.isArray(N))return console.log(`CanvasViewer - rendering line with ${N.length} points`),c.jsx(hi,{points:N.flatMap(F=>[F.x,F.y]),stroke:((A=N[0])==null?void 0:A.color)||"#000000",strokeWidth:((C=N[0])==null?void 0:C.thickness)||2,tension:.5,lineCap:"round",lineJoin:"round"},E);if(N.type==="line")return c.jsx(hi,{points:[N.startX,N.startY,N.endX,N.endY],stroke:N.color,strokeWidth:N.thickness,lineCap:"round"},E);if(N.type==="rectangle"){const F=Math.abs(N.endX-N.startX),D=Math.abs(N.endY-N.startY),R=Math.min(N.startX,N.endX),M=Math.min(N.startY,N.endY);return c.jsx(sa,{x:R,y:M,width:F,height:D,stroke:N.color,strokeWidth:N.thickness,fill:"transparent"},E)}else if(N.type==="circle"){const F=Math.sqrt(Math.pow(N.endX-N.startX,2)+Math.pow(N.endY-N.startY,2))/2,D=(N.startX+N.endX)/2,R=(N.startY+N.endY)/2;return c.jsx(Kf,{x:D,y:R,radius:F,stroke:N.color,strokeWidth:N.thickness,fill:"transparent"},E)}return null},_=()=>{if(!e.isDrawing)return null;if(e.currentTool===qo.PENCIL&&e.currentLine.length>0)return c.jsx(hi,{points:e.currentLine.flatMap(N=>[N.x,N.y]),stroke:e.currentColor,strokeWidth:e.currentThickness,tension:.5,lineCap:"round",lineJoin:"round"});if(e.currentShape){const{type:N,startX:E,startY:A,endX:C,endY:F,color:D,thickness:R}=e.currentShape;if(N===qo.LINE)return c.jsx(hi,{points:[E,A,C,F],stroke:D,strokeWidth:R,lineCap:"round"});if(N===qo.RECTANGLE){const M=Math.abs(C-E),B=Math.abs(F-A),J=Math.min(E,C),X=Math.min(A,F);return c.jsx(sa,{x:J,y:X,width:M,height:B,stroke:D,strokeWidth:R,fill:"transparent"})}else if(N===qo.CIRCLE){const M=Math.sqrt(Math.pow(C-E,2)+Math.pow(F-A,2))/2,B=(E+C)/2,J=(A+F)/2;return c.jsx(Kf,{x:B,y:J,radius:M,stroke:D,strokeWidth:R,fill:"transparent"})}}return null},y=e.isFullscreen?{position:"fixed",inset:0,width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",zIndex:60}:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent"},k={transform:`rotate(${e.rotation}deg)`,transformOrigin:"center center"};return c.jsx("div",{style:y,ref:u,children:c.jsx("div",{style:k,children:c.jsx(Lu,{ref:l,width:Math.max((r.width??r.WIDTH)||0,1536),height:Math.max((r.height??r.HEIGHT)||0,2048),scaleX:v,scaleY:v,x:w.x,y:w.y,onTouchStart:a,onTouchMove:i,onTouchEnd:o,children:c.jsxs(Mu,{children:[c.jsx(sa,{x:0,y:0,width:Math.max((r.width??r.WIDTH)||0,1536),height:Math.max((r.height??r.HEIGHT)||0,2048),fill:"white"}),t.map((N,E)=>(console.log(`CanvasViewer - mapping item ${E}:`,N),S(N,E))),_()]})})})})});PM.displayName="CanvasViewer";function Xre({containerRef:t,canvasSize:e,rotation:r=0}){const[n,s]=b.useState(1),[a,i]=b.useState({x:0,y:0}),o=b.useRef({width:1,height:1}),l=b.useRef(.01),u=b.useRef(0),d=b.useRef(!1),g=b.useCallback(()=>{const k=(e==null?void 0:e.width)??(e==null?void 0:e.WIDTH)??0,N=(e==null?void 0:e.height)??(e==null?void 0:e.HEIGHT)??0,E=Math.abs(r%180)===90;return{width:E?N:k,height:E?k:N}},[e,r]),h=b.useCallback(()=>{const k=t==null?void 0:t.current;if(!k)return{width:1,height:1};const N=k.clientWidth||1,E=k.clientHeight||1;return o.current={width:N,height:E},{width:N,height:E}},[t]),p=b.useCallback(()=>{const{width:k,height:N}=o.current,{width:E,height:A}=g(),C=k/Math.max(E,1),F=N/Math.max(A,1);return Math.min(C,F,1)*.98},[g]),x=b.useCallback(k=>{const{width:N,height:E}=o.current,{width:A,height:C}=g(),F=Math.max(l.current,Math.min(k,1.5));let D=(N-A*F)/2,R=(E-C*F)/2;const M=N-A*F,B=E-C*F;D=Math.min(Math.max(0,D),Math.max(0,M)),R=Math.min(Math.max(0,R),Math.max(0,B));try{console.log("[Camera] centerAtScale",{targetScale:k,clampedScale:F,container:{containerW:N,containerH:E},canvas:{canvasW:A,canvasH:C},translate:{x:D,y:R},rotation:r})}catch{}i({x:D,y:R}),s(F)},[g]),v=b.useCallback(()=>{const{width:k,height:N}=h(),{width:E,height:A}=g(),C=p();let F=(k-E*C)/2,D=(N-A*C)/2;const R=k-E*C,M=N-A*C;F=Math.min(Math.max(0,F),Math.max(0,R)),D=Math.min(Math.max(0,D),Math.max(0,M));try{console.log("[Camera] fitCanvas",{scale:C,container:{containerW:k,containerH:N},canvas:{canvasW:E,canvasH:A},translate:{x:F,y:D},rotation:r})}catch{}s(C),i({x:F,y:D}),l.current=C,d.current=!1},[g,h,p]),w=b.useCallback(()=>{const{width:k,height:N}=h(),{width:E,height:A}=g(),C=(k-E)/2,F=(N-A)/2;s(1),i({x:C,y:F})},[g,h]),S=b.useCallback((k,N)=>{const{width:E,height:A}=o.current,{width:C,height:F}=g(),D=Math.max(l.current,Math.min(k,1.5));if(N&&Number.isFinite(N.x)&&Number.isFinite(N.y)){const R={x:(N.x-a.x)/n,y:(N.y-a.y)/n},M=N.x-R.x*D,B=N.y-R.y*D;try{console.log("[Camera] zoomTo(pointer) ->",{from:n,to:D})}catch{}s(D),i({x:M,y:B}),u.current=Date.now()+400,d.current=!0}else{let R=(E-C*D)/2,M=(A-F*D)/2;const B=E-C*D,J=A-F*D;R=Math.min(Math.max(0,R),Math.max(0,B)),M=Math.min(Math.max(0,M),Math.max(0,J));try{console.log("[Camera] zoomTo(center) ->",{from:n,to:D})}catch{}s(D),i({x:R,y:M}),u.current=Date.now()+400,d.current=!0}},[g,n,a]),_=b.useCallback((k,N)=>{const E=n*k,{width:A,height:C}=o.current,F={x:A/2,y:C/2};S(E,N||F)},[n,S]),y=b.useCallback((k,N)=>{i(E=>({x:E.x+k,y:E.y+N})),u.current=Date.now()+200,d.current=!0},[]);return b.useEffect(()=>{const k=t==null?void 0:t.current;if(!k)return;const N=new ResizeObserver(()=>{h();const E=p();if(l.current=E,!(Date.now()<u.current)&&!d.current){try{console.log("[Camera] resize centerAtScale",{scale:n})}catch{}x(n)}});return N.observe(k),h(),()=>N.disconnect()},[t,h,p,x,n]),b.useEffect(()=>{d.current=!1,l.current=p(),x(n)},[r,e==null?void 0:e.width,e==null?void 0:e.height,e==null?void 0:e.WIDTH,e==null?void 0:e.HEIGHT,p,x,n]),b.useMemo(()=>({scale:n,translate:a,setScale:s,setTranslate:i,centerAtScale:x,fitCanvas:v,oneToOne:w,zoomTo:S,zoomByFactor:_,panBy:y}),[n,a,x,v,w,S,_,y])}const g0=new Map,DM=b.forwardRef(({drawingData:t,canvasSize:e,rotation:r=0,onScaleChange:n,persistKey:s="viewer"},a)=>{const i=b.useRef(null),o=b.useRef(null),l=Xre({containerRef:i,canvasSize:e,rotation:r}),[u,d]=b.useState({width:1,height:1}),g=b.useRef(null),h=b.useRef(null),[p,x]=b.useState(null);b.useEffect(()=>{typeof n=="function"&&n(l.scale);try{console.log("[ViewerCanvas] scale changed",{scale:l.scale})}catch{}if(s){const R=g0.get(s)||{};g0.set(s,{...R,scale:l.scale})}},[l.scale,n]),b.useEffect(()=>{if(s){const R=g0.get(s)||{};g0.set(s,{...R,translate:{x:l.translate.x,y:l.translate.y}})}},[s,l.translate.x,l.translate.y]),b.useImperativeHandle(a,()=>({zoomIn:R=>l.zoomByFactor(1.1,R),zoomOut:R=>l.zoomByFactor(1/1.1,R),fitCanvas:()=>l.fitCanvas(),oneToOne:()=>l.oneToOne(),getScale:()=>l.scale,getStage:()=>o.current,getPointerPosition:()=>{var R,M;return(M=(R=o.current)==null?void 0:R.getPointerPosition)==null?void 0:M.call(R)},exportPNGFullCanvas:()=>{const R=o.current;if(!R)return null;const M=(e==null?void 0:e.width)??(e==null?void 0:e.WIDTH)??1536,B=(e==null?void 0:e.height)??(e==null?void 0:e.HEIGHT)??2048,J={scaleX:R.scaleX(),scaleY:R.scaleY(),x:R.x(),y:R.y(),width:R.width(),height:R.height()},X=g.current,z=h.current,H=X?{x:X.x(),y:X.y(),scaleX:X.scaleX(),scaleY:X.scaleY()}:null,U=z?{x:z.x(),y:z.y(),rotation:z.rotation()}:null;try{return R.scale({x:1,y:1}),R.position({x:0,y:0}),R.size({width:M,height:B}),X&&(X.position({x:0,y:0}),X.scale({x:1,y:1})),z&&(z.position({x:0,y:0}),z.rotation(0)),R.batchDraw(),R.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:M,height:B})}finally{z&&U&&(z.position({x:U.x,y:U.y}),z.rotation(U.rotation)),X&&H&&(X.position({x:H.x,y:H.y}),X.scale({x:H.scaleX,y:H.scaleY})),R.scale({x:J.scaleX,y:J.scaleY}),R.position({x:J.x,y:J.y}),R.size({width:J.width,height:J.height}),R.batchDraw()}}}),[l]),b.useEffect(()=>{const R=i.current;if(!R)return;const M=()=>{d({width:R.clientWidth||1,height:R.clientHeight||1})};M();const B=new ResizeObserver(M);return B.observe(R),()=>B.disconnect()},[]),b.useEffect(()=>{if(!Array.isArray(t)||t.length===0){x(null);return}let R=1/0,M=1/0,B=-1/0,J=-1/0;const X=(L,ne)=>{Number.isFinite(L)&&Number.isFinite(ne)&&(L<R&&(R=L),ne<M&&(M=ne),L>B&&(B=L),ne>J&&(J=ne))};if(t.forEach(L=>{if(Array.isArray(L))L.forEach(ne=>X(ne.x,ne.y));else if(L&&typeof L=="object"){if(L.type==="line")X(L.startX,L.startY),X(L.endX,L.endY);else if(L.type==="rectangle")X(L.startX,L.startY),X(L.endX,L.endY);else if(L.type==="circle"){const ne=Math.hypot(L.endX-L.startX,L.endY-L.startY)/2,de=(L.startX+L.endX)/2,G=(L.startY+L.endY)/2;X(de-ne,G-ne),X(de+ne,G+ne)}}}),!Number.isFinite(R)||!Number.isFinite(M)||!Number.isFinite(B)||!Number.isFinite(J)){x(null);return}const z=16,H=Math.max(1,B-R+z*2),U=Math.max(1,J-M+z*2);x({minX:R-z,minY:M-z,width:H,height:U,centerX:R-z+H/2,centerY:M-z+U/2})},[t]);const v=b.useMemo(()=>{if(!p)return{scale:1,x:0,y:0};const R=(e==null?void 0:e.width)??(e==null?void 0:e.WIDTH)??1536,M=(e==null?void 0:e.height)??(e==null?void 0:e.HEIGHT)??2048,B=Math.min(R/Math.max(1,p.width),M/Math.max(1,p.height),1),J=p.width*B,X=p.height*B,z=(R-J)/2,H=(M-X)/2,U=z-p.minX*B,L=H-p.minY*B;return{scale:B,x:U,y:L}},[p,e==null?void 0:e.width,e==null?void 0:e.height,e==null?void 0:e.WIDTH,e==null?void 0:e.HEIGHT]),w=b.useRef(!1);b.useEffect(()=>{if(w.current)return;const R=s?g0.get(s):null;R&&Number.isFinite(R.scale)&&R.translate&&Number.isFinite(R.translate.x)&&Number.isFinite(R.translate.y)?(l.setScale(R.scale),l.setTranslate(R.translate)):l.fitCanvas(),w.current=!0},[s,l]),b.useEffect(()=>{try{console.log("[ViewerCanvas] rotation changed",{rotation:r,scale:l.scale,translate:l.translate})}catch{}l.fitCanvas()},[r]),b.useEffect(()=>{l.centerAtScale(l.scale)},[r]);const S=R=>{R.evt.preventDefault();const M=o.current;if(!M)return;const B=M.getPointerPosition(),J=Math.pow(1.0015,-R.evt.deltaY);l.zoomByFactor(J,B)},_=b.useRef(!1),y=b.useRef({x:0,y:0}),k=()=>{const R=i.current;if(!R)return 1;const M=R.clientWidth||1,B=R.clientHeight||1,J=(e==null?void 0:e.width)??(e==null?void 0:e.WIDTH)??1,X=(e==null?void 0:e.height)??(e==null?void 0:e.HEIGHT)??1,z=Math.abs(r%180)===90,H=z?X:J,U=z?J:X,L=Math.min(M/H,B/U);return Math.min(L,1)},N=R=>{const M=k();l.scale<=M||(_.current=!0,y.current={x:R.evt.clientX,y:R.evt.clientY})},E=R=>{if(!_.current)return;const M=R.evt.clientX-y.current.x,B=R.evt.clientY-y.current.y;y.current={x:R.evt.clientX,y:R.evt.clientY},l.panBy(M,B)},A=()=>{_.current=!1},C=1536,F=2048,D=(R,M)=>{var B,J;if(Array.isArray(R))return c.jsx(hi,{points:R.flatMap(X=>[X.x,X.y]),stroke:((B=R[0])==null?void 0:B.color)||"#000000",strokeWidth:((J=R[0])==null?void 0:J.thickness)||2,tension:.5,lineCap:"round",lineJoin:"round"},M);if((R==null?void 0:R.type)==="line")return c.jsx(hi,{points:[R.startX,R.startY,R.endX,R.endY],stroke:R.color,strokeWidth:R.thickness,lineCap:"round"},M);if((R==null?void 0:R.type)==="rectangle"){const X=Math.abs(R.endX-R.startX),z=Math.abs(R.endY-R.startY),H=Math.min(R.startX,R.endX),U=Math.min(R.startY,R.endY);return c.jsx(sa,{x:H,y:U,width:X,height:z,stroke:R.color,strokeWidth:R.thickness,fill:"transparent"},M)}else if((R==null?void 0:R.type)==="circle"){const X=Math.sqrt(Math.pow(R.endX-R.startX,2)+Math.pow(R.endY-R.startY,2))/2,z=(R.startX+R.endX)/2,H=(R.startY+R.endY)/2;return c.jsx(Kf,{x:z,y:H,radius:X,stroke:R.color,strokeWidth:R.thickness,fill:"transparent"},M)}return null};return c.jsx("div",{ref:i,style:{width:"100%",height:"100%",display:"block",backgroundColor:"transparent"},children:c.jsx(Lu,{ref:o,width:u.width,height:u.height,onWheel:S,onMouseDown:N,onMouseMove:E,onMouseUp:A,onMouseLeave:A,children:c.jsx(Mu,{children:c.jsx(tl,{ref:g,x:l.translate.x,y:l.translate.y,scaleX:l.scale,scaleY:l.scale,children:(()=>{const R=(r%360+360)%360;let M=0,B=0;R===90?M=F:R===180?(M=C,B=F):R===270&&(B=C);try{console.log("[ViewerCanvas] rotatedGroup offset",{rotation:r,norm:R,tx:M,ty:B,canvasW:C,canvasH:F})}catch{}return c.jsxs(tl,{ref:h,x:M,y:B,rotation:r,children:[c.jsx(sa,{x:0,y:0,width:C,height:F,fill:"white"}),c.jsx(tl,{x:v.x,y:v.y,scaleX:v.scale,scaleY:v.scale,children:Array.isArray(t)?t.map((J,X)=>D(J,X)):null})]})})()})})})})});DM.displayName="ViewerCanvas";const Yre=({currentTool:t,currentColor:e,onToolChange:r,onColorChange:n})=>{const s=[{id:qo.PENCIL,icon:"",label:"Pencil"},{id:qo.LINE,icon:"",label:"Line"},{id:qo.RECTANGLE,icon:"",label:"Rectangle"},{id:qo.CIRCLE,icon:"",label:"Circle"},{id:qo.PAN,icon:"",label:"Pan"}],a=Kre;return c.jsxs("div",{className:"absolute top-4 left-4 flex flex-col space-y-2",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-2 flex flex-col space-y-1",children:[c.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Tools"}),s.map(i=>c.jsx("button",{className:`w-10 h-10 flex items-center justify-center rounded-lg transition-all duration-200 ${t===i.id?"bg-blue-500 text-white shadow-md":"bg-gray-100 hover:bg-gray-200 text-gray-700"}`,onClick:()=>r(i.id),title:i.label,children:c.jsx("span",{className:"text-lg",children:i.icon})},i.id))]}),c.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-2 flex flex-col space-y-1",children:[c.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Colors"}),c.jsx("div",{className:"grid grid-cols-2 gap-1",children:a.map(i=>c.jsx("button",{className:`w-8 h-8 rounded-lg border-2 transition-all duration-200 ${e===i?"border-gray-800 shadow-md scale-110":"border-gray-300 hover:border-gray-500 hover:scale-105"}`,style:{backgroundColor:i},onClick:()=>n(i),title:i},i))})]})]})},Jre=({zoom:t,onZoomIn:e,onZoomOut:r,onRotate:n,onDownload:s,onFullscreen:a,isFullscreen:i})=>c.jsxs("div",{className:"absolute top-4 right-4 flex flex-col space-y-2 items-center justify-center",children:[c.jsx(He,{onClick:e,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom In",children:c.jsx(Lre,{className:"w-4 h-4 mx-auto my-auto"})}),c.jsx(He,{onClick:r,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom Out",children:c.jsx(Ore,{className:"w-4 h-4 mx-auto my-auto"})}),c.jsx(He,{onClick:n,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Rotate",children:c.jsx(Dre,{className:"w-4 h-4 mx-auto my-auto"})}),c.jsx(He,{onClick:s,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Download",children:c.jsx(Are,{className:"w-4 h-4 mx-auto my-auto"})}),c.jsx(He,{onClick:a,variant:"secondary",size:"icon",className:"w-10 h-10",title:i?"Exit Fullscreen":"Enter Fullscreen",children:i?c.jsx(jM,{className:"w-4 h-4 mx-auto my-auto"}):c.jsx(Fre,{className:"w-4 h-4 mx-auto my-auto"})})]}),Qre=({currentQuestion:t,totalQuestions:e,onPrevious:r,onNext:n,drawingDataLength:s})=>e<=1?null:c.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(He,{onClick:r,disabled:t===0,variant:"outline",size:"sm",children:"Previous"}),c.jsxs("span",{className:"text-sm text-gray-600",children:["Question ",t+1," of ",e]}),c.jsx(He,{onClick:n,disabled:t===e-1,variant:"outline",size:"sm",children:"Next"})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[s," lines"]})]})}),RM=({drawing:t,isOpen:e,onClose:r,onScoreChange:n,onMaxScoreChange:s,isTeacherView:a=!1})=>{var de,G;const{drawingState:i,setDrawingState:o,drawingData:l,setDrawingData:u}=Bre(),{questionsData:d,currentQuestionIndex:g,setCurrentQuestionIndex:h}=Gre(t),{zoom:p,position:x,handleZoomIn:v,handleZoomOut:w}=Hre(FM,Fi),{isFullscreen:S,enterFullscreen:_,exitFullscreen:y}=Vre(i,o),{handleTouchStart:k,handleTouchMove:N,handleTouchEnd:E}=zre(i,o,l,u),A=b.useRef(null),C=b.useRef(null),[F,D]=b.useState(1),[R,M]=b.useState(""),[B,J]=b.useState("");b.useEffect(()=>{var K;if(console.log("DrawingModal - questionsData:",d),console.log("DrawingModal - currentQuestionIndex:",g),d.length>0){const Q=((K=d[g])==null?void 0:K.drawingData)||[];console.log("DrawingModal - setting drawingData:",Q),u(Q)}},[d,g,u]),b.useEffect(()=>{var K,Q;e&&t&&(M(((K=t.score)==null?void 0:K.toString())||""),J(((Q=t.max_score)==null?void 0:Q.toString())||"100"))},[e,t]);const X=()=>{g>0&&h(g-1)},z=()=>{g<d.length-1&&h(g+1)},H=K=>{o(Q=>({...Q,currentTool:K}))},U=K=>{o(Q=>({...Q,currentColor:K}))},L=()=>{o(K=>({...K,rotation:(K.rotation+90)%360}))},ne=()=>{if(a&&C.current){const se=C.current.exportPNGFullCanvas();if(!se)return;const W=document.createElement("a");W.href=se,W.download=`drawing-${(t==null?void 0:t.name)||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(W),W.click(),document.body.removeChild(W);return}const K=A.current;if(!K)return;const Q=K.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:Fi.WIDTH,height:Fi.HEIGHT}),q=document.createElement("a");q.href=Q,q.download=`drawing-${(t==null?void 0:t.name)||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(q),q.click(),document.body.removeChild(q)};return!e||!t?null:c.jsx(va,{children:c.jsx(Be.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,children:c.jsxs(Be.div,{className:"bg-white rounded-lg shadow-xl max-w-4xl h-[90vh] w-full mx-4 flex flex-col",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:K=>K.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Drawing Submission"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[t.name," ",t.surname," - ",t.test_name]})]}),c.jsx(He,{onClick:r,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-600",children:c.jsx(jM,{className:"w-5 h-5"})})]}),d.length>1&&c.jsx(Qre,{currentQuestion:g,totalQuestions:d.length,onPrevious:X,onNext:z,drawingDataLength:((G=(de=d[g])==null?void 0:de.drawingData)==null?void 0:G.length)||0}),c.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[c.jsxs("div",{className:"flex-1 min-h-0 relative overflow-hidden bg-gray-100 p-4",children:[a?c.jsx(DM,{ref:C,drawingData:l,canvasSize:{width:Fi.WIDTH,height:Fi.HEIGHT,WIDTH:Fi.WIDTH,HEIGHT:Fi.HEIGHT},rotation:i.rotation,onScaleChange:D}):c.jsx(PM,{ref:A,drawingData:l,drawingState:i,canvasSize:{width:Fi.WIDTH,height:Fi.HEIGHT,WIDTH:Fi.WIDTH,HEIGHT:Fi.HEIGHT},zoom:p,position:x,onTouchStart:k,onTouchMove:N,onTouchEnd:E}),!a&&c.jsx(Yre,{currentTool:i.currentTool,currentColor:i.currentColor,onToolChange:H,onColorChange:U}),c.jsx(Jre,{zoom:a?F:p,onZoomIn:()=>{var K,Q;if(a&&C.current){try{console.log("[ZoomButton] ZoomIn click (teacher)",{before:(Q=(K=C.current).getScale)==null?void 0:Q.call(K)})}catch{}C.current.zoomIn(void 0),setTimeout(()=>{var q,se;try{console.log("[ZoomButton] ZoomIn after",{after:(se=(q=C.current).getScale)==null?void 0:se.call(q)})}catch{}},0)}else v()},onZoomOut:()=>{var K,Q;if(a&&C.current){try{console.log("[ZoomButton] ZoomOut click (teacher)",{before:(Q=(K=C.current).getScale)==null?void 0:Q.call(K)})}catch{}C.current.zoomOut(void 0),setTimeout(()=>{var q,se;try{console.log("[ZoomButton] ZoomOut after",{after:(se=(q=C.current).getScale)==null?void 0:se.call(q)})}catch{}},0)}else w()},onRotate:L,onDownload:ne,onFullscreen:S?y:_,isFullscreen:S}),c.jsxs("div",{className:"absolute bottom-4 left-4 bg-gray-800 bg-opacity-70 text-white px-3 py-1 rounded-full text-sm",children:[Math.round((a?F:p)*100),"%"]})]}),!1]})]})})})},MM=({testType:t,testId:e,studentAnswers:r,onBackToCabinet:n,compact:s=!1,showAll:a=!1,onToggleShowAll:i,maxInitial:o=3})=>{const l=Ha(),{user:u,isAuthenticated:d}=xn(),{testResults:g,loadTestResults:h}=Nm(),[p,x]=b.useState(!0),[v,w]=b.useState(""),[S,_]=b.useState([]),[y,k]=b.useState([]),[N,E]=b.useState(null),[A,C]=b.useState([]),[F,D]=b.useState(0),[R,M]=b.useState(0),[B,J]=b.useState(!1),[X,z]=b.useState(null);b.useEffect(()=>{H()},[t,e]),b.useEffect(()=>{!t&&!e&&(g&&g.results?(console.log(" Using cached test results from TestContext"),k(g.results),x(!1)):L())},[t,e,g]);const H=b.useCallback(async()=>{console.log(" Initializing Student Results...");try{if(x(!0),w(""),!d||!u){console.log(" User not authenticated"),w("User not authenticated");return}if(u.role!==ra.STUDENT){console.error(" Invalid user role for student results:",u.role),w("Access denied. Student role required.");return}console.log(" Loading test results..."),await h((u==null?void 0:u.student_id)||(u==null?void 0:u.id)||""),t&&e&&r&&(console.log(" Loading specific test results..."),await U(t,e,r)),console.log(" Student Results initialization complete!")}catch(se){console.error(" Error initializing student results:",se),w("Failed to initialize student results")}finally{x(!1)}},[d,u,t,e,r,h]),U=b.useCallback(async(se,W,ee)=>{console.log(" Loading specific test results:",se,W);try{const ve=await Tr.getTestInfo(se,W);console.log(" Test info loaded:",ve),E(ve);const _e=await Tr.getTestQuestions(se,W);console.log(" Test questions loaded:",_e),C(_e);const Le=fc(_e,ee,se).score,te=_e.length>0?Math.round(Le/_e.length*100):0;D(Le),M(te),console.log(" Test results calculated:",{score:Le,percentage:te})}catch(ve){throw console.error(" Error loading specific test results:",ve),ve}},[]),L=b.useCallback(async(se=0)=>{console.log(" Loading all student results using existing test results API...",se>0?`(retry ${se})`:"");try{if(!((u==null?void 0:u.student_id)||(u==null?void 0:u.sub)))throw new Error("Student ID not found");const ee=await Tr.getStudentTestResults();if(ee.success){console.log(" All student results loaded:",ee.results.length,"results");const ve=ee.results.map(_e=>({..._e,caught_cheating:_e.caught_cheating||!1,visibility_change_times:_e.visibility_change_times||0}));k(ve),z(new Date),ee.results.length===0&&se===0&&(console.log(" No results found, retrying in 2 seconds..."),setTimeout(()=>{L(1)},2e3))}else throw new Error(ee.error||"Failed to load student results")}catch(W){console.error(" Error loading all student results:",W),w(W.message)}},[u]),ne=b.useCallback(se=>({"Listening and Speaking":"L&S","Reading and Writing":"R&W","English for Career":"Eng for Career","Science Fundamental":"Science F","Science Supplementary":"Science S","Math Fundamental":"Math F","Math Supplementary":"Math S","English for Communication":"Eng for Comm"})[se]||se,[]),de=b.useCallback(se=>{if(!se||se.length===0)return c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No results available"})});const W=a?se:se.slice(0,o);return c.jsxs("div",{className:"overflow-x-auto",children:[c.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Result"}),c.jsx("th",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:W.map((ee,ve)=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs font-medium text-gray-900",children:c.jsx("span",{className:"bg-blue-100 text-blue-800 px-0.5 sm:px-2 py-0.5 rounded text-xs",children:ne(ee.subject)})}),c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-12 sm:max-w-none",children:ee.teacher_name}),c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-16 sm:max-w-none",children:ee.test_name}),c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500",children:c.jsx("div",{className:"flex flex-col items-center space-y-1",children:ee.test_type==="drawing"?ee.score!==null?c.jsxs("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${Math.round(ee.score/ee.max_score*100)>=80?"bg-green-100 text-green-800":Math.round(ee.score/ee.max_score*100)>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[ee.score,"/",ee.max_score," (",Math.round(ee.score/ee.max_score*100),"%)"]}):c.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):c.jsxs("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${Math.round(ee.score/ee.max_score*100)>=80?"bg-green-100 text-green-800":Math.round(ee.score/ee.max_score*100)>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[ee.score,"/",ee.max_score," (",Math.round(ee.score/ee.max_score*100),"%)"]})})}),c.jsx("td",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:new Date(ee.submitted_at).toLocaleDateString()})]},ve))})]}),se.length>o&&i&&c.jsx("div",{className:"text-center pt-4",children:c.jsx("button",{onClick:i,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:a?"Show Less":`Show ${se.length-o} More`})})]})},[ne,a,o,i]),G=b.useCallback((se,W)=>{if(console.log(" formatAnswer called with:",{answer:se,testType:W,answerType:typeof se}),!se)return"No answer";switch(W){case"true_false":const ee=typeof se=="boolean"?se:se==="true";return console.log(" Boolean answer processed:",ee),ee?"True":"False";case"multiple_choice":return se.toUpperCase();case"input":return se;case"word_matching":return typeof se=="object"?Object.entries(se).map(([ve,_e])=>`${ve}  ${_e}`).join(", "):se;case"drawing":return"Drawing submitted";default:return se}},[]),K=b.useCallback(()=>!N||!A||!r?null:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:["Test Results: ",N.test_name||N.title||"Test"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-3xl font-bold text-blue-600",children:F}),c.jsx("p",{className:"text-sm text-gray-500",children:"Correct Answers"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-3xl font-bold text-gray-900",children:A.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Total Questions"})]}),c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:`text-3xl font-bold ${R>=80?"text-green-600":R>=60?"text-yellow-600":"text-red-600"}`,children:[R,"%"]}),c.jsx("p",{className:"text-sm text-gray-500",children:"Score"})]})]})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Questions Review"}),c.jsx("div",{className:"space-y-4",children:A.map((se,W)=>{const ee=r[W],ve=Lg(se,t),_e=qf(se,ee,t);return c.jsxs("div",{className:`border rounded-lg p-4 ${_e?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsxs("h4",{className:"font-medium text-gray-900",children:["Question ",W+1]}),c.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${_e?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:_e?"Correct":"Incorrect"})]}),c.jsx("p",{className:"text-gray-700 mb-3",children:se.question}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Your Answer:"}),c.jsx("p",{className:"text-sm text-gray-900",children:G(ee,t)})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Correct Answer:"}),c.jsx("p",{className:"text-sm text-gray-900",children:G(ve,t)})]})]})]},W)})})]})]}),[N,A,r,t,F,R,Lg,qf,G]),Q=b.useCallback(()=>{if(!y||y.length===0)return c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No test results available yet."})});const se={};return y.forEach(W=>{const ee=W.subject||"Unknown Subject";se[ee]||(se[ee]=[]),se[ee].push(W)}),c.jsx("div",{className:"space-y-6",children:Object.entries(se).map(([W,ee])=>c.jsxs("div",{className:"bg-white rounded-lg shadow",children:[c.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:W})}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ee.map((ve,_e)=>{const Le=Math.round(ve.score/ve.max_score*100),te=Le>=80?"text-green-600":Le>=60?"text-yellow-600":"text-red-600";return c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:ve.test_name}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ve.teacher_name||"Unknown"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c.jsxs("span",{className:te,children:[ve.score,"/",ve.max_score," (",Le,"%)"]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(ve.submitted_at).toLocaleDateString()})]},_e)})})]})})]},W))})},[y]);b.useCallback(()=>{console.log(" Clearing test data and returning to cabinet..."),E(null),C([]),setStudentAnswers(null),D(0),M(0),J(!1),n?n():l("/student")},[n,l]);const q=b.useCallback(()=>{console.log(" Navigating back to cabinet..."),n?n():l("/student")},[n,l]);return b.useCallback((se,W)=>{const ee={id:Date.now(),message:se,type:W,timestamp:new Date};_(ve=>[...ve,ee]),setTimeout(()=>{_(ve=>ve.filter(_e=>_e.id!==ee.id))},ya.NOTIFICATION_DURATION)},[]),p?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(nr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Student Results..."})]})}):v?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:v}),c.jsx(He,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?c.jsxs("div",{children:[p?c.jsxs("div",{className:"text-center py-8",children:[c.jsx(nr,{size:"md"}),c.jsx("p",{className:"mt-2 text-gray-600",children:"Loading results..."})]}):v?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-red-500 text-4xl mb-2",children:""}),c.jsx("p",{className:"text-red-600",children:v})]}):de(y),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:S.map(se=>c.jsx(Xi,{type:se.type,message:se.message,onClose:()=>_(W=>W.filter(ee=>ee.id!==se.id))},se.id))})]}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Results"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",X?X.toLocaleString():"Never"]})]}),c.jsxs("div",{className:"flex space-x-3",children:[N&&c.jsx(He,{variant:"outline",onClick:()=>J(!B),children:B?"Hide Details":"Show Details"}),c.jsx(He,{variant:"outline",onClick:q,children:"Back to Cabinet"})]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:B&&N?K():Q()}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:S.map(se=>c.jsx(Xi,{type:se.type,message:se.message,onClose:()=>_(W=>W.filter(ee=>ee.id!==se.id))},se.id))}),selectedDrawing&&c.jsx(RM,{drawing:selectedDrawing,isOpen:isDrawingModalOpen,onClose:()=>setIsDrawingModalOpen(!1)})]})},qre=({isMenuOpen:t,onToggleMenu:e,onShowPasswordChange:r})=>{var Ne;const n=Ha(),{user:s,isAuthenticated:a,logout:i}=xn(),{studentData:o,loadStudentData:l}=Iv(),{activeTests:u,testResults:d,loadActiveTests:g,loadTestResults:h,viewTestDetails:p,testDetailsModal:x,closeTestDetailsModal:v}=Nm(),[w,S]=b.useState(!0),[_,y]=b.useState(""),[k,N]=b.useState([]),[E,A]=b.useState(null),[C,F]=b.useState(!1),[D,R]=b.useState(null),[M,B]=b.useState(null),[J,X]=b.useState(new Set),[z,H]=b.useState(!1),[U,L]=b.useState(!1),[ne,de]=b.useState(!1),[G,K]=b.useState(!1);b.useEffect(()=>{Q()},[]),b.useEffect(()=>()=>{de(!1)},[]),b.useEffect(()=>{if(ne){const Ce=setTimeout(()=>{de(!1)},1e3);return()=>clearTimeout(Ce)}},[ne]);const Q=b.useCallback(async()=>{console.log(" Initializing Student Cabinet...");try{if(S(!0),y(""),!a||!s){console.log(" User not authenticated, redirecting to login"),n("/login");return}if(s.role!==ra.STUDENT){console.error(" Invalid user role for student cabinet:",s.role),y("Access denied. Student role required.");return}console.log(" Loading student data..."),await l(),console.log(" Loading active tests...");try{localStorage.removeItem("student_active_tests_")}catch{}await g(),console.log(" Loading test results..."),await h((s==null?void 0:s.student_id)||(s==null?void 0:s.id)||""),console.log(" Calculating average score..."),await q(),console.log(" Student Cabinet initialization complete!")}catch(Ce){console.error(" Error initializing student cabinet:",Ce),y("Failed to initialize student cabinet")}finally{S(!1)}},[a,s,n]),q=b.useCallback(async()=>{console.log(" Calculating average score...");try{if(d&&d.length>0){const Ce=d.reduce((nt,$e)=>typeof $e.score=="number"&&typeof $e.max_score=="number"&&$e.max_score>0?nt+Math.round($e.score/$e.max_score*100):nt,0),We=Math.round(Ce/d.length);B(We),console.log(" Average score calculated:",We)}}catch(Ce){console.error(" Error calculating average score:",Ce)}},[d]);b.useEffect(()=>{if(ne){console.log(" Skipping completed tests initialization during navigation");return}const Ce=(s==null?void 0:s.student_id)||(s==null?void 0:s.id);if(!Ce){console.log(" Student ID not available yet, skipping localStorage initialization");return}const We=new Set;for(let nt=0;nt<localStorage.length;nt++){const $e=localStorage.key(nt);if($e&&$e.startsWith(`test_completed_${Ce}_`)&&localStorage.getItem($e)==="true"){const at=$e.replace(`test_completed_${Ce}_`,"").split("_");if(at.length>=2){const Se=at[0],Ae=at.slice(1).join("_"),Me=`${Se}_${Ae}`;We.add(Me),console.log(" Found completed test in localStorage:",Me)}}}X(We),K(!0),console.log(" Initialized completed tests from localStorage:",Array.from(We))},[s==null?void 0:s.student_id,s==null?void 0:s.id,ne]),b.useEffect(()=>{console.log(" testResults structure:",d);const Ce=(d==null?void 0:d.results)||d;if(console.log(" resultsArray:",Ce),Ce&&Ce.length>0){const We=(s==null?void 0:s.student_id)||(s==null?void 0:s.id)||"",nt=new Set;Ce.forEach($e=>{const De=`${$e.test_type}_${$e.test_id}`;nt.add(De),localStorage.setItem(`test_completed_${We}_${$e.test_type}_${$e.test_id}`,"true")}),X($e=>{const De=new Set([...$e,...nt]);return console.log(" Updated completed tests (merged):",Array.from(De)),De})}},[d,s==null?void 0:s.student_id,s==null?void 0:s.id]);const se=b.useCallback(async(Ce,We,nt=!1,$e=null)=>{console.log(" Checking test completion:",Ce,We,"retestAvailable:",nt);try{const De=(s==null?void 0:s.student_id)||(s==null?void 0:s.id)||"";if(nt){console.log(" Retest available from backend, checking attempt limits.");const Me=[];for(let tt=1;tt<=10;tt++){const kt=`retest_attempt${tt}_${De}_${Ce}_${We}`;localStorage.getItem(kt)==="true"&&Me.push(kt)}const Ie=Me.length,Ge=($e==null?void 0:$e.retest_attempts_left)||($e==null?void 0:$e.max_attempts)||3;return console.log(" Current attempts:",Ie,"Max attempts:",Ge,"Attempt keys:",Me),Ie>=Ge?(console.log(" Maximum retest attempts reached in localStorage"),!0):(console.log(" Retest attempts available, allowing start."),!1)}const at=`test_completed_${De}_${Ce}_${We}`,Se=localStorage.getItem(at);if(console.log(" localStorage key:",at),console.log(" localStorage value:",Se),Ce==="word_matching"){console.log(" Debug: All localStorage keys for student",De);for(let Me=0;Me<localStorage.length;Me++){const Ie=localStorage.key(Me);Ie&&Ie.includes(De)&&Ie.includes("word_matching")&&console.log(" Found word_matching key:",Ie,"=",localStorage.getItem(Ie))}}if(Se==="true")return console.log(" Found completion status in local storage:",Se),!0;const Ae=(d==null?void 0:d.results)||d;return Ae&&Ae.length>0&&(console.log(" Checking database results:",Ae.length,"results"),Ae.some(Ie=>(console.log(" Checking result:",Ie.test_type,Ie.test_id,"vs",Ce,We),Ie.test_type===Ce&&Ie.test_id===We)))?(console.log(" Found completion status in database results"),localStorage.setItem(at,"true"),!0):(console.log(" Test not completed according to local storage or database"),!1)}catch(De){return console.error(" Error checking test completion:",De),!1}},[d,s==null?void 0:s.student_id,s==null?void 0:s.id]),W=b.useCallback((Ce,We)=>{const nt={id:Date.now(),message:Ce,type:We,timestamp:new Date};N($e=>[...$e,nt]),setTimeout(()=>{N($e=>$e.filter(De=>De.id!==nt.id))},ya.NOTIFICATION_DURATION)},[]),ee=b.useCallback(async Ce=>{console.log(" Showing test details:",Ce);try{await p(Ce.test_type,Ce.test_id,Ce.test_name)}catch(We){console.error("Error loading test details:",We),W("Failed to load test details","error")}},[p,W]),ve=b.useCallback(Ce=>{console.log(" Starting test:",Ce);const We=`${Ce.test_type}_${Ce.test_id}`;if(J.has(We)&&!(Ce!=null&&Ce.retest_available)){W("This test has already been completed","warning");return}if(Ce!=null&&Ce.retest_available&&!J.has(We)){const nt=(s==null?void 0:s.student_id)||(s==null?void 0:s.id)||"",$e=`retest1_${nt}_${Ce.test_type}_${Ce.test_id}`;if(localStorage.setItem($e,"true"),console.log(" Set retest key:",$e),Ce!=null&&Ce.retest_assignment_id){const De=`retest_assignment_id_${nt}_${Ce.test_type}_${Ce.test_id}`;localStorage.setItem(De,String(Ce.retest_assignment_id))}}if(de(!0),console.log(" Set isStartingTest to true for test:",Ce.test_type),Ce.test_type==="matching_type"){console.log(" Redirecting to matching test page for testId:",Ce.test_id),n(`/student/matching-test/${Ce.test_id}`);return}if(Ce.test_type==="word_matching"){console.log(" Redirecting to word matching test page for testId:",Ce.test_id),n(`/student/word-matching-test/${Ce.test_id}`);return}n(`/student/test/${Ce.test_type}/${Ce.test_id}`)},[n,J,W,s==null?void 0:s.student_id,s==null?void 0:s.id]),_e=b.useCallback(()=>{H(Ce=>!Ce)},[]),Le=b.useCallback(()=>{L(Ce=>!Ce)},[]),te=b.useCallback(async Ce=>{if(console.log(" Starting test:",Ce),ne){console.log(" Test already starting, ignoring click");return}try{if(await se(Ce.test_type,Ce.test_id,Ce==null?void 0:Ce.retest_available,Ce)&&!(Ce!=null&&Ce.retest_available)){W("This test has already been completed","warning");return}ve(Ce)}catch(We){console.error(" Error starting test:",We),W("Failed to start test. Please try again.","error")}},[se,ve,W,ne]);return b.useCallback(Ce=>{console.log(" Viewing test details:",Ce),ee(Ce)},[ee]),w?c.jsx(Be.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:c.jsxs(Be.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx(nr,{size:"lg"}),c.jsx(Be.p,{className:"mt-4 text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.3},children:"Loading Student Cabinet..."})]})}):_?c.jsx(Be.div,{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:c.jsx(Be.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:c.jsxs(Be.div,{className:"bg-white border border-red-200 rounded-xl p-8 max-w-md shadow-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,duration:.3},children:[c.jsx(Be.div,{className:"text-4xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.3,type:"spring"},children:""}),c.jsx("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Cabinet Error"}),c.jsx("p",{className:"text-red-600 mb-6",children:_}),c.jsx(He,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):c.jsxs(Be.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsx(Be.div,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-6",children:[c.jsxs(Be.div,{className:"flex items-center space-x-4",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(Be.div,{className:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:c.jsx("span",{className:"text-white font-semibold text-xl",children:((Ne=s==null?void 0:s.name)==null?void 0:Ne.charAt(0))||"S"})})}),c.jsxs("div",{children:[c.jsxs("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold text-white",children:[s==null?void 0:s.name," ",s==null?void 0:s.surname]}),c.jsxs("p",{className:"text-blue-100 text-sm sm:text-base md:text-lg",children:["Grade ",s==null?void 0:s.grade," - Class ",s==null?void 0:s.class]})]})]}),c.jsxs(Be.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsxs("button",{onClick:e,className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",style:{zIndex:1e3},children:[c.jsx("span",{className:"hidden sm:inline",children:"Menu"}),c.jsx(Be.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:t?180:0},transition:{duration:.2},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),c.jsx(va,{children:t&&c.jsx(Be.div,{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:c.jsxs("div",{className:"py-2",children:[c.jsx(Be.button,{onClick:r,className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),c.jsx(Be.button,{onClick:()=>{e(),i()},className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),c.jsxs(Be.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:[c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:c.jsx("div",{className:"lg:col-span-1 space-y-6",children:M!==null&&c.jsx(Be.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7,duration:.5},children:c.jsxs(st,{children:[c.jsx(st.Header,{children:c.jsx(st.Title,{children:"Average Score"})}),c.jsx(st.Body,{children:c.jsxs(Be.div,{className:"text-center",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.8,duration:.3},children:[c.jsxs(Be.div,{className:"text-4xl font-bold text-blue-600 mb-2",initial:{scale:0},animate:{scale:1},transition:{delay:.9,duration:.5,type:"spring"},children:[M,"%"]}),c.jsx("p",{className:"text-sm text-gray-500",children:"Overall Performance"})]})})]})})})}),c.jsxs("div",{className:"space-y-6",children:[c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:c.jsxs(st,{children:[c.jsx(st.Header,{children:c.jsx(st.Title,{className:"text-center",children:"Active Tests"})}),c.jsx(st.Body,{children:u&&u.length>0?c.jsxs("div",{className:"relative",children:[console.log(" Rendering overlay, isStartingTest:",ne),ne&&c.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50 rounded-lg border-2 border-blue-200",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Starting test..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait..."})]})}),c.jsxs("div",{className:"space-y-4",children:[(z?u:u.slice(0,3)).map((Ce,We)=>c.jsx(Be.div,{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:z?0:.7+We*.1,duration:.3},whileHover:{scale:1.02},children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsx("div",{className:"flex-1",children:c.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[c.jsx("h3",{className:"text-sm sm:text-lg font-medium text-gray-900 w-16 sm:w-auto break-words leading-tight line-clamp-2 sm:line-clamp-none",children:Ce.test_name}),c.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:Ce.subject}),c.jsx("span",{className:"text-gray-500",children:Ce.teacher_name}),c.jsxs("span",{className:"text-gray-500",children:[c.jsx("span",{className:"sm:hidden",children:new Date(Ce.assigned_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}),c.jsx("span",{className:"hidden sm:inline",children:new Date(Ce.assigned_at).toLocaleDateString()})]})]})}),c.jsx("div",{className:"flex space-x-2 ml-4",children:(()=>{const nt=`${Ce.test_type}_${Ce.test_id}`,$e=J.has(nt);return G?$e&&(Ce!=null&&Ce.retest_available)?c.jsx(He,{variant:"primary",size:"sm",onClick:()=>te(Ce),disabled:ne,children:"Start Retest"}):$e?c.jsx(He,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):(console.log(" Button render, isStartingTest:",ne,"test:",Ce.test_type),c.jsx(He,{variant:"primary",size:"sm",onClick:()=>te(Ce),disabled:ne,children:"Start Test"})):c.jsx(He,{variant:"secondary",size:"sm",disabled:!0,className:"bg-gray-100 text-gray-500 border-gray-200",children:"Loading..."})})()})]})},`${Ce.test_type}_${Ce.test_id}`)),u.length>3&&c.jsx("div",{className:"text-center pt-2",children:c.jsx("button",{onClick:_e,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:z?"Show Less":`Show ${u.length-3} More`})})]})]}):c.jsxs(Be.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.3},children:[c.jsx(Be.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.8,duration:.5,type:"spring"},children:""}),c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Active Tests"}),c.jsx("p",{className:"text-gray-500",children:"No active tests available for your class at the moment."})]})})]})}),c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:c.jsxs(st,{children:[c.jsx(st.Header,{children:c.jsx(st.Title,{children:"Test Results"})}),c.jsx(st.Body,{children:d&&d.showResults?c.jsx(GT,{testResults:d,onBackToCabinet:()=>{setTestResults(null)},onRetakeTest:(Ce,We)=>{g(),setTestResults(null)},isLoading:w}):c.jsx(MM,{compact:!0,showAll:U,onToggleShowAll:Le,maxInitial:3})})]})})]})]}),c.jsx(TM,{isOpen:x.isOpen,onClose:v,testType:x.testType,testId:x.testId,testName:x.testName,questions:x.questions||[],isLoading:x.isLoading||!1}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:k.map(Ce=>c.jsx(Xi,{type:Ce.type,message:Ce.message,onClose:()=>N(We=>We.filter(nt=>nt.id!==Ce.id))},Ce.id))})]})},Zre=({testInfo:t,questions:e,testType:r,studentAnswers:n,onBackToCabinet:s,checkAnswerCorrectness:a,formatStudentAnswerForDisplay:i,getCorrectAnswer:o})=>{const[l,u]=b.useState(0),[d,g]=b.useState(0),[h,p]=b.useState(!0);if(b.useEffect(()=>{const w=()=>{try{const S=fc(e,n,r).score,_=(t==null?void 0:t.num_questions)||(e==null?void 0:e.length)||0,y=_>0?Math.round(S/_*100):0;u(S),g(y),p(!1)}catch(S){console.error("Error calculating test results:",S),u(0),g(0),p(!1)}};e&&e.length>0?w():p(!1)},[e,n,r,t,fc]),h)return c.jsx("div",{className:"flex justify-center items-center min-h-64",children:c.jsx("div",{className:"text-lg",children:"Calculating results..."})});const x=(t==null?void 0:t.num_questions)||(e==null?void 0:e.length)||0,v=(t==null?void 0:t.test_name)||(t==null?void 0:t.title)||"Test";return c.jsxs("div",{className:"test-results-page max-w-4xl mx-auto p-6 overflow-y-auto min-h-screen",children:[c.jsx(st,{className:"mb-6",children:c.jsxs("div",{className:"results-header text-center",children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:["Test Results: ",v]}),c.jsx("p",{className:"text-gray-600",children:r==="matching_type"?"Matching Test":r==="multiple_choice"?"Multiple Choice Test":r==="true_false"?"True/False Test":r==="input"?"Input Test":r==="drawing"?"Drawing Test":"Test"})]})}),c.jsx(st,{className:"mb-6",children:c.jsxs("div",{className:"results-summary",children:[c.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 text-center",children:["Your Score: ",l," / ",x," (",d,"%)"]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-4",children:c.jsx("div",{className:`h-4 rounded-full transition-all duration-500 ${d>=80?"bg-green-500":d>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${d}%`}})}),c.jsx("div",{className:"text-center",children:c.jsx("p",{className:`text-lg font-medium ${d>=80?"text-green-600":d>=60?"text-yellow-600":"text-red-600"}`,children:d>=80?"Excellent!":d>=60?"Good job!":"Keep practicing!"})})]})}),e&&e.length>0&&c.jsx(st,{className:"mb-6",children:c.jsxs("div",{className:"questions-review",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Question Review"}),c.jsx("div",{className:"space-y-4",children:e.map((w,S)=>{const _=n[String(w.question_id)]||"No answer";console.log(" TestResultsDisplay - Question",S+1,":",{question:w,studentAnswer:_,testType:r});const y=a(w,_,r);return console.log(" TestResultsDisplay - isCorrect result:",y),c.jsxs("div",{className:`question-review p-4 rounded-lg border-2 ${y?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[c.jsxs("div",{className:"question-review-header flex justify-between items-start mb-3",children:[c.jsxs("h4",{className:"text-lg font-medium text-gray-800",children:["Question ",S+1]}),c.jsx("span",{className:`text-2xl font-bold ${y?"text-green-600":"text-red-600"}`,children:y?"":""})]}),c.jsx("div",{className:"question-text mb-3",children:c.jsx("p",{className:"text-gray-700 font-medium",children:w.question})}),c.jsxs("div",{className:"answer-section space-y-2",children:[c.jsxs("p",{className:"student-answer",children:[c.jsx("strong",{className:"text-gray-600",children:"Your Answer:"})," ",c.jsx("span",{className:`font-medium ${y?"text-green-700":"text-red-700"}`,children:i(_,r,w)})]}),!y&&c.jsxs("p",{className:"correct-answer",children:[c.jsx("strong",{className:"text-gray-600",children:"Correct Answer:"})," ",c.jsx("span",{className:"text-green-700 font-medium",children:r==="multiple_choice"?String(w.correct_answer||"").toUpperCase():i(o(w,r),r,w)})]})]})]},w.question_id||S)})})]})}),c.jsx(st,{children:c.jsx("div",{className:"results-actions text-center",children:c.jsx(He,{onClick:s,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 text-lg font-medium",children:"Back to Cabinet"})})})]})},ene=({onBackToCabinet:t,currentTest:e})=>{const r=Ha(),{user:n,isAuthenticated:s}=xn(),{activeTests:a,loadActiveTests:i}=Nm(),o=b.useCallback((Fe,et,Ze)=>{try{const dt=`test_progress_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown"}_${Fe}_${et}`;localStorage.setItem(dt,JSON.stringify(Ze)),console.log(`Saved test progress for ${Fe}_${et}:`,Ze)}catch(rt){console.error("Error saving test progress:",rt)}},[n==null?void 0:n.student_id,n==null?void 0:n.id]),l=b.useCallback((Fe,et)=>{try{const rt=`test_progress_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown"}_${Fe}_${et}`,dt=localStorage.getItem(rt);return dt?JSON.parse(dt):null}catch(Ze){return console.error("Error getting test progress:",Ze),null}},[n==null?void 0:n.student_id,n==null?void 0:n.id]),u=b.useCallback((Fe,et)=>{try{const Ze=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown",rt=`test_progress_${Ze}_${Fe}_${et}`;localStorage.removeItem(rt);for(let dt=0;dt<localStorage.length;dt++){const Tt=localStorage.key(dt);Tt&&Tt.startsWith(`test_progress_${Ze}_${Fe}_${et}_`)&&(localStorage.removeItem(Tt),console.log(` Cleared individual question key: ${Tt}`))}console.log(`Cleared test progress for ${Fe}_${et}`)}catch(Ze){console.error("Error clearing test progress:",Ze)}},[n==null?void 0:n.student_id,n==null?void 0:n.id]),[d,g]=b.useState(!0),[h,p]=b.useState(!1),[x,v]=b.useState(""),[w,S]=b.useState(!1),[_,y]=b.useState(""),[k,N]=b.useState([]),[E,A]=b.useState(e?"test":"list"),[C,F]=b.useState(null),[D,R]=b.useState(null),[M,B]=b.useState(null),[J,X]=b.useState([]),[z,H]=b.useState([]),[U,L]=b.useState(0),[ne,de]=b.useState(0),[G,K]=b.useState(null),Q=Wn.useRef(null),q=Wn.useRef(null),[se,W]=b.useState(!1),[ee,ve]=b.useState(!1),[_e,Le]=b.useState(null),[te,Ne]=b.useState(null),{startTracking:Ce,stopTracking:We,getCheatingData:nt,clearData:$e,isCheating:De,tabSwitches:at}=Em(C==null?void 0:C.test_type,C==null?void 0:C.test_id,(n==null?void 0:n.student_id)||(n==null?void 0:n.id));b.useEffect(()=>{(()=>{const et=[];for(let Ze=0;Ze<localStorage.length;Ze++){const rt=localStorage.key(Ze);if(rt&&rt.startsWith("test_progress_")&&!rt.includes("_51712_")&&!rt.includes("_51736_")){const dt=rt.split("_");dt.length===4&&dt[0]==="test"&&dt[1]==="progress"&&et.push(rt)}}et.forEach(Ze=>{localStorage.removeItem(Ze),console.log(" Cleared old cache key:",Ze)})})()},[]),b.useEffect(()=>{Se()},[]),b.useEffect(()=>{e&&(console.log(" Auto-starting test from prop:",e),S(!0),Ie(e))},[e]);const Se=b.useCallback(async()=>{console.log(" Initializing Student Tests...");try{if(g(!0),y(""),!s||!n){console.log(" User not authenticated"),y("User not authenticated");return}if(n.role!==ra.STUDENT){console.error(" Invalid user role for student tests:",n.role),y("Access denied. Student role required.");return}console.log(" Loading active tests..."),await i(),console.log(" Student Tests initialization complete!")}catch(Fe){console.error(" Error initializing student tests:",Fe),y("Failed to initialize student tests")}finally{g(!1)}},[s,n,i]);b.useCallback(async()=>{console.log(" Loading student active tests...");try{const Fe=await Tr.getActiveTests();console.log(" Active tests loaded:",Fe);const et=Fe.map(Ze=>({...Ze,subject_id:Ze.subject_id||Ze.subjectId,teacher_id:Ze.teacher_id||Ze.teacherId,is_active:Ze.is_active!==void 0?Ze.is_active:!0,created_at:Ze.created_at||Ze.createdAt,updated_at:Ze.updated_at||Ze.updatedAt}));return Ne(new Date),et}catch(Fe){throw console.error(" Error loading active tests:",Fe),Fe}},[]),b.useCallback(async(Fe,et)=>{console.log(" Checking test completion:",Fe,et);try{const Ze=l(Fe,et);return Ze&&Ze.completed}catch(Ze){return console.error(" Error checking test completion:",Ze),!1}},[l]),b.useEffect(()=>{if(J.length>0&&(C!=null&&C.test_id)){const Fe=setTimeout(()=>{let et=!1;const Ze=new Array(J.length).fill("");if(J.forEach((rt,dt)=>{const xe=`test_progress_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown"}_${D}_${C==null?void 0:C.test_id}_${rt.question_id}`,ue=localStorage.getItem(xe);if(ue){const ye=ue.replace(/^"(.*)"$/,"$1");Ze[dt]=ye,et=!0}}),et){H(Ze);const rt=Ze.filter(Tt=>Tt&&typeof Tt=="string"&&Tt.trim()!=="").length,dt=J.length>0?rt/J.length*100:0;L(dt)}},100);return()=>clearTimeout(Fe)}},[J,D,C==null?void 0:C.test_id]);const Ae=b.useCallback(async(Fe,et)=>{console.log(" Marking test as completed:",Fe,et);try{const Ze=l(Fe,et)||{};Ze.completed=!0,Ze.completedAt=new Date().toISOString(),o(Fe,et,Ze);const dt=`test_completed_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||""}_${Fe}_${et}`;localStorage.setItem(dt,"true"),console.log(" Test completion marked in localStorage:",dt),console.log(" localStorage value after setting:",localStorage.getItem(dt)),Dt("Test marked as completed","success")}catch(Ze){console.error(" Error marking test as completed:",Ze),Dt("Failed to mark test as completed","error")}},[l,o]),Me=b.useCallback(Fe=>{console.log(" Showing test details:",Fe),Le(Fe),ve(!0)},[]),Ie=b.useCallback(async Fe=>{console.log(" Starting test:",Fe);let et=Date.now(),Ze;try{v(""),p(!0),et=Date.now();const rt=()=>{const qt=Date.now()-et,Nr=Math.max(0,250-qt);setTimeout(()=>{g(!1),p(!1)},Nr)};let dt=!1;Ze=setTimeout(()=>{dt=!0,v("Loading is taking longer than expected...")},15e3);const xe=`test_completed_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||""}_${Fe.test_type}_${Fe.test_id}`,ue=localStorage.getItem(xe)==="true";if(ue&&!(Fe!=null&&Fe.retest_available)){console.log(" Test already completed, redirecting to main cabinet"),Dt("This test has already been completed","info"),r("/student");return}if(ue&&(Fe!=null&&Fe.retest_available)&&console.log(" Test completed but retest available, allowing retest"),Fe.test_type===Dr.MATCHING){console.log(" Redirecting to matching test page for testId:",Fe.test_id),r(`/student/matching-test/${Fe.test_id}`);return}if(Fe.test_type===Dr.WORD_MATCHING){console.log(" Redirecting to word matching test page for testId:",Fe.test_id),r(`/student/word-matching-test/${Fe.test_id}`);return}F(Fe),R(Fe.test_type);const[ye,be]=await Promise.all([Tr.getTestInfo(Fe.test_type,Fe.test_id),Tr.getTestQuestions(Fe.test_type,Fe.test_id)]);B(ye);let Ve=be;try{if(!!(ye!=null&&ye.is_shuffled)){const hr=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown",Nr=`${hr}:${Fe.test_type}:${Fe.test_id}`,Ln=Array.from(Nr).reduce((ae,ce)=>(ae<<5)-ae+ce.charCodeAt(0),0)>>>0,Y=`test_shuffle_order_${hr}_${Fe.test_type}_${Fe.test_id}`,fe=localStorage.getItem(Y);if(fe){const ae=JSON.parse(fe),ce=new Map(be.map(ge=>[ge.question_id,ge]));Ve=ae.map(ge=>ce.get(ge)).filter(Boolean)}else{const ce=function(V){return function(){var ie=V+=1831565813;return ie=Math.imul(ie^ie>>>15,ie|1),ie^=ie+Math.imul(ie^ie>>>7,ie|61),((ie^ie>>>14)>>>0)/4294967296}}(Ln);Ve=[...be];for(let V=Ve.length-1;V>0;V--){const ie=Math.floor(ce()*(V+1));[Ve[V],Ve[ie]]=[Ve[ie],Ve[V]]}const ge=Ve.map(V=>V.question_id);localStorage.setItem(Y,JSON.stringify(ge))}}}catch(qt){console.error("Shuffle error (ignored):",qt)}X(Ve),rt();const Nt=l(Fe.test_type,Fe.test_id);let yt=(Nt==null?void 0:Nt.answers)||new Array(be.length).fill("");be.forEach((qt,hr)=>{const Ln=`test_progress_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown"}_${Fe.test_type}_${Fe.test_id}_${qt.question_id}`,Y=localStorage.getItem(Ln);console.log(` Checking individual answer for question ${qt.question_id}:`,Y),Y&&(yt[hr]=Y,console.log(` Loaded individual answer for question ${qt.question_id}:`,Y))}),console.log(" Initial answers after loading individual saves:",yt),H(yt);const $t=yt.filter(qt=>qt&&typeof qt=="string"&&qt.trim()!=="").length,Ft=be.length>0?$t/be.length*100:0;console.log(" Calculated progress:",$t,"answered out of",be.length,"=",Ft+"%"),L(Ft);const Ot=Number((ye==null?void 0:ye.allowed_time)||0),xr=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown";if(Q.current=`test_timer_${xr}_${Fe.test_type}_${Fe.test_id}`,Ot>0)try{const qt=localStorage.getItem(Q.current),hr=Date.now();if(qt){const Nr=JSON.parse(qt),Ln=Math.floor((hr-new Date(Nr.lastTickAt).getTime())/1e3),Y=Math.max(0,Number(Nr.remainingSeconds||Ot)-Math.max(0,Ln));de(Y),q.current=hr}else de(Ot),q.current=hr,localStorage.setItem(Q.current,JSON.stringify({remainingSeconds:Ot,lastTickAt:new Date(hr).toISOString(),startedAt:new Date(hr).toISOString()}))}catch(qt){console.error("Timer cache init error:",qt),de(Ot)}else de(0);const yr=new Date;K(yr),console.log(" Test timer started at:",yr.toISOString()),Ce(),console.log(" Anti-cheating tracking started"),A("test"),console.log(" Test started successfully")}catch(rt){console.error(" Error starting test:",rt),Dt("Failed to start test","error"),v("Failed to load test data. Please try again.")}finally{const rt=Date.now()-et,Tt=Math.max(0,250-rt);setTimeout(()=>{g(!1),p(!1)},Tt),S(!1);try{Ze&&clearTimeout(Ze)}catch{}}},[l]),Ge=b.useCallback(async()=>{if(!C||!M||!J||!z){Dt("No test data to submit","error");return}console.log(" Submitting test:",C);try{W(!0);const Fe=fc(J,z,C.test_type),et=new Date,Ze=G?Math.round((et-G)/1e3):0,rt=G?G.toISOString():et.toISOString();console.log(" Test timing:",{startedAt:rt,endTime:et.toISOString(),timeTaken:`${Ze} seconds`});const dt=nt();console.log(" Anti-cheating data for submission:",dt);const Tt={};J.forEach((ue,ye)=>{Tt[ue.question_id]=z[ye]??""}),C.test_type==="drawing"&&(console.log(" Drawing test answers being submitted:",z),console.log(" Drawing test answers type:",typeof z[0]),console.log(" Drawing test answers content:",z[0]));const xe=await Tr.submitTest(C.test_type,C.test_id,z,{time_taken:(()=>{const ue=Number((M==null?void 0:M.allowed_time)||0);return ue>0?Math.min(Ze,ue):Ze})(),started_at:rt,submitted_at:et.toISOString(),answers_by_id:Tt,question_order:J.map(ue=>ue.question_id),caught_cheating:dt.caught_cheating,visibility_change_times:dt.visibility_change_times,retest_assignment_id:(()=>{const ye=`retest_assignment_id_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||""}_${C.test_type}_${C.test_id}`,be=localStorage.getItem(ye);return be?Number(be):null})(),parent_test_id:C.test_id},n);if(console.log(" Test submission result:",xe),xe.success){const ue=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"",ye=`retest1_${ue}_${C.test_type}_${C.test_id}`;if(localStorage.getItem(ye)==="true"){const yt=(C==null?void 0:C.retest_attempts_left)||(C==null?void 0:C.max_attempts)||3;if(((xe==null?void 0:xe.percentage_score)??0)>=50){const Ft=`retest_attempt${yt}_${ue}_${C.test_type}_${C.test_id}`;localStorage.setItem(Ft,"true"),console.log(" Passed retest, marking last-slot key:",Ft),localStorage.removeItem(ye)}else{let Ft=1;for(let xr=1;xr<=10;xr++){const yr=`retest_attempt${xr}_${ue}_${C.test_type}_${C.test_id}`;if(localStorage.getItem(yr)!=="true"){Ft=xr;break}}const Ot=`retest_attempt${Ft}_${ue}_${C.test_type}_${C.test_id}`;localStorage.setItem(Ot,"true"),console.log(" Marked retest attempt as completed:",Ot),Ft>=yt&&localStorage.removeItem(ye)}}if(console.log(" Marking test as completed..."),await Ae(C.test_type,C.test_id),C.test_type!=="drawing"){console.log(" Caching test results after submission...");const $t=`student_results_table_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown"}`,{setCachedData:Ft,CACHE_TTL:Ot}=await bu(async()=>{const{setCachedData:xr,CACHE_TTL:yr}=await Promise.resolve().then(()=>YP);return{setCachedData:xr,CACHE_TTL:yr}},void 0);Ft($t,xe,Ot.student_results_table),console.log(" Test results cached with key:",$t)}else console.log(" Drawing test submitted - not caching results (will appear after teacher grades)");console.log(" Clearing test progress..."),u(C.test_type,C.test_id);try{const yt=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown",$t=`test_timer_${yt}_${C.test_type}_${C.test_id}`;localStorage.removeItem($t);const Ft=`test_shuffle_order_${yt}_${C.test_type}_${C.test_id}`;localStorage.removeItem(Ft)}catch{}if(n!=null&&n.student_id){const yt=`test_completed_${n.student_id}_${C.test_type}_${C.test_id}`;localStorage.setItem(yt,"true"),console.log(" Test marked as completed in localStorage:",yt)}try{const yt=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"",$t=`retest1_${yt}_${C.test_type}_${C.test_id}`,Ft=`retest_assignment_id_${yt}_${C.test_type}_${C.test_id}`;localStorage.removeItem($t),localStorage.removeItem(Ft),console.log(" Cleared retest keys:",$t,Ft)}catch(yt){console.warn("Failed to clear retest keys:",yt)}console.log(" Clearing test progress and anti-cheating data...");const Ve=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown",Nt=[];for(let yt=0;yt<localStorage.length;yt++){const $t=localStorage.key(yt);$t&&($t.startsWith(`test_progress_${Ve}_`)||$t.startsWith(`anti_cheating_${Ve}_`))&&Nt.push($t)}Nt.forEach(yt=>{localStorage.removeItem(yt),console.log(` Cleared: ${yt}`)}),console.log(" Clearing anti-cheating data..."),We(),$e(),C.test_type!=="drawing"?A("results"):r("/student"),Dt("Test submitted successfully!","success"),console.log(" Test submitted successfully")}else throw console.error(" Test submission failed:",xe.error),new Error(xe.error||"Failed to submit test")}catch(Fe){console.error(" Error submitting test:",Fe),Dt("Failed to submit test","error")}finally{W(!1)}},[C,M,J,z,Ae,u]);b.useCallback(()=>(console.log(" Collecting test answers..."),z),[z]);const tt=b.useCallback(()=>{if(!J||!z)return;const Fe=z.filter(Ze=>Ze&&typeof Ze=="string"&&Ze.trim()!=="").length,et=J.length>0?Fe/J.length*100:0;if(L(et),console.log(` Progress updated: ${Fe}/${J.length} questions answered (${Math.round(et)}%)`),C){const Ze={answers:z,progress:et,lastSaved:new Date().toISOString()};o(C.test_type,C.test_id,Ze)}},[J,z,C,o]);b.useEffect(()=>{tt()},[tt]);const kt=b.useCallback(()=>{if(!z)return 0;const Fe=z.filter(et=>et&&typeof et=="string"&&et.trim()!=="").length;return console.log(" getAnsweredCount:",{studentAnswers:z,answeredCount:Fe,totalQuestions:J==null?void 0:J.length}),Fe},[z,J]),zt=b.useCallback(()=>{console.log(" Navigating back to cabinet..."),t?t():r("/student")},[t,r]);b.useCallback(()=>{console.log(" Showing test results..."),A("results")},[]);const bt=b.useCallback((Fe,et,Ze=null)=>{switch(console.log(" Formatting student answer for display:",Fe,"testType:",et,"question:",Ze),et){case Dr.MULTIPLE_CHOICE:if(Fe.toString().startsWith("Option "))return Fe;if(Ze&&typeof Fe=="string"&&!isNaN(parseInt(Fe))){const rt=parseInt(Fe),dt=`option_${String.fromCharCode(97+rt)}`,Tt=Ze[dt];if(Tt)return console.log(" Converted",Fe,"to option text:",Tt),Tt;{const xe=String.fromCharCode(65+rt);return console.log(" Converted",Fe,"to",xe),xe}}else{if(typeof Fe=="string"&&isNaN(parseInt(Fe)))return console.log(" Already formatted text:",Fe),Fe;{const rt=String.fromCharCode(65+parseInt(Fe));return console.log(" Converted",Fe,"to",rt),rt}}case Dr.TRUE_FALSE:return Fe==="true"?"True":"False";case Dr.INPUT:return Fe;case Dr.MATCHING:return typeof Fe=="object"?JSON.stringify(Fe):Fe;case Dr.WORD_MATCHING:return typeof Fe=="object"?JSON.stringify(Fe):Fe;case Dr.DRAWING:return Fe&&Fe.trim()!==""?"Drawing submitted":"No drawing";case Dr.FILL_BLANKS:return Fe;default:return console.warn(" Unknown test type for answer formatting:",et),Fe}},[]),Dt=b.useCallback((Fe,et)=>{const Ze={id:Date.now(),message:Fe,type:et,timestamp:new Date};N(rt=>[...rt,Ze]),setTimeout(()=>{N(rt=>rt.filter(dt=>dt.id!==Ze.id))},ya.NOTIFICATION_DURATION)},[]);b.useEffect(()=>{tt()},[tt]),b.useEffect(()=>{if(E!=="test")return;const Fe=Number((M==null?void 0:M.allowed_time)||0);if(!Fe)return;const et=setInterval(()=>{de(Ze=>{const rt=Math.max(0,Ze-1);try{const dt=Date.now();q.current||(q.current=dt),Q.current&&localStorage.setItem(Q.current,JSON.stringify({remainingSeconds:rt,lastTickAt:new Date(dt).toISOString(),startedAt:G?G.toISOString():new Date(dt-(Fe-rt)*1e3).toISOString()}))}catch{}return rt===0&&Ge(),rt})},1e3);return()=>clearInterval(et)},[E,M==null?void 0:M.allowed_time,Ge,G]);const it=b.useCallback((Fe,et)=>{if(!Fe)return null;const Ze=(rt,dt)=>{const Tt=[...z];Tt[et]=dt,H(Tt),console.log(` Answer changed: question ${rt} = ${dt}`),console.log(" Updated studentAnswers:",Tt)};switch(C.test_type){case Dr.TRUE_FALSE:return c.jsx(are,{question:Fe,questionIndex:et,studentAnswer:z[et]||"",onAnswerChange:Ze,mode:"student",testId:C==null?void 0:C.test_id,testType:D,displayNumber:et+1});case Dr.MULTIPLE_CHOICE:return c.jsx(ire,{question:Fe,questionIndex:et,studentAnswer:z[et]||"",onAnswerChange:Ze,mode:"student",testId:C==null?void 0:C.test_id,testType:D,displayNumber:et+1});case Dr.INPUT:return c.jsx(ore,{question:Fe,questionIndex:et,studentAnswer:z[et]||"",onAnswerChange:Ze,mode:"student",testId:C==null?void 0:C.test_id,testType:D,displayNumber:et+1});case Dr.MATCHING:return console.error("Matching test reached renderQuestion - this should not happen"),c.jsxs("div",{className:"text-center p-8",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-600 mb-4",children:"Matching Test"}),c.jsx("p",{className:"text-gray-500 mb-4",children:"Redirecting to matching test page..."}),c.jsx(He,{onClick:()=>r("/student"),variant:"primary",children:"Back to Dashboard"})]});case Dr.DRAWING:return c.jsx(gre,{question:Fe,questionIndex:et,studentAnswer:z[et]||"",onAnswerChange:Ze,mode:"student",testId:C==null?void 0:C.test_id,testType:D});case Dr.FILL_BLANKS:return et===0?c.jsx(xre,{testText:M==null?void 0:M.test_text,blanks:(J||[]).map((rt,dt)=>{var Tt;return{id:rt.question_id||dt+1,options:rt.blank_options||[],correct_answer:((Tt=rt.correct_answers)==null?void 0:Tt[0])||rt.correct_answer,question:rt.question_json||""}}),separateType:M==null?void 0:M.separate_type,testId:C==null?void 0:C.test_id,testName:(M==null?void 0:M.test_name)||(C==null?void 0:C.test_name),teacherId:(M==null?void 0:M.teacher_id)||(C==null?void 0:C.teacher_id),subjectId:(M==null?void 0:M.subject_id)||(C==null?void 0:C.subject_id),onTestComplete:Ge,onAnswerChange:(rt,dt)=>{const Tt=J.findIndex(xe=>xe.question_id===rt);if(Tt!==-1){const xe=[...z];xe[Tt]=dt,H(xe),console.log(` Fill Blanks answer changed: question ${rt} = ${dt}`)}}},`fill-blanks-${C==null?void 0:C.test_id}-${M==null?void 0:M.test_name}`):null;default:return c.jsx("div",{children:"Unsupported question type"})}},[C,z,D]);function ht(){return!C||!M||!J?null:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("div",{className:"flex justify-between items-center mb-4",children:c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:M.test_name||M.title||"Test"})}),c.jsx("div",{className:"mb-4",children:c.jsx(pre,{answeredCount:kt(),totalQuestions:J.length,percentage:Math.round(U),timeElapsed:Number((M==null?void 0:M.allowed_time)||0)>0?ne:0,showDetails:!0})})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Answer all questions below:"}),c.jsx("div",{className:"space-y-8",children:J.map((Fe,et)=>c.jsx("div",{className:"question-container",children:it(Fe,et)},Fe.question_id||et))})]}),c.jsx("div",{className:"flex justify-center",children:c.jsx(He,{variant:"primary",size:"lg",onClick:Ge,disabled:se||kt()<J.length,loading:se,children:se?"Submitting...":`Submit Test (${kt()}/${J.length})`})})]})}if(d)return c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(nr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:e?"Starting Test...":"Loading Student Tests..."})]})});if(_)return c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Tests Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:_}),c.jsx(He,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return c.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsx("div",{children:c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Test"})}),c.jsx(He,{variant:"outline",onClick:zt,children:"Back to Cabinet"})]})})}),De&&E==="results"&&c.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mx-4 sm:mx-6 lg:mx-8 mt-4",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),c.jsx("div",{className:"ml-3",children:c.jsxs("p",{className:"text-sm text-red-700",children:[c.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",at," times during the test."]})})]})}),c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 overflow-y-auto",children:[!e&&E==="list"&&Ct(),E==="test"&&ht(),E==="results"&&jt()]}),E==="test"&&h&&c.jsxs("div",{className:"fixed inset-0 bg-white/80 backdrop-blur-[1px] flex flex-col items-center justify-center z-50",children:[c.jsx(nr,{size:"lg"}),c.jsx("p",{className:"mt-3 text-gray-700",children:"Preparing your test"}),x&&c.jsx("div",{className:"mt-3 text-sm text-gray-500",children:x})]}),c.jsx(TM,{isOpen:ee,onClose:()=>ve(!1),testType:_e==null?void 0:_e.test_type,testId:_e==null?void 0:_e.test_id,testName:_e==null?void 0:_e.test_name,questions:_e==null?void 0:_e.questions,isLoading:d}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:k.map(Fe=>c.jsx(Xi,{type:Fe.type,message:Fe.message,onClose:()=>N(et=>et.filter(Ze=>Ze.id!==Fe.id))},Fe.id))})]});function Ct(){return!a||a.length===0?c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No active tests available for your class."})}):c.jsx("div",{className:"space-y-6",children:a.map((Fe,et)=>c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:Fe.test_name}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Subject:"})," ",Fe.subject]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Teacher:"})," ",Fe.teacher_name]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Type:"})," ",Fe.test_type]})]}),c.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Assigned: ",new Date(Fe.assigned_at).toLocaleDateString()]})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx(He,{variant:"outline",onClick:()=>Me(Fe),disabled:w||d,children:"View Details"}),c.jsx(He,{variant:"primary",onClick:()=>Ie(Fe),disabled:w||d,children:w?"Starting...":"Start Test"})]})]})},et))})}function jt(){if(!C||!M||!J||!z)return null;const Fe={};return z.forEach((et,Ze)=>{if(J[Ze]){const rt=J[Ze].question_id||J[Ze].id||Ze;Fe[String(rt)]=et,console.log(" Converting answer:",{index:Ze,questionId:rt,answer:et,question:J[Ze]})}}),console.log(" Final answersObject:",Fe),console.log(" Questions structure:",J.map(et=>({id:et.question_id,correct_answer:et.correct_answer}))),c.jsx(Zre,{testInfo:M,questions:J,testType:C.test_type,studentAnswers:Fe,onBackToCabinet:zt,checkAnswerCorrectness:qf,formatStudentAnswerForDisplay:bt,getCorrectAnswer:Lg})}},tne=()=>{const{testId:t}=Jk(),e=Ha(),{user:r}=xn(),{makeAuthenticatedRequest:n}=Ji(),{showNotification:s}=Ys(),[a,i]=b.useState(null),[o,l]=b.useState(!0),[u,d]=b.useState(null),[g,h]=b.useState(null),[p,x]=b.useState(!1);Em("matching_type",a==null?void 0:a.id);const v=b.useCallback(()=>{if(!(r!=null&&r.student_id)||!t)return!1;const k=`test_completed_${r.student_id}_matching_type_${t}`,N=localStorage.getItem(k)==="true",E=`retest1_${r.student_id}_matching_type_${t}`,A=localStorage.getItem(E)==="true";return N&&!A?(console.log(" Test already completed, redirecting to cabinet"),s("This test has already been completed","info"),e("/student"),!0):!1},[r==null?void 0:r.student_id,t,e,s]),w=b.useCallback(async()=>{if(!t){d("Test ID is required"),l(!1);return}if(!v())try{l(!0),d(null);const k=await n(`/.netlify/functions/get-matching-type-test?test_id=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!k.ok)throw new Error("Failed to load test data");const N=await k.json();if(!N.success)throw new Error(N.message||"Failed to load test");const E=N.data;console.log(" Test data from get-matching-type-test:",E);const A=await n(`/.netlify/functions/get-test-questions?test_id=${t}&test_type=matching_type`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!A.ok)throw new Error("Failed to load test questions");const C=await A.json();if(!C.success)throw new Error(C.message||"Failed to load test questions");console.log(" Questions data from get-test-questions:",C);const F={id:E.test_id,test_name:E.test_name,teacher_id:E.teacher_id,subject_id:E.subject_id,image_url:E.image_url,image:null,blocks:(()=>{if(Array.isArray(C.questions)&&C.questions.length>0){const D=C.questions[0];return Array.isArray(D.blocks)?D.blocks.map((R,M)=>{let B=R.block_coordinates||R.coordinates||(typeof R.x=="number"?{x:R.x,y:R.y,width:R.width,height:R.height}:null);if(typeof B=="string")try{B=JSON.parse(B)}catch{B=null}return(!B||typeof B!="object")&&(B={x:0,y:0,width:30,height:10}),B={x:(typeof B.x=="number"?B.x:Number(B.x))||0,y:(typeof B.y=="number"?B.y:Number(B.y))||0,width:(typeof B.width=="number"?B.width:Number(B.width))||30,height:(typeof B.height=="number"?B.height:Number(B.height))||10},{id:R.block_id||R.question_id||R.id||M+1,word:R.word||`Word ${M+1}`,coordinates:B,hasArrow:!!R.has_arrow,arrow:R.arrow||null}}):C.questions.map(R=>{console.log(" Processing question:",R);let M;try{M=typeof R.block_coordinates=="string"?JSON.parse(R.block_coordinates):R.block_coordinates}catch{M={x:0,y:0,width:100,height:100}}return(!M||typeof M!="object")&&(M={x:0,y:0,width:100,height:100}),M={x:(typeof M.x=="number"?M.x:Number(M.x))||0,y:(typeof M.y=="number"?M.y:Number(M.y))||0,width:(typeof M.width=="number"?M.width:Number(M.width))||100,height:(typeof M.height=="number"?M.height:Number(M.height))||100},{id:R.question_id,word:R.word,coordinates:M,hasArrow:R.has_arrow,arrow:R.arrow}})}return[]})(),words:(()=>{if(Array.isArray(C.questions)&&C.questions.length>0){const D=C.questions[0];if(Array.isArray(D.words)){const R=D.words,M=Array.isArray(D.blocks)?D.blocks:[];return typeof R[0]=="string"?R.map((J,X)=>{var H,U,L;return{id:`w_${((H=M[X])==null?void 0:H.question_id)||((U=M[X])==null?void 0:U.block_id)||((L=C.questions[X])==null?void 0:L.question_id)||X+1}_${X}`,word:String(J),blockId:null,isPlaced:!1,isCorrect:!1}}):R.map((J,X)=>({id:`w_${J.question_id||J.id||X+1}_${X}`,word:J.word||String(J.text||""),blockId:null,isPlaced:!1,isCorrect:!1}))}return C.questions.map(R=>({id:`w_${R.question_id}`,word:R.word,blockId:null,isPlaced:!1,isCorrect:!1}))}return[]})(),arrows:E.arrows?E.arrows.map(D=>(console.log(" Processing arrow:",D),{id:D.id,questionId:D.question_id,blockId:D.block_id||D.question_id,start:{x:Number(D.start_x)||0,y:Number(D.start_y)||0},end:{x:Number(D.end_x)||0,y:Number(D.end_y)||0},rel_start_x:D.rel_start_x!==null?Number(D.rel_start_x):null,rel_start_y:D.rel_start_y!==null?Number(D.rel_start_y):null,rel_end_x:D.rel_end_x!==null?Number(D.rel_end_x):null,rel_end_y:D.rel_end_y!==null?Number(D.rel_end_y):null,image_width:D.image_width?Number(D.image_width):null,image_height:D.image_height?Number(D.image_height):null,style:(typeof D.style=="string"?JSON.parse(D.style):D.style)||{color:"#dc3545",thickness:3}})):[]};if(E.image_url){const D=new Image;D.crossOrigin="anonymous",D.onload=()=>{F.image=D,i(F),l(!1)},D.onerror=()=>{console.warn("Failed to load test image"),i(F),l(!1)},D.src=E.image_url}else i(F),l(!1)}catch(k){console.error("Error loading test data:",k),d(k.message||"Failed to load test"),l(!1)}},[t,n]);b.useEffect(()=>{r!=null&&r.student_id&&w()},[w,r==null?void 0:r.student_id]);const S=b.useCallback(async k=>{var F,D,R;console.log("Test completed:",k),s("Test completed successfully!","success");const N=parseInt(k)||0,E=((F=a==null?void 0:a.blocks)==null?void 0:F.length)||((D=a==null?void 0:a.words)==null?void 0:D.length)||0,A=E>0?Math.round(N/E*100):0,C={showResults:!0,testInfo:{test_name:(a==null?void 0:a.test_name)||"Test",id:a==null?void 0:a.id,test_id:a==null?void 0:a.id},testType:"matching_type",score:N,totalQuestions:E,percentage:A,passed:A>=60,questionAnalysis:((R=a==null?void 0:a.questions)==null?void 0:R.map((M,B)=>({questionNumber:B+1,isCorrect:B<N,userAnswer:B<N?`Matched: ${M.word}`:"Not answered",correctAnswer:`Match: ${M.word}`})))||Array.from({length:E},(M,B)=>({questionNumber:B+1,isCorrect:B<N,userAnswer:B<N?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};console.log(" Using test results data:",C),h(C),x(!0)},[a,s]),_=b.useCallback(()=>{e("/student")},[e]),y=b.useCallback(()=>{x(!1),h(null),w()},[w]);return o?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(st,{className:"max-w-md w-full",children:c.jsxs(st.Body,{className:"text-center",children:[c.jsx(nr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading test..."})]})})}):u?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(st,{className:"max-w-md w-full",children:c.jsxs(st.Body,{className:"text-center",children:[c.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Test"}),c.jsx("p",{className:"text-gray-600 mb-4",children:u}),c.jsx("button",{onClick:_,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})}):a?p&&g?c.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:c.jsx(GT,{testResults:g,onBackToCabinet:_,onRetakeTest:y,isLoading:!1})}):c.jsx(lre,{testData:a,onTestComplete:S,onBackToCabinet:_}):c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(st,{className:"max-w-md w-full",children:c.jsxs(st.Body,{className:"text-center",children:[c.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load test data"}),c.jsx("button",{onClick:_,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})})},rne=()=>{const{testId:t}=Jk(),e=Ha(),{user:r}=xn(),{makeAuthenticatedRequest:n}=Ji(),{showNotification:s}=Ys(),[a,i]=b.useState(null),[o,l]=b.useState(!0),[u,d]=b.useState(null),[g,h]=b.useState(null),[p,x]=b.useState(!1),v=b.useCallback(()=>{if(!(r!=null&&r.student_id)||!t)return!1;const y=`test_completed_${r.student_id}_word_matching_${t}`,k=`retest1_${r.student_id}_word_matching_${t}`;return localStorage.getItem(k)==="true"?!1:localStorage.getItem(y)==="true"},[r==null?void 0:r.student_id,t]),w=b.useCallback(async()=>{if(!t){d("Test ID is required"),l(!1);return}if(v()){s("This test has already been completed","warning"),e("/student");return}l(!0),d(null);try{const y=`word_matching_test_${t}`,k=nn(y);if(k){if(console.log(" Word matching test loaded from cache:",k),k.id){let A=k;if(Array.isArray(A.rightWords)&&Array.isArray(A.correctPairs)){const C=A.rightWords.map((M,B)=>B);for(let M=C.length-1;M>0;M--){const B=Math.floor(Math.random()*(M+1));[C[M],C[B]]=[C[B],C[M]]}const F=C.map(M=>A.rightWords[M]),D=new Map(C.map((M,B)=>[M,B])),R=A.correctPairs.map(M=>D.get(M));A={...A,rightWords:F,correctPairs:R}}i(A)}else{let C={id:k.test_id,test_id:k.test_id,test_name:k.test_name,teacher_id:k.teacher_id,subject_id:k.subject_id,num_questions:k.num_questions,interaction_type:k.interaction_type,passing_score:k.passing_score,created_at:k.created_at,updated_at:k.updated_at,leftWords:k.leftWords,rightWords:k.rightWords,correctPairs:k.correctPairs,originalPairs:k.originalPairs};if(Array.isArray(C.rightWords)&&Array.isArray(C.correctPairs)){const F=C.rightWords.map((B,J)=>J);for(let B=F.length-1;B>0;B--){const J=Math.floor(Math.random()*(B+1));[F[B],F[J]]=[F[J],F[B]]}const D=F.map(B=>C.rightWords[B]),R=new Map(F.map((B,J)=>[B,J])),M=C.correctPairs.map(B=>R.get(B));C={...C,rightWords:D,correctPairs:M}}i(C)}l(!1);return}const E=await(await n(`/.netlify/functions/get-word-matching-test?test_id=${t}`)).json();if(E.success){const A={id:E.data.test_id,test_id:E.data.test_id,test_name:E.data.test_name,teacher_id:E.data.teacher_id,subject_id:E.data.subject_id,num_questions:E.data.num_questions,interaction_type:E.data.interaction_type,passing_score:E.data.passing_score,created_at:E.data.created_at,updated_at:E.data.updated_at,leftWords:E.data.leftWords,rightWords:E.data.rightWords,correctPairs:E.data.correctPairs,originalPairs:E.data.originalPairs};let C=A;if(Array.isArray(C.rightWords)&&Array.isArray(C.correctPairs)){const F=C.rightWords.map((B,J)=>J);for(let B=F.length-1;B>0;B--){const J=Math.floor(Math.random()*(B+1));[F[B],F[J]]=[F[J],F[B]]}const D=F.map(B=>C.rightWords[B]),R=new Map(F.map((B,J)=>[B,J])),M=C.correctPairs.map(B=>R.get(B));C={...C,rightWords:D,correctPairs:M}}i(C),zr(y,C,Xr.word_matching_test),console.log(" Word matching test loaded from API and cached:",A)}else throw new Error(E.message||"Failed to load test")}catch(y){console.error("Error loading word matching test:",y),d(y.message),s("Failed to load test: "+y.message,"error")}finally{l(!1)}},[t,v,n,s,e]),S=b.useCallback(async y=>{console.log("Test completed:",y),s("Test completed successfully!","success");const k=parseInt(y)||0,N=(a==null?void 0:a.num_questions)||0,E=N>0?Math.round(k/N*100):0,A={showResults:!0,testInfo:{test_name:(a==null?void 0:a.test_name)||"Test",id:a==null?void 0:a.id,test_id:a==null?void 0:a.id},testType:"word_matching",score:k,totalQuestions:N,percentage:E,passed:E>=60,questionAnalysis:Array.isArray(a==null?void 0:a.correctPairs)?a.correctPairs.map((C,F)=>({questionNumber:F+1,isCorrect:F<k,userAnswer:F<k?`${C.left}  ${C.right}`:"Not answered",correctAnswer:`${C.left}  ${C.right}`})):Array.from({length:N},(C,F)=>({questionNumber:F+1,isCorrect:F<k,userAnswer:F<k?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};console.log(" Using test results data:",A),h(A),x(!0)},[a,s]),_=b.useCallback(()=>{e("/student")},[e]);return b.useEffect(()=>{w()},[w]),o?c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsxs(st,{className:"p-8 text-center",children:[c.jsx(nr,{size:"lg",className:"mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading word matching test..."})]})}):u?c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsx(st,{className:"p-8 text-center",children:c.jsxs("div",{className:"text-red-600 mb-4",children:[c.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error Loading Test"}),c.jsx("p",{className:"text-gray-600 mb-4",children:u}),c.jsx("button",{onClick:()=>e("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})}):a?p&&g?c.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:c.jsx(GT,{testResults:g,onBackToCabinet:()=>{h(null),x(!1),e("/student")},onRetakeTest:(y,k)=>{h(null),x(!1),w()},isLoading:!1})}):c.jsx(Be.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"min-h-screen bg-gray-50 py-8",children:c.jsx(dre,{testData:a,onTestComplete:S,onBackToCabinet:_})}):c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsx(st,{className:"p-8 text-center",children:c.jsxs("div",{className:"text-gray-600 mb-4",children:[c.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Test Not Found"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"The requested test could not be found."}),c.jsx("button",{onClick:()=>e("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})})},nne=()=>{const{testType:t,testId:e}=Jk(),r=Ha(),{activeTests:n}=Nm(),s=()=>{r("/student")},a=n.find(i=>i.test_type===t&&i.test_id===parseInt(e));return c.jsx(ene,{onBackToCabinet:s,currentTest:a||{test_type:t,test_id:parseInt(e)}})},sne=()=>{const t=Ha(),{user:e,isAuthenticated:r,isLoading:n}=xn(),[s,a]=b.useState(!1),[i,o]=b.useState(!0),[l,u]=b.useState(""),[d,g]=b.useState([]),[h,p]=b.useState(!1),[x,v]=b.useState(!1),[w,S]=b.useState({currentPassword:"",newPassword:"",confirmPassword:""}),_=b.useCallback(async()=>{console.log(" Initializing Student Application...");try{if(o(!0),u(""),!r||!e){console.log(" User not authenticated, redirecting to login"),t("/login");return}if(e.role!==ra.STUDENT){console.error(" Invalid user role for student app:",e.role),u("Access denied. Student role required.");return}console.log(" Initializing event listeners..."),y(),console.log(" Setting up back to cabinet button listeners..."),k(),console.log(" Setting up password change form listener..."),N(),console.log(" Loading student data..."),await E(),console.log(" Exposing student functions globally..."),A(),console.log(" Populating student info from user data..."),B(e),a(!0),console.log(" Student Application initialization complete!")}catch(z){console.error(" Error initializing student app:",z),u("Failed to initialize student application")}finally{o(!1)}},[r,e,t]);b.useEffect(()=>{n||_()},[n,r,e,_]);const y=b.useCallback(()=>{console.log(" Setting up student event listeners...");const z=U=>{h&&!U.target.closest(".student-menu")&&p(!1)},H=U=>{U.key==="Escape"&&h&&p(!1)};return document.addEventListener("click",z),document.addEventListener("keydown",H),()=>{document.removeEventListener("click",z),document.removeEventListener("keydown",H)}},[h]),k=b.useCallback(()=>{console.log(" Setting up back to cabinet listeners...")},[]),N=b.useCallback(()=>{console.log(" Setting up password change form...")},[]),E=b.useCallback(async()=>{console.log(" Loading student data...");try{console.log(" Student data loaded successfully")}catch(z){throw console.error(" Error loading student data:",z),z}},[]),A=b.useCallback(()=>{console.log(" Exposing student functions globally..."),window.toggleStudentMenu=C,window.showChangePasswordTab=F,window.hideChangePasswordTab=D,window.navigateBackToCabinet=M,window.handlePasswordChange=R,window.populateStudentInfoDirectly=B,console.log(" All student functions exposed globally")},[]),C=b.useCallback(()=>{console.log(" toggleStudentMenu called"),p(z=>{const H=!z;return console.log(" Menu state changed from",z,"to",H),H}),console.log(" Toggled dropdown menu")},[]),F=b.useCallback(()=>{console.log(" showChangePasswordTab called"),v(!0),p(!1)},[]),D=b.useCallback(()=>{console.log(" hideChangePasswordTab called"),v(!1),S({currentPassword:"",newPassword:"",confirmPassword:""})},[]),R=b.useCallback(async z=>{z.preventDefault(),console.log(" handlePasswordChange called");const{currentPassword:H,newPassword:U,confirmPassword:L}=w;if(!H||!U||!L){J("Please fill in all fields","error");return}if(U!==L){J("New passwords do not match","error");return}if(U.length<3){J("New password must be at least 3 characters long","error");return}if(!e||!e.student_id){J("Session expired. Please login again.","error");return}const ne=e.student_id;if(window.confirm("Are you sure you want to change your password?"))try{o(!0);const de=await $r.changePassword({studentId:ne,currentPassword:H,newPassword:U});de.success?(J("Password changed successfully!","success"),D()):J(de.message||"Failed to change password","error")}catch(de){console.error("Password change error:",de),J("Failed to change password. Please try again.","error")}finally{o(!1)}},[w,e]),M=b.useCallback(()=>{if(console.log("[DEBUG] navigateBackToCabinet called"),!r||!e){console.warn("[WARN] No valid user found, redirecting to login"),t("/login");return}e.role===ra.STUDENT?(console.log("[DEBUG] Navigating to student cabinet"),t("/student")):(console.warn("[WARN] Unknown user role, redirecting to login"),t("/login"))},[r,e,t]),B=b.useCallback(z=>{console.log(" populateStudentInfoDirectly called with:",z);try{console.log(" Student info populated successfully")}catch(H){console.error(" Error populating student info:",H)}},[]),J=b.useCallback((z,H)=>{const U={id:Date.now(),message:z,type:H,timestamp:new Date};g(L=>[...L,U]),setTimeout(()=>{g(L=>L.filter(ne=>ne.id!==U.id))},ya.NOTIFICATION_DURATION)},[]),X=b.useCallback(z=>{const{name:H,value:U}=z.target;S(L=>({...L,[H]:U}))},[]);return i?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(nr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Initializing Student Application..."})]})}):l?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Initialization Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:l}),c.jsx(He,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?c.jsxs("div",{className:"bg-gray-50",children:[c.jsxs(Qk,{children:[c.jsx(Fn,{path:"/",element:c.jsxs("div",{className:"student-app",children:[c.jsx(qre,{isMenuOpen:h,onToggleMenu:C,onShowPasswordChange:F}),x&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Change Password"}),c.jsxs("form",{onSubmit:R,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),c.jsx("input",{type:"password",id:"currentPassword",name:"currentPassword",value:w.currentPassword,onChange:X,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),c.jsx("input",{type:"password",id:"newPassword",name:"newPassword",value:w.newPassword,onChange:X,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),c.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:w.confirmPassword,onChange:X,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),c.jsxs("div",{className:"flex space-x-3 pt-4",children:[c.jsx(He,{type:"button",variant:"secondary",onClick:D,className:"flex-1",children:"Cancel"}),c.jsx(He,{type:"submit",variant:"primary",disabled:i,className:"flex-1",children:i?c.jsxs(c.Fragment,{children:[c.jsx(nr,{size:"sm",className:"mr-2"}),"Changing..."]}):"Change Password"})]})]})]})})]})}),c.jsx(Fn,{path:"/test/:testType/:testId",element:c.jsx(nne,{})}),c.jsx(Fn,{path:"matching-test/:testId",element:c.jsx(tne,{})}),c.jsx(Fn,{path:"word-matching-test/:testId",element:c.jsx(rne,{})}),c.jsx(Fn,{path:"/results",element:c.jsx(MM,{})})]}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:d.map(z=>c.jsx(Xi,{type:z.type,message:z.message,onClose:()=>g(H=>H.filter(U=>U.id!==z.id))},z.id))})]}):c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(nr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Setting up Student Application..."})]})})},ane=()=>c.jsx(QP,{children:c.jsx(CM,{children:c.jsx(SM,{children:c.jsx(sne,{})})})});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var K1={};K1.version="0.18.5";var LM=1252,ine=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],VT={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},KT=function(t){ine.indexOf(t)!=-1&&(LM=VT[0]=t)};function one(){KT(1252)}var Bi=function(t){KT(t)};function XT(){Bi(1200),one()}function d8(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function lne(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function IM(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var S0=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?lne(t.slice(2)):e==254&&r==255?IM(t.slice(2)):e==65279?t.slice(1):t},ux=function(e){return String.fromCharCode(e)},f8=function(e){return String.fromCharCode(e)},Ig,Zl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Og(t){for(var e="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),a=r>>2,n=t.charCodeAt(u++),i=(r&3)<<4|n>>4,s=t.charCodeAt(u++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=Zl.charAt(a)+Zl.charAt(i)+Zl.charAt(o)+Zl.charAt(l);return e}function $a(t){var e="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)a=Zl.indexOf(t.charAt(u++)),i=Zl.indexOf(t.charAt(u++)),r=a<<2|i>>4,e+=String.fromCharCode(r),o=Zl.indexOf(t.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Zl.indexOf(t.charAt(u++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var lr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Tl=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function wc(t){return lr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function h8(t){return lr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ma=function(e){return lr?Tl(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Ov(t){if(typeof ArrayBuffer>"u")return Ma(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Uc(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function cne(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function YT(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return YT(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var hs=lr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Tl(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function une(t){for(var e=[],r=0,n=t.length+250,s=wc(t.length+255),a=0;a<t.length;++a){var i=t.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=t.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(e.push(s.slice(0,r)),r=0,s=wc(65535),n=65530)}return e.push(s.slice(0,r)),hs(e)}var oa=/\u0000/g,k0=/[\u0001-\u0006]/g;function jf(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Ui(t,e){var r=""+t;return r.length>=e?r:Sn("0",e-r.length)+r}function JT(t,e){var r=""+t;return r.length>=e?r:Sn(" ",e-r.length)+r}function X1(t,e){var r=""+t;return r.length>=e?r:r+Sn(" ",e-r.length)}function dne(t,e){var r=""+Math.round(t);return r.length>=e?r:Sn("0",e-r.length)+r}function fne(t,e){var r=""+t;return r.length>=e?r:Sn("0",e-r.length)+r}var g8=Math.pow(2,32);function $d(t,e){if(t>g8||t<-g8)return dne(t,e);var r=Math.round(t);return fne(r,e)}function Y1(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var m8=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],v2=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function hne(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Gt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},p8={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},gne={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function J1(t,e,r){for(var n=t<0?-1:1,s=t*n,a=0,i=1,o=0,l=1,u=0,d=0,g=Math.floor(s);u<e&&(g=Math.floor(s),o=g*i+a,d=g*u+l,!(s-g<5e-8));)s=1/(s-g),a=i,i=o,l=u,u=d;if(d>e&&(u>e?(d=l,o=a):(d=u,o=i)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function pu(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),a=0,i=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=wne(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var OM=new Date(1899,11,31,0,0,0),mne=OM.getTime(),pne=new Date(1900,2,1,0,0,0);function BM(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=pne&&(r+=24*60*60*1e3),(r-(mne+(t.getTimezoneOffset()-OM.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function QT(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function xne(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function yne(t){var e=t<0?12:11,r=QT(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function vne(t){var e=QT(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Bg(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=yne(t):e===10?r=t.toFixed(10).substr(0,12):r=vne(t),QT(xne(r.toUpperCase()))}function Yu(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Bg(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return bi(14,BM(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function wne(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function _ne(t,e,r,n){var s="",a=0,i=0,o=r.y,l,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return v2[r.m-1][1];case 5:return v2[r.m-1][0];default:return v2[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return m8[r.q][0];default:return m8[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Ui(r.S,e.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),e==="s"?a===0?"0":""+a/i:(s=Ui(a,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var d=u>0?Ui(l,u):"";return d}function ec(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var UM=/%/g;function bne(t,e,r){var n=e.replace(UM,""),s=e.length-n.length;return ol(t,n,r*Math.pow(10,2*s))+Sn("%",s)}function Sne(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ol(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function $M(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+$M(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,d){return l+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var WM=/# (\?+)( ?)\/( ?)(\d+)/;function kne(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Sn(" ",t[1].length+1+t[4].length):JT(i,t[1].length)+t[2]+"/"+t[3]+Ui(o,t[4].length))}function Cne(t,e,r){return r+(e===0?"":""+e)+Sn(" ",t[1].length+2+t[4].length)}var zM=/^#*0*\.([0#]+)/,HM=/\).*[0#]/,GM=/\(###\) ###\\?-####/;function ea(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function x8(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function y8(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Tne(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Ene(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ni(t,e,r){if(t.charCodeAt(0)===40&&!e.match(HM)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ni("n",n,r):"("+ni("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Sne(t,e,r);if(e.indexOf("%")!==-1)return bne(t,e,r);if(e.indexOf("E")!==-1)return $M(e,r);if(e.charCodeAt(0)===36)return"$"+ni(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+$d(l,e.length);if(e.match(/^[#?]+$/))return s=$d(r,0),s==="0"&&(s=""),s.length>e.length?s:ea(e.substr(0,e.length-s.length))+s;if(a=e.match(WM))return kne(a,l,u);if(e.match(/^#+0+$/))return u+$d(l,e.length-e.indexOf("0"));if(a=e.match(zM))return s=x8(r,a[1].length).replace(/^([^\.]+)$/,"$1."+ea(a[1])).replace(/\.$/,"."+ea(a[1])).replace(/\.(\d*)$/,function(x,v){return"."+v+Sn("0",ea(a[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return u+x8(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return u+ec($d(l,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ni(t,e,-r):ec(""+(Math.floor(r)+Tne(r,a[1].length)))+"."+Ui(y8(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return ni(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=jf(ni(t,e.replace(/[\\-]/g,""),r)),i=0,jf(jf(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(e.match(GM))return s=ni(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=J1(l,Math.pow(10,i)-1,!1),s=""+u,d=ol("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=X1(o[2],i),d.length<a[4].length&&(d=ea(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=J1(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?JT(o[1],i)+a[2]+"/"+a[3]+X1(o[2],i):Sn(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=$d(r,0),e.length<=s.length?s:ea(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var g=e.indexOf(".")-i,h=e.length-s.length-g;return ea(e.substr(0,g)+s+e.substr(e.length-h))}if(a=e.match(/^00,000\.([#0]*0)$/))return i=y8(r,a[1].length),r<0?"-"+ni(t,e,-r):ec(Ene(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ui(0,3-x.length):"")+x})+"."+Ui(i,a[1].length);switch(e){case"###,##0.00":return ni(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=ec($d(l,0));return p!=="0"?u+p:"";case"###,###.00":return ni(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ni(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Nne(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ol(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Ane(t,e,r){var n=e.replace(UM,""),s=e.length-n.length;return ol(t,n,r*Math.pow(10,2*s))+Sn("%",s)}function VM(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+VM(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,d){return l+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function co(t,e,r){if(t.charCodeAt(0)===40&&!e.match(HM)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?co("n",n,r):"("+co("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Nne(t,e,r);if(e.indexOf("%")!==-1)return Ane(t,e,r);if(e.indexOf("E")!==-1)return VM(e,r);if(e.charCodeAt(0)===36)return"$"+co(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Ui(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:ea(e.substr(0,e.length-s.length))+s;if(a=e.match(WM))return Cne(a,l,u);if(e.match(/^#+0+$/))return u+Ui(l,e.length-e.indexOf("0"));if(a=e.match(zM))return s=(""+r).replace(/^([^\.]+)$/,"$1."+ea(a[1])).replace(/\.$/,"."+ea(a[1])),s=s.replace(/\.(\d*)$/,function(x,v){return"."+v+Sn("0",ea(a[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return u+ec(""+l);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+co(t,e,-r):ec(""+r)+"."+Sn("0",a[1].length);if(a=e.match(/^#,#*,#0/))return co(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=jf(co(t,e.replace(/[\\-]/g,""),r)),i=0,jf(jf(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(e.match(GM))return s=co(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=J1(l,Math.pow(10,i)-1,!1),s=""+u,d=ol("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=X1(o[2],i),d.length<a[4].length&&(d=ea(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=J1(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?JT(o[1],i)+a[2]+"/"+a[3]+X1(o[2],i):Sn(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:ea(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var g=e.indexOf(".")-i,h=e.length-s.length-g;return ea(e.substr(0,g)+s+e.substr(e.length-h))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+co(t,e,-r):ec(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ui(0,3-x.length):"")+x})+"."+Ui(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=ec(""+l);return p!=="0"?u+p:"";default:if(e.match(/\.[0#?]*$/))return co(t,e.slice(0,e.lastIndexOf(".")),r)+ea(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ol(t,e,r){return(r|0)===r?co(t,e,r):ni(t,e,r)}function jne(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var KM=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ah(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Y1(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(KM))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Fne(t,e,r,n){for(var s=[],a="",i=0,o="",l="t",u,d,g,h="H";i<t.length;)switch(o=t.charAt(i)){case"G":if(!Y1(t,i))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(g=t.charCodeAt(++i))!==34&&i<t.length;)a+=String.fromCharCode(g);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=t.charAt(++i),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:e},++i;break;case"B":case"b":if(t.charAt(i+1)==="1"||t.charAt(i+1)==="2"){if(u==null&&(u=pu(e,r,t.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:t.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=pu(e,r),u==null))return"";for(a=o;++i<t.length&&t.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var v={t:o,v:o};if(u==null&&(u=pu(e,r)),t.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(v.v=u.H>=12?"P":"A"),v.t="T",h="h",i+=3):t.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(v.v=u.H>=12?"PM":"AM"),v.t="T",i+=5,h="h"):t.substr(i,5).toUpperCase()==="/"?(u!=null&&(v.v=u.H>=12?"":""),v.t="T",i+=5,h="h"):(v.t="t",++i),u==null&&v.t==="T")return"";s[s.length]=v,l=o;break;case"[":for(a=o;t.charAt(i++)!=="]"&&i<t.length;)a+=t.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(KM)){if(u==null&&(u=pu(e,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ah(t)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<t.length&&(o=t.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;t.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(t.charAt(i)==" "||t.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<t.length&&"0123456789".indexOf(t.charAt(++i))>-1;)a+=t.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++i;break}var w=0,S=0,_;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=h,l="h",w<1&&(w=1);break;case"s":(_=s[i].v.match(/\.0+$/))&&(S=Math.max(S,_[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[i].v.match(/[Hh]/)&&(w=1),w<2&&s[i].v.match(/[Mm]/)&&(w=2),w<3&&s[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",k;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=_ne(s[i].t.charCodeAt(0),s[i].v,u,S),s[i].t="t";break;case"n":case"?":for(k=i+1;s[k]!=null&&((o=s[k].t)==="?"||o==="D"||(o===" "||o==="t")&&s[k+1]!=null&&(s[k+1].t==="?"||s[k+1].t==="t"&&s[k+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[k].v==="/"||s[k].v===" "&&s[k+1]!=null&&s[k+1].t=="?"));)s[i].v+=s[k].v,s[k]={v:"",t:";"},++k;y+=s[i].v,i=k-1;break;case"G":s[i].t="t",s[i].v=Yu(e,r);break}var N="",E,A;if(y.length>0){y.charCodeAt(0)==40?(E=e<0&&y.charCodeAt(0)===45?-e:e,A=ol("n",y,E)):(E=e<0&&n>1?-e:e,A=ol("n",y,E),E<0&&s[0]&&s[0].t=="t"&&(A=A.substr(1),s[0].v="-"+s[0].v)),k=A.length-1;var C=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){C=i;break}var F=s.length;if(C===s.length&&A.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(k>=s[i].v.length-1?(k-=s[i].v.length,s[i].v=A.substr(k+1,s[i].v.length)):k<0?s[i].v="":(s[i].v=A.substr(0,k+1),k=-1),s[i].t="t",F=i);k>=0&&F<s.length&&(s[F].v=A.substr(0,k+1)+s[F].v)}else if(C!==s.length&&A.indexOf("E")===-1){for(k=A.indexOf(".")-1,i=C;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===C?s[i].v.indexOf(".")-1:s[i].v.length-1,N=s[i].v.substr(d+1);d>=0;--d)k>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(N=A.charAt(k--)+N);s[i].v=N,s[i].t="t",F=i}for(k>=0&&F<s.length&&(s[F].v=A.substr(0,k+1)+s[F].v),k=A.indexOf(".")+1,i=C;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==C)){for(d=s[i].v.indexOf(".")>-1&&i===C?s[i].v.indexOf(".")+1:0,N=s[i].v.substr(0,d);d<s[i].v.length;++d)k<A.length&&(N+=A.charAt(k++));s[i].v=N,s[i].t="t",F=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(E=n>1&&e<0&&i>0&&s[i-1].v==="-"?-e:e,s[i].v=ol(s[i].t,s[i].v,E),s[i].t="t");var D="";for(i=0;i!==s.length;++i)s[i]!=null&&(D+=s[i].v);return D}var v8=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function w8(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function Pne(t,e){var r=jne(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(v8),o=r[1].match(v8);return w8(e,i)?[n,r[0]]:w8(e,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function bi(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Gt)[t],n==null&&(n=r.table&&r.table[p8[t]]||Gt[p8[t]]),n==null&&(n=gne[t]||"General");break}if(Y1(n,0))return Yu(e,r);e instanceof Date&&(e=BM(e,r.date1904));var s=Pne(n,e);if(Y1(s[1]))return Yu(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Fne(s[1],e,r,s[0])}function ll(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Gt[r]==null){e<0&&(e=r);continue}if(Gt[r]==t){e=r;break}}e<0&&(e=391)}return Gt[e]=t,e}function Bv(t){for(var e=0;e!=392;++e)t[e]!==void 0&&ll(t[e],e)}function jh(){Gt=hne()}var Dne={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},XM=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Rne(t){var e=typeof t=="number"?Gt[t]:t;return e=e.replace(XM,"(\\d+)"),new RegExp("^"+e+"$")}function Mne(t,e,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(e.match(XM)||[]).forEach(function(g,h){var p=parseInt(r[h+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var Lne=function(){var t={};t.version="1.2.0";function e(){for(var A=0,C=new Array(256),F=0;F!=256;++F)A=F,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,C[F]=A;return typeof Int32Array<"u"?new Int32Array(C):C}var r=e();function n(A){var C=0,F=0,D=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)R[D]=A[D];for(D=0;D!=256;++D)for(F=A[D],C=256+D;C<4096;C+=256)F=R[C]=F>>>8^A[F&255];var M=[];for(D=1;D!=16;++D)M[D-1]=typeof Int32Array<"u"?R.subarray(D*256,D*256+256):R.slice(D*256,D*256+256);return M}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],u=s[4],d=s[5],g=s[6],h=s[7],p=s[8],x=s[9],v=s[10],w=s[11],S=s[12],_=s[13],y=s[14];function k(A,C){for(var F=C^-1,D=0,R=A.length;D<R;)F=F>>>8^r[(F^A.charCodeAt(D++))&255];return~F}function N(A,C){for(var F=C^-1,D=A.length-15,R=0;R<D;)F=y[A[R++]^F&255]^_[A[R++]^F>>8&255]^S[A[R++]^F>>16&255]^w[A[R++]^F>>>24]^v[A[R++]]^x[A[R++]]^p[A[R++]]^h[A[R++]]^g[A[R++]]^d[A[R++]]^u[A[R++]]^l[A[R++]]^o[A[R++]]^i[A[R++]]^a[A[R++]]^r[A[R++]];for(D+=15;R<D;)F=F>>>8^r[(F^A[R++])&255];return~F}function E(A,C){for(var F=C^-1,D=0,R=A.length,M=0,B=0;D<R;)M=A.charCodeAt(D++),M<128?F=F>>>8^r[(F^M)&255]:M<2048?(F=F>>>8^r[(F^(192|M>>6&31))&255],F=F>>>8^r[(F^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,B=A.charCodeAt(D++)&1023,F=F>>>8^r[(F^(240|M>>8&7))&255],F=F>>>8^r[(F^(128|M>>2&63))&255],F=F>>>8^r[(F^(128|B>>6&15|(M&3)<<4))&255],F=F>>>8^r[(F^(128|B&63))&255]):(F=F>>>8^r[(F^(224|M>>12&15))&255],F=F>>>8^r[(F^(128|M>>6&63))&255],F=F>>>8^r[(F^(128|M&63))&255]);return~F}return t.table=r,t.bstr=k,t.buf=N,t.str=E,t}(),Wt=function(){var e={};e.version="1.2.1";function r(Y,fe){for(var ae=Y.split("/"),ce=fe.split("/"),ge=0,V=0,ie=Math.min(ae.length,ce.length);ge<ie;++ge){if(V=ae[ge].length-ce[ge].length)return V;if(ae[ge]!=ce[ge])return ae[ge]<ce[ge]?-1:1}return ae.length-ce.length}function n(Y){if(Y.charAt(Y.length-1)=="/")return Y.slice(0,-1).indexOf("/")===-1?Y:n(Y.slice(0,-1));var fe=Y.lastIndexOf("/");return fe===-1?Y:Y.slice(0,fe+1)}function s(Y){if(Y.charAt(Y.length-1)=="/")return s(Y.slice(0,-1));var fe=Y.lastIndexOf("/");return fe===-1?Y:Y.slice(fe+1)}function a(Y,fe){typeof fe=="string"&&(fe=new Date(fe));var ae=fe.getHours();ae=ae<<6|fe.getMinutes(),ae=ae<<5|fe.getSeconds()>>>1,Y.write_shift(2,ae);var ce=fe.getFullYear()-1980;ce=ce<<4|fe.getMonth()+1,ce=ce<<5|fe.getDate(),Y.write_shift(2,ce)}function i(Y){var fe=Y.read_shift(2)&65535,ae=Y.read_shift(2)&65535,ce=new Date,ge=ae&31;ae>>>=5;var V=ae&15;ae>>>=4,ce.setMilliseconds(0),ce.setFullYear(ae+1980),ce.setMonth(V-1),ce.setDate(ge);var ie=fe&31;fe>>>=5;var we=fe&63;return fe>>>=6,ce.setHours(fe),ce.setMinutes(we),ce.setSeconds(ie<<1),ce}function o(Y){_s(Y,0);for(var fe={},ae=0;Y.l<=Y.length-4;){var ce=Y.read_shift(2),ge=Y.read_shift(2),V=Y.l+ge,ie={};switch(ce){case 21589:ae=Y.read_shift(1),ae&1&&(ie.mtime=Y.read_shift(4)),ge>5&&(ae&2&&(ie.atime=Y.read_shift(4)),ae&4&&(ie.ctime=Y.read_shift(4))),ie.mtime&&(ie.mt=new Date(ie.mtime*1e3));break}Y.l=V,fe[ce]=ie}return fe}var l;function u(){return l||(l={})}function d(Y,fe){if(Y[0]==80&&Y[1]==75)return xe(Y,fe);if((Y[0]|32)==109&&(Y[1]|32)==105)return Ot(Y,fe);if(Y.length<512)throw new Error("CFB file size "+Y.length+" < 512");var ae=3,ce=512,ge=0,V=0,ie=0,we=0,me=0,Te=[],I=Y.slice(0,512);_s(I,0);var Z=g(I);switch(ae=Z[0],ae){case 3:ce=512;break;case 4:ce=4096;break;case 0:if(Z[1]==0)return xe(Y,fe);default:throw new Error("Major Version: Expected 3 or 4 saw "+ae)}ce!==512&&(I=Y.slice(0,ce),_s(I,28));var pe=Y.slice(0,ce);h(I,ae);var oe=I.read_shift(4,"i");if(ae===3&&oe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+oe);I.l+=4,ie=I.read_shift(4,"i"),I.l+=4,I.chk("00100000","Mini Stream Cutoff Size: "),we=I.read_shift(4,"i"),ge=I.read_shift(4,"i"),me=I.read_shift(4,"i"),V=I.read_shift(4,"i");for(var Ee=-1,Ue=0;Ue<109&&(Ee=I.read_shift(4,"i"),!(Ee<0));++Ue)Te[Ue]=Ee;var Oe=p(Y,ce);w(me,V,Oe,ce,Te);var ut=_(Oe,ie,Te,ce);ut[ie].name="!Directory",ge>0&&we!==B&&(ut[we].name="!MiniFAT"),ut[Te[0]].name="!FAT",ut.fat_addrs=Te,ut.ssz=ce;var he={},je=[],Ye=[],mt=[];y(ie,ut,Oe,je,ge,he,Ye,we),x(Ye,mt,je),je.shift();var pt={FileIndex:Ye,FullPaths:mt};return fe&&fe.raw&&(pt.raw={header:pe,sectors:Oe}),pt}function g(Y){if(Y[Y.l]==80&&Y[Y.l+1]==75)return[0,0];Y.chk(J,"Header Signature: "),Y.l+=16;var fe=Y.read_shift(2,"u");return[Y.read_shift(2,"u"),fe]}function h(Y,fe){var ae=9;switch(Y.l+=2,ae=Y.read_shift(2)){case 9:if(fe!=3)throw new Error("Sector Shift: Expected 9 saw "+ae);break;case 12:if(fe!=4)throw new Error("Sector Shift: Expected 12 saw "+ae);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ae)}Y.chk("0600","Mini Sector Shift: "),Y.chk("000000000000","Reserved: ")}function p(Y,fe){for(var ae=Math.ceil(Y.length/fe)-1,ce=[],ge=1;ge<ae;++ge)ce[ge-1]=Y.slice(ge*fe,(ge+1)*fe);return ce[ae-1]=Y.slice(ae*fe),ce}function x(Y,fe,ae){for(var ce=0,ge=0,V=0,ie=0,we=0,me=ae.length,Te=[],I=[];ce<me;++ce)Te[ce]=I[ce]=ce,fe[ce]=ae[ce];for(;we<I.length;++we)ce=I[we],ge=Y[ce].L,V=Y[ce].R,ie=Y[ce].C,Te[ce]===ce&&(ge!==-1&&Te[ge]!==ge&&(Te[ce]=Te[ge]),V!==-1&&Te[V]!==V&&(Te[ce]=Te[V])),ie!==-1&&(Te[ie]=ce),ge!==-1&&ce!=Te[ce]&&(Te[ge]=Te[ce],I.lastIndexOf(ge)<we&&I.push(ge)),V!==-1&&ce!=Te[ce]&&(Te[V]=Te[ce],I.lastIndexOf(V)<we&&I.push(V));for(ce=1;ce<me;++ce)Te[ce]===ce&&(V!==-1&&Te[V]!==V?Te[ce]=Te[V]:ge!==-1&&Te[ge]!==ge&&(Te[ce]=Te[ge]));for(ce=1;ce<me;++ce)if(Y[ce].type!==0){if(we=ce,we!=Te[we])do we=Te[we],fe[ce]=fe[we]+"/"+fe[ce];while(we!==0&&Te[we]!==-1&&we!=Te[we]);Te[ce]=-1}for(fe[0]+="/",ce=1;ce<me;++ce)Y[ce].type!==2&&(fe[ce]+="/")}function v(Y,fe,ae){for(var ce=Y.start,ge=Y.size,V=[],ie=ce;ae&&ge>0&&ie>=0;)V.push(fe.slice(ie*M,ie*M+M)),ge-=M,ie=cu(ae,ie*4);return V.length===0?qe(0):hs(V).slice(0,Y.size)}function w(Y,fe,ae,ce,ge){var V=B;if(Y===B){if(fe!==0)throw new Error("DIFAT chain shorter than expected")}else if(Y!==-1){var ie=ae[Y],we=(ce>>>2)-1;if(!ie)return;for(var me=0;me<we&&(V=cu(ie,me*4))!==B;++me)ge.push(V);w(cu(ie,ce-4),fe-1,ae,ce,ge)}}function S(Y,fe,ae,ce,ge){var V=[],ie=[];ge||(ge=[]);var we=ce-1,me=0,Te=0;for(me=fe;me>=0;){ge[me]=!0,V[V.length]=me,ie.push(Y[me]);var I=ae[Math.floor(me*4/ce)];if(Te=me*4&we,ce<4+Te)throw new Error("FAT boundary crossed: "+me+" 4 "+ce);if(!Y[I])break;me=cu(Y[I],Te)}return{nodes:V,data:P8([ie])}}function _(Y,fe,ae,ce){var ge=Y.length,V=[],ie=[],we=[],me=[],Te=ce-1,I=0,Z=0,pe=0,oe=0;for(I=0;I<ge;++I)if(we=[],pe=I+fe,pe>=ge&&(pe-=ge),!ie[pe]){me=[];var Ee=[];for(Z=pe;Z>=0;){Ee[Z]=!0,ie[Z]=!0,we[we.length]=Z,me.push(Y[Z]);var Ue=ae[Math.floor(Z*4/ce)];if(oe=Z*4&Te,ce<4+oe)throw new Error("FAT boundary crossed: "+Z+" 4 "+ce);if(!Y[Ue]||(Z=cu(Y[Ue],oe),Ee[Z]))break}V[pe]={nodes:we,data:P8([me])}}return V}function y(Y,fe,ae,ce,ge,V,ie,we){for(var me=0,Te=ce.length?2:0,I=fe[Y].data,Z=0,pe=0,oe;Z<I.length;Z+=128){var Ee=I.slice(Z,Z+128);_s(Ee,64),pe=Ee.read_shift(2),oe=s4(Ee,0,pe-Te),ce.push(oe);var Ue={name:oe,type:Ee.read_shift(1),color:Ee.read_shift(1),L:Ee.read_shift(4,"i"),R:Ee.read_shift(4,"i"),C:Ee.read_shift(4,"i"),clsid:Ee.read_shift(16),state:Ee.read_shift(4,"i"),start:0,size:0},Oe=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);Oe!==0&&(Ue.ct=k(Ee,Ee.l-8));var ut=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);ut!==0&&(Ue.mt=k(Ee,Ee.l-8)),Ue.start=Ee.read_shift(4,"i"),Ue.size=Ee.read_shift(4,"i"),Ue.size<0&&Ue.start<0&&(Ue.size=Ue.type=0,Ue.start=B,Ue.name=""),Ue.type===5?(me=Ue.start,ge>0&&me!==B&&(fe[me].name="!StreamData")):Ue.size>=4096?(Ue.storage="fat",fe[Ue.start]===void 0&&(fe[Ue.start]=S(ae,Ue.start,fe.fat_addrs,fe.ssz)),fe[Ue.start].name=Ue.name,Ue.content=fe[Ue.start].data.slice(0,Ue.size)):(Ue.storage="minifat",Ue.size<0?Ue.size=0:me!==B&&Ue.start!==B&&fe[me]&&(Ue.content=v(Ue,fe[me].data,(fe[we]||{}).data))),Ue.content&&_s(Ue.content,0),V[oe]=Ue,ie.push(Ue)}}function k(Y,fe){return new Date((Ra(Y,fe+4)/1e7*Math.pow(2,32)+Ra(Y,fe)/1e7-11644473600)*1e3)}function N(Y,fe){return u(),d(l.readFileSync(Y),fe)}function E(Y,fe){var ae=fe&&fe.type;switch(ae||lr&&Buffer.isBuffer(Y)&&(ae="buffer"),ae||"base64"){case"file":return N(Y,fe);case"base64":return d(Ma($a(Y)),fe);case"binary":return d(Ma(Y),fe)}return d(Y,fe)}function A(Y,fe){var ae=fe||{},ce=ae.root||"Root Entry";if(Y.FullPaths||(Y.FullPaths=[]),Y.FileIndex||(Y.FileIndex=[]),Y.FullPaths.length!==Y.FileIndex.length)throw new Error("inconsistent CFB structure");Y.FullPaths.length===0&&(Y.FullPaths[0]=ce+"/",Y.FileIndex[0]={name:ce,type:5}),ae.CLSID&&(Y.FileIndex[0].clsid=ae.CLSID),C(Y)}function C(Y){var fe="Sh33tJ5";if(!Wt.find(Y,"/"+fe)){var ae=qe(4);ae[0]=55,ae[1]=ae[3]=50,ae[2]=54,Y.FileIndex.push({name:fe,type:2,content:ae,size:4,L:69,R:69,C:69}),Y.FullPaths.push(Y.FullPaths[0]+fe),F(Y)}}function F(Y,fe){A(Y);for(var ae=!1,ce=!1,ge=Y.FullPaths.length-1;ge>=0;--ge){var V=Y.FileIndex[ge];switch(V.type){case 0:ce?ae=!0:(Y.FileIndex.pop(),Y.FullPaths.pop());break;case 1:case 2:case 5:ce=!0,isNaN(V.R*V.L*V.C)&&(ae=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(ae=!0);break;default:ae=!0;break}}if(!(!ae&&!fe)){var ie=new Date(1987,1,19),we=0,me=Object.create?Object.create(null):{},Te=[];for(ge=0;ge<Y.FullPaths.length;++ge)me[Y.FullPaths[ge]]=!0,Y.FileIndex[ge].type!==0&&Te.push([Y.FullPaths[ge],Y.FileIndex[ge]]);for(ge=0;ge<Te.length;++ge){var I=n(Te[ge][0]);ce=me[I],ce||(Te.push([I,{name:s(I).replace("/",""),type:1,clsid:z,ct:ie,mt:ie,content:null}]),me[I]=!0)}for(Te.sort(function(oe,Ee){return r(oe[0],Ee[0])}),Y.FullPaths=[],Y.FileIndex=[],ge=0;ge<Te.length;++ge)Y.FullPaths[ge]=Te[ge][0],Y.FileIndex[ge]=Te[ge][1];for(ge=0;ge<Te.length;++ge){var Z=Y.FileIndex[ge],pe=Y.FullPaths[ge];if(Z.name=s(pe).replace("/",""),Z.L=Z.R=Z.C=-(Z.color=1),Z.size=Z.content?Z.content.length:0,Z.start=0,Z.clsid=Z.clsid||z,ge===0)Z.C=Te.length>1?1:-1,Z.size=0,Z.type=5;else if(pe.slice(-1)=="/"){for(we=ge+1;we<Te.length&&n(Y.FullPaths[we])!=pe;++we);for(Z.C=we>=Te.length?-1:we,we=ge+1;we<Te.length&&n(Y.FullPaths[we])!=n(pe);++we);Z.R=we>=Te.length?-1:we,Z.type=1}else n(Y.FullPaths[ge+1]||"")==n(pe)&&(Z.R=ge+1),Z.type=2}}}function D(Y,fe){var ae=fe||{};if(ae.fileType=="mad")return xr(Y,ae);switch(F(Y),ae.fileType){case"zip":return ye(Y,ae)}var ce=function(oe){for(var Ee=0,Ue=0,Oe=0;Oe<oe.FileIndex.length;++Oe){var ut=oe.FileIndex[Oe];if(ut.content){var he=ut.content.length;he>0&&(he<4096?Ee+=he+63>>6:Ue+=he+511>>9)}}for(var je=oe.FullPaths.length+3>>2,Ye=Ee+7>>3,mt=Ee+127>>7,pt=Ye+Ue+je+mt,Bt=pt+127>>7,Et=Bt<=109?0:Math.ceil((Bt-109)/127);pt+Bt+Et+127>>7>Bt;)Et=++Bt<=109?0:Math.ceil((Bt-109)/127);var St=[1,Et,Bt,mt,je,Ue,Ee,0];return oe.FileIndex[0].size=Ee<<6,St[7]=(oe.FileIndex[0].start=St[0]+St[1]+St[2]+St[3]+St[4]+St[5])+(St[6]+7>>3),St}(Y),ge=qe(ce[7]<<9),V=0,ie=0;{for(V=0;V<8;++V)ge.write_shift(1,X[V]);for(V=0;V<8;++V)ge.write_shift(2,0);for(ge.write_shift(2,62),ge.write_shift(2,3),ge.write_shift(2,65534),ge.write_shift(2,9),ge.write_shift(2,6),V=0;V<3;++V)ge.write_shift(2,0);for(ge.write_shift(4,0),ge.write_shift(4,ce[2]),ge.write_shift(4,ce[0]+ce[1]+ce[2]+ce[3]-1),ge.write_shift(4,0),ge.write_shift(4,4096),ge.write_shift(4,ce[3]?ce[0]+ce[1]+ce[2]-1:B),ge.write_shift(4,ce[3]),ge.write_shift(-4,ce[1]?ce[0]-1:B),ge.write_shift(4,ce[1]),V=0;V<109;++V)ge.write_shift(-4,V<ce[2]?ce[1]+V:-1)}if(ce[1])for(ie=0;ie<ce[1];++ie){for(;V<236+ie*127;++V)ge.write_shift(-4,V<ce[2]?ce[1]+V:-1);ge.write_shift(-4,ie===ce[1]-1?B:ie+1)}var we=function(oe){for(ie+=oe;V<ie-1;++V)ge.write_shift(-4,V+1);oe&&(++V,ge.write_shift(-4,B))};for(ie=V=0,ie+=ce[1];V<ie;++V)ge.write_shift(-4,H.DIFSECT);for(ie+=ce[2];V<ie;++V)ge.write_shift(-4,H.FATSECT);we(ce[3]),we(ce[4]);for(var me=0,Te=0,I=Y.FileIndex[0];me<Y.FileIndex.length;++me)I=Y.FileIndex[me],I.content&&(Te=I.content.length,!(Te<4096)&&(I.start=ie,we(Te+511>>9)));for(we(ce[6]+7>>3);ge.l&511;)ge.write_shift(-4,H.ENDOFCHAIN);for(ie=V=0,me=0;me<Y.FileIndex.length;++me)I=Y.FileIndex[me],I.content&&(Te=I.content.length,!(!Te||Te>=4096)&&(I.start=ie,we(Te+63>>6)));for(;ge.l&511;)ge.write_shift(-4,H.ENDOFCHAIN);for(V=0;V<ce[4]<<2;++V){var Z=Y.FullPaths[V];if(!Z||Z.length===0){for(me=0;me<17;++me)ge.write_shift(4,0);for(me=0;me<3;++me)ge.write_shift(4,-1);for(me=0;me<12;++me)ge.write_shift(4,0);continue}I=Y.FileIndex[V],V===0&&(I.start=I.size?I.start-1:B);var pe=V===0&&ae.root||I.name;if(Te=2*(pe.length+1),ge.write_shift(64,pe,"utf16le"),ge.write_shift(2,Te),ge.write_shift(1,I.type),ge.write_shift(1,I.color),ge.write_shift(-4,I.L),ge.write_shift(-4,I.R),ge.write_shift(-4,I.C),I.clsid)ge.write_shift(16,I.clsid,"hex");else for(me=0;me<4;++me)ge.write_shift(4,0);ge.write_shift(4,I.state||0),ge.write_shift(4,0),ge.write_shift(4,0),ge.write_shift(4,0),ge.write_shift(4,0),ge.write_shift(4,I.start),ge.write_shift(4,I.size),ge.write_shift(4,0)}for(V=1;V<Y.FileIndex.length;++V)if(I=Y.FileIndex[V],I.size>=4096)if(ge.l=I.start+1<<9,lr&&Buffer.isBuffer(I.content))I.content.copy(ge,ge.l,0,I.size),ge.l+=I.size+511&-512;else{for(me=0;me<I.size;++me)ge.write_shift(1,I.content[me]);for(;me&511;++me)ge.write_shift(1,0)}for(V=1;V<Y.FileIndex.length;++V)if(I=Y.FileIndex[V],I.size>0&&I.size<4096)if(lr&&Buffer.isBuffer(I.content))I.content.copy(ge,ge.l,0,I.size),ge.l+=I.size+63&-64;else{for(me=0;me<I.size;++me)ge.write_shift(1,I.content[me]);for(;me&63;++me)ge.write_shift(1,0)}if(lr)ge.l=ge.length;else for(;ge.l<ge.length;)ge.write_shift(1,0);return ge}function R(Y,fe){var ae=Y.FullPaths.map(function(me){return me.toUpperCase()}),ce=ae.map(function(me){var Te=me.split("/");return Te[Te.length-(me.slice(-1)=="/"?2:1)]}),ge=!1;fe.charCodeAt(0)===47?(ge=!0,fe=ae[0].slice(0,-1)+fe):ge=fe.indexOf("/")!==-1;var V=fe.toUpperCase(),ie=ge===!0?ae.indexOf(V):ce.indexOf(V);if(ie!==-1)return Y.FileIndex[ie];var we=!V.match(k0);for(V=V.replace(oa,""),we&&(V=V.replace(k0,"!")),ie=0;ie<ae.length;++ie)if((we?ae[ie].replace(k0,"!"):ae[ie]).replace(oa,"")==V||(we?ce[ie].replace(k0,"!"):ce[ie]).replace(oa,"")==V)return Y.FileIndex[ie];return null}var M=64,B=-2,J="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],z="00000000000000000000000000000000",H={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:B,FREESECT:-1,HEADER_SIGNATURE:J,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function U(Y,fe,ae){u();var ce=D(Y,ae);l.writeFileSync(fe,ce)}function L(Y){for(var fe=new Array(Y.length),ae=0;ae<Y.length;++ae)fe[ae]=String.fromCharCode(Y[ae]);return fe.join("")}function ne(Y,fe){var ae=D(Y,fe);switch(fe&&fe.type||"buffer"){case"file":return u(),l.writeFileSync(fe.filename,ae),ae;case"binary":return typeof ae=="string"?ae:L(ae);case"base64":return Og(typeof ae=="string"?ae:L(ae));case"buffer":if(lr)return Buffer.isBuffer(ae)?ae:Tl(ae);case"array":return typeof ae=="string"?Ma(ae):ae}return ae}var de;function G(Y){try{var fe=Y.InflateRaw,ae=new fe;if(ae._processChunk(new Uint8Array([3,0]),ae._finishFlushFlag),ae.bytesRead)de=Y;else throw new Error("zlib does not expose bytesRead")}catch(ce){console.error("cannot use native zlib: "+(ce.message||ce))}}function K(Y,fe){if(!de)return dt(Y,fe);var ae=de.InflateRaw,ce=new ae,ge=ce._processChunk(Y.slice(Y.l),ce._finishFlushFlag);return Y.l+=ce.bytesRead,ge}function Q(Y){return de?de.deflateRawSync(Y):it(Y)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],W=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ee(Y){var fe=(Y<<1|Y<<11)&139536|(Y<<5|Y<<15)&558144;return(fe>>16|fe>>8|fe)&255}for(var ve=typeof Uint8Array<"u",_e=ve?new Uint8Array(256):[],Le=0;Le<256;++Le)_e[Le]=ee(Le);function te(Y,fe){var ae=_e[Y&255];return fe<=8?ae>>>8-fe:(ae=ae<<8|_e[Y>>8&255],fe<=16?ae>>>16-fe:(ae=ae<<8|_e[Y>>16&255],ae>>>24-fe))}function Ne(Y,fe){var ae=fe&7,ce=fe>>>3;return(Y[ce]|(ae<=6?0:Y[ce+1]<<8))>>>ae&3}function Ce(Y,fe){var ae=fe&7,ce=fe>>>3;return(Y[ce]|(ae<=5?0:Y[ce+1]<<8))>>>ae&7}function We(Y,fe){var ae=fe&7,ce=fe>>>3;return(Y[ce]|(ae<=4?0:Y[ce+1]<<8))>>>ae&15}function nt(Y,fe){var ae=fe&7,ce=fe>>>3;return(Y[ce]|(ae<=3?0:Y[ce+1]<<8))>>>ae&31}function $e(Y,fe){var ae=fe&7,ce=fe>>>3;return(Y[ce]|(ae<=1?0:Y[ce+1]<<8))>>>ae&127}function De(Y,fe,ae){var ce=fe&7,ge=fe>>>3,V=(1<<ae)-1,ie=Y[ge]>>>ce;return ae<8-ce||(ie|=Y[ge+1]<<8-ce,ae<16-ce)||(ie|=Y[ge+2]<<16-ce,ae<24-ce)||(ie|=Y[ge+3]<<24-ce),ie&V}function at(Y,fe,ae){var ce=fe&7,ge=fe>>>3;return ce<=5?Y[ge]|=(ae&7)<<ce:(Y[ge]|=ae<<ce&255,Y[ge+1]=(ae&7)>>8-ce),fe+3}function Se(Y,fe,ae){var ce=fe&7,ge=fe>>>3;return ae=(ae&1)<<ce,Y[ge]|=ae,fe+1}function Ae(Y,fe,ae){var ce=fe&7,ge=fe>>>3;return ae<<=ce,Y[ge]|=ae&255,ae>>>=8,Y[ge+1]=ae,fe+8}function Me(Y,fe,ae){var ce=fe&7,ge=fe>>>3;return ae<<=ce,Y[ge]|=ae&255,ae>>>=8,Y[ge+1]=ae&255,Y[ge+2]=ae>>>8,fe+16}function Ie(Y,fe){var ae=Y.length,ce=2*ae>fe?2*ae:fe+5,ge=0;if(ae>=fe)return Y;if(lr){var V=h8(ce);if(Y.copy)Y.copy(V);else for(;ge<Y.length;++ge)V[ge]=Y[ge];return V}else if(ve){var ie=new Uint8Array(ce);if(ie.set)ie.set(Y);else for(;ge<ae;++ge)ie[ge]=Y[ge];return ie}return Y.length=ce,Y}function Ge(Y){for(var fe=new Array(Y),ae=0;ae<Y;++ae)fe[ae]=0;return fe}function tt(Y,fe,ae){var ce=1,ge=0,V=0,ie=0,we=0,me=Y.length,Te=ve?new Uint16Array(32):Ge(32);for(V=0;V<32;++V)Te[V]=0;for(V=me;V<ae;++V)Y[V]=0;me=Y.length;var I=ve?new Uint16Array(me):Ge(me);for(V=0;V<me;++V)Te[ge=Y[V]]++,ce<ge&&(ce=ge),I[V]=0;for(Te[0]=0,V=1;V<=ce;++V)Te[V+16]=we=we+Te[V-1]<<1;for(V=0;V<me;++V)we=Y[V],we!=0&&(I[V]=Te[we+16]++);var Z=0;for(V=0;V<me;++V)if(Z=Y[V],Z!=0)for(we=te(I[V],ce)>>ce-Z,ie=(1<<ce+4-Z)-1;ie>=0;--ie)fe[we|ie<<Z]=Z&15|V<<4;return ce}var kt=ve?new Uint16Array(512):Ge(512),zt=ve?new Uint16Array(32):Ge(32);if(!ve){for(var bt=0;bt<512;++bt)kt[bt]=0;for(bt=0;bt<32;++bt)zt[bt]=0}(function(){for(var Y=[],fe=0;fe<32;fe++)Y.push(5);tt(Y,zt,32);var ae=[];for(fe=0;fe<=143;fe++)ae.push(8);for(;fe<=255;fe++)ae.push(9);for(;fe<=279;fe++)ae.push(7);for(;fe<=287;fe++)ae.push(8);tt(ae,kt,288)})();var Dt=function(){for(var fe=ve?new Uint8Array(32768):[],ae=0,ce=0;ae<W.length-1;++ae)for(;ce<W[ae+1];++ce)fe[ce]=ae;for(;ce<32768;++ce)fe[ce]=29;var ge=ve?new Uint8Array(259):[];for(ae=0,ce=0;ae<se.length-1;++ae)for(;ce<se[ae+1];++ce)ge[ce]=ae;function V(we,me){for(var Te=0;Te<we.length;){var I=Math.min(65535,we.length-Te),Z=Te+I==we.length;for(me.write_shift(1,+Z),me.write_shift(2,I),me.write_shift(2,~I&65535);I-- >0;)me[me.l++]=we[Te++]}return me.l}function ie(we,me){for(var Te=0,I=0,Z=ve?new Uint16Array(32768):[];I<we.length;){var pe=Math.min(65535,we.length-I);if(pe<10){for(Te=at(me,Te,+(I+pe==we.length)),Te&7&&(Te+=8-(Te&7)),me.l=Te/8|0,me.write_shift(2,pe),me.write_shift(2,~pe&65535);pe-- >0;)me[me.l++]=we[I++];Te=me.l*8;continue}Te=at(me,Te,+(I+pe==we.length)+2);for(var oe=0;pe-- >0;){var Ee=we[I];oe=(oe<<5^Ee)&32767;var Ue=-1,Oe=0;if((Ue=Z[oe])&&(Ue|=I&-32768,Ue>I&&(Ue-=32768),Ue<I))for(;we[Ue+Oe]==we[I+Oe]&&Oe<250;)++Oe;if(Oe>2){Ee=ge[Oe],Ee<=22?Te=Ae(me,Te,_e[Ee+1]>>1)-1:(Ae(me,Te,3),Te+=5,Ae(me,Te,_e[Ee-23]>>5),Te+=3);var ut=Ee<8?0:Ee-4>>2;ut>0&&(Me(me,Te,Oe-se[Ee]),Te+=ut),Ee=fe[I-Ue],Te=Ae(me,Te,_e[Ee]>>3),Te-=3;var he=Ee<4?0:Ee-2>>1;he>0&&(Me(me,Te,I-Ue-W[Ee]),Te+=he);for(var je=0;je<Oe;++je)Z[oe]=I&32767,oe=(oe<<5^we[I])&32767,++I;pe-=Oe-1}else Ee<=143?Ee=Ee+48:Te=Se(me,Te,1),Te=Ae(me,Te,_e[Ee]),Z[oe]=I&32767,++I}Te=Ae(me,Te,0)-1}return me.l=(Te+7)/8|0,me.l}return function(me,Te){return me.length<8?V(me,Te):ie(me,Te)}}();function it(Y){var fe=qe(50+Math.floor(Y.length*1.1)),ae=Dt(Y,fe);return fe.slice(0,ae)}var ht=ve?new Uint16Array(32768):Ge(32768),Ct=ve?new Uint16Array(32768):Ge(32768),jt=ve?new Uint16Array(128):Ge(128),Fe=1,et=1;function Ze(Y,fe){var ae=nt(Y,fe)+257;fe+=5;var ce=nt(Y,fe)+1;fe+=5;var ge=We(Y,fe)+4;fe+=4;for(var V=0,ie=ve?new Uint8Array(19):Ge(19),we=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],me=1,Te=ve?new Uint8Array(8):Ge(8),I=ve?new Uint8Array(8):Ge(8),Z=ie.length,pe=0;pe<ge;++pe)ie[q[pe]]=V=Ce(Y,fe),me<V&&(me=V),Te[V]++,fe+=3;var oe=0;for(Te[0]=0,pe=1;pe<=me;++pe)I[pe]=oe=oe+Te[pe-1]<<1;for(pe=0;pe<Z;++pe)(oe=ie[pe])!=0&&(we[pe]=I[oe]++);var Ee=0;for(pe=0;pe<Z;++pe)if(Ee=ie[pe],Ee!=0){oe=_e[we[pe]]>>8-Ee;for(var Ue=(1<<7-Ee)-1;Ue>=0;--Ue)jt[oe|Ue<<Ee]=Ee&7|pe<<3}var Oe=[];for(me=1;Oe.length<ae+ce;)switch(oe=jt[$e(Y,fe)],fe+=oe&7,oe>>>=3){case 16:for(V=3+Ne(Y,fe),fe+=2,oe=Oe[Oe.length-1];V-- >0;)Oe.push(oe);break;case 17:for(V=3+Ce(Y,fe),fe+=3;V-- >0;)Oe.push(0);break;case 18:for(V=11+$e(Y,fe),fe+=7;V-- >0;)Oe.push(0);break;default:Oe.push(oe),me<oe&&(me=oe);break}var ut=Oe.slice(0,ae),he=Oe.slice(ae);for(pe=ae;pe<286;++pe)ut[pe]=0;for(pe=ce;pe<30;++pe)he[pe]=0;return Fe=tt(ut,ht,286),et=tt(he,Ct,30),fe}function rt(Y,fe){if(Y[0]==3&&!(Y[1]&3))return[wc(fe),2];for(var ae=0,ce=0,ge=h8(fe||1<<18),V=0,ie=ge.length>>>0,we=0,me=0;!(ce&1);){if(ce=Ce(Y,ae),ae+=3,ce>>>1)ce>>1==1?(we=9,me=5):(ae=Ze(Y,ae),we=Fe,me=et);else{ae&7&&(ae+=8-(ae&7));var Te=Y[ae>>>3]|Y[(ae>>>3)+1]<<8;if(ae+=32,Te>0)for(!fe&&ie<V+Te&&(ge=Ie(ge,V+Te),ie=ge.length);Te-- >0;)ge[V++]=Y[ae>>>3],ae+=8;continue}for(;;){!fe&&ie<V+32767&&(ge=Ie(ge,V+32767),ie=ge.length);var I=De(Y,ae,we),Z=ce>>>1==1?kt[I]:ht[I];if(ae+=Z&15,Z>>>=4,!(Z>>>8&255))ge[V++]=Z;else{if(Z==256)break;Z-=257;var pe=Z<8?0:Z-4>>2;pe>5&&(pe=0);var oe=V+se[Z];pe>0&&(oe+=De(Y,ae,pe),ae+=pe),I=De(Y,ae,me),Z=ce>>>1==1?zt[I]:Ct[I],ae+=Z&15,Z>>>=4;var Ee=Z<4?0:Z-2>>1,Ue=W[Z];for(Ee>0&&(Ue+=De(Y,ae,Ee),ae+=Ee),!fe&&ie<oe&&(ge=Ie(ge,oe+100),ie=ge.length);V<oe;)ge[V]=ge[V-Ue],++V}}}return fe?[ge,ae+7>>>3]:[ge.slice(0,V),ae+7>>>3]}function dt(Y,fe){var ae=Y.slice(Y.l||0),ce=rt(ae,fe);return Y.l+=ce[1],ce[0]}function Tt(Y,fe){if(Y)typeof console<"u"&&console.error(fe);else throw new Error(fe)}function xe(Y,fe){var ae=Y;_s(ae,0);var ce=[],ge=[],V={FileIndex:ce,FullPaths:ge};A(V,{root:fe.root});for(var ie=ae.length-4;(ae[ie]!=80||ae[ie+1]!=75||ae[ie+2]!=5||ae[ie+3]!=6)&&ie>=0;)--ie;ae.l=ie+4,ae.l+=4;var we=ae.read_shift(2);ae.l+=6;var me=ae.read_shift(4);for(ae.l=me,ie=0;ie<we;++ie){ae.l+=20;var Te=ae.read_shift(4),I=ae.read_shift(4),Z=ae.read_shift(2),pe=ae.read_shift(2),oe=ae.read_shift(2);ae.l+=8;var Ee=ae.read_shift(4),Ue=o(ae.slice(ae.l+Z,ae.l+Z+pe));ae.l+=Z+pe+oe;var Oe=ae.l;ae.l=Ee+4,ue(ae,Te,I,V,Ue),ae.l=Oe}return V}function ue(Y,fe,ae,ce,ge){Y.l+=2;var V=Y.read_shift(2),ie=Y.read_shift(2),we=i(Y);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var me=Y.read_shift(4),Te=Y.read_shift(4),I=Y.read_shift(4),Z=Y.read_shift(2),pe=Y.read_shift(2),oe="",Ee=0;Ee<Z;++Ee)oe+=String.fromCharCode(Y[Y.l++]);if(pe){var Ue=o(Y.slice(Y.l,Y.l+pe));(Ue[21589]||{}).mt&&(we=Ue[21589].mt),((ge||{})[21589]||{}).mt&&(we=ge[21589].mt)}Y.l+=pe;var Oe=Y.slice(Y.l,Y.l+Te);switch(ie){case 8:Oe=K(Y,I);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ie)}var ut=!1;V&8&&(me=Y.read_shift(4),me==134695760&&(me=Y.read_shift(4),ut=!0),Te=Y.read_shift(4),I=Y.read_shift(4)),Te!=fe&&Tt(ut,"Bad compressed size: "+fe+" != "+Te),I!=ae&&Tt(ut,"Bad uncompressed size: "+ae+" != "+I),qt(ce,oe,Oe,{unsafe:!0,mt:we})}function ye(Y,fe){var ae=fe||{},ce=[],ge=[],V=qe(1),ie=ae.compression?8:0,we=0,me=0,Te=0,I=0,Z=0,pe=Y.FullPaths[0],oe=pe,Ee=Y.FileIndex[0],Ue=[],Oe=0;for(me=1;me<Y.FullPaths.length;++me)if(oe=Y.FullPaths[me].slice(pe.length),Ee=Y.FileIndex[me],!(!Ee.size||!Ee.content||oe=="Sh33tJ5")){var ut=I,he=qe(oe.length);for(Te=0;Te<oe.length;++Te)he.write_shift(1,oe.charCodeAt(Te)&127);he=he.slice(0,he.l),Ue[Z]=Lne.buf(Ee.content,0);var je=Ee.content;ie==8&&(je=Q(je)),V=qe(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,we),V.write_shift(2,ie),Ee.mt?a(V,Ee.mt):V.write_shift(4,0),V.write_shift(-4,Ue[Z]),V.write_shift(4,je.length),V.write_shift(4,Ee.content.length),V.write_shift(2,he.length),V.write_shift(2,0),I+=V.length,ce.push(V),I+=he.length,ce.push(he),I+=je.length,ce.push(je),V=qe(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,we),V.write_shift(2,ie),V.write_shift(4,0),V.write_shift(-4,Ue[Z]),V.write_shift(4,je.length),V.write_shift(4,Ee.content.length),V.write_shift(2,he.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,ut),Oe+=V.l,ge.push(V),Oe+=he.length,ge.push(he),++Z}return V=qe(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,Z),V.write_shift(2,Z),V.write_shift(4,Oe),V.write_shift(4,I),V.write_shift(2,0),hs([hs(ce),hs(ge),V])}var be={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ve(Y,fe){if(Y.ctype)return Y.ctype;var ae=Y.name||"",ce=ae.match(/\.([^\.]+)$/);return ce&&be[ce[1]]||fe&&(ce=(ae=fe).match(/[\.\\]([^\.\\])+$/),ce&&be[ce[1]])?be[ce[1]]:"application/octet-stream"}function Nt(Y){for(var fe=Og(Y),ae=[],ce=0;ce<fe.length;ce+=76)ae.push(fe.slice(ce,ce+76));return ae.join(`\r
`)+`\r
`}function yt(Y){var fe=Y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Te){var I=Te.charCodeAt(0).toString(16).toUpperCase();return"="+(I.length==1?"0"+I:I)});fe=fe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),fe.charAt(0)==`
`&&(fe="=0D"+fe.slice(1)),fe=fe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ae=[],ce=fe.split(`\r
`),ge=0;ge<ce.length;++ge){var V=ce[ge];if(V.length==0){ae.push("");continue}for(var ie=0;ie<V.length;){var we=76,me=V.slice(ie,ie+we);me.charAt(we-1)=="="?we--:me.charAt(we-2)=="="?we-=2:me.charAt(we-3)=="="&&(we-=3),me=V.slice(ie,ie+we),ie+=we,ie<V.length&&(me+="="),ae.push(me)}}return ae.join(`\r
`)}function $t(Y){for(var fe=[],ae=0;ae<Y.length;++ae){for(var ce=Y[ae];ae<=Y.length&&ce.charAt(ce.length-1)=="=";)ce=ce.slice(0,ce.length-1)+Y[++ae];fe.push(ce)}for(var ge=0;ge<fe.length;++ge)fe[ge]=fe[ge].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return Ma(fe.join(`\r
`))}function Ft(Y,fe,ae){for(var ce="",ge="",V="",ie,we=0;we<10;++we){var me=fe[we];if(!me||me.match(/^\s*$/))break;var Te=me.match(/^(.*?):\s*([^\s].*)$/);if(Te)switch(Te[1].toLowerCase()){case"content-location":ce=Te[2].trim();break;case"content-type":V=Te[2].trim();break;case"content-transfer-encoding":ge=Te[2].trim();break}}switch(++we,ge.toLowerCase()){case"base64":ie=Ma($a(fe.slice(we).join("")));break;case"quoted-printable":ie=$t(fe.slice(we));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ge)}var I=qt(Y,ce.slice(ae.length),ie,{unsafe:!0});V&&(I.ctype=V)}function Ot(Y,fe){if(L(Y.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ae=fe&&fe.root||"",ce=(lr&&Buffer.isBuffer(Y)?Y.toString("binary"):L(Y)).split(`\r
`),ge=0,V="";for(ge=0;ge<ce.length;++ge)if(V=ce[ge],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),ae||(ae=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,ae.length)!=ae))for(;ae.length>0&&(ae=ae.slice(0,ae.length-1),ae=ae.slice(0,ae.lastIndexOf("/")+1),V.slice(0,ae.length)!=ae););var ie=(ce[1]||"").match(/boundary="(.*?)"/);if(!ie)throw new Error("MAD cannot find boundary");var we="--"+(ie[1]||""),me=[],Te=[],I={FileIndex:me,FullPaths:Te};A(I);var Z,pe=0;for(ge=0;ge<ce.length;++ge){var oe=ce[ge];oe!==we&&oe!==we+"--"||(pe++&&Ft(I,ce.slice(Z,ge),ae),Z=ge)}return I}function xr(Y,fe){var ae=fe||{},ce=ae.boundary||"SheetJS";ce="------="+ce;for(var ge=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ce.slice(2)+'"',"","",""],V=Y.FullPaths[0],ie=V,we=Y.FileIndex[0],me=1;me<Y.FullPaths.length;++me)if(ie=Y.FullPaths[me].slice(V.length),we=Y.FileIndex[me],!(!we.size||!we.content||ie=="Sh33tJ5")){ie=ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Oe){return"_x"+Oe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Oe){return"_u"+Oe.charCodeAt(0).toString(16)+"_"});for(var Te=we.content,I=lr&&Buffer.isBuffer(Te)?Te.toString("binary"):L(Te),Z=0,pe=Math.min(1024,I.length),oe=0,Ee=0;Ee<=pe;++Ee)(oe=I.charCodeAt(Ee))>=32&&oe<128&&++Z;var Ue=Z>=pe*4/5;ge.push(ce),ge.push("Content-Location: "+(ae.root||"file:///C:/SheetJS/")+ie),ge.push("Content-Transfer-Encoding: "+(Ue?"quoted-printable":"base64")),ge.push("Content-Type: "+Ve(we,ie)),ge.push(""),ge.push(Ue?yt(I):Nt(I))}return ge.push(ce+`--\r
`),ge.join(`\r
`)}function yr(Y){var fe={};return A(fe,Y),fe}function qt(Y,fe,ae,ce){var ge=ce&&ce.unsafe;ge||A(Y);var V=!ge&&Wt.find(Y,fe);if(!V){var ie=Y.FullPaths[0];fe.slice(0,ie.length)==ie?ie=fe:(ie.slice(-1)!="/"&&(ie+="/"),ie=(ie+fe).replace("//","/")),V={name:s(fe),type:2},Y.FileIndex.push(V),Y.FullPaths.push(ie),ge||Wt.utils.cfb_gc(Y)}return V.content=ae,V.size=ae?ae.length:0,ce&&(ce.CLSID&&(V.clsid=ce.CLSID),ce.mt&&(V.mt=ce.mt),ce.ct&&(V.ct=ce.ct)),V}function hr(Y,fe){A(Y);var ae=Wt.find(Y,fe);if(ae){for(var ce=0;ce<Y.FileIndex.length;++ce)if(Y.FileIndex[ce]==ae)return Y.FileIndex.splice(ce,1),Y.FullPaths.splice(ce,1),!0}return!1}function Nr(Y,fe,ae){A(Y);var ce=Wt.find(Y,fe);if(ce){for(var ge=0;ge<Y.FileIndex.length;++ge)if(Y.FileIndex[ge]==ce)return Y.FileIndex[ge].name=s(ae),Y.FullPaths[ge]=ae,!0}return!1}function Ln(Y){F(Y,!0)}return e.find=R,e.read=E,e.parse=d,e.write=ne,e.writeFile=U,e.utils={cfb_new:yr,cfb_add:qt,cfb_del:hr,cfb_mov:Nr,cfb_gc:Ln,ReadShift:V0,CheckField:pL,prep_blob:_s,bconcat:hs,use_zlib:G,_deflateRaw:it,_inflateRaw:dt,consts:H},e}();function Ine(t){return typeof t=="string"?Ov(t):Array.isArray(t)?cne(t):t}function Am(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Ov(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?wo(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([Ine(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:t,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=t,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Uc(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function One(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Tn(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function _8(t,e){for(var r=[],n=Tn(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function Uv(t){for(var e=[],r=Tn(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function $v(t){for(var e=[],r=Tn(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function Bne(t){for(var e=[],r=Tn(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Q1=new Date(1899,11,30,0,0,0);function ts(t,e){var r=t.getTime(),n=Q1.getTime()+(t.getTimezoneOffset()-Q1.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var YM=new Date,Une=Q1.getTime()+(YM.getTimezoneOffset()-Q1.getTimezoneOffset())*6e4,b8=YM.getTimezoneOffset();function Wv(t){var e=new Date;return e.setTime(t*24*60*60*1e3+Une),e.getTimezoneOffset()!==b8&&e.setTime(e.getTime()+(e.getTimezoneOffset()-b8)*6e4),e}function $ne(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[a],10)}return e}var S8=new Date("2017-02-19T19:06:09.000Z"),JM=isNaN(S8.getFullYear())?new Date("2/19/17"):S8,Wne=JM.getFullYear()==2017;function qr(t,e){var r=new Date(t);if(Wne)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(JM.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ju(t,e){if(lr&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return wo(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return wo(IM(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return wo(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return wo(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function Zr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Zr(t[r]));return e}function Sn(t,e){for(var r="";r.length<e;)r+=t;return r}function Gi(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var zne=["january","february","march","april","may","june","july","august","september","october","november","december"];function eh(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var i=t.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&zne.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var Hne=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function QM(t){return t?t.content&&t.type?Ju(t.content,!0):t.data?S0(t.data):t.asNodeBuffer&&lr?S0(t.asNodeBuffer().toString("binary")):t.asBinary?S0(t.asBinary()):t._data&&t._data.getContent?S0(Ju(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function qM(t){if(!t)return null;if(t.data)return d8(t.data);if(t.asNodeBuffer&&lr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?d8(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function Gne(t){return t&&t.name.slice(-4)===".bin"?qM(t):QM(t)}function oi(t,e){for(var r=t.FullPaths||Tn(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function qT(t,e){var r=oi(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Bn(t,e,r){if(!r)return Gne(qT(t,e));if(!e)return null;try{return Bn(t,e)}catch{return null}}function La(t,e,r){if(!r)return QM(qT(t,e));if(!e)return null;try{return La(t,e)}catch{return null}}function Vne(t,e,r){return qM(qT(t,e))}function k8(t){for(var e=t.FullPaths||Tn(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ar(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return lr?n=Tl(r):n=une(r),Wt.utils.cfb_add(t,e,n)}Wt.utils.cfb_add(t,e,r)}else t.file(e,r)}function ZT(){return Wt.utils.cfb_new()}function ZM(t,e){switch(e.type){case"base64":return Wt.read(t,{type:"base64"});case"binary":return Wt.read(t,{type:"binary"});case"buffer":case"array":return Wt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function C0(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Mn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Kne=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,C8=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Xne=/<[^>]*>/g,Qs=Mn.match(C8)?C8:Xne,Yne=/<\w*:/,Jne=/<(\/?)\w+:/;function Yt(t,e,r){for(var n={},s=0,a=0;s!==t.length&&!((a=t.charCodeAt(s))===32||a===10||a===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var i=t.match(Kne),o=0,l="",u=0,d="",g="",h=1;if(i)for(u=0;u!=i.length;++u){for(g=i[u],a=0;a!=g.length&&g.charCodeAt(a)!==61;++a);for(d=g.slice(0,a).trim();g.charCodeAt(a+1)==32;)++a;for(h=(s=g.charCodeAt(a+1))==34||s==39?1:0,l=g.slice(a+1+h,g.length-h),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,n[d.toLowerCase()]=l;else{var p=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[p]&&d.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Po(t){return t.replace(Jne,"<$1")}var eL={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},e4=Uv(eL),wr=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(t,function(o,l){return eL[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),t4=/[&<>'"]/g,Qne=/[\u0000-\u0008\u000b-\u001f]/g;function Mr(t){var e=t+"";return e.replace(t4,function(r){return e4[r]}).replace(Qne,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function T8(t){return Mr(t).replace(/ /g,"_x0020_")}var tL=/[\u0000-\u001f]/g;function r4(t){var e=t+"";return e.replace(t4,function(r){return e4[r]}).replace(/\n/g,"<br/>").replace(tL,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function qne(t){var e=t+"";return e.replace(t4,function(r){return e4[r]}).replace(tL,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var E8=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Zne(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Kr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function w2(t){for(var e="",r=0,n=0,s=0,a=0,i=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,e+=String.fromCharCode(i);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function N8(t){var e=wc(2*t.length),r,n,s=1,a=0,i=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(e[a++]=i&255,e[a++]=i>>>8,i=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function A8(t){return Tl(t,"binary").toString("utf8")}var dx="foo bar baz",Or=lr&&(A8(dx)==w2(dx)&&A8||N8(dx)==w2(dx)&&N8)||w2,wo=lr?function(t){return Tl(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Ug=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),rL=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),ese=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),tse=/<\/?(?:vt:)?variant>/g,rse=/<(?:vt:)([^>]*)>([\s\S]*)</;function j8(t,e){var r=Yt(t),n=t.match(ese(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(tse,"").match(rse);i&&s.push({v:Or(i[2]),t:i[1]})}),s}var nL=/(^\s|\s$|\n)/;function ks(t,e){return"<"+t+(e.match(nL)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function $g(t){return Tn(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function xt(t,e,r){return"<"+t+(r!=null?$g(r):"")+(e!=null?(e.match(nL)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function WS(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function nse(t,e){switch(typeof t){case"string":var r=xt("vt:lpwstr",Mr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return xt((t|0)==t?"vt:i4":"vt:r8",Mr(String(t)));case"boolean":return xt("vt:bool",t?"true":"false")}if(t instanceof Date)return xt("vt:filetime",WS(t));throw new Error("Unable to serialize "+t)}function n4(t){if(lr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Or(Uc(YT(t)));throw new Error("Bad input format: expected Buffer or string")}var Wg=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,qn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},md=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Da={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function sse(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,a=5;a>=0;--a)s=s*256+t[e+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function ase(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,a=0,i=n?-e:e;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(e)?26985:0);for(var o=0;o<=5;++o,a/=256)t[r+o]=a&255;t[r+6]=(s&15)<<4|a&15,t[r+7]=s>>4|n}var F8=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,a=t[0][n].length;s<a;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},P8=lr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Tl(e)})):F8(t)}:F8,D8=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(nl(t,s)));return n.join("").replace(oa,"")},s4=lr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(oa,""):D8(t,e,r)}:D8,R8=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},sL=lr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):R8(t,e,r)}:R8,M8=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Xd(t,s)));return n.join("")},jm=lr?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):M8(e,r,n)}:M8,aL=function(t,e){var r=Ra(t,e);return r>0?jm(t,e+4,e+4+r-1):""},iL=aL,oL=function(t,e){var r=Ra(t,e);return r>0?jm(t,e+4,e+4+r-1):""},lL=oL,cL=function(t,e){var r=2*Ra(t,e);return r>0?jm(t,e+4,e+4+r-1):""},uL=cL,dL=function(e,r){var n=Ra(e,r);return n>0?s4(e,r+4,r+4+n):""},fL=dL,hL=function(t,e){var r=Ra(t,e);return r>0?jm(t,e+4,e+4+r):""},gL=hL,mL=function(t,e){return sse(t,e)},q1=mL,a4=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};lr&&(iL=function(e,r){if(!Buffer.isBuffer(e))return aL(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},lL=function(e,r){if(!Buffer.isBuffer(e))return oL(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},uL=function(e,r){if(!Buffer.isBuffer(e))return cL(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},fL=function(e,r){if(!Buffer.isBuffer(e))return dL(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},gL=function(e,r){if(!Buffer.isBuffer(e))return hL(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},q1=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):mL(e,r)},a4=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Xd=function(t,e){return t[e]},nl=function(t,e){return t[e+1]*256+t[e]},ise=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Ra=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},cu=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},ose=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function V0(t,e){var r="",n,s,a=[],i,o,l,u;switch(e){case"dbcs":if(u=this.l,lr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(nl(this,u)),u+=2;t*=2;break;case"utf8":r=jm(this,this.l,this.l+t);break;case"utf16le":t*=2,r=s4(this,this.l,this.l+t);break;case"wstr":return V0.call(this,t,"dbcs");case"lpstr-ansi":r=iL(this,this.l),t=4+Ra(this,this.l);break;case"lpstr-cp":r=lL(this,this.l),t=4+Ra(this,this.l);break;case"lpwstr":r=uL(this,this.l),t=4+2*Ra(this,this.l);break;case"lpp4":t=4+Ra(this,this.l),r=fL(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Ra(this,this.l),r=gL(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(i=Xd(this,this.l+t++))!==0;)a.push(ux(i));r=a.join("");break;case"_wstr":for(t=0,r="";(i=nl(this,this.l+t))!==0;)a.push(ux(i)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Xd(this,u),this.l=u+1,o=V0.call(this,t-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(ux(nl(this,u))),u+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Xd(this,u),this.l=u+1,o=V0.call(this,t-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(ux(Xd(this,u))),u+=1}r=a.join("");break;default:switch(t){case 1:return n=Xd(this,this.l),this.l++,n;case 2:return n=(e==="i"?ise:nl)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?cu:ose)(this,this.l),this.l+=4,n):(s=Ra(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=q1(this,this.l):s=q1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=sL(this,this.l,t);break}}return this.l+=t,r}var lse=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},cse=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},use=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function dse(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)use(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var i=e.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,lse(this,e,this.l);break;case 8:if(n=8,r==="f"){ase(this,e,this.l);break}case 16:break;case-4:n=4,cse(this,e,this.l);break}return this.l+=n,this}function pL(t,e){var r=sL(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function _s(t,e){t.l=e,t.read_shift=V0,t.chk=pL,t.write_shift=dse}function Xs(t,e){t.l+=e}function qe(t){var e=wc(t);return _s(e,0),e}function El(t,e,r){if(t){var n,s,a;_s(t,t.l||0);for(var i=t.length,o=0,l=0;t.l<i;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var u=Xg[o]||Xg[65535];for(n=t.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=t.read_shift(1))&127)<<7*s;l=t.l+a;var d=u.f&&u.f(t,a,r);if(t.l=l,e(d,u,o))return}}}function Ea(){var t=[],e=lr?256:2048,r=function(u){var d=qe(u);return _s(d,0),d},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,e)))},i=function(){return s(),hs(t)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:o,end:i,_bufs:t}}function ot(t,e,r,n){var s=+e,a;if(!isNaN(s)){n||(n=Xg[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=t.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&a4(r)&&t.push(r)}}function K0(t,e,r){var n=Zr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function L8(t,e,r){var n=Zr(t);return n.s=K0(n.s,e.s,r),n.e=K0(n.e,e.s,r),n}function X0(t,e){if(t.cRel&&t.c<0)for(t=Zr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Zr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Kt(t);return!t.cRel&&t.cRel!=null&&(r=gse(r)),!t.rRel&&t.rRel!=null&&(r=fse(r)),r}function _2(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+fn(t.s.c)+":"+(t.e.cRel?"":"$")+fn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Dn(t.s.r)+":"+(t.e.rRel?"":"$")+Dn(t.e.r):X0(t.s,e.biff)+":"+X0(t.e,e.biff)}function i4(t){return parseInt(hse(t),10)-1}function Dn(t){return""+(t+1)}function fse(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function hse(t){return t.replace(/\$(\d+)$/,"$1")}function o4(t){for(var e=mse(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function fn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function gse(t){return t.replace(/^([A-Z])/,"$$$1")}function mse(t){return t.replace(/^\$([A-Z])/,"$1")}function pse(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function hn(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Kt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Na(t){var e=t.indexOf(":");return e==-1?{s:hn(t),e:hn(t)}:{s:hn(t.slice(0,e)),e:hn(t.slice(e+1))}}function sr(t,e){return typeof e>"u"||typeof e=="number"?sr(t.s,t.e):(typeof t!="string"&&(t=Kt(t)),typeof e!="string"&&(e=Kt(e)),t==e?t:t+":"+e)}function _r(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=t.length;for(r=0;n<a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===a||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function I8(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=bi(t.z,r?ts(e):e)}catch{}try{return t.w=bi((t.XF||{}).numFmtId||(r?14:0),r?ts(e):e)}catch{return""+e}}function yl(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Nl[t.v]||t.v:e==null?I8(t,t.v):I8(t,e))}function $c(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function xL(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,a=t||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?hn(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=_r(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=e[g].length;++h)if(!(typeof e[g][h]>"u")){var p={v:e[g][h]},x=i+g,v=o+h;if(u.s.r>x&&(u.s.r=x),u.s.c>v&&(u.s.c=v),u.e.r<x&&(u.e.r=x),u.e.c<v&&(u.e.c=v),e[g][h]&&typeof e[g][h]=="object"&&!Array.isArray(e[g][h])&&!(e[g][h]instanceof Date))p=e[g][h];else if(Array.isArray(p.v)&&(p.f=e[g][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Gt[14],n.cellDates?(p.t="d",p.w=bi(p.z,ts(p.v))):(p.t="n",p.v=ts(p.v),p.w=bi(p.z,p.v))):p.t="s";if(s)a[x]||(a[x]=[]),a[x][v]&&a[x][v].z&&(p.z=a[x][v].z),a[x][v]=p;else{var w=Kt({c:v,r:x});a[w]&&a[w].z&&(p.z=a[w].z),a[w]=p}}}return u.s.c<1e7&&(a["!ref"]=sr(u)),a}function Fh(t,e){return xL(null,t,e)}function xse(t){return t.read_shift(4,"i")}function Vi(t,e){return e||(e=qe(4)),e.write_shift(4,t),e}function Gs(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function gs(t,e){var r=!1;return e==null&&(r=!0,e=qe(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function yse(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function vse(t,e){return e||(e=qe(4)),e.write_shift(2,0),e.write_shift(2,0),e}function l4(t,e){var r=t.l,n=t.read_shift(1),s=Gs(t),a=[],i={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)a.push(yse(t));i.r=a}else i.r=[{ich:0,ifnt:0}];return t.l=r+e,i}function wse(t,e){var r=!1;return e==null&&(r=!0,e=qe(15+4*t.t.length)),e.write_shift(1,0),gs(t.t,e),r?e.slice(0,e.l):e}var _se=l4;function bse(t,e){var r=!1;return e==null&&(r=!0,e=qe(23+4*t.t.length)),e.write_shift(1,1),gs(t.t,e),e.write_shift(4,1),vse({},e),r?e.slice(0,e.l):e}function Si(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function pd(t,e){return e==null&&(e=qe(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function xd(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function yd(t,e){return e==null&&(e=qe(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var Sse=Gs,yL=gs;function c4(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Z1(t,e){var r=!1;return e==null&&(r=!0,e=qe(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var kse=Gs,zS=c4,u4=Z1;function d4(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?q1([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):cu(e,0)>>2;return r?s/100:s}function vL(t,e){e==null&&(e=qe(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function wL(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function Cse(t,e){return e||(e=qe(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var vd=wL,Ph=Cse;function $s(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Qu(t,e){return(e||qe(8)).write_shift(8,t,"f")}function Tse(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),a=t.read_shift(2,"i"),i=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var u=Tu[s];u&&(e.rgb=Hg(u));break;case 2:e.rgb=Hg([i,o,l]);break;case 3:e.theme=s;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function ey(t,e){if(e||(e=qe(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function Ese(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function Nse(t,e){e||(e=qe(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function _L(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function Ase(t){return _L(t,1)}function jse(t){return _L(t,2)}var f4=2,pa=3,fx=11,O8=12,ty=19,hx=64,Fse=65,Pse=71,Dse=4108,Rse=4126,cs=80,bL=81,Mse=[cs,bL],HS={1:{n:"CodePage",t:f4},2:{n:"Category",t:cs},3:{n:"PresentationFormat",t:cs},4:{n:"ByteCount",t:pa},5:{n:"LineCount",t:pa},6:{n:"ParagraphCount",t:pa},7:{n:"SlideCount",t:pa},8:{n:"NoteCount",t:pa},9:{n:"HiddenCount",t:pa},10:{n:"MultimediaClipCount",t:pa},11:{n:"ScaleCrop",t:fx},12:{n:"HeadingPairs",t:Dse},13:{n:"TitlesOfParts",t:Rse},14:{n:"Manager",t:cs},15:{n:"Company",t:cs},16:{n:"LinksUpToDate",t:fx},17:{n:"CharacterCount",t:pa},19:{n:"SharedDoc",t:fx},22:{n:"HyperlinksChanged",t:fx},23:{n:"AppVersion",t:pa,p:"version"},24:{n:"DigSig",t:Fse},26:{n:"ContentType",t:cs},27:{n:"ContentStatus",t:cs},28:{n:"Language",t:cs},29:{n:"Version",t:cs},255:{},2147483648:{n:"Locale",t:ty},2147483651:{n:"Behavior",t:ty},1919054434:{}},GS={1:{n:"CodePage",t:f4},2:{n:"Title",t:cs},3:{n:"Subject",t:cs},4:{n:"Author",t:cs},5:{n:"Keywords",t:cs},6:{n:"Comments",t:cs},7:{n:"Template",t:cs},8:{n:"LastAuthor",t:cs},9:{n:"RevNumber",t:cs},10:{n:"EditTime",t:hx},11:{n:"LastPrinted",t:hx},12:{n:"CreatedDate",t:hx},13:{n:"ModifiedDate",t:hx},14:{n:"PageCount",t:pa},15:{n:"WordCount",t:pa},16:{n:"CharCount",t:pa},17:{n:"Thumbnail",t:Pse},18:{n:"Application",t:cs},19:{n:"DocSecurity",t:pa},255:{},2147483648:{n:"Locale",t:ty},2147483651:{n:"Behavior",t:ty},1919054434:{}},B8={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Lse=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Ise(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var Ose=Ise([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Tu=Zr(Ose),Nl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},SL={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},VS={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},gx={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function h4(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Bse(t){var e=h4();if(!t||!t.match)return e;var r={};if((t.match(Qs)||[]).forEach(function(n){var s=Yt(n);switch(s[0].replace(Yne,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[VS[s.ContentType]]!==void 0&&e[VS[s.ContentType]].push(s.PartName);break}}),e.xmlns!==qn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function kL(t,e){var r=Bne(VS),n=[],s;n[n.length]=Mn,n[n.length]=xt("Types",null,{xmlns:qn.CT,"xmlns:xsd":qn.xsd,"xmlns:xsi":qn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return xt("Default",null,{Extension:l[0],ContentType:l[1]})}));var a=function(l){t[l]&&t[l].length>0&&(s=t[l][0],n[n.length]=xt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:gx[l][e.bookType]||gx[l].xlsx}))},i=function(l){(t[l]||[]).forEach(function(u){n[n.length]=xt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:gx[l][e.bookType]||gx[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=xt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ur={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function zg(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Y0(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Qs)||[]).forEach(function(s){var a=Yt(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:C0(a.Target,e);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function Ff(t){var e=[Mn,xt("Relationships",null,{xmlns:qn.RELS})];return Tn(t["!id"]).forEach(function(r){e[e.length]=xt("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Rr(t,e,r,n,s,a){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,[ur.HLINK,ur.XPATH,ur.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}var Use="application/vnd.oasis.opendocument.spreadsheet";function $se(t,e){for(var r=n4(t),n,s;n=Wg.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Yt(n[0],!1),s.path=="/"&&s.type!==Use)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function Wse(t){var e=[Mn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function U8(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function zse(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function Hse(t){var e=[Mn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(U8(t[r][0],t[r][1])),e.push(zse("",t[r][0]));return e.push(U8("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function CL(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+K1.version+"</meta:generator></office:meta></office:document-meta>"}var xi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Gse=function(){for(var t=new Array(xi.length),e=0;e<xi.length;++e){var r=xi[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function TL(t){var e={};t=Or(t);for(var r=0;r<xi.length;++r){var n=xi[r],s=t.match(Gse[r]);s!=null&&s.length>0&&(e[n[1]]=wr(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=qr(e[n[1]]))}return e}function b2(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=Mr(e),n[n.length]=r?xt(t,e,r):ks(t,e))}function EL(t,e){var r=e||{},n=[Mn,xt("cp:coreProperties",null,{"xmlns:cp":qn.CORE_PROPS,"xmlns:dc":qn.dc,"xmlns:dcterms":qn.dcterms,"xmlns:dcmitype":qn.dcmitype,"xmlns:xsi":qn.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&b2("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:WS(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&b2("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:WS(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=xi.length;++a){var i=xi[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:t?t[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&b2(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Eu=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],NL=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function AL(t,e,r,n){var s=[];if(typeof t=="string")s=j8(t,n);else for(var a=0;a<t.length;++a)s=s.concat(t[a].map(function(d){return{v:d}}));var i=typeof e=="string"?j8(e,n).map(function(d){return d.v}):e,o=0,l=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(l=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function Vse(t,e,r){var n={};return e||(e={}),t=Or(t),Eu.forEach(function(s){var a=(t.match(Ug(s[0]))||[])[1];switch(s[2]){case"string":a&&(e[s[1]]=wr(a));break;case"bool":e[s[1]]=a==="true";break;case"raw":var i=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&AL(n.HeadingPairs,n.TitlesOfParts,e,r),e}function jL(t){var e=[],r=xt;return t||(t={}),t.Application="SheetJS",e[e.length]=Mn,e[e.length]=xt("Properties",null,{xmlns:qn.EXT_PROPS,"xmlns:vt":qn.vt}),Eu.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Mr(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Mr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Kse=/<[^>]+>[^<]*/g;function Xse(t,e){var r={},n="",s=t.match(Kse);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Yt(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=wr(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),u=l[0].slice(4),d=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=wr(d);break;case"bool":r[n]=Kr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=qr(d);break;case"cy":case"error":r[n]=wr(d);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,l)}}else if(i.slice(0,2)!=="</"){if(e.WTF)throw new Error(i)}}}return r}function FL(t){var e=[Mn,xt("Properties",null,{xmlns:qn.CUST_PROPS,"xmlns:vt":qn.vt})];if(!t)return e.join("");var r=1;return Tn(t).forEach(function(s){++r,e[e.length]=xt("property",nse(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Mr(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var KS={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},S2;function Yse(t,e,r){S2||(S2=Uv(KS)),e=S2[e]||e,t[e]=r}function Jse(t,e){var r=[];return Tn(KS).map(function(n){for(var s=0;s<xi.length;++s)if(xi[s][1]==n)return xi[s];for(s=0;s<Eu.length;++s)if(Eu[s][1]==n)return Eu[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(ks(KS[n[1]]||n[1],s))}}),xt("DocumentProperties",r.join(""),{xmlns:Da.o})}function Qse(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&Tn(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)){for(var i=0;i<xi.length;++i)if(a==xi[i][1])return;for(i=0;i<Eu.length;++i)if(a==Eu[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=t[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),s.push(xt(T8(a),o,{"dt:dt":l}))}}),e&&Tn(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)&&!(t&&Object.prototype.hasOwnProperty.call(t,a))){var i=e[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(xt(T8(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Da.o+'">'+s.join("")+"</"+n+">"}function g4(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function qse(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=qe(8);return i.write_shift(4,n),i.write_shift(4,s),i}function PL(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function DL(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function RL(t,e,r){return e===31?DL(t):PL(t,e,r)}function XS(t,e,r){return RL(t,e,r===!1?0:4)}function Zse(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return RL(t,e,0)}function eae(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(oa,""),t.l-s&2&&(t.l+=2)}return r}function tae(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(oa,"");return r}function rae(t){var e=t.l,r=ry(t,bL);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=ry(t,pa);return[r,n]}function nae(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(rae(t));return r}function $8(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var a=t.read_shift(4),i=t.read_shift(4);n[a]=t.read_shift(i,e===1200?"utf16le":"utf8").replace(oa,"").replace(k0,"!"),e===1200&&i%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function ML(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function sae(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function ry(t,e,r){var n=t.read_shift(2),s,a=r||{};if(t.l+=2,e!==O8&&n!==e&&Mse.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===O8?n:e){case 2:return s=t.read_shift(2,"i"),a.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return PL(t,n,4).replace(oa,"");case 31:return DL(t);case 64:return g4(t);case 65:return ML(t);case 71:return sae(t);case 80:return XS(t,n,!a.raw).replace(oa,"");case 81:return Zse(t,n).replace(oa,"");case 4108:return nae(t);case 4126:case 4127:return n==4127?eae(t):tae(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function W8(t,e){var r=qe(4),n=qe(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=qe(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=qse(e);break;case 31:case 80:for(n=qe(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return hs([r,n])}function z8(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0,o=0,l=-1,u={};for(i=0;i!=s;++i){var d=t.read_shift(4),g=t.read_shift(4);a[i]=[d,g+r]}a.sort(function(_,y){return _[1]-y[1]});var h={};for(i=0;i!=s;++i){if(t.l!==a[i][1]){var p=!0;if(i>0&&e)switch(e[a[i-1][0]].t){case 2:t.l+2===a[i][1]&&(t.l+=2,p=!1);break;case 80:t.l<=a[i][1]&&(t.l=a[i][1],p=!1);break;case 4108:t.l<=a[i][1]&&(t.l=a[i][1],p=!1);break}if((!e||i==0)&&t.l<=a[i][1]&&(p=!1,t.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+t.l+" :"+i)}if(e){var x=e[a[i][0]];if(h[x.n]=ry(t,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Bi(o=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(a[i][0]===1){if(o=h.CodePage=ry(t,f4),Bi(o),l!==-1){var v=t.l;t.l=a[l][1],u=$8(t,o),t.l=v}}else if(a[i][0]===0){if(o===0){l=i,t.l=a[i+1][1];continue}u=$8(t,o)}else{var w=u[a[i][0]],S;switch(t[t.l]){case 65:t.l+=4,S=ML(t);break;case 30:t.l+=4,S=XS(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,S=XS(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,S=t.read_shift(4,"i");break;case 19:t.l+=4,S=t.read_shift(4);break;case 5:t.l+=4,S=t.read_shift(8,"f");break;case 11:t.l+=4,S=An(t,4);break;case 64:t.l+=4,S=qr(g4(t));break;default:throw new Error("unparsed value: "+t[t.l])}h[w]=S}}return t.l=r+n,h}var LL=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function aae(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function H8(t,e,r){var n=qe(8),s=[],a=[],i=8,o=0,l=qe(8),u=qe(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),a.push(l),s.push(u),i+=8+l.length,!e){u=qe(8),u.write_shift(4,0),s.unshift(u);var d=[qe(4)];for(d[0].write_shift(4,t.length),o=0;o<t.length;++o){var g=t[o][0];for(l=qe(8+2*(g.length+1)+(g.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,g.length+1),l.write_shift(0,g,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=hs(d),a.unshift(l),i+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(LL.indexOf(t[o][0])>-1||NL.indexOf(t[o][0])>-1)&&t[o][1]!=null){var h=t[o][1],p=0;if(e){p=+e[t[o][0]];var x=r[p];if(x.p=="version"&&typeof h=="string"){var v=h.split(".");h=(+v[0]<<16)+(+v[1]||0)}l=W8(x.t,h)}else{var w=aae(h);w==-1&&(w=31,h=String(h)),l=W8(w,h)}a.push(l),u=qe(8),u.write_shift(4,e?p:2+o),s.push(u),i+=8+l.length}var S=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,S),S+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),hs([n].concat(s).concat(a))}function G8(t,e,r){var n=t.content;if(!n)return{};_s(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==Wt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var g=z8(n,e),h={SystemIdentifier:u};for(var p in g)h[p]=g[p];if(h.FMTID=a,s===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=z8(n,null)}catch{}for(p in x)h[p]=x[p];return h.FMTID=[a,i],h}function V8(t,e,r,n,s,a){var i=qe(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Wt.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,e,"hex"),i.write_shift(4,s?68:48);var l=H8(t,r,n);if(o.push(l),s){var u=H8(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+l.length),o.push(u)}return hs(o)}function Ul(t,e){return t.read_shift(e),null}function iae(t,e){e||(e=qe(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function oae(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function An(t,e){return t.read_shift(e)===1}function ta(t,e){return e||(e=qe(2)),e.write_shift(2,+!!t),e}function Un(t){return t.read_shift(2,"u")}function li(t,e){return e||(e=qe(2)),e.write_shift(2,t),e}function IL(t,e){return oae(t,e,Un)}function lae(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function OL(t,e,r){return r||(r=qe(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Fm(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?t.read_shift(n,s):"";return i}function cae(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=t.read_shift(2)),n&&(o=t.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,u);return s&&(t.l+=4*i),n&&(t.l+=o),l.t=d,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function uae(t){var e=t.t||"",r=qe(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=qe(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return hs(s)}function qu(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Pm(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):qu(t,n,r)}function wd(t,e,r){if(r.biff>5)return Pm(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function BL(t,e,r){return r||(r=qe(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function dae(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function fae(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(oa,"");return n&&(t.l+=24),s}function hae(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=t.read_shift(a>>1,"utf16le").replace(oa,"");return r+i}function gae(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return fae(t);case"0303000000000000c000000000000046":return hae(t);default:throw new Error("Unsupported Moniker "+r)}}function mx(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(oa,""):"";return r}function K8(t,e){e||(e=qe(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function mae(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var a,i,o,l,u="",d,g;s&16&&(a=mx(t,r-t.l)),s&128&&(i=mx(t,r-t.l)),(s&257)===257&&(o=mx(t,r-t.l)),(s&257)===1&&(l=gae(t,r-t.l)),s&8&&(u=mx(t,r-t.l)),s&32&&(d=t.read_shift(16)),s&64&&(g=g4(t)),t.l=r;var h=i||o||l||"";h&&u&&(h+="#"+u),h||(h="#"+u),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return d&&(p.guid=d),g&&(p.time=g),a&&(p.Tooltip=a),p}function pae(t){var e=qe(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}e.write_shift(4,2),e.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)e.write_shift(4,i[r]);if(a==28)n=n.slice(1),K8(n,e);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)e.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),a&8&&K8(s>-1?n.slice(s+1):"",e)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)e.write_shift(1,parseInt(i[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function UL(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function $L(t,e){var r=UL(t);return r[3]=0,r}function Do(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Zu(t,e,r,n){return n||(n=qe(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function xae(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function yae(t,e,r){return e===0?"":wd(t,e,r)}function vae(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),a=t.read_shift(n,"i"),i=t.read_shift(n,"i");return[s,a,i]}function WL(t){var e=t.read_shift(2),r=d4(t);return[e,r]}function wae(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=Fm(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,s}function zv(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function zL(t,e){return e||(e=qe(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function HL(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var _ae=HL;function GL(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function bae(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function Sae(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Ms(t){t.l+=2,t.l+=t.read_shift(2)}var kae={0:Ms,4:Ms,5:Ms,6:Ms,7:Sae,8:Ms,9:Ms,10:Ms,11:Ms,12:Ms,13:bae,14:Ms,15:Ms,16:Ms,17:Ms,18:Ms,19:Ms,20:Ms,21:GL};function Cae(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(kae[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function px(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function m4(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=qe(s);return a.write_shift(2,n),a.write_shift(2,e),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function Tae(t,e){return e===0||t.read_shift(2),1200}function Eae(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=wd(t,0,r);return t.read_shift(e+n-t.l),s}function Nae(t,e){var r=!e||e.biff==8,n=qe(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Aae(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function jae(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Fm(t,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function Fae(t,e){var r=!e||e.biff>=8?2:1,n=qe(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function Pae(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0;i!=s&&t.l<r;++i)a.push(cae(t));return a.Count=n,a.Unique=s,a}function Dae(t,e){var r=qe(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=uae(t[s]);var a=hs([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function Rae(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function Mae(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function Lae(t){var e=xae(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function Iae(t){return t.read_shift(2),t.read_shift(4)}function X8(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function Oae(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:u}}function Bae(){var t=qe(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function Uae(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function $ae(t){var e=qe(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Wae(){}function zae(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Fm(t,0,r),n}function Hae(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,a=qe(s);return a.write_shift(2,t.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function Gae(t){var e=Do(t);return e.isst=t.read_shift(4),e}function Vae(t,e,r,n){var s=qe(10);return Zu(t,e,n,s),s.write_shift(4,r),s}function Kae(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Do(t);r.biff==2&&t.l++;var a=Pm(t,n-t.l,r);return s.val=a,s}function Xae(t,e,r,n,s){var a=!s||s.biff==8,i=qe(8+ +a+(1+a)*r.length);return Zu(t,e,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function Yae(t,e,r){var n=t.read_shift(2),s=wd(t,0,r);return[n,s]}function Jae(t,e,r,n){var s=r&&r.biff==5;n||(n=qe(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var Qae=wd;function Y8(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,a=t.read_shift(s),i=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function qae(t,e){var r=e.biff==8||!e.biff?4:2,n=qe(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function Zae(t){var e=t.read_shift(2),r=t.read_shift(2),n=WL(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function eie(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(WL(t));if(t.l!==r)throw new Error("MulRK read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function tie(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function rie(t,e,r,n){var s={},a=t.read_shift(4),i=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=Lse[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function nie(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=rie(t,e,n.fStyle,r),n}function J8(t,e,r,n){var s=r&&r.biff==5;n||(n=qe(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var a=0;return t.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function sie(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function aie(t){var e=qe(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Q8(t,e,r){var n=Do(t);(r.biff==2||e==9)&&++t.l;var s=lae(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function iie(t,e,r,n,s,a){var i=qe(8);return Zu(t,e,n,i),OL(r,a,i),i}function oie(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Do(t),s=$s(t);return n.val=s,n}function lie(t,e,r,n){var s=qe(14);return Zu(t,e,n,s),Qu(r,s),s}var q8=yae;function cie(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=qu(t,a),o=[];n>t.l;)o.push(Pm(t));return[a,s,i,o]}function Z8(t,e,r){var n=t.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=wae(t,e-2,r)),a.body=s||t.read_shift(e-2),typeof s=="string"&&(a.Name=s),a}var uie=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ej(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(1),i=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=qu(t,i,r);s&32&&(u=uie[u.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var g=n==t.l||o===0||!(d>0)?[]:Cue(t,d,r,o);return{chKey:a,Name:u,itab:l,rgce:g}}function VL(t,e,r){if(r.biff<8)return die(t,e,r);for(var n=[],s=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(vae(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function die(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Fm(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function fie(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),a=qu(t,n,r),i=qu(t,s,r);return[a,i]}function hie(t,e,r){var n=HL(t);t.l++;var s=t.read_shift(1);return e-=8,[Tue(t,e,r),s,n]}function tj(t,e,r){var n=_ae(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,Sue(t,e,r)]}function gie(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function mie(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=wd(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,i,a]}}function pie(t,e,r){return mie(t,e,r)}function xie(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(zv(t));return r}function yie(t){var e=qe(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)zL(t[r],e);return e}function vie(t,e,r){if(r&&r.biff<8)return _ie(t,e,r);var n=GL(t),s=Cae(t,e-22,n[1]);return{cmo:n,ft:s}}var wie={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function _ie(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var i=[];return i.push((wie[n]||Xs)(t,e,r)),{cmo:[s,n,a],ft:i}}function bie(t,e,r){var n=t.l,s="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:i=dae(t,6,r);var o=t.read_shift(2);t.read_shift(2),Un(t,2);var l=t.read_shift(2);t.l+=l;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var d=t[t.l],g=qu(t,t.lens[u+1]-t.lens[u]-1);if(s+=g,s.length>=(d?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function Sie(t,e){var r=zv(t);t.l+=16;var n=mae(t,e-24);return[r,n]}function kie(t){var e=qe(24),r=hn(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return hs([e,pae(t[1])])}function Cie(t,e){t.read_shift(2);var r=zv(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(oa,""),[r,n]}function Tie(t){var e=t[1].Tooltip,r=qe(10+2*(e.length+1));r.write_shift(2,2048);var n=hn(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function Eie(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=B8[r]||r,r=t.read_shift(2),e[1]=B8[r]||r,e}function Nie(t){return t||(t=qe(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Aie(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push($L(t));return r}function jie(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push($L(t));return r}function Fie(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function KL(t,e,r){if(!r.cellStyles)return Xs(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),a=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function Pie(t,e){var r=qe(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Die(t,e){var r={};return e<32||(t.l+=16,r.header=$s(t),r.footer=$s(t),t.l+=2),r}function Rie(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}function Mie(t){for(var e=qe(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var Lie=Do,Iie=IL,Oie=Pm;function Bie(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function Uie(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Do(t);++t.l;var s=wd(t,e-7,r);return n.t="str",n.val=s,n}function $ie(t){var e=Do(t);++t.l;var r=$s(t);return e.t="n",e.val=r,e}function Wie(t,e,r){var n=qe(15);return Lm(n,t,e),n.write_shift(8,r,"f"),n}function zie(t){var e=Do(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function Hie(t,e,r){var n=qe(9);return Lm(n,t,e),n.write_shift(2,r),n}function Gie(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function Vie(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function Kie(t,e,r){var n=t.l+e,s=Do(t),a=t.read_shift(2),i=qu(t,a,r);return t.l=n,s.t="str",s.val=i,s}var Xie=[2,3,48,49,131,139,140,245],YS=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Uv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],d=wc(1);switch(l.type){case"base64":d=Ma($a(o));break;case"binary":d=Ma(o);break;case"buffer":case"array":d=o;break}_s(d,0);var g=d.read_shift(1),h=!!(g&136),p=!1,x=!1;switch(g){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var v=0,w=521;g==2&&(v=d.read_shift(2)),d.l+=3,g!=2&&(v=d.read_shift(4)),v>1048576&&(v=1e6),g!=2&&(w=d.read_shift(2));var S=d.read_shift(2),_=l.codepage||1252;g!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(_=t[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var y=[],k={},N=Math.min(d.length,g==2?521:w-10-(p?264:0)),E=x?32:11;d.l<N&&d[d.l]!=13;)switch(k={},k.name=Ig.utils.decode(_,d.slice(d.l,d.l+E)).replace(/[\u0000\r\n].*$/g,""),d.l+=E,k.type=String.fromCharCode(d.read_shift(1)),g!=2&&!x&&(k.offset=d.read_shift(4)),k.len=d.read_shift(1),g==2&&(k.offset=d.read_shift(2)),k.dec=d.read_shift(1),k.name.length&&y.push(k),g!=2&&(d.l+=x?13:14),k.type){case"B":(!p||k.len!=8)&&l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var A=0,C=0;for(u[0]=[],C=0;C!=y.length;++C)u[0][C]=y[C].name;for(;v-- >0;){if(d[d.l]===42){d.l+=S;continue}for(++d.l,u[++A]=[],C=0,C=0;C!=y.length;++C){var F=d.slice(d.l,d.l+y[C].len);d.l+=y[C].len,_s(F,0);var D=Ig.utils.decode(_,F);switch(y[C].type){case"C":D.trim().length&&(u[A][C]=D.replace(/\s+$/,""));break;case"D":D.length===8?u[A][C]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):u[A][C]=D;break;case"F":u[A][C]=parseFloat(D.trim());break;case"+":case"I":u[A][C]=x?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":u[A][C]=!0;break;case"N":case"F":u[A][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));u[A][C]="##MEMO##"+(x?parseInt(D.trim(),10):F.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(u[A][C]=+D||0);break;case"@":u[A][C]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":u[A][C]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":u[A][C]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[A][C]=-F.read_shift(-8,"f");break;case"B":if(p&&y[C].len==8){u[A][C]=F.read_shift(8,"f");break}case"G":case"P":F.l+=y[C].len;break;case"0":if(y[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[C].type)}}}if(g!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=y,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Fh(r(o,u),u);return d["!cols"]=u.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete u.DBF,d}function s(o,l){try{return $c(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var u=l||{};if(+u.codepage>=0&&Bi(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Ea(),g=ay(o,{header:1,raw:!0,cellDates:!0}),h=g[0],p=g.slice(1),x=o["!cols"]||[],v=0,w=0,S=0,_=1;for(v=0;v<h.length;++v){if(((x[v]||{}).DBF||{}).name){h[v]=x[v].DBF.name,++S;continue}if(h[v]!=null){if(++S,typeof h[v]=="number"&&(h[v]=h[v].toString(10)),typeof h[v]!="string")throw new Error("DBF Invalid column name "+h[v]+" |"+typeof h[v]+"|");if(h.indexOf(h[v])!==v){for(w=0;w<1024;++w)if(h.indexOf(h[v]+"_"+w)==-1){h[v]+="_"+w;break}}}}var y=_r(o["!ref"]),k=[],N=[],E=[];for(v=0;v<=y.e.c-y.s.c;++v){var A="",C="",F=0,D=[];for(w=0;w<p.length;++w)p[w][v]!=null&&D.push(p[w][v]);if(D.length==0||h[v]==null){k[v]="?";continue}for(w=0;w<D.length;++w){switch(typeof D[w]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=D[w]instanceof Date?"D":"C";break;default:C="C"}F=Math.max(F,String(D[w]).length),A=A&&A!=C?"C":C}F>250&&(F=250),C=((x[v]||{}).DBF||{}).type,C=="C"&&x[v].DBF.len>F&&(F=x[v].DBF.len),A=="B"&&C=="N"&&(A="N",E[v]=x[v].DBF.dec,F=x[v].DBF.len),N[v]=A=="C"||C=="N"?F:a[A]||0,_+=N[v],k[v]=A}var R=d.next(32);for(R.write_shift(4,318902576),R.write_shift(4,p.length),R.write_shift(2,296+32*S),R.write_shift(2,_),v=0;v<4;++v)R.write_shift(4,0);for(R.write_shift(4,0|(+e[LM]||3)<<8),v=0,w=0;v<h.length;++v)if(h[v]!=null){var M=d.next(32),B=(h[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,B,"sbcs"),M.write_shift(1,k[v]=="?"?"C":k[v],"sbcs"),M.write_shift(4,w),M.write_shift(1,N[v]||a[k[v]]||0),M.write_shift(1,E[v]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),w+=N[v]||a[k[v]]||0}var J=d.next(264);for(J.write_shift(4,13),v=0;v<65;++v)J.write_shift(4,0);for(v=0;v<p.length;++v){var X=d.next(_);for(X.write_shift(1,0),w=0;w<h.length;++w)if(h[w]!=null)switch(k[w]){case"L":X.write_shift(1,p[v][w]==null?63:p[v][w]?84:70);break;case"B":X.write_shift(8,p[v][w]||0,"f");break;case"N":var z="0";for(typeof p[v][w]=="number"&&(z=p[v][w].toFixed(E[w]||0)),S=0;S<N[w]-z.length;++S)X.write_shift(1,32);X.write_shift(1,z,"sbcs");break;case"D":p[v][w]?(X.write_shift(4,("0000"+p[v][w].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(p[v][w].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+p[v][w].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var H=String(p[v][w]!=null?p[v][w]:"").slice(0,N[w]);for(X.write_shift(1,H,"sbcs"),S=0;S<N[w]-H.length;++S)X.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),XL=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Tn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var x=t[p];return typeof x=="number"?f8(x):x},n=function(h,p,x){var v=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return v==59?h:f8(v)};t["|"]=254;function s(h,p){switch(p.type){case"base64":return a($a(h),p);case"binary":return a(h,p);case"buffer":return a(lr&&Buffer.isBuffer(h)?h.toString("binary"):Uc(h),p);case"array":return a(Ju(h),p)}throw new Error("Unrecognized type "+p.type)}function a(h,p){var x=h.split(/[\n\r]+/),v=-1,w=-1,S=0,_=0,y=[],k=[],N=null,E={},A=[],C=[],F=[],D=0,R;for(+p.codepage>=0&&Bi(+p.codepage);S!==x.length;++S){D=0;var M=x[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),B=M.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),J=B[0],X;if(M.length>0)switch(J){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":B[1].charAt(0)=="P"&&k.push(M.slice(3).replace(/;;/g,";"));break;case"C":var z=!1,H=!1,U=!1,L=!1,ne=-1,de=-1;for(_=1;_<B.length;++_)switch(B[_].charAt(0)){case"A":break;case"X":w=parseInt(B[_].slice(1))-1,H=!0;break;case"Y":for(v=parseInt(B[_].slice(1))-1,H||(w=0),R=y.length;R<=v;++R)y[R]=[];break;case"K":X=B[_].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN(Gi(X))?isNaN(eh(X).getDate())||(X=qr(X)):(X=Gi(X),N!==null&&Ah(N)&&(X=Wv(X))),z=!0;break;case"E":L=!0;var G=Pf(B[_].slice(1),{r:v,c:w});y[v][w]=[y[v][w],G];break;case"S":U=!0,y[v][w]=[y[v][w],"S5S"];break;case"G":break;case"R":ne=parseInt(B[_].slice(1))-1;break;case"C":de=parseInt(B[_].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+M)}if(z&&(y[v][w]&&y[v][w].length==2?y[v][w][0]=X:y[v][w]=X,N=null),U){if(L)throw new Error("SYLK shared formula cannot have own formula");var K=ne>-1&&y[ne][de];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");y[v][w][1]=fI(K[1],{r:v-ne,c:w-de})}break;case"F":var Q=0;for(_=1;_<B.length;++_)switch(B[_].charAt(0)){case"X":w=parseInt(B[_].slice(1))-1,++Q;break;case"Y":for(v=parseInt(B[_].slice(1))-1,R=y.length;R<=v;++R)y[R]=[];break;case"M":D=parseInt(B[_].slice(1))/20;break;case"F":break;case"G":break;case"P":N=k[parseInt(B[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=B[_].slice(1).split(" "),R=parseInt(F[0],10);R<=parseInt(F[1],10);++R)D=parseInt(F[2],10),C[R-1]=D===0?{hidden:!0}:{wch:D},_c(C[R-1]);break;case"C":w=parseInt(B[_].slice(1))-1,C[w]||(C[w]={});break;case"R":v=parseInt(B[_].slice(1))-1,A[v]||(A[v]={}),D>0?(A[v].hpt=D,A[v].hpx=rh(D)):D===0&&(A[v].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+M)}Q<1&&(N=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+M)}}return A.length>0&&(E["!rows"]=A),C.length>0&&(E["!cols"]=C),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,E]}function i(h,p){var x=s(h,p),v=x[0],w=x[1],S=Fh(v,p);return Tn(w).forEach(function(_){S[_]=w[_]}),S}function o(h,p){return $c(i(h,p),p)}function l(h,p,x,v){var w="C;Y"+(x+1)+";X"+(v+1)+";K";switch(h.t){case"n":w+=h.v||0,h.f&&!h.F&&(w+=";E"+_4(h.f,{r:x,c:v}));break;case"b":w+=h.v?"TRUE":"FALSE";break;case"e":w+=h.w||h.v;break;case"d":w+='"'+(h.w||h.v)+'"';break;case"s":w+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(h,p){p.forEach(function(x,v){var w="F;W"+(v+1)+" "+(v+1)+" ";x.hidden?w+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Gg(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Vg(x.wpx)),typeof x.wch=="number"&&(w+=Math.round(x.wch))),w.charAt(w.length-1)!=" "&&h.push(w)})}function d(h,p){p.forEach(function(x,v){var w="F;";x.hidden?w+="M0;":x.hpt?w+="M"+20*x.hpt+";":x.hpx&&(w+="M"+20*Kg(x.hpx)+";"),w.length>2&&h.push(w+"R"+(v+1))})}function g(h,p){var x=["ID;PWXL;N;E"],v=[],w=_r(h["!ref"]),S,_=Array.isArray(h),y=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&u(x,h["!cols"]),h["!rows"]&&d(x,h["!rows"]),x.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var k=w.s.r;k<=w.e.r;++k)for(var N=w.s.c;N<=w.e.c;++N){var E=Kt({r:k,c:N});S=_?(h[k]||[])[N]:h[E],!(!S||S.v==null&&(!S.f||S.F))&&v.push(l(S,h,k,N))}return x.join(y)+y+v.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:i,from_sheet:g}}(),YL=function(){function t(a,i){switch(i.type){case"base64":return e($a(a),i);case"binary":return e(a,i);case"buffer":return e(lr&&Buffer.isBuffer(a)?a.toString("binary"):Uc(a),i);case"array":return e(Ju(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){for(var o=a.split(`
`),l=-1,u=-1,d=0,g=[];d!==o.length;++d){if(o[d].trim()==="BOT"){g[++l]=[],u=0;continue}if(!(l<0)){var h=o[d].trim().split(","),p=h[0],x=h[1];++d;for(var v=o[d]||"";(v.match(/["]/g)||[]).length&1&&d<o.length-1;)v+=`
`+o[++d];switch(v=v.trim(),+p){case-1:if(v==="BOT"){g[++l]=[],u=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?g[l][u]=!0:v==="FALSE"?g[l][u]=!1:isNaN(Gi(x))?isNaN(eh(x).getDate())?g[l][u]=x:g[l][u]=qr(x):g[l][u]=Gi(x),++u;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),g[l][u++]=v!==""?v:null;break}if(v==="EOD")break}}return i&&i.sheetRows&&(g=g.slice(0,i.sheetRows)),g}function r(a,i){return Fh(t(a,i),i)}function n(a,i){return $c(r(a,i),i)}var s=function(){var a=function(l,u,d,g,h){l.push(u),l.push(d+","+g),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,u,d,g){l.push(u+","+d),l.push(u==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(l){var u=[],d=_r(l["!ref"]),g,h=Array.isArray(l);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){i(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var v=Kt({r:p,c:x});if(g=h?(l[p]||[])[x]:l[v],!g){i(u,1,0,"");continue}switch(g.t){case"n":var w=g.w;!w&&g.v!=null&&(w=g.v),w==null?g.f&&!g.F?i(u,1,0,"="+g.f):i(u,1,0,""):i(u,0,w,"V");break;case"b":i(u,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=bi(g.z||Gt[14],ts(qr(g.v)))),i(u,0,g.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var S=`\r
`,_=u.join(S);return _}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),JL=function(){function t(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,h){for(var p=g.split(`
`),x=-1,v=-1,w=0,S=[];w!==p.length;++w){var _=p[w].trim().split(":");if(_[0]==="cell"){var y=hn(_[1]);if(S.length<=y.r)for(x=S.length;x<=y.r;++x)S[x]||(S[x]=[]);switch(x=y.r,v=y.c,_[2]){case"t":S[x][v]=t(_[3]);break;case"v":S[x][v]=+_[3];break;case"vtf":var k=_[_.length-1];case"vtc":switch(_[3]){case"nl":S[x][v]=!!+_[4];break;default:S[x][v]=+_[4];break}_[2]=="vtf"&&(S[x][v]=[S[x][v],k])}}}return h&&h.sheetRows&&(S=S.slice(0,h.sheetRows)),S}function n(g,h){return Fh(r(g,h),h)}function s(g,h){return $c(n(g,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(g){if(!g||!g["!ref"])return"";for(var h=[],p=[],x,v="",w=Na(g["!ref"]),S=Array.isArray(g),_=w.s.r;_<=w.e.r;++_)for(var y=w.s.c;y<=w.e.c;++y)if(v=Kt({r:_,c:y}),x=S?(g[_]||[])[y]:g[v],!(!x||x.v==null||x.t==="z")){switch(p=["cell",v,"t"],x.t){case"s":case"str":p.push(e(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=e(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=e(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var k=ts(qr(x.v));p[2]="vtc",p[3]="nd",p[4]=""+k,p[5]=x.w||bi(x.z||Gt[14],k);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(g){return[a,i,o,i,u(g),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),th=function(){function t(d,g,h,p,x){x.raw?g[h][p]=d:d===""||(d==="TRUE"?g[h][p]=!0:d==="FALSE"?g[h][p]=!1:isNaN(Gi(d))?isNaN(eh(d).getDate())?g[h][p]=d:g[h][p]=qr(d):g[h][p]=Gi(d))}function e(d,g){var h=g||{},p=[];if(!d||d.length===0)return p;for(var x=d.split(/[\r\n]/),v=x.length-1;v>=0&&x[v].length===0;)--v;for(var w=10,S=0,_=0;_<=v;++_)S=x[_].indexOf(" "),S==-1?S=x[_].length:S++,w=Math.max(w,S);for(_=0;_<=v;++_){p[_]=[];var y=0;for(t(x[_].slice(0,w).trim(),p,_,y,h),y=1;y<=(x[_].length-w)/10+1;++y)t(x[_].slice(w+(y-1)*10,w+y*10).trim(),p,_,y,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var g={},h=!1,p=0,x=0;p<d.length;++p)(x=d.charCodeAt(p))==34?h=!h:!h&&x in r&&(g[x]=(g[x]||0)+1);x=[];for(p in g)Object.prototype.hasOwnProperty.call(g,p)&&x.push([g[p],p]);if(!x.length){g=n;for(p in g)Object.prototype.hasOwnProperty.call(g,p)&&x.push([g[p],p])}return x.sort(function(v,w){return v[0]-w[0]||n[v[1]]-n[w[1]]}),r[x.pop()[1]]||44}function a(d,g){var h=g||{},p="",x=h.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=s(d.slice(0,1024)):h&&h.FS?p=h.FS:p=s(d.slice(0,1024));var w=0,S=0,_=0,y=0,k=0,N=p.charCodeAt(0),E=!1,A=0,C=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var F=h.dateNF!=null?Rne(h.dateNF):null;function D(){var R=d.slice(y,k),M={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)M.t="z";else if(h.raw)M.t="s",M.v=R;else if(R.trim().length===0)M.t="s",M.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(M.t="s",M.v=R.slice(2,-1).replace(/""/g,'"')):cce(R)?(M.t="n",M.f=R.slice(1)):(M.t="s",M.v=R);else if(R=="TRUE")M.t="b",M.v=!0;else if(R=="FALSE")M.t="b",M.v=!1;else if(!isNaN(_=Gi(R)))M.t="n",h.cellText!==!1&&(M.w=R),M.v=_;else if(!isNaN(eh(R).getDate())||F&&R.match(F)){M.z=h.dateNF||Gt[14];var B=0;F&&R.match(F)&&(R=Mne(R,h.dateNF,R.match(F)||[]),B=1),h.cellDates?(M.t="d",M.v=qr(R,B)):(M.t="n",M.v=ts(qr(R,B))),h.cellText!==!1&&(M.w=bi(M.z,M.v instanceof Date?ts(M.v):M.v)),h.cellNF||delete M.z}else M.t="s",M.v=R;if(M.t=="z"||(h.dense?(x[w]||(x[w]=[]),x[w][S]=M):x[Kt({c:S,r:w})]=M),y=k+1,C=d.charCodeAt(y),v.e.c<S&&(v.e.c=S),v.e.r<w&&(v.e.r=w),A==N)++S;else if(S=0,++w,h.sheetRows&&h.sheetRows<=w)return!0}e:for(;k<d.length;++k)switch(A=d.charCodeAt(k)){case 34:C===34&&(E=!E);break;case N:case 10:case 13:if(!E&&D())break e;break}return k-y>0&&D(),x["!ref"]=sr(v),x}function i(d,g){return!(g&&g.PRN)||g.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,g):Fh(e(d,g),g)}function o(d,g){var h="",p=g.type=="string"?[0,0,0,0]:A4(d,g);switch(g.type){case"base64":h=$a(d);break;case"binary":h=d;break;case"buffer":g.codepage==65001?h=d.toString("utf8"):g.codepage&&typeof Ig<"u"||(h=lr&&Buffer.isBuffer(d)?d.toString("binary"):Uc(d));break;case"array":h=Ju(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+g.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=Or(h.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?h=Or(h):g.type=="binary"&&typeof Ig<"u",h.slice(0,19)=="socialcalc:version:"?JL.to_sheet(g.type=="string"?h:Or(h),g):i(h,g)}function l(d,g){return $c(o(d,g),g)}function u(d){for(var g=[],h=_r(d["!ref"]),p,x=Array.isArray(d),v=h.s.r;v<=h.e.r;++v){for(var w=[],S=h.s.c;S<=h.e.c;++S){var _=Kt({r:v,c:S});if(p=x?(d[v]||[])[S]:d[_],!p||p.v==null){w.push("          ");continue}for(var y=(p.w||(yl(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";w.push(y+(S===0?" ":""))}g.push(w.join(""))}return g.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function Yie(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=XL.to_workbook(t,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return th.to_workbook(t,e)}}var Nu=function(){function t(G,K,Q){if(G){_s(G,G.l||0);for(var q=Q.Enum||ne;G.l<G.length;){var se=G.read_shift(2),W=q[se]||q[65535],ee=G.read_shift(2),ve=G.l+ee,_e=W.f&&W.f(G,ee,Q);if(G.l=ve,K(_e,W,se))return}}}function e(G,K){switch(K.type){case"base64":return r(Ma($a(G)),K);case"binary":return r(Ma(G),K);case"buffer":case"array":return r(G,K)}throw"Unsupported type "+K.type}function r(G,K){if(!G)return G;var Q=K||{},q=Q.dense?[]:{},se="Sheet1",W="",ee=0,ve={},_e=[],Le=[],te={s:{r:0,c:0},e:{r:0,c:0}},Ne=Q.sheetRows||0;if(G[2]==0&&(G[3]==8||G[3]==9)&&G.length>=16&&G[14]==5&&G[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(G[2]==2)Q.Enum=ne,t(G,function($e,De,at){switch(at){case 0:Q.vers=$e,$e>=4096&&(Q.qpro=!0);break;case 6:te=$e;break;case 204:$e&&(W=$e);break;case 222:W=$e;break;case 15:case 51:Q.qpro||($e[1].v=$e[1].v.slice(1));case 13:case 14:case 16:at==14&&($e[2]&112)==112&&($e[2]&15)>1&&($e[2]&15)<15&&($e[1].z=Q.dateNF||Gt[14],Q.cellDates&&($e[1].t="d",$e[1].v=Wv($e[1].v))),Q.qpro&&$e[3]>ee&&(q["!ref"]=sr(te),ve[se]=q,_e.push(se),q=Q.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},ee=$e[3],se=W||"Sheet"+(ee+1),W="");var Se=Q.dense?(q[$e[0].r]||[])[$e[0].c]:q[Kt($e[0])];if(Se){Se.t=$e[1].t,Se.v=$e[1].v,$e[1].z!=null&&(Se.z=$e[1].z),$e[1].f!=null&&(Se.f=$e[1].f);break}Q.dense?(q[$e[0].r]||(q[$e[0].r]=[]),q[$e[0].r][$e[0].c]=$e[1]):q[Kt($e[0])]=$e[1];break}},Q);else if(G[2]==26||G[2]==14)Q.Enum=de,G[2]==14&&(Q.qpro=!0,G.l=0),t(G,function($e,De,at){switch(at){case 204:se=$e;break;case 22:$e[1].v=$e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if($e[3]>ee&&(q["!ref"]=sr(te),ve[se]=q,_e.push(se),q=Q.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},ee=$e[3],se="Sheet"+(ee+1)),Ne>0&&$e[0].r>=Ne)break;Q.dense?(q[$e[0].r]||(q[$e[0].r]=[]),q[$e[0].r][$e[0].c]=$e[1]):q[Kt($e[0])]=$e[1],te.e.c<$e[0].c&&(te.e.c=$e[0].c),te.e.r<$e[0].r&&(te.e.r=$e[0].r);break;case 27:$e[14e3]&&(Le[$e[14e3][0]]=$e[14e3][1]);break;case 1537:Le[$e[0]]=$e[1],$e[0]==ee&&(se=$e[1]);break}},Q);else throw new Error("Unrecognized LOTUS BOF "+G[2]);if(q["!ref"]=sr(te),ve[W||se]=q,_e.push(W||se),!Le.length)return{SheetNames:_e,Sheets:ve};for(var Ce={},We=[],nt=0;nt<Le.length;++nt)ve[_e[nt]]?(We.push(Le[nt]||_e[nt]),Ce[Le[nt]]=ve[Le[nt]]||ve[_e[nt]]):(We.push(Le[nt]),Ce[Le[nt]]={"!ref":"A1"});return{SheetNames:We,Sheets:Ce}}function n(G,K){var Q=K||{};if(+Q.codepage>=0&&Bi(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK1 to JS string");var q=Ea(),se=_r(G["!ref"]),W=Array.isArray(G),ee=[];vt(q,0,a(1030)),vt(q,6,l(se));for(var ve=Math.min(se.e.r,8191),_e=se.s.r;_e<=ve;++_e)for(var Le=Dn(_e),te=se.s.c;te<=se.e.c;++te){_e===se.s.r&&(ee[te]=fn(te));var Ne=ee[te]+Le,Ce=W?(G[_e]||[])[te]:G[Ne];if(!(!Ce||Ce.t=="z"))if(Ce.t=="n")(Ce.v|0)==Ce.v&&Ce.v>=-32768&&Ce.v<=32767?vt(q,13,p(_e,te,Ce.v)):vt(q,14,v(_e,te,Ce.v));else{var We=yl(Ce);vt(q,15,g(_e,te,We.slice(0,239)))}}return vt(q,1),q.end()}function s(G,K){var Q=K||{};if(+Q.codepage>=0&&Bi(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK3 to JS string");var q=Ea();vt(q,0,i(G));for(var se=0,W=0;se<G.SheetNames.length;++se)(G.Sheets[G.SheetNames[se]]||{})["!ref"]&&vt(q,27,L(G.SheetNames[se],W++));var ee=0;for(se=0;se<G.SheetNames.length;++se){var ve=G.Sheets[G.SheetNames[se]];if(!(!ve||!ve["!ref"])){for(var _e=_r(ve["!ref"]),Le=Array.isArray(ve),te=[],Ne=Math.min(_e.e.r,8191),Ce=_e.s.r;Ce<=Ne;++Ce)for(var We=Dn(Ce),nt=_e.s.c;nt<=_e.e.c;++nt){Ce===_e.s.r&&(te[nt]=fn(nt));var $e=te[nt]+We,De=Le?(ve[Ce]||[])[nt]:ve[$e];if(!(!De||De.t=="z"))if(De.t=="n")vt(q,23,D(Ce,nt,ee,De.v));else{var at=yl(De);vt(q,22,A(Ce,nt,ee,at.slice(0,239)))}}++ee}}return vt(q,1),q.end()}function a(G){var K=qe(2);return K.write_shift(2,G),K}function i(G){var K=qe(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var Q=0,q=0,se=0,W=0;W<G.SheetNames.length;++W){var ee=G.SheetNames[W],ve=G.Sheets[ee];if(!(!ve||!ve["!ref"])){++se;var _e=Na(ve["!ref"]);Q<_e.e.r&&(Q=_e.e.r),q<_e.e.c&&(q=_e.e.c)}}return Q>8191&&(Q=8191),K.write_shift(2,Q),K.write_shift(1,se),K.write_shift(1,q),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(G,K,Q){var q={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&Q.qpro?(q.s.c=G.read_shift(1),G.l++,q.s.r=G.read_shift(2),q.e.c=G.read_shift(1),G.l++,q.e.r=G.read_shift(2),q):(q.s.c=G.read_shift(2),q.s.r=G.read_shift(2),K==12&&Q.qpro&&(G.l+=2),q.e.c=G.read_shift(2),q.e.r=G.read_shift(2),K==12&&Q.qpro&&(G.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function l(G){var K=qe(8);return K.write_shift(2,G.s.c),K.write_shift(2,G.s.r),K.write_shift(2,G.e.c),K.write_shift(2,G.e.r),K}function u(G,K,Q){var q=[{c:0,r:0},{t:"n",v:0},0,0];return Q.qpro&&Q.vers!=20768?(q[0].c=G.read_shift(1),q[3]=G.read_shift(1),q[0].r=G.read_shift(2),G.l+=2):(q[2]=G.read_shift(1),q[0].c=G.read_shift(2),q[0].r=G.read_shift(2)),q}function d(G,K,Q){var q=G.l+K,se=u(G,K,Q);if(se[1].t="s",Q.vers==20768){G.l++;var W=G.read_shift(1);return se[1].v=G.read_shift(W,"utf8"),se}return Q.qpro&&G.l++,se[1].v=G.read_shift(q-G.l,"cstr"),se}function g(G,K,Q){var q=qe(7+Q.length);q.write_shift(1,255),q.write_shift(2,K),q.write_shift(2,G),q.write_shift(1,39);for(var se=0;se<q.length;++se){var W=Q.charCodeAt(se);q.write_shift(1,W>=128?95:W)}return q.write_shift(1,0),q}function h(G,K,Q){var q=u(G,K,Q);return q[1].v=G.read_shift(2,"i"),q}function p(G,K,Q){var q=qe(7);return q.write_shift(1,255),q.write_shift(2,K),q.write_shift(2,G),q.write_shift(2,Q,"i"),q}function x(G,K,Q){var q=u(G,K,Q);return q[1].v=G.read_shift(8,"f"),q}function v(G,K,Q){var q=qe(13);return q.write_shift(1,255),q.write_shift(2,K),q.write_shift(2,G),q.write_shift(8,Q,"f"),q}function w(G,K,Q){var q=G.l+K,se=u(G,K,Q);if(se[1].v=G.read_shift(8,"f"),Q.qpro)G.l=q;else{var W=G.read_shift(2);k(G.slice(G.l,G.l+W),se),G.l+=W}return se}function S(G,K,Q){var q=K&32768;return K&=-32769,K=(q?G:0)+(K>=8192?K-16384:K),(q?"":"$")+(Q?fn(K):Dn(K))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(G,K){_s(G,0);for(var Q=[],q=0,se="",W="",ee="",ve="";G.l<G.length;){var _e=G[G.l++];switch(_e){case 0:Q.push(G.read_shift(8,"f"));break;case 1:W=S(K[0].c,G.read_shift(2),!0),se=S(K[0].r,G.read_shift(2),!1),Q.push(W+se);break;case 2:{var Le=S(K[0].c,G.read_shift(2),!0),te=S(K[0].r,G.read_shift(2),!1);W=S(K[0].c,G.read_shift(2),!0),se=S(K[0].r,G.read_shift(2),!1),Q.push(Le+te+":"+W+se)}break;case 3:if(G.l<G.length){console.error("WK1 premature formula end");return}break;case 4:Q.push("("+Q.pop()+")");break;case 5:Q.push(G.read_shift(2));break;case 6:{for(var Ne="";_e=G[G.l++];)Ne+=String.fromCharCode(_e);Q.push('"'+Ne.replace(/"/g,'""')+'"')}break;case 8:Q.push("-"+Q.pop());break;case 23:Q.push("+"+Q.pop());break;case 22:Q.push("NOT("+Q.pop()+")");break;case 20:case 21:ve=Q.pop(),ee=Q.pop(),Q.push(["AND","OR"][_e-20]+"("+ee+","+ve+")");break;default:if(_e<32&&y[_e])ve=Q.pop(),ee=Q.pop(),Q.push(ee+y[_e]+ve);else if(_[_e]){if(q=_[_e][1],q==69&&(q=G[G.l++]),q>Q.length){console.error("WK1 bad formula parse 0x"+_e.toString(16)+":|"+Q.join("|")+"|");return}var Ce=Q.slice(-q);Q.length-=q,Q.push(_[_e][0]+"("+Ce.join(",")+")")}else return _e<=7?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=24?console.error("WK1 unsupported op "+_e.toString(16)):_e<=30?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=115?console.error("WK1 unsupported function opcode "+_e.toString(16)):console.error("WK1 unrecognized opcode "+_e.toString(16))}}Q.length==1?K[1].f=""+Q[0]:console.error("WK1 bad formula parse |"+Q.join("|")+"|")}function N(G){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=G.read_shift(2),K[3]=G[G.l++],K[0].c=G[G.l++],K}function E(G,K){var Q=N(G);return Q[1].t="s",Q[1].v=G.read_shift(K-4,"cstr"),Q}function A(G,K,Q,q){var se=qe(6+q.length);se.write_shift(2,G),se.write_shift(1,Q),se.write_shift(1,K),se.write_shift(1,39);for(var W=0;W<q.length;++W){var ee=q.charCodeAt(W);se.write_shift(1,ee>=128?95:ee)}return se.write_shift(1,0),se}function C(G,K){var Q=N(G);Q[1].v=G.read_shift(2);var q=Q[1].v>>1;if(Q[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return Q[1].v=q,Q}function F(G,K){var Q=N(G),q=G.read_shift(4),se=G.read_shift(4),W=G.read_shift(2);if(W==65535)return q===0&&se===3221225472?(Q[1].t="e",Q[1].v=15):q===0&&se===3489660928?(Q[1].t="e",Q[1].v=42):Q[1].v=0,Q;var ee=W&32768;return W=(W&32767)-16446,Q[1].v=(1-ee*2)*(se*Math.pow(2,W+32)+q*Math.pow(2,W)),Q}function D(G,K,Q,q){var se=qe(14);if(se.write_shift(2,G),se.write_shift(1,Q),se.write_shift(1,K),q==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var W=0,ee=0,ve=0,_e=0;return q<0&&(W=1,q=-q),ee=Math.log2(q)|0,q/=Math.pow(2,ee-31),_e=q>>>0,_e&2147483648||(q/=2,++ee,_e=q>>>0),q-=_e,_e|=2147483648,_e>>>=0,q*=Math.pow(2,32),ve=q>>>0,se.write_shift(4,ve),se.write_shift(4,_e),ee+=16383+(W?32768:0),se.write_shift(2,ee),se}function R(G,K){var Q=F(G);return G.l+=K-14,Q}function M(G,K){var Q=N(G),q=G.read_shift(4);return Q[1].v=q>>6,Q}function B(G,K){var Q=N(G),q=G.read_shift(8,"f");return Q[1].v=q,Q}function J(G,K){var Q=B(G);return G.l+=K-10,Q}function X(G,K){return G[G.l+K-1]==0?G.read_shift(K,"cstr"):""}function z(G,K){var Q=G[G.l++];Q>K-1&&(Q=K-1);for(var q="";q.length<Q;)q+=String.fromCharCode(G[G.l++]);return q}function H(G,K,Q){if(!(!Q.qpro||K<21)){var q=G.read_shift(1);G.l+=17,G.l+=1,G.l+=2;var se=G.read_shift(K-21,"cstr");return[q,se]}}function U(G,K){for(var Q={},q=G.l+K;G.l<q;){var se=G.read_shift(2);if(se==14e3){for(Q[se]=[0,""],Q[se][0]=G.read_shift(2);G[G.l];)Q[se][1]+=String.fromCharCode(G[G.l]),G.l++;G.l++}}return Q}function L(G,K){var Q=qe(5+G.length);Q.write_shift(2,14e3),Q.write_shift(2,K);for(var q=0;q<G.length;++q){var se=G.charCodeAt(q);Q[Q.l++]=se>127?95:se}return Q[Q.l++]=0,Q}var ne={0:{n:"BOF",f:Un},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:z},65535:{n:""}},de={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:U},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:B},40:{n:"FORMULA28",f:J},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:H},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function Jie(t){var e={},r=t.match(Qs),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Yt(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=VT[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return e}var Qie=function(){var t=Ug("t"),e=Ug("rPr");function r(a){var i=a.match(t);if(!i)return{t:"s",v:""};var o={t:"s",v:wr(i[1])},l=a.match(e);return l&&(o.s=Jie(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),qie=function(){var e=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),Zie=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,eoe=/<(?:\w+:)?r>/,toe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function p4(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=wr(Or(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Or(t),r&&(n.h=r4(n.t))):t.match(eoe)&&(n.r=Or(t),n.t=wr(Or((t.replace(toe,"").match(Zie)||[]).join("").replace(Qs,""))),r&&(n.h=qie(Qie(n.r)))),n):{t:""}}var roe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,noe=/<(?:\w+:)?(?:si|sstItem)>/g,soe=/<\/(?:\w+:)?(?:si|sstItem)>/;function aoe(t,e){var r=[],n="";if(!t)return r;var s=t.match(roe);if(s){n=s[2].replace(noe,"").split(soe);for(var a=0;a!=n.length;++a){var i=p4(n[a].trim(),e);i!=null&&(r[r.length]=i)}s=Yt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var ioe=/^\s|\s$|[\t\n\r]/;function QL(t,e){if(!e.bookSST)return"";var r=[Mn];r[r.length]=xt("sst",null,{xmlns:md[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(ioe)&&(a+=' xml:space="preserve"'),a+=">"+Mr(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function ooe(t){return[t.read_shift(4),t.read_shift(4)]}function loe(t,e){var r=[],n=!1;return El(t,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function coe(t,e){return e||(e=qe(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var uoe=wse;function doe(t){var e=Ea();ot(e,159,coe(t));for(var r=0;r<t.length;++r)ot(e,19,uoe(t[r]));return ot(e,160),e.end()}function qL(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function cl(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function foe(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=cl(t,4),e.U=cl(t,4),e.W=cl(t,4),e}function hoe(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),a=[];s-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function goe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(hoe(t));return e}function moe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function poe(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=cl(t,4),e.U=cl(t,4),e.W=cl(t,4),e}function xoe(t){var e=poe(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function ZL(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function eI(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function yoe(t){var e=cl(t);switch(e.Minor){case 2:return[e.Minor,voe(t)];case 3:return[e.Minor,woe()];case 4:return[e.Minor,_oe(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function voe(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=ZL(t,r),s=eI(t,t.length-t.l);return{t:"Std",h:n,v:s}}function woe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function _oe(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Qs,function(a){var i=Yt(a);switch(Po(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function boe(t,e){var r={},n=r.EncryptionVersionInfo=cl(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=ZL(t,s),e-=s,r.EncryptionVerifier=eI(t,e),r}function Soe(t){var e={},r=e.EncryptionVersionInfo=cl(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function x4(t){var e=0,r,n=qL(t),s=n.length+1,a,i,o,l,u;for(r=wc(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^i;return e^52811}var tI=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=e[i.length-1],l=104,u=i.length-1;u>=0;--u)for(var d=i[u],g=0;g!=7;++g)d&64&&(o^=r[l]),d*=2,--l;return o};return function(i){for(var o=qL(i),l=a(o),u=o.length,d=wc(16),g=0;g!=16;++g)d[g]=0;var h,p,x;for((u&1)===1&&(h=l>>8,d[u]=s(t[0],h),--u,h=l&255,p=o[o.length-1],d[u]=s(p,h));u>0;)--u,h=l>>8,d[u]=s(o[u],h),--u,h=l&255,d[u]=s(o[u],h);for(u=15,x=15-o.length;x>0;)h=l>>8,d[u]=s(t[x],h),--u,--x,h=l&255,d[u]=s(o[u],h),--u,--x;return d}}(),koe=function(t,e,r,n,s){s||(s=e),n||(n=tI(t));var a,i;for(a=0;a!=e.length;++a)i=e[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},Coe=function(t){var e=0,r=tI(t);return function(n){var s=koe("",n,e,r);return e=s[1],s[0]}};function Toe(t,e,r,n){var s={key:Un(t),verificationBytes:Un(t)};return r.password&&(s.verifier=x4(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=Coe(r.password)),s}function Eoe(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=Soe(t):n.Data=boe(t,e),n}function Noe(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Eoe(t,e-2,n):Toe(t,r.biff>=8?e:e-2,r,n),n}var rI=function(){function t(s,a){switch(a.type){case"base64":return e($a(s),a);case"binary":return e(s,a);case"buffer":return e(lr&&Buffer.isBuffer(s)?s.toString("binary"):Uc(s),a);case"array":return e(Ju(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,g){Array.isArray(o)&&(o[g]=[]);for(var h=/\\\w+\b/g,p=0,x,v=-1;x=h.exec(d);){switch(x[0]){case"\\cell":var w=d.slice(p,h.lastIndex-x[0].length);if(w[0]==" "&&(w=w.slice(1)),++v,w.length){var S={v:w,t:"s"};Array.isArray(o)?o[g][v]=S:o[Kt({r:g,c:v})]=S}break}p=h.lastIndex}v>u.e.c&&(u.e.c=v)}),o["!ref"]=sr(u),o}function r(s,a){return $c(t(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=_r(s["!ref"]),o,l=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var g=Kt({r:u,c:d});o=l?(s[u]||[])[d]:s[g],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(yl(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Aoe(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Hg(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function joe(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),a=Math.min(e,r,n),i=s-a;if(i===0)return[0,0,e];var o=0,l=0,u=s+a;switch(l=i/(u>1?2-u:u),s){case e:o=((r-n)/i+6)%6;break;case r:o=(n-e)/i+2;break;case n:o=(e-r)/i+4;break}return[o/6,l,u/2]}function Foe(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function ny(t,e){if(e===0)return t;var r=joe(Aoe(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Hg(Foe(r))}var nI=6,Poe=15,Doe=1,Us=nI;function Gg(t){return Math.floor((t+Math.round(128/Us)/256)*Us)}function Vg(t){return Math.floor((t-5)/Us*100+.5)/100}function sy(t){return Math.round((t*Us+5)/Us*256)/256}function k2(t){return sy(Vg(Gg(t)))}function y4(t){var e=Math.abs(t-k2(t)),r=Us;if(e>.005)for(Us=Doe;Us<Poe;++Us)Math.abs(t-k2(t))<=e&&(e=Math.abs(t-k2(t)),r=Us);Us=r}function _c(t){t.width?(t.wpx=Gg(t.width),t.wch=Vg(t.wpx),t.MDW=Us):t.wpx?(t.wch=Vg(t.wpx),t.width=sy(t.wch),t.MDW=Us):typeof t.wch=="number"&&(t.width=sy(t.wch),t.wpx=Gg(t.width),t.MDW=Us),t.customWidth&&delete t.customWidth}var Roe=96,sI=Roe;function Kg(t){return t*96/sI}function rh(t){return t*sI/96}var Moe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Loe(t,e,r,n){e.Borders=[];var s={},a=!1;(t[0].match(Qs)||[]).forEach(function(i){var o=Yt(i);switch(Po(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Kr(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Kr(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function Ioe(t,e,r,n){e.Fills=[];var s={},a=!1;(t[0].match(Qs)||[]).forEach(function(i){var o=Yt(i);switch(Po(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function Ooe(t,e,r,n){e.Fonts=[];var s={},a=!1;(t[0].match(Qs)||[]).forEach(function(i){var o=Yt(i);switch(Po(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Or(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Kr(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Kr(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Kr(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Kr(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Kr(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Kr(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Kr(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=VT[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Kr(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Tu[s.color.index];s.color.index==81&&(l=Tu[1]),l||(l=Tu[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=ny(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function Boe(t,e,r){e.NumberFmt=[];for(var n=Tn(Gt),s=0;s<n.length;++s)e.NumberFmt[n[s]]=Gt[n[s]];var a=t[0].match(Qs);if(a)for(s=0;s<a.length;++s){var i=Yt(a[s]);switch(Po(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=wr(Or(i.formatCode)),l=parseInt(i.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}ll(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function Uoe(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=xt("numFmt",null,{numFmtId:n,formatCode:Mr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=xt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var xx=["numFmtId","fillId","fontId","borderId","xfId"],yx=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function $oe(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(Qs)||[]).forEach(function(a){var i=Yt(a),o=0;switch(Po(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<xx.length;++o)n[xx[o]]&&(n[xx[o]]=parseInt(n[xx[o]],10));for(o=0;o<yx.length;++o)n[yx[o]]&&(n[yx[o]]=Kr(n[yx[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Kr(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function Woe(t){var e=[];return e[e.length]=xt("cellXfs",null),t.forEach(function(r){e[e.length]=xt("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=xt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var zoe=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=o.match(e))&&Boe(g,d,u),(g=o.match(s))&&Ooe(g,d,l,u),(g=o.match(n))&&Ioe(g,d,l,u),(g=o.match(a))&&Loe(g,d,l,u),(g=o.match(r))&&$oe(g,d,u),d}}();function aI(t,e){var r=[Mn,xt("styleSheet",null,{xmlns:md[0],"xmlns:vt":qn.vt})],n;return t.SSF&&(n=Uoe(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Woe(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Hoe(t,e){var r=t.read_shift(2),n=Gs(t);return[r,n]}function Goe(t,e,r){r||(r=qe(6+4*e.length)),r.write_shift(2,t),gs(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Voe(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=Ese(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=t.read_shift(1);i!=0&&(n.underline=i);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=Tse(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Gs(t),n}function Koe(t,e){e||(e=qe(25+4*32)),e.write_shift(2,t.sz*20),Nse(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),ey(t.color,e);var n=0;return n=2,e.write_shift(1,n),gs(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Xoe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],C2,Yoe=Xs;function rj(t,e){e||(e=qe(4*3+8*7+16*1)),C2||(C2=Uv(Xoe));var r=C2[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(ey({auto:1},e),ey({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Joe(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function iI(t,e,r){r||(r=qe(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function m0(t,e){return e||(e=qe(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Qoe=Xs;function qoe(t,e){return e||(e=qe(51)),e.write_shift(1,0),m0(null,e),m0(null,e),m0(null,e),m0(null,e),m0(null,e),e.length>e.l?e.slice(0,e.l):e}function Zoe(t,e){return e||(e=qe(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Z1(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function ele(t,e,r){var n=qe(2052);return n.write_shift(4,t),Z1(e,n),Z1(r,n),n.length>n.l?n.slice(0,n.l):n}function tle(t,e,r){var n={};n.NumberFmt=[];for(var s in Gt)n.NumberFmt[s]=Gt[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return El(t,function(l,u,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],ll(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=ny(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function rle(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(ot(t,615,Vi(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&ot(t,44,Goe(s,e[s]))}),ot(t,616))}}function nle(t){var e=1;ot(t,611,Vi(e)),ot(t,43,Koe({sz:12,color:{theme:1},name:"Calibri",family:2})),ot(t,612)}function sle(t){var e=2;ot(t,603,Vi(e)),ot(t,45,rj({patternType:"none"})),ot(t,45,rj({patternType:"gray125"})),ot(t,604)}function ale(t){var e=1;ot(t,613,Vi(e)),ot(t,46,qoe()),ot(t,614)}function ile(t){var e=1;ot(t,626,Vi(e)),ot(t,47,iI({numFmtId:0},65535)),ot(t,627)}function ole(t,e){ot(t,617,Vi(e.length)),e.forEach(function(r){ot(t,47,iI(r,0))}),ot(t,618)}function lle(t){var e=1;ot(t,619,Vi(e)),ot(t,48,Zoe({xfId:0,name:"Normal"})),ot(t,620)}function cle(t){var e=0;ot(t,505,Vi(e)),ot(t,506)}function ule(t){var e=0;ot(t,508,ele(e,"TableStyleMedium9","PivotStyleMedium4")),ot(t,509)}function dle(t,e){var r=Ea();return ot(r,278),rle(r,t.SSF),nle(r),sle(r),ale(r),ile(r),ole(r,e.cellXfs),lle(r),cle(r),ule(r),ot(r,279),r.end()}var fle=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function hle(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Qs)||[]).forEach(function(s){var a=Yt(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[fle.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function gle(){}function mle(){}var ple=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,xle=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,yle=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function vle(t,e,r){e.themeElements={};var n;[["clrScheme",ple,hle],["fontScheme",xle,gle],["fmtScheme",yle,mle]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var wle=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function oI(t,e){(!t||t.length===0)&&(t=v4());var r,n={};if(!(r=t.match(wle)))throw new Error("themeElements not found in theme");return vle(r[0],n,e),n.raw=t,n}function v4(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Mn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function _le(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var i;try{i=ZM(a,{type:"array"})}catch{return}var o=La(i,"theme/theme/theme1.xml",!0);if(o)return oI(o,r)}}function ble(t){return t.read_shift(4)}function Sle(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=kle(t,4);break;case 2:e.xclrValue=UL(t);break;case 3:e.xclrValue=ble(t);break;case 4:t.l+=4;break}return t.l+=8,e}function kle(t,e){return Xs(t,e)}function Cle(t,e){return Xs(t,e)}function Tle(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Sle(t);break;case 6:n[1]=Cle(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function Ele(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),a=[];s-- >0;)a.push(Tle(t,r-t.l));return{ixfe:n,ext:a}}function Nle(t,e){e.forEach(function(r){switch(r[0]){}})}function Ale(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Gs(t)}}function jle(t){var e=qe(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),gs(t.name,e),e.slice(0,e.l)}function Fle(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function Ple(t){var e=qe(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function Dle(t,e){var r=qe(8+2*e.length);return r.write_shift(4,t),gs(e,r),r.slice(0,r.l)}function Rle(t){return t.l+=4,t.read_shift(4)!=0}function Mle(t,e){var r=qe(8);return r.write_shift(4,t),r.write_shift(4,1),r}function Lle(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return El(t,function(l,u,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(g){o==1?n.Cell.push({type:n.Types[g[0]-1].name,index:g[1]}):o==0&&n.Value.push({type:n.Types[g[0]-1].name,index:g[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function Ile(){var t=Ea();return ot(t,332),ot(t,334,Vi(1)),ot(t,335,jle({name:"XLDAPR",version:12e4,flags:3496657072})),ot(t,336),ot(t,339,Dle(1,"XLDAPR")),ot(t,52),ot(t,35,Vi(514)),ot(t,4096,Vi(0)),ot(t,4097,li(1)),ot(t,36),ot(t,53),ot(t,340),ot(t,337,Mle(1)),ot(t,51,Ple([[1,0]])),ot(t,338),ot(t,333),t.end()}function Ole(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,a=2,i;return t.replace(Qs,function(o){var l=Yt(o);switch(Po(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function lI(){var t=[Mn];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function Ble(t){var e=[];if(!t)return e;var r=1;return(t.match(Qs)||[]).forEach(function(n){var s=Yt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function Ule(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Kt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function $le(t,e,r){var n=[];return El(t,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function Wle(t,e,r,n){if(!t)return t;var s=n||{},a=!1;El(t,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function zle(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var pf=1024;function cI(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[xt("xml",null,{"xmlns:v":Da.v,"xmlns:o":Da.o,"xmlns:x":Da.x,"xmlns:mv":Da.mv}).replace(/\/>/,">"),xt("o:shapelayout",xt("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),xt("v:shapetype",[xt("v:stroke",null,{joinstyle:"miter"}),xt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];pf<t*1e3;)pf+=1e3;return e.forEach(function(a){var i=hn(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?xt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=xt("v:fill",l,o),d={on:"t",obscured:"t"};++pf,s=s.concat(["<v:shape"+$g({id:"_x0000_s"+pf,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,xt("v:shadow",null,d),xt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ks("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),ks("x:AutoFill","False"),ks("x:Row",String(i.r)),ks("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function nj(t,e,r,n){var s=Array.isArray(t),a;e.forEach(function(i){var o=hn(i.ref);if(s?(t[o.r]||(t[o.r]=[]),a=t[o.r][o.c]):a=t[i.ref],!a){a={t:"z"},s?t[o.r][o.c]=a:t[i.ref]=a;var l=_r(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=sr(l);u!==t["!ref"]&&(t["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var g=a.c.length-1;g>=0;--g){if(!r&&a.c[g].T)return;r&&!a.c[g].T&&a.c.splice(g,1)}if(r&&n){for(g=0;g<n.length;++g)if(d.a==n[g].id){d.a=n[g].name||d.a;break}}a.c.push(d)})}function Hle(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Yt(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=hn(l.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var g=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!g&&!!g[1]&&p4(g[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function uI(t){var e=[Mn,xt("comments",null,{xmlns:md[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var a=Mr(s.a);r.indexOf(a)==-1&&(r.push(a),e.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(s=r.indexOf(Mr(l.a))),a.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)e.push(ks("t",Mr(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;e.push(ks("t",Mr(i)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Gle(t,e){var r=[],n=!1,s={},a=0;return t.replace(Qs,function(o,l){var u=Yt(o);switch(Po(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=t.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function Vle(t,e,r){var n=[Mn,xt("ThreadedComments",null,{xmlns:qn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&e.indexOf(i.a)==-1&&e.push(i.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=l.id:l.parentId=a,i.ID=l.id,i.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(i.a)).slice(-12)+"}"),n.push(xt("threadedComment",ks("text",i.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function Kle(t,e){var r=[],n=!1;return t.replace(Qs,function(a){var i=Yt(a);switch(Po(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function Xle(t){var e=[Mn,xt("personList",null,{xmlns:qn.TCMNT,"xmlns:x":md[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(xt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function Yle(t){var e={};e.iauthor=t.read_shift(4);var r=vd(t);return e.rfx=r.s,e.ref=Kt(r.s),t.l+=16,e}function Jle(t,e){return e==null&&(e=qe(36)),e.write_shift(4,t[1].iauthor),Ph(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Qle=Gs;function qle(t){return gs(t.slice(0,54))}function Zle(t,e){var r=[],n=[],s={},a=!1;return El(t,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function ece(t){var e=Ea(),r=[];return ot(e,628),ot(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ot(e,632,qle(s.a)))})}),ot(e,631),ot(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:hn(n[0]),e:hn(n[0])};ot(e,635,Jle([a,s])),s.t&&s.t.length>0&&ot(e,637,bse(s)),ot(e,636),delete s.iauthor})}),ot(e,634),ot(e,629),e.end()}var tce="application/vnd.ms-office.vbaProject";function rce(t){var e=Wt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Wt.utils.cfb_add(e,s,t.FileIndex[n].content)}}),Wt.write(e)}function nce(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Wt.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var dI=["xlsb","xlsm","xlam","biff8","xla"];function sce(){return{"!type":"dialog"}}function ace(){return{"!type":"dialog"}}function ice(){return{"!type":"macro"}}function oce(){return{"!type":"macro"}}var Pf=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=e.c:--d,l?u+=e.r:--u,s+(o?"":"$")+fn(d)+(l?"":"$")+Dn(u)}return function(s,a){return e=a,s.replace(t,r)}}(),w4=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,_4=function(){return function(e,r){return e.replace(w4,function(n,s,a,i,o,l){var u=o4(i)-(a?0:r.c),d=i4(l)-(o?0:r.r),g=d==0?"":o?d+1:"["+d+"]",h=u==0?"":a?u+1:"["+u+"]";return s+"R"+g+"C"+h})}}();function fI(t,e){return t.replace(w4,function(r,n,s,a,i,o){return n+(s=="$"?s+a:fn(o4(a)+e.c))+(i=="$"?i+o:Dn(i4(o)+e.r))})}function lce(t,e,r){var n=Na(e),s=n.s,a=hn(r),i={r:a.r-s.r,c:a.c-s.c};return fI(t,i)}function cce(t){return t.length!=1}function sj(t){return t.replace(/_xlfn\./g,"")}function On(t){t.l+=1}function bc(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function hI(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return gI(t);r.biff==12&&(n=4)}var s=t.read_shift(n),a=t.read_shift(n),i=bc(t),o=bc(t);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function gI(t){var e=bc(t),r=bc(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function uce(t,e,r){if(r.biff<8)return gI(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),a=bc(t),i=bc(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function mI(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return dce(t);var n=t.read_shift(r&&r.biff==12?4:2),s=bc(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function dce(t){var e=bc(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function fce(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function hce(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return gce(t);var s=t.read_shift(n>=12?4:2),a=t.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function gce(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function mce(t,e,r){var n=(t[t.l++]&96)>>5,s=hI(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function pce(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var i=hI(t,a,r);return[n,s,i]}function xce(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function yce(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,s]}function vce(t,e,r){var n=(t[t.l++]&96)>>5,s=uce(t,e-1,r);return[n,s]}function wce(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function aj(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function _ce(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function bce(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Sce(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function kce(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Cce(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function pI(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function Tce(t){return t.read_shift(2),pI(t)}function Ece(t){return t.read_shift(2),pI(t)}function Nce(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=mI(t,0,r);return[n,s]}function Ace(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=hce(t,0,r);return[n,s]}function jce(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=mI(t,0,r);return[n,s,a]}function Fce(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[Rue[s],vI[s],n]}function Pce(t,e,r){var n=t[t.l++],s=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:Dce(t);return[s,(a[0]===0?vI:Due)[a[1]]]}function Dce(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Rce(t,e,r){t.l+=r&&r.biff==2?3:4}function Mce(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function Lce(t){return t.l++,Nl[t.read_shift(1)]}function Ice(t){return t.l++,t.read_shift(2)}function Oce(t){return t.l++,t.read_shift(1)!==0}function Bce(t){return t.l++,$s(t)}function Uce(t,e,r){return t.l++,Fm(t,e-1,r)}function $ce(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=An(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Nl[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=$s(t);break;case 2:r[1]=wd(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Wce(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?vd:zv)(t));return s}function zce(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=$ce(t,r.biff);return i}function Hce(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function Gce(t,e,r){if(r.biff==5)return Vce(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),a=t.read_shift(4);return[n,s,a]}function Vce(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function Kce(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function Xce(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function Yce(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function Jce(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,s]}var Qce=Xs,qce=Xs,Zce=Xs;function Dm(t,e,r){return t.l+=2,[fce(t)]}function b4(t){return t.l+=6,[]}var eue=Dm,tue=b4,rue=b4,nue=Dm;function xI(t){return t.l+=2,[Un(t),t.read_shift(2)&1]}var sue=Dm,aue=xI,iue=b4,oue=Dm,lue=Dm,cue=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function uue(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),a=t.read_shift(2),i=cue[r>>2&31];return{ixti:e,coltype:r&3,rt:i,idx:n,c:s,C:a}}function due(t){return t.l+=2,[t.read_shift(4)]}function fue(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function hue(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function gue(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function mue(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function pue(t){return t.l+=4,[0,0]}var ij={1:{n:"PtgExp",f:Mce},2:{n:"PtgTbl",f:Zce},3:{n:"PtgAdd",f:On},4:{n:"PtgSub",f:On},5:{n:"PtgMul",f:On},6:{n:"PtgDiv",f:On},7:{n:"PtgPower",f:On},8:{n:"PtgConcat",f:On},9:{n:"PtgLt",f:On},10:{n:"PtgLe",f:On},11:{n:"PtgEq",f:On},12:{n:"PtgGe",f:On},13:{n:"PtgGt",f:On},14:{n:"PtgNe",f:On},15:{n:"PtgIsect",f:On},16:{n:"PtgUnion",f:On},17:{n:"PtgRange",f:On},18:{n:"PtgUplus",f:On},19:{n:"PtgUminus",f:On},20:{n:"PtgPercent",f:On},21:{n:"PtgParen",f:On},22:{n:"PtgMissArg",f:On},23:{n:"PtgStr",f:Uce},26:{n:"PtgSheet",f:fue},27:{n:"PtgEndSheet",f:hue},28:{n:"PtgErr",f:Lce},29:{n:"PtgBool",f:Oce},30:{n:"PtgInt",f:Ice},31:{n:"PtgNum",f:Bce},32:{n:"PtgArray",f:wce},33:{n:"PtgFunc",f:Fce},34:{n:"PtgFuncVar",f:Pce},35:{n:"PtgName",f:Hce},36:{n:"PtgRef",f:Nce},37:{n:"PtgArea",f:mce},38:{n:"PtgMemArea",f:Kce},39:{n:"PtgMemErr",f:Qce},40:{n:"PtgMemNoMem",f:qce},41:{n:"PtgMemFunc",f:Xce},42:{n:"PtgRefErr",f:Yce},43:{n:"PtgAreaErr",f:xce},44:{n:"PtgRefN",f:Ace},45:{n:"PtgAreaN",f:vce},46:{n:"PtgMemAreaN",f:gue},47:{n:"PtgMemNoMemN",f:mue},57:{n:"PtgNameX",f:Gce},58:{n:"PtgRef3d",f:jce},59:{n:"PtgArea3d",f:pce},60:{n:"PtgRefErr3d",f:Jce},61:{n:"PtgAreaErr3d",f:yce},255:{}},xue={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},yue={1:{n:"PtgElfLel",f:xI},2:{n:"PtgElfRw",f:oue},3:{n:"PtgElfCol",f:eue},6:{n:"PtgElfRwV",f:lue},7:{n:"PtgElfColV",f:nue},10:{n:"PtgElfRadical",f:sue},11:{n:"PtgElfRadicalS",f:iue},13:{n:"PtgElfColS",f:tue},15:{n:"PtgElfColSV",f:rue},16:{n:"PtgElfRadicalLel",f:aue},25:{n:"PtgList",f:uue},29:{n:"PtgSxName",f:due},255:{}},vue={0:{n:"PtgAttrNoop",f:pue},1:{n:"PtgAttrSemi",f:Cce},2:{n:"PtgAttrIf",f:Sce},4:{n:"PtgAttrChoose",f:_ce},8:{n:"PtgAttrGoto",f:bce},16:{n:"PtgAttrSum",f:Rce},32:{n:"PtgAttrBaxcel",f:aj},33:{n:"PtgAttrBaxcel",f:aj},64:{n:"PtgAttrSpace",f:Tce},65:{n:"PtgAttrSpaceSemi",f:Ece},128:{n:"PtgAttrIfError",f:kce},255:{}};function Rm(t,e,r,n){if(n.biff<8)return Xs(t,e);for(var s=t.l+e,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=zce(t,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Wce(t,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=t.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return e=s-t.l,e!==0&&a.push(Xs(t,e)),a}function Mm(t,e,r){for(var n=t.l+e,s,a,i=[];n!=t.l;)e=n-t.l,a=t[t.l],s=ij[a]||ij[xue[a]],(a===24||a===25)&&(s=(a===24?yue:vue)[t[t.l+1]]),!s||!s.f?Xs(t,e):i.push([s.n,s.f(t,e,r)]);return i}function wue(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var _ue={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function bue(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function yI(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function oj(t,e,r){var n=yI(t,e,r);return n=="#REF"?n:bue(n,r)}function Os(t,e,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,u,d,g=0,h=0,p,x="";if(!t[0]||!t[0][0])return"";for(var v=-1,w="",S=0,_=t[0].length;S<_;++S){var y=t[0][S];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),v>=0){switch(t[0][v][1][0]){case 0:w=Sn(" ",t[0][v][1][1]);break;case 1:w=Sn("\r",t[0][v][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}u=u+w,v=-1}o.push(u+_ue[y[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=K0(y[1][1],i,s),o.push(X0(d,a));break;case"PtgRefN":d=r?K0(y[1][1],r,s):y[1][1],o.push(X0(d,a));break;case"PtgRef3d":g=y[1][1],d=K0(y[1][2],i,s),x=oj(n,g,s),o.push(x+"!"+X0(d,a));break;case"PtgFunc":case"PtgFuncVar":var k=y[1][0],N=y[1][1];k||(k=0),k&=127;var E=k==0?[]:o.slice(-k);o.length-=k,N==="User"&&(N=E.shift()),o.push(N+"("+E.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":p=L8(y[1][1],r?{s:r}:i,s),o.push(_2(p,s));break;case"PtgArea":p=L8(y[1][1],i,s),o.push(_2(p,s));break;case"PtgArea3d":g=y[1][1],p=y[1][2],x=oj(n,g,s),o.push(x+"!"+_2(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var A=(n.names||[])[h-1]||(n[0]||[])[h],C=A?A.Name:"SH33TJSNAME"+String(h);C&&C.slice(0,6)=="_xlfn."&&!s.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var F=y[1][1];h=y[1][2];var D;if(s.biff<=5)F<0&&(F=-F),n[F]&&(D=n[F][h]);else{var R="";if(((n[F]||[])[0]||[])[0]==14849||(((n[F]||[])[0]||[])[0]==1025?n[F][h]&&n[F][h].itab>0&&(R=n.SheetNames[n[F][h].itab-1]+"!"):R=n.SheetNames[h-1]+"!"),n[F]&&n[F][h])R+=n[F][h].Name;else if(n[0]&&n[0][h])R+=n[0][h].Name;else{var M=(yI(n,F,s)||"").split(";;");M[h-1]?R=M[h-1]:R+="SH33TJSERRX"}o.push(R);break}D||(D={Name:"SH33TJSERRY"}),o.push(D.Name);break;case"PtgParen":var B="(",J=")";if(v>=0){switch(w="",t[0][v][1][0]){case 2:B=Sn(" ",t[0][v][1][1])+B;break;case 3:B=Sn("\r",t[0][v][1][1])+B;break;case 4:J=Sn(" ",t[0][v][1][1])+J;break;case 5:J=Sn("\r",t[0][v][1][1])+J;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}v=-1}o.push(B+o.pop()+J);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var X={c:r.c,r:r.r};if(n.sharedf[Kt(d)]){var z=n.sharedf[Kt(d)];o.push(Os(z,i,X,n,s))}else{var H=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Os(u[1],i,X,n,s)),H=!0;break}H||o.push(y[1])}break;case"PtgArray":o.push("{"+wue(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var U=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&U.indexOf(t[0][S][0])==-1){y=t[0][v];var L=!0;switch(y[1][0]){case 4:L=!1;case 0:w=Sn(" ",y[1][1]);break;case 5:L=!1;case 1:w=Sn("\r",y[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((L?w:"")+o.pop()+(L?"":w)),v=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function Sue(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],Xs(t,e-2)];var o=Mm(t,i,r);return e!==i+s&&(a=Rm(t,e-i-s,o,r)),t.l=n,[o,a]}function kue(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],Xs(t,e-2)];var o=Mm(t,i,r);return e!==i+s&&(a=Rm(t,e-i-s,o,r)),t.l=n,[o,a]}function Cue(t,e,r,n){var s=t.l+e,a=Mm(t,n,r),i;return s!==t.l&&(i=Rm(t,s-t.l,a,r)),[a,i]}function Tue(t,e,r){var n=t.l+e,s,a=t.read_shift(2),i=Mm(t,a,r);return a==65535?[[],Xs(t,e-2)]:(e!==a+2&&(s=Rm(t,n-a-2,i,r)),[i,s])}function Eue(t){var e;if(nl(t,t.l+6)!==65535)return[$s(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Nue(t){if(t==null){var e=qe(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Qu(t);return Qu(0)}function T2(t,e,r){var n=t.l+e,s=Do(t);r.biff==2&&++t.l;var a=Eue(t),i=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=kue(t,n-t.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function Aue(t,e,r,n,s){var a=Zu(e,r,s),i=Nue(t.v),o=qe(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=qe(t.bf.length),d=0;d<t.bf.length;++d)u[d]=t.bf[d];var g=hs([a,i,o,u]);return g}function Hv(t,e,r){var n=t.read_shift(4),s=Mm(t,n,r),a=t.read_shift(4),i=a>0?Rm(t,a,s,r):null;return[s,i]}var jue=Hv,Gv=Hv,Fue=Hv,Pue=Hv,Due={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},vI={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Rue={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function lj(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Mue(t){var e="of:="+t.replace(w4,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function E2(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function Lue(t){return t.replace(/\./,"!")}var J0={},Df={},Q0=typeof Map<"u";function S4(t,e,r){var n=0,s=t.length;if(r){if(Q0?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var a=Q0?r.get(e):r[e];n<a.length;++n)if(t[a[n]].t===e)return t.Count++,a[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(Q0?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function Vv(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Us=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Vg(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=sy(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Au(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Wc(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,a=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){ll(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=a;++s)if(t[s].numFmtId===n)return s;return t[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function wI(t,e,r,n,s,a){try{n.cellNF&&(t.z=Gt[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=qr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Gt[e]==null&&ll(Dne[e]||"General",e),t.t==="e")t.w=t.w||Nl[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Bg(t.v);else if(t.t==="d"){var i=ts(t.v);(i|0)===i?t.w=i.toString(10):t.w=Bg(i)}else{if(t.v===void 0)return"";t.w=Yu(t.v,Df)}else t.t==="d"?t.w=bi(e,ts(t.v),Df):t.w=bi(e,t.v,Df)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=ny(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=ny(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function Iue(t,e,r){if(t&&t["!ref"]){var n=_r(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function Oue(t,e){var r=_r(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=sr(r))}var Bue=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Uue=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,$ue=/<(?:\w:)?hyperlink [^>]*>/mg,Wue=/"(\w*:\w*)"/,zue=/<(?:\w:)?col\b[^>]*[\/]?>/g,Hue=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Gue=/<(?:\w:)?pageMargins[^>]*\/>/g,_I=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Vue=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Kue=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Xue(t,e,r,n,s,a,i){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",g=t.match(Uue);g?(u=t.slice(0,g.index),d=t.slice(g.index+g[0].length)):u=d=t;var h=u.match(_I);h?k4(h[0],o,s,r):(h=u.match(Vue))&&Jue(h[0],h[1]||"",o,s,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=u.slice(p,p+50).match(Wue);x&&Oue(o,x[1])}var v=u.match(Kue);v&&v[1]&&cde(v[1],s);var w=[];if(e.cellStyles){var S=u.match(zue);S&&sde(w,S)}g&&fde(g[1],o,e,l,a,i);var _=d.match(Hue);_&&(o["!autofilter"]=ide(_[0]));var y=[],k=d.match(Bue);if(k)for(p=0;p!=k.length;++p)y[p]=_r(k[p].slice(k[p].indexOf('"')+1));var N=d.match($ue);N&&tde(o,N,n);var E=d.match(Gue);if(E&&(o["!margins"]=rde(Yt(E[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=sr(l)),e.sheetRows>0&&o["!ref"]){var A=_r(o["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>l.e.r&&(A.e.r=l.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>l.e.c&&(A.e.c=l.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),o["!fullref"]=o["!ref"],o["!ref"]=sr(A))}return w.length>0&&(o["!cols"]=w),y.length>0&&(o["!merges"]=y),o}function Yue(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+sr(t[r])+'"/>';return e+"</mergeCells>"}function k4(t,e,r,n){var s=Yt(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=wr(Or(s.codeName)))}function Jue(t,e,r,n,s){k4(t.slice(0,t.indexOf(">")),r,n,s)}function Que(t,e,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}a=!0,i.codeName=wo(Mr(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+xt("outlinePr",null,u)}!a&&!o||(s[s.length]=xt("sheetPr",o,i))}var que=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Zue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ede(t){var e={sheet:1};return que.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),Zue.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=x4(t.password).toString(16).toUpperCase()),xt("sheetProtection",null,e)}function tde(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var a=Yt(Or(e[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+wr(a.location))):(a.Target="#"+wr(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=_r(a.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var d=Kt({c:u,r:l});n?(t[l]||(t[l]=[]),t[l][u]||(t[l][u]={t:"z",v:void 0}),t[l][u].l=a):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=a)}}}function rde(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function nde(t){return Au(t),xt("pageMargins",null,t)}function sde(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=Yt(e[n],!0);s.hidden&&(s.hidden=Kr(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,y4(s.width)),_c(s);a<=i;)t[a++]=Zr(s)}}function ade(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=xt("col",null,Vv(s,n)));return r[r.length]="</cols>",r.join("")}function ide(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function ode(t,e,r,n){var s=typeof t.ref=="string"?t.ref:sr(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Na(s);i.s.r==i.e.r&&(i.e.r=Na(e["!ref"]).e.r,s=sr(i));for(var o=0;o<a.length;++o){var l=a[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),xt("autoFilter",null,{ref:s})}var lde=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function cde(t,e){e.Views||(e.Views=[{}]),(t.match(lde)||[]).forEach(function(r,n){var s=Yt(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Kr(s.rightToLeft)&&(e.Views[n].RTL=!0)})}function ude(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),xt("sheetViews",xt("sheetView",null,s),{})}function dde(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",a=t.t,i=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=Nl[t.v];break;case"d":n&&n.cellDates?s=qr(t.v,-1).toISOString():(t=Zr(t),t.t="n",s=""+(t.v=ts(qr(t.v)))),typeof t.z>"u"&&(t.z=Gt[14]);break;default:s=t.v;break}var o=ks("v",Mr(s)),l={r:e},u=Wc(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=ks("v",""+S4(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=a&&(t.t=a,t.v=i),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=xt("f",Mr(t.f),d)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),xt("c",o,l)}var fde=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Ug("v"),i=Ug("f");return function(l,u,d,g,h,p){for(var x=0,v="",w=[],S=[],_=0,y=0,k=0,N="",E,A,C=0,F=0,D,R,M=0,B=0,J=Array.isArray(p.CellXf),X,z=[],H=[],U=Array.isArray(u),L=[],ne={},de=!1,G=!!d.sheetStubs,K=l.split(e),Q=0,q=K.length;Q!=q;++Q){v=K[Q].trim();var se=v.length;if(se!==0){var W=0;e:for(x=0;x<se;++x)switch(v[x]){case">":if(v[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(A=Yt(v.slice(W,x),!0),C=A.r!=null?parseInt(A.r,10):C+1,F=-1,d.sheetRows&&d.sheetRows<C)continue;ne={},de=!1,A.ht&&(de=!0,ne.hpt=parseFloat(A.ht),ne.hpx=rh(ne.hpt)),A.hidden=="1"&&(de=!0,ne.hidden=!0),A.outlineLevel!=null&&(de=!0,ne.level=+A.outlineLevel),de&&(L[C-1]=ne)}break;case"<":W=x;break}if(W>=x)break;if(A=Yt(v.slice(W,x),!0),C=A.r!=null?parseInt(A.r,10):C+1,F=-1,!(d.sheetRows&&d.sheetRows<C)){g.s.r>C-1&&(g.s.r=C-1),g.e.r<C-1&&(g.e.r=C-1),d&&d.cellStyles&&(ne={},de=!1,A.ht&&(de=!0,ne.hpt=parseFloat(A.ht),ne.hpx=rh(ne.hpt)),A.hidden=="1"&&(de=!0,ne.hidden=!0),A.outlineLevel!=null&&(de=!0,ne.level=+A.outlineLevel),de&&(L[C-1]=ne)),w=v.slice(x).split(t);for(var ee=0;ee!=w.length&&w[ee].trim().charAt(0)=="<";++ee);for(w=w.slice(ee),x=0;x!=w.length;++x)if(v=w[x].trim(),v.length!==0){if(S=v.match(r),_=x,y=0,k=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,S!=null&&S.length===2){for(_=0,N=S[1],y=0;y!=N.length&&!((k=N.charCodeAt(y)-64)<1||k>26);++y)_=26*_+k;--_,F=_}else++F;for(y=0;y!=v.length&&v.charCodeAt(y)!==62;++y);if(++y,A=Yt(v.slice(0,y),!0),A.r||(A.r=Kt({r:C-1,c:F})),N=v.slice(y),E={t:""},(S=N.match(a))!=null&&S[1]!==""&&(E.v=wr(S[1])),d.cellFormula){if((S=N.match(i))!=null&&S[1]!==""){if(E.f=wr(Or(S[1])).replace(/\r\n/g,`
`),d.xlfn||(E.f=sj(E.f)),S[0].indexOf('t="array"')>-1)E.F=(N.match(s)||[])[1],E.F.indexOf(":")>-1&&z.push([_r(E.F),E.F]);else if(S[0].indexOf('t="shared"')>-1){R=Yt(S[0]);var ve=wr(Or(S[1]));d.xlfn||(ve=sj(ve)),H[parseInt(R.si,10)]=[R,ve,A.r]}}else(S=N.match(/<f[^>]*\/>/))&&(R=Yt(S[0]),H[R.si]&&(E.f=lce(H[R.si][1],H[R.si][2],A.r)));var _e=hn(A.r);for(y=0;y<z.length;++y)_e.r>=z[y][0].s.r&&_e.r<=z[y][0].e.r&&_e.c>=z[y][0].s.c&&_e.c<=z[y][0].e.c&&(E.F=z[y][1])}if(A.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(G)E.t="z";else continue;else E.t=A.t||"n";switch(g.s.c>F&&(g.s.c=F),g.e.c<F&&(g.e.c=F),E.t){case"n":if(E.v==""||E.v==null){if(!G)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!G)continue;E.t="z"}else D=J0[parseInt(E.v,10)],E.v=D.t,E.r=D.r,d.cellHTML&&(E.h=D.h);break;case"str":E.t="s",E.v=E.v!=null?Or(E.v):"",d.cellHTML&&(E.h=r4(E.v));break;case"inlineStr":S=N.match(n),E.t="s",S!=null&&(D=p4(S[1]))?(E.v=D.t,d.cellHTML&&(E.h=D.h)):E.v="";break;case"b":E.v=Kr(E.v);break;case"d":d.cellDates?E.v=qr(E.v,1):(E.v=ts(qr(E.v,1)),E.t="n");break;case"e":(!d||d.cellText!==!1)&&(E.w=E.v),E.v=SL[E.v];break}if(M=B=0,X=null,J&&A.s!==void 0&&(X=p.CellXf[A.s],X!=null&&(X.numFmtId!=null&&(M=X.numFmtId),d.cellStyles&&X.fillId!=null&&(B=X.fillId))),wI(E,M,B,d,h,p),d.cellDates&&J&&E.t=="n"&&Ah(Gt[M])&&(E.t="d",E.v=Wv(E.v)),A.cm&&d.xlmeta){var Le=(d.xlmeta.Cell||[])[+A.cm-1];Le&&Le.type=="XLDAPR"&&(E.D=!0)}if(U){var te=hn(A.r);u[te.r]||(u[te.r]=[]),u[te.r][te.c]=E}else u[A.r]=E}}}}L.length>0&&(u["!rows"]=L)}}();function hde(t,e,r,n){var s=[],a=[],i=_r(t["!ref"]),o="",l,u="",d=[],g=0,h=0,p=t["!rows"],x=Array.isArray(t),v={r:u},w,S=-1;for(h=i.s.c;h<=i.e.c;++h)d[h]=fn(h);for(g=i.s.r;g<=i.e.r;++g){for(a=[],u=Dn(g),h=i.s.c;h<=i.e.c;++h){l=d[h]+u;var _=x?(t[g]||[])[h]:t[l];_!==void 0&&(o=dde(_,l,t,e))!=null&&a.push(o)}(a.length>0||p&&p[g])&&(v={r:u},p&&p[g]&&(w=p[g],w.hidden&&(v.hidden=1),S=-1,w.hpx?S=Kg(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(v.ht=S,v.customHeight=1),w.level&&(v.outlineLevel=w.level)),s[s.length]=xt("row",a.join(""),v))}if(p)for(;g<p.length;++g)p&&p[g]&&(v={r:g+1},w=p[g],w.hidden&&(v.hidden=1),S=-1,w.hpx?S=Kg(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(v.ht=S,v.customHeight=1),w.level&&(v.outlineLevel=w.level),s[s.length]=xt("row","",v));return s.join("")}function bI(t,e,r,n){var s=[Mn,xt("worksheet",null,{xmlns:md[0],"xmlns:r":qn.r})],a=r.SheetNames[t],i=0,o="",l=r.Sheets[a];l==null&&(l={});var u=l["!ref"]||"A1",d=_r(u);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=sr(d)}n||(n={}),l["!comments"]=[];var g=[];Que(l,r,t,e,s),s[s.length]=xt("dimension",null,{ref:u}),s[s.length]=ude(l,e,t,r),e.sheetFormat&&(s[s.length]=xt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(s[s.length]=ade(l,l["!cols"])),s[i=s.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=hde(l,e),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),l["!protect"]&&(s[s.length]=ede(l["!protect"])),l["!autofilter"]!=null&&(s[s.length]=ode(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(s[s.length]=Yue(l["!merges"]));var h=-1,p,x=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(v){v[1].Target&&(p={ref:v[0]},v[1].Target.charAt(0)!="#"&&(x=Rr(n,-1,Mr(v[1].Target).replace(/#.*$/,""),ur.HLINK),p["r:id"]="rId"+x),(h=v[1].Target.indexOf("#"))>-1&&(p.location=Mr(v[1].Target.slice(h+1))),v[1].Tooltip&&(p.tooltip=Mr(v[1].Tooltip)),s[s.length]=xt("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(s[s.length]=nde(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=ks("ignoredErrors",xt("ignoredError",null,{numberStoredAsText:1,sqref:u}))),g.length>0&&(x=Rr(n,-1,"../drawings/drawing"+(t+1)+".xml",ur.DRAW),s[s.length]=xt("drawing",null,{"r:id":"rId"+x}),l["!drawing"]=g),l["!comments"].length>0&&(x=Rr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ur.VML),s[s.length]=xt("legacyDrawing",null,{"r:id":"rId"+x}),l["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function gde(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function mde(t,e,r){var n=qe(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var a=320;s.hpx?a=Kg(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var g=-1,h=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Kt(u)];x&&(g<0&&(g=p),h=p)}g<0||(++o,n.write_shift(4,g),n.write_shift(4,h))}var v=n.l;return n.l=l,n.write_shift(4,o),n.l=v,n.length>n.l?n.slice(0,n.l):n}function pde(t,e,r,n){var s=mde(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&ot(t,0,s)}var xde=vd,yde=Ph;function vde(){}function wde(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=Sse(t),r}function _de(t,e,r){r==null&&(r=qe(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return ey({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),yL(t,r),r.slice(0,r.l)}function bde(t){var e=Si(t);return[e]}function Sde(t,e,r){return r==null&&(r=qe(8)),pd(e,r)}function kde(t){var e=xd(t);return[e]}function Cde(t,e,r){return r==null&&(r=qe(4)),yd(e,r)}function Tde(t){var e=Si(t),r=t.read_shift(1);return[e,r,"b"]}function Ede(t,e,r){return r==null&&(r=qe(9)),pd(e,r),r.write_shift(1,t.v?1:0),r}function Nde(t){var e=xd(t),r=t.read_shift(1);return[e,r,"b"]}function Ade(t,e,r){return r==null&&(r=qe(5)),yd(e,r),r.write_shift(1,t.v?1:0),r}function jde(t){var e=Si(t),r=t.read_shift(1);return[e,r,"e"]}function Fde(t,e,r){return r==null&&(r=qe(9)),pd(e,r),r.write_shift(1,t.v),r}function Pde(t){var e=xd(t),r=t.read_shift(1);return[e,r,"e"]}function Dde(t,e,r){return r==null&&(r=qe(8)),yd(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function Rde(t){var e=Si(t),r=t.read_shift(4);return[e,r,"s"]}function Mde(t,e,r){return r==null&&(r=qe(12)),pd(e,r),r.write_shift(4,e.v),r}function Lde(t){var e=xd(t),r=t.read_shift(4);return[e,r,"s"]}function Ide(t,e,r){return r==null&&(r=qe(8)),yd(e,r),r.write_shift(4,e.v),r}function Ode(t){var e=Si(t),r=$s(t);return[e,r,"n"]}function Bde(t,e,r){return r==null&&(r=qe(16)),pd(e,r),Qu(t.v,r),r}function SI(t){var e=xd(t),r=$s(t);return[e,r,"n"]}function Ude(t,e,r){return r==null&&(r=qe(12)),yd(e,r),Qu(t.v,r),r}function $de(t){var e=Si(t),r=d4(t);return[e,r,"n"]}function Wde(t,e,r){return r==null&&(r=qe(12)),pd(e,r),vL(t.v,r),r}function zde(t){var e=xd(t),r=d4(t);return[e,r,"n"]}function Hde(t,e,r){return r==null&&(r=qe(8)),yd(e,r),vL(t.v,r),r}function Gde(t){var e=Si(t),r=l4(t);return[e,r,"is"]}function Vde(t){var e=Si(t),r=Gs(t);return[e,r,"str"]}function Kde(t,e,r){return r==null&&(r=qe(12+4*t.v.length)),pd(e,r),gs(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Xde(t){var e=xd(t),r=Gs(t);return[e,r,"str"]}function Yde(t,e,r){return r==null&&(r=qe(8+4*t.v.length)),yd(e,r),gs(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Jde(t,e,r){var n=t.l+e,s=Si(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"b"];if(r.cellFormula){t.l+=2;var o=Gv(t,n-t.l,r);i[3]=Os(o,null,s,r.supbooks,r)}else t.l=n;return i}function Qde(t,e,r){var n=t.l+e,s=Si(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"e"];if(r.cellFormula){t.l+=2;var o=Gv(t,n-t.l,r);i[3]=Os(o,null,s,r.supbooks,r)}else t.l=n;return i}function qde(t,e,r){var n=t.l+e,s=Si(t);s.r=r["!row"];var a=$s(t),i=[s,a,"n"];if(r.cellFormula){t.l+=2;var o=Gv(t,n-t.l,r);i[3]=Os(o,null,s,r.supbooks,r)}else t.l=n;return i}function Zde(t,e,r){var n=t.l+e,s=Si(t);s.r=r["!row"];var a=Gs(t),i=[s,a,"str"];if(r.cellFormula){t.l+=2;var o=Gv(t,n-t.l,r);i[3]=Os(o,null,s,r.supbooks,r)}else t.l=n;return i}var efe=vd,tfe=Ph;function rfe(t,e){return e==null&&(e=qe(4)),e.write_shift(4,t),e}function nfe(t,e){var r=t.l+e,n=vd(t),s=c4(t),a=Gs(t),i=Gs(t),o=Gs(t);t.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function sfe(t,e){var r=qe(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Ph({s:hn(t[0]),e:hn(t[0])},r),u4("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return gs(s||"",r),gs(t[1].Tooltip||"",r),gs("",r),r.slice(0,r.l)}function afe(){}function ife(t,e,r){var n=t.l+e,s=wL(t),a=t.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=jue(t,n-t.l,r);i[1]=o}else t.l=n;return i}function ofe(t,e,r){var n=t.l+e,s=vd(t),a=[s];if(r.cellFormula){var i=Pue(t,n-t.l,r);a[1]=i,t.l=n}else t.l=n;return a}function lfe(t,e,r){r==null&&(r=qe(18));var n=Vv(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var kI=["left","right","top","bottom","header","footer"];function cfe(t){var e={};return kI.forEach(function(r){e[r]=$s(t)}),e}function ufe(t,e){return e==null&&(e=qe(6*8)),Au(t),kI.forEach(function(r){Qu(t[r],e)}),e}function dfe(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function ffe(t,e,r){r==null&&(r=qe(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function hfe(t){var e=qe(24);return e.write_shift(4,4),e.write_shift(4,1),Ph(t,e),e}function gfe(t,e){return e==null&&(e=qe(16*4+2)),e.write_shift(2,t.password?x4(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function mfe(){}function pfe(){}function xfe(t,e,r,n,s,a,i){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,h=!1,p,x,v,w,S,_,y,k,N,E=[];o.biff=12,o["!row"]=0;var A=0,C=!1,F=[],D={},R=o.supbooks||s.supbooks||[[]];if(R.sharedf=D,R.arrayf=F,R.SheetNames=s.SheetNames||s.Sheets.map(function(U){return U.name}),!o.supbooks&&(o.supbooks=R,s.Names))for(var M=0;M<s.Names.length;++M)R[0][M+1]=s.Names[M];var B=[],J=[],X=!1;Xg[16]={n:"BrtShortReal",f:SI};var z;if(El(t,function(L,ne,de){if(!h)switch(de){case 148:u=L;break;case 0:p=L,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),k=Dn(w=p.r),o["!row"]=p.r,(L.hidden||L.hpt||L.level!=null)&&(L.hpt&&(L.hpx=rh(L.hpt)),J[L.r]=L);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:L[2]},L[2]){case"n":x.v=L[1];break;case"s":y=J0[L[1]],x.v=y.t,x.r=y.r;break;case"b":x.v=!!L[1];break;case"e":x.v=L[1],o.cellText!==!1&&(x.w=Nl[x.v]);break;case"str":x.t="s",x.v=L[1];break;case"is":x.t="s",x.v=L[1].t;break}if((v=i.CellXf[L[0].iStyleRef])&&wI(x,v.numFmtId,null,o,a,i),S=L[0].c==-1?S+1:L[0].c,o.dense?(l[w]||(l[w]=[]),l[w][S]=x):l[fn(S)+k]=x,o.cellFormula){for(C=!1,A=0;A<F.length;++A){var G=F[A];p.r>=G[0].s.r&&p.r<=G[0].e.r&&S>=G[0].s.c&&S<=G[0].e.c&&(x.F=sr(G[0]),C=!0)}!C&&L.length>3&&(x.f=L[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>S&&(d.s.c=S),d.e.r<p.r&&(d.e.r=p.r),d.e.c<S&&(d.e.c=S),o.cellDates&&v&&x.t=="n"&&Ah(Gt[v.numFmtId])){var K=pu(x.v);K&&(x.t="d",x.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}z&&(z.type=="XLDAPR"&&(x.D=!0),z=void 0);break;case 1:case 12:if(!o.sheetStubs||g)break;x={t:"z",v:void 0},S=L[0].c==-1?S+1:L[0].c,o.dense?(l[w]||(l[w]=[]),l[w][S]=x):l[fn(S)+k]=x,d.s.r>p.r&&(d.s.r=p.r),d.s.c>S&&(d.s.c=S),d.e.r<p.r&&(d.e.r=p.r),d.e.c<S&&(d.e.c=S),z&&(z.type=="XLDAPR"&&(x.D=!0),z=void 0);break;case 176:E.push(L);break;case 49:z=((o.xlmeta||{}).Cell||[])[L-1];break;case 494:var Q=n["!id"][L.relId];for(Q?(L.Target=Q.Target,L.loc&&(L.Target+="#"+L.loc),L.Rel=Q):L.relId==""&&(L.Target="#"+L.loc),w=L.rfx.s.r;w<=L.rfx.e.r;++w)for(S=L.rfx.s.c;S<=L.rfx.e.c;++S)o.dense?(l[w]||(l[w]=[]),l[w][S]||(l[w][S]={t:"z",v:void 0}),l[w][S].l=L):(_=Kt({c:S,r:w}),l[_]||(l[_]={t:"z",v:void 0}),l[_].l=L);break;case 426:if(!o.cellFormula)break;F.push(L),N=o.dense?l[w][S]:l[fn(S)+k],N.f=Os(L[1],d,{r:p.r,c:S},R,o),N.F=sr(L[0]);break;case 427:if(!o.cellFormula)break;D[Kt(L[0].s)]=L[1],N=o.dense?l[w][S]:l[fn(S)+k],N.f=Os(L[1],d,{r:p.r,c:S},R,o);break;case 60:if(!o.cellStyles)break;for(;L.e>=L.s;)B[L.e--]={width:L.w/256,hidden:!!(L.flags&1),level:L.level},X||(X=!0,y4(L.w/256)),_c(B[L.e+1]);break;case 161:l["!autofilter"]={ref:sr(L)};break;case 476:l["!margins"]=L;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),L.name&&(s.Sheets[r].CodeName=L.name),(L.above||L.left)&&(l["!outline"]={above:L.above,left:L.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),L.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!ne.T){if(!g||o.WTF)throw new Error("Unexpected record 0x"+de.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=sr(u||d)),o.sheetRows&&l["!ref"]){var H=_r(l["!ref"]);o.sheetRows<=+H.e.r&&(H.e.r=o.sheetRows-1,H.e.r>d.e.r&&(H.e.r=d.e.r),H.e.r<H.s.r&&(H.s.r=H.e.r),H.e.c>d.e.c&&(H.e.c=d.e.c),H.e.c<H.s.c&&(H.s.c=H.e.c),l["!fullref"]=l["!ref"],l["!ref"]=sr(H))}return E.length>0&&(l["!merges"]=E),B.length>0&&(l["!cols"]=B),J.length>0&&(l["!rows"]=J),l}function yfe(t,e,r,n,s,a,i){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Zr(e),e.z=e.z||Gt[14],e.v=ts(qr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=Wc(s.cellXfs,e,s),e.l&&a["!links"].push([Kt(l),e.l]),e.c&&a["!comments"].push([Kt(l),e.c]),e.t){case"s":case"str":return s.bookSST?(o=S4(s.Strings,e.v,s.revStrings),l.t="s",l.v=o,i?ot(t,18,Ide(e,l)):ot(t,7,Mde(e,l))):(l.t="str",i?ot(t,17,Yde(e,l)):ot(t,6,Kde(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?i?ot(t,13,Hde(e,l)):ot(t,2,Wde(e,l)):i?ot(t,16,Ude(e,l)):ot(t,5,Bde(e,l)),!0;case"b":return l.t="b",i?ot(t,15,Ade(e,l)):ot(t,4,Ede(e,l)),!0;case"e":return l.t="e",i?ot(t,14,Dde(e,l)):ot(t,3,Fde(e,l)),!0}return i?ot(t,12,Cde(e,l)):ot(t,1,Sde(e,l)),!0}function vfe(t,e,r,n){var s=_r(e["!ref"]||"A1"),a,i="",o=[];ot(t,145);var l=Array.isArray(e),u=s.e.r;e["!rows"]&&(u=Math.max(s.e.r,e["!rows"].length-1));for(var d=s.s.r;d<=u;++d){i=Dn(d),pde(t,e,s,d);var g=!1;if(d<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){d===s.s.r&&(o[h]=fn(h)),a=o[h]+i;var p=l?(e[d]||[])[h]:e[a];if(!p){g=!1;continue}g=yfe(t,p,d,h,n,e,g)}}ot(t,146)}function wfe(t,e){!e||!e["!merges"]||(ot(t,177,rfe(e["!merges"].length)),e["!merges"].forEach(function(r){ot(t,176,tfe(r))}),ot(t,178))}function _fe(t,e){!e||!e["!cols"]||(ot(t,390),e["!cols"].forEach(function(r,n){r&&ot(t,60,lfe(n,r))}),ot(t,391))}function bfe(t,e){!e||!e["!ref"]||(ot(t,648),ot(t,649,hfe(_r(e["!ref"]))),ot(t,650))}function Sfe(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=Rr(r,-1,n[1].Target.replace(/#.*$/,""),ur.HLINK);ot(t,494,sfe(n,s))}}),delete e["!links"]}function kfe(t,e,r,n){if(e["!comments"].length>0){var s=Rr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ur.VML);ot(t,551,u4("rId"+s)),e["!legacy"]=s}}function Cfe(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],a=typeof s.ref=="string"?s.ref:sr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Na(a);o.s.r==o.e.r&&(o.e.r=Na(e["!ref"]).e.r,a=sr(o));for(var l=0;l<i.length;++l){var u=i[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),ot(t,161,Ph(_r(a))),ot(t,162)}}function Tfe(t,e,r){ot(t,133),ot(t,137,ffe(e,r)),ot(t,138),ot(t,134)}function Efe(t,e){e["!protect"]&&ot(t,535,gfe(e["!protect"]))}function Nfe(t,e,r,n){var s=Ea(),a=r.SheetNames[t],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=_r(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],ot(s,129),(r.vbaraw||i["!outline"])&&ot(s,147,_de(o,i["!outline"])),ot(s,148,yde(l)),Tfe(s,i,r.Workbook),_fe(s,i),vfe(s,i,t,e),Efe(s,i),Cfe(s,i,r,t),wfe(s,i),Sfe(s,i,n),i["!margins"]&&ot(s,476,ufe(i["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&bfe(s,i),kfe(s,i,t,n),ot(s,130),s.end()}function Afe(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(e[+i[1]]=r?+i[2]:i[2])});var s=wr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,s,n]}function jfe(t,e,r,n,s,a){var i=a||{"!type":"chart"};if(!t)return a;var o=0,l=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var h=Afe(g);d.s.r=d.s.c=0,d.e.c=o,u=fn(o),h[0].forEach(function(p,x){i[u+Dn(x)]={t:"n",v:p,z:h[1]},l=x}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(i["!ref"]=sr(d)),i}function Ffe(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=t.match(_I);return o&&k4(o[0],a,s,r),(i=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function Pfe(t,e){t.l+=10;var r=Gs(t);return{name:r}}function Dfe(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return El(t,function(l,u,d){switch(d){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var C4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Rfe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Mfe=[],Lfe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function cj(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var a=e[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Kr(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function uj(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Kr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function CI(t){uj(t.WBProps,C4),uj(t.CalcPr,Lfe),cj(t.WBView,Rfe),cj(t.Sheets,Mfe),Df.date1904=Kr(t.WBProps.date1904)}function Ife(t){return!t.Workbook||!t.Workbook.WBProps?"false":Kr(t.Workbook.WBProps.date1904)?"true":"false"}var Ofe="][*?/\\".split("");function TI(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Ofe.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Bfe(t,e,r){t.forEach(function(n,s){TI(n);for(var a=0;a<s;++a)if(n==t[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=e&&e[s]&&e[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function Ufe(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];Bfe(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)Iue(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var $fe=/<\w+:workbook/;function Wfe(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(t.replace(Qs,function(l,u){var d=Yt(l);switch(Po(d[0])){case"<?xml":break;case"<workbook":l.match($fe)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":C4.forEach(function(g){if(d[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=Kr(d[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(d[g[0]],10);break;default:r.WBProps[g[0]]=d[g[0]]}}),d.codeName&&(r.WBProps.CodeName=Or(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=wr(Or(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Or(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Kr(d.hidden||"0")&&(a.Hidden=!0),i=u+l.length;break;case"</definedName>":a.Ref=wr(Or(t.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),md.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return CI(r),r}function EI(t){var e=[Mn];e[e.length]=xt("workbook",null,{xmlns:md[0],"xmlns:r":qn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(C4.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=xt("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",a=0;a!=t.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==t.SheetNames.length&&(a=0),e[e.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",a=0;a!=t.SheetNames.length;++a){var i={name:Mr(t.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}e[e.length]=xt("sheet",null,i)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=xt("definedName",Mr(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function zfe(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=zS(t),r.name=Gs(t),r}function Hfe(t,e){return e||(e=qe(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),u4(t.strRelID,e),gs(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Gfe(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Gs(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Vfe(t,e){e||(e=qe(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),yL(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Kfe(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function Xfe(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),a=kse(t),i=Fue(t,0,r),o=c4(t);t.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function Yfe(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],Xg[16]={n:"BrtFRTArchID$",f:Kfe},El(t,function(l,u,d){switch(d){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Os(l.Ptg,null,null,i,e),delete e.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,l]):i[0]=[d,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),CI(r),r.Names=a,r.supbooks=i,r}function Jfe(t,e){ot(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};ot(t,156,Hfe(s))}ot(t,144)}function Qfe(t,e){e||(e=qe(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return gs("SheetJS",e),gs(K1.version,e),gs(K1.version,e),gs("7262",e),e.length>e.l?e.slice(0,e.l):e}function qfe(t,e){e||(e=qe(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function Zfe(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(ot(t,135),ot(t,158,qfe(s)),ot(t,136))}}function ehe(t,e){var r=Ea();return ot(r,131),ot(r,128,Qfe()),ot(r,153,Vfe(t.Workbook&&t.Workbook.WBProps||null)),Zfe(r,t),Jfe(r,t),ot(r,132),r.end()}function the(t,e,r){return e.slice(-4)===".bin"?Yfe(t,r):Wfe(t,r)}function rhe(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?xfe(t,n,r,s,a,i,o):Xue(t,n,r,s,a,i,o)}function nhe(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?Dfe(t,n,r,s,a):Ffe(t,n,r,s,a)}function she(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?ice():oce()}function ahe(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?sce():ace()}function ihe(t,e,r,n){return e.slice(-4)===".bin"?tle(t,r,n):zoe(t,r,n)}function ohe(t,e,r){return oI(t,r)}function lhe(t,e,r){return e.slice(-4)===".bin"?loe(t,r):aoe(t,r)}function che(t,e,r){return e.slice(-4)===".bin"?Zle(t,r):Hle(t,r)}function uhe(t,e,r){return e.slice(-4)===".bin"?$le(t):Ble(t)}function dhe(t,e,r,n){return r.slice(-4)===".bin"?Wle(t,e,r,n):void 0}function fhe(t,e,r){return e.slice(-4)===".bin"?Lle(t,e,r):Ole(t,e,r)}function hhe(t,e,r){return(e.slice(-4)===".bin"?ehe:EI)(t)}function ghe(t,e,r,n,s){return(e.slice(-4)===".bin"?Nfe:bI)(t,r,n,s)}function mhe(t,e,r){return(e.slice(-4)===".bin"?dle:aI)(t,r)}function phe(t,e,r){return(e.slice(-4)===".bin"?doe:QL)(t,r)}function xhe(t,e,r){return(e.slice(-4)===".bin"?ece:uI)(t)}function yhe(t){return(t.slice(-4)===".bin"?Ile:lI)()}var NI=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,AI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Pi(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(NI),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(AI),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function vhe(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(NI),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(AI),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var q0;function whe(t,e){var r=q0[t]||wr(t);return r==="General"?Yu(e):bi(r,e)}function _he(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Kr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=qr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[wr(e)]=s}function bhe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Nl[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Bg(t.v):t.w=Yu(t.v):t.w=whe(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=q0[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Ah(n)){var s=pu(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function She(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=Moe[n.Pattern]||n.Pattern)}t[e.ID]=e}function khe(t,e,r,n,s,a,i,o,l,u){var d="General",g=n.StyleID,h={};u=u||{};var p=[],x=0;for(g===void 0&&o&&(g=o.StyleID),g===void 0&&i&&(g=i.StyleID);a[g]!==void 0&&(a[g].nf&&(d=a[g].nf),a[g].Interior&&p.push(a[g].Interior),!!a[g].Parent);)g=a[g].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Kr(t);break;case"String":n.t="s",n.r=E8(wr(t)),n.v=t.indexOf("<")>-1?wr(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(qr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=wr(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=SL[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=E8(e||t));break}if(bhe(n,d,u),u.cellFormula!==!1)if(n.Formula){var v=wr(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=Pf(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Pf("RC:RC",s):n.ArrayRange&&(n.F=Pf(n.ArrayRange,s),l.push([_r(n.F),n.F]))}else for(x=0;x<l.length;++x)s.r>=l[x][0].s.r&&s.r<=l[x][0].e.r&&s.c>=l[x][0].s.c&&s.c<=l[x][0].e.c&&(n.F=l[x][1]);u.cellStyles&&(p.forEach(function(w){!h.patternType&&w.patternType&&(h.patternType=w.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Che(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function N2(t,e){var r=e||{};jh();var n=S0(n4(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Or(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Zr(r);return i.type="string",th.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(De){s.indexOf("<"+De)>=0&&(a=!0)}),a)return u0e(n,r);q0={"General Number":"General","General Date":Gt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Gt[15],"Short Date":Gt[14],"Long Time":Gt[19],"Medium Time":Gt[18],"Short Time":Gt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Gt[2],Standard:Gt[4],Percent:Gt[10],Scientific:Gt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,d={},g=[],h=r.dense?[]:{},p="",x={},v={},w=Pi('<Data ss:Type="String">'),S=0,_=0,y=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},N={},E={},A="",C=0,F=[],D={},R={},M=0,B=[],J=[],X={},z=[],H,U=!1,L=[],ne=[],de={},G=0,K=0,Q={Sheets:[],WBProps:{date1904:!1}},q={};Wg.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var se="";o=Wg.exec(n);)switch(o[3]=(se=o[3]).toLowerCase()){case"data":if(se=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?khe(n.slice(S,o.index),A,w,l[l.length-1][0]=="comment"?X:x,{c:_,r:y},N,z[_],v,L,r):(A="",w=Pi(o[0]),S=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(J.length>0&&(x.c=J),(!r.sheetRows||r.sheetRows>y)&&x.v!==void 0&&(r.dense?(h[y]||(h[y]=[]),h[y][_]=x):h[fn(_)+Dn(y)]=x),x.HRef&&(x.l={Target:wr(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(G=_+(parseInt(x.MergeAcross,10)|0),K=y+(parseInt(x.MergeDown,10)|0),F.push({s:{c:_,r:y},e:{c:G,r:K}})),!r.sheetStubs)x.MergeAcross?_=G+1:++_;else if(x.MergeAcross||x.MergeDown){for(var W=_;W<=G;++W)for(var ee=y;ee<=K;++ee)(W>_||ee>y)&&(r.dense?(h[ee]||(h[ee]=[]),h[ee][W]={t:"z"}):h[fn(W)+Dn(ee)]={t:"z"});_=G+1}else++_;else x=vhe(o[0]),x.Index&&(_=+x.Index-1),_<k.s.c&&(k.s.c=_),_>k.e.c&&(k.e.c=_),o[0].slice(-2)==="/>"&&++_,J=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<k.s.r&&(k.s.r=y),y>k.e.r&&(k.e.r=y),o[0].slice(-2)==="/>"&&(v=Pi(o[0]),v.Index&&(y=+v.Index-1)),_=0,++y):(v=Pi(o[0]),v.Index&&(y=+v.Index-1),de={},(v.AutoFitHeight=="0"||v.Height)&&(de.hpx=parseInt(v.Height,10),de.hpt=Kg(de.hpx),ne[y]=de),v.Hidden=="1"&&(de.hidden=!0,ne[y]=de));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));g.push(p),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(h["!ref"]=sr(k),r.sheetRows&&r.sheetRows<=k.e.r&&(h["!fullref"]=h["!ref"],k.e.r=r.sheetRows-1,h["!ref"]=sr(k))),F.length&&(h["!merges"]=F),z.length>0&&(h["!cols"]=z),ne.length>0&&(h["!rows"]=ne),d[p]=h}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=_=0,l.push([o[3],!1]),u=Pi(o[0]),p=wr(u.Name),h=r.dense?[]:{},F=[],L=[],ne=[],q={name:p,Hidden:0},Q.Sheets.push(q);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),z=[],U=!1}break;case"style":o[1]==="/"?She(N,E,r):E=Pi(o[0]);break;case"numberformat":E.nf=wr(Pi(o[0]).Format||"General"),q0[E.nf]&&(E.nf=q0[E.nf]);for(var ve=0;ve!=392&&Gt[ve]!=E.nf;++ve);if(ve==392){for(ve=57;ve!=392;++ve)if(Gt[ve]==null){ll(E.nf,ve);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(H=Pi(o[0]),H.Hidden&&(H.hidden=!0,delete H.Hidden),H.Width&&(H.wpx=parseInt(H.Width,10)),!U&&H.wpx>10){U=!0,Us=nI;for(var _e=0;_e<z.length;++_e)z[_e]&&_c(z[_e])}U&&_c(H),z[H.Index-1||z.length]=H;for(var Le=0;Le<+H.Span;++Le)z[z.length]=Zr(H);break;case"namedrange":if(o[1]==="/")break;Q.Names||(Q.Names=[]);var te=Yt(o[0]),Ne={Name:te.Name,Ref:Pf(te.RefersTo.slice(1),{r:0,c:0})};Q.Sheets.length>0&&(Ne.Sheet=Q.Sheets.length-1),Q.Names.push(Ne);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?A+=n.slice(C,o.index):C=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=Pi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?Yse(D,se,n.slice(M,o.index)):M=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));Che(X),J.push(X)}else l.push([o[3],!1]),u=Pi(o[0]),X={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ce=Pi(o[0]);h["!autofilter"]={ref:Pf(Ce.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return mj(n,r);var We=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:We=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:We=!1}break;case"excelworkbook":switch(o[3]){case"date1904":Q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:We=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:We=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(M,o.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else M=o.index+o[0].length;break;case"header":h["!margins"]||Au(h["!margins"]={},"xlml"),isNaN(+Yt(o[0]).Margin)||(h["!margins"].header=+Yt(o[0]).Margin);break;case"footer":h["!margins"]||Au(h["!margins"]={},"xlml"),isNaN(+Yt(o[0]).Margin)||(h["!margins"].footer=+Yt(o[0]).Margin);break;case"pagemargins":var nt=Yt(o[0]);h["!margins"]||Au(h["!margins"]={},"xlml"),isNaN(+nt.Top)||(h["!margins"].top=+nt.Top),isNaN(+nt.Left)||(h["!margins"].left=+nt.Left),isNaN(+nt.Right)||(h["!margins"].right=+nt.Right),isNaN(+nt.Bottom)||(h["!margins"].bottom=+nt.Bottom);break;case"displayrighttoleft":Q.Views||(Q.Views=[]),Q.Views[0]||(Q.Views[0]={}),Q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:We=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:We=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:We=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:We=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:We=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:We=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:We=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:We=!1}break;case"smarttags":break;default:We=!1;break}if(We||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?_he(R,se,B,n.slice(M,o.index)):(B=o,M=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var $e={};return!r.bookSheets&&!r.bookProps&&($e.Sheets=d),$e.SheetNames=g,$e.Workbook=Q,$e.SSF=Zr(Gt),$e.Props=D,$e.Custprops=R,$e}function JS(t,e){switch(E4(e=e||{}),e.type||"base64"){case"base64":return N2($a(t),e);case"binary":case"buffer":case"file":return N2(t,e);case"array":return N2(Uc(t),e)}}function The(t,e){var r=[];return t.Props&&r.push(Jse(t.Props,e)),t.Custprops&&r.push(Qse(t.Props,t.Custprops)),r.join("")}function Ehe(){return""}function Nhe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var a=[];a.push(xt("NumberFormat",null,{"ss:Format":Mr(Gt[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(xt("Style",a.join(""),i))}),xt("Styles",r.join(""))}function jI(t){return xt("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+_4(t.Ref,{r:0,c:0})})}function Ahe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(jI(s)))}return xt("Names",r.join(""))}function jhe(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(jI(o)))}return a.join("")}function Fhe(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(xt("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(xt("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(xt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(xt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(ks("ProtectContents","True")),t["!protect"].objects&&s.push(ks("ProtectObjects","True")),t["!protect"].scenarios&&s.push(ks("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(ks("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(ks("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){t["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":xt("WorksheetOptions",s.join(""),{xmlns:Da.x})}function Phe(t){return t.map(function(e){var r=Zne(e.t||""),n=xt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return xt("Comment",n,{"ss:Author":e.a})}).join("")}function Dhe(t,e,r,n,s,a,i){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Mr(_4(t.f,i))),t.F&&t.F.slice(0,e.length)==e){var l=hn(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Mr(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Mr(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var g="",h="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",h=String(t.v);break;case"b":g="Boolean",h=t.v?"1":"0";break;case"e":g="Error",h=Nl[t.v];break;case"d":g="DateTime",h=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Gt[14]);break;case"s":g="String",h=qne(t.v||"");break}var p=Wc(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=i.c+1;var x=t.v!=null?h:"",v=t.t=="z"?"":'<Data ss:Type="'+g+'">'+x+"</Data>";return(t.c||[]).length>0&&(v+=Phe(t.c)),xt("Cell",v,o)}function Rhe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=rh(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Mhe(t,e,r,n){if(!t["!ref"])return"";var s=_r(t["!ref"]),a=t["!merges"]||[],i=0,o=[];t["!cols"]&&t["!cols"].forEach(function(w,S){_c(w);var _=!!w.width,y=Vv(S,w),k={"ss:Index":S+1};_&&(k["ss:Width"]=Gg(y.width)),w.hidden&&(k["ss:Hidden"]="1"),o.push(xt("Column",null,k))});for(var l=Array.isArray(t),u=s.s.r;u<=s.e.r;++u){for(var d=[Rhe(u,(t["!rows"]||[])[u])],g=s.s.c;g<=s.e.c;++g){var h=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>g)&&!(a[i].s.r>u)&&!(a[i].e.c<g)&&!(a[i].e.r<u)){(a[i].s.c!=g||a[i].s.r!=u)&&(h=!0);break}if(!h){var p={r:u,c:g},x=Kt(p),v=l?(t[u]||[])[g]:t[x];d.push(Dhe(v,x,t,e,r,n,p))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function Lhe(t,e,r){var n=[],s=r.SheetNames[t],a=r.Sheets[s],i=a?jhe(a,e,t,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?Mhe(a,e,t,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(Fhe(a,e,t,r)),n.join("")}function Ihe(t,e){e||(e={}),t.SSF||(t.SSF=Zr(Gt)),t.SSF&&(jh(),Bv(t.SSF),e.revssf=$v(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Wc(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(The(t,e)),r.push(Ehe()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(xt("Worksheet",Lhe(n,e,t),{"ss:Name":Mr(t.SheetNames[n])}));return r[2]=Nhe(t,e),r[3]=Ahe(t),Mn+xt("Workbook",r.join(""),{xmlns:Da.ss,"xmlns:o":Da.o,"xmlns:x":Da.x,"xmlns:ss":Da.ss,"xmlns:dt":Da.dt,"xmlns:html":Da.html})}function Ohe(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=Ase(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=jse(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var Bhe=[60,1084,2066,2165,2175];function Uhe(t,e,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=nl(r,r.l),u=QS[l],d=0;u!=null&&Bhe.indexOf(l)>-1;)a=nl(r,r.l+2),d=r.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),o=r.slice(d,r.l+4+a),i.push(o),r.l+=4+a,u=QS[l=nl(r,r.l)];var g=hs(i);_s(g,0);var h=0;g.lens=[];for(var p=0;p<i.length;++p)g.lens.push(h),h+=i[p].length;if(g.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+g.length+" < "+n;return e.f(g,g.length,s)}function lo(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Gt[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Nl[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Bg(t.v):t.w=Yu(t.v):t.w=bi(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&Ah(Gt[n]||String(n))){var s=pu(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function vx(t,e,r){return{v:t,ixfe:e,t:r}}function $he(t,e){var r={opts:{}},n={},s=e.dense?[]:{},a={},i={},o=null,l=[],u="",d={},g,h="",p,x,v,w,S={},_=[],y,k,N=[],E=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},F=function(it){return it<8?Tu[it]:it<64&&E[it-8]||Tu[it]},D=function(it,ht,Ct){var jt=ht.XF.data;if(!(!jt||!jt.patternType||!Ct||!Ct.cellStyles)){ht.s={},ht.s.patternType=jt.patternType;var Fe;(Fe=Hg(F(jt.icvFore)))&&(ht.s.fgColor={rgb:Fe}),(Fe=Hg(F(jt.icvBack)))&&(ht.s.bgColor={rgb:Fe})}},R=function(it,ht,Ct){if(!(de>1)&&!(Ct.sheetRows&&it.r>=Ct.sheetRows)){if(Ct.cellStyles&&ht.XF&&ht.XF.data&&D(it,ht,Ct),delete ht.ixfe,delete ht.XF,g=it,h=Kt(it),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),it.r<i.s.r&&(i.s.r=it.r),it.c<i.s.c&&(i.s.c=it.c),it.r+1>i.e.r&&(i.e.r=it.r+1),it.c+1>i.e.c&&(i.e.c=it.c+1),Ct.cellFormula&&ht.f){for(var jt=0;jt<_.length;++jt)if(!(_[jt][0].s.c>it.c||_[jt][0].s.r>it.r)&&!(_[jt][0].e.c<it.c||_[jt][0].e.r<it.r)){ht.F=sr(_[jt][0]),(_[jt][0].s.c!=it.c||_[jt][0].s.r!=it.r)&&delete ht.f,ht.f&&(ht.f=""+Os(_[jt][1],i,it,L,M));break}}Ct.dense?(s[it.r]||(s[it.r]=[]),s[it.r][it.c]=ht):s[h]=ht}},M={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(M.password=e.password);var B,J=[],X=[],z=[],H=[],U=!1,L=[];L.SheetNames=M.snames,L.sharedf=M.sharedf,L.arrayf=M.arrayf,L.names=[],L.XTI=[];var ne=0,de=0,G=0,K=[],Q=[],q;M.codepage=1200,Bi(1200);for(var se=!1;t.l<t.length-1;){var W=t.l,ee=t.read_shift(2);if(ee===0&&ne===10)break;var ve=t.l===t.length?0:t.read_shift(2),_e=QS[ee];if(_e&&_e.f){if(e.bookSheets&&ne===133&&ee!==133)break;if(ne=ee,_e.r===2||_e.r==12){var Le=t.read_shift(2);if(ve-=2,!M.enc&&Le!==ee&&((Le&255)<<8|Le>>8)!==ee)throw new Error("rt mismatch: "+Le+"!="+ee);_e.r==12&&(t.l+=10,ve-=10)}var te={};if(ee===10?te=_e.f(t,ve,M):te=Uhe(ee,_e,t,ve,M),de==0&&[9,521,1033,2057].indexOf(ne)===-1)continue;switch(ee){case 34:r.opts.Date1904=A.WBProps.date1904=te;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(M.enc||(t.l=0),M.enc=te,!e.password)throw new Error("File is password-protected");if(te.valid==null)throw new Error("Encryption scheme unsupported");if(!te.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=te;break;case 66:var Ne=Number(te);switch(Ne){case 21010:Ne=1200;break;case 32768:Ne=1e4;break;case 32769:Ne=1252;break}Bi(M.codepage=Ne),se=!0;break;case 317:M.rrtabid=te;break;case 25:M.winlocked=te;break;case 439:r.opts.RefreshAll=te;break;case 12:r.opts.CalcCount=te;break;case 16:r.opts.CalcDelta=te;break;case 17:r.opts.CalcIter=te;break;case 13:r.opts.CalcMode=te;break;case 14:r.opts.CalcPrecision=te;break;case 95:r.opts.CalcSaveRecalc=te;break;case 15:M.CalcRefMode=te;break;case 2211:r.opts.FullCalc=te;break;case 129:te.fDialog&&(s["!type"]="dialog"),te.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),te.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:N.push(te);break;case 430:L.push([te]),L[L.length-1].XTI=[];break;case 35:case 547:L[L.length-1].push(te);break;case 24:case 536:q={Name:te.Name,Ref:Os(te.rgce,i,null,L,M)},te.itab>0&&(q.Sheet=te.itab-1),L.names.push(q),L[0]||(L[0]=[],L[0].XTI=[]),L[L.length-1].push(te),te.Name=="_xlnm._FilterDatabase"&&te.itab>0&&te.rgce&&te.rgce[0]&&te.rgce[0][0]&&te.rgce[0][0][0]=="PtgArea3d"&&(Q[te.itab-1]={ref:sr(te.rgce[0][0][1][2])});break;case 22:M.ExternCount=te;break;case 23:L.length==0&&(L[0]=[],L[0].XTI=[]),L[L.length-1].XTI=L[L.length-1].XTI.concat(te),L.XTI=L.XTI.concat(te);break;case 2196:if(M.biff<8)break;q!=null&&(q.Comment=te[1]);break;case 18:s["!protect"]=te;break;case 19:te!==0&&M.WTF&&console.error("Password verifier: "+te);break;case 133:a[te.pos]=te,M.snames.push(te.name);break;case 10:{if(--de)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=sr(i),e.sheetRows&&e.sheetRows<=i.e.r){var Ce=i.e.r;i.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=sr(i),i.e.r=Ce}i.e.r++,i.e.c++}J.length>0&&(s["!merges"]=J),X.length>0&&(s["!objects"]=X),z.length>0&&(s["!cols"]=z),H.length>0&&(s["!rows"]=H),A.Sheets.push(C)}u===""?d=s:n[u]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[te.BIFFVer]||8),M.biffguess=te.BIFFVer==0,te.BIFFVer==0&&te.dt==4096&&(M.biff=5,se=!0,Bi(M.codepage=28591)),M.biff==8&&te.BIFFVer==0&&te.dt==16&&(M.biff=2),de++)break;if(s=e.dense?[]:{},M.biff<8&&!se&&(se=!0,Bi(M.codepage=e.codepage||1252)),M.biff<5||te.BIFFVer==0&&te.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var We={pos:t.l-ve,name:u};a[We.pos]=We,M.snames.push(u)}else u=(a[W]||{name:""}).name;te.dt==32&&(s["!type"]="chart"),te.dt==64&&(s["!type"]="macro"),J=[],X=[],M.arrayf=_=[],z=[],H=[],U=!1,C={Hidden:(a[W]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[te.r]||[])[te.c]:s[Kt({c:te.c,r:te.r})])&&++te.c,y={ixfe:te.ixfe,XF:N[te.ixfe]||{},v:te.val,t:"n"},G>0&&(y.z=K[y.ixfe>>8&63]),lo(y,e,r.opts.Date1904),R({c:te.c,r:te.r},y,e);break;case 5:case 517:y={ixfe:te.ixfe,XF:N[te.ixfe],v:te.val,t:te.t},G>0&&(y.z=K[y.ixfe>>8&63]),lo(y,e,r.opts.Date1904),R({c:te.c,r:te.r},y,e);break;case 638:y={ixfe:te.ixfe,XF:N[te.ixfe],v:te.rknum,t:"n"},G>0&&(y.z=K[y.ixfe>>8&63]),lo(y,e,r.opts.Date1904),R({c:te.c,r:te.r},y,e);break;case 189:for(var nt=te.c;nt<=te.C;++nt){var $e=te.rkrec[nt-te.c][0];y={ixfe:$e,XF:N[$e],v:te.rkrec[nt-te.c][1],t:"n"},G>0&&(y.z=K[y.ixfe>>8&63]),lo(y,e,r.opts.Date1904),R({c:nt,r:te.r},y,e)}break;case 6:case 518:case 1030:{if(te.val=="String"){o=te;break}if(y=vx(te.val,te.cell.ixfe,te.tt),y.XF=N[y.ixfe],e.cellFormula){var De=te.formula;if(De&&De[0]&&De[0][0]&&De[0][0][0]=="PtgExp"){var at=De[0][0][1][0],Se=De[0][0][1][1],Ae=Kt({r:at,c:Se});S[Ae]?y.f=""+Os(te.formula,i,te.cell,L,M):y.F=((e.dense?(s[at]||[])[Se]:s[Ae])||{}).F}else y.f=""+Os(te.formula,i,te.cell,L,M)}G>0&&(y.z=K[y.ixfe>>8&63]),lo(y,e,r.opts.Date1904),R(te.cell,y,e),o=te}break;case 7:case 519:if(o)o.val=te,y=vx(te,o.cell.ixfe,"s"),y.XF=N[y.ixfe],e.cellFormula&&(y.f=""+Os(o.formula,i,o.cell,L,M)),G>0&&(y.z=K[y.ixfe>>8&63]),lo(y,e,r.opts.Date1904),R(o.cell,y,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(te);var Me=Kt(te[0].s);if(p=e.dense?(s[te[0].s.r]||[])[te[0].s.c]:s[Me],e.cellFormula&&p){if(!o||!Me||!p)break;p.f=""+Os(te[1],i,te[0],L,M),p.F=sr(te[0])}}break;case 1212:{if(!e.cellFormula)break;if(h){if(!o)break;S[Kt(o.cell)]=te[0],p=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Kt(o.cell)],(p||{}).f=""+Os(te[0],i,g,L,M)}}break;case 253:y=vx(l[te.isst].t,te.ixfe,"s"),l[te.isst].h&&(y.h=l[te.isst].h),y.XF=N[y.ixfe],G>0&&(y.z=K[y.ixfe>>8&63]),lo(y,e,r.opts.Date1904),R({c:te.c,r:te.r},y,e);break;case 513:e.sheetStubs&&(y={ixfe:te.ixfe,XF:N[te.ixfe],t:"z"},G>0&&(y.z=K[y.ixfe>>8&63]),lo(y,e,r.opts.Date1904),R({c:te.c,r:te.r},y,e));break;case 190:if(e.sheetStubs)for(var Ie=te.c;Ie<=te.C;++Ie){var Ge=te.ixfe[Ie-te.c];y={ixfe:Ge,XF:N[Ge],t:"z"},G>0&&(y.z=K[y.ixfe>>8&63]),lo(y,e,r.opts.Date1904),R({c:Ie,r:te.r},y,e)}break;case 214:case 516:case 4:y=vx(te.val,te.ixfe,"s"),y.XF=N[y.ixfe],G>0&&(y.z=K[y.ixfe>>8&63]),lo(y,e,r.opts.Date1904),R({c:te.c,r:te.r},y,e);break;case 0:case 512:de===1&&(i=te);break;case 252:l=te;break;case 1054:if(M.biff==4){K[G++]=te[1];for(var tt=0;tt<G+163&&Gt[tt]!=te[1];++tt);tt>=163&&ll(te[1],G+163)}else ll(te[1],te[0]);break;case 30:{K[G++]=te;for(var kt=0;kt<G+163&&Gt[kt]!=te;++kt);kt>=163&&ll(te,G+163)}break;case 229:J=J.concat(te);break;case 93:X[te.cmo[0]]=M.lastobj=te;break;case 438:M.lastobj.TxO=te;break;case 127:M.lastobj.ImData=te;break;case 440:for(w=te[0].s.r;w<=te[0].e.r;++w)for(v=te[0].s.c;v<=te[0].e.c;++v)p=e.dense?(s[w]||[])[v]:s[Kt({c:v,r:w})],p&&(p.l=te[1]);break;case 2048:for(w=te[0].s.r;w<=te[0].e.r;++w)for(v=te[0].s.c;v<=te[0].e.c;++v)p=e.dense?(s[w]||[])[v]:s[Kt({c:v,r:w})],p&&p.l&&(p.l.Tooltip=te[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;p=e.dense?(s[te[0].r]||[])[te[0].c]:s[Kt(te[0])];var zt=X[te[2]];p||(e.dense?(s[te[0].r]||(s[te[0].r]=[]),p=s[te[0].r][te[0].c]={t:"z"}):p=s[Kt(te[0])]={t:"z"},i.e.r=Math.max(i.e.r,te[0].r),i.s.r=Math.min(i.s.r,te[0].r),i.e.c=Math.max(i.e.c,te[0].c),i.s.c=Math.min(i.s.c,te[0].c)),p.c||(p.c=[]),x={a:te[1],t:zt.TxO.t},p.c.push(x)}break;case 2173:Nle(N[te.ixfe],te.ext);break;case 125:{if(!M.cellStyles)break;for(;te.e>=te.s;)z[te.e--]={width:te.w/256,level:te.level||0,hidden:!!(te.flags&1)},U||(U=!0,y4(te.w/256)),_c(z[te.e+1])}break;case 520:{var bt={};te.level!=null&&(H[te.r]=bt,bt.level=te.level),te.hidden&&(H[te.r]=bt,bt.hidden=!0),te.hpt&&(H[te.r]=bt,bt.hpt=te.hpt,bt.hpx=rh(te.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Au(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ee]]=te;break;case 161:s["!margins"]||Au(s["!margins"]={}),s["!margins"].header=te.header,s["!margins"].footer=te.footer;break;case 574:te.RTL&&(A.Views[0].RTL=!0);break;case 146:E=te;break;case 2198:B=te;break;case 140:k=te;break;case 442:u?C.CodeName=te||C.name:A.WBProps.CodeName=te||"ThisWorkbook";break}}else _e||console.error("Missing Info for XLS Record 0x"+ee.toString(16)),t.l+=ve}return r.SheetNames=Tn(a).sort(function(Dt,it){return Number(Dt)-Number(it)}).map(function(Dt){return a[Dt].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&Q.forEach(function(Dt,it){r.Sheets[r.SheetNames[it]]["!autofilter"]=Dt}),r.Strings=l,r.SSF=Zr(Gt),M.enc&&(r.Encryption=M.enc),B&&(r.Themes=B),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),L.names.length>0&&(A.Names=L.names),r.Workbook=A,r}var Z0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Whe(t,e,r){var n=Wt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=G8(n,HS,Z0.DSI);for(var a in s)e[a]=s[a]}catch(u){if(r.WTF)throw u}var i=Wt.find(t,"/!SummaryInformation");if(i&&i.size>0)try{var o=G8(i,GS,Z0.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(AL(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function zhe(t,e){var r=[],n=[],s=[],a=0,i,o=_8(HS,"n"),l=_8(GS,"n");if(t.Props)for(i=Tn(t.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(l,i[a])?n:s).push([i[a],t.Props[i[a]]]);if(t.Custprops)for(i=Tn(t.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(t.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(l,i[a])?n:s).push([i[a],t.Custprops[i[a]]]);var u=[];for(a=0;a<s.length;++a)LL.indexOf(s[a][0])>-1||NL.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&Wt.utils.cfb_add(e,"/SummaryInformation",V8(n,Z0.SI,l,GS)),(r.length||u.length)&&Wt.utils.cfb_add(e,"/DocumentSummaryInformation",V8(r,Z0.DSI,o,HS,u.length?u:null,Z0.UDI))}function FI(t,e){e||(e={}),E4(e),XT(),e.codepage&&KT(e.codepage);var r,n;if(t.FullPaths){if(Wt.find(t,"/encryption"))throw new Error("File is password-protected");r=Wt.find(t,"!CompObj"),n=Wt.find(t,"/Workbook")||Wt.find(t,"/Book")}else{switch(e.type){case"base64":t=Ma($a(t));break;case"binary":t=Ma(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}_s(t,0),n={content:t}}var s,a;if(r&&Ohe(r),e.bookProps&&!e.bookSheets)s={};else{var i=lr?"buffer":"array";if(n&&n.content)s=$he(n.content,e);else if((a=Wt.find(t,"PerfectOffice_MAIN"))&&a.content)s=Nu.to_workbook(a.content,(e.type=i,e));else if((a=Wt.find(t,"NativeContent_MAIN"))&&a.content)s=Nu.to_workbook(a.content,(e.type=i,e));else throw(a=Wt.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Wt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=rce(t))}var o={};return t.FullPaths&&Whe(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}function Hhe(t,e){var r=e||{},n=Wt.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Wt.utils.cfb_add(n,s,PI(t,r)),r.biff==8&&(t.Props||t.Custprops)&&zhe(t,n),r.biff==8&&t.vbaraw&&nce(n,Wt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Xg={0:{f:gde},1:{f:bde},2:{f:$de},3:{f:jde},4:{f:Tde},5:{f:Ode},6:{f:Vde},7:{f:Rde},8:{f:Zde},9:{f:qde},10:{f:Jde},11:{f:Qde},12:{f:kde},13:{f:zde},14:{f:Pde},15:{f:Nde},16:{f:SI},17:{f:Xde},18:{f:Lde},19:{f:l4},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Xfe},40:{},42:{},43:{f:Voe},44:{f:Hoe},45:{f:Yoe},46:{f:Qoe},47:{f:Joe},48:{},49:{f:xse},50:{},51:{f:Fle},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:KL},62:{f:Gde},63:{f:Ule},64:{f:mfe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Xs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:dfe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:wde},148:{f:xde,p:16},151:{f:afe},152:{},153:{f:Gfe},154:{},155:{},156:{f:zfe},157:{},158:{},159:{T:1,f:ooe},160:{T:-1},161:{T:1,f:vd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:efe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Ale},336:{T:-1},337:{f:Rle,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:zS},357:{},358:{},359:{},360:{T:1},361:{},362:{f:VL},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ife},427:{f:ofe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:cfe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:vde},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:nfe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:zS},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Qle},633:{T:1},634:{T:-1},635:{T:1,f:Yle},636:{T:-1},637:{f:_se},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Pfe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:pfe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},QS={6:{f:T2},10:{f:Ul},12:{f:Un},13:{f:Un},14:{f:An},15:{f:An},16:{f:$s},17:{f:An},18:{f:An},19:{f:Un},20:{f:q8},21:{f:q8},23:{f:VL},24:{f:ej},25:{f:An},26:{},27:{},28:{f:pie},29:{},34:{f:An},35:{f:Z8},38:{f:$s},39:{f:$s},40:{f:$s},41:{f:$s},42:{f:An},43:{f:An},47:{f:Noe},49:{f:zae},51:{f:Un},60:{},61:{f:Oae},64:{f:An},65:{f:Wae},66:{f:Un},77:{},80:{},81:{},82:{},85:{f:Un},89:{},90:{},91:{},92:{f:Eae},93:{f:vie},94:{},95:{f:An},96:{},97:{},99:{f:An},125:{f:KL},128:{f:sie},129:{f:Aae},130:{f:Un},131:{f:An},132:{f:An},133:{f:jae},134:{},140:{f:Eie},141:{f:Un},144:{},146:{f:jie},151:{},152:{},153:{},154:{},155:{},156:{f:Un},157:{},158:{},160:{f:Iie},161:{f:Die},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:eie},190:{f:tie},193:{f:Ul},197:{},198:{},199:{},200:{},201:{},202:{f:An},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Un},220:{},221:{f:An},222:{},224:{f:nie},225:{f:Tae},226:{f:Ul},227:{},229:{f:xie},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Pae},253:{f:Gae},255:{f:Rae},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:IL},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:An},353:{f:Ul},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:cie},431:{f:An},432:{},433:{},434:{},437:{},438:{f:bie},439:{f:An},440:{f:Sie},441:{},442:{f:Pm},443:{},444:{f:Un},445:{},446:{},448:{f:Ul},449:{f:Iae,r:2},450:{f:Ul},512:{f:Y8},513:{f:Lie},515:{f:oie},516:{f:Kae},517:{f:Q8},519:{f:Oie},520:{f:Mae},523:{},545:{f:tj},549:{f:X8},566:{},574:{f:Uae},638:{f:Zae},659:{},1048:{},1054:{f:Yae},1084:{},1212:{f:hie},2048:{f:Cie},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:px},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ul},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Fie,r:12},2173:{f:Ele,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:An,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:fie,r:12},2197:{},2198:{f:_le,r:12},2199:{},2200:{},2201:{},2202:{f:gie,r:12},2203:{f:Ul},2204:{},2205:{},2206:{},2207:{},2211:{f:Lae},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Un},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Rie},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Aie},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Y8},1:{},2:{f:zie},3:{f:$ie},4:{f:Uie},5:{f:Q8},7:{f:Gie},8:{},9:{f:px},11:{},22:{f:Un},30:{f:Qae},31:{},32:{},33:{f:tj},36:{},37:{f:X8},50:{f:Vie},62:{},52:{},67:{},68:{f:Un},69:{},86:{},126:{},127:{f:Bie},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Kie},223:{},234:{},354:{},421:{},518:{f:T2},521:{f:px},536:{f:ej},547:{f:Z8},561:{},579:{},1030:{f:T2},1033:{f:px},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function vt(t,e,r,n){var s=e;if(!isNaN(s)){var a=n||(r||[]).length||0,i=t.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&a4(r)&&t.push(r)}}function Ghe(t,e,r,n){var s=(r||[]).length||0;if(s<=8224)return vt(t,e,r,s);var a=e;if(!isNaN(a)){for(var i=r.parts||[],o=0,l=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var d=t.next(4);for(d.write_shift(2,a),d.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<s;){for(d=t.next(4),d.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;d.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function Lm(t,e,r){return t||(t=qe(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function Vhe(t,e,r,n){var s=qe(9);return Lm(s,t,e),OL(r,n||"b",s),s}function Khe(t,e,r){var n=qe(8+2*r.length);return Lm(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Xhe(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?ts(qr(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?vt(t,2,Hie(r,n,s)):vt(t,3,Wie(r,n,s));return;case"b":case"e":vt(t,5,Vhe(r,n,e.v,e.t));return;case"s":case"str":vt(t,4,Khe(r,n,(e.v||"").slice(0,255)));return}vt(t,1,Lm(null,r,n))}function Yhe(t,e,r,n){var s=Array.isArray(e),a=_r(e["!ref"]||"A1"),i,o="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=sr(a)}for(var u=a.s.r;u<=a.e.r;++u){o=Dn(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(l[d]=fn(d)),i=l[d]+o;var g=s?(e[u]||[])[d]:e[i];g&&Xhe(t,g,u,d)}}}function Jhe(t,e){for(var r=e||{},n=Ea(),s=0,a=0;a<t.SheetNames.length;++a)t.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return vt(n,r.biff==4?1033:r.biff==3?521:9,m4(t,16,r)),Yhe(n,t.Sheets[t.SheetNames[s]],s,r),vt(n,10),n.end()}function Qhe(t,e,r){vt(t,49,Hae({sz:12,name:"Arial"},r))}function qhe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&vt(t,1054,Jae(s,e[s],r))})}function Zhe(t,e){var r=qe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),vt(t,2151,r),r=qe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),zL(_r(e["!ref"]||"A1"),r),r.write_shift(4,4),vt(t,2152,r)}function e0e(t,e){for(var r=0;r<16;++r)vt(t,224,J8({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){vt(t,224,J8(n,0,e))})}function t0e(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];vt(t,440,kie(n)),n[1].Tooltip&&vt(t,2048,Tie(n))}delete e["!links"]}function r0e(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&vt(t,125,Pie(Vv(s,n),s))})}}function n0e(t,e,r,n,s){var a=16+Wc(s.cellXfs,e,s);if(e.v==null&&!e.bf){vt(t,513,Zu(r,n,a));return}if(e.bf)vt(t,6,Aue(e,r,n,s,a));else switch(e.t){case"d":case"n":var i=e.t=="d"?ts(qr(e.v)):e.v;vt(t,515,lie(r,n,i,a));break;case"b":case"e":vt(t,517,iie(r,n,e.v,a,s,e.t));break;case"s":case"str":if(s.bookSST){var o=S4(s.Strings,e.v,s.revStrings);vt(t,253,Vae(r,n,o,a))}else vt(t,516,Xae(r,n,(e.v||"").slice(0,255),a,s));break;default:vt(t,513,Zu(r,n,a))}}function s0e(t,e,r){var n=Ea(),s=r.SheetNames[t],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[t]||{},l=Array.isArray(a),u=e.biff==8,d,g="",h=[],p=_r(a["!ref"]||"A1"),x=u?65536:16384;if(p.e.c>255||p.e.r>=x){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}vt(n,2057,m4(r,16,e)),vt(n,13,li(1)),vt(n,12,li(100)),vt(n,15,ta(!0)),vt(n,17,ta(!1)),vt(n,16,Qu(.001)),vt(n,95,ta(!0)),vt(n,42,ta(!1)),vt(n,43,ta(!1)),vt(n,130,li(1)),vt(n,128,aie()),vt(n,131,ta(!1)),vt(n,132,ta(!1)),u&&r0e(n,a["!cols"]),vt(n,512,qae(p,e)),u&&(a["!links"]=[]);for(var v=p.s.r;v<=p.e.r;++v){g=Dn(v);for(var w=p.s.c;w<=p.e.c;++w){v===p.s.r&&(h[w]=fn(w)),d=h[w]+g;var S=l?(a[v]||[])[w]:a[d];S&&(n0e(n,S,v,w,e),u&&S.l&&a["!links"].push([d,S.l]))}}var _=o.CodeName||o.name||s;return u&&vt(n,574,$ae((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&vt(n,229,yie(a["!merges"])),u&&t0e(n,a),vt(n,442,BL(_)),u&&Zhe(n,a),vt(n,10),n.end()}function a0e(t,e,r){var n=Ea(),s=(t||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,l=r.biff==5;if(vt(n,2057,m4(t,5,r)),r.bookType=="xla"&&vt(n,135),vt(n,225,o?li(1200):null),vt(n,193,iae(2)),l&&vt(n,191),l&&vt(n,192),vt(n,226),vt(n,92,Nae("SheetJS",r)),vt(n,66,li(o?1200:1252)),o&&vt(n,353,li(0)),o&&vt(n,448),vt(n,317,Mie(t.SheetNames.length)),o&&t.vbaraw&&vt(n,211),o&&t.vbaraw){var u=i.CodeName||"ThisWorkbook";vt(n,442,BL(u))}vt(n,156,li(17)),vt(n,25,ta(!1)),vt(n,18,ta(!1)),vt(n,19,li(0)),o&&vt(n,431,ta(!1)),o&&vt(n,444,li(0)),vt(n,61,Bae()),vt(n,64,ta(!1)),vt(n,141,li(0)),vt(n,34,ta(Ife(t)=="true")),vt(n,14,ta(!0)),o&&vt(n,439,ta(!1)),vt(n,218,li(0)),Qhe(n,t,r),qhe(n,t.SSF,r),e0e(n,r),o&&vt(n,352,ta(!1));var d=n.end(),g=Ea();o&&vt(g,140,Nie()),o&&r.Strings&&Ghe(g,252,Dae(r.Strings)),vt(g,10);var h=g.end(),p=Ea(),x=0,v=0;for(v=0;v<t.SheetNames.length;++v)x+=(o?12:11)+(o?2:1)*t.SheetNames[v].length;var w=d.length+x+h.length;for(v=0;v<t.SheetNames.length;++v){var S=a[v]||{};vt(p,133,Fae({pos:w,hs:S.Hidden||0,dt:0,name:t.SheetNames[v]},r)),w+=e[v].length}var _=p.end();if(x!=_.length)throw new Error("BS8 "+x+" != "+_.length);var y=[];return d.length&&y.push(d),_.length&&y.push(_),h.length&&y.push(h),hs(y)}function i0e(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Zr(Gt)),t&&t.SSF&&(jh(),Bv(t.SSF),r.revssf=$v(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,N4(r),r.cellXfs=[],Wc(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=s0e(s,r,t);return n.unshift(a0e(t,n,r)),hs(n)}function PI(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Na(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=e||{};switch(a.biff||2){case 8:case 5:return i0e(t,e);case 4:case 3:case 2:return Jhe(t,e)}throw new Error("invalid type "+a.bookType+" for BIFF")}function dj(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),i=s.index,o=a&&a.index||t.length,l=Hne(t.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,g=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<l.length;++i){var v=l[i].trim(),w=v.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(w!="<td"&&w!="<th")){var S=v.split(/<\/t[dh]>/i);for(o=0;o<S.length;++o){var _=S[o].trim();if(_.match(/<t[dh]/i)){for(var y=_,k=0;y.charAt(0)=="<"&&(k=y.indexOf(">"))>-1;)y=y.slice(k+1);for(var N=0;N<x.length;++N){var E=x[N];E.s.c==d&&E.s.r<u&&u<=E.e.r&&(d=E.e.c+1,N=-1)}var A=Yt(_.slice(0,_.indexOf(">")));h=A.colspan?+A.colspan:1,((g=+A.rowspan)>1||h>1)&&x.push({s:{r:u,c:d},e:{r:u+(g||1)-1,c:d+h-1}});var C=A.t||A["data-t"]||"";if(!y.length){d+=h;continue}if(y=rL(y),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!y.length){d+=h;continue}var F={t:"s",v:y};r.raw||!y.trim().length||C=="s"||(y==="TRUE"?F={t:"b",v:!0}:y==="FALSE"?F={t:"b",v:!1}:isNaN(Gi(y))?isNaN(eh(y).getDate())||(F={t:"d",v:qr(y)},r.cellDates||(F={t:"n",v:ts(F.v)}),F.z=r.dateNF||Gt[14]):F={t:"n",v:Gi(y)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=F):n[Kt({r:u,c:d})]=F,d+=h}}}}return n["!ref"]=sr(p),x.length&&(n["!merges"]=x),n}function o0e(t,e,r,n){for(var s=t["!merges"]||[],a=[],i=e.s.c;i<=e.e.c;++i){for(var o=0,l=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,l=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var d=Kt({r,c:i}),g=n.dense?(t[r]||[])[i]:t[d],h=g&&g.v!=null&&(g.h||r4(g.w||(yl(g),g.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":g&&(p["data-t"]=g&&g.t||"z",g.v!=null&&(p["data-v"]=g.v),g.z!=null&&(p["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+g.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+d,a.push(xt("td",h,p))}}var x="<tr>";return x+a.join("")+"</tr>"}var l0e='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',c0e="</body></html>";function u0e(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return $c(dj(r[0],e),e);var n=F4();return r.forEach(function(s,a){P4(n,dj(s,e),"Sheet"+(a+1))}),n}function d0e(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function DI(t,e){var r=e||{},n=r.header!=null?r.header:l0e,s=r.footer!=null?r.footer:c0e,a=[n],i=Na(t["!ref"]);r.dense=Array.isArray(t),a.push(d0e(t,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(o0e(t,i,o,r));return a.push("</table>"+s),a.join("")}function RI(t,e,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?hn(n.origin):n.origin;s=i.r,a=i.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(t["!ref"]){var d=Na(t["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var g=[],h=0,p=t["!rows"]||(t["!rows"]=[]),x=0,v=0,w=0,S=0,_=0,y=0;for(t["!cols"]||(t["!cols"]=[]);x<o.length&&v<l;++x){var k=o[x];if(fj(k)){if(n.display)continue;p[v]={hidden:!0}}var N=k.children;for(w=S=0;w<N.length;++w){var E=N[w];if(!(n.display&&fj(E))){var A=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):rL(E.innerHTML),C=E.getAttribute("data-z")||E.getAttribute("z");for(h=0;h<g.length;++h){var F=g[h];F.s.c==S+a&&F.s.r<v+s&&v+s<=F.e.r&&(S=F.e.c+1-a,h=-1)}y=+E.getAttribute("colspan")||1,((_=+E.getAttribute("rowspan")||1)>1||y>1)&&g.push({s:{r:v+s,c:S+a},e:{r:v+s+(_||1)-1,c:S+a+(y||1)-1}});var D={t:"s",v:A},R=E.getAttribute("data-t")||E.getAttribute("t")||"";A!=null&&(A.length==0?D.t=R||"z":n.raw||A.trim().length==0||R=="s"||(A==="TRUE"?D={t:"b",v:!0}:A==="FALSE"?D={t:"b",v:!1}:isNaN(Gi(A))?isNaN(eh(A).getDate())||(D={t:"d",v:qr(A)},n.cellDates||(D={t:"n",v:ts(D.v)}),D.z=n.dateNF||Gt[14]):D={t:"n",v:Gi(A)})),D.z===void 0&&C!=null&&(D.z=C);var M="",B=E.getElementsByTagName("A");if(B&&B.length)for(var J=0;J<B.length&&!(B[J].hasAttribute("href")&&(M=B[J].getAttribute("href"),M.charAt(0)!="#"));++J);M&&M.charAt(0)!="#"&&(D.l={Target:M}),n.dense?(t[v+s]||(t[v+s]=[]),t[v+s][S+a]=D):t[Kt({c:S+a,r:v+s})]=D,u.e.c<S+a&&(u.e.c=S+a),S+=y}}++v}return g.length&&(t["!merges"]=(t["!merges"]||[]).concat(g)),u.e.r=Math.max(u.e.r,v-1+s),t["!ref"]=sr(u),v>=l&&(t["!fullref"]=sr((u.e.r=o.length-x+v-1+s,u))),t}function MI(t,e){var r=e||{},n=r.dense?[]:{};return RI(n,t,e)}function f0e(t,e){return $c(MI(t,e),e)}function fj(t){var e="",r=h0e(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function h0e(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function g0e(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=wr(e.replace(/<[^>]*>/g,""));return[r]}var hj={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function LI(t,e){var r=e||{},n=n4(t),s=[],a,i,o={name:""},l="",u=0,d,g,h={},p=[],x=r.dense?[]:{},v,w,S={value:""},_="",y=0,k=[],N=-1,E=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,F={},D=[],R={},M=0,B=0,J=[],X=1,z=1,H=[],U={Names:[]},L={},ne=["",""],de=[],G={},K="",Q=0,q=!1,se=!1,W=0;for(Wg.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=Wg.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?x["!ref"]=sr(A):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(x["!fullref"]=x["!ref"],A.e.r=r.sheetRows-1,x["!ref"]=sr(A)),D.length&&(x["!merges"]=D),J.length&&(x["!rows"]=J),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),h[d.name]=x,se=!1):v[0].charAt(v[0].length-2)!=="/"&&(d=Yt(v[0],!1),N=E=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,x=r.dense?[]:{},D=[],J=[],se=!0);break;case"table-row-group":v[1]==="/"?--C:++C;break;case"table-row":case"":if(v[1]==="/"){N+=X,X=1;break}if(g=Yt(v[0],!1),g.?N=g.-1:N==-1&&(N=0),X=+g["number-rows-repeated"]||1,X<10)for(W=0;W<X;++W)C>0&&(J[N+W]={level:C});E=-1;break;case"covered-table-cell":v[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(x[N]||(x[N]=[]),x[N][E]={t:"z"}):x[Kt({r:N,c:E})]={t:"z"}),_="",k=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++E,S=Yt(v[0],!1),z=parseInt(S["number-columns-repeated"]||"1",10),w={t:"z",v:null},S.formula&&r.cellFormula!=!1&&(w.f=lj(wr(S.formula))),(S.||S["value-type"])=="string"&&(w.t="s",w.v=wr(S["string-value"]||""),r.dense?(x[N]||(x[N]=[]),x[N][E]=w):x[Kt({r:N,c:E})]=w),E+=z-1;else if(v[1]!=="/"){++E,_="",y=0,k=[],z=1;var ee=X?N+X-1:N;if(E>A.e.c&&(A.e.c=E),E<A.s.c&&(A.s.c=E),N<A.s.r&&(A.s.r=N),ee>A.e.r&&(A.e.r=ee),S=Yt(v[0],!1),de=[],G={},w={t:S.||S["value-type"],v:null},r.cellFormula)if(S.formula&&(S.formula=wr(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(M=parseInt(S["number-matrix-rows-spanned"],10)||0,B=parseInt(S["number-matrix-columns-spanned"],10)||0,R={s:{r:N,c:E},e:{r:N+M-1,c:E+B-1}},w.F=sr(R),H.push([R,w.F])),S.formula)w.f=lj(S.formula);else for(W=0;W<H.length;++W)N>=H[W][0].s.r&&N<=H[W][0].e.r&&E>=H[W][0].s.c&&E<=H[W][0].e.c&&(w.F=H[W][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(M=parseInt(S["number-rows-spanned"],10)||0,B=parseInt(S["number-columns-spanned"],10)||0,R={s:{r:N,c:E},e:{r:N+M-1,c:E+B-1}},D.push(R)),S["number-columns-repeated"]&&(z=parseInt(S["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Kr(S["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(S.value);break;case"percentage":w.t="n",w.v=parseFloat(S.value);break;case"currency":w.t="n",w.v=parseFloat(S.value);break;case"date":w.t="d",w.v=qr(S["date-value"]),r.cellDates||(w.t="n",w.v=ts(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=$ne(S["time-value"])/86400,r.cellDates&&(w.t="d",w.v=Wv(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(S.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",S["string-value"]!=null&&(_=wr(S["string-value"]),k=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(q=!1,w.t==="s"&&(w.v=_||"",k.length&&(w.R=k),q=y==0),L.Target&&(w.l=L),de.length>0&&(w.c=de,de=[]),_&&r.cellText!==!1&&(w.w=_),q&&(w.t="z",delete w.v),(!q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=N))for(var ve=0;ve<X;++ve){if(z=parseInt(S["number-columns-repeated"]||"1",10),r.dense)for(x[N+ve]||(x[N+ve]=[]),x[N+ve][E]=ve==0?w:Zr(w);--z>0;)x[N+ve][E+z]=Zr(w);else for(x[Kt({r:N+ve,c:E})]=w;--z>0;)x[Kt({r:N+ve,c:E+z})]=Zr(w);A.e.c<=E&&(A.e.c=E)}z=parseInt(S["number-columns-repeated"]||"1",10),E+=z-1,z=0,w={},_="",k=[]}L={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a;G.t=_,k.length&&(G.R=k),G.a=K,de.push(G)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);K="",Q=0,_="",y=0,k=[];break;case"creator":v[1]==="/"?K=n.slice(Q,v.index):Q=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);_="",y=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(F[o.name]=l,(a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&(l="",o=Yt(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Yt(v[0],!1),l+=hj[v[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Yt(v[0],!1),l+=hj[v[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,v.index);break}else u=v.index+v[0].length;break;case"named-range":i=Yt(v[0],!1),ne=E2(i["cell-range-address"]);var _e={Name:i.name,Ref:ne[0]+"!"+ne[1]};se&&(_e.Sheet=p.length),U.Names.push(_e);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!S||!S["string-value"])){var Le=g0e(n.slice(y,v.index));_=(_.length>0?_+`
`:"")+Le[0]}else Yt(v[0],!1),y=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{ne=E2(Yt(v[0])["target-range-address"]),h[ne[0]]["!autofilter"]={ref:ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(L=Yt(v[0],!1),!L.href)break;L.Target=wr(L.href),delete L.href,L.Target.charAt(0)=="#"&&L.Target.indexOf(".")>-1?(ne=E2(L.Target.slice(1)),L.Target="#"+ne[0]+"!"+ne[1]):L.Target.match(/^\.\.[\\\/]/)&&(L.Target=L.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var te={Sheets:h,SheetNames:p,Workbook:U};return r.bookSheets&&delete te.Sheets,te}function gj(t,e){e=e||{},oi(t,"META-INF/manifest.xml")&&$se(Bn(t,"META-INF/manifest.xml"),e);var r=La(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=LI(Or(r),e);return oi(t,"meta.xml")&&(n.Props=TL(Bn(t,"meta.xml"))),n}function mj(t,e){return LI(t,e)}var m0e=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+$g({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Mn+e}}(),pj=function(){var t=function(a){return Mr(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var l=[];l.push('      <table:table table:name="'+Mr(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,g=Na(a["!ref"]||"A1"),h=a["!merges"]||[],p=0,x=Array.isArray(a);if(a["!cols"])for(d=0;d<=g.e.c;++d)l.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var v="",w=a["!rows"]||[];for(u=0;u<g.s.r;++u)v=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+v+`></table:table-row>
`);for(;u<=g.e.r;++u){for(v=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+v+`>
`),d=0;d<g.s.c;++d)l.push(e);for(;d<=g.e.c;++d){var S=!1,_={},y="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>d)&&!(h[p].s.r>u)&&!(h[p].e.c<d)&&!(h[p].e.r<u)){(h[p].s.c!=d||h[p].s.r!=u)&&(S=!0),_["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,_["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(S){l.push(r);continue}var k=Kt({r:u,c:d}),N=x?(a[u]||[])[d]:a[k];if(N&&N.f&&(_["table:formula"]=Mr(Mue(N.f)),N.F&&N.F.slice(0,k.length)==k)){var E=Na(N.F);_["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,_["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!N){l.push(e);continue}switch(N.t){case"b":y=N.v?"TRUE":"FALSE",_["office:value-type"]="boolean",_["office:boolean-value"]=N.v?"true":"false";break;case"n":y=N.w||String(N.v||0),_["office:value-type"]="float",_["office:value"]=N.v||0;break;case"s":case"str":y=N.v==null?"":N.v,_["office:value-type"]="string";break;case"d":y=N.w||qr(N.v).toISOString(),_["office:value-type"]="date",_["office:date-value"]=qr(N.v).toISOString(),_["table:style-name"]="ce1";break;default:l.push(e);continue}var A=t(y);if(N.l&&N.l.Target){var C=N.l.Target;C=C.charAt(0)=="#"?"#"+Lue(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),A=xt("text:a",A,{"xlink:href":C.replace(/&/g,"&amp;")})}l.push("          "+xt("table:table-cell",xt("text:p",A,{}),_)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var g=u["!cols"][d];if(g.width==null&&g.wpx==null&&g.wch==null)continue;_c(g),g.ods=o;var h=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++o}}});var l=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=l;var g=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var l=[Mn],u=$g({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=$g({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+d+`>
`),l.push(CL().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),s(l,i),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var g=0;g!=i.SheetNames.length;++g)l.push(n(i.Sheets[i.SheetNames[g]],i,g));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function II(t,e){if(e.bookType=="fods")return pj(t,e);var r=ZT(),n="",s=[],a=[];return n="mimetype",ar(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ar(r,n,pj(t,e)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",ar(r,n,m0e(t,e)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",ar(r,n,Mn+CL()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",ar(r,n,Hse(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ar(r,n,Wse(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ed(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function qS(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Or(Uc(t))}function p0e(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ma(wo(t))}function x0e(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Sc(t){var e=t.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function xj(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function y0e(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function v0e(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)t[e+a]=s&255;t[e+15]|=r>=0?0:128}function Yg(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Pr(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Cn(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Cr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=Yg(t,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:i=4,o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Yg(t,r),o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};e[s]==null?e[s]=[u]:e[s].push(u)}return e}function ys(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push(Pr(n*8+s.type)),s.type==2&&e.push(Pr(s.data.length)),e.push(s.data))})}),Sc(e)}function T4(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function si(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=Yg(t,n),a=Cr(t.slice(n[0],n[0]+s));n[0]+=s;var i={id:Cn(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=Cr(o.data),u=Cn(l[3][0].data);i.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=a[3])!=null&&e[0]&&(i.merge=Cn(a[3][0].data)>>>0>0),r.push(i)}return r}function Wd(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Pr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Pr(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:Pr(i.data.length)}],n[2].push({data:ys(i.meta),type:2})});var a=ys(n);e.push(Pr(a.length)),e.push(a),s.forEach(function(i){return e.push(i)})}),Sc(e)}function w0e(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Yg(e,r),s=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var i=e[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=e[r[0]],o>1&&(i|=e[r[0]+1]<<8),o>2&&(i|=e[r[0]+2]<<16),o>3&&(i|=e[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(e.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,u=0;if(a==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,a==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Sc(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(s.push(s[0].slice(-l)),u-=l;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-l,-l+u))}}var d=Sc(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function ai(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(w0e(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Sc(e)}function zd(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var a=Pr(n),i=a.length;e.push(a),n<=60?(i++,e.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Sc(e)}function _0e(t,e,r,n){var s=ed(t),a=s.getUint32(4,!0),i=(n>1?12:8)+xj(a&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,d=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=xj(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var g;switch(t[2]){case 0:break;case 2:g={t:"n",v:u};break;case 3:g={t:"s",v:e[l]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:u>0};break;case 7:g={t:"n",v:u/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else if(l>-1)g={t:"s",v:e[l]};else if(!isNaN(u))g={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return g}function b0e(t,e,r){var n=ed(t),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(l=y0e(t,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var g;switch(t[1]){case 0:break;case 2:g={t:"n",v:l};break;case 3:g={t:"s",v:e[o]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:u>0};break;case 7:g={t:"n",v:u/86400};break;case 8:g={t:"e",v:0};break;case 9:if(i>-1)g={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:g={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return g}function A2(t,e){var r=new Uint8Array(32),n=ed(r),s=12,a=0;switch(r[0]=5,t.t){case"n":r[1]=2,v0e(r,s,t.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),a|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,a,!0),r.slice(0,s)}function j2(t,e){var r=new Uint8Array(32),n=ed(r),s=12,a=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),a|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,a,!0),r.slice(0,s)}function S0e(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return _0e(t,e,r,t[0]);case 5:return b0e(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Is(t){var e=Cr(t);return Yg(e[1][0].data)}function yj(t,e){var r=Cr(e.data),n=Cn(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Cr(i.data),l=Cn(o[1][0].data)>>>0;switch(n){case 1:a[l]=qS(o[3][0].data);break;case 8:{var u=t[Is(o[9][0].data)][0],d=Cr(u.data),g=t[Is(d[1][0].data)][0],h=Cn(g.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=Cr(g.data);a[l]=p[3].map(function(x){return qS(x.data)}).join("")}break}}),a}function k0e(t,e){var r,n,s,a,i,o,l,u,d,g,h,p,x,v,w=Cr(t),S=Cn(w[1][0].data)>>>0,_=Cn(w[2][0].data)>>>0,y=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Cn(w[8][0].data)>0||!1,k,N;if((a=(s=w[7])==null?void 0:s[0])!=null&&a.data&&e!=0)k=(o=(i=w[7])==null?void 0:i[0])==null?void 0:o.data,N=(u=(l=w[6])==null?void 0:l[0])==null?void 0:u.data;else if((g=(d=w[4])==null?void 0:d[0])!=null&&g.data&&e!=1)k=(p=(h=w[4])==null?void 0:h[0])==null?void 0:p.data,N=(v=(x=w[3])==null?void 0:x[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var E=y?4:1,A=ed(k),C=[],F=0;F<k.length/2;++F){var D=A.getUint16(F*2,!0);D<65535&&C.push([F,D])}if(C.length!=_)throw"Expected ".concat(_," cells, found ").concat(C.length);var R=[];for(F=0;F<C.length-1;++F)R[C[F][0]]=N.subarray(C[F][1]*E,C[F+1][1]*E);return C.length>=1&&(R[C[C.length-1][0]]=N.subarray(C[C.length-1][1]*E)),{R:S,cells:R}}function C0e(t,e){var r,n=Cr(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Cn(n[7][0].data)>>>0>0?1:0:-1,a=T4(n[5],function(i){return k0e(i,s)});return{nrows:Cn(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=l}),i},[])}}function T0e(t,e,r){var n,s=Cr(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Cn(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Cn(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=sr(a);var i=Cr(s[4][0].data),o=yj(t,t[Is(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?yj(t,t[Is(i[17][0].data)][0]):[],u=Cr(i[3][0].data),d=0;u[1].forEach(function(g){var h=Cr(g.data),p=t[Is(h[2][0].data)][0],x=Cn(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var v=C0e(t,p);v.data.forEach(function(w,S){w.forEach(function(_,y){var k=Kt({r:d+S,c:y}),N=S0e(_,o,l);N&&(r[k]=N)})}),d+=v.nrows})}function E0e(t,e){var r=Cr(e.data),n={"!ref":"A1"},s=t[Is(r[2][0].data)],a=Cn(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return T0e(t,s[0],n),n}function N0e(t,e){var r,n=Cr(e.data),s={name:(r=n[1])!=null&&r[0]?qS(n[1][0].data):"",sheets:[]},a=T4(n[2],Is);return a.forEach(function(i){t[i].forEach(function(o){var l=Cn(o.meta[1][0].data);l==6e3&&s.sheets.push(E0e(t,o))})}),s}function A0e(t,e){var r=F4(),n=Cr(e.data),s=T4(n[1],Is);if(s.forEach(function(a){t[a].forEach(function(i){var o=Cn(i.meta[1][0].data);if(o==2){var l=N0e(t,i);l.sheets.forEach(function(u,d){P4(r,u,d==0?l.name:l.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function F2(t){var e,r,n,s,a={},i=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=ai(l.content)}catch(g){return console.log("?? "+l.content.length+" "+(g.message||g))}var d;try{d=si(u)}catch(g){return console.log("## "+(g.message||g))}d.forEach(function(g){a[g.id]=g.messages,i.push(g.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=a==null?void 0:a[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Cn(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(u){var d=Cn(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return A0e(a,o)}function j0e(t,e,r){var n,s,a,i;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=t[8])==null?void 0:a[0])==null?void 0:i.data)&&Cn(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=ed(t[7][0].data),d=0,g=[],h=ed(t[4][0].data),p=0,x=[],v=0;v<e.length;++v){if(e[v]==null){u.setUint16(v*2,65535,!0),h.setUint16(v*2,65535);continue}u.setUint16(v*2,d,!0),h.setUint16(v*2,p,!0);var w,S;switch(typeof e[v]){case"string":w=A2({t:"s",v:e[v]},r),S=j2({t:"s",v:e[v]},r);break;case"number":w=A2({t:"n",v:e[v]},r),S=j2({t:"n",v:e[v]},r);break;case"boolean":w=A2({t:"b",v:e[v]},r),S=j2({t:"b",v:e[v]},r);break;default:throw new Error("Unsupported value "+e[v])}g.push(w),d+=w.length,x.push(S),p+=S.length,++l}for(t[2][0].data=Pr(l);v<t[7][0].data.length/2;++v)u.setUint16(v*2,65535,!0),h.setUint16(v*2,65535,!0);return t[6][0].data=Sc(g),t[3][0].data=Sc(x),l}function F0e(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Na(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(sr(n)));var a=ay(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(K){return K.forEach(function(Q){typeof Q=="string"&&i.push(Q)})});var o={},l=[],u=Wt.read(e.numbers,{type:"base64"});u.FileIndex.map(function(K,Q){return[K,u.FullPaths[Q]]}).forEach(function(K){var Q=K[0],q=K[1];if(Q.type==2&&Q.name.match(/\.iwa/)){var se=Q.content,W=ai(se),ee=si(W);ee.forEach(function(ve){l.push(ve.id),o[ve.id]={deps:[],location:q,type:Cn(ve.messages[0].meta[1][0].data)}})}}),l.sort(function(K,Q){return K-Q});var d=l.filter(function(K){return K>1}).map(function(K){return[K,Pr(K)]});u.FileIndex.map(function(K,Q){return[K,u.FullPaths[Q]]}).forEach(function(K){var Q=K[0];if(K[1],!!Q.name.match(/\.iwa/)){var q=si(ai(Q.content));q.forEach(function(se){se.messages.forEach(function(W){d.forEach(function(ee){se.messages.some(function(ve){return Cn(ve.meta[1][0].data)!=11006&&x0e(ve.data,ee[1])})&&o[ee[0]].deps.push(se.id)})})})}});for(var g=Wt.find(u,o[1].location),h=si(ai(g.content)),p,x=0;x<h.length;++x){var v=h[x];v.id==1&&(p=v)}var w=Is(Cr(p.messages[0].data)[1][0].data);for(g=Wt.find(u,o[w].location),h=si(ai(g.content)),x=0;x<h.length;++x)v=h[x],v.id==w&&(p=v);for(w=Is(Cr(p.messages[0].data)[2][0].data),g=Wt.find(u,o[w].location),h=si(ai(g.content)),x=0;x<h.length;++x)v=h[x],v.id==w&&(p=v);for(w=Is(Cr(p.messages[0].data)[2][0].data),g=Wt.find(u,o[w].location),h=si(ai(g.content)),x=0;x<h.length;++x)v=h[x],v.id==w&&(p=v);var S=Cr(p.messages[0].data);{S[6][0].data=Pr(n.e.r+1),S[7][0].data=Pr(n.e.c+1);var _=Is(S[46][0].data),y=Wt.find(u,o[_].location),k=si(ai(y.content));{for(var N=0;N<k.length&&k[N].id!=_;++N);if(k[N].id!=_)throw"Bad ColumnRowUIDMapArchive";var E=Cr(k[N].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var A=0;A<=n.e.c;++A){var C=[];C[1]=C[2]=[{type:0,data:Pr(A+420690)}],E[1].push({type:2,data:ys(C)}),E[2].push({type:0,data:Pr(A)}),E[3].push({type:0,data:Pr(A)})}E[4]=[],E[5]=[],E[6]=[];for(var F=0;F<=n.e.r;++F)C=[],C[1]=C[2]=[{type:0,data:Pr(F+726270)}],E[4].push({type:2,data:ys(C)}),E[5].push({type:0,data:Pr(F)}),E[6].push({type:0,data:Pr(F)});k[N].messages[0].data=ys(E)}y.content=zd(Wd(k)),y.size=y.content.length,delete S[46];var D=Cr(S[4][0].data);{D[7][0].data=Pr(n.e.r+1);var R=Cr(D[1][0].data),M=Is(R[2][0].data);y=Wt.find(u,o[M].location),k=si(ai(y.content));{if(k[0].id!=M)throw"Bad HeaderStorageBucket";var B=Cr(k[0].messages[0].data);for(F=0;F<a.length;++F){var J=Cr(B[2][0].data);J[1][0].data=Pr(F),J[4][0].data=Pr(a[F].length),B[2][F]={type:B[2][0].type,data:ys(J)}}k[0].messages[0].data=ys(B)}y.content=zd(Wd(k)),y.size=y.content.length;var X=Is(D[2][0].data);y=Wt.find(u,o[X].location),k=si(ai(y.content));{if(k[0].id!=X)throw"Bad HeaderStorageBucket";for(B=Cr(k[0].messages[0].data),A=0;A<=n.e.c;++A)J=Cr(B[2][0].data),J[1][0].data=Pr(A),J[4][0].data=Pr(n.e.r+1),B[2][A]={type:B[2][0].type,data:ys(J)};k[0].messages[0].data=ys(B)}y.content=zd(Wd(k)),y.size=y.content.length;var z=Is(D[4][0].data);(function(){for(var K=Wt.find(u,o[z].location),Q=si(ai(K.content)),q,se=0;se<Q.length;++se){var W=Q[se];W.id==z&&(q=W)}var ee=Cr(q.messages[0].data);{ee[3]=[];var ve=[];i.forEach(function(te,Ne){ve[1]=[{type:0,data:Pr(Ne)}],ve[2]=[{type:0,data:Pr(1)}],ve[3]=[{type:2,data:p0e(te)}],ee[3].push({type:2,data:ys(ve)})})}q.messages[0].data=ys(ee);var _e=Wd(Q),Le=zd(_e);K.content=Le,K.size=K.content.length})();var H=Cr(D[3][0].data);{var U=H[1][0];delete H[2];var L=Cr(U.data);{var ne=Is(L[2][0].data);(function(){for(var K=Wt.find(u,o[ne].location),Q=si(ai(K.content)),q,se=0;se<Q.length;++se){var W=Q[se];W.id==ne&&(q=W)}var ee=Cr(q.messages[0].data);{delete ee[6],delete H[7];var ve=new Uint8Array(ee[5][0].data);ee[5]=[];for(var _e=0,Le=0;Le<=n.e.r;++Le){var te=Cr(ve);_e+=j0e(te,a[Le],i),te[1][0].data=Pr(Le),ee[5].push({data:ys(te),type:2})}ee[1]=[{type:0,data:Pr(n.e.c+1)}],ee[2]=[{type:0,data:Pr(n.e.r+1)}],ee[3]=[{type:0,data:Pr(_e)}],ee[4]=[{type:0,data:Pr(n.e.r+1)}]}q.messages[0].data=ys(ee);var Ne=Wd(Q),Ce=zd(Ne);K.content=Ce,K.size=K.content.length})()}U.data=ys(L)}D[3][0].data=ys(H)}S[4][0].data=ys(D)}p.messages[0].data=ys(S);var de=Wd(h),G=zd(de);return g.content=G,g.size=g.content.length,u}function OI(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function E4(t){OI([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function N4(t){OI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function P0e(t){return ur.WS.indexOf(t)>-1?"sheet":t==ur.CS?"chart":t==ur.DS?"dialog":t==ur.MS?"macro":t&&t.length?t:"sheet"}function D0e(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,P0e(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function R0e(t,e,r,n,s,a,i,o,l,u,d,g){try{a[n]=Y0(La(t,r,!0),e);var h=Bn(t,e),p;switch(o){case"sheet":p=rhe(h,e,s,l,a[n],u,d,g);break;case"chart":if(p=nhe(h,e,s,l,a[n],u,d,g),!p||!p["!drawel"])break;var x=C0(p["!drawel"].Target,e),v=zg(x),w=zle(La(t,x,!0),Y0(La(t,v,!0),x)),S=C0(w,x),_=zg(S);p=jfe(La(t,S,!0),S,l,Y0(La(t,_,!0),S),u,p);break;case"macro":p=she(h,e,s,l,a[n],u,d,g);break;case"dialog":p=ahe(h,e,s,l,a[n],u,d,g);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var y=[];a&&a[n]&&Tn(a[n]).forEach(function(k){var N="";if(a[n][k].Type==ur.CMNT){N=C0(a[n][k].Target,e);var E=che(Bn(t,N,!0),N,l);if(!E||!E.length)return;nj(p,E,!1)}a[n][k].Type==ur.TCMNT&&(N=C0(a[n][k].Target,e),y=y.concat(Gle(Bn(t,N,!0),l)))}),y&&y.length&&nj(p,y,!0,l.people||[])}catch(k){if(l.WTF)throw k}}function ri(t){return t.charAt(0)=="/"?t.slice(1):t}function M0e(t,e){if(jh(),e=e||{},E4(e),oi(t,"META-INF/manifest.xml")||oi(t,"objectdata.xml"))return gj(t,e);if(oi(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof F2<"u"){if(t.FileIndex)return F2(t);var r=Wt.utils.cfb_new();return k8(t).forEach(function(J){ar(r,J,Vne(t,J))}),F2(r)}throw new Error("Unsupported NUMBERS file")}if(!oi(t,"[Content_Types].xml"))throw oi(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):oi(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=k8(t),s=Bse(La(t,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Bn(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Bn(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},u={};if(!e.bookSheets&&!e.bookProps){if(J0=[],s.sst)try{J0=lhe(Bn(t,ri(s.sst)),s.sst,e)}catch(J){if(e.WTF)throw J}e.cellStyles&&s.themes.length&&(l=ohe(La(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(u=ihe(Bn(t,ri(s.style)),s.style,l,e))}s.links.map(function(J){try{var X=Y0(La(t,zg(ri(J))),J);return dhe(Bn(t,ri(J)),X,J,e)}catch{}});var d=the(Bn(t,ri(s.workbooks[0])),s.workbooks[0],e),g={},h="";s.coreprops.length&&(h=Bn(t,ri(s.coreprops[0]),!0),h&&(g=TL(h)),s.extprops.length!==0&&(h=Bn(t,ri(s.extprops[0]),!0),h&&Vse(h,g,e)));var p={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(h=La(t,ri(s.custprops[0]),!0),h&&(p=Xse(h,e)));var x={};if((e.bookSheets||e.bookProps)&&(d.Sheets?i=d.Sheets.map(function(X){return X.name}):g.Worksheets&&g.SheetNames.length>0&&(i=g.SheetNames),e.bookProps&&(x.Props=g,x.Custprops=p),e.bookSheets&&typeof i<"u"&&(x.SheetNames=i),e.bookSheets?x.SheetNames:e.bookProps))return x;i={};var v={};e.bookDeps&&s.calcchain&&(v=uhe(Bn(t,ri(s.calcchain)),s.calcchain));var w=0,S={},_,y;{var k=d.Sheets;g.Worksheets=k.length,g.SheetNames=[];for(var N=0;N!=k.length;++N)g.SheetNames[N]=k[N].name}var E=a?"bin":"xml",A=s.workbooks[0].lastIndexOf("/"),C=(s.workbooks[0].slice(0,A+1)+"_rels/"+s.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");oi(t,C)||(C="xl/_rels/workbook."+E+".rels");var F=Y0(La(t,C,!0),C.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=fhe(Bn(t,ri(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=Kle(Bn(t,ri(s.people[0])),e)),F&&(F=D0e(F,d.Sheets));var D=Bn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=g.Worksheets;++w){var R="sheet";if(F&&F[w]?(_="xl/"+F[w][1].replace(/[\/]?xl\//,""),oi(t,_)||(_=F[w][1]),oi(t,_)||(_=C.replace(/_rels\/.*$/,"")+F[w][1]),R=F[w][2]):(_="xl/worksheets/sheet"+(w+1-D)+"."+E,_=_.replace(/sheet0\./,"sheet.")),y=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(g.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var M=!1,B=0;B!=e.sheets.length;++B)typeof e.sheets[B]=="number"&&e.sheets[B]==w&&(M=1),typeof e.sheets[B]=="string"&&e.sheets[B].toLowerCase()==g.SheetNames[w].toLowerCase()&&(M=1);if(!M)continue e}}R0e(t,_,y,g.SheetNames[w],w,S,i,R,e,d,l,u)}return x={Directory:s,Workbook:d,Props:g,Custprops:p,Deps:v,Sheets:i,SheetNames:g.SheetNames,Strings:J0,Styles:u,Themes:l,SSF:Zr(Gt)},e&&e.bookFiles&&(t.files?(x.keys=n,x.files=t.files):(x.keys=[],x.files={},t.FullPaths.forEach(function(J,X){J=J.replace(/^Root Entry[\/]/,""),x.keys.push(J),x.files[J]=t.FileIndex[X]}))),e&&e.bookVBA&&(s.vba.length>0?x.vbaraw=Bn(t,ri(s.vba[0]),!0):s.defaults&&s.defaults.bin===tce&&(x.vbaraw=Bn(t,"xl/vbaProject.bin",!0))),x}function L0e(t,e){var r=e||{},n="Workbook",s=Wt.find(t,n);try{if(n="/!DataSpaces/Version",s=Wt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(foe(s.content),n="/!DataSpaces/DataSpaceMap",s=Wt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=goe(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Wt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=moe(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Wt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);xoe(s.content)}catch{}if(n="/EncryptionInfo",s=Wt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=yoe(s.content);if(n="/EncryptedPackage",s=Wt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function I0e(t,e){return e.bookType=="ods"?II(t,e):e.bookType=="numbers"?F0e(t,e):e.bookType=="xlsb"?O0e(t,e):B0e(t,e)}function O0e(t,e){pf=1024,t&&!t.SSF&&(t.SSF=Zr(Gt)),t&&t.SSF&&(jh(),Bv(t.SSF),e.revssf=$v(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Q0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=dI.indexOf(e.bookType)>-1,s=h4();N4(e=e||{});var a=ZT(),i="",o=0;if(e.cellXfs=[],Wc(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),i="docProps/core.xml",ar(a,i,EL(t.Props,e)),s.coreprops.push(i),Rr(e.rels,2,i,ur.CORE_PROPS),i="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,ar(a,i,jL(t.Props)),s.extprops.push(i),Rr(e.rels,3,i,ur.EXT_PROPS),t.Custprops!==t.Props&&Tn(t.Custprops||{}).length>0&&(i="docProps/custom.xml",ar(a,i,FL(t.Custprops)),s.custprops.push(i),Rr(e.rels,4,i,ur.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},g=t.Sheets[t.SheetNames[o-1]],h=(g||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,ar(a,i,ghe(o-1,i,e,t,d)),s.sheets.push(i),Rr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,ur.WS[0])}if(g){var p=g["!comments"],x=!1,v="";p&&p.length>0&&(v="xl/comments"+o+"."+r,ar(a,v,xhe(p,v)),s.comments.push(v),Rr(d,-1,"../comments"+o+"."+r,ur.CMNT),x=!0),g["!legacy"]&&x&&ar(a,"xl/drawings/vmlDrawing"+o+".vml",cI(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}d["!id"].rId1&&ar(a,zg(i),Ff(d))}return e.Strings!=null&&e.Strings.length>0&&(i="xl/sharedStrings."+r,ar(a,i,phe(e.Strings,i,e)),s.strs.push(i),Rr(e.wbrels,-1,"sharedStrings."+r,ur.SST)),i="xl/workbook."+r,ar(a,i,hhe(t,i)),s.workbooks.push(i),Rr(e.rels,1,i,ur.WB),i="xl/theme/theme1.xml",ar(a,i,v4(t.Themes,e)),s.themes.push(i),Rr(e.wbrels,-1,"theme/theme1.xml",ur.THEME),i="xl/styles."+r,ar(a,i,mhe(t,i,e)),s.styles.push(i),Rr(e.wbrels,-1,"styles."+r,ur.STY),t.vbaraw&&n&&(i="xl/vbaProject.bin",ar(a,i,t.vbaraw),s.vba.push(i),Rr(e.wbrels,-1,"vbaProject.bin",ur.VBA)),i="xl/metadata."+r,ar(a,i,yhe(i)),s.metadata.push(i),Rr(e.wbrels,-1,"metadata."+r,ur.XLMETA),ar(a,"[Content_Types].xml",kL(s,e)),ar(a,"_rels/.rels",Ff(e.rels)),ar(a,"xl/_rels/workbook."+r+".rels",Ff(e.wbrels)),delete e.revssf,delete e.ssf,a}function B0e(t,e){pf=1024,t&&!t.SSF&&(t.SSF=Zr(Gt)),t&&t.SSF&&(jh(),Bv(t.SSF),e.revssf=$v(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Q0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=dI.indexOf(e.bookType)>-1,s=h4();N4(e=e||{});var a=ZT(),i="",o=0;if(e.cellXfs=[],Wc(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),i="docProps/core.xml",ar(a,i,EL(t.Props,e)),s.coreprops.push(i),Rr(e.rels,2,i,ur.CORE_PROPS),i="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,ar(a,i,jL(t.Props)),s.extprops.push(i),Rr(e.rels,3,i,ur.EXT_PROPS),t.Custprops!==t.Props&&Tn(t.Custprops||{}).length>0&&(i="docProps/custom.xml",ar(a,i,FL(t.Custprops)),s.custprops.push(i),Rr(e.rels,4,i,ur.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var g={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,ar(a,i,bI(o-1,e,t,g)),s.sheets.push(i),Rr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,ur.WS[0])}if(h){var x=h["!comments"],v=!1,w="";if(x&&x.length>0){var S=!1;x.forEach(function(_){_[1].forEach(function(y){y.T==!0&&(S=!0)})}),S&&(w="xl/threadedComments/threadedComment"+o+"."+r,ar(a,w,Vle(x,d,e)),s.threadedcomments.push(w),Rr(g,-1,"../threadedComments/threadedComment"+o+"."+r,ur.TCMNT)),w="xl/comments"+o+"."+r,ar(a,w,uI(x)),s.comments.push(w),Rr(g,-1,"../comments"+o+"."+r,ur.CMNT),v=!0}h["!legacy"]&&v&&ar(a,"xl/drawings/vmlDrawing"+o+".vml",cI(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}g["!id"].rId1&&ar(a,zg(i),Ff(g))}return e.Strings!=null&&e.Strings.length>0&&(i="xl/sharedStrings."+r,ar(a,i,QL(e.Strings,e)),s.strs.push(i),Rr(e.wbrels,-1,"sharedStrings."+r,ur.SST)),i="xl/workbook."+r,ar(a,i,EI(t)),s.workbooks.push(i),Rr(e.rels,1,i,ur.WB),i="xl/theme/theme1.xml",ar(a,i,v4(t.Themes,e)),s.themes.push(i),Rr(e.wbrels,-1,"theme/theme1.xml",ur.THEME),i="xl/styles."+r,ar(a,i,aI(t,e)),s.styles.push(i),Rr(e.wbrels,-1,"styles."+r,ur.STY),t.vbaraw&&n&&(i="xl/vbaProject.bin",ar(a,i,t.vbaraw),s.vba.push(i),Rr(e.wbrels,-1,"vbaProject.bin",ur.VBA)),i="xl/metadata."+r,ar(a,i,lI()),s.metadata.push(i),Rr(e.wbrels,-1,"metadata."+r,ur.XLMETA),d.length>1&&(i="xl/persons/person.xml",ar(a,i,Xle(d)),s.people.push(i),Rr(e.wbrels,-1,"persons/person.xml",ur.PEOPLE)),ar(a,"[Content_Types].xml",kL(s,e)),ar(a,"_rels/.rels",Ff(e.rels)),ar(a,"xl/_rels/workbook."+r+".rels",Ff(e.wbrels)),delete e.revssf,delete e.ssf,a}function A4(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=$a(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function U0e(t,e){return Wt.find(t,"EncryptedPackage")?L0e(t,e):FI(t,e)}function $0e(t,e){var r,n=t,s=e||{};return s.type||(s.type=lr&&Buffer.isBuffer(t)?"buffer":"base64"),r=ZM(n,s),M0e(r,s)}function BI(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return JS(t.slice(r),e);default:break e}return th.to_workbook(t,e)}function W0e(t,e){var r="",n=A4(t,e);switch(e.type){case"base64":r=$a(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Ju(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Or(r)),e.type="binary",BI(r,e)}function z0e(t,e){var r=t;return e.type=="base64"&&(r=$a(r)),r=Ig.utils.decode(1200,r.slice(2),"str"),e.type="binary",BI(r,e)}function H0e(t){return t.match(/[^\x00-\x7F]/)?wo(t):t}function P2(t,e,r,n){return n?(r.type="string",th.to_workbook(t,r)):th.to_workbook(e,r)}function ZS(t,e){XT();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return ZS(new Uint8Array(t),(r=Zr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Df={},r.dateNF&&(Df.dateNF=r.dateNF),r.type||(r.type=lr&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=lr?"buffer":"binary",n=One(t),typeof Uint8Array<"u"&&!lr&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=H0e(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Zr(r),r.type="array",ZS(YT(n),r)}switch((s=A4(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return U0e(Wt.read(n,r),r);break;case 9:if(s[1]<=8)return FI(n,r);break;case 60:return JS(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return Yie(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return YL.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?$0e(n,r):P2(t,n,r,a);case 239:return s[3]===60?JS(n,r):P2(t,n,r,a);case 255:if(s[1]===254)return z0e(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Nu.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Nu.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return YS.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return rI.to_workbook(n,r);break;case 10:case 13:case 32:return W0e(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Xie.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?YS.to_workbook(n,r):P2(t,n,r,a)}function UI(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Am(e.file,Wt.write(t,{type:lr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Wt.write(t,e)}function G0e(t,e){var r=Zr(e||{}),n=I0e(t,r);return V0e(n,r)}function V0e(t,e){var r={},n=lr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?Wt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(Ov(s))}return e.password&&typeof encrypt_agile<"u"?UI(encrypt_agile(s,e.password),e):e.type==="file"?Am(e.file,s):e.type=="string"?Or(s):s}function K0e(t,e){var r=e||{},n=Hhe(t,r);return UI(n,r)}function uo(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Og(wo(n));case"binary":return wo(n);case"string":return t;case"file":return Am(e.file,n,"utf8");case"buffer":return lr?Tl(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):uo(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function X0e(t,e){switch(e.type){case"base64":return Og(t);case"binary":return t;case"string":return t;case"file":return Am(e.file,t,"binary");case"buffer":return lr?Tl(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function wx(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Og(r):e.type=="string"?Or(r):r;case"file":return Am(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function $I(t,e){XT(),Ufe(t);var r=Zr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=$I(t,r);return r.type="array",Ov(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return uo(Ihe(t,r),r);case"slk":case"sylk":return uo(XL.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return uo(DI(t.Sheets[t.SheetNames[s]],r),r);case"txt":return X0e(WI(t.Sheets[t.SheetNames[s]],r),r);case"csv":return uo(j4(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return uo(YL.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return wx(YS.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return uo(th.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return uo(rI.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return uo(JL.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return uo(II(t,r),r);case"wk1":return wx(Nu.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return wx(Nu.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),wx(PI(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),K0e(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return G0e(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Y0e(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function J0e(t,e,r){var n={};return n.type="file",n.file=e,Y0e(n),$I(t,n)}function Q0e(t,e,r,n,s,a,i,o){var l=Dn(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),g=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||t[r])for(var p=e.s.c;p<=e.e.c;++p){var x=i?t[r][p]:t[n[p]+l];if(x===void 0||x.t===void 0){if(u===void 0)continue;a[p]!=null&&(h[a[p]]=u);continue}var v=x.v;switch(x.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[p]!=null){if(v==null)if(x.t=="e"&&v===null)h[a[p]]=null;else if(u!==void 0)h[a[p]]=u;else if(d&&v===null)h[a[p]]=null;else continue;else h[a[p]]=d&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?v:yl(x,v,o);v!=null&&(g=!1)}}return{row:h,isempty:g}}function ay(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":l=_r(d);break;case"number":l=_r(t["!ref"]),l.s.r=d;break;default:l=d}n>0&&(s=0);var g=Dn(l.s.r),h=[],p=[],x=0,v=0,w=Array.isArray(t),S=l.s.r,_=0,y={};w&&!t[S]&&(t[S]=[]);var k=u.skipHidden&&t["!cols"]||[],N=u.skipHidden&&t["!rows"]||[];for(_=l.s.c;_<=l.e.c;++_)if(!(k[_]||{}).hidden)switch(h[_]=fn(_),r=w?t[S][_]:t[h[_]+g],n){case 1:a[_]=_-l.s.c;break;case 2:a[_]=h[_];break;case 3:a[_]=u.header[_-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=yl(r,null,u),v=y[i]||0,!v)y[i]=1;else{do o=i+"_"+v++;while(y[o]);y[i]=v,y[o]=1}a[_]=o}for(S=l.s.r+s;S<=l.e.r;++S)if(!(N[S]||{}).hidden){var E=Q0e(t,l,S,h,n,a,w,u);(E.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[x++]=E.row)}return p.length=x,p}var vj=/"/g;function q0e(t,e,r,n,s,a,i,o){for(var l=!0,u=[],d="",g=Dn(r),h=e.s.c;h<=e.e.c;++h)if(n[h]){var p=o.dense?(t[r]||[])[h]:t[n[h]+g];if(p==null)d="";else if(p.v!=null){l=!1,d=""+(o.rawNumbers&&p.t=="n"?p.v:yl(p,null,o));for(var x=0,v=0;x!==d.length;++x)if((v=d.charCodeAt(x))===s||v===a||v===34||o.forceQuotes){d='"'+d.replace(vj,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(l=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(vj,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&l?null:u.join(i)}function j4(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=_r(t["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",g=[];n.dense=Array.isArray(t);for(var h=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(h[x]||{}).hidden||(g[x]=fn(x));for(var v=0,w=s.s.r;w<=s.e.r;++w)(p[w]||{}).hidden||(d=q0e(t,s,w,g,i,l,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((v++?o:"")+d)));return delete n.dense,r.join("")}function WI(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=j4(t,e);return r}function Z0e(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=_r(t["!ref"]),a="",i=[],o,l=[],u=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)i[o]=fn(o);for(var d=s.s.r;d<=s.e.r;++d)for(a=Dn(d),o=s.s.c;o<=s.e.c;++o)if(e=i[o]+a,r=u?(t[d]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function zI(t,e,r){var n=r||{},s=+!n.skipHeader,a=t||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?hn(n.origin):n.origin;i=l.r,o=l.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+e.length-1+s}};if(a["!ref"]){var g=_r(a["!ref"]);d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),i==-1&&(i=g.e.r+1,d.e.r=i+e.length-1+s)}else i==-1&&(i=0,d.e.r=e.length-1+s);var h=n.header||[],p=0;e.forEach(function(v,w){Tn(v).forEach(function(S){(p=h.indexOf(S))==-1&&(h[p=h.length]=S);var _=v[S],y="z",k="",N=Kt({c:o+p,r:i+w+s});u=Jg(a,N),_&&typeof _=="object"&&!(_ instanceof Date)?a[N]=_:(typeof _=="number"?y="n":typeof _=="boolean"?y="b":typeof _=="string"?y="s":_ instanceof Date?(y="d",n.cellDates||(y="n",_=ts(_)),k=n.dateNF||Gt[14]):_===null&&n.nullError&&(y="e",_=0),u?(u.t=y,u.v=_,delete u.w,delete u.R,k&&(u.z=k)):a[N]=u={t:y,v:_},k&&(u.z=k))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var x=Dn(i);if(s)for(p=0;p<h.length;++p)a[fn(p+o)+x]={t:"s",v:h[p]};return a["!ref"]=sr(d),a}function ege(t,e){return zI(null,t,e)}function Jg(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=hn(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Jg(t,Kt(e)):Jg(t,Kt({r:e,c:r||0}))}function tge(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function F4(){return{SheetNames:[],Sheets:{}}}function P4(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=i+s)!=-1;++s);}if(TI(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function rge(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=tge(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function nge(t,e){return t.z=e,t}function HI(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function sge(t,e,r){return HI(t,"#"+e,r)}function age(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function ige(t,e,r,n){for(var s=typeof e!="string"?e:_r(e),a=typeof e=="string"?e:sr(e),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=Jg(t,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var zx={encode_col:fn,encode_row:Dn,encode_cell:Kt,encode_range:sr,decode_col:o4,decode_row:i4,split_cell:pse,decode_cell:hn,decode_range:Na,format_cell:yl,sheet_add_aoa:xL,sheet_add_json:zI,sheet_add_dom:RI,aoa_to_sheet:Fh,json_to_sheet:ege,table_to_sheet:MI,table_to_book:f0e,sheet_to_csv:j4,sheet_to_txt:WI,sheet_to_json:ay,sheet_to_html:DI,sheet_to_formulae:Z0e,sheet_to_row_object_array:ay,sheet_get_cell:Jg,book_new:F4,book_append_sheet:P4,book_set_sheet_visibility:rge,cell_set_number_format:nge,cell_set_hyperlink:HI,cell_set_internal_link:sge,cell_add_comment:age,sheet_set_array_formula:ige,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const GI=({onBackToCabinet:t,selectedGrade:e,selectedClass:r,openRetestModal:n})=>{Ha(),ky();const{user:s,isAuthenticated:a}=xn(),{showNotification:i}=Ys(),o=b.useCallback(V=>{let ie=null;if(typeof(V==null?void 0:V.percentage)=="number"&&!Number.isNaN(V.percentage))return ie=Math.round(V.percentage),console.debug("[TeacherResults] Using provided percentage",{percentage:V.percentage,rounded:ie,result:V}),ie;const we=(V==null?void 0:V.retest_best_score)??(V==null?void 0:V.score),me=(V==null?void 0:V.retest_best_max_score)??(V==null?void 0:V.max_score),Te=Number(we??0),I=Number(me??0);return I>0&&(ie=Math.round(Te/I*100)),console.debug("[TeacherResults] Computed percentage",{score:V==null?void 0:V.score,max_score:V==null?void 0:V.max_score,retest_best_score:V==null?void 0:V.retest_best_score,retest_best_max_score:V==null?void 0:V.retest_best_max_score,derived:ie,result:V}),ie},[]);b.useCallback(V=>{const ie=o(V);return ie===null?"bg-gray-100 text-gray-800":ie<50?"bg-red-100 text-red-700":ie<70?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"},[o]),b.useCallback(V=>{const ie=o(V);return ie!==null&&ie<50},[o]);const[l,u]=b.useState(null),[d,g]=b.useState(!0),[h,p]=b.useState(""),[x,v]=b.useState([]),[w,S]=b.useState(null),[_,y]=b.useState(!1),[k,N]=b.useState([]),[E,A]=b.useState([]),[C,F]=b.useState([1,2]),[D,R]=b.useState(null),[M,B]=b.useState(null),[J,X]=b.useState(null),[z,H]=b.useState("main"),[U,L]=b.useState(null),[ne,de]=b.useState(null),G=U||e,K=ne||r,[Q,q]=b.useState(null),[se,W]=b.useState({}),[ee,ve]=b.useState(!1),[_e,Le]=b.useState(new Set),[te,Ne]=b.useState(!1),[Ce,We]=b.useState(!1),nt=b.useRef(null),[$e,De]=b.useState(null),[at,Se]=b.useState(!1),[Ae,Me]=b.useState(null),[Ie,Ge]=b.useState(""),[tt,kt]=b.useState(""),[zt,bt]=b.useState(!1),[Dt,it]=b.useState(!1),[ht,Ct]=b.useState(new Set),[jt,Fe]=b.useState({}),[et,Ze]=b.useState(!1),rt=b.useRef(new Set),dt=b.useRef({}),Tt=b.useRef(null);b.useEffect(()=>{console.log(" editingColumns state changed:",Array.from(ht)),rt.current=ht},[ht]),b.useEffect(()=>{console.log(" columnScores state changed:",jt),dt.current=jt},[jt]);const xe=b.useCallback(V=>{console.log(" Toggling test collapse for:",V),Le(ie=>{const we=new Set(ie);return we.has(V)?(we.delete(V),console.log(" Expanding test:",V)):(we.add(V),console.log(" Collapsing test:",V)),console.log(" New collapsed tests:",Array.from(we)),we})},[]),ue=b.useCallback(()=>{if(nt.current){const{scrollLeft:V,scrollWidth:ie,clientWidth:we}=nt.current;Ne(V>0),We(V<ie-we-1)}},[]);b.useEffect(()=>{Ve()},[]),b.useEffect(()=>{D&&nt.current&&setTimeout(ue,100)},[D,ue]),b.useEffect(()=>{console.log(" Current collapsed tests state:",Array.from(_e))},[_e]);const ye=b.useCallback(async(V,ie,we)=>{var me,Te,I;console.log(" Loading class results for:",V,ie,we),ve(!0);try{const Z=`${V}/${ie}`;console.log(" Formatted class name:",Z);let pe=l;pe||(console.log(" Teacher data not loaded, loading now..."),pe=await $r.getTeacherData(),u(pe));const oe=s==null?void 0:s.teacher_id;let Ee=null,Ue=M;if(Ue||(console.log(" Academic year data not loaded, loading now..."),Ue=await $t()),Ue&&Array.isArray(Ue)&&Ue.length>0){const ut=parseInt(we);console.log(" Looking for semester",ut,"in current academic year");const he=new Date,je=Ue.find(Et=>{const St=new Date(Et.start_date),re=new Date(Et.end_date);return he>=St&&he<=re}),Ye=je?je.academic_year:Ue[0].academic_year;console.log(" Current academic year:",Ye);const mt=Ue.filter(Et=>Et.academic_year===Ye);console.log(" Current year periods:",mt);const pt=mt.filter(Et=>parseInt(Et.semester)===1),Bt=mt.filter(Et=>parseInt(Et.semester)===2);if(console.log(" Semester 1 periods:",pt),console.log(" Semester 2 periods:",Bt),ut===1?(Ee=(me=pt[0])==null?void 0:me.id,console.log(" Using semester 1 period:",pt[0])):ut===2&&(Ee=(Te=Bt[0])==null?void 0:Te.id,console.log(" Using semester 2 period:",Bt[0])),!Ee)throw new Error(`No ${ut===1?"Semester 1":"Semester 2"} data available for academic year ${Ye}`)}if(!oe||!Ee)throw console.error(" Missing data:",{teacherId:oe,academicPeriodId:Ee,academicYear:M}),new Error("Missing teacher ID or academic period ID");const Oe=await bre.getTeacherStudentResults(oe,V,Z,we,Ee);if(console.log(" Class results response:",Oe),Oe.success){console.log(" API Response details:",{results:Oe.results,students:Oe.students,count:Oe.count,student_count:Oe.student_count});const ut=[],he=new Set,je=new Set;Oe.results&&Oe.results.length>0&&Oe.results.forEach(pt=>{pt.test_name&&!he.has(pt.test_name)&&(he.add(pt.test_name),ut.push({test_name:pt.test_name,test_type:pt.test_type,subject:pt.subject})),pt.subject&&je.add(pt.subject)});const Ye=(Oe.students||[]).map(pt=>{const Bt={};return(Oe.results||[]).filter(St=>St.student_id===pt.student_id).forEach(St=>{St.test_name&&(Bt[St.test_name]={id:St.id,test_type:St.test_type,test_id:St.test_id,subject_id:St.subject_id,score:St.score,max_score:St.max_score,retest_offered:St.retest_offered,caught_cheating:St.caught_cheating,visibility_change_times:St.visibility_change_times,answers:St.answers,name:St.name,surname:St.surname,test_name:St.test_name})}),{...pt,...Bt}}),mt={results:Oe.results||[],students:Ye,class:Ye,unique_tests:ut,subjects:Array.from(je),count:Oe.count||0,student_count:Oe.student_count||0};console.log(" Processed results data:",{uniqueTests:ut.length,subjects:Array.from(je),resultsCount:((I=Oe.results)==null?void 0:I.length)||0,studentsWithScores:Ye.length,sampleStudent:Ye[0]}),R(mt),W(mt),X(new Date),Oe.students&&Oe.students.length>0?(console.log(" Student list loaded:",Oe.students.length,"students"),console.log(" Sample student:",Oe.students[0])):console.log(" No students found for this class")}else console.log(" API call failed for this class"),R(null),W(null)}catch(Z){console.error(" Error loading class results:",Z),i("Error loading class results","error"),R(null),W(null)}finally{ve(!1)}},[l,s,M,i]),be=b.useCallback(async(V,ie)=>{console.log(" Determining current semester for:",V,ie);try{if(M&&M.length>0){const we=new Date;let me=1,Te=null;for(const I of M){const Z=new Date(I.start_date),pe=new Date(I.end_date);if(console.log(" Checking period:",{period:I,semester:I.semester,semesterType:typeof I.semester,startDate:Z,endDate:pe,currentDate:we,isInRange:we>=Z&&we<=pe}),we>=Z&&we<=pe){Te=I,me=I.semester,console.log(" Found matching period:",{period:I,semester:I.semester,semesterType:typeof I.semester});break}}if(Te){console.log(" Current academic period found:",Te),console.log(" Current semester:",me);const I=me&&!isNaN(me)?me:1;console.log(" Using semester:",I),S(I),await ye(V,ie,I)}else console.log(" No current academic period found, using default semester 1"),S(1),await ye(V,ie,1)}else console.log(" No academic year data, using default semester 1"),S(1),await ye(V,ie,1)}catch(we){console.error(" Error determining current semester:",we),S(1),await ye(V,ie,1)}},[M,ye]);b.useEffect(()=>{e&&r&&(console.log(" Props detected:",{grade:e,class:r}),be(e,r))},[e,r,be]);const Ve=b.useCallback(async()=>{console.log(" Initializing teacher results...");try{if(g(!0),p(""),!a||!s){console.log(" User not authenticated"),p("User not authenticated");return}if(s.role!==ra.TEACHER){console.error(" Invalid user role for teacher results:",s.role),p("Access denied. Teacher role required.");return}console.log(" Loading teacher assignments..."),await Nt(),console.log(" Loading academic year data..."),await yt(),console.log(" Teacher results initialization complete!")}catch(V){console.error(" Error initializing teacher results:",V),p("Failed to initialize teacher results")}finally{g(!1)}},[a,s]),Nt=b.useCallback(async()=>{console.log(" Loading teacher assignments...");try{const V=`teacher_data_${(s==null?void 0:s.teacher_id)||(s==null?void 0:s.id)||""}`;let ie=nn(V);ie?console.log(" Cache HIT! Using cached teacher data"):(console.log(" Cache MISS! Fetching teacher data from API"),ie=await $r.getTeacherData(),console.log(" Teacher data loaded:",ie),zr(V,ie,Xr.teacher_subjects)),u(ie);const we=[];ie&&ie.subjects&&ie.subjects.forEach(Z=>{Z.classes&&Z.classes.forEach(pe=>{pe.grade&&pe.class&&we.push({grade:pe.grade,class:pe.class,subject:Z.name})})}),A(we),console.log(" Available classes from teacher data:",we);const me=`teacher_tests_${(s==null?void 0:s.teacher_id)||(s==null?void 0:s.id)||""}`;let Te=nn(me);Te?console.log(" Cache HIT! Using cached teacher tests"):(console.log(" Cache MISS! Fetching teacher tests from API"),Te=await Tr.getTeacherTests(),console.log(" Teacher tests loaded:",Te),zr(me,Te,Xr.teacher_tests));const I=Te.flatMap(Z=>Z.assignments||[]);v(I),console.log(" Raw assignments data:",I),console.log(" Teacher assignments loaded:",I.length)}catch(V){console.error(" Error loading teacher assignments:",V),i("Failed to load teacher assignments","error")}},[i]),yt=b.useCallback(async()=>{var V;console.log(" Loading academic year data...");try{const ie="admin_academic_years_";let we=nn(ie);we?console.log(" Cache HIT! Using cached academic year data"):(console.log(" Cache MISS! Fetching academic year from API"),we=await $r.getAcademicYear(),console.log(" Academic year response:",we),zr(ie,we,Xr.admin_academic_years)),console.log(" First academic year record:",(we==null?void 0:we[0])||((V=we==null?void 0:we.academic_years)==null?void 0:V[0])),we&&Array.isArray(we)?(B(we),console.log(" Academic year data loaded:",we.length),console.log(" Sample record fields:",Object.keys(we[0]||{}))):we&&we.academic_years?(B(we.academic_years),console.log(" Academic year data loaded:",we.academic_years.length),console.log(" Sample record fields:",Object.keys(we.academic_years[0]||{}))):console.warn(" Failed to load academic year data:",(we==null?void 0:we.error)||"No data received")}catch(ie){console.error(" Error loading academic year data:",ie)}},[]),$t=b.useCallback(async()=>{console.log(" Loading academic year data (direct return)...");try{const V="admin_academic_years_";let ie=nn(V);return ie?console.log(" Cache HIT! Using cached academic year data"):(console.log(" Cache MISS! Fetching academic year from API"),ie=await $r.getAcademicYear(),console.log(" Academic year response:",ie),zr(V,ie,Xr.admin_academic_years)),ie&&Array.isArray(ie)?(console.log(" Returning academic year data:",ie.length),ie):ie&&ie.academic_years?(console.log(" Returning academic year data:",ie.academic_years.length),ie.academic_years):(console.warn(" Failed to load academic year data:",(ie==null?void 0:ie.error)||"No data received"),null)}catch(V){return console.error(" Error loading academic year data:",V),null}},[]),Ft=b.useCallback(async(V,ie)=>{console.log(" Showing classes for grade:",V,"class:",ie),L(V),de(ie),S(null),R(null),V&&ie&&await be(V,ie)},[be]);b.useCallback((V,ie)=>{console.log(" Showing semesters for class:",V,ie),S(null),R(null),be(V,ie)},[]),b.useCallback((V,ie)=>{console.log(" Class clicked:",V,ie),y(!0),be(V,ie)},[]);const Ot=b.useCallback(async V=>{!G||!K||(console.log(" Loading results for semester:",V),S(V),await ye(G,K,V))},[G,K,ye]);b.useCallback(()=>{let V=1;if(M&&M.length>0){const ie=new Date;for(const we of M){const me=new Date(we.start_date),Te=new Date(we.end_date);if(ie>=me&&ie<=Te){V=we.semester;break}}}return c.jsx("div",{className:"flex space-x-4 mb-6",children:[1,2].map(ie=>c.jsxs(Be.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${w===ie?"bg-blue-600 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>Ot(ie),whileHover:{scale:1.05},whileTap:{scale:.95},children:["Semester ",ie,ie===V&&c.jsx("span",{className:"ml-2 text-xs",children:"(Current)"})]},ie))})},[w,Ot,M]),b.useCallback(V=>V.reduce((ie,we)=>(ie[we.student_id]||(ie[we.student_id]=[]),ie[we.student_id].push(we),ie),{}),[]),b.useCallback(V=>{if(V.length===0)return 0;const ie=V.reduce((we,me)=>we+(me.percentage||0),0);return Math.round(ie/V.length)},[]),b.useCallback(V=>{V.score<V.passing_score&&window.confirm("Give another try?")&&xr(V.student_id,V.test_id)},[]);const xr=b.useCallback(async(V,ie)=>{try{(await fetch("/.netlify/functions/reset-test-attempt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:V,testId:ie})})).ok&&(K&&Ot(w),i("Test made accessible to student","success"))}catch(we){console.error("Error resetting test attempt:",we),i("Failed to reset test attempt","error")}},[K,w,Ot,i]),yr=b.useCallback((V,ie)=>{if(V===null||ie===null)return"";const we=Math.round(V/ie*100);return we>=80?"text-green-600 bg-green-50":we>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50"},[]),qt=b.useCallback(V=>{De(V),Se(!0)},[]);b.useCallback((V,ie,we)=>{Me({resultId:V,score:ie,maxScore:we}),Ge((ie==null?void 0:ie.toString())||""),kt((we==null?void 0:we.toString())||""),it(!0)},[]),b.useCallback(V=>{Ge(V)},[]),b.useCallback(V=>{kt(V)},[]),b.useCallback(async()=>{if(Ae){bt(!0);try{const V={resultId:Ae.resultId,score:parseInt(Ie)||0,maxScore:parseInt(tt)||1};(await fetch(a8.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)})).ok?(i("Score updated successfully","success"),K&&Ot(w),Me(null),Ge(""),kt(""),it(!1)):i("Failed to update score","error")}catch(V){console.error("Error updating score:",V),i("Failed to update score","error")}finally{bt(!1)}}},[Ae,Ie,tt,K,w,Ot,i]),b.useCallback(()=>{Me(null),Ge(""),kt(""),it(!1)},[]);const hr=(V,ie)=>{if(console.log(" Starting column editing for drawing test:",V),console.log(" Current editingColumns before update:",Array.from(ht)),console.log(" Results data passed to function:",ie),Ct(we=>{const me=new Set(we).add(V);return console.log(" Updated editingColumns:",Array.from(me)),me}),console.log(" Initializing column scores for test:",V),console.log(" Results data:",ie),console.log(" Results.class:",ie?ie.class:"null"),ie&&ie.class){const we={};console.log(" Processing",ie.class.length,"students"),ie.class.forEach((me,Te)=>{console.log(` Student ${Te}:`,me.student_id,"Keys:",Object.keys(me));const I=me[V];console.log(` Student ${me.student_id} test result for ${V}:`,I),console.log(" Test result keys:",I?Object.keys(I):"null"),console.log(" Test result id:",I?I.id:"null"),I&&I.test_type==="drawing"&&(we[me.student_id]={score:(I.score||0).toString(),maxScore:(I.max_score||100).toString(),resultId:I.id})}),console.log(" Initial scores for column:",we),Fe(me=>({...me,[V]:we}))}else console.log(" No results or class data available")},Nr=b.useCallback(V=>{Ct(ie=>{const we=new Set(ie);return we.delete(V),we}),Fe(ie=>{const we={...ie};return delete we[V],we})},[]),Ln=b.useCallback((V,ie,we,me)=>{const Te=me.toString();dt.current[V]||(dt.current[V]={}),dt.current[V][ie]||(dt.current[V][ie]={}),dt.current[V][ie][we]=Te;const I=parseInt(me)||0;Fe(Z=>{var pe;return{...Z,[V]:{...Z[V],[ie]:{...(pe=Z[V])==null?void 0:pe[ie],[we]:I}}}})},[]),Y=b.useCallback(async V=>{if(dt.current[V]){Ze(!0);try{const ie=Object.entries(dt.current[V]).map(([I,Z])=>({resultId:Z.resultId,score:parseInt(Z.score)||0,maxScore:parseInt(Z.maxScore)||100}));console.log(" Saving column scores for",V,":",ie);const we=ie.map(I=>(console.log(" Sending update:",I),fetch(a8.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)})));(await Promise.all(we)).every(I=>I.ok)?(i(`Scores updated successfully for ${V}`,"success"),K&&Ot(w),Nr(V)):i("Failed to update some scores","error")}catch(ie){console.error("Error updating column scores:",ie),i("Failed to update scores","error")}finally{Ze(!1)}}},[jt,K,w,Ot,i,Nr]),fe=b.useCallback((V,ie,we)=>!ie||ie.length===0?c.jsx(Be.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:c.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):c.jsxs(Be.div,{className:"relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[te&&c.jsx("div",{className:"absolute left-0 top-1/2 transform -translate-y-1/2 z-10 bg-blue-500 text-white rounded-full p-2 shadow-lg",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),Ce&&c.jsx("div",{className:"absolute right-0 top-1/2 transform -translate-y-1/2 z-10 bg-blue-500 text-white rounded-full p-2 shadow-lg",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),c.jsxs(Be.div,{className:"bg-white rounded-lg shadow-lg overflow-hidden",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4,delay:.1},children:[c.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:me=>{nt.current&&(nt.current.scrollLeft=me.target.scrollLeft)},children:c.jsx("div",{className:"min-w-full h-1",children:c.jsx("div",{className:"h-1",style:{width:`${(we.length+5)*120}px`}})})}),c.jsx("div",{ref:nt,className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:me=>{ue(me);const Te=me.target.previousElementSibling;Te&&(Te.scrollLeft=me.target.scrollLeft)},children:c.jsxs("table",{className:"min-w-full border-collapse text-sm min-w-max",children:[c.jsx("thead",{children:c.jsxs(Be.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-20 text-center",children:"Student ID"}),c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[120px]",children:"Name"}),c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[120px]",children:"Surname"}),c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-16 text-center",children:"No."}),c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[100px]",children:"Nickname"}),we.map((me,Te)=>{const I=_e.has(me.test_name),Z=me.test_type==="drawing",pe=rt.current.has(me.test_name);return console.log(` Rendering test ${me.test_name}:`,{isDrawingTest:Z,isEditingColumn:pe,editingColumns:Array.from(rt.current),test_type:me.test_type}),c.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 cursor-pointer hover:bg-blue-200 transition-colors select-none ${I?"w-8 min-w-[32px] max-w-[32px] bg-gray-100":"min-w-[100px] bg-blue-50"}`,onClick:oe=>{oe.preventDefault(),oe.stopPropagation(),console.log(" Clicked on test header:",me.test_name),xe(me.test_name)},children:I?c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):c.jsxs("div",{className:"flex flex-col space-y-2",children:[Z&&c.jsx("div",{className:"flex justify-center",children:pe?c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:oe=>{oe.preventDefault(),oe.stopPropagation(),Y(me.test_name)},disabled:et,className:"px-2 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",children:et?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):"Save"}),c.jsx("button",{onClick:oe=>{oe.preventDefault(),oe.stopPropagation(),Nr(me.test_name)},disabled:et,className:"px-2 py-1 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):c.jsx("button",{onClick:oe=>{oe.preventDefault(),oe.stopPropagation(),console.log(" Edit Column button clicked for drawing test:",me.test_name),console.log(" Results state at button click:",D),console.log(" Current results ref:",Tt.current),hr(me.test_name,Tt.current)},className:"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:"Edit Column"})}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"truncate",title:me.test_name,children:me.test_name.length>8?me.test_name.substring(0,8)+"...":me.test_name}),c.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})},Te)})]})}),c.jsx("tbody",{children:c.jsx(va,{children:ie.map((me,Te)=>c.jsxs(Be.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${Te%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1+Te*.05,ease:"easeOut"},whileHover:{scale:1.01,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.99},children:[c.jsx(Be.td,{className:"border-b border-gray-100 px-4 py-4 text-center font-semibold text-gray-900",whileHover:{scale:1.05},transition:{duration:.2},children:me.student_id}),c.jsx(Be.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:me.name}),c.jsx(Be.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:me.surname}),c.jsx(Be.td,{className:"border-b border-gray-100 px-4 py-4 text-center text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:me.number??Te+1}),c.jsx(Be.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-600",whileHover:{scale:1.02},transition:{duration:.2},children:me.nickname||"-"}),we.map((I,Z)=>{var Ee,Ue,Oe,ut;const pe=_e.has(I.test_name),oe=me[I.test_name];return pe?(console.log(" Rendering collapsed column for test:",I.test_name),c.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:he=>{he.preventDefault(),he.stopPropagation(),console.log(" Clicked on collapsed arrow for:",I.test_name),xe(I.test_name)},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},Z)):c.jsx(Be.td,{className:"border-b border-gray-100 px-2 py-4 text-sm min-w-[100px]",initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},transition:{duration:.3},whileHover:{scale:1.02},onClick:he=>{if(console.debug("[TeacherResults] Main table TD clicked",{testResult:oe,student:me.student_id}),oe!=null&&oe.retest_offered){i("Retest is already offered","info");return}const je=o(oe);je!==null&&je<50&&(console.debug("[TeacherResults] Main table TD -> opening retest modal",{studentId:me.student_id,test:I}),n({failedStudentIds:[me.student_id],test_type:I.test_type,original_test_id:(oe==null?void 0:oe.test_id)||I.test_id,subject_id:(oe==null?void 0:oe.subject_id)||I.subject_id}))},children:oe&&oe.test_type==="drawing"?c.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[c.jsx("button",{onClick:()=>qt(oe),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"View Drawing"}),(()=>{const he=rt.current.has(I.test_name);return console.log(` Score cell for ${I.test_name}:`,{isEditing:he,editingColumns:Array.from(rt.current),test_name:I.test_name}),he})()?c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"number",min:"0",max:oe.max_score||100,value:((Ue=(Ee=dt.current[I.test_name])==null?void 0:Ee[me.student_id])==null?void 0:Ue.score)||oe.score||"",onChange:he=>Ln(I.test_name,me.student_id,"score",he.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),c.jsx("span",{className:"text-xs text-gray-500",children:"/"}),c.jsx("input",{type:"number",min:"1",value:((ut=(Oe=dt.current[I.test_name])==null?void 0:Oe[me.student_id])==null?void 0:ut.maxScore)||oe.max_score||100,onChange:he=>Ln(I.test_name,me.student_id,"maxScore",he.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):c.jsxs("div",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors",onDoubleClick:()=>{console.log(" Double-clicked on drawing test score:",I.test_name),console.log(" Results state at double-click:",D),console.log(" Current results ref:",Tt.current),hr(I.test_name,Tt.current)},title:"Double-click to edit column",children:[oe.score||0,"/",oe.max_score||100]}),oe.caught_cheating&&oe.visibility_change_times&&c.jsxs("span",{className:"text-xs text-red-600",children:["(",oe.visibility_change_times,")"]})]}):oe&&oe.score!==null&&oe.score!==void 0?c.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[(()=>{const he=o(oe),je=he!==null&&he<50,Ye=he!==null&&he>=50&&he<70,mt=he!==null&&he>=70;console.debug("[TeacherResults] Main table pill",{studentId:me.student_id,pct:he,isRed:je,isYellow:Ye,isGreen:mt,testResult:oe});const pt=he===null?"text-gray-600":je?"text-red-600 font-semibold":Ye?"text-yellow-600":"text-green-600",Bt=(oe==null?void 0:oe.retest_offered)===!0;return c.jsxs(Be.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${pt} ${je?"cursor-pointer hover:opacity-90":""} ${Bt?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:je?{color:"#b91c1c"}:void 0,whileHover:{scale:je?1.1:1.05},transition:{duration:.2},onClick:Et=>{if(Et.preventDefault(),Et.stopPropagation(),oe!=null&&oe.retest_offered){i("Retest is already offered","info");return}je&&(console.debug("[TeacherResults] Main table pill clicked -> opening retest modal",{studentId:me.student_id,test:I}),n({failedStudentIds:[me.student_id],test_type:I.test_type,original_test_id:(oe==null?void 0:oe.test_id)||I.test_id,subject_id:(oe==null?void 0:oe.subject_id)||I.subject_id}))},title:Bt?"Retest offered":je?"Offer retest":"",children:[(()=>{const Et=oe.retest_best_score??oe.score,St=oe.retest_best_max_score??oe.max_score;return c.jsxs(c.Fragment,{children:[c.jsx("span",{className:je?"text-red-700":"",children:Et}),"/",c.jsx("span",{children:St})]})})(),oe.caught_cheating&&c.jsx("span",{className:"ml-1",children:""})]})})(),oe.caught_cheating&&oe.visibility_change_times&&c.jsxs("span",{className:"text-xs text-red-600",children:["(",oe.visibility_change_times,")"]})]}):c.jsx("span",{className:"text-gray-400",children:"-"})},Z)})]},Te))})})]})})]})]}),[yr,_e,xe]),ae=b.useCallback((V,ie,we)=>!ie||ie.length===0?c.jsx(Be.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:c.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):c.jsx(Be.div,{className:"w-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},children:c.jsx(Be.div,{className:"overflow-x-auto -mx-4 px-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.1},children:c.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden min-w-max",children:c.jsxs("table",{className:"w-full border-collapse text-xs min-w-max",children:[c.jsx("thead",{children:c.jsxs(Be.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.2,delay:.2},children:[c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-16 text-center",children:"ID"}),c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",children:"Name"}),c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",children:"Surname"}),c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-12 text-center",children:"No."}),c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[80px]",children:"Nickname"}),we.map((me,Te)=>{const I=me.test_type==="drawing",Z=rt.current.has(me.test_name);return c.jsx(Be.th,{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.3+Te*.05},children:c.jsxs("div",{className:"flex flex-col space-y-1",children:[I&&c.jsx("div",{className:"flex justify-center",children:Z?c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:pe=>{pe.preventDefault(),pe.stopPropagation(),Y(me.test_name)},disabled:et,className:"px-1 py-0.5 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:et?"Saving...":"Save"}),c.jsx("button",{onClick:pe=>{pe.preventDefault(),pe.stopPropagation(),Nr(me.test_name)},disabled:et,className:"px-1 py-0.5 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):c.jsx("button",{onClick:pe=>{pe.preventDefault(),pe.stopPropagation(),hr(me.test_name)},className:"px-1 py-0.5 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:"Edit"})}),c.jsx("span",{className:"text-xs",children:me.test_name.length>10?me.test_name.substring(0,10)+"...":me.test_name})]})},Te)})]})}),c.jsx("tbody",{children:c.jsx(va,{children:ie.map((me,Te)=>c.jsxs(Be.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${Te%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.1+Te*.03,ease:"easeOut"},whileHover:{scale:1.005,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.995},children:[c.jsx(Be.td,{className:"border-b border-gray-100 px-3 py-3 text-center font-semibold text-gray-900",whileHover:{scale:1.03},transition:{duration:.15},children:me.student_id}),c.jsx(Be.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:me.name}),c.jsx(Be.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:me.surname}),c.jsx(Be.td,{className:"border-b border-gray-100 px-3 py-3 text-center text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:me.number??Te+1}),c.jsx(Be.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-600 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:me.nickname||"-"}),we.map((I,Z)=>{var Ee,Ue,Oe,ut;const pe=_e.has(I.test_name),oe=me[I.test_name];return pe?c.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-sm w-8 min-w-[32px] max-w-[32px]",children:c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:he=>{he.preventDefault(),he.stopPropagation(),xe(I.test_name)},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},Z):c.jsx(Be.td,{className:"border-b border-gray-100 px-3 py-3 text-sm",whileHover:{scale:1.01},transition:{duration:.15},onClick:he=>{console.debug("[TeacherResults] TD clicked",{testResult:oe,student:me.student_id});const je=o(oe);if(je!==null&&je<50){if(oe!=null&&oe.retest_offered){i("Retest is already offered","info");return}console.debug("[TeacherResults] TD -> opening retest modal",{studentId:me.student_id}),n({failedStudentIds:[me.student_id]})}},children:oe&&oe.score!==null&&oe.score!==void 0?c.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[oe.test_type==="drawing"?c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>qt(oe),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View"}),rt.current.has(I.test_name)?c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"number",min:"0",max:oe.max_score||100,value:((Ue=(Ee=dt.current[I.test_name])==null?void 0:Ee[me.student_id])==null?void 0:Ue.score)||oe.score||"",onChange:he=>Ln(I.test_name,me.student_id,"score",he.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),c.jsx("span",{className:"text-xs text-gray-500",children:"/"}),c.jsx("input",{type:"number",min:"1",value:((ut=(Oe=dt.current[I.test_name])==null?void 0:Oe[me.student_id])==null?void 0:ut.maxScore)||oe.max_score||100,onChange:he=>Ln(I.test_name,me.student_id,"maxScore",he.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):c.jsxs(Be.div,{className:`px-1 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors ${oe.caught_cheating?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-800"}`,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>hr(I.test_name),title:"Double-click to edit column",children:[oe.score,"/",oe.max_score,oe.caught_cheating&&c.jsx("span",{className:"ml-1",children:""})]})]}):(()=>{const he=o(oe),je=he!==null&&he<50,Ye=he!==null&&he>=50&&he<70,mt=he!==null&&he>=70;console.debug("[TeacherResults] Render pill",{studentId:me.student_id,pct:he,isRed:je,isYellow:Ye,isGreen:mt,score:oe.score,max:oe.max_score,percentageField:oe.percentage});const Bt=`px-1 py-0.5 rounded text-xs font-medium ${he===null?"text-gray-600":je?"text-red-600 font-semibold":Ye?"text-yellow-600":"text-green-600"} ${je?"cursor-pointer hover:opacity-90 pointer-events-auto":""}`;return console.debug("[TeacherResults] Pill classes",{classNameStr:Bt,pct:he,isRed:je,isYellow:Ye,isGreen:mt}),c.jsxs(Be.div,{className:Bt,style:je?{color:"#b91c1c"}:void 0,whileHover:{scale:je?1.05:1},transition:{duration:.15},onClick:je?Et=>{Et.preventDefault(),Et.stopPropagation();const St=window.getComputedStyle(Et.currentTarget).color;console.debug("[TeacherResults] Red pill clicked -> opening retest modal",{studentId:me.student_id,className:Bt,computedColor:St}),n({failedStudentIds:[me.student_id]})}:void 0,title:je?"Offer retest":"",children:[c.jsx("span",{className:je?"text-red-700":"",children:oe.score}),"/",c.jsx("span",{children:oe.max_score}),oe.caught_cheating&&c.jsx("span",{className:"ml-1",children:""})]})})(),oe.caught_cheating&&oe.visibility_change_times&&c.jsxs("span",{className:"text-xs text-red-600",children:["(",oe.visibility_change_times,")"]})]}):c.jsx("span",{className:"text-gray-400",children:"-"})},Z)})]},Te))})})]})})})}),[yr,_e,xe]),ce=b.useCallback(()=>{var we;if(!D)return null;console.log(" renderResults - results:",D),console.log(" renderResults - results.class:",D.class),console.log(" renderResults - results.unique_tests:",D.unique_tests);const V=D.class&&Array.isArray(D.class)&&D.class.length>0;if(console.log(" renderResults - hasStudentData:",V),!V)return console.log(" renderResults - No student data, showing no students message"),c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No students found for this class and semester."})});const ie=D.unique_tests||[];return console.log(" renderResults - uniqueTests:",ie),Tt.current=D,c.jsxs("div",{className:"space-y-6",children:[c.jsxs(Be.div,{className:"bg-gradient-to-r from-red-500 to-pink-500 rounded-lg p-6 text-white",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[c.jsxs(Be.h2,{className:"text-2xl font-bold mb-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.1},children:["Test Results - Grade M",G,", Class ",G,"/",K,", Semester ",w]}),c.jsxs(Be.p,{className:"text-cyan-100",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.2},children:["Viewing results for ",((we=D.subjects)==null?void 0:we.length)||0," subject(s)"]}),c.jsxs(Be.div,{className:"mt-4 flex gap-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:[c.jsx("button",{onClick:()=>{var Te;const me=((Te=D.unique_tests)==null?void 0:Te.map(I=>I.test_name))||[];Le(new Set(me))},className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Collapse All Tests"}),c.jsx("button",{onClick:()=>Le(new Set),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Expand All Tests"})]})]}),c.jsxs(Be.div,{className:"bg-white rounded-lg shadow p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},children:[c.jsx(Be.h3,{className:"text-lg font-semibold text-gray-900 mb-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},children:"Class Results"}),c.jsx("div",{className:"hidden md:block",children:fe("All Subjects",D.class,ie)}),c.jsx("div",{className:"md:hidden",children:ae("All Subjects",D.class,ie)})]})]})},[D,fe,G,K,w]),ge=b.useCallback(()=>{if(!D||!D.class||!D.unique_tests)return;const V=["Student ID","Name","Surname","No.","Nickname",...D.unique_tests.map(Z=>Z.test_name)],ie=D.class.map((Z,pe)=>{const oe=[];return oe.push(Z.student_id),oe.push(Z.name),oe.push(Z.surname),oe.push(Z.number??pe+1),oe.push(Z.nickname||"-"),D.unique_tests.forEach(Ee=>{const Ue=Z[Ee.test_name];Ue&&Ue.score!==null&&Ue.score!==void 0?oe.push(`${Ue.score}/${Ue.max_score}`):oe.push("-")}),oe}),we=zx.aoa_to_sheet([V,...ie]),me=zx.book_new(),Te=[{wch:10},{wch:15},{wch:15},{wch:6},{wch:12},...D.unique_tests.map(()=>({wch:15}))];we["!cols"]=Te,zx.book_append_sheet(me,we,"Class Results");const I=`class-results-${G}-${K}-semester-${w}.xlsx`;J0e(me,I),i("Excel file exported successfully!","success")},[D,G,K,w,i]);return d?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(nr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Results..."})]})}):h?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:h}),c.jsx(He,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsx("div",{className:"flex justify-between items-center py-4",children:c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Class Results"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",J?J.toLocaleString():"Never"]})]})})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Class"}),E.length>0?c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:E.map((V,ie)=>c.jsxs(He,{variant:G===V.grade&&K===V.class?"primary":"outline",onClick:()=>Ft(V.grade,V.class),className:"w-full",children:[V.grade,"/",V.class]},`${V.grade}-${V.class}-${ie}`))}):c.jsx("p",{className:"text-gray-500",children:"No classes available"})]}),K&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Select Semester for ",G,"/",K]}),c.jsx("div",{className:"flex space-x-4",children:[1,2].map(V=>{let ie=1;if(M&&M.length>0){const we=new Date;for(const me of M){const Te=new Date(me.start_date),I=new Date(me.end_date);if(we>=Te&&we<=I){ie=me.semester;break}}}return c.jsxs(Be.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${w===V?"bg-blue-600 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>Ot(V),whileHover:{scale:1.05},whileTap:{scale:.95},children:["Semester ",V,V===ie&&c.jsx("span",{className:"ml-2 text-xs",children:"(Current)"})]},V)})})]}),K&&D&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[G," ",K," - Test Results (Semester ",w,")"]}),c.jsx("div",{className:"flex space-x-3",children:c.jsxs("button",{type:"button",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-2",onClick:ge,children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-4 h-4 object-contain"}),c.jsx("span",{className:"font-medium text-sm",children:"Export Excel"})]})})]}),ce()]}),K&&!D&&c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No test results available for this class and semester."})})})]})}),$e&&c.jsx(RM,{drawing:$e,isOpen:at,onClose:()=>Se(!1),isTeacherView:!0})]})},wj=({onBackToLogin:t})=>{const e=Ha(),{user:r,isAuthenticated:n,logout:s,getCurrentTeacherUsername:a}=xn(),{teacherData:i,loadTeacherData:o}=Iv(),{activeTests:l,loadActiveTests:u}=Nm(),{showNotification:d,notifications:g}=Ys(),[h,p]=b.useState(!0),[x,v]=b.useState(""),[w,S]=b.useState("main"),[_,y]=b.useState([]),[k,N]=b.useState([]),[E,A]=b.useState(null),[C,F]=b.useState(null),[D,R]=b.useState(null),[M,B]=b.useState(!1),[J,X]=b.useState(!1),[z,H]=b.useState(null),[U,L]=b.useState(!1),[ne,de]=b.useState(null),[G,K]=b.useState(!1),[Q,q]=b.useState(null),[se,W]=b.useState(null),[ee,ve]=b.useState([]),[_e,Le]=b.useState(!1),[te,Ne]=b.useState(null),[Ce,We]=b.useState({}),[nt,$e]=b.useState(!1),[De,at]=b.useState(!1),[Se,Ae]=b.useState(0),[Me,Ie]=b.useState([]),[Ge,tt]=b.useState([]),[kt,zt]=b.useState(!1),[bt,Dt]=b.useState(null),[it,ht]=b.useState([]),[Ct,jt]=b.useState(!1),[Fe,et]=b.useState("subject");b.useEffect(()=>{Tt()},[]),b.useEffect(()=>{const he=je=>{nt&&!je.target.closest(".relative")&&$e(!1),De&&!je.target.closest(".relative")&&at(!1)};return document.addEventListener("mousedown",he),()=>{document.removeEventListener("mousedown",he)}},[nt,De]);const Ze=b.useCallback(async()=>{console.log(" Loading teacher data...");try{const he=await $r.getTeacherData();return console.log(" Teacher data loaded:",he),W(new Date),he}catch(he){throw console.error(" Error loading teacher data:",he),he}},[]),rt=b.useCallback(async()=>{var he;console.log(" Loading teacher subjects...");try{const je=`teacher_subjects_${(r==null?void 0:r.teacher_id)||(r==null?void 0:r.id)||""}`,Ye=nn(je);if(Ye)return console.log(" Using cached teacher subjects"),y(Ye),Ye;const mt=await $r.getTeacherData();console.log(" Raw teacher data:",mt);const pt=$r.getTeacherSubjects(mt.subjects);return console.log(" Teacher subjects loaded:",pt),y(pt),zr(je,pt,Xr.teacher_subjects),console.log(" Available classes for performance chart:",((he=pt[0])==null?void 0:he.classes)||[]),console.log(" Performance chart will load when user clicks on a class"),pt}catch(je){throw console.error(" Error loading teacher subjects:",je),je}},[r==null?void 0:r.teacher_id,r==null?void 0:r.id]),dt=b.useCallback(async()=>{console.log(" Loading teacher active tests...");try{const he=`teacher_tests_${(r==null?void 0:r.teacher_id)||(r==null?void 0:r.id)||""}`,je=nn(he);if(je)return console.log(" Using cached teacher tests"),N(je),je;const Ye=await Tr.getTeacherTests();return console.log(" Teacher tests loaded:",Ye),N(Ye),zr(he,Ye,Xr.teacher_tests),Ye}catch(he){throw console.error(" Error loading teacher tests:",he),he}},[r==null?void 0:r.teacher_id,r==null?void 0:r.id]),Tt=b.useCallback(async()=>{console.log(" Initializing Teacher Cabinet...");try{if(p(!0),v(""),!n||!r){console.log(" User not authenticated"),v("User not authenticated");return}if(r.role!==ra.TEACHER){console.error(" Invalid user role for teacher cabinet:",r.role),v("Access denied. Teacher role required.");return}console.log(" Loading teacher data..."),await Ze(),console.log(" Loading teacher subjects..."),await rt(),console.log(" Loading active tests..."),await dt(),console.log(" Teacher Cabinet initialization complete!")}catch(he){console.error(" Error initializing teacher cabinet:",he),v("Failed to initialize teacher cabinet")}finally{p(!1)}},[n,r,Ze,rt,dt]),xe=b.useCallback(()=>{console.log(" Showing subject selection prompt..."),B(!0),ue(),et("subject")},[]),ue=b.useCallback(async()=>{console.log(" Loading available subjects..."),zt(!0);try{const he=await $r.getSubjectsForSelection();Ie(he),console.log(" Available subjects loaded:",he)}catch(he){console.error(" Error loading available subjects:",he),d("Failed to load subjects","error")}finally{zt(!1)}},[]),ye=b.useCallback(he=>{if(!he){Dt(null);return}const je=Me.find(Ye=>Ye.subject_id==he);je&&(Dt(je),ht([]),et("classes"))},[Me]),be=b.useCallback((he,je)=>{ht(Ye=>Ye.some(mt=>mt.grade===he&&mt.class===je)?Ye.filter(mt=>!(mt.grade===he&&mt.class===je)):[...Ye,{grade:he,class:je}])},[]),Ve=b.useCallback(()=>{if(!bt||it.length===0){d("Please select at least one class","warning");return}const he={subject_id:parseInt(bt.subject_id),subject_name:bt.subject,classes:it};tt(je=>[...je,he]),Dt(null),ht([]),et("subject"),d(`Added ${bt.subject} with ${it.length} classes`,"success")},[bt,it]),Nt=b.useCallback(he=>{tt(je=>je.filter((Ye,mt)=>mt!==he))},[]),yt=b.useCallback(async(he,je,Ye)=>{console.log(" Deleting teacher subject:",{subjectId:he,grade:je,classNumber:Ye});try{const mt={subjectId:he,grade:je,class:Ye};console.log(" Sending delete request with data:",mt);const pt=await $r.deleteTeacherSubject(mt);if(pt.success)d("Subject assignment deleted successfully!","success"),await rt();else throw new Error(pt.error||"Failed to delete subject assignment")}catch(mt){console.error(" Error deleting subject assignment:",mt),d("Error deleting subject assignment. Please try again.","error")}},[rt,d]),$t=b.useCallback((he,je,Ye,mt)=>{q({subjectId:he,subjectName:je,grade:Ye,classNumber:mt}),K(!0)},[]),Ft=b.useCallback(async()=>{Q&&(await yt(Q.subjectId,Q.grade,Q.classNumber),K(!1),q(null))},[Q,yt]),Ot=b.useCallback(()=>{K(!1),q(null)},[]),xr=b.useCallback(async()=>{if(Ge.length===0){d("Please select at least one subject","warning");return}try{const he=await $r.saveTeacherSubjects(Ge);if(he.success)d("Subjects saved successfully!","success"),B(!1),tt([]),et("subject"),await rt();else throw new Error(he.error||"Failed to save subjects")}catch(he){console.error(" Error saving teacher subjects:",he),d("Failed to save subjects","error")}},[Ge,rt]);b.useCallback(async he=>{console.log(" Saving teacher subjects:",he);try{const je=await $r.saveTeacherSubjects(he);if(je.success)d("Subjects saved successfully!","success"),await rt(),B(!1);else throw new Error(je.error||"Failed to save subjects")}catch(je){console.error(" Error saving teacher subjects:",je),d("Failed to save subjects","error")}},[rt]);const yr=b.useCallback(()=>{console.log(" Showing active tests..."),S("tests")},[]),qt=b.useCallback(he=>{console.log(" Showing test details:",he),H(he),X(!0)},[]);b.useCallback(async(he,je,Ye)=>{console.log(" Removing class assignment:",he,je,Ye);try{const mt=await Tr.removeClassAssignment(he,je,Ye);if(mt.success)d("Assignment removed successfully!","success"),await dt();else throw new Error(mt.error||"Failed to remove assignment")}catch(mt){console.error(" Error removing class assignment:",mt),d("Failed to remove assignment","error")}},[dt]);const hr=b.useCallback(async(he,je)=>{console.log(" Marking test as completed:",he,je);try{const Ye=await Tr.markTestCompleted(he,je);if(Ye.success){d("Test marked as completed!","success");const mt=`teacher_tests_${(r==null?void 0:r.teacher_id)||(r==null?void 0:r.id)||""}`;localStorage.removeItem(mt),console.log(" Cleared teacher tests cache"),await dt()}else throw new Error(Ye.error||"Failed to mark test as completed")}catch(Ye){console.error(" Error marking test as completed:",Ye),d("Failed to mark test as completed","error")}},[dt,d,r==null?void 0:r.teacher_id,r==null?void 0:r.id]),Nr=b.useCallback(async()=>{console.log(" Refreshing active tests data...");try{await dt(),d("Tests refreshed successfully!","success")}catch(he){console.error(" Error refreshing tests:",he),d("Failed to refresh tests","error")}},[dt]),[Ln,Y]=b.useState(!1),fe=b.useCallback(async he=>{console.log(" Loading performance data for class:",he),console.log(" Current selectedClassForChart:",te);try{Y(!0);const[je,Ye]=he.split("/"),mt=je.startsWith("M")?je:`M${je}`,pt=`class_summary_${r.teacher_id}_${mt}_${Ye}_${ya.CURRENT_ACADEMIC_YEAR}_${ya.CURRENT_SEMESTER}`,Bt=nn(pt);if((Bt?Date.now()-Bt.timestamp:1/0)>36e5)try{await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/refresh-class-summary-semester")}catch(Ut){console.warn("Materialized view refresh failed (continuing):",Ut.message)}const re=await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary-semester?teacher_id=${r.teacher_id}&grade=${mt}&class=${Ye}&semester=${ya.CURRENT_SEMESTER}&academic_year=${ya.CURRENT_ACADEMIC_YEAR}`);console.log(" API response status:",re.status);const Xe=await re.json();if(console.log(" Performance API response:",Xe),console.log(" API success:",Xe.success),console.log(" API summary:",Xe.summary),Xe.success&&Xe.summary){console.log(" Processing semester performance data:",Xe.summary);const Ut=Xe.summary;console.log(" Semester summary:",{total_students:Ut.total_students,total_tests:Ut.total_tests,completed_tests:Ut.completed_tests,average_class_score:Ut.average_class_score,pass_rate:Ut.pass_rate,cheating_incidents:Ut.cheating_incidents});const Qt={summary:Ut,semester:ya.CURRENT_SEMESTER,academicYear:ya.CURRENT_ACADEMIC_YEAR,overallAverage:Ut.average_class_score||0,totalTests:Ut.total_tests||0,completedTests:Ut.completed_tests||0,passRate:Ut.pass_rate||0,cheatingIncidents:Ut.cheating_incidents||0,lastTestDate:Ut.last_test_date,semesterProgress:ae(Ut)};console.log(" Semester performance data:",Qt),We(ss=>({...ss,[he]:Qt}))}else console.log(" No performance data available for class:",he),We(Ut=>({...Ut,[he]:{tests:[],overallAverage:0}}))}catch(je){console.error(" Error loading performance data:",je),console.error(" Error details:",je.message),We(Ye=>({...Ye,[he]:{tests:[],overallAverage:0}}))}finally{Y(!1)}},[r]),ae=b.useCallback(he=>{if(!he.last_test_date)return 0;const je=new Date("2025-05-01"),Ye=new Date("2025-09-30"),mt=new Date,pt=Ye-je,Bt=Math.min(mt-je,pt);return Math.round(Bt/pt*100)},[]);b.useCallback((he,je)=>{console.log(" Showing class results:",he,je),console.log(" Class click - grade:",he,"className:",je),F(he),R(je),S("results");const Ye=`${he}/${je}`;console.log(" Loading performance data for clicked class:",Ye),Ne(Ye),fe(Ye)},[fe]);const[ce,ge]=b.useState([]),[V,ie]=b.useState([]),we=b.useCallback(async()=>{try{const je=await(await bu(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestAssignments(r.teacher_id);ge(je)}catch(he){console.warn("Failed to load retests",he)}},[r]);b.useCallback(async he=>{try{const Ye=await(await bu(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestTargets(he);ie(Ye)}catch(je){console.warn("Failed to load retest targets",je)}},[]);const[me,Te]=b.useState(!1);b.useEffect(()=>{console.debug("[TeacherCabinet] showRetestModal state changed:",me)},[me]);const[I,Z]=b.useState({test_type:"",original_test_id:"",subject_id:"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:[]}),pe=b.useCallback(async he=>{console.debug("[TeacherCabinet] openRetestModal called with:",he);const{test_type:je,original_test_id:Ye,subject_id:mt,failedStudentIds:pt=[]}=he||{};Z({test_type:je||"multiple_choice",original_test_id:Ye||"",subject_id:mt||"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:pt}),console.debug("[TeacherCabinet] Setting showRetestModal to true"),Te(!0)},[]),oe=b.useCallback(async()=>{try{const he=await bu(()=>import("./retestService-C6b0YDiD.js"),[]),je=new Date,Ye=new Date(je.getTime()+I.window_days*24*60*60*1e3),mt={...I,grade:C,class:D,window_start:je.toISOString(),window_end:Ye.toISOString()};await he.retestService.createRetestAssignment(mt),d("Retest created","success"),Te(!1),we(),Ae(pt=>pt+1)}catch(he){console.error("Create retest error",he),d(he.message||"Failed to create retest","error")}},[I,C,D,we]),Ee=b.useCallback(he=>{var mt,pt;if(!he)return c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),c.jsx("p",{className:"text-gray-500",children:"Click on a class to view performance data"})]});const Ye=(Ce[he]||{}).summary;return Ye?c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[c.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[((mt=Ye.average_class_score)==null?void 0:mt.toFixed(1))||0,"%"]}),c.jsx("div",{className:"text-sm text-blue-600",children:"Class Average"})]}),c.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-3xl font-bold text-green-600",children:Ye.total_tests||0}),c.jsx("div",{className:"text-sm text-green-600",children:"Total Tests"})]}),c.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[c.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:[((pt=Ye.pass_rate)==null?void 0:pt.toFixed(1))||0,"%"]}),c.jsx("div",{className:"text-sm text-purple-600",children:"Pass Rate"})]}),c.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-3xl font-bold text-red-600",children:Ye.cheating_incidents||0}),c.jsx("div",{className:"text-sm text-red-600",children:"Cheating Incidents"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:Ye.completed_tests||0}),c.jsx("div",{className:"text-sm text-yellow-600",children:"Completed Tests"})]}),c.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:Ye.highest_score||0}),c.jsx("div",{className:"text-sm text-indigo-600",children:"Highest Score"})]}),c.jsxs("div",{className:"bg-pink-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-2xl font-bold text-pink-600",children:Ye.total_students||0}),c.jsx("div",{className:"text-sm text-pink-600",children:"Total Students"})]})]}),Ln&&c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-4 w-full max-w-xs text-center",children:[c.jsx("div",{className:"animate-spin h-6 w-6 border-2 border-gray-300 border-t-transparent rounded-full mx-auto mb-2"}),c.jsx("div",{className:"text-sm text-gray-700",children:"Loading latest class summary..."})]})})]}):c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),c.jsx("p",{className:"text-gray-500",children:"No performance data available for this class"})]})},[Ce]);if(h)return c.jsxs("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:[c.jsxs("div",{className:"text-center",children:[c.jsx(nr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Cabinet..."})]}),c.jsx("div",{className:"flex flex-wrap gap-2"})]});if(x)return c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Cabinet Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:x}),c.jsx(He,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return c.jsxs(Be.div,{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsx(Be.div,{className:"bg-gradient-to-r from-sky-400 to-sky-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-6",children:[c.jsxs(Be.div,{className:"flex-1 text-center",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white mb-2",children:"Teacher Cabinet"}),c.jsxs("p",{className:"text-sky-100 text-sm sm:text-base md:text-lg",children:["Welcome, Teacher ",a()||""]})]}),c.jsxs(Be.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsx("div",{className:"hidden md:block",children:c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>$e(!nt),className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border border-white/20 text-white hover:bg-white/20 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:[c.jsx("span",{className:"hidden sm:inline text-xs sm:text-sm font-medium",children:"Menu"}),c.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 transition-transform duration-200",style:{transform:nt?"rotate(180deg)":"rotate(0deg)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),nt&&c.jsx(Be.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:c.jsxs("button",{onClick:()=>{$e(!1),t?t():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),c.jsx("span",{children:"Logout"})]})})]})}),c.jsxs("div",{className:"md:hidden",children:[c.jsx("button",{onClick:()=>at(!De),className:"flex items-center justify-center w-10 h-10 bg-white/10 border border-white/20 text-white hover:bg-white/20 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),De&&c.jsxs(Be.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[c.jsxs("div",{className:"px-4 py-2 border-b border-gray-200",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:a()||"Teacher"}),c.jsx("p",{className:"text-xs text-gray-500",children:"Teacher Account"})]}),c.jsxs("button",{onClick:()=>{at(!1),t?t():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),c.jsx("span",{children:"Logout"})]})]})]})]})]})})}),c.jsx(Be.div,{className:"bg-white border-b shadow-sm",initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},children:c.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:c.jsx("nav",{className:"flex space-x-1 sm:space-x-8 overflow-x-auto",children:[{key:"main",label:"Main Dashboard",shortLabel:"Dashboard"},{key:"tests",label:"Test Management",shortLabel:"Tests"},{key:"results",label:"Class Results",shortLabel:"Results"},{key:"subjects",label:"Subject Management",shortLabel:"Subjects"}].map((he,je)=>c.jsxs(Be.button,{onClick:()=>he.key==="tests"?yr():S(he.key),className:`py-2 sm:py-4 px-2 sm:px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors duration-200 whitespace-nowrap flex-shrink-0 ${w===he.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5+je*.1,duration:.3},whileHover:{scale:1.05},whileTap:{scale:.95},children:[c.jsx("span",{className:"sm:hidden",children:he.shortLabel}),c.jsx("span",{className:"hidden sm:inline",children:he.label})]},he.key))})})}),c.jsx(Be.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:c.jsxs(va,{mode:"wait",children:[w==="main"&&c.jsx(Be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Ue()},"main"),w==="subjects"&&c.jsx(Be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Oe()},"subjects"),w==="tests"&&c.jsx(Be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:ut()},"tests"),w==="results"&&c.jsx(Be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:c.jsx(GI,{selectedGrade:C,selectedClass:D,onBackToCabinet:()=>S("main"),openRetestModal:pe},Se)},"results")]})}),M&&c.jsx(vo,{isOpen:M,onClose:()=>{B(!1),et("subject"),tt([]),Dt(null),ht([])},title:"Select Subjects and Classes",size:"large",children:c.jsxs("div",{className:"space-y-6 px-4 max-h-[80vh] overflow-y-auto",children:[Fe==="subject"&&c.jsxs(Be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Step 1: Select Subject"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the subject you want to teach:"}),kt?c.jsxs("div",{className:"flex items-center justify-center py-8",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),c.jsx("span",{className:"ml-2 text-gray-600",children:"Loading subjects..."})]}):c.jsxs("select",{value:(bt==null?void 0:bt.subject_id)||"",onChange:he=>ye(he.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"Select a subject"}),Me.map(he=>c.jsx("option",{value:he.subject_id,children:he.subject},he.subject_id))]})]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx(He,{variant:"outline",onClick:()=>B(!1),children:"Cancel"}),c.jsx(He,{variant:"primary",onClick:()=>et("classes"),disabled:!bt,children:"Next: Select Classes"})]})]}),Fe==="classes"&&bt&&c.jsxs(Be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["Step 2: Select Classes for ",bt.subject]}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the classes you teach for this subject:"}),c.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:c.jsx("div",{className:"grid grid-cols-3 gap-3",children:[1,2,3,4,5,6].map(he=>c.jsxs("div",{className:"space-y-2",children:[c.jsxs("h4",{className:"font-medium text-gray-700 text-sm",children:["Grade ",he]}),c.jsx("div",{className:"space-y-1",children:[15,16].map(je=>c.jsxs("label",{className:"flex items-center space-x-2 py-1",children:[c.jsx("input",{type:"checkbox",checked:it.some(Ye=>Ye.grade===he.toString()&&Ye.class===je.toString()),onChange:()=>be(he.toString(),je.toString()),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),c.jsxs("span",{className:"text-xs text-gray-700",children:["Class ",je]})]},je))})]},he))})})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx(He,{variant:"outline",onClick:()=>et("subject"),children:"Back to Subjects"}),c.jsxs("div",{className:"space-x-3",children:[c.jsx(He,{variant:"outline",onClick:()=>B(!1),children:"Cancel"}),c.jsx(He,{variant:"primary",onClick:Ve,disabled:it.length===0,children:"Add Subject"})]})]})]}),Ge.length>0&&c.jsxs(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Selected Subjects"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Review your selected subjects and classes:"}),c.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:Ge.map((he,je)=>c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900",children:he.subject_name}),c.jsxs("p",{className:"text-sm text-gray-600",children:["Classes: ",he.classes.map(Ye=>`Grade ${Ye.grade} Class ${Ye.class}`).join(", ")]})]}),c.jsx("button",{onClick:()=>Nt(je),className:"text-red-600 hover:text-red-800 p-1",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},je))})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx(He,{variant:"outline",onClick:()=>et("subject"),children:"Add More Subjects"}),c.jsxs("div",{className:"space-x-3",children:[c.jsx(He,{variant:"outline",onClick:()=>B(!1),children:"Cancel"}),c.jsx(He,{variant:"primary",onClick:xr,children:"Save All Subjects"})]})]})]})]})}),me&&c.jsxs(vo,{isOpen:me,onClose:()=>Te(!1),title:"Create Retest",size:"medium",children:[c.jsx("div",{className:"space-y-4",children:c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Retest Window"}),c.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:I.window_days,onChange:he=>Z(je=>({...je,window_days:Number(he.target.value)})),children:[c.jsx("option",{value:1,children:"1 day"}),c.jsx("option",{value:2,children:"2 days"}),c.jsx("option",{value:3,children:"3 days"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Attempts"}),c.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:I.max_attempts,onChange:he=>Z(je=>({...je,max_attempts:Number(he.target.value)})),children:[c.jsx("option",{value:1,children:"1 attempt"}),c.jsx("option",{value:2,children:"2 attempts"}),c.jsx("option",{value:3,children:"3 attempts"})]}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Students can retry immediately if they fail"})]})]})}),c.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[c.jsx("button",{onClick:()=>Te(!1),className:"px-4 py-2 text-sm rounded border border-gray-300 hover:bg-gray-50",children:"Cancel"}),c.jsx("button",{onClick:oe,className:"px-4 py-2 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700",children:"Create Retest"})]})]}),J&&z&&c.jsxs(vo,{isOpen:J,onClose:()=>X(!1),title:"Test Details",size:"large",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Name:"}),c.jsx("p",{className:"text-sm text-gray-900",children:z.test_name})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Subject:"}),c.jsx("p",{className:"text-sm text-gray-900",children:z.subject})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Type:"}),c.jsx("p",{className:"text-sm text-gray-900",children:z.test_type})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Created:"}),c.jsx("p",{className:"text-sm text-gray-900",children:new Date(z.created_at).toLocaleDateString()})]})]}),c.jsx("div",{className:"flex justify-end space-x-3 mt-6",children:c.jsx(He,{variant:"outline",onClick:()=>X(!1),children:"Close"})})]}),G&&Q&&c.jsx(vo,{isOpen:G,onClose:Ot,title:"Delete Subject Assignment",size:"small",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:c.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Subject Assignment"}),c.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Are you sure you want to delete the assignment for"," ",c.jsx("span",{className:"font-semibold text-gray-900",children:Q.subjectName})," ","in Grade ",Q.grade,", Class ",Q.classNumber,"?"]}),c.jsx("p",{className:"text-xs text-red-600",children:"This action cannot be undone."})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[c.jsx(He,{variant:"outline",onClick:Ot,children:"Cancel"}),c.jsx(He,{variant:"danger",onClick:Ft,children:"Delete Assignment"})]})]})}),c.jsx(Be.div,{className:"fixed top-4 right-4 space-y-2 z-50",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.8,duration:.5},children:g.map(he=>c.jsx(Be.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.3},children:c.jsx("div",{className:`p-4 rounded-lg shadow-lg ${he.type==="success"?"bg-green-600 text-white":he.type==="error"?"bg-red-600 text-white":he.type==="warning"?"bg-yellow-600 text-white":"bg-blue-600 text-white"}`,children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{children:he.message}),c.jsx("button",{onClick:()=>setNotifications(je=>je.filter(Ye=>Ye.id!==he.id)),className:"ml-4 text-white hover:text-gray-200",children:""})]})})},he.id))})]});function Ue(){return c.jsxs("div",{className:"space-y-8",children:[c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:c.jsxs(st,{children:[c.jsx(st.Header,{children:c.jsx(st.Title,{children:"My Subjects & Classes"})}),c.jsx(st.Body,{children:_.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned"}),c.jsx("p",{className:"text-gray-500 mb-4",children:"You don't have any subjects assigned yet."}),c.jsx(He,{variant:"outline",onClick:()=>S("subjects"),children:"Manage Subjects"})]}):c.jsx("div",{className:"space-y-6",children:_.map((he,je)=>{var Ye;return c.jsxs(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+je*.1,duration:.3},className:"border border-gray-200 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:he.name}),c.jsxs("span",{className:"text-sm text-gray-500",children:[((Ye=he.classes)==null?void 0:Ye.length)||0," classes"]})]}),he.classes&&he.classes.length>0?c.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:he.classes.map((mt,pt)=>c.jsx(Be.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3+je*.1+pt*.05,duration:.2},whileHover:{scale:1.05},whileTap:{scale:.95},children:c.jsxs(He,{variant:"outline",size:"sm",onClick:()=>{F(mt.grade),R(mt.class),S("results")},className:"font-medium",children:[mt.grade,"/",mt.class]})},pt))}):c.jsx("div",{className:"text-center py-4 text-gray-500",children:c.jsx("span",{className:"text-sm",children:"No classes assigned to this subject"})})]},he.id)})})})]})}),c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},children:c.jsxs(st,{children:[c.jsxs(st.Header,{children:[c.jsx(st.Title,{children:"Test Performance Overview"}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Average scores across all tests by class"})]}),c.jsx(st.Body,{children:_.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),c.jsx("p",{className:"text-gray-500",children:"No subjects assigned - no performance data available"})]}):c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex flex-wrap gap-2 border-b border-gray-200",children:(()=>{const he=[];return _.forEach(je=>{je.classes&&je.classes.forEach(Ye=>{const mt=`${Ye.grade}/${Ye.class}`;he.find(pt=>pt.key===mt)||he.push({key:mt,grade:Ye.grade,class:Ye.class,subject:je.name})})}),he})().map((he,je)=>c.jsxs("button",{onClick:()=>{console.log(" Class button clicked:",he.key),Ne(he.key),fe(he.key)},className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${te===he.key?"bg-blue-100 text-blue-700 border-b-2 border-blue-500":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[he.grade,"/",he.class]},he.key))}),c.jsx("div",{className:"mt-4",children:Ee(te)})]})})]})})]})}function Oe(){return c.jsxs("div",{className:"space-y-8",children:[c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:c.jsx(st,{children:c.jsx(st.Header,{children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx(st.Title,{children:"Subject Management"}),c.jsx(He,{variant:"primary",onClick:xe,children:"Add Subject"})]})})})}),_.length===0?c.jsx(Be.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:c.jsx(st,{children:c.jsx(st.Body,{children:c.jsxs("div",{className:"text-center p-12",children:[c.jsx(Be.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No subjects assigned yet"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Add your first subject to get started with creating tests and managing classes."}),c.jsx(He,{variant:"primary",onClick:xe,size:"lg",children:"Add Your First Subject"})]})})})}):c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:c.jsxs(st,{children:[c.jsx(st.Header,{children:c.jsx(st.Title,{children:"Your Subjects"})}),c.jsx(st.Body,{children:c.jsx("div",{className:"space-y-4",children:_.map((he,je)=>{var Ye;return c.jsx(Be.div,{className:"p-4 bg-gray-50 rounded-lg border-l-4 border-green-500",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3+je*.1,duration:.3},whileHover:{scale:1.02,backgroundColor:"#f9fafb"},children:c.jsx("div",{className:"flex justify-between items-start",children:c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:he.name}),c.jsx("div",{className:"flex flex-wrap gap-2",children:((Ye=he.classes)==null?void 0:Ye.map((mt,pt)=>c.jsxs(Be.div,{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-800 text-xs rounded-full px-3 py-1",initial:{scale:0},animate:{scale:1},transition:{delay:.4+je*.1+pt*.05,duration:.2},whileHover:{scale:1.1},children:[c.jsxs("span",{children:[mt.grade," - ",mt.className]}),c.jsx("button",{onClick:()=>$t(he.id,he.name,mt.grade,mt.class),className:"ml-1 text-red-600 hover:text-red-800 transition-colors",title:"Delete this subject assignment",children:c.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},pt)))||c.jsx("span",{className:"text-gray-500 text-sm",children:"No classes assigned"})})]})})},je)})})})]})})]})}function ut(){return c.jsxs("div",{className:"space-y-8",children:[c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:c.jsx(st,{children:c.jsx(st.Header,{children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx(st.Title,{children:"Active Tests"}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx(He,{variant:"outline",onClick:Nr,children:"Refresh"}),c.jsx(He,{variant:"primary",onClick:()=>e("/teacher/tests/create"),children:"Create New Test"})]})]})})})}),k.length===0?c.jsx(Be.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:c.jsx(st,{children:c.jsx(st.Body,{children:c.jsxs("div",{className:"text-center p-12",children:[c.jsx(Be.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No active tests found"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first test to get started with assessments."}),c.jsx(He,{variant:"primary",onClick:()=>e("/teacher/tests/create"),size:"lg",children:"Create Your First Test"})]})})})}):c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"space-y-4",children:k.map((he,je)=>{var Ye,mt,pt;return c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3+je*.1,duration:.3},whileHover:{scale:1.01},children:c.jsx(st,{children:c.jsx(st.Body,{children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{className:"flex-1 flex items-center space-x-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 min-w-0 flex-shrink-0",children:he.test_name}),c.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium flex-shrink-0",children:he.test_type}),c.jsxs("div",{className:"hidden sm:flex items-center space-x-4",children:[c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[c.jsx("span",{className:"font-medium",children:"Assignments:"}),c.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:((Ye=he.assignments)==null?void 0:Ye.length)||0})]}),he.assignments&&he.assignments.length>0&&c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[c.jsx("span",{className:"font-medium",children:"Classes:"}),c.jsx("div",{className:"flex flex-wrap gap-1",children:he.assignments.map((Bt,Et)=>c.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:[Bt.grade,"/",Bt.class]},Et))})]}),c.jsx("div",{className:"text-sm text-gray-500 flex-shrink-0",children:new Date(he.created_at).toLocaleDateString()})]})]}),c.jsxs("div",{className:"flex gap-2 ml-4 flex-shrink-0",children:[c.jsx("div",{className:"sm:hidden",children:c.jsx(He,{variant:"outline",onClick:()=>qt(he),size:"sm",className:"text-xs",title:`Assignments: ${((mt=he.assignments)==null?void 0:mt.length)||0} | Classes: ${((pt=he.assignments)==null?void 0:pt.map(Bt=>`${Bt.grade}/${Bt.class}`).join(", "))||"None"} | ${new Date(he.created_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}`,children:"Details"})}),c.jsx("div",{className:"hidden sm:block",children:c.jsx(He,{variant:"outline",onClick:()=>qt(he),size:"sm",children:"Details"})}),c.jsx(He,{variant:"success",onClick:()=>hr(he.test_type,he.test_id),size:"sm",children:"Complete"})]})]})})})},je)})})]})}},oge={multipleChoice:"multiple_choice",trueFalse:"true_false",input:"input",matching:"matching_type",wordMatching:"word_matching",drawing:"drawing",fillBlanks:"fill_blanks"},_j=()=>{var we,me,Te;const{user:t}=xn();ure();const{notifications:e,showNotification:r,removeNotification:n}=Ys(),[s,a]=b.useState(!1),[i,o]=b.useState(!1),[l,u]=b.useState("typeSelection"),[d,g]=b.useState(!1),[h,p]=b.useState(null),[x,v]=b.useState([]),[w,S]=b.useState(!1),[_,y]=b.useState(!1),[k,N]=b.useState(!1),[E,A]=b.useState(!1),[C,F]=b.useState({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:"",isShuffled:!1}),[D,R]=b.useState([]),[M,B]=b.useState(null);b.useRef(null),b.useRef(null),b.useRef(null),b.useRef(null),b.useRef(null),b.useRef(null),b.useRef(null);const J=b.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in initializeTestCreation, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" Setting up test creation event listeners..."),de(),console.log(" Test creation initialization complete")},[t,r]),X=b.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in showTestTypeSelection, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" showTestTypeSelection called - starting new test creation"),o(!1),console.log(" Reset testAssignmentCompleted flag to false"),a(!0),console.log(" Set isInTestCreation flag to true"),z(),u("typeSelection"),U("testTypeSelection")},[t,r]),z=b.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in disableNavigationButtons, redirecting to login");return}console.log(" Disabling navigation buttons..."),g(!0)},[t]),H=b.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in enableNavigationButtons, redirecting to login");return}console.log(" Enabling navigation buttons..."),g(!1)},[t]),U=b.useCallback(async I=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in saveTestCreationState, redirecting to login");return}console.log("  saveTestCreationState called with step:",I),console.log("  Call stack:",new Error().stack);const Z={multipleChoice:{buttonVisible:!0,hintVisible:!1},trueFalse:{buttonVisible:!0,hintVisible:!1},input:{buttonVisible:!0,hintVisible:!1}},pe={isInTestCreation:!0,currentStep:I,timestamp:Date.now(),excelState:Z};localStorage.setItem("test_creation_state",JSON.stringify(pe)),console.log(" Saved test creation state:",pe);const oe={};switch(I){case"testTypeSelection":break;case"multipleChoiceForm":oe.testName=C.testName||"",oe.numQuestions=C.numQuestions||"",oe.numOptions=C.numOptions||"",oe.questions=C.questions||{};break;case"trueFalseForm":oe.testName=C.testName||"",oe.numQuestions=C.numQuestions||"",oe.questions=C.questions||{};break;case"inputForm":oe.testName=C.testName||"",oe.numQuestions=C.numQuestions||"",oe.questions=C.questions||{};break;case"formCreation":oe.testName=C.testName||"",oe.numQuestions=C.numQuestions||"",oe.numOptions=C.numOptions||"",oe.questions=C.questions||{},oe.enableTimer=!!C.enableTimer,oe.timerMinutes=C.timerMinutes||"",oe.isShuffled=!!C.isShuffled;break;case"assignment":case"testAssignment":oe.testName=C.testName||"",oe.numQuestions=C.numQuestions||"",oe.numOptions=C.numOptions||"",oe.questions=C.questions||{};break;default:console.log(" Unknown step in saveTestCreationState:",I);break}Object.keys(oe).length>0&&(localStorage.setItem(`form_data_${I}`,JSON.stringify(oe)),console.log(" Saved form data for step:",I,oe))},[t,C]),L=b.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in clearTestCreationState, redirecting to login");return}localStorage.removeItem("test_creation_state"),localStorage.removeItem("test_creation_form_data");const I=[];for(let Z=0;Z<localStorage.length;Z++){const pe=localStorage.key(Z);pe&&(pe.includes("test")||pe.includes("form")||pe.includes("question"))&&I.push(pe)}I.forEach(Z=>{localStorage.removeItem(Z),console.log(" Removed localStorage key:",Z)}),console.log(" Cleared test creation state from localStorage")},[t]);b.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in clearAllTestFields, redirecting to login");return}console.log(" Clearing all test form fields..."),F({testName:"",numQuestions:0,numOptions:0,questions:{}}),p(null),R([]),B(null),console.log(" Cleared all test form fields")},[t]);const ne=b.useCallback(()=>{console.log(" Resetting Excel upload state..."),ht({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),["multiple-choice","true-false","input","word-matching"].forEach(Z=>{const pe=document.querySelector(`.excel-upload-btn[data-test-type="${Z}"]`);pe&&(pe.style.display="none",console.log(" Excel button hidden for:",Z));const oe=document.querySelector(`.excel-hint[data-test-type="${Z}"]`);oe&&(oe.style.display="none",console.log(" Excel hint hidden for:",Z));const Ee=document.querySelector(`.excel-file-input[data-test-type="${Z}"]`);Ee&&(Ee.value="",console.log(" File input cleared for:",Z))}),console.log(" Excel upload state reset complete")},[]),de=b.useCallback(()=>{console.log(" Setting up auto-save listeners for initial form fields..."),["testName","numQuestions","numOptions","enableTimer","timerMinutes","isShuffled"].forEach(Z=>{const pe=document.getElementById(Z);pe&&pe.addEventListener("input",()=>{console.log(` Auto-save triggered for field: ${Z}`)})}),console.log(" Form auto-save setup complete")},[]);b.useCallback(async I=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in saveFormDataForStep, redirecting to login");return}console.log("  saveFormDataForStep called with step:",I),console.log("  Call stack:",new Error().stack);const Z={};switch(I){case"testTypeSelection":break;case"multipleChoiceForm":Z.testName=C.testName||"",Z.numQuestions=C.numQuestions||"",Z.numOptions=C.numOptions||"",Z.questions=C.questions||{};break;case"trueFalseForm":Z.testName=C.testName||"",Z.numQuestions=C.numQuestions||"",Z.questions=C.questions||{};break;case"inputForm":Z.testName=C.testName||"",Z.numQuestions=C.numQuestions||"",Z.questions=C.questions||{};break;case"formCreation":Z.testName=C.testName||"",Z.numQuestions=C.numQuestions||"",Z.numOptions=C.numOptions||"",Z.questions=C.questions||{};break;default:console.log(" Unknown step for form data save:",I);return}localStorage.setItem("test_creation_form_data",JSON.stringify({step:I,data:Z,timestamp:Date.now()})),console.log(" Saved form data for step:",I,Z)},[t,C]);const G=b.useCallback(async I=>{console.log(" Restoring form data for step:",I);try{const Z=localStorage.getItem(`form_data_${I}`);if(Z){const pe=JSON.parse(Z);console.log(" Restored form data:",pe),F(oe=>{const Ee={...oe,...pe};return console.log(" Updated formData with restored data:",Ee),console.log(" Matching test data in restored data:",Ee.matchingTestData),Ee}),Object.keys(pe).forEach(oe=>{const Ee=document.getElementById(oe);Ee&&pe[oe]!==void 0&&(Ee.value=pe[oe])}),console.log(" Form data restored for step:",I)}else console.log(" No saved data found for step:",I)}catch(Z){console.error(" Error restoring form data:",Z)}},[t]),K=b.useCallback(()=>{console.log(" Setting up multiple choice form auto-save..."),["mcNumOptions"].forEach(pe=>{const oe=document.getElementById(pe);oe&&oe.addEventListener("input",()=>{console.log(` Auto-save triggered for MC field: ${pe}`)})}),document.querySelectorAll("#mcQuestionsContainer input, #mcQuestionsContainer textarea, #mcQuestionsContainer select").forEach(pe=>{pe.addEventListener("input",()=>{console.log(" Auto-save triggered for MC question field")})}),console.log(" Multiple choice form auto-save setup complete")},[]),Q=b.useCallback(()=>{console.log(" Setting up true/false form auto-save..."),document.querySelectorAll("#tfQuestionsContainer input, #tfQuestionsContainer textarea, #tfQuestionsContainer select").forEach(Z=>{Z.addEventListener("input",()=>{console.log(" Auto-save triggered for TF question field")})}),console.log(" True/false form auto-save setup complete")},[]),q=b.useCallback(()=>{console.log(" Setting up input form auto-save..."),document.querySelectorAll("#inputQuestionsContainer input, #inputQuestionsContainer textarea, #inputQuestionsContainer select").forEach(Z=>{Z.addEventListener("input",()=>{console.log(" Auto-save triggered for Input question field")})}),console.log(" Input form auto-save setup complete")},[]),se=b.useCallback(I=>{console.log(" showExcelUploadButton called with testType:",I);const Z=I==="multiple-choice"?"multipleChoice":I==="true-false"?"trueFalse":I==="input"?"input":I;ht(pe=>({...pe,[Z]:{...pe[Z],buttonVisible:!0}}))},[]),W=b.useCallback(I=>{console.log(" showExcelHint called with testType:",I);const Z=I==="multiple-choice"?"multipleChoice":I==="true-false"?"trueFalse":I==="input"?"input":I;ht(pe=>({...pe,[Z]:{...pe[Z],hintVisible:!0}}))},[]),ee=b.useCallback(async(I,Z,pe)=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in displayTestAssignmentOptions, redirecting to login");return}console.log("displayTestAssignmentOptions called with:",{classes:I,testType:Z,testId:pe}),v(I),console.log(" Test assignment options displayed for:",{testType:Z,testId:pe,classesCount:I.length})},[t]),ve=b.useCallback(async(I,Z)=>{try{if(console.log("Loading teacher grades and classes for test assignment"),!t||!t.teacher_id){console.error("No valid teacher session found, redirecting to login");return}console.log("Teacher ID:",t.teacher_id);const oe=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${t.teacher_id}`)).json();console.log("Teacher subjects response:",oe),oe.success&&oe.subjects&&oe.subjects.length>0?(console.log("Teacher subjects loaded:",oe.subjects),v(oe.subjects),ee(oe.subjects,I,Z)):(console.log("No teacher subjects found"),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(pe){console.error("Error loading teacher grades and classes:",pe),r("Error loading teacher grades and classes","error")}},[t,r,ee]),_e=b.useCallback(async()=>{console.log(" Loading available classes...");try{const I=await $r.getGradesAndClasses();if(console.log(" Raw grades/classes data:",I),!I||I.length===0){v([]);return}const Z=new Map;I.forEach(oe=>{const Ee=oe.subject_id,Ue=oe.subject||`Subject ${Ee}`;Z.has(Ee)||Z.set(Ee,{subject_id:Ee,subject:Ue,classes:[]}),Z.get(Ee).classes.push({grade:oe.grade,class:oe.class})});const pe=Array.from(Z.values());v(pe),console.log(" Transformed available classes:",pe)}catch(I){console.error(" Error loading available classes:",I),r("Failed to load available classes","error")}},[r]);b.useCallback(async(I,Z)=>{if(i){o(!1);return}if(!t||!t.teacher_id){console.error("No valid teacher session found in showTestAssignment, redirecting to login");return}z(),U("testAssignment"),B(Z),p(I),u("testAssignment"),ve(I,Z),_e(),console.log(" Test assignment interface shown for:",{testType:I,testId:Z})},[i,t,z,U,ve,_e]);const Le=b.useCallback(async I=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in displayTeacherActiveTests, redirecting to login");return}if(console.log(" Displaying teacher active tests:",I),I.length===0){$e([]);return}$e(I),console.log(" Active tests displayed:",I.length,"tests")},[t]);b.useCallback(async(I,Z)=>{try{console.log(" Loading test questions for:",{testType:I,testId:Z});const pe=await Tr.getTestQuestions(Z,I);return console.log(" Test questions loaded:",pe),pe}catch(pe){throw console.error("Error loading test questions:",pe),pe}},[]),b.useCallback((I,Z,pe,oe)=>{console.log(" Showing teacher test details modal:",{testType:I,testId:Z,testName:pe,questionsCount:oe.length}),console.log("Test Details:",{testType:I,testId:Z,testName:pe,questions:oe.map(Ee=>({id:Ee.question_id,question:Ee.question,correctAnswer:Ee.correct_answer}))}),r(`Test details for "${pe}" loaded successfully.`,"success")},[r]);const te=b.useCallback(async()=>{console.log(" DEBUG: loadTeacherActiveTests called");try{console.log(" DEBUG: Fetching teacher active tests using JWT authentication...");const I=await Tr.getTeacherTests();console.log(" DEBUG: Tests loaded:",I),I&&I.length>0?(console.log(" DEBUG: Success! Displaying",I.length,"tests"),Le(I)):(console.log(" DEBUG: No tests found"),$e([]))}catch(I){console.error(" DEBUG: Error loading active tests:",I),r("Error loading active tests.","error")}},[r,Le]),Ne=b.useCallback(()=>{console.log("showTestCreationSuccessMessage called"),r("Test created and assigned successfully!","success"),u("typeSelection"),F({testName:"",numQuestions:0,numOptions:0,questions:{}}),R([]),o(!1),a(!1),L()},[r,L]),Ce=b.useCallback(async(I,Z)=>{if(console.log(" === ASSIGN TEST TO CLASSES DEBUG START ==="),console.log(" Test Type:",I),console.log(" Test ID:",Z),console.log(" Current formData:",C),console.log(" Selected Classes:",D),console.log(" User:",t),!t||!t.teacher_id){console.error(" No valid teacher session found in assignTestToClasses, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}if(console.log(" Teacher ID:",t.teacher_id),D.length===0){console.warn(" No classes selected"),r("Please select at least one class.","warning");return}try{console.log(" Preparing test + assignment request...");const pe=D.map(Oe=>{const ut={grade:parseInt(Oe.grade),class:parseInt(Oe.class),subject_id:parseInt(Oe.subject_id),academic_period_id:8,due_date:null};return console.log(" Created assignment:",ut),ut});if(console.log(" Final assignments array:",pe),I==="matching"){console.log(" Processing matching test..."),console.log(" Setting isAssigningTest to true for matching test..."),A(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Ye=>setTimeout(Ye,100));const Oe=C.matchingTestData;if(console.log(" Matching test data from formData:",Oe),!Oe){console.error(" Matching test data not found in formData"),r("Matching test data not found. Please recreate the test.","error");return}console.log(" Matching test data found, processing...");let ut;Oe.processedQuestions?(console.log(" Using pre-processed questions from MatchingTestCreator"),ut=Oe.processedQuestions):(console.log(" Converting blocks to questions (fallback)..."),console.log(" Blocks:",Oe.blocks),console.log(" Words:",Oe.words),console.log(" Arrows:",Oe.arrows),ut=Oe.blocks.map((Ye,mt)=>{var re;const pt=((re=Oe.words.find(Xe=>Xe.blockId===Ye.id))==null?void 0:re.word)||`Word ${mt+1}`,Bt=Oe.arrows.some(Xe=>Xe.startBlock===Ye.id),Et=Oe.arrows.find(Xe=>Xe.startBlock===Ye.id)||null,St={question_id:mt+1,word:pt,block_coordinates:{x:Ye.x,y:Ye.y,width:Ye.width,height:Ye.height},has_arrow:Bt,arrow:Et?{startX:Et.startX,startY:Et.startY,endX:Et.endX,endY:Et.endY,style:Et.style||{}}:null};return console.log(` Question ${mt+1}:`,St),St})),console.log(" Final questions array:",ut);const he={teacher_id:t.teacher_id,test_name:C.testName,image_url:Oe.imageUrl,num_blocks:Oe.blocks.length,questions:ut,allowed_time:C.enableTimer?Math.max(0,Math.floor(Number(C.timerMinutes||0)*60)):null,assignments:pe};console.log(" Final matching test data payload:",he),console.log(" Calling testService.saveMatchingTest...");const je=await Tr.saveMatchingTest(he);console.log(" API Response:",je),je.success?(console.log(" Matching test created and assigned successfully!"),r("Matching test created and assigned successfully!","success"),console.log("Matching test created and assigned successfully"),o(!0),We()):(console.error(" Failed to create matching test:",je.message),r("Error creating and assigning matching test: "+je.message,"error")),A(!1);return}if(I==="wordMatching"){console.log(" Processing word matching test..."),console.log(" Setting isAssigningTest to true for word matching test..."),A(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Ye=>setTimeout(Ye,100));const Oe=C.wordMatchingData;if(console.log(" Word matching test data from formData:",Oe),!Oe){console.error(" Word matching test data not found in formData"),r("Word matching test data not found. Please recreate the test.","error");return}console.log(" Word matching test data found, processing...");const ut=Oe.wordPairs.map((Ye,mt)=>({question_id:mt+1,left_word:Ye.leftWord,right_word:Ye.rightWord}));console.log(" Final word matching questions array:",ut);const he={teacher_id:t.teacher_id,test_type:"word_matching",test_name:C.testName,num_questions:Oe.wordPairs.length,interaction_type:Oe.interactionType||"drag",questions:ut,allowed_time:C.enableTimer?Math.max(0,Math.floor(Number(C.timerMinutes||0)*60)):null,assignments:pe};console.log(" Final word matching test data payload:",he),console.log(" Calling testService.assignTestToClasses for word matching...");const je=await Tr.assignTestToClasses(he);console.log(" API Response:",je),je.success?(console.log(" Word matching test created and assigned successfully!"),r("Word matching test created and assigned successfully!","success"),console.log("Word matching test created and assigned successfully"),o(!0),We()):(console.error(" Failed to create word matching test:",je.message),r("Error creating and assigning word matching test: "+je.message,"error")),A(!1);return}if(I==="drawing"){console.log(" Processing drawing test..."),console.log(" Setting isAssigningTest to true for drawing test..."),A(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Ye=>setTimeout(Ye,100));const Oe=C.drawingData;if(console.log(" Drawing test data from formData:",Oe),!Oe){console.error(" Drawing test data not found in formData"),r("Drawing test data not found. Please recreate the test.","error");return}console.log(" Drawing test data found, processing...");const ut=Oe.questions||[];console.log(" Drawing questions array:",ut);const he={teacher_id:t.teacher_id,test_type:"drawing",test_name:C.testName,num_questions:Oe.num_questions,passing_score:Oe.passing_score,questions:ut,allowed_time:C.enableTimer?Math.max(0,Math.floor(Number(C.timerMinutes||0)*60)):null,assignments:pe};console.log(" Final drawing test data payload:",he),console.log(" Calling testService.assignTestToClasses...");const je=await Tr.assignTestToClasses(he);console.log(" API Response:",je),je.success?(console.log(" Drawing test created and assigned successfully!"),r("Drawing test created and assigned successfully!","success"),o(!0),We()):(console.error(" Failed to create drawing test:",je.message),r("Error creating and assigning drawing test: "+je.message,"error")),A(!1);return}if(I==="fillBlanks"){console.log(" Processing fill blanks test..."),console.log(" Setting isAssigningTest to true for fill blanks test..."),A(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Ye=>setTimeout(Ye,100));const Oe=C.fillBlanksData;if(console.log(" Fill blanks test data from formData:",Oe),!Oe){console.error(" Fill blanks test data not found in formData"),r("Fill blanks test data not found. Please recreate the test.","error");return}console.log(" Fill blanks test data found, processing...");const ut=Oe.blanks||[];console.log(" Fill blanks questions array:",ut);const he={teacher_id:t.teacher_id,test_type:"fill_blanks",test_name:C.testName,test_text:Oe.test_text,num_questions:Oe.num_questions,num_blanks:Oe.num_blanks,separate_type:Oe.separate_type,allowed_time:C.enableTimer?Math.max(0,Math.floor(Number(C.timerMinutes||0)*60)):null,questions:ut,assignments:pe};console.log(" Final fill blanks test data payload:",he),console.log(" Calling testService.assignTestToClasses...");const je=await Tr.assignTestToClasses(he);console.log(" API Response:",je),je.success?(console.log(" Fill blanks test created and assigned successfully!"),r("Fill blanks test created and assigned successfully!","success"),o(!0),We()):(console.error(" Failed to create fill blanks test:",je.message),r("Error creating and assigning fill blanks test: "+je.message,"error")),A(!1);return}console.log(" Processing non-matching test..."),console.log(" Form data questions:",C.questions);const oe=Object.keys(C.questions).map(Oe=>{var Ye;const ut=C.questions[Oe];console.log(` Processing question ${Oe}:`,ut);let he;I==="input"?he={correct_answers:ut.correct_answers||[ut.correctAnswer||""]}:he={correct_answer:ut.correctAnswer||((Ye=ut.correct_answers)==null?void 0:Ye[0])||""};const je={question_id:parseInt(Oe),question:ut.question,...he,options:ut.options||[]};return console.log(` Question ${Oe} correct_answers:`,ut.correct_answers),console.log(` Question ${Oe} correctAnswer:`,ut.correctAnswer),console.log(` Converted question ${Oe}:`,je),je});console.log(" Final questions array:",oe);const Ee={teacher_id:t.teacher_id,test_type:oge[I],test_name:C.testName,num_questions:C.numQuestions,num_options:C.numOptions,questions:oe,allowed_time:C.enableTimer?Math.max(0,Math.floor(Number(C.timerMinutes||0)*60)):null,is_shuffled:!!C.isShuffled,assignments:pe};console.log(" Final test data payload:",Ee),console.log(" Setting isAssigningTest to true..."),A(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Oe=>setTimeout(Oe,100)),console.log(" Calling testService.assignTestToClasses...");const Ue=await Tr.assignTestToClasses(Ee);console.log(" API Response:",Ue),Ue.success?(console.log(" Test created and assigned successfully!"),r("Test created and assigned successfully!","success"),console.log("Test created and assigned successfully"),o(!0),We()):(console.error(" Failed to create and assign test:",Ue.message),r("Error creating and assigning test: "+Ue.message,"error"))}catch(pe){console.error(" Exception in assignTestToClasses:",pe),console.error("Error creating and assigning test:",pe),r("Error creating and assigning test. Please try again.","error")}finally{A(!1)}console.log(" === ASSIGN TEST TO CLASSES DEBUG END ===")},[t,D,C,r,Ne]),We=b.useCallback(async()=>{console.log("returnToMainCabinet called - restoring main cabinet view");try{a(!1),o(!1),u("typeSelection"),p(null),B(null),R([]),H(),L(),Ne(),console.log(" Returned to main cabinet")}catch(I){console.error("Error returning to main cabinet:",I)}},[H,L,Ne]),[nt,$e]=b.useState([]),[De,at]=b.useState(!1);b.useCallback(async()=>{console.log(" Refreshing active tests data...");try{await te(),r("Active tests data refreshed.","success")}catch(I){console.error("Error refreshing active tests data:",I),r("Error refreshing data.","error")}},[te,r]);const[Se,Ae]=b.useState([]),[Me,Ie]=b.useState([]),[Ge,tt]=b.useState(!1),[kt,zt]=b.useState(!1),bt=b.useCallback(async I=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in displayExistingSubjectsInSelection, redirecting to login");return}console.log("Displaying existing subjects in selection interface:",I),Ae(I),console.log(" Existing subjects displayed in selection:",I.length,"subjects")},[t]);b.useCallback(async()=>{try{console.log("Loading existing subjects...");const I=await $r.getTeacherSubjects();console.log("Existing subjects loaded:",I),I&&I.length>0?bt(I):(console.log("No existing subjects found"),Ae([]))}catch(I){console.error("Error loading existing subjects:",I),r("Error loading subjects.","error")}},[r,bt]);const Dt=b.useCallback(I=>{console.log("Checking for outside click...");const Z=document.getElementById("dropdownMenu"),pe=document.querySelector("[data-menu-button]");Z&&!Z.contains(I.target)&&!(pe!=null&&pe.contains(I.target))&&(console.log("Outside click detected, closing menu"),Z.classList.remove("show"),document.removeEventListener("click",Dt))},[]),[it,ht]=b.useState({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),Ct=b.useCallback((I,Z)=>{const pe=I.target.files[0];if(!pe)return;if(!pe.name.match(/\.(xlsx|xls)$/i)){r("Please select a valid Excel file (.xlsx or .xls)","error"),I.target.value="";return}if(pe.size>5*1024*1024){r("File is too large. Please select a file smaller than 5MB.","error"),I.target.value="";return}N(!0);const oe=new FileReader;oe.onload=function(Ee){try{console.log(" File loaded, processing data...");const Ue=new Uint8Array(Ee.target.result),Oe=ZS(Ue,{type:"array"}),ut=Oe.SheetNames[0],he=Oe.Sheets[ut],je=zx.sheet_to_json(he,{header:1});console.log(" Parsed Excel data:",je),Fe(je,Z),N(!1)}catch(Ue){console.error("Error processing Excel file:",Ue),r("Error reading Excel file: "+Ue.message,"error"),I.target.value="",N(!1)}},oe.onerror=function(){r("Failed to read file","error"),I.target.value="",N(!1)},oe.readAsArrayBuffer(pe)},[r]),jt=b.useCallback(()=>{console.log(" Initializing Excel upload for all test types...");const I=document.querySelectorAll(".excel-upload-btn");console.log(` Found ${I.length} Excel upload buttons`),I.forEach((Z,pe)=>{const oe=Z.dataset.testType,Ee=document.querySelector(`.excel-file-input[data-test-type="${oe}"]`);console.log(` Processing button ${pe+1}: testType=${oe}, fileInput=${Ee?"found":"not found"}`),Ee?(Z._excelClickHandler&&Z.removeEventListener("click",Z._excelClickHandler),Ee._excelChangeHandler&&Ee.removeEventListener("change",Ee._excelChangeHandler),Z._excelClickHandler=()=>{console.log(` Excel upload button clicked for test type: ${oe}`),Ee.click()},Ee._excelChangeHandler=Ue=>{console.log(` File input changed for test type: ${oe}`),Ct(Ue,oe)},Z.addEventListener("click",Z._excelClickHandler),Ee.addEventListener("change",Ee._excelChangeHandler),console.log(` Excel upload initialized for test type: ${oe}`)):console.warn(` File input not found for test type: ${oe}`)}),console.log(" Excel upload initialization complete")},[Ct]),Fe=b.useCallback((I,Z)=>{const pe=I.filter(he=>Array.isArray(he)&&he.length>0&&he.some(je=>je&&je.toString().trim()!==""));console.log(" Original Excel data rows:",I.length),console.log(" Filtered Excel data rows:",pe.length);const Ee=et(pe,Z).dataRows;if(Ee.length===0){const he="No data rows found after header processing. Please check your Excel file.";r(he,"error"),alert(he),ye(Z);return}console.log(` Processing Excel data for test type: ${Z}`),console.log(" Data rows after header processing:",Ee);const Ue=dt(Ee,Z);if(console.log(" Recognition result:",Ue),!Ue.recognized){console.log(` Excel data recognition failed for test type: ${Z}`);const he="Excel data recognition failed. Please check your file format.";r(he,"error"),alert(he),ye(Z);return}console.log(` Excel data recognition successful for test type: ${Z}`);const Oe=Ee.length,ut=ue(Z);if(ut===0)console.log(` No question count specified, using CSV count: ${Oe}`),F(he=>({...he,numQuestions:Oe}));else if(Oe!==ut){const he=`Your CSV file has ${Oe} data rows, but you specified ${ut} questions.

Please either:
1. Change your question count to ${Oe}, or
2. Fix your CSV file to have exactly ${ut} data rows

Then try uploading again.`;r(he,"error"),ye(Z);return}be(Ee,Z)},[r]),et=b.useCallback((I,Z)=>{if(I.length===0)return{hasHeaders:!1,headerRow:null,dataRows:I};const pe=I[0],oe=Ze(Z);if(rt(pe,oe).isLikelyHeader){const Ue=`The first row of your Excel file looks like it contains headers:

"${pe.join(" | ")}"

Does the first row contain column headers?

Click "OK" if YES (headers will be removed)
Click "Cancel" if NO (first row will be treated as data)`;if(window.confirm(Ue))return{hasHeaders:!0,headerRow:pe,dataRows:I.slice(1)}}return{hasHeaders:!1,headerRow:null,dataRows:I}},[]),Ze=b.useCallback(I=>{switch(I){case"multipleChoice":return{keywords:["question","answer","correct","option","a","b","c","d","e","f"],expectedColumns:4};case"trueFalse":return{keywords:["question","answer","correct","true","false"],expectedColumns:2};case"input":return{keywords:["question","answer","correct"],expectedColumns:2};default:return{keywords:[],expectedColumns:0}}},[]),rt=b.useCallback((I,Z)=>{if(!I||I.length===0)return{isLikelyHeader:!1};if(I.length<Z.expectedColumns)return{isLikelyHeader:!1};const pe=I.join(" ").toLowerCase(),oe=Z.keywords.filter(Ue=>pe.includes(Ue.toLowerCase()));return{isLikelyHeader:oe.length>Z.keywords.length/2,keywordMatches:oe}},[]),dt=b.useCallback((I,Z)=>{if(I.length===0)return r("No data rows found. Please check your Excel file.","error"),{recognized:!1,data:[]};console.log(` Checking data pattern for test type: ${Z}`),console.log(" Excel data to validate:",I);const pe=Tt(I,Z);if(console.log(" Recognition result:",pe),!pe.matches){const oe=`Your Excel file doesn't match the expected format.

Required format:
${xe(Z)}

Please review your Excel file and make sure it follows this format exactly.

Then try uploading again.`;return console.log(" Data pattern validation failed:",oe),console.log(" Calling showNotification with message:",oe),r(oe,"error"),console.log(" showNotification called"),alert(oe),{recognized:!1,data:[]}}return console.log(` Data pattern validation passed for test type: ${Z}`),{recognized:!0,data:I}},[r]),Tt=b.useCallback((I,Z)=>{var pe;if(Z==="multipleChoice")for(let oe=0;oe<I.length;oe++){const Ee=I[oe];if(Ee.length<4)return{matches:!1,issue:`Row ${oe+1} has ${Ee.length} columns but needs at least 4`};if(!Ee[0]||Ee[0].toString().trim()==="")return{matches:!1,issue:`Row ${oe+1} has no question in column 1`};if(!Ee[1]||Ee[1].toString().trim()==="")return{matches:!1,issue:`Row ${oe+1} has no correct answer in column 2`}}else if(Z==="trueFalse")for(let oe=0;oe<I.length;oe++){const Ee=I[oe];if(Ee.length<2)return{matches:!1,issue:`Row ${oe+1} has ${Ee.length} columns but needs at least 2`};if(!Ee[0]||Ee[0].toString().trim()==="")return{matches:!1,issue:`Row ${oe+1} has no question in column 1`};const Ue=(pe=Ee[1])==null?void 0:pe.toString().trim().toLowerCase();if(!Ue||!["true","false","t","f"].includes(Ue))return{matches:!1,issue:`Row ${oe+1} has invalid correct answer in column 2 (must be True/False)`}}else if(Z==="input")for(let oe=0;oe<I.length;oe++){const Ee=I[oe];if(Ee.length<2)return{matches:!1,issue:`Row ${oe+1} has ${Ee.length} columns but needs at least 2`};if(!Ee[0]||Ee[0].toString().trim()==="")return{matches:!1,issue:`Row ${oe+1} has no question in column 1`};if(!Ee[1]||Ee[1].toString().trim()==="")return{matches:!1,issue:`Row ${oe+1} has no correct answer in column 2`}}return{matches:!0}},[]),xe=b.useCallback(I=>{switch(I){case"multipleChoice":return`Column 1: Question
Column 2: Correct Answer (A, B, C, D, E, or F)
Column 3: Option A
Column 4: Option B
Column 5: Option C (optional)
Column 6: Option D (optional)
Column 7: Option E (optional)
Column 8: Option F (optional)`;case"trueFalse":return`Column 1: Question
Column 2: Correct Answer (True or False)`;case"input":return`Column 1: Question
Column 2: Correct Answer`;default:return"Unknown test type"}},[]),ue=b.useCallback(I=>C.numQuestions||0,[C.numQuestions]),ye=b.useCallback(I=>{console.log(` Clearing file input for test type: ${I}`)},[]),be=b.useCallback((I,Z)=>{switch(console.log(` populateFromExcelForTestType called with testType: ${Z}`),Z){case"multipleChoice":case"multiple-choice":Ve(I);break;case"trueFalse":case"true-false":Nt(I);break;case"input":yt(I);break;default:console.log(` Unknown test type: ${Z}`)}},[]),Ve=b.useCallback(I=>{console.log(" populateMultipleChoiceFromExcel called with:",I);const Z=Math.max(...I.map(Ee=>Ee.length-2)),pe=Math.min(Z,6);console.log(` Excel data has ${Z} option columns, using ${pe} options`),F(Ee=>({...Ee,numOptions:pe}));const oe={};I.forEach((Ee,Ue)=>{const Oe=Ue+1;console.log(` Row ${Ue+1} data:`,Ee);const ut={question:(Ee[0]||"").toString().trim(),options:[],correctAnswer:(Ee[1]||"").toString().trim().toUpperCase()};console.log(` Question ${Oe} correctAnswer:`,ut.correctAnswer),["A","B","C","D","E","F"].slice(0,pe).forEach((Ye,mt)=>{const pt=(Ee[mt+2]||"").toString().trim();console.log(` Option ${mt} (${Ye}):`,pt),ut.options.push(pt)}),oe[Oe]=ut}),F(Ee=>{const Ue={...Ee,questions:oe};return console.log(" Updating form data with:",Ue),Ue}),console.log(" Populated multiple choice questions from Excel:",oe),r(`Successfully loaded ${I.length} questions from CSV file!`,"success"),K(),$t("multiple-choice")},[C.numOptions,K,r]),Nt=b.useCallback(I=>{console.log(" populateTrueFalseFromExcel called with:",I);const Z={};I.forEach((pe,oe)=>{var Oe;const Ee=oe+1,Ue={question:(pe[0]||"").toString().trim(),correctAnswer:((Oe=pe[1])==null?void 0:Oe.toString().trim().toLowerCase())==="true"?"true":"false"};Z[Ee]=Ue}),F(pe=>({...pe,questions:Z})),console.log(" Populated true/false questions from Excel:",Z),r(`Successfully loaded ${I.length} questions from CSV file!`,"success"),Q(),$t("true-false")},[Q,r]),yt=b.useCallback(I=>{console.log(" populateInputFromExcel called with:",I);const Z={};I.forEach((pe,oe)=>{const Ee=oe+1,Ue=[];for(let ut=1;ut<pe.length;ut++){const he=(pe[ut]||"").toString().trim();he&&Ue.push(he)}const Oe={question:(pe[0]||"").toString().trim(),correctAnswer:Ue[0]||"",correct_answers:Ue};console.log(` Excel question ${Ee} data:`,Oe),Z[Ee]=Oe}),F(pe=>({...pe,questions:Z})),console.log(" Populated input questions from Excel:",Z),r(`Successfully loaded ${I.length} questions from Excel file!`,"success"),q(),$t("input")},[q,r]),$t=b.useCallback(I=>{switch(console.log(` Reattaching form event listeners for test type: ${I}`),document.querySelectorAll('[data-listener-attached="true"]').forEach(pe=>{pe.removeEventListener("input",()=>{}),pe.removeAttribute("data-listener-attached")}),I){case"multiple-choice":K();break;case"true-false":Q();break;case"input":q();break;default:console.warn("Unknown test type for event listener reattachment:",I)}console.log(` Form event listeners reattached for test type: ${I}`)},[K,Q,q]),Ft=b.useCallback(()=>{const I=localStorage.getItem("test_creation_state");if(!I)return console.log(" No test creation state found in localStorage"),!1;try{const Z=JSON.parse(I);console.log(" Found test creation state:",Z);const pe=Date.now()-Z.timestamp,oe=30*60*1e3;if(pe>oe)return console.log(" Test creation state is too old, clearing it"),L(),!1;switch(a(!0),console.log(" Restored isInTestCreation flag to true"),z(),Z.excelState&&ne(),Z.currentStep){case"testTypeSelection":console.log(" Restoring test type selection step"),u("typeSelection");break;case"multipleChoiceForm":console.log(" Restoring multiple choice form step"),p("multipleChoice"),u("formCreation");break;case"trueFalseForm":console.log(" Restoring true/false form step"),p("trueFalse"),u("formCreation");break;case"inputForm":console.log(" Restoring input form step"),p("input"),u("formCreation");break;case"testAssignment":case"assignment":console.log(" Restoring test assignment step"),console.log(" Cannot restore test assignment step without test data, going back to type selection"),u("typeSelection");break;default:console.log(" Unknown step in state, defaulting to type selection"),u("typeSelection")}return G(Z.currentStep),!0}catch(Z){return console.error(" Error restoring test creation state:",Z),L(),!1}},[L,z,ne,G]);b.useEffect(()=>{console.log(" Initializing Teacher Tests..."),J(),Ft(),_e(),jt()},[J,Ft,_e,jt]),b.useEffect(()=>{C.numQuestions>0&&h&&h!=="matching"&&h!=="drawing"&&h!=="fillBlanks"&&(console.log(" Excel upload buttons rendered, initializing event listeners..."),setTimeout(()=>{jt()},100))},[C.numQuestions,h,jt]);const Ot=I=>{console.log(" Test type selected:",I),console.log(" Setting testType to:",I),p(I),u("formCreation"),F({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:""}),U("formCreation"),setTimeout(()=>{jt()},100)},xr=(I,Z)=>{F(pe=>({...pe,[I]:Z}))},yr=(I,Z,pe)=>{F(oe=>({...oe,questions:{...oe.questions,[I]:{...oe.questions[I],[Z]:pe}}}))},qt=(I,Z,pe,oe=0)=>{const Ee={};for(let Ue=1;Ue<=pe;Ue++)I==="multipleChoice"?Ee[Ue]={question:"",options:Array.from({length:oe},()=>""),correctAnswer:""}:I==="trueFalse"?Ee[Ue]={question:"",correctAnswer:""}:I==="input"&&(Ee[Ue]={question:"",correct_answers:[""]});F(Ue=>({...Ue,questions:Ee})),I==="multipleChoice"?(se("multiple-choice"),W("multiple-choice")):I==="trueFalse"?(se("true-false"),W("true-false")):I==="input"&&(se("input"),W("input"))},hr=async()=>{if(!h||!C.testName||!C.numQuestions){r("Please fill in all required fields","error");return}console.log(" Test form completed, proceeding to assignment step"),U("testAssignment",C),u("testAssignment"),r("Test form completed! Now select classes and subjects.","success")},Nr=(I,Z,pe,oe,Ee)=>{R(pe?Ue=>[...Ue,{grade:I,class:Z,subject_id:oe,subject:Ee}]:Ue=>Ue.filter(Oe=>!(Oe.grade===I&&Oe.class===Z&&Oe.subject_id===oe)))},Ln=b.useCallback(async I=>{console.log(" [DEBUG] handleMatchingTestSave called"),console.log(" [DEBUG] Received testData:",I),console.log(" [DEBUG] Current formData:",C),console.log(" [DEBUG] Current testType:",h),console.log(" [DEBUG] Current user:",t),console.log(" [DEBUG] Current currentStep:",l),y(!0);try{const Z=I.blocks.map((Ee,Ue)=>{var je;const Oe=((je=I.words.find(Ye=>Ye.blockId===Ee.id))==null?void 0:je.word)||`Word ${Ue+1}`,ut=I.arrows.some(Ye=>Ye.startBlock===Ee.id),he=I.arrows.find(Ye=>Ye.startBlock===Ee.id)||null;return{question_id:Ue+1,word:Oe,block_coordinates:{x:Ee.x,y:Ee.y,width:Ee.width,height:Ee.height},has_arrow:ut,arrow:he?{startX:he.startX,startY:he.startY,endX:he.endX,endY:he.endY,style:he.style||{}}:null}}),pe={teacher_id:t.teacher_id,test_name:C.testName||`Matching Test - ${new Date().toLocaleString()}`,image_url:I.imageUrl,num_blocks:I.blocks.length,questions:Z,assignments:[]};console.log(" Sending matching test payload:",pe);const oe={...C,testName:pe.test_name,numQuestions:pe.num_blocks,numOptions:0,questions:Z.reduce((Ee,Ue,Oe)=>(Ee[Oe+1]={question:Ue.word,correctAnswer:Ue.word,options:[]},Ee),{}),matchingTestData:I};console.log(" Assignment form data:",oe),F(oe),U("testAssignment",oe),console.log(" Setting current step to testAssignment"),u("testAssignment"),r("Matching test data saved! Now select classes and subjects.","success")}catch(Z){console.error(" Error saving matching test:",Z),r("Failed to save matching test: "+Z.message,"error")}finally{y(!1)}},[t,C,h,r,U]),Y=b.useCallback(()=>{console.log(" Cancelling matching test creation"),u("typeSelection"),F({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),fe=b.useCallback(async I=>{console.log(" [DEBUG] handleWordMatchingTestSave called"),console.log(" [DEBUG] Received testData:",I),y(!0);try{F(Z=>{var pe;return{...Z,wordMatchingData:I,numQuestions:I.numQuestions||((pe=I.wordPairs)==null?void 0:pe.length)||0}}),u("testAssignment"),r("Word matching test created! Now assign it to classes.","success")}catch(Z){console.error("Error saving word matching test:",Z),r("Failed to save word matching test: "+Z.message,"error")}finally{y(!1)}},[r]),ae=b.useCallback(()=>{console.log(" Cancelling word matching test creation"),u("typeSelection"),F({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),ce=b.useCallback(async I=>{console.log(" [DEBUG] handleDrawingTestSave called"),console.log(" [DEBUG] Received testData:",I),y(!0);try{F(Z=>{var pe;return{...Z,drawingData:I,numQuestions:I.num_questions||((pe=I.questions)==null?void 0:pe.length)||0}}),u("testAssignment"),r("Drawing test created! Now assign it to classes.","success")}catch(Z){console.error(" Error saving drawing test:",Z),r("Error saving drawing test","error")}finally{y(!1)}},[r]),ge=b.useCallback(()=>{console.log(" Cancelling drawing test creation"),u("typeSelection"),F({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),V=b.useCallback(()=>{console.log(" Cancelling fill blanks test creation"),u("typeSelection"),F({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),ie=b.useCallback(async I=>{console.log(" [DEBUG] handleFillBlanksTestSave called"),console.log(" [DEBUG] Received testData:",I),y(!0);try{F(Z=>{var pe;return{...Z,fillBlanksData:I,numQuestions:I.num_questions||((pe=I.blanks)==null?void 0:pe.length)||0}}),u("testAssignment"),r("Fill blanks test created! Now assign it to classes.","success")}catch(Z){console.error(" Error saving fill blanks test:",Z),r("Error saving fill blanks test","error")}finally{y(!1)}},[r]);return c.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[c.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs(va,{mode:"wait",children:[l==="typeSelection"&&c.jsxs(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs(He,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),c.jsx("span",{children:"Back to Main"})]}),c.jsx("div",{className:"flex-1"})]}),c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Create New Test"}),c.jsx("p",{className:"text-gray-600",children:"Choose the type of test you want to create"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{type:"multipleChoice",title:"Multiple Choice",description:"Questions with multiple answer options",icon:"/pics/multiple-choice.png"},{type:"trueFalse",title:"True/False",description:"Questions with true or false answers",icon:"/pics/true-false.png"},{type:"input",title:"Input",description:"Questions requiring text input",icon:"/pics/input.png"},{type:"matching",title:"Picture Matching",description:"Labeling pictures",icon:"/pics/matching.png"},{type:"wordMatching",title:"Word Matching",description:"Matching word pairs by dragging or drawing arrows",icon:"/pics/matching-words.png"},{type:"drawing",title:"Drawing Test",description:"Interactive drawing tests with canvas for students",icon:"/pics/drawing.png"},{type:"fillBlanks",title:"Fill Blanks",description:"Text with multiple choice blanks",icon:"/pics/fill-blanks.png"}].map(({type:I,title:Z,description:pe,icon:oe})=>c.jsx(Be.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"cursor-pointer",onClick:()=>Ot(I),children:c.jsxs(st,{className:"h-full text-center hover:shadow-lg transition-shadow",children:[c.jsx("div",{className:"mb-3 flex justify-center",children:c.jsx("img",{src:oe,alt:Z,className:"w-12 h-12 object-contain"})}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:Z}),c.jsx("p",{className:"text-sm text-gray-600",children:pe})]})},I))})]}),l==="formCreation"&&c.jsxs(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"flex space-x-2",children:c.jsx(He,{variant:"outline",onClick:X,children:" Back to Test Types"})}),c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Create ",h==="multipleChoice"?"Multiple Choice":h==="trueFalse"?"True/False":h==="input"?"Input":h==="drawing"?"Drawing":h==="fillBlanks"?"Fill Blanks":h==="wordMatching"?"Word Matching":"Picture Matching"," Test"]}),c.jsx("p",{className:"text-gray-600",children:"Fill in the test details and questions"})]})]})}),c.jsx(st,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Information"}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Name"}),c.jsx("input",{type:"text",value:C.testName,onChange:I=>xr("testName",I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter test name"})]}),h!=="matching"&&h!=="wordMatching"&&h!=="drawing"&&h!=="fillBlanks"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Questions"}),c.jsx("input",{type:"number",min:"1",max:"50",value:C.numQuestions,onChange:I=>{const Z=parseInt(I.target.value)||0;xr("numQuestions",Z),Z>0&&qt(h,C.testName,Z,C.numOptions)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of questions"})]}),h==="multipleChoice"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Options per Question"}),c.jsx("input",{type:"number",min:"2",max:"6",value:C.numOptions,onChange:I=>{const Z=parseInt(I.target.value)||0;xr("numOptions",Z),Z>0&&Z<2&&r("Multiple choice tests require at least 2 options per question. Please enter 2 or more.","warning"),C.numQuestions>0&&qt(h,C.testName,C.numQuestions,Z)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of options (2-6)"})]}),c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs("label",{className:"inline-flex items-center space-x-2",children:[c.jsx("input",{type:"checkbox",checked:!!C.enableTimer,onChange:I=>xr("enableTimer",I.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),c.jsx("span",{className:"text-sm text-gray-700",children:"Enable timer for this test"})]}),C.enableTimer&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("label",{className:"text-sm text-gray-700",children:"Time (minutes):"}),c.jsx("input",{type:"number",min:"1",max:"1440",value:C.timerMinutes,onChange:I=>xr("timerMinutes",I.target.value.replace(/[^0-9]/g,"")),className:"w-28 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 30"})]}),h!=="drawing"&&h!=="matching"&&h!=="fillBlanks"&&c.jsxs("label",{className:"inline-flex items-center space-x-2 ml-6",children:[c.jsx("input",{type:"checkbox",checked:!!C.isShuffled,onChange:I=>xr("isShuffled",I.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),c.jsx("span",{className:"text-sm text-gray-700",children:"Shuffle questions during test"})]})]})]})}),h==="matching"&&c.jsx(st,{children:c.jsxs("div",{className:"space-y-4 text-center",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Picture Matching Test"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Upload an image and create interactive matching blocks with words."}),c.jsx(gq,{testName:C.testName,onTestSaved:Ln,onCancel:Y,onBackToCabinet:We,isSaving:_,validationErrors:{}})]})}),h==="wordMatching"&&c.jsx(st,{children:c.jsxs("div",{className:"space-y-4 text-center",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Word Matching Test"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Create word pairs for students to match by dragging or drawing arrows."}),c.jsx(cre,{testName:C.testName,onTestSaved:fe,onCancel:ae,onBackToCabinet:We,isSaving:_,validationErrors:{}})]})}),h==="drawing"&&c.jsxs("div",{className:"drawing-test-section",children:[console.log(" Rendering DrawingTestCreator, testType:",h),c.jsx(ere,{testName:C.testName,onTestSaved:ce,onCancel:ge,onBackToCabinet:We,isSaving:_,validationErrors:{}})]}),h==="fillBlanks"&&c.jsxs("div",{className:"fill-blanks-test-section",children:[console.log(" Rendering FillBlanksTestCreator, testType:",h),c.jsx(sre,{testName:C.testName,allowedTime:C.enableTimer&&parseInt(C.timerMinutes)||null,onTestSaved:ie,onCancel:V,onBackToCabinet:We,isSaving:_,validationErrors:{}})]}),h!=="matching"&&h!=="drawing"&&h!=="fillBlanks"&&C.numQuestions>0&&c.jsx(st,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Excel Upload"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Upload an Excel file to automatically populate questions, or fill them in manually below."}),c.jsxs("div",{className:"space-y-6",children:[h==="multipleChoice"&&((we=it.multipleChoice)==null?void 0:we.buttonVisible)&&c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"multiple-choice",disabled:k,children:k?c.jsxs(c.Fragment,{children:[c.jsx(nr,{size:"sm",color:"white"}),c.jsx("span",{className:"font-medium",children:"Processing..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),c.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),c.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"multiple-choice"})]}),c.jsx("div",{className:"w-fit",children:c.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:c.jsxs("div",{className:"text-sm text-blue-800",children:[c.jsx("strong",{children:"Multiple Choice Format:"}),c.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[c.jsx("div",{children:"Column 1: Question"}),c.jsx("div",{children:"Column 2: Correct Answer (A-F)"}),c.jsx("div",{children:"Column 3: Option A text"}),c.jsx("div",{children:"Column 4: Option B text"}),c.jsx("div",{children:"Column 5: Option C text"}),c.jsx("div",{children:"Column 6: Option D text"})]})]})})})]}),h==="trueFalse"&&((me=it.trueFalse)==null?void 0:me.buttonVisible)&&c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"true-false",disabled:k,children:k?c.jsxs(c.Fragment,{children:[c.jsx(nr,{size:"sm",color:"white"}),c.jsx("span",{className:"font-medium",children:"Processing..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),c.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),c.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"true-false"})]}),c.jsx("div",{className:"w-fit",children:c.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:c.jsxs("div",{className:"text-xs text-blue-800",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Format:"})," Question | Answer (true/false)"]}),c.jsxs("div",{className:"mt-1",children:[c.jsx("strong",{children:"Example:"})," The Earth is round | true"]}),c.jsxs("div",{className:"mt-1",children:[c.jsx("strong",{children:"Note:"})," Headers are optional"]})]})})})]}),h==="input"&&((Te=it.input)==null?void 0:Te.buttonVisible)&&c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"input",disabled:k,children:k?c.jsxs(c.Fragment,{children:[c.jsx(nr,{size:"sm",color:"white"}),c.jsx("span",{className:"font-medium",children:"Processing..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),c.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),c.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"input"})]}),c.jsx("div",{className:"w-fit",children:c.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:c.jsxs("div",{className:"text-sm text-blue-800",children:[c.jsx("strong",{children:"Input Test Format:"}),c.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[c.jsx("div",{children:"Column 1: Question"}),c.jsx("div",{children:"Column 2: Answer 1"}),c.jsx("div",{children:"Column 3: Answer 2 (optional)"})]})]})})})]})]})]})}),h!=="matching"&&h!=="drawing"&&h!=="fillBlanks"&&C.numQuestions>0&&c.jsx(st,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Manual Question Entry"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Fill in the questions manually using the form below."})]})}),C.numQuestions>0&&c.jsx(st,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Questions"}),c.jsx("div",{className:"space-y-6",children:Object.keys(C.questions).map(I=>{var Z,pe,oe,Ee,Ue,Oe,ut,he,je,Ye,mt;return c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Question ",I]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text"}),c.jsx("textarea",{value:((Z=C.questions[I])==null?void 0:Z.question)||"",onChange:pt=>yr(I,"question",pt.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"2",placeholder:"Enter the question text"})]}),h==="multipleChoice"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Answer Options"}),c.jsx("div",{className:"space-y-2",children:(oe=(pe=C.questions[I])==null?void 0:pe.options)==null?void 0:oe.map((pt,Bt)=>c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("span",{className:"w-6 text-sm font-medium text-gray-700",children:[String.fromCharCode(65+Bt),":"]}),c.jsx("input",{type:"text",value:pt,onChange:Et=>{const St=[...C.questions[I].options];St[Bt]=Et.target.value,yr(I,"options",St)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Option ${String.fromCharCode(65+Bt)}`})]},Bt))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer"}),h==="multipleChoice"?c.jsx("div",{children:c.jsxs("select",{value:((Ee=C.questions[I])==null?void 0:Ee.correctAnswer)||"",onChange:pt=>yr(I,"correctAnswer",pt.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Select correct answer"}),(Oe=(Ue=C.questions[I])==null?void 0:Ue.options)==null?void 0:Oe.map((pt,Bt)=>c.jsx("option",{value:String.fromCharCode(65+Bt),children:String.fromCharCode(65+Bt)},Bt))]})}):h==="trueFalse"?c.jsxs("select",{value:((ut=C.questions[I])==null?void 0:ut.correctAnswer)||"",onChange:pt=>yr(I,"correctAnswer",pt.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"true",children:"True"}),c.jsx("option",{value:"false",children:"False"})]}):c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer(s)"}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("input",{type:"text",value:((je=(he=C.questions[I])==null?void 0:he.correct_answers)==null?void 0:je[0])||"",onChange:pt=>{var St;const Et=[...((St=C.questions[I])==null?void 0:St.correct_answers)||[""]];Et[0]=pt.target.value,yr(I,"correct_answers",Et)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter the primary correct answer"}),((mt=(Ye=C.questions[I])==null?void 0:Ye.correct_answers)==null?void 0:mt.slice(1).map((pt,Bt)=>c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("input",{type:"text",value:pt,onChange:Et=>{var re;const St=[...((re=C.questions[I])==null?void 0:re.correct_answers)||[]];St[Bt+1]=Et.target.value,yr(I,"correct_answers",St)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Alternative answer ${Bt+2}`}),c.jsx("button",{type:"button",onClick:()=>{var St;const Et=[...((St=C.questions[I])==null?void 0:St.correct_answers)||[]];Et.splice(Bt+1,1),yr(I,"correct_answers",Et)},className:"px-2 py-1 text-red-600 hover:text-red-800 text-sm",children:"Remove"})]},Bt)))||[],c.jsx("button",{type:"button",onClick:()=>{var Et;const Bt=[...((Et=C.questions[I])==null?void 0:Et.correct_answers)||[""],""];yr(I,"correct_answers",Bt)},className:"px-3 py-1 text-blue-600 hover:text-blue-800 text-sm border border-blue-300 rounded-md hover:bg-blue-50",children:"+ Add Alternative Answer"})]}),c.jsx("p",{className:"text-xs text-gray-500",children:"You can add multiple correct answers for the same question. Students will get credit for any of them."})]})]})]})]},I)})})]})}),C.testName&&C.numQuestions>0&&c.jsx("div",{className:"flex justify-end",children:c.jsx(He,{onClick:hr,disabled:_,className:"px-8",children:_?c.jsxs(c.Fragment,{children:[c.jsx(nr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test & Continue to Assignment"})})]}),l==="testAssignment"&&c.jsxs(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs(He,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),c.jsx("span",{children:"Back to Main"})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Assign Test to Classes"}),c.jsx("p",{className:"text-gray-600",children:"Select which classes should take this test"})]})]}),c.jsx(He,{variant:"outline",onClick:()=>u("formCreation"),children:" Back to Test Form"})]}),c.jsx(st,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Available Classes"}),x.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-6xl mb-4",children:""}),c.jsx("p",{className:"text-gray-500 text-lg",children:"No subjects available for assignment."}),c.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You need to assign subjects to grades and classes first."}),c.jsx("div",{className:"mt-4",children:c.jsx(He,{onClick:()=>window.location.href="/teacher/subjects",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Go to Subjects Page"})})]}):c.jsx("div",{className:"space-y-6",children:x.map(I=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:I.subject}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2",children:I.classes.map(Z=>c.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:D.some(pe=>pe.grade===Z.grade&&pe.class===Z.class&&pe.subject_id===I.subject_id),onChange:pe=>Nr(Z.grade,Z.class,pe.target.checked,I.subject_id,I.subject),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),c.jsxs("span",{className:"text-sm text-gray-700",children:[Z.grade,"/",Z.class]})]},`${Z.grade}-${Z.class}-${I.subject_id}`))})]},I.subject_id))})]})}),D.length>0&&c.jsx("div",{className:"flex justify-end",children:c.jsx(He,{onClick:()=>Ce(h,null),disabled:w,className:"px-8",children:w?c.jsxs(c.Fragment,{children:[c.jsx(nr,{size:"sm",color:"white",className:"mr-2"}),"Assigning Test..."]}):`Assign Test to ${D.length} Class${D.length>1?"es":""}`})})]})]})}),console.log(" Checking isAssigningTest:",E),E&&c.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Assigning test to classes..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your assignment"})]})}),_&&c.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Saving test..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we save your test"})]})}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:e.map(I=>c.jsx(Xi,{type:I.type,message:I.message,duration:I.duration,onClose:()=>n(I.id)},I.id))})]})},lge=({onDataLoaded:t,onError:e})=>{const r=Ha(),{user:n,isAuthenticated:s}=xn(),{teacherData:a,loadTeacherData:i}=Iv(),[o,l]=b.useState(!0),[u,d]=b.useState(""),[g,h]=b.useState([]),[p,x]=b.useState(null),[v,w]=b.useState([]),[S,_]=b.useState([]),[y,k]=b.useState([]),[N,E]=b.useState(null),[A,C]=b.useState(0);b.useEffect(()=>{J()},[]),b.useCallback(async z=>{console.log(" Teacher login attempt...");try{const H=await $r.teacherLogin(z);if(H.success)return B("Login successful!","success"),await F(),H;throw new Error(H.error||"Login failed")}catch(H){throw console.error(" Teacher login error:",H),B("Login failed. Please check your credentials.","error"),H}},[]);const F=b.useCallback(async()=>{console.log(" Loading teacher data...");try{if(l(!0),d(""),!s||!n){console.log(" User not authenticated"),d("User not authenticated");return}if(n.role!==ra.TEACHER){console.error(" Invalid user role for teacher data:",n.role),d("Access denied. Teacher role required.");return}console.log(" Fetching teacher data from service...");const z=await $r.getTeacherData();if(z&&z.success)console.log(" Teacher data loaded successfully:",z),x(z.teacher||n),z.subjects&&(w(z.subjects),console.log(" Teacher subjects loaded:",z.subjects.length)),z.grades&&_(z.grades),z.classes&&k(z.classes),E(new Date),C(H=>H+1),t&&t(z),B("Teacher data loaded successfully!","success");else throw new Error((z==null?void 0:z.error)||"Failed to load teacher data")}catch(z){console.error(" Error loading teacher data:",z);const H=z.message||"Failed to load teacher data";d(H),e&&e(z),B(H,"error")}finally{l(!1)}},[s,n,t,e]),D=b.useCallback(()=>{console.log(" Returning to main cabinet..."),r("/teacher/cabinet")},[r]);b.useCallback(z=>{console.log(" Showing main cabinet with subjects:",z),z&&w(z),r("/teacher/cabinet")},[r]);const R=b.useCallback(()=>(console.log(" Rendering grade buttons..."),["M1","M2","M3","M4","M5","M6"].map(H=>({id:H,name:`Grade ${H}`,classes:M(H)}))),[]),M=b.useCallback(z=>Array.from({length:10},(U,L)=>L+1).map(U=>({id:`${z}-${U}`,name:`Class ${U}`,grade:z,classNumber:U})),[]),B=b.useCallback((z,H)=>{const U={id:Date.now(),message:z,type:H,timestamp:new Date};h(L=>[...L,U]),setTimeout(()=>{h(L=>L.filter(ne=>ne.id!==U.id))},ya.NOTIFICATION_DURATION)},[]),J=b.useCallback(async()=>{console.log(" Initializing teacher data..."),await F()},[F]),X=b.useCallback(async()=>{console.log(" Refreshing teacher data..."),await F()},[F]);return b.useCallback(async z=>{console.log(" Updating teacher profile:",z);try{const H=await $r.updateUserProfile(z);if(H.success)return x(U=>({...U,...z})),B("Profile updated successfully!","success"),H;throw new Error(H.error||"Failed to update profile")}catch(H){throw console.error(" Error updating teacher profile:",H),B("Failed to update profile","error"),H}},[]),b.useCallback(async z=>{console.log(" Changing teacher password...");try{const H=await $r.changePassword(z);if(H.success)return B("Password changed successfully!","success"),H;throw new Error(H.error||"Failed to change password")}catch(H){throw console.error(" Error changing teacher password:",H),B("Failed to change password","error"),H}},[]),o?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(nr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Data..."})]})}):u?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Data Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:u}),c.jsxs("div",{className:"flex space-x-3 justify-center",children:[c.jsx(He,{variant:"primary",onClick:X,children:"Retry"}),c.jsx(He,{variant:"outline",onClick:D,children:"Go Back"})]})]})})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teacher Data"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",N?N.toLocaleString():"Never"," | Version: ",A]})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx(He,{variant:"outline",onClick:X,children:"Refresh Data"}),c.jsx(He,{variant:"outline",onClick:D,children:"Back to Cabinet"})]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teacher Information"}),p?c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Name:"}),c.jsx("p",{className:"text-sm text-gray-900",children:p.name||"N/A"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Username:"}),c.jsx("p",{className:"text-sm text-gray-900",children:p.username||"N/A"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Email:"}),c.jsx("p",{className:"text-sm text-gray-900",children:p.email||"N/A"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Role:"}),c.jsx("p",{className:"text-sm text-gray-900",children:p.role||"N/A"})]})]}):c.jsx("p",{className:"text-gray-500",children:"No teacher information available"})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Subjects (",v.length,")"]}),v.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.map((z,H)=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsx("h3",{className:"font-medium text-gray-900",children:z.name}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:z.description||"No description"}),z.classes&&z.classes.length>0&&c.jsxs("div",{className:"mt-2",children:[c.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Classes:"}),c.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:z.classes.map((U,L)=>c.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:[U.grade," - ",U.className]},L))})]})]},H))}):c.jsx("p",{className:"text-gray-500",children:"No subjects assigned"})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Grade Levels"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:R().map(z=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:z.name}),c.jsx("div",{className:"grid grid-cols-5 gap-1",children:z.classes.map(H=>c.jsx("button",{className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded transition-colors",onClick:()=>console.log("Class clicked:",H),children:H.classNumber},H.id))})]},z.id))})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Statistics"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-blue-600",children:v.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Subjects"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-green-600",children:S.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Grades"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-yellow-600",children:y.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Classes"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-purple-600",children:A}),c.jsx("p",{className:"text-sm text-gray-500",children:"Data Version"})]})]})]})]})}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:g.map(z=>c.jsx(Xi,{type:z.type,message:z.message,onClose:()=>h(H=>H.filter(U=>U.id!==z.id))},z.id))})]})},cge=({onBackToCabinet:t})=>{var at;const e=Ha(),{user:r,isAuthenticated:n}=xn(),{teacherData:s}=Iv(),[a,i]=b.useState(!0),[o,l]=b.useState(""),[u,d]=b.useState([]),[g,h]=b.useState([]),[p,x]=b.useState([]),[v,w]=b.useState([]),[S,_]=b.useState(null),[y,k]=b.useState([]),[N,E]=b.useState(!1),[A,C]=b.useState(!1),[F,D]=b.useState(!1),[R,M]=b.useState(!1),[B,J]=b.useState(null),[X,z]=b.useState(!0),[H,U]=b.useState(null);b.useEffect(()=>{$e()},[]),b.useCallback(Se=>{console.log(" Rendering existing subjects:",Se),h(Se)},[]);const L=b.useCallback(()=>{console.log(" Showing subject selection prompt..."),E(!0),z(!1),ne()},[]),ne=b.useCallback(async()=>{console.log(" Loading existing subjects...");try{const Se=await $r.getTeacherSubjects();Se.success&&Se.subjects&&Se.subjects.length>0?(console.log(" Existing subjects found:",Se.subjects),de(Se.subjects)):(console.log(" No existing subjects found"),w([]))}catch(Se){console.error(" Error loading existing subjects:",Se),nt("Failed to load existing subjects","error")}},[]),de=b.useCallback(Se=>{console.log(" Rendering subject selection:",Se);const Ae=[];Se.forEach(Me=>{Me.classes&&Array.isArray(Me.classes)&&Me.classes.forEach(Ie=>{Ae.push({id:`${Me.subject_id}-${Ie.grade}-${Ie.class}`,subjectId:Me.subject_id,subjectName:Me.subject,grade:Ie.grade,class:Ie.class,displayText:`${Me.subject} - ${Ie.grade}/${Ie.class}`})})}),w(Ae),console.log(" Processed subjects for selection:",Ae)},[]),G=b.useCallback(async Se=>{if(console.log(" Saving teacher subjects:",Se),!Se||Se.length===0){nt("Please select at least one subject and class combination.","warning");return}try{const Ae=Se.reduce((Ie,Ge)=>{const tt=Ie.find(kt=>kt.subject_id===Ge.subjectId);return tt?tt.classes.push({grade:Ge.grade,class:Ge.class}):Ie.push({subject_id:Ge.subjectId,classes:[{grade:Ge.grade,class:Ge.class}]}),Ie},[]);console.log(" Transformed data for backend:",Ae);const Me=await $r.saveTeacherSubjects(Ae);if(Me.success)nt("Subjects saved successfully!","success"),E(!1),z(!0),U(new Date),await ne();else throw new Error(Me.error||"Failed to save subjects")}catch(Ae){console.error(" Error saving subjects:",Ae),nt("Error saving subjects. Please try again.","error")}},[]),K=b.useCallback(()=>{console.log(" Toggling subject dropdown..."),C(Se=>!Se),D(!1)},[]),Q=b.useCallback(async()=>{var Se;console.log(" Loading subjects for dropdown...");try{const Ae=await $r.getAllSubjects();if(Ae.success)x(Ae.subjects||[]),console.log(" Available subjects loaded:",((Se=Ae.subjects)==null?void 0:Se.length)||0);else throw new Error(Ae.error||"Failed to load subjects")}catch(Ae){console.error(" Error loading subjects for dropdown:",Ae),nt("Failed to load subjects","error")}},[]),q=b.useCallback(Se=>{console.log(" Subject selected:",Se);const Ae=p.find(Me=>Me.subject_id===parseInt(Se));Ae&&(_(Ae),D(!0),C(!1),se())},[p]),se=b.useCallback(()=>{console.log(" Loading grades and classes...")},[]),W=b.useCallback((Se,Ae)=>{console.log(" Saving classes for subject:",Se,Ae);const Me={id:`${Se.subject_id}-${Date.now()}`,subjectId:Se.subject_id,subjectName:Se.subject,grade:Ae.grade,class:Ae.class,displayText:`${Se.subject} - ${Ae.grade}/${Ae.class}`};w(Ie=>[...Ie,Me]),_(null),k([]),D(!1),ve(`Added ${Se.subject} for ${Ae.grade}/${Ae.class}`)},[]),ee=b.useCallback(()=>{console.log(" Resetting subject selection..."),_(null),k([]),C(!1),D(!1)},[]),ve=b.useCallback(Se=>{console.log(" Showing message:",Se),nt(Se,"success")},[]),_e=b.useCallback(Se=>{console.log(" Showing confirmation modal:",Se),J(Se),M(!0)},[]),Le=b.useCallback(()=>{console.log(" Hiding confirmation modal..."),M(!1),J(null)},[]),te=b.useCallback(()=>{console.log(" Confirming save subjects..."),Le(),G(v)},[v,G,Le]),Ne=b.useCallback(()=>{console.log(" Cancelling save subjects..."),Le()},[Le]),Ce=b.useCallback(Se=>{console.log(" Removing subject:",Se),w(Ae=>Ae.filter(Me=>Me.id!==Se)),nt("Subject removed","info")},[]);b.useCallback(()=>{console.log(" Showing edit subjects button..."),z(!0)},[]),b.useCallback(()=>{console.log(" Hiding edit subjects button..."),z(!1)},[]);const We=b.useCallback(Se=>{console.log(" Generating class buttons for grade:",Se);let Ae;return Se===1||Se===2?Ae=["15","16"]:Se===3?Ae=["15","16"]:Se===4?Ae=["13","14"]:Se===5||Se===6?Ae=["13","14"]:Ae=[],Ae.map(Me=>({id:`${Se}-${Me}`,grade:Se,class:Me,displayText:`${Se}/${Me}`}))},[]);b.useCallback((Se,Ae)=>{console.log(" Showing class results:",Se,Ae),e("/teacher/results")},[e]);const nt=b.useCallback((Se,Ae)=>{const Me={id:Date.now(),message:Se,type:Ae,timestamp:new Date};d(Ie=>[...Ie,Me]),setTimeout(()=>{d(Ie=>Ie.filter(Ge=>Ge.id!==Me.id))},ya.NOTIFICATION_DURATION)},[]),$e=b.useCallback(async()=>{console.log(" Initializing teacher subjects...");try{if(i(!0),l(""),!n||!r){console.log(" User not authenticated"),l("User not authenticated");return}if(r.role!==ra.TEACHER){console.error(" Invalid user role for teacher subjects:",r.role),l("Access denied. Teacher role required.");return}await ne(),await Q(),console.log(" Teacher subjects initialization complete!")}catch(Se){console.error(" Error initializing teacher subjects:",Se),l("Failed to initialize teacher subjects")}finally{i(!1)}},[n,r,ne,Q]),De=b.useCallback(()=>{t?t():e("/teacher/cabinet")},[t,e]);return a?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(nr,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Subjects..."})]})}):o?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Subjects Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:o}),c.jsx(He,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Subject Management"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",H?H.toLocaleString():"Never"]})]}),c.jsxs("div",{className:"flex space-x-3",children:[X&&c.jsx(He,{variant:"primary",onClick:L,children:"Edit Subjects"}),c.jsx(He,{variant:"outline",onClick:De,children:"Back to Cabinet"})]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"space-y-6",children:[!N&&c.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Your Assigned Subjects"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your teaching subjects and class assignments"})]}),c.jsx("div",{className:"flex space-x-3",children:c.jsxs(He,{variant:"primary",onClick:L,className:"px-6 py-2",children:[c.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Subjects"]})})]}),g.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map((Se,Ae)=>c.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:Se.subject}),Se.classes&&Se.classes.length>0&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Assigned Classes:"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:Se.classes.map((Me,Ie)=>c.jsxs("span",{className:"px-3 py-1 bg-blue-500 text-white text-sm font-medium rounded-full",children:["Grade ",Me.grade," - Class ",Me.class]},Ie))})]})]}),c.jsx("div",{className:"ml-4",children:c.jsx(He,{variant:"outline",size:"sm",onClick:()=>Ce(Se.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]})},Ae))}):c.jsxs("div",{className:"text-center py-12",children:[c.jsx("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:c.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned yet"}),c.jsx("p",{className:"text-gray-500 mb-6",children:"Get started by adding your teaching subjects and class assignments"}),c.jsxs(He,{variant:"primary",onClick:L,className:"px-6 py-3",children:[c.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Your First Subject"]})]})]}),N&&c.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Select Subjects and Classes"}),c.jsx("p",{className:"text-gray-600",children:"Choose the subjects you want to teach and assign them to specific classes"})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:c.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:"1"})}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-lg font-semibold text-gray-900",children:"Select Subject"}),c.jsx("p",{className:"text-gray-600",children:"Choose the subject you want to teach"})]})]}),c.jsxs("div",{className:"relative",children:[c.jsxs(He,{variant:"outline",onClick:K,className:"w-full justify-between p-4 h-auto text-left border-2 border-gray-200 hover:border-blue-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white rounded-xl shadow-sm",children:[c.jsx("span",{className:"text-gray-900 font-medium",children:S?S.subject:"Select a subject"}),c.jsx("svg",{className:"w-5 h-5 ml-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),A&&c.jsx("div",{className:"absolute z-10 w-full mt-2 bg-white border-2 border-gray-200 rounded-xl shadow-xl max-h-60 overflow-y-auto",children:p.map(Se=>c.jsx("button",{onClick:()=>q(Se.subject_id),className:"w-full px-4 py-4 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 border-b border-gray-100 last:border-b-0",children:c.jsx("span",{className:"text-gray-900 font-medium",children:Se.subject})},Se.subject_id))})]})]}),F&&S&&c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center mb-6",children:[c.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3",children:c.jsx("span",{className:"text-green-600 font-semibold text-sm",children:"2"})}),c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Select Classes for ",S.subject]}),c.jsx("p",{className:"text-gray-600",children:"Choose which classes you want to teach this subject to"})]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(Se=>c.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-2",children:c.jsx("span",{className:"text-white font-bold text-xs",children:Se})}),c.jsxs("h4",{className:"font-semibold text-gray-900",children:["Grade ",Se]})]}),c.jsx("div",{className:"space-y-3",children:We(Se).map(Ae=>c.jsx(He,{variant:"outline",size:"sm",onClick:()=>W(S,Ae),className:"w-full text-sm py-2 px-4 border-green-300 hover:border-green-400 hover:bg-green-100 focus:ring-2 focus:ring-green-500 rounded-lg font-medium",children:Ae.displayText},Ae.id))})]},Se))})]}),v.length>0&&c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-3",children:c.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:"3"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Selected Subjects"}),c.jsx("p",{className:"text-gray-600",children:"Review your subject and class selections"})]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:v.map(Se=>c.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-4 hover:shadow-md transition-shadow duration-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex-1",children:c.jsx("span",{className:"text-sm font-semibold text-purple-900",children:Se.displayText})}),c.jsx(He,{variant:"outline",size:"sm",onClick:()=>Ce(Se.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300 focus:ring-2 focus:ring-red-500 rounded-lg",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},Se.id))})]}),c.jsxs("div",{className:"flex justify-between items-center pt-6 border-t-2 border-gray-100",children:[c.jsx("div",{className:"text-sm text-gray-500",children:v.length>0?`${v.length} subject${v.length>1?"s":""} selected`:"No subjects selected"}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsxs(He,{variant:"outline",onClick:()=>{E(!1),z(!0),ee()},className:"px-6 py-3 text-sm font-medium text-gray-700 bg-white border-2 border-gray-300 hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 rounded-xl",children:[c.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Cancel"]}),c.jsxs(He,{variant:"primary",onClick:()=>_e({type:"save",data:v}),disabled:v.length===0,className:"px-8 py-3 text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-indigo-600 border border-transparent rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:[c.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),F?"Next: Select Classes":"Save Subjects"]})]})]})]})]})]})}),R&&c.jsx(vo,{isOpen:R,onClose:Le,title:"Confirm Save",variant:"confirmation",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to save ",((at=B==null?void 0:B.data)==null?void 0:at.length)||0," subject assignments?"]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx(He,{variant:"outline",onClick:Ne,children:"Cancel"}),c.jsx(He,{variant:"primary",onClick:te,children:"Save"})]})]})}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:u.map(Se=>c.jsx(Xi,{type:Se.type,message:Se.message,onClose:()=>d(Ae=>Ae.filter(Me=>Me.id!==Se.id))},Se.id))})]})},uge=()=>{const{user:t,role:e,isAuthenticated:r,isLoading:n}=xn(),[s,a]=b.useState("cabinet");return!r||e!=="teacher"?c.jsx($f,{to:"/login",replace:!0}):n?c.jsxs("div",{className:"teacher-app-loading",children:[c.jsx(nr,{}),c.jsx("p",{children:"Loading teacher interface..."})]}):c.jsx("div",{className:"teacher-app",children:c.jsxs(Qk,{children:[c.jsx(Fn,{path:"/",element:c.jsx(wj,{})}),c.jsx(Fn,{path:"/cabinet",element:c.jsx(wj,{})}),c.jsx(Fn,{path:"/tests",element:c.jsx(_j,{})}),c.jsx(Fn,{path:"/tests/create",element:c.jsx(_j,{})}),c.jsx(Fn,{path:"/data",element:c.jsx(lge,{})}),c.jsx(Fn,{path:"/subjects",element:c.jsx(cge,{})}),c.jsx(Fn,{path:"/results",element:c.jsx(GI,{})}),c.jsx(Fn,{path:"*",element:c.jsx($f,{to:"/teacher",replace:!0})})]})})},ke={container:"min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100",mainContainer:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",header:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg",headerContent:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",headerFlex:"flex justify-between items-center",adminInfo:"flex items-center space-x-4",adminAvatar:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",adminText:"text-lg sm:text-xl md:text-2xl font-bold text-white",adminSubtext:"text-purple-100 text-sm sm:text-base md:text-lg",menuContainer:"relative admin-menu",menuButton:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",menuDropdown:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",menuItem:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-purple-50 transition-colors",menuItemLogout:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",cardContainer:"bg-white rounded-xl shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-300",cardHeader:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-indigo-50",cardTitle:"text-xl font-bold text-gray-800",cardBody:"p-6",buttonGroup:"flex flex-wrap gap-3 mb-6",buttonPrimary:"bg-purple-600 hover:bg-purple-700 text-white font-medium px-4 py-2 rounded-lg transition-colors duration-200",buttonSecondary:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium px-4 py-2 rounded-lg transition-colors duration-200",formContainer:"bg-gray-50 rounded-lg p-6 border border-gray-200",formGrid:"grid grid-cols-1 md:grid-cols-2 gap-4",formGroup:"space-y-2",formLabel:"block text-sm font-medium text-gray-700",formInput:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors duration-200",formCheckbox:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded",formActions:"flex space-x-3 pt-4",table:"min-w-full divide-y divide-gray-200",tableHeader:"bg-gray-50",tableHeaderCell:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",tableBody:"bg-white divide-y divide-gray-200",tableRow:"hover:bg-gray-50 transition-colors duration-150",tableCell:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",statusActive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",statusInactive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",modalOverlay:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",modalContent:"bg-white rounded-lg p-6 w-full max-w-md mx-4 shadow-xl",modalTitle:"text-xl font-semibold text-gray-900 mb-4",modalActions:"flex space-x-3 pt-4"},dge=()=>{var St;const{user:t,isAdmin:e,logout:r}=xn(),{get:n,post:s}=Ji(),a=b.useCallback(async()=>{try{h({type:"info",message:"Refreshing class summary view..."});const re=await s("/.netlify/functions/refresh-class-summary-semester",{});re&&(re.success||re.message)?h({type:"success",message:"Class summary view refreshed."}):h({type:"error",message:(re==null?void 0:re.error)||"Failed to refresh view"})}catch(re){h({type:"error",message:"Failed to refresh view"}),console.error("Refresh class summary error:",re)}},[s]),i=b.useCallback(async()=>{try{h({type:"info",message:"Checking for overdue assignments..."});const re=await s("/.netlify/functions/check-overdue-assignments",{});if(re&&re.success){const Xe=re.overdue_count||0;Xe>0?h({type:"success",message:`Found and marked ${Xe} overdue assignments as inactive.`}):h({type:"info",message:"No overdue assignments found."})}else h({type:"error",message:(re==null?void 0:re.error)||"Failed to check assignments"})}catch(re){h({type:"error",message:"Failed to check assignments"}),console.error("Check overdue assignments error:",re)}},[s]),[o,l]=b.useState(!1),[u,d]=b.useState(null),[g,h]=b.useState(null),[p,x]=b.useState(!1),[v,w]=b.useState(!1),[S,_]=b.useState(!1),[y,k]=b.useState(!1),[N,E]=b.useState(""),[A,C]=b.useState(null),[F,D]=b.useState({}),[R,M]=b.useState(null),[B,J]=b.useState({}),[X,z]=b.useState(null),[H,U]=b.useState({}),[L,ne]=b.useState([]),[de,G]=b.useState(""),[K,Q]=b.useState(""),[q,se]=b.useState(""),[W,ee]=b.useState(!0),[ve,_e]=b.useState(!1),[Le,te]=b.useState([]),[Ne,Ce]=b.useState(""),[We,nt]=b.useState(""),[$e,De]=b.useState(""),[at,Se]=b.useState(!1),[Ae,Me]=b.useState(!1),[Ie,Ge]=b.useState([]),[tt,kt]=b.useState([]),[zt,bt]=b.useState([]),[Dt,it]=b.useState([]),[ht,Ct]=b.useState(!1),[jt,Fe]=b.useState(!1),[et,Ze]=b.useState(!1),[rt,dt]=b.useState(!1),[Tt,xe]=b.useState({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),[ue,ye]=b.useState({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),[be,Ve]=b.useState({subject_id:"",subject:"",description:"",is_active:!0}),[Nt,yt]=b.useState({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""});b.useEffect(()=>{console.log(" AdminCabinet component mounted - initializing..."),$t()},[]),b.useEffect(()=>{const re=Xe=>{at&&!Xe.target.closest(".admin-menu")&&Se(!1)};return document.addEventListener("mousedown",re),()=>{document.removeEventListener("mousedown",re)}},[at]);const $t=b.useCallback(async()=>{try{l(!0),await yr(),console.log("Admin app initialized")}catch(re){d("Failed to initialize admin app"),console.error("Admin app initialization error:",re)}finally{l(!1)}},[]),Ft=b.useCallback(()=>{Se(re=>!re)},[]),Ot=b.useCallback(()=>{Me(!0),Se(!1)},[]),xr=b.useCallback(()=>{Me(!1)},[]),yr=b.useCallback(async()=>{try{await Promise.all([qt(),hr(),Nr(),Ln()])}catch(re){console.error("Error loading admin data:",re),d("Failed to load admin data")}},[]),qt=b.useCallback(async()=>{try{const re="admin_users_",Xe=nn(re);if(Xe){console.log(" Using cached users data"),Ge(Xe);return}const Ut=await n("/.netlify/functions/get-all-users");console.log(" Users response:",Ut);const Qt=Ut.users||[];Ge(Qt),zr(re,Qt,Xr.admin_users),console.log(" Users set to state:",Qt)}catch(re){console.error("Error loading users:",re)}},[n]),hr=b.useCallback(async()=>{try{const re="admin_teachers_",Xe=nn(re);if(Xe){console.log(" Using cached teachers data"),kt(Xe);return}const Ut=await n("/.netlify/functions/get-all-teachers");console.log(" Teachers response:",Ut);const Qt=Ut.teachers||[];kt(Qt),zr(re,Qt,Xr.admin_teachers),console.log(" Teachers set to state:",Qt)}catch(re){console.error("Error loading teachers:",re)}},[n]),Nr=b.useCallback(async()=>{try{const re="admin_subjects_",Xe=nn(re);if(Xe){console.log(" Using cached subjects data"),bt(Xe);return}const Ut=await n("/.netlify/functions/get-all-subjects");console.log(" Subjects response:",Ut);const Qt=Ut.subjects||[];bt(Qt),zr(re,Qt,Xr.admin_subjects),console.log(" Subjects set to state:",Qt)}catch(re){console.error("Error loading subjects:",re)}},[n]),Ln=b.useCallback(async()=>{try{const re="admin_academic_years_",Xe=nn(re);if(Xe){console.log(" Using cached academic years data"),it(Xe);return}const Qt=(await n("/.netlify/functions/get-academic-year")).academic_years||[];it(Qt),zr(re,Qt,Xr.admin_academic_years)}catch(re){console.error("Error loading academic year:",re)}},[n]),Y=b.useCallback(async()=>{try{if(k(!y),!y){const[re,Xe]=await Promise.all([n("/.netlify/functions/get-all-tests"),n("/.netlify/functions/get-test-assignments")]);console.log(" Active tests response:",re),console.log(" Assignments response:",Xe);const Ut=re.tests||[],ss=(Xe.assignments||[]).reduce((Vn,Al)=>{const Ro=`${Al.test_type}-${Al.test_id}`;return Vn[Ro]||(Vn[Ro]=[]),Vn[Ro].push(Al),Vn},{}),Br=Ut.map(Vn=>{const Al=`${Vn.test_type}-${Vn.test_id}`,Ro=ss[Al]||[],_d=Ro.some(Im=>Im.is_active);return{...Vn,is_active:_d,assignments:Ro}});ne(Br),console.log(" All tests with status set to state:",Br)}}catch(re){console.error("Error loading tests:",re),h({type:"error",message:"Failed to load tests"})}},[n,y]),fe=b.useCallback((re,Xe)=>{xe(Ut=>({...Ut,[re]:Xe}))},[]),ae=b.useCallback((re,Xe)=>{ye(Ut=>({...Ut,[re]:Xe}))},[]),ce=b.useCallback((re,Xe)=>{Ve(Ut=>({...Ut,[re]:Xe}))},[]);b.useCallback(()=>{console.log(" Testing local storage...");try{const re={test:"data",timestamp:Date.now()};localStorage.setItem("test",JSON.stringify(re));const Xe=JSON.parse(localStorage.getItem("test"));console.log(" Local storage test successful:",Xe),h({type:"success",message:"Local storage test successful"})}catch(re){console.error(" Local storage test failed:",re),h({type:"error",message:"Local storage test failed"})}},[]),b.useCallback(()=>{console.log(" Clearing local storage...");try{localStorage.clear(),console.log(" Local storage cleared"),h({type:"success",message:"Local storage cleared"})}catch(re){console.error(" Error clearing local storage:",re),h({type:"error",message:"Error clearing local storage"})}},[]),b.useCallback(async()=>{console.log(" Checking teacher subjects...");try{const Xe=(await n("/.netlify/functions/get-all-teachers")).data||[];console.log(" Teachers data:",Xe),h({type:"success",message:`Found ${Xe.length} teachers`})}catch(re){console.error(" Error checking teacher subjects:",re),h({type:"error",message:"Error checking teacher subjects"})}},[n]);const ge=b.useCallback(async re=>{re.preventDefault();try{console.log(" Submitting user:",Tt);const Xe=await s("/.netlify/functions/add-user",Tt);Xe.success?(h({type:"success",message:"User added successfully"}),Ct(!1),xe({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),qt()):h({type:"error",message:Xe.message||"Failed to add user"})}catch(Xe){console.error(" Error adding user:",Xe),h({type:"error",message:"Error adding user"})}},[Tt,s,qt]),V=b.useCallback(async re=>{re.preventDefault();try{console.log(" Submitting teacher:",ue);const Xe=await s("/.netlify/functions/add-teacher",ue);Xe.success?(h({type:"success",message:"Teacher added successfully"}),Fe(!1),ye({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),hr()):h({type:"error",message:Xe.message||"Failed to add teacher"})}catch(Xe){console.error(" Error adding teacher:",Xe),h({type:"error",message:"Error adding teacher"})}},[ue,s,hr]),ie=b.useCallback(async re=>{re.preventDefault();try{console.log(" Submitting subject:",be);const Xe=await s("/.netlify/functions/add-subject",be);Xe.success?(h({type:"success",message:"Subject added successfully"}),Ze(!1),Ve({subject_id:"",subject:"",description:"",is_active:!0}),Nr()):h({type:"error",message:Xe.message||"Failed to add subject"})}catch(Xe){console.error(" Error adding subject:",Xe),h({type:"error",message:"Error adding subject"})}},[be,s,Nr]),we=b.useCallback(re=>{C(re),D({name:re.name||"",surname:re.surname||"",grade:re.grade||"",class:re.class||"",student_id:re.student_id||"",nickname:re.nickname||"",password:re.password||"",is_active:re.is_active!==void 0?re.is_active:!0})},[]),me=b.useCallback(async()=>{try{const re=[];Object.keys(F).forEach(Xe=>{Xe!=="student_id"&&F[Xe]!==A[Xe]&&re.push({fieldName:Xe,newValue:F[Xe]})});for(const Xe of re)await s("/.netlify/functions/update-user",{userId:A.student_id,fieldName:Xe.fieldName,newValue:Xe.newValue});h({type:"success",message:"User updated successfully!"}),C(null),D({}),qt()}catch{h({type:"error",message:"Failed to update user"})}},[F,A,s,qt]),Te=b.useCallback(async re=>{if(window.confirm("Are you sure you want to delete this user?"))try{(await s("/.netlify/functions/delete-user",{userId:re})).success&&(h({type:"success",message:"User deleted successfully!"}),qt())}catch{h({type:"error",message:"Failed to delete user"})}},[s,qt]),I=b.useCallback(re=>{M(re),J({teacher_id:re.teacher_id||"",username:re.username||"",password:re.password||"",first_name:re.first_name||"",last_name:re.last_name||"",is_active:re.is_active!==void 0?re.is_active:!0})},[]),Z=b.useCallback(async()=>{try{const re=[];Object.keys(B).forEach(Xe=>{Xe!=="teacher_id"&&B[Xe]!==R[Xe]&&re.push({fieldName:Xe,newValue:B[Xe]})});for(const Xe of re)await s("/.netlify/functions/update-teacher",{teacherId:R.teacher_id,fieldName:Xe.fieldName,newValue:Xe.newValue});h({type:"success",message:"Teacher updated successfully!"}),M(null),J({}),hr()}catch{h({type:"error",message:"Failed to update teacher"})}},[B,R,s,hr]),pe=b.useCallback(async re=>{if(window.confirm("Are you sure you want to delete this teacher?"))try{(await s("/.netlify/functions/delete-teacher",{teacherId:re})).success&&(h({type:"success",message:"Teacher deleted successfully!"}),hr())}catch{h({type:"error",message:"Failed to delete teacher"})}},[s,hr]),oe=b.useCallback(re=>{z(re),U({subject_id:re.subject_id||"",subject:re.subject||""})},[]),Ee=b.useCallback(async()=>{try{const re=[];Object.keys(H).forEach(Xe=>{Xe!=="subject_id"&&H[Xe]!==X[Xe]&&re.push({fieldName:Xe,newValue:H[Xe]})});for(const Xe of re)await s("/.netlify/functions/update-subject",{subjectId:X.subject_id,fieldName:Xe.fieldName,newValue:Xe.newValue});h({type:"success",message:"Subject updated successfully!"}),z(null),U({}),Nr()}catch{h({type:"error",message:"Failed to update subject"})}},[H,X,s,Nr]),Ue=b.useCallback(async re=>{if(window.confirm("Are you sure you want to delete this subject?"))try{const Xe=await s("/.netlify/functions/delete-subject",{subjectId:re});Xe.success?(h({type:"success",message:"Subject deleted successfully!"}),Nr()):h({type:"error",message:Xe.message||"Failed to delete subject"})}catch{h({type:"error",message:"Failed to delete subject"})}},[s,Nr]),Oe=b.useCallback((re,Xe)=>{yt(Ut=>({...Ut,[re]:Xe}))},[]),ut=b.useCallback(async re=>{if(re.preventDefault(),!Nt.startDate||!Nt.endDate||!Nt.teacherId){h({type:"error",message:"Please fill in all required fields (Start Date, End Date, Teacher ID)"});return}if(window.confirm("Are you sure you want to delete all test data for the selected criteria? This action cannot be undone."))try{const Xe=await s("/.netlify/functions/delete-test-data",Nt);Xe.success?(h({type:"success",message:`Successfully deleted ${Xe.deletedCount} test records!`}),dt(!1),yt({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""})):h({type:"error",message:Xe.message||"Failed to delete test data"})}catch{h({type:"error",message:"Failed to delete test data"})}},[Nt,s]),he=b.useCallback(async(re,Xe,Ut)=>{try{const Qt=await n("/.netlify/functions/get-test-assignments");if(Qt.success&&Qt.assignments){const ss=Qt.assignments.filter(Br=>Br.test_id===parseInt(re)&&Br.test_type===Xe);if(ss.length===0){h({type:"error",message:"No assignments found for this test"});return}for(const Br of ss){const Vn=await s("/.netlify/functions/remove-assignment",{teacher_id:Ut,assignment_id:Br.assignment_id,test_type:Xe,test_id:re});if(!Vn.success){h({type:"error",message:`Failed to complete test: ${Vn.message}`});return}}h({type:"success",message:"Test marked as complete successfully!"}),await Y()}else h({type:"error",message:"Failed to get test assignments"})}catch(Qt){console.error("Error completing test:",Qt),h({type:"error",message:"Failed to complete test"})}},[s,n,Y]),je=b.useCallback(async(re,Xe,Ut)=>{try{const Qt=await n("/.netlify/functions/get-test-assignments");if(Qt.success&&Qt.assignments){const ss=Qt.assignments.filter(Br=>Br.test_id===parseInt(re)&&Br.test_type===Xe);if(ss.length===0){h({type:"error",message:"No assignments found for this test"});return}for(const Br of ss){const Vn=await s("/.netlify/functions/remove-assignment",{teacher_id:Ut,assignment_id:Br.assignment_id,test_type:Xe,test_id:re,mark_active:!0});if(!Vn.success){h({type:"error",message:`Failed to reactivate test: ${Vn.message}`});return}}h({type:"success",message:"Test marked as active successfully!"}),await Y()}else h({type:"error",message:"Failed to get test assignments"})}catch(Qt){console.error("Error reactivating test:",Qt),h({type:"error",message:"Failed to reactivate test"})}},[s,n,Y]),Ye=b.useCallback(async()=>{try{if(_e(!ve),!ve){const re=await n("/.netlify/functions/get-all-tests");console.log(" Actual tests response:",re),te(re.tests||[]),console.log(" Actual tests set to state:",re.tests||[])}}catch(re){console.error("Error loading actual tests:",re),h({type:"error",message:"Failed to load tests"})}},[n,ve]),mt=b.useCallback(async(re,Xe,Ut)=>{try{const Qt=await s("/.netlify/functions/delete-test",{test_id:re,test_type:Xe,teacher_id:Ut});Qt.success?(h({type:"success",message:"Test deleted successfully!"}),await Ye()):h({type:"error",message:`Failed to delete test: ${Qt.message}`})}catch(Qt){console.error("Error deleting test:",Qt),h({type:"error",message:"Failed to delete test"})}},[s,Ye]),pt=N?Ie.filter(re=>re.grade.toString()===N):Ie,Bt=L.filter(re=>{const Xe=!de||re.teacher_id===de,Ut=!K||new Date(re.created_at)>=new Date(K),Qt=!q||new Date(re.created_at)<=new Date(q+"T23:59:59"),ss=W?re.is_active:!re.is_active;return Xe&&Ut&&Qt&&ss}),Et=Le.filter(re=>{const Xe=!Ne||re.teacher_id===Ne,Ut=!We||new Date(re.created_at)>=new Date(We),Qt=!$e||new Date(re.created_at)<=new Date($e+"T23:59:59");return Xe&&Ut&&Qt});return c.jsxs(Be.div,{id:"admin-cabinet-main",className:ke.container,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsx(Be.div,{className:ke.header,initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:c.jsx("div",{className:ke.headerContent,children:c.jsxs("div",{className:ke.headerFlex,children:[c.jsxs(Be.div,{className:ke.adminInfo,initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(Be.div,{className:ke.adminAvatar,initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:c.jsx("span",{className:"text-white font-semibold text-xl",children:((St=t==null?void 0:t.username)==null?void 0:St.charAt(0))||"A"})})}),c.jsxs("div",{children:[c.jsx("h1",{className:ke.adminText,children:(t==null?void 0:t.username)||"Administrator"}),c.jsx("p",{className:ke.adminSubtext,children:"Administrator Dashboard"})]})]}),c.jsxs(Be.div,{className:ke.menuContainer,initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsxs("button",{onClick:Ft,className:ke.menuButton,style:{zIndex:1e3},children:[c.jsx("span",{className:"hidden sm:inline",children:"Menu"}),c.jsx(Be.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:at?180:0},transition:{duration:.2},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),c.jsx(va,{children:at&&c.jsx(Be.div,{className:ke.menuDropdown,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:c.jsxs("div",{className:"py-2",children:[c.jsx(Be.button,{onClick:Ot,className:ke.menuItem,whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),c.jsx(Be.button,{onClick:()=>{Ft(),r()},className:ke.menuItemLogout,whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),o&&c.jsx(nr,{text:"Loading..."}),u&&c.jsx(Xi,{type:"error",message:u,onClose:()=>d(null)}),g&&c.jsx(Xi,{type:g.type,message:g.message,onClose:()=>h(null)}),Ae&&c.jsx("div",{className:ke.modalOverlay,children:c.jsxs("div",{className:ke.modalContent,children:[c.jsx("h2",{className:ke.modalTitle,children:"Change Password"}),c.jsxs("form",{className:"space-y-4",children:[c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{htmlFor:"currentPassword",className:ke.formLabel,children:"Current Password"}),c.jsx("input",{type:"password",id:"currentPassword",className:ke.formInput})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{htmlFor:"newPassword",className:ke.formLabel,children:"New Password"}),c.jsx("input",{type:"password",id:"newPassword",className:ke.formInput})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{htmlFor:"confirmPassword",className:ke.formLabel,children:"Confirm New Password"}),c.jsx("input",{type:"password",id:"confirmPassword",className:ke.formInput})]}),c.jsxs("div",{className:ke.modalActions,children:[c.jsx(He,{type:"button",variant:"secondary",onClick:xr,className:"flex-1",children:"Cancel"}),c.jsx(He,{type:"submit",variant:"primary",className:"flex-1 bg-purple-600 hover:bg-purple-700",children:"Change Password"})]})]})]})}),c.jsx(Be.div,{className:ke.mainContainer,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:c.jsxs("div",{className:"space-y-6",children:[c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},children:c.jsxs(st,{className:ke.cardContainer,children:[c.jsx(st.Header,{className:ke.cardHeader,children:c.jsx(st.Title,{className:ke.cardTitle,children:"User Management"})}),c.jsxs(st.Body,{className:ke.cardBody,children:[c.jsxs("div",{className:ke.buttonGroup,children:[c.jsx(He,{variant:"primary",onClick:()=>Ct(!0),className:ke.buttonPrimary,children:"Add User"}),c.jsx(He,{variant:"secondary",onClick:()=>{qt(),x(!p)},className:ke.buttonSecondary,children:p?"Hide Users Table":"Get All Users "})]}),c.jsx(va,{children:ht&&c.jsxs(Be.div,{className:ke.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New User"}),c.jsxs("form",{onSubmit:ge,className:"space-y-4",children:[c.jsxs("div",{className:ke.formGrid,children:[c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Grade"}),c.jsx("input",{type:"text",value:Tt.grade,onChange:re=>fe("grade",re.target.value),className:ke.formInput,placeholder:"Enter grade"})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Class"}),c.jsx("input",{type:"text",value:Tt.class,onChange:re=>fe("class",re.target.value),className:ke.formInput,placeholder:"Enter class"})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Number"}),c.jsx("input",{type:"text",value:Tt.number,onChange:re=>fe("number",re.target.value),className:ke.formInput,placeholder:"Enter number"})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Student ID"}),c.jsx("input",{type:"text",value:Tt.student_id,onChange:re=>fe("student_id",re.target.value),className:ke.formInput,placeholder:"Enter student ID"})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Name"}),c.jsx("input",{type:"text",value:Tt.name,onChange:re=>fe("name",re.target.value),className:ke.formInput,placeholder:"Enter name"})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Surname"}),c.jsx("input",{type:"text",value:Tt.surname,onChange:re=>fe("surname",re.target.value),className:ke.formInput,placeholder:"Enter surname"})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Nickname"}),c.jsx("input",{type:"text",value:Tt.nickname,onChange:re=>fe("nickname",re.target.value),className:ke.formInput,placeholder:"Enter nickname"})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Password"}),c.jsx("input",{type:"password",value:Tt.password,onChange:re=>fe("password",re.target.value),className:ke.formInput,placeholder:"Enter password"})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"userActive",checked:Tt.is_active,onChange:re=>fe("is_active",re.target.checked),className:ke.formCheckbox}),c.jsx("label",{htmlFor:"userActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),c.jsxs("div",{className:ke.formActions,children:[c.jsx(He,{type:"button",variant:"secondary",onClick:()=>Ct(!1),className:ke.buttonSecondary,children:"Cancel"}),c.jsx(He,{type:"submit",variant:"primary",className:ke.buttonPrimary,children:"Add User"})]})]})]})}),p&&c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Users (",pt.length," of ",Ie.length,")"]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Filter by Grade:"}),c.jsxs("select",{value:N,onChange:re=>E(re.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"All Grades"}),[...new Set(Ie.map(re=>re.grade))].sort().map(re=>c.jsxs("option",{value:re,children:["Grade ",re]},re))]})]})]}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-[600px]",children:c.jsxs("table",{className:ke.table,children:[c.jsx("thead",{className:ke.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:ke.tableHeaderCell,children:"Name"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Grade"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Class"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Student ID"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Number"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Nickname"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:ke.tableBody,children:pt.map((re,Xe)=>c.jsxs("tr",{className:ke.tableRow,children:[c.jsxs("td",{className:ke.tableCell,children:[re.name," ",re.surname]}),c.jsx("td",{className:ke.tableCell,children:re.grade}),c.jsx("td",{className:ke.tableCell,children:re.class}),c.jsx("td",{className:ke.tableCell,children:re.student_id}),c.jsx("td",{className:ke.tableCell,children:re.number}),c.jsx("td",{className:ke.tableCell,children:re.nickname}),c.jsx("td",{className:ke.tableCell,children:c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:()=>we(re),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),c.jsx("button",{onClick:()=>Te(re.student_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},re.id||Xe))})]})})})]})]})]})}),c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:c.jsxs(st,{className:ke.cardContainer,children:[c.jsxs(st.Header,{className:ke.cardHeader,children:[c.jsx(st.Title,{className:ke.cardTitle,children:"Teacher Management"}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx("button",{onClick:a,className:"px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-xs whitespace-nowrap",title:"Refresh materialized class summary view",children:"Refresh Class Summary View"}),c.jsx("button",{onClick:i,className:"px-3 py-1.5 bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors text-xs whitespace-nowrap",title:"Check and mark overdue assignments (7+ days old) as inactive",children:"Check Overdue Assignments"}),c.jsx(He,{variant:"primary",onClick:()=>Fe(!0),className:"text-xs whitespace-nowrap",children:"Add Teacher"}),c.jsx(He,{variant:"secondary",onClick:()=>{hr(),w(!v)},className:"text-xs whitespace-nowrap",children:v?"Hide Teachers Table":"Get All Teachers "})]})]}),c.jsxs(st.Body,{className:ke.cardBody,children:[c.jsx(va,{children:jt&&c.jsxs(Be.div,{className:ke.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Teacher"}),c.jsxs("form",{onSubmit:V,className:"space-y-4",children:[c.jsxs("div",{className:ke.formGrid,children:[c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Teacher ID"}),c.jsx("input",{type:"text",value:ue.teacher_id,onChange:re=>ae("teacher_id",re.target.value),className:ke.formInput,placeholder:"Enter teacher ID"})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Username"}),c.jsx("input",{type:"text",value:ue.username,onChange:re=>ae("username",re.target.value),className:ke.formInput,placeholder:"Enter username"})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Password"}),c.jsx("input",{type:"password",value:ue.password,onChange:re=>ae("password",re.target.value),className:ke.formInput,placeholder:"Enter password"})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"First Name"}),c.jsx("input",{type:"text",value:ue.first_name,onChange:re=>ae("first_name",re.target.value),className:ke.formInput,placeholder:"Enter first name"})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Last Name"}),c.jsx("input",{type:"text",value:ue.last_name,onChange:re=>ae("last_name",re.target.value),className:ke.formInput,placeholder:"Enter last name"})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"teacherActive",checked:ue.is_active,onChange:re=>ae("is_active",re.target.checked),className:ke.formCheckbox}),c.jsx("label",{htmlFor:"teacherActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),c.jsxs("div",{className:ke.formActions,children:[c.jsx(He,{type:"button",variant:"secondary",onClick:()=>Fe(!1),className:ke.buttonSecondary,children:"Cancel"}),c.jsx(He,{type:"submit",variant:"primary",className:ke.buttonPrimary,children:"Add Teacher"})]})]})]})}),A&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit User"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),c.jsx("input",{type:"text",value:F.name,onChange:re=>D({...F,name:re.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Surname"}),c.jsx("input",{type:"text",value:F.surname,onChange:re=>D({...F,surname:re.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grade"}),c.jsx("input",{type:"number",value:F.grade,onChange:re=>D({...F,grade:re.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),c.jsx("input",{type:"number",value:F.class,onChange:re=>D({...F,class:re.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),c.jsx("input",{type:"text",value:F.student_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Student ID cannot be changed"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nickname"}),c.jsx("input",{type:"text",value:F.nickname,onChange:re=>D({...F,nickname:re.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),c.jsx("input",{type:"text",value:F.password,onChange:re=>D({...F,password:re.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"is_active",checked:F.is_active,onChange:re=>D({...F,is_active:re.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),c.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{onClick:()=>{C(null),D({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),c.jsx("button",{onClick:me,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update User"})]})]})}),v&&c.jsxs("div",{className:"mt-6",children:[c.jsx("div",{className:"mb-4",children:c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Teachers (",tt.length,")"]})}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:ke.table,children:[c.jsx("thead",{className:ke.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:ke.tableHeaderCell,children:"Teacher ID"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Name"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Username"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Password"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Status"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Created"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:ke.tableBody,children:tt.map((re,Xe)=>c.jsxs("tr",{className:ke.tableRow,children:[c.jsx("td",{className:ke.tableCell,children:re.teacher_id}),c.jsxs("td",{className:ke.tableCell,children:[re.first_name," ",re.last_name]}),c.jsx("td",{className:ke.tableCell,children:re.username}),c.jsx("td",{className:ke.tableCell,children:re.password}),c.jsx("td",{className:ke.tableCell,children:c.jsx("span",{className:re.is_active?ke.statusActive:ke.statusInactive,children:re.is_active?"Active":"Inactive"})}),c.jsx("td",{className:ke.tableCell,children:new Date(re.created_at).toLocaleDateString()}),c.jsx("td",{className:ke.tableCell,children:c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:()=>I(re),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),c.jsx("button",{onClick:()=>pe(re.teacher_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},re.teacher_id||Xe))})]})})})]})]})]})}),c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7,duration:.5},children:c.jsxs(st,{className:ke.cardContainer,children:[c.jsx(st.Header,{className:ke.cardHeader,children:c.jsx(st.Title,{className:ke.cardTitle,children:"Subject Management"})}),c.jsxs(st.Body,{className:ke.cardBody,children:[c.jsxs("div",{className:ke.buttonGroup,children:[c.jsx(He,{variant:"primary",onClick:()=>Ze(!0),className:ke.buttonPrimary,children:"Add Subject"}),c.jsx(He,{variant:"secondary",onClick:()=>{Nr(),_(!S)},className:ke.buttonSecondary,children:S?"Hide Subjects Table":"Get All Subjects "})]}),c.jsx(va,{children:et&&c.jsxs(Be.div,{className:ke.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Subject"}),c.jsxs("form",{onSubmit:ie,className:"space-y-4",children:[c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Subject Name"}),c.jsx("input",{type:"text",value:be.subject,onChange:re=>ce("subject",re.target.value),className:ke.formInput,placeholder:"Enter subject name",required:!0}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Subject ID will be automatically generated"})]}),c.jsxs("div",{className:ke.formActions,children:[c.jsx(He,{type:"button",variant:"secondary",onClick:()=>Ze(!1),className:ke.buttonSecondary,children:"Cancel"}),c.jsx(He,{type:"submit",variant:"primary",className:ke.buttonPrimary,children:"Add Subject"})]})]})]})}),R&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Teacher"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teacher ID"}),c.jsx("input",{type:"text",value:B.teacher_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Teacher ID cannot be changed"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),c.jsx("input",{type:"text",value:B.username,onChange:re=>J({...B,username:re.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),c.jsx("input",{type:"text",value:B.password,onChange:re=>J({...B,password:re.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),c.jsx("input",{type:"text",value:B.first_name,onChange:re=>J({...B,first_name:re.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),c.jsx("input",{type:"text",value:B.last_name,onChange:re=>J({...B,last_name:re.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"teacher_is_active",checked:B.is_active,onChange:re=>J({...B,is_active:re.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),c.jsx("label",{htmlFor:"teacher_is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{onClick:()=>{M(null),J({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),c.jsx("button",{onClick:Z,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update Teacher"})]})]})}),X&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Subject"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject ID"}),c.jsx("input",{type:"text",value:H.subject_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Subject ID cannot be changed"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),c.jsx("input",{type:"text",value:H.subject,onChange:re=>U({...H,subject:re.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{onClick:()=>z(null),className:"px-4 py-2 text-gray-600 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),c.jsx("button",{onClick:Ee,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:"Update Subject"})]})]})}),S&&c.jsxs("div",{className:"mt-6",children:[c.jsx("div",{className:"mb-4",children:c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Subjects (",zt.length,")"]})}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:ke.table,children:[c.jsx("thead",{className:ke.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:ke.tableHeaderCell,children:"Subject ID"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Subject Name"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:ke.tableBody,children:zt.map((re,Xe)=>c.jsxs("tr",{className:ke.tableRow,children:[c.jsx("td",{className:ke.tableCell,children:re.subject_id}),c.jsx("td",{className:ke.tableCell,children:re.subject}),c.jsx("td",{className:ke.tableCell,children:c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:()=>oe(re),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),c.jsx("button",{onClick:()=>Ue(re.subject_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},re.subject_id||Xe))})]})})})]})]})]})}),c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:c.jsxs(st,{className:ke.cardContainer,children:[c.jsx(st.Header,{className:ke.cardHeader,children:c.jsx(st.Title,{className:ke.cardTitle,children:"Test Data Deletion"})}),c.jsxs(st.Body,{className:ke.cardBody,children:[c.jsx("div",{className:ke.buttonGroup,children:c.jsx(He,{variant:"danger",onClick:()=>dt(!0),className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})}),c.jsx(va,{children:rt&&c.jsxs(Be.div,{className:ke.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Delete Test Data by Date Range"}),c.jsxs("form",{onSubmit:ut,className:"space-y-4",children:[c.jsxs("div",{className:ke.formGrid,children:[c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Start Date *"}),c.jsx("input",{type:"date",value:Nt.startDate,onChange:re=>Oe("startDate",re.target.value),className:ke.formInput,required:!0})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"End Date *"}),c.jsx("input",{type:"date",value:Nt.endDate,onChange:re=>Oe("endDate",re.target.value),className:ke.formInput,required:!0})]})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Teacher ID *"}),c.jsxs("select",{value:Nt.teacherId,onChange:re=>Oe("teacherId",re.target.value),className:ke.formInput,required:!0,children:[c.jsx("option",{value:"",children:"Select a teacher"}),tt.map(re=>c.jsxs("option",{value:re.teacher_id,children:[re.teacher_id," - ",re.first_name," ",re.last_name]},re.teacher_id))]})]}),c.jsxs("div",{className:ke.formGroup,children:[c.jsx("label",{className:ke.formLabel,children:"Subject (Optional)"}),c.jsxs("select",{value:Nt.subjectId,onChange:re=>Oe("subjectId",re.target.value),className:ke.formInput,children:[c.jsx("option",{value:"",children:"All subjects"}),zt.map(re=>c.jsx("option",{value:re.subject_id,children:re.subject},re.subject_id))]})]}),c.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Warning: This action cannot be undone"}),c.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[c.jsx("p",{children:"This will permanently delete:"}),c.jsxs("ul",{className:"list-disc list-inside mt-1",children:[c.jsx("li",{children:"All test records within the date range"}),c.jsx("li",{children:"All test questions and answers"}),c.jsx("li",{children:"All test results and submissions"}),c.jsx("li",{children:"All test assignments"}),c.jsx("li",{children:"Associated Cloudinary images (for matching tests)"})]})]})]})]})}),c.jsxs("div",{className:ke.formActions,children:[c.jsx(He,{type:"button",variant:"secondary",onClick:()=>dt(!1),className:ke.buttonSecondary,children:"Cancel"}),c.jsx(He,{type:"submit",variant:"danger",className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})]})]})]})})]})]})}),c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.85,duration:.5},children:c.jsxs(st,{className:ke.cardContainer,children:[c.jsx(st.Header,{className:ke.cardHeader,children:c.jsx(st.Title,{className:ke.cardTitle,children:"Assignments Management"})}),c.jsxs(st.Body,{className:ke.cardBody,children:[c.jsx("div",{className:"mb-4",children:c.jsx(He,{variant:"primary",onClick:Y,className:ke.buttonPrimary,children:y?"Hide Assignments Table":"Get All Assignments "})}),y&&c.jsx("div",{className:"mb-6",children:c.jsx("div",{className:"border-b border-gray-200",children:c.jsxs("nav",{className:"-mb-px flex space-x-8",children:[c.jsx("button",{onClick:()=>ee(!0),className:`py-2 px-1 border-b-2 font-medium text-sm ${W?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Active Assignments"}),c.jsx("button",{onClick:()=>ee(!1),className:`py-2 px-1 border-b-2 font-medium text-sm ${W?"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300":"border-purple-500 text-purple-600"}`,children:"Inactive Assignments"})]})})}),y&&c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:[W?"Active":"Inactive"," Assignments (",Bt.length," of ",L.filter(re=>W?re.is_active:!re.is_active).length,")"]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("select",{value:de,onChange:re=>G(re.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"All Teachers"}),tt.map(re=>c.jsxs("option",{value:re.teacher_id,children:[re.first_name," ",re.last_name]},re.teacher_id))]}),c.jsx("input",{type:"date",value:K,onChange:re=>Q(re.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),c.jsx("input",{type:"date",value:q,onChange:re=>se(re.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:ke.table,children:[c.jsx("thead",{className:ke.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:ke.tableHeaderCell,children:"Test Name"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Type"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Teacher"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Questions"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Created"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:ke.tableBody,children:Bt.map((re,Xe)=>c.jsxs("tr",{className:ke.tableRow,children:[c.jsx("td",{className:ke.tableCell,children:re.test_name}),c.jsx("td",{className:ke.tableCell,children:c.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:re.test_type.replace("_"," ").toUpperCase()})}),c.jsx("td",{className:ke.tableCell,children:re.teacher_name}),c.jsx("td",{className:ke.tableCell,children:re.num_questions}),c.jsx("td",{className:ke.tableCell,children:new Date(re.created_at).toLocaleDateString()}),c.jsx("td",{className:ke.tableCell,children:c.jsx("div",{className:"flex space-x-2",children:W?c.jsx("button",{onClick:()=>he(re.test_id,re.test_type,re.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-orange-100 text-orange-700 hover:bg-orange-200",children:"Mark Complete"}):c.jsx("button",{onClick:()=>je(re.test_id,re.test_type,re.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",children:"Mark Active"})})})]},`${re.test_type}-${re.test_id}-${Xe}`))})]})})})]})]})]})}),c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:c.jsxs(st,{className:ke.cardContainer,children:[c.jsx(st.Header,{className:ke.cardHeader,children:c.jsx(st.Title,{className:ke.cardTitle,children:"Test Management"})}),c.jsxs(st.Body,{className:ke.cardBody,children:[c.jsx("div",{className:"mb-4",children:c.jsx(He,{variant:"primary",onClick:Ye,className:ke.buttonPrimary,children:ve?"Hide Tests Table":"Get All Tests "})}),ve&&c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Tests (",Et.length," of ",Le.length,")"]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("select",{value:Ne,onChange:re=>Ce(re.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"All Teachers"}),tt.map(re=>c.jsxs("option",{value:re.teacher_id,children:[re.first_name," ",re.last_name]},re.teacher_id))]}),c.jsx("input",{type:"date",value:We,onChange:re=>nt(re.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),c.jsx("input",{type:"date",value:$e,onChange:re=>De(re.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:ke.table,children:[c.jsx("thead",{className:ke.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:ke.tableHeaderCell,children:"Test Name"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Type"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Teacher"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Questions"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Created"}),c.jsx("th",{className:ke.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:ke.tableBody,children:Et.map((re,Xe)=>c.jsxs("tr",{className:ke.tableRow,children:[c.jsx("td",{className:ke.tableCell,children:re.test_name}),c.jsx("td",{className:ke.tableCell,children:c.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:re.test_type.replace("_"," ").toUpperCase()})}),c.jsx("td",{className:ke.tableCell,children:re.teacher_name}),c.jsx("td",{className:ke.tableCell,children:re.num_questions}),c.jsx("td",{className:ke.tableCell,children:new Date(re.created_at).toLocaleDateString()}),c.jsx("td",{className:ke.tableCell,children:c.jsx("div",{className:"flex space-x-2",children:c.jsx("button",{onClick:()=>mt(re.test_id,re.test_type,re.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200",children:"Delete Test"})})})]},`${re.test_type}-${re.test_id}-${Xe}`))})]})})})]})]})]})}),c.jsx(Be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:c.jsxs(st,{className:ke.cardContainer,children:[c.jsx(st.Header,{className:ke.cardHeader,children:c.jsx(st.Title,{className:ke.cardTitle,children:"Debug & Testing"})}),c.jsx(st.Body,{className:ke.cardBody})]})})]})})]})},fge=()=>{const{isAdmin:t,getCurrentAdminId:e,logout:r}=xn(),{get:n}=Ji(),{showNotification:s}=Ys();b.useEffect(()=>{a()},[]);const a=b.useCallback(async()=>{if(console.log(" Initializing Admin Application..."),!t()){console.error(" User is not an admin, redirecting to login"),s("Access Denied: You are not an administrator.","error"),r();return}try{i(),await o(),l(),u(),console.log(" Admin Application initialized successfully"),s("Admin dashboard loaded successfully","success")}catch(d){console.error(" Error initializing admin app:",d),s("Failed to initialize admin dashboard","error")}},[t,e,r,s,n]),i=b.useCallback(()=>{console.log(" Initializing global event listeners...");const d=g=>{g.ctrlKey&&g.key==="k"&&(g.preventDefault(),console.log("Admin search shortcut triggered"))};return document.addEventListener("keydown",d),()=>{document.removeEventListener("keydown",d)}},[]),o=b.useCallback(async()=>{var d,g,h,p,x,v,w,S;try{console.log(" Loading admin data...");const[_,y,k,N]=await Promise.allSettled([n("/.netlify/functions/get-all-users"),n("/.netlify/functions/get-all-teachers"),n("/.netlify/functions/get-all-subjects"),n("/.netlify/functions/get-academic-year")]);_.status==="fulfilled"&&((d=_.value)!=null&&d.success)&&console.log(" Users loaded:",((g=_.value.users)==null?void 0:g.length)||0),y.status==="fulfilled"&&((h=y.value)!=null&&h.success)&&console.log(" Teachers loaded:",((p=y.value.teachers)==null?void 0:p.length)||0),k.status==="fulfilled"&&((x=k.value)!=null&&x.success)&&console.log(" Subjects loaded:",((v=k.value.subjects)==null?void 0:v.length)||0),N.status==="fulfilled"&&((w=N.value)!=null&&w.success)&&console.log(" Academic years loaded:",((S=N.value.academic_years)==null?void 0:S.length)||0),console.log(" Admin data loading completed")}catch(_){throw console.error(" Error loading admin data:",_),_}},[n]),l=b.useCallback(()=>{console.log(" Initializing test deletion functionality..."),console.log(" Test deletion functionality initialized")},[]),u=b.useCallback(()=>{console.log(" Exposing admin functions globally..."),window.toggleSubjectsContent=()=>{const g=document.getElementById("allSubjectsContainer"),h=document.querySelector('button[onclick="toggleSubjectsContent()"]');if(!g){console.error(" allSubjectsContainer not found");return}if(!h){console.error(" Button not found");return}const p=g.style.display!=="none";g.style.display=p?"none":"block",h.textContent=p?"Show Subjects":"Hide Subjects"},window.showAddSubjectForm=()=>{const g=document.getElementById("addSubjectForm");g&&(g.style.display="block")},window.hideAddSubjectForm=()=>{const g=document.getElementById("addSubjectForm"),h=document.getElementById("newSubjectForm");g&&(g.style.display="none"),h&&h.reset()},window.showAddAcademicYearForm=()=>{const g=document.getElementById("addAcademicYearForm");g&&(g.style.display="block")},window.hideAddAcademicYearForm=()=>{const g=document.getElementById("addAcademicYearForm"),h=document.getElementById("newAcademicYearForm");g&&(g.style.display="none"),h&&h.reset()},window.toggleUsersContent=()=>{const g=document.getElementById("allUsersContainer"),h=document.querySelector('button[onclick="toggleUsersContent()"]');if(!g){console.error(" allUsersContainer not found");return}if(!h){console.error(" Button not found");return}const p=g.style.display!=="none";g.style.display=p?"none":"block",h.textContent=p?"Show Users":"Hide Users"},window.showAddUserForm=()=>{const g=document.getElementById("addUserForm");g&&(g.style.display="block")},window.hideAddUserForm=()=>{const g=document.getElementById("addUserForm"),h=document.getElementById("newUserForm");g&&(g.style.display="none"),h&&h.reset()},window.showAddTeacherForm=()=>{const g=document.getElementById("addTeacherForm");g&&(g.style.display="block")},window.hideAddTeacherForm=()=>{const g=document.getElementById("addTeacherForm"),h=document.getElementById("newTeacherForm");g&&(g.style.display="none"),h&&h.reset()},window.toggleTeachersContent=()=>{const g=document.getElementById("allTeachersContainer"),h=document.querySelector('button[onclick="toggleTeachersContent()"]');if(!g){console.error(" allTeachersContainer not found");return}if(!h){console.error(" Button not found");return}const p=g.style.display!=="none";g.style.display=p?"none":"block",h.textContent=p?"Show Teachers":"Hide Teachers"},window.toggleTestsContent=()=>{const g=document.getElementById("allTestsContainer"),h=document.querySelector('button[onclick="toggleTestsContent()"]');if(!g){console.error(" allTestsContainer not found");return}if(!h){console.error(" Button not found");return}const p=g.style.display!=="none";g.style.display=p?"none":"block",h.textContent=p?"Show Tests":"Hide Tests"},window.toggleAssignmentsContent=()=>{const g=document.getElementById("allAssignmentsContainer"),h=document.querySelector('button[onclick="toggleAssignmentsContent()"]');if(!g){console.error(" allAssignmentsContainer not found");return}if(!h){console.error(" Button not found");return}const p=g.style.display!=="none";g.style.display=p?"none":"block",h.textContent=p?"Show Assignments":"Hide Assignments"},window.toggleResultsContent=()=>{const g=document.getElementById("allResultsContainer"),h=document.querySelector('button[onclick="toggleResultsContent()"]');if(!g){console.error(" allResultsContainer not found");return}if(!h){console.error(" Button not found");return}const p=g.style.display!=="none";g.style.display=p?"none":"block",h.textContent=p?"Show Results":"Hide Results"};const d={};window.toggleSection=g=>{console.log(` toggleSection called with sectionId: ${g}`);const h=Date.now();if(d[g]&&h-d[g]<300){console.log(` Ignoring rapid successive call for ${g}`);return}d[g]=h;const p=document.getElementById(g);if(!p){console.error(` Section with id '${g}' not found!`);return}const x=p.style.display!=="none";p.style.display=x?"none":"block";const v=document.querySelector(`button[onclick="toggleSection('${g}')"]`);v&&(v.textContent=x?"Show":"Hide")},window.addClickListeners=()=>{console.log(" Adding click listeners to section headers...");const g=document.querySelectorAll(".section-header");console.log(` Found ${g.length} section headers`),g.forEach((h,p)=>{const x=h.textContent.trim();if(console.log(` Processing header ${p+1}:`,x),h.dataset.listenerAdded==="true"){console.log(` Skipping header ${x} - listener already added`);return}h.addEventListener("click",()=>{const v=h.dataset.sectionId;v&&window.toggleSection(v)}),h.dataset.listenerAdded="true",console.log(` Added click listener to header: ${x}`)})},window.makeFieldEditable=g=>{const h=g.textContent;g.dataset.field;const p=document.createElement("input");p.type="text",p.value=h,p.className="editable-input";const x=document.createElement("button");x.textContent="Save",x.className="btn-save",x.onclick=()=>window.saveField(g,p,x,v);const v=document.createElement("button");v.textContent="Cancel",v.className="btn-cancel",v.onclick=()=>{g.textContent=h,g.style.display="block",p.remove(),x.remove(),v.remove()},g.style.display="none",g.parentNode.insertBefore(p,g),g.parentNode.insertBefore(x,g),g.parentNode.insertBefore(v,g)},window.saveField=(g,h,p,x)=>{const v=h.value.trim(),w=g.dataset.field,S=g.dataset.recordId;if(!v){alert("Field cannot be empty");return}console.log(`Saving field ${w} for record ${S} with value: ${v}`),g.textContent=v,g.style.display="block",h.remove(),p.remove(),x.remove()},window.showTestDataDeletion=()=>console.log("showTestDataDeletion called"),window.hideTestDataDeletionForm=()=>console.log("hideTestDataDeletionForm called"),window.loadTeacherGradesClasses=()=>console.log("loadTeacherGradesClasses called"),window.checkTeacherSubjects=()=>console.log("checkTeacherSubjects called"),window.initializeTestDeletion=()=>console.log("initializeTestDeletion called"),window.handleAssignmentDeletion=()=>console.log("handleAssignmentDeletion called"),window.handleTestDataDeletion=()=>console.log("handleTestDataDeletion called"),window.getSelectedGradesClasses=()=>console.log("getSelectedGradesClasses called"),window.hideAssignmentDeletionForm=()=>console.log("hideAssignmentDeletionForm called"),window.addKeyboardAccessibility=()=>console.log("addKeyboardAccessibility called"),window.testToggleSection=()=>console.log("testToggleSection called"),window.testAllToggles=()=>console.log("testAllToggles called"),window.manualToggleTest=()=>console.log("manualToggleTest called"),window.addEditableFieldListeners=()=>console.log("addEditableFieldListeners called"),window.deleteTest=()=>console.log("deleteTest called"),window.testLocalStorage=()=>{console.log("Testing localStorage...");try{localStorage.setItem("test","value");const g=localStorage.getItem("test");return localStorage.removeItem("test"),console.log(" localStorage is working"),!0}catch(g){return console.error(" localStorage error:",g),!1}},window.clearAllLocalStorage=()=>{console.log("Clearing all localStorage..."),localStorage.clear(),console.log(" localStorage cleared")},window.exportLocalStorage=()=>{console.log("Exporting localStorage...");const g={};for(let v=0;v<localStorage.length;v++){const w=localStorage.key(v);g[w]=localStorage.getItem(w)}const h=new Blob([JSON.stringify(g,null,2)],{type:"application/json"}),p=URL.createObjectURL(h),x=document.createElement("a");x.href=p,x.download="localStorage-backup.json",x.click(),URL.revokeObjectURL(p)},console.log(" Admin functions exposed globally")},[]);return t()?c.jsx(dge,{}):c.jsxs("div",{className:"admin-error",children:[c.jsx("h2",{children:"Access Denied"}),c.jsx("p",{children:"You don't have permission to access the admin dashboard."}),c.jsx("button",{onClick:r,children:"Return to Login"})]})},D2=({children:t,allowedRoles:e})=>{const{isAuthenticated:r,role:n,isLoading:s}=xn();return s?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):r?e&&!e.includes(n)?c.jsx($f,{to:"/unauthorized",replace:!0}):t:c.jsx($f,{to:"/login",replace:!0})},hge=()=>c.jsxs("div",{className:"unauthorized-page",children:[c.jsx("h1",{children:"Access Denied"}),c.jsx("p",{children:"You don't have permission to access this page."})]}),gge=()=>c.jsx(QP,{children:c.jsx(CM,{children:c.jsx(SM,{children:c.jsx(nW,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:c.jsx("div",{className:"app",children:c.jsxs(Qk,{children:[c.jsx(Fn,{path:"/login",element:c.jsx(mre,{})}),c.jsx(Fn,{path:"/unauthorized",element:c.jsx(hge,{})}),c.jsx(Fn,{path:"/student/*",element:c.jsx(D2,{allowedRoles:["student"],children:c.jsx(ane,{})})}),c.jsx(Fn,{path:"/teacher/*",element:c.jsx(D2,{allowedRoles:["teacher"],children:c.jsx(uge,{})})}),c.jsx(Fn,{path:"/admin/*",element:c.jsx(D2,{allowedRoles:["admin"],children:c.jsx(fge,{})})}),c.jsx(Fn,{path:"/",element:c.jsx($f,{to:"/login",replace:!0})}),c.jsx(Fn,{path:"*",element:c.jsx($f,{to:"/login",replace:!0})})]})})})})})});class mge{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const e=localStorage.getItem(this.userKey);return e?JSON.parse(e):null}setToken(e){localStorage.setItem(this.tokenKey,e)}setRefreshToken(e){localStorage.setItem(this.refreshTokenKey,e)}setUserData(e){localStorage.setItem(this.userKey,JSON.stringify(e))}setTokens(e,r){this.setToken(e),this.setUserData({role:r}),localStorage.setItem("accessToken",e)}isAuthenticated(){const e=this.getToken();if(!e)return!1;try{const r=JSON.parse(atob(e.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const e=this.getUserData();return e?e.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const e=this.getToken();return e?`Bearer ${e}`:null}async makeAuthenticatedRequest(e,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(e,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(e,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const e=this.getRefreshToken();if(!e)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(r.ok){const n=await r.json();return this.setToken(n.token),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(e){try{return JSON.parse(atob(e.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},50*60*1e3)}}const ek=new mge;window.tokenManager=ek;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{ek.init()}):ek.init());class VI{constructor(){this.currentRole=null,this.loadedFunctions=new Set,this.blockedFunctions=new Set,this.initialized=!1,this.retryCount=0,this.maxRetries=20}initialize(){if(this.initialized){console.log("[DEBUG] Role-based loader already initialized, skipping...");return}if(this.retryCount>=this.maxRetries){console.warn("[DEBUG] Max retries reached, stopping role-based loader initialization");return}if(this.retryCount++,(this.retryCount%5===1||this.retryCount===this.maxRetries)&&console.log(`[DEBUG] Role-based loader initializing... (attempt ${this.retryCount}/${this.maxRetries})`),console.log("[DEBUG] Token manager available:",!!window.tokenManager),window.tokenManager&&window.tokenManager.isAuthenticated()){const e=window.tokenManager.getUserRole();console.log("[DEBUG] Role from token manager:",e),console.log("[DEBUG] Access token exists:",!!window.tokenManager.getAccessToken()),e?(this.currentRole=e,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess()):(console.log("[DEBUG] No role found, waiting for role to be set..."),setTimeout(()=>this.initialize(),500))}else console.log("[DEBUG] Token manager not available or not authenticated, waiting..."),setTimeout(()=>this.initialize(),500)}setupRoleBasedAccess(){this.currentRole||(console.warn("No role detected, defaulting to student access"),this.currentRole="student");let e=!1;try{const r=window.tokenManager.getAccessToken();r&&(e=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check:",r),e=!1}console.log(`Role-based loader initialized for: ${this.currentRole}${e?" (admin)":""}`),this.loadRoleSpecificFunctions(),this.setupRoleBasedUI(),this.replaceBlockedFunctions()}loadRoleSpecificFunctions(){this.currentRole==="teacher"?this.loadTeacherFunctions():this.currentRole==="student"&&this.loadStudentFunctions()}loadTeacherFunctions(){console.log("Teacher functions already available in main script")}loadStudentFunctions(){console.log("Student functions already available in main script")}loadFunction(e,r){console.log(`Function ${e} already available in main script for ${r}`),this.loadedFunctions.add(e)}setupRoleBasedUI(){let e=!1;try{const r=window.tokenManager.getAccessToken();r&&(e=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check in UI:",r),e=!1}this.currentRole==="student"&&this.hideTeacherElements(),this.currentRole==="teacher"&&!e&&this.hideStudentElements()}hideTeacherElements(){[".teacher-cabinet",".test-creation-panel",".grade-management-panel",".class-management-panel",'[data-role="teacher"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}hideStudentElements(){[".student-cabinet",".test-taking-panel",".results-viewing-panel",'[data-role="student"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}replaceBlockedFunctions(){this.currentRole==="student"?this.blockTeacherFunctions():this.currentRole==="teacher"&&this.blockStudentFunctions()}blockTeacherFunctions(){Object.entries({createTest:()=>this.showAccessDenied("teacher"),assignTest:()=>this.showAccessDenied("teacher"),gradeTest:()=>this.showAccessDenied("teacher"),manageClasses:()=>this.showAccessDenied("teacher"),viewAllResults:()=>this.showAccessDenied("teacher")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}blockStudentFunctions(){Object.entries({takeTest:()=>this.showAccessDenied("student"),submitTest:()=>this.showAccessDenied("student"),viewMyResults:()=>this.showAccessDenied("student")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}showAccessDenied(e){const r=`Access denied. This function requires ${e} role.`;console.warn(r),typeof showNotification=="function"?showNotification(r,"warning"):alert(r)}isFunctionBlocked(e){return this.blockedFunctions.has(e)}isFunctionLoaded(e){return this.loadedFunctions.has(e)}getCurrentRole(){return this.currentRole}hasRole(e){return this.currentRole===e}reloadRoleAccess(){this.initialize()}setupAccessAfterLogin(){if(console.log("[DEBUG] Setting up role-based access after login..."),console.log("[DEBUG] Role-based loader will now initialize (no more retry loop before login)"),!window.tokenManager)return console.error("[ERROR] Token manager not available during setupAccessAfterLogin"),!1;if(!window.tokenManager.isAuthenticated())return console.error("[ERROR] User not authenticated during setupAccessAfterLogin"),!1;const e=window.tokenManager.getUserRole();return e?(console.log("[DEBUG] Setting role after login:",e),this.currentRole=e,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess(),console.log("[DEBUG] Role-based access setup completed successfully for role:",e),!0):(console.error("[ERROR] No role found in token during setupAccessAfterLogin"),!1)}}window.roleBasedLoader=new VI;typeof Hx<"u"&&Hx.exports&&(Hx.exports=VI);const pge=()=>{console.log("[DEBUG] Initializing application with new structure");const t={schemaVersion:"2.0",enhancedFeatures:!0,newUserStructure:!0,newTestStructure:!0};localStorage.setItem("app_init_data",JSON.stringify(t)),console.log("[DEBUG] Application initialized with enhanced features")},xge=()=>{console.log("[DEBUG] Starting main application"),pge(),R2.createRoot(document.getElementById("root")).render(c.jsx(Wn.StrictMode,{children:c.jsx(gge,{})}))};xge()});export default yge();
