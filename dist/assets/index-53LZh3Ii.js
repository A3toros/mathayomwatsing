var VV=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var P3e=VV((uAe,lb)=>{function mM(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var cb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ol(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var yS={exports:{}},tx={},vS={exports:{}},sn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ij;function KV(){if(Ij)return sn;Ij=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),i=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.iterator;function g(W){return W===null||typeof W!="object"?null:(W=h&&W[h]||W["@@iterator"],typeof W=="function"?W:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,v={};function w(W,R,U){this.props=W,this.context=R,this.refs=v,this.updater=U||p}w.prototype.isReactComponent={},w.prototype.setState=function(W,R){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,R,"setState")},w.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function C(){}C.prototype=w.prototype;function k(W,R,U){this.props=W,this.context=R,this.refs=v,this.updater=U||p}var b=k.prototype=new C;b.constructor=k,x(b,w.prototype),b.isPureReactComponent=!0;var N=Array.isArray,E=Object.prototype.hasOwnProperty,P={current:null},F={key:!0,ref:!0,__self:!0,__source:!0};function A(W,R,U){var q,Q={},se=null,X=null;if(R!=null)for(q in R.ref!==void 0&&(X=R.ref),R.key!==void 0&&(se=""+R.key),R)E.call(R,q)&&!F.hasOwnProperty(q)&&(Q[q]=R[q]);var ie=arguments.length-2;if(ie===1)Q.children=U;else if(1<ie){for(var le=Array(ie),ce=0;ce<ie;ce++)le[ce]=arguments[ce+2];Q.children=le}if(W&&W.defaultProps)for(q in ie=W.defaultProps,ie)Q[q]===void 0&&(Q[q]=ie[q]);return{$$typeof:e,type:W,key:se,ref:X,props:Q,_owner:P.current}}function j(W,R){return{$$typeof:e,type:W.type,key:R,ref:W.ref,props:W.props,_owner:W._owner}}function I(W){return typeof W=="object"&&W!==null&&W.$$typeof===e}function B(W){var R={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(U){return R[U]})}var Y=/\/+/g;function Z(W,R){return typeof W=="object"&&W!==null&&W.key!=null?B(""+W.key):R.toString(36)}function ae(W,R,U,q,Q){var se=typeof W;(se==="undefined"||se==="boolean")&&(W=null);var X=!1;if(W===null)X=!0;else switch(se){case"string":case"number":X=!0;break;case"object":switch(W.$$typeof){case e:case t:X=!0}}if(X)return X=W,Q=Q(X),W=q===""?"."+Z(X,0):q,N(Q)?(U="",W!=null&&(U=W.replace(Y,"$&/")+"/"),ae(Q,R,U,"",function(ce){return ce})):Q!=null&&(I(Q)&&(Q=j(Q,U+(!Q.key||X&&X.key===Q.key?"":(""+Q.key).replace(Y,"$&/")+"/")+W)),R.push(Q)),1;if(X=0,q=q===""?".":q+":",N(W))for(var ie=0;ie<W.length;ie++){se=W[ie];var le=q+Z(se,ie);X+=ae(se,R,U,le,Q)}else if(le=g(W),typeof le=="function")for(W=le.call(W),ie=0;!(se=W.next()).done;)se=se.value,le=q+Z(se,ie++),X+=ae(se,R,U,le,Q);else if(se==="object")throw R=String(W),Error("Objects are not valid as a React child (found: "+(R==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":R)+"). If you meant to render a collection of children, use an array instead.");return X}function ee(W,R,U){if(W==null)return W;var q=[],Q=0;return ae(W,q,"","",function(se){return R.call(U,se,Q++)}),q}function ne(W){if(W._status===-1){var R=W._result;R=R(),R.then(function(U){(W._status===0||W._status===-1)&&(W._status=1,W._result=U)},function(U){(W._status===0||W._status===-1)&&(W._status=2,W._result=U)}),W._status===-1&&(W._status=0,W._result=R)}if(W._status===1)return W._result.default;throw W._result}var L={current:null},H={transition:null},M={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:H,ReactCurrentOwner:P};function V(){throw Error("act(...) is not supported in production builds of React.")}return sn.Children={map:ee,forEach:function(W,R,U){ee(W,function(){R.apply(this,arguments)},U)},count:function(W){var R=0;return ee(W,function(){R++}),R},toArray:function(W){return ee(W,function(R){return R})||[]},only:function(W){if(!I(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},sn.Component=w,sn.Fragment=r,sn.Profiler=s,sn.PureComponent=k,sn.StrictMode=n,sn.Suspense=c,sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,sn.act=V,sn.cloneElement=function(W,R,U){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var q=x({},W.props),Q=W.key,se=W.ref,X=W._owner;if(R!=null){if(R.ref!==void 0&&(se=R.ref,X=P.current),R.key!==void 0&&(Q=""+R.key),W.type&&W.type.defaultProps)var ie=W.type.defaultProps;for(le in R)E.call(R,le)&&!F.hasOwnProperty(le)&&(q[le]=R[le]===void 0&&ie!==void 0?ie[le]:R[le])}var le=arguments.length-2;if(le===1)q.children=U;else if(1<le){ie=Array(le);for(var ce=0;ce<le;ce++)ie[ce]=arguments[ce+2];q.children=ie}return{$$typeof:e,type:W.type,key:Q,ref:se,props:q,_owner:X}},sn.createContext=function(W){return W={$$typeof:i,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:a,_context:W},W.Consumer=W},sn.createElement=A,sn.createFactory=function(W){var R=A.bind(null,W);return R.type=W,R},sn.createRef=function(){return{current:null}},sn.forwardRef=function(W){return{$$typeof:o,render:W}},sn.isValidElement=I,sn.lazy=function(W){return{$$typeof:d,_payload:{_status:-1,_result:W},_init:ne}},sn.memo=function(W,R){return{$$typeof:u,type:W,compare:R===void 0?null:R}},sn.startTransition=function(W){var R=H.transition;H.transition={};try{W()}finally{H.transition=R}},sn.unstable_act=V,sn.useCallback=function(W,R){return L.current.useCallback(W,R)},sn.useContext=function(W){return L.current.useContext(W)},sn.useDebugValue=function(){},sn.useDeferredValue=function(W){return L.current.useDeferredValue(W)},sn.useEffect=function(W,R){return L.current.useEffect(W,R)},sn.useId=function(){return L.current.useId()},sn.useImperativeHandle=function(W,R,U){return L.current.useImperativeHandle(W,R,U)},sn.useInsertionEffect=function(W,R){return L.current.useInsertionEffect(W,R)},sn.useLayoutEffect=function(W,R){return L.current.useLayoutEffect(W,R)},sn.useMemo=function(W,R){return L.current.useMemo(W,R)},sn.useReducer=function(W,R,U){return L.current.useReducer(W,R,U)},sn.useRef=function(W){return L.current.useRef(W)},sn.useState=function(W){return L.current.useState(W)},sn.useSyncExternalStore=function(W,R,U){return L.current.useSyncExternalStore(W,R,U)},sn.useTransition=function(){return L.current.useTransition()},sn.version="18.3.1",sn}var Rj;function k0(){return Rj||(Rj=1,vS.exports=KV()),vS.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mj;function qV(){if(Mj)return tx;Mj=1;var e=k0(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function i(o,c,u){var d,h={},g=null,p=null;u!==void 0&&(g=""+u),c.key!==void 0&&(g=""+c.key),c.ref!==void 0&&(p=c.ref);for(d in c)n.call(c,d)&&!a.hasOwnProperty(d)&&(h[d]=c[d]);if(o&&o.defaultProps)for(d in c=o.defaultProps,c)h[d]===void 0&&(h[d]=c[d]);return{$$typeof:t,type:o,key:g,ref:p,props:h,_owner:s.current}}return tx.Fragment=r,tx.jsx=i,tx.jsxs=i,tx}var Lj;function YV(){return Lj||(Lj=1,yS.exports=qV()),yS.exports}var l=YV(),S=k0();const Fs=Ol(S),pM=mM({__proto__:null,default:Fs},[S]);var ow={},wS={exports:{}},po={},bS={exports:{}},_S={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bj;function XV(){return Bj||(Bj=1,(function(e){function t(H,M){var V=H.length;H.push(M);e:for(;0<V;){var W=V-1>>>1,R=H[W];if(0<s(R,M))H[W]=M,H[V]=R,V=W;else break e}}function r(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var M=H[0],V=H.pop();if(V!==M){H[0]=V;e:for(var W=0,R=H.length,U=R>>>1;W<U;){var q=2*(W+1)-1,Q=H[q],se=q+1,X=H[se];if(0>s(Q,V))se<R&&0>s(X,Q)?(H[W]=X,H[se]=V,W=se):(H[W]=Q,H[q]=V,W=q);else if(se<R&&0>s(X,V))H[W]=X,H[se]=V,W=se;else break e}}return M}function s(H,M){var V=H.sortIndex-M.sortIndex;return V!==0?V:H.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],u=[],d=1,h=null,g=3,p=!1,x=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(H){for(var M=r(u);M!==null;){if(M.callback===null)n(u);else if(M.startTime<=H)n(u),M.sortIndex=M.expirationTime,t(c,M);else break;M=r(u)}}function N(H){if(v=!1,b(H),!x)if(r(c)!==null)x=!0,ne(E);else{var M=r(u);M!==null&&L(N,M.startTime-H)}}function E(H,M){x=!1,v&&(v=!1,C(A),A=-1),p=!0;var V=g;try{for(b(M),h=r(c);h!==null&&(!(h.expirationTime>M)||H&&!B());){var W=h.callback;if(typeof W=="function"){h.callback=null,g=h.priorityLevel;var R=W(h.expirationTime<=M);M=e.unstable_now(),typeof R=="function"?h.callback=R:h===r(c)&&n(c),b(M)}else n(c);h=r(c)}if(h!==null)var U=!0;else{var q=r(u);q!==null&&L(N,q.startTime-M),U=!1}return U}finally{h=null,g=V,p=!1}}var P=!1,F=null,A=-1,j=5,I=-1;function B(){return!(e.unstable_now()-I<j)}function Y(){if(F!==null){var H=e.unstable_now();I=H;var M=!0;try{M=F(!0,H)}finally{M?Z():(P=!1,F=null)}}else P=!1}var Z;if(typeof k=="function")Z=function(){k(Y)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,ee=ae.port2;ae.port1.onmessage=Y,Z=function(){ee.postMessage(null)}}else Z=function(){w(Y,0)};function ne(H){F=H,P||(P=!0,Z())}function L(H,M){A=w(function(){H(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(H){H.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,ne(E))},e.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<H?Math.floor(1e3/H):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(H){switch(g){case 1:case 2:case 3:var M=3;break;default:M=g}var V=g;g=M;try{return H()}finally{g=V}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(H,M){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var V=g;g=H;try{return M()}finally{g=V}},e.unstable_scheduleCallback=function(H,M,V){var W=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?W+V:W):V=W,H){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=V+R,H={id:d++,callback:M,priorityLevel:H,startTime:V,expirationTime:R,sortIndex:-1},V>W?(H.sortIndex=V,t(u,H),r(c)===null&&H===r(u)&&(v?(C(A),A=-1):v=!0,L(N,V-W))):(H.sortIndex=R,t(c,H),x||p||(x=!0,ne(E))),H},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(H){var M=g;return function(){var V=g;g=M;try{return H.apply(this,arguments)}finally{g=V}}}})(_S)),_S}var $j;function fN(){return $j||($j=1,bS.exports=XV()),bS.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uj;function QV(){if(Uj)return po;Uj=1;var e=k0(),t=fN();function r(f){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+f,T=1;T<arguments.length;T++)m+="&args[]="+encodeURIComponent(arguments[T]);return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function a(f,m){i(f,m),i(f+"Capture",m)}function i(f,m){for(s[f]=m,f=0;f<m.length;f++)n.add(m[f])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},h={};function g(f){return c.call(h,f)?!0:c.call(d,f)?!1:u.test(f)?h[f]=!0:(d[f]=!0,!1)}function p(f,m,T,D){if(T!==null&&T.type===0)return!1;switch(typeof m){case"function":case"symbol":return!0;case"boolean":return D?!1:T!==null?!T.acceptsBooleans:(f=f.toLowerCase().slice(0,5),f!=="data-"&&f!=="aria-");default:return!1}}function x(f,m,T,D){if(m===null||typeof m>"u"||p(f,m,T,D))return!0;if(D)return!1;if(T!==null)switch(T.type){case 3:return!m;case 4:return m===!1;case 5:return isNaN(m);case 6:return isNaN(m)||1>m}return!1}function v(f,m,T,D,G,J,de){this.acceptsBooleans=m===2||m===3||m===4,this.attributeName=D,this.attributeNamespace=G,this.mustUseProperty=T,this.propertyName=f,this.type=m,this.sanitizeURL=J,this.removeEmptyString=de}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(f){w[f]=new v(f,0,!1,f,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(f){var m=f[0];w[m]=new v(m,1,!1,f[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(f){w[f]=new v(f,2,!1,f.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(f){w[f]=new v(f,2,!1,f,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(f){w[f]=new v(f,3,!1,f.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(f){w[f]=new v(f,3,!0,f,null,!1,!1)}),["capture","download"].forEach(function(f){w[f]=new v(f,4,!1,f,null,!1,!1)}),["cols","rows","size","span"].forEach(function(f){w[f]=new v(f,6,!1,f,null,!1,!1)}),["rowSpan","start"].forEach(function(f){w[f]=new v(f,5,!1,f.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function k(f){return f[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(f){var m=f.replace(C,k);w[m]=new v(m,1,!1,f,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(f){var m=f.replace(C,k);w[m]=new v(m,1,!1,f,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(f){var m=f.replace(C,k);w[m]=new v(m,1,!1,f,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(f){w[f]=new v(f,1,!1,f.toLowerCase(),null,!1,!1)}),w.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(f){w[f]=new v(f,1,!1,f.toLowerCase(),null,!0,!0)});function b(f,m,T,D){var G=w.hasOwnProperty(m)?w[m]:null;(G!==null?G.type!==0:D||!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(x(m,T,G,D)&&(T=null),D||G===null?g(m)&&(T===null?f.removeAttribute(m):f.setAttribute(m,""+T)):G.mustUseProperty?f[G.propertyName]=T===null?G.type===3?!1:"":T:(m=G.attributeName,D=G.attributeNamespace,T===null?f.removeAttribute(m):(G=G.type,T=G===3||G===4&&T===!0?"":""+T,D?f.setAttributeNS(D,m,T):f.setAttribute(m,T))))}var N=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,E=Symbol.for("react.element"),P=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),B=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),ae=Symbol.for("react.suspense_list"),ee=Symbol.for("react.memo"),ne=Symbol.for("react.lazy"),L=Symbol.for("react.offscreen"),H=Symbol.iterator;function M(f){return f===null||typeof f!="object"?null:(f=H&&f[H]||f["@@iterator"],typeof f=="function"?f:null)}var V=Object.assign,W;function R(f){if(W===void 0)try{throw Error()}catch(T){var m=T.stack.trim().match(/\n( *(at )?)/);W=m&&m[1]||""}return`
`+W+f}var U=!1;function q(f,m){if(!f||U)return"";U=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch(dt){var D=dt}Reflect.construct(f,[],m)}else{try{m.call()}catch(dt){D=dt}f.call(m.prototype)}else{try{throw Error()}catch(dt){D=dt}f()}}catch(dt){if(dt&&D&&typeof dt.stack=="string"){for(var G=dt.stack.split(`
`),J=D.stack.split(`
`),de=G.length-1,je=J.length-1;1<=de&&0<=je&&G[de]!==J[je];)je--;for(;1<=de&&0<=je;de--,je--)if(G[de]!==J[je]){if(de!==1||je!==1)do if(de--,je--,0>je||G[de]!==J[je]){var Ie=`
`+G[de].replace(" at new "," at ");return f.displayName&&Ie.includes("<anonymous>")&&(Ie=Ie.replace("<anonymous>",f.displayName)),Ie}while(1<=de&&0<=je);break}}}finally{U=!1,Error.prepareStackTrace=T}return(f=f?f.displayName||f.name:"")?R(f):""}function Q(f){switch(f.tag){case 5:return R(f.type);case 16:return R("Lazy");case 13:return R("Suspense");case 19:return R("SuspenseList");case 0:case 2:case 15:return f=q(f.type,!1),f;case 11:return f=q(f.type.render,!1),f;case 1:return f=q(f.type,!0),f;default:return""}}function se(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case F:return"Fragment";case P:return"Portal";case j:return"Profiler";case A:return"StrictMode";case Z:return"Suspense";case ae:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case B:return(f.displayName||"Context")+".Consumer";case I:return(f._context.displayName||"Context")+".Provider";case Y:var m=f.render;return f=f.displayName,f||(f=m.displayName||m.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case ee:return m=f.displayName||null,m!==null?m:se(f.type)||"Memo";case ne:m=f._payload,f=f._init;try{return se(f(m))}catch{}}return null}function X(f){var m=f.type;switch(f.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=m.render,f=f.displayName||f.name||"",m.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return se(m);case 8:return m===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function ie(f){switch(typeof f){case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function le(f){var m=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function ce(f){var m=le(f)?"checked":"value",T=Object.getOwnPropertyDescriptor(f.constructor.prototype,m),D=""+f[m];if(!f.hasOwnProperty(m)&&typeof T<"u"&&typeof T.get=="function"&&typeof T.set=="function"){var G=T.get,J=T.set;return Object.defineProperty(f,m,{configurable:!0,get:function(){return G.call(this)},set:function(de){D=""+de,J.call(this,de)}}),Object.defineProperty(f,m,{enumerable:T.enumerable}),{getValue:function(){return D},setValue:function(de){D=""+de},stopTracking:function(){f._valueTracker=null,delete f[m]}}}}function Se(f){f._valueTracker||(f._valueTracker=ce(f))}function re(f){if(!f)return!1;var m=f._valueTracker;if(!m)return!0;var T=m.getValue(),D="";return f&&(D=le(f)?f.checked?"true":"false":f.value),f=D,f!==T?(m.setValue(f),!0):!1}function ge(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}function Ee(f,m){var T=m.checked;return V({},m,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:T??f._wrapperState.initialChecked})}function Ae(f,m){var T=m.defaultValue==null?"":m.defaultValue,D=m.checked!=null?m.checked:m.defaultChecked;T=ie(m.value!=null?m.value:T),f._wrapperState={initialChecked:D,initialValue:T,controlled:m.type==="checkbox"||m.type==="radio"?m.checked!=null:m.value!=null}}function He(f,m){m=m.checked,m!=null&&b(f,"checked",m,!1)}function Be(f,m){He(f,m);var T=ie(m.value),D=m.type;if(T!=null)D==="number"?(T===0&&f.value===""||f.value!=T)&&(f.value=""+T):f.value!==""+T&&(f.value=""+T);else if(D==="submit"||D==="reset"){f.removeAttribute("value");return}m.hasOwnProperty("value")?et(f,m.type,T):m.hasOwnProperty("defaultValue")&&et(f,m.type,ie(m.defaultValue)),m.checked==null&&m.defaultChecked!=null&&(f.defaultChecked=!!m.defaultChecked)}function Rt(f,m,T){if(m.hasOwnProperty("value")||m.hasOwnProperty("defaultValue")){var D=m.type;if(!(D!=="submit"&&D!=="reset"||m.value!==void 0&&m.value!==null))return;m=""+f._wrapperState.initialValue,T||m===f.value||(f.value=m),f.defaultValue=m}T=f.name,T!==""&&(f.name=""),f.defaultChecked=!!f._wrapperState.initialChecked,T!==""&&(f.name=T)}function et(f,m,T){(m!=="number"||ge(f.ownerDocument)!==f)&&(T==null?f.defaultValue=""+f._wrapperState.initialValue:f.defaultValue!==""+T&&(f.defaultValue=""+T))}var vt=Array.isArray;function xt(f,m,T,D){if(f=f.options,m){m={};for(var G=0;G<T.length;G++)m["$"+T[G]]=!0;for(T=0;T<f.length;T++)G=m.hasOwnProperty("$"+f[T].value),f[T].selected!==G&&(f[T].selected=G),G&&D&&(f[T].defaultSelected=!0)}else{for(T=""+ie(T),m=null,G=0;G<f.length;G++){if(f[G].value===T){f[G].selected=!0,D&&(f[G].defaultSelected=!0);return}m!==null||f[G].disabled||(m=f[G])}m!==null&&(m.selected=!0)}}function it(f,m){if(m.dangerouslySetInnerHTML!=null)throw Error(r(91));return V({},m,{value:void 0,defaultValue:void 0,children:""+f._wrapperState.initialValue})}function ht(f,m){var T=m.value;if(T==null){if(T=m.children,m=m.defaultValue,T!=null){if(m!=null)throw Error(r(92));if(vt(T)){if(1<T.length)throw Error(r(93));T=T[0]}m=T}m==null&&(m=""),T=m}f._wrapperState={initialValue:ie(T)}}function Dt(f,m){var T=ie(m.value),D=ie(m.defaultValue);T!=null&&(T=""+T,T!==f.value&&(f.value=T),m.defaultValue==null&&f.defaultValue!==T&&(f.defaultValue=T)),D!=null&&(f.defaultValue=""+D)}function Mt(f){var m=f.textContent;m===f._wrapperState.initialValue&&m!==""&&m!==null&&(f.value=m)}function Xe(f){switch(f){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function De(f,m){return f==null||f==="http://www.w3.org/1999/xhtml"?Xe(m):f==="http://www.w3.org/2000/svg"&&m==="foreignObject"?"http://www.w3.org/1999/xhtml":f}var Le,lt=(function(f){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(m,T,D,G){MSApp.execUnsafeLocalFunction(function(){return f(m,T,D,G)})}:f})(function(f,m){if(f.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in f)f.innerHTML=m;else{for(Le=Le||document.createElement("div"),Le.innerHTML="<svg>"+m.valueOf().toString()+"</svg>",m=Le.firstChild;f.firstChild;)f.removeChild(f.firstChild);for(;m.firstChild;)f.appendChild(m.firstChild)}});function Ue(f,m){if(m){var T=f.firstChild;if(T&&T===f.lastChild&&T.nodeType===3){T.nodeValue=m;return}}f.textContent=m}var tt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Et=["Webkit","ms","Moz","O"];Object.keys(tt).forEach(function(f){Et.forEach(function(m){m=m+f.charAt(0).toUpperCase()+f.substring(1),tt[m]=tt[f]})});function At(f,m,T){return m==null||typeof m=="boolean"||m===""?"":T||typeof m!="number"||m===0||tt.hasOwnProperty(f)&&tt[f]?(""+m).trim():m+"px"}function qt(f,m){f=f.style;for(var T in m)if(m.hasOwnProperty(T)){var D=T.indexOf("--")===0,G=At(T,m[T],D);T==="float"&&(T="cssFloat"),D?f.setProperty(T,G):f[T]=G}}var pr=V({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rr(f,m){if(m){if(pr[f]&&(m.children!=null||m.dangerouslySetInnerHTML!=null))throw Error(r(137,f));if(m.dangerouslySetInnerHTML!=null){if(m.children!=null)throw Error(r(60));if(typeof m.dangerouslySetInnerHTML!="object"||!("__html"in m.dangerouslySetInnerHTML))throw Error(r(61))}if(m.style!=null&&typeof m.style!="object")throw Error(r(62))}}function Kr(f,m){if(f.indexOf("-")===-1)return typeof m.is=="string";switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ur=null;function ir(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var me=null,Ne=null,Pe=null;function Re(f){if(f=ah(f)){if(typeof me!="function")throw Error(r(280));var m=f.stateNode;m&&(m=ea(m),me(f.stateNode,f.type,m))}}function Ct(f){Ne?Pe?Pe.push(f):Pe=[f]:Ne=f}function Fe(){if(Ne){var f=Ne,m=Pe;if(Pe=Ne=null,Re(f),m)for(f=0;f<m.length;f++)Re(m[f])}}function st(f,m){return f(m)}function ke(){}var We=!1;function Qe(f,m,T){if(We)return f(m,T);We=!0;try{return st(f,m,T)}finally{We=!1,(Ne!==null||Pe!==null)&&(ke(),Fe())}}function Pt(f,m){var T=f.stateNode;if(T===null)return null;var D=ea(T);if(D===null)return null;T=D[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(D=!D.disabled)||(f=f.type,D=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!D;break e;default:f=!1}if(f)return null;if(T&&typeof T!="function")throw Error(r(231,m,typeof T));return T}var zt=!1;if(o)try{var rr={};Object.defineProperty(rr,"passive",{get:function(){zt=!0}}),window.addEventListener("test",rr,rr),window.removeEventListener("test",rr,rr)}catch{zt=!1}function xr(f,m,T,D,G,J,de,je,Ie){var dt=Array.prototype.slice.call(arguments,3);try{m.apply(T,dt)}catch(Bt){this.onError(Bt)}}var cr=!1,qr=null,ue=!1,we=null,ye={onError:function(f){cr=!0,qr=f}};function xe(f,m,T,D,G,J,de,je,Ie){cr=!1,qr=null,xr.apply(ye,arguments)}function be(f,m,T,D,G,J,de,je,Ie){if(xe.apply(this,arguments),cr){if(cr){var dt=qr;cr=!1,qr=null}else throw Error(r(198));ue||(ue=!0,we=dt)}}function _e(f){var m=f,T=f;if(f.alternate)for(;m.return;)m=m.return;else{f=m;do m=f,(m.flags&4098)!==0&&(T=m.return),f=m.return;while(f)}return m.tag===3?T:null}function Ge(f){if(f.tag===13){var m=f.memoizedState;if(m===null&&(f=f.alternate,f!==null&&(m=f.memoizedState)),m!==null)return m.dehydrated}return null}function ut(f){if(_e(f)!==f)throw Error(r(188))}function qe(f){var m=f.alternate;if(!m){if(m=_e(f),m===null)throw Error(r(188));return m!==f?null:f}for(var T=f,D=m;;){var G=T.return;if(G===null)break;var J=G.alternate;if(J===null){if(D=G.return,D!==null){T=D;continue}break}if(G.child===J.child){for(J=G.child;J;){if(J===T)return ut(G),f;if(J===D)return ut(G),m;J=J.sibling}throw Error(r(188))}if(T.return!==D.return)T=G,D=J;else{for(var de=!1,je=G.child;je;){if(je===T){de=!0,T=G,D=J;break}if(je===D){de=!0,D=G,T=J;break}je=je.sibling}if(!de){for(je=J.child;je;){if(je===T){de=!0,T=J,D=G;break}if(je===D){de=!0,D=J,T=G;break}je=je.sibling}if(!de)throw Error(r(189))}}if(T.alternate!==D)throw Error(r(190))}if(T.tag!==3)throw Error(r(188));return T.stateNode.current===T?f:m}function oe(f){return f=qe(f),f!==null?he(f):null}function he(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var m=he(f);if(m!==null)return m;f=f.sibling}return null}var Te=t.unstable_scheduleCallback,Ce=t.unstable_cancelCallback,Ke=t.unstable_shouldYield,ot=t.unstable_requestPaint,mt=t.unstable_now,Wt=t.unstable_getCurrentPriorityLevel,pt=t.unstable_ImmediatePriority,Yt=t.unstable_UserBlockingPriority,vr=t.unstable_NormalPriority,_r=t.unstable_LowPriority,gr=t.unstable_IdlePriority,Fr=null,rn=null;function Qr(f){if(rn&&typeof rn.onCommitFiberRoot=="function")try{rn.onCommitFiberRoot(Fr,f,void 0,(f.current.flags&128)===128)}catch{}}var fe=Math.clz32?Math.clz32:kr,wt=Math.log,Sr=Math.LN2;function kr(f){return f>>>=0,f===0?32:31-(wt(f)/Sr|0)|0}var Nn=64,bn=4194304;function Zr(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function Me(f,m){var T=f.pendingLanes;if(T===0)return 0;var D=0,G=f.suspendedLanes,J=f.pingedLanes,de=T&268435455;if(de!==0){var je=de&~G;je!==0?D=Zr(je):(J&=de,J!==0&&(D=Zr(J)))}else de=T&~G,de!==0?D=Zr(de):J!==0&&(D=Zr(J));if(D===0)return 0;if(m!==0&&m!==D&&(m&G)===0&&(G=D&-D,J=m&-m,G>=J||G===16&&(J&4194240)!==0))return m;if((D&4)!==0&&(D|=T&16),m=f.entangledLanes,m!==0)for(f=f.entanglements,m&=D;0<m;)T=31-fe(m),G=1<<T,D|=f[T],m&=~G;return D}function Tt(f,m){switch(f){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gt(f,m){for(var T=f.suspendedLanes,D=f.pingedLanes,G=f.expirationTimes,J=f.pendingLanes;0<J;){var de=31-fe(J),je=1<<de,Ie=G[de];Ie===-1?((je&T)===0||(je&D)!==0)&&(G[de]=Tt(je,m)):Ie<=m&&(f.expiredLanes|=je),J&=~je}}function ar(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function es(){var f=Nn;return Nn<<=1,(Nn&4194240)===0&&(Nn=64),f}function Kn(f){for(var m=[],T=0;31>T;T++)m.push(f);return m}function Mi(f,m,T){f.pendingLanes|=m,m!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,m=31-fe(m),f[m]=T}function B0(f,m){var T=f.pendingLanes&~m;f.pendingLanes=m,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=m,f.mutableReadLanes&=m,f.entangledLanes&=m,m=f.entanglements;var D=f.eventTimes;for(f=f.expirationTimes;0<T;){var G=31-fe(T),J=1<<G;m[G]=0,D[G]=-1,f[G]=-1,T&=~J}}function Gf(f,m){var T=f.entangledLanes|=m;for(f=f.entanglements;T;){var D=31-fe(T),G=1<<D;G&m|f[D]&m&&(f[D]|=m),T&=~G}}var cn=0;function su(f){return f&=-f,1<f?4<f?(f&268435455)!==0?16:536870912:4:1}var rt,gt,Vt,kt,br,jt=!1,Ur=[],nn=null,Je=null,Xt=null,It=new Map,_n=new Map,Wr=[],Hr="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qn(f,m){switch(f){case"focusin":case"focusout":nn=null;break;case"dragenter":case"dragleave":Je=null;break;case"mouseover":case"mouseout":Xt=null;break;case"pointerover":case"pointerout":It.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":_n.delete(m.pointerId)}}function Mn(f,m,T,D,G,J){return f===null||f.nativeEvent!==J?(f={blockedOn:m,domEventName:T,eventSystemFlags:D,nativeEvent:J,targetContainers:[G]},m!==null&&(m=ah(m),m!==null&&gt(m)),f):(f.eventSystemFlags|=D,m=f.targetContainers,G!==null&&m.indexOf(G)===-1&&m.push(G),f)}function Yn(f,m,T,D,G){switch(m){case"focusin":return nn=Mn(nn,f,m,T,D,G),!0;case"dragenter":return Je=Mn(Je,f,m,T,D,G),!0;case"mouseover":return Xt=Mn(Xt,f,m,T,D,G),!0;case"pointerover":var J=G.pointerId;return It.set(J,Mn(It.get(J)||null,f,m,T,D,G)),!0;case"gotpointercapture":return J=G.pointerId,_n.set(J,Mn(_n.get(J)||null,f,m,T,D,G)),!0}return!1}function oo(f){var m=kc(f.target);if(m!==null){var T=_e(m);if(T!==null){if(m=T.tag,m===13){if(m=Ge(T),m!==null){f.blockedOn=m,br(f.priority,function(){Vt(T)});return}}else if(m===3&&T.stateNode.current.memoizedState.isDehydrated){f.blockedOn=T.tag===3?T.stateNode.containerInfo:null;return}}}f.blockedOn=null}function gc(f){if(f.blockedOn!==null)return!1;for(var m=f.targetContainers;0<m.length;){var T=z0(f.domEventName,f.eventSystemFlags,m[0],f.nativeEvent);if(T===null){T=f.nativeEvent;var D=new T.constructor(T.type,T);ur=D,T.target.dispatchEvent(D),ur=null}else return m=ah(T),m!==null&&gt(m),f.blockedOn=T,!1;m.shift()}return!0}function $0(f,m,T){gc(f)&&T.delete(m)}function z2(){jt=!1,nn!==null&&gc(nn)&&(nn=null),Je!==null&&gc(Je)&&(Je=null),Xt!==null&&gc(Xt)&&(Xt=null),It.forEach($0),_n.forEach($0)}function mc(f,m){f.blockedOn===m&&(f.blockedOn=null,jt||(jt=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,z2)))}function pi(f){function m(G){return mc(G,f)}if(0<Ur.length){mc(Ur[0],f);for(var T=1;T<Ur.length;T++){var D=Ur[T];D.blockedOn===f&&(D.blockedOn=null)}}for(nn!==null&&mc(nn,f),Je!==null&&mc(Je,f),Xt!==null&&mc(Xt,f),It.forEach(m),_n.forEach(m),T=0;T<Wr.length;T++)D=Wr[T],D.blockedOn===f&&(D.blockedOn=null);for(;0<Wr.length&&(T=Wr[0],T.blockedOn===null);)oo(T),T.blockedOn===null&&Wr.shift()}var vd=N.ReactCurrentBatchConfig,U0=!0;function Ao(f,m,T,D){var G=cn,J=vd.transition;vd.transition=null;try{cn=1,wd(f,m,T,D)}finally{cn=G,vd.transition=J}}function Ll(f,m,T,D){var G=cn,J=vd.transition;vd.transition=null;try{cn=4,wd(f,m,T,D)}finally{cn=G,vd.transition=J}}function wd(f,m,T,D){if(U0){var G=z0(f,m,T,D);if(G===null)sg(f,m,D,bd,T),qn(f,D);else if(Yn(G,f,m,T,D))D.stopPropagation();else if(qn(f,D),m&4&&-1<Hr.indexOf(f)){for(;G!==null;){var J=ah(G);if(J!==null&&rt(J),J=z0(f,m,T,D),J===null&&sg(f,m,D,bd,T),J===G)break;G=J}G!==null&&D.stopPropagation()}else sg(f,m,D,null,T)}}var bd=null;function z0(f,m,T,D){if(bd=null,f=ir(D),f=kc(f),f!==null)if(m=_e(f),m===null)f=null;else if(T=m.tag,T===13){if(f=Ge(m),f!==null)return f;f=null}else if(T===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;f=null}else m!==f&&(f=null);return bd=f,null}function d1(f){switch(f){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wt()){case pt:return 1;case Yt:return 4;case vr:case _r:return 16;case gr:return 536870912;default:return 16}default:return 16}}var fa=null,pc=null,Bl=null;function Vf(){if(Bl)return Bl;var f,m=pc,T=m.length,D,G="value"in fa?fa.value:fa.textContent,J=G.length;for(f=0;f<T&&m[f]===G[f];f++);var de=T-f;for(D=1;D<=de&&m[T-D]===G[J-D];D++);return Bl=G.slice(f,1<D?1-D:void 0)}function au(f){var m=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&m===13&&(f=13)):f=m,f===10&&(f=13),32<=f||f===13?f:0}function Va(){return!0}function Li(){return!1}function $s(f){function m(T,D,G,J,de){this._reactName=T,this._targetInst=G,this.type=D,this.nativeEvent=J,this.target=de,this.currentTarget=null;for(var je in f)f.hasOwnProperty(je)&&(T=f[je],this[je]=T?T(J):J[je]);return this.isDefaultPrevented=(J.defaultPrevented!=null?J.defaultPrevented:J.returnValue===!1)?Va:Li,this.isPropagationStopped=Li,this}return V(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var T=this.nativeEvent;T&&(T.preventDefault?T.preventDefault():typeof T.returnValue!="unknown"&&(T.returnValue=!1),this.isDefaultPrevented=Va)},stopPropagation:function(){var T=this.nativeEvent;T&&(T.stopPropagation?T.stopPropagation():typeof T.cancelBubble!="unknown"&&(T.cancelBubble=!0),this.isPropagationStopped=Va)},persist:function(){},isPersistent:Va}),m}var xi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jo=$s(xi),Po=V({},xi,{view:0,detail:0}),f1=$s(Po),Kf,qf,ha,Ka=V({},Po,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ou,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==ha&&(ha&&f.type==="mousemove"?(Kf=f.screenX-ha.screenX,qf=f.screenY-ha.screenY):qf=Kf=0,ha=f),Kf)},movementY:function(f){return"movementY"in f?f.movementY:qf}}),Wn=$s(Ka),Yf=V({},Ka,{dataTransfer:0}),Fo=$s(Yf),h1=V({},Po,{relatedTarget:0}),W0=$s(h1),fp=V({},xi,{animationName:0,elapsedTime:0,pseudoElement:0}),hp=$s(fp),g1=V({},xi,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),H0=$s(g1),m1=V({},xi,{data:0}),iu=$s(m1),gp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},W2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},G0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function H2(f){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(f):(f=G0[f])?!!m[f]:!1}function ou(){return H2}var V0=V({},Po,{key:function(f){if(f.key){var m=gp[f.key]||f.key;if(m!=="Unidentified")return m}return f.type==="keypress"?(f=au(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?W2[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ou,charCode:function(f){return f.type==="keypress"?au(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?au(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),p1=$s(V0),x1=V({},Ka,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lu=$s(x1),y1=V({},Po,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ou}),K0=$s(y1),q0=V({},xi,{propertyName:0,elapsedTime:0,pseudoElement:0}),_d=$s(q0),mp=V({},Ka,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),pp=$s(mp),v1=[9,13,27,32],Xf=o&&"CompositionEvent"in window,cu=null;o&&"documentMode"in document&&(cu=document.documentMode);var Sd=o&&"TextEvent"in window&&!cu,Bi=o&&(!Xf||cu&&8<cu&&11>=cu),xc=" ",Y0=!1;function xp(f,m){switch(f){case"keyup":return v1.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Oo(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var $i=!1;function yp(f,m){switch(f){case"compositionend":return Oo(m);case"keypress":return m.which!==32?null:(Y0=!0,xc);case"textInput":return f=m.data,f===xc&&Y0?null:f;default:return null}}function w1(f,m){if($i)return f==="compositionend"||!Xf&&xp(f,m)?(f=Vf(),Bl=pc=fa=null,$i=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return Bi&&m.locale!=="ko"?null:m.data;default:return null}}var $l={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ul(f){var m=f&&f.nodeName&&f.nodeName.toLowerCase();return m==="input"?!!$l[f.type]:m==="textarea"}function Qf(f,m,T,D){Ct(D),m=ag(m,"onChange"),0<m.length&&(T=new jo("onChange","change",null,T,D),f.push({event:T,listeners:m}))}var kd=null,yc=null;function b1(f){Ap(f,0)}function vc(f){var m=zs(f);if(re(m))return f}function lo(f,m){if(f==="change")return m}var Cd=!1;if(o){var wc;if(o){var co="oninput"in document;if(!co){var X0=document.createElement("div");X0.setAttribute("oninput","return;"),co=typeof X0.oninput=="function"}wc=co}else wc=!1;Cd=wc&&(!document.documentMode||9<document.documentMode)}function uu(){kd&&(kd.detachEvent("onpropertychange",vp),yc=kd=null)}function vp(f){if(f.propertyName==="value"&&vc(yc)){var m=[];Qf(m,yc,f,ir(f)),Qe(b1,m)}}function wp(f,m,T){f==="focusin"?(uu(),kd=m,yc=T,kd.attachEvent("onpropertychange",vp)):f==="focusout"&&uu()}function ts(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return vc(yc)}function Q0(f,m){if(f==="click")return vc(m)}function bp(f,m){if(f==="input"||f==="change")return vc(m)}function _p(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var yi=typeof Object.is=="function"?Object.is:_p;function du(f,m){if(yi(f,m))return!0;if(typeof f!="object"||f===null||typeof m!="object"||m===null)return!1;var T=Object.keys(f),D=Object.keys(m);if(T.length!==D.length)return!1;for(D=0;D<T.length;D++){var G=T[D];if(!c.call(m,G)||!yi(f[G],m[G]))return!1}return!0}function bc(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function Xn(f,m){var T=bc(f);f=0;for(var D;T;){if(T.nodeType===3){if(D=f+T.textContent.length,f<=m&&D>=m)return{node:T,offset:m-f};f=D}e:{for(;T;){if(T.nextSibling){T=T.nextSibling;break e}T=T.parentNode}T=void 0}T=bc(T)}}function ks(f,m){return f&&m?f===m?!0:f&&f.nodeType===3?!1:m&&m.nodeType===3?ks(f,m.parentNode):"contains"in f?f.contains(m):f.compareDocumentPosition?!!(f.compareDocumentPosition(m)&16):!1:!1}function Us(){for(var f=window,m=ge();m instanceof f.HTMLIFrameElement;){try{var T=typeof m.contentWindow.location.href=="string"}catch{T=!1}if(T)f=m.contentWindow;else break;m=ge(f.document)}return m}function Td(f){var m=f&&f.nodeName&&f.nodeName.toLowerCase();return m&&(m==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||m==="textarea"||f.contentEditable==="true")}function Jf(f){var m=Us(),T=f.focusedElem,D=f.selectionRange;if(m!==T&&T&&T.ownerDocument&&ks(T.ownerDocument.documentElement,T)){if(D!==null&&Td(T)){if(m=D.start,f=D.end,f===void 0&&(f=m),"selectionStart"in T)T.selectionStart=m,T.selectionEnd=Math.min(f,T.value.length);else if(f=(m=T.ownerDocument||document)&&m.defaultView||window,f.getSelection){f=f.getSelection();var G=T.textContent.length,J=Math.min(D.start,G);D=D.end===void 0?J:Math.min(D.end,G),!f.extend&&J>D&&(G=D,D=J,J=G),G=Xn(T,J);var de=Xn(T,D);G&&de&&(f.rangeCount!==1||f.anchorNode!==G.node||f.anchorOffset!==G.offset||f.focusNode!==de.node||f.focusOffset!==de.offset)&&(m=m.createRange(),m.setStart(G.node,G.offset),f.removeAllRanges(),J>D?(f.addRange(m),f.extend(de.node,de.offset)):(m.setEnd(de.node,de.offset),f.addRange(m)))}}for(m=[],f=T;f=f.parentNode;)f.nodeType===1&&m.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<m.length;T++)f=m[T],f.element.scrollLeft=f.left,f.element.scrollTop=f.top}}var Zf=o&&"documentMode"in document&&11>=document.documentMode,Ed=null,Zs=null,fu=null,eh=!1;function J0(f,m,T){var D=T.window===T?T.document:T.nodeType===9?T:T.ownerDocument;eh||Ed==null||Ed!==ge(D)||(D=Ed,"selectionStart"in D&&Td(D)?D={start:D.selectionStart,end:D.selectionEnd}:(D=(D.ownerDocument&&D.ownerDocument.defaultView||window).getSelection(),D={anchorNode:D.anchorNode,anchorOffset:D.anchorOffset,focusNode:D.focusNode,focusOffset:D.focusOffset}),fu&&du(fu,D)||(fu=D,D=ag(Zs,"onSelect"),0<D.length&&(m=new jo("onSelect","select",null,m,T),f.push({event:m,listeners:D}),m.target=Ed)))}function Ui(f,m){var T={};return T[f.toLowerCase()]=m.toLowerCase(),T["Webkit"+f]="webkit"+m,T["Moz"+f]="moz"+m,T}var ga={animationend:Ui("Animation","AnimationEnd"),animationiteration:Ui("Animation","AnimationIteration"),animationstart:Ui("Animation","AnimationStart"),transitionend:Ui("Transition","TransitionEnd")},hu={},Z0={};o&&(Z0=document.createElement("div").style,"AnimationEvent"in window||(delete ga.animationend.animation,delete ga.animationiteration.animation,delete ga.animationstart.animation),"TransitionEvent"in window||delete ga.transitionend.transition);function Nd(f){if(hu[f])return hu[f];if(!ga[f])return f;var m=ga[f],T;for(T in m)if(m.hasOwnProperty(T)&&T in Z0)return hu[f]=m[T];return f}var Sp=Nd("animationend"),kp=Nd("animationiteration"),Cp=Nd("animationstart"),Tp=Nd("transitionend"),Ep=new Map,Np="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zl(f,m){Ep.set(f,m),a(m,[f])}for(var eg=0;eg<Np.length;eg++){var gu=Np[eg],_1=gu.toLowerCase(),tg=gu[0].toUpperCase()+gu.slice(1);zl(_1,"on"+tg)}zl(Sp,"onAnimationEnd"),zl(kp,"onAnimationIteration"),zl(Cp,"onAnimationStart"),zl("dblclick","onDoubleClick"),zl("focusin","onFocus"),zl("focusout","onBlur"),zl(Tp,"onTransitionEnd"),i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _c="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),S1=new Set("cancel close invalid load scroll toggle".split(" ").concat(_c));function rg(f,m,T){var D=f.type||"unknown-event";f.currentTarget=T,be(D,m,void 0,f),f.currentTarget=null}function Ap(f,m){m=(m&4)!==0;for(var T=0;T<f.length;T++){var D=f[T],G=D.event;D=D.listeners;e:{var J=void 0;if(m)for(var de=D.length-1;0<=de;de--){var je=D[de],Ie=je.instance,dt=je.currentTarget;if(je=je.listener,Ie!==J&&G.isPropagationStopped())break e;rg(G,je,dt),J=Ie}else for(de=0;de<D.length;de++){if(je=D[de],Ie=je.instance,dt=je.currentTarget,je=je.listener,Ie!==J&&G.isPropagationStopped())break e;rg(G,je,dt),J=Ie}}}if(ue)throw f=we,ue=!1,we=null,f}function Ln(f,m){var T=m[og];T===void 0&&(T=m[og]=new Set);var D=f+"__bubble";T.has(D)||(jp(m,f,2,!1),T.add(D))}function ng(f,m,T){var D=0;m&&(D|=4),jp(T,f,D,m)}var th="_reactListening"+Math.random().toString(36).slice(2);function mu(f){if(!f[th]){f[th]=!0,n.forEach(function(T){T!=="selectionchange"&&(S1.has(T)||ng(T,!1,f),ng(T,!0,f))});var m=f.nodeType===9?f:f.ownerDocument;m===null||m[th]||(m[th]=!0,ng("selectionchange",!1,m))}}function jp(f,m,T,D){switch(d1(m)){case 1:var G=Ao;break;case 4:G=Ll;break;default:G=wd}T=G.bind(null,m,T,f),G=void 0,!zt||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(G=!0),D?G!==void 0?f.addEventListener(m,T,{capture:!0,passive:G}):f.addEventListener(m,T,!0):G!==void 0?f.addEventListener(m,T,{passive:G}):f.addEventListener(m,T,!1)}function sg(f,m,T,D,G){var J=D;if((m&1)===0&&(m&2)===0&&D!==null)e:for(;;){if(D===null)return;var de=D.tag;if(de===3||de===4){var je=D.stateNode.containerInfo;if(je===G||je.nodeType===8&&je.parentNode===G)break;if(de===4)for(de=D.return;de!==null;){var Ie=de.tag;if((Ie===3||Ie===4)&&(Ie=de.stateNode.containerInfo,Ie===G||Ie.nodeType===8&&Ie.parentNode===G))return;de=de.return}for(;je!==null;){if(de=kc(je),de===null)return;if(Ie=de.tag,Ie===5||Ie===6){D=J=de;continue e}je=je.parentNode}}D=D.return}Qe(function(){var dt=J,Bt=ir(T),Ut=[];e:{var Lt=Ep.get(f);if(Lt!==void 0){var or=jo,mr=f;switch(f){case"keypress":if(au(T)===0)break e;case"keydown":case"keyup":or=p1;break;case"focusin":mr="focus",or=W0;break;case"focusout":mr="blur",or=W0;break;case"beforeblur":case"afterblur":or=W0;break;case"click":if(T.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":or=Wn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":or=Fo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":or=K0;break;case Sp:case kp:case Cp:or=hp;break;case Tp:or=_d;break;case"scroll":or=f1;break;case"wheel":or=pp;break;case"copy":case"cut":case"paste":or=H0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":or=lu}var yr=(m&4)!==0,Vs=!yr&&f==="scroll",Ze=yr?Lt!==null?Lt+"Capture":null:Lt;yr=[];for(var $e=dt,at;$e!==null;){at=$e;var Kt=at.stateNode;if(at.tag===5&&Kt!==null&&(at=Kt,Ze!==null&&(Kt=Pt($e,Ze),Kt!=null&&yr.push(Ad($e,Kt,at)))),Vs)break;$e=$e.return}0<yr.length&&(Lt=new or(Lt,mr,null,T,Bt),Ut.push({event:Lt,listeners:yr}))}}if((m&7)===0){e:{if(Lt=f==="mouseover"||f==="pointerover",or=f==="mouseout"||f==="pointerout",Lt&&T!==ur&&(mr=T.relatedTarget||T.fromElement)&&(kc(mr)||mr[el]))break e;if((or||Lt)&&(Lt=Bt.window===Bt?Bt:(Lt=Bt.ownerDocument)?Lt.defaultView||Lt.parentWindow:window,or?(mr=T.relatedTarget||T.toElement,or=dt,mr=mr?kc(mr):null,mr!==null&&(Vs=_e(mr),mr!==Vs||mr.tag!==5&&mr.tag!==6)&&(mr=null)):(or=null,mr=dt),or!==mr)){if(yr=Wn,Kt="onMouseLeave",Ze="onMouseEnter",$e="mouse",(f==="pointerout"||f==="pointerover")&&(yr=lu,Kt="onPointerLeave",Ze="onPointerEnter",$e="pointer"),Vs=or==null?Lt:zs(or),at=mr==null?Lt:zs(mr),Lt=new yr(Kt,$e+"leave",or,T,Bt),Lt.target=Vs,Lt.relatedTarget=at,Kt=null,kc(Bt)===dt&&(yr=new yr(Ze,$e+"enter",mr,T,Bt),yr.target=at,yr.relatedTarget=Vs,Kt=yr),Vs=Kt,or&&mr)t:{for(yr=or,Ze=mr,$e=0,at=yr;at;at=pu(at))$e++;for(at=0,Kt=Ze;Kt;Kt=pu(Kt))at++;for(;0<$e-at;)yr=pu(yr),$e--;for(;0<at-$e;)Ze=pu(Ze),at--;for(;$e--;){if(yr===Ze||Ze!==null&&yr===Ze.alternate)break t;yr=pu(yr),Ze=pu(Ze)}yr=null}else yr=null;or!==null&&k1(Ut,Lt,or,yr,!1),mr!==null&&Vs!==null&&k1(Ut,Vs,mr,yr,!0)}}e:{if(Lt=dt?zs(dt):window,or=Lt.nodeName&&Lt.nodeName.toLowerCase(),or==="select"||or==="input"&&Lt.type==="file")var wr=lo;else if(Ul(Lt))if(Cd)wr=bp;else{wr=ts;var Er=wp}else(or=Lt.nodeName)&&or.toLowerCase()==="input"&&(Lt.type==="checkbox"||Lt.type==="radio")&&(wr=Q0);if(wr&&(wr=wr(f,dt))){Qf(Ut,wr,T,Bt);break e}Er&&Er(f,Lt,dt),f==="focusout"&&(Er=Lt._wrapperState)&&Er.controlled&&Lt.type==="number"&&et(Lt,"number",Lt.value)}switch(Er=dt?zs(dt):window,f){case"focusin":(Ul(Er)||Er.contentEditable==="true")&&(Ed=Er,Zs=dt,fu=null);break;case"focusout":fu=Zs=Ed=null;break;case"mousedown":eh=!0;break;case"contextmenu":case"mouseup":case"dragend":eh=!1,J0(Ut,T,Bt);break;case"selectionchange":if(Zf)break;case"keydown":case"keyup":J0(Ut,T,Bt)}var Nr;if(Xf)e:{switch(f){case"compositionstart":var Mr="onCompositionStart";break e;case"compositionend":Mr="onCompositionEnd";break e;case"compositionupdate":Mr="onCompositionUpdate";break e}Mr=void 0}else $i?xp(f,T)&&(Mr="onCompositionEnd"):f==="keydown"&&T.keyCode===229&&(Mr="onCompositionStart");Mr&&(Bi&&T.locale!=="ko"&&($i||Mr!=="onCompositionStart"?Mr==="onCompositionEnd"&&$i&&(Nr=Vf()):(fa=Bt,pc="value"in fa?fa.value:fa.textContent,$i=!0)),Er=ag(dt,Mr),0<Er.length&&(Mr=new iu(Mr,f,null,T,Bt),Ut.push({event:Mr,listeners:Er}),Nr?Mr.data=Nr:(Nr=Oo(T),Nr!==null&&(Mr.data=Nr)))),(Nr=Sd?yp(f,T):w1(f,T))&&(dt=ag(dt,"onBeforeInput"),0<dt.length&&(Bt=new iu("onBeforeInput","beforeinput",null,T,Bt),Ut.push({event:Bt,listeners:dt}),Bt.data=Nr))}Ap(Ut,m)})}function Ad(f,m,T){return{instance:f,listener:m,currentTarget:T}}function ag(f,m){for(var T=m+"Capture",D=[];f!==null;){var G=f,J=G.stateNode;G.tag===5&&J!==null&&(G=J,J=Pt(f,T),J!=null&&D.unshift(Ad(f,J,G)),J=Pt(f,m),J!=null&&D.push(Ad(f,J,G))),f=f.return}return D}function pu(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5);return f||null}function k1(f,m,T,D,G){for(var J=m._reactName,de=[];T!==null&&T!==D;){var je=T,Ie=je.alternate,dt=je.stateNode;if(Ie!==null&&Ie===D)break;je.tag===5&&dt!==null&&(je=dt,G?(Ie=Pt(T,J),Ie!=null&&de.unshift(Ad(T,Ie,je))):G||(Ie=Pt(T,J),Ie!=null&&de.push(Ad(T,Ie,je)))),T=T.return}de.length!==0&&f.push({event:m,listeners:de})}var G2=/\r\n?/g,C1=/\u0000|\uFFFD/g;function Pp(f){return(typeof f=="string"?f:""+f).replace(G2,`
`).replace(C1,"")}function rh(f,m,T){if(m=Pp(m),Pp(f)!==m&&T)throw Error(r(425))}function xu(){}var Fp=null,Op=null;function Dp(f,m){return f==="textarea"||f==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var zi=typeof setTimeout=="function"?setTimeout:void 0,Ip=typeof clearTimeout=="function"?clearTimeout:void 0,nh=typeof Promise=="function"?Promise:void 0,T1=typeof queueMicrotask=="function"?queueMicrotask:typeof nh<"u"?function(f){return nh.resolve(null).then(f).catch(E1)}:zi;function E1(f){setTimeout(function(){throw f})}function ig(f,m){var T=m,D=0;do{var G=T.nextSibling;if(f.removeChild(T),G&&G.nodeType===8)if(T=G.data,T==="/$"){if(D===0){f.removeChild(G),pi(m);return}D--}else T!=="$"&&T!=="$?"&&T!=="$!"||D++;T=G}while(T);pi(m)}function Zo(f){for(;f!=null;f=f.nextSibling){var m=f.nodeType;if(m===1||m===3)break;if(m===8){if(m=f.data,m==="$"||m==="$!"||m==="$?")break;if(m==="/$")return null}}return f}function yu(f){f=f.previousSibling;for(var m=0;f;){if(f.nodeType===8){var T=f.data;if(T==="$"||T==="$!"||T==="$?"){if(m===0)return f;m--}else T==="/$"&&m++}f=f.previousSibling}return null}var Sc=Math.random().toString(36).slice(2),uo="__reactFiber$"+Sc,sh="__reactProps$"+Sc,el="__reactContainer$"+Sc,og="__reactEvents$"+Sc,N1="__reactListeners$"+Sc,A1="__reactHandles$"+Sc;function kc(f){var m=f[uo];if(m)return m;for(var T=f.parentNode;T;){if(m=T[el]||T[uo]){if(T=m.alternate,m.child!==null||T!==null&&T.child!==null)for(f=yu(f);f!==null;){if(T=f[uo])return T;f=yu(f)}return m}f=T,T=f.parentNode}return null}function ah(f){return f=f[uo]||f[el],!f||f.tag!==5&&f.tag!==6&&f.tag!==13&&f.tag!==3?null:f}function zs(f){if(f.tag===5||f.tag===6)return f.stateNode;throw Error(r(33))}function ea(f){return f[sh]||null}var lg=[],vu=-1;function Wl(f){return{current:f}}function Bn(f){0>vu||(f.current=lg[vu],lg[vu]=null,vu--)}function An(f,m){vu++,lg[vu]=f.current,f.current=m}var tl={},ma=Wl(tl),Ta=Wl(!1),Cc=tl;function wu(f,m){var T=f.type.contextTypes;if(!T)return tl;var D=f.stateNode;if(D&&D.__reactInternalMemoizedUnmaskedChildContext===m)return D.__reactInternalMemoizedMaskedChildContext;var G={},J;for(J in T)G[J]=m[J];return D&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=m,f.__reactInternalMemoizedMaskedChildContext=G),G}function Ea(f){return f=f.childContextTypes,f!=null}function jd(){Bn(Ta),Bn(ma)}function Rp(f,m,T){if(ma.current!==tl)throw Error(r(168));An(ma,m),An(Ta,T)}function cg(f,m,T){var D=f.stateNode;if(m=m.childContextTypes,typeof D.getChildContext!="function")return T;D=D.getChildContext();for(var G in D)if(!(G in m))throw Error(r(108,X(f)||"Unknown",G));return V({},T,D)}function bu(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||tl,Cc=ma.current,An(ma,f),An(Ta,Ta.current),!0}function j1(f,m,T){var D=f.stateNode;if(!D)throw Error(r(169));T?(f=cg(f,m,Cc),D.__reactInternalMemoizedMergedChildContext=f,Bn(Ta),Bn(ma),An(ma,f)):Bn(Ta),An(Ta,T)}var rl=null,Pd=!1,ug=!1;function ih(f){rl===null?rl=[f]:rl.push(f)}function Hl(f){Pd=!0,ih(f)}function Tc(){if(!ug&&rl!==null){ug=!0;var f=0,m=cn;try{var T=rl;for(cn=1;f<T.length;f++){var D=T[f];do D=D(!0);while(D!==null)}rl=null,Pd=!1}catch(G){throw rl!==null&&(rl=rl.slice(f+1)),Te(pt,Tc),G}finally{cn=m,ug=!1}}return null}var qa=[],_u=0,Ec=null,Nc=0,Ya=[],Xa=0,Ac=null,Wi=1,Qn="";function Su(f,m){qa[_u++]=Nc,qa[_u++]=Ec,Ec=f,Nc=m}function P1(f,m,T){Ya[Xa++]=Wi,Ya[Xa++]=Qn,Ya[Xa++]=Ac,Ac=f;var D=Wi;f=Qn;var G=32-fe(D)-1;D&=~(1<<G),T+=1;var J=32-fe(m)+G;if(30<J){var de=G-G%5;J=(D&(1<<de)-1).toString(32),D>>=de,G-=de,Wi=1<<32-fe(m)+G|T<<G|D,Qn=J+f}else Wi=1<<J|T<<G|D,Qn=f}function Fd(f){f.return!==null&&(Su(f,1),P1(f,1,0))}function ta(f){for(;f===Ec;)Ec=qa[--_u],qa[_u]=null,Nc=qa[--_u],qa[_u]=null;for(;f===Ac;)Ac=Ya[--Xa],Ya[Xa]=null,Qn=Ya[--Xa],Ya[Xa]=null,Wi=Ya[--Xa],Ya[Xa]=null}var Hi=null,tr=null,Sn=!1,Gi=null;function Mp(f,m){var T=cl(5,null,null,0);T.elementType="DELETED",T.stateNode=m,T.return=f,m=f.deletions,m===null?(f.deletions=[T],f.flags|=16):m.push(T)}function F1(f,m){switch(f.tag){case 5:var T=f.type;return m=m.nodeType!==1||T.toLowerCase()!==m.nodeName.toLowerCase()?null:m,m!==null?(f.stateNode=m,Hi=f,tr=Zo(m.firstChild),!0):!1;case 6:return m=f.pendingProps===""||m.nodeType!==3?null:m,m!==null?(f.stateNode=m,Hi=f,tr=null,!0):!1;case 13:return m=m.nodeType!==8?null:m,m!==null?(T=Ac!==null?{id:Wi,overflow:Qn}:null,f.memoizedState={dehydrated:m,treeContext:T,retryLane:1073741824},T=cl(18,null,null,0),T.stateNode=m,T.return=f,f.child=T,Hi=f,tr=null,!0):!1;default:return!1}}function ku(f){return(f.mode&1)!==0&&(f.flags&128)===0}function Od(f){if(Sn){var m=tr;if(m){var T=m;if(!F1(f,m)){if(ku(f))throw Error(r(418));m=Zo(T.nextSibling);var D=Hi;m&&F1(f,m)?Mp(D,T):(f.flags=f.flags&-4097|2,Sn=!1,Hi=f)}}else{if(ku(f))throw Error(r(418));f.flags=f.flags&-4097|2,Sn=!1,Hi=f}}}function dg(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;Hi=f}function oh(f){if(f!==Hi)return!1;if(!Sn)return dg(f),Sn=!0,!1;var m;if((m=f.tag!==3)&&!(m=f.tag!==5)&&(m=f.type,m=m!=="head"&&m!=="body"&&!Dp(f.type,f.memoizedProps)),m&&(m=tr)){if(ku(f))throw Lp(),Error(r(418));for(;m;)Mp(f,m),m=Zo(m.nextSibling)}if(dg(f),f.tag===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));e:{for(f=f.nextSibling,m=0;f;){if(f.nodeType===8){var T=f.data;if(T==="/$"){if(m===0){tr=Zo(f.nextSibling);break e}m--}else T!=="$"&&T!=="$!"&&T!=="$?"||m++}f=f.nextSibling}tr=null}}else tr=Hi?Zo(f.stateNode.nextSibling):null;return!0}function Lp(){for(var f=tr;f;)f=Zo(f.nextSibling)}function Cu(){tr=Hi=null,Sn=!1}function lh(f){Gi===null?Gi=[f]:Gi.push(f)}var Bp=N.ReactCurrentBatchConfig;function xs(f,m,T){if(f=T.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(T._owner){if(T=T._owner,T){if(T.tag!==1)throw Error(r(309));var D=T.stateNode}if(!D)throw Error(r(147,f));var G=D,J=""+f;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===J?m.ref:(m=function(de){var je=G.refs;de===null?delete je[J]:je[J]=de},m._stringRef=J,m)}if(typeof f!="string")throw Error(r(284));if(!T._owner)throw Error(r(290,f))}return f}function vi(f,m){throw f=Object.prototype.toString.call(m),Error(r(31,f==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":f))}function Do(f){var m=f._init;return m(f._payload)}function fg(f){function m(Ze,$e){if(f){var at=Ze.deletions;at===null?(Ze.deletions=[$e],Ze.flags|=16):at.push($e)}}function T(Ze,$e){if(!f)return null;for(;$e!==null;)m(Ze,$e),$e=$e.sibling;return null}function D(Ze,$e){for(Ze=new Map;$e!==null;)$e.key!==null?Ze.set($e.key,$e):Ze.set($e.index,$e),$e=$e.sibling;return Ze}function G(Ze,$e){return Ze=Zd(Ze,$e),Ze.index=0,Ze.sibling=null,Ze}function J(Ze,$e,at){return Ze.index=at,f?(at=Ze.alternate,at!==null?(at=at.index,at<$e?(Ze.flags|=2,$e):at):(Ze.flags|=2,$e)):(Ze.flags|=1048576,$e)}function de(Ze){return f&&Ze.alternate===null&&(Ze.flags|=2),Ze}function je(Ze,$e,at,Kt){return $e===null||$e.tag!==6?($e=fS(at,Ze.mode,Kt),$e.return=Ze,$e):($e=G($e,at),$e.return=Ze,$e)}function Ie(Ze,$e,at,Kt){var wr=at.type;return wr===F?Bt(Ze,$e,at.props.children,Kt,at.key):$e!==null&&($e.elementType===wr||typeof wr=="object"&&wr!==null&&wr.$$typeof===ne&&Do(wr)===$e.type)?(Kt=G($e,at.props),Kt.ref=xs(Ze,$e,at),Kt.return=Ze,Kt):(Kt=Z1(at.type,at.key,at.props,null,Ze.mode,Kt),Kt.ref=xs(Ze,$e,at),Kt.return=Ze,Kt)}function dt(Ze,$e,at,Kt){return $e===null||$e.tag!==4||$e.stateNode.containerInfo!==at.containerInfo||$e.stateNode.implementation!==at.implementation?($e=hS(at,Ze.mode,Kt),$e.return=Ze,$e):($e=G($e,at.children||[]),$e.return=Ze,$e)}function Bt(Ze,$e,at,Kt,wr){return $e===null||$e.tag!==7?($e=vh(at,Ze.mode,Kt,wr),$e.return=Ze,$e):($e=G($e,at),$e.return=Ze,$e)}function Ut(Ze,$e,at){if(typeof $e=="string"&&$e!==""||typeof $e=="number")return $e=fS(""+$e,Ze.mode,at),$e.return=Ze,$e;if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case E:return at=Z1($e.type,$e.key,$e.props,null,Ze.mode,at),at.ref=xs(Ze,null,$e),at.return=Ze,at;case P:return $e=hS($e,Ze.mode,at),$e.return=Ze,$e;case ne:var Kt=$e._init;return Ut(Ze,Kt($e._payload),at)}if(vt($e)||M($e))return $e=vh($e,Ze.mode,at,null),$e.return=Ze,$e;vi(Ze,$e)}return null}function Lt(Ze,$e,at,Kt){var wr=$e!==null?$e.key:null;if(typeof at=="string"&&at!==""||typeof at=="number")return wr!==null?null:je(Ze,$e,""+at,Kt);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case E:return at.key===wr?Ie(Ze,$e,at,Kt):null;case P:return at.key===wr?dt(Ze,$e,at,Kt):null;case ne:return wr=at._init,Lt(Ze,$e,wr(at._payload),Kt)}if(vt(at)||M(at))return wr!==null?null:Bt(Ze,$e,at,Kt,null);vi(Ze,at)}return null}function or(Ze,$e,at,Kt,wr){if(typeof Kt=="string"&&Kt!==""||typeof Kt=="number")return Ze=Ze.get(at)||null,je($e,Ze,""+Kt,wr);if(typeof Kt=="object"&&Kt!==null){switch(Kt.$$typeof){case E:return Ze=Ze.get(Kt.key===null?at:Kt.key)||null,Ie($e,Ze,Kt,wr);case P:return Ze=Ze.get(Kt.key===null?at:Kt.key)||null,dt($e,Ze,Kt,wr);case ne:var Er=Kt._init;return or(Ze,$e,at,Er(Kt._payload),wr)}if(vt(Kt)||M(Kt))return Ze=Ze.get(at)||null,Bt($e,Ze,Kt,wr,null);vi($e,Kt)}return null}function mr(Ze,$e,at,Kt){for(var wr=null,Er=null,Nr=$e,Mr=$e=0,Oa=null;Nr!==null&&Mr<at.length;Mr++){Nr.index>Mr?(Oa=Nr,Nr=null):Oa=Nr.sibling;var xn=Lt(Ze,Nr,at[Mr],Kt);if(xn===null){Nr===null&&(Nr=Oa);break}f&&Nr&&xn.alternate===null&&m(Ze,Nr),$e=J(xn,$e,Mr),Er===null?wr=xn:Er.sibling=xn,Er=xn,Nr=Oa}if(Mr===at.length)return T(Ze,Nr),Sn&&Su(Ze,Mr),wr;if(Nr===null){for(;Mr<at.length;Mr++)Nr=Ut(Ze,at[Mr],Kt),Nr!==null&&($e=J(Nr,$e,Mr),Er===null?wr=Nr:Er.sibling=Nr,Er=Nr);return Sn&&Su(Ze,Mr),wr}for(Nr=D(Ze,Nr);Mr<at.length;Mr++)Oa=or(Nr,Ze,Mr,at[Mr],Kt),Oa!==null&&(f&&Oa.alternate!==null&&Nr.delete(Oa.key===null?Mr:Oa.key),$e=J(Oa,$e,Mr),Er===null?wr=Oa:Er.sibling=Oa,Er=Oa);return f&&Nr.forEach(function(ef){return m(Ze,ef)}),Sn&&Su(Ze,Mr),wr}function yr(Ze,$e,at,Kt){var wr=M(at);if(typeof wr!="function")throw Error(r(150));if(at=wr.call(at),at==null)throw Error(r(151));for(var Er=wr=null,Nr=$e,Mr=$e=0,Oa=null,xn=at.next();Nr!==null&&!xn.done;Mr++,xn=at.next()){Nr.index>Mr?(Oa=Nr,Nr=null):Oa=Nr.sibling;var ef=Lt(Ze,Nr,xn.value,Kt);if(ef===null){Nr===null&&(Nr=Oa);break}f&&Nr&&ef.alternate===null&&m(Ze,Nr),$e=J(ef,$e,Mr),Er===null?wr=ef:Er.sibling=ef,Er=ef,Nr=Oa}if(xn.done)return T(Ze,Nr),Sn&&Su(Ze,Mr),wr;if(Nr===null){for(;!xn.done;Mr++,xn=at.next())xn=Ut(Ze,xn.value,Kt),xn!==null&&($e=J(xn,$e,Mr),Er===null?wr=xn:Er.sibling=xn,Er=xn);return Sn&&Su(Ze,Mr),wr}for(Nr=D(Ze,Nr);!xn.done;Mr++,xn=at.next())xn=or(Nr,Ze,Mr,xn.value,Kt),xn!==null&&(f&&xn.alternate!==null&&Nr.delete(xn.key===null?Mr:xn.key),$e=J(xn,$e,Mr),Er===null?wr=xn:Er.sibling=xn,Er=xn);return f&&Nr.forEach(function(GV){return m(Ze,GV)}),Sn&&Su(Ze,Mr),wr}function Vs(Ze,$e,at,Kt){if(typeof at=="object"&&at!==null&&at.type===F&&at.key===null&&(at=at.props.children),typeof at=="object"&&at!==null){switch(at.$$typeof){case E:e:{for(var wr=at.key,Er=$e;Er!==null;){if(Er.key===wr){if(wr=at.type,wr===F){if(Er.tag===7){T(Ze,Er.sibling),$e=G(Er,at.props.children),$e.return=Ze,Ze=$e;break e}}else if(Er.elementType===wr||typeof wr=="object"&&wr!==null&&wr.$$typeof===ne&&Do(wr)===Er.type){T(Ze,Er.sibling),$e=G(Er,at.props),$e.ref=xs(Ze,Er,at),$e.return=Ze,Ze=$e;break e}T(Ze,Er);break}else m(Ze,Er);Er=Er.sibling}at.type===F?($e=vh(at.props.children,Ze.mode,Kt,at.key),$e.return=Ze,Ze=$e):(Kt=Z1(at.type,at.key,at.props,null,Ze.mode,Kt),Kt.ref=xs(Ze,$e,at),Kt.return=Ze,Ze=Kt)}return de(Ze);case P:e:{for(Er=at.key;$e!==null;){if($e.key===Er)if($e.tag===4&&$e.stateNode.containerInfo===at.containerInfo&&$e.stateNode.implementation===at.implementation){T(Ze,$e.sibling),$e=G($e,at.children||[]),$e.return=Ze,Ze=$e;break e}else{T(Ze,$e);break}else m(Ze,$e);$e=$e.sibling}$e=hS(at,Ze.mode,Kt),$e.return=Ze,Ze=$e}return de(Ze);case ne:return Er=at._init,Vs(Ze,$e,Er(at._payload),Kt)}if(vt(at))return mr(Ze,$e,at,Kt);if(M(at))return yr(Ze,$e,at,Kt);vi(Ze,at)}return typeof at=="string"&&at!==""||typeof at=="number"?(at=""+at,$e!==null&&$e.tag===6?(T(Ze,$e.sibling),$e=G($e,at),$e.return=Ze,Ze=$e):(T(Ze,$e),$e=fS(at,Ze.mode,Kt),$e.return=Ze,Ze=$e),de(Ze)):T(Ze,$e)}return Vs}var Tu=fg(!0),fo=fg(!1),ch=Wl(null),Vi=null,Dd=null,hg=null;function gg(){hg=Dd=Vi=null}function mg(f){var m=ch.current;Bn(ch),f._currentValue=m}function pg(f,m,T){for(;f!==null;){var D=f.alternate;if((f.childLanes&m)!==m?(f.childLanes|=m,D!==null&&(D.childLanes|=m)):D!==null&&(D.childLanes&m)!==m&&(D.childLanes|=m),f===T)break;f=f.return}}function Gl(f,m){Vi=f,hg=Dd=null,f=f.dependencies,f!==null&&f.firstContext!==null&&((f.lanes&m)!==0&&(te=!0),f.firstContext=null)}function Qa(f){var m=f._currentValue;if(hg!==f)if(f={context:f,memoizedValue:m,next:null},Dd===null){if(Vi===null)throw Error(r(308));Dd=f,Vi.dependencies={lanes:0,firstContext:f}}else Dd=Dd.next=f;return m}var nl=null;function Id(f){nl===null?nl=[f]:nl.push(f)}function uh(f,m,T,D){var G=m.interleaved;return G===null?(T.next=T,Id(m)):(T.next=G.next,G.next=T),m.interleaved=T,Ki(f,D)}function Ki(f,m){f.lanes|=m;var T=f.alternate;for(T!==null&&(T.lanes|=m),T=f,f=f.return;f!==null;)f.childLanes|=m,T=f.alternate,T!==null&&(T.childLanes|=m),T=f,f=f.return;return T.tag===3?T.stateNode:null}var sl=!1;function dh(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xg(f,m){f=f.updateQueue,m.updateQueue===f&&(m.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function al(f,m){return{eventTime:f,lane:m,tag:0,payload:null,callback:null,next:null}}function il(f,m,T){var D=f.updateQueue;if(D===null)return null;if(D=D.shared,(gn&2)!==0){var G=D.pending;return G===null?m.next=m:(m.next=G.next,G.next=m),D.pending=m,Ki(f,T)}return G=D.interleaved,G===null?(m.next=m,Id(D)):(m.next=G.next,G.next=m),D.interleaved=m,Ki(f,T)}function yg(f,m,T){if(m=m.updateQueue,m!==null&&(m=m.shared,(T&4194240)!==0)){var D=m.lanes;D&=f.pendingLanes,T|=D,m.lanes=T,Gf(f,T)}}function fh(f,m){var T=f.updateQueue,D=f.alternate;if(D!==null&&(D=D.updateQueue,T===D)){var G=null,J=null;if(T=T.firstBaseUpdate,T!==null){do{var de={eventTime:T.eventTime,lane:T.lane,tag:T.tag,payload:T.payload,callback:T.callback,next:null};J===null?G=J=de:J=J.next=de,T=T.next}while(T!==null);J===null?G=J=m:J=J.next=m}else G=J=m;T={baseState:D.baseState,firstBaseUpdate:G,lastBaseUpdate:J,shared:D.shared,effects:D.effects},f.updateQueue=T;return}f=T.lastBaseUpdate,f===null?T.firstBaseUpdate=m:f.next=m,T.lastBaseUpdate=m}function Rd(f,m,T,D){var G=f.updateQueue;sl=!1;var J=G.firstBaseUpdate,de=G.lastBaseUpdate,je=G.shared.pending;if(je!==null){G.shared.pending=null;var Ie=je,dt=Ie.next;Ie.next=null,de===null?J=dt:de.next=dt,de=Ie;var Bt=f.alternate;Bt!==null&&(Bt=Bt.updateQueue,je=Bt.lastBaseUpdate,je!==de&&(je===null?Bt.firstBaseUpdate=dt:je.next=dt,Bt.lastBaseUpdate=Ie))}if(J!==null){var Ut=G.baseState;de=0,Bt=dt=Ie=null,je=J;do{var Lt=je.lane,or=je.eventTime;if((D&Lt)===Lt){Bt!==null&&(Bt=Bt.next={eventTime:or,lane:0,tag:je.tag,payload:je.payload,callback:je.callback,next:null});e:{var mr=f,yr=je;switch(Lt=m,or=T,yr.tag){case 1:if(mr=yr.payload,typeof mr=="function"){Ut=mr.call(or,Ut,Lt);break e}Ut=mr;break e;case 3:mr.flags=mr.flags&-65537|128;case 0:if(mr=yr.payload,Lt=typeof mr=="function"?mr.call(or,Ut,Lt):mr,Lt==null)break e;Ut=V({},Ut,Lt);break e;case 2:sl=!0}}je.callback!==null&&je.lane!==0&&(f.flags|=64,Lt=G.effects,Lt===null?G.effects=[je]:Lt.push(je))}else or={eventTime:or,lane:Lt,tag:je.tag,payload:je.payload,callback:je.callback,next:null},Bt===null?(dt=Bt=or,Ie=Ut):Bt=Bt.next=or,de|=Lt;if(je=je.next,je===null){if(je=G.shared.pending,je===null)break;Lt=je,je=Lt.next,Lt.next=null,G.lastBaseUpdate=Lt,G.shared.pending=null}}while(!0);if(Bt===null&&(Ie=Ut),G.baseState=Ie,G.firstBaseUpdate=dt,G.lastBaseUpdate=Bt,m=G.shared.interleaved,m!==null){G=m;do de|=G.lane,G=G.next;while(G!==m)}else J===null&&(G.shared.lanes=0);mh|=de,f.lanes=de,f.memoizedState=Ut}}function ds(f,m,T){if(f=m.effects,m.effects=null,f!==null)for(m=0;m<f.length;m++){var D=f[m],G=D.callback;if(G!==null){if(D.callback=null,D=T,typeof G!="function")throw Error(r(191,G));G.call(D)}}}var Gr={},jn=Wl(Gr),Jn=Wl(Gr),ys=Wl(Gr);function Ws(f){if(f===Gr)throw Error(r(174));return f}function jc(f,m){switch(An(ys,m),An(Jn,f),An(jn,Gr),f=m.nodeType,f){case 9:case 11:m=(m=m.documentElement)?m.namespaceURI:De(null,"");break;default:f=f===8?m.parentNode:m,m=f.namespaceURI||null,f=f.tagName,m=De(m,f)}Bn(jn),An(jn,m)}function Zn(){Bn(jn),Bn(Jn),Bn(ys)}function Md(f){Ws(ys.current);var m=Ws(jn.current),T=De(m,f.type);m!==T&&(An(Jn,f),An(jn,T))}function Vl(f){Jn.current===f&&(Bn(jn),Bn(Jn))}var $n=Wl(0);function Ld(f){for(var m=f;m!==null;){if(m.tag===13){var T=m.memoizedState;if(T!==null&&(T=T.dehydrated,T===null||T.data==="$?"||T.data==="$!"))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===f)break;for(;m.sibling===null;){if(m.return===null||m.return===f)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var Eu=[];function Na(){for(var f=0;f<Eu.length;f++)Eu[f]._workInProgressVersionPrimary=null;Eu.length=0}var Bd=N.ReactCurrentDispatcher,hh=N.ReactCurrentBatchConfig,Ja=0,Tn=null,fs=null,Cs=null,Io=!1,Pc=!1,ho=0,vg=0;function Ts(){throw Error(r(321))}function gh(f,m){if(m===null)return!1;for(var T=0;T<m.length&&T<f.length;T++)if(!yi(f[T],m[T]))return!1;return!0}function $d(f,m,T,D,G,J){if(Ja=J,Tn=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,Bd.current=f===null||f.memoizedState===null?K2:Dc,f=T(D,G),Pc){J=0;do{if(Pc=!1,ho=0,25<=J)throw Error(r(301));J+=1,Cs=fs=null,m.updateQueue=null,Bd.current=kg,f=T(D,G)}while(Pc)}if(Bd.current=Hd,m=fs!==null&&fs.next!==null,Ja=0,Cs=fs=Tn=null,Io=!1,m)throw Error(r(300));return f}function Ud(){var f=ho!==0;return ho=0,f}function Hn(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cs===null?Tn.memoizedState=Cs=f:Cs=Cs.next=f,Cs}function Hs(){if(fs===null){var f=Tn.alternate;f=f!==null?f.memoizedState:null}else f=fs.next;var m=Cs===null?Tn.memoizedState:Cs.next;if(m!==null)Cs=m,fs=f;else{if(f===null)throw Error(r(310));fs=f,f={memoizedState:fs.memoizedState,baseState:fs.baseState,baseQueue:fs.baseQueue,queue:fs.queue,next:null},Cs===null?Tn.memoizedState=Cs=f:Cs=Cs.next=f}return Cs}function Aa(f,m){return typeof m=="function"?m(f):m}function ja(f){var m=Hs(),T=m.queue;if(T===null)throw Error(r(311));T.lastRenderedReducer=f;var D=fs,G=D.baseQueue,J=T.pending;if(J!==null){if(G!==null){var de=G.next;G.next=J.next,J.next=de}D.baseQueue=G=J,T.pending=null}if(G!==null){J=G.next,D=D.baseState;var je=de=null,Ie=null,dt=J;do{var Bt=dt.lane;if((Ja&Bt)===Bt)Ie!==null&&(Ie=Ie.next={lane:0,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null}),D=dt.hasEagerState?dt.eagerState:f(D,dt.action);else{var Ut={lane:Bt,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null};Ie===null?(je=Ie=Ut,de=D):Ie=Ie.next=Ut,Tn.lanes|=Bt,mh|=Bt}dt=dt.next}while(dt!==null&&dt!==J);Ie===null?de=D:Ie.next=je,yi(D,m.memoizedState)||(te=!0),m.memoizedState=D,m.baseState=de,m.baseQueue=Ie,T.lastRenderedState=D}if(f=T.interleaved,f!==null){G=f;do J=G.lane,Tn.lanes|=J,mh|=J,G=G.next;while(G!==f)}else G===null&&(T.lanes=0);return[m.memoizedState,T.dispatch]}function wg(f){var m=Hs(),T=m.queue;if(T===null)throw Error(r(311));T.lastRenderedReducer=f;var D=T.dispatch,G=T.pending,J=m.memoizedState;if(G!==null){T.pending=null;var de=G=G.next;do J=f(J,de.action),de=de.next;while(de!==G);yi(J,m.memoizedState)||(te=!0),m.memoizedState=J,m.baseQueue===null&&(m.baseState=J),T.lastRenderedState=J}return[J,D]}function bg(){}function _g(f,m){var T=Tn,D=Hs(),G=m(),J=!yi(D.memoizedState,G);if(J&&(D.memoizedState=G,te=!0),D=D.queue,Wp($p.bind(null,T,D,f),[f]),D.getSnapshot!==m||J||Cs!==null&&Cs.memoizedState.tag&1){if(T.flags|=2048,zd(9,Kl.bind(null,T,D,G,m),void 0,null),Fa===null)throw Error(r(349));(Ja&30)!==0||O1(T,m,G)}return G}function O1(f,m,T){f.flags|=16384,f={getSnapshot:m,value:T},m=Tn.updateQueue,m===null?(m={lastEffect:null,stores:null},Tn.updateQueue=m,m.stores=[f]):(T=m.stores,T===null?m.stores=[f]:T.push(f))}function Kl(f,m,T,D){m.value=T,m.getSnapshot=D,Up(m)&&Sg(f)}function $p(f,m,T){return T(function(){Up(m)&&Sg(f)})}function Up(f){var m=f.getSnapshot;f=f.value;try{var T=m();return!yi(f,T)}catch{return!0}}function Sg(f){var m=Ki(f,1);m!==null&&Ql(m,f,1,-1)}function Fc(f){var m=Hn();return typeof f=="function"&&(f=f()),m.memoizedState=m.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:f},m.queue=f,f=f.dispatch=B1.bind(null,Tn,f),[m.memoizedState,f]}function zd(f,m,T,D){return f={tag:f,create:m,destroy:T,deps:D,next:null},m=Tn.updateQueue,m===null?(m={lastEffect:null,stores:null},Tn.updateQueue=m,m.lastEffect=f.next=f):(T=m.lastEffect,T===null?m.lastEffect=f.next=f:(D=T.next,T.next=f,f.next=D,m.lastEffect=f)),f}function zp(){return Hs().memoizedState}function Wd(f,m,T,D){var G=Hn();Tn.flags|=f,G.memoizedState=zd(1|m,T,void 0,D===void 0?null:D)}function Nu(f,m,T,D){var G=Hs();D=D===void 0?null:D;var J=void 0;if(fs!==null){var de=fs.memoizedState;if(J=de.destroy,D!==null&&gh(D,de.deps)){G.memoizedState=zd(m,T,J,D);return}}Tn.flags|=f,G.memoizedState=zd(1|m,T,J,D)}function D1(f,m){return Wd(8390656,8,f,m)}function Wp(f,m){return Nu(2048,8,f,m)}function Hp(f,m){return Nu(4,2,f,m)}function Gp(f,m){return Nu(4,4,f,m)}function Oc(f,m){if(typeof m=="function")return f=f(),m(f),function(){m(null)};if(m!=null)return f=f(),m.current=f,function(){m.current=null}}function I1(f,m,T){return T=T!=null?T.concat([f]):null,Nu(4,4,Oc.bind(null,m,f),T)}function ql(){}function Vp(f,m){var T=Hs();m=m===void 0?null:m;var D=T.memoizedState;return D!==null&&m!==null&&gh(m,D[1])?D[0]:(T.memoizedState=[f,m],f)}function Gn(f,m){var T=Hs();m=m===void 0?null:m;var D=T.memoizedState;return D!==null&&m!==null&&gh(m,D[1])?D[0]:(f=f(),T.memoizedState=[f,m],f)}function R1(f,m,T){return(Ja&21)===0?(f.baseState&&(f.baseState=!1,te=!0),f.memoizedState=T):(yi(T,m)||(T=es(),Tn.lanes|=T,mh|=T,f.baseState=!0),m)}function M1(f,m){var T=cn;cn=T!==0&&4>T?T:4,f(!0);var D=hh.transition;hh.transition={};try{f(!1),m()}finally{cn=T,hh.transition=D}}function L1(){return Hs().memoizedState}function V2(f,m,T){var D=Qd(f);if(T={lane:D,action:T,hasEagerState:!1,eagerState:null,next:null},Kp(f))$1(m,T);else if(T=uh(f,m,T,D),T!==null){var G=Yi();Ql(T,f,D,G),qi(T,m,D)}}function B1(f,m,T){var D=Qd(f),G={lane:D,action:T,hasEagerState:!1,eagerState:null,next:null};if(Kp(f))$1(m,G);else{var J=f.alternate;if(f.lanes===0&&(J===null||J.lanes===0)&&(J=m.lastRenderedReducer,J!==null))try{var de=m.lastRenderedState,je=J(de,T);if(G.hasEagerState=!0,G.eagerState=je,yi(je,de)){var Ie=m.interleaved;Ie===null?(G.next=G,Id(m)):(G.next=Ie.next,Ie.next=G),m.interleaved=G;return}}catch{}finally{}T=uh(f,m,G,D),T!==null&&(G=Yi(),Ql(T,f,D,G),qi(T,m,D))}}function Kp(f){var m=f.alternate;return f===Tn||m!==null&&m===Tn}function $1(f,m){Pc=Io=!0;var T=f.pending;T===null?m.next=m:(m.next=T.next,T.next=m),f.pending=m}function qi(f,m,T){if((T&4194240)!==0){var D=m.lanes;D&=f.pendingLanes,T|=D,m.lanes=T,Gf(f,T)}}var Hd={readContext:Qa,useCallback:Ts,useContext:Ts,useEffect:Ts,useImperativeHandle:Ts,useInsertionEffect:Ts,useLayoutEffect:Ts,useMemo:Ts,useReducer:Ts,useRef:Ts,useState:Ts,useDebugValue:Ts,useDeferredValue:Ts,useTransition:Ts,useMutableSource:Ts,useSyncExternalStore:Ts,useId:Ts,unstable_isNewReconciler:!1},K2={readContext:Qa,useCallback:function(f,m){return Hn().memoizedState=[f,m===void 0?null:m],f},useContext:Qa,useEffect:D1,useImperativeHandle:function(f,m,T){return T=T!=null?T.concat([f]):null,Wd(4194308,4,Oc.bind(null,m,f),T)},useLayoutEffect:function(f,m){return Wd(4194308,4,f,m)},useInsertionEffect:function(f,m){return Wd(4,2,f,m)},useMemo:function(f,m){var T=Hn();return m=m===void 0?null:m,f=f(),T.memoizedState=[f,m],f},useReducer:function(f,m,T){var D=Hn();return m=T!==void 0?T(m):m,D.memoizedState=D.baseState=m,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:m},D.queue=f,f=f.dispatch=V2.bind(null,Tn,f),[D.memoizedState,f]},useRef:function(f){var m=Hn();return f={current:f},m.memoizedState=f},useState:Fc,useDebugValue:ql,useDeferredValue:function(f){return Hn().memoizedState=f},useTransition:function(){var f=Fc(!1),m=f[0];return f=M1.bind(null,f[1]),Hn().memoizedState=f,[m,f]},useMutableSource:function(){},useSyncExternalStore:function(f,m,T){var D=Tn,G=Hn();if(Sn){if(T===void 0)throw Error(r(407));T=T()}else{if(T=m(),Fa===null)throw Error(r(349));(Ja&30)!==0||O1(D,m,T)}G.memoizedState=T;var J={value:T,getSnapshot:m};return G.queue=J,D1($p.bind(null,D,J,f),[f]),D.flags|=2048,zd(9,Kl.bind(null,D,J,T,m),void 0,null),T},useId:function(){var f=Hn(),m=Fa.identifierPrefix;if(Sn){var T=Qn,D=Wi;T=(D&~(1<<32-fe(D)-1)).toString(32)+T,m=":"+m+"R"+T,T=ho++,0<T&&(m+="H"+T.toString(32)),m+=":"}else T=vg++,m=":"+m+"r"+T.toString(32)+":";return f.memoizedState=m},unstable_isNewReconciler:!1},Dc={readContext:Qa,useCallback:Vp,useContext:Qa,useEffect:Wp,useImperativeHandle:I1,useInsertionEffect:Hp,useLayoutEffect:Gp,useMemo:Gn,useReducer:ja,useRef:zp,useState:function(){return ja(Aa)},useDebugValue:ql,useDeferredValue:function(f){var m=Hs();return R1(m,fs.memoizedState,f)},useTransition:function(){var f=ja(Aa)[0],m=Hs().memoizedState;return[f,m]},useMutableSource:bg,useSyncExternalStore:_g,useId:L1,unstable_isNewReconciler:!1},kg={readContext:Qa,useCallback:Vp,useContext:Qa,useEffect:Wp,useImperativeHandle:I1,useInsertionEffect:Hp,useLayoutEffect:Gp,useMemo:Gn,useReducer:wg,useRef:zp,useState:function(){return wg(Aa)},useDebugValue:ql,useDeferredValue:function(f){var m=Hs();return fs===null?m.memoizedState=f:R1(m,fs.memoizedState,f)},useTransition:function(){var f=wg(Aa)[0],m=Hs().memoizedState;return[f,m]},useMutableSource:bg,useSyncExternalStore:_g,useId:L1,unstable_isNewReconciler:!1};function pa(f,m){if(f&&f.defaultProps){m=V({},m),f=f.defaultProps;for(var T in f)m[T]===void 0&&(m[T]=f[T]);return m}return m}function Gd(f,m,T,D){m=f.memoizedState,T=T(D,m),T=T==null?m:V({},m,T),f.memoizedState=T,f.lanes===0&&(f.updateQueue.baseState=T)}var Vd={isMounted:function(f){return(f=f._reactInternals)?_e(f)===f:!1},enqueueSetState:function(f,m,T){f=f._reactInternals;var D=Yi(),G=Qd(f),J=al(D,G);J.payload=m,T!=null&&(J.callback=T),m=il(f,J,G),m!==null&&(Ql(m,f,G,D),yg(m,f,G))},enqueueReplaceState:function(f,m,T){f=f._reactInternals;var D=Yi(),G=Qd(f),J=al(D,G);J.tag=1,J.payload=m,T!=null&&(J.callback=T),m=il(f,J,G),m!==null&&(Ql(m,f,G,D),yg(m,f,G))},enqueueForceUpdate:function(f,m){f=f._reactInternals;var T=Yi(),D=Qd(f),G=al(T,D);G.tag=2,m!=null&&(G.callback=m),m=il(f,G,D),m!==null&&(Ql(m,f,D,T),yg(m,f,D))}};function Cg(f,m,T,D,G,J,de){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(D,J,de):m.prototype&&m.prototype.isPureReactComponent?!du(T,D)||!du(G,J):!0}function U1(f,m,T){var D=!1,G=tl,J=m.contextType;return typeof J=="object"&&J!==null?J=Qa(J):(G=Ea(m)?Cc:ma.current,D=m.contextTypes,J=(D=D!=null)?wu(f,G):tl),m=new m(T,J),f.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Vd,f.stateNode=m,m._reactInternals=f,D&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=G,f.__reactInternalMemoizedMaskedChildContext=J),m}function qp(f,m,T,D){f=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(T,D),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(T,D),m.state!==f&&Vd.enqueueReplaceState(m,m.state,null)}function Tg(f,m,T,D){var G=f.stateNode;G.props=T,G.state=f.memoizedState,G.refs={},dh(f);var J=m.contextType;typeof J=="object"&&J!==null?G.context=Qa(J):(J=Ea(m)?Cc:ma.current,G.context=wu(f,J)),G.state=f.memoizedState,J=m.getDerivedStateFromProps,typeof J=="function"&&(Gd(f,m,J,T),G.state=f.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof G.getSnapshotBeforeUpdate=="function"||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(m=G.state,typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount(),m!==G.state&&Vd.enqueueReplaceState(G,G.state,null),Rd(f,T,G,D),G.state=f.memoizedState),typeof G.componentDidMount=="function"&&(f.flags|=4194308)}function Au(f,m){try{var T="",D=m;do T+=Q(D),D=D.return;while(D);var G=T}catch(J){G=`
Error generating stack: `+J.message+`
`+J.stack}return{value:f,source:m,stack:G,digest:null}}function Eg(f,m,T){return{value:f,source:null,stack:T??null,digest:m??null}}function Kd(f,m){try{console.error(m.value)}catch(T){setTimeout(function(){throw T})}}var q2=typeof WeakMap=="function"?WeakMap:Map;function z1(f,m,T){T=al(-1,T),T.tag=3,T.payload={element:null};var D=m.value;return T.callback=function(){K1||(K1=!0,sS=D),Kd(f,m)},T}function y(f,m,T){T=al(-1,T),T.tag=3;var D=f.type.getDerivedStateFromError;if(typeof D=="function"){var G=m.value;T.payload=function(){return D(G)},T.callback=function(){Kd(f,m)}}var J=f.stateNode;return J!==null&&typeof J.componentDidCatch=="function"&&(T.callback=function(){Kd(f,m),typeof D!="function"&&(Yd===null?Yd=new Set([this]):Yd.add(this));var de=m.stack;this.componentDidCatch(m.value,{componentStack:de!==null?de:""})}),T}function _(f,m,T){var D=f.pingCache;if(D===null){D=f.pingCache=new q2;var G=new Set;D.set(m,G)}else G=D.get(m),G===void 0&&(G=new Set,D.set(m,G));G.has(T)||(G.add(T),f=DV.bind(null,f,m,T),m.then(f,f))}function O(f){do{var m;if((m=f.tag===13)&&(m=f.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return f;f=f.return}while(f!==null);return null}function z(f,m,T,D,G){return(f.mode&1)===0?(f===m?f.flags|=65536:(f.flags|=128,T.flags|=131072,T.flags&=-52805,T.tag===1&&(T.alternate===null?T.tag=17:(m=al(-1,1),m.tag=2,il(T,m,1))),T.lanes|=1),f):(f.flags|=65536,f.lanes=G,f)}var K=N.ReactCurrentOwner,te=!1;function ve(f,m,T,D){m.child=f===null?fo(m,null,T,D):Tu(m,f.child,T,D)}function ze(f,m,T,D,G){T=T.render;var J=m.ref;return Gl(m,G),D=$d(f,m,T,D,J,G),T=Ud(),f!==null&&!te?(m.updateQueue=f.updateQueue,m.flags&=-2053,f.lanes&=~G,Pa(f,m,G)):(Sn&&T&&Fd(m),m.flags|=1,ve(f,m,D,G),m.child)}function ft(f,m,T,D,G){if(f===null){var J=T.type;return typeof J=="function"&&!dS(J)&&J.defaultProps===void 0&&T.compare===null&&T.defaultProps===void 0?(m.tag=15,m.type=J,Ht(f,m,J,D,G)):(f=Z1(T.type,null,D,m,m.mode,G),f.ref=m.ref,f.return=m,m.child=f)}if(J=f.child,(f.lanes&G)===0){var de=J.memoizedProps;if(T=T.compare,T=T!==null?T:du,T(de,D)&&f.ref===m.ref)return Pa(f,m,G)}return m.flags|=1,f=Zd(J,D),f.ref=m.ref,f.return=m,m.child=f}function Ht(f,m,T,D,G){if(f!==null){var J=f.memoizedProps;if(du(J,D)&&f.ref===m.ref)if(te=!1,m.pendingProps=D=J,(f.lanes&G)!==0)(f.flags&131072)!==0&&(te=!0);else return m.lanes=f.lanes,Pa(f,m,G)}return nr(f,m,T,D,G)}function dr(f,m,T){var D=m.pendingProps,G=D.children,J=f!==null?f.memoizedState:null;if(D.mode==="hidden")if((m.mode&1)===0)m.memoizedState={baseLanes:0,cachePool:null,transitions:null},An(Ag,Ro),Ro|=T;else{if((T&1073741824)===0)return f=J!==null?J.baseLanes|T:T,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:f,cachePool:null,transitions:null},m.updateQueue=null,An(Ag,Ro),Ro|=f,null;m.memoizedState={baseLanes:0,cachePool:null,transitions:null},D=J!==null?J.baseLanes:T,An(Ag,Ro),Ro|=D}else J!==null?(D=J.baseLanes|T,m.memoizedState=null):D=T,An(Ag,Ro),Ro|=D;return ve(f,m,G,T),m.child}function Br(f,m){var T=m.ref;(f===null&&T!==null||f!==null&&f.ref!==T)&&(m.flags|=512,m.flags|=2097152)}function nr(f,m,T,D,G){var J=Ea(T)?Cc:ma.current;return J=wu(m,J),Gl(m,G),T=$d(f,m,T,D,J,G),D=Ud(),f!==null&&!te?(m.updateQueue=f.updateQueue,m.flags&=-2053,f.lanes&=~G,Pa(f,m,G)):(Sn&&D&&Fd(m),m.flags|=1,ve(f,m,T,G),m.child)}function Un(f,m,T,D,G){if(Ea(T)){var J=!0;bu(m)}else J=!1;if(Gl(m,G),m.stateNode===null)on(f,m),U1(m,T,D),Tg(m,T,D,G),D=!0;else if(f===null){var de=m.stateNode,je=m.memoizedProps;de.props=je;var Ie=de.context,dt=T.contextType;typeof dt=="object"&&dt!==null?dt=Qa(dt):(dt=Ea(T)?Cc:ma.current,dt=wu(m,dt));var Bt=T.getDerivedStateFromProps,Ut=typeof Bt=="function"||typeof de.getSnapshotBeforeUpdate=="function";Ut||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(je!==D||Ie!==dt)&&qp(m,de,D,dt),sl=!1;var Lt=m.memoizedState;de.state=Lt,Rd(m,D,de,G),Ie=m.memoizedState,je!==D||Lt!==Ie||Ta.current||sl?(typeof Bt=="function"&&(Gd(m,T,Bt,D),Ie=m.memoizedState),(je=sl||Cg(m,T,je,D,Lt,Ie,dt))?(Ut||typeof de.UNSAFE_componentWillMount!="function"&&typeof de.componentWillMount!="function"||(typeof de.componentWillMount=="function"&&de.componentWillMount(),typeof de.UNSAFE_componentWillMount=="function"&&de.UNSAFE_componentWillMount()),typeof de.componentDidMount=="function"&&(m.flags|=4194308)):(typeof de.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=D,m.memoizedState=Ie),de.props=D,de.state=Ie,de.context=dt,D=je):(typeof de.componentDidMount=="function"&&(m.flags|=4194308),D=!1)}else{de=m.stateNode,xg(f,m),je=m.memoizedProps,dt=m.type===m.elementType?je:pa(m.type,je),de.props=dt,Ut=m.pendingProps,Lt=de.context,Ie=T.contextType,typeof Ie=="object"&&Ie!==null?Ie=Qa(Ie):(Ie=Ea(T)?Cc:ma.current,Ie=wu(m,Ie));var or=T.getDerivedStateFromProps;(Bt=typeof or=="function"||typeof de.getSnapshotBeforeUpdate=="function")||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(je!==Ut||Lt!==Ie)&&qp(m,de,D,Ie),sl=!1,Lt=m.memoizedState,de.state=Lt,Rd(m,D,de,G);var mr=m.memoizedState;je!==Ut||Lt!==mr||Ta.current||sl?(typeof or=="function"&&(Gd(m,T,or,D),mr=m.memoizedState),(dt=sl||Cg(m,T,dt,D,Lt,mr,Ie)||!1)?(Bt||typeof de.UNSAFE_componentWillUpdate!="function"&&typeof de.componentWillUpdate!="function"||(typeof de.componentWillUpdate=="function"&&de.componentWillUpdate(D,mr,Ie),typeof de.UNSAFE_componentWillUpdate=="function"&&de.UNSAFE_componentWillUpdate(D,mr,Ie)),typeof de.componentDidUpdate=="function"&&(m.flags|=4),typeof de.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof de.componentDidUpdate!="function"||je===f.memoizedProps&&Lt===f.memoizedState||(m.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||je===f.memoizedProps&&Lt===f.memoizedState||(m.flags|=1024),m.memoizedProps=D,m.memoizedState=mr),de.props=D,de.state=mr,de.context=Ie,D=dt):(typeof de.componentDidUpdate!="function"||je===f.memoizedProps&&Lt===f.memoizedState||(m.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||je===f.memoizedProps&&Lt===f.memoizedState||(m.flags|=1024),D=!1)}return kn(f,m,T,D,J,G)}function kn(f,m,T,D,G,J){Br(f,m);var de=(m.flags&128)!==0;if(!D&&!de)return G&&j1(m,T,!1),Pa(f,m,J);D=m.stateNode,K.current=m;var je=de&&typeof T.getDerivedStateFromError!="function"?null:D.render();return m.flags|=1,f!==null&&de?(m.child=Tu(m,f.child,null,J),m.child=Tu(m,null,je,J)):ve(f,m,je,J),m.memoizedState=D.state,G&&j1(m,T,!0),m.child}function Za(f){var m=f.stateNode;m.pendingContext?Rp(f,m.pendingContext,m.pendingContext!==m.context):m.context&&Rp(f,m.context,!1),jc(f,m.containerInfo)}function ol(f,m,T,D,G){return Cu(),lh(G),m.flags|=256,ve(f,m,T,D),m.child}var ct={dehydrated:null,treeContext:null,retryLane:0};function Ve(f){return{baseLanes:f,cachePool:null,transitions:null}}function yt(f,m,T){var D=m.pendingProps,G=$n.current,J=!1,de=(m.flags&128)!==0,je;if((je=de)||(je=f!==null&&f.memoizedState===null?!1:(G&2)!==0),je?(J=!0,m.flags&=-129):(f===null||f.memoizedState!==null)&&(G|=1),An($n,G&1),f===null)return Od(m),f=m.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?((m.mode&1)===0?m.lanes=1:f.data==="$!"?m.lanes=8:m.lanes=1073741824,null):(de=D.children,f=D.fallback,J?(D=m.mode,J=m.child,de={mode:"hidden",children:de},(D&1)===0&&J!==null?(J.childLanes=0,J.pendingProps=de):J=ew(de,D,0,null),f=vh(f,D,T,null),J.return=m,f.return=m,J.sibling=f,m.child=J,m.child.memoizedState=Ve(T),m.memoizedState=ct,f):sr(m,de));if(G=f.memoizedState,G!==null&&(je=G.dehydrated,je!==null))return Yr(f,m,de,D,je,G,T);if(J){J=D.fallback,de=m.mode,G=f.child,je=G.sibling;var Ie={mode:"hidden",children:D.children};return(de&1)===0&&m.child!==G?(D=m.child,D.childLanes=0,D.pendingProps=Ie,m.deletions=null):(D=Zd(G,Ie),D.subtreeFlags=G.subtreeFlags&14680064),je!==null?J=Zd(je,J):(J=vh(J,de,T,null),J.flags|=2),J.return=m,D.return=m,D.sibling=J,m.child=D,D=J,J=m.child,de=f.child.memoizedState,de=de===null?Ve(T):{baseLanes:de.baseLanes|T,cachePool:null,transitions:de.transitions},J.memoizedState=de,J.childLanes=f.childLanes&~T,m.memoizedState=ct,D}return J=f.child,f=J.sibling,D=Zd(J,{mode:"visible",children:D.children}),(m.mode&1)===0&&(D.lanes=T),D.return=m,D.sibling=null,f!==null&&(T=m.deletions,T===null?(m.deletions=[f],m.flags|=16):T.push(f)),m.child=D,m.memoizedState=null,D}function sr(f,m){return m=ew({mode:"visible",children:m},f.mode,0,null),m.return=f,f.child=m}function Cr(f,m,T,D){return D!==null&&lh(D),Tu(m,f.child,null,T),f=sr(m,m.pendingProps.children),f.flags|=2,m.memoizedState=null,f}function Yr(f,m,T,D,G,J,de){if(T)return m.flags&256?(m.flags&=-257,D=Eg(Error(r(422))),Cr(f,m,de,D)):m.memoizedState!==null?(m.child=f.child,m.flags|=128,null):(J=D.fallback,G=m.mode,D=ew({mode:"visible",children:D.children},G,0,null),J=vh(J,G,de,null),J.flags|=2,D.return=m,J.return=m,D.sibling=J,m.child=D,(m.mode&1)!==0&&Tu(m,f.child,null,de),m.child.memoizedState=Ve(de),m.memoizedState=ct,J);if((m.mode&1)===0)return Cr(f,m,de,null);if(G.data==="$!"){if(D=G.nextSibling&&G.nextSibling.dataset,D)var je=D.dgst;return D=je,J=Error(r(419)),D=Eg(J,D,void 0),Cr(f,m,de,D)}if(je=(de&f.childLanes)!==0,te||je){if(D=Fa,D!==null){switch(de&-de){case 4:G=2;break;case 16:G=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:G=32;break;case 536870912:G=268435456;break;default:G=0}G=(G&(D.suspendedLanes|de))!==0?0:G,G!==0&&G!==J.retryLane&&(J.retryLane=G,Ki(f,G),Ql(D,f,G,-1))}return uS(),D=Eg(Error(r(421))),Cr(f,m,de,D)}return G.data==="$?"?(m.flags|=128,m.child=f.child,m=IV.bind(null,f),G._reactRetry=m,null):(f=J.treeContext,tr=Zo(G.nextSibling),Hi=m,Sn=!0,Gi=null,f!==null&&(Ya[Xa++]=Wi,Ya[Xa++]=Qn,Ya[Xa++]=Ac,Wi=f.id,Qn=f.overflow,Ac=m),m=sr(m,D.children),m.flags|=4096,m)}function $r(f,m,T){f.lanes|=m;var D=f.alternate;D!==null&&(D.lanes|=m),pg(f.return,m,T)}function un(f,m,T,D,G){var J=f.memoizedState;J===null?f.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:D,tail:T,tailMode:G}:(J.isBackwards=m,J.rendering=null,J.renderingStartTime=0,J.last=D,J.tail=T,J.tailMode=G)}function Gs(f,m,T){var D=m.pendingProps,G=D.revealOrder,J=D.tail;if(ve(f,m,D.children,T),D=$n.current,(D&2)!==0)D=D&1|2,m.flags|=128;else{if(f!==null&&(f.flags&128)!==0)e:for(f=m.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&$r(f,T,m);else if(f.tag===19)$r(f,T,m);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===m)break e;for(;f.sibling===null;){if(f.return===null||f.return===m)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}D&=1}if(An($n,D),(m.mode&1)===0)m.memoizedState=null;else switch(G){case"forwards":for(T=m.child,G=null;T!==null;)f=T.alternate,f!==null&&Ld(f)===null&&(G=T),T=T.sibling;T=G,T===null?(G=m.child,m.child=null):(G=T.sibling,T.sibling=null),un(m,!1,G,T,J);break;case"backwards":for(T=null,G=m.child,m.child=null;G!==null;){if(f=G.alternate,f!==null&&Ld(f)===null){m.child=G;break}f=G.sibling,G.sibling=T,T=G,G=f}un(m,!0,T,null,J);break;case"together":un(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function on(f,m){(m.mode&1)===0&&f!==null&&(f.alternate=null,m.alternate=null,m.flags|=2)}function Pa(f,m,T){if(f!==null&&(m.dependencies=f.dependencies),mh|=m.lanes,(T&m.childLanes)===0)return null;if(f!==null&&m.child!==f.child)throw Error(r(153));if(m.child!==null){for(f=m.child,T=Zd(f,f.pendingProps),m.child=T,T.return=m;f.sibling!==null;)f=f.sibling,T=T.sibling=Zd(f,f.pendingProps),T.return=m;T.sibling=null}return m.child}function Y2(f,m,T){switch(m.tag){case 3:Za(m),Cu();break;case 5:Md(m);break;case 1:Ea(m.type)&&bu(m);break;case 4:jc(m,m.stateNode.containerInfo);break;case 10:var D=m.type._context,G=m.memoizedProps.value;An(ch,D._currentValue),D._currentValue=G;break;case 13:if(D=m.memoizedState,D!==null)return D.dehydrated!==null?(An($n,$n.current&1),m.flags|=128,null):(T&m.child.childLanes)!==0?yt(f,m,T):(An($n,$n.current&1),f=Pa(f,m,T),f!==null?f.sibling:null);An($n,$n.current&1);break;case 19:if(D=(T&m.childLanes)!==0,(f.flags&128)!==0){if(D)return Gs(f,m,T);m.flags|=128}if(G=m.memoizedState,G!==null&&(G.rendering=null,G.tail=null,G.lastEffect=null),An($n,$n.current),D)break;return null;case 22:case 23:return m.lanes=0,dr(f,m,T)}return Pa(f,m,T)}var ij,X2,oj,lj;ij=function(f,m){for(var T=m.child;T!==null;){if(T.tag===5||T.tag===6)f.appendChild(T.stateNode);else if(T.tag!==4&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===m)break;for(;T.sibling===null;){if(T.return===null||T.return===m)return;T=T.return}T.sibling.return=T.return,T=T.sibling}},X2=function(){},oj=function(f,m,T,D){var G=f.memoizedProps;if(G!==D){f=m.stateNode,Ws(jn.current);var J=null;switch(T){case"input":G=Ee(f,G),D=Ee(f,D),J=[];break;case"select":G=V({},G,{value:void 0}),D=V({},D,{value:void 0}),J=[];break;case"textarea":G=it(f,G),D=it(f,D),J=[];break;default:typeof G.onClick!="function"&&typeof D.onClick=="function"&&(f.onclick=xu)}Rr(T,D);var de;T=null;for(dt in G)if(!D.hasOwnProperty(dt)&&G.hasOwnProperty(dt)&&G[dt]!=null)if(dt==="style"){var je=G[dt];for(de in je)je.hasOwnProperty(de)&&(T||(T={}),T[de]="")}else dt!=="dangerouslySetInnerHTML"&&dt!=="children"&&dt!=="suppressContentEditableWarning"&&dt!=="suppressHydrationWarning"&&dt!=="autoFocus"&&(s.hasOwnProperty(dt)?J||(J=[]):(J=J||[]).push(dt,null));for(dt in D){var Ie=D[dt];if(je=G?.[dt],D.hasOwnProperty(dt)&&Ie!==je&&(Ie!=null||je!=null))if(dt==="style")if(je){for(de in je)!je.hasOwnProperty(de)||Ie&&Ie.hasOwnProperty(de)||(T||(T={}),T[de]="");for(de in Ie)Ie.hasOwnProperty(de)&&je[de]!==Ie[de]&&(T||(T={}),T[de]=Ie[de])}else T||(J||(J=[]),J.push(dt,T)),T=Ie;else dt==="dangerouslySetInnerHTML"?(Ie=Ie?Ie.__html:void 0,je=je?je.__html:void 0,Ie!=null&&je!==Ie&&(J=J||[]).push(dt,Ie)):dt==="children"?typeof Ie!="string"&&typeof Ie!="number"||(J=J||[]).push(dt,""+Ie):dt!=="suppressContentEditableWarning"&&dt!=="suppressHydrationWarning"&&(s.hasOwnProperty(dt)?(Ie!=null&&dt==="onScroll"&&Ln("scroll",f),J||je===Ie||(J=[])):(J=J||[]).push(dt,Ie))}T&&(J=J||[]).push("style",T);var dt=J;(m.updateQueue=dt)&&(m.flags|=4)}},lj=function(f,m,T,D){T!==D&&(m.flags|=4)};function Yp(f,m){if(!Sn)switch(f.tailMode){case"hidden":m=f.tail;for(var T=null;m!==null;)m.alternate!==null&&(T=m),m=m.sibling;T===null?f.tail=null:T.sibling=null;break;case"collapsed":T=f.tail;for(var D=null;T!==null;)T.alternate!==null&&(D=T),T=T.sibling;D===null?m||f.tail===null?f.tail=null:f.tail.sibling=null:D.sibling=null}}function wi(f){var m=f.alternate!==null&&f.alternate.child===f.child,T=0,D=0;if(m)for(var G=f.child;G!==null;)T|=G.lanes|G.childLanes,D|=G.subtreeFlags&14680064,D|=G.flags&14680064,G.return=f,G=G.sibling;else for(G=f.child;G!==null;)T|=G.lanes|G.childLanes,D|=G.subtreeFlags,D|=G.flags,G.return=f,G=G.sibling;return f.subtreeFlags|=D,f.childLanes=T,m}function kV(f,m,T){var D=m.pendingProps;switch(ta(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wi(m),null;case 1:return Ea(m.type)&&jd(),wi(m),null;case 3:return D=m.stateNode,Zn(),Bn(Ta),Bn(ma),Na(),D.pendingContext&&(D.context=D.pendingContext,D.pendingContext=null),(f===null||f.child===null)&&(oh(m)?m.flags|=4:f===null||f.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,Gi!==null&&(oS(Gi),Gi=null))),X2(f,m),wi(m),null;case 5:Vl(m);var G=Ws(ys.current);if(T=m.type,f!==null&&m.stateNode!=null)oj(f,m,T,D,G),f.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!D){if(m.stateNode===null)throw Error(r(166));return wi(m),null}if(f=Ws(jn.current),oh(m)){D=m.stateNode,T=m.type;var J=m.memoizedProps;switch(D[uo]=m,D[sh]=J,f=(m.mode&1)!==0,T){case"dialog":Ln("cancel",D),Ln("close",D);break;case"iframe":case"object":case"embed":Ln("load",D);break;case"video":case"audio":for(G=0;G<_c.length;G++)Ln(_c[G],D);break;case"source":Ln("error",D);break;case"img":case"image":case"link":Ln("error",D),Ln("load",D);break;case"details":Ln("toggle",D);break;case"input":Ae(D,J),Ln("invalid",D);break;case"select":D._wrapperState={wasMultiple:!!J.multiple},Ln("invalid",D);break;case"textarea":ht(D,J),Ln("invalid",D)}Rr(T,J),G=null;for(var de in J)if(J.hasOwnProperty(de)){var je=J[de];de==="children"?typeof je=="string"?D.textContent!==je&&(J.suppressHydrationWarning!==!0&&rh(D.textContent,je,f),G=["children",je]):typeof je=="number"&&D.textContent!==""+je&&(J.suppressHydrationWarning!==!0&&rh(D.textContent,je,f),G=["children",""+je]):s.hasOwnProperty(de)&&je!=null&&de==="onScroll"&&Ln("scroll",D)}switch(T){case"input":Se(D),Rt(D,J,!0);break;case"textarea":Se(D),Mt(D);break;case"select":case"option":break;default:typeof J.onClick=="function"&&(D.onclick=xu)}D=G,m.updateQueue=D,D!==null&&(m.flags|=4)}else{de=G.nodeType===9?G:G.ownerDocument,f==="http://www.w3.org/1999/xhtml"&&(f=Xe(T)),f==="http://www.w3.org/1999/xhtml"?T==="script"?(f=de.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild)):typeof D.is=="string"?f=de.createElement(T,{is:D.is}):(f=de.createElement(T),T==="select"&&(de=f,D.multiple?de.multiple=!0:D.size&&(de.size=D.size))):f=de.createElementNS(f,T),f[uo]=m,f[sh]=D,ij(f,m,!1,!1),m.stateNode=f;e:{switch(de=Kr(T,D),T){case"dialog":Ln("cancel",f),Ln("close",f),G=D;break;case"iframe":case"object":case"embed":Ln("load",f),G=D;break;case"video":case"audio":for(G=0;G<_c.length;G++)Ln(_c[G],f);G=D;break;case"source":Ln("error",f),G=D;break;case"img":case"image":case"link":Ln("error",f),Ln("load",f),G=D;break;case"details":Ln("toggle",f),G=D;break;case"input":Ae(f,D),G=Ee(f,D),Ln("invalid",f);break;case"option":G=D;break;case"select":f._wrapperState={wasMultiple:!!D.multiple},G=V({},D,{value:void 0}),Ln("invalid",f);break;case"textarea":ht(f,D),G=it(f,D),Ln("invalid",f);break;default:G=D}Rr(T,G),je=G;for(J in je)if(je.hasOwnProperty(J)){var Ie=je[J];J==="style"?qt(f,Ie):J==="dangerouslySetInnerHTML"?(Ie=Ie?Ie.__html:void 0,Ie!=null&&lt(f,Ie)):J==="children"?typeof Ie=="string"?(T!=="textarea"||Ie!=="")&&Ue(f,Ie):typeof Ie=="number"&&Ue(f,""+Ie):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(s.hasOwnProperty(J)?Ie!=null&&J==="onScroll"&&Ln("scroll",f):Ie!=null&&b(f,J,Ie,de))}switch(T){case"input":Se(f),Rt(f,D,!1);break;case"textarea":Se(f),Mt(f);break;case"option":D.value!=null&&f.setAttribute("value",""+ie(D.value));break;case"select":f.multiple=!!D.multiple,J=D.value,J!=null?xt(f,!!D.multiple,J,!1):D.defaultValue!=null&&xt(f,!!D.multiple,D.defaultValue,!0);break;default:typeof G.onClick=="function"&&(f.onclick=xu)}switch(T){case"button":case"input":case"select":case"textarea":D=!!D.autoFocus;break e;case"img":D=!0;break e;default:D=!1}}D&&(m.flags|=4)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return wi(m),null;case 6:if(f&&m.stateNode!=null)lj(f,m,f.memoizedProps,D);else{if(typeof D!="string"&&m.stateNode===null)throw Error(r(166));if(T=Ws(ys.current),Ws(jn.current),oh(m)){if(D=m.stateNode,T=m.memoizedProps,D[uo]=m,(J=D.nodeValue!==T)&&(f=Hi,f!==null))switch(f.tag){case 3:rh(D.nodeValue,T,(f.mode&1)!==0);break;case 5:f.memoizedProps.suppressHydrationWarning!==!0&&rh(D.nodeValue,T,(f.mode&1)!==0)}J&&(m.flags|=4)}else D=(T.nodeType===9?T:T.ownerDocument).createTextNode(D),D[uo]=m,m.stateNode=D}return wi(m),null;case 13:if(Bn($n),D=m.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(Sn&&tr!==null&&(m.mode&1)!==0&&(m.flags&128)===0)Lp(),Cu(),m.flags|=98560,J=!1;else if(J=oh(m),D!==null&&D.dehydrated!==null){if(f===null){if(!J)throw Error(r(318));if(J=m.memoizedState,J=J!==null?J.dehydrated:null,!J)throw Error(r(317));J[uo]=m}else Cu(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;wi(m),J=!1}else Gi!==null&&(oS(Gi),Gi=null),J=!0;if(!J)return m.flags&65536?m:null}return(m.flags&128)!==0?(m.lanes=T,m):(D=D!==null,D!==(f!==null&&f.memoizedState!==null)&&D&&(m.child.flags|=8192,(m.mode&1)!==0&&(f===null||($n.current&1)!==0?xa===0&&(xa=3):uS())),m.updateQueue!==null&&(m.flags|=4),wi(m),null);case 4:return Zn(),X2(f,m),f===null&&mu(m.stateNode.containerInfo),wi(m),null;case 10:return mg(m.type._context),wi(m),null;case 17:return Ea(m.type)&&jd(),wi(m),null;case 19:if(Bn($n),J=m.memoizedState,J===null)return wi(m),null;if(D=(m.flags&128)!==0,de=J.rendering,de===null)if(D)Yp(J,!1);else{if(xa!==0||f!==null&&(f.flags&128)!==0)for(f=m.child;f!==null;){if(de=Ld(f),de!==null){for(m.flags|=128,Yp(J,!1),D=de.updateQueue,D!==null&&(m.updateQueue=D,m.flags|=4),m.subtreeFlags=0,D=T,T=m.child;T!==null;)J=T,f=D,J.flags&=14680066,de=J.alternate,de===null?(J.childLanes=0,J.lanes=f,J.child=null,J.subtreeFlags=0,J.memoizedProps=null,J.memoizedState=null,J.updateQueue=null,J.dependencies=null,J.stateNode=null):(J.childLanes=de.childLanes,J.lanes=de.lanes,J.child=de.child,J.subtreeFlags=0,J.deletions=null,J.memoizedProps=de.memoizedProps,J.memoizedState=de.memoizedState,J.updateQueue=de.updateQueue,J.type=de.type,f=de.dependencies,J.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),T=T.sibling;return An($n,$n.current&1|2),m.child}f=f.sibling}J.tail!==null&&mt()>jg&&(m.flags|=128,D=!0,Yp(J,!1),m.lanes=4194304)}else{if(!D)if(f=Ld(de),f!==null){if(m.flags|=128,D=!0,T=f.updateQueue,T!==null&&(m.updateQueue=T,m.flags|=4),Yp(J,!0),J.tail===null&&J.tailMode==="hidden"&&!de.alternate&&!Sn)return wi(m),null}else 2*mt()-J.renderingStartTime>jg&&T!==1073741824&&(m.flags|=128,D=!0,Yp(J,!1),m.lanes=4194304);J.isBackwards?(de.sibling=m.child,m.child=de):(T=J.last,T!==null?T.sibling=de:m.child=de,J.last=de)}return J.tail!==null?(m=J.tail,J.rendering=m,J.tail=m.sibling,J.renderingStartTime=mt(),m.sibling=null,T=$n.current,An($n,D?T&1|2:T&1),m):(wi(m),null);case 22:case 23:return cS(),D=m.memoizedState!==null,f!==null&&f.memoizedState!==null!==D&&(m.flags|=8192),D&&(m.mode&1)!==0?(Ro&1073741824)!==0&&(wi(m),m.subtreeFlags&6&&(m.flags|=8192)):wi(m),null;case 24:return null;case 25:return null}throw Error(r(156,m.tag))}function CV(f,m){switch(ta(m),m.tag){case 1:return Ea(m.type)&&jd(),f=m.flags,f&65536?(m.flags=f&-65537|128,m):null;case 3:return Zn(),Bn(Ta),Bn(ma),Na(),f=m.flags,(f&65536)!==0&&(f&128)===0?(m.flags=f&-65537|128,m):null;case 5:return Vl(m),null;case 13:if(Bn($n),f=m.memoizedState,f!==null&&f.dehydrated!==null){if(m.alternate===null)throw Error(r(340));Cu()}return f=m.flags,f&65536?(m.flags=f&-65537|128,m):null;case 19:return Bn($n),null;case 4:return Zn(),null;case 10:return mg(m.type._context),null;case 22:case 23:return cS(),null;case 24:return null;default:return null}}var W1=!1,bi=!1,TV=typeof WeakSet=="function"?WeakSet:Set,fr=null;function Ng(f,m){var T=f.ref;if(T!==null)if(typeof T=="function")try{T(null)}catch(D){Es(f,m,D)}else T.current=null}function Q2(f,m,T){try{T()}catch(D){Es(f,m,D)}}var cj=!1;function EV(f,m){if(Fp=U0,f=Us(),Td(f)){if("selectionStart"in f)var T={start:f.selectionStart,end:f.selectionEnd};else e:{T=(T=f.ownerDocument)&&T.defaultView||window;var D=T.getSelection&&T.getSelection();if(D&&D.rangeCount!==0){T=D.anchorNode;var G=D.anchorOffset,J=D.focusNode;D=D.focusOffset;try{T.nodeType,J.nodeType}catch{T=null;break e}var de=0,je=-1,Ie=-1,dt=0,Bt=0,Ut=f,Lt=null;t:for(;;){for(var or;Ut!==T||G!==0&&Ut.nodeType!==3||(je=de+G),Ut!==J||D!==0&&Ut.nodeType!==3||(Ie=de+D),Ut.nodeType===3&&(de+=Ut.nodeValue.length),(or=Ut.firstChild)!==null;)Lt=Ut,Ut=or;for(;;){if(Ut===f)break t;if(Lt===T&&++dt===G&&(je=de),Lt===J&&++Bt===D&&(Ie=de),(or=Ut.nextSibling)!==null)break;Ut=Lt,Lt=Ut.parentNode}Ut=or}T=je===-1||Ie===-1?null:{start:je,end:Ie}}else T=null}T=T||{start:0,end:0}}else T=null;for(Op={focusedElem:f,selectionRange:T},U0=!1,fr=m;fr!==null;)if(m=fr,f=m.child,(m.subtreeFlags&1028)!==0&&f!==null)f.return=m,fr=f;else for(;fr!==null;){m=fr;try{var mr=m.alternate;if((m.flags&1024)!==0)switch(m.tag){case 0:case 11:case 15:break;case 1:if(mr!==null){var yr=mr.memoizedProps,Vs=mr.memoizedState,Ze=m.stateNode,$e=Ze.getSnapshotBeforeUpdate(m.elementType===m.type?yr:pa(m.type,yr),Vs);Ze.__reactInternalSnapshotBeforeUpdate=$e}break;case 3:var at=m.stateNode.containerInfo;at.nodeType===1?at.textContent="":at.nodeType===9&&at.documentElement&&at.removeChild(at.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Kt){Es(m,m.return,Kt)}if(f=m.sibling,f!==null){f.return=m.return,fr=f;break}fr=m.return}return mr=cj,cj=!1,mr}function Xp(f,m,T){var D=m.updateQueue;if(D=D!==null?D.lastEffect:null,D!==null){var G=D=D.next;do{if((G.tag&f)===f){var J=G.destroy;G.destroy=void 0,J!==void 0&&Q2(m,T,J)}G=G.next}while(G!==D)}}function H1(f,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var T=m=m.next;do{if((T.tag&f)===f){var D=T.create;T.destroy=D()}T=T.next}while(T!==m)}}function J2(f){var m=f.ref;if(m!==null){var T=f.stateNode;switch(f.tag){case 5:f=T;break;default:f=T}typeof m=="function"?m(f):m.current=f}}function uj(f){var m=f.alternate;m!==null&&(f.alternate=null,uj(m)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(m=f.stateNode,m!==null&&(delete m[uo],delete m[sh],delete m[og],delete m[N1],delete m[A1])),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function dj(f){return f.tag===5||f.tag===3||f.tag===4}function fj(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||dj(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function Z2(f,m,T){var D=f.tag;if(D===5||D===6)f=f.stateNode,m?T.nodeType===8?T.parentNode.insertBefore(f,m):T.insertBefore(f,m):(T.nodeType===8?(m=T.parentNode,m.insertBefore(f,T)):(m=T,m.appendChild(f)),T=T._reactRootContainer,T!=null||m.onclick!==null||(m.onclick=xu));else if(D!==4&&(f=f.child,f!==null))for(Z2(f,m,T),f=f.sibling;f!==null;)Z2(f,m,T),f=f.sibling}function eS(f,m,T){var D=f.tag;if(D===5||D===6)f=f.stateNode,m?T.insertBefore(f,m):T.appendChild(f);else if(D!==4&&(f=f.child,f!==null))for(eS(f,m,T),f=f.sibling;f!==null;)eS(f,m,T),f=f.sibling}var ei=null,Yl=!1;function qd(f,m,T){for(T=T.child;T!==null;)hj(f,m,T),T=T.sibling}function hj(f,m,T){if(rn&&typeof rn.onCommitFiberUnmount=="function")try{rn.onCommitFiberUnmount(Fr,T)}catch{}switch(T.tag){case 5:bi||Ng(T,m);case 6:var D=ei,G=Yl;ei=null,qd(f,m,T),ei=D,Yl=G,ei!==null&&(Yl?(f=ei,T=T.stateNode,f.nodeType===8?f.parentNode.removeChild(T):f.removeChild(T)):ei.removeChild(T.stateNode));break;case 18:ei!==null&&(Yl?(f=ei,T=T.stateNode,f.nodeType===8?ig(f.parentNode,T):f.nodeType===1&&ig(f,T),pi(f)):ig(ei,T.stateNode));break;case 4:D=ei,G=Yl,ei=T.stateNode.containerInfo,Yl=!0,qd(f,m,T),ei=D,Yl=G;break;case 0:case 11:case 14:case 15:if(!bi&&(D=T.updateQueue,D!==null&&(D=D.lastEffect,D!==null))){G=D=D.next;do{var J=G,de=J.destroy;J=J.tag,de!==void 0&&((J&2)!==0||(J&4)!==0)&&Q2(T,m,de),G=G.next}while(G!==D)}qd(f,m,T);break;case 1:if(!bi&&(Ng(T,m),D=T.stateNode,typeof D.componentWillUnmount=="function"))try{D.props=T.memoizedProps,D.state=T.memoizedState,D.componentWillUnmount()}catch(je){Es(T,m,je)}qd(f,m,T);break;case 21:qd(f,m,T);break;case 22:T.mode&1?(bi=(D=bi)||T.memoizedState!==null,qd(f,m,T),bi=D):qd(f,m,T);break;default:qd(f,m,T)}}function gj(f){var m=f.updateQueue;if(m!==null){f.updateQueue=null;var T=f.stateNode;T===null&&(T=f.stateNode=new TV),m.forEach(function(D){var G=RV.bind(null,f,D);T.has(D)||(T.add(D),D.then(G,G))})}}function Xl(f,m){var T=m.deletions;if(T!==null)for(var D=0;D<T.length;D++){var G=T[D];try{var J=f,de=m,je=de;e:for(;je!==null;){switch(je.tag){case 5:ei=je.stateNode,Yl=!1;break e;case 3:ei=je.stateNode.containerInfo,Yl=!0;break e;case 4:ei=je.stateNode.containerInfo,Yl=!0;break e}je=je.return}if(ei===null)throw Error(r(160));hj(J,de,G),ei=null,Yl=!1;var Ie=G.alternate;Ie!==null&&(Ie.return=null),G.return=null}catch(dt){Es(G,m,dt)}}if(m.subtreeFlags&12854)for(m=m.child;m!==null;)mj(m,f),m=m.sibling}function mj(f,m){var T=f.alternate,D=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(Xl(m,f),Ic(f),D&4){try{Xp(3,f,f.return),H1(3,f)}catch(yr){Es(f,f.return,yr)}try{Xp(5,f,f.return)}catch(yr){Es(f,f.return,yr)}}break;case 1:Xl(m,f),Ic(f),D&512&&T!==null&&Ng(T,T.return);break;case 5:if(Xl(m,f),Ic(f),D&512&&T!==null&&Ng(T,T.return),f.flags&32){var G=f.stateNode;try{Ue(G,"")}catch(yr){Es(f,f.return,yr)}}if(D&4&&(G=f.stateNode,G!=null)){var J=f.memoizedProps,de=T!==null?T.memoizedProps:J,je=f.type,Ie=f.updateQueue;if(f.updateQueue=null,Ie!==null)try{je==="input"&&J.type==="radio"&&J.name!=null&&He(G,J),Kr(je,de);var dt=Kr(je,J);for(de=0;de<Ie.length;de+=2){var Bt=Ie[de],Ut=Ie[de+1];Bt==="style"?qt(G,Ut):Bt==="dangerouslySetInnerHTML"?lt(G,Ut):Bt==="children"?Ue(G,Ut):b(G,Bt,Ut,dt)}switch(je){case"input":Be(G,J);break;case"textarea":Dt(G,J);break;case"select":var Lt=G._wrapperState.wasMultiple;G._wrapperState.wasMultiple=!!J.multiple;var or=J.value;or!=null?xt(G,!!J.multiple,or,!1):Lt!==!!J.multiple&&(J.defaultValue!=null?xt(G,!!J.multiple,J.defaultValue,!0):xt(G,!!J.multiple,J.multiple?[]:"",!1))}G[sh]=J}catch(yr){Es(f,f.return,yr)}}break;case 6:if(Xl(m,f),Ic(f),D&4){if(f.stateNode===null)throw Error(r(162));G=f.stateNode,J=f.memoizedProps;try{G.nodeValue=J}catch(yr){Es(f,f.return,yr)}}break;case 3:if(Xl(m,f),Ic(f),D&4&&T!==null&&T.memoizedState.isDehydrated)try{pi(m.containerInfo)}catch(yr){Es(f,f.return,yr)}break;case 4:Xl(m,f),Ic(f);break;case 13:Xl(m,f),Ic(f),G=f.child,G.flags&8192&&(J=G.memoizedState!==null,G.stateNode.isHidden=J,!J||G.alternate!==null&&G.alternate.memoizedState!==null||(nS=mt())),D&4&&gj(f);break;case 22:if(Bt=T!==null&&T.memoizedState!==null,f.mode&1?(bi=(dt=bi)||Bt,Xl(m,f),bi=dt):Xl(m,f),Ic(f),D&8192){if(dt=f.memoizedState!==null,(f.stateNode.isHidden=dt)&&!Bt&&(f.mode&1)!==0)for(fr=f,Bt=f.child;Bt!==null;){for(Ut=fr=Bt;fr!==null;){switch(Lt=fr,or=Lt.child,Lt.tag){case 0:case 11:case 14:case 15:Xp(4,Lt,Lt.return);break;case 1:Ng(Lt,Lt.return);var mr=Lt.stateNode;if(typeof mr.componentWillUnmount=="function"){D=Lt,T=Lt.return;try{m=D,mr.props=m.memoizedProps,mr.state=m.memoizedState,mr.componentWillUnmount()}catch(yr){Es(D,T,yr)}}break;case 5:Ng(Lt,Lt.return);break;case 22:if(Lt.memoizedState!==null){yj(Ut);continue}}or!==null?(or.return=Lt,fr=or):yj(Ut)}Bt=Bt.sibling}e:for(Bt=null,Ut=f;;){if(Ut.tag===5){if(Bt===null){Bt=Ut;try{G=Ut.stateNode,dt?(J=G.style,typeof J.setProperty=="function"?J.setProperty("display","none","important"):J.display="none"):(je=Ut.stateNode,Ie=Ut.memoizedProps.style,de=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null,je.style.display=At("display",de))}catch(yr){Es(f,f.return,yr)}}}else if(Ut.tag===6){if(Bt===null)try{Ut.stateNode.nodeValue=dt?"":Ut.memoizedProps}catch(yr){Es(f,f.return,yr)}}else if((Ut.tag!==22&&Ut.tag!==23||Ut.memoizedState===null||Ut===f)&&Ut.child!==null){Ut.child.return=Ut,Ut=Ut.child;continue}if(Ut===f)break e;for(;Ut.sibling===null;){if(Ut.return===null||Ut.return===f)break e;Bt===Ut&&(Bt=null),Ut=Ut.return}Bt===Ut&&(Bt=null),Ut.sibling.return=Ut.return,Ut=Ut.sibling}}break;case 19:Xl(m,f),Ic(f),D&4&&gj(f);break;case 21:break;default:Xl(m,f),Ic(f)}}function Ic(f){var m=f.flags;if(m&2){try{e:{for(var T=f.return;T!==null;){if(dj(T)){var D=T;break e}T=T.return}throw Error(r(160))}switch(D.tag){case 5:var G=D.stateNode;D.flags&32&&(Ue(G,""),D.flags&=-33);var J=fj(f);eS(f,J,G);break;case 3:case 4:var de=D.stateNode.containerInfo,je=fj(f);Z2(f,je,de);break;default:throw Error(r(161))}}catch(Ie){Es(f,f.return,Ie)}f.flags&=-3}m&4096&&(f.flags&=-4097)}function NV(f,m,T){fr=f,pj(f)}function pj(f,m,T){for(var D=(f.mode&1)!==0;fr!==null;){var G=fr,J=G.child;if(G.tag===22&&D){var de=G.memoizedState!==null||W1;if(!de){var je=G.alternate,Ie=je!==null&&je.memoizedState!==null||bi;je=W1;var dt=bi;if(W1=de,(bi=Ie)&&!dt)for(fr=G;fr!==null;)de=fr,Ie=de.child,de.tag===22&&de.memoizedState!==null?vj(G):Ie!==null?(Ie.return=de,fr=Ie):vj(G);for(;J!==null;)fr=J,pj(J),J=J.sibling;fr=G,W1=je,bi=dt}xj(f)}else(G.subtreeFlags&8772)!==0&&J!==null?(J.return=G,fr=J):xj(f)}}function xj(f){for(;fr!==null;){var m=fr;if((m.flags&8772)!==0){var T=m.alternate;try{if((m.flags&8772)!==0)switch(m.tag){case 0:case 11:case 15:bi||H1(5,m);break;case 1:var D=m.stateNode;if(m.flags&4&&!bi)if(T===null)D.componentDidMount();else{var G=m.elementType===m.type?T.memoizedProps:pa(m.type,T.memoizedProps);D.componentDidUpdate(G,T.memoizedState,D.__reactInternalSnapshotBeforeUpdate)}var J=m.updateQueue;J!==null&&ds(m,J,D);break;case 3:var de=m.updateQueue;if(de!==null){if(T=null,m.child!==null)switch(m.child.tag){case 5:T=m.child.stateNode;break;case 1:T=m.child.stateNode}ds(m,de,T)}break;case 5:var je=m.stateNode;if(T===null&&m.flags&4){T=je;var Ie=m.memoizedProps;switch(m.type){case"button":case"input":case"select":case"textarea":Ie.autoFocus&&T.focus();break;case"img":Ie.src&&(T.src=Ie.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(m.memoizedState===null){var dt=m.alternate;if(dt!==null){var Bt=dt.memoizedState;if(Bt!==null){var Ut=Bt.dehydrated;Ut!==null&&pi(Ut)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}bi||m.flags&512&&J2(m)}catch(Lt){Es(m,m.return,Lt)}}if(m===f){fr=null;break}if(T=m.sibling,T!==null){T.return=m.return,fr=T;break}fr=m.return}}function yj(f){for(;fr!==null;){var m=fr;if(m===f){fr=null;break}var T=m.sibling;if(T!==null){T.return=m.return,fr=T;break}fr=m.return}}function vj(f){for(;fr!==null;){var m=fr;try{switch(m.tag){case 0:case 11:case 15:var T=m.return;try{H1(4,m)}catch(Ie){Es(m,T,Ie)}break;case 1:var D=m.stateNode;if(typeof D.componentDidMount=="function"){var G=m.return;try{D.componentDidMount()}catch(Ie){Es(m,G,Ie)}}var J=m.return;try{J2(m)}catch(Ie){Es(m,J,Ie)}break;case 5:var de=m.return;try{J2(m)}catch(Ie){Es(m,de,Ie)}}}catch(Ie){Es(m,m.return,Ie)}if(m===f){fr=null;break}var je=m.sibling;if(je!==null){je.return=m.return,fr=je;break}fr=m.return}}var AV=Math.ceil,G1=N.ReactCurrentDispatcher,tS=N.ReactCurrentOwner,ll=N.ReactCurrentBatchConfig,gn=0,Fa=null,ra=null,ti=0,Ro=0,Ag=Wl(0),xa=0,Qp=null,mh=0,V1=0,rS=0,Jp=null,go=null,nS=0,jg=1/0,ju=null,K1=!1,sS=null,Yd=null,q1=!1,Xd=null,Y1=0,Zp=0,aS=null,X1=-1,Q1=0;function Yi(){return(gn&6)!==0?mt():X1!==-1?X1:X1=mt()}function Qd(f){return(f.mode&1)===0?1:(gn&2)!==0&&ti!==0?ti&-ti:Bp.transition!==null?(Q1===0&&(Q1=es()),Q1):(f=cn,f!==0||(f=window.event,f=f===void 0?16:d1(f.type)),f)}function Ql(f,m,T,D){if(50<Zp)throw Zp=0,aS=null,Error(r(185));Mi(f,T,D),((gn&2)===0||f!==Fa)&&(f===Fa&&((gn&2)===0&&(V1|=T),xa===4&&Jd(f,ti)),mo(f,D),T===1&&gn===0&&(m.mode&1)===0&&(jg=mt()+500,Pd&&Tc()))}function mo(f,m){var T=f.callbackNode;Gt(f,m);var D=Me(f,f===Fa?ti:0);if(D===0)T!==null&&Ce(T),f.callbackNode=null,f.callbackPriority=0;else if(m=D&-D,f.callbackPriority!==m){if(T!=null&&Ce(T),m===1)f.tag===0?Hl(bj.bind(null,f)):ih(bj.bind(null,f)),T1(function(){(gn&6)===0&&Tc()}),T=null;else{switch(su(D)){case 1:T=pt;break;case 4:T=Yt;break;case 16:T=vr;break;case 536870912:T=gr;break;default:T=vr}T=Aj(T,wj.bind(null,f))}f.callbackPriority=m,f.callbackNode=T}}function wj(f,m){if(X1=-1,Q1=0,(gn&6)!==0)throw Error(r(327));var T=f.callbackNode;if(Pg()&&f.callbackNode!==T)return null;var D=Me(f,f===Fa?ti:0);if(D===0)return null;if((D&30)!==0||(D&f.expiredLanes)!==0||m)m=J1(f,D);else{m=D;var G=gn;gn|=2;var J=Sj();(Fa!==f||ti!==m)&&(ju=null,jg=mt()+500,xh(f,m));do try{FV();break}catch(je){_j(f,je)}while(!0);gg(),G1.current=J,gn=G,ra!==null?m=0:(Fa=null,ti=0,m=xa)}if(m!==0){if(m===2&&(G=ar(f),G!==0&&(D=G,m=iS(f,G))),m===1)throw T=Qp,xh(f,0),Jd(f,D),mo(f,mt()),T;if(m===6)Jd(f,D);else{if(G=f.current.alternate,(D&30)===0&&!jV(G)&&(m=J1(f,D),m===2&&(J=ar(f),J!==0&&(D=J,m=iS(f,J))),m===1))throw T=Qp,xh(f,0),Jd(f,D),mo(f,mt()),T;switch(f.finishedWork=G,f.finishedLanes=D,m){case 0:case 1:throw Error(r(345));case 2:yh(f,go,ju);break;case 3:if(Jd(f,D),(D&130023424)===D&&(m=nS+500-mt(),10<m)){if(Me(f,0)!==0)break;if(G=f.suspendedLanes,(G&D)!==D){Yi(),f.pingedLanes|=f.suspendedLanes&G;break}f.timeoutHandle=zi(yh.bind(null,f,go,ju),m);break}yh(f,go,ju);break;case 4:if(Jd(f,D),(D&4194240)===D)break;for(m=f.eventTimes,G=-1;0<D;){var de=31-fe(D);J=1<<de,de=m[de],de>G&&(G=de),D&=~J}if(D=G,D=mt()-D,D=(120>D?120:480>D?480:1080>D?1080:1920>D?1920:3e3>D?3e3:4320>D?4320:1960*AV(D/1960))-D,10<D){f.timeoutHandle=zi(yh.bind(null,f,go,ju),D);break}yh(f,go,ju);break;case 5:yh(f,go,ju);break;default:throw Error(r(329))}}}return mo(f,mt()),f.callbackNode===T?wj.bind(null,f):null}function iS(f,m){var T=Jp;return f.current.memoizedState.isDehydrated&&(xh(f,m).flags|=256),f=J1(f,m),f!==2&&(m=go,go=T,m!==null&&oS(m)),f}function oS(f){go===null?go=f:go.push.apply(go,f)}function jV(f){for(var m=f;;){if(m.flags&16384){var T=m.updateQueue;if(T!==null&&(T=T.stores,T!==null))for(var D=0;D<T.length;D++){var G=T[D],J=G.getSnapshot;G=G.value;try{if(!yi(J(),G))return!1}catch{return!1}}}if(T=m.child,m.subtreeFlags&16384&&T!==null)T.return=m,m=T;else{if(m===f)break;for(;m.sibling===null;){if(m.return===null||m.return===f)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function Jd(f,m){for(m&=~rS,m&=~V1,f.suspendedLanes|=m,f.pingedLanes&=~m,f=f.expirationTimes;0<m;){var T=31-fe(m),D=1<<T;f[T]=-1,m&=~D}}function bj(f){if((gn&6)!==0)throw Error(r(327));Pg();var m=Me(f,0);if((m&1)===0)return mo(f,mt()),null;var T=J1(f,m);if(f.tag!==0&&T===2){var D=ar(f);D!==0&&(m=D,T=iS(f,D))}if(T===1)throw T=Qp,xh(f,0),Jd(f,m),mo(f,mt()),T;if(T===6)throw Error(r(345));return f.finishedWork=f.current.alternate,f.finishedLanes=m,yh(f,go,ju),mo(f,mt()),null}function lS(f,m){var T=gn;gn|=1;try{return f(m)}finally{gn=T,gn===0&&(jg=mt()+500,Pd&&Tc())}}function ph(f){Xd!==null&&Xd.tag===0&&(gn&6)===0&&Pg();var m=gn;gn|=1;var T=ll.transition,D=cn;try{if(ll.transition=null,cn=1,f)return f()}finally{cn=D,ll.transition=T,gn=m,(gn&6)===0&&Tc()}}function cS(){Ro=Ag.current,Bn(Ag)}function xh(f,m){f.finishedWork=null,f.finishedLanes=0;var T=f.timeoutHandle;if(T!==-1&&(f.timeoutHandle=-1,Ip(T)),ra!==null)for(T=ra.return;T!==null;){var D=T;switch(ta(D),D.tag){case 1:D=D.type.childContextTypes,D!=null&&jd();break;case 3:Zn(),Bn(Ta),Bn(ma),Na();break;case 5:Vl(D);break;case 4:Zn();break;case 13:Bn($n);break;case 19:Bn($n);break;case 10:mg(D.type._context);break;case 22:case 23:cS()}T=T.return}if(Fa=f,ra=f=Zd(f.current,null),ti=Ro=m,xa=0,Qp=null,rS=V1=mh=0,go=Jp=null,nl!==null){for(m=0;m<nl.length;m++)if(T=nl[m],D=T.interleaved,D!==null){T.interleaved=null;var G=D.next,J=T.pending;if(J!==null){var de=J.next;J.next=G,D.next=de}T.pending=D}nl=null}return f}function _j(f,m){do{var T=ra;try{if(gg(),Bd.current=Hd,Io){for(var D=Tn.memoizedState;D!==null;){var G=D.queue;G!==null&&(G.pending=null),D=D.next}Io=!1}if(Ja=0,Cs=fs=Tn=null,Pc=!1,ho=0,tS.current=null,T===null||T.return===null){xa=1,Qp=m,ra=null;break}e:{var J=f,de=T.return,je=T,Ie=m;if(m=ti,je.flags|=32768,Ie!==null&&typeof Ie=="object"&&typeof Ie.then=="function"){var dt=Ie,Bt=je,Ut=Bt.tag;if((Bt.mode&1)===0&&(Ut===0||Ut===11||Ut===15)){var Lt=Bt.alternate;Lt?(Bt.updateQueue=Lt.updateQueue,Bt.memoizedState=Lt.memoizedState,Bt.lanes=Lt.lanes):(Bt.updateQueue=null,Bt.memoizedState=null)}var or=O(de);if(or!==null){or.flags&=-257,z(or,de,je,J,m),or.mode&1&&_(J,dt,m),m=or,Ie=dt;var mr=m.updateQueue;if(mr===null){var yr=new Set;yr.add(Ie),m.updateQueue=yr}else mr.add(Ie);break e}else{if((m&1)===0){_(J,dt,m),uS();break e}Ie=Error(r(426))}}else if(Sn&&je.mode&1){var Vs=O(de);if(Vs!==null){(Vs.flags&65536)===0&&(Vs.flags|=256),z(Vs,de,je,J,m),lh(Au(Ie,je));break e}}J=Ie=Au(Ie,je),xa!==4&&(xa=2),Jp===null?Jp=[J]:Jp.push(J),J=de;do{switch(J.tag){case 3:J.flags|=65536,m&=-m,J.lanes|=m;var Ze=z1(J,Ie,m);fh(J,Ze);break e;case 1:je=Ie;var $e=J.type,at=J.stateNode;if((J.flags&128)===0&&(typeof $e.getDerivedStateFromError=="function"||at!==null&&typeof at.componentDidCatch=="function"&&(Yd===null||!Yd.has(at)))){J.flags|=65536,m&=-m,J.lanes|=m;var Kt=y(J,je,m);fh(J,Kt);break e}}J=J.return}while(J!==null)}Cj(T)}catch(wr){m=wr,ra===T&&T!==null&&(ra=T=T.return);continue}break}while(!0)}function Sj(){var f=G1.current;return G1.current=Hd,f===null?Hd:f}function uS(){(xa===0||xa===3||xa===2)&&(xa=4),Fa===null||(mh&268435455)===0&&(V1&268435455)===0||Jd(Fa,ti)}function J1(f,m){var T=gn;gn|=2;var D=Sj();(Fa!==f||ti!==m)&&(ju=null,xh(f,m));do try{PV();break}catch(G){_j(f,G)}while(!0);if(gg(),gn=T,G1.current=D,ra!==null)throw Error(r(261));return Fa=null,ti=0,xa}function PV(){for(;ra!==null;)kj(ra)}function FV(){for(;ra!==null&&!Ke();)kj(ra)}function kj(f){var m=Nj(f.alternate,f,Ro);f.memoizedProps=f.pendingProps,m===null?Cj(f):ra=m,tS.current=null}function Cj(f){var m=f;do{var T=m.alternate;if(f=m.return,(m.flags&32768)===0){if(T=kV(T,m,Ro),T!==null){ra=T;return}}else{if(T=CV(T,m),T!==null){T.flags&=32767,ra=T;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{xa=6,ra=null;return}}if(m=m.sibling,m!==null){ra=m;return}ra=m=f}while(m!==null);xa===0&&(xa=5)}function yh(f,m,T){var D=cn,G=ll.transition;try{ll.transition=null,cn=1,OV(f,m,T,D)}finally{ll.transition=G,cn=D}return null}function OV(f,m,T,D){do Pg();while(Xd!==null);if((gn&6)!==0)throw Error(r(327));T=f.finishedWork;var G=f.finishedLanes;if(T===null)return null;if(f.finishedWork=null,f.finishedLanes=0,T===f.current)throw Error(r(177));f.callbackNode=null,f.callbackPriority=0;var J=T.lanes|T.childLanes;if(B0(f,J),f===Fa&&(ra=Fa=null,ti=0),(T.subtreeFlags&2064)===0&&(T.flags&2064)===0||q1||(q1=!0,Aj(vr,function(){return Pg(),null})),J=(T.flags&15990)!==0,(T.subtreeFlags&15990)!==0||J){J=ll.transition,ll.transition=null;var de=cn;cn=1;var je=gn;gn|=4,tS.current=null,EV(f,T),mj(T,f),Jf(Op),U0=!!Fp,Op=Fp=null,f.current=T,NV(T),ot(),gn=je,cn=de,ll.transition=J}else f.current=T;if(q1&&(q1=!1,Xd=f,Y1=G),J=f.pendingLanes,J===0&&(Yd=null),Qr(T.stateNode),mo(f,mt()),m!==null)for(D=f.onRecoverableError,T=0;T<m.length;T++)G=m[T],D(G.value,{componentStack:G.stack,digest:G.digest});if(K1)throw K1=!1,f=sS,sS=null,f;return(Y1&1)!==0&&f.tag!==0&&Pg(),J=f.pendingLanes,(J&1)!==0?f===aS?Zp++:(Zp=0,aS=f):Zp=0,Tc(),null}function Pg(){if(Xd!==null){var f=su(Y1),m=ll.transition,T=cn;try{if(ll.transition=null,cn=16>f?16:f,Xd===null)var D=!1;else{if(f=Xd,Xd=null,Y1=0,(gn&6)!==0)throw Error(r(331));var G=gn;for(gn|=4,fr=f.current;fr!==null;){var J=fr,de=J.child;if((fr.flags&16)!==0){var je=J.deletions;if(je!==null){for(var Ie=0;Ie<je.length;Ie++){var dt=je[Ie];for(fr=dt;fr!==null;){var Bt=fr;switch(Bt.tag){case 0:case 11:case 15:Xp(8,Bt,J)}var Ut=Bt.child;if(Ut!==null)Ut.return=Bt,fr=Ut;else for(;fr!==null;){Bt=fr;var Lt=Bt.sibling,or=Bt.return;if(uj(Bt),Bt===dt){fr=null;break}if(Lt!==null){Lt.return=or,fr=Lt;break}fr=or}}}var mr=J.alternate;if(mr!==null){var yr=mr.child;if(yr!==null){mr.child=null;do{var Vs=yr.sibling;yr.sibling=null,yr=Vs}while(yr!==null)}}fr=J}}if((J.subtreeFlags&2064)!==0&&de!==null)de.return=J,fr=de;else e:for(;fr!==null;){if(J=fr,(J.flags&2048)!==0)switch(J.tag){case 0:case 11:case 15:Xp(9,J,J.return)}var Ze=J.sibling;if(Ze!==null){Ze.return=J.return,fr=Ze;break e}fr=J.return}}var $e=f.current;for(fr=$e;fr!==null;){de=fr;var at=de.child;if((de.subtreeFlags&2064)!==0&&at!==null)at.return=de,fr=at;else e:for(de=$e;fr!==null;){if(je=fr,(je.flags&2048)!==0)try{switch(je.tag){case 0:case 11:case 15:H1(9,je)}}catch(wr){Es(je,je.return,wr)}if(je===de){fr=null;break e}var Kt=je.sibling;if(Kt!==null){Kt.return=je.return,fr=Kt;break e}fr=je.return}}if(gn=G,Tc(),rn&&typeof rn.onPostCommitFiberRoot=="function")try{rn.onPostCommitFiberRoot(Fr,f)}catch{}D=!0}return D}finally{cn=T,ll.transition=m}}return!1}function Tj(f,m,T){m=Au(T,m),m=z1(f,m,1),f=il(f,m,1),m=Yi(),f!==null&&(Mi(f,1,m),mo(f,m))}function Es(f,m,T){if(f.tag===3)Tj(f,f,T);else for(;m!==null;){if(m.tag===3){Tj(m,f,T);break}else if(m.tag===1){var D=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(Yd===null||!Yd.has(D))){f=Au(T,f),f=y(m,f,1),m=il(m,f,1),f=Yi(),m!==null&&(Mi(m,1,f),mo(m,f));break}}m=m.return}}function DV(f,m,T){var D=f.pingCache;D!==null&&D.delete(m),m=Yi(),f.pingedLanes|=f.suspendedLanes&T,Fa===f&&(ti&T)===T&&(xa===4||xa===3&&(ti&130023424)===ti&&500>mt()-nS?xh(f,0):rS|=T),mo(f,m)}function Ej(f,m){m===0&&((f.mode&1)===0?m=1:(m=bn,bn<<=1,(bn&130023424)===0&&(bn=4194304)));var T=Yi();f=Ki(f,m),f!==null&&(Mi(f,m,T),mo(f,T))}function IV(f){var m=f.memoizedState,T=0;m!==null&&(T=m.retryLane),Ej(f,T)}function RV(f,m){var T=0;switch(f.tag){case 13:var D=f.stateNode,G=f.memoizedState;G!==null&&(T=G.retryLane);break;case 19:D=f.stateNode;break;default:throw Error(r(314))}D!==null&&D.delete(m),Ej(f,T)}var Nj;Nj=function(f,m,T){if(f!==null)if(f.memoizedProps!==m.pendingProps||Ta.current)te=!0;else{if((f.lanes&T)===0&&(m.flags&128)===0)return te=!1,Y2(f,m,T);te=(f.flags&131072)!==0}else te=!1,Sn&&(m.flags&1048576)!==0&&P1(m,Nc,m.index);switch(m.lanes=0,m.tag){case 2:var D=m.type;on(f,m),f=m.pendingProps;var G=wu(m,ma.current);Gl(m,T),G=$d(null,m,D,f,G,T);var J=Ud();return m.flags|=1,typeof G=="object"&&G!==null&&typeof G.render=="function"&&G.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,Ea(D)?(J=!0,bu(m)):J=!1,m.memoizedState=G.state!==null&&G.state!==void 0?G.state:null,dh(m),G.updater=Vd,m.stateNode=G,G._reactInternals=m,Tg(m,D,f,T),m=kn(null,m,D,!0,J,T)):(m.tag=0,Sn&&J&&Fd(m),ve(null,m,G,T),m=m.child),m;case 16:D=m.elementType;e:{switch(on(f,m),f=m.pendingProps,G=D._init,D=G(D._payload),m.type=D,G=m.tag=LV(D),f=pa(D,f),G){case 0:m=nr(null,m,D,f,T);break e;case 1:m=Un(null,m,D,f,T);break e;case 11:m=ze(null,m,D,f,T);break e;case 14:m=ft(null,m,D,pa(D.type,f),T);break e}throw Error(r(306,D,""))}return m;case 0:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:pa(D,G),nr(f,m,D,G,T);case 1:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:pa(D,G),Un(f,m,D,G,T);case 3:e:{if(Za(m),f===null)throw Error(r(387));D=m.pendingProps,J=m.memoizedState,G=J.element,xg(f,m),Rd(m,D,null,T);var de=m.memoizedState;if(D=de.element,J.isDehydrated)if(J={element:D,isDehydrated:!1,cache:de.cache,pendingSuspenseBoundaries:de.pendingSuspenseBoundaries,transitions:de.transitions},m.updateQueue.baseState=J,m.memoizedState=J,m.flags&256){G=Au(Error(r(423)),m),m=ol(f,m,D,T,G);break e}else if(D!==G){G=Au(Error(r(424)),m),m=ol(f,m,D,T,G);break e}else for(tr=Zo(m.stateNode.containerInfo.firstChild),Hi=m,Sn=!0,Gi=null,T=fo(m,null,D,T),m.child=T;T;)T.flags=T.flags&-3|4096,T=T.sibling;else{if(Cu(),D===G){m=Pa(f,m,T);break e}ve(f,m,D,T)}m=m.child}return m;case 5:return Md(m),f===null&&Od(m),D=m.type,G=m.pendingProps,J=f!==null?f.memoizedProps:null,de=G.children,Dp(D,G)?de=null:J!==null&&Dp(D,J)&&(m.flags|=32),Br(f,m),ve(f,m,de,T),m.child;case 6:return f===null&&Od(m),null;case 13:return yt(f,m,T);case 4:return jc(m,m.stateNode.containerInfo),D=m.pendingProps,f===null?m.child=Tu(m,null,D,T):ve(f,m,D,T),m.child;case 11:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:pa(D,G),ze(f,m,D,G,T);case 7:return ve(f,m,m.pendingProps,T),m.child;case 8:return ve(f,m,m.pendingProps.children,T),m.child;case 12:return ve(f,m,m.pendingProps.children,T),m.child;case 10:e:{if(D=m.type._context,G=m.pendingProps,J=m.memoizedProps,de=G.value,An(ch,D._currentValue),D._currentValue=de,J!==null)if(yi(J.value,de)){if(J.children===G.children&&!Ta.current){m=Pa(f,m,T);break e}}else for(J=m.child,J!==null&&(J.return=m);J!==null;){var je=J.dependencies;if(je!==null){de=J.child;for(var Ie=je.firstContext;Ie!==null;){if(Ie.context===D){if(J.tag===1){Ie=al(-1,T&-T),Ie.tag=2;var dt=J.updateQueue;if(dt!==null){dt=dt.shared;var Bt=dt.pending;Bt===null?Ie.next=Ie:(Ie.next=Bt.next,Bt.next=Ie),dt.pending=Ie}}J.lanes|=T,Ie=J.alternate,Ie!==null&&(Ie.lanes|=T),pg(J.return,T,m),je.lanes|=T;break}Ie=Ie.next}}else if(J.tag===10)de=J.type===m.type?null:J.child;else if(J.tag===18){if(de=J.return,de===null)throw Error(r(341));de.lanes|=T,je=de.alternate,je!==null&&(je.lanes|=T),pg(de,T,m),de=J.sibling}else de=J.child;if(de!==null)de.return=J;else for(de=J;de!==null;){if(de===m){de=null;break}if(J=de.sibling,J!==null){J.return=de.return,de=J;break}de=de.return}J=de}ve(f,m,G.children,T),m=m.child}return m;case 9:return G=m.type,D=m.pendingProps.children,Gl(m,T),G=Qa(G),D=D(G),m.flags|=1,ve(f,m,D,T),m.child;case 14:return D=m.type,G=pa(D,m.pendingProps),G=pa(D.type,G),ft(f,m,D,G,T);case 15:return Ht(f,m,m.type,m.pendingProps,T);case 17:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:pa(D,G),on(f,m),m.tag=1,Ea(D)?(f=!0,bu(m)):f=!1,Gl(m,T),U1(m,D,G),Tg(m,D,G,T),kn(null,m,D,!0,f,T);case 19:return Gs(f,m,T);case 22:return dr(f,m,T)}throw Error(r(156,m.tag))};function Aj(f,m){return Te(f,m)}function MV(f,m,T,D){this.tag=f,this.key=T,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cl(f,m,T,D){return new MV(f,m,T,D)}function dS(f){return f=f.prototype,!(!f||!f.isReactComponent)}function LV(f){if(typeof f=="function")return dS(f)?1:0;if(f!=null){if(f=f.$$typeof,f===Y)return 11;if(f===ee)return 14}return 2}function Zd(f,m){var T=f.alternate;return T===null?(T=cl(f.tag,m,f.key,f.mode),T.elementType=f.elementType,T.type=f.type,T.stateNode=f.stateNode,T.alternate=f,f.alternate=T):(T.pendingProps=m,T.type=f.type,T.flags=0,T.subtreeFlags=0,T.deletions=null),T.flags=f.flags&14680064,T.childLanes=f.childLanes,T.lanes=f.lanes,T.child=f.child,T.memoizedProps=f.memoizedProps,T.memoizedState=f.memoizedState,T.updateQueue=f.updateQueue,m=f.dependencies,T.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},T.sibling=f.sibling,T.index=f.index,T.ref=f.ref,T}function Z1(f,m,T,D,G,J){var de=2;if(D=f,typeof f=="function")dS(f)&&(de=1);else if(typeof f=="string")de=5;else e:switch(f){case F:return vh(T.children,G,J,m);case A:de=8,G|=8;break;case j:return f=cl(12,T,m,G|2),f.elementType=j,f.lanes=J,f;case Z:return f=cl(13,T,m,G),f.elementType=Z,f.lanes=J,f;case ae:return f=cl(19,T,m,G),f.elementType=ae,f.lanes=J,f;case L:return ew(T,G,J,m);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case I:de=10;break e;case B:de=9;break e;case Y:de=11;break e;case ee:de=14;break e;case ne:de=16,D=null;break e}throw Error(r(130,f==null?f:typeof f,""))}return m=cl(de,T,m,G),m.elementType=f,m.type=D,m.lanes=J,m}function vh(f,m,T,D){return f=cl(7,f,D,m),f.lanes=T,f}function ew(f,m,T,D){return f=cl(22,f,D,m),f.elementType=L,f.lanes=T,f.stateNode={isHidden:!1},f}function fS(f,m,T){return f=cl(6,f,null,m),f.lanes=T,f}function hS(f,m,T){return m=cl(4,f.children!==null?f.children:[],f.key,m),m.lanes=T,m.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},m}function BV(f,m,T,D,G){this.tag=m,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kn(0),this.expirationTimes=Kn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kn(0),this.identifierPrefix=D,this.onRecoverableError=G,this.mutableSourceEagerHydrationData=null}function gS(f,m,T,D,G,J,de,je,Ie){return f=new BV(f,m,T,je,Ie),m===1?(m=1,J===!0&&(m|=8)):m=0,J=cl(3,null,null,m),f.current=J,J.stateNode=f,J.memoizedState={element:D,isDehydrated:T,cache:null,transitions:null,pendingSuspenseBoundaries:null},dh(J),f}function $V(f,m,T){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:D==null?null:""+D,children:f,containerInfo:m,implementation:T}}function jj(f){if(!f)return tl;f=f._reactInternals;e:{if(_e(f)!==f||f.tag!==1)throw Error(r(170));var m=f;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(Ea(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(r(171))}if(f.tag===1){var T=f.type;if(Ea(T))return cg(f,T,m)}return m}function Pj(f,m,T,D,G,J,de,je,Ie){return f=gS(T,D,!0,f,G,J,de,je,Ie),f.context=jj(null),T=f.current,D=Yi(),G=Qd(T),J=al(D,G),J.callback=m??null,il(T,J,G),f.current.lanes=G,Mi(f,G,D),mo(f,D),f}function tw(f,m,T,D){var G=m.current,J=Yi(),de=Qd(G);return T=jj(T),m.context===null?m.context=T:m.pendingContext=T,m=al(J,de),m.payload={element:f},D=D===void 0?null:D,D!==null&&(m.callback=D),f=il(G,m,de),f!==null&&(Ql(f,G,de,J),yg(f,G,de)),de}function rw(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return f.child.stateNode;default:return f.child.stateNode}}function Fj(f,m){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var T=f.retryLane;f.retryLane=T!==0&&T<m?T:m}}function mS(f,m){Fj(f,m),(f=f.alternate)&&Fj(f,m)}function UV(){return null}var Oj=typeof reportError=="function"?reportError:function(f){console.error(f)};function pS(f){this._internalRoot=f}nw.prototype.render=pS.prototype.render=function(f){var m=this._internalRoot;if(m===null)throw Error(r(409));tw(f,m,null,null)},nw.prototype.unmount=pS.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var m=f.containerInfo;ph(function(){tw(null,f,null,null)}),m[el]=null}};function nw(f){this._internalRoot=f}nw.prototype.unstable_scheduleHydration=function(f){if(f){var m=kt();f={blockedOn:null,target:f,priority:m};for(var T=0;T<Wr.length&&m!==0&&m<Wr[T].priority;T++);Wr.splice(T,0,f),T===0&&oo(f)}};function xS(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function sw(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11&&(f.nodeType!==8||f.nodeValue!==" react-mount-point-unstable "))}function Dj(){}function zV(f,m,T,D,G){if(G){if(typeof D=="function"){var J=D;D=function(){var dt=rw(de);J.call(dt)}}var de=Pj(m,D,f,0,null,!1,!1,"",Dj);return f._reactRootContainer=de,f[el]=de.current,mu(f.nodeType===8?f.parentNode:f),ph(),de}for(;G=f.lastChild;)f.removeChild(G);if(typeof D=="function"){var je=D;D=function(){var dt=rw(Ie);je.call(dt)}}var Ie=gS(f,0,!1,null,null,!1,!1,"",Dj);return f._reactRootContainer=Ie,f[el]=Ie.current,mu(f.nodeType===8?f.parentNode:f),ph(function(){tw(m,Ie,T,D)}),Ie}function aw(f,m,T,D,G){var J=T._reactRootContainer;if(J){var de=J;if(typeof G=="function"){var je=G;G=function(){var Ie=rw(de);je.call(Ie)}}tw(m,de,f,G)}else de=zV(T,m,f,G,D);return rw(de)}rt=function(f){switch(f.tag){case 3:var m=f.stateNode;if(m.current.memoizedState.isDehydrated){var T=Zr(m.pendingLanes);T!==0&&(Gf(m,T|1),mo(m,mt()),(gn&6)===0&&(jg=mt()+500,Tc()))}break;case 13:ph(function(){var D=Ki(f,1);if(D!==null){var G=Yi();Ql(D,f,1,G)}}),mS(f,1)}},gt=function(f){if(f.tag===13){var m=Ki(f,134217728);if(m!==null){var T=Yi();Ql(m,f,134217728,T)}mS(f,134217728)}},Vt=function(f){if(f.tag===13){var m=Qd(f),T=Ki(f,m);if(T!==null){var D=Yi();Ql(T,f,m,D)}mS(f,m)}},kt=function(){return cn},br=function(f,m){var T=cn;try{return cn=f,m()}finally{cn=T}},me=function(f,m,T){switch(m){case"input":if(Be(f,T),m=T.name,T.type==="radio"&&m!=null){for(T=f;T.parentNode;)T=T.parentNode;for(T=T.querySelectorAll("input[name="+JSON.stringify(""+m)+'][type="radio"]'),m=0;m<T.length;m++){var D=T[m];if(D!==f&&D.form===f.form){var G=ea(D);if(!G)throw Error(r(90));re(D),Be(D,G)}}}break;case"textarea":Dt(f,T);break;case"select":m=T.value,m!=null&&xt(f,!!T.multiple,m,!1)}},st=lS,ke=ph;var WV={usingClientEntryPoint:!1,Events:[ah,zs,ea,Ct,Fe,lS]},ex={findFiberByHostInstance:kc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},HV={bundleType:ex.bundleType,version:ex.version,rendererPackageName:ex.rendererPackageName,rendererConfig:ex.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(f){return f=oe(f),f===null?null:f.stateNode},findFiberByHostInstance:ex.findFiberByHostInstance||UV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iw.isDisabled&&iw.supportsFiber)try{Fr=iw.inject(HV),rn=iw}catch{}}return po.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WV,po.createPortal=function(f,m){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xS(m))throw Error(r(200));return $V(f,m,null,T)},po.createRoot=function(f,m){if(!xS(f))throw Error(r(299));var T=!1,D="",G=Oj;return m!=null&&(m.unstable_strictMode===!0&&(T=!0),m.identifierPrefix!==void 0&&(D=m.identifierPrefix),m.onRecoverableError!==void 0&&(G=m.onRecoverableError)),m=gS(f,1,!1,null,null,T,!1,D,G),f[el]=m.current,mu(f.nodeType===8?f.parentNode:f),new pS(m)},po.findDOMNode=function(f){if(f==null)return null;if(f.nodeType===1)return f;var m=f._reactInternals;if(m===void 0)throw typeof f.render=="function"?Error(r(188)):(f=Object.keys(f).join(","),Error(r(268,f)));return f=oe(m),f=f===null?null:f.stateNode,f},po.flushSync=function(f){return ph(f)},po.hydrate=function(f,m,T){if(!sw(m))throw Error(r(200));return aw(null,f,m,!0,T)},po.hydrateRoot=function(f,m,T){if(!xS(f))throw Error(r(405));var D=T!=null&&T.hydratedSources||null,G=!1,J="",de=Oj;if(T!=null&&(T.unstable_strictMode===!0&&(G=!0),T.identifierPrefix!==void 0&&(J=T.identifierPrefix),T.onRecoverableError!==void 0&&(de=T.onRecoverableError)),m=Pj(m,null,f,1,T??null,G,!1,J,de),f[el]=m.current,mu(f),D)for(f=0;f<D.length;f++)T=D[f],G=T._getVersion,G=G(T._source),m.mutableSourceEagerHydrationData==null?m.mutableSourceEagerHydrationData=[T,G]:m.mutableSourceEagerHydrationData.push(T,G);return new nw(m)},po.render=function(f,m,T){if(!sw(m))throw Error(r(200));return aw(null,f,m,!1,T)},po.unmountComponentAtNode=function(f){if(!sw(f))throw Error(r(40));return f._reactRootContainer?(ph(function(){aw(null,null,f,!1,function(){f._reactRootContainer=null,f[el]=null})}),!0):!1},po.unstable_batchedUpdates=lS,po.unstable_renderSubtreeIntoContainer=function(f,m,T,D){if(!sw(T))throw Error(r(200));if(f==null||f._reactInternals===void 0)throw Error(r(38));return aw(f,m,T,!1,D)},po.version="18.3.1-next-f1338f8080-20240426",po}var zj;function xM(){if(zj)return wS.exports;zj=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),wS.exports=QV(),wS.exports}var Wj;function JV(){if(Wj)return ow;Wj=1;var e=xM();return ow.createRoot=e.createRoot,ow.hydrateRoot=e.hydrateRoot,ow}var ZV=JV();const eK=Ol(ZV);var iT=xM();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dy(){return Dy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dy.apply(this,arguments)}var uf;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(uf||(uf={}));const Hj="popstate";function tK(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return oT("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:vM(s)}return nK(t,r,null,e)}function ca(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function yM(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function rK(){return Math.random().toString(36).substr(2,8)}function Gj(e,t){return{usr:e.state,key:e.key,idx:t}}function oT(e,t,r,n){return r===void 0&&(r=null),Dy({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Im(t):t,{state:r,key:t&&t.key||n||rK()})}function vM(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Im(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function nK(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=uf.Pop,c=null,u=d();u==null&&(u=0,i.replaceState(Dy({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function h(){o=uf.Pop;let w=d(),C=w==null?null:w-u;u=w,c&&c({action:o,location:v.location,delta:C})}function g(w,C){o=uf.Push;let k=oT(v.location,w,C);u=d()+1;let b=Gj(k,u),N=v.createHref(k);try{i.pushState(b,"",N)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;s.location.assign(N)}a&&c&&c({action:o,location:v.location,delta:1})}function p(w,C){o=uf.Replace;let k=oT(v.location,w,C);u=d();let b=Gj(k,u),N=v.createHref(k);i.replaceState(b,"",N),a&&c&&c({action:o,location:v.location,delta:0})}function x(w){let C=s.location.origin!=="null"?s.location.origin:s.location.href,k=typeof w=="string"?w:vM(w);return k=k.replace(/ $/,"%20"),ca(C,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,C)}let v={get action(){return o},get location(){return e(s,i)},listen(w){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Hj,h),c=w,()=>{s.removeEventListener(Hj,h),c=null}},createHref(w){return t(s,w)},createURL:x,encodeLocation(w){let C=x(w);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:g,replace:p,go(w){return i.go(w)}};return v}var Vj;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Vj||(Vj={}));function sK(e,t,r){return r===void 0&&(r="/"),aK(e,t,r)}function aK(e,t,r,n){let s=typeof t=="string"?Im(t):t,a=_M(s.pathname||"/",r);if(a==null)return null;let i=wM(e);iK(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let u=yK(a);o=mK(i[c],u)}return o}function wM(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let c={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(ca(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Bh([n,c.relativePath]),d=r.concat(c);a.children&&a.children.length>0&&(ca(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),wM(a.children,t,d,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:hK(u,a.index),routesMeta:d})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let c of bM(a.path))s(a,i,c)}),t}function bM(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=bM(n.join("/")),o=[];return o.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&o.push(...i),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function iK(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:gK(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const oK=/^:[\w-]+$/,lK=3,cK=2,uK=1,dK=10,fK=-2,Kj=e=>e==="*";function hK(e,t){let r=e.split("/"),n=r.length;return r.some(Kj)&&(n+=fK),t&&(n+=cK),r.filter(s=>!Kj(s)).reduce((s,a)=>s+(oK.test(a)?lK:a===""?uK:dK),n)}function gK(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function mK(e,t,r){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let c=n[o],u=o===n.length-1,d=a==="/"?t:t.slice(a.length)||"/",h=pK({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),g=c.route;if(!h)return null;Object.assign(s,h.params),i.push({params:s,pathname:Bh([a,h.pathname]),pathnameBase:_K(Bh([a,h.pathnameBase])),route:g}),h.pathnameBase!=="/"&&(a=Bh([a,h.pathnameBase]))}return i}function pK(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=xK(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,d,h)=>{let{paramName:g,isOptional:p}=d;if(g==="*"){let v=o[h]||"";i=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const x=o[h];return p&&!x?u[g]=void 0:u[g]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:e}}function xK(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),yM(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function yK(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return yM(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function _M(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function vK(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Im(e):e;return{pathname:r?r.startsWith("/")?r:wK(r,t):t,search:SK(n),hash:kK(s)}}function wK(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function SS(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function bK(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function SM(e,t){let r=bK(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function kM(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=Im(e):(s=Dy({},e),ca(!s.pathname||!s.pathname.includes("?"),SS("?","pathname","search",s)),ca(!s.pathname||!s.pathname.includes("#"),SS("#","pathname","hash",s)),ca(!s.search||!s.search.includes("#"),SS("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let h=t.length-1;if(!n&&i.startsWith("..")){let g=i.split("/");for(;g[0]==="..";)g.shift(),h-=1;s.pathname=g.join("/")}o=h>=0?t[h]:"/"}let c=vK(s,o),u=i&&i!=="/"&&i.endsWith("/"),d=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Bh=e=>e.join("/").replace(/\/\/+/g,"/"),_K=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),SK=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,kK=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function CK(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const CM=["post","put","patch","delete"];new Set(CM);const TK=["get",...CM];new Set(TK);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Iy(){return Iy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Iy.apply(this,arguments)}const hN=S.createContext(null),EK=S.createContext(null),Sv=S.createContext(null),j_=S.createContext(null),Pf=S.createContext({outlet:null,matches:[],isDataRoute:!1}),TM=S.createContext(null);function kv(){return S.useContext(j_)!=null}function P_(){return kv()||ca(!1),S.useContext(j_).location}function EM(e){S.useContext(Sv).static||S.useLayoutEffect(e)}function Eo(){let{isDataRoute:e}=S.useContext(Pf);return e?$K():NK()}function NK(){kv()||ca(!1);let e=S.useContext(hN),{basename:t,future:r,navigator:n}=S.useContext(Sv),{matches:s}=S.useContext(Pf),{pathname:a}=P_(),i=JSON.stringify(SM(s,r.v7_relativeSplatPath)),o=S.useRef(!1);return EM(()=>{o.current=!0}),S.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let h=kM(u,JSON.parse(i),a,d.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Bh([t,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[t,n,i,a,e])}function F_(){let{matches:e}=S.useContext(Pf),t=e[e.length-1];return t?t.params:{}}function AK(e,t){return jK(e,t)}function jK(e,t,r,n){kv()||ca(!1);let{navigator:s}=S.useContext(Sv),{matches:a}=S.useContext(Pf),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let u=P_(),d;if(t){var h;let w=typeof t=="string"?Im(t):t;c==="/"||(h=w.pathname)!=null&&h.startsWith(c)||ca(!1),d=w}else d=u;let g=d.pathname||"/",p=g;if(c!=="/"){let w=c.replace(/^\//,"").split("/");p="/"+g.replace(/^\//,"").split("/").slice(w.length).join("/")}let x=sK(e,{pathname:p}),v=IK(x&&x.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:Bh([c,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:Bh([c,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),a,r,n);return t&&v?S.createElement(j_.Provider,{value:{location:Iy({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:uf.Pop}},v):v}function PK(){let e=BK(),t=CK(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},t),r?S.createElement("pre",{style:s},r):null,null)}const FK=S.createElement(PK,null);class OK extends S.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?S.createElement(Pf.Provider,{value:this.props.routeContext},S.createElement(TM.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function DK(e){let{routeContext:t,match:r,children:n}=e,s=S.useContext(hN);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),S.createElement(Pf.Provider,{value:t},n)}function IK(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=i.findIndex(h=>h.route.id&&o?.[h.route.id]!==void 0);d>=0||ca(!1),i=i.slice(0,Math.min(i.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<i.length;d++){let h=i[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:g,errors:p}=r,x=h.route.loader&&g[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||x){c=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,h,g)=>{let p,x=!1,v=null,w=null;r&&(p=o&&h.route.id?o[h.route.id]:void 0,v=h.route.errorElement||FK,c&&(u<0&&g===0?(UK("route-fallback"),x=!0,w=null):u===g&&(x=!0,w=h.route.hydrateFallbackElement||null)));let C=t.concat(i.slice(0,g+1)),k=()=>{let b;return p?b=v:x?b=w:h.route.Component?b=S.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=d,S.createElement(DK,{match:h,routeContext:{outlet:d,matches:C,isDataRoute:r!=null},children:b})};return r&&(h.route.ErrorBoundary||h.route.errorElement||g===0)?S.createElement(OK,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:k(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):k()},null)}var NM=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(NM||{}),AM=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(AM||{});function RK(e){let t=S.useContext(hN);return t||ca(!1),t}function MK(e){let t=S.useContext(EK);return t||ca(!1),t}function LK(e){let t=S.useContext(Pf);return t||ca(!1),t}function jM(e){let t=LK(),r=t.matches[t.matches.length-1];return r.route.id||ca(!1),r.route.id}function BK(){var e;let t=S.useContext(TM),r=MK(),n=jM();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function $K(){let{router:e}=RK(NM.UseNavigateStable),t=jM(AM.UseNavigateStable),r=S.useRef(!1);return EM(()=>{r.current=!0}),S.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Iy({fromRouteId:t},a)))},[e,t])}const qj={};function UK(e,t,r){qj[e]||(qj[e]=!0)}function zK(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath}function pm(e){let{to:t,replace:r,state:n,relative:s}=e;kv()||ca(!1);let{future:a,static:i}=S.useContext(Sv),{matches:o}=S.useContext(Pf),{pathname:c}=P_(),u=Eo(),d=kM(t,SM(o,a.v7_relativeSplatPath),c,s==="path"),h=JSON.stringify(d);return S.useEffect(()=>u(JSON.parse(h),{replace:r,state:n,relative:s}),[u,h,s,r,n]),null}function Os(e){ca(!1)}function WK(e){let{basename:t="/",children:r=null,location:n,navigationType:s=uf.Pop,navigator:a,static:i=!1,future:o}=e;kv()&&ca(!1);let c=t.replace(/^\/*/,"/"),u=S.useMemo(()=>({basename:c,navigator:a,static:i,future:Iy({v7_relativeSplatPath:!1},o)}),[c,o,a,i]);typeof n=="string"&&(n=Im(n));let{pathname:d="/",search:h="",hash:g="",state:p=null,key:x="default"}=n,v=S.useMemo(()=>{let w=_M(d,c);return w==null?null:{location:{pathname:w,search:h,hash:g,state:p,key:x},navigationType:s}},[c,d,h,g,p,x,s]);return v==null?null:S.createElement(Sv.Provider,{value:u},S.createElement(j_.Provider,{children:r,value:v}))}function gN(e){let{children:t,location:r}=e;return AK(lT(t),r)}new Promise(()=>{});function lT(e,t){t===void 0&&(t=[]);let r=[];return S.Children.forEach(e,(n,s)=>{if(!S.isValidElement(n))return;let a=[...t,s];if(n.type===S.Fragment){r.push.apply(r,lT(n.props.children,a));return}n.type!==Os&&ca(!1),!n.props.index||!n.props.children||ca(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=lT(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const HK="6";try{window.__reactRouterVersion=HK}catch{}const GK="startTransition",Yj=pM[GK];function VK(e){let{basename:t,children:r,future:n,window:s}=e,a=S.useRef();a.current==null&&(a.current=tK({window:s,v5Compat:!0}));let i=a.current,[o,c]=S.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},d=S.useCallback(h=>{u&&Yj?Yj(()=>c(h)):c(h)},[c,u]);return S.useLayoutEffect(()=>i.listen(d),[i,d]),S.useEffect(()=>zK(n),[n]),S.createElement(WK,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}var Xj;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Xj||(Xj={}));var Qj;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Qj||(Qj={}));const Is={student_subjects:1800*1e3,student_active_tests:600*1e3,student_results_table:600*1e3,teacher_subjects:900*1e3,teacher_classes:900*1e3,teacher_tests:600*1e3,teacher_results_table:600*1e3,admin_users:1200*1e3,admin_teachers:1200*1e3,admin_subjects:1800*1e3,admin_academic_years:3600*1e3,admin_tests:900*1e3,admin_results_table:null,admin_teacher_id:3600*1e3,all_tests:1200*1e3,subjects_dropdown:1800*1e3,grades_classes:3600*1e3,test_progress:120*1e3,anti_cheating:120*1e3,word_matching_test:600*1e3,speaking_test_data:3600*1e3},Rs=e=>{try{const t=localStorage.getItem(e);if(!t)return console.log(" Cache: No data found for key:",e),null;const{data:r,timestamp:n,ttl:s}=JSON.parse(t),a=Date.now()-n;return a>s?(console.log(" Cache: Data expired for key:",e,"age:",a,"ttl:",s),localStorage.removeItem(e),null):(console.log(" Cache: Data found for key:",e,"age:",a,"ttl:",s),r)}catch(t){return console.log(" Cache: Corrupted data for key:",e,t),localStorage.removeItem(e),null}},vs=(e,t,r)=>{try{console.log(" Cache: Setting data for key:",e,"ttl:",r),localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached successfully for key:",e)}catch{console.log(" Cache: Storage full, cleaning old data for key:",e),PM();try{localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached after cleanup for key:",e)}catch{console.warn("Storage full, cannot cache data")}}},PM=()=>{const e=Date.now(),t=Object.keys(localStorage);t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i,ttl:o}=JSON.parse(a);e-i>o&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const r=e-10080*60*1e3;t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i}=JSON.parse(a);i<r&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const n=Object.keys(localStorage);if(n.length>0){const s=n.map(i=>{try{const o=localStorage.getItem(i);if(o){const{timestamp:c}=JSON.parse(o);return{key:i,timestamp:c}}}catch{return{key:i,timestamp:0}}return{key:i,timestamp:0}}),a=Math.ceil(s.length*.25);s.sort((i,o)=>i.timestamp-o.timestamp).slice(0,a).forEach(({key:i})=>localStorage.removeItem(i))}},mN=e=>{Object.keys(localStorage).forEach(r=>{r.includes(e)&&localStorage.removeItem(r)})},Rm=(e,t,r)=>{const n=`test_progress_${e}_${t}_${r}`,s=`anti_cheating_${e}_${t}_${r}`;if(localStorage.removeItem(n),localStorage.removeItem(s),t==="speaking_test_data"){const a=`speaking_test_data_${e}_${r}`;localStorage.removeItem(a),console.log(`Cleared speaking test data cache for ${r}`)}console.log(`Cleared test data for ${t}_${r}`)},Vg=Object.freeze(Object.defineProperty({__proto__:null,CACHE_TTL:Is,cleanupOldData:PM,clearTestData:Rm,clearUserData:mN,getCachedData:Rs,setCachedData:vs},Symbol.toStringTag,{value:"Module"})),FM=S.createContext(),OM=({children:e})=>{const[t,r]=S.useState(null),[n,s]=S.useState(null),[a,i]=S.useState(localStorage.getItem("token")),[o,c]=S.useState(!1),[u,d]=S.useState(!0),[h,g]=S.useState(null);S.useEffect(()=>{console.log("[AUTH] Initializing application session..."),w()},[]),S.useEffect(()=>{if(o&&a){console.log("[AUTH] Setting up proactive token refresh...");let W=!1;const R=setInterval(async()=>{if(o&&a&&!W){W=!0;try{const U=a||localStorage.getItem("auth_token");if(U&&p(U))console.log("[AUTH] Token expired, attempting refresh..."),await x()||console.log("[AUTH] Proactive refresh failed, but user remains logged in");else if(U)try{const Q=JSON.parse(atob(U.split(".")[1])).exp*1e3,se=Date.now(),X=Q-se;X<300*1e3&&X>0&&(console.log(`[AUTH] Token expires in ${Math.round(X/1e3)} seconds, refreshing...`),await x()||console.log("[AUTH] Proactive refresh failed, but user remains logged in"))}catch(q){console.error("[AUTH] Error parsing token for expiration check:",q)}}catch(U){console.error("[AUTH] Error in proactive refresh:",U)}finally{W=!1}}},300*1e3);return()=>{console.log("[AUTH] Clearing proactive token refresh interval"),clearInterval(R)}}},[o,a]);const p=W=>{if(!W)return!0;try{if(typeof W!="string"||!W.includes("."))return console.warn("[AUTH] Invalid token format - not a JWT"),!0;const R=W.split(".");if(R.length!==3)return console.warn("[AUTH] Invalid token format - not 3 parts"),!0;const U=JSON.parse(atob(R[1])),q=Date.now()/1e3;return U.exp<=q}catch(R){if(console.error("[AUTH] Error decoding token:",R),console.warn("[AUTH] Token appears to be corrupted - clearing authentication"),localStorage.removeItem("auth_token"),localStorage.removeItem("accessToken"),localStorage.removeItem("refresh_token"),localStorage.removeItem("userData"),window.tokenManager)try{window.tokenManager.clearTokens()}catch(U){console.warn("[AUTH] Error clearing token manager:",U)}return!0}},x=async()=>{const W=localStorage.getItem("refresh_token");if(!W)return console.log("[AUTH] No refresh token found"),!1;try{const R=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:W})});if(R.ok){const U=await R.json();console.log("[AUTH] Token refresh successful"),localStorage.setItem("auth_token",U.accessToken),localStorage.setItem("refresh_token",U.refreshToken),localStorage.setItem("accessToken",U.accessToken);try{window.tokenManager&&(window.tokenManager.setToken(U.accessToken),U.refreshToken&&window.tokenManager.setRefreshToken(U.refreshToken))}catch{}return i(U.accessToken),!0}else return console.error("[AUTH] Token refresh failed:",R.status),!1}catch(R){return console.error("[AUTH] Token refresh error:",R),!1}},v=async(W,R={})=>{const U=a||localStorage.getItem("auth_token");if(!U)throw new Error("No authentication token found");const q={"Content-Type":"application/json",Authorization:`Bearer ${U}`,...R.headers},Q=await fetch(W,{...R,headers:q});if(Q.status===401)if(console.log("[AUTH] 401 error, attempting token refresh..."),await x()){const X=localStorage.getItem("auth_token");return q.Authorization=`Bearer ${X}`,fetch(W,{...R,headers:q})}else throw console.log("[AUTH] Token refresh failed, returning 401 response"),new Error("Authentication failed - please login again");return Q},w=async()=>{try{console.log("[AUTH] Starting session initialization..."),d(!0);const W=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token"),R=localStorage.getItem("user_data")||localStorage.getItem("userData"),U=R?JSON.parse(R).role:null;if(console.log("[AUTH] Found stored data:",{hasToken:!!W,hasUser:!!R,role:U}),W&&U&&R)try{const q=JSON.parse(R);if(p(W))if(console.log("[AUTH] Token expired, attempting refresh..."),await x()){console.log("[AUTH] Token refreshed successfully");const se=localStorage.getItem("auth_token");i(se)}else console.log("[AUTH] Token refresh failed, but continuing with existing token..."),i(W);else i(W);s(U),r(q);try{if(window.tokenManager){window.tokenManager.setToken(localStorage.getItem("auth_token"));const Q=localStorage.getItem("refresh_token");Q&&window.tokenManager.setRefreshToken(Q)}}catch{}c(!0),await b(q,U)}catch(q){console.error("[AUTH] Error parsing stored user data:",q),console.log("[AUTH] Invalid user data, but not forcing logout - continuing with empty state"),c(!1)}}catch(W){console.error("[AUTH] Session initialization error:",W),console.log("[AUTH] Initialization error, but not forcing logout - continuing with empty state"),c(!1)}finally{console.log("[AUTH] Session initialization complete"),d(!1)}},C=async W=>{try{if(d(!0),g(null),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),g("Please wait for the logout process to complete.");return}console.log("Attempting login with:",W.username);let R,U;W.username==="admin"?(R={ok:!0,json:()=>({success:!0,token:"test-token"})},U="admin"):(R=await authService.teacherLogin(W),U="teacher");const q=await R.json();await k(R,U,q)}catch(R){A(R)}finally{d(!1)}},k=async(W,R,U)=>{try{if(W.ok&&U.success&&U.token){i(U.token),s(R),r(U),c(!0),localStorage.setItem("auth_token",U.accessToken||U.token),localStorage.setItem("refresh_token",U.refreshToken),localStorage.setItem("user_data",JSON.stringify(U)),localStorage.setItem("accessToken",U.accessToken||U.token);try{const q=Date.now(),Q=10080*60*1e3,se=[];for(let X=0;X<localStorage.length;X++){const ie=localStorage.key(X);if(!(!ie||!(ie.startsWith("test_progress_")||ie.startsWith("test_timer_")||ie.startsWith("test_shuffle_order_")||ie.startsWith("student_results_table_")||ie.startsWith("anti_cheating_"))))try{const ce=localStorage.getItem(ie);if(!ce){se.push(ie);continue}let Se=null;if(ce.startsWith("{")||ce.startsWith("[")){const re=JSON.parse(ce),ge=re.timestamp||re.lastSaved||re.lastTickAt||re.createdAt||re.updatedAt||re.startedAt||re.started_at;ge&&(Se=new Date(ge).getTime())}if(!Se){const re=`${ie}__ts`,ge=localStorage.getItem(re);ge&&(Se=parseInt(ge)||null)}if(!Se)continue;q-Se>Q&&se.push(ie)}catch{}}se.forEach(X=>{try{localStorage.removeItem(X)}catch{}})}catch(q){console.warn("LocalStorage cleanup skipped:",q)}return await b(U,R),!0}else{const q=U.message||W.statusText||"Login failed";return A(new Error(q)),!1}}catch(q){return A(q),!1}},b=async(W,R)=>{try{switch(R){case"admin":console.log("Admin login successful, role:",W.role),console.log("Admin logged in:",W);break;case"teacher":console.log("Teacher login successful, role:",W.role),console.log("Teacher data:",W.teacher),await E(W),await F();break;case"student":console.log("Student login successful"),N(W);break;default:console.warn("Unknown user role:",R)}}catch(U){console.error("Post-login actions error:",U)}},N=W=>{r(W),console.log("Student info populated:",W)},E=async W=>{r(W),console.log("Teacher info populated:",W)},P=async()=>{try{console.log("Initializing teacher cabinet...")}catch(W){console.error("Error initializing teacher cabinet:",W)}},F=async()=>{try{console.log("Checking teacher subjects...")}catch(W){console.error("Error checking teacher subjects:",W)}},A=W=>{g(W.message||"Login failed"),j()},j=()=>{g(null),d(!1)},I=S.useCallback(()=>{B()},[]),B=()=>{r(null),s(null),i(null),c(!1),g(null);const W=t?.student_id||t?.teacher_id||t?.admin_id||t?.id;W&&mN(W),localStorage.removeItem("token"),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),localStorage.removeItem("auth_token"),localStorage.removeItem("user_data"),localStorage.removeItem("user_role"),localStorage.removeItem("accessToken"),localStorage.removeItem("testProgress"),localStorage.removeItem("formData"),window.tokenManager&&window.tokenManager.clearAuth(),setTimeout(()=>{Y()},100)},Y=()=>{console.log("Interface reset after session clear - redirecting to login"),window.location.replace("/login")},Z=()=>t?.id||null,ae=()=>n==="admin"?t:null,ee=()=>n==="admin",ne=()=>ee()?t?.admin_id:null,L=()=>n==="teacher"?t?.username:null,H=()=>{console.log("Auth functions available:",{handleUnifiedLogin:typeof C,logout:typeof I,getCurrentTeacherId:typeof Z,isAdmin:typeof ee,getCurrentAdmin:typeof ae,getCurrentAdminId:typeof ne,getCurrentTeacherUsername:typeof L})};S.useEffect(()=>(window.logout=I,window.getCurrentTeacherId=Z,window.getCurrentAdmin=ae,window.isAdmin=ee,window.getCurrentAdminId=ne,window.getCurrentTeacherUsername=L,window.checkFunctionAvailability=H,()=>{delete window.logout,delete window.getCurrentTeacherId,delete window.getCurrentAdmin,delete window.isAdmin,delete window.getCurrentAdminId,delete window.getCurrentTeacherUsername,delete window.checkFunctionAvailability}),[I]);const M=S.useCallback(W=>{console.log("Setting user data from external auth:",W),r(W),s(W.role),i(W.token),c(!0),d(!1),g(null),localStorage.setItem("auth_token",W.token),localStorage.setItem("user_data",JSON.stringify(W)),localStorage.setItem("accessToken",W.token)},[]),V={user:t,role:n,token:a,isAuthenticated:o,isLoading:u,error:h,login:C,setUserData:M,logout:I,resetLoginForm:j,forceCompleteLogout:B,initializeApplicationSession:w,makeAuthenticatedRequest:v,populateStudentInfo:N,populateTeacherInfo:E,initializeTeacherCabinet:P,checkTeacherSubjects:F,getCurrentTeacherId:Z,getCurrentAdmin:ae,isAdmin:ee,getCurrentAdminId:ne,getCurrentTeacherUsername:L,handleLoginResponse:k,handlePostLoginActions:b,handleLoginFailure:A,resetInterfaceAfterSessionClear:Y,checkFunctionAvailability:H};return l.jsx(FM.Provider,{value:V,children:e})},cs=()=>{const e=S.useContext(FM);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};class KK{constructor(){this.baseURL="http://localhost:8888/.netlify/functions",this.timeout=1e4,this.retryCount=3,this.retryDelay=1e3}getHeaders(){const t=localStorage.getItem("token");return{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`}}}async sendRequest(t,r){try{return await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(n){throw console.error(" Network error:",n),n}}async request(t,r={}){const n=`${this.baseURL}${t}`,s={method:"GET",headers:this.getHeaders(),timeout:this.timeout,...r};let a;for(let i=0;i<this.retryCount;i++)try{const o=new AbortController,c=setTimeout(()=>o.abort(),this.timeout),u=await fetch(n,{...s,signal:o.signal});if(clearTimeout(c),!u.ok)throw new Error(`HTTP error! status: ${u.status}`);return await u.json()}catch(o){if(a=o,o.name==="AbortError")throw new Error("Request timeout");i<this.retryCount-1&&(console.warn(`Request failed, retrying in ${this.retryDelay}ms... (attempt ${i+1}/${this.retryCount})`),await new Promise(c=>setTimeout(c,this.retryDelay*Math.pow(2,i))))}throw a}async get(t,r={}){return this.request(t,{...r,method:"GET"})}async post(t,r,n={}){return this.request(t,{...n,method:"POST",body:JSON.stringify(r)})}async put(t,r,n={}){return this.request(t,{...n,method:"PUT",body:JSON.stringify(r)})}async delete(t,r={}){return this.request(t,{...r,method:"DELETE"})}async patch(t,r,n={}){return this.request(t,{...n,method:"PATCH",body:JSON.stringify(r)})}async uploadFile(t,r,n={}){const s=new FormData;s.append("file",r);const a=`${this.baseURL}${t}`,i={method:"POST",headers:{...localStorage.getItem("token")&&{Authorization:`Bearer ${localStorage.getItem("token")}`}},body:s,...n};try{const o=await fetch(a,i);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw o}}async downloadFile(t,r,n={}){const s=`${this.baseURL}${t}`,a={method:"GET",headers:this.getHeaders(),...n};try{const i=await fetch(s,a);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const o=await i.blob(),c=window.URL.createObjectURL(o),u=document.createElement("a");u.href=c,u.download=r,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(c)}catch(i){throw i}}ensureDebugOutput(){let t=document.getElementById("debug-output");return t||(t=document.createElement("div"),t.id="debug-output",t.className="fixed top-4 right-4 w-96 max-h-96 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-50 overflow-auto",t.innerHTML='<div class="text-sm font-mono text-gray-800">Debug Output</div>',document.body.appendChild(t)),t}async testDbConnection(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/test-db-connection")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Database Connection Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,message:"Database connection successful",data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Database Connection Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,message:"Database connection failed",error:t.message}}}async testStudentLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:"51706",password:"1"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Student Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Student Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testTeacherLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"Aleksandr_Petrov",password:"465"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Teacher Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Teacher Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testAdminLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"admin",password:"admin123"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Admin Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Admin Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetTeacherSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-teacher-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Teacher Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Teacher Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetClassResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-class-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Class Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Class Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentTestResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-test-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Test Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Test Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testEndpoints(){const t=["/debug/test-student-login","/debug/test-teacher-login","/debug/test-admin-login","/debug/test-get-subjects","/debug/test-get-teacher-subjects","/debug/test-get-class-results","/debug/test-get-student-subjects","/debug/test-get-student-test-results"],r={};for(const n of t)try{const s=await this.get(n);r[n]={success:!0,data:s}}catch(s){r[n]={success:!1,error:s.message}}return r}async debugFunction(t){const r=this.ensureDebugOutput();try{let n;switch(t){case"testDbConnection":n=await this.testDbConnection();break;case"testStudentLogin":n=await this.testStudentLogin();break;case"testTeacherLogin":n=await this.testTeacherLogin();break;case"testAdminLogin":n=await this.testAdminLogin();break;case"testGetSubjects":n=await this.testGetSubjects();break;case"testGetTeacherSubjects":n=await this.testGetTeacherSubjects();break;case"testGetClassResults":n=await this.testGetClassResults();break;case"testGetStudentSubjects":n=await this.testGetStudentSubjects();break;case"testGetStudentTestResults":n=await this.testGetStudentTestResults();break;default:throw new Error(`Unknown debug function: ${t}`)}return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Debug Function: ${t}</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),n}catch(n){throw r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Debug Function Error: ${t}</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${n.message}</pre>
        `),n}}showDebugFunctions(){const t=this.ensureDebugOutput(),r=`
      <div class="text-sm font-mono text-gray-800 mb-4">Debug Functions</div>
      <div class="grid grid-cols-2 gap-2 mb-4">
        <button onclick="apiClient.testDbConnection()" class="px-3 py-2 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition-colors">
          Test DB Connection
        </button>
        <button onclick="apiClient.testStudentLogin()" class="px-3 py-2 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors">
          Test Student Login
        </button>
        <button onclick="apiClient.testTeacherLogin()" class="px-3 py-2 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600 transition-colors">
          Test Teacher Login
        </button>
        <button onclick="apiClient.testAdminLogin()" class="px-3 py-2 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors">
          Test Admin Login
        </button>
        <button onclick="apiClient.testGetSubjects()" class="px-3 py-2 bg-purple-500 text-white text-xs rounded hover:bg-purple-600 transition-colors">
          Test Get Subjects
        </button>
        <button onclick="apiClient.testGetTeacherSubjects()" class="px-3 py-2 bg-indigo-500 text-white text-xs rounded hover:bg-indigo-600 transition-colors">
          Test Get Teacher Subjects
        </button>
        <button onclick="apiClient.testGetClassResults()" class="px-3 py-2 bg-pink-500 text-white text-xs rounded hover:bg-pink-600 transition-colors">
          Test Get Class Results
        </button>
        <button onclick="apiClient.testGetStudentSubjects()" class="px-3 py-2 bg-teal-500 text-white text-xs rounded hover:bg-teal-600 transition-colors">
          Test Get Student Subjects
        </button>
        <button onclick="apiClient.testGetStudentTestResults()" class="px-3 py-2 bg-orange-500 text-white text-xs rounded hover:bg-orange-600 transition-colors">
          Test Get Student Test Results
        </button>
        <button onclick="apiClient.testEndpoints()" class="px-3 py-2 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 transition-colors">
          Test All Endpoints
        </button>
      </div>
    `;t.innerHTML=r}}const Ns=new KK,pN=S.createContext({});function xN(e){const t=S.useRef(null);return t.current===null&&(t.current=e()),t.current}const yN=typeof window<"u",DM=yN?S.useLayoutEffect:S.useEffect,O_=S.createContext(null);function vN(e,t){e.indexOf(t)===-1&&e.push(t)}function wN(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const Ju=(e,t,r)=>r>t?t:r<e?e:r;let bN=()=>{};const Zu={},IM=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function RM(e){return typeof e=="object"&&e!==null}const MM=e=>/^0[^.\s]+$/u.test(e);function _N(e){let t;return()=>(t===void 0&&(t=e()),t)}const Cl=e=>e,qK=(e,t)=>r=>t(e(r)),Cv=(...e)=>e.reduce(qK),Ry=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class SN{constructor(){this.subscriptions=[]}add(t){return vN(this.subscriptions,t),()=>wN(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let a=0;a<s;a++){const i=this.subscriptions[a];i&&i(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Vc=e=>e*1e3,Kc=e=>e/1e3;function LM(e,t){return t?e*(1e3/t):0}const BM=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,YK=1e-7,XK=12;function QK(e,t,r,n,s){let a,i,o=0;do i=t+(r-t)/2,a=BM(i,n,s)-e,a>0?r=i:t=i;while(Math.abs(a)>YK&&++o<XK);return i}function Tv(e,t,r,n){if(e===t&&r===n)return Cl;const s=a=>QK(a,0,1,e,r);return a=>a===0||a===1?a:BM(s(a),t,n)}const $M=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,UM=e=>t=>1-e(1-t),zM=Tv(.33,1.53,.69,.99),kN=UM(zM),WM=$M(kN),HM=e=>(e*=2)<1?.5*kN(e):.5*(2-Math.pow(2,-10*(e-1))),CN=e=>1-Math.sin(Math.acos(e)),GM=UM(CN),VM=$M(CN),JK=Tv(.42,0,1,1),ZK=Tv(0,0,.58,1),KM=Tv(.42,0,.58,1),eq=e=>Array.isArray(e)&&typeof e[0]!="number",qM=e=>Array.isArray(e)&&typeof e[0]=="number",tq={linear:Cl,easeIn:JK,easeInOut:KM,easeOut:ZK,circIn:CN,circInOut:VM,circOut:GM,backIn:kN,backInOut:WM,backOut:zM,anticipate:HM},rq=e=>typeof e=="string",Jj=e=>{if(qM(e)){bN(e.length===4);const[t,r,n,s]=e;return Tv(t,r,n,s)}else if(rq(e))return tq[e];return e},lw=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function nq(e,t){let r=new Set,n=new Set,s=!1,a=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function c(d){i.has(d)&&(u.schedule(d),e()),d(o)}const u={schedule:(d,h=!1,g=!1)=>{const x=g&&s?r:n;return h&&i.add(d),x.has(d)||x.add(d),d},cancel:d=>{n.delete(d),i.delete(d)},process:d=>{if(o=d,s){a=!0;return}s=!0,[r,n]=[n,r],r.forEach(c),r.clear(),s=!1,a&&(a=!1,u.process(d))}};return u}const sq=40;function YM(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=lw.reduce((b,N)=>(b[N]=nq(a),b),{}),{setup:o,read:c,resolveKeyframes:u,preUpdate:d,update:h,preRender:g,render:p,postRender:x}=i,v=()=>{const b=Zu.useManualTiming?s.timestamp:performance.now();r=!1,Zu.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(b-s.timestamp,sq),1)),s.timestamp=b,s.isProcessing=!0,o.process(s),c.process(s),u.process(s),d.process(s),h.process(s),g.process(s),p.process(s),x.process(s),s.isProcessing=!1,r&&t&&(n=!1,e(v))},w=()=>{r=!0,n=!0,s.isProcessing||e(v)};return{schedule:lw.reduce((b,N)=>{const E=i[N];return b[N]=(P,F=!1,A=!1)=>(r||w(),E.schedule(P,F,A)),b},{}),cancel:b=>{for(let N=0;N<lw.length;N++)i[lw[N]].cancel(b)},state:s,steps:i}}const{schedule:gs,cancel:_f,state:si,steps:kS}=YM(typeof requestAnimationFrame<"u"?requestAnimationFrame:Cl,!0);let Xw;function aq(){Xw=void 0}const bo={now:()=>(Xw===void 0&&bo.set(si.isProcessing||Zu.useManualTiming?si.timestamp:performance.now()),Xw),set:e=>{Xw=e,queueMicrotask(aq)}},XM=e=>t=>typeof t=="string"&&t.startsWith(e),TN=XM("--"),iq=XM("var(--"),EN=e=>iq(e)?oq.test(e.split("/*")[0].trim()):!1,oq=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Mm={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},My={...Mm,transform:e=>Ju(0,1,e)},cw={...Mm,default:1},gy=e=>Math.round(e*1e5)/1e5,NN=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function lq(e){return e==null}const cq=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,AN=(e,t)=>r=>!!(typeof r=="string"&&cq.test(r)&&r.startsWith(e)||t&&!lq(r)&&Object.prototype.hasOwnProperty.call(r,t)),QM=(e,t,r)=>n=>{if(typeof n!="string")return n;const[s,a,i,o]=n.match(NN);return{[e]:parseFloat(s),[t]:parseFloat(a),[r]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},uq=e=>Ju(0,255,e),CS={...Mm,transform:e=>Math.round(uq(e))},Ph={test:AN("rgb","red"),parse:QM("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+CS.transform(e)+", "+CS.transform(t)+", "+CS.transform(r)+", "+gy(My.transform(n))+")"};function dq(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const cT={test:AN("#"),parse:dq,transform:Ph.transform},Ev=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),sf=Ev("deg"),qc=Ev("%"),Dr=Ev("px"),fq=Ev("vh"),hq=Ev("vw"),Zj={...qc,parse:e=>qc.parse(e)/100,transform:e=>qc.transform(e*100)},Kg={test:AN("hsl","hue"),parse:QM("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+qc.transform(gy(t))+", "+qc.transform(gy(r))+", "+gy(My.transform(n))+")"},ia={test:e=>Ph.test(e)||cT.test(e)||Kg.test(e),parse:e=>Ph.test(e)?Ph.parse(e):Kg.test(e)?Kg.parse(e):cT.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Ph.transform(e):Kg.transform(e),getAnimatableNone:e=>{const t=ia.parse(e);return t.alpha=0,ia.transform(t)}},gq=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function mq(e){return isNaN(e)&&typeof e=="string"&&(e.match(NN)?.length||0)+(e.match(gq)?.length||0)>0}const JM="number",ZM="color",pq="var",xq="var(",e5="${}",yq=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ly(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},s=[];let a=0;const o=t.replace(yq,c=>(ia.test(c)?(n.color.push(a),s.push(ZM),r.push(ia.parse(c))):c.startsWith(xq)?(n.var.push(a),s.push(pq),r.push(c)):(n.number.push(a),s.push(JM),r.push(parseFloat(c))),++a,e5)).split(e5);return{values:r,split:o,indexes:n,types:s}}function e7(e){return Ly(e).values}function t7(e){const{split:t,types:r}=Ly(e),n=t.length;return s=>{let a="";for(let i=0;i<n;i++)if(a+=t[i],s[i]!==void 0){const o=r[i];o===JM?a+=gy(s[i]):o===ZM?a+=ia.transform(s[i]):a+=s[i]}return a}}const vq=e=>typeof e=="number"?0:ia.test(e)?ia.getAnimatableNone(e):e;function wq(e){const t=e7(e);return t7(e)(t.map(vq))}const Sf={test:mq,parse:e7,createTransformer:t7,getAnimatableNone:wq};function TS(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function bq({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,a=0,i=0;if(!t)s=a=i=r;else{const o=r<.5?r*(1+t):r+t-r*t,c=2*r-o;s=TS(c,o,e+1/3),a=TS(c,o,e),i=TS(c,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:n}}function ub(e,t){return r=>r>0?t:e}const ws=(e,t,r)=>e+(t-e)*r,ES=(e,t,r)=>{const n=e*e,s=r*(t*t-n)+n;return s<0?0:Math.sqrt(s)},_q=[cT,Ph,Kg],Sq=e=>_q.find(t=>t.test(e));function t5(e){const t=Sq(e);if(!t)return!1;let r=t.parse(e);return t===Kg&&(r=bq(r)),r}const r5=(e,t)=>{const r=t5(e),n=t5(t);if(!r||!n)return ub(e,t);const s={...r};return a=>(s.red=ES(r.red,n.red,a),s.green=ES(r.green,n.green,a),s.blue=ES(r.blue,n.blue,a),s.alpha=ws(r.alpha,n.alpha,a),Ph.transform(s))},uT=new Set(["none","hidden"]);function kq(e,t){return uT.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function Cq(e,t){return r=>ws(e,t,r)}function jN(e){return typeof e=="number"?Cq:typeof e=="string"?EN(e)?ub:ia.test(e)?r5:Nq:Array.isArray(e)?r7:typeof e=="object"?ia.test(e)?r5:Tq:ub}function r7(e,t){const r=[...e],n=r.length,s=e.map((a,i)=>jN(a)(a,t[i]));return a=>{for(let i=0;i<n;i++)r[i]=s[i](a);return r}}function Tq(e,t){const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=jN(e[s])(e[s],t[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}}function Eq(e,t){const r=[],n={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const a=t.types[s],i=e.indexes[a][n[a]],o=e.values[i]??0;r[s]=o,n[a]++}return r}const Nq=(e,t)=>{const r=Sf.createTransformer(t),n=Ly(e),s=Ly(t);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?uT.has(e)&&!s.values.length||uT.has(t)&&!n.values.length?kq(e,t):Cv(r7(Eq(n,s),s.values),r):ub(e,t)};function n7(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?ws(e,t,r):jN(e)(e,t)}const Aq=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>gs.update(t,r),stop:()=>_f(t),now:()=>si.isProcessing?si.timestamp:bo.now()}},s7=(e,t,r=10)=>{let n="";const s=Math.max(Math.round(t/r),2);for(let a=0;a<s;a++)n+=Math.round(e(a/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},db=2e4;function PN(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<db;)t+=r,n=e.next(t);return t>=db?1/0:t}function jq(e,t=100,r){const n=r({...e,keyframes:[0,t]}),s=Math.min(PN(n),db);return{type:"keyframes",ease:a=>n.next(s*a).value/t,duration:Kc(s)}}const Pq=5;function a7(e,t,r){const n=Math.max(t-Pq,0);return LM(r-e(n),t-n)}const js={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},NS=.001;function Fq({duration:e=js.duration,bounce:t=js.bounce,velocity:r=js.velocity,mass:n=js.mass}){let s,a,i=1-t;i=Ju(js.minDamping,js.maxDamping,i),e=Ju(js.minDuration,js.maxDuration,Kc(e)),i<1?(s=u=>{const d=u*i,h=d*e,g=d-r,p=dT(u,i),x=Math.exp(-h);return NS-g/p*x},a=u=>{const h=u*i*e,g=h*r+r,p=Math.pow(i,2)*Math.pow(u,2)*e,x=Math.exp(-h),v=dT(Math.pow(u,2),i);return(-s(u)+NS>0?-1:1)*((g-p)*x)/v}):(s=u=>{const d=Math.exp(-u*e),h=(u-r)*e+1;return-NS+d*h},a=u=>{const d=Math.exp(-u*e),h=(r-u)*(e*e);return d*h});const o=5/e,c=Dq(s,a,o);if(e=Vc(e),isNaN(c))return{stiffness:js.stiffness,damping:js.damping,duration:e};{const u=Math.pow(c,2)*n;return{stiffness:u,damping:i*2*Math.sqrt(n*u),duration:e}}}const Oq=12;function Dq(e,t,r){let n=r;for(let s=1;s<Oq;s++)n=n-e(n)/t(n);return n}function dT(e,t){return e*Math.sqrt(1-t*t)}const Iq=["duration","bounce"],Rq=["stiffness","damping","mass"];function n5(e,t){return t.some(r=>e[r]!==void 0)}function Mq(e){let t={velocity:js.velocity,stiffness:js.stiffness,damping:js.damping,mass:js.mass,isResolvedFromDuration:!1,...e};if(!n5(e,Rq)&&n5(e,Iq))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,a=2*Ju(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:js.mass,stiffness:s,damping:a}}else{const r=Fq(e);t={...t,...r,mass:js.mass},t.isResolvedFromDuration=!0}return t}function fb(e=js.visualDuration,t=js.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:s}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],o={done:!1,value:a},{stiffness:c,damping:u,mass:d,duration:h,velocity:g,isResolvedFromDuration:p}=Mq({...r,velocity:-Kc(r.velocity||0)}),x=g||0,v=u/(2*Math.sqrt(c*d)),w=i-a,C=Kc(Math.sqrt(c/d)),k=Math.abs(w)<5;n||(n=k?js.restSpeed.granular:js.restSpeed.default),s||(s=k?js.restDelta.granular:js.restDelta.default);let b;if(v<1){const E=dT(C,v);b=P=>{const F=Math.exp(-v*C*P);return i-F*((x+v*C*w)/E*Math.sin(E*P)+w*Math.cos(E*P))}}else if(v===1)b=E=>i-Math.exp(-C*E)*(w+(x+C*w)*E);else{const E=C*Math.sqrt(v*v-1);b=P=>{const F=Math.exp(-v*C*P),A=Math.min(E*P,300);return i-F*((x+v*C*w)*Math.sinh(A)+E*w*Math.cosh(A))/E}}const N={calculatedDuration:p&&h||null,next:E=>{const P=b(E);if(p)o.done=E>=h;else{let F=E===0?x:0;v<1&&(F=E===0?Vc(x):a7(b,E,P));const A=Math.abs(F)<=n,j=Math.abs(i-P)<=s;o.done=A&&j}return o.value=o.done?i:P,o},toString:()=>{const E=Math.min(PN(N),db),P=s7(F=>N.next(E*F).value,E,30);return E+"ms "+P},toTransition:()=>{}};return N}fb.applyToOptions=e=>{const t=jq(e,100,fb);return e.ease=t.ease,e.duration=Vc(t.duration),e.type="keyframes",e};function fT({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:i,min:o,max:c,restDelta:u=.5,restSpeed:d}){const h=e[0],g={done:!1,value:h},p=A=>o!==void 0&&A<o||c!==void 0&&A>c,x=A=>o===void 0?c:c===void 0||Math.abs(o-A)<Math.abs(c-A)?o:c;let v=r*t;const w=h+v,C=i===void 0?w:i(w);C!==w&&(v=C-h);const k=A=>-v*Math.exp(-A/n),b=A=>C+k(A),N=A=>{const j=k(A),I=b(A);g.done=Math.abs(j)<=u,g.value=g.done?C:I};let E,P;const F=A=>{p(g.value)&&(E=A,P=fb({keyframes:[g.value,x(g.value)],velocity:a7(b,A,g.value),damping:s,stiffness:a,restDelta:u,restSpeed:d}))};return F(0),{calculatedDuration:null,next:A=>{let j=!1;return!P&&E===void 0&&(j=!0,N(A),F(A)),E!==void 0&&A>=E?P.next(A-E):(!j&&N(A),g)}}}function Lq(e,t,r){const n=[],s=r||Zu.mix||n7,a=e.length-1;for(let i=0;i<a;i++){let o=s(e[i],e[i+1]);if(t){const c=Array.isArray(t)?t[i]||Cl:t;o=Cv(c,o)}n.push(o)}return n}function Bq(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const a=e.length;if(bN(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=Lq(t,n,s),c=o.length,u=d=>{if(i&&d<e[0])return t[0];let h=0;if(c>1)for(;h<e.length-2&&!(d<e[h+1]);h++);const g=Ry(e[h],e[h+1],d);return o[h](g)};return r?d=>u(Ju(e[0],e[a-1],d)):u}function $q(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=Ry(0,t,n);e.push(ws(r,1,s))}}function Uq(e){const t=[0];return $q(t,e.length-1),t}function zq(e,t){return e.map(r=>r*t)}function Wq(e,t){return e.map(()=>t||KM).splice(0,e.length-1)}function my({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=eq(n)?n.map(Jj):Jj(n),a={done:!1,value:t[0]},i=zq(r&&r.length===t.length?r:Uq(t),e),o=Bq(i,t,{ease:Array.isArray(s)?s:Wq(t,s)});return{calculatedDuration:e,next:c=>(a.value=o(c),a.done=c>=e,a)}}const Hq=e=>e!==null;function FN(e,{repeat:t,repeatType:r="loop"},n,s=1){const a=e.filter(Hq),o=s<0||t&&r!=="loop"&&t%2===1?0:a.length-1;return!o||n===void 0?a[o]:n}const Gq={decay:fT,inertia:fT,tween:my,keyframes:my,spring:fb};function i7(e){typeof e.type=="string"&&(e.type=Gq[e.type])}class ON{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const Vq=e=>e/100;class DN extends ON{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==bo.now()&&this.tick(bo.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;i7(t);const{type:r=my,repeat:n=0,repeatDelay:s=0,repeatType:a,velocity:i=0}=t;let{keyframes:o}=t;const c=r||my;c!==my&&typeof o[0]!="number"&&(this.mixKeyframes=Cv(Vq,n7(o[0],o[1])),o=[0,100]);const u=c({...t,keyframes:o});a==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...o].reverse(),velocity:-i})),u.calculatedDuration===null&&(u.calculatedDuration=PN(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=u}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:n,totalDuration:s,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:o,calculatedDuration:c}=this;if(this.startTime===null)return n.next(0);const{delay:u=0,keyframes:d,repeat:h,repeatType:g,repeatDelay:p,type:x,onUpdate:v,finalKeyframe:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const C=this.currentTime-u*(this.playbackSpeed>=0?1:-1),k=this.playbackSpeed>=0?C<0:C>s;this.currentTime=Math.max(C,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let b=this.currentTime,N=n;if(h){const A=Math.min(this.currentTime,s)/o;let j=Math.floor(A),I=A%1;!I&&A>=1&&(I=1),I===1&&j--,j=Math.min(j,h+1),!!(j%2)&&(g==="reverse"?(I=1-I,p&&(I-=p/o)):g==="mirror"&&(N=i)),b=Ju(0,1,I)*o}const E=k?{done:!1,value:d[0]}:N.next(b);a&&(E.value=a(E.value));let{done:P}=E;!k&&c!==null&&(P=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const F=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&P);return F&&x!==fT&&(E.value=FN(d,this.options,w,this.speed)),v&&v(E.value),F&&this.finish(),E}then(t,r){return this.finished.then(t,r)}get duration(){return Kc(this.calculatedDuration)}get time(){return Kc(this.currentTime)}set time(t){t=Vc(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(bo.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Kc(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=Aq,startTime:r}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),this.options.onPlay?.();const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(bo.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function Kq(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Fh=e=>e*180/Math.PI,hT=e=>{const t=Fh(Math.atan2(e[1],e[0]));return gT(t)},qq={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:hT,rotateZ:hT,skewX:e=>Fh(Math.atan(e[1])),skewY:e=>Fh(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},gT=e=>(e=e%360,e<0&&(e+=360),e),s5=hT,a5=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),i5=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Yq={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:a5,scaleY:i5,scale:e=>(a5(e)+i5(e))/2,rotateX:e=>gT(Fh(Math.atan2(e[6],e[5]))),rotateY:e=>gT(Fh(Math.atan2(-e[2],e[0]))),rotateZ:s5,rotate:s5,skewX:e=>Fh(Math.atan(e[4])),skewY:e=>Fh(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function mT(e){return e.includes("scale")?1:0}function pT(e,t){if(!e||e==="none")return mT(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=Yq,s=r;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=qq,s=o}if(!s)return mT(t);const a=n[t],i=s[1].split(",").map(Qq);return typeof a=="function"?a(i):i[a]}const Xq=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return pT(r,t)};function Qq(e){return parseFloat(e.trim())}const Lm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Bm=new Set(Lm),o5=e=>e===Mm||e===Dr,Jq=new Set(["x","y","z"]),Zq=Lm.filter(e=>!Jq.has(e));function eY(e){const t=[];return Zq.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const $h={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>pT(t,"x"),y:(e,{transform:t})=>pT(t,"y")};$h.translateX=$h.x;$h.translateY=$h.y;const Uh=new Set;let xT=!1,yT=!1,vT=!1;function o7(){if(yT){const e=Array.from(Uh).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const s=eY(n);s.length&&(r.set(n,s),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([a,i])=>{n.getValue(a)?.set(i)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}yT=!1,xT=!1,Uh.forEach(e=>e.complete(vT)),Uh.clear()}function l7(){Uh.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(yT=!0)})}function tY(){vT=!0,l7(),o7(),vT=!1}class IN{constructor(t,r,n,s,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=s,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Uh.add(this),xT||(xT=!0,gs.read(l7),gs.resolveKeyframes(o7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:s}=this;if(t[0]===null){const a=s?.get(),i=t[t.length-1];if(a!==void 0)t[0]=a;else if(n&&r){const o=n.readValue(r,i);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=i),s&&a===void 0&&s.set(t[0])}Kq(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Uh.delete(this)}cancel(){this.state==="scheduled"&&(Uh.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const rY=e=>e.startsWith("--");function nY(e,t,r){rY(t)?e.style.setProperty(t,r):e.style[t]=r}const sY=_N(()=>window.ScrollTimeline!==void 0),aY={};function iY(e,t){const r=_N(e);return()=>aY[t]??r()}const c7=iY(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ay=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,l5={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ay([0,.65,.55,1]),circOut:ay([.55,0,1,.45]),backIn:ay([.31,.01,.66,-.59]),backOut:ay([.33,1.53,.69,.99])};function u7(e,t){if(e)return typeof e=="function"?c7()?s7(e,t):"ease-out":qM(e)?ay(e):Array.isArray(e)?e.map(r=>u7(r,t)||l5.easeOut):l5[e]}function oY(e,t,r,{delay:n=0,duration:s=300,repeat:a=0,repeatType:i="loop",ease:o="easeOut",times:c}={},u=void 0){const d={[t]:r};c&&(d.offset=c);const h=u7(o,s);Array.isArray(h)&&(d.easing=h);const g={delay:n,duration:s,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return u&&(g.pseudoElement=u),e.animate(d,g)}function d7(e){return typeof e=="function"&&"applyToOptions"in e}function lY({type:e,...t}){return d7(e)&&c7()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class cY extends ON{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:n,keyframes:s,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:o,onComplete:c}=t;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=t,bN(typeof t.type!="string");const u=lY(t);this.animation=oY(r,n,s,u,a),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const d=FN(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(d):nY(r,n,d),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return Kc(Number(t))}get time(){return Kc(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Vc(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&sY()?(this.animation.timeline=t,Cl):r(this)}}const f7={anticipate:HM,backInOut:WM,circInOut:VM};function uY(e){return e in f7}function dY(e){typeof e.ease=="string"&&uY(e.ease)&&(e.ease=f7[e.ease])}const c5=10;class fY extends cY{constructor(t){dY(t),i7(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:n,onComplete:s,element:a,...i}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const o=new DN({...i,autoplay:!1}),c=Vc(this.finishedTime??this.time);r.setWithVelocity(o.sample(c-c5).value,o.sample(c).value,c5),o.stop()}}const u5=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Sf.test(e)||e==="0")&&!e.startsWith("url("));function hY(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function gY(e,t,r,n){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],i=u5(s,t),o=u5(a,t);return!i||!o?!1:hY(e)||(r==="spring"||d7(r))&&n}function wT(e){e.duration=0,e.type}const mY=new Set(["opacity","clipPath","filter","transform"]),pY=_N(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function xY(e){const{motionValue:t,name:r,repeatDelay:n,repeatType:s,damping:a,type:i}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=t.owner.getProps();return pY()&&r&&mY.has(r)&&(r!=="transform"||!u)&&!c&&!n&&s!=="mirror"&&a!==0&&i!=="inertia"}const yY=40;class vY extends ON{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:i="loop",keyframes:o,name:c,motionValue:u,element:d,...h}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=bo.now();const g={autoplay:t,delay:r,type:n,repeat:s,repeatDelay:a,repeatType:i,name:c,motionValue:u,element:d,...h},p=d?.KeyframeResolver||IN;this.keyframeResolver=new p(o,(x,v,w)=>this.onKeyframesResolved(x,v,g,!w),c,u,d),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,r,n,s){this.keyframeResolver=void 0;const{name:a,type:i,velocity:o,delay:c,isHandoff:u,onUpdate:d}=n;this.resolvedAt=bo.now(),gY(t,a,i,o)||((Zu.instantAnimations||!c)&&d?.(FN(t,n,r)),t[0]=t[t.length-1],wT(n),n.repeat=0);const g={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>yY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:t},p=!u&&xY(g)?new fY({...g,element:g.motionValue.owner.current}):new DN(g);p.finished.then(()=>this.notifyFinished()).catch(Cl),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),tY()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const wY=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function bY(e){const t=wY.exec(e);if(!t)return[,];const[,r,n,s]=t;return[`--${r??n}`,s]}function h7(e,t,r=1){const[n,s]=bY(e);if(!n)return;const a=window.getComputedStyle(t).getPropertyValue(n);if(a){const i=a.trim();return IM(i)?parseFloat(i):i}return EN(s)?h7(s,t,r+1):s}function RN(e,t){return e?.[t]??e?.default??e}const g7=new Set(["width","height","top","left","right","bottom",...Lm]),_Y={test:e=>e==="auto",parse:e=>e},m7=e=>t=>t.test(e),p7=[Mm,Dr,qc,sf,hq,fq,_Y],d5=e=>p7.find(m7(e));function SY(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||MM(e):!0}const kY=new Set(["brightness","contrast","saturate","opacity"]);function CY(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(NN)||[];if(!n)return e;const s=r.replace(n,"");let a=kY.has(t)?1:0;return n!==r&&(a*=100),t+"("+a+s+")"}const TY=/\b([a-z-]*)\(.*?\)/gu,bT={...Sf,getAnimatableNone:e=>{const t=e.match(TY);return t?t.map(CY).join(" "):e}},f5={...Mm,transform:Math.round},EY={rotate:sf,rotateX:sf,rotateY:sf,rotateZ:sf,scale:cw,scaleX:cw,scaleY:cw,scaleZ:cw,skew:sf,skewX:sf,skewY:sf,distance:Dr,translateX:Dr,translateY:Dr,translateZ:Dr,x:Dr,y:Dr,z:Dr,perspective:Dr,transformPerspective:Dr,opacity:My,originX:Zj,originY:Zj,originZ:Dr},MN={borderWidth:Dr,borderTopWidth:Dr,borderRightWidth:Dr,borderBottomWidth:Dr,borderLeftWidth:Dr,borderRadius:Dr,radius:Dr,borderTopLeftRadius:Dr,borderTopRightRadius:Dr,borderBottomRightRadius:Dr,borderBottomLeftRadius:Dr,width:Dr,maxWidth:Dr,height:Dr,maxHeight:Dr,top:Dr,right:Dr,bottom:Dr,left:Dr,padding:Dr,paddingTop:Dr,paddingRight:Dr,paddingBottom:Dr,paddingLeft:Dr,margin:Dr,marginTop:Dr,marginRight:Dr,marginBottom:Dr,marginLeft:Dr,backgroundPositionX:Dr,backgroundPositionY:Dr,...EY,zIndex:f5,fillOpacity:My,strokeOpacity:My,numOctaves:f5},NY={...MN,color:ia,backgroundColor:ia,outlineColor:ia,fill:ia,stroke:ia,borderColor:ia,borderTopColor:ia,borderRightColor:ia,borderBottomColor:ia,borderLeftColor:ia,filter:bT,WebkitFilter:bT},x7=e=>NY[e];function y7(e,t){let r=x7(e);return r!==bT&&(r=Sf),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const AY=new Set(["auto","none","0"]);function jY(e,t,r){let n=0,s;for(;n<e.length&&!s;){const a=e[n];typeof a=="string"&&!AY.has(a)&&Ly(a).values.length&&(s=e[n]),n++}if(s&&r)for(const a of t)e[a]=y7(r,s)}class PY extends IN{constructor(t,r,n,s,a){super(t,r,n,s,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let u=t[c];if(typeof u=="string"&&(u=u.trim(),EN(u))){const d=h7(u,r.current);d!==void 0&&(t[c]=d),c===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!g7.has(n)||t.length!==2)return;const[s,a]=t,i=d5(s),o=d5(a);if(i!==o)if(o5(i)&&o5(o))for(let c=0;c<t.length;c++){const u=t[c];typeof u=="string"&&(t[c]=parseFloat(u))}else $h[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let s=0;s<t.length;s++)(t[s]===null||SY(t[s]))&&n.push(s);n.length&&jY(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=$h[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&t.getValue(n,s).jump(s,!1)}measureEndState(){const{element:t,name:r,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=n.length-1,i=n[a];n[a]=$h[r](t.measureViewportBox(),window.getComputedStyle(t.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),this.removedTransforms?.length&&this.removedTransforms.forEach(([o,c])=>{t.getValue(o).set(c)}),this.resolveNoneKeyframes()}}function FY(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let n=document;const s=r?.[e]??n.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}const v7=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function w7(e){return RM(e)&&"offsetHeight"in e}const h5=30,OY=e=>!isNaN(parseFloat(e));class DY{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{const s=bo.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=bo.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=OY(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new SN);const n=this.events[t].add(r);return t==="change"?()=>{n(),gs.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=bo.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>h5)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,h5);return LM(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function xm(e,t){return new DY(e,t)}const{schedule:LN}=YM(queueMicrotask,!1),ec={x:!1,y:!1};function b7(){return ec.x||ec.y}function IY(e){return e==="x"||e==="y"?ec[e]?null:(ec[e]=!0,()=>{ec[e]=!1}):ec.x||ec.y?null:(ec.x=ec.y=!0,()=>{ec.x=ec.y=!1})}function _7(e,t){const r=FY(e),n=new AbortController,s={passive:!0,...t,signal:n.signal};return[r,s,()=>n.abort()]}function g5(e){return!(e.pointerType==="touch"||b7())}function RY(e,t,r={}){const[n,s,a]=_7(e,r),i=o=>{if(!g5(o))return;const{target:c}=o,u=t(c,o);if(typeof u!="function"||!c)return;const d=h=>{g5(h)&&(u(h),c.removeEventListener("pointerleave",d))};c.addEventListener("pointerleave",d,s)};return n.forEach(o=>{o.addEventListener("pointerenter",i,s)}),a}const S7=(e,t)=>t?e===t?!0:S7(e,t.parentElement):!1,BN=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,MY=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function LY(e){return MY.has(e.tagName)||e.tabIndex!==-1}const Qw=new WeakSet;function m5(e){return t=>{t.key==="Enter"&&e(t)}}function AS(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const BY=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=m5(()=>{if(Qw.has(r))return;AS(r,"down");const s=m5(()=>{AS(r,"up")}),a=()=>AS(r,"cancel");r.addEventListener("keyup",s,t),r.addEventListener("blur",a,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function p5(e){return BN(e)&&!b7()}function $Y(e,t,r={}){const[n,s,a]=_7(e,r),i=o=>{const c=o.currentTarget;if(!p5(o))return;Qw.add(c);const u=t(c,o),d=(p,x)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",g),Qw.has(c)&&Qw.delete(c),p5(p)&&typeof u=="function"&&u(p,{success:x})},h=p=>{d(p,c===window||c===document||r.useGlobalTarget||S7(c,p.target))},g=p=>{d(p,!1)};window.addEventListener("pointerup",h,s),window.addEventListener("pointercancel",g,s)};return n.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",i,s),w7(o)&&(o.addEventListener("focus",u=>BY(u,s)),!LY(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),a}function k7(e){return RM(e)&&"ownerSVGElement"in e}function UY(e){return k7(e)&&e.tagName==="svg"}const ji=e=>!!(e&&e.getVelocity),zY=[...p7,ia,Sf],WY=e=>zY.find(m7(e)),$N=S.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class HY extends S.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=w7(n)&&n.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function GY({children:e,isPresent:t,anchorX:r,root:n}){const s=S.useId(),a=S.useRef(null),i=S.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=S.useContext($N);return S.useInsertionEffect(()=>{const{width:c,height:u,top:d,left:h,right:g}=i.current;if(t||!a.current||!c||!u)return;const p=r==="left"?`left: ${h}`:`right: ${g}`;a.current.dataset.motionPopId=s;const x=document.createElement("style");o&&(x.nonce=o);const v=n??document.head;return v.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${u}px !important;
            ${p}px !important;
            top: ${d}px !important;
          }
        `),()=>{v.contains(x)&&v.removeChild(x)}},[t]),l.jsx(HY,{isPresent:t,childRef:a,sizeRef:i,children:S.cloneElement(e,{ref:a})})}const VY=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:i,anchorX:o,root:c})=>{const u=xN(KY),d=S.useId();let h=!0,g=S.useMemo(()=>(h=!1,{id:d,initial:t,isPresent:r,custom:s,onExitComplete:p=>{u.set(p,!0);for(const x of u.values())if(!x)return;n&&n()},register:p=>(u.set(p,!1),()=>u.delete(p))}),[r,u,n]);return a&&h&&(g={...g}),S.useMemo(()=>{u.forEach((p,x)=>u.set(x,!1))},[r]),S.useEffect(()=>{!r&&!u.size&&n&&n()},[r]),i==="popLayout"&&(e=l.jsx(GY,{isPresent:r,anchorX:o,root:c,children:e})),l.jsx(O_.Provider,{value:g,children:e})};function KY(){return new Map}function C7(e=!0){const t=S.useContext(O_);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=t,a=S.useId();S.useEffect(()=>{if(e)return s(a)},[e]);const i=S.useCallback(()=>e&&n&&n(a),[a,n,e]);return!r&&n?[!1,i]:[!0]}const uw=e=>e.key||"";function x5(e){const t=[];return S.Children.forEach(e,r=>{S.isValidElement(r)&&t.push(r)}),t}const wo=({children:e,custom:t,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:a="sync",propagate:i=!1,anchorX:o="left",root:c})=>{const[u,d]=C7(i),h=S.useMemo(()=>x5(e),[e]),g=i&&!u?[]:h.map(uw),p=S.useRef(!0),x=S.useRef(h),v=xN(()=>new Map),[w,C]=S.useState(h),[k,b]=S.useState(h);DM(()=>{p.current=!1,x.current=h;for(let P=0;P<k.length;P++){const F=uw(k[P]);g.includes(F)?v.delete(F):v.get(F)!==!0&&v.set(F,!1)}},[k,g.length,g.join("-")]);const N=[];if(h!==w){let P=[...h];for(let F=0;F<k.length;F++){const A=k[F],j=uw(A);g.includes(j)||(P.splice(F,0,A),N.push(A))}return a==="wait"&&N.length&&(P=N),b(x5(P)),C(h),null}const{forceRender:E}=S.useContext(pN);return l.jsx(l.Fragment,{children:k.map(P=>{const F=uw(P),A=i&&!u?!1:h===k||g.includes(F),j=()=>{if(v.has(F))v.set(F,!0);else return;let I=!0;v.forEach(B=>{B||(I=!1)}),I&&(E?.(),b(x.current),i&&d?.(),n&&n())};return l.jsx(VY,{isPresent:A,initial:!p.current||r?void 0:!1,custom:t,presenceAffectsLayout:s,mode:a,root:c,onExitComplete:A?void 0:j,anchorX:o,children:P},F)})})},T7=S.createContext({strict:!1}),y5={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ym={};for(const e in y5)ym[e]={isEnabled:t=>y5[e].some(r=>!!t[r])};function qY(e){for(const t in e)ym[t]={...ym[t],...e[t]}}const YY=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function hb(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||YY.has(e)}let E7=e=>!hb(e);function XY(e){typeof e=="function"&&(E7=t=>t.startsWith("on")?!hb(t):e(t))}try{XY(require("@emotion/is-prop-valid").default)}catch{}function QY(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(E7(s)||r===!0&&hb(s)||!t&&!hb(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}const D_=S.createContext({});function I_(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function By(e){return typeof e=="string"||Array.isArray(e)}const UN=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],zN=["initial",...UN];function R_(e){return I_(e.animate)||zN.some(t=>By(e[t]))}function N7(e){return!!(R_(e)||e.variants)}function JY(e,t){if(R_(e)){const{initial:r,animate:n}=e;return{initial:r===!1||By(r)?r:void 0,animate:By(n)?n:void 0}}return e.inherit!==!1?t:{}}function ZY(e){const{initial:t,animate:r}=JY(e,S.useContext(D_));return S.useMemo(()=>({initial:t,animate:r}),[v5(t),v5(r)])}function v5(e){return Array.isArray(e)?e.join(" "):e}const $y={};function eX(e){for(const t in e)$y[t]=e[t],TN(t)&&($y[t].isCSSVariable=!0)}function A7(e,{layout:t,layoutId:r}){return Bm.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!$y[e]||e==="opacity")}const tX={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},rX=Lm.length;function nX(e,t,r){let n="",s=!0;for(let a=0;a<rX;a++){const i=Lm[a],o=e[i];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(i.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||r){const u=v7(o,MN[i]);if(!c){s=!1;const d=tX[i]||i;n+=`${d}(${u}) `}r&&(t[i]=u)}}return n=n.trim(),r?n=r(t,s?"":n):s&&(n="none"),n}function WN(e,t,r){const{style:n,vars:s,transformOrigin:a}=e;let i=!1,o=!1;for(const c in t){const u=t[c];if(Bm.has(c)){i=!0;continue}else if(TN(c)){s[c]=u;continue}else{const d=v7(u,MN[c]);c.startsWith("origin")?(o=!0,a[c]=d):n[c]=d}}if(t.transform||(i||r?n.transform=nX(t,e.transform,r):n.transform&&(n.transform="none")),o){const{originX:c="50%",originY:u="50%",originZ:d=0}=a;n.transformOrigin=`${c} ${u} ${d}`}}const HN=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function j7(e,t,r){for(const n in t)!ji(t[n])&&!A7(n,r)&&(e[n]=t[n])}function sX({transformTemplate:e},t){return S.useMemo(()=>{const r=HN();return WN(r,t,e),Object.assign({},r.vars,r.style)},[t])}function aX(e,t){const r=e.style||{},n={};return j7(n,r,e),Object.assign(n,sX(e,t)),n}function iX(e,t){const r={},n=aX(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const oX={offset:"stroke-dashoffset",array:"stroke-dasharray"},lX={offset:"strokeDashoffset",array:"strokeDasharray"};function cX(e,t,r=1,n=0,s=!0){e.pathLength=1;const a=s?oX:lX;e[a.offset]=Dr.transform(-n);const i=Dr.transform(t),o=Dr.transform(r);e[a.array]=`${i} ${o}`}function P7(e,{attrX:t,attrY:r,attrScale:n,pathLength:s,pathSpacing:a=1,pathOffset:i=0,...o},c,u,d){if(WN(e,o,u),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:h,style:g}=e;h.transform&&(g.transform=h.transform,delete h.transform),(g.transform||h.transformOrigin)&&(g.transformOrigin=h.transformOrigin??"50% 50%",delete h.transformOrigin),g.transform&&(g.transformBox=d?.transformBox??"fill-box",delete h.transformBox),t!==void 0&&(h.x=t),r!==void 0&&(h.y=r),n!==void 0&&(h.scale=n),s!==void 0&&cX(h,s,a,i,!1)}const F7=()=>({...HN(),attrs:{}}),O7=e=>typeof e=="string"&&e.toLowerCase()==="svg";function uX(e,t,r,n){const s=S.useMemo(()=>{const a=F7();return P7(a,t,O7(n),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};j7(a,e.style,e),s.style={...a,...s.style}}return s}const dX=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function GN(e){return typeof e!="string"||e.includes("-")?!1:!!(dX.indexOf(e)>-1||/[A-Z]/u.test(e))}function fX(e,t,r,{latestValues:n},s,a=!1){const o=(GN(e)?uX:iX)(t,n,s,e),c=QY(t,typeof e=="string",a),u=e!==S.Fragment?{...c,...o,ref:r}:{},{children:d}=t,h=S.useMemo(()=>ji(d)?d.get():d,[d]);return S.createElement(e,{...u,children:h})}function w5(e){const t=[{},{}];return e?.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function VN(e,t,r,n){if(typeof t=="function"){const[s,a]=w5(n);t=t(r!==void 0?r:e.custom,s,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,a]=w5(n);t=t(r!==void 0?r:e.custom,s,a)}return t}function Jw(e){return ji(e)?e.get():e}function hX({scrapeMotionValuesFromProps:e,createRenderState:t},r,n,s){return{latestValues:gX(r,n,s,e),renderState:t()}}function gX(e,t,r,n){const s={},a=n(e,{});for(const g in a)s[g]=Jw(a[g]);let{initial:i,animate:o}=e;const c=R_(e),u=N7(e);t&&u&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),o===void 0&&(o=t.animate));let d=r?r.initial===!1:!1;d=d||i===!1;const h=d?o:i;if(h&&typeof h!="boolean"&&!I_(h)){const g=Array.isArray(h)?h:[h];for(let p=0;p<g.length;p++){const x=VN(e,g[p]);if(x){const{transitionEnd:v,transition:w,...C}=x;for(const k in C){let b=C[k];if(Array.isArray(b)){const N=d?b.length-1:0;b=b[N]}b!==null&&(s[k]=b)}for(const k in v)s[k]=v[k]}}}return s}const D7=e=>(t,r)=>{const n=S.useContext(D_),s=S.useContext(O_),a=()=>hX(e,t,n,s);return r?a():xN(a)};function KN(e,t,r){const{style:n}=e,s={};for(const a in n)(ji(n[a])||t.style&&ji(t.style[a])||A7(a,e)||r?.getValue(a)?.liveStyle!==void 0)&&(s[a]=n[a]);return s}const mX=D7({scrapeMotionValuesFromProps:KN,createRenderState:HN});function I7(e,t,r){const n=KN(e,t,r);for(const s in e)if(ji(e[s])||ji(t[s])){const a=Lm.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[a]=e[s]}return n}const pX=D7({scrapeMotionValuesFromProps:I7,createRenderState:F7}),xX=Symbol.for("motionComponentSymbol");function qg(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function yX(e,t,r){return S.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):qg(r)&&(r.current=n))},[t])}const qN=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),vX="framerAppearId",R7="data-"+qN(vX),M7=S.createContext({});function wX(e,t,r,n,s){const{visualElement:a}=S.useContext(D_),i=S.useContext(T7),o=S.useContext(O_),c=S.useContext($N).reducedMotion,u=S.useRef(null);n=n||i.renderer,!u.current&&n&&(u.current=n(e,{visualState:t,parent:a,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:c}));const d=u.current,h=S.useContext(M7);d&&!d.projection&&s&&(d.type==="html"||d.type==="svg")&&bX(u.current,r,s,h);const g=S.useRef(!1);S.useInsertionEffect(()=>{d&&g.current&&d.update(r,o)});const p=r[R7],x=S.useRef(!!p&&!window.MotionHandoffIsComplete?.(p)&&window.MotionHasOptimisedAnimation?.(p));return DM(()=>{d&&(g.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),x.current&&d.animationState&&d.animationState.animateChanges())}),S.useEffect(()=>{d&&(!x.current&&d.animationState&&d.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(p)}),x.current=!1),d.enteringChildren=void 0)}),d}function bX(e,t,r,n){const{layoutId:s,layout:a,drag:i,dragConstraints:o,layoutScroll:c,layoutRoot:u,layoutCrossfade:d}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:L7(e.parent)),e.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!i||o&&qg(o),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:d,layoutScroll:c,layoutRoot:u})}function L7(e){if(e)return e.options.allowProjection!==!1?e.projection:L7(e.parent)}function jS(e,{forwardMotionProps:t=!1}={},r,n){r&&qY(r);const s=GN(e)?pX:mX;function a(o,c){let u;const d={...S.useContext($N),...o,layoutId:_X(o)},{isStatic:h}=d,g=ZY(o),p=s(o,h);if(!h&&yN){SX();const x=kX(d);u=x.MeasureLayout,g.visualElement=wX(e,p,d,n,x.ProjectionNode)}return l.jsxs(D_.Provider,{value:g,children:[u&&g.visualElement?l.jsx(u,{visualElement:g.visualElement,...d}):null,fX(e,o,yX(p,g.visualElement,c),p,h,t)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const i=S.forwardRef(a);return i[xX]=e,i}function _X({layoutId:e}){const t=S.useContext(pN).id;return t&&e!==void 0?t+"-"+e:e}function SX(e,t){S.useContext(T7).strict}function kX(e){const{drag:t,layout:r}=ym;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t?.isEnabled(e)||r?.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function CX(e,t){if(typeof Proxy>"u")return jS;const r=new Map,n=(a,i)=>jS(a,i,e,t),s=(a,i)=>n(a,i);return new Proxy(s,{get:(a,i)=>i==="create"?n:(r.has(i)||r.set(i,jS(i,void 0,e,t)),r.get(i))})}function B7({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function TX({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function EX(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function PS(e){return e===void 0||e===1}function _T({scale:e,scaleX:t,scaleY:r}){return!PS(e)||!PS(t)||!PS(r)}function Ch(e){return _T(e)||$7(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function $7(e){return b5(e.x)||b5(e.y)}function b5(e){return e&&e!=="0%"}function gb(e,t,r){const n=e-r,s=t*n;return r+s}function _5(e,t,r,n,s){return s!==void 0&&(e=gb(e,s,n)),gb(e,r,n)+t}function ST(e,t=0,r=1,n,s){e.min=_5(e.min,t,r,n,s),e.max=_5(e.max,t,r,n,s)}function U7(e,{x:t,y:r}){ST(e.x,t.translate,t.scale,t.originPoint),ST(e.y,r.translate,r.scale,r.originPoint)}const S5=.999999999999,k5=1.0000000000001;function NX(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let a,i;for(let o=0;o<s;o++){a=r[o],i=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Xg(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,U7(e,i)),n&&Ch(a.latestValues)&&Xg(e,a.latestValues))}t.x<k5&&t.x>S5&&(t.x=1),t.y<k5&&t.y>S5&&(t.y=1)}function Yg(e,t){e.min=e.min+t,e.max=e.max+t}function C5(e,t,r,n,s=.5){const a=ws(e.min,e.max,s);ST(e,t,r,a,n)}function Xg(e,t){C5(e.x,t.x,t.scaleX,t.scale,t.originX),C5(e.y,t.y,t.scaleY,t.scale,t.originY)}function z7(e,t){return B7(EX(e.getBoundingClientRect(),t))}function AX(e,t,r){const n=z7(e,r),{scroll:s}=t;return s&&(Yg(n.x,s.offset.x),Yg(n.y,s.offset.y)),n}const T5=()=>({translate:0,scale:1,origin:0,originPoint:0}),Qg=()=>({x:T5(),y:T5()}),E5=()=>({min:0,max:0}),Ys=()=>({x:E5(),y:E5()}),kT={current:null},W7={current:!1};function jX(){if(W7.current=!0,!!yN)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>kT.current=e.matches;e.addEventListener("change",t),t()}else kT.current=!1}const PX=new WeakMap;function FX(e,t,r){for(const n in t){const s=t[n],a=r[n];if(ji(s))e.addValue(n,s);else if(ji(a))e.addValue(n,xm(s,{owner:e}));else if(a!==s)if(e.hasValue(n)){const i=e.getValue(n);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=e.getStaticValue(n);e.addValue(n,xm(i!==void 0?i:s,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const N5=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class OX{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:a,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=IN,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=bo.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,gs.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=i;this.latestValues=c,this.baseTarget={...c},this.initialValues=r.initial?{...c}:{},this.renderState=u,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!a,this.isControllingVariants=R_(r),this.isVariantNode=N7(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...h}=this.scrapeMotionValuesFromProps(r,{},this);for(const g in h){const p=h[g];c[g]!==void 0&&ji(p)&&p.set(c[g])}}mount(t){this.current=t,PX.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),W7.current||jX(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:kT.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),_f(this.notifyUpdate),_f(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=Bm.has(t);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&gs.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{s(),a&&a(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in ym){const r=ym[t];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[t]&&s&&n(this.props)&&(this.features[t]=new s(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ys()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<N5.length;n++){const s=N5[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a="on"+s,i=t[a];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=FX(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=xm(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){let n=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return n!=null&&(typeof n=="string"&&(IM(n)||MM(n))?n=parseFloat(n):!WY(n)&&Sf.test(r)&&(n=y7(t,r)),this.setBaseTarget(t,ji(n)?n.get():n)),ji(n)?n.get():n}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const a=VN(this.props,r,this.presenceContext?.custom);a&&(n=a[t])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!ji(s)?s:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new SN),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){LN.render(this.render)}}class H7 extends OX{constructor(){super(...arguments),this.KeyframeResolver=PY}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;ji(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function G7(e,{style:t,vars:r},n,s){const a=e.style;let i;for(i in t)a[i]=t[i];s?.applyProjectionStyles(a,n);for(i in r)a.setProperty(i,r[i])}function DX(e){return window.getComputedStyle(e)}class IX extends H7{constructor(){super(...arguments),this.type="html",this.renderInstance=G7}readValueFromInstance(t,r){if(Bm.has(r))return this.projection?.isProjecting?mT(r):Xq(t,r);{const n=DX(t),s=(TN(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return z7(t,r)}build(t,r,n){WN(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return KN(t,r,n)}}const V7=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function RX(e,t,r,n){G7(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(V7.has(s)?s:qN(s),t.attrs[s])}class MX extends H7{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ys}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Bm.has(r)){const n=x7(r);return n&&n.default||0}return r=V7.has(r)?r:qN(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return I7(t,r,n)}build(t,r,n){P7(t,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(t,r,n,s){RX(t,r,n,s)}mount(t){this.isSVGTag=O7(t.tagName),super.mount(t)}}const LX=(e,t)=>GN(e)?new MX(t):new IX(t,{allowProjection:e!==S.Fragment});function nm(e,t,r){const n=e.getProps();return VN(n,t,r!==void 0?r:n.custom,e)}const CT=e=>Array.isArray(e);function BX(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,xm(r))}function $X(e){return CT(e)?e[e.length-1]||0:e}function UX(e,t){const r=nm(e,t);let{transitionEnd:n={},transition:s={},...a}=r||{};a={...a,...n};for(const i in a){const o=$X(a[i]);BX(e,i,o)}}function zX(e){return!!(ji(e)&&e.add)}function TT(e,t){const r=e.getValue("willChange");if(zX(r))return r.add(t);if(!r&&Zu.WillChange){const n=new Zu.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function K7(e){return e.props[R7]}const WX=e=>e!==null;function HX(e,{repeat:t,repeatType:r="loop"},n){const s=e.filter(WX),a=t&&r!=="loop"&&t%2===1?0:s.length-1;return s[a]}const GX={type:"spring",stiffness:500,damping:25,restSpeed:10},VX=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),KX={type:"keyframes",duration:.8},qX={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},YX=(e,{keyframes:t})=>t.length>2?KX:Bm.has(e)?e.startsWith("scale")?VX(t[1]):GX:qX;function XX({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:i,repeatDelay:o,from:c,elapsed:u,...d}){return!!Object.keys(d).length}const YN=(e,t,r,n={},s,a)=>i=>{const o=RN(n,e)||{},c=o.delay||n.delay||0;let{elapsed:u=0}=n;u=u-Vc(c);const d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-u,onUpdate:g=>{t.set(g),o.onUpdate&&o.onUpdate(g)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:a?void 0:s};XX(o)||Object.assign(d,YX(e,d)),d.duration&&(d.duration=Vc(d.duration)),d.repeatDelay&&(d.repeatDelay=Vc(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let h=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(wT(d),d.delay===0&&(h=!0)),(Zu.instantAnimations||Zu.skipAnimations)&&(h=!0,wT(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,h&&!a&&t.get()!==void 0){const g=HX(d.keyframes,o);if(g!==void 0){gs.update(()=>{d.onUpdate(g),d.onComplete()});return}}return o.isSync?new DN(d):new vY(d)};function QX({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function q7(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:i,...o}=t;n&&(a=n);const c=[],u=s&&e.animationState&&e.animationState.getState()[s];for(const d in o){const h=e.getValue(d,e.latestValues[d]??null),g=o[d];if(g===void 0||u&&QX(u,d))continue;const p={delay:r,...RN(a||{},d)},x=h.get();if(x!==void 0&&!h.isAnimating&&!Array.isArray(g)&&g===x&&!p.velocity)continue;let v=!1;if(window.MotionHandoffAnimation){const C=K7(e);if(C){const k=window.MotionHandoffAnimation(C,d,gs);k!==null&&(p.startTime=k,v=!0)}}TT(e,d),h.start(YN(d,h,g,e.shouldReduceMotion&&g7.has(d)?{type:!1}:p,e,v));const w=h.animation;w&&c.push(w)}return i&&Promise.all(c).then(()=>{gs.update(()=>{i&&UX(e,i)})}),c}function Y7(e,t,r,n=0,s=1){const a=Array.from(e).sort((u,d)=>u.sortNodePosition(d)).indexOf(t),i=e.size,o=(i-1)*n;return typeof r=="function"?r(a,i):s===1?a*n:o-a*n}function ET(e,t,r={}){const n=nm(e,t,r.type==="exit"?e.presenceContext?.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const a=n?()=>Promise.all(q7(e,n,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return JX(e,t,c,u,d,h,r)}:()=>Promise.resolve(),{when:o}=s;if(o){const[c,u]=o==="beforeChildren"?[a,i]:[i,a];return c().then(()=>u())}else return Promise.all([a(),i(r.delay)])}function JX(e,t,r=0,n=0,s=0,a=1,i){const o=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),o.push(ET(c,t,{...i,delay:r+(typeof n=="function"?0:n)+Y7(e.variantChildren,c,n,s,a)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(o)}function ZX(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(a=>ET(e,a,r));n=Promise.all(s)}else if(typeof t=="string")n=ET(e,t,r);else{const s=typeof t=="function"?nm(e,t,r.custom):t;n=Promise.all(q7(e,s,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function X7(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const eQ=zN.length;function Q7(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?Q7(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<eQ;r++){const n=zN[r],s=e.props[n];(By(s)||s===!1)&&(t[n]=s)}return t}const tQ=[...UN].reverse(),rQ=UN.length;function nQ(e){return t=>Promise.all(t.map(({animation:r,options:n})=>ZX(e,r,n)))}function sQ(e){let t=nQ(e),r=A5(),n=!0;const s=c=>(u,d)=>{const h=nm(e,d,c==="exit"?e.presenceContext?.custom:void 0);if(h){const{transition:g,transitionEnd:p,...x}=h;u={...u,...x,...p}}return u};function a(c){t=c(e)}function i(c){const{props:u}=e,d=Q7(e.parent)||{},h=[],g=new Set;let p={},x=1/0;for(let w=0;w<rQ;w++){const C=tQ[w],k=r[C],b=u[C]!==void 0?u[C]:d[C],N=By(b),E=C===c?k.isActive:null;E===!1&&(x=w);let P=b===d[C]&&b!==u[C]&&N;if(P&&n&&e.manuallyAnimateOnMount&&(P=!1),k.protectedKeys={...p},!k.isActive&&E===null||!b&&!k.prevProp||I_(b)||typeof b=="boolean")continue;const F=aQ(k.prevProp,b);let A=F||C===c&&k.isActive&&!P&&N||w>x&&N,j=!1;const I=Array.isArray(b)?b:[b];let B=I.reduce(s(C),{});E===!1&&(B={});const{prevResolvedValues:Y={}}=k,Z={...Y,...B},ae=L=>{A=!0,g.has(L)&&(j=!0,g.delete(L)),k.needsAnimating[L]=!0;const H=e.getValue(L);H&&(H.liveStyle=!1)};for(const L in Z){const H=B[L],M=Y[L];if(p.hasOwnProperty(L))continue;let V=!1;CT(H)&&CT(M)?V=!X7(H,M):V=H!==M,V?H!=null?ae(L):g.add(L):H!==void 0&&g.has(L)?ae(L):k.protectedKeys[L]=!0}k.prevProp=b,k.prevResolvedValues=B,k.isActive&&(p={...p,...B}),n&&e.blockInitialAnimation&&(A=!1);const ee=P&&F;A&&(!ee||j)&&h.push(...I.map(L=>{const H={type:C};if(typeof L=="string"&&n&&!ee&&e.manuallyAnimateOnMount&&e.parent){const{parent:M}=e,V=nm(M,L);if(M.enteringChildren&&V){const{delayChildren:W}=V.transition||{};H.delay=Y7(M.enteringChildren,e,W)}}return{animation:L,options:H}}))}if(g.size){const w={};if(typeof u.initial!="boolean"){const C=nm(e,Array.isArray(u.initial)?u.initial[0]:u.initial);C&&C.transition&&(w.transition=C.transition)}g.forEach(C=>{const k=e.getBaseTarget(C),b=e.getValue(C);b&&(b.liveStyle=!0),w[C]=k??null}),h.push({animation:w})}let v=!!h.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(v=!1),n=!1,v?t(h):Promise.resolve()}function o(c,u){if(r[c].isActive===u)return Promise.resolve();e.variantChildren?.forEach(h=>h.animationState?.setActive(c,u)),r[c].isActive=u;const d=i(c);for(const h in r)r[h].protectedKeys={};return d}return{animateChanges:i,setActive:o,setAnimateFunction:a,getState:()=>r,reset:()=>{r=A5(),n=!0}}}function aQ(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!X7(t,e):!1}function wh(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function A5(){return{animate:wh(!0),whileInView:wh(),whileHover:wh(),whileTap:wh(),whileDrag:wh(),whileFocus:wh(),exit:wh()}}class Ff{constructor(t){this.isMounted=!1,this.node=t}update(){}}class iQ extends Ff{constructor(t){super(t),t.animationState||(t.animationState=sQ(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();I_(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let oQ=0;class lQ extends Ff{constructor(){super(...arguments),this.id=oQ++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const s=this.node.animationState.setActive("exit",!t);r&&!t&&s.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const cQ={animation:{Feature:iQ},exit:{Feature:lQ}};function Uy(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function Nv(e){return{point:{x:e.pageX,y:e.pageY}}}const uQ=e=>t=>BN(t)&&e(t,Nv(t));function py(e,t,r,n){return Uy(e,t,uQ(r),n)}const J7=1e-4,dQ=1-J7,fQ=1+J7,Z7=.01,hQ=0-Z7,gQ=0+Z7;function eo(e){return e.max-e.min}function mQ(e,t,r){return Math.abs(e-t)<=r}function j5(e,t,r,n=.5){e.origin=n,e.originPoint=ws(t.min,t.max,e.origin),e.scale=eo(r)/eo(t),e.translate=ws(r.min,r.max,e.origin)-e.originPoint,(e.scale>=dQ&&e.scale<=fQ||isNaN(e.scale))&&(e.scale=1),(e.translate>=hQ&&e.translate<=gQ||isNaN(e.translate))&&(e.translate=0)}function xy(e,t,r,n){j5(e.x,t.x,r.x,n?n.originX:void 0),j5(e.y,t.y,r.y,n?n.originY:void 0)}function P5(e,t,r){e.min=r.min+t.min,e.max=e.min+eo(t)}function pQ(e,t,r){P5(e.x,t.x,r.x),P5(e.y,t.y,r.y)}function F5(e,t,r){e.min=t.min-r.min,e.max=e.min+eo(t)}function yy(e,t,r){F5(e.x,t.x,r.x),F5(e.y,t.y,r.y)}function xl(e){return[e("x"),e("y")]}const eL=({current:e})=>e?e.ownerDocument.defaultView:null,O5=(e,t)=>Math.abs(e-t);function xQ(e,t){const r=O5(e.x,t.x),n=O5(e.y,t.y);return Math.sqrt(r**2+n**2)}class tL{constructor(t,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=OS(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,x=xQ(g.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!x)return;const{point:v}=g,{timestamp:w}=si;this.history.push({...v,timestamp:w});const{onStart:C,onMove:k}=this.handlers;p||(C&&C(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),k&&k(this.lastMoveEvent,g)},this.handlePointerMove=(g,p)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=FS(p,this.transformPagePoint),gs.update(this.updatePoint,!0)},this.handlePointerUp=(g,p)=>{this.end();const{onEnd:x,onSessionEnd:v,resumeAnimation:w}=this.handlers;if(this.dragSnapToOrigin&&w&&w(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const C=OS(g.type==="pointercancel"?this.lastMoveEventInfo:FS(p,this.transformPagePoint),this.history);this.startEvent&&x&&x(g,C),v&&v(g,C)},!BN(t))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=s||window;const o=Nv(t),c=FS(o,this.transformPagePoint),{point:u}=c,{timestamp:d}=si;this.history=[{...u,timestamp:d}];const{onSessionStart:h}=r;h&&h(t,OS(c,this.history)),this.removeListeners=Cv(py(this.contextWindow,"pointermove",this.handlePointerMove),py(this.contextWindow,"pointerup",this.handlePointerUp),py(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),_f(this.updatePoint)}}function FS(e,t){return t?{point:t(e.point)}:e}function D5(e,t){return{x:e.x-t.x,y:e.y-t.y}}function OS({point:e},t){return{point:e,delta:D5(e,rL(t)),offset:D5(e,yQ(t)),velocity:vQ(t,.1)}}function yQ(e){return e[0]}function rL(e){return e[e.length-1]}function vQ(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=rL(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>Vc(t)));)r--;if(!n)return{x:0,y:0};const a=Kc(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const i={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function wQ(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?ws(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?ws(r,e,n.max):Math.min(e,r)),e}function I5(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function bQ(e,{top:t,left:r,bottom:n,right:s}){return{x:I5(e.x,r,s),y:I5(e.y,t,n)}}function R5(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function _Q(e,t){return{x:R5(e.x,t.x),y:R5(e.y,t.y)}}function SQ(e,t){let r=.5;const n=eo(e),s=eo(t);return s>n?r=Ry(t.min,t.max-n,e.min):n>s&&(r=Ry(e.min,e.max-s,t.min)),Ju(0,1,r)}function kQ(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const NT=.35;function CQ(e=NT){return e===!1?e=0:e===!0&&(e=NT),{x:M5(e,"left","right"),y:M5(e,"top","bottom")}}function M5(e,t,r){return{min:L5(e,t),max:L5(e,r)}}function L5(e,t){return typeof e=="number"?e:e[t]||0}const TQ=new WeakMap;class EQ{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ys(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const a=h=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Nv(h).point)},i=(h,g)=>{const{drag:p,dragPropagation:x,onDragStart:v}=this.getProps();if(p&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=IY(p),!this.openDragLock))return;this.latestPointerEvent=h,this.latestPanInfo=g,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),xl(C=>{let k=this.getAxisMotionValue(C).get()||0;if(qc.test(k)){const{projection:b}=this.visualElement;if(b&&b.layout){const N=b.layout.layoutBox[C];N&&(k=eo(N)*(parseFloat(k)/100))}}this.originPoint[C]=k}),v&&gs.postRender(()=>v(h,g)),TT(this.visualElement,"transform");const{animationState:w}=this.visualElement;w&&w.setActive("whileDrag",!0)},o=(h,g)=>{this.latestPointerEvent=h,this.latestPanInfo=g;const{dragPropagation:p,dragDirectionLock:x,onDirectionLock:v,onDrag:w}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:C}=g;if(x&&this.currentDirection===null){this.currentDirection=NQ(C),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",g.point,C),this.updateAxis("y",g.point,C),this.visualElement.render(),w&&w(h,g)},c=(h,g)=>{this.latestPointerEvent=h,this.latestPanInfo=g,this.stop(h,g),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>xl(h=>this.getAnimationState(h)==="paused"&&this.getAxisMotionValue(h).animation?.play()),{dragSnapToOrigin:d}=this.getProps();this.panSession=new tL(t,{onSessionStart:a,onStart:i,onMove:o,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:n,contextWindow:eL(this.visualElement)})}stop(t,r){const n=t||this.latestPointerEvent,s=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!s||!n)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&gs.postRender(()=>o(n,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!dw(t,s,this.currentDirection))return;const a=this.getAxisMotionValue(t);let i=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(i=wQ(i,this.constraints[t],this.elastic[t])),a.set(i)}resolveConstraints(){const{dragConstraints:t,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;t&&qg(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=bQ(n.layoutBox,t):this.constraints=!1,this.elastic=CQ(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&xl(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=kQ(n.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!qg(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=AX(n,s.root,this.visualElement.getTransformPagePoint());let i=_Q(s.layout.layoutBox,a);if(r){const o=r(TX(i));this.hasMutatedConstraints=!!o,o&&(i=B7(o))}return i}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},u=xl(d=>{if(!dw(d,r,this.currentDirection))return;let h=c&&c[d]||{};i&&(h={min:0,max:0});const g=s?200:1e6,p=s?40:1e7,x={type:"inertia",velocity:n?t[d]:0,bounceStiffness:g,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...a,...h};return this.startAxisValueAnimation(d,x)});return Promise.all(u).then(o)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return TT(this.visualElement,t),n.start(YN(t,n,0,r,this.visualElement,!1))}stopAnimation(){xl(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){xl(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){xl(r=>{const{drag:n}=this.getProps();if(!dw(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:i,max:o}=s.layout.layoutBox[r];a.set(t[r]-ws(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!qg(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};xl(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const c=o.get();s[i]=SQ({min:c,max:c},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),xl(i=>{if(!dw(i,t,null))return;const o=this.getAxisMotionValue(i),{min:c,max:u}=this.constraints[i];o.set(ws(c,u,s[i]))})}addListeners(){if(!this.visualElement.current)return;TQ.set(this.visualElement,this);const t=this.visualElement.current,r=py(t,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();qg(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),gs.read(n);const i=Uy(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(xl(d=>{const h=this.getAxisMotionValue(d);h&&(this.originPoint[d]+=c[d].translate,h.set(h.get()+c[d].translate))}),this.visualElement.render())}));return()=>{i(),r(),a(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:i=NT,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:i,dragMomentum:o}}}function dw(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function NQ(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class AQ extends Ff{constructor(t){super(t),this.removeGroupControls=Cl,this.removeListeners=Cl,this.controls=new EQ(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Cl}unmount(){this.removeGroupControls(),this.removeListeners()}}const B5=e=>(t,r)=>{e&&gs.postRender(()=>e(t,r))};class jQ extends Ff{constructor(){super(...arguments),this.removePointerDownListener=Cl}onPointerDown(t){this.session=new tL(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:eL(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:B5(t),onStart:B5(r),onMove:n,onEnd:(a,i)=>{delete this.session,s&&gs.postRender(()=>s(a,i))}}}mount(){this.removePointerDownListener=py(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Zw={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function $5(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const rx={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Dr.test(e))e=parseFloat(e);else return e;const r=$5(e,t.target.x),n=$5(e,t.target.y);return`${r}% ${n}%`}},PQ={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=Sf.parse(e);if(s.length>5)return n;const a=Sf.createTransformer(e),i=typeof s[0]!="number"?1:0,o=r.x.scale*t.x,c=r.y.scale*t.y;s[0+i]/=o,s[1+i]/=c;const u=ws(o,c,.5);return typeof s[2+i]=="number"&&(s[2+i]/=u),typeof s[3+i]=="number"&&(s[3+i]/=u),a(s)}};let DS=!1;class FQ extends S.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=t;eX(OQ),a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),DS&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),Zw.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,{projection:i}=n;return i&&(i.isPresent=a,DS=!0,s||t.layoutDependency!==r||r===void 0||t.isPresent!==a?i.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?i.promote():i.relegate()||gs.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),LN.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;DS=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function nL(e){const[t,r]=C7(),n=S.useContext(pN);return l.jsx(FQ,{...e,layoutGroup:n,switchLayoutGroup:S.useContext(M7),isPresent:t,safeToRemove:r})}const OQ={borderRadius:{...rx,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:rx,borderTopRightRadius:rx,borderBottomLeftRadius:rx,borderBottomRightRadius:rx,boxShadow:PQ};function DQ(e,t,r){const n=ji(e)?e:xm(e);return n.start(YN("",n,t,r)),n.animation}const IQ=(e,t)=>e.depth-t.depth;class RQ{constructor(){this.children=[],this.isDirty=!1}add(t){vN(this.children,t),this.isDirty=!0}remove(t){wN(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(IQ),this.isDirty=!1,this.children.forEach(t)}}function MQ(e,t){const r=bo.now(),n=({timestamp:s})=>{const a=s-r;a>=t&&(_f(n),e(a-t))};return gs.setup(n,!0),()=>_f(n)}const sL=["TopLeft","TopRight","BottomLeft","BottomRight"],LQ=sL.length,U5=e=>typeof e=="string"?parseFloat(e):e,z5=e=>typeof e=="number"||Dr.test(e);function BQ(e,t,r,n,s,a){s?(e.opacity=ws(0,r.opacity??1,$Q(n)),e.opacityExit=ws(t.opacity??1,0,UQ(n))):a&&(e.opacity=ws(t.opacity??1,r.opacity??1,n));for(let i=0;i<LQ;i++){const o=`border${sL[i]}Radius`;let c=W5(t,o),u=W5(r,o);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||z5(c)===z5(u)?(e[o]=Math.max(ws(U5(c),U5(u),n),0),(qc.test(u)||qc.test(c))&&(e[o]+="%")):e[o]=u}(t.rotate||r.rotate)&&(e.rotate=ws(t.rotate||0,r.rotate||0,n))}function W5(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const $Q=aL(0,.5,GM),UQ=aL(.5,.95,Cl);function aL(e,t,r){return n=>n<e?0:n>t?1:r(Ry(e,t,n))}function H5(e,t){e.min=t.min,e.max=t.max}function ul(e,t){H5(e.x,t.x),H5(e.y,t.y)}function G5(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function V5(e,t,r,n,s){return e-=t,e=gb(e,1/r,n),s!==void 0&&(e=gb(e,1/s,n)),e}function zQ(e,t=0,r=1,n=.5,s,a=e,i=e){if(qc.test(t)&&(t=parseFloat(t),t=ws(i.min,i.max,t/100)-i.min),typeof t!="number")return;let o=ws(a.min,a.max,n);e===a&&(o-=t),e.min=V5(e.min,t,r,o,s),e.max=V5(e.max,t,r,o,s)}function K5(e,t,[r,n,s],a,i){zQ(e,t[r],t[n],t[s],t.scale,a,i)}const WQ=["x","scaleX","originX"],HQ=["y","scaleY","originY"];function q5(e,t,r,n){K5(e.x,t,WQ,r?r.x:void 0,n?n.x:void 0),K5(e.y,t,HQ,r?r.y:void 0,n?n.y:void 0)}function Y5(e){return e.translate===0&&e.scale===1}function iL(e){return Y5(e.x)&&Y5(e.y)}function X5(e,t){return e.min===t.min&&e.max===t.max}function GQ(e,t){return X5(e.x,t.x)&&X5(e.y,t.y)}function Q5(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function oL(e,t){return Q5(e.x,t.x)&&Q5(e.y,t.y)}function J5(e){return eo(e.x)/eo(e.y)}function Z5(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class VQ{constructor(){this.members=[]}add(t){vN(this.members,t),t.scheduleRender()}remove(t){if(wN(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function KQ(e,t,r){let n="";const s=e.x.translate/t.x,a=e.y.translate/t.y,i=r?.z||0;if((s||a||i)&&(n=`translate3d(${s}px, ${a}px, ${i}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:u,rotate:d,rotateX:h,rotateY:g,skewX:p,skewY:x}=r;u&&(n=`perspective(${u}px) ${n}`),d&&(n+=`rotate(${d}deg) `),h&&(n+=`rotateX(${h}deg) `),g&&(n+=`rotateY(${g}deg) `),p&&(n+=`skewX(${p}deg) `),x&&(n+=`skewY(${x}deg) `)}const o=e.x.scale*t.x,c=e.y.scale*t.y;return(o!==1||c!==1)&&(n+=`scale(${o}, ${c})`),n||"none"}const IS=["","X","Y","Z"],qQ=1e3;let YQ=0;function RS(e,t,r,n){const{latestValues:s}=t;s[e]&&(r[e]=s[e],t.setStaticValue(e,0),n&&(n[e]=0))}function lL(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=K7(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",gs,!(s||a))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&lL(n)}function cL({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(i={},o=t?.()){this.id=YQ++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(JQ),this.nodes.forEach(rJ),this.nodes.forEach(nJ),this.nodes.forEach(ZQ)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new RQ)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new SN),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const c=this.eventHandlers.get(i);c&&c.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=k7(i)&&!UY(i),this.instance=i;const{layoutId:o,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||o)&&(this.isLayoutDirty=!0),e){let d,h=0;const g=()=>this.root.updateBlockedByResize=!1;gs.read(()=>{h=window.innerWidth}),e(i,()=>{const p=window.innerWidth;p!==h&&(h=p,this.root.updateBlockedByResize=!0,d&&d(),d=MQ(g,250),Zw.hasAnimatedSinceResize&&(Zw.hasAnimatedSinceResize=!1,this.nodes.forEach(r6)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:h,hasRelativeLayoutChanged:g,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||u.getDefaultTransition()||lJ,{onLayoutAnimationStart:v,onLayoutAnimationComplete:w}=u.getProps(),C=!this.targetLayout||!oL(this.targetLayout,p),k=!h&&g;if(this.options.layoutRoot||this.resumeFrom||k||h&&(C||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const b={...RN(x,"layout"),onPlay:v,onComplete:w};(u.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b),this.setAnimationOrigin(d,k)}else h||r6(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),_f(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(sJ),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&lL(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const h=this.path[d];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(e6);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(t6);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(tJ),this.nodes.forEach(XQ),this.nodes.forEach(QQ)):this.nodes.forEach(t6),this.clearAllSnapshots();const o=bo.now();si.delta=Ju(0,1e3/60,o-si.timestamp),si.timestamp=o,si.isProcessing=!0,kS.update.process(si),kS.preRender.process(si),kS.render.process(si),si.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,LN.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(eJ),this.sharedNodes.forEach(aJ)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,gs.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){gs.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!eo(this.snapshot.measuredBox.x)&&!eo(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ys(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o&&this.instance){const c=n(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!iL(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;i&&this.instance&&(o||Ch(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return i&&(c=this.removeTransform(c)),cJ(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:i}=this.options;if(!i)return Ys();const o=i.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(uJ))){const{scroll:u}=this.root;u&&(Yg(o.x,u.offset.x),Yg(o.y,u.offset.y))}return o}removeElementScroll(i){const o=Ys();if(ul(o,i),this.scroll?.wasRoot)return o;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&ul(o,i),Yg(o.x,d.offset.x),Yg(o.y,d.offset.y))}return o}applyTransform(i,o=!1){const c=Ys();ul(c,i);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Xg(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Ch(d.latestValues)&&Xg(c,d.latestValues)}return Ch(this.latestValues)&&Xg(c,this.latestValues),c}removeTransform(i){const o=Ys();ul(o,i);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!Ch(u.latestValues))continue;_T(u.latestValues)&&u.updateSnapshot();const d=Ys(),h=u.measurePageBox();ul(d,h),q5(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Ch(this.latestValues)&&q5(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==si.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==o;if(!(i||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:h}=this.options;if(!(!this.layout||!(d||h))){if(this.resolvedRelativeTargetAt=si.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ys(),this.relativeTargetOrigin=Ys(),yy(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),ul(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Ys(),this.targetWithTransforms=Ys()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),pQ(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ul(this.target,this.layout.layoutBox),U7(this.target,this.targetDelta)):ul(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ys(),this.relativeTargetOrigin=Ys(),yy(this.relativeTargetOrigin,this.target,g.target),ul(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||_T(this.parent.latestValues)||$7(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const i=this.getLead(),o=!!this.resumingFrom||this!==i;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===si.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;ul(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,g=this.treeScale.y;NX(this.layoutCorrected,this.treeScale,this.path,o),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Ys());const{target:p}=i;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(G5(this.prevProjectionDelta.x,this.projectionDelta.x),G5(this.prevProjectionDelta.y,this.projectionDelta.y)),xy(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==g||!Z5(this.projectionDelta.x,this.prevProjectionDelta.x)||!Z5(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){if(this.options.visualElement?.scheduleRender(),i){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Qg(),this.projectionDelta=Qg(),this.projectionDeltaWithTransform=Qg()}setAnimationOrigin(i,o=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},h=Qg();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const g=Ys(),p=c?c.source:void 0,x=this.layout?this.layout.source:void 0,v=p!==x,w=this.getStack(),C=!w||w.members.length<=1,k=!!(v&&!C&&this.options.crossfade===!0&&!this.path.some(oJ));this.animationProgress=0;let b;this.mixTargetDelta=N=>{const E=N/1e3;n6(h.x,i.x,E),n6(h.y,i.y,E),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(yy(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),iJ(this.relativeTarget,this.relativeTargetOrigin,g,E),b&&GQ(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=Ys()),ul(b,this.relativeTarget)),v&&(this.animationValues=d,BQ(d,u,this.latestValues,E,k,C)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=E},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(_f(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=gs.update(()=>{Zw.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=xm(0)),this.currentAnimation=DQ(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:o=>{this.mixTargetDelta(o),i.onUpdate&&i.onUpdate(o)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(qQ),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:c,layout:u,latestValues:d}=i;if(!(!o||!c||!u)){if(this!==i&&this.layout&&u&&uL(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Ys();const h=eo(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+h;const g=eo(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+g}ul(o,c),Xg(o,d),xy(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new VQ),this.sharedNodes.get(i).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){const{layoutId:i}=this.options;return i?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:i}=this.options;return i?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const u={};c.z&&RS("z",i,u,this.animationValues);for(let d=0;d<IS.length;d++)RS(`rotate${IS[d]}`,i,u,this.animationValues),RS(`skew${IS[d]}`,i,u,this.animationValues);i.render();for(const d in u)i.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);i.scheduleRender()}applyProjectionStyles(i,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=Jw(o?.pointerEvents)||"",i.transform=c?c(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=Jw(o?.pointerEvents)||""),this.hasProjected&&!Ch(this.latestValues)&&(i.transform=c?c({},""):"none",this.hasProjected=!1);return}i.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let h=KQ(this.projectionDeltaWithTransform,this.treeScale,d);c&&(h=c(d,h)),i.transform=h;const{x:g,y:p}=this.projectionDelta;i.transformOrigin=`${g.origin*100}% ${p.origin*100}% 0`,u.animationValues?i.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:i.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const x in $y){if(d[x]===void 0)continue;const{correct:v,applyTo:w,isCSSVariable:C}=$y[x],k=h==="none"?d[x]:v(d[x],u);if(w){const b=w.length;for(let N=0;N<b;N++)i[w[N]]=k}else C?this.options.visualElement.renderState.vars[x]=k:i[x]=k}this.options.layoutId&&(i.pointerEvents=u===this?Jw(o?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>i.currentAnimation?.stop()),this.root.nodes.forEach(e6),this.root.sharedNodes.clear()}}}function XQ(e){e.updateLayout()}function QQ(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:n}=e.layout,{animationType:s}=e.options,a=t.source!==e.layout.source;s==="size"?xl(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],g=eo(h);h.min=r[d].min,h.max=h.min+g}):uL(s,t.layoutBox,r)&&xl(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],g=eo(r[d]);h.max=h.min+g,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+g)});const i=Qg();xy(i,r,t.layoutBox);const o=Qg();a?xy(o,e.applyTransform(n,!0),t.measuredBox):xy(o,r,t.layoutBox);const c=!iL(i);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:g}=d;if(h&&g){const p=Ys();yy(p,t.layoutBox,h.layoutBox);const x=Ys();yy(x,r,g.layoutBox),oL(p,x)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=x,e.relativeTargetOrigin=p,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:o,layoutDelta:i,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function JQ(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function ZQ(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function eJ(e){e.clearSnapshot()}function e6(e){e.clearMeasurements()}function t6(e){e.isLayoutDirty=!1}function tJ(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function r6(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function rJ(e){e.resolveTargetDelta()}function nJ(e){e.calcProjection()}function sJ(e){e.resetSkewAndRotation()}function aJ(e){e.removeLeadSnapshot()}function n6(e,t,r){e.translate=ws(t.translate,0,r),e.scale=ws(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function s6(e,t,r,n){e.min=ws(t.min,r.min,n),e.max=ws(t.max,r.max,n)}function iJ(e,t,r,n){s6(e.x,t.x,r.x,n),s6(e.y,t.y,r.y,n)}function oJ(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const lJ={duration:.45,ease:[.4,0,.1,1]},a6=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),i6=a6("applewebkit/")&&!a6("chrome/")?Math.round:Cl;function o6(e){e.min=i6(e.min),e.max=i6(e.max)}function cJ(e){o6(e.x),o6(e.y)}function uL(e,t,r){return e==="position"||e==="preserve-aspect"&&!mQ(J5(t),J5(r),.2)}function uJ(e){return e!==e.root&&e.scroll?.wasRoot}const dJ=cL({attachResizeListener:(e,t)=>Uy(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),MS={current:void 0},dL=cL({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!MS.current){const e=new dJ({});e.mount(window),e.setOptions({layoutScroll:!0}),MS.current=e}return MS.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),fJ={pan:{Feature:jQ},drag:{Feature:AQ,ProjectionNode:dL,MeasureLayout:nL}};function l6(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,a=n[s];a&&gs.postRender(()=>a(t,Nv(t)))}class hJ extends Ff{mount(){const{current:t}=this.node;t&&(this.unmount=RY(t,(r,n)=>(l6(this.node,n,"Start"),s=>l6(this.node,s,"End"))))}unmount(){}}class gJ extends Ff{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Cv(Uy(this.node.current,"focus",()=>this.onFocus()),Uy(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function c6(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),a=n[s];a&&gs.postRender(()=>a(t,Nv(t)))}class mJ extends Ff{mount(){const{current:t}=this.node;t&&(this.unmount=$Y(t,(r,n)=>(c6(this.node,n,"Start"),(s,{success:a})=>c6(this.node,s,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const AT=new WeakMap,LS=new WeakMap,pJ=e=>{const t=AT.get(e.target);t&&t(e)},xJ=e=>{e.forEach(pJ)};function yJ({root:e,...t}){const r=e||document;LS.has(r)||LS.set(r,{});const n=LS.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(xJ,{root:e,...t})),n[s]}function vJ(e,t,r){const n=yJ(t);return AT.set(e,r),n.observe(e),()=>{AT.delete(e),n.unobserve(e)}}const wJ={some:0,all:1};class bJ extends Ff{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=t,i={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:wJ[s]},o=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:h}=this.node.getProps(),g=u?d:h;g&&g(c)};return vJ(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(_J(t,r))&&this.startObserver()}unmount(){}}function _J({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const SJ={inView:{Feature:bJ},tap:{Feature:mJ},focus:{Feature:gJ},hover:{Feature:hJ}},kJ={layout:{ProjectionNode:dL,MeasureLayout:nL}},CJ={...cQ,...SJ,...fJ,...kJ},nt=CX(CJ,LX),Ye=({children:e,variant:t="primary",size:r="md",onClick:n,disabled:s=!1,className:a="",...i})=>{const o="font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer",c={primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",success:"bg-green-600 hover:bg-green-700 text-white focus:ring-green-500",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500",warning:"bg-yellow-600 hover:bg-yellow-700 text-white focus:ring-yellow-500",outline:"bg-transparent text-blue-600 border-2 border-blue-600 hover:bg-blue-600 hover:text-white focus:ring-blue-500",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-500"},u={xs:"px-2 py-1 text-xs",sm:"px-2 py-1 text-xs sm:px-3 sm:py-1.5 sm:text-sm",md:"px-3 py-1.5 text-sm sm:px-4 sm:py-2 sm:text-base",lg:"px-4 py-2 text-base sm:px-6 sm:py-3 sm:text-lg",icon:"p-0 flex items-center justify-center"},d=s?"opacity-50 cursor-not-allowed":"";return l.jsx(nt.button,{className:`${o} ${c[t]} ${u[r]} ${d} ${a}`,onClick:n,disabled:s,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},...i,children:e})},zr=({size:e="md",color:t="blue",className:r=""})=>{const n={sm:"w-4 h-4",small:"w-4 h-4",md:"w-6 h-6",medium:"w-6 h-6",lg:"w-8 h-8",large:"w-8 h-8",xl:"w-12 h-12"},s={blue:"border-blue-600",green:"border-green-600",red:"border-red-600",yellow:"border-yellow-600",gray:"border-gray-600"};return l.jsx(nt.div,{className:`
        inline-block border-2 border-gray-300 border-t-current rounded-full animate-spin
        ${n[e]} ${s[t]} ${r}
      `,animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})},uc=({type:e="info",message:t="",duration:r=3e3,closable:n=!0,onClose:s,className:a="",...i})=>{const[o,c]=S.useState(!0),[u,d]=S.useState(!1),h=S.useRef(null),g=S.useRef(null);S.useEffect(()=>{if(r>0)return g.current=setTimeout(()=>{p()},r),()=>{g.current&&clearTimeout(g.current)}},[r]);const p=S.useCallback(()=>{u||(d(!0),g.current&&clearTimeout(g.current),setTimeout(()=>{c(!1),s&&s()},300))},[u,s]),x=S.useCallback(C=>{C.key==="Escape"&&p()},[p]);if(!o)return null;const v=["notification",`notification-${e}`,o?"notification-visible":"",u?"notification-exiting":"",a].filter(Boolean).join(" "),w=()=>{switch(e){case"success":return"";case"error":return"";case"warning":return"";case"info":default:return""}};return l.jsx("div",{ref:h,className:v,role:"alert","aria-live":"polite",onKeyDown:x,tabIndex:-1,...i,children:l.jsxs("div",{className:"notification-content",children:[l.jsx("div",{className:"notification-icon","aria-hidden":"true",children:w()}),l.jsx("div",{className:"notification-body",children:l.jsx("div",{className:"notification-message",children:t})}),n&&l.jsx("button",{className:"notification-close",onClick:p,type:"button","aria-label":"Close notification",children:""})]})})},za=()=>{const[e,t]=S.useState([]),r=S.useCallback((a,i="info",o={})=>{const c=Date.now()+Math.random(),u={id:c,message:a,type:i,...o};return t(d=>[...d,u]),o.duration!==0&&setTimeout(()=>{n(c)},o.duration||3e3),c},[]),n=S.useCallback(a=>{t(i=>i.filter(o=>o.id!==a))},[]),s=S.useCallback(()=>{t([])},[]);return{notifications:e,showNotification:r,removeNotification:n,clearAllNotifications:s}},Qo=()=>{const[e,t]=S.useState(!1),[r,n]=S.useState(null),[s,a]=S.useState(null),i=S.useRef(null);S.useRef(new Map);const o=S.useRef(0),c=3,u=1e3,d=S.useCallback(()=>{i.current&&(i.current.abort(),i.current=null)},[]);S.useEffect(()=>d,[d]);const h=S.useCallback(async(R,U={})=>{try{t(!0),n(null),i.current=new AbortController;const q=U.method||"POST",Q={method:q,headers:{"Content-Type":"application/json",...U.headers},signal:i.current.signal,...U};q!=="GET"&&q!=="HEAD"&&(Q.body=JSON.stringify(U.data||{})),console.log(`[API] Making request to: ${R}`,Q);const se=await fetch(R,Q);if(!se.ok)throw new Error(`HTTP error! status: ${se.status}`);const X=await se.json();if(console.log("[API] Response received:",X),X.success)return a(X),o.current=0,X;throw new Error(X.error||X.message||"Request failed")}catch(q){if(q.name==="AbortError")return console.log("[API] Request was aborted"),null;if(console.error("[API] Request failed:",q),n(q.message||"Request failed"),o.current<c){o.current++;const Q=u*Math.pow(2,o.current-1);return console.log(`[API] Retrying in ${Q}ms (attempt ${o.current}/${c})`),await new Promise(se=>setTimeout(se,Q)),h(R,U)}throw q}finally{t(!1),i.current=null}},[]),g=S.useCallback(async(R,U={})=>{try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");return await window.tokenManager.makeAuthenticatedRequest(R,U)}catch(q){throw console.error("[API] Authenticated request failed:",q),q}},[]),p=S.useCallback(async(R,U)=>{try{const q=`/.netlify/functions/get-test-questions?test_type=${R}&test_id=${U}`;console.log(`[API] Getting test info for ${R}_${U}`);const se=await(await g(q)).json();if(se.success)return console.log("[API] Test info retrieved successfully:",se.test_info),se.test_info;throw new Error(se.error||"Failed to get test info")}catch(q){throw console.error("[API] Failed to get test info:",q),q}},[g]),x=S.useCallback(async(R,U)=>{try{const q=`/.netlify/functions/get-test-questions?test_type=${R}&test_id=${U}`;console.log(`[API] Getting test questions for ${R}_${U}`);const se=await(await g(q)).json();if(se.success)return console.log("[API] Test questions retrieved successfully:",se.questions),se.questions;throw new Error(se.error||"Failed to get test questions")}catch(q){throw console.error("[API] Failed to get test questions:",q),q}},[g]),v=S.useCallback(async()=>{try{const R="/.netlify/functions/get-student-active-tests";console.log("[API] Loading student active tests");const q=await(await g(R)).json();if(q.success)return console.log("[API] Student active tests loaded successfully:",q.tests),q.tests;throw new Error(q.error||"Failed to load student active tests")}catch(R){throw console.error("[API] Failed to load student active tests:",R),R}},[g]),w=S.useCallback(async(R,U,q)=>{try{let Q;switch(R){case"true_false":Q="/.netlify/functions/submit-true-false-test";break;case"multiple_choice":Q="/.netlify/functions/submit-multiple-choice-test";break;case"input":Q="/.netlify/functions/submit-input-test";break;case"matching_type":Q="/.netlify/functions/submit-matching-type-test";break;case"speaking":Q="/.netlify/functions/submit-speaking-test";break;default:throw new Error(`Unknown test type: ${R}`)}console.log(`[API] Submitting ${R} test:`,q);const X=await(await g(Q,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(q)})).json();if(X.success)return console.log("[API] Test submitted successfully:",X),X;throw new Error(X.error||"Failed to submit test")}catch(Q){throw console.error("[API] Failed to submit test:",Q),Q}},[g]),C=S.useCallback(async R=>{try{const U="/.netlify/functions/save-multiple-choice-test";console.log("[API] Saving multiple choice test:",R);const Q=await(await g(U,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(Q.success)return console.log("[API] Multiple choice test saved successfully:",Q),Q;throw new Error(Q.error||"Failed to save multiple choice test")}catch(U){throw console.error("[API] Failed to save multiple choice test:",U),U}},[g]),k=S.useCallback(async R=>{try{const U="/.netlify/functions/save-true-false-test";console.log("[API] Saving true/false test:",R);const Q=await(await g(U,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(Q.success)return console.log("[API] True/false test saved successfully:",Q),Q;throw new Error(Q.error||"Failed to save true/false test")}catch(U){throw console.error("[API] Failed to save true/false test:",U),U}},[g]),b=S.useCallback(async R=>{try{const U="/.netlify/functions/save-input-test";console.log("[API] Saving input test:",R);const Q=await(await g(U,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(Q.success)return console.log("[API] Input test saved successfully:",Q),Q;throw new Error(Q.error||"Failed to save input test")}catch(U){throw console.error("[API] Failed to save input test:",U),U}},[g]),N=S.useCallback(async R=>{try{const U="/.netlify/functions/assign-test";console.log("[API] Assigning test to classes:",R);const Q=await(await g(U,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(Q.success)return console.log("[API] Test assigned successfully:",Q),Q;throw new Error(Q.error||"Failed to assign test")}catch(U){throw console.error("[API] Failed to assign test:",U),U}},[g]),E=S.useCallback(async()=>{try{const R="/.netlify/functions/get-teacher-active-tests";console.log("[API] Loading teacher active tests");const q=await(await g(R)).json();if(q.success)return console.log("[API] Teacher active tests loaded successfully:",q.tests),q.tests;throw new Error(q.error||"Failed to load teacher active tests")}catch(R){throw console.error("[API] Failed to load teacher active tests:",R),R}},[g]),P=S.useCallback(async()=>{try{const R="/.netlify/functions/get-all-users";console.log("[API] Getting all users");const q=await(await g(R)).json();if(q.success)return console.log("[API] All users loaded successfully:",q.users),q.users;throw new Error(q.error||"Failed to get all users")}catch(R){throw console.error("[API] Failed to get all users:",R),R}},[g]),F=S.useCallback(async()=>{try{const R="/.netlify/functions/get-all-teachers";console.log("[API] Getting all teachers");const q=await(await g(R)).json();if(q.success)return console.log("[API] All teachers loaded successfully:",q.teachers),q.teachers;throw new Error(q.error||"Failed to get all teachers")}catch(R){throw console.error("[API] Failed to get all teachers:",R),R}},[g]),A=S.useCallback(async()=>{try{const R="/.netlify/functions/get-all-subjects";console.log("[API] Getting all subjects");const q=await(await g(R)).json();if(q.success)return console.log("[API] All subjects loaded successfully:",q.subjects),q.subjects;throw new Error(q.error||"Failed to get all subjects")}catch(R){throw console.error("[API] Failed to get all subjects:",R),R}},[g]),j=S.useCallback(()=>{n(null)},[]),I=S.useCallback(()=>{a(null)},[]),B=S.useCallback(()=>{t(!1),n(null),a(null),o.current=0,d()},[d]),Y=S.useCallback(async(R,U={})=>{const Q=await(await g(R,{...U,method:"GET"})).json();if(Q.success)return Q;throw new Error(Q.error||"Request failed")},[g]),Z=S.useCallback(async(R,U,q={})=>{const se=await(await g(R,{...q,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)})).json();if(se.success)return se;throw new Error(se.error||"Request failed")},[g]),ae=S.useCallback(async(R,U,q={})=>{const se=await(await g(R,{...q,method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)})).json();if(se.success)return se;throw new Error(se.error||"Request failed")},[g]),ee=S.useCallback(async(R,U={})=>{const Q=await(await g(R,{...U,method:"DELETE"})).json();if(Q.success)return Q;throw new Error(Q.error||"Request failed")},[g]),ne=S.useCallback(async R=>{try{const U="/.netlify/functions/submit-speaking-test";console.log("[API] Submitting speaking test:",R);const Q=await(await g(U,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(Q.success)return console.log("[API] Speaking test submitted successfully:",Q),Q;throw new Error(Q.error||"Failed to submit speaking test")}catch(U){throw console.error("[API] Failed to submit speaking test:",U),U}},[g]),L=S.useCallback(async R=>{try{const U=`/.netlify/functions/get-speaking-test-new?action=test&test_id=${R}`;console.log("[API] Getting speaking test:",R);const Q=await(await g(U,{method:"GET"})).json();if(Q.success)return console.log("[API] Speaking test loaded successfully:",Q),Q;throw new Error(Q.error||"Failed to load speaking test")}catch(U){throw console.error("[API] Failed to load speaking test:",U),U}},[g]),H=S.useCallback(async R=>{try{const U=`/.netlify/functions/get-speaking-test-new?action=questions&test_id=${R}`;console.log("[API] Getting speaking test questions:",R);const Q=await(await g(U,{method:"GET"})).json();if(Q.success)return console.log("[API] Speaking test questions loaded successfully:",Q),Q;throw new Error(Q.error||"Failed to load speaking test questions")}catch(U){throw console.error("[API] Failed to load speaking test questions:",U),U}},[g]),M=S.useCallback(async R=>{try{const U="/.netlify/functions/upload-speaking-audio";console.log("[API] Uploading speaking audio");const Q=await(await g(U,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(Q.success)return console.log("[API] Audio uploaded successfully:",Q),Q;throw new Error(Q.error||"Failed to upload audio")}catch(U){throw console.error("[API] Failed to upload audio:",U),U}},[g]),V=S.useCallback(async R=>{try{const U=`/.netlify/functions/get-speaking-test-new?action=audio&file_path=${encodeURIComponent(R)}`;console.log("[API] Getting speaking audio:",R);const Q=await(await g(U,{method:"GET"})).json();if(Q.success)return console.log("[API] Audio URL retrieved successfully:",Q),Q;throw new Error(Q.error||"Failed to get audio")}catch(U){throw console.error("[API] Failed to get audio:",U),U}},[g]),W=S.useCallback(async(R,U)=>{try{const q=`/.netlify/functions/check-test-completion?test_id=${R}&test_type=${U}`;console.log("[API] Checking test completion:",R,U);const se=await(await g(q,{method:"GET"})).json();if(se.success)return console.log("[API] Test completion status:",se),se;throw new Error(se.error||"Failed to check test completion")}catch(q){throw console.error("[API] Failed to check test completion:",q),q}},[g]);return{loading:e,error:r,data:s,sendRequest:h,makeAuthenticatedRequest:g,get:Y,post:Z,put:ae,delete:ee,getTestInfo:p,getTestQuestions:x,loadStudentActiveTests:v,submitTest:w,submitSpeakingTest:ne,getSpeakingTest:L,getSpeakingTestQuestions:H,uploadSpeakingAudio:M,getSpeakingAudio:V,checkTestCompletion:W,saveMultipleChoiceTest:C,saveTrueFalseTest:k,saveInputTest:b,assignTestToClasses:N,loadTeacherActiveTests:E,getAllUsers:P,getAllTeachers:F,getAllSubjects:A,clearError:j,clearData:I,reset:B,cleanup:d}},TJ="modulepreload",EJ=function(e){return"/"+e},u6={},Zi=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){let u=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};var i=u;document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");s=u(r.map(d=>{if(d=EJ(d),d in u6)return;u6[d]=!0;const h=d.endsWith(".css"),g=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${g}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":TJ,h||(p.as="script"),p.crossOrigin="",p.href=d,c&&p.setAttribute("nonce",c),document.head.appendChild(p),h)return new Promise((x,v)=>{p.addEventListener("load",x),p.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return t().catch(a)})};var eb={exports:{}},nx={},BS={},$S={},d6;function tn(){return d6||(d6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const t=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}e.glob=typeof cb<"u"?cb:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},e.Konva={_global:e.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(s){}).toString()),dblClickWindow:400,getAngle(s){return e.Konva.angleDeg?s*t:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva.DD.isDragging},isTransforming(){var s;return(s=e.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!e.Konva.DD.node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(s){e.glob.Konva=s}};const n=s=>{e.Konva[s.prototype.getClassName()]=s};e._registerNode=n,e.Konva._injectGlobal(e.Konva)})($S)),$S}var US={},f6;function Bs(){return f6||(f6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const t=tn();class r{constructor(N=[1,0,0,1,0,0]){this.dirty=!1,this.m=N&&N.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(N){N.m[0]=this.m[0],N.m[1]=this.m[1],N.m[2]=this.m[2],N.m[3]=this.m[3],N.m[4]=this.m[4],N.m[5]=this.m[5]}point(N){const E=this.m;return{x:E[0]*N.x+E[2]*N.y+E[4],y:E[1]*N.x+E[3]*N.y+E[5]}}translate(N,E){return this.m[4]+=this.m[0]*N+this.m[2]*E,this.m[5]+=this.m[1]*N+this.m[3]*E,this}scale(N,E){return this.m[0]*=N,this.m[1]*=N,this.m[2]*=E,this.m[3]*=E,this}rotate(N){const E=Math.cos(N),P=Math.sin(N),F=this.m[0]*E+this.m[2]*P,A=this.m[1]*E+this.m[3]*P,j=this.m[0]*-P+this.m[2]*E,I=this.m[1]*-P+this.m[3]*E;return this.m[0]=F,this.m[1]=A,this.m[2]=j,this.m[3]=I,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(N,E){const P=this.m[0]+this.m[2]*E,F=this.m[1]+this.m[3]*E,A=this.m[2]+this.m[0]*N,j=this.m[3]+this.m[1]*N;return this.m[0]=P,this.m[1]=F,this.m[2]=A,this.m[3]=j,this}multiply(N){const E=this.m[0]*N.m[0]+this.m[2]*N.m[1],P=this.m[1]*N.m[0]+this.m[3]*N.m[1],F=this.m[0]*N.m[2]+this.m[2]*N.m[3],A=this.m[1]*N.m[2]+this.m[3]*N.m[3],j=this.m[0]*N.m[4]+this.m[2]*N.m[5]+this.m[4],I=this.m[1]*N.m[4]+this.m[3]*N.m[5]+this.m[5];return this.m[0]=E,this.m[1]=P,this.m[2]=F,this.m[3]=A,this.m[4]=j,this.m[5]=I,this}invert(){const N=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),E=this.m[3]*N,P=-this.m[1]*N,F=-this.m[2]*N,A=this.m[0]*N,j=N*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),I=N*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=E,this.m[1]=P,this.m[2]=F,this.m[3]=A,this.m[4]=j,this.m[5]=I,this}getMatrix(){return this.m}decompose(){const N=this.m[0],E=this.m[1],P=this.m[2],F=this.m[3],A=this.m[4],j=this.m[5],I=N*F-E*P,B={x:A,y:j,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(N!=0||E!=0){const Y=Math.sqrt(N*N+E*E);B.rotation=E>0?Math.acos(N/Y):-Math.acos(N/Y),B.scaleX=Y,B.scaleY=I/Y,B.skewX=(N*P+E*F)/I,B.skewY=0}else if(P!=0||F!=0){const Y=Math.sqrt(P*P+F*F);B.rotation=Math.PI/2-(F>0?Math.acos(-P/Y):-Math.acos(P/Y)),B.scaleX=I/Y,B.scaleY=Y,B.skewX=0,B.skewY=(N*P+E*F)/I}return B.rotation=e.Util._getRotation(B.rotation),B}}e.Transform=r;const n="[object Array]",s="[object Number]",a="[object String]",i="[object Boolean]",o=Math.PI/180,c=180/Math.PI,u="#",d="",h="0",g="Konva warning: ",p="Konva error: ",x="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},w=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let C=[];const k=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(b){setTimeout(b,60)};e.Util={_isElement(b){return!!(b&&b.nodeType==1)},_isFunction(b){return!!(b&&b.constructor&&b.call&&b.apply)},_isPlainObject(b){return!!b&&b.constructor===Object},_isArray(b){return Object.prototype.toString.call(b)===n},_isNumber(b){return Object.prototype.toString.call(b)===s&&!isNaN(b)&&isFinite(b)},_isString(b){return Object.prototype.toString.call(b)===a},_isBoolean(b){return Object.prototype.toString.call(b)===i},isObject(b){return b instanceof Object},isValidSelector(b){if(typeof b!="string")return!1;const N=b[0];return N==="#"||N==="."||N===N.toUpperCase()},_sign(b){return b===0||b>0?1:-1},requestAnimFrame(b){C.push(b),C.length===1&&k(function(){const N=C;C=[],N.forEach(function(E){E()})})},createCanvasElement(){const b=document.createElement("canvas");try{b.style=b.style||{}}catch{}return b},createImageElement(){return document.createElement("img")},_isInDocument(b){for(;b=b.parentNode;)if(b==document)return!0;return!1},_urlToImage(b,N){const E=e.Util.createImageElement();E.onload=function(){N(E)},E.src=b},_rgbToHex(b,N,E){return((1<<24)+(b<<16)+(N<<8)+E).toString(16).slice(1)},_hexToRgb(b){b=b.replace(u,d);const N=parseInt(b,16);return{r:N>>16&255,g:N>>8&255,b:N&255}},getRandomColor(){let b=(Math.random()*16777215<<0).toString(16);for(;b.length<6;)b=h+b;return u+b},getRGB(b){let N;return b in v?(N=v[b],{r:N[0],g:N[1],b:N[2]}):b[0]===u?this._hexToRgb(b.substring(1)):b.substr(0,4)===x?(N=w.exec(b.replace(/ /g,"")),{r:parseInt(N[1],10),g:parseInt(N[2],10),b:parseInt(N[3],10)}):{r:0,g:0,b:0}},colorToRGBA(b){return b=b||"black",e.Util._namedColorToRBA(b)||e.Util._hex3ColorToRGBA(b)||e.Util._hex4ColorToRGBA(b)||e.Util._hex6ColorToRGBA(b)||e.Util._hex8ColorToRGBA(b)||e.Util._rgbColorToRGBA(b)||e.Util._rgbaColorToRGBA(b)||e.Util._hslColorToRGBA(b)},_namedColorToRBA(b){const N=v[b.toLowerCase()];return N?{r:N[0],g:N[1],b:N[2],a:1}:null},_rgbColorToRGBA(b){if(b.indexOf("rgb(")===0){b=b.match(/rgb\(([^)]+)\)/)[1];const N=b.split(/ *, */).map(Number);return{r:N[0],g:N[1],b:N[2],a:1}}},_rgbaColorToRGBA(b){if(b.indexOf("rgba(")===0){b=b.match(/rgba\(([^)]+)\)/)[1];const N=b.split(/ *, */).map((E,P)=>E.slice(-1)==="%"?P===3?parseInt(E)/100:parseInt(E)/100*255:Number(E));return{r:N[0],g:N[1],b:N[2],a:N[3]}}},_hex8ColorToRGBA(b){if(b[0]==="#"&&b.length===9)return{r:parseInt(b.slice(1,3),16),g:parseInt(b.slice(3,5),16),b:parseInt(b.slice(5,7),16),a:parseInt(b.slice(7,9),16)/255}},_hex6ColorToRGBA(b){if(b[0]==="#"&&b.length===7)return{r:parseInt(b.slice(1,3),16),g:parseInt(b.slice(3,5),16),b:parseInt(b.slice(5,7),16),a:1}},_hex4ColorToRGBA(b){if(b[0]==="#"&&b.length===5)return{r:parseInt(b[1]+b[1],16),g:parseInt(b[2]+b[2],16),b:parseInt(b[3]+b[3],16),a:parseInt(b[4]+b[4],16)/255}},_hex3ColorToRGBA(b){if(b[0]==="#"&&b.length===4)return{r:parseInt(b[1]+b[1],16),g:parseInt(b[2]+b[2],16),b:parseInt(b[3]+b[3],16),a:1}},_hslColorToRGBA(b){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(b)){const[N,...E]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(b),P=Number(E[0])/360,F=Number(E[1])/100,A=Number(E[2])/100;let j,I,B;if(F===0)return B=A*255,{r:Math.round(B),g:Math.round(B),b:Math.round(B),a:1};A<.5?j=A*(1+F):j=A+F-A*F;const Y=2*A-j,Z=[0,0,0];for(let ae=0;ae<3;ae++)I=P+1/3*-(ae-1),I<0&&I++,I>1&&I--,6*I<1?B=Y+(j-Y)*6*I:2*I<1?B=j:3*I<2?B=Y+(j-Y)*(2/3-I)*6:B=Y,Z[ae]=B*255;return{r:Math.round(Z[0]),g:Math.round(Z[1]),b:Math.round(Z[2]),a:1}}},haveIntersection(b,N){return!(N.x>b.x+b.width||N.x+N.width<b.x||N.y>b.y+b.height||N.y+N.height<b.y)},cloneObject(b){const N={};for(const E in b)this._isPlainObject(b[E])?N[E]=this.cloneObject(b[E]):this._isArray(b[E])?N[E]=this.cloneArray(b[E]):N[E]=b[E];return N},cloneArray(b){return b.slice(0)},degToRad(b){return b*o},radToDeg(b){return b*c},_degToRad(b){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(b)},_radToDeg(b){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(b)},_getRotation(b){return t.Konva.angleDeg?e.Util.radToDeg(b):b},_capitalize(b){return b.charAt(0).toUpperCase()+b.slice(1)},throw(b){throw new Error(p+b)},error(b){console.error(p+b)},warn(b){t.Konva.showWarnings&&console.warn(g+b)},each(b,N){for(const E in b)N(E,b[E])},_inRange(b,N,E){return N<=b&&b<E},_getProjectionToSegment(b,N,E,P,F,A){let j,I,B;const Y=(b-E)*(b-E)+(N-P)*(N-P);if(Y==0)j=b,I=N,B=(F-E)*(F-E)+(A-P)*(A-P);else{const Z=((F-b)*(E-b)+(A-N)*(P-N))/Y;Z<0?(j=b,I=N,B=(b-F)*(b-F)+(N-A)*(N-A)):Z>1?(j=E,I=P,B=(E-F)*(E-F)+(P-A)*(P-A)):(j=b+Z*(E-b),I=N+Z*(P-N),B=(j-F)*(j-F)+(I-A)*(I-A))}return[j,I,B]},_getProjectionToLine(b,N,E){const P=e.Util.cloneObject(b);let F=Number.MAX_VALUE;return N.forEach(function(A,j){if(!E&&j===N.length-1)return;const I=N[(j+1)%N.length],B=e.Util._getProjectionToSegment(A.x,A.y,I.x,I.y,b.x,b.y),Y=B[0],Z=B[1],ae=B[2];ae<F&&(P.x=Y,P.y=Z,F=ae)}),P},_prepareArrayForTween(b,N,E){const P=[],F=[];if(b.length>N.length){const j=N;N=b,b=j}for(let j=0;j<b.length;j+=2)P.push({x:b[j],y:b[j+1]});for(let j=0;j<N.length;j+=2)F.push({x:N[j],y:N[j+1]});const A=[];return F.forEach(function(j){const I=e.Util._getProjectionToLine(j,P,E);A.push(I.x),A.push(I.y)}),A},_prepareToStringify(b){let N;b.visitedByCircularReferenceRemoval=!0;for(const E in b)if(b.hasOwnProperty(E)&&b[E]&&typeof b[E]=="object"){if(N=Object.getOwnPropertyDescriptor(b,E),b[E].visitedByCircularReferenceRemoval||e.Util._isElement(b[E]))if(N.configurable)delete b[E];else return null;else if(e.Util._prepareToStringify(b[E])===null)if(N.configurable)delete b[E];else return null}return delete b.visitedByCircularReferenceRemoval,b},_assign(b,N){for(const E in N)b[E]=N[E];return b},_getFirstPointerId(b){return b.touches?b.changedTouches[0].identifier:b.pointerId||999},releaseCanvas(...b){t.Konva.releaseCanvasOnDestroy&&b.forEach(N=>{N.width=0,N.height=0})},drawRoundedRectPath(b,N,E,P){let F=0,A=0,j=0,I=0;typeof P=="number"?F=A=j=I=Math.min(P,N/2,E/2):(F=Math.min(P[0]||0,N/2,E/2),A=Math.min(P[1]||0,N/2,E/2),I=Math.min(P[2]||0,N/2,E/2),j=Math.min(P[3]||0,N/2,E/2)),b.moveTo(F,0),b.lineTo(N-A,0),b.arc(N-A,A,A,Math.PI*3/2,0,!1),b.lineTo(N,E-I),b.arc(N-I,E-I,I,0,Math.PI/2,!1),b.lineTo(j,E),b.arc(j,E-j,j,Math.PI/2,Math.PI,!1),b.lineTo(0,F),b.arc(F,F,F,Math.PI,Math.PI*3/2,!1)}}})(US)),US}var sx={},Pu={},Fu={},h6;function fL(){if(h6)return Fu;h6=1,Object.defineProperty(Fu,"__esModule",{value:!0}),Fu.HitContext=Fu.SceneContext=Fu.Context=void 0;const e=Bs(),t=tn();function r(C){const k=[],b=C.length,N=e.Util;for(let E=0;E<b;E++){let P=C[E];N._isNumber(P)?P=Math.round(P*1e3)/1e3:N._isString(P)||(P=P+""),k.push(P)}return k}const n=",",s="(",a=")",i="([",o="])",c=";",u="()",d="=",h=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],g=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],p=100;let x=class{constructor(k){this.canvas=k,t.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(k){k.fillEnabled()&&this._fill(k)}_fill(k){}strokeShape(k){k.hasStroke()&&this._stroke(k)}_stroke(k){}fillStrokeShape(k){k.attrs.fillAfterStrokeEnabled?(this.strokeShape(k),this.fillShape(k)):(this.fillShape(k),this.strokeShape(k))}getTrace(k,b){let N=this.traceArr,E=N.length,P="",F,A,j,I;for(F=0;F<E;F++)A=N[F],j=A.method,j?(I=A.args,P+=j,k?P+=u:e.Util._isArray(I[0])?P+=i+I.join(n)+o:(b&&(I=I.map(B=>typeof B=="number"?Math.floor(B):B)),P+=s+I.join(n)+a)):(P+=A.property,k||(P+=d+A.val)),P+=c;return P}clearTrace(){this.traceArr=[]}_trace(k){let b=this.traceArr,N;b.push(k),N=b.length,N>=p&&b.shift()}reset(){const k=this.getCanvas().getPixelRatio();this.setTransform(1*k,0,0,1*k,0,0)}getCanvas(){return this.canvas}clear(k){const b=this.getCanvas();k?this.clearRect(k.x||0,k.y||0,k.width||0,k.height||0):this.clearRect(0,0,b.getWidth()/b.pixelRatio,b.getHeight()/b.pixelRatio)}_applyLineCap(k){const b=k.attrs.lineCap;b&&this.setAttr("lineCap",b)}_applyOpacity(k){const b=k.getAbsoluteOpacity();b!==1&&this.setAttr("globalAlpha",b)}_applyLineJoin(k){const b=k.attrs.lineJoin;b&&this.setAttr("lineJoin",b)}setAttr(k,b){this._context[k]=b}arc(k,b,N,E,P,F){this._context.arc(k,b,N,E,P,F)}arcTo(k,b,N,E,P){this._context.arcTo(k,b,N,E,P)}beginPath(){this._context.beginPath()}bezierCurveTo(k,b,N,E,P,F){this._context.bezierCurveTo(k,b,N,E,P,F)}clearRect(k,b,N,E){this._context.clearRect(k,b,N,E)}clip(...k){this._context.clip.apply(this._context,k)}closePath(){this._context.closePath()}createImageData(k,b){const N=arguments;if(N.length===2)return this._context.createImageData(k,b);if(N.length===1)return this._context.createImageData(k)}createLinearGradient(k,b,N,E){return this._context.createLinearGradient(k,b,N,E)}createPattern(k,b){return this._context.createPattern(k,b)}createRadialGradient(k,b,N,E,P,F){return this._context.createRadialGradient(k,b,N,E,P,F)}drawImage(k,b,N,E,P,F,A,j,I){const B=arguments,Y=this._context;B.length===3?Y.drawImage(k,b,N):B.length===5?Y.drawImage(k,b,N,E,P):B.length===9&&Y.drawImage(k,b,N,E,P,F,A,j,I)}ellipse(k,b,N,E,P,F,A,j){this._context.ellipse(k,b,N,E,P,F,A,j)}isPointInPath(k,b,N,E){return N?this._context.isPointInPath(N,k,b,E):this._context.isPointInPath(k,b,E)}fill(...k){this._context.fill.apply(this._context,k)}fillRect(k,b,N,E){this._context.fillRect(k,b,N,E)}strokeRect(k,b,N,E){this._context.strokeRect(k,b,N,E)}fillText(k,b,N,E){E?this._context.fillText(k,b,N,E):this._context.fillText(k,b,N)}measureText(k){return this._context.measureText(k)}getImageData(k,b,N,E){return this._context.getImageData(k,b,N,E)}lineTo(k,b){this._context.lineTo(k,b)}moveTo(k,b){this._context.moveTo(k,b)}rect(k,b,N,E){this._context.rect(k,b,N,E)}roundRect(k,b,N,E,P){this._context.roundRect(k,b,N,E,P)}putImageData(k,b,N){this._context.putImageData(k,b,N)}quadraticCurveTo(k,b,N,E){this._context.quadraticCurveTo(k,b,N,E)}restore(){this._context.restore()}rotate(k){this._context.rotate(k)}save(){this._context.save()}scale(k,b){this._context.scale(k,b)}setLineDash(k){this._context.setLineDash?this._context.setLineDash(k):"mozDash"in this._context?this._context.mozDash=k:"webkitLineDash"in this._context&&(this._context.webkitLineDash=k)}getLineDash(){return this._context.getLineDash()}setTransform(k,b,N,E,P,F){this._context.setTransform(k,b,N,E,P,F)}stroke(k){k?this._context.stroke(k):this._context.stroke()}strokeText(k,b,N,E){this._context.strokeText(k,b,N,E)}transform(k,b,N,E,P,F){this._context.transform(k,b,N,E,P,F)}translate(k,b){this._context.translate(k,b)}_enableTrace(){let k=this,b=h.length,N=this.setAttr,E,P;const F=function(A){let j=k[A],I;k[A]=function(){return P=r(Array.prototype.slice.call(arguments,0)),I=j.apply(k,arguments),k._trace({method:A,args:P}),I}};for(E=0;E<b;E++)F(h[E]);k.setAttr=function(){N.apply(k,arguments);const A=arguments[0];let j=arguments[1];(A==="shadowOffsetX"||A==="shadowOffsetY"||A==="shadowBlur")&&(j=j/this.canvas.getPixelRatio()),k._trace({property:A,val:j})}}_applyGlobalCompositeOperation(k){const b=k.attrs.globalCompositeOperation;!b||b==="source-over"||this.setAttr("globalCompositeOperation",b)}};Fu.Context=x,g.forEach(function(C){Object.defineProperty(x.prototype,C,{get(){return this._context[C]},set(k){this._context[C]=k}})});class v extends x{constructor(k,{willReadFrequently:b=!1}={}){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:b})}_fillColor(k){const b=k.fill();this.setAttr("fillStyle",b),k._fillFunc(this)}_fillPattern(k){this.setAttr("fillStyle",k._getFillPattern()),k._fillFunc(this)}_fillLinearGradient(k){const b=k._getLinearGradient();b&&(this.setAttr("fillStyle",b),k._fillFunc(this))}_fillRadialGradient(k){const b=k._getRadialGradient();b&&(this.setAttr("fillStyle",b),k._fillFunc(this))}_fill(k){const b=k.fill(),N=k.getFillPriority();if(b&&N==="color"){this._fillColor(k);return}const E=k.getFillPatternImage();if(E&&N==="pattern"){this._fillPattern(k);return}const P=k.getFillLinearGradientColorStops();if(P&&N==="linear-gradient"){this._fillLinearGradient(k);return}const F=k.getFillRadialGradientColorStops();if(F&&N==="radial-gradient"){this._fillRadialGradient(k);return}b?this._fillColor(k):E?this._fillPattern(k):P?this._fillLinearGradient(k):F&&this._fillRadialGradient(k)}_strokeLinearGradient(k){const b=k.getStrokeLinearGradientStartPoint(),N=k.getStrokeLinearGradientEndPoint(),E=k.getStrokeLinearGradientColorStops(),P=this.createLinearGradient(b.x,b.y,N.x,N.y);if(E){for(let F=0;F<E.length;F+=2)P.addColorStop(E[F],E[F+1]);this.setAttr("strokeStyle",P)}}_stroke(k){const b=k.dash(),N=k.getStrokeScaleEnabled();if(k.hasStroke()){if(!N){this.save();const P=this.getCanvas().getPixelRatio();this.setTransform(P,0,0,P,0,0)}this._applyLineCap(k),b&&k.dashEnabled()&&(this.setLineDash(b),this.setAttr("lineDashOffset",k.dashOffset())),this.setAttr("lineWidth",k.strokeWidth()),k.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),k.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(k):this.setAttr("strokeStyle",k.stroke()),k._strokeFunc(this),N||this.restore()}}_applyShadow(k){var b,N,E;const P=(b=k.getShadowRGBA())!==null&&b!==void 0?b:"black",F=(N=k.getShadowBlur())!==null&&N!==void 0?N:5,A=(E=k.getShadowOffset())!==null&&E!==void 0?E:{x:0,y:0},j=k.getAbsoluteScale(),I=this.canvas.getPixelRatio(),B=j.x*I,Y=j.y*I;this.setAttr("shadowColor",P),this.setAttr("shadowBlur",F*Math.min(Math.abs(B),Math.abs(Y))),this.setAttr("shadowOffsetX",A.x*B),this.setAttr("shadowOffsetY",A.y*Y)}}Fu.SceneContext=v;class w extends x{constructor(k){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:!0})}_fill(k){this.save(),this.setAttr("fillStyle",k.colorKey),k._fillFuncHit(this),this.restore()}strokeShape(k){k.hasHitStroke()&&this._stroke(k)}_stroke(k){if(k.hasHitStroke()){const b=k.getStrokeScaleEnabled();if(!b){this.save();const P=this.getCanvas().getPixelRatio();this.setTransform(P,0,0,P,0,0)}this._applyLineCap(k);const N=k.hitStrokeWidth(),E=N==="auto"?k.strokeWidth():N;this.setAttr("lineWidth",E),this.setAttr("strokeStyle",k.colorKey),k._strokeFuncHit(this),b||this.restore()}}}return Fu.HitContext=w,Fu}var g6;function M_(){if(g6)return Pu;g6=1,Object.defineProperty(Pu,"__esModule",{value:!0}),Pu.HitCanvas=Pu.SceneCanvas=Pu.Canvas=void 0;const e=Bs(),t=fL(),r=tn();let n;function s(){if(n)return n;const c=e.Util.createCanvasElement(),u=c.getContext("2d");return n=(function(){const d=r.Konva._global.devicePixelRatio||1,h=u.webkitBackingStorePixelRatio||u.mozBackingStorePixelRatio||u.msBackingStorePixelRatio||u.oBackingStorePixelRatio||u.backingStorePixelRatio||1;return d/h})(),e.Util.releaseCanvas(c),n}let a=class{constructor(u){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const h=(u||{}).pixelRatio||r.Konva.pixelRatio||s();this.pixelRatio=h,this._canvas=e.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(u){const d=this.pixelRatio;this.pixelRatio=u,this.setSize(this.getWidth()/d,this.getHeight()/d)}setWidth(u){this.width=this._canvas.width=u*this.pixelRatio,this._canvas.style.width=u+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}setHeight(u){this.height=this._canvas.height=u*this.pixelRatio,this._canvas.style.height=u+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}getWidth(){return this.width}getHeight(){return this.height}setSize(u,d){this.setWidth(u||0),this.setHeight(d||0)}toDataURL(u,d){try{return this._canvas.toDataURL(u,d)}catch{try{return this._canvas.toDataURL()}catch(g){return e.Util.error("Unable to get data URL. "+g.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Pu.Canvas=a;class i extends a{constructor(u={width:0,height:0,willReadFrequently:!1}){super(u),this.context=new t.SceneContext(this,{willReadFrequently:u.willReadFrequently}),this.setSize(u.width,u.height)}}Pu.SceneCanvas=i;class o extends a{constructor(u={width:0,height:0}){super(u),this.hitCanvas=!0,this.context=new t.HitContext(this),this.setSize(u.width,u.height)}}return Pu.HitCanvas=o,Pu}var zS={},m6;function XN(){return m6||(m6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const t=tn(),r=Bs();e.DD={get isDragging(){let n=!1;return e.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return e.DD._dragElements.forEach(s=>{n=s.node}),n},_dragElements:new Map,_drag(n){const s=[];e.DD._dragElements.forEach((a,i)=>{const{node:o}=a,c=o.getStage();c.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const u=c._changedPointerPositions.find(d=>d.id===a.pointerId);if(u){if(a.dragStatus!=="dragging"){const d=o.dragDistance();if(Math.max(Math.abs(u.x-a.startPointerPos.x),Math.abs(u.y-a.startPointerPos.y))<d||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),s.push(o)}}),s.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const s=[];e.DD._dragElements.forEach(a=>{const{node:i}=a,o=i.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(d=>d.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(e.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,a.dragStatus="stopped");const u=a.node.getLayer()||a.node instanceof t.Konva.Stage&&a.node;u&&s.indexOf(u)===-1&&s.push(u)}),s.forEach(a=>{a.draw()})},_endDragAfter(n){e.DD._dragElements.forEach((s,a)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:n},!0),s.dragStatus!=="dragging"&&e.DD._dragElements.delete(a)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("touchcancel",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1),window.addEventListener("touchcancel",e.DD._endDragAfter,!1))})(zS)),zS}var WS={},xo={},p6;function dn(){if(p6)return xo;p6=1,Object.defineProperty(xo,"__esModule",{value:!0}),xo.RGBComponent=n,xo.alphaComponent=s,xo.getNumberValidator=a,xo.getNumberOrArrayOfNumbersValidator=i,xo.getNumberOrAutoValidator=o,xo.getStringValidator=c,xo.getStringOrGradientValidator=u,xo.getFunctionValidator=d,xo.getNumberArrayValidator=h,xo.getBooleanValidator=g,xo.getComponentValidator=p;const e=tn(),t=Bs();function r(x){return t.Util._isString(x)?'"'+x+'"':Object.prototype.toString.call(x)==="[object Number]"||t.Util._isBoolean(x)?x:Object.prototype.toString.call(x)}function n(x){return x>255?255:x<0?0:Math.round(x)}function s(x){return x>1?1:x<1e-4?1e-4:x}function a(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isNumber(x)||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a number.'),x}}function i(x){if(e.Konva.isUnminified)return function(v,w){let C=t.Util._isNumber(v),k=t.Util._isArray(v)&&v.length==x;return!C&&!k&&t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a number or Array<number>('+x+")"),v}}function o(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isNumber(x)||x==="auto"||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a number or "auto".'),x}}function c(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isString(x)||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a string.'),x}}function u(){if(e.Konva.isUnminified)return function(x,v){const w=t.Util._isString(x),C=Object.prototype.toString.call(x)==="[object CanvasGradient]"||x&&x.addColorStop;return w||C||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a string or a native gradient.'),x}}function d(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isFunction(x)||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a function.'),x}}function h(){if(e.Konva.isUnminified)return function(x,v){const w=Int8Array?Object.getPrototypeOf(Int8Array):null;return w&&x instanceof w||(t.Util._isArray(x)?x.forEach(function(C){t.Util._isNumber(C)||t.Util.warn('"'+v+'" attribute has non numeric element '+C+". Make sure that all elements are numbers.")}):t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a array of numbers.')),x}}function g(){if(e.Konva.isUnminified)return function(x,v){return x===!0||x===!1||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a boolean.'),x}}function p(x){if(e.Konva.isUnminified)return function(v,w){return v==null||t.Util.isObject(v)||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be an object with properties '+x),v}}return xo}var x6;function ln(){return x6||(x6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const t=Bs(),r=dn(),n="get",s="set";e.Factory={addGetterSetter(a,i,o,c,u){e.Factory.addGetter(a,i,o),e.Factory.addSetter(a,i,c,u),e.Factory.addOverloadedGetterSetter(a,i)},addGetter(a,i,o){const c=n+t.Util._capitalize(i);a.prototype[c]=a.prototype[c]||function(){const u=this.attrs[i];return u===void 0?o:u}},addSetter(a,i,o,c){const u=s+t.Util._capitalize(i);a.prototype[u]||e.Factory.overWriteSetter(a,i,o,c)},overWriteSetter(a,i,o,c){const u=s+t.Util._capitalize(i);a.prototype[u]=function(d){return o&&d!==void 0&&d!==null&&(d=o.call(this,d,i)),this._setAttr(i,d),c&&c.call(this),this}},addComponentsGetterSetter(a,i,o,c,u){const d=o.length,h=t.Util._capitalize,g=n+h(i),p=s+h(i);a.prototype[g]=function(){const v={};for(let w=0;w<d;w++){const C=o[w];v[C]=this.getAttr(i+h(C))}return v};const x=(0,r.getComponentValidator)(o);a.prototype[p]=function(v){const w=this.attrs[i];c&&(v=c.call(this,v,i)),x&&x.call(this,v,i);for(const C in v)v.hasOwnProperty(C)&&this._setAttr(i+h(C),v[C]);return v||o.forEach(C=>{this._setAttr(i+h(C),void 0)}),this._fireChangeEvent(i,w,v),u&&u.call(this),this},e.Factory.addOverloadedGetterSetter(a,i)},addOverloadedGetterSetter(a,i){const o=t.Util._capitalize(i),c=s+o,u=n+o;a.prototype[i]=function(){return arguments.length?(this[c](arguments[0]),this):this[u]()}},addDeprecatedGetterSetter(a,i,o,c){t.Util.error("Adding deprecated "+i);const u=n+t.Util._capitalize(i),d=i+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[u]=function(){t.Util.error(d);const h=this.attrs[i];return h===void 0?o:h},e.Factory.addSetter(a,i,c,function(){t.Util.error(d)}),e.Factory.addOverloadedGetterSetter(a,i)},backCompat(a,i){t.Util.each(i,function(o,c){const u=a.prototype[c],d=n+t.Util._capitalize(o),h=s+t.Util._capitalize(o);function g(){u.apply(this,arguments),t.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}a.prototype[o]=g,a.prototype[d]=g,a.prototype[h]=g})},afterSetFilter(){this._filterUpToDate=!1}}})(WS)),WS}var y6;function Qs(){if(y6)return sx;y6=1,Object.defineProperty(sx,"__esModule",{value:!0}),sx.Node=void 0;const e=M_(),t=XN(),r=ln(),n=tn(),s=Bs(),a=dn(),i="absoluteOpacity",o="allEventListeners",c="absoluteTransform",u="absoluteScale",d="canvas",h="Change",g="children",p="konva",x="listening",v="mouseenter",w="mouseleave",C="pointerenter",k="pointerleave",b="touchenter",N="touchleave",E="set",P="Shape",F=" ",A="stage",j="transform",I="Stage",B="visible",Y=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(F);let Z=1,ae=class jT{constructor(L){this._id=Z++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(L),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(L){(L===j||L===c)&&this._cache.get(L)?this._cache.get(L).dirty=!0:L?this._cache.delete(L):this._cache.clear()}_getCache(L,H){let M=this._cache.get(L);return(M===void 0||(L===j||L===c)&&M.dirty===!0)&&(M=H.call(this),this._cache.set(L,M)),M}_calculate(L,H,M){if(!this._attachedDepsListeners.get(L)){const V=H.map(W=>W+"Change.konva").join(F);this.on(V,()=>{this._clearCache(L)}),this._attachedDepsListeners.set(L,!0)}return this._getCache(L,M)}_getCanvasCache(){return this._cache.get(d)}_clearSelfAndDescendantCache(L){this._clearCache(L),L===c&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(d)){const{scene:L,filter:H,hit:M,buffer:V}=this._cache.get(d);s.Util.releaseCanvas(L,H,M,V),this._cache.delete(d)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(L){const H=L||{};let M={};(H.x===void 0||H.y===void 0||H.width===void 0||H.height===void 0)&&(M=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let V=Math.ceil(H.width||M.width),W=Math.ceil(H.height||M.height),R=H.pixelRatio,U=H.x===void 0?Math.floor(M.x):H.x,q=H.y===void 0?Math.floor(M.y):H.y,Q=H.offset||0,se=H.drawBorder||!1,X=H.hitCanvasPixelRatio||1;if(!V||!W){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const ie=Math.abs(Math.round(M.x)-U)>.5?1:0,le=Math.abs(Math.round(M.y)-q)>.5?1:0;V+=Q*2+ie,W+=Q*2+le,U-=Q,q-=Q;const ce=new e.SceneCanvas({pixelRatio:R,width:V,height:W}),Se=new e.SceneCanvas({pixelRatio:R,width:0,height:0,willReadFrequently:!0}),re=new e.HitCanvas({pixelRatio:X,width:V,height:W}),ge=ce.getContext(),Ee=re.getContext(),Ae=new e.SceneCanvas({width:ce.width/ce.pixelRatio+Math.abs(U),height:ce.height/ce.pixelRatio+Math.abs(q),pixelRatio:ce.pixelRatio}),He=Ae.getContext();return re.isCache=!0,ce.isCache=!0,this._cache.delete(d),this._filterUpToDate=!1,H.imageSmoothingEnabled===!1&&(ce.getContext()._context.imageSmoothingEnabled=!1,Se.getContext()._context.imageSmoothingEnabled=!1),ge.save(),Ee.save(),He.save(),ge.translate(-U,-q),Ee.translate(-U,-q),He.translate(-U,-q),Ae.x=U,Ae.y=q,this._isUnderCache=!0,this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(u),this.drawScene(ce,this,Ae),this.drawHit(re,this),this._isUnderCache=!1,ge.restore(),Ee.restore(),se&&(ge.save(),ge.beginPath(),ge.rect(0,0,V,W),ge.closePath(),ge.setAttr("strokeStyle","red"),ge.setAttr("lineWidth",5),ge.stroke(),ge.restore()),this._cache.set(d,{scene:ce,filter:Se,hit:re,buffer:Ae,x:U,y:q}),this._requestDraw(),this}isCached(){return this._cache.has(d)}getClientRect(L){throw new Error('abstract "getClientRect" method call')}_transformedRect(L,H){const M=[{x:L.x,y:L.y},{x:L.x+L.width,y:L.y},{x:L.x+L.width,y:L.y+L.height},{x:L.x,y:L.y+L.height}];let V=1/0,W=1/0,R=-1/0,U=-1/0;const q=this.getAbsoluteTransform(H);return M.forEach(function(Q){const se=q.point(Q);V===void 0&&(V=R=se.x,W=U=se.y),V=Math.min(V,se.x),W=Math.min(W,se.y),R=Math.max(R,se.x),U=Math.max(U,se.y)}),{x:V,y:W,width:R-V,height:U-W}}_drawCachedSceneCanvas(L){L.save(),L._applyOpacity(this),L._applyGlobalCompositeOperation(this);const H=this._getCanvasCache();L.translate(H.x,H.y);const M=this._getCachedSceneCanvas(),V=M.pixelRatio;L.drawImage(M._canvas,0,0,M.width/V,M.height/V),L.restore()}_drawCachedHitCanvas(L){const H=this._getCanvasCache(),M=H.hit;L.save(),L.translate(H.x,H.y),L.drawImage(M._canvas,0,0,M.width/M.pixelRatio,M.height/M.pixelRatio),L.restore()}_getCachedSceneCanvas(){let L=this.filters(),H=this._getCanvasCache(),M=H.scene,V=H.filter,W=V.getContext(),R,U,q,Q;if(L){if(!this._filterUpToDate){const se=M.pixelRatio;V.setSize(M.width/M.pixelRatio,M.height/M.pixelRatio);try{for(R=L.length,W.clear(),W.drawImage(M._canvas,0,0,M.getWidth()/se,M.getHeight()/se),U=W.getImageData(0,0,V.getWidth(),V.getHeight()),q=0;q<R;q++){if(Q=L[q],typeof Q!="function"){s.Util.error("Filter should be type of function, but got "+typeof Q+" instead. Please check correct filters");continue}Q.call(this,U),W.putImageData(U,0,0)}}catch(X){s.Util.error("Unable to apply filter. "+X.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return V}return M}on(L,H){if(this._cache&&this._cache.delete(o),arguments.length===3)return this._delegate.apply(this,arguments);const M=L.split(F);for(let V=0;V<M.length;V++){const R=M[V].split("."),U=R[0],q=R[1]||"";this.eventListeners[U]||(this.eventListeners[U]=[]),this.eventListeners[U].push({name:q,handler:H})}return this}off(L,H){let M=(L||"").split(F),V=M.length,W,R,U,q,Q,se;if(this._cache&&this._cache.delete(o),!L)for(R in this.eventListeners)this._off(R);for(W=0;W<V;W++)if(U=M[W],q=U.split("."),Q=q[0],se=q[1],Q)this.eventListeners[Q]&&this._off(Q,se,H);else for(R in this.eventListeners)this._off(R,se,H);return this}dispatchEvent(L){const H={target:this,type:L.type,evt:L};return this.fire(L.type,H),this}addEventListener(L,H){return this.on(L,function(M){H.call(this,M.evt)}),this}removeEventListener(L){return this.off(L),this}_delegate(L,H,M){const V=this;this.on(L,function(W){const R=W.target.findAncestors(H,!0,V);for(let U=0;U<R.length;U++)W=s.Util.cloneObject(W),W.currentTarget=R[U],M.call(R[U],W)})}remove(){return this.isDragging()&&this.stopDrag(),t.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(u),this._clearSelfAndDescendantCache(A),this._clearSelfAndDescendantCache(B),this._clearSelfAndDescendantCache(x)}_remove(){this._clearCaches();const L=this.getParent();L&&L.children&&(L.children.splice(this.index,1),L._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(L){const H="get"+s.Util._capitalize(L);return s.Util._isFunction(this[H])?this[H]():this.attrs[L]}getAncestors(){let L=this.getParent(),H=[];for(;L;)H.push(L),L=L.getParent();return H}getAttrs(){return this.attrs||{}}setAttrs(L){return this._batchTransformChanges(()=>{let H,M;if(!L)return this;for(H in L)H!==g&&(M=E+s.Util._capitalize(H),s.Util._isFunction(this[M])?this[M](L[H]):this._setAttr(H,L[H]))}),this}isListening(){return this._getCache(x,this._isListening)}_isListening(L){if(!this.listening())return!1;const M=this.getParent();return M&&M!==L&&this!==L?M._isListening(L):!0}isVisible(){return this._getCache(B,this._isVisible)}_isVisible(L){if(!this.visible())return!1;const M=this.getParent();return M&&M!==L&&this!==L?M._isVisible(L):!0}shouldDrawHit(L,H=!1){if(L)return this._isVisible(L)&&this._isListening(L);const M=this.getLayer();let V=!1;t.DD._dragElements.forEach(R=>{R.dragStatus==="dragging"&&(R.node.nodeType==="Stage"||R.node.getLayer()===M)&&(V=!0)});const W=!H&&!n.Konva.hitOnDragEnabled&&(V||n.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!W}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let L=this.getDepth(),H=this,M=0,V,W,R,U;function q(se){for(V=[],W=se.length,R=0;R<W;R++)U=se[R],M++,U.nodeType!==P&&(V=V.concat(U.getChildren().slice())),U._id===H._id&&(R=W);V.length>0&&V[0].getDepth()<=L&&q(V)}const Q=this.getStage();return H.nodeType!==I&&Q&&q(Q.getChildren()),M}getDepth(){let L=0,H=this.parent;for(;H;)L++,H=H.parent;return L}_batchTransformChanges(L){this._batchingTransformChange=!0,L(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(j),this._clearSelfAndDescendantCache(c)),this._needClearTransformCache=!1}setPosition(L){return this._batchTransformChanges(()=>{this.x(L.x),this.y(L.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const L=this.getStage();if(!L)return null;const H=L.getPointerPosition();if(!H)return null;const M=this.getAbsoluteTransform().copy();return M.invert(),M.point(H)}getAbsolutePosition(L){let H=!1,M=this.parent;for(;M;){if(M.isCached()){H=!0;break}M=M.parent}H&&!L&&(L=!0);const V=this.getAbsoluteTransform(L).getMatrix(),W=new s.Transform,R=this.offset();return W.m=V.slice(),W.translate(R.x,R.y),W.getTranslation()}setAbsolutePosition(L){const{x:H,y:M,...V}=this._clearTransform();this.attrs.x=H,this.attrs.y=M,this._clearCache(j);const W=this._getAbsoluteTransform().copy();return W.invert(),W.translate(L.x,L.y),L={x:this.attrs.x+W.getTranslation().x,y:this.attrs.y+W.getTranslation().y},this._setTransform(V),this.setPosition({x:L.x,y:L.y}),this._clearCache(j),this._clearSelfAndDescendantCache(c),this}_setTransform(L){let H;for(H in L)this.attrs[H]=L[H]}_clearTransform(){const L={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,L}move(L){let H=L.x,M=L.y,V=this.x(),W=this.y();return H!==void 0&&(V+=H),M!==void 0&&(W+=M),this.setPosition({x:V,y:W}),this}_eachAncestorReverse(L,H){let M=[],V=this.getParent(),W,R;if(!(H&&H._id===this._id)){for(M.unshift(this);V&&(!H||V._id!==H._id);)M.unshift(V),V=V.parent;for(W=M.length,R=0;R<W;R++)L(M[R])}}rotate(L){return this.rotation(this.rotation()+L),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const L=this.index,H=this.parent.getChildren().length;return L<H-1?(this.parent.children.splice(L,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const L=this.index,H=this.parent.getChildren().length;return L<H-1?(this.parent.children.splice(L,1),this.parent.children.splice(L+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const L=this.index;return L>0?(this.parent.children.splice(L,1),this.parent.children.splice(L-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const L=this.index;return L>0?(this.parent.children.splice(L,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(L){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(L<0||L>=this.parent.children.length)&&s.Util.warn("Unexpected value "+L+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const H=this.index;return this.parent.children.splice(H,1),this.parent.children.splice(L,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(i,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let L=this.opacity();const H=this.getParent();return H&&!H._isUnderCache&&(L*=H.getAbsoluteOpacity()),L}moveTo(L){return this.getParent()!==L&&(this._remove(),L.add(this)),this}toObject(){let L=this.getAttrs(),H,M,V,W,R;const U={attrs:{},className:this.getClassName()};for(H in L)M=L[H],R=s.Util.isObject(M)&&!s.Util._isPlainObject(M)&&!s.Util._isArray(M),!R&&(V=typeof this[H]=="function"&&this[H],delete L[H],W=V?V.call(this):null,L[H]=M,W!==M&&(U.attrs[H]=M));return s.Util._prepareToStringify(U)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(L,H,M){const V=[];H&&this._isMatch(L)&&V.push(this);let W=this.parent;for(;W;){if(W===M)return V;W._isMatch(L)&&V.push(W),W=W.parent}return V}isAncestorOf(L){return!1}findAncestor(L,H,M){return this.findAncestors(L,H,M)[0]}_isMatch(L){if(!L)return!1;if(typeof L=="function")return L(this);let H=L.replace(/ /g,"").split(","),M=H.length,V,W;for(V=0;V<M;V++)if(W=H[V],s.Util.isValidSelector(W)||(s.Util.warn('Selector "'+W+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),W.charAt(0)==="#"){if(this.id()===W.slice(1))return!0}else if(W.charAt(0)==="."){if(this.hasName(W.slice(1)))return!0}else if(this.className===W||this.nodeType===W)return!0;return!1}getLayer(){const L=this.getParent();return L?L.getLayer():null}getStage(){return this._getCache(A,this._getStage)}_getStage(){const L=this.getParent();return L?L.getStage():null}fire(L,H={},M){return H.target=H.target||this,M?this._fireAndBubble(L,H):this._fire(L,H),this}getAbsoluteTransform(L){return L?this._getAbsoluteTransform(L):this._getCache(c,this._getAbsoluteTransform)}_getAbsoluteTransform(L){let H;if(L)return H=new s.Transform,this._eachAncestorReverse(function(M){const V=M.transformsEnabled();V==="all"?H.multiply(M.getTransform()):V==="position"&&H.translate(M.x()-M.offsetX(),M.y()-M.offsetY())},L),H;{H=this._cache.get(c)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(H):H.reset();const M=this.transformsEnabled();if(M==="all")H.multiply(this.getTransform());else if(M==="position"){const V=this.attrs.x||0,W=this.attrs.y||0,R=this.attrs.offsetX||0,U=this.attrs.offsetY||0;H.translate(V-R,W-U)}return H.dirty=!1,H}}getAbsoluteScale(L){let H=this;for(;H;)H._isUnderCache&&(L=H),H=H.getParent();const V=this.getAbsoluteTransform(L).decompose();return{x:V.scaleX,y:V.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(j,this._getTransform)}_getTransform(){var L,H;const M=this._cache.get(j)||new s.Transform;M.reset();const V=this.x(),W=this.y(),R=n.Konva.getAngle(this.rotation()),U=(L=this.attrs.scaleX)!==null&&L!==void 0?L:1,q=(H=this.attrs.scaleY)!==null&&H!==void 0?H:1,Q=this.attrs.skewX||0,se=this.attrs.skewY||0,X=this.attrs.offsetX||0,ie=this.attrs.offsetY||0;return(V!==0||W!==0)&&M.translate(V,W),R!==0&&M.rotate(R),(Q!==0||se!==0)&&M.skew(Q,se),(U!==1||q!==1)&&M.scale(U,q),(X!==0||ie!==0)&&M.translate(-1*X,-1*ie),M.dirty=!1,M}clone(L){let H=s.Util.cloneObject(this.attrs),M,V,W,R,U;for(M in L)H[M]=L[M];const q=new this.constructor(H);for(M in this.eventListeners)for(V=this.eventListeners[M],W=V.length,R=0;R<W;R++)U=V[R],U.name.indexOf(p)<0&&(q.eventListeners[M]||(q.eventListeners[M]=[]),q.eventListeners[M].push(U));return q}_toKonvaCanvas(L){L=L||{};const H=this.getClientRect(),M=this.getStage(),V=L.x!==void 0?L.x:Math.floor(H.x),W=L.y!==void 0?L.y:Math.floor(H.y),R=L.pixelRatio||1,U=new e.SceneCanvas({width:L.width||Math.ceil(H.width)||(M?M.width():0),height:L.height||Math.ceil(H.height)||(M?M.height():0),pixelRatio:R}),q=U.getContext(),Q=new e.SceneCanvas({width:U.width/U.pixelRatio+Math.abs(V),height:U.height/U.pixelRatio+Math.abs(W),pixelRatio:U.pixelRatio});return L.imageSmoothingEnabled===!1&&(q._context.imageSmoothingEnabled=!1),q.save(),(V||W)&&q.translate(-1*V,-1*W),this.drawScene(U,void 0,Q),q.restore(),U}toCanvas(L){return this._toKonvaCanvas(L)._canvas}toDataURL(L){L=L||{};const H=L.mimeType||null,M=L.quality||null,V=this._toKonvaCanvas(L).toDataURL(H,M);return L.callback&&L.callback(V),V}toImage(L){return new Promise((H,M)=>{try{const V=L?.callback;V&&delete L.callback,s.Util._urlToImage(this.toDataURL(L),function(W){H(W),V?.(W)})}catch(V){M(V)}})}toBlob(L){return new Promise((H,M)=>{try{const V=L?.callback;V&&delete L.callback,this.toCanvas(L).toBlob(W=>{H(W),V?.(W)},L?.mimeType,L?.quality)}catch(V){M(V)}})}setSize(L){return this.width(L.width),this.height(L.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():n.Konva.dragDistance}_off(L,H,M){let V=this.eventListeners[L],W,R,U;for(W=0;W<V.length;W++)if(R=V[W].name,U=V[W].handler,(R!=="konva"||H==="konva")&&(!H||R===H)&&(!M||M===U)){if(V.splice(W,1),V.length===0){delete this.eventListeners[L];break}W--}}_fireChangeEvent(L,H,M){this._fire(L+h,{oldVal:H,newVal:M})}addName(L){if(!this.hasName(L)){const H=this.name(),M=H?H+" "+L:L;this.name(M)}return this}hasName(L){if(!L)return!1;const H=this.name();return H?(H||"").split(/\s/g).indexOf(L)!==-1:!1}removeName(L){const H=(this.name()||"").split(/\s/g),M=H.indexOf(L);return M!==-1&&(H.splice(M,1),this.name(H.join(" "))),this}setAttr(L,H){const M=this[E+s.Util._capitalize(L)];return s.Util._isFunction(M)?M.call(this,H):this._setAttr(L,H),this}_requestDraw(){if(n.Konva.autoDrawEnabled){const L=this.getLayer()||this.getStage();L?.batchDraw()}}_setAttr(L,H){const M=this.attrs[L];M===H&&!s.Util.isObject(H)||(H==null?delete this.attrs[L]:this.attrs[L]=H,this._shouldFireChangeEvents&&this._fireChangeEvent(L,M,H),this._requestDraw())}_setComponentAttr(L,H,M){let V;M!==void 0&&(V=this.attrs[L],V||(this.attrs[L]=this.getAttr(L)),this.attrs[L][H]=M,this._fireChangeEvent(L,V,M))}_fireAndBubble(L,H,M){H&&this.nodeType===P&&(H.target=this);const V=[v,w,C,k,b,N];if(!(V.indexOf(L)!==-1&&(M&&(this===M||this.isAncestorOf&&this.isAncestorOf(M))||this.nodeType==="Stage"&&!M))){this._fire(L,H);const R=V.indexOf(L)!==-1&&M&&M.isAncestorOf&&M.isAncestorOf(this)&&!M.isAncestorOf(this.parent);(H&&!H.cancelBubble||!H)&&this.parent&&this.parent.isListening()&&!R&&(M&&M.parent?this._fireAndBubble.call(this.parent,L,H,M):this._fireAndBubble.call(this.parent,L,H))}}_getProtoListeners(L){var H,M,V;const W=(H=this._cache.get(o))!==null&&H!==void 0?H:{};let R=W?.[L];if(R===void 0){R=[];let U=Object.getPrototypeOf(this);for(;U;){const q=(V=(M=U.eventListeners)===null||M===void 0?void 0:M[L])!==null&&V!==void 0?V:[];R.push(...q),U=Object.getPrototypeOf(U)}W[L]=R,this._cache.set(o,W)}return R}_fire(L,H){H=H||{},H.currentTarget=this,H.type=L;const M=this._getProtoListeners(L);if(M)for(let W=0;W<M.length;W++)M[W].handler.call(this,H);const V=this.eventListeners[L];if(V)for(let W=0;W<V.length;W++)V[W].handler.call(this,H)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(L){const H=L?L.pointerId:void 0,M=this.getStage(),V=this.getAbsolutePosition();if(!M)return;const W=M._getPointerById(H)||M._changedPointerPositions[0]||V;t.DD._dragElements.set(this._id,{node:this,startPointerPos:W,offset:{x:W.x-V.x,y:W.y-V.y},dragStatus:"ready",pointerId:H})}startDrag(L,H=!0){t.DD._dragElements.has(this._id)||this._createDragElement(L);const M=t.DD._dragElements.get(this._id);M.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:L&&L.evt},H)}_setDragPosition(L,H){const M=this.getStage()._getPointerById(H.pointerId);if(!M)return;let V={x:M.x-H.offset.x,y:M.y-H.offset.y};const W=this.dragBoundFunc();if(W!==void 0){const R=W.call(this,V,L);R?V=R:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==V.x||this._lastPos.y!==V.y)&&(this.setAbsolutePosition(V),this._requestDraw()),this._lastPos=V}stopDrag(L){const H=t.DD._dragElements.get(this._id);H&&(H.dragStatus="stopped"),t.DD._endDragBefore(L),t.DD._endDragAfter(L)}setDraggable(L){this._setAttr("draggable",L),this._dragChange()}isDragging(){const L=t.DD._dragElements.get(this._id);return L?L.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(L){if(!(!(L.evt.button!==void 0)||n.Konva.dragButtons.indexOf(L.evt.button)>=0)||this.isDragging())return;let V=!1;t.DD._dragElements.forEach(W=>{this.isAncestorOf(W.node)&&(V=!0)}),V||this._createDragElement(L)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const H=t.DD._dragElements.get(this._id),M=H&&H.dragStatus==="dragging",V=H&&H.dragStatus==="ready";M?this.stopDrag():V&&t.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(L={x:0,y:0}){const H=this.getStage();if(!H)return!1;const M={x:-L.x,y:-L.y,width:H.width()+2*L.x,height:H.height()+2*L.y};return s.Util.haveIntersection(M,this.getClientRect())}static create(L,H){return s.Util._isString(L)&&(L=JSON.parse(L)),this._createNode(L,H)}static _createNode(L,H){let M=jT.prototype.getClassName.call(L),V=L.children,W,R,U;H&&(L.attrs.container=H),n.Konva[M]||(s.Util.warn('Can not find a node with class name "'+M+'". Fallback to "Shape".'),M="Shape");const q=n.Konva[M];if(W=new q(L.attrs),V)for(R=V.length,U=0;U<R;U++)W.add(jT._createNode(V[U]));return W}};sx.Node=ae,ae.prototype.nodeType="Node",ae.prototype._attrsAffectingSize=[],ae.prototype.eventListeners={},ae.prototype.on.call(ae.prototype,Y,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(j),this._clearSelfAndDescendantCache(c)}),ae.prototype.on.call(ae.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(B)}),ae.prototype.on.call(ae.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(x)}),ae.prototype.on.call(ae.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(i)});const ee=r.Factory.addGetterSetter;return ee(ae,"zIndex"),ee(ae,"absolutePosition"),ee(ae,"position"),ee(ae,"x",0,(0,a.getNumberValidator)()),ee(ae,"y",0,(0,a.getNumberValidator)()),ee(ae,"globalCompositeOperation","source-over",(0,a.getStringValidator)()),ee(ae,"opacity",1,(0,a.getNumberValidator)()),ee(ae,"name","",(0,a.getStringValidator)()),ee(ae,"id","",(0,a.getStringValidator)()),ee(ae,"rotation",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(ae,"scale",["x","y"]),ee(ae,"scaleX",1,(0,a.getNumberValidator)()),ee(ae,"scaleY",1,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(ae,"skew",["x","y"]),ee(ae,"skewX",0,(0,a.getNumberValidator)()),ee(ae,"skewY",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(ae,"offset",["x","y"]),ee(ae,"offsetX",0,(0,a.getNumberValidator)()),ee(ae,"offsetY",0,(0,a.getNumberValidator)()),ee(ae,"dragDistance",void 0,(0,a.getNumberValidator)()),ee(ae,"width",0,(0,a.getNumberValidator)()),ee(ae,"height",0,(0,a.getNumberValidator)()),ee(ae,"listening",!0,(0,a.getBooleanValidator)()),ee(ae,"preventDefault",!0,(0,a.getBooleanValidator)()),ee(ae,"filters",void 0,function(ne){return this._filterUpToDate=!1,ne}),ee(ae,"visible",!0,(0,a.getBooleanValidator)()),ee(ae,"transformsEnabled","all",(0,a.getStringValidator)()),ee(ae,"size"),ee(ae,"dragBoundFunc"),ee(ae,"draggable",!1,(0,a.getBooleanValidator)()),r.Factory.backCompat(ae,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),sx}var ax={},v6;function L_(){if(v6)return ax;v6=1,Object.defineProperty(ax,"__esModule",{value:!0}),ax.Container=void 0;const e=ln(),t=Qs(),r=dn();let n=class extends t.Node{constructor(){super(...arguments),this.children=[]}getChildren(a){const i=this.children||[];return a?i.filter(a):i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.destroy()}),this.children=[],this._requestDraw(),this}add(...a){if(a.length===0)return this;if(a.length>1){for(let o=0;o<a.length;o++)this.add(a[o]);return this}const i=a[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(a){return this._generalFind(a,!1)}findOne(a){const i=this._generalFind(a,!0);return i.length>0?i[0]:void 0}_generalFind(a,i){const o=[];return this._descendants(c=>{const u=c._isMatch(a);return u&&o.push(c),!!(u&&i)}),o}_descendants(a){let i=!1;const o=this.getChildren();for(const c of o){if(i=a(c),i)return!0;if(c.hasChildren()&&(i=c._descendants(a),i))return!0}return!1}toObject(){const a=t.Node.prototype.toObject.call(this);return a.children=[],this.getChildren().forEach(i=>{a.children.push(i.toObject())}),a}isAncestorOf(a){let i=a.getParent();for(;i;){if(i._id===this._id)return!0;i=i.getParent()}return!1}clone(a){const i=t.Node.prototype.clone.call(this,a);return this.getChildren().forEach(function(o){i.add(o.clone())}),i}getAllIntersections(a){const i=[];return this.find("Shape").forEach(o=>{o.isVisible()&&o.intersects(a)&&i.push(o)}),i}_clearSelfAndDescendantCache(a){var i;super._clearSelfAndDescendantCache(a),!this.isCached()&&((i=this.children)===null||i===void 0||i.forEach(function(o){o._clearSelfAndDescendantCache(a)}))}_setChildrenIndices(){var a;(a=this.children)===null||a===void 0||a.forEach(function(i,o){i.index=o}),this._requestDraw()}drawScene(a,i,o){const c=this.getLayer(),u=a||c&&c.getCanvas(),d=u&&u.getContext(),h=this._getCanvasCache(),g=h&&h.scene,p=u&&u.isCache;if(!this.isVisible()&&!p)return this;if(g){d.save();const x=this.getAbsoluteTransform(i).getMatrix();d.transform(x[0],x[1],x[2],x[3],x[4],x[5]),this._drawCachedSceneCanvas(d),d.restore()}else this._drawChildren("drawScene",u,i,o);return this}drawHit(a,i){if(!this.shouldDrawHit(i))return this;const o=this.getLayer(),c=a||o&&o.hitCanvas,u=c&&c.getContext(),d=this._getCanvasCache();if(d&&d.hit){u.save();const g=this.getAbsoluteTransform(i).getMatrix();u.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(u),u.restore()}else this._drawChildren("drawHit",c,i);return this}_drawChildren(a,i,o,c){var u;const d=i&&i.getContext(),h=this.clipWidth(),g=this.clipHeight(),p=this.clipFunc(),x=typeof h=="number"&&typeof g=="number"||p,v=o===this;if(x){d.save();const C=this.getAbsoluteTransform(o);let k=C.getMatrix();d.transform(k[0],k[1],k[2],k[3],k[4],k[5]),d.beginPath();let b;if(p)b=p.call(this,d,this);else{const N=this.clipX(),E=this.clipY();d.rect(N||0,E||0,h,g)}d.clip.apply(d,b),k=C.copy().invert().getMatrix(),d.transform(k[0],k[1],k[2],k[3],k[4],k[5])}const w=!v&&this.globalCompositeOperation()!=="source-over"&&a==="drawScene";w&&(d.save(),d._applyGlobalCompositeOperation(this)),(u=this.children)===null||u===void 0||u.forEach(function(C){C[a](i,o,c)}),w&&d.restore(),x&&d.restore()}getClientRect(a={}){var i;const o=a.skipTransform,c=a.relativeTo;let u,d,h,g,p={x:1/0,y:1/0,width:0,height:0};const x=this;(i=this.children)===null||i===void 0||i.forEach(function(C){if(!C.visible())return;const k=C.getClientRect({relativeTo:x,skipShadow:a.skipShadow,skipStroke:a.skipStroke});k.width===0&&k.height===0||(u===void 0?(u=k.x,d=k.y,h=k.x+k.width,g=k.y+k.height):(u=Math.min(u,k.x),d=Math.min(d,k.y),h=Math.max(h,k.x+k.width),g=Math.max(g,k.y+k.height)))});const v=this.find("Shape");let w=!1;for(let C=0;C<v.length;C++)if(v[C]._isVisible(this)){w=!0;break}return w&&u!==void 0?p={x:u,y:d,width:h-u,height:g-d}:p={x:0,y:0,width:0,height:0},o?p:this._transformedRect(p,c)}};return ax.Container=n,e.Factory.addComponentsGetterSetter(n,"clip",["x","y","width","height"]),e.Factory.addGetterSetter(n,"clipX",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipY",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipWidth",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipHeight",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipFunc"),ax}var HS={},tf={},w6;function hL(){if(w6)return tf;w6=1,Object.defineProperty(tf,"__esModule",{value:!0}),tf.getCapturedShape=n,tf.createEvent=s,tf.hasPointerCapture=a,tf.setPointerCapture=i,tf.releaseCapture=o;const e=tn(),t=new Map,r=e.Konva._global.PointerEvent!==void 0;function n(c){return t.get(c)}function s(c){return{evt:c,pointerId:c.pointerId}}function a(c,u){return t.get(c)===u}function i(c,u){o(c),u.getStage()&&(t.set(c,u),r&&u._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function o(c,u){const d=t.get(c);if(!d)return;const h=d.getStage();h&&h.content,t.delete(c),r&&d._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return tf}var b6;function NJ(){return b6||(b6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const t=Bs(),r=ln(),n=L_(),s=tn(),a=M_(),i=XN(),o=tn(),c=hL(),u="Stage",d="string",h="px",g="mouseout",p="mouseleave",x="mouseover",v="mouseenter",w="mousemove",C="mousedown",k="mouseup",b="pointermove",N="pointerdown",E="pointerup",P="pointercancel",F="lostpointercapture",A="pointerout",j="pointerleave",I="pointerover",B="pointerenter",Y="contextmenu",Z="touchstart",ae="touchend",ee="touchmove",ne="touchcancel",L="wheel",H=5,M=[[v,"_pointerenter"],[C,"_pointerdown"],[w,"_pointermove"],[k,"_pointerup"],[p,"_pointerleave"],[Z,"_pointerdown"],[ee,"_pointermove"],[ae,"_pointerup"],[ne,"_pointercancel"],[x,"_pointerover"],[L,"_wheel"],[Y,"_contextmenu"],[N,"_pointerdown"],[b,"_pointermove"],[E,"_pointerup"],[P,"_pointercancel"],[j,"_pointerleave"],[F,"_lostpointercapture"]],V={mouse:{[A]:g,[j]:p,[I]:x,[B]:v,[b]:w,[N]:C,[E]:k,[P]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[A]:"touchout",[j]:"touchleave",[I]:"touchover",[B]:"touchenter",[b]:ee,[N]:Z,[E]:ae,[P]:ne,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[A]:A,[j]:j,[I]:I,[B]:B,[b]:b,[N]:N,[E]:E,[P]:P,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},W=se=>se.indexOf("pointer")>=0?"pointer":se.indexOf("touch")>=0?"touch":"mouse",R=se=>{const X=W(se);if(X==="pointer")return s.Konva.pointerEventsEnabled&&V.pointer;if(X==="touch")return V.touch;if(X==="mouse")return V.mouse};function U(se={}){return(se.clipFunc||se.clipWidth||se.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),se}const q="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class Q extends n.Container{constructor(X){super(U(X)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{U(this.attrs)}),this._checkVisibility()}_validateAdd(X){const ie=X.getType()==="Layer",le=X.getType()==="FastLayer";ie||le||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const X=this.visible()?"":"none";this.content.style.display=X}setContainer(X){if(typeof X===d){let ie;if(X.charAt(0)==="."){const le=X.slice(1);X=document.getElementsByClassName(le)[0]}else X.charAt(0)!=="#"?ie=X:ie=X.slice(1),X=document.getElementById(ie);if(!X)throw"Can not find container in document with id "+ie}return this._setAttr("container",X),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),X.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const X=this.children,ie=X.length;for(let le=0;le<ie;le++)X[le].clear();return this}clone(X){return X||(X={}),X.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,X)}destroy(){super.destroy();const X=this.content;X&&t.Util._isInDocument(X)&&this.container().removeChild(X);const ie=e.stages.indexOf(this);return ie>-1&&e.stages.splice(ie,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const X=this._pointerPositions[0]||this._changedPointerPositions[0];return X?{x:X.x,y:X.y}:(t.Util.warn(q),null)}_getPointerById(X){return this._pointerPositions.find(ie=>ie.id===X)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(X){X=X||{},X.x=X.x||0,X.y=X.y||0,X.width=X.width||this.width(),X.height=X.height||this.height();const ie=new a.SceneCanvas({width:X.width,height:X.height,pixelRatio:X.pixelRatio||1}),le=ie.getContext()._context,ce=this.children;return(X.x||X.y)&&le.translate(-1*X.x,-1*X.y),ce.forEach(function(Se){if(!Se.isVisible())return;const re=Se._toKonvaCanvas(X);le.drawImage(re._canvas,X.x,X.y,re.getWidth()/re.getPixelRatio(),re.getHeight()/re.getPixelRatio())}),ie}getIntersection(X){if(!X)return null;const ie=this.children,le=ie.length,ce=le-1;for(let Se=ce;Se>=0;Se--){const re=ie[Se].getIntersection(X);if(re)return re}return null}_resizeDOM(){const X=this.width(),ie=this.height();this.content&&(this.content.style.width=X+h,this.content.style.height=ie+h),this.bufferCanvas.setSize(X,ie),this.bufferHitCanvas.setSize(X,ie),this.children.forEach(le=>{le.setSize({width:X,height:ie}),le.draw()})}add(X,...ie){if(arguments.length>1){for(let ce=0;ce<arguments.length;ce++)this.add(arguments[ce]);return this}super.add(X);const le=this.children.length;return le>H&&t.Util.warn("The stage has "+le+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),X.setSize({width:this.width(),height:this.height()}),X.draw(),s.Konva.isBrowser&&this.content.appendChild(X.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(X){return c.hasPointerCapture(X,this)}setPointerCapture(X){c.setPointerCapture(X,this)}releaseCapture(X){c.releaseCapture(X,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&M.forEach(([X,ie])=>{this.content.addEventListener(X,le=>{this[ie](le)},{passive:!1})})}_pointerenter(X){this.setPointersPositions(X);const ie=R(X.type);ie&&this._fire(ie.pointerenter,{evt:X,target:this,currentTarget:this})}_pointerover(X){this.setPointersPositions(X);const ie=R(X.type);ie&&this._fire(ie.pointerover,{evt:X,target:this,currentTarget:this})}_getTargetShape(X){let ie=this[X+"targetShape"];return ie&&!ie.getStage()&&(ie=null),ie}_pointerleave(X){const ie=R(X.type),le=W(X.type);if(!ie)return;this.setPointersPositions(X);const ce=this._getTargetShape(le),Se=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;ce&&Se?(ce._fireAndBubble(ie.pointerout,{evt:X}),ce._fireAndBubble(ie.pointerleave,{evt:X}),this._fire(ie.pointerleave,{evt:X,target:this,currentTarget:this}),this[le+"targetShape"]=null):Se&&(this._fire(ie.pointerleave,{evt:X,target:this,currentTarget:this}),this._fire(ie.pointerout,{evt:X,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(X){const ie=R(X.type),le=W(X.type);if(!ie)return;this.setPointersPositions(X);let ce=!1;this._changedPointerPositions.forEach(Se=>{const re=this.getIntersection(Se);if(i.DD.justDragged=!1,s.Konva["_"+le+"ListenClick"]=!0,!re||!re.isListening()){this[le+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&re.setPointerCapture(Se.id),this[le+"ClickStartShape"]=re,re._fireAndBubble(ie.pointerdown,{evt:X,pointerId:Se.id}),ce=!0;const ge=X.type.indexOf("touch")>=0;re.preventDefault()&&X.cancelable&&ge&&X.preventDefault()}),ce||this._fire(ie.pointerdown,{evt:X,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(X){const ie=R(X.type),le=W(X.type);if(!ie||(s.Konva.isDragging()&&i.DD.node.preventDefault()&&X.cancelable&&X.preventDefault(),this.setPointersPositions(X),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const Se={};let re=!1;const ge=this._getTargetShape(le);this._changedPointerPositions.forEach(Ee=>{const Ae=c.getCapturedShape(Ee.id)||this.getIntersection(Ee),He=Ee.id,Be={evt:X,pointerId:He},Rt=ge!==Ae;if(Rt&&ge&&(ge._fireAndBubble(ie.pointerout,{...Be},Ae),ge._fireAndBubble(ie.pointerleave,{...Be},Ae)),Ae){if(Se[Ae._id])return;Se[Ae._id]=!0}Ae&&Ae.isListening()?(re=!0,Rt&&(Ae._fireAndBubble(ie.pointerover,{...Be},ge),Ae._fireAndBubble(ie.pointerenter,{...Be},ge),this[le+"targetShape"]=Ae),Ae._fireAndBubble(ie.pointermove,{...Be})):ge&&(this._fire(ie.pointerover,{evt:X,target:this,currentTarget:this,pointerId:He}),this[le+"targetShape"]=null)}),re||this._fire(ie.pointermove,{evt:X,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(X){const ie=R(X.type),le=W(X.type);if(!ie)return;this.setPointersPositions(X);const ce=this[le+"ClickStartShape"],Se=this[le+"ClickEndShape"],re={};let ge=!1;this._changedPointerPositions.forEach(Ee=>{const Ae=c.getCapturedShape(Ee.id)||this.getIntersection(Ee);if(Ae){if(Ae.releaseCapture(Ee.id),re[Ae._id])return;re[Ae._id]=!0}const He=Ee.id,Be={evt:X,pointerId:He};let Rt=!1;s.Konva["_"+le+"InDblClickWindow"]?(Rt=!0,clearTimeout(this[le+"DblTimeout"])):i.DD.justDragged||(s.Konva["_"+le+"InDblClickWindow"]=!0,clearTimeout(this[le+"DblTimeout"])),this[le+"DblTimeout"]=setTimeout(function(){s.Konva["_"+le+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),Ae&&Ae.isListening()?(ge=!0,this[le+"ClickEndShape"]=Ae,Ae._fireAndBubble(ie.pointerup,{...Be}),s.Konva["_"+le+"ListenClick"]&&ce&&ce===Ae&&(Ae._fireAndBubble(ie.pointerclick,{...Be}),Rt&&Se&&Se===Ae&&Ae._fireAndBubble(ie.pointerdblclick,{...Be}))):(this[le+"ClickEndShape"]=null,s.Konva["_"+le+"ListenClick"]&&this._fire(ie.pointerclick,{evt:X,target:this,currentTarget:this,pointerId:He}),Rt&&this._fire(ie.pointerdblclick,{evt:X,target:this,currentTarget:this,pointerId:He}))}),ge||this._fire(ie.pointerup,{evt:X,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+le+"ListenClick"]=!1,X.cancelable&&le!=="touch"&&le!=="pointer"&&X.preventDefault()}_contextmenu(X){this.setPointersPositions(X);const ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(Y,{evt:X}):this._fire(Y,{evt:X,target:this,currentTarget:this})}_wheel(X){this.setPointersPositions(X);const ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(L,{evt:X}):this._fire(L,{evt:X,target:this,currentTarget:this})}_pointercancel(X){this.setPointersPositions(X);const ie=c.getCapturedShape(X.pointerId)||this.getIntersection(this.getPointerPosition());ie&&ie._fireAndBubble(E,c.createEvent(X)),c.releaseCapture(X.pointerId)}_lostpointercapture(X){c.releaseCapture(X.pointerId)}setPointersPositions(X){const ie=this._getContentPosition();let le=null,ce=null;X=X||window.event,X.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(X.touches,Se=>{this._pointerPositions.push({id:Se.identifier,x:(Se.clientX-ie.left)/ie.scaleX,y:(Se.clientY-ie.top)/ie.scaleY})}),Array.prototype.forEach.call(X.changedTouches||X.touches,Se=>{this._changedPointerPositions.push({id:Se.identifier,x:(Se.clientX-ie.left)/ie.scaleX,y:(Se.clientY-ie.top)/ie.scaleY})})):(le=(X.clientX-ie.left)/ie.scaleX,ce=(X.clientY-ie.top)/ie.scaleY,this.pointerPos={x:le,y:ce},this._pointerPositions=[{x:le,y:ce,id:t.Util._getFirstPointerId(X)}],this._changedPointerPositions=[{x:le,y:ce,id:t.Util._getFirstPointerId(X)}])}_setPointerPosition(X){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(X)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const X=this.content.getBoundingClientRect();return{top:X.top,left:X.left,scaleX:X.width/this.content.clientWidth||1,scaleY:X.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const X=this.container();if(!X)throw"Stage has no container. A container is required.";X.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),X.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(X){X.batchDraw()}),this}}e.Stage=Q,Q.prototype.nodeType=u,(0,o._registerNode)(Q),r.Factory.addGetterSetter(Q,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{e.stages.forEach(se=>{se.batchDraw()})})})(HS)),HS}var ix={},GS={},_6;function Wa(){return _6||(_6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const t=tn(),r=Bs(),n=ln(),s=Qs(),a=dn(),i=tn(),o=hL(),c="hasShadow",u="shadowRGBA",d="patternImage",h="linearGradient",g="radialGradient";let p;function x(){return p||(p=r.Util.createCanvasElement().getContext("2d"),p)}e.shapes={};function v(j){const I=this.attrs.fillRule;I?j.fill(I):j.fill()}function w(j){j.stroke()}function C(j){const I=this.attrs.fillRule;I?j.fill(I):j.fill()}function k(j){j.stroke()}function b(){this._clearCache(c)}function N(){this._clearCache(u)}function E(){this._clearCache(d)}function P(){this._clearCache(h)}function F(){this._clearCache(g)}class A extends s.Node{constructor(I){super(I);let B;for(;B=r.Util.getRandomColor(),!(B&&!(B in e.shapes)););this.colorKey=B,e.shapes[B]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const B=x().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(B&&B.setTransform){const Y=new r.Transform;Y.translate(this.fillPatternX(),this.fillPatternY()),Y.rotate(t.Konva.getAngle(this.fillPatternRotation())),Y.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),Y.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const Z=Y.getMatrix(),ae=typeof DOMMatrix>"u"?{a:Z[0],b:Z[1],c:Z[2],d:Z[3],e:Z[4],f:Z[5]}:new DOMMatrix(Z);B.setTransform(ae)}return B}}_getLinearGradient(){return this._getCache(h,this.__getLinearGradient)}__getLinearGradient(){const I=this.fillLinearGradientColorStops();if(I){const B=x(),Y=this.fillLinearGradientStartPoint(),Z=this.fillLinearGradientEndPoint(),ae=B.createLinearGradient(Y.x,Y.y,Z.x,Z.y);for(let ee=0;ee<I.length;ee+=2)ae.addColorStop(I[ee],I[ee+1]);return ae}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){const I=this.fillRadialGradientColorStops();if(I){const B=x(),Y=this.fillRadialGradientStartPoint(),Z=this.fillRadialGradientEndPoint(),ae=B.createRadialGradient(Y.x,Y.y,this.fillRadialGradientStartRadius(),Z.x,Z.y,this.fillRadialGradientEndRadius());for(let ee=0;ee<I.length;ee+=2)ae.addColorStop(I[ee],I[ee+1]);return ae}}getShadowRGBA(){return this._getCache(u,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const I=r.Util.colorToRGBA(this.shadowColor());if(I)return"rgba("+I.r+","+I.g+","+I.b+","+I.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const I=this.hitStrokeWidth();return I==="auto"?this.hasStroke():this.strokeEnabled()&&!!I}intersects(I){const B=this.getStage();if(!B)return!1;const Y=B.bufferHitCanvas;return Y.getContext().clear(),this.drawHit(Y,void 0,!0),Y.context.getImageData(Math.round(I.x),Math.round(I.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(I){var B;if(!((B=this.attrs.perfectDrawEnabled)!==null&&B!==void 0?B:!0))return!1;const Z=I||this.hasFill(),ae=this.hasStroke(),ee=this.getAbsoluteOpacity()!==1;if(Z&&ae&&ee)return!0;const ne=this.hasShadow(),L=this.shadowForStrokeEnabled();return!!(Z&&ae&&ne&&L)}setStrokeHitEnabled(I){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),I?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const I=this.size();return{x:this._centroid?-I.width/2:0,y:this._centroid?-I.height/2:0,width:I.width,height:I.height}}getClientRect(I={}){let B=!1,Y=this.getParent();for(;Y;){if(Y.isCached()){B=!0;break}Y=Y.getParent()}const Z=I.skipTransform,ae=I.relativeTo||B&&this.getStage()||void 0,ee=this.getSelfRect(),L=!I.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,H=ee.width+L,M=ee.height+L,V=!I.skipShadow&&this.hasShadow(),W=V?this.shadowOffsetX():0,R=V?this.shadowOffsetY():0,U=H+Math.abs(W),q=M+Math.abs(R),Q=V&&this.shadowBlur()||0,se=U+Q*2,X=q+Q*2,ie={width:se,height:X,x:-(L/2+Q)+Math.min(W,0)+ee.x,y:-(L/2+Q)+Math.min(R,0)+ee.y};return Z?ie:this._transformedRect(ie,ae)}drawScene(I,B,Y){const Z=this.getLayer(),ae=I||Z.getCanvas(),ee=ae.getContext(),ne=this._getCanvasCache(),L=this.getSceneFunc(),H=this.hasShadow();let M;const V=B===this;if(!this.isVisible()&&!V)return this;if(ne){ee.save();const W=this.getAbsoluteTransform(B).getMatrix();return ee.transform(W[0],W[1],W[2],W[3],W[4],W[5]),this._drawCachedSceneCanvas(ee),ee.restore(),this}if(!L)return this;if(ee.save(),this._useBufferCanvas()){M=this.getStage();const W=Y||M.bufferCanvas,R=W.getContext();R.clear(),R.save(),R._applyLineJoin(this);const U=this.getAbsoluteTransform(B).getMatrix();R.transform(U[0],U[1],U[2],U[3],U[4],U[5]),L.call(this,R,this),R.restore();const q=W.pixelRatio;H&&ee._applyShadow(this),ee._applyOpacity(this),ee._applyGlobalCompositeOperation(this),ee.drawImage(W._canvas,W.x||0,W.y||0,W.width/q,W.height/q)}else{if(ee._applyLineJoin(this),!V){const W=this.getAbsoluteTransform(B).getMatrix();ee.transform(W[0],W[1],W[2],W[3],W[4],W[5]),ee._applyOpacity(this),ee._applyGlobalCompositeOperation(this)}H&&ee._applyShadow(this),L.call(this,ee,this)}return ee.restore(),this}drawHit(I,B,Y=!1){if(!this.shouldDrawHit(B,Y))return this;const Z=this.getLayer(),ae=I||Z.hitCanvas,ee=ae&&ae.getContext(),ne=this.hitFunc()||this.sceneFunc(),L=this._getCanvasCache(),H=L&&L.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),H){ee.save();const V=this.getAbsoluteTransform(B).getMatrix();return ee.transform(V[0],V[1],V[2],V[3],V[4],V[5]),this._drawCachedHitCanvas(ee),ee.restore(),this}if(!ne)return this;if(ee.save(),ee._applyLineJoin(this),!(this===B)){const V=this.getAbsoluteTransform(B).getMatrix();ee.transform(V[0],V[1],V[2],V[3],V[4],V[5])}return ne.call(this,ee,this),ee.restore(),this}drawHitFromCache(I=0){const B=this._getCanvasCache(),Y=this._getCachedSceneCanvas(),Z=B.hit,ae=Z.getContext(),ee=Z.getWidth(),ne=Z.getHeight();ae.clear(),ae.drawImage(Y._canvas,0,0,ee,ne);try{const L=ae.getImageData(0,0,ee,ne),H=L.data,M=H.length,V=r.Util._hexToRgb(this.colorKey);for(let W=0;W<M;W+=4)H[W+3]>I?(H[W]=V.r,H[W+1]=V.g,H[W+2]=V.b,H[W+3]=255):H[W+3]=0;ae.putImageData(L,0,0)}catch(L){r.Util.error("Unable to draw hit graph from cached scene canvas. "+L.message)}return this}hasPointerCapture(I){return o.hasPointerCapture(I,this)}setPointerCapture(I){o.setPointerCapture(I,this)}releaseCapture(I){o.releaseCapture(I,this)}}e.Shape=A,A.prototype._fillFunc=v,A.prototype._strokeFunc=w,A.prototype._fillFuncHit=C,A.prototype._strokeFuncHit=k,A.prototype._centroid=!1,A.prototype.nodeType="Shape",(0,i._registerNode)(A),A.prototype.eventListeners={},A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",b),A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",N),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",E),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",P),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",F),n.Factory.addGetterSetter(A,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(A,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(A,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(A,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(A,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(A,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(A,"lineJoin"),n.Factory.addGetterSetter(A,"lineCap"),n.Factory.addGetterSetter(A,"sceneFunc"),n.Factory.addGetterSetter(A,"hitFunc"),n.Factory.addGetterSetter(A,"dash"),n.Factory.addGetterSetter(A,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(A,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(A,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(A,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternImage"),n.Factory.addGetterSetter(A,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(A,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(A,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(A,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(A,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(A,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(A,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(A,"fillEnabled",!0),n.Factory.addGetterSetter(A,"strokeEnabled",!0),n.Factory.addGetterSetter(A,"shadowEnabled",!0),n.Factory.addGetterSetter(A,"dashEnabled",!0),n.Factory.addGetterSetter(A,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(A,"fillPriority","color"),n.Factory.addComponentsGetterSetter(A,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(A,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(A,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(A,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(A,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(A,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(A,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(A,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(A,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(A,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(A,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(A,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(A,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(A,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(A,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(A,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(A,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(A,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(A,"fillPatternRotation",0),n.Factory.addGetterSetter(A,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(A,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(GS)),GS}var S6;function gL(){if(S6)return ix;S6=1,Object.defineProperty(ix,"__esModule",{value:!0}),ix.Layer=void 0;const e=Bs(),t=L_(),r=Qs(),n=ln(),s=M_(),a=dn(),i=Wa(),o=tn(),c="#",u="beforeDraw",d="draw",h=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],g=h.length;class p extends t.Container{constructor(v){super(v),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(v){return this.getContext().clear(v),this.getHitCanvas().getContext().clear(v),this}setZIndex(v){super.setZIndex(v);const w=this.getStage();return w&&w.content&&(w.content.removeChild(this.getNativeCanvasElement()),v<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[v+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){r.Node.prototype.moveToTop.call(this);const v=this.getStage();return v&&v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!r.Node.prototype.moveUp.call(this))return!1;const w=this.getStage();return!w||!w.content?!1:(w.content.removeChild(this.getNativeCanvasElement()),this.index<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[this.index+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(r.Node.prototype.moveDown.call(this)){const v=this.getStage();if(v){const w=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),w[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(r.Node.prototype.moveToBottom.call(this)){const v=this.getStage();if(v){const w=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),w[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const v=this.getNativeCanvasElement();return r.Node.prototype.remove.call(this),v&&v.parentNode&&e.Util._isInDocument(v)&&v.parentNode.removeChild(v),this}getStage(){return this.parent}setSize({width:v,height:w}){return this.canvas.setSize(v,w),this.hitCanvas.setSize(v,w),this._setSmoothEnabled(),this}_validateAdd(v){const w=v.getType();w!=="Group"&&w!=="Shape"&&e.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(v){return v=v||{},v.width=v.width||this.getWidth(),v.height=v.height||this.getHeight(),v.x=v.x!==void 0?v.x:this.x(),v.y=v.y!==void 0?v.y:this.y(),r.Node.prototype._toKonvaCanvas.call(this,v)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){e.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){e.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,e.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(v){if(!this.isListening()||!this.isVisible())return null;let w=1,C=!1;for(;;){for(let k=0;k<g;k++){const b=h[k],N=this._getIntersection({x:v.x+b.x*w,y:v.y+b.y*w}),E=N.shape;if(E)return E;if(C=!!N.antialiased,!N.antialiased)break}if(C)w+=1;else return null}}_getIntersection(v){const w=this.hitCanvas.pixelRatio,C=this.hitCanvas.context.getImageData(Math.round(v.x*w),Math.round(v.y*w),1,1).data,k=C[3];if(k===255){const b=e.Util._rgbToHex(C[0],C[1],C[2]),N=i.shapes[c+b];return N?{shape:N}:{antialiased:!0}}else if(k>0)return{antialiased:!0};return{}}drawScene(v,w,C){const k=this.getLayer(),b=v||k&&k.getCanvas();return this._fire(u,{node:this}),this.clearBeforeDraw()&&b.getContext().clear(),t.Container.prototype.drawScene.call(this,b,w,C),this._fire(d,{node:this}),this}drawHit(v,w){const C=this.getLayer(),k=v||C&&C.hitCanvas;return C&&C.clearBeforeDraw()&&C.getHitCanvas().getContext().clear(),t.Container.prototype.drawHit.call(this,k,w),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(v){e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(v)}getHitGraphEnabled(v){return e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const v=this.parent;!!this.hitCanvas._canvas.parentNode?v.content.removeChild(this.hitCanvas._canvas):v.content.appendChild(this.hitCanvas._canvas)}destroy(){return e.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}return ix.Layer=p,p.prototype.nodeType="Layer",(0,o._registerNode)(p),n.Factory.addGetterSetter(p,"imageSmoothingEnabled",!0),n.Factory.addGetterSetter(p,"clearBeforeDraw",!0),n.Factory.addGetterSetter(p,"hitGraphEnabled",!0,(0,a.getBooleanValidator)()),ix}var ox={},k6;function AJ(){if(k6)return ox;k6=1,Object.defineProperty(ox,"__esModule",{value:!0}),ox.FastLayer=void 0;const e=Bs(),t=gL(),r=tn();class n extends t.Layer{constructor(a){super(a),this.listening(!1),e.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}return ox.FastLayer=n,n.prototype.nodeType="FastLayer",(0,r._registerNode)(n),ox}var lx={},C6;function QN(){if(C6)return lx;C6=1,Object.defineProperty(lx,"__esModule",{value:!0}),lx.Group=void 0;const e=Bs(),t=L_(),r=tn();class n extends t.Container{_validateAdd(a){const i=a.getType();i!=="Group"&&i!=="Shape"&&e.Util.throw("You may only add groups and shapes to groups.")}}return lx.Group=n,n.prototype.nodeType="Group",(0,r._registerNode)(n),lx}var cx={},T6;function JN(){if(T6)return cx;T6=1,Object.defineProperty(cx,"__esModule",{value:!0}),cx.Animation=void 0;const e=tn(),t=Bs(),r=(function(){return e.glob.performance&&e.glob.performance.now?function(){return e.glob.performance.now()}:function(){return new Date().getTime()}})();let n=class Bg{constructor(a,i){this.id=Bg.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:r(),frameRate:0},this.func=a,this.setLayers(i)}setLayers(a){let i=[];return a&&(i=Array.isArray(a)?a:[a]),this.layers=i,this}getLayers(){return this.layers}addLayer(a){const i=this.layers,o=i.length;for(let c=0;c<o;c++)if(i[c]._id===a._id)return!1;return this.layers.push(a),!0}isRunning(){const i=Bg.animations,o=i.length;for(let c=0;c<o;c++)if(i[c].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=r(),Bg._addAnimation(this),this}stop(){return Bg._removeAnimation(this),this}_updateFrameObject(a){this.frame.timeDiff=a-this.frame.lastTime,this.frame.lastTime=a,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(a){this.animations.push(a),this._handleAnimation()}static _removeAnimation(a){const i=a.id,o=this.animations,c=o.length;for(let u=0;u<c;u++)if(o[u].id===i){this.animations.splice(u,1);break}}static _runFrames(){const a={},i=this.animations;for(let o=0;o<i.length;o++){const c=i[o],u=c.layers,d=c.func;c._updateFrameObject(r());const h=u.length;let g;if(d?g=d.call(c,c.frame)!==!1:g=!0,!!g)for(let p=0;p<h;p++){const x=u[p];x._id!==void 0&&(a[x._id]=x)}}for(const o in a)a.hasOwnProperty(o)&&a[o].batchDraw()}static _animationLoop(){const a=Bg;a.animations.length?(a._runFrames(),t.Util.requestAnimFrame(a._animationLoop)):a.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,t.Util.requestAnimFrame(this._animationLoop))}};return cx.Animation=n,n.animations=[],n.animIdCounter=0,n.animRunning=!1,cx}var VS={},E6;function jJ(){return E6||(E6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const t=Bs(),r=JN(),n=Qs(),s=tn(),a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},i=1,o=2,c=3,u=["fill","stroke","shadowColor"];let d=0;class h{constructor(x,v,w,C,k,b,N){this.prop=x,this.propFunc=v,this.begin=C,this._pos=C,this.duration=b,this._change=0,this.prevPos=0,this.yoyo=N,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=w,this._change=k-this.begin,this.pause()}fire(x){const v=this[x];v&&v()}setTime(x){x>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():x<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=x,this.update())}getTime(){return this._time}setPosition(x){this.prevPos=this._pos,this.propFunc(x),this._pos=x}getPosition(x){return x===void 0&&(x=this._time),this.func(x,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(x){this.pause(),this._time=x,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const x=this.getTimer()-this._startTime;this.state===o?this.setTime(x):this.state===c&&this.setTime(this.duration-x)}pause(){this.state=i,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(x){const v=this,w=x.node,C=w._id,k=x.easing||e.Easings.Linear,b=!!x.yoyo;let N,E;typeof x.duration>"u"?N=.3:x.duration===0?N=.001:N=x.duration,this.node=w,this._id=d++;const P=w.getLayer()||(w instanceof s.Konva.Stage?w.getLayers():null);P||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){v.tween.onEnterFrame()},P),this.tween=new h(E,function(F){v._tweenFunc(F)},k,0,1,N*1e3,b),this._addListeners(),g.attrs[C]||(g.attrs[C]={}),g.attrs[C][this._id]||(g.attrs[C][this._id]={}),g.tweens[C]||(g.tweens[C]={});for(E in x)a[E]===void 0&&this._addAttr(E,x[E]);this.reset(),this.onFinish=x.onFinish,this.onReset=x.onReset,this.onUpdate=x.onUpdate}_addAttr(x,v){const w=this.node,C=w._id;let k,b,N,E,P;const F=g.tweens[C][x];F&&delete g.attrs[C][F][x];let A=w.getAttr(x);if(t.Util._isArray(v))if(k=[],b=Math.max(v.length,A.length),x==="points"&&v.length!==A.length&&(v.length>A.length?(E=A,A=t.Util._prepareArrayForTween(A,v,w.closed())):(N=v,v=t.Util._prepareArrayForTween(v,A,w.closed()))),x.indexOf("fill")===0)for(let j=0;j<b;j++)if(j%2===0)k.push(v[j]-A[j]);else{const I=t.Util.colorToRGBA(A[j]);P=t.Util.colorToRGBA(v[j]),A[j]=I,k.push({r:P.r-I.r,g:P.g-I.g,b:P.b-I.b,a:P.a-I.a})}else for(let j=0;j<b;j++)k.push(v[j]-A[j]);else u.indexOf(x)!==-1?(A=t.Util.colorToRGBA(A),P=t.Util.colorToRGBA(v),k={r:P.r-A.r,g:P.g-A.g,b:P.b-A.b,a:P.a-A.a}):k=v-A;g.attrs[C][this._id][x]={start:A,diff:k,end:v,trueEnd:N,trueStart:E},g.tweens[C][x]=this._id}_tweenFunc(x){const v=this.node,w=g.attrs[v._id][this._id];let C,k,b,N,E,P,F,A;for(C in w){if(k=w[C],b=k.start,N=k.diff,A=k.end,t.Util._isArray(b))if(E=[],F=Math.max(b.length,A.length),C.indexOf("fill")===0)for(P=0;P<F;P++)P%2===0?E.push((b[P]||0)+N[P]*x):E.push("rgba("+Math.round(b[P].r+N[P].r*x)+","+Math.round(b[P].g+N[P].g*x)+","+Math.round(b[P].b+N[P].b*x)+","+(b[P].a+N[P].a*x)+")");else for(P=0;P<F;P++)E.push((b[P]||0)+N[P]*x);else u.indexOf(C)!==-1?E="rgba("+Math.round(b.r+N.r*x)+","+Math.round(b.g+N.g*x)+","+Math.round(b.b+N.b*x)+","+(b.a+N.a*x)+")":E=b+N*x;v.setAttr(C,E)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const x=this.node,v=g.attrs[x._id][this._id];v.points&&v.points.trueEnd&&x.setAttr("points",v.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const x=this.node,v=g.attrs[x._id][this._id];v.points&&v.points.trueStart&&x.points(v.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(x){return this.tween.seek(x*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const x=this.node._id,v=this._id,w=g.tweens[x];this.pause(),this.anim&&this.anim.stop();for(const C in w)delete g.tweens[x][C];delete g.attrs[x][v],g.tweens[x]&&(Object.keys(g.tweens[x]).length===0&&delete g.tweens[x],Object.keys(g.attrs[x]).length===0&&delete g.attrs[x])}}e.Tween=g,g.attrs={},g.tweens={},n.Node.prototype.to=function(p){const x=p.onFinish;p.node=this,p.onFinish=function(){this.destroy(),x&&x()},new g(p).play()},e.Easings={BackEaseIn(p,x,v,w){return v*(p/=w)*p*((1.70158+1)*p-1.70158)+x},BackEaseOut(p,x,v,w){return v*((p=p/w-1)*p*((1.70158+1)*p+1.70158)+1)+x},BackEaseInOut(p,x,v,w){let C=1.70158;return(p/=w/2)<1?v/2*(p*p*(((C*=1.525)+1)*p-C))+x:v/2*((p-=2)*p*(((C*=1.525)+1)*p+C)+2)+x},ElasticEaseIn(p,x,v,w,C,k){let b=0;return p===0?x:(p/=w)===1?x+v:(k||(k=w*.3),!C||C<Math.abs(v)?(C=v,b=k/4):b=k/(2*Math.PI)*Math.asin(v/C),-(C*Math.pow(2,10*(p-=1))*Math.sin((p*w-b)*(2*Math.PI)/k))+x)},ElasticEaseOut(p,x,v,w,C,k){let b=0;return p===0?x:(p/=w)===1?x+v:(k||(k=w*.3),!C||C<Math.abs(v)?(C=v,b=k/4):b=k/(2*Math.PI)*Math.asin(v/C),C*Math.pow(2,-10*p)*Math.sin((p*w-b)*(2*Math.PI)/k)+v+x)},ElasticEaseInOut(p,x,v,w,C,k){let b=0;return p===0?x:(p/=w/2)===2?x+v:(k||(k=w*(.3*1.5)),!C||C<Math.abs(v)?(C=v,b=k/4):b=k/(2*Math.PI)*Math.asin(v/C),p<1?-.5*(C*Math.pow(2,10*(p-=1))*Math.sin((p*w-b)*(2*Math.PI)/k))+x:C*Math.pow(2,-10*(p-=1))*Math.sin((p*w-b)*(2*Math.PI)/k)*.5+v+x)},BounceEaseOut(p,x,v,w){return(p/=w)<1/2.75?v*(7.5625*p*p)+x:p<2/2.75?v*(7.5625*(p-=1.5/2.75)*p+.75)+x:p<2.5/2.75?v*(7.5625*(p-=2.25/2.75)*p+.9375)+x:v*(7.5625*(p-=2.625/2.75)*p+.984375)+x},BounceEaseIn(p,x,v,w){return v-e.Easings.BounceEaseOut(w-p,0,v,w)+x},BounceEaseInOut(p,x,v,w){return p<w/2?e.Easings.BounceEaseIn(p*2,0,v,w)*.5+x:e.Easings.BounceEaseOut(p*2-w,0,v,w)*.5+v*.5+x},EaseIn(p,x,v,w){return v*(p/=w)*p+x},EaseOut(p,x,v,w){return-v*(p/=w)*(p-2)+x},EaseInOut(p,x,v,w){return(p/=w/2)<1?v/2*p*p+x:-v/2*(--p*(p-2)-1)+x},StrongEaseIn(p,x,v,w){return v*(p/=w)*p*p*p*p+x},StrongEaseOut(p,x,v,w){return v*((p=p/w-1)*p*p*p*p+1)+x},StrongEaseInOut(p,x,v,w){return(p/=w/2)<1?v/2*p*p*p*p*p+x:v/2*((p-=2)*p*p*p*p+2)+x},Linear(p,x,v,w){return v*p/w+x}}})(VS)),VS}var N6;function PT(){return N6||(N6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const t=tn(),r=Bs(),n=Qs(),s=L_(),a=NJ(),i=gL(),o=AJ(),c=QN(),u=XN(),d=Wa(),h=JN(),g=jJ(),p=fL(),x=M_();e.Konva=r.Util._assign(t.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:s.Container,Stage:a.Stage,stages:a.stages,Layer:i.Layer,FastLayer:o.FastLayer,Group:c.Group,DD:u.DD,Shape:d.Shape,shapes:d.shapes,Animation:h.Animation,Tween:g.Tween,Easings:g.Easings,Context:p.Context,Canvas:x.Canvas}),e.default=e.Konva})(BS)),BS}var ux={},A6;function PJ(){if(A6)return ux;A6=1,Object.defineProperty(ux,"__esModule",{value:!0}),ux.Arc=void 0;const e=ln(),t=Wa(),r=tn(),n=dn(),s=tn();class a extends t.Shape{_sceneFunc(o){const c=r.Konva.getAngle(this.angle()),u=this.clockwise();o.beginPath(),o.arc(0,0,this.outerRadius(),0,c,u),o.arc(0,0,this.innerRadius(),c,0,!u),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}getSelfRect(){const o=this.innerRadius(),c=this.outerRadius(),u=this.clockwise(),d=r.Konva.getAngle(u?360-this.angle():this.angle()),h=Math.cos(Math.min(d,Math.PI)),g=1,p=Math.sin(Math.min(Math.max(Math.PI,d),3*Math.PI/2)),x=Math.sin(Math.min(d,Math.PI/2)),v=h*(h>0?o:c),w=g*c,C=p*(p>0?o:c),k=x*(x>0?c:o);return{x:v,y:u?-1*k:C,width:w-v,height:k-C}}}return ux.Arc=a,a.prototype._centroid=!0,a.prototype.className="Arc",a.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1,(0,n.getBooleanValidator)()),ux}var dx={},fx={},j6;function mL(){if(j6)return fx;j6=1,Object.defineProperty(fx,"__esModule",{value:!0}),fx.Line=void 0;const e=ln(),t=tn(),r=Wa(),n=dn();function s(o,c,u,d,h,g,p){const x=Math.sqrt(Math.pow(u-o,2)+Math.pow(d-c,2)),v=Math.sqrt(Math.pow(h-u,2)+Math.pow(g-d,2)),w=p*x/(x+v),C=p*v/(x+v),k=u-w*(h-o),b=d-w*(g-c),N=u+C*(h-o),E=d+C*(g-c);return[k,b,N,E]}function a(o,c){const u=o.length,d=[];for(let h=2;h<u-2;h+=2){const g=s(o[h-2],o[h-1],o[h],o[h+1],o[h+2],o[h+3],c);isNaN(g[0])||(d.push(g[0]),d.push(g[1]),d.push(o[h]),d.push(o[h+1]),d.push(g[2]),d.push(g[3]))}return d}class i extends r.Shape{constructor(c){super(c),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(c){const u=this.points(),d=u.length,h=this.tension(),g=this.closed(),p=this.bezier();if(!d)return;let x=0;if(c.beginPath(),c.moveTo(u[0],u[1]),h!==0&&d>4){const v=this.getTensionPoints(),w=v.length;for(x=g?0:4,g||c.quadraticCurveTo(v[0],v[1],v[2],v[3]);x<w-2;)c.bezierCurveTo(v[x++],v[x++],v[x++],v[x++],v[x++],v[x++]);g||c.quadraticCurveTo(v[w-2],v[w-1],u[d-2],u[d-1])}else if(p)for(x=2;x<d;)c.bezierCurveTo(u[x++],u[x++],u[x++],u[x++],u[x++],u[x++]);else for(x=2;x<d;x+=2)c.lineTo(u[x],u[x+1]);g?(c.closePath(),c.fillStrokeShape(this)):c.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():a(this.points(),this.tension())}_getTensionPointsClosed(){const c=this.points(),u=c.length,d=this.tension(),h=s(c[u-2],c[u-1],c[0],c[1],c[2],c[3],d),g=s(c[u-4],c[u-3],c[u-2],c[u-1],c[0],c[1],d),p=a(c,d);return[h[2],h[3]].concat(p).concat([g[0],g[1],c[u-2],c[u-1],g[2],g[3],h[0],h[1],c[0],c[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let c=this.points();if(c.length<4)return{x:c[0]||0,y:c[1]||0,width:0,height:0};this.tension()!==0?c=[c[0],c[1],...this._getTensionPoints(),c[c.length-2],c[c.length-1]]:c=this.points();let u=c[0],d=c[0],h=c[1],g=c[1],p,x;for(let v=0;v<c.length/2;v++)p=c[v*2],x=c[v*2+1],u=Math.min(u,p),d=Math.max(d,p),h=Math.min(h,x),g=Math.max(g,x);return{x:u,y:h,width:d-u,height:g-h}}}return fx.Line=i,i.prototype.className="Line",i.prototype._attrsAffectingSize=["points","bezier","tension"],(0,t._registerNode)(i),e.Factory.addGetterSetter(i,"closed",!1),e.Factory.addGetterSetter(i,"bezier",!1),e.Factory.addGetterSetter(i,"tension",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"points",[],(0,n.getNumberArrayValidator)()),fx}var hx={},KS={},P6;function FJ(){return P6||(P6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(i,o,c)=>{let u,d;const g=c/2;u=0;for(let p=0;p<20;p++)d=g*e.tValues[20][p]+g,u+=e.cValues[20][p]*n(i,o,d);return g*u};e.getCubicArcLength=t;const r=(i,o,c)=>{c===void 0&&(c=1);const u=i[0]-2*i[1]+i[2],d=o[0]-2*o[1]+o[2],h=2*i[1]-2*i[0],g=2*o[1]-2*o[0],p=4*(u*u+d*d),x=4*(u*h+d*g),v=h*h+g*g;if(p===0)return c*Math.sqrt(Math.pow(i[2]-i[0],2)+Math.pow(o[2]-o[0],2));const w=x/(2*p),C=v/p,k=c+w,b=C-w*w,N=k*k+b>0?Math.sqrt(k*k+b):0,E=w*w+b>0?Math.sqrt(w*w+b):0,P=w+Math.sqrt(w*w+b)!==0?b*Math.log(Math.abs((k+N)/(w+E))):0;return Math.sqrt(p)/2*(k*N-w*E+P)};e.getQuadraticArcLength=r;function n(i,o,c){const u=s(1,c,i),d=s(1,c,o),h=u*u+d*d;return Math.sqrt(h)}const s=(i,o,c)=>{const u=c.length-1;let d,h;if(u===0)return 0;if(i===0){h=0;for(let g=0;g<=u;g++)h+=e.binomialCoefficients[u][g]*Math.pow(1-o,u-g)*Math.pow(o,g)*c[g];return h}else{d=new Array(u);for(let g=0;g<u;g++)d[g]=u*(c[g+1]-c[g]);return s(i-1,o,d)}},a=(i,o,c)=>{let u=1,d=i/o,h=(i-c(d))/o,g=0;for(;u>.001;){const p=c(d+h),x=Math.abs(i-p)/o;if(x<u)u=x,d+=h;else{const v=c(d-h),w=Math.abs(i-v)/o;w<u?(u=w,d-=h):h/=2}if(g++,g>500)break}return d};e.t2length=a})(KS)),KS}var F6;function ZN(){if(F6)return hx;F6=1,Object.defineProperty(hx,"__esModule",{value:!0}),hx.Path=void 0;const e=ln(),t=tn(),r=Wa(),n=FJ();class s extends r.Shape{constructor(i){super(i),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=s.parsePathData(this.data()),this.pathLength=s.getPathLength(this.dataArray)}_sceneFunc(i){const o=this.dataArray;i.beginPath();let c=!1;for(let u=0;u<o.length;u++){const d=o[u].command,h=o[u].points;switch(d){case"L":i.lineTo(h[0],h[1]);break;case"M":i.moveTo(h[0],h[1]);break;case"C":i.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5]);break;case"Q":i.quadraticCurveTo(h[0],h[1],h[2],h[3]);break;case"A":const g=h[0],p=h[1],x=h[2],v=h[3],w=h[4],C=h[5],k=h[6],b=h[7],N=x>v?x:v,E=x>v?1:x/v,P=x>v?v/x:1;i.translate(g,p),i.rotate(k),i.scale(E,P),i.arc(0,0,N,w,w+C,1-b),i.scale(1/E,1/P),i.rotate(-k),i.translate(-g,-p);break;case"z":c=!0,i.closePath();break}}!c&&!this.hasFill()?i.strokeShape(this):i.fillStrokeShape(this)}getSelfRect(){let i=[];this.dataArray.forEach(function(p){if(p.command==="A"){const x=p.points[4],v=p.points[5],w=p.points[4]+v;let C=Math.PI/180;if(Math.abs(x-w)<C&&(C=Math.abs(x-w)),v<0)for(let k=x-C;k>w;k-=C){const b=s.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],k,0);i.push(b.x,b.y)}else for(let k=x+C;k<w;k+=C){const b=s.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],k,0);i.push(b.x,b.y)}}else if(p.command==="C")for(let x=0;x<=1;x+=.01){const v=s.getPointOnCubicBezier(x,p.start.x,p.start.y,p.points[0],p.points[1],p.points[2],p.points[3],p.points[4],p.points[5]);i.push(v.x,v.y)}else i=i.concat(p.points)});let o=i[0],c=i[0],u=i[1],d=i[1],h,g;for(let p=0;p<i.length/2;p++)h=i[p*2],g=i[p*2+1],isNaN(h)||(o=Math.min(o,h),c=Math.max(c,h)),isNaN(g)||(u=Math.min(u,g),d=Math.max(d,g));return{x:o,y:u,width:c-o,height:d-u}}getLength(){return this.pathLength}getPointAtLength(i){return s.getPointAtLengthOfDataArray(i,this.dataArray)}static getLineLength(i,o,c,u){return Math.sqrt((c-i)*(c-i)+(u-o)*(u-o))}static getPathLength(i){let o=0;for(let c=0;c<i.length;++c)o+=i[c].pathLength;return o}static getPointAtLengthOfDataArray(i,o){let c,u=0,d=o.length;if(!d)return null;for(;u<d&&i>o[u].pathLength;)i-=o[u].pathLength,++u;if(u===d)return c=o[u-1].points.slice(-2),{x:c[0],y:c[1]};if(i<.01)return o[u].command==="M"?(c=o[u].points.slice(0,2),{x:c[0],y:c[1]}):{x:o[u].start.x,y:o[u].start.y};const h=o[u],g=h.points;switch(h.command){case"L":return s.getPointOnLine(i,h.start.x,h.start.y,g[0],g[1]);case"C":return s.getPointOnCubicBezier((0,n.t2length)(i,s.getPathLength(o),N=>(0,n.getCubicArcLength)([h.start.x,g[0],g[2],g[4]],[h.start.y,g[1],g[3],g[5]],N)),h.start.x,h.start.y,g[0],g[1],g[2],g[3],g[4],g[5]);case"Q":return s.getPointOnQuadraticBezier((0,n.t2length)(i,s.getPathLength(o),N=>(0,n.getQuadraticArcLength)([h.start.x,g[0],g[2]],[h.start.y,g[1],g[3]],N)),h.start.x,h.start.y,g[0],g[1],g[2],g[3]);case"A":const p=g[0],x=g[1],v=g[2],w=g[3],C=g[5],k=g[6];let b=g[4];return b+=C*i/h.pathLength,s.getPointOnEllipticalArc(p,x,v,w,b,k)}return null}static getPointOnLine(i,o,c,u,d,h,g){h=h??o,g=g??c;const p=this.getLineLength(o,c,u,d);if(p<1e-10)return{x:o,y:c};if(u===o)return{x:h,y:g+(d>c?i:-i)};const x=(d-c)/(u-o),v=Math.sqrt(i*i/(1+x*x))*(u<o?-1:1),w=x*v;if(Math.abs(g-c-x*(h-o))<1e-10)return{x:h+v,y:g+w};const C=((h-o)*(u-o)+(g-c)*(d-c))/(p*p),k=o+C*(u-o),b=c+C*(d-c),N=this.getLineLength(h,g,k,b),E=Math.sqrt(i*i-N*N),P=Math.sqrt(E*E/(1+x*x))*(u<o?-1:1),F=x*P;return{x:k+P,y:b+F}}static getPointOnCubicBezier(i,o,c,u,d,h,g,p,x){function v(E){return E*E*E}function w(E){return 3*E*E*(1-E)}function C(E){return 3*E*(1-E)*(1-E)}function k(E){return(1-E)*(1-E)*(1-E)}const b=p*v(i)+h*w(i)+u*C(i)+o*k(i),N=x*v(i)+g*w(i)+d*C(i)+c*k(i);return{x:b,y:N}}static getPointOnQuadraticBezier(i,o,c,u,d,h,g){function p(k){return k*k}function x(k){return 2*k*(1-k)}function v(k){return(1-k)*(1-k)}const w=h*p(i)+u*x(i)+o*v(i),C=g*p(i)+d*x(i)+c*v(i);return{x:w,y:C}}static getPointOnEllipticalArc(i,o,c,u,d,h){const g=Math.cos(h),p=Math.sin(h),x={x:c*Math.cos(d),y:u*Math.sin(d)};return{x:i+(x.x*g-x.y*p),y:o+(x.x*p+x.y*g)}}static parsePathData(i){if(!i)return[];let o=i;const c=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];o=o.replace(new RegExp(" ","g"),",");for(let w=0;w<c.length;w++)o=o.replace(new RegExp(c[w],"g"),"|"+c[w]);const u=o.split("|"),d=[],h=[];let g=0,p=0;const x=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let v;for(let w=1;w<u.length;w++){let C=u[w],k=C.charAt(0);for(C=C.slice(1),h.length=0;v=x.exec(C);)h.push(v[0]);const b=[];for(let N=0,E=h.length;N<E;N++){if(h[N]==="00"){b.push(0,0);continue}const P=parseFloat(h[N]);isNaN(P)?b.push(0):b.push(P)}for(;b.length>0&&!isNaN(b[0]);){let N="",E=[];const P=g,F=p;let A,j,I,B,Y,Z,ae,ee,ne,L;switch(k){case"l":g+=b.shift(),p+=b.shift(),N="L",E.push(g,p);break;case"L":g=b.shift(),p=b.shift(),E.push(g,p);break;case"m":const H=b.shift(),M=b.shift();if(g+=H,p+=M,N="M",d.length>2&&d[d.length-1].command==="z"){for(let V=d.length-2;V>=0;V--)if(d[V].command==="M"){g=d[V].points[0]+H,p=d[V].points[1]+M;break}}E.push(g,p),k="l";break;case"M":g=b.shift(),p=b.shift(),N="M",E.push(g,p),k="L";break;case"h":g+=b.shift(),N="L",E.push(g,p);break;case"H":g=b.shift(),N="L",E.push(g,p);break;case"v":p+=b.shift(),N="L",E.push(g,p);break;case"V":p=b.shift(),N="L",E.push(g,p);break;case"C":E.push(b.shift(),b.shift(),b.shift(),b.shift()),g=b.shift(),p=b.shift(),E.push(g,p);break;case"c":E.push(g+b.shift(),p+b.shift(),g+b.shift(),p+b.shift()),g+=b.shift(),p+=b.shift(),N="C",E.push(g,p);break;case"S":j=g,I=p,A=d[d.length-1],A.command==="C"&&(j=g+(g-A.points[2]),I=p+(p-A.points[3])),E.push(j,I,b.shift(),b.shift()),g=b.shift(),p=b.shift(),N="C",E.push(g,p);break;case"s":j=g,I=p,A=d[d.length-1],A.command==="C"&&(j=g+(g-A.points[2]),I=p+(p-A.points[3])),E.push(j,I,g+b.shift(),p+b.shift()),g+=b.shift(),p+=b.shift(),N="C",E.push(g,p);break;case"Q":E.push(b.shift(),b.shift()),g=b.shift(),p=b.shift(),E.push(g,p);break;case"q":E.push(g+b.shift(),p+b.shift()),g+=b.shift(),p+=b.shift(),N="Q",E.push(g,p);break;case"T":j=g,I=p,A=d[d.length-1],A.command==="Q"&&(j=g+(g-A.points[0]),I=p+(p-A.points[1])),g=b.shift(),p=b.shift(),N="Q",E.push(j,I,g,p);break;case"t":j=g,I=p,A=d[d.length-1],A.command==="Q"&&(j=g+(g-A.points[0]),I=p+(p-A.points[1])),g+=b.shift(),p+=b.shift(),N="Q",E.push(j,I,g,p);break;case"A":B=b.shift(),Y=b.shift(),Z=b.shift(),ae=b.shift(),ee=b.shift(),ne=g,L=p,g=b.shift(),p=b.shift(),N="A",E=this.convertEndpointToCenterParameterization(ne,L,g,p,ae,ee,B,Y,Z);break;case"a":B=b.shift(),Y=b.shift(),Z=b.shift(),ae=b.shift(),ee=b.shift(),ne=g,L=p,g+=b.shift(),p+=b.shift(),N="A",E=this.convertEndpointToCenterParameterization(ne,L,g,p,ae,ee,B,Y,Z);break}d.push({command:N||k,points:E,start:{x:P,y:F},pathLength:this.calcLength(P,F,N||k,E)})}(k==="z"||k==="Z")&&d.push({command:"z",points:[],start:void 0,pathLength:0})}return d}static calcLength(i,o,c,u){let d,h,g,p;const x=s;switch(c){case"L":return x.getLineLength(i,o,u[0],u[1]);case"C":return(0,n.getCubicArcLength)([i,u[0],u[2],u[4]],[o,u[1],u[3],u[5]],1);case"Q":return(0,n.getQuadraticArcLength)([i,u[0],u[2]],[o,u[1],u[3]],1);case"A":d=0;const v=u[4],w=u[5],C=u[4]+w;let k=Math.PI/180;if(Math.abs(v-C)<k&&(k=Math.abs(v-C)),h=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],v,0),w<0)for(p=v-k;p>C;p-=k)g=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],p,0),d+=x.getLineLength(h.x,h.y,g.x,g.y),h=g;else for(p=v+k;p<C;p+=k)g=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],p,0),d+=x.getLineLength(h.x,h.y,g.x,g.y),h=g;return g=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],C,0),d+=x.getLineLength(h.x,h.y,g.x,g.y),d}return 0}static convertEndpointToCenterParameterization(i,o,c,u,d,h,g,p,x){const v=x*(Math.PI/180),w=Math.cos(v)*(i-c)/2+Math.sin(v)*(o-u)/2,C=-1*Math.sin(v)*(i-c)/2+Math.cos(v)*(o-u)/2,k=w*w/(g*g)+C*C/(p*p);k>1&&(g*=Math.sqrt(k),p*=Math.sqrt(k));let b=Math.sqrt((g*g*(p*p)-g*g*(C*C)-p*p*(w*w))/(g*g*(C*C)+p*p*(w*w)));d===h&&(b*=-1),isNaN(b)&&(b=0);const N=b*g*C/p,E=b*-p*w/g,P=(i+c)/2+Math.cos(v)*N-Math.sin(v)*E,F=(o+u)/2+Math.sin(v)*N+Math.cos(v)*E,A=function(ee){return Math.sqrt(ee[0]*ee[0]+ee[1]*ee[1])},j=function(ee,ne){return(ee[0]*ne[0]+ee[1]*ne[1])/(A(ee)*A(ne))},I=function(ee,ne){return(ee[0]*ne[1]<ee[1]*ne[0]?-1:1)*Math.acos(j(ee,ne))},B=I([1,0],[(w-N)/g,(C-E)/p]),Y=[(w-N)/g,(C-E)/p],Z=[(-1*w-N)/g,(-1*C-E)/p];let ae=I(Y,Z);return j(Y,Z)<=-1&&(ae=Math.PI),j(Y,Z)>=1&&(ae=0),h===0&&ae>0&&(ae=ae-2*Math.PI),h===1&&ae<0&&(ae=ae+2*Math.PI),[P,F,g,p,B,ae,v,h]}}return hx.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,t._registerNode)(s),e.Factory.addGetterSetter(s,"data"),hx}var O6;function OJ(){if(O6)return dx;O6=1,Object.defineProperty(dx,"__esModule",{value:!0}),dx.Arrow=void 0;const e=ln(),t=mL(),r=dn(),n=tn(),s=ZN();class a extends t.Line{_sceneFunc(o){super._sceneFunc(o);const c=Math.PI*2,u=this.points();let d=u;const h=this.tension()!==0&&u.length>4;h&&(d=this.getTensionPoints());const g=this.pointerLength(),p=u.length;let x,v;if(h){const k=[d[d.length-4],d[d.length-3],d[d.length-2],d[d.length-1],u[p-2],u[p-1]],b=s.Path.calcLength(d[d.length-4],d[d.length-3],"C",k),N=s.Path.getPointOnQuadraticBezier(Math.min(1,1-g/b),k[0],k[1],k[2],k[3],k[4],k[5]);x=u[p-2]-N.x,v=u[p-1]-N.y}else x=u[p-2]-u[p-4],v=u[p-1]-u[p-3];const w=(Math.atan2(v,x)+c)%c,C=this.pointerWidth();this.pointerAtEnding()&&(o.save(),o.beginPath(),o.translate(u[p-2],u[p-1]),o.rotate(w),o.moveTo(0,0),o.lineTo(-g,C/2),o.lineTo(-g,-C/2),o.closePath(),o.restore(),this.__fillStroke(o)),this.pointerAtBeginning()&&(o.save(),o.beginPath(),o.translate(u[0],u[1]),h?(x=(d[0]+d[2])/2-u[0],v=(d[1]+d[3])/2-u[1]):(x=u[2]-u[0],v=u[3]-u[1]),o.rotate((Math.atan2(-v,-x)+c)%c),o.moveTo(0,0),o.lineTo(-g,C/2),o.lineTo(-g,-C/2),o.closePath(),o.restore(),this.__fillStroke(o))}__fillStroke(o){const c=this.dashEnabled();c&&(this.attrs.dashEnabled=!1,o.setLineDash([])),o.fillStrokeShape(this),c&&(this.attrs.dashEnabled=!0)}getSelfRect(){const o=super.getSelfRect(),c=this.pointerWidth()/2;return{x:o.x,y:o.y-c,width:o.width,height:o.height+c*2}}}return dx.Arrow=a,a.prototype.className="Arrow",(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"pointerLength",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerWidth",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerAtBeginning",!1),e.Factory.addGetterSetter(a,"pointerAtEnding",!0),dx}var gx={},D6;function DJ(){if(D6)return gx;D6=1,Object.defineProperty(gx,"__esModule",{value:!0}),gx.Circle=void 0;const e=ln(),t=Wa(),r=dn(),n=tn();class s extends t.Shape{_sceneFunc(i){i.beginPath(),i.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius()!==i/2&&this.radius(i/2)}setHeight(i){this.radius()!==i/2&&this.radius(i/2)}}return gx.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),gx}var mx={},I6;function IJ(){if(I6)return mx;I6=1,Object.defineProperty(mx,"__esModule",{value:!0}),mx.Ellipse=void 0;const e=ln(),t=Wa(),r=dn(),n=tn();class s extends t.Shape{_sceneFunc(i){const o=this.radiusX(),c=this.radiusY();i.beginPath(),i.save(),o!==c&&i.scale(1,c/o),i.arc(0,0,o,0,Math.PI*2,!1),i.restore(),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(i){this.radiusX(i/2)}setHeight(i){this.radiusY(i/2)}}return mx.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,n._registerNode)(s),e.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),e.Factory.addGetterSetter(s,"radiusX",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"radiusY",0,(0,r.getNumberValidator)()),mx}var px={},R6;function RJ(){if(R6)return px;R6=1,Object.defineProperty(px,"__esModule",{value:!0}),px.Image=void 0;const e=Bs(),t=ln(),r=Wa(),n=tn(),s=dn();class a extends r.Shape{constructor(o){super(o),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",c=>{this._removeImageLoad(c.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const o=this.image();o&&o.complete||o&&o.readyState===4||o&&o.addEventListener&&o.addEventListener("load",this._loadListener)}_removeImageLoad(o){o&&o.removeEventListener&&o.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const o=!!this.cornerRadius(),c=this.hasShadow();return o&&c?!0:super._useBufferCanvas(!0)}_sceneFunc(o){const c=this.getWidth(),u=this.getHeight(),d=this.cornerRadius(),h=this.attrs.image;let g;if(h){const p=this.attrs.cropWidth,x=this.attrs.cropHeight;p&&x?g=[h,this.cropX(),this.cropY(),p,x,0,0,c,u]:g=[h,0,0,c,u]}(this.hasFill()||this.hasStroke()||d)&&(o.beginPath(),d?e.Util.drawRoundedRectPath(o,c,u,d):o.rect(0,0,c,u),o.closePath(),o.fillStrokeShape(this)),h&&(d&&o.clip(),o.drawImage.apply(o,g))}_hitFunc(o){const c=this.width(),u=this.height(),d=this.cornerRadius();o.beginPath(),d?e.Util.drawRoundedRectPath(o,c,u,d):o.rect(0,0,c,u),o.closePath(),o.fillStrokeShape(this)}getWidth(){var o,c;return(o=this.attrs.width)!==null&&o!==void 0?o:(c=this.image())===null||c===void 0?void 0:c.width}getHeight(){var o,c;return(o=this.attrs.height)!==null&&o!==void 0?o:(c=this.image())===null||c===void 0?void 0:c.height}static fromURL(o,c,u=null){const d=e.Util.createImageElement();d.onload=function(){const h=new a({image:d});c(h)},d.onerror=u,d.crossOrigin="Anonymous",d.src=o}}return px.Image=a,a.prototype.className="Image",(0,n._registerNode)(a),t.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),t.Factory.addGetterSetter(a,"image"),t.Factory.addComponentsGetterSetter(a,"crop",["x","y","width","height"]),t.Factory.addGetterSetter(a,"cropX",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropY",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropWidth",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropHeight",0,(0,s.getNumberValidator)()),px}var bh={},M6;function MJ(){if(M6)return bh;M6=1,Object.defineProperty(bh,"__esModule",{value:!0}),bh.Tag=bh.Label=void 0;const e=ln(),t=Wa(),r=QN(),n=dn(),s=tn(),a=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],i="Change.konva",o="none",c="up",u="right",d="down",h="left",g=a.length;class p extends r.Group{constructor(w){super(w),this.on("add.konva",function(C){this._addListeners(C.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(w){let C=this,k;const b=function(){C._sync()};for(k=0;k<g;k++)w.on(a[k]+i,b)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let w=this.getText(),C=this.getTag(),k,b,N,E,P,F,A;if(w&&C){switch(k=w.width(),b=w.height(),N=C.pointerDirection(),E=C.pointerWidth(),A=C.pointerHeight(),P=0,F=0,N){case c:P=k/2,F=-1*A;break;case u:P=k+E,F=b/2;break;case d:P=k/2,F=b+A;break;case h:P=-1*E,F=b/2;break}C.setAttrs({x:-1*P,y:-1*F,width:k,height:b}),w.setAttrs({x:-1*P,y:-1*F})}}}bh.Label=p,p.prototype.className="Label",(0,s._registerNode)(p);class x extends t.Shape{_sceneFunc(w){const C=this.width(),k=this.height(),b=this.pointerDirection(),N=this.pointerWidth(),E=this.pointerHeight(),P=this.cornerRadius();let F=0,A=0,j=0,I=0;typeof P=="number"?F=A=j=I=Math.min(P,C/2,k/2):(F=Math.min(P[0]||0,C/2,k/2),A=Math.min(P[1]||0,C/2,k/2),I=Math.min(P[2]||0,C/2,k/2),j=Math.min(P[3]||0,C/2,k/2)),w.beginPath(),w.moveTo(F,0),b===c&&(w.lineTo((C-N)/2,0),w.lineTo(C/2,-1*E),w.lineTo((C+N)/2,0)),w.lineTo(C-A,0),w.arc(C-A,A,A,Math.PI*3/2,0,!1),b===u&&(w.lineTo(C,(k-E)/2),w.lineTo(C+N,k/2),w.lineTo(C,(k+E)/2)),w.lineTo(C,k-I),w.arc(C-I,k-I,I,0,Math.PI/2,!1),b===d&&(w.lineTo((C+N)/2,k),w.lineTo(C/2,k+E),w.lineTo((C-N)/2,k)),w.lineTo(j,k),w.arc(j,k-j,j,Math.PI/2,Math.PI,!1),b===h&&(w.lineTo(0,(k+E)/2),w.lineTo(-1*N,k/2),w.lineTo(0,(k-E)/2)),w.lineTo(0,F),w.arc(F,F,F,Math.PI,Math.PI*3/2,!1),w.closePath(),w.fillStrokeShape(this)}getSelfRect(){let w=0,C=0,k=this.pointerWidth(),b=this.pointerHeight(),N=this.pointerDirection(),E=this.width(),P=this.height();return N===c?(C-=b,P+=b):N===d?P+=b:N===h?(w-=k*1.5,E+=k):N===u&&(E+=k*1.5),{x:w,y:C,width:E,height:P}}}return bh.Tag=x,x.prototype.className="Tag",(0,s._registerNode)(x),e.Factory.addGetterSetter(x,"pointerDirection",o),e.Factory.addGetterSetter(x,"pointerWidth",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(x,"pointerHeight",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(x,"cornerRadius",0,(0,n.getNumberOrArrayOfNumbersValidator)(4)),bh}var xx={},L6;function pL(){if(L6)return xx;L6=1,Object.defineProperty(xx,"__esModule",{value:!0}),xx.Rect=void 0;const e=ln(),t=Wa(),r=tn(),n=Bs(),s=dn();class a extends t.Shape{_sceneFunc(o){const c=this.cornerRadius(),u=this.width(),d=this.height();o.beginPath(),c?n.Util.drawRoundedRectPath(o,u,d,c):o.rect(0,0,u,d),o.closePath(),o.fillStrokeShape(this)}}return xx.Rect=a,a.prototype.className="Rect",(0,r._registerNode)(a),e.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),xx}var yx={},B6;function LJ(){if(B6)return yx;B6=1,Object.defineProperty(yx,"__esModule",{value:!0}),yx.RegularPolygon=void 0;const e=ln(),t=Wa(),r=dn(),n=tn();class s extends t.Shape{_sceneFunc(i){const o=this._getPoints();i.beginPath(),i.moveTo(o[0].x,o[0].y);for(let c=1;c<o.length;c++)i.lineTo(o[c].x,o[c].y);i.closePath(),i.fillStrokeShape(this)}_getPoints(){const i=this.attrs.sides,o=this.attrs.radius||0,c=[];for(let u=0;u<i;u++)c.push({x:o*Math.sin(u*2*Math.PI/i),y:-1*o*Math.cos(u*2*Math.PI/i)});return c}getSelfRect(){const i=this._getPoints();let o=i[0].x,c=i[0].y,u=i[0].x,d=i[0].y;return i.forEach(h=>{o=Math.min(o,h.x),c=Math.max(c,h.x),u=Math.min(u,h.y),d=Math.max(d,h.y)}),{x:o,y:u,width:c-o,height:d-u}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius(i/2)}setHeight(i){this.radius(i/2)}}return yx.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"sides",0,(0,r.getNumberValidator)()),yx}var vx={},$6;function BJ(){if($6)return vx;$6=1,Object.defineProperty(vx,"__esModule",{value:!0}),vx.Ring=void 0;const e=ln(),t=Wa(),r=dn(),n=tn(),s=Math.PI*2;class a extends t.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.innerRadius(),0,s,!1),o.moveTo(this.outerRadius(),0),o.arc(0,0,this.outerRadius(),s,0,!0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}}return vx.Ring=a,a.prototype.className="Ring",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,r.getNumberValidator)()),vx}var wx={},U6;function $J(){if(U6)return wx;U6=1,Object.defineProperty(wx,"__esModule",{value:!0}),wx.Sprite=void 0;const e=ln(),t=Wa(),r=JN(),n=dn(),s=tn();class a extends t.Shape{constructor(o){super(o),this._updated=!0,this.anim=new r.Animation(()=>{const c=this._updated;return this._updated=!1,c}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(o){const c=this.animation(),u=this.frameIndex(),d=u*4,h=this.animations()[c],g=this.frameOffsets(),p=h[d+0],x=h[d+1],v=h[d+2],w=h[d+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(o.beginPath(),o.rect(0,0,v,w),o.closePath(),o.fillStrokeShape(this)),C)if(g){const k=g[c],b=u*2;o.drawImage(C,p,x,v,w,k[b+0],k[b+1],v,w)}else o.drawImage(C,p,x,v,w,0,0,v,w)}_hitFunc(o){const c=this.animation(),u=this.frameIndex(),d=u*4,h=this.animations()[c],g=this.frameOffsets(),p=h[d+2],x=h[d+3];if(o.beginPath(),g){const v=g[c],w=u*2;o.rect(v[w+0],v[w+1],p,x)}else o.rect(0,0,p,x);o.closePath(),o.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const o=this;this.interval=setInterval(function(){o._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const o=this.getLayer();this.anim.setLayers(o),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const o=this.frameIndex(),c=this.animation(),u=this.animations(),d=u[c],h=d.length/4;o<h-1?this.frameIndex(o+1):this.frameIndex(0)}}return wx.Sprite=a,a.prototype.className="Sprite",(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"animation"),e.Factory.addGetterSetter(a,"animations"),e.Factory.addGetterSetter(a,"frameOffsets"),e.Factory.addGetterSetter(a,"image"),e.Factory.addGetterSetter(a,"frameIndex",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"frameRate",17,(0,n.getNumberValidator)()),e.Factory.backCompat(a,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),wx}var bx={},z6;function UJ(){if(z6)return bx;z6=1,Object.defineProperty(bx,"__esModule",{value:!0}),bx.Star=void 0;const e=ln(),t=Wa(),r=dn(),n=tn();class s extends t.Shape{_sceneFunc(i){const o=this.innerRadius(),c=this.outerRadius(),u=this.numPoints();i.beginPath(),i.moveTo(0,0-c);for(let d=1;d<u*2;d++){const h=d%2===0?c:o,g=h*Math.sin(d*Math.PI/u),p=-1*h*Math.cos(d*Math.PI/u);i.lineTo(g,p)}i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(i){this.outerRadius(i/2)}setHeight(i){this.outerRadius(i/2)}}return bx.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"numPoints",5,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"outerRadius",0,(0,r.getNumberValidator)()),bx}var Fg={},W6;function xL(){if(W6)return Fg;W6=1,Object.defineProperty(Fg,"__esModule",{value:!0}),Fg.Text=void 0,Fg.stringToArray=i;const e=Bs(),t=ln(),r=Wa(),n=tn(),s=dn(),a=tn();function i(R){return[...R].reduce((U,q,Q,se)=>{if(new RegExp("\\p{Emoji}","u").test(q)){const X=se[Q+1];X&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(X)?(U.push(q+X),se[Q+1]=""):U.push(q)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(q+(se[Q+1]||""))?U.push(q+se[Q+1]):Q>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(q)?U[U.length-1]+=q:q&&U.push(q);return U},[])}const o="auto",c="center",u="inherit",d="justify",h="Change.konva",g="2d",p="-",x="left",v="text",w="Text",C="top",k="bottom",b="middle",N="normal",E="px ",P=" ",F="right",A="rtl",j="word",I="char",B="none",Y="",Z=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],ae=Z.length;function ee(R){return R.split(",").map(U=>{U=U.trim();const q=U.indexOf(" ")>=0,Q=U.indexOf('"')>=0||U.indexOf("'")>=0;return q&&!Q&&(U=`"${U}"`),U}).join(", ")}let ne;function L(){return ne||(ne=e.Util.createCanvasElement().getContext(g),ne)}function H(R){R.fillText(this._partialText,this._partialTextX,this._partialTextY)}function M(R){R.setAttr("miterLimit",2),R.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function V(R){return R=R||{},!R.fillLinearGradientColorStops&&!R.fillRadialGradientColorStops&&!R.fillPatternImage&&(R.fill=R.fill||"black"),R}class W extends r.Shape{constructor(U){super(V(U)),this._partialTextX=0,this._partialTextY=0;for(let q=0;q<ae;q++)this.on(Z[q]+h,this._setTextData);this._setTextData()}_sceneFunc(U){const q=this.textArr,Q=q.length;if(!this.text())return;let se=this.padding(),X=this.fontSize(),ie=this.lineHeight()*X,le=this.verticalAlign(),ce=this.direction(),Se=0,re=this.align(),ge=this.getWidth(),Ee=this.letterSpacing(),Ae=this.fill(),He=this.textDecoration(),Be=He.indexOf("underline")!==-1,Rt=He.indexOf("line-through")!==-1,et;ce=ce===u?U.direction:ce;let vt=ie/2,xt=b;if(n.Konva._fixTextRendering){const it=this.measureSize("M");xt="alphabetic",vt=(it.fontBoundingBoxAscent-it.fontBoundingBoxDescent)/2+ie/2}for(ce===A&&U.setAttr("direction",ce),U.setAttr("font",this._getContextFont()),U.setAttr("textBaseline",xt),U.setAttr("textAlign",x),le===b?Se=(this.getHeight()-Q*ie-se*2)/2:le===k&&(Se=this.getHeight()-Q*ie-se*2),U.translate(se,Se+se),et=0;et<Q;et++){let it=0,ht=0;const Dt=q[et],Mt=Dt.text,Xe=Dt.width,De=Dt.lastInParagraph;if(U.save(),re===F?it+=ge-Xe-se*2:re===c&&(it+=(ge-Xe-se*2)/2),Be){U.save(),U.beginPath();const Le=n.Konva._fixTextRendering?Math.round(X/4):Math.round(X/2),lt=it,Ue=vt+ht+Le;U.moveTo(lt,Ue);const tt=re===d&&!De?ge-se*2:Xe;U.lineTo(lt+Math.round(tt),Ue),U.lineWidth=X/15;const Et=this._getLinearGradient();U.strokeStyle=Et||Ae,U.stroke(),U.restore()}if(Rt){U.save(),U.beginPath();const Le=n.Konva._fixTextRendering?-Math.round(X/4):0;U.moveTo(it,vt+ht+Le);const lt=re===d&&!De?ge-se*2:Xe;U.lineTo(it+Math.round(lt),vt+ht+Le),U.lineWidth=X/15;const Ue=this._getLinearGradient();U.strokeStyle=Ue||Ae,U.stroke(),U.restore()}if(ce!==A&&(Ee!==0||re===d)){const Le=Mt.split(" ").length-1,lt=i(Mt);for(let Ue=0;Ue<lt.length;Ue++){const tt=lt[Ue];tt===" "&&!De&&re===d&&(it+=(ge-se*2-Xe)/Le),this._partialTextX=it,this._partialTextY=vt+ht,this._partialText=tt,U.fillStrokeShape(this),it+=this.measureSize(tt).width+Ee}}else Ee!==0&&U.setAttr("letterSpacing",`${Ee}px`),this._partialTextX=it,this._partialTextY=vt+ht,this._partialText=Mt,U.fillStrokeShape(this);U.restore(),Q>1&&(vt+=ie)}}_hitFunc(U){const q=this.getWidth(),Q=this.getHeight();U.beginPath(),U.rect(0,0,q,Q),U.closePath(),U.fillStrokeShape(this)}setText(U){const q=e.Util._isString(U)?U:U==null?"":U+"";return this._setAttr(v,q),this}getWidth(){return this.attrs.width===o||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===o||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(U){var q,Q,se,X,ie,le,ce,Se,re,ge,Ee;let Ae=L(),He=this.fontSize(),Be;Ae.save(),Ae.font=this._getContextFont(),Be=Ae.measureText(U),Ae.restore();const Rt=He/100;return{actualBoundingBoxAscent:(q=Be.actualBoundingBoxAscent)!==null&&q!==void 0?q:71.58203125*Rt,actualBoundingBoxDescent:(Q=Be.actualBoundingBoxDescent)!==null&&Q!==void 0?Q:0,actualBoundingBoxLeft:(se=Be.actualBoundingBoxLeft)!==null&&se!==void 0?se:-7.421875*Rt,actualBoundingBoxRight:(X=Be.actualBoundingBoxRight)!==null&&X!==void 0?X:75.732421875*Rt,alphabeticBaseline:(ie=Be.alphabeticBaseline)!==null&&ie!==void 0?ie:0,emHeightAscent:(le=Be.emHeightAscent)!==null&&le!==void 0?le:100*Rt,emHeightDescent:(ce=Be.emHeightDescent)!==null&&ce!==void 0?ce:-20*Rt,fontBoundingBoxAscent:(Se=Be.fontBoundingBoxAscent)!==null&&Se!==void 0?Se:91*Rt,fontBoundingBoxDescent:(re=Be.fontBoundingBoxDescent)!==null&&re!==void 0?re:21*Rt,hangingBaseline:(ge=Be.hangingBaseline)!==null&&ge!==void 0?ge:72.80000305175781*Rt,ideographicBaseline:(Ee=Be.ideographicBaseline)!==null&&Ee!==void 0?Ee:-21*Rt,width:Be.width,height:He}}_getContextFont(){return this.fontStyle()+P+this.fontVariant()+P+(this.fontSize()+E)+ee(this.fontFamily())}_addTextLine(U){this.align()===d&&(U=U.trim());const Q=this._getTextWidth(U);return this.textArr.push({text:U,width:Q,lastInParagraph:!1})}_getTextWidth(U){const q=this.letterSpacing(),Q=U.length;return L().measureText(U).width+q*Q}_setTextData(){let U=this.text().split(`
`),q=+this.fontSize(),Q=0,se=this.lineHeight()*q,X=this.attrs.width,ie=this.attrs.height,le=X!==o&&X!==void 0,ce=ie!==o&&ie!==void 0,Se=this.padding(),re=X-Se*2,ge=ie-Se*2,Ee=0,Ae=this.wrap(),He=Ae!==B,Be=Ae!==I&&He,Rt=this.ellipsis();this.textArr=[],L().font=this._getContextFont();const et=Rt?this._getTextWidth(Y):0;for(let vt=0,xt=U.length;vt<xt;++vt){let it=U[vt],ht=this._getTextWidth(it);if(le&&ht>re)for(;it.length>0;){let Dt=0,Mt=i(it).length,Xe="",De=0;for(;Dt<Mt;){const Le=Dt+Mt>>>1,lt=i(it),Ue=lt.slice(0,Le+1).join(""),tt=this._getTextWidth(Ue);(Rt&&ce&&Ee+se>ge?tt+et:tt)<=re?(Dt=Le+1,Xe=Ue,De=tt):Mt=Le}if(Xe){if(Be){const Ue=i(it),tt=i(Xe),Et=Ue[tt.length],At=Et===P||Et===p;let qt;if(At&&De<=re)qt=tt.length;else{const pr=tt.lastIndexOf(P),Rr=tt.lastIndexOf(p);qt=Math.max(pr,Rr)+1}qt>0&&(Dt=qt,Xe=Ue.slice(0,Dt).join(""),De=this._getTextWidth(Xe))}if(Xe=Xe.trimRight(),this._addTextLine(Xe),Q=Math.max(Q,De),Ee+=se,this._shouldHandleEllipsis(Ee)){this._tryToAddEllipsisToLastLine();break}if(it=i(it).slice(Dt).join("").trimLeft(),it.length>0&&(ht=this._getTextWidth(it),ht<=re)){this._addTextLine(it),Ee+=se,Q=Math.max(Q,ht);break}}else break}else this._addTextLine(it),Ee+=se,Q=Math.max(Q,ht),this._shouldHandleEllipsis(Ee)&&vt<xt-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),ce&&Ee+se>ge)break}this.textHeight=q,this.textWidth=Q}_shouldHandleEllipsis(U){const q=+this.fontSize(),Q=this.lineHeight()*q,se=this.attrs.height,X=se!==o&&se!==void 0,ie=this.padding(),le=se-ie*2;return!(this.wrap()!==B)||X&&U+Q>le}_tryToAddEllipsisToLastLine(){const U=this.attrs.width,q=U!==o&&U!==void 0,Q=this.padding(),se=U-Q*2,X=this.ellipsis(),ie=this.textArr[this.textArr.length-1];!ie||!X||(q&&(this._getTextWidth(ie.text+Y)<se||(ie.text=ie.text.slice(0,ie.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(ie.text+Y))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const U=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,q=this.hasShadow();return U&&q?!0:super._useBufferCanvas()}}return Fg.Text=W,W.prototype._fillFunc=H,W.prototype._strokeFunc=M,W.prototype.className=w,W.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,a._registerNode)(W),t.Factory.overWriteSetter(W,"width",(0,s.getNumberOrAutoValidator)()),t.Factory.overWriteSetter(W,"height",(0,s.getNumberOrAutoValidator)()),t.Factory.addGetterSetter(W,"direction",u),t.Factory.addGetterSetter(W,"fontFamily","Arial"),t.Factory.addGetterSetter(W,"fontSize",12,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"fontStyle",N),t.Factory.addGetterSetter(W,"fontVariant",N),t.Factory.addGetterSetter(W,"padding",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"align",x),t.Factory.addGetterSetter(W,"verticalAlign",C),t.Factory.addGetterSetter(W,"lineHeight",1,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"wrap",j),t.Factory.addGetterSetter(W,"ellipsis",!1,(0,s.getBooleanValidator)()),t.Factory.addGetterSetter(W,"letterSpacing",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"text","",(0,s.getStringValidator)()),t.Factory.addGetterSetter(W,"textDecoration",""),Fg}var _x={},H6;function zJ(){if(H6)return _x;H6=1,Object.defineProperty(_x,"__esModule",{value:!0}),_x.TextPath=void 0;const e=Bs(),t=ln(),r=Wa(),n=ZN(),s=xL(),a=dn(),i=tn(),o="",c="normal";function u(g){g.fillText(this.partialText,0,0)}function d(g){g.strokeText(this.partialText,0,0)}class h extends r.Shape{constructor(p){super(p),this.dummyCanvas=e.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return n.Path.getPathLength(this.dataArray)}_getPointAtLength(p){if(!this.attrs.data)return null;const x=this.pathLength;return p-1>x?null:n.Path.getPointAtLengthOfDataArray(p,this.dataArray)}_readDataAttribute(){this.dataArray=n.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(p){p.setAttr("font",this._getContextFont()),p.setAttr("textBaseline",this.textBaseline()),p.setAttr("textAlign","left"),p.save();const x=this.textDecoration(),v=this.fill(),w=this.fontSize(),C=this.glyphInfo;x==="underline"&&p.beginPath();for(let k=0;k<C.length;k++){p.save();const b=C[k].p0;p.translate(b.x,b.y),p.rotate(C[k].rotation),this.partialText=C[k].text,p.fillStrokeShape(this),x==="underline"&&(k===0&&p.moveTo(0,w/2+1),p.lineTo(w,w/2+1)),p.restore()}x==="underline"&&(p.strokeStyle=v,p.lineWidth=w/20,p.stroke()),p.restore()}_hitFunc(p){p.beginPath();const x=this.glyphInfo;if(x.length>=1){const v=x[0].p0;p.moveTo(v.x,v.y)}for(let v=0;v<x.length;v++){const w=x[v].p1;p.lineTo(w.x,w.y)}p.setAttr("lineWidth",this.fontSize()),p.setAttr("strokeStyle",this.colorKey),p.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(p){return s.Text.prototype.setText.call(this,p)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(p){const v=this.dummyCanvas.getContext("2d");v.save(),v.font=this._getContextFont();const w=v.measureText(p);return v.restore(),{width:w.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:p,height:x}=this._getTextSize(this.attrs.text);if(this.textWidth=p,this.textHeight=x,this.glyphInfo=[],!this.attrs.data)return null;const v=this.letterSpacing(),w=this.align(),C=this.kerningFunc(),k=Math.max(this.textWidth+((this.attrs.text||"").length-1)*v,0);let b=0;w==="center"&&(b=Math.max(0,this.pathLength/2-k/2)),w==="right"&&(b=Math.max(0,this.pathLength-k));const N=(0,s.stringToArray)(this.text());let E=b;for(let P=0;P<N.length;P++){const F=this._getPointAtLength(E);if(!F)return;let A=this._getTextSize(N[P]).width+v;if(N[P]===" "&&w==="justify"){const ae=this.text().split(" ").length-1;A+=(this.pathLength-k)/ae}const j=this._getPointAtLength(E+A);if(!j)return;const I=n.Path.getLineLength(F.x,F.y,j.x,j.y);let B=0;if(C)try{B=C(N[P-1],N[P])*this.fontSize()}catch{B=0}F.x+=B,j.x+=B,this.textWidth+=B;const Y=n.Path.getPointOnLine(B+I/2,F.x,F.y,j.x,j.y),Z=Math.atan2(j.y-F.y,j.x-F.x);this.glyphInfo.push({transposeX:Y.x,transposeY:Y.y,text:N[P],rotation:Z,p0:F,p1:j}),E+=A}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const p=[];this.glyphInfo.forEach(function(E){p.push(E.p0.x),p.push(E.p0.y),p.push(E.p1.x),p.push(E.p1.y)});let x=p[0]||0,v=p[0]||0,w=p[1]||0,C=p[1]||0,k,b;for(let E=0;E<p.length/2;E++)k=p[E*2],b=p[E*2+1],x=Math.min(x,k),v=Math.max(v,k),w=Math.min(w,b),C=Math.max(C,b);const N=this.fontSize();return{x:x-N/2,y:w-N/2,width:v-x+N,height:C-w+N}}destroy(){return e.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}return _x.TextPath=h,h.prototype._fillFunc=u,h.prototype._strokeFunc=d,h.prototype._fillFuncHit=u,h.prototype._strokeFuncHit=d,h.prototype.className="TextPath",h.prototype._attrsAffectingSize=["text","fontSize","data"],(0,i._registerNode)(h),t.Factory.addGetterSetter(h,"data"),t.Factory.addGetterSetter(h,"fontFamily","Arial"),t.Factory.addGetterSetter(h,"fontSize",12,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(h,"fontStyle",c),t.Factory.addGetterSetter(h,"align","left"),t.Factory.addGetterSetter(h,"letterSpacing",0,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(h,"textBaseline","middle"),t.Factory.addGetterSetter(h,"fontVariant",c),t.Factory.addGetterSetter(h,"text",o),t.Factory.addGetterSetter(h,"textDecoration",""),t.Factory.addGetterSetter(h,"kerningFunc",void 0),_x}var Sx={},G6;function WJ(){if(G6)return Sx;G6=1,Object.defineProperty(Sx,"__esModule",{value:!0}),Sx.Transformer=void 0;const e=Bs(),t=ln(),r=Qs(),n=Wa(),s=pL(),a=QN(),i=tn(),o=dn(),c=tn(),u="tr-konva",d=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(A=>A+`.${u}`).join(" "),h="nodesRect",g=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],p={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},x="ontouchstart"in i.Konva._global;function v(A,j,I){if(A==="rotater")return I;j+=e.Util.degToRad(p[A]||0);const B=(e.Util.radToDeg(j)%360+360)%360;return e.Util._inRange(B,315+22.5,360)||e.Util._inRange(B,0,22.5)?"ns-resize":e.Util._inRange(B,45-22.5,45+22.5)?"nesw-resize":e.Util._inRange(B,90-22.5,90+22.5)?"ew-resize":e.Util._inRange(B,135-22.5,135+22.5)?"nwse-resize":e.Util._inRange(B,180-22.5,180+22.5)?"ns-resize":e.Util._inRange(B,225-22.5,225+22.5)?"nesw-resize":e.Util._inRange(B,270-22.5,270+22.5)?"ew-resize":e.Util._inRange(B,315-22.5,315+22.5)?"nwse-resize":(e.Util.error("Transformer has unknown angle for cursor detection: "+B),"pointer")}const w=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function C(A){return{x:A.x+A.width/2*Math.cos(A.rotation)+A.height/2*Math.sin(-A.rotation),y:A.y+A.height/2*Math.cos(A.rotation)+A.width/2*Math.sin(A.rotation)}}function k(A,j,I){const B=I.x+(A.x-I.x)*Math.cos(j)-(A.y-I.y)*Math.sin(j),Y=I.y+(A.x-I.x)*Math.sin(j)+(A.y-I.y)*Math.cos(j);return{...A,rotation:A.rotation+j,x:B,y:Y}}function b(A,j){const I=C(A);return k(A,j,I)}function N(A,j,I){let B=j;for(let Y=0;Y<A.length;Y++){const Z=i.Konva.getAngle(A[Y]),ae=Math.abs(Z-j)%(Math.PI*2);Math.min(ae,Math.PI*2-ae)<I&&(B=Z)}return B}let E=0;class P extends a.Group{constructor(j){super(j),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(d,this.update),this.getNode()&&this.update()}attachTo(j){return this.setNode(j),this}setNode(j){return e.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([j])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return u+this._id}setNodes(j=[]){this._nodes&&this._nodes.length&&this.detach();const I=j.filter(Y=>Y.isAncestorOf(this)?(e.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=j=I,j.length===1&&this.useSingleNodeRotation()?this.rotation(j[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(Y=>{const Z=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(Y._attrsAffectingSize.length){const ae=Y._attrsAffectingSize.map(ee=>ee+"Change."+this._getEventNamespace()).join(" ");Y.on(ae,Z)}Y.on(g.map(ae=>ae+`.${this._getEventNamespace()}`).join(" "),Z),Y.on(`absoluteTransformChange.${this._getEventNamespace()}`,Z),this._proxyDrag(Y)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(j){let I;j.on(`dragstart.${this._getEventNamespace()}`,B=>{I=j.getAbsolutePosition(),!this.isDragging()&&j!==this.findOne(".back")&&this.startDrag(B,!1)}),j.on(`dragmove.${this._getEventNamespace()}`,B=>{if(!I)return;const Y=j.getAbsolutePosition(),Z=Y.x-I.x,ae=Y.y-I.y;this.nodes().forEach(ee=>{if(ee===j||ee.isDragging())return;const ne=ee.getAbsolutePosition();ee.setAbsolutePosition({x:ne.x+Z,y:ne.y+ae}),ee.startDrag(B)}),I=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(j=>{j.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(h),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(h,this.__getNodeRect)}__getNodeShape(j,I=this.rotation(),B){const Y=j.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),Z=j.getAbsoluteScale(B),ae=j.getAbsolutePosition(B),ee=Y.x*Z.x-j.offsetX()*Z.x,ne=Y.y*Z.y-j.offsetY()*Z.y,L=(i.Konva.getAngle(j.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),H={x:ae.x+ee*Math.cos(L)+ne*Math.sin(-L),y:ae.y+ne*Math.cos(L)+ee*Math.sin(L),width:Y.width*Z.x,height:Y.height*Z.y,rotation:L};return k(H,-i.Konva.getAngle(I),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const I=[];this.nodes().map(L=>{const H=L.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),M=[{x:H.x,y:H.y},{x:H.x+H.width,y:H.y},{x:H.x+H.width,y:H.y+H.height},{x:H.x,y:H.y+H.height}],V=L.getAbsoluteTransform();M.forEach(function(W){const R=V.point(W);I.push(R)})});const B=new e.Transform;B.rotate(-i.Konva.getAngle(this.rotation()));let Y=1/0,Z=1/0,ae=-1/0,ee=-1/0;I.forEach(function(L){const H=B.point(L);Y===void 0&&(Y=ae=H.x,Z=ee=H.y),Y=Math.min(Y,H.x),Z=Math.min(Z,H.y),ae=Math.max(ae,H.x),ee=Math.max(ee,H.y)}),B.invert();const ne=B.point({x:Y,y:Z});return{x:ne.x,y:ne.y,width:ae-Y,height:ee-Z,rotation:i.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),w.forEach(j=>{this._createAnchor(j)}),this._createAnchor("rotater")}_createAnchor(j){const I=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:j+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:x?10:"auto"}),B=this;I.on("mousedown touchstart",function(Y){B._handleMouseDown(Y)}),I.on("dragstart",Y=>{I.stopDrag(),Y.cancelBubble=!0}),I.on("dragend",Y=>{Y.cancelBubble=!0}),I.on("mouseenter",()=>{const Y=i.Konva.getAngle(this.rotation()),Z=this.rotateAnchorCursor(),ae=v(j,Y,Z);I.getStage().content&&(I.getStage().content.style.cursor=ae),this._cursorChange=!0}),I.on("mouseout",()=>{I.getStage().content&&(I.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(I)}_createBack(){const j=new n.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(I,B){const Y=B.getParent(),Z=Y.padding();I.beginPath(),I.rect(-Z,-Z,B.width()+Z*2,B.height()+Z*2),I.moveTo(B.width()/2,-Z),Y.rotateEnabled()&&Y.rotateLineVisible()&&I.lineTo(B.width()/2,-Y.rotateAnchorOffset()*e.Util._sign(B.height())-Z),I.fillStrokeShape(B)},hitFunc:(I,B)=>{if(!this.shouldOverdrawWholeArea())return;const Y=this.padding();I.beginPath(),I.rect(-Y,-Y,B.width()+Y*2,B.height()+Y*2),I.fillStrokeShape(B)}});this.add(j),this._proxyDrag(j),j.on("dragstart",I=>{I.cancelBubble=!0}),j.on("dragmove",I=>{I.cancelBubble=!0}),j.on("dragend",I=>{I.cancelBubble=!0}),this.on("dragmove",I=>{this.update()})}_handleMouseDown(j){if(this._transforming)return;this._movingAnchorName=j.target.name().split(" ")[0];const I=this._getNodeRect(),B=I.width,Y=I.height,Z=Math.sqrt(Math.pow(B,2)+Math.pow(Y,2));this.sin=Math.abs(Y/Z),this.cos=Math.abs(B/Z),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const ae=j.target.getAbsolutePosition(),ee=j.target.getStage().getPointerPosition();this._anchorDragOffset={x:ee.x-ae.x,y:ee.y-ae.y},E++,this._fire("transformstart",{evt:j.evt,target:this.getNode()}),this._nodes.forEach(ne=>{ne._fire("transformstart",{evt:j.evt,target:ne})})}_handleMouseMove(j){let I,B,Y;const Z=this.findOne("."+this._movingAnchorName),ae=Z.getStage();ae.setPointersPositions(j);const ee=ae.getPointerPosition();let ne={x:ee.x-this._anchorDragOffset.x,y:ee.y-this._anchorDragOffset.y};const L=Z.getAbsolutePosition();this.anchorDragBoundFunc()&&(ne=this.anchorDragBoundFunc()(L,ne,j)),Z.setAbsolutePosition(ne);const H=Z.getAbsolutePosition();if(L.x===H.x&&L.y===H.y)return;if(this._movingAnchorName==="rotater"){const se=this._getNodeRect();I=Z.x()-se.width/2,B=-Z.y()+se.height/2;let X=Math.atan2(-B,I)+Math.PI/2;se.height<0&&(X-=Math.PI);const le=i.Konva.getAngle(this.rotation())+X,ce=i.Konva.getAngle(this.rotationSnapTolerance()),re=N(this.rotationSnaps(),le,ce)-se.rotation,ge=b(se,re);this._fitNodesInto(ge,j);return}const M=this.shiftBehavior();let V;M==="inverted"?V=this.keepRatio()&&!j.shiftKey:M==="none"?V=this.keepRatio():V=this.keepRatio()||j.shiftKey;let W=this.centeredScaling()||j.altKey;if(this._movingAnchorName==="top-left"){if(V){const se=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};Y=Math.sqrt(Math.pow(se.x-Z.x(),2)+Math.pow(se.y-Z.y(),2));const X=this.findOne(".top-left").x()>se.x?-1:1,ie=this.findOne(".top-left").y()>se.y?-1:1;I=Y*this.cos*X,B=Y*this.sin*ie,this.findOne(".top-left").x(se.x-I),this.findOne(".top-left").y(se.y-B)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(Z.y());else if(this._movingAnchorName==="top-right"){if(V){const se=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};Y=Math.sqrt(Math.pow(Z.x()-se.x,2)+Math.pow(se.y-Z.y(),2));const X=this.findOne(".top-right").x()<se.x?-1:1,ie=this.findOne(".top-right").y()>se.y?-1:1;I=Y*this.cos*X,B=Y*this.sin*ie,this.findOne(".top-right").x(se.x+I),this.findOne(".top-right").y(se.y-B)}var R=Z.position();this.findOne(".top-left").y(R.y),this.findOne(".bottom-right").x(R.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(Z.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(Z.x());else if(this._movingAnchorName==="bottom-left"){if(V){const se=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};Y=Math.sqrt(Math.pow(se.x-Z.x(),2)+Math.pow(Z.y()-se.y,2));const X=se.x<Z.x()?-1:1,ie=Z.y()<se.y?-1:1;I=Y*this.cos*X,B=Y*this.sin*ie,Z.x(se.x-I),Z.y(se.y+B)}R=Z.position(),this.findOne(".top-left").x(R.x),this.findOne(".bottom-right").y(R.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(Z.y());else if(this._movingAnchorName==="bottom-right"){if(V){const se=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};Y=Math.sqrt(Math.pow(Z.x()-se.x,2)+Math.pow(Z.y()-se.y,2));const X=this.findOne(".bottom-right").x()<se.x?-1:1,ie=this.findOne(".bottom-right").y()<se.y?-1:1;I=Y*this.cos*X,B=Y*this.sin*ie,this.findOne(".bottom-right").x(se.x+I),this.findOne(".bottom-right").y(se.y+B)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(W=this.centeredScaling()||j.altKey,W){const se=this.findOne(".top-left"),X=this.findOne(".bottom-right"),ie=se.x(),le=se.y(),ce=this.getWidth()-X.x(),Se=this.getHeight()-X.y();X.move({x:-ie,y:-le}),se.move({x:ce,y:Se})}const U=this.findOne(".top-left").getAbsolutePosition();I=U.x,B=U.y;const q=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),Q=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:I,y:B,width:q,height:Q,rotation:i.Konva.getAngle(this.rotation())},j)}_handleMouseUp(j){this._removeEvents(j)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(j){var I;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const B=this.getNode();E--,this._fire("transformend",{evt:j,target:B}),(I=this.getLayer())===null||I===void 0||I.batchDraw(),B&&this._nodes.forEach(Y=>{var Z;Y._fire("transformend",{evt:j,target:Y}),(Z=Y.getLayer())===null||Z===void 0||Z.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(j,I){const B=this._getNodeRect(),Y=1;if(e.Util._inRange(j.width,-this.padding()*2-Y,Y)){this.update();return}if(e.Util._inRange(j.height,-this.padding()*2-Y,Y)){this.update();return}const Z=new e.Transform;if(Z.rotate(i.Konva.getAngle(this.rotation())),this._movingAnchorName&&j.width<0&&this._movingAnchorName.indexOf("left")>=0){const V=Z.point({x:-this.padding()*2,y:0});j.x+=V.x,j.y+=V.y,j.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=V.x,this._anchorDragOffset.y-=V.y}else if(this._movingAnchorName&&j.width<0&&this._movingAnchorName.indexOf("right")>=0){const V=Z.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=V.x,this._anchorDragOffset.y-=V.y,j.width+=this.padding()*2}if(this._movingAnchorName&&j.height<0&&this._movingAnchorName.indexOf("top")>=0){const V=Z.point({x:0,y:-this.padding()*2});j.x+=V.x,j.y+=V.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=V.x,this._anchorDragOffset.y-=V.y,j.height+=this.padding()*2}else if(this._movingAnchorName&&j.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const V=Z.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=V.x,this._anchorDragOffset.y-=V.y,j.height+=this.padding()*2}if(this.boundBoxFunc()){const V=this.boundBoxFunc()(B,j);V?j=V:e.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const ae=1e7,ee=new e.Transform;ee.translate(B.x,B.y),ee.rotate(B.rotation),ee.scale(B.width/ae,B.height/ae);const ne=new e.Transform,L=j.width/ae,H=j.height/ae;this.flipEnabled()===!1?(ne.translate(j.x,j.y),ne.rotate(j.rotation),ne.translate(j.width<0?j.width:0,j.height<0?j.height:0),ne.scale(Math.abs(L),Math.abs(H))):(ne.translate(j.x,j.y),ne.rotate(j.rotation),ne.scale(L,H));const M=ne.multiply(ee.invert());this._nodes.forEach(V=>{var W;const R=V.getParent().getAbsoluteTransform(),U=V.getTransform().copy();U.translate(V.offsetX(),V.offsetY());const q=new e.Transform;q.multiply(R.copy().invert()).multiply(M).multiply(R).multiply(U);const Q=q.decompose();V.setAttrs(Q),(W=V.getLayer())===null||W===void 0||W.batchDraw()}),this.rotation(e.Util._getRotation(j.rotation)),this._nodes.forEach(V=>{this._fire("transform",{evt:I,target:V}),V._fire("transform",{evt:I,target:V})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(j,I){this.findOne(j).setAttrs(I)}update(){var j;const I=this._getNodeRect();this.rotation(e.Util._getRotation(I.rotation));const B=I.width,Y=I.height,Z=this.enabledAnchors(),ae=this.resizeEnabled(),ee=this.padding(),ne=this.anchorSize(),L=this.find("._anchor");L.forEach(M=>{M.setAttrs({width:ne,height:ne,offsetX:ne/2,offsetY:ne/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:ne/2+ee,offsetY:ne/2+ee,visible:ae&&Z.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:B/2,y:0,offsetY:ne/2+ee,visible:ae&&Z.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:B,y:0,offsetX:ne/2-ee,offsetY:ne/2+ee,visible:ae&&Z.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:Y/2,offsetX:ne/2+ee,visible:ae&&Z.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:B,y:Y/2,offsetX:ne/2-ee,visible:ae&&Z.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:Y,offsetX:ne/2+ee,offsetY:ne/2-ee,visible:ae&&Z.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:B/2,y:Y,offsetY:ne/2-ee,visible:ae&&Z.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:B,y:Y,offsetX:ne/2-ee,offsetY:ne/2-ee,visible:ae&&Z.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:B/2,y:-this.rotateAnchorOffset()*e.Util._sign(Y)-ee,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:B,height:Y,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const H=this.anchorStyleFunc();H&&L.forEach(M=>{H(M)}),(j=this.getLayer())===null||j===void 0||j.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const j=this.findOne("."+this._movingAnchorName);j&&j.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),a.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return r.Node.prototype.toObject.call(this)}clone(j){return r.Node.prototype.clone.call(this,j)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Sx.Transformer=P,P.isTransforming=()=>E>0;function F(A){return A instanceof Array||e.Util.warn("enabledAnchors value should be an array"),A instanceof Array&&A.forEach(function(j){w.indexOf(j)===-1&&e.Util.warn("Unknown anchor name: "+j+". Available names are: "+w.join(", "))}),A||[]}return P.prototype.className="Transformer",(0,c._registerNode)(P),t.Factory.addGetterSetter(P,"enabledAnchors",w,F),t.Factory.addGetterSetter(P,"flipEnabled",!0,(0,o.getBooleanValidator)()),t.Factory.addGetterSetter(P,"resizeEnabled",!0),t.Factory.addGetterSetter(P,"anchorSize",10,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"rotateEnabled",!0),t.Factory.addGetterSetter(P,"rotateLineVisible",!0),t.Factory.addGetterSetter(P,"rotationSnaps",[]),t.Factory.addGetterSetter(P,"rotateAnchorOffset",50,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"rotateAnchorCursor","crosshair"),t.Factory.addGetterSetter(P,"rotationSnapTolerance",5,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderEnabled",!0),t.Factory.addGetterSetter(P,"anchorStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(P,"anchorStrokeWidth",1,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"anchorFill","white"),t.Factory.addGetterSetter(P,"anchorCornerRadius",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(P,"borderStrokeWidth",1,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderDash"),t.Factory.addGetterSetter(P,"keepRatio",!0),t.Factory.addGetterSetter(P,"shiftBehavior","default"),t.Factory.addGetterSetter(P,"centeredScaling",!1),t.Factory.addGetterSetter(P,"ignoreStroke",!1),t.Factory.addGetterSetter(P,"padding",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"nodes"),t.Factory.addGetterSetter(P,"node"),t.Factory.addGetterSetter(P,"boundBoxFunc"),t.Factory.addGetterSetter(P,"anchorDragBoundFunc"),t.Factory.addGetterSetter(P,"anchorStyleFunc"),t.Factory.addGetterSetter(P,"shouldOverdrawWholeArea",!1),t.Factory.addGetterSetter(P,"useSingleNodeRotation",!0),t.Factory.backCompat(P,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Sx}var kx={},V6;function HJ(){if(V6)return kx;V6=1,Object.defineProperty(kx,"__esModule",{value:!0}),kx.Wedge=void 0;const e=ln(),t=Wa(),r=tn(),n=dn(),s=tn();class a extends t.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.radius(),0,r.Konva.getAngle(this.angle()),this.clockwise()),o.lineTo(0,0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}}return kx.Wedge=a,a.prototype.className="Wedge",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"radius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1),e.Factory.backCompat(a,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),kx}var Cx={},K6;function GJ(){if(K6)return Cx;K6=1,Object.defineProperty(Cx,"__esModule",{value:!0}),Cx.Blur=void 0;const e=ln(),t=Qs(),r=dn();function n(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],a=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function i(c,u){const d=c.data,h=c.width,g=c.height;let p,x,v,w,C,k,b,N,E,P,F,A,j,I,B,Y,Z,ae,ee,ne;const L=u+u+1,H=h-1,M=g-1,V=u+1,W=V*(V+1)/2,R=new n,U=s[u],q=a[u];let Q=null,se=R,X=null,ie=null;for(let le=1;le<L;le++)se=se.next=new n,le===V&&(Q=se);se.next=R,v=x=0;for(let le=0;le<g;le++){A=j=I=B=w=C=k=b=0,N=V*(Y=d[x]),E=V*(Z=d[x+1]),P=V*(ae=d[x+2]),F=V*(ee=d[x+3]),w+=W*Y,C+=W*Z,k+=W*ae,b+=W*ee,se=R;for(let ce=0;ce<V;ce++)se.r=Y,se.g=Z,se.b=ae,se.a=ee,se=se.next;for(let ce=1;ce<V;ce++)p=x+((H<ce?H:ce)<<2),w+=(se.r=Y=d[p])*(ne=V-ce),C+=(se.g=Z=d[p+1])*ne,k+=(se.b=ae=d[p+2])*ne,b+=(se.a=ee=d[p+3])*ne,A+=Y,j+=Z,I+=ae,B+=ee,se=se.next;X=R,ie=Q;for(let ce=0;ce<h;ce++)d[x+3]=ee=b*U>>q,ee!==0?(ee=255/ee,d[x]=(w*U>>q)*ee,d[x+1]=(C*U>>q)*ee,d[x+2]=(k*U>>q)*ee):d[x]=d[x+1]=d[x+2]=0,w-=N,C-=E,k-=P,b-=F,N-=X.r,E-=X.g,P-=X.b,F-=X.a,p=v+((p=ce+u+1)<H?p:H)<<2,A+=X.r=d[p],j+=X.g=d[p+1],I+=X.b=d[p+2],B+=X.a=d[p+3],w+=A,C+=j,k+=I,b+=B,X=X.next,N+=Y=ie.r,E+=Z=ie.g,P+=ae=ie.b,F+=ee=ie.a,A-=Y,j-=Z,I-=ae,B-=ee,ie=ie.next,x+=4;v+=h}for(let le=0;le<h;le++){j=I=B=A=C=k=b=w=0,x=le<<2,N=V*(Y=d[x]),E=V*(Z=d[x+1]),P=V*(ae=d[x+2]),F=V*(ee=d[x+3]),w+=W*Y,C+=W*Z,k+=W*ae,b+=W*ee,se=R;for(let Se=0;Se<V;Se++)se.r=Y,se.g=Z,se.b=ae,se.a=ee,se=se.next;let ce=h;for(let Se=1;Se<=u;Se++)x=ce+le<<2,w+=(se.r=Y=d[x])*(ne=V-Se),C+=(se.g=Z=d[x+1])*ne,k+=(se.b=ae=d[x+2])*ne,b+=(se.a=ee=d[x+3])*ne,A+=Y,j+=Z,I+=ae,B+=ee,se=se.next,Se<M&&(ce+=h);x=le,X=R,ie=Q;for(let Se=0;Se<g;Se++)p=x<<2,d[p+3]=ee=b*U>>q,ee>0?(ee=255/ee,d[p]=(w*U>>q)*ee,d[p+1]=(C*U>>q)*ee,d[p+2]=(k*U>>q)*ee):d[p]=d[p+1]=d[p+2]=0,w-=N,C-=E,k-=P,b-=F,N-=X.r,E-=X.g,P-=X.b,F-=X.a,p=le+((p=Se+V)<M?p:M)*h<<2,w+=A+=X.r=d[p],C+=j+=X.g=d[p+1],k+=I+=X.b=d[p+2],b+=B+=X.a=d[p+3],X=X.next,N+=Y=ie.r,E+=Z=ie.g,P+=ae=ie.b,F+=ee=ie.a,A-=Y,j-=Z,I-=ae,B-=ee,ie=ie.next,x+=h}}const o=function(u){const d=Math.round(this.blurRadius());d>0&&i(u,d)};return Cx.Blur=o,e.Factory.addGetterSetter(t.Node,"blurRadius",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Cx}var Tx={},q6;function VJ(){if(q6)return Tx;q6=1,Object.defineProperty(Tx,"__esModule",{value:!0}),Tx.Brighten=void 0;const e=ln(),t=Qs(),r=dn(),n=function(s){const a=this.brightness()*255,i=s.data,o=i.length;for(let c=0;c<o;c+=4)i[c]+=a,i[c+1]+=a,i[c+2]+=a};return Tx.Brighten=n,e.Factory.addGetterSetter(t.Node,"brightness",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Tx}var Ex={},Y6;function KJ(){if(Y6)return Ex;Y6=1,Object.defineProperty(Ex,"__esModule",{value:!0}),Ex.Contrast=void 0;const e=ln(),t=Qs(),r=dn(),n=function(s){const a=Math.pow((this.contrast()+100)/100,2),i=s.data,o=i.length;let c=150,u=150,d=150;for(let h=0;h<o;h+=4)c=i[h],u=i[h+1],d=i[h+2],c/=255,c-=.5,c*=a,c+=.5,c*=255,u/=255,u-=.5,u*=a,u+=.5,u*=255,d/=255,d-=.5,d*=a,d+=.5,d*=255,c=c<0?0:c>255?255:c,u=u<0?0:u>255?255:u,d=d<0?0:d>255?255:d,i[h]=c,i[h+1]=u,i[h+2]=d};return Ex.Contrast=n,e.Factory.addGetterSetter(t.Node,"contrast",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ex}var Nx={},X6;function qJ(){if(X6)return Nx;X6=1,Object.defineProperty(Nx,"__esModule",{value:!0}),Nx.Emboss=void 0;const e=ln(),t=Qs(),r=Bs(),n=dn(),s=function(a){const i=this.embossStrength()*10,o=this.embossWhiteLevel()*255,c=this.embossDirection(),u=this.embossBlend(),d=a.data,h=a.width,g=a.height,p=h*4;let x=0,v=0,w=g;switch(c){case"top-left":x=-1,v=-1;break;case"top":x=-1,v=0;break;case"top-right":x=-1,v=1;break;case"right":x=0,v=1;break;case"bottom-right":x=1,v=1;break;case"bottom":x=1,v=0;break;case"bottom-left":x=1,v=-1;break;case"left":x=0,v=-1;break;default:r.Util.error("Unknown emboss direction: "+c)}do{const C=(w-1)*p;let k=x;w+k<1&&(k=0),w+k>g&&(k=0);const b=(w-1+k)*h*4;let N=h;do{const E=C+(N-1)*4;let P=v;N+P<1&&(P=0),N+P>h&&(P=0);const F=b+(N-1+P)*4,A=d[E]-d[F],j=d[E+1]-d[F+1],I=d[E+2]-d[F+2];let B=A;const Y=B>0?B:-B,Z=j>0?j:-j,ae=I>0?I:-I;if(Z>Y&&(B=j),ae>Y&&(B=I),B*=i,u){const ee=d[E]+B,ne=d[E+1]+B,L=d[E+2]+B;d[E]=ee>255?255:ee<0?0:ee,d[E+1]=ne>255?255:ne<0?0:ne,d[E+2]=L>255?255:L<0?0:L}else{let ee=o-B;ee<0?ee=0:ee>255&&(ee=255),d[E]=d[E+1]=d[E+2]=ee}}while(--N)}while(--w)};return Nx.Emboss=s,e.Factory.addGetterSetter(t.Node,"embossStrength",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossWhiteLevel",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossDirection","top-left",void 0,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossBlend",!1,void 0,e.Factory.afterSetFilter),Nx}var Ax={},Q6;function YJ(){if(Q6)return Ax;Q6=1,Object.defineProperty(Ax,"__esModule",{value:!0}),Ax.Enhance=void 0;const e=ln(),t=Qs(),r=dn();function n(a,i,o,c,u){const d=o-i,h=u-c;if(d===0)return c+h/2;if(h===0)return c;let g=(a-i)/d;return g=h*g+c,g}const s=function(a){const i=a.data,o=i.length;let c=i[0],u=c,d,h=i[1],g=h,p,x=i[2],v=x,w;const C=this.enhance();if(C===0)return;for(let A=0;A<o;A+=4)d=i[A+0],d<c?c=d:d>u&&(u=d),p=i[A+1],p<h?h=p:p>g&&(g=p),w=i[A+2],w<x?x=w:w>v&&(v=w);u===c&&(u=255,c=0),g===h&&(g=255,h=0),v===x&&(v=255,x=0);let k,b,N,E,P,F;if(C>0)k=u+C*(255-u),b=c-C*(c-0),N=g+C*(255-g),E=h-C*(h-0),P=v+C*(255-v),F=x-C*(x-0);else{const A=(u+c)*.5;k=u+C*(u-A),b=c+C*(c-A);const j=(g+h)*.5;N=g+C*(g-j),E=h+C*(h-j);const I=(v+x)*.5;P=v+C*(v-I),F=x+C*(x-I)}for(let A=0;A<o;A+=4)i[A+0]=n(i[A+0],c,u,b,k),i[A+1]=n(i[A+1],h,g,E,N),i[A+2]=n(i[A+2],x,v,F,P)};return Ax.Enhance=s,e.Factory.addGetterSetter(t.Node,"enhance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ax}var jx={},J6;function XJ(){if(J6)return jx;J6=1,Object.defineProperty(jx,"__esModule",{value:!0}),jx.Grayscale=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=.34*r[s]+.5*r[s+1]+.16*r[s+2];r[s]=a,r[s+1]=a,r[s+2]=a}};return jx.Grayscale=e,jx}var Px={},Z6;function QJ(){if(Z6)return Px;Z6=1,Object.defineProperty(Px,"__esModule",{value:!0}),Px.HSL=void 0;const e=ln(),t=Qs(),r=dn();e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"luminance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter);const n=function(s){const a=s.data,i=a.length,o=1,c=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,d=this.luminance()*127,h=o*c*Math.cos(u*Math.PI/180),g=o*c*Math.sin(u*Math.PI/180),p=.299*o+.701*h+.167*g,x=.587*o-.587*h+.33*g,v=.114*o-.114*h-.497*g,w=.299*o-.299*h-.328*g,C=.587*o+.413*h+.035*g,k=.114*o-.114*h+.293*g,b=.299*o-.3*h+1.25*g,N=.587*o-.586*h-1.05*g,E=.114*o+.886*h-.2*g;let P,F,A,j;for(let I=0;I<i;I+=4)P=a[I+0],F=a[I+1],A=a[I+2],j=a[I+3],a[I+0]=p*P+x*F+v*A+d,a[I+1]=w*P+C*F+k*A+d,a[I+2]=b*P+N*F+E*A+d,a[I+3]=j};return Px.HSL=n,Px}var Fx={},eP;function JJ(){if(eP)return Fx;eP=1,Object.defineProperty(Fx,"__esModule",{value:!0}),Fx.HSV=void 0;const e=ln(),t=Qs(),r=dn(),n=function(s){const a=s.data,i=a.length,o=Math.pow(2,this.value()),c=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,d=o*c*Math.cos(u*Math.PI/180),h=o*c*Math.sin(u*Math.PI/180),g=.299*o+.701*d+.167*h,p=.587*o-.587*d+.33*h,x=.114*o-.114*d-.497*h,v=.299*o-.299*d-.328*h,w=.587*o+.413*d+.035*h,C=.114*o-.114*d+.293*h,k=.299*o-.3*d+1.25*h,b=.587*o-.586*d-1.05*h,N=.114*o+.886*d-.2*h;for(let E=0;E<i;E+=4){const P=a[E+0],F=a[E+1],A=a[E+2],j=a[E+3];a[E+0]=g*P+p*F+x*A,a[E+1]=v*P+w*F+C*A,a[E+2]=k*P+b*F+N*A,a[E+3]=j}};return Fx.HSV=n,e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"value",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Fx}var Ox={},tP;function ZJ(){if(tP)return Ox;tP=1,Object.defineProperty(Ox,"__esModule",{value:!0}),Ox.Invert=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4)r[s]=255-r[s],r[s+1]=255-r[s+1],r[s+2]=255-r[s+2]};return Ox.Invert=e,Ox}var Dx={},rP;function eZ(){if(rP)return Dx;rP=1,Object.defineProperty(Dx,"__esModule",{value:!0}),Dx.Kaleidoscope=void 0;const e=ln(),t=Qs(),r=Bs(),n=dn(),s=function(o,c,u){const d=o.data,h=c.data,g=o.width,p=o.height,x=u.polarCenterX||g/2,v=u.polarCenterY||p/2;let w=Math.sqrt(x*x+v*v),C=g-x,k=p-v;const b=Math.sqrt(C*C+k*k);w=b>w?b:w;const N=p,E=g,P=360/E*Math.PI/180;for(let F=0;F<E;F+=1){const A=Math.sin(F*P),j=Math.cos(F*P);for(let I=0;I<N;I+=1){C=Math.floor(x+w*I/N*j),k=Math.floor(v+w*I/N*A);let B=(k*g+C)*4;const Y=d[B+0],Z=d[B+1],ae=d[B+2],ee=d[B+3];B=(F+I*g)*4,h[B+0]=Y,h[B+1]=Z,h[B+2]=ae,h[B+3]=ee}}},a=function(o,c,u){const d=o.data,h=c.data,g=o.width,p=o.height,x=u.polarCenterX||g/2,v=u.polarCenterY||p/2;let w=Math.sqrt(x*x+v*v),C=g-x,k=p-v;const b=Math.sqrt(C*C+k*k);w=b>w?b:w;const N=p,E=g,P=0;let F,A;for(C=0;C<g;C+=1)for(k=0;k<p;k+=1){const j=C-x,I=k-v,B=Math.sqrt(j*j+I*I)*N/w;let Y=(Math.atan2(I,j)*180/Math.PI+360+P)%360;Y=Y*E/360,F=Math.floor(Y),A=Math.floor(B);let Z=(A*g+F)*4;const ae=d[Z+0],ee=d[Z+1],ne=d[Z+2],L=d[Z+3];Z=(k*g+C)*4,h[Z+0]=ae,h[Z+1]=ee,h[Z+2]=ne,h[Z+3]=L}},i=function(o){const c=o.width,u=o.height;let d,h,g,p,x,v,w,C,k,b,N=Math.round(this.kaleidoscopePower());const E=Math.round(this.kaleidoscopeAngle()),P=Math.floor(c*(E%360)/360);if(N<1)return;const F=r.Util.createCanvasElement();F.width=c,F.height=u;const A=F.getContext("2d").getImageData(0,0,c,u);r.Util.releaseCanvas(F),s(o,A,{polarCenterX:c/2,polarCenterY:u/2});let j=c/Math.pow(2,N);for(;j<=8;)j=j*2,N-=1;j=Math.ceil(j);let I=j,B=0,Y=I,Z=1;for(P+j>c&&(B=I,Y=0,Z=-1),h=0;h<u;h+=1)for(d=B;d!==Y;d+=Z)g=Math.round(d+P)%c,k=(c*h+g)*4,x=A.data[k+0],v=A.data[k+1],w=A.data[k+2],C=A.data[k+3],b=(c*h+d)*4,A.data[b+0]=x,A.data[b+1]=v,A.data[b+2]=w,A.data[b+3]=C;for(h=0;h<u;h+=1)for(I=Math.floor(j),p=0;p<N;p+=1){for(d=0;d<I+1;d+=1)k=(c*h+d)*4,x=A.data[k+0],v=A.data[k+1],w=A.data[k+2],C=A.data[k+3],b=(c*h+I*2-d-1)*4,A.data[b+0]=x,A.data[b+1]=v,A.data[b+2]=w,A.data[b+3]=C;I*=2}a(A,o,{})};return Dx.Kaleidoscope=i,e.Factory.addGetterSetter(t.Node,"kaleidoscopePower",2,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"kaleidoscopeAngle",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),Dx}var Ix={},nP;function tZ(){if(nP)return Ix;nP=1,Object.defineProperty(Ix,"__esModule",{value:!0}),Ix.Mask=void 0;const e=ln(),t=Qs(),r=dn();function n(g,p,x){let v=(x*g.width+p)*4;const w=[];return w.push(g.data[v++],g.data[v++],g.data[v++],g.data[v++]),w}function s(g,p){return Math.sqrt(Math.pow(g[0]-p[0],2)+Math.pow(g[1]-p[1],2)+Math.pow(g[2]-p[2],2))}function a(g){const p=[0,0,0];for(let x=0;x<g.length;x++)p[0]+=g[x][0],p[1]+=g[x][1],p[2]+=g[x][2];return p[0]/=g.length,p[1]/=g.length,p[2]/=g.length,p}function i(g,p){const x=n(g,0,0),v=n(g,g.width-1,0),w=n(g,0,g.height-1),C=n(g,g.width-1,g.height-1),k=p||10;if(s(x,v)<k&&s(v,C)<k&&s(C,w)<k&&s(w,x)<k){const b=a([v,x,C,w]),N=[];for(let E=0;E<g.width*g.height;E++){const P=s(b,[g.data[E*4],g.data[E*4+1],g.data[E*4+2]]);N[E]=P<k?0:255}return N}}function o(g,p){for(let x=0;x<g.width*g.height;x++)g.data[4*x+3]=p[x]}function c(g,p,x){const v=[1,1,1,1,0,1,1,1,1],w=Math.round(Math.sqrt(v.length)),C=Math.floor(w/2),k=[];for(let b=0;b<x;b++)for(let N=0;N<p;N++){const E=b*p+N;let P=0;for(let F=0;F<w;F++)for(let A=0;A<w;A++){const j=b+F-C,I=N+A-C;if(j>=0&&j<x&&I>=0&&I<p){const B=j*p+I,Y=v[F*w+A];P+=g[B]*Y}}k[E]=P===2040?255:0}return k}function u(g,p,x){const v=[1,1,1,1,1,1,1,1,1],w=Math.round(Math.sqrt(v.length)),C=Math.floor(w/2),k=[];for(let b=0;b<x;b++)for(let N=0;N<p;N++){const E=b*p+N;let P=0;for(let F=0;F<w;F++)for(let A=0;A<w;A++){const j=b+F-C,I=N+A-C;if(j>=0&&j<x&&I>=0&&I<p){const B=j*p+I,Y=v[F*w+A];P+=g[B]*Y}}k[E]=P>=1020?255:0}return k}function d(g,p,x){const v=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],w=Math.round(Math.sqrt(v.length)),C=Math.floor(w/2),k=[];for(let b=0;b<x;b++)for(let N=0;N<p;N++){const E=b*p+N;let P=0;for(let F=0;F<w;F++)for(let A=0;A<w;A++){const j=b+F-C,I=N+A-C;if(j>=0&&j<x&&I>=0&&I<p){const B=j*p+I,Y=v[F*w+A];P+=g[B]*Y}}k[E]=P}return k}const h=function(g){const p=this.threshold();let x=i(g,p);return x&&(x=c(x,g.width,g.height),x=u(x,g.width,g.height),x=d(x,g.width,g.height),o(g,x)),g};return Ix.Mask=h,e.Factory.addGetterSetter(t.Node,"threshold",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ix}var Rx={},sP;function rZ(){if(sP)return Rx;sP=1,Object.defineProperty(Rx,"__esModule",{value:!0}),Rx.Noise=void 0;const e=ln(),t=Qs(),r=dn(),n=function(s){const a=this.noise()*255,i=s.data,o=i.length,c=a/2;for(let u=0;u<o;u+=4)i[u+0]+=c-2*c*Math.random(),i[u+1]+=c-2*c*Math.random(),i[u+2]+=c-2*c*Math.random()};return Rx.Noise=n,e.Factory.addGetterSetter(t.Node,"noise",.2,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Rx}var Mx={},aP;function nZ(){if(aP)return Mx;aP=1,Object.defineProperty(Mx,"__esModule",{value:!0}),Mx.Pixelate=void 0;const e=ln(),t=Bs(),r=Qs(),n=dn(),s=function(a){let i=Math.ceil(this.pixelSize()),o=a.width,c=a.height,u=Math.ceil(o/i),d=Math.ceil(c/i),h=a.data;if(i<=0){t.Util.error("pixelSize value can not be <= 0");return}for(let g=0;g<u;g+=1)for(let p=0;p<d;p+=1){let x=0,v=0,w=0,C=0;const k=g*i,b=k+i,N=p*i,E=N+i;let P=0;for(let F=k;F<b;F+=1)if(!(F>=o))for(let A=N;A<E;A+=1){if(A>=c)continue;const j=(o*A+F)*4;x+=h[j+0],v+=h[j+1],w+=h[j+2],C+=h[j+3],P+=1}x=x/P,v=v/P,w=w/P,C=C/P;for(let F=k;F<b;F+=1)if(!(F>=o))for(let A=N;A<E;A+=1){if(A>=c)continue;const j=(o*A+F)*4;h[j+0]=x,h[j+1]=v,h[j+2]=w,h[j+3]=C}}};return Mx.Pixelate=s,e.Factory.addGetterSetter(r.Node,"pixelSize",8,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),Mx}var Lx={},iP;function sZ(){if(iP)return Lx;iP=1,Object.defineProperty(Lx,"__esModule",{value:!0}),Lx.Posterize=void 0;const e=ln(),t=Qs(),r=dn(),n=function(s){const a=Math.round(this.levels()*254)+1,i=s.data,o=i.length,c=255/a;for(let u=0;u<o;u+=1)i[u]=Math.floor(i[u]/c)*c};return Lx.Posterize=n,e.Factory.addGetterSetter(t.Node,"levels",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Lx}var Bx={},oP;function aZ(){if(oP)return Bx;oP=1,Object.defineProperty(Bx,"__esModule",{value:!0}),Bx.RGB=void 0;const e=ln(),t=Qs(),r=dn(),n=function(s){const a=s.data,i=a.length,o=this.red(),c=this.green(),u=this.blue();for(let d=0;d<i;d+=4){const h=(.34*a[d]+.5*a[d+1]+.16*a[d+2])/255;a[d]=h*o,a[d+1]=h*c,a[d+2]=h*u,a[d+3]=a[d+3]}};return Bx.RGB=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),Bx}var $x={},lP;function iZ(){if(lP)return $x;lP=1,Object.defineProperty($x,"__esModule",{value:!0}),$x.RGBA=void 0;const e=ln(),t=Qs(),r=dn(),n=function(s){const a=s.data,i=a.length,o=this.red(),c=this.green(),u=this.blue(),d=this.alpha();for(let h=0;h<i;h+=4){const g=1-d;a[h]=o*d+a[h]*g,a[h+1]=c*d+a[h+1]*g,a[h+2]=u*d+a[h+2]*g}};return $x.RGBA=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),$x}var Ux={},cP;function oZ(){if(cP)return Ux;cP=1,Object.defineProperty(Ux,"__esModule",{value:!0}),Ux.Sepia=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=r[s+0],i=r[s+1],o=r[s+2];r[s+0]=Math.min(255,a*.393+i*.769+o*.189),r[s+1]=Math.min(255,a*.349+i*.686+o*.168),r[s+2]=Math.min(255,a*.272+i*.534+o*.131)}};return Ux.Sepia=e,Ux}var zx={},uP;function lZ(){if(uP)return zx;uP=1,Object.defineProperty(zx,"__esModule",{value:!0}),zx.Solarize=void 0;const e=function(t){const r=t.data,n=t.width,s=t.height,a=n*4;let i=s;do{const o=(i-1)*a;let c=n;do{const u=o+(c-1)*4;let d=r[u],h=r[u+1],g=r[u+2];d>127&&(d=255-d),h>127&&(h=255-h),g>127&&(g=255-g),r[u]=d,r[u+1]=h,r[u+2]=g}while(--c)}while(--i)};return zx.Solarize=e,zx}var Wx={},dP;function cZ(){if(dP)return Wx;dP=1,Object.defineProperty(Wx,"__esModule",{value:!0}),Wx.Threshold=void 0;const e=ln(),t=Qs(),r=dn(),n=function(s){const a=this.threshold()*255,i=s.data,o=i.length;for(let c=0;c<o;c+=1)i[c]=i[c]<a?0:255};return Wx.Threshold=n,e.Factory.addGetterSetter(t.Node,"threshold",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Wx}var fP;function uZ(){if(fP)return nx;fP=1,Object.defineProperty(nx,"__esModule",{value:!0}),nx.Konva=void 0;const e=PT(),t=PJ(),r=OJ(),n=DJ(),s=IJ(),a=RJ(),i=MJ(),o=mL(),c=ZN(),u=pL(),d=LJ(),h=BJ(),g=$J(),p=UJ(),x=xL(),v=zJ(),w=WJ(),C=HJ(),k=GJ(),b=VJ(),N=KJ(),E=qJ(),P=YJ(),F=XJ(),A=QJ(),j=JJ(),I=ZJ(),B=eZ(),Y=tZ(),Z=rZ(),ae=nZ(),ee=sZ(),ne=aZ(),L=iZ(),H=oZ(),M=lZ(),V=cZ();return nx.Konva=e.Konva.Util._assign(e.Konva,{Arc:t.Arc,Arrow:r.Arrow,Circle:n.Circle,Ellipse:s.Ellipse,Image:a.Image,Label:i.Label,Tag:i.Tag,Line:o.Line,Path:c.Path,Rect:u.Rect,RegularPolygon:d.RegularPolygon,Ring:h.Ring,Sprite:g.Sprite,Star:p.Star,Text:x.Text,TextPath:v.TextPath,Transformer:w.Transformer,Wedge:C.Wedge,Filters:{Blur:k.Blur,Brighten:b.Brighten,Contrast:N.Contrast,Emboss:E.Emboss,Enhance:P.Enhance,Grayscale:F.Grayscale,HSL:A.HSL,HSV:j.HSV,Invert:I.Invert,Kaleidoscope:B.Kaleidoscope,Mask:Y.Mask,Noise:Z.Noise,Pixelate:ae.Pixelate,Posterize:ee.Posterize,RGB:ne.RGB,RGBA:L.RGBA,Sepia:H.Sepia,Solarize:M.Solarize,Threshold:V.Threshold}}),nx}var dZ=eb.exports,hP;function fZ(){if(hP)return eb.exports;hP=1,Object.defineProperty(dZ,"__esModule",{value:!0});const e=uZ();return eb.exports=e.Konva,eb.exports}var yL=fZ();const hZ=Ol(yL),gZ=mM({__proto__:null,default:hZ},[yL]);var fw={exports:{}},gP;function mZ(){return gP||(gP=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var r=PT();Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=PT();e.exports=n.Konva})(fw,fw.exports)),fw.exports}var pZ=mZ();const zy=Ol(pZ);var qS={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YS,mP;function xZ(){return mP||(mP=1,YS=function(t){var r={},n=k0(),s=fN(),a=Object.assign;function i(y){for(var _="https://reactjs.org/docs/error-decoder.html?invariant="+y,O=1;O<arguments.length;O++)_+="&args[]="+encodeURIComponent(arguments[O]);return"Minified React error #"+y+"; visit "+_+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),u=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),x=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),N=Symbol.for("react.offscreen"),E=Symbol.iterator;function P(y){return y===null||typeof y!="object"?null:(y=E&&y[E]||y["@@iterator"],typeof y=="function"?y:null)}function F(y){if(y==null)return null;if(typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y;switch(y){case d:return"Fragment";case u:return"Portal";case g:return"Profiler";case h:return"StrictMode";case w:return"Suspense";case C:return"SuspenseList"}if(typeof y=="object")switch(y.$$typeof){case x:return(y.displayName||"Context")+".Consumer";case p:return(y._context.displayName||"Context")+".Provider";case v:var _=y.render;return y=y.displayName,y||(y=_.displayName||_.name||"",y=y!==""?"ForwardRef("+y+")":"ForwardRef"),y;case k:return _=y.displayName||null,_!==null?_:F(y.type)||"Memo";case b:_=y._payload,y=y._init;try{return F(y(_))}catch{}}return null}function A(y){var _=y.type;switch(y.tag){case 24:return"Cache";case 9:return(_.displayName||"Context")+".Consumer";case 10:return(_._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return y=_.render,y=y.displayName||y.name||"",_.displayName||(y!==""?"ForwardRef("+y+")":"ForwardRef");case 7:return"Fragment";case 5:return _;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(_);case 8:return _===h?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _}return null}function j(y){var _=y,O=y;if(y.alternate)for(;_.return;)_=_.return;else{y=_;do _=y,(_.flags&4098)!==0&&(O=_.return),y=_.return;while(y)}return _.tag===3?O:null}function I(y){if(j(y)!==y)throw Error(i(188))}function B(y){var _=y.alternate;if(!_){if(_=j(y),_===null)throw Error(i(188));return _!==y?null:y}for(var O=y,z=_;;){var K=O.return;if(K===null)break;var te=K.alternate;if(te===null){if(z=K.return,z!==null){O=z;continue}break}if(K.child===te.child){for(te=K.child;te;){if(te===O)return I(K),y;if(te===z)return I(K),_;te=te.sibling}throw Error(i(188))}if(O.return!==z.return)O=K,z=te;else{for(var ve=!1,ze=K.child;ze;){if(ze===O){ve=!0,O=K,z=te;break}if(ze===z){ve=!0,z=K,O=te;break}ze=ze.sibling}if(!ve){for(ze=te.child;ze;){if(ze===O){ve=!0,O=te,z=K;break}if(ze===z){ve=!0,z=te,O=K;break}ze=ze.sibling}if(!ve)throw Error(i(189))}}if(O.alternate!==z)throw Error(i(190))}if(O.tag!==3)throw Error(i(188));return O.stateNode.current===O?y:_}function Y(y){return y=B(y),y!==null?Z(y):null}function Z(y){if(y.tag===5||y.tag===6)return y;for(y=y.child;y!==null;){var _=Z(y);if(_!==null)return _;y=y.sibling}return null}function ae(y){if(y.tag===5||y.tag===6)return y;for(y=y.child;y!==null;){if(y.tag!==4){var _=ae(y);if(_!==null)return _}y=y.sibling}return null}var ee=Array.isArray,ne=t.getPublicInstance,L=t.getRootHostContext,H=t.getChildHostContext,M=t.prepareForCommit,V=t.resetAfterCommit,W=t.createInstance,R=t.appendInitialChild,U=t.finalizeInitialChildren,q=t.prepareUpdate,Q=t.shouldSetTextContent,se=t.createTextInstance,X=t.scheduleTimeout,ie=t.cancelTimeout,le=t.noTimeout,ce=t.isPrimaryRenderer,Se=t.supportsMutation,re=t.supportsPersistence,ge=t.supportsHydration,Ee=t.getInstanceFromNode,Ae=t.preparePortalMount,He=t.getCurrentEventPriority,Be=t.detachDeletedInstance,Rt=t.supportsMicrotasks,et=t.scheduleMicrotask,vt=t.supportsTestSelectors,xt=t.findFiberRoot,it=t.getBoundingRect,ht=t.getTextContent,Dt=t.isHiddenSubtree,Mt=t.matchAccessibilityRole,Xe=t.setFocusIfFocusable,De=t.setupIntersectionObserver,Le=t.appendChild,lt=t.appendChildToContainer,Ue=t.commitTextUpdate,tt=t.commitMount,Et=t.commitUpdate,At=t.insertBefore,qt=t.insertInContainerBefore,pr=t.removeChild,Rr=t.removeChildFromContainer,Kr=t.resetTextContent,ur=t.hideInstance,ir=t.hideTextInstance,me=t.unhideInstance,Ne=t.unhideTextInstance,Pe=t.clearContainer,Re=t.cloneInstance,Ct=t.createContainerChildSet,Fe=t.appendChildToContainerChildSet,st=t.finalizeContainerChildren,ke=t.replaceContainerChildren,We=t.cloneHiddenInstance,Qe=t.cloneHiddenTextInstance,Pt=t.canHydrateInstance,zt=t.canHydrateTextInstance,rr=t.canHydrateSuspenseInstance,xr=t.isSuspenseInstancePending,cr=t.isSuspenseInstanceFallback,qr=t.getSuspenseInstanceFallbackErrorDetails,ue=t.registerSuspenseInstanceRetry,we=t.getNextHydratableSibling,ye=t.getFirstHydratableChild,xe=t.getFirstHydratableChildWithinContainer,be=t.getFirstHydratableChildWithinSuspenseInstance,_e=t.hydrateInstance,Ge=t.hydrateTextInstance,ut=t.hydrateSuspenseInstance,qe=t.getNextHydratableInstanceAfterSuspenseInstance,oe=t.commitHydratedContainer,he=t.commitHydratedSuspenseInstance,Te=t.clearSuspenseBoundary,Ce=t.clearSuspenseBoundaryFromContainer,Ke=t.shouldDeleteUnhydratedTailInstances,ot=t.didNotMatchHydratedContainerTextInstance,mt=t.didNotMatchHydratedTextInstance,Wt;function pt(y){if(Wt===void 0)try{throw Error()}catch(O){var _=O.stack.trim().match(/\n( *(at )?)/);Wt=_&&_[1]||""}return`
`+Wt+y}var Yt=!1;function vr(y,_){if(!y||Yt)return"";Yt=!0;var O=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(_)if(_=function(){throw Error()},Object.defineProperty(_.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_,[])}catch(Ht){var z=Ht}Reflect.construct(y,[],_)}else{try{_.call()}catch(Ht){z=Ht}y.call(_.prototype)}else{try{throw Error()}catch(Ht){z=Ht}y()}}catch(Ht){if(Ht&&z&&typeof Ht.stack=="string"){for(var K=Ht.stack.split(`
`),te=z.stack.split(`
`),ve=K.length-1,ze=te.length-1;1<=ve&&0<=ze&&K[ve]!==te[ze];)ze--;for(;1<=ve&&0<=ze;ve--,ze--)if(K[ve]!==te[ze]){if(ve!==1||ze!==1)do if(ve--,ze--,0>ze||K[ve]!==te[ze]){var ft=`
`+K[ve].replace(" at new "," at ");return y.displayName&&ft.includes("<anonymous>")&&(ft=ft.replace("<anonymous>",y.displayName)),ft}while(1<=ve&&0<=ze);break}}}finally{Yt=!1,Error.prepareStackTrace=O}return(y=y?y.displayName||y.name:"")?pt(y):""}var _r=Object.prototype.hasOwnProperty,gr=[],Fr=-1;function rn(y){return{current:y}}function Qr(y){0>Fr||(y.current=gr[Fr],gr[Fr]=null,Fr--)}function fe(y,_){Fr++,gr[Fr]=y.current,y.current=_}var wt={},Sr=rn(wt),kr=rn(!1),Nn=wt;function bn(y,_){var O=y.type.contextTypes;if(!O)return wt;var z=y.stateNode;if(z&&z.__reactInternalMemoizedUnmaskedChildContext===_)return z.__reactInternalMemoizedMaskedChildContext;var K={},te;for(te in O)K[te]=_[te];return z&&(y=y.stateNode,y.__reactInternalMemoizedUnmaskedChildContext=_,y.__reactInternalMemoizedMaskedChildContext=K),K}function Zr(y){return y=y.childContextTypes,y!=null}function Me(){Qr(kr),Qr(Sr)}function Tt(y,_,O){if(Sr.current!==wt)throw Error(i(168));fe(Sr,_),fe(kr,O)}function Gt(y,_,O){var z=y.stateNode;if(_=_.childContextTypes,typeof z.getChildContext!="function")return O;z=z.getChildContext();for(var K in z)if(!(K in _))throw Error(i(108,A(y)||"Unknown",K));return a({},O,z)}function ar(y){return y=(y=y.stateNode)&&y.__reactInternalMemoizedMergedChildContext||wt,Nn=Sr.current,fe(Sr,y),fe(kr,kr.current),!0}function es(y,_,O){var z=y.stateNode;if(!z)throw Error(i(169));O?(y=Gt(y,_,Nn),z.__reactInternalMemoizedMergedChildContext=y,Qr(kr),Qr(Sr),fe(Sr,y)):Qr(kr),fe(kr,O)}var Kn=Math.clz32?Math.clz32:Gf,Mi=Math.log,B0=Math.LN2;function Gf(y){return y>>>=0,y===0?32:31-(Mi(y)/B0|0)|0}var cn=64,su=4194304;function rt(y){switch(y&-y){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return y&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return y}}function gt(y,_){var O=y.pendingLanes;if(O===0)return 0;var z=0,K=y.suspendedLanes,te=y.pingedLanes,ve=O&268435455;if(ve!==0){var ze=ve&~K;ze!==0?z=rt(ze):(te&=ve,te!==0&&(z=rt(te)))}else ve=O&~K,ve!==0?z=rt(ve):te!==0&&(z=rt(te));if(z===0)return 0;if(_!==0&&_!==z&&(_&K)===0&&(K=z&-z,te=_&-_,K>=te||K===16&&(te&4194240)!==0))return _;if((z&4)!==0&&(z|=O&16),_=y.entangledLanes,_!==0)for(y=y.entanglements,_&=z;0<_;)O=31-Kn(_),K=1<<O,z|=y[O],_&=~K;return z}function Vt(y,_){switch(y){case 1:case 2:case 4:return _+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kt(y,_){for(var O=y.suspendedLanes,z=y.pingedLanes,K=y.expirationTimes,te=y.pendingLanes;0<te;){var ve=31-Kn(te),ze=1<<ve,ft=K[ve];ft===-1?((ze&O)===0||(ze&z)!==0)&&(K[ve]=Vt(ze,_)):ft<=_&&(y.expiredLanes|=ze),te&=~ze}}function br(y){return y=y.pendingLanes&-1073741825,y!==0?y:y&1073741824?1073741824:0}function jt(){var y=cn;return cn<<=1,(cn&4194240)===0&&(cn=64),y}function Ur(y){for(var _=[],O=0;31>O;O++)_.push(y);return _}function nn(y,_,O){y.pendingLanes|=_,_!==536870912&&(y.suspendedLanes=0,y.pingedLanes=0),y=y.eventTimes,_=31-Kn(_),y[_]=O}function Je(y,_){var O=y.pendingLanes&~_;y.pendingLanes=_,y.suspendedLanes=0,y.pingedLanes=0,y.expiredLanes&=_,y.mutableReadLanes&=_,y.entangledLanes&=_,_=y.entanglements;var z=y.eventTimes;for(y=y.expirationTimes;0<O;){var K=31-Kn(O),te=1<<K;_[K]=0,z[K]=-1,y[K]=-1,O&=~te}}function Xt(y,_){var O=y.entangledLanes|=_;for(y=y.entanglements;O;){var z=31-Kn(O),K=1<<z;K&_|y[z]&_&&(y[z]|=_),O&=~K}}var It=0;function _n(y){return y&=-y,1<y?4<y?(y&268435455)!==0?16:536870912:4:1}var Wr=s.unstable_scheduleCallback,Hr=s.unstable_cancelCallback,qn=s.unstable_shouldYield,Mn=s.unstable_requestPaint,Yn=s.unstable_now,oo=s.unstable_ImmediatePriority,gc=s.unstable_UserBlockingPriority,$0=s.unstable_NormalPriority,z2=s.unstable_IdlePriority,mc=null,pi=null;function vd(y){if(pi&&typeof pi.onCommitFiberRoot=="function")try{pi.onCommitFiberRoot(mc,y,void 0,(y.current.flags&128)===128)}catch{}}function U0(y,_){return y===_&&(y!==0||1/y===1/_)||y!==y&&_!==_}var Ao=typeof Object.is=="function"?Object.is:U0,Ll=null,wd=!1,bd=!1;function z0(y){Ll===null?Ll=[y]:Ll.push(y)}function d1(y){wd=!0,z0(y)}function fa(){if(!bd&&Ll!==null){bd=!0;var y=0,_=It;try{var O=Ll;for(It=1;y<O.length;y++){var z=O[y];do z=z(!0);while(z!==null)}Ll=null,wd=!1}catch(K){throw Ll!==null&&(Ll=Ll.slice(y+1)),Wr(oo,fa),K}finally{It=_,bd=!1}}return null}var pc=[],Bl=0,Vf=null,au=0,Va=[],Li=0,$s=null,xi=1,jo="";function Po(y,_){pc[Bl++]=au,pc[Bl++]=Vf,Vf=y,au=_}function f1(y,_,O){Va[Li++]=xi,Va[Li++]=jo,Va[Li++]=$s,$s=y;var z=xi;y=jo;var K=32-Kn(z)-1;z&=~(1<<K),O+=1;var te=32-Kn(_)+K;if(30<te){var ve=K-K%5;te=(z&(1<<ve)-1).toString(32),z>>=ve,K-=ve,xi=1<<32-Kn(_)+K|O<<K|z,jo=te+y}else xi=1<<te|O<<K|z,jo=y}function Kf(y){y.return!==null&&(Po(y,1),f1(y,1,0))}function qf(y){for(;y===Vf;)Vf=pc[--Bl],pc[Bl]=null,au=pc[--Bl],pc[Bl]=null;for(;y===$s;)$s=Va[--Li],Va[Li]=null,jo=Va[--Li],Va[Li]=null,xi=Va[--Li],Va[Li]=null}var ha=null,Ka=null,Wn=!1,Yf=!1,Fo=null;function h1(y,_){var O=qi(5,null,null,0);O.elementType="DELETED",O.stateNode=_,O.return=y,_=y.deletions,_===null?(y.deletions=[O],y.flags|=16):_.push(O)}function W0(y,_){switch(y.tag){case 5:return _=Pt(_,y.type,y.pendingProps),_!==null?(y.stateNode=_,ha=y,Ka=ye(_),!0):!1;case 6:return _=zt(_,y.pendingProps),_!==null?(y.stateNode=_,ha=y,Ka=null,!0):!1;case 13:if(_=rr(_),_!==null){var O=$s!==null?{id:xi,overflow:jo}:null;return y.memoizedState={dehydrated:_,treeContext:O,retryLane:1073741824},O=qi(18,null,null,0),O.stateNode=_,O.return=y,y.child=O,ha=y,Ka=null,!0}return!1;default:return!1}}function fp(y){return(y.mode&1)!==0&&(y.flags&128)===0}function hp(y){if(Wn){var _=Ka;if(_){var O=_;if(!W0(y,_)){if(fp(y))throw Error(i(418));_=we(O);var z=ha;_&&W0(y,_)?h1(z,O):(y.flags=y.flags&-4097|2,Wn=!1,ha=y)}}else{if(fp(y))throw Error(i(418));y.flags=y.flags&-4097|2,Wn=!1,ha=y}}}function g1(y){for(y=y.return;y!==null&&y.tag!==5&&y.tag!==3&&y.tag!==13;)y=y.return;ha=y}function H0(y){if(!ge||y!==ha)return!1;if(!Wn)return g1(y),Wn=!0,!1;if(y.tag!==3&&(y.tag!==5||Ke(y.type)&&!Q(y.type,y.memoizedProps))){var _=Ka;if(_){if(fp(y))throw m1(),Error(i(418));for(;_;)h1(y,_),_=we(_)}}if(g1(y),y.tag===13){if(!ge)throw Error(i(316));if(y=y.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(i(317));Ka=qe(y)}else Ka=ha?we(y.stateNode):null;return!0}function m1(){for(var y=Ka;y;)y=we(y)}function iu(){ge&&(Ka=ha=null,Yf=Wn=!1)}function gp(y){Fo===null?Fo=[y]:Fo.push(y)}var W2=o.ReactCurrentBatchConfig;function G0(y,_){if(Ao(y,_))return!0;if(typeof y!="object"||y===null||typeof _!="object"||_===null)return!1;var O=Object.keys(y),z=Object.keys(_);if(O.length!==z.length)return!1;for(z=0;z<O.length;z++){var K=O[z];if(!_r.call(_,K)||!Ao(y[K],_[K]))return!1}return!0}function H2(y){switch(y.tag){case 5:return pt(y.type);case 16:return pt("Lazy");case 13:return pt("Suspense");case 19:return pt("SuspenseList");case 0:case 2:case 15:return y=vr(y.type,!1),y;case 11:return y=vr(y.type.render,!1),y;case 1:return y=vr(y.type,!0),y;default:return""}}function ou(y,_,O){if(y=O.ref,y!==null&&typeof y!="function"&&typeof y!="object"){if(O._owner){if(O=O._owner,O){if(O.tag!==1)throw Error(i(309));var z=O.stateNode}if(!z)throw Error(i(147,y));var K=z,te=""+y;return _!==null&&_.ref!==null&&typeof _.ref=="function"&&_.ref._stringRef===te?_.ref:(_=function(ve){var ze=K.refs;ve===null?delete ze[te]:ze[te]=ve},_._stringRef=te,_)}if(typeof y!="string")throw Error(i(284));if(!O._owner)throw Error(i(290,y))}return y}function V0(y,_){throw y=Object.prototype.toString.call(_),Error(i(31,y==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":y))}function p1(y){var _=y._init;return _(y._payload)}function x1(y){function _(ct,Ve){if(y){var yt=ct.deletions;yt===null?(ct.deletions=[Ve],ct.flags|=16):yt.push(Ve)}}function O(ct,Ve){if(!y)return null;for(;Ve!==null;)_(ct,Ve),Ve=Ve.sibling;return null}function z(ct,Ve){for(ct=new Map;Ve!==null;)Ve.key!==null?ct.set(Ve.key,Ve):ct.set(Ve.index,Ve),Ve=Ve.sibling;return ct}function K(ct,Ve){return ct=Dc(ct,Ve),ct.index=0,ct.sibling=null,ct}function te(ct,Ve,yt){return ct.index=yt,y?(yt=ct.alternate,yt!==null?(yt=yt.index,yt<Ve?(ct.flags|=2,Ve):yt):(ct.flags|=2,Ve)):(ct.flags|=1048576,Ve)}function ve(ct){return y&&ct.alternate===null&&(ct.flags|=2),ct}function ze(ct,Ve,yt,sr){return Ve===null||Ve.tag!==6?(Ve=Vd(yt,ct.mode,sr),Ve.return=ct,Ve):(Ve=K(Ve,yt),Ve.return=ct,Ve)}function ft(ct,Ve,yt,sr){var Cr=yt.type;return Cr===d?dr(ct,Ve,yt.props.children,sr,yt.key):Ve!==null&&(Ve.elementType===Cr||typeof Cr=="object"&&Cr!==null&&Cr.$$typeof===b&&p1(Cr)===Ve.type)?(sr=K(Ve,yt.props),sr.ref=ou(ct,Ve,yt),sr.return=ct,sr):(sr=kg(yt.type,yt.key,yt.props,null,ct.mode,sr),sr.ref=ou(ct,Ve,yt),sr.return=ct,sr)}function Ht(ct,Ve,yt,sr){return Ve===null||Ve.tag!==4||Ve.stateNode.containerInfo!==yt.containerInfo||Ve.stateNode.implementation!==yt.implementation?(Ve=Cg(yt,ct.mode,sr),Ve.return=ct,Ve):(Ve=K(Ve,yt.children||[]),Ve.return=ct,Ve)}function dr(ct,Ve,yt,sr,Cr){return Ve===null||Ve.tag!==7?(Ve=pa(yt,ct.mode,sr,Cr),Ve.return=ct,Ve):(Ve=K(Ve,yt),Ve.return=ct,Ve)}function Br(ct,Ve,yt){if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number")return Ve=Vd(""+Ve,ct.mode,yt),Ve.return=ct,Ve;if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case c:return yt=kg(Ve.type,Ve.key,Ve.props,null,ct.mode,yt),yt.ref=ou(ct,null,Ve),yt.return=ct,yt;case u:return Ve=Cg(Ve,ct.mode,yt),Ve.return=ct,Ve;case b:var sr=Ve._init;return Br(ct,sr(Ve._payload),yt)}if(ee(Ve)||P(Ve))return Ve=pa(Ve,ct.mode,yt,null),Ve.return=ct,Ve;V0(ct,Ve)}return null}function nr(ct,Ve,yt,sr){var Cr=Ve!==null?Ve.key:null;if(typeof yt=="string"&&yt!==""||typeof yt=="number")return Cr!==null?null:ze(ct,Ve,""+yt,sr);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case c:return yt.key===Cr?ft(ct,Ve,yt,sr):null;case u:return yt.key===Cr?Ht(ct,Ve,yt,sr):null;case b:return Cr=yt._init,nr(ct,Ve,Cr(yt._payload),sr)}if(ee(yt)||P(yt))return Cr!==null?null:dr(ct,Ve,yt,sr,null);V0(ct,yt)}return null}function Un(ct,Ve,yt,sr,Cr){if(typeof sr=="string"&&sr!==""||typeof sr=="number")return ct=ct.get(yt)||null,ze(Ve,ct,""+sr,Cr);if(typeof sr=="object"&&sr!==null){switch(sr.$$typeof){case c:return ct=ct.get(sr.key===null?yt:sr.key)||null,ft(Ve,ct,sr,Cr);case u:return ct=ct.get(sr.key===null?yt:sr.key)||null,Ht(Ve,ct,sr,Cr);case b:var Yr=sr._init;return Un(ct,Ve,yt,Yr(sr._payload),Cr)}if(ee(sr)||P(sr))return ct=ct.get(yt)||null,dr(Ve,ct,sr,Cr,null);V0(Ve,sr)}return null}function kn(ct,Ve,yt,sr){for(var Cr=null,Yr=null,$r=Ve,un=Ve=0,Gs=null;$r!==null&&un<yt.length;un++){$r.index>un?(Gs=$r,$r=null):Gs=$r.sibling;var on=nr(ct,$r,yt[un],sr);if(on===null){$r===null&&($r=Gs);break}y&&$r&&on.alternate===null&&_(ct,$r),Ve=te(on,Ve,un),Yr===null?Cr=on:Yr.sibling=on,Yr=on,$r=Gs}if(un===yt.length)return O(ct,$r),Wn&&Po(ct,un),Cr;if($r===null){for(;un<yt.length;un++)$r=Br(ct,yt[un],sr),$r!==null&&(Ve=te($r,Ve,un),Yr===null?Cr=$r:Yr.sibling=$r,Yr=$r);return Wn&&Po(ct,un),Cr}for($r=z(ct,$r);un<yt.length;un++)Gs=Un($r,ct,un,yt[un],sr),Gs!==null&&(y&&Gs.alternate!==null&&$r.delete(Gs.key===null?un:Gs.key),Ve=te(Gs,Ve,un),Yr===null?Cr=Gs:Yr.sibling=Gs,Yr=Gs);return y&&$r.forEach(function(Pa){return _(ct,Pa)}),Wn&&Po(ct,un),Cr}function Za(ct,Ve,yt,sr){var Cr=P(yt);if(typeof Cr!="function")throw Error(i(150));if(yt=Cr.call(yt),yt==null)throw Error(i(151));for(var Yr=Cr=null,$r=Ve,un=Ve=0,Gs=null,on=yt.next();$r!==null&&!on.done;un++,on=yt.next()){$r.index>un?(Gs=$r,$r=null):Gs=$r.sibling;var Pa=nr(ct,$r,on.value,sr);if(Pa===null){$r===null&&($r=Gs);break}y&&$r&&Pa.alternate===null&&_(ct,$r),Ve=te(Pa,Ve,un),Yr===null?Cr=Pa:Yr.sibling=Pa,Yr=Pa,$r=Gs}if(on.done)return O(ct,$r),Wn&&Po(ct,un),Cr;if($r===null){for(;!on.done;un++,on=yt.next())on=Br(ct,on.value,sr),on!==null&&(Ve=te(on,Ve,un),Yr===null?Cr=on:Yr.sibling=on,Yr=on);return Wn&&Po(ct,un),Cr}for($r=z(ct,$r);!on.done;un++,on=yt.next())on=Un($r,ct,un,on.value,sr),on!==null&&(y&&on.alternate!==null&&$r.delete(on.key===null?un:on.key),Ve=te(on,Ve,un),Yr===null?Cr=on:Yr.sibling=on,Yr=on);return y&&$r.forEach(function(Y2){return _(ct,Y2)}),Wn&&Po(ct,un),Cr}function ol(ct,Ve,yt,sr){if(typeof yt=="object"&&yt!==null&&yt.type===d&&yt.key===null&&(yt=yt.props.children),typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case c:e:{for(var Cr=yt.key,Yr=Ve;Yr!==null;){if(Yr.key===Cr){if(Cr=yt.type,Cr===d){if(Yr.tag===7){O(ct,Yr.sibling),Ve=K(Yr,yt.props.children),Ve.return=ct,ct=Ve;break e}}else if(Yr.elementType===Cr||typeof Cr=="object"&&Cr!==null&&Cr.$$typeof===b&&p1(Cr)===Yr.type){O(ct,Yr.sibling),Ve=K(Yr,yt.props),Ve.ref=ou(ct,Yr,yt),Ve.return=ct,ct=Ve;break e}O(ct,Yr);break}else _(ct,Yr);Yr=Yr.sibling}yt.type===d?(Ve=pa(yt.props.children,ct.mode,sr,yt.key),Ve.return=ct,ct=Ve):(sr=kg(yt.type,yt.key,yt.props,null,ct.mode,sr),sr.ref=ou(ct,Ve,yt),sr.return=ct,ct=sr)}return ve(ct);case u:e:{for(Yr=yt.key;Ve!==null;){if(Ve.key===Yr)if(Ve.tag===4&&Ve.stateNode.containerInfo===yt.containerInfo&&Ve.stateNode.implementation===yt.implementation){O(ct,Ve.sibling),Ve=K(Ve,yt.children||[]),Ve.return=ct,ct=Ve;break e}else{O(ct,Ve);break}else _(ct,Ve);Ve=Ve.sibling}Ve=Cg(yt,ct.mode,sr),Ve.return=ct,ct=Ve}return ve(ct);case b:return Yr=yt._init,ol(ct,Ve,Yr(yt._payload),sr)}if(ee(yt))return kn(ct,Ve,yt,sr);if(P(yt))return Za(ct,Ve,yt,sr);V0(ct,yt)}return typeof yt=="string"&&yt!==""||typeof yt=="number"?(yt=""+yt,Ve!==null&&Ve.tag===6?(O(ct,Ve.sibling),Ve=K(Ve,yt),Ve.return=ct,ct=Ve):(O(ct,Ve),Ve=Vd(yt,ct.mode,sr),Ve.return=ct,ct=Ve),ve(ct)):O(ct,Ve)}return ol}var lu=x1(!0),y1=x1(!1),K0=rn(null),q0=null,_d=null,mp=null;function pp(){mp=_d=q0=null}function v1(y,_,O){ce?(fe(K0,_._currentValue),_._currentValue=O):(fe(K0,_._currentValue2),_._currentValue2=O)}function Xf(y){var _=K0.current;Qr(K0),ce?y._currentValue=_:y._currentValue2=_}function cu(y,_,O){for(;y!==null;){var z=y.alternate;if((y.childLanes&_)!==_?(y.childLanes|=_,z!==null&&(z.childLanes|=_)):z!==null&&(z.childLanes&_)!==_&&(z.childLanes|=_),y===O)break;y=y.return}}function Sd(y,_){q0=y,mp=_d=null,y=y.dependencies,y!==null&&y.firstContext!==null&&((y.lanes&_)!==0&&(zs=!0),y.firstContext=null)}function Bi(y){var _=ce?y._currentValue:y._currentValue2;if(mp!==y)if(y={context:y,memoizedValue:_,next:null},_d===null){if(q0===null)throw Error(i(308));_d=y,q0.dependencies={lanes:0,firstContext:y}}else _d=_d.next=y;return _}var xc=null;function Y0(y){xc===null?xc=[y]:xc.push(y)}function xp(y,_,O,z){var K=_.interleaved;return K===null?(O.next=O,Y0(_)):(O.next=K.next,K.next=O),_.interleaved=O,Oo(y,z)}function Oo(y,_){y.lanes|=_;var O=y.alternate;for(O!==null&&(O.lanes|=_),O=y,y=y.return;y!==null;)y.childLanes|=_,O=y.alternate,O!==null&&(O.childLanes|=_),O=y,y=y.return;return O.tag===3?O.stateNode:null}var $i=!1;function yp(y){y.updateQueue={baseState:y.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function w1(y,_){y=y.updateQueue,_.updateQueue===y&&(_.updateQueue={baseState:y.baseState,firstBaseUpdate:y.firstBaseUpdate,lastBaseUpdate:y.lastBaseUpdate,shared:y.shared,effects:y.effects})}function $l(y,_){return{eventTime:y,lane:_,tag:0,payload:null,callback:null,next:null}}function Ul(y,_,O){var z=y.updateQueue;if(z===null)return null;if(z=z.shared,(Gr&2)!==0){var K=z.pending;return K===null?_.next=_:(_.next=K.next,K.next=_),z.pending=_,Oo(y,O)}return K=z.interleaved,K===null?(_.next=_,Y0(z)):(_.next=K.next,K.next=_),z.interleaved=_,Oo(y,O)}function Qf(y,_,O){if(_=_.updateQueue,_!==null&&(_=_.shared,(O&4194240)!==0)){var z=_.lanes;z&=y.pendingLanes,O|=z,_.lanes=O,Xt(y,O)}}function kd(y,_){var O=y.updateQueue,z=y.alternate;if(z!==null&&(z=z.updateQueue,O===z)){var K=null,te=null;if(O=O.firstBaseUpdate,O!==null){do{var ve={eventTime:O.eventTime,lane:O.lane,tag:O.tag,payload:O.payload,callback:O.callback,next:null};te===null?K=te=ve:te=te.next=ve,O=O.next}while(O!==null);te===null?K=te=_:te=te.next=_}else K=te=_;O={baseState:z.baseState,firstBaseUpdate:K,lastBaseUpdate:te,shared:z.shared,effects:z.effects},y.updateQueue=O;return}y=O.lastBaseUpdate,y===null?O.firstBaseUpdate=_:y.next=_,O.lastBaseUpdate=_}function yc(y,_,O,z){var K=y.updateQueue;$i=!1;var te=K.firstBaseUpdate,ve=K.lastBaseUpdate,ze=K.shared.pending;if(ze!==null){K.shared.pending=null;var ft=ze,Ht=ft.next;ft.next=null,ve===null?te=Ht:ve.next=Ht,ve=ft;var dr=y.alternate;dr!==null&&(dr=dr.updateQueue,ze=dr.lastBaseUpdate,ze!==ve&&(ze===null?dr.firstBaseUpdate=Ht:ze.next=Ht,dr.lastBaseUpdate=ft))}if(te!==null){var Br=K.baseState;ve=0,dr=Ht=ft=null,ze=te;do{var nr=ze.lane,Un=ze.eventTime;if((z&nr)===nr){dr!==null&&(dr=dr.next={eventTime:Un,lane:0,tag:ze.tag,payload:ze.payload,callback:ze.callback,next:null});e:{var kn=y,Za=ze;switch(nr=_,Un=O,Za.tag){case 1:if(kn=Za.payload,typeof kn=="function"){Br=kn.call(Un,Br,nr);break e}Br=kn;break e;case 3:kn.flags=kn.flags&-65537|128;case 0:if(kn=Za.payload,nr=typeof kn=="function"?kn.call(Un,Br,nr):kn,nr==null)break e;Br=a({},Br,nr);break e;case 2:$i=!0}}ze.callback!==null&&ze.lane!==0&&(y.flags|=64,nr=K.effects,nr===null?K.effects=[ze]:nr.push(ze))}else Un={eventTime:Un,lane:nr,tag:ze.tag,payload:ze.payload,callback:ze.callback,next:null},dr===null?(Ht=dr=Un,ft=Br):dr=dr.next=Un,ve|=nr;if(ze=ze.next,ze===null){if(ze=K.shared.pending,ze===null)break;nr=ze,ze=nr.next,nr.next=null,K.lastBaseUpdate=nr,K.shared.pending=null}}while(!0);if(dr===null&&(ft=Br),K.baseState=ft,K.firstBaseUpdate=Ht,K.lastBaseUpdate=dr,_=K.shared.interleaved,_!==null){K=_;do ve|=K.lane,K=K.next;while(K!==_)}else te===null&&(K.shared.lanes=0);Vl|=ve,y.lanes=ve,y.memoizedState=Br}}function b1(y,_,O){if(y=_.effects,_.effects=null,y!==null)for(_=0;_<y.length;_++){var z=y[_],K=z.callback;if(K!==null){if(z.callback=null,z=O,typeof K!="function")throw Error(i(191,K));K.call(z)}}}var vc={},lo=rn(vc),Cd=rn(vc),wc=rn(vc);function co(y){if(y===vc)throw Error(i(174));return y}function X0(y,_){fe(wc,_),fe(Cd,y),fe(lo,vc),y=L(_),Qr(lo),fe(lo,y)}function uu(){Qr(lo),Qr(Cd),Qr(wc)}function vp(y){var _=co(wc.current),O=co(lo.current);_=H(O,y.type,_),O!==_&&(fe(Cd,y),fe(lo,_))}function wp(y){Cd.current===y&&(Qr(lo),Qr(Cd))}var ts=rn(0);function Q0(y){for(var _=y;_!==null;){if(_.tag===13){var O=_.memoizedState;if(O!==null&&(O=O.dehydrated,O===null||xr(O)||cr(O)))return _}else if(_.tag===19&&_.memoizedProps.revealOrder!==void 0){if((_.flags&128)!==0)return _}else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===y)break;for(;_.sibling===null;){if(_.return===null||_.return===y)return null;_=_.return}_.sibling.return=_.return,_=_.sibling}return null}var bp=[];function _p(){for(var y=0;y<bp.length;y++){var _=bp[y];ce?_._workInProgressVersionPrimary=null:_._workInProgressVersionSecondary=null}bp.length=0}var yi=o.ReactCurrentDispatcher,du=o.ReactCurrentBatchConfig,bc=0,Xn=null,ks=null,Us=null,Td=!1,Jf=!1,Zf=0,Ed=0;function Zs(){throw Error(i(321))}function fu(y,_){if(_===null)return!1;for(var O=0;O<_.length&&O<y.length;O++)if(!Ao(y[O],_[O]))return!1;return!0}function eh(y,_,O,z,K,te){if(bc=te,Xn=_,_.memoizedState=null,_.updateQueue=null,_.lanes=0,yi.current=y===null||y.memoizedState===null?Fp:Op,y=O(z,K),Jf){te=0;do{if(Jf=!1,Zf=0,25<=te)throw Error(i(301));te+=1,Us=ks=null,_.updateQueue=null,yi.current=Dp,y=O(z,K)}while(Jf)}if(yi.current=xu,_=ks!==null&&ks.next!==null,bc=0,Us=ks=Xn=null,Td=!1,_)throw Error(i(300));return y}function J0(){var y=Zf!==0;return Zf=0,y}function Ui(){var y={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Us===null?Xn.memoizedState=Us=y:Us=Us.next=y,Us}function ga(){if(ks===null){var y=Xn.alternate;y=y!==null?y.memoizedState:null}else y=ks.next;var _=Us===null?Xn.memoizedState:Us.next;if(_!==null)Us=_,ks=y;else{if(y===null)throw Error(i(310));ks=y,y={memoizedState:ks.memoizedState,baseState:ks.baseState,baseQueue:ks.baseQueue,queue:ks.queue,next:null},Us===null?Xn.memoizedState=Us=y:Us=Us.next=y}return Us}function hu(y,_){return typeof _=="function"?_(y):_}function Z0(y){var _=ga(),O=_.queue;if(O===null)throw Error(i(311));O.lastRenderedReducer=y;var z=ks,K=z.baseQueue,te=O.pending;if(te!==null){if(K!==null){var ve=K.next;K.next=te.next,te.next=ve}z.baseQueue=K=te,O.pending=null}if(K!==null){te=K.next,z=z.baseState;var ze=ve=null,ft=null,Ht=te;do{var dr=Ht.lane;if((bc&dr)===dr)ft!==null&&(ft=ft.next={lane:0,action:Ht.action,hasEagerState:Ht.hasEagerState,eagerState:Ht.eagerState,next:null}),z=Ht.hasEagerState?Ht.eagerState:y(z,Ht.action);else{var Br={lane:dr,action:Ht.action,hasEagerState:Ht.hasEagerState,eagerState:Ht.eagerState,next:null};ft===null?(ze=ft=Br,ve=z):ft=ft.next=Br,Xn.lanes|=dr,Vl|=dr}Ht=Ht.next}while(Ht!==null&&Ht!==te);ft===null?ve=z:ft.next=ze,Ao(z,_.memoizedState)||(zs=!0),_.memoizedState=z,_.baseState=ve,_.baseQueue=ft,O.lastRenderedState=z}if(y=O.interleaved,y!==null){K=y;do te=K.lane,Xn.lanes|=te,Vl|=te,K=K.next;while(K!==y)}else K===null&&(O.lanes=0);return[_.memoizedState,O.dispatch]}function Nd(y){var _=ga(),O=_.queue;if(O===null)throw Error(i(311));O.lastRenderedReducer=y;var z=O.dispatch,K=O.pending,te=_.memoizedState;if(K!==null){O.pending=null;var ve=K=K.next;do te=y(te,ve.action),ve=ve.next;while(ve!==K);Ao(te,_.memoizedState)||(zs=!0),_.memoizedState=te,_.baseQueue===null&&(_.baseState=te),O.lastRenderedState=te}return[te,z]}function Sp(){}function kp(y,_){var O=Xn,z=ga(),K=_(),te=!Ao(z.memoizedState,K);if(te&&(z.memoizedState=K,zs=!0),z=z.queue,rg(Ep.bind(null,O,z,y),[y]),z.getSnapshot!==_||te||Us!==null&&Us.memoizedState.tag&1){if(O.flags|=2048,gu(9,Tp.bind(null,O,z,K,_),void 0,null),jn===null)throw Error(i(349));(bc&30)!==0||Cp(O,_,K)}return K}function Cp(y,_,O){y.flags|=16384,y={getSnapshot:_,value:O},_=Xn.updateQueue,_===null?(_={lastEffect:null,stores:null},Xn.updateQueue=_,_.stores=[y]):(O=_.stores,O===null?_.stores=[y]:O.push(y))}function Tp(y,_,O,z){_.value=O,_.getSnapshot=z,Np(_)&&zl(y)}function Ep(y,_,O){return O(function(){Np(_)&&zl(y)})}function Np(y){var _=y.getSnapshot;y=y.value;try{var O=_();return!Ao(y,O)}catch{return!0}}function zl(y){var _=Oo(y,1);_!==null&&Aa(_,y,1,-1)}function eg(y){var _=Ui();return typeof y=="function"&&(y=y()),_.memoizedState=_.baseState=y,y={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hu,lastRenderedState:y},_.queue=y,y=y.dispatch=G2.bind(null,Xn,y),[_.memoizedState,y]}function gu(y,_,O,z){return y={tag:y,create:_,destroy:O,deps:z,next:null},_=Xn.updateQueue,_===null?(_={lastEffect:null,stores:null},Xn.updateQueue=_,_.lastEffect=y.next=y):(O=_.lastEffect,O===null?_.lastEffect=y.next=y:(z=O.next,O.next=y,y.next=z,_.lastEffect=y)),y}function _1(){return ga().memoizedState}function tg(y,_,O,z){var K=Ui();Xn.flags|=y,K.memoizedState=gu(1|_,O,void 0,z===void 0?null:z)}function _c(y,_,O,z){var K=ga();z=z===void 0?null:z;var te=void 0;if(ks!==null){var ve=ks.memoizedState;if(te=ve.destroy,z!==null&&fu(z,ve.deps)){K.memoizedState=gu(_,O,te,z);return}}Xn.flags|=y,K.memoizedState=gu(1|_,O,te,z)}function S1(y,_){return tg(8390656,8,y,_)}function rg(y,_){return _c(2048,8,y,_)}function Ap(y,_){return _c(4,2,y,_)}function Ln(y,_){return _c(4,4,y,_)}function ng(y,_){if(typeof _=="function")return y=y(),_(y),function(){_(null)};if(_!=null)return y=y(),_.current=y,function(){_.current=null}}function th(y,_,O){return O=O!=null?O.concat([y]):null,_c(4,4,ng.bind(null,_,y),O)}function mu(){}function jp(y,_){var O=ga();_=_===void 0?null:_;var z=O.memoizedState;return z!==null&&_!==null&&fu(_,z[1])?z[0]:(O.memoizedState=[y,_],y)}function sg(y,_){var O=ga();_=_===void 0?null:_;var z=O.memoizedState;return z!==null&&_!==null&&fu(_,z[1])?z[0]:(y=y(),O.memoizedState=[y,_],y)}function Ad(y,_,O){return(bc&21)===0?(y.baseState&&(y.baseState=!1,zs=!0),y.memoizedState=O):(Ao(O,_)||(O=jt(),Xn.lanes|=O,Vl|=O,y.baseState=!0),_)}function ag(y,_){var O=It;It=O!==0&&4>O?O:4,y(!0);var z=du.transition;du.transition={};try{y(!1),_()}finally{It=O,du.transition=z}}function pu(){return ga().memoizedState}function k1(y,_,O){var z=Hs(y);if(O={lane:z,action:O,hasEagerState:!1,eagerState:null,next:null},C1(y))Pp(_,O);else if(O=xp(y,_,O,z),O!==null){var K=Hn();Aa(O,y,z,K),rh(O,_,z)}}function G2(y,_,O){var z=Hs(y),K={lane:z,action:O,hasEagerState:!1,eagerState:null,next:null};if(C1(y))Pp(_,K);else{var te=y.alternate;if(y.lanes===0&&(te===null||te.lanes===0)&&(te=_.lastRenderedReducer,te!==null))try{var ve=_.lastRenderedState,ze=te(ve,O);if(K.hasEagerState=!0,K.eagerState=ze,Ao(ze,ve)){var ft=_.interleaved;ft===null?(K.next=K,Y0(_)):(K.next=ft.next,ft.next=K),_.interleaved=K;return}}catch{}finally{}O=xp(y,_,K,z),O!==null&&(K=Hn(),Aa(O,y,z,K),rh(O,_,z))}}function C1(y){var _=y.alternate;return y===Xn||_!==null&&_===Xn}function Pp(y,_){Jf=Td=!0;var O=y.pending;O===null?_.next=_:(_.next=O.next,O.next=_),y.pending=_}function rh(y,_,O){if((O&4194240)!==0){var z=_.lanes;z&=y.pendingLanes,O|=z,_.lanes=O,Xt(y,O)}}var xu={readContext:Bi,useCallback:Zs,useContext:Zs,useEffect:Zs,useImperativeHandle:Zs,useInsertionEffect:Zs,useLayoutEffect:Zs,useMemo:Zs,useReducer:Zs,useRef:Zs,useState:Zs,useDebugValue:Zs,useDeferredValue:Zs,useTransition:Zs,useMutableSource:Zs,useSyncExternalStore:Zs,useId:Zs,unstable_isNewReconciler:!1},Fp={readContext:Bi,useCallback:function(y,_){return Ui().memoizedState=[y,_===void 0?null:_],y},useContext:Bi,useEffect:S1,useImperativeHandle:function(y,_,O){return O=O!=null?O.concat([y]):null,tg(4194308,4,ng.bind(null,_,y),O)},useLayoutEffect:function(y,_){return tg(4194308,4,y,_)},useInsertionEffect:function(y,_){return tg(4,2,y,_)},useMemo:function(y,_){var O=Ui();return _=_===void 0?null:_,y=y(),O.memoizedState=[y,_],y},useReducer:function(y,_,O){var z=Ui();return _=O!==void 0?O(_):_,z.memoizedState=z.baseState=_,y={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:y,lastRenderedState:_},z.queue=y,y=y.dispatch=k1.bind(null,Xn,y),[z.memoizedState,y]},useRef:function(y){var _=Ui();return y={current:y},_.memoizedState=y},useState:eg,useDebugValue:mu,useDeferredValue:function(y){return Ui().memoizedState=y},useTransition:function(){var y=eg(!1),_=y[0];return y=ag.bind(null,y[1]),Ui().memoizedState=y,[_,y]},useMutableSource:function(){},useSyncExternalStore:function(y,_,O){var z=Xn,K=Ui();if(Wn){if(O===void 0)throw Error(i(407));O=O()}else{if(O=_(),jn===null)throw Error(i(349));(bc&30)!==0||Cp(z,_,O)}K.memoizedState=O;var te={value:O,getSnapshot:_};return K.queue=te,S1(Ep.bind(null,z,te,y),[y]),z.flags|=2048,gu(9,Tp.bind(null,z,te,O,_),void 0,null),O},useId:function(){var y=Ui(),_=jn.identifierPrefix;if(Wn){var O=jo,z=xi;O=(z&~(1<<32-Kn(z)-1)).toString(32)+O,_=":"+_+"R"+O,O=Zf++,0<O&&(_+="H"+O.toString(32)),_+=":"}else O=Ed++,_=":"+_+"r"+O.toString(32)+":";return y.memoizedState=_},unstable_isNewReconciler:!1},Op={readContext:Bi,useCallback:jp,useContext:Bi,useEffect:rg,useImperativeHandle:th,useInsertionEffect:Ap,useLayoutEffect:Ln,useMemo:sg,useReducer:Z0,useRef:_1,useState:function(){return Z0(hu)},useDebugValue:mu,useDeferredValue:function(y){var _=ga();return Ad(_,ks.memoizedState,y)},useTransition:function(){var y=Z0(hu)[0],_=ga().memoizedState;return[y,_]},useMutableSource:Sp,useSyncExternalStore:kp,useId:pu,unstable_isNewReconciler:!1},Dp={readContext:Bi,useCallback:jp,useContext:Bi,useEffect:rg,useImperativeHandle:th,useInsertionEffect:Ap,useLayoutEffect:Ln,useMemo:sg,useReducer:Nd,useRef:_1,useState:function(){return Nd(hu)},useDebugValue:mu,useDeferredValue:function(y){var _=ga();return ks===null?_.memoizedState=y:Ad(_,ks.memoizedState,y)},useTransition:function(){var y=Nd(hu)[0],_=ga().memoizedState;return[y,_]},useMutableSource:Sp,useSyncExternalStore:kp,useId:pu,unstable_isNewReconciler:!1};function zi(y,_){if(y&&y.defaultProps){_=a({},_),y=y.defaultProps;for(var O in y)_[O]===void 0&&(_[O]=y[O]);return _}return _}function Ip(y,_,O,z){_=y.memoizedState,O=O(z,_),O=O==null?_:a({},_,O),y.memoizedState=O,y.lanes===0&&(y.updateQueue.baseState=O)}var nh={isMounted:function(y){return(y=y._reactInternals)?j(y)===y:!1},enqueueSetState:function(y,_,O){y=y._reactInternals;var z=Hn(),K=Hs(y),te=$l(z,K);te.payload=_,O!=null&&(te.callback=O),_=Ul(y,te,K),_!==null&&(Aa(_,y,K,z),Qf(_,y,K))},enqueueReplaceState:function(y,_,O){y=y._reactInternals;var z=Hn(),K=Hs(y),te=$l(z,K);te.tag=1,te.payload=_,O!=null&&(te.callback=O),_=Ul(y,te,K),_!==null&&(Aa(_,y,K,z),Qf(_,y,K))},enqueueForceUpdate:function(y,_){y=y._reactInternals;var O=Hn(),z=Hs(y),K=$l(O,z);K.tag=2,_!=null&&(K.callback=_),_=Ul(y,K,z),_!==null&&(Aa(_,y,z,O),Qf(_,y,z))}};function T1(y,_,O,z,K,te,ve){return y=y.stateNode,typeof y.shouldComponentUpdate=="function"?y.shouldComponentUpdate(z,te,ve):_.prototype&&_.prototype.isPureReactComponent?!G0(O,z)||!G0(K,te):!0}function E1(y,_,O){var z=!1,K=wt,te=_.contextType;return typeof te=="object"&&te!==null?te=Bi(te):(K=Zr(_)?Nn:Sr.current,z=_.contextTypes,te=(z=z!=null)?bn(y,K):wt),_=new _(O,te),y.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=nh,y.stateNode=_,_._reactInternals=y,z&&(y=y.stateNode,y.__reactInternalMemoizedUnmaskedChildContext=K,y.__reactInternalMemoizedMaskedChildContext=te),_}function ig(y,_,O,z){y=_.state,typeof _.componentWillReceiveProps=="function"&&_.componentWillReceiveProps(O,z),typeof _.UNSAFE_componentWillReceiveProps=="function"&&_.UNSAFE_componentWillReceiveProps(O,z),_.state!==y&&nh.enqueueReplaceState(_,_.state,null)}function Zo(y,_,O,z){var K=y.stateNode;K.props=O,K.state=y.memoizedState,K.refs={},yp(y);var te=_.contextType;typeof te=="object"&&te!==null?K.context=Bi(te):(te=Zr(_)?Nn:Sr.current,K.context=bn(y,te)),K.state=y.memoizedState,te=_.getDerivedStateFromProps,typeof te=="function"&&(Ip(y,_,te,O),K.state=y.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof K.getSnapshotBeforeUpdate=="function"||typeof K.UNSAFE_componentWillMount!="function"&&typeof K.componentWillMount!="function"||(_=K.state,typeof K.componentWillMount=="function"&&K.componentWillMount(),typeof K.UNSAFE_componentWillMount=="function"&&K.UNSAFE_componentWillMount(),_!==K.state&&nh.enqueueReplaceState(K,K.state,null),yc(y,O,K,z),K.state=y.memoizedState),typeof K.componentDidMount=="function"&&(y.flags|=4194308)}function yu(y,_){try{var O="",z=_;do O+=H2(z),z=z.return;while(z);var K=O}catch(te){K=`
Error generating stack: `+te.message+`
`+te.stack}return{value:y,source:_,stack:K,digest:null}}function Sc(y,_,O){return{value:y,source:null,stack:O??null,digest:_??null}}function uo(y,_){try{console.error(_.value)}catch(O){setTimeout(function(){throw O})}}var sh=typeof WeakMap=="function"?WeakMap:Map;function el(y,_,O){O=$l(-1,O),O.tag=3,O.payload={element:null};var z=_.value;return O.callback=function(){fs||(fs=!0,Cs=z),uo(y,_)},O}function og(y,_,O){O=$l(-1,O),O.tag=3;var z=y.type.getDerivedStateFromError;if(typeof z=="function"){var K=_.value;O.payload=function(){return z(K)},O.callback=function(){uo(y,_)}}var te=y.stateNode;return te!==null&&typeof te.componentDidCatch=="function"&&(O.callback=function(){uo(y,_),typeof z!="function"&&(Io===null?Io=new Set([this]):Io.add(this));var ve=_.stack;this.componentDidCatch(_.value,{componentStack:ve!==null?ve:""})}),O}function N1(y,_,O){var z=y.pingCache;if(z===null){z=y.pingCache=new sh;var K=new Set;z.set(_,K)}else K=z.get(_),K===void 0&&(K=new Set,z.set(_,K));K.has(O)||(K.add(O),y=R1.bind(null,y,_,O),_.then(y,y))}function A1(y){do{var _;if((_=y.tag===13)&&(_=y.memoizedState,_=_!==null?_.dehydrated!==null:!0),_)return y;y=y.return}while(y!==null);return null}function kc(y,_,O,z,K){return(y.mode&1)===0?(y===_?y.flags|=65536:(y.flags|=128,O.flags|=131072,O.flags&=-52805,O.tag===1&&(O.alternate===null?O.tag=17:(_=$l(-1,1),_.tag=2,Ul(O,_,1))),O.lanes|=1),y):(y.flags|=65536,y.lanes=K,y)}var ah=o.ReactCurrentOwner,zs=!1;function ea(y,_,O,z){_.child=y===null?y1(_,null,O,z):lu(_,y.child,O,z)}function lg(y,_,O,z,K){O=O.render;var te=_.ref;return Sd(_,K),z=eh(y,_,O,z,te,K),O=J0(),y!==null&&!zs?(_.updateQueue=y.updateQueue,_.flags&=-2053,y.lanes&=~K,Hl(y,_,K)):(Wn&&O&&Kf(_),_.flags|=1,ea(y,_,z,K),_.child)}function vu(y,_,O,z,K){if(y===null){var te=O.type;return typeof te=="function"&&!Hd(te)&&te.defaultProps===void 0&&O.compare===null&&O.defaultProps===void 0?(_.tag=15,_.type=te,Wl(y,_,te,z,K)):(y=kg(O.type,null,z,_,_.mode,K),y.ref=_.ref,y.return=_,_.child=y)}if(te=y.child,(y.lanes&K)===0){var ve=te.memoizedProps;if(O=O.compare,O=O!==null?O:G0,O(ve,z)&&y.ref===_.ref)return Hl(y,_,K)}return _.flags|=1,y=Dc(te,z),y.ref=_.ref,y.return=_,_.child=y}function Wl(y,_,O,z,K){if(y!==null){var te=y.memoizedProps;if(G0(te,z)&&y.ref===_.ref)if(zs=!1,_.pendingProps=z=te,(y.lanes&K)!==0)(y.flags&131072)!==0&&(zs=!0);else return _.lanes=y.lanes,Hl(y,_,K)}return tl(y,_,O,z,K)}function Bn(y,_,O){var z=_.pendingProps,K=z.children,te=y!==null?y.memoizedState:null;if(z.mode==="hidden")if((_.mode&1)===0)_.memoizedState={baseLanes:0,cachePool:null,transitions:null},fe(jc,Ws),Ws|=O;else{if((O&1073741824)===0)return y=te!==null?te.baseLanes|O:O,_.lanes=_.childLanes=1073741824,_.memoizedState={baseLanes:y,cachePool:null,transitions:null},_.updateQueue=null,fe(jc,Ws),Ws|=y,null;_.memoizedState={baseLanes:0,cachePool:null,transitions:null},z=te!==null?te.baseLanes:O,fe(jc,Ws),Ws|=z}else te!==null?(z=te.baseLanes|O,_.memoizedState=null):z=O,fe(jc,Ws),Ws|=z;return ea(y,_,K,O),_.child}function An(y,_){var O=_.ref;(y===null&&O!==null||y!==null&&y.ref!==O)&&(_.flags|=512,_.flags|=2097152)}function tl(y,_,O,z,K){var te=Zr(O)?Nn:Sr.current;return te=bn(_,te),Sd(_,K),O=eh(y,_,O,z,te,K),z=J0(),y!==null&&!zs?(_.updateQueue=y.updateQueue,_.flags&=-2053,y.lanes&=~K,Hl(y,_,K)):(Wn&&z&&Kf(_),_.flags|=1,ea(y,_,O,K),_.child)}function ma(y,_,O,z,K){if(Zr(O)){var te=!0;ar(_)}else te=!1;if(Sd(_,K),_.stateNode===null)ih(y,_),E1(_,O,z),Zo(_,O,z,K),z=!0;else if(y===null){var ve=_.stateNode,ze=_.memoizedProps;ve.props=ze;var ft=ve.context,Ht=O.contextType;typeof Ht=="object"&&Ht!==null?Ht=Bi(Ht):(Ht=Zr(O)?Nn:Sr.current,Ht=bn(_,Ht));var dr=O.getDerivedStateFromProps,Br=typeof dr=="function"||typeof ve.getSnapshotBeforeUpdate=="function";Br||typeof ve.UNSAFE_componentWillReceiveProps!="function"&&typeof ve.componentWillReceiveProps!="function"||(ze!==z||ft!==Ht)&&ig(_,ve,z,Ht),$i=!1;var nr=_.memoizedState;ve.state=nr,yc(_,z,ve,K),ft=_.memoizedState,ze!==z||nr!==ft||kr.current||$i?(typeof dr=="function"&&(Ip(_,O,dr,z),ft=_.memoizedState),(ze=$i||T1(_,O,ze,z,nr,ft,Ht))?(Br||typeof ve.UNSAFE_componentWillMount!="function"&&typeof ve.componentWillMount!="function"||(typeof ve.componentWillMount=="function"&&ve.componentWillMount(),typeof ve.UNSAFE_componentWillMount=="function"&&ve.UNSAFE_componentWillMount()),typeof ve.componentDidMount=="function"&&(_.flags|=4194308)):(typeof ve.componentDidMount=="function"&&(_.flags|=4194308),_.memoizedProps=z,_.memoizedState=ft),ve.props=z,ve.state=ft,ve.context=Ht,z=ze):(typeof ve.componentDidMount=="function"&&(_.flags|=4194308),z=!1)}else{ve=_.stateNode,w1(y,_),ze=_.memoizedProps,Ht=_.type===_.elementType?ze:zi(_.type,ze),ve.props=Ht,Br=_.pendingProps,nr=ve.context,ft=O.contextType,typeof ft=="object"&&ft!==null?ft=Bi(ft):(ft=Zr(O)?Nn:Sr.current,ft=bn(_,ft));var Un=O.getDerivedStateFromProps;(dr=typeof Un=="function"||typeof ve.getSnapshotBeforeUpdate=="function")||typeof ve.UNSAFE_componentWillReceiveProps!="function"&&typeof ve.componentWillReceiveProps!="function"||(ze!==Br||nr!==ft)&&ig(_,ve,z,ft),$i=!1,nr=_.memoizedState,ve.state=nr,yc(_,z,ve,K);var kn=_.memoizedState;ze!==Br||nr!==kn||kr.current||$i?(typeof Un=="function"&&(Ip(_,O,Un,z),kn=_.memoizedState),(Ht=$i||T1(_,O,Ht,z,nr,kn,ft)||!1)?(dr||typeof ve.UNSAFE_componentWillUpdate!="function"&&typeof ve.componentWillUpdate!="function"||(typeof ve.componentWillUpdate=="function"&&ve.componentWillUpdate(z,kn,ft),typeof ve.UNSAFE_componentWillUpdate=="function"&&ve.UNSAFE_componentWillUpdate(z,kn,ft)),typeof ve.componentDidUpdate=="function"&&(_.flags|=4),typeof ve.getSnapshotBeforeUpdate=="function"&&(_.flags|=1024)):(typeof ve.componentDidUpdate!="function"||ze===y.memoizedProps&&nr===y.memoizedState||(_.flags|=4),typeof ve.getSnapshotBeforeUpdate!="function"||ze===y.memoizedProps&&nr===y.memoizedState||(_.flags|=1024),_.memoizedProps=z,_.memoizedState=kn),ve.props=z,ve.state=kn,ve.context=ft,z=Ht):(typeof ve.componentDidUpdate!="function"||ze===y.memoizedProps&&nr===y.memoizedState||(_.flags|=4),typeof ve.getSnapshotBeforeUpdate!="function"||ze===y.memoizedProps&&nr===y.memoizedState||(_.flags|=1024),z=!1)}return Ta(y,_,O,z,te,K)}function Ta(y,_,O,z,K,te){An(y,_);var ve=(_.flags&128)!==0;if(!z&&!ve)return K&&es(_,O,!1),Hl(y,_,te);z=_.stateNode,ah.current=_;var ze=ve&&typeof O.getDerivedStateFromError!="function"?null:z.render();return _.flags|=1,y!==null&&ve?(_.child=lu(_,y.child,null,te),_.child=lu(_,null,ze,te)):ea(y,_,ze,te),_.memoizedState=z.state,K&&es(_,O,!0),_.child}function Cc(y){var _=y.stateNode;_.pendingContext?Tt(y,_.pendingContext,_.pendingContext!==_.context):_.context&&Tt(y,_.context,!1),X0(y,_.containerInfo)}function wu(y,_,O,z,K){return iu(),gp(K),_.flags|=256,ea(y,_,O,z),_.child}var Ea={dehydrated:null,treeContext:null,retryLane:0};function jd(y){return{baseLanes:y,cachePool:null,transitions:null}}function Rp(y,_,O){var z=_.pendingProps,K=ts.current,te=!1,ve=(_.flags&128)!==0,ze;if((ze=ve)||(ze=y!==null&&y.memoizedState===null?!1:(K&2)!==0),ze?(te=!0,_.flags&=-129):(y===null||y.memoizedState!==null)&&(K|=1),fe(ts,K&1),y===null)return hp(_),y=_.memoizedState,y!==null&&(y=y.dehydrated,y!==null)?((_.mode&1)===0?_.lanes=1:cr(y)?_.lanes=8:_.lanes=1073741824,null):(ve=z.children,y=z.fallback,te?(z=_.mode,te=_.child,ve={mode:"hidden",children:ve},(z&1)===0&&te!==null?(te.childLanes=0,te.pendingProps=ve):te=Gd(ve,z,0,null),y=pa(y,z,O,null),te.return=_,y.return=_,te.sibling=y,_.child=te,_.child.memoizedState=jd(O),_.memoizedState=Ea,y):cg(_,ve));if(K=y.memoizedState,K!==null&&(ze=K.dehydrated,ze!==null))return j1(y,_,ve,z,ze,K,O);if(te){te=z.fallback,ve=_.mode,K=y.child,ze=K.sibling;var ft={mode:"hidden",children:z.children};return(ve&1)===0&&_.child!==K?(z=_.child,z.childLanes=0,z.pendingProps=ft,_.deletions=null):(z=Dc(K,ft),z.subtreeFlags=K.subtreeFlags&14680064),ze!==null?te=Dc(ze,te):(te=pa(te,ve,O,null),te.flags|=2),te.return=_,z.return=_,z.sibling=te,_.child=z,z=te,te=_.child,ve=y.child.memoizedState,ve=ve===null?jd(O):{baseLanes:ve.baseLanes|O,cachePool:null,transitions:ve.transitions},te.memoizedState=ve,te.childLanes=y.childLanes&~O,_.memoizedState=Ea,z}return te=y.child,y=te.sibling,z=Dc(te,{mode:"visible",children:z.children}),(_.mode&1)===0&&(z.lanes=O),z.return=_,z.sibling=null,y!==null&&(O=_.deletions,O===null?(_.deletions=[y],_.flags|=16):O.push(y)),_.child=z,_.memoizedState=null,z}function cg(y,_){return _=Gd({mode:"visible",children:_},y.mode,0,null),_.return=y,y.child=_}function bu(y,_,O,z){return z!==null&&gp(z),lu(_,y.child,null,O),y=cg(_,_.pendingProps.children),y.flags|=2,_.memoizedState=null,y}function j1(y,_,O,z,K,te,ve){if(O)return _.flags&256?(_.flags&=-257,z=Sc(Error(i(422))),bu(y,_,ve,z)):_.memoizedState!==null?(_.child=y.child,_.flags|=128,null):(te=z.fallback,K=_.mode,z=Gd({mode:"visible",children:z.children},K,0,null),te=pa(te,K,ve,null),te.flags|=2,z.return=_,te.return=_,z.sibling=te,_.child=z,(_.mode&1)!==0&&lu(_,y.child,null,ve),_.child.memoizedState=jd(ve),_.memoizedState=Ea,te);if((_.mode&1)===0)return bu(y,_,ve,null);if(cr(K))return z=qr(K).digest,te=Error(i(419)),z=Sc(te,z,void 0),bu(y,_,ve,z);if(O=(ve&y.childLanes)!==0,zs||O){if(z=jn,z!==null){switch(ve&-ve){case 4:K=2;break;case 16:K=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:K=32;break;case 536870912:K=268435456;break;default:K=0}K=(K&(z.suspendedLanes|ve))!==0?0:K,K!==0&&K!==te.retryLane&&(te.retryLane=K,Oo(y,K),Aa(z,y,K,-1))}return Wd(),z=Sc(Error(i(421))),bu(y,_,ve,z)}return xr(K)?(_.flags|=128,_.child=y.child,_=L1.bind(null,y),ue(K,_),null):(y=te.treeContext,ge&&(Ka=be(K),ha=_,Wn=!0,Fo=null,Yf=!1,y!==null&&(Va[Li++]=xi,Va[Li++]=jo,Va[Li++]=$s,xi=y.id,jo=y.overflow,$s=_)),_=cg(_,z.children),_.flags|=4096,_)}function rl(y,_,O){y.lanes|=_;var z=y.alternate;z!==null&&(z.lanes|=_),cu(y.return,_,O)}function Pd(y,_,O,z,K){var te=y.memoizedState;te===null?y.memoizedState={isBackwards:_,rendering:null,renderingStartTime:0,last:z,tail:O,tailMode:K}:(te.isBackwards=_,te.rendering=null,te.renderingStartTime=0,te.last=z,te.tail=O,te.tailMode=K)}function ug(y,_,O){var z=_.pendingProps,K=z.revealOrder,te=z.tail;if(ea(y,_,z.children,O),z=ts.current,(z&2)!==0)z=z&1|2,_.flags|=128;else{if(y!==null&&(y.flags&128)!==0)e:for(y=_.child;y!==null;){if(y.tag===13)y.memoizedState!==null&&rl(y,O,_);else if(y.tag===19)rl(y,O,_);else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===_)break e;for(;y.sibling===null;){if(y.return===null||y.return===_)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}z&=1}if(fe(ts,z),(_.mode&1)===0)_.memoizedState=null;else switch(K){case"forwards":for(O=_.child,K=null;O!==null;)y=O.alternate,y!==null&&Q0(y)===null&&(K=O),O=O.sibling;O=K,O===null?(K=_.child,_.child=null):(K=O.sibling,O.sibling=null),Pd(_,!1,K,O,te);break;case"backwards":for(O=null,K=_.child,_.child=null;K!==null;){if(y=K.alternate,y!==null&&Q0(y)===null){_.child=K;break}y=K.sibling,K.sibling=O,O=K,K=y}Pd(_,!0,O,null,te);break;case"together":Pd(_,!1,null,null,void 0);break;default:_.memoizedState=null}return _.child}function ih(y,_){(_.mode&1)===0&&y!==null&&(y.alternate=null,_.alternate=null,_.flags|=2)}function Hl(y,_,O){if(y!==null&&(_.dependencies=y.dependencies),Vl|=_.lanes,(O&_.childLanes)===0)return null;if(y!==null&&_.child!==y.child)throw Error(i(153));if(_.child!==null){for(y=_.child,O=Dc(y,y.pendingProps),_.child=O,O.return=_;y.sibling!==null;)y=y.sibling,O=O.sibling=Dc(y,y.pendingProps),O.return=_;O.sibling=null}return _.child}function Tc(y,_,O){switch(_.tag){case 3:Cc(_),iu();break;case 5:vp(_);break;case 1:Zr(_.type)&&ar(_);break;case 4:X0(_,_.stateNode.containerInfo);break;case 10:v1(_,_.type._context,_.memoizedProps.value);break;case 13:var z=_.memoizedState;if(z!==null)return z.dehydrated!==null?(fe(ts,ts.current&1),_.flags|=128,null):(O&_.child.childLanes)!==0?Rp(y,_,O):(fe(ts,ts.current&1),y=Hl(y,_,O),y!==null?y.sibling:null);fe(ts,ts.current&1);break;case 19:if(z=(O&_.childLanes)!==0,(y.flags&128)!==0){if(z)return ug(y,_,O);_.flags|=128}var K=_.memoizedState;if(K!==null&&(K.rendering=null,K.tail=null,K.lastEffect=null),fe(ts,ts.current),z)break;return null;case 22:case 23:return _.lanes=0,Bn(y,_,O)}return Hl(y,_,O)}function qa(y){y.flags|=4}function _u(y,_){if(y!==null&&y.child===_.child)return!0;if((_.flags&16)!==0)return!1;for(y=_.child;y!==null;){if((y.flags&12854)!==0||(y.subtreeFlags&12854)!==0)return!1;y=y.sibling}return!0}var Ec,Nc,Ya,Xa;if(Se)Ec=function(y,_){for(var O=_.child;O!==null;){if(O.tag===5||O.tag===6)R(y,O.stateNode);else if(O.tag!==4&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===_)break;for(;O.sibling===null;){if(O.return===null||O.return===_)return;O=O.return}O.sibling.return=O.return,O=O.sibling}},Nc=function(){},Ya=function(y,_,O,z,K){if(y=y.memoizedProps,y!==z){var te=_.stateNode,ve=co(lo.current);O=q(te,O,y,z,K,ve),(_.updateQueue=O)&&qa(_)}},Xa=function(y,_,O,z){O!==z&&qa(_)};else if(re){Ec=function(y,_,O,z){for(var K=_.child;K!==null;){if(K.tag===5){var te=K.stateNode;O&&z&&(te=We(te,K.type,K.memoizedProps,K)),R(y,te)}else if(K.tag===6)te=K.stateNode,O&&z&&(te=Qe(te,K.memoizedProps,K)),R(y,te);else if(K.tag!==4){if(K.tag===22&&K.memoizedState!==null)te=K.child,te!==null&&(te.return=K),Ec(y,K,!0,!0);else if(K.child!==null){K.child.return=K,K=K.child;continue}}if(K===_)break;for(;K.sibling===null;){if(K.return===null||K.return===_)return;K=K.return}K.sibling.return=K.return,K=K.sibling}};var Ac=function(y,_,O,z){for(var K=_.child;K!==null;){if(K.tag===5){var te=K.stateNode;O&&z&&(te=We(te,K.type,K.memoizedProps,K)),Fe(y,te)}else if(K.tag===6)te=K.stateNode,O&&z&&(te=Qe(te,K.memoizedProps,K)),Fe(y,te);else if(K.tag!==4){if(K.tag===22&&K.memoizedState!==null)te=K.child,te!==null&&(te.return=K),Ac(y,K,!0,!0);else if(K.child!==null){K.child.return=K,K=K.child;continue}}if(K===_)break;for(;K.sibling===null;){if(K.return===null||K.return===_)return;K=K.return}K.sibling.return=K.return,K=K.sibling}};Nc=function(y,_){var O=_.stateNode;if(!_u(y,_)){y=O.containerInfo;var z=Ct(y);Ac(z,_,!1,!1),O.pendingChildren=z,qa(_),st(y,z)}},Ya=function(y,_,O,z,K){var te=y.stateNode,ve=y.memoizedProps;if((y=_u(y,_))&&ve===z)_.stateNode=te;else{var ze=_.stateNode,ft=co(lo.current),Ht=null;ve!==z&&(Ht=q(ze,O,ve,z,K,ft)),y&&Ht===null?_.stateNode=te:(te=Re(te,Ht,O,ve,z,_,y,ze),U(te,O,z,K,ft)&&qa(_),_.stateNode=te,y?qa(_):Ec(te,_,!1,!1))}},Xa=function(y,_,O,z){O!==z?(y=co(wc.current),O=co(lo.current),_.stateNode=se(z,y,O,_),qa(_)):_.stateNode=y.stateNode}}else Nc=function(){},Ya=function(){},Xa=function(){};function Wi(y,_){if(!Wn)switch(y.tailMode){case"hidden":_=y.tail;for(var O=null;_!==null;)_.alternate!==null&&(O=_),_=_.sibling;O===null?y.tail=null:O.sibling=null;break;case"collapsed":O=y.tail;for(var z=null;O!==null;)O.alternate!==null&&(z=O),O=O.sibling;z===null?_||y.tail===null?y.tail=null:y.tail.sibling=null:z.sibling=null}}function Qn(y){var _=y.alternate!==null&&y.alternate.child===y.child,O=0,z=0;if(_)for(var K=y.child;K!==null;)O|=K.lanes|K.childLanes,z|=K.subtreeFlags&14680064,z|=K.flags&14680064,K.return=y,K=K.sibling;else for(K=y.child;K!==null;)O|=K.lanes|K.childLanes,z|=K.subtreeFlags,z|=K.flags,K.return=y,K=K.sibling;return y.subtreeFlags|=z,y.childLanes=O,_}function Su(y,_,O){var z=_.pendingProps;switch(qf(_),_.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qn(_),null;case 1:return Zr(_.type)&&Me(),Qn(_),null;case 3:return O=_.stateNode,uu(),Qr(kr),Qr(Sr),_p(),O.pendingContext&&(O.context=O.pendingContext,O.pendingContext=null),(y===null||y.child===null)&&(H0(_)?qa(_):y===null||y.memoizedState.isDehydrated&&(_.flags&256)===0||(_.flags|=1024,Fo!==null&&(_g(Fo),Fo=null))),Nc(y,_),Qn(_),null;case 5:wp(_),O=co(wc.current);var K=_.type;if(y!==null&&_.stateNode!=null)Ya(y,_,K,z,O),y.ref!==_.ref&&(_.flags|=512,_.flags|=2097152);else{if(!z){if(_.stateNode===null)throw Error(i(166));return Qn(_),null}if(y=co(lo.current),H0(_)){if(!ge)throw Error(i(175));y=_e(_.stateNode,_.type,_.memoizedProps,O,y,_,!Yf),_.updateQueue=y,y!==null&&qa(_)}else{var te=W(K,z,O,y,_);Ec(te,_,!1,!1),_.stateNode=te,U(te,K,z,O,y)&&qa(_)}_.ref!==null&&(_.flags|=512,_.flags|=2097152)}return Qn(_),null;case 6:if(y&&_.stateNode!=null)Xa(y,_,y.memoizedProps,z);else{if(typeof z!="string"&&_.stateNode===null)throw Error(i(166));if(y=co(wc.current),O=co(lo.current),H0(_)){if(!ge)throw Error(i(176));if(y=_.stateNode,O=_.memoizedProps,(z=Ge(y,O,_,!Yf))&&(K=ha,K!==null))switch(K.tag){case 3:ot(K.stateNode.containerInfo,y,O,(K.mode&1)!==0);break;case 5:mt(K.type,K.memoizedProps,K.stateNode,y,O,(K.mode&1)!==0)}z&&qa(_)}else _.stateNode=se(z,y,O,_)}return Qn(_),null;case 13:if(Qr(ts),z=_.memoizedState,y===null||y.memoizedState!==null&&y.memoizedState.dehydrated!==null){if(Wn&&Ka!==null&&(_.mode&1)!==0&&(_.flags&128)===0)m1(),iu(),_.flags|=98560,K=!1;else if(K=H0(_),z!==null&&z.dehydrated!==null){if(y===null){if(!K)throw Error(i(318));if(!ge)throw Error(i(344));if(K=_.memoizedState,K=K!==null?K.dehydrated:null,!K)throw Error(i(317));ut(K,_)}else iu(),(_.flags&128)===0&&(_.memoizedState=null),_.flags|=4;Qn(_),K=!1}else Fo!==null&&(_g(Fo),Fo=null),K=!0;if(!K)return _.flags&65536?_:null}return(_.flags&128)!==0?(_.lanes=O,_):(O=z!==null,O!==(y!==null&&y.memoizedState!==null)&&O&&(_.child.flags|=8192,(_.mode&1)!==0&&(y===null||(ts.current&1)!==0?Zn===0&&(Zn=3):Wd())),_.updateQueue!==null&&(_.flags|=4),Qn(_),null);case 4:return uu(),Nc(y,_),y===null&&Ae(_.stateNode.containerInfo),Qn(_),null;case 10:return Xf(_.type._context),Qn(_),null;case 17:return Zr(_.type)&&Me(),Qn(_),null;case 19:if(Qr(ts),K=_.memoizedState,K===null)return Qn(_),null;if(z=(_.flags&128)!==0,te=K.rendering,te===null)if(z)Wi(K,!1);else{if(Zn!==0||y!==null&&(y.flags&128)!==0)for(y=_.child;y!==null;){if(te=Q0(y),te!==null){for(_.flags|=128,Wi(K,!1),y=te.updateQueue,y!==null&&(_.updateQueue=y,_.flags|=4),_.subtreeFlags=0,y=O,O=_.child;O!==null;)z=O,K=y,z.flags&=14680066,te=z.alternate,te===null?(z.childLanes=0,z.lanes=K,z.child=null,z.subtreeFlags=0,z.memoizedProps=null,z.memoizedState=null,z.updateQueue=null,z.dependencies=null,z.stateNode=null):(z.childLanes=te.childLanes,z.lanes=te.lanes,z.child=te.child,z.subtreeFlags=0,z.deletions=null,z.memoizedProps=te.memoizedProps,z.memoizedState=te.memoizedState,z.updateQueue=te.updateQueue,z.type=te.type,K=te.dependencies,z.dependencies=K===null?null:{lanes:K.lanes,firstContext:K.firstContext}),O=O.sibling;return fe(ts,ts.current&1|2),_.child}y=y.sibling}K.tail!==null&&Yn()>hh&&(_.flags|=128,z=!0,Wi(K,!1),_.lanes=4194304)}else{if(!z)if(y=Q0(te),y!==null){if(_.flags|=128,z=!0,y=y.updateQueue,y!==null&&(_.updateQueue=y,_.flags|=4),Wi(K,!0),K.tail===null&&K.tailMode==="hidden"&&!te.alternate&&!Wn)return Qn(_),null}else 2*Yn()-K.renderingStartTime>hh&&O!==1073741824&&(_.flags|=128,z=!0,Wi(K,!1),_.lanes=4194304);K.isBackwards?(te.sibling=_.child,_.child=te):(y=K.last,y!==null?y.sibling=te:_.child=te,K.last=te)}return K.tail!==null?(_=K.tail,K.rendering=_,K.tail=_.sibling,K.renderingStartTime=Yn(),_.sibling=null,y=ts.current,fe(ts,z?y&1|2:y&1),_):(Qn(_),null);case 22:case 23:return Sg(),O=_.memoizedState!==null,y!==null&&y.memoizedState!==null!==O&&(_.flags|=8192),O&&(_.mode&1)!==0?(Ws&1073741824)!==0&&(Qn(_),Se&&_.subtreeFlags&6&&(_.flags|=8192)):Qn(_),null;case 24:return null;case 25:return null}throw Error(i(156,_.tag))}function P1(y,_){switch(qf(_),_.tag){case 1:return Zr(_.type)&&Me(),y=_.flags,y&65536?(_.flags=y&-65537|128,_):null;case 3:return uu(),Qr(kr),Qr(Sr),_p(),y=_.flags,(y&65536)!==0&&(y&128)===0?(_.flags=y&-65537|128,_):null;case 5:return wp(_),null;case 13:if(Qr(ts),y=_.memoizedState,y!==null&&y.dehydrated!==null){if(_.alternate===null)throw Error(i(340));iu()}return y=_.flags,y&65536?(_.flags=y&-65537|128,_):null;case 19:return Qr(ts),null;case 4:return uu(),null;case 10:return Xf(_.type._context),null;case 22:case 23:return Sg(),null;case 24:return null;default:return null}}var Fd=!1,ta=!1,Hi=typeof WeakSet=="function"?WeakSet:Set,tr=null;function Sn(y,_){var O=y.ref;if(O!==null)if(typeof O=="function")try{O(null)}catch(z){Gn(y,_,z)}else O.current=null}function Gi(y,_,O){try{O()}catch(z){Gn(y,_,z)}}var Mp=!1;function F1(y,_){for(M(y.containerInfo),tr=_;tr!==null;)if(y=tr,_=y.child,(y.subtreeFlags&1028)!==0&&_!==null)_.return=y,tr=_;else for(;tr!==null;){y=tr;try{var O=y.alternate;if((y.flags&1024)!==0)switch(y.tag){case 0:case 11:case 15:break;case 1:if(O!==null){var z=O.memoizedProps,K=O.memoizedState,te=y.stateNode,ve=te.getSnapshotBeforeUpdate(y.elementType===y.type?z:zi(y.type,z),K);te.__reactInternalSnapshotBeforeUpdate=ve}break;case 3:Se&&Pe(y.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(ze){Gn(y,y.return,ze)}if(_=y.sibling,_!==null){_.return=y.return,tr=_;break}tr=y.return}return O=Mp,Mp=!1,O}function ku(y,_,O){var z=_.updateQueue;if(z=z!==null?z.lastEffect:null,z!==null){var K=z=z.next;do{if((K.tag&y)===y){var te=K.destroy;K.destroy=void 0,te!==void 0&&Gi(_,O,te)}K=K.next}while(K!==z)}}function Od(y,_){if(_=_.updateQueue,_=_!==null?_.lastEffect:null,_!==null){var O=_=_.next;do{if((O.tag&y)===y){var z=O.create;O.destroy=z()}O=O.next}while(O!==_)}}function dg(y){var _=y.ref;if(_!==null){var O=y.stateNode;switch(y.tag){case 5:y=ne(O);break;default:y=O}typeof _=="function"?_(y):_.current=y}}function oh(y){var _=y.alternate;_!==null&&(y.alternate=null,oh(_)),y.child=null,y.deletions=null,y.sibling=null,y.tag===5&&(_=y.stateNode,_!==null&&Be(_)),y.stateNode=null,y.return=null,y.dependencies=null,y.memoizedProps=null,y.memoizedState=null,y.pendingProps=null,y.stateNode=null,y.updateQueue=null}function Lp(y){return y.tag===5||y.tag===3||y.tag===4}function Cu(y){e:for(;;){for(;y.sibling===null;){if(y.return===null||Lp(y.return))return null;y=y.return}for(y.sibling.return=y.return,y=y.sibling;y.tag!==5&&y.tag!==6&&y.tag!==18;){if(y.flags&2||y.child===null||y.tag===4)continue e;y.child.return=y,y=y.child}if(!(y.flags&2))return y.stateNode}}function lh(y,_,O){var z=y.tag;if(z===5||z===6)y=y.stateNode,_?qt(O,y,_):lt(O,y);else if(z!==4&&(y=y.child,y!==null))for(lh(y,_,O),y=y.sibling;y!==null;)lh(y,_,O),y=y.sibling}function Bp(y,_,O){var z=y.tag;if(z===5||z===6)y=y.stateNode,_?At(O,y,_):Le(O,y);else if(z!==4&&(y=y.child,y!==null))for(Bp(y,_,O),y=y.sibling;y!==null;)Bp(y,_,O),y=y.sibling}var xs=null,vi=!1;function Do(y,_,O){for(O=O.child;O!==null;)fg(y,_,O),O=O.sibling}function fg(y,_,O){if(pi&&typeof pi.onCommitFiberUnmount=="function")try{pi.onCommitFiberUnmount(mc,O)}catch{}switch(O.tag){case 5:ta||Sn(O,_);case 6:if(Se){var z=xs,K=vi;xs=null,Do(y,_,O),xs=z,vi=K,xs!==null&&(vi?Rr(xs,O.stateNode):pr(xs,O.stateNode))}else Do(y,_,O);break;case 18:Se&&xs!==null&&(vi?Ce(xs,O.stateNode):Te(xs,O.stateNode));break;case 4:Se?(z=xs,K=vi,xs=O.stateNode.containerInfo,vi=!0,Do(y,_,O),xs=z,vi=K):(re&&(z=O.stateNode.containerInfo,K=Ct(z),ke(z,K)),Do(y,_,O));break;case 0:case 11:case 14:case 15:if(!ta&&(z=O.updateQueue,z!==null&&(z=z.lastEffect,z!==null))){K=z=z.next;do{var te=K,ve=te.destroy;te=te.tag,ve!==void 0&&((te&2)!==0||(te&4)!==0)&&Gi(O,_,ve),K=K.next}while(K!==z)}Do(y,_,O);break;case 1:if(!ta&&(Sn(O,_),z=O.stateNode,typeof z.componentWillUnmount=="function"))try{z.props=O.memoizedProps,z.state=O.memoizedState,z.componentWillUnmount()}catch(ze){Gn(O,_,ze)}Do(y,_,O);break;case 21:Do(y,_,O);break;case 22:O.mode&1?(ta=(z=ta)||O.memoizedState!==null,Do(y,_,O),ta=z):Do(y,_,O);break;default:Do(y,_,O)}}function Tu(y){var _=y.updateQueue;if(_!==null){y.updateQueue=null;var O=y.stateNode;O===null&&(O=y.stateNode=new Hi),_.forEach(function(z){var K=V2.bind(null,y,z);O.has(z)||(O.add(z),z.then(K,K))})}}function fo(y,_){var O=_.deletions;if(O!==null)for(var z=0;z<O.length;z++){var K=O[z];try{var te=y,ve=_;if(Se){var ze=ve;e:for(;ze!==null;){switch(ze.tag){case 5:xs=ze.stateNode,vi=!1;break e;case 3:xs=ze.stateNode.containerInfo,vi=!0;break e;case 4:xs=ze.stateNode.containerInfo,vi=!0;break e}ze=ze.return}if(xs===null)throw Error(i(160));fg(te,ve,K),xs=null,vi=!1}else fg(te,ve,K);var ft=K.alternate;ft!==null&&(ft.return=null),K.return=null}catch(Ht){Gn(K,_,Ht)}}if(_.subtreeFlags&12854)for(_=_.child;_!==null;)ch(_,y),_=_.sibling}function ch(y,_){var O=y.alternate,z=y.flags;switch(y.tag){case 0:case 11:case 14:case 15:if(fo(_,y),Vi(y),z&4){try{ku(3,y,y.return),Od(3,y)}catch(nr){Gn(y,y.return,nr)}try{ku(5,y,y.return)}catch(nr){Gn(y,y.return,nr)}}break;case 1:fo(_,y),Vi(y),z&512&&O!==null&&Sn(O,O.return);break;case 5:if(fo(_,y),Vi(y),z&512&&O!==null&&Sn(O,O.return),Se){if(y.flags&32){var K=y.stateNode;try{Kr(K)}catch(nr){Gn(y,y.return,nr)}}if(z&4&&(K=y.stateNode,K!=null)){var te=y.memoizedProps;if(O=O!==null?O.memoizedProps:te,z=y.type,_=y.updateQueue,y.updateQueue=null,_!==null)try{Et(K,_,z,O,te,y)}catch(nr){Gn(y,y.return,nr)}}}break;case 6:if(fo(_,y),Vi(y),z&4&&Se){if(y.stateNode===null)throw Error(i(162));K=y.stateNode,te=y.memoizedProps,O=O!==null?O.memoizedProps:te;try{Ue(K,O,te)}catch(nr){Gn(y,y.return,nr)}}break;case 3:if(fo(_,y),Vi(y),z&4){if(Se&&ge&&O!==null&&O.memoizedState.isDehydrated)try{oe(_.containerInfo)}catch(nr){Gn(y,y.return,nr)}if(re){K=_.containerInfo,te=_.pendingChildren;try{ke(K,te)}catch(nr){Gn(y,y.return,nr)}}}break;case 4:if(fo(_,y),Vi(y),z&4&&re){te=y.stateNode,K=te.containerInfo,te=te.pendingChildren;try{ke(K,te)}catch(nr){Gn(y,y.return,nr)}}break;case 13:fo(_,y),Vi(y),K=y.child,K.flags&8192&&(te=K.memoizedState!==null,K.stateNode.isHidden=te,!te||K.alternate!==null&&K.alternate.memoizedState!==null||(Bd=Yn())),z&4&&Tu(y);break;case 22:var ve=O!==null&&O.memoizedState!==null;if(y.mode&1?(ta=(O=ta)||ve,fo(_,y),ta=O):fo(_,y),Vi(y),z&8192){if(O=y.memoizedState!==null,(y.stateNode.isHidden=O)&&!ve&&(y.mode&1)!==0)for(tr=y,z=y.child;z!==null;){for(_=tr=z;tr!==null;){ve=tr;var ze=ve.child;switch(ve.tag){case 0:case 11:case 14:case 15:ku(4,ve,ve.return);break;case 1:Sn(ve,ve.return);var ft=ve.stateNode;if(typeof ft.componentWillUnmount=="function"){var Ht=ve,dr=ve.return;try{var Br=Ht;ft.props=Br.memoizedProps,ft.state=Br.memoizedState,ft.componentWillUnmount()}catch(nr){Gn(Ht,dr,nr)}}break;case 5:Sn(ve,ve.return);break;case 22:if(ve.memoizedState!==null){mg(_);continue}}ze!==null?(ze.return=ve,tr=ze):mg(_)}z=z.sibling}if(Se){e:if(z=null,Se)for(_=y;;){if(_.tag===5){if(z===null){z=_;try{K=_.stateNode,O?ur(K):me(_.stateNode,_.memoizedProps)}catch(nr){Gn(y,y.return,nr)}}}else if(_.tag===6){if(z===null)try{te=_.stateNode,O?ir(te):Ne(te,_.memoizedProps)}catch(nr){Gn(y,y.return,nr)}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===y)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===y)break e;for(;_.sibling===null;){if(_.return===null||_.return===y)break e;z===_&&(z=null),_=_.return}z===_&&(z=null),_.sibling.return=_.return,_=_.sibling}}}break;case 19:fo(_,y),Vi(y),z&4&&Tu(y);break;case 21:break;default:fo(_,y),Vi(y)}}function Vi(y){var _=y.flags;if(_&2){try{if(Se){e:{for(var O=y.return;O!==null;){if(Lp(O)){var z=O;break e}O=O.return}throw Error(i(160))}switch(z.tag){case 5:var K=z.stateNode;z.flags&32&&(Kr(K),z.flags&=-33);var te=Cu(y);Bp(y,te,K);break;case 3:case 4:var ve=z.stateNode.containerInfo,ze=Cu(y);lh(y,ze,ve);break;default:throw Error(i(161))}}}catch(ft){Gn(y,y.return,ft)}y.flags&=-3}_&4096&&(y.flags&=-4097)}function Dd(y,_,O){tr=y,hg(y)}function hg(y,_,O){for(var z=(y.mode&1)!==0;tr!==null;){var K=tr,te=K.child;if(K.tag===22&&z){var ve=K.memoizedState!==null||Fd;if(!ve){var ze=K.alternate,ft=ze!==null&&ze.memoizedState!==null||ta;ze=Fd;var Ht=ta;if(Fd=ve,(ta=ft)&&!Ht)for(tr=K;tr!==null;)ve=tr,ft=ve.child,ve.tag===22&&ve.memoizedState!==null?pg(K):ft!==null?(ft.return=ve,tr=ft):pg(K);for(;te!==null;)tr=te,hg(te),te=te.sibling;tr=K,Fd=ze,ta=Ht}gg(y)}else(K.subtreeFlags&8772)!==0&&te!==null?(te.return=K,tr=te):gg(y)}}function gg(y){for(;tr!==null;){var _=tr;if((_.flags&8772)!==0){var O=_.alternate;try{if((_.flags&8772)!==0)switch(_.tag){case 0:case 11:case 15:ta||Od(5,_);break;case 1:var z=_.stateNode;if(_.flags&4&&!ta)if(O===null)z.componentDidMount();else{var K=_.elementType===_.type?O.memoizedProps:zi(_.type,O.memoizedProps);z.componentDidUpdate(K,O.memoizedState,z.__reactInternalSnapshotBeforeUpdate)}var te=_.updateQueue;te!==null&&b1(_,te,z);break;case 3:var ve=_.updateQueue;if(ve!==null){if(O=null,_.child!==null)switch(_.child.tag){case 5:O=ne(_.child.stateNode);break;case 1:O=_.child.stateNode}b1(_,ve,O)}break;case 5:var ze=_.stateNode;O===null&&_.flags&4&&tt(ze,_.type,_.memoizedProps,_);break;case 6:break;case 4:break;case 12:break;case 13:if(ge&&_.memoizedState===null){var ft=_.alternate;if(ft!==null){var Ht=ft.memoizedState;if(Ht!==null){var dr=Ht.dehydrated;dr!==null&&he(dr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}ta||_.flags&512&&dg(_)}catch(Br){Gn(_,_.return,Br)}}if(_===y){tr=null;break}if(O=_.sibling,O!==null){O.return=_.return,tr=O;break}tr=_.return}}function mg(y){for(;tr!==null;){var _=tr;if(_===y){tr=null;break}var O=_.sibling;if(O!==null){O.return=_.return,tr=O;break}tr=_.return}}function pg(y){for(;tr!==null;){var _=tr;try{switch(_.tag){case 0:case 11:case 15:var O=_.return;try{Od(4,_)}catch(ft){Gn(_,O,ft)}break;case 1:var z=_.stateNode;if(typeof z.componentDidMount=="function"){var K=_.return;try{z.componentDidMount()}catch(ft){Gn(_,K,ft)}}var te=_.return;try{dg(_)}catch(ft){Gn(_,te,ft)}break;case 5:var ve=_.return;try{dg(_)}catch(ft){Gn(_,ve,ft)}}}catch(ft){Gn(_,_.return,ft)}if(_===y){tr=null;break}var ze=_.sibling;if(ze!==null){ze.return=_.return,tr=ze;break}tr=_.return}}var Gl=0,Qa=1,nl=2,Id=3,uh=4;if(typeof Symbol=="function"&&Symbol.for){var Ki=Symbol.for;Gl=Ki("selector.component"),Qa=Ki("selector.has_pseudo_class"),nl=Ki("selector.role"),Id=Ki("selector.test_id"),uh=Ki("selector.text")}function sl(y){var _=Ee(y);if(_!=null){if(typeof _.memoizedProps["data-testname"]!="string")throw Error(i(364));return _}if(y=xt(y),y===null)throw Error(i(362));return y.stateNode.current}function dh(y,_){switch(_.$$typeof){case Gl:if(y.type===_.value)return!0;break;case Qa:e:{_=_.value,y=[y,0];for(var O=0;O<y.length;){var z=y[O++],K=y[O++],te=_[K];if(z.tag!==5||!Dt(z)){for(;te!=null&&dh(z,te);)K++,te=_[K];if(K===_.length){_=!0;break e}else for(z=z.child;z!==null;)y.push(z,K),z=z.sibling}}_=!1}return _;case nl:if(y.tag===5&&Mt(y.stateNode,_.value))return!0;break;case uh:if((y.tag===5||y.tag===6)&&(y=ht(y),y!==null&&0<=y.indexOf(_.value)))return!0;break;case Id:if(y.tag===5&&(y=y.memoizedProps["data-testname"],typeof y=="string"&&y.toLowerCase()===_.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function xg(y){switch(y.$$typeof){case Gl:return"<"+(F(y.value)||"Unknown")+">";case Qa:return":has("+(xg(y)||"")+")";case nl:return'[role="'+y.value+'"]';case uh:return'"'+y.value+'"';case Id:return'[data-testname="'+y.value+'"]';default:throw Error(i(365))}}function al(y,_){var O=[];y=[y,0];for(var z=0;z<y.length;){var K=y[z++],te=y[z++],ve=_[te];if(K.tag!==5||!Dt(K)){for(;ve!=null&&dh(K,ve);)te++,ve=_[te];if(te===_.length)O.push(K);else for(K=K.child;K!==null;)y.push(K,te),K=K.sibling}}return O}function il(y,_){if(!vt)throw Error(i(363));y=sl(y),y=al(y,_),_=[],y=Array.from(y);for(var O=0;O<y.length;){var z=y[O++];if(z.tag===5)Dt(z)||_.push(z.stateNode);else for(z=z.child;z!==null;)y.push(z),z=z.sibling}return _}var yg=Math.ceil,fh=o.ReactCurrentDispatcher,Rd=o.ReactCurrentOwner,ds=o.ReactCurrentBatchConfig,Gr=0,jn=null,Jn=null,ys=0,Ws=0,jc=rn(0),Zn=0,Md=null,Vl=0,$n=0,Ld=0,Eu=null,Na=null,Bd=0,hh=1/0,Ja=null;function Tn(){hh=Yn()+500}var fs=!1,Cs=null,Io=null,Pc=!1,ho=null,vg=0,Ts=0,gh=null,$d=-1,Ud=0;function Hn(){return(Gr&6)!==0?Yn():$d!==-1?$d:$d=Yn()}function Hs(y){return(y.mode&1)===0?1:(Gr&2)!==0&&ys!==0?ys&-ys:W2.transition!==null?(Ud===0&&(Ud=jt()),Ud):(y=It,y!==0?y:He())}function Aa(y,_,O,z){if(50<Ts)throw Ts=0,gh=null,Error(i(185));nn(y,O,z),((Gr&2)===0||y!==jn)&&(y===jn&&((Gr&2)===0&&($n|=O),Zn===4&&Kl(y,ys)),ja(y,z),O===1&&Gr===0&&(_.mode&1)===0&&(Tn(),wd&&fa()))}function ja(y,_){var O=y.callbackNode;kt(y,_);var z=gt(y,y===jn?ys:0);if(z===0)O!==null&&Hr(O),y.callbackNode=null,y.callbackPriority=0;else if(_=z&-z,y.callbackPriority!==_){if(O!=null&&Hr(O),_===1)y.tag===0?d1($p.bind(null,y)):z0($p.bind(null,y)),Rt?et(function(){(Gr&6)===0&&fa()}):Wr(oo,fa),O=null;else{switch(_n(z)){case 1:O=oo;break;case 4:O=gc;break;case 16:O=$0;break;case 536870912:O=z2;break;default:O=$0}O=Kp(O,wg.bind(null,y))}y.callbackPriority=_,y.callbackNode=O}}function wg(y,_){if($d=-1,Ud=0,(Gr&6)!==0)throw Error(i(327));var O=y.callbackNode;if(ql()&&y.callbackNode!==O)return null;var z=gt(y,y===jn?ys:0);if(z===0)return null;if((z&30)!==0||(z&y.expiredLanes)!==0||_)_=Nu(y,z);else{_=z;var K=Gr;Gr|=2;var te=zp();(jn!==y||ys!==_)&&(Ja=null,Tn(),Fc(y,_));do try{Wp();break}catch(ze){zd(y,ze)}while(!0);pp(),fh.current=te,Gr=K,Jn!==null?_=0:(jn=null,ys=0,_=Zn)}if(_!==0){if(_===2&&(K=br(y),K!==0&&(z=K,_=bg(y,K))),_===1)throw O=Md,Fc(y,0),Kl(y,z),ja(y,Yn()),O;if(_===6)Kl(y,z);else{if(K=y.current.alternate,(z&30)===0&&!O1(K)&&(_=Nu(y,z),_===2&&(te=br(y),te!==0&&(z=te,_=bg(y,te))),_===1))throw O=Md,Fc(y,0),Kl(y,z),ja(y,Yn()),O;switch(y.finishedWork=K,y.finishedLanes=z,_){case 0:case 1:throw Error(i(345));case 2:Oc(y,Na,Ja);break;case 3:if(Kl(y,z),(z&130023424)===z&&(_=Bd+500-Yn(),10<_)){if(gt(y,0)!==0)break;if(K=y.suspendedLanes,(K&z)!==z){Hn(),y.pingedLanes|=y.suspendedLanes&K;break}y.timeoutHandle=X(Oc.bind(null,y,Na,Ja),_);break}Oc(y,Na,Ja);break;case 4:if(Kl(y,z),(z&4194240)===z)break;for(_=y.eventTimes,K=-1;0<z;){var ve=31-Kn(z);te=1<<ve,ve=_[ve],ve>K&&(K=ve),z&=~te}if(z=K,z=Yn()-z,z=(120>z?120:480>z?480:1080>z?1080:1920>z?1920:3e3>z?3e3:4320>z?4320:1960*yg(z/1960))-z,10<z){y.timeoutHandle=X(Oc.bind(null,y,Na,Ja),z);break}Oc(y,Na,Ja);break;case 5:Oc(y,Na,Ja);break;default:throw Error(i(329))}}}return ja(y,Yn()),y.callbackNode===O?wg.bind(null,y):null}function bg(y,_){var O=Eu;return y.current.memoizedState.isDehydrated&&(Fc(y,_).flags|=256),y=Nu(y,_),y!==2&&(_=Na,Na=O,_!==null&&_g(_)),y}function _g(y){Na===null?Na=y:Na.push.apply(Na,y)}function O1(y){for(var _=y;;){if(_.flags&16384){var O=_.updateQueue;if(O!==null&&(O=O.stores,O!==null))for(var z=0;z<O.length;z++){var K=O[z],te=K.getSnapshot;K=K.value;try{if(!Ao(te(),K))return!1}catch{return!1}}}if(O=_.child,_.subtreeFlags&16384&&O!==null)O.return=_,_=O;else{if(_===y)break;for(;_.sibling===null;){if(_.return===null||_.return===y)return!0;_=_.return}_.sibling.return=_.return,_=_.sibling}}return!0}function Kl(y,_){for(_&=~Ld,_&=~$n,y.suspendedLanes|=_,y.pingedLanes&=~_,y=y.expirationTimes;0<_;){var O=31-Kn(_),z=1<<O;y[O]=-1,_&=~z}}function $p(y){if((Gr&6)!==0)throw Error(i(327));ql();var _=gt(y,0);if((_&1)===0)return ja(y,Yn()),null;var O=Nu(y,_);if(y.tag!==0&&O===2){var z=br(y);z!==0&&(_=z,O=bg(y,z))}if(O===1)throw O=Md,Fc(y,0),Kl(y,_),ja(y,Yn()),O;if(O===6)throw Error(i(345));return y.finishedWork=y.current.alternate,y.finishedLanes=_,Oc(y,Na,Ja),ja(y,Yn()),null}function Up(y){ho!==null&&ho.tag===0&&(Gr&6)===0&&ql();var _=Gr;Gr|=1;var O=ds.transition,z=It;try{if(ds.transition=null,It=1,y)return y()}finally{It=z,ds.transition=O,Gr=_,(Gr&6)===0&&fa()}}function Sg(){Ws=jc.current,Qr(jc)}function Fc(y,_){y.finishedWork=null,y.finishedLanes=0;var O=y.timeoutHandle;if(O!==le&&(y.timeoutHandle=le,ie(O)),Jn!==null)for(O=Jn.return;O!==null;){var z=O;switch(qf(z),z.tag){case 1:z=z.type.childContextTypes,z!=null&&Me();break;case 3:uu(),Qr(kr),Qr(Sr),_p();break;case 5:wp(z);break;case 4:uu();break;case 13:Qr(ts);break;case 19:Qr(ts);break;case 10:Xf(z.type._context);break;case 22:case 23:Sg()}O=O.return}if(jn=y,Jn=y=Dc(y.current,null),ys=Ws=_,Zn=0,Md=null,Ld=$n=Vl=0,Na=Eu=null,xc!==null){for(_=0;_<xc.length;_++)if(O=xc[_],z=O.interleaved,z!==null){O.interleaved=null;var K=z.next,te=O.pending;if(te!==null){var ve=te.next;te.next=K,z.next=ve}O.pending=z}xc=null}return y}function zd(y,_){do{var O=Jn;try{if(pp(),yi.current=xu,Td){for(var z=Xn.memoizedState;z!==null;){var K=z.queue;K!==null&&(K.pending=null),z=z.next}Td=!1}if(bc=0,Us=ks=Xn=null,Jf=!1,Zf=0,Rd.current=null,O===null||O.return===null){Zn=1,Md=_,Jn=null;break}e:{var te=y,ve=O.return,ze=O,ft=_;if(_=ys,ze.flags|=32768,ft!==null&&typeof ft=="object"&&typeof ft.then=="function"){var Ht=ft,dr=ze,Br=dr.tag;if((dr.mode&1)===0&&(Br===0||Br===11||Br===15)){var nr=dr.alternate;nr?(dr.updateQueue=nr.updateQueue,dr.memoizedState=nr.memoizedState,dr.lanes=nr.lanes):(dr.updateQueue=null,dr.memoizedState=null)}var Un=A1(ve);if(Un!==null){Un.flags&=-257,kc(Un,ve,ze,te,_),Un.mode&1&&N1(te,Ht,_),_=Un,ft=Ht;var kn=_.updateQueue;if(kn===null){var Za=new Set;Za.add(ft),_.updateQueue=Za}else kn.add(ft);break e}else{if((_&1)===0){N1(te,Ht,_),Wd();break e}ft=Error(i(426))}}else if(Wn&&ze.mode&1){var ol=A1(ve);if(ol!==null){(ol.flags&65536)===0&&(ol.flags|=256),kc(ol,ve,ze,te,_),gp(yu(ft,ze));break e}}te=ft=yu(ft,ze),Zn!==4&&(Zn=2),Eu===null?Eu=[te]:Eu.push(te),te=ve;do{switch(te.tag){case 3:te.flags|=65536,_&=-_,te.lanes|=_;var ct=el(te,ft,_);kd(te,ct);break e;case 1:ze=ft;var Ve=te.type,yt=te.stateNode;if((te.flags&128)===0&&(typeof Ve.getDerivedStateFromError=="function"||yt!==null&&typeof yt.componentDidCatch=="function"&&(Io===null||!Io.has(yt)))){te.flags|=65536,_&=-_,te.lanes|=_;var sr=og(te,ze,_);kd(te,sr);break e}}te=te.return}while(te!==null)}Gp(O)}catch(Cr){_=Cr,Jn===O&&O!==null&&(Jn=O=O.return);continue}break}while(!0)}function zp(){var y=fh.current;return fh.current=xu,y===null?xu:y}function Wd(){(Zn===0||Zn===3||Zn===2)&&(Zn=4),jn===null||(Vl&268435455)===0&&($n&268435455)===0||Kl(jn,ys)}function Nu(y,_){var O=Gr;Gr|=2;var z=zp();(jn!==y||ys!==_)&&(Ja=null,Fc(y,_));do try{D1();break}catch(K){zd(y,K)}while(!0);if(pp(),Gr=O,fh.current=z,Jn!==null)throw Error(i(261));return jn=null,ys=0,Zn}function D1(){for(;Jn!==null;)Hp(Jn)}function Wp(){for(;Jn!==null&&!qn();)Hp(Jn)}function Hp(y){var _=B1(y.alternate,y,Ws);y.memoizedProps=y.pendingProps,_===null?Gp(y):Jn=_,Rd.current=null}function Gp(y){var _=y;do{var O=_.alternate;if(y=_.return,(_.flags&32768)===0){if(O=Su(O,_,Ws),O!==null){Jn=O;return}}else{if(O=P1(O,_),O!==null){O.flags&=32767,Jn=O;return}if(y!==null)y.flags|=32768,y.subtreeFlags=0,y.deletions=null;else{Zn=6,Jn=null;return}}if(_=_.sibling,_!==null){Jn=_;return}Jn=_=y}while(_!==null);Zn===0&&(Zn=5)}function Oc(y,_,O){var z=It,K=ds.transition;try{ds.transition=null,It=1,I1(y,_,O,z)}finally{ds.transition=K,It=z}return null}function I1(y,_,O,z){do ql();while(ho!==null);if((Gr&6)!==0)throw Error(i(327));O=y.finishedWork;var K=y.finishedLanes;if(O===null)return null;if(y.finishedWork=null,y.finishedLanes=0,O===y.current)throw Error(i(177));y.callbackNode=null,y.callbackPriority=0;var te=O.lanes|O.childLanes;if(Je(y,te),y===jn&&(Jn=jn=null,ys=0),(O.subtreeFlags&2064)===0&&(O.flags&2064)===0||Pc||(Pc=!0,Kp($0,function(){return ql(),null})),te=(O.flags&15990)!==0,(O.subtreeFlags&15990)!==0||te){te=ds.transition,ds.transition=null;var ve=It;It=1;var ze=Gr;Gr|=4,Rd.current=null,F1(y,O),ch(O,y),V(y.containerInfo),y.current=O,Dd(O),Mn(),Gr=ze,It=ve,ds.transition=te}else y.current=O;if(Pc&&(Pc=!1,ho=y,vg=K),te=y.pendingLanes,te===0&&(Io=null),vd(O.stateNode),ja(y,Yn()),_!==null)for(z=y.onRecoverableError,O=0;O<_.length;O++)K=_[O],z(K.value,{componentStack:K.stack,digest:K.digest});if(fs)throw fs=!1,y=Cs,Cs=null,y;return(vg&1)!==0&&y.tag!==0&&ql(),te=y.pendingLanes,(te&1)!==0?y===gh?Ts++:(Ts=0,gh=y):Ts=0,fa(),null}function ql(){if(ho!==null){var y=_n(vg),_=ds.transition,O=It;try{if(ds.transition=null,It=16>y?16:y,ho===null)var z=!1;else{if(y=ho,ho=null,vg=0,(Gr&6)!==0)throw Error(i(331));var K=Gr;for(Gr|=4,tr=y.current;tr!==null;){var te=tr,ve=te.child;if((tr.flags&16)!==0){var ze=te.deletions;if(ze!==null){for(var ft=0;ft<ze.length;ft++){var Ht=ze[ft];for(tr=Ht;tr!==null;){var dr=tr;switch(dr.tag){case 0:case 11:case 15:ku(8,dr,te)}var Br=dr.child;if(Br!==null)Br.return=dr,tr=Br;else for(;tr!==null;){dr=tr;var nr=dr.sibling,Un=dr.return;if(oh(dr),dr===Ht){tr=null;break}if(nr!==null){nr.return=Un,tr=nr;break}tr=Un}}}var kn=te.alternate;if(kn!==null){var Za=kn.child;if(Za!==null){kn.child=null;do{var ol=Za.sibling;Za.sibling=null,Za=ol}while(Za!==null)}}tr=te}}if((te.subtreeFlags&2064)!==0&&ve!==null)ve.return=te,tr=ve;else e:for(;tr!==null;){if(te=tr,(te.flags&2048)!==0)switch(te.tag){case 0:case 11:case 15:ku(9,te,te.return)}var ct=te.sibling;if(ct!==null){ct.return=te.return,tr=ct;break e}tr=te.return}}var Ve=y.current;for(tr=Ve;tr!==null;){ve=tr;var yt=ve.child;if((ve.subtreeFlags&2064)!==0&&yt!==null)yt.return=ve,tr=yt;else e:for(ve=Ve;tr!==null;){if(ze=tr,(ze.flags&2048)!==0)try{switch(ze.tag){case 0:case 11:case 15:Od(9,ze)}}catch(Cr){Gn(ze,ze.return,Cr)}if(ze===ve){tr=null;break e}var sr=ze.sibling;if(sr!==null){sr.return=ze.return,tr=sr;break e}tr=ze.return}}if(Gr=K,fa(),pi&&typeof pi.onPostCommitFiberRoot=="function")try{pi.onPostCommitFiberRoot(mc,y)}catch{}z=!0}return z}finally{It=O,ds.transition=_}}return!1}function Vp(y,_,O){_=yu(O,_),_=el(y,_,1),y=Ul(y,_,1),_=Hn(),y!==null&&(nn(y,1,_),ja(y,_))}function Gn(y,_,O){if(y.tag===3)Vp(y,y,O);else for(;_!==null;){if(_.tag===3){Vp(_,y,O);break}else if(_.tag===1){var z=_.stateNode;if(typeof _.type.getDerivedStateFromError=="function"||typeof z.componentDidCatch=="function"&&(Io===null||!Io.has(z))){y=yu(O,y),y=og(_,y,1),_=Ul(_,y,1),y=Hn(),_!==null&&(nn(_,1,y),ja(_,y));break}}_=_.return}}function R1(y,_,O){var z=y.pingCache;z!==null&&z.delete(_),_=Hn(),y.pingedLanes|=y.suspendedLanes&O,jn===y&&(ys&O)===O&&(Zn===4||Zn===3&&(ys&130023424)===ys&&500>Yn()-Bd?Fc(y,0):Ld|=O),ja(y,_)}function M1(y,_){_===0&&((y.mode&1)===0?_=1:(_=su,su<<=1,(su&130023424)===0&&(su=4194304)));var O=Hn();y=Oo(y,_),y!==null&&(nn(y,_,O),ja(y,O))}function L1(y){var _=y.memoizedState,O=0;_!==null&&(O=_.retryLane),M1(y,O)}function V2(y,_){var O=0;switch(y.tag){case 13:var z=y.stateNode,K=y.memoizedState;K!==null&&(O=K.retryLane);break;case 19:z=y.stateNode;break;default:throw Error(i(314))}z!==null&&z.delete(_),M1(y,O)}var B1;B1=function(y,_,O){if(y!==null)if(y.memoizedProps!==_.pendingProps||kr.current)zs=!0;else{if((y.lanes&O)===0&&(_.flags&128)===0)return zs=!1,Tc(y,_,O);zs=(y.flags&131072)!==0}else zs=!1,Wn&&(_.flags&1048576)!==0&&f1(_,au,_.index);switch(_.lanes=0,_.tag){case 2:var z=_.type;ih(y,_),y=_.pendingProps;var K=bn(_,Sr.current);Sd(_,O),K=eh(null,_,z,y,K,O);var te=J0();return _.flags|=1,typeof K=="object"&&K!==null&&typeof K.render=="function"&&K.$$typeof===void 0?(_.tag=1,_.memoizedState=null,_.updateQueue=null,Zr(z)?(te=!0,ar(_)):te=!1,_.memoizedState=K.state!==null&&K.state!==void 0?K.state:null,yp(_),K.updater=nh,_.stateNode=K,K._reactInternals=_,Zo(_,z,y,O),_=Ta(null,_,z,!0,te,O)):(_.tag=0,Wn&&te&&Kf(_),ea(null,_,K,O),_=_.child),_;case 16:z=_.elementType;e:{switch(ih(y,_),y=_.pendingProps,K=z._init,z=K(z._payload),_.type=z,K=_.tag=K2(z),y=zi(z,y),K){case 0:_=tl(null,_,z,y,O);break e;case 1:_=ma(null,_,z,y,O);break e;case 11:_=lg(null,_,z,y,O);break e;case 14:_=vu(null,_,z,zi(z.type,y),O);break e}throw Error(i(306,z,""))}return _;case 0:return z=_.type,K=_.pendingProps,K=_.elementType===z?K:zi(z,K),tl(y,_,z,K,O);case 1:return z=_.type,K=_.pendingProps,K=_.elementType===z?K:zi(z,K),ma(y,_,z,K,O);case 3:e:{if(Cc(_),y===null)throw Error(i(387));z=_.pendingProps,te=_.memoizedState,K=te.element,w1(y,_),yc(_,z,null,O);var ve=_.memoizedState;if(z=ve.element,ge&&te.isDehydrated)if(te={element:z,isDehydrated:!1,cache:ve.cache,pendingSuspenseBoundaries:ve.pendingSuspenseBoundaries,transitions:ve.transitions},_.updateQueue.baseState=te,_.memoizedState=te,_.flags&256){K=yu(Error(i(423)),_),_=wu(y,_,z,O,K);break e}else if(z!==K){K=yu(Error(i(424)),_),_=wu(y,_,z,O,K);break e}else for(ge&&(Ka=xe(_.stateNode.containerInfo),ha=_,Wn=!0,Fo=null,Yf=!1),O=y1(_,null,z,O),_.child=O;O;)O.flags=O.flags&-3|4096,O=O.sibling;else{if(iu(),z===K){_=Hl(y,_,O);break e}ea(y,_,z,O)}_=_.child}return _;case 5:return vp(_),y===null&&hp(_),z=_.type,K=_.pendingProps,te=y!==null?y.memoizedProps:null,ve=K.children,Q(z,K)?ve=null:te!==null&&Q(z,te)&&(_.flags|=32),An(y,_),ea(y,_,ve,O),_.child;case 6:return y===null&&hp(_),null;case 13:return Rp(y,_,O);case 4:return X0(_,_.stateNode.containerInfo),z=_.pendingProps,y===null?_.child=lu(_,null,z,O):ea(y,_,z,O),_.child;case 11:return z=_.type,K=_.pendingProps,K=_.elementType===z?K:zi(z,K),lg(y,_,z,K,O);case 7:return ea(y,_,_.pendingProps,O),_.child;case 8:return ea(y,_,_.pendingProps.children,O),_.child;case 12:return ea(y,_,_.pendingProps.children,O),_.child;case 10:e:{if(z=_.type._context,K=_.pendingProps,te=_.memoizedProps,ve=K.value,v1(_,z,ve),te!==null)if(Ao(te.value,ve)){if(te.children===K.children&&!kr.current){_=Hl(y,_,O);break e}}else for(te=_.child,te!==null&&(te.return=_);te!==null;){var ze=te.dependencies;if(ze!==null){ve=te.child;for(var ft=ze.firstContext;ft!==null;){if(ft.context===z){if(te.tag===1){ft=$l(-1,O&-O),ft.tag=2;var Ht=te.updateQueue;if(Ht!==null){Ht=Ht.shared;var dr=Ht.pending;dr===null?ft.next=ft:(ft.next=dr.next,dr.next=ft),Ht.pending=ft}}te.lanes|=O,ft=te.alternate,ft!==null&&(ft.lanes|=O),cu(te.return,O,_),ze.lanes|=O;break}ft=ft.next}}else if(te.tag===10)ve=te.type===_.type?null:te.child;else if(te.tag===18){if(ve=te.return,ve===null)throw Error(i(341));ve.lanes|=O,ze=ve.alternate,ze!==null&&(ze.lanes|=O),cu(ve,O,_),ve=te.sibling}else ve=te.child;if(ve!==null)ve.return=te;else for(ve=te;ve!==null;){if(ve===_){ve=null;break}if(te=ve.sibling,te!==null){te.return=ve.return,ve=te;break}ve=ve.return}te=ve}ea(y,_,K.children,O),_=_.child}return _;case 9:return K=_.type,z=_.pendingProps.children,Sd(_,O),K=Bi(K),z=z(K),_.flags|=1,ea(y,_,z,O),_.child;case 14:return z=_.type,K=zi(z,_.pendingProps),K=zi(z.type,K),vu(y,_,z,K,O);case 15:return Wl(y,_,_.type,_.pendingProps,O);case 17:return z=_.type,K=_.pendingProps,K=_.elementType===z?K:zi(z,K),ih(y,_),_.tag=1,Zr(z)?(y=!0,ar(_)):y=!1,Sd(_,O),E1(_,z,K),Zo(_,z,K,O),Ta(null,_,z,!0,y,O);case 19:return ug(y,_,O);case 22:return Bn(y,_,O)}throw Error(i(156,_.tag))};function Kp(y,_){return Wr(y,_)}function $1(y,_,O,z){this.tag=y,this.key=O,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=_,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=z,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qi(y,_,O,z){return new $1(y,_,O,z)}function Hd(y){return y=y.prototype,!(!y||!y.isReactComponent)}function K2(y){if(typeof y=="function")return Hd(y)?1:0;if(y!=null){if(y=y.$$typeof,y===v)return 11;if(y===k)return 14}return 2}function Dc(y,_){var O=y.alternate;return O===null?(O=qi(y.tag,_,y.key,y.mode),O.elementType=y.elementType,O.type=y.type,O.stateNode=y.stateNode,O.alternate=y,y.alternate=O):(O.pendingProps=_,O.type=y.type,O.flags=0,O.subtreeFlags=0,O.deletions=null),O.flags=y.flags&14680064,O.childLanes=y.childLanes,O.lanes=y.lanes,O.child=y.child,O.memoizedProps=y.memoizedProps,O.memoizedState=y.memoizedState,O.updateQueue=y.updateQueue,_=y.dependencies,O.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext},O.sibling=y.sibling,O.index=y.index,O.ref=y.ref,O}function kg(y,_,O,z,K,te){var ve=2;if(z=y,typeof y=="function")Hd(y)&&(ve=1);else if(typeof y=="string")ve=5;else e:switch(y){case d:return pa(O.children,K,te,_);case h:ve=8,K|=8;break;case g:return y=qi(12,O,_,K|2),y.elementType=g,y.lanes=te,y;case w:return y=qi(13,O,_,K),y.elementType=w,y.lanes=te,y;case C:return y=qi(19,O,_,K),y.elementType=C,y.lanes=te,y;case N:return Gd(O,K,te,_);default:if(typeof y=="object"&&y!==null)switch(y.$$typeof){case p:ve=10;break e;case x:ve=9;break e;case v:ve=11;break e;case k:ve=14;break e;case b:ve=16,z=null;break e}throw Error(i(130,y==null?y:typeof y,""))}return _=qi(ve,O,_,K),_.elementType=y,_.type=z,_.lanes=te,_}function pa(y,_,O,z){return y=qi(7,y,z,_),y.lanes=O,y}function Gd(y,_,O,z){return y=qi(22,y,z,_),y.elementType=N,y.lanes=O,y.stateNode={isHidden:!1},y}function Vd(y,_,O){return y=qi(6,y,null,_),y.lanes=O,y}function Cg(y,_,O){return _=qi(4,y.children!==null?y.children:[],y.key,_),_.lanes=O,_.stateNode={containerInfo:y.containerInfo,pendingChildren:null,implementation:y.implementation},_}function U1(y,_,O,z,K){this.tag=_,this.containerInfo=y,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=le,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ur(0),this.expirationTimes=Ur(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ur(0),this.identifierPrefix=z,this.onRecoverableError=K,ge&&(this.mutableSourceEagerHydrationData=null)}function qp(y,_,O,z,K,te,ve,ze,ft){return y=new U1(y,_,O,ze,ft),_===1?(_=1,te===!0&&(_|=8)):_=0,te=qi(3,null,null,_),y.current=te,te.stateNode=y,te.memoizedState={element:z,isDehydrated:O,cache:null,transitions:null,pendingSuspenseBoundaries:null},yp(te),y}function Tg(y){if(!y)return wt;y=y._reactInternals;e:{if(j(y)!==y||y.tag!==1)throw Error(i(170));var _=y;do{switch(_.tag){case 3:_=_.stateNode.context;break e;case 1:if(Zr(_.type)){_=_.stateNode.__reactInternalMemoizedMergedChildContext;break e}}_=_.return}while(_!==null);throw Error(i(171))}if(y.tag===1){var O=y.type;if(Zr(O))return Gt(y,O,_)}return _}function Au(y){var _=y._reactInternals;if(_===void 0)throw typeof y.render=="function"?Error(i(188)):(y=Object.keys(y).join(","),Error(i(268,y)));return y=Y(_),y===null?null:y.stateNode}function Eg(y,_){if(y=y.memoizedState,y!==null&&y.dehydrated!==null){var O=y.retryLane;y.retryLane=O!==0&&O<_?O:_}}function Kd(y,_){Eg(y,_),(y=y.alternate)&&Eg(y,_)}function q2(y){return y=Y(y),y===null?null:y.stateNode}function z1(){return null}return r.attemptContinuousHydration=function(y){if(y.tag===13){var _=Oo(y,134217728);if(_!==null){var O=Hn();Aa(_,y,134217728,O)}Kd(y,134217728)}},r.attemptDiscreteHydration=function(y){if(y.tag===13){var _=Oo(y,1);if(_!==null){var O=Hn();Aa(_,y,1,O)}Kd(y,1)}},r.attemptHydrationAtCurrentPriority=function(y){if(y.tag===13){var _=Hs(y),O=Oo(y,_);if(O!==null){var z=Hn();Aa(O,y,_,z)}Kd(y,_)}},r.attemptSynchronousHydration=function(y){switch(y.tag){case 3:var _=y.stateNode;if(_.current.memoizedState.isDehydrated){var O=rt(_.pendingLanes);O!==0&&(Xt(_,O|1),ja(_,Yn()),(Gr&6)===0&&(Tn(),fa()))}break;case 13:Up(function(){var z=Oo(y,1);if(z!==null){var K=Hn();Aa(z,y,1,K)}}),Kd(y,1)}},r.batchedUpdates=function(y,_){var O=Gr;Gr|=1;try{return y(_)}finally{Gr=O,Gr===0&&(Tn(),wd&&fa())}},r.createComponentSelector=function(y){return{$$typeof:Gl,value:y}},r.createContainer=function(y,_,O,z,K,te,ve){return qp(y,_,!1,null,O,z,K,te,ve)},r.createHasPseudoClassSelector=function(y){return{$$typeof:Qa,value:y}},r.createHydrationContainer=function(y,_,O,z,K,te,ve,ze,ft){return y=qp(O,z,!0,y,K,te,ve,ze,ft),y.context=Tg(null),O=y.current,z=Hn(),K=Hs(O),te=$l(z,K),te.callback=_??null,Ul(O,te,K),y.current.lanes=K,nn(y,K,z),ja(y,z),y},r.createPortal=function(y,_,O){var z=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:z==null?null:""+z,children:y,containerInfo:_,implementation:O}},r.createRoleSelector=function(y){return{$$typeof:nl,value:y}},r.createTestNameSelector=function(y){return{$$typeof:Id,value:y}},r.createTextSelector=function(y){return{$$typeof:uh,value:y}},r.deferredUpdates=function(y){var _=It,O=ds.transition;try{return ds.transition=null,It=16,y()}finally{It=_,ds.transition=O}},r.discreteUpdates=function(y,_,O,z,K){var te=It,ve=ds.transition;try{return ds.transition=null,It=1,y(_,O,z,K)}finally{It=te,ds.transition=ve,Gr===0&&Tn()}},r.findAllNodes=il,r.findBoundingRects=function(y,_){if(!vt)throw Error(i(363));_=il(y,_),y=[];for(var O=0;O<_.length;O++)y.push(it(_[O]));for(_=y.length-1;0<_;_--){O=y[_];for(var z=O.x,K=z+O.width,te=O.y,ve=te+O.height,ze=_-1;0<=ze;ze--)if(_!==ze){var ft=y[ze],Ht=ft.x,dr=Ht+ft.width,Br=ft.y,nr=Br+ft.height;if(z>=Ht&&te>=Br&&K<=dr&&ve<=nr){y.splice(_,1);break}else if(z!==Ht||O.width!==ft.width||nr<te||Br>ve){if(!(te!==Br||O.height!==ft.height||dr<z||Ht>K)){Ht>z&&(ft.width+=Ht-z,ft.x=z),dr<K&&(ft.width=K-Ht),y.splice(_,1);break}}else{Br>te&&(ft.height+=Br-te,ft.y=te),nr<ve&&(ft.height=ve-Br),y.splice(_,1);break}}}return y},r.findHostInstance=Au,r.findHostInstanceWithNoPortals=function(y){return y=B(y),y=y!==null?ae(y):null,y===null?null:y.stateNode},r.findHostInstanceWithWarning=function(y){return Au(y)},r.flushControlled=function(y){var _=Gr;Gr|=1;var O=ds.transition,z=It;try{ds.transition=null,It=1,y()}finally{It=z,ds.transition=O,Gr=_,Gr===0&&(Tn(),fa())}},r.flushPassiveEffects=ql,r.flushSync=Up,r.focusWithin=function(y,_){if(!vt)throw Error(i(363));for(y=sl(y),_=al(y,_),_=Array.from(_),y=0;y<_.length;){var O=_[y++];if(!Dt(O)){if(O.tag===5&&Xe(O.stateNode))return!0;for(O=O.child;O!==null;)_.push(O),O=O.sibling}}return!1},r.getCurrentUpdatePriority=function(){return It},r.getFindAllNodesFailureDescription=function(y,_){if(!vt)throw Error(i(363));var O=0,z=[];y=[sl(y),0];for(var K=0;K<y.length;){var te=y[K++],ve=y[K++],ze=_[ve];if((te.tag!==5||!Dt(te))&&(dh(te,ze)&&(z.push(xg(ze)),ve++,ve>O&&(O=ve)),ve<_.length))for(te=te.child;te!==null;)y.push(te,ve),te=te.sibling}if(O<_.length){for(y=[];O<_.length;O++)y.push(xg(_[O]));return`findAllNodes was able to match part of the selector:
  `+(z.join(" > ")+`

No matching component was found for:
  `)+y.join(" > ")}return null},r.getPublicRootInstance=function(y){if(y=y.current,!y.child)return null;switch(y.child.tag){case 5:return ne(y.child.stateNode);default:return y.child.stateNode}},r.injectIntoDevTools=function(y){if(y={bundleType:y.bundleType,version:y.version,rendererPackageName:y.rendererPackageName,rendererConfig:y.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:q2,findFiberByHostInstance:y.findFiberByHostInstance||z1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")y=!1;else{var _=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(_.isDisabled||!_.supportsFiber)y=!0;else{try{mc=_.inject(y),pi=_}catch{}y=!!_.checkDCE}}return y},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(y,_,O,z){if(!vt)throw Error(i(363));y=il(y,_);var K=De(y,O,z).disconnect;return{disconnect:function(){K()}}},r.registerMutableSourceForHydration=function(y,_){var O=_._getVersion;O=O(_._source),y.mutableSourceEagerHydrationData==null?y.mutableSourceEagerHydrationData=[_,O]:y.mutableSourceEagerHydrationData.push(_,O)},r.runWithPriority=function(y,_){var O=It;try{return It=y,_()}finally{It=O}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(y,_,O,z){var K=_.current,te=Hn(),ve=Hs(K);return O=Tg(O),_.context===null?_.context=O:_.pendingContext=O,_=$l(te,ve),_.payload={element:y},z=z===void 0?null:z,z!==null&&(_.callback=z),y=Ul(K,_,ve),y!==null&&(Aa(y,K,ve,te),Qf(y,K,ve)),ve},r}),YS}var pP;function yZ(){return pP||(pP=1,qS.exports=xZ()),qS.exports}var vZ=yZ();const wZ=Ol(vZ);var XS={exports:{}},rf={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xP;function bZ(){return xP||(xP=1,rf.ConcurrentRoot=1,rf.ContinuousEventPriority=4,rf.DefaultEventPriority=16,rf.DiscreteEventPriority=1,rf.IdleEventPriority=536870912,rf.LegacyRoot=0),rf}var yP;function _Z(){return yP||(yP=1,XS.exports=bZ()),XS.exports}var vL=_Z(),SZ=tn();const vP={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let wP=!1,bP=!1;const e4=".react-konva-event";let wL=!1;function kZ(e){wL=e}const CZ=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,TZ=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,EZ={};function B_(e,t,r=EZ){if(!wP&&"zIndex"in t&&(console.warn(TZ),wP=!0),!bP&&t.draggable){var n=t.x!==void 0||t.y!==void 0,s=t.onDragEnd||t.onDragMove;n&&!s&&(console.warn(CZ),bP=!0)}for(var a in r)if(!vP[a]){var i=a.slice(0,2)==="on",o=r[a]!==t[a];if(i&&o){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e.off(c,r[a])}var u=!t.hasOwnProperty(a);u&&e.setAttr(a,void 0)}var d=wL||t._useStrictMode,h={},g=!1;const p={};for(var a in t)if(!vP[a]){var i=a.slice(0,2)==="on",x=r[a]!==t[a];if(i&&x){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),t[a]&&(p[c]=t[a])}!i&&(t[a]!==r[a]||d&&t[a]!==e.getAttr(a))&&(g=!0,h[a]=t[a])}g&&(e.setAttrs(h),Of(e));for(var c in p)e.on(c+e4,p[c])}function Of(e){if(!SZ.Konva.autoDrawEnabled){var t=e.getLayer()||e.getStage();t&&t.batchDraw()}}var QS=fN();const bL={},NZ={};zy.Node.prototype._applyProps=B_;function AZ(e,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}e.add(t),Of(e)}function jZ(e,t,r){let n=zy[e];n||(console.error(`Konva has no node with the type ${e}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${e}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=zy.Group);const s={},a={};for(var i in t){var o=i.slice(0,2)==="on";o?a[i]=t[i]:s[i]=t[i]}const c=new n(s);return B_(c,a),c}function PZ(e,t,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${e}"`)}function FZ(e,t,r){return!1}function OZ(e){return e}function DZ(){return null}function IZ(){return null}function RZ(e,t,r,n){return NZ}function MZ(){}function LZ(e){}function BZ(e,t){return!1}function $Z(){return bL}function UZ(){return bL}const zZ=setTimeout,WZ=clearTimeout,HZ=-1;function GZ(e,t){return!1}const VZ=!1,KZ=!0,qZ=!0;function YZ(e,t){t.parent===e?t.moveToTop():e.add(t),Of(e)}function XZ(e,t){t.parent===e?t.moveToTop():e.add(t),Of(e)}function _L(e,t,r){t._remove(),e.add(t),t.setZIndex(r.getZIndex()),Of(e)}function QZ(e,t,r){_L(e,t,r)}function JZ(e,t){t.destroy(),t.off(e4),Of(e)}function ZZ(e,t){t.destroy(),t.off(e4),Of(e)}function eee(e,t,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function tee(e,t,r){}function ree(e,t,r,n,s){B_(e,s,n)}function nee(e){e.hide(),Of(e)}function see(e){}function aee(e,t){(t.visible==null||t.visible)&&e.show()}function iee(e,t){}function oee(e){}function lee(){}const cee=()=>vL.DefaultEventPriority,uee=Object.freeze(Object.defineProperty({__proto__:null,appendChild:YZ,appendChildToContainer:XZ,appendInitialChild:AZ,cancelTimeout:WZ,clearContainer:oee,commitMount:tee,commitTextUpdate:eee,commitUpdate:ree,createInstance:jZ,createTextInstance:PZ,detachDeletedInstance:lee,finalizeInitialChildren:FZ,getChildHostContext:UZ,getCurrentEventPriority:cee,getPublicInstance:OZ,getRootHostContext:$Z,hideInstance:nee,hideTextInstance:see,idlePriority:QS.unstable_IdlePriority,insertBefore:_L,insertInContainerBefore:QZ,isPrimaryRenderer:VZ,noTimeout:HZ,now:QS.unstable_now,prepareForCommit:DZ,preparePortalMount:IZ,prepareUpdate:RZ,removeChild:JZ,removeChildFromContainer:ZZ,resetAfterCommit:MZ,resetTextContent:LZ,run:QS.unstable_runWithPriority,scheduleTimeout:zZ,shouldDeprioritizeSubtree:BZ,shouldSetTextContent:GZ,supportsMutation:qZ,unhideInstance:aee,unhideTextInstance:iee,warnsIfNotActing:KZ},Symbol.toStringTag,{value:"Module"}));var dee=Object.defineProperty,fee=Object.defineProperties,hee=Object.getOwnPropertyDescriptors,_P=Object.getOwnPropertySymbols,gee=Object.prototype.hasOwnProperty,mee=Object.prototype.propertyIsEnumerable,SP=(e,t,r)=>t in e?dee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,kP=(e,t)=>{for(var r in t||(t={}))gee.call(t,r)&&SP(e,r,t[r]);if(_P)for(var r of _P(t))mee.call(t,r)&&SP(e,r,t[r]);return e},pee=(e,t)=>fee(e,hee(t)),CP,TP;typeof window<"u"&&((CP=window.document)!=null&&CP.createElement||((TP=window.navigator)==null?void 0:TP.product)==="ReactNative")?S.useLayoutEffect:S.useEffect;function SL(e,t,r){if(!e)return;if(r(e)===!0)return e;let n=e.child;for(;n;){const s=SL(n,t,r);if(s)return s;n=n.sibling}}function kL(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const EP=console.error;console.error=function(){const e=[...arguments].join("");if(e?.startsWith("Warning:")&&e.includes("useContext")){console.error=EP;return}return EP.apply(this,arguments)};const t4=kL(S.createContext(null));class CL extends S.Component{render(){return S.createElement(t4.Provider,{value:this._reactInternals},this.props.children)}}function xee(){const e=S.useContext(t4);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=S.useId();return S.useMemo(()=>{for(const n of[e,e?.alternate]){if(!n)continue;const s=SL(n,!1,a=>{let i=a.memoizedState;for(;i;){if(i.memoizedState===t)return!0;i=i.next}});if(s)return s}},[e,t])}function yee(){const e=xee(),[t]=S.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&typeof r.type=="object"){const s=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;s&&s!==t4&&!t.has(s)&&t.set(s,S.useContext(kL(s)))}r=r.return}return t}function TL(){const e=yee();return S.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>S.createElement(t,null,S.createElement(r.Provider,pee(kP({},n),{value:e.get(r)}))),t=>S.createElement(CL,kP({},t))),[e])}function vee(e){const t=Fs.useRef({});return Fs.useLayoutEffect(()=>{t.current=e}),Fs.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const wee=e=>{const t=Fs.useRef(null),r=Fs.useRef(null),n=Fs.useRef(null),s=vee(e),a=TL(),i=o=>{const{forwardedRef:c}=e;c&&(typeof c=="function"?c(o):c.current=o)};return Fs.useLayoutEffect(()=>(r.current=new zy.Stage({width:e.width,height:e.height,container:t.current}),i(r.current),n.current=Jg.createContainer(r.current,vL.LegacyRoot,!1,null),Jg.updateContainer(Fs.createElement(a,{},e.children),n.current),()=>{zy.isBrowser&&(i(null),Jg.updateContainer(null,n.current,null),r.current.destroy())}),[]),Fs.useLayoutEffect(()=>{i(r.current),B_(r.current,e,s),Jg.updateContainer(Fs.createElement(a,{},e.children),n.current,null)}),Fs.createElement("div",{ref:t,id:e.id,accessKey:e.accessKey,className:e.className,role:e.role,style:e.style,tabIndex:e.tabIndex,title:e.title})},Zh="Layer",bee="FastLayer",sc="Group",_ee="Label",Ba="Rect",pf="Circle",See="Ellipse",kee="Wedge",ai="Line",Cee="Sprite",EL="Image",zc="Text",Tee="TextPath",Eee="Star",Nee="Ring",Aee="Arc",jee="Tag",Pee="Path",Fee="RegularPolygon",FT="Arrow",Oee="Shape",NL="Transformer",Dee="18.2.13",Jg=wZ(uee);Jg.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Fs.version,rendererPackageName:"react-konva"});const e0=Fs.forwardRef((e,t)=>Fs.createElement(CL,{},Fs.createElement(wee,{...e,forwardedRef:t}))),Iee=kZ,Ree=Object.freeze(Object.defineProperty({__proto__:null,Arc:Aee,Arrow:FT,Circle:pf,Ellipse:See,FastLayer:bee,Group:sc,Image:EL,KonvaRenderer:Jg,Label:_ee,Layer:Zh,Line:ai,Path:Pee,Rect:Ba,RegularPolygon:Fee,Ring:Nee,Shape:Oee,Sprite:Cee,Stage:e0,Star:Eee,Tag:jee,Text:zc,TextPath:Tee,Transformer:NL,Wedge:kee,useContextBridge:TL,useStrictMode:Iee,version:Dee},Symbol.toStringTag,{value:"Module"})),Nt=({children:e,hover:t=!0,className:r="",paddingClass:n="p-6",...s})=>{const a=`
    bg-white rounded-xl shadow-md border border-gray-200 ${n}
    ${t?"hover:shadow-lg hover:-translate-y-1 transition-all duration-200":""}
    ${r}
  `;return l.jsx(nt.div,{className:a,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},...s,children:e})},Mee=({children:e,className:t=""})=>l.jsx("div",{className:`border-b border-gray-200 pb-4 mb-4 ${t}`,children:e}),Lee=({children:e,className:t=""})=>l.jsx("h3",{className:`text-xl font-semibold text-gray-800 ${t}`,children:e}),Bee=({children:e,className:t=""})=>l.jsx("div",{className:`py-4 ${t}`,children:e}),$ee=({children:e,className:t=""})=>l.jsx("div",{className:`border-t border-gray-200 pt-4 mt-4 ${t}`,children:e});Nt.Header=Mee;Nt.Title=Lee;Nt.Body=Bee;Nt.Footer=$ee;const oa=({isOpen:e=!1,onClose:t,title:r="",children:n,size:s="medium",showCloseButton:a=!0,closeOnBackdropClick:i=!0,className:o="",...c})=>{const u=h=>{i&&h.target===h.currentTarget&&t()};Fs.useEffect(()=>{const h=x=>{x.key==="Escape"&&t()},g=window;g.__modalOpenCount||(g.__modalOpenCount=0);let p;return e&&(document.addEventListener("keydown",h),p=document.body.style.overflow,g.__modalOpenCount===0&&(document.body.style.overflow="hidden"),g.__modalOpenCount+=1),()=>{document.removeEventListener("keydown",h),g.__modalOpenCount&&g.__modalOpenCount>0&&(g.__modalOpenCount-=1),g.__modalOpenCount===0&&(p!==void 0?document.body.style.overflow=p||"":document.body.style.overflow="")}},[e,t]);const d={small:"max-w-md",medium:"max-w-lg",large:"max-w-4xl"};return e?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:u,role:"dialog","aria-modal":"true","aria-label":r,...c,children:l.jsxs("div",{className:`
          bg-white rounded-xl shadow-md border border-gray-200 p-8
          hover:shadow-lg hover:-translate-y-1 transition-all duration-200
          w-full ${d[s]} mx-auto
          ${o}
        `,onClick:h=>h.stopPropagation(),children:[(r||a)&&l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r&&l.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:r}),a&&l.jsx("button",{onClick:t,className:"text-red-500 hover:text-red-700 hover:bg-red-50 transition-all duration-200 rounded-full p-2 text-2xl font-bold leading-none","aria-label":"Close modal",children:""})]}),l.jsx("div",{className:"space-y-6",children:n})]})}):null},Uee=e=>{const[t,r]=S.useState({width:800,height:600}),n=S.useRef(null),s=S.useCallback(()=>{if(e.current){e.current.getBoundingClientRect();const a=Math.min(1200,window.innerWidth*.8),i=Math.min(800,window.innerHeight*.6),o=4/3;let c=a,u=c/o;u>i&&(u=i,c=u*o),r({width:c,height:u})}},[e]);return S.useEffect(()=>(s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)),[s]),{canvasSize:t,stageRef:n,updateCanvasSize:s}},zee=e=>{const[t,r]=S.useState({width:800,height:600}),[n,s]=S.useState({}),a=S.useCallback(()=>{if(e.current){const o=e.current.getBoundingClientRect();r({width:o.width,height:Math.max(400,o.height)})}},[e]),i=S.useCallback(o=>o<480?{stageHeight:300,blockMinSize:50,fontSize:12,padding:10,touchTargetSize:44,arrowThickness:4}:o<768?{stageHeight:400,blockMinSize:60,fontSize:14,padding:15,touchTargetSize:44,arrowThickness:4}:o<1024?{stageHeight:500,blockMinSize:70,fontSize:16,padding:20,touchTargetSize:40,arrowThickness:3}:{stageHeight:600,blockMinSize:80,fontSize:18,padding:25,touchTargetSize:32,arrowThickness:2},[]);return S.useEffect(()=>{const o=i(t.width);s(o)},[t.width,i]),S.useEffect(()=>{a();const o=()=>{a()};return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[a]),{containerSize:t,responsiveSettings:n,updateSize:a}},NP={convertToOriginal:(e,t,r)=>r?{x:Number(((e-r.x)/r.scale).toFixed(4)),y:Number(((t-r.y)/r.scale).toFixed(4))}:{x:e,y:t},convertToCanvas:(e,t,r)=>r?{x:Number((r.x+e*r.scale).toFixed(4)),y:Number((r.y+t*r.scale).toFixed(4))}:{x:e,y:t},isPointInImage:(e,t)=>t?e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height:!1,calculateImageScale:(e,t)=>{if(!e||!t)return 1;const r=40,n=t.width-r,s=t.height-r;return Math.min(n/e.width,s/e.height)},calculateImageInfo:(e,t)=>{if(!e||!t)return null;const r=40,n=t.width-r,s=t.height-r,a=Math.min(n/e.width,s/e.height),i=e.width*a,o=e.height*a,c=(t.width-i)/2,u=(t.height-o)/2;return{x:c,y:u,width:i,height:o,scale:a,originalWidth:e.width,originalHeight:e.height}}},Wee=e=>{const t=S.useCallback((n,s)=>NP.convertToOriginal(n,s,e),[e]),r=S.useCallback((n,s)=>NP.convertToCanvas(n,s,e),[e]);return{convertToOriginal:t,convertToCanvas:r}},Hx={create:(e,t,r,n,s)=>({id:s,x:e-r/2,y:t-n/2,width:Math.max(r,30),height:Math.max(n,10),fill:"rgba(0, 123, 255, 0.15)",stroke:"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),validate:e=>e.width>0&&e.height>0,findAtPosition:(e,t,r)=>e.find(n=>t>=n.x&&t<=n.x+n.width&&r>=n.y&&r<=n.y+n.height),generateId:()=>`block_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},$g={create:(e,t,r,n,s,a,i)=>({id:i,startX:e,startY:t,endX:r,endY:n,startBlock:s,endBlock:a,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,pointerLength:10,pointerWidth:10}),snapToNearestBlock:(e,t,r,n=60)=>{let s=null,a=1/0;for(const i of r){const o=i.x+i.width/2,c=i.y+i.height/2,u=Math.sqrt(Math.pow(e-o,2)+Math.pow(t-c,2));u<=n&&u<a&&(a=u,s=i)}return s?{x:s.x+s.width/2,y:s.y+s.height/2,blockId:s.id,block:s,distance:a}:null},validate:(e,t,r,n,s)=>$g.snapToNearestBlock(e,t,s)!==null,generateId:()=>`arrow_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},JS={create:(e,t,r)=>({id:r,blockId:e,word:t}),update:(e,t,r)=>e.map(n=>n.blockId===t?{...n,word:r}:n),delete:(e,t)=>e.filter(r=>r.blockId!==t),generateId:e=>`word_${e}`,validate:e=>e&&e.trim().length>0},Hee=async e=>{const t=[];if(e.size>512e3){const n=(e.size/1024).toFixed(1);t.push(`Image is too large (${n}KB). Maximum allowed size is 500KB. Please compress or resize your image.`)}return new Promise(n=>{const s=new Image;s.onload=()=>{(s.width>4e3||s.height>4e3)&&t.push(`Image is too large (${s.width}x${s.height} pixels). Maximum allowed dimensions are 4000x4000 pixels. Please resize your image.`),n({valid:t.length===0,errors:t,dimensions:{width:s.width,height:s.height}})},s.onerror=()=>{t.push("Invalid image file"),n({valid:!1,errors:t})},s.src=URL.createObjectURL(e)})},Gee=(e,t=500)=>new Promise(r=>{const n=document.createElement("canvas"),s=n.getContext("2d"),a=new Image;a.onload=()=>{let{width:i,height:o}=a;const c=2e3;if(i>c||o>c){const h=Math.min(c/i,c/o);i*=h,o*=h}n.width=i,n.height=o,s.drawImage(a,0,0,i,o);let u=.8;const d=()=>{n.toBlob(h=>{h.size<=t*1024||u<=.1?r(h):(u-=.1,d())},"image/jpeg",u)};d()},a.onerror=()=>{r(e)},a.src=URL.createObjectURL(e)}),Vee=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=s=>t(s.target.result),n.onerror=s=>r(s),n.readAsDataURL(e)}),Kee=()=>{const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);return{blockMinSize:e?60:40,arrowThickness:e?4:2,touchTargetSize:e?44:32,doubleTapDelay:e?300:200,isMobile:e}},qee={testData:{blocks:[],words:[],arrows:[],imageUrl:null},canvas:{size:{width:800,height:600},image:null,imageInfo:null,selectedTool:"edit"},creation:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null},ui:{selectedBlock:null,showWordPanel:!1,isLoading:!1,error:null,showImageSizeModal:!1,imageSizeError:null}},Yee=(e,t)=>{switch(t.type){case"SET_CANVAS_SIZE":return{...e,canvas:{...e.canvas,size:t.payload}};case"SET_IMAGE":return{...e,canvas:{...e.canvas,image:t.payload}};case"SET_IMAGE_INFO":return{...e,canvas:{...e.canvas,imageInfo:t.payload}};case"SET_SELECTED_TOOL":return{...e,canvas:{...e.canvas,selectedTool:t.payload}};case"ADD_BLOCK":return{...e,testData:{...e.testData,blocks:[...e.testData.blocks,t.payload]}};case"ADD_WORD":return{...e,testData:{...e.testData,words:[...e.testData.words,t.payload]}};case"ADD_ARROW":return{...e,testData:{...e.testData,arrows:[...e.testData.arrows,t.payload]}};case"UPDATE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.map(r=>r.id===t.payload.id?{...r,...t.payload.updates}:r)}};case"DELETE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.filter(r=>r.id!==t.payload),words:e.testData.words.filter(r=>r.blockId!==t.payload),arrows:e.testData.arrows.filter(r=>r.startBlock!==t.payload&&r.endBlock!==t.payload)}};case"UPDATE_WORDS":return{...e,testData:{...e.testData,words:t.payload}};case"SET_CREATION_STATE":return{...e,creation:{...e.creation,...t.payload}};case"SET_UI_STATE":return{...e,ui:{...e.ui,...t.payload}};case"SET_LOADING":return{...e,ui:{...e.ui,isLoading:t.payload}};case"SET_ERROR":return{...e,ui:{...e.ui,error:t.payload}};case"SHOW_IMAGE_SIZE_MODAL":return{...e,ui:{...e.ui,showImageSizeModal:!0,imageSizeError:t.payload}};case"HIDE_IMAGE_SIZE_MODAL":return{...e,ui:{...e.ui,showImageSizeModal:!1,imageSizeError:null}};case"RESET_TESTDATA":return{...e,testData:{blocks:[],words:[],arrows:[],imageUrl:e.testData.imageUrl}};default:return e}},Xee=({testName:e="",showQuestionCount:t=!0,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const[o,c]=S.useReducer(Yee,qee),{showNotification:u}=za(),{makeAuthenticatedRequest:d}=Qo(),{user:h}=cs(),g=S.useRef(null),p=S.useRef(null),x=S.useRef(null),v=S.useRef({}),w=S.useRef({}),{canvasSize:C,stageRef:k}=Uee(g),{containerSize:b,responsiveSettings:N}=zee(g),[E,P]=S.useState(null);S.useEffect(()=>{if(!o.canvas.image||!g.current)return;const W=g.current?.clientWidth||800,R=g.current?.clientHeight||600,U=W/o.canvas.image.width,q=R/o.canvas.image.height,Q=Math.min(U,q,1),se=o.canvas.image.width*Q,X=o.canvas.image.height*Q,ie=(W-se)/2,le=(R-X)/2;P({x:ie,y:le,width:se,height:X,scaleX:Q,scaleY:Q,scale:Q,image:o.canvas.image})},[o.canvas.image,g.current?.clientWidth,g.current?.clientHeight]);const{convertToOriginal:F}=Wee(E);S.useEffect(()=>{c({type:"SET_CANVAS_SIZE",payload:C})},[C]),S.useEffect(()=>{E&&c({type:"SET_IMAGE_INFO",payload:E})},[E]),S.useEffect(()=>{const W=x.current;if(!W)return;const R=o.ui.selectedBlock?.id?v.current[o.ui.selectedBlock.id]:null;R?(W.nodes([R]),W.getLayer()?.batchDraw()):(W.nodes([]),W.getLayer()?.batchDraw())},[o.ui.selectedBlock]);const A=S.useCallback(()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:null}}),c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null}}),c({type:"RESET_TESTDATA"}),c({type:"SET_ERROR",payload:null})},[]),j=S.useCallback(async W=>{const R=W.target.files[0];if(!R){u("Please select a file","error");return}try{c({type:"SET_LOADING",payload:!0});const U=await Hee(R);if(!U.valid){c({type:"SHOW_IMAGE_SIZE_MODAL",payload:{errors:U.errors,fileSize:(R.size/1024).toFixed(1),dimensions:U.dimensions}});return}let q=R;if(R.size>500*1024){u("Image is large, compressing to meet size requirements...","info");try{q=await Gee(R,500);const X=(R.size/1024).toFixed(1),ie=(q.size/1024).toFixed(1);u(`Image compressed from ${X}KB to ${ie}KB`,"success")}catch{u("Failed to compress image. Please try a smaller image.","error");return}}const Q=await Vee(q),se=new Image;se.crossOrigin="anonymous",se.onload=()=>{c({type:"SET_IMAGE",payload:se}),c({type:"SET_UI_STATE",payload:{imageUrl:Q}}),u("Image uploaded successfully!","success")},se.onerror=()=>{u("Failed to load image","error")},se.src=Q}catch(U){console.error("Image upload error:",U),u("Error processing image","error")}finally{c({type:"SET_LOADING",payload:!1})}},[u]),I=S.useCallback(W=>{const R=k.current;if(!R)return;const U=R.getPointerPosition();if(U){if(o.canvas.selectedTool==="create"){const q=Hx.findAtPosition(o.testData.blocks,U.x,U.y);if(q){c({type:"SET_UI_STATE",payload:{selectedBlock:q}});return}c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!0,blockCreationStart:{x:U.x,y:U.y}}})}else if(o.canvas.selectedTool==="edit"){const q=Hx.findAtPosition(o.testData.blocks,U.x,U.y);c(q?{type:"SET_UI_STATE",payload:{selectedBlock:q}}:{type:"SET_UI_STATE",payload:{selectedBlock:null}})}else if(o.canvas.selectedTool==="arrow"){const q=W.target===R,Q=Hx.findAtPosition(o.testData.blocks,U.x,U.y);(q||!Q)&&c({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!0,arrowStart:{x:U.x,y:U.y}}})}}},[o.canvas.selectedTool,E,o.testData.blocks]),B=S.useCallback(W=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const R=k.current;if(!R)return;const U=R.getPointerPosition();if(!U)return;const q=Math.abs(U.x-o.creation.blockCreationStart.x),Q=Math.abs(U.y-o.creation.blockCreationStart.y),se=10,X=Math.max(q,se),ie=Math.max(Q,se);c({type:"SET_CREATION_STATE",payload:{previewBlock:{x:Math.min(U.x,o.creation.blockCreationStart.x),y:Math.min(U.y,o.creation.blockCreationStart.y),width:X,height:ie,fill:"rgba(0, 123, 255, 0.3)",stroke:"#007bff",strokeWidth:2,dash:[5,5],opacity:.7}}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const R=k.current;if(!R)return;const U=R.getPointerPosition();if(!U)return;c({type:"SET_CREATION_STATE",payload:{previewArrow:{startX:o.creation.arrowStart.x,startY:o.creation.arrowStart.y,endX:U.x,endY:U.y,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,dash:[5,5],opacity:.7}}})}},[o.creation]),Y=S.useCallback(W=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const R=k.current;if(!R)return;const U=R.getPointerPosition();if(!U)return;const q=Math.abs(U.x-o.creation.blockCreationStart.x),Q=Math.abs(U.y-o.creation.blockCreationStart.y),se=10,X=Math.max(q,se),ie=Math.max(Q,se),le=Math.min(U.x,o.creation.blockCreationStart.x)+X/2,ce=Math.min(U.y,o.creation.blockCreationStart.y)+ie/2,Se=Hx.generateId(),re=Hx.create(le,ce,X,ie,Se),ge=JS.create(Se,`Word ${o.testData.blocks.length+1}`,JS.generateId(Se));c({type:"ADD_BLOCK",payload:re}),c({type:"ADD_WORD",payload:ge}),c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,blockCreationStart:null,previewBlock:null}}),o.testData.blocks.length===0&&c({type:"SET_UI_STATE",payload:{showWordPanel:!0}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const R=k.current;if(!R)return;const U=R.getPointerPosition();if(!U)return;if($g.validate(o.creation.arrowStart.x,o.creation.arrowStart.y,U.x,U.y,o.testData.blocks)){const q=$g.snapToNearestBlock(o.creation.arrowStart.x,o.creation.arrowStart.y,o.testData.blocks),Q=$g.snapToNearestBlock(U.x,U.y,o.testData.blocks),se=q?q.x:o.creation.arrowStart.x,X=q?q.y:o.creation.arrowStart.y,ie=Q?Q.x:U.x,le=Q?Q.y:U.y,ce=$g.generateId(),Se=Kee(),re=$g.create(se,X,ie,le,q?q.blockId:null,Q?Q.blockId:null,ce,{strokeWidth:Se.arrowThickness,isMobile:Se.isMobile});c({type:"ADD_ARROW",payload:re}),u("Arrow created successfully!","success")}else u("Arrow must start near a block!","error");c({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!1,arrowStart:null,previewArrow:null}})}},[o.creation,o.testData.blocks,u]),Z=S.useCallback(W=>{W.evt.preventDefault(),I(W)},[I]),ae=S.useCallback(W=>{W.evt.preventDefault(),B(W)},[B]),ee=S.useCallback(W=>{W.evt.preventDefault(),Y(W)},[Y]),ne=S.useCallback(async()=>{console.log(" [MatchingTestCreator] handleSaveTest clicked");const W=L();if(Object.keys(W).length>0){console.warn(" [MatchingTestCreator] Validation errors:",W),u("Please fix validation errors before saving","error");return}try{console.log(" [MatchingTestCreator] Preparing data to save...",{blocks:o.testData.blocks.length,words:o.testData.words.length,arrows:o.testData.arrows.length,imageUrl:o.ui.imageUrl?"present":"missing"}),c({type:"SET_LOADING",payload:!0});let R=o.ui.imageUrl;if(o.ui.imageUrl&&o.ui.imageUrl.startsWith("data:")){const q=await d("/.netlify/functions/upload-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataUrl:o.ui.imageUrl,folder:"matching_tests"})}),Q=await q.json();if(q.ok&&Q.success&&Q.url)R=Q.url;else throw new Error(Q.message||"Upload failed")}const U=o.testData.blocks.map((q,Q)=>{let se;if(E){const le=F(q.x,q.y),ce=F(q.x+q.width,q.y+q.height);se={x:le.x,y:le.y,width:Number((ce.x-le.x).toFixed(4)),height:Number((ce.y-le.y).toFixed(4))}}else se={x:Number(q.x.toFixed(4)),y:Number(q.y.toFixed(4)),width:Number(q.width.toFixed(4)),height:Number(q.height.toFixed(4))};const X=o.testData.words.find(le=>le.blockId===q.id),ie=o.testData.arrows.find(le=>le.startBlock===q.id);return{question_id:Q+1,word:X?.word||`Word ${Q+1}`,block_coordinates:se,has_arrow:!!ie,arrow:ie&&E?(()=>{const le=F(ie.startX,ie.startY),ce=F(ie.endX,ie.endY),Se=le.x/E.originalWidth*100,re=le.y/E.originalHeight*100,ge=ce.x/E.originalWidth*100,Ee=ce.y/E.originalHeight*100;return{start_x:Number(le.x.toFixed(4)),start_y:Number(le.y.toFixed(4)),end_x:Number(ce.x.toFixed(4)),end_y:Number(ce.y.toFixed(4)),rel_start_x:Number(Se.toFixed(4)),rel_start_y:Number(re.toFixed(4)),rel_end_x:Number(ge.toFixed(4)),rel_end_y:Number(Ee.toFixed(4)),image_width:E.originalWidth,image_height:E.originalHeight,style:ie.style||{color:"#dc3545",thickness:3}}})():null}});r&&(console.log(" [MatchingTestCreator] Calling onTestSaved with processed data"),r({success:!0,message:"Test data prepared for assignment",blocks:o.testData.blocks,words:o.testData.words,arrows:o.testData.arrows,imageUrl:R,processedQuestions:U}))}catch(R){console.error("Save error:",R),u(`Error saving test: ${R.message}`,"error")}finally{c({type:"SET_LOADING",payload:!1})}},[o.testData,o.ui.imageUrl,E,F,d,r,u,e,h]),L=S.useCallback(()=>{const W={};return e.trim()||(W.testName="Test name is required"),o.testData.blocks.length===0&&(W.blocks="At least one block is required"),W},[e,o.testData.blocks.length]),H=()=>l.jsxs("div",{className:"flex flex-wrap gap-2 p-4 bg-gray-50 border-b",children:[l.jsx(Ye,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"create"}),variant:o.canvas.selectedTool==="create"?"primary":"secondary",size:"sm",children:" Create Blocks"}),l.jsx(Ye,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"edit"}),variant:o.canvas.selectedTool==="edit"?"primary":"secondary",size:"sm",children:" Edit Blocks"}),l.jsx(Ye,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"arrow"}),variant:o.canvas.selectedTool==="arrow"?"primary":"secondary",size:"sm",children:" Draw Arrows"}),l.jsx(Ye,{onClick:A,variant:"secondary",size:"sm",children:" Reset"}),l.jsx(Ye,{onClick:()=>p.current?.click(),variant:"secondary",size:"sm",children:" Upload Image"}),l.jsx("div",{className:"text-xs text-gray-500 text-center col-span-full",children:"Max size: 500KB  Max dimensions: 4000x4000px"})]}),M=()=>l.jsx(e0,{width:b.width,height:N.stageHeight,ref:k,onMouseDown:I,onMouseMove:B,onMouseUp:Y,onTouchStart:Z,onTouchMove:ae,onTouchEnd:ee,className:o.canvas.selectedTool==="arrow"||o.canvas.selectedTool==="create"?"cursor-crosshair":"cursor-default",children:l.jsxs(Zh,{children:[o.canvas.image&&E&&l.jsx(EL,{image:o.canvas.image,x:E.x,y:E.y,width:E.width,height:E.height}),o.testData.blocks.map(W=>l.jsxs(sc,{ref:R=>{R&&(w.current[W.id]=R)},draggable:o.canvas.selectedTool==="edit",x:W.x,y:W.y,onMouseEnter:R=>{const U=R.target.getStage()?.container();U&&(U.style.cursor=o.ui.selectedBlock?.id===W.id?"nwse-resize":"move")},onMouseLeave:R=>{const U=R.target.getStage()?.container();U&&(U.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onDragStart:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:W}})},onDragEnd:R=>{const{x:U,y:q}=R.target.position();c({type:"UPDATE_BLOCK",payload:{id:W.id,updates:{x:U,y:q}}})},onClick:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:W}})},onTap:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:W}})},children:[l.jsx(Ba,{ref:R=>{R&&(v.current[W.id]=R)},width:W.width,height:W.height,fill:W.fill,stroke:W.stroke,strokeWidth:W.strokeWidth,cornerRadius:W.cornerRadius,shadowColor:W.shadowColor,shadowBlur:W.shadowBlur,shadowOffset:W.shadowOffset,shadowOpacity:W.shadowOpacity,draggable:o.canvas.selectedTool==="edit",onDragEnd:R=>{const{x:U,y:q}=R.target.getParent().position();c({type:"UPDATE_BLOCK",payload:{id:W.id,updates:{x:U,y:q}}})},onMouseEnter:R=>{const U=R.target.getStage()?.container();U&&(U.style.cursor=o.ui.selectedBlock?.id===W.id?"nwse-resize":"move")},onMouseLeave:R=>{const U=R.target.getStage()?.container();U&&(U.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onTransformEnd:R=>{const U=v.current[W.id];if(!U)return;const q=Math.max(10,U.width()*U.scaleX()),Q=Math.max(10,U.height()*U.scaleY());U.scaleX(1),U.scaleY(1),c({type:"UPDATE_BLOCK",payload:{id:W.id,updates:{width:q,height:Q}}})}}),l.jsx(zc,{x:2,y:2,text:`${o.testData.blocks.indexOf(W)+1}`,fontSize:Math.min(N.fontSize,Math.max(8,W.width/4)),fontFamily:"Arial",fill:"#333",fontStyle:"bold",listening:!1})]},W.id)),l.jsx(NL,{ref:x,rotateEnabled:!1,flipEnabled:!1,boundBoxFunc:(W,R)=>({...R,width:Math.max(R.width,10),height:Math.max(R.height,10)})}),o.testData.arrows.map(W=>l.jsx(FT,{points:[W.startX,W.startY,W.endX,W.endY],stroke:W.stroke,fill:W.fill,strokeWidth:W.strokeWidth||N.arrowThickness,pointerLength:W.pointerLength,pointerWidth:W.pointerWidth},W.id)),o.creation.previewBlock&&l.jsx(Ba,{x:o.creation.previewBlock.x,y:o.creation.previewBlock.y,width:o.creation.previewBlock.width,height:o.creation.previewBlock.height,fill:o.creation.previewBlock.fill,stroke:o.creation.previewBlock.stroke,strokeWidth:o.creation.previewBlock.strokeWidth,dash:o.creation.previewBlock.dash,opacity:o.creation.previewBlock.opacity}),o.creation.previewArrow&&l.jsx(FT,{points:[o.creation.previewArrow.startX,o.creation.previewArrow.startY,o.creation.previewArrow.endX,o.creation.previewArrow.endY],stroke:o.creation.previewArrow.stroke,fill:o.creation.previewArrow.fill,strokeWidth:o.creation.previewArrow.strokeWidth,dash:o.creation.previewArrow.dash,opacity:o.creation.previewArrow.opacity})]})}),V=S.useMemo(()=>o.testData.blocks.length===0?null:l.jsxs("div",{className:"word-panel bg-gray-50 border-t border-gray-200 p-4 w-full",style:{height:"min(400px, 40vh)",overflowY:"auto"},children:[l.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Words (Auto-created with blocks)"}),l.jsx("div",{className:"space-y-2",children:o.testData.words.map(W=>{const R=o.testData.blocks.find(U=>U.id===W.blockId);return l.jsxs("div",{className:"p-2 bg-white rounded border",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:["Block ",o.testData.blocks.indexOf(R)+1]}),l.jsx("button",{onClick:()=>c({type:"DELETE_BLOCK",payload:R.id}),className:"text-red-500 hover:text-red-700 text-xs",children:""})]}),l.jsx("input",{type:"text",value:W.word,onChange:U=>{const q=JS.update(o.testData.words,W.blockId,U.target.value);c({type:"UPDATE_WORDS",payload:q})},className:"w-full text-sm px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Enter word text"})]},W.blockId)})})]}),[o.testData.words,o.testData.blocks]);return l.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex flex-col h-screen bg-gray-100",children:[l.jsx("div",{className:"bg-white shadow-sm border-b p-4",children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsx("div",{children:l.jsx("div",{className:"mt-2 text-sm text-gray-600",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{children:[l.jsx("strong",{children:"Test Name:"})," ",e||"Untitled Test"]}),l.jsxs("span",{children:[l.jsx("strong",{children:"Questions:"})," ",o.testData.blocks.length," (auto-generated from blocks)"]})]})})})})}),H(),l.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[l.jsx("div",{ref:g,className:"bg-white border overflow-auto",style:{minHeight:`${N.stageHeight}px`,maxHeight:"calc(100vh - 200px)",height:"auto",padding:`${N.padding}px`},children:M()}),V]}),l.jsx("div",{className:"bg-white border-t p-4",children:l.jsx("div",{className:"flex justify-center",children:l.jsx(Ye,{onClick:ne,disabled:a||o.ui.isLoading,variant:"primary",size:"lg",children:a||o.ui.isLoading?l.jsx(zr,{size:"sm"}):"Save Test"})})}),l.jsx("input",{ref:p,type:"file",accept:"image/*,application/pdf",onChange:j,className:"hidden"}),l.jsx(oa,{isOpen:o.ui.showImageSizeModal,onClose:()=>c({type:"HIDE_IMAGE_SIZE_MODAL"}),title:" Image Too Large",size:"medium",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("span",{className:"text-red-600 text-2xl mr-2",children:""}),l.jsx("h4",{className:"text-lg font-semibold text-red-800",children:"Image Size Issues"})]}),l.jsx("div",{className:"text-red-700",children:o.ui.imageSizeError?.errors.map((W,R)=>l.jsxs("div",{className:"mb-2",children:[" ",W]},R))})]}),l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[l.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:" Current Image Details:"}),l.jsxs("div",{className:"text-blue-700 space-y-1",children:[l.jsxs("div",{children:[" File size: ",o.ui.imageSizeError?.fileSize,"KB"]}),o.ui.imageSizeError?.dimensions&&l.jsxs("div",{children:[" Dimensions: ",o.ui.imageSizeError.dimensions.width,"  ",o.ui.imageSizeError.dimensions.height," pixels"]})]})]}),l.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[l.jsx("h5",{className:"font-semibold text-green-800 mb-2",children:" Requirements:"}),l.jsxs("div",{className:"text-green-700 space-y-1",children:[l.jsx("div",{children:" Maximum file size: 500KB"}),l.jsx("div",{children:" Maximum dimensions: 4000  4000 pixels"}),l.jsx("div",{children:" Supported formats: All image formats (JPEG, PNG, WebP, etc.)"})]})]}),l.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[l.jsx("h5",{className:"font-semibold text-yellow-800 mb-2",children:" How to Fix:"}),l.jsxs("div",{className:"text-yellow-700 space-y-1",children:[l.jsx("div",{children:" Use an image editor to resize your image"}),l.jsx("div",{children:" Compress the image using online tools"}),l.jsx("div",{children:" Try a different image with smaller dimensions"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx(Ye,{onClick:()=>c({type:"HIDE_IMAGE_SIZE_MODAL"}),variant:"secondary",children:"Close"}),l.jsx(Ye,{onClick:()=>{c({type:"HIDE_IMAGE_SIZE_MODAL"}),p.current?.click()},variant:"primary",children:"Try Another Image"})]})]})})]})},$m=S.createContext(null);function Qee(e,t){return{getTheme:function(){return t??null}}}function tu(){const e=S.useContext($m);return e==null&&(function(t,...r){const n=new URL("https://lexical.dev/docs/error"),s=new URLSearchParams;s.append("code",t);for(const a of r)s.append("v",a);throw n.search=s.toString(),Error(`Minified Lexical error #${t}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(8),e}function $t(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const hc=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Jee=hc&&"documentMode"in document?document.documentMode:null,Uc=hc&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),t0=hc&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),mb=!(!hc||!("InputEvent"in window)||Jee)&&"getTargetRanges"in new window.InputEvent("input"),Wy=hc&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),vm=hc&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,Zee=hc&&/Android/.test(navigator.userAgent),AL=hc&&/^(?=.*Chrome).*/i.test(navigator.userAgent),AP=hc&&Zee&&AL,pb=hc&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!AL;function jL(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}const ete=1,tte=3,rte=9,nte=11,r0=0,PL=1,wm=2,ste=0,ate=1,ite=2,xb=4,yb=8,r4=128,ote=1792|(112|(3|xb|yb)|r4),n4=1,s4=2,a4=3,i4=4,o4=5,l4=6,$_=Wy||vm||pb?"":"",ed=`

`,lte=t0?"":$_,n0={bold:1,capitalize:1024,code:16,highlight:r4,italic:2,lowercase:256,strikethrough:xb,subscript:32,superscript:64,underline:yb,uppercase:512},cte={directionless:1,unmergeable:2},jP={center:s4,end:l4,justify:i4,left:n4,right:a4,start:o4},ute={[s4]:"center",[l4]:"end",[i4]:"justify",[n4]:"left",[a4]:"right",[o4]:"start"},dte={normal:0,segmented:2,token:1},fte={[ste]:"normal",[ite]:"segmented",[ate]:"token"},PP="$config";function FL(e,t,r,n,s,a){let i=e.getFirstChild();for(;i!==null;){const o=i.__key;i.__parent===t&&(bt(i)&&FL(i,o,r,n,s,a),r.has(o)||a.delete(o),s.push(o)),i=i.getNextSibling()}}const hte=100;let OT=!1,c4=0;function gte(e){c4=e.timeStamp}function ZS(e,t,r){const n=e.nodeName==="BR",s=t.__lexicalLineBreak;return s&&(e===s||n&&e.previousSibling===s)||n&&X_(e,r)!==void 0}function mte(e,t,r){const n=dc(El(r));let s=null,a=null;n!==null&&n.anchorNode===e&&(s=n.anchorOffset,a=n.focusOffset);const i=e.nodeValue;i!==null&&A4(t,i,s,a,!1)}function pte(e,t,r){if(Ot(e)){const n=e.anchor.getNode();if(n.is(r)&&e.format!==n.getFormat())return!1}return ld(t)&&r.isAttached()}function xte(e,t,r,n){for(let s=e;s&&!xre(s);s=Iv(s)){const a=X_(s,t);if(a!==void 0){const i=la(a,r);if(i)return vn(i)||!as(s)?void 0:[s,i]}else if(s===n)return[n,N9(r)]}}function OL(e,t,r){OT=!0;const n=performance.now()-c4>hte;try{$o(e,(()=>{const s=Zt()||(function(g){return g.getEditorState().read((()=>{const p=Zt();return p!==null?p.clone():null}))})(e),a=new Map,i=e.getRootElement(),o=e._editorState,c=e._blockCursorElement;let u=!1,d="";for(let g=0;g<t.length;g++){const p=t[g],x=p.type,v=p.target,w=xte(v,e,o,i);if(!w)continue;const[C,k]=w;if(x==="characterData")n&&er(k)&&ld(v)&&pte(s,v,k)&&mte(v,k,e);else if(x==="childList"){u=!0;const b=p.addedNodes;for(let P=0;P<b.length;P++){const F=b[P],A=T9(F),j=F.parentNode;if(j!=null&&F!==c&&A===null&&!ZS(F,j,e)){if(t0){const I=(as(F)?F.innerText:null)||F.nodeValue;I&&(d+=I)}j.removeChild(F)}}const N=p.removedNodes,E=N.length;if(E>0){let P=0;for(let F=0;F<E;F++){const A=N[F];(ZS(A,v,e)||c===A)&&(v.appendChild(A),P++)}E!==P&&a.set(C,k)}}}if(a.size>0)for(const[g,p]of a)p.reconcileObservedMutation(g,e);const h=r.takeRecords();if(h.length>0){for(let g=0;g<h.length;g++){const p=h[g],x=p.addedNodes,v=p.target;for(let w=0;w<x.length;w++){const C=x[w],k=C.parentNode;k==null||C.nodeName!=="BR"||ZS(C,v,e)||k.removeChild(C)}}r.takeRecords()}s!==null&&(u&&hi(s),t0&&F9(e)&&s.insertRawText(d))}))}finally{OT=!1}}function DL(e){const t=e._observer;t!==null&&OL(e,t.takeRecords(),t)}function IL(e){(function(t){c4===0&&El(t).addEventListener("textInput",gte,!0)})(e),e._observer=new MutationObserver(((t,r)=>{OL(e,t,r)}))}function yte(e){const t=new Map,r=new Set;for(let n=typeof e=="function"?e:e.replace;n.prototype&&n.prototype.getType!==void 0;n=Object.getPrototypeOf(n)){const{ownNodeConfig:s}=D4(n);if(s&&s.stateConfigs)for(const a of s.stateConfigs){let i;"stateConfig"in a?(i=a.stateConfig,a.flat&&r.add(i.key)):i=a,t.set(i.key,i)}}return{flatKeys:r,sharedConfigMap:t}}let vte=class RL{constructor(t,r,n=void 0,s=new Map,a=void 0){this.node=t,this.sharedNodeState=r,this.unknownState=n,this.knownState=s;const{sharedConfigMap:i}=this.sharedNodeState,o=a!==void 0?a:(function(c,u,d){let h=d.size;if(u)for(const g in u){const p=c.get(g);p&&d.has(p)||h++}return h})(i,n,s);this.size=o}getValue(t){const r=this.knownState.get(t);if(r!==void 0)return r;this.sharedNodeState.sharedConfigMap.set(t.key,t);let n=t.defaultValue;if(this.unknownState&&t.key in this.unknownState){const s=this.unknownState[t.key];s!==void 0&&(n=t.parse(s)),this.updateFromKnown(t,n)}return n}getInternalState(){return[this.unknownState,this.knownState]}toJSON(){const t={...this.unknownState},r={};for(const[n,s]of this.knownState)n.isEqual(s,n.defaultValue)?delete t[n.key]:t[n.key]=n.unparse(s);for(const n of this.sharedNodeState.flatKeys)n in t&&(r[n]=t[n],delete t[n]);return FP(t)&&(r.$=t),r}getWritable(t){if(this.node===t)return this;const{sharedNodeState:r,unknownState:n}=this,s=new Map(this.knownState);return new RL(t,r,(function(a,i,o){let c;if(o)for(const[u,d]of Object.entries(o)){const h=a.get(u);h?i.has(h)||i.set(h,h.parse(d)):(c=c||{},c[u]=d)}return c})(r.sharedConfigMap,s,n),s,this.size)}updateFromKnown(t,r){const n=t.key;this.sharedNodeState.sharedConfigMap.set(n,t);const{knownState:s,unknownState:a}=this;s.has(t)||a&&n in a||(a&&(delete a[n],this.unknownState=FP(a)),this.size++),s.set(t,r)}updateFromUnknown(t,r){const n=this.sharedNodeState.sharedConfigMap.get(t);n?this.updateFromKnown(n,n.parse(r)):(this.unknownState=this.unknownState||{},t in this.unknownState||this.size++,this.unknownState[t]=r)}updateFromJSON(t){const{knownState:r}=this;for(const n of r.keys())r.set(n,n.defaultValue);if(this.size=r.size,this.unknownState=void 0,t)for(const[n,s]of Object.entries(t))this.updateFromUnknown(n,s)}};function wte(e){const t=e.getWritable(),r=t.__state?t.__state.getWritable(t):new vte(t,ML(t));return t.__state=r,r}function ML(e){return e.__state?e.__state.sharedNodeState:S9(Rv(),e.getType()).sharedNodeState}function FP(e){if(e)for(const t in e)return e}function OP(e,t,r){for(const[n,s]of t.knownState){if(e.has(n.key))continue;e.add(n.key);const a=r?r.getValue(n):n.defaultValue;if(a!==s&&!n.isEqual(a,s))return!0}return!1}function DP(e,t,r){const{unknownState:n}=t,s=r?r.unknownState:void 0;if(n){for(const[a,i]of Object.entries(n))if(!e.has(a)&&(e.add(a),i!==(s?s[a]:void 0)))return!0}return!1}function IP(e,t){const r=e.__state;return r&&r.node===e?r.getWritable(t):r}function RP(e,t){const r=e.__mode,n=e.__format,s=e.__style,a=t.__mode,i=t.__format,o=t.__style,c=e.__state,u=t.__state;return(r===null||r===a)&&(n===null||n===i)&&(s===null||s===o)&&(e.__state===null||c===u||(function(d,h){if(d===h)return!0;if(d&&h&&d.size!==h.size)return!1;const g=new Set;return!(d&&OP(g,d,h)||h&&OP(g,h,d)||d&&DP(g,d,h)||h&&DP(g,h,d))})(c,u))}function MP(e,t){const r=e.mergeWithSibling(t),n=Ss()._normalizedNodes;return n.add(e.__key),n.add(t.__key),r}function LP(e){let t,r,n=e;if(n.__text!==""||!n.isSimpleText()||n.isUnmergeable()){for(;(t=n.getPreviousSibling())!==null&&er(t)&&t.isSimpleText()&&!t.isUnmergeable();){if(t.__text!==""){if(RP(t,n)){n=MP(t,n);break}break}t.remove()}for(;(r=n.getNextSibling())!==null&&er(r)&&r.isSimpleText()&&!r.isUnmergeable();){if(r.__text!==""){if(RP(n,r)){n=MP(n,r);break}break}r.remove()}}else n.remove()}function vb(e){return BP(e.anchor),BP(e.focus),e}function BP(e){for(;e.type==="element";){const t=e.getNode(),r=e.offset;let n,s;if(r===t.getChildrenSize()?(n=t.getChildAtIndex(r-1),s=!0):(n=t.getChildAtIndex(r),s=!1),er(n)){e.set(n.__key,s?n.getTextContentSize():0,"text",!0);break}if(!bt(n))break;e.set(n.__key,s?n.getChildrenSize():0,"element",!0)}}let s0,Fi,Hy,U_,DT,IT,a0,oc,RT,Gy,va="",Bc=null,$c="",Mu="",Ug=!1,wb=!1;function bb(e,t){const r=a0.get(e);if(t!==null){const n=$T(e);n.parentNode===t&&t.removeChild(n)}if(oc.has(e)||Fi._keyToDOMMap.delete(e),bt(r)){const n=Sb(r,a0);MT(n,0,n.length-1,null)}r!==void 0&&j4(Gy,Hy,U_,r,"destroyed")}function MT(e,t,r,n){let s=t;for(;s<=r;++s){const a=e[s];a!==void 0&&bb(a,n)}}function _h(e,t){e.setProperty("text-align",t)}const bte="40px";function LL(e,t){const r=s0.theme.indent;if(typeof r=="string"){const s=e.classList.contains(r);t>0&&!s?e.classList.add(r):t<1&&s&&e.classList.remove(r)}const n=getComputedStyle(e).getPropertyValue("--lexical-indent-base-value")||bte;e.style.setProperty("padding-inline-start",t===0?"":`calc(${t} * ${n})`)}function BL(e,t){const r=e.style;t===0?_h(r,""):t===n4?_h(r,"left"):t===s4?_h(r,"center"):t===a4?_h(r,"right"):t===i4?_h(r,"justify"):t===o4?_h(r,"start"):t===l4&&_h(r,"end")}function LT(e,t){const r=(function(n){const s=n.__dir;if(s!==null)return s;if(_a(n))return null;const a=n.getParentOrThrow();return _a(a)&&a.__dir===null?"auto":null})(t);r!==null?e.dir=r:e.removeAttribute("dir")}function _b(e,t){const r=oc.get(e);r===void 0&&$t(60);const n=r.createDOM(s0,Fi);if((function(s,a,i){const o=i._keyToDOMMap;(function(c,u,d){const h=`__lexicalKey_${u._key}`;c[h]=d})(a,i,s),o.set(s,a)})(e,n,Fi),er(r)?n.setAttribute("data-lexical-text","true"):vn(r)&&n.setAttribute("data-lexical-decorator","true"),bt(r)){const s=r.__indent,a=r.__size;if(LT(n,r),s!==0&&LL(n,s),a!==0){const o=a-1;BT(Sb(r,oc),r,0,o,r.getDOMSlot(n))}const i=r.__format;i!==0&&BL(n,i),r.isInline()||$L(null,r,n),Q_(r)&&(va+=ed,Mu+=ed)}else{const s=r.getTextContent();if(vn(r)){const a=r.decorate(Fi,s0);a!==null&&UL(e,a),n.contentEditable="false"}va+=s,Mu+=s}return t!==null&&t.insertChild(n),j4(Gy,Hy,U_,r,"created"),n}function BT(e,t,r,n,s){const a=va;va="";let i=r;for(;i<=n;++i){_b(e[i],s);const o=oc.get(e[i]);o!==null&&er(o)&&(Bc===null&&(Bc=o.getFormat()),$c===""&&($c=o.getStyle()))}Q_(t)&&(va+=ed),s.element.__lexicalTextContent=va,va=a+va}function $P(e,t){if(e){const r=e.__last;if(r){const n=t.get(r);if(n)return Vu(n)?"line-break":vn(n)&&n.isInline()?"decorator":null}return"empty"}return null}function $L(e,t,r){const n=$P(e,a0),s=$P(t,oc);n!==s&&t.getDOMSlot(r).setManagedLineBreak(s)}function _te(e,t,r){var n;Bc=null,$c="",(function(s,a,i){const o=va,c=s.__size,u=a.__size;va="";const d=i.element;if(c===1&&u===1){const h=s.__first,g=a.__first;if(h===g)iy(h,d);else{const x=$T(h),v=_b(g,null);try{d.replaceChild(v,x)}catch(w){if(typeof w=="object"&&w!=null){const C=`${w.toString()} Parent: ${d.tagName}, new child: {tag: ${v.tagName} key: ${g}}, old child: {tag: ${x.tagName}, key: ${h}}.`;throw new Error(C)}throw w}bb(h,null)}const p=oc.get(g);er(p)&&(Bc===null&&(Bc=p.getFormat()),$c===""&&($c=p.getStyle()))}else{const h=Sb(s,a0),g=Sb(a,oc);if(h.length!==c&&$t(227),g.length!==u&&$t(228),c===0)u!==0&&BT(g,a,0,u-1,i);else if(u===0){if(c!==0){const p=i.after==null&&i.before==null&&i.element.__lexicalLineBreak==null;MT(h,0,c-1,p?null:d),p&&(d.textContent="")}}else(function(p,x,v,w,C,k){const b=w-1,N=C-1;let E,P,F=k.getFirstChild(),A=0,j=0;for(;A<=b&&j<=N;){const Y=x[A],Z=v[j];if(Y===Z)F=ek(iy(Z,k.element)),A++,j++;else{E===void 0&&(E=new Set(x)),P===void 0&&(P=new Set(v));const ee=P.has(Y),ne=E.has(Z);if(ee)if(ne){const L=i0(Fi,Z);L===F?F=ek(iy(Z,k.element)):(k.withBefore(F).insertChild(L),iy(Z,k.element)),A++,j++}else _b(Z,k.withBefore(F)),j++;else F=ek($T(Y)),bb(Y,k.element),A++}const ae=oc.get(Z);ae!==null&&er(ae)&&(Bc===null&&(Bc=ae.getFormat()),$c===""&&($c=ae.getStyle()))}const I=A>b,B=j>N;if(I&&!B){const Y=v[N+1],Z=Y===void 0?null:Fi.getElementByKey(Y);BT(v,p,j,N,k.withBefore(Z))}else B&&!I&&MT(x,A,b,k.element)})(a,h,g,c,u,i)}Q_(a)&&(va+=ed),d.__lexicalTextContent=va,va=o+va})(e,t,t.getDOMSlot(r)),n=t,Bc==null||Bc===n.__textFormat||wb||n.setTextFormat(Bc),(function(s){$c===""||$c===s.__textStyle||wb||s.setTextStyle($c)})(t)}function Sb(e,t){const r=[];let n=e.__first;for(;n!==null;){const s=t.get(n);s===void 0&&$t(101),r.push(n),n=s.__next}return r}function iy(e,t){const r=a0.get(e);let n=oc.get(e);r!==void 0&&n!==void 0||$t(61);const s=Ug||IT.has(e)||DT.has(e),a=i0(Fi,e);if(r===n&&!s){if(bt(r)){const i=a.__lexicalTextContent;i!==void 0&&(va+=i,Mu+=i)}else{const i=r.getTextContent();Mu+=i,va+=i}return a}if(r!==n&&s&&j4(Gy,Hy,U_,n,"updated"),n.updateDOM(r,a,s0)){const i=_b(e,null);return t===null&&$t(62),t.replaceChild(i,a),bb(e,null),i}if(bt(r)&&bt(n)){const i=n.__indent;(Ug||i!==r.__indent)&&LL(a,i);const o=n.__format;if((Ug||o!==r.__format)&&BL(a,o),s&&(_te(r,n,a),_a(n)||n.isInline()||$L(r,n,a)),Q_(n)&&(va+=ed,Mu+=ed),(Ug||n.__dir!==r.__dir)&&(LT(a,n),_a(n)&&!Ug))for(const c of n.getChildren())bt(c)&&LT(i0(Fi,c.getKey()),c)}else{const i=n.getTextContent();if(vn(n)){const o=n.decorate(Fi,s0);o!==null&&UL(e,o)}va+=i,Mu+=i}if(!wb&&_a(n)&&n.__cachedText!==Mu){const i=n.getWritable();i.__cachedText=Mu,n=i}return a}function UL(e,t){let r=Fi._pendingDecorators;const n=Fi._decorators;if(r===null){if(n[e]===t)return;r=E9(Fi)}r[e]=t}function ek(e){let t=e.nextSibling;return t!==null&&t===Fi._blockCursorElement&&(t=t.nextSibling),t}function Ste(e,t,r,n,s,a){va="",Mu="",Ug=n===wm,Fi=r,s0=r._config,Hy=r._nodes,U_=Fi._listeners.mutation,DT=s,IT=a,a0=e._nodeMap,oc=t._nodeMap,wb=t._readOnly,RT=new Map(r._keyToDOMMap);const i=new Map;return Gy=i,iy("root",null),Fi=void 0,Hy=void 0,DT=void 0,IT=void 0,a0=void 0,oc=void 0,s0=void 0,RT=void 0,Gy=void 0,i}function $T(e){const t=RT.get(e);return t===void 0&&$t(75,e),t}function Pr(e){return{type:e}}const zL=Pr("SELECTION_CHANGE_COMMAND"),kte=Pr("SELECTION_INSERT_CLIPBOARD_NODES_COMMAND"),u4=Pr("CLICK_COMMAND"),zh=Pr("DELETE_CHARACTER_COMMAND"),sm=Pr("INSERT_LINE_BREAK_COMMAND"),Vy=Pr("INSERT_PARAGRAPH_COMMAND"),am=Pr("CONTROLLED_TEXT_INSERTION_COMMAND"),d4=Pr("PASTE_COMMAND"),UT=Pr("REMOVE_TEXT_COMMAND"),Ky=Pr("DELETE_WORD_COMMAND"),qy=Pr("DELETE_LINE_COMMAND"),Pi=Pr("FORMAT_TEXT_COMMAND"),f4=Pr("UNDO_COMMAND"),h4=Pr("REDO_COMMAND"),Cte=Pr("KEYDOWN_COMMAND"),WL=Pr("KEY_ARROW_RIGHT_COMMAND"),Tte=Pr("MOVE_TO_END"),HL=Pr("KEY_ARROW_LEFT_COMMAND"),Ete=Pr("MOVE_TO_START"),GL=Pr("KEY_ARROW_UP_COMMAND"),VL=Pr("KEY_ARROW_DOWN_COMMAND"),kb=Pr("KEY_ENTER_COMMAND"),KL=Pr("KEY_SPACE_COMMAND"),qL=Pr("KEY_BACKSPACE_COMMAND"),YL=Pr("KEY_ESCAPE_COMMAND"),XL=Pr("KEY_DELETE_COMMAND"),QL=Pr("KEY_TAB_COMMAND"),Nte=Pr("INSERT_TAB_COMMAND"),Ate=Pr("INDENT_CONTENT_COMMAND"),UP=Pr("OUTDENT_CONTENT_COMMAND"),JL=Pr("DROP_COMMAND"),ZL=Pr("FORMAT_ELEMENT_COMMAND"),e9=Pr("DRAGSTART_COMMAND"),t9=Pr("DRAGOVER_COMMAND"),jte=Pr("DRAGEND_COMMAND"),z_=Pr("COPY_COMMAND"),g4=Pr("CUT_COMMAND"),zT=Pr("SELECT_ALL_COMMAND"),Pte=Pr("CLEAR_EDITOR_COMMAND"),Fte=Pr("CLEAR_HISTORY_COMMAND"),hw=Pr("CAN_REDO_COMMAND"),gw=Pr("CAN_UNDO_COMMAND"),Ote=Pr("FOCUS_COMMAND"),Dte=Pr("BLUR_COMMAND"),Ite=Pr("KEY_MODIFIER_COMMAND"),Ou=Object.freeze({}),WT=30,HT=[["keydown",function(e,t){if(vy=e.timeStamp,r9=e.key,!t.isComposing()&&!lr(t,Cte,e)&&e.key!=null){if(tk&&m8(e))return $o(t,(()=>{mw(t,rk)})),tk=!1,void(rk="");if((function(r){return Pn(r,"ArrowRight",{shiftKey:"any"})})(e))lr(t,WL,e);else if((function(r){return Pn(r,"ArrowRight",Iu)})(e))lr(t,Tte,e);else if((function(r){return Pn(r,"ArrowLeft",{shiftKey:"any"})})(e))lr(t,HL,e);else if((function(r){return Pn(r,"ArrowLeft",Iu)})(e))lr(t,Ete,e);else if((function(r){return Pn(r,"ArrowUp",{altKey:"any",shiftKey:"any"})})(e))lr(t,GL,e);else if((function(r){return Pn(r,"ArrowDown",{altKey:"any",shiftKey:"any"})})(e))lr(t,VL,e);else if((function(r){return Pn(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any",shiftKey:!0})})(e))wy=!0,lr(t,kb,e);else if((function(r){return r.key===" "})(e))lr(t,KL,e);else if((function(r){return Uc&&Pn(r,"o",{ctrlKey:!0})})(e))e.preventDefault(),wy=!0,lr(t,sm,!0);else if((function(r){return Pn(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any"})})(e))wy=!1,lr(t,kb,e);else if((function(r){return Pn(r,"Backspace",{shiftKey:"any"})||Uc&&Pn(r,"h",{ctrlKey:!0})})(e))m8(e)?lr(t,qL,e):(e.preventDefault(),lr(t,zh,!0));else if((function(r){return r.key==="Escape"})(e))lr(t,YL,e);else if((function(r){return Pn(r,"Delete",{})||Uc&&Pn(r,"d",{ctrlKey:!0})})(e))(function(r){return r.key==="Delete"})(e)?lr(t,XL,e):(e.preventDefault(),lr(t,zh,!1));else if((function(r){return Pn(r,"Backspace",g8)})(e))e.preventDefault(),lr(t,Ky,!0);else if((function(r){return Pn(r,"Delete",g8)})(e))e.preventDefault(),lr(t,Ky,!1);else if((function(r){return Uc&&Pn(r,"Backspace",{metaKey:!0})})(e))e.preventDefault(),lr(t,qy,!0);else if((function(r){return Uc&&(Pn(r,"Delete",{metaKey:!0})||Pn(r,"k",{ctrlKey:!0}))})(e))e.preventDefault(),lr(t,qy,!1);else if((function(r){return Pn(r,"b",Iu)})(e))e.preventDefault(),lr(t,Pi,"bold");else if((function(r){return Pn(r,"u",Iu)})(e))e.preventDefault(),lr(t,Pi,"underline");else if((function(r){return Pn(r,"i",Iu)})(e))e.preventDefault(),lr(t,Pi,"italic");else if((function(r){return Pn(r,"Tab",{shiftKey:"any"})})(e))lr(t,QL,e);else if((function(r){return Pn(r,"z",Iu)})(e))e.preventDefault(),lr(t,f4,void 0);else if((function(r){return Uc?Pn(r,"z",{metaKey:!0,shiftKey:!0}):Pn(r,"y",{ctrlKey:!0})||Pn(r,"z",{ctrlKey:!0,shiftKey:!0})})(e))e.preventDefault(),lr(t,h4,void 0);else{const r=t._editorState._selection;r===null||Ot(r)?p8(e)&&(e.preventDefault(),lr(t,zT,e)):(function(n){return Pn(n,"c",Iu)})(e)?(e.preventDefault(),lr(t,z_,e)):(function(n){return Pn(n,"x",Iu)})(e)?(e.preventDefault(),lr(t,g4,e)):p8(e)&&(e.preventDefault(),lr(t,zT,e))}(function(r){return r.ctrlKey||r.shiftKey||r.altKey||r.metaKey})(e)&&lr(t,Ite,e)}}],["pointerdown",function(e,t){const r=e.target,n=e.pointerType;Hm(r)&&n!=="touch"&&n!=="pen"&&e.button===0&&$o(t,(()=>{d8(r)||(VT=!0)}))}],["compositionstart",function(e,t){$o(t,(()=>{const r=Zt();if(Ot(r)&&!t.isComposing()){const n=r.anchor,s=r.anchor.getNode();ci(n.key),(e.timeStamp<vy+WT||n.type==="element"||!r.isCollapsed()||s.getFormat()!==r.format||er(s)&&s.getStyle()!==r.style)&&lr(t,am,lte)}}))}],["compositionend",function(e,t){t0?Gx=!0:vm||!Wy&&!pb?$o(t,(()=>{mw(t,e.data)})):(tk=!0,rk=e.data)}],["input",function(e,t){e.stopPropagation(),$o(t,(()=>{if(as(e.target)&&d8(e.target))return;const r=Zt(),n=e.data,s=o9(e);if(n!=null&&Ot(r)&&a9(r,s,n,e.timeStamp,!1)){Gx&&(mw(t,n),Gx=!1);const a=r.anchor.getNode(),i=dc(El(t));if(i===null)return;const o=r.isBackward(),c=o?r.anchor.offset:r.focus.offset,u=o?r.focus.offset:r.anchor.offset;mb&&!r.isCollapsed()&&er(a)&&i.anchorNode!==null&&a.getTextContent().slice(0,c)+n+a.getTextContent().slice(c+u)===P9(i.anchorNode)||lr(t,am,n);const d=n.length;t0&&d>1&&e.inputType==="insertCompositionText"&&!t.isComposing()&&(r.anchor.offset-=d),Wy||vm||pb||!t.isComposing()||(vy=0,ci(null))}else N4(!1,t,n!==null?n:void 0),Gx&&(mw(t,n||void 0),Gx=!1);(function(){li();const a=Ss();DL(a)})()}),{event:e}),zg=null}],["click",function(e,t){$o(t,(()=>{const r=Zt(),n=dc(El(t)),s=Wm();if(n){if(Ot(r)){const a=r.anchor,i=a.getNode();if(a.type==="element"&&a.offset===0&&r.isCollapsed()&&!_a(i)&&ps().getChildrenSize()===1&&i.getTopLevelElementOrThrow().isEmpty()&&s!==null&&r.is(s))n.removeAllRanges(),r.dirty=!0;else if(e.detail===3&&!r.isCollapsed()&&i!==r.focus.getNode()){const o=(function(c,u){let d=c;for(;d!==ps()&&d!=null;){if(u(d))return d;d=d.getParent()}return null})(i,(c=>bt(c)&&!c.isInline()));bt(o)&&o.select(0)}}else if(e.pointerType==="touch"||e.pointerType==="pen"){const a=n.anchorNode;(as(a)||ld(a))&&hi(x4(s,n,t,e))}}lr(t,u4,e)}))}],["cut",Ou],["copy",Ou],["dragstart",Ou],["dragover",Ou],["dragend",Ou],["paste",Ou],["focus",Ou],["blur",Ou],["drop",Ou]];mb&&HT.push(["beforeinput",(e,t)=>(function(r,n){const s=r.inputType,a=o9(r);s==="deleteCompositionText"||t0&&F9(n)||s!=="insertCompositionText"&&$o(n,(()=>{const i=Zt();if(s==="deleteContentBackward"){if(i===null){const p=Wm();if(!Ot(p))return;hi(p.clone())}if(Ot(i)){const p=i.anchor.key===i.focus.key;if(o=r.timeStamp,r9==="MediaLast"&&o<vy+WT&&n.isComposing()&&p){if(ci(null),vy=0,setTimeout((()=>{$o(n,(()=>{ci(null)}))}),WT),Ot(i)){const x=i.anchor.getNode();x.markDirty(),er(x)||$t(142),i9(i,x)}}else{ci(null),r.preventDefault();const x=i.anchor.getNode(),v=x.getTextContent(),w=x.canInsertTextAfter(),C=i.anchor.offset===0&&i.focus.offset===v.length;let k=AP&&p&&!C&&w;if(k&&i.isCollapsed()&&(k=!vn(QT(i.anchor,!0))),!k){lr(n,zh,!0);const b=Zt();AP&&Ot(b)&&b.isCollapsed()&&(Ah=b,setTimeout((()=>Ah=null)))}}return}}var o;if(!Ot(i))return;const c=r.data;zg!==null&&N4(!1,n,zg),i.dirty&&zg===null||!i.isCollapsed()||_a(i.anchor.getNode())||a===null||i.applyDOMRange(a),zg=null;const u=i.anchor,d=i.focus,h=u.getNode(),g=d.getNode();if(s!=="insertText"&&s!=="insertTranspose")switch(r.preventDefault(),s){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":lr(n,am,r);break;case"insertFromComposition":ci(null),lr(n,am,r);break;case"insertLineBreak":ci(null),lr(n,sm,!1);break;case"insertParagraph":ci(null),wy&&!vm?(wy=!1,lr(n,sm,!1)):lr(n,Vy,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":lr(n,d4,r);break;case"deleteByComposition":(function(p,x){return p!==x||bt(p)||bt(x)||!Wh(p)||!Wh(x)})(h,g)&&lr(n,UT,r);break;case"deleteByDrag":case"deleteByCut":lr(n,UT,r);break;case"deleteContent":lr(n,zh,!1);break;case"deleteWordBackward":lr(n,Ky,!0);break;case"deleteWordForward":lr(n,Ky,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":lr(n,qy,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":lr(n,qy,!1);break;case"formatStrikeThrough":lr(n,Pi,"strikethrough");break;case"formatBold":lr(n,Pi,"bold");break;case"formatItalic":lr(n,Pi,"italic");break;case"formatUnderline":lr(n,Pi,"underline");break;case"historyUndo":lr(n,f4,void 0);break;case"historyRedo":lr(n,h4,void 0)}else{if(c===`
`)r.preventDefault(),lr(n,sm,!1);else if(c===ed)r.preventDefault(),lr(n,Vy,void 0);else if(c==null&&r.dataTransfer){const p=r.dataTransfer.getData("text/plain");r.preventDefault(),i.insertRawText(p)}else c!=null&&a9(i,a,c,r.timeStamp,!0)?(r.preventDefault(),lr(n,am,c)):zg=c;n9=r.timeStamp}}))})(e,t)]);let vy=0,r9=null,n9=0,zg=null;const Cb=new WeakMap;let GT=!1,VT=!1,wy=!1,Gx=!1,tk=!1,rk="",Ah=null,s9=[0,"",0,"root",0];function a9(e,t,r,n,s){const a=e.anchor,i=e.focus,o=a.getNode(),c=Ss(),u=dc(El(c)),d=u!==null?u.anchorNode:null,h=a.key,g=c.getElementByKey(h),p=r.length;return h!==i.key||!er(o)||(!s&&(!mb||n9<n+50)||o.isDirty()&&p<2||A9(r))&&a.offset!==i.offset&&!o.isComposing()||Ru(o)||o.isDirty()&&p>1||(s||!mb)&&g!==null&&!o.isComposing()&&d!==bm(g)||u!==null&&t!==null&&(!t.collapsed||t.startContainer!==u.anchorNode||t.startOffset!==u.anchorOffset)||o.getFormat()!==e.format||o.getStyle()!==e.style||(function(x,v){if(v.isSegmented())return!0;if(!x.isCollapsed())return!1;const w=x.anchor.offset,C=v.getParentOrThrow(),k=Wh(v);return w===0?!v.canInsertTextBefore()||!C.canInsertTextBefore()&&!v.isComposing()||k||(function(b){const N=b.getPreviousSibling();return(er(N)||bt(N)&&N.isInline())&&!N.canInsertTextAfter()})(v):w===v.getTextContentSize()&&(!v.canInsertTextAfter()||!C.canInsertTextAfter()&&!v.isComposing()||k)})(e,o)}function zP(e,t){return ld(e)&&e.nodeValue!==null&&t!==0&&t!==e.nodeValue.length}function WP(e,t,r){const{anchorNode:n,anchorOffset:s,focusNode:a,focusOffset:i}=e;GT&&(GT=!1,zP(n,s)&&zP(a,i)&&!Ah)||$o(t,(()=>{if(!r)return void hi(null);if(!Dv(t,n,a))return;let o=Zt();if(Ah&&Ot(o)&&o.isCollapsed()){const c=o.anchor,u=Ah.anchor;(c.key===u.key&&c.offset===u.offset+1||c.offset===1&&u.getNode().is(c.getNode().getPreviousSibling()))&&(o=Ah.clone(),hi(o))}if(Ah=null,Ot(o)){const c=o.anchor,u=c.getNode();if(o.isCollapsed()){e.type==="Range"&&e.anchorNode===e.focusNode&&(o.dirty=!0);const d=El(t).event,h=d?d.timeStamp:performance.now(),[g,p,x,v,w]=s9,C=ps(),k=t.isComposing()===!1&&C.getTextContent()==="";if(h<w+200&&c.offset===x&&c.key===v)tb(o,g,p);else if(c.type==="text")er(u)||$t(141),i9(o,u);else if(c.type==="element"&&!k){bt(u)||$t(259);const b=c.getNode();b.isEmpty()?(function(N,E){const P=E.getTextFormat(),F=E.getTextStyle();tb(N,P,F)})(o,b):tb(o,0,"")}}else{const d=c.key,h=o.focus.key,g=o.getNodes(),p=g.length,x=o.isBackward(),v=x?i:s,w=x?s:i,C=x?h:d,k=x?d:h;let b=ote,N=!1;for(let E=0;E<p;E++){const P=g[E],F=P.getTextContentSize();if(er(P)&&F!==0&&!(E===0&&P.__key===C&&v===F||E===p-1&&P.__key===k&&w===0)&&(N=!0,b&=P.getFormat(),b===0))break}o.format=N?b:0}}lr(t,zL,void 0)}))}function tb(e,t,r){e.format===t&&e.style===r||(e.format=t,e.style=r,e.dirty=!0)}function i9(e,t){tb(e,t.getFormat(),t.getStyle())}function o9(e){if(!e.getTargetRanges)return null;const t=e.getTargetRanges();return t.length===0?null:t[0]}function mw(e,t){const r=e._compositionKey;if(ci(null),r!==null&&t!=null){if(t===""){const n=la(r),s=bm(e.getElementByKey(r));return void(s!==null&&s.nodeValue!==null&&er(n)&&A4(n,s.nodeValue,null,null,!0))}if(t[t.length-1]===`
`){const n=Zt();if(Ot(n)){const s=n.focus;return n.anchor.set(s.key,s.offset,s.type),void lr(e,kb,null)}}}N4(!0,e,t)}function l9(e){let t=e.__lexicalEventHandles;return t===void 0&&(t=[],e.__lexicalEventHandles=t),t}const im=new Map;function c9(e){const t=gre(e.target);if(t===null)return;const r=k9(t.anchorNode);if(r===null)return;VT&&(VT=!1,$o(r,(()=>{const c=Wm(),u=t.anchorNode;(as(u)||ld(u))&&hi(x4(c,t,r,e))})));const n=E4(r),s=n[n.length-1],a=s._key,i=im.get(a),o=i||s;o!==r&&WP(t,o,!1),WP(t,r,!0),r!==s?im.set(a,r):i&&im.delete(a)}function HP(e){e._lexicalHandled=!0}function GP(e){return e._lexicalHandled===!0}function Rte(e){const t=e.ownerDocument,r=Cb.get(t);if(r===void 0)return;const n=r-1;n>=0||$t(164),Cb.set(t,n),n===0&&t.removeEventListener("selectionchange",c9);const s=Y_(e);T4(s)?((function(i){if(i._parentEditor!==null){const o=E4(i),c=o[o.length-1]._key;im.get(c)===i&&im.delete(c)}else im.delete(i._key)})(s),e.__lexicalEditor=null):s&&$t(198);const a=l9(e);for(let i=0;i<a.length;i++)a[i]();e.__lexicalEventHandles=[]}function KT(e,t,r){li();const n=e.__key,s=e.getParent();if(s===null)return;const a=(function(o){const c=Zt();if(!Ot(c)||!bt(o))return c;const{anchor:u,focus:d}=c,h=u.getNode(),g=d.getNode();return JT(h,o)&&u.set(o.__key,0,"element"),JT(g,o)&&d.set(o.__key,0,"element"),c})(e);let i=!1;if(Ot(a)&&t){const o=a.anchor,c=a.focus;o.key===n&&(Eb(o,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0),c.key===n&&(Eb(c,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0)}else Si(a)&&t&&e.isSelected()&&e.selectPrevious();if(Ot(a)&&t&&!i){const o=e.getIndexWithinParent();Hh(e),Tb(a,s,o,-1)}else Hh(e);r||ro(s)||s.canBeEmpty()||!s.isEmpty()||KT(s,t),t&&a&&_a(s)&&s.isEmpty()&&s.selectEnd()}class Um{static getType(){const{ownNodeType:t}=D4(this);return t===void 0&&$t(64,this.name),t}static clone(t){$t(65,this.name)}$config(){return{}}config(t,r){const n=r.extends||Object.getPrototypeOf(this.constructor);return Object.assign(r,{extends:n,type:t}),{[t]:r}}afterCloneFrom(t){this.__key===t.__key?(this.__parent=t.__parent,this.__next=t.__next,this.__prev=t.__prev,this.__state=t.__state):t.__state&&(this.__state=t.__state.getWritable(this))}constructor(t){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,Object.defineProperty(this,"__state",{configurable:!0,enumerable:!1,value:void 0,writable:!0}),ire(this,t)}getType(){return this.__type}isInline(){$t(137,this.constructor.name)}isAttached(){let t=this.__key;for(;t!==null;){if(t==="root")return!0;const r=la(t);if(r===null)break;t=r.__parent}return!1}isSelected(t){const r=t||Zt();if(r==null)return!1;const n=r.getNodes().some((s=>s.__key===this.__key));if(er(this))return n;if(Ot(r)&&r.anchor.type==="element"&&r.focus.type==="element"){if(r.isCollapsed())return!1;const s=this.getParent();if(vn(this)&&this.isInline()&&s){const a=r.isBackward()?r.focus:r.anchor;if(s.is(a.getNode())&&a.offset===s.getChildrenSize()&&this.is(s.getLastChild()))return!1}}return n}getKey(){return this.__key}getIndexWithinParent(){const t=this.getParent();if(t===null)return-1;let r=t.getFirstChild(),n=0;for(;r!==null;){if(this.is(r))return n;n++,r=r.getNextSibling()}return-1}getParent(){const t=this.getLatest().__parent;return t===null?null:la(t)}getParentOrThrow(){const t=this.getParent();return t===null&&$t(66,this.__key),t}getTopLevelElement(){let t=this;for(;t!==null;){const r=t.getParent();if(ro(r))return bt(t)||t===this&&vn(t)||$t(194),t;t=r}return null}getTopLevelElementOrThrow(){const t=this.getTopLevelElement();return t===null&&$t(67,this.__key),t}getParents(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r),r=r.getParent();return t}getParentKeys(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r.__key),r=r.getParent();return t}getPreviousSibling(){const t=this.getLatest().__prev;return t===null?null:la(t)}getPreviousSiblings(){const t=[],r=this.getParent();if(r===null)return t;let n=r.getFirstChild();for(;n!==null&&!n.is(this);)t.push(n),n=n.getNextSibling();return t}getNextSibling(){const t=this.getLatest().__next;return t===null?null:la(t)}getNextSiblings(){const t=[];let r=this.getNextSibling();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getCommonAncestor(t){const r=bt(this)?this:this.getParent(),n=bt(t)?t:t.getParent(),s=r&&n?nb(r,n):null;return s?s.commonAncestor:null}is(t){return t!=null&&this.__key===t.__key}isBefore(t){const r=nb(this,t);return r!==null&&(r.type==="descendant"||(r.type==="branch"?R9(r)===-1:(r.type!=="same"&&r.type!=="ancestor"&&$t(279),!1)))}isParentOf(t){const r=nb(this,t);return r!==null&&r.type==="ancestor"}getNodesBetween(t){const r=this.isBefore(t),n=[],s=new Set;let a=this;for(;a!==null;){const i=a.__key;if(s.has(i)||(s.add(i),n.push(a)),a===t)break;const o=bt(a)?r?a.getFirstChild():a.getLastChild():null;if(o!==null){a=o;continue}const c=r?a.getNextSibling():a.getPreviousSibling();if(c!==null){a=c;continue}const u=a.getParentOrThrow();if(s.has(u.__key)||n.push(u),u===t)break;let d=null,h=u;do{if(h===null&&$t(68),d=r?h.getNextSibling():h.getPreviousSibling(),h=h.getParent(),h===null)break;d!==null||s.has(h.__key)||n.push(h)}while(d===null);a=d}return r||n.reverse(),n}isDirty(){const t=Ss()._dirtyLeaves;return t!==null&&t.has(this.__key)}getLatest(){const t=la(this.__key);return t===null&&$t(113),t}getWritable(){li();const t=If(),r=Ss(),n=t._nodeMap,s=this.__key,a=this.getLatest(),i=r._cloneNotNeeded,o=Zt();if(o!==null&&o.setCachedNodes(null),i.has(s))return jb(a),a;const c=F4(a);return i.add(s),jb(c),n.set(s,c),c}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(t,r){$t(70)}updateDOM(t,r,n){$t(71)}exportDOM(t){return{element:this.createDOM(t._config,t)}}exportJSON(){const t=this.__state?this.__state.toJSON():void 0;return{type:this.__type,version:1,...t}}static importJSON(t){$t(18,this.name)}updateFromJSON(t){return(function(r,n){const s=r.getWritable(),a=n.$;let i=a;for(const o of ML(s).flatKeys)o in n&&(i!==void 0&&i!==a||(i={...a}),i[o]=n[o]);return(s.__state||i)&&wte(r).updateFromJSON(i),s})(this,t)}static transform(){return null}remove(t){KT(this,!0,t)}replace(t,r){li();let n=Zt();n!==null&&(n=n.clone()),lk(this,t);const s=this.getLatest(),a=this.__key,i=t.__key,o=t.getWritable(),c=this.getParentOrThrow().getWritable(),u=c.__size;Hh(o);const d=s.getPreviousSibling(),h=s.getNextSibling(),g=s.__prev,p=s.__next,x=s.__parent;if(KT(s,!1,!0),d===null?c.__first=i:d.getWritable().__next=i,o.__prev=g,h===null?c.__last=i:h.getWritable().__prev=i,o.__next=p,o.__parent=x,c.__size=u,r&&(bt(this)&&bt(o)||$t(139),this.getChildren().forEach((v=>{o.append(v)}))),Ot(n)){hi(n);const v=n.anchor,w=n.focus;v.key===a&&YP(v,o),w.key===a&&YP(w,o)}return df()===a&&ci(i),o}insertAfter(t,r=!0){li(),lk(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.getParent(),i=Zt();let o=!1,c=!1;if(a!==null){const p=t.getIndexWithinParent();if(Hh(s),Ot(i)){const x=a.__key,v=i.anchor,w=i.focus;o=v.type==="element"&&v.key===x&&v.offset===p+1,c=w.type==="element"&&w.key===x&&w.offset===p+1}}const u=this.getNextSibling(),d=this.getParentOrThrow().getWritable(),h=s.__key,g=n.__next;if(u===null?d.__last=h:u.getWritable().__prev=h,d.__size++,n.__next=h,s.__next=g,s.__prev=n.__key,s.__parent=n.__parent,r&&Ot(i)){const p=this.getIndexWithinParent();Tb(i,d,p+1);const x=d.__key;o&&i.anchor.set(x,p+2,"element"),c&&i.focus.set(x,p+2,"element")}return t}insertBefore(t,r=!0){li(),lk(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.__key;Hh(s);const i=this.getPreviousSibling(),o=this.getParentOrThrow().getWritable(),c=n.__prev,u=this.getIndexWithinParent();i===null?o.__first=a:i.getWritable().__next=a,o.__size++,n.__prev=a,s.__prev=c,s.__next=n.__key,s.__parent=n.__parent;const d=Zt();return r&&Ot(d)&&Tb(d,this.getParentOrThrow(),u),t}isParentRequired(){return!1}createParentElementNode(){return ss()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(t,r){li();const n=this.getPreviousSibling(),s=this.getParentOrThrow();if(n===null)return s.select(0,0);if(bt(n))return n.select();if(!er(n)){const a=n.getIndexWithinParent()+1;return s.select(a,a)}return n.select(t,r)}selectNext(t,r){li();const n=this.getNextSibling(),s=this.getParentOrThrow();if(n===null)return s.select();if(bt(n))return n.select(0,0);if(!er(n)){const a=n.getIndexWithinParent();return s.select(a,a)}return n.select(t,r)}markDirty(){this.getWritable()}reconcileObservedMutation(t,r){this.markDirty()}}class Av extends Um{static getType(){return"linebreak"}static clone(t){return new Av(t.__key)}constructor(t){super(t)}getTextContent(){return`
`}createDOM(){return document.createElement("br")}updateDOM(){return!1}isInline(){return!0}static importDOM(){return{br:t=>(function(r){const n=r.parentElement;if(n!==null&&Pb(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&pw(s)){const a=n.lastChild;if(a===r||a.previousSibling===r&&pw(a))return!0}}return!1})(t)||(function(r){const n=r.parentElement;if(n!==null&&Pb(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&pw(s))return!1;const a=n.lastChild;if(a===r||a.previousSibling===r&&pw(a))return!0}return!1})(t)?null:{conversion:Mte,priority:0}}}static importJSON(t){return Qc().updateFromJSON(t)}}function Mte(e){return{node:Qc()}}function Qc(){return ao(new Av)}function Vu(e){return e instanceof Av}function pw(e){return ld(e)&&/^( |\t|\r?\n)+$/.test(e.textContent||"")}function nk(e,t){return 16&t?"code":t&r4?"mark":32&t?"sub":64&t?"sup":null}function sk(e,t){return 1&t?"strong":2&t?"em":"span"}function u9(e,t,r,n,s){const a=n.classList;let i=om(s,"base");i!==void 0&&a.add(...i),i=om(s,"underlineStrikethrough");let o=!1;const c=t&yb&&t&xb;i!==void 0&&(r&yb&&r&xb?(o=!0,c||a.add(...i)):c&&a.remove(...i));for(const u in n0){const d=n0[u];if(i=om(s,u),i!==void 0)if(r&d){if(o&&(u==="underline"||u==="strikethrough")){t&d&&a.remove(...i);continue}t&d&&(!c||u!=="underline")&&u!=="strikethrough"||a.add(...i)}else t&d&&a.remove(...i)}}function d9(e,t,r){const n=t.firstChild,s=r.isComposing(),a=e+(s?$_:"");if(n==null)t.textContent=a;else{const i=n.nodeValue;if(i!==a)if(s||t0){const[o,c,u]=(function(d,h){const g=d.length,p=h.length;let x=0,v=0;for(;x<g&&x<p&&d[x]===h[x];)x++;for(;v+x<g&&v+x<p&&d[g-v-1]===h[p-v-1];)v++;return[x,g-x-v,h.slice(x,p-v)]})(i,a);c!==0&&n.deleteData(o,c),n.insertData(o,u)}else n.nodeValue=a}}function VP(e,t,r,n,s,a){d9(s,e,t);const i=a.theme.text;i!==void 0&&u9(0,0,n,e,i)}function xw(e,t){const r=document.createElement(t);return r.appendChild(e),r}class Df extends Um{static getType(){return"text"}static clone(t){return new Df(t.__text,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__text=t.__text,this.__format=t.__format,this.__style=t.__style,this.__mode=t.__mode,this.__detail=t.__detail}constructor(t="",r){super(r),this.__text=t,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const t=this.getLatest();return fte[t.__mode]}getStyle(){return this.getLatest().__style}isToken(){return this.getLatest().__mode===1}isComposing(){return this.__key===df()}isSegmented(){return this.getLatest().__mode===2}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(t){const r=n0[t];return!!(this.getFormat()&r)}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(){return this.getLatest().__text}getFormatFlags(t,r){return Ab(this.getLatest().__format,t,r)}canHaveFormat(){return!0}isInline(){return!0}createDOM(t,r){const n=this.__format,s=nk(0,n),a=sk(0,n),i=s===null?a:s,o=document.createElement(i);let c=o;this.hasFormat("code")&&o.setAttribute("spellcheck","false"),s!==null&&(c=document.createElement(a),o.appendChild(c)),VP(c,this,0,n,this.__text,t);const u=this.__style;return u!==""&&(o.style.cssText=u),o}updateDOM(t,r,n){const s=this.__text,a=t.__format,i=this.__format,o=nk(0,a),c=nk(0,i),u=sk(0,a),d=sk(0,i);if((o===null?u:o)!==(c===null?d:c))return!0;if(o===c&&u!==d){const v=r.firstChild;v==null&&$t(48);const w=document.createElement(d);return VP(w,this,0,i,s,n),r.replaceChild(w,v),!1}let h=r;c!==null&&o!==null&&(h=r.firstChild,h==null&&$t(49)),d9(s,h,this);const g=n.theme.text;g!==void 0&&a!==i&&u9(0,a,i,h,g);const p=t.__style,x=this.__style;return p!==x&&(r.style.cssText=x),!1}static importDOM(){return{"#text":()=>({conversion:Ute,priority:0}),b:()=>({conversion:Bte,priority:0}),code:()=>({conversion:Du,priority:0}),em:()=>({conversion:Du,priority:0}),i:()=>({conversion:Du,priority:0}),mark:()=>({conversion:Du,priority:0}),s:()=>({conversion:Du,priority:0}),span:()=>({conversion:Lte,priority:0}),strong:()=>({conversion:Du,priority:0}),sub:()=>({conversion:Du,priority:0}),sup:()=>({conversion:Du,priority:0}),u:()=>({conversion:Du,priority:0})}}static importJSON(t){return Ps().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTextContent(t.text).setFormat(t.format).setDetail(t.detail).setMode(t.mode).setStyle(t.style)}exportDOM(t){let{element:r}=super.exportDOM(t);return as(r)||$t(132),r.style.whiteSpace="pre-wrap",this.hasFormat("lowercase")?r.style.textTransform="lowercase":this.hasFormat("uppercase")?r.style.textTransform="uppercase":this.hasFormat("capitalize")&&(r.style.textTransform="capitalize"),this.hasFormat("bold")&&(r=xw(r,"b")),this.hasFormat("italic")&&(r=xw(r,"i")),this.hasFormat("strikethrough")&&(r=xw(r,"s")),this.hasFormat("underline")&&(r=xw(r,"u")),{element:r}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),...super.exportJSON()}}selectionTransform(t,r){}setFormat(t){const r=this.getWritable();return r.__format=typeof t=="string"?n0[t]:t,r}setDetail(t){const r=this.getWritable();return r.__detail=typeof t=="string"?cte[t]:t,r}setStyle(t){const r=this.getWritable();return r.__style=t,r}toggleFormat(t){const r=Ab(this.getFormat(),t,null);return this.setFormat(r)}toggleDirectionless(){const t=this.getWritable();return t.__detail^=1,t}toggleUnmergeable(){const t=this.getWritable();return t.__detail^=2,t}setMode(t){const r=dte[t];if(this.__mode===r)return this;const n=this.getWritable();return n.__mode=r,n}setTextContent(t){if(this.__text===t)return this;const r=this.getWritable();return r.__text=t,r}select(t,r){li();let n=t,s=r;const a=Zt(),i=this.getTextContent(),o=this.__key;if(typeof i=="string"){const c=i.length;n===void 0&&(n=c),s===void 0&&(s=c)}else n=0,s=0;if(!Ot(a))return g9(o,n,o,s,"text","text");{const c=df();c!==a.anchor.key&&c!==a.focus.key||ci(o),a.setTextNodeRange(this,n,this,s)}return a}selectStart(){return this.select(0,0)}selectEnd(){const t=this.getTextContentSize();return this.select(t,t)}spliceText(t,r,n,s){const a=this.getWritable(),i=a.__text,o=n.length;let c=t;c<0&&(c=o+c,c<0&&(c=0));const u=Zt();if(s&&Ot(u)){const h=t+o;u.setTextNodeRange(a,h,a,h)}const d=i.slice(0,c)+n+i.slice(c+r);return a.__text=d,a}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...t){li();const r=this.getLatest(),n=r.getTextContent();if(n==="")return[];const s=r.__key,a=df(),i=n.length;t.sort(((A,j)=>A-j)),t.push(i);const o=[],c=t.length;for(let A=0,j=0;A<i&&j<=c;j++){const I=t[j];I>A&&(o.push(n.slice(A,I)),A=I)}const u=o.length;if(u===1)return[r];const d=o[0],h=r.getParent();let g;const p=r.getFormat(),x=r.getStyle(),v=r.__detail;let w=!1,C=null,k=null;const b=Zt();if(Ot(b)){const[A,j]=b.isBackward()?[b.focus,b.anchor]:[b.anchor,b.focus];A.type==="text"&&A.key===s&&(C=A),j.type==="text"&&j.key===s&&(k=j)}r.isSegmented()?(g=Ps(d),g.__format=p,g.__style=x,g.__detail=v,g.__state=IP(r,g),w=!0):g=r.setTextContent(d);const N=[g];for(let A=1;A<u;A++){const j=Ps(o[A]);j.__format=p,j.__style=x,j.__detail=v,j.__state=IP(r,j);const I=j.__key;a===s&&ci(I),N.push(j)}const E=C?C.offset:null,P=k?k.offset:null;let F=0;for(const A of N){if(!C&&!k)break;const j=F+A.getTextContentSize();if(C!==null&&E!==null&&E<=j&&E>=F&&(C.set(A.getKey(),E-F,"text"),E<j&&(C=null)),k!==null&&P!==null&&P<=j&&P>=F){k.set(A.getKey(),P-F,"text");break}F=j}if(h!==null){(function(I){const B=I.getPreviousSibling(),Y=I.getNextSibling();B!==null&&jb(B),Y!==null&&jb(Y)})(this);const A=h.getWritable(),j=this.getIndexWithinParent();w?(A.splice(j,0,N),this.remove()):A.splice(j,1,N),Ot(b)&&Tb(b,h,j,u-1)}return N}mergeWithSibling(t){const r=t===this.getPreviousSibling();r||t===this.getNextSibling()||$t(50);const n=this.__key,s=t.__key,a=this.__text,i=a.length;df()===s&&ci(n);const o=Zt();if(Ot(o)){const h=o.anchor,g=o.focus;h!==null&&h.key===s&&r8(h,r,n,t,i),g!==null&&g.key===s&&r8(g,r,n,t,i)}const c=t.__text,u=r?c+a:a+c;this.setTextContent(u);const d=this.getWritable();return t.remove(),d}isTextEntity(){return!1}}function Lte(e){return{forChild:m4(e.style),node:null}}function Bte(e){const t=e,r=t.style.fontWeight==="normal";return{forChild:m4(t.style,r?void 0:"bold"),node:null}}const KP=new WeakMap;function $te(e){if(!as(e))return!1;if(e.nodeName==="PRE")return!0;const t=e.style.whiteSpace;return typeof t=="string"&&t.startsWith("pre")}function Ute(e){const t=e;e.parentElement===null&&$t(129);let r=t.textContent||"";if((function(n){let s,a=n.parentNode;const i=[n];for(;a!==null&&(s=KP.get(a))===void 0&&!$te(a);)i.push(a),a=a.parentNode;const o=s===void 0?a:s;for(let c=0;c<i.length;c++)KP.set(i[c],o);return o})(t)!==null){const n=r.split(/(\r?\n|\t)/),s=[],a=n.length;for(let i=0;i<a;i++){const o=n[i];o===`
`||o===`\r
`?s.push(Qc()):o==="	"?s.push(zm()):o!==""&&s.push(Ps(o))}return{node:s}}if(r=r.replace(/\r/g,"").replace(/[ \t\n]+/g," "),r==="")return{node:null};if(r[0]===" "){let n=t,s=!0;for(;n!==null&&(n=qP(n,!1))!==null;){const a=n.textContent||"";if(a.length>0){/[ \t\n]$/.test(a)&&(r=r.slice(1)),s=!1;break}}s&&(r=r.slice(1))}if(r[r.length-1]===" "){let n=t,s=!0;for(;n!==null&&(n=qP(n,!0))!==null;)if((n.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){s=!1;break}s&&(r=r.slice(0,r.length-1))}return r===""?{node:null}:{node:Ps(r)}}function qP(e,t){let r=e;for(;;){let n;for(;(n=t?r.nextSibling:r.previousSibling)===null;){const a=r.parentElement;if(a===null)return null;r=a}if(r=n,as(r)){const a=r.style.display;if(a===""&&!tE(r)||a!==""&&!a.startsWith("inline"))return null}let s=r;for(;(s=t?r.firstChild:r.lastChild)!==null;)r=s;if(ld(r))return r;if(r.nodeName==="BR")return null}}const zte={code:"code",em:"italic",i:"italic",mark:"highlight",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function Du(e){const t=zte[e.nodeName.toLowerCase()];return t===void 0?{node:null}:{forChild:m4(e.style,t),node:null}}function Ps(e=""){return ao(new Df(e))}function er(e){return e instanceof Df}function m4(e,t){const r=e.fontWeight,n=e.textDecoration.split(" "),s=r==="700"||r==="bold",a=n.includes("line-through"),i=e.fontStyle==="italic",o=n.includes("underline"),c=e.verticalAlign;return u=>(er(u)&&(s&&!u.hasFormat("bold")&&u.toggleFormat("bold"),a&&!u.hasFormat("strikethrough")&&u.toggleFormat("strikethrough"),i&&!u.hasFormat("italic")&&u.toggleFormat("italic"),o&&!u.hasFormat("underline")&&u.toggleFormat("underline"),c!=="sub"||u.hasFormat("subscript")||u.toggleFormat("subscript"),c!=="super"||u.hasFormat("superscript")||u.toggleFormat("superscript"),t&&!u.hasFormat(t)&&u.toggleFormat(t)),u)}class jv extends Df{static getType(){return"tab"}static clone(t){return new jv(t.__key)}constructor(t){super("	",t),this.__detail=2}static importDOM(){return null}createDOM(t){const r=super.createDOM(t),n=om(t.theme,"tab");return n!==void 0&&r.classList.add(...n),r}static importJSON(t){return zm().updateFromJSON(t)}setTextContent(t){return t!=="	"&&t!==""&&$t(126),super.setTextContent("	")}spliceText(t,r,n,s){return n===""&&r===0||n==="	"&&r===1||$t(286),this}setDetail(t){return t!==2&&$t(127),this}setMode(t){return t!=="normal"&&$t(128),this}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function zm(){return ao(new jv)}function W_(e){return e instanceof jv}class Wte{constructor(t,r,n){this._selection=null,this.key=t,this.offset=r,this.type=n}is(t){return this.key===t.key&&this.offset===t.offset&&this.type===t.type}isBefore(t){return this.key===t.key?this.offset<t.offset:I9(_l(td(this,"next")),_l(td(t,"next")))<0}getNode(){const t=la(this.key);return t===null&&$t(20),t}set(t,r,n,s){const a=this._selection,i=this.key;s&&this.key===t&&this.offset===r&&this.type===n||(this.key=t,this.offset=r,this.type=n,Pv()||(df()===i&&ci(t),a!==null&&(a.setCachedNodes(null),a.dirty=!0)))}}function Jc(e,t,r){return new Wte(e,t,r)}function ak(e,t){let r=t.__key,n=e.offset,s="element";if(er(t)){s="text";const a=t.getTextContentSize();n>a&&(n=a)}else if(!bt(t)){const a=t.getNextSibling();if(er(a))r=a.__key,n=0,s="text";else{const i=t.getParent();i&&(r=i.__key,n=t.getIndexWithinParent()+1)}}e.set(r,n,s)}function YP(e,t){if(bt(t)){const r=t.getLastDescendant();bt(r)||er(r)?ak(e,r):ak(e,t)}else ak(e,t)}class H_{constructor(t){this._cachedNodes=null,this._nodes=t,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){if(!Si(t))return!1;const r=this._nodes,n=t._nodes;return r.size===n.size&&Array.from(r).every((s=>n.has(s)))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(t){this.dirty=!0,this._nodes.add(t),this._cachedNodes=null}delete(t){this.dirty=!0,this._nodes.delete(t),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(t){return this._nodes.has(t)}clone(){return new H_(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(t){}insertText(){}insertNodes(t){const r=this.getNodes(),n=r.length,s=r[n-1];let a;if(er(s))a=s.select();else{const i=s.getIndexWithinParent()+1;a=s.getParentOrThrow().select(i,i)}a.insertNodes(t);for(let i=0;i<n;i++)r[i].remove()}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=this._nodes,n=[];for(const s of r){const a=la(s);a!==null&&n.push(a)}return Pv()||(this._cachedNodes=n),n}getTextContent(){const t=this.getNodes();let r="";for(let n=0;n<t.length;n++)r+=t[n].getTextContent();return r}deleteNodes(){const t=this.getNodes();if((Zt()||Wm())===this&&t[0]){const r=fi(t[0],"next");Ere(Cf(r,r))}for(const r of t)r.remove()}}function Ot(e){return e instanceof C0}class C0{constructor(t,r,n,s){this.anchor=t,this.focus=r,t._selection=this,r._selection=this,this._cachedNodes=null,this.format=n,this.style=s,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){return!!Ot(t)&&this.anchor.is(t.anchor)&&this.focus.is(t.focus)&&this.format===t.format&&this.style===t.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=(function(n){const s=[],[a,i]=n.getTextSlices();a&&s.push(a.caret.origin);const o=new Set,c=new Set;for(const u of n)if(Yc(u)){const{origin:d}=u;s.length===0?o.add(d):(c.add(d),s.push(d))}else{const{origin:d}=u;bt(d)&&c.has(d)||s.push(d)}if(i&&s.push(i.caret.origin),c0(n.focus)&&bt(n.focus.origin)&&n.focus.getNodeAtCaret()===null)for(let u=Nl(n.focus.origin,"previous");Yc(u)&&o.has(u.origin)&&!u.origin.isEmpty()&&u.origin.is(s[s.length-1]);u=M4(u))o.delete(u.origin),s.pop();for(;s.length>1;){const u=s[s.length-1];if(!bt(u)||c.has(u)||u.isEmpty()||o.has(u))break;s.pop()}if(s.length===0&&n.isCollapsed()){const u=_l(n.anchor),d=_l(n.anchor.getFlipped()),h=p=>xf(p)?p.origin:p.getNodeAtCaret(),g=h(u)||h(d)||(n.anchor.getNodeAtCaret()?u.origin:d.origin);s.push(g)}return s})(L9(_8(this),"next"));return Pv()||(this._cachedNodes=r),r}setTextNodeRange(t,r,n,s){this.anchor.set(t.__key,r,"text"),this.focus.set(n.__key,s,"text")}getTextContent(){const t=this.getNodes();if(t.length===0)return"";const r=t[0],n=t[t.length-1],s=this.anchor,a=this.focus,i=s.isBefore(a),[o,c]=qT(this);let u="",d=!0;for(let h=0;h<t.length;h++){const g=t[h];if(bt(g)&&!g.isInline())d||(u+=`
`),d=!g.isEmpty();else if(d=!1,er(g)){let p=g.getTextContent();g===r?g===n?s.type==="element"&&a.type==="element"&&a.offset!==s.offset||(p=o<c?p.slice(o,c):p.slice(c,o)):p=i?p.slice(o):p.slice(c):g===n&&(p=i?p.slice(0,c):p.slice(0,o)),u+=p}else!vn(g)&&!Vu(g)||g===n&&this.isCollapsed()||(u+=g.getTextContent())}return u}applyDOMRange(t){const r=Ss(),n=r.getEditorState()._selection,s=h9(t.startContainer,t.startOffset,t.endContainer,t.endOffset,r,n);if(s===null)return;const[a,i]=s;this.anchor.set(a.key,a.offset,a.type,!0),this.focus.set(i.key,i.offset,i.type,!0),vb(this)}clone(){const t=this.anchor,r=this.focus;return new C0(Jc(t.key,t.offset,t.type),Jc(r.key,r.offset,r.type),this.format,this.style)}toggleFormat(t){this.format=Ab(this.format,t,null),this.dirty=!0}setFormat(t){this.format=t,this.dirty=!0}setStyle(t){this.style=t,this.dirty=!0}hasFormat(t){const r=n0[t];return!!(this.format&r)}insertRawText(t){const r=t.split(/(\r?\n|\t)/),n=[],s=r.length;for(let a=0;a<s;a++){const i=r[a];i===`
`||i===`\r
`?n.push(Qc()):i==="	"?n.push(zm()):n.push(Ps(i))}this.insertNodes(n)}insertText(t){const r=this.anchor,n=this.focus,s=this.format,a=this.style;let i=r,o=n;!this.isCollapsed()&&n.isBefore(r)&&(i=n,o=r),i.type==="element"&&(function(w,C,k,b){const N=w.getNode(),E=N.getChildAtIndex(w.offset),P=Ps();if(P.setFormat(k),P.setStyle(b),_4(E))E.splice(0,0,[P]);else{const F=_a(N)?ss().append(P):P;E===null?N.append(F):E.insertBefore(F)}w.is(C)&&C.set(P.__key,0,"text"),w.set(P.__key,0,"text")})(i,o,s,a),o.type==="element"&&d0(o,_l(td(o,"next")));const c=i.offset;let u=o.offset;const d=this.getNodes(),h=d.length;let g=d[0];er(g)||$t(26);const p=g.getTextContent().length,x=g.getParentOrThrow();let v=d[h-1];if(h===1&&o.type==="element"&&(u=p,o.set(i.key,u,"text")),this.isCollapsed()&&c===p&&(Ru(g)||!g.canInsertTextAfter()||!x.canInsertTextAfter()&&g.getNextSibling()===null)){let w=g.getNextSibling();if(er(w)&&w.canInsertTextBefore()&&!Ru(w)||(w=Ps(),w.setFormat(s),w.setStyle(a),x.canInsertTextAfter()?g.insertAfter(w):x.insertAfter(w)),w.select(0,0),g=w,t!=="")return void this.insertText(t)}else if(this.isCollapsed()&&c===0&&(Ru(g)||!g.canInsertTextBefore()||!x.canInsertTextBefore()&&g.getPreviousSibling()===null)){let w=g.getPreviousSibling();if(er(w)&&!Ru(w)||(w=Ps(),w.setFormat(s),x.canInsertTextBefore()?g.insertBefore(w):x.insertBefore(w)),w.select(),g=w,t!=="")return void this.insertText(t)}else if(g.isSegmented()&&c!==p){const w=Ps(g.getTextContent());w.setFormat(s),g.replace(w),g=w}else if(!this.isCollapsed()&&t!==""){const w=v.getParent();if(!x.canInsertTextBefore()||!x.canInsertTextAfter()||bt(w)&&(!w.canInsertTextBefore()||!w.canInsertTextAfter()))return this.insertText(""),f9(this.anchor,this.focus,null),void this.insertText(t)}if(h===1){if(Wh(g)){const b=Ps(t);return b.select(),void g.replace(b)}const w=g.getFormat(),C=g.getStyle();if(c!==u||w===s&&C===a){if(W_(g)){const b=Ps(t);return b.setFormat(s),b.setStyle(a),b.select(),void g.replace(b)}}else{if(g.getTextContent()!==""){const b=Ps(t);if(b.setFormat(s),b.setStyle(a),b.select(),c===0)g.insertBefore(b,!1);else{const[N]=g.splitText(c);N.insertAfter(b,!1)}return void(b.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length))}g.setFormat(s),g.setStyle(a)}const k=u-c;g=g.spliceText(c,k,t,!0),g.getTextContent()===""?g.remove():this.anchor.type==="text"&&(g.isComposing()?this.anchor.offset-=t.length:(this.format=w,this.style=C))}else{const w=new Set([...g.getParentKeys(),...v.getParentKeys()]),C=bt(g)?g:g.getParentOrThrow();let k=bt(v)?v:v.getParentOrThrow(),b=v;if(!C.is(k)&&k.isInline())do b=k,k=k.getParentOrThrow();while(k.isInline());if(o.type==="text"&&(u!==0||v.getTextContent()==="")||o.type==="element"&&v.getIndexWithinParent()<u)if(er(v)&&!Wh(v)&&u!==v.getTextContentSize()){if(v.isSegmented()){const A=Ps(v.getTextContent());v.replace(A),v=A}_a(o.getNode())||o.type!=="text"||(v=v.spliceText(0,u,"")),w.add(v.__key)}else{const A=v.getParentOrThrow();A.canBeEmpty()||A.getChildrenSize()!==1?v.remove():A.remove()}else w.add(v.__key);const N=k.getChildren(),E=new Set(d),P=C.is(k),F=C.isInline()&&g.getNextSibling()===null?C:g;for(let A=N.length-1;A>=0;A--){const j=N[A];if(j.is(g)||bt(j)&&j.isParentOf(g))break;j.isAttached()&&(!E.has(j)||j.is(b)?P||F.insertAfter(j,!1):j.remove())}if(!P){let A=k,j=null;for(;A!==null;){const I=A.getChildren(),B=I.length;(B===0||I[B-1].is(j))&&(w.delete(A.__key),j=A),A=A.getParent()}}if(Wh(g))if(c===p)g.select();else{const A=Ps(t);A.select(),g.replace(A)}else g=g.spliceText(c,p-c,t,!0),g.getTextContent()===""?g.remove():g.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length);for(let A=1;A<h;A++){const j=d[A],I=j.__key;w.has(I)||j.remove()}}}removeText(){const t=Zt()===this;sb(this,Nre(_8(this))),t&&Zt()!==this&&hi(this)}formatText(t,r=null){if(this.isCollapsed())return this.toggleFormat(t),void ci(null);const n=this.getNodes(),s=[];for(const N of n)er(N)&&s.push(N);const a=N=>{n.forEach((E=>{if(bt(E)){const P=E.getFormatFlags(t,N);E.setTextFormat(P)}}))},i=s.length;if(i===0)return this.toggleFormat(t),ci(null),void a(r);const o=this.anchor,c=this.focus,u=this.isBackward(),d=u?c:o,h=u?o:c;let g=0,p=s[0],x=d.type==="element"?0:d.offset;if(d.type==="text"&&x===p.getTextContentSize()&&(g=1,p=s[1],x=0),p==null)return;const v=p.getFormatFlags(t,r);a(v);const w=i-1;let C=s[w];const k=h.type==="text"?h.offset:C.getTextContentSize();if(p.is(C)){if(x===k)return;if(Ru(p)||x===0&&k===p.getTextContentSize())p.setFormat(v);else{const N=p.splitText(x,k),E=x===0?N[0]:N[1];E.setFormat(v),d.type==="text"&&d.set(E.__key,0,"text"),h.type==="text"&&h.set(E.__key,k-x,"text")}return void(this.format=v)}x===0||Ru(p)||([,p]=p.splitText(x),x=0),p.setFormat(v);const b=C.getFormatFlags(t,v);k>0&&(k===C.getTextContentSize()||Ru(C)||([C]=C.splitText(k)),C.setFormat(b));for(let N=g+1;N<w;N++){const E=s[N],P=E.getFormatFlags(t,b);E.setFormat(P)}d.type==="text"&&d.set(p.__key,x,"text"),h.type==="text"&&h.set(C.__key,k,"text"),this.format=v|b}insertNodes(t){if(t.length===0)return;if(this.isCollapsed()||this.removeText(),this.anchor.key==="root"){this.insertParagraph();const x=Zt();return Ot(x)||$t(134),x.insertNodes(t)}const r=(this.isBackward()?this.focus:this.anchor).getNode(),n=uk(r,bl),s=t[t.length-1];if(bt(n)&&"__language"in n){if("__language"in t[0])this.insertText(t[0].getTextContent());else{const x=ik(this);n.splice(x,0,t),s.selectEnd()}return}if(!t.some((x=>(bt(x)||vn(x))&&!x.isInline()))){bt(n)||$t(211,r.constructor.name,r.getType());const x=ik(this);return n.splice(x,0,t),void s.selectEnd()}const a=(function(x){const v=ss();let w=null;for(let C=0;C<x.length;C++){const k=x[C],b=Vu(k);if(b||vn(k)&&k.isInline()||bt(k)&&k.isInline()||er(k)||k.isParentRequired()){if(w===null&&(w=k.createParentElementNode(),v.append(w),b))continue;w!==null&&w.append(k)}else v.append(k),w=null}return v})(t),i=a.getLastDescendant(),o=a.getChildren(),c=!bt(n)||!n.isEmpty()?this.insertParagraph():null,u=o[o.length-1];let d=o[0];var h;bt(h=d)&&bl(h)&&!h.isEmpty()&&bt(n)&&(!n.isEmpty()||n.canMergeWhenEmpty())&&(bt(n)||$t(211,r.constructor.name,r.getType()),n.append(...d.getChildren()),d=o[1]),d&&(n===null&&$t(212,r.constructor.name,r.getType()),(function(x,v,w){const C=v.getParentOrThrow().getLastChild();let k=v;const b=[v];for(;k!==C;)k.getNextSibling()||$t(140),k=k.getNextSibling(),b.push(k);let N=x;for(const E of b)N=N.insertAfter(E)})(n,d));const g=uk(i,bl);c&&bt(g)&&(c.canMergeWhenEmpty()||bl(u))&&(g.append(...c.getChildren()),c.remove()),bt(n)&&n.isEmpty()&&n.remove(),i.selectEnd();const p=bt(n)?n.getLastChild():null;Vu(p)&&g!==n&&p.remove()}insertParagraph(){if(this.anchor.key==="root"){const i=ss();return ps().splice(this.anchor.offset,0,[i]),i.select(),i}const t=ik(this),r=uk(this.anchor.getNode(),bl);bt(r)||$t(213);const n=r.getChildAtIndex(t),s=n?[n,...n.getNextSiblings()]:[],a=r.insertNewAfter(this,!1);return a?(a.append(...s),a.selectStart(),a):null}insertLineBreak(t){const r=Qc();if(this.insertNodes([r]),t){const n=r.getParentOrThrow(),s=r.getIndexWithinParent();n.select(s,s)}}extract(){const t=this.getNodes(),r=t.length,n=r-1,s=this.anchor,a=this.focus;let i=t[0],o=t[n];const[c,u]=qT(this);if(r===0)return[];if(r===1){if(er(i)&&!this.isCollapsed()){const h=c>u?u:c,g=c>u?c:u,p=i.splitText(h,g),x=h===0?p[0]:p[1];return x!=null?[x]:[]}return[i]}const d=s.isBefore(a);if(er(i)){const h=d?c:u;h===i.getTextContentSize()?t.shift():h!==0&&([,i]=i.splitText(h),t[0]=i)}if(er(o)){const h=o.getTextContent().length,g=d?u:c;g===0?t.pop():g!==h&&([o]=o.splitText(g),t[n]=o)}return t}modify(t,r,n){if(n8(this,t,r,n))return;const s=t==="move",a=Ss(),i=dc(El(a));if(!i)return;const o=a._blockCursorElement,c=a._rootElement,u=this.focus.getNode();if(c===null||o===null||!bt(u)||u.isInline()||u.canBeEmpty()||ZT(o,a,c),this.dirty){let d=i0(a,this.anchor.key),h=i0(a,this.focus.key);this.anchor.type==="text"&&(d=bm(d)),this.focus.type==="text"&&(h=bm(h)),d&&h&&m9(i,d,this.anchor.offset,h,this.focus.offset)}if((function(d,h,g,p){d.modify(h,g,p)})(i,t,r?"backward":"forward",n),i.rangeCount>0){const d=i.getRangeAt(0),h=this.anchor.getNode(),g=_a(h)?h:fre(h);if(this.applyDOMRange(d),this.dirty=!0,!s){const p=this.getNodes(),x=[];let v=!1;for(let w=0;w<p.length;w++){const C=p[w];JT(C,g)?x.push(C):v=!0}if(v&&x.length>0)if(r){const w=x[0];bt(w)?w.selectStart():w.getParentOrThrow().selectStart()}else{const w=x[x.length-1];bt(w)?w.selectEnd():w.getParentOrThrow().selectEnd()}i.anchorNode===d.startContainer&&i.anchorOffset===d.startOffset||(function(w){const C=w.focus,k=w.anchor,b=k.key,N=k.offset,E=k.type;k.set(C.key,C.offset,C.type,!0),C.set(b,N,E,!0)})(this)}}n==="lineboundary"&&n8(this,t,r,n,"decorators")}forwardDeletion(t,r,n){if(!n&&(t.type==="element"&&bt(r)&&t.offset===r.getChildrenSize()||t.type==="text"&&t.offset===r.getTextContentSize())){const s=r.getParent(),a=r.getNextSibling()||(s===null?null:s.getNextSibling());if(bt(a)&&a.isShadowRoot())return!0}return!1}deleteCharacter(t){const r=this.isCollapsed();if(this.isCollapsed()){const n=this.anchor;let s=n.getNode();if(this.forwardDeletion(n,s,t))return;const a=B4(td(n,t?"previous":"next"));if(a.getTextSlices().every((o=>o===null||o.distance===0))){let o={type:"initial"};for(const c of a.iterNodeCarets("shadowRoot"))if(Yc(c)){if(!c.origin.isInline()){if(c.origin.isShadowRoot()){if(o.type==="merge-block")break;if(bt(a.anchor.origin)&&a.anchor.origin.isEmpty()){const u=_l(c);sb(this,Cf(u,u)),a.anchor.origin.remove()}return}o.type!=="merge-next-block"&&o.type!=="merge-block"||(o={block:o.block,caret:c,type:"merge-block"})}}else{if(o.type==="merge-block")break;if(c0(c)){if(bt(c.origin)){if(c.origin.isInline()){if(!c.origin.isParentOf(a.anchor.origin))break}else o={block:c.origin,type:"merge-next-block"};continue}if(vn(c.origin)){if(!c.origin.isIsolated())if(o.type==="merge-next-block"&&(c.origin.isKeyboardSelectable()||!c.origin.isInline())&&bt(a.anchor.origin)&&a.anchor.origin.isEmpty()){a.anchor.origin.remove();const u=p4();u.add(c.origin.getKey()),hi(u)}else c.origin.remove();return}break}}if(o.type==="merge-block"){const{caret:c,block:u}=o;return sb(this,Cf(!c.origin.isEmpty()&&u.isEmpty()?U4(fi(u,c.direction)):a.anchor,c)),this.removeText()}}const i=this.focus;if(this.modify("extend",t,"character"),this.isCollapsed()){if(t&&n.offset===0&&QP(this,n.getNode()))return}else{const o=i.type==="text"?i.getNode():null;if(s=n.type==="text"?n.getNode():null,o!==null&&o.isSegmented()){const c=i.offset,u=o.getTextContentSize();if(o.is(s)||t&&c!==u||!t&&c!==0)return void JP(o,t,c)}else if(s!==null&&s.isSegmented()){const c=n.offset,u=s.getTextContentSize();if(s.is(o)||t&&c!==0||!t&&c!==u)return void JP(s,t,c)}(function(c,u){const d=c.anchor,h=c.focus,g=d.getNode(),p=h.getNode();if(g===p&&d.type==="text"&&h.type==="text"){const x=d.offset,v=h.offset,w=x<v,C=w?x:v,k=w?v:x,b=k-1;C!==b&&(function(N){return!(A9(N)||Hte(N))})(g.getTextContent().slice(C,k))&&(u?h.set(h.key,b,h.type):d.set(d.key,b,d.type))}})(this,t)}}if(this.removeText(),t&&!r&&this.isCollapsed()&&this.anchor.type==="element"&&this.anchor.offset===0){const n=this.anchor.getNode();n.isEmpty()&&_a(n.getParent())&&n.getPreviousSibling()===null&&QP(this,n)}}deleteLine(t){this.isCollapsed()&&this.modify("extend",t,"lineboundary"),this.isCollapsed()?this.deleteCharacter(t):this.removeText()}deleteWord(t){if(this.isCollapsed()){const r=this.anchor,n=r.getNode();if(this.forwardDeletion(r,n,t))return;this.modify("extend",t,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function Si(e){return e instanceof H_}function XP(e){const t=e.offset;if(e.type==="text")return t;const r=e.getNode();return t===r.getChildrenSize()?r.getTextContent().length:0}function qT(e){const t=e.getStartEndPoints();if(t===null)return[0,0];const[r,n]=t;return r.type==="element"&&n.type==="element"&&r.key===n.key&&r.offset===n.offset?[0,0]:[XP(r),XP(n)]}function QP(e,t){for(let r=t;r;r=r.getParent()){if(bt(r)){if(r.collapseAtStart(e))return!0;if(ro(r))break}if(r.getPreviousSibling())break}return!1}const Hte=(()=>{try{const e=new RegExp("\\p{Emoji}","u"),t=e.test.bind(e);if(t("")&&t("#")&&t(""))return t}catch{}return()=>!1})();function JP(e,t,r){const n=e,s=n.getTextContent().split(/(?=\s)/g),a=s.length;let i=0,o=0;for(let u=0;u<a;u++){const d=u===a-1;if(o=i,i+=s[u].length,t&&i===r||i>r||d){s.splice(u,1),d&&(o=void 0);break}}const c=s.join("").trim();c===""?n.remove():(n.setTextContent(c),n.select(o,o))}function ZP(e,t,r,n){let s,a=t;if(as(e)){let i=!1;const o=e.childNodes,c=o.length,u=n._blockCursorElement;a===c&&(i=!0,a=c-1);let d=o[a],h=!1;if(d===u)d=o[a+1],h=!0;else if(u!==null){const g=u.parentNode;e===g&&t>Array.prototype.indexOf.call(g.children,u)&&a--}if(s=Zg(d),er(s))a=yf(s,i?"next":"previous");else{let g=Zg(e);if(g===null)return null;if(bt(g)){const p=n.getElementByKey(g.getKey());p===null&&$t(214),[g,a]=g.getDOMSlot(p).resolveChildIndex(g,p,e,t),bt(g)||$t(215),i&&a>=g.getChildrenSize()&&(a=Math.max(0,g.getChildrenSize()-1));let v=g.getChildAtIndex(a);if(bt(v)&&(function(w,C,k){const b=w.getParent();return k===null||b===null||!b.canBeEmpty()||b!==k.getNode()})(v,0,r)){const w=i?v.getLastDescendant():v.getFirstDescendant();w===null?g=v:(v=w,g=bt(v)?v:v.getParentOrThrow()),a=0}er(v)?(s=v,g=null,a=yf(v,i?"next":"previous")):v!==g&&i&&!h&&(bt(g)||$t(216),a=Math.min(g.getChildrenSize(),a+1))}else{const p=g.getIndexWithinParent();a=t===0&&vn(g)&&Zg(e)===g?p:p+1,g=g.getParentOrThrow()}if(bt(g))return Jc(g.__key,a,"element")}}else s=Zg(e);return er(s)?Jc(s.__key,yf(s,a,"clamp"),"text"):null}function e8(e,t,r){const n=e.offset,s=e.getNode();if(n===0){const a=s.getPreviousSibling(),i=s.getParent();if(t){if((r||!t)&&a===null&&bt(i)&&i.isInline()){const o=i.getPreviousSibling();er(o)&&e.set(o.__key,o.getTextContent().length,"text")}}else bt(a)&&!r&&a.isInline()?e.set(a.__key,a.getChildrenSize(),"element"):er(a)&&e.set(a.__key,a.getTextContent().length,"text")}else if(n===s.getTextContent().length){const a=s.getNextSibling(),i=s.getParent();if(t&&bt(a)&&a.isInline())e.set(a.__key,0,"element");else if((r||t)&&a===null&&bt(i)&&i.isInline()&&!i.canInsertTextAfter()){const o=i.getNextSibling();er(o)&&e.set(o.__key,0,"text")}}}function f9(e,t,r){if(e.type==="text"&&t.type==="text"){const n=e.isBefore(t),s=e.is(t);e8(e,n,s),e8(t,!n,s),s&&t.set(e.key,e.offset,e.type);const a=Ss();if(a.isComposing()&&a._compositionKey!==e.key&&Ot(r)){const i=r.anchor,o=r.focus;e.set(i.key,i.offset,i.type,!0),t.set(o.key,o.offset,o.type,!0)}}}function h9(e,t,r,n,s,a){if(e===null||r===null||!Dv(s,e,r))return null;const i=ZP(e,t,Ot(a)?a.anchor:null,s);if(i===null)return null;const o=ZP(r,n,Ot(a)?a.focus:null,s);if(o===null)return null;if(i.type==="element"&&o.type==="element"){const c=Zg(e),u=Zg(r);if(vn(c)&&vn(u))return null}return f9(i,o,a),[i,o]}function YT(e){return bt(e)&&!e.isInline()}function g9(e,t,r,n,s,a){const i=If(),o=new C0(Jc(e,t,s),Jc(r,n,a),0,"");return o.dirty=!0,i._selection=o,o}function G_(){const e=Jc("root",0,"element"),t=Jc("root",0,"element");return new C0(e,t,0,"")}function p4(){return new H_(new Set)}function x4(e,t,r,n){const s=r._window;if(s===null)return null;const a=n||s.event,i=a?a.type:void 0,o=i==="selectionchange",c=!OT&&(o||i==="beforeinput"||i==="compositionstart"||i==="compositionend"||i==="click"&&a&&a.detail===3||i==="drop"||i===void 0);let u,d,h,g;if(Ot(e)&&!c)return e.clone();if(t===null)return null;if(u=t.anchorNode,d=t.focusNode,h=t.anchorOffset,g=t.focusOffset,o&&Ot(e)&&!Dv(r,u,d))return e.clone();const p=h9(u,h,d,g,r,e);if(p===null)return null;const[x,v]=p;return new C0(x,v,Ot(e)?e.format:0,Ot(e)?e.style:"")}function Zt(){return If()._selection}function Wm(){return Ss()._editorState._selection}function Tb(e,t,r,n=1){const s=e.anchor,a=e.focus,i=s.getNode(),o=a.getNode();if(!t.is(i)&&!t.is(o))return;const c=t.__key;if(e.isCollapsed()){const u=s.offset;if(r<=u&&n>0||r<u&&n<0){const d=Math.max(0,u+n);s.set(c,d,"element"),a.set(c,d,"element"),t8(e)}}else{const u=e.isBackward(),d=u?a:s,h=d.getNode(),g=u?s:a,p=g.getNode();if(t.is(h)){const x=d.offset;(r<=x&&n>0||r<x&&n<0)&&d.set(c,Math.max(0,x+n),"element")}if(t.is(p)){const x=g.offset;(r<=x&&n>0||r<x&&n<0)&&g.set(c,Math.max(0,x+n),"element")}}t8(e)}function t8(e){const t=e.anchor,r=t.offset,n=e.focus,s=n.offset,a=t.getNode(),i=n.getNode();if(e.isCollapsed()){if(!bt(a))return;const o=a.getChildrenSize(),c=r>=o,u=c?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(er(u)){let d=0;c&&(d=u.getTextContentSize()),t.set(u.__key,d,"text"),n.set(u.__key,d,"text")}}else{if(bt(a)){const o=a.getChildrenSize(),c=r>=o,u=c?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(er(u)){let d=0;c&&(d=u.getTextContentSize()),t.set(u.__key,d,"text")}}if(bt(i)){const o=i.getChildrenSize(),c=s>=o,u=c?i.getChildAtIndex(o-1):i.getChildAtIndex(s);if(er(u)){let d=0;c&&(d=u.getTextContentSize()),n.set(u.__key,d,"text")}}}}function Eb(e,t,r,n,s){let a=null,i=0,o=null;n!==null?(a=n.__key,er(n)?(i=n.getTextContentSize(),o="text"):bt(n)&&(i=n.getChildrenSize(),o="element")):s!==null&&(a=s.__key,er(s)?o="text":bt(s)&&(o="element")),a!==null&&o!==null?e.set(a,i,o):(i=t.getIndexWithinParent(),i===-1&&(i=r.getChildrenSize()),e.set(r.__key,i,"element"))}function r8(e,t,r,n,s){e.type==="text"?e.set(r,e.offset+(t?0:s),"text"):e.offset>n.getIndexWithinParent()&&e.set(e.key,e.offset-1,"element")}function m9(e,t,r,n,s){try{e.setBaseAndExtent(t,r,n,s)}catch{}}function Gte(e,t,r,n,s,a,i){const o=n.anchorNode,c=n.focusNode,u=n.anchorOffset,d=n.focusOffset,h=document.activeElement;if(s.has(b9)&&h!==a||h!==null&&C4(h))return;if(!Ot(t))return void(e!==null&&Dv(r,o,c)&&n.removeAllRanges());const g=t.anchor,p=t.focus,x=g.key,v=p.key,w=i0(r,x),C=i0(r,v),k=g.offset,b=p.offset,N=t.format,E=t.style,P=t.isCollapsed();let F=w,A=C,j=!1;if(g.type==="text"){F=bm(w);const ee=g.getNode();j=ee.getFormat()!==N||ee.getStyle()!==E}else Ot(e)&&e.anchor.type==="text"&&(j=!0);var I,B,Y,Z,ae;if(p.type==="text"&&(A=bm(C)),F!==null&&A!==null&&(P&&(e===null||j||Ot(e)&&(e.format!==N||e.style!==E))&&(I=N,B=E,Y=k,Z=x,ae=performance.now(),s9=[I,B,Y,Z,ae]),u!==k||d!==b||o!==F||c!==A||n.type==="Range"&&P||(h!==null&&a.contains(h)||a.focus({preventScroll:!0}),g.type==="element"))){if(m9(n,F,k,A,b),!s.has(Jte)&&t.isCollapsed()&&a!==null&&a===document.activeElement){const ee=Ot(t)&&t.anchor.type==="element"?F.childNodes[k]||null:n.rangeCount>0?n.getRangeAt(0):null;if(ee!==null){let ne;if(ee instanceof Text){const L=document.createRange();L.selectNode(ee),ne=L.getBoundingClientRect()}else ne=ee.getBoundingClientRect();(function(L,H,M){const V=O9(M),W=P4(V);if(V===null||W===null)return;let{top:R,bottom:U}=H,q=0,Q=0,se=M;for(;se!==null;){const X=se===V.body;if(X)q=0,Q=El(L).innerHeight;else{const le=se.getBoundingClientRect();q=le.top,Q=le.bottom}let ie=0;if(R<q?ie=-(q-R):U>Q&&(ie=U-Q),ie!==0)if(X)W.scrollBy(0,ie);else{const le=se.scrollTop;se.scrollTop+=ie;const ce=se.scrollTop-le;R-=ce,U-=ce}if(X)break;se=Iv(se)}})(r,ne,a)}}GT=!0}}function Vte(e){let t=Zt()||Wm();t===null&&(t=ps().selectEnd()),t.insertNodes(e)}function ik(e){let t=e;e.isCollapsed()||t.removeText();const r=Zt();Ot(r)&&(t=r),Ot(t)||$t(161);const n=t.anchor;let s=n.getNode(),a=n.offset;for(;!bl(s);){const i=s;if([s,a]=Kte(s,a),i.is(s))break}return a}function Kte(e,t){const r=e.getParent();if(!r){const s=ss();return ps().append(s),s.select(),[ps(),0]}if(er(e)){const s=e.splitText(t);if(s.length===0)return[r,e.getIndexWithinParent()];const a=t===0?0:1;return[r,s[0].getIndexWithinParent()+a]}if(!bt(e)||t===0)return[r,e.getIndexWithinParent()];const n=e.getChildAtIndex(t);if(n){const s=new C0(Jc(e.__key,t,"element"),Jc(e.__key,t,"element"),0,""),a=e.insertNewAfter(s);a&&a.append(n,...n.getNextSiblings())}return[r,e.getIndexWithinParent()+1]}function n8(e,t,r,n,s="decorators-and-blocks"){if(t==="move"&&n==="character"&&!e.isCollapsed()){const[d,h]=r===e.isBackward()?[e.focus,e.anchor]:[e.anchor,e.focus];return h.set(d.key,d.offset,d.type),!0}const a=td(e.focus,r?"previous":"next"),i=n==="lineboundary",o=t==="move";let c=a,u=s==="decorators-and-blocks";if(!M9(c)){for(const d of c){u=!1;const{origin:h}=d;if(!vn(h)||h.isIsolated()||(c=d,!i||!h.isInline()))break}if(u)for(const d of B4(a).iterNodeCarets(t==="extend"?"shadowRoot":"root")){if(Yc(d))d.origin.isInline()||(c=d);else{if(bt(d.origin))continue;vn(d.origin)&&!d.origin.isInline()&&(c=d)}break}}if(c===a)return!1;if(o&&!i&&vn(c.origin)&&c.origin.isKeyboardSelectable()){const d=p4();return d.add(c.origin.getKey()),hi(d),!0}return c=_l(c),o&&d0(e.anchor,c),d0(e.focus,c),u||!i}let Ra=null,Ma=null,So=!1,ok=!1,rb=0;const s8={characterData:!0,childList:!0,subtree:!0};function Pv(){return So||Ra!==null&&Ra._readOnly}function li(){So&&$t(13)}function p9(){rb>99&&$t(14)}function If(){return Ra===null&&$t(195,x9()),Ra}function Ss(){return Ma===null&&$t(196,x9()),Ma}function x9(){let e=0;const t=new Set,r=q_.version;if(typeof window<"u")for(const s of document.querySelectorAll("[contenteditable]")){const a=Y_(s);if(T4(a))e++;else if(a){let i=String(a.constructor.version||"<0.17.1");i===r&&(i+=" (separately built, likely a bundler configuration issue)"),t.add(i)}}let n=` Detected on the page: ${e} compatible editor(s) with version ${r}`;return t.size&&(n+=` and incompatible editors with versions ${Array.from(t).join(", ")}`),n}function qte(){return Ma}function a8(e,t,r){const n=t.__type,s=S9(e,n);let a=r.get(n);a===void 0&&(a=Array.from(s.transforms),r.set(n,a));const i=a.length;for(let o=0;o<i&&(a[o](t),t.isAttached());o++);}function i8(e,t){return e!==void 0&&e.__key!==t&&e.isAttached()}function y9(e,t){if(!t)return;const r=e._updateTags;let n=t;Array.isArray(t)||(n=[t]);for(const s of n)r.add(s)}function Yte(e){return y4(e,Ss()._nodes)}function y4(e,t){const r=e.type,n=t.get(r);n===void 0&&$t(17,r);const s=n.klass;e.type!==s.getType()&&$t(18,s.name);const a=s.importJSON(e),i=e.children;if(bt(a)&&Array.isArray(i))for(let o=0;o<i.length;o++){const c=y4(i[o],t);a.append(c)}return a}function o8(e,t,r){const n=Ra,s=So,a=Ma;Ra=t,So=!0,Ma=e;try{return r()}finally{Ra=n,So=s,Ma=a}}function Lu(e,t){const r=e._pendingEditorState,n=e._rootElement,s=e._headless||n===null;if(r===null)return;const a=e._editorState,i=a._selection,o=r._selection,c=e._dirtyType!==r0,u=Ra,d=So,h=Ma,g=e._updating,p=e._observer;let x=null;if(e._pendingEditorState=null,e._editorState=r,!s&&c&&p!==null){Ma=e,Ra=r,So=!1,e._updating=!0;try{const P=e._dirtyType,F=e._dirtyElements,A=e._dirtyLeaves;p.disconnect(),x=Ste(a,r,e,P,F,A)}catch(P){if(P instanceof Error&&e._onError(P),ok)throw P;return _9(e,null,n,r),IL(e),e._dirtyType=wm,ok=!0,Lu(e,a),void(ok=!1)}finally{p.observe(n,s8),e._updating=g,Ra=u,So=d,Ma=h}}r._readOnly||(r._readOnly=!0);const v=e._dirtyLeaves,w=e._dirtyElements,C=e._normalizedNodes,k=e._updateTags,b=e._deferred;c&&(e._dirtyType=r0,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements=new Map,e._normalizedNodes=new Set,e._updateTags=new Set),(function(P,F){const A=P._decorators;let j=P._pendingDecorators||A;const I=F._nodeMap;let B;for(B in j)I.has(B)||(j===A&&(j=E9(P)),delete j[B])})(e,r);const N=s?null:dc(El(e));if(e._editable&&N!==null&&(c||o===null||o.dirty)&&n!==null&&!k.has(Zte)){Ma=e,Ra=r;try{if(p!==null&&p.disconnect(),c||o===null||o.dirty){const P=e._blockCursorElement;P!==null&&ZT(P,e,n),Gte(i,o,e,N,k,n)}(function(P,F,A){let j=P._blockCursorElement;if(Ot(A)&&A.isCollapsed()&&A.anchor.type==="element"&&F.contains(document.activeElement)){const I=A.anchor,B=I.getNode(),Y=I.offset;let Z=!1,ae=null;if(Y===B.getChildrenSize())ck(B.getChildAtIndex(Y-1))&&(Z=!0);else{const ee=B.getChildAtIndex(Y);if(ee!==null&&ck(ee)){const ne=ee.getPreviousSibling();(ne===null||ck(ne))&&(Z=!0,ae=P.getElementByKey(ee.__key))}}if(Z){const ee=P.getElementByKey(B.__key);return j===null&&(P._blockCursorElement=j=(function(ne){const L=ne.theme,H=document.createElement("div");H.contentEditable="false",H.setAttribute("data-lexical-cursor","true");let M=L.blockCursor;if(M!==void 0){if(typeof M=="string"){const V=jL(M);M=L.blockCursor=V}M!==void 0&&H.classList.add(...M)}return H})(P._config)),F.style.caretColor="transparent",void(ae===null?ee.appendChild(j):ee.insertBefore(j,ae))}}j!==null&&ZT(j,P,F)})(e,n,o)}finally{p!==null&&p.observe(n,s8),Ma=h,Ra=u}}x!==null&&(function(P,F,A,j,I){const B=Array.from(P._listeners.mutation),Y=B.length;for(let Z=0;Z<Y;Z++){const[ae,ee]=B[Z];for(const ne of ee){const L=F.get(ne);L!==void 0&&ae(L,{dirtyLeaves:j,prevEditorState:I,updateTags:A})}}})(e,x,k,v,a),Ot(o)||o===null||i!==null&&i.is(o)||e.dispatchCommand(zL,void 0);const E=e._pendingDecorators;E!==null&&(e._decorators=E,e._pendingDecorators=null,by("decorator",e,!0,E)),(function(P,F,A){const j=f8(F),I=f8(A);j!==I&&by("textcontent",P,!0,I)})(e,t||a,r),by("update",e,!0,{dirtyElements:w,dirtyLeaves:v,editorState:r,mutatedNodes:x,normalizedNodes:C,prevEditorState:t||a,tags:k}),(function(P,F){if(P._deferred=[],F.length!==0){const A=P._updating;P._updating=!0;try{for(let j=0;j<F.length;j++)F[j]()}finally{P._updating=A}}})(e,b),(function(P){const F=P._updates;if(F.length!==0){const A=F.shift();if(A){const[j,I]=A;V_(P,j,I)}}})(e)}function by(e,t,r,...n){const s=t._updating;t._updating=r;try{const a=Array.from(t._listeners[e]);for(let i=0;i<a.length;i++)a[i].apply(null,n)}finally{t._updating=s}}function l8(e,t){const r=e._updates;let n=t||!1;for(;r.length!==0;){const s=r.shift();if(s){const[a,i]=s,o=e._pendingEditorState;let c;i!==void 0&&(c=i.onUpdate,i.skipTransforms&&(n=!0),i.discrete&&(o===null&&$t(191),o._flushSync=!0),c&&e._deferred.push(c),y9(e,i.tag)),o==null?V_(e,a,i):a()}}return n}function V_(e,t,r){const n=e._updateTags;let s,a=!1,i=!1;r!==void 0&&(s=r.onUpdate,y9(e,r.tag),a=r.skipTransforms||!1,i=r.discrete||!1),s&&e._deferred.push(s);const o=e._editorState;let c=e._pendingEditorState,u=!1;(c===null||c._readOnly)&&(c=e._pendingEditorState=v9(c||o),u=!0),c._flushSync=i;const d=Ra,h=So,g=Ma,p=e._updating;Ra=c,So=!1,e._updating=!0,Ma=e;const x=e._headless||e.getRootElement()===null;S4(null);try{u&&(x?o._selection!==null&&(c._selection=o._selection.clone()):c._selection=(function(k,b){const N=k.getEditorState()._selection,E=dc(El(k));return Ot(N)||N==null?x4(N,E,k,b):N.clone()})(e,r&&r.event||null));const w=e._compositionKey;t(),a=l8(e,a),(function(k,b){const N=b.getEditorState()._selection,E=k._selection;if(Ot(E)){const P=E.anchor,F=E.focus;let A;if(P.type==="text"&&(A=P.getNode(),A.selectionTransform(N,E)),F.type==="text"){const j=F.getNode();A!==j&&j.selectionTransform(N,E)}}})(c,e),e._dirtyType!==r0&&(a?(function(k,b){const N=b._dirtyLeaves,E=k._nodeMap;for(const P of N){const F=E.get(P);er(F)&&F.isAttached()&&F.isSimpleText()&&!F.isUnmergeable()&&LP(F)}})(c,e):(function(k,b){const N=b._dirtyLeaves,E=b._dirtyElements,P=k._nodeMap,F=df(),A=new Map;let j=N,I=j.size,B=E,Y=B.size;for(;I>0||Y>0;){if(I>0){b._dirtyLeaves=new Set;for(const Z of j){const ae=P.get(Z);er(ae)&&ae.isAttached()&&ae.isSimpleText()&&!ae.isUnmergeable()&&LP(ae),ae!==void 0&&i8(ae,F)&&a8(b,ae,A),N.add(Z)}if(j=b._dirtyLeaves,I=j.size,I>0){rb++;continue}}b._dirtyLeaves=new Set,b._dirtyElements=new Map,B.delete("root")&&B.set("root",!0);for(const Z of B){const ae=Z[0],ee=Z[1];if(E.set(ae,ee),!ee)continue;const ne=P.get(ae);ne!==void 0&&i8(ne,F)&&a8(b,ne,A)}j=b._dirtyLeaves,I=j.size,B=b._dirtyElements,Y=B.size,rb++}b._dirtyLeaves=N,b._dirtyElements=E})(c,e),l8(e),(function(k,b,N,E){const P=k._nodeMap,F=b._nodeMap,A=[];for(const[j]of E){const I=F.get(j);I!==void 0&&(I.isAttached()||(bt(I)&&FL(I,j,P,F,A,E),P.has(j)||E.delete(j),A.push(j)))}for(const j of A)F.delete(j);for(const j of N){const I=F.get(j);I===void 0||I.isAttached()||(P.has(j)||N.delete(j),F.delete(j))}})(o,c,e._dirtyLeaves,e._dirtyElements)),w!==e._compositionKey&&(c._flushSync=!0);const C=c._selection;if(Ot(C)){const k=c._nodeMap,b=C.anchor.key,N=C.focus.key;k.get(b)!==void 0&&k.get(N)!==void 0||$t(19)}else Si(C)&&C._nodes.size===0&&(c._selection=null)}catch(w){return w instanceof Error&&e._onError(w),e._pendingEditorState=o,e._dirtyType=wm,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),void Lu(e)}finally{Ra=d,So=h,Ma=g,e._updating=p,rb=0}e._dirtyType!==r0||e._deferred.length>0||(function(w,C){const k=C.getEditorState()._selection,b=w._selection;if(b!==null){if(b.dirty||!b.is(k))return!0}else if(k!==null)return!0;return!1})(c,e)?c._flushSync?(c._flushSync=!1,Lu(e)):u&&sre((()=>{Lu(e)})):(c._flushSync=!1,u&&(n.clear(),e._deferred=[],e._pendingEditorState=null))}function $o(e,t,r){Ma===e&&r===void 0?t():V_(e,t,r)}class _y{constructor(t,r,n){this.element=t,this.before=r||null,this.after=n||null}withBefore(t){return new _y(this.element,t,this.after)}withAfter(t){return new _y(this.element,this.before,t)}withElement(t){return this.element===t?this:new _y(t,this.before,this.after)}insertChild(t){const r=this.before||this.getManagedLineBreak();return r!==null&&r.parentElement!==this.element&&$t(222),this.element.insertBefore(t,r),this}removeChild(t){return t.parentElement!==this.element&&$t(223),this.element.removeChild(t),this}replaceChild(t,r){return r.parentElement!==this.element&&$t(224),this.element.replaceChild(t,r),this}getFirstChild(){const t=this.after?this.after.nextSibling:this.element.firstChild;return t===this.before||t===this.getManagedLineBreak()?null:t}getManagedLineBreak(){return this.element.__lexicalLineBreak||null}setManagedLineBreak(t){if(t===null)this.removeManagedLineBreak();else{const r=t==="decorator"&&(vm||Wy);this.insertManagedLineBreak(r)}}removeManagedLineBreak(){const t=this.getManagedLineBreak();if(t){const r=this.element,n=t.nodeName==="IMG"?t.nextSibling:null;n&&r.removeChild(n),r.removeChild(t),r.__lexicalLineBreak=void 0}}insertManagedLineBreak(t){const r=this.getManagedLineBreak();if(r){if(t===(r.nodeName==="IMG"))return;this.removeManagedLineBreak()}const n=this.element,s=this.before,a=document.createElement("br");if(n.insertBefore(a,s),t){const i=document.createElement("img");i.setAttribute("data-lexical-linebreak","true"),i.style.cssText="display: inline !important; border: 0px !important; margin: 0px !important;",i.alt="",n.insertBefore(i,a),n.__lexicalLineBreak=i}else n.__lexicalLineBreak=a}getFirstChildOffset(){let t=0;for(let r=this.after;r!==null;r=r.previousSibling)t++;return t}resolveChildIndex(t,r,n,s){if(n===this.element){const c=this.getFirstChildOffset();return[t,Math.min(c+t.getChildrenSize(),Math.max(c,s))]}const a=c8(r,n);a.push(s);const i=c8(r,this.element);let o=t.getIndexWithinParent();for(let c=0;c<i.length;c++){const u=a[c],d=i[c];if(u===void 0||u<d)break;if(u>d){o+=1;break}}return[t.getParentOrThrow(),o]}}function c8(e,t){const r=[];let n=t;for(;n!==e&&n!==null;n=n.parentNode){let s=0;for(let a=n.previousSibling;a!==null;a=a.previousSibling)s++;r.push(s)}return n!==e&&$t(225),r.reverse()}class Di extends Um{constructor(t){super(t),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__style="",this.__indent=0,this.__dir=null,this.__textFormat=0,this.__textStyle=""}afterCloneFrom(t){super.afterCloneFrom(t),this.__key===t.__key&&(this.__first=t.__first,this.__last=t.__last,this.__size=t.__size),this.__indent=t.__indent,this.__format=t.__format,this.__style=t.__style,this.__dir=t.__dir,this.__textFormat=t.__textFormat,this.__textStyle=t.__textStyle}getFormat(){return this.getLatest().__format}getFormatType(){const t=this.getFormat();return ute[t]||""}getStyle(){return this.getLatest().__style}getIndent(){return this.getLatest().__indent}getChildren(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getChildrenKeys(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r.__key),r=r.getNextSibling();return t}getChildrenSize(){return this.getLatest().__size}isEmpty(){return this.getChildrenSize()===0}isDirty(){const t=Ss()._dirtyElements;return t!==null&&t.has(this.__key)}isLastChild(){const t=this.getLatest(),r=this.getParentOrThrow().getLastChild();return r!==null&&r.is(t)}getAllTextNodes(){const t=[];let r=this.getFirstChild();for(;r!==null;){if(er(r)&&t.push(r),bt(r)){const n=r.getAllTextNodes();t.push(...n)}r=r.getNextSibling()}return t}getFirstDescendant(){let t=this.getFirstChild();for(;bt(t);){const r=t.getFirstChild();if(r===null)break;t=r}return t}getLastDescendant(){let t=this.getLastChild();for(;bt(t);){const r=t.getLastChild();if(r===null)break;t=r}return t}getDescendantByIndex(t){const r=this.getChildren(),n=r.length;if(t>=n){const a=r[n-1];return bt(a)&&a.getLastDescendant()||a||null}const s=r[t];return bt(s)&&s.getFirstDescendant()||s||null}getFirstChild(){const t=this.getLatest().__first;return t===null?null:la(t)}getFirstChildOrThrow(){const t=this.getFirstChild();return t===null&&$t(45,this.__key),t}getLastChild(){const t=this.getLatest().__last;return t===null?null:la(t)}getLastChildOrThrow(){const t=this.getLastChild();return t===null&&$t(96,this.__key),t}getChildAtIndex(t){const r=this.getChildrenSize();let n,s;if(t<r/2){for(n=this.getFirstChild(),s=0;n!==null&&s<=t;){if(s===t)return n;n=n.getNextSibling(),s++}return null}for(n=this.getLastChild(),s=r-1;n!==null&&s>=t;){if(s===t)return n;n=n.getPreviousSibling(),s--}return null}getTextContent(){let t="";const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContent(),bt(a)&&s!==n-1&&!a.isInline()&&(t+=ed)}return t}getTextContentSize(){let t=0;const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContentSize(),bt(a)&&s!==n-1&&!a.isInline()&&(t+=ed.length)}return t}getDirection(){return this.getLatest().__dir}getTextFormat(){return this.getLatest().__textFormat}hasFormat(t){if(t!==""){const r=jP[t];return!!(this.getFormat()&r)}return!1}hasTextFormat(t){const r=n0[t];return!!(this.getTextFormat()&r)}getFormatFlags(t,r){return Ab(this.getLatest().__textFormat,t,r)}getTextStyle(){return this.getLatest().__textStyle}select(t,r){li();const n=Zt();let s=t,a=r;const i=this.getChildrenSize();if(!this.canBeEmpty()){if(t===0&&r===0){const c=this.getFirstChild();if(er(c)||bt(c))return c.select(0,0)}else if(!(t!==void 0&&t!==i||r!==void 0&&r!==i)){const c=this.getLastChild();if(er(c)||bt(c))return c.select()}}s===void 0&&(s=i),a===void 0&&(a=i);const o=this.__key;return Ot(n)?(n.anchor.set(o,s,"element"),n.focus.set(o,a,"element"),n.dirty=!0,n):g9(o,s,o,a,"element","element")}selectStart(){const t=this.getFirstDescendant();return t?t.selectStart():this.select()}selectEnd(){const t=this.getLastDescendant();return t?t.selectEnd():this.select()}clear(){const t=this.getWritable();return this.getChildren().forEach((r=>r.remove())),t}append(...t){return this.splice(this.getChildrenSize(),0,t)}setDirection(t){const r=this.getWritable();return r.__dir=t,r}setFormat(t){return this.getWritable().__format=t!==""?jP[t]:0,this}setStyle(t){return this.getWritable().__style=t||"",this}setTextFormat(t){const r=this.getWritable();return r.__textFormat=t,r}setTextStyle(t){const r=this.getWritable();return r.__textStyle=t,r}setIndent(t){return this.getWritable().__indent=t,this}splice(t,r,n){const s=n.length,a=this.getChildrenSize(),i=this.getWritable();t+r<=a||$t(226,String(t),String(r),String(a));const o=i.__key,c=[],u=[],d=this.getChildAtIndex(t+r);let h=null,g=a-r+s;if(t!==0)if(t===a)h=this.getLastChild();else{const x=this.getChildAtIndex(t);x!==null&&(h=x.getPreviousSibling())}if(r>0){let x=h===null?this.getFirstChild():h.getNextSibling();for(let v=0;v<r;v++){x===null&&$t(100);const w=x.getNextSibling(),C=x.__key;Hh(x.getWritable()),u.push(C),x=w}}let p=h;for(let x=0;x<s;x++){const v=n[x];p!==null&&v.is(p)&&(h=p=p.getPreviousSibling());const w=v.getWritable();w.__parent===o&&g--,Hh(w);const C=v.__key;if(p===null)i.__first=C,w.__prev=null;else{const k=p.getWritable();k.__next=C,w.__prev=k.__key}v.__key===o&&$t(76),w.__parent=o,c.push(C),p=v}if(t+r===a)p!==null&&(p.getWritable().__next=null,i.__last=p.__key);else if(d!==null){const x=d.getWritable();if(p!==null){const v=p.getWritable();x.__prev=p.__key,v.__next=d.__key}else x.__prev=null}if(i.__size=g,u.length){const x=Zt();if(Ot(x)){const v=new Set(u),w=new Set(c),{anchor:C,focus:k}=x;u8(C,v,w)&&Eb(C,C.getNode(),this,h,d),u8(k,v,w)&&Eb(k,k.getNode(),this,h,d),g!==0||this.canBeEmpty()||ro(this)||this.remove()}}return i}getDOMSlot(t){return new _y(t)}exportDOM(t){const{element:r}=super.exportDOM(t);if(as(r)){const n=this.getIndent();n>0&&(r.style.paddingInlineStart=40*n+"px");const s=this.getDirection();s&&(r.dir=s)}return{element:r}}exportJSON(){const t={children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),...super.exportJSON()},r=this.getTextFormat(),n=this.getTextStyle();return r!==0&&(t.textFormat=r),n!==""&&(t.textStyle=n),t}updateFromJSON(t){return super.updateFromJSON(t).setFormat(t.format).setIndent(t.indent).setDirection(t.direction).setTextFormat(t.textFormat||0).setTextStyle(t.textStyle||"")}insertNewAfter(t,r){return null}canIndent(){return!0}collapseAtStart(t){return!1}excludeFromCopy(t){return!1}canReplaceWith(t){return!0}canInsertAfter(t){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(t){return!1}extractWithChild(t,r,n){return!1}canMergeWhenEmpty(){return!1}reconcileObservedMutation(t,r){const n=this.getDOMSlot(t);let s=n.getFirstChild();for(let a=this.getFirstChild();a;a=a.getNextSibling()){const i=r.getElementByKey(a.getKey());i!==null&&(s==null?(n.insertChild(i),s=i):s!==i&&n.replaceChild(i,s),s=s.nextSibling)}}}function bt(e){return e instanceof Di}function u8(e,t,r){let n=e.getNode();for(;n;){const s=n.__key;if(t.has(s)&&!r.has(s))return!0;n=n.getParent()}return!1}class v4 extends Um{decorate(t,r){$t(47)}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function vn(e){return e instanceof v4}class Fv extends Di{static getType(){return"root"}static clone(){return new Fv}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){$t(51)}getTextContent(){const t=this.__cachedText;return!Pv()&&Ss()._dirtyType!==r0||t===null?super.getTextContent():t}remove(){$t(52)}replace(t){$t(53)}insertBefore(t){$t(54)}insertAfter(t){$t(55)}updateDOM(t,r){return!1}splice(t,r,n){for(const s of n)bt(s)||vn(s)||$t(282);return super.splice(t,r,n)}static importJSON(t){return ps().updateFromJSON(t)}collapseAtStart(){return!0}}function _a(e){return e instanceof Fv}function v9(e){return new K_(new Map(e._nodeMap))}function w4(){return new K_(new Map([["root",new Fv]]))}function w9(e){const t=e.exportJSON(),r=e.constructor;if(t.type!==r.getType()&&$t(130,r.name),bt(e)){const n=t.children;Array.isArray(n)||$t(59,r.name);const s=e.getChildren();for(let a=0;a<s.length;a++){const i=w9(s[a]);n.push(i)}}return t}class K_{constructor(t,r){this._nodeMap=t,this._selection=r||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(t,r){return o8(r&&r.editor||null,this,t)}clone(t){const r=new K_(this._nodeMap,t===void 0?this._selection:t);return r._readOnly=!0,r}toJSON(){return o8(null,this,(()=>({root:w9(ps())})))}}const Nb="historic",Xte="history-push",Sy="history-merge",Qte="paste",b9="collaboration",Jte="skip-scroll-into-view",Zte="skip-dom-selection";class b4 extends Di{static getType(){return"artificial"}createDOM(t){return document.createElement("div")}}class Ov extends Di{static getType(){return"paragraph"}static clone(t){return new Ov(t.__key)}createDOM(t){const r=document.createElement("p"),n=om(t.theme,"paragraph");return n!==void 0&&r.classList.add(...n),r}updateDOM(t,r,n){return!1}static importDOM(){return{p:t=>({conversion:ere,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if(as(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n)}return{element:r}}static importJSON(t){return ss().updateFromJSON(t)}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle()}}insertNewAfter(t,r){const n=ss();n.setTextFormat(t.format),n.setTextStyle(t.style);const s=this.getDirection();return n.setDirection(s),n.setFormat(this.getFormatType()),n.setStyle(this.getStyle()),this.insertAfter(n,r),n}collapseAtStart(){const t=this.getChildren();if(t.length===0||er(t[0])&&t[0].getTextContent().trim()===""){if(this.getNextSibling()!==null)return this.selectNext(),this.remove(),!0;if(this.getPreviousSibling()!==null)return this.selectPrevious(),this.remove(),!0}return!1}}function ere(e){const t=ss();return e.style&&(t.setFormat(e.style.textAlign),O4(e,t)),{node:t}}function ss(){return ao(new Ov)}function _4(e){return e instanceof Ov}const fn=0,Wg=1,tre=4;function _9(e,t,r,n){const s=e._keyToDOMMap;s.clear(),e._editorState=w4(),e._pendingEditorState=n,e._compositionKey=null,e._dirtyType=r0,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),e._normalizedNodes=new Set,e._updateTags=new Set,e._updates=[],e._blockCursorElement=null;const a=e._observer;a!==null&&(a.disconnect(),e._observer=null),t!==null&&(t.textContent=""),r!==null&&(r.textContent="",s.set("root",r))}function rre(e){const t=e||{},r=qte(),n=t.theme||{},s=e===void 0?r:t.parentEditor||null,a=t.disableEvents||!1,i=w4(),o=t.namespace||(s!==null?s._config.namespace:j9()),c=t.editorState,u=[Fv,Df,Av,jv,Ov,b4,...t.nodes||[]],{onError:d,html:h}=t,g=t.editable===void 0||t.editable;let p;if(e===void 0&&r!==null)p=r._nodes;else{p=new Map;for(let v=0;v<u.length;v++){let w=u[v],C=null,k=null;if(typeof w!="function"){const F=w;w=F.replace,C=F.with,k=F.withKlass||null}const{ownNodeConfig:b}=D4(w),N=w.getType(),E=w.transform(),P=new Set;b&&b.$transform&&P.add(b.$transform),E!==null&&P.add(E),p.set(N,{exportDOM:h&&h.export?h.export.get(w):void 0,klass:w,replace:C,replaceWithKlass:k,sharedNodeState:yte(u[v]),transforms:P})}}const x=new q_(i,s,p,{disableEvents:a,namespace:o,theme:n},d||console.error,(function(v,w){const C=new Map,k=new Set,b=N=>{Object.keys(N).forEach((E=>{let P=C.get(E);P===void 0&&(P=[],C.set(E,P)),P.push(N[E])}))};return v.forEach((N=>{const E=N.klass.importDOM;if(E==null||k.has(E))return;k.add(E);const P=E.call(N.klass);P!==null&&b(P)})),w&&b(w),C})(p,h?h.import:void 0),g,e);return c!==void 0&&(x._pendingEditorState=c,x._dirtyType=wm),x}class q_{constructor(t,r,n,s,a,i,o,c){this._createEditorArgs=c,this._parentEditor=r,this._rootElement=null,this._editorState=t,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=s,this._nodes=n,this._decorators={},this._pendingDecorators=null,this._dirtyType=r0,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=j9(),this._onError=a,this._htmlConversions=i,this._editable=o,this._headless=r!==null&&r._headless,this._window=null,this._blockCursorElement=null}isComposing(){return this._compositionKey!=null}registerUpdateListener(t){const r=this._listeners.update;return r.add(t),()=>{r.delete(t)}}registerEditableListener(t){const r=this._listeners.editable;return r.add(t),()=>{r.delete(t)}}registerDecoratorListener(t){const r=this._listeners.decorator;return r.add(t),()=>{r.delete(t)}}registerTextContentListener(t){const r=this._listeners.textcontent;return r.add(t),()=>{r.delete(t)}}registerRootListener(t){const r=this._listeners.root;return t(this._rootElement,null),r.add(t),()=>{t(null,this._rootElement),r.delete(t)}}registerCommand(t,r,n){n===void 0&&$t(35);const s=this._commands;s.has(t)||s.set(t,[new Set,new Set,new Set,new Set,new Set]);const a=s.get(t);a===void 0&&$t(36,String(t));const i=a[n];return i.add(r),()=>{i.delete(r),a.every((o=>o.size===0))&&s.delete(t)}}registerMutationListener(t,r,n){const s=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(t)).klass,a=this._listeners.mutation;let i=a.get(r);i===void 0&&(i=new Set,a.set(r,i)),i.add(s);const o=n&&n.skipInitialization;return o!==void 0&&o||this.initializeMutationListener(r,s),()=>{i.delete(s),i.size===0&&a.delete(r)}}getRegisteredNode(t){const r=this._nodes.get(t.getType());return r===void 0&&$t(37,t.name),r}resolveRegisteredNodeAfterReplacements(t){for(;t.replaceWithKlass;)t=this.getRegisteredNode(t.replaceWithKlass);return t}initializeMutationListener(t,r){const n=this._editorState,s=v8(n).get(r.getType());if(!s)return;const a=new Map;for(const i of s.keys())a.set(i,"created");a.size>0&&t(a,{dirtyLeaves:new Set,prevEditorState:n,updateTags:new Set(["registerMutationListener"])})}registerNodeTransformToKlass(t,r){const n=this.getRegisteredNode(t);return n.transforms.add(r),n}registerNodeTransform(t,r){const n=this.registerNodeTransformToKlass(t,r),s=[n],a=n.replaceWithKlass;if(a!=null){const i=this.registerNodeTransformToKlass(a,r);s.push(i)}return(function(i,o){const c=v8(i.getEditorState()),u=[];for(const d of o){const h=c.get(d);h&&u.push(h)}u.length!==0&&i.update((()=>{for(const d of u)for(const h of d.keys()){const g=la(h);g&&g.markDirty()}}),i._pendingEditorState===null?{tag:Sy}:void 0)})(this,s.map((i=>i.klass.getType()))),()=>{s.forEach((i=>i.transforms.delete(r)))}}hasNode(t){return this._nodes.has(t.getType())}hasNodes(t){return t.every(this.hasNode.bind(this))}dispatchCommand(t,r){return lr(this,t,r)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(t){const r=this._rootElement;if(t!==r){const n=om(this._config.theme,"root"),s=this._pendingEditorState||this._editorState;if(this._rootElement=t,_9(this,r,t,s),r!==null&&(this._config.disableEvents||Rte(r),n!=null&&r.classList.remove(...n)),t!==null){const a=P4(t),i=t.style;i.userSelect="text",i.whiteSpace="pre-wrap",i.wordBreak="break-word",t.setAttribute("data-lexical-editor","true"),this._window=a,this._dirtyType=wm,IL(this),this._updateTags.add(Sy),Lu(this),this._config.disableEvents||(function(o,c){const u=o.ownerDocument,d=Cb.get(u);(d===void 0||d<1)&&u.addEventListener("selectionchange",c9),Cb.set(u,(d||0)+1),o.__lexicalEditor=c;const h=l9(o);for(let g=0;g<HT.length;g++){const[p,x]=HT[g],v=typeof x=="function"?w=>{GP(w)||(HP(w),(c.isEditable()||p==="click")&&x(w,c))}:w=>{if(GP(w))return;HP(w);const C=c.isEditable();switch(p){case"cut":return C&&lr(c,g4,w);case"copy":return lr(c,z_,w);case"paste":return C&&lr(c,d4,w);case"dragstart":return C&&lr(c,e9,w);case"dragover":return C&&lr(c,t9,w);case"dragend":return C&&lr(c,jte,w);case"focus":return C&&lr(c,Ote,w);case"blur":return C&&lr(c,Dte,w);case"drop":return C&&lr(c,JL,w)}};o.addEventListener(p,v),h.push((()=>{o.removeEventListener(p,v)}))}})(t,this),n!=null&&t.classList.add(...n)}else this._window=null,this._updateTags.add(Sy),Lu(this);by("root",this,!1,t,r)}}getElementByKey(t){return this._keyToDOMMap.get(t)||null}getEditorState(){return this._editorState}setEditorState(t,r){t.isEmpty()&&$t(38);let n=t;n._readOnly&&(n=v9(t),n._selection=t._selection?t._selection.clone():null),DL(this);const s=this._pendingEditorState,a=this._updateTags,i=r!==void 0?r.tag:null;s===null||s.isEmpty()||(i!=null&&a.add(i),Lu(this)),this._pendingEditorState=n,this._dirtyType=wm,this._dirtyElements.set("root",!1),this._compositionKey=null,i!=null&&a.add(i),this._updating||Lu(this)}parseEditorState(t,r){return(function(n,s,a){const i=w4(),o=Ra,c=So,u=Ma,d=s._dirtyElements,h=s._dirtyLeaves,g=s._cloneNotNeeded,p=s._dirtyType;s._dirtyElements=new Map,s._dirtyLeaves=new Set,s._cloneNotNeeded=new Set,s._dirtyType=0,Ra=i,So=!1,Ma=s,S4(null);try{const x=s._nodes;y4(n.root,x),a&&a(),i._readOnly=!0}catch(x){x instanceof Error&&s._onError(x)}finally{s._dirtyElements=d,s._dirtyLeaves=h,s._cloneNotNeeded=g,s._dirtyType=p,Ra=o,So=c,Ma=u}return i})(typeof t=="string"?JSON.parse(t):t,this,r)}read(t){return Lu(this),this.getEditorState().read(t,{editor:this})}update(t,r){(function(n,s,a){n._updating?n._updates.push([s,a]):V_(n,s,a)})(this,t,r)}focus(t,r={}){const n=this._rootElement;n!==null&&(n.setAttribute("autocapitalize","off"),$o(this,(()=>{const s=Zt(),a=ps();s!==null?s.dirty||hi(s.clone()):a.getChildrenSize()!==0&&(r.defaultSelection==="rootStart"?a.selectStart():a.selectEnd()),cre("focus"),ure((()=>{n.removeAttribute("autocapitalize"),t&&t()}))})),this._pendingEditorState===null&&n.removeAttribute("autocapitalize"))}blur(){const t=this._rootElement;t!==null&&t.blur();const r=dc(this._window);r!==null&&r.removeAllRanges()}isEditable(){return this._editable}setEditable(t){this._editable!==t&&(this._editable=t,by("editable",this,!0,t))}toJSON(){return{editorState:this._editorState.toJSON()}}}q_.version="0.35.0+prod.esm";let XT=null;function S4(e){XT=e}let nre=1;function S9(e,t){const r=k4(e,t);return r===void 0&&$t(30,t),r}function k4(e,t){return e._nodes.get(t)}const sre=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)};function d8(e){return vn(kf(e))}function C4(e){const t=document.activeElement;if(!as(t))return!1;const r=t.nodeName;return vn(kf(e))&&(r==="INPUT"||r==="TEXTAREA"||t.contentEditable==="true"&&Y_(t)==null)}function Dv(e,t,r){const n=e.getRootElement();try{return n!==null&&n.contains(t)&&n.contains(r)&&t!==null&&!C4(t)&&k9(t)===e}catch{return!1}}function T4(e){return e instanceof q_}function k9(e){let t=e;for(;t!=null;){const r=Y_(t);if(T4(r))return r;t=Iv(t)}return null}function Y_(e){return e?e.__lexicalEditor:null}function Wh(e){return W_(e)||e.isToken()}function Ru(e){return Wh(e)||e.isSegmented()}function ld(e){return Hm(e)&&e.nodeType===tte}function are(e){return Hm(e)&&e.nodeType===rte}function bm(e){let t=e;for(;t!=null;){if(ld(t))return t;t=t.firstChild}return null}function Ab(e,t,r){const n=n0[t];if(r!==null&&(e&n)==(r&n))return e;let s=e^n;return t==="subscript"?s&=-65:t==="superscript"?s&=-33:t==="lowercase"?(s&=-513,s&=-1025):t==="uppercase"?(s&=-257,s&=-1025):t==="capitalize"&&(s&=-257,s&=-513),s}function C9(e){return er(e)||Vu(e)||vn(e)}function ire(e,t){const r=(function(){const i=XT;return XT=null,i})();if((t=t||r&&r.__key)!=null)return void(e.__key=t);li(),p9();const n=Ss(),s=If(),a=""+nre++;s._nodeMap.set(a,e),bt(e)?n._dirtyElements.set(a,!0):n._dirtyLeaves.add(a),n._cloneNotNeeded.add(a),n._dirtyType=PL,e.__key=a}function Hh(e){const t=e.getParent();if(t!==null){const r=e.getWritable(),n=t.getWritable(),s=e.getPreviousSibling(),a=e.getNextSibling(),i=a!==null?a.__key:null,o=s!==null?s.__key:null,c=s!==null?s.getWritable():null,u=a!==null?a.getWritable():null;s===null&&(n.__first=i),a===null&&(n.__last=o),c!==null&&(c.__next=i),u!==null&&(u.__prev=o),r.__prev=null,r.__next=null,r.__parent=null,n.__size--}}function jb(e){p9();const t=e.getLatest(),r=t.__parent,n=If(),s=Ss(),a=n._nodeMap,i=s._dirtyElements;r!==null&&(function(c,u,d){let h=c;for(;h!==null;){if(d.has(h))return;const g=u.get(h);if(g===void 0)break;d.set(h,!1),h=g.__parent}})(r,a,i);const o=t.__key;s._dirtyType=PL,bt(e)?i.set(o,!0):s._dirtyLeaves.add(o)}function ci(e){li();const t=Ss(),r=t._compositionKey;if(e!==r){if(t._compositionKey=e,r!==null){const n=la(r);n!==null&&n.getWritable()}if(e!==null){const n=la(e);n!==null&&n.getWritable()}}}function df(){return Pv()?null:Ss()._compositionKey}function la(e,t){const r=(t||If())._nodeMap.get(e);return r===void 0?null:r}function T9(e,t){const r=X_(e,Ss());return r!==void 0?la(r,t):null}function X_(e,t){return e[`__lexicalKey_${t._key}`]}function kf(e,t){let r=e;for(;r!=null;){const n=T9(r,t);if(n!==null)return n;r=Iv(r)}return null}function E9(e){const t=e._decorators,r=Object.assign({},t);return e._pendingDecorators=r,r}function f8(e){return e.read((()=>ps().getTextContent()))}function ps(){return N9(If())}function N9(e){return e._nodeMap.get("root")}function hi(e){li();const t=If();e!==null&&(e.dirty=!0,e.setCachedNodes(null)),t._selection=e}function Zg(e){const t=Ss(),r=(function(n,s){let a=n;for(;a!=null;){const i=X_(a,s);if(i!==void 0)return i;a=Iv(a)}return null})(e,t);return r===null?e===t.getRootElement()?la("root"):null:la(r)}function A9(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(e)}function E4(e){const t=[];let r=e;for(;r!==null;)t.push(r),r=r._parentEditor;return t}function j9(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,5)}function P9(e){return ld(e)?e.nodeValue:null}function N4(e,t,r){const n=dc(El(t));if(n===null)return;const s=n.anchorNode;let{anchorOffset:a,focusOffset:i}=n;if(s!==null){let o=P9(s);const c=kf(s);if(o!==null&&er(c)){if(o===$_&&r){const u=r.length;o=r,a=u,i=u}o!==null&&A4(c,o,a,i,e)}}}function A4(e,t,r,n,s){let a=e;if(a.isAttached()&&(s||!a.isDirty())){const i=a.isComposing();let o=t;(i||s)&&t[t.length-1]===$_&&(o=t.slice(0,-1));const c=a.getTextContent();if(s||o!==c){if(o===""){if(ci(null),Wy||vm||pb)a.remove();else{const v=Ss();setTimeout((()=>{v.update((()=>{a.isAttached()&&a.remove()}))}),20)}return}const u=a.getParent(),d=Wm(),h=a.getTextContentSize(),g=df(),p=a.getKey();if(a.isToken()||g!==null&&p===g&&!i||Ot(d)&&(u!==null&&!u.canInsertTextBefore()&&d.anchor.offset===0||d.anchor.key===e.__key&&d.anchor.offset===0&&!a.canInsertTextBefore()&&!i||d.focus.key===e.__key&&d.focus.offset===h&&!a.canInsertTextAfter()&&!i))return void a.markDirty();const x=Zt();if(!Ot(x)||r===null||n===null)return void h8(a,o,x);if(x.setTextNodeRange(a,r,a,n),a.isSegmented()){const v=Ps(a.getTextContent());a.replace(v),a=v}h8(a,o,x)}}}function h8(e,t,r){if(e.setTextContent(t),Ot(r)){const n=e.getKey();for(const s of["anchor","focus"]){const a=r[s];a.type==="text"&&a.key===n&&(a.offset=yf(e,a.offset,"clamp"))}}}function yw(e,t,r){const n=t[r]||!1;return n==="any"||n===e[r]}function ore(e,t){return yw(e,t,"altKey")&&yw(e,t,"ctrlKey")&&yw(e,t,"shiftKey")&&yw(e,t,"metaKey")}function Pn(e,t,r){return ore(e,r)&&e.key.toLowerCase()===t.toLowerCase()}const Iu={ctrlKey:!Uc,metaKey:Uc},g8={altKey:Uc,ctrlKey:!Uc};function m8(e){return e.key==="Backspace"}function p8(e){return Pn(e,"a",Iu)}function lre(e){const t=ps();if(Ot(e)){const r=e.anchor,n=e.focus,s=r.getNode().getTopLevelElementOrThrow().getParentOrThrow();return r.set(s.getKey(),0,"element"),n.set(s.getKey(),s.getChildrenSize(),"element"),vb(e),e}{const r=t.select(0,t.getChildrenSize());return hi(vb(r)),r}}function om(e,t){e.__lexicalClassNameCache===void 0&&(e.__lexicalClassNameCache={});const r=e.__lexicalClassNameCache,n=r[t];if(n!==void 0)return n;const s=e[t];if(typeof s=="string"){const a=jL(s);return r[t]=a,a}return s}function j4(e,t,r,n,s){if(r.size===0)return;const a=n.__type,i=n.__key,o=t.get(a);o===void 0&&$t(33,a);const c=o.klass;let u=e.get(c);u===void 0&&(u=new Map,e.set(c,u));const d=u.get(i),h=d==="destroyed"&&s==="created";(d===void 0||h)&&u.set(i,h?"updated":s)}function x8(e,t,r){const n=e.getParent();let s=r,a=e;return n!==null&&(t&&r===0?(s=a.getIndexWithinParent(),a=n):t||r!==a.getChildrenSize()||(s=a.getIndexWithinParent()+1,a=n)),a.getChildAtIndex(t?s-1:s)}function QT(e,t){const r=e.offset;if(e.type==="element")return x8(e.getNode(),t,r);{const n=e.getNode();if(t&&r===0||!t&&r===n.getTextContentSize()){const s=t?n.getPreviousSibling():n.getNextSibling();return s===null?x8(n.getParentOrThrow(),t,n.getIndexWithinParent()+(t?0:1)):s}}return null}function F9(e){const t=El(e).event,r=t&&t.inputType;return r==="insertFromPaste"||r==="insertFromPasteAsQuotation"}function lr(e,t,r){return(function(n,s,a){const i=E4(n);for(let o=4;o>=0;o--)for(let c=0;c<i.length;c++){const u=i[c],d=u._commands.get(s);if(d!==void 0){const h=d[o];if(h!==void 0){const g=Array.from(h),p=g.length;let x=!1;if($o(u,(()=>{for(let v=0;v<p;v++)if(g[v](a,n))return void(x=!0)})),x)return x}}}return!1})(e,t,r)}function Q_(e){return!_a(e)&&!e.isLastChild()&&!e.isInline()}function i0(e,t){const r=e._keyToDOMMap.get(t);return r===void 0&&$t(75,t),r}function Iv(e){const t=e.assignedSlot||e.parentElement;return eE(t)?t.host:t}function O9(e){return are(e)?e:as(e)?e.ownerDocument:null}function cre(e){li(),Ss()._updateTags.add(e)}function ure(e){li(),Ss()._deferred.push(e)}function JT(e,t){let r=e.getParent();for(;r!==null;){if(r.is(t))return!0;r=r.getParent()}return!1}function P4(e){const t=O9(e);return t?t.defaultView:null}function El(e){const t=e._window;return t===null&&$t(78),t}function dre(e){return bt(e)&&e.isInline()||vn(e)&&e.isInline()}function fre(e){let t=e.getParentOrThrow();for(;t!==null;){if(ro(t))return t;t=t.getParentOrThrow()}return t}function ro(e){return _a(e)||bt(e)&&e.isShadowRoot()}function ao(e){const t=Ss(),r=e.getType(),n=k4(t,r);n===void 0&&$t(200,e.constructor.name,r);const{replace:s,replaceWithKlass:a}=n;if(s!==null){const i=s(e),o=i.constructor;return a!==null?i instanceof a||$t(201,a.name,a.getType(),o.name,o.getType(),e.constructor.name,r):i instanceof e.constructor&&o!==e.constructor||$t(202,o.name,o.getType(),e.constructor.name,r),i.__key===e.__key&&$t(203,e.constructor.name,r,o.name,o.getType()),i}return e}function lk(e,t){!_a(e.getParent())||bt(t)||vn(t)||$t(99)}function hre(e){const t=la(e);return t===null&&$t(63,e),t}function ck(e){return(vn(e)||bt(e)&&!e.canBeEmpty())&&!e.isInline()}function ZT(e,t,r){r.style.removeProperty("caret-color"),t._blockCursorElement=null;const n=e.parentElement;n!==null&&n.removeChild(e)}function dc(e){return hc?(e||window).getSelection():null}function gre(e){const t=P4(e);return t?t.getSelection():null}function D9(e){return as(e)&&e.tagName==="A"}function as(e){return Hm(e)&&e.nodeType===ete}function Hm(e){return typeof e=="object"&&e!==null&&"nodeType"in e&&typeof e.nodeType=="number"}function eE(e){return Hm(e)&&e.nodeType===nte}function tE(e){const t=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|mark|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return e.nodeName.match(t)!==null}function Pb(e){const t=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return e.nodeName.match(t)!==null}function bl(e){if(vn(e)&&!e.isInline())return!0;if(!bt(e)||ro(e))return!1;const t=e.getFirstChild(),r=t===null||Vu(t)||er(t)||t.isInline();return!e.isInline()&&e.canBeEmpty()!==!1&&r}function uk(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function Rv(){return Ss()}const y8=new WeakMap,mre=new Map;function v8(e){if(!e._readOnly&&e.isEmpty())return mre;e._readOnly||$t(192);let t=y8.get(e);return t||(t=(function(r){const n=new Map;for(const[s,a]of r._nodeMap){const i=a.__type;let o=n.get(i);o||(o=new Map,n.set(i,o)),o.set(s,a)}return n})(e),y8.set(e,t)),t}function F4(e){const t=e.constructor.clone(e);return t.afterCloneFrom(e),t}function O4(e,t){const r=parseInt(e.style.paddingInlineStart,10)||0,n=Math.round(r/40);t.setIndent(n)}function pre(e){e.__lexicalUnmanaged=!0}function xre(e){return e.__lexicalUnmanaged===!0}function Vx(e,t){return(function(r,n){return Object.prototype.hasOwnProperty.call(r,n)})(e,t)&&e[t]!==Um[t]}function D4(e){const t=PP in e.prototype?e.prototype[PP]():void 0,r=(function(i){return i===v4||i===Di||i===Um})(e),n=!r&&Vx(e,"getType")?e.getType():void 0;let s,a=n;if(t)if(n)s=t[n];else for(const[i,o]of Object.entries(t))a=i,s=o;if(!r&&a&&(Vx(e,"getType")||(e.getType=()=>a),Vx(e,"clone")||(e.clone=i=>(S4(i),new e)),Vx(e,"importJSON")||(e.importJSON=s&&s.$importJSON||(i=>new e().updateFromJSON(i))),!Vx(e,"importDOM")&&s)){const{importDOM:i}=s;i&&(e.importDOM=()=>i)}return{ownNodeConfig:s,ownNodeType:a}}function yre(e){const t=Rv();return li(),new(t.resolveRegisteredNodeAfterReplacements(t.getRegisteredNode(e))).klass}const vre={next:"previous",previous:"next"};class I4{constructor(t){this.origin=t}[Symbol.iterator](){return $4({hasNext:c0,initial:this.getAdjacentCaret(),map:t=>t,step:t=>t.getAdjacentCaret()})}getAdjacentCaret(){return fi(this.getNodeAtCaret(),this.direction)}getSiblingCaret(){return fi(this.origin,this.direction)}remove(){const t=this.getNodeAtCaret();return t&&t.remove(),this}replaceOrInsert(t,r){const n=this.getNodeAtCaret();return t.is(this.origin)||t.is(n)||(n===null?this.insert(t):n.replace(t,r)),this}splice(t,r,n="next"){const s=n===this.direction?r:Array.from(r).reverse();let a=this;const i=this.getParentAtCaret(),o=new Map;for(let c=a.getAdjacentCaret();c!==null&&o.size<t;c=c.getAdjacentCaret()){const u=c.origin.getWritable();o.set(u.getKey(),u)}for(const c of s){if(o.size>0){const u=a.getNodeAtCaret();if(u){if(o.delete(u.getKey()),o.delete(c.getKey()),!(u.is(c)||a.origin.is(c))){const d=c.getParent();d&&d.is(i)&&c.remove(),u.replace(c)}}else u===null&&$t(263,Array.from(o).join(" "))}else a.insert(c);a=fi(c,this.direction)}for(const c of o.values())c.remove();return this}}class Yy extends I4{type="child";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:Nl(t,this.direction)}getParentCaret(t="root"){return fi(R4(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=Gm(this.direction);return fi(this.getNodeAtCaret(),t)||Nl(this.origin,t)}getParentAtCaret(){return this.origin}getChildCaret(){return this}isSameNodeCaret(t){return t instanceof Yy&&this.direction===t.direction&&this.origin.is(t.origin)}isSamePointCaret(t){return this.isSameNodeCaret(t)}}const wre={root:_a,shadowRoot:ro};function Gm(e){return vre[e]}function R4(e,t="root"){return wre[t](e)?null:e}class o0 extends I4{type="sibling";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:fi(t,this.direction)}getSiblingCaret(){return this}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return bt(this.origin)?Nl(this.origin,this.direction):null}getParentCaret(t="root"){return fi(R4(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=Gm(this.direction);return fi(this.getNodeAtCaret(),t)||Nl(this.origin.getParentOrThrow(),t)}isSamePointCaret(t){return t instanceof o0&&this.direction===t.direction&&this.origin.is(t.origin)}isSameNodeCaret(t){return(t instanceof o0||t instanceof l0)&&this.direction===t.direction&&this.origin.is(t.origin)}}class l0 extends I4{type="text";constructor(t,r){super(t),this.offset=r}getLatest(){const t=this.origin.getLatest();return t===this.origin?this:u0(t,this.direction,this.offset)}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return null}getParentCaret(t="root"){return fi(R4(this.getParentAtCaret(),t),this.direction)}getFlipped(){return u0(this.origin,Gm(this.direction),this.offset)}isSamePointCaret(t){return t instanceof l0&&this.direction===t.direction&&this.origin.is(t.origin)&&this.offset===t.offset}isSameNodeCaret(t){return(t instanceof o0||t instanceof l0)&&this.direction===t.direction&&this.origin.is(t.origin)}getSiblingCaret(){return fi(this.origin,this.direction)}}function xf(e){return e instanceof l0}function c0(e){return e instanceof o0}function Yc(e){return e instanceof Yy}const bre={next:class extends l0{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends l0{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},_re={next:class extends o0{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends o0{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},Sre={next:class extends Yy{direction="next";getNodeAtCaret(){return this.origin.getFirstChild()}insert(e){return this.origin.splice(0,0,[e]),this}},previous:class extends Yy{direction="previous";getNodeAtCaret(){return this.origin.getLastChild()}insert(e){return this.origin.splice(this.origin.getChildrenSize(),0,[e]),this}}};function fi(e,t){return e?new _re[t](e):null}function u0(e,t,r){return e?new bre[t](e,yf(e,r)):null}function yf(e,t,r="error"){const n=e.getTextContentSize();let s=t==="next"?n:t==="previous"?0:t;return(s<0||s>n)&&(r!=="clamp"&&(function(a,...i){const o=new URL("https://lexical.dev/docs/error"),c=new URLSearchParams;c.append("code",a);for(const u of i)c.append("v",u);o.search=c.toString(),console.warn(`Minified Lexical warning #${a}; visit ${o.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(284,String(t),String(n),e.getKey()),s=s<0?0:n),s}function w8(e,t){return new Cre(e,t)}function Nl(e,t){return bt(e)?new Sre[t](e):null}function kre(e){return e&&e.getChildCaret()||e}function M4(e){return e&&kre(e.getAdjacentCaret())}class L4{type="node-caret-range";constructor(t,r,n){this.anchor=t,this.focus=r,this.direction=n}getLatest(){const t=this.anchor.getLatest(),r=this.focus.getLatest();return t===this.anchor&&r===this.focus?this:new L4(t,r,this.direction)}isCollapsed(){return this.anchor.isSamePointCaret(this.focus)}getTextSlices(){const t=s=>{const a=this[s].getLatest();return xf(a)?(function(i,o){const{direction:c,origin:u}=i,d=yf(u,o==="focus"?Gm(c):c);return w8(i,d-i.offset)})(a,s):null},r=t("anchor"),n=t("focus");if(r&&n){const{caret:s}=r,{caret:a}=n;if(s.isSameNodeCaret(a))return[w8(s,a.offset-s.offset),null]}return[r,n]}iterNodeCarets(t="root"){const r=xf(this.anchor)?this.anchor.getSiblingCaret():this.anchor.getLatest(),n=this.focus.getLatest(),s=xf(n),a=i=>i.isSameNodeCaret(n)?null:M4(i)||i.getParentCaret(t);return $4({hasNext:i=>i!==null&&!(s&&n.isSameNodeCaret(i)),initial:r.isSameNodeCaret(n)?null:a(r),map:i=>i,step:a})}[Symbol.iterator](){return this.iterNodeCarets("root")}}class Cre{type="slice";constructor(t,r){this.caret=t,this.distance=r}getSliceIndices(){const{distance:t,caret:{offset:r}}=this,n=r+t;return n<r?[n,r]:[r,n]}getTextContent(){const[t,r]=this.getSliceIndices();return this.caret.origin.getTextContent().slice(t,r)}getTextContentSize(){return Math.abs(this.distance)}removeTextSlice(){const{caret:{origin:t,direction:r}}=this,[n,s]=this.getSliceIndices(),a=t.getTextContent();return u0(t.setTextContent(a.slice(0,n)+a.slice(s)),r,n)}}function B4(e){return Cf(e,fi(ps(),e.direction))}function Tre(e){return Cf(e,e)}function Cf(e,t){return e.direction!==t.direction&&$t(265),new L4(e,t,e.direction)}function $4(e){const{initial:t,hasNext:r,step:n,map:s}=e;let a=t;return{[Symbol.iterator](){return this},next(){if(!r(a))return{done:!0,value:void 0};const i={done:!1,value:s(a)};return a=n(a),i}}}function I9(e,t){const r=nb(e.origin,t.origin);switch(r===null&&$t(275,e.origin.getKey(),t.origin.getKey()),r.type){case"same":{const n=e.type==="text",s=t.type==="text";return n&&s?(function(a,i){return Math.sign(a-i)})(e.offset,t.offset):e.type===t.type?0:n?-1:s?1:e.type==="child"?-1:1}case"ancestor":return e.type==="child"?-1:1;case"descendant":return t.type==="child"?1:-1;case"branch":return R9(r)}}function R9(e){const{a:t,b:r}=e,n=t.__key,s=r.__key;let a=t,i=r;for(;a&&i;a=a.getNextSibling(),i=i.getNextSibling()){if(a.__key===s)return-1;if(i.__key===n)return 1}return a===null?1:-1}function vw(e,t){return t.is(e)}function b8(e){return bt(e)?[e.getLatest(),null]:[e.getParent(),e.getLatest()]}function nb(e,t){if(e.is(t))return{commonAncestor:e,type:"same"};const r=new Map;for(let[n,s]=b8(e);n;s=n,n=n.getParent())r.set(n,s);for(let[n,s]=b8(t);n;s=n,n=n.getParent()){const a=r.get(n);if(a!==void 0)return a===null?(vw(e,n)||$t(276),{commonAncestor:n,type:"ancestor"}):s===null?(vw(t,n)||$t(277),{commonAncestor:n,type:"descendant"}):((bt(a)||vw(e,a))&&(bt(s)||vw(t,s))&&n.is(a.getParent())&&n.is(s.getParent())||$t(278),{a,b:s,commonAncestor:n,type:"branch"})}return null}function td(e,t){const{type:r,key:n,offset:s}=e,a=hre(e.key);return r==="text"?(er(a)||$t(266,a.getType(),n),u0(a,t,s)):(bt(a)||$t(267,a.getType(),n),Are(a,e.offset,t))}function d0(e,t){const{origin:r,direction:n}=t,s=n==="next";xf(t)?e.set(r.getKey(),t.offset,"text"):c0(t)?er(r)?e.set(r.getKey(),yf(r,n),"text"):e.set(r.getParentOrThrow().getKey(),r.getIndexWithinParent()+(s?1:0),"element"):(Yc(t)&&bt(r)||$t(268),e.set(r.getKey(),s?0:r.getChildrenSize(),"element"))}function Ere(e){const t=Zt(),r=Ot(t)?t:G_();return sb(r,e),hi(r),r}function sb(e,t){d0(e.anchor,t.anchor),d0(e.focus,t.focus)}function _8(e){const{anchor:t,focus:r}=e,n=td(t,"next"),s=td(r,"next"),a=I9(n,s)<=0?"next":"previous";return Cf(_m(n,a),_m(s,a))}function U4(e){const{direction:t,origin:r}=e,n=fi(r,Gm(t)).getNodeAtCaret();return n?fi(n,t):Nl(r.getParentOrThrow(),t)}function S8(e,t="root"){const r=[e];for(let n=Yc(e)?e.getParentCaret(t):e.getSiblingCaret();n!==null;n=n.getParentCaret(t))r.push(U4(n));return r}function dk(e){return!!e&&e.origin.isAttached()}function Nre(e,t="removeEmptySlices"){if(e.isCollapsed())return e;const r="root",n="next";let s=t;const a=L9(e,n),i=S8(a.anchor,r),o=S8(a.focus.getFlipped(),r),c=new Set,u=[];for(const x of a.iterNodeCarets(r))if(Yc(x))c.add(x.origin.getKey());else if(c0(x)){const{origin:v}=x;bt(v)&&!c.has(v.getKey())||u.push(v)}for(const x of u)x.remove();for(const x of a.getTextSlices()){if(!x)continue;const{origin:v}=x.caret,w=v.getTextContentSize(),C=U4(fi(v,n)),k=v.getMode();if(Math.abs(x.distance)===w&&s==="removeEmptySlices"||k==="token"&&x.distance!==0)C.remove();else if(x.distance!==0){s="removeEmptySlices";let b=x.removeTextSlice();const N=x.caret.origin;if(k==="segmented"){const E=b.origin,P=Ps(E.getTextContent()).setStyle(E.getStyle()).setFormat(E.getFormat());C.replaceOrInsert(P),b=u0(P,n,b.offset)}N.is(i[0].origin)&&(i[0]=b),N.is(o[0].origin)&&(o[0]=b.getFlipped())}}let d,h;for(const x of i)if(dk(x)){d=_l(x);break}for(const x of o)if(dk(x)){h=_l(x);break}const g=(function(x,v,w){if(!x||!v)return null;const C=x.getParentAtCaret(),k=v.getParentAtCaret();if(!C||!k)return null;const b=C.getParents().reverse();b.push(C);const N=k.getParents().reverse();N.push(k);const E=Math.min(b.length,N.length);let P;for(P=0;P<E&&b[P]===N[P];P++);const F=(I,B)=>{let Y;for(let Z=P;Z<I.length;Z++){const ae=I[Z];if(ro(ae))return;!Y&&B(ae)&&(Y=ae)}return Y},A=F(b,bl),j=A&&F(N,(I=>w.has(I.getKey())&&bl(I)));return A&&j?[A,j]:null})(d,h,c);if(g){const[x,v]=g;Nl(x,"previous").splice(0,v.getChildren()),v.remove()}const p=[d,h,...i,...o].find(dk);if(p)return Tre(_m(_l(p),e.direction));$t(269,JSON.stringify(i.map((x=>x.origin.__key))))}function _l(e){const t=(function(s){let a=s;for(;Yc(a);){const i=M4(a);if(!Yc(i))break;a=i}return a})(e.getLatest()),{direction:r}=t;if(er(t.origin))return xf(t)?t:u0(t.origin,r,r);const n=t.getAdjacentCaret();return c0(n)&&er(n.origin)?u0(n.origin,r,Gm(r)):t}function M9(e){return xf(e)&&e.offset!==yf(e.origin,e.direction)}function _m(e,t){return e.direction===t?e:e.getFlipped()}function L9(e,t){return e.direction===t?e:Cf(_m(e.focus,t),_m(e.anchor,t))}function Are(e,t,r){let n=Nl(e,"next");for(let s=0;s<t;s++){const a=n.getAdjacentCaret();if(a===null)break;n=a}return _m(n,r)}const B9=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,jre=B9?S.useLayoutEffect:S.useEffect,ww={tag:Sy};function $9({initialConfig:e,children:t}){const r=S.useMemo((()=>{const{theme:n,namespace:s,nodes:a,onError:i,editorState:o,html:c}=e,u=Qee(null,n),d=rre({editable:e.editable,html:c,namespace:s,nodes:a,onError:h=>i(h,d),theme:n});return(function(h,g){if(g!==null){if(g===void 0)h.update((()=>{const p=ps();if(p.isEmpty()){const x=ss();p.append(x);const v=B9?document.activeElement:null;(Zt()!==null||v!==null&&v===h.getRootElement())&&x.select()}}),ww);else if(g!==null)switch(typeof g){case"string":{const p=h.parseEditorState(g);h.setEditorState(p,ww);break}case"object":h.setEditorState(g,ww);break;case"function":h.update((()=>{ps().isEmpty()&&g(h)}),ww)}}})(d,o),[d,u]}),[]);return jre((()=>{const n=e.editable,[s]=r;s.setEditable(n===void 0||n)}),[]),l.jsx($m.Provider,{value:r,children:t})}const Pre=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?S.useLayoutEffect:S.useEffect;function Fre(e){return{initialValueFn:()=>e.isEditable(),subscribe:t=>e.registerEditableListener(t)}}function Ore(){return(function(e){const[t]=tu(),r=S.useMemo((()=>e(t)),[t,e]),[n,s]=S.useState((()=>r.initialValueFn())),a=S.useRef(n);return Pre((()=>{const{initialValueFn:i,subscribe:o}=r,c=i();return a.current!==c&&(a.current=c,s(c)),o((u=>{a.current=u,s(u)}))}),[r,e]),n})(Fre)}function Dre(){return ps().getTextContent()}function Ire(e,t=!0){if(e)return!1;let r=Dre();return t&&(r=r.trim()),r===""}function Rre(e){if(!Ire(e,!1))return!1;const t=ps().getChildren(),r=t.length;if(r>1)return!1;for(let n=0;n<r;n++){const s=t[n];if(vn(s))return!1;if(bt(s)){if(!_4(s)||s.__indent!==0)return!1;const a=s.getChildren(),i=a.length;for(let o=0;o<i;o++){const c=a[n];if(!er(c))return!1}}}return!0}function U9(e){return()=>Rre(e)}const rE=new Map;function z9(e){const t={};if(!e)return t;const r=e.split(";");for(const n of r)if(n!==""){const[s,a]=n.split(/:([^]+)/);s&&a&&(t[s.trim()]=a.trim())}return t}function k8(e){let t=rE.get(e);return t===void 0&&(t=z9(e),rE.set(e,t)),t}function W9(e){const t=Rv().getElementByKey(e.getKey());if(t===null)return null;const r=t.ownerDocument.defaultView;return r===null?null:r.getComputedStyle(t)}function H9(e){return W9(_a(e)?e:e.getParentOrThrow())}function C8(e){const t=H9(e);return t!==null&&t.direction==="rtl"}function G9(e,t){const r=e.getStartEndPoints();if(t.isSelected(e)&&!Ru(t)&&r!==null){const[n,s]=r,a=e.isBackward(),i=n.getNode(),o=s.getNode(),c=t.is(i),u=t.is(o);if(c||u){const[d,h]=qT(e),g=i.is(o),p=t.is(a?o:i),x=t.is(a?i:o);let v,w=0;g?(w=d>h?h:d,v=d>h?d:h):p?(w=a?h:d,v=void 0):x&&(w=0,v=a?d:h),t.__text=t.__text.slice(w,v)}}return t}function Mre(e){const t=e.getStyle(),r=z9(t);rE.set(t,r)}function Lre(e,t){const r=e.getFormatType(),n=e.getIndent();r!==t.getFormatType()&&t.setFormat(r),n!==t.getIndent()&&t.setIndent(n)}function lm(e,t,r=Lre){if(e===null)return;const n=e.getStartEndPoints(),s=new Map;let a=null;if(n){const[i,o]=n;a=G_(),a.anchor.set(i.key,i.offset,i.type),a.focus.set(o.key,o.offset,o.type);const c=fk(i.getNode(),bl),u=fk(o.getNode(),bl);bt(c)&&s.set(c.getKey(),c),bt(u)&&s.set(u.getKey(),u)}for(const i of e.getNodes())if(bt(i)&&bl(i))s.set(i.getKey(),i);else if(n===null){const o=fk(i,bl);bt(o)&&s.set(o.getKey(),o)}for(const[i,o]of s){const c=t();r(o,c),o.replace(c,!0),a&&(i===a.anchor.key&&a.anchor.set(c.getKey(),a.anchor.offset,a.anchor.type),i===a.focus.key&&a.focus.set(c.getKey(),a.focus.offset,a.focus.type))}a&&e.is(Zt())&&hi(a)}function V9(e){const t=K9(e);return t!==null&&t.writingMode==="vertical-rl"}function K9(e){const t=e.anchor.getNode();return bt(t)?W9(t):H9(t)}function T8(e,t){let r=V9(e)?!t:t;q9(e)&&(r=!r);const n=td(e.focus,r?"previous":"next");if(M9(n))return!1;for(const s of B4(n)){if(Yc(s))return!s.origin.isInline();if(!bt(s.origin)){if(vn(s.origin))return!0;break}}return!1}function Bre(e,t,r,n){e.modify(t?"extend":"move",r,n)}function q9(e){const t=K9(e);return t!==null&&t.direction==="rtl"}function E8(e,t,r){const n=q9(e);let s;s=V9(e)||n?!r:r,Bre(e,t,s,"character")}function fk(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function $re(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const Y9=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Ure=Y9&&"documentMode"in document?document.documentMode:null;!(!Y9||!("InputEvent"in window)||Ure)&&"getTargetRanges"in new window.InputEvent("input");function X9(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}function T0(...e){return()=>{for(let t=e.length-1;t>=0;t--)e[t]();e.length=0}}function wa(e,...t){const r=X9(...t);r.length>0&&e.classList.add(...r)}function vf(e,...t){const r=X9(...t);r.length>0&&e.classList.remove(...r)}function zre(e){return e?e.getAdjacentCaret():null}function Wre(e,t){let r=e;for(;r!=null;){if(r instanceof t)return r;r=r.getParent()}return null}function Hre(e){const t=J_(e,(r=>bt(r)&&!r.isInline()));return bt(t)||$re(4,e.__key),t}const J_=(e,t)=>{let r=e;for(;r!==ps()&&r!=null;){if(t(r))return r;r=r.getParent()}return null};function Oh(e,t){return e!==null&&Object.getPrototypeOf(e).constructor.name===t.name}function Q9(e,t){const r=[],n=Array.from(e).reverse();for(let s=n.pop();s!==void 0;s=n.pop())if(t(s))r.push(s);else if(bt(s))for(const a of Gre(s))n.push(a);return r}function Gre(e){return Vre(Nl(e,"previous"))}function Vre(e){return $4({hasNext:c0,initial:e.getAdjacentCaret(),map:t=>t.origin.getLatest(),step:t=>t.getAdjacentCaret()})}function Kre(e){const t=window.location.origin,r=n=>{if(n.origin!==t)return;const s=e.getRootElement();if(document.activeElement!==s)return;const a=n.data;if(typeof a=="string"){let i;try{i=JSON.parse(a)}catch{return}if(i&&i.protocol==="nuanria_messaging"&&i.type==="request"){const o=i.payload;if(o&&o.functionId==="makeChanges"){const c=o.args;if(c){const[u,d,h,g,p,x]=c;e.update((()=>{const v=Zt();if(Ot(v)){const w=v.anchor;let C=w.getNode(),k=0,b=0;if(er(C)&&u>=0&&d>=0&&(k=u,b=u+d,v.setTextNodeRange(C,k,C,b)),k===b&&h===""||(v.insertRawText(h),C=w.getNode()),er(C)){k=g,b=g+p;const N=C.getTextContentSize();k=k>N?N:k,b=b>N?N:b,v.setTextNodeRange(C,k,C,b)}n.stopImmediatePropagation()}}))}}}}};return window.addEventListener("message",r,!0),()=>{window.removeEventListener("message",r,!0)}}function qre(e,t){const r=t.body?t.body.childNodes:[];let n=[];const s=[];for(let a=0;a<r.length;a++){const i=r[a];if(!Z9.has(i.nodeName)){const o=eB(i,e,s,!1);o!==null&&(n=n.concat(o))}}return(function(a){for(const i of a)i.getNextSibling()instanceof b4&&i.insertAfter(Qc());for(const i of a){const o=i.getChildren();for(const c of o)i.insertBefore(c);i.remove()}})(s),n}function Yre(e,t){if(typeof document>"u"||typeof window>"u"&&global.window===void 0)throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");const r=document.createElement("div"),n=ps().getChildren();for(let s=0;s<n.length;s++)J9(e,n[s],r,t);return r.innerHTML}function J9(e,t,r,n=null){let s=n===null||t.isSelected(n);const a=bt(t)&&t.excludeFromCopy("html");let i=t;if(n!==null){let p=F4(t);p=er(p)&&n!==null?G9(n,p):p,i=p}const o=bt(i)?i.getChildren():[],c=k4(e,i.getType());let u;u=c&&c.exportDOM!==void 0?c.exportDOM(e,i):i.exportDOM(e);const{element:d,after:h}=u;if(!d)return!1;const g=document.createDocumentFragment();for(let p=0;p<o.length;p++){const x=o[p],v=J9(e,x,g,n);!s&&bt(t)&&v&&t.extractWithChild(x,n,"html")&&(s=!0)}if(s&&!a){if((as(d)||eE(d))&&d.append(g),r.append(d),h){const p=h.call(i,d);p&&(eE(d)?d.replaceChildren(p):d.replaceWith(p))}}else r.append(g);return s}const Z9=new Set(["STYLE","SCRIPT"]);function eB(e,t,r,n,s=new Map,a){let i=[];if(Z9.has(e.nodeName))return i;let o=null;const c=(function(x,v){const{nodeName:w}=x,C=v._htmlConversions.get(w.toLowerCase());let k=null;if(C!==void 0)for(const b of C){const N=b(x);N!==null&&(k===null||(k.priority||0)<=(N.priority||0))&&(k=N)}return k!==null?k.conversion:null})(e,t),u=c?c(e):null;let d=null;if(u!==null){d=u.after;const x=u.node;if(o=Array.isArray(x)?x[x.length-1]:x,o!==null){for(const[,v]of s)if(o=v(o,a),!o)break;o&&i.push(...Array.isArray(x)?x:[o])}u.forChild!=null&&s.set(e.nodeName,u.forChild)}const h=e.childNodes;let g=[];const p=(o==null||!ro(o))&&(o!=null&&YT(o)||n);for(let x=0;x<h.length;x++)g.push(...eB(h[x],t,r,p,new Map(s),o));return d!=null&&(g=d(g)),Pb(e)&&(g=Xre(e,g,p?()=>{const x=new b4;return r.push(x),x}:ss)),o==null?g.length>0?i=i.concat(g):Pb(e)&&(function(x){return x.nextSibling==null||x.previousSibling==null?!1:tE(x.nextSibling)&&tE(x.previousSibling)})(e)&&(i=i.concat(Qc())):bt(o)&&o.append(...g),i}function Xre(e,t,r){const n=e.style.textAlign,s=[];let a=[];for(let i=0;i<t.length;i++){const o=t[i];if(YT(o))n&&!o.getFormat()&&o.setFormat(n),s.push(o);else if(a.push(o),i===t.length-1||i<t.length-1&&YT(t[i+1])){const c=r();c.setFormat(n),c.append(...a),s.push(c),a=[]}}return s}function Fb(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function Qre(e,t=Zt()){return t==null&&Fb(166),Ot(t)&&t.isCollapsed()||t.getNodes().length===0?"":Yre(e,t)}function Jre(e,t=Zt()){return t==null&&Fb(166),Ot(t)&&t.isCollapsed()||t.getNodes().length===0?null:JSON.stringify(Zre(e,t))}function N8(e,t,r){const n=e.getData("application/x-lexical-editor");if(n)try{const o=JSON.parse(n);if(o.namespace===r._config.namespace&&Array.isArray(o.nodes))return A8(r,ene(o.nodes),t)}catch{}const s=e.getData("text/html"),a=e.getData("text/plain");if(s&&a!==s)try{const o=new DOMParser().parseFromString((function(c){return window.trustedTypes&&window.trustedTypes.createPolicy?window.trustedTypes.createPolicy("lexical",{createHTML:u=>u}).createHTML(c):c})(s),"text/html");return A8(r,qre(r,o),t)}catch{}const i=a||e.getData("text/uri-list");if(i!=null)if(Ot(t)){const o=i.split(/(\r?\n|\t)/);o[o.length-1]===""&&o.pop();for(let c=0;c<o.length;c++){const u=Zt();if(Ot(u)){const d=o[c];d===`
`||d===`\r
`?u.insertParagraph():d==="	"?u.insertNodes([zm()]):u.insertText(d)}}}else t.insertRawText(i)}function A8(e,t,r){e.dispatchCommand(kte,{nodes:t,selection:r})||(r.insertNodes(t),(function(n){if(Ot(n)&&n.isCollapsed()){const s=n.anchor;let a=null;const i=td(s,"previous");if(i)if(xf(i))a=i.origin;else{const o=Cf(i,Nl(ps(),"next").getFlipped());for(const c of o){if(er(c.origin)){a=c.origin;break}if(bt(c.origin)&&!c.origin.isInline())break}}if(a&&er(a)){const o=a.getFormat(),c=a.getStyle();n.format===o&&n.style===c||(n.format=o,n.style=c,n.dirty=!0)}}})(r))}function tB(e,t,r,n=[]){let s=t===null||r.isSelected(t);const a=bt(r)&&r.excludeFromCopy("html");let i=r;if(t!==null){let u=F4(r);u=er(u)&&t!==null?G9(t,u):u,i=u}const o=bt(i)?i.getChildren():[],c=(function(u){const d=u.exportJSON(),h=u.constructor;if(d.type!==h.getType()&&Fb(58,h.name),bt(u)){const g=d.children;Array.isArray(g)||Fb(59,h.name)}return d})(i);if(er(i)){const u=i.__text;u.length>0?c.text=u:s=!1}for(let u=0;u<o.length;u++){const d=o[u],h=tB(e,t,d,c.children);!s&&bt(r)&&h&&r.extractWithChild(d,t,"clone")&&(s=!0)}if(s&&!a)n.push(c);else if(Array.isArray(c.children))for(let u=0;u<c.children.length;u++){const d=c.children[u];n.push(d)}return s}function Zre(e,t){const r=[],n=ps().getChildren();for(let s=0;s<n.length;s++)tB(e,t,n[s],r);return{namespace:e._config.namespace,nodes:r}}function ene(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r],s=Yte(n);er(s)&&Mre(s),t.push(s)}return t}let Og=null;async function j8(e,t,r){if(Og!==null)return!1;if(t!==null)return new Promise(((u,d)=>{e.update((()=>{u(P8(e,t,r))}))}));const n=e.getRootElement(),s=e._window||window,a=window.document,i=dc(s);if(n===null||i===null)return!1;const o=a.createElement("span");o.style.cssText="position: fixed; top: -1000px;",o.append(a.createTextNode("#")),n.append(o);const c=new Range;return c.setStart(o,0),c.setEnd(o,1),i.removeAllRanges(),i.addRange(c),new Promise(((u,d)=>{const h=e.registerCommand(z_,(g=>(Oh(g,ClipboardEvent)&&(h(),Og!==null&&(window.clearTimeout(Og),Og=null),u(P8(e,g,r))),!0)),tre);Og=window.setTimeout((()=>{h(),Og=null,u(!1)}),50),a.execCommand("copy"),o.remove()}))}function P8(e,t,r){if(r===void 0){const s=dc(e._window);if(!s)return!1;const a=s.anchorNode,i=s.focusNode;if(a!==null&&i!==null&&!Dv(e,a,i))return!1;const o=Zt();if(o===null)return!1;r=rne(o)}t.preventDefault();const n=t.clipboardData;return n!==null&&(nne(n,r),!0)}const tne=[["text/html",Qre],["application/x-lexical-editor",Jre]];function rne(e=Zt()){const t={"text/plain":e?e.getTextContent():""};if(e){const r=Rv();for(const[n,s]of tne){const a=s(r,e);a!==null&&(t[n]=a)}}return t}function nne(e,t){for(const r in t){const n=t[r];n!==void 0&&e.setData(r,n)}}function F8(e,t){if(document.caretRangeFromPoint!==void 0){const r=document.caretRangeFromPoint(e,t);return r===null?null:{node:r.startContainer,offset:r.startOffset}}if(document.caretPositionFromPoint!=="undefined"){const r=document.caretPositionFromPoint(e,t);return r===null?null:{node:r.offsetNode,offset:r.offset}}return null}const Vm=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,sne=Vm&&"documentMode"in document?document.documentMode:null,ane=!(!Vm||!("InputEvent"in window)||sne)&&"getTargetRanges"in new window.InputEvent("input"),ine=Vm&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),O8=Vm&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,one=Vm&&/^(?=.*Chrome).*/i.test(navigator.userAgent),lne=Vm&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!one,D8=Pr("DRAG_DROP_PASTE_FILE");let Mv=class rB extends Di{static getType(){return"quote"}static clone(t){return new rB(t.__key)}createDOM(t){const r=document.createElement("blockquote");return wa(r,t.theme.quote),r}updateDOM(t,r){return!1}static importDOM(){return{blockquote:t=>({conversion:cne,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if(as(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return Lv().updateFromJSON(t)}insertNewAfter(t,r){const n=ss(),s=this.getDirection();return n.setDirection(s),this.insertAfter(n,r),n}collapseAtStart(){const t=ss();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}canMergeWhenEmpty(){return!0}};function Lv(){return ao(new Mv)}function I8(e){return e instanceof Mv}let Bv=class nB extends Di{static getType(){return"heading"}static clone(t){return new nB(t.__tag,t.__key)}constructor(t,r){super(r),this.__tag=t}getTag(){return this.__tag}setTag(t){const r=this.getWritable();return this.__tag=t,r}createDOM(t){const r=this.__tag,n=document.createElement(r),s=t.theme.heading;if(s!==void 0){const a=s[r];wa(n,a)}return n}updateDOM(t,r,n){return t.__tag!==this.__tag}static importDOM(){return{h1:t=>({conversion:Dg,priority:0}),h2:t=>({conversion:Dg,priority:0}),h3:t=>({conversion:Dg,priority:0}),h4:t=>({conversion:Dg,priority:0}),h5:t=>({conversion:Dg,priority:0}),h6:t=>({conversion:Dg,priority:0}),p:t=>{const r=t.firstChild;return r!==null&&R8(r)?{conversion:()=>({node:null}),priority:3}:null},span:t=>R8(t)?{conversion:r=>({node:ff("h1")}),priority:3}:null}}exportDOM(t){const{element:r}=super.exportDOM(t);if(as(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return ff(t.tag).updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTag(t.tag)}exportJSON(){return{...super.exportJSON(),tag:this.getTag()}}insertNewAfter(t,r=!0){const n=t?t.anchor.offset:0,s=this.getLastDescendant(),a=!s||t&&t.anchor.key===s.getKey()&&n===s.getTextContentSize()||!t?ss():ff(this.getTag()),i=this.getDirection();if(a.setDirection(i),this.insertAfter(a,r),n===0&&!this.isEmpty()&&t){const o=ss();o.select(),this.replace(o,!0)}return a}collapseAtStart(){const t=this.isEmpty()?ss():ff(this.getTag());return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}extractWithChild(){return!0}};function R8(e){return e.nodeName.toLowerCase()==="span"&&e.style.fontSize==="26pt"}function Dg(e){const t=e.nodeName.toLowerCase();let r=null;return t!=="h1"&&t!=="h2"&&t!=="h3"&&t!=="h4"&&t!=="h5"&&t!=="h6"||(r=ff(t),e.style!==null&&(O4(e,r),r.setFormat(e.style.textAlign))),{node:r}}function cne(e){const t=Lv();return e.style!==null&&(t.setFormat(e.style.textAlign),O4(e,t)),{node:t}}function ff(e="h1"){return ao(new Bv(e))}function une(e){return e instanceof Bv}function bw(e){let t=null;if(Oh(e,DragEvent)?t=e.dataTransfer:Oh(e,ClipboardEvent)&&(t=e.clipboardData),t===null)return[!1,[],!1];const r=t.types,n=r.includes("Files"),s=r.includes("text/html")||r.includes("text/plain");return[n,Array.from(t.files),s]}function M8(e){const t=Zt();if(!Ot(t))return!1;const r=new Set,n=t.getNodes();for(let s=0;s<n.length;s++){const a=n[s],i=a.getKey();if(r.has(i))continue;const o=J_(a,(u=>bt(u)&&!u.isInline()));if(o===null)continue;const c=o.getKey();o.canIndent()&&!r.has(c)&&(r.add(c),e(o))}return r.size>0}function L8(e){const t=kf(e);return vn(t)}function hk(e){for(const t of["lowercase","uppercase","capitalize"])e.hasFormat(t)&&e.toggleFormat(t)}function dne(e){return T0(e.registerCommand(u4,(t=>{const r=Zt();return!!Si(r)&&(r.clear(),!0)}),fn),e.registerCommand(zh,(t=>{const r=Zt();return Ot(r)?(r.deleteCharacter(t),!0):!!Si(r)&&(r.deleteNodes(),!0)}),fn),e.registerCommand(Ky,(t=>{const r=Zt();return!!Ot(r)&&(r.deleteWord(t),!0)}),fn),e.registerCommand(qy,(t=>{const r=Zt();return!!Ot(r)&&(r.deleteLine(t),!0)}),fn),e.registerCommand(am,(t=>{const r=Zt();if(typeof t=="string")r!==null&&r.insertText(t);else{if(r===null)return!1;const n=t.dataTransfer;if(n!=null)N8(n,r,e);else if(Ot(r)){const s=t.data;return s&&r.insertText(s),!0}}return!0}),fn),e.registerCommand(UT,(()=>{const t=Zt();return!!Ot(t)&&(t.removeText(),!0)}),fn),e.registerCommand(Pi,(t=>{const r=Zt();return!!Ot(r)&&(r.formatText(t),!0)}),fn),e.registerCommand(ZL,(t=>{const r=Zt();if(!Ot(r)&&!Si(r))return!1;const n=r.getNodes();for(const s of n){const a=J_(s,(i=>bt(i)&&!i.isInline()));a!==null&&a.setFormat(t)}return!0}),fn),e.registerCommand(sm,(t=>{const r=Zt();return!!Ot(r)&&(r.insertLineBreak(t),!0)}),fn),e.registerCommand(Vy,(()=>{const t=Zt();return!!Ot(t)&&(t.insertParagraph(),!0)}),fn),e.registerCommand(Nte,(()=>(Vte([zm()]),!0)),fn),e.registerCommand(Ate,(()=>M8((t=>{const r=t.getIndent();t.setIndent(r+1)}))),fn),e.registerCommand(UP,(()=>M8((t=>{const r=t.getIndent();r>0&&t.setIndent(Math.max(0,r-1))}))),fn),e.registerCommand(GL,(t=>{const r=Zt();if(Si(r)){const n=r.getNodes();if(n.length>0)return n[0].selectPrevious(),!0}else if(Ot(r)){const n=QT(r.focus,!0);if(!t.shiftKey&&vn(n)&&!n.isIsolated()&&!n.isInline())return n.selectPrevious(),t.preventDefault(),!0}return!1}),fn),e.registerCommand(VL,(t=>{const r=Zt();if(Si(r)){const n=r.getNodes();if(n.length>0)return n[0].selectNext(0,0),!0}else if(Ot(r)){if((function(s){const a=s.focus;return a.key==="root"&&a.offset===ps().getChildrenSize()})(r))return t.preventDefault(),!0;const n=QT(r.focus,!1);if(!t.shiftKey&&vn(n)&&!n.isIsolated()&&!n.isInline())return n.selectNext(),t.preventDefault(),!0}return!1}),fn),e.registerCommand(HL,(t=>{const r=Zt();if(Si(r)){const n=r.getNodes();if(n.length>0)return t.preventDefault(),C8(n[0])?n[0].selectNext(0,0):n[0].selectPrevious(),!0}if(!Ot(r))return!1;if(T8(r,!0)){const n=t.shiftKey;return t.preventDefault(),E8(r,n,!0),!0}return!1}),fn),e.registerCommand(WL,(t=>{const r=Zt();if(Si(r)){const s=r.getNodes();if(s.length>0)return t.preventDefault(),C8(s[0])?s[0].selectPrevious():s[0].selectNext(0,0),!0}if(!Ot(r))return!1;const n=t.shiftKey;return!!T8(r,!1)&&(t.preventDefault(),E8(r,n,!1),!0)}),fn),e.registerCommand(qL,(t=>{if(L8(t.target))return!1;const r=Zt();if(Ot(r)){if((function(n){if(!n.isCollapsed())return!1;const{anchor:s}=n;if(s.offset!==0)return!1;const a=s.getNode();if(_a(a))return!1;const i=Hre(a);return i.getIndent()>0&&(i.is(a)||a.is(i.getFirstDescendant()))})(r))return t.preventDefault(),e.dispatchCommand(UP,void 0);if(O8&&navigator.language==="ko-KR")return!1}else if(!Si(r))return!1;return t.preventDefault(),e.dispatchCommand(zh,!0)}),fn),e.registerCommand(XL,(t=>{if(L8(t.target))return!1;const r=Zt();return!(!Ot(r)&&!Si(r))&&(t.preventDefault(),e.dispatchCommand(zh,!1))}),fn),e.registerCommand(kb,(t=>{const r=Zt();if(!Ot(r))return!1;if(hk(r),t!==null){if((O8||ine||lne)&&ane)return!1;if(t.preventDefault(),t.shiftKey)return e.dispatchCommand(sm,!1)}return e.dispatchCommand(Vy,void 0)}),fn),e.registerCommand(YL,(()=>{const t=Zt();return!!Ot(t)&&(e.blur(),!0)}),fn),e.registerCommand(JL,(t=>{const[,r]=bw(t);if(r.length>0){const s=F8(t.clientX,t.clientY);if(s!==null){const{offset:a,node:i}=s,o=kf(i);if(o!==null){const c=G_();if(er(o))c.anchor.set(o.getKey(),a,"text"),c.focus.set(o.getKey(),a,"text");else{const d=o.getParentOrThrow().getKey(),h=o.getIndexWithinParent()+1;c.anchor.set(d,h,"element"),c.focus.set(d,h,"element")}const u=vb(c);hi(u)}e.dispatchCommand(D8,r)}return t.preventDefault(),!0}const n=Zt();return!!Ot(n)}),fn),e.registerCommand(e9,(t=>{const[r]=bw(t),n=Zt();return!(r&&!Ot(n))}),fn),e.registerCommand(t9,(t=>{const[r]=bw(t),n=Zt();if(r&&!Ot(n))return!1;const s=F8(t.clientX,t.clientY);if(s!==null){const a=kf(s.node);vn(a)&&t.preventDefault()}return!0}),fn),e.registerCommand(zT,(()=>(lre(),!0)),fn),e.registerCommand(z_,(t=>(j8(e,Oh(t,ClipboardEvent)?t:null),!0)),fn),e.registerCommand(g4,(t=>((async function(r,n){await j8(n,Oh(r,ClipboardEvent)?r:null),n.update((()=>{const s=Zt();Ot(s)?s.removeText():Si(s)&&s.getNodes().forEach((a=>a.remove()))}))})(t,e),!0)),fn),e.registerCommand(d4,(t=>{const[,r,n]=bw(t);return r.length>0&&!n?(e.dispatchCommand(D8,r),!0):Hm(t.target)&&C4(t.target)?!1:Zt()!==null&&((function(s,a){s.preventDefault(),a.update((()=>{const i=Zt(),o=Oh(s,InputEvent)||Oh(s,KeyboardEvent)?null:s.clipboardData;o!=null&&i!==null&&N8(o,i,a)}),{tag:Qte})})(t,e),!0)}),fn),e.registerCommand(KL,(t=>{const r=Zt();return Ot(r)&&hk(r),!1}),fn),e.registerCommand(QL,(t=>{const r=Zt();return Ot(r)&&hk(r),!1}),fn))}const nE=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?S.useLayoutEffect:S.useEffect;function B8(e){return e.getEditorState().read(U9(e.isComposing()))}function sB({contentEditable:e,placeholder:t=null,ErrorBoundary:r}){const[n]=tu(),s=(function(a,i){const[o,c]=S.useState((()=>a.getDecorators()));return nE((()=>a.registerDecoratorListener((u=>{iT.flushSync((()=>{c(u)}))}))),[a]),S.useEffect((()=>{c(a.getDecorators())}),[a]),S.useMemo((()=>{const u=[],d=Object.keys(o);for(let h=0;h<d.length;h++){const g=d[h],p=l.jsx(i,{onError:v=>a._onError(v),children:l.jsx(S.Suspense,{fallback:null,children:o[g]})}),x=a.getElementByKey(g);x!==null&&u.push(iT.createPortal(p,x,g))}return u}),[i,o,a])})(n,r);return(function(a){nE((()=>T0(dne(a),Kre(a))),[a])})(n),l.jsxs(l.Fragment,{children:[e,l.jsx(fne,{content:t}),s]})}function fne({content:e}){const[t]=tu(),r=(function(s){const[a,i]=S.useState((()=>B8(s)));return nE((()=>{function o(){const c=B8(s);i(c)}return o(),T0(s.registerUpdateListener((()=>{o()})),s.registerEditableListener((()=>{o()})))}),[s]),a})(t),n=Ore();return r?typeof e=="function"?e(n):e:null}const aB=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?S.useLayoutEffect:S.useEffect;function hne({editor:e,ariaActiveDescendant:t,ariaAutoComplete:r,ariaControls:n,ariaDescribedBy:s,ariaErrorMessage:a,ariaExpanded:i,ariaInvalid:o,ariaLabel:c,ariaLabelledBy:u,ariaMultiline:d,ariaOwns:h,ariaRequired:g,autoCapitalize:p,className:x,id:v,role:w="textbox",spellCheck:C=!0,style:k,tabIndex:b,"data-testid":N,...E},P){const[F,A]=S.useState(e.isEditable()),j=S.useCallback((B=>{B&&B.ownerDocument&&B.ownerDocument.defaultView?e.setRootElement(B):e.setRootElement(null)}),[e]),I=S.useMemo((()=>(function(...B){return Y=>{B.forEach((Z=>{typeof Z=="function"?Z(Y):Z!=null&&(Z.current=Y)}))}})(P,j)),[j,P]);return aB((()=>(A(e.isEditable()),e.registerEditableListener((B=>{A(B)})))),[e]),l.jsx("div",{"aria-activedescendant":F?t:void 0,"aria-autocomplete":F?r:"none","aria-controls":F?n:void 0,"aria-describedby":s,...a!=null?{"aria-errormessage":a}:{},"aria-expanded":F&&w==="combobox"?!!i:void 0,...o!=null?{"aria-invalid":o}:{},"aria-label":c,"aria-labelledby":u,"aria-multiline":d,"aria-owns":F?h:void 0,"aria-readonly":!F||void 0,"aria-required":g,autoCapitalize:p,className:x,contentEditable:F,"data-testid":N,id:v,ref:I,role:w,spellCheck:C,style:k,tabIndex:b,...E})}const gne=S.forwardRef(hne);function $8(e){return e.getEditorState().read(U9(e.isComposing()))}const iB=S.forwardRef(mne);function mne(e,t){const{placeholder:r,...n}=e,[s]=tu();return l.jsxs(l.Fragment,{children:[l.jsx(gne,{editor:s,...n,ref:t}),r!=null&&l.jsx(pne,{editor:s,content:r})]})}function pne({content:e,editor:t}){const r=(function(i){const[o,c]=S.useState((()=>$8(i)));return aB((()=>{function u(){const d=$8(i);c(d)}return u(),T0(i.registerUpdateListener((()=>{u()})),i.registerEditableListener((()=>{u()})))}),[i]),o})(t),[n,s]=S.useState(t.isEditable());if(S.useLayoutEffect((()=>(s(t.isEditable()),t.registerEditableListener((i=>{s(i)})))),[t]),!r)return null;let a=null;return typeof e=="function"?a=e(n):e!==null&&(a=e),a===null?null:l.jsx("div",{"aria-hidden":!0,children:a})}const _w=0,sE=1,aE=2,tc=0,xne=1,U8=2,yne=3,vne=4;function wne(e,t,r,n,s){if(e===null||r.size===0&&n.size===0&&!s)return tc;const a=t._selection,i=e._selection;if(s)return xne;if(!(Ot(a)&&Ot(i)&&i.isCollapsed()&&a.isCollapsed()))return tc;const o=(function(C,k,b){const N=C._nodeMap,E=[];for(const P of k){const F=N.get(P);F!==void 0&&E.push(F)}for(const[P,F]of b){if(!F)continue;const A=N.get(P);A===void 0||_a(A)||E.push(A)}return E})(t,r,n);if(o.length===0)return tc;if(o.length>1){const C=t._nodeMap,k=C.get(a.anchor.key),b=C.get(i.anchor.key);return k&&b&&!e._nodeMap.has(k.__key)&&er(k)&&k.__text.length===1&&a.anchor.offset===1?U8:tc}const c=o[0],u=e._nodeMap.get(c.__key);if(!er(u)||!er(c)||u.__mode!==c.__mode)return tc;const d=u.__text,h=c.__text;if(d===h)return tc;const g=a.anchor,p=i.anchor;if(g.key!==p.key||g.type!=="text")return tc;const x=g.offset,v=p.offset,w=h.length-d.length;return w===1&&v===x-1?U8:w===-1&&v===x+1?yne:w===-1&&v===x?vne:tc}function bne(e,t){let r=Date.now(),n=tc;return(s,a,i,o,c,u)=>{const d=Date.now();if(u.has(Nb))return n=tc,r=d,aE;const h=wne(s,a,o,c,e.isComposing()),g=(()=>{const p=i===null||i.editor===e,x=u.has(Xte);if(!x&&p&&u.has(Sy))return _w;if(s===null)return sE;const v=a._selection;return o.size>0||c.size>0?x===!1&&h!==tc&&h===n&&d<r+t&&p||o.size===1&&(function(w,C,k){const b=C._nodeMap.get(w),N=k._nodeMap.get(w),E=C._selection,P=k._selection;return!(Ot(E)&&Ot(P)&&E.anchor.type==="element"&&E.focus.type==="element"&&P.anchor.type==="text"&&P.focus.type==="text"||!er(b)||!er(N)||b.__parent!==N.__parent)&&JSON.stringify(C.read((()=>b.exportJSON())))===JSON.stringify(k.read((()=>N.exportJSON())))})(Array.from(o)[0],s,a)?_w:sE:v!==null?_w:aE})();return r=d,n=h,g}}function z8(e){e.undoStack=[],e.redoStack=[],e.current=null}function _ne(e,t,r){const n=bne(e,r);return T0(e.registerCommand(f4,(()=>((function(a,i){const o=i.redoStack,c=i.undoStack;if(c.length!==0){const u=i.current,d=c.pop();u!==null&&(o.push(u),a.dispatchCommand(hw,!0)),c.length===0&&a.dispatchCommand(gw,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:Nb})}})(e,t),!0)),fn),e.registerCommand(h4,(()=>((function(a,i){const o=i.redoStack,c=i.undoStack;if(o.length!==0){const u=i.current;u!==null&&(c.push(u),a.dispatchCommand(gw,!0));const d=o.pop();o.length===0&&a.dispatchCommand(hw,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:Nb})}})(e,t),!0)),fn),e.registerCommand(Pte,(()=>(z8(t),!1)),fn),e.registerCommand(Fte,(()=>(z8(t),e.dispatchCommand(hw,!1),e.dispatchCommand(gw,!1),!0)),fn),e.registerUpdateListener((({editorState:a,prevEditorState:i,dirtyLeaves:o,dirtyElements:c,tags:u})=>{const d=t.current,h=t.redoStack,g=t.undoStack,p=d===null?null:d.editorState;if(d!==null&&a===p)return;const x=n(i,a,d,o,c,u);if(x===sE)h.length!==0&&(t.redoStack=[],e.dispatchCommand(hw,!1)),d!==null&&(g.push({...d}),e.dispatchCommand(gw,!0));else if(x===aE)return;t.current={editor:e,editorState:a}})))}function Sne(){return{current:null,redoStack:[],undoStack:[]}}function oB({delay:e,externalHistoryState:t}){const[r]=tu();return(function(n,s,a=1e3){const i=S.useMemo((()=>s||Sne()),[s]);S.useEffect((()=>_ne(n,i,a)),[a,n,i])})(r,t,e),null}function lB({defaultSelection:e}){const[t]=tu();return S.useEffect((()=>{t.focus((()=>{const r=document.activeElement,n=t.getRootElement();n===null||r!==null&&n.contains(r)||n.focus({preventScroll:!0})}),{defaultSelection:e})}),[e,t]),null}function iE(e,t){return iE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},iE(e,t)}var W8={error:null},kne=(function(e){var t,r;function n(){for(var a,i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];return(a=e.call.apply(e,[this].concat(o))||this).state=W8,a.resetErrorBoundary=function(){for(var u,d=arguments.length,h=new Array(d),g=0;g<d;g++)h[g]=arguments[g];a.props.onReset==null||(u=a.props).onReset.apply(u,h),a.reset()},a}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,iE(t,r),n.getDerivedStateFromError=function(a){return{error:a}};var s=n.prototype;return s.reset=function(){this.setState(W8)},s.componentDidCatch=function(a,i){var o,c;(o=(c=this.props).onError)==null||o.call(c,a,i)},s.componentDidUpdate=function(a,i){var o,c,u,d,h=this.state.error,g=this.props.resetKeys;h!==null&&i.error!==null&&((u=a.resetKeys)===void 0&&(u=[]),(d=g)===void 0&&(d=[]),u.length!==d.length||u.some((function(p,x){return!Object.is(p,d[x])})))&&((o=(c=this.props).onResetKeysChange)==null||o.call(c,a.resetKeys,g),this.reset())},s.render=function(){var a=this.state.error,i=this.props,o=i.fallbackRender,c=i.FallbackComponent,u=i.fallback;if(a!==null){var d={error:a,resetErrorBoundary:this.resetErrorBoundary};if(S.isValidElement(u))return u;if(typeof o=="function")return o(d);if(c)return S.createElement(c,d);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},n})(S.Component);function cB({children:e,onError:t}){return l.jsx(kne,{fallback:l.jsx("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"},children:"An error was thrown."}),onError:t,children:e})}const z4=/^(\d+(?:\.\d+)?)px$/,cm={BOTH:3,NO_STATUS:0,ROW:1};class Km extends Di{static getType(){return"tablecell"}static clone(t){return new Km(t.__headerState,t.__colSpan,t.__width,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__rowSpan=t.__rowSpan,this.__backgroundColor=t.__backgroundColor,this.__verticalAlign=t.__verticalAlign}static importDOM(){return{td:t=>({conversion:H8,priority:0}),th:t=>({conversion:H8,priority:0})}}static importJSON(t){return uB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeaderStyles(t.headerState).setColSpan(t.colSpan||1).setRowSpan(t.rowSpan||1).setWidth(t.width||void 0).setBackgroundColor(t.backgroundColor||null).setVerticalAlign(t.verticalAlign||void 0)}constructor(t=cm.NO_STATUS,r=1,n,s){super(s),this.__colSpan=r,this.__rowSpan=1,this.__headerState=t,this.__width=n,this.__backgroundColor=null,this.__verticalAlign=void 0}createDOM(t){const r=document.createElement(this.getTag());return this.__width&&(r.style.width=`${this.__width}px`),this.__colSpan>1&&(r.colSpan=this.__colSpan),this.__rowSpan>1&&(r.rowSpan=this.__rowSpan),this.__backgroundColor!==null&&(r.style.backgroundColor=this.__backgroundColor),oE(this.__verticalAlign)&&(r.style.verticalAlign=this.__verticalAlign),wa(r,t.theme.tableCell,this.hasHeader()&&t.theme.tableCellHeader),r}exportDOM(t){const r=super.exportDOM(t);if(as(r.element)){const n=r.element;n.setAttribute("data-temporary-table-cell-lexical-key",this.getKey()),n.style.border="1px solid black",this.__colSpan>1&&(n.colSpan=this.__colSpan),this.__rowSpan>1&&(n.rowSpan=this.__rowSpan),n.style.width=`${this.getWidth()||75}px`,n.style.verticalAlign=this.getVerticalAlign()||"top",n.style.textAlign="start",this.__backgroundColor===null&&this.hasHeader()&&(n.style.backgroundColor="#f2f3f5")}return r}exportJSON(){return{...super.exportJSON(),...oE(this.__verticalAlign)&&{verticalAlign:this.__verticalAlign},backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,width:this.getWidth()}}getColSpan(){return this.getLatest().__colSpan}setColSpan(t){const r=this.getWritable();return r.__colSpan=t,r}getRowSpan(){return this.getLatest().__rowSpan}setRowSpan(t){const r=this.getWritable();return r.__rowSpan=t,r}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(t,r=cm.BOTH){const n=this.getWritable();return n.__headerState=t&r|n.__headerState&~r,n}getHeaderStyles(){return this.getLatest().__headerState}setWidth(t){const r=this.getWritable();return r.__width=t,r}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(t){const r=this.getWritable();return r.__backgroundColor=t,r}getVerticalAlign(){return this.getLatest().__verticalAlign}setVerticalAlign(t){const r=this.getWritable();return r.__verticalAlign=t||void 0,r}toggleHeaderStyle(t){const r=this.getWritable();return(r.__headerState&t)===t?r.__headerState-=t:r.__headerState+=t,r}hasHeaderState(t){return(this.getHeaderStyles()&t)===t}hasHeader(){return this.getLatest().__headerState!==cm.NO_STATUS}updateDOM(t){return t.__headerState!==this.__headerState||t.__width!==this.__width||t.__colSpan!==this.__colSpan||t.__rowSpan!==this.__rowSpan||t.__backgroundColor!==this.__backgroundColor||t.__verticalAlign!==this.__verticalAlign}isShadowRoot(){return!0}collapseAtStart(){return!0}canBeEmpty(){return!1}canIndent(){return!1}}function oE(e){return e==="middle"||e==="bottom"}function H8(e){const t=e,r=e.nodeName.toLowerCase();let n;z4.test(t.style.width)&&(n=parseFloat(t.style.width));const s=uB(r==="th"?cm.ROW:cm.NO_STATUS,t.colSpan,n);s.__rowSpan=t.rowSpan;const a=t.style.backgroundColor;a!==""&&(s.__backgroundColor=a);const i=t.style.verticalAlign;oE(i)&&(s.__verticalAlign=i);const o=t.style,c=(o&&o.textDecoration||"").split(" "),u=o.fontWeight==="700"||o.fontWeight==="bold",d=c.includes("line-through"),h=o.fontStyle==="italic",g=c.includes("underline");return{after:p=>{const x=[];let v=null;const w=()=>{if(v){const C=v.getFirstChild();Vu(C)&&v.getChildrenSize()===1&&C.remove()}};for(const C of p)dre(C)||er(C)||Vu(C)?(er(C)&&(u&&C.toggleFormat("bold"),d&&C.toggleFormat("strikethrough"),h&&C.toggleFormat("italic"),g&&C.toggleFormat("underline")),v?v.append(C):(v=ss().append(C),x.push(v))):(x.push(C),w(),v=null);return w(),x.length===0&&x.push(ss()),x},node:s}}function uB(e=cm.NO_STATUS,t=1,r){return ao(new Km(e,t,r))}function Xy(e){return e instanceof Km}function lE(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}class qm extends Di{static getType(){return"tablerow"}static clone(t){return new qm(t.__height,t.__key)}static importDOM(){return{tr:t=>({conversion:Cne,priority:0})}}static importJSON(t){return dB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeight(t.height)}constructor(t,r){super(r),this.__height=t}exportJSON(){const t=this.getHeight();return{...super.exportJSON(),...t===void 0?void 0:{height:t}}}createDOM(t){const r=document.createElement("tr");return this.__height&&(r.style.height=`${this.__height}px`),wa(r,t.theme.tableRow),r}extractWithChild(t,r,n){return n==="html"}isShadowRoot(){return!0}setHeight(t){const r=this.getWritable();return r.__height=t,r}getHeight(){return this.getLatest().__height}updateDOM(t){return t.__height!==this.__height}canBeEmpty(){return!1}canIndent(){return!1}}function Cne(e){const t=e;let r;return z4.test(t.style.height)&&(r=parseFloat(t.style.height)),{after:n=>Q9(n,Xy),node:dB(r)}}function dB(e){return ao(new qm(e))}function fB(e){return e instanceof qm}const hB=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Tne=hB&&"documentMode"in document?document.documentMode:null;hB&&"InputEvent"in window&&!Tne&&new window.InputEvent("input");function Ene(e,t,r){const n=[];let s=null,a=null;function i(c){let u=n[c];return u===void 0&&(n[c]=u=[]),u}const o=e.getChildren();for(let c=0;c<o.length;c++){const u=o[c];fB(u)||lE(209);const d=i(c);for(let h=u.getFirstChild(),g=0;h!=null;h=h.getNextSibling()){for(Xy(h)||lE(147);d[g]!==void 0;)g++;const p={cell:h,startColumn:g,startRow:c},{__rowSpan:x,__colSpan:v}=h;for(let w=0;w<x&&!(c+w>=o.length);w++){const C=i(c+w);for(let k=0;k<v;k++)C[g+k]=p}}}return[n,s,a]}function Kx(e){return as(e)&&e.nodeName==="TABLE"}function Nne(e,t){for(let r=t,n=null;r!==null;r=r.getParent()){if(e.is(r))return n;Xy(r)&&(n=r)}return null}function Ane(e,t,r){return Nne(e,kf(t,r))}function G8(e,t,r){if(!t.theme.tableAlignment)return;const n=[],s=[];for(const a of["center","right"]){const i=t.theme.tableAlignment[a];i&&(a===r?s:n).push(i)}vf(e,...n),wa(e,...s)}const jne=new WeakSet;function V8(e=Rv()){return jne.has(e)}class $v extends Di{static getType(){return"table"}getColWidths(){return this.getLatest().__colWidths}setColWidths(t){const r=this.getWritable();return r.__colWidths=t,r}static clone(t){return new $v(t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__colWidths=t.__colWidths,this.__rowStriping=t.__rowStriping,this.__frozenColumnCount=t.__frozenColumnCount,this.__frozenRowCount=t.__frozenRowCount}static importDOM(){return{table:t=>({conversion:Pne,priority:1})}}static importJSON(t){return gB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setRowStriping(t.rowStriping||!1).setFrozenColumns(t.frozenColumnCount||0).setFrozenRows(t.frozenRowCount||0).setColWidths(t.colWidths)}constructor(t){super(t),this.__rowStriping=!1,this.__frozenColumnCount=0,this.__frozenRowCount=0}exportJSON(){return{...super.exportJSON(),colWidths:this.getColWidths(),frozenColumnCount:this.__frozenColumnCount?this.__frozenColumnCount:void 0,frozenRowCount:this.__frozenRowCount?this.__frozenRowCount:void 0,rowStriping:this.__rowStriping?this.__rowStriping:void 0}}extractWithChild(t,r,n){return n==="html"}getDOMSlot(t){const r=Kx(t)?t:t.querySelector("table");return Kx(r)||lE(229),super.getDOMSlot(t).withElement(r).withAfter(r.querySelector("colgroup"))}createDOM(t,r){const n=document.createElement("table");this.__style&&(n.style.cssText=this.__style);const s=document.createElement("colgroup");if(n.appendChild(s),pre(s),wa(n,t.theme.table),this.updateTableElement(null,n,t),V8(r)){const a=document.createElement("div"),i=t.theme.tableScrollableWrapper;return i?wa(a,i):a.style.cssText="overflow-x: auto;",a.appendChild(n),this.updateTableWrapper(null,a,n,t),a}return n}updateTableWrapper(t,r,n,s){this.__frozenColumnCount!==(t?t.__frozenColumnCount:0)&&(function(a,i,o,c){c>0?(wa(a,o.theme.tableFrozenColumn),i.setAttribute("data-lexical-frozen-column","true")):(vf(a,o.theme.tableFrozenColumn),i.removeAttribute("data-lexical-frozen-column"))})(r,n,s,this.__frozenColumnCount),this.__frozenRowCount!==(t?t.__frozenRowCount:0)&&(function(a,i,o,c){c>0?(wa(a,o.theme.tableFrozenRow),i.setAttribute("data-lexical-frozen-row","true")):(vf(a,o.theme.tableFrozenRow),i.removeAttribute("data-lexical-frozen-row"))})(r,n,s,this.__frozenRowCount)}updateTableElement(t,r,n){this.__style!==(t?t.__style:"")&&(r.style.cssText=this.__style),this.__rowStriping!==(!!t&&t.__rowStriping)&&(function(s,a,i){i?(wa(s,a.theme.tableRowStriping),s.setAttribute("data-lexical-row-striping","true")):(vf(s,a.theme.tableRowStriping),s.removeAttribute("data-lexical-row-striping"))})(r,n,this.__rowStriping),(function(s,a,i,o){const c=s.querySelector("colgroup");if(!c)return;const u=[];for(let d=0;d<i;d++){const h=document.createElement("col"),g=o&&o[d];g&&(h.style.width=`${g}px`),u.push(h)}c.replaceChildren(...u)})(r,0,this.getColumnCount(),this.getColWidths()),G8(r,n,this.getFormatType())}updateDOM(t,r,n){const s=this.getDOMSlot(r).element;return r===s===V8()||(as(a=r)&&a.nodeName==="DIV"&&this.updateTableWrapper(t,r,s,n),this.updateTableElement(t,s,n),!1);var a}exportDOM(t){const r=super.exportDOM(t),{element:n}=r;return{after:s=>{if(r.after&&(s=r.after(s)),!Kx(s)&&as(s)&&(s=s.querySelector("table")),!Kx(s))return null;G8(s,t._config,this.getFormatType());const[a]=Ene(this),i=new Map;for(const d of a)for(const h of d){const g=h.cell.getKey();i.has(g)||i.set(g,{colSpan:h.cell.getColSpan(),startColumn:h.startColumn})}const o=new Set;for(const d of s.querySelectorAll(":scope > tr > [data-temporary-table-cell-lexical-key]")){const h=d.getAttribute("data-temporary-table-cell-lexical-key");if(h){const g=i.get(h);if(d.removeAttribute("data-temporary-table-cell-lexical-key"),g){i.delete(h);for(let p=0;p<g.colSpan;p++)o.add(p+g.startColumn)}}}const c=s.querySelector(":scope > colgroup");if(c){const d=Array.from(s.querySelectorAll(":scope > colgroup > col")).filter(((h,g)=>o.has(g)));c.replaceChildren(...d)}const u=s.querySelectorAll(":scope > tr");if(u.length>0){const d=document.createElement("tbody");for(const h of u)d.appendChild(h);s.append(d)}return s},element:!Kx(n)&&as(n)?n.querySelector("table"):n}}canBeEmpty(){return!1}isShadowRoot(){return!0}getCordsFromCellNode(t,r){const{rows:n,domRows:s}=r;for(let a=0;a<n;a++){const i=s[a];if(i!=null)for(let o=0;o<i.length;o++){const c=i[o];if(c==null)continue;const{elem:u}=c,d=Ane(this,u);if(d!==null&&t.is(d))return{x:o,y:a}}}throw new Error("Cell not found in table.")}getDOMCellFromCords(t,r,n){const{domRows:s}=n,a=s[r];if(a==null)return null;const i=a[t<a.length?t:a.length-1];return i??null}getDOMCellFromCordsOrThrow(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(!s)throw new Error("Cell not found at cords.");return s}getCellNodeFromCords(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(s==null)return null;const a=kf(s.elem);return Xy(a)?a:null}getCellNodeFromCordsOrThrow(t,r,n){const s=this.getCellNodeFromCords(t,r,n);if(!s)throw new Error("Node at cords not TableCellNode.");return s}getRowStriping(){return!!this.getLatest().__rowStriping}setRowStriping(t){const r=this.getWritable();return r.__rowStriping=t,r}setFrozenColumns(t){const r=this.getWritable();return r.__frozenColumnCount=t,r}getFrozenColumns(){return this.getLatest().__frozenColumnCount}setFrozenRows(t){const r=this.getWritable();return r.__frozenRowCount=t,r}getFrozenRows(){return this.getLatest().__frozenRowCount}canSelectBefore(){return!0}canIndent(){return!1}getColumnCount(){const t=this.getFirstChild();if(!t)return 0;let r=0;return t.getChildren().forEach((n=>{Xy(n)&&(r+=n.getColSpan())})),r}}function Pne(e){const t=gB();e.hasAttribute("data-lexical-row-striping")&&t.setRowStriping(!0),e.hasAttribute("data-lexical-frozen-column")&&t.setFrozenColumns(1),e.hasAttribute("data-lexical-frozen-row")&&t.setFrozenRows(1);const r=e.querySelector(":scope > colgroup");if(r){let n=[];for(const s of r.querySelectorAll(":scope > col")){let a=s.style.width||"";if(!z4.test(a)&&(a=s.getAttribute("width")||"",!/^\d+$/.test(a))){n=void 0;break}n.push(parseFloat(a))}n&&t.setColWidths(n)}return{after:n=>Q9(n,fB),node:t}}function gB(){return ao(new $v)}function hf(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function cE(e){let t=1,r=e.getParent();for(;r!=null;){if(Cn(r)){const n=r.getParent();if(Vr(n)){t++,r=n.getParent();continue}hf(40)}return t}return t}function uE(e){let t=e.getParent();Vr(t)||hf(40);let r=t;for(;r!==null;)r=r.getParent(),Vr(r)&&(t=r);return t}function mB(e){let t=[];const r=e.getChildren().filter(Cn);for(let n=0;n<r.length;n++){const s=r[n],a=s.getFirstChild();Vr(a)?t=t.concat(mB(a)):t.push(s)}return t}function Wc(e){return Cn(e)&&Vr(e.getFirstChild())}function K8(e){return qo().append(e)}function pB(e,t){return Cn(e)&&(t.length===0||t.length===1&&e.is(t[0])&&e.getChildrenSize()===0)}function q8(e){const t=Zt();if(t!==null){let r=t.getNodes();if(Ot(t)){const s=t.getStartEndPoints();s===null&&hf(143);const[a]=s,i=a.getNode(),o=i.getParent();if(ro(i)){const c=i.getFirstChild();if(c)r=c.selectStart().getNodes();else{const u=ss();i.append(u),r=u.select().getNodes()}}else if(pB(i,r)){const c=ko(e);if(ro(o)){i.replace(c);const u=qo();bt(i)&&(u.setFormat(i.getFormatType()),u.setIndent(i.getIndent())),c.append(u)}else if(Cn(i)){const u=i.getParentOrThrow();f0(c,u.getChildren()),u.replace(c)}return}}const n=new Set;for(let s=0;s<r.length;s++){const a=r[s];if(bt(a)&&a.isEmpty()&&!Cn(a)&&!n.has(a.getKey())){Y8(a,e);continue}let i=C9(a)?a.getParent():Cn(a)&&a.isEmpty()?a:null;for(;i!=null;){const o=i.getKey();if(Vr(i)){if(!n.has(o)){const c=ko(e);f0(c,i.getChildren()),i.replace(c),n.add(o)}break}{const c=i.getParent();if(ro(c)&&!n.has(o)){n.add(o),Y8(i,e);break}i=c}}}}}function f0(e,t){e.splice(e.getChildrenSize(),0,t)}function Y8(e,t){if(Vr(e))return e;const r=e.getPreviousSibling(),n=e.getNextSibling(),s=qo();let a;if(f0(s,e.getChildren()),Vr(r)&&t===r.getListType())r.append(s),Vr(n)&&t===n.getListType()&&(f0(r,n.getChildren()),n.remove()),a=r;else if(Vr(n)&&t===n.getListType())n.getFirstChildOrThrow().insertBefore(s),a=n;else{const i=ko(t);i.append(s),e.replace(i),a=i}return s.setFormat(e.getFormatType()),s.setIndent(e.getIndent()),e.remove(),a}function W4(e,t){const r=e.getLastChild(),n=t.getFirstChild();r&&n&&Wc(r)&&Wc(n)&&(W4(r.getFirstChild(),n.getFirstChild()),n.remove());const s=t.getChildren();s.length>0&&e.append(...s),t.remove()}function Fne(){const e=Zt();if(Ot(e)){const t=new Set,r=e.getNodes(),n=e.anchor.getNode();if(pB(n,r))t.add(uE(n));else for(let s=0;s<r.length;s++){const a=r[s];if(C9(a)){const i=Wre(a,cd);i!=null&&t.add(uE(i))}}for(const s of t){let a=s;const i=mB(s);for(const o of i){const c=ss().setTextStyle(e.style).setTextFormat(e.format);f0(c,o.getChildren()),a.insertAfter(c),a=c,o.__key===e.anchor.key&&d0(e.anchor,_l(Nl(c,"next"))),o.__key===e.focus.key&&d0(e.focus,_l(Nl(c,"next"))),o.remove()}s.remove()}}}function xB(e){const t=e.getListType()!=="check";let r=e.getStart();for(const n of e.getChildren())Cn(n)&&(n.getValue()!==r&&n.setValue(r),t&&n.getLatest().__checked!=null&&n.setChecked(void 0),Vr(n.getFirstChild())||r++)}function One(e){const t=new Set;if(Wc(e)||t.has(e.getKey()))return;const r=e.getParent(),n=e.getNextSibling(),s=e.getPreviousSibling();if(Wc(n)&&Wc(s)){const a=s.getFirstChild();if(Vr(a)){a.append(e);const i=n.getFirstChild();Vr(i)&&(f0(a,i.getChildren()),n.remove(),t.add(n.getKey()))}}else if(Wc(n)){const a=n.getFirstChild();if(Vr(a)){const i=a.getFirstChild();i!==null&&i.insertBefore(e)}}else if(Wc(s)){const a=s.getFirstChild();Vr(a)&&a.append(e)}else if(Vr(r)){const a=qo().setTextFormat(e.getTextFormat()).setTextStyle(e.getTextStyle()),i=ko(r.getListType()).setTextFormat(r.getTextFormat()).setTextStyle(r.getTextStyle());a.append(i),i.append(e),s?s.insertAfter(a):n?n.insertBefore(a):r.append(a)}}function Dne(e){if(Wc(e))return;const t=e.getParent(),r=t?t.getParent():void 0;if(Vr(r?r.getParent():void 0)&&Cn(r)&&Vr(t)){const n=t?t.getFirstChild():void 0,s=t?t.getLastChild():void 0;if(e.is(n))r.insertBefore(e),t.isEmpty()&&r.remove();else if(e.is(s))r.insertAfter(e),t.isEmpty()&&r.remove();else{const a=t.getListType(),i=qo(),o=ko(a);i.append(o),e.getPreviousSiblings().forEach((d=>o.append(d)));const c=qo(),u=ko(a);c.append(u),f0(u,e.getNextSiblings()),r.insertBefore(i),r.insertAfter(c),r.replace(e)}}}function Ine(){const e=Zt();if(!Ot(e)||!e.isCollapsed())return!1;const t=e.anchor.getNode();if(!Cn(t)||t.getChildrenSize()!==0)return!1;const r=uE(t),n=t.getParent();Vr(n)||hf(40);const s=n.getParent();let a;if(ro(s))a=ss(),r.insertAfter(a);else{if(!Cn(s))return!1;a=qo(),s.insertAfter(a)}a.setTextStyle(e.style).setTextFormat(e.format).select();const i=t.getNextSiblings();if(i.length>0){const o=ko(n.getListType());if(Cn(a)){const c=qo();c.append(o),a.insertAfter(c)}else a.insertAfter(o);o.append(...i)}return(function(o){let c=o;for(;c.getNextSibling()==null&&c.getPreviousSibling()==null;){const u=c.getParent();if(u==null||!Cn(u)&&!Vr(u))break;c=u}c.remove()})(t),!0}function Ob(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}let cd=class extends Di{$config(){return this.config("listitem",{$transform:t=>{if(t.__checked==null)return;const r=t.getParent();Vr(r)&&r.getListType()!=="check"&&t.getChecked()!=null&&t.setChecked(void 0)},extends:Di,importDOM:{li:()=>({conversion:Rne,priority:0})}})}constructor(t=1,r=void 0,n){super(n),this.__value=t===void 0?1:t,this.__checked=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__value=t.__value,this.__checked=t.__checked}createDOM(t){const r=document.createElement("li");return this.updateListItemDOM(null,r,t),r}updateListItemDOM(t,r,n){const s=this.getParent();Vr(s)&&s.getListType()==="check"&&(function(o,c,u,d){Vr(c.getFirstChild())?(o.removeAttribute("role"),o.removeAttribute("tabIndex"),o.removeAttribute("aria-checked")):(o.setAttribute("role","checkbox"),o.setAttribute("tabIndex","-1"),u&&c.__checked===u.__checked||o.setAttribute("aria-checked",c.getChecked()?"true":"false"))})(r,this,t),r.value=this.__value,(function(o,c,u){const d=[],h=[],g=c.list,p=g?g.listitem:void 0;let x;if(g&&g.nested&&(x=g.nested.listitem),p!==void 0&&d.push(...Ob(p)),g){const v=u.getParent(),w=Vr(v)&&v.getListType()==="check",C=u.getChecked();w&&!C||h.push(g.listitemUnchecked),w&&C||h.push(g.listitemChecked),w&&d.push(C?g.listitemChecked:g.listitemUnchecked)}if(x!==void 0){const v=Ob(x);u.getChildren().some((w=>Vr(w)))?d.push(...v):h.push(...v)}h.length>0&&vf(o,...h),d.length>0&&wa(o,...d)})(r,n.theme,this);const a=t?t.__style:"",i=this.__style;a!==i&&(i===""?r.removeAttribute("style"):r.style.cssText=i),(function(o,c,u){const d=k8(c.__textStyle);for(const h in d)o.style.setProperty(`--listitem-marker-${h}`,d[h]);if(u)for(const h in k8(u.__textStyle))h in d||o.style.removeProperty(`--listitem-marker-${h}`)})(r,this,t)}updateDOM(t,r,n){const s=r;return this.updateListItemDOM(t,s,n),!1}updateFromJSON(t){return super.updateFromJSON(t).setValue(t.value).setChecked(t.checked)}exportDOM(t){const r=this.createDOM(t._config),n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();return s&&(r.dir=s),{element:r}}exportJSON(){return{...super.exportJSON(),checked:this.getChecked(),value:this.getValue()}}append(...t){for(let r=0;r<t.length;r++){const n=t[r];if(bt(n)&&this.canMergeWith(n)){const s=n.getChildren();this.append(...s),n.remove()}else super.append(n)}return this}replace(t,r){if(Cn(t))return super.replace(t);this.setIndent(0);const n=this.getParentOrThrow();if(!Vr(n))return t;if(n.__first===this.getKey())n.insertBefore(t);else if(n.__last===this.getKey())n.insertAfter(t);else{const s=ko(n.getListType());let a=this.getNextSibling();for(;a;){const i=a;a=a.getNextSibling(),s.append(i)}n.insertAfter(t),t.insertAfter(s)}return r&&(bt(t)||hf(139),this.getChildren().forEach((s=>{t.append(s)}))),this.remove(),n.getChildrenSize()===0&&n.remove(),t}insertAfter(t,r=!0){const n=this.getParentOrThrow();if(Vr(n)||hf(39),Cn(t))return super.insertAfter(t,r);const s=this.getNextSiblings();if(n.insertAfter(t,r),s.length!==0){const a=ko(n.getListType());s.forEach((i=>a.append(i))),t.insertAfter(a,r)}return t}remove(t){const r=this.getPreviousSibling(),n=this.getNextSibling();super.remove(t),r&&n&&Wc(r)&&Wc(n)&&(W4(r.getFirstChild(),n.getFirstChild()),n.remove())}insertNewAfter(t,r=!0){const n=qo().updateFromJSON(this.exportJSON()).setChecked(!this.getChecked()&&void 0);return this.insertAfter(n,r),n}collapseAtStart(t){const r=ss();this.getChildren().forEach((i=>r.append(i)));const n=this.getParentOrThrow(),s=n.getParentOrThrow(),a=Cn(s);if(n.getChildrenSize()===1)if(a)n.remove(),s.select();else{n.insertBefore(r),n.remove();const i=t.anchor,o=t.focus,c=r.getKey();i.type==="element"&&i.getNode().is(this)&&i.set(c,i.offset,"element"),o.type==="element"&&o.getNode().is(this)&&o.set(c,o.offset,"element")}else n.insertBefore(r),this.remove();return!0}getValue(){return this.getLatest().__value}setValue(t){const r=this.getWritable();return r.__value=t,r}getChecked(){const t=this.getLatest();let r;const n=this.getParent();return Vr(n)&&(r=n.getListType()),r==="check"?!!t.__checked:void 0}setChecked(t){const r=this.getWritable();return r.__checked=t,r}toggleChecked(){const t=this.getWritable();return t.setChecked(!t.__checked)}getIndent(){const t=this.getParent();if(t===null||!this.isAttached())return this.getLatest().__indent;let r=t.getParentOrThrow(),n=0;for(;Cn(r);)r=r.getParentOrThrow().getParentOrThrow(),n++;return n}setIndent(t){typeof t!="number"&&hf(117),(t=Math.floor(t))>=0||hf(199);let r=this.getIndent();for(;r!==t;)r<t?(One(this),r++):(Dne(this),r--);return this}canInsertAfter(t){return Cn(t)}canReplaceWith(t){return Cn(t)}canMergeWith(t){return Cn(t)||_4(t)}extractWithChild(t,r){if(!Ot(r))return!1;const n=r.anchor.getNode(),s=r.focus.getNode();return this.isParentOf(n)&&this.isParentOf(s)&&this.getTextContent().length===r.getTextContent().length}isParentRequired(){return!0}createParentElementNode(){return ko("bullet")}canMergeWhenEmpty(){return!0}};function Rne(e){if(e.classList.contains("task-list-item")){for(const r of e.children)if(r.tagName==="INPUT")return Mne(r)}const t=e.getAttribute("aria-checked");return{node:qo(t==="true"||t!=="false"&&void 0)}}function Mne(e){return e.getAttribute("type")!=="checkbox"?{node:null}:{node:qo(e.hasAttribute("checked"))}}function qo(e){return ao(new cd(void 0,e))}function Cn(e){return e instanceof cd}let Rf=class extends Di{$config(){return this.config("list",{$transform:t=>{(function(r){const n=r.getNextSibling();Vr(n)&&r.getListType()===n.getListType()&&W4(r,n)})(t),xB(t)},extends:Di,importDOM:{ol:()=>({conversion:Q8,priority:0}),ul:()=>({conversion:Q8,priority:0})}})}constructor(t="number",r=1,n){super(n);const s=Bne[t]||t;this.__listType=s,this.__tag=s==="number"?"ol":"ul",this.__start=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__listType=t.__listType,this.__tag=t.__tag,this.__start=t.__start}getTag(){return this.getLatest().__tag}setListType(t){const r=this.getWritable();return r.__listType=t,r.__tag=t==="number"?"ol":"ul",r}getListType(){return this.getLatest().__listType}getStart(){return this.getLatest().__start}setStart(t){const r=this.getWritable();return r.__start=t,r}createDOM(t,r){const n=this.__tag,s=document.createElement(n);return this.__start!==1&&s.setAttribute("start",String(this.__start)),s.__lexicalListType=this.__listType,X8(s,t.theme,this),s}updateDOM(t,r,n){return t.__tag!==this.__tag||(X8(r,n.theme,this),!1)}updateFromJSON(t){return super.updateFromJSON(t).setListType(t.listType).setStart(t.start)}exportDOM(t){const r=this.createDOM(t._config,t);return as(r)&&(this.__start!==1&&r.setAttribute("start",String(this.__start)),this.__listType==="check"&&r.setAttribute("__lexicalListType","check")),{element:r}}exportJSON(){return{...super.exportJSON(),listType:this.getListType(),start:this.getStart(),tag:this.getTag()}}canBeEmpty(){return!1}canIndent(){return!1}splice(t,r,n){let s=n;for(let a=0;a<n.length;a++){const i=n[a];Cn(i)||(s===n&&(s=[...n]),s[a]=qo().append(!bt(i)||Vr(i)||i.isInline()?i:Ps(i.getTextContent())))}return super.splice(t,r,s)}extractWithChild(t){return Cn(t)}};function X8(e,t,r){const n=[],s=[],a=t.list;if(a!==void 0){const i=a[`${r.__tag}Depth`]||[],o=cE(r)-1,c=o%i.length,u=i[c],d=a[r.__tag];let h;const g=a.nested,p=a.checklist;if(g!==void 0&&g.list&&(h=g.list),d!==void 0&&n.push(d),p!==void 0&&r.__listType==="check"&&n.push(p),u!==void 0){n.push(...Ob(u));for(let x=0;x<i.length;x++)x!==c&&s.push(r.__tag+x)}if(h!==void 0){const x=Ob(h);o>1?n.push(...x):s.push(...x)}}s.length>0&&vf(e,...s),n.length>0&&wa(e,...n)}function Lne(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];if(Cn(n)){t.push(n);const s=n.getChildren();s.length>1&&s.forEach((a=>{Vr(a)&&t.push(K8(a))}))}else t.push(K8(n))}return t}function Q8(e){const t=e.nodeName.toLowerCase();let r=null;return t==="ol"?r=ko("number",e.start):t==="ul"&&(r=(function(n){if(n.getAttribute("__lexicallisttype")==="check"||n.classList.contains("contains-task-list"))return!0;for(const s of n.childNodes)if(as(s)&&s.hasAttribute("aria-checked"))return!0;return!1})(e)?ko("check"):ko("bullet")),{after:Lne,node:r}}const Bne={ol:"number",ul:"bullet"};function ko(e="number",t=1){return ao(new Rf(e,t))}function Vr(e){return e instanceof Rf}const $ne=Pr("UPDATE_LIST_START_COMMAND"),H4=Pr("INSERT_UNORDERED_LIST_COMMAND"),G4=Pr("INSERT_ORDERED_LIST_COMMAND"),V4=Pr("REMOVE_LIST_COMMAND");function Une(e){return T0(e.registerCommand(G4,(()=>(q8("number"),!0)),Wg),e.registerCommand($ne,(t=>{const{listNodeKey:r,newStart:n}=t,s=la(r);return!!Vr(s)&&(s.getListType()==="number"&&(s.setStart(n),xB(s)),!0)}),Wg),e.registerCommand(H4,(()=>(q8("bullet"),!0)),Wg),e.registerCommand(V4,(()=>(Fne(),!0)),Wg),e.registerCommand(Vy,(()=>Ine()),Wg),e.registerNodeTransform(cd,(t=>{const r=t.getFirstChild();if(r){if(er(r)){const n=r.getStyle(),s=r.getFormat();t.getTextStyle()!==n&&t.setTextStyle(n),t.getTextFormat()!==s&&t.setTextFormat(s)}}else{const n=Zt();Ot(n)&&(n.style!==t.getTextStyle()||n.format!==t.getTextFormat())&&n.isCollapsed()&&t.is(n.anchor.getNode())&&t.setTextStyle(n.style).setTextFormat(n.format)}})),e.registerNodeTransform(Df,(t=>{const r=t.getParent();if(Cn(r)&&t.is(r.getFirstChild())){const n=t.getStyle(),s=t.getFormat();n===r.getTextStyle()&&s===r.getTextFormat()||r.setTextStyle(n).setTextFormat(s)}})))}function zne(e){const t=r=>{const n=r.getParent();if(Vr(r.getFirstChild())||!Vr(n))return;const s=J_(r,(a=>Cn(a)&&Vr(a.getParent())&&Cn(a.getPreviousSibling())));if(s===null&&r.getIndent()>0)r.setIndent(0);else if(Cn(s)){const a=s.getPreviousSibling();if(Cn(a)){const i=(function(c){let u=c,d=u.getFirstChild();for(;Vr(d);){const h=d.getLastChild();if(!Cn(h))break;u=h,d=u.getFirstChild()}return u})(a),o=i.getParent();if(Vr(o)){const c=cE(o);c+1<cE(n)&&r.setIndent(c)}}}};return e.registerNodeTransform(Rf,(r=>{const n=[r];for(;n.length>0;){const s=n.shift();if(Vr(s)){for(const a of s.getChildren())if(Cn(a)){t(a);const i=a.getFirstChild();Vr(i)&&n.push(i)}}}}))}var gk={exports:{}},J8;function Wne(){return J8||(J8=1,(function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var r=(function(n){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,a=0,i={},o={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function k(b){return b instanceof c?new c(b.type,k(b.content),b.alias):Array.isArray(b)?b.map(k):b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(k){return Object.prototype.toString.call(k).slice(8,-1)},objId:function(k){return k.__id||Object.defineProperty(k,"__id",{value:++a}),k.__id},clone:function k(b,N){N=N||{};var E,P;switch(o.util.type(b)){case"Object":if(P=o.util.objId(b),N[P])return N[P];E={},N[P]=E;for(var F in b)b.hasOwnProperty(F)&&(E[F]=k(b[F],N));return E;case"Array":return P=o.util.objId(b),N[P]?N[P]:(E=[],N[P]=E,b.forEach(function(A,j){E[j]=k(A,N)}),E);default:return b}},getLanguage:function(k){for(;k;){var b=s.exec(k.className);if(b)return b[1].toLowerCase();k=k.parentElement}return"none"},setLanguage:function(k,b){k.className=k.className.replace(RegExp(s,"gi"),""),k.classList.add("language-"+b)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(E){var k=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(E.stack)||[])[1];if(k){var b=document.getElementsByTagName("script");for(var N in b)if(b[N].src==k)return b[N]}return null}},isActive:function(k,b,N){for(var E="no-"+b;k;){var P=k.classList;if(P.contains(b))return!0;if(P.contains(E))return!1;k=k.parentElement}return!!N}},languages:{plain:i,plaintext:i,text:i,txt:i,extend:function(k,b){var N=o.util.clone(o.languages[k]);for(var E in b)N[E]=b[E];return N},insertBefore:function(k,b,N,E){E=E||o.languages;var P=E[k],F={};for(var A in P)if(P.hasOwnProperty(A)){if(A==b)for(var j in N)N.hasOwnProperty(j)&&(F[j]=N[j]);N.hasOwnProperty(A)||(F[A]=P[A])}var I=E[k];return E[k]=F,o.languages.DFS(o.languages,function(B,Y){Y===I&&B!=k&&(this[B]=F)}),F},DFS:function k(b,N,E,P){P=P||{};var F=o.util.objId;for(var A in b)if(b.hasOwnProperty(A)){N.call(b,A,b[A],E||A);var j=b[A],I=o.util.type(j);I==="Object"&&!P[F(j)]?(P[F(j)]=!0,k(j,N,null,P)):I==="Array"&&!P[F(j)]&&(P[F(j)]=!0,k(j,N,A,P))}}},plugins:{},highlightAll:function(k,b){o.highlightAllUnder(document,k,b)},highlightAllUnder:function(k,b,N){var E={callback:N,container:k,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",E),E.elements=Array.prototype.slice.apply(E.container.querySelectorAll(E.selector)),o.hooks.run("before-all-elements-highlight",E);for(var P=0,F;F=E.elements[P++];)o.highlightElement(F,b===!0,E.callback)},highlightElement:function(k,b,N){var E=o.util.getLanguage(k),P=o.languages[E];o.util.setLanguage(k,E);var F=k.parentElement;F&&F.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(F,E);var A=k.textContent,j={element:k,language:E,grammar:P,code:A};function I(Y){j.highlightedCode=Y,o.hooks.run("before-insert",j),j.element.innerHTML=j.highlightedCode,o.hooks.run("after-highlight",j),o.hooks.run("complete",j),N&&N.call(j.element)}if(o.hooks.run("before-sanity-check",j),F=j.element.parentElement,F&&F.nodeName.toLowerCase()==="pre"&&!F.hasAttribute("tabindex")&&F.setAttribute("tabindex","0"),!j.code){o.hooks.run("complete",j),N&&N.call(j.element);return}if(o.hooks.run("before-highlight",j),!j.grammar){I(o.util.encode(j.code));return}if(b&&n.Worker){var B=new Worker(o.filename);B.onmessage=function(Y){I(Y.data)},B.postMessage(JSON.stringify({language:j.language,code:j.code,immediateClose:!0}))}else I(o.highlight(j.code,j.grammar,j.language))},highlight:function(k,b,N){var E={code:k,grammar:b,language:N};if(o.hooks.run("before-tokenize",E),!E.grammar)throw new Error('The language "'+E.language+'" has no grammar.');return E.tokens=o.tokenize(E.code,E.grammar),o.hooks.run("after-tokenize",E),c.stringify(o.util.encode(E.tokens),E.language)},tokenize:function(k,b){var N=b.rest;if(N){for(var E in N)b[E]=N[E];delete b.rest}var P=new h;return g(P,P.head,k),d(k,P,b,P.head,0),x(P)},hooks:{all:{},add:function(k,b){var N=o.hooks.all;N[k]=N[k]||[],N[k].push(b)},run:function(k,b){var N=o.hooks.all[k];if(!(!N||!N.length))for(var E=0,P;P=N[E++];)P(b)}},Token:c};n.Prism=o;function c(k,b,N,E){this.type=k,this.content=b,this.alias=N,this.length=(E||"").length|0}c.stringify=function k(b,N){if(typeof b=="string")return b;if(Array.isArray(b)){var E="";return b.forEach(function(I){E+=k(I,N)}),E}var P={type:b.type,content:k(b.content,N),tag:"span",classes:["token",b.type],attributes:{},language:N},F=b.alias;F&&(Array.isArray(F)?Array.prototype.push.apply(P.classes,F):P.classes.push(F)),o.hooks.run("wrap",P);var A="";for(var j in P.attributes)A+=" "+j+'="'+(P.attributes[j]||"").replace(/"/g,"&quot;")+'"';return"<"+P.tag+' class="'+P.classes.join(" ")+'"'+A+">"+P.content+"</"+P.tag+">"};function u(k,b,N,E){k.lastIndex=b;var P=k.exec(N);if(P&&E&&P[1]){var F=P[1].length;P.index+=F,P[0]=P[0].slice(F)}return P}function d(k,b,N,E,P,F){for(var A in N)if(!(!N.hasOwnProperty(A)||!N[A])){var j=N[A];j=Array.isArray(j)?j:[j];for(var I=0;I<j.length;++I){if(F&&F.cause==A+","+I)return;var B=j[I],Y=B.inside,Z=!!B.lookbehind,ae=!!B.greedy,ee=B.alias;if(ae&&!B.pattern.global){var ne=B.pattern.toString().match(/[imsuy]*$/)[0];B.pattern=RegExp(B.pattern.source,ne+"g")}for(var L=B.pattern||B,H=E.next,M=P;H!==b.tail&&!(F&&M>=F.reach);M+=H.value.length,H=H.next){var V=H.value;if(b.length>k.length)return;if(!(V instanceof c)){var W=1,R;if(ae){if(R=u(L,M,k,Z),!R||R.index>=k.length)break;var se=R.index,U=R.index+R[0].length,q=M;for(q+=H.value.length;se>=q;)H=H.next,q+=H.value.length;if(q-=H.value.length,M=q,H.value instanceof c)continue;for(var Q=H;Q!==b.tail&&(q<U||typeof Q.value=="string");Q=Q.next)W++,q+=Q.value.length;W--,V=k.slice(M,q),R.index-=M}else if(R=u(L,0,V,Z),!R)continue;var se=R.index,X=R[0],ie=V.slice(0,se),le=V.slice(se+X.length),ce=M+V.length;F&&ce>F.reach&&(F.reach=ce);var Se=H.prev;ie&&(Se=g(b,Se,ie),M+=ie.length),p(b,Se,W);var re=new c(A,Y?o.tokenize(X,Y):X,ee,X);if(H=g(b,Se,re),le&&g(b,H,le),W>1){var ge={cause:A+","+I,reach:ce};d(k,b,N,H.prev,M,ge),F&&ge.reach>F.reach&&(F.reach=ge.reach)}}}}}}function h(){var k={value:null,prev:null,next:null},b={value:null,prev:k,next:null};k.next=b,this.head=k,this.tail=b,this.length=0}function g(k,b,N){var E=b.next,P={value:N,prev:b,next:E};return b.next=P,E.prev=P,k.length++,P}function p(k,b,N){for(var E=b.next,P=0;P<N&&E!==k.tail;P++)E=E.next;b.next=E,E.prev=b,k.length-=P}function x(k){for(var b=[],N=k.head.next;N!==k.tail;)b.push(N.value),N=N.next;return b}if(!n.document)return n.addEventListener&&(o.disableWorkerMessageHandler||n.addEventListener("message",function(k){var b=JSON.parse(k.data),N=b.language,E=b.code,P=b.immediateClose;n.postMessage(o.highlight(E,o.languages[N],N)),P&&n.close()},!1)),o;var v=o.util.currentScript();v&&(o.filename=v.src,v.hasAttribute("data-manual")&&(o.manual=!0));function w(){o.manual||o.highlightAll()}if(!o.manual){var C=document.readyState;C==="loading"||C==="interactive"&&v&&v.defer?document.addEventListener("DOMContentLoaded",w):window.requestAnimationFrame?window.requestAnimationFrame(w):window.setTimeout(w,16)}return o})(t);e.exports&&(e.exports=r),typeof cb<"u"&&(cb.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(n){n.type==="entity"&&(n.attributes.title=n.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(s,a){var i={};i["language-"+a]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[a]},i.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:i}};o["language-"+a]={pattern:/[\s\S]+/,inside:r.languages[a]};var c={};c[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},r.languages.insertBefore("markup","cdata",c)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(n,s){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+n+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:r.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,(function(n){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;n.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},n.languages.css.atrule.inside.rest=n.languages.css;var a=n.languages.markup;a&&(a.tag.addInlined("style","css"),a.tag.addAttribute("style","css"))})(r),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,(function(){if(typeof r>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var n="Loading",s=function(v,w){return" Error "+v+" while fetching file: "+w},a=" Error: File does not exist or is empty",i={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",c="loading",u="loaded",d="failed",h="pre[data-src]:not(["+o+'="'+u+'"]):not(['+o+'="'+c+'"])';function g(v,w,C){var k=new XMLHttpRequest;k.open("GET",v,!0),k.onreadystatechange=function(){k.readyState==4&&(k.status<400&&k.responseText?w(k.responseText):k.status>=400?C(s(k.status,k.statusText)):C(a))},k.send(null)}function p(v){var w=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(v||"");if(w){var C=Number(w[1]),k=w[2],b=w[3];return k?b?[C,Number(b)]:[C,void 0]:[C,C]}}r.hooks.add("before-highlightall",function(v){v.selector+=", "+h}),r.hooks.add("before-sanity-check",function(v){var w=v.element;if(w.matches(h)){v.code="",w.setAttribute(o,c);var C=w.appendChild(document.createElement("CODE"));C.textContent=n;var k=w.getAttribute("data-src"),b=v.language;if(b==="none"){var N=(/\.(\w+)$/.exec(k)||[,"none"])[1];b=i[N]||N}r.util.setLanguage(C,b),r.util.setLanguage(w,b);var E=r.plugins.autoloader;E&&E.loadLanguages(b),g(k,function(P){w.setAttribute(o,u);var F=p(w.getAttribute("data-range"));if(F){var A=P.split(/\r\n?|\n/g),j=F[0],I=F[1]==null?A.length:F[1];j<0&&(j+=A.length),j=Math.max(0,Math.min(j-1,A.length)),I<0&&(I+=A.length),I=Math.max(0,Math.min(I,A.length)),P=A.slice(j,I).join(`
`),w.hasAttribute("data-start")||w.setAttribute("data-start",String(j+1))}C.textContent=P,r.highlightElement(C)},function(P){w.setAttribute(o,d),C.textContent=P})}}),r.plugins.fileHighlight={highlight:function(w){for(var C=(w||document).querySelectorAll(h),k=0,b;b=C[k++];)r.highlightElement(b)}};var x=!1;r.fileHighlight=function(){x||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),x=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}})()})(gk)),gk.exports}Wne();Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript;Prism.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]};Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity;Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup;Prism.hooks.add("wrap",function(e){e.type==="entity"&&(e.attributes.title=e.content.replace(/&amp;/,"&"))});Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function(t,r){var n={};n["language-"+r]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[r]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var s={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};s["language-"+r]={pattern:/[\s\S]+/,inside:Prism.languages[r]};var a={};a[t]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return t}),"i"),lookbehind:!0,greedy:!0,inside:s},Prism.languages.insertBefore("markup","cdata",a)}});Object.defineProperty(Prism.languages.markup.tag,"addAttribute",{value:function(e,t){Prism.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:Prism.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}});Prism.languages.html=Prism.languages.markup;Prism.languages.mathml=Prism.languages.markup;Prism.languages.svg=Prism.languages.markup;Prism.languages.xml=Prism.languages.extend("markup",{});Prism.languages.ssml=Prism.languages.xml;Prism.languages.atom=Prism.languages.xml;Prism.languages.rss=Prism.languages.xml;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function r(d){return d=d.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+d+")")}var n=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return n}),a=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+a+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+a+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(n),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+a+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(n),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:r(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:r(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:r(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:r(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(d){["url","bold","italic","strike","code-snippet"].forEach(function(h){d!==h&&(e.languages.markdown[d].inside.content.inside[h]=e.languages.markdown[h])})}),e.hooks.add("after-tokenize",function(d){if(d.language!=="markdown"&&d.language!=="md")return;function h(g){if(!(!g||typeof g=="string"))for(var p=0,x=g.length;p<x;p++){var v=g[p];if(v.type!=="code"){h(v.content);continue}var w=v.content[1],C=v.content[3];if(w&&C&&w.type==="code-language"&&C.type==="code-block"&&typeof w.content=="string"){var k=w.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");k=(/[a-z][\w-]*/i.exec(k)||[""])[0].toLowerCase();var b="language-"+k;C.alias?typeof C.alias=="string"?C.alias=[C.alias,b]:C.alias.push(b):C.alias=[b]}}}h(d.tokens)}),e.hooks.add("wrap",function(d){if(d.type==="code-block"){for(var h="",g=0,p=d.classes.length;g<p;g++){var x=d.classes[g],v=/language-(.+)/.exec(x);if(v){h=v[1];break}}var w=e.languages[h];if(w)d.content=e.highlight(u(d.content),w,h);else if(h&&h!=="none"&&e.plugins.autoloader){var C="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);d.attributes.id=C,e.plugins.autoloader.loadLanguages(h,function(){var k=document.getElementById(C);k&&(k.innerHTML=e.highlight(k.textContent,e.languages[h],h))})}}});var i=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},c=String.fromCodePoint||String.fromCharCode;function u(d){var h=d.replace(i,"");return h=h.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(g,p){if(p=p.toLowerCase(),p[0]==="#"){var x;return p[1]==="x"?x=parseInt(p.slice(2),16):x=Number(p.slice(1)),c(x)}else{var v=o[p];return v||g}}),h}e.languages.md=e.languages.markdown})(Prism);Prism.languages.c=Prism.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/});Prism.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}});Prism.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},Prism.languages.c.string],char:Prism.languages.c.char,comment:Prism.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:Prism.languages.c}}}});Prism.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/});delete Prism.languages.c.boolean;(function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var r=e.languages.markup;r&&(r.tag.addInlined("style","css"),r.tag.addAttribute("style","css"))})(Prism);Prism.languages.objectivec=Prism.languages.extend("c",{string:{pattern:/@?"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},keyword:/\b(?:asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|in|inline|int|long|register|return|self|short|signed|sizeof|static|struct|super|switch|typedef|typeof|union|unsigned|void|volatile|while)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/});delete Prism.languages.objectivec["class-name"];Prism.languages.objc=Prism.languages.objectivec;Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};(function(e){var t=e.languages.powershell={comment:[{pattern:/(^|[^`])<#[\s\S]*?#>/,lookbehind:!0},{pattern:/(^|[^`])#.*/,lookbehind:!0}],string:[{pattern:/"(?:`[\s\S]|[^`"])*"/,greedy:!0,inside:null},{pattern:/'(?:[^']|'')*'/,greedy:!0}],namespace:/\[[a-z](?:\[(?:\[[^\]]*\]|[^\[\]])*\]|[^\[\]])*\]/i,boolean:/\$(?:false|true)\b/i,variable:/\$\w+\b/,function:[/\b(?:Add|Approve|Assert|Backup|Block|Checkpoint|Clear|Close|Compare|Complete|Compress|Confirm|Connect|Convert|ConvertFrom|ConvertTo|Copy|Debug|Deny|Disable|Disconnect|Dismount|Edit|Enable|Enter|Exit|Expand|Export|Find|ForEach|Format|Get|Grant|Group|Hide|Import|Initialize|Install|Invoke|Join|Limit|Lock|Measure|Merge|Move|New|Open|Optimize|Out|Ping|Pop|Protect|Publish|Push|Read|Receive|Redo|Register|Remove|Rename|Repair|Request|Reset|Resize|Resolve|Restart|Restore|Resume|Revoke|Save|Search|Select|Send|Set|Show|Skip|Sort|Split|Start|Step|Stop|Submit|Suspend|Switch|Sync|Tee|Test|Trace|Unblock|Undo|Uninstall|Unlock|Unprotect|Unpublish|Unregister|Update|Use|Wait|Watch|Where|Write)-[a-z]+\b/i,/\b(?:ac|cat|chdir|clc|cli|clp|clv|compare|copy|cp|cpi|cpp|cvpa|dbp|del|diff|dir|ebp|echo|epal|epcsv|epsn|erase|fc|fl|ft|fw|gal|gbp|gc|gci|gcs|gdr|gi|gl|gm|gp|gps|group|gsv|gu|gv|gwmi|iex|ii|ipal|ipcsv|ipsn|irm|iwmi|iwr|kill|lp|ls|measure|mi|mount|move|mp|mv|nal|ndr|ni|nv|ogv|popd|ps|pushd|pwd|rbp|rd|rdr|ren|ri|rm|rmdir|rni|rnp|rp|rv|rvpa|rwmi|sal|saps|sasv|sbp|sc|select|set|shcm|si|sl|sleep|sls|sort|sp|spps|spsv|start|sv|swmi|tee|trcm|type|write)\b/i],keyword:/\b(?:Begin|Break|Catch|Class|Continue|Data|Define|Do|DynamicParam|Else|ElseIf|End|Exit|Filter|Finally|For|ForEach|From|Function|If|InlineScript|Parallel|Param|Process|Return|Sequence|Switch|Throw|Trap|Try|Until|Using|Var|While|Workflow)\b/i,operator:{pattern:/(^|\W)(?:!|-(?:b?(?:and|x?or)|as|(?:Not)?(?:Contains|In|Like|Match)|eq|ge|gt|is(?:Not)?|Join|le|lt|ne|not|Replace|sh[lr])\b|-[-=]?|\+[+=]?|[*\/%]=?)/i,lookbehind:!0},punctuation:/[|{}[\];(),.]/};t.string[0].inside={function:{pattern:/(^|[^`])\$\((?:\$\([^\r\n()]*\)|(?!\$\()[^\r\n)])*\)/,lookbehind:!0,inside:t},boolean:t.boolean,variable:t.variable}})(Prism);var Z8={},eF;function Hne(){return eF||(eF=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),Z8}Hne();var tF={},rF;function Gne(){return rF||(rF=1,(function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,r=0;r<2;r++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string})(Prism)),tF}Gne();Prism.languages.swift={comment:{pattern:/(^|[^\\:])(?:\/\/.*|\/\*(?:[^/*]|\/(?!\*)|\*(?!\/)|\/\*(?:[^*]|\*(?!\/))*\*\/)*\*\/)/,lookbehind:!0,greedy:!0},"string-literal":[{pattern:RegExp(/(^|[^"#])/.source+"(?:"+/"(?:\\(?:\((?:[^()]|\([^()]*\))*\)|\r\n|[^(])|[^\\\r\n"])*"/.source+"|"+/"""(?:\\(?:\((?:[^()]|\([^()]*\))*\)|[^(])|[^\\"]|"(?!""))*"""/.source+")"+/(?!["#])/.source),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\\($/,alias:"punctuation"},punctuation:/\\(?=[\r\n])/,string:/[\s\S]+/}},{pattern:RegExp(/(^|[^"#])(#+)/.source+"(?:"+/"(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|\r\n|[^#])|[^\\\r\n])*?"/.source+"|"+/"""(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|[^#])|[^\\])*?"""/.source+")\\2"),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\#+\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\#+\($/,alias:"punctuation"},string:/[\s\S]+/}}],directive:{pattern:RegExp(/#/.source+"(?:"+(/(?:elseif|if)\b/.source+"(?:[ 	]*"+/(?:![ \t]*)?(?:\b\w+\b(?:[ \t]*\((?:[^()]|\([^()]*\))*\))?|\((?:[^()]|\([^()]*\))*\))(?:[ \t]*(?:&&|\|\|))?/.source+")+")+"|"+/(?:else|endif)\b/.source+")"),alias:"property",inside:{"directive-name":/^#\w+/,boolean:/\b(?:false|true)\b/,number:/\b\d+(?:\.\d+)*\b/,operator:/!|&&|\|\||[<>]=?/,punctuation:/[(),]/}},literal:{pattern:/#(?:colorLiteral|column|dsohandle|file(?:ID|Literal|Path)?|function|imageLiteral|line)\b/,alias:"constant"},"other-directive":{pattern:/#\w+\b/,alias:"property"},attribute:{pattern:/@\w+/,alias:"atrule"},"function-definition":{pattern:/(\bfunc\s+)\w+/,lookbehind:!0,alias:"function"},label:{pattern:/\b(break|continue)\s+\w+|\b[a-zA-Z_]\w*(?=\s*:\s*(?:for|repeat|while)\b)/,lookbehind:!0,alias:"important"},keyword:/\b(?:Any|Protocol|Self|Type|actor|as|assignment|associatedtype|associativity|async|await|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic|else|enum|extension|fallthrough|fileprivate|final|for|func|get|guard|higherThan|if|import|in|indirect|infix|init|inout|internal|is|isolated|lazy|left|let|lowerThan|mutating|none|nonisolated|nonmutating|open|operator|optional|override|postfix|precedencegroup|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|set|some|static|struct|subscript|super|switch|throw|throws|try|typealias|unowned|unsafe|var|weak|where|while|willSet)\b/,boolean:/\b(?:false|true)\b/,nil:{pattern:/\bnil\b/,alias:"constant"},"short-argument":/\$\d+\b/,omit:{pattern:/\b_\b/,alias:"keyword"},number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,"class-name":/\b[A-Z](?:[A-Z_\d]*[a-z]\w*)?\b/,function:/\b[a-z_]\w*(?=\s*\()/i,constant:/\b(?:[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,operator:/[-+*/%=!<>&|^~?]+|\.[.\-+*/%=!<>&|^~?]+/,punctuation:/[{}[\]();,.:\\]/};Prism.languages.swift["string-literal"].forEach(function(e){e.inside.interpolation.inside=Prism.languages.swift});var nF={},sF;function Vne(){return sF||(sF=1,(function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript})(Prism)),nF}Vne();var aF={},iF;function Kne(){return iF||(iF=1,(function(e){var t=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,r=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,n={pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};e.languages.java=e.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[n,{pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:n.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+r+/[A-Z]\w*\b/.source),lookbehind:!0,inside:n.inside}],keyword:t,function:[e.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),e.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),e.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":n,keyword:t,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+r+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:n.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+r+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:n.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0,inside:{punctuation:/\./}}})})(Prism)),aF}Kne();var oF={},lF;function qne(){return lF||(lF=1,(function(e){var t=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,r=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,function(){return t.source});e.languages.cpp=e.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:t,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),e.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,function(){return r})+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),e.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e.languages.cpp}}}}),e.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),e.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:e.languages.extend("cpp",{})}}),e.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},e.languages.cpp["base-clause"])})(Prism)),oF}qne();function yB(e,t){for(const r of e.childNodes){if(as(r)&&r.tagName===t)return!0;yB(r,t)}return!1}const oy="data-language",qx="data-highlight-language",Sw="data-theme";class E0 extends Di{static getType(){return"code"}static clone(t){return new E0(t.__language,t.__key)}constructor(t,r){super(r),this.__language=t||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(t){super.afterCloneFrom(t),this.__language=t.__language,this.__theme=t.__theme,this.__isSyntaxHighlightSupported=t.__isSyntaxHighlightSupported}createDOM(t){const r=document.createElement("code");wa(r,t.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(oy,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(qx,n));const s=this.getTheme();s&&r.setAttribute(Sw,s);const a=this.getStyle();return a&&r.setAttribute("style",a),r}updateDOM(t,r,n){const s=this.__language,a=t.__language;s?s!==a&&r.setAttribute(oy,s):a&&r.removeAttribute(oy);const i=this.__isSyntaxHighlightSupported;t.__isSyntaxHighlightSupported&&a?i&&s?s!==a&&r.setAttribute(qx,s):r.removeAttribute(qx):i&&s&&r.setAttribute(qx,s);const o=this.__theme,c=t.__theme;o?o!==c&&r.setAttribute(Sw,o):c&&r.removeAttribute(Sw);const u=this.__style,d=t.__style;return u?u!==d&&r.setAttribute("style",u):d&&r.removeAttribute("style"),!1}exportDOM(t){const r=document.createElement("pre");wa(r,t._config.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(oy,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(qx,n));const s=this.getTheme();s&&r.setAttribute(Sw,s);const a=this.getStyle();return a&&r.setAttribute("style",a),{element:r}}static importDOM(){return{code:t=>t.textContent!=null&&(/\r?\n/.test(t.textContent)||yB(t,"BR"))?{conversion:cF,priority:1}:null,div:()=>({conversion:Yne,priority:1}),pre:()=>({conversion:cF,priority:0}),table:t=>mk(t)?{conversion:Xne,priority:3}:null,td:t=>{const r=t,n=r.closest("table");return r.classList.contains("js-file-line")||n&&mk(n)?{conversion:uF,priority:3}:null},tr:t=>{const r=t.closest("table");return r&&mk(r)?{conversion:uF,priority:3}:null}}}static importJSON(t){return zu().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setLanguage(t.language).setTheme(t.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(t,r=!0){const n=this.getChildren(),s=n.length;if(s>=2&&n[s-1].getTextContent()===`
`&&n[s-2].getTextContent()===`
`&&t.isCollapsed()&&t.anchor.key===this.__key&&t.anchor.offset===s){n[s-1].remove(),n[s-2].remove();const c=ss();return this.insertAfter(c,r),c}const{anchor:a,focus:i}=t,o=(a.isBefore(i)?a:i).getNode();if(er(o)){let c=Jne(o);const u=[];for(;;)if(W_(c))u.push(zm()),c=c.getNextSibling();else{if(!bB(c))break;{let w=0;const C=c.getTextContent(),k=c.getTextContentSize();for(;w<k&&C[w]===" ";)w++;if(w!==0&&u.push(wB(" ".repeat(w))),w!==k)break;c=c.getNextSibling()}}const d=o.splitText(a.offset)[0],h=a.offset===0?0:1,g=d.getIndexWithinParent()+h,p=o.getParentOrThrow(),x=[Qc(),...u];p.splice(g,0,x);const v=u[u.length-1];v?v.select():a.offset===0?d.selectPrevious():d.getNextSibling().selectNext(0,0)}if(K4(o)){const{offset:c}=t.anchor;o.splice(c,0,[Qc()]),o.select(c+1,c+1)}return null}canIndent(){return!1}collapseAtStart(){const t=ss();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}setLanguage(t){const r=this.getWritable();return r.__language=t||void 0,r}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(t){const r=this.getWritable();return r.__isSyntaxHighlightSupported=t,r}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(t){const r=this.getWritable();return r.__theme=t||void 0,r}getTheme(){return this.getLatest().__theme}}function zu(e,t){return yre(E0).setLanguage(e).setTheme(t)}function K4(e){return e instanceof E0}function cF(e){return{node:zu(e.getAttribute(oy))}}function Yne(e){const t=e,r=dF(t);return r||(function(n){let s=n.parentElement;for(;s!==null;){if(dF(s))return!0;s=s.parentElement}return!1})(t)?{node:r?zu():null}:{node:null}}function Xne(){return{node:zu()}}function uF(){return{node:null}}function dF(e){return e.style.fontFamily.match("monospace")!==null}function mk(e){return e.classList.contains("js-file-line-container")}let Z_=class vB extends Df{constructor(t="",r,n){super(t,n),this.__highlightType=r}static getType(){return"code-highlight"}static clone(t){return new vB(t.__text,t.__highlightType||void 0,t.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(t){const r=this.getWritable();return r.__highlightType=t||void 0,r}canHaveFormat(){return!1}createDOM(t){const r=super.createDOM(t),n=pk(t.theme,this.__highlightType);return wa(r,n),r}updateDOM(t,r,n){const s=super.updateDOM(t,r,n),a=pk(n.theme,t.__highlightType),i=pk(n.theme,this.__highlightType);return a!==i&&(a&&vf(r,a),i&&wa(r,i)),s}static importJSON(t){return wB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHighlightType(t.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(t){return this}isParentRequired(){return!0}createParentElementNode(){return zu()}};function pk(e,t){return t&&e&&e.codeHighlight&&e.codeHighlight[t]}function wB(e="",t){return ao(new Z_(e,t))}function bB(e){return e instanceof Z_}function Qne(e,t){let r=e;for(let n=fi(e,t);n&&(bB(n.origin)||W_(n.origin));n=zre(n))r=n.origin;return r}function Jne(e){return Qne(e,"previous")}(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach((function(r){var n=t[r],s=[];/^\w+$/.test(r)||s.push(/\w+/.exec(r)[0]),r==="diff"&&s.push("bold"),e.languages.diff[r]={pattern:RegExp("^(?:["+n+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(r)[0]}}}})),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);const Zne=new Set(["http:","https:","mailto:","sms:","tel:"]);class Mf extends Di{static getType(){return"link"}static clone(t){return new Mf(t.__url,{rel:t.__rel,target:t.__target,title:t.__title},t.__key)}constructor(t="",r={},n){super(n);const{target:s=null,rel:a=null,title:i=null}=r;this.__url=t,this.__target=s,this.__rel=a,this.__title=i}createDOM(t){const r=document.createElement("a");return this.updateLinkDOM(null,r,t),wa(r,t.theme.link),r}updateLinkDOM(t,r,n){if(D9(r)){t&&t.__url===this.__url||(r.href=this.sanitizeUrl(this.__url));for(const s of["target","rel","title"]){const a=`__${s}`,i=this[a];t&&t[a]===i||(i?r[s]=i:r.removeAttribute(s))}}}updateDOM(t,r,n){return this.updateLinkDOM(t,r,n),!1}static importDOM(){return{a:t=>({conversion:ese,priority:1})}}static importJSON(t){return Db().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setURL(t.url).setRel(t.rel||null).setTarget(t.target||null).setTitle(t.title||null)}sanitizeUrl(t){t=hF(t);try{const r=new URL(hF(t));if(!Zne.has(r.protocol))return"about:blank"}catch{return t}return t}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),url:this.getURL()}}getURL(){return this.getLatest().__url}setURL(t){const r=this.getWritable();return r.__url=t,r}getTarget(){return this.getLatest().__target}setTarget(t){const r=this.getWritable();return r.__target=t,r}getRel(){return this.getLatest().__rel}setRel(t){const r=this.getWritable();return r.__rel=t,r}getTitle(){return this.getLatest().__title}setTitle(t){const r=this.getWritable();return r.__title=t,r}insertNewAfter(t,r=!0){const n=Db(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(n,r),n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(t,r,n){if(!Ot(r))return!1;const s=r.anchor.getNode(),a=r.focus.getNode();return this.isParentOf(s)&&this.isParentOf(a)&&r.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}}function ese(e){let t=null;if(D9(e)){const r=e.textContent;(r!==null&&r!==""||e.children.length>0)&&(t=Db(e.getAttribute("href")||"",{rel:e.getAttribute("rel"),target:e.getAttribute("target"),title:e.getAttribute("title")}))}return{node:t}}function Db(e="",t){return ao(new Mf(e,t))}function tse(e){return e instanceof Mf}class Ym extends Mf{constructor(t="",r={},n){super(t,r,n),this.__isUnlinked=r.isUnlinked!==void 0&&r.isUnlinked!==null&&r.isUnlinked}static getType(){return"autolink"}static clone(t){return new Ym(t.__url,{isUnlinked:t.__isUnlinked,rel:t.__rel,target:t.__target,title:t.__title},t.__key)}getIsUnlinked(){return this.__isUnlinked}setIsUnlinked(t){const r=this.getWritable();return r.__isUnlinked=t,r}createDOM(t){return this.__isUnlinked?document.createElement("span"):super.createDOM(t)}updateDOM(t,r,n){return super.updateDOM(t,r,n)||t.__isUnlinked!==this.__isUnlinked}static importJSON(t){return fF().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setIsUnlinked(t.isUnlinked||!1)}static importDOM(){return null}exportJSON(){return{...super.exportJSON(),isUnlinked:this.__isUnlinked}}insertNewAfter(t,r=!0){const n=this.getParentOrThrow().insertNewAfter(t,r);if(bt(n)){const s=fF(this.__url,{isUnlinked:this.__isUnlinked,rel:this.__rel,target:this.__target,title:this.__title});return n.append(s),s}return null}}function fF(e="",t){return ao(new Ym(e,t))}function rse(e){return e instanceof Ym}const nse=/^\+?[0-9\s()-]{5,}$/;function hF(e){return e.match(/^[a-z][a-z0-9+.-]*:/i)||e.match(/^[/#.]/)?e:e.includes("@")?`mailto:${e}`:nse.test(e)?`tel:${e}`:`https://${e}`}function dE(e,t){const r={};for(const n of e){const s=t(n);s&&(r[s]?r[s].push(n):r[s]=[n])}return r}function sse(e){const t=dE(e,(r=>r.type));return{element:t.element||[],multilineElement:t["multiline-element"]||[],textFormat:t["text-format"]||[],textMatch:t["text-match"]||[]}}const gF=/[!-/:-@[-`{-~\s]/;function ase(e){return er(e)&&!e.hasFormat("code")}function ise(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function mF(e,t,r){const n=r.length;for(let s=t;s>=n;s--){const a=s-n;if(_B(e,a,r,0,n)&&e[a+n]!==" ")return a}return-1}function _B(e,t,r,n,s){for(let a=0;a<s;a++)if(e[t+a]!==r[n+a])return!1;return!0}function ose(e,t=e2){const r=sse(t),n=dE(r.textFormat,(({tag:i})=>i[i.length-1])),s=dE(r.textMatch,(({trigger:i})=>i));for(const i of t){const o=i.type;if(o==="element"||o==="text-match"||o==="multiline-element"){const c=i.dependencies;for(const u of c)e.hasNode(u)||ise(173,u.getType())}}const a=(i,o,c)=>{(function(u,d,h,g){const p=u.getParent();if(!ro(p)||u.getFirstChild()!==d)return!1;const x=d.getTextContent();if(x[h-1]!==" ")return!1;for(const{regExp:v,replace:w}of g){const C=x.match(v);if(C&&C[0].length===(C[0].endsWith(" ")?h:h-1)){const k=d.getNextSiblings(),[b,N]=d.splitText(h);if(w(u,N?[N,...k]:k,C,!1)!==!1)return b.remove(),!0}}return!1})(i,o,c,r.element)||(function(u,d,h,g){const p=u.getParent();if(!ro(p)||u.getFirstChild()!==d)return!1;const x=d.getTextContent();if(x[h-1]!==" ")return!1;for(const{regExpStart:v,replace:w,regExpEnd:C}of g){if(C&&!("optional"in C)||C&&"optional"in C&&!C.optional)continue;const k=x.match(v);if(k&&k[0].length===(k[0].endsWith(" ")?h:h-1)){const b=d.getNextSiblings(),[N,E]=d.splitText(h);if(w(u,E?[E,...b]:b,k,null,null,!1)!==!1)return N.remove(),!0}}return!1})(i,o,c,r.multilineElement)||(function(u,d,h){let g=u.getTextContent();const p=h[g[d-1]];if(p==null)return!1;d<g.length&&(g=g.slice(0,d));for(const x of p){if(!x.replace||!x.regExp)continue;const v=g.match(x.regExp);if(v===null)continue;const w=v.index||0,C=w+v[0].length;let k;return w===0?[k]=u.splitText(C):[,k]=u.splitText(w,C),k.selectNext(0,0),x.replace(k,v),!0}return!1})(o,c,s)||(function(u,d,h){const g=u.getTextContent(),p=d-1,x=g[p],v=h[x];if(!v)return!1;for(const w of v){const{tag:C}=w,k=C.length,b=p-k+1;if(k>1&&!_B(g,b,C,0,k)||g[b-1]===" ")continue;const N=g[p+1];if(w.intraword===!1&&N&&!gF.test(N))continue;const E=u;let P=E,F=mF(g,b,C),A=P;for(;F<0&&(A=A.getPreviousSibling())&&!Vu(A);)if(er(A)){if(A.hasFormat("code"))continue;const L=A.getTextContent();P=A,F=mF(L,L.length,C)}if(F<0||P===E&&F+k===b)continue;const j=P.getTextContent();if(F>0&&j[F-1]===x)continue;const I=j[F-1];if(w.intraword===!1&&I&&!gF.test(I))continue;const B=E.getTextContent(),Y=B.slice(0,b)+B.slice(p+1);E.setTextContent(Y);const Z=P===E?Y:j;P.setTextContent(Z.slice(0,F)+Z.slice(F+k));const ae=Zt(),ee=G_();hi(ee);const ne=p-k*(P===E?2:1)+1;ee.anchor.set(P.__key,F,"text"),ee.focus.set(E.__key,ne,"text");for(const L of w.format)ee.hasFormat(L)||ee.formatText(L);ee.anchor.set(ee.focus.key,ee.focus.offset,ee.focus.type);for(const L of w.format)ee.hasFormat(L)&&ee.toggleFormat(L);return Ot(ae)&&(ee.format=ae.format),!0}})(o,c,n)};return e.registerUpdateListener((({tags:i,dirtyLeaves:o,editorState:c,prevEditorState:u})=>{if(i.has(b9)||i.has(Nb)||e.isComposing())return;const d=c.read(Zt),h=u.read(Zt);if(!Ot(h)||!Ot(d)||!d.isCollapsed()||d.is(h))return;const g=d.anchor.key,p=d.anchor.offset,x=c._nodeMap.get(g);!er(x)||!o.has(g)||p!==1&&p>h.anchor.offset+1||e.update((()=>{if(!ase(x))return;const v=x.getParent();v===null||K4(v)||a(v,x,d.anchor.offset)}))}))}const lse=/^(\s*)(\d{1,})\.\s/,cse=/^(\s*)[-*+]\s/,use=/^(#{1,6})\s/,dse=/^>\s/,fse=/^[ \t]*```([\w-]+)?/,hse=/[ \t]*```$/,SB=e=>(t,r,n,s)=>{const a=e(n);a.append(...r),t.replace(a),s||a.select(0,0)},kB=e=>(t,r,n,s)=>{const a=t.getPreviousSibling(),i=t.getNextSibling(),o=qo(e==="check"?n[3]==="x":void 0);if(Vr(i)&&i.getListType()===e){const u=i.getFirstChild();u!==null?u.insertBefore(o):i.append(o),t.remove()}else if(Vr(a)&&a.getListType()===e)a.append(o),t.remove();else{const u=ko(e,e==="number"?Number(n[2]):void 0);u.append(o),t.replace(u)}o.append(...r),s||o.select(0,0);const c=(function(u){const d=u.match(/\t/g),h=u.match(/ /g);let g=0;return d&&(g+=d.length),h&&(g+=Math.floor(h.length/4)),g})(n[1]);c&&o.setIndent(c)},q4=(e,t,r)=>{const n=[],s=e.getChildren();let a=0;for(const i of s)if(Cn(i)){if(i.getChildrenSize()===1){const d=i.getFirstChild();if(Vr(d)){n.push(q4(d,t,r+1));continue}}const o=" ".repeat(4*r),c=e.getListType(),u=c==="number"?`${e.getStart()+a}. `:c==="check"?`- [${i.getChecked()?"x":" "}] `:"- ";n.push(o+u+t(i)),a++}return n.join(`
`)},gse={dependencies:[Bv],export:(e,t)=>{if(!une(e))return null;const r=Number(e.getTag().slice(1));return"#".repeat(r)+" "+t(e)},regExp:use,replace:SB((e=>{const t="h"+e[1].length;return ff(t)})),type:"element"},mse={dependencies:[Mv],export:(e,t)=>{if(!I8(e))return null;const r=t(e).split(`
`),n=[];for(const s of r)n.push("> "+s);return n.join(`
`)},regExp:dse,replace:(e,t,r,n)=>{if(n){const a=e.getPreviousSibling();if(I8(a))return a.splice(a.getChildrenSize(),0,[Qc(),...t]),void e.remove()}const s=Lv();s.append(...t),e.replace(s),n||s.select(0,0)},type:"element"},pse={dependencies:[E0],export:e=>{if(!K4(e))return null;const t=e.getTextContent();return"```"+(e.getLanguage()||"")+(t?`
`+t:"")+"\n```"},regExpEnd:{optional:!0,regExp:hse},regExpStart:fse,replace:(e,t,r,n,s,a)=>{let i,o;if(!t&&s){if(s.length===1)n?(i=zu(),o=r[1]+s[0]):(i=zu(r[1]),o=s[0].startsWith(" ")?s[0].slice(1):s[0]);else{if(i=zu(r[1]),s[0].trim().length===0)for(;s.length>0&&!s[0].length;)s.shift();else s[0]=s[0].startsWith(" ")?s[0].slice(1):s[0];for(;s.length>0&&!s[s.length-1].length;)s.pop();o=s.join(`
`)}const c=Ps(o);i.append(c),e.append(i)}else t&&SB((c=>zu(c?c[1]:void 0)))(e,t,r,a)},type:"multiline-element"},xse={dependencies:[Rf,cd],export:(e,t)=>Vr(e)?q4(e,t,0):null,regExp:cse,replace:kB("bullet"),type:"element"},yse={dependencies:[Rf,cd],export:(e,t)=>Vr(e)?q4(e,t,0):null,regExp:lse,replace:kB("number"),type:"element"},vse={format:["code"],tag:"`",type:"text-format"},wse={format:["highlight"],tag:"==",type:"text-format"},bse={format:["bold","italic"],tag:"***",type:"text-format"},_se={format:["bold","italic"],intraword:!1,tag:"___",type:"text-format"},Sse={format:["bold"],tag:"**",type:"text-format"},kse={format:["bold"],intraword:!1,tag:"__",type:"text-format"},Cse={format:["strikethrough"],tag:"~~",type:"text-format"},Tse={format:["italic"],tag:"*",type:"text-format"},Ese={format:["italic"],intraword:!1,tag:"_",type:"text-format"},Nse={dependencies:[Mf],export:(e,t,r)=>{if(!tse(e)||rse(e))return null;const n=e.getTitle(),s=t(e);return n?`[${s}](${e.getURL()} "${n}")`:`[${s}](${e.getURL()})`},importRegExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))/,regExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))$/,replace:(e,t)=>{const[,r,n,s]=t,a=Db(n,{title:s}),i=r.split("[").length-1,o=r.split("]").length-1;let c=r,u="";if(i<o)return;if(i>o){const h=r.split("[");u="["+h[0],c=h.slice(1).join("[")}const d=Ps(c);return d.setFormat(e.getFormat()),a.append(d),e.replace(a),u&&a.insertBefore(Ps(u)),d},trigger:")",type:"text-match"},Ase=[gse,mse,xse,yse],jse=[pse],Pse=[vse,bse,_se,Sse,kse,wse,Tse,Ese,Cse],Fse=[Nse],e2=[...Ase,...jse,...Pse,...Fse];function pF(e,t){return e.getEditorState().read((()=>{const r=la(t);return r!==null&&r.isSelected()}))}function Ose(e){const[t]=tu(),[r,n]=S.useState((()=>pF(t,e)));return S.useEffect((()=>{let s=!0;const a=t.registerUpdateListener((()=>{s&&n(pF(t,e))}));return()=>{s=!1,a()}}),[t,e]),[r,S.useCallback((s=>{t.update((()=>{let a=Zt();Si(a)||(a=p4(),hi(a)),Si(a)&&(s?a.add(e):a.delete(e))}))}),[t,e]),S.useCallback((()=>{t.update((()=>{const s=Zt();Si(s)&&s.clear()}))}),[t])]}function Dse({nodeKey:e}){const[t]=tu(),[r,n,s]=Ose(e);return S.useEffect((()=>T0(t.registerCommand(u4,(a=>{const i=t.getElementByKey(e);return a.target===i&&(a.shiftKey||s(),n(!r),!0)}),Wg))),[s,t,r,e,n]),S.useEffect((()=>{const a=t.getElementByKey(e),i=t._config.theme.hrSelected??"selected";a!==null&&(r?wa(a,i):vf(a,i))}),[t,r,e]),null}class Uv extends v4{static getType(){return"horizontalrule"}static clone(t){return new Uv(t.__key)}static importJSON(t){return Y4().updateFromJSON(t)}static importDOM(){return{hr:()=>({conversion:Ise,priority:0})}}exportDOM(){return{element:document.createElement("hr")}}createDOM(t){const r=document.createElement("hr");return wa(r,t.theme.hr),r}getTextContent(){return`
`}isInline(){return!1}updateDOM(){return!1}decorate(){return l.jsx(Dse,{nodeKey:this.__key})}}function Ise(){return{node:Y4()}}function Y4(){return ao(new Uv)}function Rse(e){return e instanceof Uv}const Mse=[{dependencies:[Uv],export:e=>Rse(e)?"***":null,regExp:/^(---|\*\*\*|___)\s?$/,replace:(e,t,r,n)=>{const s=Y4();n||e.getNextSibling()!=null?e.replace(s):e.insertBefore(s),s.selectNext()},type:"element"},...e2];function CB({transformers:e=Mse}){const[t]=tu();return S.useEffect((()=>ose(t,e)),[t,e]),null}function TB({hasStrictIndent:e=!1}){const[t]=tu();return S.useEffect((()=>{if(!t.hasNodes([Rf,cd]))throw new Error("ListPlugin: ListNode and/or ListItemNode not registered on editor")}),[t]),S.useEffect((()=>{if(e)return zne(t)}),[t,e]),(function(r){S.useEffect((()=>Une(r)),[r])})(t),null}const Lse=({onChange:e})=>{const[t]=S.useContext($m)||[];return S.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{ps().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},Bse=()=>{const[e]=S.useContext($m)||[],t=S.useCallback(()=>{e&&e.dispatchCommand(Pi,"bold")},[e]),r=S.useCallback(()=>{e&&e.dispatchCommand(Pi,"italic")},[e]),n=S.useCallback(()=>{e&&e.dispatchCommand(Pi,"underline")},[e]),s=S.useCallback(()=>{e&&e.dispatchCommand(Pi,"strikethrough")},[e]),a=S.useCallback(p=>{e&&e.update(()=>{const x=Zt();Ot(x)&&lm(x,()=>ff(p))})},[e]),i=S.useCallback(()=>{e&&e.update(()=>{const p=Zt();Ot(p)&&lm(p,()=>ss())})},[e]);S.useCallback(()=>{e&&e.update(()=>{const p=Zt();Ot(p)&&lm(p,()=>Lv())})},[e]);const o=S.useCallback(()=>{e&&e.dispatchCommand(H4)},[e]),c=S.useCallback(()=>{e&&e.dispatchCommand(G4)},[e]),u=S.useCallback(()=>{e&&e.dispatchCommand(V4)},[e]),d=S.useCallback(p=>{e&&e.update(()=>{const x=Zt();Ot(x)&&x.getNodes().forEach(v=>{er(v)&&v.setStyle(`color: ${p}`)})})},[e]),h=S.useCallback(p=>{e&&e.update(()=>{const x=Zt();Ot(x)&&x.getNodes().forEach(w=>{if(er(w)){const C=w.getStyle(),k=C?C.replace(/font-size:\s*\d+px;?\s*/g,"").trim():"",b=k?`${k}; font-size: ${p}px;`:`font-size: ${p}px;`;w.setStyle(b)}})})},[e]),g=S.useCallback(p=>{e&&e.dispatchCommand(ZL,p)},[e]);return l.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:t,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),l.jsx("button",{type:"button",onClick:r,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),l.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),l.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:()=>a("h1"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),l.jsx("button",{type:"button",onClick:()=>a("h2"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),l.jsx("button",{type:"button",onClick:()=>a("h3"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),l.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:o,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:" List"}),l.jsx("button",{type:"button",onClick:c,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1. List"}),l.jsx("button",{type:"button",onClick:u,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:"No List"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Color:"}),l.jsx("button",{type:"button",onClick:()=>d("#000000"),className:"w-6 h-6 bg-black border border-gray-300 rounded hover:bg-gray-800",title:"Black"}),l.jsx("button",{type:"button",onClick:()=>d("#ff0000"),className:"w-6 h-6 bg-red-500 border border-gray-300 rounded hover:bg-red-600",title:"Red"}),l.jsx("button",{type:"button",onClick:()=>d("#0000ff"),className:"w-6 h-6 bg-blue-500 border border-gray-300 rounded hover:bg-blue-600",title:"Blue"}),l.jsx("button",{type:"button",onClick:()=>d("#008000"),className:"w-6 h-6 bg-green-500 border border-gray-300 rounded hover:bg-green-600",title:"Green"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Size:"}),l.jsx("button",{type:"button",onClick:()=>h(12),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Small",children:"12px"}),l.jsx("button",{type:"button",onClick:()=>h(16),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Normal",children:"16px"}),l.jsx("button",{type:"button",onClick:()=>h(20),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Large",children:"20px"}),l.jsx("button",{type:"button",onClick:()=>h(24),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Extra Large",children:"24px"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Align:"}),l.jsx("button",{type:"button",onClick:()=>g("left"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Left",children:""}),l.jsx("button",{type:"button",onClick:()=>g("center"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Center",children:""}),l.jsx("button",{type:"button",onClick:()=>g("right"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Right",children:""})]})]})},$se=({value:e,onChange:t,placeholder:r})=>{const n={namespace:"LexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Bv,Rf,cd,Mv,E0,Z_,$v,Km,qm,Ym,Mf],onError:s=>{console.error("Lexical error:",s)},editorState:e?(()=>{try{const s=JSON.parse(e);return JSON.stringify(s)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return l.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:l.jsxs($9,{initialConfig:n,children:[l.jsx(Bse,{}),l.jsx(Lse,{onChange:t}),l.jsxs("div",{className:"relative",children:[l.jsx(sB,{contentEditable:l.jsx(iB,{className:"p-4 min-h-32 focus:outline-none",placeholder:r}),placeholder:l.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:cB}),l.jsx(oB,{}),l.jsx(lB,{}),l.jsx(TB,{}),l.jsx(CB,{transformers:e2})]})]})})},Use=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=cs(),{post:o}=Qo(),{showNotification:c}=za(),[u,d]=S.useState({test_name:e,num_questions:1,passing_score:100,questions:[{id:1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048}]}),[h,g]=S.useState({isLoading:!1,error:null,showPreview:!0});S.useEffect(()=>{d(C=>({...C,test_name:e||""}))},[e]);const p=()=>{if(u.num_questions>=3){g(b=>({...b,error:"Maximum 3 questions allowed for performance reasons"}));return}const k={id:Math.max(...u.questions.map(b=>b.id))+1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048};d(b=>({...b,num_questions:b.num_questions+1,questions:[...b.questions,k]}))},x=C=>{u.questions.length<=1||d(k=>({...k,num_questions:k.num_questions-1,questions:k.questions.filter(b=>b.id!==C)}))},v=(C,k)=>{d(b=>({...b,questions:b.questions.map(N=>N.id===C?{...N,question_json:k}:N)}))},w=async()=>{if(!u.test_name.trim()){g(C=>({...C,error:"Test name is required"}));return}if(u.questions.some(C=>!C.question_json.trim())){g(C=>({...C,error:"All questions must have content"}));return}g(C=>({...C,isLoading:!0,error:null}));try{const C={test_name:u.test_name,num_questions:u.num_questions,passing_score:u.passing_score,questions:u.questions.map((k,b)=>({question_id:b+1,question_json:k.question_json,canvas_width:k.canvas_width,canvas_height:k.canvas_height,max_canvas_width:k.max_canvas_width,max_canvas_height:k.max_canvas_height}))};t&&t(C)}catch(C){console.error("Error preparing drawing test:",C),g(k=>({...k,error:"Failed to prepare drawing test. Please try again."})),c("Failed to prepare drawing test","error")}finally{g(C=>({...C,isLoading:!1}))}};return l.jsxs("div",{className:"drawing-test-creator max-w-4xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Drawing Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a test where students draw based on your instructions"})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Drawing Questions (",u.num_questions,"/3)"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Maximum 3 questions for optimal performance"})]}),l.jsxs(Ye,{onClick:p,disabled:u.num_questions>=3,variant:"primary",size:"sm",className:"flex items-center gap-2",children:[l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Question"]})]}),l.jsx("div",{className:"space-y-4",children:u.questions.map((C,k)=>l.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("h4",{className:"text-md font-medium text-gray-800",children:["Text ",k+1]}),u.questions.length>1&&l.jsx(Ye,{onClick:()=>x(C.id),variant:"secondary",size:"sm",className:"text-red-600 hover:text-red-700",children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Content *"}),l.jsx($se,{value:C.question_json,onChange:b=>v(C.id,b),placeholder:""})]})]},C.id))})]}),h.error&&l.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-700",children:h.error}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx(Ye,{onClick:r,variant:"secondary",disabled:h.isLoading,children:"Cancel"}),l.jsx(Ye,{onClick:w,variant:"primary",disabled:h.isLoading||!u.test_name.trim(),className:"flex items-center gap-2",children:h.isLoading?l.jsxs(l.Fragment,{children:[l.jsx(zr,{size:"sm",color:"white"}),"Saving..."]}):"Save Test"})]})]})},zse=({onChange:e})=>{const[t]=S.useContext($m)||[];return S.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{ps().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},Wse=({onAddBlank:e,blankCount:t})=>{const[r]=S.useContext($m)||[],n=S.useCallback(()=>{r&&r.dispatchCommand(Pi,"bold")},[r]),s=S.useCallback(()=>{r&&r.dispatchCommand(Pi,"italic")},[r]),a=S.useCallback(()=>{r&&r.dispatchCommand(Pi,"underline")},[r]),i=S.useCallback(()=>{r&&r.dispatchCommand(Pi,"strikethrough")},[r]),o=S.useCallback(x=>{r&&r.update(()=>{const v=Zt();Ot(v)&&lm(v,()=>ff(x))})},[r]),c=S.useCallback(()=>{r&&r.update(()=>{const x=Zt();Ot(x)&&lm(x,()=>ss())})},[r]),u=S.useCallback(()=>{r&&r.update(()=>{const x=Zt();Ot(x)&&lm(x,()=>Lv())})},[r]),d=S.useCallback(()=>{r&&r.dispatchCommand(H4)},[r]),h=S.useCallback(()=>{r&&r.dispatchCommand(G4)},[r]),g=S.useCallback(()=>{r&&r.dispatchCommand(V4)},[r]),p=S.useCallback(()=>{!r||!e||(r.update(()=>{const x=Zt();if(Ot(x)){const w=`${t+1}_________`,C=Ps(w);C.setStyle("background-color: #f0f9ff; border: 1px dashed #3b82f6; padding: 2px 4px; border-radius: 4px; font-family: monospace;"),x.insertNodes([C])}}),e())},[r,e,t]);return l.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),l.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),l.jsx("button",{type:"button",onClick:a,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),l.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:()=>o("h1"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),l.jsx("button",{type:"button",onClick:()=>o("h2"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),l.jsx("button",{type:"button",onClick:()=>o("h3"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),l.jsx("button",{type:"button",onClick:c,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"}),l.jsx("button",{type:"button",onClick:u,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Quote",children:'"'})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:d,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:""}),l.jsx("button",{type:"button",onClick:h,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1."}),l.jsx("button",{type:"button",onClick:g,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:""})]}),e&&l.jsx("div",{className:"flex items-center gap-1 border-l border-gray-300 pl-2",children:l.jsxs("button",{type:"button",onClick:p,className:"px-3 py-1 text-sm font-medium bg-blue-500 text-white border border-blue-600 rounded hover:bg-blue-600 transition-colors",title:"Add Blank",children:[l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",className:"inline mr-1",children:l.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Blank"]})})]})},Hse=({value:e,onChange:t,placeholder:r,onAddBlank:n,blankCount:s=0})=>{const a={namespace:"FillBlanksLexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Bv,Rf,cd,Mv,E0,Z_,$v,Km,qm,Ym,Mf],onError:i=>{console.error("Lexical error:",i)},editorState:e?(()=>{try{const i=JSON.parse(e);return JSON.stringify(i)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return l.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:l.jsxs($9,{initialConfig:a,children:[l.jsx(Wse,{onAddBlank:n,blankCount:s}),l.jsx(zse,{onChange:t}),l.jsxs("div",{className:"relative",children:[l.jsx(sB,{contentEditable:l.jsx(iB,{className:"p-4 min-h-32 focus:outline-none"}),placeholder:l.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:cB}),l.jsx(oB,{}),l.jsx(lB,{}),l.jsx(TB,{}),l.jsx(CB,{transformers:e2})]})]})})},Gse=({testName:e="",allowedTime:t=null,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const{user:o}=cs(),{post:c}=Qo(),{showNotification:u}=za(),[d,h]=S.useState({test_name:e,test_text:"",num_questions:1,num_blanks:0,passing_score:100,separate_type:!0,allowed_time:t,blanks:[]}),[g,p]=S.useState({isLoading:!1,error:null,showPreview:!0});S.useEffect(()=>{h(F=>({...F,test_name:e||"",allowed_time:t}))},[e,t]);const x=F=>{h(A=>({...A,test_text:F}))},v=()=>{const A={id:d.blanks.length+1,position:0,question:"",options:["","","",""],correct_answer:""};h(j=>({...j,blanks:[...j.blanks,A],num_blanks:j.num_blanks+1}))},w=F=>{h(A=>({...A,blanks:A.blanks.filter(j=>j.id!==F),num_blanks:A.num_blanks-1}))},C=F=>{h(A=>({...A,blanks:A.blanks.map(j=>j.id===F?{...j,options:[...j.options,""]}:j)}))},k=(F,A)=>{h(j=>({...j,blanks:j.blanks.map(I=>I.id===F?{...I,options:I.options.filter((B,Y)=>Y!==A),correct_answer:I.correct_answer===String.fromCharCode(65+A)?"":I.correct_answer}:I)}))},b=(F,A,j)=>{h(I=>({...I,blanks:I.blanks.map(B=>B.id===F?{...B,options:B.options.map((Y,Z)=>Z===A?j:Y)}:B)}))},N=(F,A)=>{console.log(" [DEBUG] updateBlankQuestion called:",{blankId:F,question:A}),h(j=>({...j,blanks:j.blanks.map(I=>I.id===F?{...I,question:A}:I)})),console.log(" [DEBUG] updateBlankQuestion completed")},E=(F,A)=>{h(j=>({...j,blanks:j.blanks.map(I=>I.id===F?{...I,correct_answer:A}:I)}))},P=async()=>{if(!d.test_name.trim()){p(F=>({...F,error:"Test name is required"}));return}if(!d.test_text.trim()){p(F=>({...F,error:"Test text is required"}));return}if(d.blanks.length===0){p(F=>({...F,error:"At least one blank is required"}));return}if(console.log(" [DEBUG] Validating blanks:",d.blanks),d.blanks.forEach((F,A)=>{console.log(` [DEBUG] Blank ${A+1}:`,{question:F.question,questionTrimmed:F.question?.trim(),correct_answer:F.correct_answer,options:F.options})}),d.separate_type===!1){if(d.blanks.some(F=>!F.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing correct answer"),p(F=>({...F,error:"All blanks must have correct answers"}));return}}else if(d.blanks.some(F=>!F.question.trim()||!F.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing question or correct answer"),p(F=>({...F,error:"All blanks must have question text and correct answer"}));return}console.log(" [DEBUG] Validation passed - all blanks have question and correct answer"),p(F=>({...F,isLoading:!0,error:null}));try{const F={test_name:d.test_name,test_text:d.test_text,num_questions:d.blanks.length,num_blanks:d.blanks.length,separate_type:d.separate_type,passing_score:d.passing_score,allowed_time:d.allowed_time,blanks:d.blanks.map((A,j)=>({question_id:j+1,question_json:A.question,question:A.question,options:A.options,correct_answer:A.correct_answer,blank_positions:{},blank_options:A.options||[],correct_answers:[A.correct_answer]}))};console.log(" [DEBUG] Calling onTestSaved with data:",F),r?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),r(F),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(F){console.error("Error preparing fill blanks test:",F),p(A=>({...A,error:"Failed to prepare fill blanks test. Please try again."})),u("Failed to prepare fill blanks test","error")}finally{p(F=>({...F,isLoading:!1}))}};return l.jsxs("div",{className:"fill-blanks-test-creator max-w-4xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Fill Blanks Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a test with text content and multiple choice blanks"}),g.error&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-600 text-sm",children:g.error})})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${d.separate_type===!0?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>h(F=>({...F,separate_type:!0})),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:d.separate_type===!0,onChange:()=>h(F=>({...F,separate_type:!0})),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Separate Mode"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Multiple choice questions below the text"})]}),l.jsxs("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${d.separate_type===!1?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>h(F=>({...F,separate_type:!1})),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:d.separate_type===!1,onChange:()=>h(F=>({...F,separate_type:!1})),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Inline Mode"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Dropdown for option inside the text"})]})]}),l.jsx(Hse,{value:d.test_text,onChange:x,placeholder:"Type your text here. Use the 'Add Blank' button in the toolbar to insert blanks.",onAddBlank:v,blankCount:d.blanks.length})]}),d.separate_type===!0&&l.jsx("div",{className:"space-y-4",children:d.blanks.map((F,A)=>l.jsxs(Nt,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-md font-medium",children:["Blank ",F.id," Configuration"]}),l.jsx(Ye,{variant:"danger",size:"small",onClick:()=>w(F.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Question Text for Blank ",F.id," *"]}),l.jsx("input",{type:"text",placeholder:"Enter question text for this blank",value:F.question,onChange:j=>N(F.id,j.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),F.options.map((j,I)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+I)}),l.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+I)}`,value:j||"",onChange:B=>b(F.id,I,B.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),F.options.length>2&&l.jsx(Ye,{variant:"danger",size:"small",onClick:()=>k(F.id,I),className:"px-2 py-1 text-sm",children:""})]},I)),F.options.length<6&&l.jsx(Ye,{variant:"secondary",size:"small",onClick:()=>C(F.id),className:"w-full",children:"+ Add Option"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{value:F.correct_answer||"",onChange:j=>E(F.id,j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),F.options.filter(j=>j.trim().length>0).map((j,I)=>l.jsxs("option",{value:String.fromCharCode(65+I),children:[String.fromCharCode(65+I),") ",j]},I))]})]})]},F.id))}),d.separate_type===!1&&l.jsx("div",{className:"space-y-4",children:d.blanks.map((F,A)=>l.jsxs(Nt,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-md font-medium",children:["Blank ",F.id," Options"]}),l.jsx(Ye,{variant:"danger",size:"small",onClick:()=>w(F.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),F.options.map((j,I)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+I)}),l.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+I)}`,value:j||"",onChange:B=>b(F.id,I,B.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),F.options.length>2&&l.jsx(Ye,{variant:"danger",size:"small",onClick:()=>k(F.id,I),className:"px-2 py-1 text-sm",children:""})]},I)),F.options.length<6&&l.jsx(Ye,{variant:"secondary",size:"small",onClick:()=>C(F.id),className:"w-full",children:"+ Add Option"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{value:F.correct_answer||"",onChange:j=>E(F.id,j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),F.options.filter(j=>j.trim().length>0).map((j,I)=>l.jsxs("option",{value:String.fromCharCode(65+I),children:[String.fromCharCode(65+I),") ",j]},I))]})]})]},F.id))}),l.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[l.jsx(Ye,{onClick:n,variant:"secondary",disabled:a,children:"Cancel"}),l.jsx(Ye,{onClick:P,variant:"primary",disabled:a||d.blanks.length===0,children:a?l.jsx(zr,{size:"sm"}):"Save Test"})]})]})},Vse=[{value:"A1",label:"A1 (Beginner)",description:"Basic vocabulary, simple sentences"},{value:"A2",label:"A2 (Elementary)",description:"Everyday vocabulary, present/past tenses"},{value:"B1",label:"B1 (Intermediate)",description:"Varied vocabulary, complex sentences"},{value:"B2",label:"B2 (Upper-Intermediate)",description:"Advanced vocabulary, sophisticated structures"},{value:"C1",label:"C1 (Advanced)",description:"Nuanced vocabulary, complex discourse"},{value:"C2",label:"C2 (Proficiency)",description:"Native-like fluency and accuracy"}],Kse=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{showNotification:i}=za(),[o,c]=S.useState({min_words:50,questions:[{question_id:1,prompt:"",expected_duration:null,difficulty_level:"B1"}]}),[u,d]=S.useState(!1),h=S.useCallback((C,k)=>{c(b=>({...b,[C]:k}))},[]),g=S.useCallback((C,k,b)=>{c(N=>({...N,questions:N.questions.map((E,P)=>P===C?{...E,[k]:b}:E)}))},[]),p=S.useCallback(()=>{c(C=>({...C,questions:[...C.questions,{question_id:C.questions.length+1,prompt:"",expected_duration:null,difficulty_level:"B1"}]}))},[]),x=S.useCallback(C=>{o.questions.length>1&&c(k=>({...k,questions:k.questions.filter((b,N)=>N!==C)}))},[o.questions.length]),v=S.useCallback(()=>{const C={};return o.min_words<10&&(C.min_words="Minimum word count must be at least 10 words"),o.questions.forEach((k,b)=>{k.prompt.trim()||(C[`question_${b}_prompt`]="Question prompt is required")}),C},[o]),w=S.useCallback(async C=>{C.preventDefault();const k=v();if(Object.keys(k).length>0){i("Please fix the validation errors","error");return}d(!0);try{const b={test_name:e,time_limit:300,min_duration:30,max_duration:600,max_attempts:3,min_words:o.min_words,passing_score:50,allowed_time:null,questions:o.questions.map((N,E)=>({question_id:E+1,prompt:N.prompt,expected_duration:N.expected_duration,difficulty_level:N.difficulty_level}))};console.log(" [DEBUG] Calling onTestSaved with data:",b),t?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),t(b),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(b){console.error("Error preparing speaking test:",b),i("Failed to prepare speaking test","error")}finally{d(!1)}},[o,v,i,t,e]);return u||s?l.jsxs("div",{className:"flex items-center justify-center p-8",children:[l.jsx(zr,{}),l.jsx("span",{className:"ml-2",children:"Creating speaking test..."})]}):l.jsxs("div",{className:"speaking-test-creator max-w-4xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Speaking Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a speaking test where students record audio responses with AI-powered feedback"})]}),l.jsxs("form",{onSubmit:w,className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Scoring Settings"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Word Count *"}),l.jsx("input",{type:"number",min:"10",max:"1000",value:o.min_words,onChange:C=>h("min_words",parseInt(C.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.min_words&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.min_words})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Questions"}),l.jsx(Ye,{type:"button",variant:"outline",onClick:p,children:"Add Question"})]}),o.questions.length>1&&l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Multiple Questions Detected"}),l.jsx("div",{className:"mt-1 text-sm text-blue-700",children:l.jsxs("p",{children:["You have ",o.questions.length," questions in this test.",l.jsx("strong",{children:" Only one question will be randomly selected"})," and shown to each student. This ensures fair distribution across your question pool."]})})]})]})}),o.questions.map((C,k)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("h4",{className:"font-medium",children:["Question ",k+1]}),o.questions.length>1&&l.jsx(Ye,{type:"button",variant:"outline",size:"sm",onClick:()=>x(k),className:"text-red-600 hover:text-red-700",children:"Remove"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Prompt *"}),l.jsx("textarea",{value:C.prompt,onChange:b=>g(k,"prompt",b.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Enter the question prompt for students"}),a[`question_${k}_prompt`]&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:a[`question_${k}_prompt`]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected Duration (seconds)"}),l.jsx("input",{type:"number",min:"10",max:"600",value:C.expected_duration||"",onChange:b=>g(k,"expected_duration",b.target.value?parseInt(b.target.value):null),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CEFR Level"}),l.jsx("select",{value:C.difficulty_level,onChange:b=>g(k,"difficulty_level",b.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:Vse.map(b=>l.jsxs("option",{value:b.value,children:[b.label," - ",b.description]},b.value))}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the appropriate CEFR level for this question. This will be used by AI to evaluate students appropriately."})]})]})]})]},k))]}),l.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[l.jsx(Ye,{type:"button",variant:"secondary",onClick:r,children:"Cancel"}),l.jsx(Ye,{type:"submit",variant:"primary",disabled:u||s,children:u||s?"Creating...":"Create Speaking Test"})]})]})]})},EB=(e,t)=>{const[r,n]=S.useState(()=>{try{const i=window.localStorage.getItem(e);return i?JSON.parse(i):t}catch(i){return console.error(`Error reading localStorage key "${e}":`,i),t}}),s=S.useCallback(i=>{try{const o=i instanceof Function?i(r):i;n(o),window.localStorage.setItem(e,JSON.stringify(o))}catch(o){console.error(`Error setting localStorage key "${e}":`,o)}},[e,r]),a=S.useCallback(()=>{try{window.localStorage.removeItem(e),n(t)}catch(i){console.error(`Error removing localStorage key "${e}":`,i)}},[e,t]);return[r,s,a]},t2=()=>{const e=S.useCallback((c,u=null)=>{try{const d=window.localStorage.getItem(c);return d?JSON.parse(d):u}catch(d){return console.error(`Error reading localStorage key "${c}":`,d),u}},[]),t=S.useCallback((c,u)=>{try{window.localStorage.setItem(c,JSON.stringify(u))}catch(d){console.error(`Error setting localStorage key "${c}":`,d)}},[]),r=S.useCallback(c=>{try{window.localStorage.removeItem(c)}catch(u){console.error(`Error removing localStorage key "${c}":`,u)}},[]),n=S.useCallback(()=>{if(confirm("Are you sure you want to clear all local storage? This cannot be undone."))try{window.localStorage.clear(),window.showNotification?window.showNotification("All local storage cleared!","success"):console.log("All local storage cleared!")}catch(c){console.error("Error clearing localStorage:",c)}},[]),s=S.useCallback(()=>{try{const c={};for(let g=0;g<window.localStorage.length;g++){const p=window.localStorage.key(g);p&&(c[p]=window.localStorage.getItem(p))}const u=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),d=URL.createObjectURL(u),h=document.createElement("a");h.href=d,h.download="localStorage_backup.json",h.click(),URL.revokeObjectURL(d),window.showNotification?window.showNotification("Local storage exported!","success"):console.log("Local storage exported!")}catch(c){console.error("Error exporting localStorage data:",c)}},[]),a=S.useCallback(()=>{try{window.localStorage.clear()}catch(c){console.error("Error clearing localStorage:",c)}},[]),i=S.useCallback(()=>{try{const c={};for(let u=0;u<window.localStorage.length;u++){const d=window.localStorage.key(u);d&&(c[d]=window.localStorage.getItem(d))}return c}catch(c){return console.error("Error exporting localStorage data:",c),{}}},[]),o=S.useCallback(c=>{try{Object.entries(c).forEach(([u,d])=>{window.localStorage.setItem(u,d)})}catch(u){console.error("Error importing localStorage data:",u)}},[]);return{getItem:e,setItem:t,removeItem:r,clearAll:a,clearAllLocalStorage:n,exportLocalStorage:s,exportData:i,importData:o}},qse=({question:e,testId:t,testType:r="true_false",mode:n="student",displayNumber:s,studentAnswer:a,onAnswerChange:i,onQuestionChange:o,onSave:c,isEditing:u=!1,isSaving:d=!1,validationErrors:h={},showCorrectAnswers:g=!1,studentId:p=null})=>{const{getItem:x,setItem:v}=t2();za(),S.useRef(null);const[w,C]=S.useState(""),[k,b]=S.useState(""),[N,E]=S.useState(""),[P,F]=S.useState(!1),[A,j]=S.useState(!0),[I,B]=S.useState(""),[Y,Z]=S.useState(!1),[ae,ee]=S.useState(null);S.useEffect(()=>{if(e&&(E(e.question||""),b(e.correct_answer||""),n==="student"&&p)){const se=x(`test_progress_${p}_${r}_${t}_${e.question_id}`);se&&C(se)}},[e,t,r,n,x]),S.useEffect(()=>{n==="student"&&a!==void 0&&a!==null&&(console.log(" TrueFalseQuestion syncing with parent studentAnswer:",a),C(a))},[a,n]),S.useEffect(()=>{if(n==="student"&&w&&t&&e?.question_id&&p){const se=setTimeout(()=>{Z(!0),v(`test_progress_${p}_${r}_${t}_${e.question_id}`,w),ee(new Date().toLocaleTimeString()),setTimeout(()=>Z(!1),1e3)},1e3);return()=>clearTimeout(se)}},[w,t,r,e?.question_id,n,p,v]),S.useEffect(()=>{if(n==="teacher"&&(N||k)){const se=setTimeout(()=>{Z(!0);const X={question:N,correct_answer:k,timestamp:Date.now()};v(`teacher_form_${r}_${t}`,X),ee(new Date().toLocaleTimeString()),setTimeout(()=>Z(!1),1e3)},2e3);return()=>clearTimeout(se)}},[N,k,t,r,n,v]);const ne=S.useCallback(se=>{n==="student"&&(C(se),i&&i(e.question_id,se),M(se))},[n,e?.question_id,i]),L=S.useCallback(se=>{E(se),o&&o(e.question_id,se),V(se)},[e?.question_id,o]),H=S.useCallback(se=>{b(se),o&&o(e.question_id,{...e,correct_answer:se}),W(se)},[e,o]),M=S.useCallback(se=>{if(n==="student"){if(!se){j(!1),B("Please select an answer");return}j(!0),B("")}},[n]),V=S.useCallback(se=>{if(n==="teacher"){if(!se||se.trim().length<10){j(!1),B("Question must be at least 10 characters long");return}j(!0),B("")}},[n]),W=S.useCallback(se=>{if(n==="teacher"){if(!se){j(!1),B("Please select a correct answer");return}j(!0),B("")}},[n]),R=S.useCallback(()=>{if(n!=="teacher"||!c)return;const se={question_id:e.question_id,question:N,correct_answer:k,type:"true_false"};c(se)},[n,c,e?.question_id,N,k]),U=S.useCallback(se=>se?se.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]),q=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:e?.question_id]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[Y&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(zr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),ae&&!Y&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",ae]})]})]}),l.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:U(N)}}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${w==="true"?"border-blue-500 bg-blue-50":"border-gray-200"} ${g&&k==="true"?"ring-2 ring-green-400":""}`,children:[l.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"true",checked:w==="true",onChange:()=>ne("true"),className:"sr-only","aria-label":"True"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${w==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:w==="true"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${w==="false"?"border-blue-500 bg-blue-50":"border-gray-200"} ${g&&k==="false"?"ring-2 ring-green-400":""}`,children:[l.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"false",checked:w==="false",onChange:()=>ne("false"),className:"sr-only","aria-label":"False"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${w==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:w==="false"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]}),!A&&I&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:I})]}),Q=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[Y&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(zr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),ae&&!Y&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",ae]})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsx("textarea",{id:`question_${e?.question_id}`,value:N,onChange:se=>L(se.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Correct Answer *"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${k==="true"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[l.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"true",checked:k==="true",onChange:()=>H("true"),className:"sr-only","aria-label":"True"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${k==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:k==="true"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${k==="false"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[l.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"false",checked:k==="false",onChange:()=>H("false"),className:"sr-only","aria-label":"False"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${k==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:k==="false"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]})]})]}),!A&&I&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:I}),l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(Ye,{variant:"success",onClick:R,disabled:!A||d,className:"w-full sm:w-auto",children:d?l.jsx(zr,{size:"small"}):"Save Question"})})]});return l.jsx("div",{className:"true-false-question-container",children:n==="student"?q():Q()})},Yse=({question:e,testId:t,testType:r="multiple_choice",mode:n="student",studentAnswer:s,onAnswerChange:a,onQuestionChange:i,onOptionAdd:o,onOptionRemove:c,onSave:u,isEditing:d=!1,isSaving:h=!1,validationErrors:g={},showCorrectAnswers:p=!1,studentId:x=null,displayNumber:v})=>{const{getItem:w,setItem:C}=t2(),{showNotification:k}=za();S.useRef(null);const[b,N]=S.useState(""),[E,P]=S.useState(["","","",""]),[F,A]=S.useState(""),[j,I]=S.useState(""),[B,Y]=S.useState(!1),[Z,ae]=S.useState(!0),[ee,ne]=S.useState(""),[L,H]=S.useState(!1),[M,V]=S.useState(null);S.useEffect(()=>{if(e&&(I(e.question||""),P(e.options||["","","",""]),A(e.correct_answer||""),n==="student"&&x)){const Ee=w(`test_progress_${x}_${r}_${t}_${e.question_id}`);Ee&&N(Ee)}},[e,t,r,n,w]),S.useEffect(()=>{n==="student"&&s!==void 0&&s!==null&&(console.log(" MultipleChoiceQuestion syncing with parent studentAnswer:",s),N(s))},[s,n]),S.useEffect(()=>{if(n==="student"&&b&&t&&e?.question_id&&x){const Ee=setTimeout(()=>{H(!0),C(`test_progress_${x}_${r}_${t}_${e.question_id}`,b),V(new Date().toLocaleTimeString()),setTimeout(()=>H(!1),1e3)},1e3);return()=>clearTimeout(Ee)}},[b,t,r,e?.question_id,n,x,C]),S.useEffect(()=>{if(n==="teacher"&&(j||E.some(Ee=>Ee.trim()))){const Ee=setTimeout(()=>{H(!0);const Ae={question:j,options:E,correct_answer:F,timestamp:Date.now()};C(`teacher_form_${r}_${t}`,Ae),V(new Date().toLocaleTimeString()),setTimeout(()=>H(!1),1e3)},2e3);return()=>clearTimeout(Ee)}},[j,E,F,t,r,n,C]),S.useCallback(Ee=>{if(n!=="student")return;const Ae=String(Ee);N(Ae),a&&a(e.question_id,Ae),se(Ae)},[n,e?.question_id,a]);const W=S.useCallback(Ee=>{I(Ee),i&&i(e.question_id,Ee),X(Ee)},[e?.question_id,i]),R=S.useCallback((Ee,Ae)=>{const He=[...E];He[Ee]=Ae,P(He),i&&i(e.question_id,{...e,options:He}),ie(He)},[E,e,i]),U=S.useCallback(Ee=>{A(Ee),i&&i(e.question_id,{...e,correct_answer:Ee}),le(Ee)},[e,i]),q=S.useCallback(()=>{if(E.length<6){const Ee=[...E,""];P(Ee),o&&o(e.question_id,Ee)}else k("Maximum 6 options allowed","warning")},[E,e?.question_id,o,k]),Q=S.useCallback(Ee=>{if(E.length>2){const Ae=E.filter((He,Be)=>Be!==Ee);if(P(Ae),F===String.fromCharCode(65+Ee))A("");else if(F&&String.fromCharCode(65+Ee)<F){const He=String.fromCharCode(65+Ee-1);A(He)}c&&c(e.question_id,Ae)}else k("Minimum 2 options required","warning")},[E,F,e?.question_id,c,k]),se=S.useCallback(Ee=>{if(n==="student"){if(!Ee){ae(!1),ne("Please select an answer");return}ae(!0),e?.correct_answer&&Ee===e.correct_answer?ne(" Correct answer!"):e?.correct_answer?ne(" Incorrect answer"):ne("Answer selected")}},[n,e?.correct_answer]),X=S.useCallback(Ee=>!Ee||Ee.trim().length<10?(ae(!1),ne("Question must be at least 10 characters long"),!1):(ae(!0),ne(""),!0),[]),ie=S.useCallback(Ee=>{if(n!=="teacher")return;if(Ee.filter(He=>He.trim().length>0).length<2){ae(!1),ne("At least 2 options must be filled");return}if(Ee.some(He=>He.trim().length>0&&He.trim().length<3)){ae(!1),ne("Each option must be at least 3 characters long");return}ae(!0),ne("")},[n]),le=S.useCallback(Ee=>{if(n==="teacher"){if(!Ee){ae(!1),ne("Please select a correct answer");return}ae(!0),ne("")}},[n]),ce=S.useCallback(()=>{if(n!=="teacher"||!u)return;const Ee={question_id:e.question_id,question:j,options:E.filter(Ae=>Ae.trim().length>0),correct_answer:F,type:"multiple_choice"};u(Ee)},[n,u,e?.question_id,j,E,F]),Se=S.useCallback(Ee=>Ee?Ee.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]);return n==="teacher"?l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[L&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(zr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),M&&!L&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",M]})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsx("textarea",{id:`question_${e?.question_id}`,value:j,onChange:Ee=>W(Ee.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Answer Options *"}),l.jsx(Ye,{variant:"secondary",size:"small",onClick:q,disabled:E.length>=6,className:"px-3 py-1 text-sm",children:"+ Add Option"})]}),l.jsx("div",{className:"space-y-3",children:E.map((Ee,Ae)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+Ae)}),l.jsx("input",{type:"text",value:Ee,onChange:He=>R(Ae,He.target.value),placeholder:`Option ${String.fromCharCode(65+Ae)}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0}),E.length>2&&l.jsx(Ye,{variant:"danger",size:"small",onClick:()=>Q(Ae),className:"px-2 py-1 text-sm",children:""})]},Ae))})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:`correct_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{id:`correct_${e?.question_id}`,value:F,onChange:Ee=>U(Ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0,children:[l.jsx("option",{value:"",children:"Select correct answer"}),E.map((Ee,Ae)=>{if(!Ee.trim())return null;const He=String.fromCharCode(65+Ae);return l.jsxs("option",{value:He,children:[He,") ",Ee]},Ae)})]})]})]}),!Z&&ee&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:ee}),l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(Ye,{variant:"success",onClick:ce,disabled:!Z||h,className:"w-full sm:w-auto",children:h?l.jsx(zr,{size:"small"}):"Save Question"})})]}):l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof v=="number"?v:e?.question_id]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[L&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(zr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),M&&!L&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",M]})]})]}),l.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:Se(j)}}),l.jsx("div",{className:"space-y-3",children:E.map((Ee,Ae)=>l.jsxs("label",{className:`flex items-center p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ${b===String.fromCharCode(65+Ae)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[l.jsx("input",{type:"radio",name:`mcq_${t}_${e?.question_id}`,value:String.fromCharCode(65+Ae),checked:b===String.fromCharCode(65+Ae),onChange:He=>{N(He.target.value),a&&a(e?.question_id,He.target.value)},className:"mr-3"}),l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600 mr-3",children:String.fromCharCode(65+Ae)}),l.jsx("span",{className:"flex-1",children:Ee||`Option ${String.fromCharCode(65+Ae)}`})]},Ae))}),!Z&&ee&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:ee})]})},Xse=({question:e,testId:t,testType:r="input",mode:n="student",displayNumber:s,studentAnswer:a,onAnswerChange:i,onQuestionChange:o,onAnswerAdd:c,onAnswerRemove:u,onSave:d,isEditing:h=!1,isSaving:g=!1,validationErrors:p={},showCorrectAnswers:x=!1,studentId:v=null})=>{const{getItem:w,setItem:C}=t2(),{showNotification:k}=za(),b=S.useRef(null),[N,E]=S.useState(""),[P,F]=S.useState([""]),[A,j]=S.useState(!1),[I,B]=S.useState(!0),[Y,Z]=S.useState(""),[ae,ee]=S.useState(!1);S.useEffect(()=>{if(n==="student"&&e?.question_id&&t&&r&&v){const X=`test_progress_${v}_${r}_${t}_${e.question_id}`,ie=w(X);ie&&E(ie)}},[e?.question_id,r,t,n,v,w]),S.useEffect(()=>{n==="student"&&a!==void 0&&a!==null&&(console.log(" InputQuestion syncing with parent studentAnswer:",a),E(a))},[a,n]),S.useEffect(()=>{n==="teacher"&&e?.answers&&F(e.answers.length>0?e.answers:[""])},[e?.answers,n]),S.useEffect(()=>{if(n==="student"&&N&&e?.question_id&&t&&r&&v){const X=setTimeout(()=>{ee(!0),C(`test_progress_${v}_${r}_${t}_${e.question_id}`,N),setTimeout(()=>ee(!1),1e3)},1e3);return()=>clearTimeout(X)}},[N,e?.question_id,r,t,n,v,C]),S.useEffect(()=>{if(n==="teacher"&&P&&o){const X=setTimeout(()=>{o({...e,answers:P.filter(ie=>ie.trim())})},500);return()=>clearTimeout(X)}},[P,e,n,o]);const ne=S.useCallback(X=>{E(X);const ie=X.trim().length>0;B(ie),Z(ie?"":"Please enter an answer"),i&&i(e.question_id,X)},[e?.question_id,i]),L=S.useCallback((X,ie)=>{const le=[...P];le[X]=ie,F(le),i&&i(e.question_id,le)},[P,e?.question_id,i]),H=S.useCallback(()=>{if(n==="teacher"){const X=[...P,""];F(X),c&&c(e.question_id,X)}},[P,e?.question_id,n,c]),M=S.useCallback(X=>{if(n==="teacher"&&P.length>1){const ie=P.filter((le,ce)=>ce!==X);F(ie),u&&u(e.question_id,ie)}},[P,e?.question_id,n,u]),V=S.useCallback(()=>{if(n==="student"){const X=N.trim().length>0;return B(X),Z(X?"":"Please enter an answer"),X}else if(n==="teacher"){const X=P.some(ie=>ie.trim().length>0);return B(X),Z(X?"":"Please enter at least one correct answer"),X}return!0},[N,P,n]),W=S.useCallback(X=>X?X.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>"):"",[]),R=S.useCallback(()=>{j(!0)},[]),U=S.useCallback(()=>{j(!1),V()},[V]),q=S.useCallback(X=>{X.key==="Enter"&&n==="student"&&N.trim()&&(C(`test_progress_${r}_${t}_${e.question_id}`,N),k("Answer saved","success"))},[N,r,t,e?.question_id,n,C,k]),Q=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:e.question_id]}),ae&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[l.jsx(zr,{size:"small"}),l.jsx("span",{children:"Saving..."})]})]}),l.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:W(e.question)}}),l.jsx("div",{className:"space-y-3",children:l.jsx("input",{ref:b,type:"text",id:`input_${e.question_id}`,placeholder:"Enter your answer here...",value:N,onChange:X=>ne(X.target.value),onFocus:R,onBlur:U,onKeyPress:q,className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${I?A?"border-blue-500":"border-gray-300 hover:border-gray-400":"border-red-300 focus:border-red-500 focus:ring-red-500"}`,"data-question-id":e.question_id,"aria-label":`Answer for question ${e.question_id}`,"aria-invalid":!I,"aria-describedby":I?void 0:`error-${e.question_id}`})}),x&&e.correct_answers&&l.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[l.jsx("h5",{className:"text-sm font-semibold text-green-800 mb-2",children:"Correct Answers:"}),l.jsx("ul",{className:"space-y-1",children:e.correct_answers.map((X,ie)=>l.jsxs("li",{className:"text-green-700 text-sm",children:[" ",X]},ie))})]})]}),se=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e.question_id||"New"]}),g&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[l.jsx(zr,{size:"small"}),l.jsx("span",{children:"Saving..."})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e.question_id||"new"}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsx("input",{type:"text",id:`question_${e.question_id||"new"}`,value:e.question||"",onChange:X=>o&&o({...e,question:X.target.value}),placeholder:"Enter question text",className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${p.question?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 hover:border-gray-400 focus:border-blue-500"}`}),p.question&&l.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:p.question})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Correct Answers *"}),l.jsx(Ye,{type:"button",variant:"secondary",size:"small",onClick:H,className:"px-3 py-1 text-sm",children:"+ Add Answer"})]}),l.jsx("div",{className:"space-y-3",children:P.map((X,ie)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:ie+1}),l.jsx("input",{type:"text",value:X,onChange:le=>L(ie,le.target.value),placeholder:`Correct answer ${ie+1}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200","data-question-id":e.question_id,"data-answer-index":ie}),P.length>1&&l.jsx(Ye,{type:"button",variant:"danger",size:"small",onClick:()=>M(ie),className:"px-2 py-1 text-sm",children:" Remove"})]},ie))}),p.answers&&l.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:p.answers})]})]}),d&&l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(Ye,{type:"button",variant:"success",onClick:d,disabled:g,className:"w-full sm:w-auto",children:g?l.jsx(zr,{size:"small"}):"Save Question"})})]});return l.jsx("div",{className:`input-question-container ${n} ${A?"focused":""}`,children:n==="student"?Q():se()})},Xm=(e,t,r)=>{const[n,s]=S.useState(!1),[a,i]=S.useState(0),[o,c]=S.useState(!1),u=S.useRef(!1);S.useEffect(()=>{if(!e||!t||!r)return;const w=`anti_cheating_${r}_${e}_${t}`,C=Rs(w);C&&(i(C.tabSwitches||0),c(C.isCheating||!1))},[e,t,r]);const d=S.useCallback(()=>{if(console.log(" handleTabSwitch called - isTracking:",u.current),!u.current){console.log(" Not tracking, returning early");return}console.log(" Tab switch detected - starting 7 second timer...");const w=Date.now();setTimeout(()=>{const C=Date.now()-w;console.log(" Timer completed - time hidden:",C,"ms"),C>=6500?(console.log(" Tab was hidden for sufficient time - counting as tab switch"),i(k=>{const b=k+1,N=b>=2;console.log(" Tab switch count updated:",{newCount:b,cheating:N}),c(N);const E=`anti_cheating_${r}_${e}_${t}`;return vs(E,{tabSwitches:b,isCheating:N},120*1e3),b})):console.log(" Tab was not hidden long enough - not counting as switch")},7e3)},[e,t,r]),h=S.useCallback(()=>{u.current&&(console.log(" Visibility change detected:",{hidden:document.hidden,isTracking:u.current}),document.hidden?d():console.log(" Tab became visible"))},[d]),g=S.useCallback(()=>{console.log(" startTracking called - setting up anti-cheating detection"),console.log(" Current document.hidden state:",document.hidden),console.log(" Current document.visibilityState:",document.visibilityState),s(!0),u.current=!0,document.addEventListener("visibilitychange",h),console.log(" Anti-cheating event listeners added (visibilitychange only)")},[h]),p=S.useCallback(()=>{console.log(" stopTracking called - removing anti-cheating detection"),s(!1),u.current=!1,document.removeEventListener("visibilitychange",h),console.log(" Anti-cheating event listeners removed")},[h]),x=S.useCallback(()=>{const w={caught_cheating:o,visibility_change_times:a};return console.log(" getCheatingData called:",w),w},[o,a]),v=S.useCallback(()=>{r&&e&&t&&Rm(r,e,t),i(0),c(!1),console.log(" Anti-cheating data deleted from localStorage")},[r,e,t]);return{startTracking:g,stopTracking:p,clearData:v,getCheatingData:x,tabSwitches:a,isCheating:o,isTracking:n}},Qse=({testData:e,onTestComplete:t,onBackToCabinet:r,isTestComplete:n=!1,testScore:s=null})=>{const[a,i]=S.useState(null),[o,c]=S.useState(null);S.useEffect(()=>{(async()=>{try{const[ht,Dt]=await Promise.all([Zi(()=>Promise.resolve().then(()=>Ree),void 0),Zi(()=>Promise.resolve().then(()=>gZ),void 0)]);i(ht),c(Dt.default)}catch(ht){console.error("Failed to load Konva:",ht)}})()},[]);const u=()=>a?{Stage:a.Stage,Layer:a.Layer,Rect:a.Rect,Arrow:a.Arrow,KonvaImage:a.Image,KonvaText:a.Text,Group:a.Group}:null,[d,h]=S.useState({}),[g,p]=S.useState({}),[x,v]=S.useState(0),[w,C]=S.useState(!1),[k,b]=S.useState(null),[N,E]=S.useState(0),[P,F]=S.useState(0),[A,j]=S.useState(null),[I,B]=S.useState(null),[Y,Z]=S.useState(!1),[ae,ee]=S.useState(!1),[ne,L]=S.useState(!1),{showNotification:H}=za(),{makeAuthenticatedRequest:M}=Qo(),{user:V}=cs(),{startTracking:W,stopTracking:R,getCheatingData:U,clearData:q}=Xm("matching_type",e?.id,V?.student_id||V?.id),Q=S.useRef(null),se=S.useRef(null),X=S.useRef(null),ie=S.useRef(0),[le,ce]=S.useState(400);S.useRef({});const Se=S.useCallback(()=>{Z(!0)},[]),re=S.useCallback(()=>{p({}),h({}),Z(!1)},[]),ge=S.useCallback(()=>{ee(!0)},[]),Ee=S.useCallback(()=>{ee(!1),r()},[r]),Ae=S.useMemo(()=>{if(!e)return null;const it=e.blocks.map(Mt=>{let Xe=Mt.coordinates;if(typeof Xe=="string")try{Xe=JSON.parse(Xe)}catch(De){console.error(" Failed to parse coordinates:",De),Xe={x:0,y:0,width:100,height:100}}return Xe={x:(typeof Xe.x=="number"?Xe.x:Number(Xe.x))||0,y:(typeof Xe.y=="number"?Xe.y:Number(Xe.y))||0,width:(typeof Xe.width=="number"?Xe.width:Number(Xe.width))||30,height:(typeof Xe.height=="number"?Xe.height:Number(Xe.height))||10},{id:Mt.id,word:Mt.word,coordinates:Xe,hasArrow:Mt.hasArrow,arrow:Mt.arrow}}),ht=Array.isArray(e.arrows)?e.arrows:[],Dt=e.words.map(Mt=>({id:Mt.id,word:Mt.word,blockId:null,isPlaced:!1,isCorrect:!1}));return{blocks:it,arrows:ht,words:Dt}},[e]);S.useEffect(()=>{if(!e?.image_url)return;const it=new Image;it.crossOrigin="anonymous",it.onload=()=>{console.log(" Image loaded successfully"),E(it.width),F(it.height);const ht=Q.current?.clientWidth||800,Dt=Q.current?.clientHeight||600,Mt=ht/it.width,Xe=Dt/it.height,De=Math.min(Mt,Xe,1),Le=it.width*De,lt=it.height*De,Ue=(ht-Le)/2,tt=(Dt-lt)/2;b({x:Ue,y:tt,width:Le,height:lt,scaleX:De,scaleY:De,scale:De,image:it}),ie.current=Q.current?.clientWidth||800,console.log(" Image info calculated:",{x:Ue,y:tt,width:Le,height:lt,scaleX:De,scaleY:De})},it.onerror=()=>{console.error(" Failed to load image"),H("Failed to load test image","error")},it.src=e.image_url},[e?.image_url,H]),S.useEffect(()=>{if(!Ae||!k)return;const it=ie.current||Q.current?.clientWidth||800,ht=12,Dt=38;let Mt=k.x,Xe=k.y+k.height+ht;const De=k.x+k.width,Le={};Ae.words.forEach(tt=>{if(!Object.prototype.hasOwnProperty.call(g,tt.id)){const Et=typeof tt.word=="string"?tt.word:"",At=Math.max(60,Et.length*8+20);Mt+At>Math.min(it-ht,De)&&(Mt=k.x,Xe+=Dt),d[tt.id]||(Le[tt.id]={x:Mt,y:Xe}),Mt+=At+ht}}),Object.keys(Le).length&&h(tt=>({...tt,...Le}));const lt=Object.values(Le).reduce((tt,Et)=>Math.max(tt,Et.y),Xe),Ue=Math.max(k.y+k.height+ht,lt+Dt+ht);ce(Math.max(400,Math.ceil(Ue)))},[Ae,k,g,d]);const He=S.useCallback(()=>{if(!k||!Ae)return[];const it=u();return it?Ae.blocks.map(ht=>{const Dt=ht.coordinates;let Mt,Xe,De,Le;Mt=k.x+Dt.x*(k.scale??k.scaleX),Xe=k.y+Dt.y*(k.scale??k.scaleY),De=Dt.width*(k.scale??k.scaleX),Le=Dt.height*(k.scale??k.scaleY);const lt=g[ht.id];return l.jsxs(it.Group,{children:[l.jsx(it.Rect,{x:Mt,y:Xe,width:De,height:Le,fill:lt?"rgba(40, 167, 69, 0.4)":A===ht.id?"rgba(0, 123, 255, 0.25)":"rgba(0, 123, 255, 0.15)",stroke:lt?"#28a745":A===ht.id?"#0056b3":"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:lt?"rgba(40, 167, 69, 0.3)":"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),lt&&l.jsx(it.KonvaText,{x:Mt+5,y:Xe+Le/2-10,width:De-10,height:20,text:Ae.words.find(Ue=>Ue.id===lt)?.word||"",fontSize:Math.min(12,De/8),fontFamily:"Arial",fill:"#2c3e50",align:"center",verticalAlign:"middle",listening:!1})]},ht.id)}):[]},[k,Ae,g,a]),Be=S.useCallback(()=>{if(!k||!Ae)return[];const it=u();return it?(console.log(" Processing arrows:",Ae.arrows),Ae.arrows.map(ht=>{if(console.log(" Arrow data:",ht),!ht.start||!ht.end)return console.warn(" Arrow missing start/end coordinates:",ht),null;let Dt,Mt,Xe,De;if(ht.rel_start_x!==null&&ht.rel_start_y!==null&&ht.rel_end_x!==null&&ht.rel_end_y!==null&&ht.image_width&&ht.image_height&&ht.image_width>0&&ht.image_height>0){const Le=ht.image_width,lt=ht.image_height,Ue=k.width/Le,tt=k.height/lt;Dt=k.x+Number(ht.rel_start_x)/100*Le*Ue,Mt=k.y+Number(ht.rel_start_y)/100*lt*tt,Xe=k.x+Number(ht.rel_end_x)/100*Le*Ue,De=k.y+Number(ht.rel_end_y)/100*lt*tt}else{const Le=k.scale??k.scaleX??1,lt=Number(ht.start.x),Ue=Number(ht.start.y),tt=Number(ht.end.x),Et=Number(ht.end.y);lt<=k.width+1&&tt<=k.width+1&&Ue<=k.height+1&&Et<=k.height+1?(Dt=k.x+(isNaN(lt)?0:lt),Mt=k.y+(isNaN(Ue)?0:Ue),Xe=k.x+(isNaN(tt)?0:tt),De=k.y+(isNaN(Et)?0:Et)):(Dt=k.x+(isNaN(lt)?0:lt)*Le,Mt=k.y+(isNaN(Ue)?0:Ue)*Le,Xe=k.x+(isNaN(tt)?0:tt)*Le,De=k.y+(isNaN(Et)?0:Et)*Le)}return l.jsx(it.Arrow,{points:[Dt,Mt,Xe,De],stroke:ht.style?.color||"#dc3545",fill:ht.style?.color||"#dc3545",strokeWidth:ht.style?.thickness||3,pointerLength:10,pointerWidth:10},ht.id)}).filter(Boolean)):[]},[k,Ae,a]),Rt=S.useCallback(()=>{if(!Ae)return[];const it=u();return it?Ae.words.map(ht=>{const Dt=d[ht.id]||{x:0,y:0},Mt=typeof ht.word=="string"?ht.word:"",Xe=Math.max(60,Mt.length*8+20);return Object.values(g).includes(ht.id)?null:l.jsxs(it.Group,{x:Dt.x,y:Dt.y,draggable:!0,onDragEnd:Le=>et(Le,ht.id),children:[l.jsx(it.Rect,{width:Xe,height:34,fill:"#ffffff",stroke:"#ced4da",strokeWidth:1,cornerRadius:4,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5,shadowOffset:{x:0,y:2},shadowOpacity:.3,listening:!0}),l.jsx(it.KonvaText,{text:Mt,fontSize:14,fontFamily:"Arial",fill:"#343a40",padding:8,align:"center",verticalAlign:"middle",width:Xe,height:34,listening:!1})]},ht.id)}):[]},[Ae,d,g,k,a]),et=S.useCallback((it,ht)=>{const Dt=it.target.x(),Mt=it.target.y();if(h(At=>({...At,[ht]:{x:Dt,y:Mt}})),!k||!Ae)return;const Xe=Ae.words.find(At=>At.id===ht);if(!Xe)return;const De=typeof Xe.word=="string"?Xe.word:"",Le=Math.max(60,De.length*8+20),lt={x:Dt,y:Mt,width:Le,height:34},Ue=k.scale??k.scaleX??1,tt=(At,qt)=>!(qt.x>At.x+At.width||qt.x+qt.width<At.x||qt.y>At.y+At.height||qt.y+qt.height<At.y),Et=Ae.blocks.find(At=>{const qt=At.coordinates,pr={x:k.x+qt.x*Ue,y:k.y+qt.y*Ue,width:qt.width*Ue,height:qt.height*Ue};return tt(lt,pr)});if(Et){p(ur=>({...ur,[Et.id]:ht}));const At=Et.coordinates,qt=k.x+At.x*Ue,pr=k.y+At.y*Ue,Rr=At.width*Ue,Kr=At.height*Ue;h(ur=>({...ur,[ht]:{x:qt+(Rr-Le)/2,y:pr+(Kr-34)/2}})),H(`Word "${Xe.word}" placed in block`,"success")}},[k,Ae,H]),vt=S.useCallback(()=>{if(!Ae)return 0;const it=Ae.words.length,ht=Object.keys(g).length;return it>0?ht/it*100:0},[Ae,g]);S.useEffect(()=>{const it=vt();v(it)},[vt]),S.useEffect(()=>{if(e&&!I){const it=new Date;B(it),console.log(" Test timer started at:",it.toISOString()),W(),console.log(" Anti-cheating tracking started")}},[e,I,W]);const xt=S.useCallback(async()=>{if(Ae){C(!0);try{const it=Ae.words.length;let ht=0;console.log(" Scoring check - placedWords:",g),console.log(" Scoring check - blocks:",Ae.blocks.map(ir=>({id:ir.id,word:ir.word}))),console.log(" Scoring check - words:",Ae.words.map(ir=>({id:ir.id,word:ir.word}))),Ae.blocks.forEach(ir=>{const me=g[ir.id];if(console.log(` Block ${ir.id} (expects "${ir.word}") has placed word ID: ${me}`),me){const Ne=Ae.words.find(Pe=>Pe.id===me);console.log(" Placed word:",Ne),Ne&&Ne.word===ir.word?(ht++,console.log(` Correct! Block ${ir.id} has correct word "${Ne.word}"`)):console.log(` Incorrect! Block ${ir.id} expected "${ir.word}" but got "${Ne?.word||"nothing"}"`)}else console.log(` Block ${ir.id} has no word placed`)});const Dt=ht,Mt=it;console.log(` Final Score: ${Dt}/${Mt} (${Math.round(Dt/Mt*100)}%)`);const Xe=new Date,De=I?Math.round((Xe-I)/1e3):0,Le=I?I.toISOString():Xe.toISOString();console.log(" Test timing:",{startedAt:Le,endTime:Xe.toISOString(),timeTaken:`${De} seconds`});const lt=U();console.log(" Anti-cheating data for submission:",lt);const Ue=V.student_id,tt=`retest_assignment_id_${Ue}_matching_type_${e.id}`,Et=localStorage.getItem(tt),{academicCalendarService:At}=await Zi(async()=>{const{academicCalendarService:ir}=await Promise.resolve().then(()=>n2);return{academicCalendarService:ir}},void 0);await At.loadAcademicCalendar();const pr=At.getCurrentTerm()?.id;if(!pr)throw new Error("No current academic period found");const Rr={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:Ue,academic_period_id:pr,answers:g,score:Dt,maxScore:Mt,time_taken:De,started_at:Le,submitted_at:Xe.toISOString(),caught_cheating:lt.caught_cheating,visibility_change_times:lt.visibility_change_times,retest_assignment_id:Et?Number(Et):null,parent_test_id:e.id};console.log(" Submitting test data:",Rr);const ur=await(await M("/.netlify/functions/submit-matching-type-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Rr)})).json();if(console.log(" Submission response:",ur),ur.success){if(H("Test submitted successfully!","success"),R(),q(),V?.student_id&&Rm(V.student_id,"matching_type",e.id),V?.student_id){const me=`test_completed_${V.student_id}_matching_type_${e.id}`;localStorage.setItem(me,"true"),console.log(" Test marked as completed in localStorage:",me)}if(V?.student_id){const{setCachedData:me,CACHE_TTL:Ne}=await Zi(async()=>{const{setCachedData:Re,CACHE_TTL:Ct}=await Promise.resolve().then(()=>Vg);return{setCachedData:Re,CACHE_TTL:Ct}},void 0),Pe=`student_results_table_${V.student_id}`;me(Pe,ur,Ne.student_results_table),console.log(" Test results cached with key:",Pe)}const ir=`retest1_${Ue}_matching_type_${e.id}`;localStorage.removeItem(ir),localStorage.removeItem(tt),t&&t(Dt)}else throw new Error(ur.message||"Failed to submit test")}catch(it){console.error(" Error submitting test:",it),H(`Error submitting test: ${it.message}`,"error")}finally{C(!1)}}},[Ae,g,e,V,I,M,H,t]);return!e||!Ae?l.jsx(zr,{}):l.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:l.jsxs("div",{className:"max-w-6xl mx-auto",children:[l.jsx("div",{className:"flex justify-end mb-2",children:l.jsx(Ye,{onClick:ge,variant:"outline",size:"sm",children:"Back to Cabinet"})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e.test_name})}),l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Progress"}),l.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(x),"%"]})]})]}),l.jsx("div",{className:"mt-4 w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${x}%`}})})]}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:l.jsx("div",{className:"lg:col-span-3",children:l.jsxs(Nt,{className:"p-4",children:[l.jsx("div",{className:"mb-4 text-center",children:l.jsx(Ye,{onClick:Se,variant:"secondary",children:"Reset"})}),l.jsx("div",{ref:Q,className:"w-full bg-gray-100 rounded-lg overflow-hidden",style:{height:`${le}px`},children:k&&a?(()=>{const{Stage:it,Layer:ht,KonvaImage:Dt}=u();return l.jsxs(it,{ref:se,width:Q.current?.clientWidth||800,height:le,children:[l.jsxs(ht,{children:[l.jsx(Dt,{ref:X,image:k.image,x:k.x,y:k.y,width:k.width,height:k.height,listening:!1}),He(),Be()]}),l.jsx(ht,{listening:!0,children:Rt()})]})})():k?l.jsxs("div",{className:"flex items-center justify-center h-full",children:[l.jsx(zr,{size:"lg"}),l.jsx("span",{className:"ml-2 text-gray-600",children:"Loading Konva canvas..."})]}):null}),l.jsx("div",{className:"mt-4 text-center",children:l.jsx(Ye,{onClick:()=>L(!0),disabled:w||x<100,children:w?"Submitting...":"Submit Test"})})]})})}),l.jsx(oa,{isOpen:Y,onClose:()=>Z(!1),title:"Reset Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and placed words."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ye,{onClick:()=>Z(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ye,{onClick:re,variant:"primary",children:"Reset"})]})]})}),l.jsx(oa,{isOpen:ae,onClose:()=>ee(!1),title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet? Your progress will be saved but you will exit the test."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ye,{onClick:()=>ee(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ye,{onClick:Ee,variant:"primary",children:"Go Back"})]})]})}),l.jsx(oa,{isOpen:ne,onClose:()=>L(!1),title:"Submit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ye,{onClick:()=>L(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ye,{onClick:()=>{L(!1),xt()},variant:"primary",children:"Submit"})]})]})})]})})},Jse=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=cs(),{makeAuthenticatedRequest:o}=Qo(),{showNotification:c}=za(),[u,d]=S.useState([{leftWord:"",rightWord:""},{leftWord:"",rightWord:""},{leftWord:"",rightWord:""}]),[h,g]=S.useState("drag"),[p,x]=S.useState(!1),[v,w]=S.useState(null),C=S.useCallback(()=>{d(F=>[...F,{leftWord:"",rightWord:""}])},[]),k=S.useCallback(F=>{u.length>1&&d(A=>A.filter((j,I)=>I!==F))},[u.length]),b=S.useCallback((F,A)=>{d(j=>j.map((I,B)=>B===F?{...I,leftWord:A}:I))},[]),N=S.useCallback((F,A)=>{d(j=>j.map((I,B)=>B===F?{...I,rightWord:A}:I))},[]),E=S.useCallback(()=>u.every(F=>F.leftWord.trim()&&F.rightWord.trim()),[u]),P=S.useCallback(async()=>{if(!E()){c("Please fill in all word pairs","error");return}x(!0),w(null);try{const F=u.map((j,I)=>({question_id:I+1,left_word:j.leftWord.trim(),right_word:j.rightWord.trim()})),A={test_name:e,num_questions:F.length,interaction_type:h,questions:F};console.log(" Saving word matching test:",A),t({testName:e,numQuestions:F.length,interactionType:h,wordPairs:u,questions:F})}catch(F){console.error("Error saving word matching test:",F),w(F.message),c("Failed to save test: "+F.message,"error")}finally{x(!1)}},[e,u,h,E,o,c,t]);return l.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-6xl mx-auto p-0",children:[l.jsx(Nt,{className:"mb-6",children:l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Choose Interaction Type"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${h==="drag"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>g("drag"),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:h==="drag",onChange:()=>g("drag"),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Drag & Drop"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Students drag words from left list to right list"}),l.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" Easier for younger students",l.jsx("br",{})," Visual feedback on placement",l.jsx("br",{})," Mobile-friendly"]})]}),l.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${h==="arrow"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>g("arrow"),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:h==="arrow",onChange:()=>g("arrow"),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Draw Arrows"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Students draw arrows connecting matching words"}),l.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" More challenging",l.jsx("br",{})," Better for visual learners",l.jsx("br",{})," Requires precision"]})]})]})]})}),l.jsx(Nt,{className:"mb-6",children:l.jsxs("div",{className:"word-pairs-section",children:[l.jsxs("div",{className:"pairs-header flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Word Pairs"}),l.jsx(Ye,{onClick:C,size:"sm",children:"+ Add Pair"})]}),l.jsx("div",{className:"pairs-list space-y-3 p-0 md:p-4",children:u.map((F,A)=>l.jsxs("div",{className:"word-pair-row flex items-center space-x-2 md:space-x-4 p-2 md:p-4 bg-gray-50 rounded-lg border",children:[l.jsx("div",{className:"pair-number flex-shrink-0",children:l.jsx("span",{className:"number-badge w-6 h-6 md:w-8 md:h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs md:text-sm font-semibold",children:A+1})}),l.jsx("div",{className:"left-word flex-1",children:l.jsx("input",{type:"text",value:F.leftWord,onChange:j=>b(A,j.target.value),placeholder:"Left word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{className:"pair-arrow flex-shrink-0 text-gray-500 text-lg md:text-xl",children:""}),l.jsx("div",{className:"right-word flex-1",children:l.jsx("input",{type:"text",value:F.rightWord,onChange:j=>N(A,j.target.value),placeholder:"Right word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{className:"pair-actions flex-shrink-0",children:l.jsx(Ye,{onClick:()=>k(A),variant:"outline",size:"sm",className:"remove-btn w-6 h-6 md:w-8 md:h-8 p-0 text-red-500 hover:bg-red-50",disabled:u.length<=1,children:""})})]},A))})]})}),l.jsx(Nt,{className:"mb-6",children:l.jsxs("div",{className:"preview-section",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Preview"}),l.jsx("div",{className:"preview-pairs space-y-2",children:u.map((F,A)=>l.jsxs("div",{className:"preview-pair flex items-center space-x-2 text-sm",children:[l.jsxs("span",{className:"preview-number font-semibold text-blue-600",children:[A+1,"."]}),l.jsx("span",{className:"preview-left px-2 py-1 bg-white rounded border",children:F.leftWord||"Left word"}),l.jsx("span",{className:"preview-arrow text-gray-500",children:""}),l.jsx("span",{className:"preview-right px-2 py-1 bg-white rounded border",children:F.rightWord||"Right word"})]},A))})]})}),l.jsxs("div",{className:"flex justify-center space-x-4",children:[l.jsx(Ye,{onClick:P,disabled:!E()||p,className:"px-8",children:p?l.jsxs(l.Fragment,{children:[l.jsx(zr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test"}),l.jsx(Ye,{onClick:r,variant:"secondary",children:"Cancel"})]}),v&&l.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-600",children:v})})]})},Zse=(e,t)=>{const[r,n,s]=EB(`test_progress_${e}_${t}`,{}),[a,i]=S.useState(!1),[o,c]=S.useState(0),[u,d]=S.useState(0),[h,g]=S.useState(!1),[p,x]=S.useState(null),v=S.useRef(null),w=S.useRef(null),C=S.useCallback((M,V)=>{if(!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}n(W=>({...W,[M]:V})),console.log(`Saved progress for question ${M}:`,V)},[n]),k=S.useCallback(M=>!window.tokenManager||!window.tokenManager.isAuthenticated()?(console.warn("[WARN] Cannot get progress: No valid JWT token"),null):r[M]||null,[r]),b=S.useCallback(()=>{if(console.log(`[DEBUG] clearTestProgress called with testType: ${e}, testId: ${t}`),!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const M=`test_progress_${e}_${t}`;console.log(`[DEBUG] Removing localStorage key: ${M}`);const V=Object.keys(r).length>0;s(),console.log(V?`[DEBUG] Progress cleared for test ${e}_${t}`:`[DEBUG] No progress found to clear for test ${e}_${t}`)},[s,e,t,r]),N=S.useCallback(()=>{v.current&&(N(v.current),v.current=null),w.current&&(N(w.current),w.current=null)},[]),E=S.useCallback(()=>{console.log(`[DEBUG] setupProgressTrackingForPage called with testType: ${e}, testId: ${t}`),w.current=setInterval(()=>{console.log("[DEBUG] Auto-saving progress..."),I()},3e4),console.log("[DEBUG] Progress tracking interval set up (30 seconds)")},[e,t]),P=S.useCallback(()=>{console.log(`[DEBUG] updateProgressDisplayForPage called with testType: ${e}, testId: ${t}`);const M=j(),V=u>0?Math.round(M/u*100):0;return console.log(`[DEBUG] Progress: ${M}/${u} questions answered`),console.log(`[DEBUG] Progress bar updated: ${V}%`),{answeredQuestions:M,totalQuestions:u,percentage:V}},[e,t,u]),F=S.useCallback(()=>{console.log("[DEBUG] updateSubmitButtonStateForPage called");const M=j();console.log(`[DEBUG] Submit button state check: ${M}/${u} questions answered`);const V=M===u&&u>0;return console.log(V?"[DEBUG] Submit button enabled - all questions answered":"[DEBUG] Submit button disabled - not all questions answered"),V},[u]),A=S.useCallback(()=>{console.log(`[DEBUG] loadSavedProgressForPage called with testType: ${e}, testId: ${t}`);try{if(console.log("[DEBUG] Loaded progress from localStorage:",r),Object.keys(r).length===0){console.log("[DEBUG] No saved progress found");return}const M=Object.keys(r).length;c(M),console.log(`[DEBUG] Restored ${M} answered questions`)}catch(M){console.error("[ERROR] Failed to load saved progress:",M),x(M.message)}},[e,t,r]),j=S.useCallback(()=>{console.log(`[DEBUG] getAnsweredQuestionsCountForPage called with testType: ${e}`);const M=Object.keys(r).length;return c(M),console.log(`[DEBUG] Found ${M} answered questions`),M},[e,r]),I=S.useCallback(()=>{console.log(`[DEBUG] saveProgressForPage called with testType: ${e}, testId: ${t}`);try{console.log("[DEBUG] Progress saved:",r)}catch(M){console.error("[ERROR] Failed to save progress:",M),x(M.message)}},[e,t,r]),B=S.useCallback(()=>{try{const M=`test_completed_${e}_${t}`,V=localStorage.getItem(M)==="true";return i(V),V}catch(M){return console.error("Error checking test completion:",M),!1}},[e,t]),Y=S.useCallback(()=>{try{const M=`test_completed_${e}_${t}`;localStorage.setItem(M,"true"),i(!0),console.log(`Test ${e}_${t} marked as completed`)}catch(M){console.error("Error marking test completed:",M)}},[e,t]),Z=S.useCallback(()=>{console.log("Marking test completed in UI:",{testType:e,testId:t}),Y()},[e,t,Y]),ae=S.useCallback(M=>{try{const V=`test_creation_state_${e}_${t}`;localStorage.setItem(V,JSON.stringify(M)),console.log("Test creation state saved:",M)}catch(V){console.error("Error saving test creation state:",V)}},[e,t]),ee=S.useCallback(()=>{try{const M=`test_creation_state_${e}_${t}`;localStorage.removeItem(M),console.log("Test creation state cleared")}catch(M){console.error("Error clearing test creation state:",M)}},[e,t]),ne=S.useCallback((M,V)=>{try{const W=`test_step_${e}_${t}_${M}`;localStorage.setItem(W,JSON.stringify(V)),console.log(`Step ${M} data saved:`,V)}catch(W){console.error(`Error saving step ${M} data:`,W)}},[e,t]),L=S.useCallback(M=>{try{const V=`test_step_${e}_${t}_${M}`,W=localStorage.getItem(V);return W?JSON.parse(W):null}catch(V){return console.error(`Error restoring step ${M} data:`,V),null}},[e,t]),H=S.useCallback(()=>{try{const M=`test_creation_state_${e}_${t}`,V=localStorage.getItem(M);return V?JSON.parse(V):null}catch(M){return console.error("Error restoring test creation state:",M),null}},[e,t]);return S.useEffect(()=>()=>{N()},[e,t,E,A,N]),S.useEffect(()=>{j()},[r,j]),{progress:r,isCompleted:a,answeredCount:o,totalQuestions:u,isLoading:h,error:p,saveProgress:C,getProgress:k,clearProgress:b,clearInterval:N,setupProgressTracking:E,updateProgress:P,updateSubmitButton:F,loadProgress:A,getAnsweredCount:j,saveProgressForPage:I,checkCompleted:B,markCompleted:Y,markCompletedUI:Z,saveState:ae,clearState:ee,saveStepData:ne,restoreStepData:L,restoreState:H,setTotalQuestions:d,setError:x}},eae=({testData:e,onTestComplete:t,onBackToCabinet:r})=>{const{user:n}=cs(),{makeAuthenticatedRequest:s}=Qo(),[a,i]=S.useState({width:window.innerWidth,height:window.innerHeight});S.useEffect(()=>{const Xe=()=>{i({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",Xe),()=>window.removeEventListener("resize",Xe)},[]);const{getCheatingData:o,stopTracking:c,clearData:u}=Xm(),[d,h]=S.useState(null),[g,p]=S.useState({}),[x,v]=S.useState(null),w=S.useRef(null),[C,k]=S.useState(800),b={VERY_SMALL:400,MOBILE:600,TABLET:900},N={VERY_SMALL:.6,MOBILE:.8,TABLET:.9,DESKTOP:1},E={CANVAS_HEIGHT:400,BLOCK_WIDTH:140,BLOCK_HEIGHT:50,BLOCK_SPACING:80,MARGIN:50},P=a.width<b.VERY_SMALL,F=a.width>=b.VERY_SMALL&&a.width<b.MOBILE,A=a.width>=b.MOBILE&&a.width<b.TABLET;a.width>=b.TABLET;const j=P?N.VERY_SMALL:F?N.MOBILE:A?N.TABLET:N.DESKTOP;S.useEffect(()=>{const Xe=()=>{if(w.current){const Le=w.current.clientWidth;console.log(" Container width detected:",Le),Le>0&&k(Le)}};Xe();const De=[setTimeout(Xe,50),setTimeout(Xe,100),setTimeout(Xe,200),setTimeout(Xe,500)];return window.addEventListener("resize",Xe),()=>{De.forEach(Le=>clearTimeout(Le)),window.removeEventListener("resize",Xe)}},[d]);const I=E.BLOCK_WIDTH*j,B=E.BLOCK_HEIGHT*j,Y=E.BLOCK_SPACING*j,Z=E.MARGIN*j,ae=Z;console.log(" Mobile Debug:",{screenWidth:a.width,containerWidth:w.current?.clientWidth,canvasWidth:C,scale:j,blockWidth:I,margin:Z,leftBlockX:ae,displayDataLoaded:!!d});const ee=ae+I+20+I+Z,ne=ee<=C;let L,H=I,M=B;if(ne)L=Math.min(Math.max(ae+I+20,C-I-Z),C-I-Z);else{const Xe=C-Z*2,De=Math.floor((Xe-20)/2);H=Math.max(60,De),M=Math.max(30,M*(H/I)),L=ae+H+20,console.log(" Very small screen - adjusted block size:",{availableWidth:Xe,maxBlockWidth:De,actualBlockWidth:H,actualBlockHeight:M})}console.log(" Right Block Position:",{rightBlockX:L,rightBlockRightEdge:L+H,canvasWidth:C,fits:L+H<=C,canFitSideBySide:ne,minRequiredWidth:ee});const V=Z,W={DRAGGED_WORD:Math.max(8,14*j),ORIGINAL_WORD:Math.max(10,16*j),LEFT_WORD:Math.max(10,14*j)},R=Math.max(1,3*j),U=S.useCallback((Xe,De,Le)=>{if(!Xe)return M;const lt=De*.55,Ue=Math.floor(Le/lt),tt=Math.ceil(Xe.length/Ue),Et=De*1.1,At=12*j,qt=tt*Et+At,pr=Math.max(M*.8,30*j);return Math.max(pr,qt)},[M,j]),Q=S.useCallback(()=>{if(!d?.leftWords||!d?.rightWords)return E.CANVAS_HEIGHT*j;let Xe=Z*2;for(let Le=0;Le<d.leftWords.length;Le++){const lt=d.leftWords[Le],Ue=d.rightWords[Le],tt=U(lt,W.LEFT_WORD,H),Et=U(Ue,W.ORIGINAL_WORD,H),At=Math.max(tt,Et);Xe+=At,Le<d.leftWords.length-1&&(Xe+=20*j)}const De=E.CANVAS_HEIGHT*j;return Math.max(De,Xe)},[d,U,W,H,Z,j])();S.useCallback((Xe,De)=>{if(!Xe||!De)return Y;const Le=Xe.map((tt,Et)=>{const At=De[Et],qt=U(tt,W.LEFT_WORD,H),pr=U(At,W.ORIGINAL_WORD,H);return Math.max(qt,pr)}),lt=Math.max(...Le),Ue=20*j;return lt+Ue},[Y,U,W,H,j]);const X=S.useCallback(()=>{if(!d?.leftWords||!d?.rightWords)return[];const Xe=[];let De=Z;for(let Le=0;Le<d.leftWords.length;Le++){const lt=d.leftWords[Le],Ue=d.rightWords[Le],tt=U(lt,W.LEFT_WORD,H),Et=U(Ue,W.ORIGINAL_WORD,H),At=Math.max(tt,Et);Xe.push({y:De,leftHeight:tt,rightHeight:Et,rowHeight:At}),De+=At+20*j}return Xe},[d,U,W,H,Z,j])(),[ie,le]=S.useState([]),[ce,Se]=S.useState(!1),[re,ge]=S.useState(!1),[Ee,Ae]=S.useState(null),[He,Be]=S.useState(!1),[Rt,et]=S.useState(!1);S.useEffect(()=>{if(e){if(console.log(" WordMatchingStudent: Initializing test data:",e),console.log(" Interaction type:",e.interaction_type),console.log(" Left words:",e.leftWords),console.log(" Right words:",e.rightWords),console.log(" Correct pairs:",e.correctPairs),!Array.isArray(e.leftWords)||!Array.isArray(e.rightWords)){console.error(" Invalid data structure - leftWords or rightWords not arrays:",{leftWords:e.leftWords,rightWords:e.rightWords});return}if(h(e),Ae(new Date),n?.student_id){const Xe=`test_progress_${n.student_id}_word_matching_${e.id}`,De=Rs(Xe);De&&(p(De.answers||{}),le(De.arrows||[]),Ae(new Date(De.startTime)),console.log(" Test progress restored:",De))}}},[e,n?.student_id]),S.useEffect(()=>{if(d&&Ee&&n?.student_id){const Xe=setInterval(()=>{const De={answers:g,arrows:ie,startTime:Ee.toISOString()},Le=`test_progress_${n.student_id}_word_matching_${e.id}`;vs(Le,De,Is.test_progress),console.log(" Progress auto-saved")},3e4);return()=>clearInterval(Xe)}},[d,g,ie,Ee,n?.student_id,e?.id]);const vt=S.useCallback((Xe,De)=>{if(console.log(" handleWordClick called:",{side:Xe,index:De,interactionType:e?.interaction_type,selectedWord:x}),e?.interaction_type!=="arrow"){console.log(" Not arrow mode, ignoring click");return}if(x){if(x.side===Xe&&x.index===De)console.log(" Deselecting word"),v(null);else if(x.side!==Xe){console.log(" Creating arrow connection:",{startWord:x,endWord:{side:Xe,index:De}});const Le={id:Date.now().toString(),startWord:x,endWord:{side:Xe,index:De},color:"#3B82F6"};le(lt=>{const Ue=[...lt,Le];return console.log(" Updated arrows:",Ue),Ue}),p(lt=>{const Ue={...lt,[x.index]:De};return console.log(" Updated answers:",Ue),Ue}),v(null)}}else console.log(" Selecting word:",{side:Xe,index:De}),v({side:Xe,index:De})},[x,e?.interaction_type]);S.useCallback((Xe,De)=>{e.interaction_type==="drag"&&p(Le=>({...Le,[Xe]:De}))},[e?.interaction_type]);const xt=S.useCallback(()=>{Be(!0)},[]),it=S.useCallback(()=>{p({}),le([]),v(null),Be(!1)},[]),ht=S.useCallback(()=>{et(!0)},[]),Dt=S.useCallback(()=>{et(!1),r&&r()},[r]),Mt=S.useCallback(async()=>{if(d){Se(!0);try{const Xe=d?.leftWords?.length||0;let De=0,Le={};e.interaction_type==="drag"?Object.entries(g).forEach(([Ct,Fe])=>{const st=d?.correctPairs?.[Ct];Fe===st&&De++,Le[Ct]=Fe}):ie.forEach(Ct=>{const Fe=Ct.startWord.side==="left"?Ct.startWord.index:Ct.endWord.index,st=Ct.startWord.side==="right"?Ct.startWord.index:Ct.endWord.index;d?.correctPairs?.[Fe]===st&&De++,Le[Fe]=st});const lt=De,Ue=Xe;console.log(` Final Score: ${lt}/${Ue} (${Math.round(lt/Ue*100)}%)`);const tt=new Date,Et=Ee?Math.round((tt-Ee)/1e3):0,At=Ee?Ee.toISOString():tt.toISOString(),qt=o(),pr=n.student_id,Rr=`retest_assignment_id_${pr}_word_matching_${e.id}`,Kr=localStorage.getItem(Rr),{academicCalendarService:ur}=await Zi(async()=>{const{academicCalendarService:Ct}=await Promise.resolve().then(()=>n2);return{academicCalendarService:Ct}},void 0);await ur.loadAcademicCalendar();const me=ur.getCurrentTerm()?.id;if(!me)throw new Error("No current academic period found");const Ne={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:pr,academic_period_id:me,parent_test_id:e.id,retest_assignment_id:Kr?Number(Kr):null,interaction_type:e.interaction_type,answers:Le,score:lt,maxScore:Ue,time_taken:Et,started_at:At,submitted_at:tt.toISOString(),caught_cheating:qt.caught_cheating,visibility_change_times:qt.visibility_change_times};console.log(" Submission data being sent:",Ne),console.log(" TestData structure:",e),console.log(" Submitting test results...");const Pe=await s("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ne)});console.log(" Submission response received:",Pe.status);const Re=await Pe.json();if(Re.success){if(c(),u(),n?.student_id){const Ct=`test_completed_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(Ct,"true"),console.log(" Test marked as completed in localStorage:",Ct);const Fe=`retest1_${pr}_word_matching_${e.id}`;localStorage.removeItem(Fe),localStorage.removeItem(Rr),Rm(n.student_id,"word_matching",e.id),console.log(" Test data cleared from cache");const st=`student_results_table_${n.student_id}`;vs(st,Re,Is.student_results_table),console.log(" Test results cached with key:",st)}t&&t(lt),Se(!1)}else throw new Error(Re.message||"Failed to submit test")}catch(Xe){console.error("Error submitting test:",Xe),Se(!1)}}},[d,g,ie,e,n,Ee,o,c,u,s,t]);return d?l.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-4xl mx-auto p-6",children:[l.jsx(oa,{isOpen:ce,onClose:()=>{},title:"Submitting",size:"small",children:l.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[l.jsx(zr,{size:"lg",className:"mb-3"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Submitting test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your results"})]})}),l.jsx("div",{className:"flex justify-end mb-2",children:l.jsx(Ye,{onClick:ht,variant:"outline",size:"sm",disabled:ce,children:"Back to Cabinet"})}),l.jsx(Nt,{className:"mb-6",children:l.jsxs("div",{className:"text-left",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:e.test_name}),l.jsx("p",{className:"text-gray-600",children:e.interaction_type==="drag"?"Drag words from left to right to match them":"Click on the word or phrase on the left, then click on the matching word or phrase on the right to connect them"})]})}),e.interaction_type==="drag"?l.jsx(Nt,{className:"mb-6",children:l.jsx("div",{ref:w,className:"relative w-full",children:l.jsx(e0,{width:C,height:Q,className:`border-2 border-gray-200 rounded-lg ${ce?"pointer-events-none opacity-50":""}`,children:l.jsxs(Zh,{children:[d.leftWords.map((Xe,De)=>{const Le=g[De]!==void 0,lt=U(Xe,W.LEFT_WORD,H),Ue=X[De],tt=Ue?Ue.y:V+De*Y;return l.jsxs(sc,{x:ae,y:tt,draggable:!Le,onDragStart:Et=>{Et.target.moveToTop()},onDragEnd:Et=>{Et.target.getStage();const At=d.rightWords,qt=H+60,pr=M+30,Rr=L-30,Kr=V-15;console.log(" Drop detection - Word dropped at:",Et.target.x(),Et.target.y());for(let ur=0;ur<At.length;ur++){const ir=X[ur],me=ir?ir.y:Kr+ur*Y,Ne=Rr,Pe=Rr+qt,Re=me,Ct=me+pr;if(console.log(` Checking drop zone ${ur}:`,{left:Ne,right:Pe,top:Re,bottom:Ct,word:At[ur]}),Et.target.x()>=Ne&&Et.target.x()<=Pe&&Et.target.y()>=Re&&Et.target.y()<=Ct){console.log(` Match found! Word "${d.leftWords[De]}" matched with "${At[ur]}"`),p(Fe=>({...Fe,[De]:ur}));break}}console.log(" No match found, resetting position"),Et.target.position({x:ae,y:tt})},children:[l.jsx(Ba,{width:H,height:lt,fill:Le?"#e5e7eb":"#3b82f6",stroke:Le?"#9ca3af":"#1d4ed8",strokeWidth:2,cornerRadius:8,opacity:Le?.5:1}),l.jsx(zc,{text:Xe,x:H/2,y:lt/2,fontSize:W.LEFT_WORD,fontFamily:"Arial",fill:Le?"#dc2626":"white",align:"center",verticalAlign:"middle",width:H,offsetX:H/2,offsetY:lt/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${De}`)}),d.rightWords.map((Xe,De)=>{const Le=U(Xe,W.ORIGINAL_WORD,H),lt=X[De],Ue=lt?lt.y:V+De*Y,tt=Object.keys(g).find(Et=>g[Et]===De);return l.jsxs(sc,{x:L,y:Ue,children:[l.jsx(Ba,{width:H,height:Le,fill:tt?"#10b981":"#f3f4f6",stroke:tt?"#059669":"#d1d5db",strokeWidth:2,cornerRadius:8}),l.jsx(zc,{text:Xe,x:H/2,y:Le/2,fontSize:W.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:H,offsetX:H/2,offsetY:Le/2,wrap:"word",ellipsis:!0,listening:!1}),tt&&l.jsx(zc,{text:d.leftWords[tt],x:H/2,y:Le/4,fontSize:W.DRAGGED_WORD,fontFamily:"Arial",fill:"#dc2626",align:"center",verticalAlign:"middle",width:H,offsetX:H/2,offsetY:Le/8,wrap:"word",ellipsis:!0})]},`right-${De}`)})]})})})}):l.jsx(Nt,{className:"mb-6",children:l.jsx("div",{ref:w,className:"relative w-full",children:l.jsx(e0,{width:C,height:Q,className:`border-2 border-gray-200 rounded-lg ${ce?"pointer-events-none opacity-50":""}`,children:l.jsxs(Zh,{children:[d?.leftWords?.map((Xe,De)=>{const Le=U(Xe,W.LEFT_WORD,H),lt=X[De],Ue=lt?lt.y:V+De*Y,tt=x?.side==="left"&&x?.index===De;return l.jsxs(sc,{x:ae,y:Ue,onClick:()=>vt("left",De),children:[l.jsx(Ba,{width:H,height:Le,fill:tt?"#3b82f6":"#f3f4f6",stroke:tt?"#1d4ed8":"#d1d5db",strokeWidth:tt?3:2,cornerRadius:8}),l.jsx(zc,{text:Xe,x:H/2,y:Le/2,fontSize:W.LEFT_WORD,fontFamily:"Arial",fill:tt?"white":"#374151",align:"center",verticalAlign:"middle",width:H,offsetX:H/2,offsetY:Le/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${De}`)}),d?.rightWords?.map((Xe,De)=>{const Le=U(Xe,W.ORIGINAL_WORD,H),lt=X[De],Ue=lt?lt.y:V+De*Y,tt=x?.side==="right"&&x?.index===De;return l.jsxs(sc,{x:L,y:Ue,onClick:()=>vt("right",De),children:[l.jsx(Ba,{width:H,height:Le,fill:tt?"#3b82f6":"#f3f4f6",stroke:tt?"#1d4ed8":"#d1d5db",strokeWidth:tt?3:2,cornerRadius:8}),l.jsx(zc,{text:Xe,x:H/2,y:Le/2,fontSize:W.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:H,offsetX:H/2,offsetY:Le/2,wrap:"word",ellipsis:!0,listening:!1})]},`right-${De}`)}),ie.map((Xe,De)=>{const Le=d?.leftWords?.[Xe.startWord.index],lt=d?.rightWords?.[Xe.endWord.index],Ue=U(Le,W.LEFT_WORD,H),tt=U(lt,W.ORIGINAL_WORD,H),Et=X[Xe.startWord.index],At=X[Xe.endWord.index],qt=Et?Et.y+Ue/2:V+Xe.startWord.index*Y+Ue/2,pr=At?At.y+tt/2:V+Xe.endWord.index*Y+tt/2;return l.jsx(ai,{points:[ae+H+20,qt,L-20,pr],stroke:Xe.color||"#3b82f6",strokeWidth:R,lineCap:"round",lineJoin:"round"},De)})]})})})}),l.jsx(Nt,{children:l.jsxs("div",{className:`submit-section flex justify-center space-x-4 ${ce?"pointer-events-none opacity-50":""}`,children:[l.jsx(Ye,{onClick:xt,variant:"outline",disabled:ce,children:"Reset"}),l.jsx(Ye,{onClick:()=>ge(!0),disabled:ce,className:"px-8",children:ce?l.jsxs(l.Fragment,{children:[l.jsx(zr,{size:"sm",color:"white",className:"mr-2"}),"Submitting..."]}):"Submit Test"})]})}),l.jsx(oa,{isOpen:He&&!ce,onClose:()=>Be(!1),title:"Reset Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and answers."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ye,{onClick:()=>Be(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ye,{onClick:it,variant:"primary",children:"Reset"})]})]})}),l.jsx(oa,{isOpen:Rt,onClose:()=>et(!1),title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to leave the test? Your progress will be saved."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ye,{onClick:()=>et(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ye,{onClick:Dt,variant:"primary",children:"Leave"})]})]})}),l.jsx(oa,{isOpen:re,onClose:()=>ge(!1),title:"Submit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ye,{onClick:()=>ge(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ye,{onClick:()=>{ge(!1),Mt()},variant:"primary",children:"Submit"})]})]})})]}):l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(zr,{size:"lg"})})},tae=({id:e,x:t,y:r,width:n,height:s,text:a,fontSize:i,color:o,isSelected:c,onSelect:u,onUpdate:d,onDelete:h})=>{const[g,p]=S.useState(!1),x=S.useRef(!1),v=S.useRef(null),w=S.useRef({x:0,y:0}),C=S.useRef(null),k=5,b=()=>{x.current=!0,p(!0)},N=()=>{if(x.current=!1,p(!1),C.current)try{C.current.draggable(!1)}catch{}},E=()=>{v.current&&(clearTimeout(v.current),v.current=null)};S.useEffect(()=>()=>{E()},[]),S.useEffect(()=>{if(C.current)try{C.current.draggable(x.current)}catch{}},[g]);const P=A=>{A.cancelBubble=!0,d(e,{isEditing:!0})},F=A=>{d(e,{x:A.target.x(),y:A.target.y()})};return l.jsxs(sc,{ref:C,x:t,y:r,draggable:g,dragBoundFunc:A=>x.current?A:{x:t,y:r},name:"textbox-group",onClick:A=>{A.cancelBubble=!0,u(e)},onTap:A=>{A.cancelBubble=!0,u(e),E()},onDblClick:P,onDblTap:P,onPointerDown:A=>{A.cancelBubble=!0;const j=A.evt||{};w.current={x:j.clientX??0,y:j.clientY??0},E(),v.current=setTimeout(()=>{b()},400)},onPointerMove:A=>{if(!v.current)return;const j=A.evt||{},I=Math.abs((j.clientX??0)-w.current.x),B=Math.abs((j.clientY??0)-w.current.y);(I>k||B>k)&&E()},onPointerUp:A=>{A.cancelBubble=!0,E(),N()},onPointerLeave:()=>{E(),N()},onDragEnd:A=>{F(A),N()},children:[l.jsx(Ba,{width:n,height:s,fill:c?"#fef3c7":"#ffffff",stroke:c?"#f59e0b":"#d1d5db",strokeWidth:c?2:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1},name:"textbox-rect",onTap:A=>{A.cancelBubble=!0,u(e),E()},onDblTap:A=>{A.cancelBubble=!0,P(A)}}),l.jsx(zc,{text:a,width:n,height:s,padding:8,align:"left",verticalAlign:"top",fontSize:i,fill:o,wrap:"word",name:"textbox-text",onTap:A=>{A.cancelBubble=!0,u(e),E()},onDblTap:A=>{A.cancelBubble=!0,P(A)}})]})},rae=({x:e,y:t,width:r,height:n,initialText:s,onSave:a,onCancel:i})=>{const o=S.useRef(null);S.useEffect(()=>{o.current&&(o.current.focus(),o.current.select())},[]);const c=u=>{u.key==="Enter"&&!u.shiftKey?(u.preventDefault(),a(o.current.value)):u.key==="Escape"&&i()};return l.jsx("textarea",{ref:o,defaultValue:s,style:{position:"absolute",top:t,left:e,width:r,height:n,fontSize:"14px",border:"2px solid #f59e0b",borderRadius:"6px",padding:"8px",background:"white",resize:"none",outline:"none",fontFamily:"inherit",lineHeight:"1.4",zIndex:1e3},onKeyDown:c,onBlur:()=>a(o.current.value)})},nae=({width:e,height:t,lines:r,onDrawingChange:n,currentTool:s,currentColor:a,currentThickness:i,zoom:o,onZoomChange:c,isPanning:u,isFullscreen:d,constrainPanPosition:h,handleWheel:g,stageRef:p,setIsPanning:x,responsiveDimensions:v,canvasSize:w,question:C,textBoxes:k,setTextBoxes:b,selectedTextBox:N,setSelectedTextBox:E,handleTextBoxSelect:P,handleTextBoxUpdate:F,handleTextBoxDelete:A,isEditingText:j,editingTextBox:I,setIsEditingText:B,setEditingTextBox:Y,setCurrentTool:Z})=>{const[ae,ee]=S.useState(!1),[ne,L]=S.useState([]),[H,M]=S.useState(null),[V,W]=S.useState(null),R=S.useRef(null),[U,q]=S.useState(.25),[Q,se]=S.useState({x:0,y:0}),X=S.useRef(null),ie=S.useRef(null),le=S.useRef(!1),ce=6;S.useEffect(()=>{const ke=()=>{const We=R.current;if(!We)return;const Qe=We.clientWidth||1,Pt=We.clientHeight||1,zt=Math.min(Qe/(w.width||1),Pt/(w.height||1));q(Math.min(zt,1))};return ke(),window.addEventListener("resize",ke),()=>window.removeEventListener("resize",ke)},[w.width,w.height,d]);const Se=ke=>{const We=p.current,Qe=We.getPointerPosition();if(s==="pan"){if(Re(ke.target))try{We.draggable(!1),le.current=!0}catch{}return}if(s==="text"){const zt={x:(Qe.x-We.x())/We.scaleX(),y:(Qe.y-We.y())/We.scaleY()};X.current={...zt},ie.current={x:Qe.x,y:Qe.y};return}ee(!0);const Pt={x:(Qe.x-We.x())/We.scaleX(),y:(Qe.y-We.y())/We.scaleY()};W(Pt),s==="pencil"?L([{x:Pt.x,y:Pt.y,color:a,thickness:i}]):s==="eraser"?L([{x:Pt.x,y:Pt.y,color:a,thickness:i,tool:"eraser"}]):["line","rectangle","circle"].includes(s)&&M({type:s,startX:Pt.x,startY:Pt.y,endX:Pt.x,endY:Pt.y,color:a,thickness:i})},re=ke=>{const We=p.current,Qe=We.getPointerPosition(),Pt={x:(Qe.x-We.x())/We.scaleX(),y:(Qe.y-We.y())/We.scaleY()};if(se(Pt),s!=="pan"){if(s==="text"&&X.current&&ie.current){const zt=Math.abs(Qe.x-ie.current.x),rr=Math.abs(Qe.y-ie.current.y);(zt>ce||rr>ce)&&(X.current=null)}if(ae)if(s==="pencil"){const zt=[...ne,{x:Pt.x,y:Pt.y,color:a,thickness:i}];L(zt)}else if(s==="eraser"){const zt=[...ne,{x:Pt.x,y:Pt.y,color:a,thickness:i,tool:"eraser"}];L(zt)}else["line","rectangle","circle"].includes(s)&&H&&M({...H,endX:Pt.x,endY:Pt.y})}},ge=ke=>{const We=p.current;if(s==="pan"){if(le.current){try{We.draggable(!0)}catch{}le.current=!1}return}if(s==="text"&&X.current){const Qe=ke&&ke.target;if(Qe&&typeof Qe.name=="function"&&Qe.name()==="canvas-bg"){const zt={id:Date.now(),x:X.current.x,y:X.current.y,width:150,height:60,text:"Double-click to edit",fontSize:14,color:"#000000"};b(rr=>[...rr,zt]),E(zt.id)}X.current=null,ie.current=null}if(ae){if(s==="pencil"){const Qe=[...r,ne];n(Qe),L([])}else if(s==="eraser"){const Qe=[...r,ne];n(Qe),L([])}else if(["line","rectangle","circle"].includes(s)&&H){const Qe=[...r,H];n(Qe),M(null)}ee(!1),W(null)}},[Ee,Ae]=S.useState(null),[He,Be]=S.useState(null),[Rt,et]=S.useState(!1),[vt,xt]=S.useState(null),[it,ht]=S.useState(!1),[Dt,Mt]=S.useState(!1),[Xe,De]=S.useState([]),[Le,lt]=S.useState(null),[Ue,tt]=S.useState({totalGestures:0,zoomGestures:0,panGestures:0,combinedGestures:0,averageResponseTime:0});let Et=null;const qt=(window.devicePixelRatio||1)>1.5,pr={scaleDelta:qt?.03:.04,centerDelta:qt?4:6,minTouchDistance:8,gestureHysteresis:.02},Rr=()=>{ht(!1),xt(null),Ae(null),Be(null),ee(!1),W(null),Mt(!1),lt(null),Et&&(cancelAnimationFrame(Et),Et=null),p.current&&p.current.stop()},Kr=ke=>{if(ke.length<2)return 0;const We=ke[0],Qe=ke[1];return Math.sqrt(Math.pow(Qe.clientX-We.clientX,2)+Math.pow(Qe.clientY-We.clientY,2))},ur=ke=>{if(ke.length<2)return null;const We=ke[0],Qe=ke[1];return{x:(We.clientX+Qe.clientX)/2,y:(We.clientY+Qe.clientY)/2}},ir=ke=>{De(We=>[...We,{type:ke,timestamp:Date.now()}].slice(-5))},me=()=>{const ke=Date.now(),We=Xe.filter(zt=>ke-zt.timestamp<500);if(We.length<2)return 0;const Qe=We[We.length-1],Pt=We[We.length-2];return Qe.type===Pt.type?pr.gestureHysteresis:0},Ne=(ke,We)=>{tt(Qe=>({totalGestures:Qe.totalGestures+1,zoomGestures:ke.includes("zoom")?Qe.zoomGestures+1:Qe.zoomGestures,panGestures:ke.includes("pan")?Qe.panGestures+1:Qe.panGestures,combinedGestures:ke==="zoom+pan"?Qe.combinedGestures+1:Qe.combinedGestures,averageResponseTime:(Qe.averageResponseTime+We)/2}))},Pe=(ke,We,Qe,Pt)=>{const zt=p.current,rr=zt.scaleX(),xr=zt.position();let cr=rr,qr=xr;if(ke){const ye=Qe/Ee,xe=rr*ye,be=C?.max_canvas_width||1536,_e=C?.max_canvas_height||2048,Ge=be/w.width,ut=_e/w.height,qe=Math.min(Ge,ut,1);cr=Math.max(.25,Math.min(qe,xe));const oe=Pt,he={x:(oe.x-zt.x())/rr,y:(oe.y-zt.y())/rr};qr={x:oe.x-he.x*cr,y:oe.y-he.y*cr}}if(We){const ye=Pt.x-He.x,xe=Pt.y-He.y;ke?qr={x:qr.x+ye,y:qr.y+xe}:qr={x:xr.x+ye,y:xr.y+xe}}Et||(Et=requestAnimationFrame(()=>{zt.scale({x:cr,y:cr}),zt.position(qr),zt.batchDraw(),Et=null})),ke&&We?(xt("zoom+pan"),Mt(!0)):ke?(xt("zoom"),Mt(!0)):We&&xt("pan");const we=Date.now()-(Le||Date.now());Ne(ke&&We?"zoom+pan":ke?"zoom":"pan",we),console.log(" Combined gesture",{doZoom:ke,doPan:We,scale:cr.toFixed(2),pos:qr})},Re=ke=>{if(!ke||typeof ke.name!="function")return!1;if((ke.name()||"").includes("textbox-"))return!0;const Qe=ke.getParent&&ke.getParent();return Qe&&typeof Qe.name=="function"&&(Qe.name()||"").includes("textbox-")},Ct=ke=>{const We=ke.evt.touches,Qe=ke.target;if(Re(Qe)){if(s==="pan"&&p.current)try{p.current.draggable(!1),le.current=!0}catch{}return}We.length===2?(ke.evt.preventDefault(),ht(!0),xt(null),Ae(Kr(We)),Be(ur(We)),ee(!1),lt(Date.now())):We.length===1&&(ht(!1),xt(null),Se(ke))},Fe=ke=>{const We=ke.evt.touches,Qe=ke.target;if(!Re(Qe))if(We.length===2&&it){ke.evt.preventDefault();const Pt=p.current,zt=Kr(We),rr=ur(We);if(Ee&&He&&Pt&&zt>pr.minTouchDistance){const xr=Math.abs(zt/Ee-1),cr=Math.sqrt(Math.pow(rr.x-He.x,2)+Math.pow(rr.y-He.y,2)),qr=me(),ue=pr.scaleDelta-qr,we=pr.centerDelta-qr*10,ye=xr>ue,xe=cr>we;(ye||xe)&&(Pe(ye,xe,zt,rr),ye&&xe?ir("zoom+pan"):ye?ir("zoom"):xe&&ir("pan")),console.log(" Gesture Debug",{scaleDelta:xr.toFixed(3),centerDelta:cr.toFixed(1),doZoom:ye,doPan:xe,hysteresis:qr.toFixed(3),adjustedScaleDelta:ue.toFixed(3),adjustedCenterDelta:we.toFixed(1),gestureHistory:Xe.slice(-3)})}Ae(zt),Be(rr)}else We.length===1&&!it&&(ke.evt.preventDefault(),re())},st=ke=>{const We=ke.evt.touches,Qe=ke.target;Re(Qe)||(We.length===0?(ge(ke),Rr(),Mt(!1)):We.length===1&&(ht(!1),xt(null),Ae(null),Be(null),Mt(!1)))};return l.jsx("div",{className:"relative w-full block sm:flex sm:justify-center",children:l.jsx("div",{className:"w-full max-w-full block sm:flex sm:justify-center",children:l.jsxs("div",{className:"relative",style:{border:d&&(v.width<window.innerWidth-40||v.height<window.innerHeight-40)?"2px solid #000000":"none",borderRadius:"8px",overflow:"hidden"},children:[l.jsx("div",{ref:R,className:"w-full h-full",style:{touchAction:"manipulation"},children:l.jsx(e0,{ref:p,width:v.width,height:v.height,scaleX:d?v.zoom:o,scaleY:d?v.zoom:o,onMouseDown:Se,onMousemove:re,onMouseup:ge,onTouchStart:Ct,onTouchMove:Fe,onTouchEnd:st,onWheel:g||(()=>{}),onDragStart:()=>{console.log(" Drag started"),s==="pan"&&x(!0)},onDragEnd:()=>{if(console.log(" Drag ended"),s==="pan"&&(x(!1),h)){const ke=p.current,We=R.current,Qe=We?.clientWidth||v.width,Pt=We?.clientHeight||v.height,zt=w.width*ke.scaleX(),rr=w.height*ke.scaleY(),xr=ke.x(),cr=ke.y();(xr>Qe||xr<-zt||cr>Pt||cr<-rr)&&h(ke)}},draggable:s==="pan"&&o>.25,className:`border-0 rounded-none shadow-none sm:border sm:rounded-lg sm:shadow-sm ${s==="pan"?"cursor-grab":u?"cursor-grabbing":"cursor-crosshair"}`,style:{width:"100%",height:"auto"},onLoad:()=>{console.log(" DrawingTestStudent - Stage loaded with dimensions:",v.width,"x",v.height),console.log(" DrawingTestStudent - Canvas size:",w.width,"x",w.height),console.log(" DrawingTestStudent - Current zoom level:",o),console.log(" DrawingTestStudent - Effective display size:",Math.round(w.width*o),"x",Math.round(w.height*o)),console.log(" DrawingTestStudent - Total pixels displayed:",Math.round(w.width*o*w.height*o))},children:l.jsxs(Zh,{children:[l.jsx(Ba,{x:0,y:0,width:w.width,height:w.height,fill:"white",name:"canvas-bg"}),r.map((ke,We)=>{if(Array.isArray(ke)){const Qe=ke[0]?.tool==="eraser";return l.jsx(ai,{points:ke.flatMap(Pt=>[Pt.x,Pt.y]),stroke:Qe?"black":ke[0]?.color||"#000000",strokeWidth:Qe?(ke[0]?.thickness||2)*7:ke[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:Qe?"destination-out":"source-over"},We)}else{if(ke.type==="line")return l.jsx(ai,{points:[ke.startX,ke.startY,ke.endX,ke.endY],stroke:ke.color,strokeWidth:ke.thickness,lineCap:"round"},We);if(ke.type==="rectangle"){const Qe=Math.abs(ke.endX-ke.startX),Pt=Math.abs(ke.endY-ke.startY),zt=Math.min(ke.startX,ke.endX),rr=Math.min(ke.startY,ke.endY);return l.jsx(Ba,{x:zt,y:rr,width:Qe,height:Pt,stroke:ke.color,strokeWidth:ke.thickness,fill:"transparent"},We)}else if(ke.type==="circle"){const Qe=Math.sqrt(Math.pow(ke.endX-ke.startX,2)+Math.pow(ke.endY-ke.startY,2))/2,Pt=(ke.startX+ke.endX)/2,zt=(ke.startY+ke.endY)/2;return l.jsx(pf,{x:Pt,y:zt,radius:Qe,stroke:ke.color,strokeWidth:ke.thickness,fill:"transparent"},We)}}return null}),k.map(ke=>l.jsx(tae,{...ke,isSelected:N===ke.id,onSelect:P,onUpdate:F,onDelete:A},ke.id)),s==="pencil"&&l.jsx(ai,{points:ne.flatMap(ke=>[ke.x,ke.y]),stroke:a,strokeWidth:i,tension:.5,lineCap:"round",lineJoin:"round"}),s==="eraser"&&l.jsx(ai,{points:ne.flatMap(ke=>[ke.x,ke.y]),stroke:"black",strokeWidth:i*7,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:"destination-out"}),H&&H.type==="line"&&l.jsx(ai,{points:[H.startX,H.startY,H.endX,H.endY],stroke:H.color,strokeWidth:H.thickness,lineCap:"round"}),H&&H.type==="rectangle"&&l.jsx(Ba,{x:Math.min(H.startX,H.endX),y:Math.min(H.startY,H.endY),width:Math.abs(H.endX-H.startX),height:Math.abs(H.endY-H.startY),stroke:H.color,strokeWidth:H.thickness,fill:"transparent"}),H&&H.type==="circle"&&l.jsx(pf,{x:(H.startX+H.endX)/2,y:(H.startY+H.endY)/2,radius:Math.sqrt(Math.pow(H.endX-H.startX,2)+Math.pow(H.endY-H.startY,2))/2,stroke:H.color,strokeWidth:H.thickness,fill:"transparent"}),s==="eraser"&&l.jsx(pf,{x:Q.x,y:Q.y,radius:i*7/2,stroke:"#666666",strokeWidth:2,fill:"rgba(102, 102, 102, 0.2)",dash:[5,5],listening:!1}),s==="pencil"&&l.jsx(ai,{points:[Q.x-10,Q.y,Q.x+10,Q.y,Q.x,Q.y-10,Q.x,Q.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="line"&&l.jsx(ai,{points:[Q.x-10,Q.y,Q.x+10,Q.y,Q.x,Q.y-10,Q.x,Q.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="rectangle"&&l.jsx(ai,{points:[Q.x-10,Q.y,Q.x+10,Q.y,Q.x,Q.y-10,Q.x,Q.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="circle"&&l.jsx(ai,{points:[Q.x-10,Q.y,Q.x+10,Q.y,Q.x,Q.y-10,Q.x,Q.y+10],stroke:"#666666",strokeWidth:1,listening:!1})]})})}),j&&I&&l.jsx(rae,{x:I.x,y:I.y,width:I.width,height:I.height,initialText:I.text,onSave:ke=>{F(I.id,{text:ke}),B(!1),Y(null)},onCancel:()=>{B(!1),Y(null)}}),l.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1",children:[l.jsx("button",{onClick:()=>{const ke=p.current,We=ke.scaleX(),Qe=C?.max_canvas_width||1536,Pt=C?.max_canvas_height||2048,zt=Qe/w.width,rr=Pt/w.height,xr=Math.min(zt,rr,5),cr=Math.min(xr,ke.scaleX()*1.2);ke.scale({x:cr,y:cr}),ke.batchDraw(),console.log(" DrawingTestStudent - Zoom In button:",We.toFixed(2),"->",cr.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(w.width*cr),"x",Math.round(w.height*cr)),console.log(" DrawingTestStudent - New resolution:",Math.round(w.width*cr*w.height*cr),"pixels"),c(cr)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom In",children:"+"}),l.jsx("button",{onClick:()=>{const ke=p.current,We=ke.scaleX(),Qe=Math.max(.25,ke.scaleX()*.8);ke.scale({x:Qe,y:Qe}),ke.batchDraw(),console.log(" DrawingTestStudent - Zoom Out button:",We.toFixed(2),"->",Qe.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(w.width*Qe),"x",Math.round(w.height*Qe)),console.log(" DrawingTestStudent - New resolution:",Math.round(w.width*Qe*w.height*Qe),"pixels"),c(Qe)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom Out",children:""}),l.jsx("button",{onClick:()=>{const ke=p.current,We=ke.scaleX();ke.scale({x:1,y:1}),ke.position({x:0,y:0}),ke.batchDraw(),console.log(" DrawingTestStudent - Reset zoom:",We.toFixed(2),"-> 1.00"),console.log(" DrawingTestStudent - Reset effective size:",w.width,"x",w.height),console.log(" DrawingTestStudent - Reset resolution:",w.width*w.height,"pixels"),c(1)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 text-xs",title:"Reset Zoom",children:"1:1"})]}),l.jsxs("div",{className:"absolute bottom-2 left-2 bg-white border border-gray-300 rounded px-2 py-1 text-xs text-gray-600 shadow-sm",children:[Math.round(o*100),"%"]})]})})})},sae=({content:e})=>{if(!e)return l.jsx("div",{className:"text-gray-500 italic",children:"No instructions provided"});const t=n=>{if(!n)return"";if(n.type==="text"){let s=n.text||"";if(n.format&&(n.format&1&&(s=`<strong>${s}</strong>`),n.format&2&&(s=`<em>${s}</em>`),n.format&8&&(s=`<u>${s}</u>`),n.format&16&&(s=`<s>${s}</s>`)),n.style){const a=n.style.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}if(n.textStyle){const a=n.textStyle.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}return s}if(n.type==="paragraph"){const s=n.children?n.children.map(t).join(""):"";let a="text-left";return n.format&&(n.format==="center"?a="text-center":n.format==="right"?a="text-right":n.format==="left"&&(a="text-left")),`<p class="${a}">${s}</p>`}if(n.type==="heading"){const s=n.tag||"h1",a=n.children?n.children.map(t).join(""):"";return`<${s}>${a}</${s}>`}if(n.type==="list"){const s=n.listType==="bullet"?"ul":"ol",a=n.children?n.children.map(i=>{if(i.type==="listitem"){const o=i.children?i.children.map(t).join(""):"";let c="margin: 4px 0; display: list-item;";return i.format&&(i.format==="center"?c+=" text-align: center;":i.format==="right"?c+=" text-align: right;":i.format==="left"&&(c+=" text-align: left;")),`<li style="${c}">${o}</li>`}return""}).join(""):"";return`<${s} style="margin: 8px 0; padding-left: 20px; list-style-type: ${n.listType==="bullet"?"disc":"decimal"}; display: block;">${a}</${s}>`}return n.children?n.children.map(t).join(""):""};let r=e;if(typeof e=="string"&&e.startsWith("{"))try{const n=JSON.parse(e);n.text?r=n.text:n.content?r=n.content:n.root&&n.root.children&&(r=n.root.children.map(t).join(""))}catch(n){console.log("Failed to parse Lexical content:",n)}return l.jsx("div",{className:"max-w-none rich-text-content",style:{lineHeight:"1.6",fontSize:"14px"},dangerouslySetInnerHTML:{__html:r}})},aae=({question:e,questionIndex:t,studentAnswer:r,onAnswerChange:n,mode:s,testId:a,testType:i})=>{za();const[o,c]=S.useState([]),[u,d]=S.useState(!0),[h,g]=S.useState("pencil"),[p,x]=S.useState("#000000"),[v,w]=S.useState(2),[C,k]=S.useState([]),[b,N]=S.useState(-1),[E,P]=S.useState({width:600,height:800}),[F,A]=S.useState(1),[j,I]=S.useState(!1),[B,Y]=S.useState(!1),[Z,ae]=S.useState(!1),[ee,ne]=S.useState([]),[L,H]=S.useState(null),[M,V]=S.useState(!1),[W,R]=S.useState(null),U=b>0,q=b<C.length-1,[Q,se]=S.useState(!1),X=S.useRef(null),ie=S.useRef(null),[le,ce]=S.useState({width:600,height:800}),Se=S.useRef(!1),[re,ge]=S.useState(.25),Ee=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#008000","#808080","#FFC0CB","#A52A2A","#000080"];S.useEffect(()=>{const De=()=>{ae(window.innerWidth>=1024)};return De(),window.addEventListener("resize",De),()=>window.removeEventListener("resize",De)},[]),S.useEffect(()=>{if(e){const De=e.max_canvas_width||1536,Le=e.max_canvas_height||2048,lt=e.canvas_width||600,Ue=e.canvas_height||800;if(P({width:De,height:Le}),Se.current)console.log(" DrawingTestStudent - Preserving user zoom:",F.toFixed(2));else{A(1),Se.current=!0;const Et=(lt-De*1)/2,At=(Ue-Le*1)/2;if(!isNaN(Et)&&!isNaN(At)&&X.current){const qt={x:Et,y:At};X.current.position(qt),X.current.batchDraw()}console.log(" DrawingTestStudent - Canvas size set:",De,"x",Le),console.log(" DrawingTestStudent - Viewport size:",lt,"x",Ue),console.log(" DrawingTestStudent - Initial zoom:",1 .toFixed(2)),console.log(" DrawingTestStudent - Image resolution:",De*Le,"pixels"),console.log(" DrawingTestStudent - Aspect ratio:",(De/Le).toFixed(2))}if(r&&typeof r=="string")try{const tt=JSON.parse(r);tt.lines?c(tt.lines):c(tt),tt.textBoxes&&ne(tt.textBoxes)}catch{console.log("No valid drawing data found")}d(!1)}},[e,r]),S.useEffect(()=>{const De=()=>{const Le=ie.current;if(!Le)return;const lt=Le.clientWidth||1,Ue=Le.clientHeight||1,tt=Math.min(lt/(E.width||1),Ue/(E.height||1));ge(Math.min(tt,1))};return De(),window.addEventListener("resize",De),()=>window.removeEventListener("resize",De)},[E.width,E.height,Q]);const Ae=De=>{c(De);const Le={lines:De,textBoxes:ee};n(e.question_id,JSON.stringify(Le)),He(De,ee)},He=(De,Le=ee)=>{const lt=C.slice(0,b+1);lt.push({lines:[...De],textBoxes:[...Le]}),k(lt),N(lt.length-1)},Be=()=>{if(U){const De=b-1,Le=C[De];if(Le&&typeof Le=="object"&&Le.lines){c([...Le.lines]),ne([...Le.textBoxes]);const lt={lines:Le.lines,textBoxes:Le.textBoxes};n(e.question_id,JSON.stringify(lt))}else{const lt=Le||[];c([...lt]),n(e.question_id,JSON.stringify(lt))}N(De)}},Rt=()=>{if(q){const De=b+1,Le=C[De];if(Le&&typeof Le=="object"&&Le.lines){c([...Le.lines]),ne([...Le.textBoxes]);const lt={lines:Le.lines,textBoxes:Le.textBoxes};n(e.question_id,JSON.stringify(lt))}else{const lt=Le||[];c([...lt]),n(e.question_id,JSON.stringify(lt))}N(De)}},et=()=>{c([]),ne([]),H(null),n(e.question_id,"")},vt=De=>{H(De)},xt=(De,Le)=>{const lt=ee.map(tt=>tt.id===De?{...tt,...Le}:tt);ne(lt),He(o,lt);const Ue={lines:o,textBoxes:lt};if(n(e.question_id,JSON.stringify(Ue)),Le.isEditing){const tt=ee.find(Et=>Et.id===De);R(tt),V(!0)}},it=De=>{const Le=ee.filter(Ue=>Ue.id!==De);ne(Le),L===De&&H(null),He(o,Le);const lt={lines:o,textBoxes:Le};n(e.question_id,JSON.stringify(lt))},ht=()=>{if(Q){const lt=e?.canvas_width||600,Ue=e?.canvas_height||800,tt=window.innerWidth-40,Et=window.innerHeight-40,At=tt/lt,qt=Et/Ue,pr=Math.min(At,qt,1);return{width:lt,height:Ue,zoom:pr}}const De=e?.canvas_width||600,Le=e?.canvas_height||800;return{width:De,height:Le,zoom:1}};S.useEffect(()=>{const De=()=>{ce(ht())};return De(),window.addEventListener("resize",De),()=>window.removeEventListener("resize",De)},[Q,E]);const Dt=De=>{De.evt.preventDefault();const Le=X.current,lt=Le.scaleX(),Ue=Le.getPointerPosition(),tt={x:(Ue.x-Le.x())/lt,y:(Ue.y-Le.y())/lt},Et=De.evt.deltaY>0?lt*.9:lt*1.1,At=e?.max_canvas_width||1536,qt=e?.max_canvas_height||2048,pr=At/E.width,Rr=qt/E.height,Kr=Math.min(pr,Rr,1),ur=Math.max(re,Math.min(Kr,Et)),ir={x:Ue.x-tt.x*ur,y:Ue.y-tt.y*ur};if(ur<=re&&ie.current){const me=ie.current.clientWidth||1,Ne=ie.current.clientHeight||1;ir.x=(me-E.width*ur)/2,ir.y=(Ne-E.height*ur)/2}Le.scale({x:ur,y:ur}),Le.position(ir),Le.batchDraw(),console.log(" DrawingTestStudent - Wheel zoom:",lt.toFixed(2),"->",ur.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(E.width*ur),"x",Math.round(E.height*ur)),console.log(" DrawingTestStudent - New resolution:",Math.round(E.width*ur*E.height*ur),"pixels"),A(ur),Se.current=!0},Mt=De=>{const Le=De.scaleX(),lt=ie.current,Ue=lt?.clientWidth||le.width,tt=lt?.clientHeight||le.height,Et=E.width*Le,At=E.height*Le;if(Le<=re){const Pe=(Ue-Et)/2,Re=(tt-At)/2;De.position({x:Pe,y:Re}),De.batchDraw();return}if(Et<=Ue&&At<=tt){const Pe=(Ue-Et)/2,Re=(tt-At)/2;De.position({x:Pe,y:Re}),De.batchDraw();return}const qt=Math.max(0,Et-Ue),pr=Math.max(0,At-tt),Rr=-qt,Kr=-pr,ur=De.x(),ir=De.y(),me=Math.max(Rr,Math.min(qt,ur)),Ne=Math.max(Kr,Math.min(pr,ir));(me!==ur||Ne!==ir)&&(De.position({x:me,y:Ne}),De.batchDraw())},Xe=()=>{if(Q)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();else{const De=ie.current;De&&(De.requestFullscreen?De.requestFullscreen():De.webkitRequestFullscreen?De.webkitRequestFullscreen():De.msRequestFullscreen&&De.msRequestFullscreen())}};return S.useEffect(()=>{const De=()=>{se(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",De),document.addEventListener("webkitfullscreenchange",De),document.addEventListener("msfullscreenchange",De),()=>{document.removeEventListener("fullscreenchange",De),document.removeEventListener("webkitfullscreenchange",De),document.removeEventListener("msfullscreenchange",De)}},[]),S.useEffect(()=>()=>{X.current&&X.current.stop()},[]),u?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx(zr,{})}):e?l.jsxs("div",{className:`drawing-question w-full max-w-full mx-0 p-0 sm:p-2 ${Q?"fixed inset-0 z-50 bg-white overflow-y-auto":""}`,children:[!Q&&l.jsx("div",{className:"mb-4",children:l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",t+1]})}),!Q&&e.question_json&&e.question_json.trim()&&l.jsxs("div",{className:"mb-2 p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[l.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Task:"}),l.jsx("div",{className:"text-gray-700",children:l.jsx(sae,{content:e.question_json})})]}),!Q&&l.jsx(Nt,{className:"p-1 sm:p-2 mb-2",children:l.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-wrap",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"hidden sm:block text-sm text-gray-700",children:"Tool:"}),l.jsxs("div",{className:"flex flex-nowrap sm:flex-wrap gap-1 overflow-x-auto",children:[l.jsx("button",{onClick:()=>g("pencil"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="pencil"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pencil (Freehand drawing)",children:""}),l.jsx("button",{onClick:()=>g("line"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="line"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Line",children:""}),l.jsx("button",{onClick:()=>g("rectangle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="rectangle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Rectangle",children:""}),l.jsx("button",{onClick:()=>g("circle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="circle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Circle",children:""}),l.jsx("button",{onClick:()=>g("eraser"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="eraser"?"bg-red-500 text-white border-red-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Eraser",children:""}),l.jsx("button",{onClick:()=>g("text"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="text"?"bg-green-500 text-white border-green-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Text Box",children:""}),l.jsx("button",{onClick:()=>g("pan"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="pan"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pan (Move canvas)",children:""})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-gray-700",children:"History:"}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:Be,disabled:!U,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${U?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Undo (Ctrl+Z)",children:""}),l.jsx("button",{onClick:Rt,disabled:!q,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${q?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Redo (Ctrl+Y)",children:""})]})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>I(!j),className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 sm:py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[l.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:p}}),l.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:"Color"})]}),j&&l.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-white border border-gray-300 rounded-lg shadow-lg z-30 min-w-max",children:l.jsx("div",{className:"flex flex-wrap gap-2 max-w-xs",children:Ee.map(De=>l.jsx("button",{onClick:()=>{x(De),I(!1)},className:`w-10 h-10 rounded border-2 hover:scale-110 transition-transform flex-shrink-0 ${p===De?"border-gray-800":"border-gray-300"}`,style:{backgroundColor:De},title:De},De))})})]}),l.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[l.jsx("label",{className:"text-xs sm:text-sm text-gray-700",children:"Thickness:"}),l.jsx("input",{type:"range",min:"1",max:"10",value:v,onChange:De=>w(parseInt(De.target.value)),className:"w-16 sm:w-20"}),l.jsxs("span",{className:"text-xs text-gray-500 w-6 sm:w-8",children:[v,"px"]})]}),l.jsx(Ye,{onClick:et,variant:"secondary",size:"sm",children:"Clear"})]})}),l.jsx(Nt,{paddingClass:"p-0 sm:p-2",children:l.jsxs("div",{ref:ie,className:"w-full drawing-canvas-container relative p-0 m-0",children:[l.jsx(nae,{width:E.width,height:E.height,lines:o,onDrawingChange:Ae,currentTool:h,currentColor:p,currentThickness:v,zoom:F,onZoomChange:A,isPanning:B,isFullscreen:Q,constrainPanPosition:Mt,handleWheel:Dt,stageRef:X,setIsPanning:Y,responsiveDimensions:le,canvasSize:E,question:e,textBoxes:ee,setTextBoxes:ne,selectedTextBox:L,setSelectedTextBox:H,handleTextBoxSelect:vt,handleTextBoxUpdate:xt,handleTextBoxDelete:it,isEditingText:M,editingTextBox:W,setIsEditingText:V,setEditingTextBox:R,setCurrentTool:g}),l.jsx("button",{onClick:Xe,className:"absolute top-2 left-2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white p-2 rounded-lg transition-all duration-200 z-10",title:Q?"Exit Fullscreen":"Enter Fullscreen",children:Q?l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:l.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})}):l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:l.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]})})]}):l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"text-center",children:l.jsx("p",{className:"text-gray-500",children:"No drawing question data available"})})})},xk={enhanceUserData(e,t){const r={id:e.id||e.student_id||e.teacher_id,username:e.username||e.student_id,name:e.name||e.first_name,surname:e.surname||e.last_name,nickname:e.nickname,role:t,is_active:e.is_active!==void 0?e.is_active:!0,created_at:e.created_at,updated_at:e.updated_at};switch(t){case"student":return{...r,student_id:e.student_id,grade:e.grade,class:e.class,number:e.number,subjects:e.subjects||[]};case"teacher":return{...r,teacher_id:e.teacher_id,first_name:e.first_name,last_name:e.last_name,email:e.email,phone:e.phone,subjects:e.subjects||[]};case"admin":return{...r,admin_id:e.admin_id,permissions:e.permissions||["all"]};default:return r}},async studentLogin(e){console.log("Trying student login...");try{const t=await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:e.username,password:e.password})}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.student,role:"student",response:t};throw new Error(r.message||"Student login failed")}catch(t){throw console.error("Student login error:",t),new Error(t.message||"Student login failed")}},async teacherLogin(e){console.log("Trying teacher login...");try{const t=await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.teacher,role:"teacher",response:t};throw new Error(r.message||"Teacher login failed")}catch(t){throw console.error("Teacher login error:",t),new Error(t.message||"Teacher login failed")}},async adminLogin(e){console.log("Trying admin login...");try{const t=await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.admin,role:"admin",response:t};throw new Error(r.message||"Admin login failed")}catch(t){throw console.error("Admin login error:",t),new Error(t.message||"Admin login failed")}},async login(e){const{username:t,password:r}=e;console.log("Attempting login with:",t,r);try{if(t==="admin"){const o=await this.adminLogin(e),c=await o.json();return await this.handleLoginResponse(o,"admin",c)}const n=await this.teacherLogin(e),s=await n.json();if(n.ok&&s.success)return await this.handleLoginResponse(n,"teacher",s);const a=await this.studentLogin(e),i=await a.json();return a.ok&&i.success?await this.handleLoginResponse(a,"student",i):(this.handleLoginFailure(),{success:!1,message:"Login failed. Please check your credentials and try again."})}catch(n){return console.error("Login error:",n),this.handleLoginFailure(),{success:!1,message:n.message||"Login failed"}}},async handleLoginResponse(e,t,r){if(e.ok&&r.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),this.handleLoginFailure(),{success:!1,message:"JWT system not available"};if(r.accessToken&&r.role)try{window.tokenManager.setTokens(r.accessToken,r.role),window.roleBasedLoader.setupAccessAfterLogin()}catch(n){return console.error("[ERROR] Failed to initialize JWT system:",n),this.handleLoginFailure(),{success:!1,message:"Failed to initialize JWT system"}}return this.resetLoginForm(),await this.handlePostLoginActions(r,t),{success:!0,data:r,role:t}}return{success:!1,message:"Login failed"}},async handlePostLoginActions(e,t){console.log(`Handling post-login actions for role: ${t}`);try{switch(t){case"student":e.student&&(this.populateStudentInfo(e.student),window.loadStudentData&&await window.loadStudentData());break;case"teacher":e.teacher&&(this.populateTeacherInfo(e.teacher),window.loadTeacherData&&await window.loadTeacherData());break;case"admin":e.admin&&window.loadAdminData&&await window.loadAdminData();break;default:console.warn(`Unknown role for post-login actions: ${t}`)}}catch(r){console.error("Error in post-login actions:",r)}},handleLoginFailure(){console.log("All login attempts failed"),this.resetLoginForm(),window.showNotification&&window.showNotification("Login failed. Please check your credentials and try again.","error")},resetLoginForm(){const e=document.getElementById("unifiedLoginForm");if(e){e.querySelectorAll("input").forEach(n=>{n.disabled=!1,n.style.opacity="1",n.style.cursor="text",n.removeAttribute("readonly"),n.style.pointerEvents="auto"});const r=e.querySelector('button[type="submit"]');r&&(r.disabled=!1,r.style.opacity="1",r.style.cursor="pointer",r.style.pointerEvents="auto",r.innerHTML="Login"),e.classList.remove("test-submitting","disabled"),e.style.pointerEvents="auto",console.log("Login form reset successfully - all inputs re-enabled")}},async logout(){console.log(" Logout initiated...");try{return window.tokenManager&&window.tokenManager.logout(),window.roleBasedLoader&&window.roleBasedLoader.reloadRoleAccess(),window.clearTestLocalStorage&&window.clearTestLocalStorage(),this.resetInterfaceAfterSessionClear(),console.log(" Logout completed - user session cleared, test data cleared, and interface reset"),{success:!0}}catch(e){return console.error("Logout error:",e),this.resetInterfaceAfterSessionClear(),{success:!0}}},resetInterfaceAfterSessionClear(){try{window.forceLogout=!0,window.preventAutoLogin=!0,window.isClearingSession=!0,window.forceLogoutComplete=!0,document.querySelectorAll(".section").forEach(s=>{s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0"}),document.querySelectorAll('[id$="-cabinet"], [id$="-container"], [id*="cabinet"], [id*="container"]').forEach(s=>{s.id&&s.id!=="login-section"&&(s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0")}),document.body.classList.remove("student-logged-in","teacher-logged-in","admin-logged-in"),document.body.classList.add("force-logout");const r=document.getElementById("login-section");r&&(r.classList.add("active"),r.style.display="block",r.style.visibility="visible",r.style.opacity="1"),document.querySelectorAll("input, select, textarea").forEach(s=>{s.type!=="hidden"&&(s.value="",s.checked=!1)}),console.log(" Interface reset to login state")}catch(e){console.error("Error resetting interface:",e),localStorage.clear(),sessionStorage.clear(),window.location.reload()}},async changePassword(e){try{return{success:!0,message:(await Ns.post("/auth/change-password",{currentPassword:e.currentPassword,newPassword:e.newPassword,confirmPassword:e.confirmPassword})).data.message}}catch(t){throw new Error(t.response?.data?.message||"Password change failed")}},async verifyToken(e){try{const t=await Ns.get("/auth/verify",{headers:{Authorization:`Bearer ${e}`}});return{success:!0,valid:t.data.valid,user:t.data.user}}catch(t){return{success:!1,valid:!1,error:t.message}}},async refreshToken(e){try{const t=await Ns.post("/auth/refresh",{refreshToken:e});return{success:!0,token:t.data.token,refreshToken:t.data.refreshToken}}catch(t){throw new Error(t.response?.data?.message||"Token refresh failed")}},async getUserProfile(){try{return{success:!0,user:(await Ns.get("/auth/profile")).data.user}}catch(e){throw new Error(e.response?.data?.message||"Failed to get user profile")}},async updateUserProfile(e){try{return{success:!0,user:(await Ns.put("/auth/profile",e)).data.user}}catch(t){throw new Error(t.response?.data?.message||"Failed to update user profile")}},populateStudentInfo(e){console.log("=== populateStudentInfo called ==="),console.log("Student object:",e);const t=document.getElementById("studentName");if(t){const s=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=s,console.log("Set student name to:",s)}const r=document.getElementById("studentGrade");r&&(r.textContent=e?.grade||"",console.log("Set student grade to:",e?.grade));const n=document.getElementById("studentClass");n&&(n.textContent=e?.class||"",console.log("Set student class to:",e?.class)),console.log("Student info populated successfully")},populateTeacherInfo(e){console.log("=== populateTeacherInfo called ==="),console.log("Teacher object:",e);const t=document.getElementById("teacherName");if(t){const n=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=n,console.log("Set teacher name to:",n)}const r=document.getElementById("teacherUsername");r&&(r.textContent=e?.username||"",console.log("Set teacher username to:",e?.username)),console.log("Teacher info populated successfully")},getCurrentTeacherId(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.sub?e.role==="teacher"?(console.log(`[DEBUG] Found teacher ID from JWT: ${e.sub}`),e.sub):(console.warn(`[WARN] Unsupported role for teacher function: ${e.role}`),null):(console.warn("[WARN] No teacher ID found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher ID from JWT:",e),null}},getCurrentAdmin(){const e=window.tokenManager?.getToken();if(!e)return null;const t=window.tokenManager.decodeToken(e);if(!t||t.role!=="admin")throw new Error("getCurrentAdmin() called by non-admin user");return{id:t.sub,username:t.username,role:t.role}},getCurrentTeacherUsername(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.username?(console.log(`[DEBUG] Found teacher username from JWT: ${e.username}`),e.username):(console.warn("[WARN] No teacher username found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher username from JWT:",e),null}},isAdmin(){try{const e=window.tokenManager?.getToken();if(!e)return!1;const t=window.tokenManager.decodeToken(e);return t&&t.role==="admin"}catch(e){return console.error("[ERROR] Error checking admin status:",e),!1}},getCurrentAdminId(){try{const e=this.getCurrentAdmin();return e?e.id:null}catch(e){return console.error("[ERROR] Error getting admin ID:",e),null}}},iae=()=>{const e=Eo(),{login:t,setUserData:r,isAuthenticated:n,user:s}=cs(),[a,i]=S.useState({username:"",password:""}),[o,c]=S.useState(!1),[u,d]=S.useState(""),[h,g]=S.useState([]),[p,x]=S.useState(!1);S.useEffect(()=>{v()},[]);const v=S.useCallback(()=>{console.log("Checking for existing JWT session...");try{(window.forceLogout||window.preventAutoLogin)&&(window.forceLogout=!1,window.preventAutoLogin=!1)}catch{}if(window.tokenManager&&window.tokenManager.isAuthenticated()){console.log("JWT session valid, checking user role...");try{const B=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());B&&B.role?console.log("User role from JWT:",B.role):console.log("No valid role found in JWT, showing login")}catch(B){console.error("Error decoding JWT token:",B)}}else console.log("No valid JWT session found, showing login")},[]),w=S.useCallback(async B=>{if(B.preventDefault(),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),A("Please wait for the logout process to complete.","warning");return}const{username:Y,password:Z}=a;if(!Y||!Z){d("Please enter both username and password");return}c(!0),d("");try{let ae,ee;Y==="admin"?(ae=await xk.adminLogin({username:Y,password:Z}),ee=Ji.ADMIN):/^\d+$/.test(Y)?(ae=await xk.studentLogin({username:Y,password:Z}),ee=Ji.STUDENT):(ae=await xk.teacherLogin({username:Y,password:Z}),ee=Ji.TEACHER);let ne,L;if(ae.response?(ne=ae,L=ae.response):(ne=await ae.json(),L=ae),await C(L,ee,ne)){A("Login successful!","success");try{if("credentials"in navigator&&window.PasswordCredential&&a?.username&&a?.password){const H=new window.PasswordCredential({id:String(a.username),password:String(a.password)});await navigator.credentials.store(H)}}catch{}try{window.forceLogout=!1,window.preventAutoLogin=!1}catch{}}}catch(ae){console.error("Login error:",ae),d("Invalid username or password")}finally{c(!1)}},[a]),C=S.useCallback(async(B,Y,Z)=>{if(B.ok&&Z.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),P(),!1;try{Z.token&&(window.tokenManager.setTokens(Z.token,Y),Z.refreshToken&&window.tokenManager.setRefreshToken(Z.refreshToken),console.log("JWT token stored successfully"));const ae={...Z.data,...Z,role:Y};return r(ae),await k(ae),!0}catch(ae){return console.error("Error handling login response:",ae),P(ae),!1}}else return console.error("Login failed:",Z.error||"Unknown error"),d(Z.error||"Login failed. Please check your credentials."),!1},[t]),k=S.useCallback(async B=>{if(console.log("Handling post-login actions for role:",B.role),p){console.log(" Post-login already handled, skipping");return}x(!0);try{switch(B.role){case Ji.STUDENT:await b(B),e("/student");break;case Ji.TEACHER:await N(B),e("/teacher");break;case Ji.ADMIN:await E(B),e("/admin");break;default:console.error("Unknown user role:",B.role),P()}}catch(Y){console.error("Error in post-login actions:",Y),P(Y)}},[e,p]);S.useEffect(()=>{n||x(!1)},[n]);const b=S.useCallback(async B=>{console.log("Populating student info:",B)},[]),N=S.useCallback(async B=>{console.log("Populating teacher info:",B)},[]),E=S.useCallback(async B=>{console.log("Populating admin info:",B)},[]),P=S.useCallback((B=null)=>{console.error("Login failure:",B),d("Login failed. Please check your credentials and try again."),F()},[]),F=S.useCallback(()=>{i({username:"",password:""}),d(""),c(!1)},[]),A=S.useCallback((B,Y)=>{const Z={id:Date.now(),message:B,type:Y,timestamp:new Date};g(ae=>[...ae,Z]),setTimeout(()=>{g(ae=>ae.filter(ee=>ee.id!==Z.id))},N0.NOTIFICATION_DURATION)},[]),j=S.useCallback(B=>{const{name:Y,value:Z}=B.target;i(ae=>({...ae,[Y]:Z})),u&&d("")},[u]),I=S.useCallback(B=>{B.key==="Enter"&&!o&&w(B)},[w,o]);return l.jsxs(nt.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsxs(nt.div,{className:"w-full max-w-md",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsxs(nt.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsx(nt.div,{className:"flex justify-center mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.5,type:"spring"},children:l.jsx("img",{src:"/pics/logo_mws.png",alt:"MWS Logo",className:"h-16 w-16 object-contain"})}),l.jsx(nt.h1,{className:"text-3xl font-bold text-gray-900 mb-2",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.3},children:"Mathayom Watsing School"}),l.jsx(nt.p,{className:"text-lg text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.3},children:"Test Management System"})]}),l.jsxs(nt.div,{className:"bg-white rounded-xl shadow-2xl p-8",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.7,duration:.5,type:"spring"},children:[l.jsx(nt.h2,{className:"text-2xl font-semibold text-gray-900 text-center mb-6",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.8,duration:.3},children:"Login"}),l.jsxs("form",{onSubmit:w,className:"space-y-6",children:[l.jsxs(nt.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.9,duration:.3},children:[l.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),l.jsx(nt.input,{type:"text",id:"username",name:"username",value:a.username,onChange:j,onKeyDown:I,placeholder:"Enter your username",required:!0,autoComplete:"username",autoCapitalize:"none",spellCheck:!1,disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),l.jsxs(nt.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1,duration:.3},children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),l.jsx(nt.input,{type:"password",id:"password",name:"password",value:a.password,onChange:j,onKeyDown:I,placeholder:"Enter your password",required:!0,autoComplete:"current-password",disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),l.jsx(wo,{children:u&&l.jsx(nt.div,{id:"error-message",className:"bg-red-50 border border-red-200 rounded-lg p-3",role:"alert","aria-live":"polite",initial:{opacity:0,height:0,y:-10},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:-10},transition:{duration:.3},children:l.jsx("p",{className:"text-sm text-red-600",children:u})})}),l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.1,duration:.3},children:l.jsx(Ye,{type:"submit",variant:"primary",size:"lg",disabled:o,className:"w-full",children:o?l.jsxs(l.Fragment,{children:[l.jsx(zr,{size:"sm",className:"mr-2"}),"Logging in..."]}):"Login"})})]})]})]}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:l.jsx(wo,{children:h.map(B=>l.jsx(nt.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{duration:.3,type:"spring"},children:l.jsx(uc,{type:B.type,message:B.message,onClose:()=>g(Y=>Y.filter(Z=>Z.id!==B.id))})},B.id))})})]})},hs={async getStudentData(){console.log("getStudentData called - loading student subjects");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-subjects")).json();if(t.success)return console.log("Student data loaded successfully:",t.subjects),t.subjects;throw new Error(t.error||"Failed to load student data")}catch(e){throw console.error("Error loading student data:",e),e}},getStudentSubjects(e){return console.log("getStudentSubjects called with subjects:",e),e.map(t=>({id:t.id||t.subject_id,name:t.subject,grade:t.grade,class:t.class,testResults:t.test_results||[]}))},async getTeacherData(){console.log("getTeacherData called - loading teacher subjects");try{const e=await this.getCurrentTeacherId();if(!e)throw new Error("No valid teacher session found");const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-subjects")).json();if(r.success)return console.log("Teacher data loaded successfully:",r.subjects),{teacher_id:e,subjects:r.subjects,hasSubjects:r.subjects.length>0};throw new Error(r.error||"Failed to load teacher data")}catch(e){throw console.error("Error loading teacher data:",e),e}},getTeacherSubjects(e){return console.log("getTeacherSubjects called with subjects:",e),e.map(t=>{let r=[];return t.classes&&Array.isArray(t.classes)&&(r=t.classes.map(n=>({grade:n.grade,class:n.class,className:n.class}))),{id:t.subject_id,name:t.subject,classes:r,assignments:t.assignments||[],description:t.description||""}})},getGradeButtons(){return console.log("getGradeButtons called"),["M1","M2","M3","M4","M5","M6"].map(t=>({id:t,name:t,classes:this.generateClassButtons(t)}))},generateClassButtons(e){const t=[];for(let r=1;r<=10;r++)t.push({id:`${e}_${r}`,name:`${e}/${r}`,grade:e,class:r});return t},async getAdminData(){console.log("getAdminData called - loading admin data");try{if(!await this.getCurrentAdminId())throw new Error("No valid admin session found");const[t,r,n]=await Promise.allSettled([this.getAllTeachers(),this.getAllSubjects(),this.getAllUsers()]);return{teachers:t.status==="fulfilled"?t.value:[],subjects:r.status==="fulfilled"?r.value:[],users:n.status==="fulfilled"?n.value:[],loadedAt:new Date().toISOString()}}catch(e){throw console.error("Error loading admin data:",e),e}},async saveTeacherSubjects(e){console.log("saveTeacherSubjects called with subjects:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-teacher-subjects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subjects:e})})).json();if(r.success)return console.log("Teacher subjects saved successfully"),r;throw new Error(r.error||"Failed to save teacher subjects")}catch(t){throw console.error("Error saving teacher subjects:",t),t}},async deleteTeacherSubject(e){console.log("deleteTeacherSubject called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/delete-teacher-subject",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher subject assignment deleted successfully"),r;throw new Error(r.error||"Failed to delete teacher subject assignment")}catch(t){throw console.error("Error deleting teacher subject assignment:",t),t}},async getSubjectsDropdown(){console.log("getSubjectsDropdown called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("Subjects dropdown data loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,value:r.subject_name}));throw new Error(t.error||"Failed to load subjects dropdown")}catch(e){throw console.error("Error loading subjects dropdown:",e),e}},async getGradesAndClasses(){console.log("getGradesAndClasses called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-grades-classes")).json();if(t.success)return console.log("Grades and classes loaded successfully"),t.data;throw new Error(t.message||"Failed to load grades and classes")}catch(e){throw console.error("Error loading grades and classes:",e),e}},async saveSubjectClasses(e,t){console.log("saveSubjectClasses called with subjectId:",e,"classes:",t);try{const r=await this.getCurrentTeacherId();if(!r)throw new Error("No valid teacher session found");const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-subject-classes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacher_id:r,subject_id:e,classes:t})})).json();if(s.success)return console.log("Subject classes saved successfully"),s;throw new Error(s.error||"Failed to save subject classes")}catch(r){throw console.error("Error saving subject classes:",r),r}},async getAllSubjects(){console.log("getAllSubjects called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("All subjects loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,description:r.description||"",created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all subjects")}catch(e){throw console.error("Error loading all subjects:",e),e}},async getSubjectsForSelection(){console.log("getSubjectsForSelection called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-subjects")).json();if(t.success)return console.log("Subjects for selection loaded successfully"),t.subjects;throw new Error(t.message||"Failed to load subjects for selection")}catch(e){throw console.error("Error loading subjects for selection:",e),e}},async addAcademicYear(e){console.log("addAcademicYear called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/add-academic-year",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Academic year added successfully"),r;throw new Error(r.error||"Failed to add academic year")}catch(t){throw console.error("Error adding academic year:",t),t}},async getAllUsers(){console.log("getAllUsers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-users")).json();if(t.success)return console.log("All users loaded successfully"),t.users.map(r=>({id:r.id,student_id:r.student_id,grade:r.grade,class:r.class,number:r.number,name:r.name,surname:r.surname,nickname:r.nickname,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all users")}catch(e){throw console.error("Error loading all users:",e),e}},async getAllTeachers(){console.log("getAllTeachers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-teachers")).json();if(t.success)return console.log("All teachers loaded successfully"),t.teachers.map(r=>({id:r.id,teacher_id:r.teacher_id,username:r.username,name:r.name,surname:r.surname,email:r.email,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all teachers")}catch(e){throw console.error("Error loading all teachers:",e),e}},async createUser(e){console.log("createUser called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("User created successfully"),r;throw new Error(r.error||"Failed to create user")}catch(t){throw console.error("Error creating user:",t),t}},async updateUser(e,t){console.log("updateUser called with userId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-user/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("User updated successfully"),n;throw new Error(n.error||"Failed to update user")}catch(r){throw console.error("Error updating user:",r),r}},async createTeacher(e){console.log("createTeacher called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-teacher",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher created successfully"),r;throw new Error(r.error||"Failed to create teacher")}catch(t){throw console.error("Error creating teacher:",t),t}},async updateTeacher(e,t){console.log("updateTeacher called with teacherId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-teacher/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("Teacher updated successfully"),n;throw new Error(n.error||"Failed to update teacher")}catch(r){throw console.error("Error updating teacher:",r),r}},async updateStudentInfo(e){console.log("updateStudentInfo called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-student-info",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Student info updated successfully"),r;throw new Error(r.error||"Failed to update student info")}catch(t){throw console.error("Error updating student info:",t),t}},async changePassword(e){console.log("changePassword called");let t;if(e.studentId)t="/.netlify/functions/change-student-password";else if(e.username)t="/.netlify/functions/change-teacher-password";else throw new Error("Invalid password data: missing studentId or username");try{const n=await(await window.tokenManager.makeAuthenticatedRequest(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(n.success)return console.log("Password changed successfully"),n;throw new Error(n.error||"Failed to change password")}catch(r){throw console.error("Error changing password:",r),r}},async getCurrentTeacherId(){try{const e=localStorage.getItem("accessToken");if(!e)return null;const t=JSON.parse(atob(e.split(".")[1]));return t.teacher_id||t.sub||null}catch(e){return console.error("Error getting current teacher ID:",e),null}},async getCurrentAdminId(){try{const e=localStorage.getItem("accessToken");if(!e)return null;const t=JSON.parse(atob(e.split(".")[1]));return t.admin_id||t.sub||null}catch(e){return console.error("Error getting current admin ID:",e),null}}},NB=S.createContext(),AB=({children:e})=>{const[t,r]=S.useState(null),[n,s]=S.useState([]),[a,i]=S.useState([]),[o,c]=S.useState([]),[u,d]=S.useState([]),[h,g]=S.useState([]),[p,x]=S.useState([]),[v,w]=S.useState([]),[C,k]=S.useState(!1),[b,N]=S.useState(null),[E,P]=S.useState(!1),[F,A]=S.useState(!1),[j,I]=S.useState(!1),[B,Y]=S.useState(null),[Z,ae]=S.useState(null),[ee,ne]=S.useState(null),L=S.useCallback(async()=>{try{k(!0),N(null);const Ne=`student_subjects_${t?.student_id||t?.id||""}`;console.log(" UserContext: Checking cache for key:",Ne);const Pe=Rs(Ne);if(Pe){console.log(" UserContext: Cache HIT! Using cached student data"),s(Pe),H(Pe);return}console.log(" UserContext: Cache MISS! Fetching from API");const Re=await hs.getStudentData();if(Re)s(Re),H(Re),console.log(" UserContext: Caching student data with key:",Ne),vs(Ne,Re,Is.student_subjects);else throw new Error("No subjects data received")}catch(me){N(me.message||"Failed to load student data"),console.error("Error loading student data:",me)}finally{k(!1)}},[t?.student_id,t?.id]),H=me=>{console.log("Displaying student subjects:",me),s(me)},M=S.useCallback(async()=>{try{if(k(!0),N(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid teacher session found in loadTeacherData, redirecting to login"),N("No valid teacher session found");return}const Ne=`teacher_subjects_${t?.teacher_id||t?.id||""}`,Pe=Rs(Ne);if(Pe){s(Pe),Pe.length===0?qt():V(Pe);return}const Re=await hs.getTeacherSubjects();if(Re.success)s(Re.subjects),vs(Ne,Re.subjects,Is.teacher_subjects),Re.subjects.length===0?qt():V(Re.subjects);else throw new Error(Re.message||"Failed to load teacher data")}catch(me){N(me.message||"Failed to load teacher data"),console.error("Error loading teacher data:",me)}finally{k(!1)}},[t?.teacher_id,t?.id]),V=me=>{console.log("Showing main cabinet with subjects:",me),s(me)},W=me=>{console.log("Displaying grade buttons:",me),c(me)},R=async()=>{try{if(k(!0),N(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid admin session found in loadAdminData, redirecting to login"),N("No valid admin session found");return}await Promise.all([ge(),xt(),se()])}catch(me){N(me.message||"Failed to load admin data"),console.error("Error loading admin data:",me)}finally{k(!1)}},U=me=>{console.log(" populateStudentInfoDirectly called with:",me);try{r(me),console.log(" Set student profile:",me)}catch(Ne){console.error("Error populating student info:",Ne)}},q=me=>{console.log("=== populateStudentInfo called ==="),r(me)},Q=me=>{console.log("=== populateTeacherInfo called ==="),r(me)},se=S.useCallback(async()=>{try{k(!0);const me="admin_users_",Ne=Rs(me);if(Ne){d(Ne),X(Ne);return}const Pe=await hs.getAllUsers();if(Pe.success)d(Pe.users),X(Pe.users),vs(me,Pe.users,Is.admin_users);else throw new Error(Pe.message||"Failed to load users")}catch(me){N(me.message||"Failed to load users"),console.error("Error loading users:",me)}finally{k(!1)}},[]),X=me=>{console.log("Displaying all users:",me),d(me)},ie=(me,Ne)=>{console.log("Displaying users table:",me,Ne),d(me)},le=()=>{console.log("Toggling users content")},ce=()=>{console.log("Showing add user form"),P(!0)},Se=()=>{console.log("Hiding add user form"),P(!1)},re=me=>{console.log("Editing user row:",me);const Ne=u.find(Pe=>Pe.id===me);Y(Ne)},ge=S.useCallback(async()=>{try{const me="admin_teachers_",Ne=Rs(me);if(Ne){g(Ne),Ee(Ne);return}const Pe=await hs.getAllTeachers();if(Pe.success)g(Pe.teachers),Ee(Pe.teachers),vs(me,Pe.teachers,Is.admin_teachers);else throw new Error(Pe.message||"Failed to load teachers")}catch(me){N(me.message||"Failed to load teachers"),console.error("Error loading teachers:",me)}},[]),Ee=me=>{console.log("Displaying all teachers:",me),g(me)},Ae=(me,Ne)=>{console.log("Displaying teachers table:",me,Ne),g(me)},He=()=>{console.log("Toggling teachers content")},Be=()=>{console.log("Showing add teacher form"),A(!0)},Rt=()=>{console.log("Hiding add teacher form"),A(!1)},et=me=>{console.log("Editing teacher:",me);const Ne=h.find(Pe=>Pe.id===me);ae(Ne)},vt=me=>{console.log("Editing teacher row:",me);const Ne=h.find(Pe=>Pe.id===me);ae(Ne)},xt=S.useCallback(async()=>{try{const me="admin_subjects_",Ne=Rs(me);if(Ne){x(Ne),it(Ne);return}const Pe=await hs.getAllSubjects();if(Pe.success)x(Pe.subjects),it(Pe.subjects),vs(me,Pe.subjects,Is.admin_subjects);else throw new Error(Pe.message||"Failed to load subjects")}catch(me){N(me.message||"Failed to load subjects"),console.error("Error loading subjects:",me)}},[]),it=me=>{console.log("Displaying all subjects:",me),x(me)},ht=(me,Ne)=>{console.log("Displaying subjects table:",me,Ne),x(me)},Dt=()=>{console.log("Toggling subjects content")},Mt=()=>{console.log("Showing add subject form"),I(!0)},Xe=()=>{console.log("Hiding add subject form"),I(!1)},De=me=>{console.log("Editing subject row:",me);const Ne=p.find(Pe=>Pe.id===me);ne(Ne)},Le=me=>{console.log("Displaying academic year:",me),w(me)},lt=()=>{console.log("Showing add academic year form")},Ue=()=>{console.log("Hiding add academic year form")},tt=me=>{console.log("Handling add academic year:",me)},Et=()=>{console.log("Toggling academic year content")},At=()=>{console.log("Showing academic year editor")},qt=()=>{console.log("Showing subject selection")},pr=()=>{console.log("Showing main cabinet")},Rr=me=>{r(Ne=>({...Ne,...me}))},Kr=()=>{r(null),s([]),i([]),c([]),d([]),g([]),x([]),w([]),N(null)},ur=S.useCallback(me=>{Kr(),me&&mN(me)},[]),ir={userProfile:t,userSubjects:n,userClasses:a,userGrades:o,allUsers:u,allTeachers:h,allSubjects:p,academicYears:v,isLoading:C,error:b,showUserForm:E,showTeacherForm:F,showSubjectForm:j,editingUser:B,editingTeacher:Z,editingSubject:ee,loadStudentData:L,displayStudentSubjects:H,populateStudentInfoDirectly:U,populateStudentInfo:q,loadTeacherData:M,showMainCabinetWithSubjects:V,displayGradeButtons:W,populateTeacherInfo:Q,showSubjectSelection:qt,showMainCabinet:pr,loadAdminData:R,getAllUsers:se,displayAllUsers:X,displayUsersTable:ie,toggleUsersContent:le,showAddUserForm:ce,hideAddUserForm:Se,editUserRow:re,loadAllTeachers:ge,displayAllTeachers:Ee,displayTeachersTable:Ae,toggleTeachersContent:He,showAddTeacherForm:Be,hideAddTeacherForm:Rt,editTeacher:et,editTeacherRow:vt,loadAllSubjects:xt,displayAllSubjects:it,displaySubjectsTable:ht,toggleSubjectsContent:Dt,showAddSubjectForm:Mt,hideAddSubjectForm:Xe,editSubjectRow:De,displayAcademicYear:Le,showAddAcademicYearForm:lt,hideAddAcademicYearForm:Ue,handleAddAcademicYear:tt,toggleAcademicYearContent:Et,showAcademicYearEditor:At,updateUserProfile:Rr,clearUserData:Kr,clearUserDataWithCache:ur,setUserProfile:r,setUserSubjects:s,setUserClasses:i,setUserGrades:c,setAllUsers:d,setAllTeachers:g,setAllSubjects:x,setAcademicYears:w,setError:N};return l.jsx(NB.Provider,{value:ir,children:e})},r2=()=>{const e=S.useContext(NB);if(!e)throw new Error("useUser must be used within a UserProvider");return e},Yx={STUDENT_LOGIN:"/.netlify/functions/student-login",TEACHER_LOGIN:"/.netlify/functions/teacher-login",ADMIN_LOGIN:"/.netlify/functions/admin-login",CHANGE_PASSWORD:"/.netlify/functions/change-password",GET_TEST_QUESTIONS:"/.netlify/functions/get-test-questions",SUBMIT_MULTIPLE_CHOICE_TEST:"/.netlify/functions/submit-multiple-choice-test",SUBMIT_TRUE_FALSE_TEST:"/.netlify/functions/submit-true-false-test",SUBMIT_INPUT_TEST:"/.netlify/functions/submit-input-test",SUBMIT_MATCHING_TEST:"/.netlify/functions/submit-matching-test",SUBMIT_DRAWING_TEST:"/.netlify/functions/submit-drawing-test",GET_STUDENT_SUBJECTS:"/.netlify/functions/get-student-subjects",GET_TEACHER_SUBJECTS:"/.netlify/functions/get-teacher-subjects",GET_ALL_USERS:"/.netlify/functions/get-all-users",GET_ALL_TEACHERS:"/.netlify/functions/get-all-teachers",GET_ALL_SUBJECTS:"/.netlify/functions/get-all-subjects",GET_ACADEMIC_YEAR:"/.netlify/functions/get-academic-year",SAVE_MULTIPLE_CHOICE_TEST:"/.netlify/functions/save-multiple-choice-test",SAVE_TRUE_FALSE_TEST:"/.netlify/functions/save-true-false-test",SAVE_INPUT_TEST:"/.netlify/functions/save-input-test",SAVE_MATCHING_TEST:"/.netlify/functions/save-matching-test",SAVE_DRAWING_TEST:"/.netlify/functions/save-drawing-test",UPDATE_DRAWING_TEST_SCORE:"/.netlify/functions/update-drawing-test-score",UPDATE_SPEAKING_TEST_SCORE:"/.netlify/functions/update-speaking-test-score",ASSIGN_TEST_TO_CLASSES:"/.netlify/functions/assign-test-to-classes",GET_TEACHER_ACTIVE_TESTS:"/.netlify/functions/get-teacher-active-tests",GET_STUDENT_ACTIVE_TESTS:"/.netlify/functions/get-student-active-tests"},On={MULTIPLE_CHOICE:"multiple_choice",TRUE_FALSE:"true_false",INPUT:"input",MATCHING:"matching_type",WORD_MATCHING:"word_matching",DRAWING:"drawing",FILL_BLANKS:"fill_blanks"},Ji={STUDENT:"student",TEACHER:"teacher",ADMIN:"admin"};Array.from({length:10},(e,t)=>t+1);const N0={NOTIFICATION_DURATION:3e3},wf=(e,t,r)=>{if(!e||!Array.isArray(e)||e.length===0)return{score:0,total:0,percentage:0};let n=0;return e.forEach((s,a)=>{const i=Array.isArray(t)?t[a]:t[String(s.question_id||s.id||a)];i!=null&&Sm(s,i,r)&&n++}),{score:n,total:e.length,percentage:Math.round(n/e.length*100)}},Qy=(e,t)=>{console.log(" Getting correct answer for question:",e,"testType:",t);let r="";switch(t){case On.TRUE_FALSE:r=e.correct_answer?"true":"false",console.log(" TRUE_FALSE correct_answer from question:",r,typeof r);break;case On.MULTIPLE_CHOICE:const n=e.correct_answer.charCodeAt(0)-65,s=`option_${String.fromCharCode(97+n)}`,a=e[s];a?r=a:r=`Option ${e.correct_answer}`;break;case On.INPUT:e.correct_answers&&Array.isArray(e.correct_answers)?r=e.correct_answers.join(", "):r=e.correct_answer||"Unknown";break;case On.MATCHING:r=e.correct_answer||e.answer;break;case On.WORD_MATCHING:r=e.correct_answer||e.answer;break;case On.DRAWING:r="Drawing required";break;case On.FILL_BLANKS:e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?r=e.correct_answers[0]:r=e.correct_answer||"Unknown";break;default:r="Unknown"}return console.log(" Correct answer:",r),r},Sm=(e,t,r)=>{if(console.log("[DEBUG] checkAnswerCorrectness called for question:",e,"studentAnswer:",t,"testType:",r),!t||t==="")return console.log("[DEBUG] No student answer provided"),!1;let n=!1;switch(r){case On.TRUE_FALSE:n=t.toLowerCase()==="true"===e.correct_answer;break;case On.MULTIPLE_CHOICE:let a="";if(typeof t=="string"){const o=t.trim();if(/^[a-z]$/i.test(o))a=o.toUpperCase();else if(/^\d+$/.test(o)){const c=parseInt(o,10),u=c>=0?c:NaN;Number.isNaN(u)||(a=String.fromCharCode(65+u))}}else if(typeof t=="number"){const o=t;Number.isNaN(o)||(a=String.fromCharCode(65+o))}n=a!==""&&a===String(e.correct_answer||"").toUpperCase();break;case On.INPUT:if(e.correct_answers&&Array.isArray(e.correct_answers)){const o=t.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();n=e.correct_answers.some(c=>{const u=c.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();return o===u?!0:u&&o.includes(u)?u.length===1?o.startsWith(u)||o.endsWith(u):!0:!1})}else{const o=t.toLowerCase().trim(),c=e.correct_answer.toLowerCase().trim();o===c?n=!0:c&&o.includes(c)?c.length===1?n=o.startsWith(c)||o.endsWith(c):n=!0:n=!1}break;case On.MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const o=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(o)===JSON.stringify(e.correct_answer)}break;case On.WORD_MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const o=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(o)===JSON.stringify(e.correct_answer)}break;case On.DRAWING:console.warn("Drawing tests should not be auto-scored!"),n=!1;break;case On.FILL_BLANKS:const i=e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?e.correct_answers[0]:e.correct_answer;if(i&&t){let o="";if(typeof t=="string"){const c=t.trim();if(/^[a-z]$/i.test(c))o=c.toUpperCase();else if(/^\d+$/.test(c)){const u=parseInt(c,10),d=u>=0?u:NaN;Number.isNaN(d)||(o=String.fromCharCode(65+d))}}else if(typeof t=="number"){const c=t;Number.isNaN(c)||(o=String.fromCharCode(65+c))}n=o!==""&&o===String(i||"").toUpperCase()}break;default:console.warn(`[WARN] Unknown test type for answer checking: ${r}`),n=!1}return console.log(`[DEBUG] Answer correctness: ${n}`),n};class oae{constructor(){this.academicCalendar=null,this.loaded=!1}async loadAcademicCalendar(){if(this.loaded)return this.academicCalendar;try{const t=async n=>{const s=await fetch(n,{headers:{Accept:"application/json"},credentials:"include"}),a=s.headers&&s.headers.get&&s.headers.get("content-type")||"";if(!s.ok)throw new Error(`HTTP ${s.status}`);if(!a.includes("application/json"))throw new Error("Non-JSON response");return await s.json()};let r=null;if(r=await t("/academic_year.json"),!Array.isArray(r))throw new Error("Invalid academic calendar format");return this.academicCalendar=r,this.loaded=!0,console.log(" Academic calendar loaded:",this.academicCalendar.length,"terms"),this.academicCalendar}catch(t){return console.error(" Error loading academic calendar:",t),null}}getCurrentTerm(){if(!this.academicCalendar)return null;const t=new Date;return this.academicCalendar.find(n=>{const s=new Date(n.start_date),a=new Date(n.end_date);return t>=s&&t<=a})}getCurrentSemester(){const t=this.getCurrentTerm();if(!t)return null;const r=t.semester,n=this.academicCalendar.filter(s=>s.semester===r&&s.academic_year===t.academic_year);return{semester:r,currentTerm:t,allTerms:n}}getCurrentAcademicPeriodId(){return this.getCurrentTerm()?.id||null}getSemesterTerms(t){return this.academicCalendar?this.academicCalendar.filter(r=>r.semester===t):[]}getAcademicYearTerms(t){return this.academicCalendar?this.academicCalendar.filter(r=>r.academic_year===t):[]}getCurrentSemesterWithTerms(){const t=this.getCurrentSemester();if(!t)return null;const{semester:r,currentTerm:n,allTerms:s}=t;return{semester:r,currentTerm:n,allTerms:s,terms:s.map(a=>({id:a.id,term:a.term,start_date:a.start_date,end_date:a.end_date,isCurrent:a.id===n.id,label:`Term ${a.term}${a.id===n.id?" (Current)":""}`}))}}getCurrentSemesterTerms(){const t=this.getCurrentSemester();if(!t)return null;const{semester:r,currentTerm:n,allTerms:s}=t;return{semester:r,currentTerm:n,terms:s.map(a=>({id:a.id,term:a.term,start_date:a.start_date,end_date:a.end_date,isCurrent:a.id===n.id,label:`Term ${a.term}${a.id===n.id?" (Current)":""}`}))}}getTermById(t){return this.academicCalendar?this.academicCalendar.find(r=>r.id===t):null}isCurrentTerm(t){return this.getCurrentTerm()?.id===t}getAcademicYears(){return this.academicCalendar?[...new Set(this.academicCalendar.map(r=>r.academic_year))].sort():[]}getAcademicYearSemesterTerms(t,r){return this.academicCalendar?this.academicCalendar.filter(n=>n.academic_year===t&&n.semester===r):[]}}const rd=new oae,n2=Object.freeze(Object.defineProperty({__proto__:null,academicCalendarService:rd},Symbol.toStringTag,{value:"Module"})),hn={async getTestInfo(e,t){console.log(`[DEBUG] getTestInfo called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test info from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test info data received:",s),s.success)return console.log("[DEBUG] Test info retrieved successfully"),s.test_info;throw new Error(s.error||"Failed to get test info")}catch(r){throw console.error("[ERROR] Failed to get test info:",r),r}},async getTestQuestions(e,t){console.log(`[DEBUG] getTestQuestions called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test questions from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test questions data received:",s),s.success)return console.log("[DEBUG] Test questions retrieved successfully"),s.questions;throw new Error(s.error||"Failed to get test questions")}catch(r){throw console.error("[ERROR] Failed to get test questions:",r),r}},async getActiveTests(){console.log("getActiveTests called - extracting studentId from JWT token");try{const e="/.netlify/functions/get-student-active-tests";console.log("[DEBUG] Fetching active tests from:",e);const t=await window.tokenManager.makeAuthenticatedRequest(e);if(console.log("[DEBUG] Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(console.log("[DEBUG] Active tests data received:",r),r.success)return console.log("[DEBUG] Active tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get active tests")}catch(e){throw console.error("[ERROR] Failed to get active tests:",e),e}},async getTeacherTests(e=!1){console.log("getTeacherTests called - extracting teacherId from JWT token");try{const t="/.netlify/functions/get-teacher-active-tests",r=e?`${t}?ts=${Date.now()}`:t;console.log("[DEBUG] Fetching teacher tests from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Teacher tests data received:",s),s.success)return console.log("[DEBUG] Teacher tests retrieved successfully"),s.tests;throw new Error(s.error||"Failed to get teacher tests")}catch(t){throw console.error("[ERROR] Failed to get teacher tests:",t),t}},async submitTest(e,t,r,n={},s=null){console.log("Submitting test:",{testType:e,testId:t});try{if(Object.keys(r).length===0)throw new Error("Please answer at least one question before submitting.");let a;try{const N=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`)).json();if(N.success)a=N.test_info;else throw new Error("Failed to get test information")}catch(b){console.error("Error getting test info:",b);const N=await this.getTestQuestions(e,t);a={test_name:`Test ${t}`,num_questions:N.length}}const i=await this.getTestQuestions(e,t);let o,c;if(e==="drawing")o=null,c=null;else{const b=n?.answers_by_id?n.answers_by_id:r;o=wf(i,b,e).score,c=a.num_questions}const u=this.transformAnswersForSubmission(r,e),d=a.teacher_id||null,h=a.subject_id||null,g=s?.student_id||s?.id||(window.tokenManager?.getCurrentUser?window.tokenManager.getCurrentUser()?.student_id||window.tokenManager.getCurrentUser()?.id:null);await rd.loadAcademicCalendar();const x=rd.getCurrentTerm()?.id;if(!x)throw new Error("No current academic period found");const v={test_id:t,test_name:a.test_name,test_type:e,teacher_id:d,subject_id:h,student_id:g,academic_period_id:x,answers:u,score:o,maxScore:c,time_taken:n.time_taken||null,started_at:n.started_at||null,submitted_at:n.submitted_at||new Date().toISOString(),caught_cheating:n.caught_cheating||!1,visibility_change_times:n.visibility_change_times||0,answers_by_id:n.answers_by_id||null,question_order:n.question_order||null,retest_assignment_id:n.retest_assignment_id||null,parent_test_id:n.parent_test_id||t};console.log(" testService retest_assignment_id:",n.retest_assignment_id),console.log(" testService timingData:",n),console.log(" testService commonData.retest_assignment_id:",v.retest_assignment_id);let w;switch(e){case"multiple_choice":w="/.netlify/functions/submit-multiple-choice-test";break;case"true_false":w="/.netlify/functions/submit-true-false-test";break;case"input":w="/.netlify/functions/submit-input-test";break;case"matching_type":w="/.netlify/functions/submit-matching-type-test";break;case"word_matching":w="/.netlify/functions/submit-word-matching-test";break;case"drawing":w="/.netlify/functions/submit-drawing-test";break;case"fill_blanks":w="/.netlify/functions/submit-fill-blanks-test";break;default:throw new Error(`Unsupported test type: ${e}`)}console.log("Submitting to:",w),console.log("Submission data:",v),console.log("Submission data JSON:",JSON.stringify(v,null,2)),console.log(" Final submission retest_assignment_id:",v.retest_assignment_id);const C=await window.tokenManager.makeAuthenticatedRequest(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)});if(!C.ok)throw new Error(`HTTP error! status: ${C.status}`);const k=await C.json();if(console.log("Test submission result:",k),k.success)return this.clearTestProgress(e,t),{success:!0,score:o,maxScore:c,result:k};throw new Error(k.error||"Failed to submit test")}catch(a){throw console.error("Error submitting test:",a),a}},async createTest(e){try{return(await Ns.post("/tests/create",e)).data}catch(t){throw new Error(t.message||"Failed to create test")}},async updateTest(e,t,r){try{return(await Ns.put(`/tests/${e}/${t}`,r)).data}catch(n){throw new Error(n.message||"Failed to update test")}},async deleteTest(e,t){try{return(await Ns.delete(`/tests/${e}/${t}`)).data}catch(r){throw new Error(r.message||"Failed to delete test")}},async duplicateTest(e,t){try{return(await Ns.post(`/tests/${e}/${t}/duplicate`)).data}catch(r){throw new Error(r.message||"Failed to duplicate test")}},async publishTest(e,t){try{return(await Ns.post(`/tests/${e}/${t}/publish`)).data}catch(r){throw new Error(r.message||"Failed to publish test")}},async unpublishTest(e,t){try{return(await Ns.post(`/tests/${e}/${t}/unpublish`)).data}catch(r){throw new Error(r.message||"Failed to unpublish test")}},async removeClassAssignment(e,t,r){try{return(await Ns.delete(`/tests/${e}/${t}/assignments/${r}`)).data}catch(n){throw new Error(n.message||"Failed to remove class assignment")}},async getTestStatistics(e,t){try{return(await Ns.get(`/tests/${e}/${t}/statistics`)).data}catch(r){throw new Error(r.message||"Failed to get test statistics")}},async exportTest(e,t,r="json"){try{return(await Ns.get(`/tests/${e}/${t}/export?format=${r}`)).data}catch(n){throw new Error(n.message||"Failed to export test")}},async importTest(e,t){try{return(await Ns.uploadFile(`/tests/import?type=${t}`,e)).data}catch(r){throw new Error(r.message||"Failed to import test")}},async getTestResults(e,t){try{return(await Ns.get(`/tests/${e}/${t}/results`)).data}catch(r){throw new Error(r.message||"Failed to get test results")}},async getStudentTestResults(){try{console.log("[DEBUG] Fetching student test results from: /.netlify/functions/get-student-test-results");const e=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-test-results");if(console.log("[DEBUG] Response status:",e.status),!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();if(console.log("[DEBUG] Student test results data received:",t),t.success)return console.log("[DEBUG] Student test results retrieved successfully"),t;throw new Error(t.error||"Failed to get student test results")}catch(e){throw console.error("[ERROR] Failed to get student test results:",e),new Error(e.message||"Failed to get student test results")}},async getClassResults(e,t,r){try{return(await Ns.get(`/tests/class-results/${e}/${t}/${r}`)).data}catch(n){throw new Error(n.message||"Failed to get class results")}},async saveTestProgress(e,t,r){try{return(await Ns.post(`/tests/${e}/${t}/progress`,{progress:r})).data}catch(n){throw new Error(n.message||"Failed to save test progress")}},async getTestProgress(e,t){try{return(await Ns.get(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to get test progress")}},async clearTestProgress(e,t){try{return(await Ns.delete(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to clear test progress")}},async validateTestData(e){try{return(await Ns.post("/tests/validate",e)).data}catch(t){throw new Error(t.message||"Failed to validate test data")}},async getTestPreview(e,t){try{return(await Ns.get(`/tests/${e}/${t}/preview`)).data}catch(r){throw new Error(r.message||"Failed to get test preview")}},isAnswerCorrect(e,t,r,n){switch(n){case"multiple_choice":return String.fromCharCode(65+parseInt(t))===r.correct_answer;case"true_false":return t.toLowerCase()==="true"===r.correct_answer;case"input":const i=r.correct_answers||[],o=t.toLowerCase().trim();return i.some(c=>{const u=c.toLowerCase().trim();return o===u?!0:u&&o.includes(u)?u.length===1?o.startsWith(u)||o.endsWith(u):!0:!1});case"matching_type":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"word_matching":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"drawing":return t&&t!=="No answer";default:return!1}},transformAnswersForSubmission(e,t){switch(t){case"multiple_choice":return e;case"true_false":return e;case"input":return e;case"matching_type":return e;case"word_matching":return e;case"drawing":if(Array.isArray(e)&&e.length>0)try{const r=e[0];return typeof r=="string"&&r.startsWith("[")?JSON.parse(r):e}catch(r){return console.warn("Failed to parse drawing answers:",r),e}return e;default:return e}},async markTestCompleted(e,t){try{console.log(`[DEBUG] markTestCompleted called with testType: ${e}, testId: ${t}`);const r=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/mark-test-completed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_type:e,test_id:t})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();if(console.log("[DEBUG] Mark test completed response:",n),n.success)return console.log(`Test ${e}_${t} marked as completed successfully`),{success:!0,message:n.message};throw new Error(n.error||"Failed to mark test as completed")}catch(r){throw console.error("Error marking test completed:",r),r}},clearTestProgress(e,t){try{const r=`test_progress_${e}_${t}`;localStorage.removeItem(r),console.log(`Test progress cleared for ${e}_${t}`)}catch(r){console.error("Error clearing test progress:",r)}},async saveMultipleChoiceTest(e){console.log("[DEBUG] saveMultipleChoiceTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-multiple-choice-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save multiple choice test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving multiple choice test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveTrueFalseTest(e){console.log("[DEBUG] saveTrueFalseTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-true-false-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save true/false test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving true/false test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveInputTest(e){console.log("[DEBUG] saveInputTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-input-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save input test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving input test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveMatchingTest(e){console.log("[DEBUG] saveMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"matching_type",num_questions:e.num_blocks})})).json();return console.log("[DEBUG] Save matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveWordMatchingTest(e){console.log("[DEBUG] saveWordMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"word_matching"})})).json();return console.log("[DEBUG] Save word matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving word matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveDrawingTest(e){console.log("[DEBUG] saveDrawingTest called with:",e);try{const t={...e,test_type:"drawing"},n=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save drawing test response:",n),n.success?{success:!0,data:{test_id:n.test_id}}:{success:!1,message:n.message||"Failed to save test"}}catch(t){return console.error("Error saving drawing test:",t),{success:!1,message:"Error saving test: "+t.message}}},async getDrawingTest(e){console.log("[DEBUG] getDrawingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-drawing-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get drawing test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting drawing test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitDrawingTest(e,t,r,n){console.log("[DEBUG] submitDrawingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-drawing-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit drawing test response:",a),a.success?{success:!0,data:a.data}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting drawing test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async updateDrawingTestScore(e,t,r){console.log("[DEBUG] updateDrawingTestScore called with:",{resultId:e,score:t,maxScore:r});try{const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-drawing-test-score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({result_id:e,score:t,max_score:r})})).json();return console.log("[DEBUG] Update drawing test score response:",s),s.success?{success:!0,data:s.data}:{success:!1,message:s.message||"Failed to update score"}}catch(n){return console.error("Error updating drawing test score:",n),{success:!1,message:"Error updating score: "+n.message}}},async getWordMatchingTest(e){console.log("[DEBUG] getWordMatchingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-word-matching-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get word matching test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting word matching test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitWordMatchingTest(e,t,r,n){console.log("[DEBUG] submitWordMatchingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit word matching test response:",a),a.success?{success:!0,result:a.result}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting word matching test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async assignTestToClasses(e){console.log("[DEBUG] assignTestToClasses called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save test with assignments response:",r),r.success?{success:!0,message:"Test assigned successfully"}:{success:!1,message:r.message||"Failed to assign test"}}catch(t){return console.error("Error assigning test to classes:",t),{success:!1,message:"Error assigning test: "+t.message}}},async removeClassAssignment(e){console.log("[DEBUG] removeClassAssignment called with assignmentId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/remove-class-assignment?assignment_id=${e}`,{method:"DELETE"})).json();return console.log("[DEBUG] Remove class assignment response:",r),r.success?{success:!0,message:"Assignment removed successfully"}:{success:!1,message:r.message||"Failed to remove assignment"}}catch(t){return console.error("Error removing class assignment:",t),{success:!1,message:"Error removing assignment: "+t.message}}}},jB=S.createContext(),PB=({children:e})=>{const[t,r]=S.useState(null),[n,s]=S.useState([]),[a,i]=S.useState({}),[o,c]=S.useState({}),[u,d]=S.useState(!1),[h,g]=S.useState(null),[p,x]=S.useState([]),[v,w]=S.useState(!1),[C,k]=S.useState(null),[b,N]=S.useState({isOpen:!1,testType:null,testId:null,testName:null,questions:[]}),[E,P]=S.useState(null),[F,A]=S.useState(0),{getItem:j,setItem:I,removeItem:B}=EB();S.useEffect(()=>{let me;return u&&E&&(me=setInterval(()=>{const Ne=Math.floor((Date.now()-E)/1e3);A(Ne)},1e3)),()=>{me&&clearInterval(me)}},[u,E]);const Y=async(me,Ne)=>{try{w(!0),k(null),console.log(`[DEBUG] loadTestForPage called with testType: ${me}, testId: ${Ne}`);const Pe=await hn.getTestInfo(me,Ne);console.log("[DEBUG] Test info retrieved:",Pe);const Re=await hn.getTestQuestions(me,Ne);console.log("[DEBUG] Test questions retrieved:",Re),r({...Pe,testType:me,testId:Ne}),s(Re),d(!0),P(Date.now()),A(0),Z(me,Ne),console.log("[DEBUG] Test loaded successfully")}catch(Pe){k(Pe.message||"Failed to load test"),console.error("Error loading test:",Pe)}finally{w(!1)}},Z=(me,Ne)=>{try{const Pe=`test_progress_${me}_${Ne}`,Re=j(Pe);Re&&(i(Re.answers||{}),c(Re.progress||{}))}catch(Pe){console.error("Error loading saved progress:",Pe)}},ae=(me,Ne,Pe,Re)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}const Fe=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${me}_${Ne}`,st={...a,[Pe]:Re},ke={...o,[Pe]:{answered:!0,timestamp:Date.now()}};i(st),c(ke),I(Fe,{answers:st,progress:ke,lastSaved:Date.now()}),console.log(`Saved progress for question ${Pe}:`,Re)}catch(Ct){console.error("Error saving test progress:",Ct)}},ee=(me,Ne,Pe)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated())return console.warn("[WARN] Cannot get progress: No valid JWT token"),null;const Ct=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${me}_${Ne}`;return j(Ct)?.answers?.[Pe]||null}catch(Re){return console.error("Error getting test progress:",Re),null}},ne=(me,Ne)=>{try{if(console.log(`[DEBUG] clearTestProgress called with testType: ${me}, testId: ${Ne}`),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const Pe=window.tokenManager?.getDecodedToken()?.sub||"unknown",Re=`test_progress_${Pe}_${me}_${Ne}`;console.log(`[DEBUG] Removing localStorage key: ${Re}`);const Ct=j(Re)!==null;B(Re),i({}),c({});for(let Fe=0;Fe<localStorage.length;Fe++){const st=localStorage.key(Fe);st&&st.startsWith(`test_progress_${Pe}_${me}_${Ne}_`)&&(localStorage.removeItem(st),console.log(`[DEBUG] Cleared individual question key: ${st}`))}console.log(Ct?`[DEBUG] Progress cleared for test ${me}_${Ne}`:`[DEBUG] No progress found to clear for test ${me}_${Ne}`)}catch(Pe){console.error("Error clearing test progress:",Pe)}},L=async(me,Ne,Pe="")=>{try{w(!0),k(null),console.log("Submitting test:",{testType:me,testId:Ne});const Re=se(me,Ne);if(Object.keys(Re).length===0){k("Please answer at least one question before submitting.");return}let Ct;try{Ct=await hn.getTestInfo(me,Ne)}catch(zt){console.error("Error getting test info:",zt);const rr=await hn.getTestQuestions(me,Ne);Ct={test_name:`Test ${Ne}`,num_questions:rr.length}}const Fe=await hn.getTestQuestions(me,Ne),st=wf(Fe,Re,me),ke=Ct.num_questions,We=ie(Re,me),Qe={test_id:Ne,test_name:Ct.test_name,score:st,maxScore:ke,answers:We},Pt=await hn.submitTest(me,Ne,Qe);if(Pt.success){if(g(Pt.result),W(me,Ne,Pe),ne(me,Ne),Pe){const zt=`student_results_table_${Pe}`;me!=="drawing"?(console.log(" TestContext: Caching test results after submission with key:",zt),vs(zt,Pt.result,Is.student_results_table)):console.log(" TestContext: Skipping cache for drawing test submission (teacher-scored).")}return Pe&&Rm(Pe,me,Ne),d(!1),Pt.results}else throw new Error(Pt.message||"Test submission failed")}catch(Re){throw k(Re.message||"Failed to submit test"),Re}finally{w(!1)}},H=(me,Ne,Pe)=>{g({testType:me,testId:Ne,answers:Pe}),d(!1)},M=()=>{r(null),s([]),i({}),c({}),d(!1),g(null),k(null),P(null),A(0)},V=(me,Ne,Pe="")=>{try{const Re=`test_completed_${Pe}_${me}_${Ne}`;return j(Re)===!0}catch(Re){return console.error("Error checking test completion:",Re),!1}},W=(me,Ne,Pe="")=>{try{const Re=`test_completed_${Pe}_${me}_${Ne}`;I(Re,!0)}catch(Re){console.error("Error marking test completed:",Re)}},R=me=>Object.keys(a).length,U=()=>{const me=R(t?.testType),Ne=n.length;return{canSubmit:me===Ne,answeredCount:me,totalQuestions:Ne}},q=()=>{t&&ne(t.testType,t.testId),M()},Q=(me="")=>{try{const Ne=`student_results_table_${me}`;console.log(" TestContext: Clearing test results cache:",Ne),localStorage.removeItem(Ne),console.log(" TestContext: Test results cache cleared")}catch(Ne){console.error("Error clearing test results cache:",Ne)}},se=(me,Ne)=>({...a}),X=(me,Ne,Pe=null)=>{try{if(!me)return"No answer";switch(Ne){case"true_false":return me?"True":"False";case"multiple_choice":if(Pe&&typeof me=="string"&&!isNaN(parseInt(me))){const Re=parseInt(me),Ct=`option_${String.fromCharCode(97+Re)}`,Fe=Pe[Ct];if(Fe)return Fe}return String(me).toUpperCase();case"input":return String(me);case"matching_type":return typeof me=="object"?Object.entries(me).map(([Re,Ct])=>`${Re}  ${Ct}`).join(", "):String(me);case"word_matching":return typeof me=="object"?Object.entries(me).map(([Re,Ct])=>`${Re}  ${Ct}`).join(", "):String(me);case"drawing":return"Drawing submitted";default:return String(me)}}catch(Re){return console.error("Error formatting student answer:",Re),"Error displaying answer"}},ie=(me,Ne)=>{try{if(!me||typeof me!="object")return{};const Pe={};return Object.entries(me).forEach(([Re,Ct])=>{if(Ct!=null)switch(Ne){case"true_false":Pe[Re]=!!Ct;break;case"multiple_choice":Pe[Re]=String(Ct).toUpperCase();break;case"input":Pe[Re]=String(Ct).trim();break;case"matching_type":typeof Ct=="object"?Pe[Re]=Ct:Pe[Re]=String(Ct);break;case"word_matching":typeof Ct=="object"?Pe[Re]=Ct:Pe[Re]=String(Ct);break;case"drawing":Pe[Re]=Ct;break;default:Pe[Re]=Ct}}),Pe}catch(Pe){return console.error("Error transforming answers for submission:",Pe),me||{}}},le=S.useCallback(async(me="")=>{try{w(!0);const Ne=`student_active_tests_${me}`,Pe=Rs(Ne);if(Pe)return x(Pe),Pe;const Re=await hn.getActiveTests();return x(Re),vs(Ne,Re,Is.student_active_tests),Re}catch(Ne){return k(Ne.message||"Failed to load active tests"),x([]),[]}finally{w(!1)}},[]),ce=async()=>{try{return w(!0),await hn.getTeacherTests()}catch(me){return k(me.message||"Failed to load teacher tests"),[]}finally{w(!1)}},Se=async me=>{try{return w(!0),await hn.createTest(me)}catch(Ne){throw k(Ne.message||"Failed to create test"),Ne}finally{w(!1)}},re=async(me,Ne)=>{try{return w(!0),await hn.deleteTest(me,Ne)}catch(Pe){throw k(Pe.message||"Failed to delete test"),Pe}finally{w(!1)}},ge=async(me,Ne)=>{try{return await hn.getTestInfo(me,Ne)}catch(Pe){throw console.error("Error getting test info:",Pe),Pe}},Ee=async(me,Ne)=>{try{return await hn.getTestQuestions(me,Ne)}catch(Pe){throw console.error("Error getting test questions:",Pe),Pe}},Ae=async(me,Ne,Pe)=>{try{console.log("Showing test results:",{testType:me,testId:Ne,studentAnswers:Pe});const Re=await ge(me,Ne),Ct=await Ee(me,Ne);Rt(Re,Ct,me,Pe),d(!1),console.log("Test results displayed successfully")}catch(Re){console.error("Error showing test results:",Re),k("Failed to display test results"),g({testType:me,testId:Ne,answers:Pe,showResults:!0,error:"Could not load detailed results"}),d(!1)}},He=async(me,Ne,Pe)=>{try{w(!0);const Re=await ge(me,Ne),Ct=await Ee(me,Ne);Rt(Re,Ct,me,Pe)}catch(Re){k(Re.message||"Failed to load test results")}finally{w(!1)}},Be=S.useCallback(async(me="")=>{try{w(!0);const Ne=`student_results_table_${me}`;console.log(" TestContext: Checking cache for key:",Ne);const Pe=Rs(Ne);if(Pe)return console.log(" TestContext: Cache HIT! Using cached test results"),g(Pe),Pe;console.log(" TestContext: Cache MISS! Fetching from API");const Re=await hn.getStudentTestResults();return console.log(" TestContext: Test results loaded:",Re),console.log(" TestContext: Results data:",Re?.results||Re),console.log(" TestContext: Results length:",Re?.results?.length||0),g(Re),console.log(" TestContext: Caching test results with key:",Ne),console.log(" TestContext: Results being cached:",Re),console.log(" TestContext: Results.results being cached:",Re.results),vs(Ne,Re,Is.student_results_table),Re}catch(Ne){throw console.error("Error loading test results:",Ne),k(Ne.message||"Failed to load test results"),Ne}finally{w(!1)}},[]),Rt=(me,Ne,Pe,Re)=>{try{console.log("Displaying test results:",{testInfo:me,questions:Ne,testType:Pe,studentAnswers:Re});const Ct=wf(Ne,Re,Pe),Fe=me?.num_questions||Ne?.length||0,st=Fe>0?Math.round(Ct/Fe*100):0,ke=st>=60,We=Ne.map((Qe,Pt)=>{const zt=Qe.question_id||Qe.id,rr=Re[zt],xr=Sm(Qe,rr,Pe);return{questionNumber:Pt+1,question:Qe.question||Qe.question_text,userAnswer:X(rr,Pe),correctAnswer:Qy(Qe,Pe),isCorrect:xr,questionType:Pe}});g({testInfo:me,questions:Ne,testType:Pe,studentAnswers:Re,showResults:!0,score:Ct,totalQuestions:Fe,percentage:st,passed:ke,questionAnalysis:We,timestamp:new Date().toISOString()}),c(Qe=>({...Qe,score:Ct,totalQuestions:Fe,percentage:st,passed:ke,lastUpdated:Date.now()})),et(),console.log(`Test results displayed: ${Ct}/${Fe} (${st}%) - ${ke?"PASSED":"FAILED"}`)}catch(Ct){console.error("Error displaying test results:",Ct),k("Failed to display test results")}},et=S.useCallback(()=>{try{console.log("Setting up test results page event listeners");const me=Fe=>{if(Fe.key==="Escape"&&q(),Fe.ctrlKey&&Fe.key==="p"&&(Fe.preventDefault(),window.print()),Fe.key==="Enter"&&h&&!h.passed){const st=document.getElementById("retake-test-button");st&&st.click()}},Ne=()=>{window.print()},Pe=()=>{if(h){const Fe=`Test: ${h.testInfo?.test_name||"Test"}
Score: ${h.score}/${h.totalQuestions} (${h.percentage}%)
Status: ${h.passed?"PASSED":"FAILED"}
Completed: ${new Date(h.timestamp).toLocaleString()}`;navigator.clipboard.writeText(Fe).then(()=>{console.log("Results copied to clipboard")}).catch(st=>{console.error("Failed to copy results:",st)})}};document.addEventListener("keydown",me);const Re=document.getElementById("print-results");Re&&Re.addEventListener("click",Ne);const Ct=document.getElementById("copy-results");return Ct&&Ct.addEventListener("click",Pe),()=>{document.removeEventListener("keydown",me),Re&&Re.removeEventListener("click",Ne),Ct&&Ct.removeEventListener("click",Pe)}}catch(me){console.error("Error setting up test results page event listeners:",me)}},[q,h]),vt=async(me,Ne,Pe)=>{try{w(!0),k(null),console.log("Viewing test details:",{testType:me,testId:Ne,testName:Pe}),N({isOpen:!0,testType:me,testId:Ne,testName:Pe,questions:[],isLoading:!0});const Re=await hn.getTestQuestions(me,Ne);Re&&Re.length>0?(N({isOpen:!0,testType:me,testId:Ne,testName:Pe,questions:Re,isLoading:!1}),console.log(`Test details loaded: ${Re.length} questions`)):(k("Could not load test questions. Please try again."),N({isOpen:!0,testType:me,testId:Ne,testName:Pe,questions:[],isLoading:!1,error:"No questions available for this test"}))}catch(Re){console.error("Error loading test details:",Re),k("Error loading test details. Please try again."),N({isOpen:!0,testType:me,testId:Ne,testName:Pe,questions:[],isLoading:!1,error:Re.message||"Failed to load test details"})}finally{w(!1)}},xt=(me,Ne,Pe,Re)=>{try{console.log("Showing test details modal:",{testType:me,testId:Ne,testName:Pe,questions:Re}),N({isOpen:!0,testType:me,testId:Ne,testName:Pe,questions:Re||[],isLoading:!1,error:null})}catch(Ct){console.error("Error showing test details modal:",Ct),k("Failed to show test details modal")}},it=()=>{try{console.log("Closing test details modal"),N({isOpen:!1,testType:null,testId:null,testName:null,questions:[],isLoading:!1,error:null})}catch(me){console.error("Error closing test details modal:",me)}},ht=(me,Ne)=>{try{switch(Ne){case"multiple_choice":return l.jsxs("div",{className:"answer-options",children:[l.jsx("p",{children:l.jsx("strong",{children:"Options:"})}),l.jsxs("p",{children:["A) ",me.option_a||"No text"]}),l.jsxs("p",{children:["B) ",me.option_b||"No text"]}),me.option_c&&l.jsxs("p",{children:["C) ",me.option_c]}),me.option_d&&l.jsxs("p",{children:["D) ",me.option_d]}),me.option_e&&l.jsxs("p",{children:["E) ",me.option_e]}),me.option_f&&l.jsxs("p",{children:["F) ",me.option_f]}),l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",me.correct_answer||"Not specified"]})})]});case"true_false":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",me.correct_answer?"True":"False"]})})});case"input":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",me.correct_answer||"Not specified"]})})});case"matching_type":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",me.correct_answer?JSON.stringify(me.correct_answer):"Not specified"]})})});case"word_matching":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",me.correct_answer?JSON.stringify(me.correct_answer):"Not specified"]})})});default:return l.jsx("p",{children:"Unknown question type"})}}catch(Pe){return console.error("Error formatting question answer display:",Pe),l.jsx("p",{children:"Error displaying question"})}},Dt=(me,Ne)=>{try{console.log("Navigating to test:",{testType:me,testId:Ne}),r({testType:me,testId:Ne}),d(!0),Y(me,Ne)}catch(Pe){console.error("Error navigating to test:",Pe),k("Failed to navigate to test")}},Mt=()=>{try{console.log("Hiding test sections"),r(null),s([]),i({}),c({}),d(!1),g(null),k(null)}catch(me){console.error("Error hiding test sections:",me)}},Xe=(me,Ne,Pe,Re)=>{try{console.log("Displaying test on page:",{testInfo:me,questions:Ne,testType:Pe,testId:Re}),r({...me,testType:Pe,testId:Re}),s(Ne),d(!0),Z(Pe,Re),At(Pe,Re),tt(Pe,Re)}catch(Ct){console.error("Error displaying test on page:",Ct),k("Failed to display test on page")}},De=(me,Ne,Pe)=>{try{return console.log("Rendering questions for page:",{questions:me,testType:Ne,testId:Pe}),!me||!Array.isArray(me)?(console.warn("Invalid questions array for rendering"),[]):me.map((Re,Ct)=>{const Fe=st=>{const ke={...a,[Re.question_id]:st};i(ke),ae(Ne,Pe,Re.question_id,st)};return{question:Re,index:Ct,testType:Ne,testId:Pe,studentAnswer:a[Re.question_id]||"",onAnswerChange:Fe}})}catch(Re){return console.error("Error rendering questions for page:",Re),[]}},Le=S.useCallback((me,Ne)=>{try{if(!me||!Ne){console.warn("Cannot save progress: missing testType or testId");return}const Pe=`test_progress_${me}_${Ne}`,Re={answers:a,progress:o,lastSaved:Date.now(),testType:me,testId:Ne};I(Pe,Re),console.log(`Progress saved for test ${me}_${Ne}:`,Re)}catch(Pe){console.error("Error saving progress for page:",Pe)}},[a,o,I]),lt=S.useCallback(me=>{try{return!a||Object.keys(a).length===0?0:Object.values(a).filter(Pe=>Pe==null?!1:typeof Pe=="string"?Pe.trim()!=="":typeof Pe=="object"?Object.keys(Pe).length>0:!0).length}catch(Ne){return console.error("Error getting answered questions count for page:",Ne),0}},[a]),Ue=S.useCallback((me,Ne)=>{try{console.log("Updating progress display for page:",{testType:me,testId:Ne});const Pe=lt(me),Re=n.length,Ct=Re>0?Math.round(Pe/Re*100):0,Fe=Pe===Re&&Re>0;c(Qe=>({...Qe,answeredCount:Pe,totalQuestions:Re,percentage:Ct,canSubmit:Fe,remainingQuestions:Re-Pe,lastUpdated:Date.now()}));const st=document.getElementById("progress-bar"),ke=document.getElementById("progress-text"),We=document.getElementById("submit-test-button");return st&&(st.style.width=`${Ct}%`,st.className=st.className.replace(/bg-\w+-\d+/,""),Ct>=100?st.classList.add("bg-green-500"):Ct>=80?st.classList.add("bg-blue-500"):Ct>=60?st.classList.add("bg-yellow-500"):Ct>=40?st.classList.add("bg-orange-500"):st.classList.add("bg-red-500")),ke&&(ke.textContent=`${Pe}/${Re} questions answered (${Ct}%)`),We&&(We.disabled=!Fe,Fe?(We.textContent=" Submit Test",We.classList.remove("bg-gray-400"),We.classList.add("bg-green-600","hover:bg-green-700")):(We.textContent=` Complete ${Re-Pe} more question${Re-Pe!==1?"s":""}`,We.classList.remove("bg-green-600","hover:bg-green-700"),We.classList.add("bg-gray-400"))),{answeredCount:Pe,totalQuestions:Re,percentage:Ct,canSubmit:Fe}}catch(Pe){return console.error("Error updating progress display for page:",Pe),{answeredCount:0,totalQuestions:0,percentage:0,canSubmit:!1}}},[n.length,lt]),tt=S.useCallback((me,Ne)=>{try{console.log("Setting up test page event listeners:",{testType:me,testId:Ne});const Pe=setInterval(()=>{Object.keys(a).length>0&&(Le(me,Ne),console.log("Auto-saved progress for test:",me,Ne))},3e4),Re=setInterval(()=>{Ue(me,Ne)},2e3),Ct=Qe=>{Qe.key==="Escape"&&window.confirm("Are you sure you want to exit the test? Your progress will be saved.")&&q(),Qe.ctrlKey&&Qe.key==="s"&&(Qe.preventDefault(),Le(me,Ne),console.log("Manual save triggered")),Qe.key},Fe=Qe=>{Object.keys(a).length>0&&(Qe.preventDefault(),Qe.returnValue="Your test progress will be saved. Are you sure you want to leave?")},st=()=>{document.hidden&&(console.log("Tab became hidden - saving progress"),Le(me,Ne))},ke=()=>{console.log("Window focused - updating progress"),Ue(me,Ne)},We=()=>{console.log("Window blurred - saving progress"),Le(me,Ne)};return document.addEventListener("keydown",Ct),window.addEventListener("beforeunload",Fe),document.addEventListener("visibilitychange",st),window.addEventListener("focus",ke),window.addEventListener("blur",We),window.testIntervals||(window.testIntervals={}),window.testIntervals[`autosave_${me}_${Ne}`]=Pe,window.testIntervals[`progress_${me}_${Ne}`]=Re,()=>{clearInterval(Pe),clearInterval(Re),document.removeEventListener("keydown",Ct),window.removeEventListener("beforeunload",Fe),document.removeEventListener("visibilitychange",st),window.removeEventListener("focus",ke),window.removeEventListener("blur",We),window.testIntervals&&(delete window.testIntervals[`autosave_${me}_${Ne}`],delete window.testIntervals[`progress_${me}_${Ne}`])}}catch(Pe){console.error("Error setting up test page event listeners:",Pe)}},[a,Le,Ue,q]),Et=S.useCallback(()=>{try{const me=lt(t?.testType),Ne=n.length,Pe=me===Ne&&Ne>0,Re=document.getElementById("submit-test-button");return Re&&(Re.disabled=!Pe,Re.textContent=Pe?"Submit Test":`Complete ${Ne-me} more questions`),{canSubmit:Pe,answeredCount:me,totalQuestions:Ne}}catch(me){return console.error("Error updating submit button state for page:",me),{canSubmit:!1,answeredCount:0,totalQuestions:0}}},[t,n.length,lt]),At=S.useCallback((me,Ne)=>{try{console.log("Setting up progress tracking for page:",{testType:me,testId:Ne});const Pe=setInterval(()=>{Ue(me,Ne),Et()},1e3),Re=setInterval(()=>{Object.keys(a).length>0&&Le(me,Ne)},3e4);return window.testIntervals||(window.testIntervals={}),window.testIntervals[`progress_${me}_${Ne}`]=Pe,window.testIntervals[`autosave_${me}_${Ne}`]=Re,()=>{clearInterval(Pe),clearInterval(Re),window.testIntervals&&(delete window.testIntervals[`progress_${me}_${Ne}`],delete window.testIntervals[`autosave_${me}_${Ne}`])}}catch(Pe){console.error("Error setting up progress tracking for page:",Pe)}},[a,Ue,Et,Le]),qt=S.useCallback(async(me,Ne)=>{const Pe=document.getElementById("submit-test-button");try{const Re=lt(me),Ct=n.length;if(Re<Ct){k(`Please answer all ${Ct} questions before submitting.`);return}if(!window.confirm("Are you sure you want to submit your test? This action cannot be undone."))return;Pe&&(Pe.disabled=!0,Pe.innerHTML=`
          <div class="flex items-center justify-center space-x-2">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
            <span>Submitting...</span>
          </div>
        `),await L(me,Ne)&&(ne(me,Ne),H(me,Ne,a),console.log("Test submitted successfully!"))}catch(Re){console.error("Error submitting test from page:",Re),k("Failed to submit test. Please try again."),Pe&&(Pe.disabled=!1,Pe.textContent="Submit Test")}},[lt,n.length,L,ne,H,a]),pr=S.useCallback(()=>{try{if(!t)return null;const me=["true_false","multiple_choice","input","matching_type","word_matching"];return me.includes(t.testType)?t.testType:me.includes(t.test_type)?t.test_type:null}catch(me){return console.error("Error getting current test type:",me),null}},[t]),Rr=S.useCallback((me,Ne)=>{try{console.log("Clearing progress tracking interval:",{testType:me,testId:Ne});const Pe=`progress_interval_${me}_${Ne}`,Re=`autosave_interval_${me}_${Ne}`;window.testIntervals&&(window.testIntervals[Pe]&&(clearInterval(window.testIntervals[Pe]),delete window.testIntervals[Pe]),window.testIntervals[Re]&&(clearInterval(window.testIntervals[Re]),delete window.testIntervals[Re])),console.log(`Cleared progress tracking intervals for test ${me}_${Ne}`)}catch(Pe){console.error("Error clearing progress tracking interval:",Pe)}},[]),ir={currentTest:t,testQuestions:n,studentAnswers:a,testProgress:o,isTestActive:u,testResults:h,activeTests:p,isLoading:v,error:C,testDetailsModal:b,testStartTime:E,timeElapsed:F,loadTestForPage:Y,submitTest:L,navigateToTestResults:H,navigateBackToCabinet:M,clearTestDataAndReturnToCabinet:q,saveTestProgress:ae,getTestProgress:ee,clearTestProgress:ne,loadSavedProgressForPage:Z,isTestCompleted:V,markTestCompleted:W,markTestCompletedInUI:(me,Ne)=>{console.log("Marking test completed in UI:",{testType:me,testId:Ne}),W(me,Ne)},getAnsweredQuestionsCount:R,updateSubmitButtonState:U,updateSubmitButtonStateForPage:Et,loadStudentActiveTests:le,loadActiveTests:le,loadTeacherActiveTests:ce,getTestInfo:ge,getTestQuestions:Ee,createTest:Se,deleteTest:re,showTestResults:Ae,loadTestResults:Be,loadTestResultsForPage:He,displayTestResultsOnPage:Rt,setupTestResultsPageEventListeners:et,clearTestResultsCache:Q,viewTestDetails:vt,showTestDetailsModal:xt,closeTestDetailsModal:it,getQuestionAnswerDisplay:ht,navigateToTest:Dt,hideTestSections:Mt,displayTestOnPage:Xe,renderQuestionsForPage:De,setupTestPageEventListeners:tt,setupProgressTrackingForPage:At,updateProgressDisplayForPage:Ue,submitTestFromPage:qt,getAnsweredQuestionsCountForPage:lt,getCurrentTestType:pr,saveProgressForPage:Le,clearProgressTrackingInterval:Rr,collectTestAnswers:se,calculateTestScore:wf,checkAnswerCorrectness:Sm,formatStudentAnswerForDisplay:X,getCorrectAnswer:Qy,transformAnswersForSubmission:ie,clearAllTestData:()=>{try{console.log("Clearing old test data from localStorage (older than 15 days)...");const Ne=Date.now()-360*60*60*1e3,Pe=[];for(let Re=0;Re<localStorage.length;Re++){const Ct=localStorage.key(Re);if(!(!Ct||!((Ct.startsWith("test_")||Ct.startsWith("student_")||Ct.startsWith("teacher_")||Ct.startsWith("admin_")||Ct.includes("progress")||Ct.includes("answers"))&&!Ct.includes("test_completed_"))))try{const st=localStorage.getItem(Ct);if(!st){Pe.push(Ct);continue}let ke=null;if(st.startsWith("{")||st.startsWith("[")){const We=JSON.parse(st),Qe=We.timestamp||We.lastSaved||We.lastTickAt||We.createdAt||We.updatedAt||We.startedAt||We.started_at||We.created_at;Qe&&(ke=new Date(Qe).getTime())}if(!ke){const We=`${Ct}__ts`,Qe=localStorage.getItem(We);Qe&&(ke=parseInt(Qe)||null)}if(!ke)continue;ke<Ne&&Pe.push(Ct)}catch{continue}}return Pe.forEach(Re=>{console.log(`Removing old localStorage key: ${Re}`),B(Re)}),console.log(`Cleared ${Pe.length} old test-related items from localStorage`),{success:!0,clearedCount:Pe.length}}catch(me){return console.error("Error clearing old test data:",me),{success:!1,error:me.message}}},setCurrentTest:r,setTestQuestions:s,setStudentAnswers:i,setTestProgress:c,setIsTestActive:d,setTestResults:g,setError:k};return l.jsx(jB.Provider,{value:ir,children:e})},zv=()=>{const e=S.useContext(jB);if(!e)throw new Error("useTest must be used within a TestProvider");return e},ly=window.location.hostname==="mathayomwatsing.netlify.app";ly&&(console.log=()=>{},console.debug=()=>{},console.info=()=>{},console.warn=()=>{});const pe={debug:(e,...t)=>{ly||console.log(e,...t)},warn:(e,...t)=>{ly||console.warn(e,...t)},error:(e,...t)=>{console.error(e,...t)},info:(e,...t)=>{ly||console.info(e,...t)},isEnabled:()=>!ly},Wv=({testResults:e,onBackToCabinet:t,onRetakeTest:r,isLoading:n=!1,caught_cheating:s=!1,visibility_change_times:a=0})=>{if(!e||!e.showResults)return l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"text-center",children:l.jsx("p",{className:"text-gray-500",children:"No test results to display"})})});const{testInfo:i,testType:o,score:c,totalQuestions:u,percentage:d,passed:h,questionAnalysis:g,timestamp:p}=e,x=C=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[C]||C,v=C=>C>=80?"text-green-600 bg-green-50":C>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",w=C=>C?"text-green-600 bg-green-100 border-green-200":"text-red-600 bg-red-100 border-red-200";return n?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading test results..."})]})}):l.jsx("div",{className:"bg-gray-50 py-8 overflow-y-auto",children:l.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsxs(nt.div,{className:"bg-white rounded-lg shadow-lg p-6 mb-6",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(e?.caught_cheating||s)&&l.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mb-6",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsxs("p",{className:"text-sm text-red-700",children:[l.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",e?.visibility_change_times||a||0," times during the test."]})})]})}),l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Test Results"}),l.jsx("h2",{className:"text-xl text-gray-700 mb-1",children:i?.test_name||"Test"}),l.jsxs("p",{className:"text-sm text-gray-500",children:[x(o),"  Completed on ",new Date(p).toLocaleDateString()]})]}),l.jsx("div",{className:"text-right",children:l.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium border ${w(h)}`,children:h?" PASSED":" FAILED"})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900",children:c}),l.jsx("div",{className:"text-sm text-gray-600",children:"Correct Answers"})]}),l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900",children:u}),l.jsx("div",{className:"text-sm text-gray-600",children:"Total Questions"})]}),l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:`text-3xl font-bold ${v(d).split(" ")[0]}`,children:[d,"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Score"})]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-6",children:l.jsx(nt.div,{className:`h-3 rounded-full ${v(d).split(" ")[1]}`,initial:{width:0},animate:{width:`${d}%`},transition:{duration:1,ease:"easeOut"}})}),l.jsx("div",{className:"flex flex-wrap gap-3",children:l.jsx(Ye,{onClick:t,variant:"primary",className:"flex items-center gap-2",children:" Back to Cabinet"})})]}),o!=="matching_type"&&o!=="word_matching"&&l.jsxs(nt.div,{className:"bg-white rounded-lg shadow-lg p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Question Review"}),l.jsx("div",{className:"space-y-4",children:g.map((C,k)=>l.jsxs(nt.div,{className:`p-4 rounded-lg border-2 ${C.isCorrect?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:k*.1},children:[l.jsxs("div",{className:"flex items-start justify-between mb-3",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:["Question ",C.questionNumber]}),l.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${C.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:C.isCorrect?" Correct":" Incorrect"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Question:"}),l.jsx("p",{className:"text-gray-700 bg-gray-100 p-3 rounded",children:C.question})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Your Answer:"}),l.jsx("p",{className:`p-3 rounded ${C.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:C.userAnswer||"No answer provided"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Correct Answer:"}),l.jsx("p",{className:"bg-blue-100 text-blue-800 p-3 rounded",children:C.correctAnswer})]})]})]},k))})]}),l.jsxs(nt.div,{className:"bg-white rounded-lg shadow-lg p-6 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Summary Statistics"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:g.filter(C=>C.isCorrect).length}),l.jsx("div",{className:"text-sm text-blue-600",children:"Correct"})]}),l.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-red-600",children:g.filter(C=>!C.isCorrect).length}),l.jsx("div",{className:"text-sm text-red-600",children:"Incorrect"})]}),l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"text-2xl font-bold text-gray-600",children:[Math.round(g.filter(C=>C.isCorrect).length/u*100),"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Accuracy"})]}),l.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:u}),l.jsx("div",{className:"text-sm text-purple-600",children:"Total"})]})]})]})]})})},FB=({isOpen:e,onClose:t,testType:r,testId:n,testName:s,questions:a=[],isLoading:i=!1})=>{if(!e)return null;const o=h=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[h]||h,c=h=>({multiple_choice:"",true_false:"",input:"",matching_type:""})[h]||"",u=(h,g)=>{switch(g){case"multiple_choice":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),l.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[h.option_a&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"A"}),l.jsx("span",{className:"text-gray-700",children:h.option_a})]}),h.option_b&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"B"}),l.jsx("span",{className:"text-gray-700",children:h.option_b})]}),h.option_c&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"C"}),l.jsx("span",{className:"text-gray-700",children:h.option_c})]}),h.option_d&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"D"}),l.jsx("span",{className:"text-gray-700",children:h.option_d})]}),h.option_e&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"E"}),l.jsx("span",{className:"text-gray-700",children:h.option_e})]}),h.option_f&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),l.jsx("span",{className:"text-gray-700",children:h.option_f})]})]})]});case"true_false":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"T"}),l.jsx("span",{className:"text-gray-700",children:"True"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),l.jsx("span",{className:"text-gray-700",children:"False"})]})]})]});case"input":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Answer Format:"}),l.jsx("div",{className:"bg-gray-100 p-3 rounded",children:l.jsx("span",{className:"text-gray-600 italic",children:"Type your answer in the text input field"})})]});case"matching_type":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Instructions:"}),l.jsx("div",{className:"bg-gray-100 p-3 rounded",children:l.jsx("span",{className:"text-gray-600 italic",children:"Match the items by connecting them with lines or selecting pairs"})})]});default:return null}},d=(h,g)=>{if(!h.correct_answer)return null;let p="";switch(g){case"multiple_choice":p=h.correct_answer.toUpperCase();break;case"true_false":p=h.correct_answer?"True":"False";break;case"input":p=h.correct_answer;break;case"matching_type":p=typeof h.correct_answer=="object"?JSON.stringify(h.correct_answer):h.correct_answer;break;default:p=String(h.correct_answer)}return l.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded",children:[l.jsx("p",{className:"font-medium text-green-800 mb-1",children:"Correct Answer:"}),l.jsx("p",{className:"text-green-700 font-mono",children:p})]})};return l.jsx(wo,{children:l.jsxs(nt.div,{className:"fixed inset-0 z-50 overflow-y-auto",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[l.jsx(nt.div,{className:"fixed inset-0 bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t}),l.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:l.jsxs(nt.div,{className:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.3},children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("span",{className:"text-2xl",children:c(r)}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s||"Test Details"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[o(r),"  ",a.length," Questions"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ye,{onClick:()=>window.print(),variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Print"}),l.jsx(Ye,{onClick:t,variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Close"})]})]}),l.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:i?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading test details..."})]})}):a.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Questions Available"}),l.jsx("p",{className:"text-gray-500",children:"This test doesn't have any questions yet."})]}):l.jsx("div",{className:"space-y-6",children:a.map((h,g)=>l.jsxs(nt.div,{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:g*.1,duration:.3},children:[l.jsx("div",{className:"flex items-start justify-between mb-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full",children:["Question ",g+1]}),l.jsx("span",{className:"text-gray-500 text-sm",children:o(r)})]})}),l.jsx("div",{className:"mb-4",children:l.jsx("p",{className:"text-gray-800 font-medium text-lg leading-relaxed",children:h.question||h.question_text})}),u(h,r),d(h,r)]},h.id||h.question_id||g))})}),l.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[l.jsx("div",{className:"text-sm text-gray-600",children:a.length>0&&l.jsxs("span",{children:["Showing ",a.length," question",a.length!==1?"s":""]})}),l.jsx("div",{className:"flex items-center space-x-3",children:l.jsx(Ye,{onClick:t,variant:"primary",className:"flex items-center space-x-2",children:"Close"})})]})]})})]})})},lae=({answeredCount:e=0,totalQuestions:t=0,timeElapsed:r=0,onSubmitTest:n,isSubmitting:s=!1,canSubmit:a=!1,className:i=""})=>{const o=t>0?Math.round(e/t*100):0,c=t-e,u=g=>{const p=Math.floor(g/3600),x=Math.floor(g%3600/60),v=g%60;return p>0?`${p}:${x.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}`:`${x}:${v.toString().padStart(2,"0")}`},d=g=>g>=100?"bg-green-500":g>=80?"bg-blue-500":g>=60?"bg-yellow-500":g>=40?"bg-orange-500":"bg-red-500",h=g=>g>=100?"text-green-600":g>=80?"text-blue-600":g>=60?"text-yellow-600":g>=40?"text-orange-600":"text-red-600";return l.jsxs("div",{className:`bg-white rounded-lg shadow-lg p-6 ${i}`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Progress"}),l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-2xl",children:""}),l.jsx("span",{className:"text-sm font-mono text-gray-600",children:u(r)})]})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),l.jsxs("span",{className:`text-sm font-semibold ${h(o)}`,children:[o,"%"]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:l.jsx(nt.div,{className:`h-full ${d(o)} transition-colors duration-300`,initial:{width:0},animate:{width:`${o}%`},transition:{duration:.5,ease:"easeOut"}})})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 mb-4",children:[l.jsxs("div",{className:"text-center p-2 sm:p-3 bg-blue-50 rounded-lg",children:[l.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:e}),l.jsx("div",{className:"text-xs text-blue-600",children:"Answered"})]}),l.jsxs("div",{className:"text-center p-2 sm:p-3 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-600",children:c}),l.jsx("div",{className:"text-xs text-gray-600",children:"Remaining"})]}),l.jsxs("div",{className:"text-center p-2 sm:p-3 bg-purple-50 rounded-lg",children:[l.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:t}),l.jsx("div",{className:"text-xs text-purple-600",children:"Total"})]})]}),l.jsx("div",{className:"mb-4",children:e===t?l.jsx(nt.div,{className:"flex items-center justify-center p-3 bg-green-50 border border-green-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:l.jsx("span",{className:"text-green-600 font-medium",children:" All questions answered! Ready to submit."})}):c===1?l.jsx(nt.div,{className:"flex items-center justify-center p-3 bg-yellow-50 border border-yellow-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:l.jsx("span",{className:"text-yellow-600 font-medium",children:"Almost there! 1 question remaining."})}):l.jsx("div",{className:"flex items-center justify-center p-3 bg-gray-50 border border-gray-200 rounded-lg",children:l.jsxs("span",{className:"text-gray-600 font-medium",children:[c," questions remaining"]})})}),a&&l.jsx("div",{className:"flex justify-center",children:l.jsx(nt.button,{onClick:n,disabled:s,className:`px-8 py-3 rounded-lg font-semibold text-white transition-all duration-300 ${s?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 shadow-lg hover:shadow-xl"}`,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},children:s?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l.jsx("span",{children:"Submitting..."})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Submit Test"})]})})})]})},cae=({testText:e,blanks:t,separateType:r=!0,testId:n,testName:s="Unknown Test",teacherId:a="Unknown Teacher",subjectId:i,onTestComplete:o,onAnswerChange:c})=>{if(console.log(" FillBlanksTestStudent Props Debug:"),console.log("- testText:",e),console.log("- blanks:",t),console.log("- separateType:",r),console.log("- testId:",n),console.log("- testName:",s),console.log("- teacherId:",a),console.log("- subjectId:",i),!e||!t||!Array.isArray(t))return console.log(" FillBlanksTestStudent: Missing test data"),l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(Nt,{className:"max-w-md w-full",children:l.jsxs(Nt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load fill blanks test data"}),l.jsx(Ye,{onClick:()=>window.history.back(),variant:"primary",children:"Back to Dashboard"})]})})});const[u,d]=S.useState({}),[h,g]=S.useState(!1),[p,x]=S.useState(null),[v,w]=S.useState(null),[C,k]=S.useState(!1),[b,N]=S.useState(null),{showNotification:E}=za(),{makeAuthenticatedRequest:P}=Qo(),{user:F}=cs(),{startTracking:A,stopTracking:j,getCheatingData:I,clearData:B}=Xm("fill_blanks",n,F?.student_id||F?.id);t2();const Y=S.useCallback((ne,L)=>{try{let H=ne;if(typeof ne=="string"&&ne.startsWith("{"))try{const R=JSON.parse(ne);R.root&&R.root.children&&(H=R.root.children.map(U=>U.children?U.children.map(q=>q.style&&q.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":q.text||"").join(""):"").join(" "))}catch(R){console.error("Error parsing Lexical JSON:",R)}let M=H;L.forEach((R,U)=>{const q=`[${U+1}_________]`;M=M.replace("[BLANK_PLACEHOLDER]",q)});const W=M.split(/(\[\d+_________\])/).map((R,U)=>R.match(/\[\d+_________\]/)?l.jsx("span",{className:"inline-block px-3 py-1 mx-1 bg-purple-100 text-purple-800 border-2 border-purple-400 rounded-lg font-mono font-bold shadow-sm",children:R},U):l.jsx("span",{children:R},U));return l.jsx("div",{className:"prose max-w-none mb-6",children:l.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:W})})}catch(H){return console.error("Error rendering text with blanks:",H),l.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[]),Z=S.useCallback((ne,L)=>{try{let H=ne;if(typeof ne=="string"&&ne.startsWith("{"))try{const R=JSON.parse(ne);R.root&&R.root.children&&(H=R.root.children.map(U=>U.children?U.children.map(q=>q.style&&q.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":q.text||"").join(""):"").join(" "))}catch(R){console.error("Error parsing Lexical JSON:",R)}const M=[];L.forEach((R,U)=>{const q=u[R.id],Q=q?R.options[q.charCodeAt(0)-65]:null,se=Q?l.jsx("span",{className:"inline-block px-3 py-2 bg-green-100 text-green-800 rounded-lg border-2 border-green-400 cursor-pointer hover:bg-green-200 hover:border-green-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>w(R.id),children:Q},U):l.jsxs("span",{className:"inline-block px-3 py-2 bg-purple-100 text-purple-800 rounded-lg border-2 border-purple-400 cursor-pointer hover:bg-purple-200 hover:border-purple-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>w(R.id),children:[U+1,"_________"]},U);M.push(se),H=H.replace("[BLANK_PLACEHOLDER]",`__BLANK_${R.id}__`)});const V=H.split(/__BLANK_\d+__/),W=[];for(let R=0;R<V.length;R++)V[R]&&W.push(l.jsx("span",{children:V[R]},`text-${R}`)),R<M.length&&W.push(M[R]);return l.jsx("div",{className:"prose max-w-none mb-6",children:l.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:W})})}catch(H){return console.error("Error rendering text with inline blanks:",H),l.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[u]),ae=S.useCallback((ne,L)=>{const H={...u,[ne]:L};d(H),c&&c(ne,L)},[u,c]),ee=S.useCallback(ne=>l.jsx("div",{className:"space-y-6",children:ne.map((L,H)=>{const M=L.blank_options||L.options||[];L.correct_answers;const V=L.question_json||L.question||`Blank ${H+1}`;return console.log(` Blank ${H+1} question text:`,V),l.jsxs(Nt,{className:"p-4",children:[l.jsxs("div",{className:"mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",H+1]}),l.jsx("p",{className:"text-gray-600 mb-4",children:V})]}),l.jsx("div",{className:"space-y-3",children:M.filter(W=>W&&W.trim().length>0).map((W,R)=>l.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-gray-50 p-2 rounded-lg transition-colors",children:[l.jsx("input",{type:"radio",name:`blank_${L.question_id||L.id||H}`,value:String.fromCharCode(65+R),checked:u[L.question_id||L.id||H]===String.fromCharCode(65+R),onChange:U=>ae(L.question_id||L.id||H,U.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),l.jsxs("span",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+R)}),l.jsx("span",{className:"text-gray-700",children:W})]})]},R))})]},L.question_id||L.id||H)})}),[u,ae]);return S.useEffect(()=>{if(n&&F?.student_id){x(new Date),A(),console.log(" Anti-cheating tracking started for fill blanks test");const L=`test_progress_${F.student_id}_fill_blanks_${n}`,H=Rs(L);H&&(d(H.answers||{}),x(new Date(H.startTime)),console.log(" Fill blanks test progress restored:",H))}},[n,F?.student_id,t,A]),S.useEffect(()=>{if(p&&F?.student_id&&n){const ne=setInterval(()=>{const L={answers:u,startTime:p.toISOString()},H=`test_progress_${F.student_id}_fill_blanks_${n}`;vs(H,L,Is.test_progress),console.log(" Fill blanks progress auto-saved")},3e4);return()=>clearInterval(ne)}},[p,u,F?.student_id,n]),S.useEffect(()=>()=>{j(),B(),console.log(" Fill blanks test component unmounted - anti-cheating cleanup")},[j,B]),S.useCallback(async()=>{g(!0);try{const ne=t.length;let L=0;t.forEach((ge,Ee)=>{const Ae=u[ge.id];Ae&&Ae===ge.correct_answer&&L++});const H=L,M=ne;console.log(` Fill Blanks Score: ${H}/${M} (${Math.round(H/M*100)}%)`);const V=new Date,W=p?Math.round((V-p)/1e3):0,R=p?p.toISOString():V.toISOString(),U=I();console.log(" Anti-cheating data for fill blanks submission:",U);const q=F.student_id,Q=`retest_assignment_id_${q}_fill_blanks_${n}`,se=localStorage.getItem(Q),{academicCalendarService:X}=await Zi(async()=>{const{academicCalendarService:ge}=await Promise.resolve().then(()=>n2);return{academicCalendarService:ge}},void 0);await X.loadAcademicCalendar();const le=X.getCurrentTerm()?.id;if(!le)throw new Error("No current academic period found");const ce={test_id:n,test_name:s,teacher_id:a||null,subject_id:i||null,student_id:q,academic_period_id:le,parent_test_id:n,retest_assignment_id:se?Number(se):null,answers:u,score:H,maxScore:M,time_taken:W,started_at:R,submitted_at:V.toISOString(),caught_cheating:U.caught_cheating,visibility_change_times:U.visibility_change_times};console.log(" Submitting fill blanks test:",ce);const re=await(await P("/.netlify/functions/submit-fill-blanks-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ce)})).json();if(re.success){if(E("Test submitted successfully!","success"),j(),B(),console.log(" Anti-cheating tracking stopped and data cleared for fill blanks test"),F?.student_id&&(Rm(F.student_id,"fill_blanks",n),console.log(" Fill blanks test data cleared from cache")),F?.student_id){const ge=`test_completed_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(ge,"true"),console.log(" Fill blanks test marked as completed in localStorage:",ge);const Ee=`retest1_${q}_fill_blanks_${n}`;localStorage.removeItem(Ee),localStorage.removeItem(Q)}if(F?.student_id){const ge=`student_results_table_${F.student_id}`;vs(ge,re,Is.student_results_table),console.log(" Fill blanks test results cached with key:",ge)}setShowSubmitModal(!1),setTimeout(()=>{o&&o(H)},2e3)}else throw new Error(re.message||"Failed to submit test")}catch(ne){console.error("Error submitting test:",ne),E("Error submitting test. Please try again.","error")}finally{g(!1)}},[u,t,n,s,a,i,p,I,j,B,P,E,o,F]),l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:l.jsxs(Nt,{children:[h&&l.jsx(Nt.Header,{children:l.jsx("div",{className:"flex items-center justify-center",children:l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[l.jsx(zr,{size:"small"}),l.jsx("span",{children:"Submitting..."})]})})}),l.jsx(Nt.Body,{children:r===!0?l.jsxs(l.Fragment,{children:[Y(e,t),ee(t)]}):l.jsx(l.Fragment,{children:Z(e,t)})}),r===!1&&v&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Select Answer"}),l.jsx("div",{className:"space-y-2",children:t.find(ne=>ne.id===v)?.options.filter(ne=>ne.trim().length>0).map((ne,L)=>l.jsxs("button",{onClick:()=>{ae(v,String.fromCharCode(65+L)),w(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-100 rounded-lg border border-gray-200",children:[l.jsxs("span",{className:"font-semibold text-blue-600 mr-2",children:[String.fromCharCode(65+L),")"]}),ne]},L))}),l.jsx("div",{className:"mt-4 flex justify-end",children:l.jsx(Ye,{onClick:()=>w(null),variant:"secondary",size:"sm",children:"Cancel"})})]})}),l.jsx(Nt.Footer,{children:l.jsx("div",{className:"flex gap-3"})})]})})};let uae=class{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}setToken(t){localStorage.setItem(this.tokenKey,t)}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){this.setToken(t),this.setUserData({role:r}),localStorage.setItem("accessToken",t)}isAuthenticated(){const t=this.getToken();if(!t)return!1;try{const r=JSON.parse(atob(t.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const t=this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(t,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json();return this.setToken(n.accessToken),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(t){try{return JSON.parse(atob(t.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}};const km=new uae;window.tokenManager=km;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{km.init()}):km.init());const OB=async(e,t,r,n,s=!1)=>{try{console.log(" Fetching teacher student results:",{teacherId:e,grade:t,className:r,termId:n,forceRefresh:s});const a=s?`&_t=${Date.now()}`:"",o=await(await km.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-student-results?teacher_id=${e}&grade=${t}&class=${r}&academic_period_id=${n}${a}`,{cache:s?"no-cache":"default",headers:s?{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"}:{}})).json();if(o.success)return console.log(" Teacher student results loaded:",o.results.length,"results"),console.log(" Students loaded:",o.students?.length||0,"students"),{success:!0,results:o.results,students:o.students||[],count:o.results.length,student_count:o.student_count||0};throw new Error(o.error||"Failed to load teacher student results")}catch(a){return console.error("Error fetching teacher student results:",a),{success:!1,error:a.message,results:[]}}},DB=async(e,t)=>{try{console.log(" Fetching student results view:",{studentId:e,academicPeriodId:t});const r=t?`&academic_period_id=${t}`:"",s=await(await km.makeAuthenticatedRequest(`/.netlify/functions/get-student-results-view?student_id=${e}${r}`)).json();if(s.success)return console.log(" Student results view loaded:",s.results.length,"results"),{success:!0,results:s.results,count:s.results.length};throw new Error(s.error||"Failed to load student results view")}catch(r){return console.error("Error fetching student results view:",r),{success:!1,error:r.message,results:[]}}},dae=async(e,t,r,n)=>{try{console.log(" Fetching class summary:",{teacherId:e,grade:t,className:r,academicPeriodId:n});const a=await(await km.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary?teacher_id=${e}&grade=${t}&class=${r}&academic_period_id=${n}`)).json();if(a.success)return console.log(" Class summary loaded:",a.summary),{success:!0,summary:a.summary,hasData:!!a.summary};throw new Error(a.error||"Failed to load class summary")}catch(s){return console.error("Error fetching class summary:",s),{success:!1,error:s.message,summary:null}}},fae=async(e,t,r,n,s={})=>{try{const a=await OB(e,t,r,n);if(!a.success)return a;let i=a.results;return s.subject&&(i=i.filter(o=>o.subject&&o.subject.toLowerCase().includes(s.subject.toLowerCase()))),s.testType&&(i=i.filter(o=>o.test_type===s.testType)),s.minScore!==void 0&&(i=i.filter(o=>o.score/o.max_score*100>=s.minScore)),s.maxScore!==void 0&&(i=i.filter(o=>o.score/o.max_score*100<=s.maxScore)),s.passed!==void 0&&(i=i.filter(o=>o.score>=o.passing_score===s.passed)),{success:!0,results:i,count:i.length,originalCount:a.results.length}}catch(a){return console.error("Error filtering teacher student results:",a),{success:!1,error:a.message,results:[]}}},hae=async(e,t,r={})=>{try{const n=await DB(e,t);if(!n.success)return n;let s=n.results;return r.subject&&(s=s.filter(a=>a.subject&&a.subject.toLowerCase().includes(r.subject.toLowerCase()))),r.testType&&(s=s.filter(a=>a.test_type===r.testType)),r.semester&&(s=s.filter(a=>a.semester===r.semester)),r.passed!==void 0&&(s=s.filter(a=>a.score>=a.passing_score===r.passed)),{success:!0,results:s,count:s.length,originalCount:n.results.length}}catch(n){return console.error("Error filtering student results view:",n),{success:!1,error:n.message,results:[]}}},gae={getTeacherStudentResults:OB,getStudentResultsView:DB,getClassSummary:dae,getTeacherStudentResultsFiltered:fae,getStudentResultsViewFiltered:hae};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mae=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),pae=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),xF=e=>{const t=pae(e);return t.charAt(0).toUpperCase()+t.slice(1)},IB=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),xae=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var yae={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vae=S.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},c)=>S.createElement("svg",{ref:c,...yae,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:IB("lucide",s),...!a&&!xae(o)&&{"aria-hidden":"true"},...o},[...i.map(([u,d])=>S.createElement(u,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qm=(e,t)=>{const r=S.forwardRef(({className:n,...s},a)=>S.createElement(vae,{ref:a,iconNode:t,className:IB(`lucide-${mae(xF(e))}`,`lucide-${e}`,n),...s}));return r.displayName=xF(e),r};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wae=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],bae=Qm("download",wae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ae=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Sae=Qm("maximize-2",_ae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kae=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Cae=Qm("rotate-cw",kae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tae=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],RB=Qm("x",Tae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eae=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Nae=Qm("zoom-in",Eae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aae=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],jae=Qm("zoom-out",Aae),Jl={WIDTH:1536,HEIGHT:2048,ASPECT_RATIO:1536/2048},MB={MIN:.25,MAX:1,INITIAL:.25,STEP:.1},Sh={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",ERASER:"eraser"},yF={CURSOR_COLOR:"#ff0000",CURSOR_OPACITY:.3},vF={ERASER_TO_THICKNESS_RATIO:2.5,THICKNESS_TO_ERASER_RATIO:.4},Ib={MAX_ENTRIES:10,MAX_MEMORY_KB:500,COMPRESSION_THRESHOLD:200},LB=e=>{try{const t=JSON.stringify(e);return new Blob([t]).size/1024}catch(t){return console.warn("Error calculating memory usage:",t),0}},Pae=e=>Array.isArray(e)?e.map(t=>Array.isArray(t)?Fae(t):t):e,Fae=e=>{if(e.length<=2)return e;const t=[e[0]],r=2;for(let n=1;n<e.length-1;n++){const s=e[n-1],a=e[n];e[n+1],Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))>r&&t.push(a)}return t.push(e[e.length-1]),t},Oae=(e,t=Date.now())=>{const r=LB(e);return{data:[...e],timestamp:t,memoryUsage:r,compressed:r>Ib.COMPRESSION_THRESHOLD}},wF=(e,t,r)=>{const n=Oae(t),s=LB(t),a=e.slice(0,r+1);a.push(n);let i=a;return s>Ib.MAX_MEMORY_KB&&(i=Dae(a)),i.length>Ib.MAX_ENTRIES&&(i=i.slice(-10)),{history:i,index:i.length-1}},Dae=e=>e.map(t=>t.memoryUsage>Ib.COMPRESSION_THRESHOLD?{...t,data:Pae(t.data),compressed:!0}:t),bF=(e,t)=>{if(t<0||t>=e.length)return[];const r=e[t];return r?r.compressed?Iae(r.data):[...r.data]:[]},Iae=e=>[...e],_F=e=>e>0,SF=(e,t)=>e<t-1,Rae=()=>({history:[],index:-1}),Mae=()=>{const[e,t]=S.useState({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null}),[r,n]=S.useState([]),[s,a]=S.useState([]),i=S.useCallback(E=>{t(P=>({...P,...E}))},[]),o=S.useCallback(()=>{t({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null})},[]),c=S.useCallback(E=>{const P={x:E.x,y:E.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(F=>({...F,isDrawing:!0,currentLine:[P]})):["line","rectangle","circle"].includes(e.currentTool)&&t(F=>({...F,isDrawing:!0,currentShape:{type:e.currentTool,startX:E.x,startY:E.y,endX:E.x,endY:E.y,color:e.currentColor,thickness:e.currentThickness}}))},[e.currentTool,e.currentColor,e.currentThickness]),u=S.useCallback(E=>{if(!e.isDrawing)return;const P={x:E.x,y:E.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(F=>({...F,currentLine:[...F.currentLine,P]})):e.currentShape&&t(F=>({...F,currentShape:{...F.currentShape,endX:E.x,endY:E.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape]),d=S.useCallback(()=>{if(!e.isDrawing)return;let E=r;if(e.currentTool==="pencil"&&e.currentLine.length>0?(E=[...r,e.currentLine],n(E)):e.currentShape&&(E=[...r,e.currentShape],n(E)),E!==r){const P=wF(e.drawingHistory,E,e.historyIndex);t(F=>({...F,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:P.history,historyIndex:P.index}))}else t(P=>({...P,isDrawing:!1,currentLine:[],currentShape:null}))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape,r,e.drawingHistory,e.historyIndex]),h=S.useCallback(E=>Math.round(E*vF.ERASER_TO_THICKNESS_RATIO),[]),g=S.useCallback(E=>Math.round(E*vF.THICKNESS_TO_ERASER_RATIO),[]),p=S.useCallback(E=>{t(P=>({...P,currentThickness:E,eraserSize:h(E)}))},[h]),x=S.useCallback(E=>{t(P=>({...P,eraserSize:E,currentThickness:g(E)}))},[g]),v=S.useCallback(E=>{const P=wF(e.drawingHistory,E,e.historyIndex);t(F=>({...F,drawingHistory:P.history,historyIndex:P.index}))},[e.drawingHistory,e.historyIndex]),w=S.useCallback(()=>{if(_F(e.historyIndex)){const E=e.historyIndex-1,P=bF(e.drawingHistory,E);n([...P]),t(F=>({...F,historyIndex:E}))}},[e.historyIndex,e.drawingHistory]),C=S.useCallback(()=>{if(SF(e.historyIndex,e.drawingHistory.length)){const E=e.historyIndex+1,P=bF(e.drawingHistory,E);n([...P]),t(F=>({...F,historyIndex:E}))}},[e.historyIndex,e.drawingHistory]),k=S.useCallback(()=>{const E=Rae();t(P=>({...P,drawingHistory:E.history,historyIndex:E.index}))},[]),b=_F(e.historyIndex),N=SF(e.historyIndex,e.drawingHistory.length);return{drawingState:e,setDrawingState:t,drawingData:r,setDrawingData:n,textBoxes:s,setTextBoxes:a,updateDrawingState:i,resetDrawingState:o,startDrawing:c,continueDrawing:u,finishDrawing:d,handleThicknessChange:p,handleEraserSizeChange:x,saveToHistoryState:v,undo:w,redo:C,clearHistoryState:k,canUndoState:b,canRedoState:N}},kF={SCALE_DELTA:.05,CENTER_DELTA:20},em=e=>{if(e.length<2)return 0;const t=e[0],r=e[1];return Math.sqrt(Math.pow(r.clientX-t.clientX,2)+Math.pow(r.clientY-t.clientY,2))},af=e=>{if(e.length<2)return null;const t=e[0],r=e[1];return{x:(t.clientX+r.clientX)/2,y:(t.clientY+r.clientY)/2}},Lae=(e,t)=>{if(e.length!==2||!t)return null;const r=em(e),n=em(t),s=af(e),a=af(t);if(n===0)return null;const i=Math.abs(r/n-1),o=Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2));return i>kF.SCALE_DELTA?"zoom":o>kF.CENTER_DELTA?"pan":null},Bae=e=>{let t;return function(){const r=arguments,n=this;t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{e.apply(n,r),t=null})}},Hg=(e,t)=>{const r=t.getPointerPosition();return{x:(r.x-t.x())/t.scaleX(),y:(r.y-t.y())/t.scaleY()}},dl={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",PAN:"pan"},Rb={color:"#000000",thickness:2},CF=(e,t,r)=>({x:e.x,y:e.y,color:t||Rb.color,thickness:r||Rb.thickness}),$ae=(e,t,r,n,s)=>({type:e,startX:t.x,startY:t.y,endX:r.x,endY:r.y,color:n||Rb.color,thickness:s||Rb.thickness}),BB=(e,t,r,n,s,a)=>{const i=e-r,o=t-n,c=s-r,u=a-n,d=i*c+o*u,h=c*c+u*u;let g=-1;h!==0&&(g=d/h);let p,x;g<0?(p=r,x=n):g>1?(p=s,x=a):(p=r+g*c,x=n+g*u);const v=e-p,w=t-x;return Math.sqrt(v*v+w*w)},Uae=(e,t)=>{if(t.length===0)return[e];const r=t.sort((a,i)=>a.index-i.index),n=[];let s=0;for(const a of r)a.index>s&&n.push(e.slice(s,a.index+1)),s=a.index+1;return s<e.length&&n.push(e.slice(s)),n.filter(a=>a.length>0)},zae=(e,t,r,n)=>{const s=[],a=r/2;for(let i=0;i<n.length-1;i++){const o=n[i],c=n[i+1],u=BB(e,t,o.x,o.y,c.x,c.y);u<=a&&s.push({index:i,point:{x:o.x,y:o.y},distance:u})}return s},Wae=(e,t,r,n)=>{const s=zae(t,r,n,e);return s.length===0?[e]:Uae(e,s)},Hae=(e,t,r,n)=>{if(n.type==="rectangle"){const s=Math.min(n.startX,n.endX),a=Math.min(n.startY,n.endY),i=Math.abs(n.endX-n.startX),o=Math.abs(n.endY-n.startY);return e>=s&&e<=s+i&&t>=a&&t<=a+o}else if(n.type==="circle"){const s=(n.startX+n.endX)/2,a=(n.startY+n.endY)/2,i=Math.sqrt(Math.pow(n.endX-n.startX,2)+Math.pow(n.endY-n.startY,2))/2;return Math.sqrt(Math.pow(e-s,2)+Math.pow(t-a,2))<=i}return!1},TF=(e,t,r,n)=>{const s=[];for(const a of n)if(Array.isArray(a)){const i=Wae(a,e,t,r);s.push(...i)}else a.type==="line"?BB(e,t,a.startX,a.startY,a.endX,a.endY)>r/2&&s.push(a):(a.type==="rectangle"||a.type==="circle")&&(Hae(e,t,r,a)||s.push(a));return s},Gae=(e,t,r,n,s,a,i,o,c)=>{const[u,d]=S.useState({isActive:!1,type:null,lastDistance:null,lastCenter:null}),h=S.useCallback(P=>{if(P.evt.preventDefault(),P.evt.stopPropagation(),e.currentTool===dl.PAN)return;const F=P.target.getStage(),A=Hg(P,F),j=CF(A,e.currentColor,e.currentThickness);e.currentTool===dl.PENCIL?t(I=>({...I,isDrawing:!0,currentLine:[j]})):[dl.LINE,dl.RECTANGLE,dl.CIRCLE].includes(e.currentTool)&&t(I=>({...I,isDrawing:!0,currentShape:$ae(e.currentTool,A,A,e.currentColor,e.currentThickness)}))},[e.currentTool,e.currentColor,e.currentThickness,t]),g=S.useCallback(P=>{const F=TF(P.x,P.y,e.eraserSize,r);n(F),s(F)},[e.eraserSize,r,n,s]),p=S.useCallback(P=>{o&&(a(),v("Undo",P))},[o,a]),x=S.useCallback(P=>{c&&(i(),v("Redo",P))},[c,i]),v=S.useCallback((P,F)=>{const A=F.target.getStage(),j=Hg(F,A),I=new Konva.Circle({x:j.x,y:j.y,radius:20,stroke:"#4CAF50",strokeWidth:3,opacity:.8,listening:!1});A.add(I),I.to({scaleX:2,scaleY:2,opacity:0,duration:.3,onFinish:()=>{I.destroy()}})},[]),w=S.useCallback(P=>{if(P.evt.preventDefault(),P.evt.stopPropagation(),!e.isDrawing)return;const F=P.target.getStage(),A=Hg(P,F),j=CF(A,e.currentColor,e.currentThickness);e.currentTool===dl.PENCIL?t(I=>({...I,currentLine:[...I.currentLine,j]})):e.currentShape&&t(I=>({...I,currentShape:{...I.currentShape,endX:A.x,endY:A.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape,t]),C=S.useCallback(P=>{P&&P.evt&&(P.evt.preventDefault(),P.evt.stopPropagation()),e.isDrawing&&(e.currentTool===dl.PENCIL&&e.currentLine.length>0?n(F=>[...F,e.currentLine]):e.currentShape&&n(F=>[...F,e.currentShape]),t(F=>({...F,isDrawing:!1,currentLine:[],currentShape:null})))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape,n,t]),k=S.useCallback(P=>{P.evt.preventDefault(),P.evt.stopPropagation();const F=P.evt.touches;if(F.length===2)d({isActive:!0,type:"pan",lastDistance:em(F),lastCenter:af(F)});else if(F.length===1)if(e.currentTool===dl.ERASER){const A=P.target.getStage(),j=Hg(P,A);g(j)}else e.currentTool===dl.UNDO?p(P):e.currentTool===dl.REDO?x(P):h(P)},[em,af,h,e.currentTool,g,p,x]),b=S.useCallback(Bae(P=>{P.evt.preventDefault(),P.evt.stopPropagation();const F=P.evt.touches;if(F.length===2&&u.isActive){const A=Lae(F,u);if(A==="zoom"){const j=em(F),I=af(F),B=j/u.lastDistance,Y=Math.max(.25,Math.min(1,e.zoom*B));t(Z=>({...Z,zoom:Y,position:{x:I.x-(I.x-Z.position.x)*(Y/Z.zoom),y:I.y-(I.y-Z.position.y)*(Y/Z.zoom)}}))}else if(A==="pan"){const j=af(F),I=j.x-u.lastCenter.x,B=j.y-u.lastCenter.y;t(Y=>({...Y,position:{x:Y.position.x+I,y:Y.position.y+B}}))}d(j=>({...j,lastDistance:em(F),lastCenter:af(F)}))}else if(F.length===1)if(e.currentTool===dl.ERASER){const A=P.target.getStage(),j=Hg(P,A),I=TF(j.x,j.y,e.eraserSize,r);n(I)}else if(e.currentTool===dl.PAN){const A=af(F),j=A.x-u.lastCenter.x,I=A.y-u.lastCenter.y;t(B=>({...B,position:{x:B.position.x+j,y:B.position.y+I}})),d(B=>({...B,lastCenter:A}))}else w(P)}),[u,e.zoom,t,w]),N=S.useCallback(P=>{b(P)},[b]),E=S.useCallback(P=>{P.evt.preventDefault(),P.evt.stopPropagation();const F=P.evt.touches;F.length===0?(C(P),d({isActive:!1,type:null,lastDistance:null,lastCenter:null})):F.length===1&&d(A=>({...A,isActive:!1}))},[C]);return{handleTouchStart:k,handleTouchMove:N,handleTouchEnd:E,handleEraserStart:g,handleUndoTouch:p,handleRedoTouch:x,showTouchFeedback:v}},Vae=(e,t)=>{const[r,n]=S.useState(e.MIN),[s,a]=S.useState({x:0,y:0}),i=S.useCallback((g,p,x)=>{const v=Math.max(e.MIN,Math.min(e.MAX,g));if(p){const w=v/r,C={x:p.x-(p.x-s.x)*w,y:p.y-(p.y-s.y)*w};return{zoom:v,position:C}}else{const w=t.width*v,C=t.height*v,k={x:(x.width-w)/2,y:(x.height-C)/2};return{zoom:v,position:k}}},[r,s,e,t]),o=S.useCallback(()=>{const g=Math.min(r*(1+e.STEP),e.MAX);n(g)},[r,e]),c=S.useCallback(()=>{const g=Math.max(r/(1+e.STEP),e.MIN);n(g)},[r,e]),u=S.useCallback((g,p,x)=>{const v=i(g,p,x);n(v.zoom),a(v.position)},[i]),d=S.useCallback((g,p)=>{a(x=>({x:x.x+g,y:x.y+p}))},[]),h=S.useCallback(()=>{n(e.INITIAL),a({x:0,y:0})},[e.INITIAL]);return{zoom:r,setZoom:n,position:s,setPosition:a,handleZoomIn:o,handleZoomOut:c,handleZoomToPoint:u,handlePan:d,resetZoom:h}},Kae=e=>{const[t,r]=S.useState([]),[n,s]=S.useState(0),a=S.useCallback(h=>{if(console.log("parseDrawingData - input drawing:",h),console.log("parseDrawingData - drawing.answers:",h?.answers),!h?.answers)return console.log("parseDrawingData - no answers found, returning empty array"),[];try{if(typeof h.answers=="string"){console.log("parseDrawingData - parsing string answers");const g=JSON.parse(h.answers);return console.log("parseDrawingData - parsed string result:",g),g&&typeof g=="object"&&g.lines&&console.log("parseDrawingData - new format detected with lines and textBoxes"),g}if(h.answers&&typeof h.answers=="object"&&h.answers.lines)return console.log("parseDrawingData - answers is new format object"),h.answers;if(Array.isArray(h.answers)){if(console.log("parseDrawingData - answers is array"),h.answers.every(p=>typeof p=="string"))try{const p=h.answers.map(x=>{try{return JSON.parse(x)}catch{return x}});return console.log("parseDrawingData - parsed array elements"),p}catch{return console.log("parseDrawingData - failed to parse array elements, returning raw"),h.answers}return h.answers}return console.log("parseDrawingData - answers is neither string nor array, returning empty array"),[]}catch(g){return console.error("Error parsing drawing data:",g),[]}},[]),i=S.useCallback(h=>{if(console.log("processQuestions - input answers:",h),console.log("processQuestions - answers type:",typeof h),console.log("processQuestions - answers isArray:",Array.isArray(h)),h&&typeof h=="object"&&h.lines){console.log("processQuestions - new format detected with lines and textBoxes"),console.log("processQuestions - lines count:",h.lines?.length),console.log("processQuestions - textBoxes count:",h.textBoxes?.length);const p=o(h.lines);return console.log("processQuestions - canvas groups:",p),console.log("processQuestions - number of canvas groups:",p.length),p.map((x,v)=>(console.log(`processQuestions - canvas ${v} strokes:`,x),console.log(`processQuestions - canvas ${v} stroke count:`,x.length),{questionNumber:v+1,drawingData:x,textBoxes:h.textBoxes||[]}))}if(Array.isArray(h)&&h.every(p=>p&&typeof p=="object"&&p.lines))return console.log("processQuestions - array of {lines,textBoxes} detected"),h.map((p,x)=>({questionNumber:x+1,drawingData:p.lines||[],textBoxes:p.textBoxes||[]}));if(!Array.isArray(h))return console.log("processQuestions - answers is not array or object, returning empty array"),[];console.log("processQuestions - processing",h.length,"answers (old format)");const g=o(h);return console.log("processQuestions - canvas groups:",g),console.log("processQuestions - number of canvas groups:",g.length),g.map((p,x)=>(console.log(`processQuestions - canvas ${x} strokes:`,p),console.log(`processQuestions - canvas ${x} stroke count:`,p.length),{questionNumber:x+1,drawingData:p,textBoxes:[]}))},[]),o=S.useCallback(h=>{console.log("groupStrokesByCanvas - input answers:",h);const g=c(h);return console.log("groupStrokesByCanvas - using strategy:",g),g==="by_question_boundary"?u(h):g==="by_stroke_type"?d(h):[h]},[]),c=S.useCallback(h=>{console.log("determineGroupingStrategy - analyzing answers:",h);let g=0,p=0;return h.forEach(x=>{Array.isArray(x)?g++:typeof x=="object"&&p++}),console.log("determineGroupingStrategy - arrayCount:",g,"objectCount:",p),g>0&&p>0?"by_stroke_type":h.length>3?"by_question_boundary":"single_canvas"},[]),u=S.useCallback(h=>{console.log("groupByQuestionBoundary - grouping answers:",h);const g=[];let p=[];const x=Math.ceil(h.length/2);for(let v=0;v<h.length;v++)p.push(h[v]),(v+1)%x===0&&v<h.length-1&&(g.push([...p]),p=[]);return p.length>0&&g.push(p),console.log("groupByQuestionBoundary - result:",g),g},[]),d=S.useCallback(h=>{console.log("groupByStrokeType - grouping answers:",h);const g=[],p=[];h.forEach(v=>{Array.isArray(v)?g.push(v):typeof v=="object"&&p.push(v)});const x=[];return g.length>0&&x.push(g),p.length>0&&x.push(p),console.log("groupByStrokeType - result:",x),x},[]);return S.useEffect(()=>{if(e){console.log("useDataParsing - drawing object:",e),console.log("useDataParsing - drawing.answers:",e.answers),console.log("useDataParsing - drawing.answers type:",typeof e.answers),console.log("useDataParsing - drawing.answers length:",e.answers?.length);const h=a(e);console.log("useDataParsing - parsed answers:",h),console.log("useDataParsing - parsed answers type:",typeof h),console.log("useDataParsing - parsed answers length:",h?.length);const g=i(h);console.log("useDataParsing - processed questions:",g),console.log("useDataParsing - processed questions length:",g?.length),g.length>0&&(console.log("useDataParsing - first question drawingData:",g[0]?.drawingData),console.log("useDataParsing - first question drawingData length:",g[0]?.drawingData?.length)),r(g),s(0)}},[e,a,i]),{questionsData:t,setQuestionsData:r,currentQuestionIndex:n,setCurrentQuestionIndex:s,parseDrawingData:a,processQuestions:i}},EF={MIN:.25,INITIAL:1},qae=(e,t)=>{const[r,n]=S.useState(!1),[s,a]=S.useState(null),i=S.useCallback(()=>{document.fullscreenElement||(a({zoom:e.zoom,position:{...e.position}}),document.documentElement.requestFullscreen().then(()=>{n(!0),t(c=>({...c,zoom:EF.MIN,position:{x:0,y:0},isFullscreen:!0}))}).catch(c=>{console.error("Error entering fullscreen:",c)}))},[e.zoom,e.position,t]),o=S.useCallback(()=>{document.fullscreenElement&&document.exitFullscreen().then(()=>{n(!1),s?(t(c=>({...c,zoom:s.zoom,position:s.position,isFullscreen:!1})),a(null)):t(c=>({...c,zoom:EF.INITIAL,position:{x:0,y:0},isFullscreen:!1}))}).catch(c=>{console.error("Error exiting fullscreen:",c)})},[s,t]);return{isFullscreen:r,enterFullscreen:i,exitFullscreen:o}},$B=S.forwardRef(({drawingData:e,textBoxes:t=[],drawingState:r,canvasSize:n,zoom:s,position:a,onTouchStart:i,onTouchMove:o,onTouchEnd:c,mousePosition:u,isMouseOverCanvas:d,isEraserDrawing:h},g)=>{const p=S.useRef(null),[x,v]=S.useState(.25),[w,C]=S.useState(null),[k,b]=S.useState({x:0,y:0}),[N,E]=S.useState(!1),P=S.useCallback(({x:V,y:W,size:R,visible:U,isDrawing:q})=>!U||!V||!W?null:l.jsx(pf,{x:V,y:W,radius:R/2,stroke:yF.CURSOR_COLOR,strokeWidth:2,dash:[5,5],opacity:q?.8:yF.CURSOR_OPACITY,listening:!1,zIndex:1e3}),[]),F=S.useCallback(V=>{if(r.currentTool===Sh.ERASER){const W=V.target.getStage(),R=Hg(V,W);b(R)}},[r.currentTool]),A=S.useCallback(()=>{r.currentTool===Sh.ERASER&&E(!0)},[r.currentTool]),j=S.useCallback(()=>{E(!1)},[]);S.useEffect(()=>{const V=g.current;if(V)return V.on("mousemove",F),V.on("mouseenter",A),V.on("mouseleave",j),()=>{V.off("mousemove",F),V.off("mouseenter",A),V.off("mouseleave",j)}},[F,A,j,g]),S.useEffect(()=>{const V=n.width??n.WIDTH,W=n.height??n.HEIGHT,R=()=>{const U=p.current;if(!U)return;const q=U.clientWidth||1,Q=U.clientHeight||1,se=Math.abs(r.rotation%180)===90,X=se?W:V,ie=se?V:W,le=Math.min(q/(X||1),Q/(ie||1));v(Math.min(le,1))};return R(),window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[n.width,n.height,n.WIDTH,n.HEIGHT,r.rotation]);const I=S.useMemo(()=>{const V=p.current;if(!V||!w)return 0;const W=V.clientWidth||1,R=V.clientHeight||1,U=Math.min(W/Math.max(w.width,1),R/Math.max(w.height,1));return Math.min(U,MB.MAX)},[w]),B=S.useMemo(()=>Math.max(s,x||1),[s,x]),Y=S.useMemo(()=>{const V=n.width??n.WIDTH,W=n.height??n.HEIGHT;if(!p.current)return{x:0,y:0};const R=p.current.clientWidth||1,U=p.current.clientHeight||1,q=(R-V*B)/2,Q=(U-W*B)/2;return s<=x?{x:q,y:Q}:{x:a.x!==void 0?a.x:q,y:a.y!==void 0?a.y:Q}},[a,s,x,B,n.width,n.height,w,I]);S.useEffect(()=>{if(!Array.isArray(e)||e.length===0){C(null);return}let V=1/0,W=1/0,R=-1/0,U=-1/0;const q=(ie,le)=>{Number.isFinite(ie)&&Number.isFinite(le)&&(ie<V&&(V=ie),le<W&&(W=le),ie>R&&(R=ie),le>U&&(U=le))};if(e.forEach(ie=>{if(Array.isArray(ie))ie.forEach(le=>q(le.x,le.y));else if(ie&&typeof ie=="object"){if(ie.type==="line")q(ie.startX,ie.startY),q(ie.endX,ie.endY);else if(ie.type==="rectangle")q(ie.startX,ie.startY),q(ie.endX,ie.endY);else if(ie.type==="circle"){const le=Math.sqrt(Math.pow(ie.endX-ie.startX,2)+Math.pow(ie.endY-ie.startY,2))/2,ce=(ie.startX+ie.endX)/2,Se=(ie.startY+ie.endY)/2;q(ce-le,Se-le),q(ce+le,Se+le)}}}),!Number.isFinite(V)||!Number.isFinite(W)||!Number.isFinite(R)||!Number.isFinite(U)){C(null);return}const Q=16,se=Math.max(1,R-V+Q*2),X=Math.max(1,U-W+Q*2);C({minX:V-Q,minY:W-Q,width:se,height:X})},[e]),S.useEffect(()=>{console.log("CanvasViewer - drawingData:",e),console.log("CanvasViewer - drawingData length:",e?.length),console.log("CanvasViewer - textBoxes:",t),console.log("CanvasViewer - textBoxes length:",t?.length),e&&e.length>0&&console.log("CanvasViewer - first item:",e[0]),t&&t.length>0&&console.log("CanvasViewer - first textBox:",t[0])},[e,t]),S.useEffect(()=>{const V=n.width??n.WIDTH,W=n.height??n.HEIGHT;console.log("CanvasViewer - canvas dimensions:",{width:V,height:W}),console.log("CanvasViewer - zoom:",s,"fitZoom:",x,"displayScale:",B),console.log("CanvasViewer - stagePosition:",Y)},[n,s,x,B,Y]);const Z=(V,W)=>{if(console.log(`CanvasViewer - rendering element ${W}:`,V),Array.isArray(V))return console.log(`CanvasViewer - rendering line with ${V.length} points`),l.jsx(ai,{points:V.flatMap(R=>[R.x,R.y]),stroke:V[0]?.color||"#000000",strokeWidth:V[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},W);if(V.type==="line")return l.jsx(ai,{points:[V.startX,V.startY,V.endX,V.endY],stroke:V.color,strokeWidth:V.thickness,lineCap:"round"},W);if(V.type==="rectangle"){const R=Math.abs(V.endX-V.startX),U=Math.abs(V.endY-V.startY),q=Math.min(V.startX,V.endX),Q=Math.min(V.startY,V.endY);return l.jsx(Ba,{x:q,y:Q,width:R,height:U,stroke:V.color,strokeWidth:V.thickness,fill:"transparent"},W)}else if(V.type==="circle"){const R=Math.sqrt(Math.pow(V.endX-V.startX,2)+Math.pow(V.endY-V.startY,2))/2,U=(V.startX+V.endX)/2,q=(V.startY+V.endY)/2;return l.jsx(pf,{x:U,y:q,radius:R,stroke:V.color,strokeWidth:V.thickness,fill:"transparent"},W)}return null},ae=()=>{if(!r.isDrawing)return null;if(r.currentTool===Sh.PENCIL&&r.currentLine.length>0)return l.jsx(ai,{points:r.currentLine.flatMap(V=>[V.x,V.y]),stroke:r.currentColor,strokeWidth:r.currentThickness,tension:.5,lineCap:"round",lineJoin:"round"});if(r.currentShape){const{type:V,startX:W,startY:R,endX:U,endY:q,color:Q,thickness:se}=r.currentShape;if(V===Sh.LINE)return l.jsx(ai,{points:[W,R,U,q],stroke:Q,strokeWidth:se,lineCap:"round"});if(V===Sh.RECTANGLE){const X=Math.abs(U-W),ie=Math.abs(q-R),le=Math.min(W,U),ce=Math.min(R,q);return l.jsx(Ba,{x:le,y:ce,width:X,height:ie,stroke:Q,strokeWidth:se,fill:"transparent"})}else if(V===Sh.CIRCLE){const X=Math.sqrt(Math.pow(U-W,2)+Math.pow(q-R,2))/2,ie=(W+U)/2,le=(R+q)/2;return l.jsx(pf,{x:ie,y:le,radius:X,stroke:Q,strokeWidth:se,fill:"transparent"})}}return null},ee=r.isFullscreen?{position:"fixed",inset:0,width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",zIndex:60}:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent"},ne={transform:`rotate(${r.rotation}deg)`,transformOrigin:"center center"},L=S.useCallback(V=>{V.preventDefault(),V.stopPropagation()},[]),H=S.useCallback(V=>{V.preventDefault(),V.stopPropagation()},[]),M=S.useCallback(V=>{V.preventDefault(),V.stopPropagation()},[]);return l.jsx("div",{style:{...ee,touchAction:"none",WebkitTouchCallout:"none"},ref:p,className:"select-none",onTouchStart:L,onTouchMove:H,onTouchEnd:M,children:l.jsx("div",{style:{...ne,touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onTouchStart:L,onTouchMove:H,onTouchEnd:M,children:l.jsx(e0,{ref:g,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),scaleX:B,scaleY:B,x:Y.x,y:Y.y,onTouchStart:i,onTouchMove:o,onTouchEnd:c,children:l.jsxs(Zh,{children:[l.jsx(Ba,{x:0,y:0,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),fill:"white"}),e.map((V,W)=>(console.log(`CanvasViewer - mapping item ${W}:`,V),Z(V,W))),t&&t.map((V,W)=>l.jsx(Ba,{x:V.x,y:V.y,width:V.width,height:V.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}},`textbox-${W}`)),t&&t.map((V,W)=>l.jsx(zc,{x:V.x+8,y:V.y+8,width:V.width-16,height:V.height-16,text:V.text,fontSize:V.fontSize||14,fill:V.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"},`text-${W}`)),ae(),r.currentTool===Sh.ERASER&&l.jsx(P,{x:k.x,y:k.y,size:r.eraserSize,visible:N,isDrawing:h})]})})})})});$B.displayName="CanvasViewer";function Yae({containerRef:e,canvasSize:t,rotation:r=0}){const[n,s]=S.useState(1),[a,i]=S.useState({x:0,y:0}),o=S.useRef({width:1,height:1}),c=S.useRef(.01),u=S.useRef(0),d=S.useRef(!1),h=S.useCallback(()=>{const N=t?.width??t?.WIDTH??0,E=t?.height??t?.HEIGHT??0,P=Math.abs(r%180)===90;return{width:P?E:N,height:P?N:E}},[t,r]),g=S.useCallback(()=>{const N=e?.current;if(!N)return{width:1,height:1};const E=N.clientWidth||1,P=N.clientHeight||1;return o.current={width:E,height:P},{width:E,height:P}},[e]),p=S.useCallback(()=>{const{width:N,height:E}=o.current,{width:P,height:F}=h(),A=N/Math.max(P,1),j=E/Math.max(F,1);return Math.min(A,j,1)*.98},[h]),x=S.useCallback(N=>{const{width:E,height:P}=o.current,{width:F,height:A}=h(),j=Math.max(c.current,Math.min(N,1.5));let I=(E-F*j)/2,B=(P-A*j)/2;const Y=E-F*j,Z=P-A*j;I=Math.min(Math.max(0,I),Math.max(0,Y)),B=Math.min(Math.max(0,B),Math.max(0,Z));try{console.log("[Camera] centerAtScale",{targetScale:N,clampedScale:j,container:{containerW:E,containerH:P},canvas:{canvasW:F,canvasH:A},translate:{x:I,y:B},rotation:r})}catch{}i({x:I,y:B}),s(j)},[h]),v=S.useCallback(()=>{const{width:N,height:E}=g(),{width:P,height:F}=h(),A=p();let j=(N-P*A)/2,I=(E-F*A)/2;const B=N-P*A,Y=E-F*A;j=Math.min(Math.max(0,j),Math.max(0,B)),I=Math.min(Math.max(0,I),Math.max(0,Y));try{console.log("[Camera] fitCanvas",{scale:A,container:{containerW:N,containerH:E},canvas:{canvasW:P,canvasH:F},translate:{x:j,y:I},rotation:r})}catch{}s(A),i({x:j,y:I}),c.current=A,d.current=!1},[h,g,p]),w=S.useCallback(()=>{const{width:N,height:E}=g(),{width:P,height:F}=h(),A=(N-P)/2,j=(E-F)/2;s(1),i({x:A,y:j})},[h,g]),C=S.useCallback((N,E)=>{const{width:P,height:F}=o.current,{width:A,height:j}=h(),I=Math.max(c.current,Math.min(N,1.5));if(E&&Number.isFinite(E.x)&&Number.isFinite(E.y)){const B={x:(E.x-a.x)/n,y:(E.y-a.y)/n},Y=E.x-B.x*I,Z=E.y-B.y*I;try{console.log("[Camera] zoomTo(pointer) ->",{from:n,to:I})}catch{}s(I),i({x:Y,y:Z}),u.current=Date.now()+400,d.current=!0}else{let B=(P-A*I)/2,Y=(F-j*I)/2;const Z=P-A*I,ae=F-j*I;B=Math.min(Math.max(0,B),Math.max(0,Z)),Y=Math.min(Math.max(0,Y),Math.max(0,ae));try{console.log("[Camera] zoomTo(center) ->",{from:n,to:I})}catch{}s(I),i({x:B,y:Y}),u.current=Date.now()+400,d.current=!0}},[h,n,a]),k=S.useCallback((N,E)=>{const P=n*N,{width:F,height:A}=o.current,j={x:F/2,y:A/2};C(P,E||j)},[n,C]),b=S.useCallback((N,E)=>{i(P=>({x:P.x+N,y:P.y+E})),u.current=Date.now()+200,d.current=!0},[]);return S.useEffect(()=>{const N=e?.current;if(!N)return;const E=new ResizeObserver(()=>{g();const P=p();if(c.current=P,!(Date.now()<u.current)&&!d.current){try{console.log("[Camera] resize centerAtScale",{scale:n})}catch{}x(n)}});return E.observe(N),g(),()=>E.disconnect()},[e,g,p,x,n]),S.useEffect(()=>{d.current=!1,c.current=p(),x(n)},[r,t?.width,t?.height,t?.WIDTH,t?.HEIGHT,p,x,n]),S.useMemo(()=>({scale:n,translate:a,setScale:s,setTranslate:i,centerAtScale:x,fitCanvas:v,oneToOne:w,zoomTo:C,zoomByFactor:k,panBy:b}),[n,a,x,v,w,C,k,b])}const Xx=new Map,UB=S.forwardRef(({drawingData:e,textBoxes:t=[],canvasSize:r,rotation:n=0,onScaleChange:s,persistKey:a="viewer",onTextBoxEdit:i},o)=>{const c=S.useRef(null),u=S.useRef(null),d=Yae({containerRef:c,canvasSize:r,rotation:n}),[h,g]=S.useState({width:1,height:1}),p=S.useRef(null),x=S.useRef(null),[v,w]=S.useState(null);S.useEffect(()=>{console.log("[ViewerCanvas] drawingData received:",e),console.log("[ViewerCanvas] drawingData length:",e?.length),e&&e.length>0&&console.log("[ViewerCanvas] First drawing element:",e[0]),console.log("[ViewerCanvas] textBoxes:",t),console.log("[ViewerCanvas] textBoxes length:",t?.length)},[e]),S.useEffect(()=>{typeof s=="function"&&s(d.scale);try{console.log("[ViewerCanvas] scale changed",{scale:d.scale})}catch{}if(a){const M=Xx.get(a)||{};Xx.set(a,{...M,scale:d.scale})}},[d.scale,s]),S.useEffect(()=>{if(a){const M=Xx.get(a)||{};Xx.set(a,{...M,translate:{x:d.translate.x,y:d.translate.y}})}},[a,d.translate.x,d.translate.y]),S.useImperativeHandle(o,()=>({zoomIn:M=>d.zoomByFactor(1.1,M),zoomOut:M=>d.zoomByFactor(1/1.1,M),fitCanvas:()=>d.fitCanvas(),oneToOne:()=>d.oneToOne(),getScale:()=>d.scale,getStage:()=>u.current,getPointerPosition:()=>u.current?.getPointerPosition?.(),exportPNGFullCanvas:()=>{const M=u.current;if(!M)return null;const V=r?.width??r?.WIDTH??1536,W=r?.height??r?.HEIGHT??2048,R={scaleX:M.scaleX(),scaleY:M.scaleY(),x:M.x(),y:M.y(),width:M.width(),height:M.height()},U=p.current,q=x.current,Q=U?{x:U.x(),y:U.y(),scaleX:U.scaleX(),scaleY:U.scaleY()}:null,se=q?{x:q.x(),y:q.y(),rotation:q.rotation()}:null;try{return M.scale({x:1,y:1}),M.position({x:0,y:0}),M.size({width:V,height:W}),U&&(U.position({x:0,y:0}),U.scale({x:1,y:1})),q&&(q.position({x:0,y:0}),q.rotation(0)),M.batchDraw(),M.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:V,height:W})}finally{q&&se&&(q.position({x:se.x,y:se.y}),q.rotation(se.rotation)),U&&Q&&(U.position({x:Q.x,y:Q.y}),U.scale({x:Q.scaleX,y:Q.scaleY})),M.scale({x:R.scaleX,y:R.scaleY}),M.position({x:R.x,y:R.y}),M.size({width:R.width,height:R.height}),M.batchDraw()}}}),[d]),S.useEffect(()=>{const M=c.current;if(!M)return;const V=()=>{g({width:M.clientWidth||1,height:M.clientHeight||1})};V();const W=new ResizeObserver(V);return W.observe(M),()=>W.disconnect()},[]),S.useEffect(()=>{if(!Array.isArray(e)||e.length===0){w(null);return}let M=1/0,V=1/0,W=-1/0,R=-1/0;const U=(X,ie)=>{Number.isFinite(X)&&Number.isFinite(ie)&&(X<M&&(M=X),ie<V&&(V=ie),X>W&&(W=X),ie>R&&(R=ie))};if(e.forEach(X=>{if(Array.isArray(X))X.forEach(ie=>U(ie.x,ie.y));else if(X&&typeof X=="object"){if(X.type==="line")U(X.startX,X.startY),U(X.endX,X.endY);else if(X.type==="rectangle")U(X.startX,X.startY),U(X.endX,X.endY);else if(X.type==="circle"){const ie=Math.hypot(X.endX-X.startX,X.endY-X.startY)/2,le=(X.startX+X.endX)/2,ce=(X.startY+X.endY)/2;U(le-ie,ce-ie),U(le+ie,ce+ie)}}}),!Number.isFinite(M)||!Number.isFinite(V)||!Number.isFinite(W)||!Number.isFinite(R)){w(null);return}const q=16,Q=Math.max(1,W-M+q*2),se=Math.max(1,R-V+q*2);w({minX:M-q,minY:V-q,width:Q,height:se,centerX:M-q+Q/2,centerY:V-q+se/2})},[e]);const C=S.useMemo(()=>{if(!v)return{scale:1,x:0,y:0};const M=r?.width??r?.WIDTH??1536,V=r?.height??r?.HEIGHT??2048,W=Math.min(M/Math.max(1,v.width),V/Math.max(1,v.height),1),R=v.width*W,U=v.height*W,q=(M-R)/2,Q=(V-U)/2,se=q-v.minX*W,X=Q-v.minY*W;return{scale:W,x:se,y:X}},[v,r?.width,r?.height,r?.WIDTH,r?.HEIGHT]),k=S.useRef(!1);S.useEffect(()=>{if(k.current)return;const M=a?Xx.get(a):null;M&&Number.isFinite(M.scale)&&M.translate&&Number.isFinite(M.translate.x)&&Number.isFinite(M.translate.y)?(d.setScale(M.scale),d.setTranslate(M.translate)):d.fitCanvas(),k.current=!0},[a,d]),S.useEffect(()=>{try{console.log("[ViewerCanvas] rotation changed",{rotation:n,scale:d.scale,translate:d.translate})}catch{}d.fitCanvas()},[n]),S.useEffect(()=>{d.centerAtScale(d.scale)},[n]);const b=M=>{M.evt.preventDefault();const V=u.current;if(!V)return;const W=V.getPointerPosition(),R=Math.pow(1.0015,-M.evt.deltaY);d.zoomByFactor(R,W)},N=S.useRef(!1),E=S.useRef({x:0,y:0}),P=()=>{const M=c.current;if(!M)return 1;const V=M.clientWidth||1,W=M.clientHeight||1,R=r?.width??r?.WIDTH??1,U=r?.height??r?.HEIGHT??1,q=Math.abs(n%180)===90,Q=q?U:R,se=q?R:U,X=Math.min(V/Q,W/se);return Math.min(X,1)},F=M=>{const V=P();d.scale<=V||(N.current=!0,E.current={x:M.evt.clientX,y:M.evt.clientY})},A=M=>{if(!N.current)return;const V=M.evt.clientX-E.current.x,W=M.evt.clientY-E.current.y;E.current={x:M.evt.clientX,y:M.evt.clientY},d.panBy(V,W)},j=()=>{N.current=!1},I=1536,B=2048,Y=(M,V)=>{if(console.log(`[ViewerCanvas] Rendering drawing element ${V}:`,M),Array.isArray(M))return console.log(`[ViewerCanvas] Array item with ${M.length} points:`,M.slice(0,3)),l.jsx(ai,{points:M.flatMap(W=>[W.x,W.y]),stroke:M[0]?.color||"#000000",strokeWidth:M[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},V);if(M?.type==="line")return l.jsx(ai,{points:[M.startX,M.startY,M.endX,M.endY],stroke:M.color,strokeWidth:M.thickness,lineCap:"round"},V);if(M?.type==="rectangle"){const W=Math.abs(M.endX-M.startX),R=Math.abs(M.endY-M.startY),U=Math.min(M.startX,M.endX),q=Math.min(M.startY,M.endY);return l.jsx(Ba,{x:U,y:q,width:W,height:R,stroke:M.color,strokeWidth:M.thickness,fill:"transparent"},V)}else if(M?.type==="circle"){const W=Math.sqrt(Math.pow(M.endX-M.startX,2)+Math.pow(M.endY-M.startY,2))/2,R=(M.startX+M.endX)/2,U=(M.startY+M.endY)/2;return l.jsx(pf,{x:R,y:U,radius:W,stroke:M.color,strokeWidth:M.thickness,fill:"transparent"},V)}return null},Z=S.useRef(new Map),ae=S.useRef(null),ee=S.useRef({x:0,y:0}),ne=S.useCallback(M=>{const V=c.current;V&&(V.setPointerCapture?.(M.pointerId),Z.current.set(M.pointerId,{x:M.clientX,y:M.clientY}),E.current={x:M.clientX,y:M.clientY})},[]),L=S.useCallback(M=>{const V=Z.current;if(V.has(M.pointerId)){if(V.set(M.pointerId,{x:M.clientX,y:M.clientY}),V.size===2){const W=Array.from(V.values()),R=W[1].x-W[0].x,U=W[1].y-W[0].y,q=Math.hypot(R,U),Q={x:(W[0].x+W[1].x)/2,y:(W[0].y+W[1].y)/2},se=u.current,X=se&&se.getPointerPosition()||Q;if(ae.current!=null){const ie=q/Math.max(1,ae.current);d.zoomByFactor(ie,X)}ae.current=q,ee.current=X}else if(V.size===1){const W=P();if(d.scale<=W)return;const R=M.clientX-E.current.x,U=M.clientY-E.current.y;E.current={x:M.clientX,y:M.clientY},d.panBy(R,U)}}},[]),H=S.useCallback(M=>{const V=c.current;V&&(V.releasePointerCapture?.(M.pointerId),Z.current.delete(M.pointerId),Z.current.size<2&&(ae.current=null),N.current=!1)},[]);return l.jsx("div",{ref:c,style:{width:"100%",height:"100%",display:"block",backgroundColor:"transparent",touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onPointerDown:ne,onPointerMove:L,onPointerUp:H,children:l.jsx(e0,{ref:u,width:h.width,height:h.height,onWheel:b,onMouseDown:F,onMouseMove:A,onMouseUp:j,onMouseLeave:j,children:l.jsx(Zh,{children:l.jsx(sc,{ref:p,x:d.translate.x,y:d.translate.y,scaleX:d.scale,scaleY:d.scale,children:(()=>{const M=(n%360+360)%360;let V=0,W=0;M===90?V=B:M===180?(V=I,W=B):M===270&&(W=I);try{console.log("[ViewerCanvas] rotatedGroup offset",{rotation:n,norm:M,tx:V,ty:W,canvasW:I,canvasH:B})}catch{}return l.jsxs(sc,{ref:x,x:V,y:W,rotation:n,children:[l.jsx(Ba,{x:0,y:0,width:I,height:B,fill:"white"}),l.jsxs(sc,{x:C.x,y:C.y,scaleX:C.scale,scaleY:C.scale,children:[Array.isArray(e)?(console.log("[ViewerCanvas] Rendering",e.length,"drawing elements"),e.map((R,U)=>Y(R,U))):null,Array.isArray(t)&&t.map((R,U)=>l.jsxs(sc,{x:R.x,y:R.y,children:[l.jsx(Ba,{width:R.width,height:R.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}}),l.jsx(zc,{text:R.text,x:8,y:8,width:Math.max(0,(R.width||0)-16),height:Math.max(0,(R.height||0)-16),fontSize:R.fontSize||14,fill:R.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"})]},`tb-${U}`))]})]})})()})})})})});UB.displayName="ViewerCanvas";const Xae=({zoom:e,onZoomIn:t,onZoomOut:r,onRotate:n,onDownload:s,onFullscreen:a,isFullscreen:i})=>l.jsxs("div",{className:"absolute top-4 right-4 flex flex-col space-y-2 items-center justify-center",children:[l.jsx(Ye,{onClick:t,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom In",children:l.jsx(Nae,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(Ye,{onClick:r,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom Out",children:l.jsx(jae,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(Ye,{onClick:n,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Rotate",children:l.jsx(Cae,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(Ye,{onClick:s,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Download",children:l.jsx(bae,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(Ye,{onClick:a,variant:"secondary",size:"icon",className:"w-10 h-10",title:i?"Exit Fullscreen":"Enter Fullscreen",children:i?l.jsx(RB,{className:"w-4 h-4 mx-auto my-auto"}):l.jsx(Sae,{className:"w-4 h-4 mx-auto my-auto"})})]}),Qae=({currentQuestion:e,totalQuestions:t,onPrevious:r,onNext:n,drawingDataLength:s})=>t<=1?null:l.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ye,{onClick:r,disabled:e===0,variant:"outline",size:"sm",children:"Previous"}),l.jsxs("span",{className:"text-sm text-gray-600",children:["Question ",e+1," of ",t]}),l.jsx(Ye,{onClick:n,disabled:e===t-1,variant:"outline",size:"sm",children:"Next"})]}),l.jsxs("div",{className:"text-sm text-gray-500",children:[s," lines"]})]})}),zB=({drawing:e,isOpen:t,onClose:r,onScoreChange:n,onMaxScoreChange:s,isTeacherView:a=!1,onSaveScore:i})=>{const{drawingState:o,setDrawingState:c,drawingData:u,setDrawingData:d,textBoxes:h,setTextBoxes:g,saveToHistoryState:p,undo:x,redo:v,canUndoState:w,canRedoState:C}=Mae(),{questionsData:k,currentQuestionIndex:b,setCurrentQuestionIndex:N}=Kae(e),{zoom:E,position:P,handleZoomIn:F,handleZoomOut:A}=Vae(MB,Jl),{isFullscreen:j,enterFullscreen:I,exitFullscreen:B}=qae(o,c),{handleTouchStart:Y,handleTouchMove:Z,handleTouchEnd:ae}=Gae(o,c,u,d,p,x,v,w,C),ee=S.useRef(null),ne=S.useRef(null),[L,H]=S.useState(1),[M,V]=S.useState(""),[W,R]=S.useState("");S.useEffect(()=>{if(console.log("DrawingModal - questionsData:",k),console.log("DrawingModal - currentQuestionIndex:",b),k.length>0){const ce=k[b]?.drawingData||[],Se=k[b]?.textBoxes||[];console.log("DrawingModal - setting drawingData:",ce),console.log("DrawingModal - setting textBoxes:",Se),d(ce),g(Se)}},[k,b,d,g]),S.useEffect(()=>{t&&e&&(V((Number.isFinite(e.score)?e.score:0).toString()),R("10"))},[t,e]);const U=()=>{b>0&&N(b-1)},q=()=>{b<k.length-1&&N(b+1)},Q=()=>{w&&x()},se=()=>{C&&v()};S.useEffect(()=>{const ce=Se=>{(Se.ctrlKey||Se.metaKey)&&(Se.key==="z"&&!Se.shiftKey?(Se.preventDefault(),Q()):(Se.key==="y"||Se.key==="z"&&Se.shiftKey)&&(Se.preventDefault(),se()))};return document.addEventListener("keydown",ce),()=>document.removeEventListener("keydown",ce)},[Q,se]);const X=()=>{c(ce=>({...ce,rotation:(ce.rotation+90)%360}))},ie=()=>{if(a&&ne.current){const ge=ne.current.exportPNGFullCanvas();if(!ge)return;const Ee=document.createElement("a");Ee.href=ge,Ee.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(Ee),Ee.click(),document.body.removeChild(Ee);return}const ce=ee.current;if(!ce)return;const Se=ce.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:Jl.WIDTH,height:Jl.HEIGHT}),re=document.createElement("a");re.href=Se,re.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(re),re.click(),document.body.removeChild(re)},le=async()=>{if(!a)return r();const ce=parseInt(M,10),Se=10;Number.isFinite(ce)&&(typeof i=="function"?await i({resultId:e.id,score:Math.max(0,Math.min(10,ce)),maxScore:Se}):(n&&n(e.id,ce),s&&s(e.id,Se))),r()};return!t||!e?null:l.jsx(wo,{children:l.jsx(nt.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,children:l.jsxs(nt.div,{className:"bg-white rounded-lg shadow-xl max-w-4xl h-[90vh] w-full mx-4 flex flex-col select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:ce=>ce.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Drawing Submission"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[e.name," ",e.surname," - ",e.test_name]})]}),l.jsx(Ye,{onClick:r,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-600",children:l.jsx(RB,{className:"w-5 h-5"})})]}),k.length>1&&l.jsx(Qae,{currentQuestion:b,totalQuestions:k.length,onPrevious:U,onNext:q,drawingDataLength:k[b]?.drawingData?.length||0}),l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[l.jsxs("div",{className:"flex-1 min-h-0 relative overflow-hidden bg-gray-100 p-0 sm:p-4 select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},children:[a?l.jsx(UB,{ref:ne,drawingData:u,textBoxes:h,canvasSize:{width:Jl.WIDTH,height:Jl.HEIGHT,WIDTH:Jl.WIDTH,HEIGHT:Jl.HEIGHT},rotation:o.rotation,onScaleChange:H}):l.jsx($B,{ref:ee,drawingData:u,textBoxes:h,drawingState:o,canvasSize:{width:Jl.WIDTH,height:Jl.HEIGHT,WIDTH:Jl.WIDTH,HEIGHT:Jl.HEIGHT},zoom:E,position:P,onTouchStart:Y,onTouchMove:Z,onTouchEnd:ae,mousePosition:{x:0,y:0},isMouseOverCanvas:!1,isEraserDrawing:!1}),l.jsx(Xae,{zoom:a?L:E,onZoomIn:()=>{if(a&&ne.current){try{console.log("[ZoomButton] ZoomIn click (teacher)",{before:ne.current.getScale?.()})}catch{}ne.current.zoomIn(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomIn after",{after:ne.current.getScale?.()})}catch{}},0)}else F()},onZoomOut:()=>{if(a&&ne.current){try{console.log("[ZoomButton] ZoomOut click (teacher)",{before:ne.current.getScale?.()})}catch{}ne.current.zoomOut(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomOut after",{after:ne.current.getScale?.()})}catch{}},0)}else A()},onRotate:X,onDownload:ie,onFullscreen:j?B:I,isFullscreen:j}),l.jsxs("div",{className:"absolute bottom-4 left-4 bg-gray-800 bg-opacity-70 text-white px-3 py-1 rounded-full text-sm",children:[Math.round((a?L:E)*100),"%"]})]}),a&&l.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Score:"}),l.jsx("input",{type:"number",min:"0",max:10,value:M,onChange:ce=>V(ce.target.value),className:"w-20 px-3 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Max:"}),l.jsx("input",{type:"number",value:10,disabled:!0,className:"w-20 px-3 py-1 text-sm border border-gray-300 rounded bg-gray-100"})]}),l.jsx(Ye,{onClick:le,variant:"primary",size:"sm",children:"Save"})]})})]})]})})})},WB=({testType:e,testId:t,studentAnswers:r,onBackToCabinet:n,compact:s=!1,showAll:a=!1,onToggleShowAll:i,maxInitial:o=3})=>{const c=Eo(),{user:u,isAuthenticated:d}=cs(),{testResults:h,loadTestResults:g}=zv(),[p,x]=S.useState(!0),[v,w]=S.useState(""),[C,k]=S.useState([]),[b,N]=S.useState([]),[E,P]=S.useState(null),[F,A]=S.useState([]),[j,I]=S.useState(0),[B,Y]=S.useState(0),[Z,ae]=S.useState(!1),[ee,ne]=S.useState(null),L=S.useCallback(X=>{const ie=X.best_retest_score||X.score,le=X.best_retest_max_score||X.max_score,ce=Math.round(ie/le*100);return{score:ie,maxScore:le,percentage:ce}},[]);S.useEffect(()=>{H()},[e,t]),S.useEffect(()=>{!e&&!t&&(h&&h.results?(pe.debug(" Using cached test results from TestContext"),N(h.results),x(!1)):V())},[e,t,h]);const H=S.useCallback(async()=>{pe.debug(" Initializing Student Results...");try{if(x(!0),w(""),!d||!u){pe.debug(" User not authenticated"),w("User not authenticated");return}if(u.role!==Ji.STUDENT){pe.error(" Invalid user role for student results:",u.role),w("Access denied. Student role required.");return}pe.debug(" Loading test results..."),await g(u?.student_id||u?.id||""),e&&t&&r&&(pe.debug(" Loading specific test results..."),await M(e,t,r)),pe.debug(" Student Results initialization complete!")}catch(X){pe.error(" Error initializing student results:",X),w("Failed to initialize student results")}finally{x(!1)}},[d,u,e,t,r,g]),M=S.useCallback(async(X,ie,le)=>{pe.debug(" Loading specific test results:",X,ie);try{const ce=await hn.getTestInfo(X,ie);pe.debug(" Test info loaded:",ce),P(ce);const Se=await hn.getTestQuestions(X,ie);pe.debug(" Test questions loaded:",Se),A(Se);const re=wf(Se,le,X).score,ge=Se.length>0?Math.round(re/Se.length*100):0;I(re),Y(ge),pe.debug(" Test results calculated:",{score:re,percentage:ge})}catch(ce){throw pe.error(" Error loading specific test results:",ce),ce}},[]),V=S.useCallback(async(X=0)=>{pe.debug(" Loading all student results using existing test results API...",X>0?`(retry ${X})`:"");try{if(!(u?.student_id||u?.sub))throw new Error("Student ID not found");const le=await hn.getStudentTestResults();if(le.success){pe.debug(" All student results loaded:",le.results.length,"results");const ce=le.results.map(Se=>({...Se,caught_cheating:Se.caught_cheating||!1,visibility_change_times:Se.visibility_change_times||0}));N(ce),ne(new Date),le.results.length===0&&X===0&&(pe.debug(" No results found, retrying in 2 seconds..."),setTimeout(()=>{V(1)},2e3))}else throw new Error(le.error||"Failed to load student results")}catch(ie){pe.error(" Error loading all student results:",ie),w(ie.message)}},[u]),W=S.useCallback(X=>({"Listening and Speaking":"L&S","Reading and Writing":"R&W","English for Career":"Eng for Career","Science Fundamental":"Science F","Science Supplementary":"Science S","Math Fundamental":"Math F","Math Supplementary":"Math S","English for Communication":"Eng for Comm"})[X]||X,[]),R=S.useCallback(X=>{if(!X||X.length===0)return l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No results available"})});const ie=a?X:X.slice(0,o);return l.jsxs("div",{className:"overflow-x-auto",children:[l.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Result"}),l.jsx("th",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ie.map((le,ce)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs font-medium text-gray-900",children:l.jsx("span",{className:"bg-blue-100 text-blue-800 px-0.5 sm:px-2 py-0.5 rounded text-xs",children:W(le.subject)})}),l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-12 sm:max-w-none",children:le.teacher_name}),l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-16 sm:max-w-none",children:le.test_name}),l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500",children:l.jsx("div",{className:"flex flex-col items-center space-y-1",children:le.test_type==="drawing"?le.score!==null?l.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${(()=>{const{score:Se,maxScore:re,percentage:ge}=L(le);return ge>=80?"bg-green-100 text-green-800":ge>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"})()}`,children:(()=>{const{score:Se,maxScore:re,percentage:ge}=L(le);return`${Se}/${re} (${ge}%)`})()}):l.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):le.test_type==="speaking"?le.score!==null?l.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${(()=>{const{score:Se,maxScore:re,percentage:ge}=L(le);return ge>=80?"bg-green-100 text-green-800":ge>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"})()}`,children:(()=>{const{score:Se,maxScore:re,percentage:ge}=L(le);return`${Se}/${re} (${ge}%)`})()}):l.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):l.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${(()=>{const{score:Se,maxScore:re,percentage:ge}=L(le);return ge>=80?"bg-green-100 text-green-800":ge>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"})()}`,children:(()=>{const{score:Se,maxScore:re,percentage:ge}=L(le);return`${Se}/${re} (${ge}%)`})()})})}),l.jsx("td",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:new Date(le.submitted_at).toLocaleDateString()})]},ce))})]}),X.length>o&&i&&l.jsx("div",{className:"text-center pt-4",children:l.jsx("button",{onClick:i,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:a?"Show Less":`Show ${X.length-o} More`})})]})},[W,a,o,i]),U=S.useCallback((X,ie)=>{if(pe.debug(" formatAnswer called with:",{answer:X,testType:ie,answerType:typeof X}),!X)return"No answer";switch(ie){case"true_false":const le=typeof X=="boolean"?X:X==="true";return pe.debug(" Boolean answer processed:",le),le?"True":"False";case"multiple_choice":return X.toUpperCase();case"input":return X;case"word_matching":return typeof X=="object"?Object.entries(X).map(([ce,Se])=>`${ce}  ${Se}`).join(", "):X;case"drawing":return"Drawing submitted";default:return X}},[]),q=S.useCallback(()=>!E||!F||!r?null:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:["Test Results: ",E.test_name||E.title||"Test"]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-blue-600",children:j}),l.jsx("p",{className:"text-sm text-gray-500",children:"Correct Answers"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900",children:F.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Total Questions"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:`text-3xl font-bold ${B>=80?"text-green-600":B>=60?"text-yellow-600":"text-red-600"}`,children:[B,"%"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Score"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Questions Review"}),l.jsx("div",{className:"space-y-4",children:F.map((X,ie)=>{const le=r[ie],ce=Qy(X,e),Se=Sm(X,le,e);return l.jsxs("div",{className:`border rounded-lg p-4 ${Se?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsxs("h4",{className:"font-medium text-gray-900",children:["Question ",ie+1]}),l.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${Se?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Se?"Correct":"Incorrect"})]}),l.jsx("p",{className:"text-gray-700 mb-3",children:X.question}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Your Answer:"}),l.jsx("p",{className:"text-sm text-gray-900",children:U(le,e)})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Correct Answer:"}),l.jsx("p",{className:"text-sm text-gray-900",children:U(ce,e)})]})]})]},ie)})})]})]}),[E,F,r,e,j,B,Qy,Sm,U]),Q=S.useCallback(()=>{if(!b||b.length===0)return l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No test results available yet."})});const X={};return b.forEach(ie=>{const le=ie.subject||"Unknown Subject";X[le]||(X[le]=[]),X[le].push(ie)}),l.jsx("div",{className:"space-y-6",children:Object.entries(X).map(([ie,le])=>l.jsxs("div",{className:"bg-white rounded-lg shadow",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ie})}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:le.map((ce,Se)=>{const{score:re,maxScore:ge,percentage:Ee}=L(ce),Ae=Ee>=80?"text-green-600":Ee>=60?"text-yellow-600":"text-red-600";return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:ce.test_name}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ce.teacher_name||"Unknown"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:l.jsxs("span",{className:Ae,children:[re,"/",ge," (",Ee,"%)"]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(ce.submitted_at).toLocaleDateString()})]},Se)})})]})})]},ie))})},[b]);S.useCallback(()=>{pe.debug(" Clearing test data and returning to cabinet..."),P(null),A([]),setStudentAnswers(null),I(0),Y(0),ae(!1),n?n():c("/student")},[n,c]);const se=S.useCallback(()=>{pe.debug(" Navigating back to cabinet..."),n?n():c("/student")},[n,c]);return S.useCallback((X,ie)=>{const le={id:Date.now(),message:X,type:ie,timestamp:new Date};k(ce=>[...ce,le]),setTimeout(()=>{k(ce=>ce.filter(Se=>Se.id!==le.id))},N0.NOTIFICATION_DURATION)},[]),p?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(zr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Student Results..."})]})}):v?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:v}),l.jsx(Ye,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?l.jsxs("div",{children:[p?l.jsxs("div",{className:"text-center py-8",children:[l.jsx(zr,{size:"md"}),l.jsx("p",{className:"mt-2 text-gray-600",children:"Loading results..."})]}):v?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-red-500 text-4xl mb-2",children:""}),l.jsx("p",{className:"text-red-600",children:v})]}):R(b),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:C.map(X=>l.jsx(uc,{type:X.type,message:X.message,onClose:()=>k(ie=>ie.filter(le=>le.id!==X.id))},X.id))})]}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Results"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",ee?ee.toLocaleString():"Never"]})]}),l.jsxs("div",{className:"flex space-x-3",children:[E&&l.jsx(Ye,{variant:"outline",onClick:()=>ae(!Z),children:Z?"Hide Details":"Show Details"}),l.jsx(Ye,{variant:"outline",onClick:se,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:Z&&E?q():Q()}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:C.map(X=>l.jsx(uc,{type:X.type,message:X.message,onClose:()=>k(ie=>ie.filter(le=>le.id!==X.id))},X.id))}),selectedDrawing&&l.jsx(zB,{drawing:selectedDrawing,isOpen:isDrawingModalOpen,onClose:()=>setIsDrawingModalOpen(!1)})]})},Jae=({isMenuOpen:e,onToggleMenu:t,onShowPasswordChange:r})=>{const n=Eo(),{user:s,isAuthenticated:a,logout:i}=cs(),{studentData:o,loadStudentData:c}=r2(),{activeTests:u,testResults:d,loadActiveTests:h,loadTestResults:g,viewTestDetails:p,testDetailsModal:x,closeTestDetailsModal:v}=zv(),[w,C]=S.useState(!0),[k,b]=S.useState(""),[N,E]=S.useState([]),[P,F]=S.useState(null),[A,j]=S.useState(!1),[I,B]=S.useState(null),[Y,Z]=S.useState(null),[ae,ee]=S.useState(new Set),[ne,L]=S.useState(!1),[H,M]=S.useState(!1),[V,W]=S.useState(!1),[R,U]=S.useState(!1);S.useEffect(()=>{q()},[]),S.useEffect(()=>()=>{W(!1)},[]),S.useEffect(()=>{if(V){const ge=setTimeout(()=>{W(!1)},1e3);return()=>clearTimeout(ge)}},[V]);const q=S.useCallback(async()=>{pe.debug(" Initializing Student Cabinet...");try{if(C(!0),b(""),!a||!s){pe.debug(" User not authenticated, redirecting to login"),n("/login");return}if(s.role!==Ji.STUDENT){pe.error(" Invalid user role for student cabinet:",s.role),b("Access denied. Student role required.");return}pe.debug(" Loading active tests (single API call)...");const ge=s?.student_id||s?.id||"";if(Q(ge)){pe.debug(" Cache refresh triggered - clearing cache");try{const Ae=`student_active_tests_${ge}`,He=`student_results_table_${ge}`;localStorage.removeItem(Ae),localStorage.removeItem(He)}catch{}}else pe.debug(" Using existing cache - no refresh needed");try{localStorage.removeItem(`student_active_tests_${ge}`)}catch{}await h(ge),pe.debug(" Student Cabinet initialization complete!")}catch(ge){pe.error(" Error initializing student cabinet:",ge),b("Failed to initialize student cabinet")}finally{C(!1)}},[a,s,n]),Q=S.useCallback(ge=>{if(window.studentCabinetRefreshRequested)return window.studentCabinetRefreshRequested=!1,pe.debug(" Manual refresh requested"),!0;if(window.recentTestCompleted)return window.recentTestCompleted=!1,pe.debug(" Test completed - cache refresh triggered"),!0;const Ee=localStorage.getItem(`last_cabinet_refresh_${ge}`);if(Ee&&Date.now()-parseInt(Ee)>1800*1e3)return pe.debug(" Time-based refresh triggered"),!0;try{for(let Ae=0;Ae<localStorage.length;Ae++){const He=localStorage.key(Ae);if(He&&He.startsWith(`retest_assignment_id_${ge}_`))return pe.debug(" Retest assignment key detected, forcing cache refresh:",He),!0}}catch{}return pe.debug(" No refresh triggers - using existing cache"),!1},[]);S.useCallback(async()=>{pe.debug(" Calculating average score...");try{if(d&&d.length>0){const ge=d.reduce((Ae,He)=>{const Be=He.best_retest_score||He.score,Rt=He.best_retest_max_score||He.max_score;return typeof Be=="number"&&typeof Rt=="number"&&Rt>0?Ae+Math.round(Be/Rt*100):Ae},0),Ee=Math.round(ge/d.length);Z(Ee),pe.debug(" Average score calculated:",Ee)}}catch(ge){pe.error(" Error calculating average score:",ge)}},[d]),S.useEffect(()=>{if(V){pe.debug(" Skipping completed tests initialization during navigation");return}const ge=s?.student_id||s?.id;if(!ge){pe.debug(" Student ID not available yet, skipping localStorage initialization");return}const Ee=new Set;for(let Ae=0;Ae<localStorage.length;Ae++){const He=localStorage.key(Ae);if(He&&He.startsWith(`test_completed_${ge}_`)&&localStorage.getItem(He)==="true"){const Rt=He.replace(`test_completed_${ge}_`,"").split("_");if(Rt.length>=2){const et=Rt[0],vt=Rt.slice(1).join("_"),xt=`${et}_${vt}`;Ee.add(xt),pe.debug(" Found completed test in localStorage:",xt)}}}ee(Ee),U(!0),pe.debug(" Initialized completed tests from localStorage:",Array.from(Ee))},[s?.student_id,s?.id,V]),S.useEffect(()=>{pe.debug(" testResults structure:",d);const ge=d?.results||d;if(pe.debug(" resultsArray:",ge),ge&&ge.length>0){const Ee=s?.student_id||s?.id||"",Ae=new Set;ge.forEach(He=>{const Be=`${He.test_type}_${He.test_id}`;Ae.add(Be),localStorage.setItem(`test_completed_${Ee}_${He.test_type}_${He.test_id}`,"true")}),ee(He=>{const Be=new Set([...He,...Ae]);return pe.debug(" Updated completed tests (merged):",Array.from(Be)),Be})}},[d,s?.student_id,s?.id]);const se=S.useCallback(async(ge,Ee,Ae=!1,He=null)=>{pe.debug(" Checking test completion:",ge,Ee,"retestAvailable:",Ae);try{const Be=s?.student_id||s?.id||"";if(Ae){pe.debug(" Retest available from backend, checking attempt limits.");const xt=[];for(let Dt=1;Dt<=10;Dt++){const Mt=`retest_attempt${Dt}_${Be}_${ge}_${Ee}`;localStorage.getItem(Mt)==="true"&&xt.push(Mt)}const it=xt.length,ht=He?.retest_attempts_left||He?.max_attempts||3;return pe.debug(" Current attempts:",it,"Max attempts:",ht,"Attempt keys:",xt),it>=ht?(pe.debug(" Maximum retest attempts reached in localStorage"),!0):(pe.debug(" Retest attempts available, allowing start."),!1)}const Rt=`test_completed_${Be}_${ge}_${Ee}`,et=localStorage.getItem(Rt);if(pe.debug(" localStorage key:",Rt),pe.debug(" localStorage value:",et),ge==="word_matching"){pe.debug(" Debug: All localStorage keys for student",Be);for(let xt=0;xt<localStorage.length;xt++){const it=localStorage.key(xt);it&&it.includes(Be)&&it.includes("word_matching")&&pe.debug(" Found word_matching key:",it,"=",localStorage.getItem(it))}}if(et==="true")return pe.debug(" Found completion status in local storage:",et),!0;const vt=d?.results||d;return vt&&vt.length>0&&(pe.debug(" Checking database results:",vt.length,"results"),vt.some(it=>(pe.debug(" Checking result:",it.test_type,it.test_id,"vs",ge,Ee),it.test_type===ge&&it.test_id===Ee)))?(pe.debug(" Found completion status in database results"),localStorage.setItem(Rt,"true"),!0):(pe.debug(" Test not completed according to local storage or database"),!1)}catch(Be){return pe.error(" Error checking test completion:",Be),!1}},[d,s?.student_id,s?.id]),X=S.useCallback((ge,Ee)=>{const Ae={id:Date.now(),message:ge,type:Ee,timestamp:new Date};E(He=>[...He,Ae]),setTimeout(()=>{E(He=>He.filter(Be=>Be.id!==Ae.id))},N0.NOTIFICATION_DURATION)},[]),ie=S.useCallback(async ge=>{pe.debug(" Showing test details:",ge);try{await p(ge.test_type,ge.test_id,ge.test_name)}catch(Ee){pe.error("Error loading test details:",Ee),X("Failed to load test details","error")}},[p,X]),le=S.useCallback(ge=>{pe.debug(" Starting test:",ge);const Ee=`${ge.test_type}_${ge.test_id}`;if(ae.has(Ee)&&!ge?.retest_available){X("This test has already been completed","warning");return}if(pe.debug(" Checking retest conditions:"),pe.debug(" test.retest_available:",ge?.retest_available),pe.debug(" testKey:",Ee),pe.debug(" completedTests.has(testKey):",ae.has(Ee)),pe.debug(" completedTests:",Array.from(ae)),ge?.retest_available){const Ae=s?.student_id||s?.id||"",He=`retest1_${Ae}_${ge.test_type}_${ge.test_id}`;localStorage.setItem(He,"true"),pe.debug(" Set retest key:",He);try{const Be=`test_completed_${Ae}_${ge.test_type}_${ge.test_id}`;localStorage.removeItem(Be);const Rt=`${ge.test_type}_${ge.test_id}`;localStorage.removeItem(Rt),pe.debug(" Cleared completion keys for retest:",Be,Rt);const et=`retest_in_progress_${Ae}_${ge.test_type}_${ge.test_id}`;localStorage.setItem(et,"1"),pe.debug(" Set in-progress retest lock:",et);try{const vt=`anti_cheating_${Ae}_${ge.test_type}_${ge.test_id}`;localStorage.removeItem(vt);const xt=`speaking_test_data_${Ae}_${ge.test_id}`;localStorage.removeItem(xt);const it=`speaking_progress_${ge.test_id}`;localStorage.removeItem(it);const ht=`_${Ae}_${ge.test_type}_${ge.test_id}`,Dt=[];for(let Xe=0;Xe<localStorage.length;Xe++){const De=localStorage.key(Xe);De&&(De.endsWith(ht)||De.includes(`answers_${Ae}_${ge.test_type}_${ge.test_id}`)||De.includes(`progress_${Ae}_${ge.test_type}_${ge.test_id}`)||De.includes(`state_${Ae}_${ge.test_type}_${ge.test_id}`)||De.includes(`selected_${Ae}_${ge.test_type}_${ge.test_id}`))&&Dt.push(De)}Dt.forEach(Xe=>localStorage.removeItem(Xe)),pe.debug(" Cleared generic cached keys for retest start:",Dt);const Mt=`retest_attempts_${Ae}_${ge.test_type}_${ge.test_id}`;pe.debug(" Cleared per-test cached keys for retest start:",{antiCheatKey:vt,speakingCacheKey:xt,speakingProgressKey:it})}catch{}}catch{}if(pe.debug(" Test retest_assignment_id:",ge.retest_assignment_id),pe.debug(" Test retest_assignment_id type:",typeof ge.retest_assignment_id),ge?.retest_assignment_id){const Be=`retest_assignment_id_${Ae}_${ge.test_type}_${ge.test_id}`;localStorage.setItem(Be,String(ge.retest_assignment_id)),pe.debug(" Set retest assignment ID:",Be,"=",ge.retest_assignment_id)}else pe.debug(" No retest assignment ID found in test data")}else pe.debug(" Retest assignment ID storage skipped - retest not available");if(W(!0),pe.debug(" Set isStartingTest to true for test:",ge.test_type),ge.test_type==="matching_type"){pe.debug(" Redirecting to matching test page for testId:",ge.test_id),n(`/student/matching-test/${ge.test_id}`);return}if(ge.test_type==="word_matching"){pe.debug(" Redirecting to word matching test page for testId:",ge.test_id),n(`/student/word-matching-test/${ge.test_id}`);return}if(ge.test_type==="speaking"){pe.debug(" Redirecting to speaking test page for testId:",ge.test_id),n(`/student/speaking-test/${ge.test_id}`);return}n(`/student/test/${ge.test_type}/${ge.test_id}`)},[n,ae,X,s?.student_id,s?.id]),ce=S.useCallback(()=>{L(ge=>!ge)},[]),Se=S.useCallback(()=>{M(ge=>!ge)},[]),re=S.useCallback(async ge=>{if(pe.debug(" Starting test:",ge),V){pe.debug(" Test already starting, ignoring click");return}try{if(await se(ge.test_type,ge.test_id,ge?.retest_available,ge)&&!ge?.retest_available){X("This test has already been completed","warning");return}le(ge)}catch(Ee){pe.error(" Error starting test:",Ee),X("Failed to start test. Please try again.","error")}},[se,le,X,V]);return S.useCallback(ge=>{pe.debug(" Viewing test details:",ge),ie(ge)},[ie]),w?l.jsx(nt.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:l.jsxs(nt.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx(zr,{size:"lg"}),l.jsx(nt.p,{className:"mt-4 text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.3},children:"Loading Student Cabinet..."})]})}):k?l.jsx(nt.div,{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:l.jsx(nt.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:l.jsxs(nt.div,{className:"bg-white border border-red-200 rounded-xl p-8 max-w-md shadow-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,duration:.3},children:[l.jsx(nt.div,{className:"text-4xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.3,type:"spring"},children:""}),l.jsx("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Cabinet Error"}),l.jsx("p",{className:"text-red-600 mb-6",children:k}),l.jsx(Ye,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs(nt.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(nt.div,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-6",children:[l.jsxs(nt.div,{className:"flex items-center space-x-4",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(nt.div,{className:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:l.jsx("span",{className:"text-white font-semibold text-xl",children:s?.name?.charAt(0)||"S"})})}),l.jsxs("div",{children:[l.jsxs("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold text-white",children:[s?.name," ",s?.surname]}),l.jsxs("p",{className:"text-blue-100 text-sm sm:text-base md:text-lg",children:["Grade ",s?.grade," - Class ",s?.class]})]})]}),l.jsxs(nt.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsxs("button",{onClick:t,className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",style:{zIndex:1e3},children:[l.jsx("span",{className:"hidden sm:inline",children:"Menu"}),l.jsx(nt.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:e?180:0},transition:{duration:.2},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),l.jsx(wo,{children:e&&l.jsx(nt.div,{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:l.jsxs("div",{className:"py-2",children:[l.jsx(nt.button,{onClick:r,className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),l.jsx(nt.button,{onClick:()=>{t(),i()},className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),l.jsxs(nt.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:[l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:l.jsx("div",{className:"lg:col-span-1 space-y-6",children:Y!==null&&l.jsx(nt.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7,duration:.5},children:l.jsxs(Nt,{children:[l.jsx(Nt.Header,{children:l.jsx(Nt.Title,{children:"Average Score"})}),l.jsx(Nt.Body,{children:l.jsxs(nt.div,{className:"text-center",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.8,duration:.3},children:[l.jsxs(nt.div,{className:"text-4xl font-bold text-blue-600 mb-2",initial:{scale:0},animate:{scale:1},transition:{delay:.9,duration:.5,type:"spring"},children:[Y,"%"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Overall Performance"})]})})]})})})}),l.jsxs("div",{className:"space-y-6",children:[l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:l.jsxs(Nt,{children:[l.jsx(Nt.Header,{children:l.jsx(Nt.Title,{className:"text-center",children:"Active Tests"})}),l.jsx(Nt.Body,{children:u&&u.length>0?l.jsxs("div",{className:"relative",children:[pe.debug(" Rendering overlay, isStartingTest:",V),V&&l.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50 rounded-lg border-2 border-blue-200",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Starting test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait..."})]})}),l.jsxs("div",{className:"space-y-4",children:[(ne?u:u.slice(0,3)).map((ge,Ee)=>l.jsx(nt.div,{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:ne?0:.7+Ee*.1,duration:.3},whileHover:{scale:1.02},children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[l.jsx("h3",{className:"text-sm sm:text-lg font-medium text-gray-900 w-16 sm:w-auto break-words leading-tight line-clamp-2 sm:line-clamp-none",children:ge.test_name}),l.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:ge.subject}),l.jsx("span",{className:"text-gray-500",children:ge.teacher_name}),l.jsxs("span",{className:"text-gray-500",children:[l.jsx("span",{className:"sm:hidden",children:new Date(ge.assigned_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}),l.jsx("span",{className:"hidden sm:inline",children:new Date(ge.assigned_at).toLocaleDateString()})]})]})}),l.jsx("div",{className:"flex space-x-2 ml-4",children:(()=>{const Ae=`${ge.test_type}_${ge.test_id}`,He=ae.has(Ae);if(!R)return l.jsx(Ye,{variant:"secondary",size:"sm",disabled:!0,className:"bg-gray-100 text-gray-500 border-gray-200",children:"Loading..."});if(He&&ge?.retest_available){const Be=s?.student_id||s?.id||"";let Rt=!1;try{const et=localStorage.getItem(`retest_attempts_${Be}_${ge.test_type}_${ge.test_id}`);if(et){const vt=JSON.parse(et);typeof vt?.used=="number"&&typeof vt?.max=="number"&&vt.used>=vt.max&&(Rt=!0)}}catch{}return Rt?l.jsx(Ye,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):l.jsx(Ye,{variant:"primary",size:"sm",onClick:()=>re(ge),disabled:V,children:"Start Retest"})}return He?l.jsx(Ye,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):(pe.debug(" Button render, isStartingTest:",V,"test:",ge.test_type),l.jsx(Ye,{variant:"primary",size:"sm",onClick:()=>re(ge),disabled:V,children:"Start Test"}))})()})]})},`${ge.test_type}_${ge.test_id}`)),u.length>3&&l.jsx("div",{className:"text-center pt-2",children:l.jsx("button",{onClick:ce,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:ne?"Show Less":`Show ${u.length-3} More`})})]})]}):l.jsxs(nt.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.3},children:[l.jsx(nt.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.8,duration:.5,type:"spring"},children:""}),l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Active Tests"}),l.jsx("p",{className:"text-gray-500",children:"No active tests available for your class at the moment."})]})})]})}),l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:l.jsxs(Nt,{children:[l.jsx(Nt.Header,{children:l.jsx(Nt.Title,{children:"Test Results"})}),l.jsx(Nt.Body,{children:d&&d.showResults?l.jsx(Wv,{testResults:d,onBackToCabinet:()=>{setTestResults(null)},onRetakeTest:(ge,Ee)=>{h(),setTestResults(null)},isLoading:w}):l.jsx(WB,{compact:!0,showAll:H,onToggleShowAll:Se,maxInitial:3})})]})})]})]}),l.jsx(FB,{isOpen:x.isOpen,onClose:v,testType:x.testType,testId:x.testId,testName:x.testName,questions:x.questions||[],isLoading:x.isLoading||!1}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:N.map(ge=>l.jsx(uc,{type:ge.type,message:ge.message,onClose:()=>E(Ee=>Ee.filter(Ae=>Ae.id!==ge.id))},ge.id))})]})},Zae=({testInfo:e,questions:t,testType:r,studentAnswers:n,onBackToCabinet:s,checkAnswerCorrectness:a,formatStudentAnswerForDisplay:i,getCorrectAnswer:o})=>{const[c,u]=S.useState(0),[d,h]=S.useState(0),[g,p]=S.useState(!0);if(S.useEffect(()=>{const w=()=>{try{const C=wf(t,n,r).score,k=e?.num_questions||t?.length||0,b=k>0?Math.round(C/k*100):0;u(C),h(b),p(!1)}catch(C){console.error("Error calculating test results:",C),u(0),h(0),p(!1)}};t&&t.length>0?w():p(!1)},[t,n,r,e,wf]),g)return l.jsx("div",{className:"flex justify-center items-center min-h-64",children:l.jsx("div",{className:"text-lg",children:"Calculating results..."})});const x=e?.num_questions||t?.length||0,v=e?.test_name||e?.title||"Test";return l.jsxs("div",{className:"test-results-page max-w-4xl mx-auto p-6 overflow-y-auto min-h-screen",children:[l.jsx(Nt,{className:"mb-6",children:l.jsxs("div",{className:"results-header text-center",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:["Test Results: ",v]}),l.jsx("p",{className:"text-gray-600",children:r==="matching_type"?"Matching Test":r==="multiple_choice"?"Multiple Choice Test":r==="true_false"?"True/False Test":r==="input"?"Input Test":r==="drawing"?"Drawing Test":"Test"})]})}),l.jsx(Nt,{className:"mb-6",children:l.jsxs("div",{className:"results-summary",children:[l.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 text-center",children:["Your Score: ",c," / ",x," (",d,"%)"]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-4",children:l.jsx("div",{className:`h-4 rounded-full transition-all duration-500 ${d>=80?"bg-green-500":d>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${d}%`}})}),l.jsx("div",{className:"text-center",children:l.jsx("p",{className:`text-lg font-medium ${d>=80?"text-green-600":d>=60?"text-yellow-600":"text-red-600"}`,children:d>=80?"Excellent!":d>=60?"Good job!":"Keep practicing!"})})]})}),t&&t.length>0&&l.jsx(Nt,{className:"mb-6",children:l.jsxs("div",{className:"questions-review",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Question Review"}),l.jsx("div",{className:"space-y-4",children:t.map((w,C)=>{const k=n[String(w.question_id)]||"No answer";console.log(" TestResultsDisplay - Question",C+1,":",{question:w,studentAnswer:k,testType:r});const b=a(w,k,r);return console.log(" TestResultsDisplay - isCorrect result:",b),l.jsxs("div",{className:`question-review p-4 rounded-lg border-2 ${b?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[l.jsxs("div",{className:"question-review-header flex justify-between items-start mb-3",children:[l.jsxs("h4",{className:"text-lg font-medium text-gray-800",children:["Question ",C+1]}),l.jsx("span",{className:`text-2xl font-bold ${b?"text-green-600":"text-red-600"}`,children:b?"":""})]}),l.jsx("div",{className:"question-text mb-3",children:l.jsx("p",{className:"text-gray-700 font-medium",children:w.question})}),l.jsxs("div",{className:"answer-section space-y-2",children:[l.jsxs("p",{className:"student-answer",children:[l.jsx("strong",{className:"text-gray-600",children:"Your Answer:"})," ",l.jsx("span",{className:`font-medium ${b?"text-green-700":"text-red-700"}`,children:i(k,r,w)})]}),!b&&l.jsxs("p",{className:"correct-answer",children:[l.jsx("strong",{className:"text-gray-600",children:"Correct Answer:"})," ",l.jsx("span",{className:"text-green-700 font-medium",children:r==="multiple_choice"?String(w.correct_answer||"").toUpperCase():i(o(w,r),r,w)})]})]})]},w.question_id||C)})})]})}),l.jsx(Nt,{children:l.jsx("div",{className:"results-actions text-center",children:l.jsx(Ye,{onClick:s,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 text-lg font-medium",children:"Back to Cabinet"})})})]})};class eie{constructor(){this.activeRequests=new Map,this.completedRequests=new Map,this.maxCacheSize=100,this.cacheTimeout=3e4}generateKey(t,r,n={}){const s=Object.keys(n).sort().reduce((a,i)=>(a[i]=n[i],a),{});return`${t}_${r}_${JSON.stringify(s)}`}isRequestInProgress(t){return this.activeRequests.has(t)}getCachedResult(t){const r=this.completedRequests.get(t);return r&&Date.now()-r.timestamp<this.cacheTimeout?r.result:null}startRequest(t,r){return this.activeRequests.set(t,r),r.finally(()=>{this.activeRequests.delete(t)}),r}cacheResult(t,r){if(this.completedRequests.size>=this.maxCacheSize){const n=this.completedRequests.keys().next().value;this.completedRequests.delete(n)}this.completedRequests.set(t,{result:r,timestamp:Date.now()})}async deduplicateApiCall(t,r,n,s){const a=this.generateKey(t,r,n);if(this.isRequestInProgress(a))return console.log(" API deduplication: Request already in progress, waiting...",a),this.activeRequests.get(a);const i=this.getCachedResult(a);if(i)return console.log(" API deduplication: Using cached result",a),i;console.log(" API deduplication: Making new request",a);const o=this.startRequest(a,s());try{const c=await o;return this.cacheResult(a,c),c}catch(c){throw c}}clearCache(){this.activeRequests.clear(),this.completedRequests.clear(),console.log(" API deduplication: Cache cleared")}}const NF=new eie,tie=(e,t)=>{let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>e.apply(null,n),t)}},rie=({onBackToCabinet:e,currentTest:t})=>{const r=Eo(),{user:n,isAuthenticated:s}=cs(),{activeTests:a,loadActiveTests:i}=zv(),o=S.useCallback(tie((Fe,st,ke)=>{try{if(window.skipInitialProgressSave&&ke.answers&&ke.answers.length===0){pe.debug(" Skipping empty progress save during restoration"),window.skipInitialProgressSave=!1;return}const Qe=`test_progress_${n?.student_id||n?.id||"unknown"}_${Fe}_${st}`,Pt=localStorage.getItem(Qe);if(Pt&&ke.answers&&ke.answers.length===0)try{const zt=JSON.parse(Pt);if(zt.answers&&zt.answers.length>0){pe.debug(" Skipping empty progress save - existing progress is better:",zt.answers);return}}catch{}localStorage.setItem(Qe,JSON.stringify(ke)),pe.debug(`Saved test progress for ${Fe}_${st}:`,ke)}catch(We){pe.error("Error saving test progress:",We)}},1e3),[n?.student_id,n?.id]),c=S.useCallback((Fe,st,ke)=>{o(Fe,st,ke)},[o]),u=S.useCallback((Fe,st)=>{try{const We=`test_progress_${n?.student_id||n?.id||"unknown"}_${Fe}_${st}`,Qe=localStorage.getItem(We);return Qe?JSON.parse(Qe):null}catch(ke){return pe.error("Error getting test progress:",ke),null}},[n?.student_id,n?.id]),d=S.useCallback((Fe,st)=>{try{const ke=n?.student_id||n?.id||"unknown",We=`test_progress_${ke}_${Fe}_${st}`;localStorage.removeItem(We);for(let Qe=0;Qe<localStorage.length;Qe++){const Pt=localStorage.key(Qe);Pt&&Pt.startsWith(`test_progress_${ke}_${Fe}_${st}_`)&&(localStorage.removeItem(Pt),pe.debug(` Cleared individual question key: ${Pt}`))}pe.debug(`Cleared test progress for ${Fe}_${st}`)}catch(ke){pe.error("Error clearing test progress:",ke)}},[n?.student_id,n?.id]),[h,g]=S.useState(!0),[p,x]=S.useState(!1),[v,w]=S.useState(""),[C,k]=S.useState(!1),[b,N]=S.useState(""),[E,P]=S.useState([]),[F,A]=S.useState(t?"test":"list"),[j,I]=S.useState(null),[B,Y]=S.useState(null),[Z,ae]=S.useState(null),[ee,ne]=S.useState([]),[L,H]=S.useState([]),[M,V]=S.useState(0),[W,R]=S.useState(0),[U,q]=S.useState(null),Q=Fs.useRef(null),se=Fs.useRef(null),[X,ie]=S.useState(!1),[le,ce]=S.useState(!1),[Se,re]=S.useState(null),[ge,Ee]=S.useState(null),[Ae,He]=S.useState(!1),[Be,Rt]=S.useState(!1),[et,vt]=S.useState({isInitialized:!1,initializationId:null,lastTestId:null,initializationCount:0}),[xt,it]=S.useState({isRestored:!1,restoredTestId:null,restorationCount:0}),{startTracking:ht,stopTracking:Dt,getCheatingData:Mt,clearData:Xe,isCheating:De,tabSwitches:Le}=Xm(j?.test_type,j?.test_id,n?.student_id||n?.id);S.useEffect(()=>{(()=>{const st=[];for(let ke=0;ke<localStorage.length;ke++){const We=localStorage.key(ke);if(We&&We.startsWith("test_progress_")&&!We.includes("_51712_")&&!We.includes("_51736_")){const Qe=We.split("_");Qe.length===4&&Qe[0]==="test"&&Qe[1]==="progress"&&st.push(We)}}st.forEach(ke=>{localStorage.removeItem(ke),pe.debug(" Cleared old cache key:",ke)})})()},[]);const lt=S.useCallback(()=>{const Fe=j?.test_id,st=n?.student_id||n?.id;if(!st||!Fe)return pe.debug(" Skipping initialization - missing required data:",{studentId:st,currentTestId:Fe}),!1;const ke=`${st}_${Fe}_${Date.now()}`;return et.isInitialized&&et.lastTestId===Fe?(pe.debug(" Already initialized for this test - skipping"),!1):et.initializationId?(pe.debug(" Initialization in progress - skipping duplicate"),!1):(pe.debug(" Starting initialization:",ke),vt({isInitialized:!1,initializationId:ke,lastTestId:Fe}),!0)},[et,j,n?.student_id,n?.id]),Ue=S.useCallback(()=>{vt(Fe=>({...Fe,isInitialized:!0,initializationId:null})),pe.debug(" Initialization completed")},[]),tt=S.useCallback(async()=>{pe.debug(" Initializing Student Tests...");try{if(g(!0),N(""),!s||!n){pe.debug(" User not authenticated"),N("User not authenticated");return}if(n.role!==Ji.STUDENT){pe.error(" Invalid user role for student tests:",n.role),N("Access denied. Student role required.");return}pe.debug(" Loading active tests..."),await i(),Ue(),pe.debug(" Student Tests initialization complete!")}catch(Fe){pe.error(" Error initializing student tests:",Fe),N("Failed to initialize student tests")}finally{g(!1)}},[s,n,i,Ue]);S.useEffect(()=>{lt()&&tt()},[lt,tt]),S.useEffect(()=>{t&&(pe.debug(" Auto-starting test from prop:",t),k(!0),qt(t))},[t]),S.useCallback(async()=>{pe.debug(" Loading student active tests...");try{const Fe=await hn.getActiveTests();pe.debug(" Active tests loaded:",Fe);const st=Fe.map(ke=>({...ke,subject_id:ke.subject_id||ke.subjectId,teacher_id:ke.teacher_id||ke.teacherId,is_active:ke.is_active!==void 0?ke.is_active:!0,created_at:ke.created_at||ke.createdAt,updated_at:ke.updated_at||ke.updatedAt}));return Ee(new Date),st}catch(Fe){throw pe.error(" Error loading active tests:",Fe),Fe}},[]),S.useCallback(async(Fe,st)=>{pe.debug(" Checking test completion:",Fe,st);try{const ke=u(Fe,st);return ke&&ke.completed}catch(ke){return pe.error(" Error checking test completion:",ke),!1}},[u]),S.useEffect(()=>{if(ee.length>0&&j?.test_id){const Fe=setTimeout(()=>{let st=!1;const ke=new Array(ee.length).fill("");if(ee.forEach((We,Qe)=>{const zt=`test_progress_${n?.student_id||n?.id||"unknown"}_${B}_${j?.test_id}_${We.question_id}`,rr=localStorage.getItem(zt);if(rr){const xr=rr.replace(/^"(.*)"$/,"$1");ke[Qe]=xr,st=!0}}),st){H(ke);const We=ke.filter(Pt=>Pt&&typeof Pt=="string"&&Pt.trim()!=="").length,Qe=ee.length>0?We/ee.length*100:0;V(Qe)}},100);return()=>clearTimeout(Fe)}},[ee,B,j?.test_id]);const Et=S.useCallback(async(Fe,st)=>{pe.debug(" Marking test as completed:",Fe,st);try{const ke=u(Fe,st)||{};ke.completed=!0,ke.completedAt=new Date().toISOString(),c(Fe,st,ke);const Qe=`test_completed_${n?.student_id||n?.id||""}_${Fe}_${st}`;localStorage.setItem(Qe,"true"),pe.debug(" Test completion marked in localStorage:",Qe),pe.debug(" localStorage value after setting:",localStorage.getItem(Qe)),me("Test marked as completed","success")}catch(ke){pe.error(" Error marking test as completed:",ke),me("Failed to mark test as completed","error")}},[u,c]),At=S.useCallback(Fe=>{pe.debug(" Showing test details:",Fe),re(Fe),ce(!0)},[]),qt=S.useCallback(async Fe=>{pe.debug(" Starting test:",Fe);let st=Date.now(),ke;try{w(""),x(!0),st=Date.now();const We=()=>{const Ce=Date.now()-st,ot=Math.max(0,250-Ce);setTimeout(()=>{g(!1),x(!1)},ot)};let Qe=!1;ke=setTimeout(()=>{Qe=!0,w("Loading is taking longer than expected...")},15e3);const zt=`test_completed_${n?.student_id||n?.id||""}_${Fe.test_type}_${Fe.test_id}`,rr=localStorage.getItem(zt)==="true";if(rr&&!Fe?.retest_available){pe.debug(" Test already completed, redirecting to main cabinet"),me("This test has already been completed","info"),r("/student");return}if(rr&&Fe?.retest_available&&pe.debug(" Test completed but retest available, allowing retest"),Fe.test_type===On.MATCHING){pe.debug(" Redirecting to matching test page for testId:",Fe.test_id),r(`/student/matching-test/${Fe.test_id}`);return}if(Fe.test_type===On.WORD_MATCHING){pe.debug(" Redirecting to word matching test page for testId:",Fe.test_id),r(`/student/word-matching-test/${Fe.test_id}`);return}I(Fe),Y(Fe.test_type),it({isRestored:!1,restoredTestId:null,restorationCount:0});const[xr,cr]=await Promise.all([NF.deduplicateApiCall("GET",`test-info-${Fe.test_type}-${Fe.test_id}`,{testType:Fe.test_type,testId:Fe.test_id},()=>hn.getTestInfo(Fe.test_type,Fe.test_id)),NF.deduplicateApiCall("GET",`test-questions-${Fe.test_type}-${Fe.test_id}`,{testType:Fe.test_type,testId:Fe.test_id},()=>hn.getTestQuestions(Fe.test_type,Fe.test_id))]);ae(xr);let qr=cr;try{if(!!xr?.is_shuffled){const Ke=n?.student_id||n?.id||"unknown",ot=`${Ke}:${Fe.test_type}:${Fe.test_id}`,mt=Array.from(ot).reduce((Yt,vr)=>(Yt<<5)-Yt+vr.charCodeAt(0),0)>>>0,Wt=`test_shuffle_order_${Ke}_${Fe.test_type}_${Fe.test_id}`,pt=localStorage.getItem(Wt);if(pt){const Yt=JSON.parse(pt),vr=new Map(cr.map(_r=>[_r.question_id,_r]));qr=Yt.map(_r=>vr.get(_r)).filter(Boolean)}else{const vr=function(gr){return function(){var Fr=gr+=1831565813;return Fr=Math.imul(Fr^Fr>>>15,Fr|1),Fr^=Fr+Math.imul(Fr^Fr>>>7,Fr|61),((Fr^Fr>>>14)>>>0)/4294967296}}(mt);qr=[...cr];for(let gr=qr.length-1;gr>0;gr--){const Fr=Math.floor(vr()*(gr+1));[qr[gr],qr[Fr]]=[qr[Fr],qr[gr]]}const _r=qr.map(gr=>gr.question_id);localStorage.setItem(Wt,JSON.stringify(_r))}}}catch(Ce){pe.error("Shuffle error (ignored):",Ce)}ne(qr),We();const ue=Fe.test_id;if(xt.isRestored&&xt.restoredTestId===ue){pe.debug(" Progress already restored for this test - skipping");return}pe.debug(" Starting progress restoration for test:",Fe.test_type,Fe.test_id),it(Ce=>({...Ce,restorationCount:Ce.restorationCount+1}));const we=n?.student_id||n?.id||"unknown",ye=`test_progress_${we}_${Fe.test_type}_${Fe.test_id}`,xe=localStorage.getItem(ye);pe.debug(" Checking main progress key:",ye),pe.debug(" Main progress data:",xe);let be=new Array(cr.length).fill("");if(xe)try{const Ce=JSON.parse(xe);pe.debug(" Parsed progress data:",Ce),Ce.answers&&Array.isArray(Ce.answers)&&(be=Ce.answers,pe.debug(" Loaded answers from main progress:",be))}catch(Ce){pe.error(" Error parsing main progress:",Ce)}cr.forEach((Ce,Ke)=>{const ot=`test_progress_${we}_${Fe.test_type}_${Fe.test_id}_${Ce.question_id}`,mt=localStorage.getItem(ot);if(pe.debug(` Checking individual answer for question ${Ce.question_id}:`,mt),mt){const Wt=mt.replace(/^"(.*)"$/,"$1");be[Ke]=Wt,pe.debug(` Loaded individual answer for question ${Ce.question_id}:`,Wt)}}),pe.debug(" Final initial answers after loading all sources:",be);const _e=be.filter(Ce=>Ce&&typeof Ce=="string"&&Ce.trim()!=="").length;if(_e>0){pe.debug(` Restoring progress: ${_e}/${cr.length} questions answered`),H(be);const Ce=cr.length>0?_e/cr.length*100:0;V(Ce),pe.debug(` Progress restored: ${Ce}% complete`)}else pe.debug(" No existing progress found - starting fresh"),H(be),V(0);it(Ce=>({...Ce,isRestored:!0,restoredTestId:ue})),_e>0&&(pe.debug(" Existing progress found - preventing overwrite during initialization"),window.skipInitialProgressSave=!0);const Ge=Number(xr?.allowed_time||0),ut=n?.student_id||n?.id||"unknown";if(Q.current=`test_timer_${ut}_${Fe.test_type}_${Fe.test_id}`,Ge>0)try{const Ce=localStorage.getItem(Q.current),Ke=Date.now();if(Ce){const ot=JSON.parse(Ce),mt=Math.floor((Ke-new Date(ot.lastTickAt).getTime())/1e3),Wt=Math.max(0,Number(ot.remainingSeconds||Ge)-Math.max(0,mt));R(Wt),se.current=Ke}else R(Ge),se.current=Ke,localStorage.setItem(Q.current,JSON.stringify({remainingSeconds:Ge,lastTickAt:new Date(Ke).toISOString(),startedAt:new Date(Ke).toISOString()}))}catch(Ce){pe.error("Timer cache init error:",Ce),R(Ge)}else R(0);const qe=new Date;q(qe),pe.debug(" Test timer started at:",qe.toISOString());const oe=n?.student_id||n?.id||"unknown",he=`anti_cheating_${oe}_${Fe.test_type}_${Fe.test_id}`,Te=localStorage.getItem(he);if(pe.debug(" Checking for anti-cheating data with key:",he),pe.debug(" Key format: anti_cheating_{studentId}_{testType}_{testId}"),pe.debug(" Current test details:",{testType:Fe.test_type,testId:Fe.test_id,studentId:oe}),Te)try{const Ce=JSON.parse(Te);pe.debug(" Found existing anti-cheating data for THIS test:",Ce),pe.debug(" Visibility change times for this test:",Ce.tabSwitches||0),pe.debug(" Cheating status for this test:",Ce.isCheating||!1),Ce.isCheating&&(pe.debug(" WARNING: Student has been flagged for cheating in THIS test!"),pe.debug(" Tab switches detected in this test:",Ce.tabSwitches),me(` Warning: Suspicious activity detected in this test (${Ce.tabSwitches} tab switches). Continued violations may result in test disqualification.`,"warning"))}catch(Ce){pe.error(" Error parsing existing anti-cheating data:",Ce)}else pe.debug(" No existing anti-cheating data found for this test - starting fresh");ht(),pe.debug(" Anti-cheating tracking started"),A("test"),pe.debug(" Test started successfully")}catch(We){pe.error(" Error starting test:",We),me("Failed to start test","error"),w("Failed to load test data. Please try again.")}finally{const We=Date.now()-st,Pt=Math.max(0,250-We);setTimeout(()=>{g(!1),x(!1)},Pt),k(!1);try{ke&&clearTimeout(ke)}catch{}}},[u]),pr=S.useCallback(async()=>{if(!j||!Z||!ee||!L){me("No test data to submit","error");return}pe.debug(" Submitting test:",j);try{ie(!0);const Fe=wf(ee,L,j.test_type),st=new Date,ke=U?Math.round((st-U)/1e3):0,We=U?U.toISOString():st.toISOString();pe.debug(" Test timing:",{startedAt:We,endTime:st.toISOString(),timeTaken:`${ke} seconds`});const Qe=Mt();pe.debug(" Anti-cheating data for submission:",Qe);const Pt={};ee.forEach((rr,xr)=>{Pt[rr.question_id]=L[xr]??""}),j.test_type==="drawing"&&(pe.debug(" Drawing test answers being submitted:",L),pe.debug(" Drawing test answers type:",typeof L[0]),pe.debug(" Drawing test answers content:",L[0]));const zt=await hn.submitTest(j.test_type,j.test_id,L,{time_taken:(()=>{const rr=Number(Z?.allowed_time||0);return rr>0?Math.min(ke,rr):ke})(),started_at:We,submitted_at:st.toISOString(),answers_by_id:Pt,question_order:ee.map(rr=>rr.question_id),caught_cheating:Qe.caught_cheating,visibility_change_times:Qe.visibility_change_times,retest_assignment_id:(()=>{const xr=`retest_assignment_id_${n?.student_id||n?.id||""}_${j.test_type}_${j.test_id}`,cr=localStorage.getItem(xr);return pe.debug(" Frontend retest key:",xr),pe.debug(" Frontend retest assignment ID from localStorage:",cr),pe.debug(" Frontend retest assignment ID converted:",cr?Number(cr):null),pe.debug(" Frontend current test data:",j),pe.debug(" Frontend current test retest_assignment_id:",j.retest_assignment_id),cr?Number(cr):null})(),parent_test_id:j.test_id},n);if(pe.debug(" Test submission result:",zt),zt.success){window.recentTestCompleted=!0,pe.debug(" Test completed - cache refresh triggered");const rr=n?.student_id||n?.id||"",xr=`retest1_${rr}_${j.test_type}_${j.test_id}`;if(localStorage.getItem(xr)==="true"){const xe=j?.retest_attempts_left||j?.max_attempts||3;if((zt?.percentage_score??0)>=50){const _e=`retest_attempt${xe}_${rr}_${j.test_type}_${j.test_id}`;localStorage.setItem(_e,"true"),pe.debug(" Passed retest, marking last-slot key:",_e),localStorage.removeItem(xr)}else{let _e=1;for(let ut=1;ut<=10;ut++){const qe=`retest_attempt${ut}_${rr}_${j.test_type}_${j.test_id}`;if(localStorage.getItem(qe)!=="true"){_e=ut;break}}const Ge=`retest_attempt${_e}_${rr}_${j.test_type}_${j.test_id}`;localStorage.setItem(Ge,"true"),pe.debug(" Marked retest attempt as completed:",Ge),_e>=xe&&localStorage.removeItem(xr)}}if(pe.debug(" Marking test as completed..."),await Et(j.test_type,j.test_id),j.test_type!=="drawing"){pe.debug(" Caching test results after submission...");const be=`student_results_table_${n?.student_id||n?.id||"unknown"}`,{setCachedData:_e,CACHE_TTL:Ge}=await Zi(async()=>{const{setCachedData:ut,CACHE_TTL:qe}=await Promise.resolve().then(()=>Vg);return{setCachedData:ut,CACHE_TTL:qe}},void 0);_e(be,zt,Ge.student_results_table),pe.debug(" Test results cached with key:",be)}else pe.debug(" Drawing test submitted - not caching results (will appear after teacher grades)");pe.debug(" Clearing test progress..."),d(j.test_type,j.test_id);try{const xe=n?.student_id||n?.id||"unknown",be=`test_timer_${xe}_${j.test_type}_${j.test_id}`;localStorage.removeItem(be);const _e=`test_shuffle_order_${xe}_${j.test_type}_${j.test_id}`;localStorage.removeItem(_e)}catch{}if(n?.student_id){const xe=`test_completed_${n.student_id}_${j.test_type}_${j.test_id}`;localStorage.setItem(xe,"true"),pe.debug(" Test marked as completed in localStorage:",xe)}try{const xe=n?.student_id||n?.id||"",be=`retest1_${xe}_${j.test_type}_${j.test_id}`,_e=`retest_assignment_id_${xe}_${j.test_type}_${j.test_id}`;localStorage.removeItem(be),localStorage.removeItem(_e),pe.debug(" Cleared retest keys:",be,_e)}catch(xe){pe.warn("Failed to clear retest keys:",xe)}pe.debug(" Clearing test progress and anti-cheating data for THIS test only...");const qr=n?.student_id||n?.id||"unknown",ue=[],we=`test_progress_${qr}_${j.test_type}_${j.test_id}`,ye=`anti_cheating_${qr}_${j.test_type}_${j.test_id}`;for(let xe=0;xe<localStorage.length;xe++){const be=localStorage.key(xe);be&&(be===we||be===ye)&&ue.push(be)}ue.forEach(xe=>{localStorage.removeItem(xe),pe.debug(` Cleared for THIS test only: ${xe}`)}),pe.debug(" Clearing anti-cheating data..."),Dt(),Xe(),j.test_type!=="drawing"?A("results"):r("/student"),me("Test submitted successfully!","success"),pe.debug(" Test submitted successfully")}else throw pe.error(" Test submission failed:",zt.error),new Error(zt.error||"Failed to submit test")}catch(Fe){pe.error(" Error submitting test:",Fe),me("Failed to submit test","error")}finally{ie(!1)}},[j,Z,ee,L,Et,d]);S.useCallback(()=>(pe.debug(" Collecting test answers..."),L),[L]);const Rr=S.useCallback(()=>{if(!ee||!L)return;const Fe=L.filter(ke=>ke&&typeof ke=="string"&&ke.trim()!=="").length,st=ee.length>0?Fe/ee.length*100:0;if(V(st),pe.debug(` Progress updated: ${Fe}/${ee.length} questions answered (${Math.round(st)}%)`),j){const ke={answers:L,progress:st,lastSaved:new Date().toISOString()};c(j.test_type,j.test_id,ke)}},[ee,L,j,c]);S.useEffect(()=>{Rr()},[Rr]);const Kr=S.useCallback(()=>{if(!L)return 0;const Fe=L.filter(st=>st&&typeof st=="string"&&st.trim()!=="").length;return pe.debug(" getAnsweredCount:",{studentAnswers:L,answeredCount:Fe,totalQuestions:ee?.length}),Fe},[L,ee]),ur=S.useCallback(()=>{if(pe.debug(" Navigating back to cabinet..."),j&&n?.student_id){pe.debug(" Cabinet navigation detected - counting as cheating attempt");const st=`anti_cheating_${n?.student_id||n?.id||"unknown"}_${j.test_type}_${j.test_id}`,ke=localStorage.getItem(st);let We=0,Qe=!1;if(ke)try{const xr=JSON.parse(ke);We=xr.tabSwitches||0,Qe=xr.isCheating||!1}catch(xr){pe.error(" Error parsing existing anti-cheating data:",xr)}const Pt=We+1,zt=Pt>=2;pe.debug(` Tab switch count: ${We}  ${Pt} (cheating: ${zt})`);const rr={tabSwitches:Pt,isCheating:zt,lastUpdated:new Date().toISOString()};localStorage.setItem(st,JSON.stringify(rr)),pe.debug(" Anti-cheating data updated for cabinet navigation:",rr)}e?e():r("/student")},[e,r,j,n?.student_id]);S.useCallback(()=>{pe.debug(" Showing test results..."),A("results")},[]);const ir=S.useCallback((Fe,st,ke=null)=>{switch(pe.debug(" Formatting student answer for display:",Fe,"testType:",st,"question:",ke),st){case On.MULTIPLE_CHOICE:if(Fe.toString().startsWith("Option "))return Fe;if(ke&&typeof Fe=="string"&&!isNaN(parseInt(Fe))){const We=parseInt(Fe),Qe=`option_${String.fromCharCode(97+We)}`,Pt=ke[Qe];if(Pt)return pe.debug(" Converted",Fe,"to option text:",Pt),Pt;{const zt=String.fromCharCode(65+We);return pe.debug(" Converted",Fe,"to",zt),zt}}else{if(typeof Fe=="string"&&isNaN(parseInt(Fe)))return pe.debug(" Already formatted text:",Fe),Fe;{const We=String.fromCharCode(65+parseInt(Fe));return pe.debug(" Converted",Fe,"to",We),We}}case On.TRUE_FALSE:return Fe==="true"?"True":"False";case On.INPUT:return Fe;case On.MATCHING:return typeof Fe=="object"?JSON.stringify(Fe):Fe;case On.WORD_MATCHING:return typeof Fe=="object"?JSON.stringify(Fe):Fe;case On.DRAWING:return Fe&&Fe.trim()!==""?"Drawing submitted":"No drawing";case On.FILL_BLANKS:return Fe;default:return pe.warn(" Unknown test type for answer formatting:",st),Fe}},[]),me=S.useCallback((Fe,st)=>{const ke={id:Date.now(),message:Fe,type:st,timestamp:new Date};P(We=>[...We,ke]),setTimeout(()=>{P(We=>We.filter(Qe=>Qe.id!==ke.id))},N0.NOTIFICATION_DURATION)},[]);S.useEffect(()=>{Rr()},[Rr]),S.useEffect(()=>{if(F!=="test")return;const Fe=Number(Z?.allowed_time||0);if(!Fe)return;const st=setInterval(()=>{R(ke=>{const We=Math.max(0,ke-1);try{const Qe=Date.now();se.current||(se.current=Qe),Q.current&&localStorage.setItem(Q.current,JSON.stringify({remainingSeconds:We,lastTickAt:new Date(Qe).toISOString(),startedAt:U?U.toISOString():new Date(Qe-(Fe-We)*1e3).toISOString()}))}catch{}return We===0&&pr(),We})},1e3);return()=>clearInterval(st)},[F,Z?.allowed_time,pr,U]);const Ne=S.useCallback((Fe,st)=>{if(!Fe)return null;const ke=(We,Qe)=>{const Pt=[...L];Pt[st]=Qe,H(Pt),pe.debug(` Answer changed: question ${We} = ${Qe}`),pe.debug(" Updated studentAnswers:",Pt)};switch(j.test_type){case On.TRUE_FALSE:return l.jsx(qse,{question:Fe,questionIndex:st,studentAnswer:L[st]||"",onAnswerChange:ke,mode:"student",testId:j?.test_id,testType:B,displayNumber:st+1});case On.MULTIPLE_CHOICE:return l.jsx(Yse,{question:Fe,questionIndex:st,studentAnswer:L[st]||"",onAnswerChange:ke,mode:"student",testId:j?.test_id,testType:B,displayNumber:st+1});case On.INPUT:return l.jsx(Xse,{question:Fe,questionIndex:st,studentAnswer:L[st]||"",onAnswerChange:ke,mode:"student",testId:j?.test_id,testType:B,displayNumber:st+1});case On.MATCHING:return pe.error("Matching test reached renderQuestion - this should not happen"),l.jsxs("div",{className:"text-center p-8",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-600 mb-4",children:"Matching Test"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"Redirecting to matching test page..."}),l.jsx(Ye,{onClick:()=>r("/student"),variant:"primary",children:"Back to Dashboard"})]});case On.DRAWING:return l.jsx(aae,{question:Fe,questionIndex:st,studentAnswer:L[st]||"",onAnswerChange:ke,mode:"student",testId:j?.test_id,testType:B});case On.FILL_BLANKS:return st===0?l.jsx(cae,{testText:Z?.test_text,blanks:(ee||[]).map((We,Qe)=>({id:We.question_id||Qe+1,options:We.blank_options||[],correct_answer:We.correct_answers?.[0]||We.correct_answer,question:We.question_json||""})),separateType:Z?.separate_type,testId:j?.test_id,testName:Z?.test_name||j?.test_name,teacherId:Z?.teacher_id||j?.teacher_id,subjectId:Z?.subject_id||j?.subject_id,onTestComplete:pr,onAnswerChange:(We,Qe)=>{const Pt=ee.findIndex(zt=>zt.question_id===We);if(Pt!==-1){const zt=[...L];zt[Pt]=Qe,H(zt),pe.debug(` Fill Blanks answer changed: question ${We} = ${Qe}`)}}},`fill-blanks-${j?.test_id}-${Z?.test_name}`):null;default:return l.jsx("div",{children:"Unsupported question type"})}},[j,L,B]);function Pe(){return!j||!Z||!ee?null:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:Z.test_name||Z.title||"Test"})}),l.jsx("div",{className:"mb-4",children:l.jsx(lae,{answeredCount:Kr(),totalQuestions:ee.length,percentage:Math.round(M),timeElapsed:Number(Z?.allowed_time||0)>0?W:0,showDetails:!0})})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Answer all questions below:"}),l.jsx("div",{className:"space-y-8",children:ee.map((Fe,st)=>l.jsx("div",{className:"question-container",children:Ne(Fe,st)},Fe.question_id||st))})]}),l.jsx("div",{className:"flex justify-center",children:l.jsx(Ye,{variant:"primary",size:"lg",onClick:()=>He(!0),disabled:X||Kr()<ee.length,loading:X,children:X?"Submitting...":`Submit Test (${Kr()}/${ee.length})`})})]})}if(h)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(zr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:t?"Starting Test...":"Loading Student Tests..."})]})});if(b)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Tests Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:b}),l.jsx(Ye,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx(oa,{isOpen:Be,onClose:()=>Rt(!1),title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ye,{onClick:()=>Rt(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ye,{onClick:()=>{Rt(!1),ur()},variant:"primary",children:"Go Back"})]})]})}),l.jsx(oa,{isOpen:Ae,onClose:()=>He(!1),title:"Submit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ye,{onClick:()=>He(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ye,{onClick:()=>{He(!1),pr()},variant:"primary",children:"Submit"})]})]})}),l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Test"})}),l.jsx(Ye,{variant:"outline",onClick:()=>Rt(!0),children:"Back to Cabinet"})]})})}),De&&F==="results"&&l.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mx-4 sm:mx-6 lg:mx-8 mt-4",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsxs("p",{className:"text-sm text-red-700",children:[l.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",Le," times during the test."]})})]})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 overflow-y-auto",children:[!t&&F==="list"&&Re(),F==="test"&&Pe(),F==="results"&&Ct()]}),F==="test"&&p&&l.jsxs("div",{className:"fixed inset-0 bg-white/80 backdrop-blur-[1px] flex flex-col items-center justify-center z-50",children:[l.jsx(zr,{size:"lg"}),l.jsx("p",{className:"mt-3 text-gray-700",children:"Preparing your test"}),v&&l.jsx("div",{className:"mt-3 text-sm text-gray-500",children:v})]}),l.jsx(FB,{isOpen:le,onClose:()=>ce(!1),testType:Se?.test_type,testId:Se?.test_id,testName:Se?.test_name,questions:Se?.questions,isLoading:h}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:E.map(Fe=>l.jsx(uc,{type:Fe.type,message:Fe.message,onClose:()=>P(st=>st.filter(ke=>ke.id!==Fe.id))},Fe.id))})]});function Re(){return!a||a.length===0?l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No active tests available for your class."})}):l.jsx("div",{className:"space-y-6",children:a.map((Fe,st)=>l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:Fe.test_name}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Subject:"})," ",Fe.subject]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Teacher:"})," ",Fe.teacher_name]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Type:"})," ",Fe.test_type]})]}),l.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Assigned: ",new Date(Fe.assigned_at).toLocaleDateString()]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx(Ye,{variant:"outline",onClick:()=>At(Fe),disabled:C||h,children:"View Details"}),l.jsx(Ye,{variant:"primary",onClick:()=>qt(Fe),disabled:C||h,children:C?"Starting...":"Start Test"})]})]})},st))})}function Ct(){if(!j||!Z||!ee||!L)return null;const Fe={};return L.forEach((st,ke)=>{if(ee[ke]){const We=ee[ke].question_id||ee[ke].id||ke;Fe[String(We)]=st,pe.debug(" Converting answer:",{index:ke,questionId:We,answer:st,question:ee[ke]})}}),pe.debug(" Final answersObject:",Fe),pe.debug(" Questions structure:",ee.map(st=>({id:st.question_id,correct_answer:st.correct_answer}))),l.jsx(Zae,{testInfo:Z,questions:ee,testType:j.test_type,studentAnswers:Fe,onBackToCabinet:ur,checkAnswerCorrectness:Sm,formatStudentAnswerForDisplay:ir,getCorrectAnswer:Qy})}},nie=()=>{const{testId:e}=F_(),t=Eo(),{user:r}=cs(),{makeAuthenticatedRequest:n}=Qo(),{showNotification:s}=za(),[a,i]=S.useState(null),[o,c]=S.useState(!0),[u,d]=S.useState(null),[h,g]=S.useState(null),[p,x]=S.useState(!1);Xm("matching_type",a?.id);const v=S.useCallback(()=>{if(!r?.student_id||!e)return!1;const N=`test_completed_${r.student_id}_matching_type_${e}`,E=localStorage.getItem(N)==="true",P=`retest1_${r.student_id}_matching_type_${e}`,F=localStorage.getItem(P)==="true";return E&&!F?(pe.debug(" Test already completed, redirecting to cabinet"),s("This test has already been completed","info"),t("/student"),!0):!1},[r?.student_id,e,t,s]),w=S.useCallback(async()=>{if(!e){d("Test ID is required"),c(!1);return}if(!v())try{c(!0),d(null);const N=await n(`/.netlify/functions/get-matching-type-test?test_id=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!N.ok)throw new Error("Failed to load test data");const E=await N.json();if(!E.success)throw new Error(E.message||"Failed to load test");const P=E.data;pe.debug(" Test data from get-matching-type-test:",P);const F=await n(`/.netlify/functions/get-test-questions?test_id=${e}&test_type=matching_type`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!F.ok)throw new Error("Failed to load test questions");const A=await F.json();if(!A.success)throw new Error(A.message||"Failed to load test questions");pe.debug(" Questions data from get-test-questions:",A);const j={id:P.test_id,test_name:P.test_name,teacher_id:P.teacher_id,subject_id:P.subject_id,image_url:P.image_url,image:null,blocks:(()=>{if(Array.isArray(A.questions)&&A.questions.length>0){const I=A.questions[0];return Array.isArray(I.blocks)?I.blocks.map((B,Y)=>{let Z=B.block_coordinates||B.coordinates||(typeof B.x=="number"?{x:B.x,y:B.y,width:B.width,height:B.height}:null);if(typeof Z=="string")try{Z=JSON.parse(Z)}catch{Z=null}return(!Z||typeof Z!="object")&&(Z={x:0,y:0,width:30,height:10}),Z={x:(typeof Z.x=="number"?Z.x:Number(Z.x))||0,y:(typeof Z.y=="number"?Z.y:Number(Z.y))||0,width:(typeof Z.width=="number"?Z.width:Number(Z.width))||30,height:(typeof Z.height=="number"?Z.height:Number(Z.height))||10},{id:B.block_id||B.question_id||B.id||Y+1,word:B.word||`Word ${Y+1}`,coordinates:Z,hasArrow:!!B.has_arrow,arrow:B.arrow||null}}):A.questions.map(B=>{pe.debug(" Processing question:",B);let Y;try{Y=typeof B.block_coordinates=="string"?JSON.parse(B.block_coordinates):B.block_coordinates}catch{Y={x:0,y:0,width:100,height:100}}return(!Y||typeof Y!="object")&&(Y={x:0,y:0,width:100,height:100}),Y={x:(typeof Y.x=="number"?Y.x:Number(Y.x))||0,y:(typeof Y.y=="number"?Y.y:Number(Y.y))||0,width:(typeof Y.width=="number"?Y.width:Number(Y.width))||100,height:(typeof Y.height=="number"?Y.height:Number(Y.height))||100},{id:B.question_id,word:B.word,coordinates:Y,hasArrow:B.has_arrow,arrow:B.arrow}})}return[]})(),words:(()=>{if(Array.isArray(A.questions)&&A.questions.length>0){const I=A.questions[0];if(Array.isArray(I.words)){const B=I.words,Y=Array.isArray(I.blocks)?I.blocks:[];return typeof B[0]=="string"?B.map((ae,ee)=>({id:`w_${Y[ee]?.question_id||Y[ee]?.block_id||A.questions[ee]?.question_id||ee+1}_${ee}`,word:String(ae),blockId:null,isPlaced:!1,isCorrect:!1})):B.map((ae,ee)=>({id:`w_${ae.question_id||ae.id||ee+1}_${ee}`,word:ae.word||String(ae.text||""),blockId:null,isPlaced:!1,isCorrect:!1}))}return A.questions.map(B=>({id:`w_${B.question_id}`,word:B.word,blockId:null,isPlaced:!1,isCorrect:!1}))}return[]})(),arrows:P.arrows?P.arrows.map(I=>(pe.debug(" Processing arrow:",I),{id:I.id,questionId:I.question_id,blockId:I.block_id||I.question_id,start:{x:Number(I.start_x)||0,y:Number(I.start_y)||0},end:{x:Number(I.end_x)||0,y:Number(I.end_y)||0},rel_start_x:I.rel_start_x!==null?Number(I.rel_start_x):null,rel_start_y:I.rel_start_y!==null?Number(I.rel_start_y):null,rel_end_x:I.rel_end_x!==null?Number(I.rel_end_x):null,rel_end_y:I.rel_end_y!==null?Number(I.rel_end_y):null,image_width:I.image_width?Number(I.image_width):null,image_height:I.image_height?Number(I.image_height):null,style:(typeof I.style=="string"?JSON.parse(I.style):I.style)||{color:"#dc3545",thickness:3}})):[]};if(P.image_url){const I=new Image;I.crossOrigin="anonymous",I.onload=()=>{j.image=I,i(j),c(!1)},I.onerror=()=>{pe.warn("Failed to load test image"),i(j),c(!1)},I.src=P.image_url}else i(j),c(!1)}catch(N){pe.error("Error loading test data:",N),d(N.message||"Failed to load test"),c(!1)}},[e,n]);S.useEffect(()=>{r?.student_id&&w()},[w,r?.student_id]);const C=S.useCallback(async N=>{pe.debug("Test completed:",N),s("Test completed successfully!","success");const E=parseInt(N)||0,P=a?.blocks?.length||a?.words?.length||0,F=P>0?Math.round(E/P*100):0,A={showResults:!0,testInfo:{test_name:a?.test_name||"Test",id:a?.id,test_id:a?.id},testType:"matching_type",score:E,totalQuestions:P,percentage:F,passed:F>=60,questionAnalysis:a?.questions?.map((j,I)=>({questionNumber:I+1,isCorrect:I<E,userAnswer:I<E?`Matched: ${j.word}`:"Not answered",correctAnswer:`Match: ${j.word}`}))||Array.from({length:P},(j,I)=>({questionNumber:I+1,isCorrect:I<E,userAnswer:I<E?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};pe.debug(" Using test results data:",A),g(A),x(!0)},[a,s]),k=S.useCallback(()=>{t("/student")},[t]),b=S.useCallback(()=>{x(!1),g(null),w()},[w]);return o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(Nt,{className:"max-w-md w-full",children:l.jsxs(Nt.Body,{className:"text-center",children:[l.jsx(zr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading test..."})]})})}):u?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(Nt,{className:"max-w-md w-full",children:l.jsxs(Nt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-4",children:u}),l.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})}):a?p&&h?l.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:l.jsx(Wv,{testResults:h,onBackToCabinet:k,onRetakeTest:b,isLoading:!1})}):l.jsx(Qse,{testData:a,onTestComplete:C,onBackToCabinet:k}):l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(Nt,{className:"max-w-md w-full",children:l.jsxs(Nt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load test data"}),l.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})})},sie=()=>{const{testId:e}=F_(),t=Eo(),{user:r}=cs(),{makeAuthenticatedRequest:n}=Qo(),{showNotification:s}=za(),[a,i]=S.useState(null),[o,c]=S.useState(!0),[u,d]=S.useState(null),[h,g]=S.useState(null),[p,x]=S.useState(!1),v=S.useCallback(()=>{if(!r?.student_id||!e)return!1;const b=`test_completed_${r.student_id}_word_matching_${e}`,N=`retest1_${r.student_id}_word_matching_${e}`;return localStorage.getItem(N)==="true"?!1:localStorage.getItem(b)==="true"},[r?.student_id,e]),w=S.useCallback(async()=>{if(!e){d("Test ID is required"),c(!1);return}if(v()){s("This test has already been completed","warning"),t("/student");return}c(!0),d(null);try{const b=`word_matching_test_${e}`,N=Rs(b);if(N){if(pe.debug(" Word matching test loaded from cache:",N),N.id){let F=N,A=Array.isArray(F.correctPairs)?F.correctPairs:F.correctPairs&&typeof F.correctPairs=="object"?Object.keys(F.correctPairs).map(j=>[Number(j),F.correctPairs[j]]).sort((j,I)=>j[0]-I[0]).map(([,j])=>j):null;if(Array.isArray(F.leftWords)&&Array.isArray(F.rightWords)&&Array.isArray(A)){const j=F.rightWords.map((ee,ne)=>ne),I=F.leftWords.map((ee,ne)=>ne);for(let ee=j.length-1;ee>0;ee--){const ne=Math.floor(Math.random()*(ee+1));[j[ee],j[ne]]=[j[ne],j[ee]]}for(let ee=I.length-1;ee>0;ee--){const ne=Math.floor(Math.random()*(ee+1));[I[ee],I[ne]]=[I[ne],I[ee]]}const B=j.map(ee=>F.rightWords[ee]),Y=I.map(ee=>F.leftWords[ee]),Z=new Map(j.map((ee,ne)=>[ee,ne])),ae=I.map(ee=>{const ne=A[ee];return Z.get(ne)});F={...F,leftWords:Y,rightWords:B,correctPairs:ae}}i(F)}else{let A={id:N.test_id,test_id:N.test_id,test_name:N.test_name,teacher_id:N.teacher_id,subject_id:N.subject_id,num_questions:N.num_questions,interaction_type:N.interaction_type,passing_score:N.passing_score,created_at:N.created_at,updated_at:N.updated_at,leftWords:N.leftWords,rightWords:N.rightWords,correctPairs:N.correctPairs,originalPairs:N.originalPairs},j=Array.isArray(A.correctPairs)?A.correctPairs:A.correctPairs&&typeof A.correctPairs=="object"?Object.keys(A.correctPairs).map(I=>[Number(I),A.correctPairs[I]]).sort((I,B)=>I[0]-B[0]).map(([,I])=>I):null;if(Array.isArray(A.leftWords)&&Array.isArray(A.rightWords)&&Array.isArray(j)){const I=A.rightWords.map((ne,L)=>L),B=A.leftWords.map((ne,L)=>L);for(let ne=I.length-1;ne>0;ne--){const L=Math.floor(Math.random()*(ne+1));[I[ne],I[L]]=[I[L],I[ne]]}for(let ne=B.length-1;ne>0;ne--){const L=Math.floor(Math.random()*(ne+1));[B[ne],B[L]]=[B[L],B[ne]]}const Y=I.map(ne=>A.rightWords[ne]),Z=B.map(ne=>A.leftWords[ne]),ae=new Map(I.map((ne,L)=>[ne,L])),ee=B.map(ne=>{const L=j[ne];return ae.get(L)});A={...A,leftWords:Z,rightWords:Y,correctPairs:ee}}i(A)}c(!1);return}const P=await(await n(`/.netlify/functions/get-word-matching-test?test_id=${e}`)).json();if(P.success){const F={id:P.data.test_id,test_id:P.data.test_id,test_name:P.data.test_name,teacher_id:P.data.teacher_id,subject_id:P.data.subject_id,num_questions:P.data.num_questions,interaction_type:P.data.interaction_type,passing_score:P.data.passing_score,created_at:P.data.created_at,updated_at:P.data.updated_at,leftWords:P.data.leftWords,rightWords:P.data.rightWords,correctPairs:P.data.correctPairs,originalPairs:P.data.originalPairs};let A=F,j=Array.isArray(A.correctPairs)?A.correctPairs:A.correctPairs&&typeof A.correctPairs=="object"?Object.keys(A.correctPairs).map(I=>[Number(I),A.correctPairs[I]]).sort((I,B)=>I[0]-B[0]).map(([,I])=>I):null;if(Array.isArray(A.leftWords)&&Array.isArray(A.rightWords)&&Array.isArray(j)){const I=A.rightWords.map((ne,L)=>L),B=A.leftWords.map((ne,L)=>L);for(let ne=I.length-1;ne>0;ne--){const L=Math.floor(Math.random()*(ne+1));[I[ne],I[L]]=[I[L],I[ne]]}for(let ne=B.length-1;ne>0;ne--){const L=Math.floor(Math.random()*(ne+1));[B[ne],B[L]]=[B[L],B[ne]]}const Y=I.map(ne=>A.rightWords[ne]),Z=B.map(ne=>A.leftWords[ne]),ae=new Map(I.map((ne,L)=>[ne,L])),ee=B.map(ne=>{const L=j[ne];return ae.get(L)});A={...A,leftWords:Z,rightWords:Y,correctPairs:ee}}i(A),vs(b,A,Is.word_matching_test),pe.debug(" Word matching test loaded from API and cached:",F)}else throw new Error(P.message||"Failed to load test")}catch(b){pe.error("Error loading word matching test:",b),d(b.message),s("Failed to load test: "+b.message,"error")}finally{c(!1)}},[e,v,n,s,t]),C=S.useCallback(async b=>{pe.debug("Test completed:",b),s("Test completed successfully!","success");const N=parseInt(b)||0,E=a?.num_questions||0,P=E>0?Math.round(N/E*100):0,F={showResults:!0,testInfo:{test_name:a?.test_name||"Test",id:a?.id,test_id:a?.id},testType:"word_matching",score:N,totalQuestions:E,percentage:P,passed:P>=60,questionAnalysis:Array.isArray(a?.correctPairs)?a.correctPairs.map((A,j)=>({questionNumber:j+1,isCorrect:j<N,userAnswer:j<N?`${A.left}  ${A.right}`:"Not answered",correctAnswer:`${A.left}  ${A.right}`})):Array.from({length:E},(A,j)=>({questionNumber:j+1,isCorrect:j<N,userAnswer:j<N?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};pe.debug(" Using test results data:",F),g(F),x(!0)},[a,s]),k=S.useCallback(()=>{t("/student")},[t]);return S.useEffect(()=>{w()},[w]),o?l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsxs(Nt,{className:"p-8 text-center",children:[l.jsx(zr,{size:"lg",className:"mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading word matching test..."})]})}):u?l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(Nt,{className:"p-8 text-center",children:l.jsxs("div",{className:"text-red-600 mb-4",children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-4",children:u}),l.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})}):a?p&&h?l.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:l.jsx(Wv,{testResults:h,onBackToCabinet:()=>{g(null),x(!1),t("/student")},onRetakeTest:(b,N)=>{g(null),x(!1),w()},isLoading:!1})}):l.jsx(nt.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"min-h-screen bg-gray-50 py-8",children:l.jsx(eae,{testData:a,onTestComplete:C,onBackToCabinet:k})}):l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(Nt,{className:"p-8 text-center",children:l.jsxs("div",{className:"text-gray-600 mb-4",children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Test Not Found"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"The requested test could not be found."}),l.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})})},aie=S.forwardRef(({onRecordingComplete:e,minDuration:t=0,maxDuration:r=600,minWords:n=50,maxAttempts:s=3,currentAttempt:a=1},i)=>{const[o,c]=S.useState(!1),[u,d]=S.useState(!1),[h,g]=S.useState(0),[p,x]=S.useState(null),[v,w]=S.useState(null),[C,k]=S.useState("good"),b=S.useRef(null),N=S.useRef([]),E=S.useRef(null),P=S.useRef(null),F=S.useRef(null),A=S.useRef(null),j=S.useRef(null);S.useImperativeHandle(i,()=>({startRecording:()=>I(),stopRecording:()=>B(),pauseRecording:()=>Y(),resumeRecording:()=>Z()}));const I=S.useCallback(async()=>{try{if(w(null),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox.");if(!window.isSecureContext&&!window.location.hostname.includes("localhost"))throw new Error("Microphone access requires HTTPS. Please use a secure connection.");const H=window.AudioContext||window.webkitAudioContext;F.current||(F.current=new H),F.current.state!=="running"&&await F.current.resume().catch(()=>{}),console.log(" Requesting microphone permission...");const M=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,channelCount:1}});console.log(" Microphone permission granted"),E.current=M;try{let q=document.getElementById("ios-audio-sink");q||(q=document.createElement("audio"),q.id="ios-audio-sink",q.muted=!0,q.playsInline=!0,q.style.display="none",document.body.appendChild(q)),q.srcObject=M,await q.play().catch(()=>{})}catch{}const V=F.current.createAnalyser();F.current.createMediaStreamSource(M).connect(V),V.fftSize=256,A.current=V,ae();let R="audio/webm;codecs=opus";typeof MediaRecorder<"u"&&MediaRecorder.isTypeSupported&&!MediaRecorder.isTypeSupported(R)&&(MediaRecorder.isTypeSupported("audio/mp4")?R="audio/mp4":MediaRecorder.isTypeSupported("audio/aac")?R="audio/aac":R="");const U=new MediaRecorder(M,R?{mimeType:R}:void 0);b.current=U,N.current=[],U.ondataavailable=q=>{q.data.size>0&&N.current.push(q.data)},U.onstop=()=>{const q=R&&R.startsWith("audio/")?R:"audio/webm",Q=new Blob(N.current,{type:q});x(Q),e(Q,h),E.current&&E.current.getTracks().forEach(se=>se.stop()),j.current&&cancelAnimationFrame(j.current)},U.start(1e3),c(!0),g(0),P.current=setInterval(()=>{g(q=>{const Q=q+1;return Q>=r&&B(),Q})},1e3)}catch(H){console.error("Error starting recording:",H);const M=/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1;H.name==="NotAllowedError"?w(M?"Microphone access denied. Please go to Settings > Safari > Microphone and allow access, then refresh the page.":"Microphone access denied. Please allow microphone access in your browser settings and try again."):H.name==="NotFoundError"?w("No microphone found. Please connect a microphone and try again."):H.name==="NotSupportedError"?w("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox."):H.message.includes("HTTPS")?w("Microphone access requires HTTPS. Please use a secure connection."):w(`Failed to access microphone: ${H.message}`)}},[r]),B=S.useCallback(()=>{if(b.current&&o&&(b.current.stop(),c(!1),d(!1),P.current&&clearInterval(P.current),h<t)){w(`Recording must be at least ${t} seconds long.`);return}},[o,h,t,p,e]),Y=S.useCallback(()=>{b.current&&o&&!u&&(b.current.pause(),d(!0),P.current&&clearInterval(P.current))},[o,u]),Z=S.useCallback(()=>{b.current&&o&&u&&(b.current.resume(),d(!1),P.current=setInterval(()=>{g(H=>{const M=H+1;return M>=r&&B(),M})},1e3))},[o,u,r,B]),ae=S.useCallback(()=>{if(!A.current)return;const H=A.current,M=new Uint8Array(H.frequencyBinCount),V=()=>{H.getByteFrequencyData(M);const W=M.reduce((R,U)=>R+U,0)/M.length;W<10?k("poor"):W<30?k("fair"):k("good"),o&&(j.current=requestAnimationFrame(V))};V()},[o]),ee=H=>{const M=Math.floor(H/60),V=H%60;return`${M}:${V.toString().padStart(2,"0")}`},ne=()=>{switch(C){case"poor":return"text-red-600";case"fair":return"text-yellow-600";case"good":return"text-green-600";default:return"text-gray-600"}},L=()=>{switch(C){case"poor":return"Poor audio quality - speak closer to microphone";case"fair":return"Fair audio quality - good for recording";case"good":return"Excellent audio quality";default:return"Monitoring audio quality..."}};return l.jsxs("div",{className:"audio-recorder bg-white rounded-lg shadow-lg p-3 sm:p-6",children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Record Your Response"}),l.jsx("p",{className:"text-gray-600",children:"Speak clearly and at a normal pace. You can pause and resume if needed."})]}),l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:ee(h)}),l.jsx("div",{className:`text-sm ${ne()}`,children:L()}),u&&l.jsx("div",{className:"text-yellow-600 font-semibold mt-2",children:" Recording Paused"})]}),o&&l.jsx("div",{className:"mb-6",children:l.jsx("div",{className:"flex justify-center items-center space-x-1 h-8",children:Array.from({length:20},(H,M)=>l.jsx("div",{className:"bg-blue-400 rounded-sm",style:{width:"4px",height:`${Math.random()*20+4}px`,animation:"pulse 0.5s ease-in-out infinite"}},M))})}),l.jsx("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-center mb-6",children:o?l.jsxs(l.Fragment,{children:[u?l.jsxs("button",{onClick:Z,className:"w-full sm:w-auto bg-green-600 text-white px-6 py-4 rounded-full hover:bg-green-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Resume"})]}):l.jsxs("button",{onClick:Y,className:"w-full sm:w-auto bg-yellow-600 text-white px-6 py-4 rounded-full hover:bg-yellow-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Pause"})]}),l.jsxs("button",{onClick:B,className:"w-full sm:w-auto bg-gray-600 text-white px-6 py-4 rounded-full hover:bg-gray-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Stop & Submit"})]})]}):l.jsxs("button",{onClick:I,className:"w-full sm:w-auto bg-red-600 text-white px-6 py-4 rounded-full hover:bg-red-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Start Recording"})]})}),v&&l.jsx("div",{className:"mt-4 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-800",children:v})}),l.jsxs("div",{className:"mt-4 text-center text-sm text-gray-600",children:["Attempt ",a," of ",s,a<s&&l.jsx("span",{className:"ml-2 text-blue-600",children:"(You can re-record if needed)"})]})]})}),HB=({audioBlob:e,audioUrl:t,recordingTime:r,className:n=""})=>{const[s,a]=S.useState(!1),[i,o]=S.useState(0),[c,u]=S.useState(0),[d,h]=S.useState(1),[g,p]=S.useState(1),[x,v]=S.useState(!0),[w,C]=S.useState(""),[k,b]=S.useState(!1),[N,E]=S.useState(null),[P,F]=S.useState(!1),A=S.useRef(null),j=S.useRef(null),I=S.useRef(!1);S.useEffect(()=>()=>{I.current=!0},[]),S.useEffect(()=>{let M=!1;if(t)M||C(t);else if(e){if(!e||e.size===0){M||v(!1);return}if(!(e instanceof Blob)){console.error("audioBlob is not a Blob:",typeof e,e),M||v(!1);return}const V=URL.createObjectURL(e);return M||C(V),()=>{M=!0,URL.revokeObjectURL(V)}}return()=>{M=!0}},[e,t]),S.useEffect(()=>{let M=!1;const V=R=>{try{const U=new URL(R);return/\/storage\/v1\/object\/public\//.test(U.pathname)}catch{return!1}};async function W(R){if(!R||P||/\/object\/sign\//.test(R)||!V(R))return R;try{const q=new URL(R).pathname.replace(/^\/storage\/v1\/object\/public\//,""),Q=q.split("/")[0],se=q.substring(Q.length+1),X=await fetch(`/.netlify/functions/get-speaking-test-new?action=sign-audio&bucket=${encodeURIComponent(Q)}&file_path=${encodeURIComponent(se)}`);if(X.ok){const{url:ie}=await X.json();if(!M&&!I.current){F(!0);try{await fetch(ie,{headers:{Range:"bytes=0-1"},mode:"cors"})}catch{}C(ie)}return ie}}catch{}return R}return(async()=>{if(t){const R=await W(t);try{await fetch(R,{headers:{Range:"bytes=0-1"},mode:"cors"})}catch{}!M&&!I.current&&!P&&C(R)}})(),()=>{M=!0}},[t,P]),S.useEffect(()=>{let M=!1;return w&&(M||(b(!1),E(null),v(!0))),()=>{M=!0}},[w]),S.useEffect(()=>{if(A.current&&w){const M=A.current;let V=!1;try{M.src=w}catch{}M.load();const W=()=>{if(V||I.current)return;let re=M.duration;if(re===1/0)try{M.currentTime=1e101,M.ontimeupdate=()=>{if(V||I.current)return;M.ontimeupdate=null;const ge=M.duration;V||(u(isFinite(ge)&&ge>0?ge:0),M.currentTime=0,v(!1))};return}catch(ge){console.warn("Seek trick failed:",ge)}if(isNaN(re)||!isFinite(re)||re<=0){const ge=M.seekable&&M.seekable.length>0&&isFinite(M.seekable.end(0)),Ee=!ge&&M.buffered&&M.buffered.length>0&&isFinite(M.buffered.end(M.buffered.length-1));ge?re=M.seekable.end(0):Ee&&(re=M.buffered.end(M.buffered.length-1))}isNaN(re)||!isFinite(re)||re<=0?(console.warn("Invalid audio duration after fallbacks:",re),r&&r>0?V||u(r):V||u(0)):V||u(re),V||v(!1)},R=()=>{V||I.current||W()},U=()=>{V||I.current||W()},q=()=>{V||I.current||W()},Q=()=>{V||I.current||W()},se=()=>{V||I.current||o(M.currentTime)},X=()=>{V||I.current||(a(!1),o(0))},ie=()=>{V||I.current||a(!0)},le=()=>{V||I.current||a(!1)},ce=re=>{if(V||I.current)return;console.error("Audio loading error:",re),console.error("Audio error details:",{error:M.error,networkState:M.networkState,readyState:M.readyState,src:M.src,currentSrc:M.currentSrc});const ge=M.error?.code;ge===4&&b(!0),E(M.error||{code:ge}),v(!1)},Se=setTimeout(()=>{V||I.current||M.readyState===0&&v(!1)},6e3);return M.addEventListener("loadedmetadata",R),M.addEventListener("durationchange",U),M.addEventListener("canplay",q),M.addEventListener("canplaythrough",Q),M.addEventListener("timeupdate",se),M.addEventListener("ended",X),M.addEventListener("play",ie),M.addEventListener("pause",le),M.addEventListener("error",ce),()=>{V=!0,clearTimeout(Se),M.removeEventListener("loadedmetadata",R),M.removeEventListener("durationchange",U),M.removeEventListener("canplay",q),M.removeEventListener("canplaythrough",Q),M.removeEventListener("timeupdate",se),M.removeEventListener("ended",X),M.removeEventListener("play",ie),M.removeEventListener("pause",le),M.removeEventListener("error",ce),M.pause(),M.src="",M.load()}}},[w,r]),S.useEffect(()=>{let M=!1;return r&&r>0&&(isNaN(c)||!isFinite(c)||c<=0)&&(M||u(r)),()=>{M=!0}},[r,c]);const B=()=>{A.current&&(s?A.current.pause():A.current.play().catch(M=>{console.error("Play failed:",M)}))},Y=M=>{if(A.current&&j.current&&c>0){const V=j.current.getBoundingClientRect(),W=M.clientX-V.left,R=V.width,U=Math.max(0,Math.min(c,W/R*c));isFinite(U)&&U>=0&&(A.current.currentTime=U,o(U))}},Z=M=>{const V=parseFloat(M.target.value);h(V),A.current&&(A.current.volume=V)},ae=M=>{const V=parseFloat(M.target.value);p(V),A.current&&(A.current.playbackRate=V)},ee=M=>{if(isNaN(M))return"0:00";const V=Math.floor(M/60),W=Math.floor(M%60);return`${V}:${W.toString().padStart(2,"0")}`};if(!e&&!t)return l.jsx("div",{className:`audio-player ${n}`,children:l.jsx("div",{className:"text-center text-gray-500 py-8",children:"No audio available"})});const L=(M=>{try{const W=(M||"").toLowerCase().split("?")[0].split("#")[0];return W.endsWith(".webm")?"audio/webm":W.endsWith(".mp3")?"audio/mpeg":W.endsWith(".m4a")?"audio/mp4":W.endsWith(".aac")?"audio/aac":W.endsWith(".wav")?"audio/wav":void 0}catch{return}})(w||t),H=Fs.useMemo(()=>typeof window>"u"?!0:document.createElement("audio").canPlayType("audio/webm")!=="",[]);return l.jsxs("div",{className:`audio-player bg-gray-50 rounded-lg p-4 ${n}`,children:[l.jsx("audio",{ref:A,preload:"metadata",controls:!1,style:{display:"none"},crossOrigin:"anonymous",children:l.jsx("source",{src:w,type:L})}),x?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),l.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Loading audio..."})]}):k?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("p",{className:"text-sm text-red-600",children:"This audio format isn't supported by your browser."}),w?l.jsx("a",{href:w,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline text-sm",children:"Open in new tab"}):null,L?l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Detected type: ",L]}):null,l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Browser WebM support: ",H?"Yes":"No",!H&&" - Try using Chrome, Firefox, or Edge"]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Preferred format: WebM"})]}):N?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("p",{className:"text-sm text-red-600",children:"Playback failed. Please try opening the audio directly."}),w?l.jsx("a",{href:w,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline text-sm",children:"Open in new tab"}):null,L?l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Detected type: ",L]}):null]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("div",{ref:j,className:"w-full bg-gray-200 rounded-full h-3 cursor-pointer hover:h-4 transition-all min-h-[24px]",onClick:Y,children:l.jsx("div",{className:"bg-blue-600 h-3 rounded-full transition-all",style:{width:`${i/c*100}%`}})}),l.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mt-2 font-medium",children:[l.jsx("span",{children:ee(i)}),l.jsx("span",{children:ee(c)})]})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:B,className:"bg-blue-600 text-white p-3 rounded-full hover:bg-blue-700 transition-colors min-h-[44px] min-w-[44px] flex items-center justify-center",children:s?l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}):l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.617 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.617l3.766-3.793a1 1 0 011.617.793zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z",clipRule:"evenodd"})}),l.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:d,onChange:Z,className:"w-24 h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer min-h-[20px]"}),l.jsxs("span",{className:"text-sm text-gray-600 w-10 font-medium",children:[Math.round(d*100),"%"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Speed:"}),l.jsxs("select",{value:g,onChange:ae,className:"text-sm border border-gray-300 rounded px-2 py-1",children:[l.jsx("option",{value:"0.5",children:"0.5x"}),l.jsx("option",{value:"0.75",children:"0.75x"}),l.jsx("option",{value:"1",children:"1x"}),l.jsx("option",{value:"1.25",children:"1.25x"}),l.jsx("option",{value:"1.5",children:"1.5x"}),l.jsx("option",{value:"2",children:"2x"})]})]})]})]})]})},iie=({transcript:e,scores:t,audioBlob:r,recordingTime:n,onReRecord:s,onFinalSubmit:a,canReRecord:i,attemptNumber:o,maxAttempts:c,isSubmitting:u=!1})=>{const[d,h]=S.useState(!1);console.log(" FeedbackDisplay received recordingTime:",n);const g=(w,C)=>{const k=w/C*100;return k>=80?"text-green-600":k>=60?"text-yellow-600":"text-red-600"},p=(w,C)=>{const k=w/C*100;return k>=90?"A+":k>=80?"A":k>=70?"B":k>=60?"C":k>=50?"D":"F"},x=()=>p(t?.overall_score||0,100),v=()=>g(t?.overall_score||0,100);return console.log(" FeedbackDisplay received scores:",t),console.log(" Individual score values:",{grammar_score:t?.grammar_score,vocabulary_score:t?.vocabulary_score,pronunciation_score:t?.pronunciation_score,fluency_score:t?.fluency_score,content_score:t?.content_score}),l.jsxs("div",{className:"feedback-display bg-white rounded-lg shadow-lg p-3 sm:p-6",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Speaking Test Results"}),l.jsx("p",{className:"text-gray-600",children:"Review your performance and decide whether to submit or re-record."})]}),l.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 p-3 sm:p-6 rounded-lg mb-6",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:`text-4xl font-bold ${v()}`,children:[t?.overall_score||0,"/100"]}),l.jsxs("div",{className:`text-2xl font-semibold ${v()} mt-2`,children:["Grade: ",x()]}),l.jsx("div",{className:"text-gray-600 mt-2",children:t?.overall_score>=80?"Excellent work!":t?.overall_score>=60?"Good job!":t?.overall_score>=50?"Not bad, but could be better.":"Keep practicing!"})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Grammar"}),l.jsxs("span",{className:`font-bold ${g(t?.grammar_score||0,25)}`,children:[t?.grammar_score||0,"/25"]})]}),l.jsxs("div",{className:"text-sm text-gray-600",children:[t?.grammar_mistakes||0," mistakes found"]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${Math.min((t?.grammar_score||0)/25*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Vocabulary"}),l.jsxs("span",{className:`font-bold ${g(t?.vocabulary_score||0,20)}`,children:[t?.vocabulary_score||0,"/20"]})]}),l.jsxs("div",{className:"text-sm text-gray-600",children:[t?.vocabulary_mistakes||0," vocabulary issues"]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-purple-600 h-2 rounded-full",style:{width:`${Math.min((t?.vocabulary_score||0)/20*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Pronunciation"}),l.jsxs("span",{className:`font-bold ${g(t?.pronunciation_score||0,15)}`,children:[t?.pronunciation_score||0,"/15"]})]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Clarity and accuracy"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-orange-600 h-2 rounded-full",style:{width:`${Math.min((t?.pronunciation_score||0)/15*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Fluency"}),l.jsxs("span",{className:`font-bold ${g(t?.fluency_score||0,20)}`,children:[t?.fluency_score||0,"/20"]})]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Pace, pauses, and flow"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min((t?.fluency_score||0)/20*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Content"}),l.jsxs("span",{className:`font-bold ${g(t?.content_score||0,20)}`,children:[t?.content_score||0,"/20"]})]}),l.jsx("div",{className:"text-sm text-gray-600",children:"How well addressed the prompt"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-indigo-600 h-2 rounded-full",style:{width:`${Math.min((t?.content_score||0)/20*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Word Count"}),l.jsxs("span",{className:"font-bold text-gray-700",children:[t?.word_count||0," words"]})]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Total words spoken"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-gray-600 h-2 rounded-full",style:{width:`${Math.min((t?.word_count||0)/100*100,100)}%`}})})]})]}),r&&l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Your Recording"}),l.jsx(HB,{audioBlob:r,recordingTime:n})]}),t?.feedback&&l.jsx("div",{className:"mb-6 bg-gradient-to-r from-green-50 to-blue-50 p-3 sm:p-6 rounded-lg border border-green-200",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("span",{className:"text-green-600 text-2xl",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"font-semibold text-green-800 mb-3 text-lg",children:"AI Feedback"}),l.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.feedback})]})]})}),t?.improved_transcript&&l.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex items-start space-x-2 mb-3",children:[l.jsx("span",{className:"text-green-600 text-lg",children:""}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-green-800 mb-2",children:"Improved Version"}),l.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Here's how your response could be improved with better grammar and vocabulary:"})]})]}),l.jsx("div",{className:"bg-white border border-green-200 rounded p-3",children:l.jsx("p",{className:"text-gray-800 leading-relaxed",children:t.improved_transcript})})]}),l.jsx("div",{className:"mb-6",children:l.jsx("button",{onClick:()=>h(!d),className:"text-blue-600 hover:text-blue-800 text-sm",children:d?"Hide Details":"Show Details"})}),d&&l.jsxs("div",{className:"mb-6 bg-blue-50 p-3 sm:p-4 rounded-lg",children:[l.jsx("h4",{className:"font-semibold mb-3",children:"Detailed Analysis"}),l.jsxs("div",{className:"space-y-3 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Word Count Analysis:"}),l.jsxs("span",{className:"ml-2 text-gray-700",children:["You spoke ",t?.word_count||0," words.",t?.word_count>=50?" Great job meeting the minimum requirement!":" Consider speaking more to meet the minimum word requirement."]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Grammar Analysis:"}),l.jsx("span",{className:"ml-2 text-gray-700",children:t?.grammar_mistakes===0?"Perfect grammar!":`Found ${t?.grammar_mistakes||0} grammar ${t?.grammar_mistakes===1?"mistake":"mistakes"}.`}),t?.grammar_corrections&&t.grammar_corrections.length>0&&l.jsx("div",{className:"mt-2 space-y-2",children:t.grammar_corrections.map((w,C)=>l.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-2 sm:p-3",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:"text-red-600 font-mono text-sm",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-red-600",children:w.mistake}),l.jsx("span",{className:"mx-2",children:""}),l.jsx("span",{className:"font-medium text-green-600",children:w.correction})]}),l.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[l.jsx("strong",{children:"Explanation:"})," ",w.explanation]})]})]})},C))})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Vocabulary Analysis:"}),l.jsx("span",{className:"ml-2 text-gray-700",children:t?.vocabulary_mistakes===0?"Excellent vocabulary usage!":`Found ${t?.vocabulary_mistakes||0} vocabulary ${t?.vocabulary_mistakes===1?"issue":"issues"}.`}),t?.vocabulary_corrections&&t.vocabulary_corrections.length>0&&l.jsx("div",{className:"mt-2 space-y-2",children:t.vocabulary_corrections.map((w,C)=>l.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded p-2 sm:p-3",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:"text-purple-600 font-mono text-sm",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-purple-600",children:w.mistake}),l.jsx("span",{className:"mx-2",children:""}),l.jsx("span",{className:"font-medium text-green-600",children:w.correction})]}),l.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[l.jsx("strong",{children:"Explanation:"})," ",w.explanation]})]})]})},C))})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Pronunciation Analysis:"}),l.jsx("span",{className:"ml-2 text-gray-700",children:t?.pronunciation_corrections&&t.pronunciation_corrections.length>0?`Found ${t.pronunciation_corrections.length} pronunciation ${t.pronunciation_corrections.length===1?"tip":"tips"} to help improve clarity.`:"Great pronunciation! Your speech was clear and easy to understand."})]}),t?.pronunciation_corrections&&t.pronunciation_corrections.length>0&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Pronunciation Tips:"}),l.jsx("div",{className:"mt-2 space-y-2",children:t.pronunciation_corrections.map((w,C)=>l.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded p-2 sm:p-3",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:"text-orange-600 font-mono text-sm",children:""}),l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-orange-700",children:w.word}),l.jsx("span",{className:"mx-2",children:""}),l.jsx("span",{className:"font-medium text-green-700",children:w.correction})]})})]})},C))})]}),t?.language_use_corrections&&t.language_use_corrections.length>0&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Language Use Suggestions:"}),l.jsx("div",{className:"mt-2 space-y-2",children:t.language_use_corrections.map((w,C)=>l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded p-2 sm:p-3",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:"text-blue-600 font-mono text-sm",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-blue-700",children:w.mistake}),l.jsx("span",{className:"mx-2",children:""}),l.jsx("span",{className:"font-medium text-green-700",children:w.suggestion})]}),w.explanation&&l.jsxs("div",{className:"text-xs text-blue-700 mt-1",children:[l.jsx("strong",{children:"Why:"})," ",w.explanation]})]})]})},C))})]})]})]}),l.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:["Attempt ",o," of ",c]}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-center justify-center",children:[i&&l.jsxs("button",{onClick:s,className:"w-full sm:w-auto bg-yellow-600 text-white px-4 py-2.5 rounded-lg hover:bg-yellow-700 flex items-center justify-center space-x-2 min-h-[40px] text-base font-medium",children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Re-record"})]}),l.jsx("button",{onClick:a,disabled:u,className:`w-full sm:w-auto px-4 py-2.5 rounded-lg flex items-center justify-center space-x-2 min-h-[40px] text-base font-medium ${u?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"} text-white`,children:u?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),l.jsx("span",{children:"Submitting..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Submit Final"})]})})]}),!i&&l.jsx("div",{className:"mt-4 p-2 sm:p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:l.jsxs("p",{className:"text-yellow-800 text-sm",children:[l.jsx("strong",{children:"Maximum attempts reached."}),' This is your final attempt. Click "Submit Final" to complete the test.']})})]})},oie=({testData:e,onComplete:t,onExit:r,onTestComplete:n})=>{const[s,a]=S.useState("recording"),[i,o]=S.useState(null),[c,u]=S.useState(""),[d,h]=S.useState(null),[g,p]=S.useState(!1),[x,v]=S.useState(!1),[w,C]=S.useState(!1),[k,b]=S.useState(null),[N,E]=S.useState(1),[P]=S.useState(e.max_attempts||3),[F,A]=S.useState(!1),[j,I]=S.useState(0),[B,Y]=S.useState(!1),[Z,ae]=S.useState(0),[ee,ne]=S.useState(null),L=Qo(),{user:H}=cs(),{makeAuthenticatedRequest:M}=L,V=S.useRef(null);S.useEffect(()=>{if(e?.test_id&&H?.student_id){const ce=`speaking_attempts_${H.student_id}_${e.test_id}`,Se=localStorage.getItem(ce);if(Se){const re=parseInt(Se,10);re>0&&re<=P&&(E(re),console.log(" Loaded attempts from localStorage:",re))}}},[e,H,P]),S.useEffect(()=>{if(e&&!ee){const ce=new Date;ne(ce),console.log(" Speaking test timer started at:",ce.toISOString())}},[e,ee]),S.useEffect(()=>{let ce=0;s==="recording"?ce=25:s==="processing"?ce=50:s==="feedback"?ce=75:s==="completed"&&(ce=100),ae(ce)},[s]),S.useEffect(()=>{(async()=>{try{if(!window.isSecureContext&&!window.location.hostname.includes("localhost")){b("Microphone access requires HTTPS. Please use a secure connection.");return}if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){b("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox.");return}if(navigator.permissions)try{(await navigator.permissions.query({name:"microphone"})).state==="granted"?(A(!0),console.log(" Microphone permission already granted")):console.log(" Microphone permission not yet granted - user will need to click record button")}catch(Se){console.log(" Could not check microphone permission status:",Se)}}catch(Se){console.error(" Error checking microphone permission:",Se)}})()},[]),S.useEffect(()=>{const ce=setInterval(()=>{i&&s==="recording"&&W()},3e4);return()=>clearInterval(ce)},[i,s]);const W=S.useCallback(async()=>{try{const ce={test_id:e.test_id,audio_blob:i?await R(i):null,attempt_number:N,step:s,timestamp:new Date().toISOString()};localStorage.setItem(`speaking_progress_${e.test_id}`,JSON.stringify(ce))}catch(ce){console.error("Failed to save progress:",ce)}},[e.test_id,i,N,s]),R=ce=>new Promise((Se,re)=>{const ge=new FileReader;ge.onloadend=()=>{const Ae=ge.result.split(",")[1];Se(Ae)},ge.onerror=re,ge.readAsDataURL(ce)}),U=S.useCallback(ce=>{if(e?.test_id&&H?.student_id){const Se=`speaking_attempts_${H.student_id}_${e.test_id}`;localStorage.setItem(Se,ce.toString()),console.log(" Saved attempts to localStorage:",ce)}},[e,H]),q=S.useCallback(async(ce,Se,re,ge,Ee)=>{if(e?.test_id&&H?.student_id)try{const{setCachedData:Ae,CACHE_TTL:He}=await Zi(async()=>{const{setCachedData:vt,CACHE_TTL:xt}=await Promise.resolve().then(()=>Vg);return{setCachedData:vt,CACHE_TTL:xt}},void 0),Be=`speaking_test_data_${H.student_id}_${e.test_id}`,et={audioBlob:ce?await R(ce):null,transcript:Se,scores:re,recordingTime:ge,currentStep:Ee,timestamp:Date.now()};Ae(Be,et,He.speaking_test_data),console.log(" Saved speaking test data to cache:",Be)}catch(Ae){console.error("Failed to save speaking test data to cache:",Ae)}},[e,H]),Q=S.useCallback(async()=>{if(e?.test_id&&H?.student_id)try{const{getCachedData:ce}=await Zi(async()=>{const{getCachedData:ge}=await Promise.resolve().then(()=>Vg);return{getCachedData:ge}},void 0),Se=`speaking_test_data_${H.student_id}_${e.test_id}`,re=ce(Se);if(re){if(console.log(" Loaded speaking test data from cache:",re),re.audioBlob){const ge=new Blob([Uint8Array.from(atob(re.audioBlob),Ee=>Ee.charCodeAt(0))],{type:"audio/webm"});o(ge)}return re.transcript&&u(re.transcript),re.scores&&h(re.scores),re.recordingTime&&I(re.recordingTime),re.currentStep&&a(re.currentStep),!0}}catch(ce){console.error("Failed to load speaking test data from cache:",ce)}return!1},[e,H]);S.useEffect(()=>{if(e?.test_id&&H?.student_id){try{const ce=H.student_id,Se=`retest_assignment_id_${ce}_speaking_${e.test_id}`,re=`retest_in_progress_${ce}_speaking_${e.test_id}`;if(!!localStorage.getItem(Se)||!!localStorage.getItem(re)){const Ee=`speaking_test_data_${ce}_${e.test_id}`,Ae=`anti_cheating_${ce}_speaking_${e.test_id}`,He=`speaking_progress_${e.test_id}`;localStorage.removeItem(Ee),localStorage.removeItem(Ae),localStorage.removeItem(He),console.log(" Cleared speaking per-test cache for retest start:",{cacheKey:Ee,antiCheatKey:Ae,progressKey:He})}}catch{}Q()}},[e,H,Q]),S.useEffect(()=>{e?.test_id&&H?.student_id&&(i||c||d)&&q(i,c,d,j,s)},[i,c,d,j,s,e,H,q]);const se=S.useCallback(async(ce,Se)=>{if(B){console.log(" Already processing, skipping duplicate call");return}console.log(" Recording completed, duration:",Se),Y(!0),o(ce),I(Se),a("processing"),b(null);try{const re=await R(ce),ge=new Date,Ee=e.start_time?Math.round((ge-e.start_time)/1e3):0,Ae=e.start_time?new Date(e.start_time).toISOString():ge.toISOString(),He=H.student_id,Be=`retest_assignment_id_${He}_speaking_${e.test_id}`,Rt=localStorage.getItem(Be),et={test_id:e.test_id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:He,question_id:e.question_id||1,audio_blob:re,audio_duration:ce.duration||0,time_taken:Ee,started_at:Ae,submitted_at:ge.toISOString(),caught_cheating:!1,visibility_change_times:0,is_completed:!0,retest_assignment_id:Rt?Number(Rt):null,parent_test_id:e.test_id};console.log(" Submitting speaking test:",et),console.log(" Processing audio with AI...");try{const xt=await(await M("/.netlify/functions/process-speaking-audio-ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e.test_id,question_id:e.question_id||1,audio_blob:re})})).json();if(xt.success){console.log(" AI Analysis Result:",xt),u(xt.transcript);const it=xt.transcript?xt.transcript.split(/\s+/).filter(Mt=>Mt.length>0).length:0;console.log(" Word Count Verification:",{aiCount:xt.word_count,actualCount:it,transcript:xt.transcript});const ht=it,Dt={overall_score:xt.overall_score,word_count:ht,grammar_score:xt.grammar_score,vocabulary_score:xt.vocabulary_score,pronunciation_score:xt.pronunciation_score,fluency_score:xt.fluency_score,content_score:xt.content_score,grammar_mistakes:xt.grammar_mistakes,vocabulary_mistakes:xt.vocabulary_mistakes,feedback:xt.feedback,improved_transcript:xt.improved_transcript,grammar_corrections:xt.grammar_corrections||[],vocabulary_corrections:xt.vocabulary_corrections||[],language_use_corrections:xt.language_use_corrections||[],pronunciation_corrections:xt.pronunciation_corrections||[],ai_feedback:xt.ai_feedback||null};console.log(" Mapped Scores:",Dt),console.log(" Individual scores check:",{grammar_score:xt.grammar_score,vocabulary_score:xt.vocabulary_score,pronunciation_score:xt.pronunciation_score,fluency_score:xt.fluency_score,content_score:xt.content_score}),h(Dt),a("feedback")}else throw new Error(xt.message||"Failed to process audio with AI");localStorage.removeItem(`speaking_progress_${e.test_id}`)}catch(vt){console.error("Speaking test submission error:",vt),vt.message.includes("No valid authentication token found")?(b("Your session has expired. Please refresh the page and try again."),setTimeout(()=>{window.location.reload()},3e3)):b(vt.message),a("recording")}}catch(re){console.error("Speaking test submission error:",re),b(re.message),a("recording")}finally{Y(!1)}},[e,H,M,N,U,B]);S.useEffect(()=>{s==="processing"&&!c&&!d&&(console.log(' Detected stuck "processing" state on reload. Attempting recovery...'),i?(console.log(" Resuming processing from cached audio blob..."),se(i,j)):(console.log(" No cached audio blob found. Resetting to recording step."),a("recording")))},[s,c,d,i,j,se]);const X=S.useCallback(()=>{if(N<P){o(null),u(""),h(null),b(null),Y(!1);const ce=N+1;E(ce),U(ce),a("recording")}else b("Maximum attempts reached")},[N,P,U]),ie=S.useCallback(async()=>{if(!(!c||!d)){p(!0);try{const ce=new Date,Se=e.start_time?Math.round((ce-e.start_time)/1e3):0,re=e.start_time?new Date(e.start_time).toISOString():ce.toISOString(),ge=H.student_id,Ee=`retest_assignment_id_${ge}_speaking_${e.test_id}`,Ae=localStorage.getItem(Ee),{academicCalendarService:He}=await Zi(async()=>{const{academicCalendarService:it}=await Promise.resolve().then(()=>n2);return{academicCalendarService:it}},void 0);await He.loadAcademicCalendar();const Rt=He.getCurrentTerm()?.id;if(!Rt)throw new Error("No current academic period found");const et={test_id:e.test_id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:ge,academic_period_id:Rt,question_id:e.question_id||1,audio_blob:i?await R(i):null,audio_duration:i?.duration||0,time_taken:Se,started_at:re,submitted_at:ce.toISOString(),caught_cheating:!1,visibility_change_times:0,is_completed:!0,retest_assignment_id:Ae?Number(Ae):null,parent_test_id:e.test_id,transcript:c,scores:d,final_submission:!0};console.log(" Final submission:",et),console.log(" Making final submission request...");const vt=await M("/.netlify/functions/submit-speaking-test-final",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(et)});console.log(" Final submission response status:",vt.status);const xt=await vt.json();if(console.log(" Final submission result:",xt),xt.success){if(H?.student_id){const Ue=`test_completed_${H.student_id}_speaking_${e.test_id}`;localStorage.setItem(Ue,"true"),console.log(" Speaking test marked as completed in localStorage:",Ue);const tt=`retest_in_progress_${H.student_id}_speaking_${e.test_id}`;localStorage.removeItem(tt),console.log(" Cleared in-progress retest lock:",tt);const Et=`speaking_attempts_${H.student_id}_${e.test_id}`;localStorage.removeItem(Et),console.log(" Cleared attempts from localStorage upon submission");const{clearTestData:At}=await Zi(async()=>{const{clearTestData:qt}=await Promise.resolve().then(()=>Vg);return{clearTestData:qt}},void 0);At(H.student_id,"speaking_test_data",e.test_id),console.log(" Cleared speaking test data from cache upon submission");try{const qt=`anti_cheating_${H.student_id}_speaking_${e.test_id}`;localStorage.removeItem(qt),console.log(" Cleared anti-cheating key:",qt)}catch{}}console.log(" Caching speaking test results after submission...");const ht=`student_results_table_${H?.student_id||H?.id||"unknown"}`,{setCachedData:Dt,getCachedData:Mt,CACHE_TTL:Xe,clearTestData:De}=await Zi(async()=>{const{setCachedData:Ue,getCachedData:tt,CACHE_TTL:Et,clearTestData:At}=await Promise.resolve().then(()=>Vg);return{setCachedData:Ue,getCachedData:tt,CACHE_TTL:Et,clearTestData:At}},void 0),Le={id:Date.now(),test_id:e.test_id,test_type:"speaking",test_name:e.test_name,score:Math.round(d.overall_score/10),max_score:10,percentage:d.overall_score,caught_cheating:!1,visibility_change_times:0,is_completed:!0,submitted_at:new Date().toISOString(),subject:"Listening and Speaking",teacher_name:e.teacher_name||"Unknown"};let lt={success:!0,results:[],count:0};try{const Ue=Mt(ht);Ue&&Array.isArray(Ue.results)&&(lt.results=Ue.results.slice())}catch{}lt.results.unshift(Le),lt.count=lt.results.length,Dt(ht,lt,Xe.student_results_table),console.log(" Speaking test results cached (merged) with key:",ht),H?.student_id&&De(H.student_id,"speaking",e.test_id);try{const Ue=`retest_attempts_${H.student_id}_speaking_${e.test_id}`,tt=localStorage.getItem(Ue);let Et=0;if(tt)try{Et=JSON.parse(tt)?.used||0}catch{Et=0}const At={used:Et+1,max:P};localStorage.setItem(Ue,JSON.stringify(At));const qt=`retest1_${H.student_id}_speaking_${e.test_id}`,pr=`retest_assignment_id_${H.student_id}_speaking_${e.test_id}`;localStorage.removeItem(qt),localStorage.removeItem(pr),console.log(" Updated retest attempts meta and cleared retest keys:",At)}catch(Ue){console.warn(" Failed to update retest attempts meta/keys",Ue)}try{n&&n(d.overall_score),typeof r=="function"&&r()}catch{}return}else throw new Error(xt.message||"Failed to submit speaking test")}catch(ce){console.error("Speaking test submission error:",ce),b(ce.message)}finally{p(!1)}}},[e,H,M,c,d,i,N,t]);S.useCallback(()=>{a("completed"),t({test_id:e.test_id,transcript:c,scores:d,attempt_number:N})},[e.test_id,c,d,N,t]);const le=()=>{switch(s){case"recording":return l.jsxs("div",{className:"speaking-test-recording",children:[l.jsx("h2",{className:"text-2xl font-bold mb-4 text-center",children:e.test_name}),l.jsxs("div",{className:"mb-6 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Instructions:"}),l.jsx("p",{className:"text-gray-700 mb-4",children:e.prompt}),l.jsx("div",{className:"bg-blue-50 p-3 sm:p-4 rounded-lg",children:l.jsxs("p",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Requirements:"})," Minimum ",e.min_words||50," words, 0-",e.max_duration||600," seconds duration"]})})]}),l.jsx(aie,{ref:V,onRecordingComplete:se,minDuration:0,maxDuration:e.max_duration||600,minWords:e.min_words||50,maxAttempts:P,currentAttempt:N}),k&&l.jsx("div",{className:"mt-4 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-800",children:k})})]});case"processing":return l.jsxs("div",{className:"transcription-status bg-white rounded-lg shadow-lg p-4 sm:p-8 text-center",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-2xl font-semibold mb-2",children:"Processing Your Speech"}),l.jsx("p",{className:"text-lg text-blue-600",children:"Please wait while we process your audio..."})]}),l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),l.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),l.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]});case"feedback":return console.log(" Rendering feedback step with Submit Final button"),l.jsx(iie,{transcript:c,scores:d,audioBlob:i,recordingTime:j,onReRecord:X,onFinalSubmit:()=>v(!0),canReRecord:N<P,attemptNumber:N,maxAttempts:P,isSubmitting:g});case"completed":const ce={showResults:!0,testInfo:{test_name:e?.test_name||"Speaking Test",id:e?.test_id,test_id:e?.test_id},testType:"speaking",score:d?.overall_score||0,totalQuestions:1,percentage:d?.overall_score||0,passed:(d?.overall_score||0)>=50,questionAnalysis:[{questionNumber:1,userAnswer:c,correctAnswer:"Speaking test completed",isCorrect:!0,score:d?.overall_score||0,maxScore:100,feedback:`Word Count: ${d?.word_count||0}, Grammar: ${d?.grammar_score||0}/40, Vocabulary: ${d?.vocab_score||0}/30`}],timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};return l.jsx("div",{className:"speaking-test-completed",children:l.jsx(Wv,{testResults:ce,onBackToCabinet:()=>C(!0),onRetakeTest:()=>{a("recording"),u(""),h(null),o(null),E(1)},isLoading:!1})});default:return null}};return l.jsxs("div",{children:[l.jsx(oa,{isOpen:x&&!g,onClose:()=>v(!1),title:"Submit Speaking Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ye,{onClick:()=>v(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ye,{onClick:()=>{v(!1),ie()},variant:"primary",children:"Submit"})]})]})}),l.jsx(oa,{isOpen:w,onClose:()=>C(!1),title:"Exit Speaking Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ye,{onClick:()=>C(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ye,{onClick:()=>{C(!1),typeof r=="function"&&r()},variant:"primary",children:"Go Back"})]})]})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-3 sm:p-6",children:[k&&l.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-800",children:k})}),le()]})]})},lie=e=>function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296},cie=(e,t,r)=>{if(e.length===1)return e[0];const n=`${r}:speaking:${t}`,s=Array.from(n).reduce((o,c)=>(o<<5)-o+c.charCodeAt(0),0)>>>0,a=lie(s),i=Math.floor(a()*e.length);return e[i]},uie=()=>{const{testId:e}=F_(),t=Eo(),{user:r}=cs(),n=Qo(),{showNotification:s}=za(),[a,i]=S.useState(null),[o,c]=S.useState([]),[u,d]=S.useState(null),[h,g]=S.useState(!0),[p,x]=S.useState(null),[v,w]=S.useState(!1),[C,k]=S.useState(null),[b,N]=S.useState(!1),{startTracking:E,stopTracking:P}=Xm("speaking",e,r?.student_id||r?.id);S.useEffect(()=>{F(),A()},[e]),S.useEffect(()=>{if(a&&!v){pe.debug(" Speaking test - initializing anti-cheating tracking");const Y=r?.student_id||r?.id||"unknown",Z=`anti_cheating_${Y}_speaking_${e}`,ae=localStorage.getItem(Z);if(pe.debug(" Checking for anti-cheating data with key:",Z),pe.debug(" Key format: anti_cheating_{studentId}_{testType}_{testId}"),pe.debug(" Current test details:",{testType:"speaking",testId:e,studentId:Y}),ae)try{const ee=JSON.parse(ae);pe.debug(" Found existing anti-cheating data for THIS speaking test:",ee),pe.debug(" Visibility change times for this test:",ee.tabSwitches||0),pe.debug(" Cheating status for this test:",ee.isCheating||!1),ee.isCheating&&(pe.debug(" WARNING: Student has been flagged for cheating in THIS speaking test!"),pe.debug(" Tab switches detected in this test:",ee.tabSwitches),s(` Warning: Suspicious activity detected in this speaking test (${ee.tabSwitches} tab switches). Continued violations may result in test disqualification.`,"warning"))}catch(ee){pe.error(" Error parsing existing anti-cheating data:",ee)}else pe.debug(" No existing anti-cheating data found for this speaking test - starting fresh");E(),pe.debug(" Anti-cheating tracking started for speaking test")}return()=>{a&&(pe.debug(" Cleaning up anti-cheating tracking for speaking test"),P())}},[a,v,e,r?.student_id,r?.id,E,P,s]);const F=async()=>{try{g(!0);const Y=await n.getSpeakingTest(e);if(Y.success)i(Y.test);else throw new Error(Y.message||"Failed to load test");const Z=await n.getSpeakingTestQuestions(e);if(Z.success){const ae=Z.questions;c(ae);const ee=r?.student_id||r?.id,ne=cie(ae,e,ee);d(ne),pe.debug(" Selected question for student:",{studentId:ee,testId:e,totalQuestions:ae.length,selectedQuestion:ne?.id,selectedPrompt:ne?.prompt?.substring(0,50)+"..."})}}catch(Y){pe.error("Error loading test data:",Y),x(Y.message)}finally{g(!1)}},A=()=>{const Z=`test_completed_${r?.student_id||r?.id}_speaking_${e}`;if(localStorage.getItem(Z)==="true"){w(!0);const ee=localStorage.getItem(`speaking_test_result_${e}`);ee&&k(JSON.parse(ee))}},j=async Y=>{try{w(!0),k(Y),localStorage.setItem(`speaking_test_result_${e}`,JSON.stringify(Y)),window.dispatchEvent(new CustomEvent("testCompleted",{detail:{testId:e,testType:"speaking"}})),setTimeout(()=>{t("/student")},2e3)}catch(Z){pe.error("Error handling test completion:",Z)}},I=()=>{if(pe.debug(" Navigating back to cabinet from speaking test..."),a&&r?.student_id){pe.debug(" Cabinet navigation detected - counting as cheating attempt");const Z=`anti_cheating_${r?.student_id||r?.id||"unknown"}_speaking_${e}`,ae=localStorage.getItem(Z);let ee=0,ne=!1;if(ae)try{const V=JSON.parse(ae);ee=V.tabSwitches||0,ne=V.isCheating||!1}catch(V){pe.error(" Error parsing existing anti-cheating data:",V)}const L=ee+1,H=L>=2;pe.debug(` Tab switch count: ${ee}  ${L} (cheating: ${H})`);const M={tabSwitches:L,isCheating:H,lastUpdated:new Date().toISOString()};localStorage.setItem(Z,JSON.stringify(M)),pe.debug(" Anti-cheating data updated for cabinet navigation:",M)}t("/student")};if(h)return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),l.jsx(Ye,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Loading speaking test..."})]})})})]});if(p)return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),l.jsx(Ye,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-red-600 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-6",children:p})]})})})]});if(v&&C)return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test Results"})}),l.jsx(Ye,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx(Wv,{testType:"speaking",testData:a,result:C,onRetake:()=>{w(!1),k(null);const Y=JSON.parse(localStorage.getItem("userData")||"{}").student_id;localStorage.removeItem(`test_completed_${Y}_speaking_${e}`)}})})]});if(!a||o.length===0)return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),l.jsx(Ye,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"No Test Data"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Unable to load test information"})]})})})]});const B=u;return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx(oa,{isOpen:b,onClose:()=>N(!1),title:"Exit Speaking Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ye,{onClick:()=>N(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ye,{onClick:()=>{N(!1),I()},variant:"primary",children:"Go Back"})]})]})}),l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),l.jsx(Ye,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.length>1&&u&&l.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-white text-xs font-bold",children:"i"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Question Selection"}),l.jsx("div",{className:"mt-1 text-sm text-blue-700",children:l.jsxs("p",{children:["This test has ",o.length," questions. You have been assigned ",l.jsxs("strong",{children:["Question ",u.question_number]}),"."]})})]})]})}),l.jsx(oie,{testData:{...a,test_id:parseInt(e),question_id:B?.id,prompt:B?.prompt,start_time:Date.now()},onComplete:j,onExit:I,onTestComplete:j})]})]})},die=()=>{const{testType:e,testId:t}=F_(),r=Eo(),{activeTests:n}=zv(),s=()=>{r("/student")},a=n.find(i=>i.test_type===e&&i.test_id===parseInt(t));return l.jsx(rie,{onBackToCabinet:s,currentTest:a||{test_type:e,test_id:parseInt(t)}})},fie=()=>{const e=Eo(),{user:t,isAuthenticated:r,isLoading:n}=cs(),[s,a]=S.useState(!1),[i,o]=S.useState(!0),[c,u]=S.useState(""),[d,h]=S.useState([]),[g,p]=S.useState(!1),[x,v]=S.useState(!1),[w,C]=S.useState({currentPassword:"",newPassword:"",confirmPassword:""}),k=S.useCallback(async()=>{pe.debug(" Initializing Student Application...");try{if(o(!0),u(""),!r||!t){pe.debug(" User not authenticated, redirecting to login"),e("/login");return}if(t.role!==Ji.STUDENT){pe.error(" Invalid user role for student app:",t.role),u("Access denied. Student role required.");return}pe.debug(" Initializing event listeners..."),b(),pe.debug(" Setting up back to cabinet button listeners..."),N(),pe.debug(" Setting up password change form listener..."),E(),pe.debug(" Loading student data..."),await P(),pe.debug(" Exposing student functions globally..."),F(),pe.debug(" Populating student info from user data..."),Z(t),a(!0),pe.debug(" Student Application initialization complete!")}catch(ne){pe.error(" Error initializing student app:",ne),u("Failed to initialize student application")}finally{o(!1)}},[r,t,e]);S.useEffect(()=>{n||k()},[n,r,t,k]);const b=S.useCallback(()=>{pe.debug(" Setting up student event listeners...");const ne=H=>{g&&!H.target.closest(".student-menu")&&p(!1)},L=H=>{H.key==="Escape"&&g&&p(!1)};return document.addEventListener("click",ne),document.addEventListener("keydown",L),()=>{document.removeEventListener("click",ne),document.removeEventListener("keydown",L)}},[g]),N=S.useCallback(()=>{pe.debug(" Setting up back to cabinet listeners...")},[]),E=S.useCallback(()=>{pe.debug(" Setting up password change form...")},[]),P=S.useCallback(async()=>{pe.debug(" Loading student data...");try{pe.debug(" Student data loaded successfully")}catch(ne){throw pe.error(" Error loading student data:",ne),ne}},[]),F=S.useCallback(()=>{pe.debug(" Exposing student functions globally..."),window.toggleStudentMenu=A,window.showChangePasswordTab=j,window.hideChangePasswordTab=I,window.navigateBackToCabinet=Y,window.handlePasswordChange=B,window.populateStudentInfoDirectly=Z,pe.debug(" All student functions exposed globally")},[]),A=S.useCallback(()=>{pe.debug(" toggleStudentMenu called"),p(ne=>{const L=!ne;return pe.debug(" Menu state changed from",ne,"to",L),L}),pe.debug(" Toggled dropdown menu")},[]),j=S.useCallback(()=>{pe.debug(" showChangePasswordTab called"),v(!0),p(!1)},[]),I=S.useCallback(()=>{pe.debug(" hideChangePasswordTab called"),v(!1),C({currentPassword:"",newPassword:"",confirmPassword:""})},[]),B=S.useCallback(async ne=>{ne.preventDefault(),pe.debug(" handlePasswordChange called");const{currentPassword:L,newPassword:H,confirmPassword:M}=w;if(!L||!H||!M){ae("Please fill in all fields","error");return}if(H!==M){ae("New passwords do not match","error");return}if(H.length<6){ae("New password must be at least 6 characters long","error");return}const V=/[a-zA-Z]/.test(H),W=/[0-9]/.test(H);if(!V||!W){ae("New password must contain both letters and numbers","error");return}if(!t||!t.student_id){ae("Session expired. Please login again.","error");return}const R=t.student_id;if(window.confirm("Are you sure you want to change your password?"))try{o(!0);const U=await hs.changePassword({studentId:R,currentPassword:L,newPassword:H});U.success?(ae("Password changed successfully!","success"),I()):ae(U.message||"Failed to change password","error")}catch(U){pe.error("Password change error:",U),ae("Failed to change password. Please try again.","error")}finally{o(!1)}},[w,t]),Y=S.useCallback(()=>{if(pe.debug("[DEBUG] navigateBackToCabinet called"),!r||!t){pe.warn("[WARN] No valid user found, redirecting to login"),e("/login");return}t.role===Ji.STUDENT?(pe.debug("[DEBUG] Navigating to student cabinet"),e("/student")):(pe.warn("[WARN] Unknown user role, redirecting to login"),e("/login"))},[r,t,e]),Z=S.useCallback(ne=>{pe.debug(" populateStudentInfoDirectly called with:",ne);try{pe.debug(" Student info populated successfully")}catch(L){pe.error(" Error populating student info:",L)}},[]),ae=S.useCallback((ne,L)=>{const H={id:Date.now(),message:ne,type:L,timestamp:new Date};h(M=>[...M,H]),setTimeout(()=>{h(M=>M.filter(V=>V.id!==H.id))},N0.NOTIFICATION_DURATION)},[]),ee=S.useCallback(ne=>{const{name:L,value:H}=ne.target;C(M=>({...M,[L]:H}))},[]);return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(zr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Initializing Student Application..."})]})}):c?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Initialization Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:c}),l.jsx(Ye,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?l.jsxs("div",{className:"bg-gray-50",children:[l.jsxs(gN,{children:[l.jsx(Os,{path:"/",element:l.jsxs("div",{className:"student-app",children:[l.jsx(Jae,{isMenuOpen:g,onToggleMenu:A,onShowPasswordChange:j}),x&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Change Password"}),l.jsxs("form",{onSubmit:B,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),l.jsx("input",{type:"password",id:"currentPassword",name:"currentPassword",value:w.currentPassword,onChange:ee,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),l.jsx("input",{type:"password",id:"newPassword",name:"newPassword",value:w.newPassword,onChange:ee,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),l.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:w.confirmPassword,onChange:ee,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx(Ye,{type:"button",variant:"secondary",onClick:I,className:"flex-1",children:"Cancel"}),l.jsx(Ye,{type:"submit",variant:"primary",disabled:i,className:"flex-1",children:i?l.jsxs(l.Fragment,{children:[l.jsx(zr,{size:"sm",className:"mr-2"}),"Changing..."]}):"Change Password"})]})]})]})})]})}),l.jsx(Os,{path:"/test/:testType/:testId",element:l.jsx(die,{})}),l.jsx(Os,{path:"matching-test/:testId",element:l.jsx(nie,{})}),l.jsx(Os,{path:"word-matching-test/:testId",element:l.jsx(sie,{})}),l.jsx(Os,{path:"speaking-test/:testId",element:l.jsx(uie,{})}),l.jsx(Os,{path:"/results",element:l.jsx(WB,{})})]}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:d.map(ne=>l.jsx(uc,{type:ne.type,message:ne.message,onClose:()=>h(L=>L.filter(H=>H.id!==ne.id))},ne.id))})]}):l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(zr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Setting up Student Application..."})]})})},hie=()=>l.jsx(OM,{children:l.jsx(PB,{children:l.jsx(AB,{children:l.jsx(fie,{})})})}),gie=({result:e,isOpen:t,onClose:r,initialTab:n="overview",editingSpeakingScore:s,tempSpeakingScore:a,isSavingSpeakingScore:i,onStartSpeakingScoreEdit:o,onSaveSpeakingScore:c,onCancelSpeakingScoreEdit:u,onTempSpeakingScoreChange:d})=>{const[h,g]=S.useState(n),p=S.useRef(!1);if(S.useEffect(()=>()=>{p.current=!0},[]),S.useEffect(()=>{t&&g(n)},[t,n]),!t||!e)return null;const x={test_id:e.test_id,test_name:e.test_name,subject_id:e.subject_id};let v=e?.__audioUrl||void 0;const w=v?void 0:e?.answers;typeof w=="string"?v=w:w&&typeof w=="object"&&(v=w.audio_url),S.useEffect(()=>{console.log("[SpeakingReview] Transcript sources",{fromResult:e?.transcript,fromAnswersObject:typeof w=="object"&&w?.transcript?w.transcript:void 0,hasAnswers:!!w,test_id:e?.test_id,student_id:e?.student_id})},[e?.test_id,e?.student_id]);const[C,k]=S.useState("");S.useEffect(()=>{const N=new AbortController;let E=!1;const P=e?.__studentId||e?.student_id;return!e?.transcript&&!(typeof w=="object"&&w?.transcript)&&e?.test_id&&P&&(async()=>{try{const F=`/.netlify/functions/get-speaking-test-new?action=transcript&test_id=${encodeURIComponent(e.test_id)}&student_id=${encodeURIComponent(P)}`;console.log("[SpeakingReview] Fetching transcript from API:",{url:F});const A=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token"),j=await fetch(F,{headers:{Authorization:A?`Bearer ${A}`:""},signal:N.signal});console.log("[SpeakingReview] Transcript API response:",{ok:j.ok,status:j.status});const I=await j.json().catch(()=>({}));console.log("[SpeakingReview] Transcript API body:",I),!E&&!p.current&&(j.ok?k(I.transcript||""):console.warn("[SpeakingReview] Transcript API failed:",I?.error||"unknown error"))}catch(F){F.name!=="AbortError"&&!p.current&&console.error("[SpeakingReview] Transcript fetch error:",F)}})(),()=>{E=!0;try{N.abort()}catch{}}},[e]);const b={score:e.score,max_score:e.max_score,percentage:e.percentage,audio_url:v,transcript:e.transcript||C||(typeof w=="object"&&w?.transcript?w.transcript:void 0),time_taken:e.time_taken,started_at:e.started_at,submitted_at:e.submitted_at};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"bg-blue-600 text-white px-6 py-4 flex justify-between items-center",children:[l.jsxs("h2",{className:"text-xl font-semibold",children:["Speaking Test Review - ",x.test_name]}),l.jsx("button",{onClick:r,className:"text-white hover:text-gray-200 text-2xl font-bold",children:""})]}),l.jsx("div",{className:"border-b border-gray-200",children:l.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"audio",label:"Audio"},{id:"transcript",label:"Transcript"},{id:"analysis",label:"AI Analysis"},{id:"scoring",label:"Scoring"}].map(N=>l.jsx("button",{onClick:()=>g(N.id),className:`py-4 px-1 border-b-2 font-medium text-sm ${h===N.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:N.label},N.id))})}),l.jsxs("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:[h==="overview"&&l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Test Name"}),l.jsx("p",{className:"mt-1 text-sm text-gray-900",children:x.test_name})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Score"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[b.score," / ",b.max_score]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Time Taken"}),l.jsx("p",{className:"mt-1 text-sm text-gray-900",children:b.time_taken?`${Math.floor(b.time_taken/60)}:${(b.time_taken%60).toString().padStart(2,"0")}`:"N/A"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Submitted At"}),l.jsx("p",{className:"mt-1 text-sm text-gray-900",children:b.submitted_at?new Date(b.submitted_at).toLocaleString():"N/A"})]})]})}),h==="audio"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Audio Recording"}),b.audio_url?l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Click the play button to listen to the student's recording:"}),l.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:l.jsx(HB,{audioUrl:b.audio_url,className:"w-full"})})]}):l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"No audio recording available"})})]}),h==="transcript"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Transcript"}),b.transcript?l.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:l.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:b.transcript})}):l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"No transcript available"})})]}),h==="analysis"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"AI Analysis Results"}),(()=>{let N=e.ai_feedback;if(N&&typeof N=="string")try{N=JSON.parse(N)}catch{N=null}return N?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-4",children:"Overall Performance"}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-800",children:N.overall_score||0}),l.jsx("div",{className:"text-sm text-gray-600",children:"Overall Score (0-100)"})]})]}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-4",children:"Category Breakdown"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[N.grammar_score||0,"/25"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Grammar"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-green-600",children:[N.vocabulary_score||0,"/20"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Vocabulary"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[N.pronunciation_score||0,"/15"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Pronunciation"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-orange-600",children:[N.fluency_score||0,"/20"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Fluency"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-red-600",children:[N.content_score||0,"/20"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Content"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Performance Metrics"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Word Count:"}),l.jsx("span",{className:"text-sm font-medium",children:N.word_count||0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Grammar Mistakes:"}),l.jsx("span",{className:"text-sm font-medium text-red-600",children:N.grammar_mistakes||0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Vocabulary Issues:"}),l.jsx("span",{className:"text-sm font-medium text-red-600",children:N.vocabulary_mistakes||0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Difficulty Level:"}),l.jsx("span",{className:"text-sm font-medium",children:N.difficulty_level||"N/A"})]})]})]}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"AI Feedback"}),N.feedback?l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:l.jsx("p",{className:"text-sm text-gray-700",children:N.feedback})}):l.jsx("div",{className:"text-center py-4 text-gray-500",children:l.jsx("p",{className:"text-sm",children:"No AI feedback available"})})]})]}),N.improved_transcript&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Improved Transcript"}),l.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:l.jsx("p",{className:"text-sm text-gray-700",children:N.improved_transcript})})]}),N.grammar_corrections&&N.grammar_corrections.length>0&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Grammar Corrections"}),l.jsx("div",{className:"space-y-3",children:N.grammar_corrections.map((E,P)=>l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-red-800",children:"Mistake:"})," ",E.mistake]}),l.jsxs("div",{className:"text-sm mt-1",children:[l.jsx("span",{className:"font-medium text-green-800",children:"Correction:"})," ",E.correction]}),E.explanation&&l.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[l.jsx("span",{className:"font-medium",children:"Explanation:"})," ",E.explanation]})]},P))})]}),N.vocabulary_corrections&&N.vocabulary_corrections.length>0&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Vocabulary Improvements"}),l.jsx("div",{className:"space-y-3",children:N.vocabulary_corrections.map((E,P)=>l.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-yellow-800",children:"Original:"})," ",E.mistake]}),l.jsxs("div",{className:"text-sm mt-1",children:[l.jsx("span",{className:"font-medium text-green-800",children:"Better:"})," ",E.correction]}),E.explanation&&l.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[l.jsx("span",{className:"font-medium",children:"Explanation:"})," ",E.explanation]})]},P))})]}),N.language_use_corrections&&N.language_use_corrections.length>0&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Language Use Suggestions"}),l.jsx("div",{className:"space-y-3",children:N.language_use_corrections.map((E,P)=>l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-blue-800",children:"Original:"})," ",E.mistake]}),l.jsxs("div",{className:"text-sm mt-1",children:[l.jsx("span",{className:"font-medium text-blue-800",children:"Suggestion:"})," ",E.suggestion]}),E.explanation&&l.jsx("div",{className:"text-xs text-blue-700 mt-1",children:E.explanation})]},P))})]})]}):l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"No AI analysis available for this result"})})})()]}),h==="scoring"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 text-center",children:"Score Details"}),s?l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 place-items-center",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Score"}),l.jsx("input",{type:"number",min:"0",max:b.max_score,value:a,onChange:N=>d(N.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Max Score"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-900 text-center",children:[b.max_score," (Fixed)"]})]})]}),l.jsxs("div",{className:"flex justify-center space-x-3",children:[l.jsx("button",{onClick:c,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:i?"Saving...":"Save Score"}),l.jsx("button",{onClick:u,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Cancel"})]})]}):l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("div",{className:"grid grid-cols-1 place-items-center gap-2",children:l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Current Score"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-900 text-center",children:[b.score," / ",b.max_score]})]})}),l.jsx("button",{onClick:()=>o(e.id,b.score),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 mx-auto",children:"Edit Score"})]})]})]}),l.jsx("div",{className:"bg-gray-50 px-6 py-4 flex justify-end space-x-3",children:l.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Close"})})]})})},mie=({isOpen:e,onClose:t,testResult:r,questions:n,isLoadingQuestions:s})=>{const a=w=>{if(!w)return{};if(typeof w=="string")try{return JSON.parse(w)}catch{return{}}return w||{}},i=S.useMemo(()=>{const w=r?.answers;if(console.log(" [TestAnswerModal] Raw testResult.answers:",w),console.log(" [TestAnswerModal] Raw testResult.answers type:",typeof w),w&&typeof w=="object"&&w.answers_by_id)return console.log(" [TestAnswerModal] Found answers_by_id format"),console.log(" [TestAnswerModal] answers_by_id:",w.answers_by_id),console.log(" [TestAnswerModal] question_order:",w.question_order),w.answers_by_id||{};const C=a(w);return console.log(" [TestAnswerModal] Parsed student answers:",C),console.log(" [TestAnswerModal] Full testResult:",r),C},[r?.answers]),o=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Question"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((w,C)=>{const k=w.question_id||w.id||C+1,b=String(k),N=Number(k),E=i[b]!==void 0?i[b]:i[N]!==void 0?i[N]:i[k]!==void 0?i[k]:void 0,P=w.correct_answer,F=E===P,A=j=>{const I=`option_${j.toLowerCase()}`;return w[I]||j};return l.jsxs("tr",{className:F?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:C+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:w.question}),l.jsx("td",{className:"px-4 py-3 text-sm",children:E?l.jsxs("span",{className:`font-medium ${F?"text-green-700":"text-red-700"}`,children:[E," - ",A(E)]}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsxs("td",{className:"px-4 py-3 text-sm text-gray-700",children:[P," - ",A(P)]}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:F?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},b)})})]})}),c=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Question"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((w,C)=>{const k=w.question_id||w.id||C+1,b=String(k),N=Number(k),E=i[b]!==void 0?i[b]:i[N]!==void 0?i[N]:i[k]!==void 0?i[k]:void 0,P=w.correct_answer;let F;typeof E=="boolean"?F=E:typeof E=="string"?F=E.toLowerCase().trim()==="true":E===1||E==="1"?F=!0:E===0||E==="0"?F=!1:F=!!E;let A;typeof P=="boolean"?A=P:typeof P=="string"?A=P.toLowerCase().trim()==="true":A=!!P;const j=F===A;C===0&&console.log(" [TestAnswerModal] True/False First Question Debug:",{questionIdStr:b,studentAnswer:E,studentAnswerType:typeof E,normalizedStudentAnswer:F,correctAnswer:P,correctAnswerType:typeof P,normalizedCorrectAnswer:A,isCorrect:j});const I=E!=null?F:null,B=A;return l.jsxs("tr",{className:j?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:C+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:w.question}),l.jsx("td",{className:"px-4 py-3 text-sm",children:I!==null?l.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${I?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:I?"True":"False"}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-3 text-sm",children:l.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${B?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:B?"True":"False"})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:j?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},b)})})]})}),u=()=>{if(!n||n.length===0)return l.jsx("p",{className:"text-gray-500",children:"No questions available"});const w=(C,k)=>{if(!C||!k||k.length===0)return!1;const b=String(C).toLowerCase().trim();return k.some(N=>{const E=String(N).toLowerCase().trim();return b===E||E.length>=2&&b.includes(E)?!0:E.length===1?b.startsWith(E)||b.endsWith(E):!1})};return l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Question"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Answer(s)"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((C,k)=>{const b=C.question_id||C.id||k+1,N=String(b),E=Number(b),P=i[N]!==void 0?i[N]:i[E]!==void 0?i[E]:i[b]!==void 0?i[b]:void 0,F=Array.isArray(C.correct_answers)?C.correct_answers:C.correct_answer?[C.correct_answer]:[],A=w(P,F);return k===0&&console.log(" [TestAnswerModal] First question debug:",{questionIdNum:b,questionIdStr:N,questionIdNumKey:E,studentAnswer:P,studentAnswers:i,studentAnswersKeys:Object.keys(i),correctAnswers:F,question:C}),l.jsxs("tr",{className:A?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:k+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:C.question}),l.jsx("td",{className:"px-4 py-3 text-sm",children:P?l.jsx("span",{className:`font-medium ${A?"text-green-700":"text-red-700"}`,children:P}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:F.length>0?l.jsx("div",{className:"space-y-1",children:F.map((j,I)=>l.jsx("div",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:j},I))}):l.jsx("span",{className:"text-gray-400",children:"No correct answer defined"})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:A?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},N)})})]})})},d=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Left Word"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Match"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Match"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((w,C)=>{const k=w.question_id||w.id||C+1,b=String(k),N=Number(k),E=i[b]!==void 0?i[b]:i[N]!==void 0?i[N]:i[k]!==void 0?i[k]:void 0,P=w.left_word,F=w.right_word;let A=null,j=!1;if(E){if(typeof E=="object")A=E.definition||E.right||E.word,j=E.word===P&&(E.definition||E.right)===F;else if(typeof E=="string")try{const I=JSON.parse(E);A=I.definition||I.right||I.word,j=I.word===P&&(I.definition||I.right)===F}catch{A=E}}return l.jsxs("tr",{className:j?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:C+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:P}),l.jsx("td",{className:"px-4 py-3 text-sm",children:A?l.jsx("span",{className:j?"text-green-700 font-medium":"text-red-700 font-medium",children:A}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:F}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:j?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},b)})})]})}),h=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"space-y-6",children:n.map((w,C)=>{const k=w.question_id||w.id||C+1,b=String(k),N=Number(k);C===0&&console.log(" [TestAnswerModal] Fill Blanks First Question Debug:",{questionIdNum:k,questionIdStr:b,questionIdNumKey:N,question:w,studentAnswers:i,studentAnswersKeys:Object.keys(i),correctAnswers:w.correct_answers});const E=i[b]!==void 0?i[b]:i[N]!==void 0?i[N]:i[k]!==void 0?i[k]:void 0,P=Array.isArray(w.correct_answers)?w.correct_answers:[];let F=[];return Array.isArray(E)?F=E:E!=null?F=[E]:F=[],l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-semibold text-gray-900 mb-3",children:["Question ",C+1]}),l.jsxs("div",{className:"space-y-3",children:[w.question_json&&l.jsx("div",{className:"text-sm text-gray-700 mb-4",children:typeof w.question_json=="string"?w.question_json:w.question_json.text||w.question_json.question||"Question text not available"}),l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Blank #"}),l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Correct Answer"}),l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map((A,j)=>{let I=F[j];const B=j+1,Y=String(B),Z=Number(B);(I==null||I==="")&&(I=i[Y]!==void 0?i[Y]:i[Z]!==void 0?i[Z]:I),C===0&&j===0&&console.log(" [TestAnswerModal] Fill Blanks First Blank Debug:",{blankIndex:j,potentialBlankId:B,potentialBlankIdStr:Y,potentialBlankIdNum:Z,studentAns:I,studentAnswersForQ:F,correctAns:A,studentAnswersKeys:Object.keys(i)});const ae=String(I||"").trim().toLowerCase()===String(A||"").trim().toLowerCase();return l.jsxs("tr",{className:ae?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900",children:j+1}),l.jsx("td",{className:"px-4 py-2 text-sm",children:I?l.jsx("span",{className:ae?"text-green-700 font-medium":"text-red-700 font-medium",children:String(I)}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:String(A)}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:ae?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:""}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:""})})]},j)})})]})]})]},b)})}),g=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Matching type tests require visual comparison. Answers stored as connection pairs."}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Word"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student Connection"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((w,C)=>{const k=w.question_id||w.id||C+1,b=String(k),N=Number(k),E=i[b]!==void 0?i[b]:i[N]!==void 0?i[N]:i[k]!==void 0?i[k]:void 0;return l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:w.word}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:E?typeof E=="object"?JSON.stringify(E):E:l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})})]},b)})})]})})]}),p=()=>{if(!r)return null;const w=r.test_type||r.testType;if(s)return l.jsxs("div",{className:"flex items-center justify-center py-12",children:[l.jsx(zr,{size:"lg"}),l.jsx("span",{className:"ml-4 text-gray-600",children:"Loading questions..."})]});if(!n||n.length===0)return l.jsxs("div",{className:"text-center py-8",children:[l.jsx("p",{className:"text-gray-500",children:"Unable to load questions for this test."}),l.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:["Test ID: ",r.test_id,", Type: ",w]})]});switch(w){case"multiple_choice":return o();case"true_false":return c();case"input":return u();case"word_matching":return d();case"fill_blanks":return h();case"matching_type":return g();default:return l.jsxs("div",{className:"text-center py-8",children:[l.jsxs("p",{className:"text-gray-500",children:['Test type "',w,'" is not supported for answer viewing.']}),l.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Drawing and Speaking tests have their own dedicated modals."})]})}};if(!r)return null;r.test_type||r.testType;const x=`${r.name||""} ${r.surname||""}`.trim(),v=`${r.test_name||"Test"} - ${x||r.student_id}`;return l.jsxs(oa,{isOpen:e,onClose:t,title:v,size:"large",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[l.jsxs("div",{className:"flex space-x-6",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Score"}),l.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:[r.best_retest_score!==null&&r.best_retest_score!==void 0?`${r.best_retest_score} / ${r.best_retest_max_score||r.max_score||0}`:`${r.score||0} / ${r.max_score||0}`,r.best_retest_score!==null&&r.best_retest_score!==void 0&&l.jsx("span",{className:"ml-2 text-xs text-blue-600",children:"(Retest Best)"})]})]}),r.best_retest_percentage!==null&&r.best_retest_percentage!==void 0&&r.best_retest_percentage>0||r.percentage&&r.percentage>0?l.jsxs("div",{children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Percentage"}),l.jsx("div",{className:"text-lg font-semibold text-gray-900",children:r.best_retest_percentage!==null&&r.best_retest_percentage!==void 0?`${r.best_retest_percentage.toFixed(1)}%`:`${r.percentage?.toFixed(1)||"0.0"}%`})]}):null,r.subject&&r.subject!=="N/A"?l.jsxs("div",{children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Subject"}),l.jsx("div",{className:"text-sm font-medium text-gray-700",children:r.subject})]}):null]}),r.submitted_at&&l.jsxs("div",{className:"text-right",children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Submitted"}),l.jsx("div",{className:"text-sm text-gray-700",children:new Date(r.submitted_at).toLocaleString()})]})]}),l.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:p()}),r.caught_cheating&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:l.jsxs("p",{className:"text-sm text-red-800",children:[" This test was flagged for suspicious activity (visibility changes: ",r.visibility_change_times||0,")"]})})]})};class yk extends Fs.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){if(console.error("ErrorBoundary caught an error:",t,r),t.message&&t.message.includes("Minified React error #300")){console.warn("React error #300 caught and handled by ErrorBoundary");return}}render(){return this.state.hasError?l.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[l.jsx("h3",{className:"text-red-800 font-medium",children:"Something went wrong"}),l.jsx("p",{className:"text-red-600 text-sm mt-1",children:"An error occurred while rendering this component."})]}):this.props.children}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Mb={};Mb.version="0.18.5";var GB=1252,pie=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],X4={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Q4=function(e){pie.indexOf(e)!=-1&&(GB=X4[0]=e)};function xie(){Q4(1252)}var ac=function(e){Q4(e)};function J4(){ac(1200),xie()}function AF(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function yie(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function VB(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var cy=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?yie(e.slice(2)):t==254&&r==255?VB(e.slice(2)):t==65279?e.slice(1):e},kw=function(t){return String.fromCharCode(t)},jF=function(t){return String.fromCharCode(t)},Jy,gf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Zy(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,s=e.charCodeAt(u++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=gf.charAt(a)+gf.charAt(i)+gf.charAt(o)+gf.charAt(c);return t}function Yo(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=gf.indexOf(e.charAt(u++)),i=gf.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=gf.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=gf.indexOf(e.charAt(u++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var en=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ud=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Tf(e){return en?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function PF(e){return en?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ho=function(t){return en?ud(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function s2(e){if(typeof ArrayBuffer>"u")return Ho(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Lf(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function vie(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Z4(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Z4(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var La=en?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ud(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function wie(e){for(var t=[],r=0,n=e.length+250,s=Tf(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Tf(65535),n=65530)}return t.push(s.slice(0,r)),La(t)}var no=/\u0000/g,uy=/[\u0001-\u0006]/g;function um(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ic(e,t){var r=""+e;return r.length>=t?r:Ds("0",t-r.length)+r}function e3(e,t){var r=""+e;return r.length>=t?r:Ds(" ",t-r.length)+r}function Lb(e,t){var r=""+e;return r.length>=t?r:r+Ds(" ",t-r.length)}function bie(e,t){var r=""+Math.round(e);return r.length>=t?r:Ds("0",t-r.length)+r}function _ie(e,t){var r=""+e;return r.length>=t?r:Ds("0",t-r.length)+r}var FF=Math.pow(2,32);function Ig(e,t){if(e>FF||e<-FF)return bie(e,t);var r=Math.round(e);return _ie(r,t)}function Bb(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var OF=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],vk=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Sie(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var jr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},DF={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},kie={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $b(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,c=1,u=0,d=0,h=Math.floor(s);u<t&&(h=Math.floor(s),o=h*i+a,d=h*u+c,!(s-h<5e-8));)s=1/(s-h),a=i,i=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=a):(d=u,o=i)),!r)return[0,n*o,d];var g=Math.floor(n*o/d);return[g,n*o-g*d,d]}function Dh(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=jie(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var KB=new Date(1899,11,31,0,0,0),Cie=KB.getTime(),Tie=new Date(1900,2,1,0,0,0);function qB(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Tie&&(r+=1440*60*1e3),(r-(Cie+(e.getTimezoneOffset()-KB.getTimezoneOffset())*6e4))/(1440*60*1e3)}function t3(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Eie(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Nie(e){var t=e<0?12:11,r=t3(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Aie(e){var t=t3(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ev(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Nie(e):t===10?r=e.toFixed(10).substr(0,12):r=Aie(e),t3(Eie(r.toUpperCase()))}function h0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ev(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Al(14,qB(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function jie(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Pie(e,t,r,n){var s="",a=0,i=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return vk[r.m-1][1];case 5:return vk[r.m-1][0];default:return vk[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return OF[r.q][0];default:return OF[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ic(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=ic(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?ic(c,u):"";return d}function mf(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var YB=/%/g;function Fie(e,t,r){var n=t.replace(YB,""),s=t.length-n.length;return Ku(e,n,r*Math.pow(10,2*s))+Ds("%",s)}function Oie(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ku(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function XB(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+XB(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var QB=/# (\?+)( ?)\/( ?)(\d+)/;function Die(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Ds(" ",e[1].length+1+e[4].length):e3(i,e[1].length)+e[2]+"/"+e[3]+ic(o,e[4].length))}function Iie(e,t,r){return r+(t===0?"":""+t)+Ds(" ",e[1].length+2+e[4].length)}var JB=/^#*0*\.([0#]+)/,ZB=/\).*[0#]/,e$=/\(###\) ###\\?-####/;function Xi(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function IF(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function RF(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Rie(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Mie(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function hl(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZB)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?hl("n",n,r):"("+hl("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Oie(e,t,r);if(t.indexOf("%")!==-1)return Fie(e,t,r);if(t.indexOf("E")!==-1)return XB(t,r);if(t.charCodeAt(0)===36)return"$"+hl(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ig(c,t.length);if(t.match(/^[#?]+$/))return s=Ig(r,0),s==="0"&&(s=""),s.length>t.length?s:Xi(t.substr(0,t.length-s.length))+s;if(a=t.match(QB))return Die(a,c,u);if(t.match(/^#+0+$/))return u+Ig(c,t.length-t.indexOf("0"));if(a=t.match(JB))return s=IF(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Xi(a[1])).replace(/\.$/,"."+Xi(a[1])).replace(/\.(\d*)$/,function(x,v){return"."+v+Ds("0",Xi(a[1]).length-v.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+IF(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+mf(Ig(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+hl(e,t,-r):mf(""+(Math.floor(r)+Rie(r,a[1].length)))+"."+ic(RF(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return hl(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=um(hl(e,t.replace(/[\\-]/g,""),r)),i=0,um(um(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(e$))return s=hl(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=$b(c,Math.pow(10,i)-1,!1),s=""+u,d=Ku("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=Lb(o[2],i),d.length<a[4].length&&(d=Xi(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=$b(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?e3(o[1],i)+a[2]+"/"+a[3]+Lb(o[2],i):Ds(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=Ig(r,0),t.length<=s.length?s:Xi(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=t.indexOf(".")-i,g=t.length-s.length-h;return Xi(t.substr(0,h)+s+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=RF(r,a[1].length),r<0?"-"+hl(e,t,-r):mf(Mie(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ic(0,3-x.length):"")+x})+"."+ic(i,a[1].length);switch(t){case"###,##0.00":return hl(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=mf(Ig(c,0));return p!=="0"?u+p:"";case"###,###.00":return hl(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return hl(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Lie(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ku(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Bie(e,t,r){var n=t.replace(YB,""),s=t.length-n.length;return Ku(e,n,r*Math.pow(10,2*s))+Ds("%",s)}function t$(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+t$(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Mc(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZB)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Mc("n",n,r):"("+Mc("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Lie(e,t,r);if(t.indexOf("%")!==-1)return Bie(e,t,r);if(t.indexOf("E")!==-1)return t$(t,r);if(t.charCodeAt(0)===36)return"$"+Mc(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+ic(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Xi(t.substr(0,t.length-s.length))+s;if(a=t.match(QB))return Iie(a,c,u);if(t.match(/^#+0+$/))return u+ic(c,t.length-t.indexOf("0"));if(a=t.match(JB))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Xi(a[1])).replace(/\.$/,"."+Xi(a[1])),s=s.replace(/\.(\d*)$/,function(x,v){return"."+v+Ds("0",Xi(a[1]).length-v.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+mf(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Mc(e,t,-r):mf(""+r)+"."+Ds("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Mc(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=um(Mc(e,t.replace(/[\\-]/g,""),r)),i=0,um(um(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(e$))return s=Mc(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=$b(c,Math.pow(10,i)-1,!1),s=""+u,d=Ku("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=Lb(o[2],i),d.length<a[4].length&&(d=Xi(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=$b(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?e3(o[1],i)+a[2]+"/"+a[3]+Lb(o[2],i):Ds(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Xi(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=t.indexOf(".")-i,g=t.length-s.length-h;return Xi(t.substr(0,h)+s+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Mc(e,t,-r):mf(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ic(0,3-x.length):"")+x})+"."+ic(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=mf(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return Mc(e,t.slice(0,t.lastIndexOf(".")),r)+Xi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ku(e,t,r){return(r|0)===r?Mc(e,t,r):hl(e,t,r)}function $ie(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var r$=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Jm(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Bb(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(r$))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Uie(e,t,r,n){for(var s=[],a="",i=0,o="",c="t",u,d,h,g="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Bb(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(h=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(h);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=e.charAt(++i),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=Dh(t,r,e.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Dh(t,r),u==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),s[s.length]={t:o,v:a},c=o;break;case"A":case"a":case"":var v={t:o,v:o};if(u==null&&(u=Dh(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(v.v=u.H>=12?"P":"A"),v.t="T",g="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(v.v=u.H>=12?"PM":"AM"),v.t="T",i+=5,g="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(v.v=u.H>=12?"":""),v.t="T",i+=5,g="h"):(v.t="t",++i),u==null&&v.t==="T")return"";s[s.length]=v,c=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(r$)){if(u==null&&(u=Dh(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Jm(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var w=0,C=0,k;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=g,c="h",w<1&&(w=1);break;case"s":(k=s[i].v.match(/\.0+$/))&&(C=Math.max(C,k[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[i].v.match(/[Hh]/)&&(w=1),w<2&&s[i].v.match(/[Mm]/)&&(w=2),w<3&&s[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",N;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=Pie(s[i].t.charCodeAt(0),s[i].v,u,C),s[i].t="t";break;case"n":case"?":for(N=i+1;s[N]!=null&&((o=s[N].t)==="?"||o==="D"||(o===" "||o==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[i].v+=s[N].v,s[N]={v:"",t:";"},++N;b+=s[i].v,i=N-1;break;case"G":s[i].t="t",s[i].v=h0(t,r);break}var E="",P,F;if(b.length>0){b.charCodeAt(0)==40?(P=t<0&&b.charCodeAt(0)===45?-t:t,F=Ku("n",b,P)):(P=t<0&&n>1?-t:t,F=Ku("n",b,P),P<0&&s[0]&&s[0].t=="t"&&(F=F.substr(1),s[0].v="-"+s[0].v)),N=F.length-1;var A=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){A=i;break}var j=s.length;if(A===s.length&&F.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(N>=s[i].v.length-1?(N-=s[i].v.length,s[i].v=F.substr(N+1,s[i].v.length)):N<0?s[i].v="":(s[i].v=F.substr(0,N+1),N=-1),s[i].t="t",j=i);N>=0&&j<s.length&&(s[j].v=F.substr(0,N+1)+s[j].v)}else if(A!==s.length&&F.indexOf("E")===-1){for(N=F.indexOf(".")-1,i=A;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===A?s[i].v.indexOf(".")-1:s[i].v.length-1,E=s[i].v.substr(d+1);d>=0;--d)N>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(E=F.charAt(N--)+E);s[i].v=E,s[i].t="t",j=i}for(N>=0&&j<s.length&&(s[j].v=F.substr(0,N+1)+s[j].v),N=F.indexOf(".")+1,i=A;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==A)){for(d=s[i].v.indexOf(".")>-1&&i===A?s[i].v.indexOf(".")+1:0,E=s[i].v.substr(0,d);d<s[i].v.length;++d)N<F.length&&(E+=F.charAt(N++));s[i].v=E,s[i].t="t",j=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(P=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=Ku(s[i].t,s[i].v,P),s[i].t="t");var I="";for(i=0;i!==s.length;++i)s[i]!=null&&(I+=s[i].v);return I}var MF=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function LF(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function zie(e,t){var r=$ie(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(MF),o=r[1].match(MF);return LF(t,i)?[n,r[0]]:LF(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function Al(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:jr)[e],n==null&&(n=r.table&&r.table[DF[e]]||jr[DF[e]]),n==null&&(n=kie[e]||"General");break}if(Bb(n,0))return h0(t,r);t instanceof Date&&(t=qB(t,r.date1904));var s=zie(n,t);if(Bb(s[1]))return h0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Uie(s[1],t,r,s[0])}function qu(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(jr[r]==null){t<0&&(t=r);continue}if(jr[r]==e){t=r;break}}t<0&&(t=391)}return jr[t]=e,t}function a2(e){for(var t=0;t!=392;++t)e[t]!==void 0&&qu(e[t],t)}function Zm(){jr=Sie()}var Wie={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},n$=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Hie(e){var t=typeof e=="number"?jr[e]:e;return t=t.replace(n$,"(\\d+)"),new RegExp("^"+t+"$")}function Gie(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,c=-1;(t.match(n$)||[]).forEach(function(h,g){var p=parseInt(r[g+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":c=p;break;case"m":i>=0?o=p:s=p;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var Vie=(function(){var e={};e.version="1.2.0";function t(){for(var F=0,A=new Array(256),j=0;j!=256;++j)F=j,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,A[j]=F;return typeof Int32Array<"u"?new Int32Array(A):A}var r=t();function n(F){var A=0,j=0,I=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)B[I]=F[I];for(I=0;I!=256;++I)for(j=F[I],A=256+I;A<4096;A+=256)j=B[A]=j>>>8^F[j&255];var Y=[];for(I=1;I!=16;++I)Y[I-1]=typeof Int32Array<"u"?B.subarray(I*256,I*256+256):B.slice(I*256,I*256+256);return Y}var s=n(r),a=s[0],i=s[1],o=s[2],c=s[3],u=s[4],d=s[5],h=s[6],g=s[7],p=s[8],x=s[9],v=s[10],w=s[11],C=s[12],k=s[13],b=s[14];function N(F,A){for(var j=A^-1,I=0,B=F.length;I<B;)j=j>>>8^r[(j^F.charCodeAt(I++))&255];return~j}function E(F,A){for(var j=A^-1,I=F.length-15,B=0;B<I;)j=b[F[B++]^j&255]^k[F[B++]^j>>8&255]^C[F[B++]^j>>16&255]^w[F[B++]^j>>>24]^v[F[B++]]^x[F[B++]]^p[F[B++]]^g[F[B++]]^h[F[B++]]^d[F[B++]]^u[F[B++]]^c[F[B++]]^o[F[B++]]^i[F[B++]]^a[F[B++]]^r[F[B++]];for(I+=15;B<I;)j=j>>>8^r[(j^F[B++])&255];return~j}function P(F,A){for(var j=A^-1,I=0,B=F.length,Y=0,Z=0;I<B;)Y=F.charCodeAt(I++),Y<128?j=j>>>8^r[(j^Y)&255]:Y<2048?(j=j>>>8^r[(j^(192|Y>>6&31))&255],j=j>>>8^r[(j^(128|Y&63))&255]):Y>=55296&&Y<57344?(Y=(Y&1023)+64,Z=F.charCodeAt(I++)&1023,j=j>>>8^r[(j^(240|Y>>8&7))&255],j=j>>>8^r[(j^(128|Y>>2&63))&255],j=j>>>8^r[(j^(128|Z>>6&15|(Y&3)<<4))&255],j=j>>>8^r[(j^(128|Z&63))&255]):(j=j>>>8^r[(j^(224|Y>>12&15))&255],j=j>>>8^r[(j^(128|Y>>6&63))&255],j=j>>>8^r[(j^(128|Y&63))&255]);return~j}return e.table=r,e.bstr=N,e.buf=E,e.str=P,e})(),Tr=(function(){var t={};t.version="1.2.1";function r(ue,we){for(var ye=ue.split("/"),xe=we.split("/"),be=0,_e=0,Ge=Math.min(ye.length,xe.length);be<Ge;++be){if(_e=ye[be].length-xe[be].length)return _e;if(ye[be]!=xe[be])return ye[be]<xe[be]?-1:1}return ye.length-xe.length}function n(ue){if(ue.charAt(ue.length-1)=="/")return ue.slice(0,-1).indexOf("/")===-1?ue:n(ue.slice(0,-1));var we=ue.lastIndexOf("/");return we===-1?ue:ue.slice(0,we+1)}function s(ue){if(ue.charAt(ue.length-1)=="/")return s(ue.slice(0,-1));var we=ue.lastIndexOf("/");return we===-1?ue:ue.slice(we+1)}function a(ue,we){typeof we=="string"&&(we=new Date(we));var ye=we.getHours();ye=ye<<6|we.getMinutes(),ye=ye<<5|we.getSeconds()>>>1,ue.write_shift(2,ye);var xe=we.getFullYear()-1980;xe=xe<<4|we.getMonth()+1,xe=xe<<5|we.getDate(),ue.write_shift(2,xe)}function i(ue){var we=ue.read_shift(2)&65535,ye=ue.read_shift(2)&65535,xe=new Date,be=ye&31;ye>>>=5;var _e=ye&15;ye>>>=4,xe.setMilliseconds(0),xe.setFullYear(ye+1980),xe.setMonth(_e-1),xe.setDate(be);var Ge=we&31;we>>>=5;var ut=we&63;return we>>>=6,xe.setHours(we),xe.setMinutes(ut),xe.setSeconds(Ge<<1),xe}function o(ue){oi(ue,0);for(var we={},ye=0;ue.l<=ue.length-4;){var xe=ue.read_shift(2),be=ue.read_shift(2),_e=ue.l+be,Ge={};switch(xe){case 21589:ye=ue.read_shift(1),ye&1&&(Ge.mtime=ue.read_shift(4)),be>5&&(ye&2&&(Ge.atime=ue.read_shift(4)),ye&4&&(Ge.ctime=ue.read_shift(4))),Ge.mtime&&(Ge.mt=new Date(Ge.mtime*1e3));break}ue.l=_e,we[xe]=Ge}return we}var c;function u(){return c||(c={})}function d(ue,we){if(ue[0]==80&&ue[1]==75)return me(ue,we);if((ue[0]|32)==109&&(ue[1]|32)==105)return Qe(ue,we);if(ue.length<512)throw new Error("CFB file size "+ue.length+" < 512");var ye=3,xe=512,be=0,_e=0,Ge=0,ut=0,qe=0,oe=[],he=ue.slice(0,512);oi(he,0);var Te=h(he);switch(ye=Te[0],ye){case 3:xe=512;break;case 4:xe=4096;break;case 0:if(Te[1]==0)return me(ue,we);default:throw new Error("Major Version: Expected 3 or 4 saw "+ye)}xe!==512&&(he=ue.slice(0,xe),oi(he,28));var Ce=ue.slice(0,xe);g(he,ye);var Ke=he.read_shift(4,"i");if(ye===3&&Ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ke);he.l+=4,Ge=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),ut=he.read_shift(4,"i"),be=he.read_shift(4,"i"),qe=he.read_shift(4,"i"),_e=he.read_shift(4,"i");for(var ot=-1,mt=0;mt<109&&(ot=he.read_shift(4,"i"),!(ot<0));++mt)oe[mt]=ot;var Wt=p(ue,xe);w(qe,_e,Wt,xe,oe);var pt=k(Wt,Ge,oe,xe);pt[Ge].name="!Directory",be>0&&ut!==Z&&(pt[ut].name="!MiniFAT"),pt[oe[0]].name="!FAT",pt.fat_addrs=oe,pt.ssz=xe;var Yt={},vr=[],_r=[],gr=[];b(Ge,pt,Wt,vr,be,Yt,_r,ut),x(_r,gr,vr),vr.shift();var Fr={FileIndex:_r,FullPaths:gr};return we&&we.raw&&(Fr.raw={header:Ce,sectors:Wt}),Fr}function h(ue){if(ue[ue.l]==80&&ue[ue.l+1]==75)return[0,0];ue.chk(ae,"Header Signature: "),ue.l+=16;var we=ue.read_shift(2,"u");return[ue.read_shift(2,"u"),we]}function g(ue,we){var ye=9;switch(ue.l+=2,ye=ue.read_shift(2)){case 9:if(we!=3)throw new Error("Sector Shift: Expected 9 saw "+ye);break;case 12:if(we!=4)throw new Error("Sector Shift: Expected 12 saw "+ye);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ye)}ue.chk("0600","Mini Sector Shift: "),ue.chk("000000000000","Reserved: ")}function p(ue,we){for(var ye=Math.ceil(ue.length/we)-1,xe=[],be=1;be<ye;++be)xe[be-1]=ue.slice(be*we,(be+1)*we);return xe[ye-1]=ue.slice(ye*we),xe}function x(ue,we,ye){for(var xe=0,be=0,_e=0,Ge=0,ut=0,qe=ye.length,oe=[],he=[];xe<qe;++xe)oe[xe]=he[xe]=xe,we[xe]=ye[xe];for(;ut<he.length;++ut)xe=he[ut],be=ue[xe].L,_e=ue[xe].R,Ge=ue[xe].C,oe[xe]===xe&&(be!==-1&&oe[be]!==be&&(oe[xe]=oe[be]),_e!==-1&&oe[_e]!==_e&&(oe[xe]=oe[_e])),Ge!==-1&&(oe[Ge]=xe),be!==-1&&xe!=oe[xe]&&(oe[be]=oe[xe],he.lastIndexOf(be)<ut&&he.push(be)),_e!==-1&&xe!=oe[xe]&&(oe[_e]=oe[xe],he.lastIndexOf(_e)<ut&&he.push(_e));for(xe=1;xe<qe;++xe)oe[xe]===xe&&(_e!==-1&&oe[_e]!==_e?oe[xe]=oe[_e]:be!==-1&&oe[be]!==be&&(oe[xe]=oe[be]));for(xe=1;xe<qe;++xe)if(ue[xe].type!==0){if(ut=xe,ut!=oe[ut])do ut=oe[ut],we[xe]=we[ut]+"/"+we[xe];while(ut!==0&&oe[ut]!==-1&&ut!=oe[ut]);oe[xe]=-1}for(we[0]+="/",xe=1;xe<qe;++xe)ue[xe].type!==2&&(we[xe]+="/")}function v(ue,we,ye){for(var xe=ue.start,be=ue.size,_e=[],Ge=xe;ye&&be>0&&Ge>=0;)_e.push(we.slice(Ge*Y,Ge*Y+Y)),be-=Y,Ge=jh(ye,Ge*4);return _e.length===0?_t(0):La(_e).slice(0,ue.size)}function w(ue,we,ye,xe,be){var _e=Z;if(ue===Z){if(we!==0)throw new Error("DIFAT chain shorter than expected")}else if(ue!==-1){var Ge=ye[ue],ut=(xe>>>2)-1;if(!Ge)return;for(var qe=0;qe<ut&&(_e=jh(Ge,qe*4))!==Z;++qe)be.push(_e);w(jh(Ge,xe-4),we-1,ye,xe,be)}}function C(ue,we,ye,xe,be){var _e=[],Ge=[];be||(be=[]);var ut=xe-1,qe=0,oe=0;for(qe=we;qe>=0;){be[qe]=!0,_e[_e.length]=qe,Ge.push(ue[qe]);var he=ye[Math.floor(qe*4/xe)];if(oe=qe*4&ut,xe<4+oe)throw new Error("FAT boundary crossed: "+qe+" 4 "+xe);if(!ue[he])break;qe=jh(ue[he],oe)}return{nodes:_e,data:XF([Ge])}}function k(ue,we,ye,xe){var be=ue.length,_e=[],Ge=[],ut=[],qe=[],oe=xe-1,he=0,Te=0,Ce=0,Ke=0;for(he=0;he<be;++he)if(ut=[],Ce=he+we,Ce>=be&&(Ce-=be),!Ge[Ce]){qe=[];var ot=[];for(Te=Ce;Te>=0;){ot[Te]=!0,Ge[Te]=!0,ut[ut.length]=Te,qe.push(ue[Te]);var mt=ye[Math.floor(Te*4/xe)];if(Ke=Te*4&oe,xe<4+Ke)throw new Error("FAT boundary crossed: "+Te+" 4 "+xe);if(!ue[mt]||(Te=jh(ue[mt],Ke),ot[Te]))break}_e[Ce]={nodes:ut,data:XF([qe])}}return _e}function b(ue,we,ye,xe,be,_e,Ge,ut){for(var qe=0,oe=xe.length?2:0,he=we[ue].data,Te=0,Ce=0,Ke;Te<he.length;Te+=128){var ot=he.slice(Te,Te+128);oi(ot,64),Ce=ot.read_shift(2),Ke=l3(ot,0,Ce-oe),xe.push(Ke);var mt={name:Ke,type:ot.read_shift(1),color:ot.read_shift(1),L:ot.read_shift(4,"i"),R:ot.read_shift(4,"i"),C:ot.read_shift(4,"i"),clsid:ot.read_shift(16),state:ot.read_shift(4,"i"),start:0,size:0},Wt=ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2);Wt!==0&&(mt.ct=N(ot,ot.l-8));var pt=ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2);pt!==0&&(mt.mt=N(ot,ot.l-8)),mt.start=ot.read_shift(4,"i"),mt.size=ot.read_shift(4,"i"),mt.size<0&&mt.start<0&&(mt.size=mt.type=0,mt.start=Z,mt.name=""),mt.type===5?(qe=mt.start,be>0&&qe!==Z&&(we[qe].name="!StreamData")):mt.size>=4096?(mt.storage="fat",we[mt.start]===void 0&&(we[mt.start]=C(ye,mt.start,we.fat_addrs,we.ssz)),we[mt.start].name=mt.name,mt.content=we[mt.start].data.slice(0,mt.size)):(mt.storage="minifat",mt.size<0?mt.size=0:qe!==Z&&mt.start!==Z&&we[qe]&&(mt.content=v(mt,we[qe].data,(we[ut]||{}).data))),mt.content&&oi(mt.content,0),_e[Ke]=mt,Ge.push(mt)}}function N(ue,we){return new Date((zo(ue,we+4)/1e7*Math.pow(2,32)+zo(ue,we)/1e7-11644473600)*1e3)}function E(ue,we){return u(),d(c.readFileSync(ue),we)}function P(ue,we){var ye=we&&we.type;switch(ye||en&&Buffer.isBuffer(ue)&&(ye="buffer"),ye||"base64"){case"file":return E(ue,we);case"base64":return d(Ho(Yo(ue)),we);case"binary":return d(Ho(ue),we)}return d(ue,we)}function F(ue,we){var ye=we||{},xe=ye.root||"Root Entry";if(ue.FullPaths||(ue.FullPaths=[]),ue.FileIndex||(ue.FileIndex=[]),ue.FullPaths.length!==ue.FileIndex.length)throw new Error("inconsistent CFB structure");ue.FullPaths.length===0&&(ue.FullPaths[0]=xe+"/",ue.FileIndex[0]={name:xe,type:5}),ye.CLSID&&(ue.FileIndex[0].clsid=ye.CLSID),A(ue)}function A(ue){var we="Sh33tJ5";if(!Tr.find(ue,"/"+we)){var ye=_t(4);ye[0]=55,ye[1]=ye[3]=50,ye[2]=54,ue.FileIndex.push({name:we,type:2,content:ye,size:4,L:69,R:69,C:69}),ue.FullPaths.push(ue.FullPaths[0]+we),j(ue)}}function j(ue,we){F(ue);for(var ye=!1,xe=!1,be=ue.FullPaths.length-1;be>=0;--be){var _e=ue.FileIndex[be];switch(_e.type){case 0:xe?ye=!0:(ue.FileIndex.pop(),ue.FullPaths.pop());break;case 1:case 2:case 5:xe=!0,isNaN(_e.R*_e.L*_e.C)&&(ye=!0),_e.R>-1&&_e.L>-1&&_e.R==_e.L&&(ye=!0);break;default:ye=!0;break}}if(!(!ye&&!we)){var Ge=new Date(1987,1,19),ut=0,qe=Object.create?Object.create(null):{},oe=[];for(be=0;be<ue.FullPaths.length;++be)qe[ue.FullPaths[be]]=!0,ue.FileIndex[be].type!==0&&oe.push([ue.FullPaths[be],ue.FileIndex[be]]);for(be=0;be<oe.length;++be){var he=n(oe[be][0]);xe=qe[he],xe||(oe.push([he,{name:s(he).replace("/",""),type:1,clsid:ne,ct:Ge,mt:Ge,content:null}]),qe[he]=!0)}for(oe.sort(function(Ke,ot){return r(Ke[0],ot[0])}),ue.FullPaths=[],ue.FileIndex=[],be=0;be<oe.length;++be)ue.FullPaths[be]=oe[be][0],ue.FileIndex[be]=oe[be][1];for(be=0;be<oe.length;++be){var Te=ue.FileIndex[be],Ce=ue.FullPaths[be];if(Te.name=s(Ce).replace("/",""),Te.L=Te.R=Te.C=-(Te.color=1),Te.size=Te.content?Te.content.length:0,Te.start=0,Te.clsid=Te.clsid||ne,be===0)Te.C=oe.length>1?1:-1,Te.size=0,Te.type=5;else if(Ce.slice(-1)=="/"){for(ut=be+1;ut<oe.length&&n(ue.FullPaths[ut])!=Ce;++ut);for(Te.C=ut>=oe.length?-1:ut,ut=be+1;ut<oe.length&&n(ue.FullPaths[ut])!=n(Ce);++ut);Te.R=ut>=oe.length?-1:ut,Te.type=1}else n(ue.FullPaths[be+1]||"")==n(Ce)&&(Te.R=be+1),Te.type=2}}}function I(ue,we){var ye=we||{};if(ye.fileType=="mad")return Pt(ue,ye);switch(j(ue),ye.fileType){case"zip":return Pe(ue,ye)}var xe=(function(Ke){for(var ot=0,mt=0,Wt=0;Wt<Ke.FileIndex.length;++Wt){var pt=Ke.FileIndex[Wt];if(pt.content){var Yt=pt.content.length;Yt>0&&(Yt<4096?ot+=Yt+63>>6:mt+=Yt+511>>9)}}for(var vr=Ke.FullPaths.length+3>>2,_r=ot+7>>3,gr=ot+127>>7,Fr=_r+mt+vr+gr,rn=Fr+127>>7,Qr=rn<=109?0:Math.ceil((rn-109)/127);Fr+rn+Qr+127>>7>rn;)Qr=++rn<=109?0:Math.ceil((rn-109)/127);var fe=[1,Qr,rn,gr,vr,mt,ot,0];return Ke.FileIndex[0].size=ot<<6,fe[7]=(Ke.FileIndex[0].start=fe[0]+fe[1]+fe[2]+fe[3]+fe[4]+fe[5])+(fe[6]+7>>3),fe})(ue),be=_t(xe[7]<<9),_e=0,Ge=0;{for(_e=0;_e<8;++_e)be.write_shift(1,ee[_e]);for(_e=0;_e<8;++_e)be.write_shift(2,0);for(be.write_shift(2,62),be.write_shift(2,3),be.write_shift(2,65534),be.write_shift(2,9),be.write_shift(2,6),_e=0;_e<3;++_e)be.write_shift(2,0);for(be.write_shift(4,0),be.write_shift(4,xe[2]),be.write_shift(4,xe[0]+xe[1]+xe[2]+xe[3]-1),be.write_shift(4,0),be.write_shift(4,4096),be.write_shift(4,xe[3]?xe[0]+xe[1]+xe[2]-1:Z),be.write_shift(4,xe[3]),be.write_shift(-4,xe[1]?xe[0]-1:Z),be.write_shift(4,xe[1]),_e=0;_e<109;++_e)be.write_shift(-4,_e<xe[2]?xe[1]+_e:-1)}if(xe[1])for(Ge=0;Ge<xe[1];++Ge){for(;_e<236+Ge*127;++_e)be.write_shift(-4,_e<xe[2]?xe[1]+_e:-1);be.write_shift(-4,Ge===xe[1]-1?Z:Ge+1)}var ut=function(Ke){for(Ge+=Ke;_e<Ge-1;++_e)be.write_shift(-4,_e+1);Ke&&(++_e,be.write_shift(-4,Z))};for(Ge=_e=0,Ge+=xe[1];_e<Ge;++_e)be.write_shift(-4,L.DIFSECT);for(Ge+=xe[2];_e<Ge;++_e)be.write_shift(-4,L.FATSECT);ut(xe[3]),ut(xe[4]);for(var qe=0,oe=0,he=ue.FileIndex[0];qe<ue.FileIndex.length;++qe)he=ue.FileIndex[qe],he.content&&(oe=he.content.length,!(oe<4096)&&(he.start=Ge,ut(oe+511>>9)));for(ut(xe[6]+7>>3);be.l&511;)be.write_shift(-4,L.ENDOFCHAIN);for(Ge=_e=0,qe=0;qe<ue.FileIndex.length;++qe)he=ue.FileIndex[qe],he.content&&(oe=he.content.length,!(!oe||oe>=4096)&&(he.start=Ge,ut(oe+63>>6)));for(;be.l&511;)be.write_shift(-4,L.ENDOFCHAIN);for(_e=0;_e<xe[4]<<2;++_e){var Te=ue.FullPaths[_e];if(!Te||Te.length===0){for(qe=0;qe<17;++qe)be.write_shift(4,0);for(qe=0;qe<3;++qe)be.write_shift(4,-1);for(qe=0;qe<12;++qe)be.write_shift(4,0);continue}he=ue.FileIndex[_e],_e===0&&(he.start=he.size?he.start-1:Z);var Ce=_e===0&&ye.root||he.name;if(oe=2*(Ce.length+1),be.write_shift(64,Ce,"utf16le"),be.write_shift(2,oe),be.write_shift(1,he.type),be.write_shift(1,he.color),be.write_shift(-4,he.L),be.write_shift(-4,he.R),be.write_shift(-4,he.C),he.clsid)be.write_shift(16,he.clsid,"hex");else for(qe=0;qe<4;++qe)be.write_shift(4,0);be.write_shift(4,he.state||0),be.write_shift(4,0),be.write_shift(4,0),be.write_shift(4,0),be.write_shift(4,0),be.write_shift(4,he.start),be.write_shift(4,he.size),be.write_shift(4,0)}for(_e=1;_e<ue.FileIndex.length;++_e)if(he=ue.FileIndex[_e],he.size>=4096)if(be.l=he.start+1<<9,en&&Buffer.isBuffer(he.content))he.content.copy(be,be.l,0,he.size),be.l+=he.size+511&-512;else{for(qe=0;qe<he.size;++qe)be.write_shift(1,he.content[qe]);for(;qe&511;++qe)be.write_shift(1,0)}for(_e=1;_e<ue.FileIndex.length;++_e)if(he=ue.FileIndex[_e],he.size>0&&he.size<4096)if(en&&Buffer.isBuffer(he.content))he.content.copy(be,be.l,0,he.size),be.l+=he.size+63&-64;else{for(qe=0;qe<he.size;++qe)be.write_shift(1,he.content[qe]);for(;qe&63;++qe)be.write_shift(1,0)}if(en)be.l=be.length;else for(;be.l<be.length;)be.write_shift(1,0);return be}function B(ue,we){var ye=ue.FullPaths.map(function(qe){return qe.toUpperCase()}),xe=ye.map(function(qe){var oe=qe.split("/");return oe[oe.length-(qe.slice(-1)=="/"?2:1)]}),be=!1;we.charCodeAt(0)===47?(be=!0,we=ye[0].slice(0,-1)+we):be=we.indexOf("/")!==-1;var _e=we.toUpperCase(),Ge=be===!0?ye.indexOf(_e):xe.indexOf(_e);if(Ge!==-1)return ue.FileIndex[Ge];var ut=!_e.match(uy);for(_e=_e.replace(no,""),ut&&(_e=_e.replace(uy,"!")),Ge=0;Ge<ye.length;++Ge)if((ut?ye[Ge].replace(uy,"!"):ye[Ge]).replace(no,"")==_e||(ut?xe[Ge].replace(uy,"!"):xe[Ge]).replace(no,"")==_e)return ue.FileIndex[Ge];return null}var Y=64,Z=-2,ae="d0cf11e0a1b11ae1",ee=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",L={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Z,FREESECT:-1,HEADER_SIGNATURE:ae,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function H(ue,we,ye){u();var xe=I(ue,ye);c.writeFileSync(we,xe)}function M(ue){for(var we=new Array(ue.length),ye=0;ye<ue.length;++ye)we[ye]=String.fromCharCode(ue[ye]);return we.join("")}function V(ue,we){var ye=I(ue,we);switch(we&&we.type||"buffer"){case"file":return u(),c.writeFileSync(we.filename,ye),ye;case"binary":return typeof ye=="string"?ye:M(ye);case"base64":return Zy(typeof ye=="string"?ye:M(ye));case"buffer":if(en)return Buffer.isBuffer(ye)?ye:ud(ye);case"array":return typeof ye=="string"?Ho(ye):ye}return ye}var W;function R(ue){try{var we=ue.InflateRaw,ye=new we;if(ye._processChunk(new Uint8Array([3,0]),ye._finishFlushFlag),ye.bytesRead)W=ue;else throw new Error("zlib does not expose bytesRead")}catch(xe){console.error("cannot use native zlib: "+(xe.message||xe))}}function U(ue,we){if(!W)return ur(ue,we);var ye=W.InflateRaw,xe=new ye,be=xe._processChunk(ue.slice(ue.l),xe._finishFlushFlag);return ue.l+=xe.bytesRead,be}function q(ue){return W?W.deflateRawSync(ue):Ue(ue)}var Q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],X=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(ue){var we=(ue<<1|ue<<11)&139536|(ue<<5|ue<<15)&558144;return(we>>16|we>>8|we)&255}for(var le=typeof Uint8Array<"u",ce=le?new Uint8Array(256):[],Se=0;Se<256;++Se)ce[Se]=ie(Se);function re(ue,we){var ye=ce[ue&255];return we<=8?ye>>>8-we:(ye=ye<<8|ce[ue>>8&255],we<=16?ye>>>16-we:(ye=ye<<8|ce[ue>>16&255],ye>>>24-we))}function ge(ue,we){var ye=we&7,xe=we>>>3;return(ue[xe]|(ye<=6?0:ue[xe+1]<<8))>>>ye&3}function Ee(ue,we){var ye=we&7,xe=we>>>3;return(ue[xe]|(ye<=5?0:ue[xe+1]<<8))>>>ye&7}function Ae(ue,we){var ye=we&7,xe=we>>>3;return(ue[xe]|(ye<=4?0:ue[xe+1]<<8))>>>ye&15}function He(ue,we){var ye=we&7,xe=we>>>3;return(ue[xe]|(ye<=3?0:ue[xe+1]<<8))>>>ye&31}function Be(ue,we){var ye=we&7,xe=we>>>3;return(ue[xe]|(ye<=1?0:ue[xe+1]<<8))>>>ye&127}function Rt(ue,we,ye){var xe=we&7,be=we>>>3,_e=(1<<ye)-1,Ge=ue[be]>>>xe;return ye<8-xe||(Ge|=ue[be+1]<<8-xe,ye<16-xe)||(Ge|=ue[be+2]<<16-xe,ye<24-xe)||(Ge|=ue[be+3]<<24-xe),Ge&_e}function et(ue,we,ye){var xe=we&7,be=we>>>3;return xe<=5?ue[be]|=(ye&7)<<xe:(ue[be]|=ye<<xe&255,ue[be+1]=(ye&7)>>8-xe),we+3}function vt(ue,we,ye){var xe=we&7,be=we>>>3;return ye=(ye&1)<<xe,ue[be]|=ye,we+1}function xt(ue,we,ye){var xe=we&7,be=we>>>3;return ye<<=xe,ue[be]|=ye&255,ye>>>=8,ue[be+1]=ye,we+8}function it(ue,we,ye){var xe=we&7,be=we>>>3;return ye<<=xe,ue[be]|=ye&255,ye>>>=8,ue[be+1]=ye&255,ue[be+2]=ye>>>8,we+16}function ht(ue,we){var ye=ue.length,xe=2*ye>we?2*ye:we+5,be=0;if(ye>=we)return ue;if(en){var _e=PF(xe);if(ue.copy)ue.copy(_e);else for(;be<ue.length;++be)_e[be]=ue[be];return _e}else if(le){var Ge=new Uint8Array(xe);if(Ge.set)Ge.set(ue);else for(;be<ye;++be)Ge[be]=ue[be];return Ge}return ue.length=xe,ue}function Dt(ue){for(var we=new Array(ue),ye=0;ye<ue;++ye)we[ye]=0;return we}function Mt(ue,we,ye){var xe=1,be=0,_e=0,Ge=0,ut=0,qe=ue.length,oe=le?new Uint16Array(32):Dt(32);for(_e=0;_e<32;++_e)oe[_e]=0;for(_e=qe;_e<ye;++_e)ue[_e]=0;qe=ue.length;var he=le?new Uint16Array(qe):Dt(qe);for(_e=0;_e<qe;++_e)oe[be=ue[_e]]++,xe<be&&(xe=be),he[_e]=0;for(oe[0]=0,_e=1;_e<=xe;++_e)oe[_e+16]=ut=ut+oe[_e-1]<<1;for(_e=0;_e<qe;++_e)ut=ue[_e],ut!=0&&(he[_e]=oe[ut+16]++);var Te=0;for(_e=0;_e<qe;++_e)if(Te=ue[_e],Te!=0)for(ut=re(he[_e],xe)>>xe-Te,Ge=(1<<xe+4-Te)-1;Ge>=0;--Ge)we[ut|Ge<<Te]=Te&15|_e<<4;return xe}var Xe=le?new Uint16Array(512):Dt(512),De=le?new Uint16Array(32):Dt(32);if(!le){for(var Le=0;Le<512;++Le)Xe[Le]=0;for(Le=0;Le<32;++Le)De[Le]=0}(function(){for(var ue=[],we=0;we<32;we++)ue.push(5);Mt(ue,De,32);var ye=[];for(we=0;we<=143;we++)ye.push(8);for(;we<=255;we++)ye.push(9);for(;we<=279;we++)ye.push(7);for(;we<=287;we++)ye.push(8);Mt(ye,Xe,288)})();var lt=(function(){for(var we=le?new Uint8Array(32768):[],ye=0,xe=0;ye<X.length-1;++ye)for(;xe<X[ye+1];++xe)we[xe]=ye;for(;xe<32768;++xe)we[xe]=29;var be=le?new Uint8Array(259):[];for(ye=0,xe=0;ye<se.length-1;++ye)for(;xe<se[ye+1];++xe)be[xe]=ye;function _e(ut,qe){for(var oe=0;oe<ut.length;){var he=Math.min(65535,ut.length-oe),Te=oe+he==ut.length;for(qe.write_shift(1,+Te),qe.write_shift(2,he),qe.write_shift(2,~he&65535);he-- >0;)qe[qe.l++]=ut[oe++]}return qe.l}function Ge(ut,qe){for(var oe=0,he=0,Te=le?new Uint16Array(32768):[];he<ut.length;){var Ce=Math.min(65535,ut.length-he);if(Ce<10){for(oe=et(qe,oe,+(he+Ce==ut.length)),oe&7&&(oe+=8-(oe&7)),qe.l=oe/8|0,qe.write_shift(2,Ce),qe.write_shift(2,~Ce&65535);Ce-- >0;)qe[qe.l++]=ut[he++];oe=qe.l*8;continue}oe=et(qe,oe,+(he+Ce==ut.length)+2);for(var Ke=0;Ce-- >0;){var ot=ut[he];Ke=(Ke<<5^ot)&32767;var mt=-1,Wt=0;if((mt=Te[Ke])&&(mt|=he&-32768,mt>he&&(mt-=32768),mt<he))for(;ut[mt+Wt]==ut[he+Wt]&&Wt<250;)++Wt;if(Wt>2){ot=be[Wt],ot<=22?oe=xt(qe,oe,ce[ot+1]>>1)-1:(xt(qe,oe,3),oe+=5,xt(qe,oe,ce[ot-23]>>5),oe+=3);var pt=ot<8?0:ot-4>>2;pt>0&&(it(qe,oe,Wt-se[ot]),oe+=pt),ot=we[he-mt],oe=xt(qe,oe,ce[ot]>>3),oe-=3;var Yt=ot<4?0:ot-2>>1;Yt>0&&(it(qe,oe,he-mt-X[ot]),oe+=Yt);for(var vr=0;vr<Wt;++vr)Te[Ke]=he&32767,Ke=(Ke<<5^ut[he])&32767,++he;Ce-=Wt-1}else ot<=143?ot=ot+48:oe=vt(qe,oe,1),oe=xt(qe,oe,ce[ot]),Te[Ke]=he&32767,++he}oe=xt(qe,oe,0)-1}return qe.l=(oe+7)/8|0,qe.l}return function(qe,oe){return qe.length<8?_e(qe,oe):Ge(qe,oe)}})();function Ue(ue){var we=_t(50+Math.floor(ue.length*1.1)),ye=lt(ue,we);return we.slice(0,ye)}var tt=le?new Uint16Array(32768):Dt(32768),Et=le?new Uint16Array(32768):Dt(32768),At=le?new Uint16Array(128):Dt(128),qt=1,pr=1;function Rr(ue,we){var ye=He(ue,we)+257;we+=5;var xe=He(ue,we)+1;we+=5;var be=Ae(ue,we)+4;we+=4;for(var _e=0,Ge=le?new Uint8Array(19):Dt(19),ut=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],qe=1,oe=le?new Uint8Array(8):Dt(8),he=le?new Uint8Array(8):Dt(8),Te=Ge.length,Ce=0;Ce<be;++Ce)Ge[Q[Ce]]=_e=Ee(ue,we),qe<_e&&(qe=_e),oe[_e]++,we+=3;var Ke=0;for(oe[0]=0,Ce=1;Ce<=qe;++Ce)he[Ce]=Ke=Ke+oe[Ce-1]<<1;for(Ce=0;Ce<Te;++Ce)(Ke=Ge[Ce])!=0&&(ut[Ce]=he[Ke]++);var ot=0;for(Ce=0;Ce<Te;++Ce)if(ot=Ge[Ce],ot!=0){Ke=ce[ut[Ce]]>>8-ot;for(var mt=(1<<7-ot)-1;mt>=0;--mt)At[Ke|mt<<ot]=ot&7|Ce<<3}var Wt=[];for(qe=1;Wt.length<ye+xe;)switch(Ke=At[Be(ue,we)],we+=Ke&7,Ke>>>=3){case 16:for(_e=3+ge(ue,we),we+=2,Ke=Wt[Wt.length-1];_e-- >0;)Wt.push(Ke);break;case 17:for(_e=3+Ee(ue,we),we+=3;_e-- >0;)Wt.push(0);break;case 18:for(_e=11+Be(ue,we),we+=7;_e-- >0;)Wt.push(0);break;default:Wt.push(Ke),qe<Ke&&(qe=Ke);break}var pt=Wt.slice(0,ye),Yt=Wt.slice(ye);for(Ce=ye;Ce<286;++Ce)pt[Ce]=0;for(Ce=xe;Ce<30;++Ce)Yt[Ce]=0;return qt=Mt(pt,tt,286),pr=Mt(Yt,Et,30),we}function Kr(ue,we){if(ue[0]==3&&!(ue[1]&3))return[Tf(we),2];for(var ye=0,xe=0,be=PF(we||1<<18),_e=0,Ge=be.length>>>0,ut=0,qe=0;(xe&1)==0;){if(xe=Ee(ue,ye),ye+=3,xe>>>1)xe>>1==1?(ut=9,qe=5):(ye=Rr(ue,ye),ut=qt,qe=pr);else{ye&7&&(ye+=8-(ye&7));var oe=ue[ye>>>3]|ue[(ye>>>3)+1]<<8;if(ye+=32,oe>0)for(!we&&Ge<_e+oe&&(be=ht(be,_e+oe),Ge=be.length);oe-- >0;)be[_e++]=ue[ye>>>3],ye+=8;continue}for(;;){!we&&Ge<_e+32767&&(be=ht(be,_e+32767),Ge=be.length);var he=Rt(ue,ye,ut),Te=xe>>>1==1?Xe[he]:tt[he];if(ye+=Te&15,Te>>>=4,(Te>>>8&255)===0)be[_e++]=Te;else{if(Te==256)break;Te-=257;var Ce=Te<8?0:Te-4>>2;Ce>5&&(Ce=0);var Ke=_e+se[Te];Ce>0&&(Ke+=Rt(ue,ye,Ce),ye+=Ce),he=Rt(ue,ye,qe),Te=xe>>>1==1?De[he]:Et[he],ye+=Te&15,Te>>>=4;var ot=Te<4?0:Te-2>>1,mt=X[Te];for(ot>0&&(mt+=Rt(ue,ye,ot),ye+=ot),!we&&Ge<Ke&&(be=ht(be,Ke+100),Ge=be.length);_e<Ke;)be[_e]=be[_e-mt],++_e}}}return we?[be,ye+7>>>3]:[be.slice(0,_e),ye+7>>>3]}function ur(ue,we){var ye=ue.slice(ue.l||0),xe=Kr(ye,we);return ue.l+=xe[1],xe[0]}function ir(ue,we){if(ue)typeof console<"u"&&console.error(we);else throw new Error(we)}function me(ue,we){var ye=ue;oi(ye,0);var xe=[],be=[],_e={FileIndex:xe,FullPaths:be};F(_e,{root:we.root});for(var Ge=ye.length-4;(ye[Ge]!=80||ye[Ge+1]!=75||ye[Ge+2]!=5||ye[Ge+3]!=6)&&Ge>=0;)--Ge;ye.l=Ge+4,ye.l+=4;var ut=ye.read_shift(2);ye.l+=6;var qe=ye.read_shift(4);for(ye.l=qe,Ge=0;Ge<ut;++Ge){ye.l+=20;var oe=ye.read_shift(4),he=ye.read_shift(4),Te=ye.read_shift(2),Ce=ye.read_shift(2),Ke=ye.read_shift(2);ye.l+=8;var ot=ye.read_shift(4),mt=o(ye.slice(ye.l+Te,ye.l+Te+Ce));ye.l+=Te+Ce+Ke;var Wt=ye.l;ye.l=ot+4,Ne(ye,oe,he,_e,mt),ye.l=Wt}return _e}function Ne(ue,we,ye,xe,be){ue.l+=2;var _e=ue.read_shift(2),Ge=ue.read_shift(2),ut=i(ue);if(_e&8257)throw new Error("Unsupported ZIP encryption");for(var qe=ue.read_shift(4),oe=ue.read_shift(4),he=ue.read_shift(4),Te=ue.read_shift(2),Ce=ue.read_shift(2),Ke="",ot=0;ot<Te;++ot)Ke+=String.fromCharCode(ue[ue.l++]);if(Ce){var mt=o(ue.slice(ue.l,ue.l+Ce));(mt[21589]||{}).mt&&(ut=mt[21589].mt),((be||{})[21589]||{}).mt&&(ut=be[21589].mt)}ue.l+=Ce;var Wt=ue.slice(ue.l,ue.l+oe);switch(Ge){case 8:Wt=U(ue,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ge)}var pt=!1;_e&8&&(qe=ue.read_shift(4),qe==134695760&&(qe=ue.read_shift(4),pt=!0),oe=ue.read_shift(4),he=ue.read_shift(4)),oe!=we&&ir(pt,"Bad compressed size: "+we+" != "+oe),he!=ye&&ir(pt,"Bad uncompressed size: "+ye+" != "+he),rr(xe,Ke,Wt,{unsafe:!0,mt:ut})}function Pe(ue,we){var ye=we||{},xe=[],be=[],_e=_t(1),Ge=ye.compression?8:0,ut=0,qe=0,oe=0,he=0,Te=0,Ce=ue.FullPaths[0],Ke=Ce,ot=ue.FileIndex[0],mt=[],Wt=0;for(qe=1;qe<ue.FullPaths.length;++qe)if(Ke=ue.FullPaths[qe].slice(Ce.length),ot=ue.FileIndex[qe],!(!ot.size||!ot.content||Ke=="Sh33tJ5")){var pt=he,Yt=_t(Ke.length);for(oe=0;oe<Ke.length;++oe)Yt.write_shift(1,Ke.charCodeAt(oe)&127);Yt=Yt.slice(0,Yt.l),mt[Te]=Vie.buf(ot.content,0);var vr=ot.content;Ge==8&&(vr=q(vr)),_e=_t(30),_e.write_shift(4,67324752),_e.write_shift(2,20),_e.write_shift(2,ut),_e.write_shift(2,Ge),ot.mt?a(_e,ot.mt):_e.write_shift(4,0),_e.write_shift(-4,mt[Te]),_e.write_shift(4,vr.length),_e.write_shift(4,ot.content.length),_e.write_shift(2,Yt.length),_e.write_shift(2,0),he+=_e.length,xe.push(_e),he+=Yt.length,xe.push(Yt),he+=vr.length,xe.push(vr),_e=_t(46),_e.write_shift(4,33639248),_e.write_shift(2,0),_e.write_shift(2,20),_e.write_shift(2,ut),_e.write_shift(2,Ge),_e.write_shift(4,0),_e.write_shift(-4,mt[Te]),_e.write_shift(4,vr.length),_e.write_shift(4,ot.content.length),_e.write_shift(2,Yt.length),_e.write_shift(2,0),_e.write_shift(2,0),_e.write_shift(2,0),_e.write_shift(2,0),_e.write_shift(4,0),_e.write_shift(4,pt),Wt+=_e.l,be.push(_e),Wt+=Yt.length,be.push(Yt),++Te}return _e=_t(22),_e.write_shift(4,101010256),_e.write_shift(2,0),_e.write_shift(2,0),_e.write_shift(2,Te),_e.write_shift(2,Te),_e.write_shift(4,Wt),_e.write_shift(4,he),_e.write_shift(2,0),La([La(xe),La(be),_e])}var Re={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ct(ue,we){if(ue.ctype)return ue.ctype;var ye=ue.name||"",xe=ye.match(/\.([^\.]+)$/);return xe&&Re[xe[1]]||we&&(xe=(ye=we).match(/[\.\\]([^\.\\])+$/),xe&&Re[xe[1]])?Re[xe[1]]:"application/octet-stream"}function Fe(ue){for(var we=Zy(ue),ye=[],xe=0;xe<we.length;xe+=76)ye.push(we.slice(xe,xe+76));return ye.join(`\r
`)+`\r
`}function st(ue){var we=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var he=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});we=we.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),we.charAt(0)==`
`&&(we="=0D"+we.slice(1)),we=we.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ye=[],xe=we.split(`\r
`),be=0;be<xe.length;++be){var _e=xe[be];if(_e.length==0){ye.push("");continue}for(var Ge=0;Ge<_e.length;){var ut=76,qe=_e.slice(Ge,Ge+ut);qe.charAt(ut-1)=="="?ut--:qe.charAt(ut-2)=="="?ut-=2:qe.charAt(ut-3)=="="&&(ut-=3),qe=_e.slice(Ge,Ge+ut),Ge+=ut,Ge<_e.length&&(qe+="="),ye.push(qe)}}return ye.join(`\r
`)}function ke(ue){for(var we=[],ye=0;ye<ue.length;++ye){for(var xe=ue[ye];ye<=ue.length&&xe.charAt(xe.length-1)=="=";)xe=xe.slice(0,xe.length-1)+ue[++ye];we.push(xe)}for(var be=0;be<we.length;++be)we[be]=we[be].replace(/[=][0-9A-Fa-f]{2}/g,function(_e){return String.fromCharCode(parseInt(_e.slice(1),16))});return Ho(we.join(`\r
`))}function We(ue,we,ye){for(var xe="",be="",_e="",Ge,ut=0;ut<10;++ut){var qe=we[ut];if(!qe||qe.match(/^\s*$/))break;var oe=qe.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":xe=oe[2].trim();break;case"content-type":_e=oe[2].trim();break;case"content-transfer-encoding":be=oe[2].trim();break}}switch(++ut,be.toLowerCase()){case"base64":Ge=Ho(Yo(we.slice(ut).join("")));break;case"quoted-printable":Ge=ke(we.slice(ut));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+be)}var he=rr(ue,xe.slice(ye.length),Ge,{unsafe:!0});_e&&(he.ctype=_e)}function Qe(ue,we){if(M(ue.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ye=we&&we.root||"",xe=(en&&Buffer.isBuffer(ue)?ue.toString("binary"):M(ue)).split(`\r
`),be=0,_e="";for(be=0;be<xe.length;++be)if(_e=xe[be],!!/^Content-Location:/i.test(_e)&&(_e=_e.slice(_e.indexOf("file")),ye||(ye=_e.slice(0,_e.lastIndexOf("/")+1)),_e.slice(0,ye.length)!=ye))for(;ye.length>0&&(ye=ye.slice(0,ye.length-1),ye=ye.slice(0,ye.lastIndexOf("/")+1),_e.slice(0,ye.length)!=ye););var Ge=(xe[1]||"").match(/boundary="(.*?)"/);if(!Ge)throw new Error("MAD cannot find boundary");var ut="--"+(Ge[1]||""),qe=[],oe=[],he={FileIndex:qe,FullPaths:oe};F(he);var Te,Ce=0;for(be=0;be<xe.length;++be){var Ke=xe[be];Ke!==ut&&Ke!==ut+"--"||(Ce++&&We(he,xe.slice(Te,be),ye),Te=be)}return he}function Pt(ue,we){var ye=we||{},xe=ye.boundary||"SheetJS";xe="------="+xe;for(var be=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+xe.slice(2)+'"',"","",""],_e=ue.FullPaths[0],Ge=_e,ut=ue.FileIndex[0],qe=1;qe<ue.FullPaths.length;++qe)if(Ge=ue.FullPaths[qe].slice(_e.length),ut=ue.FileIndex[qe],!(!ut.size||!ut.content||Ge=="Sh33tJ5")){Ge=Ge.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Wt){return"_x"+Wt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Wt){return"_u"+Wt.charCodeAt(0).toString(16)+"_"});for(var oe=ut.content,he=en&&Buffer.isBuffer(oe)?oe.toString("binary"):M(oe),Te=0,Ce=Math.min(1024,he.length),Ke=0,ot=0;ot<=Ce;++ot)(Ke=he.charCodeAt(ot))>=32&&Ke<128&&++Te;var mt=Te>=Ce*4/5;be.push(xe),be.push("Content-Location: "+(ye.root||"file:///C:/SheetJS/")+Ge),be.push("Content-Transfer-Encoding: "+(mt?"quoted-printable":"base64")),be.push("Content-Type: "+Ct(ut,Ge)),be.push(""),be.push(mt?st(he):Fe(he))}return be.push(xe+`--\r
`),be.join(`\r
`)}function zt(ue){var we={};return F(we,ue),we}function rr(ue,we,ye,xe){var be=xe&&xe.unsafe;be||F(ue);var _e=!be&&Tr.find(ue,we);if(!_e){var Ge=ue.FullPaths[0];we.slice(0,Ge.length)==Ge?Ge=we:(Ge.slice(-1)!="/"&&(Ge+="/"),Ge=(Ge+we).replace("//","/")),_e={name:s(we),type:2},ue.FileIndex.push(_e),ue.FullPaths.push(Ge),be||Tr.utils.cfb_gc(ue)}return _e.content=ye,_e.size=ye?ye.length:0,xe&&(xe.CLSID&&(_e.clsid=xe.CLSID),xe.mt&&(_e.mt=xe.mt),xe.ct&&(_e.ct=xe.ct)),_e}function xr(ue,we){F(ue);var ye=Tr.find(ue,we);if(ye){for(var xe=0;xe<ue.FileIndex.length;++xe)if(ue.FileIndex[xe]==ye)return ue.FileIndex.splice(xe,1),ue.FullPaths.splice(xe,1),!0}return!1}function cr(ue,we,ye){F(ue);var xe=Tr.find(ue,we);if(xe){for(var be=0;be<ue.FileIndex.length;++be)if(ue.FileIndex[be]==xe)return ue.FileIndex[be].name=s(ye),ue.FullPaths[be]=ye,!0}return!1}function qr(ue){j(ue,!0)}return t.find=B,t.read=P,t.parse=d,t.write=V,t.writeFile=H,t.utils={cfb_new:zt,cfb_add:rr,cfb_del:xr,cfb_mov:cr,cfb_gc:qr,ReadShift:ky,CheckField:C$,prep_blob:oi,bconcat:La,use_zlib:R,_deflateRaw:Ue,_inflateRaw:ur,consts:L},t})();function Kie(e){return typeof e=="string"?s2(e):Array.isArray(e)?vie(e):e}function Hv(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=s2(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Hc(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([Kie(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Lf(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function qie(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ls(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function BF(e,t){for(var r=[],n=Ls(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function i2(e){for(var t=[],r=Ls(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function o2(e){for(var t=[],r=Ls(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function Yie(e){for(var t=[],r=Ls(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Ub=new Date(1899,11,30,0,0,0);function Sa(e,t){var r=e.getTime(),n=Ub.getTime()+(e.getTimezoneOffset()-Ub.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var s$=new Date,Xie=Ub.getTime()+(s$.getTimezoneOffset()-Ub.getTimezoneOffset())*6e4,$F=s$.getTimezoneOffset();function l2(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Xie),t.getTimezoneOffset()!==$F&&t.setTime(t.getTime()+(t.getTimezoneOffset()-$F)*6e4),t}function Qie(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var UF=new Date("2017-02-19T19:06:09.000Z"),a$=isNaN(UF.getFullYear())?new Date("2/19/17"):UF,Jie=a$.getFullYear()==2017;function is(e,t){var r=new Date(e);if(Jie)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(a$.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function g0(e,t){if(en&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Hc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Hc(VB(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Hc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Hc(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function os(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=os(e[r]));return t}function Ds(e,t){for(var r="";r.length<t;)r+=e;return r}function lc(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var Zie=["january","february","march","april","may","june","july","august","september","october","november","december"];function Cm(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Zie.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var eoe=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}})();function i$(e){return e?e.content&&e.type?g0(e.content,!0):e.data?cy(e.data):e.asNodeBuffer&&en?cy(e.asNodeBuffer().toString("binary")):e.asBinary?cy(e.asBinary()):e._data&&e._data.getContent?cy(g0(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function o$(e){if(!e)return null;if(e.data)return AF(e.data);if(e.asNodeBuffer&&en)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?AF(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function toe(e){return e&&e.name.slice(-4)===".bin"?o$(e):i$(e)}function yl(e,t){for(var r=e.FullPaths||Ls(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function r3(e,t){var r=yl(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function sa(e,t,r){if(!r)return toe(r3(e,t));if(!t)return null;try{return sa(e,t)}catch{return null}}function Go(e,t,r){if(!r)return i$(r3(e,t));if(!t)return null;try{return Go(e,t)}catch{return null}}function roe(e,t,r){return o$(r3(e,t))}function zF(e){for(var t=e.FullPaths||Ls(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Jr(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return en?n=ud(r):n=wie(r),Tr.utils.cfb_add(e,t,n)}Tr.utils.cfb_add(e,t,r)}else e.file(t,r)}function n3(){return Tr.utils.cfb_new()}function l$(e,t){switch(t.type){case"base64":return Tr.read(e,{type:"base64"});case"binary":return Tr.read(e,{type:"binary"});case"buffer":case"array":return Tr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function dy(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Js=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,noe=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,WF=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,soe=/<[^>]*>/g,Ri=Js.match(WF)?WF:soe,aoe=/<\w*:/,ioe=/<(\/?)\w+:/;function Ir(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(noe),o=0,c="",u=0,d="",h="",g=1;if(i)for(u=0;u!=i.length;++u){for(h=i[u],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(d=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(g=(s=h.charCodeAt(a+1))==34||s==39?1:0,c=h.slice(a+1+g,h.length-g),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var p=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[p]&&d.slice(o-3,o)=="ext")continue;n[p]=c,n[p.toLowerCase()]=c}}return n}function ru(e){return e.replace(ioe,"<$1")}var c$={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},s3=i2(c$),mn=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,c){return c$[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}})(),a3=/[&<>'"]/g,ooe=/[\u0000-\u0008\u000b-\u001f]/g;function Rn(e){var t=e+"";return t.replace(a3,function(r){return s3[r]}).replace(ooe,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function HF(e){return Rn(e).replace(/ /g,"_x0020_")}var u$=/[\u0000-\u001f]/g;function i3(e){var t=e+"";return t.replace(a3,function(r){return s3[r]}).replace(/\n/g,"<br/>").replace(u$,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function loe(e){var t=e+"";return t.replace(a3,function(r){return s3[r]}).replace(u$,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var GF=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function coe(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function ns(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function wk(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function VF(e){var t=Tf(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function KF(e){return ud(e,"binary").toString("utf8")}var Cw="foo bar baz",zn=en&&(KF(Cw)==wk(Cw)&&KF||VF(Cw)==wk(Cw)&&VF)||wk,Hc=en?function(e){return ud(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},tv=(function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),d$=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}})(),uoe=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),doe=/<\/?(?:vt:)?variant>/g,foe=/<(?:vt:)([^>]*)>([\s\S]*)</;function qF(e,t){var r=Ir(e),n=e.match(uoe(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(doe,"").match(foe);i&&s.push({v:zn(i[2]),t:i[1]})}),s}var f$=/(^\s|\s$|\n)/;function ui(e,t){return"<"+e+(t.match(f$)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function rv(e){return Ls(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Qt(e,t,r){return"<"+e+(r!=null?rv(r):"")+(t!=null?(t.match(f$)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function fE(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function hoe(e,t){switch(typeof e){case"string":var r=Qt("vt:lpwstr",Rn(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Qt((e|0)==e?"vt:i4":"vt:r8",Rn(String(e)));case"boolean":return Qt("vt:bool",e?"true":"false")}if(e instanceof Date)return Qt("vt:filetime",fE(e));throw new Error("Unable to serialize "+e)}function o3(e){if(en&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return zn(Lf(Z4(e)));throw new Error("Bad input format: expected Buffer or string")}var nv=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ba={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},A0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Uo={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function goe(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function moe(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var YF=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},XF=en?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ud(t)})):YF(e)}:YF,QF=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Wu(e,s)));return n.join("").replace(no,"")},l3=en?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(no,""):QF(e,t,r)}:QF,JF=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},h$=en?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):JF(e,t,r)}:JF,ZF=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Gg(e,s)));return n.join("")},Gv=en?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):ZF(t,r,n)}:ZF,g$=function(e,t){var r=zo(e,t);return r>0?Gv(e,t+4,t+4+r-1):""},m$=g$,p$=function(e,t){var r=zo(e,t);return r>0?Gv(e,t+4,t+4+r-1):""},x$=p$,y$=function(e,t){var r=2*zo(e,t);return r>0?Gv(e,t+4,t+4+r-1):""},v$=y$,w$=function(t,r){var n=zo(t,r);return n>0?l3(t,r+4,r+4+n):""},b$=w$,_$=function(e,t){var r=zo(e,t);return r>0?Gv(e,t+4,t+4+r):""},S$=_$,k$=function(e,t){return goe(e,t)},zb=k$,c3=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};en&&(m$=function(t,r){if(!Buffer.isBuffer(t))return g$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},x$=function(t,r){if(!Buffer.isBuffer(t))return p$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},v$=function(t,r){if(!Buffer.isBuffer(t))return y$(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},b$=function(t,r){if(!Buffer.isBuffer(t))return w$(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},S$=function(t,r){if(!Buffer.isBuffer(t))return _$(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},zb=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):k$(t,r)},c3=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Gg=function(e,t){return e[t]},Wu=function(e,t){return e[t+1]*256+e[t]},poe=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},zo=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},jh=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},xoe=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ky(e,t){var r="",n,s,a=[],i,o,c,u;switch(t){case"dbcs":if(u=this.l,en&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Wu(this,u)),u+=2;e*=2;break;case"utf8":r=Gv(this,this.l,this.l+e);break;case"utf16le":e*=2,r=l3(this,this.l,this.l+e);break;case"wstr":return ky.call(this,e,"dbcs");case"lpstr-ansi":r=m$(this,this.l),e=4+zo(this,this.l);break;case"lpstr-cp":r=x$(this,this.l),e=4+zo(this,this.l);break;case"lpwstr":r=v$(this,this.l),e=4+2*zo(this,this.l);break;case"lpp4":e=4+zo(this,this.l),r=b$(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+zo(this,this.l),r=S$(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Gg(this,this.l+e++))!==0;)a.push(kw(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=Wu(this,this.l+e))!==0;)a.push(kw(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Gg(this,u),this.l=u+1,o=ky.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(kw(Wu(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Gg(this,u),this.l=u+1,o=ky.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(kw(Gg(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=Gg(this,this.l),this.l++,n;case 2:return n=(t==="i"?poe:Wu)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?jh:xoe)(this,this.l),this.l+=4,n):(s=zo(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=zb(this,this.l):s=zb([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=h$(this,this.l,e);break}}return this.l+=e,r}var yoe=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},voe=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},woe=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function boe(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)woe(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,yoe(this,t,this.l);break;case 8:if(n=8,r==="f"){moe(this,t,this.l);break}case 16:break;case-4:n=4,voe(this,t,this.l);break}return this.l+=n,this}function C$(e,t){var r=h$(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function oi(e,t){e.l=t,e.read_shift=ky,e.chk=C$,e.write_shift=boe}function Ii(e,t){e.l+=t}function _t(e){var t=Tf(e);return oi(t,0),t}function dd(e,t,r){if(e){var n,s,a;oi(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=cv[o]||cv[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var d=u.f&&u.f(e,a,r);if(e.l=c,t(d,u,o))return}}}function Co(){var e=[],t=en?256:2048,r=function(u){var d=_t(u);return oi(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},i=function(){return s(),La(e)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function Ft(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=cv[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&c3(r)&&e.push(r)}}function Cy(e,t,r){var n=os(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function eO(e,t,r){var n=os(e);return n.s=Cy(n.s,t.s,r),n.e=Cy(n.e,t.s,r),n}function Ty(e,t){if(e.cRel&&e.c<0)for(e=os(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=os(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Or(e);return!e.cRel&&e.cRel!=null&&(r=koe(r)),!e.rRel&&e.rRel!=null&&(r=_oe(r)),r}function bk(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+bs(e.s.c)+":"+(e.e.cRel?"":"$")+bs(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Xs(e.s.r)+":"+(e.e.rRel?"":"$")+Xs(e.e.r):Ty(e.s,t.biff)+":"+Ty(e.e,t.biff)}function u3(e){return parseInt(Soe(e),10)-1}function Xs(e){return""+(e+1)}function _oe(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Soe(e){return e.replace(/\$(\d+)$/,"$1")}function d3(e){for(var t=Coe(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function bs(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function koe(e){return e.replace(/^([A-Z])/,"$$$1")}function Coe(e){return e.replace(/^\$([A-Z])/,"$1")}function Toe(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function _s(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Or(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function To(e){var t=e.indexOf(":");return t==-1?{s:_s(e),e:_s(e)}:{s:_s(e.slice(0,t)),e:_s(e.slice(t+1))}}function Xr(e,t){return typeof t>"u"||typeof t=="number"?Xr(e.s,e.e):(typeof e!="string"&&(e=Or(e)),typeof t!="string"&&(t=Or(t)),e==t?e:e+":"+t)}function pn(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function tO(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Al(e.z,r?Sa(t):t)}catch{}try{return e.w=Al((e.XF||{}).numFmtId||(r?14:0),r?Sa(t):t)}catch{return""+t}}function nd(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?fd[e.v]||e.v:t==null?tO(e,e.v):tO(e,t))}function Bf(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function T$(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?_s(n.origin):n.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=pn(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[h].length;++g)if(!(typeof t[h][g]>"u")){var p={v:t[h][g]},x=i+h,v=o+g;if(u.s.r>x&&(u.s.r=x),u.s.c>v&&(u.s.c=v),u.e.r<x&&(u.e.r=x),u.e.c<v&&(u.e.c=v),t[h][g]&&typeof t[h][g]=="object"&&!Array.isArray(t[h][g])&&!(t[h][g]instanceof Date))p=t[h][g];else if(Array.isArray(p.v)&&(p.f=t[h][g][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||jr[14],n.cellDates?(p.t="d",p.w=Al(p.z,Sa(p.v))):(p.t="n",p.v=Sa(p.v),p.w=Al(p.z,p.v))):p.t="s";if(s)a[x]||(a[x]=[]),a[x][v]&&a[x][v].z&&(p.z=a[x][v].z),a[x][v]=p;else{var w=Or({c:v,r:x});a[w]&&a[w].z&&(p.z=a[w].z),a[w]=p}}}return u.s.c<1e7&&(a["!ref"]=Xr(u)),a}function ep(e,t){return T$(null,e,t)}function Eoe(e){return e.read_shift(4,"i")}function cc(e,t){return t||(t=_t(4)),t.write_shift(4,e),t}function Oi(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function $a(e,t){var r=!1;return t==null&&(r=!0,t=_t(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Noe(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Aoe(e,t){return t||(t=_t(4)),t.write_shift(2,0),t.write_shift(2,0),t}function f3(e,t){var r=e.l,n=e.read_shift(1),s=Oi(e),a=[],i={t:s,h:s};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push(Noe(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function joe(e,t){var r=!1;return t==null&&(r=!0,t=_t(15+4*e.t.length)),t.write_shift(1,0),$a(e.t,t),r?t.slice(0,t.l):t}var Poe=f3;function Foe(e,t){var r=!1;return t==null&&(r=!0,t=_t(23+4*e.t.length)),t.write_shift(1,1),$a(e.t,t),t.write_shift(4,1),Aoe({},t),r?t.slice(0,t.l):t}function Dl(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function j0(e,t){return t==null&&(t=_t(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function P0(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function F0(e,t){return t==null&&(t=_t(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Ooe=Oi,E$=$a;function h3(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Wb(e,t){var r=!1;return t==null&&(r=!0,t=_t(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Doe=Oi,hE=h3,g3=Wb;function m3(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?zb([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):jh(t,0)>>2;return r?s/100:s}function N$(e,t){t==null&&(t=_t(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function A$(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Ioe(e,t){return t||(t=_t(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var O0=A$,tp=Ioe;function Ai(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function m0(e,t){return(t||_t(8)).write_shift(8,e,"f")}function Roe(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=Gh[s];u&&(t.rgb=av(u));break;case 2:t.rgb=av([i,o,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Hb(e,t){if(t||(t=_t(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Moe(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Loe(e,t){t||(t=_t(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function j$(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Boe(e){return j$(e,1)}function $oe(e){return j$(e,2)}var p3=2,yo=3,Tw=11,rO=12,Gb=19,Ew=64,Uoe=65,zoe=71,Woe=4108,Hoe=4126,Da=80,P$=81,Goe=[Da,P$],gE={1:{n:"CodePage",t:p3},2:{n:"Category",t:Da},3:{n:"PresentationFormat",t:Da},4:{n:"ByteCount",t:yo},5:{n:"LineCount",t:yo},6:{n:"ParagraphCount",t:yo},7:{n:"SlideCount",t:yo},8:{n:"NoteCount",t:yo},9:{n:"HiddenCount",t:yo},10:{n:"MultimediaClipCount",t:yo},11:{n:"ScaleCrop",t:Tw},12:{n:"HeadingPairs",t:Woe},13:{n:"TitlesOfParts",t:Hoe},14:{n:"Manager",t:Da},15:{n:"Company",t:Da},16:{n:"LinksUpToDate",t:Tw},17:{n:"CharacterCount",t:yo},19:{n:"SharedDoc",t:Tw},22:{n:"HyperlinksChanged",t:Tw},23:{n:"AppVersion",t:yo,p:"version"},24:{n:"DigSig",t:Uoe},26:{n:"ContentType",t:Da},27:{n:"ContentStatus",t:Da},28:{n:"Language",t:Da},29:{n:"Version",t:Da},255:{},2147483648:{n:"Locale",t:Gb},2147483651:{n:"Behavior",t:Gb},1919054434:{}},mE={1:{n:"CodePage",t:p3},2:{n:"Title",t:Da},3:{n:"Subject",t:Da},4:{n:"Author",t:Da},5:{n:"Keywords",t:Da},6:{n:"Comments",t:Da},7:{n:"Template",t:Da},8:{n:"LastAuthor",t:Da},9:{n:"RevNumber",t:Da},10:{n:"EditTime",t:Ew},11:{n:"LastPrinted",t:Ew},12:{n:"CreatedDate",t:Ew},13:{n:"ModifiedDate",t:Ew},14:{n:"PageCount",t:yo},15:{n:"WordCount",t:yo},16:{n:"CharCount",t:yo},17:{n:"Thumbnail",t:zoe},18:{n:"Application",t:Da},19:{n:"DocSecurity",t:yo},255:{},2147483648:{n:"Locale",t:Gb},2147483651:{n:"Behavior",t:Gb},1919054434:{}},nO={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Voe=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Koe(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var qoe=Koe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Gh=os(qoe),fd={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},F$={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},pE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Nw={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function x3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Yoe(e){var t=x3();if(!e||!e.match)return t;var r={};if((e.match(Ri)||[]).forEach(function(n){var s=Ir(n);switch(s[0].replace(aoe,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[pE[s.ContentType]]!==void 0&&t[pE[s.ContentType]].push(s.PartName);break}}),t.xmlns!==ba.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function O$(e,t){var r=Yie(pE),n=[],s;n[n.length]=Js,n[n.length]=Qt("Types",null,{xmlns:ba.CT,"xmlns:xsd":ba.xsd,"xmlns:xsi":ba.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Qt("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=Qt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Nw[c][t.bookType]||Nw[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Qt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Nw[c][t.bookType]||Nw[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Qt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var an={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function sv(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ey(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Ri)||[]).forEach(function(s){var a=Ir(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:dy(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function dm(e){var t=[Js,Qt("Relationships",null,{xmlns:ba.RELS})];return Ls(e["!id"]).forEach(function(r){t[t.length]=Qt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Dn(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[an.HLINK,an.XPATH,an.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var Xoe="application/vnd.oasis.opendocument.spreadsheet";function Qoe(e,t){for(var r=o3(e),n,s;n=nv.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Ir(n[0],!1),s.path=="/"&&s.type!==Xoe)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function Joe(e){var t=[Js];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function sO(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Zoe(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function ele(e){var t=[Js];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(sO(e[r][0],e[r][1])),t.push(Zoe("",e[r][0]));return t.push(sO("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function D$(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Mb.version+"</meta:generator></office:meta></office:document-meta>"}var Tl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],tle=(function(){for(var e=new Array(Tl.length),t=0;t<Tl.length;++t){var r=Tl[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function I$(e){var t={};e=zn(e);for(var r=0;r<Tl.length;++r){var n=Tl[r],s=e.match(tle[r]);s!=null&&s.length>0&&(t[n[1]]=mn(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=is(t[n[1]]))}return t}function _k(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Rn(t),n[n.length]=r?Qt(e,t,r):ui(e,t))}function R$(e,t){var r=t||{},n=[Js,Qt("cp:coreProperties",null,{"xmlns:cp":ba.CORE_PROPS,"xmlns:dc":ba.dc,"xmlns:dcterms":ba.dcterms,"xmlns:dcmitype":ba.dcmitype,"xmlns:xsi":ba.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&_k("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:fE(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&_k("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:fE(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=Tl.length;++a){var i=Tl[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&_k(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Vh=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],M$=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function L$(e,t,r,n){var s=[];if(typeof e=="string")s=qF(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(d){return{v:d}}));var i=typeof t=="string"?qF(t,n).map(function(d){return d.v}):t,o=0,c=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(c=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function rle(e,t,r){var n={};return t||(t={}),e=zn(e),Vh.forEach(function(s){var a=(e.match(tv(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=mn(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&L$(n.HeadingPairs,n.TitlesOfParts,t,r),t}function B$(e){var t=[],r=Qt;return e||(e={}),e.Application="SheetJS",t[t.length]=Js,t[t.length]=Qt("Properties",null,{xmlns:ba.EXT_PROPS,"xmlns:vt":ba.vt}),Vh.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Rn(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Rn(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var nle=/<[^>]+>[^<]*/g;function sle(e,t){var r={},n="",s=e.match(nle);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Ir(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=mn(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=mn(d);break;case"bool":r[n]=ns(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=is(d);break;case"cy":case"error":r[n]=mn(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function $$(e){var t=[Js,Qt("Properties",null,{xmlns:ba.CUST_PROPS,"xmlns:vt":ba.vt})];if(!e)return t.join("");var r=1;return Ls(e).forEach(function(s){++r,t[t.length]=Qt("property",hoe(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Rn(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var xE={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Sk;function ale(e,t,r){Sk||(Sk=i2(xE)),t=Sk[t]||t,e[t]=r}function ile(e,t){var r=[];return Ls(xE).map(function(n){for(var s=0;s<Tl.length;++s)if(Tl[s][1]==n)return Tl[s];for(s=0;s<Vh.length;++s)if(Vh[s][1]==n)return Vh[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(ui(xE[n[1]]||n[1],s))}}),Qt("DocumentProperties",r.join(""),{xmlns:Uo.o})}function ole(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Ls(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<Tl.length;++i)if(a==Tl[i][1])return;for(i=0;i<Vh.length;++i)if(a==Vh[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(Qt(HF(a),o,{"dt:dt":c}))}}),t&&Ls(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(Qt(HF(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Uo.o+'">'+s.join("")+"</"+n+">"}function y3(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function lle(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=_t(8);return i.write_shift(4,n),i.write_shift(4,s),i}function U$(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function z$(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function W$(e,t,r){return t===31?z$(e):U$(e,t,r)}function yE(e,t,r){return W$(e,t,r===!1?0:4)}function cle(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return W$(e,t,0)}function ule(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(no,""),e.l-s&2&&(e.l+=2)}return r}function dle(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(no,"");return r}function fle(e){var t=e.l,r=Vb(e,P$);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Vb(e,yo);return[r,n]}function hle(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(fle(e));return r}function aO(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(no,"").replace(uy,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function H$(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function gle(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Vb(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==rO&&n!==t&&Goe.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===rO?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return U$(e,n,4).replace(no,"");case 31:return z$(e);case 64:return y3(e);case 65:return H$(e);case 71:return gle(e);case 80:return yE(e,n,!a.raw).replace(no,"");case 81:return cle(e,n).replace(no,"");case 4108:return hle(e);case 4126:case 4127:return n==4127?ule(e):dle(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function iO(e,t){var r=_t(4),n=_t(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=_t(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=lle(t);break;case 31:case 80:for(n=_t(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return La([r,n])}function oO(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,c=-1,u={};for(i=0;i!=s;++i){var d=e.read_shift(4),h=e.read_shift(4);a[i]=[d,h+r]}a.sort(function(k,b){return k[1]-b[1]});var g={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var p=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(p=!1,e.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[a[i][0]];if(g[x.n]=Vb(e,x.t,{raw:!0}),x.p==="version"&&(g[x.n]=String(g[x.n]>>16)+"."+("0000"+String(g[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(g[x.n]){case 0:g[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ac(o=g[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[x.n])}}else if(a[i][0]===1){if(o=g.CodePage=Vb(e,p3),ac(o),c!==-1){var v=e.l;e.l=a[c][1],u=aO(e,o),e.l=v}}else if(a[i][0]===0){if(o===0){c=i,e.l=a[i+1][1];continue}u=aO(e,o)}else{var w=u[a[i][0]],C;switch(e[e.l]){case 65:e.l+=4,C=H$(e);break;case 30:e.l+=4,C=yE(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,C=yE(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,C=e.read_shift(4,"i");break;case 19:e.l+=4,C=e.read_shift(4);break;case 5:e.l+=4,C=e.read_shift(8,"f");break;case 11:e.l+=4,C=Ks(e,4);break;case 64:e.l+=4,C=is(y3(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[w]=C}}return e.l=r+n,g}var G$=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function mle(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function lO(e,t,r){var n=_t(8),s=[],a=[],i=8,o=0,c=_t(8),u=_t(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),s.push(u),i+=8+c.length,!t){u=_t(8),u.write_shift(4,0),s.unshift(u);var d=[_t(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(c=_t(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=La(d),a.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(G$.indexOf(e[o][0])>-1||M$.indexOf(e[o][0])>-1)&&e[o][1]!=null){var g=e[o][1],p=0;if(t){p=+t[e[o][0]];var x=r[p];if(x.p=="version"&&typeof g=="string"){var v=g.split(".");g=(+v[0]<<16)+(+v[1]||0)}c=iO(x.t,g)}else{var w=mle(g);w==-1&&(w=31,g=String(g)),c=iO(w,g)}a.push(c),u=_t(8),u.write_shift(4,t?p:2+o),s.push(u),i+=8+c.length}var C=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,C),C+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),La([n].concat(s).concat(a))}function cO(e,t,r){var n=e.content;if(!n)return{};oi(n,0);var s,a,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==Tr.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var h=oO(n,t),g={SystemIdentifier:u};for(var p in h)g[p]=h[p];if(g.FMTID=a,s===1)return g;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var x;try{x=oO(n,null)}catch{}for(p in x)g[p]=x[p];return g.FMTID=[a,i],g}function uO(e,t,r,n,s,a){var i=_t(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Tr.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var c=lO(e,r,n);if(o.push(c),s){var u=lO(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),o.push(u)}return La(o)}function nf(e,t){return e.read_shift(t),null}function ple(e,t){t||(t=_t(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function xle(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Ks(e,t){return e.read_shift(t)===1}function Qi(e,t){return t||(t=_t(2)),t.write_shift(2,+!!e),t}function aa(e){return e.read_shift(2,"u")}function vl(e,t){return t||(t=_t(2)),t.write_shift(2,e),t}function V$(e,t){return xle(e,t,aa)}function yle(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function K$(e,t,r){return r||(r=_t(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Vv(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function vle(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,c={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*i),n&&(e.l+=o),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function wle(e){var t=e.t||"",r=_t(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=_t(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return La(s)}function p0(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Kv(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):p0(e,n,r)}function D0(e,t,r){if(r.biff>5)return Kv(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function q$(e,t,r){return r||(r=_t(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function ble(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function _le(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(no,"");return n&&(e.l+=24),s}function Sle(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(no,"");return r+i}function kle(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return _le(e);case"0303000000000000c000000000000046":return Sle(e);default:throw new Error("Unsupported Moniker "+r)}}function Aw(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(no,""):"";return r}function dO(e,t){t||(t=_t(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Cle(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,c,u="",d,h;s&16&&(a=Aw(e,r-e.l)),s&128&&(i=Aw(e,r-e.l)),(s&257)===257&&(o=Aw(e,r-e.l)),(s&257)===1&&(c=kle(e,r-e.l)),s&8&&(u=Aw(e,r-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(h=y3(e)),e.l=r;var g=i||o||c||"";g&&u&&(g+="#"+u),g||(g="#"+u),s&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var p={Target:g};return d&&(p.guid=d),h&&(p.time=h),a&&(p.Tooltip=a),p}function Tle(e){var t=_t(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),dO(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&dO(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Y$(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function X$(e,t){var r=Y$(e);return r[3]=0,r}function nu(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function x0(e,t,r,n){return n||(n=_t(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Ele(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Nle(e,t,r){return t===0?"":D0(e,t,r)}function Ale(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function Q$(e){var t=e.read_shift(2),r=m3(e);return[t,r]}function jle(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=Vv(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function c2(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function J$(e,t){return t||(t=_t(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Z$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var Ple=Z$;function eU(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Fle(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Ole(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function _i(e){e.l+=2,e.l+=e.read_shift(2)}var Dle={0:_i,4:_i,5:_i,6:_i,7:Ole,8:_i,9:_i,10:_i,11:_i,12:_i,13:Fle,14:_i,15:_i,16:_i,17:_i,18:_i,19:_i,20:_i,21:eU};function Ile(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(Dle[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function jw(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function v3(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=_t(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function Rle(e,t){return t===0||e.read_shift(2),1200}function Mle(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=D0(e,0,r);return e.read_shift(t+n-e.l),s}function Lle(e,t){var r=!t||t.biff==8,n=_t(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Ble(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function $le(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Vv(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function Ule(e,t){var r=!t||t.biff>=8?2:1,n=_t(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function zle(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(vle(e));return a.Count=n,a.Unique=s,a}function Wle(e,t){var r=_t(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=wle(e[s]);var a=La([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function Hle(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Gle(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Vle(e){var t=Ele(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Kle(e){return e.read_shift(2),e.read_shift(4)}function fO(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function qle(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:c,TabRatio:u}}function Yle(){var e=_t(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Xle(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Qle(e){var t=_t(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Jle(){}function Zle(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Vv(e,0,r),n}function ece(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=_t(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function tce(e){var t=nu(e);return t.isst=e.read_shift(4),t}function rce(e,t,r,n){var s=_t(10);return x0(e,t,n,s),s.write_shift(4,r),s}function nce(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=nu(e);r.biff==2&&e.l++;var a=Kv(e,n-e.l,r);return s.val=a,s}function sce(e,t,r,n,s){var a=!s||s.biff==8,i=_t(8+ +a+(1+a)*r.length);return x0(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function ace(e,t,r){var n=e.read_shift(2),s=D0(e,0,r);return[n,s]}function ice(e,t,r,n){var s=r&&r.biff==5;n||(n=_t(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var oce=D0;function hO(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c}}}function lce(e,t){var r=t.biff==8||!t.biff?4:2,n=_t(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function cce(e){var t=e.read_shift(2),r=e.read_shift(2),n=Q$(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function uce(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(Q$(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function dce(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function fce(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return s.patternType=Voe[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function hce(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=fce(e,t,n.fStyle,r),n}function gO(e,t,r,n){var s=r&&r.biff==5;n||(n=_t(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function gce(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function mce(e){var t=_t(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function mO(e,t,r){var n=nu(e);(r.biff==2||t==9)&&++e.l;var s=yle(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function pce(e,t,r,n,s,a){var i=_t(8);return x0(e,t,n,i),K$(r,a,i),i}function xce(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=nu(e),s=Ai(e);return n.val=s,n}function yce(e,t,r,n){var s=_t(14);return x0(e,t,n,s),m0(r,s),s}var pO=Nle;function vce(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=p0(e,a),o=[];n>e.l;)o.push(Kv(e));return[a,s,i,o]}function xO(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=jle(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var wce=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function yO(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=p0(e,i,r);s&32&&(u=wce[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var h=n==e.l||o===0||!(d>0)?[]:Ihe(e,d,r,o);return{chKey:a,Name:u,itab:c,rgce:h}}function tU(e,t,r){if(r.biff<8)return bce(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(Ale(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function bce(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Vv(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function _ce(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=p0(e,n,r),i=p0(e,s,r);return[a,i]}function Sce(e,t,r){var n=Z$(e);e.l++;var s=e.read_shift(1);return t-=8,[Rhe(e,t,r),s,n]}function vO(e,t,r){var n=Ple(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Ohe(e,t,r)]}function kce(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Cce(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=D0(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function Tce(e,t,r){return Cce(e,t,r)}function Ece(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(c2(e));return r}function Nce(e){var t=_t(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)J$(e[r],t);return t}function Ace(e,t,r){if(r&&r.biff<8)return Pce(e,t,r);var n=eU(e),s=Ile(e,t-22,n[1]);return{cmo:n,ft:s}}var jce={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function Pce(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((jce[n]||Ii)(e,t,r)),{cmo:[s,n,a],ft:i}}function Fce(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=ble(e,6,r);var o=e.read_shift(2);e.read_shift(2),aa(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],h=p0(e,e.lens[u+1]-e.lens[u]-1);if(s+=h,s.length>=(d?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function Oce(e,t){var r=c2(e);e.l+=16;var n=Cle(e,t-24);return[r,n]}function Dce(e){var t=_t(24),r=_s(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return La([t,Tle(e[1])])}function Ice(e,t){e.read_shift(2);var r=c2(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(no,""),[r,n]}function Rce(e){var t=e[1].Tooltip,r=_t(10+2*(t.length+1));r.write_shift(2,2048);var n=_s(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function Mce(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=nO[r]||r,r=e.read_shift(2),t[1]=nO[r]||r,t}function Lce(e){return e||(e=_t(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Bce(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(X$(e));return r}function $ce(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(X$(e));return r}function Uce(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function rU(e,t,r){if(!r.cellStyles)return Ii(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function zce(e,t){var r=_t(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Wce(e,t){var r={};return t<32||(e.l+=16,r.header=Ai(e),r.footer=Ai(e),e.l+=2),r}function Hce(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function Gce(e){for(var t=_t(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Vce=nu,Kce=V$,qce=Kv;function Yce(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function Xce(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=nu(e);++e.l;var s=D0(e,t-7,r);return n.t="str",n.val=s,n}function Qce(e){var t=nu(e);++e.l;var r=Ai(e);return t.t="n",t.val=r,t}function Jce(e,t,r){var n=_t(15);return Qv(n,e,t),n.write_shift(8,r,"f"),n}function Zce(e){var t=nu(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function eue(e,t,r){var n=_t(9);return Qv(n,e,t),n.write_shift(2,r),n}function tue(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function rue(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function nue(e,t,r){var n=e.l+t,s=nu(e),a=e.read_shift(2),i=p0(e,a,r);return e.l=n,s.t="str",s.val=i,s}var sue=[2,3,48,49,131,139,140,245],vE=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=i2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=Tf(1);switch(c.type){case"base64":d=Ho(Yo(o));break;case"binary":d=Ho(o);break;case"buffer":case"array":d=o;break}oi(d,0);var h=d.read_shift(1),g=!!(h&136),p=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,g=!0;break;case 49:p=!0,g=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var v=0,w=521;h==2&&(v=d.read_shift(2)),d.l+=3,h!=2&&(v=d.read_shift(4)),v>1048576&&(v=1e6),h!=2&&(w=d.read_shift(2));var C=d.read_shift(2),k=c.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(k=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var b=[],N={},E=Math.min(d.length,h==2?521:w-10-(p?264:0)),P=x?32:11;d.l<E&&d[d.l]!=13;)switch(N={},N.name=Jy.utils.decode(k,d.slice(d.l,d.l+P)).replace(/[\u0000\r\n].*$/g,""),d.l+=P,N.type=String.fromCharCode(d.read_shift(1)),h!=2&&!x&&(N.offset=d.read_shift(4)),N.len=d.read_shift(1),h==2&&(N.offset=d.read_shift(2)),N.dec=d.read_shift(1),N.name.length&&b.push(N),h!=2&&(d.l+=x?13:14),N.type){case"B":(!p||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var F=0,A=0;for(u[0]=[],A=0;A!=b.length;++A)u[0][A]=b[A].name;for(;v-- >0;){if(d[d.l]===42){d.l+=C;continue}for(++d.l,u[++F]=[],A=0,A=0;A!=b.length;++A){var j=d.slice(d.l,d.l+b[A].len);d.l+=b[A].len,oi(j,0);var I=Jy.utils.decode(k,j);switch(b[A].type){case"C":I.trim().length&&(u[F][A]=I.replace(/\s+$/,""));break;case"D":I.length===8?u[F][A]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):u[F][A]=I;break;case"F":u[F][A]=parseFloat(I.trim());break;case"+":case"I":u[F][A]=x?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":u[F][A]=!0;break;case"N":case"F":u[F][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[F][A]="##MEMO##"+(x?parseInt(I.trim(),10):j.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(u[F][A]=+I||0);break;case"@":u[F][A]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":u[F][A]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":u[F][A]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[F][A]=-j.read_shift(-8,"f");break;case"B":if(p&&b[A].len==8){u[F][A]=j.read_shift(8,"f");break}case"G":case"P":j.l+=b[A].len;break;case"0":if(b[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[A].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=b,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=ep(r(o,u),u);return d["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,d}function s(o,c){try{return Bf(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var u=c||{};if(+u.codepage>=0&&ac(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Co(),h=Yb(o,{header:1,raw:!0,cellDates:!0}),g=h[0],p=h.slice(1),x=o["!cols"]||[],v=0,w=0,C=0,k=1;for(v=0;v<g.length;++v){if(((x[v]||{}).DBF||{}).name){g[v]=x[v].DBF.name,++C;continue}if(g[v]!=null){if(++C,typeof g[v]=="number"&&(g[v]=g[v].toString(10)),typeof g[v]!="string")throw new Error("DBF Invalid column name "+g[v]+" |"+typeof g[v]+"|");if(g.indexOf(g[v])!==v){for(w=0;w<1024;++w)if(g.indexOf(g[v]+"_"+w)==-1){g[v]+="_"+w;break}}}}var b=pn(o["!ref"]),N=[],E=[],P=[];for(v=0;v<=b.e.c-b.s.c;++v){var F="",A="",j=0,I=[];for(w=0;w<p.length;++w)p[w][v]!=null&&I.push(p[w][v]);if(I.length==0||g[v]==null){N[v]="?";continue}for(w=0;w<I.length;++w){switch(typeof I[w]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=I[w]instanceof Date?"D":"C";break;default:A="C"}j=Math.max(j,String(I[w]).length),F=F&&F!=A?"C":A}j>250&&(j=250),A=((x[v]||{}).DBF||{}).type,A=="C"&&x[v].DBF.len>j&&(j=x[v].DBF.len),F=="B"&&A=="N"&&(F="N",P[v]=x[v].DBF.dec,j=x[v].DBF.len),E[v]=F=="C"||A=="N"?j:a[F]||0,k+=E[v],N[v]=F}var B=d.next(32);for(B.write_shift(4,318902576),B.write_shift(4,p.length),B.write_shift(2,296+32*C),B.write_shift(2,k),v=0;v<4;++v)B.write_shift(4,0);for(B.write_shift(4,0|(+t[GB]||3)<<8),v=0,w=0;v<g.length;++v)if(g[v]!=null){var Y=d.next(32),Z=(g[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Y.write_shift(1,Z,"sbcs"),Y.write_shift(1,N[v]=="?"?"C":N[v],"sbcs"),Y.write_shift(4,w),Y.write_shift(1,E[v]||a[N[v]]||0),Y.write_shift(1,P[v]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),w+=E[v]||a[N[v]]||0}var ae=d.next(264);for(ae.write_shift(4,13),v=0;v<65;++v)ae.write_shift(4,0);for(v=0;v<p.length;++v){var ee=d.next(k);for(ee.write_shift(1,0),w=0;w<g.length;++w)if(g[w]!=null)switch(N[w]){case"L":ee.write_shift(1,p[v][w]==null?63:p[v][w]?84:70);break;case"B":ee.write_shift(8,p[v][w]||0,"f");break;case"N":var ne="0";for(typeof p[v][w]=="number"&&(ne=p[v][w].toFixed(P[w]||0)),C=0;C<E[w]-ne.length;++C)ee.write_shift(1,32);ee.write_shift(1,ne,"sbcs");break;case"D":p[v][w]?(ee.write_shift(4,("0000"+p[v][w].getFullYear()).slice(-4),"sbcs"),ee.write_shift(2,("00"+(p[v][w].getMonth()+1)).slice(-2),"sbcs"),ee.write_shift(2,("00"+p[v][w].getDate()).slice(-2),"sbcs")):ee.write_shift(8,"00000000","sbcs");break;case"C":var L=String(p[v][w]!=null?p[v][w]:"").slice(0,E[w]);for(ee.write_shift(1,L,"sbcs"),C=0;C<E[w]-L.length;++C)ee.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}})(),nU=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ls(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,p){var x=e[p];return typeof x=="number"?jF(x):x},n=function(g,p,x){var v=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return v==59?g:jF(v)};e["|"]=254;function s(g,p){switch(p.type){case"base64":return a(Yo(g),p);case"binary":return a(g,p);case"buffer":return a(en&&Buffer.isBuffer(g)?g.toString("binary"):Lf(g),p);case"array":return a(g0(g),p)}throw new Error("Unrecognized type "+p.type)}function a(g,p){var x=g.split(/[\n\r]+/),v=-1,w=-1,C=0,k=0,b=[],N=[],E=null,P={},F=[],A=[],j=[],I=0,B;for(+p.codepage>=0&&ac(+p.codepage);C!==x.length;++C){I=0;var Y=x[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Z=Y.replace(/;;/g,"\0").split(";").map(function(Q){return Q.replace(/\u0000/g,";")}),ae=Z[0],ee;if(Y.length>0)switch(ae){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Z[1].charAt(0)=="P"&&N.push(Y.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,L=!1,H=!1,M=!1,V=-1,W=-1;for(k=1;k<Z.length;++k)switch(Z[k].charAt(0)){case"A":break;case"X":w=parseInt(Z[k].slice(1))-1,L=!0;break;case"Y":for(v=parseInt(Z[k].slice(1))-1,L||(w=0),B=b.length;B<=v;++B)b[B]=[];break;case"K":ee=Z[k].slice(1),ee.charAt(0)==='"'?ee=ee.slice(1,ee.length-1):ee==="TRUE"?ee=!0:ee==="FALSE"?ee=!1:isNaN(lc(ee))?isNaN(Cm(ee).getDate())||(ee=is(ee)):(ee=lc(ee),E!==null&&Jm(E)&&(ee=l2(ee))),ne=!0;break;case"E":M=!0;var R=fm(Z[k].slice(1),{r:v,c:w});b[v][w]=[b[v][w],R];break;case"S":H=!0,b[v][w]=[b[v][w],"S5S"];break;case"G":break;case"R":V=parseInt(Z[k].slice(1))-1;break;case"C":W=parseInt(Z[k].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+Y)}if(ne&&(b[v][w]&&b[v][w].length==2?b[v][w][0]=ee:b[v][w]=ee,E=null),H){if(M)throw new Error("SYLK shared formula cannot have own formula");var U=V>-1&&b[V][W];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");b[v][w][1]=bU(U[1],{r:v-V,c:w-W})}break;case"F":var q=0;for(k=1;k<Z.length;++k)switch(Z[k].charAt(0)){case"X":w=parseInt(Z[k].slice(1))-1,++q;break;case"Y":for(v=parseInt(Z[k].slice(1))-1,B=b.length;B<=v;++B)b[B]=[];break;case"M":I=parseInt(Z[k].slice(1))/20;break;case"F":break;case"G":break;case"P":E=N[parseInt(Z[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=Z[k].slice(1).split(" "),B=parseInt(j[0],10);B<=parseInt(j[1],10);++B)I=parseInt(j[2],10),A[B-1]=I===0?{hidden:!0}:{wch:I},Ef(A[B-1]);break;case"C":w=parseInt(Z[k].slice(1))-1,A[w]||(A[w]={});break;case"R":v=parseInt(Z[k].slice(1))-1,F[v]||(F[v]={}),I>0?(F[v].hpt=I,F[v].hpx=Em(I)):I===0&&(F[v].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+Y)}q<1&&(E=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+Y)}}return F.length>0&&(P["!rows"]=F),A.length>0&&(P["!cols"]=A),p&&p.sheetRows&&(b=b.slice(0,p.sheetRows)),[b,P]}function i(g,p){var x=s(g,p),v=x[0],w=x[1],C=ep(v,p);return Ls(w).forEach(function(k){C[k]=w[k]}),C}function o(g,p){return Bf(i(g,p),p)}function c(g,p,x,v){var w="C;Y"+(x+1)+";X"+(v+1)+";K";switch(g.t){case"n":w+=g.v||0,g.f&&!g.F&&(w+=";E"+C3(g.f,{r:x,c:v}));break;case"b":w+=g.v?"TRUE":"FALSE";break;case"e":w+=g.w||g.v;break;case"d":w+='"'+(g.w||g.v)+'"';break;case"s":w+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(g,p){p.forEach(function(x,v){var w="F;W"+(v+1)+" "+(v+1)+" ";x.hidden?w+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=iv(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=ov(x.wpx)),typeof x.wch=="number"&&(w+=Math.round(x.wch))),w.charAt(w.length-1)!=" "&&g.push(w)})}function d(g,p){p.forEach(function(x,v){var w="F;";x.hidden?w+="M0;":x.hpt?w+="M"+20*x.hpt+";":x.hpx&&(w+="M"+20*lv(x.hpx)+";"),w.length>2&&g.push(w+"R"+(v+1))})}function h(g,p){var x=["ID;PWXL;N;E"],v=[],w=pn(g["!ref"]),C,k=Array.isArray(g),b=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),g["!cols"]&&u(x,g["!cols"]),g["!rows"]&&d(x,g["!rows"]),x.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var E=w.s.c;E<=w.e.c;++E){var P=Or({r:N,c:E});C=k?(g[N]||[])[E]:g[P],!(!C||C.v==null&&(!C.f||C.F))&&v.push(c(C,g,N,E))}return x.join(b)+b+v.join(b)+b+"E"+b}return{to_workbook:o,to_sheet:i,from_sheet:h}})(),sU=(function(){function e(a,i){switch(i.type){case"base64":return t(Yo(a),i);case"binary":return t(a,i);case"buffer":return t(en&&Buffer.isBuffer(a)?a.toString("binary"):Lf(a),i);case"array":return t(g0(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),c=-1,u=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++c]=[],u=0;continue}if(!(c<0)){var g=o[d].trim().split(","),p=g[0],x=g[1];++d;for(var v=o[d]||"";(v.match(/["]/g)||[]).length&1&&d<o.length-1;)v+=`
`+o[++d];switch(v=v.trim(),+p){case-1:if(v==="BOT"){h[++c]=[],u=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?h[c][u]=!0:v==="FALSE"?h[c][u]=!1:isNaN(lc(x))?isNaN(Cm(x).getDate())?h[c][u]=x:h[c][u]=is(x):h[c][u]=lc(x),++u;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),h[c][u++]=v!==""?v:null;break}if(v==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function r(a,i){return ep(e(a,i),i)}function n(a,i){return Bf(r(a,i),i)}var s=(function(){var a=function(c,u,d,h,g){c.push(u),c.push(d+","+h),c.push('"'+g.replace(/"/g,'""')+'"')},i=function(c,u,d,h){c.push(u+","+d),c.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var u=[],d=pn(c["!ref"]),h,g=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){i(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var v=Or({r:p,c:x});if(h=g?(c[p]||[])[x]:c[v],!h){i(u,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?i(u,1,0,"="+h.f):i(u,1,0,""):i(u,0,w,"V");break;case"b":i(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Al(h.z||jr[14],Sa(is(h.v)))),i(u,0,h.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var C=`\r
`,k=u.join(C);return k}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),aU=(function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,g){for(var p=h.split(`
`),x=-1,v=-1,w=0,C=[];w!==p.length;++w){var k=p[w].trim().split(":");if(k[0]==="cell"){var b=_s(k[1]);if(C.length<=b.r)for(x=C.length;x<=b.r;++x)C[x]||(C[x]=[]);switch(x=b.r,v=b.c,k[2]){case"t":C[x][v]=e(k[3]);break;case"v":C[x][v]=+k[3];break;case"vtf":var N=k[k.length-1];case"vtc":switch(k[3]){case"nl":C[x][v]=!!+k[4];break;default:C[x][v]=+k[4];break}k[2]=="vtf"&&(C[x][v]=[C[x][v],N])}}}return g&&g.sheetRows&&(C=C.slice(0,g.sheetRows)),C}function n(h,g){return ep(r(h,g),g)}function s(h,g){return Bf(n(h,g),g)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var g=[],p=[],x,v="",w=To(h["!ref"]),C=Array.isArray(h),k=w.s.r;k<=w.e.r;++k)for(var b=w.s.c;b<=w.e.c;++b)if(v=Or({r:k,c:b}),x=C?(h[k]||[])[b]:h[v],!(!x||x.v==null||x.t==="z")){switch(p=["cell",v,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var N=Sa(is(x.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=x.w||Al(x.z||jr[14],N);break;case"e":continue}g.push(p.join(":"))}return g.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(h){return[a,i,o,i,u(h),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}})(),Tm=(function(){function e(d,h,g,p,x){x.raw?h[g][p]=d:d===""||(d==="TRUE"?h[g][p]=!0:d==="FALSE"?h[g][p]=!1:isNaN(lc(d))?isNaN(Cm(d).getDate())?h[g][p]=d:h[g][p]=is(d):h[g][p]=lc(d))}function t(d,h){var g=h||{},p=[];if(!d||d.length===0)return p;for(var x=d.split(/[\r\n]/),v=x.length-1;v>=0&&x[v].length===0;)--v;for(var w=10,C=0,k=0;k<=v;++k)C=x[k].indexOf(" "),C==-1?C=x[k].length:C++,w=Math.max(w,C);for(k=0;k<=v;++k){p[k]=[];var b=0;for(e(x[k].slice(0,w).trim(),p,k,b,g),b=1;b<=(x[k].length-w)/10+1;++b)e(x[k].slice(w+(b-1)*10,w+b*10).trim(),p,k,b,g)}return g.sheetRows&&(p=p.slice(0,g.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var h={},g=!1,p=0,x=0;p<d.length;++p)(x=d.charCodeAt(p))==34?g=!g:!g&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p]);if(!x.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p])}return x.sort(function(v,w){return v[0]-w[0]||n[v[1]]-n[w[1]]}),r[x.pop()[1]]||44}function a(d,h){var g=h||{},p="",x=g.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=s(d.slice(0,1024)):g&&g.FS?p=g.FS:p=s(d.slice(0,1024));var w=0,C=0,k=0,b=0,N=0,E=p.charCodeAt(0),P=!1,F=0,A=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var j=g.dateNF!=null?Hie(g.dateNF):null;function I(){var B=d.slice(b,N),Y={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),B.length===0)Y.t="z";else if(g.raw)Y.t="s",Y.v=B;else if(B.trim().length===0)Y.t="s",Y.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(Y.t="s",Y.v=B.slice(2,-1).replace(/""/g,'"')):vfe(B)?(Y.t="n",Y.f=B.slice(1)):(Y.t="s",Y.v=B);else if(B=="TRUE")Y.t="b",Y.v=!0;else if(B=="FALSE")Y.t="b",Y.v=!1;else if(!isNaN(k=lc(B)))Y.t="n",g.cellText!==!1&&(Y.w=B),Y.v=k;else if(!isNaN(Cm(B).getDate())||j&&B.match(j)){Y.z=g.dateNF||jr[14];var Z=0;j&&B.match(j)&&(B=Gie(B,g.dateNF,B.match(j)||[]),Z=1),g.cellDates?(Y.t="d",Y.v=is(B,Z)):(Y.t="n",Y.v=Sa(is(B,Z))),g.cellText!==!1&&(Y.w=Al(Y.z,Y.v instanceof Date?Sa(Y.v):Y.v)),g.cellNF||delete Y.z}else Y.t="s",Y.v=B;if(Y.t=="z"||(g.dense?(x[w]||(x[w]=[]),x[w][C]=Y):x[Or({c:C,r:w})]=Y),b=N+1,A=d.charCodeAt(b),v.e.c<C&&(v.e.c=C),v.e.r<w&&(v.e.r=w),F==E)++C;else if(C=0,++w,g.sheetRows&&g.sheetRows<=w)return!0}e:for(;N<d.length;++N)switch(F=d.charCodeAt(N)){case 34:A===34&&(P=!P);break;case E:case 10:case 13:if(!P&&I())break e;break}return N-b>0&&I(),x["!ref"]=Xr(v),x}function i(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,h):ep(t(d,h),h)}function o(d,h){var g="",p=h.type=="string"?[0,0,0,0]:O3(d,h);switch(h.type){case"base64":g=Yo(d);break;case"binary":g=d;break;case"buffer":h.codepage==65001?g=d.toString("utf8"):h.codepage&&typeof Jy<"u"||(g=en&&Buffer.isBuffer(d)?d.toString("binary"):Lf(d));break;case"array":g=g0(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?g=zn(g.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?g=zn(g):h.type=="binary"&&typeof Jy<"u",g.slice(0,19)=="socialcalc:version:"?aU.to_sheet(h.type=="string"?g:zn(g),h):i(g,h)}function c(d,h){return Bf(o(d,h),h)}function u(d){for(var h=[],g=pn(d["!ref"]),p,x=Array.isArray(d),v=g.s.r;v<=g.e.r;++v){for(var w=[],C=g.s.c;C<=g.e.c;++C){var k=Or({r:v,c:C});if(p=x?(d[v]||[])[C]:d[k],!p||p.v==null){w.push("          ");continue}for(var b=(p.w||(nd(p),p.w)||"").slice(0,10);b.length<10;)b+=" ";w.push(b+(C===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}})();function aue(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=nU.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Tm.to_workbook(e,t)}}var Kh=(function(){function e(R,U,q){if(R){oi(R,R.l||0);for(var Q=q.Enum||V;R.l<R.length;){var se=R.read_shift(2),X=Q[se]||Q[65535],ie=R.read_shift(2),le=R.l+ie,ce=X.f&&X.f(R,ie,q);if(R.l=le,U(ce,X,se))return}}}function t(R,U){switch(U.type){case"base64":return r(Ho(Yo(R)),U);case"binary":return r(Ho(R),U);case"buffer":case"array":return r(R,U)}throw"Unsupported type "+U.type}function r(R,U){if(!R)return R;var q=U||{},Q=q.dense?[]:{},se="Sheet1",X="",ie=0,le={},ce=[],Se=[],re={s:{r:0,c:0},e:{r:0,c:0}},ge=q.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)q.Enum=V,e(R,function(Be,Rt,et){switch(et){case 0:q.vers=Be,Be>=4096&&(q.qpro=!0);break;case 6:re=Be;break;case 204:Be&&(X=Be);break;case 222:X=Be;break;case 15:case 51:q.qpro||(Be[1].v=Be[1].v.slice(1));case 13:case 14:case 16:et==14&&(Be[2]&112)==112&&(Be[2]&15)>1&&(Be[2]&15)<15&&(Be[1].z=q.dateNF||jr[14],q.cellDates&&(Be[1].t="d",Be[1].v=l2(Be[1].v))),q.qpro&&Be[3]>ie&&(Q["!ref"]=Xr(re),le[se]=Q,ce.push(se),Q=q.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},ie=Be[3],se=X||"Sheet"+(ie+1),X="");var vt=q.dense?(Q[Be[0].r]||[])[Be[0].c]:Q[Or(Be[0])];if(vt){vt.t=Be[1].t,vt.v=Be[1].v,Be[1].z!=null&&(vt.z=Be[1].z),Be[1].f!=null&&(vt.f=Be[1].f);break}q.dense?(Q[Be[0].r]||(Q[Be[0].r]=[]),Q[Be[0].r][Be[0].c]=Be[1]):Q[Or(Be[0])]=Be[1];break}},q);else if(R[2]==26||R[2]==14)q.Enum=W,R[2]==14&&(q.qpro=!0,R.l=0),e(R,function(Be,Rt,et){switch(et){case 204:se=Be;break;case 22:Be[1].v=Be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Be[3]>ie&&(Q["!ref"]=Xr(re),le[se]=Q,ce.push(se),Q=q.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},ie=Be[3],se="Sheet"+(ie+1)),ge>0&&Be[0].r>=ge)break;q.dense?(Q[Be[0].r]||(Q[Be[0].r]=[]),Q[Be[0].r][Be[0].c]=Be[1]):Q[Or(Be[0])]=Be[1],re.e.c<Be[0].c&&(re.e.c=Be[0].c),re.e.r<Be[0].r&&(re.e.r=Be[0].r);break;case 27:Be[14e3]&&(Se[Be[14e3][0]]=Be[14e3][1]);break;case 1537:Se[Be[0]]=Be[1],Be[0]==ie&&(se=Be[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(Q["!ref"]=Xr(re),le[X||se]=Q,ce.push(X||se),!Se.length)return{SheetNames:ce,Sheets:le};for(var Ee={},Ae=[],He=0;He<Se.length;++He)le[ce[He]]?(Ae.push(Se[He]||ce[He]),Ee[Se[He]]=le[Se[He]]||le[ce[He]]):(Ae.push(Se[He]),Ee[Se[He]]={"!ref":"A1"});return{SheetNames:Ae,Sheets:Ee}}function n(R,U){var q=U||{};if(+q.codepage>=0&&ac(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var Q=Co(),se=pn(R["!ref"]),X=Array.isArray(R),ie=[];Jt(Q,0,a(1030)),Jt(Q,6,c(se));for(var le=Math.min(se.e.r,8191),ce=se.s.r;ce<=le;++ce)for(var Se=Xs(ce),re=se.s.c;re<=se.e.c;++re){ce===se.s.r&&(ie[re]=bs(re));var ge=ie[re]+Se,Ee=X?(R[ce]||[])[re]:R[ge];if(!(!Ee||Ee.t=="z"))if(Ee.t=="n")(Ee.v|0)==Ee.v&&Ee.v>=-32768&&Ee.v<=32767?Jt(Q,13,p(ce,re,Ee.v)):Jt(Q,14,v(ce,re,Ee.v));else{var Ae=nd(Ee);Jt(Q,15,h(ce,re,Ae.slice(0,239)))}}return Jt(Q,1),Q.end()}function s(R,U){var q=U||{};if(+q.codepage>=0&&ac(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var Q=Co();Jt(Q,0,i(R));for(var se=0,X=0;se<R.SheetNames.length;++se)(R.Sheets[R.SheetNames[se]]||{})["!ref"]&&Jt(Q,27,M(R.SheetNames[se],X++));var ie=0;for(se=0;se<R.SheetNames.length;++se){var le=R.Sheets[R.SheetNames[se]];if(!(!le||!le["!ref"])){for(var ce=pn(le["!ref"]),Se=Array.isArray(le),re=[],ge=Math.min(ce.e.r,8191),Ee=ce.s.r;Ee<=ge;++Ee)for(var Ae=Xs(Ee),He=ce.s.c;He<=ce.e.c;++He){Ee===ce.s.r&&(re[He]=bs(He));var Be=re[He]+Ae,Rt=Se?(le[Ee]||[])[He]:le[Be];if(!(!Rt||Rt.t=="z"))if(Rt.t=="n")Jt(Q,23,I(Ee,He,ie,Rt.v));else{var et=nd(Rt);Jt(Q,22,F(Ee,He,ie,et.slice(0,239)))}}++ie}}return Jt(Q,1),Q.end()}function a(R){var U=_t(2);return U.write_shift(2,R),U}function i(R){var U=_t(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var q=0,Q=0,se=0,X=0;X<R.SheetNames.length;++X){var ie=R.SheetNames[X],le=R.Sheets[ie];if(!(!le||!le["!ref"])){++se;var ce=To(le["!ref"]);q<ce.e.r&&(q=ce.e.r),Q<ce.e.c&&(Q=ce.e.c)}}return q>8191&&(q=8191),U.write_shift(2,q),U.write_shift(1,se),U.write_shift(1,Q),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function o(R,U,q){var Q={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&q.qpro?(Q.s.c=R.read_shift(1),R.l++,Q.s.r=R.read_shift(2),Q.e.c=R.read_shift(1),R.l++,Q.e.r=R.read_shift(2),Q):(Q.s.c=R.read_shift(2),Q.s.r=R.read_shift(2),U==12&&q.qpro&&(R.l+=2),Q.e.c=R.read_shift(2),Q.e.r=R.read_shift(2),U==12&&q.qpro&&(R.l+=2),Q.s.c==65535&&(Q.s.c=Q.e.c=Q.s.r=Q.e.r=0),Q)}function c(R){var U=_t(8);return U.write_shift(2,R.s.c),U.write_shift(2,R.s.r),U.write_shift(2,R.e.c),U.write_shift(2,R.e.r),U}function u(R,U,q){var Q=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(Q[0].c=R.read_shift(1),Q[3]=R.read_shift(1),Q[0].r=R.read_shift(2),R.l+=2):(Q[2]=R.read_shift(1),Q[0].c=R.read_shift(2),Q[0].r=R.read_shift(2)),Q}function d(R,U,q){var Q=R.l+U,se=u(R,U,q);if(se[1].t="s",q.vers==20768){R.l++;var X=R.read_shift(1);return se[1].v=R.read_shift(X,"utf8"),se}return q.qpro&&R.l++,se[1].v=R.read_shift(Q-R.l,"cstr"),se}function h(R,U,q){var Q=_t(7+q.length);Q.write_shift(1,255),Q.write_shift(2,U),Q.write_shift(2,R),Q.write_shift(1,39);for(var se=0;se<Q.length;++se){var X=q.charCodeAt(se);Q.write_shift(1,X>=128?95:X)}return Q.write_shift(1,0),Q}function g(R,U,q){var Q=u(R,U,q);return Q[1].v=R.read_shift(2,"i"),Q}function p(R,U,q){var Q=_t(7);return Q.write_shift(1,255),Q.write_shift(2,U),Q.write_shift(2,R),Q.write_shift(2,q,"i"),Q}function x(R,U,q){var Q=u(R,U,q);return Q[1].v=R.read_shift(8,"f"),Q}function v(R,U,q){var Q=_t(13);return Q.write_shift(1,255),Q.write_shift(2,U),Q.write_shift(2,R),Q.write_shift(8,q,"f"),Q}function w(R,U,q){var Q=R.l+U,se=u(R,U,q);if(se[1].v=R.read_shift(8,"f"),q.qpro)R.l=Q;else{var X=R.read_shift(2);N(R.slice(R.l,R.l+X),se),R.l+=X}return se}function C(R,U,q){var Q=U&32768;return U&=-32769,U=(Q?R:0)+(U>=8192?U-16384:U),(Q?"":"$")+(q?bs(U):Xs(U))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(R,U){oi(R,0);for(var q=[],Q=0,se="",X="",ie="",le="";R.l<R.length;){var ce=R[R.l++];switch(ce){case 0:q.push(R.read_shift(8,"f"));break;case 1:X=C(U[0].c,R.read_shift(2),!0),se=C(U[0].r,R.read_shift(2),!1),q.push(X+se);break;case 2:{var Se=C(U[0].c,R.read_shift(2),!0),re=C(U[0].r,R.read_shift(2),!1);X=C(U[0].c,R.read_shift(2),!0),se=C(U[0].r,R.read_shift(2),!1),q.push(Se+re+":"+X+se)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(R.read_shift(2));break;case 6:{for(var ge="";ce=R[R.l++];)ge+=String.fromCharCode(ce);q.push('"'+ge.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:le=q.pop(),ie=q.pop(),q.push(["AND","OR"][ce-20]+"("+ie+","+le+")");break;default:if(ce<32&&b[ce])le=q.pop(),ie=q.pop(),q.push(ie+b[ce]+le);else if(k[ce]){if(Q=k[ce][1],Q==69&&(Q=R[R.l++]),Q>q.length){console.error("WK1 bad formula parse 0x"+ce.toString(16)+":|"+q.join("|")+"|");return}var Ee=q.slice(-Q);q.length-=Q,q.push(k[ce][0]+"("+Ee.join(",")+")")}else return ce<=7?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=24?console.error("WK1 unsupported op "+ce.toString(16)):ce<=30?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=115?console.error("WK1 unsupported function opcode "+ce.toString(16)):console.error("WK1 unrecognized opcode "+ce.toString(16))}}q.length==1?U[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function E(R){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=R.read_shift(2),U[3]=R[R.l++],U[0].c=R[R.l++],U}function P(R,U){var q=E(R);return q[1].t="s",q[1].v=R.read_shift(U-4,"cstr"),q}function F(R,U,q,Q){var se=_t(6+Q.length);se.write_shift(2,R),se.write_shift(1,q),se.write_shift(1,U),se.write_shift(1,39);for(var X=0;X<Q.length;++X){var ie=Q.charCodeAt(X);se.write_shift(1,ie>=128?95:ie)}return se.write_shift(1,0),se}function A(R,U){var q=E(R);q[1].v=R.read_shift(2);var Q=q[1].v>>1;if(q[1].v&1)switch(Q&7){case 0:Q=(Q>>3)*5e3;break;case 1:Q=(Q>>3)*500;break;case 2:Q=(Q>>3)/20;break;case 3:Q=(Q>>3)/200;break;case 4:Q=(Q>>3)/2e3;break;case 5:Q=(Q>>3)/2e4;break;case 6:Q=(Q>>3)/16;break;case 7:Q=(Q>>3)/64;break}return q[1].v=Q,q}function j(R,U){var q=E(R),Q=R.read_shift(4),se=R.read_shift(4),X=R.read_shift(2);if(X==65535)return Q===0&&se===3221225472?(q[1].t="e",q[1].v=15):Q===0&&se===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var ie=X&32768;return X=(X&32767)-16446,q[1].v=(1-ie*2)*(se*Math.pow(2,X+32)+Q*Math.pow(2,X)),q}function I(R,U,q,Q){var se=_t(14);if(se.write_shift(2,R),se.write_shift(1,q),se.write_shift(1,U),Q==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var X=0,ie=0,le=0,ce=0;return Q<0&&(X=1,Q=-Q),ie=Math.log2(Q)|0,Q/=Math.pow(2,ie-31),ce=Q>>>0,(ce&2147483648)==0&&(Q/=2,++ie,ce=Q>>>0),Q-=ce,ce|=2147483648,ce>>>=0,Q*=Math.pow(2,32),le=Q>>>0,se.write_shift(4,le),se.write_shift(4,ce),ie+=16383+(X?32768:0),se.write_shift(2,ie),se}function B(R,U){var q=j(R);return R.l+=U-14,q}function Y(R,U){var q=E(R),Q=R.read_shift(4);return q[1].v=Q>>6,q}function Z(R,U){var q=E(R),Q=R.read_shift(8,"f");return q[1].v=Q,q}function ae(R,U){var q=Z(R);return R.l+=U-10,q}function ee(R,U){return R[R.l+U-1]==0?R.read_shift(U,"cstr"):""}function ne(R,U){var q=R[R.l++];q>U-1&&(q=U-1);for(var Q="";Q.length<q;)Q+=String.fromCharCode(R[R.l++]);return Q}function L(R,U,q){if(!(!q.qpro||U<21)){var Q=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var se=R.read_shift(U-21,"cstr");return[Q,se]}}function H(R,U){for(var q={},Q=R.l+U;R.l<Q;){var se=R.read_shift(2);if(se==14e3){for(q[se]=[0,""],q[se][0]=R.read_shift(2);R[R.l];)q[se][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return q}function M(R,U){var q=_t(5+R.length);q.write_shift(2,14e3),q.write_shift(2,U);for(var Q=0;Q<R.length;++Q){var se=R.charCodeAt(Q);q[q.l++]=se>127?95:se}return q[q.l++]=0,q}var V={0:{n:"BOF",f:aa},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ee},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},W={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:B},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:H},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Y},38:{n:"??"},39:{n:"NUMBER27",f:Z},40:{n:"FORMULA28",f:ae},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:L},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}})();function iue(e){var t={},r=e.match(Ri),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Ir(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=X4[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var oue=(function(){var e=tv("t"),t=tv("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:mn(i[1])},c=a.match(t);return c&&(o.s=iue(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}})(),lue=(function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}})(),cue=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,uue=/<(?:\w+:)?r>/,due=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function w3(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=mn(zn(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=zn(e),r&&(n.h=i3(n.t))):e.match(uue)&&(n.r=zn(e),n.t=mn(zn((e.replace(due,"").match(cue)||[]).join("").replace(Ri,""))),r&&(n.h=lue(oue(n.r)))),n):{t:""}}var fue=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,hue=/<(?:\w+:)?(?:si|sstItem)>/g,gue=/<\/(?:\w+:)?(?:si|sstItem)>/;function mue(e,t){var r=[],n="";if(!e)return r;var s=e.match(fue);if(s){n=s[2].replace(hue,"").split(gue);for(var a=0;a!=n.length;++a){var i=w3(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=Ir(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var pue=/^\s|\s$|[\t\n\r]/;function iU(e,t){if(!t.bookSST)return"";var r=[Js];r[r.length]=Qt("sst",null,{xmlns:A0[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(pue)&&(a+=' xml:space="preserve"'),a+=">"+Rn(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function xue(e){return[e.read_shift(4),e.read_shift(4)]}function yue(e,t){var r=[],n=!1;return dd(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function vue(e,t){return t||(t=_t(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var wue=joe;function bue(e){var t=Co();Ft(t,159,vue(e));for(var r=0;r<e.length;++r)Ft(t,19,wue(e[r]));return Ft(t,160),t.end()}function oU(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Yu(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function _ue(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Yu(e,4),t.U=Yu(e,4),t.W=Yu(e,4),t}function Sue(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function kue(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Sue(e));return t}function Cue(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Tue(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Yu(e,4),t.U=Yu(e,4),t.W=Yu(e,4),t}function Eue(e){var t=Tue(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function lU(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function cU(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Nue(e){var t=Yu(e);switch(t.Minor){case 2:return[t.Minor,Aue(e)];case 3:return[t.Minor,jue()];case 4:return[t.Minor,Pue(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Aue(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=lU(e,r),s=cU(e,e.length-e.l);return{t:"Std",h:n,v:s}}function jue(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Pue(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Ri,function(a){var i=Ir(a);switch(ru(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Fue(e,t){var r={},n=r.EncryptionVersionInfo=Yu(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=lU(e,s),t-=s,r.EncryptionVerifier=cU(e,t),r}function Oue(e){var t={},r=t.EncryptionVersionInfo=Yu(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function b3(e){var t=0,r,n=oU(e),s=n.length+1,a,i,o,c,u;for(r=Tf(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=(t&16384)===0?0:1,c=t<<1&32767,u=o|c,t=u^i;return t^52811}var uU=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],c=104,u=i.length-1;u>=0;--u)for(var d=i[u],h=0;h!=7;++h)d&64&&(o^=r[c]),d*=2,--c;return o};return function(i){for(var o=oU(i),c=a(o),u=o.length,d=Tf(16),h=0;h!=16;++h)d[h]=0;var g,p,x;for((u&1)===1&&(g=c>>8,d[u]=s(e[0],g),--u,g=c&255,p=o[o.length-1],d[u]=s(p,g));u>0;)--u,g=c>>8,d[u]=s(o[u],g),--u,g=c&255,d[u]=s(o[u],g);for(u=15,x=15-o.length;x>0;)g=c>>8,d[u]=s(e[x],g),--u,--x,g=c&255,d[u]=s(o[u],g),--u,--x;return d}})(),Due=function(e,t,r,n,s){s||(s=t),n||(n=uU(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},Iue=function(e){var t=0,r=uU(e);return function(n){var s=Due("",n,t,r);return t=s[1],s[0]}};function Rue(e,t,r,n){var s={key:aa(e),verificationBytes:aa(e)};return r.password&&(s.verifier=b3(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=Iue(r.password)),s}function Mue(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Oue(e):n.Data=Fue(e,t),n}function Lue(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Mue(e,t-2,n):Rue(e,r.biff>=8?t:t-2,r,n),n}var dU=(function(){function e(s,a){switch(a.type){case"base64":return t(Yo(s),a);case"binary":return t(s,a);case"buffer":return t(en&&Buffer.isBuffer(s)?s.toString("binary"):Lf(s),a);case"array":return t(g0(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var g=/\\\w+\b/g,p=0,x,v=-1;x=g.exec(d);){switch(x[0]){case"\\cell":var w=d.slice(p,g.lastIndex-x[0].length);if(w[0]==" "&&(w=w.slice(1)),++v,w.length){var C={v:w,t:"s"};Array.isArray(o)?o[h][v]=C:o[Or({r:h,c:v})]=C}break}p=g.lastIndex}v>u.e.c&&(u.e.c=v)}),o["!ref"]=Xr(u),o}function r(s,a){return Bf(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=pn(s["!ref"]),o,c=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var h=Or({r:u,c:d});o=c?(s[u]||[])[d]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(nd(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function Bue(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function av(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function $ue(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,c=0,u=s+a;switch(c=i/(u>1?2-u:u),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,c,u/2]}function Uue(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-o),i[0]+=c,i[1]+=s;break;case 2:c=s*(o-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-o),i[1]+=c,i[2]+=s;break;case 4:c=s*(o-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-o),i[2]+=c,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function Kb(e,t){if(t===0)return e;var r=$ue(Bue(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),av(Uue(r))}var fU=6,zue=15,Wue=1,Ei=fU;function iv(e){return Math.floor((e+Math.round(128/Ei)/256)*Ei)}function ov(e){return Math.floor((e-5)/Ei*100+.5)/100}function qb(e){return Math.round((e*Ei+5)/Ei*256)/256}function kk(e){return qb(ov(iv(e)))}function _3(e){var t=Math.abs(e-kk(e)),r=Ei;if(t>.005)for(Ei=Wue;Ei<zue;++Ei)Math.abs(e-kk(e))<=t&&(t=Math.abs(e-kk(e)),r=Ei);Ei=r}function Ef(e){e.width?(e.wpx=iv(e.width),e.wch=ov(e.wpx),e.MDW=Ei):e.wpx?(e.wch=ov(e.wpx),e.width=qb(e.wch),e.MDW=Ei):typeof e.wch=="number"&&(e.width=qb(e.wch),e.wpx=iv(e.width),e.MDW=Ei),e.customWidth&&delete e.customWidth}var Hue=96,hU=Hue;function lv(e){return e*96/hU}function Em(e){return e*hU/96}var Gue={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Vue(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Ri)||[]).forEach(function(i){var o=Ir(i);switch(ru(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=ns(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=ns(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function Kue(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Ri)||[]).forEach(function(i){var o=Ir(i);switch(ru(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function que(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Ri)||[]).forEach(function(i){var o=Ir(i);switch(ru(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=zn(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?ns(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?ns(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?ns(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?ns(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?ns(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?ns(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?ns(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=X4[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=ns(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=Gh[s.color.index];s.color.index==81&&(c=Gh[1]),c||(c=Gh[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Kb(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function Yue(e,t,r){t.NumberFmt=[];for(var n=Ls(jr),s=0;s<n.length;++s)t.NumberFmt[n[s]]=jr[n[s]];var a=e[0].match(Ri);if(a)for(s=0;s<a.length;++s){var i=Ir(a[s]);switch(ru(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=mn(zn(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}qu(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function Xue(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Qt("numFmt",null,{numFmtId:n,formatCode:Rn(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Qt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Pw=["numFmtId","fillId","fontId","borderId","xfId"],Fw=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Que(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Ri)||[]).forEach(function(a){var i=Ir(a),o=0;switch(ru(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Pw.length;++o)n[Pw[o]]&&(n[Pw[o]]=parseInt(n[Pw[o]],10));for(o=0;o<Fw.length;++o)n[Fw[o]]&&(n[Fw[o]]=ns(n[Fw[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=ns(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function Jue(e){var t=[];return t[t.length]=Qt("cellXfs",null),e.forEach(function(r){t[t.length]=Qt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Qt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Zue=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&Yue(h,d,u),(h=o.match(s))&&que(h,d,c,u),(h=o.match(n))&&Kue(h,d,c,u),(h=o.match(a))&&Vue(h,d,c,u),(h=o.match(r))&&Que(h,d,u),d}})();function gU(e,t){var r=[Js,Qt("styleSheet",null,{xmlns:A0[0],"xmlns:vt":ba.vt})],n;return e.SSF&&(n=Xue(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Jue(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function ede(e,t){var r=e.read_shift(2),n=Oi(e);return[r,n]}function tde(e,t,r){r||(r=_t(6+4*t.length)),r.write_shift(2,e),$a(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function rde(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=Moe(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Roe(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Oi(e),n}function nde(e,t){t||(t=_t(153)),t.write_shift(2,e.sz*20),Loe(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Hb(e.color,t);var n=0;return n=2,t.write_shift(1,n),$a(e.name,t),t.length>t.l?t.slice(0,t.l):t}var sde=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ck,ade=Ii;function wO(e,t){t||(t=_t(84)),Ck||(Ck=i2(sde));var r=Ck[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Hb({auto:1},t),Hb({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function ide(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function mU(e,t,r){r||(r=_t(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Qx(e,t){return t||(t=_t(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var ode=Ii;function lde(e,t){return t||(t=_t(51)),t.write_shift(1,0),Qx(null,t),Qx(null,t),Qx(null,t),Qx(null,t),Qx(null,t),t.length>t.l?t.slice(0,t.l):t}function cde(e,t){return t||(t=_t(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Wb(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function ude(e,t,r){var n=_t(2052);return n.write_shift(4,e),Wb(t,n),Wb(r,n),n.length>n.l?n.slice(0,n.l):n}function dde(e,t,r){var n={};n.NumberFmt=[];for(var s in jr)n.NumberFmt[s]=jr[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return dd(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],qu(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Kb(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function fde(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(Ft(e,615,cc(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Ft(e,44,tde(s,t[s]))}),Ft(e,616))}}function hde(e){var t=1;Ft(e,611,cc(t)),Ft(e,43,nde({sz:12,color:{theme:1},name:"Calibri",family:2})),Ft(e,612)}function gde(e){var t=2;Ft(e,603,cc(t)),Ft(e,45,wO({patternType:"none"})),Ft(e,45,wO({patternType:"gray125"})),Ft(e,604)}function mde(e){var t=1;Ft(e,613,cc(t)),Ft(e,46,lde()),Ft(e,614)}function pde(e){var t=1;Ft(e,626,cc(t)),Ft(e,47,mU({numFmtId:0},65535)),Ft(e,627)}function xde(e,t){Ft(e,617,cc(t.length)),t.forEach(function(r){Ft(e,47,mU(r,0))}),Ft(e,618)}function yde(e){var t=1;Ft(e,619,cc(t)),Ft(e,48,cde({xfId:0,name:"Normal"})),Ft(e,620)}function vde(e){var t=0;Ft(e,505,cc(t)),Ft(e,506)}function wde(e){var t=0;Ft(e,508,ude(t,"TableStyleMedium9","PivotStyleMedium4")),Ft(e,509)}function bde(e,t){var r=Co();return Ft(r,278),fde(r,e.SSF),hde(r),gde(r),mde(r),pde(r),xde(r,t.cellXfs),yde(r),vde(r),wde(r),Ft(r,279),r.end()}var _de=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Sde(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Ri)||[]).forEach(function(s){var a=Ir(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[_de.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function kde(){}function Cde(){}var Tde=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Ede=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Nde=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Ade(e,t,r){t.themeElements={};var n;[["clrScheme",Tde,Sde],["fontScheme",Ede,kde],["fmtScheme",Nde,Cde]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var jde=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function pU(e,t){(!e||e.length===0)&&(e=S3());var r,n={};if(!(r=e.match(jde)))throw new Error("themeElements not found in theme");return Ade(r[0],n,t),n.raw=e,n}function S3(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Js];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Pde(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=l$(a,{type:"array"})}catch{return}var o=Go(i,"theme/theme/theme1.xml",!0);if(o)return pU(o,r)}}function Fde(e){return e.read_shift(4)}function Ode(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Dde(e,4);break;case 2:t.xclrValue=Y$(e);break;case 3:t.xclrValue=Fde(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Dde(e,t){return Ii(e,t)}function Ide(e,t){return Ii(e,t)}function Rde(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Ode(e);break;case 6:n[1]=Ide(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Mde(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(Rde(e,r-e.l));return{ixfe:n,ext:a}}function Lde(e,t){t.forEach(function(r){r[0]})}function Bde(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Oi(e)}}function $de(e){var t=_t(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),$a(e.name,t),t.slice(0,t.l)}function Ude(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function zde(e){var t=_t(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Wde(e,t){var r=_t(8+2*t.length);return r.write_shift(4,e),$a(t,r),r.slice(0,r.l)}function Hde(e){return e.l+=4,e.read_shift(4)!=0}function Gde(e,t){var r=_t(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Vde(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return dd(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function Kde(){var e=Co();return Ft(e,332),Ft(e,334,cc(1)),Ft(e,335,$de({name:"XLDAPR",version:12e4,flags:3496657072})),Ft(e,336),Ft(e,339,Wde(1,"XLDAPR")),Ft(e,52),Ft(e,35,cc(514)),Ft(e,4096,cc(0)),Ft(e,4097,vl(1)),Ft(e,36),Ft(e,53),Ft(e,340),Ft(e,337,Gde(1)),Ft(e,51,zde([[1,0]])),Ft(e,338),Ft(e,333),e.end()}function qde(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(Ri,function(o){var c=Ir(o);switch(ru(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function xU(){var e=[Js];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Yde(e){var t=[];if(!e)return t;var r=1;return(e.match(Ri)||[]).forEach(function(n){var s=Ir(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function Xde(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Or(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Qde(e,t,r){var n=[];return dd(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function Jde(e,t,r,n){if(!e)return e;var s=n||{},a=!1;dd(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function Zde(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var tm=1024;function yU(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Qt("xml",null,{"xmlns:v":Uo.v,"xmlns:o":Uo.o,"xmlns:x":Uo.x,"xmlns:mv":Uo.mv}).replace(/\/>/,">"),Qt("o:shapelayout",Qt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Qt("v:shapetype",[Qt("v:stroke",null,{joinstyle:"miter"}),Qt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];tm<e*1e3;)tm+=1e3;return t.forEach(function(a){var i=_s(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Qt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Qt("v:fill",c,o),d={on:"t",obscured:"t"};++tm,s=s.concat(["<v:shape"+rv({id:"_x0000_s"+tm,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Qt("v:shadow",null,d),Qt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ui("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),ui("x:AutoFill","False"),ui("x:Row",String(i.r)),ui("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function bO(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=_s(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var c=pn(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=Xr(c);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var h=a.c.length-1;h>=0;--h){if(!r&&a.c[h].T)return;r&&!a.c[h].T&&a.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(d.a==n[h].id){d.a=n[h].name||d.a;break}}a.c.push(d)})}function efe(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Ir(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=_s(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var h=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!h&&!!h[1]&&w3(h[1])||{r:"",t:"",h:""};u.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),u.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=g.h),n.push(u)}}}}),n}function vU(e){var t=[Js,Qt("comments",null,{xmlns:A0[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=Rn(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(Rn(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(ui("t",Rn(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(ui("t",Rn(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function tfe(e,t){var r=[],n=!1,s={},a=0;return e.replace(Ri,function(o,c){var u=Ir(o);switch(ru(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+o.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function rfe(e,t,r){var n=[Js,Qt("ThreadedComments",null,{xmlns:ba.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(Qt("threadedComment",ui("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function nfe(e,t){var r=[],n=!1;return e.replace(Ri,function(a){var i=Ir(a);switch(ru(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function sfe(e){var t=[Js,Qt("personList",null,{xmlns:ba.TCMNT,"xmlns:x":A0[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Qt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function afe(e){var t={};t.iauthor=e.read_shift(4);var r=O0(e);return t.rfx=r.s,t.ref=Or(r.s),e.l+=16,t}function ife(e,t){return t==null&&(t=_t(36)),t.write_shift(4,e[1].iauthor),tp(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var ofe=Oi;function lfe(e){return $a(e.slice(0,54))}function cfe(e,t){var r=[],n=[],s={},a=!1;return dd(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function ufe(e){var t=Co(),r=[];return Ft(t,628),Ft(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Ft(t,632,lfe(s.a)))})}),Ft(t,631),Ft(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:_s(n[0]),e:_s(n[0])};Ft(t,635,ife([a,s])),s.t&&s.t.length>0&&Ft(t,637,Foe(s)),Ft(t,636),delete s.iauthor})}),Ft(t,634),Ft(t,629),t.end()}var dfe="application/vnd.ms-office.vbaProject";function ffe(e){var t=Tr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Tr.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Tr.write(t)}function hfe(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Tr.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var wU=["xlsb","xlsm","xlam","biff8","xla"];function gfe(){return{"!type":"dialog"}}function mfe(){return{"!type":"dialog"}}function pfe(){return{"!type":"macro"}}function xfe(){return{"!type":"macro"}}var fm=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,s+(o?"":"$")+bs(d)+(c?"":"$")+Xs(u)}return function(s,a){return t=a,s.replace(e,r)}})(),k3=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,C3=(function(){return function(t,r){return t.replace(k3,function(n,s,a,i,o,c){var u=d3(i)-(a?0:r.c),d=u3(c)-(o?0:r.r),h=d==0?"":o?d+1:"["+d+"]",g=u==0?"":a?u+1:"["+u+"]";return s+"R"+h+"C"+g})}})();function bU(e,t){return e.replace(k3,function(r,n,s,a,i,o){return n+(s=="$"?s+a:bs(d3(a)+t.c))+(i=="$"?i+o:Xs(u3(o)+t.r))})}function yfe(e,t,r){var n=To(t),s=n.s,a=_s(r),i={r:a.r-s.r,c:a.c-s.c};return bU(e,i)}function vfe(e){return e.length!=1}function _O(e){return e.replace(/_xlfn\./g,"")}function na(e){e.l+=1}function Nf(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function _U(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return SU(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=Nf(e),o=Nf(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function SU(e){var t=Nf(e),r=Nf(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function wfe(e,t,r){if(r.biff<8)return SU(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Nf(e),i=Nf(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function kU(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return bfe(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Nf(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function bfe(e){var t=Nf(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function _fe(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Sfe(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return kfe(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function kfe(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function Cfe(e,t,r){var n=(e[e.l++]&96)>>5,s=_U(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function Tfe(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=_U(e,a,r);return[n,s,i]}function Efe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Nfe(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function Afe(e,t,r){var n=(e[e.l++]&96)>>5,s=wfe(e,t-1,r);return[n,s]}function jfe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function SO(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Pfe(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function Ffe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Ofe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Dfe(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Ife(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function CU(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Rfe(e){return e.read_shift(2),CU(e)}function Mfe(e){return e.read_shift(2),CU(e)}function Lfe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=kU(e,0,r);return[n,s]}function Bfe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=Sfe(e,0,r);return[n,s]}function $fe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=kU(e,0,r);return[n,s,a]}function Ufe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[Hhe[s],NU[s],n]}function zfe(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Wfe(e);return[s,(a[0]===0?NU:Whe)[a[1]]]}function Wfe(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Hfe(e,t,r){e.l+=r&&r.biff==2?3:4}function Gfe(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Vfe(e){return e.l++,fd[e.read_shift(1)]}function Kfe(e){return e.l++,e.read_shift(2)}function qfe(e){return e.l++,e.read_shift(1)!==0}function Yfe(e){return e.l++,Ai(e)}function Xfe(e,t,r){return e.l++,Vv(e,t-1,r)}function Qfe(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ks(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=fd[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ai(e);break;case 2:r[1]=D0(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Jfe(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?O0:c2)(e));return s}function Zfe(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=Qfe(e,r.biff);return i}function ehe(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function the(e,t,r){if(r.biff==5)return rhe(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function rhe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function nhe(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function she(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function ahe(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function ihe(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var ohe=Ii,lhe=Ii,che=Ii;function qv(e,t,r){return e.l+=2,[_fe(e)]}function T3(e){return e.l+=6,[]}var uhe=qv,dhe=T3,fhe=T3,hhe=qv;function TU(e){return e.l+=2,[aa(e),e.read_shift(2)&1]}var ghe=qv,mhe=TU,phe=T3,xhe=qv,yhe=qv,vhe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function whe(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=vhe[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function bhe(e){return e.l+=2,[e.read_shift(4)]}function _he(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function She(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function khe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Che(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function The(e){return e.l+=4,[0,0]}var kO={1:{n:"PtgExp",f:Gfe},2:{n:"PtgTbl",f:che},3:{n:"PtgAdd",f:na},4:{n:"PtgSub",f:na},5:{n:"PtgMul",f:na},6:{n:"PtgDiv",f:na},7:{n:"PtgPower",f:na},8:{n:"PtgConcat",f:na},9:{n:"PtgLt",f:na},10:{n:"PtgLe",f:na},11:{n:"PtgEq",f:na},12:{n:"PtgGe",f:na},13:{n:"PtgGt",f:na},14:{n:"PtgNe",f:na},15:{n:"PtgIsect",f:na},16:{n:"PtgUnion",f:na},17:{n:"PtgRange",f:na},18:{n:"PtgUplus",f:na},19:{n:"PtgUminus",f:na},20:{n:"PtgPercent",f:na},21:{n:"PtgParen",f:na},22:{n:"PtgMissArg",f:na},23:{n:"PtgStr",f:Xfe},26:{n:"PtgSheet",f:_he},27:{n:"PtgEndSheet",f:She},28:{n:"PtgErr",f:Vfe},29:{n:"PtgBool",f:qfe},30:{n:"PtgInt",f:Kfe},31:{n:"PtgNum",f:Yfe},32:{n:"PtgArray",f:jfe},33:{n:"PtgFunc",f:Ufe},34:{n:"PtgFuncVar",f:zfe},35:{n:"PtgName",f:ehe},36:{n:"PtgRef",f:Lfe},37:{n:"PtgArea",f:Cfe},38:{n:"PtgMemArea",f:nhe},39:{n:"PtgMemErr",f:ohe},40:{n:"PtgMemNoMem",f:lhe},41:{n:"PtgMemFunc",f:she},42:{n:"PtgRefErr",f:ahe},43:{n:"PtgAreaErr",f:Efe},44:{n:"PtgRefN",f:Bfe},45:{n:"PtgAreaN",f:Afe},46:{n:"PtgMemAreaN",f:khe},47:{n:"PtgMemNoMemN",f:Che},57:{n:"PtgNameX",f:the},58:{n:"PtgRef3d",f:$fe},59:{n:"PtgArea3d",f:Tfe},60:{n:"PtgRefErr3d",f:ihe},61:{n:"PtgAreaErr3d",f:Nfe},255:{}},Ehe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Nhe={1:{n:"PtgElfLel",f:TU},2:{n:"PtgElfRw",f:xhe},3:{n:"PtgElfCol",f:uhe},6:{n:"PtgElfRwV",f:yhe},7:{n:"PtgElfColV",f:hhe},10:{n:"PtgElfRadical",f:ghe},11:{n:"PtgElfRadicalS",f:phe},13:{n:"PtgElfColS",f:dhe},15:{n:"PtgElfColSV",f:fhe},16:{n:"PtgElfRadicalLel",f:mhe},25:{n:"PtgList",f:whe},29:{n:"PtgSxName",f:bhe},255:{}},Ahe={0:{n:"PtgAttrNoop",f:The},1:{n:"PtgAttrSemi",f:Ife},2:{n:"PtgAttrIf",f:Ofe},4:{n:"PtgAttrChoose",f:Pfe},8:{n:"PtgAttrGoto",f:Ffe},16:{n:"PtgAttrSum",f:Hfe},32:{n:"PtgAttrBaxcel",f:SO},33:{n:"PtgAttrBaxcel",f:SO},64:{n:"PtgAttrSpace",f:Rfe},65:{n:"PtgAttrSpaceSemi",f:Mfe},128:{n:"PtgAttrIfError",f:Dfe},255:{}};function Yv(e,t,r,n){if(n.biff<8)return Ii(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Zfe(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Jfe(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Ii(e,t)),a}function Xv(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=kO[a]||kO[Ehe[a]],(a===24||a===25)&&(s=(a===24?Nhe:Ahe)[e[e.l+1]]),!s||!s.f?Ii(e,t):i.push([s.n,s.f(e,t,r)]);return i}function jhe(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var Phe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Fhe(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function EU(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function CO(e,t,r){var n=EU(e,t,r);return n=="#REF"?n:Fhe(n,r)}function Ti(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],c,u,d,h=0,g=0,p,x="";if(!e[0]||!e[0][0])return"";for(var v=-1,w="",C=0,k=e[0].length;C<k;++C){var b=e[0][C];switch(b[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),v>=0){switch(e[0][v][1][0]){case 0:w=Ds(" ",e[0][v][1][1]);break;case 1:w=Ds("\r",e[0][v][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}u=u+w,v=-1}o.push(u+Phe[b[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Cy(b[1][1],i,s),o.push(Ty(d,a));break;case"PtgRefN":d=r?Cy(b[1][1],r,s):b[1][1],o.push(Ty(d,a));break;case"PtgRef3d":h=b[1][1],d=Cy(b[1][2],i,s),x=CO(n,h,s),o.push(x+"!"+Ty(d,a));break;case"PtgFunc":case"PtgFuncVar":var N=b[1][0],E=b[1][1];N||(N=0),N&=127;var P=N==0?[]:o.slice(-N);o.length-=N,E==="User"&&(E=P.shift()),o.push(E+"("+P.join(",")+")");break;case"PtgBool":o.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(b[1]);break;case"PtgNum":o.push(String(b[1]));break;case"PtgStr":o.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(b[1]);break;case"PtgAreaN":p=eO(b[1][1],r?{s:r}:i,s),o.push(bk(p,s));break;case"PtgArea":p=eO(b[1][1],i,s),o.push(bk(p,s));break;case"PtgArea3d":h=b[1][1],p=b[1][2],x=CO(n,h,s),o.push(x+"!"+bk(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=b[1][2];var F=(n.names||[])[g-1]||(n[0]||[])[g],A=F?F.Name:"SH33TJSNAME"+String(g);A&&A.slice(0,6)=="_xlfn."&&!s.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var j=b[1][1];g=b[1][2];var I;if(s.biff<=5)j<0&&(j=-j),n[j]&&(I=n[j][g]);else{var B="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][g]&&n[j][g].itab>0&&(B=n.SheetNames[n[j][g].itab-1]+"!"):B=n.SheetNames[g-1]+"!"),n[j]&&n[j][g])B+=n[j][g].Name;else if(n[0]&&n[0][g])B+=n[0][g].Name;else{var Y=(EU(n,j,s)||"").split(";;");Y[g-1]?B=Y[g-1]:B+="SH33TJSERRX"}o.push(B);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var Z="(",ae=")";if(v>=0){switch(w="",e[0][v][1][0]){case 2:Z=Ds(" ",e[0][v][1][1])+Z;break;case 3:Z=Ds("\r",e[0][v][1][1])+Z;break;case 4:ae=Ds(" ",e[0][v][1][1])+ae;break;case 5:ae=Ds("\r",e[0][v][1][1])+ae;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}o.push(Z+o.pop()+ae);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:b[1][1],r:b[1][0]};var ee={c:r.c,r:r.r};if(n.sharedf[Or(d)]){var ne=n.sharedf[Or(d)];o.push(Ti(ne,i,ee,n,s))}else{var L=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Ti(u[1],i,ee,n,s)),L=!0;break}L||o.push(b[1])}break;case"PtgArray":o.push("{"+jhe(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var H=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&H.indexOf(e[0][C][0])==-1){b=e[0][v];var M=!0;switch(b[1][0]){case 4:M=!1;case 0:w=Ds(" ",b[1][1]);break;case 5:M=!1;case 1:w=Ds("\r",b[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}o.push((M?w:"")+o.pop()+(M?"":w)),v=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function Ohe(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Ii(e,t-2)];var o=Xv(e,i,r);return t!==i+s&&(a=Yv(e,t-i-s,o,r)),e.l=n,[o,a]}function Dhe(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Ii(e,t-2)];var o=Xv(e,i,r);return t!==i+s&&(a=Yv(e,t-i-s,o,r)),e.l=n,[o,a]}function Ihe(e,t,r,n){var s=e.l+t,a=Xv(e,n,r),i;return s!==e.l&&(i=Yv(e,s-e.l,a,r)),[a,i]}function Rhe(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=Xv(e,a,r);return a==65535?[[],Ii(e,t-2)]:(t!==a+2&&(s=Yv(e,n-a-2,i,r)),[i,s])}function Mhe(e){var t;if(Wu(e,e.l+6)!==65535)return[Ai(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Lhe(e){if(e==null){var t=_t(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return m0(e);return m0(0)}function Tk(e,t,r){var n=e.l+t,s=nu(e);r.biff==2&&++e.l;var a=Mhe(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Dhe(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function Bhe(e,t,r,n,s){var a=x0(t,r,s),i=Lhe(e.v),o=_t(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=_t(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var h=La([a,i,o,u]);return h}function u2(e,t,r){var n=e.read_shift(4),s=Xv(e,n,r),a=e.read_shift(4),i=a>0?Yv(e,a,s,r):null;return[s,i]}var $he=u2,d2=u2,Uhe=u2,zhe=u2,Whe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},NU={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Hhe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function TO(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Ghe(e){var t="of:="+e.replace(k3,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Ek(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Vhe(e){return e.replace(/\./,"!")}var Ny={},hm={},Ay=typeof Map<"u";function E3(e,t,r){var n=0,s=e.length;if(r){if(Ay?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Ay?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Ay?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function f2(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Ei=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ov(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=qb(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function qh(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function $f(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){qu(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function AU(e,t,r,n,s,a){try{n.cellNF&&(e.z=jr[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=is(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(jr[t]==null&&qu(Wie[t]||"General",t),e.t==="e")e.w=e.w||fd[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ev(e.v);else if(e.t==="d"){var i=Sa(e.v);(i|0)===i?e.w=i.toString(10):e.w=ev(i)}else{if(e.v===void 0)return"";e.w=h0(e.v,hm)}else e.t==="d"?e.w=Al(t,Sa(e.v),hm):e.w=Al(t,e.v,hm)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Kb(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Kb(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function Khe(e,t,r){if(e&&e["!ref"]){var n=pn(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function qhe(e,t){var r=pn(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Xr(r))}var Yhe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Xhe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Qhe=/<(?:\w:)?hyperlink [^>]*>/mg,Jhe=/"(\w*:\w*)"/,Zhe=/<(?:\w:)?col\b[^>]*[\/]?>/g,e0e=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,t0e=/<(?:\w:)?pageMargins[^>]*\/>/g,jU=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,r0e=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,n0e=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function s0e(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",h=e.match(Xhe);h?(u=e.slice(0,h.index),d=e.slice(h.index+h[0].length)):u=d=e;var g=u.match(jU);g?N3(g[0],o,s,r):(g=u.match(r0e))&&i0e(g[0],g[1]||"",o,s,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=u.slice(p,p+50).match(Jhe);x&&qhe(o,x[1])}var v=u.match(n0e);v&&v[1]&&v0e(v[1],s);var w=[];if(t.cellStyles){var C=u.match(Zhe);C&&g0e(w,C)}h&&_0e(h[1],o,t,c,a,i);var k=d.match(e0e);k&&(o["!autofilter"]=p0e(k[0]));var b=[],N=d.match(Yhe);if(N)for(p=0;p!=N.length;++p)b[p]=pn(N[p].slice(N[p].indexOf('"')+1));var E=d.match(Qhe);E&&d0e(o,E,n);var P=d.match(t0e);if(P&&(o["!margins"]=f0e(Ir(P[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Xr(c)),t.sheetRows>0&&o["!ref"]){var F=pn(o["!ref"]);t.sheetRows<=+F.e.r&&(F.e.r=t.sheetRows-1,F.e.r>c.e.r&&(F.e.r=c.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>c.e.c&&(F.e.c=c.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Xr(F))}return w.length>0&&(o["!cols"]=w),b.length>0&&(o["!merges"]=b),o}function a0e(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Xr(e[r])+'"/>';return t+"</mergeCells>"}function N3(e,t,r,n){var s=Ir(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=mn(zn(s.codeName)))}function i0e(e,t,r,n,s){N3(e.slice(0,e.indexOf(">")),r,n,s)}function o0e(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=Hc(Rn(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Qt("outlinePr",null,u)}!a&&!o||(s[s.length]=Qt("sheetPr",o,i))}var l0e=["objects","scenarios","selectLockedCells","selectUnlockedCells"],c0e=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function u0e(e){var t={sheet:1};return l0e.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),c0e.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=b3(e.password).toString(16).toUpperCase()),Qt("sheetProtection",null,t)}function d0e(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=Ir(zn(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+mn(a.location))):(a.Target="#"+mn(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=pn(a.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=Or({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function f0e(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function h0e(e){return qh(e),Qt("pageMargins",null,e)}function g0e(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Ir(t[n],!0);s.hidden&&(s.hidden=ns(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,_3(s.width)),Ef(s);a<=i;)e[a++]=os(s)}}function m0e(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Qt("col",null,f2(s,n)));return r[r.length]="</cols>",r.join("")}function p0e(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function x0e(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Xr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=To(s);i.s.r==i.e.r&&(i.e.r=To(t["!ref"]).e.r,s=Xr(i));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Qt("autoFilter",null,{ref:s})}var y0e=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function v0e(e,t){t.Views||(t.Views=[{}]),(e.match(y0e)||[]).forEach(function(r,n){var s=Ir(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),ns(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function w0e(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Qt("sheetViews",Qt("sheetView",null,s),{})}function b0e(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=fd[e.v];break;case"d":n&&n.cellDates?s=is(e.v,-1).toISOString():(e=os(e),e.t="n",s=""+(e.v=Sa(is(e.v)))),typeof e.z>"u"&&(e.z=jr[14]);break;default:s=e.v;break}var o=ui("v",Rn(s)),c={r:t},u=$f(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=ui("v",""+E3(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Qt("f",Rn(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Qt("c",o,c)}var _0e=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=tv("v"),i=tv("f");return function(c,u,d,h,g,p){for(var x=0,v="",w=[],C=[],k=0,b=0,N=0,E="",P,F,A=0,j=0,I,B,Y=0,Z=0,ae=Array.isArray(p.CellXf),ee,ne=[],L=[],H=Array.isArray(u),M=[],V={},W=!1,R=!!d.sheetStubs,U=c.split(t),q=0,Q=U.length;q!=Q;++q){v=U[q].trim();var se=v.length;if(se!==0){var X=0;e:for(x=0;x<se;++x)switch(v[x]){case">":if(v[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(F=Ir(v.slice(X,x),!0),A=F.r!=null?parseInt(F.r,10):A+1,j=-1,d.sheetRows&&d.sheetRows<A)continue;V={},W=!1,F.ht&&(W=!0,V.hpt=parseFloat(F.ht),V.hpx=Em(V.hpt)),F.hidden=="1"&&(W=!0,V.hidden=!0),F.outlineLevel!=null&&(W=!0,V.level=+F.outlineLevel),W&&(M[A-1]=V)}break;case"<":X=x;break}if(X>=x)break;if(F=Ir(v.slice(X,x),!0),A=F.r!=null?parseInt(F.r,10):A+1,j=-1,!(d.sheetRows&&d.sheetRows<A)){h.s.r>A-1&&(h.s.r=A-1),h.e.r<A-1&&(h.e.r=A-1),d&&d.cellStyles&&(V={},W=!1,F.ht&&(W=!0,V.hpt=parseFloat(F.ht),V.hpx=Em(V.hpt)),F.hidden=="1"&&(W=!0,V.hidden=!0),F.outlineLevel!=null&&(W=!0,V.level=+F.outlineLevel),W&&(M[A-1]=V)),w=v.slice(x).split(e);for(var ie=0;ie!=w.length&&w[ie].trim().charAt(0)=="<";++ie);for(w=w.slice(ie),x=0;x!=w.length;++x)if(v=w[x].trim(),v.length!==0){if(C=v.match(r),k=x,b=0,N=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,C!=null&&C.length===2){for(k=0,E=C[1],b=0;b!=E.length&&!((N=E.charCodeAt(b)-64)<1||N>26);++b)k=26*k+N;--k,j=k}else++j;for(b=0;b!=v.length&&v.charCodeAt(b)!==62;++b);if(++b,F=Ir(v.slice(0,b),!0),F.r||(F.r=Or({r:A-1,c:j})),E=v.slice(b),P={t:""},(C=E.match(a))!=null&&C[1]!==""&&(P.v=mn(C[1])),d.cellFormula){if((C=E.match(i))!=null&&C[1]!==""){if(P.f=mn(zn(C[1])).replace(/\r\n/g,`
`),d.xlfn||(P.f=_O(P.f)),C[0].indexOf('t="array"')>-1)P.F=(E.match(s)||[])[1],P.F.indexOf(":")>-1&&ne.push([pn(P.F),P.F]);else if(C[0].indexOf('t="shared"')>-1){B=Ir(C[0]);var le=mn(zn(C[1]));d.xlfn||(le=_O(le)),L[parseInt(B.si,10)]=[B,le,F.r]}}else(C=E.match(/<f[^>]*\/>/))&&(B=Ir(C[0]),L[B.si]&&(P.f=yfe(L[B.si][1],L[B.si][2],F.r)));var ce=_s(F.r);for(b=0;b<ne.length;++b)ce.r>=ne[b][0].s.r&&ce.r<=ne[b][0].e.r&&ce.c>=ne[b][0].s.c&&ce.c<=ne[b][0].e.c&&(P.F=ne[b][1])}if(F.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(R)P.t="z";else continue;else P.t=F.t||"n";switch(h.s.c>j&&(h.s.c=j),h.e.c<j&&(h.e.c=j),P.t){case"n":if(P.v==""||P.v==null){if(!R)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!R)continue;P.t="z"}else I=Ny[parseInt(P.v,10)],P.v=I.t,P.r=I.r,d.cellHTML&&(P.h=I.h);break;case"str":P.t="s",P.v=P.v!=null?zn(P.v):"",d.cellHTML&&(P.h=i3(P.v));break;case"inlineStr":C=E.match(n),P.t="s",C!=null&&(I=w3(C[1]))?(P.v=I.t,d.cellHTML&&(P.h=I.h)):P.v="";break;case"b":P.v=ns(P.v);break;case"d":d.cellDates?P.v=is(P.v,1):(P.v=Sa(is(P.v,1)),P.t="n");break;case"e":(!d||d.cellText!==!1)&&(P.w=P.v),P.v=F$[P.v];break}if(Y=Z=0,ee=null,ae&&F.s!==void 0&&(ee=p.CellXf[F.s],ee!=null&&(ee.numFmtId!=null&&(Y=ee.numFmtId),d.cellStyles&&ee.fillId!=null&&(Z=ee.fillId))),AU(P,Y,Z,d,g,p),d.cellDates&&ae&&P.t=="n"&&Jm(jr[Y])&&(P.t="d",P.v=l2(P.v)),F.cm&&d.xlmeta){var Se=(d.xlmeta.Cell||[])[+F.cm-1];Se&&Se.type=="XLDAPR"&&(P.D=!0)}if(H){var re=_s(F.r);u[re.r]||(u[re.r]=[]),u[re.r][re.c]=P}else u[F.r]=P}}}}M.length>0&&(u["!rows"]=M)}})();function S0e(e,t,r,n){var s=[],a=[],i=pn(e["!ref"]),o="",c,u="",d=[],h=0,g=0,p=e["!rows"],x=Array.isArray(e),v={r:u},w,C=-1;for(g=i.s.c;g<=i.e.c;++g)d[g]=bs(g);for(h=i.s.r;h<=i.e.r;++h){for(a=[],u=Xs(h),g=i.s.c;g<=i.e.c;++g){c=d[g]+u;var k=x?(e[h]||[])[g]:e[c];k!==void 0&&(o=b0e(k,c,e,t))!=null&&a.push(o)}(a.length>0||p&&p[h])&&(v={r:u},p&&p[h]&&(w=p[h],w.hidden&&(v.hidden=1),C=-1,w.hpx?C=lv(w.hpx):w.hpt&&(C=w.hpt),C>-1&&(v.ht=C,v.customHeight=1),w.level&&(v.outlineLevel=w.level)),s[s.length]=Qt("row",a.join(""),v))}if(p)for(;h<p.length;++h)p&&p[h]&&(v={r:h+1},w=p[h],w.hidden&&(v.hidden=1),C=-1,w.hpx?C=lv(w.hpx):w.hpt&&(C=w.hpt),C>-1&&(v.ht=C,v.customHeight=1),w.level&&(v.outlineLevel=w.level),s[s.length]=Qt("row","",v));return s.join("")}function PU(e,t,r,n){var s=[Js,Qt("worksheet",null,{xmlns:A0[0],"xmlns:r":ba.r})],a=r.SheetNames[e],i=0,o="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",d=pn(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Xr(d)}n||(n={}),c["!comments"]=[];var h=[];o0e(c,r,e,t,s),s[s.length]=Qt("dimension",null,{ref:u}),s[s.length]=w0e(c,t,e,r),t.sheetFormat&&(s[s.length]=Qt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=m0e(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=S0e(c,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=u0e(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=x0e(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=a0e(c["!merges"]));var g=-1,p,x=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(v){v[1].Target&&(p={ref:v[0]},v[1].Target.charAt(0)!="#"&&(x=Dn(n,-1,Rn(v[1].Target).replace(/#.*$/,""),an.HLINK),p["r:id"]="rId"+x),(g=v[1].Target.indexOf("#"))>-1&&(p.location=Rn(v[1].Target.slice(g+1))),v[1].Tooltip&&(p.tooltip=Rn(v[1].Tooltip)),s[s.length]=Qt("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=h0e(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=ui("ignoredErrors",Qt("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(x=Dn(n,-1,"../drawings/drawing"+(e+1)+".xml",an.DRAW),s[s.length]=Qt("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=h),c["!comments"].length>0&&(x=Dn(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",an.VML),s[s.length]=Qt("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function k0e(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function C0e(e,t,r){var n=_t(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=lv(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var h=-1,g=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Or(u)];x&&(h<0&&(h=p),g=p)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,g))}var v=n.l;return n.l=c,n.write_shift(4,o),n.l=v,n.length>n.l?n.slice(0,n.l):n}function T0e(e,t,r,n){var s=C0e(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&Ft(e,0,s)}var E0e=O0,N0e=tp;function A0e(){}function j0e(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Ooe(e),r}function P0e(e,t,r){r==null&&(r=_t(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return Hb({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),E$(e,r),r.slice(0,r.l)}function F0e(e){var t=Dl(e);return[t]}function O0e(e,t,r){return r==null&&(r=_t(8)),j0(t,r)}function D0e(e){var t=P0(e);return[t]}function I0e(e,t,r){return r==null&&(r=_t(4)),F0(t,r)}function R0e(e){var t=Dl(e),r=e.read_shift(1);return[t,r,"b"]}function M0e(e,t,r){return r==null&&(r=_t(9)),j0(t,r),r.write_shift(1,e.v?1:0),r}function L0e(e){var t=P0(e),r=e.read_shift(1);return[t,r,"b"]}function B0e(e,t,r){return r==null&&(r=_t(5)),F0(t,r),r.write_shift(1,e.v?1:0),r}function $0e(e){var t=Dl(e),r=e.read_shift(1);return[t,r,"e"]}function U0e(e,t,r){return r==null&&(r=_t(9)),j0(t,r),r.write_shift(1,e.v),r}function z0e(e){var t=P0(e),r=e.read_shift(1);return[t,r,"e"]}function W0e(e,t,r){return r==null&&(r=_t(8)),F0(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function H0e(e){var t=Dl(e),r=e.read_shift(4);return[t,r,"s"]}function G0e(e,t,r){return r==null&&(r=_t(12)),j0(t,r),r.write_shift(4,t.v),r}function V0e(e){var t=P0(e),r=e.read_shift(4);return[t,r,"s"]}function K0e(e,t,r){return r==null&&(r=_t(8)),F0(t,r),r.write_shift(4,t.v),r}function q0e(e){var t=Dl(e),r=Ai(e);return[t,r,"n"]}function Y0e(e,t,r){return r==null&&(r=_t(16)),j0(t,r),m0(e.v,r),r}function FU(e){var t=P0(e),r=Ai(e);return[t,r,"n"]}function X0e(e,t,r){return r==null&&(r=_t(12)),F0(t,r),m0(e.v,r),r}function Q0e(e){var t=Dl(e),r=m3(e);return[t,r,"n"]}function J0e(e,t,r){return r==null&&(r=_t(12)),j0(t,r),N$(e.v,r),r}function Z0e(e){var t=P0(e),r=m3(e);return[t,r,"n"]}function ege(e,t,r){return r==null&&(r=_t(8)),F0(t,r),N$(e.v,r),r}function tge(e){var t=Dl(e),r=f3(e);return[t,r,"is"]}function rge(e){var t=Dl(e),r=Oi(e);return[t,r,"str"]}function nge(e,t,r){return r==null&&(r=_t(12+4*e.v.length)),j0(t,r),$a(e.v,r),r.length>r.l?r.slice(0,r.l):r}function sge(e){var t=P0(e),r=Oi(e);return[t,r,"str"]}function age(e,t,r){return r==null&&(r=_t(8+4*e.v.length)),F0(t,r),$a(e.v,r),r.length>r.l?r.slice(0,r.l):r}function ige(e,t,r){var n=e.l+t,s=Dl(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=d2(e,n-e.l,r);i[3]=Ti(o,null,s,r.supbooks,r)}else e.l=n;return i}function oge(e,t,r){var n=e.l+t,s=Dl(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=d2(e,n-e.l,r);i[3]=Ti(o,null,s,r.supbooks,r)}else e.l=n;return i}function lge(e,t,r){var n=e.l+t,s=Dl(e);s.r=r["!row"];var a=Ai(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=d2(e,n-e.l,r);i[3]=Ti(o,null,s,r.supbooks,r)}else e.l=n;return i}function cge(e,t,r){var n=e.l+t,s=Dl(e);s.r=r["!row"];var a=Oi(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=d2(e,n-e.l,r);i[3]=Ti(o,null,s,r.supbooks,r)}else e.l=n;return i}var uge=O0,dge=tp;function fge(e,t){return t==null&&(t=_t(4)),t.write_shift(4,e),t}function hge(e,t){var r=e.l+t,n=O0(e),s=h3(e),a=Oi(e),i=Oi(e),o=Oi(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:o};return i&&(c.Tooltip=i),c}function gge(e,t){var r=_t(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));tp({s:_s(e[0]),e:_s(e[0])},r),g3("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return $a(s||"",r),$a(e[1].Tooltip||"",r),$a("",r),r.slice(0,r.l)}function mge(){}function pge(e,t,r){var n=e.l+t,s=A$(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=$he(e,n-e.l,r);i[1]=o}else e.l=n;return i}function xge(e,t,r){var n=e.l+t,s=O0(e),a=[s];if(r.cellFormula){var i=zhe(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function yge(e,t,r){r==null&&(r=_t(18));var n=f2(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var OU=["left","right","top","bottom","header","footer"];function vge(e){var t={};return OU.forEach(function(r){t[r]=Ai(e)}),t}function wge(e,t){return t==null&&(t=_t(48)),qh(e),OU.forEach(function(r){m0(e[r],t)}),t}function bge(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function _ge(e,t,r){r==null&&(r=_t(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Sge(e){var t=_t(24);return t.write_shift(4,4),t.write_shift(4,1),tp(e,t),t}function kge(e,t){return t==null&&(t=_t(66)),t.write_shift(2,e.password?b3(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Cge(){}function Tge(){}function Ege(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,g=!1,p,x,v,w,C,k,b,N,E,P=[];o.biff=12,o["!row"]=0;var F=0,A=!1,j=[],I={},B=o.supbooks||s.supbooks||[[]];if(B.sharedf=I,B.arrayf=j,B.SheetNames=s.SheetNames||s.Sheets.map(function(H){return H.name}),!o.supbooks&&(o.supbooks=B,s.Names))for(var Y=0;Y<s.Names.length;++Y)B[0][Y+1]=s.Names[Y];var Z=[],ae=[],ee=!1;cv[16]={n:"BrtShortReal",f:FU};var ne;if(dd(e,function(M,V,W){if(!g)switch(W){case 148:u=M;break;case 0:p=M,o.sheetRows&&o.sheetRows<=p.r&&(g=!0),N=Xs(w=p.r),o["!row"]=p.r,(M.hidden||M.hpt||M.level!=null)&&(M.hpt&&(M.hpx=Em(M.hpt)),ae[M.r]=M);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:M[2]},M[2]){case"n":x.v=M[1];break;case"s":b=Ny[M[1]],x.v=b.t,x.r=b.r;break;case"b":x.v=!!M[1];break;case"e":x.v=M[1],o.cellText!==!1&&(x.w=fd[x.v]);break;case"str":x.t="s",x.v=M[1];break;case"is":x.t="s",x.v=M[1].t;break}if((v=i.CellXf[M[0].iStyleRef])&&AU(x,v.numFmtId,null,o,a,i),C=M[0].c==-1?C+1:M[0].c,o.dense?(c[w]||(c[w]=[]),c[w][C]=x):c[bs(C)+N]=x,o.cellFormula){for(A=!1,F=0;F<j.length;++F){var R=j[F];p.r>=R[0].s.r&&p.r<=R[0].e.r&&C>=R[0].s.c&&C<=R[0].e.c&&(x.F=Xr(R[0]),A=!0)}!A&&M.length>3&&(x.f=M[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>C&&(d.s.c=C),d.e.r<p.r&&(d.e.r=p.r),d.e.c<C&&(d.e.c=C),o.cellDates&&v&&x.t=="n"&&Jm(jr[v.numFmtId])){var U=Dh(x.v);U&&(x.t="d",x.v=new Date(U.y,U.m-1,U.d,U.H,U.M,U.S,U.u))}ne&&(ne.type=="XLDAPR"&&(x.D=!0),ne=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;x={t:"z",v:void 0},C=M[0].c==-1?C+1:M[0].c,o.dense?(c[w]||(c[w]=[]),c[w][C]=x):c[bs(C)+N]=x,d.s.r>p.r&&(d.s.r=p.r),d.s.c>C&&(d.s.c=C),d.e.r<p.r&&(d.e.r=p.r),d.e.c<C&&(d.e.c=C),ne&&(ne.type=="XLDAPR"&&(x.D=!0),ne=void 0);break;case 176:P.push(M);break;case 49:ne=((o.xlmeta||{}).Cell||[])[M-1];break;case 494:var q=n["!id"][M.relId];for(q?(M.Target=q.Target,M.loc&&(M.Target+="#"+M.loc),M.Rel=q):M.relId==""&&(M.Target="#"+M.loc),w=M.rfx.s.r;w<=M.rfx.e.r;++w)for(C=M.rfx.s.c;C<=M.rfx.e.c;++C)o.dense?(c[w]||(c[w]=[]),c[w][C]||(c[w][C]={t:"z",v:void 0}),c[w][C].l=M):(k=Or({c:C,r:w}),c[k]||(c[k]={t:"z",v:void 0}),c[k].l=M);break;case 426:if(!o.cellFormula)break;j.push(M),E=o.dense?c[w][C]:c[bs(C)+N],E.f=Ti(M[1],d,{r:p.r,c:C},B,o),E.F=Xr(M[0]);break;case 427:if(!o.cellFormula)break;I[Or(M[0].s)]=M[1],E=o.dense?c[w][C]:c[bs(C)+N],E.f=Ti(M[1],d,{r:p.r,c:C},B,o);break;case 60:if(!o.cellStyles)break;for(;M.e>=M.s;)Z[M.e--]={width:M.w/256,hidden:!!(M.flags&1),level:M.level},ee||(ee=!0,_3(M.w/256)),Ef(Z[M.e+1]);break;case 161:c["!autofilter"]={ref:Xr(M)};break;case 476:c["!margins"]=M;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),M.name&&(s.Sheets[r].CodeName=M.name),(M.above||M.left)&&(c["!outline"]={above:M.above,left:M.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),M.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!V.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+W.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Xr(u||d)),o.sheetRows&&c["!ref"]){var L=pn(c["!ref"]);o.sheetRows<=+L.e.r&&(L.e.r=o.sheetRows-1,L.e.r>d.e.r&&(L.e.r=d.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>d.e.c&&(L.e.c=d.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Xr(L))}return P.length>0&&(c["!merges"]=P),Z.length>0&&(c["!cols"]=Z),ae.length>0&&(c["!rows"]=ae),c}function Nge(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=os(t),t.z=t.z||jr[14],t.v=Sa(is(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=$f(s.cellXfs,t,s),t.l&&a["!links"].push([Or(c),t.l]),t.c&&a["!comments"].push([Or(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=E3(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,i?Ft(e,18,K0e(t,c)):Ft(e,7,G0e(t,c))):(c.t="str",i?Ft(e,17,age(t,c)):Ft(e,6,nge(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?Ft(e,13,ege(t,c)):Ft(e,2,J0e(t,c)):i?Ft(e,16,X0e(t,c)):Ft(e,5,Y0e(t,c)),!0;case"b":return c.t="b",i?Ft(e,15,B0e(t,c)):Ft(e,4,M0e(t,c)),!0;case"e":return c.t="e",i?Ft(e,14,W0e(t,c)):Ft(e,3,U0e(t,c)),!0}return i?Ft(e,12,I0e(t,c)):Ft(e,1,O0e(t,c)),!0}function Age(e,t,r,n){var s=pn(t["!ref"]||"A1"),a,i="",o=[];Ft(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){i=Xs(d),T0e(e,t,s,d);var h=!1;if(d<=s.e.r)for(var g=s.s.c;g<=s.e.c;++g){d===s.s.r&&(o[g]=bs(g)),a=o[g]+i;var p=c?(t[d]||[])[g]:t[a];if(!p){h=!1;continue}h=Nge(e,p,d,g,n,t,h)}}Ft(e,146)}function jge(e,t){!t||!t["!merges"]||(Ft(e,177,fge(t["!merges"].length)),t["!merges"].forEach(function(r){Ft(e,176,dge(r))}),Ft(e,178))}function Pge(e,t){!t||!t["!cols"]||(Ft(e,390),t["!cols"].forEach(function(r,n){r&&Ft(e,60,yge(n,r))}),Ft(e,391))}function Fge(e,t){!t||!t["!ref"]||(Ft(e,648),Ft(e,649,Sge(pn(t["!ref"]))),Ft(e,650))}function Oge(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Dn(r,-1,n[1].Target.replace(/#.*$/,""),an.HLINK);Ft(e,494,gge(n,s))}}),delete t["!links"]}function Dge(e,t,r,n){if(t["!comments"].length>0){var s=Dn(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",an.VML);Ft(e,551,g3("rId"+s)),t["!legacy"]=s}}function Ige(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Xr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=To(a);o.s.r==o.e.r&&(o.e.r=To(t["!ref"]).e.r,a=Xr(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ft(e,161,tp(pn(a))),Ft(e,162)}}function Rge(e,t,r){Ft(e,133),Ft(e,137,_ge(t,r)),Ft(e,138),Ft(e,134)}function Mge(e,t){t["!protect"]&&Ft(e,535,kge(t["!protect"]))}function Lge(e,t,r,n){var s=Co(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=pn(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Ft(s,129),(r.vbaraw||i["!outline"])&&Ft(s,147,P0e(o,i["!outline"])),Ft(s,148,N0e(c)),Rge(s,i,r.Workbook),Pge(s,i),Age(s,i,e,t),Mge(s,i),Ige(s,i,r,e),jge(s,i),Oge(s,i,n),i["!margins"]&&Ft(s,476,wge(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Fge(s,i),Dge(s,i,e,n),Ft(s,130),s.end()}function Bge(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=mn((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function $ge(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var g=Bge(h);d.s.r=d.s.c=0,d.e.c=o,u=bs(o),g[0].forEach(function(p,x){i[u+Xs(x)]={t:"n",v:p,z:g[1]},c=x}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(i["!ref"]=Xr(d)),i}function Uge(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(jU);return o&&N3(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function zge(e,t){e.l+=10;var r=Oi(e);return{name:r}}function Wge(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return dd(e,function(c,u,d){switch(d){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var A3=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Hge=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Gge=[],Vge=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function EO(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=ns(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function NO(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=ns(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function DU(e){NO(e.WBProps,A3),NO(e.CalcPr,Vge),EO(e.WBView,Hge),EO(e.Sheets,Gge),hm.date1904=ns(e.WBProps.date1904)}function Kge(e){return!e.Workbook||!e.Workbook.WBProps?"false":ns(e.Workbook.WBProps.date1904)?"true":"false"}var qge="][*?/\\".split("");function IU(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return qge.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Yge(e,t,r){e.forEach(function(n,s){IU(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function Xge(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Yge(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Khe(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Qge=/<\w+:workbook/;function Jge(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(Ri,function(c,u){var d=Ir(c);switch(ru(d[0])){case"<?xml":break;case"<workbook":c.match(Qge)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":A3.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=ns(d[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:r.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(r.WBProps.CodeName=zn(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=mn(zn(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=zn(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),ns(d.hidden||"0")&&(a.Hidden=!0),i=u+c.length;break;case"</definedName>":a.Ref=mn(zn(e.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),A0.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return DU(r),r}function RU(e){var t=[Js];t[t.length]=Qt("workbook",null,{xmlns:A0[0],"xmlns:r":ba.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(A3.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Qt("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:Rn(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=Qt("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Qt("definedName",Rn(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Zge(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=hE(e),r.name=Oi(e),r}function eme(e,t){return t||(t=_t(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),g3(e.strRelID,t),$a(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function tme(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Oi(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function rme(e,t){t||(t=_t(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),E$(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function nme(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function sme(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=Doe(e),i=Uhe(e,0,r),o=h3(e);e.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function ame(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],cv[16]={n:"BrtFRTArchID$",f:nme},dd(e,function(c,u,d){switch(d){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Ti(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,c]):i[0]=[d,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),DU(r),r.Names=a,r.supbooks=i,r}function ime(e,t){Ft(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ft(e,156,eme(s))}Ft(e,144)}function ome(e,t){t||(t=_t(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return $a("SheetJS",t),$a(Mb.version,t),$a(Mb.version,t),$a("7262",t),t.length>t.l?t.slice(0,t.l):t}function lme(e,t){t||(t=_t(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function cme(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(Ft(e,135),Ft(e,158,lme(s)),Ft(e,136))}}function ume(e,t){var r=Co();return Ft(r,131),Ft(r,128,ome()),Ft(r,153,rme(e.Workbook&&e.Workbook.WBProps||null)),cme(r,e),ime(r,e),Ft(r,132),r.end()}function dme(e,t,r){return t.slice(-4)===".bin"?ame(e,r):Jge(e,r)}function fme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?Ege(e,n,r,s,a,i,o):s0e(e,n,r,s,a,i,o)}function hme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?Wge(e,n,r,s,a):Uge(e,n,r,s,a)}function gme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?pfe():xfe()}function mme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?gfe():mfe()}function pme(e,t,r,n){return t.slice(-4)===".bin"?dde(e,r,n):Zue(e,r,n)}function xme(e,t,r){return pU(e,r)}function yme(e,t,r){return t.slice(-4)===".bin"?yue(e,r):mue(e,r)}function vme(e,t,r){return t.slice(-4)===".bin"?cfe(e,r):efe(e,r)}function wme(e,t,r){return t.slice(-4)===".bin"?Qde(e):Yde(e)}function bme(e,t,r,n){return r.slice(-4)===".bin"?Jde(e,t,r,n):void 0}function _me(e,t,r){return t.slice(-4)===".bin"?Vde(e,t,r):qde(e,t,r)}function Sme(e,t,r){return(t.slice(-4)===".bin"?ume:RU)(e)}function kme(e,t,r,n,s){return(t.slice(-4)===".bin"?Lge:PU)(e,r,n,s)}function Cme(e,t,r){return(t.slice(-4)===".bin"?bde:gU)(e,r)}function Tme(e,t,r){return(t.slice(-4)===".bin"?bue:iU)(e,r)}function Eme(e,t,r){return(t.slice(-4)===".bin"?ufe:vU)(e)}function Nme(e){return(e.slice(-4)===".bin"?Kde:xU)()}var MU=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,LU=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Zl(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(MU),a,i,o,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(LU),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function Ame(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(MU),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(LU),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var jy;function jme(e,t){var r=jy[e]||mn(e);return r==="General"?h0(t):Al(r,t)}function Pme(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=ns(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=is(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[mn(t)]=s}function Fme(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||fd[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ev(e.v):e.w=h0(e.v):e.w=jme(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=jy[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Jm(n)){var s=Dh(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function Ome(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Gue[n.Pattern]||n.Pattern)}e[t.ID]=t}function Dme(e,t,r,n,s,a,i,o,c,u){var d="General",h=n.StyleID,g={};u=u||{};var p=[],x=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&i&&(h=i.StyleID);a[h]!==void 0&&(a[h].nf&&(d=a[h].nf),a[h].Interior&&p.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ns(e);break;case"String":n.t="s",n.r=GF(mn(e)),n.v=e.indexOf("<")>-1?mn(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(is(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=mn(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=F$[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=GF(t||e));break}if(Fme(n,d,u),u.cellFormula!==!1)if(n.Formula){var v=mn(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=fm(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=fm("RC:RC",s):n.ArrayRange&&(n.F=fm(n.ArrayRange,s),c.push([pn(n.F),n.F]))}else for(x=0;x<c.length;++x)s.r>=c[x][0].s.r&&s.r<=c[x][0].e.r&&s.c>=c[x][0].s.c&&s.c<=c[x][0].e.c&&(n.F=c[x][1]);u.cellStyles&&(p.forEach(function(w){!g.patternType&&w.patternType&&(g.patternType=w.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Ime(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Nk(e,t){var r=t||{};Zm();var n=cy(o3(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=zn(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=os(r);return i.type="string",Tm.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Rt){s.indexOf("<"+Rt)>=0&&(a=!0)}),a)return wpe(n,r);jy={"General Number":"General","General Date":jr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":jr[15],"Short Date":jr[14],"Long Time":jr[19],"Medium Time":jr[18],"Short Time":jr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:jr[2],Standard:jr[4],Percent:jr[10],Scientific:jr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},h=[],g=r.dense?[]:{},p="",x={},v={},w=Zl('<Data ss:Type="String">'),C=0,k=0,b=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},P={},F="",A=0,j=[],I={},B={},Y=0,Z=[],ae=[],ee={},ne=[],L,H=!1,M=[],V=[],W={},R=0,U=0,q={Sheets:[],WBProps:{date1904:!1}},Q={};nv.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var se="";o=nv.exec(n);)switch(o[3]=(se=o[3]).toLowerCase()){case"data":if(se=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?Dme(n.slice(C,o.index),F,w,c[c.length-1][0]=="comment"?ee:x,{c:k,r:b},E,ne[k],v,M,r):(F="",w=Zl(o[0]),C=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ae.length>0&&(x.c=ae),(!r.sheetRows||r.sheetRows>b)&&x.v!==void 0&&(r.dense?(g[b]||(g[b]=[]),g[b][k]=x):g[bs(k)+Xs(b)]=x),x.HRef&&(x.l={Target:mn(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(R=k+(parseInt(x.MergeAcross,10)|0),U=b+(parseInt(x.MergeDown,10)|0),j.push({s:{c:k,r:b},e:{c:R,r:U}})),!r.sheetStubs)x.MergeAcross?k=R+1:++k;else if(x.MergeAcross||x.MergeDown){for(var X=k;X<=R;++X)for(var ie=b;ie<=U;++ie)(X>k||ie>b)&&(r.dense?(g[ie]||(g[ie]=[]),g[ie][X]={t:"z"}):g[bs(X)+Xs(ie)]={t:"z"});k=R+1}else++k;else x=Ame(o[0]),x.Index&&(k=+x.Index-1),k<N.s.c&&(N.s.c=k),k>N.e.c&&(N.e.c=k),o[0].slice(-2)==="/>"&&++k,ae=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(b<N.s.r&&(N.s.r=b),b>N.e.r&&(N.e.r=b),o[0].slice(-2)==="/>"&&(v=Zl(o[0]),v.Index&&(b=+v.Index-1)),k=0,++b):(v=Zl(o[0]),v.Index&&(b=+v.Index-1),W={},(v.AutoFitHeight=="0"||v.Height)&&(W.hpx=parseInt(v.Height,10),W.hpt=lv(W.hpx),V[b]=W),v.Hidden=="1"&&(W.hidden=!0,V[b]=W));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));h.push(p),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(g["!ref"]=Xr(N),r.sheetRows&&r.sheetRows<=N.e.r&&(g["!fullref"]=g["!ref"],N.e.r=r.sheetRows-1,g["!ref"]=Xr(N))),j.length&&(g["!merges"]=j),ne.length>0&&(g["!cols"]=ne),V.length>0&&(g["!rows"]=V),d[p]=g}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=k=0,c.push([o[3],!1]),u=Zl(o[0]),p=mn(u.Name),g=r.dense?[]:{},j=[],M=[],V=[],Q={name:p,Hidden:0},q.Sheets.push(Q);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),ne=[],H=!1}break;case"style":o[1]==="/"?Ome(E,P,r):P=Zl(o[0]);break;case"numberformat":P.nf=mn(Zl(o[0]).Format||"General"),jy[P.nf]&&(P.nf=jy[P.nf]);for(var le=0;le!=392&&jr[le]!=P.nf;++le);if(le==392){for(le=57;le!=392;++le)if(jr[le]==null){qu(P.nf,le);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(L=Zl(o[0]),L.Hidden&&(L.hidden=!0,delete L.Hidden),L.Width&&(L.wpx=parseInt(L.Width,10)),!H&&L.wpx>10){H=!0,Ei=fU;for(var ce=0;ce<ne.length;++ce)ne[ce]&&Ef(ne[ce])}H&&Ef(L),ne[L.Index-1||ne.length]=L;for(var Se=0;Se<+L.Span;++Se)ne[ne.length]=os(L);break;case"namedrange":if(o[1]==="/")break;q.Names||(q.Names=[]);var re=Ir(o[0]),ge={Name:re.Name,Ref:fm(re.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(ge.Sheet=q.Sheets.length-1),q.Names.push(ge);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?F+=n.slice(A,o.index):A=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;P.Interior=Zl(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?ale(I,se,n.slice(Y,o.index)):Y=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));Ime(ee),ae.push(ee)}else c.push([o[3],!1]),u=Zl(o[0]),ee={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ee=Zl(o[0]);g["!autofilter"]={ref:fm(Ee.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return OO(n,r);var Ae=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ae=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ae=!1}break;case"excelworkbook":switch(o[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ae=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ae=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(Y,o.index)){case"SheetHidden":Q.Hidden=1;break;case"SheetVeryHidden":Q.Hidden=2;break}else Y=o.index+o[0].length;break;case"header":g["!margins"]||qh(g["!margins"]={},"xlml"),isNaN(+Ir(o[0]).Margin)||(g["!margins"].header=+Ir(o[0]).Margin);break;case"footer":g["!margins"]||qh(g["!margins"]={},"xlml"),isNaN(+Ir(o[0]).Margin)||(g["!margins"].footer=+Ir(o[0]).Margin);break;case"pagemargins":var He=Ir(o[0]);g["!margins"]||qh(g["!margins"]={},"xlml"),isNaN(+He.Top)||(g["!margins"].top=+He.Top),isNaN(+He.Left)||(g["!margins"].left=+He.Left),isNaN(+He.Right)||(g["!margins"].right=+He.Right),isNaN(+He.Bottom)||(g["!margins"].bottom=+He.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ae=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ae=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ae=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ae=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ae=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ae=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ae=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ae=!1}break;case"smarttags":break;default:Ae=!1;break}if(Ae||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Pme(B,se,Z,n.slice(Y,o.index)):(Z=o,Y=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Be={};return!r.bookSheets&&!r.bookProps&&(Be.Sheets=d),Be.SheetNames=h,Be.Workbook=q,Be.SSF=os(jr),Be.Props=I,Be.Custprops=B,Be}function wE(e,t){switch(P3(t=t||{}),t.type||"base64"){case"base64":return Nk(Yo(e),t);case"binary":case"buffer":case"file":return Nk(e,t);case"array":return Nk(Lf(e),t)}}function Rme(e,t){var r=[];return e.Props&&r.push(ile(e.Props,t)),e.Custprops&&r.push(ole(e.Props,e.Custprops)),r.join("")}function Mme(){return""}function Lme(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(Qt("NumberFormat",null,{"ss:Format":Rn(jr[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(Qt("Style",a.join(""),i))}),Qt("Styles",r.join(""))}function BU(e){return Qt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+C3(e.Ref,{r:0,c:0})})}function Bme(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(BU(s)))}return Qt("Names",r.join(""))}function $me(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(BU(o)))}return a.join("")}function Ume(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Qt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Qt("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Qt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Qt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(ui("ProtectContents","True")),e["!protect"].objects&&s.push(ui("ProtectObjects","True")),e["!protect"].scenarios&&s.push(ui("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(ui("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(ui("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":Qt("WorksheetOptions",s.join(""),{xmlns:Uo.x})}function zme(e){return e.map(function(t){var r=coe(t.t||""),n=Qt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Qt("Comment",n,{"ss:Author":t.a})}).join("")}function Wme(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Rn(C3(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=_s(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Rn(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Rn(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var h="",g="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",g=String(e.v);break;case"b":h="Boolean",g=e.v?"1":"0";break;case"e":h="Error",g=fd[e.v];break;case"d":h="DateTime",g=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||jr[14]);break;case"s":h="String",g=loe(e.v||"");break}var p=$f(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=i.c+1;var x=e.v!=null?g:"",v=e.t=="z"?"":'<Data ss:Type="'+h+'">'+x+"</Data>";return(e.c||[]).length>0&&(v+=zme(e.c)),Qt("Cell",v,o)}function Hme(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Em(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Gme(e,t,r,n){if(!e["!ref"])return"";var s=pn(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(w,C){Ef(w);var k=!!w.width,b=f2(C,w),N={"ss:Index":C+1};k&&(N["ss:Width"]=iv(b.width)),w.hidden&&(N["ss:Hidden"]="1"),o.push(Qt("Column",null,N))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[Hme(u,(e["!rows"]||[])[u])],h=s.s.c;h<=s.e.c;++h){var g=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>h)&&!(a[i].s.r>u)&&!(a[i].e.c<h)&&!(a[i].e.r<u)){(a[i].s.c!=h||a[i].s.r!=u)&&(g=!0);break}if(!g){var p={r:u,c:h},x=Or(p),v=c?(e[u]||[])[h]:e[x];d.push(Wme(v,x,e,t,r,n,p))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function Vme(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?$me(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?Gme(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(Ume(a,t,e,r)),n.join("")}function Kme(e,t){t||(t={}),e.SSF||(e.SSF=os(jr)),e.SSF&&(Zm(),a2(e.SSF),t.revssf=o2(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],$f(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Rme(e,t)),r.push(Mme()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Qt("Worksheet",Vme(n,t,e),{"ss:Name":Rn(e.SheetNames[n])}));return r[2]=Lme(e,t),r[3]=Bme(e),Js+Qt("Workbook",r.join(""),{xmlns:Uo.ss,"xmlns:o":Uo.o,"xmlns:x":Uo.x,"xmlns:ss":Uo.ss,"xmlns:dt":Uo.dt,"xmlns:html":Uo.html})}function qme(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Boe(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=$oe(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Yme=[60,1084,2066,2165,2175];function Xme(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var c=Wu(r,r.l),u=bE[c],d=0;u!=null&&Yme.indexOf(c)>-1;)a=Wu(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+a),i.push(o),r.l+=4+a,u=bE[c=Wu(r,r.l)];var h=La(i);oi(h,0);var g=0;h.lens=[];for(var p=0;p<i.length;++p)h.lens.push(g),g+=i[p].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,s)}function Rc(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=jr[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||fd[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ev(e.v):e.w=h0(e.v):e.w=Al(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Jm(jr[n]||String(n))){var s=Dh(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Ow(e,t,r){return{v:e,ixfe:t,t:r}}function Qme(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,c=[],u="",d={},h,g="",p,x,v,w,C={},k=[],b,N,E=[],P=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},j=function(Ue){return Ue<8?Gh[Ue]:Ue<64&&P[Ue-8]||Gh[Ue]},I=function(Ue,tt,Et){var At=tt.XF.data;if(!(!At||!At.patternType||!Et||!Et.cellStyles)){tt.s={},tt.s.patternType=At.patternType;var qt;(qt=av(j(At.icvFore)))&&(tt.s.fgColor={rgb:qt}),(qt=av(j(At.icvBack)))&&(tt.s.bgColor={rgb:qt})}},B=function(Ue,tt,Et){if(!(W>1)&&!(Et.sheetRows&&Ue.r>=Et.sheetRows)){if(Et.cellStyles&&tt.XF&&tt.XF.data&&I(Ue,tt,Et),delete tt.ixfe,delete tt.XF,h=Ue,g=Or(Ue),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Ue.r<i.s.r&&(i.s.r=Ue.r),Ue.c<i.s.c&&(i.s.c=Ue.c),Ue.r+1>i.e.r&&(i.e.r=Ue.r+1),Ue.c+1>i.e.c&&(i.e.c=Ue.c+1),Et.cellFormula&&tt.f){for(var At=0;At<k.length;++At)if(!(k[At][0].s.c>Ue.c||k[At][0].s.r>Ue.r)&&!(k[At][0].e.c<Ue.c||k[At][0].e.r<Ue.r)){tt.F=Xr(k[At][0]),(k[At][0].s.c!=Ue.c||k[At][0].s.r!=Ue.r)&&delete tt.f,tt.f&&(tt.f=""+Ti(k[At][1],i,Ue,M,Y));break}}Et.dense?(s[Ue.r]||(s[Ue.r]=[]),s[Ue.r][Ue.c]=tt):s[g]=tt}},Y={enc:!1,sbcch:0,snames:[],sharedf:C,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Y.password=t.password);var Z,ae=[],ee=[],ne=[],L=[],H=!1,M=[];M.SheetNames=Y.snames,M.sharedf=Y.sharedf,M.arrayf=Y.arrayf,M.names=[],M.XTI=[];var V=0,W=0,R=0,U=[],q=[],Q;Y.codepage=1200,ac(1200);for(var se=!1;e.l<e.length-1;){var X=e.l,ie=e.read_shift(2);if(ie===0&&V===10)break;var le=e.l===e.length?0:e.read_shift(2),ce=bE[ie];if(ce&&ce.f){if(t.bookSheets&&V===133&&ie!==133)break;if(V=ie,ce.r===2||ce.r==12){var Se=e.read_shift(2);if(le-=2,!Y.enc&&Se!==ie&&((Se&255)<<8|Se>>8)!==ie)throw new Error("rt mismatch: "+Se+"!="+ie);ce.r==12&&(e.l+=10,le-=10)}var re={};if(ie===10?re=ce.f(e,le,Y):re=Xme(ie,ce,e,le,Y),W==0&&[9,521,1033,2057].indexOf(V)===-1)continue;switch(ie){case 34:r.opts.Date1904=F.WBProps.date1904=re;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Y.enc||(e.l=0),Y.enc=re,!t.password)throw new Error("File is password-protected");if(re.valid==null)throw new Error("Encryption scheme unsupported");if(!re.valid)throw new Error("Password is incorrect");break;case 92:Y.lastuser=re;break;case 66:var ge=Number(re);switch(ge){case 21010:ge=1200;break;case 32768:ge=1e4;break;case 32769:ge=1252;break}ac(Y.codepage=ge),se=!0;break;case 317:Y.rrtabid=re;break;case 25:Y.winlocked=re;break;case 439:r.opts.RefreshAll=re;break;case 12:r.opts.CalcCount=re;break;case 16:r.opts.CalcDelta=re;break;case 17:r.opts.CalcIter=re;break;case 13:r.opts.CalcMode=re;break;case 14:r.opts.CalcPrecision=re;break;case 95:r.opts.CalcSaveRecalc=re;break;case 15:Y.CalcRefMode=re;break;case 2211:r.opts.FullCalc=re;break;case 129:re.fDialog&&(s["!type"]="dialog"),re.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),re.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:E.push(re);break;case 430:M.push([re]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(re);break;case 24:case 536:Q={Name:re.Name,Ref:Ti(re.rgce,i,null,M,Y)},re.itab>0&&(Q.Sheet=re.itab-1),M.names.push(Q),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(re),re.Name=="_xlnm._FilterDatabase"&&re.itab>0&&re.rgce&&re.rgce[0]&&re.rgce[0][0]&&re.rgce[0][0][0]=="PtgArea3d"&&(q[re.itab-1]={ref:Xr(re.rgce[0][0][1][2])});break;case 22:Y.ExternCount=re;break;case 23:M.length==0&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(re),M.XTI=M.XTI.concat(re);break;case 2196:if(Y.biff<8)break;Q!=null&&(Q.Comment=re[1]);break;case 18:s["!protect"]=re;break;case 19:re!==0&&Y.WTF&&console.error("Password verifier: "+re);break;case 133:a[re.pos]=re,Y.snames.push(re.name);break;case 10:{if(--W)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Xr(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ee=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Xr(i),i.e.r=Ee}i.e.r++,i.e.c++}ae.length>0&&(s["!merges"]=ae),ee.length>0&&(s["!objects"]=ee),ne.length>0&&(s["!cols"]=ne),L.length>0&&(s["!rows"]=L),F.Sheets.push(A)}u===""?d=s:n[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Y.biff===8&&(Y.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[re.BIFFVer]||8),Y.biffguess=re.BIFFVer==0,re.BIFFVer==0&&re.dt==4096&&(Y.biff=5,se=!0,ac(Y.codepage=28591)),Y.biff==8&&re.BIFFVer==0&&re.dt==16&&(Y.biff=2),W++)break;if(s=t.dense?[]:{},Y.biff<8&&!se&&(se=!0,ac(Y.codepage=t.codepage||1252)),Y.biff<5||re.BIFFVer==0&&re.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ae={pos:e.l-le,name:u};a[Ae.pos]=Ae,Y.snames.push(u)}else u=(a[X]||{name:""}).name;re.dt==32&&(s["!type"]="chart"),re.dt==64&&(s["!type"]="macro"),ae=[],ee=[],Y.arrayf=k=[],ne=[],L=[],H=!1,A={Hidden:(a[X]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[re.r]||[])[re.c]:s[Or({c:re.c,r:re.r})])&&++re.c,b={ixfe:re.ixfe,XF:E[re.ixfe]||{},v:re.val,t:"n"},R>0&&(b.z=U[b.ixfe>>8&63]),Rc(b,t,r.opts.Date1904),B({c:re.c,r:re.r},b,t);break;case 5:case 517:b={ixfe:re.ixfe,XF:E[re.ixfe],v:re.val,t:re.t},R>0&&(b.z=U[b.ixfe>>8&63]),Rc(b,t,r.opts.Date1904),B({c:re.c,r:re.r},b,t);break;case 638:b={ixfe:re.ixfe,XF:E[re.ixfe],v:re.rknum,t:"n"},R>0&&(b.z=U[b.ixfe>>8&63]),Rc(b,t,r.opts.Date1904),B({c:re.c,r:re.r},b,t);break;case 189:for(var He=re.c;He<=re.C;++He){var Be=re.rkrec[He-re.c][0];b={ixfe:Be,XF:E[Be],v:re.rkrec[He-re.c][1],t:"n"},R>0&&(b.z=U[b.ixfe>>8&63]),Rc(b,t,r.opts.Date1904),B({c:He,r:re.r},b,t)}break;case 6:case 518:case 1030:{if(re.val=="String"){o=re;break}if(b=Ow(re.val,re.cell.ixfe,re.tt),b.XF=E[b.ixfe],t.cellFormula){var Rt=re.formula;if(Rt&&Rt[0]&&Rt[0][0]&&Rt[0][0][0]=="PtgExp"){var et=Rt[0][0][1][0],vt=Rt[0][0][1][1],xt=Or({r:et,c:vt});C[xt]?b.f=""+Ti(re.formula,i,re.cell,M,Y):b.F=((t.dense?(s[et]||[])[vt]:s[xt])||{}).F}else b.f=""+Ti(re.formula,i,re.cell,M,Y)}R>0&&(b.z=U[b.ixfe>>8&63]),Rc(b,t,r.opts.Date1904),B(re.cell,b,t),o=re}break;case 7:case 519:if(o)o.val=re,b=Ow(re,o.cell.ixfe,"s"),b.XF=E[b.ixfe],t.cellFormula&&(b.f=""+Ti(o.formula,i,o.cell,M,Y)),R>0&&(b.z=U[b.ixfe>>8&63]),Rc(b,t,r.opts.Date1904),B(o.cell,b,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(re);var it=Or(re[0].s);if(p=t.dense?(s[re[0].s.r]||[])[re[0].s.c]:s[it],t.cellFormula&&p){if(!o||!it||!p)break;p.f=""+Ti(re[1],i,re[0],M,Y),p.F=Xr(re[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!o)break;C[Or(o.cell)]=re[0],p=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[Or(o.cell)],(p||{}).f=""+Ti(re[0],i,h,M,Y)}}break;case 253:b=Ow(c[re.isst].t,re.ixfe,"s"),c[re.isst].h&&(b.h=c[re.isst].h),b.XF=E[b.ixfe],R>0&&(b.z=U[b.ixfe>>8&63]),Rc(b,t,r.opts.Date1904),B({c:re.c,r:re.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:re.ixfe,XF:E[re.ixfe],t:"z"},R>0&&(b.z=U[b.ixfe>>8&63]),Rc(b,t,r.opts.Date1904),B({c:re.c,r:re.r},b,t));break;case 190:if(t.sheetStubs)for(var ht=re.c;ht<=re.C;++ht){var Dt=re.ixfe[ht-re.c];b={ixfe:Dt,XF:E[Dt],t:"z"},R>0&&(b.z=U[b.ixfe>>8&63]),Rc(b,t,r.opts.Date1904),B({c:ht,r:re.r},b,t)}break;case 214:case 516:case 4:b=Ow(re.val,re.ixfe,"s"),b.XF=E[b.ixfe],R>0&&(b.z=U[b.ixfe>>8&63]),Rc(b,t,r.opts.Date1904),B({c:re.c,r:re.r},b,t);break;case 0:case 512:W===1&&(i=re);break;case 252:c=re;break;case 1054:if(Y.biff==4){U[R++]=re[1];for(var Mt=0;Mt<R+163&&jr[Mt]!=re[1];++Mt);Mt>=163&&qu(re[1],R+163)}else qu(re[1],re[0]);break;case 30:{U[R++]=re;for(var Xe=0;Xe<R+163&&jr[Xe]!=re;++Xe);Xe>=163&&qu(re,R+163)}break;case 229:ae=ae.concat(re);break;case 93:ee[re.cmo[0]]=Y.lastobj=re;break;case 438:Y.lastobj.TxO=re;break;case 127:Y.lastobj.ImData=re;break;case 440:for(w=re[0].s.r;w<=re[0].e.r;++w)for(v=re[0].s.c;v<=re[0].e.c;++v)p=t.dense?(s[w]||[])[v]:s[Or({c:v,r:w})],p&&(p.l=re[1]);break;case 2048:for(w=re[0].s.r;w<=re[0].e.r;++w)for(v=re[0].s.c;v<=re[0].e.c;++v)p=t.dense?(s[w]||[])[v]:s[Or({c:v,r:w})],p&&p.l&&(p.l.Tooltip=re[1]);break;case 28:{if(Y.biff<=5&&Y.biff>=2)break;p=t.dense?(s[re[0].r]||[])[re[0].c]:s[Or(re[0])];var De=ee[re[2]];p||(t.dense?(s[re[0].r]||(s[re[0].r]=[]),p=s[re[0].r][re[0].c]={t:"z"}):p=s[Or(re[0])]={t:"z"},i.e.r=Math.max(i.e.r,re[0].r),i.s.r=Math.min(i.s.r,re[0].r),i.e.c=Math.max(i.e.c,re[0].c),i.s.c=Math.min(i.s.c,re[0].c)),p.c||(p.c=[]),x={a:re[1],t:De.TxO.t},p.c.push(x)}break;case 2173:Lde(E[re.ixfe],re.ext);break;case 125:{if(!Y.cellStyles)break;for(;re.e>=re.s;)ne[re.e--]={width:re.w/256,level:re.level||0,hidden:!!(re.flags&1)},H||(H=!0,_3(re.w/256)),Ef(ne[re.e+1])}break;case 520:{var Le={};re.level!=null&&(L[re.r]=Le,Le.level=re.level),re.hidden&&(L[re.r]=Le,Le.hidden=!0),re.hpt&&(L[re.r]=Le,Le.hpt=re.hpt,Le.hpx=Em(re.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||qh(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=re;break;case 161:s["!margins"]||qh(s["!margins"]={}),s["!margins"].header=re.header,s["!margins"].footer=re.footer;break;case 574:re.RTL&&(F.Views[0].RTL=!0);break;case 146:P=re;break;case 2198:Z=re;break;case 140:N=re;break;case 442:u?A.CodeName=re||A.name:F.WBProps.CodeName=re||"ThisWorkbook";break}}else ce||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),e.l+=le}return r.SheetNames=Ls(a).sort(function(lt,Ue){return Number(lt)-Number(Ue)}).map(function(lt){return a[lt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&q.forEach(function(lt,Ue){r.Sheets[r.SheetNames[Ue]]["!autofilter"]=lt}),r.Strings=c,r.SSF=os(jr),Y.enc&&(r.Encryption=Y.enc),Z&&(r.Themes=Z),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),M.names.length>0&&(F.Names=M.names),r.Workbook=F,r}var Py={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Jme(e,t,r){var n=Tr.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=cO(n,gE,Py.DSI);for(var a in s)t[a]=s[a]}catch(u){if(r.WTF)throw u}var i=Tr.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=cO(i,mE,Py.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(L$(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Zme(e,t){var r=[],n=[],s=[],a=0,i,o=BF(gE,"n"),c=BF(mE,"n");if(e.Props)for(i=Ls(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=Ls(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var u=[];for(a=0;a<s.length;++a)G$.indexOf(s[a][0])>-1||M$.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&Tr.utils.cfb_add(t,"/SummaryInformation",uO(n,Py.SI,c,mE)),(r.length||u.length)&&Tr.utils.cfb_add(t,"/DocumentSummaryInformation",uO(r,Py.DSI,o,gE,u.length?u:null,Py.UDI))}function $U(e,t){t||(t={}),P3(t),J4(),t.codepage&&Q4(t.codepage);var r,n;if(e.FullPaths){if(Tr.find(e,"/encryption"))throw new Error("File is password-protected");r=Tr.find(e,"!CompObj"),n=Tr.find(e,"/Workbook")||Tr.find(e,"/Book")}else{switch(t.type){case"base64":e=Ho(Yo(e));break;case"binary":e=Ho(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}oi(e,0),n={content:e}}var s,a;if(r&&qme(r),t.bookProps&&!t.bookSheets)s={};else{var i=en?"buffer":"array";if(n&&n.content)s=Qme(n.content,t);else if((a=Tr.find(e,"PerfectOffice_MAIN"))&&a.content)s=Kh.to_workbook(a.content,(t.type=i,t));else if((a=Tr.find(e,"NativeContent_MAIN"))&&a.content)s=Kh.to_workbook(a.content,(t.type=i,t));else throw(a=Tr.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Tr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=ffe(e))}var o={};return e.FullPaths&&Jme(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function epe(e,t){var r=t||{},n=Tr.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Tr.utils.cfb_add(n,s,UU(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Zme(e,n),r.biff==8&&e.vbaraw&&hfe(n,Tr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var cv={0:{f:k0e},1:{f:F0e},2:{f:Q0e},3:{f:$0e},4:{f:R0e},5:{f:q0e},6:{f:rge},7:{f:H0e},8:{f:cge},9:{f:lge},10:{f:ige},11:{f:oge},12:{f:D0e},13:{f:Z0e},14:{f:z0e},15:{f:L0e},16:{f:FU},17:{f:sge},18:{f:V0e},19:{f:f3},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:sme},40:{},42:{},43:{f:rde},44:{f:ede},45:{f:ade},46:{f:ode},47:{f:ide},48:{},49:{f:Eoe},50:{},51:{f:Ude},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rU},62:{f:tge},63:{f:Xde},64:{f:Cge},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ii,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:bge},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:j0e},148:{f:E0e,p:16},151:{f:mge},152:{},153:{f:tme},154:{},155:{},156:{f:Zge},157:{},158:{},159:{T:1,f:xue},160:{T:-1},161:{T:1,f:O0},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:uge},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Bde},336:{T:-1},337:{f:Hde,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hE},357:{},358:{},359:{},360:{T:1},361:{},362:{f:tU},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:pge},427:{f:xge},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:vge},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:A0e},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:hge},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hE},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ofe},633:{T:1},634:{T:-1},635:{T:1,f:afe},636:{T:-1},637:{f:Poe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:zge},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Tge},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},bE={6:{f:Tk},10:{f:nf},12:{f:aa},13:{f:aa},14:{f:Ks},15:{f:Ks},16:{f:Ai},17:{f:Ks},18:{f:Ks},19:{f:aa},20:{f:pO},21:{f:pO},23:{f:tU},24:{f:yO},25:{f:Ks},26:{},27:{},28:{f:Tce},29:{},34:{f:Ks},35:{f:xO},38:{f:Ai},39:{f:Ai},40:{f:Ai},41:{f:Ai},42:{f:Ks},43:{f:Ks},47:{f:Lue},49:{f:Zle},51:{f:aa},60:{},61:{f:qle},64:{f:Ks},65:{f:Jle},66:{f:aa},77:{},80:{},81:{},82:{},85:{f:aa},89:{},90:{},91:{},92:{f:Mle},93:{f:Ace},94:{},95:{f:Ks},96:{},97:{},99:{f:Ks},125:{f:rU},128:{f:gce},129:{f:Ble},130:{f:aa},131:{f:Ks},132:{f:Ks},133:{f:$le},134:{},140:{f:Mce},141:{f:aa},144:{},146:{f:$ce},151:{},152:{},153:{},154:{},155:{},156:{f:aa},157:{},158:{},160:{f:Kce},161:{f:Wce},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:uce},190:{f:dce},193:{f:nf},197:{},198:{},199:{},200:{},201:{},202:{f:Ks},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:aa},220:{},221:{f:Ks},222:{},224:{f:hce},225:{f:Rle},226:{f:nf},227:{},229:{f:Ece},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:zle},253:{f:tce},255:{f:Hle},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:V$},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ks},353:{f:nf},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:vce},431:{f:Ks},432:{},433:{},434:{},437:{},438:{f:Fce},439:{f:Ks},440:{f:Oce},441:{},442:{f:Kv},443:{},444:{f:aa},445:{},446:{},448:{f:nf},449:{f:Kle,r:2},450:{f:nf},512:{f:hO},513:{f:Vce},515:{f:xce},516:{f:nce},517:{f:mO},519:{f:qce},520:{f:Gle},523:{},545:{f:vO},549:{f:fO},566:{},574:{f:Xle},638:{f:cce},659:{},1048:{},1054:{f:ace},1084:{},1212:{f:Sce},2048:{f:Ice},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:jw},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:nf},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Uce,r:12},2173:{f:Mde,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ks,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:_ce,r:12},2197:{},2198:{f:Pde,r:12},2199:{},2200:{},2201:{},2202:{f:kce,r:12},2203:{f:nf},2204:{},2205:{},2206:{},2207:{},2211:{f:Vle},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:aa},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Hce},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Bce},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:hO},1:{},2:{f:Zce},3:{f:Qce},4:{f:Xce},5:{f:mO},7:{f:tue},8:{},9:{f:jw},11:{},22:{f:aa},30:{f:oce},31:{},32:{},33:{f:vO},36:{},37:{f:fO},50:{f:rue},62:{},52:{},67:{},68:{f:aa},69:{},86:{},126:{},127:{f:Yce},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:nue},223:{},234:{},354:{},421:{},518:{f:Tk},521:{f:jw},536:{f:yO},547:{f:xO},561:{},579:{},1030:{f:Tk},1033:{f:jw},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Jt(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&c3(r)&&e.push(r)}}function tpe(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return Jt(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,c=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Qv(e,t,r){return e||(e=_t(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function rpe(e,t,r,n){var s=_t(9);return Qv(s,e,t),K$(r,n||"b",s),s}function npe(e,t,r){var n=_t(8+2*r.length);return Qv(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function spe(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Sa(is(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Jt(e,2,eue(r,n,s)):Jt(e,3,Jce(r,n,s));return;case"b":case"e":Jt(e,5,rpe(r,n,t.v,t.t));return;case"s":case"str":Jt(e,4,npe(r,n,(t.v||"").slice(0,255)));return}Jt(e,1,Qv(null,r,n))}function ape(e,t,r,n){var s=Array.isArray(t),a=pn(t["!ref"]||"A1"),i,o="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=Xr(a)}for(var u=a.s.r;u<=a.e.r;++u){o=Xs(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(c[d]=bs(d)),i=c[d]+o;var h=s?(t[u]||[])[d]:t[i];h&&spe(e,h,u,d)}}}function ipe(e,t){for(var r=t||{},n=Co(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Jt(n,r.biff==4?1033:r.biff==3?521:9,v3(e,16,r)),ape(n,e.Sheets[e.SheetNames[s]],s,r),Jt(n,10),n.end()}function ope(e,t,r){Jt(e,49,ece({sz:12,name:"Arial"},r))}function lpe(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Jt(e,1054,ice(s,t[s],r))})}function cpe(e,t){var r=_t(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Jt(e,2151,r),r=_t(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),J$(pn(t["!ref"]||"A1"),r),r.write_shift(4,4),Jt(e,2152,r)}function upe(e,t){for(var r=0;r<16;++r)Jt(e,224,gO({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Jt(e,224,gO(n,0,t))})}function dpe(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Jt(e,440,Dce(n)),n[1].Tooltip&&Jt(e,2048,Rce(n))}delete t["!links"]}function fpe(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&Jt(e,125,zce(f2(s,n),s))})}}function hpe(e,t,r,n,s){var a=16+$f(s.cellXfs,t,s);if(t.v==null&&!t.bf){Jt(e,513,x0(r,n,a));return}if(t.bf)Jt(e,6,Bhe(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?Sa(is(t.v)):t.v;Jt(e,515,yce(r,n,i,a));break;case"b":case"e":Jt(e,517,pce(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=E3(s.Strings,t.v,s.revStrings);Jt(e,253,rce(r,n,o,a))}else Jt(e,516,sce(r,n,(t.v||"").slice(0,255),a,s));break;default:Jt(e,513,x0(r,n,a))}}function gpe(e,t,r){var n=Co(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(a),u=t.biff==8,d,h="",g=[],p=pn(a["!ref"]||"A1"),x=u?65536:16384;if(p.e.c>255||p.e.r>=x){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}Jt(n,2057,v3(r,16,t)),Jt(n,13,vl(1)),Jt(n,12,vl(100)),Jt(n,15,Qi(!0)),Jt(n,17,Qi(!1)),Jt(n,16,m0(.001)),Jt(n,95,Qi(!0)),Jt(n,42,Qi(!1)),Jt(n,43,Qi(!1)),Jt(n,130,vl(1)),Jt(n,128,mce()),Jt(n,131,Qi(!1)),Jt(n,132,Qi(!1)),u&&fpe(n,a["!cols"]),Jt(n,512,lce(p,t)),u&&(a["!links"]=[]);for(var v=p.s.r;v<=p.e.r;++v){h=Xs(v);for(var w=p.s.c;w<=p.e.c;++w){v===p.s.r&&(g[w]=bs(w)),d=g[w]+h;var C=c?(a[v]||[])[w]:a[d];C&&(hpe(n,C,v,w,t),u&&C.l&&a["!links"].push([d,C.l]))}}var k=o.CodeName||o.name||s;return u&&Jt(n,574,Qle((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&Jt(n,229,Nce(a["!merges"])),u&&dpe(n,a),Jt(n,442,q$(k)),u&&cpe(n,a),Jt(n,10),n.end()}function mpe(e,t,r){var n=Co(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(Jt(n,2057,v3(e,5,r)),r.bookType=="xla"&&Jt(n,135),Jt(n,225,o?vl(1200):null),Jt(n,193,ple(2)),c&&Jt(n,191),c&&Jt(n,192),Jt(n,226),Jt(n,92,Lle("SheetJS",r)),Jt(n,66,vl(o?1200:1252)),o&&Jt(n,353,vl(0)),o&&Jt(n,448),Jt(n,317,Gce(e.SheetNames.length)),o&&e.vbaraw&&Jt(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";Jt(n,442,q$(u))}Jt(n,156,vl(17)),Jt(n,25,Qi(!1)),Jt(n,18,Qi(!1)),Jt(n,19,vl(0)),o&&Jt(n,431,Qi(!1)),o&&Jt(n,444,vl(0)),Jt(n,61,Yle()),Jt(n,64,Qi(!1)),Jt(n,141,vl(0)),Jt(n,34,Qi(Kge(e)=="true")),Jt(n,14,Qi(!0)),o&&Jt(n,439,Qi(!1)),Jt(n,218,vl(0)),ope(n,e,r),lpe(n,e.SSF,r),upe(n,r),o&&Jt(n,352,Qi(!1));var d=n.end(),h=Co();o&&Jt(h,140,Lce()),o&&r.Strings&&tpe(h,252,Wle(r.Strings)),Jt(h,10);var g=h.end(),p=Co(),x=0,v=0;for(v=0;v<e.SheetNames.length;++v)x+=(o?12:11)+(o?2:1)*e.SheetNames[v].length;var w=d.length+x+g.length;for(v=0;v<e.SheetNames.length;++v){var C=a[v]||{};Jt(p,133,Ule({pos:w,hs:C.Hidden||0,dt:0,name:e.SheetNames[v]},r)),w+=t[v].length}var k=p.end();if(x!=k.length)throw new Error("BS8 "+x+" != "+k.length);var b=[];return d.length&&b.push(d),k.length&&b.push(k),g.length&&b.push(g),La(b)}function ppe(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=os(jr)),e&&e.SSF&&(Zm(),a2(e.SSF),r.revssf=o2(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,F3(r),r.cellXfs=[],$f(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=gpe(s,r,e);return n.unshift(mpe(e,n,r)),La(n)}function UU(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=To(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return ppe(e,t);case 4:case 3:case 2:return ipe(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function AO(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,c=eoe(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,h=0,g=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<c.length;++i){var v=c[i].trim(),w=v.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(w!="<td"&&w!="<th")){var C=v.split(/<\/t[dh]>/i);for(o=0;o<C.length;++o){var k=C[o].trim();if(k.match(/<t[dh]/i)){for(var b=k,N=0;b.charAt(0)=="<"&&(N=b.indexOf(">"))>-1;)b=b.slice(N+1);for(var E=0;E<x.length;++E){var P=x[E];P.s.c==d&&P.s.r<u&&u<=P.e.r&&(d=P.e.c+1,E=-1)}var F=Ir(k.slice(0,k.indexOf(">")));g=F.colspan?+F.colspan:1,((h=+F.rowspan)>1||g>1)&&x.push({s:{r:u,c:d},e:{r:u+(h||1)-1,c:d+g-1}});var A=F.t||F["data-t"]||"";if(!b.length){d+=g;continue}if(b=d$(b),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!b.length){d+=g;continue}var j={t:"s",v:b};r.raw||!b.trim().length||A=="s"||(b==="TRUE"?j={t:"b",v:!0}:b==="FALSE"?j={t:"b",v:!1}:isNaN(lc(b))?isNaN(Cm(b).getDate())||(j={t:"d",v:is(b)},r.cellDates||(j={t:"n",v:Sa(j.v)}),j.z=r.dateNF||jr[14]):j={t:"n",v:lc(b)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=j):n[Or({r:u,c:d})]=j,d+=g}}}}return n["!ref"]=Xr(p),x.length&&(n["!merges"]=x),n}function xpe(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var d=Or({r,c:i}),h=n.dense?(e[r]||[])[i]:e[d],g=h&&h.v!=null&&(h.h||i3(h.w||(nd(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?g='<span contenteditable="true">'+g+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+h.l.Target+'">'+g+"</a>")),p.id=(n.id||"sjs")+"-"+d,a.push(Qt("td",g,p))}}var x="<tr>";return x+a.join("")+"</tr>"}var ype='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',vpe="</body></html>";function wpe(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Bf(AO(r[0],t),t);var n=I3();return r.forEach(function(s,a){R3(n,AO(s,t),"Sheet"+(a+1))}),n}function bpe(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function zU(e,t){var r=t||{},n=r.header!=null?r.header:ype,s=r.footer!=null?r.footer:vpe,a=[n],i=To(e["!ref"]);r.dense=Array.isArray(e),a.push(bpe(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(xpe(e,i,o,r));return a.push("</table>"+s),a.join("")}function WU(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?_s(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var d=To(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var h=[],g=0,p=e["!rows"]||(e["!rows"]=[]),x=0,v=0,w=0,C=0,k=0,b=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&v<c;++x){var N=o[x];if(jO(N)){if(n.display)continue;p[v]={hidden:!0}}var E=N.children;for(w=C=0;w<E.length;++w){var P=E[w];if(!(n.display&&jO(P))){var F=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):d$(P.innerHTML),A=P.getAttribute("data-z")||P.getAttribute("z");for(g=0;g<h.length;++g){var j=h[g];j.s.c==C+a&&j.s.r<v+s&&v+s<=j.e.r&&(C=j.e.c+1-a,g=-1)}b=+P.getAttribute("colspan")||1,((k=+P.getAttribute("rowspan")||1)>1||b>1)&&h.push({s:{r:v+s,c:C+a},e:{r:v+s+(k||1)-1,c:C+a+(b||1)-1}});var I={t:"s",v:F},B=P.getAttribute("data-t")||P.getAttribute("t")||"";F!=null&&(F.length==0?I.t=B||"z":n.raw||F.trim().length==0||B=="s"||(F==="TRUE"?I={t:"b",v:!0}:F==="FALSE"?I={t:"b",v:!1}:isNaN(lc(F))?isNaN(Cm(F).getDate())||(I={t:"d",v:is(F)},n.cellDates||(I={t:"n",v:Sa(I.v)}),I.z=n.dateNF||jr[14]):I={t:"n",v:lc(F)})),I.z===void 0&&A!=null&&(I.z=A);var Y="",Z=P.getElementsByTagName("A");if(Z&&Z.length)for(var ae=0;ae<Z.length&&!(Z[ae].hasAttribute("href")&&(Y=Z[ae].getAttribute("href"),Y.charAt(0)!="#"));++ae);Y&&Y.charAt(0)!="#"&&(I.l={Target:Y}),n.dense?(e[v+s]||(e[v+s]=[]),e[v+s][C+a]=I):e[Or({c:C+a,r:v+s})]=I,u.e.c<C+a&&(u.e.c=C+a),C+=b}}++v}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,v-1+s),e["!ref"]=Xr(u),v>=c&&(e["!fullref"]=Xr((u.e.r=o.length-x+v-1+s,u))),e}function HU(e,t){var r=t||{},n=r.dense?[]:{};return WU(n,e,t)}function _pe(e,t){return Bf(HU(e,t),t)}function jO(e){var t="",r=Spe(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Spe(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function kpe(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=mn(t.replace(/<[^>]*>/g,""));return[r]}var PO={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function GU(e,t){var r=t||{},n=o3(e),s=[],a,i,o={name:""},c="",u=0,d,h,g={},p=[],x=r.dense?[]:{},v,w,C={value:""},k="",b=0,N=[],E=-1,P=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,j={},I=[],B={},Y=0,Z=0,ae=[],ee=1,ne=1,L=[],H={Names:[]},M={},V=["",""],W=[],R={},U="",q=0,Q=!1,se=!1,X=0;for(nv.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=nv.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?x["!ref"]=Xr(F):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=F.e.r&&(x["!fullref"]=x["!ref"],F.e.r=r.sheetRows-1,x["!ref"]=Xr(F)),I.length&&(x["!merges"]=I),ae.length&&(x["!rows"]=ae),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),g[d.name]=x,se=!1):v[0].charAt(v[0].length-2)!=="/"&&(d=Ir(v[0],!1),E=P=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,x=r.dense?[]:{},I=[],ae=[],se=!0);break;case"table-row-group":v[1]==="/"?--A:++A;break;case"table-row":case"":if(v[1]==="/"){E+=ee,ee=1;break}if(h=Ir(v[0],!1),h.?E=h.-1:E==-1&&(E=0),ee=+h["number-rows-repeated"]||1,ee<10)for(X=0;X<ee;++X)A>0&&(ae[E+X]={level:A});P=-1;break;case"covered-table-cell":v[1]!=="/"&&++P,r.sheetStubs&&(r.dense?(x[E]||(x[E]=[]),x[E][P]={t:"z"}):x[Or({r:E,c:P})]={t:"z"}),k="",N=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++P,C=Ir(v[0],!1),ne=parseInt(C["number-columns-repeated"]||"1",10),w={t:"z",v:null},C.formula&&r.cellFormula!=!1&&(w.f=TO(mn(C.formula))),(C.||C["value-type"])=="string"&&(w.t="s",w.v=mn(C["string-value"]||""),r.dense?(x[E]||(x[E]=[]),x[E][P]=w):x[Or({r:E,c:P})]=w),P+=ne-1;else if(v[1]!=="/"){++P,k="",b=0,N=[],ne=1;var ie=ee?E+ee-1:E;if(P>F.e.c&&(F.e.c=P),P<F.s.c&&(F.s.c=P),E<F.s.r&&(F.s.r=E),ie>F.e.r&&(F.e.r=ie),C=Ir(v[0],!1),W=[],R={},w={t:C.||C["value-type"],v:null},r.cellFormula)if(C.formula&&(C.formula=mn(C.formula)),C["number-matrix-columns-spanned"]&&C["number-matrix-rows-spanned"]&&(Y=parseInt(C["number-matrix-rows-spanned"],10)||0,Z=parseInt(C["number-matrix-columns-spanned"],10)||0,B={s:{r:E,c:P},e:{r:E+Y-1,c:P+Z-1}},w.F=Xr(B),L.push([B,w.F])),C.formula)w.f=TO(C.formula);else for(X=0;X<L.length;++X)E>=L[X][0].s.r&&E<=L[X][0].e.r&&P>=L[X][0].s.c&&P<=L[X][0].e.c&&(w.F=L[X][1]);switch((C["number-columns-spanned"]||C["number-rows-spanned"])&&(Y=parseInt(C["number-rows-spanned"],10)||0,Z=parseInt(C["number-columns-spanned"],10)||0,B={s:{r:E,c:P},e:{r:E+Y-1,c:P+Z-1}},I.push(B)),C["number-columns-repeated"]&&(ne=parseInt(C["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=ns(C["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(C.value);break;case"percentage":w.t="n",w.v=parseFloat(C.value);break;case"currency":w.t="n",w.v=parseFloat(C.value);break;case"date":w.t="d",w.v=is(C["date-value"]),r.cellDates||(w.t="n",w.v=Sa(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=Qie(C["time-value"])/86400,r.cellDates&&(w.t="d",w.v=l2(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(C.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",C["string-value"]!=null&&(k=mn(C["string-value"]),N=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(Q=!1,w.t==="s"&&(w.v=k||"",N.length&&(w.R=N),Q=b==0),M.Target&&(w.l=M),W.length>0&&(w.c=W,W=[]),k&&r.cellText!==!1&&(w.w=k),Q&&(w.t="z",delete w.v),(!Q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var le=0;le<ee;++le){if(ne=parseInt(C["number-columns-repeated"]||"1",10),r.dense)for(x[E+le]||(x[E+le]=[]),x[E+le][P]=le==0?w:os(w);--ne>0;)x[E+le][P+ne]=os(w);else for(x[Or({r:E+le,c:P})]=w;--ne>0;)x[Or({r:E+le,c:P+ne})]=os(w);F.e.c<=P&&(F.e.c=P)}ne=parseInt(C["number-columns-repeated"]||"1",10),P+=ne-1,ne=0,w={},k="",N=[]}M={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a;R.t=k,N.length&&(R.R=N),R.a=U,W.push(R)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);U="",q=0,k="",b=0,N=[];break;case"creator":v[1]==="/"?U=n.slice(q,v.index):q=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);k="",b=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(j[o.name]=c,(a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&(c="",o=Ir(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Ir(v[0],!1),c+=PO[v[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Ir(v[0],!1),c+=PO[v[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,v.index);break}else u=v.index+v[0].length;break;case"named-range":i=Ir(v[0],!1),V=Ek(i["cell-range-address"]);var ce={Name:i.name,Ref:V[0]+"!"+V[1]};se&&(ce.Sheet=p.length),H.Names.push(ce);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!C||!C["string-value"])){var Se=kpe(n.slice(b,v.index));k=(k.length>0?k+`
`:"")+Se[0]}else Ir(v[0],!1),b=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{V=Ek(Ir(v[0])["target-range-address"]),g[V[0]]["!autofilter"]={ref:V[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(M=Ir(v[0],!1),!M.href)break;M.Target=mn(M.href),delete M.href,M.Target.charAt(0)=="#"&&M.Target.indexOf(".")>-1?(V=Ek(M.Target.slice(1)),M.Target="#"+V[0]+"!"+V[1]):M.Target.match(/^\.\.[\\\/]/)&&(M.Target=M.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var re={Sheets:g,SheetNames:p,Workbook:H};return r.bookSheets&&delete re.Sheets,re}function FO(e,t){t=t||{},yl(e,"META-INF/manifest.xml")&&Qoe(sa(e,"META-INF/manifest.xml"),t);var r=Go(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=GU(zn(r),t);return yl(e,"meta.xml")&&(n.Props=I$(sa(e,"meta.xml"))),n}function OO(e,t){return GU(e,t)}var Cpe=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+rv({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Js+t}})(),DO=(function(){var e=function(a){return Rn(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var c=[];c.push('      <table:table table:name="'+Rn(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,h=To(a["!ref"]||"A1"),g=a["!merges"]||[],p=0,x=Array.isArray(a);if(a["!cols"])for(d=0;d<=h.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var v="",w=a["!rows"]||[];for(u=0;u<h.s.r;++u)v=w[u]?' table:style-name="ro'+w[u].ods+'"':"",c.push("        <table:table-row"+v+`></table:table-row>
`);for(;u<=h.e.r;++u){for(v=w[u]?' table:style-name="ro'+w[u].ods+'"':"",c.push("        <table:table-row"+v+`>
`),d=0;d<h.s.c;++d)c.push(t);for(;d<=h.e.c;++d){var C=!1,k={},b="";for(p=0;p!=g.length;++p)if(!(g[p].s.c>d)&&!(g[p].s.r>u)&&!(g[p].e.c<d)&&!(g[p].e.r<u)){(g[p].s.c!=d||g[p].s.r!=u)&&(C=!0),k["table:number-columns-spanned"]=g[p].e.c-g[p].s.c+1,k["table:number-rows-spanned"]=g[p].e.r-g[p].s.r+1;break}if(C){c.push(r);continue}var N=Or({r:u,c:d}),E=x?(a[u]||[])[d]:a[N];if(E&&E.f&&(k["table:formula"]=Rn(Ghe(E.f)),E.F&&E.F.slice(0,N.length)==N)){var P=To(E.F);k["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,k["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!E){c.push(t);continue}switch(E.t){case"b":b=E.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=E.v?"true":"false";break;case"n":b=E.w||String(E.v||0),k["office:value-type"]="float",k["office:value"]=E.v||0;break;case"s":case"str":b=E.v==null?"":E.v,k["office:value-type"]="string";break;case"d":b=E.w||is(E.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=is(E.v).toISOString(),k["table:style-name"]="ce1";break;default:c.push(t);continue}var F=e(b);if(E.l&&E.l.Target){var A=E.l.Target;A=A.charAt(0)=="#"?"#"+Vhe(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),F=Qt("text:a",F,{"xlink:href":A.replace(/&/g,"&amp;")})}c.push("          "+Qt("table:table-cell",Qt("text:p",F,{}),k)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var h=u["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Ef(h),h.ods=o;var g=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),a.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var h=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var c=[Js],u=rv({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=rv({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(D$().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var h=0;h!=i.SheetNames.length;++h)c.push(n(i.Sheets[i.SheetNames[h]],i,h));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function VU(e,t){if(t.bookType=="fods")return DO(e,t);var r=n3(),n="",s=[],a=[];return n="mimetype",Jr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Jr(r,n,DO(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Jr(r,n,Cpe(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Jr(r,n,Js+D$()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Jr(r,n,ele(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Jr(r,n,Joe(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function y0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function _E(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):zn(Lf(e))}function Tpe(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ho(Hc(e))}function Epe(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Af(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function IO(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Npe(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Ape(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function uv(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Fn(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ms(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function yn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=uv(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=uv(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function ri(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Fn(n*8+s.type)),s.type==2&&t.push(Fn(s.data.length)),t.push(s.data))})}),Af(t)}function j3(e,t){return e?.map(function(r){return t(r.data)})||[]}function gl(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=uv(e,n),a=yn(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:Ms(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=yn(o.data),u=Ms(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=Ms(a[3][0].data)>>>0>0),r.push(i)}return r}function Rg(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Fn(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Fn(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:Fn(i.data.length)}],n[2].push({data:ri(i.meta),type:2})});var a=ri(n);t.push(Fn(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),Af(t)}function jpe(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=uv(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Af(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=Af(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function ml(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(jpe(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Af(t)}function Mg(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=Fn(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Af(t)}function Ppe(e,t,r,n){var s=y0(e),a=s.getUint32(4,!0),i=(n>1?12:8)+IO(a&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=IO(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:t[c]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(c>-1)h={t:"s",v:t[c]};else if(!isNaN(u))h={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function Fpe(e,t,r){var n=y0(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(c=Npe(e,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(i>-1)h={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return h}function Ak(e,t){var r=new Uint8Array(32),n=y0(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,Ape(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function jk(e,t){var r=new Uint8Array(32),n=y0(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function Ope(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Ppe(e,t,r,e[0]);case 5:return Fpe(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ci(e){var t=yn(e);return uv(t[1][0].data)}function RO(e,t){var r=yn(t.data),n=Ms(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=yn(i.data),c=Ms(o[1][0].data)>>>0;switch(n){case 1:a[c]=_E(o[3][0].data);break;case 8:{var u=e[Ci(o[9][0].data)][0],d=yn(u.data),h=e[Ci(d[1][0].data)][0],g=Ms(h.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var p=yn(h.data);a[c]=p[3].map(function(x){return _E(x.data)}).join("")}break}}),a}function Dpe(e,t){var r,n,s,a,i,o,c,u,d,h,g,p,x,v,w=yn(e),C=Ms(w[1][0].data)>>>0,k=Ms(w[2][0].data)>>>0,b=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Ms(w[8][0].data)>0||!1,N,E;if((a=(s=w[7])==null?void 0:s[0])!=null&&a.data&&t!=0)N=(o=(i=w[7])==null?void 0:i[0])==null?void 0:o.data,E=(u=(c=w[6])==null?void 0:c[0])==null?void 0:u.data;else if((h=(d=w[4])==null?void 0:d[0])!=null&&h.data&&t!=1)N=(p=(g=w[4])==null?void 0:g[0])==null?void 0:p.data,E=(v=(x=w[3])==null?void 0:x[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var P=b?4:1,F=y0(N),A=[],j=0;j<N.length/2;++j){var I=F.getUint16(j*2,!0);I<65535&&A.push([j,I])}if(A.length!=k)throw"Expected ".concat(k," cells, found ").concat(A.length);var B=[];for(j=0;j<A.length-1;++j)B[A[j][0]]=E.subarray(A[j][1]*P,A[j+1][1]*P);return A.length>=1&&(B[A[A.length-1][0]]=E.subarray(A[A.length-1][1]*P)),{R:C,cells:B}}function Ipe(e,t){var r,n=yn(t.data),s=(r=n?.[7])!=null&&r[0]?Ms(n[7][0].data)>>>0>0?1:0:-1,a=j3(n[5],function(i){return Dpe(i,s)});return{nrows:Ms(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=c}),i},[])}}function Rpe(e,t,r){var n,s=yn(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Ms(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Ms(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Xr(a);var i=yn(s[4][0].data),o=RO(e,e[Ci(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?RO(e,e[Ci(i[17][0].data)][0]):[],u=yn(i[3][0].data),d=0;u[1].forEach(function(h){var g=yn(h.data),p=e[Ci(g[2][0].data)][0],x=Ms(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var v=Ipe(e,p);v.data.forEach(function(w,C){w.forEach(function(k,b){var N=Or({r:d+C,c:b}),E=Ope(k,o,c);E&&(r[N]=E)})}),d+=v.nrows})}function Mpe(e,t){var r=yn(t.data),n={"!ref":"A1"},s=e[Ci(r[2][0].data)],a=Ms(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return Rpe(e,s[0],n),n}function Lpe(e,t){var r,n=yn(t.data),s={name:(r=n[1])!=null&&r[0]?_E(n[1][0].data):"",sheets:[]},a=j3(n[2],Ci);return a.forEach(function(i){e[i].forEach(function(o){var c=Ms(o.meta[1][0].data);c==6e3&&s.sheets.push(Mpe(e,o))})}),s}function Bpe(e,t){var r=I3(),n=yn(t.data),s=j3(n[1],Ci);if(s.forEach(function(a){e[a].forEach(function(i){var o=Ms(i.meta[1][0].data);if(o==2){var c=Lpe(e,i);c.sheets.forEach(function(u,d){R3(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Pk(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=ml(c.content)}catch(h){return console.log("?? "+c.content.length+" "+(h.message||h))}var d;try{d=gl(u)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){a[h.id]=h.messages,i.push(h.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Ms(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(c){a[c].forEach(function(u){var d=Ms(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Bpe(a,o)}function $pe(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&Ms(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=y0(e[7][0].data),d=0,h=[],g=y0(e[4][0].data),p=0,x=[],v=0;v<t.length;++v){if(t[v]==null){u.setUint16(v*2,65535,!0),g.setUint16(v*2,65535);continue}u.setUint16(v*2,d,!0),g.setUint16(v*2,p,!0);var w,C;switch(typeof t[v]){case"string":w=Ak({t:"s",v:t[v]},r),C=jk({t:"s",v:t[v]},r);break;case"number":w=Ak({t:"n",v:t[v]},r),C=jk({t:"n",v:t[v]},r);break;case"boolean":w=Ak({t:"b",v:t[v]},r),C=jk({t:"b",v:t[v]},r);break;default:throw new Error("Unsupported value "+t[v])}h.push(w),d+=w.length,x.push(C),p+=C.length,++c}for(e[2][0].data=Fn(c);v<e[7][0].data.length/2;++v)u.setUint16(v*2,65535,!0),g.setUint16(v*2,65535,!0);return e[6][0].data=Af(h),e[3][0].data=Af(x),c}function Upe(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=To(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Xr(n)));var a=Yb(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(U){return U.forEach(function(q){typeof q=="string"&&i.push(q)})});var o={},c=[],u=Tr.read(t.numbers,{type:"base64"});u.FileIndex.map(function(U,q){return[U,u.FullPaths[q]]}).forEach(function(U){var q=U[0],Q=U[1];if(q.type==2&&q.name.match(/\.iwa/)){var se=q.content,X=ml(se),ie=gl(X);ie.forEach(function(le){c.push(le.id),o[le.id]={deps:[],location:Q,type:Ms(le.messages[0].meta[1][0].data)}})}}),c.sort(function(U,q){return U-q});var d=c.filter(function(U){return U>1}).map(function(U){return[U,Fn(U)]});u.FileIndex.map(function(U,q){return[U,u.FullPaths[q]]}).forEach(function(U){var q=U[0];if(U[1],!!q.name.match(/\.iwa/)){var Q=gl(ml(q.content));Q.forEach(function(se){se.messages.forEach(function(X){d.forEach(function(ie){se.messages.some(function(le){return Ms(le.meta[1][0].data)!=11006&&Epe(le.data,ie[1])})&&o[ie[0]].deps.push(se.id)})})})}});for(var h=Tr.find(u,o[1].location),g=gl(ml(h.content)),p,x=0;x<g.length;++x){var v=g[x];v.id==1&&(p=v)}var w=Ci(yn(p.messages[0].data)[1][0].data);for(h=Tr.find(u,o[w].location),g=gl(ml(h.content)),x=0;x<g.length;++x)v=g[x],v.id==w&&(p=v);for(w=Ci(yn(p.messages[0].data)[2][0].data),h=Tr.find(u,o[w].location),g=gl(ml(h.content)),x=0;x<g.length;++x)v=g[x],v.id==w&&(p=v);for(w=Ci(yn(p.messages[0].data)[2][0].data),h=Tr.find(u,o[w].location),g=gl(ml(h.content)),x=0;x<g.length;++x)v=g[x],v.id==w&&(p=v);var C=yn(p.messages[0].data);{C[6][0].data=Fn(n.e.r+1),C[7][0].data=Fn(n.e.c+1);var k=Ci(C[46][0].data),b=Tr.find(u,o[k].location),N=gl(ml(b.content));{for(var E=0;E<N.length&&N[E].id!=k;++E);if(N[E].id!=k)throw"Bad ColumnRowUIDMapArchive";var P=yn(N[E].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var F=0;F<=n.e.c;++F){var A=[];A[1]=A[2]=[{type:0,data:Fn(F+420690)}],P[1].push({type:2,data:ri(A)}),P[2].push({type:0,data:Fn(F)}),P[3].push({type:0,data:Fn(F)})}P[4]=[],P[5]=[],P[6]=[];for(var j=0;j<=n.e.r;++j)A=[],A[1]=A[2]=[{type:0,data:Fn(j+726270)}],P[4].push({type:2,data:ri(A)}),P[5].push({type:0,data:Fn(j)}),P[6].push({type:0,data:Fn(j)});N[E].messages[0].data=ri(P)}b.content=Mg(Rg(N)),b.size=b.content.length,delete C[46];var I=yn(C[4][0].data);{I[7][0].data=Fn(n.e.r+1);var B=yn(I[1][0].data),Y=Ci(B[2][0].data);b=Tr.find(u,o[Y].location),N=gl(ml(b.content));{if(N[0].id!=Y)throw"Bad HeaderStorageBucket";var Z=yn(N[0].messages[0].data);for(j=0;j<a.length;++j){var ae=yn(Z[2][0].data);ae[1][0].data=Fn(j),ae[4][0].data=Fn(a[j].length),Z[2][j]={type:Z[2][0].type,data:ri(ae)}}N[0].messages[0].data=ri(Z)}b.content=Mg(Rg(N)),b.size=b.content.length;var ee=Ci(I[2][0].data);b=Tr.find(u,o[ee].location),N=gl(ml(b.content));{if(N[0].id!=ee)throw"Bad HeaderStorageBucket";for(Z=yn(N[0].messages[0].data),F=0;F<=n.e.c;++F)ae=yn(Z[2][0].data),ae[1][0].data=Fn(F),ae[4][0].data=Fn(n.e.r+1),Z[2][F]={type:Z[2][0].type,data:ri(ae)};N[0].messages[0].data=ri(Z)}b.content=Mg(Rg(N)),b.size=b.content.length;var ne=Ci(I[4][0].data);(function(){for(var U=Tr.find(u,o[ne].location),q=gl(ml(U.content)),Q,se=0;se<q.length;++se){var X=q[se];X.id==ne&&(Q=X)}var ie=yn(Q.messages[0].data);{ie[3]=[];var le=[];i.forEach(function(re,ge){le[1]=[{type:0,data:Fn(ge)}],le[2]=[{type:0,data:Fn(1)}],le[3]=[{type:2,data:Tpe(re)}],ie[3].push({type:2,data:ri(le)})})}Q.messages[0].data=ri(ie);var ce=Rg(q),Se=Mg(ce);U.content=Se,U.size=U.content.length})();var L=yn(I[3][0].data);{var H=L[1][0];delete L[2];var M=yn(H.data);{var V=Ci(M[2][0].data);(function(){for(var U=Tr.find(u,o[V].location),q=gl(ml(U.content)),Q,se=0;se<q.length;++se){var X=q[se];X.id==V&&(Q=X)}var ie=yn(Q.messages[0].data);{delete ie[6],delete L[7];var le=new Uint8Array(ie[5][0].data);ie[5]=[];for(var ce=0,Se=0;Se<=n.e.r;++Se){var re=yn(le);ce+=$pe(re,a[Se],i),re[1][0].data=Fn(Se),ie[5].push({data:ri(re),type:2})}ie[1]=[{type:0,data:Fn(n.e.c+1)}],ie[2]=[{type:0,data:Fn(n.e.r+1)}],ie[3]=[{type:0,data:Fn(ce)}],ie[4]=[{type:0,data:Fn(n.e.r+1)}]}Q.messages[0].data=ri(ie);var ge=Rg(q),Ee=Mg(ge);U.content=Ee,U.size=U.content.length})()}H.data=ri(M)}I[3][0].data=ri(L)}C[4][0].data=ri(I)}p.messages[0].data=ri(C);var W=Rg(g),R=Mg(W);return h.content=R,h.size=h.content.length,u}function KU(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function P3(e){KU([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function F3(e){KU([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function zpe(e){return an.WS.indexOf(e)>-1?"sheet":e==an.CS?"chart":e==an.DS?"dialog":e==an.MS?"macro":e&&e.length?e:"sheet"}function Wpe(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,zpe(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Hpe(e,t,r,n,s,a,i,o,c,u,d,h){try{a[n]=Ey(Go(e,r,!0),t);var g=sa(e,t),p;switch(o){case"sheet":p=fme(g,t,s,c,a[n],u,d,h);break;case"chart":if(p=hme(g,t,s,c,a[n],u,d,h),!p||!p["!drawel"])break;var x=dy(p["!drawel"].Target,t),v=sv(x),w=Zde(Go(e,x,!0),Ey(Go(e,v,!0),x)),C=dy(w,x),k=sv(C);p=$ge(Go(e,C,!0),C,c,Ey(Go(e,k,!0),C),u,p);break;case"macro":p=gme(g,t,s,c,a[n],u,d,h);break;case"dialog":p=mme(g,t,s,c,a[n],u,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var b=[];a&&a[n]&&Ls(a[n]).forEach(function(N){var E="";if(a[n][N].Type==an.CMNT){E=dy(a[n][N].Target,t);var P=vme(sa(e,E,!0),E,c);if(!P||!P.length)return;bO(p,P,!1)}a[n][N].Type==an.TCMNT&&(E=dy(a[n][N].Target,t),b=b.concat(tfe(sa(e,E,!0),c)))}),b&&b.length&&bO(p,b,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function fl(e){return e.charAt(0)=="/"?e.slice(1):e}function Gpe(e,t){if(Zm(),t=t||{},P3(t),yl(e,"META-INF/manifest.xml")||yl(e,"objectdata.xml"))return FO(e,t);if(yl(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Pk<"u"){if(e.FileIndex)return Pk(e);var r=Tr.utils.cfb_new();return zF(e).forEach(function(ae){Jr(r,ae,roe(e,ae))}),Pk(r)}throw new Error("Unsupported NUMBERS file")}if(!yl(e,"[Content_Types].xml"))throw yl(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):yl(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=zF(e),s=Yoe(Go(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",sa(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!sa(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Ny=[],s.sst)try{Ny=yme(sa(e,fl(s.sst)),s.sst,t)}catch(ae){if(t.WTF)throw ae}t.cellStyles&&s.themes.length&&(c=xme(Go(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=pme(sa(e,fl(s.style)),s.style,c,t))}s.links.map(function(ae){try{var ee=Ey(Go(e,sv(fl(ae))),ae);return bme(sa(e,fl(ae)),ee,ae,t)}catch{}});var d=dme(sa(e,fl(s.workbooks[0])),s.workbooks[0],t),h={},g="";s.coreprops.length&&(g=sa(e,fl(s.coreprops[0]),!0),g&&(h=I$(g)),s.extprops.length!==0&&(g=sa(e,fl(s.extprops[0]),!0),g&&rle(g,h,t)));var p={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(g=Go(e,fl(s.custprops[0]),!0),g&&(p=sle(g,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(ee){return ee.name}):h.Worksheets&&h.SheetNames.length>0&&(i=h.SheetNames),t.bookProps&&(x.Props=h,x.Custprops=p),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var v={};t.bookDeps&&s.calcchain&&(v=wme(sa(e,fl(s.calcchain)),s.calcchain));var w=0,C={},k,b;{var N=d.Sheets;h.Worksheets=N.length,h.SheetNames=[];for(var E=0;E!=N.length;++E)h.SheetNames[E]=N[E].name}var P=a?"bin":"xml",F=s.workbooks[0].lastIndexOf("/"),A=(s.workbooks[0].slice(0,F+1)+"_rels/"+s.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");yl(e,A)||(A="xl/_rels/workbook."+P+".rels");var j=Ey(Go(e,A,!0),A.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=_me(sa(e,fl(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=nfe(sa(e,fl(s.people[0])),t)),j&&(j=Wpe(j,d.Sheets));var I=sa(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var B="sheet";if(j&&j[w]?(k="xl/"+j[w][1].replace(/[\/]?xl\//,""),yl(e,k)||(k=j[w][1]),yl(e,k)||(k=A.replace(/_rels\/.*$/,"")+j[w][1]),B=j[w][2]):(k="xl/worksheets/sheet"+(w+1-I)+"."+P,k=k.replace(/sheet0\./,"sheet.")),b=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Y=!1,Z=0;Z!=t.sheets.length;++Z)typeof t.sheets[Z]=="number"&&t.sheets[Z]==w&&(Y=1),typeof t.sheets[Z]=="string"&&t.sheets[Z].toLowerCase()==h.SheetNames[w].toLowerCase()&&(Y=1);if(!Y)continue e}}Hpe(e,k,b,h.SheetNames[w],w,C,i,B,t,d,c,u)}return x={Directory:s,Workbook:d,Props:h,Custprops:p,Deps:v,Sheets:i,SheetNames:h.SheetNames,Strings:Ny,Styles:u,Themes:c,SSF:os(jr)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(ae,ee){ae=ae.replace(/^Root Entry[\/]/,""),x.keys.push(ae),x.files[ae]=e.FileIndex[ee]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=sa(e,fl(s.vba[0]),!0):s.defaults&&s.defaults.bin===dfe&&(x.vbaraw=sa(e,"xl/vbaProject.bin",!0))),x}function Vpe(e,t){var r=t||{},n="Workbook",s=Tr.find(e,n);try{if(n="/!DataSpaces/Version",s=Tr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(_ue(s.content),n="/!DataSpaces/DataSpaceMap",s=Tr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=kue(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Tr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Cue(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Tr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Eue(s.content)}catch{}if(n="/EncryptionInfo",s=Tr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Nue(s.content);if(n="/EncryptedPackage",s=Tr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Kpe(e,t){return t.bookType=="ods"?VU(e,t):t.bookType=="numbers"?Upe(e,t):t.bookType=="xlsb"?qpe(e,t):Ype(e,t)}function qpe(e,t){tm=1024,e&&!e.SSF&&(e.SSF=os(jr)),e&&e.SSF&&(Zm(),a2(e.SSF),t.revssf=o2(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ay?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=wU.indexOf(t.bookType)>-1,s=x3();F3(t=t||{});var a=n3(),i="",o=0;if(t.cellXfs=[],$f(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Jr(a,i,R$(e.Props,t)),s.coreprops.push(i),Dn(t.rels,2,i,an.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Jr(a,i,B$(e.Props)),s.extprops.push(i),Dn(t.rels,3,i,an.EXT_PROPS),e.Custprops!==e.Props&&Ls(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Jr(a,i,$$(e.Custprops)),s.custprops.push(i),Dn(t.rels,4,i,an.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],g=(h||{})["!type"]||"sheet";switch(g){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Jr(a,i,kme(o-1,i,t,e,d)),s.sheets.push(i),Dn(t.wbrels,-1,"worksheets/sheet"+o+"."+r,an.WS[0])}if(h){var p=h["!comments"],x=!1,v="";p&&p.length>0&&(v="xl/comments"+o+"."+r,Jr(a,v,Eme(p,v)),s.comments.push(v),Dn(d,-1,"../comments"+o+"."+r,an.CMNT),x=!0),h["!legacy"]&&x&&Jr(a,"xl/drawings/vmlDrawing"+o+".vml",yU(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Jr(a,sv(i),dm(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Jr(a,i,Tme(t.Strings,i,t)),s.strs.push(i),Dn(t.wbrels,-1,"sharedStrings."+r,an.SST)),i="xl/workbook."+r,Jr(a,i,Sme(e,i)),s.workbooks.push(i),Dn(t.rels,1,i,an.WB),i="xl/theme/theme1.xml",Jr(a,i,S3(e.Themes,t)),s.themes.push(i),Dn(t.wbrels,-1,"theme/theme1.xml",an.THEME),i="xl/styles."+r,Jr(a,i,Cme(e,i,t)),s.styles.push(i),Dn(t.wbrels,-1,"styles."+r,an.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Jr(a,i,e.vbaraw),s.vba.push(i),Dn(t.wbrels,-1,"vbaProject.bin",an.VBA)),i="xl/metadata."+r,Jr(a,i,Nme(i)),s.metadata.push(i),Dn(t.wbrels,-1,"metadata."+r,an.XLMETA),Jr(a,"[Content_Types].xml",O$(s,t)),Jr(a,"_rels/.rels",dm(t.rels)),Jr(a,"xl/_rels/workbook."+r+".rels",dm(t.wbrels)),delete t.revssf,delete t.ssf,a}function Ype(e,t){tm=1024,e&&!e.SSF&&(e.SSF=os(jr)),e&&e.SSF&&(Zm(),a2(e.SSF),t.revssf=o2(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ay?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=wU.indexOf(t.bookType)>-1,s=x3();F3(t=t||{});var a=n3(),i="",o=0;if(t.cellXfs=[],$f(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Jr(a,i,R$(e.Props,t)),s.coreprops.push(i),Dn(t.rels,2,i,an.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Jr(a,i,B$(e.Props)),s.extprops.push(i),Dn(t.rels,3,i,an.EXT_PROPS),e.Custprops!==e.Props&&Ls(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Jr(a,i,$$(e.Custprops)),s.custprops.push(i),Dn(t.rels,4,i,an.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},g=e.Sheets[e.SheetNames[o-1]],p=(g||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Jr(a,i,PU(o-1,t,e,h)),s.sheets.push(i),Dn(t.wbrels,-1,"worksheets/sheet"+o+"."+r,an.WS[0])}if(g){var x=g["!comments"],v=!1,w="";if(x&&x.length>0){var C=!1;x.forEach(function(k){k[1].forEach(function(b){b.T==!0&&(C=!0)})}),C&&(w="xl/threadedComments/threadedComment"+o+"."+r,Jr(a,w,rfe(x,d,t)),s.threadedcomments.push(w),Dn(h,-1,"../threadedComments/threadedComment"+o+"."+r,an.TCMNT)),w="xl/comments"+o+"."+r,Jr(a,w,vU(x)),s.comments.push(w),Dn(h,-1,"../comments"+o+"."+r,an.CMNT),v=!0}g["!legacy"]&&v&&Jr(a,"xl/drawings/vmlDrawing"+o+".vml",yU(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}h["!id"].rId1&&Jr(a,sv(i),dm(h))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Jr(a,i,iU(t.Strings,t)),s.strs.push(i),Dn(t.wbrels,-1,"sharedStrings."+r,an.SST)),i="xl/workbook."+r,Jr(a,i,RU(e)),s.workbooks.push(i),Dn(t.rels,1,i,an.WB),i="xl/theme/theme1.xml",Jr(a,i,S3(e.Themes,t)),s.themes.push(i),Dn(t.wbrels,-1,"theme/theme1.xml",an.THEME),i="xl/styles."+r,Jr(a,i,gU(e,t)),s.styles.push(i),Dn(t.wbrels,-1,"styles."+r,an.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Jr(a,i,e.vbaraw),s.vba.push(i),Dn(t.wbrels,-1,"vbaProject.bin",an.VBA)),i="xl/metadata."+r,Jr(a,i,xU()),s.metadata.push(i),Dn(t.wbrels,-1,"metadata."+r,an.XLMETA),d.length>1&&(i="xl/persons/person.xml",Jr(a,i,sfe(d)),s.people.push(i),Dn(t.wbrels,-1,"persons/person.xml",an.PEOPLE)),Jr(a,"[Content_Types].xml",O$(s,t)),Jr(a,"_rels/.rels",dm(t.rels)),Jr(a,"xl/_rels/workbook."+r+".rels",dm(t.wbrels)),delete t.revssf,delete t.ssf,a}function O3(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Yo(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Xpe(e,t){return Tr.find(e,"EncryptedPackage")?Vpe(e,t):$U(e,t)}function Qpe(e,t){var r,n=e,s=t||{};return s.type||(s.type=en&&Buffer.isBuffer(e)?"buffer":"base64"),r=l$(n,s),Gpe(r,s)}function qU(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return wE(e.slice(r),t);default:break e}return Tm.to_workbook(e,t)}function Jpe(e,t){var r="",n=O3(e,t);switch(t.type){case"base64":r=Yo(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=g0(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=zn(r)),t.type="binary",qU(r,t)}function Zpe(e,t){var r=e;return t.type=="base64"&&(r=Yo(r)),r=Jy.utils.decode(1200,r.slice(2),"str"),t.type="binary",qU(r,t)}function exe(e){return e.match(/[^\x00-\x7F]/)?Hc(e):e}function Fk(e,t,r,n){return n?(r.type="string",Tm.to_workbook(e,r)):Tm.to_workbook(t,r)}function SE(e,t){J4();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return SE(new Uint8Array(e),(r=os(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),hm={},r.dateNF&&(hm.dateNF=r.dateNF),r.type||(r.type=en&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=en?"buffer":"binary",n=qie(e),typeof Uint8Array<"u"&&!en&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=exe(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=os(r),r.type="array",SE(Z4(n),r)}switch((s=O3(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Xpe(Tr.read(n,r),r);break;case 9:if(s[1]<=8)return $U(n,r);break;case 60:return wE(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return aue(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return sU.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Qpe(n,r):Fk(e,n,r,a);case 239:return s[3]===60?wE(n,r):Fk(e,n,r,a);case 255:if(s[1]===254)return Zpe(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Kh.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Kh.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return vE.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return dU.to_workbook(n,r);break;case 10:case 13:case 32:return Jpe(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return sue.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?vE.to_workbook(n,r):Fk(e,n,r,a)}function YU(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Hv(t.file,Tr.write(e,{type:en?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Tr.write(e,t)}function txe(e,t){var r=os(t||{}),n=Kpe(e,r);return rxe(n,r)}function rxe(e,t){var r={},n=en?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Tr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(s2(s))}return t.password&&typeof encrypt_agile<"u"?YU(encrypt_agile(s,t.password),t):t.type==="file"?Hv(t.file,s):t.type=="string"?zn(s):s}function nxe(e,t){var r=t||{},n=epe(e,r);return YU(n,r)}function Lc(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Zy(Hc(n));case"binary":return Hc(n);case"string":return e;case"file":return Hv(t.file,n,"utf8");case"buffer":return en?ud(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Lc(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function sxe(e,t){switch(t.type){case"base64":return Zy(e);case"binary":return e;case"string":return e;case"file":return Hv(t.file,e,"binary");case"buffer":return en?ud(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Dw(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Zy(r):t.type=="string"?zn(r):r;case"file":return Hv(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function XU(e,t){J4(),Xge(e);var r=os(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=XU(e,r);return r.type="array",s2(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Lc(Kme(e,r),r);case"slk":case"sylk":return Lc(nU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Lc(zU(e.Sheets[e.SheetNames[s]],r),r);case"txt":return sxe(QU(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Lc(D3(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Lc(sU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Dw(vE.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Lc(Tm.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Lc(dU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Lc(aU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Lc(VU(e,r),r);case"wk1":return Dw(Kh.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Dw(Kh.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Dw(UU(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),nxe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return txe(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function axe(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function ixe(e,t,r){var n={};return n.type="file",n.file=t,axe(n),XU(e,n)}function oxe(e,t,r,n,s,a,i,o){var c=Xs(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,g=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=i?e[r][p]:e[n[p]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;a[p]!=null&&(g[a[p]]=u);continue}var v=x.v;switch(x.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[p]!=null){if(v==null)if(x.t=="e"&&v===null)g[a[p]]=null;else if(u!==void 0)g[a[p]]=u;else if(d&&v===null)g[a[p]]=null;else continue;else g[a[p]]=d&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?v:nd(x,v,o);v!=null&&(h=!1)}}return{row:g,isempty:h}}function Yb(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=pn(d);break;case"number":c=pn(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var h=Xs(c.s.r),g=[],p=[],x=0,v=0,w=Array.isArray(e),C=c.s.r,k=0,b={};w&&!e[C]&&(e[C]=[]);var N=u.skipHidden&&e["!cols"]||[],E=u.skipHidden&&e["!rows"]||[];for(k=c.s.c;k<=c.e.c;++k)if(!(N[k]||{}).hidden)switch(g[k]=bs(k),r=w?e[C][k]:e[g[k]+h],n){case 1:a[k]=k-c.s.c;break;case 2:a[k]=g[k];break;case 3:a[k]=u.header[k-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=nd(r,null,u),v=b[i]||0,!v)b[i]=1;else{do o=i+"_"+v++;while(b[o]);b[i]=v,b[o]=1}a[k]=o}for(C=c.s.r+s;C<=c.e.r;++C)if(!(E[C]||{}).hidden){var P=oxe(e,c,C,g,n,a,w,u);(P.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[x++]=P.row)}return p.length=x,p}var MO=/"/g;function lxe(e,t,r,n,s,a,i,o){for(var c=!0,u=[],d="",h=Xs(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var p=o.dense?(e[r]||[])[g]:e[n[g]+h];if(p==null)d="";else if(p.v!=null){c=!1,d=""+(o.rawNumbers&&p.t=="n"?p.v:nd(p,null,o));for(var x=0,v=0;x!==d.length;++x)if((v=d.charCodeAt(x))===s||v===a||v===34||o.forceQuotes){d='"'+d.replace(MO,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(c=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(MO,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(i)}function D3(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=pn(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",h=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(g[x]||{}).hidden||(h[x]=bs(x));for(var v=0,w=s.s.r;w<=s.e.r;++w)(p[w]||{}).hidden||(d=lxe(e,s,w,h,i,c,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((v++?o:"")+d)));return delete n.dense,r.join("")}function QU(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=D3(e,t);return r}function cxe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=pn(e["!ref"]),a="",i=[],o,c=[],u=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=bs(o);for(var d=s.s.r;d<=s.e.r;++d)for(a=Xs(d),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=u?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function JU(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?_s(n.origin):n.origin;i=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var h=pn(a["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),i==-1&&(i=h.e.r+1,d.e.r=i+t.length-1+s)}else i==-1&&(i=0,d.e.r=t.length-1+s);var g=n.header||[],p=0;t.forEach(function(v,w){Ls(v).forEach(function(C){(p=g.indexOf(C))==-1&&(g[p=g.length]=C);var k=v[C],b="z",N="",E=Or({c:o+p,r:i+w+s});u=dv(a,E),k&&typeof k=="object"&&!(k instanceof Date)?a[E]=k:(typeof k=="number"?b="n":typeof k=="boolean"?b="b":typeof k=="string"?b="s":k instanceof Date?(b="d",n.cellDates||(b="n",k=Sa(k)),N=n.dateNF||jr[14]):k===null&&n.nullError&&(b="e",k=0),u?(u.t=b,u.v=k,delete u.w,delete u.R,N&&(u.z=N)):a[E]=u={t:b,v:k},N&&(u.z=N))})}),d.e.c=Math.max(d.e.c,o+g.length-1);var x=Xs(i);if(s)for(p=0;p<g.length;++p)a[bs(p+o)+x]={t:"s",v:g[p]};return a["!ref"]=Xr(d),a}function uxe(e,t){return JU(null,e,t)}function dv(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=_s(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?dv(e,Or(t)):dv(e,Or({r:t,c:r||0}))}function dxe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function I3(){return{SheetNames:[],Sheets:{}}}function R3(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(IU(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function fxe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=dxe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function hxe(e,t){return e.z=t,e}function ZU(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function gxe(e,t,r){return ZU(e,"#"+t,r)}function mxe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function pxe(e,t,r,n){for(var s=typeof t!="string"?t:pn(t),a=typeof t=="string"?t:Xr(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var c=dv(e,i,o);c.t="n",c.F=a,delete c.v,i==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var ab={encode_col:bs,encode_row:Xs,encode_cell:Or,encode_range:Xr,decode_col:d3,decode_row:u3,split_cell:Toe,decode_cell:_s,decode_range:To,format_cell:nd,sheet_add_aoa:T$,sheet_add_json:JU,sheet_add_dom:WU,aoa_to_sheet:ep,json_to_sheet:uxe,table_to_sheet:HU,table_to_book:_pe,sheet_to_csv:D3,sheet_to_txt:QU,sheet_to_json:Yb,sheet_to_html:zU,sheet_to_formulae:cxe,sheet_to_row_object_array:Yb,sheet_get_cell:dv,book_new:I3,book_append_sheet:R3,book_set_sheet_visibility:fxe,cell_set_number_format:hxe,cell_set_hyperlink:ZU,cell_set_internal_link:gxe,cell_add_comment:mxe,sheet_set_array_formula:pxe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const ez=({onBackToCabinet:e,selectedGrade:t,selectedClass:r,openRetestModal:n,forceRefreshOnMount:s=!1})=>{Eo(),P_();const{user:a,isAuthenticated:i}=cs(),{showNotification:o}=za(),c=S.useCallback(rt=>{let gt=null;if(typeof rt?.percentage=="number"&&!Number.isNaN(rt.percentage))return gt=Math.round(rt.percentage),console.debug("[TeacherResults] Using provided percentage",{percentage:rt.percentage,rounded:gt,result:rt}),gt;const Vt=rt?.retest_best_score??rt?.score,kt=rt?.retest_best_max_score??rt?.max_score,br=Number(Vt??0),jt=Number(kt??0);return jt>0&&(gt=Math.round(br/jt*100)),gt},[]);S.useCallback(rt=>{const gt=c(rt);return gt===null?"text-gray-600":gt<50?"text-red-600 font-semibold":gt<70?"text-yellow-600":"text-green-600"},[c]),S.useCallback(rt=>{const gt=c(rt);return gt!==null&&gt<50},[c]);const[u,d]=S.useState(null),[h,g]=S.useState(!0),[p,x]=S.useState(""),[v,w]=S.useState([]),[C,k]=S.useState(null),[b,N]=S.useState(!1),[E,P]=S.useState([]),[F,A]=S.useState([]),[j,I]=S.useState([1,2]),[B,Y]=S.useState(null),[Z,ae]=S.useState(null),[ee,ne]=S.useState(null),[L,H]=S.useState("main"),[M,V]=S.useState(null),[W,R]=S.useState(null),U=M||t,q=W||r,[Q,se]=S.useState(null),[X,ie]=S.useState({}),[le,ce]=S.useState(!1),[Se,re]=S.useState(new Set),[ge,Ee]=S.useState(!0),[Ae,He]=S.useState(null),[Be,Rt]=S.useState(null),[et,vt]=S.useState(!1),[xt,it]=S.useState(!1),[ht,Dt]=S.useState(!1),Mt=S.useRef(null),[Xe,De]=S.useState(null),[Le,lt]=S.useState(!1),[Ue,tt]=S.useState(null),[Et,At]=S.useState(!1),[qt,pr]=S.useState(null),[Rr,Kr]=S.useState(""),[ur,ir]=S.useState(""),[me,Ne]=S.useState(!1),[Pe,Re]=S.useState(!1),[Ct,Fe]=S.useState(null),[st,ke]=S.useState(""),[We,Qe]=S.useState(!1),[Pt,zt]=S.useState(new Set),[rr,xr]=S.useState({}),[cr,qr]=S.useState(!1),[ue,we]=S.useState(null),[ye,xe]=S.useState(""),[be,_e]=S.useState(!1),[Ge,ut]=S.useState(null),[qe,oe]=S.useState(null),[he,Te]=S.useState(!1),[Ce,Ke]=S.useState(!1),[ot,mt]=S.useState({}),Wt=S.useRef(new Set),pt=S.useRef({}),Yt=S.useRef(null);S.useEffect(()=>{console.log(" editingColumns state changed:",Array.from(Pt)),Wt.current=Pt},[Pt]),S.useEffect(()=>{console.log(" columnScores state changed:",rr),pt.current=rr},[rr]);const vr=S.useCallback(rt=>{console.log(" Toggling test collapse for:",rt),re(gt=>{const Vt=new Set(gt);return Vt.has(rt)?(Vt.delete(rt),console.log(" Expanding test:",rt)):(Vt.add(rt),console.log(" Collapsing test:",rt)),console.log(" New collapsed tests:",Array.from(Vt)),Vt})},[]),_r=S.useCallback(()=>{if(Mt.current){const{scrollLeft:rt,scrollWidth:gt,clientWidth:Vt}=Mt.current;it(rt>0),Dt(rt<gt-Vt-1)}},[]);S.useEffect(()=>{Fr()},[]),S.useEffect(()=>{if(B&&Mt.current){const rt=setTimeout(_r,100);return()=>clearTimeout(rt)}},[B,_r]),S.useEffect(()=>{console.log(" Current collapsed tests state:",Array.from(Se))},[Se]);const gr=S.useCallback(async(rt,gt=!1)=>{try{ce(!0);const Vt=a?.teacher_id,kt=`${U}/${q}`,br=await gae.getTeacherStudentResults(Vt,U,kt,rt,gt);if(br.success){console.log(" Results loaded for term:",rt,br.results?.length||0,"results"),console.log(" Students loaded:",br.students?.length||0,"students");const jt=[],Ur=new Set,nn=new Set;br.results&&br.results.length>0&&br.results.forEach(It=>{It.test_name&&!Ur.has(It.test_name)&&(Ur.add(It.test_name),jt.push({test_name:It.test_name,test_type:It.test_type,subject:It.subject})),It.subject&&nn.add(It.subject)});const Je=(br.students||[]).map(It=>{const _n={};return(br.results||[]).filter(Hr=>Hr.student_id===It.student_id).forEach(Hr=>{Hr.test_name&&(_n[Hr.test_name]={id:Hr.id,test_type:Hr.test_type,test_id:Hr.test_id,subject_id:Hr.subject_id,score:Hr.score,max_score:Hr.max_score,retest_offered:Hr.retest_offered,caught_cheating:Hr.caught_cheating,visibility_change_times:Hr.visibility_change_times,answers:Hr.answers,ai_feedback:Hr.ai_feedback,name:Hr.name,surname:Hr.surname,test_name:Hr.test_name})}),{...It,..._n}}),Xt={results:br.results||[],students:Je,class:Je,unique_tests:jt,subjects:Array.from(nn),count:br.count||0,student_count:br.student_count||0};console.log(" Processed results data:",{uniqueTests:jt.length,subjects:Array.from(nn),resultsCount:br.results?.length||0,studentsWithScores:Je.length,sampleStudent:Je[0]}),Y(Xt),ie(Xt),ne(new Date)}}catch(Vt){console.error(" Error loading results for term:",Vt),Y(null),ie(null)}finally{ce(!1)}},[a,U,q]);S.useEffect(()=>{(async()=>{try{vt(!0),await rd.loadAcademicCalendar();const gt=rd.getCurrentSemesterTerms();Rt(gt),gt?.currentTerm&&(He(gt.currentTerm.id),U&&q&&gr(gt.currentTerm.id,s))}catch(gt){console.error(" Error initializing academic calendar:",gt)}finally{vt(!1)}})()},[U,q,gr,s]),S.useEffect(()=>{t&&r&&(console.log(" Props detected:",{grade:t,class:r}),Be?.currentTerm&&(He(Be.currentTerm.id),gr(Be.currentTerm.id,s)))},[t,r,Be,gr,s]);const Fr=S.useCallback(async()=>{console.log(" Initializing teacher results...");try{if(g(!0),x(""),!i||!a){console.log(" User not authenticated"),x("User not authenticated");return}if(a.role!==Ji.TEACHER){console.error(" Invalid user role for teacher results:",a.role),x("Access denied. Teacher role required.");return}console.log(" Loading teacher assignments..."),await rn(),console.log(" TODO: Load academic calendar service"),console.log(" Teacher results initialization complete!")}catch(rt){console.error(" Error initializing teacher results:",rt),x("Failed to initialize teacher results")}finally{g(!1)}},[i,a]),rn=S.useCallback(async()=>{console.log(" Loading teacher assignments...");try{const rt=`teacher_data_${a?.teacher_id||a?.id||""}`;let gt=Rs(rt);gt&&gt.subjects&&gt.subjects.length>0&&(gt.subjects.some(Je=>Je.subject&&Je.classes&&Je.classes.length>0)||(console.log(" Cached data has invalid subject structure, forcing refresh"),localStorage.removeItem(rt),gt=null)),gt?console.log(" Cache HIT! Using cached teacher data"):(console.log(" Cache MISS! Fetching teacher data from API"),gt=await hs.getTeacherData(),console.log(" Teacher data loaded:",gt),vs(rt,gt,Is.teacher_subjects)),d(gt);const Vt=[];gt&&gt.subjects&&(console.log(" Teacher subjects structure:",gt.subjects),gt.subjects.forEach(nn=>{console.log(" Processing subject:",nn),nn.classes&&nn.classes.forEach(Je=>{Je.grade&&Je.class&&Vt.push({grade:Je.grade,class:Je.class,subject:nn.subject||nn.name||"Unknown Subject"})})})),A(Vt),console.log(" Available classes from teacher data:",Vt);const kt=`teacher_tests_${a?.teacher_id||a?.id||""}`,br=Rs(kt);br&&br.some(nn=>nn.test_type==="drawing")&&(console.log(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(kt));let jt=Rs(kt);jt?console.log(" Cache HIT! Using cached teacher tests"):(console.log(" Cache MISS! Fetching teacher tests from API"),jt=await hn.getTeacherTests(),console.log(" Teacher tests loaded:",jt),vs(kt,jt,Is.teacher_tests));const Ur=jt.flatMap(nn=>nn.assignments||[]);w(Ur),console.log(" Raw assignments data:",Ur),console.log(" Teacher assignments loaded:",Ur.length)}catch(rt){console.error(" Error loading teacher assignments:",rt),o("Failed to load teacher assignments","error")}},[o]),Qr=S.useCallback(async(rt,gt)=>{console.log(" Showing classes for grade:",rt,"class:",gt),V(rt),R(gt),k(null),Y(null),rt&&gt&&console.log(" TODO: Implement academic calendar service for term selection")},[]);S.useCallback((rt,gt)=>{console.log(" Showing semesters for class:",rt,gt),k(null),Y(null),console.log(" TODO: Implement academic calendar service for term selection")},[]),S.useCallback((rt,gt)=>{console.log(" Class clicked:",rt,gt),N(!0),console.log(" TODO: Implement academic calendar service for term selection")},[]);const fe=S.useCallback(async(rt,gt=!1)=>{!U||!q||(console.log(" Loading results for semester:",rt,"forceRefresh:",gt),k(rt),Be?.currentTerm&&await gr(Be.currentTerm.id,gt))},[U,q,Be,gr]),wt=S.useCallback(()=>Be?l.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Current Semester: ",Be?.semester===1?"Semester 1":"Semester 2"]}),l.jsx("div",{className:"flex space-x-4",children:Be?.terms.map(rt=>l.jsx(nt.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${rt.isCurrent?"bg-blue-600 text-white shadow-lg":Ae===rt.id?"bg-green-500 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>{He(rt.id),gr(rt.id)},whileHover:{scale:1.05},whileTap:{scale:.95},children:rt.label},rt.id))})]}):l.jsx("div",{className:"flex space-x-4 mb-6",children:l.jsx("div",{className:"px-6 py-3 rounded-lg bg-gray-200 text-gray-500",children:"Loading terms..."})}),[Be,Ae,gr]);S.useCallback(rt=>rt.reduce((gt,Vt)=>(gt[Vt.student_id]||(gt[Vt.student_id]=[]),gt[Vt.student_id].push(Vt),gt),{}),[]),S.useCallback(rt=>{if(rt.length===0)return 0;const gt=rt.reduce((Vt,kt)=>Vt+(kt.percentage||0),0);return Math.round(gt/rt.length)},[]),S.useCallback(rt=>{rt.score<rt.passing_score&&window.confirm("Give another try?")&&Sr(rt.student_id,rt.test_id)},[]);const Sr=S.useCallback(async(rt,gt)=>{try{(await fetch("/.netlify/functions/reset-test-attempt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:rt,testId:gt})})).ok&&(q&&fe(C,!0),o("Test made accessible to student","success"))}catch(Vt){console.error("Error resetting test attempt:",Vt),o("Failed to reset test attempt","error")}},[q,C,fe,o]),kr=S.useCallback((rt,gt)=>{if(rt===null||gt===null)return"";const Vt=Math.round(rt/gt*100);return Vt>=80?"text-green-600 bg-green-50":Vt>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50"},[]),Nn=S.useCallback(rt=>{De(rt),lt(!0)},[]),bn=S.useCallback((rt,gt="overview",Vt)=>{try{const br=!!rt?.ai_feedback,jt=typeof rt?.ai_feedback;let Ur=[];if(br)if(jt==="string")try{Ur=Object.keys(JSON.parse(rt.ai_feedback))}catch{Ur=["<invalid json>"]}else jt==="object"&&(Ur=Object.keys(rt.ai_feedback||{}));console.log("[AI DEBUG] Opening speaking result",{hasAi:br,aiType:jt,aiKeys:Ur})}catch{}const kt={...rt,__initialTab:gt};Vt&&(kt.__audioUrl=Vt),tt(kt),At(!0)},[]),Zr=S.useCallback(async(rt,gt)=>{if(!rt||!gt)return console.error("fetchTestQuestions: Missing testType or testId",{testType:rt,testId:gt}),null;const Vt=`${rt}_${gt}`;if(ot[Vt])return console.log(" Using cached questions for",Vt),ot[Vt];Ke(!0);try{console.log(" Fetching questions for",{testType:rt,testId:gt});const kt=await hn.getTestQuestions(rt,gt);return console.log(" Questions fetched:",kt?.length||0,"questions"),mt(br=>({...br,[Vt]:kt})),kt}catch(kt){return console.error(" Error fetching test questions:",kt),o("Failed to load test questions","error"),null}finally{Ke(!1)}},[ot,o]),Me=S.useCallback(async(rt,gt)=>{if(console.log(" Opening answer modal for:",{testResult:rt,test:gt}),console.log(" [handleViewAnswers] testResult.answers:",rt?.answers),console.log(" [handleViewAnswers] testResult.answers type:",typeof rt?.answers),console.log(" [handleViewAnswers] Full testResult keys:",rt?Object.keys(rt):"null"),rt.test_type==="drawing"||gt?.test_type==="drawing"){Nn(rt);return}if(rt.test_type==="speaking"||gt?.test_type==="speaking"){bn(rt);return}const Vt=rt.test_type||gt?.test_type;if(Vt==="word_matching"||Vt==="matching_type"){o("Word matching and picture matching tests have separate view mechanisms","info");return}ut(rt);const kt=rt.test_id||gt?.test_id;if(!Vt||!kt){o("Unable to load test questions: Missing test type or ID","error");return}const br=await Zr(Vt,kt);br?(oe(br),Te(!0)):o("Failed to load test questions","error")},[Zr,Nn,bn,o]);S.useCallback((rt,gt,Vt)=>{pr({resultId:rt,score:gt,maxScore:Vt}),Kr(gt?.toString()||""),ir(Vt?.toString()||""),Re(!0)},[]),S.useCallback(rt=>{Kr(rt)},[]),S.useCallback(rt=>{ir(rt)},[]),S.useCallback(async()=>{if(qt){Ne(!0);try{const rt={resultId:qt.resultId,score:parseInt(Rr)||0,maxScore:parseInt(ur)||1};(await fetch(Yx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(rt)})).ok?(o("Score updated successfully","success"),q&&fe(C,!0),pr(null),Kr(""),ir(""),Re(!1)):o("Failed to update score","error")}catch(rt){console.error("Error updating score:",rt),o("Failed to update score","error")}finally{Ne(!1)}}},[qt,Rr,ur,q,C,fe,o]),S.useCallback(()=>{pr(null),Kr(""),ir(""),Re(!1)},[]);const Tt=S.useCallback((rt,gt)=>{Fe({resultId:rt,score:gt}),ke(gt.toString())},[]),Gt=S.useCallback(async()=>{if(Ct){Qe(!0);try{const rt={resultId:Ct.resultId,score:parseInt(st)||0},gt=await fetch(Yx.UPDATE_SPEAKING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(rt)});if(gt.ok){const Vt=await gt.json();o("Speaking test score updated successfully","success"),Ue&&tt(kt=>({...kt,score:Vt.score,percentage:Vt.percentage})),q&&fe(C,!0),Fe(null),ke("")}else{const Vt=await gt.json();o(Vt.error||"Failed to update speaking test score","error")}}catch(rt){console.error("Error updating speaking test score:",rt),o("Failed to update speaking test score","error")}finally{Qe(!1)}}},[Ct,st,q,C,fe,o]),ar=S.useCallback(()=>{Fe(null),ke("")},[]),es=(rt,gt)=>{console.log(" Starting column editing for drawing test:",rt),console.log(" Current editingColumns before update:",Array.from(Pt)),console.log(" Results data passed to function:",gt),zt(Vt=>{const kt=new Set(Vt).add(rt);return console.log(" Updated editingColumns:",Array.from(kt)),kt}),console.log(" Initializing column scores for test:",rt),console.log(" Results data:",gt),console.log(" Results.class:","null"),console.log(" No results or class data available")},Kn=S.useCallback(rt=>{zt(gt=>{const Vt=new Set(gt);return Vt.delete(rt),Vt}),xr(gt=>{const Vt={...gt};return delete Vt[rt],Vt})},[]),Mi=S.useCallback((rt,gt,Vt,kt)=>{const br=kt.toString();pt.current[rt]||(pt.current[rt]={}),pt.current[rt][gt]||(pt.current[rt][gt]={}),pt.current[rt][gt][Vt]=br;const jt=parseInt(kt)||0;xr(Ur=>({...Ur,[rt]:{...Ur[rt],[gt]:{...Ur[rt]?.[gt],[Vt]:jt}}}))},[]);S.useCallback(async rt=>{if(pt.current[rt]){qr(!0);try{const gt=Object.entries(pt.current[rt]).map(([jt,Ur])=>({resultId:Ur.resultId,score:parseInt(Ur.score)||0,maxScore:parseInt(Ur.maxScore)||100}));console.log(" Saving column scores for",rt,":",gt);const Vt=gt.map(jt=>(console.log(" Sending update:",jt),fetch(Yx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(jt)})));(await Promise.all(Vt)).every(jt=>jt.ok)?(o(`Scores updated successfully for ${rt}`,"success"),q&&fe(C,!0),Kn(rt)):o("Failed to update some scores","error")}catch(gt){console.error("Error updating column scores:",gt),o("Failed to update scores","error")}finally{qr(!1)}}},[rr,q,C,fe,o,Kn]);const B0=S.useCallback((rt,gt,Vt)=>!gt||gt.length===0?l.jsx(nt.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:l.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):l.jsx(nt.div,{className:"relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:l.jsxs(nt.div,{className:"bg-white rounded-lg shadow-lg overflow-hidden",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4,delay:.1},children:[l.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:kt=>{Mt.current&&(Mt.current.scrollLeft=kt.target.scrollLeft)},children:l.jsx("div",{className:"min-w-full h-1",children:l.jsx("div",{className:"h-1",style:{width:`${(Vt.length+5)*120}px`}})})}),l.jsx("div",{ref:Mt,className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:kt=>{_r(kt);const br=kt.target.previousElementSibling;br&&(br.scrollLeft=kt.target.scrollLeft)},children:l.jsxs("table",{className:"min-w-full border-collapse text-sm min-w-max",children:[l.jsx("thead",{children:l.jsxs(nt.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-20 text-center",children:"Student ID"}),l.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 ${ge?"w-8 min-w-[32px] max-w-[32px] bg-gray-100 cursor-pointer select-none":"min-w-[180px] bg-blue-50 cursor-pointer select-none"}`,onClick:kt=>{kt.preventDefault(),kt.stopPropagation(),Ee(!ge)},title:"Toggle student name columns",children:ge?l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"truncate",title:"Student Name",children:"Student Name"}),l.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-16 text-center",children:"No."}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[100px]",children:"Nickname"}),Vt.map((kt,br)=>{const jt=Se.has(kt.test_name),Ur=kt.test_type==="drawing",nn=Wt.current.has(kt.test_name);return console.log(` Rendering test ${kt.test_name}:`,{isDrawingTest:Ur,isEditingColumn:nn,editingColumns:Array.from(Wt.current),test_type:kt.test_type}),l.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 cursor-pointer hover:bg-blue-200 transition-colors select-none ${jt?"w-8 min-w-[32px] max-w-[32px] bg-gray-100":"min-w-[100px] bg-blue-50"}`,onClick:Je=>{Je.preventDefault(),Je.stopPropagation(),vr(kt.test_name)},children:jt?l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"truncate",title:kt.test_name,children:kt.test_name.length>8?kt.test_name.substring(0,8)+"...":kt.test_name}),l.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})},br)})]})}),l.jsx("tbody",{children:l.jsx(wo,{children:gt.map((kt,br)=>l.jsxs(nt.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${br%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1+br*.05,ease:"easeOut"},whileHover:{scale:1.01,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.99},children:[l.jsx(nt.td,{className:"border-b border-gray-100 px-4 py-4 text-center font-semibold text-gray-900",whileHover:{scale:1.05},transition:{duration:.2},children:kt.student_id}),ge?l.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:jt=>{jt.preventDefault(),jt.stopPropagation(),Ee(!1)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}):l.jsxs(l.Fragment,{children:[l.jsx(nt.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:kt.name}),l.jsx(nt.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:kt.surname})]}),l.jsx(nt.td,{className:"border-b border-gray-100 px-4 py-4 text-center text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:kt.number??br+1}),l.jsx(nt.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-600",whileHover:{scale:1.02},transition:{duration:.2},children:kt.nickname||"-"}),Vt.map((jt,Ur)=>{const nn=Se.has(jt.test_name),Je=kt[jt.test_name];return nn?(console.log(" Rendering collapsed column for test:",jt.test_name),l.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Xt=>{Xt.preventDefault(),Xt.stopPropagation(),console.log(" Clicked on collapsed arrow for:",jt.test_name),vr(jt.test_name)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},Ur)):l.jsx(nt.td,{className:"border-b border-gray-100 px-2 py-4 text-sm min-w-[100px]",initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},transition:{duration:.3},whileHover:{scale:1.02},onClick:Xt=>{console.debug("[TeacherResults] Main table TD clicked",{testResult:Je,student:kt.student_id});const It=Je?.test_type||jt?.test_type;if(It==="drawing"||It==="speaking"||It==="word_matching"||It==="matching_type")return;const _n=c(Je);if(_n!==null&&_n<50){if(Je?.retest_offered){o("Retest is already offered","info");return}console.debug("[TeacherResults] Main table TD -> opening retest modal",{studentId:kt.student_id,test:jt}),n({failedStudentIds:[kt.student_id],test_type:jt.test_type,original_test_id:Je?.test_id||jt.test_id,subject_id:Je?.subject_id||jt.subject_id,grade:t,class:r})}else Me(Je,jt)},children:Je&&Je.test_type==="drawing"?l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx("button",{onClick:()=>Nn(Je),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"View Drawing"}),(()=>{const Xt=`${jt.test_name}|${kt.student_id}`,It=ue===Xt,_n=Number.isFinite(Je?.score)?Je.score:0;if(!It){const Wr=c(Je),Hr=Wr!==null&&Wr<50,qn=Wr!==null&&Wr>=50&&Wr<70,Mn=Je?.retest_offered===!0,Yn=Wr===null?"text-gray-600":Hr?"text-red-600 font-semibold":qn?"text-yellow-600":"text-green-600";return l.jsxs(nt.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${Yn} cursor-pointer hover:opacity-90 ${Mn?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Hr?{color:"#b91c1c"}:void 0,whileHover:{scale:1.1},transition:{duration:.2},onClick:oo=>{oo.preventDefault(),oo.stopPropagation(),Hr&&!Mn?n({failedStudentIds:[kt.student_id],test_type:jt.test_type,original_test_id:Je?.test_id||jt.test_id,subject_id:Je?.subject_id||jt.subject_id,grade:t,class:r}):(we(Xt),xe(String(_n)))},title:Mn?"Retest offered":Hr?"Offer retest":"Double-click to edit score",children:[(()=>{const oo=Je.retest_best_score??Je.score,gc=Je.retest_best_max_score??Je.max_score;return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:Hr?"text-red-700":"",children:oo}),"/",l.jsx("span",{children:gc})]})})(),Je.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})}return l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:10,value:ye,onChange:Wr=>xe(Wr.target.value),onBlur:async()=>{const Wr=Math.max(0,Math.min(10,parseFloat(ye||"0")));_e(!0);try{const Hr={resultId:Je?.id,score:Wr,maxScore:10},qn=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token");if(!(await fetch(Yx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:qn?`Bearer ${qn}`:""},body:JSON.stringify(Hr)})).ok)throw new Error("Failed to save")}catch{}finally{_e(!1),we(null),fe(C,!0)}},onKeyDown:async Wr=>{Wr.key==="Enter"?Wr.currentTarget.blur():Wr.key==="Escape"&&we(null)},className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",disabled:be}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",value:10,className:"w-12 px-2 py-1 text-xs border border-gray-300 bg-gray-100 rounded",disabled:!0})]})})(),Je.caught_cheating&&Je.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",Je.visibility_change_times,")"]})]}):Je&&(Je.test_type==="speaking"||jt.test_type==="speaking")?l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[(()=>{const Xt=Je?.answers;let It;if(typeof Xt=="string")if(/^https?:\/\//i.test(Xt))It=Xt;else try{It=JSON.parse(Xt)?.audio_url}catch{}else Xt&&typeof Xt=="object"&&(It=Xt.audio_url);return!It&&Je?.audio_url&&(It=Je.audio_url),l.jsx(l.Fragment,{children:l.jsx("button",{onClick:()=>bn({...Je,__studentId:kt.student_id},"audio",It),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"Results"})})})(),(()=>{const Xt=Wt.current.has(jt.test_name);return console.log(` Score cell for ${jt.test_name}:`,{isEditing:Xt,editingColumns:Array.from(Wt.current),test_name:jt.test_name}),Xt})()?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:Je.max_score||100,value:pt.current[jt.test_name]?.[kt.student_id]?.score||Je.score||"",onChange:Xt=>Mi(jt.test_name,kt.student_id,"score",Xt.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",min:"1",value:pt.current[jt.test_name]?.[kt.student_id]?.maxScore||Je.max_score||100,onChange:Xt=>Mi(jt.test_name,kt.student_id,"maxScore",Xt.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):l.jsxs("div",{className:"px-2 py-1 rounded-full text-xs font-medium",onDoubleClick:()=>{console.log(" Double-clicked on speaking test score:",jt.test_name),console.log(" Results state at double-click:",B),console.log(" Test result:",Je),console.log(" Student:",kt),console.log(" Test:",jt),Je&&Je.id?(console.log(" Starting column editing for speaking test:",jt.test_name),es(jt.test_name)):console.log(" No test result ID found, cannot edit")},title:"Double-click to edit scores",children:[(()=>{const Xt=c(Je),It=Xt!==null&&Xt<50,_n=Xt!==null&&Xt>=50&&Xt<70,Wr=Je.retest_offered,Hr=Xt===null?"text-gray-600":It?"text-red-600 font-semibold":_n?"text-yellow-600":"text-green-600";return l.jsxs(nt.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${Hr} cursor-pointer hover:opacity-90 ${Wr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:It?{color:"#b91c1c"}:void 0,whileHover:{scale:1.1},transition:{duration:.2},onClick:qn=>{qn.preventDefault(),qn.stopPropagation(),It&&!Wr&&(console.log(" Offering retest for speaking test:",jt.test_name),n({failedStudentIds:[kt.student_id],test_type:jt.test_type,original_test_id:Je?.test_id||jt.test_id,subject_id:Je?.subject_id||jt.subject_id,grade:t,class:r}))},title:Wr?"Retest offered":It?"Offer retest":'Use "View Results" button to review',children:[(()=>{const qn=Je.retest_best_score??Je.score,Mn=Je.retest_best_max_score??Je.max_score;return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:It?"text-red-700":"",children:qn}),"/",l.jsx("span",{children:Mn})]})})(),Je.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})(),Je.caught_cheating&&Je.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",Je.visibility_change_times,")"]})]})]}):Je&&Je.score!==null&&Je.score!==void 0?l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[(()=>{const Xt=c(Je),It=Xt!==null&&Xt<50,_n=Xt!==null&&Xt>=50&&Xt<70,Wr=Xt===null?"text-gray-600":It?"text-red-600 font-semibold":_n?"text-yellow-600":"text-green-600",Hr=Je?.retest_offered===!0;return l.jsxs(nt.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${Wr} cursor-pointer hover:opacity-90 ${Hr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:It?{color:"#b91c1c"}:void 0,whileHover:{scale:1.1},transition:{duration:.2},onClick:qn=>{qn.preventDefault(),qn.stopPropagation();const Mn=Je?.test_type||jt?.test_type;if(!(Mn==="drawing"||Mn==="speaking")){if(Je?.retest_offered){o("Retest is already offered","info");return}It?n({failedStudentIds:[kt.student_id],test_type:jt.test_type,original_test_id:Je?.test_id||jt.test_id,subject_id:Je?.subject_id||jt.subject_id,grade:t,class:r}):Me(Je,jt)}},title:Hr?"Retest offered":It?"Offer retest":"",children:[(()=>{const qn=Je.retest_best_score??Je.score,Mn=Je.retest_best_max_score??Je.max_score;return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:It?"text-red-700":"",children:qn}),"/",l.jsx("span",{children:Mn})]})})(),Je.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})(),Je.caught_cheating&&Je.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",Je.visibility_change_times,")"]})]}):l.jsx("span",{className:"text-gray-400",children:"-"})},Ur)})]},br))})})]})})]})}),[kr,Se,vr,ge]),Gf=S.useCallback((rt,gt,Vt)=>!gt||gt.length===0?l.jsx(nt.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:l.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):l.jsx(nt.div,{className:"w-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},children:l.jsx(nt.div,{className:"overflow-x-auto -mx-4 px-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.1},children:l.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden min-w-max",children:l.jsxs("table",{className:"w-full border-collapse text-xs min-w-max",children:[l.jsx("thead",{children:l.jsxs(nt.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.2,delay:.2},children:[l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-16 text-center",children:"ID"}),l.jsx("th",{className:`border-b border-gray-200 px-2 py-3 text-left font-semibold text-gray-700 ${ge?"w-8 min-w-[32px] max-w-[32px] bg-gray-100 cursor-pointer select-none":"min-w-[160px] bg-blue-50 cursor-pointer select-none"}`,onClick:kt=>{kt.preventDefault(),kt.stopPropagation(),Ee(!ge)},title:"Toggle student name columns",children:ge?l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-3 h-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"truncate",title:"Student Name",children:"Student Name"}),l.jsx("svg",{className:"w-3 h-3 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-12 text-center",children:"No."}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[80px]",children:"Nickname"}),Vt.map((kt,br)=>(kt.test_type,Wt.current.has(kt.test_name),l.jsx(nt.th,{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.3+br*.05},children:l.jsx("div",{className:"flex flex-col space-y-1",children:l.jsx("span",{className:"text-xs",children:kt.test_name.length>10?kt.test_name.substring(0,10)+"...":kt.test_name})})},br)))]})}),l.jsx("tbody",{children:l.jsx(wo,{children:gt.map((kt,br)=>l.jsxs(nt.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${br%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.1+br*.03,ease:"easeOut"},whileHover:{scale:1.005,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.995},children:[l.jsx(nt.td,{className:"border-b border-gray-100 px-3 py-3 text-center font-semibold text-gray-900",whileHover:{scale:1.03},transition:{duration:.15},children:kt.student_id}),ge?l.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-xs w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-3 h-3 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:jt=>{jt.preventDefault(),jt.stopPropagation(),Ee(!1)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}):l.jsxs(l.Fragment,{children:[l.jsx(nt.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:kt.name}),l.jsx(nt.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:kt.surname})]}),l.jsx(nt.td,{className:"border-b border-gray-100 px-3 py-3 text-center text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:kt.number??br+1}),l.jsx(nt.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-600 whitespace-normal break-words",whileHover:{scale:1.01},transition:{duration:.15},children:kt.nickname||"-"}),Vt.map((jt,Ur)=>{const nn=Se.has(jt.test_name),Je=kt[jt.test_name];return nn?l.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Xt=>{Xt.preventDefault(),Xt.stopPropagation(),vr(jt.test_name)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},Ur):l.jsx(nt.td,{className:"border-b border-gray-100 px-3 py-3 text-sm",whileHover:{scale:1.01},transition:{duration:.15},onClick:Xt=>{console.debug("[TeacherResults] TD clicked",{testResult:Je,student:kt.student_id});const It=Je?.test_type||jt?.test_type;if(It==="drawing"||It==="speaking")return;const _n=c(Je);if(_n!==null&&_n<50){if(Je?.retest_offered){o("Retest is already offered","info");return}console.debug("[TeacherResults] TD -> opening retest modal",{studentId:kt.student_id}),n({failedStudentIds:[kt.student_id],test_type:Je.test_type,original_test_id:Je.test_id,subject_id:Je.subject_id,grade:t,class:r})}else Me(Je,jt)},children:Je&&(Je.test_type==="drawing"||jt.test_type==="drawing"||Je.test_type==="speaking"||jt.test_type==="speaking"||Je.score!==null&&Je.score!==void 0)?l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[Je.test_type==="drawing"?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>Nn(Je),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View"}),Wt.current.has(jt.test_name)?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:Je.max_score||100,value:pt.current[jt.test_name]?.[kt.student_id]?.score||Je.score||"",onChange:Xt=>Mi(jt.test_name,kt.student_id,"score",Xt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",min:"1",value:pt.current[jt.test_name]?.[kt.student_id]?.maxScore||Je.max_score||100,onChange:Xt=>Mi(jt.test_name,kt.student_id,"maxScore",Xt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):(()=>{const Xt=c(Je),It=Xt!==null&&Xt<50,_n=Xt!==null&&Xt>=50&&Xt<70,Wr=Je.retest_offered,Hr=Xt===null?"text-gray-600":It?"text-red-600 font-semibold":_n?"text-yellow-600":"text-green-600";return l.jsxs(nt.div,{className:`px-1 py-0.5 rounded text-xs font-medium ${Hr} cursor-pointer hover:opacity-90 ${Wr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:It?{color:"#b91c1c"}:void 0,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>es(jt.test_name),onClick:qn=>{qn.preventDefault(),qn.stopPropagation();const Mn=Je?.test_type||jt?.test_type;if(!(Mn==="drawing"||Mn==="speaking"))if(It){if(Je?.retest_offered){o("Retest is already offered","info");return}n({failedStudentIds:[kt.student_id],test_type:jt.test_type,original_test_id:Je?.test_id||jt.test_id,subject_id:Je?.subject_id||jt.subject_id,grade:t,class:r})}else Me(Je,jt)},title:Wr?"Retest offered":It?"Offer retest":"Click to view answers",children:[l.jsx("span",{className:It?"text-red-700":"",children:Je.score}),"/",l.jsx("span",{children:Je.max_score}),Je.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})()]}):Je.test_type==="speaking"||jt.test_type==="speaking"?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>bn({...Je,__studentId:kt.student_id},"audio"),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View Audio"}),Ct&&Ct.resultId===Je.result_id?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:Je.max_score||100,value:st,onChange:Xt=>ke(Xt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("button",{onClick:()=>Gt(),disabled:We,className:"px-1 py-0.5 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50",children:We?"Saving...":"Save"}),l.jsx("button",{onClick:()=>ar(),disabled:We,className:"px-1 py-0.5 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):(()=>{const Xt=c(Je),It=Xt!==null&&Xt<50,_n=Xt!==null&&Xt>=50&&Xt<70,Wr=Je.retest_offered,Hr=Xt===null?"text-gray-600":It?"text-red-600 font-semibold":_n?"text-yellow-600":"text-green-600";return l.jsxs(nt.div,{className:`px-1 py-0.5 rounded text-xs font-medium ${Hr} cursor-pointer hover:opacity-90 ${Wr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:It?{color:"#b91c1c"}:void 0,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>{Fe({resultId:Je.result_id,score:Je.score}),ke(Je.score?.toString()||"")},onClick:qn=>{qn.preventDefault(),qn.stopPropagation();const Mn=Je?.test_type||jt?.test_type;if(!(Mn==="drawing"||Mn==="speaking"))if(It){if(Je?.retest_offered){o("Retest is already offered","info");return}n({failedStudentIds:[kt.student_id],test_type:jt.test_type,original_test_id:Je?.test_id||jt.test_id,subject_id:Je?.subject_id||jt.subject_id,grade:t,class:r})}else Me(Je,jt)},title:Wr?"Retest offered":It?"Offer retest":"Click to view answers, double-click to edit score",children:[l.jsx("span",{className:It?"text-red-700":"",children:Je.score||0}),"/",l.jsx("span",{children:Je.max_score||100}),Je.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})()]}):(()=>{const Xt=c(Je),It=Xt!==null&&Xt<50,_n=Xt!==null&&Xt>=50&&Xt<70,Wr=Xt!==null&&Xt>=70,Hr=Je?.retest_offered===!0;console.debug("[TeacherResults] Render pill",{studentId:kt.student_id,pct:Xt,isRed:It,isYellow:_n,isGreen:Wr,score:Je.score,max:Je.max_score,percentageField:Je.percentage});const Mn=`px-1 py-0.5 rounded text-xs font-medium ${Xt===null?"text-gray-600":It?"text-red-600 font-semibold":_n?"text-yellow-600":"text-green-600"} cursor-pointer hover:opacity-90 pointer-events-auto ${Hr?"bg-blue-50 text-blue-700 border border-blue-200":""}`;return l.jsxs(nt.div,{className:Mn,style:It?{color:"#b91c1c"}:void 0,whileHover:{scale:1.05},transition:{duration:.15},onClick:Yn=>{Yn.preventDefault(),Yn.stopPropagation();const oo=Je?.test_type||jt?.test_type;if(!(oo==="drawing"||oo==="speaking"))if(It){if(Je?.retest_offered){o("Retest is already offered","info");return}const gc=window.getComputedStyle(Yn.currentTarget).color;console.debug("[TeacherResults] Red pill clicked -> opening retest modal",{studentId:kt.student_id,className:Mn,computedColor:gc}),n({failedStudentIds:[kt.student_id],test_type:jt.test_type,original_test_id:Je?.test_id||jt.test_id,subject_id:Je?.subject_id||jt.subject_id,grade:t,class:r})}else Me(Je,jt)},title:Hr?"Retest offered":It?"Offer retest":"Click to view answers",children:[l.jsx("span",{className:It?"text-red-700":"",children:Je.score}),"/",l.jsx("span",{children:Je.max_score}),Je.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})(),Je.caught_cheating&&Je.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",Je.visibility_change_times,")"]})]}):l.jsx("span",{className:"text-gray-400",children:"-"})},Ur)})]},br))})})]})})})}),[kr,Se,vr,ge]),cn=S.useCallback(()=>{if(!B)return null;console.log(" renderResults - results:",B),console.log(" renderResults - results.class:",B.class),console.log(" renderResults - results.unique_tests:",B.unique_tests);const rt=B.class&&Array.isArray(B.class)&&B.class.length>0;if(console.log(" renderResults - hasStudentData:",rt),!rt)return console.log(" renderResults - No student data, showing no students message"),l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No students found for this class and semester."})});const gt=B.unique_tests||[];return console.log(" renderResults - uniqueTests:",gt),Yt.current=B,l.jsxs("div",{className:"space-y-6",children:[l.jsxs(nt.div,{className:"bg-gradient-to-r from-red-500 to-pink-500 rounded-lg p-6 text-white",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[l.jsxs(nt.h2,{className:"text-2xl font-bold mb-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.1},children:["Test Results - Grade M",U,", Class ",U,"/",q,", Semester ",C]}),l.jsxs(nt.p,{className:"text-cyan-100",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.2},children:["Viewing results for ",B.subjects?.length||0," subject(s)"]}),l.jsxs(nt.div,{className:"mt-4 flex gap-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:[l.jsx("button",{onClick:()=>{const Vt=B.unique_tests?.map(kt=>kt.test_name)||[];re(new Set(Vt))},className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Collapse All Tests"}),l.jsx("button",{onClick:()=>re(new Set),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Expand All Tests"})]})]}),l.jsxs(nt.div,{className:"bg-white rounded-lg shadow p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},children:[l.jsx(nt.h3,{className:"text-lg font-semibold text-gray-900 mb-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},children:"Class Results"}),l.jsx("div",{className:"hidden md:block",children:B0("All Subjects",B.class,gt)}),l.jsx("div",{className:"md:hidden",children:Gf("All Subjects",B.class,gt)})]})]})},[B,B0,U,q,C]),su=S.useCallback(()=>{if(!B||!B.class||!B.unique_tests)return;const rt=["Student ID","Name","Surname","No.","Nickname",...B.unique_tests.map(Ur=>Ur.test_name)],gt=B.class.map((Ur,nn)=>{const Je=[];return Je.push(Ur.student_id),Je.push(Ur.name),Je.push(Ur.surname),Je.push(Ur.number??nn+1),Je.push(Ur.nickname||"-"),B.unique_tests.forEach(Xt=>{const It=Ur[Xt.test_name];It&&It.score!==null&&It.score!==void 0?Je.push(`${It.score}/${It.max_score}`):Je.push("-")}),Je}),Vt=ab.aoa_to_sheet([rt,...gt]),kt=ab.book_new(),br=[{wch:10},{wch:15},{wch:15},{wch:6},{wch:12},...B.unique_tests.map(()=>({wch:15}))];Vt["!cols"]=br,ab.book_append_sheet(kt,Vt,"Class Results");const jt=`class-results-${U}-${q}-semester-${C}.xlsx`;ixe(kt,jt),o("Excel file exported successfully!","success")},[B,U,q,C,o]);return h?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(zr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Results..."})]})}):p?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:p}),l.jsx(Ye,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"flex justify-between items-center py-4",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Class Results"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",ee?ee.toLocaleString():"Never"]})]})})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Class"}),F.length>0?(()=>{const rt=F.reduce((gt,Vt)=>{const kt=Vt.subject||"Unknown Subject";return gt[kt]||(gt[kt]=[]),gt[kt].push(Vt),gt},{});return l.jsx("div",{className:"space-y-6",children:Object.entries(rt).map(([gt,Vt])=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("h3",{className:"text-md font-semibold text-gray-800 mb-3 flex flex-col sm:flex-row sm:items-center items-center",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),gt]}),l.jsxs("span",{className:"ml-0 sm:ml-2 text-sm text-gray-500 mt-1 sm:mt-0",children:["(",Vt.length," classes)"]})]}),l.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:Vt.map((kt,br)=>l.jsxs(Ye,{variant:U===kt.grade&&q===kt.class?"primary":"outline",onClick:()=>Qr(kt.grade,kt.class),className:"px-3 py-1 text-xs font-medium min-w-[60px]",children:[kt.grade,"/",kt.class]},`${kt.grade}-${kt.class}-${br}`))})]},gt))})})():l.jsx("p",{className:"text-gray-500",children:"No classes available"})]}),q&&wt(),q&&B&&l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[U," ",q," - Test Results ",Ae?`(Term ${Be?.terms.find(rt=>rt.id===Ae)?.term})`:""]}),l.jsx("div",{className:"flex space-x-3",children:l.jsxs("button",{type:"button",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-2",onClick:su,children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-4 h-4 object-contain"}),l.jsx("span",{className:"font-medium text-sm",children:"Export Excel"})]})})]}),cn()]}),q&&!B&&l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-gray-200 border-t-blue-500"}),l.jsx("span",{className:"text-gray-600",children:"Loading results"})]})})})]})}),Xe&&Le&&l.jsx(yk,{children:l.jsx(zB,{drawing:Xe,isOpen:Le,onClose:()=>lt(!1),isTeacherView:!0,onSaveScore:async({resultId:rt,score:gt,maxScore:Vt})=>{try{const kt=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token");if(!(await fetch(Yx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:kt?`Bearer ${kt}`:""},body:JSON.stringify({resultId:rt,score:gt,maxScore:Vt})})).ok)throw new Error("Failed to save");await fe(C,!0)}catch{o("Failed to save drawing score","error")}}})}),l.jsx(yk,{children:l.jsx(mie,{isOpen:he,onClose:()=>{Te(!1),ut(null),oe(null)},testResult:Ge,questions:qe,isLoadingQuestions:Ce})}),Ue&&Et&&l.jsx(yk,{children:l.jsx(gie,{result:Ue,isOpen:Et,onClose:()=>At(!1),initialTab:Ue.__initialTab||"overview",editingSpeakingScore:Ct,tempSpeakingScore:st,isSavingSpeakingScore:We,onStartSpeakingScoreEdit:Tt,onSaveSpeakingScore:Gt,onCancelSpeakingScoreEdit:ar,onTempSpeakingScoreChange:ke})})]})},xxe={getTestPerformance:async(e,t=null)=>{try{await rd.loadAcademicCalendar();const n=rd.getCurrentTerm()?.id;if(!n)throw new Error("No current academic period found");console.log(` Fetching test performance for teacher ${e}, period ${n}, class: ${t||"all"}`);let s=`/.netlify/functions/get-test-performance?teacher_id=${e}&academic_period_id=${n}`;if(t){const[o,c]=t.split("/"),u=o.startsWith("M")?o:`M${o}`;s+=`&grade=${u}&class=${c}`}const a=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const i=await a.json();if(!i.success)throw new Error(i.error||"Failed to fetch performance data");return console.log(` Performance data loaded: ${i.count} tests`),i.data}catch(r){throw console.error(" Error fetching test performance:",r),r}}};function tz(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=tz(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function ls(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=tz(e))&&(n&&(n+=" "),n+=t);return n}var Ok={},Dk={},LO;function yxe(){return LO||(LO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Dk)),Dk}var Ik={},BO;function rz(){return BO||(BO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Ik)),Ik}var Rk={},$O;function nz(){return $O||($O=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(Rk)),Rk}var Mk={},UO;function M3(){return UO||(UO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){const n=[],s=r.length;if(s===0)return n;let a=0,i="",o="",c=!1;for(r.charCodeAt(0)===46&&(n.push(""),a++);a<s;){const u=r[a];o?u==="\\"&&a+1<s?(a++,i+=r[a]):u===o?o="":i+=u:c?u==='"'||u==="'"?o=u:u==="]"?(c=!1,n.push(i),i=""):i+=u:u==="["?(c=!0,i&&(n.push(i),i="")):u==="."?i&&(n.push(i),i=""):i+=u,a++}return i&&n.push(i),n}e.toPath=t})(Mk)),Mk}var zO;function L3(){return zO||(zO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=yxe(),r=rz(),n=nz(),s=M3();function a(o,c,u){if(o==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?r.isDeepKey(c)?a(o,s.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=o[c];return d===void 0?u:d}default:{if(Array.isArray(c))return i(o,c,u);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?u:d}}}function i(o,c,u){if(c.length===0)return u;let d=o;for(let h=0;h<c.length;h++){if(d==null||t.isUnsafeProperty(c[h]))return u;d=d[c[h]]}return d===void 0?u:d}e.get=a})(Ok)),Ok}var Lk,WO;function vxe(){return WO||(WO=1,Lk=L3().get),Lk}var wxe=vxe();const h2=Ol(wxe);var Bk={exports:{}},En={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HO;function bxe(){if(HO)return En;HO=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,s=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,i=e?Symbol.for("react.provider"):60109,o=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,d=e?Symbol.for("react.forward_ref"):60112,h=e?Symbol.for("react.suspense"):60113,g=e?Symbol.for("react.suspense_list"):60120,p=e?Symbol.for("react.memo"):60115,x=e?Symbol.for("react.lazy"):60116,v=e?Symbol.for("react.block"):60121,w=e?Symbol.for("react.fundamental"):60117,C=e?Symbol.for("react.responder"):60118,k=e?Symbol.for("react.scope"):60119;function b(E){if(typeof E=="object"&&E!==null){var P=E.$$typeof;switch(P){case t:switch(E=E.type,E){case c:case u:case n:case a:case s:case h:return E;default:switch(E=E&&E.$$typeof,E){case o:case d:case x:case p:case i:return E;default:return P}}case r:return P}}}function N(E){return b(E)===u}return En.AsyncMode=c,En.ConcurrentMode=u,En.ContextConsumer=o,En.ContextProvider=i,En.Element=t,En.ForwardRef=d,En.Fragment=n,En.Lazy=x,En.Memo=p,En.Portal=r,En.Profiler=a,En.StrictMode=s,En.Suspense=h,En.isAsyncMode=function(E){return N(E)||b(E)===c},En.isConcurrentMode=N,En.isContextConsumer=function(E){return b(E)===o},En.isContextProvider=function(E){return b(E)===i},En.isElement=function(E){return typeof E=="object"&&E!==null&&E.$$typeof===t},En.isForwardRef=function(E){return b(E)===d},En.isFragment=function(E){return b(E)===n},En.isLazy=function(E){return b(E)===x},En.isMemo=function(E){return b(E)===p},En.isPortal=function(E){return b(E)===r},En.isProfiler=function(E){return b(E)===a},En.isStrictMode=function(E){return b(E)===s},En.isSuspense=function(E){return b(E)===h},En.isValidElementType=function(E){return typeof E=="string"||typeof E=="function"||E===n||E===u||E===a||E===s||E===h||E===g||typeof E=="object"&&E!==null&&(E.$$typeof===x||E.$$typeof===p||E.$$typeof===i||E.$$typeof===o||E.$$typeof===d||E.$$typeof===w||E.$$typeof===C||E.$$typeof===k||E.$$typeof===v)},En.typeOf=b,En}var GO;function _xe(){return GO||(GO=1,Bk.exports=bxe()),Bk.exports}_xe();var Sl=e=>e===0?0:e>0?1:-1,jl=e=>typeof e=="number"&&e!=+e,Ih=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Lr=e=>(typeof e=="number"||e instanceof Number)&&!jl(e),Zc=e=>Lr(e)||typeof e=="string",Sxe=0,fv=e=>{var t=++Sxe;return"".concat(e||"").concat(t)},jf=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Lr(t)&&typeof t!="string")return n;var a;if(Ih(t)){if(r==null)return n;var i=t.indexOf("%");a=r*parseFloat(t.slice(0,i))/100}else a=+t;return jl(a)&&(a=n),s&&r!=null&&a>r&&(a=r),a},sz=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function Bu(e,t,r){return Lr(e)&&Lr(t)?e+r*(t-e):t}function az(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):h2(n,t))===r)}var Ua=e=>e===null||typeof e>"u",B3=e=>Ua(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),kxe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function $3(e){if(typeof e!="string")return!1;var t=kxe;return t.includes(e)}var Cxe=["viewBox","children"],VO=["points","pathLength"],$k={svg:Cxe,polygon:VO,polyline:VO},U3=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(S.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(s=>{$3(s)&&(n[s]=(a=>r[s](r,a)))}),n},Txe=(e,t,r)=>n=>(e(t,r,n),null),Exe=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(s=>{var a=e[s];$3(s)&&typeof a=="function"&&(n||(n={}),n[s]=Txe(a,t,r))}),n},Nxe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function iz(e){if(typeof e!="string")return!1;var t=Nxe;return t.includes(e)}function I0(e){var t=Object.entries(e).filter(r=>{var[n]=r;return iz(n)});return Object.fromEntries(t)}var oz=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,Axe=(e,t,r,n)=>{var s;if(typeof t=="symbol"||typeof t=="number")return!0;var a=(s=n&&$k?.[n])!==null&&s!==void 0?s:[],i=t.startsWith("data-"),o=typeof e!="function"&&(!!n&&a.includes(t)||iz(t)),c=!!r&&$3(t);return i||o||c},gi=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(S.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var s={};return Object.keys(n).forEach(a=>{var i;Axe((i=n)===null||i===void 0?void 0:i[a],a,t,r)&&(s[a]=n[a])}),s},jxe=["children","width","height","viewBox","className","style","title","desc"];function kE(){return kE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kE.apply(null,arguments)}function Pxe(e,t){if(e==null)return{};var r,n,s=Fxe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function Fxe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var lz=S.forwardRef((e,t)=>{var{children:r,width:n,height:s,viewBox:a,className:i,style:o,title:c,desc:u}=e,d=Pxe(e,jxe),h=a||{width:n,height:s,x:0,y:0},g=ls("recharts-surface",i);return S.createElement("svg",kE({},gi(d,!0,"svg"),{className:g,width:n,height:s,style:o,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:t}),S.createElement("title",null,c),S.createElement("desc",null,u),r)}),Oxe=["children","className"];function CE(){return CE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},CE.apply(null,arguments)}function Dxe(e,t){if(e==null)return{};var r,n,s=Ixe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function Ixe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var rp=S.forwardRef((e,t)=>{var{children:r,className:n}=e,s=Dxe(e,Oxe),a=ls("recharts-layer",n);return S.createElement("g",CE({className:a},gi(s,!0),{ref:t}),r)}),Rxe=S.createContext(null);function As(e){return function(){return e}}const TE=Math.PI,EE=2*TE,Th=1e-6,Mxe=EE-Th;function cz(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Lxe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return cz;const r=10**t;return function(n){this._+=n[0];for(let s=1,a=n.length;s<a;++s)this._+=Math.round(arguments[s]*r)/r+n[s]}}class Bxe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?cz:Lxe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,s){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+s}`}bezierCurveTo(t,r,n,s,a,i){this._append`C${+t},${+r},${+n},${+s},${this._x1=+a},${this._y1=+i}`}arcTo(t,r,n,s,a){if(t=+t,r=+r,n=+n,s=+s,a=+a,a<0)throw new Error(`negative radius: ${a}`);let i=this._x1,o=this._y1,c=n-t,u=s-r,d=i-t,h=o-r,g=d*d+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(g>Th)if(!(Math.abs(h*c-u*d)>Th)||!a)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-i,x=s-o,v=c*c+u*u,w=p*p+x*x,C=Math.sqrt(v),k=Math.sqrt(g),b=a*Math.tan((TE-Math.acos((v+g-w)/(2*C*k)))/2),N=b/k,E=b/C;Math.abs(N-1)>Th&&this._append`L${t+N*d},${r+N*h}`,this._append`A${a},${a},0,0,${+(h*p>d*x)},${this._x1=t+E*c},${this._y1=r+E*u}`}}arc(t,r,n,s,a,i){if(t=+t,r=+r,n=+n,i=!!i,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(s),c=n*Math.sin(s),u=t+o,d=r+c,h=1^i,g=i?s-a:a-s;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Th||Math.abs(this._y1-d)>Th)&&this._append`L${u},${d}`,n&&(g<0&&(g=g%EE+EE),g>Mxe?this._append`A${n},${n},0,1,${h},${t-o},${r-c}A${n},${n},0,1,${h},${this._x1=u},${this._y1=d}`:g>Th&&this._append`A${n},${n},0,${+(g>=TE)},${h},${this._x1=t+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(t,r,n,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+s}h${-n}Z`}toString(){return this._}}function uz(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new Bxe(t)}function z3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function dz(e){this._context=e}dz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function g2(e){return new dz(e)}function fz(e){return e[0]}function hz(e){return e[1]}function gz(e,t){var r=As(!0),n=null,s=g2,a=null,i=uz(o);e=typeof e=="function"?e:e===void 0?fz:As(e),t=typeof t=="function"?t:t===void 0?hz:As(t);function o(c){var u,d=(c=z3(c)).length,h,g=!1,p;for(n==null&&(a=s(p=i())),u=0;u<=d;++u)!(u<d&&r(h=c[u],u,c))===g&&((g=!g)?a.lineStart():a.lineEnd()),g&&a.point(+e(h,u,c),+t(h,u,c));if(p)return a=null,p+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:As(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:As(+c),o):t},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:As(!!c),o):r},o.curve=function(c){return arguments.length?(s=c,n!=null&&(a=s(n)),o):s},o.context=function(c){return arguments.length?(c==null?n=a=null:a=s(n=c),o):n},o}function Iw(e,t,r){var n=null,s=As(!0),a=null,i=g2,o=null,c=uz(u);e=typeof e=="function"?e:e===void 0?fz:As(+e),t=typeof t=="function"?t:As(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?hz:As(+r);function u(h){var g,p,x,v=(h=z3(h)).length,w,C=!1,k,b=new Array(v),N=new Array(v);for(a==null&&(o=i(k=c())),g=0;g<=v;++g){if(!(g<v&&s(w=h[g],g,h))===C)if(C=!C)p=g,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),x=g-1;x>=p;--x)o.point(b[x],N[x]);o.lineEnd(),o.areaEnd()}C&&(b[g]=+e(w,g,h),N[g]=+t(w,g,h),o.point(n?+n(w,g,h):b[g],r?+r(w,g,h):N[g]))}if(k)return o=null,k+""||null}function d(){return gz().defined(s).curve(i).context(a)}return u.x=function(h){return arguments.length?(e=typeof h=="function"?h:As(+h),n=null,u):e},u.x0=function(h){return arguments.length?(e=typeof h=="function"?h:As(+h),u):e},u.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:As(+h),u):n},u.y=function(h){return arguments.length?(t=typeof h=="function"?h:As(+h),r=null,u):t},u.y0=function(h){return arguments.length?(t=typeof h=="function"?h:As(+h),u):t},u.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:As(+h),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(h){return arguments.length?(s=typeof h=="function"?h:As(!!h),u):s},u.curve=function(h){return arguments.length?(i=h,a!=null&&(o=i(a)),u):i},u.context=function(h){return arguments.length?(h==null?a=o=null:o=i(a=h),u):a},u}class mz{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function $xe(e){return new mz(e,!0)}function Uxe(e){return new mz(e,!1)}function Xb(){}function Qb(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function pz(e){this._context=e}pz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Qb(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Qb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function zxe(e){return new pz(e)}function xz(e){this._context=e}xz.prototype={areaStart:Xb,areaEnd:Xb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Qb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Wxe(e){return new xz(e)}function yz(e){this._context=e}yz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Qb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Hxe(e){return new yz(e)}function vz(e){this._context=e}vz.prototype={areaStart:Xb,areaEnd:Xb,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Gxe(e){return new vz(e)}function KO(e){return e<0?-1:1}function qO(e,t,r){var n=e._x1-e._x0,s=t-e._x1,a=(e._y1-e._y0)/(n||s<0&&-0),i=(r-e._y1)/(s||n<0&&-0),o=(a*s+i*n)/(n+s);return(KO(a)+KO(i))*Math.min(Math.abs(a),Math.abs(i),.5*Math.abs(o))||0}function YO(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Uk(e,t,r){var n=e._x0,s=e._y0,a=e._x1,i=e._y1,o=(a-n)/3;e._context.bezierCurveTo(n+o,s+o*t,a-o,i-o*r,a,i)}function Jb(e){this._context=e}Jb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Uk(this,this._t0,YO(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Uk(this,YO(this,r=qO(this,e,t)),r);break;default:Uk(this,this._t0,r=qO(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function wz(e){this._context=new bz(e)}(wz.prototype=Object.create(Jb.prototype)).point=function(e,t){Jb.prototype.point.call(this,t,e)};function bz(e){this._context=e}bz.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,s,a){this._context.bezierCurveTo(t,e,n,r,a,s)}};function Vxe(e){return new Jb(e)}function Kxe(e){return new wz(e)}function _z(e){this._context=e}_z.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=XO(e),s=XO(t),a=0,i=1;i<r;++a,++i)this._context.bezierCurveTo(n[0][a],s[0][a],n[1][a],s[1][a],e[i],t[i]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function XO(e){var t,r=e.length-1,n,s=new Array(r),a=new Array(r),i=new Array(r);for(s[0]=0,a[0]=2,i[0]=e[0]+2*e[1],t=1;t<r-1;++t)s[t]=1,a[t]=4,i[t]=4*e[t]+2*e[t+1];for(s[r-1]=2,a[r-1]=7,i[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=s[t]/a[t-1],a[t]-=n,i[t]-=n*i[t-1];for(s[r-1]=i[r-1]/a[r-1],t=r-2;t>=0;--t)s[t]=(i[t]-s[t+1])/a[t];for(a[r-1]=(e[r]+s[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-s[t+1];return[s,a]}function qxe(e){return new _z(e)}function m2(e,t){this._context=e,this._t=t}m2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function Yxe(e){return new m2(e,.5)}function Xxe(e){return new m2(e,0)}function Qxe(e){return new m2(e,1)}function Nm(e,t){if((i=e.length)>1)for(var r=1,n,s,a=e[t[0]],i,o=a.length;r<i;++r)for(s=a,a=e[t[r]],n=0;n<o;++n)a[n][1]+=a[n][0]=isNaN(s[n][1])?s[n][0]:s[n][1]}function NE(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Jxe(e,t){return e[t]}function Zxe(e){const t=[];return t.key=e,t}function eye(){var e=As([]),t=NE,r=Nm,n=Jxe;function s(a){var i=Array.from(e.apply(this,arguments),Zxe),o,c=i.length,u=-1,d;for(const h of a)for(o=0,++u;o<c;++o)(i[o][u]=[0,+n(h,i[o].key,u,a)]).data=h;for(o=0,d=z3(t(i));o<c;++o)i[d[o]].index=o;return r(i,d),i}return s.keys=function(a){return arguments.length?(e=typeof a=="function"?a:As(Array.from(a)),s):e},s.value=function(a){return arguments.length?(n=typeof a=="function"?a:As(+a),s):n},s.order=function(a){return arguments.length?(t=a==null?NE:typeof a=="function"?a:As(Array.from(a)),s):t},s.offset=function(a){return arguments.length?(r=a??Nm,s):r},s}function tye(e,t){if((n=e.length)>0){for(var r,n,s=0,a=e[0].length,i;s<a;++s){for(i=r=0;r<n;++r)i+=e[r][s][1]||0;if(i)for(r=0;r<n;++r)e[r][s][1]/=i}Nm(e,t)}}function rye(e,t){if((s=e.length)>0){for(var r=0,n=e[t[0]],s,a=n.length;r<a;++r){for(var i=0,o=0;i<s;++i)o+=e[i][r][1]||0;n[r][1]+=n[r][0]=-o/2}Nm(e,t)}}function nye(e,t){if(!(!((i=e.length)>0)||!((a=(s=e[t[0]]).length)>0))){for(var r=0,n=1,s,a,i;n<a;++n){for(var o=0,c=0,u=0;o<i;++o){for(var d=e[t[o]],h=d[n][1]||0,g=d[n-1][1]||0,p=(h-g)/2,x=0;x<o;++x){var v=e[t[x]],w=v[n][1]||0,C=v[n-1][1]||0;p+=w-C}c+=h,u+=p*h}s[n-1][1]+=s[n-1][0]=r,c&&(r-=u/c)}s[n-1][1]+=s[n-1][0]=r,Nm(e,t)}}var zk={},Wk={},QO;function sye(){return QO||(QO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const s=new Map;for(let a=0;a<r.length;a++){const i=r[a],o=n(i);s.has(o)||s.set(o,i)}return Array.from(s.values())}e.uniqBy=t})(Wk)),Wk}var Hk={},JO;function Sz(){return JO||(JO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Hk)),Hk}var Gk={},Vk={},Kk={},ZO;function aye(){return ZO||(ZO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Kk)),Kk}var eD;function W3(){return eD||(eD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aye();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(Vk)),Vk}var qk={},tD;function iye(){return tD||(tD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(qk)),qk}var rD;function oye(){return rD||(rD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=W3(),r=iye();function n(s){return r.isObjectLike(s)&&t.isArrayLike(s)}e.isArrayLikeObject=n})(Gk)),Gk}var Yk={},Xk={},nD;function lye(){return nD||(nD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=L3();function r(n){return function(s){return t.get(s,n)}}e.property=r})(Xk)),Xk}var Qk={},Jk={},Zk={},eC={},sD;function kz(){return sD||(sD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(eC)),eC}var tC={},aD;function Cz(){return aD||(aD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(tC)),tC}var rC={},iD;function Tz(){return iD||(iD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(rC)),rC}var oD;function cye(){return oD||(oD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=H3(),r=kz(),n=Cz(),s=Tz();function a(h,g,p){return typeof p!="function"?t.isMatch(h,g):i(h,g,function x(v,w,C,k,b,N){const E=p(v,w,C,k,b,N);return E!==void 0?!!E:i(v,w,x,N)},new Map)}function i(h,g,p,x){if(g===h)return!0;switch(typeof g){case"object":return o(h,g,p,x);case"function":return Object.keys(g).length>0?i(h,{...g},p,x):s.eq(h,g);default:return r.isObject(h)?typeof g=="string"?g==="":!0:s.eq(h,g)}}function o(h,g,p,x){if(g==null)return!0;if(Array.isArray(g))return u(h,g,p,x);if(g instanceof Map)return c(h,g,p,x);if(g instanceof Set)return d(h,g,p,x);const v=Object.keys(g);if(h==null)return v.length===0;if(v.length===0)return!0;if(x&&x.has(g))return x.get(g)===h;x&&x.set(g,h);try{for(let w=0;w<v.length;w++){const C=v[w];if(!n.isPrimitive(h)&&!(C in h)||g[C]===void 0&&h[C]!==void 0||g[C]===null&&h[C]!==null||!p(h[C],g[C],C,h,g,x))return!1}return!0}finally{x&&x.delete(g)}}function c(h,g,p,x){if(g.size===0)return!0;if(!(h instanceof Map))return!1;for(const[v,w]of g.entries()){const C=h.get(v);if(p(C,w,v,h,g,x)===!1)return!1}return!0}function u(h,g,p,x){if(g.length===0)return!0;if(!Array.isArray(h))return!1;const v=new Set;for(let w=0;w<g.length;w++){const C=g[w];let k=!1;for(let b=0;b<h.length;b++){if(v.has(b))continue;const N=h[b];let E=!1;if(p(N,C,w,h,g,x)&&(E=!0),E){v.add(b),k=!0;break}}if(!k)return!1}return!0}function d(h,g,p,x){return g.size===0?!0:h instanceof Set?u([...h],[...g],p,x):!1}e.isMatchWith=a,e.isSetMatch=d})(Zk)),Zk}var lD;function H3(){return lD||(lD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cye();function r(n,s){return t.isMatchWith(n,s,()=>{})}e.isMatch=r})(Jk)),Jk}var nC={},sC={},aC={},cD;function uye(){return cD||(cD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(aC)),aC}var iC={},uD;function Ez(){return uD||(uD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(iC)),iC}var oC={},dD;function Nz(){return dD||(dD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",s="[object Boolean]",a="[object Arguments]",i="[object Symbol]",o="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",h="[object Function]",g="[object ArrayBuffer]",p="[object Object]",x="[object Error]",v="[object DataView]",w="[object Uint8Array]",C="[object Uint8ClampedArray]",k="[object Uint16Array]",b="[object Uint32Array]",N="[object BigUint64Array]",E="[object Int8Array]",P="[object Int16Array]",F="[object Int32Array]",A="[object BigInt64Array]",j="[object Float32Array]",I="[object Float64Array]";e.argumentsTag=a,e.arrayBufferTag=g,e.arrayTag=d,e.bigInt64ArrayTag=A,e.bigUint64ArrayTag=N,e.booleanTag=s,e.dataViewTag=v,e.dateTag=o,e.errorTag=x,e.float32ArrayTag=j,e.float64ArrayTag=I,e.functionTag=h,e.int16ArrayTag=P,e.int32ArrayTag=F,e.int8ArrayTag=E,e.mapTag=c,e.numberTag=n,e.objectTag=p,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=i,e.uint16ArrayTag=k,e.uint32ArrayTag=b,e.uint8ArrayTag=w,e.uint8ClampedArrayTag=C})(oC)),oC}var lC={},fD;function dye(){return fD||(fD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(lC)),lC}var hD;function Az(){return hD||(hD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uye(),r=Ez(),n=Nz(),s=Cz(),a=dye();function i(d,h){return o(d,void 0,d,new Map,h)}function o(d,h,g,p=new Map,x=void 0){const v=x?.(d,h,g,p);if(v!==void 0)return v;if(s.isPrimitive(d))return d;if(p.has(d))return p.get(d);if(Array.isArray(d)){const w=new Array(d.length);p.set(d,w);for(let C=0;C<d.length;C++)w[C]=o(d[C],C,g,p,x);return Object.hasOwn(d,"index")&&(w.index=d.index),Object.hasOwn(d,"input")&&(w.input=d.input),w}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const w=new RegExp(d.source,d.flags);return w.lastIndex=d.lastIndex,w}if(d instanceof Map){const w=new Map;p.set(d,w);for(const[C,k]of d)w.set(C,o(k,C,g,p,x));return w}if(d instanceof Set){const w=new Set;p.set(d,w);for(const C of d)w.add(o(C,void 0,g,p,x));return w}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(a.isTypedArray(d)){const w=new(Object.getPrototypeOf(d)).constructor(d.length);p.set(d,w);for(let C=0;C<d.length;C++)w[C]=o(d[C],C,g,p,x);return w}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const w=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return p.set(d,w),c(w,d,g,p,x),w}if(typeof File<"u"&&d instanceof File){const w=new File([d],d.name,{type:d.type});return p.set(d,w),c(w,d,g,p,x),w}if(d instanceof Blob){const w=new Blob([d],{type:d.type});return p.set(d,w),c(w,d,g,p,x),w}if(d instanceof Error){const w=new d.constructor;return p.set(d,w),w.message=d.message,w.name=d.name,w.stack=d.stack,w.cause=d.cause,c(w,d,g,p,x),w}if(typeof d=="object"&&u(d)){const w=Object.create(Object.getPrototypeOf(d));return p.set(d,w),c(w,d,g,p,x),w}return d}function c(d,h,g=d,p,x){const v=[...Object.keys(h),...t.getSymbols(h)];for(let w=0;w<v.length;w++){const C=v[w],k=Object.getOwnPropertyDescriptor(d,C);(k==null||k.writable)&&(d[C]=o(h[C],C,g,p,x))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=i,e.cloneDeepWithImpl=o,e.copyProperties=c})(sC)),sC}var gD;function fye(){return gD||(gD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Az();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(nC)),nC}var mD;function hye(){return mD||(mD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=H3(),r=fye();function n(s){return s=r.cloneDeep(s),a=>t.isMatch(a,s)}e.matches=n})(Qk)),Qk}var cC={},uC={},dC={},pD;function gye(){return pD||(pD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Az(),r=Nz();function n(s,a){return t.cloneDeepWith(s,(i,o,c,u)=>{const d=a?.(i,o,c,u);if(d!==void 0)return d;if(typeof s=="object")switch(Object.prototype.toString.call(s)){case r.numberTag:case r.stringTag:case r.booleanTag:{const h=new s.constructor(s?.valueOf());return t.copyProperties(h,s),h}case r.argumentsTag:{const h={};return t.copyProperties(h,s),h.length=s.length,h[Symbol.iterator]=s[Symbol.iterator],h}default:return}})}e.cloneDeepWith=n})(dC)),dC}var xD;function mye(){return xD||(xD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gye();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(uC)),uC}var fC={},hC={},yD;function jz(){return yD||(yD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,s=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<s;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(hC)),hC}var gC={},vD;function pye(){return vD||(vD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ez();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(gC)),gC}var wD;function xye(){return wD||(wD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rz(),r=jz(),n=pye(),s=M3();function a(i,o){let c;if(Array.isArray(o)?c=o:typeof o=="string"&&t.isDeepKey(o)&&i?.[o]==null?c=s.toPath(o):c=[o],c.length===0)return!1;let u=i;for(let d=0;d<c.length;d++){const h=c[d];if((u==null||!Object.hasOwn(u,h))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(h)&&h<u.length))return!1;u=u[h]}return!0}e.has=a})(fC)),fC}var bD;function yye(){return bD||(bD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=H3(),r=nz(),n=mye(),s=L3(),a=xye();function i(o,c){switch(typeof o){case"object":{Object.is(o?.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return c=n.cloneDeep(c),function(u){const d=s.get(u,o);return d===void 0?a.has(u,o):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=i})(cC)),cC}var _D;function vye(){return _D||(_D=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Sz(),r=lye(),n=hye(),s=yye();function a(i){if(i==null)return t.identity;switch(typeof i){case"function":return i;case"object":return Array.isArray(i)&&i.length===2?s.matchesProperty(i[0],i[1]):n.matches(i);case"string":case"symbol":case"number":return r.property(i)}}e.iteratee=a})(Yk)),Yk}var SD;function wye(){return SD||(SD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sye(),r=Sz(),n=oye(),s=vye();function a(i,o=r.identity){return n.isArrayLikeObject(i)?t.uniqBy(Array.from(i),s.iteratee(o)):[]}e.uniqBy=a})(zk)),zk}var mC,kD;function bye(){return kD||(kD=1,mC=wye().uniqBy),mC}var _ye=bye();const CD=Ol(_ye);function Sye(e,t,r){return t===!0?CD(e,r):typeof t=="function"?CD(e,t):e}var pC={exports:{}},xC={},yC={exports:{}},vC={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TD;function kye(){if(TD)return vC;TD=1;var e=k0();function t(h,g){return h===g&&(h!==0||1/h===1/g)||h!==h&&g!==g}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,s=e.useEffect,a=e.useLayoutEffect,i=e.useDebugValue;function o(h,g){var p=g(),x=n({inst:{value:p,getSnapshot:g}}),v=x[0].inst,w=x[1];return a(function(){v.value=p,v.getSnapshot=g,c(v)&&w({inst:v})},[h,p,g]),s(function(){return c(v)&&w({inst:v}),h(function(){c(v)&&w({inst:v})})},[h]),i(p),p}function c(h){var g=h.getSnapshot;h=h.value;try{var p=g();return!r(h,p)}catch{return!0}}function u(h,g){return g()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return vC.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,vC}var ED;function Cye(){return ED||(ED=1,yC.exports=kye()),yC.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ND;function Tye(){if(ND)return xC;ND=1;var e=k0(),t=Cye();function r(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var n=typeof Object.is=="function"?Object.is:r,s=t.useSyncExternalStore,a=e.useRef,i=e.useEffect,o=e.useMemo,c=e.useDebugValue;return xC.useSyncExternalStoreWithSelector=function(u,d,h,g,p){var x=a(null);if(x.current===null){var v={hasValue:!1,value:null};x.current=v}else v=x.current;x=o(function(){function C(P){if(!k){if(k=!0,b=P,P=g(P),p!==void 0&&v.hasValue){var F=v.value;if(p(F,P))return N=F}return N=P}if(F=N,n(b,P))return F;var A=g(P);return p!==void 0&&p(F,A)?(b=P,F):(b=P,N=A)}var k=!1,b,N,E=h===void 0?null:h;return[function(){return C(d())},E===null?void 0:function(){return C(E())}]},[d,h,g,p]);var w=s(u,x[0],x[1]);return i(function(){v.hasValue=!0,v.value=w},[w]),c(w),w},xC}var AD;function Eye(){return AD||(AD=1,pC.exports=Tye()),pC.exports}var Nye=Eye(),G3=S.createContext(null),Aye=e=>e,io=()=>{var e=S.useContext(G3);return e?e.store.dispatch:Aye},ib=()=>{},jye=()=>ib,Pye=(e,t)=>e===t;function Ar(e){var t=S.useContext(G3);return Nye.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:jye,t?t.store.getState:ib,t?t.store.getState:ib,t?e:ib,Pye)}function Fye(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Oye(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Dye(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var jD=e=>Array.isArray(e)?e:[e];function Iye(e){const t=Array.isArray(e[0])?e[0]:e;return Dye(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Rye(e,t){const r=[],{length:n}=e;for(let s=0;s<n;s++)r.push(e[s].apply(null,t));return r}var Mye=class{constructor(e){this.value=e}deref(){return this.value}},Lye=typeof WeakRef<"u"?WeakRef:Mye,Bye=0,PD=1;function Rw(){return{s:Bye,v:void 0,o:null,p:null}}function Pz(e,t={}){let r=Rw();const{resultEqualityCheck:n}=t;let s,a=0;function i(){let o=r;const{length:c}=arguments;for(let h=0,g=c;h<g;h++){const p=arguments[h];if(typeof p=="function"||typeof p=="object"&&p!==null){let x=o.o;x===null&&(o.o=x=new WeakMap);const v=x.get(p);v===void 0?(o=Rw(),x.set(p,o)):o=v}else{let x=o.p;x===null&&(o.p=x=new Map);const v=x.get(p);v===void 0?(o=Rw(),x.set(p,o)):o=v}}const u=o;let d;if(o.s===PD)d=o.v;else if(d=e.apply(null,arguments),a++,n){const h=s?.deref?.()??s;h!=null&&n(h,d)&&(d=h,a!==0&&a--),s=typeof d=="object"&&d!==null||typeof d=="function"?new Lye(d):d}return u.s=PD,u.v=d,d}return i.clearCache=()=>{r=Rw(),i.resetResultsCount()},i.resultsCount=()=>a,i.resetResultsCount=()=>{a=0},i}function $ye(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...s)=>{let a=0,i=0,o,c={},u=s.pop();typeof u=="object"&&(c=u,u=s.pop()),Fye(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:h,memoizeOptions:g=[],argsMemoize:p=Pz,argsMemoizeOptions:x=[]}=d,v=jD(g),w=jD(x),C=Iye(s),k=h(function(){return a++,u.apply(null,arguments)},...v),b=p(function(){i++;const E=Rye(C,arguments);return o=k.apply(null,E),o},...w);return Object.assign(b,{resultFunc:u,memoizedResultFunc:k,dependencies:C,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>o,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:h,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var St=$ye(Pz),Uye=Object.assign((e,t=St)=>{Oye(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(a=>e[a]);return t(n,(...a)=>a.reduce((i,o,c)=>(i[r[c]]=o,i),{}))},{withTypes:()=>Uye}),wC={},bC={},_C={},FD;function zye(){return FD||(FD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,s,a)=>{if(n!==s){const i=t(n),o=t(s);if(i===o&&i===0){if(n<s)return a==="desc"?1:-1;if(n>s)return a==="desc"?-1:1}return a==="desc"?o-i:i-o}return 0};e.compareValues=r})(_C)),_C}var SC={},kC={},OD;function Fz(){return OD||(OD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(kC)),kC}var DD;function Wye(){return DD||(DD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fz(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function s(a,i){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||t.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||i!=null&&Object.hasOwn(i,a)}e.isKey=s})(SC)),SC}var ID;function Hye(){return ID||(ID=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zye(),r=Wye(),n=M3();function s(a,i,o,c){if(a==null)return[];o=c?void 0:o,Array.isArray(a)||(a=Object.values(a)),Array.isArray(i)||(i=i==null?[null]:[i]),i.length===0&&(i=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(p=>String(p));const u=(p,x)=>{let v=p;for(let w=0;w<x.length&&v!=null;++w)v=v[x[w]];return v},d=(p,x)=>x==null||p==null?x:typeof p=="object"&&"key"in p?Object.hasOwn(x,p.key)?x[p.key]:u(x,p.path):typeof p=="function"?p(x):Array.isArray(p)?u(x,p):typeof x=="object"?x[p]:x,h=i.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:n.toPath(p)}));return a.map(p=>({original:p,criteria:h.map(x=>d(x,p))})).slice().sort((p,x)=>{for(let v=0;v<h.length;v++){const w=t.compareValues(p.criteria[v],x.criteria[v],o[v]);if(w!==0)return w}return 0}).map(p=>p.original)}e.orderBy=s})(bC)),bC}var CC={},RD;function Gye(){return RD||(RD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const s=[],a=Math.floor(n),i=(o,c)=>{for(let u=0;u<o.length;u++){const d=o[u];Array.isArray(d)&&c<a?i(d,c+1):s.push(d)}};return i(r,0),s}e.flatten=t})(CC)),CC}var TC={},MD;function Oz(){return MD||(MD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jz(),r=W3(),n=kz(),s=Tz();function a(i,o,c){return n.isObject(c)&&(typeof o=="number"&&r.isArrayLike(c)&&t.isIndex(o)&&o<c.length||typeof o=="string"&&o in c)?s.eq(c[o],i):!1}e.isIterateeCall=a})(TC)),TC}var LD;function Vye(){return LD||(LD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Hye(),r=Gye(),n=Oz();function s(a,...i){const o=i.length;return o>1&&n.isIterateeCall(a,i[0],i[1])?i=[]:o>2&&n.isIterateeCall(i[0],i[1],i[2])&&(i=[i[0]]),t.orderBy(a,r.flatten(i),["asc"])}e.sortBy=s})(wC)),wC}var EC,BD;function Kye(){return BD||(BD=1,EC=Vye().sortBy),EC}var qye=Kye();const p2=Ol(qye);var Dz=e=>e.legend.settings,Yye=e=>e.legend.size,Xye=e=>e.legend.payload;St([Xye,Dz],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?p2(n,r):n});var Mw=1;function Qye(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=S.useState({height:0,left:0,top:0,width:0}),n=S.useCallback(s=>{if(s!=null){var a=s.getBoundingClientRect(),i={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(i.height-t.height)>Mw||Math.abs(i.left-t.left)>Mw||Math.abs(i.top-t.top)>Mw||Math.abs(i.width-t.width)>Mw)&&r({height:i.height,left:i.left,top:i.top,width:i.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function ni(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Jye=typeof Symbol=="function"&&Symbol.observable||"@@observable",$D=Jye,NC=()=>Math.random().toString(36).substring(7).split("").join("."),Zye={INIT:`@@redux/INIT${NC()}`,REPLACE:`@@redux/REPLACE${NC()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${NC()}`},Zb=Zye;function V3(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function Iz(e,t,r){if(typeof e!="function")throw new Error(ni(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(ni(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(ni(1));return r(Iz)(e,t)}let n=e,s=t,a=new Map,i=a,o=0,c=!1;function u(){i===a&&(i=new Map,a.forEach((w,C)=>{i.set(C,w)}))}function d(){if(c)throw new Error(ni(3));return s}function h(w){if(typeof w!="function")throw new Error(ni(4));if(c)throw new Error(ni(5));let C=!0;u();const k=o++;return i.set(k,w),function(){if(C){if(c)throw new Error(ni(6));C=!1,u(),i.delete(k),a=null}}}function g(w){if(!V3(w))throw new Error(ni(7));if(typeof w.type>"u")throw new Error(ni(8));if(typeof w.type!="string")throw new Error(ni(17));if(c)throw new Error(ni(9));try{c=!0,s=n(s,w)}finally{c=!1}return(a=i).forEach(k=>{k()}),w}function p(w){if(typeof w!="function")throw new Error(ni(10));n=w,g({type:Zb.REPLACE})}function x(){const w=h;return{subscribe(C){if(typeof C!="object"||C===null)throw new Error(ni(11));function k(){const N=C;N.next&&N.next(d())}return k(),{unsubscribe:w(k)}},[$D](){return this}}}return g({type:Zb.INIT}),{dispatch:g,subscribe:h,getState:d,replaceReducer:p,[$D]:x}}function eve(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Zb.INIT})>"u")throw new Error(ni(12));if(typeof r(void 0,{type:Zb.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(ni(13))})}function Rz(e){const t=Object.keys(e),r={};for(let a=0;a<t.length;a++){const i=t[a];typeof e[i]=="function"&&(r[i]=e[i])}const n=Object.keys(r);let s;try{eve(r)}catch(a){s=a}return function(i={},o){if(s)throw s;let c=!1;const u={};for(let d=0;d<n.length;d++){const h=n[d],g=r[h],p=i[h],x=g(p,o);if(typeof x>"u")throw o&&o.type,new Error(ni(14));u[h]=x,c=c||x!==p}return c=c||n.length!==Object.keys(i).length,c?u:i}}function e_(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function tve(...e){return t=>(r,n)=>{const s=t(r,n);let a=()=>{throw new Error(ni(15))};const i={getState:s.getState,dispatch:(c,...u)=>a(c,...u)},o=e.map(c=>c(i));return a=e_(...o)(s.dispatch),{...s,dispatch:a}}}function Mz(e){return V3(e)&&"type"in e&&typeof e.type=="string"}var Lz=Symbol.for("immer-nothing"),UD=Symbol.for("immer-draftable"),Xo=Symbol.for("immer-state");function rc(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Am=Object.getPrototypeOf;function v0(e){return!!e&&!!e[Xo]}function sd(e){return e?Bz(e)||Array.isArray(e)||!!e[UD]||!!e.constructor?.[UD]||Jv(e)||y2(e):!1}var rve=Object.prototype.constructor.toString();function Bz(e){if(!e||typeof e!="object")return!1;const t=Am(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===rve}function t_(e,t){x2(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function x2(e){const t=e[Xo];return t?t.type_:Array.isArray(e)?1:Jv(e)?2:y2(e)?3:0}function AE(e,t){return x2(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function $z(e,t,r){const n=x2(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function nve(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Jv(e){return e instanceof Map}function y2(e){return e instanceof Set}function Eh(e){return e.copy_||e.base_}function jE(e,t){if(Jv(e))return new Map(e);if(y2(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Bz(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[Xo];let s=Reflect.ownKeys(n);for(let a=0;a<s.length;a++){const i=s[a],o=n[i];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Am(e),n)}else{const n=Am(e);if(n!==null&&r)return{...e};const s=Object.create(n);return Object.assign(s,e)}}function K3(e,t=!1){return v2(e)||v0(e)||!sd(e)||(x2(e)>1&&Object.defineProperties(e,{set:{value:Lw},add:{value:Lw},clear:{value:Lw},delete:{value:Lw}}),Object.freeze(e),t&&Object.values(e).forEach(r=>K3(r,!0))),e}function Lw(){rc(2)}function v2(e){return Object.isFrozen(e)}var sve={};function w0(e){const t=sve[e];return t||rc(0,e),t}var hv;function Uz(){return hv}function ave(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function zD(e,t){t&&(w0("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function PE(e){FE(e),e.drafts_.forEach(ive),e.drafts_=null}function FE(e){e===hv&&(hv=e.parent_)}function WD(e){return hv=ave(hv,e)}function ive(e){const t=e[Xo];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function HD(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Xo].modified_&&(PE(t),rc(4)),sd(e)&&(e=r_(t,e),t.parent_||n_(t,e)),t.patches_&&w0("Patches").generateReplacementPatches_(r[Xo].base_,e,t.patches_,t.inversePatches_)):e=r_(t,r,[]),PE(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Lz?e:void 0}function r_(e,t,r){if(v2(t))return t;const n=t[Xo];if(!n)return t_(t,(s,a)=>GD(e,n,t,s,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return n_(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const s=n.copy_;let a=s,i=!1;n.type_===3&&(a=new Set(s),s.clear(),i=!0),t_(a,(o,c)=>GD(e,n,s,o,c,r,i)),n_(e,s,!1),r&&e.patches_&&w0("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function GD(e,t,r,n,s,a,i){if(v0(s)){const o=a&&t&&t.type_!==3&&!AE(t.assigned_,n)?a.concat(n):void 0,c=r_(e,s,o);if($z(r,n,c),v0(c))e.canAutoFreeze_=!1;else return}else i&&r.add(s);if(sd(s)&&!v2(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;r_(e,s),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(Jv(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&n_(e,s)}}function n_(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&K3(t,r)}function ove(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Uz(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,a=q3;r&&(s=[n],a=gv);const{revoke:i,proxy:o}=Proxy.revocable(s,a);return n.draft_=o,n.revoke_=i,o}var q3={get(e,t){if(t===Xo)return e;const r=Eh(e);if(!AE(r,t))return lve(e,r,t);const n=r[t];return e.finalized_||!sd(n)?n:n===AC(e.base_,t)?(jC(e),e.copy_[t]=DE(n,e)):n},has(e,t){return t in Eh(e)},ownKeys(e){return Reflect.ownKeys(Eh(e))},set(e,t,r){const n=zz(Eh(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const s=AC(Eh(e),t),a=s?.[Xo];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(nve(r,s)&&(r!==void 0||AE(e.base_,t)))return!0;jC(e),OE(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return AC(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,jC(e),OE(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Eh(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){rc(11)},getPrototypeOf(e){return Am(e.base_)},setPrototypeOf(){rc(12)}},gv={};t_(q3,(e,t)=>{gv[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});gv.deleteProperty=function(e,t){return gv.set.call(this,e,t,void 0)};gv.set=function(e,t,r){return q3.set.call(this,e[0],t,r,e[0])};function AC(e,t){const r=e[Xo];return(r?Eh(r):e)[t]}function lve(e,t,r){const n=zz(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function zz(e,t){if(!(t in e))return;let r=Am(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Am(r)}}function OE(e){e.modified_||(e.modified_=!0,e.parent_&&OE(e.parent_))}function jC(e){e.copy_||(e.copy_=jE(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var cve=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const a=r;r=t;const i=this;return function(c=a,...u){return i.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&rc(6),n!==void 0&&typeof n!="function"&&rc(7);let s;if(sd(t)){const a=WD(this),i=DE(t,void 0);let o=!0;try{s=r(i),o=!1}finally{o?PE(a):FE(a)}return zD(a,n),HD(s,a)}else if(!t||typeof t!="object"){if(s=r(t),s===void 0&&(s=t),s===Lz&&(s=void 0),this.autoFreeze_&&K3(s,!0),n){const a=[],i=[];w0("Patches").generateReplacementPatches_(t,s,a,i),n(a,i)}return s}else rc(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...o)=>this.produceWithPatches(i,c=>t(c,...o));let n,s;return[this.produce(t,r,(i,o)=>{n=i,s=o}),n,s]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){sd(e)||rc(8),v0(e)&&(e=Xu(e));const t=WD(this),r=DE(e,void 0);return r[Xo].isManual_=!0,FE(t),r}finishDraft(e,t){const r=e&&e[Xo];(!r||!r.isManual_)&&rc(9);const{scope_:n}=r;return zD(n,t),HD(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const s=t[r];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}r>-1&&(t=t.slice(r+1));const n=w0("Patches").applyPatches_;return v0(e)?n(e,t):this.produce(e,s=>n(s,t))}};function DE(e,t){const r=Jv(e)?w0("MapSet").proxyMap_(e,t):y2(e)?w0("MapSet").proxySet_(e,t):ove(e,t);return(t?t.scope_:Uz()).drafts_.push(r),r}function Xu(e){return v0(e)||rc(10,e),Wz(e)}function Wz(e){if(!sd(e)||v2(e))return e;const t=e[Xo];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=jE(e,t.scope_.immer_.useStrictShallowCopy_)}else r=jE(e,!0);return t_(r,(n,s)=>{$z(r,n,Wz(s))}),t&&(t.finalized_=!1),r}var uve=new cve,Hz=uve.produce;function Gz(e){return({dispatch:r,getState:n})=>s=>a=>typeof a=="function"?a(r,n,e):s(a)}var dve=Gz(),fve=Gz,hve=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?e_:e_.apply(null,arguments)};function Pl(e,t){function r(...n){if(t){let s=t(...n);if(!s)throw new Error(Ko(0));return{type:e,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>Mz(n)&&n.type===e,r}var Vz=class fy extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,fy.prototype)}static get[Symbol.species](){return fy}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new fy(...t[0].concat(this)):new fy(...t.concat(this))}};function VD(e){return sd(e)?Hz(e,()=>{}):e}function Bw(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function gve(e){return typeof e=="boolean"}var mve=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:s=!0,actionCreatorCheck:a=!0}=t??{};let i=new Vz;return r&&(gve(r)?i.push(dve):i.push(fve(r.extraArgument))),i},pve="RTK_autoBatch",KD=e=>t=>{setTimeout(t,e)},xve=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let s=!0,a=!1,i=!1;const o=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:KD(10):e.type==="callback"?e.queueNotification:KD(e.timeout),u=()=>{i=!1,a&&(a=!1,o.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const h=()=>s&&d(),g=n.subscribe(h);return o.add(d),()=>{g(),o.delete(d)}},dispatch(d){try{return s=!d?.meta?.[pve],a=!s,a&&(i||(i=!0,c(u))),n.dispatch(d)}finally{s=!0}}})},yve=e=>function(r){const{autoBatch:n=!0}=r??{};let s=new Vz(e);return n&&s.push(xve(typeof n=="object"?n:void 0)),s};function vve(e){const t=mve(),{reducer:r=void 0,middleware:n,devTools:s=!0,preloadedState:a=void 0,enhancers:i=void 0}=e||{};let o;if(typeof r=="function")o=r;else if(V3(r))o=Rz(r);else throw new Error(Ko(1));let c;typeof n=="function"?c=n(t):c=t();let u=e_;s&&(u=hve({trace:!1,...typeof s=="object"&&s}));const d=tve(...c),h=yve(d);let g=typeof i=="function"?i(h):h();const p=u(...g);return Iz(o,a,p)}function Kz(e){const t={},r=[];let n;const s={addCase(a,i){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(Ko(28));if(o in t)throw new Error(Ko(29));return t[o]=i,s},addAsyncThunk(a,i){return i.pending&&(t[a.pending.type]=i.pending),i.rejected&&(t[a.rejected.type]=i.rejected),i.fulfilled&&(t[a.fulfilled.type]=i.fulfilled),i.settled&&r.push({matcher:a.settled,reducer:i.settled}),s},addMatcher(a,i){return r.push({matcher:a,reducer:i}),s},addDefaultCase(a){return n=a,s}};return e(s),[t,r,n]}function wve(e){return typeof e=="function"}function bve(e,t){let[r,n,s]=Kz(t),a;if(wve(e))a=()=>VD(e());else{const o=VD(e);a=()=>o}function i(o=a(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[s]),u.reduce((d,h)=>{if(h)if(v0(d)){const p=h(d,c);return p===void 0?d:p}else{if(sd(d))return Hz(d,g=>h(g,c));{const g=h(d,c);if(g===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return g}}return d},o)}return i.getInitialState=a,i}var _ve="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Sve=(e=21)=>{let t="",r=e;for(;r--;)t+=_ve[Math.random()*64|0];return t},kve=Symbol.for("rtk-slice-createasyncthunk");function Cve(e,t){return`${e}/${t}`}function Tve({creators:e}={}){const t=e?.asyncThunk?.[kve];return function(n){const{name:s,reducerPath:a=s}=n;if(!s)throw new Error(Ko(11));const i=(typeof n.reducers=="function"?n.reducers(Nve()):n.reducers)||{},o=Object.keys(i),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(b,N){const E=typeof b=="string"?b:b.type;if(!E)throw new Error(Ko(12));if(E in c.sliceCaseReducersByType)throw new Error(Ko(13));return c.sliceCaseReducersByType[E]=N,u},addMatcher(b,N){return c.sliceMatchers.push({matcher:b,reducer:N}),u},exposeAction(b,N){return c.actionCreators[b]=N,u},exposeCaseReducer(b,N){return c.sliceCaseReducersByName[b]=N,u}};o.forEach(b=>{const N=i[b],E={reducerName:b,type:Cve(s,b),createNotation:typeof n.reducers=="function"};jve(N)?Fve(E,N,u,t):Ave(E,N,u)});function d(){const[b={},N=[],E=void 0]=typeof n.extraReducers=="function"?Kz(n.extraReducers):[n.extraReducers],P={...b,...c.sliceCaseReducersByType};return bve(n.initialState,F=>{for(let A in P)F.addCase(A,P[A]);for(let A of c.sliceMatchers)F.addMatcher(A.matcher,A.reducer);for(let A of N)F.addMatcher(A.matcher,A.reducer);E&&F.addDefaultCase(E)})}const h=b=>b,g=new Map,p=new WeakMap;let x;function v(b,N){return x||(x=d()),x(b,N)}function w(){return x||(x=d()),x.getInitialState()}function C(b,N=!1){function E(F){let A=F[b];return typeof A>"u"&&N&&(A=Bw(p,E,w)),A}function P(F=h){const A=Bw(g,N,()=>new WeakMap);return Bw(A,F,()=>{const j={};for(const[I,B]of Object.entries(n.selectors??{}))j[I]=Eve(B,F,()=>Bw(p,F,w),N);return j})}return{reducerPath:b,getSelectors:P,get selectors(){return P(E)},selectSlice:E}}const k={name:s,reducer:v,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:w,...C(a),injectInto(b,{reducerPath:N,...E}={}){const P=N??a;return b.inject({reducerPath:P,reducer:v},E),{...k,...C(P,!0)}}};return k}}function Eve(e,t,r,n){function s(a,...i){let o=t(a);return typeof o>"u"&&n&&(o=r()),e(o,...i)}return s.unwrapped=e,s}var Jo=Tve();function Nve(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function Ave({type:e,reducerName:t,createNotation:r},n,s){let a,i;if("reducer"in n){if(r&&!Pve(n))throw new Error(Ko(17));a=n.reducer,i=n.prepare}else a=n;s.addCase(e,a).exposeCaseReducer(t,a).exposeAction(t,i?Pl(e,i):Pl(e))}function jve(e){return e._reducerDefinitionType==="asyncThunk"}function Pve(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Fve({type:e,reducerName:t},r,n,s){if(!s)throw new Error(Ko(18));const{payloadCreator:a,fulfilled:i,pending:o,rejected:c,settled:u,options:d}=r,h=s(e,a,d);n.exposeAction(t,h),i&&n.addCase(h.fulfilled,i),o&&n.addCase(h.pending,o),c&&n.addCase(h.rejected,c),u&&n.addMatcher(h.settled,u),n.exposeCaseReducer(t,{fulfilled:i||$w,pending:o||$w,rejected:c||$w,settled:u||$w})}function $w(){}var Ove="task",qz="listener",Yz="completed",Y3="cancelled",Dve=`task-${Y3}`,Ive=`task-${Yz}`,IE=`${qz}-${Y3}`,Rve=`${qz}-${Yz}`,w2=class{constructor(e){this.code=e,this.message=`${Ove} ${Y3} (reason: ${e})`}name="TaskAbortError";message},X3=(e,t)=>{if(typeof e!="function")throw new TypeError(Ko(32))},s_=()=>{},Xz=(e,t=s_)=>(e.catch(t),e),Qz=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Yh=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Xh=e=>{if(e.aborted){const{reason:t}=e;throw new w2(t)}};function Jz(e,t){let r=s_;return new Promise((n,s)=>{const a=()=>s(new w2(e.reason));if(e.aborted){a();return}r=Qz(e,a),t.finally(()=>r()).then(n,s)}).finally(()=>{r=s_})}var Mve=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof w2?"cancelled":"rejected",error:r}}finally{t?.()}},a_=e=>t=>Xz(Jz(e,t).then(r=>(Xh(e),r))),Zz=e=>{const t=a_(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:gm}=Object,qD={},b2="listenerMiddleware",Lve=(e,t)=>{const r=n=>Qz(e,()=>Yh(n,e.reason));return(n,s)=>{X3(n);const a=new AbortController;r(a);const i=Mve(async()=>{Xh(e),Xh(a.signal);const o=await n({pause:a_(a.signal),delay:Zz(a.signal),signal:a.signal});return Xh(a.signal),o},()=>Yh(a,Ive));return s?.autoJoin&&t.push(i.catch(s_)),{result:a_(e)(i),cancel(){Yh(a,Dve)}}}},Bve=(e,t)=>{const r=async(n,s)=>{Xh(t);let a=()=>{};const o=[new Promise((c,u)=>{let d=e({predicate:n,effect:(h,g)=>{g.unsubscribe(),c([h,g.getState(),g.getOriginalState()])}});a=()=>{d(),u()}})];s!=null&&o.push(new Promise(c=>setTimeout(c,s,null)));try{const c=await Jz(t,Promise.race(o));return Xh(t),c}finally{a()}};return(n,s)=>Xz(r(n,s))},eW=e=>{let{type:t,actionCreator:r,matcher:n,predicate:s,effect:a}=e;if(t)s=Pl(t).match;else if(r)t=r.type,s=r.match;else if(n)s=n;else if(!s)throw new Error(Ko(21));return X3(a),{predicate:s,type:t,effect:a}},tW=gm(e=>{const{type:t,predicate:r,effect:n}=eW(e);return{id:Sve(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Ko(22))}}},{withTypes:()=>tW}),YD=(e,t)=>{const{type:r,effect:n,predicate:s}=eW(t);return Array.from(e.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===s)&&a.effect===n)},RE=e=>{e.pending.forEach(t=>{Yh(t,IE)})},$ve=e=>()=>{e.forEach(RE),e.clear()},XD=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},rW=gm(Pl(`${b2}/add`),{withTypes:()=>rW}),Uve=Pl(`${b2}/removeAll`),nW=gm(Pl(`${b2}/remove`),{withTypes:()=>nW}),zve=(...e)=>{console.error(`${b2}/error`,...e)},Zv=(e={})=>{const t=new Map,{extra:r,onError:n=zve}=e;X3(n);const s=d=>(d.unsubscribe=()=>t.delete(d.id),t.set(d.id,d),h=>{d.unsubscribe(),h?.cancelActive&&RE(d)}),a=d=>{const h=YD(t,d)??tW(d);return s(h)};gm(a,{withTypes:()=>a});const i=d=>{const h=YD(t,d);return h&&(h.unsubscribe(),d.cancelActive&&RE(h)),!!h};gm(i,{withTypes:()=>i});const o=async(d,h,g,p)=>{const x=new AbortController,v=Bve(a,x.signal),w=[];try{d.pending.add(x),await Promise.resolve(d.effect(h,gm({},g,{getOriginalState:p,condition:(C,k)=>v(C,k).then(Boolean),take:v,delay:Zz(x.signal),pause:a_(x.signal),extra:r,signal:x.signal,fork:Lve(x.signal,w),unsubscribe:d.unsubscribe,subscribe:()=>{t.set(d.id,d)},cancelActiveListeners:()=>{d.pending.forEach((C,k,b)=>{C!==x&&(Yh(C,IE),b.delete(C))})},cancel:()=>{Yh(x,IE),d.pending.delete(x)},throwIfCancelled:()=>{Xh(x.signal)}})))}catch(C){C instanceof w2||XD(n,C,{raisedBy:"effect"})}finally{await Promise.all(w),Yh(x,Rve),d.pending.delete(x)}},c=$ve(t);return{middleware:d=>h=>g=>{if(!Mz(g))return h(g);if(rW.match(g))return a(g.payload);if(Uve.match(g)){c();return}if(nW.match(g))return i(g.payload);let p=d.getState();const x=()=>{if(p===qD)throw new Error(Ko(23));return p};let v;try{if(v=h(g),t.size>0){const w=d.getState(),C=Array.from(t.values());for(const k of C){let b=!1;try{b=k.predicate(g,w,p)}catch(N){b=!1,XD(n,N,{raisedBy:"predicate"})}b&&o(k,g,d,x)}}}finally{p=qD}return v},startListening:a,stopListening:i,clearListeners:c}};function Ko(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Wve={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},sW=Jo({name:"chartLayout",initialState:Wve,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,s,a;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(s=t.payload.bottom)!==null&&s!==void 0?s:0,e.margin.left=(a=t.payload.left)!==null&&a!==void 0?a:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:Hve,setLayout:Gve,setChartSize:Vve,setScale:Kve}=sW.actions,qve=sW.reducer;function QD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function JD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QD(Object(r),!0).forEach(function(n){Yve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yve(e,t,r){return(t=Xve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xve(e){var t=Qve(e,"string");return typeof t=="symbol"?t:t+""}function Qve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i_=Math.PI/180,Jve=e=>e*180/Math.PI,di=(e,t,r,n)=>({x:e+Math.cos(-i_*n)*r,y:t+Math.sin(-i_*n)*r}),Zve=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},e1e=(e,t)=>{var{x:r,y:n}=e,{x:s,y:a}=t;return Math.sqrt((r-s)**2+(n-a)**2)},t1e=(e,t)=>{var{x:r,y:n}=e,{cx:s,cy:a}=t,i=e1e({x:r,y:n},{x:s,y:a});if(i<=0)return{radius:i,angle:0};var o=(r-s)/i,c=Math.acos(o);return n>a&&(c=2*Math.PI-c),{radius:i,angle:Jve(c),angleInRadian:c}},r1e=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),s=Math.floor(r/360),a=Math.min(n,s);return{startAngle:t-a*360,endAngle:r-a*360}},n1e=(e,t)=>{var{startAngle:r,endAngle:n}=t,s=Math.floor(r/360),a=Math.floor(n/360),i=Math.min(s,a);return e+i*360},s1e=(e,t)=>{var{x:r,y:n}=e,{radius:s,angle:a}=t1e({x:r,y:n},t),{innerRadius:i,outerRadius:o}=t;if(s<i||s>o||s===0)return null;var{startAngle:c,endAngle:u}=r1e(t),d=a,h;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;h=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;h=d>=u&&d<=c}return h?JD(JD({},t),{},{radius:s,angle:n1e(d,t)}):null};function aW(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function ZD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function wl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZD(Object(r),!0).forEach(function(n){a1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function a1e(e,t,r){return(t=i1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i1e(e){var t=o1e(e,"string");return typeof t=="symbol"?t:t+""}function o1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function so(e,t,r){return Ua(e)||Ua(t)?r:Zc(t)?h2(e,t,r):typeof t=="function"?t(e):r}var l1e=(e,t,r,n,s)=>{var a,i=-1,o=(a=t?.length)!==null&&a!==void 0?a:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&s!=null&&Math.abs(Math.abs(s[1]-s[0])-360)<=1e-6)for(var c=0;c<o;c++){var u=c>0?r[c-1].coordinate:r[o-1].coordinate,d=r[c].coordinate,h=c>=o-1?r[0].coordinate:r[c+1].coordinate,g=void 0;if(Sl(d-u)!==Sl(h-d)){var p=[];if(Sl(h-d)===Sl(s[1]-s[0])){g=h;var x=d+s[1]-s[0];p[0]=Math.min(x,(x+u)/2),p[1]=Math.max(x,(x+u)/2)}else{g=u;var v=h+s[1]-s[0];p[0]=Math.min(d,(v+d)/2),p[1]=Math.max(d,(v+d)/2)}var w=[Math.min(d,(g+d)/2),Math.max(d,(g+d)/2)];if(e>w[0]&&e<=w[1]||e>=p[0]&&e<=p[1]){({index:i}=r[c]);break}}else{var C=Math.min(u,h),k=Math.max(u,h);if(e>(C+d)/2&&e<=(k+d)/2){({index:i}=r[c]);break}}}else if(t){for(var b=0;b<o;b++)if(b===0&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b>0&&b<o-1&&e>(t[b].coordinate+t[b-1].coordinate)/2&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b===o-1&&e>(t[b].coordinate+t[b-1].coordinate)/2){({index:i}=t[b]);break}}return i},c1e=(e,t,r)=>{if(t&&r){var{width:n,height:s}=r,{align:a,verticalAlign:i,layout:o}=t;if((o==="vertical"||o==="horizontal"&&i==="middle")&&a!=="center"&&Lr(e[a]))return wl(wl({},e),{},{[a]:e[a]+(n||0)});if((o==="horizontal"||o==="vertical"&&a==="center")&&i!=="middle"&&Lr(e[i]))return wl(wl({},e),{},{[i]:e[i]+(s||0)})}return e},Uf=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",iW=(e,t,r,n)=>{if(n)return e.map(o=>o.coordinate);var s,a,i=e.map(o=>(o.coordinate===t&&(s=!0),o.coordinate===r&&(a=!0),o.coordinate));return s||i.push(t),a||i.push(r),i},oW=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:s,range:a,scale:i,realScaleType:o,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:h,niceTicks:g,axisType:p}=e;if(!i)return null;var x=o==="scaleBand"&&i.bandwidth?i.bandwidth()/2:2,v=s==="category"&&i.bandwidth?i.bandwidth()/x:0;if(v=p==="angleAxis"&&a&&a.length>=2?Sl(a[0]-a[1])*2*v:v,h||g){var w=(h||g||[]).map((C,k)=>{var b=n?n.indexOf(C):C;return{coordinate:i(b)+v,value:C,offset:v,index:k}});return w.filter(C=>!jl(C.coordinate))}return c&&u?u.map((C,k)=>({coordinate:i(C)+v,value:C,index:k,offset:v})):i.ticks&&d!=null?i.ticks(d).map((C,k)=>({coordinate:i(C)+v,value:C,offset:v,index:k})):i.domain().map((C,k)=>({coordinate:i(C)+v,value:n?n[C]:C,index:k,offset:v}))},eI=1e-4,u1e=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),s=Math.min(n[0],n[1])-eI,a=Math.max(n[0],n[1])+eI,i=e(t[0]),o=e(t[r-1]);(i<s||i>a||o<s||o>a)&&e.domain([t[0],t[r-1]])}},d1e=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var s=0,a=0,i=0;i<t;++i){var o=jl(e[i][r][1])?e[i][r][0]:e[i][r][1];o>=0?(e[i][r][0]=s,e[i][r][1]=s+o,s=e[i][r][1]):(e[i][r][0]=a,e[i][r][1]=a+o,a=e[i][r][1])}},f1e=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var s=0,a=0;a<t;++a){var i=jl(e[a][r][1])?e[a][r][0]:e[a][r][1];i>=0?(e[a][r][0]=s,e[a][r][1]=s+i,s=e[a][r][1]):(e[a][r][0]=0,e[a][r][1]=0)}},h1e={sign:d1e,expand:tye,none:Nm,silhouette:rye,wiggle:nye,positive:f1e},g1e=(e,t,r)=>{var n=h1e[r],s=eye().keys(t).value((a,i)=>+so(a,i,0)).order(NE).offset(n);return s(e)};function tI(e){var{axis:t,ticks:r,bandSize:n,entry:s,index:a,dataKey:i}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Ua(s[t.dataKey])){var o=az(r,"value",s[t.dataKey]);if(o)return o.coordinate+n/2}return r[a]?r[a].coordinate+n/2:null}var c=so(s,Ua(i)?t.dataKey:i);return Ua(c)?null:t.scale(c)}var m1e=e=>{var t=e.flat(2).filter(Lr);return[Math.min(...t),Math.max(...t)]},p1e=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],x1e=(e,t,r)=>{if(e!=null)return p1e(Object.keys(e).reduce((n,s)=>{var a=e[s],{stackedData:i}=a,o=i.reduce((c,u)=>{var d=aW(u,t,r),h=m1e(d);return[Math.min(c[0],h[0]),Math.max(c[1],h[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},rI=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,nI=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,ME=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var s=p2(t,d=>d.coordinate),a=1/0,i=1,o=s.length;i<o;i++){var c=s[i],u=s[i-1];a=Math.min((c.coordinate||0)-(u.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};function sI(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:s,name:a}=e;return wl(wl({},t),{},{dataKey:r,payload:n,value:s,name:a})}function lW(e,t){if(e)return String(e);if(typeof t=="string")return t}function y1e(e,t,r,n,s){if(r==="horizontal"||r==="vertical"){var a=e>=s.left&&e<=s.left+s.width&&t>=s.top&&t<=s.top+s.height;return a?{x:e,y:t}:null}return n?s1e({x:e,y:t},n):null}var v1e=(e,t,r,n)=>{var s=t.find(u=>u&&u.index===r);if(s){if(e==="horizontal")return{x:s.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:s.coordinate};if(e==="centric"){var a=s.coordinate,{radius:i}=n;return wl(wl(wl({},n),di(n.cx,n.cy,i,a)),{},{angle:a,radius:i})}var o=s.coordinate,{angle:c}=n;return wl(wl(wl({},n),di(n.cx,n.cy,o,c)),{},{angle:c,radius:o})}return{x:0,y:0}},w1e=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,hd=e=>e.layout.width,gd=e=>e.layout.height,b1e=e=>e.layout.scale,cW=e=>e.layout.margin,_2=St(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),S2=St(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),_1e="data-recharts-item-index",S1e="data-recharts-item-data-key",e1=60;function aI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Uw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aI(Object(r),!0).forEach(function(n){k1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function k1e(e,t,r){return(t=C1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C1e(e){var t=T1e(e,"string");return typeof t=="symbol"?t:t+""}function T1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var E1e=e=>e.brush.height;function N1e(e){var t=S2(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var s=typeof n.width=="number"?n.width:e1;return r+s}return r},0)}function A1e(e){var t=S2(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var s=typeof n.width=="number"?n.width:e1;return r+s}return r},0)}function j1e(e){var t=_2(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function P1e(e){var t=_2(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var mi=St([hd,gd,cW,E1e,N1e,A1e,j1e,P1e,Dz,Yye],(e,t,r,n,s,a,i,o,c,u)=>{var d={left:(r.left||0)+s,right:(r.right||0)+a},h={top:(r.top||0)+i,bottom:(r.bottom||0)+o},g=Uw(Uw({},h),d),p=g.bottom;g.bottom+=n,g=c1e(g,c,u);var x=e-g.left-g.right,v=t-g.top-g.bottom;return Uw(Uw({brushBottom:p},g),{},{width:Math.max(x,0),height:Math.max(v,0)})}),F1e=St(mi,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),uW=St(hd,gd,(e,t)=>({x:0,y:0,width:e,height:t})),O1e=S.createContext(null),Il=()=>S.useContext(O1e)!=null,k2=e=>e.brush,C2=St([k2,mi,cW],(e,t,r)=>({height:e.height,x:Lr(e.x)?e.x:t.left,y:Lr(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:Lr(e.width)?e.width:t.width})),Q3=()=>{var e,t=Il(),r=Ar(F1e),n=Ar(C2),s=(e=Ar(k2))===null||e===void 0?void 0:e.padding;return!t||!n||!s?r:{width:n.width-s.left-s.right,height:n.height-s.top-s.bottom,x:s.left,y:s.top}},D1e={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},dW=()=>{var e;return(e=Ar(mi))!==null&&e!==void 0?e:D1e},fW=()=>Ar(hd),hW=()=>Ar(gd),us=e=>e.layout.layoutType,J3=()=>Ar(us),I1e={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},gW=Jo({name:"legend",initialState:I1e,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=Xu(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:$3e,setLegendSettings:U3e,addLegendPayload:R1e,removeLegendPayload:M1e}=gW.actions,L1e=gW.reducer;function LE(){return LE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},LE.apply(null,arguments)}function iI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function PC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iI(Object(r),!0).forEach(function(n){B1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B1e(e,t,r){return(t=$1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $1e(e){var t=U1e(e,"string");return typeof t=="symbol"?t:t+""}function U1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function z1e(e){return Array.isArray(e)&&Zc(e[0])&&Zc(e[1])?e.join(" ~ "):e}var W1e=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:s={},payload:a,formatter:i,itemSorter:o,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:h,accessibilityLayer:g=!1}=e,p=()=>{if(a&&a.length){var E={padding:0,margin:0},P=(o?p2(a,o):a).map((F,A)=>{if(F.type==="none")return null;var j=F.formatter||i||z1e,{value:I,name:B}=F,Y=I,Z=B;if(j){var ae=j(I,B,F,A,a);if(Array.isArray(ae))[Y,Z]=ae;else if(ae!=null)Y=ae;else return null}var ee=PC({display:"block",paddingTop:4,paddingBottom:4,color:F.color||"#000"},n);return S.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(A),style:ee},Zc(Z)?S.createElement("span",{className:"recharts-tooltip-item-name"},Z):null,Zc(Z)?S.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,S.createElement("span",{className:"recharts-tooltip-item-value"},Y),S.createElement("span",{className:"recharts-tooltip-item-unit"},F.unit||""))});return S.createElement("ul",{className:"recharts-tooltip-item-list",style:E},P)}return null},x=PC({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),v=PC({margin:0},s),w=!Ua(d),C=w?d:"",k=ls("recharts-default-tooltip",c),b=ls("recharts-tooltip-label",u);w&&h&&a!==void 0&&a!==null&&(C=h(d,a));var N=g?{role:"status","aria-live":"assertive"}:{};return S.createElement("div",LE({className:k,style:x},N),S.createElement("p",{className:b,style:v},S.isValidElement(C)?C:"".concat(C)),p())},Jx="recharts-tooltip-wrapper",H1e={visibility:"hidden"};function G1e(e){var{coordinate:t,translateX:r,translateY:n}=e;return ls(Jx,{["".concat(Jx,"-right")]:Lr(r)&&t&&Lr(t.x)&&r>=t.x,["".concat(Jx,"-left")]:Lr(r)&&t&&Lr(t.x)&&r<t.x,["".concat(Jx,"-bottom")]:Lr(n)&&t&&Lr(t.y)&&n>=t.y,["".concat(Jx,"-top")]:Lr(n)&&t&&Lr(t.y)&&n<t.y})}function oI(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:s,position:a,reverseDirection:i,tooltipDimension:o,viewBox:c,viewBoxDimension:u}=e;if(a&&Lr(a[n]))return a[n];var d=r[n]-o-(s>0?s:0),h=r[n]+s;if(t[n])return i[n]?d:h;var g=c[n];if(g==null)return 0;if(i[n]){var p=d,x=g;return p<x?Math.max(h,g):Math.max(d,g)}if(u==null)return 0;var v=h+o,w=g+u;return v>w?Math.max(d,g):Math.max(h,g)}function V1e(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function K1e(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:s,reverseDirection:a,tooltipBox:i,useTranslate3d:o,viewBox:c}=e,u,d,h;return i.height>0&&i.width>0&&r?(d=oI({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:s,reverseDirection:a,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),h=oI({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:s,reverseDirection:a,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),u=V1e({translateX:d,translateY:h,useTranslate3d:o})):u=H1e,{cssProperties:u,cssClasses:G1e({translateX:d,translateY:h,coordinate:r})}}function lI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function zw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lI(Object(r),!0).forEach(function(n){BE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BE(e,t,r){return(t=q1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q1e(e){var t=Y1e(e,"string");return typeof t=="symbol"?t:t+""}function Y1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class X1e extends S.PureComponent{constructor(){super(...arguments),BE(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),BE(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,s,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(s=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&s!==void 0?s:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:s,children:a,coordinate:i,hasPayload:o,isAnimationActive:c,offset:u,position:d,reverseDirection:h,useTranslate3d:g,viewBox:p,wrapperStyle:x,lastBoundingBox:v,innerRef:w,hasPortalFromProps:C}=this.props,{cssClasses:k,cssProperties:b}=K1e({allowEscapeViewBox:r,coordinate:i,offsetTopLeft:u,position:d,reverseDirection:h,tooltipBox:{height:v.height,width:v.width},useTranslate3d:g,viewBox:p}),N=C?{}:zw(zw({transition:c&&t?"transform ".concat(n,"ms ").concat(s):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),E=zw(zw({},N),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},x);return S.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:k,style:E,ref:w},a)}}var Q1e=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),np={devToolsEnabled:!1,isSsr:Q1e()},mW=()=>Ar(e=>e.rootProps.accessibilityLayer);function fc(e){return Number.isFinite(e)}function o_(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function $E(){return $E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$E.apply(null,arguments)}function cI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function uI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cI(Object(r),!0).forEach(function(n){J1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function J1e(e,t,r){return(t=Z1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z1e(e){var t=ewe(e,"string");return typeof t=="symbol"?t:t+""}function ewe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dI={curveBasisClosed:Wxe,curveBasisOpen:Hxe,curveBasis:zxe,curveBumpX:$xe,curveBumpY:Uxe,curveLinearClosed:Gxe,curveLinear:g2,curveMonotoneX:Vxe,curveMonotoneY:Kxe,curveNatural:qxe,curveStep:Yxe,curveStepAfter:Qxe,curveStepBefore:Xxe},Ww=e=>fc(e.x)&&fc(e.y),Zx=e=>e.x,ey=e=>e.y,twe=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(B3(e));return(r==="curveMonotone"||r==="curveBump")&&t?dI["".concat(r).concat(t==="vertical"?"Y":"X")]:dI[r]||g2},rwe=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:s,connectNulls:a=!1}=e,i=twe(t,s),o=a?r.filter(Ww):r,c;if(Array.isArray(n)){var u=a?n.filter(h=>Ww(h)):n,d=o.map((h,g)=>uI(uI({},h),{},{base:u[g]}));return s==="vertical"?c=Iw().y(ey).x1(Zx).x0(h=>h.base.x):c=Iw().x(Zx).y1(ey).y0(h=>h.base.y),c.defined(Ww).curve(i),c(d)}return s==="vertical"&&Lr(n)?c=Iw().y(ey).x1(Zx).x0(n):Lr(n)?c=Iw().x(Zx).y1(ey).y0(n):c=gz().x(Zx).y(ey),c.defined(Ww).curve(i),c(o)},pW=e=>{var{className:t,points:r,path:n,pathRef:s}=e;if((!r||!r.length)&&!n)return null;var a=r&&r.length?rwe(e):n;return S.createElement("path",$E({},I0(e),U3(e),{className:ls("recharts-curve",t),d:a===null?void 0:a,ref:s}))},nwe=["x","y","top","left","width","height","className"];function UE(){return UE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},UE.apply(null,arguments)}function fI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function swe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fI(Object(r),!0).forEach(function(n){awe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function awe(e,t,r){return(t=iwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iwe(e){var t=owe(e,"string");return typeof t=="symbol"?t:t+""}function owe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lwe(e,t){if(e==null)return{};var r,n,s=cwe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function cwe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var uwe=(e,t,r,n,s,a)=>"M".concat(e,",").concat(s,"v").concat(n,"M").concat(a,",").concat(t,"h").concat(r),dwe=e=>{var{x:t=0,y:r=0,top:n=0,left:s=0,width:a=0,height:i=0,className:o}=e,c=lwe(e,nwe),u=swe({x:t,y:r,top:n,left:s,width:a,height:i},c);return!Lr(t)||!Lr(r)||!Lr(a)||!Lr(i)||!Lr(n)||!Lr(s)?null:S.createElement("path",UE({},gi(u,!0),{className:ls("recharts-cross",o),d:uwe(t,r,a,i,n,s)}))};function fwe(e,t,r,n){var s=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-s:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-s,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function hI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function hwe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hI(Object(r),!0).forEach(function(n){gwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gwe(e,t,r){return(t=mwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mwe(e){var t=pwe(e,"string");return typeof t=="symbol"?t:t+""}function pwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rl(e,t){var r=hwe({},e),n=t,s=Object.keys(t),a=s.reduce((i,o)=>(i[o]===void 0&&n[o]!==void 0&&(i[o]=n[o]),i),r);return a}function xwe(){}function gI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function mI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gI(Object(r),!0).forEach(function(n){ywe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ywe(e,t,r){return(t=vwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vwe(e){var t=wwe(e,"string");return typeof t=="symbol"?t:t+""}function wwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bwe=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),_we=(e,t,r)=>e.map(n=>"".concat(bwe(n)," ").concat(t,"ms ").concat(r)).join(","),Swe=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(s=>n.includes(s))),mv=(e,t)=>Object.keys(t).reduce((r,n)=>mI(mI({},r),{},{[n]:e(n,t[n])}),{});function pI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ii(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pI(Object(r),!0).forEach(function(n){kwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kwe(e,t,r){return(t=Cwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cwe(e){var t=Twe(e,"string");return typeof t=="symbol"?t:t+""}function Twe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var l_=(e,t,r)=>e+(t-e)*r,zE=e=>{var{from:t,to:r}=e;return t!==r},xW=(e,t,r)=>{var n=mv((s,a)=>{if(zE(a)){var[i,o]=e(a.from,a.to,a.velocity);return ii(ii({},a),{},{from:i,velocity:o})}return a},t);return r<1?mv((s,a)=>zE(a)?ii(ii({},a),{},{velocity:l_(a.velocity,n[s].velocity,r),from:l_(a.from,n[s].from,r)}):a,t):xW(e,n,r-1)};function Ewe(e,t,r,n,s,a){var i,o=n.reduce((g,p)=>ii(ii({},g),{},{[p]:{from:e[p],velocity:0,to:t[p]}}),{}),c=()=>mv((g,p)=>p.from,o),u=()=>!Object.values(o).filter(zE).length,d=null,h=g=>{i||(i=g);var p=g-i,x=p/r.dt;o=xW(r,o,x),s(ii(ii(ii({},e),t),c())),i=g,u()||(d=a.setTimeout(h))};return()=>(d=a.setTimeout(h),()=>{d()})}function Nwe(e,t,r,n,s,a,i){var o=null,c=s.reduce((h,g)=>ii(ii({},h),{},{[g]:[e[g],t[g]]}),{}),u,d=h=>{u||(u=h);var g=(h-u)/n,p=mv((v,w)=>l_(...w,r(g)),c);if(a(ii(ii(ii({},e),t),p)),g<1)o=i.setTimeout(d);else{var x=mv((v,w)=>l_(...w,r(1)),c);a(ii(ii(ii({},e),t),x))}};return()=>(o=i.setTimeout(d),()=>{o()})}const Awe=(e,t,r,n,s,a)=>{var i=Swe(e,t);return r.isStepper===!0?Ewe(e,t,r,i,s,a):Nwe(e,t,r,n,i,s,a)};var c_=1e-4,yW=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],vW=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),xI=(e,t)=>r=>{var n=yW(e,t);return vW(n,r)},jwe=(e,t)=>r=>{var n=yW(e,t),s=[...n.map((a,i)=>a*i).slice(1),0];return vW(s,r)},yI=function(){for(var t,r,n,s,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];if(i.length===1)switch(i[0]){case"linear":[t,n,r,s]=[0,0,1,1];break;case"ease":[t,n,r,s]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,s]=[.42,0,1,1];break;case"ease-out":[t,n,r,s]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,s]=[0,0,.58,1];break;default:{var c=i[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,n,r,s]=c[1].split(")")[0].split(",").map(x=>parseFloat(x)))}}else i.length===4&&([t,n,r,s]=i);var u=xI(t,r),d=xI(n,s),h=jwe(t,r),g=x=>x>1?1:x<0?0:x,p=x=>{for(var v=x>1?1:x,w=v,C=0;C<8;++C){var k=u(w)-v,b=h(w);if(Math.abs(k-v)<c_||b<c_)return d(w);w=g(w-k/b)}return d(w)};return p.isStepper=!1,p},Pwe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:s=17}=t,a=(i,o,c)=>{var u=-(i-o)*r,d=c*n,h=c+(u-d)*s/1e3,g=c*s/1e3+i;return Math.abs(g-o)<c_&&Math.abs(h)<c_?[o,0]:[g,h]};return a.isStepper=!0,a.dt=s,a},Fwe=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return yI(e);case"spring":return Pwe();default:if(e.split("(")[0]==="cubic-bezier")return yI(e)}return typeof e=="function"?e:null};function Owe(e){var t,r=()=>null,n=!1,s=null,a=i=>{if(!n){if(Array.isArray(i)){if(!i.length)return;var o=i,[c,...u]=o;if(typeof c=="number"){s=e.setTimeout(a.bind(null,u),c);return}a(c),s=e.setTimeout(a.bind(null,u));return}typeof i=="string"&&(t=i,r(t)),typeof i=="object"&&(t=i,r(t)),typeof i=="function"&&i()}};return{stop:()=>{n=!0},start:i=>{n=!1,s&&(s(),s=null),a(i)},subscribe:i=>(r=i,()=>{r=()=>null}),getTimeoutController:()=>e}}class Dwe{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),s=null,a=i=>{i-n>=r?t(i):typeof requestAnimationFrame=="function"&&(s=requestAnimationFrame(a))};return s=requestAnimationFrame(a),()=>{cancelAnimationFrame(s)}}}function Iwe(){return Owe(new Dwe)}var Rwe=S.createContext(Iwe);function Mwe(e,t){var r=S.useContext(Rwe);return S.useMemo(()=>t??r(e),[e,t,r])}var Lwe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},vI={t:0},FC={t:1};function wW(e){var t=Rl(e,Lwe),{isActive:r,canBegin:n,duration:s,easing:a,begin:i,onAnimationEnd:o,onAnimationStart:c,children:u}=t,d=Mwe(t.animationId,t.animationManager),[h,g]=S.useState(r?vI:FC),p=S.useRef(null);return S.useEffect(()=>{r||g(FC)},[r]),S.useEffect(()=>{if(!r||!n)return xwe;var x=Awe(vI,FC,Fwe(a),s,g,d.getTimeoutController()),v=()=>{p.current=x()};return d.start([c,i,v,s,o]),()=>{d.stop(),p.current&&p.current(),o()}},[r,n,s,a,i,c,o,d]),u(h.t)}function bW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=S.useRef(fv(t)),n=S.useRef(e);return n.current!==e&&(r.current=fv(t),n.current=e),r.current}function wI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function bI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wI(Object(r),!0).forEach(function(n){Bwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bwe(e,t,r){return(t=$we(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $we(e){var t=Uwe(e,"string");return typeof t=="symbol"?t:t+""}function Uwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function u_(){return u_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u_.apply(null,arguments)}var _I=(e,t,r,n,s)=>{var a=Math.min(Math.abs(r)/2,Math.abs(n)/2),i=n>=0?1:-1,o=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0,u;if(a>0&&s instanceof Array){for(var d=[0,0,0,0],h=0,g=4;h<g;h++)d[h]=s[h]>a?a:s[h];u="M".concat(e,",").concat(t+i*d[0]),d[0]>0&&(u+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+o*d[0],",").concat(t)),u+="L ".concat(e+r-o*d[1],",").concat(t),d[1]>0&&(u+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+i*d[1])),u+="L ".concat(e+r,",").concat(t+n-i*d[2]),d[2]>0&&(u+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(e+r-o*d[2],",").concat(t+n)),u+="L ".concat(e+o*d[3],",").concat(t+n),d[3]>0&&(u+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+n-i*d[3])),u+="Z"}else if(a>0&&s===+s&&s>0){var p=Math.min(a,s);u="M ".concat(e,",").concat(t+i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+o*p,",").concat(t,`
            L `).concat(e+r-o*p,",").concat(t,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+r,",").concat(t+i*p,`
            L `).concat(e+r,",").concat(t+n-i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+r-o*p,",").concat(t+n,`
            L `).concat(e+o*p,",").concat(t+n,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e,",").concat(t+n-i*p," Z")}else u="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return u},zwe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Wwe=e=>{var t=Rl(e,zwe),r=S.useRef(null),[n,s]=S.useState(-1);S.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var ae=r.current.getTotalLength();ae&&s(ae)}catch{}},[]);var{x:a,y:i,width:o,height:c,radius:u,className:d}=t,{animationEasing:h,animationDuration:g,animationBegin:p,isAnimationActive:x,isUpdateAnimationActive:v}=t,w=S.useRef(o),C=S.useRef(c),k=S.useRef(a),b=S.useRef(i),N=S.useMemo(()=>({x:a,y:i,width:o,height:c,radius:u}),[a,i,o,c,u]),E=bW(N,"rectangle-");if(a!==+a||i!==+i||o!==+o||c!==+c||o===0||c===0)return null;var P=ls("recharts-rectangle",d);if(!v)return S.createElement("path",u_({},gi(t,!0),{className:P,d:_I(a,i,o,c,u)}));var F=w.current,A=C.current,j=k.current,I=b.current,B="0px ".concat(n===-1?1:n,"px"),Y="".concat(n,"px 0px"),Z=_we(["strokeDasharray"],g,typeof h=="string"?h:void 0);return S.createElement(wW,{animationId:E,key:E,canBegin:n>0,duration:g,easing:h,isActive:v,begin:p},ae=>{var ee=Bu(F,o,ae),ne=Bu(A,c,ae),L=Bu(j,a,ae),H=Bu(I,i,ae);r.current&&(w.current=ee,C.current=ne,k.current=L,b.current=H);var M;return x?ae>0?M={transition:Z,strokeDasharray:Y}:M={strokeDasharray:B}:M={strokeDasharray:Y},S.createElement("path",u_({},gi(t,!0),{className:P,d:_I(L,H,ee,ne,u),ref:r,style:bI(bI({},M),t.style)}))})};function _W(e){var{cx:t,cy:r,radius:n,startAngle:s,endAngle:a}=e,i=di(t,r,n,s),o=di(t,r,n,a);return{points:[i,o],cx:t,cy:r,radius:n,startAngle:s,endAngle:a}}function WE(){return WE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},WE.apply(null,arguments)}var Hwe=(e,t)=>{var r=Sl(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},Hw=e=>{var{cx:t,cy:r,radius:n,angle:s,sign:a,isExternal:i,cornerRadius:o,cornerIsExternal:c}=e,u=o*(i?1:-1)+n,d=Math.asin(o/u)/i_,h=c?s:s+a*d,g=di(t,r,u,h),p=di(t,r,n,h),x=c?s-a*d:s,v=di(t,r,u*Math.cos(d*i_),x);return{center:g,circleTangency:p,lineTangency:v,theta:d}},SW=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:s,startAngle:a,endAngle:i}=e,o=Hwe(a,i),c=a+o,u=di(t,r,s,a),d=di(t,r,s,c),h="M ".concat(u.x,",").concat(u.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(a>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(n>0){var g=di(t,r,n,a),p=di(t,r,n,c);h+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(a<=c),`,
            `).concat(g.x,",").concat(g.y," Z")}else h+="L ".concat(t,",").concat(r," Z");return h},Gwe=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:s,cornerRadius:a,forceCornerRadius:i,cornerIsExternal:o,startAngle:c,endAngle:u}=e,d=Sl(u-c),{circleTangency:h,lineTangency:g,theta:p}=Hw({cx:t,cy:r,radius:s,angle:c,sign:d,cornerRadius:a,cornerIsExternal:o}),{circleTangency:x,lineTangency:v,theta:w}=Hw({cx:t,cy:r,radius:s,angle:u,sign:-d,cornerRadius:a,cornerIsExternal:o}),C=o?Math.abs(c-u):Math.abs(c-u)-p-w;if(C<0)return i?"M ".concat(g.x,",").concat(g.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):SW({cx:t,cy:r,innerRadius:n,outerRadius:s,startAngle:c,endAngle:u});var k="M ".concat(g.x,",").concat(g.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(C>180),",").concat(+(d<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(v.x,",").concat(v.y,`
  `);if(n>0){var{circleTangency:b,lineTangency:N,theta:E}=Hw({cx:t,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),{circleTangency:P,lineTangency:F,theta:A}=Hw({cx:t,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),j=o?Math.abs(c-u):Math.abs(c-u)-E-A;if(j<0&&a===0)return"".concat(k,"L").concat(t,",").concat(r,"Z");k+="L".concat(F.x,",").concat(F.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(P.x,",").concat(P.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(j>180),",").concat(+(d>0),",").concat(b.x,",").concat(b.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(N.x,",").concat(N.y,"Z")}else k+="L".concat(t,",").concat(r,"Z");return k},Vwe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Kwe=e=>{var t=Rl(e,Vwe),{cx:r,cy:n,innerRadius:s,outerRadius:a,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d,className:h}=t;if(a<s||u===d)return null;var g=ls("recharts-sector",h),p=a-s,x=jf(i,p,0,!0),v;return x>0&&Math.abs(u-d)<360?v=Gwe({cx:r,cy:n,innerRadius:s,outerRadius:a,cornerRadius:Math.min(x,p/2),forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d}):v=SW({cx:r,cy:n,innerRadius:s,outerRadius:a,startAngle:u,endAngle:d}),S.createElement("path",WE({},gi(t,!0),{className:g,d:v}))};function qwe(e,t,r){var n,s,a,i;if(e==="horizontal")n=t.x,a=n,s=r.top,i=r.top+r.height;else if(e==="vertical")s=t.y,i=s,n=r.left,a=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:o,cy:c,innerRadius:u,outerRadius:d,angle:h}=t,g=di(o,c,u,h),p=di(o,c,d,h);n=g.x,s=g.y,a=p.x,i=p.y}else return _W(t);return[{x:n,y:s},{x:a,y:i}]}var OC={},DC={},IC={},SI;function Ywe(){return SI||(SI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fz();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(IC)),IC}var kI;function Xwe(){return kI||(kI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ywe();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(DC)),DC}var CI;function Qwe(){return CI||(CI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Oz(),r=Xwe();function n(s,a,i){i&&typeof i!="number"&&t.isIterateeCall(s,a,i)&&(a=i=void 0),s=r.toFinite(s),a===void 0?(a=s,s=0):a=r.toFinite(a),i=i===void 0?s<a?1:-1:r.toFinite(i);const o=Math.max(Math.ceil((a-s)/(i||1)),0),c=new Array(o);for(let u=0;u<o;u++)c[u]=s,s+=i;return c}e.range=n})(OC)),OC}var RC,TI;function Jwe(){return TI||(TI=1,RC=Qwe().range),RC}var Zwe=Jwe();const kW=Ol(Zwe);function bf(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ebe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Z3(e){let t,r,n;e.length!==2?(t=bf,r=(o,c)=>bf(e(o),c),n=(o,c)=>e(o)-c):(t=e===bf||e===ebe?e:tbe,r=e,n=e);function s(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const h=u+d>>>1;r(o[h],c)<0?u=h+1:d=h}while(u<d)}return u}function a(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const h=u+d>>>1;r(o[h],c)<=0?u=h+1:d=h}while(u<d)}return u}function i(o,c,u=0,d=o.length){const h=s(o,c,u,d-1);return h>u&&n(o[h-1],c)>-n(o[h],c)?h-1:h}return{left:s,center:i,right:a}}function tbe(){return 0}function CW(e){return e===null?NaN:+e}function*rbe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const nbe=Z3(bf),t1=nbe.right;Z3(CW).center;class EI extends Map{constructor(t,r=ibe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,s]of t)this.set(n,s)}get(t){return super.get(NI(this,t))}has(t){return super.has(NI(this,t))}set(t,r){return super.set(sbe(this,t),r)}delete(t){return super.delete(abe(this,t))}}function NI({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function sbe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function abe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function ibe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function obe(e=bf){if(e===bf)return TW;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function TW(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const lbe=Math.sqrt(50),cbe=Math.sqrt(10),ube=Math.sqrt(2);function d_(e,t,r){const n=(t-e)/Math.max(0,r),s=Math.floor(Math.log10(n)),a=n/Math.pow(10,s),i=a>=lbe?10:a>=cbe?5:a>=ube?2:1;let o,c,u;return s<0?(u=Math.pow(10,-s)/i,o=Math.round(e*u),c=Math.round(t*u),o/u<e&&++o,c/u>t&&--c,u=-u):(u=Math.pow(10,s)*i,o=Math.round(e/u),c=Math.round(t/u),o*u<e&&++o,c*u>t&&--c),c<o&&.5<=r&&r<2?d_(e,t,r*2):[o,c,u]}function HE(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[s,a,i]=n?d_(t,e,r):d_(e,t,r);if(!(a>=s))return[];const o=a-s+1,c=new Array(o);if(n)if(i<0)for(let u=0;u<o;++u)c[u]=(a-u)/-i;else for(let u=0;u<o;++u)c[u]=(a-u)*i;else if(i<0)for(let u=0;u<o;++u)c[u]=(s+u)/-i;else for(let u=0;u<o;++u)c[u]=(s+u)*i;return c}function GE(e,t,r){return t=+t,e=+e,r=+r,d_(e,t,r)[2]}function VE(e,t,r){t=+t,e=+e,r=+r;const n=t<e,s=n?GE(t,e,r):GE(e,t,r);return(n?-1:1)*(s<0?1/-s:s)}function AI(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function jI(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function EW(e,t,r=0,n=1/0,s){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(s=s===void 0?TW:obe(s);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),h=.5*Math.exp(2*d/3),g=.5*Math.sqrt(d*h*(c-h)/c)*(u-c/2<0?-1:1),p=Math.max(r,Math.floor(t-u*h/c+g)),x=Math.min(n,Math.floor(t+(c-u)*h/c+g));EW(e,t,p,x,s)}const a=e[t];let i=r,o=n;for(ty(e,r,t),s(e[n],a)>0&&ty(e,r,n);i<o;){for(ty(e,i,o),++i,--o;s(e[i],a)<0;)++i;for(;s(e[o],a)>0;)--o}s(e[r],a)===0?ty(e,r,o):(++o,ty(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function ty(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function dbe(e,t,r){if(e=Float64Array.from(rbe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return jI(e);if(t>=1)return AI(e);var n,s=(n-1)*t,a=Math.floor(s),i=AI(EW(e,a).subarray(0,a+1)),o=jI(e.subarray(a+1));return i+(o-i)*(s-a)}}function fbe(e,t,r=CW){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,s=(n-1)*t,a=Math.floor(s),i=+r(e[a],a,e),o=+r(e[a+1],a+1,e);return i+(o-i)*(s-a)}}function hbe(e,t,r){e=+e,t=+t,r=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+r;for(var n=-1,s=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(s);++n<s;)a[n]=e+n*r;return a}function Ml(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function md(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const KE=Symbol("implicit");function eA(){var e=new EI,t=[],r=[],n=KE;function s(a){let i=e.get(a);if(i===void 0){if(n!==KE)return n;e.set(a,i=t.push(a)-1)}return r[i%r.length]}return s.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new EI;for(const i of a)e.has(i)||e.set(i,t.push(i)-1);return s},s.range=function(a){return arguments.length?(r=Array.from(a),s):r.slice()},s.unknown=function(a){return arguments.length?(n=a,s):n},s.copy=function(){return eA(t,r).unknown(n)},Ml.apply(s,arguments),s}function tA(){var e=eA().unknown(void 0),t=e.domain,r=e.range,n=0,s=1,a,i,o=!1,c=0,u=0,d=.5;delete e.unknown;function h(){var g=t().length,p=s<n,x=p?s:n,v=p?n:s;a=(v-x)/Math.max(1,g-c+u*2),o&&(a=Math.floor(a)),x+=(v-x-a*(g-c))*d,i=a*(1-c),o&&(x=Math.round(x),i=Math.round(i));var w=hbe(g).map(function(C){return x+a*C});return r(p?w.reverse():w)}return e.domain=function(g){return arguments.length?(t(g),h()):t()},e.range=function(g){return arguments.length?([n,s]=g,n=+n,s=+s,h()):[n,s]},e.rangeRound=function(g){return[n,s]=g,n=+n,s=+s,o=!0,h()},e.bandwidth=function(){return i},e.step=function(){return a},e.round=function(g){return arguments.length?(o=!!g,h()):o},e.padding=function(g){return arguments.length?(c=Math.min(1,u=+g),h()):c},e.paddingInner=function(g){return arguments.length?(c=Math.min(1,g),h()):c},e.paddingOuter=function(g){return arguments.length?(u=+g,h()):u},e.align=function(g){return arguments.length?(d=Math.max(0,Math.min(1,g)),h()):d},e.copy=function(){return tA(t(),[n,s]).round(o).paddingInner(c).paddingOuter(u).align(d)},Ml.apply(h(),arguments)}function NW(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return NW(t())},e}function gbe(){return NW(tA.apply(null,arguments).paddingInner(1))}function rA(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function AW(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function r1(){}var pv=.7,f_=1/pv,mm="\\s*([+-]?\\d+)\\s*",xv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Xc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mbe=/^#([0-9a-f]{3,8})$/,pbe=new RegExp(`^rgb\\(${mm},${mm},${mm}\\)$`),xbe=new RegExp(`^rgb\\(${Xc},${Xc},${Xc}\\)$`),ybe=new RegExp(`^rgba\\(${mm},${mm},${mm},${xv}\\)$`),vbe=new RegExp(`^rgba\\(${Xc},${Xc},${Xc},${xv}\\)$`),wbe=new RegExp(`^hsl\\(${xv},${Xc},${Xc}\\)$`),bbe=new RegExp(`^hsla\\(${xv},${Xc},${Xc},${xv}\\)$`),PI={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};rA(r1,yv,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:FI,formatHex:FI,formatHex8:_be,formatHsl:Sbe,formatRgb:OI,toString:OI});function FI(){return this.rgb().formatHex()}function _be(){return this.rgb().formatHex8()}function Sbe(){return jW(this).formatHsl()}function OI(){return this.rgb().formatRgb()}function yv(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=mbe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?DI(t):r===3?new _o(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Gw(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Gw(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=pbe.exec(e))?new _o(t[1],t[2],t[3],1):(t=xbe.exec(e))?new _o(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=ybe.exec(e))?Gw(t[1],t[2],t[3],t[4]):(t=vbe.exec(e))?Gw(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=wbe.exec(e))?MI(t[1],t[2]/100,t[3]/100,1):(t=bbe.exec(e))?MI(t[1],t[2]/100,t[3]/100,t[4]):PI.hasOwnProperty(e)?DI(PI[e]):e==="transparent"?new _o(NaN,NaN,NaN,0):null}function DI(e){return new _o(e>>16&255,e>>8&255,e&255,1)}function Gw(e,t,r,n){return n<=0&&(e=t=r=NaN),new _o(e,t,r,n)}function kbe(e){return e instanceof r1||(e=yv(e)),e?(e=e.rgb(),new _o(e.r,e.g,e.b,e.opacity)):new _o}function qE(e,t,r,n){return arguments.length===1?kbe(e):new _o(e,t,r,n??1)}function _o(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}rA(_o,qE,AW(r1,{brighter(e){return e=e==null?f_:Math.pow(f_,e),new _o(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?pv:Math.pow(pv,e),new _o(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new _o(Qh(this.r),Qh(this.g),Qh(this.b),h_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:II,formatHex:II,formatHex8:Cbe,formatRgb:RI,toString:RI}));function II(){return`#${Rh(this.r)}${Rh(this.g)}${Rh(this.b)}`}function Cbe(){return`#${Rh(this.r)}${Rh(this.g)}${Rh(this.b)}${Rh((isNaN(this.opacity)?1:this.opacity)*255)}`}function RI(){const e=h_(this.opacity);return`${e===1?"rgb(":"rgba("}${Qh(this.r)}, ${Qh(this.g)}, ${Qh(this.b)}${e===1?")":`, ${e})`}`}function h_(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Qh(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Rh(e){return e=Qh(e),(e<16?"0":"")+e.toString(16)}function MI(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new nc(e,t,r,n)}function jW(e){if(e instanceof nc)return new nc(e.h,e.s,e.l,e.opacity);if(e instanceof r1||(e=yv(e)),!e)return new nc;if(e instanceof nc)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,s=Math.min(t,r,n),a=Math.max(t,r,n),i=NaN,o=a-s,c=(a+s)/2;return o?(t===a?i=(r-n)/o+(r<n)*6:r===a?i=(n-t)/o+2:i=(t-r)/o+4,o/=c<.5?a+s:2-a-s,i*=60):o=c>0&&c<1?0:i,new nc(i,o,c,e.opacity)}function Tbe(e,t,r,n){return arguments.length===1?jW(e):new nc(e,t,r,n??1)}function nc(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}rA(nc,Tbe,AW(r1,{brighter(e){return e=e==null?f_:Math.pow(f_,e),new nc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?pv:Math.pow(pv,e),new nc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,s=2*r-n;return new _o(MC(e>=240?e-240:e+120,s,n),MC(e,s,n),MC(e<120?e+240:e-120,s,n),this.opacity)},clamp(){return new nc(LI(this.h),Vw(this.s),Vw(this.l),h_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=h_(this.opacity);return`${e===1?"hsl(":"hsla("}${LI(this.h)}, ${Vw(this.s)*100}%, ${Vw(this.l)*100}%${e===1?")":`, ${e})`}`}}));function LI(e){return e=(e||0)%360,e<0?e+360:e}function Vw(e){return Math.max(0,Math.min(1,e||0))}function MC(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const nA=e=>()=>e;function Ebe(e,t){return function(r){return e+r*t}}function Nbe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function Abe(e){return(e=+e)==1?PW:function(t,r){return r-t?Nbe(t,r,e):nA(isNaN(t)?r:t)}}function PW(e,t){var r=t-e;return r?Ebe(e,r):nA(isNaN(e)?t:e)}const BI=(function e(t){var r=Abe(t);function n(s,a){var i=r((s=qE(s)).r,(a=qE(a)).r),o=r(s.g,a.g),c=r(s.b,a.b),u=PW(s.opacity,a.opacity);return function(d){return s.r=i(d),s.g=o(d),s.b=c(d),s.opacity=u(d),s+""}}return n.gamma=e,n})(1);function jbe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),s;return function(a){for(s=0;s<r;++s)n[s]=e[s]*(1-a)+t[s]*a;return n}}function Pbe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Fbe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,s=new Array(n),a=new Array(r),i;for(i=0;i<n;++i)s[i]=sp(e[i],t[i]);for(;i<r;++i)a[i]=t[i];return function(o){for(i=0;i<n;++i)a[i]=s[i](o);return a}}function Obe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function g_(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Dbe(e,t){var r={},n={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?r[s]=sp(e[s],t[s]):n[s]=t[s];return function(a){for(s in r)n[s]=r[s](a);return n}}var YE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,LC=new RegExp(YE.source,"g");function Ibe(e){return function(){return e}}function Rbe(e){return function(t){return e(t)+""}}function Mbe(e,t){var r=YE.lastIndex=LC.lastIndex=0,n,s,a,i=-1,o=[],c=[];for(e=e+"",t=t+"";(n=YE.exec(e))&&(s=LC.exec(t));)(a=s.index)>r&&(a=t.slice(r,a),o[i]?o[i]+=a:o[++i]=a),(n=n[0])===(s=s[0])?o[i]?o[i]+=s:o[++i]=s:(o[++i]=null,c.push({i,x:g_(n,s)})),r=LC.lastIndex;return r<t.length&&(a=t.slice(r),o[i]?o[i]+=a:o[++i]=a),o.length<2?c[0]?Rbe(c[0].x):Ibe(t):(t=c.length,function(u){for(var d=0,h;d<t;++d)o[(h=c[d]).i]=h.x(u);return o.join("")})}function sp(e,t){var r=typeof t,n;return t==null||r==="boolean"?nA(t):(r==="number"?g_:r==="string"?(n=yv(t))?(t=n,BI):Mbe:t instanceof yv?BI:t instanceof Date?Obe:Pbe(t)?jbe:Array.isArray(t)?Fbe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Dbe:g_)(e,t)}function sA(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Lbe(e,t){t===void 0&&(t=e,e=sp);for(var r=0,n=t.length-1,s=t[0],a=new Array(n<0?0:n);r<n;)a[r]=e(s,s=t[++r]);return function(i){var o=Math.max(0,Math.min(n-1,Math.floor(i*=n)));return a[o](i-o)}}function Bbe(e){return function(){return e}}function m_(e){return+e}var $I=[0,1];function to(e){return e}function XE(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:Bbe(isNaN(t)?NaN:.5)}function $be(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function Ube(e,t,r){var n=e[0],s=e[1],a=t[0],i=t[1];return s<n?(n=XE(s,n),a=r(i,a)):(n=XE(n,s),a=r(a,i)),function(o){return a(n(o))}}function zbe(e,t,r){var n=Math.min(e.length,t.length)-1,s=new Array(n),a=new Array(n),i=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<n;)s[i]=XE(e[i],e[i+1]),a[i]=r(t[i],t[i+1]);return function(o){var c=t1(e,o,1,n)-1;return a[c](s[c](o))}}function n1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function T2(){var e=$I,t=$I,r=sp,n,s,a,i=to,o,c,u;function d(){var g=Math.min(e.length,t.length);return i!==to&&(i=$be(e[0],e[g-1])),o=g>2?zbe:Ube,c=u=null,h}function h(g){return g==null||isNaN(g=+g)?a:(c||(c=o(e.map(n),t,r)))(n(i(g)))}return h.invert=function(g){return i(s((u||(u=o(t,e.map(n),g_)))(g)))},h.domain=function(g){return arguments.length?(e=Array.from(g,m_),d()):e.slice()},h.range=function(g){return arguments.length?(t=Array.from(g),d()):t.slice()},h.rangeRound=function(g){return t=Array.from(g),r=sA,d()},h.clamp=function(g){return arguments.length?(i=g?!0:to,d()):i!==to},h.interpolate=function(g){return arguments.length?(r=g,d()):r},h.unknown=function(g){return arguments.length?(a=g,h):a},function(g,p){return n=g,s=p,d()}}function aA(){return T2()(to,to)}function Wbe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function p_(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function jm(e){return e=p_(Math.abs(e)),e?e[1]:NaN}function Hbe(e,t){return function(r,n){for(var s=r.length,a=[],i=0,o=e[0],c=0;s>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),a.push(r.substring(s-=o,s+o)),!((c+=o+1)>n));)o=e[i=(i+1)%e.length];return a.reverse().join(t)}}function Gbe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var Vbe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function vv(e){if(!(t=Vbe.exec(e)))throw new Error("invalid format: "+e);var t;return new iA({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}vv.prototype=iA.prototype;function iA(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}iA.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Kbe(e){e:for(var t=e.length,r=1,n=-1,s;r<t;++r)switch(e[r]){case".":n=s=r;break;case"0":n===0&&(n=r),s=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(s+1):e}var FW;function qbe(e,t){var r=p_(e,t);if(!r)return e+"";var n=r[0],s=r[1],a=s-(FW=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,i=n.length;return a===i?n:a>i?n+new Array(a-i+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+p_(e,Math.max(0,t+a-1))[0]}function UI(e,t){var r=p_(e,t);if(!r)return e+"";var n=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+n:n.length>s+1?n.slice(0,s+1)+"."+n.slice(s+1):n+new Array(s-n.length+2).join("0")}const zI={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Wbe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>UI(e*100,t),r:UI,s:qbe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function WI(e){return e}var HI=Array.prototype.map,GI=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Ybe(e){var t=e.grouping===void 0||e.thousands===void 0?WI:Hbe(HI.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?WI:Gbe(HI.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(h){h=vv(h);var g=h.fill,p=h.align,x=h.sign,v=h.symbol,w=h.zero,C=h.width,k=h.comma,b=h.precision,N=h.trim,E=h.type;E==="n"?(k=!0,E="g"):zI[E]||(b===void 0&&(b=12),N=!0,E="g"),(w||g==="0"&&p==="=")&&(w=!0,g="0",p="=");var P=v==="$"?r:v==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():"",F=v==="$"?n:/[%p]/.test(E)?i:"",A=zI[E],j=/[defgprs%]/.test(E);b=b===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function I(B){var Y=P,Z=F,ae,ee,ne;if(E==="c")Z=A(B)+Z,B="";else{B=+B;var L=B<0||1/B<0;if(B=isNaN(B)?c:A(Math.abs(B),b),N&&(B=Kbe(B)),L&&+B==0&&x!=="+"&&(L=!1),Y=(L?x==="("?x:o:x==="-"||x==="("?"":x)+Y,Z=(E==="s"?GI[8+FW/3]:"")+Z+(L&&x==="("?")":""),j){for(ae=-1,ee=B.length;++ae<ee;)if(ne=B.charCodeAt(ae),48>ne||ne>57){Z=(ne===46?s+B.slice(ae+1):B.slice(ae))+Z,B=B.slice(0,ae);break}}}k&&!w&&(B=t(B,1/0));var H=Y.length+B.length+Z.length,M=H<C?new Array(C-H+1).join(g):"";switch(k&&w&&(B=t(M+B,M.length?C-Z.length:1/0),M=""),p){case"<":B=Y+B+Z+M;break;case"=":B=Y+M+B+Z;break;case"^":B=M.slice(0,H=M.length>>1)+Y+B+Z+M.slice(H);break;default:B=M+Y+B+Z;break}return a(B)}return I.toString=function(){return h+""},I}function d(h,g){var p=u((h=vv(h),h.type="f",h)),x=Math.max(-8,Math.min(8,Math.floor(jm(g)/3)))*3,v=Math.pow(10,-x),w=GI[8+x/3];return function(C){return p(v*C)+w}}return{format:u,formatPrefix:d}}var Kw,oA,OW;Xbe({thousands:",",grouping:[3],currency:["$",""]});function Xbe(e){return Kw=Ybe(e),oA=Kw.format,OW=Kw.formatPrefix,Kw}function Qbe(e){return Math.max(0,-jm(Math.abs(e)))}function Jbe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(jm(t)/3)))*3-jm(Math.abs(e)))}function Zbe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,jm(t)-jm(e))+1}function DW(e,t,r,n){var s=VE(e,t,r),a;switch(n=vv(n??",f"),n.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=Jbe(s,i))&&(n.precision=a),OW(n,i)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=Zbe(s,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=Qbe(s))&&(n.precision=a-(n.type==="%")*2);break}}return oA(n)}function zf(e){var t=e.domain;return e.ticks=function(r){var n=t();return HE(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var s=t();return DW(s[0],s[s.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),s=0,a=n.length-1,i=n[s],o=n[a],c,u,d=10;for(o<i&&(u=i,i=o,o=u,u=s,s=a,a=u);d-- >0;){if(u=GE(i,o,r),u===c)return n[s]=i,n[a]=o,t(n);if(u>0)i=Math.floor(i/u)*u,o=Math.ceil(o/u)*u;else if(u<0)i=Math.ceil(i*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function IW(){var e=aA();return e.copy=function(){return n1(e,IW())},Ml.apply(e,arguments),zf(e)}function RW(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,m_),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return RW(e).unknown(t)},e=arguments.length?Array.from(e,m_):[0,1],zf(r)}function MW(e,t){e=e.slice();var r=0,n=e.length-1,s=e[r],a=e[n],i;return a<s&&(i=r,r=n,n=i,i=s,s=a,a=i),e[r]=t.floor(s),e[n]=t.ceil(a),e}function VI(e){return Math.log(e)}function KI(e){return Math.exp(e)}function e_e(e){return-Math.log(-e)}function t_e(e){return-Math.exp(-e)}function r_e(e){return isFinite(e)?+("1e"+e):e<0?0:e}function n_e(e){return e===10?r_e:e===Math.E?Math.exp:t=>Math.pow(e,t)}function s_e(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function qI(e){return(t,r)=>-e(-t,r)}function lA(e){const t=e(VI,KI),r=t.domain;let n=10,s,a;function i(){return s=s_e(n),a=n_e(n),r()[0]<0?(s=qI(s),a=qI(a),e(e_e,t_e)):e(VI,KI),t}return t.base=function(o){return arguments.length?(n=+o,i()):n},t.domain=function(o){return arguments.length?(r(o),i()):r()},t.ticks=o=>{const c=r();let u=c[0],d=c[c.length-1];const h=d<u;h&&([u,d]=[d,u]);let g=s(u),p=s(d),x,v;const w=o==null?10:+o;let C=[];if(!(n%1)&&p-g<w){if(g=Math.floor(g),p=Math.ceil(p),u>0){for(;g<=p;++g)for(x=1;x<n;++x)if(v=g<0?x/a(-g):x*a(g),!(v<u)){if(v>d)break;C.push(v)}}else for(;g<=p;++g)for(x=n-1;x>=1;--x)if(v=g>0?x/a(-g):x*a(g),!(v<u)){if(v>d)break;C.push(v)}C.length*2<w&&(C=HE(u,d,w))}else C=HE(g,p,Math.min(p-g,w)).map(a);return h?C.reverse():C},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=vv(c)).precision==null&&(c.trim=!0),c=oA(c)),o===1/0)return c;const u=Math.max(1,n*o/t.ticks().length);return d=>{let h=d/a(Math.round(s(d)));return h*n<n-.5&&(h*=n),h<=u?c(d):""}},t.nice=()=>r(MW(r(),{floor:o=>a(Math.floor(s(o))),ceil:o=>a(Math.ceil(s(o)))})),t}function LW(){const e=lA(T2()).domain([1,10]);return e.copy=()=>n1(e,LW()).base(e.base()),Ml.apply(e,arguments),e}function YI(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function XI(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function cA(e){var t=1,r=e(YI(t),XI(t));return r.constant=function(n){return arguments.length?e(YI(t=+n),XI(t)):t},zf(r)}function BW(){var e=cA(T2());return e.copy=function(){return n1(e,BW()).constant(e.constant())},Ml.apply(e,arguments)}function QI(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function a_e(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function i_e(e){return e<0?-e*e:e*e}function uA(e){var t=e(to,to),r=1;function n(){return r===1?e(to,to):r===.5?e(a_e,i_e):e(QI(r),QI(1/r))}return t.exponent=function(s){return arguments.length?(r=+s,n()):r},zf(t)}function dA(){var e=uA(T2());return e.copy=function(){return n1(e,dA()).exponent(e.exponent())},Ml.apply(e,arguments),e}function o_e(){return dA.apply(null,arguments).exponent(.5)}function JI(e){return Math.sign(e)*e*e}function l_e(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function $W(){var e=aA(),t=[0,1],r=!1,n;function s(a){var i=l_e(e(a));return isNaN(i)?n:r?Math.round(i):i}return s.invert=function(a){return e.invert(JI(a))},s.domain=function(a){return arguments.length?(e.domain(a),s):e.domain()},s.range=function(a){return arguments.length?(e.range((t=Array.from(a,m_)).map(JI)),s):t.slice()},s.rangeRound=function(a){return s.range(a).round(!0)},s.round=function(a){return arguments.length?(r=!!a,s):r},s.clamp=function(a){return arguments.length?(e.clamp(a),s):e.clamp()},s.unknown=function(a){return arguments.length?(n=a,s):n},s.copy=function(){return $W(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Ml.apply(s,arguments),zf(s)}function UW(){var e=[],t=[],r=[],n;function s(){var i=0,o=Math.max(1,t.length);for(r=new Array(o-1);++i<o;)r[i-1]=fbe(e,i/o);return a}function a(i){return i==null||isNaN(i=+i)?n:t[t1(r,i)]}return a.invertExtent=function(i){var o=t.indexOf(i);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},a.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let o of i)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(bf),s()},a.range=function(i){return arguments.length?(t=Array.from(i),s()):t.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return UW().domain(e).range(t).unknown(n)},Ml.apply(a,arguments)}function zW(){var e=0,t=1,r=1,n=[.5],s=[0,1],a;function i(c){return c!=null&&c<=c?s[t1(n,c,0,r)]:a}function o(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},i.range=function(c){return arguments.length?(r=(s=Array.from(c)).length-1,o()):s.slice()},i.invertExtent=function(c){var u=s.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},i.unknown=function(c){return arguments.length&&(a=c),i},i.thresholds=function(){return n.slice()},i.copy=function(){return zW().domain([e,t]).range(s).unknown(a)},Ml.apply(zf(i),arguments)}function WW(){var e=[.5],t=[0,1],r,n=1;function s(a){return a!=null&&a<=a?t[t1(e,a,0,n)]:r}return s.domain=function(a){return arguments.length?(e=Array.from(a),n=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(a){return arguments.length?(t=Array.from(a),n=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(a){var i=t.indexOf(a);return[e[i-1],e[i]]},s.unknown=function(a){return arguments.length?(r=a,s):r},s.copy=function(){return WW().domain(e).range(t).unknown(r)},Ml.apply(s,arguments)}const BC=new Date,$C=new Date;function ka(e,t,r,n){function s(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return s.floor=a=>(e(a=new Date(+a)),a),s.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),s.round=a=>{const i=s(a),o=s.ceil(a);return a-i<o-a?i:o},s.offset=(a,i)=>(t(a=new Date(+a),i==null?1:Math.floor(i)),a),s.range=(a,i,o)=>{const c=[];if(a=s.ceil(a),o=o==null?1:Math.floor(o),!(a<i)||!(o>0))return c;let u;do c.push(u=new Date(+a)),t(a,o),e(a);while(u<a&&a<i);return c},s.filter=a=>ka(i=>{if(i>=i)for(;e(i),!a(i);)i.setTime(i-1)},(i,o)=>{if(i>=i)if(o<0)for(;++o<=0;)for(;t(i,-1),!a(i););else for(;--o>=0;)for(;t(i,1),!a(i););}),r&&(s.count=(a,i)=>(BC.setTime(+a),$C.setTime(+i),e(BC),e($C),Math.floor(r(BC,$C))),s.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?s.filter(n?i=>n(i)%a===0:i=>s.count(0,i)%a===0):s)),s}const x_=ka(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);x_.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ka(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):x_);x_.range;const Hu=1e3,kl=Hu*60,Gu=kl*60,ad=Gu*24,fA=ad*7,ZI=ad*30,UC=ad*365,Mh=ka(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Hu)},(e,t)=>(t-e)/Hu,e=>e.getUTCSeconds());Mh.range;const hA=ka(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Hu)},(e,t)=>{e.setTime(+e+t*kl)},(e,t)=>(t-e)/kl,e=>e.getMinutes());hA.range;const gA=ka(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*kl)},(e,t)=>(t-e)/kl,e=>e.getUTCMinutes());gA.range;const mA=ka(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Hu-e.getMinutes()*kl)},(e,t)=>{e.setTime(+e+t*Gu)},(e,t)=>(t-e)/Gu,e=>e.getHours());mA.range;const pA=ka(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Gu)},(e,t)=>(t-e)/Gu,e=>e.getUTCHours());pA.range;const s1=ka(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*kl)/ad,e=>e.getDate()-1);s1.range;const E2=ka(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ad,e=>e.getUTCDate()-1);E2.range;const HW=ka(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ad,e=>Math.floor(e/ad));HW.range;function R0(e){return ka(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*kl)/fA)}const N2=R0(0),y_=R0(1),c_e=R0(2),u_e=R0(3),Pm=R0(4),d_e=R0(5),f_e=R0(6);N2.range;y_.range;c_e.range;u_e.range;Pm.range;d_e.range;f_e.range;function M0(e){return ka(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/fA)}const A2=M0(0),v_=M0(1),h_e=M0(2),g_e=M0(3),Fm=M0(4),m_e=M0(5),p_e=M0(6);A2.range;v_.range;h_e.range;g_e.range;Fm.range;m_e.range;p_e.range;const xA=ka(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());xA.range;const yA=ka(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());yA.range;const id=ka(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());id.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ka(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});id.range;const od=ka(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());od.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ka(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});od.range;function GW(e,t,r,n,s,a){const i=[[Mh,1,Hu],[Mh,5,5*Hu],[Mh,15,15*Hu],[Mh,30,30*Hu],[a,1,kl],[a,5,5*kl],[a,15,15*kl],[a,30,30*kl],[s,1,Gu],[s,3,3*Gu],[s,6,6*Gu],[s,12,12*Gu],[n,1,ad],[n,2,2*ad],[r,1,fA],[t,1,ZI],[t,3,3*ZI],[e,1,UC]];function o(u,d,h){const g=d<u;g&&([u,d]=[d,u]);const p=h&&typeof h.range=="function"?h:c(u,d,h),x=p?p.range(u,+d+1):[];return g?x.reverse():x}function c(u,d,h){const g=Math.abs(d-u)/h,p=Z3(([,,w])=>w).right(i,g);if(p===i.length)return e.every(VE(u/UC,d/UC,h));if(p===0)return x_.every(Math.max(VE(u,d,h),1));const[x,v]=i[g/i[p-1][2]<i[p][2]/g?p-1:p];return x.every(v)}return[o,c]}const[x_e,y_e]=GW(od,yA,A2,HW,pA,gA),[v_e,w_e]=GW(id,xA,N2,s1,mA,hA);function zC(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function WC(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ry(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function b_e(e){var t=e.dateTime,r=e.date,n=e.time,s=e.periods,a=e.days,i=e.shortDays,o=e.months,c=e.shortMonths,u=ny(s),d=sy(s),h=ny(a),g=sy(a),p=ny(i),x=sy(i),v=ny(o),w=sy(o),C=ny(c),k=sy(c),b={a:L,A:H,b:M,B:V,c:null,d:aR,e:aR,f:H_e,g:e2e,G:r2e,H:U_e,I:z_e,j:W_e,L:VW,m:G_e,M:V_e,p:W,q:R,Q:lR,s:cR,S:K_e,u:q_e,U:Y_e,V:X_e,w:Q_e,W:J_e,x:null,X:null,y:Z_e,Y:t2e,Z:n2e,"%":oR},N={a:U,A:q,b:Q,B:se,c:null,d:iR,e:iR,f:o2e,g:x2e,G:v2e,H:s2e,I:a2e,j:i2e,L:qW,m:l2e,M:c2e,p:X,q:ie,Q:lR,s:cR,S:u2e,u:d2e,U:f2e,V:h2e,w:g2e,W:m2e,x:null,X:null,y:p2e,Y:y2e,Z:w2e,"%":oR},E={a:I,A:B,b:Y,B:Z,c:ae,d:nR,e:nR,f:M_e,g:rR,G:tR,H:sR,I:sR,j:O_e,L:R_e,m:F_e,M:D_e,p:j,q:P_e,Q:B_e,s:$_e,S:I_e,u:T_e,U:E_e,V:N_e,w:C_e,W:A_e,x:ee,X:ne,y:rR,Y:tR,Z:j_e,"%":L_e};b.x=P(r,b),b.X=P(n,b),b.c=P(t,b),N.x=P(r,N),N.X=P(n,N),N.c=P(t,N);function P(le,ce){return function(Se){var re=[],ge=-1,Ee=0,Ae=le.length,He,Be,Rt;for(Se instanceof Date||(Se=new Date(+Se));++ge<Ae;)le.charCodeAt(ge)===37&&(re.push(le.slice(Ee,ge)),(Be=eR[He=le.charAt(++ge)])!=null?He=le.charAt(++ge):Be=He==="e"?" ":"0",(Rt=ce[He])&&(He=Rt(Se,Be)),re.push(He),Ee=ge+1);return re.push(le.slice(Ee,ge)),re.join("")}}function F(le,ce){return function(Se){var re=ry(1900,void 0,1),ge=A(re,le,Se+="",0),Ee,Ae;if(ge!=Se.length)return null;if("Q"in re)return new Date(re.Q);if("s"in re)return new Date(re.s*1e3+("L"in re?re.L:0));if(ce&&!("Z"in re)&&(re.Z=0),"p"in re&&(re.H=re.H%12+re.p*12),re.m===void 0&&(re.m="q"in re?re.q:0),"V"in re){if(re.V<1||re.V>53)return null;"w"in re||(re.w=1),"Z"in re?(Ee=WC(ry(re.y,0,1)),Ae=Ee.getUTCDay(),Ee=Ae>4||Ae===0?v_.ceil(Ee):v_(Ee),Ee=E2.offset(Ee,(re.V-1)*7),re.y=Ee.getUTCFullYear(),re.m=Ee.getUTCMonth(),re.d=Ee.getUTCDate()+(re.w+6)%7):(Ee=zC(ry(re.y,0,1)),Ae=Ee.getDay(),Ee=Ae>4||Ae===0?y_.ceil(Ee):y_(Ee),Ee=s1.offset(Ee,(re.V-1)*7),re.y=Ee.getFullYear(),re.m=Ee.getMonth(),re.d=Ee.getDate()+(re.w+6)%7)}else("W"in re||"U"in re)&&("w"in re||(re.w="u"in re?re.u%7:"W"in re?1:0),Ae="Z"in re?WC(ry(re.y,0,1)).getUTCDay():zC(ry(re.y,0,1)).getDay(),re.m=0,re.d="W"in re?(re.w+6)%7+re.W*7-(Ae+5)%7:re.w+re.U*7-(Ae+6)%7);return"Z"in re?(re.H+=re.Z/100|0,re.M+=re.Z%100,WC(re)):zC(re)}}function A(le,ce,Se,re){for(var ge=0,Ee=ce.length,Ae=Se.length,He,Be;ge<Ee;){if(re>=Ae)return-1;if(He=ce.charCodeAt(ge++),He===37){if(He=ce.charAt(ge++),Be=E[He in eR?ce.charAt(ge++):He],!Be||(re=Be(le,Se,re))<0)return-1}else if(He!=Se.charCodeAt(re++))return-1}return re}function j(le,ce,Se){var re=u.exec(ce.slice(Se));return re?(le.p=d.get(re[0].toLowerCase()),Se+re[0].length):-1}function I(le,ce,Se){var re=p.exec(ce.slice(Se));return re?(le.w=x.get(re[0].toLowerCase()),Se+re[0].length):-1}function B(le,ce,Se){var re=h.exec(ce.slice(Se));return re?(le.w=g.get(re[0].toLowerCase()),Se+re[0].length):-1}function Y(le,ce,Se){var re=C.exec(ce.slice(Se));return re?(le.m=k.get(re[0].toLowerCase()),Se+re[0].length):-1}function Z(le,ce,Se){var re=v.exec(ce.slice(Se));return re?(le.m=w.get(re[0].toLowerCase()),Se+re[0].length):-1}function ae(le,ce,Se){return A(le,t,ce,Se)}function ee(le,ce,Se){return A(le,r,ce,Se)}function ne(le,ce,Se){return A(le,n,ce,Se)}function L(le){return i[le.getDay()]}function H(le){return a[le.getDay()]}function M(le){return c[le.getMonth()]}function V(le){return o[le.getMonth()]}function W(le){return s[+(le.getHours()>=12)]}function R(le){return 1+~~(le.getMonth()/3)}function U(le){return i[le.getUTCDay()]}function q(le){return a[le.getUTCDay()]}function Q(le){return c[le.getUTCMonth()]}function se(le){return o[le.getUTCMonth()]}function X(le){return s[+(le.getUTCHours()>=12)]}function ie(le){return 1+~~(le.getUTCMonth()/3)}return{format:function(le){var ce=P(le+="",b);return ce.toString=function(){return le},ce},parse:function(le){var ce=F(le+="",!1);return ce.toString=function(){return le},ce},utcFormat:function(le){var ce=P(le+="",N);return ce.toString=function(){return le},ce},utcParse:function(le){var ce=F(le+="",!0);return ce.toString=function(){return le},ce}}}var eR={"-":"",_:" ",0:"0"},Ha=/^\s*\d+/,__e=/^%/,S_e=/[\\^$*+?|[\]().{}]/g;function wn(e,t,r){var n=e<0?"-":"",s=(n?-e:e)+"",a=s.length;return n+(a<r?new Array(r-a+1).join(t)+s:s)}function k_e(e){return e.replace(S_e,"\\$&")}function ny(e){return new RegExp("^(?:"+e.map(k_e).join("|")+")","i")}function sy(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function C_e(e,t,r){var n=Ha.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function T_e(e,t,r){var n=Ha.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function E_e(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function N_e(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function A_e(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function tR(e,t,r){var n=Ha.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function rR(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function j_e(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function P_e(e,t,r){var n=Ha.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function F_e(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function nR(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function O_e(e,t,r){var n=Ha.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function sR(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function D_e(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function I_e(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function R_e(e,t,r){var n=Ha.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function M_e(e,t,r){var n=Ha.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function L_e(e,t,r){var n=__e.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function B_e(e,t,r){var n=Ha.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function $_e(e,t,r){var n=Ha.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function aR(e,t){return wn(e.getDate(),t,2)}function U_e(e,t){return wn(e.getHours(),t,2)}function z_e(e,t){return wn(e.getHours()%12||12,t,2)}function W_e(e,t){return wn(1+s1.count(id(e),e),t,3)}function VW(e,t){return wn(e.getMilliseconds(),t,3)}function H_e(e,t){return VW(e,t)+"000"}function G_e(e,t){return wn(e.getMonth()+1,t,2)}function V_e(e,t){return wn(e.getMinutes(),t,2)}function K_e(e,t){return wn(e.getSeconds(),t,2)}function q_e(e){var t=e.getDay();return t===0?7:t}function Y_e(e,t){return wn(N2.count(id(e)-1,e),t,2)}function KW(e){var t=e.getDay();return t>=4||t===0?Pm(e):Pm.ceil(e)}function X_e(e,t){return e=KW(e),wn(Pm.count(id(e),e)+(id(e).getDay()===4),t,2)}function Q_e(e){return e.getDay()}function J_e(e,t){return wn(y_.count(id(e)-1,e),t,2)}function Z_e(e,t){return wn(e.getFullYear()%100,t,2)}function e2e(e,t){return e=KW(e),wn(e.getFullYear()%100,t,2)}function t2e(e,t){return wn(e.getFullYear()%1e4,t,4)}function r2e(e,t){var r=e.getDay();return e=r>=4||r===0?Pm(e):Pm.ceil(e),wn(e.getFullYear()%1e4,t,4)}function n2e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+wn(t/60|0,"0",2)+wn(t%60,"0",2)}function iR(e,t){return wn(e.getUTCDate(),t,2)}function s2e(e,t){return wn(e.getUTCHours(),t,2)}function a2e(e,t){return wn(e.getUTCHours()%12||12,t,2)}function i2e(e,t){return wn(1+E2.count(od(e),e),t,3)}function qW(e,t){return wn(e.getUTCMilliseconds(),t,3)}function o2e(e,t){return qW(e,t)+"000"}function l2e(e,t){return wn(e.getUTCMonth()+1,t,2)}function c2e(e,t){return wn(e.getUTCMinutes(),t,2)}function u2e(e,t){return wn(e.getUTCSeconds(),t,2)}function d2e(e){var t=e.getUTCDay();return t===0?7:t}function f2e(e,t){return wn(A2.count(od(e)-1,e),t,2)}function YW(e){var t=e.getUTCDay();return t>=4||t===0?Fm(e):Fm.ceil(e)}function h2e(e,t){return e=YW(e),wn(Fm.count(od(e),e)+(od(e).getUTCDay()===4),t,2)}function g2e(e){return e.getUTCDay()}function m2e(e,t){return wn(v_.count(od(e)-1,e),t,2)}function p2e(e,t){return wn(e.getUTCFullYear()%100,t,2)}function x2e(e,t){return e=YW(e),wn(e.getUTCFullYear()%100,t,2)}function y2e(e,t){return wn(e.getUTCFullYear()%1e4,t,4)}function v2e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Fm(e):Fm.ceil(e),wn(e.getUTCFullYear()%1e4,t,4)}function w2e(){return"+0000"}function oR(){return"%"}function lR(e){return+e}function cR(e){return Math.floor(+e/1e3)}var Lg,XW,QW;b2e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function b2e(e){return Lg=b_e(e),XW=Lg.format,Lg.parse,QW=Lg.utcFormat,Lg.utcParse,Lg}function _2e(e){return new Date(e)}function S2e(e){return e instanceof Date?+e:+new Date(+e)}function vA(e,t,r,n,s,a,i,o,c,u){var d=aA(),h=d.invert,g=d.domain,p=u(".%L"),x=u(":%S"),v=u("%I:%M"),w=u("%I %p"),C=u("%a %d"),k=u("%b %d"),b=u("%B"),N=u("%Y");function E(P){return(c(P)<P?p:o(P)<P?x:i(P)<P?v:a(P)<P?w:n(P)<P?s(P)<P?C:k:r(P)<P?b:N)(P)}return d.invert=function(P){return new Date(h(P))},d.domain=function(P){return arguments.length?g(Array.from(P,S2e)):g().map(_2e)},d.ticks=function(P){var F=g();return e(F[0],F[F.length-1],P??10)},d.tickFormat=function(P,F){return F==null?E:u(F)},d.nice=function(P){var F=g();return(!P||typeof P.range!="function")&&(P=t(F[0],F[F.length-1],P??10)),P?g(MW(F,P)):d},d.copy=function(){return n1(d,vA(e,t,r,n,s,a,i,o,c,u))},d}function k2e(){return Ml.apply(vA(v_e,w_e,id,xA,N2,s1,mA,hA,Mh,XW).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function C2e(){return Ml.apply(vA(x_e,y_e,od,yA,A2,E2,pA,gA,Mh,QW).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function j2(){var e=0,t=1,r,n,s,a,i=to,o=!1,c;function u(h){return h==null||isNaN(h=+h)?c:i(s===0?.5:(h=(a(h)-r)*s,o?Math.max(0,Math.min(1,h)):h))}u.domain=function(h){return arguments.length?([e,t]=h,r=a(e=+e),n=a(t=+t),s=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(h){return arguments.length?(o=!!h,u):o},u.interpolator=function(h){return arguments.length?(i=h,u):i};function d(h){return function(g){var p,x;return arguments.length?([p,x]=g,i=h(p,x),u):[i(0),i(1)]}}return u.range=d(sp),u.rangeRound=d(sA),u.unknown=function(h){return arguments.length?(c=h,u):c},function(h){return a=h,r=h(e),n=h(t),s=r===n?0:1/(n-r),u}}function Wf(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function JW(){var e=zf(j2()(to));return e.copy=function(){return Wf(e,JW())},md.apply(e,arguments)}function ZW(){var e=lA(j2()).domain([1,10]);return e.copy=function(){return Wf(e,ZW()).base(e.base())},md.apply(e,arguments)}function eH(){var e=cA(j2());return e.copy=function(){return Wf(e,eH()).constant(e.constant())},md.apply(e,arguments)}function wA(){var e=uA(j2());return e.copy=function(){return Wf(e,wA()).exponent(e.exponent())},md.apply(e,arguments)}function T2e(){return wA.apply(null,arguments).exponent(.5)}function tH(){var e=[],t=to;function r(n){if(n!=null&&!isNaN(n=+n))return t((t1(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let s of n)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(bf),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,s)=>t(s/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(s,a)=>dbe(e,a/n))},r.copy=function(){return tH(t).domain(e)},md.apply(r,arguments)}function P2(){var e=0,t=.5,r=1,n=1,s,a,i,o,c,u=to,d,h=!1,g;function p(v){return isNaN(v=+v)?g:(v=.5+((v=+d(v))-a)*(n*v<n*a?o:c),u(h?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,t,r]=v,s=d(e=+e),a=d(t=+t),i=d(r=+r),o=s===a?0:.5/(a-s),c=a===i?0:.5/(i-a),n=a<s?-1:1,p):[e,t,r]},p.clamp=function(v){return arguments.length?(h=!!v,p):h},p.interpolator=function(v){return arguments.length?(u=v,p):u};function x(v){return function(w){var C,k,b;return arguments.length?([C,k,b]=w,u=Lbe(v,[C,k,b]),p):[u(0),u(.5),u(1)]}}return p.range=x(sp),p.rangeRound=x(sA),p.unknown=function(v){return arguments.length?(g=v,p):g},function(v){return d=v,s=v(e),a=v(t),i=v(r),o=s===a?0:.5/(a-s),c=a===i?0:.5/(i-a),n=a<s?-1:1,p}}function rH(){var e=zf(P2()(to));return e.copy=function(){return Wf(e,rH())},md.apply(e,arguments)}function nH(){var e=lA(P2()).domain([.1,1,10]);return e.copy=function(){return Wf(e,nH()).base(e.base())},md.apply(e,arguments)}function sH(){var e=cA(P2());return e.copy=function(){return Wf(e,sH()).constant(e.constant())},md.apply(e,arguments)}function bA(){var e=uA(P2());return e.copy=function(){return Wf(e,bA()).exponent(e.exponent())},md.apply(e,arguments)}function E2e(){return bA.apply(null,arguments).exponent(.5)}const hy=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:tA,scaleDiverging:rH,scaleDivergingLog:nH,scaleDivergingPow:bA,scaleDivergingSqrt:E2e,scaleDivergingSymlog:sH,scaleIdentity:RW,scaleImplicit:KE,scaleLinear:IW,scaleLog:LW,scaleOrdinal:eA,scalePoint:gbe,scalePow:dA,scaleQuantile:UW,scaleQuantize:zW,scaleRadial:$W,scaleSequential:JW,scaleSequentialLog:ZW,scaleSequentialPow:wA,scaleSequentialQuantile:tH,scaleSequentialSqrt:T2e,scaleSequentialSymlog:eH,scaleSqrt:o_e,scaleSymlog:BW,scaleThreshold:WW,scaleTime:k2e,scaleUtc:C2e,tickFormat:DW},Symbol.toStringTag,{value:"Module"}));var Hf=e=>e.chartData,N2e=St([Hf],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),_A=(e,t,r,n)=>n?N2e(e):Hf(e);function Om(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(fc(t)&&fc(r))return!0}return!1}function uR(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function A2e(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,s,a;if(fc(r))s=r;else if(typeof r=="function")return;if(fc(n))a=n;else if(typeof n=="function")return;var i=[s,a];if(Om(i))return i}}function j2e(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Om(n))return uR(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[s,a]=e,i,o;if(s==="auto")t!=null&&(i=Math.min(...t));else if(Lr(s))i=s;else if(typeof s=="function")try{t!=null&&(i=s(t?.[0]))}catch{}else if(typeof s=="string"&&rI.test(s)){var c=rI.exec(s);if(c==null||t==null)i=void 0;else{var u=+c[1];i=t[0]-u}}else i=t?.[0];if(a==="auto")t!=null&&(o=Math.max(...t));else if(Lr(a))o=a;else if(typeof a=="function")try{t!=null&&(o=a(t?.[1]))}catch{}else if(typeof a=="string"&&nI.test(a)){var d=nI.exec(a);if(d==null||t==null)o=void 0;else{var h=+d[1];o=t[1]+h}}else o=t?.[1];var g=[i,o];if(Om(g))return t==null?g:uR(g,t,r)}}}var ap=1e9,P2e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},kA,ms=!0,Fl="[DecimalError] ",Jh=Fl+"Invalid argument: ",SA=Fl+"Exponent out of range: ",ip=Math.floor,Nh=Math.pow,F2e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Vo,Ia=1e7,rs=7,aH=9007199254740991,w_=ip(aH/rs),hr={};hr.absoluteValue=hr.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};hr.comparedTo=hr.cmp=function(e){var t,r,n,s,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(n=a.d.length,s=e.d.length,t=0,r=n<s?n:s;t<r;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return n===s?0:n>s^a.s<0?1:-1};hr.decimalPlaces=hr.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*rs;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};hr.dividedBy=hr.div=function(e){return Qu(this,new this.constructor(e))};hr.dividedToIntegerBy=hr.idiv=function(e){var t=this,r=t.constructor;return Vn(Qu(t,new r(e),0,1),r.precision)};hr.equals=hr.eq=function(e){return!this.cmp(e)};hr.exponent=function(){return ua(this)};hr.greaterThan=hr.gt=function(e){return this.cmp(e)>0};hr.greaterThanOrEqualTo=hr.gte=function(e){return this.cmp(e)>=0};hr.isInteger=hr.isint=function(){return this.e>this.d.length-2};hr.isNegative=hr.isneg=function(){return this.s<0};hr.isPositive=hr.ispos=function(){return this.s>0};hr.isZero=function(){return this.s===0};hr.lessThan=hr.lt=function(e){return this.cmp(e)<0};hr.lessThanOrEqualTo=hr.lte=function(e){return this.cmp(e)<1};hr.logarithm=hr.log=function(e){var t,r=this,n=r.constructor,s=n.precision,a=s+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Vo))throw Error(Fl+"NaN");if(r.s<1)throw Error(Fl+(r.s?"NaN":"-Infinity"));return r.eq(Vo)?new n(0):(ms=!1,t=Qu(wv(r,a),wv(e,a),a),ms=!0,Vn(t,s))};hr.minus=hr.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?lH(t,e):iH(t,(e.s=-e.s,e))};hr.modulo=hr.mod=function(e){var t,r=this,n=r.constructor,s=n.precision;if(e=new n(e),!e.s)throw Error(Fl+"NaN");return r.s?(ms=!1,t=Qu(r,e,0,1).times(e),ms=!0,r.minus(t)):Vn(new n(r),s)};hr.naturalExponential=hr.exp=function(){return oH(this)};hr.naturalLogarithm=hr.ln=function(){return wv(this)};hr.negated=hr.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};hr.plus=hr.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?iH(t,e):lH(t,(e.s=-e.s,e))};hr.precision=hr.sd=function(e){var t,r,n,s=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Jh+e);if(t=ua(s)+1,n=s.d.length-1,r=n*rs+1,n=s.d[n],n){for(;n%10==0;n/=10)r--;for(n=s.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};hr.squareRoot=hr.sqrt=function(){var e,t,r,n,s,a,i,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(Fl+"NaN")}for(e=ua(o),ms=!1,s=Math.sqrt(+o),s==0||s==1/0?(t=Gc(o.d),(t.length+e)%2==0&&(t+="0"),s=Math.sqrt(t),e=ip((e+1)/2)-(e<0||e%2),s==1/0?t="5e"+e:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(s.toString()),r=c.precision,s=i=r+3;;)if(a=n,n=a.plus(Qu(o,a,i+2)).times(.5),Gc(a.d).slice(0,i)===(t=Gc(n.d)).slice(0,i)){if(t=t.slice(i-3,i+1),s==i&&t=="4999"){if(Vn(a,r+1,0),a.times(a).eq(o)){n=a;break}}else if(t!="9999")break;i+=4}return ms=!0,Vn(n,r)};hr.times=hr.mul=function(e){var t,r,n,s,a,i,o,c,u,d=this,h=d.constructor,g=d.d,p=(e=new h(e)).d;if(!d.s||!e.s)return new h(0);for(e.s*=d.s,r=d.e+e.e,c=g.length,u=p.length,c<u&&(a=g,g=p,p=a,i=c,c=u,u=i),a=[],i=c+u,n=i;n--;)a.push(0);for(n=u;--n>=0;){for(t=0,s=c+n;s>n;)o=a[s]+p[n]*g[s-n-1]+t,a[s--]=o%Ia|0,t=o/Ia|0;a[s]=(a[s]+t)%Ia|0}for(;!a[--i];)a.pop();return t?++r:a.shift(),e.d=a,e.e=r,ms?Vn(e,h.precision):e};hr.toDecimalPlaces=hr.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(eu(e,0,ap),t===void 0?t=n.rounding:eu(t,0,8),Vn(r,e+ua(r)+1,t))};hr.toExponential=function(e,t){var r,n=this,s=n.constructor;return e===void 0?r=b0(n,!0):(eu(e,0,ap),t===void 0?t=s.rounding:eu(t,0,8),n=Vn(new s(n),e+1,t),r=b0(n,!0,e+1)),r};hr.toFixed=function(e,t){var r,n,s=this,a=s.constructor;return e===void 0?b0(s):(eu(e,0,ap),t===void 0?t=a.rounding:eu(t,0,8),n=Vn(new a(s),e+ua(s)+1,t),r=b0(n.abs(),!1,e+ua(n)+1),s.isneg()&&!s.isZero()?"-"+r:r)};hr.toInteger=hr.toint=function(){var e=this,t=e.constructor;return Vn(new t(e),ua(e)+1,t.rounding)};hr.toNumber=function(){return+this};hr.toPower=hr.pow=function(e){var t,r,n,s,a,i,o=this,c=o.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Vo);if(o=new c(o),!o.s){if(e.s<1)throw Error(Fl+"Infinity");return o}if(o.eq(Vo))return o;if(n=c.precision,e.eq(Vo))return Vn(o,n);if(t=e.e,r=e.d.length-1,i=t>=r,a=o.s,i){if((r=d<0?-d:d)<=aH){for(s=new c(Vo),t=Math.ceil(n/rs+4),ms=!1;r%2&&(s=s.times(o),fR(s.d,t)),r=ip(r/2),r!==0;)o=o.times(o),fR(o.d,t);return ms=!0,e.s<0?new c(Vo).div(s):Vn(s,n)}}else if(a<0)throw Error(Fl+"NaN");return a=a<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,ms=!1,s=e.times(wv(o,n+u)),ms=!0,s=oH(s),s.s=a,s};hr.toPrecision=function(e,t){var r,n,s=this,a=s.constructor;return e===void 0?(r=ua(s),n=b0(s,r<=a.toExpNeg||r>=a.toExpPos)):(eu(e,1,ap),t===void 0?t=a.rounding:eu(t,0,8),s=Vn(new a(s),e,t),r=ua(s),n=b0(s,e<=r||r<=a.toExpNeg,e)),n};hr.toSignificantDigits=hr.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(eu(e,1,ap),t===void 0?t=n.rounding:eu(t,0,8)),Vn(new n(r),e,t)};hr.toString=hr.valueOf=hr.val=hr.toJSON=hr[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=ua(e),r=e.constructor;return b0(e,t<=r.toExpNeg||t>=r.toExpPos)};function iH(e,t){var r,n,s,a,i,o,c,u,d=e.constructor,h=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),ms?Vn(t,h):t;if(c=e.d,u=t.d,i=e.e,s=t.e,c=c.slice(),a=i-s,a){for(a<0?(n=c,a=-a,o=u.length):(n=u,s=i,o=c.length),i=Math.ceil(h/rs),o=i>o?i+1:o+1,a>o&&(a=o,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(o=c.length,a=u.length,o-a<0&&(a=o,n=u,u=c,c=n),r=0;a;)r=(c[--a]=c[a]+u[a]+r)/Ia|0,c[a]%=Ia;for(r&&(c.unshift(r),++s),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=s,ms?Vn(t,h):t}function eu(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Jh+e)}function Gc(e){var t,r,n,s=e.length-1,a="",i=e[0];if(s>0){for(a+=i,t=1;t<s;t++)n=e[t]+"",r=rs-n.length,r&&(a+=of(r)),a+=n;i=e[t],n=i+"",r=rs-n.length,r&&(a+=of(r))}else if(i===0)return"0";for(;i%10===0;)i/=10;return a+i}var Qu=(function(){function e(n,s){var a,i=0,o=n.length;for(n=n.slice();o--;)a=n[o]*s+i,n[o]=a%Ia|0,i=a/Ia|0;return i&&n.unshift(i),n}function t(n,s,a,i){var o,c;if(a!=i)c=a>i?1:-1;else for(o=c=0;o<a;o++)if(n[o]!=s[o]){c=n[o]>s[o]?1:-1;break}return c}function r(n,s,a){for(var i=0;a--;)n[a]-=i,i=n[a]<s[a]?1:0,n[a]=i*Ia+n[a]-s[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,s,a,i){var o,c,u,d,h,g,p,x,v,w,C,k,b,N,E,P,F,A,j=n.constructor,I=n.s==s.s?1:-1,B=n.d,Y=s.d;if(!n.s)return new j(n);if(!s.s)throw Error(Fl+"Division by zero");for(c=n.e-s.e,F=Y.length,E=B.length,p=new j(I),x=p.d=[],u=0;Y[u]==(B[u]||0);)++u;if(Y[u]>(B[u]||0)&&--c,a==null?k=a=j.precision:i?k=a+(ua(n)-ua(s))+1:k=a,k<0)return new j(0);if(k=k/rs+2|0,u=0,F==1)for(d=0,Y=Y[0],k++;(u<E||d)&&k--;u++)b=d*Ia+(B[u]||0),x[u]=b/Y|0,d=b%Y|0;else{for(d=Ia/(Y[0]+1)|0,d>1&&(Y=e(Y,d),B=e(B,d),F=Y.length,E=B.length),N=F,v=B.slice(0,F),w=v.length;w<F;)v[w++]=0;A=Y.slice(),A.unshift(0),P=Y[0],Y[1]>=Ia/2&&++P;do d=0,o=t(Y,v,F,w),o<0?(C=v[0],F!=w&&(C=C*Ia+(v[1]||0)),d=C/P|0,d>1?(d>=Ia&&(d=Ia-1),h=e(Y,d),g=h.length,w=v.length,o=t(h,v,g,w),o==1&&(d--,r(h,F<g?A:Y,g))):(d==0&&(o=d=1),h=Y.slice()),g=h.length,g<w&&h.unshift(0),r(v,h,w),o==-1&&(w=v.length,o=t(Y,v,F,w),o<1&&(d++,r(v,F<w?A:Y,w))),w=v.length):o===0&&(d++,v=[0]),x[u++]=d,o&&v[0]?v[w++]=B[N]||0:(v=[B[N]],w=1);while((N++<E||v[0]!==void 0)&&k--)}return x[0]||x.shift(),p.e=c,Vn(p,i?a+ua(p)+1:a)}})();function oH(e,t){var r,n,s,a,i,o,c=0,u=0,d=e.constructor,h=d.precision;if(ua(e)>16)throw Error(SA+ua(e));if(!e.s)return new d(Vo);for(ms=!1,o=h,i=new d(.03125);e.abs().gte(.1);)e=e.times(i),u+=5;for(n=Math.log(Nh(2,u))/Math.LN10*2+5|0,o+=n,r=s=a=new d(Vo),d.precision=o;;){if(s=Vn(s.times(e),o),r=r.times(++c),i=a.plus(Qu(s,r,o)),Gc(i.d).slice(0,o)===Gc(a.d).slice(0,o)){for(;u--;)a=Vn(a.times(a),o);return d.precision=h,t==null?(ms=!0,Vn(a,h)):a}a=i}}function ua(e){for(var t=e.e*rs,r=e.d[0];r>=10;r/=10)t++;return t}function HC(e,t,r){if(t>e.LN10.sd())throw ms=!0,r&&(e.precision=r),Error(Fl+"LN10 precision limit exceeded");return Vn(new e(e.LN10),t)}function of(e){for(var t="";e--;)t+="0";return t}function wv(e,t){var r,n,s,a,i,o,c,u,d,h=1,g=10,p=e,x=p.d,v=p.constructor,w=v.precision;if(p.s<1)throw Error(Fl+(p.s?"NaN":"-Infinity"));if(p.eq(Vo))return new v(0);if(t==null?(ms=!1,u=w):u=t,p.eq(10))return t==null&&(ms=!0),HC(v,u);if(u+=g,v.precision=u,r=Gc(x),n=r.charAt(0),a=ua(p),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=Gc(p.d),n=r.charAt(0),h++;a=ua(p),n>1?(p=new v("0."+r),a++):p=new v(n+"."+r.slice(1))}else return c=HC(v,u+2,w).times(a+""),p=wv(new v(n+"."+r.slice(1)),u-g).plus(c),v.precision=w,t==null?(ms=!0,Vn(p,w)):p;for(o=i=p=Qu(p.minus(Vo),p.plus(Vo),u),d=Vn(p.times(p),u),s=3;;){if(i=Vn(i.times(d),u),c=o.plus(Qu(i,new v(s),u)),Gc(c.d).slice(0,u)===Gc(o.d).slice(0,u))return o=o.times(2),a!==0&&(o=o.plus(HC(v,u+2,w).times(a+""))),o=Qu(o,new v(h),u),v.precision=w,t==null?(ms=!0,Vn(o,w)):o;o=c,s+=2}}function dR(e,t){var r,n,s;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(s=t.length;t.charCodeAt(s-1)===48;)--s;if(t=t.slice(n,s),t){if(s-=n,r=r-n-1,e.e=ip(r/rs),e.d=[],n=(r+1)%rs,r<0&&(n+=rs),n<s){for(n&&e.d.push(+t.slice(0,n)),s-=rs;n<s;)e.d.push(+t.slice(n,n+=rs));t=t.slice(n),n=rs-t.length}else n-=s;for(;n--;)t+="0";if(e.d.push(+t),ms&&(e.e>w_||e.e<-w_))throw Error(SA+r)}else e.s=0,e.e=0,e.d=[0];return e}function Vn(e,t,r){var n,s,a,i,o,c,u,d,h=e.d;for(i=1,a=h[0];a>=10;a/=10)i++;if(n=t-i,n<0)n+=rs,s=t,u=h[d=0];else{if(d=Math.ceil((n+1)/rs),a=h.length,d>=a)return e;for(u=a=h[d],i=1;a>=10;a/=10)i++;n%=rs,s=n-rs+i}if(r!==void 0&&(a=Nh(10,i-s-1),o=u/a%10|0,c=t<0||h[d+1]!==void 0||u%a,c=r<4?(o||c)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(n>0?s>0?u/Nh(10,i-s):0:h[d-1])%10&1||r==(e.s<0?8:7))),t<1||!h[0])return c?(a=ua(e),h.length=1,t=t-a-1,h[0]=Nh(10,(rs-t%rs)%rs),e.e=ip(-t/rs)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(n==0?(h.length=d,a=1,d--):(h.length=d+1,a=Nh(10,rs-n),h[d]=s>0?(u/Nh(10,i-s)%Nh(10,s)|0)*a:0),c)for(;;)if(d==0){(h[0]+=a)==Ia&&(h[0]=1,++e.e);break}else{if(h[d]+=a,h[d]!=Ia)break;h[d--]=0,a=1}for(n=h.length;h[--n]===0;)h.pop();if(ms&&(e.e>w_||e.e<-w_))throw Error(SA+ua(e));return e}function lH(e,t){var r,n,s,a,i,o,c,u,d,h,g=e.constructor,p=g.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new g(e),ms?Vn(t,p):t;if(c=e.d,h=t.d,n=t.e,u=e.e,c=c.slice(),i=u-n,i){for(d=i<0,d?(r=c,i=-i,o=h.length):(r=h,n=u,o=c.length),s=Math.max(Math.ceil(p/rs),o)+2,i>s&&(i=s,r.length=1),r.reverse(),s=i;s--;)r.push(0);r.reverse()}else{for(s=c.length,o=h.length,d=s<o,d&&(o=s),s=0;s<o;s++)if(c[s]!=h[s]){d=c[s]<h[s];break}i=0}for(d&&(r=c,c=h,h=r,t.s=-t.s),o=c.length,s=h.length-o;s>0;--s)c[o++]=0;for(s=h.length;s>i;){if(c[--s]<h[s]){for(a=s;a&&c[--a]===0;)c[a]=Ia-1;--c[a],c[s]+=Ia}c[s]-=h[s]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,ms?Vn(t,p):t):new g(0)}function b0(e,t,r){var n,s=ua(e),a=Gc(e.d),i=a.length;return t?(r&&(n=r-i)>0?a=a.charAt(0)+"."+a.slice(1)+of(n):i>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(s<0?"e":"e+")+s):s<0?(a="0."+of(-s-1)+a,r&&(n=r-i)>0&&(a+=of(n))):s>=i?(a+=of(s+1-i),r&&(n=r-s-1)>0&&(a=a+"."+of(n))):((n=s+1)<i&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-i)>0&&(s+1===i&&(a+="."),a+=of(n))),e.s<0?"-"+a:a}function fR(e,t){if(e.length>t)return e.length=t,!0}function cH(e){var t,r,n;function s(a){var i=this;if(!(i instanceof s))return new s(a);if(i.constructor=s,a instanceof s){i.s=a.s,i.e=a.e,i.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(Jh+a);if(a>0)i.s=1;else if(a<0)a=-a,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(a===~~a&&a<1e7){i.e=0,i.d=[a];return}return dR(i,a.toString())}else if(typeof a!="string")throw Error(Jh+a);if(a.charCodeAt(0)===45?(a=a.slice(1),i.s=-1):i.s=1,F2e.test(a))dR(i,a);else throw Error(Jh+a)}if(s.prototype=hr,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=cH,s.config=s.set=O2e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return s.config(e),s}function O2e(e){if(!e||typeof e!="object")throw Error(Fl+"Object expected");var t,r,n,s=["precision",1,ap,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<s.length;t+=3)if((n=e[r=s[t]])!==void 0)if(ip(n)===n&&n>=s[t+1]&&n<=s[t+2])this[r]=n;else throw Error(Jh+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Jh+r+": "+n);return this}var kA=cH(P2e);Vo=new kA(1);const In=kA;var D2e=e=>e,uH={},dH=e=>e===uH,hR=e=>function t(){return arguments.length===0||arguments.length===1&&dH(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},fH=(e,t)=>e===1?t:hR(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];var a=n.filter(i=>i!==uH).length;return a>=e?t(...n):fH(e-a,hR(function(){for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];var u=n.map(d=>dH(d)?o.shift():d);return t(...u,...o)}))}),F2=e=>fH(e.length,e),QE=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},I2e=F2((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),R2e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return D2e;var s=r.reverse(),a=s[0],i=s.slice(1);return function(){return i.reduce((o,c)=>c(o),a(...arguments))}},JE=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),hH=e=>{var t=null,r=null;return function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t&&s.every((i,o)=>{var c;return i===((c=t)===null||c===void 0?void 0:c[o])})||(t=s,r=e(...s)),r}};function gH(e){var t;return e===0?t=1:t=Math.floor(new In(e).abs().log(10).toNumber())+1,t}function mH(e,t,r){for(var n=new In(e),s=0,a=[];n.lt(t)&&s<1e5;)a.push(n.toNumber()),n=n.add(r),s++;return a}F2((e,t,r)=>{var n=+e,s=+t;return n+r*(s-n)});F2((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});F2((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var pH=e=>{var[t,r]=e,[n,s]=[t,r];return t>r&&([n,s]=[r,t]),[n,s]},xH=(e,t,r)=>{if(e.lte(0))return new In(0);var n=gH(e.toNumber()),s=new In(10).pow(n),a=e.div(s),i=n!==1?.05:.1,o=new In(Math.ceil(a.div(i).toNumber())).add(r).mul(i),c=o.mul(s);return t?new In(c.toNumber()):new In(Math.ceil(c.toNumber()))},M2e=(e,t,r)=>{var n=new In(1),s=new In(e);if(!s.isint()&&r){var a=Math.abs(e);a<1?(n=new In(10).pow(gH(e)-1),s=new In(Math.floor(s.div(n).toNumber())).mul(n)):a>1&&(s=new In(Math.floor(e)))}else e===0?s=new In(Math.floor((t-1)/2)):r||(s=new In(Math.floor(e)));var i=Math.floor((t-1)/2),o=R2e(I2e(c=>s.add(new In(c-i).mul(n)).toNumber()),QE);return o(0,t)},yH=function(t,r,n,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new In(0),tickMin:new In(0),tickMax:new In(0)};var i=xH(new In(r).sub(t).div(n-1),s,a),o;t<=0&&r>=0?o=new In(0):(o=new In(t).add(r).div(2),o=o.sub(new In(o).mod(i)));var c=Math.ceil(o.sub(t).div(i).toNumber()),u=Math.ceil(new In(r).sub(o).div(i).toNumber()),d=c+u+1;return d>n?yH(t,r,n,s,a+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:i,tickMin:o.sub(new In(c).mul(i)),tickMax:o.add(new In(u).mul(i))})};function L2e(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(n,2),[i,o]=pH([t,r]);if(i===-1/0||o===1/0){var c=o===1/0?[i,...QE(0,n-1).map(()=>1/0)]:[...QE(0,n-1).map(()=>-1/0),o];return t>r?JE(c):c}if(i===o)return M2e(i,n,s);var{step:u,tickMin:d,tickMax:h}=yH(i,o,a,s,0),g=mH(d,h.add(new In(.1).mul(u)),u);return t>r?JE(g):g}function B2e(e,t){var[r,n]=e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[a,i]=pH([r,n]);if(a===-1/0||i===1/0)return[r,n];if(a===i)return[a];var o=Math.max(t,2),c=xH(new In(i).sub(a).div(o-1),s,0),u=[...mH(new In(a),new In(i),c),i];return s===!1&&(u=u.map(d=>Math.round(d))),r>n?JE(u):u}var $2e=hH(L2e),U2e=hH(B2e),z2e=e=>e.rootProps.barCategoryGap,O2=e=>e.rootProps.stackOffset,CA=e=>e.options.chartName,TA=e=>e.rootProps.syncId,vH=e=>e.rootProps.syncMethod,EA=e=>e.options.eventEmitter,$u={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Bo={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},D2=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},W2e={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:$u.angleAxisId,includeHidden:!1,name:void 0,reversed:$u.reversed,scale:$u.scale,tick:$u.tick,tickCount:void 0,ticks:void 0,type:$u.type,unit:void 0},H2e={allowDataOverflow:Bo.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Bo.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Bo.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Bo.scale,tick:Bo.tick,tickCount:Bo.tickCount,ticks:void 0,type:Bo.type,unit:void 0},G2e={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:$u.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:$u.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:$u.scale,tick:$u.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},V2e={allowDataOverflow:Bo.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Bo.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Bo.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Bo.scale,tick:Bo.tick,tickCount:Bo.tickCount,ticks:void 0,type:"category",unit:void 0},NA=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?G2e:W2e,AA=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?V2e:H2e,I2=e=>e.polarOptions,jA=St([hd,gd,mi],Zve),wH=St([I2,jA],(e,t)=>{if(e!=null)return jf(e.innerRadius,t,0)}),bH=St([I2,jA],(e,t)=>{if(e!=null)return jf(e.outerRadius,t,t*.8)}),K2e=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},_H=St([I2],K2e);St([NA,_H],D2);var SH=St([jA,wH,bH],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});St([AA,SH],D2);var kH=St([us,I2,wH,bH,hd,gd],(e,t,r,n,s,a)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:i,cy:o,startAngle:c,endAngle:u}=t;return{cx:jf(i,s,s/2),cy:jf(o,a,a/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),da=(e,t)=>t,R2=(e,t,r)=>r;function CH(e){return e?.id}var Ca=e=>{var t=us(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},op=e=>e.tooltip.settings.axisId,Ga=e=>{var t=Ca(e),r=op(e);return a1(e,t,r)},TH=St([Ga],e=>e?.dataKey);function EH(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:s,dataKey:a}=r,i=new Map;return e.forEach(o=>{var c,u=(c=o.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=CH(o);u.forEach((h,g)=>{var p=a==null||s?g:String(so(h,a,null)),x=so(h,o.dataKey,0),v;i.has(p)?v=i.get(p):v={},Object.assign(v,{[d]:x}),i.set(p,v)})}}),Array.from(i.values())}function PA(e){return e.stackId!=null&&e.dataKey!=null}function gR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function b_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gR(Object(r),!0).forEach(function(n){q2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function q2e(e,t,r){return(t=Y2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y2e(e){var t=X2e(e,"string");return typeof t=="symbol"?t:t+""}function X2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZE=[0,"auto"],Mo={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},NH=(e,t)=>e.cartesianAxis.xAxis[t],pd=(e,t)=>{var r=NH(e,t);return r??Mo},Lo={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:ZE,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:e1},AH=(e,t)=>e.cartesianAxis.yAxis[t],xd=(e,t)=>{var r=AH(e,t);return r??Lo},Q2e={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},FA=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??Q2e},No=(e,t,r)=>{switch(t){case"xAxis":return pd(e,r);case"yAxis":return xd(e,r);case"zAxis":return FA(e,r);case"angleAxis":return NA(e,r);case"radiusAxis":return AA(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},J2e=(e,t,r)=>{switch(t){case"xAxis":return pd(e,r);case"yAxis":return xd(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},a1=(e,t,r)=>{switch(t){case"xAxis":return pd(e,r);case"yAxis":return xd(e,r);case"angleAxis":return NA(e,r);case"radiusAxis":return AA(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},jH=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function PH(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var FH=e=>e.graphicalItems.cartesianItems,Z2e=St([da,R2],PH),OH=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),i1=St([FH,No,Z2e],OH),DH=St([i1],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(PA)),IH=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),RH=St([i1],IH),MH=e=>e.map(t=>t.data).filter(Boolean).flat(1),eSe=St([i1],MH),LH=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:s}=t;return e.length>0?e:r.slice(n,s+1)},OA=St([eSe,_A],LH),BH=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:so(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(s=>({value:so(s,n)}))):e.map(n=>({value:n})),M2=St([OA,No,i1],BH);function $H(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function L0(e){return e.filter(t=>Zc(t)||t instanceof Date).map(Number).filter(t=>jl(t)===!1)}function tSe(e,t,r){return!r||typeof t!="number"||jl(t)?[]:r.length?L0(r.flatMap(n=>{var s=so(e,n.dataKey),a,i;if(Array.isArray(s)?[a,i]=s:a=i=s,!(!fc(a)||!fc(i)))return[t-a,t+i]})):[]}var rSe=St([DH,_A,Ga],EH),UH=(e,t,r)=>{var n={},s=t.reduce((a,i)=>(i.stackId==null||(a[i.stackId]==null&&(a[i.stackId]=[]),a[i.stackId].push(i)),a),n);return Object.fromEntries(Object.entries(s).map(a=>{var[i,o]=a,c=o.map(CH);return[i,{stackedData:g1e(e,c,r),graphicalItems:o}]}))},nSe=St([rSe,DH,O2],UH),zH=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:s}=t;if(r!=="zAxis"){var a=x1e(e,n,s);if(!(a!=null&&a[0]===0&&a[1]===0))return a}},sSe=St([nSe,Hf,da],zH),WH=(e,t,r,n,s)=>r.length>0?e.flatMap(a=>r.flatMap(i=>{var o,c,u=(o=n[i.id])===null||o===void 0?void 0:o.filter(h=>$H(s,h)),d=so(a,(c=t.dataKey)!==null&&c!==void 0?c:i.dataKey);return{value:d,errorDomain:tSe(a,d,u)}})).filter(Boolean):t?.dataKey!=null?e.map(a=>({value:so(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]})),L2=e=>e.errorBars,HH=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>$H(r,n));St([RH,L2,da],HH);var aSe=St([OA,No,RH,L2,da],WH);function iSe(e){var{value:t}=e;if(Zc(t)||t instanceof Date)return t}var mR=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=L0(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},oSe=(e,t,r)=>{var n=e.map(iSe).filter(s=>s!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&sz(n))?kW(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},DA=e=>{var t;if(e==null||!("domain"in e))return ZE;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=L0(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:ZE},__=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var s=r.filter(Boolean);if(s.length!==0){var a=s.flat(),i=Math.min(...a),o=Math.max(...a);return[i,o]}},GH=e=>e.referenceElements.dots,lp=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),lSe=St([GH,da,R2],lp),VH=e=>e.referenceElements.areas,cSe=St([VH,da,R2],lp),KH=e=>e.referenceElements.lines,uSe=St([KH,da,R2],lp),qH=(e,t)=>{var r=L0(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},dSe=St(lSe,da,qH),YH=(e,t)=>{var r=L0(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},fSe=St([cSe,da],YH),XH=(e,t)=>{var r=L0(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},hSe=St(uSe,da,XH),gSe=St(dSe,hSe,fSe,(e,t,r)=>__(e,r,t)),mSe=St([No],DA),QH=(e,t,r,n,s,a,i)=>{var o=A2e(t,e.allowDataOverflow);if(o!=null)return o;var c=a==="vertical"&&i==="xAxis"||a==="horizontal"&&i==="yAxis",u=c?__(r,s,mR(n)):__(s,mR(n));return j2e(t,u,e.allowDataOverflow)},pSe=St([No,mSe,sSe,aSe,gSe,us,da],QH),xSe=[0,1],JH=(e,t,r,n,s,a,i)=>{if(!((e==null||r==null||r.length===0)&&i===void 0)){var{dataKey:o,type:c}=e,u=Uf(t,a);return u&&o==null?kW(0,r.length):c==="category"?oSe(n,e,u):s==="expand"?xSe:i}},IA=St([No,us,OA,M2,O2,da,pSe],JH),ZH=(e,t,r,n,s)=>{if(e!=null){var{scale:a,type:i}=e;if(a==="auto")return t==="radial"&&s==="radiusAxis"?"band":t==="radial"&&s==="angleAxis"?"linear":i==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":i==="category"?"band":"linear";if(typeof a=="string"){var o="scale".concat(B3(a));return o in hy?o:"point"}}},o1=St([No,us,jH,CA,da],ZH);function ySe(e){if(e!=null){if(e in hy)return hy[e]();var t="scale".concat(B3(e));if(t in hy)return hy[t]()}}function RA(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var s=ySe(t);if(s!=null){var a=s.domain(r).range(n);return u1e(a),a}}}var eG=(e,t,r)=>{var n=DA(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Om(e))return $2e(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Om(e))return U2e(e,t.tickCount,t.allowDecimals)}},MA=St([IA,a1,o1],eG),tG=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&Om(t)&&Array.isArray(r)&&r.length>0){var s=t[0],a=r[0],i=t[1],o=r[r.length-1];return[Math.min(s,a),Math.max(i,o)]}return t},vSe=St([No,IA,MA,da],tG),wSe=St(M2,No,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(L0(e.map(o=>o.value))).sort((o,c)=>o-c);if(n.length<2)return 1/0;var s=n[n.length-1]-n[0];if(s===0)return 1/0;for(var a=0;a<n.length-1;a++){var i=n[a+1]-n[a];r=Math.min(r,i)}return r/s}}),rG=St(wSe,us,z2e,mi,(e,t,r,n)=>n,(e,t,r,n,s)=>{if(!fc(e))return 0;var a=t==="vertical"?n.height:n.width;if(s==="gap")return e*a/2;if(s==="no-gap"){var i=jf(r,e*a),o=e*a/2;return o-i-(o-i)/a*i}return 0}),bSe=(e,t)=>{var r=pd(e,t);return r==null||typeof r.padding!="string"?0:rG(e,"xAxis",t,r.padding)},_Se=(e,t)=>{var r=xd(e,t);return r==null||typeof r.padding!="string"?0:rG(e,"yAxis",t,r.padding)},SSe=St(pd,bSe,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:s}=e;return typeof s=="string"?{left:t,right:t}:{left:((r=s.left)!==null&&r!==void 0?r:0)+t,right:((n=s.right)!==null&&n!==void 0?n:0)+t}}),kSe=St(xd,_Se,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:s}=e;return typeof s=="string"?{top:t,bottom:t}:{top:((r=s.top)!==null&&r!==void 0?r:0)+t,bottom:((n=s.bottom)!==null&&n!==void 0?n:0)+t}}),CSe=St([mi,SSe,C2,k2,(e,t,r)=>r],(e,t,r,n,s)=>{var{padding:a}=n;return s?[a.left,r.width-a.right]:[e.left+t.left,e.left+e.width-t.right]}),TSe=St([mi,us,kSe,C2,k2,(e,t,r)=>r],(e,t,r,n,s,a)=>{var{padding:i}=s;return a?[n.height-i.bottom,i.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),l1=(e,t,r,n)=>{var s;switch(t){case"xAxis":return CSe(e,r,n);case"yAxis":return TSe(e,r,n);case"zAxis":return(s=FA(e,r))===null||s===void 0?void 0:s.range;case"angleAxis":return _H(e);case"radiusAxis":return SH(e,r);default:return}},nG=St([No,l1],D2),cp=St([No,o1,vSe,nG],RA);St([i1,L2,da],HH);function sG(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var B2=(e,t)=>t,$2=(e,t,r)=>r,ESe=St(_2,B2,$2,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(sG)),NSe=St(S2,B2,$2,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(sG)),aG=(e,t)=>({width:e.width,height:t.height}),ASe=(e,t)=>{var r=typeof t.width=="number"?t.width:e1;return{width:r,height:e.height}},jSe=St(mi,pd,aG),PSe=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},FSe=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},OSe=St(gd,mi,ESe,B2,$2,(e,t,r,n,s)=>{var a={},i;return r.forEach(o=>{var c=aG(t,o);i==null&&(i=PSe(t,n,e));var u=n==="top"&&!s||n==="bottom"&&s;a[o.id]=i-Number(u)*c.height,i+=(u?-1:1)*c.height}),a}),DSe=St(hd,mi,NSe,B2,$2,(e,t,r,n,s)=>{var a={},i;return r.forEach(o=>{var c=ASe(t,o);i==null&&(i=FSe(t,n,e));var u=n==="left"&&!s||n==="right"&&s;a[o.id]=i-Number(u)*c.width,i+=(u?-1:1)*c.width}),a}),ISe=(e,t)=>{var r=pd(e,t);if(r!=null)return OSe(e,r.orientation,r.mirror)},RSe=St([mi,pd,ISe,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var s=r?.[n];return s==null?{x:e.left,y:0}:{x:e.left,y:s}}}),MSe=(e,t)=>{var r=xd(e,t);if(r!=null)return DSe(e,r.orientation,r.mirror)},LSe=St([mi,xd,MSe,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var s=r?.[n];return s==null?{x:0,y:e.top}:{x:s,y:e.top}}}),BSe=St(mi,xd,(e,t)=>{var r=typeof t.width=="number"?t.width:e1;return{width:r,height:e.height}}),iG=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:s,type:a,dataKey:i}=r,o=Uf(e,n),c=t.map(u=>u.value);if(i&&o&&a==="category"&&s&&sz(c))return c}},LA=St([us,M2,No,da],iG),oG=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:s,scale:a}=r,i=Uf(e,n);if(i&&(s==="number"||a!=="auto"))return t.map(o=>o.value)}},BA=St([us,M2,a1,da],oG),pR=St([us,J2e,o1,cp,LA,BA,l1,MA,da],(e,t,r,n,s,a,i,o,c)=>{if(t==null)return null;var u=Uf(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:a,duplicateDomain:s,isCategorical:u,niceTicks:o,range:i,realScaleType:r,scale:n}}),$Se=(e,t,r,n,s,a,i,o,c)=>{if(!(t==null||n==null)){var u=Uf(e,c),{type:d,ticks:h,tickCount:g}=t,p=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,x=d==="category"&&n.bandwidth?n.bandwidth()/p:0;x=c==="angleAxis"&&a!=null&&a.length>=2?Sl(a[0]-a[1])*2*x:x;var v=h||s;if(v){var w=v.map((C,k)=>{var b=i?i.indexOf(C):C;return{index:k,coordinate:n(b)+x,value:C,offset:x}});return w.filter(C=>!jl(C.coordinate))}return u&&o?o.map((C,k)=>({coordinate:n(C)+x,value:C,index:k,offset:x})):n.ticks?n.ticks(g).map(C=>({coordinate:n(C)+x,value:C,offset:x})):n.domain().map((C,k)=>({coordinate:n(C)+x,value:i?i[C]:C,index:k,offset:x}))}},lG=St([us,a1,o1,cp,MA,l1,LA,BA,da],$Se),USe=(e,t,r,n,s,a,i)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var o=Uf(e,i),{tickCount:c}=t,u=0;return u=i==="angleAxis"&&n?.length>=2?Sl(n[0]-n[1])*2*u:u,o&&a?a.map((d,h)=>({coordinate:r(d)+u,value:d,index:h,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,h)=>({coordinate:r(d)+u,value:s?s[d]:d,index:h,offset:u}))}},cG=St([us,a1,cp,l1,LA,BA,da],USe),uG=St(No,cp,(e,t)=>{if(!(e==null||t==null))return b_(b_({},e),{},{scale:t})}),zSe=St([No,o1,IA,nG],RA);St((e,t,r)=>FA(e,r),zSe,(e,t)=>{if(!(e==null||t==null))return b_(b_({},e),{},{scale:t})});var WSe=St([us,_2,S2],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),dG=e=>e.options.defaultTooltipEventType,fG=e=>e.options.validateTooltipEventTypes;function hG(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function $A(e,t){var r=dG(e),n=fG(e);return hG(t,r,n)}function HSe(e){return Ar(t=>$A(t,e))}var gG=(e,t)=>{var r,n=Number(t);if(!(jl(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},GSe=e=>e.tooltip.settings,cf={active:!1,index:null,dataKey:void 0,coordinate:void 0},VSe={itemInteraction:{click:cf,hover:cf},axisInteraction:{click:cf,hover:cf},keyboardInteraction:cf,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},mG=Jo({name:"tooltip",initialState:VSe,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=Xu(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:KSe,removeTooltipEntrySettings:qSe,setTooltipSettingsState:YSe,setActiveMouseOverItemIndex:XSe,mouseLeaveItem:z3e,mouseLeaveChart:pG,setActiveClickItemIndex:W3e,setMouseOverAxisIndex:xG,setMouseClickAxisIndex:QSe,setSyncInteraction:eN,setKeyboardInteraction:tN}=mG.actions,JSe=mG.reducer;function xR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function qw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xR(Object(r),!0).forEach(function(n){ZSe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZSe(e,t,r){return(t=eke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eke(e){var t=tke(e,"string");return typeof t=="symbol"?t:t+""}function tke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rke(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function nke(e){return e.index!=null}var yG=(e,t,r,n)=>{if(t==null)return cf;var s=rke(e,t,r);if(s==null)return cf;if(s.active)return s;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var a=e.settings.active===!0;if(nke(s)){if(a)return qw(qw({},s),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return qw(qw({},cf),{},{coordinate:s.coordinate})},UA=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!fc(n))return r;var s=0,a=1/0;return t.length>0&&(a=t.length-1),String(Math.max(s,Math.min(n,a)))},vG=(e,t,r,n,s,a,i,o)=>{if(!(a==null||o==null)){var c=i[0],u=c==null?void 0:o(c.positions,a);if(u!=null)return u;var d=s?.[Number(a)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}},wG=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var s;return r==="hover"?s=e.itemInteraction.hover.dataKey:s=e.itemInteraction.click.dataKey,s==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(a=>{var i;return((i=a.settings)===null||i===void 0?void 0:i.dataKey)===s})},c1=e=>e.options.tooltipPayloadSearcher,up=e=>e.tooltip;function yR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function vR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yR(Object(r),!0).forEach(function(n){ske(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ske(e,t,r){return(t=ake(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ake(e){var t=ike(e,"string");return typeof t=="symbol"?t:t+""}function ike(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oke(e,t){return e??t}var bG=(e,t,r,n,s,a,i)=>{if(!(t==null||a==null)){var{chartData:o,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,h=[];return e.reduce((g,p)=>{var x,{dataDefinedOnItem:v,settings:w}=p,C=oke(v,o),k=Array.isArray(C)?aW(C,u,d):C,b=(x=w?.dataKey)!==null&&x!==void 0?x:n,N=w?.nameKey,E;if(n&&Array.isArray(k)&&!Array.isArray(k[0])&&i==="axis"?E=az(k,n,s):E=a(k,t,c,N),Array.isArray(E))E.forEach(F=>{var A=vR(vR({},w),{},{name:F.name,unit:F.unit,color:void 0,fill:void 0});g.push(sI({tooltipEntrySettings:A,dataKey:F.dataKey,payload:F.payload,value:so(F.payload,F.dataKey),name:F.name}))});else{var P;g.push(sI({tooltipEntrySettings:w,dataKey:b,payload:E,value:so(E,b),name:(P=so(E,N))!==null&&P!==void 0?P:w?.name}))}return g},h)}},zA=St([Ga,us,jH,CA,Ca],ZH),lke=St([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),cke=St([Ca,op],PH),u1=St([lke,Ga,cke],OH),uke=St([u1],e=>e.filter(PA)),dke=St([u1],MH),dp=St([dke,Hf],LH),fke=St([uke,Hf,Ga],EH),WA=St([dp,Ga,u1],BH),hke=St([Ga],DA),gke=St([u1],e=>e.filter(PA)),mke=St([fke,gke,O2],UH),pke=St([mke,Hf,Ca],zH),xke=St([u1],IH),yke=St([dp,Ga,xke,L2,Ca],WH),vke=St([GH,Ca,op],lp),wke=St([vke,Ca],qH),bke=St([VH,Ca,op],lp),_ke=St([bke,Ca],YH),Ske=St([KH,Ca,op],lp),kke=St([Ske,Ca],XH),Cke=St([wke,kke,_ke],__),Tke=St([Ga,hke,pke,yke,Cke,us,Ca],QH),_G=St([Ga,us,dp,WA,O2,Ca,Tke],JH),Eke=St([_G,Ga,zA],eG),Nke=St([Ga,_G,Eke,Ca],tG),SG=e=>{var t=Ca(e),r=op(e),n=!1;return l1(e,t,r,n)},kG=St([Ga,SG],D2),CG=St([Ga,zA,Nke,kG],RA),Ake=St([us,WA,Ga,Ca],iG),jke=St([us,WA,Ga,Ca],oG),Pke=(e,t,r,n,s,a,i,o)=>{if(t){var{type:c}=t,u=Uf(e,o);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,h=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return h=o==="angleAxis"&&s!=null&&s?.length>=2?Sl(s[0]-s[1])*2*h:h,u&&i?i.map((g,p)=>({coordinate:n(g)+h,value:g,index:p,offset:h})):n.domain().map((g,p)=>({coordinate:n(g)+h,value:a?a[g]:g,index:p,offset:h}))}}},yd=St([us,Ga,zA,CG,SG,Ake,jke,Ca],Pke),HA=St([dG,fG,GSe],(e,t,r)=>hG(r.shared,e,t)),TG=e=>e.tooltip.settings.trigger,GA=e=>e.tooltip.settings.defaultIndex,U2=St([up,HA,TG,GA],yG),bv=St([U2,dp],UA),EG=St([yd,bv],gG),Fke=St([U2],e=>{if(e)return e.dataKey}),NG=St([up,HA,TG,GA],wG),Oke=St([hd,gd,us,mi,yd,GA,NG,c1],vG),Dke=St([U2,Oke],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Ike=St([U2],e=>e.active),Rke=St([NG,bv,Hf,TH,EG,c1,HA],bG),Mke=St([Rke],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function wR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function bR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wR(Object(r),!0).forEach(function(n){Lke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Lke(e,t,r){return(t=Bke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bke(e){var t=$ke(e,"string");return typeof t=="symbol"?t:t+""}function $ke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uke=()=>Ar(Ga),zke=()=>{var e=Uke(),t=Ar(yd),r=Ar(CG);return ME(bR(bR({},e),{},{scale:r}),t)},Wke=()=>Ar(CA),VA=(e,t)=>t,AG=(e,t,r)=>r,KA=(e,t,r,n)=>n,Hke=St(yd,e=>p2(e,t=>t.coordinate)),qA=St([up,VA,AG,KA],yG),jG=St([qA,dp],UA),Gke=(e,t,r)=>{if(t!=null){var n=up(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},PG=St([up,VA,AG,KA],wG),S_=St([hd,gd,us,mi,yd,KA,PG,c1],vG),Vke=St([qA,S_],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),FG=St(yd,jG,gG),Kke=St([PG,jG,Hf,TH,FG,c1,VA],bG),qke=St([qA],e=>({isActive:e.active,activeIndex:e.index})),Yke=(e,t,r,n,s,a,i,o)=>{if(!(!e||!t||!n||!s||!a)){var c=y1e(e.chartX,e.chartY,t,r,o);if(c){var u=w1e(c,t),d=l1e(u,i,a,n,s),h=v1e(t,a,d,c);return{activeIndex:String(d),activeCoordinate:h}}}};function rN(){return rN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rN.apply(null,arguments)}function _R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Yw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_R(Object(r),!0).forEach(function(n){Xke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_R(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xke(e,t,r){return(t=Qke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qke(e){var t=Jke(e,"string");return typeof t=="symbol"?t:t+""}function Jke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zke(e){var{coordinate:t,payload:r,index:n,offset:s,tooltipAxisBandSize:a,layout:i,cursor:o,tooltipEventType:c,chartName:u}=e,d=t,h=r,g=n;if(!o||!d||u!=="ScatterChart"&&c!=="axis")return null;var p,x;if(u==="ScatterChart")p=d,x=dwe;else if(u==="BarChart")p=fwe(i,d,s,a),x=Wwe;else if(i==="radial"){var{cx:v,cy:w,radius:C,startAngle:k,endAngle:b}=_W(d);p={cx:v,cy:w,startAngle:k,endAngle:b,innerRadius:C,outerRadius:C},x=Kwe}else p={points:qwe(i,d,s)},x=pW;var N=typeof o=="object"&&"className"in o?o.className:void 0,E=Yw(Yw(Yw(Yw({stroke:"#ccc",pointerEvents:"none"},s),p),gi(o,!1)),{},{payload:h,payloadIndex:g,className:ls("recharts-tooltip-cursor",N)});return S.isValidElement(o)?S.cloneElement(o,E):S.createElement(x,E)}function eCe(e){var t=zke(),r=dW(),n=J3(),s=Wke();return S.createElement(Zke,rN({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:s}))}var OG=S.createContext(null),tCe=()=>S.useContext(OG),GC={exports:{}},SR;function rCe(){return SR||(SR=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function a(c,u,d,h,g){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new s(d,h||c,g),x=r?r+u:u;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],p]:c._events[x].push(p):(c._events[x]=p,c._eventsCount++),c}function i(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,h;if(this._eventsCount===0)return u;for(h in d=this._events)t.call(d,h)&&u.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=r?r+u:u,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var g=0,p=h.length,x=new Array(p);g<p;g++)x[g]=h[g].fn;return x},o.prototype.listenerCount=function(u){var d=r?r+u:u,h=this._events[d];return h?h.fn?1:h.length:0},o.prototype.emit=function(u,d,h,g,p,x){var v=r?r+u:u;if(!this._events[v])return!1;var w=this._events[v],C=arguments.length,k,b;if(w.fn){switch(w.once&&this.removeListener(u,w.fn,void 0,!0),C){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,d),!0;case 3:return w.fn.call(w.context,d,h),!0;case 4:return w.fn.call(w.context,d,h,g),!0;case 5:return w.fn.call(w.context,d,h,g,p),!0;case 6:return w.fn.call(w.context,d,h,g,p,x),!0}for(b=1,k=new Array(C-1);b<C;b++)k[b-1]=arguments[b];w.fn.apply(w.context,k)}else{var N=w.length,E;for(b=0;b<N;b++)switch(w[b].once&&this.removeListener(u,w[b].fn,void 0,!0),C){case 1:w[b].fn.call(w[b].context);break;case 2:w[b].fn.call(w[b].context,d);break;case 3:w[b].fn.call(w[b].context,d,h);break;case 4:w[b].fn.call(w[b].context,d,h,g);break;default:if(!k)for(E=1,k=new Array(C-1);E<C;E++)k[E-1]=arguments[E];w[b].fn.apply(w[b].context,k)}}return!0},o.prototype.on=function(u,d,h){return a(this,u,d,h,!1)},o.prototype.once=function(u,d,h){return a(this,u,d,h,!0)},o.prototype.removeListener=function(u,d,h,g){var p=r?r+u:u;if(!this._events[p])return this;if(!d)return i(this,p),this;var x=this._events[p];if(x.fn)x.fn===d&&(!g||x.once)&&(!h||x.context===h)&&i(this,p);else{for(var v=0,w=[],C=x.length;v<C;v++)(x[v].fn!==d||g&&!x[v].once||h&&x[v].context!==h)&&w.push(x[v]);w.length?this._events[p]=w.length===1?w[0]:w:i(this,p)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&i(this,d)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(GC)),GC.exports}var nCe=rCe();const sCe=Ol(nCe);var _v=new sCe,nN="recharts.syncEvent.tooltip",kR="recharts.syncEvent.brush";function aCe(e,t){if(t){var r=Number.parseInt(t,10);if(!jl(r))return e?.[r]}}var iCe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},DG=Jo({name:"options",initialState:iCe,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),oCe=DG.reducer,{createEventEmitter:lCe}=DG.actions;function cCe(e){return e.tooltip.syncInteraction}var uCe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},IG=Jo({name:"chartData",initialState:uCe,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:CR,setDataStartEndIndexes:dCe,setComputedData:H3e}=IG.actions,fCe=IG.reducer,hCe=["x","y"];function TR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function kh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TR(Object(r),!0).forEach(function(n){gCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gCe(e,t,r){return(t=mCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mCe(e){var t=pCe(e,"string");return typeof t=="symbol"?t:t+""}function pCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xCe(e,t){if(e==null)return{};var r,n,s=yCe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function yCe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var RG=()=>{};function vCe(){var e=Ar(TA),t=Ar(EA),r=io(),n=Ar(vH),s=Ar(yd),a=J3(),i=Q3(),o=Ar(c=>c.rootProps.className);S.useEffect(()=>{if(e==null)return RG;var c=(u,d,h)=>{if(t!==h&&e===u){if(n==="index"){var g;if(i&&d!==null&&d!==void 0&&(g=d.payload)!==null&&g!==void 0&&g.coordinate){var p=d.payload.coordinate,{x,y:v}=p,w=xCe(p,hCe),C=kh(kh(kh({},w),typeof x=="number"&&{x:Math.max(i.x,Math.min(x,i.x+i.width))}),typeof v=="number"&&{y:Math.max(i.y,Math.min(v,i.y+i.height))}),k=kh(kh({},d),{},{payload:kh(kh({},d.payload),{},{coordinate:C})});r(k)}else r(d);return}if(s!=null){var b;if(typeof n=="function"){var N={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},E=n(s,N);b=s[E]}else n==="value"&&(b=s.find(Z=>String(Z.value)===d.payload.label));var{coordinate:P}=d.payload;if(b==null||d.payload.active===!1||P==null||i==null){r(eN({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:F,y:A}=P,j=Math.min(F,i.x+i.width),I=Math.min(A,i.y+i.height),B={x:a==="horizontal"?b.coordinate:j,y:a==="horizontal"?I:b.coordinate},Y=eN({active:d.payload.active,coordinate:B,dataKey:d.payload.dataKey,index:String(b.index),label:d.payload.label});r(Y)}}};return _v.on(nN,c),()=>{_v.off(nN,c)}},[o,r,t,e,n,s,a,i])}function wCe(){var e=Ar(TA),t=Ar(EA),r=io();S.useEffect(()=>{if(e==null)return RG;var n=(s,a,i)=>{t!==i&&e===s&&r(dCe(a))};return _v.on(kR,n),()=>{_v.off(kR,n)}},[r,t,e])}function bCe(){var e=io();S.useEffect(()=>{e(lCe())},[e]),vCe(),wCe()}function _Ce(e,t,r,n,s,a){var i=Ar(g=>Gke(g,e,t)),o=Ar(EA),c=Ar(TA),u=Ar(vH),d=Ar(cCe),h=d?.active;S.useEffect(()=>{if(!h&&c!=null&&o!=null){var g=eN({active:a,coordinate:r,dataKey:i,index:s,label:typeof n=="number"?String(n):n});_v.emit(nN,c,g,o)}},[h,r,i,s,n,o,c,u,a])}function ER(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function NR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ER(Object(r),!0).forEach(function(n){SCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ER(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SCe(e,t,r){return(t=kCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kCe(e){var t=CCe(e,"string");return typeof t=="symbol"?t:t+""}function CCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TCe(e){return e.dataKey}function ECe(e,t){return S.isValidElement(e)?S.cloneElement(e,t):typeof e=="function"?S.createElement(e,t):S.createElement(W1e,t)}var AR=[],NCe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!np.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function ACe(e){var t=Rl(e,NCe),{active:r,allowEscapeViewBox:n,animationDuration:s,animationEasing:a,content:i,filterNull:o,isAnimationActive:c,offset:u,payloadUniqBy:d,position:h,reverseDirection:g,useTranslate3d:p,wrapperStyle:x,cursor:v,shared:w,trigger:C,defaultIndex:k,portal:b,axisId:N}=t,E=io(),P=typeof k=="number"?String(k):k;S.useEffect(()=>{E(YSe({shared:w,trigger:C,axisId:N,active:r,defaultIndex:P}))},[E,w,C,N,r,P]);var F=Q3(),A=mW(),j=HSe(w),{activeIndex:I,isActive:B}=Ar(Q=>qke(Q,j,C,P)),Y=Ar(Q=>Kke(Q,j,C,P)),Z=Ar(Q=>FG(Q,j,C,P)),ae=Ar(Q=>Vke(Q,j,C,P)),ee=Y,ne=tCe(),L=r??B,[H,M]=Qye([ee,L]),V=j==="axis"?Z:void 0;_Ce(j,C,ae,V,I,L);var W=b??ne;if(W==null)return null;var R=ee??AR;L||(R=AR),o&&R.length&&(R=Sye(ee.filter(Q=>Q.value!=null&&(Q.hide!==!0||t.includeHidden)),d,TCe));var U=R.length>0,q=S.createElement(X1e,{allowEscapeViewBox:n,animationDuration:s,animationEasing:a,isAnimationActive:c,active:L,coordinate:ae,hasPayload:U,offset:u,position:h,reverseDirection:g,useTranslate3d:p,viewBox:F,wrapperStyle:x,lastBoundingBox:H,innerRef:M,hasPortalFromProps:!!b},ECe(i,NR(NR({},t),{},{payload:R,label:V,active:L,coordinate:ae,accessibilityLayer:A})));return S.createElement(S.Fragment,null,iT.createPortal(q,W),L&&S.createElement(eCe,{cursor:v,tooltipEventType:j,coordinate:ae,payload:ee,index:I}))}var VC={},KC={},qC={},jR;function jCe(){return jR||(jR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:s,edges:a}={}){let i,o=null;const c=a!=null&&a.includes("leading"),u=a==null||a.includes("trailing"),d=()=>{o!==null&&(r.apply(i,o),i=void 0,o=null)},h=()=>{u&&d(),v()};let g=null;const p=()=>{g!=null&&clearTimeout(g),g=setTimeout(()=>{g=null,h()},n)},x=()=>{g!==null&&(clearTimeout(g),g=null)},v=()=>{x(),i=void 0,o=null},w=()=>{d()},C=function(...k){if(s?.aborted)return;i=this,o=k;const b=g==null;p(),c&&b&&d()};return C.schedule=p,C.cancel=v,C.flush=w,s?.addEventListener("abort",v,{once:!0}),C}e.debounce=t})(qC)),qC}var PR;function PCe(){return PR||(PR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jCe();function r(n,s=0,a={}){typeof a!="object"&&(a={});const{leading:i=!1,trailing:o=!0,maxWait:c}=a,u=Array(2);i&&(u[0]="leading"),o&&(u[1]="trailing");let d,h=null;const g=t.debounce(function(...v){d=n.apply(this,v),h=null},s,{edges:u}),p=function(...v){return c!=null&&(h===null&&(h=Date.now()),Date.now()-h>=c)?(d=n.apply(this,v),h=Date.now(),g.cancel(),g.schedule(),d):(g.apply(this,v),d)},x=()=>(g.flush(),d);return p.cancel=g.cancel,p.flush=x,p}e.debounce=r})(KC)),KC}var FR;function FCe(){return FR||(FR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PCe();function r(n,s=0,a={}){const{leading:i=!0,trailing:o=!0}=a;return t.debounce(n,s,{leading:i,maxWait:s,trailing:o})}e.throttle=r})(VC)),VC}var YC,OR;function OCe(){return OR||(OR=1,YC=FCe().throttle),YC}var DCe=OCe();const ICe=Ol(DCe);var Fy=function(t,r){for(var n=arguments.length,s=new Array(n>2?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a]};function DR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function XC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DR(Object(r),!0).forEach(function(n){RCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RCe(e,t,r){return(t=MCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MCe(e){var t=LCe(e,"string");return typeof t=="symbol"?t:t+""}function LCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BCe=S.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:s="100%",height:a="100%",minWidth:i=0,minHeight:o,maxHeight:c,children:u,debounce:d=0,id:h,className:g,onResize:p,style:x={}}=e,v=S.useRef(null),w=S.useRef();w.current=p,S.useImperativeHandle(t,()=>v.current);var[C,k]=S.useState({containerWidth:n.width,containerHeight:n.height}),b=S.useCallback((E,P)=>{k(F=>{var A=Math.round(E),j=Math.round(P);return F.containerWidth===A&&F.containerHeight===j?F:{containerWidth:A,containerHeight:j}})},[]);S.useEffect(()=>{var E=j=>{var I,{width:B,height:Y}=j[0].contentRect;b(B,Y),(I=w.current)===null||I===void 0||I.call(w,B,Y)};d>0&&(E=ICe(E,d,{trailing:!0,leading:!1}));var P=new ResizeObserver(E),{width:F,height:A}=v.current.getBoundingClientRect();return b(F,A),P.observe(v.current),()=>{P.disconnect()}},[b,d]);var N=S.useMemo(()=>{var{containerWidth:E,containerHeight:P}=C;if(E<0||P<0)return null;Fy(Ih(s)||Ih(a),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,a),Fy(!r||r>0,"The aspect(%s) must be greater than zero.",r);var F=Ih(s)?E:s,A=Ih(a)?P:a;return r&&r>0&&(F?A=F/r:A&&(F=A*r),c&&A>c&&(A=c)),Fy(F>0||A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,F,A,s,a,i,o,r),S.Children.map(u,j=>S.cloneElement(j,{width:F,height:A,style:XC({width:F,height:A},j.props.style)}))},[r,u,a,c,o,i,C,s]);return S.createElement("div",{id:h?"".concat(h):void 0,className:ls("recharts-responsive-container",g),style:XC(XC({},x),{},{width:s,height:a,minWidth:i,minHeight:o,maxHeight:c}),ref:v},S.createElement("div",{style:{width:0,height:0,overflow:"visible"}},N))});function $Ce(e,t,r){return(t=UCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UCe(e){var t=zCe(e,"string");return typeof t=="symbol"?t:t+""}function zCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class WCe{constructor(t){$Ce(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function IR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function HCe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IR(Object(r),!0).forEach(function(n){GCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GCe(e,t,r){return(t=VCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VCe(e){var t=KCe(e,"string");return typeof t=="symbol"?t:t+""}function KCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qCe={cacheSize:2e3,enableCache:!0},MG=HCe({},qCe),RR=new WCe(MG.cacheSize),YCe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},MR="recharts_measurement_span";function XCe(e,t){var r=t.fontSize||"",n=t.fontFamily||"",s=t.fontWeight||"",a=t.fontStyle||"",i=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(s,"|").concat(a,"|").concat(i,"|").concat(o)}var LR=(e,t)=>{try{var r=document.getElementById(MR);r||(r=document.createElement("span"),r.setAttribute("id",MR),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,YCe,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Oy=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||np.isSsr)return{width:0,height:0};if(!MG.enableCache)return LR(t,r);var n=XCe(t,r),s=RR.get(n);if(s)return s;var a=LR(t,r);return RR.set(n,a),a},BR=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,$R=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,QCe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,JCe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,LG={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},ZCe=Object.keys(LG),rm="NaN";function eTe(e,t){return e*LG[t]}class vo{static parse(t){var r,[,n,s]=(r=JCe.exec(t))!==null&&r!==void 0?r:[];return new vo(parseFloat(n),s??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,jl(t)&&(this.unit=""),r!==""&&!QCe.test(r)&&(this.num=NaN,this.unit=""),ZCe.includes(r)&&(this.num=eTe(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new vo(NaN,""):new vo(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new vo(NaN,""):new vo(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new vo(NaN,""):new vo(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new vo(NaN,""):new vo(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return jl(this.num)}}function BG(e){if(e.includes(rm))return rm;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,s,a]=(r=BR.exec(t))!==null&&r!==void 0?r:[],i=vo.parse(n??""),o=vo.parse(a??""),c=s==="*"?i.multiply(o):i.divide(o);if(c.isNaN())return rm;t=t.replace(BR,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,h,g]=(u=$R.exec(t))!==null&&u!==void 0?u:[],p=vo.parse(d??""),x=vo.parse(g??""),v=h==="+"?p.add(x):p.subtract(x);if(v.isNaN())return rm;t=t.replace($R,v.toString())}return t}var UR=/\(([^()]*)\)/;function tTe(e){for(var t=e,r;(r=UR.exec(t))!=null;){var[,n]=r;t=t.replace(UR,BG(n))}return t}function rTe(e){var t=e.replace(/\s+/g,"");return t=tTe(t),t=BG(t),t}function nTe(e){try{return rTe(e)}catch{return rm}}function QC(e){var t=nTe(e.slice(5,-1));return t===rm?"":t}var sTe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],aTe=["dx","dy","angle","className","breakAll"];function sN(){return sN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sN.apply(null,arguments)}function zR(e,t){if(e==null)return{};var r,n,s=iTe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function iTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var $G=/[ \f\n\r\t\v\u2028\u2029]+/,UG=e=>{var{children:t,breakAll:r,style:n}=e;try{var s=[];Ua(t)||(r?s=t.toString().split(""):s=t.toString().split($G));var a=s.map(o=>({word:o,width:Oy(o,n).width})),i=r?0:Oy("",n).width;return{wordsWithComputedWidth:a,spaceWidth:i}}catch{return null}},oTe=(e,t,r,n,s)=>{var{maxLines:a,children:i,style:o,breakAll:c}=e,u=Lr(a),d=i,h=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return B.reduce((Y,Z)=>{var{word:ae,width:ee}=Z,ne=Y[Y.length-1];if(ne&&(n==null||s||ne.width+ee+r<Number(n)))ne.words.push(ae),ne.width+=ee+r;else{var L={words:[ae],width:ee};Y.push(L)}return Y},[])},g=h(t),p=I=>I.reduce((B,Y)=>B.width>Y.width?B:Y);if(!u||s)return g;var x=g.length>a||p(g).width>Number(n);if(!x)return g;for(var v="",w=I=>{var B=d.slice(0,I),Y=UG({breakAll:c,style:o,children:B+v}).wordsWithComputedWidth,Z=h(Y),ae=Z.length>a||p(Z).width>Number(n);return[ae,Z]},C=0,k=d.length-1,b=0,N;C<=k&&b<=d.length-1;){var E=Math.floor((C+k)/2),P=E-1,[F,A]=w(P),[j]=w(E);if(!F&&!j&&(C=E+1),F&&j&&(k=E-1),!F&&j){N=A;break}b++}return N||g},WR=e=>{var t=Ua(e)?[]:e.toString().split($G);return[{words:t}]},lTe=e=>{var{width:t,scaleToFit:r,children:n,style:s,breakAll:a,maxLines:i}=e;if((t||r)&&!np.isSsr){var o,c,u=UG({breakAll:a,children:n,style:s});if(u){var{wordsWithComputedWidth:d,spaceWidth:h}=u;o=d,c=h}else return WR(n);return oTe({breakAll:a,children:n,maxLines:i,style:s},o,c,t,r)}return WR(n)},HR="#808080",YA=S.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:s="1em",capHeight:a="0.71em",scaleToFit:i=!1,textAnchor:o="start",verticalAnchor:c="end",fill:u=HR}=e,d=zR(e,sTe),h=S.useMemo(()=>lTe({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:i,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,i,d.style,d.width]),{dx:g,dy:p,angle:x,className:v,breakAll:w}=d,C=zR(d,aTe);if(!Zc(r)||!Zc(n)||h.length===0)return null;var k=r+(Lr(g)?g:0),b=n+(Lr(p)?p:0),N;switch(c){case"start":N=QC("calc(".concat(a,")"));break;case"middle":N=QC("calc(".concat((h.length-1)/2," * -").concat(s," + (").concat(a," / 2))"));break;default:N=QC("calc(".concat(h.length-1," * -").concat(s,")"));break}var E=[];if(i){var P=h[0].width,{width:F}=d;E.push("scale(".concat(Lr(F)?F/P:1,")"))}return x&&E.push("rotate(".concat(x,", ").concat(k,", ").concat(b,")")),E.length&&(C.transform=E.join(" ")),S.createElement("text",sN({},gi(C,!0),{ref:t,x:k,y:b,className:ls("recharts-text",v),textAnchor:o,fill:u.includes("url")?HR:u}),h.map((A,j)=>{var I=A.words.join(w?"":" ");return S.createElement("tspan",{x:k,dy:j===0?N:s,key:"".concat(I,"-").concat(j)},I)}))});YA.displayName="Text";var cTe=["labelRef"];function uTe(e,t){if(e==null)return{};var r,n,s=dTe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function dTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function GR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function qs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GR(Object(r),!0).forEach(function(n){fTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fTe(e,t,r){return(t=hTe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hTe(e){var t=gTe(e,"string");return typeof t=="symbol"?t:t+""}function gTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uu(){return Uu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uu.apply(null,arguments)}var zG=S.createContext(null),mTe=e=>{var{x:t,y:r,width:n,height:s,children:a}=e,i=S.useMemo(()=>({x:t,y:r,width:n,height:s}),[t,r,n,s]);return S.createElement(zG.Provider,{value:i},a)},WG=()=>{var e=S.useContext(zG),t=Q3();return e||t},pTe=S.createContext(null),xTe=()=>{var e=S.useContext(pTe),t=Ar(kH);return e||t},yTe=e=>{var{value:t,formatter:r}=e,n=Ua(e.children)?t:e.children;return typeof r=="function"?r(n):n},XA=e=>e!=null&&typeof e=="function",vTe=(e,t)=>{var r=Sl(t-e),n=Math.min(Math.abs(t-e),360);return r*n},wTe=(e,t,r,n,s)=>{var{offset:a,className:i}=e,{cx:o,cy:c,innerRadius:u,outerRadius:d,startAngle:h,endAngle:g,clockWise:p}=s,x=(u+d)/2,v=vTe(h,g),w=v>=0?1:-1,C,k;switch(t){case"insideStart":C=h+w*a,k=p;break;case"insideEnd":C=g-w*a,k=!p;break;case"end":C=g+w*a,k=p;break;default:throw new Error("Unsupported position ".concat(t))}k=v<=0?k:!k;var b=di(o,c,x,C),N=di(o,c,x,C+(k?1:-1)*359),E="M".concat(b.x,",").concat(b.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(k?0:1,`,
    `).concat(N.x,",").concat(N.y),P=Ua(e.id)?fv("recharts-radial-line-"):e.id;return S.createElement("text",Uu({},n,{dominantBaseline:"central",className:ls("recharts-radial-bar-label",i)}),S.createElement("defs",null,S.createElement("path",{id:P,d:E})),S.createElement("textPath",{xlinkHref:"#".concat(P)},r))},bTe=(e,t,r)=>{var{cx:n,cy:s,innerRadius:a,outerRadius:i,startAngle:o,endAngle:c}=e,u=(o+c)/2;if(r==="outside"){var{x:d,y:h}=di(n,s,i+t,u);return{x:d,y:h,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"end"};var g=(a+i)/2,{x:p,y:x}=di(n,s,g,u);return{x:p,y:x,textAnchor:"middle",verticalAnchor:"middle"}},HG=e=>"cx"in e&&Lr(e.cx),_Te=(e,t)=>{var{parentViewBox:r,offset:n,position:s}=e,a;r!=null&&!HG(r)&&(a=r);var{x:i,y:o,width:c,height:u}=t,d=u>=0?1:-1,h=d*n,g=d>0?"end":"start",p=d>0?"start":"end",x=c>=0?1:-1,v=x*n,w=x>0?"end":"start",C=x>0?"start":"end";if(s==="top"){var k={x:i+c/2,y:o-d*n,textAnchor:"middle",verticalAnchor:g};return qs(qs({},k),a?{height:Math.max(o-a.y,0),width:c}:{})}if(s==="bottom"){var b={x:i+c/2,y:o+u+h,textAnchor:"middle",verticalAnchor:p};return qs(qs({},b),a?{height:Math.max(a.y+a.height-(o+u),0),width:c}:{})}if(s==="left"){var N={x:i-v,y:o+u/2,textAnchor:w,verticalAnchor:"middle"};return qs(qs({},N),a?{width:Math.max(N.x-a.x,0),height:u}:{})}if(s==="right"){var E={x:i+c+v,y:o+u/2,textAnchor:C,verticalAnchor:"middle"};return qs(qs({},E),a?{width:Math.max(a.x+a.width-E.x,0),height:u}:{})}var P=a?{width:c,height:u}:{};return s==="insideLeft"?qs({x:i+v,y:o+u/2,textAnchor:C,verticalAnchor:"middle"},P):s==="insideRight"?qs({x:i+c-v,y:o+u/2,textAnchor:w,verticalAnchor:"middle"},P):s==="insideTop"?qs({x:i+c/2,y:o+h,textAnchor:"middle",verticalAnchor:p},P):s==="insideBottom"?qs({x:i+c/2,y:o+u-h,textAnchor:"middle",verticalAnchor:g},P):s==="insideTopLeft"?qs({x:i+v,y:o+h,textAnchor:C,verticalAnchor:p},P):s==="insideTopRight"?qs({x:i+c-v,y:o+h,textAnchor:w,verticalAnchor:p},P):s==="insideBottomLeft"?qs({x:i+v,y:o+u-h,textAnchor:C,verticalAnchor:g},P):s==="insideBottomRight"?qs({x:i+c-v,y:o+u-h,textAnchor:w,verticalAnchor:g},P):s&&typeof s=="object"&&(Lr(s.x)||Ih(s.x))&&(Lr(s.y)||Ih(s.y))?qs({x:i+jf(s.x,c),y:o+jf(s.y,u),textAnchor:"end",verticalAnchor:"end"},P):qs({x:i+c/2,y:o+u/2,textAnchor:"middle",verticalAnchor:"middle"},P)},STe={offset:5};function lf(e){var t=Rl(e,STe),{viewBox:r,position:n,value:s,children:a,content:i,className:o="",textBreakAll:c,labelRef:u}=t,d=xTe(),h=WG(),g=n==="center"?h:d??h,p=r||g;if(!p||Ua(s)&&Ua(a)&&!S.isValidElement(i)&&typeof i!="function")return null;var x=qs(qs({},t),{},{viewBox:p});if(S.isValidElement(i)){var{labelRef:v}=x,w=uTe(x,cTe);return S.cloneElement(i,w)}var C;if(typeof i=="function"){if(C=S.createElement(i,x),S.isValidElement(C))return C}else C=yTe(t);var k=HG(p),b=gi(t,!0);if(k&&(n==="insideStart"||n==="insideEnd"||n==="end"))return wTe(t,n,C,b,p);var N=k?bTe(p,t.offset,t.position):_Te(t,p);return S.createElement(YA,Uu({ref:u,className:ls("recharts-label",o)},b,N,{breakAll:c}),C)}lf.displayName="Label";var kTe=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?S.createElement(lf,Uu({key:"label-implicit"},n)):Zc(e)?S.createElement(lf,Uu({key:"label-implicit",value:e},n)):S.isValidElement(e)?e.type===lf?S.cloneElement(e,qs({key:"label-implicit"},n)):S.createElement(lf,Uu({key:"label-implicit",content:e},n)):XA(e)?S.createElement(lf,Uu({key:"label-implicit",content:e},n)):e&&typeof e=="object"?S.createElement(lf,Uu({},e,{key:"label-implicit"},n)):null};function CTe(e){var{label:t}=e,r=WG();return kTe(t,r)||null}var JC={},ZC={},VR;function TTe(){return VR||(VR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(ZC)),ZC}var eT={},KR;function ETe(){return KR||(KR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(eT)),eT}var qR;function NTe(){return qR||(qR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TTe(),r=ETe(),n=W3();function s(a){if(n.isArrayLike(a))return t.last(r.toArray(a))}e.last=s})(JC)),JC}var tT,YR;function ATe(){return YR||(YR=1,tT=NTe().last),tT}var jTe=ATe();const PTe=Ol(jTe);var FTe=["valueAccessor"],OTe=["dataKey","clockWise","id","textBreakAll"];function k_(){return k_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k_.apply(null,arguments)}function XR(e,t){if(e==null)return{};var r,n,s=DTe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function DTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ITe=e=>Array.isArray(e.value)?PTe(e.value):e.value,GG=S.createContext(void 0),RTe=GG.Provider,VG=S.createContext(void 0);VG.Provider;function MTe(){return S.useContext(GG)}function LTe(){return S.useContext(VG)}function ob(e){var{valueAccessor:t=ITe}=e,r=XR(e,FTe),{dataKey:n,clockWise:s,id:a,textBreakAll:i}=r,o=XR(r,OTe),c=MTe(),u=LTe(),d=c||u;return!d||!d.length?null:S.createElement(rp,{className:"recharts-label-list"},d.map((h,g)=>{var p,x=Ua(n)?t(h,g):so(h&&h.payload,n),v=Ua(a)?{}:{id:"".concat(a,"-").concat(g)};return S.createElement(lf,k_({},gi(h,!0),o,v,{fill:(p=r.fill)!==null&&p!==void 0?p:h.fill,parentViewBox:h.parentViewBox,value:x,textBreakAll:i,viewBox:h.viewBox,key:"label-".concat(g),index:g}))}))}ob.displayName="LabelList";function BTe(e){var{label:t}=e;return t?t===!0?S.createElement(ob,{key:"labelList-implicit"}):S.isValidElement(t)||XA(t)?S.createElement(ob,{key:"labelList-implicit",content:t}):typeof t=="object"?S.createElement(ob,k_({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function aN(){return aN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aN.apply(null,arguments)}var KG=e=>{var{cx:t,cy:r,r:n,className:s}=e,a=ls("recharts-dot",s);return t===+t&&r===+r&&n===+n?S.createElement("circle",aN({},I0(e),U3(e),{className:a,cx:t,cy:r,r:n})):null},$Te={radiusAxis:{},angleAxis:{}},qG=Jo({name:"polarAxis",initialState:$Te,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:G3e,removeRadiusAxis:V3e,addAngleAxis:K3e,removeAngleAxis:q3e}=qG.actions,UTe=qG.reducer;function zTe(e){var{fn:t,args:r}=e,n=io(),s=Il();return S.useEffect(()=>{if(!s){var a=t(r);return n(KSe(a)),()=>{n(qSe(a))}}},[t,r,n,s]),null}var WTe=()=>{};function HTe(e){var{legendPayload:t}=e,r=io(),n=Il();return S.useEffect(()=>n?WTe:(r(R1e(t)),()=>{r(M1e(t))}),[r,n,t]),null}var rT,GTe=()=>{var[e]=S.useState(()=>fv("uid-"));return e},VTe=(rT=pM.useId)!==null&&rT!==void 0?rT:GTe;function KTe(e,t){var r=VTe();return t||(e?"".concat(e,"-").concat(r):r)}var qTe=S.createContext(void 0),YTe=e=>{var{id:t,type:r,children:n}=e,s=KTe("recharts-".concat(r),t);return S.createElement(qTe.Provider,{value:s},n(s))},XTe={cartesianItems:[],polarItems:[]},YG=Jo({name:"graphicalItems",initialState:XTe,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,s=Xu(e).cartesianItems.indexOf(r);s>-1&&(e.cartesianItems[s]=n)},removeCartesianGraphicalItem(e,t){var r=Xu(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=Xu(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:QTe,replaceCartesianGraphicalItem:JTe,removeCartesianGraphicalItem:ZTe,addPolarGraphicalItem:Y3e,removePolarGraphicalItem:X3e}=YG.actions,eEe=YG.reducer;function tEe(e){var t=io(),r=S.useRef(null);return S.useEffect(()=>{r.current===null?t(QTe(e)):r.current!==e&&t(JTe({prev:r.current,next:e})),r.current=e},[t,e]),S.useEffect(()=>()=>{r.current&&(t(ZTe(r.current)),r.current=null)},[t]),null}function QR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function JR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QR(Object(r),!0).forEach(function(n){rEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rEe(e,t,r){return(t=nEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nEe(e){var t=sEe(e,"string");return typeof t=="symbol"?t:t+""}function sEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aEe={xAxis:{},yAxis:{},zAxis:{}},XG=Jo({name:"cartesianAxis",initialState:aEe,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=JR(JR({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:iEe,removeXAxis:oEe,addYAxis:lEe,removeYAxis:cEe,addZAxis:Q3e,removeZAxis:J3e,updateYAxisWidth:uEe}=XG.actions,dEe=XG.reducer,fEe=St([mi],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),hEe=St([fEe,hd,gd],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),QA=()=>Ar(hEe),gEe=()=>Ar(Mke);function ZR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function eM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZR(Object(r),!0).forEach(function(n){mEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mEe(e,t,r){return(t=pEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pEe(e){var t=xEe(e,"string");return typeof t=="symbol"?t:t+""}function xEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yEe=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:s,dataKey:a}=e;if(s===!1||t.x==null||t.y==null)return null;var i=eM(eM({index:r,dataKey:a,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},gi(s,!1)),U3(s)),o;return S.isValidElement(s)?o=S.cloneElement(s,i):typeof s=="function"?o=s(i):o=S.createElement(KG,i),S.createElement(rp,{className:"recharts-active-dot"},o)};function vEe(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:s}=e,a=Ar(bv),i=gEe();if(t==null||i==null)return null;var o=t.find(c=>i.includes(c.payload));return Ua(o)?null:yEe({point:o,childIndex:Number(a),mainColor:r,dataKey:s,activeDot:n})}var wEe={},QG=Jo({name:"errorBars",initialState:wEe,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:s}=t.payload;e[r]&&(e[r]=e[r].map(a=>a.dataKey===n.dataKey&&a.direction===n.direction?s:a))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(s=>s.dataKey!==n.dataKey||s.direction!==n.direction))}}}),{addErrorBar:Z3e,replaceErrorBar:eAe,removeErrorBar:tAe}=QG.actions,bEe=QG.reducer,_Ee=["children"];function SEe(e,t){if(e==null)return{};var r,n,s=kEe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function kEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var CEe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},TEe=S.createContext(CEe);function EEe(e){var{children:t}=e,r=SEe(e,_Ee);return S.createElement(TEe.Provider,{value:r},t)}function JG(e,t){var r,n,s=Ar(u=>pd(u,e)),a=Ar(u=>xd(u,t)),i=(r=s?.allowDataOverflow)!==null&&r!==void 0?r:Mo.allowDataOverflow,o=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:Lo.allowDataOverflow,c=i||o;return{needClip:c,needClipX:i,needClipY:o}}function NEe(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,s=QA(),{needClipX:a,needClipY:i,needClip:o}=JG(t,r);if(!o)return null;var{x:c,y:u,width:d,height:h}=s;return S.createElement("clipPath",{id:"clipPath-".concat(n)},S.createElement("rect",{x:a?c:c-d/2,y:i?u:u-h/2,width:a?d:d*2,height:i?h:h*2}))}var AEe=e=>{var{chartData:t}=e,r=io(),n=Il();return S.useEffect(()=>n?()=>{}:(r(CR(t)),()=>{r(CR(void 0))}),[t,r,n]),null},tM={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},ZG=Jo({name:"brush",initialState:tM,reducers:{setBrushSettings(e,t){return t.payload==null?tM:t.payload}}}),{setBrushSettings:rAe}=ZG.actions,jEe=ZG.reducer;function PEe(e,t,r){return(t=FEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FEe(e){var t=OEe(e,"string");return typeof t=="symbol"?t:t+""}function OEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class JA{static create(t){return new JA(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(t)+a}default:return this.scale(t)}if(r){var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+i}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],s=r[r.length-1];return n<=s?t>=n&&t<=s:t>=s&&t<=n}}PEe(JA,"EPS",1e-4);function DEe(e){return(e%180+180)%180}var IEe=function(t){var{width:r,height:n}=t,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=DEe(s),i=a*Math.PI/180,o=Math.atan(n/r),c=i>o&&i<Math.PI-o?n/Math.sin(i):r/Math.cos(i);return Math.abs(c)},REe={dots:[],areas:[],lines:[]},eV=Jo({name:"referenceElements",initialState:REe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Xu(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Xu(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Xu(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:nAe,removeDot:sAe,addArea:aAe,removeArea:iAe,addLine:oAe,removeLine:lAe}=eV.actions,MEe=eV.reducer,LEe=S.createContext(void 0),BEe=e=>{var{children:t}=e,[r]=S.useState("".concat(fv("recharts"),"-clip")),n=QA();if(n==null)return null;var{x:s,y:a,width:i,height:o}=n;return S.createElement(LEe.Provider,{value:r},S.createElement("defs",null,S.createElement("clipPath",{id:r},S.createElement("rect",{x:s,y:a,height:o,width:i}))),t)};function Dm(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function tV(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],s=0;s<e.length;s+=t)n.push(e[s]);return n}function $Ee(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return IEe(n,r)}function UEe(e,t,r){var n=r==="width",{x:s,y:a,width:i,height:o}=e;return t===1?{start:n?s:a,end:n?s+i:a+o}:{start:n?s+i:a+o,end:n?s:a}}function C_(e,t,r,n,s){if(e*t<e*n||e*t>e*s)return!1;var a=r();return e*(t-e*a/2-n)>=0&&e*(t+e*a/2-s)<=0}function zEe(e,t){return tV(e,t+1)}function WEe(e,t,r,n,s){for(var a=(n||[]).slice(),{start:i,end:o}=t,c=0,u=1,d=i,h=function(){var x=n?.[c];if(x===void 0)return{v:tV(n,u)};var v=c,w,C=()=>(w===void 0&&(w=r(x,v)),w),k=x.coordinate,b=c===0||C_(e,k,C,d,o);b||(c=0,d=i,u+=1),b&&(d=k+e*(C()/2+s),c+=u)},g;u<=a.length;)if(g=h(),g)return g.v;return[]}function rM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ki(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rM(Object(r),!0).forEach(function(n){HEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HEe(e,t,r){return(t=GEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GEe(e){var t=VEe(e,"string");return typeof t=="symbol"?t:t+""}function VEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KEe(e,t,r,n,s){for(var a=(n||[]).slice(),i=a.length,{start:o}=t,{end:c}=t,u=function(g){var p=a[g],x,v=()=>(x===void 0&&(x=r(p,g)),x);if(g===i-1){var w=e*(p.coordinate+e*v()/2-c);a[g]=p=ki(ki({},p),{},{tickCoord:w>0?p.coordinate-w*e:p.coordinate})}else a[g]=p=ki(ki({},p),{},{tickCoord:p.coordinate});var C=C_(e,p.tickCoord,v,o,c);C&&(c=p.tickCoord-e*(v()/2+s),a[g]=ki(ki({},p),{},{isShow:!0}))},d=i-1;d>=0;d--)u(d);return a}function qEe(e,t,r,n,s,a){var i=(n||[]).slice(),o=i.length,{start:c,end:u}=t;if(a){var d=n[o-1],h=r(d,o-1),g=e*(d.coordinate+e*h/2-u);i[o-1]=d=ki(ki({},d),{},{tickCoord:g>0?d.coordinate-g*e:d.coordinate});var p=C_(e,d.tickCoord,()=>h,c,u);p&&(u=d.tickCoord-e*(h/2+s),i[o-1]=ki(ki({},d),{},{isShow:!0}))}for(var x=a?o-1:o,v=function(k){var b=i[k],N,E=()=>(N===void 0&&(N=r(b,k)),N);if(k===0){var P=e*(b.coordinate-e*E()/2-c);i[k]=b=ki(ki({},b),{},{tickCoord:P<0?b.coordinate-P*e:b.coordinate})}else i[k]=b=ki(ki({},b),{},{tickCoord:b.coordinate});var F=C_(e,b.tickCoord,E,c,u);F&&(c=b.tickCoord+e*(E()/2+s),i[k]=ki(ki({},b),{},{isShow:!0}))},w=0;w<x;w++)v(w);return i}function ZA(e,t,r){var{tick:n,ticks:s,viewBox:a,minTickGap:i,orientation:o,interval:c,tickFormatter:u,unit:d,angle:h}=e;if(!s||!s.length||!n)return[];if(Lr(c)||np.isSsr){var g;return(g=zEe(s,Lr(c)?c:0))!==null&&g!==void 0?g:[]}var p=[],x=o==="top"||o==="bottom"?"width":"height",v=d&&x==="width"?Oy(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},w=(b,N)=>{var E=typeof u=="function"?u(b.value,N):b.value;return x==="width"?$Ee(Oy(E,{fontSize:t,letterSpacing:r}),v,h):Oy(E,{fontSize:t,letterSpacing:r})[x]},C=s.length>=2?Sl(s[1].coordinate-s[0].coordinate):1,k=UEe(a,C,x);return c==="equidistantPreserveStart"?WEe(C,k,w,s,i):(c==="preserveStart"||c==="preserveStartEnd"?p=qEe(C,k,w,s,i,c==="preserveStartEnd"):p=KEe(C,k,w,s,i),p.filter(b=>b.isShow))}var YEe=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:s=0,tickMargin:a=0}=e,i=0;if(t){t.forEach(d=>{if(d){var h=d.getBoundingClientRect();h.width>i&&(i=h.width)}});var o=r?r.getBoundingClientRect().width:0,c=s+a,u=i+c+o+(r?n:0);return Math.round(u)}return 0},XEe=["axisLine","width","height","className","hide","ticks"],QEe=["viewBox"],JEe=["viewBox"];function iN(e,t){if(e==null)return{};var r,n,s=ZEe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function ZEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function _0(){return _0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_0.apply(null,arguments)}function nM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ya(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nM(Object(r),!0).forEach(function(n){eNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eNe(e,t,r){return(t=tNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tNe(e){var t=rNe(e,"string");return typeof t=="symbol"?t:t+""}function rNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ej={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function nNe(e){var{x:t,y:r,width:n,height:s,orientation:a,mirror:i,axisLine:o,otherSvgProps:c}=e;if(!o)return null;var u=ya(ya(ya({},c),gi(o,!1)),{},{fill:"none"});if(a==="top"||a==="bottom"){var d=+(a==="top"&&!i||a==="bottom"&&i);u=ya(ya({},u),{},{x1:t,y1:r+d*s,x2:t+n,y2:r+d*s})}else{var h=+(a==="left"&&!i||a==="right"&&i);u=ya(ya({},u),{},{x1:t+h*n,y1:r,x2:t+h*n,y2:r+s})}return S.createElement("line",_0({},u,{className:ls("recharts-cartesian-axis-line",h2(o,"className"))}))}function sNe(e,t,r,n,s,a,i,o,c){var u,d,h,g,p,x,v=o?-1:1,w=e.tickSize||i,C=Lr(e.tickCoord)?e.tickCoord:e.coordinate;switch(a){case"top":u=d=e.coordinate,g=r+ +!o*s,h=g-v*w,x=h-v*c,p=C;break;case"left":h=g=e.coordinate,d=t+ +!o*n,u=d-v*w,p=u-v*c,x=C;break;case"right":h=g=e.coordinate,d=t+ +o*n,u=d+v*w,p=u+v*c,x=C;break;default:u=d=e.coordinate,g=r+ +o*s,h=g+v*w,x=h+v*c,p=C;break}return{line:{x1:u,y1:h,x2:d,y2:g},tick:{x:p,y:x}}}function aNe(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function iNe(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function oNe(e){var{option:t,tickProps:r,value:n}=e,s,a=ls(r.className,"recharts-cartesian-axis-tick-value");if(S.isValidElement(t))s=S.cloneElement(t,ya(ya({},r),{},{className:a}));else if(typeof t=="function")s=t(ya(ya({},r),{},{className:a}));else{var i="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(i=ls(i,t?.className)),s=S.createElement(YA,_0({},r,{className:i}),n)}return s}function lNe(e){var{ticks:t=[],tick:r,tickLine:n,stroke:s,tickFormatter:a,unit:i,padding:o,tickTextProps:c,orientation:u,mirror:d,x:h,y:g,width:p,height:x,tickSize:v,tickMargin:w,fontSize:C,letterSpacing:k,getTicksConfig:b,events:N}=e,E=ZA(ya(ya({},b),{},{ticks:t}),C,k),P=aNe(u,d),F=iNe(u,d),A=I0(b),j=gi(r,!1),I=ya(ya({},A),{},{fill:"none"},gi(n,!1)),B=E.map((Y,Z)=>{var{line:ae,tick:ee}=sNe(Y,h,g,p,x,u,v,d,w),ne=ya(ya(ya(ya({textAnchor:P,verticalAnchor:F},A),{},{stroke:"none",fill:s},j),ee),{},{index:Z,payload:Y,visibleTicksCount:E.length,tickFormatter:a,padding:o},c);return S.createElement(rp,_0({className:"recharts-cartesian-axis-tick",key:"tick-".concat(Y.value,"-").concat(Y.coordinate,"-").concat(Y.tickCoord)},Exe(N,Y,Z)),n&&S.createElement("line",_0({},I,ae,{className:ls("recharts-cartesian-axis-tick-line",h2(n,"className"))})),r&&S.createElement(oNe,{option:r,tickProps:ne,value:"".concat(typeof a=="function"?a(Y.value,Z):Y.value).concat(i||"")}))});return B.length>0?S.createElement("g",{className:"recharts-cartesian-axis-ticks"},B):null}var cNe=S.forwardRef((e,t)=>{var{axisLine:r,width:n,height:s,className:a,hide:i,ticks:o}=e,c=iN(e,XEe),[u,d]=S.useState(""),[h,g]=S.useState(""),p=S.useRef([]);S.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var v;return YEe({ticks:p.current,label:(v=e.labelRef)===null||v===void 0?void 0:v.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var x=S.useCallback(v=>{if(v){var w=v.getElementsByClassName("recharts-cartesian-axis-tick-value");p.current=Array.from(w);var C=w[0];if(C){var k=window.getComputedStyle(C),b=k.fontSize,N=k.letterSpacing;(b!==u||N!==h)&&(d(b),g(N))}}},[u,h]);return i||n!=null&&n<=0||s!=null&&s<=0?null:S.createElement(rp,{className:ls("recharts-cartesian-axis",a),ref:x},S.createElement(nNe,{x:e.x,y:e.y,width:n,height:s,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:I0(e)}),S.createElement(lNe,{ticks:o,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:u,letterSpacing:h,getTicksConfig:e,events:c}),S.createElement(mTe,{x:e.x,y:e.y,width:e.width,height:e.height},S.createElement(CTe,{label:e.label}),e.children))}),uNe=S.memo(cNe,(e,t)=>{var{viewBox:r}=e,n=iN(e,QEe),{viewBox:s}=t,a=iN(t,JEe);return Dm(r,s)&&Dm(n,a)}),tj=S.forwardRef((e,t)=>{var r=Rl(e,ej);return S.createElement(uNe,_0({},r,{ref:t}))});tj.displayName="CartesianAxis";var dNe=["x1","y1","x2","y2","key"],fNe=["offset"],hNe=["xAxisId","yAxisId"],gNe=["xAxisId","yAxisId"];function sM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Ni(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sM(Object(r),!0).forEach(function(n){mNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mNe(e,t,r){return(t=pNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pNe(e){var t=xNe(e,"string");return typeof t=="symbol"?t:t+""}function xNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lh(){return Lh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lh.apply(null,arguments)}function T_(e,t){if(e==null)return{};var r,n,s=yNe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function yNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vNe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:s,width:a,height:i,ry:o}=e;return S.createElement("rect",{x:n,y:s,ry:o,width:a,height:i,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function rV(e,t){var r;if(S.isValidElement(e))r=S.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:s,x2:a,y2:i,key:o}=t,c=T_(t,dNe),u=I0(c),{offset:d}=u,h=T_(u,fNe);r=S.createElement("line",Lh({},h,{x1:n,y1:s,x2:a,y2:i,fill:"none",key:o}))}return r}function wNe(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:s}=e;if(!n||!s||!s.length)return null;var{xAxisId:a,yAxisId:i}=e,o=T_(e,hNe),c=s.map((u,d)=>{var h=Ni(Ni({},o),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return rV(n,h)});return S.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function bNe(e){var{y:t,height:r,vertical:n=!0,verticalPoints:s}=e;if(!n||!s||!s.length)return null;var{xAxisId:a,yAxisId:i}=e,o=T_(e,gNe),c=s.map((u,d)=>{var h=Ni(Ni({},o),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return rV(n,h)});return S.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function _Ne(e){var{horizontalFill:t,fillOpacity:r,x:n,y:s,width:a,height:i,horizontalPoints:o,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var u=o.map(h=>Math.round(h+s-s)).sort((h,g)=>h-g);s!==u[0]&&u.unshift(0);var d=u.map((h,g)=>{var p=!u[g+1],x=p?s+i-h:u[g+1]-h;if(x<=0)return null;var v=g%t.length;return S.createElement("rect",{key:"react-".concat(g),y:h,x:n,height:x,width:a,stroke:"none",fill:t[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return S.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function SNe(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:s,y:a,width:i,height:o,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(h=>Math.round(h+s-s)).sort((h,g)=>h-g);s!==u[0]&&u.unshift(0);var d=u.map((h,g)=>{var p=!u[g+1],x=p?s+i-h:u[g+1]-h;if(x<=0)return null;var v=g%r.length;return S.createElement("rect",{key:"react-".concat(g),x:h,y:a,width:x,height:o,stroke:"none",fill:r[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return S.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var kNe=(e,t)=>{var{xAxis:r,width:n,height:s,offset:a}=e;return iW(ZA(Ni(Ni(Ni({},ej),r),{},{ticks:oW(r),viewBox:{x:0,y:0,width:n,height:s}})),a.left,a.left+a.width,t)},CNe=(e,t)=>{var{yAxis:r,width:n,height:s,offset:a}=e;return iW(ZA(Ni(Ni(Ni({},ej),r),{},{ticks:oW(r),viewBox:{x:0,y:0,width:n,height:s}})),a.top,a.top+a.height,t)},TNe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function nV(e){var t=fW(),r=hW(),n=dW(),s=Ni(Ni({},Rl(e,TNe)),{},{x:Lr(e.x)?e.x:n.left,y:Lr(e.y)?e.y:n.top,width:Lr(e.width)?e.width:n.width,height:Lr(e.height)?e.height:n.height}),{xAxisId:a,yAxisId:i,x:o,y:c,width:u,height:d,syncWithTicks:h,horizontalValues:g,verticalValues:p}=s,x=Il(),v=Ar(j=>pR(j,"xAxis",a,x)),w=Ar(j=>pR(j,"yAxis",i,x));if(!Lr(u)||u<=0||!Lr(d)||d<=0||!Lr(o)||o!==+o||!Lr(c)||c!==+c)return null;var C=s.verticalCoordinatesGenerator||kNe,k=s.horizontalCoordinatesGenerator||CNe,{horizontalPoints:b,verticalPoints:N}=s;if((!b||!b.length)&&typeof k=="function"){var E=g&&g.length,P=k({yAxis:w?Ni(Ni({},w),{},{ticks:E?g:w.ticks}):void 0,width:t,height:r,offset:n},E?!0:h);Fy(Array.isArray(P),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof P,"]")),Array.isArray(P)&&(b=P)}if((!N||!N.length)&&typeof C=="function"){var F=p&&p.length,A=C({xAxis:v?Ni(Ni({},v),{},{ticks:F?p:v.ticks}):void 0,width:t,height:r,offset:n},F?!0:h);Fy(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof A,"]")),Array.isArray(A)&&(N=A)}return S.createElement("g",{className:"recharts-cartesian-grid"},S.createElement(vNe,{fill:s.fill,fillOpacity:s.fillOpacity,x:s.x,y:s.y,width:s.width,height:s.height,ry:s.ry}),S.createElement(_Ne,Lh({},s,{horizontalPoints:b})),S.createElement(SNe,Lh({},s,{verticalPoints:N})),S.createElement(wNe,Lh({},s,{offset:n,horizontalPoints:b,xAxis:v,yAxis:w})),S.createElement(bNe,Lh({},s,{offset:n,verticalPoints:N,xAxis:v,yAxis:w})))}nV.displayName="CartesianGrid";var sV=(e,t,r,n)=>uG(e,"xAxis",t,n),aV=(e,t,r,n)=>cG(e,"xAxis",t,n),iV=(e,t,r,n)=>uG(e,"yAxis",r,n),oV=(e,t,r,n)=>cG(e,"yAxis",r,n),ENe=St([us,sV,iV,aV,oV],(e,t,r,n,s)=>Uf(e,"xAxis")?ME(t,n,!1):ME(r,s,!1)),NNe=(e,t,r,n,s)=>s;function ANe(e){return e.type==="line"}var jNe=St([FH,NNe],(e,t)=>e.filter(ANe).find(r=>r.id===t)),PNe=St([us,sV,iV,aV,oV,jNe,ENe,_A],(e,t,r,n,s,a,i,o)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=o;if(!(a==null||t==null||r==null||n==null||s==null||n.length===0||s.length===0||i==null)){var{dataKey:h,data:g}=a,p;if(g!=null&&g.length>0?p=g:p=c?.slice(u,d+1),p!=null)return ZNe({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:s,dataKey:h,bandSize:i,displayedData:p})}}),FNe=["id"],ONe=["type","layout","connectNulls","needClip"],DNe=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function aM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Wo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aM(Object(r),!0).forEach(function(n){INe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function INe(e,t,r){return(t=RNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RNe(e){var t=MNe(e,"string");return typeof t=="symbol"?t:t+""}function MNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rj(e,t){if(e==null)return{};var r,n,s=LNe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function LNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function S0(){return S0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S0.apply(null,arguments)}var BNe=e=>{var{dataKey:t,name:r,stroke:n,legendType:s,hide:a}=e;return[{inactive:a,dataKey:t,type:s,color:n,value:lW(r,t),payload:e}]};function $Ne(e){var{dataKey:t,data:r,stroke:n,strokeWidth:s,fill:a,name:i,hide:o,unit:c}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:s,fill:a,dataKey:t,nameKey:void 0,name:lW(i,t),hide:o,type:e.tooltipType,color:e.stroke,unit:c}}}var lV=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function UNe(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],s=0;s<t;++s)n=[...n,...r];return n}var zNe=(e,t,r)=>{var n=r.reduce((h,g)=>h+g);if(!n)return lV(t,e);for(var s=Math.floor(e/n),a=e%n,i=t-e,o=[],c=0,u=0;c<r.length;u+=r[c],++c)if(u+r[c]>a){o=[...r.slice(0,c),a-u];break}var d=o.length%2===0?[0,i]:[i];return[...UNe(r,s),...o,...d].map(h=>"".concat(h,"px")).join(", ")};function WNe(e,t){var r;if(S.isValidElement(e))r=S.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=ls("recharts-line-dot",typeof e!="boolean"?e.className:"");r=S.createElement(KG,S0({},t,{className:n}))}return r}function HNe(e,t){return e==null?!1:t?!0:e.length===1}function GNe(e){var{clipPathId:t,points:r,props:n}=e,{dot:s,dataKey:a,needClip:i}=n;if(!HNe(r,s))return null;var{id:o}=n,c=rj(n,FNe),u=oz(s),d=I0(c),h=gi(s,!0),g=r.map((x,v)=>{var w=Wo(Wo(Wo({key:"dot-".concat(v),r:3},d),h),{},{index:v,cx:x.x,cy:x.y,dataKey:a,value:x.value,payload:x.payload,points:r});return WNe(s,w)}),p={clipPath:i?"url(#clipPath-".concat(u?"":"dots-").concat(t,")"):void 0};return S.createElement(rp,S0({className:"recharts-line-dots",key:"dots"},p),g)}function VNe(e){var{showLabels:t,children:r,points:n}=e,s=S.useMemo(()=>n?.map(a=>{var i={x:a.x,y:a.y,width:0,height:0};return Wo(Wo({},i),{},{value:a.value,payload:a.payload,viewBox:i,parentViewBox:void 0,fill:void 0})}),[n]);return S.createElement(RTe,{value:t?s:null},r)}function iM(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:s,props:a}=e,{type:i,layout:o,connectNulls:c,needClip:u}=a,d=rj(a,ONe),h=Wo(Wo({},gi(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:n,type:i,layout:o,connectNulls:c,strokeDasharray:s??a.strokeDasharray});return S.createElement(S.Fragment,null,n?.length>1&&S.createElement(pW,S0({},h,{pathRef:r})),S.createElement(GNe,{points:n,clipPathId:t,props:a}))}function KNe(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function qNe(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:s,longestAnimatedLengthRef:a}=e,{points:i,strokeDasharray:o,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:h,animateNewValues:g,width:p,height:x,onAnimationEnd:v,onAnimationStart:w}=r,C=s.current,k=bW(r,"recharts-line-"),[b,N]=S.useState(!1),E=!b,P=S.useCallback(()=>{typeof v=="function"&&v(),N(!1)},[v]),F=S.useCallback(()=>{typeof w=="function"&&w(),N(!0)},[w]),A=KNe(n.current),j=a.current;return S.createElement(VNe,{points:i,showLabels:E},r.children,S.createElement(wW,{animationId:k,begin:u,duration:d,isActive:c,easing:h,onAnimationEnd:P,onAnimationStart:F,key:k},I=>{var B=Bu(j,A+j,I),Y=Math.min(B,A),Z;if(c)if(o){var ae="".concat(o).split(/[,\s]+/gim).map(L=>parseFloat(L));Z=zNe(Y,A,ae)}else Z=lV(A,Y);else Z=o==null?void 0:String(o);if(C){var ee=C.length/i.length,ne=I===1?i:i.map((L,H)=>{var M=Math.floor(H*ee);if(C[M]){var V=C[M];return Wo(Wo({},L),{},{x:Bu(V.x,L.x,I),y:Bu(V.y,L.y,I)})}return g?Wo(Wo({},L),{},{x:Bu(p*2,L.x,I),y:Bu(x/2,L.y,I)}):Wo(Wo({},L),{},{x:L.x,y:L.y})});return s.current=ne,S.createElement(iM,{props:r,points:ne,clipPathId:t,pathRef:n,strokeDasharray:Z})}return I>0&&A>0&&(s.current=i,a.current=Y),S.createElement(iM,{props:r,points:i,clipPathId:t,pathRef:n,strokeDasharray:Z})}),S.createElement(BTe,{label:r.label}))}function YNe(e){var{clipPathId:t,props:r}=e,n=S.useRef(null),s=S.useRef(0),a=S.useRef(null);return S.createElement(qNe,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:s,pathRef:a})}var XNe=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:so(e.payload,t)});class QNe extends S.Component{render(){var t,{hide:r,dot:n,points:s,className:a,xAxisId:i,yAxisId:o,top:c,left:u,width:d,height:h,id:g,needClip:p}=this.props;if(r)return null;var x=ls("recharts-line",a),v=g,{r:w=3,strokeWidth:C=2}=(t=gi(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},k=oz(n),b=w*2+C;return S.createElement(S.Fragment,null,S.createElement(rp,{className:x},p&&S.createElement("defs",null,S.createElement(NEe,{clipPathId:v,xAxisId:i,yAxisId:o}),!k&&S.createElement("clipPath",{id:"clipPath-dots-".concat(v)},S.createElement("rect",{x:u-b/2,y:c-b/2,width:d+b,height:h+b}))),S.createElement(EEe,{xAxisId:i,yAxisId:o,data:s,dataPointFormatter:XNe,errorBarOffset:0},S.createElement(YNe,{props:this.props,clipPathId:v}))),S.createElement(vEe,{activeDot:this.props.activeDot,points:s,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var cV={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!np.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function JNe(e){var t=Rl(e,cV),{activeDot:r,animateNewValues:n,animationBegin:s,animationDuration:a,animationEasing:i,connectNulls:o,dot:c,hide:u,isAnimationActive:d,label:h,legendType:g,xAxisId:p,yAxisId:x,id:v}=t,w=rj(t,DNe),{needClip:C}=JG(p,x),k=QA(),b=J3(),N=Il(),E=Ar(I=>PNe(I,p,x,N,v));if(b!=="horizontal"&&b!=="vertical"||E==null||k==null)return null;var{height:P,width:F,x:A,y:j}=k;return S.createElement(QNe,S0({},w,{id:v,connectNulls:o,dot:c,activeDot:r,animateNewValues:n,animationBegin:s,animationDuration:a,animationEasing:i,isAnimationActive:d,hide:u,label:h,legendType:g,xAxisId:p,yAxisId:x,points:E,layout:b,height:P,width:F,left:A,top:j,needClip:C}))}function ZNe(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:s,yAxisTicks:a,dataKey:i,bandSize:o,displayedData:c}=e;return c.map((u,d)=>{var h=so(u,i);if(t==="horizontal"){var g=tI({axis:r,ticks:s,bandSize:o,entry:u,index:d}),p=Ua(h)?null:n.scale(h);return{x:g,y:p,value:h,payload:u}}var x=Ua(h)?null:r.scale(h),v=tI({axis:n,ticks:a,bandSize:o,entry:u,index:d});return x==null||v==null?null:{x,y:v,value:h,payload:u}}).filter(Boolean)}function e4e(e){var t=Rl(e,cV),r=Il();return S.createElement(YTe,{id:t.id,type:"line"},n=>S.createElement(S.Fragment,null,S.createElement(HTe,{legendPayload:BNe(t)}),S.createElement(zTe,{fn:$Ne,args:t}),S.createElement(tEe,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),S.createElement(JNe,S0({},t,{id:n}))))}var uV=S.memo(e4e);uV.displayName="Line";var t4e=["dangerouslySetInnerHTML","ticks"],r4e=["id"],n4e=["domain"],s4e=["domain"];function oN(){return oN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oN.apply(null,arguments)}function E_(e,t){if(e==null)return{};var r,n,s=a4e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function a4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function i4e(e){var t=io();return S.useEffect(()=>(t(iEe(e)),()=>{t(oEe(e))}),[e,t]),null}var o4e=e=>{var{xAxisId:t,className:r}=e,n=Ar(uW),s=Il(),a="xAxis",i=Ar(w=>cp(w,a,t,s)),o=Ar(w=>lG(w,a,t,s)),c=Ar(w=>jSe(w,t)),u=Ar(w=>RSe(w,t)),d=Ar(w=>NH(w,t));if(c==null||u==null||d==null)return null;var{dangerouslySetInnerHTML:h,ticks:g}=e,p=E_(e,t4e),{id:x}=d,v=E_(d,r4e);return S.createElement(tj,oN({},p,v,{scale:i,x:u.x,y:u.y,width:c.width,height:c.height,className:ls("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:o}))},l4e={allowDataOverflow:Mo.allowDataOverflow,allowDecimals:Mo.allowDecimals,allowDuplicatedCategory:Mo.allowDuplicatedCategory,height:Mo.height,hide:!1,mirror:Mo.mirror,orientation:Mo.orientation,padding:Mo.padding,reversed:Mo.reversed,scale:Mo.scale,tickCount:Mo.tickCount,type:Mo.type,xAxisId:0},c4e=e=>{var t,r,n,s,a,i=Rl(e,l4e);return S.createElement(S.Fragment,null,S.createElement(i4e,{interval:(t=i.interval)!==null&&t!==void 0?t:"preserveEnd",id:i.xAxisId,scale:i.scale,type:i.type,padding:i.padding,allowDataOverflow:i.allowDataOverflow,domain:i.domain,dataKey:i.dataKey,allowDuplicatedCategory:i.allowDuplicatedCategory,allowDecimals:i.allowDecimals,tickCount:i.tickCount,includeHidden:(r=i.includeHidden)!==null&&r!==void 0?r:!1,reversed:i.reversed,ticks:i.ticks,height:i.height,orientation:i.orientation,mirror:i.mirror,hide:i.hide,unit:i.unit,name:i.name,angle:(n=i.angle)!==null&&n!==void 0?n:0,minTickGap:(s=i.minTickGap)!==null&&s!==void 0?s:5,tick:(a=i.tick)!==null&&a!==void 0?a:!0,tickFormatter:i.tickFormatter}),S.createElement(o4e,i))},u4e=(e,t)=>{var{domain:r}=e,n=E_(e,n4e),{domain:s}=t,a=E_(t,s4e);return Dm(n,a)?Array.isArray(r)&&r.length===2&&Array.isArray(s)&&s.length===2?r[0]===s[0]&&r[1]===s[1]:Dm({domain:r},{domain:s}):!1},dV=S.memo(c4e,u4e);dV.displayName="XAxis";var d4e=["dangerouslySetInnerHTML","ticks"],f4e=["id"],h4e=["domain"],g4e=["domain"];function lN(){return lN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lN.apply(null,arguments)}function N_(e,t){if(e==null)return{};var r,n,s=m4e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function m4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function p4e(e){var t=io();return S.useEffect(()=>(t(lEe(e)),()=>{t(cEe(e))}),[e,t]),null}var x4e=e=>{var{yAxisId:t,className:r,width:n,label:s}=e,a=S.useRef(null),i=S.useRef(null),o=Ar(uW),c=Il(),u=io(),d="yAxis",h=Ar(E=>cp(E,d,t,c)),g=Ar(E=>BSe(E,t)),p=Ar(E=>LSe(E,t)),x=Ar(E=>lG(E,d,t,c)),v=Ar(E=>AH(E,t));if(S.useLayoutEffect(()=>{if(!(n!=="auto"||!g||XA(s)||S.isValidElement(s)||v==null)){var E=a.current;if(E){var P=E.getCalculatedWidth();Math.round(g.width)!==Math.round(P)&&u(uEe({id:t,width:P}))}}},[x,g,u,s,t,n,v]),g==null||p==null||v==null)return null;var{dangerouslySetInnerHTML:w,ticks:C}=e,k=N_(e,d4e),{id:b}=v,N=N_(v,f4e);return S.createElement(tj,lN({},k,N,{ref:a,labelRef:i,scale:h,x:p.x,y:p.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:g.width,height:g.height,className:ls("recharts-".concat(d," ").concat(d),r),viewBox:o,ticks:x}))},y4e={allowDataOverflow:Lo.allowDataOverflow,allowDecimals:Lo.allowDecimals,allowDuplicatedCategory:Lo.allowDuplicatedCategory,hide:!1,mirror:Lo.mirror,orientation:Lo.orientation,padding:Lo.padding,reversed:Lo.reversed,scale:Lo.scale,tickCount:Lo.tickCount,type:Lo.type,width:Lo.width,yAxisId:0},v4e=e=>{var t,r,n,s,a,i=Rl(e,y4e);return S.createElement(S.Fragment,null,S.createElement(p4e,{interval:(t=i.interval)!==null&&t!==void 0?t:"preserveEnd",id:i.yAxisId,scale:i.scale,type:i.type,domain:i.domain,allowDataOverflow:i.allowDataOverflow,dataKey:i.dataKey,allowDuplicatedCategory:i.allowDuplicatedCategory,allowDecimals:i.allowDecimals,tickCount:i.tickCount,padding:i.padding,includeHidden:(r=i.includeHidden)!==null&&r!==void 0?r:!1,reversed:i.reversed,ticks:i.ticks,width:i.width,orientation:i.orientation,mirror:i.mirror,hide:i.hide,unit:i.unit,name:i.name,angle:(n=i.angle)!==null&&n!==void 0?n:0,minTickGap:(s=i.minTickGap)!==null&&s!==void 0?s:5,tick:(a=i.tick)!==null&&a!==void 0?a:!0,tickFormatter:i.tickFormatter}),S.createElement(x4e,i))},w4e=(e,t)=>{var{domain:r}=e,n=N_(e,h4e),{domain:s}=t,a=N_(t,g4e);return Dm(n,a)?Array.isArray(r)&&r.length===2&&Array.isArray(s)&&s.length===2?r[0]===s[0]&&r[1]===s[1]:Dm({domain:r},{domain:s}):!1},fV=S.memo(v4e,w4e);fV.displayName="YAxis";var nT={exports:{}},sT={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oM;function b4e(){if(oM)return sT;oM=1;var e=k0();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,s=e.useRef,a=e.useEffect,i=e.useMemo,o=e.useDebugValue;return sT.useSyncExternalStoreWithSelector=function(c,u,d,h,g){var p=s(null);if(p.current===null){var x={hasValue:!1,value:null};p.current=x}else x=p.current;p=i(function(){function w(E){if(!C){if(C=!0,k=E,E=h(E),g!==void 0&&x.hasValue){var P=x.value;if(g(P,E))return b=P}return b=E}if(P=b,r(k,E))return P;var F=h(E);return g!==void 0&&g(P,F)?(k=E,P):(k=E,b=F)}var C=!1,k,b,N=d===void 0?null:d;return[function(){return w(u())},N===null?void 0:function(){return w(N())}]},[u,d,h,g]);var v=n(c,p[0],p[1]);return a(function(){x.hasValue=!0,x.value=v},[v]),o(v),v},sT}var lM;function _4e(){return lM||(lM=1,nT.exports=b4e()),nT.exports}_4e();function S4e(e){e()}function k4e(){let e=null,t=null;return{clear(){e=null,t=null},notify(){S4e(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const s=t={callback:r,next:null,prev:t};return s.prev?s.prev.next=s:e=s,function(){!n||e===null||(n=!1,s.next?s.next.prev=s.prev:t=s.prev,s.prev?s.prev.next=s.next:e=s.next)}}}}var cM={notify(){},get:()=>[]};function C4e(e,t){let r,n=cM,s=0,a=!1;function i(v){d();const w=n.subscribe(v);let C=!1;return()=>{C||(C=!0,w(),h())}}function o(){n.notify()}function c(){x.onStateChange&&x.onStateChange()}function u(){return a}function d(){s++,r||(r=e.subscribe(c),n=k4e())}function h(){s--,r&&s===0&&(r(),r=void 0,n.clear(),n=cM)}function g(){a||(a=!0,d())}function p(){a&&(a=!1,h())}const x={addNestedSub:i,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:u,trySubscribe:g,tryUnsubscribe:p,getListeners:()=>n};return x}var T4e=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",E4e=T4e(),N4e=()=>typeof navigator<"u"&&navigator.product==="ReactNative",A4e=N4e(),j4e=()=>E4e||A4e?S.useLayoutEffect:S.useEffect,P4e=j4e(),F4e=Symbol.for("react-redux-context"),O4e=typeof globalThis<"u"?globalThis:{};function D4e(){if(!S.createContext)return{};const e=O4e[F4e]??=new Map;let t=e.get(S.createContext);return t||(t=S.createContext(null),e.set(S.createContext,t)),t}var I4e=D4e();function R4e(e){const{children:t,context:r,serverState:n,store:s}=e,a=S.useMemo(()=>{const c=C4e(s);return{store:s,subscription:c,getServerState:n?()=>n:void 0}},[s,n]),i=S.useMemo(()=>s.getState(),[s]);P4e(()=>{const{subscription:c}=a;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),i!==s.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[a,i]);const o=r||I4e;return S.createElement(o.Provider,{value:a},t)}var M4e=R4e,L4e=(e,t)=>t,nj=St([L4e,us,kH,Ca,kG,yd,Hke,mi],Yke),sj=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},hV=Pl("mouseClick"),gV=Zv();gV.startListening({actionCreator:hV,effect:(e,t)=>{var r=e.payload,n=nj(t.getState(),sj(r));n?.activeIndex!=null&&t.dispatch(QSe({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var cN=Pl("mouseMove"),mV=Zv();mV.startListening({actionCreator:cN,effect:(e,t)=>{var r=e.payload,n=t.getState(),s=$A(n,n.tooltip.settings.shared),a=nj(n,sj(r));s==="axis"&&(a?.activeIndex!=null?t.dispatch(xG({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate})):t.dispatch(pG()))}});var uM={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},pV=Jo({name:"rootProps",initialState:uM,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:uM.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),B4e=pV.reducer,{updateOptions:$4e}=pV.actions,xV=Jo({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:cAe}=xV.actions,U4e=xV.reducer,yV=Pl("keyDown"),vV=Pl("focus"),aj=Zv();aj.startListening({actionCreator:yV,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:s}=r.tooltip,a=e.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var i=Number(UA(s,dp(r))),o=yd(r);if(a==="Enter"){var c=S_(r,"axis","hover",String(s.index));t.dispatch(tN({active:!s.active,activeIndex:s.index,activeDataKey:s.dataKey,activeCoordinate:c}));return}var u=WSe(r),d=u==="left-to-right"?1:-1,h=a==="ArrowRight"?1:-1,g=i+h*d;if(!(o==null||g>=o.length||g<0)){var p=S_(r,"axis","hover",String(g));t.dispatch(tN({active:!0,activeIndex:g.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}});aj.startListening({actionCreator:vV,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:s}=r.tooltip;if(!s.active&&s.index==null){var a="0",i=S_(r,"axis","hover",String(a));t.dispatch(tN({activeDataKey:void 0,active:!0,activeIndex:a,activeCoordinate:i}))}}}});var pl=Pl("externalEvent"),wV=Zv();wV.startListening({actionCreator:pl,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:Dke(r),activeDataKey:Fke(r),activeIndex:bv(r),activeLabel:EG(r),activeTooltipIndex:bv(r),isTooltipActive:Ike(r)};e.payload.handler(n,e.payload.reactEvent)}}});var z4e=St([up],e=>e.tooltipItemPayloads),W4e=St([z4e,c1,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var s=e.find(o=>o.settings.dataKey===n);if(s!=null){var{positions:a}=s;if(a!=null){var i=t(a,r);return i}}}),bV=Pl("touchMove"),_V=Zv();_V.startListening({actionCreator:bV,effect:(e,t)=>{var r=e.payload,n=t.getState(),s=$A(n,n.tooltip.settings.shared);if(s==="axis"){var a=nj(n,sj({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));a?.activeIndex!=null&&t.dispatch(xG({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if(s==="item"){var i,o=r.touches[0],c=document.elementFromPoint(o.clientX,o.clientY);if(!c||!c.getAttribute)return;var u=c.getAttribute(_1e),d=(i=c.getAttribute(S1e))!==null&&i!==void 0?i:void 0,h=W4e(t.getState(),u,d);t.dispatch(XSe({activeDataKey:d,activeIndex:u,activeCoordinate:h}))}}});var H4e=Rz({brush:jEe,cartesianAxis:dEe,chartData:fCe,errorBars:bEe,graphicalItems:eEe,layout:qve,legend:L1e,options:oCe,polarAxis:UTe,polarOptions:U4e,referenceElements:MEe,rootProps:B4e,tooltip:JSe}),G4e=function(t){return vve({reducer:H4e,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([gV.middleware,mV.middleware,aj.middleware,wV.middleware,_V.middleware]),devTools:np.devToolsEnabled})};function V4e(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,s=Il(),a=S.useRef(null);if(s)return r;a.current==null&&(a.current=G4e(t));var i=G3;return S.createElement(M4e,{context:i,store:a.current},r)}function K4e(e){var{layout:t,width:r,height:n,margin:s}=e,a=io(),i=Il();return S.useEffect(()=>{i||(a(Gve(t)),a(Vve({width:r,height:n})),a(Hve(s)))},[a,i,t,r,n,s]),null}function q4e(e){var t=io();return S.useEffect(()=>{t($4e(e))},[t,e]),null}var Y4e=["children"];function X4e(e,t){if(e==null)return{};var r,n,s=Q4e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function Q4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function A_(){return A_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},A_.apply(null,arguments)}var J4e={width:"100%",height:"100%"},Z4e=S.forwardRef((e,t)=>{var r=fW(),n=hW(),s=mW();if(!o_(r)||!o_(n))return null;var{children:a,otherAttributes:i,title:o,desc:c}=e,u,d;return typeof i.tabIndex=="number"?u=i.tabIndex:u=s?0:void 0,typeof i.role=="string"?d=i.role:d=s?"application":void 0,S.createElement(lz,A_({},i,{title:o,desc:c,role:d,tabIndex:u,width:r,height:n,style:J4e,ref:t}),a)}),e3e=e=>{var{children:t}=e,r=Ar(C2);if(!r)return null;var{width:n,height:s,y:a,x:i}=r;return S.createElement(lz,{width:n,height:s,x:i,y:a},t)},dM=S.forwardRef((e,t)=>{var{children:r}=e,n=X4e(e,Y4e),s=Il();return s?S.createElement(e3e,null,r):S.createElement(Z4e,A_({ref:t},n),r)});function t3e(){var e=io(),[t,r]=S.useState(null),n=Ar(b1e);return S.useEffect(()=>{if(t!=null){var s=t.getBoundingClientRect(),a=s.width/t.offsetWidth;fc(a)&&a!==n&&e(Kve(a))}},[t,e,n]),r}function fM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function r3e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fM(Object(r),!0).forEach(function(n){n3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n3e(e,t,r){return(t=s3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s3e(e){var t=a3e(e,"string");return typeof t=="symbol"?t:t+""}function a3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i3e=S.forwardRef((e,t)=>{var{children:r,className:n,height:s,onClick:a,onContextMenu:i,onDoubleClick:o,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:h,onMouseUp:g,onTouchEnd:p,onTouchMove:x,onTouchStart:v,style:w,width:C}=e,k=io(),[b,N]=S.useState(null),[E,P]=S.useState(null);bCe();var F=t3e(),A=S.useCallback(R=>{F(R),typeof t=="function"&&t(R),N(R),P(R)},[F,t,N,P]),j=S.useCallback(R=>{k(hV(R)),k(pl({handler:a,reactEvent:R}))},[k,a]),I=S.useCallback(R=>{k(cN(R)),k(pl({handler:u,reactEvent:R}))},[k,u]),B=S.useCallback(R=>{k(pG()),k(pl({handler:d,reactEvent:R}))},[k,d]),Y=S.useCallback(R=>{k(cN(R)),k(pl({handler:h,reactEvent:R}))},[k,h]),Z=S.useCallback(()=>{k(vV())},[k]),ae=S.useCallback(R=>{k(yV(R.key))},[k]),ee=S.useCallback(R=>{k(pl({handler:i,reactEvent:R}))},[k,i]),ne=S.useCallback(R=>{k(pl({handler:o,reactEvent:R}))},[k,o]),L=S.useCallback(R=>{k(pl({handler:c,reactEvent:R}))},[k,c]),H=S.useCallback(R=>{k(pl({handler:g,reactEvent:R}))},[k,g]),M=S.useCallback(R=>{k(pl({handler:v,reactEvent:R}))},[k,v]),V=S.useCallback(R=>{k(bV(R)),k(pl({handler:x,reactEvent:R}))},[k,x]),W=S.useCallback(R=>{k(pl({handler:p,reactEvent:R}))},[k,p]);return S.createElement(OG.Provider,{value:b},S.createElement(Rxe.Provider,{value:E},S.createElement("div",{className:ls("recharts-wrapper",n),style:r3e({position:"relative",cursor:"default",width:C,height:s},w),onClick:j,onContextMenu:ee,onDoubleClick:ne,onFocus:Z,onKeyDown:ae,onMouseDown:L,onMouseEnter:I,onMouseLeave:B,onMouseMove:Y,onMouseUp:H,onTouchEnd:W,onTouchMove:V,onTouchStart:M,ref:A},r)))}),o3e=["children","className","width","height","style","compact","title","desc"];function l3e(e,t){if(e==null)return{};var r,n,s=c3e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function c3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var u3e=S.forwardRef((e,t)=>{var{children:r,className:n,width:s,height:a,style:i,compact:o,title:c,desc:u}=e,d=l3e(e,o3e),h=I0(d);return o?S.createElement(dM,{otherAttributes:h,title:c,desc:u},r):S.createElement(i3e,{className:n,style:i,width:s,height:a,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},S.createElement(dM,{otherAttributes:h,title:c,desc:u,ref:t},S.createElement(BEe,null,r)))}),d3e=["width","height"];function uN(){return uN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uN.apply(null,arguments)}function f3e(e,t){if(e==null)return{};var r,n,s=h3e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function h3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var g3e={top:5,right:5,bottom:5,left:5},m3e={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:g3e,reverseStackOrder:!1,syncMethod:"index"},p3e=S.forwardRef(function(t,r){var n,s=Rl(t.categoricalChartProps,m3e),{width:a,height:i}=s,o=f3e(s,d3e);if(!o_(a)||!o_(i))return null;var{chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:h,categoricalChartProps:g}=t,p={chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:h,eventEmitter:void 0};return S.createElement(V4e,{preloadedState:{options:p},reduxStoreName:(n=g.id)!==null&&n!==void 0?n:c},S.createElement(AEe,{chartData:g.data}),S.createElement(K4e,{width:a,height:i,layout:s.layout,margin:s.margin}),S.createElement(q4e,{accessibilityLayer:s.accessibilityLayer,barCategoryGap:s.barCategoryGap,maxBarSize:s.maxBarSize,stackOffset:s.stackOffset,barGap:s.barGap,barSize:s.barSize,syncId:s.syncId,syncMethod:s.syncMethod,className:s.className}),S.createElement(u3e,uN({},o,{width:a,height:i,ref:r})))}),x3e=["axis"],y3e=S.forwardRef((e,t)=>S.createElement(p3e,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:x3e,tooltipPayloadSearcher:aCe,categoricalChartProps:e,ref:t}));const v3e=({data:e=[],loading:t=!1,error:r=null})=>{if(t)return l.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"400px"},children:l.jsx("div",{className:"spinner-border text-primary",role:"status",children:l.jsx("span",{className:"visually-hidden",children:"Loading..."})})});if(r)return l.jsxs("div",{className:"alert alert-danger",role:"alert",children:[l.jsx("h5",{className:"alert-heading",children:"Error Loading Performance Data"}),l.jsx("p",{children:r})]});if(!e||e.length===0)return l.jsx("div",{className:"text-center text-muted",style:{height:"400px",display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsxs("div",{children:[l.jsx("h5",{children:"No Test Data Available"}),l.jsx("p",{children:"No tests have been completed yet for the current term."})]})});const n=e.map(s=>({testName:s.test_name,testDate:s.submitted_at,averageScore:parseFloat(s.average_score),totalStudents:s.total_students,testId:s.test_id}));return l.jsxs("div",{className:"test-performance-graph",children:[l.jsx("div",{style:{width:"100%",height:"400px"},children:l.jsx(BCe,{children:l.jsxs(y3e,{data:n,margin:{top:20,right:30,left:20,bottom:20},children:[l.jsx(nV,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),l.jsx(dV,{dataKey:"testDate",tickFormatter:s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric"}),stroke:"#666",fontSize:12}),l.jsx(fV,{domain:[0,100],tickFormatter:s=>`${s}%`,stroke:"#666",fontSize:12}),l.jsx(ACe,{formatter:(s,a)=>[`${parseFloat(s).toFixed(1)}%`,"Average Score"],labelFormatter:s=>{const a=n.find(i=>i.testDate===s);if(a){const i=new Date(s);return`${a.testName} (${i.toLocaleDateString("en-US",{month:"long",day:"numeric"})})`}return s},contentStyle:{backgroundColor:"#fff",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),l.jsx(uV,{type:"monotone",dataKey:"averageScore",stroke:"#007bff",strokeWidth:3,connectNulls:!0,dot:{r:6,fill:"#007bff",stroke:"#fff",strokeWidth:2},activeDot:{r:8,fill:"#ff6b35",stroke:"#fff",strokeWidth:2}})]})})}),l.jsx("div",{className:"mt-3",children:l.jsxs("div",{className:"row",children:[l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Total Tests: "}),l.jsx("strong",{children:n.length})]})}),l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Average Score: "}),l.jsx("strong",{children:n.length>0?(()=>{const s=n.filter(i=>i.averageScore!==null&&i.averageScore!==void 0&&!isNaN(i.averageScore));return s.length===0?"N/A":`${(s.reduce((i,o)=>i+o.averageScore,0)/s.length).toFixed(1)}%`})():"N/A"})]})}),l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Best Test: "}),l.jsx("strong",{children:n.length>0?(()=>{const s=n.filter(a=>a.averageScore!==null&&a.averageScore!==void 0&&!isNaN(a.averageScore));return s.length===0?"N/A":s.reduce((a,i)=>i.averageScore>a.averageScore?i:a).testName})():"N/A"})]})}),l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Latest Test: "}),l.jsx("strong",{children:n.length>0?n[n.length-1].testName:"N/A"})]})})]})})]})},hM=({onBackToLogin:e})=>{const t=Eo(),{user:r,isAuthenticated:n,logout:s,getCurrentTeacherUsername:a}=cs(),{teacherData:i,loadTeacherData:o}=r2(),{activeTests:c,loadActiveTests:u}=zv(),{showNotification:d,notifications:h}=za(),[g,p]=S.useState(!0),[x,v]=S.useState(""),[w,C]=S.useState("main"),[k,b]=S.useState([]),[N,E]=S.useState([]),[P,F]=S.useState(null),[A,j]=S.useState(null),[I,B]=S.useState(null),[Y,Z]=S.useState(!1),[ae,ee]=S.useState(!1),[ne,L]=S.useState(null),[H,M]=S.useState(!1),[V,W]=S.useState(null),[R,U]=S.useState(!1),[q,Q]=S.useState(null),[se,X]=S.useState(null),[ie,le]=S.useState([]),[ce,Se]=S.useState(!1),[re,ge]=S.useState(null),[Ee,Ae]=S.useState([]),[He,Be]=S.useState(!1),[Rt,et]=S.useState(null),[vt,xt]=S.useState(null),[it,ht]=S.useState(!1),[Dt,Mt]=S.useState(!1),[Xe,De]=S.useState(0),[Le,lt]=S.useState(!1),[Ue,tt]=S.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[Et,At]=S.useState([]),[qt,pr]=S.useState([]),[Rr,Kr]=S.useState(!1),[ur,ir]=S.useState(!1),[me,Ne]=S.useState(null),[Pe,Re]=S.useState([]),[Ct,Fe]=S.useState(!1),[st,ke]=S.useState("subject");S.useEffect(()=>{qr()},[]),S.useEffect(()=>{const Me=Tt=>{it&&!Tt.target.closest(".relative")&&ht(!1),Dt&&!Tt.target.closest(".relative")&&Mt(!1)};return document.addEventListener("mousedown",Me),()=>{document.removeEventListener("mousedown",Me)}},[it,Dt]);const We=S.useCallback(()=>{pe.debug(" showChangePasswordTab called"),lt(!0),ht(!1),Mt(!1)},[]),Qe=S.useCallback(()=>{pe.debug(" hideChangePasswordTab called"),lt(!1),tt({currentPassword:"",newPassword:"",confirmPassword:""})},[]),Pt=S.useCallback(async()=>{if(!r)return;const{currentPassword:Me,newPassword:Tt,confirmPassword:Gt}=Ue;if(!Me||!Tt||!Gt){d("Please fill in all fields","error");return}if(Tt!==Gt){d("New passwords do not match","error");return}if(Tt.length<6){d("New password must be at least 6 characters long","error");return}const ar=/[a-zA-Z]/.test(Tt),es=/[0-9]/.test(Tt);if(!ar||!es){d("New password must contain both letters and numbers","error");return}try{const Kn=await hs.changePassword({username:r.username,currentPassword:Me,newPassword:Tt});Kn.success?(d("Password changed successfully!","success"),Qe()):d(Kn.message||"Failed to change password","error")}catch(Kn){pe.error("Password change error:",Kn),d("Failed to change password. Please try again.","error")}},[r,Ue,d]),zt=S.useCallback(Me=>{const{name:Tt,value:Gt}=Me.target;tt(ar=>({...ar,[Tt]:Gt}))},[]),rr=S.useCallback(async()=>{pe.debug(" Loading teacher data...");try{const Me=await hs.getTeacherData();return pe.debug(" Teacher data loaded:",Me),X(new Date),Me}catch(Me){throw pe.error(" Error loading teacher data:",Me),Me}},[]),xr=S.useCallback(async(Me=null)=>{pe.debug(" Loading teacher subjects...");try{if(!Me){const ar=`teacher_subjects_${r?.teacher_id||r?.id||""}`,es=Rs(ar);if(es)return pe.debug(" Using cached teacher subjects"),b(es),es}let Tt=Me,Gt;if(Me?(pe.debug(" Using passed teacher data for subjects"),Gt=hs.getTeacherSubjects(Me.subjects)):(pe.debug(" No teacher data passed, fetching from API"),Tt=await hs.getTeacherData(),pe.debug(" Raw teacher data:",Tt),Gt=hs.getTeacherSubjects(Tt.subjects)),pe.debug(" Teacher subjects loaded:",Gt),b(Gt),!Me){const ar=`teacher_subjects_${r?.teacher_id||r?.id||""}`;vs(ar,Gt,Is.teacher_subjects)}return pe.debug(" Available classes for performance chart:",Gt[0]?.classes||[]),pe.debug(" Performance chart will load when user clicks on a class"),Gt}catch(Tt){throw pe.error(" Error loading teacher subjects:",Tt),Tt}},[r?.teacher_id,r?.id]),cr=S.useCallback(async()=>{pe.debug(" Loading teacher active tests...");try{const Me=`teacher_tests_${r?.teacher_id||r?.id||""}`,Tt=Rs(Me);Tt&&Tt.some(es=>es.test_type==="drawing")&&(pe.debug(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(Me));const Gt=Rs(Me);if(Gt)return pe.debug(" Using cached teacher tests"),E(Gt),Gt;const ar=await hn.getTeacherTests();return pe.debug(" Teacher tests loaded:",ar),E(ar),vs(Me,ar,Is.teacher_tests),ar}catch(Me){throw pe.error(" Error loading teacher tests:",Me),Me}},[r?.teacher_id,r?.id]),qr=S.useCallback(async()=>{pe.debug(" Initializing Teacher Cabinet...");try{if(p(!0),v(""),!n||!r){pe.debug(" User not authenticated"),v("User not authenticated");return}if(r.role!==Ji.TEACHER){pe.error(" Invalid user role for teacher cabinet:",r.role),v("Access denied. Teacher role required.");return}pe.debug(" Loading teacher data...");const Me=await rr();pe.debug(" Loading subjects and tests in parallel...");const[Tt,Gt]=await Promise.allSettled([xr(Me),cr()]);let ar=!1;Tt.status==="rejected"&&(pe.warn(" Subjects loading failed:",Tt.reason),ar=!0),Gt.status==="rejected"&&(pe.warn(" Tests loading failed:",Gt.reason),ar=!0),ar&&d("Some data failed to load, but you can continue","warning"),pe.debug(" Teacher Cabinet initialization complete!")}catch(Me){pe.error(" Error initializing teacher cabinet:",Me),v("Failed to initialize teacher cabinet")}finally{p(!1)}},[n,r,rr,xr,cr,d]),ue=S.useCallback(()=>{pe.debug(" Showing subject selection prompt..."),Z(!0),we(),ke("subject")},[]),we=S.useCallback(async()=>{pe.debug(" Loading available subjects..."),Kr(!0);try{const Me=await hs.getSubjectsForSelection();At(Me),pe.debug(" Available subjects loaded:",Me)}catch(Me){pe.error(" Error loading available subjects:",Me),d("Failed to load subjects","error")}finally{Kr(!1)}},[]),ye=S.useCallback(Me=>{if(!Me){Ne(null);return}const Tt=Et.find(Gt=>Gt.subject_id==Me);Tt&&(Ne(Tt),Re([]),ke("classes"))},[Et]),xe=S.useCallback((Me,Tt)=>{Re(Gt=>Gt.some(ar=>ar.grade===Me&&ar.class===Tt)?Gt.filter(ar=>!(ar.grade===Me&&ar.class===Tt)):[...Gt,{grade:Me,class:Tt}])},[]),be=S.useCallback(()=>{if(!me||Pe.length===0){d("Please select at least one class","warning");return}const Me={subject_id:parseInt(me.subject_id),subject_name:me.subject,classes:Pe};pr(Tt=>[...Tt,Me]),Ne(null),Re([]),ke("subject"),d(`Added ${me.subject} with ${Pe.length} classes`,"success")},[me,Pe]),_e=S.useCallback(Me=>{pr(Tt=>Tt.filter((Gt,ar)=>ar!==Me))},[]),Ge=S.useCallback(async(Me,Tt,Gt)=>{pe.debug(" Deleting teacher subject:",{subjectId:Me,grade:Tt,classNumber:Gt});try{const ar={subjectId:Me,grade:Tt,class:Gt};pe.debug(" Sending delete request with data:",ar);const es=await hs.deleteTeacherSubject(ar);if(es.success)d("Subject assignment deleted successfully!","success"),await xr();else throw new Error(es.error||"Failed to delete subject assignment")}catch(ar){pe.error(" Error deleting subject assignment:",ar),d("Error deleting subject assignment. Please try again.","error")}},[xr,d]),ut=S.useCallback((Me,Tt,Gt,ar)=>{Q({subjectId:Me,subjectName:Tt,grade:Gt,classNumber:ar}),U(!0)},[]),qe=S.useCallback(async()=>{q&&(await Ge(q.subjectId,q.grade,q.classNumber),U(!1),Q(null))},[q,Ge]),oe=S.useCallback(()=>{U(!1),Q(null)},[]),he=S.useCallback(async()=>{if(qt.length===0){d("Please select at least one subject","warning");return}ir(!0);try{const Me=await hs.saveTeacherSubjects(qt);if(Me.success)d("Subjects saved successfully!","success"),Z(!1),pr([]),ke("subject"),await xr();else throw new Error(Me.error||"Failed to save subjects")}catch(Me){pe.error(" Error saving teacher subjects:",Me),d("Failed to save subjects","error")}finally{ir(!1)}},[qt,xr]);S.useCallback(async Me=>{pe.debug(" Saving teacher subjects:",Me);try{const Tt=await hs.saveTeacherSubjects(Me);if(Tt.success)d("Subjects saved successfully!","success"),await xr(),Z(!1);else throw new Error(Tt.error||"Failed to save subjects")}catch(Tt){pe.error(" Error saving teacher subjects:",Tt),d("Failed to save subjects","error")}},[xr]);const Te=S.useCallback(()=>{pe.debug(" Showing active tests..."),C("tests")},[]),Ce=S.useCallback(Me=>{pe.debug(" Showing test details:",Me),L(Me),ee(!0)},[]);S.useCallback(async(Me,Tt,Gt)=>{pe.debug(" Removing class assignment:",Me,Tt,Gt);try{const ar=await hn.removeClassAssignment(Me,Tt,Gt);if(ar.success)d("Assignment removed successfully!","success"),await cr();else throw new Error(ar.error||"Failed to remove assignment")}catch(ar){pe.error(" Error removing class assignment:",ar),d("Failed to remove assignment","error")}},[cr]);const Ke=S.useCallback(async(Me,Tt)=>{pe.debug(" Marking test as completed:",Me,Tt),ge(Tt);try{const Gt=await hn.markTestCompleted(Me,Tt);if(Gt.success){d("Test marked as completed!","success");const ar=`teacher_tests_${r?.teacher_id||r?.id||""}`;localStorage.removeItem(ar),pe.debug(" Cleared teacher tests cache"),await cr()}else throw new Error(Gt.error||"Failed to mark test as completed")}catch(Gt){pe.error(" Error marking test as completed:",Gt),d("Failed to mark test as completed","error")}finally{ge(null)}},[cr,d,r?.teacher_id,r?.id]),ot=S.useCallback(async()=>{pe.debug(" Refreshing active tests data...");try{const Me=`teacher_tests_${r?.teacher_id||r?.id||""}`;localStorage.removeItem(Me),pe.debug(" Cache cleared, forcing fresh API call"),pe.debug(" Making direct API call to get-teacher-active-tests with noCache");const Tt=await hn.getTeacherTests(!0);pe.debug(" Direct API call returned:",Tt),E(Tt),pe.debug(" activeTestsData state updated:",Tt),d(`Tests refreshed successfully! Found ${Tt?.length||0} tests.`,"success")}catch(Me){pe.error(" Error refreshing tests:",Me),d("Failed to refresh tests","error")}},[r?.teacher_id,r?.id]),mt=S.useCallback(async(Me=null)=>{if(r?.teacher_id){Be(!0),et(null);try{pe.debug(" Loading test performance data for class:",Me);const Tt=await xxe.getTestPerformance(r.teacher_id,Me);Ae(Tt),pe.debug(" Test performance data loaded:",Tt.length,"tests")}catch(Tt){pe.error(" Error loading test performance data:",Tt),et(Tt.message)}finally{Be(!1)}}},[r?.teacher_id]);S.useCallback((Me,Tt)=>{pe.debug(" Showing class results:",Me,Tt),pe.debug(" Class click - grade:",Me,"className:",Tt),j(Me),B(Tt),C("results");const Gt=`${Me}/${Tt}`;pe.debug(" Loading performance data for clicked class:",Gt),xt(Gt),mt(Gt)},[mt]);const[Wt,pt]=S.useState([]),[Yt,vr]=S.useState([]),_r=S.useCallback(async()=>{try{const Tt=await(await Zi(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestAssignments(r.teacher_id);pt(Tt)}catch(Me){pe.warn("Failed to load retests",Me)}},[r]);S.useCallback(async Me=>{try{const Gt=await(await Zi(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestTargets(Me);vr(Gt)}catch(Tt){pe.warn("Failed to load retest targets",Tt)}},[]);const[gr,Fr]=S.useState(!1),[rn,Qr]=S.useState(!1);S.useEffect(()=>{pe.debug("[TeacherCabinet] showRetestModal state changed:",gr)},[gr]);const[fe,wt]=S.useState({test_type:"",original_test_id:"",subject_id:"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:[]}),Sr=S.useCallback(async Me=>{pe.debug("[TeacherCabinet] openRetestModal called with:",Me);const{test_type:Tt,original_test_id:Gt,subject_id:ar,failedStudentIds:es=[],grade:Kn,class:Mi}=Me||{};wt({test_type:Tt||"multiple_choice",original_test_id:Gt||"",subject_id:ar||"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:es}),Kn!==void 0&&j(Kn),Mi!==void 0&&B(Mi),pe.debug("[TeacherCabinet] Setting showRetestModal to true"),Fr(!0)},[]),kr=S.useCallback(async()=>{Qr(!0);try{const Me=await Zi(()=>import("./retestService-C6b0YDiD.js"),[]),Tt=new Date,Gt=new Date(Tt.getTime()+fe.window_days*24*60*60*1e3),ar={...fe,teacher_id:r.teacher_id,grade:A,class:I,window_start:Tt.toISOString(),window_end:Gt.toISOString()};pe.debug("[Retest][TeacherCabinet] Prepared payload:",JSON.stringify(ar)),pe.debug("[Retest][TeacherCabinet] Selected students count:",(ar.student_ids||[]).length,"IDs:",ar.student_ids),await Me.retestService.createRetestAssignment(ar),d("Retest created","success"),Fr(!1),_r(),De(es=>es+1)}catch(Me){pe.error("Create retest error",Me),d(Me.message||"Failed to create retest","error")}finally{Qr(!1)}},[fe,A,I,_r]);if(g)return l.jsxs("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:[l.jsxs("div",{className:"text-center",children:[l.jsx(zr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Cabinet..."})]}),l.jsx("div",{className:"flex flex-wrap gap-2"})]});if(x)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Cabinet Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:x}),l.jsx(Ye,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return l.jsxs(nt.div,{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(nt.div,{className:"bg-gradient-to-r from-sky-400 to-sky-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-6",children:[l.jsxs(nt.div,{className:"flex-1 text-center",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white mb-2",children:"Teacher Cabinet"}),l.jsxs("p",{className:"text-sky-100 text-sm sm:text-base md:text-lg",children:["Welcome, Teacher ",a()||""]})]}),l.jsxs(nt.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsx("div",{className:"hidden md:block",children:l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>ht(!it),className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border border-white/20 text-white hover:bg-white/20 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:[l.jsx("span",{className:"hidden sm:inline text-xs sm:text-sm font-medium",children:"Menu"}),l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 transition-transform duration-200",style:{transform:it?"rotate(180deg)":"rotate(0deg)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),it&&l.jsxs(nt.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[l.jsxs("button",{onClick:()=>{ht(!1),We()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),l.jsx("span",{children:"Change Password"})]}),l.jsxs("button",{onClick:()=>{ht(!1),e?e():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),l.jsx("span",{children:"Logout"})]})]})]})}),l.jsxs("div",{className:"md:hidden",children:[l.jsx("button",{onClick:()=>Mt(!Dt),className:"flex items-center justify-center w-10 h-10 bg-white/10 border border-white/20 text-white hover:bg-white/20 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),Dt&&l.jsxs(nt.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[l.jsxs("div",{className:"px-4 py-2 border-b border-gray-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:a()||"Teacher"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Teacher Account"})]}),l.jsxs("button",{onClick:()=>{Mt(!1),We()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),l.jsx("span",{children:"Change Password"})]}),l.jsxs("button",{onClick:()=>{Mt(!1),e?e():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),l.jsx("span",{children:"Logout"})]})]})]})]})]})})}),l.jsx(nt.div,{className:"bg-white border-b shadow-sm",initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:l.jsx("nav",{className:"flex space-x-1 sm:space-x-8 overflow-x-auto",children:[{key:"main",label:"Main Dashboard",shortLabel:"Dashboard"},{key:"tests",label:"Test Management",shortLabel:"Tests"},{key:"results",label:"Class Results",shortLabel:"Results"},{key:"subjects",label:"Subject Management",shortLabel:"Subjects"}].map((Me,Tt)=>l.jsxs(nt.button,{onClick:()=>Me.key==="tests"?Te():C(Me.key),className:`py-2 sm:py-4 px-2 sm:px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors duration-200 whitespace-nowrap flex-shrink-0 flex-1 sm:flex-none ${w===Me.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5+Tt*.1,duration:.3},whileHover:{scale:1.05},whileTap:{scale:.95},children:[l.jsx("span",{className:"sm:hidden",children:Me.shortLabel}),l.jsx("span",{className:"hidden sm:inline",children:Me.label})]},Me.key))})})}),l.jsx(nt.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:l.jsxs(wo,{mode:"wait",children:[w==="main"&&l.jsx(nt.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Nn()},"main"),w==="subjects"&&l.jsx(nt.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:bn()},"subjects"),w==="tests"&&l.jsx(nt.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Zr()},"tests"),w==="results"&&l.jsx(nt.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:l.jsx(ez,{selectedGrade:A,selectedClass:I,onBackToCabinet:()=>C("main"),openRetestModal:Sr,forceRefreshOnMount:Xe>0},Xe)},"results")]})}),Y&&l.jsx(oa,{isOpen:Y,onClose:()=>{Z(!1),ke("subject"),pr([]),Ne(null),Re([])},title:"Select Subjects and Classes",size:"large",children:l.jsxs("div",{className:"space-y-6 px-4 max-h-[80vh] overflow-y-auto",children:[st==="subject"&&l.jsxs(nt.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Step 1: Select Subject"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the subject you want to teach:"}),Rr?l.jsxs("div",{className:"flex items-center justify-center py-8",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),l.jsx("span",{className:"ml-2 text-gray-600",children:"Loading subjects..."})]}):l.jsxs("select",{value:me?.subject_id||"",onChange:Me=>ye(Me.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Select a subject"}),Et.map(Me=>l.jsx("option",{value:Me.subject_id,children:Me.subject},Me.subject_id))]})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx(Ye,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),l.jsx(Ye,{variant:"primary",onClick:()=>ke("classes"),disabled:!me,children:"Next: Select Classes"})]})]}),st==="classes"&&me&&l.jsxs(nt.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["Step 2: Select Classes for ",me.subject]}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the classes you teach for this subject:"}),l.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:l.jsx("div",{className:"grid grid-cols-3 gap-3",children:[1,2,3,4,5,6,7].map(Me=>{let Tt;return Me===1||Me===2||Me===3?Tt=[15,16]:Me===4||Me===5||Me===6?Tt=[13,14]:Me===7?Tt=[69]:Tt=[],l.jsxs("div",{className:"space-y-2",children:[l.jsxs("h4",{className:"font-medium text-gray-700 text-sm",children:["Grade ",Me]}),l.jsx("div",{className:"space-y-1",children:Tt.map(Gt=>l.jsxs("label",{className:"flex items-center space-x-2 py-1",children:[l.jsx("input",{type:"checkbox",checked:Pe.some(ar=>ar.grade===Me.toString()&&ar.class===Gt.toString()),onChange:()=>xe(Me.toString(),Gt.toString()),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsxs("span",{className:"text-xs text-gray-700",children:["Class ",Gt]})]},Gt))})]},Me)})})})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx(Ye,{variant:"outline",onClick:()=>ke("subject"),children:"Back to Subjects"}),l.jsxs("div",{className:"space-x-3",children:[l.jsx(Ye,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),l.jsx(Ye,{variant:"primary",onClick:be,disabled:Pe.length===0,children:"Add Subject"})]})]})]}),qt.length>0&&l.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Selected Subjects"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Review your selected subjects and classes:"}),l.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:qt.map((Me,Tt)=>l.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900",children:Me.subject_name}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Classes: ",Me.classes.map(Gt=>`Grade ${Gt.grade} Class ${Gt.class}`).join(", ")]})]}),l.jsx("button",{onClick:()=>_e(Tt),className:"text-red-600 hover:text-red-800 p-1",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},Tt))})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx(Ye,{variant:"outline",onClick:()=>ke("subject"),children:"Add More Subjects"}),l.jsxs("div",{className:"space-x-3",children:[l.jsx(Ye,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),l.jsx(Ye,{variant:"primary",onClick:he,disabled:ur,className:"relative",children:ur?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save All Subjects"})]})]})]})]})}),gr&&l.jsxs(oa,{isOpen:gr,onClose:()=>Fr(!1),title:"Create Retest",size:"medium",children:[l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Retest Window"}),l.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:fe.window_days,onChange:Me=>wt(Tt=>({...Tt,window_days:Number(Me.target.value)})),children:[l.jsx("option",{value:1,children:"1 day"}),l.jsx("option",{value:2,children:"2 days"}),l.jsx("option",{value:3,children:"3 days"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Attempts"}),l.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:fe.max_attempts,onChange:Me=>wt(Tt=>({...Tt,max_attempts:Number(Me.target.value)})),children:[l.jsx("option",{value:1,children:"1 attempt"}),l.jsx("option",{value:2,children:"2 attempts"}),l.jsx("option",{value:3,children:"3 attempts"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Students can retry immediately if they fail"})]})]})}),l.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[l.jsx("button",{onClick:()=>Fr(!1),disabled:rn,className:"px-4 py-2 text-sm rounded border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),l.jsx("button",{onClick:kr,disabled:rn,className:"px-4 py-2 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:rn?l.jsxs(l.Fragment,{children:[l.jsx(zr,{size:"sm"}),"Creating Retest..."]}):"Create Retest"})]})]}),ae&&ne&&l.jsxs(oa,{isOpen:ae,onClose:()=>ee(!1),title:"Test Details",size:"large",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Name:"}),l.jsx("p",{className:"text-sm text-gray-900",children:ne.test_name})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Subject:"}),l.jsx("p",{className:"text-sm text-gray-900",children:ne.subject})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Type:"}),l.jsx("p",{className:"text-sm text-gray-900",children:ne.test_type})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Created:"}),l.jsx("p",{className:"text-sm text-gray-900",children:new Date(ne.created_at).toLocaleDateString()})]}),ne.assignments&&ne.assignments.length>0&&l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:ne.assignments.map((Me,Tt)=>l.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:[Me.grade,"/",Me.class]},Tt))})]})]}),l.jsx("div",{className:"flex justify-end space-x-3 mt-6",children:l.jsx(Ye,{variant:"outline",onClick:()=>ee(!1),children:"Close"})})]}),R&&q&&l.jsx(oa,{isOpen:R,onClose:oe,title:"Delete Subject Assignment",size:"small",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:l.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Subject Assignment"}),l.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Are you sure you want to delete the assignment for"," ",l.jsx("span",{className:"font-semibold text-gray-900",children:q.subjectName})," ","in Grade ",q.grade,", Class ",q.classNumber,"?"]}),l.jsx("p",{className:"text-xs text-red-600",children:"This action cannot be undone."})]}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx(Ye,{variant:"outline",onClick:oe,children:"Cancel"}),l.jsx(Ye,{variant:"danger",onClick:qe,children:"Delete Assignment"})]})]})}),l.jsx(nt.div,{className:"fixed top-4 right-4 space-y-2 z-50",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.8,duration:.5},children:h.map(Me=>l.jsx(nt.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.3},children:l.jsx("div",{className:`p-4 rounded-lg shadow-lg ${Me.type==="success"?"bg-green-600 text-white":Me.type==="error"?"bg-red-600 text-white":Me.type==="warning"?"bg-yellow-600 text-white":"bg-blue-600 text-white"}`,children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{children:Me.message}),l.jsx("button",{onClick:()=>setNotifications(Tt=>Tt.filter(Gt=>Gt.id!==Me.id)),className:"ml-4 text-white hover:text-gray-200",children:""})]})})},Me.id))}),Le&&l.jsx(oa,{isOpen:Le,onClose:Qe,title:"Change Password",size:"small",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),l.jsx("input",{type:"password",name:"currentPassword",value:Ue.currentPassword,onChange:zt,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter current password"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),l.jsx("input",{type:"password",name:"newPassword",value:Ue.newPassword,onChange:zt,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter new password"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),l.jsx("input",{type:"password",name:"confirmPassword",value:Ue.confirmPassword,onChange:zt,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Confirm new password"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx(Ye,{type:"button",variant:"secondary",onClick:Qe,className:"flex-1",children:"Cancel"}),l.jsx(Ye,{type:"button",onClick:Pt,className:"flex-1",children:"Change Password"})]})]})})]});function Nn(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsxs(Nt,{children:[l.jsx(Nt.Header,{children:l.jsx(Nt.Title,{children:"My Subjects & Classes"})}),l.jsx(Nt.Body,{children:k.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"You don't have any subjects assigned yet."}),l.jsx(Ye,{variant:"outline",onClick:()=>C("subjects"),children:"Manage Subjects"})]}):l.jsx("div",{className:"space-y-6",children:k.map((Me,Tt)=>l.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+Tt*.1,duration:.3},className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:Me.name}),l.jsxs("span",{className:"text-sm text-gray-500",children:[Me.classes?.length||0," classes"]})]}),Me.classes&&Me.classes.length>0?l.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:Me.classes.map((Gt,ar)=>l.jsx(nt.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3+Tt*.1+ar*.05,duration:.2},whileHover:{scale:1.05},whileTap:{scale:.95},children:l.jsxs(Ye,{variant:"outline",size:"sm",onClick:()=>{j(Gt.grade),B(Gt.class),C("results")},className:"font-medium",children:[Gt.grade,"/",Gt.class]})},ar))}):l.jsx("div",{className:"text-center py-4 text-gray-500",children:l.jsx("span",{className:"text-sm",children:"No classes assigned to this subject"})})]},Me.id))})})]})}),l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},children:l.jsxs(Nt,{children:[l.jsxs(Nt.Header,{children:[l.jsx(Nt.Title,{children:"Test Performance Overview"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Test performance over time with average scores"})]}),l.jsx(Nt.Body,{children:k.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"mb-2",children:l.jsx("img",{src:"/pics/Graph.png",alt:"Performance Graph",className:"w-16 h-16 object-contain mx-auto"})}),l.jsx("p",{className:"text-gray-500",children:"No subjects assigned - no performance data available"})]}):l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex flex-wrap gap-2 border-b border-gray-200",children:(()=>{const Me=[];return k.forEach(Tt=>{Tt.classes&&Tt.classes.forEach(Gt=>{const ar=`${Gt.grade}/${Gt.class}`;Me.find(es=>es.key===ar)||Me.push({key:ar,grade:Gt.grade,class:Gt.class,subject:Tt.name})})}),Me})().map((Me,Tt)=>l.jsxs("button",{onClick:()=>{pe.debug(" Class button clicked:",Me.key),xt(Me.key),mt(Me.key)},className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${vt===Me.key?"bg-blue-100 text-blue-700 border-b-2 border-blue-500":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[Me.grade,"/",Me.class]},Me.key))}),vt?l.jsx("div",{className:"mt-4",children:l.jsx(v3e,{data:Ee,loading:He,error:Rt})}):l.jsxs("div",{className:"mt-4 text-center text-muted py-4",children:[l.jsx("div",{className:"mb-2",children:l.jsx("img",{src:"/pics/Graph.png",alt:"Performance Graph",className:"w-16 h-16 object-contain mx-auto"})}),l.jsx("p",{className:"text-gray-500",children:"Select a class above to view test performance data"})]})]})})]})})]})}function bn(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsx(Nt,{children:l.jsx(Nt.Header,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx(Nt.Title,{children:"Subject Management"}),l.jsx(Ye,{variant:"primary",onClick:ue,children:"Add Subject"})]})})})}),k.length===0?l.jsx(nt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:l.jsx(Nt,{children:l.jsx(Nt.Body,{children:l.jsxs("div",{className:"text-center p-12",children:[l.jsx(nt.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No subjects assigned yet"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Add your first subject to get started with creating tests and managing classes."}),l.jsx(Ye,{variant:"primary",onClick:ue,size:"lg",children:"Add Your First Subject"})]})})})}):l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:l.jsxs(Nt,{children:[l.jsx(Nt.Header,{children:l.jsx(Nt.Title,{children:"Your Subjects"})}),l.jsx(Nt.Body,{children:l.jsx("div",{className:"space-y-4",children:k.map((Me,Tt)=>l.jsx(nt.div,{className:"p-4 bg-gray-50 rounded-lg border-l-4 border-green-500",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3+Tt*.1,duration:.3},whileHover:{scale:1.02,backgroundColor:"#f9fafb"},children:l.jsx("div",{className:"flex justify-between items-start",children:l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:Me.name}),l.jsx("div",{className:"flex flex-wrap gap-2",children:Me.classes?.map((Gt,ar)=>l.jsxs(nt.div,{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-800 text-xs rounded-full px-3 py-1",initial:{scale:0},animate:{scale:1},transition:{delay:.4+Tt*.1+ar*.05,duration:.2},whileHover:{scale:1.1},children:[l.jsxs("span",{children:[Gt.grade," - ",Gt.className]}),l.jsx("button",{onClick:()=>ut(Me.id,Me.name,Gt.grade,Gt.class),className:"ml-1 text-red-600 hover:text-red-800 transition-colors",title:"Delete this subject assignment",children:l.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},ar))||l.jsx("span",{className:"text-gray-500 text-sm",children:"No classes assigned"})})]})})},Tt))})})]})})]})}function Zr(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsx(Nt,{children:l.jsx(Nt.Header,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx(Nt.Title,{children:"Active Tests"}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(Ye,{variant:"outline",onClick:ot,children:"Refresh"}),l.jsx(Ye,{variant:"primary",onClick:()=>t("/teacher/tests/create"),children:"Create New Test"})]})]})})})}),N.length===0?l.jsx(nt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:l.jsx(Nt,{children:l.jsx(Nt.Body,{children:l.jsxs("div",{className:"text-center p-12",children:[l.jsx(nt.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No active tests found"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first test to get started with assessments."}),l.jsx(Ye,{variant:"primary",onClick:()=>t("/teacher/tests/create"),size:"lg",children:"Create Your First Test"})]})})})}):l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"space-y-4",children:N.map((Me,Tt)=>l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3+Tt*.1,duration:.3},whileHover:{scale:1.01},children:l.jsx(Nt,{children:l.jsx(Nt.Body,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{className:"flex-1 flex items-center space-x-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 min-w-0 flex-shrink-0",children:Me.test_name}),l.jsx("span",{className:"hidden sm:inline-block bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium flex-shrink-0",children:Me.test_type}),l.jsxs("div",{className:"hidden sm:flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[l.jsx("span",{className:"font-medium",children:"Assignments:"}),l.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:Me.assignments?.length||0})]}),Me.assignments&&Me.assignments.length>0&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[l.jsx("span",{className:"font-medium",children:"Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-1",children:Me.assignments.map((Gt,ar)=>l.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:[Gt.grade,"/",Gt.class]},ar))})]}),l.jsx("div",{className:"text-sm text-gray-500 flex-shrink-0",children:new Date(Me.created_at).toLocaleDateString()})]})]}),l.jsxs("div",{className:"flex gap-2 ml-4 flex-shrink-0",children:[l.jsx("div",{className:"sm:hidden",children:l.jsx(Ye,{variant:"outline",onClick:()=>Ce(Me),size:"sm",className:"text-xs",title:`Type: ${Me.test_type} | Assignments: ${Me.assignments?.length||0} | Classes: ${Me.assignments?.map(Gt=>`${Gt.grade}/${Gt.class}`).join(", ")||"None"} | ${new Date(Me.created_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}`,children:"Details"})}),l.jsx("div",{className:"hidden sm:block",children:l.jsx(Ye,{variant:"outline",onClick:()=>Ce(Me),size:"sm",children:"Details"})}),l.jsx(Ye,{variant:"success",onClick:()=>Ke(Me.test_type,Me.test_id),size:"sm",disabled:re===Me.test_id,children:re===Me.test_id?l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Completing..."]}):"Complete"})]})]})})})},Tt))})]})}},w3e={multipleChoice:"multiple_choice",trueFalse:"true_false",input:"input",matching:"matching_type",wordMatching:"word_matching",drawing:"drawing",fillBlanks:"fill_blanks",speaking:"speaking"},gM=()=>{const{user:e}=cs();Zse();const{notifications:t,showNotification:r,removeNotification:n}=za(),[s,a]=S.useState(!1),[i,o]=S.useState(!1),[c,u]=S.useState("typeSelection"),[d,h]=S.useState(!1),[g,p]=S.useState(null),[x,v]=S.useState([]),[w,C]=S.useState(!1),[k,b]=S.useState(!1),[N,E]=S.useState(!1),[P,F]=S.useState(!1),[A,j]=S.useState({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:"",isShuffled:!1}),[I,B]=S.useState([]),[Y,Z]=S.useState(null);S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null);const ae=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in initializeTestCreation, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" Setting up test creation event listeners..."),W(),console.log(" Test creation initialization complete")},[e,r]),ee=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestTypeSelection, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" showTestTypeSelection called - starting new test creation"),o(!1),console.log(" Reset testAssignmentCompleted flag to false"),a(!0),console.log(" Set isInTestCreation flag to true"),ne(),u("typeSelection"),H("testTypeSelection")},[e,r]),ne=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in disableNavigationButtons, redirecting to login");return}console.log(" Disabling navigation buttons..."),h(!0)},[e]),L=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in enableNavigationButtons, redirecting to login");return}console.log(" Enabling navigation buttons..."),h(!1)},[e]),H=S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveTestCreationState, redirecting to login");return}console.log("  saveTestCreationState called with step:",oe),console.log("  Call stack:",new Error().stack);const he={multipleChoice:{buttonVisible:!0,hintVisible:!1},trueFalse:{buttonVisible:!0,hintVisible:!1},input:{buttonVisible:!0,hintVisible:!1}},Te={isInTestCreation:!0,currentStep:oe,timestamp:Date.now(),excelState:he};localStorage.setItem("test_creation_state",JSON.stringify(Te)),console.log(" Saved test creation state:",Te);const Ce={};switch(oe){case"testTypeSelection":break;case"multipleChoiceForm":Ce.testName=A.testName||"",Ce.numQuestions=A.numQuestions||"",Ce.numOptions=A.numOptions||"",Ce.questions=A.questions||{};break;case"trueFalseForm":Ce.testName=A.testName||"",Ce.numQuestions=A.numQuestions||"",Ce.questions=A.questions||{};break;case"inputForm":Ce.testName=A.testName||"",Ce.numQuestions=A.numQuestions||"",Ce.questions=A.questions||{};break;case"formCreation":Ce.testName=A.testName||"",Ce.numQuestions=A.numQuestions||"",Ce.numOptions=A.numOptions||"",Ce.questions=A.questions||{},Ce.enableTimer=!!A.enableTimer,Ce.timerMinutes=A.timerMinutes||"",Ce.isShuffled=!!A.isShuffled;break;case"assignment":case"testAssignment":Ce.testName=A.testName||"",Ce.numQuestions=A.numQuestions||"",Ce.numOptions=A.numOptions||"",Ce.questions=A.questions||{};break;default:console.log(" Unknown step in saveTestCreationState:",oe);break}Object.keys(Ce).length>0&&(localStorage.setItem(`form_data_${oe}`,JSON.stringify(Ce)),console.log(" Saved form data for step:",oe,Ce))},[e,A]),M=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearTestCreationState, redirecting to login");return}localStorage.removeItem("test_creation_state"),localStorage.removeItem("test_creation_form_data");const oe=[];for(let he=0;he<localStorage.length;he++){const Te=localStorage.key(he);Te&&(Te.includes("test")||Te.includes("form")||Te.includes("question"))&&oe.push(Te)}oe.forEach(he=>{localStorage.removeItem(he),console.log(" Removed localStorage key:",he)}),console.log(" Cleared test creation state from localStorage")},[e]);S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearAllTestFields, redirecting to login");return}console.log(" Clearing all test form fields..."),j({testName:"",numQuestions:0,numOptions:0,questions:{}}),p(null),B([]),Z(null),console.log(" Cleared all test form fields")},[e]);const V=S.useCallback(()=>{console.log(" Resetting Excel upload state..."),tt({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),["multiple-choice","true-false","input","word-matching"].forEach(he=>{const Te=document.querySelector(`.excel-upload-btn[data-test-type="${he}"]`);Te&&(Te.style.display="none",console.log(" Excel button hidden for:",he));const Ce=document.querySelector(`.excel-hint[data-test-type="${he}"]`);Ce&&(Ce.style.display="none",console.log(" Excel hint hidden for:",he));const Ke=document.querySelector(`.excel-file-input[data-test-type="${he}"]`);Ke&&(Ke.value="",console.log(" File input cleared for:",he))}),console.log(" Excel upload state reset complete")},[]),W=S.useCallback(()=>{console.log(" Setting up auto-save listeners for initial form fields..."),["testName","numQuestions","numOptions","enableTimer","timerMinutes","isShuffled"].forEach(he=>{const Te=document.getElementById(he);Te&&Te.addEventListener("input",()=>{console.log(` Auto-save triggered for field: ${he}`)})}),console.log(" Form auto-save setup complete")},[]);S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveFormDataForStep, redirecting to login");return}console.log("  saveFormDataForStep called with step:",oe),console.log("  Call stack:",new Error().stack);const he={};switch(oe){case"testTypeSelection":break;case"multipleChoiceForm":he.testName=A.testName||"",he.numQuestions=A.numQuestions||"",he.numOptions=A.numOptions||"",he.questions=A.questions||{};break;case"trueFalseForm":he.testName=A.testName||"",he.numQuestions=A.numQuestions||"",he.questions=A.questions||{};break;case"inputForm":he.testName=A.testName||"",he.numQuestions=A.numQuestions||"",he.questions=A.questions||{};break;case"formCreation":he.testName=A.testName||"",he.numQuestions=A.numQuestions||"",he.numOptions=A.numOptions||"",he.questions=A.questions||{};break;default:console.log(" Unknown step for form data save:",oe);return}localStorage.setItem("test_creation_form_data",JSON.stringify({step:oe,data:he,timestamp:Date.now()})),console.log(" Saved form data for step:",oe,he)},[e,A]);const R=S.useCallback(async oe=>{console.log(" Restoring form data for step:",oe);try{const he=localStorage.getItem(`form_data_${oe}`);if(he){const Te=JSON.parse(he);console.log(" Restored form data:",Te),j(Ce=>{const Ke={...Ce,...Te};return console.log(" Updated formData with restored data:",Ke),console.log(" Matching test data in restored data:",Ke.matchingTestData),Ke}),Object.keys(Te).forEach(Ce=>{const Ke=document.getElementById(Ce);Ke&&Te[Ce]!==void 0&&(Ke.value=Te[Ce])}),console.log(" Form data restored for step:",oe)}else console.log(" No saved data found for step:",oe)}catch(he){console.error(" Error restoring form data:",he)}},[e]),U=S.useCallback(()=>{console.log(" Setting up multiple choice form auto-save..."),["mcNumOptions"].forEach(Te=>{const Ce=document.getElementById(Te);Ce&&Ce.addEventListener("input",()=>{console.log(` Auto-save triggered for MC field: ${Te}`)})}),document.querySelectorAll("#mcQuestionsContainer input, #mcQuestionsContainer textarea, #mcQuestionsContainer select").forEach(Te=>{Te.addEventListener("input",()=>{console.log(" Auto-save triggered for MC question field")})}),console.log(" Multiple choice form auto-save setup complete")},[]),q=S.useCallback(()=>{console.log(" Setting up true/false form auto-save..."),document.querySelectorAll("#tfQuestionsContainer input, #tfQuestionsContainer textarea, #tfQuestionsContainer select").forEach(he=>{he.addEventListener("input",()=>{console.log(" Auto-save triggered for TF question field")})}),console.log(" True/false form auto-save setup complete")},[]),Q=S.useCallback(()=>{console.log(" Setting up input form auto-save..."),document.querySelectorAll("#inputQuestionsContainer input, #inputQuestionsContainer textarea, #inputQuestionsContainer select").forEach(he=>{he.addEventListener("input",()=>{console.log(" Auto-save triggered for Input question field")})}),console.log(" Input form auto-save setup complete")},[]),se=S.useCallback(oe=>{console.log(" showExcelUploadButton called with testType:",oe);const he=oe==="multiple-choice"?"multipleChoice":oe==="true-false"?"trueFalse":oe==="input"?"input":oe;tt(Te=>({...Te,[he]:{...Te[he],buttonVisible:!0}}))},[]),X=S.useCallback(oe=>{console.log(" showExcelHint called with testType:",oe);const he=oe==="multiple-choice"?"multipleChoice":oe==="true-false"?"trueFalse":oe==="input"?"input":oe;tt(Te=>({...Te,[he]:{...Te[he],hintVisible:!0}}))},[]),ie=S.useCallback(async(oe,he,Te)=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTestAssignmentOptions, redirecting to login");return}console.log("displayTestAssignmentOptions called with:",{classes:oe,testType:he,testId:Te}),v(oe),console.log(" Test assignment options displayed for:",{testType:he,testId:Te,classesCount:oe.length})},[e]),le=S.useCallback(async(oe,he)=>{try{if(console.log("Loading teacher grades and classes for test assignment"),!e||!e.teacher_id){console.error("No valid teacher session found, redirecting to login");return}console.log("Teacher ID:",e.teacher_id);const Ce=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${e.teacher_id}`)).json();console.log("Teacher subjects response:",Ce),Ce.success&&Ce.subjects&&Ce.subjects.length>0?(console.log("Teacher subjects loaded:",Ce.subjects),v(Ce.subjects),ie(Ce.subjects,oe,he)):(console.log("No teacher subjects found"),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(Te){console.error("Error loading teacher grades and classes:",Te),r("Error loading teacher grades and classes","error")}},[e,r,ie]),ce=S.useCallback(async()=>{if(console.log(" Loading available classes..."),!e||!e.teacher_id){console.error("No valid teacher session found, redirecting to login");return}try{const he=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${e.teacher_id}`)).json();console.log(" Teacher subjects response:",he),he.success&&he.subjects&&he.subjects.length>0?(console.log(" Teacher subjects loaded:",he.subjects),v(he.subjects)):(console.log("No teacher subjects found"),v([]),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(oe){console.error(" Error loading available classes:",oe),r("Failed to load available classes","error")}},[e,r]);S.useCallback(async(oe,he)=>{if(i){o(!1);return}if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestAssignment, redirecting to login");return}ne(),H("testAssignment"),Z(he),p(oe),u("testAssignment"),le(oe,he),console.log(" Test assignment interface shown for:",{testType:oe,testId:he})},[i,e,ne,H,le]);const Se=S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTeacherActiveTests, redirecting to login");return}if(console.log(" Displaying teacher active tests:",oe),oe.length===0){Be([]);return}Be(oe),console.log(" Active tests displayed:",oe.length,"tests")},[e]);S.useCallback(async(oe,he)=>{try{console.log(" Loading test questions for:",{testType:oe,testId:he});const Te=await hn.getTestQuestions(he,oe);return console.log(" Test questions loaded:",Te),Te}catch(Te){throw console.error("Error loading test questions:",Te),Te}},[]),S.useCallback((oe,he,Te,Ce)=>{console.log(" Showing teacher test details modal:",{testType:oe,testId:he,testName:Te,questionsCount:Ce.length}),console.log("Test Details:",{testType:oe,testId:he,testName:Te,questions:Ce.map(Ke=>({id:Ke.question_id,question:Ke.question,correctAnswer:Ke.correct_answer}))}),r(`Test details for "${Te}" loaded successfully.`,"success")},[r]);const re=S.useCallback(async()=>{console.log(" DEBUG: loadTeacherActiveTests called");try{console.log(" DEBUG: Fetching teacher active tests using JWT authentication...");const oe=await hn.getTeacherTests();console.log(" DEBUG: Tests loaded:",oe),oe&&oe.length>0?(console.log(" DEBUG: Success! Displaying",oe.length,"tests"),Se(oe)):(console.log(" DEBUG: No tests found"),Be([]))}catch(oe){console.error(" DEBUG: Error loading active tests:",oe),r("Error loading active tests.","error")}},[r,Se]),ge=S.useCallback(()=>{console.log("showTestCreationSuccessMessage called"),r("Test created and assigned successfully!","success"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}}),B([]),o(!1),a(!1),M()},[r,M]),Ee=S.useCallback(async(oe,he)=>{if(console.log(" === ASSIGN TEST TO CLASSES DEBUG START ==="),console.log(" Test Type:",oe),console.log(" Test ID:",he),console.log(" Current formData:",A),console.log(" Selected Classes:",I),console.log(" User:",e),!e||!e.teacher_id){console.error(" No valid teacher session found in assignTestToClasses, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}if(console.log(" Teacher ID:",e.teacher_id),I.length===0){console.warn(" No classes selected"),r("Please select at least one class.","warning");return}try{console.log(" Preparing test + assignment request..."),await rd.loadAcademicCalendar();const Ce=rd.getCurrentTerm()?.id;if(!Ce)throw new Error("No current academic period found");const Ke=I.map(pt=>{const Yt={grade:parseInt(pt.grade),class:parseInt(pt.class),subject_id:parseInt(pt.subject_id),academic_period_id:Ce,due_date:null};return console.log(" Created assignment:",Yt),Yt});if(console.log(" Final assignments array:",Ke),oe==="matching"){console.log(" Processing matching test..."),console.log(" Setting isAssigningTest to true for matching test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(gr=>setTimeout(gr,100));const pt=A.matchingTestData;if(console.log(" Matching test data from formData:",pt),!pt){console.error(" Matching test data not found in formData"),r("Matching test data not found. Please recreate the test.","error");return}console.log(" Matching test data found, processing...");let Yt;pt.processedQuestions?(console.log(" Using pre-processed questions from MatchingTestCreator"),Yt=pt.processedQuestions):(console.log(" Converting blocks to questions (fallback)..."),console.log(" Blocks:",pt.blocks),console.log(" Words:",pt.words),console.log(" Arrows:",pt.arrows),Yt=pt.blocks.map((gr,Fr)=>{const rn=pt.words.find(Sr=>Sr.blockId===gr.id)?.word||`Word ${Fr+1}`,Qr=pt.arrows.some(Sr=>Sr.startBlock===gr.id),fe=pt.arrows.find(Sr=>Sr.startBlock===gr.id)||null,wt={question_id:Fr+1,word:rn,block_coordinates:{x:gr.x,y:gr.y,width:gr.width,height:gr.height},has_arrow:Qr,arrow:fe?{startX:fe.startX,startY:fe.startY,endX:fe.endX,endY:fe.endY,style:fe.style||{}}:null};return console.log(` Question ${Fr+1}:`,wt),wt})),console.log(" Final questions array:",Yt);const vr={teacher_id:e.teacher_id,test_name:A.testName,image_url:pt.imageUrl,num_blocks:pt.blocks.length,questions:Yt,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,assignments:Ke};console.log(" Final matching test data payload:",vr),console.log(" Calling testService.saveMatchingTest...");const _r=await hn.saveMatchingTest(vr);console.log(" API Response:",_r),_r.success?(console.log(" Matching test created and assigned successfully!"),r("Matching test created and assigned successfully!","success"),console.log("Matching test created and assigned successfully"),o(!0),Ae()):(console.error(" Failed to create matching test:",_r.message),r("Error creating and assigning matching test: "+_r.message,"error")),F(!1);return}if(oe==="wordMatching"){console.log(" Processing word matching test..."),console.log(" Setting isAssigningTest to true for word matching test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(gr=>setTimeout(gr,100));const pt=A.wordMatchingData;if(console.log(" Word matching test data from formData:",pt),!pt){console.error(" Word matching test data not found in formData"),r("Word matching test data not found. Please recreate the test.","error");return}console.log(" Word matching test data found, processing...");const Yt=pt.wordPairs.map((gr,Fr)=>({question_id:Fr+1,left_word:gr.leftWord,right_word:gr.rightWord}));console.log(" Final word matching questions array:",Yt);const vr={teacher_id:e.teacher_id,test_type:"word_matching",test_name:A.testName,num_questions:pt.wordPairs.length,interaction_type:pt.interactionType||"drag",questions:Yt,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,assignments:Ke};console.log(" Final word matching test data payload:",vr),console.log(" Calling testService.assignTestToClasses for word matching...");const _r=await hn.assignTestToClasses(vr);console.log(" API Response:",_r),_r.success?(console.log(" Word matching test created and assigned successfully!"),r("Word matching test created and assigned successfully!","success"),console.log("Word matching test created and assigned successfully"),o(!0),Ae()):(console.error(" Failed to create word matching test:",_r.message),r("Error creating and assigning word matching test: "+_r.message,"error")),F(!1);return}if(oe==="drawing"){console.log(" Processing drawing test..."),console.log(" Setting isAssigningTest to true for drawing test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(gr=>setTimeout(gr,100));const pt=A.drawingData;if(console.log(" Drawing test data from formData:",pt),!pt){console.error(" Drawing test data not found in formData"),r("Drawing test data not found. Please recreate the test.","error");return}console.log(" Drawing test data found, processing...");const Yt=pt.questions||[];console.log(" Drawing questions array:",Yt);const vr={teacher_id:e.teacher_id,test_type:"drawing",test_name:A.testName,num_questions:pt.num_questions,passing_score:pt.passing_score,questions:Yt,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,assignments:Ke};console.log(" Final drawing test data payload:",vr),console.log(" Calling testService.assignTestToClasses...");const _r=await hn.assignTestToClasses(vr);console.log(" API Response:",_r),_r.success?(console.log(" Drawing test created and assigned successfully!"),r("Drawing test created and assigned successfully!","success"),o(!0),Ae()):(console.error(" Failed to create drawing test:",_r.message),r("Error creating and assigning drawing test: "+_r.message,"error")),F(!1);return}if(oe==="fillBlanks"){console.log(" Processing fill blanks test..."),console.log(" Setting isAssigningTest to true for fill blanks test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(gr=>setTimeout(gr,100));const pt=A.fillBlanksData;if(console.log(" Fill blanks test data from formData:",pt),!pt){console.error(" Fill blanks test data not found in formData"),r("Fill blanks test data not found. Please recreate the test.","error");return}console.log(" Fill blanks test data found, processing...");const Yt=pt.blanks||[];console.log(" Fill blanks questions array:",Yt);const vr={teacher_id:e.teacher_id,test_type:"fill_blanks",test_name:A.testName,test_text:pt.test_text,num_questions:pt.num_questions,num_blanks:pt.num_blanks,separate_type:pt.separate_type,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,questions:Yt,assignments:Ke};console.log(" Final fill blanks test data payload:",vr),console.log(" Calling testService.assignTestToClasses...");const _r=await hn.assignTestToClasses(vr);console.log(" API Response:",_r),_r.success?(console.log(" Fill blanks test created and assigned successfully!"),r("Fill blanks test created and assigned successfully!","success"),o(!0),Ae()):(console.error(" Failed to create fill blanks test:",_r.message),r("Error creating and assigning fill blanks test: "+_r.message,"error")),F(!1);return}if(oe==="speaking"){console.log(" Processing speaking test..."),console.log(" Setting isAssigningTest to true for speaking test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(gr=>setTimeout(gr,100));const pt=A.speakingData;if(console.log(" Speaking test data from formData:",pt),!pt){console.error(" Speaking test data not found in formData"),r("Speaking test data not found. Please recreate the test.","error");return}console.log(" Speaking test data found, processing...");const Yt={teacher_id:e.teacher_id,test_type:"speaking",test_name:A.testName,time_limit:pt.time_limit,min_duration:pt.min_duration,max_duration:pt.max_duration,max_attempts:pt.max_attempts,min_words:pt.min_words,passing_score:pt.passing_score,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,questions:pt.questions,assignments:Ke};console.log(" Final speaking test data payload:",Yt),console.log(" Calling save-speaking-test-with-assignments for speaking test...");const _r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-speaking-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Yt)})).json();console.log(" API Response:",_r),_r.success?(console.log(" Speaking test created and assigned successfully!"),r("Speaking test created and assigned successfully!","success"),o(!0),Ae()):(console.error(" Failed to create speaking test:",_r.message),r("Error creating and assigning speaking test: "+_r.message,"error")),F(!1);return}console.log(" Processing non-matching test..."),console.log(" Form data questions:",A.questions);const ot=Object.keys(A.questions).map(pt=>{const Yt=A.questions[pt];console.log(` Processing question ${pt}:`,Yt);let vr;if(oe==="input")vr={correct_answers:Yt.correct_answers||[Yt.correctAnswer||""]};else if(oe==="trueFalse"){const gr=Yt.correct_answer||Yt.correctAnswer||Yt.correct_answers?.[0]||"";vr={correct_answer:gr==="true"}}else vr={correct_answer:Yt.correctAnswer||Yt.correct_answer||Yt.correct_answers?.[0]||""};const _r={question_id:parseInt(pt),question:Yt.question,...vr,options:Yt.options||[]};return console.log(` Question ${pt} correct_answers:`,Yt.correct_answers),console.log(` Question ${pt} correctAnswer:`,Yt.correctAnswer),console.log(` Converted question ${pt}:`,_r),_r});console.log(" Final questions array:",ot);const mt={teacher_id:e.teacher_id,test_type:w3e[oe],test_name:A.testName,num_questions:A.numQuestions,num_options:A.numOptions,questions:ot,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,is_shuffled:!!A.isShuffled,assignments:Ke};console.log(" Final test data payload:",mt),console.log(" Setting isAssigningTest to true..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(pt=>setTimeout(pt,100)),console.log(" Calling testService.assignTestToClasses...");const Wt=await hn.assignTestToClasses(mt);console.log(" API Response:",Wt),Wt.success?(console.log(" Test created and assigned successfully!"),r("Test created and assigned successfully!","success"),console.log("Test created and assigned successfully"),o(!0),Ae()):(console.error(" Failed to create and assign test:",Wt.message),r("Error creating and assigning test: "+Wt.message,"error"))}catch(Te){console.error(" Exception in assignTestToClasses:",Te),console.error("Error creating and assigning test:",Te),r("Error creating and assigning test. Please try again.","error")}finally{F(!1)}console.log(" === ASSIGN TEST TO CLASSES DEBUG END ===")},[e,I,A,r,ge]),Ae=S.useCallback(async()=>{console.log("returnToMainCabinet called - restoring main cabinet view");try{a(!1),o(!1),u("typeSelection"),p(null),Z(null),B([]),L(),M(),ge(),console.log(" Returned to main cabinet")}catch(oe){console.error("Error returning to main cabinet:",oe)}},[L,M,ge]),[He,Be]=S.useState([]),[Rt,et]=S.useState(!1);S.useCallback(async()=>{console.log(" Refreshing active tests data...");try{await re(),r("Active tests data refreshed.","success")}catch(oe){console.error("Error refreshing active tests data:",oe),r("Error refreshing data.","error")}},[re,r]);const[vt,xt]=S.useState([]),[it,ht]=S.useState([]),[Dt,Mt]=S.useState(!1),[Xe,De]=S.useState(!1),Le=S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayExistingSubjectsInSelection, redirecting to login");return}console.log("Displaying existing subjects in selection interface:",oe),xt(oe),console.log(" Existing subjects displayed in selection:",oe.length,"subjects")},[e]);S.useCallback(async()=>{try{console.log("Loading existing subjects...");const oe=await hs.getTeacherSubjects();console.log("Existing subjects loaded:",oe),oe&&oe.length>0?Le(oe):(console.log("No existing subjects found"),xt([]))}catch(oe){console.error("Error loading existing subjects:",oe),r("Error loading subjects.","error")}},[r,Le]);const lt=S.useCallback(oe=>{console.log("Checking for outside click...");const he=document.getElementById("dropdownMenu"),Te=document.querySelector("[data-menu-button]");he&&!he.contains(oe.target)&&!Te?.contains(oe.target)&&(console.log("Outside click detected, closing menu"),he.classList.remove("show"),document.removeEventListener("click",lt))},[]),[Ue,tt]=S.useState({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),Et=S.useCallback((oe,he)=>{const Te=oe.target.files[0];if(!Te)return;if(!Te.name.match(/\.(xlsx|xls)$/i)){r("Please select a valid Excel file (.xlsx or .xls)","error"),oe.target.value="";return}if(Te.size>5*1024*1024){r("File is too large. Please select a file smaller than 5MB.","error"),oe.target.value="";return}E(!0);const Ce=new FileReader;Ce.onload=function(Ke){try{console.log(" File loaded, processing data...");const ot=new Uint8Array(Ke.target.result),mt=SE(ot,{type:"array"}),Wt=mt.SheetNames[0],pt=mt.Sheets[Wt],Yt=ab.sheet_to_json(pt,{header:1});console.log(" Parsed Excel data:",Yt),qt(Yt,he),E(!1)}catch(ot){console.error("Error processing Excel file:",ot),r("Error reading Excel file: "+ot.message,"error"),oe.target.value="",E(!1)}},Ce.onerror=function(){r("Failed to read file","error"),oe.target.value="",E(!1)},Ce.readAsArrayBuffer(Te)},[r]),At=S.useCallback(()=>{console.log(" Initializing Excel upload for all test types...");const oe=document.querySelectorAll(".excel-upload-btn");console.log(` Found ${oe.length} Excel upload buttons`),oe.forEach((he,Te)=>{const Ce=he.dataset.testType,Ke=document.querySelector(`.excel-file-input[data-test-type="${Ce}"]`);console.log(` Processing button ${Te+1}: testType=${Ce}, fileInput=${Ke?"found":"not found"}`),Ke?(he._excelClickHandler&&he.removeEventListener("click",he._excelClickHandler),Ke._excelChangeHandler&&Ke.removeEventListener("change",Ke._excelChangeHandler),he._excelClickHandler=()=>{console.log(` Excel upload button clicked for test type: ${Ce}`),Ke.click()},Ke._excelChangeHandler=ot=>{console.log(` File input changed for test type: ${Ce}`),Et(ot,Ce)},he.addEventListener("click",he._excelClickHandler),Ke.addEventListener("change",Ke._excelChangeHandler),console.log(` Excel upload initialized for test type: ${Ce}`)):console.warn(` File input not found for test type: ${Ce}`)}),console.log(" Excel upload initialization complete")},[Et]),qt=S.useCallback((oe,he)=>{const Te=oe.filter(pt=>Array.isArray(pt)&&pt.length>0&&pt.some(Yt=>Yt&&Yt.toString().trim()!==""));console.log(" Original Excel data rows:",oe.length),console.log(" Filtered Excel data rows:",Te.length);const Ke=pr(Te,he).dataRows;if(Ke.length===0){const pt="No data rows found after header processing. Please check your Excel file.";r(pt,"error"),alert(pt),Pe(he);return}console.log(` Processing Excel data for test type: ${he}`),console.log(" Data rows after header processing:",Ke);const ot=ur(Ke,he);if(console.log(" Recognition result:",ot),!ot.recognized){console.log(` Excel data recognition failed for test type: ${he}`);const pt="Excel data recognition failed. Please check your file format.";r(pt,"error"),alert(pt),Pe(he);return}console.log(` Excel data recognition successful for test type: ${he}`);const mt=Ke.length,Wt=Ne(he);if(Wt===0)console.log(` No question count specified, using CSV count: ${mt}`),j(pt=>({...pt,numQuestions:mt}));else if(mt!==Wt){const pt=`Your CSV file has ${mt} data rows, but you specified ${Wt} questions.

Please either:
1. Change your question count to ${mt}, or
2. Fix your CSV file to have exactly ${Wt} data rows

Then try uploading again.`;r(pt,"error"),Pe(he);return}Re(Ke,he)},[r]),pr=S.useCallback((oe,he)=>{if(oe.length===0)return{hasHeaders:!1,headerRow:null,dataRows:oe};const Te=oe[0],Ce=Rr(he);if(Kr(Te,Ce).isLikelyHeader){const ot=`The first row of your Excel file looks like it contains headers:

"${Te.join(" | ")}"

Does the first row contain column headers?

Click "OK" if YES (headers will be removed)
Click "Cancel" if NO (first row will be treated as data)`;if(window.confirm(ot))return{hasHeaders:!0,headerRow:Te,dataRows:oe.slice(1)}}return{hasHeaders:!1,headerRow:null,dataRows:oe}},[]),Rr=S.useCallback(oe=>{switch(oe){case"multipleChoice":return{keywords:["question","answer","correct","option","a","b","c","d","e","f"],expectedColumns:4};case"trueFalse":return{keywords:["question","answer","correct","true","false"],expectedColumns:2};case"input":return{keywords:["question","answer","correct"],expectedColumns:2};default:return{keywords:[],expectedColumns:0}}},[]),Kr=S.useCallback((oe,he)=>{if(!oe||oe.length===0)return{isLikelyHeader:!1};if(oe.length<he.expectedColumns)return{isLikelyHeader:!1};const Te=oe.join(" ").toLowerCase(),Ce=he.keywords.filter(ot=>Te.includes(ot.toLowerCase()));return{isLikelyHeader:Ce.length>he.keywords.length/2,keywordMatches:Ce}},[]),ur=S.useCallback((oe,he)=>{if(oe.length===0)return r("No data rows found. Please check your Excel file.","error"),{recognized:!1,data:[]};console.log(` Checking data pattern for test type: ${he}`),console.log(" Excel data to validate:",oe);const Te=ir(oe,he);if(console.log(" Recognition result:",Te),!Te.matches){const Ce=`Your Excel file doesn't match the expected format.

Required format:
${me(he)}

Please review your Excel file and make sure it follows this format exactly.

Then try uploading again.`;return console.log(" Data pattern validation failed:",Ce),console.log(" Calling showNotification with message:",Ce),r(Ce,"error"),console.log(" showNotification called"),alert(Ce),{recognized:!1,data:[]}}return console.log(` Data pattern validation passed for test type: ${he}`),{recognized:!0,data:oe}},[r]),ir=S.useCallback((oe,he)=>{if(he==="multipleChoice")for(let Te=0;Te<oe.length;Te++){const Ce=oe[Te];if(Ce.length<4)return{matches:!1,issue:`Row ${Te+1} has ${Ce.length} columns but needs at least 4`};if(!Ce[0]||Ce[0].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no question in column 1`};if(!Ce[1]||Ce[1].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no correct answer in column 2`}}else if(he==="trueFalse")for(let Te=0;Te<oe.length;Te++){const Ce=oe[Te];if(Ce.length<2)return{matches:!1,issue:`Row ${Te+1} has ${Ce.length} columns but needs at least 2`};if(!Ce[0]||Ce[0].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no question in column 1`};const Ke=Ce[1]?.toString().trim().toLowerCase();if(!Ke||!["true","false","t","f"].includes(Ke))return{matches:!1,issue:`Row ${Te+1} has invalid correct answer in column 2 (must be True/False)`}}else if(he==="input")for(let Te=0;Te<oe.length;Te++){const Ce=oe[Te];if(Ce.length<2)return{matches:!1,issue:`Row ${Te+1} has ${Ce.length} columns but needs at least 2`};if(!Ce[0]||Ce[0].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no question in column 1`};if(!Ce[1]||Ce[1].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no correct answer in column 2`}}return{matches:!0}},[]),me=S.useCallback(oe=>{switch(oe){case"multipleChoice":return`Column 1: Question
Column 2: Correct Answer (A, B, C, D, E, or F)
Column 3: Option A
Column 4: Option B
Column 5: Option C (optional)
Column 6: Option D (optional)
Column 7: Option E (optional)
Column 8: Option F (optional)`;case"trueFalse":return`Column 1: Question
Column 2: Correct Answer (True or False)`;case"input":return`Column 1: Question
Column 2: Correct Answer`;default:return"Unknown test type"}},[]),Ne=S.useCallback(oe=>A.numQuestions||0,[A.numQuestions]),Pe=S.useCallback(oe=>{console.log(` Clearing file input for test type: ${oe}`)},[]),Re=S.useCallback((oe,he)=>{switch(console.log(` populateFromExcelForTestType called with testType: ${he}`),he){case"multipleChoice":case"multiple-choice":Ct(oe);break;case"trueFalse":case"true-false":Fe(oe);break;case"input":st(oe);break;default:console.log(` Unknown test type: ${he}`)}},[]),Ct=S.useCallback(oe=>{console.log(" populateMultipleChoiceFromExcel called with:",oe);const he=Math.max(...oe.map(Ke=>Ke.length-2)),Te=Math.min(he,6);console.log(` Excel data has ${he} option columns, using ${Te} options`),j(Ke=>({...Ke,numOptions:Te}));const Ce={};oe.forEach((Ke,ot)=>{const mt=ot+1;console.log(` Row ${ot+1} data:`,Ke);const Wt={question:(Ke[0]||"").toString().trim(),options:[],correctAnswer:(Ke[1]||"").toString().trim().toUpperCase()};console.log(` Question ${mt} correctAnswer:`,Wt.correctAnswer),["A","B","C","D","E","F"].slice(0,Te).forEach((vr,_r)=>{const gr=(Ke[_r+2]||"").toString().trim();console.log(` Option ${_r} (${vr}):`,gr),Wt.options.push(gr)}),Ce[mt]=Wt}),j(Ke=>{const ot={...Ke,questions:Ce};return console.log(" Updating form data with:",ot),ot}),console.log(" Populated multiple choice questions from Excel:",Ce),r(`Successfully loaded ${oe.length} questions from CSV file!`,"success"),U(),ke("multiple-choice")},[A.numOptions,U,r]),Fe=S.useCallback(oe=>{console.log(" populateTrueFalseFromExcel called with:",oe);const he={};oe.forEach((Te,Ce)=>{const Ke=Ce+1,ot={question:(Te[0]||"").toString().trim(),correctAnswer:Te[1]?.toString().trim().toLowerCase()==="true"?"true":"false"};he[Ke]=ot}),j(Te=>({...Te,questions:he})),console.log(" Populated true/false questions from Excel:",he),r(`Successfully loaded ${oe.length} questions from CSV file!`,"success"),q(),ke("true-false")},[q,r]),st=S.useCallback(oe=>{console.log(" populateInputFromExcel called with:",oe);const he={};oe.forEach((Te,Ce)=>{const Ke=Ce+1,ot=[];for(let Wt=1;Wt<Te.length;Wt++){const pt=(Te[Wt]||"").toString().trim();pt&&ot.push(pt)}const mt={question:(Te[0]||"").toString().trim(),correctAnswer:ot[0]||"",correct_answers:ot};console.log(` Excel question ${Ke} data:`,mt),he[Ke]=mt}),j(Te=>({...Te,questions:he})),console.log(" Populated input questions from Excel:",he),r(`Successfully loaded ${oe.length} questions from Excel file!`,"success"),Q(),ke("input")},[Q,r]),ke=S.useCallback(oe=>{switch(console.log(` Reattaching form event listeners for test type: ${oe}`),document.querySelectorAll('[data-listener-attached="true"]').forEach(Te=>{Te.removeEventListener("input",()=>{}),Te.removeAttribute("data-listener-attached")}),oe){case"multiple-choice":U();break;case"true-false":q();break;case"input":Q();break;default:console.warn("Unknown test type for event listener reattachment:",oe)}console.log(` Form event listeners reattached for test type: ${oe}`)},[U,q,Q]),We=S.useCallback(()=>{const oe=localStorage.getItem("test_creation_state");if(!oe)return console.log(" No test creation state found in localStorage"),!1;try{const he=JSON.parse(oe);console.log(" Found test creation state:",he);const Te=Date.now()-he.timestamp,Ce=1800*1e3;if(Te>Ce)return console.log(" Test creation state is too old, clearing it"),M(),!1;switch(a(!0),console.log(" Restored isInTestCreation flag to true"),ne(),he.excelState&&V(),he.currentStep){case"testTypeSelection":console.log(" Restoring test type selection step"),u("typeSelection");break;case"multipleChoiceForm":console.log(" Restoring multiple choice form step"),p("multipleChoice"),u("formCreation");break;case"trueFalseForm":console.log(" Restoring true/false form step"),p("trueFalse"),u("formCreation");break;case"inputForm":console.log(" Restoring input form step"),p("input"),u("formCreation");break;case"testAssignment":case"assignment":console.log(" Restoring test assignment step"),console.log(" Cannot restore test assignment step without test data, going back to type selection"),u("typeSelection");break;default:console.log(" Unknown step in state, defaulting to type selection"),u("typeSelection")}return R(he.currentStep),!0}catch(he){return console.error(" Error restoring test creation state:",he),M(),!1}},[M,ne,V,R]);S.useEffect(()=>{console.log(" Initializing Teacher Tests..."),ae(),We(),ce(),At()},[ae,We,ce,At]),S.useEffect(()=>{A.numQuestions>0&&g&&g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&(console.log(" Excel upload buttons rendered, initializing event listeners..."),setTimeout(()=>{At()},100))},[A.numQuestions,g,At]);const Qe=oe=>{console.log(" Test type selected:",oe),console.log(" Setting testType to:",oe),p(oe),u("formCreation"),j({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:""}),H("formCreation"),setTimeout(()=>{At()},100)},Pt=(oe,he)=>{j(Te=>({...Te,[oe]:he}))},zt=(oe,he,Te)=>{j(Ce=>({...Ce,questions:{...Ce.questions,[oe]:{...Ce.questions[oe],[he]:Te}}}))},rr=(oe,he,Te,Ce=0)=>{const Ke={};for(let ot=1;ot<=Te;ot++)oe==="multipleChoice"?Ke[ot]={question:"",options:Array.from({length:Ce},()=>""),correctAnswer:""}:oe==="trueFalse"?Ke[ot]={question:"",correctAnswer:""}:oe==="input"&&(Ke[ot]={question:"",correct_answers:[""]});j(ot=>({...ot,questions:Ke})),oe==="multipleChoice"?(se("multiple-choice"),X("multiple-choice")):oe==="trueFalse"?(se("true-false"),X("true-false")):oe==="input"&&(se("input"),X("input"))},xr=async()=>{if(!g||!A.testName||!A.numQuestions){r("Please fill in all required fields","error");return}console.log(" Test form completed, proceeding to assignment step"),H("testAssignment",A),u("testAssignment"),r("Test form completed! Now select classes and subjects.","success")},cr=(oe,he,Te,Ce,Ke)=>{B(Te?ot=>[...ot,{grade:oe,class:he,subject_id:Ce,subject:Ke}]:ot=>ot.filter(mt=>!(mt.grade===oe&&mt.class===he&&mt.subject_id===Ce)))},qr=S.useCallback(async oe=>{console.log(" [DEBUG] handleMatchingTestSave called"),console.log(" [DEBUG] Received testData:",oe),console.log(" [DEBUG] Current formData:",A),console.log(" [DEBUG] Current testType:",g),console.log(" [DEBUG] Current user:",e),console.log(" [DEBUG] Current currentStep:",c),b(!0);try{const he=oe.blocks.map((Ke,ot)=>{const mt=oe.words.find(Yt=>Yt.blockId===Ke.id)?.word||`Word ${ot+1}`,Wt=oe.arrows.some(Yt=>Yt.startBlock===Ke.id),pt=oe.arrows.find(Yt=>Yt.startBlock===Ke.id)||null;return{question_id:ot+1,word:mt,block_coordinates:{x:Ke.x,y:Ke.y,width:Ke.width,height:Ke.height},has_arrow:Wt,arrow:pt?{startX:pt.startX,startY:pt.startY,endX:pt.endX,endY:pt.endY,style:pt.style||{}}:null}}),Te={teacher_id:e.teacher_id,test_name:A.testName||`Matching Test - ${new Date().toLocaleString()}`,image_url:oe.imageUrl,num_blocks:oe.blocks.length,questions:he,assignments:[]};console.log(" Sending matching test payload:",Te);const Ce={...A,testName:Te.test_name,numQuestions:Te.num_blocks,numOptions:0,questions:he.reduce((Ke,ot,mt)=>(Ke[mt+1]={question:ot.word,correctAnswer:ot.word,options:[]},Ke),{}),matchingTestData:oe};console.log(" Assignment form data:",Ce),j(Ce),H("testAssignment",Ce),console.log(" Setting current step to testAssignment"),u("testAssignment"),r("Matching test data saved! Now select classes and subjects.","success")}catch(he){console.error(" Error saving matching test:",he),r("Failed to save matching test: "+he.message,"error")}finally{b(!1)}},[e,A,g,r,H]),ue=S.useCallback(()=>{console.log(" Cancelling matching test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),we=S.useCallback(async oe=>{console.log(" [DEBUG] handleWordMatchingTestSave called"),console.log(" [DEBUG] Received testData:",oe),b(!0);try{j(he=>({...he,wordMatchingData:oe,numQuestions:oe.numQuestions||oe.wordPairs?.length||0})),u("testAssignment"),r("Word matching test created! Now assign it to classes.","success")}catch(he){console.error("Error saving word matching test:",he),r("Failed to save word matching test: "+he.message,"error")}finally{b(!1)}},[r]),ye=S.useCallback(()=>{console.log(" Cancelling word matching test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),xe=S.useCallback(async oe=>{console.log(" [DEBUG] handleDrawingTestSave called"),console.log(" [DEBUG] Received testData:",oe),b(!0);try{j(he=>({...he,drawingData:oe,numQuestions:oe.num_questions||oe.questions?.length||0})),u("testAssignment"),r("Drawing test created! Now assign it to classes.","success")}catch(he){console.error(" Error saving drawing test:",he),r("Error saving drawing test","error")}finally{b(!1)}},[r]),be=S.useCallback(()=>{console.log(" Cancelling drawing test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),_e=S.useCallback(()=>{console.log(" Cancelling fill blanks test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),Ge=S.useCallback(async oe=>{console.log(" [DEBUG] handleFillBlanksTestSave called"),console.log(" [DEBUG] Received testData:",oe),b(!0);try{j(he=>({...he,fillBlanksData:oe,numQuestions:oe.num_questions||oe.blanks?.length||0})),u("testAssignment"),r("Fill blanks test created! Now assign it to classes.","success")}catch(he){console.error(" Error saving fill blanks test:",he),r("Error saving fill blanks test","error")}finally{b(!1)}},[r]),ut=S.useCallback(()=>{console.log(" Cancelling speaking test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),qe=S.useCallback(async oe=>{console.log(" [DEBUG] handleSpeakingTestSave called"),console.log(" [DEBUG] Received testData:",oe),b(!0);try{j(he=>({...he,speakingData:oe,numQuestions:oe.questions?.length||0})),u("testAssignment"),r("Speaking test created! Now assign it to classes.","success")}catch(he){console.error(" Error saving speaking test:",he),r("Error saving speaking test","error")}finally{b(!1)}},[r]);return l.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[l.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs(wo,{mode:"wait",children:[c==="typeSelection"&&l.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs(Ye,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{children:"Back to Main"})]}),l.jsx("div",{className:"flex-1"})]}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Create New Test"}),l.jsx("p",{className:"text-gray-600",children:"Choose the type of test you want to create"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{type:"multipleChoice",title:"Multiple Choice",description:"Questions with multiple answer options",icon:"/pics/multiple-choice.png"},{type:"trueFalse",title:"True/False",description:"Questions with true or false answers",icon:"/pics/true-false.png"},{type:"input",title:"Input",description:"Questions requiring text input",icon:"/pics/input.png"},{type:"matching",title:"Picture Matching",description:"Labeling pictures",icon:"/pics/matching.png"},{type:"wordMatching",title:"Word Matching",description:"Matching word pairs by dragging or drawing arrows",icon:"/pics/matching-words.png"},{type:"drawing",title:"Drawing Test",description:"Interactive drawing tests with canvas for students",icon:"/pics/drawing.png"},{type:"fillBlanks",title:"Fill Blanks",description:"Text with multiple choice blanks",icon:"/pics/fill-blanks.png"},{type:"speaking",title:"Speaking Test",description:"Audio recording with AI-powered feedback",icon:"/pics/speaking.png"}].map(({type:oe,title:he,description:Te,icon:Ce})=>l.jsx(nt.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"cursor-pointer",onClick:()=>Qe(oe),children:l.jsxs(Nt,{className:"h-full text-center hover:shadow-lg transition-shadow",children:[l.jsx("div",{className:"mb-3 flex justify-center",children:l.jsx("img",{src:Ce,alt:he,className:"w-12 h-12 object-contain"})}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:he}),l.jsx("p",{className:"text-sm text-gray-600",children:Te})]})},oe))})]}),c==="formCreation"&&l.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"flex space-x-2",children:l.jsx(Ye,{variant:"outline",onClick:ee,children:" Back to Test Types"})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Create ",g==="multipleChoice"?"Multiple Choice":g==="trueFalse"?"True/False":g==="input"?"Input":g==="drawing"?"Drawing":g==="fillBlanks"?"Fill Blanks":g==="wordMatching"?"Word Matching":g==="speaking"?"Speaking":"Picture Matching"," Test"]}),l.jsx("p",{className:"text-gray-600",children:"Fill in the test details and questions"})]})]})}),l.jsx(Nt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Information"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Name"}),l.jsx("input",{type:"text",value:A.testName,onChange:oe=>Pt("testName",oe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter test name"})]}),g!=="matching"&&g!=="wordMatching"&&g!=="drawing"&&g!=="fillBlanks"&&g!=="speaking"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Questions"}),l.jsx("input",{type:"number",min:"1",max:"50",value:A.numQuestions,onChange:oe=>{const he=parseInt(oe.target.value)||0;Pt("numQuestions",he),he>0&&rr(g,A.testName,he,A.numOptions)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of questions"})]}),g==="multipleChoice"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Options per Question"}),l.jsx("input",{type:"number",min:"2",max:"6",value:A.numOptions,onChange:oe=>{const he=parseInt(oe.target.value)||0;Pt("numOptions",he),he>0&&he<2&&r("Multiple choice tests require at least 2 options per question. Please enter 2 or more.","warning"),A.numQuestions>0&&rr(g,A.testName,A.numQuestions,he)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of options (2-6)"})]}),g!=="speaking"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("label",{className:"inline-flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",checked:!!A.enableTimer,onChange:oe=>Pt("enableTimer",oe.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),l.jsx("span",{className:"text-sm text-gray-700",children:"Enable timer for this test"})]}),A.enableTimer&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm text-gray-700",children:"Time (minutes):"}),l.jsx("input",{type:"number",min:"1",max:"1440",value:A.timerMinutes,onChange:oe=>Pt("timerMinutes",oe.target.value.replace(/[^0-9]/g,"")),className:"w-28 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 30"})]})]}),g!=="drawing"&&g!=="matching"&&g!=="wordMatching"&&g!=="fillBlanks"&&g!=="speaking"&&l.jsx("div",{className:"flex items-center space-x-2",children:l.jsxs("label",{className:"inline-flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",checked:!!A.isShuffled,onChange:oe=>Pt("isShuffled",oe.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),l.jsx("span",{className:"text-sm text-gray-700",children:"Shuffle questions during test"})]})})]})]})}),g==="matching"&&l.jsx(Nt,{children:l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Picture Matching Test"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Upload an image and create interactive matching blocks with words."}),l.jsx(Xee,{testName:A.testName,onTestSaved:qr,onCancel:ue,onBackToCabinet:Ae,isSaving:k,validationErrors:{}})]})}),g==="wordMatching"&&l.jsx(Nt,{children:l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Word Matching Test"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Create word pairs for students to match by dragging or drawing arrows."}),l.jsx(Jse,{testName:A.testName,onTestSaved:we,onCancel:ye,onBackToCabinet:Ae,isSaving:k,validationErrors:{}})]})}),g==="drawing"&&l.jsxs(Nt,{children:[console.log(" Rendering DrawingTestCreator, testType:",g),l.jsx(Use,{testName:A.testName,onTestSaved:xe,onCancel:be,onBackToCabinet:Ae,isSaving:k,validationErrors:{}})]}),g==="fillBlanks"&&l.jsxs(Nt,{children:[console.log(" Rendering FillBlanksTestCreator, testType:",g),l.jsx(Gse,{testName:A.testName,allowedTime:A.enableTimer&&parseInt(A.timerMinutes)||null,onTestSaved:Ge,onCancel:_e,onBackToCabinet:Ae,isSaving:k,validationErrors:{}})]}),g==="speaking"&&l.jsxs(Nt,{children:[console.log(" Rendering SpeakingTestCreator, testType:",g),l.jsx(Kse,{testName:A.testName,onTestSaved:qe,onCancel:ut,onBackToCabinet:Ae,isSaving:k,validationErrors:{}})]}),g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&g!=="speaking"&&A.numQuestions>0&&l.jsx(Nt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Excel Upload"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Upload an Excel file to automatically populate questions, or fill them in manually below."}),l.jsxs("div",{className:"space-y-6",children:[g==="multipleChoice"&&Ue.multipleChoice?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"multiple-choice",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx(zr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"multiple-choice"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Multiple Choice Format:"}),l.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[l.jsx("div",{children:"Column 1: Question"}),l.jsx("div",{children:"Column 2: Correct Answer (A-F)"}),l.jsx("div",{children:"Column 3: Option A text"}),l.jsx("div",{children:"Column 4: Option B text"}),l.jsx("div",{children:"Column 5: Option C text"}),l.jsx("div",{children:"Column 6: Option D text"})]})]})})})]}),g==="trueFalse"&&Ue.trueFalse?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"true-false",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx(zr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"true-false"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-xs text-blue-800",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Format:"})," Question | Answer (true/false)"]}),l.jsxs("div",{className:"mt-1",children:[l.jsx("strong",{children:"Example:"})," The Earth is round | true"]}),l.jsxs("div",{className:"mt-1",children:[l.jsx("strong",{children:"Note:"})," Headers are optional"]})]})})})]}),g==="input"&&Ue.input?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"input",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx(zr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"input"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Input Test Format:"}),l.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[l.jsx("div",{children:"Column 1: Question"}),l.jsx("div",{children:"Column 2: Answer 1"}),l.jsx("div",{children:"Column 3: Answer 2 (optional)"})]})]})})})]})]})]})}),g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&A.numQuestions>0&&l.jsx(Nt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Manual Question Entry"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Fill in the questions manually using the form below."})]})}),A.numQuestions>0&&l.jsx(Nt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Questions"}),l.jsx("div",{className:"space-y-6",children:Object.keys(A.questions).map(oe=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Question ",oe]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text"}),l.jsx("textarea",{value:A.questions[oe]?.question||"",onChange:he=>zt(oe,"question",he.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"2",placeholder:"Enter the question text"})]}),g==="multipleChoice"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Answer Options"}),l.jsx("div",{className:"space-y-2",children:A.questions[oe]?.options?.map((he,Te)=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("span",{className:"w-6 text-sm font-medium text-gray-700",children:[String.fromCharCode(65+Te),":"]}),l.jsx("input",{type:"text",value:he,onChange:Ce=>{const Ke=[...A.questions[oe].options];Ke[Te]=Ce.target.value,zt(oe,"options",Ke)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Option ${String.fromCharCode(65+Te)}`})]},Te))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer"}),g==="multipleChoice"?l.jsx("div",{children:l.jsxs("select",{value:A.questions[oe]?.correctAnswer||"",onChange:he=>zt(oe,"correctAnswer",he.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),A.questions[oe]?.options?.map((he,Te)=>l.jsx("option",{value:String.fromCharCode(65+Te),children:String.fromCharCode(65+Te)},Te))]})}):g==="trueFalse"?l.jsxs("select",{value:A.questions[oe]?.correctAnswer||"",onChange:he=>zt(oe,"correctAnswer",he.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),l.jsx("option",{value:"true",children:"True"}),l.jsx("option",{value:"false",children:"False"})]}):l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer(s)"}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("input",{type:"text",value:A.questions[oe]?.correct_answers?.[0]||"",onChange:he=>{const Ce=[...A.questions[oe]?.correct_answers||[""]];Ce[0]=he.target.value,zt(oe,"correct_answers",Ce)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter the primary correct answer"}),A.questions[oe]?.correct_answers?.slice(1).map((he,Te)=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"text",value:he,onChange:Ce=>{const Ke=[...A.questions[oe]?.correct_answers||[]];Ke[Te+1]=Ce.target.value,zt(oe,"correct_answers",Ke)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Alternative answer ${Te+2}`}),l.jsx("button",{type:"button",onClick:()=>{const Ce=[...A.questions[oe]?.correct_answers||[]];Ce.splice(Te+1,1),zt(oe,"correct_answers",Ce)},className:"px-2 py-1 text-red-600 hover:text-red-800 text-sm",children:"Remove"})]},Te))||[],l.jsx("button",{type:"button",onClick:()=>{const Te=[...A.questions[oe]?.correct_answers||[""],""];zt(oe,"correct_answers",Te)},className:"px-3 py-1 text-blue-600 hover:text-blue-800 text-sm border border-blue-300 rounded-md hover:bg-blue-50",children:"+ Add Alternative Answer"})]}),l.jsx("p",{className:"text-xs text-gray-500",children:"You can add multiple correct answers for the same question. Students will get credit for any of them."})]})]})]})]},oe))})]})}),A.testName&&A.numQuestions>0&&l.jsx("div",{className:"flex justify-end",children:l.jsx(Ye,{onClick:xr,disabled:k,className:"px-8",children:k?l.jsxs(l.Fragment,{children:[l.jsx(zr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test & Continue to Assignment"})})]}),c==="testAssignment"&&l.jsxs(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs(Ye,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{children:"Back to Main"})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Assign Test to Classes"}),l.jsx("p",{className:"text-gray-600",children:"Select which classes should take this test"})]})]}),l.jsx(Ye,{variant:"outline",onClick:()=>u("formCreation"),children:" Back to Test Form"})]}),l.jsx(Nt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Available Classes"}),x.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("p",{className:"text-gray-500 text-lg",children:"No subjects available for assignment."}),l.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You need to assign subjects to grades and classes first."}),l.jsx("div",{className:"mt-4",children:l.jsx(Ye,{onClick:()=>window.location.href="/teacher/subjects",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Go to Subjects Page"})})]}):l.jsx("div",{className:"space-y-6",children:x.map(oe=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:oe.subject}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2",children:oe.classes.map(he=>l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:I.some(Te=>Te.grade===he.grade&&Te.class===he.class&&Te.subject_id===oe.subject_id),onChange:Te=>cr(he.grade,he.class,Te.target.checked,oe.subject_id,oe.subject),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),l.jsxs("span",{className:"text-sm text-gray-700",children:[he.grade,"/",he.class]})]},`${he.grade}-${he.class}-${oe.subject_id}`))})]},oe.subject_id))})]})}),I.length>0&&l.jsx("div",{className:"flex justify-end",children:l.jsx(Ye,{onClick:()=>Ee(g,null),disabled:w,className:"px-8",children:w?l.jsxs(l.Fragment,{children:[l.jsx(zr,{size:"sm",color:"white",className:"mr-2"}),"Assigning Test..."]}):`Assign Test to ${I.length} Class${I.length>1?"es":""}`})})]})]})}),console.log(" Checking isAssigningTest:",P),P&&l.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Assigning test to classes..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your assignment"})]})}),k&&l.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Saving test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we save your test"})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:t.map(oe=>l.jsx(uc,{type:oe.type,message:oe.message,duration:oe.duration,onClose:()=>n(oe.id)},oe.id))})]})},b3e=({onDataLoaded:e,onError:t})=>{const r=Eo(),{user:n,isAuthenticated:s}=cs(),{teacherData:a,loadTeacherData:i}=r2(),[o,c]=S.useState(!0),[u,d]=S.useState(""),[h,g]=S.useState([]),[p,x]=S.useState(null),[v,w]=S.useState([]),[C,k]=S.useState([]),[b,N]=S.useState([]),[E,P]=S.useState(null),[F,A]=S.useState(0);S.useEffect(()=>{ae()},[]),S.useCallback(async ne=>{console.log(" Teacher login attempt...");try{const L=await hs.teacherLogin(ne);if(L.success)return Z("Login successful!","success"),await j(),L;throw new Error(L.error||"Login failed")}catch(L){throw console.error(" Teacher login error:",L),Z("Login failed. Please check your credentials.","error"),L}},[]);const j=S.useCallback(async()=>{console.log(" Loading teacher data...");try{if(c(!0),d(""),!s||!n){console.log(" User not authenticated"),d("User not authenticated");return}if(n.role!==Ji.TEACHER){console.error(" Invalid user role for teacher data:",n.role),d("Access denied. Teacher role required.");return}console.log(" Fetching teacher data from service...");const ne=await hs.getTeacherData();if(ne&&ne.success)console.log(" Teacher data loaded successfully:",ne),x(ne.teacher||n),ne.subjects&&(w(ne.subjects),console.log(" Teacher subjects loaded:",ne.subjects.length)),ne.grades&&k(ne.grades),ne.classes&&N(ne.classes),P(new Date),A(L=>L+1),e&&e(ne),Z("Teacher data loaded successfully!","success");else throw new Error(ne?.error||"Failed to load teacher data")}catch(ne){console.error(" Error loading teacher data:",ne);const L=ne.message||"Failed to load teacher data";d(L),t&&t(ne),Z(L,"error")}finally{c(!1)}},[s,n,e,t]),I=S.useCallback(()=>{console.log(" Returning to main cabinet..."),r("/teacher/cabinet")},[r]);S.useCallback(ne=>{console.log(" Showing main cabinet with subjects:",ne),ne&&w(ne),r("/teacher/cabinet")},[r]);const B=S.useCallback(()=>(console.log(" Rendering grade buttons..."),["M1","M2","M3","M4","M5","M6"].map(L=>({id:L,name:`Grade ${L}`,classes:Y(L)}))),[]),Y=S.useCallback(ne=>Array.from({length:10},(H,M)=>M+1).map(H=>({id:`${ne}-${H}`,name:`Class ${H}`,grade:ne,classNumber:H})),[]),Z=S.useCallback((ne,L)=>{const H={id:Date.now(),message:ne,type:L,timestamp:new Date};g(M=>[...M,H]),setTimeout(()=>{g(M=>M.filter(V=>V.id!==H.id))},N0.NOTIFICATION_DURATION)},[]),ae=S.useCallback(async()=>{console.log(" Initializing teacher data..."),await j()},[j]),ee=S.useCallback(async()=>{console.log(" Refreshing teacher data..."),await j()},[j]);return S.useCallback(async ne=>{console.log(" Updating teacher profile:",ne);try{const L=await hs.updateUserProfile(ne);if(L.success)return x(H=>({...H,...ne})),Z("Profile updated successfully!","success"),L;throw new Error(L.error||"Failed to update profile")}catch(L){throw console.error(" Error updating teacher profile:",L),Z("Failed to update profile","error"),L}},[]),S.useCallback(async ne=>{console.log(" Changing teacher password...");try{const L=await hs.changePassword(ne);if(L.success)return Z("Password changed successfully!","success"),L;throw new Error(L.error||"Failed to change password")}catch(L){throw console.error(" Error changing teacher password:",L),Z("Failed to change password","error"),L}},[]),o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(zr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Data..."})]})}):u?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Data Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:u}),l.jsxs("div",{className:"flex space-x-3 justify-center",children:[l.jsx(Ye,{variant:"primary",onClick:ee,children:"Retry"}),l.jsx(Ye,{variant:"outline",onClick:I,children:"Go Back"})]})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teacher Data"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",E?E.toLocaleString():"Never"," | Version: ",F]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx(Ye,{variant:"outline",onClick:ee,children:"Refresh Data"}),l.jsx(Ye,{variant:"outline",onClick:I,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teacher Information"}),p?l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Name:"}),l.jsx("p",{className:"text-sm text-gray-900",children:p.name||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Username:"}),l.jsx("p",{className:"text-sm text-gray-900",children:p.username||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Email:"}),l.jsx("p",{className:"text-sm text-gray-900",children:p.email||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Role:"}),l.jsx("p",{className:"text-sm text-gray-900",children:p.role||"N/A"})]})]}):l.jsx("p",{className:"text-gray-500",children:"No teacher information available"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Subjects (",v.length,")"]}),v.length>0?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.map((ne,L)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h3",{className:"font-medium text-gray-900",children:ne.name}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:ne.description||"No description"}),ne.classes&&ne.classes.length>0&&l.jsxs("div",{className:"mt-2",children:[l.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:ne.classes.map((H,M)=>l.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:[H.grade," - ",H.className]},M))})]})]},L))}):l.jsx("p",{className:"text-gray-500",children:"No subjects assigned"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Grade Levels"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:B().map(ne=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:ne.name}),l.jsx("div",{className:"grid grid-cols-5 gap-1",children:ne.classes.map(L=>l.jsx("button",{className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded transition-colors",onClick:()=>console.log("Class clicked:",L),children:L.classNumber},L.id))})]},ne.id))})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Statistics"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-blue-600",children:v.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Subjects"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-green-600",children:C.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Grades"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-yellow-600",children:b.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Classes"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-purple-600",children:F}),l.jsx("p",{className:"text-sm text-gray-500",children:"Data Version"})]})]})]})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:h.map(ne=>l.jsx(uc,{type:ne.type,message:ne.message,onClose:()=>g(L=>L.filter(H=>H.id!==ne.id))},ne.id))})]})},_3e=({onBackToCabinet:e})=>{const t=Eo(),{user:r,isAuthenticated:n}=cs(),{teacherData:s}=r2(),[a,i]=S.useState(!0),[o,c]=S.useState(""),[u,d]=S.useState([]),[h,g]=S.useState([]),[p,x]=S.useState([]),[v,w]=S.useState([]),[C,k]=S.useState(null),[b,N]=S.useState([]),[E,P]=S.useState(!1),[F,A]=S.useState(!1),[j,I]=S.useState(!1),[B,Y]=S.useState(!1),[Z,ae]=S.useState(null),[ee,ne]=S.useState(!0),[L,H]=S.useState(null);S.useEffect(()=>{Be()},[]),S.useCallback(et=>{console.log(" Rendering existing subjects:",et),g(et)},[]);const M=S.useCallback(()=>{console.log(" Showing subject selection prompt..."),P(!0),ne(!1),V()},[]),V=S.useCallback(async()=>{console.log(" Loading existing subjects...");try{const et=await hs.getTeacherSubjects();et.success&&et.subjects&&et.subjects.length>0?(console.log(" Existing subjects found:",et.subjects),W(et.subjects)):(console.log(" No existing subjects found"),w([]))}catch(et){console.error(" Error loading existing subjects:",et),He("Failed to load existing subjects","error")}},[]),W=S.useCallback(et=>{console.log(" Rendering subject selection:",et);const vt=[];et.forEach(xt=>{xt.classes&&Array.isArray(xt.classes)&&xt.classes.forEach(it=>{vt.push({id:`${xt.subject_id}-${it.grade}-${it.class}`,subjectId:xt.subject_id,subjectName:xt.subject,grade:it.grade,class:it.class,displayText:`${xt.subject} - ${it.grade}/${it.class}`})})}),w(vt),console.log(" Processed subjects for selection:",vt)},[]),R=S.useCallback(async et=>{if(console.log(" Saving teacher subjects:",et),!et||et.length===0){He("Please select at least one subject and class combination.","warning");return}try{const vt=et.reduce((it,ht)=>{const Dt=it.find(Mt=>Mt.subject_id===ht.subjectId);return Dt?Dt.classes.push({grade:ht.grade,class:ht.class}):it.push({subject_id:ht.subjectId,classes:[{grade:ht.grade,class:ht.class}]}),it},[]);console.log(" Transformed data for backend:",vt);const xt=await hs.saveTeacherSubjects(vt);if(xt.success)He("Subjects saved successfully!","success"),P(!1),ne(!0),H(new Date),await V();else throw new Error(xt.error||"Failed to save subjects")}catch(vt){console.error(" Error saving subjects:",vt),He("Error saving subjects. Please try again.","error")}},[]),U=S.useCallback(()=>{console.log(" Toggling subject dropdown..."),A(et=>!et),I(!1)},[]),q=S.useCallback(async()=>{console.log(" Loading subjects for dropdown...");try{const et=await hs.getAllSubjects();if(et.success)x(et.subjects||[]),console.log(" Available subjects loaded:",et.subjects?.length||0);else throw new Error(et.error||"Failed to load subjects")}catch(et){console.error(" Error loading subjects for dropdown:",et),He("Failed to load subjects","error")}},[]),Q=S.useCallback(et=>{console.log(" Subject selected:",et);const vt=p.find(xt=>xt.subject_id===parseInt(et));vt&&(k(vt),I(!0),A(!1),se())},[p]),se=S.useCallback(()=>{console.log(" Loading grades and classes...")},[]),X=S.useCallback((et,vt)=>{console.log(" Saving classes for subject:",et,vt);const xt={id:`${et.subject_id}-${Date.now()}`,subjectId:et.subject_id,subjectName:et.subject,grade:vt.grade,class:vt.class,displayText:`${et.subject} - ${vt.grade}/${vt.class}`};w(it=>[...it,xt]),k(null),N([]),I(!1),le(`Added ${et.subject} for ${vt.grade}/${vt.class}`)},[]),ie=S.useCallback(()=>{console.log(" Resetting subject selection..."),k(null),N([]),A(!1),I(!1)},[]),le=S.useCallback(et=>{console.log(" Showing message:",et),He(et,"success")},[]),ce=S.useCallback(et=>{console.log(" Showing confirmation modal:",et),ae(et),Y(!0)},[]),Se=S.useCallback(()=>{console.log(" Hiding confirmation modal..."),Y(!1),ae(null)},[]),re=S.useCallback(()=>{console.log(" Confirming save subjects..."),Se(),R(v)},[v,R,Se]),ge=S.useCallback(()=>{console.log(" Cancelling save subjects..."),Se()},[Se]),Ee=S.useCallback(et=>{console.log(" Removing subject:",et),w(vt=>vt.filter(xt=>xt.id!==et)),He("Subject removed","info")},[]);S.useCallback(()=>{console.log(" Showing edit subjects button..."),ne(!0)},[]),S.useCallback(()=>{console.log(" Hiding edit subjects button..."),ne(!1)},[]);const Ae=S.useCallback(et=>{console.log(" Generating class buttons for grade:",et);let vt;return et===1||et===2?vt=["15","16"]:et===3?vt=["15","16"]:et===4?vt=["13","14"]:et===5||et===6?vt=["13","14"]:vt=[],vt.map(xt=>({id:`${et}-${xt}`,grade:et,class:xt,displayText:`${et}/${xt}`}))},[]);S.useCallback((et,vt)=>{console.log(" Showing class results:",et,vt),t("/teacher/results")},[t]);const He=S.useCallback((et,vt)=>{const xt={id:Date.now(),message:et,type:vt,timestamp:new Date};d(it=>[...it,xt]),setTimeout(()=>{d(it=>it.filter(ht=>ht.id!==xt.id))},N0.NOTIFICATION_DURATION)},[]),Be=S.useCallback(async()=>{console.log(" Initializing teacher subjects...");try{if(i(!0),c(""),!n||!r){console.log(" User not authenticated"),c("User not authenticated");return}if(r.role!==Ji.TEACHER){console.error(" Invalid user role for teacher subjects:",r.role),c("Access denied. Teacher role required.");return}await V(),await q(),console.log(" Teacher subjects initialization complete!")}catch(et){console.error(" Error initializing teacher subjects:",et),c("Failed to initialize teacher subjects")}finally{i(!1)}},[n,r,V,q]),Rt=S.useCallback(()=>{e?e():t("/teacher/cabinet")},[e,t]);return a?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(zr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Subjects..."})]})}):o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Subjects Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:o}),l.jsx(Ye,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Subject Management"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",L?L.toLocaleString():"Never"]})]}),l.jsxs("div",{className:"flex space-x-3",children:[ee&&l.jsx(Ye,{variant:"primary",onClick:M,children:"Edit Subjects"}),l.jsx(Ye,{variant:"outline",onClick:Rt,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[!E&&l.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Your Assigned Subjects"}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your teaching subjects and class assignments"})]}),l.jsx("div",{className:"flex space-x-3",children:l.jsxs(Ye,{variant:"primary",onClick:M,className:"px-6 py-2",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Subjects"]})})]}),h.length>0?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map((et,vt)=>l.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:et.subject}),et.classes&&et.classes.length>0&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Assigned Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:et.classes.map((xt,it)=>l.jsxs("span",{className:"px-3 py-1 bg-blue-500 text-white text-sm font-medium rounded-full",children:["Grade ",xt.grade," - Class ",xt.class]},it))})]})]}),l.jsx("div",{className:"ml-4",children:l.jsx(Ye,{variant:"outline",size:"sm",onClick:()=>Ee(et.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]})},vt))}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:l.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned yet"}),l.jsx("p",{className:"text-gray-500 mb-6",children:"Get started by adding your teaching subjects and class assignments"}),l.jsxs(Ye,{variant:"primary",onClick:M,className:"px-6 py-3",children:[l.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Your First Subject"]})]})]}),E&&l.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Select Subjects and Classes"}),l.jsx("p",{className:"text-gray-600",children:"Choose the subjects you want to teach and assign them to specific classes"})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:"1"})}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-lg font-semibold text-gray-900",children:"Select Subject"}),l.jsx("p",{className:"text-gray-600",children:"Choose the subject you want to teach"})]})]}),l.jsxs("div",{className:"relative",children:[l.jsxs(Ye,{variant:"outline",onClick:U,className:"w-full justify-between p-4 h-auto text-left border-2 border-gray-200 hover:border-blue-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white rounded-xl shadow-sm",children:[l.jsx("span",{className:"text-gray-900 font-medium",children:C?C.subject:"Select a subject"}),l.jsx("svg",{className:"w-5 h-5 ml-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),F&&l.jsx("div",{className:"absolute z-10 w-full mt-2 bg-white border-2 border-gray-200 rounded-xl shadow-xl max-h-60 overflow-y-auto",children:p.map(et=>l.jsx("button",{onClick:()=>Q(et.subject_id),className:"w-full px-4 py-4 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 border-b border-gray-100 last:border-b-0",children:l.jsx("span",{className:"text-gray-900 font-medium",children:et.subject})},et.subject_id))})]})]}),j&&C&&l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-6",children:[l.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-green-600 font-semibold text-sm",children:"2"})}),l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Select Classes for ",C.subject]}),l.jsx("p",{className:"text-gray-600",children:"Choose which classes you want to teach this subject to"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(et=>l.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-2",children:l.jsx("span",{className:"text-white font-bold text-xs",children:et})}),l.jsxs("h4",{className:"font-semibold text-gray-900",children:["Grade ",et]})]}),l.jsx("div",{className:"space-y-3",children:Ae(et).map(vt=>l.jsx(Ye,{variant:"outline",size:"sm",onClick:()=>X(C,vt),className:"w-full text-sm py-2 px-4 border-green-300 hover:border-green-400 hover:bg-green-100 focus:ring-2 focus:ring-green-500 rounded-lg font-medium",children:vt.displayText},vt.id))})]},et))})]}),v.length>0&&l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:"3"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Selected Subjects"}),l.jsx("p",{className:"text-gray-600",children:"Review your subject and class selections"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:v.map(et=>l.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-4 hover:shadow-md transition-shadow duration-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"flex-1",children:l.jsx("span",{className:"text-sm font-semibold text-purple-900",children:et.displayText})}),l.jsx(Ye,{variant:"outline",size:"sm",onClick:()=>Ee(et.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300 focus:ring-2 focus:ring-red-500 rounded-lg",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},et.id))})]}),l.jsxs("div",{className:"flex justify-between items-center pt-6 border-t-2 border-gray-100",children:[l.jsx("div",{className:"text-sm text-gray-500",children:v.length>0?`${v.length} subject${v.length>1?"s":""} selected`:"No subjects selected"}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs(Ye,{variant:"outline",onClick:()=>{P(!1),ne(!0),ie()},className:"px-6 py-3 text-sm font-medium text-gray-700 bg-white border-2 border-gray-300 hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 rounded-xl",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Cancel"]}),l.jsxs(Ye,{variant:"primary",onClick:()=>ce({type:"save",data:v}),disabled:v.length===0,className:"px-8 py-3 text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-indigo-600 border border-transparent rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),j?"Next: Select Classes":"Save Subjects"]})]})]})]})]})]})}),B&&l.jsx(oa,{isOpen:B,onClose:Se,title:"Confirm Save",variant:"confirmation",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to save ",Z?.data?.length||0," subject assignments?"]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx(Ye,{variant:"outline",onClick:ge,children:"Cancel"}),l.jsx(Ye,{variant:"primary",onClick:re,children:"Save"})]})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:u.map(et=>l.jsx(uc,{type:et.type,message:et.message,onClose:()=>d(vt=>vt.filter(xt=>xt.id!==et.id))},et.id))})]})},S3e=()=>{const{user:e,role:t,isAuthenticated:r,isLoading:n}=cs(),[s,a]=S.useState("cabinet");return!r||t!=="teacher"?l.jsx(pm,{to:"/login",replace:!0}):n?l.jsxs("div",{className:"teacher-app-loading",children:[l.jsx(zr,{}),l.jsx("p",{children:"Loading teacher interface..."})]}):l.jsx("div",{className:"teacher-app",children:l.jsxs(gN,{children:[l.jsx(Os,{path:"/",element:l.jsx(hM,{})}),l.jsx(Os,{path:"/cabinet",element:l.jsx(hM,{})}),l.jsx(Os,{path:"/tests",element:l.jsx(gM,{})}),l.jsx(Os,{path:"/tests/create",element:l.jsx(gM,{})}),l.jsx(Os,{path:"/data",element:l.jsx(b3e,{})}),l.jsx(Os,{path:"/subjects",element:l.jsx(_3e,{})}),l.jsx(Os,{path:"/results",element:l.jsx(ez,{})}),l.jsx(Os,{path:"*",element:l.jsx(pm,{to:"/teacher",replace:!0})})]})})},Oe={container:"min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100",mainContainer:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",header:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg",headerContent:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",headerFlex:"flex justify-between items-center",adminInfo:"flex items-center space-x-4",adminAvatar:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",adminText:"text-lg sm:text-xl md:text-2xl font-bold text-white",adminSubtext:"text-purple-100 text-sm sm:text-base md:text-lg",menuContainer:"relative admin-menu",menuButton:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",menuDropdown:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",menuItem:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-purple-50 transition-colors",menuItemLogout:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",cardContainer:"bg-white rounded-xl shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-300",cardHeader:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-indigo-50",cardTitle:"text-xl font-bold text-gray-800",cardBody:"p-6",buttonGroup:"flex flex-wrap gap-3 mb-6",buttonPrimary:"bg-purple-600 hover:bg-purple-700 text-white font-medium px-4 py-2 rounded-lg transition-colors duration-200",buttonSecondary:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium px-4 py-2 rounded-lg transition-colors duration-200",formContainer:"bg-gray-50 rounded-lg p-6 border border-gray-200",formGrid:"grid grid-cols-1 md:grid-cols-2 gap-4",formGroup:"space-y-2",formLabel:"block text-sm font-medium text-gray-700",formInput:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors duration-200",formCheckbox:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded",formActions:"flex space-x-3 pt-4",table:"min-w-full divide-y divide-gray-200",tableHeader:"bg-gray-50",tableHeaderCell:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",tableBody:"bg-white divide-y divide-gray-200",tableRow:"hover:bg-gray-50 transition-colors duration-150",tableCell:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",statusActive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",statusInactive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",modalOverlay:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",modalContent:"bg-white rounded-lg p-6 w-full max-w-md mx-4 shadow-xl",modalTitle:"text-xl font-semibold text-gray-900 mb-4",modalActions:"flex space-x-3 pt-4"},k3e=()=>{const{user:e,isAdmin:t,logout:r}=cs(),{get:n,post:s,delete:a}=Qo(),i=S.useCallback(async()=>{try{g({type:"info",message:"Checking for overdue assignments..."});const fe=await s("/.netlify/functions/check-overdue-assignments",{});if(fe&&fe.success){const wt=fe.overdue_count||0;wt>0?g({type:"success",message:`Found and marked ${wt} overdue assignments as inactive.`}):g({type:"info",message:"No overdue assignments found."})}else g({type:"error",message:fe?.error||"Failed to check assignments"})}catch(fe){g({type:"error",message:"Failed to check assignments"}),console.error("Check overdue assignments error:",fe)}},[s]),[o,c]=S.useState(!1),[u,d]=S.useState(null),[h,g]=S.useState(null),[p,x]=S.useState(!1),[v,w]=S.useState(!1),[C,k]=S.useState(!1),[b,N]=S.useState(!1),[E,P]=S.useState(""),[F,A]=S.useState(null),[j,I]=S.useState({}),[B,Y]=S.useState(null),[Z,ae]=S.useState({}),[ee,ne]=S.useState(null),[L,H]=S.useState({}),[M,V]=S.useState([]),[W,R]=S.useState(""),[U,q]=S.useState(""),[Q,se]=S.useState(""),[X,ie]=S.useState(!0),[le,ce]=S.useState(!1),[Se,re]=S.useState([]),[ge,Ee]=S.useState(""),[Ae,He]=S.useState(""),[Be,Rt]=S.useState(""),[et,vt]=S.useState(!1),[xt,it]=S.useState(!1),[ht,Dt]=S.useState([]),[Mt,Xe]=S.useState([]),[De,Le]=S.useState([]),[lt,Ue]=S.useState([]),[tt,Et]=S.useState(!1),[At,qt]=S.useState(!1),[pr,Rr]=S.useState(!1),[Kr,ur]=S.useState(!1),[ir,me]=S.useState({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),[Ne,Pe]=S.useState({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),[Re,Ct]=S.useState({subject_id:"",subject:"",description:"",is_active:!0}),[Fe,st]=S.useState({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""});S.useEffect(()=>{console.log(" AdminCabinet component mounted - initializing..."),ke()},[]),S.useEffect(()=>{const fe=wt=>{et&&!wt.target.closest(".admin-menu")&&vt(!1)};return document.addEventListener("mousedown",fe),()=>{document.removeEventListener("mousedown",fe)}},[et]);const ke=S.useCallback(async()=>{try{c(!0),await zt(),console.log("Admin app initialized")}catch(fe){d("Failed to initialize admin app"),console.error("Admin app initialization error:",fe)}finally{c(!1)}},[]),We=S.useCallback(()=>{vt(fe=>!fe)},[]),Qe=S.useCallback(()=>{it(!0),vt(!1)},[]),Pt=S.useCallback(()=>{it(!1)},[]),zt=S.useCallback(async()=>{try{await Promise.all([rr(),xr(),cr(),qr()])}catch(fe){console.error("Error loading admin data:",fe),d("Failed to load admin data")}},[]),rr=S.useCallback(async()=>{try{const fe="admin_users_",wt=Rs(fe);if(wt){console.log(" Using cached users data"),Dt(wt);return}const Sr=await n("/.netlify/functions/get-all-users");console.log(" Users response:",Sr);const kr=Sr.users||[];Dt(kr),vs(fe,kr,Is.admin_users),console.log(" Users set to state:",kr)}catch(fe){console.error("Error loading users:",fe)}},[n]),xr=S.useCallback(async()=>{try{const fe="admin_teachers_",wt=Rs(fe);if(wt){console.log(" Using cached teachers data"),Xe(wt);return}const Sr=await n("/.netlify/functions/get-all-teachers");console.log(" Teachers response:",Sr);const kr=Sr.teachers||[];Xe(kr),vs(fe,kr,Is.admin_teachers),console.log(" Teachers set to state:",kr)}catch(fe){console.error("Error loading teachers:",fe)}},[n]),cr=S.useCallback(async()=>{try{const fe="admin_subjects_",wt=Rs(fe);if(wt){console.log(" Using cached subjects data"),Le(wt);return}const Sr=await n("/.netlify/functions/get-all-subjects");console.log(" Subjects response:",Sr);const kr=Sr.subjects||[];Le(kr),vs(fe,kr,Is.admin_subjects),console.log(" Subjects set to state:",kr)}catch(fe){console.error("Error loading subjects:",fe)}},[n]),qr=S.useCallback(async()=>{try{const fe="admin_academic_years_",wt=Rs(fe);if(wt){console.log(" Using cached academic years data"),Ue(wt);return}const kr=(await n("/.netlify/functions/get-academic-year")).academic_years||[];Ue(kr),vs(fe,kr,Is.admin_academic_years)}catch(fe){console.error("Error loading academic year:",fe)}},[n]),ue=S.useCallback(async()=>{try{if(N(!b),!b){const[fe,wt]=await Promise.all([n("/.netlify/functions/get-all-tests"),n("/.netlify/functions/get-test-assignments")]);console.log(" Active tests response:",fe),console.log(" Assignments response:",wt);const Sr=fe.tests||[],Nn=(wt.assignments||[]).reduce((Zr,Me)=>{const Tt=`${Me.test_type}-${Me.test_id}`;return Zr[Tt]||(Zr[Tt]=[]),Zr[Tt].push(Me),Zr},{}),bn=Sr.map(Zr=>{const Me=`${Zr.test_type}-${Zr.test_id}`,Tt=Nn[Me]||[],Gt=Tt.some(ar=>ar.is_active);return{...Zr,is_active:Gt,assignments:Tt}});V(bn),console.log(" All tests with status set to state:",bn)}}catch(fe){console.error("Error loading tests:",fe),g({type:"error",message:"Failed to load tests"})}},[n,b]),we=S.useCallback((fe,wt)=>{me(Sr=>({...Sr,[fe]:wt}))},[]),ye=S.useCallback((fe,wt)=>{Pe(Sr=>({...Sr,[fe]:wt}))},[]),xe=S.useCallback((fe,wt)=>{Ct(Sr=>({...Sr,[fe]:wt}))},[]);S.useCallback(()=>{console.log(" Testing local storage...");try{const fe={test:"data",timestamp:Date.now()};localStorage.setItem("test",JSON.stringify(fe));const wt=JSON.parse(localStorage.getItem("test"));console.log(" Local storage test successful:",wt),g({type:"success",message:"Local storage test successful"})}catch(fe){console.error(" Local storage test failed:",fe),g({type:"error",message:"Local storage test failed"})}},[]),S.useCallback(()=>{console.log(" Clearing local storage...");try{localStorage.clear(),console.log(" Local storage cleared"),g({type:"success",message:"Local storage cleared"})}catch(fe){console.error(" Error clearing local storage:",fe),g({type:"error",message:"Error clearing local storage"})}},[]),S.useCallback(async()=>{console.log(" Checking teacher subjects...");try{const wt=(await n("/.netlify/functions/get-all-teachers")).data||[];console.log(" Teachers data:",wt),g({type:"success",message:`Found ${wt.length} teachers`})}catch(fe){console.error(" Error checking teacher subjects:",fe),g({type:"error",message:"Error checking teacher subjects"})}},[n]);const be=S.useCallback(async fe=>{fe.preventDefault();try{console.log(" Submitting user:",ir);const wt=await s("/.netlify/functions/add-user",ir);wt.success?(g({type:"success",message:"User added successfully"}),Et(!1),me({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),rr()):g({type:"error",message:wt.message||"Failed to add user"})}catch(wt){console.error(" Error adding user:",wt),g({type:"error",message:"Error adding user"})}},[ir,s,rr]),_e=S.useCallback(async fe=>{fe.preventDefault();try{console.log(" Submitting teacher:",Ne);const wt=await s("/.netlify/functions/add-teacher",Ne);wt.success?(g({type:"success",message:"Teacher added successfully"}),qt(!1),Pe({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),xr()):g({type:"error",message:wt.message||"Failed to add teacher"})}catch(wt){console.error(" Error adding teacher:",wt),g({type:"error",message:"Error adding teacher"})}},[Ne,s,xr]),Ge=S.useCallback(async fe=>{fe.preventDefault();try{console.log(" Submitting subject:",Re);const wt=await s("/.netlify/functions/add-subject",Re);wt.success?(g({type:"success",message:"Subject added successfully"}),Rr(!1),Ct({subject_id:"",subject:"",description:"",is_active:!0}),cr()):g({type:"error",message:wt.message||"Failed to add subject"})}catch(wt){console.error(" Error adding subject:",wt),g({type:"error",message:"Error adding subject"})}},[Re,s,cr]),ut=S.useCallback(fe=>{A(fe),I({name:fe.name||"",surname:fe.surname||"",grade:fe.grade||"",class:fe.class||"",student_id:fe.student_id||"",nickname:fe.nickname||"",password:fe.password||"",is_active:fe.is_active!==void 0?fe.is_active:!0})},[]),qe=S.useCallback(async()=>{try{const fe=[];Object.keys(j).forEach(wt=>{wt!=="student_id"&&j[wt]!==F[wt]&&fe.push({fieldName:wt,newValue:j[wt]})});for(const wt of fe)await s("/.netlify/functions/update-user",{userId:F.student_id,fieldName:wt.fieldName,newValue:wt.newValue});g({type:"success",message:"User updated successfully!"}),A(null),I({}),rr()}catch{g({type:"error",message:"Failed to update user"})}},[j,F,s,rr]),oe=S.useCallback(async fe=>{if(window.confirm("Are you sure you want to delete this user?"))try{(await s("/.netlify/functions/delete-user",{userId:fe})).success&&(g({type:"success",message:"User deleted successfully!"}),rr())}catch{g({type:"error",message:"Failed to delete user"})}},[s,rr]),he=S.useCallback(fe=>{Y(fe),ae({teacher_id:fe.teacher_id||"",username:fe.username||"",password:fe.password||"",first_name:fe.first_name||"",last_name:fe.last_name||"",is_active:fe.is_active!==void 0?fe.is_active:!0})},[]),Te=S.useCallback(async()=>{try{const fe=[];Object.keys(Z).forEach(wt=>{wt!=="teacher_id"&&Z[wt]!==B[wt]&&fe.push({fieldName:wt,newValue:Z[wt]})});for(const wt of fe)await s("/.netlify/functions/update-teacher",{teacherId:B.teacher_id,fieldName:wt.fieldName,newValue:wt.newValue});g({type:"success",message:"Teacher updated successfully!"}),Y(null),ae({}),xr()}catch{g({type:"error",message:"Failed to update teacher"})}},[Z,B,s,xr]),Ce=S.useCallback(async fe=>{if(window.confirm("Are you sure you want to delete this teacher?"))try{(await s("/.netlify/functions/delete-teacher",{teacherId:fe})).success&&(g({type:"success",message:"Teacher deleted successfully!"}),xr())}catch{g({type:"error",message:"Failed to delete teacher"})}},[s,xr]),Ke=S.useCallback(fe=>{ne(fe),H({subject_id:fe.subject_id||"",subject:fe.subject||""})},[]),ot=S.useCallback(async()=>{try{const fe=[];Object.keys(L).forEach(wt=>{wt!=="subject_id"&&L[wt]!==ee[wt]&&fe.push({fieldName:wt,newValue:L[wt]})});for(const wt of fe)await s("/.netlify/functions/update-subject",{subjectId:ee.subject_id,fieldName:wt.fieldName,newValue:wt.newValue});g({type:"success",message:"Subject updated successfully!"}),ne(null),H({}),cr()}catch{g({type:"error",message:"Failed to update subject"})}},[L,ee,s,cr]),mt=S.useCallback(async fe=>{if(window.confirm("Are you sure you want to delete this subject?"))try{const wt=await s("/.netlify/functions/delete-subject",{subjectId:fe});wt.success?(g({type:"success",message:"Subject deleted successfully!"}),cr()):g({type:"error",message:wt.message||"Failed to delete subject"})}catch{g({type:"error",message:"Failed to delete subject"})}},[s,cr]),Wt=S.useCallback((fe,wt)=>{st(Sr=>({...Sr,[fe]:wt}))},[]),pt=S.useCallback(async fe=>{if(fe.preventDefault(),!Fe.startDate||!Fe.endDate||!Fe.teacherId){g({type:"error",message:"Please fill in all required fields (Start Date, End Date, Teacher ID)"});return}if(window.confirm("Are you sure you want to delete all test data for the selected criteria? This action cannot be undone."))try{const wt=await s("/.netlify/functions/delete-test-data",Fe);wt.success?(g({type:"success",message:`Successfully deleted ${wt.deletedCount} test records!`}),ur(!1),st({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""})):g({type:"error",message:wt.message||"Failed to delete test data"})}catch{g({type:"error",message:"Failed to delete test data"})}},[Fe,s]),Yt=S.useCallback(async(fe,wt,Sr)=>{try{const kr=await n("/.netlify/functions/get-test-assignments");if(kr.success&&kr.assignments){const Nn=kr.assignments.filter(bn=>bn.test_id===parseInt(fe)&&bn.test_type===wt);if(Nn.length===0){g({type:"error",message:"No assignments found for this test"});return}for(const bn of Nn){const Zr=await s("/.netlify/functions/remove-assignment",{teacher_id:Sr,assignment_id:bn.assignment_id,test_type:wt,test_id:fe});if(!Zr.success){g({type:"error",message:`Failed to complete test: ${Zr.message}`});return}}g({type:"success",message:"Test marked as complete successfully!"}),await ue()}else g({type:"error",message:"Failed to get test assignments"})}catch(kr){console.error("Error completing test:",kr),g({type:"error",message:"Failed to complete test"})}},[s,n,ue]),vr=S.useCallback(async(fe,wt,Sr)=>{try{const kr=await n("/.netlify/functions/get-test-assignments");if(kr.success&&kr.assignments){const Nn=kr.assignments.filter(bn=>bn.test_id===parseInt(fe)&&bn.test_type===wt);if(Nn.length===0){g({type:"error",message:"No assignments found for this test"});return}for(const bn of Nn){const Zr=await s("/.netlify/functions/remove-assignment",{teacher_id:Sr,assignment_id:bn.assignment_id,test_type:wt,test_id:fe,mark_active:!0});if(!Zr.success){g({type:"error",message:`Failed to reactivate test: ${Zr.message}`});return}}g({type:"success",message:"Test marked as active successfully!"}),await ue()}else g({type:"error",message:"Failed to get test assignments"})}catch(kr){console.error("Error reactivating test:",kr),g({type:"error",message:"Failed to reactivate test"})}},[s,n,ue]),_r=S.useCallback(async()=>{try{if(ce(!le),!le){const fe=await n("/.netlify/functions/get-all-tests");console.log(" Actual tests response:",fe),re(fe.tests||[]),console.log(" Actual tests set to state:",fe.tests||[])}}catch(fe){console.error("Error loading actual tests:",fe),g({type:"error",message:"Failed to load tests"})}},[n,le]),gr=S.useCallback(async(fe,wt,Sr)=>{try{const kr=await s("/.netlify/functions/delete-test",{test_id:fe,test_type:wt,teacher_id:Sr});kr.success?(g({type:"success",message:"Test deleted successfully!"}),await _r()):g({type:"error",message:`Failed to delete test: ${kr.message}`})}catch(kr){console.error("Error deleting test:",kr),g({type:"error",message:"Failed to delete test"})}},[s,_r]),Fr=E?ht.filter(fe=>fe.grade.toString()===E):ht,rn=M.filter(fe=>{const wt=!W||fe.teacher_id===W,Sr=!U||new Date(fe.created_at)>=new Date(U),kr=!Q||new Date(fe.created_at)<=new Date(Q+"T23:59:59"),Nn=X?fe.is_active:!fe.is_active;return wt&&Sr&&kr&&Nn}),Qr=Se.filter(fe=>{const wt=!ge||fe.teacher_id===ge,Sr=!Ae||new Date(fe.created_at)>=new Date(Ae),kr=!Be||new Date(fe.created_at)<=new Date(Be+"T23:59:59");return wt&&Sr&&kr});return l.jsxs(nt.div,{id:"admin-cabinet-main",className:Oe.container,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(nt.div,{className:Oe.header,initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:Oe.headerContent,children:l.jsxs("div",{className:Oe.headerFlex,children:[l.jsxs(nt.div,{className:Oe.adminInfo,initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(nt.div,{className:Oe.adminAvatar,initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:l.jsx("span",{className:"text-white font-semibold text-xl",children:e?.username?.charAt(0)||"A"})})}),l.jsxs("div",{children:[l.jsx("h1",{className:Oe.adminText,children:e?.username||"Administrator"}),l.jsx("p",{className:Oe.adminSubtext,children:"Administrator Dashboard"})]})]}),l.jsxs(nt.div,{className:Oe.menuContainer,initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsxs("button",{onClick:We,className:Oe.menuButton,style:{zIndex:1e3},children:[l.jsx("span",{className:"hidden sm:inline",children:"Menu"}),l.jsx(nt.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:et?180:0},transition:{duration:.2},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),l.jsx(wo,{children:et&&l.jsx(nt.div,{className:Oe.menuDropdown,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:l.jsxs("div",{className:"py-2",children:[l.jsx(nt.button,{onClick:Qe,className:Oe.menuItem,whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),l.jsx(nt.button,{onClick:()=>{We(),r()},className:Oe.menuItemLogout,whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),o&&l.jsx(zr,{text:"Loading..."}),u&&l.jsx(uc,{type:"error",message:u,onClose:()=>d(null)}),h&&l.jsx(uc,{type:h.type,message:h.message,onClose:()=>g(null)}),xt&&l.jsx("div",{className:Oe.modalOverlay,children:l.jsxs("div",{className:Oe.modalContent,children:[l.jsx("h2",{className:Oe.modalTitle,children:"Change Password"}),l.jsxs("form",{className:"space-y-4",children:[l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{htmlFor:"currentPassword",className:Oe.formLabel,children:"Current Password"}),l.jsx("input",{type:"password",id:"currentPassword",className:Oe.formInput})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{htmlFor:"newPassword",className:Oe.formLabel,children:"New Password"}),l.jsx("input",{type:"password",id:"newPassword",className:Oe.formInput})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{htmlFor:"confirmPassword",className:Oe.formLabel,children:"Confirm New Password"}),l.jsx("input",{type:"password",id:"confirmPassword",className:Oe.formInput})]}),l.jsxs("div",{className:Oe.modalActions,children:[l.jsx(Ye,{type:"button",variant:"secondary",onClick:Pt,className:"flex-1",children:"Cancel"}),l.jsx(Ye,{type:"submit",variant:"primary",className:"flex-1 bg-purple-600 hover:bg-purple-700",children:"Change Password"})]})]})]})}),l.jsx(nt.div,{className:Oe.mainContainer,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:l.jsxs("div",{className:"space-y-6",children:[l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},children:l.jsxs(Nt,{className:Oe.cardContainer,children:[l.jsx(Nt.Header,{className:Oe.cardHeader,children:l.jsx(Nt.Title,{className:Oe.cardTitle,children:"User Management"})}),l.jsxs(Nt.Body,{className:Oe.cardBody,children:[l.jsxs("div",{className:Oe.buttonGroup,children:[l.jsx(Ye,{variant:"primary",onClick:()=>Et(!0),className:Oe.buttonPrimary,children:"Add User"}),l.jsx(Ye,{variant:"secondary",onClick:()=>{rr(),x(!p)},className:Oe.buttonSecondary,children:p?"Hide Users Table":"Get All Users "})]}),l.jsx(wo,{children:tt&&l.jsxs(nt.div,{className:Oe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New User"}),l.jsxs("form",{onSubmit:be,className:"space-y-4",children:[l.jsxs("div",{className:Oe.formGrid,children:[l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Grade"}),l.jsx("input",{type:"text",value:ir.grade,onChange:fe=>we("grade",fe.target.value),className:Oe.formInput,placeholder:"Enter grade"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Class"}),l.jsx("input",{type:"text",value:ir.class,onChange:fe=>we("class",fe.target.value),className:Oe.formInput,placeholder:"Enter class"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Number"}),l.jsx("input",{type:"text",value:ir.number,onChange:fe=>we("number",fe.target.value),className:Oe.formInput,placeholder:"Enter number"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Student ID"}),l.jsx("input",{type:"text",value:ir.student_id,onChange:fe=>we("student_id",fe.target.value),className:Oe.formInput,placeholder:"Enter student ID"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Name"}),l.jsx("input",{type:"text",value:ir.name,onChange:fe=>we("name",fe.target.value),className:Oe.formInput,placeholder:"Enter name"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Surname"}),l.jsx("input",{type:"text",value:ir.surname,onChange:fe=>we("surname",fe.target.value),className:Oe.formInput,placeholder:"Enter surname"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Nickname"}),l.jsx("input",{type:"text",value:ir.nickname,onChange:fe=>we("nickname",fe.target.value),className:Oe.formInput,placeholder:"Enter nickname"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Password"}),l.jsx("input",{type:"password",value:ir.password,onChange:fe=>we("password",fe.target.value),className:Oe.formInput,placeholder:"Enter password"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"userActive",checked:ir.is_active,onChange:fe=>we("is_active",fe.target.checked),className:Oe.formCheckbox}),l.jsx("label",{htmlFor:"userActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),l.jsxs("div",{className:Oe.formActions,children:[l.jsx(Ye,{type:"button",variant:"secondary",onClick:()=>Et(!1),className:Oe.buttonSecondary,children:"Cancel"}),l.jsx(Ye,{type:"submit",variant:"primary",className:Oe.buttonPrimary,children:"Add User"})]})]})]})}),p&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Users (",Fr.length," of ",ht.length,")"]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Filter by Grade:"}),l.jsxs("select",{value:E,onChange:fe=>P(fe.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Grades"}),[...new Set(ht.map(fe=>fe.grade))].sort().map(fe=>l.jsxs("option",{value:fe,children:["Grade ",fe]},fe))]})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-[600px]",children:l.jsxs("table",{className:Oe.table,children:[l.jsx("thead",{className:Oe.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Oe.tableHeaderCell,children:"Name"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Grade"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Class"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Student ID"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Number"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Nickname"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Oe.tableBody,children:Fr.map((fe,wt)=>l.jsxs("tr",{className:Oe.tableRow,children:[l.jsxs("td",{className:Oe.tableCell,children:[fe.name," ",fe.surname]}),l.jsx("td",{className:Oe.tableCell,children:fe.grade}),l.jsx("td",{className:Oe.tableCell,children:fe.class}),l.jsx("td",{className:Oe.tableCell,children:fe.student_id}),l.jsx("td",{className:Oe.tableCell,children:fe.number}),l.jsx("td",{className:Oe.tableCell,children:fe.nickname}),l.jsx("td",{className:Oe.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>ut(fe),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>oe(fe.student_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},fe.id||wt))})]})})})]})]})]})}),l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:l.jsxs(Nt,{className:Oe.cardContainer,children:[l.jsxs(Nt.Header,{className:Oe.cardHeader,children:[l.jsx(Nt.Title,{className:Oe.cardTitle,children:"Teacher Management"}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{onClick:i,className:"px-3 py-1.5 bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors text-xs whitespace-nowrap",title:"Check and mark overdue assignments (7+ days old) as inactive",children:"Check Overdue Assignments"}),l.jsx(Ye,{variant:"primary",onClick:()=>qt(!0),className:"text-xs whitespace-nowrap",children:"Add Teacher"}),l.jsx(Ye,{variant:"secondary",onClick:()=>{xr(),w(!v)},className:"text-xs whitespace-nowrap",children:v?"Hide Teachers Table":"Get All Teachers "})]})]}),l.jsxs(Nt.Body,{className:Oe.cardBody,children:[l.jsx(wo,{children:At&&l.jsxs(nt.div,{className:Oe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Teacher"}),l.jsxs("form",{onSubmit:_e,className:"space-y-4",children:[l.jsxs("div",{className:Oe.formGrid,children:[l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Teacher ID"}),l.jsx("input",{type:"text",value:Ne.teacher_id,onChange:fe=>ye("teacher_id",fe.target.value),className:Oe.formInput,placeholder:"Enter teacher ID"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Username"}),l.jsx("input",{type:"text",value:Ne.username,onChange:fe=>ye("username",fe.target.value),className:Oe.formInput,placeholder:"Enter username"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Password"}),l.jsx("input",{type:"password",value:Ne.password,onChange:fe=>ye("password",fe.target.value),className:Oe.formInput,placeholder:"Enter password"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"First Name"}),l.jsx("input",{type:"text",value:Ne.first_name,onChange:fe=>ye("first_name",fe.target.value),className:Oe.formInput,placeholder:"Enter first name"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Last Name"}),l.jsx("input",{type:"text",value:Ne.last_name,onChange:fe=>ye("last_name",fe.target.value),className:Oe.formInput,placeholder:"Enter last name"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"teacherActive",checked:Ne.is_active,onChange:fe=>ye("is_active",fe.target.checked),className:Oe.formCheckbox}),l.jsx("label",{htmlFor:"teacherActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),l.jsxs("div",{className:Oe.formActions,children:[l.jsx(Ye,{type:"button",variant:"secondary",onClick:()=>qt(!1),className:Oe.buttonSecondary,children:"Cancel"}),l.jsx(Ye,{type:"submit",variant:"primary",className:Oe.buttonPrimary,children:"Add Teacher"})]})]})]})}),F&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit User"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),l.jsx("input",{type:"text",value:j.name,onChange:fe=>I({...j,name:fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Surname"}),l.jsx("input",{type:"text",value:j.surname,onChange:fe=>I({...j,surname:fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grade"}),l.jsx("input",{type:"number",value:j.grade,onChange:fe=>I({...j,grade:fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsx("input",{type:"number",value:j.class,onChange:fe=>I({...j,class:fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),l.jsx("input",{type:"text",value:j.student_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Student ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nickname"}),l.jsx("input",{type:"text",value:j.nickname,onChange:fe=>I({...j,nickname:fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),l.jsx("input",{type:"text",value:j.password,onChange:fe=>I({...j,password:fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"is_active",checked:j.is_active,onChange:fe=>I({...j,is_active:fe.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),l.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{A(null),I({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:qe,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update User"})]})]})}),v&&l.jsxs("div",{className:"mt-6",children:[l.jsx("div",{className:"mb-4",children:l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Teachers (",Mt.length,")"]})}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Oe.table,children:[l.jsx("thead",{className:Oe.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Oe.tableHeaderCell,children:"Teacher ID"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Name"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Username"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Password"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Status"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Created"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Oe.tableBody,children:Mt.map((fe,wt)=>l.jsxs("tr",{className:Oe.tableRow,children:[l.jsx("td",{className:Oe.tableCell,children:fe.teacher_id}),l.jsxs("td",{className:Oe.tableCell,children:[fe.first_name," ",fe.last_name]}),l.jsx("td",{className:Oe.tableCell,children:fe.username}),l.jsx("td",{className:Oe.tableCell,children:fe.password}),l.jsx("td",{className:Oe.tableCell,children:l.jsx("span",{className:fe.is_active?Oe.statusActive:Oe.statusInactive,children:fe.is_active?"Active":"Inactive"})}),l.jsx("td",{className:Oe.tableCell,children:new Date(fe.created_at).toLocaleDateString()}),l.jsx("td",{className:Oe.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>he(fe),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>Ce(fe.teacher_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},fe.teacher_id||wt))})]})})})]})]})]})}),l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7,duration:.5},children:l.jsxs(Nt,{className:Oe.cardContainer,children:[l.jsx(Nt.Header,{className:Oe.cardHeader,children:l.jsx(Nt.Title,{className:Oe.cardTitle,children:"Subject Management"})}),l.jsxs(Nt.Body,{className:Oe.cardBody,children:[l.jsxs("div",{className:Oe.buttonGroup,children:[l.jsx(Ye,{variant:"primary",onClick:()=>Rr(!0),className:Oe.buttonPrimary,children:"Add Subject"}),l.jsx(Ye,{variant:"secondary",onClick:()=>{cr(),k(!C)},className:Oe.buttonSecondary,children:C?"Hide Subjects Table":"Get All Subjects "})]}),l.jsx(wo,{children:pr&&l.jsxs(nt.div,{className:Oe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Subject"}),l.jsxs("form",{onSubmit:Ge,className:"space-y-4",children:[l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Subject Name"}),l.jsx("input",{type:"text",value:Re.subject,onChange:fe=>xe("subject",fe.target.value),className:Oe.formInput,placeholder:"Enter subject name",required:!0}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Subject ID will be automatically generated"})]}),l.jsxs("div",{className:Oe.formActions,children:[l.jsx(Ye,{type:"button",variant:"secondary",onClick:()=>Rr(!1),className:Oe.buttonSecondary,children:"Cancel"}),l.jsx(Ye,{type:"submit",variant:"primary",className:Oe.buttonPrimary,children:"Add Subject"})]})]})]})}),B&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Teacher"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teacher ID"}),l.jsx("input",{type:"text",value:Z.teacher_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Teacher ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),l.jsx("input",{type:"text",value:Z.username,onChange:fe=>ae({...Z,username:fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),l.jsx("input",{type:"text",value:Z.password,onChange:fe=>ae({...Z,password:fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),l.jsx("input",{type:"text",value:Z.first_name,onChange:fe=>ae({...Z,first_name:fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),l.jsx("input",{type:"text",value:Z.last_name,onChange:fe=>ae({...Z,last_name:fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"teacher_is_active",checked:Z.is_active,onChange:fe=>ae({...Z,is_active:fe.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),l.jsx("label",{htmlFor:"teacher_is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{Y(null),ae({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:Te,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update Teacher"})]})]})}),ee&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Subject"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject ID"}),l.jsx("input",{type:"text",value:L.subject_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Subject ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),l.jsx("input",{type:"text",value:L.subject,onChange:fe=>H({...L,subject:fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>ne(null),className:"px-4 py-2 text-gray-600 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),l.jsx("button",{onClick:ot,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:"Update Subject"})]})]})}),C&&l.jsxs("div",{className:"mt-6",children:[l.jsx("div",{className:"mb-4",children:l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Subjects (",De.length,")"]})}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Oe.table,children:[l.jsx("thead",{className:Oe.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Oe.tableHeaderCell,children:"Subject ID"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Subject Name"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Oe.tableBody,children:De.map((fe,wt)=>l.jsxs("tr",{className:Oe.tableRow,children:[l.jsx("td",{className:Oe.tableCell,children:fe.subject_id}),l.jsx("td",{className:Oe.tableCell,children:fe.subject}),l.jsx("td",{className:Oe.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>Ke(fe),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>mt(fe.subject_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},fe.subject_id||wt))})]})})})]})]})]})}),l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:l.jsxs(Nt,{className:Oe.cardContainer,children:[l.jsx(Nt.Header,{className:Oe.cardHeader,children:l.jsx(Nt.Title,{className:Oe.cardTitle,children:"Test Data Deletion"})}),l.jsxs(Nt.Body,{className:Oe.cardBody,children:[l.jsx("div",{className:Oe.buttonGroup,children:l.jsx(Ye,{variant:"danger",onClick:()=>ur(!0),className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})}),l.jsx(wo,{children:Kr&&l.jsxs(nt.div,{className:Oe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Delete Test Data by Date Range"}),l.jsxs("form",{onSubmit:pt,className:"space-y-4",children:[l.jsxs("div",{className:Oe.formGrid,children:[l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Start Date *"}),l.jsx("input",{type:"date",value:Fe.startDate,onChange:fe=>Wt("startDate",fe.target.value),className:Oe.formInput,required:!0})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"End Date *"}),l.jsx("input",{type:"date",value:Fe.endDate,onChange:fe=>Wt("endDate",fe.target.value),className:Oe.formInput,required:!0})]})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Teacher ID *"}),l.jsxs("select",{value:Fe.teacherId,onChange:fe=>Wt("teacherId",fe.target.value),className:Oe.formInput,required:!0,children:[l.jsx("option",{value:"",children:"Select a teacher"}),Mt.map(fe=>l.jsxs("option",{value:fe.teacher_id,children:[fe.teacher_id," - ",fe.first_name," ",fe.last_name]},fe.teacher_id))]})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Subject (Optional)"}),l.jsxs("select",{value:Fe.subjectId,onChange:fe=>Wt("subjectId",fe.target.value),className:Oe.formInput,children:[l.jsx("option",{value:"",children:"All subjects"}),De.map(fe=>l.jsx("option",{value:fe.subject_id,children:fe.subject},fe.subject_id))]})]}),l.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Warning: This action cannot be undone"}),l.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[l.jsx("p",{children:"This will permanently delete:"}),l.jsxs("ul",{className:"list-disc list-inside mt-1",children:[l.jsx("li",{children:"All test records within the date range"}),l.jsx("li",{children:"All test questions and answers"}),l.jsx("li",{children:"All test results and submissions"}),l.jsx("li",{children:"All test assignments"}),l.jsx("li",{children:"Associated Cloudinary images (for matching tests)"})]})]})]})]})}),l.jsxs("div",{className:Oe.formActions,children:[l.jsx(Ye,{type:"button",variant:"secondary",onClick:()=>ur(!1),className:Oe.buttonSecondary,children:"Cancel"}),l.jsx(Ye,{type:"submit",variant:"danger",className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})]})]})]})})]})]})}),l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.85,duration:.5},children:l.jsxs(Nt,{className:Oe.cardContainer,children:[l.jsx(Nt.Header,{className:Oe.cardHeader,children:l.jsx(Nt.Title,{className:Oe.cardTitle,children:"Assignments Management"})}),l.jsxs(Nt.Body,{className:Oe.cardBody,children:[l.jsx("div",{className:"mb-4",children:l.jsx(Ye,{variant:"primary",onClick:ue,className:Oe.buttonPrimary,children:b?"Hide Assignments Table":"Get All Assignments "})}),b&&l.jsx("div",{className:"mb-6",children:l.jsx("div",{className:"border-b border-gray-200",children:l.jsxs("nav",{className:"-mb-px flex space-x-8",children:[l.jsx("button",{onClick:()=>ie(!0),className:`py-2 px-1 border-b-2 font-medium text-sm ${X?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Active Assignments"}),l.jsx("button",{onClick:()=>ie(!1),className:`py-2 px-1 border-b-2 font-medium text-sm ${X?"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300":"border-purple-500 text-purple-600"}`,children:"Inactive Assignments"})]})})}),b&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:[X?"Active":"Inactive"," Assignments (",rn.length," of ",M.filter(fe=>X?fe.is_active:!fe.is_active).length,")"]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs("select",{value:W,onChange:fe=>R(fe.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Teachers"}),Mt.map(fe=>l.jsxs("option",{value:fe.teacher_id,children:[fe.first_name," ",fe.last_name]},fe.teacher_id))]}),l.jsx("input",{type:"date",value:U,onChange:fe=>q(fe.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),l.jsx("input",{type:"date",value:Q,onChange:fe=>se(fe.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Oe.table,children:[l.jsx("thead",{className:Oe.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Oe.tableHeaderCell,children:"Test Name"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Type"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Teacher"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Questions"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Created"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Oe.tableBody,children:rn.map((fe,wt)=>l.jsxs("tr",{className:Oe.tableRow,children:[l.jsx("td",{className:Oe.tableCell,children:fe.test_name}),l.jsx("td",{className:Oe.tableCell,children:l.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:fe.test_type.replace("_"," ").toUpperCase()})}),l.jsx("td",{className:Oe.tableCell,children:fe.teacher_name}),l.jsx("td",{className:Oe.tableCell,children:fe.num_questions}),l.jsx("td",{className:Oe.tableCell,children:new Date(fe.created_at).toLocaleDateString()}),l.jsx("td",{className:Oe.tableCell,children:l.jsx("div",{className:"flex space-x-2",children:X?l.jsx("button",{onClick:()=>Yt(fe.test_id,fe.test_type,fe.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-orange-100 text-orange-700 hover:bg-orange-200",children:"Mark Complete"}):l.jsx("button",{onClick:()=>vr(fe.test_id,fe.test_type,fe.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",children:"Mark Active"})})})]},`${fe.test_type}-${fe.test_id}-${wt}`))})]})})})]})]})]})}),l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:l.jsxs(Nt,{className:Oe.cardContainer,children:[l.jsx(Nt.Header,{className:Oe.cardHeader,children:l.jsx(Nt.Title,{className:Oe.cardTitle,children:"Test Management"})}),l.jsxs(Nt.Body,{className:Oe.cardBody,children:[l.jsx("div",{className:"mb-4",children:l.jsx(Ye,{variant:"primary",onClick:_r,className:Oe.buttonPrimary,children:le?"Hide Tests Table":"Get All Tests "})}),le&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Tests (",Qr.length," of ",Se.length,")"]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs("select",{value:ge,onChange:fe=>Ee(fe.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Teachers"}),Mt.map(fe=>l.jsxs("option",{value:fe.teacher_id,children:[fe.first_name," ",fe.last_name]},fe.teacher_id))]}),l.jsx("input",{type:"date",value:Ae,onChange:fe=>He(fe.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),l.jsx("input",{type:"date",value:Be,onChange:fe=>Rt(fe.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Oe.table,children:[l.jsx("thead",{className:Oe.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Oe.tableHeaderCell,children:"Test Name"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Type"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Teacher"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Questions"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Created"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Oe.tableBody,children:Qr.map((fe,wt)=>l.jsxs("tr",{className:Oe.tableRow,children:[l.jsx("td",{className:Oe.tableCell,children:fe.test_name}),l.jsx("td",{className:Oe.tableCell,children:l.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:fe.test_type.replace("_"," ").toUpperCase()})}),l.jsx("td",{className:Oe.tableCell,children:fe.teacher_name}),l.jsx("td",{className:Oe.tableCell,children:fe.num_questions}),l.jsx("td",{className:Oe.tableCell,children:new Date(fe.created_at).toLocaleDateString()}),l.jsx("td",{className:Oe.tableCell,children:l.jsx("div",{className:"flex space-x-2",children:l.jsx("button",{onClick:()=>gr(fe.test_id,fe.test_type,fe.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200",children:"Delete Test"})})})]},`${fe.test_type}-${fe.test_id}-${wt}`))})]})})})]})]})]})}),l.jsx(nt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:l.jsxs(Nt,{className:Oe.cardContainer,children:[l.jsx(Nt.Header,{className:Oe.cardHeader,children:l.jsx(Nt.Title,{className:Oe.cardTitle,children:"Debug & Testing"})}),l.jsx(Nt.Body,{className:Oe.cardBody})]})})]})})]})},C3e=()=>{const{isAdmin:e,getCurrentAdminId:t,logout:r}=cs(),{get:n}=Qo(),{showNotification:s}=za();S.useEffect(()=>{a()},[]);const a=S.useCallback(async()=>{if(console.log(" Initializing Admin Application..."),!e()){console.error(" User is not an admin, redirecting to login"),s("Access Denied: You are not an administrator.","error"),r();return}try{i(),await o(),c(),u(),console.log(" Admin Application initialized successfully"),s("Admin dashboard loaded successfully","success")}catch(d){console.error(" Error initializing admin app:",d),s("Failed to initialize admin dashboard","error")}},[e,t,r,s,n]),i=S.useCallback(()=>{console.log(" Initializing global event listeners...");const d=h=>{h.ctrlKey&&h.key==="k"&&(h.preventDefault(),console.log("Admin search shortcut triggered"))};return document.addEventListener("keydown",d),()=>{document.removeEventListener("keydown",d)}},[]),o=S.useCallback(async()=>{try{console.log(" Loading admin data...");const[d,h,g,p]=await Promise.allSettled([n("/.netlify/functions/get-all-users"),n("/.netlify/functions/get-all-teachers"),n("/.netlify/functions/get-all-subjects"),n("/.netlify/functions/get-academic-year")]);d.status==="fulfilled"&&d.value?.success&&console.log(" Users loaded:",d.value.users?.length||0),h.status==="fulfilled"&&h.value?.success&&console.log(" Teachers loaded:",h.value.teachers?.length||0),g.status==="fulfilled"&&g.value?.success&&console.log(" Subjects loaded:",g.value.subjects?.length||0),p.status==="fulfilled"&&p.value?.success&&console.log(" Academic years loaded:",p.value.academic_years?.length||0),console.log(" Admin data loading completed")}catch(d){throw console.error(" Error loading admin data:",d),d}},[n]),c=S.useCallback(()=>{console.log(" Initializing test deletion functionality..."),console.log(" Test deletion functionality initialized")},[]),u=S.useCallback(()=>{console.log(" Exposing admin functions globally..."),window.toggleSubjectsContent=()=>{const h=document.getElementById("allSubjectsContainer"),g=document.querySelector('button[onclick="toggleSubjectsContent()"]');if(!h){console.error(" allSubjectsContainer not found");return}if(!g){console.error(" Button not found");return}const p=h.style.display!=="none";h.style.display=p?"none":"block",g.textContent=p?"Show Subjects":"Hide Subjects"},window.showAddSubjectForm=()=>{const h=document.getElementById("addSubjectForm");h&&(h.style.display="block")},window.hideAddSubjectForm=()=>{const h=document.getElementById("addSubjectForm"),g=document.getElementById("newSubjectForm");h&&(h.style.display="none"),g&&g.reset()},window.showAddAcademicYearForm=()=>{const h=document.getElementById("addAcademicYearForm");h&&(h.style.display="block")},window.hideAddAcademicYearForm=()=>{const h=document.getElementById("addAcademicYearForm"),g=document.getElementById("newAcademicYearForm");h&&(h.style.display="none"),g&&g.reset()},window.toggleUsersContent=()=>{const h=document.getElementById("allUsersContainer"),g=document.querySelector('button[onclick="toggleUsersContent()"]');if(!h){console.error(" allUsersContainer not found");return}if(!g){console.error(" Button not found");return}const p=h.style.display!=="none";h.style.display=p?"none":"block",g.textContent=p?"Show Users":"Hide Users"},window.showAddUserForm=()=>{const h=document.getElementById("addUserForm");h&&(h.style.display="block")},window.hideAddUserForm=()=>{const h=document.getElementById("addUserForm"),g=document.getElementById("newUserForm");h&&(h.style.display="none"),g&&g.reset()},window.showAddTeacherForm=()=>{const h=document.getElementById("addTeacherForm");h&&(h.style.display="block")},window.hideAddTeacherForm=()=>{const h=document.getElementById("addTeacherForm"),g=document.getElementById("newTeacherForm");h&&(h.style.display="none"),g&&g.reset()},window.toggleTeachersContent=()=>{const h=document.getElementById("allTeachersContainer"),g=document.querySelector('button[onclick="toggleTeachersContent()"]');if(!h){console.error(" allTeachersContainer not found");return}if(!g){console.error(" Button not found");return}const p=h.style.display!=="none";h.style.display=p?"none":"block",g.textContent=p?"Show Teachers":"Hide Teachers"},window.toggleTestsContent=()=>{const h=document.getElementById("allTestsContainer"),g=document.querySelector('button[onclick="toggleTestsContent()"]');if(!h){console.error(" allTestsContainer not found");return}if(!g){console.error(" Button not found");return}const p=h.style.display!=="none";h.style.display=p?"none":"block",g.textContent=p?"Show Tests":"Hide Tests"},window.toggleAssignmentsContent=()=>{const h=document.getElementById("allAssignmentsContainer"),g=document.querySelector('button[onclick="toggleAssignmentsContent()"]');if(!h){console.error(" allAssignmentsContainer not found");return}if(!g){console.error(" Button not found");return}const p=h.style.display!=="none";h.style.display=p?"none":"block",g.textContent=p?"Show Assignments":"Hide Assignments"},window.toggleResultsContent=()=>{const h=document.getElementById("allResultsContainer"),g=document.querySelector('button[onclick="toggleResultsContent()"]');if(!h){console.error(" allResultsContainer not found");return}if(!g){console.error(" Button not found");return}const p=h.style.display!=="none";h.style.display=p?"none":"block",g.textContent=p?"Show Results":"Hide Results"};const d={};window.toggleSection=h=>{console.log(` toggleSection called with sectionId: ${h}`);const g=Date.now();if(d[h]&&g-d[h]<300){console.log(` Ignoring rapid successive call for ${h}`);return}d[h]=g;const p=document.getElementById(h);if(!p){console.error(` Section with id '${h}' not found!`);return}const x=p.style.display!=="none";p.style.display=x?"none":"block";const v=document.querySelector(`button[onclick="toggleSection('${h}')"]`);v&&(v.textContent=x?"Show":"Hide")},window.addClickListeners=()=>{console.log(" Adding click listeners to section headers...");const h=document.querySelectorAll(".section-header");console.log(` Found ${h.length} section headers`),h.forEach((g,p)=>{const x=g.textContent.trim();if(console.log(` Processing header ${p+1}:`,x),g.dataset.listenerAdded==="true"){console.log(` Skipping header ${x} - listener already added`);return}g.addEventListener("click",()=>{const v=g.dataset.sectionId;v&&window.toggleSection(v)}),g.dataset.listenerAdded="true",console.log(` Added click listener to header: ${x}`)})},window.makeFieldEditable=h=>{const g=h.textContent;h.dataset.field;const p=document.createElement("input");p.type="text",p.value=g,p.className="editable-input";const x=document.createElement("button");x.textContent="Save",x.className="btn-save",x.onclick=()=>window.saveField(h,p,x,v);const v=document.createElement("button");v.textContent="Cancel",v.className="btn-cancel",v.onclick=()=>{h.textContent=g,h.style.display="block",p.remove(),x.remove(),v.remove()},h.style.display="none",h.parentNode.insertBefore(p,h),h.parentNode.insertBefore(x,h),h.parentNode.insertBefore(v,h)},window.saveField=(h,g,p,x)=>{const v=g.value.trim(),w=h.dataset.field,C=h.dataset.recordId;if(!v){alert("Field cannot be empty");return}console.log(`Saving field ${w} for record ${C} with value: ${v}`),h.textContent=v,h.style.display="block",g.remove(),p.remove(),x.remove()},window.showTestDataDeletion=()=>console.log("showTestDataDeletion called"),window.hideTestDataDeletionForm=()=>console.log("hideTestDataDeletionForm called"),window.loadTeacherGradesClasses=()=>console.log("loadTeacherGradesClasses called"),window.checkTeacherSubjects=()=>console.log("checkTeacherSubjects called"),window.initializeTestDeletion=()=>console.log("initializeTestDeletion called"),window.handleAssignmentDeletion=()=>console.log("handleAssignmentDeletion called"),window.handleTestDataDeletion=()=>console.log("handleTestDataDeletion called"),window.getSelectedGradesClasses=()=>console.log("getSelectedGradesClasses called"),window.hideAssignmentDeletionForm=()=>console.log("hideAssignmentDeletionForm called"),window.addKeyboardAccessibility=()=>console.log("addKeyboardAccessibility called"),window.testToggleSection=()=>console.log("testToggleSection called"),window.testAllToggles=()=>console.log("testAllToggles called"),window.manualToggleTest=()=>console.log("manualToggleTest called"),window.addEditableFieldListeners=()=>console.log("addEditableFieldListeners called"),window.deleteTest=()=>console.log("deleteTest called"),window.testLocalStorage=()=>{console.log("Testing localStorage...");try{localStorage.setItem("test","value");const h=localStorage.getItem("test");return localStorage.removeItem("test"),console.log(" localStorage is working"),!0}catch(h){return console.error(" localStorage error:",h),!1}},window.clearAllLocalStorage=()=>{console.log("Clearing all localStorage..."),localStorage.clear(),console.log(" localStorage cleared")},window.exportLocalStorage=()=>{console.log("Exporting localStorage...");const h={};for(let v=0;v<localStorage.length;v++){const w=localStorage.key(v);h[w]=localStorage.getItem(w)}const g=new Blob([JSON.stringify(h,null,2)],{type:"application/json"}),p=URL.createObjectURL(g),x=document.createElement("a");x.href=p,x.download="localStorage-backup.json",x.click(),URL.revokeObjectURL(p)},console.log(" Admin functions exposed globally")},[]);return e()?l.jsx(k3e,{}):l.jsxs("div",{className:"admin-error",children:[l.jsx("h2",{children:"Access Denied"}),l.jsx("p",{children:"You don't have permission to access the admin dashboard."}),l.jsx("button",{onClick:r,children:"Return to Login"})]})},aT=({children:e,allowedRoles:t})=>{const{isAuthenticated:r,role:n,isLoading:s}=cs();return s?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):r?t&&!t.includes(n)?l.jsx(pm,{to:"/unauthorized",replace:!0}):e:l.jsx(pm,{to:"/login",replace:!0})},T3e=()=>l.jsxs("div",{className:"unauthorized-page",children:[l.jsx("h1",{children:"Access Denied"}),l.jsx("p",{children:"You don't have permission to access this page."})]}),E3e=()=>l.jsx(OM,{children:l.jsx(PB,{children:l.jsx(AB,{children:l.jsx(VK,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:l.jsx("div",{className:"app",children:l.jsxs(gN,{children:[l.jsx(Os,{path:"/login",element:l.jsx(iae,{})}),l.jsx(Os,{path:"/unauthorized",element:l.jsx(T3e,{})}),l.jsx(Os,{path:"/student/*",element:l.jsx(aT,{allowedRoles:["student"],children:l.jsx(hie,{})})}),l.jsx(Os,{path:"/teacher/*",element:l.jsx(aT,{allowedRoles:["teacher"],children:l.jsx(S3e,{})})}),l.jsx(Os,{path:"/admin/*",element:l.jsx(aT,{allowedRoles:["admin"],children:l.jsx(C3e,{})})}),l.jsx(Os,{path:"/",element:l.jsx(pm,{to:"/login",replace:!0})}),l.jsx(Os,{path:"*",element:l.jsx(pm,{to:"/login",replace:!0})})]})})})})})});class N3e{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data",this.startIntegrityMonitoring()}startIntegrityMonitoring(){setInterval(()=>{this.performIntegrityCheck()},3e4)}performIntegrityCheck(){const t=localStorage.getItem(this.tokenKey);t&&!this.validateTokenFormat(t)&&(console.warn("Integrity check failed - corrupted token detected"),this.restoreFromBackup()||(console.warn("No valid backup available - clearing authentication"),this.clearAuth()))}getToken(){const t=localStorage.getItem(this.tokenKey);return t&&!this.validateTokenFormat(t)?(console.warn("Corrupted token detected in storage - clearing it"),this.clearAuth(),null):t}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}setToken(t){if(!this.validateTokenFormat(t))return console.error("Invalid token format - refusing to store corrupted token"),!1;try{this.decodeToken(t);const r=localStorage.getItem(this.tokenKey);return r&&localStorage.setItem(`${this.tokenKey}_backup`,r),localStorage.setItem(this.tokenKey,t),console.log("Token stored successfully with backup"),!0}catch(r){return console.error("Failed to store token - token is corrupted:",r),!1}}restoreFromBackup(){const t=localStorage.getItem(`${this.tokenKey}_backup`);return t&&this.validateTokenFormat(t)?(console.log("Restoring token from backup"),localStorage.setItem(this.tokenKey,t),!0):!1}validateTokenFormat(t){if(!t||typeof t!="string")return console.warn("Token validation failed: not a string"),!1;if(!t.includes("."))return console.warn("Token validation failed: not a JWT format"),!1;const r=t.split(".");if(r.length!==3)return console.warn("Token validation failed: not 3 parts"),!1;for(let n=0;n<r.length;n++)try{atob(r[n].replace(/-/g,"+").replace(/_/g,"/"))}catch{return console.warn(`Token validation failed: part ${n} is not valid base64`),!1}return!0}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){return this.setToken(t)?(this.setUserData({role:r}),localStorage.setItem("accessToken",t),!0):(console.error("Failed to set token - token validation failed"),!1)}isAuthenticated(){const t=this.getToken();if(!t)return!1;try{if(typeof t!="string"||!t.includes("."))return console.warn("Invalid token format - not a JWT"),this.clearAuth(),!1;const r=t.split(".");if(r.length!==3)return console.warn("Invalid token format - not 3 parts"),this.clearAuth(),!1;const n=JSON.parse(atob(r[1])),s=Date.now()/1e3;return n.exp>s}catch(r){return console.error("Error decoding token:",r),console.warn("Token appears to be corrupted - clearing authentication"),this.clearAuth(),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){try{localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey),localStorage.removeItem(`${this.tokenKey}_backup`)}catch(t){console.error("Failed to clear localStorage - possible corruption:",t),this.forceClearAllAuthData()}}forceClearAllAuthData(){["auth_token","accessToken","userRole","userData","refresh_token","auth_token_backup"].forEach(r=>{try{localStorage.removeItem(r)}catch(n){console.warn(`Failed to remove ${r}:`,n)}})}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const t=this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(t,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json();return this.setToken(n.token),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(t){try{if(typeof t!="string"||!t.includes("."))return console.warn("Invalid token format - not a JWT"),this.clearAuth(),null;const r=t.split(".");return r.length!==3?(console.warn("Invalid token format - not 3 parts"),this.clearAuth(),null):JSON.parse(atob(r[1]))}catch(r){return console.error("Error decoding token:",r),console.warn("Token appears to be corrupted - clearing authentication"),this.clearAuth(),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}}const dN=new N3e;window.tokenManager=dN;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{dN.init()}):dN.init());class SV{constructor(){this.currentRole=null,this.loadedFunctions=new Set,this.blockedFunctions=new Set,this.initialized=!1,this.retryCount=0,this.maxRetries=20}initialize(){if(this.initialized){console.log("[DEBUG] Role-based loader already initialized, skipping...");return}if(this.retryCount>=this.maxRetries){console.warn("[DEBUG] Max retries reached, stopping role-based loader initialization");return}if(this.retryCount++,(this.retryCount%5===1||this.retryCount===this.maxRetries)&&console.log(`[DEBUG] Role-based loader initializing... (attempt ${this.retryCount}/${this.maxRetries})`),console.log("[DEBUG] Token manager available:",!!window.tokenManager),window.tokenManager&&window.tokenManager.isAuthenticated()){const t=window.tokenManager.getUserRole();console.log("[DEBUG] Role from token manager:",t),console.log("[DEBUG] Access token exists:",!!window.tokenManager.getAccessToken()),t?(this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess()):(console.log("[DEBUG] No role found, waiting for role to be set..."),setTimeout(()=>this.initialize(),500))}else console.log("[DEBUG] Token manager not available or not authenticated, waiting..."),setTimeout(()=>this.initialize(),500)}setupRoleBasedAccess(){this.currentRole||(console.warn("No role detected, defaulting to student access"),this.currentRole="student");let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check:",r),t=!1}console.log(`Role-based loader initialized for: ${this.currentRole}${t?" (admin)":""}`),this.loadRoleSpecificFunctions(),this.setupRoleBasedUI(),this.replaceBlockedFunctions()}loadRoleSpecificFunctions(){this.currentRole==="teacher"?this.loadTeacherFunctions():this.currentRole==="student"&&this.loadStudentFunctions()}loadTeacherFunctions(){console.log("Teacher functions already available in main script")}loadStudentFunctions(){console.log("Student functions already available in main script")}loadFunction(t,r){console.log(`Function ${t} already available in main script for ${r}`),this.loadedFunctions.add(t)}setupRoleBasedUI(){let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check in UI:",r),t=!1}this.currentRole==="student"&&this.hideTeacherElements(),this.currentRole==="teacher"&&!t&&this.hideStudentElements()}hideTeacherElements(){[".teacher-cabinet",".test-creation-panel",".grade-management-panel",".class-management-panel",'[data-role="teacher"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}hideStudentElements(){[".student-cabinet",".test-taking-panel",".results-viewing-panel",'[data-role="student"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}replaceBlockedFunctions(){this.currentRole==="student"?this.blockTeacherFunctions():this.currentRole==="teacher"&&this.blockStudentFunctions()}blockTeacherFunctions(){Object.entries({createTest:()=>this.showAccessDenied("teacher"),assignTest:()=>this.showAccessDenied("teacher"),gradeTest:()=>this.showAccessDenied("teacher"),manageClasses:()=>this.showAccessDenied("teacher"),viewAllResults:()=>this.showAccessDenied("teacher")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}blockStudentFunctions(){Object.entries({takeTest:()=>this.showAccessDenied("student"),submitTest:()=>this.showAccessDenied("student"),viewMyResults:()=>this.showAccessDenied("student")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}showAccessDenied(t){const r=`Access denied. This function requires ${t} role.`;console.warn(r),typeof showNotification=="function"?showNotification(r,"warning"):alert(r)}isFunctionBlocked(t){return this.blockedFunctions.has(t)}isFunctionLoaded(t){return this.loadedFunctions.has(t)}getCurrentRole(){return this.currentRole}hasRole(t){return this.currentRole===t}reloadRoleAccess(){this.initialize()}setupAccessAfterLogin(){if(console.log("[DEBUG] Setting up role-based access after login..."),console.log("[DEBUG] Role-based loader will now initialize (no more retry loop before login)"),!window.tokenManager)return console.error("[ERROR] Token manager not available during setupAccessAfterLogin"),!1;if(!window.tokenManager.isAuthenticated())return console.error("[ERROR] User not authenticated during setupAccessAfterLogin"),!1;const t=window.tokenManager.getUserRole();return t?(console.log("[DEBUG] Setting role after login:",t),this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess(),console.log("[DEBUG] Role-based access setup completed successfully for role:",t),!0):(console.error("[ERROR] No role found in token during setupAccessAfterLogin"),!1)}}window.roleBasedLoader=new SV;typeof lb<"u"&&lb.exports&&(lb.exports=SV);const A3e=()=>{const e={schemaVersion:"2.0",enhancedFeatures:!0,newUserStructure:!0,newTestStructure:!0};localStorage.setItem("app_init_data",JSON.stringify(e))},j3e=()=>{A3e(),eK.createRoot(document.getElementById("root")).render(l.jsx(Fs.StrictMode,{children:l.jsx(E3e,{})}))};j3e()});export default P3e();
