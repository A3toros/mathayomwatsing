var VV=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var j3e=VV((cAe,lb)=>{function mM(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var cb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Nl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var yS={exports:{}},Zp={},vS={exports:{}},Zr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dj;function KV(){if(Dj)return Zr;Dj=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),i=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.iterator;function g(W){return W===null||typeof W!="object"?null:(W=h&&W[h]||W["@@iterator"],typeof W=="function"?W:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,v={};function w(W,I,B){this.props=W,this.context=I,this.refs=v,this.updater=B||p}w.prototype.isReactComponent={},w.prototype.setState=function(W,I){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,I,"setState")},w.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function C(){}C.prototype=w.prototype;function k(W,I,B){this.props=W,this.context=I,this.refs=v,this.updater=B||p}var _=k.prototype=new C;_.constructor=k,x(_,w.prototype),_.isPureReactComponent=!0;var N=Array.isArray,E=Object.prototype.hasOwnProperty,P={current:null},F={key:!0,ref:!0,__self:!0,__source:!0};function A(W,I,B){var q,J={},se=null,X=null;if(I!=null)for(q in I.ref!==void 0&&(X=I.ref),I.key!==void 0&&(se=""+I.key),I)E.call(I,q)&&!F.hasOwnProperty(q)&&(J[q]=I[q]);var ie=arguments.length-2;if(ie===1)J.children=B;else if(1<ie){for(var le=Array(ie),ce=0;ce<ie;ce++)le[ce]=arguments[ce+2];J.children=le}if(W&&W.defaultProps)for(q in ie=W.defaultProps,ie)J[q]===void 0&&(J[q]=ie[q]);return{$$typeof:e,type:W,key:se,ref:X,props:J,_owner:P.current}}function j(W,I){return{$$typeof:e,type:W.type,key:I,ref:W.ref,props:W.props,_owner:W._owner}}function R(W){return typeof W=="object"&&W!==null&&W.$$typeof===e}function U(W){var I={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(B){return I[B]})}var Y=/\/+/g;function Z(W,I){return typeof W=="object"&&W!==null&&W.key!=null?U(""+W.key):I.toString(36)}function ae(W,I,B,q,J){var se=typeof W;(se==="undefined"||se==="boolean")&&(W=null);var X=!1;if(W===null)X=!0;else switch(se){case"string":case"number":X=!0;break;case"object":switch(W.$$typeof){case e:case t:X=!0}}if(X)return X=W,J=J(X),W=q===""?"."+Z(X,0):q,N(J)?(B="",W!=null&&(B=W.replace(Y,"$&/")+"/"),ae(J,I,B,"",function(ce){return ce})):J!=null&&(R(J)&&(J=j(J,B+(!J.key||X&&X.key===J.key?"":(""+J.key).replace(Y,"$&/")+"/")+W)),I.push(J)),1;if(X=0,q=q===""?".":q+":",N(W))for(var ie=0;ie<W.length;ie++){se=W[ie];var le=q+Z(se,ie);X+=ae(se,I,B,le,J)}else if(le=g(W),typeof le=="function")for(W=le.call(W),ie=0;!(se=W.next()).done;)se=se.value,le=q+Z(se,ie++),X+=ae(se,I,B,le,J);else if(se==="object")throw I=String(W),Error("Objects are not valid as a React child (found: "+(I==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.");return X}function ee(W,I,B){if(W==null)return W;var q=[],J=0;return ae(W,q,"","",function(se){return I.call(B,se,J++)}),q}function ne(W){if(W._status===-1){var I=W._result;I=I(),I.then(function(B){(W._status===0||W._status===-1)&&(W._status=1,W._result=B)},function(B){(W._status===0||W._status===-1)&&(W._status=2,W._result=B)}),W._status===-1&&(W._status=0,W._result=I)}if(W._status===1)return W._result.default;throw W._result}var L={current:null},H={transition:null},M={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:H,ReactCurrentOwner:P};function V(){throw Error("act(...) is not supported in production builds of React.")}return Zr.Children={map:ee,forEach:function(W,I,B){ee(W,function(){I.apply(this,arguments)},B)},count:function(W){var I=0;return ee(W,function(){I++}),I},toArray:function(W){return ee(W,function(I){return I})||[]},only:function(W){if(!R(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},Zr.Component=w,Zr.Fragment=r,Zr.Profiler=s,Zr.PureComponent=k,Zr.StrictMode=n,Zr.Suspense=l,Zr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,Zr.act=V,Zr.cloneElement=function(W,I,B){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var q=x({},W.props),J=W.key,se=W.ref,X=W._owner;if(I!=null){if(I.ref!==void 0&&(se=I.ref,X=P.current),I.key!==void 0&&(J=""+I.key),W.type&&W.type.defaultProps)var ie=W.type.defaultProps;for(le in I)E.call(I,le)&&!F.hasOwnProperty(le)&&(q[le]=I[le]===void 0&&ie!==void 0?ie[le]:I[le])}var le=arguments.length-2;if(le===1)q.children=B;else if(1<le){ie=Array(le);for(var ce=0;ce<le;ce++)ie[ce]=arguments[ce+2];q.children=ie}return{$$typeof:e,type:W.type,key:J,ref:se,props:q,_owner:X}},Zr.createContext=function(W){return W={$$typeof:i,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:a,_context:W},W.Consumer=W},Zr.createElement=A,Zr.createFactory=function(W){var I=A.bind(null,W);return I.type=W,I},Zr.createRef=function(){return{current:null}},Zr.forwardRef=function(W){return{$$typeof:o,render:W}},Zr.isValidElement=R,Zr.lazy=function(W){return{$$typeof:d,_payload:{_status:-1,_result:W},_init:ne}},Zr.memo=function(W,I){return{$$typeof:u,type:W,compare:I===void 0?null:I}},Zr.startTransition=function(W){var I=H.transition;H.transition={};try{W()}finally{H.transition=I}},Zr.unstable_act=V,Zr.useCallback=function(W,I){return L.current.useCallback(W,I)},Zr.useContext=function(W){return L.current.useContext(W)},Zr.useDebugValue=function(){},Zr.useDeferredValue=function(W){return L.current.useDeferredValue(W)},Zr.useEffect=function(W,I){return L.current.useEffect(W,I)},Zr.useId=function(){return L.current.useId()},Zr.useImperativeHandle=function(W,I,B){return L.current.useImperativeHandle(W,I,B)},Zr.useInsertionEffect=function(W,I){return L.current.useInsertionEffect(W,I)},Zr.useLayoutEffect=function(W,I){return L.current.useLayoutEffect(W,I)},Zr.useMemo=function(W,I){return L.current.useMemo(W,I)},Zr.useReducer=function(W,I,B){return L.current.useReducer(W,I,B)},Zr.useRef=function(W){return L.current.useRef(W)},Zr.useState=function(W){return L.current.useState(W)},Zr.useSyncExternalStore=function(W,I,B){return L.current.useSyncExternalStore(W,I,B)},Zr.useTransition=function(){return L.current.useTransition()},Zr.version="18.3.1",Zr}var Rj;function b0(){return Rj||(Rj=1,vS.exports=KV()),vS.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ij;function qV(){if(Ij)return Zp;Ij=1;var e=b0(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function i(o,l,u){var d,h={},g=null,p=null;u!==void 0&&(g=""+u),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(p=l.ref);for(d in l)n.call(l,d)&&!a.hasOwnProperty(d)&&(h[d]=l[d]);if(o&&o.defaultProps)for(d in l=o.defaultProps,l)h[d]===void 0&&(h[d]=l[d]);return{$$typeof:t,type:o,key:g,ref:p,props:h,_owner:s.current}}return Zp.Fragment=r,Zp.jsx=i,Zp.jsxs=i,Zp}var Mj;function YV(){return Mj||(Mj=1,yS.exports=qV()),yS.exports}var c=YV(),S=b0();const Ss=Nl(S),pM=mM({__proto__:null,default:Ss},[S]);var ow={},wS={exports:{}},oo={},bS={exports:{}},_S={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lj;function XV(){return Lj||(Lj=1,(function(e){function t(H,M){var V=H.length;H.push(M);e:for(;0<V;){var W=V-1>>>1,I=H[W];if(0<s(I,M))H[W]=M,H[V]=I,V=W;else break e}}function r(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var M=H[0],V=H.pop();if(V!==M){H[0]=V;e:for(var W=0,I=H.length,B=I>>>1;W<B;){var q=2*(W+1)-1,J=H[q],se=q+1,X=H[se];if(0>s(J,V))se<I&&0>s(X,J)?(H[W]=X,H[se]=V,W=se):(H[W]=J,H[q]=V,W=q);else if(se<I&&0>s(X,V))H[W]=X,H[se]=V,W=se;else break e}}return M}function s(H,M){var V=H.sortIndex-M.sortIndex;return V!==0?V:H.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],u=[],d=1,h=null,g=3,p=!1,x=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(H){for(var M=r(u);M!==null;){if(M.callback===null)n(u);else if(M.startTime<=H)n(u),M.sortIndex=M.expirationTime,t(l,M);else break;M=r(u)}}function N(H){if(v=!1,_(H),!x)if(r(l)!==null)x=!0,ne(E);else{var M=r(u);M!==null&&L(N,M.startTime-H)}}function E(H,M){x=!1,v&&(v=!1,C(A),A=-1),p=!0;var V=g;try{for(_(M),h=r(l);h!==null&&(!(h.expirationTime>M)||H&&!U());){var W=h.callback;if(typeof W=="function"){h.callback=null,g=h.priorityLevel;var I=W(h.expirationTime<=M);M=e.unstable_now(),typeof I=="function"?h.callback=I:h===r(l)&&n(l),_(M)}else n(l);h=r(l)}if(h!==null)var B=!0;else{var q=r(u);q!==null&&L(N,q.startTime-M),B=!1}return B}finally{h=null,g=V,p=!1}}var P=!1,F=null,A=-1,j=5,R=-1;function U(){return!(e.unstable_now()-R<j)}function Y(){if(F!==null){var H=e.unstable_now();R=H;var M=!0;try{M=F(!0,H)}finally{M?Z():(P=!1,F=null)}}else P=!1}var Z;if(typeof k=="function")Z=function(){k(Y)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,ee=ae.port2;ae.port1.onmessage=Y,Z=function(){ee.postMessage(null)}}else Z=function(){w(Y,0)};function ne(H){F=H,P||(P=!0,Z())}function L(H,M){A=w(function(){H(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(H){H.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,ne(E))},e.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<H?Math.floor(1e3/H):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(H){switch(g){case 1:case 2:case 3:var M=3;break;default:M=g}var V=g;g=M;try{return H()}finally{g=V}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(H,M){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var V=g;g=H;try{return M()}finally{g=V}},e.unstable_scheduleCallback=function(H,M,V){var W=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?W+V:W):V=W,H){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=V+I,H={id:d++,callback:M,priorityLevel:H,startTime:V,expirationTime:I,sortIndex:-1},V>W?(H.sortIndex=V,t(u,H),r(l)===null&&H===r(u)&&(v?(C(A),A=-1):v=!0,L(N,V-W))):(H.sortIndex=I,t(l,H),x||p||(x=!0,ne(E))),H},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(H){var M=g;return function(){var V=g;g=M;try{return H.apply(this,arguments)}finally{g=V}}}})(_S)),_S}var Bj;function dN(){return Bj||(Bj=1,bS.exports=XV()),bS.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $j;function JV(){if($j)return oo;$j=1;var e=b0(),t=dN();function r(f){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+f,T=1;T<arguments.length;T++)m+="&args[]="+encodeURIComponent(arguments[T]);return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function a(f,m){i(f,m),i(f+"Capture",m)}function i(f,m){for(s[f]=m,f=0;f<m.length;f++)n.add(m[f])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},h={};function g(f){return l.call(h,f)?!0:l.call(d,f)?!1:u.test(f)?h[f]=!0:(d[f]=!0,!1)}function p(f,m,T,D){if(T!==null&&T.type===0)return!1;switch(typeof m){case"function":case"symbol":return!0;case"boolean":return D?!1:T!==null?!T.acceptsBooleans:(f=f.toLowerCase().slice(0,5),f!=="data-"&&f!=="aria-");default:return!1}}function x(f,m,T,D){if(m===null||typeof m>"u"||p(f,m,T,D))return!0;if(D)return!1;if(T!==null)switch(T.type){case 3:return!m;case 4:return m===!1;case 5:return isNaN(m);case 6:return isNaN(m)||1>m}return!1}function v(f,m,T,D,G,Q,de){this.acceptsBooleans=m===2||m===3||m===4,this.attributeName=D,this.attributeNamespace=G,this.mustUseProperty=T,this.propertyName=f,this.type=m,this.sanitizeURL=Q,this.removeEmptyString=de}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(f){w[f]=new v(f,0,!1,f,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(f){var m=f[0];w[m]=new v(m,1,!1,f[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(f){w[f]=new v(f,2,!1,f.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(f){w[f]=new v(f,2,!1,f,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(f){w[f]=new v(f,3,!1,f.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(f){w[f]=new v(f,3,!0,f,null,!1,!1)}),["capture","download"].forEach(function(f){w[f]=new v(f,4,!1,f,null,!1,!1)}),["cols","rows","size","span"].forEach(function(f){w[f]=new v(f,6,!1,f,null,!1,!1)}),["rowSpan","start"].forEach(function(f){w[f]=new v(f,5,!1,f.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function k(f){return f[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(f){var m=f.replace(C,k);w[m]=new v(m,1,!1,f,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(f){var m=f.replace(C,k);w[m]=new v(m,1,!1,f,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(f){var m=f.replace(C,k);w[m]=new v(m,1,!1,f,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(f){w[f]=new v(f,1,!1,f.toLowerCase(),null,!1,!1)}),w.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(f){w[f]=new v(f,1,!1,f.toLowerCase(),null,!0,!0)});function _(f,m,T,D){var G=w.hasOwnProperty(m)?w[m]:null;(G!==null?G.type!==0:D||!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(x(m,T,G,D)&&(T=null),D||G===null?g(m)&&(T===null?f.removeAttribute(m):f.setAttribute(m,""+T)):G.mustUseProperty?f[G.propertyName]=T===null?G.type===3?!1:"":T:(m=G.attributeName,D=G.attributeNamespace,T===null?f.removeAttribute(m):(G=G.type,T=G===3||G===4&&T===!0?"":""+T,D?f.setAttributeNS(D,m,T):f.setAttribute(m,T))))}var N=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,E=Symbol.for("react.element"),P=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),R=Symbol.for("react.provider"),U=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),ae=Symbol.for("react.suspense_list"),ee=Symbol.for("react.memo"),ne=Symbol.for("react.lazy"),L=Symbol.for("react.offscreen"),H=Symbol.iterator;function M(f){return f===null||typeof f!="object"?null:(f=H&&f[H]||f["@@iterator"],typeof f=="function"?f:null)}var V=Object.assign,W;function I(f){if(W===void 0)try{throw Error()}catch(T){var m=T.stack.trim().match(/\n( *(at )?)/);W=m&&m[1]||""}return`
`+W+f}var B=!1;function q(f,m){if(!f||B)return"";B=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch(gt){var D=gt}Reflect.construct(f,[],m)}else{try{m.call()}catch(gt){D=gt}f.call(m.prototype)}else{try{throw Error()}catch(gt){D=gt}f()}}catch(gt){if(gt&&D&&typeof gt.stack=="string"){for(var G=gt.stack.split(`
`),Q=D.stack.split(`
`),de=G.length-1,Pe=Q.length-1;1<=de&&0<=Pe&&G[de]!==Q[Pe];)Pe--;for(;1<=de&&0<=Pe;de--,Pe--)if(G[de]!==Q[Pe]){if(de!==1||Pe!==1)do if(de--,Pe--,0>Pe||G[de]!==Q[Pe]){var Ie=`
`+G[de].replace(" at new "," at ");return f.displayName&&Ie.includes("<anonymous>")&&(Ie=Ie.replace("<anonymous>",f.displayName)),Ie}while(1<=de&&0<=Pe);break}}}finally{B=!1,Error.prepareStackTrace=T}return(f=f?f.displayName||f.name:"")?I(f):""}function J(f){switch(f.tag){case 5:return I(f.type);case 16:return I("Lazy");case 13:return I("Suspense");case 19:return I("SuspenseList");case 0:case 2:case 15:return f=q(f.type,!1),f;case 11:return f=q(f.type.render,!1),f;case 1:return f=q(f.type,!0),f;default:return""}}function se(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case F:return"Fragment";case P:return"Portal";case j:return"Profiler";case A:return"StrictMode";case Z:return"Suspense";case ae:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case U:return(f.displayName||"Context")+".Consumer";case R:return(f._context.displayName||"Context")+".Provider";case Y:var m=f.render;return f=f.displayName,f||(f=m.displayName||m.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case ee:return m=f.displayName||null,m!==null?m:se(f.type)||"Memo";case ne:m=f._payload,f=f._init;try{return se(f(m))}catch{}}return null}function X(f){var m=f.type;switch(f.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=m.render,f=f.displayName||f.name||"",m.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return se(m);case 8:return m===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function ie(f){switch(typeof f){case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function le(f){var m=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function ce(f){var m=le(f)?"checked":"value",T=Object.getOwnPropertyDescriptor(f.constructor.prototype,m),D=""+f[m];if(!f.hasOwnProperty(m)&&typeof T<"u"&&typeof T.get=="function"&&typeof T.set=="function"){var G=T.get,Q=T.set;return Object.defineProperty(f,m,{configurable:!0,get:function(){return G.call(this)},set:function(de){D=""+de,Q.call(this,de)}}),Object.defineProperty(f,m,{enumerable:T.enumerable}),{getValue:function(){return D},setValue:function(de){D=""+de},stopTracking:function(){f._valueTracker=null,delete f[m]}}}}function ke(f){f._valueTracker||(f._valueTracker=ce(f))}function re(f){if(!f)return!1;var m=f._valueTracker;if(!m)return!0;var T=m.getValue(),D="";return f&&(D=le(f)?f.checked?"true":"false":f.value),f=D,f!==T?(m.setValue(f),!0):!1}function ge(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}function Ne(f,m){var T=m.checked;return V({},m,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:T??f._wrapperState.initialChecked})}function je(f,m){var T=m.defaultValue==null?"":m.defaultValue,D=m.checked!=null?m.checked:m.defaultChecked;T=ie(m.value!=null?m.value:T),f._wrapperState={initialChecked:D,initialValue:T,controlled:m.type==="checkbox"||m.type==="radio"?m.checked!=null:m.value!=null}}function Ke(f,m){m=m.checked,m!=null&&_(f,"checked",m,!1)}function Ue(f,m){Ke(f,m);var T=ie(m.value),D=m.type;if(T!=null)D==="number"?(T===0&&f.value===""||f.value!=T)&&(f.value=""+T):f.value!==""+T&&(f.value=""+T);else if(D==="submit"||D==="reset"){f.removeAttribute("value");return}m.hasOwnProperty("value")?rt(f,m.type,T):m.hasOwnProperty("defaultValue")&&rt(f,m.type,ie(m.defaultValue)),m.checked==null&&m.defaultChecked!=null&&(f.defaultChecked=!!m.defaultChecked)}function It(f,m,T){if(m.hasOwnProperty("value")||m.hasOwnProperty("defaultValue")){var D=m.type;if(!(D!=="submit"&&D!=="reset"||m.value!==void 0&&m.value!==null))return;m=""+f._wrapperState.initialValue,T||m===f.value||(f.value=m),f.defaultValue=m}T=f.name,T!==""&&(f.name=""),f.defaultChecked=!!f._wrapperState.initialChecked,T!==""&&(f.name=T)}function rt(f,m,T){(m!=="number"||ge(f.ownerDocument)!==f)&&(T==null?f.defaultValue=""+f._wrapperState.initialValue:f.defaultValue!==""+T&&(f.defaultValue=""+T))}var wt=Array.isArray;function xt(f,m,T,D){if(f=f.options,m){m={};for(var G=0;G<T.length;G++)m["$"+T[G]]=!0;for(T=0;T<f.length;T++)G=m.hasOwnProperty("$"+f[T].value),f[T].selected!==G&&(f[T].selected=G),G&&D&&(f[T].defaultSelected=!0)}else{for(T=""+ie(T),m=null,G=0;G<f.length;G++){if(f[G].value===T){f[G].selected=!0,D&&(f[G].defaultSelected=!0);return}m!==null||f[G].disabled||(m=f[G])}m!==null&&(m.selected=!0)}}function lt(f,m){if(m.dangerouslySetInnerHTML!=null)throw Error(r(91));return V({},m,{value:void 0,defaultValue:void 0,children:""+f._wrapperState.initialValue})}function pt(f,m){var T=m.value;if(T==null){if(T=m.children,m=m.defaultValue,T!=null){if(m!=null)throw Error(r(92));if(wt(T)){if(1<T.length)throw Error(r(93));T=T[0]}m=T}m==null&&(m=""),T=m}f._wrapperState={initialValue:ie(T)}}function Rt(f,m){var T=ie(m.value),D=ie(m.defaultValue);T!=null&&(T=""+T,T!==f.value&&(f.value=T),m.defaultValue==null&&f.defaultValue!==T&&(f.defaultValue=T)),D!=null&&(f.defaultValue=""+D)}function Mt(f){var m=f.textContent;m===f._wrapperState.initialValue&&m!==""&&m!==null&&(f.value=m)}function Qe(f){switch(f){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Re(f,m){return f==null||f==="http://www.w3.org/1999/xhtml"?Qe(m):f==="http://www.w3.org/2000/svg"&&m==="foreignObject"?"http://www.w3.org/1999/xhtml":f}var Be,ct=(function(f){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(m,T,D,G){MSApp.execUnsafeLocalFunction(function(){return f(m,T,D,G)})}:f})(function(f,m){if(f.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in f)f.innerHTML=m;else{for(Be=Be||document.createElement("div"),Be.innerHTML="<svg>"+m.valueOf().toString()+"</svg>",m=Be.firstChild;f.firstChild;)f.removeChild(f.firstChild);for(;m.firstChild;)f.appendChild(m.firstChild)}});function We(f,m){if(m){var T=f.firstChild;if(T&&T===f.lastChild&&T.nodeType===3){T.nodeValue=m;return}}f.textContent=m}var nt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Tt=["Webkit","ms","Moz","O"];Object.keys(nt).forEach(function(f){Tt.forEach(function(m){m=m+f.charAt(0).toUpperCase()+f.substring(1),nt[m]=nt[f]})});function jt(f,m,T){return m==null||typeof m=="boolean"||m===""?"":T||typeof m!="number"||m===0||nt.hasOwnProperty(f)&&nt[f]?(""+m).trim():m+"px"}function Vt(f,m){f=f.style;for(var T in m)if(m.hasOwnProperty(T)){var D=T.indexOf("--")===0,G=jt(T,m[T],D);T==="float"&&(T="cssFloat"),D?f.setProperty(T,G):f[T]=G}}var fr=V({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dr(f,m){if(m){if(fr[f]&&(m.children!=null||m.dangerouslySetInnerHTML!=null))throw Error(r(137,f));if(m.dangerouslySetInnerHTML!=null){if(m.children!=null)throw Error(r(60));if(typeof m.dangerouslySetInnerHTML!="object"||!("__html"in m.dangerouslySetInnerHTML))throw Error(r(61))}if(m.style!=null&&typeof m.style!="object")throw Error(r(62))}}function zr(f,m){if(f.indexOf("-")===-1)return typeof m.is=="string";switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var or=null;function nr(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var me=null,Ae=null,Fe=null;function Me(f){if(f=rh(f)){if(typeof me!="function")throw Error(r(280));var m=f.stateNode;m&&(m=Vs(m),me(f.stateNode,f.type,m))}}function kt(f){Ae?Fe?Fe.push(f):Fe=[f]:Ae=f}function Oe(){if(Ae){var f=Ae,m=Fe;if(Fe=Ae=null,Me(f),m)for(f=0;f<m.length;f++)Me(m[f])}}function at(f,m){return f(m)}function Ce(){}var Ve=!1;function Ze(f,m,T){if(Ve)return f(m,T);Ve=!0;try{return at(f,m,T)}finally{Ve=!1,(Ae!==null||Fe!==null)&&(Ce(),Oe())}}function Ft(f,m){var T=f.stateNode;if(T===null)return null;var D=Vs(T);if(D===null)return null;T=D[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(D=!D.disabled)||(f=f.type,D=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!D;break e;default:f=!1}if(f)return null;if(T&&typeof T!="function")throw Error(r(231,m,typeof T));return T}var zt=!1;if(o)try{var er={};Object.defineProperty(er,"passive",{get:function(){zt=!0}}),window.addEventListener("test",er,er),window.removeEventListener("test",er,er)}catch{zt=!1}function hr(f,m,T,D,G,Q,de,Pe,Ie){var gt=Array.prototype.slice.call(arguments,3);try{m.apply(T,gt)}catch(Bt){this.onError(Bt)}}var ir=!1,Wr=null,ue=!1,be=null,ye={onError:function(f){ir=!0,Wr=f}};function xe(f,m,T,D,G,Q,de,Pe,Ie){ir=!1,Wr=null,hr.apply(ye,arguments)}function _e(f,m,T,D,G,Q,de,Pe,Ie){if(xe.apply(this,arguments),ir){if(ir){var gt=Wr;ir=!1,Wr=null}else throw Error(r(198));ue||(ue=!0,be=gt)}}function Se(f){var m=f,T=f;if(f.alternate)for(;m.return;)m=m.return;else{f=m;do m=f,(m.flags&4098)!==0&&(T=m.return),f=m.return;while(f)}return m.tag===3?T:null}function He(f){if(f.tag===13){var m=f.memoizedState;if(m===null&&(f=f.alternate,f!==null&&(m=f.memoizedState)),m!==null)return m.dehydrated}return null}function it(f){if(Se(f)!==f)throw Error(r(188))}function Ye(f){var m=f.alternate;if(!m){if(m=Se(f),m===null)throw Error(r(188));return m!==f?null:f}for(var T=f,D=m;;){var G=T.return;if(G===null)break;var Q=G.alternate;if(Q===null){if(D=G.return,D!==null){T=D;continue}break}if(G.child===Q.child){for(Q=G.child;Q;){if(Q===T)return it(G),f;if(Q===D)return it(G),m;Q=Q.sibling}throw Error(r(188))}if(T.return!==D.return)T=G,D=Q;else{for(var de=!1,Pe=G.child;Pe;){if(Pe===T){de=!0,T=G,D=Q;break}if(Pe===D){de=!0,D=G,T=Q;break}Pe=Pe.sibling}if(!de){for(Pe=Q.child;Pe;){if(Pe===T){de=!0,T=Q,D=G;break}if(Pe===D){de=!0,D=Q,T=G;break}Pe=Pe.sibling}if(!de)throw Error(r(189))}}if(T.alternate!==D)throw Error(r(190))}if(T.tag!==3)throw Error(r(188));return T.stateNode.current===T?f:m}function oe(f){return f=Ye(f),f!==null?fe(f):null}function fe(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var m=fe(f);if(m!==null)return m;f=f.sibling}return null}var Te=t.unstable_scheduleCallback,Ee=t.unstable_cancelCallback,Xe=t.unstable_shouldYield,ut=t.unstable_requestPaint,ft=t.unstable_now,Kt=t.unstable_getCurrentPriorityLevel,Ct=t.unstable_ImmediatePriority,Ht=t.unstable_UserBlockingPriority,yr=t.unstable_NormalPriority,wr=t.unstable_LowPriority,vr=t.unstable_IdlePriority,Er=null,qr=null;function Hr(f){if(qr&&typeof qr.onCommitFiberRoot=="function")try{qr.onCommitFiberRoot(Er,f,void 0,(f.current.flags&128)===128)}catch{}}var he=Math.clz32?Math.clz32:br,vt=Math.log,xr=Math.LN2;function br(f){return f>>>=0,f===0?32:31-(vt(f)/xr|0)|0}var Bn=64,An=4194304;function et(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function we(f,m){var T=f.pendingLanes;if(T===0)return 0;var D=0,G=f.suspendedLanes,Q=f.pingedLanes,de=T&268435455;if(de!==0){var Pe=de&~G;Pe!==0?D=et(Pe):(Q&=de,Q!==0&&(D=et(Q)))}else de=T&~G,de!==0?D=et(de):Q!==0&&(D=et(Q));if(D===0)return 0;if(m!==0&&m!==D&&(m&G)===0&&(G=D&-D,Q=m&-m,G>=Q||G===16&&(Q&4194240)!==0))return m;if((D&4)!==0&&(D|=T&16),m=f.entangledLanes,m!==0)for(f=f.entanglements,m&=D;0<m;)T=31-he(m),G=1<<T,D|=f[T],m&=~G;return D}function $e(f,m){switch(f){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Le(f,m){for(var T=f.suspendedLanes,D=f.pingedLanes,G=f.expirationTimes,Q=f.pendingLanes;0<Q;){var de=31-he(Q),Pe=1<<de,Ie=G[de];Ie===-1?((Pe&T)===0||(Pe&D)!==0)&&(G[de]=$e(Pe,m)):Ie<=m&&(f.expiredLanes|=Pe),Q&=~Pe}}function Et(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function Nt(){var f=Bn;return Bn<<=1,(Bn&4194240)===0&&(Bn=64),f}function mr(f){for(var m=[],T=0;31>T;T++)m.push(f);return m}function an(f,m,T){f.pendingLanes|=m,m!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,m=31-he(m),f[m]=T}function ht(f,m){var T=f.pendingLanes&~m;f.pendingLanes=m,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=m,f.mutableReadLanes&=m,f.entangledLanes&=m,m=f.entanglements;var D=f.eventTimes;for(f=f.expirationTimes;0<T;){var G=31-he(T),Q=1<<G;m[G]=0,D[G]=-1,f[G]=-1,T&=~Q}}function Qt(f,m){var T=f.entangledLanes|=m;for(f=f.entanglements;T;){var D=31-he(T),G=1<<D;G&m|f[D]&m&&(f[D]|=m),T&=~G}}var Pt=0;function es(f){return f&=-f,1<f?4<f?(f&268435455)!==0?16:536870912:4:1}var Jr,Nr,os,li,Go,cc=!1,uc=[],Zi=null,dc=null,Vo=null,Qr=new Map,md=new Map,Ko=[],c1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function u1(f,m){switch(f){case"focusin":case"focusout":Zi=null;break;case"dragenter":case"dragleave":dc=null;break;case"mouseover":case"mouseout":Vo=null;break;case"pointerover":case"pointerout":Qr.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":md.delete(m.pointerId)}}function zf(f,m,T,D,G,Q){return f===null||f.nativeEvent!==Q?(f={blockedOn:m,domEventName:T,eventSystemFlags:D,nativeEvent:Q,targetContainers:[G]},m!==null&&(m=rh(m),m!==null&&Nr(m)),f):(f.eventSystemFlags|=D,m=f.targetContainers,G!==null&&m.indexOf(G)===-1&&m.push(G),f)}function Hs(f,m,T,D,G){switch(m){case"focusin":return Zi=zf(Zi,f,m,T,D,G),!0;case"dragenter":return dc=zf(dc,f,m,T,D,G),!0;case"mouseover":return Vo=zf(Vo,f,m,T,D,G),!0;case"pointerover":var Q=G.pointerId;return Qr.set(Q,zf(Qr.get(Q)||null,f,m,T,D,G)),!0;case"gotpointercapture":return Q=G.pointerId,md.set(Q,zf(md.get(Q)||null,f,m,T,D,G)),!0}return!1}function I0(f){var m=bc(f.target);if(m!==null){var T=Se(m);if(T!==null){if(m=T.tag,m===13){if(m=He(T),m!==null){f.blockedOn=m,Go(f.priority,function(){os(T)});return}}else if(m===3&&T.stateNode.current.memoizedState.isDehydrated){f.blockedOn=T.tag===3?T.stateNode.containerInfo:null;return}}}f.blockedOn=null}function M0(f){if(f.blockedOn!==null)return!1;for(var m=f.targetContainers;0<m.length;){var T=$0(f.domEventName,f.eventSystemFlags,m[0],f.nativeEvent);if(T===null){T=f.nativeEvent;var D=new T.constructor(T.type,T);or=D,T.target.dispatchEvent(D),or=null}else return m=rh(T),m!==null&&Nr(m),f.blockedOn=T,!1;m.shift()}return!0}function L0(f,m,T){M0(f)&&T.delete(m)}function z2(){cc=!1,Zi!==null&&M0(Zi)&&(Zi=null),dc!==null&&M0(dc)&&(dc=null),Vo!==null&&M0(Vo)&&(Vo=null),Qr.forEach(L0),md.forEach(L0)}function fc(f,m){f.blockedOn===m&&(f.blockedOn=null,cc||(cc=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,z2)))}function ci(f){function m(G){return fc(G,f)}if(0<uc.length){fc(uc[0],f);for(var T=1;T<uc.length;T++){var D=uc[T];D.blockedOn===f&&(D.blockedOn=null)}}for(Zi!==null&&fc(Zi,f),dc!==null&&fc(dc,f),Vo!==null&&fc(Vo,f),Qr.forEach(m),md.forEach(m),T=0;T<Ko.length;T++)D=Ko[T],D.blockedOn===f&&(D.blockedOn=null);for(;0<Ko.length&&(T=Ko[0],T.blockedOn===null);)I0(T),T.blockedOn===null&&Ko.shift()}var pd=N.ReactCurrentBatchConfig,B0=!0;function bo(f,m,T,D){var G=Pt,Q=pd.transition;pd.transition=null;try{Pt=1,xd(f,m,T,D)}finally{Pt=G,pd.transition=Q}}function Ol(f,m,T,D){var G=Pt,Q=pd.transition;pd.transition=null;try{Pt=4,xd(f,m,T,D)}finally{Pt=G,pd.transition=Q}}function xd(f,m,T,D){if(B0){var G=$0(f,m,T,D);if(G===null)rg(f,m,D,yd,T),u1(f,D);else if(Hs(G,f,m,T,D))D.stopPropagation();else if(u1(f,D),m&4&&-1<c1.indexOf(f)){for(;G!==null;){var Q=rh(G);if(Q!==null&&Jr(Q),Q=$0(f,m,T,D),Q===null&&rg(f,m,D,yd,T),Q===G)break;G=Q}G!==null&&D.stopPropagation()}else rg(f,m,D,null,T)}}var yd=null;function $0(f,m,T,D){if(yd=null,f=nr(D),f=bc(f),f!==null)if(m=Se(f),m===null)f=null;else if(T=m.tag,T===13){if(f=He(m),f!==null)return f;f=null}else if(T===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;f=null}else m!==f&&(f=null);return yd=f,null}function d1(f){switch(f){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Kt()){case Ct:return 1;case Ht:return 4;case yr:case wr:return 16;case vr:return 536870912;default:return 16}default:return 16}}var na=null,hc=null,Dl=null;function Wf(){if(Dl)return Dl;var f,m=hc,T=m.length,D,G="value"in na?na.value:na.textContent,Q=G.length;for(f=0;f<T&&m[f]===G[f];f++);var de=T-f;for(D=1;D<=de&&m[T-D]===G[Q-D];D++);return Dl=G.slice(f,1<D?1-D:void 0)}function tu(f){var m=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&m===13&&(f=13)):f=m,f===10&&(f=13),32<=f||f===13?f:0}function La(){return!0}function ji(){return!1}function Ps(f){function m(T,D,G,Q,de){this._reactName=T,this._targetInst=G,this.type=D,this.nativeEvent=Q,this.target=de,this.currentTarget=null;for(var Pe in f)f.hasOwnProperty(Pe)&&(T=f[Pe],this[Pe]=T?T(Q):Q[Pe]);return this.isDefaultPrevented=(Q.defaultPrevented!=null?Q.defaultPrevented:Q.returnValue===!1)?La:ji,this.isPropagationStopped=ji,this}return V(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var T=this.nativeEvent;T&&(T.preventDefault?T.preventDefault():typeof T.returnValue!="unknown"&&(T.returnValue=!1),this.isDefaultPrevented=La)},stopPropagation:function(){var T=this.nativeEvent;T&&(T.stopPropagation?T.stopPropagation():typeof T.cancelBubble!="unknown"&&(T.cancelBubble=!0),this.isPropagationStopped=La)},persist:function(){},isPersistent:La}),m}var ui={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_o=Ps(ui),So=V({},ui,{view:0,detail:0}),f1=Ps(So),Hf,Gf,sa,Ba=V({},So,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nu,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==sa&&(sa&&f.type==="mousemove"?(Hf=f.screenX-sa.screenX,Gf=f.screenY-sa.screenY):Gf=Hf=0,sa=f),Hf)},movementY:function(f){return"movementY"in f?f.movementY:Gf}}),Rn=Ps(Ba),Vf=V({},Ba,{dataTransfer:0}),ko=Ps(Vf),h1=V({},So,{relatedTarget:0}),U0=Ps(h1),up=V({},ui,{animationName:0,elapsedTime:0,pseudoElement:0}),dp=Ps(up),g1=V({},ui,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),z0=Ps(g1),m1=V({},ui,{data:0}),ru=Ps(m1),fp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},W2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},W0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function H2(f){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(f):(f=W0[f])?!!m[f]:!1}function nu(){return H2}var H0=V({},So,{key:function(f){if(f.key){var m=fp[f.key]||f.key;if(m!=="Unidentified")return m}return f.type==="keypress"?(f=tu(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?W2[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nu,charCode:function(f){return f.type==="keypress"?tu(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?tu(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),p1=Ps(H0),x1=V({},Ba,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),su=Ps(x1),y1=V({},So,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nu}),G0=Ps(y1),V0=V({},ui,{propertyName:0,elapsedTime:0,pseudoElement:0}),vd=Ps(V0),hp=V({},Ba,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),gp=Ps(hp),v1=[9,13,27,32],Kf=o&&"CompositionEvent"in window,au=null;o&&"documentMode"in document&&(au=document.documentMode);var wd=o&&"TextEvent"in window&&!au,Pi=o&&(!Kf||au&&8<au&&11>=au),gc=" ",K0=!1;function mp(f,m){switch(f){case"keyup":return v1.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Co(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var Fi=!1;function pp(f,m){switch(f){case"compositionend":return Co(m);case"keypress":return m.which!==32?null:(K0=!0,gc);case"textInput":return f=m.data,f===gc&&K0?null:f;default:return null}}function w1(f,m){if(Fi)return f==="compositionend"||!Kf&&mp(f,m)?(f=Wf(),Dl=hc=na=null,Fi=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return Pi&&m.locale!=="ko"?null:m.data;default:return null}}var Rl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Il(f){var m=f&&f.nodeName&&f.nodeName.toLowerCase();return m==="input"?!!Rl[f.type]:m==="textarea"}function qf(f,m,T,D){kt(D),m=ng(m,"onChange"),0<m.length&&(T=new _o("onChange","change",null,T,D),f.push({event:T,listeners:m}))}var bd=null,mc=null;function b1(f){Ep(f,0)}function pc(f){var m=Os(f);if(re(m))return f}function eo(f,m){if(f==="change")return m}var _d=!1;if(o){var xc;if(o){var to="oninput"in document;if(!to){var q0=document.createElement("div");q0.setAttribute("oninput","return;"),to=typeof q0.oninput=="function"}xc=to}else xc=!1;_d=xc&&(!document.documentMode||9<document.documentMode)}function iu(){bd&&(bd.detachEvent("onpropertychange",xp),mc=bd=null)}function xp(f){if(f.propertyName==="value"&&pc(mc)){var m=[];qf(m,mc,f,nr(f)),Ze(b1,m)}}function yp(f,m,T){f==="focusin"?(iu(),bd=m,mc=T,bd.attachEvent("onpropertychange",xp)):f==="focusout"&&iu()}function Hn(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return pc(mc)}function Y0(f,m){if(f==="click")return pc(m)}function vp(f,m){if(f==="input"||f==="change")return pc(m)}function wp(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var di=typeof Object.is=="function"?Object.is:wp;function ou(f,m){if(di(f,m))return!0;if(typeof f!="object"||f===null||typeof m!="object"||m===null)return!1;var T=Object.keys(f),D=Object.keys(m);if(T.length!==D.length)return!1;for(D=0;D<T.length;D++){var G=T[D];if(!l.call(m,G)||!di(f[G],m[G]))return!1}return!0}function yc(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function $n(f,m){var T=yc(f);f=0;for(var D;T;){if(T.nodeType===3){if(D=f+T.textContent.length,f<=m&&D>=m)return{node:T,offset:m-f};f=D}e:{for(;T;){if(T.nextSibling){T=T.nextSibling;break e}T=T.parentNode}T=void 0}T=yc(T)}}function ms(f,m){return f&&m?f===m?!0:f&&f.nodeType===3?!1:m&&m.nodeType===3?ms(f,m.parentNode):"contains"in f?f.contains(m):f.compareDocumentPosition?!!(f.compareDocumentPosition(m)&16):!1:!1}function Fs(){for(var f=window,m=ge();m instanceof f.HTMLIFrameElement;){try{var T=typeof m.contentWindow.location.href=="string"}catch{T=!1}if(T)f=m.contentWindow;else break;m=ge(f.document)}return m}function Sd(f){var m=f&&f.nodeName&&f.nodeName.toLowerCase();return m&&(m==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||m==="textarea"||f.contentEditable==="true")}function Yf(f){var m=Fs(),T=f.focusedElem,D=f.selectionRange;if(m!==T&&T&&T.ownerDocument&&ms(T.ownerDocument.documentElement,T)){if(D!==null&&Sd(T)){if(m=D.start,f=D.end,f===void 0&&(f=m),"selectionStart"in T)T.selectionStart=m,T.selectionEnd=Math.min(f,T.value.length);else if(f=(m=T.ownerDocument||document)&&m.defaultView||window,f.getSelection){f=f.getSelection();var G=T.textContent.length,Q=Math.min(D.start,G);D=D.end===void 0?Q:Math.min(D.end,G),!f.extend&&Q>D&&(G=D,D=Q,Q=G),G=$n(T,Q);var de=$n(T,D);G&&de&&(f.rangeCount!==1||f.anchorNode!==G.node||f.anchorOffset!==G.offset||f.focusNode!==de.node||f.focusOffset!==de.offset)&&(m=m.createRange(),m.setStart(G.node,G.offset),f.removeAllRanges(),Q>D?(f.addRange(m),f.extend(de.node,de.offset)):(m.setEnd(de.node,de.offset),f.addRange(m)))}}for(m=[],f=T;f=f.parentNode;)f.nodeType===1&&m.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<m.length;T++)f=m[T],f.element.scrollLeft=f.left,f.element.scrollTop=f.top}}var Xf=o&&"documentMode"in document&&11>=document.documentMode,kd=null,Gs=null,lu=null,Jf=!1;function X0(f,m,T){var D=T.window===T?T.document:T.nodeType===9?T:T.ownerDocument;Jf||kd==null||kd!==ge(D)||(D=kd,"selectionStart"in D&&Sd(D)?D={start:D.selectionStart,end:D.selectionEnd}:(D=(D.ownerDocument&&D.ownerDocument.defaultView||window).getSelection(),D={anchorNode:D.anchorNode,anchorOffset:D.anchorOffset,focusNode:D.focusNode,focusOffset:D.focusOffset}),lu&&ou(lu,D)||(lu=D,D=ng(Gs,"onSelect"),0<D.length&&(m=new _o("onSelect","select",null,m,T),f.push({event:m,listeners:D}),m.target=kd)))}function Oi(f,m){var T={};return T[f.toLowerCase()]=m.toLowerCase(),T["Webkit"+f]="webkit"+m,T["Moz"+f]="moz"+m,T}var aa={animationend:Oi("Animation","AnimationEnd"),animationiteration:Oi("Animation","AnimationIteration"),animationstart:Oi("Animation","AnimationStart"),transitionend:Oi("Transition","TransitionEnd")},cu={},J0={};o&&(J0=document.createElement("div").style,"AnimationEvent"in window||(delete aa.animationend.animation,delete aa.animationiteration.animation,delete aa.animationstart.animation),"TransitionEvent"in window||delete aa.transitionend.transition);function Cd(f){if(cu[f])return cu[f];if(!aa[f])return f;var m=aa[f],T;for(T in m)if(m.hasOwnProperty(T)&&T in J0)return cu[f]=m[T];return f}var bp=Cd("animationend"),_p=Cd("animationiteration"),Sp=Cd("animationstart"),kp=Cd("transitionend"),Cp=new Map,Tp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ml(f,m){Cp.set(f,m),a(m,[f])}for(var Q0=0;Q0<Tp.length;Q0++){var uu=Tp[Q0],_1=uu.toLowerCase(),Z0=uu[0].toUpperCase()+uu.slice(1);Ml(_1,"on"+Z0)}Ml(bp,"onAnimationEnd"),Ml(_p,"onAnimationIteration"),Ml(Sp,"onAnimationStart"),Ml("dblclick","onDoubleClick"),Ml("focusin","onFocus"),Ml("focusout","onBlur"),Ml(kp,"onTransitionEnd"),i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),S1=new Set("cancel close invalid load scroll toggle".split(" ").concat(vc));function eg(f,m,T){var D=f.type||"unknown-event";f.currentTarget=T,_e(D,m,void 0,f),f.currentTarget=null}function Ep(f,m){m=(m&4)!==0;for(var T=0;T<f.length;T++){var D=f[T],G=D.event;D=D.listeners;e:{var Q=void 0;if(m)for(var de=D.length-1;0<=de;de--){var Pe=D[de],Ie=Pe.instance,gt=Pe.currentTarget;if(Pe=Pe.listener,Ie!==Q&&G.isPropagationStopped())break e;eg(G,Pe,gt),Q=Ie}else for(de=0;de<D.length;de++){if(Pe=D[de],Ie=Pe.instance,gt=Pe.currentTarget,Pe=Pe.listener,Ie!==Q&&G.isPropagationStopped())break e;eg(G,Pe,gt),Q=Ie}}}if(ue)throw f=be,ue=!1,be=null,f}function jn(f,m){var T=m[ag];T===void 0&&(T=m[ag]=new Set);var D=f+"__bubble";T.has(D)||(Np(m,f,2,!1),T.add(D))}function tg(f,m,T){var D=0;m&&(D|=4),Np(T,f,D,m)}var Qf="_reactListening"+Math.random().toString(36).slice(2);function du(f){if(!f[Qf]){f[Qf]=!0,n.forEach(function(T){T!=="selectionchange"&&(S1.has(T)||tg(T,!1,f),tg(T,!0,f))});var m=f.nodeType===9?f:f.ownerDocument;m===null||m[Qf]||(m[Qf]=!0,tg("selectionchange",!1,m))}}function Np(f,m,T,D){switch(d1(m)){case 1:var G=bo;break;case 4:G=Ol;break;default:G=xd}T=G.bind(null,m,T,f),G=void 0,!zt||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(G=!0),D?G!==void 0?f.addEventListener(m,T,{capture:!0,passive:G}):f.addEventListener(m,T,!0):G!==void 0?f.addEventListener(m,T,{passive:G}):f.addEventListener(m,T,!1)}function rg(f,m,T,D,G){var Q=D;if((m&1)===0&&(m&2)===0&&D!==null)e:for(;;){if(D===null)return;var de=D.tag;if(de===3||de===4){var Pe=D.stateNode.containerInfo;if(Pe===G||Pe.nodeType===8&&Pe.parentNode===G)break;if(de===4)for(de=D.return;de!==null;){var Ie=de.tag;if((Ie===3||Ie===4)&&(Ie=de.stateNode.containerInfo,Ie===G||Ie.nodeType===8&&Ie.parentNode===G))return;de=de.return}for(;Pe!==null;){if(de=bc(Pe),de===null)return;if(Ie=de.tag,Ie===5||Ie===6){D=Q=de;continue e}Pe=Pe.parentNode}}D=D.return}Ze(function(){var gt=Q,Bt=nr(T),Ut=[];e:{var Lt=Cp.get(f);if(Lt!==void 0){var sr=_o,dr=f;switch(f){case"keypress":if(tu(T)===0)break e;case"keydown":case"keyup":sr=p1;break;case"focusin":dr="focus",sr=U0;break;case"focusout":dr="blur",sr=U0;break;case"beforeblur":case"afterblur":sr=U0;break;case"click":if(T.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":sr=Rn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":sr=ko;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":sr=G0;break;case bp:case _p:case Sp:sr=dp;break;case kp:sr=vd;break;case"scroll":sr=f1;break;case"wheel":sr=gp;break;case"copy":case"cut":case"paste":sr=z0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":sr=su}var gr=(m&4)!==0,Ms=!gr&&f==="scroll",tt=gr?Lt!==null?Lt+"Capture":null:Lt;gr=[];for(var ze=gt,ot;ze!==null;){ot=ze;var Gt=ot.stateNode;if(ot.tag===5&&Gt!==null&&(ot=Gt,tt!==null&&(Gt=Ft(ze,tt),Gt!=null&&gr.push(Td(ze,Gt,ot)))),Ms)break;ze=ze.return}0<gr.length&&(Lt=new sr(Lt,dr,null,T,Bt),Ut.push({event:Lt,listeners:gr}))}}if((m&7)===0){e:{if(Lt=f==="mouseover"||f==="pointerover",sr=f==="mouseout"||f==="pointerout",Lt&&T!==or&&(dr=T.relatedTarget||T.fromElement)&&(bc(dr)||dr[Yo]))break e;if((sr||Lt)&&(Lt=Bt.window===Bt?Bt:(Lt=Bt.ownerDocument)?Lt.defaultView||Lt.parentWindow:window,sr?(dr=T.relatedTarget||T.toElement,sr=gt,dr=dr?bc(dr):null,dr!==null&&(Ms=Se(dr),dr!==Ms||dr.tag!==5&&dr.tag!==6)&&(dr=null)):(sr=null,dr=gt),sr!==dr)){if(gr=Rn,Gt="onMouseLeave",tt="onMouseEnter",ze="mouse",(f==="pointerout"||f==="pointerover")&&(gr=su,Gt="onPointerLeave",tt="onPointerEnter",ze="pointer"),Ms=sr==null?Lt:Os(sr),ot=dr==null?Lt:Os(dr),Lt=new gr(Gt,ze+"leave",sr,T,Bt),Lt.target=Ms,Lt.relatedTarget=ot,Gt=null,bc(Bt)===gt&&(gr=new gr(tt,ze+"enter",dr,T,Bt),gr.target=ot,gr.relatedTarget=Ms,Gt=gr),Ms=Gt,sr&&dr)t:{for(gr=sr,tt=dr,ze=0,ot=gr;ot;ot=fu(ot))ze++;for(ot=0,Gt=tt;Gt;Gt=fu(Gt))ot++;for(;0<ze-ot;)gr=fu(gr),ze--;for(;0<ot-ze;)tt=fu(tt),ot--;for(;ze--;){if(gr===tt||tt!==null&&gr===tt.alternate)break t;gr=fu(gr),tt=fu(tt)}gr=null}else gr=null;sr!==null&&k1(Ut,Lt,sr,gr,!1),dr!==null&&Ms!==null&&k1(Ut,Ms,dr,gr,!0)}}e:{if(Lt=gt?Os(gt):window,sr=Lt.nodeName&&Lt.nodeName.toLowerCase(),sr==="select"||sr==="input"&&Lt.type==="file")var pr=eo;else if(Il(Lt))if(_d)pr=vp;else{pr=Hn;var kr=yp}else(sr=Lt.nodeName)&&sr.toLowerCase()==="input"&&(Lt.type==="checkbox"||Lt.type==="radio")&&(pr=Y0);if(pr&&(pr=pr(f,gt))){qf(Ut,pr,T,Bt);break e}kr&&kr(f,Lt,gt),f==="focusout"&&(kr=Lt._wrapperState)&&kr.controlled&&Lt.type==="number"&&rt(Lt,"number",Lt.value)}switch(kr=gt?Os(gt):window,f){case"focusin":(Il(kr)||kr.contentEditable==="true")&&(kd=kr,Gs=gt,lu=null);break;case"focusout":lu=Gs=kd=null;break;case"mousedown":Jf=!0;break;case"contextmenu":case"mouseup":case"dragend":Jf=!1,X0(Ut,T,Bt);break;case"selectionchange":if(Xf)break;case"keydown":case"keyup":X0(Ut,T,Bt)}var Cr;if(Kf)e:{switch(f){case"compositionstart":var Rr="onCompositionStart";break e;case"compositionend":Rr="onCompositionEnd";break e;case"compositionupdate":Rr="onCompositionUpdate";break e}Rr=void 0}else Fi?mp(f,T)&&(Rr="onCompositionEnd"):f==="keydown"&&T.keyCode===229&&(Rr="onCompositionStart");Rr&&(Pi&&T.locale!=="ko"&&(Fi||Rr!=="onCompositionStart"?Rr==="onCompositionEnd"&&Fi&&(Cr=Wf()):(na=Bt,hc="value"in na?na.value:na.textContent,Fi=!0)),kr=ng(gt,Rr),0<kr.length&&(Rr=new ru(Rr,f,null,T,Bt),Ut.push({event:Rr,listeners:kr}),Cr?Rr.data=Cr:(Cr=Co(T),Cr!==null&&(Rr.data=Cr)))),(Cr=wd?pp(f,T):w1(f,T))&&(gt=ng(gt,"onBeforeInput"),0<gt.length&&(Bt=new ru("onBeforeInput","beforeinput",null,T,Bt),Ut.push({event:Bt,listeners:gt}),Bt.data=Cr))}Ep(Ut,m)})}function Td(f,m,T){return{instance:f,listener:m,currentTarget:T}}function ng(f,m){for(var T=m+"Capture",D=[];f!==null;){var G=f,Q=G.stateNode;G.tag===5&&Q!==null&&(G=Q,Q=Ft(f,T),Q!=null&&D.unshift(Td(f,Q,G)),Q=Ft(f,m),Q!=null&&D.push(Td(f,Q,G))),f=f.return}return D}function fu(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5);return f||null}function k1(f,m,T,D,G){for(var Q=m._reactName,de=[];T!==null&&T!==D;){var Pe=T,Ie=Pe.alternate,gt=Pe.stateNode;if(Ie!==null&&Ie===D)break;Pe.tag===5&&gt!==null&&(Pe=gt,G?(Ie=Ft(T,Q),Ie!=null&&de.unshift(Td(T,Ie,Pe))):G||(Ie=Ft(T,Q),Ie!=null&&de.push(Td(T,Ie,Pe)))),T=T.return}de.length!==0&&f.push({event:m,listeners:de})}var G2=/\r\n?/g,C1=/\u0000|\uFFFD/g;function Ap(f){return(typeof f=="string"?f:""+f).replace(G2,`
`).replace(C1,"")}function Zf(f,m,T){if(m=Ap(m),Ap(f)!==m&&T)throw Error(r(425))}function hu(){}var jp=null,Pp=null;function Fp(f,m){return f==="textarea"||f==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var Di=typeof setTimeout=="function"?setTimeout:void 0,Op=typeof clearTimeout=="function"?clearTimeout:void 0,eh=typeof Promise=="function"?Promise:void 0,T1=typeof queueMicrotask=="function"?queueMicrotask:typeof eh<"u"?function(f){return eh.resolve(null).then(f).catch(E1)}:Di;function E1(f){setTimeout(function(){throw f})}function sg(f,m){var T=m,D=0;do{var G=T.nextSibling;if(f.removeChild(T),G&&G.nodeType===8)if(T=G.data,T==="/$"){if(D===0){f.removeChild(G),ci(m);return}D--}else T!=="$"&&T!=="$?"&&T!=="$!"||D++;T=G}while(T);ci(m)}function qo(f){for(;f!=null;f=f.nextSibling){var m=f.nodeType;if(m===1||m===3)break;if(m===8){if(m=f.data,m==="$"||m==="$!"||m==="$?")break;if(m==="/$")return null}}return f}function gu(f){f=f.previousSibling;for(var m=0;f;){if(f.nodeType===8){var T=f.data;if(T==="$"||T==="$!"||T==="$?"){if(m===0)return f;m--}else T==="/$"&&m++}f=f.previousSibling}return null}var wc=Math.random().toString(36).slice(2),ro="__reactFiber$"+wc,th="__reactProps$"+wc,Yo="__reactContainer$"+wc,ag="__reactEvents$"+wc,N1="__reactListeners$"+wc,A1="__reactHandles$"+wc;function bc(f){var m=f[ro];if(m)return m;for(var T=f.parentNode;T;){if(m=T[Yo]||T[ro]){if(T=m.alternate,m.child!==null||T!==null&&T.child!==null)for(f=gu(f);f!==null;){if(T=f[ro])return T;f=gu(f)}return m}f=T,T=f.parentNode}return null}function rh(f){return f=f[ro]||f[Yo],!f||f.tag!==5&&f.tag!==6&&f.tag!==13&&f.tag!==3?null:f}function Os(f){if(f.tag===5||f.tag===6)return f.stateNode;throw Error(r(33))}function Vs(f){return f[th]||null}var ig=[],mu=-1;function Ll(f){return{current:f}}function Pn(f){0>mu||(f.current=ig[mu],ig[mu]=null,mu--)}function bn(f,m){mu++,ig[mu]=f.current,f.current=m}var Xo={},ia=Ll(Xo),ya=Ll(!1),_c=Xo;function pu(f,m){var T=f.type.contextTypes;if(!T)return Xo;var D=f.stateNode;if(D&&D.__reactInternalMemoizedUnmaskedChildContext===m)return D.__reactInternalMemoizedMaskedChildContext;var G={},Q;for(Q in T)G[Q]=m[Q];return D&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=m,f.__reactInternalMemoizedMaskedChildContext=G),G}function va(f){return f=f.childContextTypes,f!=null}function Ed(){Pn(ya),Pn(ia)}function Dp(f,m,T){if(ia.current!==Xo)throw Error(r(168));bn(ia,m),bn(ya,T)}function og(f,m,T){var D=f.stateNode;if(m=m.childContextTypes,typeof D.getChildContext!="function")return T;D=D.getChildContext();for(var G in D)if(!(G in m))throw Error(r(108,X(f)||"Unknown",G));return V({},T,D)}function xu(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||Xo,_c=ia.current,bn(ia,f),bn(ya,ya.current),!0}function j1(f,m,T){var D=f.stateNode;if(!D)throw Error(r(169));T?(f=og(f,m,_c),D.__reactInternalMemoizedMergedChildContext=f,Pn(ya),Pn(ia),bn(ia,f)):Pn(ya),bn(ya,T)}var Jo=null,Nd=!1,lg=!1;function nh(f){Jo===null?Jo=[f]:Jo.push(f)}function Bl(f){Nd=!0,nh(f)}function Sc(){if(!lg&&Jo!==null){lg=!0;var f=0,m=Pt;try{var T=Jo;for(Pt=1;f<T.length;f++){var D=T[f];do D=D(!0);while(D!==null)}Jo=null,Nd=!1}catch(G){throw Jo!==null&&(Jo=Jo.slice(f+1)),Te(Ct,Sc),G}finally{Pt=m,lg=!1}}return null}var $a=[],yu=0,kc=null,Cc=0,Ua=[],za=0,Tc=null,Ri=1,Un="";function vu(f,m){$a[yu++]=Cc,$a[yu++]=kc,kc=f,Cc=m}function P1(f,m,T){Ua[za++]=Ri,Ua[za++]=Un,Ua[za++]=Tc,Tc=f;var D=Ri;f=Un;var G=32-he(D)-1;D&=~(1<<G),T+=1;var Q=32-he(m)+G;if(30<Q){var de=G-G%5;Q=(D&(1<<de)-1).toString(32),D>>=de,G-=de,Ri=1<<32-he(m)+G|T<<G|D,Un=Q+f}else Ri=1<<Q|T<<G|D,Un=f}function Ad(f){f.return!==null&&(vu(f,1),P1(f,1,0))}function Ks(f){for(;f===kc;)kc=$a[--yu],$a[yu]=null,Cc=$a[--yu],$a[yu]=null;for(;f===Tc;)Tc=Ua[--za],Ua[za]=null,Un=Ua[--za],Ua[za]=null,Ri=Ua[--za],Ua[za]=null}var Ii=null,Zt=null,pn=!1,Mi=null;function Rp(f,m){var T=sl(5,null,null,0);T.elementType="DELETED",T.stateNode=m,T.return=f,m=f.deletions,m===null?(f.deletions=[T],f.flags|=16):m.push(T)}function F1(f,m){switch(f.tag){case 5:var T=f.type;return m=m.nodeType!==1||T.toLowerCase()!==m.nodeName.toLowerCase()?null:m,m!==null?(f.stateNode=m,Ii=f,Zt=qo(m.firstChild),!0):!1;case 6:return m=f.pendingProps===""||m.nodeType!==3?null:m,m!==null?(f.stateNode=m,Ii=f,Zt=null,!0):!1;case 13:return m=m.nodeType!==8?null:m,m!==null?(T=Tc!==null?{id:Ri,overflow:Un}:null,f.memoizedState={dehydrated:m,treeContext:T,retryLane:1073741824},T=sl(18,null,null,0),T.stateNode=m,T.return=f,f.child=T,Ii=f,Zt=null,!0):!1;default:return!1}}function wu(f){return(f.mode&1)!==0&&(f.flags&128)===0}function jd(f){if(pn){var m=Zt;if(m){var T=m;if(!F1(f,m)){if(wu(f))throw Error(r(418));m=qo(T.nextSibling);var D=Ii;m&&F1(f,m)?Rp(D,T):(f.flags=f.flags&-4097|2,pn=!1,Ii=f)}}else{if(wu(f))throw Error(r(418));f.flags=f.flags&-4097|2,pn=!1,Ii=f}}}function cg(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;Ii=f}function sh(f){if(f!==Ii)return!1;if(!pn)return cg(f),pn=!0,!1;var m;if((m=f.tag!==3)&&!(m=f.tag!==5)&&(m=f.type,m=m!=="head"&&m!=="body"&&!Fp(f.type,f.memoizedProps)),m&&(m=Zt)){if(wu(f))throw Ip(),Error(r(418));for(;m;)Rp(f,m),m=qo(m.nextSibling)}if(cg(f),f.tag===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));e:{for(f=f.nextSibling,m=0;f;){if(f.nodeType===8){var T=f.data;if(T==="/$"){if(m===0){Zt=qo(f.nextSibling);break e}m--}else T!=="$"&&T!=="$!"&&T!=="$?"||m++}f=f.nextSibling}Zt=null}}else Zt=Ii?qo(f.stateNode.nextSibling):null;return!0}function Ip(){for(var f=Zt;f;)f=qo(f.nextSibling)}function bu(){Zt=Ii=null,pn=!1}function ah(f){Mi===null?Mi=[f]:Mi.push(f)}var Mp=N.ReactCurrentBatchConfig;function ls(f,m,T){if(f=T.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(T._owner){if(T=T._owner,T){if(T.tag!==1)throw Error(r(309));var D=T.stateNode}if(!D)throw Error(r(147,f));var G=D,Q=""+f;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===Q?m.ref:(m=function(de){var Pe=G.refs;de===null?delete Pe[Q]:Pe[Q]=de},m._stringRef=Q,m)}if(typeof f!="string")throw Error(r(284));if(!T._owner)throw Error(r(290,f))}return f}function fi(f,m){throw f=Object.prototype.toString.call(m),Error(r(31,f==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":f))}function To(f){var m=f._init;return m(f._payload)}function ug(f){function m(tt,ze){if(f){var ot=tt.deletions;ot===null?(tt.deletions=[ze],tt.flags|=16):ot.push(ze)}}function T(tt,ze){if(!f)return null;for(;ze!==null;)m(tt,ze),ze=ze.sibling;return null}function D(tt,ze){for(tt=new Map;ze!==null;)ze.key!==null?tt.set(ze.key,ze):tt.set(ze.index,ze),ze=ze.sibling;return tt}function G(tt,ze){return tt=Xd(tt,ze),tt.index=0,tt.sibling=null,tt}function Q(tt,ze,ot){return tt.index=ot,f?(ot=tt.alternate,ot!==null?(ot=ot.index,ot<ze?(tt.flags|=2,ze):ot):(tt.flags|=2,ze)):(tt.flags|=1048576,ze)}function de(tt){return f&&tt.alternate===null&&(tt.flags|=2),tt}function Pe(tt,ze,ot,Gt){return ze===null||ze.tag!==6?(ze=fS(ot,tt.mode,Gt),ze.return=tt,ze):(ze=G(ze,ot),ze.return=tt,ze)}function Ie(tt,ze,ot,Gt){var pr=ot.type;return pr===F?Bt(tt,ze,ot.props.children,Gt,ot.key):ze!==null&&(ze.elementType===pr||typeof pr=="object"&&pr!==null&&pr.$$typeof===ne&&To(pr)===ze.type)?(Gt=G(ze,ot.props),Gt.ref=ls(tt,ze,ot),Gt.return=tt,Gt):(Gt=Z1(ot.type,ot.key,ot.props,null,tt.mode,Gt),Gt.ref=ls(tt,ze,ot),Gt.return=tt,Gt)}function gt(tt,ze,ot,Gt){return ze===null||ze.tag!==4||ze.stateNode.containerInfo!==ot.containerInfo||ze.stateNode.implementation!==ot.implementation?(ze=hS(ot,tt.mode,Gt),ze.return=tt,ze):(ze=G(ze,ot.children||[]),ze.return=tt,ze)}function Bt(tt,ze,ot,Gt,pr){return ze===null||ze.tag!==7?(ze=ph(ot,tt.mode,Gt,pr),ze.return=tt,ze):(ze=G(ze,ot),ze.return=tt,ze)}function Ut(tt,ze,ot){if(typeof ze=="string"&&ze!==""||typeof ze=="number")return ze=fS(""+ze,tt.mode,ot),ze.return=tt,ze;if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case E:return ot=Z1(ze.type,ze.key,ze.props,null,tt.mode,ot),ot.ref=ls(tt,null,ze),ot.return=tt,ot;case P:return ze=hS(ze,tt.mode,ot),ze.return=tt,ze;case ne:var Gt=ze._init;return Ut(tt,Gt(ze._payload),ot)}if(wt(ze)||M(ze))return ze=ph(ze,tt.mode,ot,null),ze.return=tt,ze;fi(tt,ze)}return null}function Lt(tt,ze,ot,Gt){var pr=ze!==null?ze.key:null;if(typeof ot=="string"&&ot!==""||typeof ot=="number")return pr!==null?null:Pe(tt,ze,""+ot,Gt);if(typeof ot=="object"&&ot!==null){switch(ot.$$typeof){case E:return ot.key===pr?Ie(tt,ze,ot,Gt):null;case P:return ot.key===pr?gt(tt,ze,ot,Gt):null;case ne:return pr=ot._init,Lt(tt,ze,pr(ot._payload),Gt)}if(wt(ot)||M(ot))return pr!==null?null:Bt(tt,ze,ot,Gt,null);fi(tt,ot)}return null}function sr(tt,ze,ot,Gt,pr){if(typeof Gt=="string"&&Gt!==""||typeof Gt=="number")return tt=tt.get(ot)||null,Pe(ze,tt,""+Gt,pr);if(typeof Gt=="object"&&Gt!==null){switch(Gt.$$typeof){case E:return tt=tt.get(Gt.key===null?ot:Gt.key)||null,Ie(ze,tt,Gt,pr);case P:return tt=tt.get(Gt.key===null?ot:Gt.key)||null,gt(ze,tt,Gt,pr);case ne:var kr=Gt._init;return sr(tt,ze,ot,kr(Gt._payload),pr)}if(wt(Gt)||M(Gt))return tt=tt.get(ot)||null,Bt(ze,tt,Gt,pr,null);fi(ze,Gt)}return null}function dr(tt,ze,ot,Gt){for(var pr=null,kr=null,Cr=ze,Rr=ze=0,Ca=null;Cr!==null&&Rr<ot.length;Rr++){Cr.index>Rr?(Ca=Cr,Cr=null):Ca=Cr.sibling;var fn=Lt(tt,Cr,ot[Rr],Gt);if(fn===null){Cr===null&&(Cr=Ca);break}f&&Cr&&fn.alternate===null&&m(tt,Cr),ze=Q(fn,ze,Rr),kr===null?pr=fn:kr.sibling=fn,kr=fn,Cr=Ca}if(Rr===ot.length)return T(tt,Cr),pn&&vu(tt,Rr),pr;if(Cr===null){for(;Rr<ot.length;Rr++)Cr=Ut(tt,ot[Rr],Gt),Cr!==null&&(ze=Q(Cr,ze,Rr),kr===null?pr=Cr:kr.sibling=Cr,kr=Cr);return pn&&vu(tt,Rr),pr}for(Cr=D(tt,Cr);Rr<ot.length;Rr++)Ca=sr(Cr,tt,Rr,ot[Rr],Gt),Ca!==null&&(f&&Ca.alternate!==null&&Cr.delete(Ca.key===null?Rr:Ca.key),ze=Q(Ca,ze,Rr),kr===null?pr=Ca:kr.sibling=Ca,kr=Ca);return f&&Cr.forEach(function(Jd){return m(tt,Jd)}),pn&&vu(tt,Rr),pr}function gr(tt,ze,ot,Gt){var pr=M(ot);if(typeof pr!="function")throw Error(r(150));if(ot=pr.call(ot),ot==null)throw Error(r(151));for(var kr=pr=null,Cr=ze,Rr=ze=0,Ca=null,fn=ot.next();Cr!==null&&!fn.done;Rr++,fn=ot.next()){Cr.index>Rr?(Ca=Cr,Cr=null):Ca=Cr.sibling;var Jd=Lt(tt,Cr,fn.value,Gt);if(Jd===null){Cr===null&&(Cr=Ca);break}f&&Cr&&Jd.alternate===null&&m(tt,Cr),ze=Q(Jd,ze,Rr),kr===null?pr=Jd:kr.sibling=Jd,kr=Jd,Cr=Ca}if(fn.done)return T(tt,Cr),pn&&vu(tt,Rr),pr;if(Cr===null){for(;!fn.done;Rr++,fn=ot.next())fn=Ut(tt,fn.value,Gt),fn!==null&&(ze=Q(fn,ze,Rr),kr===null?pr=fn:kr.sibling=fn,kr=fn);return pn&&vu(tt,Rr),pr}for(Cr=D(tt,Cr);!fn.done;Rr++,fn=ot.next())fn=sr(Cr,tt,Rr,fn.value,Gt),fn!==null&&(f&&fn.alternate!==null&&Cr.delete(fn.key===null?Rr:fn.key),ze=Q(fn,ze,Rr),kr===null?pr=fn:kr.sibling=fn,kr=fn);return f&&Cr.forEach(function(GV){return m(tt,GV)}),pn&&vu(tt,Rr),pr}function Ms(tt,ze,ot,Gt){if(typeof ot=="object"&&ot!==null&&ot.type===F&&ot.key===null&&(ot=ot.props.children),typeof ot=="object"&&ot!==null){switch(ot.$$typeof){case E:e:{for(var pr=ot.key,kr=ze;kr!==null;){if(kr.key===pr){if(pr=ot.type,pr===F){if(kr.tag===7){T(tt,kr.sibling),ze=G(kr,ot.props.children),ze.return=tt,tt=ze;break e}}else if(kr.elementType===pr||typeof pr=="object"&&pr!==null&&pr.$$typeof===ne&&To(pr)===kr.type){T(tt,kr.sibling),ze=G(kr,ot.props),ze.ref=ls(tt,kr,ot),ze.return=tt,tt=ze;break e}T(tt,kr);break}else m(tt,kr);kr=kr.sibling}ot.type===F?(ze=ph(ot.props.children,tt.mode,Gt,ot.key),ze.return=tt,tt=ze):(Gt=Z1(ot.type,ot.key,ot.props,null,tt.mode,Gt),Gt.ref=ls(tt,ze,ot),Gt.return=tt,tt=Gt)}return de(tt);case P:e:{for(kr=ot.key;ze!==null;){if(ze.key===kr)if(ze.tag===4&&ze.stateNode.containerInfo===ot.containerInfo&&ze.stateNode.implementation===ot.implementation){T(tt,ze.sibling),ze=G(ze,ot.children||[]),ze.return=tt,tt=ze;break e}else{T(tt,ze);break}else m(tt,ze);ze=ze.sibling}ze=hS(ot,tt.mode,Gt),ze.return=tt,tt=ze}return de(tt);case ne:return kr=ot._init,Ms(tt,ze,kr(ot._payload),Gt)}if(wt(ot))return dr(tt,ze,ot,Gt);if(M(ot))return gr(tt,ze,ot,Gt);fi(tt,ot)}return typeof ot=="string"&&ot!==""||typeof ot=="number"?(ot=""+ot,ze!==null&&ze.tag===6?(T(tt,ze.sibling),ze=G(ze,ot),ze.return=tt,tt=ze):(T(tt,ze),ze=fS(ot,tt.mode,Gt),ze.return=tt,tt=ze),de(tt)):T(tt,ze)}return Ms}var _u=ug(!0),no=ug(!1),ih=Ll(null),Li=null,Pd=null,dg=null;function fg(){dg=Pd=Li=null}function hg(f){var m=ih.current;Pn(ih),f._currentValue=m}function gg(f,m,T){for(;f!==null;){var D=f.alternate;if((f.childLanes&m)!==m?(f.childLanes|=m,D!==null&&(D.childLanes|=m)):D!==null&&(D.childLanes&m)!==m&&(D.childLanes|=m),f===T)break;f=f.return}}function $l(f,m){Li=f,dg=Pd=null,f=f.dependencies,f!==null&&f.firstContext!==null&&((f.lanes&m)!==0&&(te=!0),f.firstContext=null)}function Wa(f){var m=f._currentValue;if(dg!==f)if(f={context:f,memoizedValue:m,next:null},Pd===null){if(Li===null)throw Error(r(308));Pd=f,Li.dependencies={lanes:0,firstContext:f}}else Pd=Pd.next=f;return m}var Qo=null;function Fd(f){Qo===null?Qo=[f]:Qo.push(f)}function oh(f,m,T,D){var G=m.interleaved;return G===null?(T.next=T,Fd(m)):(T.next=G.next,G.next=T),m.interleaved=T,Bi(f,D)}function Bi(f,m){f.lanes|=m;var T=f.alternate;for(T!==null&&(T.lanes|=m),T=f,f=f.return;f!==null;)f.childLanes|=m,T=f.alternate,T!==null&&(T.childLanes|=m),T=f,f=f.return;return T.tag===3?T.stateNode:null}var Zo=!1;function lh(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mg(f,m){f=f.updateQueue,m.updateQueue===f&&(m.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function el(f,m){return{eventTime:f,lane:m,tag:0,payload:null,callback:null,next:null}}function tl(f,m,T){var D=f.updateQueue;if(D===null)return null;if(D=D.shared,(ln&2)!==0){var G=D.pending;return G===null?m.next=m:(m.next=G.next,G.next=m),D.pending=m,Bi(f,T)}return G=D.interleaved,G===null?(m.next=m,Fd(D)):(m.next=G.next,G.next=m),D.interleaved=m,Bi(f,T)}function pg(f,m,T){if(m=m.updateQueue,m!==null&&(m=m.shared,(T&4194240)!==0)){var D=m.lanes;D&=f.pendingLanes,T|=D,m.lanes=T,Qt(f,T)}}function ch(f,m){var T=f.updateQueue,D=f.alternate;if(D!==null&&(D=D.updateQueue,T===D)){var G=null,Q=null;if(T=T.firstBaseUpdate,T!==null){do{var de={eventTime:T.eventTime,lane:T.lane,tag:T.tag,payload:T.payload,callback:T.callback,next:null};Q===null?G=Q=de:Q=Q.next=de,T=T.next}while(T!==null);Q===null?G=Q=m:Q=Q.next=m}else G=Q=m;T={baseState:D.baseState,firstBaseUpdate:G,lastBaseUpdate:Q,shared:D.shared,effects:D.effects},f.updateQueue=T;return}f=T.lastBaseUpdate,f===null?T.firstBaseUpdate=m:f.next=m,T.lastBaseUpdate=m}function Od(f,m,T,D){var G=f.updateQueue;Zo=!1;var Q=G.firstBaseUpdate,de=G.lastBaseUpdate,Pe=G.shared.pending;if(Pe!==null){G.shared.pending=null;var Ie=Pe,gt=Ie.next;Ie.next=null,de===null?Q=gt:de.next=gt,de=Ie;var Bt=f.alternate;Bt!==null&&(Bt=Bt.updateQueue,Pe=Bt.lastBaseUpdate,Pe!==de&&(Pe===null?Bt.firstBaseUpdate=gt:Pe.next=gt,Bt.lastBaseUpdate=Ie))}if(Q!==null){var Ut=G.baseState;de=0,Bt=gt=Ie=null,Pe=Q;do{var Lt=Pe.lane,sr=Pe.eventTime;if((D&Lt)===Lt){Bt!==null&&(Bt=Bt.next={eventTime:sr,lane:0,tag:Pe.tag,payload:Pe.payload,callback:Pe.callback,next:null});e:{var dr=f,gr=Pe;switch(Lt=m,sr=T,gr.tag){case 1:if(dr=gr.payload,typeof dr=="function"){Ut=dr.call(sr,Ut,Lt);break e}Ut=dr;break e;case 3:dr.flags=dr.flags&-65537|128;case 0:if(dr=gr.payload,Lt=typeof dr=="function"?dr.call(sr,Ut,Lt):dr,Lt==null)break e;Ut=V({},Ut,Lt);break e;case 2:Zo=!0}}Pe.callback!==null&&Pe.lane!==0&&(f.flags|=64,Lt=G.effects,Lt===null?G.effects=[Pe]:Lt.push(Pe))}else sr={eventTime:sr,lane:Lt,tag:Pe.tag,payload:Pe.payload,callback:Pe.callback,next:null},Bt===null?(gt=Bt=sr,Ie=Ut):Bt=Bt.next=sr,de|=Lt;if(Pe=Pe.next,Pe===null){if(Pe=G.shared.pending,Pe===null)break;Lt=Pe,Pe=Lt.next,Lt.next=null,G.lastBaseUpdate=Lt,G.shared.pending=null}}while(!0);if(Bt===null&&(Ie=Ut),G.baseState=Ie,G.firstBaseUpdate=gt,G.lastBaseUpdate=Bt,m=G.shared.interleaved,m!==null){G=m;do de|=G.lane,G=G.next;while(G!==m)}else Q===null&&(G.shared.lanes=0);fh|=de,f.lanes=de,f.memoizedState=Ut}}function ts(f,m,T){if(f=m.effects,m.effects=null,f!==null)for(m=0;m<f.length;m++){var D=f[m],G=D.callback;if(G!==null){if(D.callback=null,D=T,typeof G!="function")throw Error(r(191,G));G.call(D)}}}var Br={},_n=Ll(Br),zn=Ll(Br),cs=Ll(Br);function Ds(f){if(f===Br)throw Error(r(174));return f}function Ec(f,m){switch(bn(cs,m),bn(zn,f),bn(_n,Br),f=m.nodeType,f){case 9:case 11:m=(m=m.documentElement)?m.namespaceURI:Re(null,"");break;default:f=f===8?m.parentNode:m,m=f.namespaceURI||null,f=f.tagName,m=Re(m,f)}Pn(_n),bn(_n,m)}function Wn(){Pn(_n),Pn(zn),Pn(cs)}function Dd(f){Ds(cs.current);var m=Ds(_n.current),T=Re(m,f.type);m!==T&&(bn(zn,f),bn(_n,T))}function Ul(f){zn.current===f&&(Pn(_n),Pn(zn))}var Fn=Ll(0);function Rd(f){for(var m=f;m!==null;){if(m.tag===13){var T=m.memoizedState;if(T!==null&&(T=T.dehydrated,T===null||T.data==="$?"||T.data==="$!"))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===f)break;for(;m.sibling===null;){if(m.return===null||m.return===f)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var Su=[];function wa(){for(var f=0;f<Su.length;f++)Su[f]._workInProgressVersionPrimary=null;Su.length=0}var Id=N.ReactCurrentDispatcher,uh=N.ReactCurrentBatchConfig,Ha=0,vn=null,rs=null,ps=null,Eo=!1,Nc=!1,so=0,xg=0;function xs(){throw Error(r(321))}function dh(f,m){if(m===null)return!1;for(var T=0;T<m.length&&T<f.length;T++)if(!di(f[T],m[T]))return!1;return!0}function Md(f,m,T,D,G,Q){if(Ha=Q,vn=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,Id.current=f===null||f.memoizedState===null?K2:Pc,f=T(D,G),Nc){Q=0;do{if(Nc=!1,so=0,25<=Q)throw Error(r(301));Q+=1,ps=rs=null,m.updateQueue=null,Id.current=_g,f=T(D,G)}while(Nc)}if(Id.current=Ud,m=rs!==null&&rs.next!==null,Ha=0,ps=rs=vn=null,Eo=!1,m)throw Error(r(300));return f}function Ld(){var f=so!==0;return so=0,f}function In(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ps===null?vn.memoizedState=ps=f:ps=ps.next=f,ps}function Rs(){if(rs===null){var f=vn.alternate;f=f!==null?f.memoizedState:null}else f=rs.next;var m=ps===null?vn.memoizedState:ps.next;if(m!==null)ps=m,rs=f;else{if(f===null)throw Error(r(310));rs=f,f={memoizedState:rs.memoizedState,baseState:rs.baseState,baseQueue:rs.baseQueue,queue:rs.queue,next:null},ps===null?vn.memoizedState=ps=f:ps=ps.next=f}return ps}function ba(f,m){return typeof m=="function"?m(f):m}function _a(f){var m=Rs(),T=m.queue;if(T===null)throw Error(r(311));T.lastRenderedReducer=f;var D=rs,G=D.baseQueue,Q=T.pending;if(Q!==null){if(G!==null){var de=G.next;G.next=Q.next,Q.next=de}D.baseQueue=G=Q,T.pending=null}if(G!==null){Q=G.next,D=D.baseState;var Pe=de=null,Ie=null,gt=Q;do{var Bt=gt.lane;if((Ha&Bt)===Bt)Ie!==null&&(Ie=Ie.next={lane:0,action:gt.action,hasEagerState:gt.hasEagerState,eagerState:gt.eagerState,next:null}),D=gt.hasEagerState?gt.eagerState:f(D,gt.action);else{var Ut={lane:Bt,action:gt.action,hasEagerState:gt.hasEagerState,eagerState:gt.eagerState,next:null};Ie===null?(Pe=Ie=Ut,de=D):Ie=Ie.next=Ut,vn.lanes|=Bt,fh|=Bt}gt=gt.next}while(gt!==null&&gt!==Q);Ie===null?de=D:Ie.next=Pe,di(D,m.memoizedState)||(te=!0),m.memoizedState=D,m.baseState=de,m.baseQueue=Ie,T.lastRenderedState=D}if(f=T.interleaved,f!==null){G=f;do Q=G.lane,vn.lanes|=Q,fh|=Q,G=G.next;while(G!==f)}else G===null&&(T.lanes=0);return[m.memoizedState,T.dispatch]}function yg(f){var m=Rs(),T=m.queue;if(T===null)throw Error(r(311));T.lastRenderedReducer=f;var D=T.dispatch,G=T.pending,Q=m.memoizedState;if(G!==null){T.pending=null;var de=G=G.next;do Q=f(Q,de.action),de=de.next;while(de!==G);di(Q,m.memoizedState)||(te=!0),m.memoizedState=Q,m.baseQueue===null&&(m.baseState=Q),T.lastRenderedState=Q}return[Q,D]}function vg(){}function wg(f,m){var T=vn,D=Rs(),G=m(),Q=!di(D.memoizedState,G);if(Q&&(D.memoizedState=G,te=!0),D=D.queue,Up(Lp.bind(null,T,D,f),[f]),D.getSnapshot!==m||Q||ps!==null&&ps.memoizedState.tag&1){if(T.flags|=2048,Bd(9,zl.bind(null,T,D,G,m),void 0,null),ka===null)throw Error(r(349));(Ha&30)!==0||O1(T,m,G)}return G}function O1(f,m,T){f.flags|=16384,f={getSnapshot:m,value:T},m=vn.updateQueue,m===null?(m={lastEffect:null,stores:null},vn.updateQueue=m,m.stores=[f]):(T=m.stores,T===null?m.stores=[f]:T.push(f))}function zl(f,m,T,D){m.value=T,m.getSnapshot=D,Bp(m)&&bg(f)}function Lp(f,m,T){return T(function(){Bp(m)&&bg(f)})}function Bp(f){var m=f.getSnapshot;f=f.value;try{var T=m();return!di(f,T)}catch{return!0}}function bg(f){var m=Bi(f,1);m!==null&&Vl(m,f,1,-1)}function Ac(f){var m=In();return typeof f=="function"&&(f=f()),m.memoizedState=m.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:f},m.queue=f,f=f.dispatch=B1.bind(null,vn,f),[m.memoizedState,f]}function Bd(f,m,T,D){return f={tag:f,create:m,destroy:T,deps:D,next:null},m=vn.updateQueue,m===null?(m={lastEffect:null,stores:null},vn.updateQueue=m,m.lastEffect=f.next=f):(T=m.lastEffect,T===null?m.lastEffect=f.next=f:(D=T.next,T.next=f,f.next=D,m.lastEffect=f)),f}function $p(){return Rs().memoizedState}function $d(f,m,T,D){var G=In();vn.flags|=f,G.memoizedState=Bd(1|m,T,void 0,D===void 0?null:D)}function ku(f,m,T,D){var G=Rs();D=D===void 0?null:D;var Q=void 0;if(rs!==null){var de=rs.memoizedState;if(Q=de.destroy,D!==null&&dh(D,de.deps)){G.memoizedState=Bd(m,T,Q,D);return}}vn.flags|=f,G.memoizedState=Bd(1|m,T,Q,D)}function D1(f,m){return $d(8390656,8,f,m)}function Up(f,m){return ku(2048,8,f,m)}function zp(f,m){return ku(4,2,f,m)}function Wp(f,m){return ku(4,4,f,m)}function jc(f,m){if(typeof m=="function")return f=f(),m(f),function(){m(null)};if(m!=null)return f=f(),m.current=f,function(){m.current=null}}function R1(f,m,T){return T=T!=null?T.concat([f]):null,ku(4,4,jc.bind(null,m,f),T)}function Wl(){}function Hp(f,m){var T=Rs();m=m===void 0?null:m;var D=T.memoizedState;return D!==null&&m!==null&&dh(m,D[1])?D[0]:(T.memoizedState=[f,m],f)}function Mn(f,m){var T=Rs();m=m===void 0?null:m;var D=T.memoizedState;return D!==null&&m!==null&&dh(m,D[1])?D[0]:(f=f(),T.memoizedState=[f,m],f)}function I1(f,m,T){return(Ha&21)===0?(f.baseState&&(f.baseState=!1,te=!0),f.memoizedState=T):(di(T,m)||(T=Nt(),vn.lanes|=T,fh|=T,f.baseState=!0),m)}function M1(f,m){var T=Pt;Pt=T!==0&&4>T?T:4,f(!0);var D=uh.transition;uh.transition={};try{f(!1),m()}finally{Pt=T,uh.transition=D}}function L1(){return Rs().memoizedState}function V2(f,m,T){var D=qd(f);if(T={lane:D,action:T,hasEagerState:!1,eagerState:null,next:null},Gp(f))$1(m,T);else if(T=oh(f,m,T,D),T!==null){var G=Ui();Vl(T,f,D,G),$i(T,m,D)}}function B1(f,m,T){var D=qd(f),G={lane:D,action:T,hasEagerState:!1,eagerState:null,next:null};if(Gp(f))$1(m,G);else{var Q=f.alternate;if(f.lanes===0&&(Q===null||Q.lanes===0)&&(Q=m.lastRenderedReducer,Q!==null))try{var de=m.lastRenderedState,Pe=Q(de,T);if(G.hasEagerState=!0,G.eagerState=Pe,di(Pe,de)){var Ie=m.interleaved;Ie===null?(G.next=G,Fd(m)):(G.next=Ie.next,Ie.next=G),m.interleaved=G;return}}catch{}finally{}T=oh(f,m,G,D),T!==null&&(G=Ui(),Vl(T,f,D,G),$i(T,m,D))}}function Gp(f){var m=f.alternate;return f===vn||m!==null&&m===vn}function $1(f,m){Nc=Eo=!0;var T=f.pending;T===null?m.next=m:(m.next=T.next,T.next=m),f.pending=m}function $i(f,m,T){if((T&4194240)!==0){var D=m.lanes;D&=f.pendingLanes,T|=D,m.lanes=T,Qt(f,T)}}var Ud={readContext:Wa,useCallback:xs,useContext:xs,useEffect:xs,useImperativeHandle:xs,useInsertionEffect:xs,useLayoutEffect:xs,useMemo:xs,useReducer:xs,useRef:xs,useState:xs,useDebugValue:xs,useDeferredValue:xs,useTransition:xs,useMutableSource:xs,useSyncExternalStore:xs,useId:xs,unstable_isNewReconciler:!1},K2={readContext:Wa,useCallback:function(f,m){return In().memoizedState=[f,m===void 0?null:m],f},useContext:Wa,useEffect:D1,useImperativeHandle:function(f,m,T){return T=T!=null?T.concat([f]):null,$d(4194308,4,jc.bind(null,m,f),T)},useLayoutEffect:function(f,m){return $d(4194308,4,f,m)},useInsertionEffect:function(f,m){return $d(4,2,f,m)},useMemo:function(f,m){var T=In();return m=m===void 0?null:m,f=f(),T.memoizedState=[f,m],f},useReducer:function(f,m,T){var D=In();return m=T!==void 0?T(m):m,D.memoizedState=D.baseState=m,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:m},D.queue=f,f=f.dispatch=V2.bind(null,vn,f),[D.memoizedState,f]},useRef:function(f){var m=In();return f={current:f},m.memoizedState=f},useState:Ac,useDebugValue:Wl,useDeferredValue:function(f){return In().memoizedState=f},useTransition:function(){var f=Ac(!1),m=f[0];return f=M1.bind(null,f[1]),In().memoizedState=f,[m,f]},useMutableSource:function(){},useSyncExternalStore:function(f,m,T){var D=vn,G=In();if(pn){if(T===void 0)throw Error(r(407));T=T()}else{if(T=m(),ka===null)throw Error(r(349));(Ha&30)!==0||O1(D,m,T)}G.memoizedState=T;var Q={value:T,getSnapshot:m};return G.queue=Q,D1(Lp.bind(null,D,Q,f),[f]),D.flags|=2048,Bd(9,zl.bind(null,D,Q,T,m),void 0,null),T},useId:function(){var f=In(),m=ka.identifierPrefix;if(pn){var T=Un,D=Ri;T=(D&~(1<<32-he(D)-1)).toString(32)+T,m=":"+m+"R"+T,T=so++,0<T&&(m+="H"+T.toString(32)),m+=":"}else T=xg++,m=":"+m+"r"+T.toString(32)+":";return f.memoizedState=m},unstable_isNewReconciler:!1},Pc={readContext:Wa,useCallback:Hp,useContext:Wa,useEffect:Up,useImperativeHandle:R1,useInsertionEffect:zp,useLayoutEffect:Wp,useMemo:Mn,useReducer:_a,useRef:$p,useState:function(){return _a(ba)},useDebugValue:Wl,useDeferredValue:function(f){var m=Rs();return I1(m,rs.memoizedState,f)},useTransition:function(){var f=_a(ba)[0],m=Rs().memoizedState;return[f,m]},useMutableSource:vg,useSyncExternalStore:wg,useId:L1,unstable_isNewReconciler:!1},_g={readContext:Wa,useCallback:Hp,useContext:Wa,useEffect:Up,useImperativeHandle:R1,useInsertionEffect:zp,useLayoutEffect:Wp,useMemo:Mn,useReducer:yg,useRef:$p,useState:function(){return yg(ba)},useDebugValue:Wl,useDeferredValue:function(f){var m=Rs();return rs===null?m.memoizedState=f:I1(m,rs.memoizedState,f)},useTransition:function(){var f=yg(ba)[0],m=Rs().memoizedState;return[f,m]},useMutableSource:vg,useSyncExternalStore:wg,useId:L1,unstable_isNewReconciler:!1};function oa(f,m){if(f&&f.defaultProps){m=V({},m),f=f.defaultProps;for(var T in f)m[T]===void 0&&(m[T]=f[T]);return m}return m}function zd(f,m,T,D){m=f.memoizedState,T=T(D,m),T=T==null?m:V({},m,T),f.memoizedState=T,f.lanes===0&&(f.updateQueue.baseState=T)}var Wd={isMounted:function(f){return(f=f._reactInternals)?Se(f)===f:!1},enqueueSetState:function(f,m,T){f=f._reactInternals;var D=Ui(),G=qd(f),Q=el(D,G);Q.payload=m,T!=null&&(Q.callback=T),m=tl(f,Q,G),m!==null&&(Vl(m,f,G,D),pg(m,f,G))},enqueueReplaceState:function(f,m,T){f=f._reactInternals;var D=Ui(),G=qd(f),Q=el(D,G);Q.tag=1,Q.payload=m,T!=null&&(Q.callback=T),m=tl(f,Q,G),m!==null&&(Vl(m,f,G,D),pg(m,f,G))},enqueueForceUpdate:function(f,m){f=f._reactInternals;var T=Ui(),D=qd(f),G=el(T,D);G.tag=2,m!=null&&(G.callback=m),m=tl(f,G,D),m!==null&&(Vl(m,f,D,T),pg(m,f,D))}};function Sg(f,m,T,D,G,Q,de){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(D,Q,de):m.prototype&&m.prototype.isPureReactComponent?!ou(T,D)||!ou(G,Q):!0}function U1(f,m,T){var D=!1,G=Xo,Q=m.contextType;return typeof Q=="object"&&Q!==null?Q=Wa(Q):(G=va(m)?_c:ia.current,D=m.contextTypes,Q=(D=D!=null)?pu(f,G):Xo),m=new m(T,Q),f.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Wd,f.stateNode=m,m._reactInternals=f,D&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=G,f.__reactInternalMemoizedMaskedChildContext=Q),m}function Vp(f,m,T,D){f=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(T,D),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(T,D),m.state!==f&&Wd.enqueueReplaceState(m,m.state,null)}function kg(f,m,T,D){var G=f.stateNode;G.props=T,G.state=f.memoizedState,G.refs={},lh(f);var Q=m.contextType;typeof Q=="object"&&Q!==null?G.context=Wa(Q):(Q=va(m)?_c:ia.current,G.context=pu(f,Q)),G.state=f.memoizedState,Q=m.getDerivedStateFromProps,typeof Q=="function"&&(zd(f,m,Q,T),G.state=f.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof G.getSnapshotBeforeUpdate=="function"||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(m=G.state,typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount(),m!==G.state&&Wd.enqueueReplaceState(G,G.state,null),Od(f,T,G,D),G.state=f.memoizedState),typeof G.componentDidMount=="function"&&(f.flags|=4194308)}function Cu(f,m){try{var T="",D=m;do T+=J(D),D=D.return;while(D);var G=T}catch(Q){G=`
Error generating stack: `+Q.message+`
`+Q.stack}return{value:f,source:m,stack:G,digest:null}}function Cg(f,m,T){return{value:f,source:null,stack:T??null,digest:m??null}}function Hd(f,m){try{console.error(m.value)}catch(T){setTimeout(function(){throw T})}}var q2=typeof WeakMap=="function"?WeakMap:Map;function z1(f,m,T){T=el(-1,T),T.tag=3,T.payload={element:null};var D=m.value;return T.callback=function(){K1||(K1=!0,sS=D),Hd(f,m)},T}function y(f,m,T){T=el(-1,T),T.tag=3;var D=f.type.getDerivedStateFromError;if(typeof D=="function"){var G=m.value;T.payload=function(){return D(G)},T.callback=function(){Hd(f,m)}}var Q=f.stateNode;return Q!==null&&typeof Q.componentDidCatch=="function"&&(T.callback=function(){Hd(f,m),typeof D!="function"&&(Vd===null?Vd=new Set([this]):Vd.add(this));var de=m.stack;this.componentDidCatch(m.value,{componentStack:de!==null?de:""})}),T}function b(f,m,T){var D=f.pingCache;if(D===null){D=f.pingCache=new q2;var G=new Set;D.set(m,G)}else G=D.get(m),G===void 0&&(G=new Set,D.set(m,G));G.has(T)||(G.add(T),f=DV.bind(null,f,m,T),m.then(f,f))}function O(f){do{var m;if((m=f.tag===13)&&(m=f.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return f;f=f.return}while(f!==null);return null}function z(f,m,T,D,G){return(f.mode&1)===0?(f===m?f.flags|=65536:(f.flags|=128,T.flags|=131072,T.flags&=-52805,T.tag===1&&(T.alternate===null?T.tag=17:(m=el(-1,1),m.tag=2,tl(T,m,1))),T.lanes|=1),f):(f.flags|=65536,f.lanes=G,f)}var K=N.ReactCurrentOwner,te=!1;function ve(f,m,T,D){m.child=f===null?no(m,null,T,D):_u(m,f.child,T,D)}function Ge(f,m,T,D,G){T=T.render;var Q=m.ref;return $l(m,G),D=Md(f,m,T,D,Q,G),T=Ld(),f!==null&&!te?(m.updateQueue=f.updateQueue,m.flags&=-2053,f.lanes&=~G,Sa(f,m,G)):(pn&&T&&Ad(m),m.flags|=1,ve(f,m,D,G),m.child)}function mt(f,m,T,D,G){if(f===null){var Q=T.type;return typeof Q=="function"&&!dS(Q)&&Q.defaultProps===void 0&&T.compare===null&&T.defaultProps===void 0?(m.tag=15,m.type=Q,Wt(f,m,Q,D,G)):(f=Z1(T.type,null,D,m,m.mode,G),f.ref=m.ref,f.return=m,m.child=f)}if(Q=f.child,(f.lanes&G)===0){var de=Q.memoizedProps;if(T=T.compare,T=T!==null?T:ou,T(de,D)&&f.ref===m.ref)return Sa(f,m,G)}return m.flags|=1,f=Xd(Q,D),f.ref=m.ref,f.return=m,m.child=f}function Wt(f,m,T,D,G){if(f!==null){var Q=f.memoizedProps;if(ou(Q,D)&&f.ref===m.ref)if(te=!1,m.pendingProps=D=Q,(f.lanes&G)!==0)(f.flags&131072)!==0&&(te=!0);else return m.lanes=f.lanes,Sa(f,m,G)}return tr(f,m,T,D,G)}function lr(f,m,T){var D=m.pendingProps,G=D.children,Q=f!==null?f.memoizedState:null;if(D.mode==="hidden")if((m.mode&1)===0)m.memoizedState={baseLanes:0,cachePool:null,transitions:null},bn(Eg,No),No|=T;else{if((T&1073741824)===0)return f=Q!==null?Q.baseLanes|T:T,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:f,cachePool:null,transitions:null},m.updateQueue=null,bn(Eg,No),No|=f,null;m.memoizedState={baseLanes:0,cachePool:null,transitions:null},D=Q!==null?Q.baseLanes:T,bn(Eg,No),No|=D}else Q!==null?(D=Q.baseLanes|T,m.memoizedState=null):D=T,bn(Eg,No),No|=D;return ve(f,m,G,T),m.child}function Mr(f,m){var T=m.ref;(f===null&&T!==null||f!==null&&f.ref!==T)&&(m.flags|=512,m.flags|=2097152)}function tr(f,m,T,D,G){var Q=va(T)?_c:ia.current;return Q=pu(m,Q),$l(m,G),T=Md(f,m,T,D,Q,G),D=Ld(),f!==null&&!te?(m.updateQueue=f.updateQueue,m.flags&=-2053,f.lanes&=~G,Sa(f,m,G)):(pn&&D&&Ad(m),m.flags|=1,ve(f,m,T,G),m.child)}function On(f,m,T,D,G){if(va(T)){var Q=!0;xu(m)}else Q=!1;if($l(m,G),m.stateNode===null)tn(f,m),U1(m,T,D),kg(m,T,D,G),D=!0;else if(f===null){var de=m.stateNode,Pe=m.memoizedProps;de.props=Pe;var Ie=de.context,gt=T.contextType;typeof gt=="object"&&gt!==null?gt=Wa(gt):(gt=va(T)?_c:ia.current,gt=pu(m,gt));var Bt=T.getDerivedStateFromProps,Ut=typeof Bt=="function"||typeof de.getSnapshotBeforeUpdate=="function";Ut||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(Pe!==D||Ie!==gt)&&Vp(m,de,D,gt),Zo=!1;var Lt=m.memoizedState;de.state=Lt,Od(m,D,de,G),Ie=m.memoizedState,Pe!==D||Lt!==Ie||ya.current||Zo?(typeof Bt=="function"&&(zd(m,T,Bt,D),Ie=m.memoizedState),(Pe=Zo||Sg(m,T,Pe,D,Lt,Ie,gt))?(Ut||typeof de.UNSAFE_componentWillMount!="function"&&typeof de.componentWillMount!="function"||(typeof de.componentWillMount=="function"&&de.componentWillMount(),typeof de.UNSAFE_componentWillMount=="function"&&de.UNSAFE_componentWillMount()),typeof de.componentDidMount=="function"&&(m.flags|=4194308)):(typeof de.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=D,m.memoizedState=Ie),de.props=D,de.state=Ie,de.context=gt,D=Pe):(typeof de.componentDidMount=="function"&&(m.flags|=4194308),D=!1)}else{de=m.stateNode,mg(f,m),Pe=m.memoizedProps,gt=m.type===m.elementType?Pe:oa(m.type,Pe),de.props=gt,Ut=m.pendingProps,Lt=de.context,Ie=T.contextType,typeof Ie=="object"&&Ie!==null?Ie=Wa(Ie):(Ie=va(T)?_c:ia.current,Ie=pu(m,Ie));var sr=T.getDerivedStateFromProps;(Bt=typeof sr=="function"||typeof de.getSnapshotBeforeUpdate=="function")||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(Pe!==Ut||Lt!==Ie)&&Vp(m,de,D,Ie),Zo=!1,Lt=m.memoizedState,de.state=Lt,Od(m,D,de,G);var dr=m.memoizedState;Pe!==Ut||Lt!==dr||ya.current||Zo?(typeof sr=="function"&&(zd(m,T,sr,D),dr=m.memoizedState),(gt=Zo||Sg(m,T,gt,D,Lt,dr,Ie)||!1)?(Bt||typeof de.UNSAFE_componentWillUpdate!="function"&&typeof de.componentWillUpdate!="function"||(typeof de.componentWillUpdate=="function"&&de.componentWillUpdate(D,dr,Ie),typeof de.UNSAFE_componentWillUpdate=="function"&&de.UNSAFE_componentWillUpdate(D,dr,Ie)),typeof de.componentDidUpdate=="function"&&(m.flags|=4),typeof de.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof de.componentDidUpdate!="function"||Pe===f.memoizedProps&&Lt===f.memoizedState||(m.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||Pe===f.memoizedProps&&Lt===f.memoizedState||(m.flags|=1024),m.memoizedProps=D,m.memoizedState=dr),de.props=D,de.state=dr,de.context=Ie,D=gt):(typeof de.componentDidUpdate!="function"||Pe===f.memoizedProps&&Lt===f.memoizedState||(m.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||Pe===f.memoizedProps&&Lt===f.memoizedState||(m.flags|=1024),D=!1)}return xn(f,m,T,D,Q,G)}function xn(f,m,T,D,G,Q){Mr(f,m);var de=(m.flags&128)!==0;if(!D&&!de)return G&&j1(m,T,!1),Sa(f,m,Q);D=m.stateNode,K.current=m;var Pe=de&&typeof T.getDerivedStateFromError!="function"?null:D.render();return m.flags|=1,f!==null&&de?(m.child=_u(m,f.child,null,Q),m.child=_u(m,null,Pe,Q)):ve(f,m,Pe,Q),m.memoizedState=D.state,G&&j1(m,T,!0),m.child}function Ga(f){var m=f.stateNode;m.pendingContext?Dp(f,m.pendingContext,m.pendingContext!==m.context):m.context&&Dp(f,m.context,!1),Ec(f,m.containerInfo)}function rl(f,m,T,D,G){return bu(),ah(G),m.flags|=256,ve(f,m,T,D),m.child}var dt={dehydrated:null,treeContext:null,retryLane:0};function qe(f){return{baseLanes:f,cachePool:null,transitions:null}}function yt(f,m,T){var D=m.pendingProps,G=Fn.current,Q=!1,de=(m.flags&128)!==0,Pe;if((Pe=de)||(Pe=f!==null&&f.memoizedState===null?!1:(G&2)!==0),Pe?(Q=!0,m.flags&=-129):(f===null||f.memoizedState!==null)&&(G|=1),bn(Fn,G&1),f===null)return jd(m),f=m.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?((m.mode&1)===0?m.lanes=1:f.data==="$!"?m.lanes=8:m.lanes=1073741824,null):(de=D.children,f=D.fallback,Q?(D=m.mode,Q=m.child,de={mode:"hidden",children:de},(D&1)===0&&Q!==null?(Q.childLanes=0,Q.pendingProps=de):Q=ew(de,D,0,null),f=ph(f,D,T,null),Q.return=m,f.return=m,Q.sibling=f,m.child=Q,m.child.memoizedState=qe(T),m.memoizedState=dt,f):rr(m,de));if(G=f.memoizedState,G!==null&&(Pe=G.dehydrated,Pe!==null))return Gr(f,m,de,D,Pe,G,T);if(Q){Q=D.fallback,de=m.mode,G=f.child,Pe=G.sibling;var Ie={mode:"hidden",children:D.children};return(de&1)===0&&m.child!==G?(D=m.child,D.childLanes=0,D.pendingProps=Ie,m.deletions=null):(D=Xd(G,Ie),D.subtreeFlags=G.subtreeFlags&14680064),Pe!==null?Q=Xd(Pe,Q):(Q=ph(Q,de,T,null),Q.flags|=2),Q.return=m,D.return=m,D.sibling=Q,m.child=D,D=Q,Q=m.child,de=f.child.memoizedState,de=de===null?qe(T):{baseLanes:de.baseLanes|T,cachePool:null,transitions:de.transitions},Q.memoizedState=de,Q.childLanes=f.childLanes&~T,m.memoizedState=dt,D}return Q=f.child,f=Q.sibling,D=Xd(Q,{mode:"visible",children:D.children}),(m.mode&1)===0&&(D.lanes=T),D.return=m,D.sibling=null,f!==null&&(T=m.deletions,T===null?(m.deletions=[f],m.flags|=16):T.push(f)),m.child=D,m.memoizedState=null,D}function rr(f,m){return m=ew({mode:"visible",children:m},f.mode,0,null),m.return=f,f.child=m}function _r(f,m,T,D){return D!==null&&ah(D),_u(m,f.child,null,T),f=rr(m,m.pendingProps.children),f.flags|=2,m.memoizedState=null,f}function Gr(f,m,T,D,G,Q,de){if(T)return m.flags&256?(m.flags&=-257,D=Cg(Error(r(422))),_r(f,m,de,D)):m.memoizedState!==null?(m.child=f.child,m.flags|=128,null):(Q=D.fallback,G=m.mode,D=ew({mode:"visible",children:D.children},G,0,null),Q=ph(Q,G,de,null),Q.flags|=2,D.return=m,Q.return=m,D.sibling=Q,m.child=D,(m.mode&1)!==0&&_u(m,f.child,null,de),m.child.memoizedState=qe(de),m.memoizedState=dt,Q);if((m.mode&1)===0)return _r(f,m,de,null);if(G.data==="$!"){if(D=G.nextSibling&&G.nextSibling.dataset,D)var Pe=D.dgst;return D=Pe,Q=Error(r(419)),D=Cg(Q,D,void 0),_r(f,m,de,D)}if(Pe=(de&f.childLanes)!==0,te||Pe){if(D=ka,D!==null){switch(de&-de){case 4:G=2;break;case 16:G=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:G=32;break;case 536870912:G=268435456;break;default:G=0}G=(G&(D.suspendedLanes|de))!==0?0:G,G!==0&&G!==Q.retryLane&&(Q.retryLane=G,Bi(f,G),Vl(D,f,G,-1))}return uS(),D=Cg(Error(r(421))),_r(f,m,de,D)}return G.data==="$?"?(m.flags|=128,m.child=f.child,m=RV.bind(null,f),G._reactRetry=m,null):(f=Q.treeContext,Zt=qo(G.nextSibling),Ii=m,pn=!0,Mi=null,f!==null&&(Ua[za++]=Ri,Ua[za++]=Un,Ua[za++]=Tc,Ri=f.id,Un=f.overflow,Tc=m),m=rr(m,D.children),m.flags|=4096,m)}function Lr(f,m,T){f.lanes|=m;var D=f.alternate;D!==null&&(D.lanes|=m),gg(f.return,m,T)}function nn(f,m,T,D,G){var Q=f.memoizedState;Q===null?f.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:D,tail:T,tailMode:G}:(Q.isBackwards=m,Q.rendering=null,Q.renderingStartTime=0,Q.last=D,Q.tail=T,Q.tailMode=G)}function Is(f,m,T){var D=m.pendingProps,G=D.revealOrder,Q=D.tail;if(ve(f,m,D.children,T),D=Fn.current,(D&2)!==0)D=D&1|2,m.flags|=128;else{if(f!==null&&(f.flags&128)!==0)e:for(f=m.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&Lr(f,T,m);else if(f.tag===19)Lr(f,T,m);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===m)break e;for(;f.sibling===null;){if(f.return===null||f.return===m)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}D&=1}if(bn(Fn,D),(m.mode&1)===0)m.memoizedState=null;else switch(G){case"forwards":for(T=m.child,G=null;T!==null;)f=T.alternate,f!==null&&Rd(f)===null&&(G=T),T=T.sibling;T=G,T===null?(G=m.child,m.child=null):(G=T.sibling,T.sibling=null),nn(m,!1,G,T,Q);break;case"backwards":for(T=null,G=m.child,m.child=null;G!==null;){if(f=G.alternate,f!==null&&Rd(f)===null){m.child=G;break}f=G.sibling,G.sibling=T,T=G,G=f}nn(m,!0,T,null,Q);break;case"together":nn(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function tn(f,m){(m.mode&1)===0&&f!==null&&(f.alternate=null,m.alternate=null,m.flags|=2)}function Sa(f,m,T){if(f!==null&&(m.dependencies=f.dependencies),fh|=m.lanes,(T&m.childLanes)===0)return null;if(f!==null&&m.child!==f.child)throw Error(r(153));if(m.child!==null){for(f=m.child,T=Xd(f,f.pendingProps),m.child=T,T.return=m;f.sibling!==null;)f=f.sibling,T=T.sibling=Xd(f,f.pendingProps),T.return=m;T.sibling=null}return m.child}function Y2(f,m,T){switch(m.tag){case 3:Ga(m),bu();break;case 5:Dd(m);break;case 1:va(m.type)&&xu(m);break;case 4:Ec(m,m.stateNode.containerInfo);break;case 10:var D=m.type._context,G=m.memoizedProps.value;bn(ih,D._currentValue),D._currentValue=G;break;case 13:if(D=m.memoizedState,D!==null)return D.dehydrated!==null?(bn(Fn,Fn.current&1),m.flags|=128,null):(T&m.child.childLanes)!==0?yt(f,m,T):(bn(Fn,Fn.current&1),f=Sa(f,m,T),f!==null?f.sibling:null);bn(Fn,Fn.current&1);break;case 19:if(D=(T&m.childLanes)!==0,(f.flags&128)!==0){if(D)return Is(f,m,T);m.flags|=128}if(G=m.memoizedState,G!==null&&(G.rendering=null,G.tail=null,G.lastEffect=null),bn(Fn,Fn.current),D)break;return null;case 22:case 23:return m.lanes=0,lr(f,m,T)}return Sa(f,m,T)}var aj,X2,ij,oj;aj=function(f,m){for(var T=m.child;T!==null;){if(T.tag===5||T.tag===6)f.appendChild(T.stateNode);else if(T.tag!==4&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===m)break;for(;T.sibling===null;){if(T.return===null||T.return===m)return;T=T.return}T.sibling.return=T.return,T=T.sibling}},X2=function(){},ij=function(f,m,T,D){var G=f.memoizedProps;if(G!==D){f=m.stateNode,Ds(_n.current);var Q=null;switch(T){case"input":G=Ne(f,G),D=Ne(f,D),Q=[];break;case"select":G=V({},G,{value:void 0}),D=V({},D,{value:void 0}),Q=[];break;case"textarea":G=lt(f,G),D=lt(f,D),Q=[];break;default:typeof G.onClick!="function"&&typeof D.onClick=="function"&&(f.onclick=hu)}Dr(T,D);var de;T=null;for(gt in G)if(!D.hasOwnProperty(gt)&&G.hasOwnProperty(gt)&&G[gt]!=null)if(gt==="style"){var Pe=G[gt];for(de in Pe)Pe.hasOwnProperty(de)&&(T||(T={}),T[de]="")}else gt!=="dangerouslySetInnerHTML"&&gt!=="children"&&gt!=="suppressContentEditableWarning"&&gt!=="suppressHydrationWarning"&&gt!=="autoFocus"&&(s.hasOwnProperty(gt)?Q||(Q=[]):(Q=Q||[]).push(gt,null));for(gt in D){var Ie=D[gt];if(Pe=G?.[gt],D.hasOwnProperty(gt)&&Ie!==Pe&&(Ie!=null||Pe!=null))if(gt==="style")if(Pe){for(de in Pe)!Pe.hasOwnProperty(de)||Ie&&Ie.hasOwnProperty(de)||(T||(T={}),T[de]="");for(de in Ie)Ie.hasOwnProperty(de)&&Pe[de]!==Ie[de]&&(T||(T={}),T[de]=Ie[de])}else T||(Q||(Q=[]),Q.push(gt,T)),T=Ie;else gt==="dangerouslySetInnerHTML"?(Ie=Ie?Ie.__html:void 0,Pe=Pe?Pe.__html:void 0,Ie!=null&&Pe!==Ie&&(Q=Q||[]).push(gt,Ie)):gt==="children"?typeof Ie!="string"&&typeof Ie!="number"||(Q=Q||[]).push(gt,""+Ie):gt!=="suppressContentEditableWarning"&&gt!=="suppressHydrationWarning"&&(s.hasOwnProperty(gt)?(Ie!=null&&gt==="onScroll"&&jn("scroll",f),Q||Pe===Ie||(Q=[])):(Q=Q||[]).push(gt,Ie))}T&&(Q=Q||[]).push("style",T);var gt=Q;(m.updateQueue=gt)&&(m.flags|=4)}},oj=function(f,m,T,D){T!==D&&(m.flags|=4)};function Kp(f,m){if(!pn)switch(f.tailMode){case"hidden":m=f.tail;for(var T=null;m!==null;)m.alternate!==null&&(T=m),m=m.sibling;T===null?f.tail=null:T.sibling=null;break;case"collapsed":T=f.tail;for(var D=null;T!==null;)T.alternate!==null&&(D=T),T=T.sibling;D===null?m||f.tail===null?f.tail=null:f.tail.sibling=null:D.sibling=null}}function hi(f){var m=f.alternate!==null&&f.alternate.child===f.child,T=0,D=0;if(m)for(var G=f.child;G!==null;)T|=G.lanes|G.childLanes,D|=G.subtreeFlags&14680064,D|=G.flags&14680064,G.return=f,G=G.sibling;else for(G=f.child;G!==null;)T|=G.lanes|G.childLanes,D|=G.subtreeFlags,D|=G.flags,G.return=f,G=G.sibling;return f.subtreeFlags|=D,f.childLanes=T,m}function kV(f,m,T){var D=m.pendingProps;switch(Ks(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hi(m),null;case 1:return va(m.type)&&Ed(),hi(m),null;case 3:return D=m.stateNode,Wn(),Pn(ya),Pn(ia),wa(),D.pendingContext&&(D.context=D.pendingContext,D.pendingContext=null),(f===null||f.child===null)&&(sh(m)?m.flags|=4:f===null||f.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,Mi!==null&&(oS(Mi),Mi=null))),X2(f,m),hi(m),null;case 5:Ul(m);var G=Ds(cs.current);if(T=m.type,f!==null&&m.stateNode!=null)ij(f,m,T,D,G),f.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!D){if(m.stateNode===null)throw Error(r(166));return hi(m),null}if(f=Ds(_n.current),sh(m)){D=m.stateNode,T=m.type;var Q=m.memoizedProps;switch(D[ro]=m,D[th]=Q,f=(m.mode&1)!==0,T){case"dialog":jn("cancel",D),jn("close",D);break;case"iframe":case"object":case"embed":jn("load",D);break;case"video":case"audio":for(G=0;G<vc.length;G++)jn(vc[G],D);break;case"source":jn("error",D);break;case"img":case"image":case"link":jn("error",D),jn("load",D);break;case"details":jn("toggle",D);break;case"input":je(D,Q),jn("invalid",D);break;case"select":D._wrapperState={wasMultiple:!!Q.multiple},jn("invalid",D);break;case"textarea":pt(D,Q),jn("invalid",D)}Dr(T,Q),G=null;for(var de in Q)if(Q.hasOwnProperty(de)){var Pe=Q[de];de==="children"?typeof Pe=="string"?D.textContent!==Pe&&(Q.suppressHydrationWarning!==!0&&Zf(D.textContent,Pe,f),G=["children",Pe]):typeof Pe=="number"&&D.textContent!==""+Pe&&(Q.suppressHydrationWarning!==!0&&Zf(D.textContent,Pe,f),G=["children",""+Pe]):s.hasOwnProperty(de)&&Pe!=null&&de==="onScroll"&&jn("scroll",D)}switch(T){case"input":ke(D),It(D,Q,!0);break;case"textarea":ke(D),Mt(D);break;case"select":case"option":break;default:typeof Q.onClick=="function"&&(D.onclick=hu)}D=G,m.updateQueue=D,D!==null&&(m.flags|=4)}else{de=G.nodeType===9?G:G.ownerDocument,f==="http://www.w3.org/1999/xhtml"&&(f=Qe(T)),f==="http://www.w3.org/1999/xhtml"?T==="script"?(f=de.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild)):typeof D.is=="string"?f=de.createElement(T,{is:D.is}):(f=de.createElement(T),T==="select"&&(de=f,D.multiple?de.multiple=!0:D.size&&(de.size=D.size))):f=de.createElementNS(f,T),f[ro]=m,f[th]=D,aj(f,m,!1,!1),m.stateNode=f;e:{switch(de=zr(T,D),T){case"dialog":jn("cancel",f),jn("close",f),G=D;break;case"iframe":case"object":case"embed":jn("load",f),G=D;break;case"video":case"audio":for(G=0;G<vc.length;G++)jn(vc[G],f);G=D;break;case"source":jn("error",f),G=D;break;case"img":case"image":case"link":jn("error",f),jn("load",f),G=D;break;case"details":jn("toggle",f),G=D;break;case"input":je(f,D),G=Ne(f,D),jn("invalid",f);break;case"option":G=D;break;case"select":f._wrapperState={wasMultiple:!!D.multiple},G=V({},D,{value:void 0}),jn("invalid",f);break;case"textarea":pt(f,D),G=lt(f,D),jn("invalid",f);break;default:G=D}Dr(T,G),Pe=G;for(Q in Pe)if(Pe.hasOwnProperty(Q)){var Ie=Pe[Q];Q==="style"?Vt(f,Ie):Q==="dangerouslySetInnerHTML"?(Ie=Ie?Ie.__html:void 0,Ie!=null&&ct(f,Ie)):Q==="children"?typeof Ie=="string"?(T!=="textarea"||Ie!=="")&&We(f,Ie):typeof Ie=="number"&&We(f,""+Ie):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(s.hasOwnProperty(Q)?Ie!=null&&Q==="onScroll"&&jn("scroll",f):Ie!=null&&_(f,Q,Ie,de))}switch(T){case"input":ke(f),It(f,D,!1);break;case"textarea":ke(f),Mt(f);break;case"option":D.value!=null&&f.setAttribute("value",""+ie(D.value));break;case"select":f.multiple=!!D.multiple,Q=D.value,Q!=null?xt(f,!!D.multiple,Q,!1):D.defaultValue!=null&&xt(f,!!D.multiple,D.defaultValue,!0);break;default:typeof G.onClick=="function"&&(f.onclick=hu)}switch(T){case"button":case"input":case"select":case"textarea":D=!!D.autoFocus;break e;case"img":D=!0;break e;default:D=!1}}D&&(m.flags|=4)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return hi(m),null;case 6:if(f&&m.stateNode!=null)oj(f,m,f.memoizedProps,D);else{if(typeof D!="string"&&m.stateNode===null)throw Error(r(166));if(T=Ds(cs.current),Ds(_n.current),sh(m)){if(D=m.stateNode,T=m.memoizedProps,D[ro]=m,(Q=D.nodeValue!==T)&&(f=Ii,f!==null))switch(f.tag){case 3:Zf(D.nodeValue,T,(f.mode&1)!==0);break;case 5:f.memoizedProps.suppressHydrationWarning!==!0&&Zf(D.nodeValue,T,(f.mode&1)!==0)}Q&&(m.flags|=4)}else D=(T.nodeType===9?T:T.ownerDocument).createTextNode(D),D[ro]=m,m.stateNode=D}return hi(m),null;case 13:if(Pn(Fn),D=m.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(pn&&Zt!==null&&(m.mode&1)!==0&&(m.flags&128)===0)Ip(),bu(),m.flags|=98560,Q=!1;else if(Q=sh(m),D!==null&&D.dehydrated!==null){if(f===null){if(!Q)throw Error(r(318));if(Q=m.memoizedState,Q=Q!==null?Q.dehydrated:null,!Q)throw Error(r(317));Q[ro]=m}else bu(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;hi(m),Q=!1}else Mi!==null&&(oS(Mi),Mi=null),Q=!0;if(!Q)return m.flags&65536?m:null}return(m.flags&128)!==0?(m.lanes=T,m):(D=D!==null,D!==(f!==null&&f.memoizedState!==null)&&D&&(m.child.flags|=8192,(m.mode&1)!==0&&(f===null||(Fn.current&1)!==0?la===0&&(la=3):uS())),m.updateQueue!==null&&(m.flags|=4),hi(m),null);case 4:return Wn(),X2(f,m),f===null&&du(m.stateNode.containerInfo),hi(m),null;case 10:return hg(m.type._context),hi(m),null;case 17:return va(m.type)&&Ed(),hi(m),null;case 19:if(Pn(Fn),Q=m.memoizedState,Q===null)return hi(m),null;if(D=(m.flags&128)!==0,de=Q.rendering,de===null)if(D)Kp(Q,!1);else{if(la!==0||f!==null&&(f.flags&128)!==0)for(f=m.child;f!==null;){if(de=Rd(f),de!==null){for(m.flags|=128,Kp(Q,!1),D=de.updateQueue,D!==null&&(m.updateQueue=D,m.flags|=4),m.subtreeFlags=0,D=T,T=m.child;T!==null;)Q=T,f=D,Q.flags&=14680066,de=Q.alternate,de===null?(Q.childLanes=0,Q.lanes=f,Q.child=null,Q.subtreeFlags=0,Q.memoizedProps=null,Q.memoizedState=null,Q.updateQueue=null,Q.dependencies=null,Q.stateNode=null):(Q.childLanes=de.childLanes,Q.lanes=de.lanes,Q.child=de.child,Q.subtreeFlags=0,Q.deletions=null,Q.memoizedProps=de.memoizedProps,Q.memoizedState=de.memoizedState,Q.updateQueue=de.updateQueue,Q.type=de.type,f=de.dependencies,Q.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),T=T.sibling;return bn(Fn,Fn.current&1|2),m.child}f=f.sibling}Q.tail!==null&&ft()>Ng&&(m.flags|=128,D=!0,Kp(Q,!1),m.lanes=4194304)}else{if(!D)if(f=Rd(de),f!==null){if(m.flags|=128,D=!0,T=f.updateQueue,T!==null&&(m.updateQueue=T,m.flags|=4),Kp(Q,!0),Q.tail===null&&Q.tailMode==="hidden"&&!de.alternate&&!pn)return hi(m),null}else 2*ft()-Q.renderingStartTime>Ng&&T!==1073741824&&(m.flags|=128,D=!0,Kp(Q,!1),m.lanes=4194304);Q.isBackwards?(de.sibling=m.child,m.child=de):(T=Q.last,T!==null?T.sibling=de:m.child=de,Q.last=de)}return Q.tail!==null?(m=Q.tail,Q.rendering=m,Q.tail=m.sibling,Q.renderingStartTime=ft(),m.sibling=null,T=Fn.current,bn(Fn,D?T&1|2:T&1),m):(hi(m),null);case 22:case 23:return cS(),D=m.memoizedState!==null,f!==null&&f.memoizedState!==null!==D&&(m.flags|=8192),D&&(m.mode&1)!==0?(No&1073741824)!==0&&(hi(m),m.subtreeFlags&6&&(m.flags|=8192)):hi(m),null;case 24:return null;case 25:return null}throw Error(r(156,m.tag))}function CV(f,m){switch(Ks(m),m.tag){case 1:return va(m.type)&&Ed(),f=m.flags,f&65536?(m.flags=f&-65537|128,m):null;case 3:return Wn(),Pn(ya),Pn(ia),wa(),f=m.flags,(f&65536)!==0&&(f&128)===0?(m.flags=f&-65537|128,m):null;case 5:return Ul(m),null;case 13:if(Pn(Fn),f=m.memoizedState,f!==null&&f.dehydrated!==null){if(m.alternate===null)throw Error(r(340));bu()}return f=m.flags,f&65536?(m.flags=f&-65537|128,m):null;case 19:return Pn(Fn),null;case 4:return Wn(),null;case 10:return hg(m.type._context),null;case 22:case 23:return cS(),null;case 24:return null;default:return null}}var W1=!1,gi=!1,TV=typeof WeakSet=="function"?WeakSet:Set,cr=null;function Tg(f,m){var T=f.ref;if(T!==null)if(typeof T=="function")try{T(null)}catch(D){ys(f,m,D)}else T.current=null}function J2(f,m,T){try{T()}catch(D){ys(f,m,D)}}var lj=!1;function EV(f,m){if(jp=B0,f=Fs(),Sd(f)){if("selectionStart"in f)var T={start:f.selectionStart,end:f.selectionEnd};else e:{T=(T=f.ownerDocument)&&T.defaultView||window;var D=T.getSelection&&T.getSelection();if(D&&D.rangeCount!==0){T=D.anchorNode;var G=D.anchorOffset,Q=D.focusNode;D=D.focusOffset;try{T.nodeType,Q.nodeType}catch{T=null;break e}var de=0,Pe=-1,Ie=-1,gt=0,Bt=0,Ut=f,Lt=null;t:for(;;){for(var sr;Ut!==T||G!==0&&Ut.nodeType!==3||(Pe=de+G),Ut!==Q||D!==0&&Ut.nodeType!==3||(Ie=de+D),Ut.nodeType===3&&(de+=Ut.nodeValue.length),(sr=Ut.firstChild)!==null;)Lt=Ut,Ut=sr;for(;;){if(Ut===f)break t;if(Lt===T&&++gt===G&&(Pe=de),Lt===Q&&++Bt===D&&(Ie=de),(sr=Ut.nextSibling)!==null)break;Ut=Lt,Lt=Ut.parentNode}Ut=sr}T=Pe===-1||Ie===-1?null:{start:Pe,end:Ie}}else T=null}T=T||{start:0,end:0}}else T=null;for(Pp={focusedElem:f,selectionRange:T},B0=!1,cr=m;cr!==null;)if(m=cr,f=m.child,(m.subtreeFlags&1028)!==0&&f!==null)f.return=m,cr=f;else for(;cr!==null;){m=cr;try{var dr=m.alternate;if((m.flags&1024)!==0)switch(m.tag){case 0:case 11:case 15:break;case 1:if(dr!==null){var gr=dr.memoizedProps,Ms=dr.memoizedState,tt=m.stateNode,ze=tt.getSnapshotBeforeUpdate(m.elementType===m.type?gr:oa(m.type,gr),Ms);tt.__reactInternalSnapshotBeforeUpdate=ze}break;case 3:var ot=m.stateNode.containerInfo;ot.nodeType===1?ot.textContent="":ot.nodeType===9&&ot.documentElement&&ot.removeChild(ot.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Gt){ys(m,m.return,Gt)}if(f=m.sibling,f!==null){f.return=m.return,cr=f;break}cr=m.return}return dr=lj,lj=!1,dr}function qp(f,m,T){var D=m.updateQueue;if(D=D!==null?D.lastEffect:null,D!==null){var G=D=D.next;do{if((G.tag&f)===f){var Q=G.destroy;G.destroy=void 0,Q!==void 0&&J2(m,T,Q)}G=G.next}while(G!==D)}}function H1(f,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var T=m=m.next;do{if((T.tag&f)===f){var D=T.create;T.destroy=D()}T=T.next}while(T!==m)}}function Q2(f){var m=f.ref;if(m!==null){var T=f.stateNode;switch(f.tag){case 5:f=T;break;default:f=T}typeof m=="function"?m(f):m.current=f}}function cj(f){var m=f.alternate;m!==null&&(f.alternate=null,cj(m)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(m=f.stateNode,m!==null&&(delete m[ro],delete m[th],delete m[ag],delete m[N1],delete m[A1])),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function uj(f){return f.tag===5||f.tag===3||f.tag===4}function dj(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||uj(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function Z2(f,m,T){var D=f.tag;if(D===5||D===6)f=f.stateNode,m?T.nodeType===8?T.parentNode.insertBefore(f,m):T.insertBefore(f,m):(T.nodeType===8?(m=T.parentNode,m.insertBefore(f,T)):(m=T,m.appendChild(f)),T=T._reactRootContainer,T!=null||m.onclick!==null||(m.onclick=hu));else if(D!==4&&(f=f.child,f!==null))for(Z2(f,m,T),f=f.sibling;f!==null;)Z2(f,m,T),f=f.sibling}function eS(f,m,T){var D=f.tag;if(D===5||D===6)f=f.stateNode,m?T.insertBefore(f,m):T.appendChild(f);else if(D!==4&&(f=f.child,f!==null))for(eS(f,m,T),f=f.sibling;f!==null;)eS(f,m,T),f=f.sibling}var Va=null,Hl=!1;function Gd(f,m,T){for(T=T.child;T!==null;)fj(f,m,T),T=T.sibling}function fj(f,m,T){if(qr&&typeof qr.onCommitFiberUnmount=="function")try{qr.onCommitFiberUnmount(Er,T)}catch{}switch(T.tag){case 5:gi||Tg(T,m);case 6:var D=Va,G=Hl;Va=null,Gd(f,m,T),Va=D,Hl=G,Va!==null&&(Hl?(f=Va,T=T.stateNode,f.nodeType===8?f.parentNode.removeChild(T):f.removeChild(T)):Va.removeChild(T.stateNode));break;case 18:Va!==null&&(Hl?(f=Va,T=T.stateNode,f.nodeType===8?sg(f.parentNode,T):f.nodeType===1&&sg(f,T),ci(f)):sg(Va,T.stateNode));break;case 4:D=Va,G=Hl,Va=T.stateNode.containerInfo,Hl=!0,Gd(f,m,T),Va=D,Hl=G;break;case 0:case 11:case 14:case 15:if(!gi&&(D=T.updateQueue,D!==null&&(D=D.lastEffect,D!==null))){G=D=D.next;do{var Q=G,de=Q.destroy;Q=Q.tag,de!==void 0&&((Q&2)!==0||(Q&4)!==0)&&J2(T,m,de),G=G.next}while(G!==D)}Gd(f,m,T);break;case 1:if(!gi&&(Tg(T,m),D=T.stateNode,typeof D.componentWillUnmount=="function"))try{D.props=T.memoizedProps,D.state=T.memoizedState,D.componentWillUnmount()}catch(Pe){ys(T,m,Pe)}Gd(f,m,T);break;case 21:Gd(f,m,T);break;case 22:T.mode&1?(gi=(D=gi)||T.memoizedState!==null,Gd(f,m,T),gi=D):Gd(f,m,T);break;default:Gd(f,m,T)}}function hj(f){var m=f.updateQueue;if(m!==null){f.updateQueue=null;var T=f.stateNode;T===null&&(T=f.stateNode=new TV),m.forEach(function(D){var G=IV.bind(null,f,D);T.has(D)||(T.add(D),D.then(G,G))})}}function Gl(f,m){var T=m.deletions;if(T!==null)for(var D=0;D<T.length;D++){var G=T[D];try{var Q=f,de=m,Pe=de;e:for(;Pe!==null;){switch(Pe.tag){case 5:Va=Pe.stateNode,Hl=!1;break e;case 3:Va=Pe.stateNode.containerInfo,Hl=!0;break e;case 4:Va=Pe.stateNode.containerInfo,Hl=!0;break e}Pe=Pe.return}if(Va===null)throw Error(r(160));fj(Q,de,G),Va=null,Hl=!1;var Ie=G.alternate;Ie!==null&&(Ie.return=null),G.return=null}catch(gt){ys(G,m,gt)}}if(m.subtreeFlags&12854)for(m=m.child;m!==null;)gj(m,f),m=m.sibling}function gj(f,m){var T=f.alternate,D=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(Gl(m,f),Fc(f),D&4){try{qp(3,f,f.return),H1(3,f)}catch(gr){ys(f,f.return,gr)}try{qp(5,f,f.return)}catch(gr){ys(f,f.return,gr)}}break;case 1:Gl(m,f),Fc(f),D&512&&T!==null&&Tg(T,T.return);break;case 5:if(Gl(m,f),Fc(f),D&512&&T!==null&&Tg(T,T.return),f.flags&32){var G=f.stateNode;try{We(G,"")}catch(gr){ys(f,f.return,gr)}}if(D&4&&(G=f.stateNode,G!=null)){var Q=f.memoizedProps,de=T!==null?T.memoizedProps:Q,Pe=f.type,Ie=f.updateQueue;if(f.updateQueue=null,Ie!==null)try{Pe==="input"&&Q.type==="radio"&&Q.name!=null&&Ke(G,Q),zr(Pe,de);var gt=zr(Pe,Q);for(de=0;de<Ie.length;de+=2){var Bt=Ie[de],Ut=Ie[de+1];Bt==="style"?Vt(G,Ut):Bt==="dangerouslySetInnerHTML"?ct(G,Ut):Bt==="children"?We(G,Ut):_(G,Bt,Ut,gt)}switch(Pe){case"input":Ue(G,Q);break;case"textarea":Rt(G,Q);break;case"select":var Lt=G._wrapperState.wasMultiple;G._wrapperState.wasMultiple=!!Q.multiple;var sr=Q.value;sr!=null?xt(G,!!Q.multiple,sr,!1):Lt!==!!Q.multiple&&(Q.defaultValue!=null?xt(G,!!Q.multiple,Q.defaultValue,!0):xt(G,!!Q.multiple,Q.multiple?[]:"",!1))}G[th]=Q}catch(gr){ys(f,f.return,gr)}}break;case 6:if(Gl(m,f),Fc(f),D&4){if(f.stateNode===null)throw Error(r(162));G=f.stateNode,Q=f.memoizedProps;try{G.nodeValue=Q}catch(gr){ys(f,f.return,gr)}}break;case 3:if(Gl(m,f),Fc(f),D&4&&T!==null&&T.memoizedState.isDehydrated)try{ci(m.containerInfo)}catch(gr){ys(f,f.return,gr)}break;case 4:Gl(m,f),Fc(f);break;case 13:Gl(m,f),Fc(f),G=f.child,G.flags&8192&&(Q=G.memoizedState!==null,G.stateNode.isHidden=Q,!Q||G.alternate!==null&&G.alternate.memoizedState!==null||(nS=ft())),D&4&&hj(f);break;case 22:if(Bt=T!==null&&T.memoizedState!==null,f.mode&1?(gi=(gt=gi)||Bt,Gl(m,f),gi=gt):Gl(m,f),Fc(f),D&8192){if(gt=f.memoizedState!==null,(f.stateNode.isHidden=gt)&&!Bt&&(f.mode&1)!==0)for(cr=f,Bt=f.child;Bt!==null;){for(Ut=cr=Bt;cr!==null;){switch(Lt=cr,sr=Lt.child,Lt.tag){case 0:case 11:case 14:case 15:qp(4,Lt,Lt.return);break;case 1:Tg(Lt,Lt.return);var dr=Lt.stateNode;if(typeof dr.componentWillUnmount=="function"){D=Lt,T=Lt.return;try{m=D,dr.props=m.memoizedProps,dr.state=m.memoizedState,dr.componentWillUnmount()}catch(gr){ys(D,T,gr)}}break;case 5:Tg(Lt,Lt.return);break;case 22:if(Lt.memoizedState!==null){xj(Ut);continue}}sr!==null?(sr.return=Lt,cr=sr):xj(Ut)}Bt=Bt.sibling}e:for(Bt=null,Ut=f;;){if(Ut.tag===5){if(Bt===null){Bt=Ut;try{G=Ut.stateNode,gt?(Q=G.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none"):(Pe=Ut.stateNode,Ie=Ut.memoizedProps.style,de=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null,Pe.style.display=jt("display",de))}catch(gr){ys(f,f.return,gr)}}}else if(Ut.tag===6){if(Bt===null)try{Ut.stateNode.nodeValue=gt?"":Ut.memoizedProps}catch(gr){ys(f,f.return,gr)}}else if((Ut.tag!==22&&Ut.tag!==23||Ut.memoizedState===null||Ut===f)&&Ut.child!==null){Ut.child.return=Ut,Ut=Ut.child;continue}if(Ut===f)break e;for(;Ut.sibling===null;){if(Ut.return===null||Ut.return===f)break e;Bt===Ut&&(Bt=null),Ut=Ut.return}Bt===Ut&&(Bt=null),Ut.sibling.return=Ut.return,Ut=Ut.sibling}}break;case 19:Gl(m,f),Fc(f),D&4&&hj(f);break;case 21:break;default:Gl(m,f),Fc(f)}}function Fc(f){var m=f.flags;if(m&2){try{e:{for(var T=f.return;T!==null;){if(uj(T)){var D=T;break e}T=T.return}throw Error(r(160))}switch(D.tag){case 5:var G=D.stateNode;D.flags&32&&(We(G,""),D.flags&=-33);var Q=dj(f);eS(f,Q,G);break;case 3:case 4:var de=D.stateNode.containerInfo,Pe=dj(f);Z2(f,Pe,de);break;default:throw Error(r(161))}}catch(Ie){ys(f,f.return,Ie)}f.flags&=-3}m&4096&&(f.flags&=-4097)}function NV(f,m,T){cr=f,mj(f)}function mj(f,m,T){for(var D=(f.mode&1)!==0;cr!==null;){var G=cr,Q=G.child;if(G.tag===22&&D){var de=G.memoizedState!==null||W1;if(!de){var Pe=G.alternate,Ie=Pe!==null&&Pe.memoizedState!==null||gi;Pe=W1;var gt=gi;if(W1=de,(gi=Ie)&&!gt)for(cr=G;cr!==null;)de=cr,Ie=de.child,de.tag===22&&de.memoizedState!==null?yj(G):Ie!==null?(Ie.return=de,cr=Ie):yj(G);for(;Q!==null;)cr=Q,mj(Q),Q=Q.sibling;cr=G,W1=Pe,gi=gt}pj(f)}else(G.subtreeFlags&8772)!==0&&Q!==null?(Q.return=G,cr=Q):pj(f)}}function pj(f){for(;cr!==null;){var m=cr;if((m.flags&8772)!==0){var T=m.alternate;try{if((m.flags&8772)!==0)switch(m.tag){case 0:case 11:case 15:gi||H1(5,m);break;case 1:var D=m.stateNode;if(m.flags&4&&!gi)if(T===null)D.componentDidMount();else{var G=m.elementType===m.type?T.memoizedProps:oa(m.type,T.memoizedProps);D.componentDidUpdate(G,T.memoizedState,D.__reactInternalSnapshotBeforeUpdate)}var Q=m.updateQueue;Q!==null&&ts(m,Q,D);break;case 3:var de=m.updateQueue;if(de!==null){if(T=null,m.child!==null)switch(m.child.tag){case 5:T=m.child.stateNode;break;case 1:T=m.child.stateNode}ts(m,de,T)}break;case 5:var Pe=m.stateNode;if(T===null&&m.flags&4){T=Pe;var Ie=m.memoizedProps;switch(m.type){case"button":case"input":case"select":case"textarea":Ie.autoFocus&&T.focus();break;case"img":Ie.src&&(T.src=Ie.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(m.memoizedState===null){var gt=m.alternate;if(gt!==null){var Bt=gt.memoizedState;if(Bt!==null){var Ut=Bt.dehydrated;Ut!==null&&ci(Ut)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}gi||m.flags&512&&Q2(m)}catch(Lt){ys(m,m.return,Lt)}}if(m===f){cr=null;break}if(T=m.sibling,T!==null){T.return=m.return,cr=T;break}cr=m.return}}function xj(f){for(;cr!==null;){var m=cr;if(m===f){cr=null;break}var T=m.sibling;if(T!==null){T.return=m.return,cr=T;break}cr=m.return}}function yj(f){for(;cr!==null;){var m=cr;try{switch(m.tag){case 0:case 11:case 15:var T=m.return;try{H1(4,m)}catch(Ie){ys(m,T,Ie)}break;case 1:var D=m.stateNode;if(typeof D.componentDidMount=="function"){var G=m.return;try{D.componentDidMount()}catch(Ie){ys(m,G,Ie)}}var Q=m.return;try{Q2(m)}catch(Ie){ys(m,Q,Ie)}break;case 5:var de=m.return;try{Q2(m)}catch(Ie){ys(m,de,Ie)}}}catch(Ie){ys(m,m.return,Ie)}if(m===f){cr=null;break}var Pe=m.sibling;if(Pe!==null){Pe.return=m.return,cr=Pe;break}cr=m.return}}var AV=Math.ceil,G1=N.ReactCurrentDispatcher,tS=N.ReactCurrentOwner,nl=N.ReactCurrentBatchConfig,ln=0,ka=null,qs=null,Ka=0,No=0,Eg=Ll(0),la=0,Yp=null,fh=0,V1=0,rS=0,Xp=null,ao=null,nS=0,Ng=1/0,Tu=null,K1=!1,sS=null,Vd=null,q1=!1,Kd=null,Y1=0,Jp=0,aS=null,X1=-1,J1=0;function Ui(){return(ln&6)!==0?ft():X1!==-1?X1:X1=ft()}function qd(f){return(f.mode&1)===0?1:(ln&2)!==0&&Ka!==0?Ka&-Ka:Mp.transition!==null?(J1===0&&(J1=Nt()),J1):(f=Pt,f!==0||(f=window.event,f=f===void 0?16:d1(f.type)),f)}function Vl(f,m,T,D){if(50<Jp)throw Jp=0,aS=null,Error(r(185));an(f,T,D),((ln&2)===0||f!==ka)&&(f===ka&&((ln&2)===0&&(V1|=T),la===4&&Yd(f,Ka)),io(f,D),T===1&&ln===0&&(m.mode&1)===0&&(Ng=ft()+500,Nd&&Sc()))}function io(f,m){var T=f.callbackNode;Le(f,m);var D=we(f,f===ka?Ka:0);if(D===0)T!==null&&Ee(T),f.callbackNode=null,f.callbackPriority=0;else if(m=D&-D,f.callbackPriority!==m){if(T!=null&&Ee(T),m===1)f.tag===0?Bl(wj.bind(null,f)):nh(wj.bind(null,f)),T1(function(){(ln&6)===0&&Sc()}),T=null;else{switch(es(D)){case 1:T=Ct;break;case 4:T=Ht;break;case 16:T=yr;break;case 536870912:T=vr;break;default:T=yr}T=Nj(T,vj.bind(null,f))}f.callbackPriority=m,f.callbackNode=T}}function vj(f,m){if(X1=-1,J1=0,(ln&6)!==0)throw Error(r(327));var T=f.callbackNode;if(Ag()&&f.callbackNode!==T)return null;var D=we(f,f===ka?Ka:0);if(D===0)return null;if((D&30)!==0||(D&f.expiredLanes)!==0||m)m=Q1(f,D);else{m=D;var G=ln;ln|=2;var Q=_j();(ka!==f||Ka!==m)&&(Tu=null,Ng=ft()+500,gh(f,m));do try{FV();break}catch(Pe){bj(f,Pe)}while(!0);fg(),G1.current=Q,ln=G,qs!==null?m=0:(ka=null,Ka=0,m=la)}if(m!==0){if(m===2&&(G=Et(f),G!==0&&(D=G,m=iS(f,G))),m===1)throw T=Yp,gh(f,0),Yd(f,D),io(f,ft()),T;if(m===6)Yd(f,D);else{if(G=f.current.alternate,(D&30)===0&&!jV(G)&&(m=Q1(f,D),m===2&&(Q=Et(f),Q!==0&&(D=Q,m=iS(f,Q))),m===1))throw T=Yp,gh(f,0),Yd(f,D),io(f,ft()),T;switch(f.finishedWork=G,f.finishedLanes=D,m){case 0:case 1:throw Error(r(345));case 2:mh(f,ao,Tu);break;case 3:if(Yd(f,D),(D&130023424)===D&&(m=nS+500-ft(),10<m)){if(we(f,0)!==0)break;if(G=f.suspendedLanes,(G&D)!==D){Ui(),f.pingedLanes|=f.suspendedLanes&G;break}f.timeoutHandle=Di(mh.bind(null,f,ao,Tu),m);break}mh(f,ao,Tu);break;case 4:if(Yd(f,D),(D&4194240)===D)break;for(m=f.eventTimes,G=-1;0<D;){var de=31-he(D);Q=1<<de,de=m[de],de>G&&(G=de),D&=~Q}if(D=G,D=ft()-D,D=(120>D?120:480>D?480:1080>D?1080:1920>D?1920:3e3>D?3e3:4320>D?4320:1960*AV(D/1960))-D,10<D){f.timeoutHandle=Di(mh.bind(null,f,ao,Tu),D);break}mh(f,ao,Tu);break;case 5:mh(f,ao,Tu);break;default:throw Error(r(329))}}}return io(f,ft()),f.callbackNode===T?vj.bind(null,f):null}function iS(f,m){var T=Xp;return f.current.memoizedState.isDehydrated&&(gh(f,m).flags|=256),f=Q1(f,m),f!==2&&(m=ao,ao=T,m!==null&&oS(m)),f}function oS(f){ao===null?ao=f:ao.push.apply(ao,f)}function jV(f){for(var m=f;;){if(m.flags&16384){var T=m.updateQueue;if(T!==null&&(T=T.stores,T!==null))for(var D=0;D<T.length;D++){var G=T[D],Q=G.getSnapshot;G=G.value;try{if(!di(Q(),G))return!1}catch{return!1}}}if(T=m.child,m.subtreeFlags&16384&&T!==null)T.return=m,m=T;else{if(m===f)break;for(;m.sibling===null;){if(m.return===null||m.return===f)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function Yd(f,m){for(m&=~rS,m&=~V1,f.suspendedLanes|=m,f.pingedLanes&=~m,f=f.expirationTimes;0<m;){var T=31-he(m),D=1<<T;f[T]=-1,m&=~D}}function wj(f){if((ln&6)!==0)throw Error(r(327));Ag();var m=we(f,0);if((m&1)===0)return io(f,ft()),null;var T=Q1(f,m);if(f.tag!==0&&T===2){var D=Et(f);D!==0&&(m=D,T=iS(f,D))}if(T===1)throw T=Yp,gh(f,0),Yd(f,m),io(f,ft()),T;if(T===6)throw Error(r(345));return f.finishedWork=f.current.alternate,f.finishedLanes=m,mh(f,ao,Tu),io(f,ft()),null}function lS(f,m){var T=ln;ln|=1;try{return f(m)}finally{ln=T,ln===0&&(Ng=ft()+500,Nd&&Sc())}}function hh(f){Kd!==null&&Kd.tag===0&&(ln&6)===0&&Ag();var m=ln;ln|=1;var T=nl.transition,D=Pt;try{if(nl.transition=null,Pt=1,f)return f()}finally{Pt=D,nl.transition=T,ln=m,(ln&6)===0&&Sc()}}function cS(){No=Eg.current,Pn(Eg)}function gh(f,m){f.finishedWork=null,f.finishedLanes=0;var T=f.timeoutHandle;if(T!==-1&&(f.timeoutHandle=-1,Op(T)),qs!==null)for(T=qs.return;T!==null;){var D=T;switch(Ks(D),D.tag){case 1:D=D.type.childContextTypes,D!=null&&Ed();break;case 3:Wn(),Pn(ya),Pn(ia),wa();break;case 5:Ul(D);break;case 4:Wn();break;case 13:Pn(Fn);break;case 19:Pn(Fn);break;case 10:hg(D.type._context);break;case 22:case 23:cS()}T=T.return}if(ka=f,qs=f=Xd(f.current,null),Ka=No=m,la=0,Yp=null,rS=V1=fh=0,ao=Xp=null,Qo!==null){for(m=0;m<Qo.length;m++)if(T=Qo[m],D=T.interleaved,D!==null){T.interleaved=null;var G=D.next,Q=T.pending;if(Q!==null){var de=Q.next;Q.next=G,D.next=de}T.pending=D}Qo=null}return f}function bj(f,m){do{var T=qs;try{if(fg(),Id.current=Ud,Eo){for(var D=vn.memoizedState;D!==null;){var G=D.queue;G!==null&&(G.pending=null),D=D.next}Eo=!1}if(Ha=0,ps=rs=vn=null,Nc=!1,so=0,tS.current=null,T===null||T.return===null){la=1,Yp=m,qs=null;break}e:{var Q=f,de=T.return,Pe=T,Ie=m;if(m=Ka,Pe.flags|=32768,Ie!==null&&typeof Ie=="object"&&typeof Ie.then=="function"){var gt=Ie,Bt=Pe,Ut=Bt.tag;if((Bt.mode&1)===0&&(Ut===0||Ut===11||Ut===15)){var Lt=Bt.alternate;Lt?(Bt.updateQueue=Lt.updateQueue,Bt.memoizedState=Lt.memoizedState,Bt.lanes=Lt.lanes):(Bt.updateQueue=null,Bt.memoizedState=null)}var sr=O(de);if(sr!==null){sr.flags&=-257,z(sr,de,Pe,Q,m),sr.mode&1&&b(Q,gt,m),m=sr,Ie=gt;var dr=m.updateQueue;if(dr===null){var gr=new Set;gr.add(Ie),m.updateQueue=gr}else dr.add(Ie);break e}else{if((m&1)===0){b(Q,gt,m),uS();break e}Ie=Error(r(426))}}else if(pn&&Pe.mode&1){var Ms=O(de);if(Ms!==null){(Ms.flags&65536)===0&&(Ms.flags|=256),z(Ms,de,Pe,Q,m),ah(Cu(Ie,Pe));break e}}Q=Ie=Cu(Ie,Pe),la!==4&&(la=2),Xp===null?Xp=[Q]:Xp.push(Q),Q=de;do{switch(Q.tag){case 3:Q.flags|=65536,m&=-m,Q.lanes|=m;var tt=z1(Q,Ie,m);ch(Q,tt);break e;case 1:Pe=Ie;var ze=Q.type,ot=Q.stateNode;if((Q.flags&128)===0&&(typeof ze.getDerivedStateFromError=="function"||ot!==null&&typeof ot.componentDidCatch=="function"&&(Vd===null||!Vd.has(ot)))){Q.flags|=65536,m&=-m,Q.lanes|=m;var Gt=y(Q,Pe,m);ch(Q,Gt);break e}}Q=Q.return}while(Q!==null)}kj(T)}catch(pr){m=pr,qs===T&&T!==null&&(qs=T=T.return);continue}break}while(!0)}function _j(){var f=G1.current;return G1.current=Ud,f===null?Ud:f}function uS(){(la===0||la===3||la===2)&&(la=4),ka===null||(fh&268435455)===0&&(V1&268435455)===0||Yd(ka,Ka)}function Q1(f,m){var T=ln;ln|=2;var D=_j();(ka!==f||Ka!==m)&&(Tu=null,gh(f,m));do try{PV();break}catch(G){bj(f,G)}while(!0);if(fg(),ln=T,G1.current=D,qs!==null)throw Error(r(261));return ka=null,Ka=0,la}function PV(){for(;qs!==null;)Sj(qs)}function FV(){for(;qs!==null&&!Xe();)Sj(qs)}function Sj(f){var m=Ej(f.alternate,f,No);f.memoizedProps=f.pendingProps,m===null?kj(f):qs=m,tS.current=null}function kj(f){var m=f;do{var T=m.alternate;if(f=m.return,(m.flags&32768)===0){if(T=kV(T,m,No),T!==null){qs=T;return}}else{if(T=CV(T,m),T!==null){T.flags&=32767,qs=T;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{la=6,qs=null;return}}if(m=m.sibling,m!==null){qs=m;return}qs=m=f}while(m!==null);la===0&&(la=5)}function mh(f,m,T){var D=Pt,G=nl.transition;try{nl.transition=null,Pt=1,OV(f,m,T,D)}finally{nl.transition=G,Pt=D}return null}function OV(f,m,T,D){do Ag();while(Kd!==null);if((ln&6)!==0)throw Error(r(327));T=f.finishedWork;var G=f.finishedLanes;if(T===null)return null;if(f.finishedWork=null,f.finishedLanes=0,T===f.current)throw Error(r(177));f.callbackNode=null,f.callbackPriority=0;var Q=T.lanes|T.childLanes;if(ht(f,Q),f===ka&&(qs=ka=null,Ka=0),(T.subtreeFlags&2064)===0&&(T.flags&2064)===0||q1||(q1=!0,Nj(yr,function(){return Ag(),null})),Q=(T.flags&15990)!==0,(T.subtreeFlags&15990)!==0||Q){Q=nl.transition,nl.transition=null;var de=Pt;Pt=1;var Pe=ln;ln|=4,tS.current=null,EV(f,T),gj(T,f),Yf(Pp),B0=!!jp,Pp=jp=null,f.current=T,NV(T),ut(),ln=Pe,Pt=de,nl.transition=Q}else f.current=T;if(q1&&(q1=!1,Kd=f,Y1=G),Q=f.pendingLanes,Q===0&&(Vd=null),Hr(T.stateNode),io(f,ft()),m!==null)for(D=f.onRecoverableError,T=0;T<m.length;T++)G=m[T],D(G.value,{componentStack:G.stack,digest:G.digest});if(K1)throw K1=!1,f=sS,sS=null,f;return(Y1&1)!==0&&f.tag!==0&&Ag(),Q=f.pendingLanes,(Q&1)!==0?f===aS?Jp++:(Jp=0,aS=f):Jp=0,Sc(),null}function Ag(){if(Kd!==null){var f=es(Y1),m=nl.transition,T=Pt;try{if(nl.transition=null,Pt=16>f?16:f,Kd===null)var D=!1;else{if(f=Kd,Kd=null,Y1=0,(ln&6)!==0)throw Error(r(331));var G=ln;for(ln|=4,cr=f.current;cr!==null;){var Q=cr,de=Q.child;if((cr.flags&16)!==0){var Pe=Q.deletions;if(Pe!==null){for(var Ie=0;Ie<Pe.length;Ie++){var gt=Pe[Ie];for(cr=gt;cr!==null;){var Bt=cr;switch(Bt.tag){case 0:case 11:case 15:qp(8,Bt,Q)}var Ut=Bt.child;if(Ut!==null)Ut.return=Bt,cr=Ut;else for(;cr!==null;){Bt=cr;var Lt=Bt.sibling,sr=Bt.return;if(cj(Bt),Bt===gt){cr=null;break}if(Lt!==null){Lt.return=sr,cr=Lt;break}cr=sr}}}var dr=Q.alternate;if(dr!==null){var gr=dr.child;if(gr!==null){dr.child=null;do{var Ms=gr.sibling;gr.sibling=null,gr=Ms}while(gr!==null)}}cr=Q}}if((Q.subtreeFlags&2064)!==0&&de!==null)de.return=Q,cr=de;else e:for(;cr!==null;){if(Q=cr,(Q.flags&2048)!==0)switch(Q.tag){case 0:case 11:case 15:qp(9,Q,Q.return)}var tt=Q.sibling;if(tt!==null){tt.return=Q.return,cr=tt;break e}cr=Q.return}}var ze=f.current;for(cr=ze;cr!==null;){de=cr;var ot=de.child;if((de.subtreeFlags&2064)!==0&&ot!==null)ot.return=de,cr=ot;else e:for(de=ze;cr!==null;){if(Pe=cr,(Pe.flags&2048)!==0)try{switch(Pe.tag){case 0:case 11:case 15:H1(9,Pe)}}catch(pr){ys(Pe,Pe.return,pr)}if(Pe===de){cr=null;break e}var Gt=Pe.sibling;if(Gt!==null){Gt.return=Pe.return,cr=Gt;break e}cr=Pe.return}}if(ln=G,Sc(),qr&&typeof qr.onPostCommitFiberRoot=="function")try{qr.onPostCommitFiberRoot(Er,f)}catch{}D=!0}return D}finally{Pt=T,nl.transition=m}}return!1}function Cj(f,m,T){m=Cu(T,m),m=z1(f,m,1),f=tl(f,m,1),m=Ui(),f!==null&&(an(f,1,m),io(f,m))}function ys(f,m,T){if(f.tag===3)Cj(f,f,T);else for(;m!==null;){if(m.tag===3){Cj(m,f,T);break}else if(m.tag===1){var D=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(Vd===null||!Vd.has(D))){f=Cu(T,f),f=y(m,f,1),m=tl(m,f,1),f=Ui(),m!==null&&(an(m,1,f),io(m,f));break}}m=m.return}}function DV(f,m,T){var D=f.pingCache;D!==null&&D.delete(m),m=Ui(),f.pingedLanes|=f.suspendedLanes&T,ka===f&&(Ka&T)===T&&(la===4||la===3&&(Ka&130023424)===Ka&&500>ft()-nS?gh(f,0):rS|=T),io(f,m)}function Tj(f,m){m===0&&((f.mode&1)===0?m=1:(m=An,An<<=1,(An&130023424)===0&&(An=4194304)));var T=Ui();f=Bi(f,m),f!==null&&(an(f,m,T),io(f,T))}function RV(f){var m=f.memoizedState,T=0;m!==null&&(T=m.retryLane),Tj(f,T)}function IV(f,m){var T=0;switch(f.tag){case 13:var D=f.stateNode,G=f.memoizedState;G!==null&&(T=G.retryLane);break;case 19:D=f.stateNode;break;default:throw Error(r(314))}D!==null&&D.delete(m),Tj(f,T)}var Ej;Ej=function(f,m,T){if(f!==null)if(f.memoizedProps!==m.pendingProps||ya.current)te=!0;else{if((f.lanes&T)===0&&(m.flags&128)===0)return te=!1,Y2(f,m,T);te=(f.flags&131072)!==0}else te=!1,pn&&(m.flags&1048576)!==0&&P1(m,Cc,m.index);switch(m.lanes=0,m.tag){case 2:var D=m.type;tn(f,m),f=m.pendingProps;var G=pu(m,ia.current);$l(m,T),G=Md(null,m,D,f,G,T);var Q=Ld();return m.flags|=1,typeof G=="object"&&G!==null&&typeof G.render=="function"&&G.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,va(D)?(Q=!0,xu(m)):Q=!1,m.memoizedState=G.state!==null&&G.state!==void 0?G.state:null,lh(m),G.updater=Wd,m.stateNode=G,G._reactInternals=m,kg(m,D,f,T),m=xn(null,m,D,!0,Q,T)):(m.tag=0,pn&&Q&&Ad(m),ve(null,m,G,T),m=m.child),m;case 16:D=m.elementType;e:{switch(tn(f,m),f=m.pendingProps,G=D._init,D=G(D._payload),m.type=D,G=m.tag=LV(D),f=oa(D,f),G){case 0:m=tr(null,m,D,f,T);break e;case 1:m=On(null,m,D,f,T);break e;case 11:m=Ge(null,m,D,f,T);break e;case 14:m=mt(null,m,D,oa(D.type,f),T);break e}throw Error(r(306,D,""))}return m;case 0:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:oa(D,G),tr(f,m,D,G,T);case 1:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:oa(D,G),On(f,m,D,G,T);case 3:e:{if(Ga(m),f===null)throw Error(r(387));D=m.pendingProps,Q=m.memoizedState,G=Q.element,mg(f,m),Od(m,D,null,T);var de=m.memoizedState;if(D=de.element,Q.isDehydrated)if(Q={element:D,isDehydrated:!1,cache:de.cache,pendingSuspenseBoundaries:de.pendingSuspenseBoundaries,transitions:de.transitions},m.updateQueue.baseState=Q,m.memoizedState=Q,m.flags&256){G=Cu(Error(r(423)),m),m=rl(f,m,D,T,G);break e}else if(D!==G){G=Cu(Error(r(424)),m),m=rl(f,m,D,T,G);break e}else for(Zt=qo(m.stateNode.containerInfo.firstChild),Ii=m,pn=!0,Mi=null,T=no(m,null,D,T),m.child=T;T;)T.flags=T.flags&-3|4096,T=T.sibling;else{if(bu(),D===G){m=Sa(f,m,T);break e}ve(f,m,D,T)}m=m.child}return m;case 5:return Dd(m),f===null&&jd(m),D=m.type,G=m.pendingProps,Q=f!==null?f.memoizedProps:null,de=G.children,Fp(D,G)?de=null:Q!==null&&Fp(D,Q)&&(m.flags|=32),Mr(f,m),ve(f,m,de,T),m.child;case 6:return f===null&&jd(m),null;case 13:return yt(f,m,T);case 4:return Ec(m,m.stateNode.containerInfo),D=m.pendingProps,f===null?m.child=_u(m,null,D,T):ve(f,m,D,T),m.child;case 11:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:oa(D,G),Ge(f,m,D,G,T);case 7:return ve(f,m,m.pendingProps,T),m.child;case 8:return ve(f,m,m.pendingProps.children,T),m.child;case 12:return ve(f,m,m.pendingProps.children,T),m.child;case 10:e:{if(D=m.type._context,G=m.pendingProps,Q=m.memoizedProps,de=G.value,bn(ih,D._currentValue),D._currentValue=de,Q!==null)if(di(Q.value,de)){if(Q.children===G.children&&!ya.current){m=Sa(f,m,T);break e}}else for(Q=m.child,Q!==null&&(Q.return=m);Q!==null;){var Pe=Q.dependencies;if(Pe!==null){de=Q.child;for(var Ie=Pe.firstContext;Ie!==null;){if(Ie.context===D){if(Q.tag===1){Ie=el(-1,T&-T),Ie.tag=2;var gt=Q.updateQueue;if(gt!==null){gt=gt.shared;var Bt=gt.pending;Bt===null?Ie.next=Ie:(Ie.next=Bt.next,Bt.next=Ie),gt.pending=Ie}}Q.lanes|=T,Ie=Q.alternate,Ie!==null&&(Ie.lanes|=T),gg(Q.return,T,m),Pe.lanes|=T;break}Ie=Ie.next}}else if(Q.tag===10)de=Q.type===m.type?null:Q.child;else if(Q.tag===18){if(de=Q.return,de===null)throw Error(r(341));de.lanes|=T,Pe=de.alternate,Pe!==null&&(Pe.lanes|=T),gg(de,T,m),de=Q.sibling}else de=Q.child;if(de!==null)de.return=Q;else for(de=Q;de!==null;){if(de===m){de=null;break}if(Q=de.sibling,Q!==null){Q.return=de.return,de=Q;break}de=de.return}Q=de}ve(f,m,G.children,T),m=m.child}return m;case 9:return G=m.type,D=m.pendingProps.children,$l(m,T),G=Wa(G),D=D(G),m.flags|=1,ve(f,m,D,T),m.child;case 14:return D=m.type,G=oa(D,m.pendingProps),G=oa(D.type,G),mt(f,m,D,G,T);case 15:return Wt(f,m,m.type,m.pendingProps,T);case 17:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:oa(D,G),tn(f,m),m.tag=1,va(D)?(f=!0,xu(m)):f=!1,$l(m,T),U1(m,D,G),kg(m,D,G,T),xn(null,m,D,!0,f,T);case 19:return Is(f,m,T);case 22:return lr(f,m,T)}throw Error(r(156,m.tag))};function Nj(f,m){return Te(f,m)}function MV(f,m,T,D){this.tag=f,this.key=T,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sl(f,m,T,D){return new MV(f,m,T,D)}function dS(f){return f=f.prototype,!(!f||!f.isReactComponent)}function LV(f){if(typeof f=="function")return dS(f)?1:0;if(f!=null){if(f=f.$$typeof,f===Y)return 11;if(f===ee)return 14}return 2}function Xd(f,m){var T=f.alternate;return T===null?(T=sl(f.tag,m,f.key,f.mode),T.elementType=f.elementType,T.type=f.type,T.stateNode=f.stateNode,T.alternate=f,f.alternate=T):(T.pendingProps=m,T.type=f.type,T.flags=0,T.subtreeFlags=0,T.deletions=null),T.flags=f.flags&14680064,T.childLanes=f.childLanes,T.lanes=f.lanes,T.child=f.child,T.memoizedProps=f.memoizedProps,T.memoizedState=f.memoizedState,T.updateQueue=f.updateQueue,m=f.dependencies,T.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},T.sibling=f.sibling,T.index=f.index,T.ref=f.ref,T}function Z1(f,m,T,D,G,Q){var de=2;if(D=f,typeof f=="function")dS(f)&&(de=1);else if(typeof f=="string")de=5;else e:switch(f){case F:return ph(T.children,G,Q,m);case A:de=8,G|=8;break;case j:return f=sl(12,T,m,G|2),f.elementType=j,f.lanes=Q,f;case Z:return f=sl(13,T,m,G),f.elementType=Z,f.lanes=Q,f;case ae:return f=sl(19,T,m,G),f.elementType=ae,f.lanes=Q,f;case L:return ew(T,G,Q,m);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case R:de=10;break e;case U:de=9;break e;case Y:de=11;break e;case ee:de=14;break e;case ne:de=16,D=null;break e}throw Error(r(130,f==null?f:typeof f,""))}return m=sl(de,T,m,G),m.elementType=f,m.type=D,m.lanes=Q,m}function ph(f,m,T,D){return f=sl(7,f,D,m),f.lanes=T,f}function ew(f,m,T,D){return f=sl(22,f,D,m),f.elementType=L,f.lanes=T,f.stateNode={isHidden:!1},f}function fS(f,m,T){return f=sl(6,f,null,m),f.lanes=T,f}function hS(f,m,T){return m=sl(4,f.children!==null?f.children:[],f.key,m),m.lanes=T,m.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},m}function BV(f,m,T,D,G){this.tag=m,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mr(0),this.expirationTimes=mr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mr(0),this.identifierPrefix=D,this.onRecoverableError=G,this.mutableSourceEagerHydrationData=null}function gS(f,m,T,D,G,Q,de,Pe,Ie){return f=new BV(f,m,T,Pe,Ie),m===1?(m=1,Q===!0&&(m|=8)):m=0,Q=sl(3,null,null,m),f.current=Q,Q.stateNode=f,Q.memoizedState={element:D,isDehydrated:T,cache:null,transitions:null,pendingSuspenseBoundaries:null},lh(Q),f}function $V(f,m,T){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:D==null?null:""+D,children:f,containerInfo:m,implementation:T}}function Aj(f){if(!f)return Xo;f=f._reactInternals;e:{if(Se(f)!==f||f.tag!==1)throw Error(r(170));var m=f;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(va(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(r(171))}if(f.tag===1){var T=f.type;if(va(T))return og(f,T,m)}return m}function jj(f,m,T,D,G,Q,de,Pe,Ie){return f=gS(T,D,!0,f,G,Q,de,Pe,Ie),f.context=Aj(null),T=f.current,D=Ui(),G=qd(T),Q=el(D,G),Q.callback=m??null,tl(T,Q,G),f.current.lanes=G,an(f,G,D),io(f,D),f}function tw(f,m,T,D){var G=m.current,Q=Ui(),de=qd(G);return T=Aj(T),m.context===null?m.context=T:m.pendingContext=T,m=el(Q,de),m.payload={element:f},D=D===void 0?null:D,D!==null&&(m.callback=D),f=tl(G,m,de),f!==null&&(Vl(f,G,de,Q),pg(f,G,de)),de}function rw(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return f.child.stateNode;default:return f.child.stateNode}}function Pj(f,m){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var T=f.retryLane;f.retryLane=T!==0&&T<m?T:m}}function mS(f,m){Pj(f,m),(f=f.alternate)&&Pj(f,m)}function UV(){return null}var Fj=typeof reportError=="function"?reportError:function(f){console.error(f)};function pS(f){this._internalRoot=f}nw.prototype.render=pS.prototype.render=function(f){var m=this._internalRoot;if(m===null)throw Error(r(409));tw(f,m,null,null)},nw.prototype.unmount=pS.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var m=f.containerInfo;hh(function(){tw(null,f,null,null)}),m[Yo]=null}};function nw(f){this._internalRoot=f}nw.prototype.unstable_scheduleHydration=function(f){if(f){var m=li();f={blockedOn:null,target:f,priority:m};for(var T=0;T<Ko.length&&m!==0&&m<Ko[T].priority;T++);Ko.splice(T,0,f),T===0&&I0(f)}};function xS(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function sw(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11&&(f.nodeType!==8||f.nodeValue!==" react-mount-point-unstable "))}function Oj(){}function zV(f,m,T,D,G){if(G){if(typeof D=="function"){var Q=D;D=function(){var gt=rw(de);Q.call(gt)}}var de=jj(m,D,f,0,null,!1,!1,"",Oj);return f._reactRootContainer=de,f[Yo]=de.current,du(f.nodeType===8?f.parentNode:f),hh(),de}for(;G=f.lastChild;)f.removeChild(G);if(typeof D=="function"){var Pe=D;D=function(){var gt=rw(Ie);Pe.call(gt)}}var Ie=gS(f,0,!1,null,null,!1,!1,"",Oj);return f._reactRootContainer=Ie,f[Yo]=Ie.current,du(f.nodeType===8?f.parentNode:f),hh(function(){tw(m,Ie,T,D)}),Ie}function aw(f,m,T,D,G){var Q=T._reactRootContainer;if(Q){var de=Q;if(typeof G=="function"){var Pe=G;G=function(){var Ie=rw(de);Pe.call(Ie)}}tw(m,de,f,G)}else de=zV(T,m,f,G,D);return rw(de)}Jr=function(f){switch(f.tag){case 3:var m=f.stateNode;if(m.current.memoizedState.isDehydrated){var T=et(m.pendingLanes);T!==0&&(Qt(m,T|1),io(m,ft()),(ln&6)===0&&(Ng=ft()+500,Sc()))}break;case 13:hh(function(){var D=Bi(f,1);if(D!==null){var G=Ui();Vl(D,f,1,G)}}),mS(f,1)}},Nr=function(f){if(f.tag===13){var m=Bi(f,134217728);if(m!==null){var T=Ui();Vl(m,f,134217728,T)}mS(f,134217728)}},os=function(f){if(f.tag===13){var m=qd(f),T=Bi(f,m);if(T!==null){var D=Ui();Vl(T,f,m,D)}mS(f,m)}},li=function(){return Pt},Go=function(f,m){var T=Pt;try{return Pt=f,m()}finally{Pt=T}},me=function(f,m,T){switch(m){case"input":if(Ue(f,T),m=T.name,T.type==="radio"&&m!=null){for(T=f;T.parentNode;)T=T.parentNode;for(T=T.querySelectorAll("input[name="+JSON.stringify(""+m)+'][type="radio"]'),m=0;m<T.length;m++){var D=T[m];if(D!==f&&D.form===f.form){var G=Vs(D);if(!G)throw Error(r(90));re(D),Ue(D,G)}}}break;case"textarea":Rt(f,T);break;case"select":m=T.value,m!=null&&xt(f,!!T.multiple,m,!1)}},at=lS,Ce=hh;var WV={usingClientEntryPoint:!1,Events:[rh,Os,Vs,kt,Oe,lS]},Qp={findFiberByHostInstance:bc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},HV={bundleType:Qp.bundleType,version:Qp.version,rendererPackageName:Qp.rendererPackageName,rendererConfig:Qp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(f){return f=oe(f),f===null?null:f.stateNode},findFiberByHostInstance:Qp.findFiberByHostInstance||UV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iw.isDisabled&&iw.supportsFiber)try{Er=iw.inject(HV),qr=iw}catch{}}return oo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WV,oo.createPortal=function(f,m){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xS(m))throw Error(r(200));return $V(f,m,null,T)},oo.createRoot=function(f,m){if(!xS(f))throw Error(r(299));var T=!1,D="",G=Fj;return m!=null&&(m.unstable_strictMode===!0&&(T=!0),m.identifierPrefix!==void 0&&(D=m.identifierPrefix),m.onRecoverableError!==void 0&&(G=m.onRecoverableError)),m=gS(f,1,!1,null,null,T,!1,D,G),f[Yo]=m.current,du(f.nodeType===8?f.parentNode:f),new pS(m)},oo.findDOMNode=function(f){if(f==null)return null;if(f.nodeType===1)return f;var m=f._reactInternals;if(m===void 0)throw typeof f.render=="function"?Error(r(188)):(f=Object.keys(f).join(","),Error(r(268,f)));return f=oe(m),f=f===null?null:f.stateNode,f},oo.flushSync=function(f){return hh(f)},oo.hydrate=function(f,m,T){if(!sw(m))throw Error(r(200));return aw(null,f,m,!0,T)},oo.hydrateRoot=function(f,m,T){if(!xS(f))throw Error(r(405));var D=T!=null&&T.hydratedSources||null,G=!1,Q="",de=Fj;if(T!=null&&(T.unstable_strictMode===!0&&(G=!0),T.identifierPrefix!==void 0&&(Q=T.identifierPrefix),T.onRecoverableError!==void 0&&(de=T.onRecoverableError)),m=jj(m,null,f,1,T??null,G,!1,Q,de),f[Yo]=m.current,du(f),D)for(f=0;f<D.length;f++)T=D[f],G=T._getVersion,G=G(T._source),m.mutableSourceEagerHydrationData==null?m.mutableSourceEagerHydrationData=[T,G]:m.mutableSourceEagerHydrationData.push(T,G);return new nw(m)},oo.render=function(f,m,T){if(!sw(m))throw Error(r(200));return aw(null,f,m,!1,T)},oo.unmountComponentAtNode=function(f){if(!sw(f))throw Error(r(40));return f._reactRootContainer?(hh(function(){aw(null,null,f,!1,function(){f._reactRootContainer=null,f[Yo]=null})}),!0):!1},oo.unstable_batchedUpdates=lS,oo.unstable_renderSubtreeIntoContainer=function(f,m,T,D){if(!sw(T))throw Error(r(200));if(f==null||f._reactInternals===void 0)throw Error(r(38));return aw(f,m,T,!1,D)},oo.version="18.3.1-next-f1338f8080-20240426",oo}var Uj;function xM(){if(Uj)return wS.exports;Uj=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),wS.exports=JV(),wS.exports}var zj;function QV(){if(zj)return ow;zj=1;var e=xM();return ow.createRoot=e.createRoot,ow.hydrateRoot=e.hydrateRoot,ow}var ZV=QV();const eK=Nl(ZV);var aT=xM();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fy(){return Fy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fy.apply(this,arguments)}var of;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(of||(of={}));const Wj="popstate";function tK(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return iT("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:vM(s)}return nK(t,r,null,e)}function ea(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function yM(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function rK(){return Math.random().toString(36).substr(2,8)}function Hj(e,t){return{usr:e.state,key:e.key,idx:t}}function iT(e,t,r,n){return r===void 0&&(r=null),Fy({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Om(t):t,{state:r,key:t&&t.key||n||rK()})}function vM(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Om(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function nK(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=of.Pop,l=null,u=d();u==null&&(u=0,i.replaceState(Fy({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function h(){o=of.Pop;let w=d(),C=w==null?null:w-u;u=w,l&&l({action:o,location:v.location,delta:C})}function g(w,C){o=of.Push;let k=iT(v.location,w,C);u=d()+1;let _=Hj(k,u),N=v.createHref(k);try{i.pushState(_,"",N)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;s.location.assign(N)}a&&l&&l({action:o,location:v.location,delta:1})}function p(w,C){o=of.Replace;let k=iT(v.location,w,C);u=d();let _=Hj(k,u),N=v.createHref(k);i.replaceState(_,"",N),a&&l&&l({action:o,location:v.location,delta:0})}function x(w){let C=s.location.origin!=="null"?s.location.origin:s.location.href,k=typeof w=="string"?w:vM(w);return k=k.replace(/ $/,"%20"),ea(C,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,C)}let v={get action(){return o},get location(){return e(s,i)},listen(w){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Wj,h),l=w,()=>{s.removeEventListener(Wj,h),l=null}},createHref(w){return t(s,w)},createURL:x,encodeLocation(w){let C=x(w);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:g,replace:p,go(w){return i.go(w)}};return v}var Gj;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Gj||(Gj={}));function sK(e,t,r){return r===void 0&&(r="/"),aK(e,t,r)}function aK(e,t,r,n){let s=typeof t=="string"?Om(t):t,a=_M(s.pathname||"/",r);if(a==null)return null;let i=wM(e);iK(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let u=yK(a);o=mK(i[l],u)}return o}function wM(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(ea(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=Ih([n,l.relativePath]),d=r.concat(l);a.children&&a.children.length>0&&(ea(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),wM(a.children,t,d,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:hK(u,a.index),routesMeta:d})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let l of bM(a.path))s(a,i,l)}),t}function bM(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=bM(n.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),s&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function iK(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:gK(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const oK=/^:[\w-]+$/,lK=3,cK=2,uK=1,dK=10,fK=-2,Vj=e=>e==="*";function hK(e,t){let r=e.split("/"),n=r.length;return r.some(Vj)&&(n+=fK),t&&(n+=cK),r.filter(s=>!Vj(s)).reduce((s,a)=>s+(oK.test(a)?lK:a===""?uK:dK),n)}function gK(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function mK(e,t,r){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,d=a==="/"?t:t.slice(a.length)||"/",h=pK({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),g=l.route;if(!h)return null;Object.assign(s,h.params),i.push({params:s,pathname:Ih([a,h.pathname]),pathnameBase:_K(Ih([a,h.pathnameBase])),route:g}),h.pathnameBase!=="/"&&(a=Ih([a,h.pathnameBase]))}return i}function pK(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=xK(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,d,h)=>{let{paramName:g,isOptional:p}=d;if(g==="*"){let v=o[h]||"";i=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const x=o[h];return p&&!x?u[g]=void 0:u[g]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:e}}function xK(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),yM(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function yK(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return yM(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function _M(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function vK(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Om(e):e;return{pathname:r?r.startsWith("/")?r:wK(r,t):t,search:SK(n),hash:kK(s)}}function wK(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function SS(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function bK(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function SM(e,t){let r=bK(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function kM(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=Om(e):(s=Fy({},e),ea(!s.pathname||!s.pathname.includes("?"),SS("?","pathname","search",s)),ea(!s.pathname||!s.pathname.includes("#"),SS("#","pathname","hash",s)),ea(!s.search||!s.search.includes("#"),SS("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let h=t.length-1;if(!n&&i.startsWith("..")){let g=i.split("/");for(;g[0]==="..";)g.shift(),h-=1;s.pathname=g.join("/")}o=h>=0?t[h]:"/"}let l=vK(s,o),u=i&&i!=="/"&&i.endsWith("/"),d=(a||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const Ih=e=>e.join("/").replace(/\/\/+/g,"/"),_K=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),SK=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,kK=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function CK(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const CM=["post","put","patch","delete"];new Set(CM);const TK=["get",...CM];new Set(TK);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oy(){return Oy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oy.apply(this,arguments)}const fN=S.createContext(null),EK=S.createContext(null),bv=S.createContext(null),j_=S.createContext(null),Nf=S.createContext({outlet:null,matches:[],isDataRoute:!1}),TM=S.createContext(null);function _v(){return S.useContext(j_)!=null}function P_(){return _v()||ea(!1),S.useContext(j_).location}function EM(e){S.useContext(bv).static||S.useLayoutEffect(e)}function vo(){let{isDataRoute:e}=S.useContext(Nf);return e?$K():NK()}function NK(){_v()||ea(!1);let e=S.useContext(fN),{basename:t,future:r,navigator:n}=S.useContext(bv),{matches:s}=S.useContext(Nf),{pathname:a}=P_(),i=JSON.stringify(SM(s,r.v7_relativeSplatPath)),o=S.useRef(!1);return EM(()=>{o.current=!0}),S.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let h=kM(u,JSON.parse(i),a,d.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Ih([t,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[t,n,i,a,e])}function F_(){let{matches:e}=S.useContext(Nf),t=e[e.length-1];return t?t.params:{}}function AK(e,t){return jK(e,t)}function jK(e,t,r,n){_v()||ea(!1);let{navigator:s}=S.useContext(bv),{matches:a}=S.useContext(Nf),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let u=P_(),d;if(t){var h;let w=typeof t=="string"?Om(t):t;l==="/"||(h=w.pathname)!=null&&h.startsWith(l)||ea(!1),d=w}else d=u;let g=d.pathname||"/",p=g;if(l!=="/"){let w=l.replace(/^\//,"").split("/");p="/"+g.replace(/^\//,"").split("/").slice(w.length).join("/")}let x=sK(e,{pathname:p}),v=RK(x&&x.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:Ih([l,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?l:Ih([l,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),a,r,n);return t&&v?S.createElement(j_.Provider,{value:{location:Oy({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:of.Pop}},v):v}function PK(){let e=BK(),t=CK(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},t),r?S.createElement("pre",{style:s},r):null,null)}const FK=S.createElement(PK,null);class OK extends S.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?S.createElement(Nf.Provider,{value:this.props.routeContext},S.createElement(TM.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function DK(e){let{routeContext:t,match:r,children:n}=e,s=S.useContext(fN);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),S.createElement(Nf.Provider,{value:t},n)}function RK(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=i.findIndex(h=>h.route.id&&o?.[h.route.id]!==void 0);d>=0||ea(!1),i=i.slice(0,Math.min(i.length,d+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<i.length;d++){let h=i[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:g,errors:p}=r,x=h.route.loader&&g[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||x){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,h,g)=>{let p,x=!1,v=null,w=null;r&&(p=o&&h.route.id?o[h.route.id]:void 0,v=h.route.errorElement||FK,l&&(u<0&&g===0?(UK("route-fallback"),x=!0,w=null):u===g&&(x=!0,w=h.route.hydrateFallbackElement||null)));let C=t.concat(i.slice(0,g+1)),k=()=>{let _;return p?_=v:x?_=w:h.route.Component?_=S.createElement(h.route.Component,null):h.route.element?_=h.route.element:_=d,S.createElement(DK,{match:h,routeContext:{outlet:d,matches:C,isDataRoute:r!=null},children:_})};return r&&(h.route.ErrorBoundary||h.route.errorElement||g===0)?S.createElement(OK,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:k(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):k()},null)}var NM=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(NM||{}),AM=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(AM||{});function IK(e){let t=S.useContext(fN);return t||ea(!1),t}function MK(e){let t=S.useContext(EK);return t||ea(!1),t}function LK(e){let t=S.useContext(Nf);return t||ea(!1),t}function jM(e){let t=LK(),r=t.matches[t.matches.length-1];return r.route.id||ea(!1),r.route.id}function BK(){var e;let t=S.useContext(TM),r=MK(),n=jM();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function $K(){let{router:e}=IK(NM.UseNavigateStable),t=jM(AM.UseNavigateStable),r=S.useRef(!1);return EM(()=>{r.current=!0}),S.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Oy({fromRouteId:t},a)))},[e,t])}const Kj={};function UK(e,t,r){Kj[e]||(Kj[e]=!0)}function zK(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath}function gm(e){let{to:t,replace:r,state:n,relative:s}=e;_v()||ea(!1);let{future:a,static:i}=S.useContext(bv),{matches:o}=S.useContext(Nf),{pathname:l}=P_(),u=vo(),d=kM(t,SM(o,a.v7_relativeSplatPath),l,s==="path"),h=JSON.stringify(d);return S.useEffect(()=>u(JSON.parse(h),{replace:r,state:n,relative:s}),[u,h,s,r,n]),null}function ks(e){ea(!1)}function WK(e){let{basename:t="/",children:r=null,location:n,navigationType:s=of.Pop,navigator:a,static:i=!1,future:o}=e;_v()&&ea(!1);let l=t.replace(/^\/*/,"/"),u=S.useMemo(()=>({basename:l,navigator:a,static:i,future:Oy({v7_relativeSplatPath:!1},o)}),[l,o,a,i]);typeof n=="string"&&(n=Om(n));let{pathname:d="/",search:h="",hash:g="",state:p=null,key:x="default"}=n,v=S.useMemo(()=>{let w=_M(d,l);return w==null?null:{location:{pathname:w,search:h,hash:g,state:p,key:x},navigationType:s}},[l,d,h,g,p,x,s]);return v==null?null:S.createElement(bv.Provider,{value:u},S.createElement(j_.Provider,{children:r,value:v}))}function hN(e){let{children:t,location:r}=e;return AK(oT(t),r)}new Promise(()=>{});function oT(e,t){t===void 0&&(t=[]);let r=[];return S.Children.forEach(e,(n,s)=>{if(!S.isValidElement(n))return;let a=[...t,s];if(n.type===S.Fragment){r.push.apply(r,oT(n.props.children,a));return}n.type!==ks&&ea(!1),!n.props.index||!n.props.children||ea(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=oT(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const HK="6";try{window.__reactRouterVersion=HK}catch{}const GK="startTransition",qj=pM[GK];function VK(e){let{basename:t,children:r,future:n,window:s}=e,a=S.useRef();a.current==null&&(a.current=tK({window:s,v5Compat:!0}));let i=a.current,[o,l]=S.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},d=S.useCallback(h=>{u&&qj?qj(()=>l(h)):l(h)},[l,u]);return S.useLayoutEffect(()=>i.listen(d),[i,d]),S.useEffect(()=>zK(n),[n]),S.createElement(WK,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}var Yj;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Yj||(Yj={}));var Xj;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Xj||(Xj={}));const Ts={student_subjects:1800*1e3,student_active_tests:600*1e3,student_results_table:600*1e3,teacher_subjects:900*1e3,teacher_classes:900*1e3,teacher_tests:600*1e3,teacher_results_table:600*1e3,admin_users:1200*1e3,admin_teachers:1200*1e3,admin_subjects:1800*1e3,admin_academic_years:3600*1e3,admin_tests:900*1e3,admin_results_table:null,admin_teacher_id:3600*1e3,all_tests:1200*1e3,subjects_dropdown:1800*1e3,grades_classes:3600*1e3,test_progress:120*1e3,anti_cheating:120*1e3,word_matching_test:600*1e3,speaking_test_data:3600*1e3},Es=e=>{try{const t=localStorage.getItem(e);if(!t)return console.log(" Cache: No data found for key:",e),null;const{data:r,timestamp:n,ttl:s}=JSON.parse(t),a=Date.now()-n;return a>s?(console.log(" Cache: Data expired for key:",e,"age:",a,"ttl:",s),localStorage.removeItem(e),null):(console.log(" Cache: Data found for key:",e,"age:",a,"ttl:",s),r)}catch(t){return console.log(" Cache: Corrupted data for key:",e,t),localStorage.removeItem(e),null}},us=(e,t,r)=>{try{console.log(" Cache: Setting data for key:",e,"ttl:",r),localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached successfully for key:",e)}catch{console.log(" Cache: Storage full, cleaning old data for key:",e),PM();try{localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached after cleanup for key:",e)}catch{console.warn("Storage full, cannot cache data")}}},PM=()=>{const e=Date.now(),t=Object.keys(localStorage);t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i,ttl:o}=JSON.parse(a);e-i>o&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const r=e-10080*60*1e3;t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i}=JSON.parse(a);i<r&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const n=Object.keys(localStorage);if(n.length>0){const s=n.map(i=>{try{const o=localStorage.getItem(i);if(o){const{timestamp:l}=JSON.parse(o);return{key:i,timestamp:l}}}catch{return{key:i,timestamp:0}}return{key:i,timestamp:0}}),a=Math.ceil(s.length*.25);s.sort((i,o)=>i.timestamp-o.timestamp).slice(0,a).forEach(({key:i})=>localStorage.removeItem(i))}},gN=e=>{Object.keys(localStorage).forEach(r=>{r.includes(e)&&localStorage.removeItem(r)})},Dm=(e,t,r)=>{const n=`test_progress_${e}_${t}_${r}`,s=`anti_cheating_${e}_${t}_${r}`;if(localStorage.removeItem(n),localStorage.removeItem(s),t==="speaking_test_data"){const a=`speaking_test_data_${e}_${r}`;localStorage.removeItem(a),console.log(`Cleared speaking test data cache for ${r}`)}console.log(`Cleared test data for ${t}_${r}`)},Hg=Object.freeze(Object.defineProperty({__proto__:null,CACHE_TTL:Ts,cleanupOldData:PM,clearTestData:Dm,clearUserData:gN,getCachedData:Es,setCachedData:us},Symbol.toStringTag,{value:"Module"})),FM=S.createContext(),OM=({children:e})=>{const[t,r]=S.useState(null),[n,s]=S.useState(null),[a,i]=S.useState(localStorage.getItem("token")),[o,l]=S.useState(!1),[u,d]=S.useState(!0),[h,g]=S.useState(null);S.useEffect(()=>{console.log("[AUTH] Initializing application session..."),w()},[]),S.useEffect(()=>{if(o&&a){console.log("[AUTH] Setting up proactive token refresh...");let W=!1;const I=setInterval(async()=>{if(o&&a&&!W){W=!0;try{const B=a||localStorage.getItem("auth_token");if(B&&p(B))console.log("[AUTH] Token expired, attempting refresh..."),await x()||console.log("[AUTH] Proactive refresh failed, but user remains logged in");else if(B)try{const J=JSON.parse(atob(B.split(".")[1])).exp*1e3,se=Date.now(),X=J-se;X<300*1e3&&X>0&&(console.log(`[AUTH] Token expires in ${Math.round(X/1e3)} seconds, refreshing...`),await x()||console.log("[AUTH] Proactive refresh failed, but user remains logged in"))}catch(q){console.error("[AUTH] Error parsing token for expiration check:",q)}}catch(B){console.error("[AUTH] Error in proactive refresh:",B)}finally{W=!1}}},300*1e3);return()=>{console.log("[AUTH] Clearing proactive token refresh interval"),clearInterval(I)}}},[o,a]);const p=W=>{if(!W)return!0;try{if(typeof W!="string"||!W.includes("."))return console.warn("[AUTH] Invalid token format - not a JWT"),!0;const I=W.split(".");if(I.length!==3)return console.warn("[AUTH] Invalid token format - not 3 parts"),!0;const B=JSON.parse(atob(I[1])),q=Date.now()/1e3;return B.exp<=q}catch(I){if(console.error("[AUTH] Error decoding token:",I),console.warn("[AUTH] Token appears to be corrupted - clearing authentication"),localStorage.removeItem("auth_token"),localStorage.removeItem("accessToken"),localStorage.removeItem("refresh_token"),localStorage.removeItem("userData"),window.tokenManager)try{window.tokenManager.clearTokens()}catch(B){console.warn("[AUTH] Error clearing token manager:",B)}return!0}},x=async()=>{const W=localStorage.getItem("refresh_token");if(!W)return console.log("[AUTH] No refresh token found"),!1;try{const I=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:W})});if(I.ok){const B=await I.json();console.log("[AUTH] Token refresh successful"),localStorage.setItem("auth_token",B.accessToken),localStorage.setItem("refresh_token",B.refreshToken),localStorage.setItem("accessToken",B.accessToken);try{window.tokenManager&&(window.tokenManager.setToken(B.accessToken),B.refreshToken&&window.tokenManager.setRefreshToken(B.refreshToken))}catch{}return i(B.accessToken),!0}else return console.error("[AUTH] Token refresh failed:",I.status),!1}catch(I){return console.error("[AUTH] Token refresh error:",I),!1}},v=async(W,I={})=>{const B=a||localStorage.getItem("auth_token");if(!B)throw new Error("No authentication token found");const q={"Content-Type":"application/json",Authorization:`Bearer ${B}`,...I.headers},J=await fetch(W,{...I,headers:q});if(J.status===401)if(console.log("[AUTH] 401 error, attempting token refresh..."),await x()){const X=localStorage.getItem("auth_token");return q.Authorization=`Bearer ${X}`,fetch(W,{...I,headers:q})}else throw console.log("[AUTH] Token refresh failed, returning 401 response"),new Error("Authentication failed - please login again");return J},w=async()=>{try{console.log("[AUTH] Starting session initialization..."),d(!0);const W=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token"),I=localStorage.getItem("user_data")||localStorage.getItem("userData"),B=I?JSON.parse(I).role:null;if(console.log("[AUTH] Found stored data:",{hasToken:!!W,hasUser:!!I,role:B}),W&&B&&I)try{const q=JSON.parse(I);if(p(W))if(console.log("[AUTH] Token expired, attempting refresh..."),await x()){console.log("[AUTH] Token refreshed successfully");const se=localStorage.getItem("auth_token");i(se)}else console.log("[AUTH] Token refresh failed, but continuing with existing token..."),i(W);else i(W);s(B),r(q);try{if(window.tokenManager){window.tokenManager.setToken(localStorage.getItem("auth_token"));const J=localStorage.getItem("refresh_token");J&&window.tokenManager.setRefreshToken(J)}}catch{}l(!0),await _(q,B)}catch(q){console.error("[AUTH] Error parsing stored user data:",q),console.log("[AUTH] Invalid user data, but not forcing logout - continuing with empty state"),l(!1)}}catch(W){console.error("[AUTH] Session initialization error:",W),console.log("[AUTH] Initialization error, but not forcing logout - continuing with empty state"),l(!1)}finally{console.log("[AUTH] Session initialization complete"),d(!1)}},C=async W=>{try{if(d(!0),g(null),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),g("Please wait for the logout process to complete.");return}console.log("Attempting login with:",W.username);let I,B;W.username==="admin"?(I={ok:!0,json:()=>({success:!0,token:"test-token"})},B="admin"):(I=await authService.teacherLogin(W),B="teacher");const q=await I.json();await k(I,B,q)}catch(I){A(I)}finally{d(!1)}},k=async(W,I,B)=>{try{if(W.ok&&B.success&&B.token){i(B.token),s(I),r(B),l(!0),localStorage.setItem("auth_token",B.accessToken||B.token),localStorage.setItem("refresh_token",B.refreshToken),localStorage.setItem("user_data",JSON.stringify(B)),localStorage.setItem("accessToken",B.accessToken||B.token);try{const q=Date.now(),J=10080*60*1e3,se=[];for(let X=0;X<localStorage.length;X++){const ie=localStorage.key(X);if(!(!ie||!(ie.startsWith("test_progress_")||ie.startsWith("test_timer_")||ie.startsWith("test_shuffle_order_")||ie.startsWith("student_results_table_")||ie.startsWith("anti_cheating_"))))try{const ce=localStorage.getItem(ie);if(!ce){se.push(ie);continue}let ke=null;if(ce.startsWith("{")||ce.startsWith("[")){const re=JSON.parse(ce),ge=re.timestamp||re.lastSaved||re.lastTickAt||re.createdAt||re.updatedAt||re.startedAt||re.started_at;ge&&(ke=new Date(ge).getTime())}if(!ke){const re=`${ie}__ts`,ge=localStorage.getItem(re);ge&&(ke=parseInt(ge)||null)}if(!ke)continue;q-ke>J&&se.push(ie)}catch{}}se.forEach(X=>{try{localStorage.removeItem(X)}catch{}})}catch(q){console.warn("LocalStorage cleanup skipped:",q)}return await _(B,I),!0}else{const q=B.message||W.statusText||"Login failed";return A(new Error(q)),!1}}catch(q){return A(q),!1}},_=async(W,I)=>{try{switch(I){case"admin":console.log("Admin login successful, role:",W.role),console.log("Admin logged in:",W);break;case"teacher":console.log("Teacher login successful, role:",W.role),console.log("Teacher data:",W.teacher),await E(W),await F();break;case"student":console.log("Student login successful"),N(W);break;default:console.warn("Unknown user role:",I)}}catch(B){console.error("Post-login actions error:",B)}},N=W=>{r(W),console.log("Student info populated:",W)},E=async W=>{r(W),console.log("Teacher info populated:",W)},P=async()=>{try{console.log("Initializing teacher cabinet...")}catch(W){console.error("Error initializing teacher cabinet:",W)}},F=async()=>{try{console.log("Checking teacher subjects...")}catch(W){console.error("Error checking teacher subjects:",W)}},A=W=>{g(W.message||"Login failed"),j()},j=()=>{g(null),d(!1)},R=S.useCallback(()=>{U()},[]),U=()=>{r(null),s(null),i(null),l(!1),g(null);const W=t?.student_id||t?.teacher_id||t?.admin_id||t?.id;W&&gN(W),localStorage.removeItem("token"),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),localStorage.removeItem("auth_token"),localStorage.removeItem("user_data"),localStorage.removeItem("user_role"),localStorage.removeItem("accessToken"),localStorage.removeItem("testProgress"),localStorage.removeItem("formData"),window.tokenManager&&window.tokenManager.clearAuth(),setTimeout(()=>{Y()},100)},Y=()=>{console.log("Interface reset after session clear - redirecting to login"),window.location.replace("/login")},Z=()=>t?.id||null,ae=()=>n==="admin"?t:null,ee=()=>n==="admin",ne=()=>ee()?t?.admin_id:null,L=()=>n==="teacher"?t?.username:null,H=()=>{console.log("Auth functions available:",{handleUnifiedLogin:typeof C,logout:typeof R,getCurrentTeacherId:typeof Z,isAdmin:typeof ee,getCurrentAdmin:typeof ae,getCurrentAdminId:typeof ne,getCurrentTeacherUsername:typeof L})};S.useEffect(()=>(window.logout=R,window.getCurrentTeacherId=Z,window.getCurrentAdmin=ae,window.isAdmin=ee,window.getCurrentAdminId=ne,window.getCurrentTeacherUsername=L,window.checkFunctionAvailability=H,()=>{delete window.logout,delete window.getCurrentTeacherId,delete window.getCurrentAdmin,delete window.isAdmin,delete window.getCurrentAdminId,delete window.getCurrentTeacherUsername,delete window.checkFunctionAvailability}),[R]);const M=S.useCallback(W=>{console.log("Setting user data from external auth:",W),r(W),s(W.role),i(W.token),l(!0),d(!1),g(null),localStorage.setItem("auth_token",W.token),localStorage.setItem("user_data",JSON.stringify(W)),localStorage.setItem("accessToken",W.token)},[]),V={user:t,role:n,token:a,isAuthenticated:o,isLoading:u,error:h,login:C,setUserData:M,logout:R,resetLoginForm:j,forceCompleteLogout:U,initializeApplicationSession:w,makeAuthenticatedRequest:v,populateStudentInfo:N,populateTeacherInfo:E,initializeTeacherCabinet:P,checkTeacherSubjects:F,getCurrentTeacherId:Z,getCurrentAdmin:ae,isAdmin:ee,getCurrentAdminId:ne,getCurrentTeacherUsername:L,handleLoginResponse:k,handlePostLoginActions:_,handleLoginFailure:A,resetInterfaceAfterSessionClear:Y,checkFunctionAvailability:H};return c.jsx(FM.Provider,{value:V,children:e})},Qn=()=>{const e=S.useContext(FM);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};class KK{constructor(){this.baseURL="http://localhost:8888/.netlify/functions",this.timeout=1e4,this.retryCount=3,this.retryDelay=1e3}getHeaders(){const t=localStorage.getItem("token");return{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`}}}async sendRequest(t,r){try{return await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(n){throw console.error(" Network error:",n),n}}async request(t,r={}){const n=`${this.baseURL}${t}`,s={method:"GET",headers:this.getHeaders(),timeout:this.timeout,...r};let a;for(let i=0;i<this.retryCount;i++)try{const o=new AbortController,l=setTimeout(()=>o.abort(),this.timeout),u=await fetch(n,{...s,signal:o.signal});if(clearTimeout(l),!u.ok)throw new Error(`HTTP error! status: ${u.status}`);return await u.json()}catch(o){if(a=o,o.name==="AbortError")throw new Error("Request timeout");i<this.retryCount-1&&(console.warn(`Request failed, retrying in ${this.retryDelay}ms... (attempt ${i+1}/${this.retryCount})`),await new Promise(l=>setTimeout(l,this.retryDelay*Math.pow(2,i))))}throw a}async get(t,r={}){return this.request(t,{...r,method:"GET"})}async post(t,r,n={}){return this.request(t,{...n,method:"POST",body:JSON.stringify(r)})}async put(t,r,n={}){return this.request(t,{...n,method:"PUT",body:JSON.stringify(r)})}async delete(t,r={}){return this.request(t,{...r,method:"DELETE"})}async patch(t,r,n={}){return this.request(t,{...n,method:"PATCH",body:JSON.stringify(r)})}async uploadFile(t,r,n={}){const s=new FormData;s.append("file",r);const a=`${this.baseURL}${t}`,i={method:"POST",headers:{...localStorage.getItem("token")&&{Authorization:`Bearer ${localStorage.getItem("token")}`}},body:s,...n};try{const o=await fetch(a,i);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw o}}async downloadFile(t,r,n={}){const s=`${this.baseURL}${t}`,a={method:"GET",headers:this.getHeaders(),...n};try{const i=await fetch(s,a);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const o=await i.blob(),l=window.URL.createObjectURL(o),u=document.createElement("a");u.href=l,u.download=r,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(l)}catch(i){throw i}}ensureDebugOutput(){let t=document.getElementById("debug-output");return t||(t=document.createElement("div"),t.id="debug-output",t.className="fixed top-4 right-4 w-96 max-h-96 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-50 overflow-auto",t.innerHTML='<div class="text-sm font-mono text-gray-800">Debug Output</div>',document.body.appendChild(t)),t}async testDbConnection(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/test-db-connection")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Database Connection Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,message:"Database connection successful",data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Database Connection Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,message:"Database connection failed",error:t.message}}}async testStudentLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:"51706",password:"1"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Student Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Student Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testTeacherLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"Aleksandr_Petrov",password:"465"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Teacher Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Teacher Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testAdminLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"admin",password:"admin123"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Admin Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Admin Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetTeacherSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-teacher-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Teacher Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Teacher Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetClassResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-class-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Class Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Class Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentTestResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-test-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Test Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Test Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testEndpoints(){const t=["/debug/test-student-login","/debug/test-teacher-login","/debug/test-admin-login","/debug/test-get-subjects","/debug/test-get-teacher-subjects","/debug/test-get-class-results","/debug/test-get-student-subjects","/debug/test-get-student-test-results"],r={};for(const n of t)try{const s=await this.get(n);r[n]={success:!0,data:s}}catch(s){r[n]={success:!1,error:s.message}}return r}async debugFunction(t){const r=this.ensureDebugOutput();try{let n;switch(t){case"testDbConnection":n=await this.testDbConnection();break;case"testStudentLogin":n=await this.testStudentLogin();break;case"testTeacherLogin":n=await this.testTeacherLogin();break;case"testAdminLogin":n=await this.testAdminLogin();break;case"testGetSubjects":n=await this.testGetSubjects();break;case"testGetTeacherSubjects":n=await this.testGetTeacherSubjects();break;case"testGetClassResults":n=await this.testGetClassResults();break;case"testGetStudentSubjects":n=await this.testGetStudentSubjects();break;case"testGetStudentTestResults":n=await this.testGetStudentTestResults();break;default:throw new Error(`Unknown debug function: ${t}`)}return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Debug Function: ${t}</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),n}catch(n){throw r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Debug Function Error: ${t}</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${n.message}</pre>
        `),n}}showDebugFunctions(){const t=this.ensureDebugOutput(),r=`
      <div class="text-sm font-mono text-gray-800 mb-4">Debug Functions</div>
      <div class="grid grid-cols-2 gap-2 mb-4">
        <button onclick="apiClient.testDbConnection()" class="px-3 py-2 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition-colors">
          Test DB Connection
        </button>
        <button onclick="apiClient.testStudentLogin()" class="px-3 py-2 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors">
          Test Student Login
        </button>
        <button onclick="apiClient.testTeacherLogin()" class="px-3 py-2 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600 transition-colors">
          Test Teacher Login
        </button>
        <button onclick="apiClient.testAdminLogin()" class="px-3 py-2 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors">
          Test Admin Login
        </button>
        <button onclick="apiClient.testGetSubjects()" class="px-3 py-2 bg-purple-500 text-white text-xs rounded hover:bg-purple-600 transition-colors">
          Test Get Subjects
        </button>
        <button onclick="apiClient.testGetTeacherSubjects()" class="px-3 py-2 bg-indigo-500 text-white text-xs rounded hover:bg-indigo-600 transition-colors">
          Test Get Teacher Subjects
        </button>
        <button onclick="apiClient.testGetClassResults()" class="px-3 py-2 bg-pink-500 text-white text-xs rounded hover:bg-pink-600 transition-colors">
          Test Get Class Results
        </button>
        <button onclick="apiClient.testGetStudentSubjects()" class="px-3 py-2 bg-teal-500 text-white text-xs rounded hover:bg-teal-600 transition-colors">
          Test Get Student Subjects
        </button>
        <button onclick="apiClient.testGetStudentTestResults()" class="px-3 py-2 bg-orange-500 text-white text-xs rounded hover:bg-orange-600 transition-colors">
          Test Get Student Test Results
        </button>
        <button onclick="apiClient.testEndpoints()" class="px-3 py-2 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 transition-colors">
          Test All Endpoints
        </button>
      </div>
    `;t.innerHTML=r}}const vs=new KK,mN=S.createContext({});function pN(e){const t=S.useRef(null);return t.current===null&&(t.current=e()),t.current}const xN=typeof window<"u",DM=xN?S.useLayoutEffect:S.useEffect,O_=S.createContext(null);function yN(e,t){e.indexOf(t)===-1&&e.push(t)}function vN(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const qu=(e,t,r)=>r>t?t:r<e?e:r;let wN=()=>{};const Yu={},RM=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function IM(e){return typeof e=="object"&&e!==null}const MM=e=>/^0[^.\s]+$/u.test(e);function bN(e){let t;return()=>(t===void 0&&(t=e()),t)}const wl=e=>e,qK=(e,t)=>r=>t(e(r)),Sv=(...e)=>e.reduce(qK),Dy=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class _N{constructor(){this.subscriptions=[]}add(t){return yN(this.subscriptions,t),()=>vN(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let a=0;a<s;a++){const i=this.subscriptions[a];i&&i(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Wc=e=>e*1e3,Hc=e=>e/1e3;function LM(e,t){return t?e*(1e3/t):0}const BM=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,YK=1e-7,XK=12;function JK(e,t,r,n,s){let a,i,o=0;do i=t+(r-t)/2,a=BM(i,n,s)-e,a>0?r=i:t=i;while(Math.abs(a)>YK&&++o<XK);return i}function kv(e,t,r,n){if(e===t&&r===n)return wl;const s=a=>JK(a,0,1,e,r);return a=>a===0||a===1?a:BM(s(a),t,n)}const $M=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,UM=e=>t=>1-e(1-t),zM=kv(.33,1.53,.69,.99),SN=UM(zM),WM=$M(SN),HM=e=>(e*=2)<1?.5*SN(e):.5*(2-Math.pow(2,-10*(e-1))),kN=e=>1-Math.sin(Math.acos(e)),GM=UM(kN),VM=$M(kN),QK=kv(.42,0,1,1),ZK=kv(0,0,.58,1),KM=kv(.42,0,.58,1),eq=e=>Array.isArray(e)&&typeof e[0]!="number",qM=e=>Array.isArray(e)&&typeof e[0]=="number",tq={linear:wl,easeIn:QK,easeInOut:KM,easeOut:ZK,circIn:kN,circInOut:VM,circOut:GM,backIn:SN,backInOut:WM,backOut:zM,anticipate:HM},rq=e=>typeof e=="string",Jj=e=>{if(qM(e)){wN(e.length===4);const[t,r,n,s]=e;return kv(t,r,n,s)}else if(rq(e))return tq[e];return e},lw=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function nq(e,t){let r=new Set,n=new Set,s=!1,a=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(d){i.has(d)&&(u.schedule(d),e()),d(o)}const u={schedule:(d,h=!1,g=!1)=>{const x=g&&s?r:n;return h&&i.add(d),x.has(d)||x.add(d),d},cancel:d=>{n.delete(d),i.delete(d)},process:d=>{if(o=d,s){a=!0;return}s=!0,[r,n]=[n,r],r.forEach(l),r.clear(),s=!1,a&&(a=!1,u.process(d))}};return u}const sq=40;function YM(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=lw.reduce((_,N)=>(_[N]=nq(a),_),{}),{setup:o,read:l,resolveKeyframes:u,preUpdate:d,update:h,preRender:g,render:p,postRender:x}=i,v=()=>{const _=Yu.useManualTiming?s.timestamp:performance.now();r=!1,Yu.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(_-s.timestamp,sq),1)),s.timestamp=_,s.isProcessing=!0,o.process(s),l.process(s),u.process(s),d.process(s),h.process(s),g.process(s),p.process(s),x.process(s),s.isProcessing=!1,r&&t&&(n=!1,e(v))},w=()=>{r=!0,n=!0,s.isProcessing||e(v)};return{schedule:lw.reduce((_,N)=>{const E=i[N];return _[N]=(P,F=!1,A=!1)=>(r||w(),E.schedule(P,F,A)),_},{}),cancel:_=>{for(let N=0;N<lw.length;N++)i[lw[N]].cancel(_)},state:s,steps:i}}const{schedule:ss,cancel:vf,state:Xa,steps:kS}=YM(typeof requestAnimationFrame<"u"?requestAnimationFrame:wl,!0);let Xw;function aq(){Xw=void 0}const ho={now:()=>(Xw===void 0&&ho.set(Xa.isProcessing||Yu.useManualTiming?Xa.timestamp:performance.now()),Xw),set:e=>{Xw=e,queueMicrotask(aq)}},XM=e=>t=>typeof t=="string"&&t.startsWith(e),CN=XM("--"),iq=XM("var(--"),TN=e=>iq(e)?oq.test(e.split("/*")[0].trim()):!1,oq=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Rm={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Ry={...Rm,transform:e=>qu(0,1,e)},cw={...Rm,default:1},fy=e=>Math.round(e*1e5)/1e5,EN=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function lq(e){return e==null}const cq=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,NN=(e,t)=>r=>!!(typeof r=="string"&&cq.test(r)&&r.startsWith(e)||t&&!lq(r)&&Object.prototype.hasOwnProperty.call(r,t)),JM=(e,t,r)=>n=>{if(typeof n!="string")return n;const[s,a,i,o]=n.match(EN);return{[e]:parseFloat(s),[t]:parseFloat(a),[r]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},uq=e=>qu(0,255,e),CS={...Rm,transform:e=>Math.round(uq(e))},Nh={test:NN("rgb","red"),parse:JM("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+CS.transform(e)+", "+CS.transform(t)+", "+CS.transform(r)+", "+fy(Ry.transform(n))+")"};function dq(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const lT={test:NN("#"),parse:dq,transform:Nh.transform},Cv=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),tf=Cv("deg"),Gc=Cv("%"),Fr=Cv("px"),fq=Cv("vh"),hq=Cv("vw"),Qj={...Gc,parse:e=>Gc.parse(e)/100,transform:e=>Gc.transform(e*100)},Gg={test:NN("hsl","hue"),parse:JM("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+Gc.transform(fy(t))+", "+Gc.transform(fy(r))+", "+fy(Ry.transform(n))+")"},Qs={test:e=>Nh.test(e)||lT.test(e)||Gg.test(e),parse:e=>Nh.test(e)?Nh.parse(e):Gg.test(e)?Gg.parse(e):lT.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Nh.transform(e):Gg.transform(e),getAnimatableNone:e=>{const t=Qs.parse(e);return t.alpha=0,Qs.transform(t)}},gq=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function mq(e){return isNaN(e)&&typeof e=="string"&&(e.match(EN)?.length||0)+(e.match(gq)?.length||0)>0}const QM="number",ZM="color",pq="var",xq="var(",Zj="${}",yq=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Iy(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},s=[];let a=0;const o=t.replace(yq,l=>(Qs.test(l)?(n.color.push(a),s.push(ZM),r.push(Qs.parse(l))):l.startsWith(xq)?(n.var.push(a),s.push(pq),r.push(l)):(n.number.push(a),s.push(QM),r.push(parseFloat(l))),++a,Zj)).split(Zj);return{values:r,split:o,indexes:n,types:s}}function e7(e){return Iy(e).values}function t7(e){const{split:t,types:r}=Iy(e),n=t.length;return s=>{let a="";for(let i=0;i<n;i++)if(a+=t[i],s[i]!==void 0){const o=r[i];o===QM?a+=fy(s[i]):o===ZM?a+=Qs.transform(s[i]):a+=s[i]}return a}}const vq=e=>typeof e=="number"?0:Qs.test(e)?Qs.getAnimatableNone(e):e;function wq(e){const t=e7(e);return t7(e)(t.map(vq))}const wf={test:mq,parse:e7,createTransformer:t7,getAnimatableNone:wq};function TS(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function bq({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,a=0,i=0;if(!t)s=a=i=r;else{const o=r<.5?r*(1+t):r+t-r*t,l=2*r-o;s=TS(l,o,e+1/3),a=TS(l,o,e),i=TS(l,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:n}}function ub(e,t){return r=>r>0?t:e}const ds=(e,t,r)=>e+(t-e)*r,ES=(e,t,r)=>{const n=e*e,s=r*(t*t-n)+n;return s<0?0:Math.sqrt(s)},_q=[lT,Nh,Gg],Sq=e=>_q.find(t=>t.test(e));function e5(e){const t=Sq(e);if(!t)return!1;let r=t.parse(e);return t===Gg&&(r=bq(r)),r}const t5=(e,t)=>{const r=e5(e),n=e5(t);if(!r||!n)return ub(e,t);const s={...r};return a=>(s.red=ES(r.red,n.red,a),s.green=ES(r.green,n.green,a),s.blue=ES(r.blue,n.blue,a),s.alpha=ds(r.alpha,n.alpha,a),Nh.transform(s))},cT=new Set(["none","hidden"]);function kq(e,t){return cT.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function Cq(e,t){return r=>ds(e,t,r)}function AN(e){return typeof e=="number"?Cq:typeof e=="string"?TN(e)?ub:Qs.test(e)?t5:Nq:Array.isArray(e)?r7:typeof e=="object"?Qs.test(e)?t5:Tq:ub}function r7(e,t){const r=[...e],n=r.length,s=e.map((a,i)=>AN(a)(a,t[i]));return a=>{for(let i=0;i<n;i++)r[i]=s[i](a);return r}}function Tq(e,t){const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=AN(e[s])(e[s],t[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}}function Eq(e,t){const r=[],n={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const a=t.types[s],i=e.indexes[a][n[a]],o=e.values[i]??0;r[s]=o,n[a]++}return r}const Nq=(e,t)=>{const r=wf.createTransformer(t),n=Iy(e),s=Iy(t);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?cT.has(e)&&!s.values.length||cT.has(t)&&!n.values.length?kq(e,t):Sv(r7(Eq(n,s),s.values),r):ub(e,t)};function n7(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?ds(e,t,r):AN(e)(e,t)}const Aq=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>ss.update(t,r),stop:()=>vf(t),now:()=>Xa.isProcessing?Xa.timestamp:ho.now()}},s7=(e,t,r=10)=>{let n="";const s=Math.max(Math.round(t/r),2);for(let a=0;a<s;a++)n+=Math.round(e(a/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},db=2e4;function jN(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<db;)t+=r,n=e.next(t);return t>=db?1/0:t}function jq(e,t=100,r){const n=r({...e,keyframes:[0,t]}),s=Math.min(jN(n),db);return{type:"keyframes",ease:a=>n.next(s*a).value/t,duration:Hc(s)}}const Pq=5;function a7(e,t,r){const n=Math.max(t-Pq,0);return LM(r-e(n),t-n)}const bs={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},NS=.001;function Fq({duration:e=bs.duration,bounce:t=bs.bounce,velocity:r=bs.velocity,mass:n=bs.mass}){let s,a,i=1-t;i=qu(bs.minDamping,bs.maxDamping,i),e=qu(bs.minDuration,bs.maxDuration,Hc(e)),i<1?(s=u=>{const d=u*i,h=d*e,g=d-r,p=uT(u,i),x=Math.exp(-h);return NS-g/p*x},a=u=>{const h=u*i*e,g=h*r+r,p=Math.pow(i,2)*Math.pow(u,2)*e,x=Math.exp(-h),v=uT(Math.pow(u,2),i);return(-s(u)+NS>0?-1:1)*((g-p)*x)/v}):(s=u=>{const d=Math.exp(-u*e),h=(u-r)*e+1;return-NS+d*h},a=u=>{const d=Math.exp(-u*e),h=(r-u)*(e*e);return d*h});const o=5/e,l=Dq(s,a,o);if(e=Wc(e),isNaN(l))return{stiffness:bs.stiffness,damping:bs.damping,duration:e};{const u=Math.pow(l,2)*n;return{stiffness:u,damping:i*2*Math.sqrt(n*u),duration:e}}}const Oq=12;function Dq(e,t,r){let n=r;for(let s=1;s<Oq;s++)n=n-e(n)/t(n);return n}function uT(e,t){return e*Math.sqrt(1-t*t)}const Rq=["duration","bounce"],Iq=["stiffness","damping","mass"];function r5(e,t){return t.some(r=>e[r]!==void 0)}function Mq(e){let t={velocity:bs.velocity,stiffness:bs.stiffness,damping:bs.damping,mass:bs.mass,isResolvedFromDuration:!1,...e};if(!r5(e,Iq)&&r5(e,Rq))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,a=2*qu(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:bs.mass,stiffness:s,damping:a}}else{const r=Fq(e);t={...t,...r,mass:bs.mass},t.isResolvedFromDuration=!0}return t}function fb(e=bs.visualDuration,t=bs.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:s}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],o={done:!1,value:a},{stiffness:l,damping:u,mass:d,duration:h,velocity:g,isResolvedFromDuration:p}=Mq({...r,velocity:-Hc(r.velocity||0)}),x=g||0,v=u/(2*Math.sqrt(l*d)),w=i-a,C=Hc(Math.sqrt(l/d)),k=Math.abs(w)<5;n||(n=k?bs.restSpeed.granular:bs.restSpeed.default),s||(s=k?bs.restDelta.granular:bs.restDelta.default);let _;if(v<1){const E=uT(C,v);_=P=>{const F=Math.exp(-v*C*P);return i-F*((x+v*C*w)/E*Math.sin(E*P)+w*Math.cos(E*P))}}else if(v===1)_=E=>i-Math.exp(-C*E)*(w+(x+C*w)*E);else{const E=C*Math.sqrt(v*v-1);_=P=>{const F=Math.exp(-v*C*P),A=Math.min(E*P,300);return i-F*((x+v*C*w)*Math.sinh(A)+E*w*Math.cosh(A))/E}}const N={calculatedDuration:p&&h||null,next:E=>{const P=_(E);if(p)o.done=E>=h;else{let F=E===0?x:0;v<1&&(F=E===0?Wc(x):a7(_,E,P));const A=Math.abs(F)<=n,j=Math.abs(i-P)<=s;o.done=A&&j}return o.value=o.done?i:P,o},toString:()=>{const E=Math.min(jN(N),db),P=s7(F=>N.next(E*F).value,E,30);return E+"ms "+P},toTransition:()=>{}};return N}fb.applyToOptions=e=>{const t=jq(e,100,fb);return e.ease=t.ease,e.duration=Wc(t.duration),e.type="keyframes",e};function dT({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:i,min:o,max:l,restDelta:u=.5,restSpeed:d}){const h=e[0],g={done:!1,value:h},p=A=>o!==void 0&&A<o||l!==void 0&&A>l,x=A=>o===void 0?l:l===void 0||Math.abs(o-A)<Math.abs(l-A)?o:l;let v=r*t;const w=h+v,C=i===void 0?w:i(w);C!==w&&(v=C-h);const k=A=>-v*Math.exp(-A/n),_=A=>C+k(A),N=A=>{const j=k(A),R=_(A);g.done=Math.abs(j)<=u,g.value=g.done?C:R};let E,P;const F=A=>{p(g.value)&&(E=A,P=fb({keyframes:[g.value,x(g.value)],velocity:a7(_,A,g.value),damping:s,stiffness:a,restDelta:u,restSpeed:d}))};return F(0),{calculatedDuration:null,next:A=>{let j=!1;return!P&&E===void 0&&(j=!0,N(A),F(A)),E!==void 0&&A>=E?P.next(A-E):(!j&&N(A),g)}}}function Lq(e,t,r){const n=[],s=r||Yu.mix||n7,a=e.length-1;for(let i=0;i<a;i++){let o=s(e[i],e[i+1]);if(t){const l=Array.isArray(t)?t[i]||wl:t;o=Sv(l,o)}n.push(o)}return n}function Bq(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const a=e.length;if(wN(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=Lq(t,n,s),l=o.length,u=d=>{if(i&&d<e[0])return t[0];let h=0;if(l>1)for(;h<e.length-2&&!(d<e[h+1]);h++);const g=Dy(e[h],e[h+1],d);return o[h](g)};return r?d=>u(qu(e[0],e[a-1],d)):u}function $q(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=Dy(0,t,n);e.push(ds(r,1,s))}}function Uq(e){const t=[0];return $q(t,e.length-1),t}function zq(e,t){return e.map(r=>r*t)}function Wq(e,t){return e.map(()=>t||KM).splice(0,e.length-1)}function hy({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=eq(n)?n.map(Jj):Jj(n),a={done:!1,value:t[0]},i=zq(r&&r.length===t.length?r:Uq(t),e),o=Bq(i,t,{ease:Array.isArray(s)?s:Wq(t,s)});return{calculatedDuration:e,next:l=>(a.value=o(l),a.done=l>=e,a)}}const Hq=e=>e!==null;function PN(e,{repeat:t,repeatType:r="loop"},n,s=1){const a=e.filter(Hq),o=s<0||t&&r!=="loop"&&t%2===1?0:a.length-1;return!o||n===void 0?a[o]:n}const Gq={decay:dT,inertia:dT,tween:hy,keyframes:hy,spring:fb};function i7(e){typeof e.type=="string"&&(e.type=Gq[e.type])}class FN{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const Vq=e=>e/100;class ON extends FN{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==ho.now()&&this.tick(ho.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;i7(t);const{type:r=hy,repeat:n=0,repeatDelay:s=0,repeatType:a,velocity:i=0}=t;let{keyframes:o}=t;const l=r||hy;l!==hy&&typeof o[0]!="number"&&(this.mixKeyframes=Sv(Vq,n7(o[0],o[1])),o=[0,100]);const u=l({...t,keyframes:o});a==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...o].reverse(),velocity:-i})),u.calculatedDuration===null&&(u.calculatedDuration=jN(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=u}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:n,totalDuration:s,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return n.next(0);const{delay:u=0,keyframes:d,repeat:h,repeatType:g,repeatDelay:p,type:x,onUpdate:v,finalKeyframe:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const C=this.currentTime-u*(this.playbackSpeed>=0?1:-1),k=this.playbackSpeed>=0?C<0:C>s;this.currentTime=Math.max(C,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let _=this.currentTime,N=n;if(h){const A=Math.min(this.currentTime,s)/o;let j=Math.floor(A),R=A%1;!R&&A>=1&&(R=1),R===1&&j--,j=Math.min(j,h+1),!!(j%2)&&(g==="reverse"?(R=1-R,p&&(R-=p/o)):g==="mirror"&&(N=i)),_=qu(0,1,R)*o}const E=k?{done:!1,value:d[0]}:N.next(_);a&&(E.value=a(E.value));let{done:P}=E;!k&&l!==null&&(P=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const F=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&P);return F&&x!==dT&&(E.value=PN(d,this.options,w,this.speed)),v&&v(E.value),F&&this.finish(),E}then(t,r){return this.finished.then(t,r)}get duration(){return Hc(this.calculatedDuration)}get time(){return Hc(this.currentTime)}set time(t){t=Wc(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(ho.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Hc(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=Aq,startTime:r}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),this.options.onPlay?.();const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ho.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function Kq(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Ah=e=>e*180/Math.PI,fT=e=>{const t=Ah(Math.atan2(e[1],e[0]));return hT(t)},qq={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:fT,rotateZ:fT,skewX:e=>Ah(Math.atan(e[1])),skewY:e=>Ah(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},hT=e=>(e=e%360,e<0&&(e+=360),e),n5=fT,s5=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),a5=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Yq={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:s5,scaleY:a5,scale:e=>(s5(e)+a5(e))/2,rotateX:e=>hT(Ah(Math.atan2(e[6],e[5]))),rotateY:e=>hT(Ah(Math.atan2(-e[2],e[0]))),rotateZ:n5,rotate:n5,skewX:e=>Ah(Math.atan(e[4])),skewY:e=>Ah(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function gT(e){return e.includes("scale")?1:0}function mT(e,t){if(!e||e==="none")return gT(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=Yq,s=r;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=qq,s=o}if(!s)return gT(t);const a=n[t],i=s[1].split(",").map(Jq);return typeof a=="function"?a(i):i[a]}const Xq=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return mT(r,t)};function Jq(e){return parseFloat(e.trim())}const Im=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Mm=new Set(Im),i5=e=>e===Rm||e===Fr,Qq=new Set(["x","y","z"]),Zq=Im.filter(e=>!Qq.has(e));function eY(e){const t=[];return Zq.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const Mh={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>mT(t,"x"),y:(e,{transform:t})=>mT(t,"y")};Mh.translateX=Mh.x;Mh.translateY=Mh.y;const Lh=new Set;let pT=!1,xT=!1,yT=!1;function o7(){if(xT){const e=Array.from(Lh).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const s=eY(n);s.length&&(r.set(n,s),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([a,i])=>{n.getValue(a)?.set(i)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}xT=!1,pT=!1,Lh.forEach(e=>e.complete(yT)),Lh.clear()}function l7(){Lh.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(xT=!0)})}function tY(){yT=!0,l7(),o7(),yT=!1}class DN{constructor(t,r,n,s,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=s,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Lh.add(this),pT||(pT=!0,ss.read(l7),ss.resolveKeyframes(o7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:s}=this;if(t[0]===null){const a=s?.get(),i=t[t.length-1];if(a!==void 0)t[0]=a;else if(n&&r){const o=n.readValue(r,i);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=i),s&&a===void 0&&s.set(t[0])}Kq(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Lh.delete(this)}cancel(){this.state==="scheduled"&&(Lh.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const rY=e=>e.startsWith("--");function nY(e,t,r){rY(t)?e.style.setProperty(t,r):e.style[t]=r}const sY=bN(()=>window.ScrollTimeline!==void 0),aY={};function iY(e,t){const r=bN(e);return()=>aY[t]??r()}const c7=iY(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ny=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,o5={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ny([0,.65,.55,1]),circOut:ny([.55,0,1,.45]),backIn:ny([.31,.01,.66,-.59]),backOut:ny([.33,1.53,.69,.99])};function u7(e,t){if(e)return typeof e=="function"?c7()?s7(e,t):"ease-out":qM(e)?ny(e):Array.isArray(e)?e.map(r=>u7(r,t)||o5.easeOut):o5[e]}function oY(e,t,r,{delay:n=0,duration:s=300,repeat:a=0,repeatType:i="loop",ease:o="easeOut",times:l}={},u=void 0){const d={[t]:r};l&&(d.offset=l);const h=u7(o,s);Array.isArray(h)&&(d.easing=h);const g={delay:n,duration:s,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return u&&(g.pseudoElement=u),e.animate(d,g)}function d7(e){return typeof e=="function"&&"applyToOptions"in e}function lY({type:e,...t}){return d7(e)&&c7()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class cY extends FN{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:n,keyframes:s,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:o,onComplete:l}=t;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=t,wN(typeof t.type!="string");const u=lY(t);this.animation=oY(r,n,s,u,a),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const d=PN(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(d):nY(r,n,d),this.animation.cancel()}l?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return Hc(Number(t))}get time(){return Hc(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Wc(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&sY()?(this.animation.timeline=t,wl):r(this)}}const f7={anticipate:HM,backInOut:WM,circInOut:VM};function uY(e){return e in f7}function dY(e){typeof e.ease=="string"&&uY(e.ease)&&(e.ease=f7[e.ease])}const l5=10;class fY extends cY{constructor(t){dY(t),i7(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:n,onComplete:s,element:a,...i}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const o=new ON({...i,autoplay:!1}),l=Wc(this.finishedTime??this.time);r.setWithVelocity(o.sample(l-l5).value,o.sample(l).value,l5),o.stop()}}const c5=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(wf.test(e)||e==="0")&&!e.startsWith("url("));function hY(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function gY(e,t,r,n){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],i=c5(s,t),o=c5(a,t);return!i||!o?!1:hY(e)||(r==="spring"||d7(r))&&n}function vT(e){e.duration=0,e.type}const mY=new Set(["opacity","clipPath","filter","transform"]),pY=bN(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function xY(e){const{motionValue:t,name:r,repeatDelay:n,repeatType:s,damping:a,type:i}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=t.owner.getProps();return pY()&&r&&mY.has(r)&&(r!=="transform"||!u)&&!l&&!n&&s!=="mirror"&&a!==0&&i!=="inertia"}const yY=40;class vY extends FN{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:i="loop",keyframes:o,name:l,motionValue:u,element:d,...h}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=ho.now();const g={autoplay:t,delay:r,type:n,repeat:s,repeatDelay:a,repeatType:i,name:l,motionValue:u,element:d,...h},p=d?.KeyframeResolver||DN;this.keyframeResolver=new p(o,(x,v,w)=>this.onKeyframesResolved(x,v,g,!w),l,u,d),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,r,n,s){this.keyframeResolver=void 0;const{name:a,type:i,velocity:o,delay:l,isHandoff:u,onUpdate:d}=n;this.resolvedAt=ho.now(),gY(t,a,i,o)||((Yu.instantAnimations||!l)&&d?.(PN(t,n,r)),t[0]=t[t.length-1],vT(n),n.repeat=0);const g={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>yY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:t},p=!u&&xY(g)?new fY({...g,element:g.motionValue.owner.current}):new ON(g);p.finished.then(()=>this.notifyFinished()).catch(wl),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),tY()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const wY=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function bY(e){const t=wY.exec(e);if(!t)return[,];const[,r,n,s]=t;return[`--${r??n}`,s]}function h7(e,t,r=1){const[n,s]=bY(e);if(!n)return;const a=window.getComputedStyle(t).getPropertyValue(n);if(a){const i=a.trim();return RM(i)?parseFloat(i):i}return TN(s)?h7(s,t,r+1):s}function RN(e,t){return e?.[t]??e?.default??e}const g7=new Set(["width","height","top","left","right","bottom",...Im]),_Y={test:e=>e==="auto",parse:e=>e},m7=e=>t=>t.test(e),p7=[Rm,Fr,Gc,tf,hq,fq,_Y],u5=e=>p7.find(m7(e));function SY(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||MM(e):!0}const kY=new Set(["brightness","contrast","saturate","opacity"]);function CY(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(EN)||[];if(!n)return e;const s=r.replace(n,"");let a=kY.has(t)?1:0;return n!==r&&(a*=100),t+"("+a+s+")"}const TY=/\b([a-z-]*)\(.*?\)/gu,wT={...wf,getAnimatableNone:e=>{const t=e.match(TY);return t?t.map(CY).join(" "):e}},d5={...Rm,transform:Math.round},EY={rotate:tf,rotateX:tf,rotateY:tf,rotateZ:tf,scale:cw,scaleX:cw,scaleY:cw,scaleZ:cw,skew:tf,skewX:tf,skewY:tf,distance:Fr,translateX:Fr,translateY:Fr,translateZ:Fr,x:Fr,y:Fr,z:Fr,perspective:Fr,transformPerspective:Fr,opacity:Ry,originX:Qj,originY:Qj,originZ:Fr},IN={borderWidth:Fr,borderTopWidth:Fr,borderRightWidth:Fr,borderBottomWidth:Fr,borderLeftWidth:Fr,borderRadius:Fr,radius:Fr,borderTopLeftRadius:Fr,borderTopRightRadius:Fr,borderBottomRightRadius:Fr,borderBottomLeftRadius:Fr,width:Fr,maxWidth:Fr,height:Fr,maxHeight:Fr,top:Fr,right:Fr,bottom:Fr,left:Fr,padding:Fr,paddingTop:Fr,paddingRight:Fr,paddingBottom:Fr,paddingLeft:Fr,margin:Fr,marginTop:Fr,marginRight:Fr,marginBottom:Fr,marginLeft:Fr,backgroundPositionX:Fr,backgroundPositionY:Fr,...EY,zIndex:d5,fillOpacity:Ry,strokeOpacity:Ry,numOctaves:d5},NY={...IN,color:Qs,backgroundColor:Qs,outlineColor:Qs,fill:Qs,stroke:Qs,borderColor:Qs,borderTopColor:Qs,borderRightColor:Qs,borderBottomColor:Qs,borderLeftColor:Qs,filter:wT,WebkitFilter:wT},x7=e=>NY[e];function y7(e,t){let r=x7(e);return r!==wT&&(r=wf),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const AY=new Set(["auto","none","0"]);function jY(e,t,r){let n=0,s;for(;n<e.length&&!s;){const a=e[n];typeof a=="string"&&!AY.has(a)&&Iy(a).values.length&&(s=e[n]),n++}if(s&&r)for(const a of t)e[a]=y7(r,s)}class PY extends DN{constructor(t,r,n,s,a){super(t,r,n,s,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let u=t[l];if(typeof u=="string"&&(u=u.trim(),TN(u))){const d=h7(u,r.current);d!==void 0&&(t[l]=d),l===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!g7.has(n)||t.length!==2)return;const[s,a]=t,i=u5(s),o=u5(a);if(i!==o)if(i5(i)&&i5(o))for(let l=0;l<t.length;l++){const u=t[l];typeof u=="string"&&(t[l]=parseFloat(u))}else Mh[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let s=0;s<t.length;s++)(t[s]===null||SY(t[s]))&&n.push(s);n.length&&jY(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Mh[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&t.getValue(n,s).jump(s,!1)}measureEndState(){const{element:t,name:r,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=n.length-1,i=n[a];n[a]=Mh[r](t.measureViewportBox(),window.getComputedStyle(t.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),this.removedTransforms?.length&&this.removedTransforms.forEach(([o,l])=>{t.getValue(o).set(l)}),this.resolveNoneKeyframes()}}function FY(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let n=document;const s=r?.[e]??n.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}const v7=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function w7(e){return IM(e)&&"offsetHeight"in e}const f5=30,OY=e=>!isNaN(parseFloat(e));class DY{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{const s=ho.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=ho.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=OY(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new _N);const n=this.events[t].add(r);return t==="change"?()=>{n(),ss.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=ho.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>f5)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,f5);return LM(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function mm(e,t){return new DY(e,t)}const{schedule:MN}=YM(queueMicrotask,!1),Yl={x:!1,y:!1};function b7(){return Yl.x||Yl.y}function RY(e){return e==="x"||e==="y"?Yl[e]?null:(Yl[e]=!0,()=>{Yl[e]=!1}):Yl.x||Yl.y?null:(Yl.x=Yl.y=!0,()=>{Yl.x=Yl.y=!1})}function _7(e,t){const r=FY(e),n=new AbortController,s={passive:!0,...t,signal:n.signal};return[r,s,()=>n.abort()]}function h5(e){return!(e.pointerType==="touch"||b7())}function IY(e,t,r={}){const[n,s,a]=_7(e,r),i=o=>{if(!h5(o))return;const{target:l}=o,u=t(l,o);if(typeof u!="function"||!l)return;const d=h=>{h5(h)&&(u(h),l.removeEventListener("pointerleave",d))};l.addEventListener("pointerleave",d,s)};return n.forEach(o=>{o.addEventListener("pointerenter",i,s)}),a}const S7=(e,t)=>t?e===t?!0:S7(e,t.parentElement):!1,LN=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,MY=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function LY(e){return MY.has(e.tagName)||e.tabIndex!==-1}const Jw=new WeakSet;function g5(e){return t=>{t.key==="Enter"&&e(t)}}function AS(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const BY=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=g5(()=>{if(Jw.has(r))return;AS(r,"down");const s=g5(()=>{AS(r,"up")}),a=()=>AS(r,"cancel");r.addEventListener("keyup",s,t),r.addEventListener("blur",a,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function m5(e){return LN(e)&&!b7()}function $Y(e,t,r={}){const[n,s,a]=_7(e,r),i=o=>{const l=o.currentTarget;if(!m5(o))return;Jw.add(l);const u=t(l,o),d=(p,x)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",g),Jw.has(l)&&Jw.delete(l),m5(p)&&typeof u=="function"&&u(p,{success:x})},h=p=>{d(p,l===window||l===document||r.useGlobalTarget||S7(l,p.target))},g=p=>{d(p,!1)};window.addEventListener("pointerup",h,s),window.addEventListener("pointercancel",g,s)};return n.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",i,s),w7(o)&&(o.addEventListener("focus",u=>BY(u,s)),!LY(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),a}function k7(e){return IM(e)&&"ownerSVGElement"in e}function UY(e){return k7(e)&&e.tagName==="svg"}const Si=e=>!!(e&&e.getVelocity),zY=[...p7,Qs,wf],WY=e=>zY.find(m7(e)),BN=S.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class HY extends S.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=w7(n)&&n.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function GY({children:e,isPresent:t,anchorX:r,root:n}){const s=S.useId(),a=S.useRef(null),i=S.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=S.useContext(BN);return S.useInsertionEffect(()=>{const{width:l,height:u,top:d,left:h,right:g}=i.current;if(t||!a.current||!l||!u)return;const p=r==="left"?`left: ${h}`:`right: ${g}`;a.current.dataset.motionPopId=s;const x=document.createElement("style");o&&(x.nonce=o);const v=n??document.head;return v.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${u}px !important;
            ${p}px !important;
            top: ${d}px !important;
          }
        `),()=>{v.contains(x)&&v.removeChild(x)}},[t]),c.jsx(HY,{isPresent:t,childRef:a,sizeRef:i,children:S.cloneElement(e,{ref:a})})}const VY=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:i,anchorX:o,root:l})=>{const u=pN(KY),d=S.useId();let h=!0,g=S.useMemo(()=>(h=!1,{id:d,initial:t,isPresent:r,custom:s,onExitComplete:p=>{u.set(p,!0);for(const x of u.values())if(!x)return;n&&n()},register:p=>(u.set(p,!1),()=>u.delete(p))}),[r,u,n]);return a&&h&&(g={...g}),S.useMemo(()=>{u.forEach((p,x)=>u.set(x,!1))},[r]),S.useEffect(()=>{!r&&!u.size&&n&&n()},[r]),i==="popLayout"&&(e=c.jsx(GY,{isPresent:r,anchorX:o,root:l,children:e})),c.jsx(O_.Provider,{value:g,children:e})};function KY(){return new Map}function C7(e=!0){const t=S.useContext(O_);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=t,a=S.useId();S.useEffect(()=>{if(e)return s(a)},[e]);const i=S.useCallback(()=>e&&n&&n(a),[a,n,e]);return!r&&n?[!1,i]:[!0]}const uw=e=>e.key||"";function p5(e){const t=[];return S.Children.forEach(e,r=>{S.isValidElement(r)&&t.push(r)}),t}const fo=({children:e,custom:t,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:a="sync",propagate:i=!1,anchorX:o="left",root:l})=>{const[u,d]=C7(i),h=S.useMemo(()=>p5(e),[e]),g=i&&!u?[]:h.map(uw),p=S.useRef(!0),x=S.useRef(h),v=pN(()=>new Map),[w,C]=S.useState(h),[k,_]=S.useState(h);DM(()=>{p.current=!1,x.current=h;for(let P=0;P<k.length;P++){const F=uw(k[P]);g.includes(F)?v.delete(F):v.get(F)!==!0&&v.set(F,!1)}},[k,g.length,g.join("-")]);const N=[];if(h!==w){let P=[...h];for(let F=0;F<k.length;F++){const A=k[F],j=uw(A);g.includes(j)||(P.splice(F,0,A),N.push(A))}return a==="wait"&&N.length&&(P=N),_(p5(P)),C(h),null}const{forceRender:E}=S.useContext(mN);return c.jsx(c.Fragment,{children:k.map(P=>{const F=uw(P),A=i&&!u?!1:h===k||g.includes(F),j=()=>{if(v.has(F))v.set(F,!0);else return;let R=!0;v.forEach(U=>{U||(R=!1)}),R&&(E?.(),_(x.current),i&&d?.(),n&&n())};return c.jsx(VY,{isPresent:A,initial:!p.current||r?void 0:!1,custom:t,presenceAffectsLayout:s,mode:a,root:l,onExitComplete:A?void 0:j,anchorX:o,children:P},F)})})},T7=S.createContext({strict:!1}),x5={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},pm={};for(const e in x5)pm[e]={isEnabled:t=>x5[e].some(r=>!!t[r])};function qY(e){for(const t in e)pm[t]={...pm[t],...e[t]}}const YY=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function hb(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||YY.has(e)}let E7=e=>!hb(e);function XY(e){typeof e=="function"&&(E7=t=>t.startsWith("on")?!hb(t):e(t))}try{XY(require("@emotion/is-prop-valid").default)}catch{}function JY(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(E7(s)||r===!0&&hb(s)||!t&&!hb(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}const D_=S.createContext({});function R_(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function My(e){return typeof e=="string"||Array.isArray(e)}const $N=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],UN=["initial",...$N];function I_(e){return R_(e.animate)||UN.some(t=>My(e[t]))}function N7(e){return!!(I_(e)||e.variants)}function QY(e,t){if(I_(e)){const{initial:r,animate:n}=e;return{initial:r===!1||My(r)?r:void 0,animate:My(n)?n:void 0}}return e.inherit!==!1?t:{}}function ZY(e){const{initial:t,animate:r}=QY(e,S.useContext(D_));return S.useMemo(()=>({initial:t,animate:r}),[y5(t),y5(r)])}function y5(e){return Array.isArray(e)?e.join(" "):e}const Ly={};function eX(e){for(const t in e)Ly[t]=e[t],CN(t)&&(Ly[t].isCSSVariable=!0)}function A7(e,{layout:t,layoutId:r}){return Mm.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!Ly[e]||e==="opacity")}const tX={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},rX=Im.length;function nX(e,t,r){let n="",s=!0;for(let a=0;a<rX;a++){const i=Im[a],o=e[i];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(i.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||r){const u=v7(o,IN[i]);if(!l){s=!1;const d=tX[i]||i;n+=`${d}(${u}) `}r&&(t[i]=u)}}return n=n.trim(),r?n=r(t,s?"":n):s&&(n="none"),n}function zN(e,t,r){const{style:n,vars:s,transformOrigin:a}=e;let i=!1,o=!1;for(const l in t){const u=t[l];if(Mm.has(l)){i=!0;continue}else if(CN(l)){s[l]=u;continue}else{const d=v7(u,IN[l]);l.startsWith("origin")?(o=!0,a[l]=d):n[l]=d}}if(t.transform||(i||r?n.transform=nX(t,e.transform,r):n.transform&&(n.transform="none")),o){const{originX:l="50%",originY:u="50%",originZ:d=0}=a;n.transformOrigin=`${l} ${u} ${d}`}}const WN=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function j7(e,t,r){for(const n in t)!Si(t[n])&&!A7(n,r)&&(e[n]=t[n])}function sX({transformTemplate:e},t){return S.useMemo(()=>{const r=WN();return zN(r,t,e),Object.assign({},r.vars,r.style)},[t])}function aX(e,t){const r=e.style||{},n={};return j7(n,r,e),Object.assign(n,sX(e,t)),n}function iX(e,t){const r={},n=aX(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const oX={offset:"stroke-dashoffset",array:"stroke-dasharray"},lX={offset:"strokeDashoffset",array:"strokeDasharray"};function cX(e,t,r=1,n=0,s=!0){e.pathLength=1;const a=s?oX:lX;e[a.offset]=Fr.transform(-n);const i=Fr.transform(t),o=Fr.transform(r);e[a.array]=`${i} ${o}`}function P7(e,{attrX:t,attrY:r,attrScale:n,pathLength:s,pathSpacing:a=1,pathOffset:i=0,...o},l,u,d){if(zN(e,o,u),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:h,style:g}=e;h.transform&&(g.transform=h.transform,delete h.transform),(g.transform||h.transformOrigin)&&(g.transformOrigin=h.transformOrigin??"50% 50%",delete h.transformOrigin),g.transform&&(g.transformBox=d?.transformBox??"fill-box",delete h.transformBox),t!==void 0&&(h.x=t),r!==void 0&&(h.y=r),n!==void 0&&(h.scale=n),s!==void 0&&cX(h,s,a,i,!1)}const F7=()=>({...WN(),attrs:{}}),O7=e=>typeof e=="string"&&e.toLowerCase()==="svg";function uX(e,t,r,n){const s=S.useMemo(()=>{const a=F7();return P7(a,t,O7(n),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};j7(a,e.style,e),s.style={...a,...s.style}}return s}const dX=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function HN(e){return typeof e!="string"||e.includes("-")?!1:!!(dX.indexOf(e)>-1||/[A-Z]/u.test(e))}function fX(e,t,r,{latestValues:n},s,a=!1){const o=(HN(e)?uX:iX)(t,n,s,e),l=JY(t,typeof e=="string",a),u=e!==S.Fragment?{...l,...o,ref:r}:{},{children:d}=t,h=S.useMemo(()=>Si(d)?d.get():d,[d]);return S.createElement(e,{...u,children:h})}function v5(e){const t=[{},{}];return e?.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function GN(e,t,r,n){if(typeof t=="function"){const[s,a]=v5(n);t=t(r!==void 0?r:e.custom,s,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,a]=v5(n);t=t(r!==void 0?r:e.custom,s,a)}return t}function Qw(e){return Si(e)?e.get():e}function hX({scrapeMotionValuesFromProps:e,createRenderState:t},r,n,s){return{latestValues:gX(r,n,s,e),renderState:t()}}function gX(e,t,r,n){const s={},a=n(e,{});for(const g in a)s[g]=Qw(a[g]);let{initial:i,animate:o}=e;const l=I_(e),u=N7(e);t&&u&&!l&&e.inherit!==!1&&(i===void 0&&(i=t.initial),o===void 0&&(o=t.animate));let d=r?r.initial===!1:!1;d=d||i===!1;const h=d?o:i;if(h&&typeof h!="boolean"&&!R_(h)){const g=Array.isArray(h)?h:[h];for(let p=0;p<g.length;p++){const x=GN(e,g[p]);if(x){const{transitionEnd:v,transition:w,...C}=x;for(const k in C){let _=C[k];if(Array.isArray(_)){const N=d?_.length-1:0;_=_[N]}_!==null&&(s[k]=_)}for(const k in v)s[k]=v[k]}}}return s}const D7=e=>(t,r)=>{const n=S.useContext(D_),s=S.useContext(O_),a=()=>hX(e,t,n,s);return r?a():pN(a)};function VN(e,t,r){const{style:n}=e,s={};for(const a in n)(Si(n[a])||t.style&&Si(t.style[a])||A7(a,e)||r?.getValue(a)?.liveStyle!==void 0)&&(s[a]=n[a]);return s}const mX=D7({scrapeMotionValuesFromProps:VN,createRenderState:WN});function R7(e,t,r){const n=VN(e,t,r);for(const s in e)if(Si(e[s])||Si(t[s])){const a=Im.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[a]=e[s]}return n}const pX=D7({scrapeMotionValuesFromProps:R7,createRenderState:F7}),xX=Symbol.for("motionComponentSymbol");function Vg(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function yX(e,t,r){return S.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):Vg(r)&&(r.current=n))},[t])}const KN=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),vX="framerAppearId",I7="data-"+KN(vX),M7=S.createContext({});function wX(e,t,r,n,s){const{visualElement:a}=S.useContext(D_),i=S.useContext(T7),o=S.useContext(O_),l=S.useContext(BN).reducedMotion,u=S.useRef(null);n=n||i.renderer,!u.current&&n&&(u.current=n(e,{visualState:t,parent:a,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const d=u.current,h=S.useContext(M7);d&&!d.projection&&s&&(d.type==="html"||d.type==="svg")&&bX(u.current,r,s,h);const g=S.useRef(!1);S.useInsertionEffect(()=>{d&&g.current&&d.update(r,o)});const p=r[I7],x=S.useRef(!!p&&!window.MotionHandoffIsComplete?.(p)&&window.MotionHasOptimisedAnimation?.(p));return DM(()=>{d&&(g.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),x.current&&d.animationState&&d.animationState.animateChanges())}),S.useEffect(()=>{d&&(!x.current&&d.animationState&&d.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(p)}),x.current=!1),d.enteringChildren=void 0)}),d}function bX(e,t,r,n){const{layoutId:s,layout:a,drag:i,dragConstraints:o,layoutScroll:l,layoutRoot:u,layoutCrossfade:d}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:L7(e.parent)),e.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!i||o&&Vg(o),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:d,layoutScroll:l,layoutRoot:u})}function L7(e){if(e)return e.options.allowProjection!==!1?e.projection:L7(e.parent)}function jS(e,{forwardMotionProps:t=!1}={},r,n){r&&qY(r);const s=HN(e)?pX:mX;function a(o,l){let u;const d={...S.useContext(BN),...o,layoutId:_X(o)},{isStatic:h}=d,g=ZY(o),p=s(o,h);if(!h&&xN){SX();const x=kX(d);u=x.MeasureLayout,g.visualElement=wX(e,p,d,n,x.ProjectionNode)}return c.jsxs(D_.Provider,{value:g,children:[u&&g.visualElement?c.jsx(u,{visualElement:g.visualElement,...d}):null,fX(e,o,yX(p,g.visualElement,l),p,h,t)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const i=S.forwardRef(a);return i[xX]=e,i}function _X({layoutId:e}){const t=S.useContext(mN).id;return t&&e!==void 0?t+"-"+e:e}function SX(e,t){S.useContext(T7).strict}function kX(e){const{drag:t,layout:r}=pm;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t?.isEnabled(e)||r?.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function CX(e,t){if(typeof Proxy>"u")return jS;const r=new Map,n=(a,i)=>jS(a,i,e,t),s=(a,i)=>n(a,i);return new Proxy(s,{get:(a,i)=>i==="create"?n:(r.has(i)||r.set(i,jS(i,void 0,e,t)),r.get(i))})}function B7({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function TX({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function EX(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function PS(e){return e===void 0||e===1}function bT({scale:e,scaleX:t,scaleY:r}){return!PS(e)||!PS(t)||!PS(r)}function _h(e){return bT(e)||$7(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function $7(e){return w5(e.x)||w5(e.y)}function w5(e){return e&&e!=="0%"}function gb(e,t,r){const n=e-r,s=t*n;return r+s}function b5(e,t,r,n,s){return s!==void 0&&(e=gb(e,s,n)),gb(e,r,n)+t}function _T(e,t=0,r=1,n,s){e.min=b5(e.min,t,r,n,s),e.max=b5(e.max,t,r,n,s)}function U7(e,{x:t,y:r}){_T(e.x,t.translate,t.scale,t.originPoint),_T(e.y,r.translate,r.scale,r.originPoint)}const _5=.999999999999,S5=1.0000000000001;function NX(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let a,i;for(let o=0;o<s;o++){a=r[o],i=a.projectionDelta;const{visualElement:l}=a.options;l&&l.props.style&&l.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&qg(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,U7(e,i)),n&&_h(a.latestValues)&&qg(e,a.latestValues))}t.x<S5&&t.x>_5&&(t.x=1),t.y<S5&&t.y>_5&&(t.y=1)}function Kg(e,t){e.min=e.min+t,e.max=e.max+t}function k5(e,t,r,n,s=.5){const a=ds(e.min,e.max,s);_T(e,t,r,a,n)}function qg(e,t){k5(e.x,t.x,t.scaleX,t.scale,t.originX),k5(e.y,t.y,t.scaleY,t.scale,t.originY)}function z7(e,t){return B7(EX(e.getBoundingClientRect(),t))}function AX(e,t,r){const n=z7(e,r),{scroll:s}=t;return s&&(Kg(n.x,s.offset.x),Kg(n.y,s.offset.y)),n}const C5=()=>({translate:0,scale:1,origin:0,originPoint:0}),Yg=()=>({x:C5(),y:C5()}),T5=()=>({min:0,max:0}),$s=()=>({x:T5(),y:T5()}),ST={current:null},W7={current:!1};function jX(){if(W7.current=!0,!!xN)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>ST.current=e.matches;e.addEventListener("change",t),t()}else ST.current=!1}const PX=new WeakMap;function FX(e,t,r){for(const n in t){const s=t[n],a=r[n];if(Si(s))e.addValue(n,s);else if(Si(a))e.addValue(n,mm(s,{owner:e}));else if(a!==s)if(e.hasValue(n)){const i=e.getValue(n);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=e.getStaticValue(n);e.addValue(n,mm(i!==void 0?i:s,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const E5=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class OX{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:a,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=DN,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=ho.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,ss.render(this.render,!1,!0))};const{latestValues:l,renderState:u}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=u,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!a,this.isControllingVariants=I_(r),this.isVariantNode=N7(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...h}=this.scrapeMotionValuesFromProps(r,{},this);for(const g in h){const p=h[g];l[g]!==void 0&&Si(p)&&p.set(l[g])}}mount(t){this.current=t,PX.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),W7.current||jX(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:ST.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),vf(this.notifyUpdate),vf(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=Mm.has(t);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&ss.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{s(),a&&a(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in pm){const r=pm[t];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[t]&&s&&n(this.props)&&(this.features[t]=new s(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):$s()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<E5.length;n++){const s=E5[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a="on"+s,i=t[a];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=FX(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=mm(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){let n=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return n!=null&&(typeof n=="string"&&(RM(n)||MM(n))?n=parseFloat(n):!WY(n)&&wf.test(r)&&(n=y7(t,r)),this.setBaseTarget(t,Si(n)?n.get():n)),Si(n)?n.get():n}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const a=GN(this.props,r,this.presenceContext?.custom);a&&(n=a[t])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!Si(s)?s:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new _N),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){MN.render(this.render)}}class H7 extends OX{constructor(){super(...arguments),this.KeyframeResolver=PY}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Si(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function G7(e,{style:t,vars:r},n,s){const a=e.style;let i;for(i in t)a[i]=t[i];s?.applyProjectionStyles(a,n);for(i in r)a.setProperty(i,r[i])}function DX(e){return window.getComputedStyle(e)}class RX extends H7{constructor(){super(...arguments),this.type="html",this.renderInstance=G7}readValueFromInstance(t,r){if(Mm.has(r))return this.projection?.isProjecting?gT(r):Xq(t,r);{const n=DX(t),s=(CN(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return z7(t,r)}build(t,r,n){zN(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return VN(t,r,n)}}const V7=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function IX(e,t,r,n){G7(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(V7.has(s)?s:KN(s),t.attrs[s])}class MX extends H7{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=$s}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Mm.has(r)){const n=x7(r);return n&&n.default||0}return r=V7.has(r)?r:KN(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return R7(t,r,n)}build(t,r,n){P7(t,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(t,r,n,s){IX(t,r,n,s)}mount(t){this.isSVGTag=O7(t.tagName),super.mount(t)}}const LX=(e,t)=>HN(e)?new MX(t):new RX(t,{allowProjection:e!==S.Fragment});function tm(e,t,r){const n=e.getProps();return GN(n,t,r!==void 0?r:n.custom,e)}const kT=e=>Array.isArray(e);function BX(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,mm(r))}function $X(e){return kT(e)?e[e.length-1]||0:e}function UX(e,t){const r=tm(e,t);let{transitionEnd:n={},transition:s={},...a}=r||{};a={...a,...n};for(const i in a){const o=$X(a[i]);BX(e,i,o)}}function zX(e){return!!(Si(e)&&e.add)}function CT(e,t){const r=e.getValue("willChange");if(zX(r))return r.add(t);if(!r&&Yu.WillChange){const n=new Yu.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function K7(e){return e.props[I7]}const WX=e=>e!==null;function HX(e,{repeat:t,repeatType:r="loop"},n){const s=e.filter(WX),a=t&&r!=="loop"&&t%2===1?0:s.length-1;return s[a]}const GX={type:"spring",stiffness:500,damping:25,restSpeed:10},VX=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),KX={type:"keyframes",duration:.8},qX={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},YX=(e,{keyframes:t})=>t.length>2?KX:Mm.has(e)?e.startsWith("scale")?VX(t[1]):GX:qX;function XX({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:i,repeatDelay:o,from:l,elapsed:u,...d}){return!!Object.keys(d).length}const qN=(e,t,r,n={},s,a)=>i=>{const o=RN(n,e)||{},l=o.delay||n.delay||0;let{elapsed:u=0}=n;u=u-Wc(l);const d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-u,onUpdate:g=>{t.set(g),o.onUpdate&&o.onUpdate(g)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:a?void 0:s};XX(o)||Object.assign(d,YX(e,d)),d.duration&&(d.duration=Wc(d.duration)),d.repeatDelay&&(d.repeatDelay=Wc(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let h=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(vT(d),d.delay===0&&(h=!0)),(Yu.instantAnimations||Yu.skipAnimations)&&(h=!0,vT(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,h&&!a&&t.get()!==void 0){const g=HX(d.keyframes,o);if(g!==void 0){ss.update(()=>{d.onUpdate(g),d.onComplete()});return}}return o.isSync?new ON(d):new vY(d)};function JX({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function q7(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:i,...o}=t;n&&(a=n);const l=[],u=s&&e.animationState&&e.animationState.getState()[s];for(const d in o){const h=e.getValue(d,e.latestValues[d]??null),g=o[d];if(g===void 0||u&&JX(u,d))continue;const p={delay:r,...RN(a||{},d)},x=h.get();if(x!==void 0&&!h.isAnimating&&!Array.isArray(g)&&g===x&&!p.velocity)continue;let v=!1;if(window.MotionHandoffAnimation){const C=K7(e);if(C){const k=window.MotionHandoffAnimation(C,d,ss);k!==null&&(p.startTime=k,v=!0)}}CT(e,d),h.start(qN(d,h,g,e.shouldReduceMotion&&g7.has(d)?{type:!1}:p,e,v));const w=h.animation;w&&l.push(w)}return i&&Promise.all(l).then(()=>{ss.update(()=>{i&&UX(e,i)})}),l}function Y7(e,t,r,n=0,s=1){const a=Array.from(e).sort((u,d)=>u.sortNodePosition(d)).indexOf(t),i=e.size,o=(i-1)*n;return typeof r=="function"?r(a,i):s===1?a*n:o-a*n}function TT(e,t,r={}){const n=tm(e,t,r.type==="exit"?e.presenceContext?.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const a=n?()=>Promise.all(q7(e,n,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(l=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return QX(e,t,l,u,d,h,r)}:()=>Promise.resolve(),{when:o}=s;if(o){const[l,u]=o==="beforeChildren"?[a,i]:[i,a];return l().then(()=>u())}else return Promise.all([a(),i(r.delay)])}function QX(e,t,r=0,n=0,s=0,a=1,i){const o=[];for(const l of e.variantChildren)l.notify("AnimationStart",t),o.push(TT(l,t,{...i,delay:r+(typeof n=="function"?0:n)+Y7(e.variantChildren,l,n,s,a)}).then(()=>l.notify("AnimationComplete",t)));return Promise.all(o)}function ZX(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(a=>TT(e,a,r));n=Promise.all(s)}else if(typeof t=="string")n=TT(e,t,r);else{const s=typeof t=="function"?tm(e,t,r.custom):t;n=Promise.all(q7(e,s,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function X7(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const eJ=UN.length;function J7(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?J7(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<eJ;r++){const n=UN[r],s=e.props[n];(My(s)||s===!1)&&(t[n]=s)}return t}const tJ=[...$N].reverse(),rJ=$N.length;function nJ(e){return t=>Promise.all(t.map(({animation:r,options:n})=>ZX(e,r,n)))}function sJ(e){let t=nJ(e),r=N5(),n=!0;const s=l=>(u,d)=>{const h=tm(e,d,l==="exit"?e.presenceContext?.custom:void 0);if(h){const{transition:g,transitionEnd:p,...x}=h;u={...u,...x,...p}}return u};function a(l){t=l(e)}function i(l){const{props:u}=e,d=J7(e.parent)||{},h=[],g=new Set;let p={},x=1/0;for(let w=0;w<rJ;w++){const C=tJ[w],k=r[C],_=u[C]!==void 0?u[C]:d[C],N=My(_),E=C===l?k.isActive:null;E===!1&&(x=w);let P=_===d[C]&&_!==u[C]&&N;if(P&&n&&e.manuallyAnimateOnMount&&(P=!1),k.protectedKeys={...p},!k.isActive&&E===null||!_&&!k.prevProp||R_(_)||typeof _=="boolean")continue;const F=aJ(k.prevProp,_);let A=F||C===l&&k.isActive&&!P&&N||w>x&&N,j=!1;const R=Array.isArray(_)?_:[_];let U=R.reduce(s(C),{});E===!1&&(U={});const{prevResolvedValues:Y={}}=k,Z={...Y,...U},ae=L=>{A=!0,g.has(L)&&(j=!0,g.delete(L)),k.needsAnimating[L]=!0;const H=e.getValue(L);H&&(H.liveStyle=!1)};for(const L in Z){const H=U[L],M=Y[L];if(p.hasOwnProperty(L))continue;let V=!1;kT(H)&&kT(M)?V=!X7(H,M):V=H!==M,V?H!=null?ae(L):g.add(L):H!==void 0&&g.has(L)?ae(L):k.protectedKeys[L]=!0}k.prevProp=_,k.prevResolvedValues=U,k.isActive&&(p={...p,...U}),n&&e.blockInitialAnimation&&(A=!1);const ee=P&&F;A&&(!ee||j)&&h.push(...R.map(L=>{const H={type:C};if(typeof L=="string"&&n&&!ee&&e.manuallyAnimateOnMount&&e.parent){const{parent:M}=e,V=tm(M,L);if(M.enteringChildren&&V){const{delayChildren:W}=V.transition||{};H.delay=Y7(M.enteringChildren,e,W)}}return{animation:L,options:H}}))}if(g.size){const w={};if(typeof u.initial!="boolean"){const C=tm(e,Array.isArray(u.initial)?u.initial[0]:u.initial);C&&C.transition&&(w.transition=C.transition)}g.forEach(C=>{const k=e.getBaseTarget(C),_=e.getValue(C);_&&(_.liveStyle=!0),w[C]=k??null}),h.push({animation:w})}let v=!!h.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(v=!1),n=!1,v?t(h):Promise.resolve()}function o(l,u){if(r[l].isActive===u)return Promise.resolve();e.variantChildren?.forEach(h=>h.animationState?.setActive(l,u)),r[l].isActive=u;const d=i(l);for(const h in r)r[h].protectedKeys={};return d}return{animateChanges:i,setActive:o,setAnimateFunction:a,getState:()=>r,reset:()=>{r=N5(),n=!0}}}function aJ(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!X7(t,e):!1}function xh(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function N5(){return{animate:xh(!0),whileInView:xh(),whileHover:xh(),whileTap:xh(),whileDrag:xh(),whileFocus:xh(),exit:xh()}}class Af{constructor(t){this.isMounted=!1,this.node=t}update(){}}class iJ extends Af{constructor(t){super(t),t.animationState||(t.animationState=sJ(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();R_(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let oJ=0;class lJ extends Af{constructor(){super(...arguments),this.id=oJ++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const s=this.node.animationState.setActive("exit",!t);r&&!t&&s.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const cJ={animation:{Feature:iJ},exit:{Feature:lJ}};function By(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function Tv(e){return{point:{x:e.pageX,y:e.pageY}}}const uJ=e=>t=>LN(t)&&e(t,Tv(t));function gy(e,t,r,n){return By(e,t,uJ(r),n)}const Q7=1e-4,dJ=1-Q7,fJ=1+Q7,Z7=.01,hJ=0-Z7,gJ=0+Z7;function Vi(e){return e.max-e.min}function mJ(e,t,r){return Math.abs(e-t)<=r}function A5(e,t,r,n=.5){e.origin=n,e.originPoint=ds(t.min,t.max,e.origin),e.scale=Vi(r)/Vi(t),e.translate=ds(r.min,r.max,e.origin)-e.originPoint,(e.scale>=dJ&&e.scale<=fJ||isNaN(e.scale))&&(e.scale=1),(e.translate>=hJ&&e.translate<=gJ||isNaN(e.translate))&&(e.translate=0)}function my(e,t,r,n){A5(e.x,t.x,r.x,n?n.originX:void 0),A5(e.y,t.y,r.y,n?n.originY:void 0)}function j5(e,t,r){e.min=r.min+t.min,e.max=e.min+Vi(t)}function pJ(e,t,r){j5(e.x,t.x,r.x),j5(e.y,t.y,r.y)}function P5(e,t,r){e.min=t.min-r.min,e.max=e.min+Vi(t)}function py(e,t,r){P5(e.x,t.x,r.x),P5(e.y,t.y,r.y)}function fl(e){return[e("x"),e("y")]}const eL=({current:e})=>e?e.ownerDocument.defaultView:null,F5=(e,t)=>Math.abs(e-t);function xJ(e,t){const r=F5(e.x,t.x),n=F5(e.y,t.y);return Math.sqrt(r**2+n**2)}class tL{constructor(t,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=OS(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,x=xJ(g.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!x)return;const{point:v}=g,{timestamp:w}=Xa;this.history.push({...v,timestamp:w});const{onStart:C,onMove:k}=this.handlers;p||(C&&C(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),k&&k(this.lastMoveEvent,g)},this.handlePointerMove=(g,p)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=FS(p,this.transformPagePoint),ss.update(this.updatePoint,!0)},this.handlePointerUp=(g,p)=>{this.end();const{onEnd:x,onSessionEnd:v,resumeAnimation:w}=this.handlers;if(this.dragSnapToOrigin&&w&&w(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const C=OS(g.type==="pointercancel"?this.lastMoveEventInfo:FS(p,this.transformPagePoint),this.history);this.startEvent&&x&&x(g,C),v&&v(g,C)},!LN(t))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=s||window;const o=Tv(t),l=FS(o,this.transformPagePoint),{point:u}=l,{timestamp:d}=Xa;this.history=[{...u,timestamp:d}];const{onSessionStart:h}=r;h&&h(t,OS(l,this.history)),this.removeListeners=Sv(gy(this.contextWindow,"pointermove",this.handlePointerMove),gy(this.contextWindow,"pointerup",this.handlePointerUp),gy(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),vf(this.updatePoint)}}function FS(e,t){return t?{point:t(e.point)}:e}function O5(e,t){return{x:e.x-t.x,y:e.y-t.y}}function OS({point:e},t){return{point:e,delta:O5(e,rL(t)),offset:O5(e,yJ(t)),velocity:vJ(t,.1)}}function yJ(e){return e[0]}function rL(e){return e[e.length-1]}function vJ(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=rL(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>Wc(t)));)r--;if(!n)return{x:0,y:0};const a=Hc(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const i={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function wJ(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?ds(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?ds(r,e,n.max):Math.min(e,r)),e}function D5(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function bJ(e,{top:t,left:r,bottom:n,right:s}){return{x:D5(e.x,r,s),y:D5(e.y,t,n)}}function R5(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function _J(e,t){return{x:R5(e.x,t.x),y:R5(e.y,t.y)}}function SJ(e,t){let r=.5;const n=Vi(e),s=Vi(t);return s>n?r=Dy(t.min,t.max-n,e.min):n>s&&(r=Dy(e.min,e.max-s,t.min)),qu(0,1,r)}function kJ(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const ET=.35;function CJ(e=ET){return e===!1?e=0:e===!0&&(e=ET),{x:I5(e,"left","right"),y:I5(e,"top","bottom")}}function I5(e,t,r){return{min:M5(e,t),max:M5(e,r)}}function M5(e,t){return typeof e=="number"?e:e[t]||0}const TJ=new WeakMap;class EJ{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=$s(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const a=h=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Tv(h).point)},i=(h,g)=>{const{drag:p,dragPropagation:x,onDragStart:v}=this.getProps();if(p&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=RY(p),!this.openDragLock))return;this.latestPointerEvent=h,this.latestPanInfo=g,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),fl(C=>{let k=this.getAxisMotionValue(C).get()||0;if(Gc.test(k)){const{projection:_}=this.visualElement;if(_&&_.layout){const N=_.layout.layoutBox[C];N&&(k=Vi(N)*(parseFloat(k)/100))}}this.originPoint[C]=k}),v&&ss.postRender(()=>v(h,g)),CT(this.visualElement,"transform");const{animationState:w}=this.visualElement;w&&w.setActive("whileDrag",!0)},o=(h,g)=>{this.latestPointerEvent=h,this.latestPanInfo=g;const{dragPropagation:p,dragDirectionLock:x,onDirectionLock:v,onDrag:w}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:C}=g;if(x&&this.currentDirection===null){this.currentDirection=NJ(C),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",g.point,C),this.updateAxis("y",g.point,C),this.visualElement.render(),w&&w(h,g)},l=(h,g)=>{this.latestPointerEvent=h,this.latestPanInfo=g,this.stop(h,g),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>fl(h=>this.getAnimationState(h)==="paused"&&this.getAxisMotionValue(h).animation?.play()),{dragSnapToOrigin:d}=this.getProps();this.panSession=new tL(t,{onSessionStart:a,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:n,contextWindow:eL(this.visualElement)})}stop(t,r){const n=t||this.latestPointerEvent,s=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!s||!n)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&ss.postRender(()=>o(n,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!dw(t,s,this.currentDirection))return;const a=this.getAxisMotionValue(t);let i=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(i=wJ(i,this.constraints[t],this.elastic[t])),a.set(i)}resolveConstraints(){const{dragConstraints:t,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;t&&Vg(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=bJ(n.layoutBox,t):this.constraints=!1,this.elastic=CJ(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&fl(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=kJ(n.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Vg(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=AX(n,s.root,this.visualElement.getTransformPagePoint());let i=_J(s.layout.layoutBox,a);if(r){const o=r(TX(i));this.hasMutatedConstraints=!!o,o&&(i=B7(o))}return i}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},u=fl(d=>{if(!dw(d,r,this.currentDirection))return;let h=l&&l[d]||{};i&&(h={min:0,max:0});const g=s?200:1e6,p=s?40:1e7,x={type:"inertia",velocity:n?t[d]:0,bounceStiffness:g,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...a,...h};return this.startAxisValueAnimation(d,x)});return Promise.all(u).then(o)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return CT(this.visualElement,t),n.start(qN(t,n,0,r,this.visualElement,!1))}stopAnimation(){fl(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){fl(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){fl(r=>{const{drag:n}=this.getProps();if(!dw(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:i,max:o}=s.layout.layoutBox[r];a.set(t[r]-ds(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Vg(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};fl(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const l=o.get();s[i]=SJ({min:l,max:l},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),fl(i=>{if(!dw(i,t,null))return;const o=this.getAxisMotionValue(i),{min:l,max:u}=this.constraints[i];o.set(ds(l,u,s[i]))})}addListeners(){if(!this.visualElement.current)return;TJ.set(this.visualElement,this);const t=this.visualElement.current,r=gy(t,"pointerdown",l=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();Vg(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),ss.read(n);const i=By(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(fl(d=>{const h=this.getAxisMotionValue(d);h&&(this.originPoint[d]+=l[d].translate,h.set(h.get()+l[d].translate))}),this.visualElement.render())}));return()=>{i(),r(),a(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:i=ET,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:i,dragMomentum:o}}}function dw(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function NJ(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class AJ extends Af{constructor(t){super(t),this.removeGroupControls=wl,this.removeListeners=wl,this.controls=new EJ(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||wl}unmount(){this.removeGroupControls(),this.removeListeners()}}const L5=e=>(t,r)=>{e&&ss.postRender(()=>e(t,r))};class jJ extends Af{constructor(){super(...arguments),this.removePointerDownListener=wl}onPointerDown(t){this.session=new tL(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:eL(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:L5(t),onStart:L5(r),onMove:n,onEnd:(a,i)=>{delete this.session,s&&ss.postRender(()=>s(a,i))}}}mount(){this.removePointerDownListener=gy(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Zw={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function B5(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const ex={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Fr.test(e))e=parseFloat(e);else return e;const r=B5(e,t.target.x),n=B5(e,t.target.y);return`${r}% ${n}%`}},PJ={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=wf.parse(e);if(s.length>5)return n;const a=wf.createTransformer(e),i=typeof s[0]!="number"?1:0,o=r.x.scale*t.x,l=r.y.scale*t.y;s[0+i]/=o,s[1+i]/=l;const u=ds(o,l,.5);return typeof s[2+i]=="number"&&(s[2+i]/=u),typeof s[3+i]=="number"&&(s[3+i]/=u),a(s)}};let DS=!1;class FJ extends S.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=t;eX(OJ),a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),DS&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),Zw.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,{projection:i}=n;return i&&(i.isPresent=a,DS=!0,s||t.layoutDependency!==r||r===void 0||t.isPresent!==a?i.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?i.promote():i.relegate()||ss.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),MN.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;DS=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function nL(e){const[t,r]=C7(),n=S.useContext(mN);return c.jsx(FJ,{...e,layoutGroup:n,switchLayoutGroup:S.useContext(M7),isPresent:t,safeToRemove:r})}const OJ={borderRadius:{...ex,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ex,borderTopRightRadius:ex,borderBottomLeftRadius:ex,borderBottomRightRadius:ex,boxShadow:PJ};function DJ(e,t,r){const n=Si(e)?e:mm(e);return n.start(qN("",n,t,r)),n.animation}const RJ=(e,t)=>e.depth-t.depth;class IJ{constructor(){this.children=[],this.isDirty=!1}add(t){yN(this.children,t),this.isDirty=!0}remove(t){vN(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(RJ),this.isDirty=!1,this.children.forEach(t)}}function MJ(e,t){const r=ho.now(),n=({timestamp:s})=>{const a=s-r;a>=t&&(vf(n),e(a-t))};return ss.setup(n,!0),()=>vf(n)}const sL=["TopLeft","TopRight","BottomLeft","BottomRight"],LJ=sL.length,$5=e=>typeof e=="string"?parseFloat(e):e,U5=e=>typeof e=="number"||Fr.test(e);function BJ(e,t,r,n,s,a){s?(e.opacity=ds(0,r.opacity??1,$J(n)),e.opacityExit=ds(t.opacity??1,0,UJ(n))):a&&(e.opacity=ds(t.opacity??1,r.opacity??1,n));for(let i=0;i<LJ;i++){const o=`border${sL[i]}Radius`;let l=z5(t,o),u=z5(r,o);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||U5(l)===U5(u)?(e[o]=Math.max(ds($5(l),$5(u),n),0),(Gc.test(u)||Gc.test(l))&&(e[o]+="%")):e[o]=u}(t.rotate||r.rotate)&&(e.rotate=ds(t.rotate||0,r.rotate||0,n))}function z5(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const $J=aL(0,.5,GM),UJ=aL(.5,.95,wl);function aL(e,t,r){return n=>n<e?0:n>t?1:r(Dy(e,t,n))}function W5(e,t){e.min=t.min,e.max=t.max}function al(e,t){W5(e.x,t.x),W5(e.y,t.y)}function H5(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function G5(e,t,r,n,s){return e-=t,e=gb(e,1/r,n),s!==void 0&&(e=gb(e,1/s,n)),e}function zJ(e,t=0,r=1,n=.5,s,a=e,i=e){if(Gc.test(t)&&(t=parseFloat(t),t=ds(i.min,i.max,t/100)-i.min),typeof t!="number")return;let o=ds(a.min,a.max,n);e===a&&(o-=t),e.min=G5(e.min,t,r,o,s),e.max=G5(e.max,t,r,o,s)}function V5(e,t,[r,n,s],a,i){zJ(e,t[r],t[n],t[s],t.scale,a,i)}const WJ=["x","scaleX","originX"],HJ=["y","scaleY","originY"];function K5(e,t,r,n){V5(e.x,t,WJ,r?r.x:void 0,n?n.x:void 0),V5(e.y,t,HJ,r?r.y:void 0,n?n.y:void 0)}function q5(e){return e.translate===0&&e.scale===1}function iL(e){return q5(e.x)&&q5(e.y)}function Y5(e,t){return e.min===t.min&&e.max===t.max}function GJ(e,t){return Y5(e.x,t.x)&&Y5(e.y,t.y)}function X5(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function oL(e,t){return X5(e.x,t.x)&&X5(e.y,t.y)}function J5(e){return Vi(e.x)/Vi(e.y)}function Q5(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class VJ{constructor(){this.members=[]}add(t){yN(this.members,t),t.scheduleRender()}remove(t){if(vN(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function KJ(e,t,r){let n="";const s=e.x.translate/t.x,a=e.y.translate/t.y,i=r?.z||0;if((s||a||i)&&(n=`translate3d(${s}px, ${a}px, ${i}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:u,rotate:d,rotateX:h,rotateY:g,skewX:p,skewY:x}=r;u&&(n=`perspective(${u}px) ${n}`),d&&(n+=`rotate(${d}deg) `),h&&(n+=`rotateX(${h}deg) `),g&&(n+=`rotateY(${g}deg) `),p&&(n+=`skewX(${p}deg) `),x&&(n+=`skewY(${x}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(n+=`scale(${o}, ${l})`),n||"none"}const RS=["","X","Y","Z"],qJ=1e3;let YJ=0;function IS(e,t,r,n){const{latestValues:s}=t;s[e]&&(r[e]=s[e],t.setStaticValue(e,0),n&&(n[e]=0))}function lL(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=K7(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",ss,!(s||a))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&lL(n)}function cL({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(i={},o=t?.()){this.id=YJ++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(QJ),this.nodes.forEach(rQ),this.nodes.forEach(nQ),this.nodes.forEach(ZJ)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new IJ)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new _N),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const l=this.eventHandlers.get(i);l&&l.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=k7(i)&&!UY(i),this.instance=i;const{layoutId:o,layout:l,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),e){let d,h=0;const g=()=>this.root.updateBlockedByResize=!1;ss.read(()=>{h=window.innerWidth}),e(i,()=>{const p=window.innerWidth;p!==h&&(h=p,this.root.updateBlockedByResize=!0,d&&d(),d=MJ(g,250),Zw.hasAnimatedSinceResize&&(Zw.hasAnimatedSinceResize=!1,this.nodes.forEach(t6)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||l)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:h,hasRelativeLayoutChanged:g,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||u.getDefaultTransition()||lQ,{onLayoutAnimationStart:v,onLayoutAnimationComplete:w}=u.getProps(),C=!this.targetLayout||!oL(this.targetLayout,p),k=!h&&g;if(this.options.layoutRoot||this.resumeFrom||k||h&&(C||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const _={...RN(x,"layout"),onPlay:v,onComplete:w};(u.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_),this.setAnimationOrigin(d,k)}else h||t6(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),vf(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(sQ),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&lL(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const h=this.path[d];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Z5);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(e6);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(tQ),this.nodes.forEach(XJ),this.nodes.forEach(JJ)):this.nodes.forEach(e6),this.clearAllSnapshots();const o=ho.now();Xa.delta=qu(0,1e3/60,o-Xa.timestamp),Xa.timestamp=o,Xa.isProcessing=!0,kS.update.process(Xa),kS.preRender.process(Xa),kS.render.process(Xa),Xa.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,MN.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(eQ),this.sharedNodes.forEach(aQ)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ss.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ss.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Vi(this.snapshot.measuredBox.x)&&!Vi(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=$s(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o&&this.instance){const l=n(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:l,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!iL(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;i&&this.instance&&(o||_h(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return i&&(l=this.removeTransform(l)),cQ(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:i}=this.options;if(!i)return $s();const o=i.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(uQ))){const{scroll:u}=this.root;u&&(Kg(o.x,u.offset.x),Kg(o.y,u.offset.y))}return o}removeElementScroll(i){const o=$s();if(al(o,i),this.scroll?.wasRoot)return o;for(let l=0;l<this.path.length;l++){const u=this.path[l],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&al(o,i),Kg(o.x,d.offset.x),Kg(o.y,d.offset.y))}return o}applyTransform(i,o=!1){const l=$s();al(l,i);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&qg(l,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),_h(d.latestValues)&&qg(l,d.latestValues)}return _h(this.latestValues)&&qg(l,this.latestValues),l}removeTransform(i){const o=$s();al(o,i);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!_h(u.latestValues))continue;bT(u.latestValues)&&u.updateSnapshot();const d=$s(),h=u.measurePageBox();al(d,h),K5(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return _h(this.latestValues)&&K5(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Xa.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(i||l&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:h}=this.options;if(!(!this.layout||!(d||h))){if(this.resolvedRelativeTargetAt=Xa.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$s(),this.relativeTargetOrigin=$s(),py(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),al(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=$s(),this.targetWithTransforms=$s()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),pJ(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):al(this.target,this.layout.layoutBox),U7(this.target,this.targetDelta)):al(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$s(),this.relativeTargetOrigin=$s(),py(this.relativeTargetOrigin,this.target,g.target),al(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||bT(this.parent.latestValues)||$7(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const i=this.getLead(),o=!!this.resumingFrom||this!==i;let l=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Xa.timestamp&&(l=!1),l)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;al(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,g=this.treeScale.y;NX(this.layoutCorrected,this.treeScale,this.path,o),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=$s());const{target:p}=i;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(H5(this.prevProjectionDelta.x,this.projectionDelta.x),H5(this.prevProjectionDelta.y,this.projectionDelta.y)),my(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==g||!Q5(this.projectionDelta.x,this.prevProjectionDelta.x)||!Q5(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){if(this.options.visualElement?.scheduleRender(),i){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Yg(),this.projectionDelta=Yg(),this.projectionDeltaWithTransform=Yg()}setAnimationOrigin(i,o=!1){const l=this.snapshot,u=l?l.latestValues:{},d={...this.latestValues},h=Yg();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const g=$s(),p=l?l.source:void 0,x=this.layout?this.layout.source:void 0,v=p!==x,w=this.getStack(),C=!w||w.members.length<=1,k=!!(v&&!C&&this.options.crossfade===!0&&!this.path.some(oQ));this.animationProgress=0;let _;this.mixTargetDelta=N=>{const E=N/1e3;r6(h.x,i.x,E),r6(h.y,i.y,E),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(py(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),iQ(this.relativeTarget,this.relativeTargetOrigin,g,E),_&&GJ(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=$s()),al(_,this.relativeTarget)),v&&(this.animationValues=d,BJ(d,u,this.latestValues,E,k,C)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=E},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(vf(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ss.update(()=>{Zw.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=mm(0)),this.currentAnimation=DJ(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:o=>{this.mixTargetDelta(o),i.onUpdate&&i.onUpdate(o)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(qJ),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:l,layout:u,latestValues:d}=i;if(!(!o||!l||!u)){if(this!==i&&this.layout&&u&&uL(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||$s();const h=Vi(this.layout.layoutBox.x);l.x.min=i.target.x.min,l.x.max=l.x.min+h;const g=Vi(this.layout.layoutBox.y);l.y.min=i.target.y.min,l.y.max=l.y.min+g}al(o,l),qg(o,d),my(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new VJ),this.sharedNodes.get(i).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){const{layoutId:i}=this.options;return i?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:i}=this.options;return i?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:l}=i;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const u={};l.z&&IS("z",i,u,this.animationValues);for(let d=0;d<RS.length;d++)IS(`rotate${RS[d]}`,i,u,this.animationValues),IS(`skew${RS[d]}`,i,u,this.animationValues);i.render();for(const d in u)i.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);i.scheduleRender()}applyProjectionStyles(i,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=Qw(o?.pointerEvents)||"",i.transform=l?l(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=Qw(o?.pointerEvents)||""),this.hasProjected&&!_h(this.latestValues)&&(i.transform=l?l({},""):"none",this.hasProjected=!1);return}i.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let h=KJ(this.projectionDeltaWithTransform,this.treeScale,d);l&&(h=l(d,h)),i.transform=h;const{x:g,y:p}=this.projectionDelta;i.transformOrigin=`${g.origin*100}% ${p.origin*100}% 0`,u.animationValues?i.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:i.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const x in Ly){if(d[x]===void 0)continue;const{correct:v,applyTo:w,isCSSVariable:C}=Ly[x],k=h==="none"?d[x]:v(d[x],u);if(w){const _=w.length;for(let N=0;N<_;N++)i[w[N]]=k}else C?this.options.visualElement.renderState.vars[x]=k:i[x]=k}this.options.layoutId&&(i.pointerEvents=u===this?Qw(o?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>i.currentAnimation?.stop()),this.root.nodes.forEach(Z5),this.root.sharedNodes.clear()}}}function XJ(e){e.updateLayout()}function JJ(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:n}=e.layout,{animationType:s}=e.options,a=t.source!==e.layout.source;s==="size"?fl(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],g=Vi(h);h.min=r[d].min,h.max=h.min+g}):uL(s,t.layoutBox,r)&&fl(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],g=Vi(r[d]);h.max=h.min+g,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+g)});const i=Yg();my(i,r,t.layoutBox);const o=Yg();a?my(o,e.applyTransform(n,!0),t.measuredBox):my(o,r,t.layoutBox);const l=!iL(i);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:g}=d;if(h&&g){const p=$s();py(p,t.layoutBox,h.layoutBox);const x=$s();py(x,r,g.layoutBox),oL(p,x)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=x,e.relativeTargetOrigin=p,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:o,layoutDelta:i,hasLayoutChanged:l,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function QJ(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function ZJ(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function eQ(e){e.clearSnapshot()}function Z5(e){e.clearMeasurements()}function e6(e){e.isLayoutDirty=!1}function tQ(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function t6(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function rQ(e){e.resolveTargetDelta()}function nQ(e){e.calcProjection()}function sQ(e){e.resetSkewAndRotation()}function aQ(e){e.removeLeadSnapshot()}function r6(e,t,r){e.translate=ds(t.translate,0,r),e.scale=ds(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function n6(e,t,r,n){e.min=ds(t.min,r.min,n),e.max=ds(t.max,r.max,n)}function iQ(e,t,r,n){n6(e.x,t.x,r.x,n),n6(e.y,t.y,r.y,n)}function oQ(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const lQ={duration:.45,ease:[.4,0,.1,1]},s6=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),a6=s6("applewebkit/")&&!s6("chrome/")?Math.round:wl;function i6(e){e.min=a6(e.min),e.max=a6(e.max)}function cQ(e){i6(e.x),i6(e.y)}function uL(e,t,r){return e==="position"||e==="preserve-aspect"&&!mJ(J5(t),J5(r),.2)}function uQ(e){return e!==e.root&&e.scroll?.wasRoot}const dQ=cL({attachResizeListener:(e,t)=>By(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),MS={current:void 0},dL=cL({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!MS.current){const e=new dQ({});e.mount(window),e.setOptions({layoutScroll:!0}),MS.current=e}return MS.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),fQ={pan:{Feature:jJ},drag:{Feature:AJ,ProjectionNode:dL,MeasureLayout:nL}};function o6(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,a=n[s];a&&ss.postRender(()=>a(t,Tv(t)))}class hQ extends Af{mount(){const{current:t}=this.node;t&&(this.unmount=IY(t,(r,n)=>(o6(this.node,n,"Start"),s=>o6(this.node,s,"End"))))}unmount(){}}class gQ extends Af{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Sv(By(this.node.current,"focus",()=>this.onFocus()),By(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function l6(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),a=n[s];a&&ss.postRender(()=>a(t,Tv(t)))}class mQ extends Af{mount(){const{current:t}=this.node;t&&(this.unmount=$Y(t,(r,n)=>(l6(this.node,n,"Start"),(s,{success:a})=>l6(this.node,s,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const NT=new WeakMap,LS=new WeakMap,pQ=e=>{const t=NT.get(e.target);t&&t(e)},xQ=e=>{e.forEach(pQ)};function yQ({root:e,...t}){const r=e||document;LS.has(r)||LS.set(r,{});const n=LS.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(xQ,{root:e,...t})),n[s]}function vQ(e,t,r){const n=yQ(t);return NT.set(e,r),n.observe(e),()=>{NT.delete(e),n.unobserve(e)}}const wQ={some:0,all:1};class bQ extends Af{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=t,i={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:wQ[s]},o=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:h}=this.node.getProps(),g=u?d:h;g&&g(l)};return vQ(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(_Q(t,r))&&this.startObserver()}unmount(){}}function _Q({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const SQ={inView:{Feature:bQ},tap:{Feature:mQ},focus:{Feature:gQ},hover:{Feature:hQ}},kQ={layout:{ProjectionNode:dL,MeasureLayout:nL}},CQ={...cJ,...SQ,...fQ,...kQ},st=CX(CQ,LX),Je=({children:e,variant:t="primary",size:r="md",onClick:n,disabled:s=!1,className:a="",...i})=>{const o="font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer",l={primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",success:"bg-green-600 hover:bg-green-700 text-white focus:ring-green-500",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500",warning:"bg-yellow-600 hover:bg-yellow-700 text-white focus:ring-yellow-500",outline:"bg-transparent text-blue-600 border-2 border-blue-600 hover:bg-blue-600 hover:text-white focus:ring-blue-500",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-500"},u={xs:"px-2 py-1 text-xs",sm:"px-2 py-1 text-xs sm:px-3 sm:py-1.5 sm:text-sm",md:"px-3 py-1.5 text-sm sm:px-4 sm:py-2 sm:text-base",lg:"px-4 py-2 text-base sm:px-6 sm:py-3 sm:text-lg",icon:"p-0 flex items-center justify-center"},d=s?"opacity-50 cursor-not-allowed":"";return c.jsx(st.button,{className:`${o} ${l[t]} ${u[r]} ${d} ${a}`,onClick:n,disabled:s,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},...i,children:e})},Ur=({size:e="md",color:t="blue",className:r=""})=>{const n={sm:"w-4 h-4",small:"w-4 h-4",md:"w-6 h-6",medium:"w-6 h-6",lg:"w-8 h-8",large:"w-8 h-8",xl:"w-12 h-12"},s={blue:"border-blue-600",green:"border-green-600",red:"border-red-600",yellow:"border-yellow-600",gray:"border-gray-600"};return c.jsx(st.div,{className:`
        inline-block border-2 border-gray-300 border-t-current rounded-full animate-spin
        ${n[e]} ${s[t]} ${r}
      `,animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})},ac=({type:e="info",message:t="",duration:r=3e3,closable:n=!0,onClose:s,className:a="",...i})=>{const[o,l]=S.useState(!0),[u,d]=S.useState(!1),h=S.useRef(null),g=S.useRef(null);S.useEffect(()=>{if(r>0)return g.current=setTimeout(()=>{p()},r),()=>{g.current&&clearTimeout(g.current)}},[r]);const p=S.useCallback(()=>{u||(d(!0),g.current&&clearTimeout(g.current),setTimeout(()=>{l(!1),s&&s()},300))},[u,s]),x=S.useCallback(C=>{C.key==="Escape"&&p()},[p]);if(!o)return null;const v=["notification",`notification-${e}`,o?"notification-visible":"",u?"notification-exiting":"",a].filter(Boolean).join(" "),w=()=>{switch(e){case"success":return"";case"error":return"";case"warning":return"";case"info":default:return""}};return c.jsx("div",{ref:h,className:v,role:"alert","aria-live":"polite",onKeyDown:x,tabIndex:-1,...i,children:c.jsxs("div",{className:"notification-content",children:[c.jsx("div",{className:"notification-icon","aria-hidden":"true",children:w()}),c.jsx("div",{className:"notification-body",children:c.jsx("div",{className:"notification-message",children:t})}),n&&c.jsx("button",{className:"notification-close",onClick:p,type:"button","aria-label":"Close notification",children:""})]})})},Da=()=>{const[e,t]=S.useState([]),r=S.useCallback((a,i="info",o={})=>{const l=Date.now()+Math.random(),u={id:l,message:a,type:i,...o};return t(d=>[...d,u]),o.duration!==0&&setTimeout(()=>{n(l)},o.duration||3e3),l},[]),n=S.useCallback(a=>{t(i=>i.filter(o=>o.id!==a))},[]),s=S.useCallback(()=>{t([])},[]);return{notifications:e,showNotification:r,removeNotification:n,clearAllNotifications:s}},Wo=()=>{const[e,t]=S.useState(!1),[r,n]=S.useState(null),[s,a]=S.useState(null),i=S.useRef(null);S.useRef(new Map);const o=S.useRef(0),l=3,u=1e3,d=S.useCallback(()=>{i.current&&(i.current.abort(),i.current=null)},[]);S.useEffect(()=>d,[d]);const h=S.useCallback(async(I,B={})=>{try{t(!0),n(null),i.current=new AbortController;const q=B.method||"POST",J={method:q,headers:{"Content-Type":"application/json",...B.headers},signal:i.current.signal,...B};q!=="GET"&&q!=="HEAD"&&(J.body=JSON.stringify(B.data||{})),console.log(`[API] Making request to: ${I}`,J);const se=await fetch(I,J);if(!se.ok)throw new Error(`HTTP error! status: ${se.status}`);const X=await se.json();if(console.log("[API] Response received:",X),X.success)return a(X),o.current=0,X;throw new Error(X.error||X.message||"Request failed")}catch(q){if(q.name==="AbortError")return console.log("[API] Request was aborted"),null;if(console.error("[API] Request failed:",q),n(q.message||"Request failed"),o.current<l){o.current++;const J=u*Math.pow(2,o.current-1);return console.log(`[API] Retrying in ${J}ms (attempt ${o.current}/${l})`),await new Promise(se=>setTimeout(se,J)),h(I,B)}throw q}finally{t(!1),i.current=null}},[]),g=S.useCallback(async(I,B={})=>{try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");return await window.tokenManager.makeAuthenticatedRequest(I,B)}catch(q){throw console.error("[API] Authenticated request failed:",q),q}},[]),p=S.useCallback(async(I,B)=>{try{const q=`/.netlify/functions/get-test-questions?test_type=${I}&test_id=${B}`;console.log(`[API] Getting test info for ${I}_${B}`);const se=await(await g(q)).json();if(se.success)return console.log("[API] Test info retrieved successfully:",se.test_info),se.test_info;throw new Error(se.error||"Failed to get test info")}catch(q){throw console.error("[API] Failed to get test info:",q),q}},[g]),x=S.useCallback(async(I,B)=>{try{const q=`/.netlify/functions/get-test-questions?test_type=${I}&test_id=${B}`;console.log(`[API] Getting test questions for ${I}_${B}`);const se=await(await g(q)).json();if(se.success)return console.log("[API] Test questions retrieved successfully:",se.questions),se.questions;throw new Error(se.error||"Failed to get test questions")}catch(q){throw console.error("[API] Failed to get test questions:",q),q}},[g]),v=S.useCallback(async()=>{try{const I="/.netlify/functions/get-student-active-tests";console.log("[API] Loading student active tests");const q=await(await g(I)).json();if(q.success)return console.log("[API] Student active tests loaded successfully:",q.tests),q.tests;throw new Error(q.error||"Failed to load student active tests")}catch(I){throw console.error("[API] Failed to load student active tests:",I),I}},[g]),w=S.useCallback(async(I,B,q)=>{try{let J;switch(I){case"true_false":J="/.netlify/functions/submit-true-false-test";break;case"multiple_choice":J="/.netlify/functions/submit-multiple-choice-test";break;case"input":J="/.netlify/functions/submit-input-test";break;case"matching_type":J="/.netlify/functions/submit-matching-type-test";break;case"speaking":J="/.netlify/functions/submit-speaking-test";break;default:throw new Error(`Unknown test type: ${I}`)}console.log(`[API] Submitting ${I} test:`,q);const X=await(await g(J,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(q)})).json();if(X.success)return console.log("[API] Test submitted successfully:",X),X;throw new Error(X.error||"Failed to submit test")}catch(J){throw console.error("[API] Failed to submit test:",J),J}},[g]),C=S.useCallback(async I=>{try{const B="/.netlify/functions/save-multiple-choice-test";console.log("[API] Saving multiple choice test:",I);const J=await(await g(B,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)})).json();if(J.success)return console.log("[API] Multiple choice test saved successfully:",J),J;throw new Error(J.error||"Failed to save multiple choice test")}catch(B){throw console.error("[API] Failed to save multiple choice test:",B),B}},[g]),k=S.useCallback(async I=>{try{const B="/.netlify/functions/save-true-false-test";console.log("[API] Saving true/false test:",I);const J=await(await g(B,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)})).json();if(J.success)return console.log("[API] True/false test saved successfully:",J),J;throw new Error(J.error||"Failed to save true/false test")}catch(B){throw console.error("[API] Failed to save true/false test:",B),B}},[g]),_=S.useCallback(async I=>{try{const B="/.netlify/functions/save-input-test";console.log("[API] Saving input test:",I);const J=await(await g(B,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)})).json();if(J.success)return console.log("[API] Input test saved successfully:",J),J;throw new Error(J.error||"Failed to save input test")}catch(B){throw console.error("[API] Failed to save input test:",B),B}},[g]),N=S.useCallback(async I=>{try{const B="/.netlify/functions/assign-test";console.log("[API] Assigning test to classes:",I);const J=await(await g(B,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)})).json();if(J.success)return console.log("[API] Test assigned successfully:",J),J;throw new Error(J.error||"Failed to assign test")}catch(B){throw console.error("[API] Failed to assign test:",B),B}},[g]),E=S.useCallback(async()=>{try{const I="/.netlify/functions/get-teacher-active-tests";console.log("[API] Loading teacher active tests");const q=await(await g(I)).json();if(q.success)return console.log("[API] Teacher active tests loaded successfully:",q.tests),q.tests;throw new Error(q.error||"Failed to load teacher active tests")}catch(I){throw console.error("[API] Failed to load teacher active tests:",I),I}},[g]),P=S.useCallback(async()=>{try{const I="/.netlify/functions/get-all-users";console.log("[API] Getting all users");const q=await(await g(I)).json();if(q.success)return console.log("[API] All users loaded successfully:",q.users),q.users;throw new Error(q.error||"Failed to get all users")}catch(I){throw console.error("[API] Failed to get all users:",I),I}},[g]),F=S.useCallback(async()=>{try{const I="/.netlify/functions/get-all-teachers";console.log("[API] Getting all teachers");const q=await(await g(I)).json();if(q.success)return console.log("[API] All teachers loaded successfully:",q.teachers),q.teachers;throw new Error(q.error||"Failed to get all teachers")}catch(I){throw console.error("[API] Failed to get all teachers:",I),I}},[g]),A=S.useCallback(async()=>{try{const I="/.netlify/functions/get-all-subjects";console.log("[API] Getting all subjects");const q=await(await g(I)).json();if(q.success)return console.log("[API] All subjects loaded successfully:",q.subjects),q.subjects;throw new Error(q.error||"Failed to get all subjects")}catch(I){throw console.error("[API] Failed to get all subjects:",I),I}},[g]),j=S.useCallback(()=>{n(null)},[]),R=S.useCallback(()=>{a(null)},[]),U=S.useCallback(()=>{t(!1),n(null),a(null),o.current=0,d()},[d]),Y=S.useCallback(async(I,B={})=>{const J=await(await g(I,{...B,method:"GET"})).json();if(J.success)return J;throw new Error(J.error||"Request failed")},[g]),Z=S.useCallback(async(I,B,q={})=>{const se=await(await g(I,{...q,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)})).json();if(se.success)return se;throw new Error(se.error||"Request failed")},[g]),ae=S.useCallback(async(I,B,q={})=>{const se=await(await g(I,{...q,method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)})).json();if(se.success)return se;throw new Error(se.error||"Request failed")},[g]),ee=S.useCallback(async(I,B={})=>{const J=await(await g(I,{...B,method:"DELETE"})).json();if(J.success)return J;throw new Error(J.error||"Request failed")},[g]),ne=S.useCallback(async I=>{try{const B="/.netlify/functions/submit-speaking-test";console.log("[API] Submitting speaking test:",I);const J=await(await g(B,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)})).json();if(J.success)return console.log("[API] Speaking test submitted successfully:",J),J;throw new Error(J.error||"Failed to submit speaking test")}catch(B){throw console.error("[API] Failed to submit speaking test:",B),B}},[g]),L=S.useCallback(async I=>{try{const B=`/.netlify/functions/get-speaking-test-new?action=test&test_id=${I}`;console.log("[API] Getting speaking test:",I);const J=await(await g(B,{method:"GET"})).json();if(J.success)return console.log("[API] Speaking test loaded successfully:",J),J;throw new Error(J.error||"Failed to load speaking test")}catch(B){throw console.error("[API] Failed to load speaking test:",B),B}},[g]),H=S.useCallback(async I=>{try{const B=`/.netlify/functions/get-speaking-test-new?action=questions&test_id=${I}`;console.log("[API] Getting speaking test questions:",I);const J=await(await g(B,{method:"GET"})).json();if(J.success)return console.log("[API] Speaking test questions loaded successfully:",J),J;throw new Error(J.error||"Failed to load speaking test questions")}catch(B){throw console.error("[API] Failed to load speaking test questions:",B),B}},[g]),M=S.useCallback(async I=>{try{const B="/.netlify/functions/upload-speaking-audio";console.log("[API] Uploading speaking audio");const J=await(await g(B,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)})).json();if(J.success)return console.log("[API] Audio uploaded successfully:",J),J;throw new Error(J.error||"Failed to upload audio")}catch(B){throw console.error("[API] Failed to upload audio:",B),B}},[g]),V=S.useCallback(async I=>{try{const B=`/.netlify/functions/get-speaking-test-new?action=audio&file_path=${encodeURIComponent(I)}`;console.log("[API] Getting speaking audio:",I);const J=await(await g(B,{method:"GET"})).json();if(J.success)return console.log("[API] Audio URL retrieved successfully:",J),J;throw new Error(J.error||"Failed to get audio")}catch(B){throw console.error("[API] Failed to get audio:",B),B}},[g]),W=S.useCallback(async(I,B)=>{try{const q=`/.netlify/functions/check-test-completion?test_id=${I}&test_type=${B}`;console.log("[API] Checking test completion:",I,B);const se=await(await g(q,{method:"GET"})).json();if(se.success)return console.log("[API] Test completion status:",se),se;throw new Error(se.error||"Failed to check test completion")}catch(q){throw console.error("[API] Failed to check test completion:",q),q}},[g]);return{loading:e,error:r,data:s,sendRequest:h,makeAuthenticatedRequest:g,get:Y,post:Z,put:ae,delete:ee,getTestInfo:p,getTestQuestions:x,loadStudentActiveTests:v,submitTest:w,submitSpeakingTest:ne,getSpeakingTest:L,getSpeakingTestQuestions:H,uploadSpeakingAudio:M,getSpeakingAudio:V,checkTestCompletion:W,saveMultipleChoiceTest:C,saveTrueFalseTest:k,saveInputTest:_,assignTestToClasses:N,loadTeacherActiveTests:E,getAllUsers:P,getAllTeachers:F,getAllSubjects:A,clearError:j,clearData:R,reset:U,cleanup:d}},TQ="modulepreload",EQ=function(e){return"/"+e},c6={},Gi=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){let u=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};var i=u;document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");s=u(r.map(d=>{if(d=EQ(d),d in c6)return;c6[d]=!0;const h=d.endsWith(".css"),g=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${g}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":TQ,h||(p.as="script"),p.crossOrigin="",p.href=d,l&&p.setAttribute("nonce",l),document.head.appendChild(p),h)return new Promise((x,v)=>{p.addEventListener("load",x),p.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return t().catch(a)})};var eb={exports:{}},tx={},BS={},$S={},u6;function Xr(){return u6||(u6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const t=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}e.glob=typeof cb<"u"?cb:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},e.Konva={_global:e.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(s){}).toString()),dblClickWindow:400,getAngle(s){return e.Konva.angleDeg?s*t:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva.DD.isDragging},isTransforming(){var s;return(s=e.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!e.Konva.DD.node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(s){e.glob.Konva=s}};const n=s=>{e.Konva[s.prototype.getClassName()]=s};e._registerNode=n,e.Konva._injectGlobal(e.Konva)})($S)),$S}var US={},d6;function js(){return d6||(d6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const t=Xr();class r{constructor(N=[1,0,0,1,0,0]){this.dirty=!1,this.m=N&&N.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(N){N.m[0]=this.m[0],N.m[1]=this.m[1],N.m[2]=this.m[2],N.m[3]=this.m[3],N.m[4]=this.m[4],N.m[5]=this.m[5]}point(N){const E=this.m;return{x:E[0]*N.x+E[2]*N.y+E[4],y:E[1]*N.x+E[3]*N.y+E[5]}}translate(N,E){return this.m[4]+=this.m[0]*N+this.m[2]*E,this.m[5]+=this.m[1]*N+this.m[3]*E,this}scale(N,E){return this.m[0]*=N,this.m[1]*=N,this.m[2]*=E,this.m[3]*=E,this}rotate(N){const E=Math.cos(N),P=Math.sin(N),F=this.m[0]*E+this.m[2]*P,A=this.m[1]*E+this.m[3]*P,j=this.m[0]*-P+this.m[2]*E,R=this.m[1]*-P+this.m[3]*E;return this.m[0]=F,this.m[1]=A,this.m[2]=j,this.m[3]=R,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(N,E){const P=this.m[0]+this.m[2]*E,F=this.m[1]+this.m[3]*E,A=this.m[2]+this.m[0]*N,j=this.m[3]+this.m[1]*N;return this.m[0]=P,this.m[1]=F,this.m[2]=A,this.m[3]=j,this}multiply(N){const E=this.m[0]*N.m[0]+this.m[2]*N.m[1],P=this.m[1]*N.m[0]+this.m[3]*N.m[1],F=this.m[0]*N.m[2]+this.m[2]*N.m[3],A=this.m[1]*N.m[2]+this.m[3]*N.m[3],j=this.m[0]*N.m[4]+this.m[2]*N.m[5]+this.m[4],R=this.m[1]*N.m[4]+this.m[3]*N.m[5]+this.m[5];return this.m[0]=E,this.m[1]=P,this.m[2]=F,this.m[3]=A,this.m[4]=j,this.m[5]=R,this}invert(){const N=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),E=this.m[3]*N,P=-this.m[1]*N,F=-this.m[2]*N,A=this.m[0]*N,j=N*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),R=N*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=E,this.m[1]=P,this.m[2]=F,this.m[3]=A,this.m[4]=j,this.m[5]=R,this}getMatrix(){return this.m}decompose(){const N=this.m[0],E=this.m[1],P=this.m[2],F=this.m[3],A=this.m[4],j=this.m[5],R=N*F-E*P,U={x:A,y:j,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(N!=0||E!=0){const Y=Math.sqrt(N*N+E*E);U.rotation=E>0?Math.acos(N/Y):-Math.acos(N/Y),U.scaleX=Y,U.scaleY=R/Y,U.skewX=(N*P+E*F)/R,U.skewY=0}else if(P!=0||F!=0){const Y=Math.sqrt(P*P+F*F);U.rotation=Math.PI/2-(F>0?Math.acos(-P/Y):-Math.acos(P/Y)),U.scaleX=R/Y,U.scaleY=Y,U.skewX=0,U.skewY=(N*P+E*F)/R}return U.rotation=e.Util._getRotation(U.rotation),U}}e.Transform=r;const n="[object Array]",s="[object Number]",a="[object String]",i="[object Boolean]",o=Math.PI/180,l=180/Math.PI,u="#",d="",h="0",g="Konva warning: ",p="Konva error: ",x="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},w=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let C=[];const k=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(_){setTimeout(_,60)};e.Util={_isElement(_){return!!(_&&_.nodeType==1)},_isFunction(_){return!!(_&&_.constructor&&_.call&&_.apply)},_isPlainObject(_){return!!_&&_.constructor===Object},_isArray(_){return Object.prototype.toString.call(_)===n},_isNumber(_){return Object.prototype.toString.call(_)===s&&!isNaN(_)&&isFinite(_)},_isString(_){return Object.prototype.toString.call(_)===a},_isBoolean(_){return Object.prototype.toString.call(_)===i},isObject(_){return _ instanceof Object},isValidSelector(_){if(typeof _!="string")return!1;const N=_[0];return N==="#"||N==="."||N===N.toUpperCase()},_sign(_){return _===0||_>0?1:-1},requestAnimFrame(_){C.push(_),C.length===1&&k(function(){const N=C;C=[],N.forEach(function(E){E()})})},createCanvasElement(){const _=document.createElement("canvas");try{_.style=_.style||{}}catch{}return _},createImageElement(){return document.createElement("img")},_isInDocument(_){for(;_=_.parentNode;)if(_==document)return!0;return!1},_urlToImage(_,N){const E=e.Util.createImageElement();E.onload=function(){N(E)},E.src=_},_rgbToHex(_,N,E){return((1<<24)+(_<<16)+(N<<8)+E).toString(16).slice(1)},_hexToRgb(_){_=_.replace(u,d);const N=parseInt(_,16);return{r:N>>16&255,g:N>>8&255,b:N&255}},getRandomColor(){let _=(Math.random()*16777215<<0).toString(16);for(;_.length<6;)_=h+_;return u+_},getRGB(_){let N;return _ in v?(N=v[_],{r:N[0],g:N[1],b:N[2]}):_[0]===u?this._hexToRgb(_.substring(1)):_.substr(0,4)===x?(N=w.exec(_.replace(/ /g,"")),{r:parseInt(N[1],10),g:parseInt(N[2],10),b:parseInt(N[3],10)}):{r:0,g:0,b:0}},colorToRGBA(_){return _=_||"black",e.Util._namedColorToRBA(_)||e.Util._hex3ColorToRGBA(_)||e.Util._hex4ColorToRGBA(_)||e.Util._hex6ColorToRGBA(_)||e.Util._hex8ColorToRGBA(_)||e.Util._rgbColorToRGBA(_)||e.Util._rgbaColorToRGBA(_)||e.Util._hslColorToRGBA(_)},_namedColorToRBA(_){const N=v[_.toLowerCase()];return N?{r:N[0],g:N[1],b:N[2],a:1}:null},_rgbColorToRGBA(_){if(_.indexOf("rgb(")===0){_=_.match(/rgb\(([^)]+)\)/)[1];const N=_.split(/ *, */).map(Number);return{r:N[0],g:N[1],b:N[2],a:1}}},_rgbaColorToRGBA(_){if(_.indexOf("rgba(")===0){_=_.match(/rgba\(([^)]+)\)/)[1];const N=_.split(/ *, */).map((E,P)=>E.slice(-1)==="%"?P===3?parseInt(E)/100:parseInt(E)/100*255:Number(E));return{r:N[0],g:N[1],b:N[2],a:N[3]}}},_hex8ColorToRGBA(_){if(_[0]==="#"&&_.length===9)return{r:parseInt(_.slice(1,3),16),g:parseInt(_.slice(3,5),16),b:parseInt(_.slice(5,7),16),a:parseInt(_.slice(7,9),16)/255}},_hex6ColorToRGBA(_){if(_[0]==="#"&&_.length===7)return{r:parseInt(_.slice(1,3),16),g:parseInt(_.slice(3,5),16),b:parseInt(_.slice(5,7),16),a:1}},_hex4ColorToRGBA(_){if(_[0]==="#"&&_.length===5)return{r:parseInt(_[1]+_[1],16),g:parseInt(_[2]+_[2],16),b:parseInt(_[3]+_[3],16),a:parseInt(_[4]+_[4],16)/255}},_hex3ColorToRGBA(_){if(_[0]==="#"&&_.length===4)return{r:parseInt(_[1]+_[1],16),g:parseInt(_[2]+_[2],16),b:parseInt(_[3]+_[3],16),a:1}},_hslColorToRGBA(_){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(_)){const[N,...E]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(_),P=Number(E[0])/360,F=Number(E[1])/100,A=Number(E[2])/100;let j,R,U;if(F===0)return U=A*255,{r:Math.round(U),g:Math.round(U),b:Math.round(U),a:1};A<.5?j=A*(1+F):j=A+F-A*F;const Y=2*A-j,Z=[0,0,0];for(let ae=0;ae<3;ae++)R=P+1/3*-(ae-1),R<0&&R++,R>1&&R--,6*R<1?U=Y+(j-Y)*6*R:2*R<1?U=j:3*R<2?U=Y+(j-Y)*(2/3-R)*6:U=Y,Z[ae]=U*255;return{r:Math.round(Z[0]),g:Math.round(Z[1]),b:Math.round(Z[2]),a:1}}},haveIntersection(_,N){return!(N.x>_.x+_.width||N.x+N.width<_.x||N.y>_.y+_.height||N.y+N.height<_.y)},cloneObject(_){const N={};for(const E in _)this._isPlainObject(_[E])?N[E]=this.cloneObject(_[E]):this._isArray(_[E])?N[E]=this.cloneArray(_[E]):N[E]=_[E];return N},cloneArray(_){return _.slice(0)},degToRad(_){return _*o},radToDeg(_){return _*l},_degToRad(_){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(_)},_radToDeg(_){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(_)},_getRotation(_){return t.Konva.angleDeg?e.Util.radToDeg(_):_},_capitalize(_){return _.charAt(0).toUpperCase()+_.slice(1)},throw(_){throw new Error(p+_)},error(_){console.error(p+_)},warn(_){t.Konva.showWarnings&&console.warn(g+_)},each(_,N){for(const E in _)N(E,_[E])},_inRange(_,N,E){return N<=_&&_<E},_getProjectionToSegment(_,N,E,P,F,A){let j,R,U;const Y=(_-E)*(_-E)+(N-P)*(N-P);if(Y==0)j=_,R=N,U=(F-E)*(F-E)+(A-P)*(A-P);else{const Z=((F-_)*(E-_)+(A-N)*(P-N))/Y;Z<0?(j=_,R=N,U=(_-F)*(_-F)+(N-A)*(N-A)):Z>1?(j=E,R=P,U=(E-F)*(E-F)+(P-A)*(P-A)):(j=_+Z*(E-_),R=N+Z*(P-N),U=(j-F)*(j-F)+(R-A)*(R-A))}return[j,R,U]},_getProjectionToLine(_,N,E){const P=e.Util.cloneObject(_);let F=Number.MAX_VALUE;return N.forEach(function(A,j){if(!E&&j===N.length-1)return;const R=N[(j+1)%N.length],U=e.Util._getProjectionToSegment(A.x,A.y,R.x,R.y,_.x,_.y),Y=U[0],Z=U[1],ae=U[2];ae<F&&(P.x=Y,P.y=Z,F=ae)}),P},_prepareArrayForTween(_,N,E){const P=[],F=[];if(_.length>N.length){const j=N;N=_,_=j}for(let j=0;j<_.length;j+=2)P.push({x:_[j],y:_[j+1]});for(let j=0;j<N.length;j+=2)F.push({x:N[j],y:N[j+1]});const A=[];return F.forEach(function(j){const R=e.Util._getProjectionToLine(j,P,E);A.push(R.x),A.push(R.y)}),A},_prepareToStringify(_){let N;_.visitedByCircularReferenceRemoval=!0;for(const E in _)if(_.hasOwnProperty(E)&&_[E]&&typeof _[E]=="object"){if(N=Object.getOwnPropertyDescriptor(_,E),_[E].visitedByCircularReferenceRemoval||e.Util._isElement(_[E]))if(N.configurable)delete _[E];else return null;else if(e.Util._prepareToStringify(_[E])===null)if(N.configurable)delete _[E];else return null}return delete _.visitedByCircularReferenceRemoval,_},_assign(_,N){for(const E in N)_[E]=N[E];return _},_getFirstPointerId(_){return _.touches?_.changedTouches[0].identifier:_.pointerId||999},releaseCanvas(..._){t.Konva.releaseCanvasOnDestroy&&_.forEach(N=>{N.width=0,N.height=0})},drawRoundedRectPath(_,N,E,P){let F=0,A=0,j=0,R=0;typeof P=="number"?F=A=j=R=Math.min(P,N/2,E/2):(F=Math.min(P[0]||0,N/2,E/2),A=Math.min(P[1]||0,N/2,E/2),R=Math.min(P[2]||0,N/2,E/2),j=Math.min(P[3]||0,N/2,E/2)),_.moveTo(F,0),_.lineTo(N-A,0),_.arc(N-A,A,A,Math.PI*3/2,0,!1),_.lineTo(N,E-R),_.arc(N-R,E-R,R,0,Math.PI/2,!1),_.lineTo(j,E),_.arc(j,E-j,j,Math.PI/2,Math.PI,!1),_.lineTo(0,F),_.arc(F,F,F,Math.PI,Math.PI*3/2,!1)}}})(US)),US}var rx={},Eu={},Nu={},f6;function fL(){if(f6)return Nu;f6=1,Object.defineProperty(Nu,"__esModule",{value:!0}),Nu.HitContext=Nu.SceneContext=Nu.Context=void 0;const e=js(),t=Xr();function r(C){const k=[],_=C.length,N=e.Util;for(let E=0;E<_;E++){let P=C[E];N._isNumber(P)?P=Math.round(P*1e3)/1e3:N._isString(P)||(P=P+""),k.push(P)}return k}const n=",",s="(",a=")",i="([",o="])",l=";",u="()",d="=",h=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],g=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],p=100;let x=class{constructor(k){this.canvas=k,t.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(k){k.fillEnabled()&&this._fill(k)}_fill(k){}strokeShape(k){k.hasStroke()&&this._stroke(k)}_stroke(k){}fillStrokeShape(k){k.attrs.fillAfterStrokeEnabled?(this.strokeShape(k),this.fillShape(k)):(this.fillShape(k),this.strokeShape(k))}getTrace(k,_){let N=this.traceArr,E=N.length,P="",F,A,j,R;for(F=0;F<E;F++)A=N[F],j=A.method,j?(R=A.args,P+=j,k?P+=u:e.Util._isArray(R[0])?P+=i+R.join(n)+o:(_&&(R=R.map(U=>typeof U=="number"?Math.floor(U):U)),P+=s+R.join(n)+a)):(P+=A.property,k||(P+=d+A.val)),P+=l;return P}clearTrace(){this.traceArr=[]}_trace(k){let _=this.traceArr,N;_.push(k),N=_.length,N>=p&&_.shift()}reset(){const k=this.getCanvas().getPixelRatio();this.setTransform(1*k,0,0,1*k,0,0)}getCanvas(){return this.canvas}clear(k){const _=this.getCanvas();k?this.clearRect(k.x||0,k.y||0,k.width||0,k.height||0):this.clearRect(0,0,_.getWidth()/_.pixelRatio,_.getHeight()/_.pixelRatio)}_applyLineCap(k){const _=k.attrs.lineCap;_&&this.setAttr("lineCap",_)}_applyOpacity(k){const _=k.getAbsoluteOpacity();_!==1&&this.setAttr("globalAlpha",_)}_applyLineJoin(k){const _=k.attrs.lineJoin;_&&this.setAttr("lineJoin",_)}setAttr(k,_){this._context[k]=_}arc(k,_,N,E,P,F){this._context.arc(k,_,N,E,P,F)}arcTo(k,_,N,E,P){this._context.arcTo(k,_,N,E,P)}beginPath(){this._context.beginPath()}bezierCurveTo(k,_,N,E,P,F){this._context.bezierCurveTo(k,_,N,E,P,F)}clearRect(k,_,N,E){this._context.clearRect(k,_,N,E)}clip(...k){this._context.clip.apply(this._context,k)}closePath(){this._context.closePath()}createImageData(k,_){const N=arguments;if(N.length===2)return this._context.createImageData(k,_);if(N.length===1)return this._context.createImageData(k)}createLinearGradient(k,_,N,E){return this._context.createLinearGradient(k,_,N,E)}createPattern(k,_){return this._context.createPattern(k,_)}createRadialGradient(k,_,N,E,P,F){return this._context.createRadialGradient(k,_,N,E,P,F)}drawImage(k,_,N,E,P,F,A,j,R){const U=arguments,Y=this._context;U.length===3?Y.drawImage(k,_,N):U.length===5?Y.drawImage(k,_,N,E,P):U.length===9&&Y.drawImage(k,_,N,E,P,F,A,j,R)}ellipse(k,_,N,E,P,F,A,j){this._context.ellipse(k,_,N,E,P,F,A,j)}isPointInPath(k,_,N,E){return N?this._context.isPointInPath(N,k,_,E):this._context.isPointInPath(k,_,E)}fill(...k){this._context.fill.apply(this._context,k)}fillRect(k,_,N,E){this._context.fillRect(k,_,N,E)}strokeRect(k,_,N,E){this._context.strokeRect(k,_,N,E)}fillText(k,_,N,E){E?this._context.fillText(k,_,N,E):this._context.fillText(k,_,N)}measureText(k){return this._context.measureText(k)}getImageData(k,_,N,E){return this._context.getImageData(k,_,N,E)}lineTo(k,_){this._context.lineTo(k,_)}moveTo(k,_){this._context.moveTo(k,_)}rect(k,_,N,E){this._context.rect(k,_,N,E)}roundRect(k,_,N,E,P){this._context.roundRect(k,_,N,E,P)}putImageData(k,_,N){this._context.putImageData(k,_,N)}quadraticCurveTo(k,_,N,E){this._context.quadraticCurveTo(k,_,N,E)}restore(){this._context.restore()}rotate(k){this._context.rotate(k)}save(){this._context.save()}scale(k,_){this._context.scale(k,_)}setLineDash(k){this._context.setLineDash?this._context.setLineDash(k):"mozDash"in this._context?this._context.mozDash=k:"webkitLineDash"in this._context&&(this._context.webkitLineDash=k)}getLineDash(){return this._context.getLineDash()}setTransform(k,_,N,E,P,F){this._context.setTransform(k,_,N,E,P,F)}stroke(k){k?this._context.stroke(k):this._context.stroke()}strokeText(k,_,N,E){this._context.strokeText(k,_,N,E)}transform(k,_,N,E,P,F){this._context.transform(k,_,N,E,P,F)}translate(k,_){this._context.translate(k,_)}_enableTrace(){let k=this,_=h.length,N=this.setAttr,E,P;const F=function(A){let j=k[A],R;k[A]=function(){return P=r(Array.prototype.slice.call(arguments,0)),R=j.apply(k,arguments),k._trace({method:A,args:P}),R}};for(E=0;E<_;E++)F(h[E]);k.setAttr=function(){N.apply(k,arguments);const A=arguments[0];let j=arguments[1];(A==="shadowOffsetX"||A==="shadowOffsetY"||A==="shadowBlur")&&(j=j/this.canvas.getPixelRatio()),k._trace({property:A,val:j})}}_applyGlobalCompositeOperation(k){const _=k.attrs.globalCompositeOperation;!_||_==="source-over"||this.setAttr("globalCompositeOperation",_)}};Nu.Context=x,g.forEach(function(C){Object.defineProperty(x.prototype,C,{get(){return this._context[C]},set(k){this._context[C]=k}})});class v extends x{constructor(k,{willReadFrequently:_=!1}={}){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:_})}_fillColor(k){const _=k.fill();this.setAttr("fillStyle",_),k._fillFunc(this)}_fillPattern(k){this.setAttr("fillStyle",k._getFillPattern()),k._fillFunc(this)}_fillLinearGradient(k){const _=k._getLinearGradient();_&&(this.setAttr("fillStyle",_),k._fillFunc(this))}_fillRadialGradient(k){const _=k._getRadialGradient();_&&(this.setAttr("fillStyle",_),k._fillFunc(this))}_fill(k){const _=k.fill(),N=k.getFillPriority();if(_&&N==="color"){this._fillColor(k);return}const E=k.getFillPatternImage();if(E&&N==="pattern"){this._fillPattern(k);return}const P=k.getFillLinearGradientColorStops();if(P&&N==="linear-gradient"){this._fillLinearGradient(k);return}const F=k.getFillRadialGradientColorStops();if(F&&N==="radial-gradient"){this._fillRadialGradient(k);return}_?this._fillColor(k):E?this._fillPattern(k):P?this._fillLinearGradient(k):F&&this._fillRadialGradient(k)}_strokeLinearGradient(k){const _=k.getStrokeLinearGradientStartPoint(),N=k.getStrokeLinearGradientEndPoint(),E=k.getStrokeLinearGradientColorStops(),P=this.createLinearGradient(_.x,_.y,N.x,N.y);if(E){for(let F=0;F<E.length;F+=2)P.addColorStop(E[F],E[F+1]);this.setAttr("strokeStyle",P)}}_stroke(k){const _=k.dash(),N=k.getStrokeScaleEnabled();if(k.hasStroke()){if(!N){this.save();const P=this.getCanvas().getPixelRatio();this.setTransform(P,0,0,P,0,0)}this._applyLineCap(k),_&&k.dashEnabled()&&(this.setLineDash(_),this.setAttr("lineDashOffset",k.dashOffset())),this.setAttr("lineWidth",k.strokeWidth()),k.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),k.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(k):this.setAttr("strokeStyle",k.stroke()),k._strokeFunc(this),N||this.restore()}}_applyShadow(k){var _,N,E;const P=(_=k.getShadowRGBA())!==null&&_!==void 0?_:"black",F=(N=k.getShadowBlur())!==null&&N!==void 0?N:5,A=(E=k.getShadowOffset())!==null&&E!==void 0?E:{x:0,y:0},j=k.getAbsoluteScale(),R=this.canvas.getPixelRatio(),U=j.x*R,Y=j.y*R;this.setAttr("shadowColor",P),this.setAttr("shadowBlur",F*Math.min(Math.abs(U),Math.abs(Y))),this.setAttr("shadowOffsetX",A.x*U),this.setAttr("shadowOffsetY",A.y*Y)}}Nu.SceneContext=v;class w extends x{constructor(k){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:!0})}_fill(k){this.save(),this.setAttr("fillStyle",k.colorKey),k._fillFuncHit(this),this.restore()}strokeShape(k){k.hasHitStroke()&&this._stroke(k)}_stroke(k){if(k.hasHitStroke()){const _=k.getStrokeScaleEnabled();if(!_){this.save();const P=this.getCanvas().getPixelRatio();this.setTransform(P,0,0,P,0,0)}this._applyLineCap(k);const N=k.hitStrokeWidth(),E=N==="auto"?k.strokeWidth():N;this.setAttr("lineWidth",E),this.setAttr("strokeStyle",k.colorKey),k._strokeFuncHit(this),_||this.restore()}}}return Nu.HitContext=w,Nu}var h6;function M_(){if(h6)return Eu;h6=1,Object.defineProperty(Eu,"__esModule",{value:!0}),Eu.HitCanvas=Eu.SceneCanvas=Eu.Canvas=void 0;const e=js(),t=fL(),r=Xr();let n;function s(){if(n)return n;const l=e.Util.createCanvasElement(),u=l.getContext("2d");return n=(function(){const d=r.Konva._global.devicePixelRatio||1,h=u.webkitBackingStorePixelRatio||u.mozBackingStorePixelRatio||u.msBackingStorePixelRatio||u.oBackingStorePixelRatio||u.backingStorePixelRatio||1;return d/h})(),e.Util.releaseCanvas(l),n}let a=class{constructor(u){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const h=(u||{}).pixelRatio||r.Konva.pixelRatio||s();this.pixelRatio=h,this._canvas=e.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(u){const d=this.pixelRatio;this.pixelRatio=u,this.setSize(this.getWidth()/d,this.getHeight()/d)}setWidth(u){this.width=this._canvas.width=u*this.pixelRatio,this._canvas.style.width=u+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}setHeight(u){this.height=this._canvas.height=u*this.pixelRatio,this._canvas.style.height=u+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}getWidth(){return this.width}getHeight(){return this.height}setSize(u,d){this.setWidth(u||0),this.setHeight(d||0)}toDataURL(u,d){try{return this._canvas.toDataURL(u,d)}catch{try{return this._canvas.toDataURL()}catch(g){return e.Util.error("Unable to get data URL. "+g.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Eu.Canvas=a;class i extends a{constructor(u={width:0,height:0,willReadFrequently:!1}){super(u),this.context=new t.SceneContext(this,{willReadFrequently:u.willReadFrequently}),this.setSize(u.width,u.height)}}Eu.SceneCanvas=i;class o extends a{constructor(u={width:0,height:0}){super(u),this.hitCanvas=!0,this.context=new t.HitContext(this),this.setSize(u.width,u.height)}}return Eu.HitCanvas=o,Eu}var zS={},g6;function YN(){return g6||(g6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const t=Xr(),r=js();e.DD={get isDragging(){let n=!1;return e.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return e.DD._dragElements.forEach(s=>{n=s.node}),n},_dragElements:new Map,_drag(n){const s=[];e.DD._dragElements.forEach((a,i)=>{const{node:o}=a,l=o.getStage();l.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const u=l._changedPointerPositions.find(d=>d.id===a.pointerId);if(u){if(a.dragStatus!=="dragging"){const d=o.dragDistance();if(Math.max(Math.abs(u.x-a.startPointerPos.x),Math.abs(u.y-a.startPointerPos.y))<d||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),s.push(o)}}),s.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const s=[];e.DD._dragElements.forEach(a=>{const{node:i}=a,o=i.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(d=>d.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(e.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,a.dragStatus="stopped");const u=a.node.getLayer()||a.node instanceof t.Konva.Stage&&a.node;u&&s.indexOf(u)===-1&&s.push(u)}),s.forEach(a=>{a.draw()})},_endDragAfter(n){e.DD._dragElements.forEach((s,a)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:n},!0),s.dragStatus!=="dragging"&&e.DD._dragElements.delete(a)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("touchcancel",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1),window.addEventListener("touchcancel",e.DD._endDragAfter,!1))})(zS)),zS}var WS={},lo={},m6;function sn(){if(m6)return lo;m6=1,Object.defineProperty(lo,"__esModule",{value:!0}),lo.RGBComponent=n,lo.alphaComponent=s,lo.getNumberValidator=a,lo.getNumberOrArrayOfNumbersValidator=i,lo.getNumberOrAutoValidator=o,lo.getStringValidator=l,lo.getStringOrGradientValidator=u,lo.getFunctionValidator=d,lo.getNumberArrayValidator=h,lo.getBooleanValidator=g,lo.getComponentValidator=p;const e=Xr(),t=js();function r(x){return t.Util._isString(x)?'"'+x+'"':Object.prototype.toString.call(x)==="[object Number]"||t.Util._isBoolean(x)?x:Object.prototype.toString.call(x)}function n(x){return x>255?255:x<0?0:Math.round(x)}function s(x){return x>1?1:x<1e-4?1e-4:x}function a(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isNumber(x)||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a number.'),x}}function i(x){if(e.Konva.isUnminified)return function(v,w){let C=t.Util._isNumber(v),k=t.Util._isArray(v)&&v.length==x;return!C&&!k&&t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a number or Array<number>('+x+")"),v}}function o(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isNumber(x)||x==="auto"||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a number or "auto".'),x}}function l(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isString(x)||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a string.'),x}}function u(){if(e.Konva.isUnminified)return function(x,v){const w=t.Util._isString(x),C=Object.prototype.toString.call(x)==="[object CanvasGradient]"||x&&x.addColorStop;return w||C||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a string or a native gradient.'),x}}function d(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isFunction(x)||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a function.'),x}}function h(){if(e.Konva.isUnminified)return function(x,v){const w=Int8Array?Object.getPrototypeOf(Int8Array):null;return w&&x instanceof w||(t.Util._isArray(x)?x.forEach(function(C){t.Util._isNumber(C)||t.Util.warn('"'+v+'" attribute has non numeric element '+C+". Make sure that all elements are numbers.")}):t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a array of numbers.')),x}}function g(){if(e.Konva.isUnminified)return function(x,v){return x===!0||x===!1||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a boolean.'),x}}function p(x){if(e.Konva.isUnminified)return function(v,w){return v==null||t.Util.isObject(v)||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be an object with properties '+x),v}}return lo}var p6;function rn(){return p6||(p6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const t=js(),r=sn(),n="get",s="set";e.Factory={addGetterSetter(a,i,o,l,u){e.Factory.addGetter(a,i,o),e.Factory.addSetter(a,i,l,u),e.Factory.addOverloadedGetterSetter(a,i)},addGetter(a,i,o){const l=n+t.Util._capitalize(i);a.prototype[l]=a.prototype[l]||function(){const u=this.attrs[i];return u===void 0?o:u}},addSetter(a,i,o,l){const u=s+t.Util._capitalize(i);a.prototype[u]||e.Factory.overWriteSetter(a,i,o,l)},overWriteSetter(a,i,o,l){const u=s+t.Util._capitalize(i);a.prototype[u]=function(d){return o&&d!==void 0&&d!==null&&(d=o.call(this,d,i)),this._setAttr(i,d),l&&l.call(this),this}},addComponentsGetterSetter(a,i,o,l,u){const d=o.length,h=t.Util._capitalize,g=n+h(i),p=s+h(i);a.prototype[g]=function(){const v={};for(let w=0;w<d;w++){const C=o[w];v[C]=this.getAttr(i+h(C))}return v};const x=(0,r.getComponentValidator)(o);a.prototype[p]=function(v){const w=this.attrs[i];l&&(v=l.call(this,v,i)),x&&x.call(this,v,i);for(const C in v)v.hasOwnProperty(C)&&this._setAttr(i+h(C),v[C]);return v||o.forEach(C=>{this._setAttr(i+h(C),void 0)}),this._fireChangeEvent(i,w,v),u&&u.call(this),this},e.Factory.addOverloadedGetterSetter(a,i)},addOverloadedGetterSetter(a,i){const o=t.Util._capitalize(i),l=s+o,u=n+o;a.prototype[i]=function(){return arguments.length?(this[l](arguments[0]),this):this[u]()}},addDeprecatedGetterSetter(a,i,o,l){t.Util.error("Adding deprecated "+i);const u=n+t.Util._capitalize(i),d=i+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[u]=function(){t.Util.error(d);const h=this.attrs[i];return h===void 0?o:h},e.Factory.addSetter(a,i,l,function(){t.Util.error(d)}),e.Factory.addOverloadedGetterSetter(a,i)},backCompat(a,i){t.Util.each(i,function(o,l){const u=a.prototype[l],d=n+t.Util._capitalize(o),h=s+t.Util._capitalize(o);function g(){u.apply(this,arguments),t.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}a.prototype[o]=g,a.prototype[d]=g,a.prototype[h]=g})},afterSetFilter(){this._filterUpToDate=!1}}})(WS)),WS}var x6;function zs(){if(x6)return rx;x6=1,Object.defineProperty(rx,"__esModule",{value:!0}),rx.Node=void 0;const e=M_(),t=YN(),r=rn(),n=Xr(),s=js(),a=sn(),i="absoluteOpacity",o="allEventListeners",l="absoluteTransform",u="absoluteScale",d="canvas",h="Change",g="children",p="konva",x="listening",v="mouseenter",w="mouseleave",C="pointerenter",k="pointerleave",_="touchenter",N="touchleave",E="set",P="Shape",F=" ",A="stage",j="transform",R="Stage",U="visible",Y=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(F);let Z=1,ae=class AT{constructor(L){this._id=Z++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(L),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(L){(L===j||L===l)&&this._cache.get(L)?this._cache.get(L).dirty=!0:L?this._cache.delete(L):this._cache.clear()}_getCache(L,H){let M=this._cache.get(L);return(M===void 0||(L===j||L===l)&&M.dirty===!0)&&(M=H.call(this),this._cache.set(L,M)),M}_calculate(L,H,M){if(!this._attachedDepsListeners.get(L)){const V=H.map(W=>W+"Change.konva").join(F);this.on(V,()=>{this._clearCache(L)}),this._attachedDepsListeners.set(L,!0)}return this._getCache(L,M)}_getCanvasCache(){return this._cache.get(d)}_clearSelfAndDescendantCache(L){this._clearCache(L),L===l&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(d)){const{scene:L,filter:H,hit:M,buffer:V}=this._cache.get(d);s.Util.releaseCanvas(L,H,M,V),this._cache.delete(d)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(L){const H=L||{};let M={};(H.x===void 0||H.y===void 0||H.width===void 0||H.height===void 0)&&(M=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let V=Math.ceil(H.width||M.width),W=Math.ceil(H.height||M.height),I=H.pixelRatio,B=H.x===void 0?Math.floor(M.x):H.x,q=H.y===void 0?Math.floor(M.y):H.y,J=H.offset||0,se=H.drawBorder||!1,X=H.hitCanvasPixelRatio||1;if(!V||!W){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const ie=Math.abs(Math.round(M.x)-B)>.5?1:0,le=Math.abs(Math.round(M.y)-q)>.5?1:0;V+=J*2+ie,W+=J*2+le,B-=J,q-=J;const ce=new e.SceneCanvas({pixelRatio:I,width:V,height:W}),ke=new e.SceneCanvas({pixelRatio:I,width:0,height:0,willReadFrequently:!0}),re=new e.HitCanvas({pixelRatio:X,width:V,height:W}),ge=ce.getContext(),Ne=re.getContext(),je=new e.SceneCanvas({width:ce.width/ce.pixelRatio+Math.abs(B),height:ce.height/ce.pixelRatio+Math.abs(q),pixelRatio:ce.pixelRatio}),Ke=je.getContext();return re.isCache=!0,ce.isCache=!0,this._cache.delete(d),this._filterUpToDate=!1,H.imageSmoothingEnabled===!1&&(ce.getContext()._context.imageSmoothingEnabled=!1,ke.getContext()._context.imageSmoothingEnabled=!1),ge.save(),Ne.save(),Ke.save(),ge.translate(-B,-q),Ne.translate(-B,-q),Ke.translate(-B,-q),je.x=B,je.y=q,this._isUnderCache=!0,this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(u),this.drawScene(ce,this,je),this.drawHit(re,this),this._isUnderCache=!1,ge.restore(),Ne.restore(),se&&(ge.save(),ge.beginPath(),ge.rect(0,0,V,W),ge.closePath(),ge.setAttr("strokeStyle","red"),ge.setAttr("lineWidth",5),ge.stroke(),ge.restore()),this._cache.set(d,{scene:ce,filter:ke,hit:re,buffer:je,x:B,y:q}),this._requestDraw(),this}isCached(){return this._cache.has(d)}getClientRect(L){throw new Error('abstract "getClientRect" method call')}_transformedRect(L,H){const M=[{x:L.x,y:L.y},{x:L.x+L.width,y:L.y},{x:L.x+L.width,y:L.y+L.height},{x:L.x,y:L.y+L.height}];let V=1/0,W=1/0,I=-1/0,B=-1/0;const q=this.getAbsoluteTransform(H);return M.forEach(function(J){const se=q.point(J);V===void 0&&(V=I=se.x,W=B=se.y),V=Math.min(V,se.x),W=Math.min(W,se.y),I=Math.max(I,se.x),B=Math.max(B,se.y)}),{x:V,y:W,width:I-V,height:B-W}}_drawCachedSceneCanvas(L){L.save(),L._applyOpacity(this),L._applyGlobalCompositeOperation(this);const H=this._getCanvasCache();L.translate(H.x,H.y);const M=this._getCachedSceneCanvas(),V=M.pixelRatio;L.drawImage(M._canvas,0,0,M.width/V,M.height/V),L.restore()}_drawCachedHitCanvas(L){const H=this._getCanvasCache(),M=H.hit;L.save(),L.translate(H.x,H.y),L.drawImage(M._canvas,0,0,M.width/M.pixelRatio,M.height/M.pixelRatio),L.restore()}_getCachedSceneCanvas(){let L=this.filters(),H=this._getCanvasCache(),M=H.scene,V=H.filter,W=V.getContext(),I,B,q,J;if(L){if(!this._filterUpToDate){const se=M.pixelRatio;V.setSize(M.width/M.pixelRatio,M.height/M.pixelRatio);try{for(I=L.length,W.clear(),W.drawImage(M._canvas,0,0,M.getWidth()/se,M.getHeight()/se),B=W.getImageData(0,0,V.getWidth(),V.getHeight()),q=0;q<I;q++){if(J=L[q],typeof J!="function"){s.Util.error("Filter should be type of function, but got "+typeof J+" instead. Please check correct filters");continue}J.call(this,B),W.putImageData(B,0,0)}}catch(X){s.Util.error("Unable to apply filter. "+X.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return V}return M}on(L,H){if(this._cache&&this._cache.delete(o),arguments.length===3)return this._delegate.apply(this,arguments);const M=L.split(F);for(let V=0;V<M.length;V++){const I=M[V].split("."),B=I[0],q=I[1]||"";this.eventListeners[B]||(this.eventListeners[B]=[]),this.eventListeners[B].push({name:q,handler:H})}return this}off(L,H){let M=(L||"").split(F),V=M.length,W,I,B,q,J,se;if(this._cache&&this._cache.delete(o),!L)for(I in this.eventListeners)this._off(I);for(W=0;W<V;W++)if(B=M[W],q=B.split("."),J=q[0],se=q[1],J)this.eventListeners[J]&&this._off(J,se,H);else for(I in this.eventListeners)this._off(I,se,H);return this}dispatchEvent(L){const H={target:this,type:L.type,evt:L};return this.fire(L.type,H),this}addEventListener(L,H){return this.on(L,function(M){H.call(this,M.evt)}),this}removeEventListener(L){return this.off(L),this}_delegate(L,H,M){const V=this;this.on(L,function(W){const I=W.target.findAncestors(H,!0,V);for(let B=0;B<I.length;B++)W=s.Util.cloneObject(W),W.currentTarget=I[B],M.call(I[B],W)})}remove(){return this.isDragging()&&this.stopDrag(),t.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(u),this._clearSelfAndDescendantCache(A),this._clearSelfAndDescendantCache(U),this._clearSelfAndDescendantCache(x)}_remove(){this._clearCaches();const L=this.getParent();L&&L.children&&(L.children.splice(this.index,1),L._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(L){const H="get"+s.Util._capitalize(L);return s.Util._isFunction(this[H])?this[H]():this.attrs[L]}getAncestors(){let L=this.getParent(),H=[];for(;L;)H.push(L),L=L.getParent();return H}getAttrs(){return this.attrs||{}}setAttrs(L){return this._batchTransformChanges(()=>{let H,M;if(!L)return this;for(H in L)H!==g&&(M=E+s.Util._capitalize(H),s.Util._isFunction(this[M])?this[M](L[H]):this._setAttr(H,L[H]))}),this}isListening(){return this._getCache(x,this._isListening)}_isListening(L){if(!this.listening())return!1;const M=this.getParent();return M&&M!==L&&this!==L?M._isListening(L):!0}isVisible(){return this._getCache(U,this._isVisible)}_isVisible(L){if(!this.visible())return!1;const M=this.getParent();return M&&M!==L&&this!==L?M._isVisible(L):!0}shouldDrawHit(L,H=!1){if(L)return this._isVisible(L)&&this._isListening(L);const M=this.getLayer();let V=!1;t.DD._dragElements.forEach(I=>{I.dragStatus==="dragging"&&(I.node.nodeType==="Stage"||I.node.getLayer()===M)&&(V=!0)});const W=!H&&!n.Konva.hitOnDragEnabled&&(V||n.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!W}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let L=this.getDepth(),H=this,M=0,V,W,I,B;function q(se){for(V=[],W=se.length,I=0;I<W;I++)B=se[I],M++,B.nodeType!==P&&(V=V.concat(B.getChildren().slice())),B._id===H._id&&(I=W);V.length>0&&V[0].getDepth()<=L&&q(V)}const J=this.getStage();return H.nodeType!==R&&J&&q(J.getChildren()),M}getDepth(){let L=0,H=this.parent;for(;H;)L++,H=H.parent;return L}_batchTransformChanges(L){this._batchingTransformChange=!0,L(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(j),this._clearSelfAndDescendantCache(l)),this._needClearTransformCache=!1}setPosition(L){return this._batchTransformChanges(()=>{this.x(L.x),this.y(L.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const L=this.getStage();if(!L)return null;const H=L.getPointerPosition();if(!H)return null;const M=this.getAbsoluteTransform().copy();return M.invert(),M.point(H)}getAbsolutePosition(L){let H=!1,M=this.parent;for(;M;){if(M.isCached()){H=!0;break}M=M.parent}H&&!L&&(L=!0);const V=this.getAbsoluteTransform(L).getMatrix(),W=new s.Transform,I=this.offset();return W.m=V.slice(),W.translate(I.x,I.y),W.getTranslation()}setAbsolutePosition(L){const{x:H,y:M,...V}=this._clearTransform();this.attrs.x=H,this.attrs.y=M,this._clearCache(j);const W=this._getAbsoluteTransform().copy();return W.invert(),W.translate(L.x,L.y),L={x:this.attrs.x+W.getTranslation().x,y:this.attrs.y+W.getTranslation().y},this._setTransform(V),this.setPosition({x:L.x,y:L.y}),this._clearCache(j),this._clearSelfAndDescendantCache(l),this}_setTransform(L){let H;for(H in L)this.attrs[H]=L[H]}_clearTransform(){const L={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,L}move(L){let H=L.x,M=L.y,V=this.x(),W=this.y();return H!==void 0&&(V+=H),M!==void 0&&(W+=M),this.setPosition({x:V,y:W}),this}_eachAncestorReverse(L,H){let M=[],V=this.getParent(),W,I;if(!(H&&H._id===this._id)){for(M.unshift(this);V&&(!H||V._id!==H._id);)M.unshift(V),V=V.parent;for(W=M.length,I=0;I<W;I++)L(M[I])}}rotate(L){return this.rotation(this.rotation()+L),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const L=this.index,H=this.parent.getChildren().length;return L<H-1?(this.parent.children.splice(L,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const L=this.index,H=this.parent.getChildren().length;return L<H-1?(this.parent.children.splice(L,1),this.parent.children.splice(L+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const L=this.index;return L>0?(this.parent.children.splice(L,1),this.parent.children.splice(L-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const L=this.index;return L>0?(this.parent.children.splice(L,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(L){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(L<0||L>=this.parent.children.length)&&s.Util.warn("Unexpected value "+L+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const H=this.index;return this.parent.children.splice(H,1),this.parent.children.splice(L,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(i,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let L=this.opacity();const H=this.getParent();return H&&!H._isUnderCache&&(L*=H.getAbsoluteOpacity()),L}moveTo(L){return this.getParent()!==L&&(this._remove(),L.add(this)),this}toObject(){let L=this.getAttrs(),H,M,V,W,I;const B={attrs:{},className:this.getClassName()};for(H in L)M=L[H],I=s.Util.isObject(M)&&!s.Util._isPlainObject(M)&&!s.Util._isArray(M),!I&&(V=typeof this[H]=="function"&&this[H],delete L[H],W=V?V.call(this):null,L[H]=M,W!==M&&(B.attrs[H]=M));return s.Util._prepareToStringify(B)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(L,H,M){const V=[];H&&this._isMatch(L)&&V.push(this);let W=this.parent;for(;W;){if(W===M)return V;W._isMatch(L)&&V.push(W),W=W.parent}return V}isAncestorOf(L){return!1}findAncestor(L,H,M){return this.findAncestors(L,H,M)[0]}_isMatch(L){if(!L)return!1;if(typeof L=="function")return L(this);let H=L.replace(/ /g,"").split(","),M=H.length,V,W;for(V=0;V<M;V++)if(W=H[V],s.Util.isValidSelector(W)||(s.Util.warn('Selector "'+W+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),W.charAt(0)==="#"){if(this.id()===W.slice(1))return!0}else if(W.charAt(0)==="."){if(this.hasName(W.slice(1)))return!0}else if(this.className===W||this.nodeType===W)return!0;return!1}getLayer(){const L=this.getParent();return L?L.getLayer():null}getStage(){return this._getCache(A,this._getStage)}_getStage(){const L=this.getParent();return L?L.getStage():null}fire(L,H={},M){return H.target=H.target||this,M?this._fireAndBubble(L,H):this._fire(L,H),this}getAbsoluteTransform(L){return L?this._getAbsoluteTransform(L):this._getCache(l,this._getAbsoluteTransform)}_getAbsoluteTransform(L){let H;if(L)return H=new s.Transform,this._eachAncestorReverse(function(M){const V=M.transformsEnabled();V==="all"?H.multiply(M.getTransform()):V==="position"&&H.translate(M.x()-M.offsetX(),M.y()-M.offsetY())},L),H;{H=this._cache.get(l)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(H):H.reset();const M=this.transformsEnabled();if(M==="all")H.multiply(this.getTransform());else if(M==="position"){const V=this.attrs.x||0,W=this.attrs.y||0,I=this.attrs.offsetX||0,B=this.attrs.offsetY||0;H.translate(V-I,W-B)}return H.dirty=!1,H}}getAbsoluteScale(L){let H=this;for(;H;)H._isUnderCache&&(L=H),H=H.getParent();const V=this.getAbsoluteTransform(L).decompose();return{x:V.scaleX,y:V.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(j,this._getTransform)}_getTransform(){var L,H;const M=this._cache.get(j)||new s.Transform;M.reset();const V=this.x(),W=this.y(),I=n.Konva.getAngle(this.rotation()),B=(L=this.attrs.scaleX)!==null&&L!==void 0?L:1,q=(H=this.attrs.scaleY)!==null&&H!==void 0?H:1,J=this.attrs.skewX||0,se=this.attrs.skewY||0,X=this.attrs.offsetX||0,ie=this.attrs.offsetY||0;return(V!==0||W!==0)&&M.translate(V,W),I!==0&&M.rotate(I),(J!==0||se!==0)&&M.skew(J,se),(B!==1||q!==1)&&M.scale(B,q),(X!==0||ie!==0)&&M.translate(-1*X,-1*ie),M.dirty=!1,M}clone(L){let H=s.Util.cloneObject(this.attrs),M,V,W,I,B;for(M in L)H[M]=L[M];const q=new this.constructor(H);for(M in this.eventListeners)for(V=this.eventListeners[M],W=V.length,I=0;I<W;I++)B=V[I],B.name.indexOf(p)<0&&(q.eventListeners[M]||(q.eventListeners[M]=[]),q.eventListeners[M].push(B));return q}_toKonvaCanvas(L){L=L||{};const H=this.getClientRect(),M=this.getStage(),V=L.x!==void 0?L.x:Math.floor(H.x),W=L.y!==void 0?L.y:Math.floor(H.y),I=L.pixelRatio||1,B=new e.SceneCanvas({width:L.width||Math.ceil(H.width)||(M?M.width():0),height:L.height||Math.ceil(H.height)||(M?M.height():0),pixelRatio:I}),q=B.getContext(),J=new e.SceneCanvas({width:B.width/B.pixelRatio+Math.abs(V),height:B.height/B.pixelRatio+Math.abs(W),pixelRatio:B.pixelRatio});return L.imageSmoothingEnabled===!1&&(q._context.imageSmoothingEnabled=!1),q.save(),(V||W)&&q.translate(-1*V,-1*W),this.drawScene(B,void 0,J),q.restore(),B}toCanvas(L){return this._toKonvaCanvas(L)._canvas}toDataURL(L){L=L||{};const H=L.mimeType||null,M=L.quality||null,V=this._toKonvaCanvas(L).toDataURL(H,M);return L.callback&&L.callback(V),V}toImage(L){return new Promise((H,M)=>{try{const V=L?.callback;V&&delete L.callback,s.Util._urlToImage(this.toDataURL(L),function(W){H(W),V?.(W)})}catch(V){M(V)}})}toBlob(L){return new Promise((H,M)=>{try{const V=L?.callback;V&&delete L.callback,this.toCanvas(L).toBlob(W=>{H(W),V?.(W)},L?.mimeType,L?.quality)}catch(V){M(V)}})}setSize(L){return this.width(L.width),this.height(L.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():n.Konva.dragDistance}_off(L,H,M){let V=this.eventListeners[L],W,I,B;for(W=0;W<V.length;W++)if(I=V[W].name,B=V[W].handler,(I!=="konva"||H==="konva")&&(!H||I===H)&&(!M||M===B)){if(V.splice(W,1),V.length===0){delete this.eventListeners[L];break}W--}}_fireChangeEvent(L,H,M){this._fire(L+h,{oldVal:H,newVal:M})}addName(L){if(!this.hasName(L)){const H=this.name(),M=H?H+" "+L:L;this.name(M)}return this}hasName(L){if(!L)return!1;const H=this.name();return H?(H||"").split(/\s/g).indexOf(L)!==-1:!1}removeName(L){const H=(this.name()||"").split(/\s/g),M=H.indexOf(L);return M!==-1&&(H.splice(M,1),this.name(H.join(" "))),this}setAttr(L,H){const M=this[E+s.Util._capitalize(L)];return s.Util._isFunction(M)?M.call(this,H):this._setAttr(L,H),this}_requestDraw(){if(n.Konva.autoDrawEnabled){const L=this.getLayer()||this.getStage();L?.batchDraw()}}_setAttr(L,H){const M=this.attrs[L];M===H&&!s.Util.isObject(H)||(H==null?delete this.attrs[L]:this.attrs[L]=H,this._shouldFireChangeEvents&&this._fireChangeEvent(L,M,H),this._requestDraw())}_setComponentAttr(L,H,M){let V;M!==void 0&&(V=this.attrs[L],V||(this.attrs[L]=this.getAttr(L)),this.attrs[L][H]=M,this._fireChangeEvent(L,V,M))}_fireAndBubble(L,H,M){H&&this.nodeType===P&&(H.target=this);const V=[v,w,C,k,_,N];if(!(V.indexOf(L)!==-1&&(M&&(this===M||this.isAncestorOf&&this.isAncestorOf(M))||this.nodeType==="Stage"&&!M))){this._fire(L,H);const I=V.indexOf(L)!==-1&&M&&M.isAncestorOf&&M.isAncestorOf(this)&&!M.isAncestorOf(this.parent);(H&&!H.cancelBubble||!H)&&this.parent&&this.parent.isListening()&&!I&&(M&&M.parent?this._fireAndBubble.call(this.parent,L,H,M):this._fireAndBubble.call(this.parent,L,H))}}_getProtoListeners(L){var H,M,V;const W=(H=this._cache.get(o))!==null&&H!==void 0?H:{};let I=W?.[L];if(I===void 0){I=[];let B=Object.getPrototypeOf(this);for(;B;){const q=(V=(M=B.eventListeners)===null||M===void 0?void 0:M[L])!==null&&V!==void 0?V:[];I.push(...q),B=Object.getPrototypeOf(B)}W[L]=I,this._cache.set(o,W)}return I}_fire(L,H){H=H||{},H.currentTarget=this,H.type=L;const M=this._getProtoListeners(L);if(M)for(let W=0;W<M.length;W++)M[W].handler.call(this,H);const V=this.eventListeners[L];if(V)for(let W=0;W<V.length;W++)V[W].handler.call(this,H)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(L){const H=L?L.pointerId:void 0,M=this.getStage(),V=this.getAbsolutePosition();if(!M)return;const W=M._getPointerById(H)||M._changedPointerPositions[0]||V;t.DD._dragElements.set(this._id,{node:this,startPointerPos:W,offset:{x:W.x-V.x,y:W.y-V.y},dragStatus:"ready",pointerId:H})}startDrag(L,H=!0){t.DD._dragElements.has(this._id)||this._createDragElement(L);const M=t.DD._dragElements.get(this._id);M.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:L&&L.evt},H)}_setDragPosition(L,H){const M=this.getStage()._getPointerById(H.pointerId);if(!M)return;let V={x:M.x-H.offset.x,y:M.y-H.offset.y};const W=this.dragBoundFunc();if(W!==void 0){const I=W.call(this,V,L);I?V=I:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==V.x||this._lastPos.y!==V.y)&&(this.setAbsolutePosition(V),this._requestDraw()),this._lastPos=V}stopDrag(L){const H=t.DD._dragElements.get(this._id);H&&(H.dragStatus="stopped"),t.DD._endDragBefore(L),t.DD._endDragAfter(L)}setDraggable(L){this._setAttr("draggable",L),this._dragChange()}isDragging(){const L=t.DD._dragElements.get(this._id);return L?L.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(L){if(!(!(L.evt.button!==void 0)||n.Konva.dragButtons.indexOf(L.evt.button)>=0)||this.isDragging())return;let V=!1;t.DD._dragElements.forEach(W=>{this.isAncestorOf(W.node)&&(V=!0)}),V||this._createDragElement(L)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const H=t.DD._dragElements.get(this._id),M=H&&H.dragStatus==="dragging",V=H&&H.dragStatus==="ready";M?this.stopDrag():V&&t.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(L={x:0,y:0}){const H=this.getStage();if(!H)return!1;const M={x:-L.x,y:-L.y,width:H.width()+2*L.x,height:H.height()+2*L.y};return s.Util.haveIntersection(M,this.getClientRect())}static create(L,H){return s.Util._isString(L)&&(L=JSON.parse(L)),this._createNode(L,H)}static _createNode(L,H){let M=AT.prototype.getClassName.call(L),V=L.children,W,I,B;H&&(L.attrs.container=H),n.Konva[M]||(s.Util.warn('Can not find a node with class name "'+M+'". Fallback to "Shape".'),M="Shape");const q=n.Konva[M];if(W=new q(L.attrs),V)for(I=V.length,B=0;B<I;B++)W.add(AT._createNode(V[B]));return W}};rx.Node=ae,ae.prototype.nodeType="Node",ae.prototype._attrsAffectingSize=[],ae.prototype.eventListeners={},ae.prototype.on.call(ae.prototype,Y,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(j),this._clearSelfAndDescendantCache(l)}),ae.prototype.on.call(ae.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(U)}),ae.prototype.on.call(ae.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(x)}),ae.prototype.on.call(ae.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(i)});const ee=r.Factory.addGetterSetter;return ee(ae,"zIndex"),ee(ae,"absolutePosition"),ee(ae,"position"),ee(ae,"x",0,(0,a.getNumberValidator)()),ee(ae,"y",0,(0,a.getNumberValidator)()),ee(ae,"globalCompositeOperation","source-over",(0,a.getStringValidator)()),ee(ae,"opacity",1,(0,a.getNumberValidator)()),ee(ae,"name","",(0,a.getStringValidator)()),ee(ae,"id","",(0,a.getStringValidator)()),ee(ae,"rotation",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(ae,"scale",["x","y"]),ee(ae,"scaleX",1,(0,a.getNumberValidator)()),ee(ae,"scaleY",1,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(ae,"skew",["x","y"]),ee(ae,"skewX",0,(0,a.getNumberValidator)()),ee(ae,"skewY",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(ae,"offset",["x","y"]),ee(ae,"offsetX",0,(0,a.getNumberValidator)()),ee(ae,"offsetY",0,(0,a.getNumberValidator)()),ee(ae,"dragDistance",void 0,(0,a.getNumberValidator)()),ee(ae,"width",0,(0,a.getNumberValidator)()),ee(ae,"height",0,(0,a.getNumberValidator)()),ee(ae,"listening",!0,(0,a.getBooleanValidator)()),ee(ae,"preventDefault",!0,(0,a.getBooleanValidator)()),ee(ae,"filters",void 0,function(ne){return this._filterUpToDate=!1,ne}),ee(ae,"visible",!0,(0,a.getBooleanValidator)()),ee(ae,"transformsEnabled","all",(0,a.getStringValidator)()),ee(ae,"size"),ee(ae,"dragBoundFunc"),ee(ae,"draggable",!1,(0,a.getBooleanValidator)()),r.Factory.backCompat(ae,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),rx}var nx={},y6;function L_(){if(y6)return nx;y6=1,Object.defineProperty(nx,"__esModule",{value:!0}),nx.Container=void 0;const e=rn(),t=zs(),r=sn();let n=class extends t.Node{constructor(){super(...arguments),this.children=[]}getChildren(a){const i=this.children||[];return a?i.filter(a):i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.destroy()}),this.children=[],this._requestDraw(),this}add(...a){if(a.length===0)return this;if(a.length>1){for(let o=0;o<a.length;o++)this.add(a[o]);return this}const i=a[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(a){return this._generalFind(a,!1)}findOne(a){const i=this._generalFind(a,!0);return i.length>0?i[0]:void 0}_generalFind(a,i){const o=[];return this._descendants(l=>{const u=l._isMatch(a);return u&&o.push(l),!!(u&&i)}),o}_descendants(a){let i=!1;const o=this.getChildren();for(const l of o){if(i=a(l),i)return!0;if(l.hasChildren()&&(i=l._descendants(a),i))return!0}return!1}toObject(){const a=t.Node.prototype.toObject.call(this);return a.children=[],this.getChildren().forEach(i=>{a.children.push(i.toObject())}),a}isAncestorOf(a){let i=a.getParent();for(;i;){if(i._id===this._id)return!0;i=i.getParent()}return!1}clone(a){const i=t.Node.prototype.clone.call(this,a);return this.getChildren().forEach(function(o){i.add(o.clone())}),i}getAllIntersections(a){const i=[];return this.find("Shape").forEach(o=>{o.isVisible()&&o.intersects(a)&&i.push(o)}),i}_clearSelfAndDescendantCache(a){var i;super._clearSelfAndDescendantCache(a),!this.isCached()&&((i=this.children)===null||i===void 0||i.forEach(function(o){o._clearSelfAndDescendantCache(a)}))}_setChildrenIndices(){var a;(a=this.children)===null||a===void 0||a.forEach(function(i,o){i.index=o}),this._requestDraw()}drawScene(a,i,o){const l=this.getLayer(),u=a||l&&l.getCanvas(),d=u&&u.getContext(),h=this._getCanvasCache(),g=h&&h.scene,p=u&&u.isCache;if(!this.isVisible()&&!p)return this;if(g){d.save();const x=this.getAbsoluteTransform(i).getMatrix();d.transform(x[0],x[1],x[2],x[3],x[4],x[5]),this._drawCachedSceneCanvas(d),d.restore()}else this._drawChildren("drawScene",u,i,o);return this}drawHit(a,i){if(!this.shouldDrawHit(i))return this;const o=this.getLayer(),l=a||o&&o.hitCanvas,u=l&&l.getContext(),d=this._getCanvasCache();if(d&&d.hit){u.save();const g=this.getAbsoluteTransform(i).getMatrix();u.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(u),u.restore()}else this._drawChildren("drawHit",l,i);return this}_drawChildren(a,i,o,l){var u;const d=i&&i.getContext(),h=this.clipWidth(),g=this.clipHeight(),p=this.clipFunc(),x=typeof h=="number"&&typeof g=="number"||p,v=o===this;if(x){d.save();const C=this.getAbsoluteTransform(o);let k=C.getMatrix();d.transform(k[0],k[1],k[2],k[3],k[4],k[5]),d.beginPath();let _;if(p)_=p.call(this,d,this);else{const N=this.clipX(),E=this.clipY();d.rect(N||0,E||0,h,g)}d.clip.apply(d,_),k=C.copy().invert().getMatrix(),d.transform(k[0],k[1],k[2],k[3],k[4],k[5])}const w=!v&&this.globalCompositeOperation()!=="source-over"&&a==="drawScene";w&&(d.save(),d._applyGlobalCompositeOperation(this)),(u=this.children)===null||u===void 0||u.forEach(function(C){C[a](i,o,l)}),w&&d.restore(),x&&d.restore()}getClientRect(a={}){var i;const o=a.skipTransform,l=a.relativeTo;let u,d,h,g,p={x:1/0,y:1/0,width:0,height:0};const x=this;(i=this.children)===null||i===void 0||i.forEach(function(C){if(!C.visible())return;const k=C.getClientRect({relativeTo:x,skipShadow:a.skipShadow,skipStroke:a.skipStroke});k.width===0&&k.height===0||(u===void 0?(u=k.x,d=k.y,h=k.x+k.width,g=k.y+k.height):(u=Math.min(u,k.x),d=Math.min(d,k.y),h=Math.max(h,k.x+k.width),g=Math.max(g,k.y+k.height)))});const v=this.find("Shape");let w=!1;for(let C=0;C<v.length;C++)if(v[C]._isVisible(this)){w=!0;break}return w&&u!==void 0?p={x:u,y:d,width:h-u,height:g-d}:p={x:0,y:0,width:0,height:0},o?p:this._transformedRect(p,l)}};return nx.Container=n,e.Factory.addComponentsGetterSetter(n,"clip",["x","y","width","height"]),e.Factory.addGetterSetter(n,"clipX",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipY",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipWidth",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipHeight",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipFunc"),nx}var HS={},Qd={},v6;function hL(){if(v6)return Qd;v6=1,Object.defineProperty(Qd,"__esModule",{value:!0}),Qd.getCapturedShape=n,Qd.createEvent=s,Qd.hasPointerCapture=a,Qd.setPointerCapture=i,Qd.releaseCapture=o;const e=Xr(),t=new Map,r=e.Konva._global.PointerEvent!==void 0;function n(l){return t.get(l)}function s(l){return{evt:l,pointerId:l.pointerId}}function a(l,u){return t.get(l)===u}function i(l,u){o(l),u.getStage()&&(t.set(l,u),r&&u._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function o(l,u){const d=t.get(l);if(!d)return;const h=d.getStage();h&&h.content,t.delete(l),r&&d._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return Qd}var w6;function NQ(){return w6||(w6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const t=js(),r=rn(),n=L_(),s=Xr(),a=M_(),i=YN(),o=Xr(),l=hL(),u="Stage",d="string",h="px",g="mouseout",p="mouseleave",x="mouseover",v="mouseenter",w="mousemove",C="mousedown",k="mouseup",_="pointermove",N="pointerdown",E="pointerup",P="pointercancel",F="lostpointercapture",A="pointerout",j="pointerleave",R="pointerover",U="pointerenter",Y="contextmenu",Z="touchstart",ae="touchend",ee="touchmove",ne="touchcancel",L="wheel",H=5,M=[[v,"_pointerenter"],[C,"_pointerdown"],[w,"_pointermove"],[k,"_pointerup"],[p,"_pointerleave"],[Z,"_pointerdown"],[ee,"_pointermove"],[ae,"_pointerup"],[ne,"_pointercancel"],[x,"_pointerover"],[L,"_wheel"],[Y,"_contextmenu"],[N,"_pointerdown"],[_,"_pointermove"],[E,"_pointerup"],[P,"_pointercancel"],[j,"_pointerleave"],[F,"_lostpointercapture"]],V={mouse:{[A]:g,[j]:p,[R]:x,[U]:v,[_]:w,[N]:C,[E]:k,[P]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[A]:"touchout",[j]:"touchleave",[R]:"touchover",[U]:"touchenter",[_]:ee,[N]:Z,[E]:ae,[P]:ne,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[A]:A,[j]:j,[R]:R,[U]:U,[_]:_,[N]:N,[E]:E,[P]:P,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},W=se=>se.indexOf("pointer")>=0?"pointer":se.indexOf("touch")>=0?"touch":"mouse",I=se=>{const X=W(se);if(X==="pointer")return s.Konva.pointerEventsEnabled&&V.pointer;if(X==="touch")return V.touch;if(X==="mouse")return V.mouse};function B(se={}){return(se.clipFunc||se.clipWidth||se.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),se}const q="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class J extends n.Container{constructor(X){super(B(X)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{B(this.attrs)}),this._checkVisibility()}_validateAdd(X){const ie=X.getType()==="Layer",le=X.getType()==="FastLayer";ie||le||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const X=this.visible()?"":"none";this.content.style.display=X}setContainer(X){if(typeof X===d){let ie;if(X.charAt(0)==="."){const le=X.slice(1);X=document.getElementsByClassName(le)[0]}else X.charAt(0)!=="#"?ie=X:ie=X.slice(1),X=document.getElementById(ie);if(!X)throw"Can not find container in document with id "+ie}return this._setAttr("container",X),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),X.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const X=this.children,ie=X.length;for(let le=0;le<ie;le++)X[le].clear();return this}clone(X){return X||(X={}),X.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,X)}destroy(){super.destroy();const X=this.content;X&&t.Util._isInDocument(X)&&this.container().removeChild(X);const ie=e.stages.indexOf(this);return ie>-1&&e.stages.splice(ie,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const X=this._pointerPositions[0]||this._changedPointerPositions[0];return X?{x:X.x,y:X.y}:(t.Util.warn(q),null)}_getPointerById(X){return this._pointerPositions.find(ie=>ie.id===X)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(X){X=X||{},X.x=X.x||0,X.y=X.y||0,X.width=X.width||this.width(),X.height=X.height||this.height();const ie=new a.SceneCanvas({width:X.width,height:X.height,pixelRatio:X.pixelRatio||1}),le=ie.getContext()._context,ce=this.children;return(X.x||X.y)&&le.translate(-1*X.x,-1*X.y),ce.forEach(function(ke){if(!ke.isVisible())return;const re=ke._toKonvaCanvas(X);le.drawImage(re._canvas,X.x,X.y,re.getWidth()/re.getPixelRatio(),re.getHeight()/re.getPixelRatio())}),ie}getIntersection(X){if(!X)return null;const ie=this.children,le=ie.length,ce=le-1;for(let ke=ce;ke>=0;ke--){const re=ie[ke].getIntersection(X);if(re)return re}return null}_resizeDOM(){const X=this.width(),ie=this.height();this.content&&(this.content.style.width=X+h,this.content.style.height=ie+h),this.bufferCanvas.setSize(X,ie),this.bufferHitCanvas.setSize(X,ie),this.children.forEach(le=>{le.setSize({width:X,height:ie}),le.draw()})}add(X,...ie){if(arguments.length>1){for(let ce=0;ce<arguments.length;ce++)this.add(arguments[ce]);return this}super.add(X);const le=this.children.length;return le>H&&t.Util.warn("The stage has "+le+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),X.setSize({width:this.width(),height:this.height()}),X.draw(),s.Konva.isBrowser&&this.content.appendChild(X.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(X){return l.hasPointerCapture(X,this)}setPointerCapture(X){l.setPointerCapture(X,this)}releaseCapture(X){l.releaseCapture(X,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&M.forEach(([X,ie])=>{this.content.addEventListener(X,le=>{this[ie](le)},{passive:!1})})}_pointerenter(X){this.setPointersPositions(X);const ie=I(X.type);ie&&this._fire(ie.pointerenter,{evt:X,target:this,currentTarget:this})}_pointerover(X){this.setPointersPositions(X);const ie=I(X.type);ie&&this._fire(ie.pointerover,{evt:X,target:this,currentTarget:this})}_getTargetShape(X){let ie=this[X+"targetShape"];return ie&&!ie.getStage()&&(ie=null),ie}_pointerleave(X){const ie=I(X.type),le=W(X.type);if(!ie)return;this.setPointersPositions(X);const ce=this._getTargetShape(le),ke=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;ce&&ke?(ce._fireAndBubble(ie.pointerout,{evt:X}),ce._fireAndBubble(ie.pointerleave,{evt:X}),this._fire(ie.pointerleave,{evt:X,target:this,currentTarget:this}),this[le+"targetShape"]=null):ke&&(this._fire(ie.pointerleave,{evt:X,target:this,currentTarget:this}),this._fire(ie.pointerout,{evt:X,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(X){const ie=I(X.type),le=W(X.type);if(!ie)return;this.setPointersPositions(X);let ce=!1;this._changedPointerPositions.forEach(ke=>{const re=this.getIntersection(ke);if(i.DD.justDragged=!1,s.Konva["_"+le+"ListenClick"]=!0,!re||!re.isListening()){this[le+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&re.setPointerCapture(ke.id),this[le+"ClickStartShape"]=re,re._fireAndBubble(ie.pointerdown,{evt:X,pointerId:ke.id}),ce=!0;const ge=X.type.indexOf("touch")>=0;re.preventDefault()&&X.cancelable&&ge&&X.preventDefault()}),ce||this._fire(ie.pointerdown,{evt:X,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(X){const ie=I(X.type),le=W(X.type);if(!ie||(s.Konva.isDragging()&&i.DD.node.preventDefault()&&X.cancelable&&X.preventDefault(),this.setPointersPositions(X),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const ke={};let re=!1;const ge=this._getTargetShape(le);this._changedPointerPositions.forEach(Ne=>{const je=l.getCapturedShape(Ne.id)||this.getIntersection(Ne),Ke=Ne.id,Ue={evt:X,pointerId:Ke},It=ge!==je;if(It&&ge&&(ge._fireAndBubble(ie.pointerout,{...Ue},je),ge._fireAndBubble(ie.pointerleave,{...Ue},je)),je){if(ke[je._id])return;ke[je._id]=!0}je&&je.isListening()?(re=!0,It&&(je._fireAndBubble(ie.pointerover,{...Ue},ge),je._fireAndBubble(ie.pointerenter,{...Ue},ge),this[le+"targetShape"]=je),je._fireAndBubble(ie.pointermove,{...Ue})):ge&&(this._fire(ie.pointerover,{evt:X,target:this,currentTarget:this,pointerId:Ke}),this[le+"targetShape"]=null)}),re||this._fire(ie.pointermove,{evt:X,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(X){const ie=I(X.type),le=W(X.type);if(!ie)return;this.setPointersPositions(X);const ce=this[le+"ClickStartShape"],ke=this[le+"ClickEndShape"],re={};let ge=!1;this._changedPointerPositions.forEach(Ne=>{const je=l.getCapturedShape(Ne.id)||this.getIntersection(Ne);if(je){if(je.releaseCapture(Ne.id),re[je._id])return;re[je._id]=!0}const Ke=Ne.id,Ue={evt:X,pointerId:Ke};let It=!1;s.Konva["_"+le+"InDblClickWindow"]?(It=!0,clearTimeout(this[le+"DblTimeout"])):i.DD.justDragged||(s.Konva["_"+le+"InDblClickWindow"]=!0,clearTimeout(this[le+"DblTimeout"])),this[le+"DblTimeout"]=setTimeout(function(){s.Konva["_"+le+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),je&&je.isListening()?(ge=!0,this[le+"ClickEndShape"]=je,je._fireAndBubble(ie.pointerup,{...Ue}),s.Konva["_"+le+"ListenClick"]&&ce&&ce===je&&(je._fireAndBubble(ie.pointerclick,{...Ue}),It&&ke&&ke===je&&je._fireAndBubble(ie.pointerdblclick,{...Ue}))):(this[le+"ClickEndShape"]=null,s.Konva["_"+le+"ListenClick"]&&this._fire(ie.pointerclick,{evt:X,target:this,currentTarget:this,pointerId:Ke}),It&&this._fire(ie.pointerdblclick,{evt:X,target:this,currentTarget:this,pointerId:Ke}))}),ge||this._fire(ie.pointerup,{evt:X,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+le+"ListenClick"]=!1,X.cancelable&&le!=="touch"&&le!=="pointer"&&X.preventDefault()}_contextmenu(X){this.setPointersPositions(X);const ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(Y,{evt:X}):this._fire(Y,{evt:X,target:this,currentTarget:this})}_wheel(X){this.setPointersPositions(X);const ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(L,{evt:X}):this._fire(L,{evt:X,target:this,currentTarget:this})}_pointercancel(X){this.setPointersPositions(X);const ie=l.getCapturedShape(X.pointerId)||this.getIntersection(this.getPointerPosition());ie&&ie._fireAndBubble(E,l.createEvent(X)),l.releaseCapture(X.pointerId)}_lostpointercapture(X){l.releaseCapture(X.pointerId)}setPointersPositions(X){const ie=this._getContentPosition();let le=null,ce=null;X=X||window.event,X.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(X.touches,ke=>{this._pointerPositions.push({id:ke.identifier,x:(ke.clientX-ie.left)/ie.scaleX,y:(ke.clientY-ie.top)/ie.scaleY})}),Array.prototype.forEach.call(X.changedTouches||X.touches,ke=>{this._changedPointerPositions.push({id:ke.identifier,x:(ke.clientX-ie.left)/ie.scaleX,y:(ke.clientY-ie.top)/ie.scaleY})})):(le=(X.clientX-ie.left)/ie.scaleX,ce=(X.clientY-ie.top)/ie.scaleY,this.pointerPos={x:le,y:ce},this._pointerPositions=[{x:le,y:ce,id:t.Util._getFirstPointerId(X)}],this._changedPointerPositions=[{x:le,y:ce,id:t.Util._getFirstPointerId(X)}])}_setPointerPosition(X){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(X)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const X=this.content.getBoundingClientRect();return{top:X.top,left:X.left,scaleX:X.width/this.content.clientWidth||1,scaleY:X.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const X=this.container();if(!X)throw"Stage has no container. A container is required.";X.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),X.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(X){X.batchDraw()}),this}}e.Stage=J,J.prototype.nodeType=u,(0,o._registerNode)(J),r.Factory.addGetterSetter(J,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{e.stages.forEach(se=>{se.batchDraw()})})})(HS)),HS}var sx={},GS={},b6;function Ra(){return b6||(b6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const t=Xr(),r=js(),n=rn(),s=zs(),a=sn(),i=Xr(),o=hL(),l="hasShadow",u="shadowRGBA",d="patternImage",h="linearGradient",g="radialGradient";let p;function x(){return p||(p=r.Util.createCanvasElement().getContext("2d"),p)}e.shapes={};function v(j){const R=this.attrs.fillRule;R?j.fill(R):j.fill()}function w(j){j.stroke()}function C(j){const R=this.attrs.fillRule;R?j.fill(R):j.fill()}function k(j){j.stroke()}function _(){this._clearCache(l)}function N(){this._clearCache(u)}function E(){this._clearCache(d)}function P(){this._clearCache(h)}function F(){this._clearCache(g)}class A extends s.Node{constructor(R){super(R);let U;for(;U=r.Util.getRandomColor(),!(U&&!(U in e.shapes)););this.colorKey=U,e.shapes[U]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const U=x().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(U&&U.setTransform){const Y=new r.Transform;Y.translate(this.fillPatternX(),this.fillPatternY()),Y.rotate(t.Konva.getAngle(this.fillPatternRotation())),Y.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),Y.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const Z=Y.getMatrix(),ae=typeof DOMMatrix>"u"?{a:Z[0],b:Z[1],c:Z[2],d:Z[3],e:Z[4],f:Z[5]}:new DOMMatrix(Z);U.setTransform(ae)}return U}}_getLinearGradient(){return this._getCache(h,this.__getLinearGradient)}__getLinearGradient(){const R=this.fillLinearGradientColorStops();if(R){const U=x(),Y=this.fillLinearGradientStartPoint(),Z=this.fillLinearGradientEndPoint(),ae=U.createLinearGradient(Y.x,Y.y,Z.x,Z.y);for(let ee=0;ee<R.length;ee+=2)ae.addColorStop(R[ee],R[ee+1]);return ae}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){const R=this.fillRadialGradientColorStops();if(R){const U=x(),Y=this.fillRadialGradientStartPoint(),Z=this.fillRadialGradientEndPoint(),ae=U.createRadialGradient(Y.x,Y.y,this.fillRadialGradientStartRadius(),Z.x,Z.y,this.fillRadialGradientEndRadius());for(let ee=0;ee<R.length;ee+=2)ae.addColorStop(R[ee],R[ee+1]);return ae}}getShadowRGBA(){return this._getCache(u,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const R=r.Util.colorToRGBA(this.shadowColor());if(R)return"rgba("+R.r+","+R.g+","+R.b+","+R.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const R=this.hitStrokeWidth();return R==="auto"?this.hasStroke():this.strokeEnabled()&&!!R}intersects(R){const U=this.getStage();if(!U)return!1;const Y=U.bufferHitCanvas;return Y.getContext().clear(),this.drawHit(Y,void 0,!0),Y.context.getImageData(Math.round(R.x),Math.round(R.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(R){var U;if(!((U=this.attrs.perfectDrawEnabled)!==null&&U!==void 0?U:!0))return!1;const Z=R||this.hasFill(),ae=this.hasStroke(),ee=this.getAbsoluteOpacity()!==1;if(Z&&ae&&ee)return!0;const ne=this.hasShadow(),L=this.shadowForStrokeEnabled();return!!(Z&&ae&&ne&&L)}setStrokeHitEnabled(R){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),R?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const R=this.size();return{x:this._centroid?-R.width/2:0,y:this._centroid?-R.height/2:0,width:R.width,height:R.height}}getClientRect(R={}){let U=!1,Y=this.getParent();for(;Y;){if(Y.isCached()){U=!0;break}Y=Y.getParent()}const Z=R.skipTransform,ae=R.relativeTo||U&&this.getStage()||void 0,ee=this.getSelfRect(),L=!R.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,H=ee.width+L,M=ee.height+L,V=!R.skipShadow&&this.hasShadow(),W=V?this.shadowOffsetX():0,I=V?this.shadowOffsetY():0,B=H+Math.abs(W),q=M+Math.abs(I),J=V&&this.shadowBlur()||0,se=B+J*2,X=q+J*2,ie={width:se,height:X,x:-(L/2+J)+Math.min(W,0)+ee.x,y:-(L/2+J)+Math.min(I,0)+ee.y};return Z?ie:this._transformedRect(ie,ae)}drawScene(R,U,Y){const Z=this.getLayer(),ae=R||Z.getCanvas(),ee=ae.getContext(),ne=this._getCanvasCache(),L=this.getSceneFunc(),H=this.hasShadow();let M;const V=U===this;if(!this.isVisible()&&!V)return this;if(ne){ee.save();const W=this.getAbsoluteTransform(U).getMatrix();return ee.transform(W[0],W[1],W[2],W[3],W[4],W[5]),this._drawCachedSceneCanvas(ee),ee.restore(),this}if(!L)return this;if(ee.save(),this._useBufferCanvas()){M=this.getStage();const W=Y||M.bufferCanvas,I=W.getContext();I.clear(),I.save(),I._applyLineJoin(this);const B=this.getAbsoluteTransform(U).getMatrix();I.transform(B[0],B[1],B[2],B[3],B[4],B[5]),L.call(this,I,this),I.restore();const q=W.pixelRatio;H&&ee._applyShadow(this),ee._applyOpacity(this),ee._applyGlobalCompositeOperation(this),ee.drawImage(W._canvas,W.x||0,W.y||0,W.width/q,W.height/q)}else{if(ee._applyLineJoin(this),!V){const W=this.getAbsoluteTransform(U).getMatrix();ee.transform(W[0],W[1],W[2],W[3],W[4],W[5]),ee._applyOpacity(this),ee._applyGlobalCompositeOperation(this)}H&&ee._applyShadow(this),L.call(this,ee,this)}return ee.restore(),this}drawHit(R,U,Y=!1){if(!this.shouldDrawHit(U,Y))return this;const Z=this.getLayer(),ae=R||Z.hitCanvas,ee=ae&&ae.getContext(),ne=this.hitFunc()||this.sceneFunc(),L=this._getCanvasCache(),H=L&&L.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),H){ee.save();const V=this.getAbsoluteTransform(U).getMatrix();return ee.transform(V[0],V[1],V[2],V[3],V[4],V[5]),this._drawCachedHitCanvas(ee),ee.restore(),this}if(!ne)return this;if(ee.save(),ee._applyLineJoin(this),!(this===U)){const V=this.getAbsoluteTransform(U).getMatrix();ee.transform(V[0],V[1],V[2],V[3],V[4],V[5])}return ne.call(this,ee,this),ee.restore(),this}drawHitFromCache(R=0){const U=this._getCanvasCache(),Y=this._getCachedSceneCanvas(),Z=U.hit,ae=Z.getContext(),ee=Z.getWidth(),ne=Z.getHeight();ae.clear(),ae.drawImage(Y._canvas,0,0,ee,ne);try{const L=ae.getImageData(0,0,ee,ne),H=L.data,M=H.length,V=r.Util._hexToRgb(this.colorKey);for(let W=0;W<M;W+=4)H[W+3]>R?(H[W]=V.r,H[W+1]=V.g,H[W+2]=V.b,H[W+3]=255):H[W+3]=0;ae.putImageData(L,0,0)}catch(L){r.Util.error("Unable to draw hit graph from cached scene canvas. "+L.message)}return this}hasPointerCapture(R){return o.hasPointerCapture(R,this)}setPointerCapture(R){o.setPointerCapture(R,this)}releaseCapture(R){o.releaseCapture(R,this)}}e.Shape=A,A.prototype._fillFunc=v,A.prototype._strokeFunc=w,A.prototype._fillFuncHit=C,A.prototype._strokeFuncHit=k,A.prototype._centroid=!1,A.prototype.nodeType="Shape",(0,i._registerNode)(A),A.prototype.eventListeners={},A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_),A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",N),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",E),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",P),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",F),n.Factory.addGetterSetter(A,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(A,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(A,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(A,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(A,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(A,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(A,"lineJoin"),n.Factory.addGetterSetter(A,"lineCap"),n.Factory.addGetterSetter(A,"sceneFunc"),n.Factory.addGetterSetter(A,"hitFunc"),n.Factory.addGetterSetter(A,"dash"),n.Factory.addGetterSetter(A,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(A,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(A,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(A,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternImage"),n.Factory.addGetterSetter(A,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(A,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(A,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(A,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(A,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(A,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(A,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(A,"fillEnabled",!0),n.Factory.addGetterSetter(A,"strokeEnabled",!0),n.Factory.addGetterSetter(A,"shadowEnabled",!0),n.Factory.addGetterSetter(A,"dashEnabled",!0),n.Factory.addGetterSetter(A,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(A,"fillPriority","color"),n.Factory.addComponentsGetterSetter(A,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(A,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(A,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(A,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(A,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(A,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(A,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(A,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(A,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(A,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(A,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(A,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(A,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(A,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(A,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(A,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(A,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(A,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(A,"fillPatternRotation",0),n.Factory.addGetterSetter(A,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(A,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(GS)),GS}var _6;function gL(){if(_6)return sx;_6=1,Object.defineProperty(sx,"__esModule",{value:!0}),sx.Layer=void 0;const e=js(),t=L_(),r=zs(),n=rn(),s=M_(),a=sn(),i=Ra(),o=Xr(),l="#",u="beforeDraw",d="draw",h=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],g=h.length;class p extends t.Container{constructor(v){super(v),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(v){return this.getContext().clear(v),this.getHitCanvas().getContext().clear(v),this}setZIndex(v){super.setZIndex(v);const w=this.getStage();return w&&w.content&&(w.content.removeChild(this.getNativeCanvasElement()),v<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[v+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){r.Node.prototype.moveToTop.call(this);const v=this.getStage();return v&&v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!r.Node.prototype.moveUp.call(this))return!1;const w=this.getStage();return!w||!w.content?!1:(w.content.removeChild(this.getNativeCanvasElement()),this.index<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[this.index+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(r.Node.prototype.moveDown.call(this)){const v=this.getStage();if(v){const w=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),w[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(r.Node.prototype.moveToBottom.call(this)){const v=this.getStage();if(v){const w=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),w[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const v=this.getNativeCanvasElement();return r.Node.prototype.remove.call(this),v&&v.parentNode&&e.Util._isInDocument(v)&&v.parentNode.removeChild(v),this}getStage(){return this.parent}setSize({width:v,height:w}){return this.canvas.setSize(v,w),this.hitCanvas.setSize(v,w),this._setSmoothEnabled(),this}_validateAdd(v){const w=v.getType();w!=="Group"&&w!=="Shape"&&e.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(v){return v=v||{},v.width=v.width||this.getWidth(),v.height=v.height||this.getHeight(),v.x=v.x!==void 0?v.x:this.x(),v.y=v.y!==void 0?v.y:this.y(),r.Node.prototype._toKonvaCanvas.call(this,v)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){e.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){e.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,e.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(v){if(!this.isListening()||!this.isVisible())return null;let w=1,C=!1;for(;;){for(let k=0;k<g;k++){const _=h[k],N=this._getIntersection({x:v.x+_.x*w,y:v.y+_.y*w}),E=N.shape;if(E)return E;if(C=!!N.antialiased,!N.antialiased)break}if(C)w+=1;else return null}}_getIntersection(v){const w=this.hitCanvas.pixelRatio,C=this.hitCanvas.context.getImageData(Math.round(v.x*w),Math.round(v.y*w),1,1).data,k=C[3];if(k===255){const _=e.Util._rgbToHex(C[0],C[1],C[2]),N=i.shapes[l+_];return N?{shape:N}:{antialiased:!0}}else if(k>0)return{antialiased:!0};return{}}drawScene(v,w,C){const k=this.getLayer(),_=v||k&&k.getCanvas();return this._fire(u,{node:this}),this.clearBeforeDraw()&&_.getContext().clear(),t.Container.prototype.drawScene.call(this,_,w,C),this._fire(d,{node:this}),this}drawHit(v,w){const C=this.getLayer(),k=v||C&&C.hitCanvas;return C&&C.clearBeforeDraw()&&C.getHitCanvas().getContext().clear(),t.Container.prototype.drawHit.call(this,k,w),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(v){e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(v)}getHitGraphEnabled(v){return e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const v=this.parent;!!this.hitCanvas._canvas.parentNode?v.content.removeChild(this.hitCanvas._canvas):v.content.appendChild(this.hitCanvas._canvas)}destroy(){return e.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}return sx.Layer=p,p.prototype.nodeType="Layer",(0,o._registerNode)(p),n.Factory.addGetterSetter(p,"imageSmoothingEnabled",!0),n.Factory.addGetterSetter(p,"clearBeforeDraw",!0),n.Factory.addGetterSetter(p,"hitGraphEnabled",!0,(0,a.getBooleanValidator)()),sx}var ax={},S6;function AQ(){if(S6)return ax;S6=1,Object.defineProperty(ax,"__esModule",{value:!0}),ax.FastLayer=void 0;const e=js(),t=gL(),r=Xr();class n extends t.Layer{constructor(a){super(a),this.listening(!1),e.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}return ax.FastLayer=n,n.prototype.nodeType="FastLayer",(0,r._registerNode)(n),ax}var ix={},k6;function XN(){if(k6)return ix;k6=1,Object.defineProperty(ix,"__esModule",{value:!0}),ix.Group=void 0;const e=js(),t=L_(),r=Xr();class n extends t.Container{_validateAdd(a){const i=a.getType();i!=="Group"&&i!=="Shape"&&e.Util.throw("You may only add groups and shapes to groups.")}}return ix.Group=n,n.prototype.nodeType="Group",(0,r._registerNode)(n),ix}var ox={},C6;function JN(){if(C6)return ox;C6=1,Object.defineProperty(ox,"__esModule",{value:!0}),ox.Animation=void 0;const e=Xr(),t=js(),r=(function(){return e.glob.performance&&e.glob.performance.now?function(){return e.glob.performance.now()}:function(){return new Date().getTime()}})();let n=class Mg{constructor(a,i){this.id=Mg.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:r(),frameRate:0},this.func=a,this.setLayers(i)}setLayers(a){let i=[];return a&&(i=Array.isArray(a)?a:[a]),this.layers=i,this}getLayers(){return this.layers}addLayer(a){const i=this.layers,o=i.length;for(let l=0;l<o;l++)if(i[l]._id===a._id)return!1;return this.layers.push(a),!0}isRunning(){const i=Mg.animations,o=i.length;for(let l=0;l<o;l++)if(i[l].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=r(),Mg._addAnimation(this),this}stop(){return Mg._removeAnimation(this),this}_updateFrameObject(a){this.frame.timeDiff=a-this.frame.lastTime,this.frame.lastTime=a,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(a){this.animations.push(a),this._handleAnimation()}static _removeAnimation(a){const i=a.id,o=this.animations,l=o.length;for(let u=0;u<l;u++)if(o[u].id===i){this.animations.splice(u,1);break}}static _runFrames(){const a={},i=this.animations;for(let o=0;o<i.length;o++){const l=i[o],u=l.layers,d=l.func;l._updateFrameObject(r());const h=u.length;let g;if(d?g=d.call(l,l.frame)!==!1:g=!0,!!g)for(let p=0;p<h;p++){const x=u[p];x._id!==void 0&&(a[x._id]=x)}}for(const o in a)a.hasOwnProperty(o)&&a[o].batchDraw()}static _animationLoop(){const a=Mg;a.animations.length?(a._runFrames(),t.Util.requestAnimFrame(a._animationLoop)):a.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,t.Util.requestAnimFrame(this._animationLoop))}};return ox.Animation=n,n.animations=[],n.animIdCounter=0,n.animRunning=!1,ox}var VS={},T6;function jQ(){return T6||(T6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const t=js(),r=JN(),n=zs(),s=Xr(),a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},i=1,o=2,l=3,u=["fill","stroke","shadowColor"];let d=0;class h{constructor(x,v,w,C,k,_,N){this.prop=x,this.propFunc=v,this.begin=C,this._pos=C,this.duration=_,this._change=0,this.prevPos=0,this.yoyo=N,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=w,this._change=k-this.begin,this.pause()}fire(x){const v=this[x];v&&v()}setTime(x){x>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():x<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=x,this.update())}getTime(){return this._time}setPosition(x){this.prevPos=this._pos,this.propFunc(x),this._pos=x}getPosition(x){return x===void 0&&(x=this._time),this.func(x,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(x){this.pause(),this._time=x,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const x=this.getTimer()-this._startTime;this.state===o?this.setTime(x):this.state===l&&this.setTime(this.duration-x)}pause(){this.state=i,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(x){const v=this,w=x.node,C=w._id,k=x.easing||e.Easings.Linear,_=!!x.yoyo;let N,E;typeof x.duration>"u"?N=.3:x.duration===0?N=.001:N=x.duration,this.node=w,this._id=d++;const P=w.getLayer()||(w instanceof s.Konva.Stage?w.getLayers():null);P||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){v.tween.onEnterFrame()},P),this.tween=new h(E,function(F){v._tweenFunc(F)},k,0,1,N*1e3,_),this._addListeners(),g.attrs[C]||(g.attrs[C]={}),g.attrs[C][this._id]||(g.attrs[C][this._id]={}),g.tweens[C]||(g.tweens[C]={});for(E in x)a[E]===void 0&&this._addAttr(E,x[E]);this.reset(),this.onFinish=x.onFinish,this.onReset=x.onReset,this.onUpdate=x.onUpdate}_addAttr(x,v){const w=this.node,C=w._id;let k,_,N,E,P;const F=g.tweens[C][x];F&&delete g.attrs[C][F][x];let A=w.getAttr(x);if(t.Util._isArray(v))if(k=[],_=Math.max(v.length,A.length),x==="points"&&v.length!==A.length&&(v.length>A.length?(E=A,A=t.Util._prepareArrayForTween(A,v,w.closed())):(N=v,v=t.Util._prepareArrayForTween(v,A,w.closed()))),x.indexOf("fill")===0)for(let j=0;j<_;j++)if(j%2===0)k.push(v[j]-A[j]);else{const R=t.Util.colorToRGBA(A[j]);P=t.Util.colorToRGBA(v[j]),A[j]=R,k.push({r:P.r-R.r,g:P.g-R.g,b:P.b-R.b,a:P.a-R.a})}else for(let j=0;j<_;j++)k.push(v[j]-A[j]);else u.indexOf(x)!==-1?(A=t.Util.colorToRGBA(A),P=t.Util.colorToRGBA(v),k={r:P.r-A.r,g:P.g-A.g,b:P.b-A.b,a:P.a-A.a}):k=v-A;g.attrs[C][this._id][x]={start:A,diff:k,end:v,trueEnd:N,trueStart:E},g.tweens[C][x]=this._id}_tweenFunc(x){const v=this.node,w=g.attrs[v._id][this._id];let C,k,_,N,E,P,F,A;for(C in w){if(k=w[C],_=k.start,N=k.diff,A=k.end,t.Util._isArray(_))if(E=[],F=Math.max(_.length,A.length),C.indexOf("fill")===0)for(P=0;P<F;P++)P%2===0?E.push((_[P]||0)+N[P]*x):E.push("rgba("+Math.round(_[P].r+N[P].r*x)+","+Math.round(_[P].g+N[P].g*x)+","+Math.round(_[P].b+N[P].b*x)+","+(_[P].a+N[P].a*x)+")");else for(P=0;P<F;P++)E.push((_[P]||0)+N[P]*x);else u.indexOf(C)!==-1?E="rgba("+Math.round(_.r+N.r*x)+","+Math.round(_.g+N.g*x)+","+Math.round(_.b+N.b*x)+","+(_.a+N.a*x)+")":E=_+N*x;v.setAttr(C,E)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const x=this.node,v=g.attrs[x._id][this._id];v.points&&v.points.trueEnd&&x.setAttr("points",v.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const x=this.node,v=g.attrs[x._id][this._id];v.points&&v.points.trueStart&&x.points(v.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(x){return this.tween.seek(x*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const x=this.node._id,v=this._id,w=g.tweens[x];this.pause(),this.anim&&this.anim.stop();for(const C in w)delete g.tweens[x][C];delete g.attrs[x][v],g.tweens[x]&&(Object.keys(g.tweens[x]).length===0&&delete g.tweens[x],Object.keys(g.attrs[x]).length===0&&delete g.attrs[x])}}e.Tween=g,g.attrs={},g.tweens={},n.Node.prototype.to=function(p){const x=p.onFinish;p.node=this,p.onFinish=function(){this.destroy(),x&&x()},new g(p).play()},e.Easings={BackEaseIn(p,x,v,w){return v*(p/=w)*p*((1.70158+1)*p-1.70158)+x},BackEaseOut(p,x,v,w){return v*((p=p/w-1)*p*((1.70158+1)*p+1.70158)+1)+x},BackEaseInOut(p,x,v,w){let C=1.70158;return(p/=w/2)<1?v/2*(p*p*(((C*=1.525)+1)*p-C))+x:v/2*((p-=2)*p*(((C*=1.525)+1)*p+C)+2)+x},ElasticEaseIn(p,x,v,w,C,k){let _=0;return p===0?x:(p/=w)===1?x+v:(k||(k=w*.3),!C||C<Math.abs(v)?(C=v,_=k/4):_=k/(2*Math.PI)*Math.asin(v/C),-(C*Math.pow(2,10*(p-=1))*Math.sin((p*w-_)*(2*Math.PI)/k))+x)},ElasticEaseOut(p,x,v,w,C,k){let _=0;return p===0?x:(p/=w)===1?x+v:(k||(k=w*.3),!C||C<Math.abs(v)?(C=v,_=k/4):_=k/(2*Math.PI)*Math.asin(v/C),C*Math.pow(2,-10*p)*Math.sin((p*w-_)*(2*Math.PI)/k)+v+x)},ElasticEaseInOut(p,x,v,w,C,k){let _=0;return p===0?x:(p/=w/2)===2?x+v:(k||(k=w*(.3*1.5)),!C||C<Math.abs(v)?(C=v,_=k/4):_=k/(2*Math.PI)*Math.asin(v/C),p<1?-.5*(C*Math.pow(2,10*(p-=1))*Math.sin((p*w-_)*(2*Math.PI)/k))+x:C*Math.pow(2,-10*(p-=1))*Math.sin((p*w-_)*(2*Math.PI)/k)*.5+v+x)},BounceEaseOut(p,x,v,w){return(p/=w)<1/2.75?v*(7.5625*p*p)+x:p<2/2.75?v*(7.5625*(p-=1.5/2.75)*p+.75)+x:p<2.5/2.75?v*(7.5625*(p-=2.25/2.75)*p+.9375)+x:v*(7.5625*(p-=2.625/2.75)*p+.984375)+x},BounceEaseIn(p,x,v,w){return v-e.Easings.BounceEaseOut(w-p,0,v,w)+x},BounceEaseInOut(p,x,v,w){return p<w/2?e.Easings.BounceEaseIn(p*2,0,v,w)*.5+x:e.Easings.BounceEaseOut(p*2-w,0,v,w)*.5+v*.5+x},EaseIn(p,x,v,w){return v*(p/=w)*p+x},EaseOut(p,x,v,w){return-v*(p/=w)*(p-2)+x},EaseInOut(p,x,v,w){return(p/=w/2)<1?v/2*p*p+x:-v/2*(--p*(p-2)-1)+x},StrongEaseIn(p,x,v,w){return v*(p/=w)*p*p*p*p+x},StrongEaseOut(p,x,v,w){return v*((p=p/w-1)*p*p*p*p+1)+x},StrongEaseInOut(p,x,v,w){return(p/=w/2)<1?v/2*p*p*p*p*p+x:v/2*((p-=2)*p*p*p*p+2)+x},Linear(p,x,v,w){return v*p/w+x}}})(VS)),VS}var E6;function jT(){return E6||(E6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const t=Xr(),r=js(),n=zs(),s=L_(),a=NQ(),i=gL(),o=AQ(),l=XN(),u=YN(),d=Ra(),h=JN(),g=jQ(),p=fL(),x=M_();e.Konva=r.Util._assign(t.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:s.Container,Stage:a.Stage,stages:a.stages,Layer:i.Layer,FastLayer:o.FastLayer,Group:l.Group,DD:u.DD,Shape:d.Shape,shapes:d.shapes,Animation:h.Animation,Tween:g.Tween,Easings:g.Easings,Context:p.Context,Canvas:x.Canvas}),e.default=e.Konva})(BS)),BS}var lx={},N6;function PQ(){if(N6)return lx;N6=1,Object.defineProperty(lx,"__esModule",{value:!0}),lx.Arc=void 0;const e=rn(),t=Ra(),r=Xr(),n=sn(),s=Xr();class a extends t.Shape{_sceneFunc(o){const l=r.Konva.getAngle(this.angle()),u=this.clockwise();o.beginPath(),o.arc(0,0,this.outerRadius(),0,l,u),o.arc(0,0,this.innerRadius(),l,0,!u),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}getSelfRect(){const o=this.innerRadius(),l=this.outerRadius(),u=this.clockwise(),d=r.Konva.getAngle(u?360-this.angle():this.angle()),h=Math.cos(Math.min(d,Math.PI)),g=1,p=Math.sin(Math.min(Math.max(Math.PI,d),3*Math.PI/2)),x=Math.sin(Math.min(d,Math.PI/2)),v=h*(h>0?o:l),w=g*l,C=p*(p>0?o:l),k=x*(x>0?l:o);return{x:v,y:u?-1*k:C,width:w-v,height:k-C}}}return lx.Arc=a,a.prototype._centroid=!0,a.prototype.className="Arc",a.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1,(0,n.getBooleanValidator)()),lx}var cx={},ux={},A6;function mL(){if(A6)return ux;A6=1,Object.defineProperty(ux,"__esModule",{value:!0}),ux.Line=void 0;const e=rn(),t=Xr(),r=Ra(),n=sn();function s(o,l,u,d,h,g,p){const x=Math.sqrt(Math.pow(u-o,2)+Math.pow(d-l,2)),v=Math.sqrt(Math.pow(h-u,2)+Math.pow(g-d,2)),w=p*x/(x+v),C=p*v/(x+v),k=u-w*(h-o),_=d-w*(g-l),N=u+C*(h-o),E=d+C*(g-l);return[k,_,N,E]}function a(o,l){const u=o.length,d=[];for(let h=2;h<u-2;h+=2){const g=s(o[h-2],o[h-1],o[h],o[h+1],o[h+2],o[h+3],l);isNaN(g[0])||(d.push(g[0]),d.push(g[1]),d.push(o[h]),d.push(o[h+1]),d.push(g[2]),d.push(g[3]))}return d}class i extends r.Shape{constructor(l){super(l),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(l){const u=this.points(),d=u.length,h=this.tension(),g=this.closed(),p=this.bezier();if(!d)return;let x=0;if(l.beginPath(),l.moveTo(u[0],u[1]),h!==0&&d>4){const v=this.getTensionPoints(),w=v.length;for(x=g?0:4,g||l.quadraticCurveTo(v[0],v[1],v[2],v[3]);x<w-2;)l.bezierCurveTo(v[x++],v[x++],v[x++],v[x++],v[x++],v[x++]);g||l.quadraticCurveTo(v[w-2],v[w-1],u[d-2],u[d-1])}else if(p)for(x=2;x<d;)l.bezierCurveTo(u[x++],u[x++],u[x++],u[x++],u[x++],u[x++]);else for(x=2;x<d;x+=2)l.lineTo(u[x],u[x+1]);g?(l.closePath(),l.fillStrokeShape(this)):l.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():a(this.points(),this.tension())}_getTensionPointsClosed(){const l=this.points(),u=l.length,d=this.tension(),h=s(l[u-2],l[u-1],l[0],l[1],l[2],l[3],d),g=s(l[u-4],l[u-3],l[u-2],l[u-1],l[0],l[1],d),p=a(l,d);return[h[2],h[3]].concat(p).concat([g[0],g[1],l[u-2],l[u-1],g[2],g[3],h[0],h[1],l[0],l[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let l=this.points();if(l.length<4)return{x:l[0]||0,y:l[1]||0,width:0,height:0};this.tension()!==0?l=[l[0],l[1],...this._getTensionPoints(),l[l.length-2],l[l.length-1]]:l=this.points();let u=l[0],d=l[0],h=l[1],g=l[1],p,x;for(let v=0;v<l.length/2;v++)p=l[v*2],x=l[v*2+1],u=Math.min(u,p),d=Math.max(d,p),h=Math.min(h,x),g=Math.max(g,x);return{x:u,y:h,width:d-u,height:g-h}}}return ux.Line=i,i.prototype.className="Line",i.prototype._attrsAffectingSize=["points","bezier","tension"],(0,t._registerNode)(i),e.Factory.addGetterSetter(i,"closed",!1),e.Factory.addGetterSetter(i,"bezier",!1),e.Factory.addGetterSetter(i,"tension",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"points",[],(0,n.getNumberArrayValidator)()),ux}var dx={},KS={},j6;function FQ(){return j6||(j6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(i,o,l)=>{let u,d;const g=l/2;u=0;for(let p=0;p<20;p++)d=g*e.tValues[20][p]+g,u+=e.cValues[20][p]*n(i,o,d);return g*u};e.getCubicArcLength=t;const r=(i,o,l)=>{l===void 0&&(l=1);const u=i[0]-2*i[1]+i[2],d=o[0]-2*o[1]+o[2],h=2*i[1]-2*i[0],g=2*o[1]-2*o[0],p=4*(u*u+d*d),x=4*(u*h+d*g),v=h*h+g*g;if(p===0)return l*Math.sqrt(Math.pow(i[2]-i[0],2)+Math.pow(o[2]-o[0],2));const w=x/(2*p),C=v/p,k=l+w,_=C-w*w,N=k*k+_>0?Math.sqrt(k*k+_):0,E=w*w+_>0?Math.sqrt(w*w+_):0,P=w+Math.sqrt(w*w+_)!==0?_*Math.log(Math.abs((k+N)/(w+E))):0;return Math.sqrt(p)/2*(k*N-w*E+P)};e.getQuadraticArcLength=r;function n(i,o,l){const u=s(1,l,i),d=s(1,l,o),h=u*u+d*d;return Math.sqrt(h)}const s=(i,o,l)=>{const u=l.length-1;let d,h;if(u===0)return 0;if(i===0){h=0;for(let g=0;g<=u;g++)h+=e.binomialCoefficients[u][g]*Math.pow(1-o,u-g)*Math.pow(o,g)*l[g];return h}else{d=new Array(u);for(let g=0;g<u;g++)d[g]=u*(l[g+1]-l[g]);return s(i-1,o,d)}},a=(i,o,l)=>{let u=1,d=i/o,h=(i-l(d))/o,g=0;for(;u>.001;){const p=l(d+h),x=Math.abs(i-p)/o;if(x<u)u=x,d+=h;else{const v=l(d-h),w=Math.abs(i-v)/o;w<u?(u=w,d-=h):h/=2}if(g++,g>500)break}return d};e.t2length=a})(KS)),KS}var P6;function QN(){if(P6)return dx;P6=1,Object.defineProperty(dx,"__esModule",{value:!0}),dx.Path=void 0;const e=rn(),t=Xr(),r=Ra(),n=FQ();class s extends r.Shape{constructor(i){super(i),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=s.parsePathData(this.data()),this.pathLength=s.getPathLength(this.dataArray)}_sceneFunc(i){const o=this.dataArray;i.beginPath();let l=!1;for(let u=0;u<o.length;u++){const d=o[u].command,h=o[u].points;switch(d){case"L":i.lineTo(h[0],h[1]);break;case"M":i.moveTo(h[0],h[1]);break;case"C":i.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5]);break;case"Q":i.quadraticCurveTo(h[0],h[1],h[2],h[3]);break;case"A":const g=h[0],p=h[1],x=h[2],v=h[3],w=h[4],C=h[5],k=h[6],_=h[7],N=x>v?x:v,E=x>v?1:x/v,P=x>v?v/x:1;i.translate(g,p),i.rotate(k),i.scale(E,P),i.arc(0,0,N,w,w+C,1-_),i.scale(1/E,1/P),i.rotate(-k),i.translate(-g,-p);break;case"z":l=!0,i.closePath();break}}!l&&!this.hasFill()?i.strokeShape(this):i.fillStrokeShape(this)}getSelfRect(){let i=[];this.dataArray.forEach(function(p){if(p.command==="A"){const x=p.points[4],v=p.points[5],w=p.points[4]+v;let C=Math.PI/180;if(Math.abs(x-w)<C&&(C=Math.abs(x-w)),v<0)for(let k=x-C;k>w;k-=C){const _=s.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],k,0);i.push(_.x,_.y)}else for(let k=x+C;k<w;k+=C){const _=s.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],k,0);i.push(_.x,_.y)}}else if(p.command==="C")for(let x=0;x<=1;x+=.01){const v=s.getPointOnCubicBezier(x,p.start.x,p.start.y,p.points[0],p.points[1],p.points[2],p.points[3],p.points[4],p.points[5]);i.push(v.x,v.y)}else i=i.concat(p.points)});let o=i[0],l=i[0],u=i[1],d=i[1],h,g;for(let p=0;p<i.length/2;p++)h=i[p*2],g=i[p*2+1],isNaN(h)||(o=Math.min(o,h),l=Math.max(l,h)),isNaN(g)||(u=Math.min(u,g),d=Math.max(d,g));return{x:o,y:u,width:l-o,height:d-u}}getLength(){return this.pathLength}getPointAtLength(i){return s.getPointAtLengthOfDataArray(i,this.dataArray)}static getLineLength(i,o,l,u){return Math.sqrt((l-i)*(l-i)+(u-o)*(u-o))}static getPathLength(i){let o=0;for(let l=0;l<i.length;++l)o+=i[l].pathLength;return o}static getPointAtLengthOfDataArray(i,o){let l,u=0,d=o.length;if(!d)return null;for(;u<d&&i>o[u].pathLength;)i-=o[u].pathLength,++u;if(u===d)return l=o[u-1].points.slice(-2),{x:l[0],y:l[1]};if(i<.01)return o[u].command==="M"?(l=o[u].points.slice(0,2),{x:l[0],y:l[1]}):{x:o[u].start.x,y:o[u].start.y};const h=o[u],g=h.points;switch(h.command){case"L":return s.getPointOnLine(i,h.start.x,h.start.y,g[0],g[1]);case"C":return s.getPointOnCubicBezier((0,n.t2length)(i,s.getPathLength(o),N=>(0,n.getCubicArcLength)([h.start.x,g[0],g[2],g[4]],[h.start.y,g[1],g[3],g[5]],N)),h.start.x,h.start.y,g[0],g[1],g[2],g[3],g[4],g[5]);case"Q":return s.getPointOnQuadraticBezier((0,n.t2length)(i,s.getPathLength(o),N=>(0,n.getQuadraticArcLength)([h.start.x,g[0],g[2]],[h.start.y,g[1],g[3]],N)),h.start.x,h.start.y,g[0],g[1],g[2],g[3]);case"A":const p=g[0],x=g[1],v=g[2],w=g[3],C=g[5],k=g[6];let _=g[4];return _+=C*i/h.pathLength,s.getPointOnEllipticalArc(p,x,v,w,_,k)}return null}static getPointOnLine(i,o,l,u,d,h,g){h=h??o,g=g??l;const p=this.getLineLength(o,l,u,d);if(p<1e-10)return{x:o,y:l};if(u===o)return{x:h,y:g+(d>l?i:-i)};const x=(d-l)/(u-o),v=Math.sqrt(i*i/(1+x*x))*(u<o?-1:1),w=x*v;if(Math.abs(g-l-x*(h-o))<1e-10)return{x:h+v,y:g+w};const C=((h-o)*(u-o)+(g-l)*(d-l))/(p*p),k=o+C*(u-o),_=l+C*(d-l),N=this.getLineLength(h,g,k,_),E=Math.sqrt(i*i-N*N),P=Math.sqrt(E*E/(1+x*x))*(u<o?-1:1),F=x*P;return{x:k+P,y:_+F}}static getPointOnCubicBezier(i,o,l,u,d,h,g,p,x){function v(E){return E*E*E}function w(E){return 3*E*E*(1-E)}function C(E){return 3*E*(1-E)*(1-E)}function k(E){return(1-E)*(1-E)*(1-E)}const _=p*v(i)+h*w(i)+u*C(i)+o*k(i),N=x*v(i)+g*w(i)+d*C(i)+l*k(i);return{x:_,y:N}}static getPointOnQuadraticBezier(i,o,l,u,d,h,g){function p(k){return k*k}function x(k){return 2*k*(1-k)}function v(k){return(1-k)*(1-k)}const w=h*p(i)+u*x(i)+o*v(i),C=g*p(i)+d*x(i)+l*v(i);return{x:w,y:C}}static getPointOnEllipticalArc(i,o,l,u,d,h){const g=Math.cos(h),p=Math.sin(h),x={x:l*Math.cos(d),y:u*Math.sin(d)};return{x:i+(x.x*g-x.y*p),y:o+(x.x*p+x.y*g)}}static parsePathData(i){if(!i)return[];let o=i;const l=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];o=o.replace(new RegExp(" ","g"),",");for(let w=0;w<l.length;w++)o=o.replace(new RegExp(l[w],"g"),"|"+l[w]);const u=o.split("|"),d=[],h=[];let g=0,p=0;const x=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let v;for(let w=1;w<u.length;w++){let C=u[w],k=C.charAt(0);for(C=C.slice(1),h.length=0;v=x.exec(C);)h.push(v[0]);const _=[];for(let N=0,E=h.length;N<E;N++){if(h[N]==="00"){_.push(0,0);continue}const P=parseFloat(h[N]);isNaN(P)?_.push(0):_.push(P)}for(;_.length>0&&!isNaN(_[0]);){let N="",E=[];const P=g,F=p;let A,j,R,U,Y,Z,ae,ee,ne,L;switch(k){case"l":g+=_.shift(),p+=_.shift(),N="L",E.push(g,p);break;case"L":g=_.shift(),p=_.shift(),E.push(g,p);break;case"m":const H=_.shift(),M=_.shift();if(g+=H,p+=M,N="M",d.length>2&&d[d.length-1].command==="z"){for(let V=d.length-2;V>=0;V--)if(d[V].command==="M"){g=d[V].points[0]+H,p=d[V].points[1]+M;break}}E.push(g,p),k="l";break;case"M":g=_.shift(),p=_.shift(),N="M",E.push(g,p),k="L";break;case"h":g+=_.shift(),N="L",E.push(g,p);break;case"H":g=_.shift(),N="L",E.push(g,p);break;case"v":p+=_.shift(),N="L",E.push(g,p);break;case"V":p=_.shift(),N="L",E.push(g,p);break;case"C":E.push(_.shift(),_.shift(),_.shift(),_.shift()),g=_.shift(),p=_.shift(),E.push(g,p);break;case"c":E.push(g+_.shift(),p+_.shift(),g+_.shift(),p+_.shift()),g+=_.shift(),p+=_.shift(),N="C",E.push(g,p);break;case"S":j=g,R=p,A=d[d.length-1],A.command==="C"&&(j=g+(g-A.points[2]),R=p+(p-A.points[3])),E.push(j,R,_.shift(),_.shift()),g=_.shift(),p=_.shift(),N="C",E.push(g,p);break;case"s":j=g,R=p,A=d[d.length-1],A.command==="C"&&(j=g+(g-A.points[2]),R=p+(p-A.points[3])),E.push(j,R,g+_.shift(),p+_.shift()),g+=_.shift(),p+=_.shift(),N="C",E.push(g,p);break;case"Q":E.push(_.shift(),_.shift()),g=_.shift(),p=_.shift(),E.push(g,p);break;case"q":E.push(g+_.shift(),p+_.shift()),g+=_.shift(),p+=_.shift(),N="Q",E.push(g,p);break;case"T":j=g,R=p,A=d[d.length-1],A.command==="Q"&&(j=g+(g-A.points[0]),R=p+(p-A.points[1])),g=_.shift(),p=_.shift(),N="Q",E.push(j,R,g,p);break;case"t":j=g,R=p,A=d[d.length-1],A.command==="Q"&&(j=g+(g-A.points[0]),R=p+(p-A.points[1])),g+=_.shift(),p+=_.shift(),N="Q",E.push(j,R,g,p);break;case"A":U=_.shift(),Y=_.shift(),Z=_.shift(),ae=_.shift(),ee=_.shift(),ne=g,L=p,g=_.shift(),p=_.shift(),N="A",E=this.convertEndpointToCenterParameterization(ne,L,g,p,ae,ee,U,Y,Z);break;case"a":U=_.shift(),Y=_.shift(),Z=_.shift(),ae=_.shift(),ee=_.shift(),ne=g,L=p,g+=_.shift(),p+=_.shift(),N="A",E=this.convertEndpointToCenterParameterization(ne,L,g,p,ae,ee,U,Y,Z);break}d.push({command:N||k,points:E,start:{x:P,y:F},pathLength:this.calcLength(P,F,N||k,E)})}(k==="z"||k==="Z")&&d.push({command:"z",points:[],start:void 0,pathLength:0})}return d}static calcLength(i,o,l,u){let d,h,g,p;const x=s;switch(l){case"L":return x.getLineLength(i,o,u[0],u[1]);case"C":return(0,n.getCubicArcLength)([i,u[0],u[2],u[4]],[o,u[1],u[3],u[5]],1);case"Q":return(0,n.getQuadraticArcLength)([i,u[0],u[2]],[o,u[1],u[3]],1);case"A":d=0;const v=u[4],w=u[5],C=u[4]+w;let k=Math.PI/180;if(Math.abs(v-C)<k&&(k=Math.abs(v-C)),h=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],v,0),w<0)for(p=v-k;p>C;p-=k)g=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],p,0),d+=x.getLineLength(h.x,h.y,g.x,g.y),h=g;else for(p=v+k;p<C;p+=k)g=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],p,0),d+=x.getLineLength(h.x,h.y,g.x,g.y),h=g;return g=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],C,0),d+=x.getLineLength(h.x,h.y,g.x,g.y),d}return 0}static convertEndpointToCenterParameterization(i,o,l,u,d,h,g,p,x){const v=x*(Math.PI/180),w=Math.cos(v)*(i-l)/2+Math.sin(v)*(o-u)/2,C=-1*Math.sin(v)*(i-l)/2+Math.cos(v)*(o-u)/2,k=w*w/(g*g)+C*C/(p*p);k>1&&(g*=Math.sqrt(k),p*=Math.sqrt(k));let _=Math.sqrt((g*g*(p*p)-g*g*(C*C)-p*p*(w*w))/(g*g*(C*C)+p*p*(w*w)));d===h&&(_*=-1),isNaN(_)&&(_=0);const N=_*g*C/p,E=_*-p*w/g,P=(i+l)/2+Math.cos(v)*N-Math.sin(v)*E,F=(o+u)/2+Math.sin(v)*N+Math.cos(v)*E,A=function(ee){return Math.sqrt(ee[0]*ee[0]+ee[1]*ee[1])},j=function(ee,ne){return(ee[0]*ne[0]+ee[1]*ne[1])/(A(ee)*A(ne))},R=function(ee,ne){return(ee[0]*ne[1]<ee[1]*ne[0]?-1:1)*Math.acos(j(ee,ne))},U=R([1,0],[(w-N)/g,(C-E)/p]),Y=[(w-N)/g,(C-E)/p],Z=[(-1*w-N)/g,(-1*C-E)/p];let ae=R(Y,Z);return j(Y,Z)<=-1&&(ae=Math.PI),j(Y,Z)>=1&&(ae=0),h===0&&ae>0&&(ae=ae-2*Math.PI),h===1&&ae<0&&(ae=ae+2*Math.PI),[P,F,g,p,U,ae,v,h]}}return dx.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,t._registerNode)(s),e.Factory.addGetterSetter(s,"data"),dx}var F6;function OQ(){if(F6)return cx;F6=1,Object.defineProperty(cx,"__esModule",{value:!0}),cx.Arrow=void 0;const e=rn(),t=mL(),r=sn(),n=Xr(),s=QN();class a extends t.Line{_sceneFunc(o){super._sceneFunc(o);const l=Math.PI*2,u=this.points();let d=u;const h=this.tension()!==0&&u.length>4;h&&(d=this.getTensionPoints());const g=this.pointerLength(),p=u.length;let x,v;if(h){const k=[d[d.length-4],d[d.length-3],d[d.length-2],d[d.length-1],u[p-2],u[p-1]],_=s.Path.calcLength(d[d.length-4],d[d.length-3],"C",k),N=s.Path.getPointOnQuadraticBezier(Math.min(1,1-g/_),k[0],k[1],k[2],k[3],k[4],k[5]);x=u[p-2]-N.x,v=u[p-1]-N.y}else x=u[p-2]-u[p-4],v=u[p-1]-u[p-3];const w=(Math.atan2(v,x)+l)%l,C=this.pointerWidth();this.pointerAtEnding()&&(o.save(),o.beginPath(),o.translate(u[p-2],u[p-1]),o.rotate(w),o.moveTo(0,0),o.lineTo(-g,C/2),o.lineTo(-g,-C/2),o.closePath(),o.restore(),this.__fillStroke(o)),this.pointerAtBeginning()&&(o.save(),o.beginPath(),o.translate(u[0],u[1]),h?(x=(d[0]+d[2])/2-u[0],v=(d[1]+d[3])/2-u[1]):(x=u[2]-u[0],v=u[3]-u[1]),o.rotate((Math.atan2(-v,-x)+l)%l),o.moveTo(0,0),o.lineTo(-g,C/2),o.lineTo(-g,-C/2),o.closePath(),o.restore(),this.__fillStroke(o))}__fillStroke(o){const l=this.dashEnabled();l&&(this.attrs.dashEnabled=!1,o.setLineDash([])),o.fillStrokeShape(this),l&&(this.attrs.dashEnabled=!0)}getSelfRect(){const o=super.getSelfRect(),l=this.pointerWidth()/2;return{x:o.x,y:o.y-l,width:o.width,height:o.height+l*2}}}return cx.Arrow=a,a.prototype.className="Arrow",(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"pointerLength",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerWidth",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerAtBeginning",!1),e.Factory.addGetterSetter(a,"pointerAtEnding",!0),cx}var fx={},O6;function DQ(){if(O6)return fx;O6=1,Object.defineProperty(fx,"__esModule",{value:!0}),fx.Circle=void 0;const e=rn(),t=Ra(),r=sn(),n=Xr();class s extends t.Shape{_sceneFunc(i){i.beginPath(),i.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius()!==i/2&&this.radius(i/2)}setHeight(i){this.radius()!==i/2&&this.radius(i/2)}}return fx.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),fx}var hx={},D6;function RQ(){if(D6)return hx;D6=1,Object.defineProperty(hx,"__esModule",{value:!0}),hx.Ellipse=void 0;const e=rn(),t=Ra(),r=sn(),n=Xr();class s extends t.Shape{_sceneFunc(i){const o=this.radiusX(),l=this.radiusY();i.beginPath(),i.save(),o!==l&&i.scale(1,l/o),i.arc(0,0,o,0,Math.PI*2,!1),i.restore(),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(i){this.radiusX(i/2)}setHeight(i){this.radiusY(i/2)}}return hx.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,n._registerNode)(s),e.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),e.Factory.addGetterSetter(s,"radiusX",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"radiusY",0,(0,r.getNumberValidator)()),hx}var gx={},R6;function IQ(){if(R6)return gx;R6=1,Object.defineProperty(gx,"__esModule",{value:!0}),gx.Image=void 0;const e=js(),t=rn(),r=Ra(),n=Xr(),s=sn();class a extends r.Shape{constructor(o){super(o),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",l=>{this._removeImageLoad(l.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const o=this.image();o&&o.complete||o&&o.readyState===4||o&&o.addEventListener&&o.addEventListener("load",this._loadListener)}_removeImageLoad(o){o&&o.removeEventListener&&o.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const o=!!this.cornerRadius(),l=this.hasShadow();return o&&l?!0:super._useBufferCanvas(!0)}_sceneFunc(o){const l=this.getWidth(),u=this.getHeight(),d=this.cornerRadius(),h=this.attrs.image;let g;if(h){const p=this.attrs.cropWidth,x=this.attrs.cropHeight;p&&x?g=[h,this.cropX(),this.cropY(),p,x,0,0,l,u]:g=[h,0,0,l,u]}(this.hasFill()||this.hasStroke()||d)&&(o.beginPath(),d?e.Util.drawRoundedRectPath(o,l,u,d):o.rect(0,0,l,u),o.closePath(),o.fillStrokeShape(this)),h&&(d&&o.clip(),o.drawImage.apply(o,g))}_hitFunc(o){const l=this.width(),u=this.height(),d=this.cornerRadius();o.beginPath(),d?e.Util.drawRoundedRectPath(o,l,u,d):o.rect(0,0,l,u),o.closePath(),o.fillStrokeShape(this)}getWidth(){var o,l;return(o=this.attrs.width)!==null&&o!==void 0?o:(l=this.image())===null||l===void 0?void 0:l.width}getHeight(){var o,l;return(o=this.attrs.height)!==null&&o!==void 0?o:(l=this.image())===null||l===void 0?void 0:l.height}static fromURL(o,l,u=null){const d=e.Util.createImageElement();d.onload=function(){const h=new a({image:d});l(h)},d.onerror=u,d.crossOrigin="Anonymous",d.src=o}}return gx.Image=a,a.prototype.className="Image",(0,n._registerNode)(a),t.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),t.Factory.addGetterSetter(a,"image"),t.Factory.addComponentsGetterSetter(a,"crop",["x","y","width","height"]),t.Factory.addGetterSetter(a,"cropX",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropY",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropWidth",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropHeight",0,(0,s.getNumberValidator)()),gx}var yh={},I6;function MQ(){if(I6)return yh;I6=1,Object.defineProperty(yh,"__esModule",{value:!0}),yh.Tag=yh.Label=void 0;const e=rn(),t=Ra(),r=XN(),n=sn(),s=Xr(),a=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],i="Change.konva",o="none",l="up",u="right",d="down",h="left",g=a.length;class p extends r.Group{constructor(w){super(w),this.on("add.konva",function(C){this._addListeners(C.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(w){let C=this,k;const _=function(){C._sync()};for(k=0;k<g;k++)w.on(a[k]+i,_)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let w=this.getText(),C=this.getTag(),k,_,N,E,P,F,A;if(w&&C){switch(k=w.width(),_=w.height(),N=C.pointerDirection(),E=C.pointerWidth(),A=C.pointerHeight(),P=0,F=0,N){case l:P=k/2,F=-1*A;break;case u:P=k+E,F=_/2;break;case d:P=k/2,F=_+A;break;case h:P=-1*E,F=_/2;break}C.setAttrs({x:-1*P,y:-1*F,width:k,height:_}),w.setAttrs({x:-1*P,y:-1*F})}}}yh.Label=p,p.prototype.className="Label",(0,s._registerNode)(p);class x extends t.Shape{_sceneFunc(w){const C=this.width(),k=this.height(),_=this.pointerDirection(),N=this.pointerWidth(),E=this.pointerHeight(),P=this.cornerRadius();let F=0,A=0,j=0,R=0;typeof P=="number"?F=A=j=R=Math.min(P,C/2,k/2):(F=Math.min(P[0]||0,C/2,k/2),A=Math.min(P[1]||0,C/2,k/2),R=Math.min(P[2]||0,C/2,k/2),j=Math.min(P[3]||0,C/2,k/2)),w.beginPath(),w.moveTo(F,0),_===l&&(w.lineTo((C-N)/2,0),w.lineTo(C/2,-1*E),w.lineTo((C+N)/2,0)),w.lineTo(C-A,0),w.arc(C-A,A,A,Math.PI*3/2,0,!1),_===u&&(w.lineTo(C,(k-E)/2),w.lineTo(C+N,k/2),w.lineTo(C,(k+E)/2)),w.lineTo(C,k-R),w.arc(C-R,k-R,R,0,Math.PI/2,!1),_===d&&(w.lineTo((C+N)/2,k),w.lineTo(C/2,k+E),w.lineTo((C-N)/2,k)),w.lineTo(j,k),w.arc(j,k-j,j,Math.PI/2,Math.PI,!1),_===h&&(w.lineTo(0,(k+E)/2),w.lineTo(-1*N,k/2),w.lineTo(0,(k-E)/2)),w.lineTo(0,F),w.arc(F,F,F,Math.PI,Math.PI*3/2,!1),w.closePath(),w.fillStrokeShape(this)}getSelfRect(){let w=0,C=0,k=this.pointerWidth(),_=this.pointerHeight(),N=this.pointerDirection(),E=this.width(),P=this.height();return N===l?(C-=_,P+=_):N===d?P+=_:N===h?(w-=k*1.5,E+=k):N===u&&(E+=k*1.5),{x:w,y:C,width:E,height:P}}}return yh.Tag=x,x.prototype.className="Tag",(0,s._registerNode)(x),e.Factory.addGetterSetter(x,"pointerDirection",o),e.Factory.addGetterSetter(x,"pointerWidth",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(x,"pointerHeight",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(x,"cornerRadius",0,(0,n.getNumberOrArrayOfNumbersValidator)(4)),yh}var mx={},M6;function pL(){if(M6)return mx;M6=1,Object.defineProperty(mx,"__esModule",{value:!0}),mx.Rect=void 0;const e=rn(),t=Ra(),r=Xr(),n=js(),s=sn();class a extends t.Shape{_sceneFunc(o){const l=this.cornerRadius(),u=this.width(),d=this.height();o.beginPath(),l?n.Util.drawRoundedRectPath(o,u,d,l):o.rect(0,0,u,d),o.closePath(),o.fillStrokeShape(this)}}return mx.Rect=a,a.prototype.className="Rect",(0,r._registerNode)(a),e.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),mx}var px={},L6;function LQ(){if(L6)return px;L6=1,Object.defineProperty(px,"__esModule",{value:!0}),px.RegularPolygon=void 0;const e=rn(),t=Ra(),r=sn(),n=Xr();class s extends t.Shape{_sceneFunc(i){const o=this._getPoints();i.beginPath(),i.moveTo(o[0].x,o[0].y);for(let l=1;l<o.length;l++)i.lineTo(o[l].x,o[l].y);i.closePath(),i.fillStrokeShape(this)}_getPoints(){const i=this.attrs.sides,o=this.attrs.radius||0,l=[];for(let u=0;u<i;u++)l.push({x:o*Math.sin(u*2*Math.PI/i),y:-1*o*Math.cos(u*2*Math.PI/i)});return l}getSelfRect(){const i=this._getPoints();let o=i[0].x,l=i[0].y,u=i[0].x,d=i[0].y;return i.forEach(h=>{o=Math.min(o,h.x),l=Math.max(l,h.x),u=Math.min(u,h.y),d=Math.max(d,h.y)}),{x:o,y:u,width:l-o,height:d-u}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius(i/2)}setHeight(i){this.radius(i/2)}}return px.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"sides",0,(0,r.getNumberValidator)()),px}var xx={},B6;function BQ(){if(B6)return xx;B6=1,Object.defineProperty(xx,"__esModule",{value:!0}),xx.Ring=void 0;const e=rn(),t=Ra(),r=sn(),n=Xr(),s=Math.PI*2;class a extends t.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.innerRadius(),0,s,!1),o.moveTo(this.outerRadius(),0),o.arc(0,0,this.outerRadius(),s,0,!0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}}return xx.Ring=a,a.prototype.className="Ring",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,r.getNumberValidator)()),xx}var yx={},$6;function $Q(){if($6)return yx;$6=1,Object.defineProperty(yx,"__esModule",{value:!0}),yx.Sprite=void 0;const e=rn(),t=Ra(),r=JN(),n=sn(),s=Xr();class a extends t.Shape{constructor(o){super(o),this._updated=!0,this.anim=new r.Animation(()=>{const l=this._updated;return this._updated=!1,l}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(o){const l=this.animation(),u=this.frameIndex(),d=u*4,h=this.animations()[l],g=this.frameOffsets(),p=h[d+0],x=h[d+1],v=h[d+2],w=h[d+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(o.beginPath(),o.rect(0,0,v,w),o.closePath(),o.fillStrokeShape(this)),C)if(g){const k=g[l],_=u*2;o.drawImage(C,p,x,v,w,k[_+0],k[_+1],v,w)}else o.drawImage(C,p,x,v,w,0,0,v,w)}_hitFunc(o){const l=this.animation(),u=this.frameIndex(),d=u*4,h=this.animations()[l],g=this.frameOffsets(),p=h[d+2],x=h[d+3];if(o.beginPath(),g){const v=g[l],w=u*2;o.rect(v[w+0],v[w+1],p,x)}else o.rect(0,0,p,x);o.closePath(),o.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const o=this;this.interval=setInterval(function(){o._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const o=this.getLayer();this.anim.setLayers(o),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const o=this.frameIndex(),l=this.animation(),u=this.animations(),d=u[l],h=d.length/4;o<h-1?this.frameIndex(o+1):this.frameIndex(0)}}return yx.Sprite=a,a.prototype.className="Sprite",(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"animation"),e.Factory.addGetterSetter(a,"animations"),e.Factory.addGetterSetter(a,"frameOffsets"),e.Factory.addGetterSetter(a,"image"),e.Factory.addGetterSetter(a,"frameIndex",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"frameRate",17,(0,n.getNumberValidator)()),e.Factory.backCompat(a,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),yx}var vx={},U6;function UQ(){if(U6)return vx;U6=1,Object.defineProperty(vx,"__esModule",{value:!0}),vx.Star=void 0;const e=rn(),t=Ra(),r=sn(),n=Xr();class s extends t.Shape{_sceneFunc(i){const o=this.innerRadius(),l=this.outerRadius(),u=this.numPoints();i.beginPath(),i.moveTo(0,0-l);for(let d=1;d<u*2;d++){const h=d%2===0?l:o,g=h*Math.sin(d*Math.PI/u),p=-1*h*Math.cos(d*Math.PI/u);i.lineTo(g,p)}i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(i){this.outerRadius(i/2)}setHeight(i){this.outerRadius(i/2)}}return vx.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"numPoints",5,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"outerRadius",0,(0,r.getNumberValidator)()),vx}var jg={},z6;function xL(){if(z6)return jg;z6=1,Object.defineProperty(jg,"__esModule",{value:!0}),jg.Text=void 0,jg.stringToArray=i;const e=js(),t=rn(),r=Ra(),n=Xr(),s=sn(),a=Xr();function i(I){return[...I].reduce((B,q,J,se)=>{if(new RegExp("\\p{Emoji}","u").test(q)){const X=se[J+1];X&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(X)?(B.push(q+X),se[J+1]=""):B.push(q)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(q+(se[J+1]||""))?B.push(q+se[J+1]):J>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(q)?B[B.length-1]+=q:q&&B.push(q);return B},[])}const o="auto",l="center",u="inherit",d="justify",h="Change.konva",g="2d",p="-",x="left",v="text",w="Text",C="top",k="bottom",_="middle",N="normal",E="px ",P=" ",F="right",A="rtl",j="word",R="char",U="none",Y="",Z=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],ae=Z.length;function ee(I){return I.split(",").map(B=>{B=B.trim();const q=B.indexOf(" ")>=0,J=B.indexOf('"')>=0||B.indexOf("'")>=0;return q&&!J&&(B=`"${B}"`),B}).join(", ")}let ne;function L(){return ne||(ne=e.Util.createCanvasElement().getContext(g),ne)}function H(I){I.fillText(this._partialText,this._partialTextX,this._partialTextY)}function M(I){I.setAttr("miterLimit",2),I.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function V(I){return I=I||{},!I.fillLinearGradientColorStops&&!I.fillRadialGradientColorStops&&!I.fillPatternImage&&(I.fill=I.fill||"black"),I}class W extends r.Shape{constructor(B){super(V(B)),this._partialTextX=0,this._partialTextY=0;for(let q=0;q<ae;q++)this.on(Z[q]+h,this._setTextData);this._setTextData()}_sceneFunc(B){const q=this.textArr,J=q.length;if(!this.text())return;let se=this.padding(),X=this.fontSize(),ie=this.lineHeight()*X,le=this.verticalAlign(),ce=this.direction(),ke=0,re=this.align(),ge=this.getWidth(),Ne=this.letterSpacing(),je=this.fill(),Ke=this.textDecoration(),Ue=Ke.indexOf("underline")!==-1,It=Ke.indexOf("line-through")!==-1,rt;ce=ce===u?B.direction:ce;let wt=ie/2,xt=_;if(n.Konva._fixTextRendering){const lt=this.measureSize("M");xt="alphabetic",wt=(lt.fontBoundingBoxAscent-lt.fontBoundingBoxDescent)/2+ie/2}for(ce===A&&B.setAttr("direction",ce),B.setAttr("font",this._getContextFont()),B.setAttr("textBaseline",xt),B.setAttr("textAlign",x),le===_?ke=(this.getHeight()-J*ie-se*2)/2:le===k&&(ke=this.getHeight()-J*ie-se*2),B.translate(se,ke+se),rt=0;rt<J;rt++){let lt=0,pt=0;const Rt=q[rt],Mt=Rt.text,Qe=Rt.width,Re=Rt.lastInParagraph;if(B.save(),re===F?lt+=ge-Qe-se*2:re===l&&(lt+=(ge-Qe-se*2)/2),Ue){B.save(),B.beginPath();const Be=n.Konva._fixTextRendering?Math.round(X/4):Math.round(X/2),ct=lt,We=wt+pt+Be;B.moveTo(ct,We);const nt=re===d&&!Re?ge-se*2:Qe;B.lineTo(ct+Math.round(nt),We),B.lineWidth=X/15;const Tt=this._getLinearGradient();B.strokeStyle=Tt||je,B.stroke(),B.restore()}if(It){B.save(),B.beginPath();const Be=n.Konva._fixTextRendering?-Math.round(X/4):0;B.moveTo(lt,wt+pt+Be);const ct=re===d&&!Re?ge-se*2:Qe;B.lineTo(lt+Math.round(ct),wt+pt+Be),B.lineWidth=X/15;const We=this._getLinearGradient();B.strokeStyle=We||je,B.stroke(),B.restore()}if(ce!==A&&(Ne!==0||re===d)){const Be=Mt.split(" ").length-1,ct=i(Mt);for(let We=0;We<ct.length;We++){const nt=ct[We];nt===" "&&!Re&&re===d&&(lt+=(ge-se*2-Qe)/Be),this._partialTextX=lt,this._partialTextY=wt+pt,this._partialText=nt,B.fillStrokeShape(this),lt+=this.measureSize(nt).width+Ne}}else Ne!==0&&B.setAttr("letterSpacing",`${Ne}px`),this._partialTextX=lt,this._partialTextY=wt+pt,this._partialText=Mt,B.fillStrokeShape(this);B.restore(),J>1&&(wt+=ie)}}_hitFunc(B){const q=this.getWidth(),J=this.getHeight();B.beginPath(),B.rect(0,0,q,J),B.closePath(),B.fillStrokeShape(this)}setText(B){const q=e.Util._isString(B)?B:B==null?"":B+"";return this._setAttr(v,q),this}getWidth(){return this.attrs.width===o||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===o||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(B){var q,J,se,X,ie,le,ce,ke,re,ge,Ne;let je=L(),Ke=this.fontSize(),Ue;je.save(),je.font=this._getContextFont(),Ue=je.measureText(B),je.restore();const It=Ke/100;return{actualBoundingBoxAscent:(q=Ue.actualBoundingBoxAscent)!==null&&q!==void 0?q:71.58203125*It,actualBoundingBoxDescent:(J=Ue.actualBoundingBoxDescent)!==null&&J!==void 0?J:0,actualBoundingBoxLeft:(se=Ue.actualBoundingBoxLeft)!==null&&se!==void 0?se:-7.421875*It,actualBoundingBoxRight:(X=Ue.actualBoundingBoxRight)!==null&&X!==void 0?X:75.732421875*It,alphabeticBaseline:(ie=Ue.alphabeticBaseline)!==null&&ie!==void 0?ie:0,emHeightAscent:(le=Ue.emHeightAscent)!==null&&le!==void 0?le:100*It,emHeightDescent:(ce=Ue.emHeightDescent)!==null&&ce!==void 0?ce:-20*It,fontBoundingBoxAscent:(ke=Ue.fontBoundingBoxAscent)!==null&&ke!==void 0?ke:91*It,fontBoundingBoxDescent:(re=Ue.fontBoundingBoxDescent)!==null&&re!==void 0?re:21*It,hangingBaseline:(ge=Ue.hangingBaseline)!==null&&ge!==void 0?ge:72.80000305175781*It,ideographicBaseline:(Ne=Ue.ideographicBaseline)!==null&&Ne!==void 0?Ne:-21*It,width:Ue.width,height:Ke}}_getContextFont(){return this.fontStyle()+P+this.fontVariant()+P+(this.fontSize()+E)+ee(this.fontFamily())}_addTextLine(B){this.align()===d&&(B=B.trim());const J=this._getTextWidth(B);return this.textArr.push({text:B,width:J,lastInParagraph:!1})}_getTextWidth(B){const q=this.letterSpacing(),J=B.length;return L().measureText(B).width+q*J}_setTextData(){let B=this.text().split(`
`),q=+this.fontSize(),J=0,se=this.lineHeight()*q,X=this.attrs.width,ie=this.attrs.height,le=X!==o&&X!==void 0,ce=ie!==o&&ie!==void 0,ke=this.padding(),re=X-ke*2,ge=ie-ke*2,Ne=0,je=this.wrap(),Ke=je!==U,Ue=je!==R&&Ke,It=this.ellipsis();this.textArr=[],L().font=this._getContextFont();const rt=It?this._getTextWidth(Y):0;for(let wt=0,xt=B.length;wt<xt;++wt){let lt=B[wt],pt=this._getTextWidth(lt);if(le&&pt>re)for(;lt.length>0;){let Rt=0,Mt=i(lt).length,Qe="",Re=0;for(;Rt<Mt;){const Be=Rt+Mt>>>1,ct=i(lt),We=ct.slice(0,Be+1).join(""),nt=this._getTextWidth(We);(It&&ce&&Ne+se>ge?nt+rt:nt)<=re?(Rt=Be+1,Qe=We,Re=nt):Mt=Be}if(Qe){if(Ue){const We=i(lt),nt=i(Qe),Tt=We[nt.length],jt=Tt===P||Tt===p;let Vt;if(jt&&Re<=re)Vt=nt.length;else{const fr=nt.lastIndexOf(P),Dr=nt.lastIndexOf(p);Vt=Math.max(fr,Dr)+1}Vt>0&&(Rt=Vt,Qe=We.slice(0,Rt).join(""),Re=this._getTextWidth(Qe))}if(Qe=Qe.trimRight(),this._addTextLine(Qe),J=Math.max(J,Re),Ne+=se,this._shouldHandleEllipsis(Ne)){this._tryToAddEllipsisToLastLine();break}if(lt=i(lt).slice(Rt).join("").trimLeft(),lt.length>0&&(pt=this._getTextWidth(lt),pt<=re)){this._addTextLine(lt),Ne+=se,J=Math.max(J,pt);break}}else break}else this._addTextLine(lt),Ne+=se,J=Math.max(J,pt),this._shouldHandleEllipsis(Ne)&&wt<xt-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),ce&&Ne+se>ge)break}this.textHeight=q,this.textWidth=J}_shouldHandleEllipsis(B){const q=+this.fontSize(),J=this.lineHeight()*q,se=this.attrs.height,X=se!==o&&se!==void 0,ie=this.padding(),le=se-ie*2;return!(this.wrap()!==U)||X&&B+J>le}_tryToAddEllipsisToLastLine(){const B=this.attrs.width,q=B!==o&&B!==void 0,J=this.padding(),se=B-J*2,X=this.ellipsis(),ie=this.textArr[this.textArr.length-1];!ie||!X||(q&&(this._getTextWidth(ie.text+Y)<se||(ie.text=ie.text.slice(0,ie.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(ie.text+Y))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const B=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,q=this.hasShadow();return B&&q?!0:super._useBufferCanvas()}}return jg.Text=W,W.prototype._fillFunc=H,W.prototype._strokeFunc=M,W.prototype.className=w,W.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,a._registerNode)(W),t.Factory.overWriteSetter(W,"width",(0,s.getNumberOrAutoValidator)()),t.Factory.overWriteSetter(W,"height",(0,s.getNumberOrAutoValidator)()),t.Factory.addGetterSetter(W,"direction",u),t.Factory.addGetterSetter(W,"fontFamily","Arial"),t.Factory.addGetterSetter(W,"fontSize",12,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"fontStyle",N),t.Factory.addGetterSetter(W,"fontVariant",N),t.Factory.addGetterSetter(W,"padding",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"align",x),t.Factory.addGetterSetter(W,"verticalAlign",C),t.Factory.addGetterSetter(W,"lineHeight",1,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"wrap",j),t.Factory.addGetterSetter(W,"ellipsis",!1,(0,s.getBooleanValidator)()),t.Factory.addGetterSetter(W,"letterSpacing",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"text","",(0,s.getStringValidator)()),t.Factory.addGetterSetter(W,"textDecoration",""),jg}var wx={},W6;function zQ(){if(W6)return wx;W6=1,Object.defineProperty(wx,"__esModule",{value:!0}),wx.TextPath=void 0;const e=js(),t=rn(),r=Ra(),n=QN(),s=xL(),a=sn(),i=Xr(),o="",l="normal";function u(g){g.fillText(this.partialText,0,0)}function d(g){g.strokeText(this.partialText,0,0)}class h extends r.Shape{constructor(p){super(p),this.dummyCanvas=e.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return n.Path.getPathLength(this.dataArray)}_getPointAtLength(p){if(!this.attrs.data)return null;const x=this.pathLength;return p-1>x?null:n.Path.getPointAtLengthOfDataArray(p,this.dataArray)}_readDataAttribute(){this.dataArray=n.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(p){p.setAttr("font",this._getContextFont()),p.setAttr("textBaseline",this.textBaseline()),p.setAttr("textAlign","left"),p.save();const x=this.textDecoration(),v=this.fill(),w=this.fontSize(),C=this.glyphInfo;x==="underline"&&p.beginPath();for(let k=0;k<C.length;k++){p.save();const _=C[k].p0;p.translate(_.x,_.y),p.rotate(C[k].rotation),this.partialText=C[k].text,p.fillStrokeShape(this),x==="underline"&&(k===0&&p.moveTo(0,w/2+1),p.lineTo(w,w/2+1)),p.restore()}x==="underline"&&(p.strokeStyle=v,p.lineWidth=w/20,p.stroke()),p.restore()}_hitFunc(p){p.beginPath();const x=this.glyphInfo;if(x.length>=1){const v=x[0].p0;p.moveTo(v.x,v.y)}for(let v=0;v<x.length;v++){const w=x[v].p1;p.lineTo(w.x,w.y)}p.setAttr("lineWidth",this.fontSize()),p.setAttr("strokeStyle",this.colorKey),p.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(p){return s.Text.prototype.setText.call(this,p)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(p){const v=this.dummyCanvas.getContext("2d");v.save(),v.font=this._getContextFont();const w=v.measureText(p);return v.restore(),{width:w.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:p,height:x}=this._getTextSize(this.attrs.text);if(this.textWidth=p,this.textHeight=x,this.glyphInfo=[],!this.attrs.data)return null;const v=this.letterSpacing(),w=this.align(),C=this.kerningFunc(),k=Math.max(this.textWidth+((this.attrs.text||"").length-1)*v,0);let _=0;w==="center"&&(_=Math.max(0,this.pathLength/2-k/2)),w==="right"&&(_=Math.max(0,this.pathLength-k));const N=(0,s.stringToArray)(this.text());let E=_;for(let P=0;P<N.length;P++){const F=this._getPointAtLength(E);if(!F)return;let A=this._getTextSize(N[P]).width+v;if(N[P]===" "&&w==="justify"){const ae=this.text().split(" ").length-1;A+=(this.pathLength-k)/ae}const j=this._getPointAtLength(E+A);if(!j)return;const R=n.Path.getLineLength(F.x,F.y,j.x,j.y);let U=0;if(C)try{U=C(N[P-1],N[P])*this.fontSize()}catch{U=0}F.x+=U,j.x+=U,this.textWidth+=U;const Y=n.Path.getPointOnLine(U+R/2,F.x,F.y,j.x,j.y),Z=Math.atan2(j.y-F.y,j.x-F.x);this.glyphInfo.push({transposeX:Y.x,transposeY:Y.y,text:N[P],rotation:Z,p0:F,p1:j}),E+=A}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const p=[];this.glyphInfo.forEach(function(E){p.push(E.p0.x),p.push(E.p0.y),p.push(E.p1.x),p.push(E.p1.y)});let x=p[0]||0,v=p[0]||0,w=p[1]||0,C=p[1]||0,k,_;for(let E=0;E<p.length/2;E++)k=p[E*2],_=p[E*2+1],x=Math.min(x,k),v=Math.max(v,k),w=Math.min(w,_),C=Math.max(C,_);const N=this.fontSize();return{x:x-N/2,y:w-N/2,width:v-x+N,height:C-w+N}}destroy(){return e.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}return wx.TextPath=h,h.prototype._fillFunc=u,h.prototype._strokeFunc=d,h.prototype._fillFuncHit=u,h.prototype._strokeFuncHit=d,h.prototype.className="TextPath",h.prototype._attrsAffectingSize=["text","fontSize","data"],(0,i._registerNode)(h),t.Factory.addGetterSetter(h,"data"),t.Factory.addGetterSetter(h,"fontFamily","Arial"),t.Factory.addGetterSetter(h,"fontSize",12,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(h,"fontStyle",l),t.Factory.addGetterSetter(h,"align","left"),t.Factory.addGetterSetter(h,"letterSpacing",0,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(h,"textBaseline","middle"),t.Factory.addGetterSetter(h,"fontVariant",l),t.Factory.addGetterSetter(h,"text",o),t.Factory.addGetterSetter(h,"textDecoration",""),t.Factory.addGetterSetter(h,"kerningFunc",void 0),wx}var bx={},H6;function WQ(){if(H6)return bx;H6=1,Object.defineProperty(bx,"__esModule",{value:!0}),bx.Transformer=void 0;const e=js(),t=rn(),r=zs(),n=Ra(),s=pL(),a=XN(),i=Xr(),o=sn(),l=Xr(),u="tr-konva",d=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(A=>A+`.${u}`).join(" "),h="nodesRect",g=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],p={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},x="ontouchstart"in i.Konva._global;function v(A,j,R){if(A==="rotater")return R;j+=e.Util.degToRad(p[A]||0);const U=(e.Util.radToDeg(j)%360+360)%360;return e.Util._inRange(U,315+22.5,360)||e.Util._inRange(U,0,22.5)?"ns-resize":e.Util._inRange(U,45-22.5,45+22.5)?"nesw-resize":e.Util._inRange(U,90-22.5,90+22.5)?"ew-resize":e.Util._inRange(U,135-22.5,135+22.5)?"nwse-resize":e.Util._inRange(U,180-22.5,180+22.5)?"ns-resize":e.Util._inRange(U,225-22.5,225+22.5)?"nesw-resize":e.Util._inRange(U,270-22.5,270+22.5)?"ew-resize":e.Util._inRange(U,315-22.5,315+22.5)?"nwse-resize":(e.Util.error("Transformer has unknown angle for cursor detection: "+U),"pointer")}const w=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function C(A){return{x:A.x+A.width/2*Math.cos(A.rotation)+A.height/2*Math.sin(-A.rotation),y:A.y+A.height/2*Math.cos(A.rotation)+A.width/2*Math.sin(A.rotation)}}function k(A,j,R){const U=R.x+(A.x-R.x)*Math.cos(j)-(A.y-R.y)*Math.sin(j),Y=R.y+(A.x-R.x)*Math.sin(j)+(A.y-R.y)*Math.cos(j);return{...A,rotation:A.rotation+j,x:U,y:Y}}function _(A,j){const R=C(A);return k(A,j,R)}function N(A,j,R){let U=j;for(let Y=0;Y<A.length;Y++){const Z=i.Konva.getAngle(A[Y]),ae=Math.abs(Z-j)%(Math.PI*2);Math.min(ae,Math.PI*2-ae)<R&&(U=Z)}return U}let E=0;class P extends a.Group{constructor(j){super(j),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(d,this.update),this.getNode()&&this.update()}attachTo(j){return this.setNode(j),this}setNode(j){return e.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([j])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return u+this._id}setNodes(j=[]){this._nodes&&this._nodes.length&&this.detach();const R=j.filter(Y=>Y.isAncestorOf(this)?(e.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=j=R,j.length===1&&this.useSingleNodeRotation()?this.rotation(j[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(Y=>{const Z=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(Y._attrsAffectingSize.length){const ae=Y._attrsAffectingSize.map(ee=>ee+"Change."+this._getEventNamespace()).join(" ");Y.on(ae,Z)}Y.on(g.map(ae=>ae+`.${this._getEventNamespace()}`).join(" "),Z),Y.on(`absoluteTransformChange.${this._getEventNamespace()}`,Z),this._proxyDrag(Y)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(j){let R;j.on(`dragstart.${this._getEventNamespace()}`,U=>{R=j.getAbsolutePosition(),!this.isDragging()&&j!==this.findOne(".back")&&this.startDrag(U,!1)}),j.on(`dragmove.${this._getEventNamespace()}`,U=>{if(!R)return;const Y=j.getAbsolutePosition(),Z=Y.x-R.x,ae=Y.y-R.y;this.nodes().forEach(ee=>{if(ee===j||ee.isDragging())return;const ne=ee.getAbsolutePosition();ee.setAbsolutePosition({x:ne.x+Z,y:ne.y+ae}),ee.startDrag(U)}),R=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(j=>{j.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(h),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(h,this.__getNodeRect)}__getNodeShape(j,R=this.rotation(),U){const Y=j.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),Z=j.getAbsoluteScale(U),ae=j.getAbsolutePosition(U),ee=Y.x*Z.x-j.offsetX()*Z.x,ne=Y.y*Z.y-j.offsetY()*Z.y,L=(i.Konva.getAngle(j.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),H={x:ae.x+ee*Math.cos(L)+ne*Math.sin(-L),y:ae.y+ne*Math.cos(L)+ee*Math.sin(L),width:Y.width*Z.x,height:Y.height*Z.y,rotation:L};return k(H,-i.Konva.getAngle(R),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const R=[];this.nodes().map(L=>{const H=L.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),M=[{x:H.x,y:H.y},{x:H.x+H.width,y:H.y},{x:H.x+H.width,y:H.y+H.height},{x:H.x,y:H.y+H.height}],V=L.getAbsoluteTransform();M.forEach(function(W){const I=V.point(W);R.push(I)})});const U=new e.Transform;U.rotate(-i.Konva.getAngle(this.rotation()));let Y=1/0,Z=1/0,ae=-1/0,ee=-1/0;R.forEach(function(L){const H=U.point(L);Y===void 0&&(Y=ae=H.x,Z=ee=H.y),Y=Math.min(Y,H.x),Z=Math.min(Z,H.y),ae=Math.max(ae,H.x),ee=Math.max(ee,H.y)}),U.invert();const ne=U.point({x:Y,y:Z});return{x:ne.x,y:ne.y,width:ae-Y,height:ee-Z,rotation:i.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),w.forEach(j=>{this._createAnchor(j)}),this._createAnchor("rotater")}_createAnchor(j){const R=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:j+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:x?10:"auto"}),U=this;R.on("mousedown touchstart",function(Y){U._handleMouseDown(Y)}),R.on("dragstart",Y=>{R.stopDrag(),Y.cancelBubble=!0}),R.on("dragend",Y=>{Y.cancelBubble=!0}),R.on("mouseenter",()=>{const Y=i.Konva.getAngle(this.rotation()),Z=this.rotateAnchorCursor(),ae=v(j,Y,Z);R.getStage().content&&(R.getStage().content.style.cursor=ae),this._cursorChange=!0}),R.on("mouseout",()=>{R.getStage().content&&(R.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(R)}_createBack(){const j=new n.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(R,U){const Y=U.getParent(),Z=Y.padding();R.beginPath(),R.rect(-Z,-Z,U.width()+Z*2,U.height()+Z*2),R.moveTo(U.width()/2,-Z),Y.rotateEnabled()&&Y.rotateLineVisible()&&R.lineTo(U.width()/2,-Y.rotateAnchorOffset()*e.Util._sign(U.height())-Z),R.fillStrokeShape(U)},hitFunc:(R,U)=>{if(!this.shouldOverdrawWholeArea())return;const Y=this.padding();R.beginPath(),R.rect(-Y,-Y,U.width()+Y*2,U.height()+Y*2),R.fillStrokeShape(U)}});this.add(j),this._proxyDrag(j),j.on("dragstart",R=>{R.cancelBubble=!0}),j.on("dragmove",R=>{R.cancelBubble=!0}),j.on("dragend",R=>{R.cancelBubble=!0}),this.on("dragmove",R=>{this.update()})}_handleMouseDown(j){if(this._transforming)return;this._movingAnchorName=j.target.name().split(" ")[0];const R=this._getNodeRect(),U=R.width,Y=R.height,Z=Math.sqrt(Math.pow(U,2)+Math.pow(Y,2));this.sin=Math.abs(Y/Z),this.cos=Math.abs(U/Z),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const ae=j.target.getAbsolutePosition(),ee=j.target.getStage().getPointerPosition();this._anchorDragOffset={x:ee.x-ae.x,y:ee.y-ae.y},E++,this._fire("transformstart",{evt:j.evt,target:this.getNode()}),this._nodes.forEach(ne=>{ne._fire("transformstart",{evt:j.evt,target:ne})})}_handleMouseMove(j){let R,U,Y;const Z=this.findOne("."+this._movingAnchorName),ae=Z.getStage();ae.setPointersPositions(j);const ee=ae.getPointerPosition();let ne={x:ee.x-this._anchorDragOffset.x,y:ee.y-this._anchorDragOffset.y};const L=Z.getAbsolutePosition();this.anchorDragBoundFunc()&&(ne=this.anchorDragBoundFunc()(L,ne,j)),Z.setAbsolutePosition(ne);const H=Z.getAbsolutePosition();if(L.x===H.x&&L.y===H.y)return;if(this._movingAnchorName==="rotater"){const se=this._getNodeRect();R=Z.x()-se.width/2,U=-Z.y()+se.height/2;let X=Math.atan2(-U,R)+Math.PI/2;se.height<0&&(X-=Math.PI);const le=i.Konva.getAngle(this.rotation())+X,ce=i.Konva.getAngle(this.rotationSnapTolerance()),re=N(this.rotationSnaps(),le,ce)-se.rotation,ge=_(se,re);this._fitNodesInto(ge,j);return}const M=this.shiftBehavior();let V;M==="inverted"?V=this.keepRatio()&&!j.shiftKey:M==="none"?V=this.keepRatio():V=this.keepRatio()||j.shiftKey;let W=this.centeredScaling()||j.altKey;if(this._movingAnchorName==="top-left"){if(V){const se=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};Y=Math.sqrt(Math.pow(se.x-Z.x(),2)+Math.pow(se.y-Z.y(),2));const X=this.findOne(".top-left").x()>se.x?-1:1,ie=this.findOne(".top-left").y()>se.y?-1:1;R=Y*this.cos*X,U=Y*this.sin*ie,this.findOne(".top-left").x(se.x-R),this.findOne(".top-left").y(se.y-U)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(Z.y());else if(this._movingAnchorName==="top-right"){if(V){const se=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};Y=Math.sqrt(Math.pow(Z.x()-se.x,2)+Math.pow(se.y-Z.y(),2));const X=this.findOne(".top-right").x()<se.x?-1:1,ie=this.findOne(".top-right").y()>se.y?-1:1;R=Y*this.cos*X,U=Y*this.sin*ie,this.findOne(".top-right").x(se.x+R),this.findOne(".top-right").y(se.y-U)}var I=Z.position();this.findOne(".top-left").y(I.y),this.findOne(".bottom-right").x(I.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(Z.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(Z.x());else if(this._movingAnchorName==="bottom-left"){if(V){const se=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};Y=Math.sqrt(Math.pow(se.x-Z.x(),2)+Math.pow(Z.y()-se.y,2));const X=se.x<Z.x()?-1:1,ie=Z.y()<se.y?-1:1;R=Y*this.cos*X,U=Y*this.sin*ie,Z.x(se.x-R),Z.y(se.y+U)}I=Z.position(),this.findOne(".top-left").x(I.x),this.findOne(".bottom-right").y(I.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(Z.y());else if(this._movingAnchorName==="bottom-right"){if(V){const se=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};Y=Math.sqrt(Math.pow(Z.x()-se.x,2)+Math.pow(Z.y()-se.y,2));const X=this.findOne(".bottom-right").x()<se.x?-1:1,ie=this.findOne(".bottom-right").y()<se.y?-1:1;R=Y*this.cos*X,U=Y*this.sin*ie,this.findOne(".bottom-right").x(se.x+R),this.findOne(".bottom-right").y(se.y+U)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(W=this.centeredScaling()||j.altKey,W){const se=this.findOne(".top-left"),X=this.findOne(".bottom-right"),ie=se.x(),le=se.y(),ce=this.getWidth()-X.x(),ke=this.getHeight()-X.y();X.move({x:-ie,y:-le}),se.move({x:ce,y:ke})}const B=this.findOne(".top-left").getAbsolutePosition();R=B.x,U=B.y;const q=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),J=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:R,y:U,width:q,height:J,rotation:i.Konva.getAngle(this.rotation())},j)}_handleMouseUp(j){this._removeEvents(j)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(j){var R;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const U=this.getNode();E--,this._fire("transformend",{evt:j,target:U}),(R=this.getLayer())===null||R===void 0||R.batchDraw(),U&&this._nodes.forEach(Y=>{var Z;Y._fire("transformend",{evt:j,target:Y}),(Z=Y.getLayer())===null||Z===void 0||Z.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(j,R){const U=this._getNodeRect(),Y=1;if(e.Util._inRange(j.width,-this.padding()*2-Y,Y)){this.update();return}if(e.Util._inRange(j.height,-this.padding()*2-Y,Y)){this.update();return}const Z=new e.Transform;if(Z.rotate(i.Konva.getAngle(this.rotation())),this._movingAnchorName&&j.width<0&&this._movingAnchorName.indexOf("left")>=0){const V=Z.point({x:-this.padding()*2,y:0});j.x+=V.x,j.y+=V.y,j.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=V.x,this._anchorDragOffset.y-=V.y}else if(this._movingAnchorName&&j.width<0&&this._movingAnchorName.indexOf("right")>=0){const V=Z.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=V.x,this._anchorDragOffset.y-=V.y,j.width+=this.padding()*2}if(this._movingAnchorName&&j.height<0&&this._movingAnchorName.indexOf("top")>=0){const V=Z.point({x:0,y:-this.padding()*2});j.x+=V.x,j.y+=V.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=V.x,this._anchorDragOffset.y-=V.y,j.height+=this.padding()*2}else if(this._movingAnchorName&&j.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const V=Z.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=V.x,this._anchorDragOffset.y-=V.y,j.height+=this.padding()*2}if(this.boundBoxFunc()){const V=this.boundBoxFunc()(U,j);V?j=V:e.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const ae=1e7,ee=new e.Transform;ee.translate(U.x,U.y),ee.rotate(U.rotation),ee.scale(U.width/ae,U.height/ae);const ne=new e.Transform,L=j.width/ae,H=j.height/ae;this.flipEnabled()===!1?(ne.translate(j.x,j.y),ne.rotate(j.rotation),ne.translate(j.width<0?j.width:0,j.height<0?j.height:0),ne.scale(Math.abs(L),Math.abs(H))):(ne.translate(j.x,j.y),ne.rotate(j.rotation),ne.scale(L,H));const M=ne.multiply(ee.invert());this._nodes.forEach(V=>{var W;const I=V.getParent().getAbsoluteTransform(),B=V.getTransform().copy();B.translate(V.offsetX(),V.offsetY());const q=new e.Transform;q.multiply(I.copy().invert()).multiply(M).multiply(I).multiply(B);const J=q.decompose();V.setAttrs(J),(W=V.getLayer())===null||W===void 0||W.batchDraw()}),this.rotation(e.Util._getRotation(j.rotation)),this._nodes.forEach(V=>{this._fire("transform",{evt:R,target:V}),V._fire("transform",{evt:R,target:V})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(j,R){this.findOne(j).setAttrs(R)}update(){var j;const R=this._getNodeRect();this.rotation(e.Util._getRotation(R.rotation));const U=R.width,Y=R.height,Z=this.enabledAnchors(),ae=this.resizeEnabled(),ee=this.padding(),ne=this.anchorSize(),L=this.find("._anchor");L.forEach(M=>{M.setAttrs({width:ne,height:ne,offsetX:ne/2,offsetY:ne/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:ne/2+ee,offsetY:ne/2+ee,visible:ae&&Z.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:U/2,y:0,offsetY:ne/2+ee,visible:ae&&Z.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:U,y:0,offsetX:ne/2-ee,offsetY:ne/2+ee,visible:ae&&Z.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:Y/2,offsetX:ne/2+ee,visible:ae&&Z.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:U,y:Y/2,offsetX:ne/2-ee,visible:ae&&Z.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:Y,offsetX:ne/2+ee,offsetY:ne/2-ee,visible:ae&&Z.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:U/2,y:Y,offsetY:ne/2-ee,visible:ae&&Z.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:U,y:Y,offsetX:ne/2-ee,offsetY:ne/2-ee,visible:ae&&Z.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:U/2,y:-this.rotateAnchorOffset()*e.Util._sign(Y)-ee,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:U,height:Y,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const H=this.anchorStyleFunc();H&&L.forEach(M=>{H(M)}),(j=this.getLayer())===null||j===void 0||j.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const j=this.findOne("."+this._movingAnchorName);j&&j.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),a.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return r.Node.prototype.toObject.call(this)}clone(j){return r.Node.prototype.clone.call(this,j)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}bx.Transformer=P,P.isTransforming=()=>E>0;function F(A){return A instanceof Array||e.Util.warn("enabledAnchors value should be an array"),A instanceof Array&&A.forEach(function(j){w.indexOf(j)===-1&&e.Util.warn("Unknown anchor name: "+j+". Available names are: "+w.join(", "))}),A||[]}return P.prototype.className="Transformer",(0,l._registerNode)(P),t.Factory.addGetterSetter(P,"enabledAnchors",w,F),t.Factory.addGetterSetter(P,"flipEnabled",!0,(0,o.getBooleanValidator)()),t.Factory.addGetterSetter(P,"resizeEnabled",!0),t.Factory.addGetterSetter(P,"anchorSize",10,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"rotateEnabled",!0),t.Factory.addGetterSetter(P,"rotateLineVisible",!0),t.Factory.addGetterSetter(P,"rotationSnaps",[]),t.Factory.addGetterSetter(P,"rotateAnchorOffset",50,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"rotateAnchorCursor","crosshair"),t.Factory.addGetterSetter(P,"rotationSnapTolerance",5,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderEnabled",!0),t.Factory.addGetterSetter(P,"anchorStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(P,"anchorStrokeWidth",1,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"anchorFill","white"),t.Factory.addGetterSetter(P,"anchorCornerRadius",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(P,"borderStrokeWidth",1,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderDash"),t.Factory.addGetterSetter(P,"keepRatio",!0),t.Factory.addGetterSetter(P,"shiftBehavior","default"),t.Factory.addGetterSetter(P,"centeredScaling",!1),t.Factory.addGetterSetter(P,"ignoreStroke",!1),t.Factory.addGetterSetter(P,"padding",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"nodes"),t.Factory.addGetterSetter(P,"node"),t.Factory.addGetterSetter(P,"boundBoxFunc"),t.Factory.addGetterSetter(P,"anchorDragBoundFunc"),t.Factory.addGetterSetter(P,"anchorStyleFunc"),t.Factory.addGetterSetter(P,"shouldOverdrawWholeArea",!1),t.Factory.addGetterSetter(P,"useSingleNodeRotation",!0),t.Factory.backCompat(P,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),bx}var _x={},G6;function HQ(){if(G6)return _x;G6=1,Object.defineProperty(_x,"__esModule",{value:!0}),_x.Wedge=void 0;const e=rn(),t=Ra(),r=Xr(),n=sn(),s=Xr();class a extends t.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.radius(),0,r.Konva.getAngle(this.angle()),this.clockwise()),o.lineTo(0,0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}}return _x.Wedge=a,a.prototype.className="Wedge",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"radius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1),e.Factory.backCompat(a,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),_x}var Sx={},V6;function GQ(){if(V6)return Sx;V6=1,Object.defineProperty(Sx,"__esModule",{value:!0}),Sx.Blur=void 0;const e=rn(),t=zs(),r=sn();function n(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],a=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function i(l,u){const d=l.data,h=l.width,g=l.height;let p,x,v,w,C,k,_,N,E,P,F,A,j,R,U,Y,Z,ae,ee,ne;const L=u+u+1,H=h-1,M=g-1,V=u+1,W=V*(V+1)/2,I=new n,B=s[u],q=a[u];let J=null,se=I,X=null,ie=null;for(let le=1;le<L;le++)se=se.next=new n,le===V&&(J=se);se.next=I,v=x=0;for(let le=0;le<g;le++){A=j=R=U=w=C=k=_=0,N=V*(Y=d[x]),E=V*(Z=d[x+1]),P=V*(ae=d[x+2]),F=V*(ee=d[x+3]),w+=W*Y,C+=W*Z,k+=W*ae,_+=W*ee,se=I;for(let ce=0;ce<V;ce++)se.r=Y,se.g=Z,se.b=ae,se.a=ee,se=se.next;for(let ce=1;ce<V;ce++)p=x+((H<ce?H:ce)<<2),w+=(se.r=Y=d[p])*(ne=V-ce),C+=(se.g=Z=d[p+1])*ne,k+=(se.b=ae=d[p+2])*ne,_+=(se.a=ee=d[p+3])*ne,A+=Y,j+=Z,R+=ae,U+=ee,se=se.next;X=I,ie=J;for(let ce=0;ce<h;ce++)d[x+3]=ee=_*B>>q,ee!==0?(ee=255/ee,d[x]=(w*B>>q)*ee,d[x+1]=(C*B>>q)*ee,d[x+2]=(k*B>>q)*ee):d[x]=d[x+1]=d[x+2]=0,w-=N,C-=E,k-=P,_-=F,N-=X.r,E-=X.g,P-=X.b,F-=X.a,p=v+((p=ce+u+1)<H?p:H)<<2,A+=X.r=d[p],j+=X.g=d[p+1],R+=X.b=d[p+2],U+=X.a=d[p+3],w+=A,C+=j,k+=R,_+=U,X=X.next,N+=Y=ie.r,E+=Z=ie.g,P+=ae=ie.b,F+=ee=ie.a,A-=Y,j-=Z,R-=ae,U-=ee,ie=ie.next,x+=4;v+=h}for(let le=0;le<h;le++){j=R=U=A=C=k=_=w=0,x=le<<2,N=V*(Y=d[x]),E=V*(Z=d[x+1]),P=V*(ae=d[x+2]),F=V*(ee=d[x+3]),w+=W*Y,C+=W*Z,k+=W*ae,_+=W*ee,se=I;for(let ke=0;ke<V;ke++)se.r=Y,se.g=Z,se.b=ae,se.a=ee,se=se.next;let ce=h;for(let ke=1;ke<=u;ke++)x=ce+le<<2,w+=(se.r=Y=d[x])*(ne=V-ke),C+=(se.g=Z=d[x+1])*ne,k+=(se.b=ae=d[x+2])*ne,_+=(se.a=ee=d[x+3])*ne,A+=Y,j+=Z,R+=ae,U+=ee,se=se.next,ke<M&&(ce+=h);x=le,X=I,ie=J;for(let ke=0;ke<g;ke++)p=x<<2,d[p+3]=ee=_*B>>q,ee>0?(ee=255/ee,d[p]=(w*B>>q)*ee,d[p+1]=(C*B>>q)*ee,d[p+2]=(k*B>>q)*ee):d[p]=d[p+1]=d[p+2]=0,w-=N,C-=E,k-=P,_-=F,N-=X.r,E-=X.g,P-=X.b,F-=X.a,p=le+((p=ke+V)<M?p:M)*h<<2,w+=A+=X.r=d[p],C+=j+=X.g=d[p+1],k+=R+=X.b=d[p+2],_+=U+=X.a=d[p+3],X=X.next,N+=Y=ie.r,E+=Z=ie.g,P+=ae=ie.b,F+=ee=ie.a,A-=Y,j-=Z,R-=ae,U-=ee,ie=ie.next,x+=h}}const o=function(u){const d=Math.round(this.blurRadius());d>0&&i(u,d)};return Sx.Blur=o,e.Factory.addGetterSetter(t.Node,"blurRadius",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Sx}var kx={},K6;function VQ(){if(K6)return kx;K6=1,Object.defineProperty(kx,"__esModule",{value:!0}),kx.Brighten=void 0;const e=rn(),t=zs(),r=sn(),n=function(s){const a=this.brightness()*255,i=s.data,o=i.length;for(let l=0;l<o;l+=4)i[l]+=a,i[l+1]+=a,i[l+2]+=a};return kx.Brighten=n,e.Factory.addGetterSetter(t.Node,"brightness",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),kx}var Cx={},q6;function KQ(){if(q6)return Cx;q6=1,Object.defineProperty(Cx,"__esModule",{value:!0}),Cx.Contrast=void 0;const e=rn(),t=zs(),r=sn(),n=function(s){const a=Math.pow((this.contrast()+100)/100,2),i=s.data,o=i.length;let l=150,u=150,d=150;for(let h=0;h<o;h+=4)l=i[h],u=i[h+1],d=i[h+2],l/=255,l-=.5,l*=a,l+=.5,l*=255,u/=255,u-=.5,u*=a,u+=.5,u*=255,d/=255,d-=.5,d*=a,d+=.5,d*=255,l=l<0?0:l>255?255:l,u=u<0?0:u>255?255:u,d=d<0?0:d>255?255:d,i[h]=l,i[h+1]=u,i[h+2]=d};return Cx.Contrast=n,e.Factory.addGetterSetter(t.Node,"contrast",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Cx}var Tx={},Y6;function qQ(){if(Y6)return Tx;Y6=1,Object.defineProperty(Tx,"__esModule",{value:!0}),Tx.Emboss=void 0;const e=rn(),t=zs(),r=js(),n=sn(),s=function(a){const i=this.embossStrength()*10,o=this.embossWhiteLevel()*255,l=this.embossDirection(),u=this.embossBlend(),d=a.data,h=a.width,g=a.height,p=h*4;let x=0,v=0,w=g;switch(l){case"top-left":x=-1,v=-1;break;case"top":x=-1,v=0;break;case"top-right":x=-1,v=1;break;case"right":x=0,v=1;break;case"bottom-right":x=1,v=1;break;case"bottom":x=1,v=0;break;case"bottom-left":x=1,v=-1;break;case"left":x=0,v=-1;break;default:r.Util.error("Unknown emboss direction: "+l)}do{const C=(w-1)*p;let k=x;w+k<1&&(k=0),w+k>g&&(k=0);const _=(w-1+k)*h*4;let N=h;do{const E=C+(N-1)*4;let P=v;N+P<1&&(P=0),N+P>h&&(P=0);const F=_+(N-1+P)*4,A=d[E]-d[F],j=d[E+1]-d[F+1],R=d[E+2]-d[F+2];let U=A;const Y=U>0?U:-U,Z=j>0?j:-j,ae=R>0?R:-R;if(Z>Y&&(U=j),ae>Y&&(U=R),U*=i,u){const ee=d[E]+U,ne=d[E+1]+U,L=d[E+2]+U;d[E]=ee>255?255:ee<0?0:ee,d[E+1]=ne>255?255:ne<0?0:ne,d[E+2]=L>255?255:L<0?0:L}else{let ee=o-U;ee<0?ee=0:ee>255&&(ee=255),d[E]=d[E+1]=d[E+2]=ee}}while(--N)}while(--w)};return Tx.Emboss=s,e.Factory.addGetterSetter(t.Node,"embossStrength",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossWhiteLevel",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossDirection","top-left",void 0,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossBlend",!1,void 0,e.Factory.afterSetFilter),Tx}var Ex={},X6;function YQ(){if(X6)return Ex;X6=1,Object.defineProperty(Ex,"__esModule",{value:!0}),Ex.Enhance=void 0;const e=rn(),t=zs(),r=sn();function n(a,i,o,l,u){const d=o-i,h=u-l;if(d===0)return l+h/2;if(h===0)return l;let g=(a-i)/d;return g=h*g+l,g}const s=function(a){const i=a.data,o=i.length;let l=i[0],u=l,d,h=i[1],g=h,p,x=i[2],v=x,w;const C=this.enhance();if(C===0)return;for(let A=0;A<o;A+=4)d=i[A+0],d<l?l=d:d>u&&(u=d),p=i[A+1],p<h?h=p:p>g&&(g=p),w=i[A+2],w<x?x=w:w>v&&(v=w);u===l&&(u=255,l=0),g===h&&(g=255,h=0),v===x&&(v=255,x=0);let k,_,N,E,P,F;if(C>0)k=u+C*(255-u),_=l-C*(l-0),N=g+C*(255-g),E=h-C*(h-0),P=v+C*(255-v),F=x-C*(x-0);else{const A=(u+l)*.5;k=u+C*(u-A),_=l+C*(l-A);const j=(g+h)*.5;N=g+C*(g-j),E=h+C*(h-j);const R=(v+x)*.5;P=v+C*(v-R),F=x+C*(x-R)}for(let A=0;A<o;A+=4)i[A+0]=n(i[A+0],l,u,_,k),i[A+1]=n(i[A+1],h,g,E,N),i[A+2]=n(i[A+2],x,v,F,P)};return Ex.Enhance=s,e.Factory.addGetterSetter(t.Node,"enhance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ex}var Nx={},J6;function XQ(){if(J6)return Nx;J6=1,Object.defineProperty(Nx,"__esModule",{value:!0}),Nx.Grayscale=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=.34*r[s]+.5*r[s+1]+.16*r[s+2];r[s]=a,r[s+1]=a,r[s+2]=a}};return Nx.Grayscale=e,Nx}var Ax={},Q6;function JQ(){if(Q6)return Ax;Q6=1,Object.defineProperty(Ax,"__esModule",{value:!0}),Ax.HSL=void 0;const e=rn(),t=zs(),r=sn();e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"luminance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter);const n=function(s){const a=s.data,i=a.length,o=1,l=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,d=this.luminance()*127,h=o*l*Math.cos(u*Math.PI/180),g=o*l*Math.sin(u*Math.PI/180),p=.299*o+.701*h+.167*g,x=.587*o-.587*h+.33*g,v=.114*o-.114*h-.497*g,w=.299*o-.299*h-.328*g,C=.587*o+.413*h+.035*g,k=.114*o-.114*h+.293*g,_=.299*o-.3*h+1.25*g,N=.587*o-.586*h-1.05*g,E=.114*o+.886*h-.2*g;let P,F,A,j;for(let R=0;R<i;R+=4)P=a[R+0],F=a[R+1],A=a[R+2],j=a[R+3],a[R+0]=p*P+x*F+v*A+d,a[R+1]=w*P+C*F+k*A+d,a[R+2]=_*P+N*F+E*A+d,a[R+3]=j};return Ax.HSL=n,Ax}var jx={},Z6;function QQ(){if(Z6)return jx;Z6=1,Object.defineProperty(jx,"__esModule",{value:!0}),jx.HSV=void 0;const e=rn(),t=zs(),r=sn(),n=function(s){const a=s.data,i=a.length,o=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,d=o*l*Math.cos(u*Math.PI/180),h=o*l*Math.sin(u*Math.PI/180),g=.299*o+.701*d+.167*h,p=.587*o-.587*d+.33*h,x=.114*o-.114*d-.497*h,v=.299*o-.299*d-.328*h,w=.587*o+.413*d+.035*h,C=.114*o-.114*d+.293*h,k=.299*o-.3*d+1.25*h,_=.587*o-.586*d-1.05*h,N=.114*o+.886*d-.2*h;for(let E=0;E<i;E+=4){const P=a[E+0],F=a[E+1],A=a[E+2],j=a[E+3];a[E+0]=g*P+p*F+x*A,a[E+1]=v*P+w*F+C*A,a[E+2]=k*P+_*F+N*A,a[E+3]=j}};return jx.HSV=n,e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"value",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),jx}var Px={},eP;function ZQ(){if(eP)return Px;eP=1,Object.defineProperty(Px,"__esModule",{value:!0}),Px.Invert=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4)r[s]=255-r[s],r[s+1]=255-r[s+1],r[s+2]=255-r[s+2]};return Px.Invert=e,Px}var Fx={},tP;function eZ(){if(tP)return Fx;tP=1,Object.defineProperty(Fx,"__esModule",{value:!0}),Fx.Kaleidoscope=void 0;const e=rn(),t=zs(),r=js(),n=sn(),s=function(o,l,u){const d=o.data,h=l.data,g=o.width,p=o.height,x=u.polarCenterX||g/2,v=u.polarCenterY||p/2;let w=Math.sqrt(x*x+v*v),C=g-x,k=p-v;const _=Math.sqrt(C*C+k*k);w=_>w?_:w;const N=p,E=g,P=360/E*Math.PI/180;for(let F=0;F<E;F+=1){const A=Math.sin(F*P),j=Math.cos(F*P);for(let R=0;R<N;R+=1){C=Math.floor(x+w*R/N*j),k=Math.floor(v+w*R/N*A);let U=(k*g+C)*4;const Y=d[U+0],Z=d[U+1],ae=d[U+2],ee=d[U+3];U=(F+R*g)*4,h[U+0]=Y,h[U+1]=Z,h[U+2]=ae,h[U+3]=ee}}},a=function(o,l,u){const d=o.data,h=l.data,g=o.width,p=o.height,x=u.polarCenterX||g/2,v=u.polarCenterY||p/2;let w=Math.sqrt(x*x+v*v),C=g-x,k=p-v;const _=Math.sqrt(C*C+k*k);w=_>w?_:w;const N=p,E=g,P=0;let F,A;for(C=0;C<g;C+=1)for(k=0;k<p;k+=1){const j=C-x,R=k-v,U=Math.sqrt(j*j+R*R)*N/w;let Y=(Math.atan2(R,j)*180/Math.PI+360+P)%360;Y=Y*E/360,F=Math.floor(Y),A=Math.floor(U);let Z=(A*g+F)*4;const ae=d[Z+0],ee=d[Z+1],ne=d[Z+2],L=d[Z+3];Z=(k*g+C)*4,h[Z+0]=ae,h[Z+1]=ee,h[Z+2]=ne,h[Z+3]=L}},i=function(o){const l=o.width,u=o.height;let d,h,g,p,x,v,w,C,k,_,N=Math.round(this.kaleidoscopePower());const E=Math.round(this.kaleidoscopeAngle()),P=Math.floor(l*(E%360)/360);if(N<1)return;const F=r.Util.createCanvasElement();F.width=l,F.height=u;const A=F.getContext("2d").getImageData(0,0,l,u);r.Util.releaseCanvas(F),s(o,A,{polarCenterX:l/2,polarCenterY:u/2});let j=l/Math.pow(2,N);for(;j<=8;)j=j*2,N-=1;j=Math.ceil(j);let R=j,U=0,Y=R,Z=1;for(P+j>l&&(U=R,Y=0,Z=-1),h=0;h<u;h+=1)for(d=U;d!==Y;d+=Z)g=Math.round(d+P)%l,k=(l*h+g)*4,x=A.data[k+0],v=A.data[k+1],w=A.data[k+2],C=A.data[k+3],_=(l*h+d)*4,A.data[_+0]=x,A.data[_+1]=v,A.data[_+2]=w,A.data[_+3]=C;for(h=0;h<u;h+=1)for(R=Math.floor(j),p=0;p<N;p+=1){for(d=0;d<R+1;d+=1)k=(l*h+d)*4,x=A.data[k+0],v=A.data[k+1],w=A.data[k+2],C=A.data[k+3],_=(l*h+R*2-d-1)*4,A.data[_+0]=x,A.data[_+1]=v,A.data[_+2]=w,A.data[_+3]=C;R*=2}a(A,o,{})};return Fx.Kaleidoscope=i,e.Factory.addGetterSetter(t.Node,"kaleidoscopePower",2,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"kaleidoscopeAngle",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),Fx}var Ox={},rP;function tZ(){if(rP)return Ox;rP=1,Object.defineProperty(Ox,"__esModule",{value:!0}),Ox.Mask=void 0;const e=rn(),t=zs(),r=sn();function n(g,p,x){let v=(x*g.width+p)*4;const w=[];return w.push(g.data[v++],g.data[v++],g.data[v++],g.data[v++]),w}function s(g,p){return Math.sqrt(Math.pow(g[0]-p[0],2)+Math.pow(g[1]-p[1],2)+Math.pow(g[2]-p[2],2))}function a(g){const p=[0,0,0];for(let x=0;x<g.length;x++)p[0]+=g[x][0],p[1]+=g[x][1],p[2]+=g[x][2];return p[0]/=g.length,p[1]/=g.length,p[2]/=g.length,p}function i(g,p){const x=n(g,0,0),v=n(g,g.width-1,0),w=n(g,0,g.height-1),C=n(g,g.width-1,g.height-1),k=p||10;if(s(x,v)<k&&s(v,C)<k&&s(C,w)<k&&s(w,x)<k){const _=a([v,x,C,w]),N=[];for(let E=0;E<g.width*g.height;E++){const P=s(_,[g.data[E*4],g.data[E*4+1],g.data[E*4+2]]);N[E]=P<k?0:255}return N}}function o(g,p){for(let x=0;x<g.width*g.height;x++)g.data[4*x+3]=p[x]}function l(g,p,x){const v=[1,1,1,1,0,1,1,1,1],w=Math.round(Math.sqrt(v.length)),C=Math.floor(w/2),k=[];for(let _=0;_<x;_++)for(let N=0;N<p;N++){const E=_*p+N;let P=0;for(let F=0;F<w;F++)for(let A=0;A<w;A++){const j=_+F-C,R=N+A-C;if(j>=0&&j<x&&R>=0&&R<p){const U=j*p+R,Y=v[F*w+A];P+=g[U]*Y}}k[E]=P===2040?255:0}return k}function u(g,p,x){const v=[1,1,1,1,1,1,1,1,1],w=Math.round(Math.sqrt(v.length)),C=Math.floor(w/2),k=[];for(let _=0;_<x;_++)for(let N=0;N<p;N++){const E=_*p+N;let P=0;for(let F=0;F<w;F++)for(let A=0;A<w;A++){const j=_+F-C,R=N+A-C;if(j>=0&&j<x&&R>=0&&R<p){const U=j*p+R,Y=v[F*w+A];P+=g[U]*Y}}k[E]=P>=1020?255:0}return k}function d(g,p,x){const v=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],w=Math.round(Math.sqrt(v.length)),C=Math.floor(w/2),k=[];for(let _=0;_<x;_++)for(let N=0;N<p;N++){const E=_*p+N;let P=0;for(let F=0;F<w;F++)for(let A=0;A<w;A++){const j=_+F-C,R=N+A-C;if(j>=0&&j<x&&R>=0&&R<p){const U=j*p+R,Y=v[F*w+A];P+=g[U]*Y}}k[E]=P}return k}const h=function(g){const p=this.threshold();let x=i(g,p);return x&&(x=l(x,g.width,g.height),x=u(x,g.width,g.height),x=d(x,g.width,g.height),o(g,x)),g};return Ox.Mask=h,e.Factory.addGetterSetter(t.Node,"threshold",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ox}var Dx={},nP;function rZ(){if(nP)return Dx;nP=1,Object.defineProperty(Dx,"__esModule",{value:!0}),Dx.Noise=void 0;const e=rn(),t=zs(),r=sn(),n=function(s){const a=this.noise()*255,i=s.data,o=i.length,l=a/2;for(let u=0;u<o;u+=4)i[u+0]+=l-2*l*Math.random(),i[u+1]+=l-2*l*Math.random(),i[u+2]+=l-2*l*Math.random()};return Dx.Noise=n,e.Factory.addGetterSetter(t.Node,"noise",.2,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Dx}var Rx={},sP;function nZ(){if(sP)return Rx;sP=1,Object.defineProperty(Rx,"__esModule",{value:!0}),Rx.Pixelate=void 0;const e=rn(),t=js(),r=zs(),n=sn(),s=function(a){let i=Math.ceil(this.pixelSize()),o=a.width,l=a.height,u=Math.ceil(o/i),d=Math.ceil(l/i),h=a.data;if(i<=0){t.Util.error("pixelSize value can not be <= 0");return}for(let g=0;g<u;g+=1)for(let p=0;p<d;p+=1){let x=0,v=0,w=0,C=0;const k=g*i,_=k+i,N=p*i,E=N+i;let P=0;for(let F=k;F<_;F+=1)if(!(F>=o))for(let A=N;A<E;A+=1){if(A>=l)continue;const j=(o*A+F)*4;x+=h[j+0],v+=h[j+1],w+=h[j+2],C+=h[j+3],P+=1}x=x/P,v=v/P,w=w/P,C=C/P;for(let F=k;F<_;F+=1)if(!(F>=o))for(let A=N;A<E;A+=1){if(A>=l)continue;const j=(o*A+F)*4;h[j+0]=x,h[j+1]=v,h[j+2]=w,h[j+3]=C}}};return Rx.Pixelate=s,e.Factory.addGetterSetter(r.Node,"pixelSize",8,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),Rx}var Ix={},aP;function sZ(){if(aP)return Ix;aP=1,Object.defineProperty(Ix,"__esModule",{value:!0}),Ix.Posterize=void 0;const e=rn(),t=zs(),r=sn(),n=function(s){const a=Math.round(this.levels()*254)+1,i=s.data,o=i.length,l=255/a;for(let u=0;u<o;u+=1)i[u]=Math.floor(i[u]/l)*l};return Ix.Posterize=n,e.Factory.addGetterSetter(t.Node,"levels",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ix}var Mx={},iP;function aZ(){if(iP)return Mx;iP=1,Object.defineProperty(Mx,"__esModule",{value:!0}),Mx.RGB=void 0;const e=rn(),t=zs(),r=sn(),n=function(s){const a=s.data,i=a.length,o=this.red(),l=this.green(),u=this.blue();for(let d=0;d<i;d+=4){const h=(.34*a[d]+.5*a[d+1]+.16*a[d+2])/255;a[d]=h*o,a[d+1]=h*l,a[d+2]=h*u,a[d+3]=a[d+3]}};return Mx.RGB=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),Mx}var Lx={},oP;function iZ(){if(oP)return Lx;oP=1,Object.defineProperty(Lx,"__esModule",{value:!0}),Lx.RGBA=void 0;const e=rn(),t=zs(),r=sn(),n=function(s){const a=s.data,i=a.length,o=this.red(),l=this.green(),u=this.blue(),d=this.alpha();for(let h=0;h<i;h+=4){const g=1-d;a[h]=o*d+a[h]*g,a[h+1]=l*d+a[h+1]*g,a[h+2]=u*d+a[h+2]*g}};return Lx.RGBA=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),Lx}var Bx={},lP;function oZ(){if(lP)return Bx;lP=1,Object.defineProperty(Bx,"__esModule",{value:!0}),Bx.Sepia=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=r[s+0],i=r[s+1],o=r[s+2];r[s+0]=Math.min(255,a*.393+i*.769+o*.189),r[s+1]=Math.min(255,a*.349+i*.686+o*.168),r[s+2]=Math.min(255,a*.272+i*.534+o*.131)}};return Bx.Sepia=e,Bx}var $x={},cP;function lZ(){if(cP)return $x;cP=1,Object.defineProperty($x,"__esModule",{value:!0}),$x.Solarize=void 0;const e=function(t){const r=t.data,n=t.width,s=t.height,a=n*4;let i=s;do{const o=(i-1)*a;let l=n;do{const u=o+(l-1)*4;let d=r[u],h=r[u+1],g=r[u+2];d>127&&(d=255-d),h>127&&(h=255-h),g>127&&(g=255-g),r[u]=d,r[u+1]=h,r[u+2]=g}while(--l)}while(--i)};return $x.Solarize=e,$x}var Ux={},uP;function cZ(){if(uP)return Ux;uP=1,Object.defineProperty(Ux,"__esModule",{value:!0}),Ux.Threshold=void 0;const e=rn(),t=zs(),r=sn(),n=function(s){const a=this.threshold()*255,i=s.data,o=i.length;for(let l=0;l<o;l+=1)i[l]=i[l]<a?0:255};return Ux.Threshold=n,e.Factory.addGetterSetter(t.Node,"threshold",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ux}var dP;function uZ(){if(dP)return tx;dP=1,Object.defineProperty(tx,"__esModule",{value:!0}),tx.Konva=void 0;const e=jT(),t=PQ(),r=OQ(),n=DQ(),s=RQ(),a=IQ(),i=MQ(),o=mL(),l=QN(),u=pL(),d=LQ(),h=BQ(),g=$Q(),p=UQ(),x=xL(),v=zQ(),w=WQ(),C=HQ(),k=GQ(),_=VQ(),N=KQ(),E=qQ(),P=YQ(),F=XQ(),A=JQ(),j=QQ(),R=ZQ(),U=eZ(),Y=tZ(),Z=rZ(),ae=nZ(),ee=sZ(),ne=aZ(),L=iZ(),H=oZ(),M=lZ(),V=cZ();return tx.Konva=e.Konva.Util._assign(e.Konva,{Arc:t.Arc,Arrow:r.Arrow,Circle:n.Circle,Ellipse:s.Ellipse,Image:a.Image,Label:i.Label,Tag:i.Tag,Line:o.Line,Path:l.Path,Rect:u.Rect,RegularPolygon:d.RegularPolygon,Ring:h.Ring,Sprite:g.Sprite,Star:p.Star,Text:x.Text,TextPath:v.TextPath,Transformer:w.Transformer,Wedge:C.Wedge,Filters:{Blur:k.Blur,Brighten:_.Brighten,Contrast:N.Contrast,Emboss:E.Emboss,Enhance:P.Enhance,Grayscale:F.Grayscale,HSL:A.HSL,HSV:j.HSV,Invert:R.Invert,Kaleidoscope:U.Kaleidoscope,Mask:Y.Mask,Noise:Z.Noise,Pixelate:ae.Pixelate,Posterize:ee.Posterize,RGB:ne.RGB,RGBA:L.RGBA,Sepia:H.Sepia,Solarize:M.Solarize,Threshold:V.Threshold}}),tx}var dZ=eb.exports,fP;function fZ(){if(fP)return eb.exports;fP=1,Object.defineProperty(dZ,"__esModule",{value:!0});const e=uZ();return eb.exports=e.Konva,eb.exports}var yL=fZ();const hZ=Nl(yL),gZ=mM({__proto__:null,default:hZ},[yL]);var fw={exports:{}},hP;function mZ(){return hP||(hP=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var r=jT();Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=jT();e.exports=n.Konva})(fw,fw.exports)),fw.exports}var pZ=mZ();const $y=Nl(pZ);var qS={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YS,gP;function xZ(){return gP||(gP=1,YS=function(t){var r={},n=b0(),s=dN(),a=Object.assign;function i(y){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+y,O=1;O<arguments.length;O++)b+="&args[]="+encodeURIComponent(arguments[O]);return"Minified React error #"+y+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),u=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),x=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),N=Symbol.for("react.offscreen"),E=Symbol.iterator;function P(y){return y===null||typeof y!="object"?null:(y=E&&y[E]||y["@@iterator"],typeof y=="function"?y:null)}function F(y){if(y==null)return null;if(typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y;switch(y){case d:return"Fragment";case u:return"Portal";case g:return"Profiler";case h:return"StrictMode";case w:return"Suspense";case C:return"SuspenseList"}if(typeof y=="object")switch(y.$$typeof){case x:return(y.displayName||"Context")+".Consumer";case p:return(y._context.displayName||"Context")+".Provider";case v:var b=y.render;return y=y.displayName,y||(y=b.displayName||b.name||"",y=y!==""?"ForwardRef("+y+")":"ForwardRef"),y;case k:return b=y.displayName||null,b!==null?b:F(y.type)||"Memo";case _:b=y._payload,y=y._init;try{return F(y(b))}catch{}}return null}function A(y){var b=y.type;switch(y.tag){case 24:return"Cache";case 9:return(b.displayName||"Context")+".Consumer";case 10:return(b._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return y=b.render,y=y.displayName||y.name||"",b.displayName||(y!==""?"ForwardRef("+y+")":"ForwardRef");case 7:return"Fragment";case 5:return b;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(b);case 8:return b===h?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof b=="function")return b.displayName||b.name||null;if(typeof b=="string")return b}return null}function j(y){var b=y,O=y;if(y.alternate)for(;b.return;)b=b.return;else{y=b;do b=y,(b.flags&4098)!==0&&(O=b.return),y=b.return;while(y)}return b.tag===3?O:null}function R(y){if(j(y)!==y)throw Error(i(188))}function U(y){var b=y.alternate;if(!b){if(b=j(y),b===null)throw Error(i(188));return b!==y?null:y}for(var O=y,z=b;;){var K=O.return;if(K===null)break;var te=K.alternate;if(te===null){if(z=K.return,z!==null){O=z;continue}break}if(K.child===te.child){for(te=K.child;te;){if(te===O)return R(K),y;if(te===z)return R(K),b;te=te.sibling}throw Error(i(188))}if(O.return!==z.return)O=K,z=te;else{for(var ve=!1,Ge=K.child;Ge;){if(Ge===O){ve=!0,O=K,z=te;break}if(Ge===z){ve=!0,z=K,O=te;break}Ge=Ge.sibling}if(!ve){for(Ge=te.child;Ge;){if(Ge===O){ve=!0,O=te,z=K;break}if(Ge===z){ve=!0,z=te,O=K;break}Ge=Ge.sibling}if(!ve)throw Error(i(189))}}if(O.alternate!==z)throw Error(i(190))}if(O.tag!==3)throw Error(i(188));return O.stateNode.current===O?y:b}function Y(y){return y=U(y),y!==null?Z(y):null}function Z(y){if(y.tag===5||y.tag===6)return y;for(y=y.child;y!==null;){var b=Z(y);if(b!==null)return b;y=y.sibling}return null}function ae(y){if(y.tag===5||y.tag===6)return y;for(y=y.child;y!==null;){if(y.tag!==4){var b=ae(y);if(b!==null)return b}y=y.sibling}return null}var ee=Array.isArray,ne=t.getPublicInstance,L=t.getRootHostContext,H=t.getChildHostContext,M=t.prepareForCommit,V=t.resetAfterCommit,W=t.createInstance,I=t.appendInitialChild,B=t.finalizeInitialChildren,q=t.prepareUpdate,J=t.shouldSetTextContent,se=t.createTextInstance,X=t.scheduleTimeout,ie=t.cancelTimeout,le=t.noTimeout,ce=t.isPrimaryRenderer,ke=t.supportsMutation,re=t.supportsPersistence,ge=t.supportsHydration,Ne=t.getInstanceFromNode,je=t.preparePortalMount,Ke=t.getCurrentEventPriority,Ue=t.detachDeletedInstance,It=t.supportsMicrotasks,rt=t.scheduleMicrotask,wt=t.supportsTestSelectors,xt=t.findFiberRoot,lt=t.getBoundingRect,pt=t.getTextContent,Rt=t.isHiddenSubtree,Mt=t.matchAccessibilityRole,Qe=t.setFocusIfFocusable,Re=t.setupIntersectionObserver,Be=t.appendChild,ct=t.appendChildToContainer,We=t.commitTextUpdate,nt=t.commitMount,Tt=t.commitUpdate,jt=t.insertBefore,Vt=t.insertInContainerBefore,fr=t.removeChild,Dr=t.removeChildFromContainer,zr=t.resetTextContent,or=t.hideInstance,nr=t.hideTextInstance,me=t.unhideInstance,Ae=t.unhideTextInstance,Fe=t.clearContainer,Me=t.cloneInstance,kt=t.createContainerChildSet,Oe=t.appendChildToContainerChildSet,at=t.finalizeContainerChildren,Ce=t.replaceContainerChildren,Ve=t.cloneHiddenInstance,Ze=t.cloneHiddenTextInstance,Ft=t.canHydrateInstance,zt=t.canHydrateTextInstance,er=t.canHydrateSuspenseInstance,hr=t.isSuspenseInstancePending,ir=t.isSuspenseInstanceFallback,Wr=t.getSuspenseInstanceFallbackErrorDetails,ue=t.registerSuspenseInstanceRetry,be=t.getNextHydratableSibling,ye=t.getFirstHydratableChild,xe=t.getFirstHydratableChildWithinContainer,_e=t.getFirstHydratableChildWithinSuspenseInstance,Se=t.hydrateInstance,He=t.hydrateTextInstance,it=t.hydrateSuspenseInstance,Ye=t.getNextHydratableInstanceAfterSuspenseInstance,oe=t.commitHydratedContainer,fe=t.commitHydratedSuspenseInstance,Te=t.clearSuspenseBoundary,Ee=t.clearSuspenseBoundaryFromContainer,Xe=t.shouldDeleteUnhydratedTailInstances,ut=t.didNotMatchHydratedContainerTextInstance,ft=t.didNotMatchHydratedTextInstance,Kt;function Ct(y){if(Kt===void 0)try{throw Error()}catch(O){var b=O.stack.trim().match(/\n( *(at )?)/);Kt=b&&b[1]||""}return`
`+Kt+y}var Ht=!1;function yr(y,b){if(!y||Ht)return"";Ht=!0;var O=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(b)if(b=function(){throw Error()},Object.defineProperty(b.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(b,[])}catch(Wt){var z=Wt}Reflect.construct(y,[],b)}else{try{b.call()}catch(Wt){z=Wt}y.call(b.prototype)}else{try{throw Error()}catch(Wt){z=Wt}y()}}catch(Wt){if(Wt&&z&&typeof Wt.stack=="string"){for(var K=Wt.stack.split(`
`),te=z.stack.split(`
`),ve=K.length-1,Ge=te.length-1;1<=ve&&0<=Ge&&K[ve]!==te[Ge];)Ge--;for(;1<=ve&&0<=Ge;ve--,Ge--)if(K[ve]!==te[Ge]){if(ve!==1||Ge!==1)do if(ve--,Ge--,0>Ge||K[ve]!==te[Ge]){var mt=`
`+K[ve].replace(" at new "," at ");return y.displayName&&mt.includes("<anonymous>")&&(mt=mt.replace("<anonymous>",y.displayName)),mt}while(1<=ve&&0<=Ge);break}}}finally{Ht=!1,Error.prepareStackTrace=O}return(y=y?y.displayName||y.name:"")?Ct(y):""}var wr=Object.prototype.hasOwnProperty,vr=[],Er=-1;function qr(y){return{current:y}}function Hr(y){0>Er||(y.current=vr[Er],vr[Er]=null,Er--)}function he(y,b){Er++,vr[Er]=y.current,y.current=b}var vt={},xr=qr(vt),br=qr(!1),Bn=vt;function An(y,b){var O=y.type.contextTypes;if(!O)return vt;var z=y.stateNode;if(z&&z.__reactInternalMemoizedUnmaskedChildContext===b)return z.__reactInternalMemoizedMaskedChildContext;var K={},te;for(te in O)K[te]=b[te];return z&&(y=y.stateNode,y.__reactInternalMemoizedUnmaskedChildContext=b,y.__reactInternalMemoizedMaskedChildContext=K),K}function et(y){return y=y.childContextTypes,y!=null}function we(){Hr(br),Hr(xr)}function $e(y,b,O){if(xr.current!==vt)throw Error(i(168));he(xr,b),he(br,O)}function Le(y,b,O){var z=y.stateNode;if(b=b.childContextTypes,typeof z.getChildContext!="function")return O;z=z.getChildContext();for(var K in z)if(!(K in b))throw Error(i(108,A(y)||"Unknown",K));return a({},O,z)}function Et(y){return y=(y=y.stateNode)&&y.__reactInternalMemoizedMergedChildContext||vt,Bn=xr.current,he(xr,y),he(br,br.current),!0}function Nt(y,b,O){var z=y.stateNode;if(!z)throw Error(i(169));O?(y=Le(y,b,Bn),z.__reactInternalMemoizedMergedChildContext=y,Hr(br),Hr(xr),he(xr,y)):Hr(br),he(br,O)}var mr=Math.clz32?Math.clz32:Qt,an=Math.log,ht=Math.LN2;function Qt(y){return y>>>=0,y===0?32:31-(an(y)/ht|0)|0}var Pt=64,es=4194304;function Jr(y){switch(y&-y){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return y&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return y}}function Nr(y,b){var O=y.pendingLanes;if(O===0)return 0;var z=0,K=y.suspendedLanes,te=y.pingedLanes,ve=O&268435455;if(ve!==0){var Ge=ve&~K;Ge!==0?z=Jr(Ge):(te&=ve,te!==0&&(z=Jr(te)))}else ve=O&~K,ve!==0?z=Jr(ve):te!==0&&(z=Jr(te));if(z===0)return 0;if(b!==0&&b!==z&&(b&K)===0&&(K=z&-z,te=b&-b,K>=te||K===16&&(te&4194240)!==0))return b;if((z&4)!==0&&(z|=O&16),b=y.entangledLanes,b!==0)for(y=y.entanglements,b&=z;0<b;)O=31-mr(b),K=1<<O,z|=y[O],b&=~K;return z}function os(y,b){switch(y){case 1:case 2:case 4:return b+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function li(y,b){for(var O=y.suspendedLanes,z=y.pingedLanes,K=y.expirationTimes,te=y.pendingLanes;0<te;){var ve=31-mr(te),Ge=1<<ve,mt=K[ve];mt===-1?((Ge&O)===0||(Ge&z)!==0)&&(K[ve]=os(Ge,b)):mt<=b&&(y.expiredLanes|=Ge),te&=~Ge}}function Go(y){return y=y.pendingLanes&-1073741825,y!==0?y:y&1073741824?1073741824:0}function cc(){var y=Pt;return Pt<<=1,(Pt&4194240)===0&&(Pt=64),y}function uc(y){for(var b=[],O=0;31>O;O++)b.push(y);return b}function Zi(y,b,O){y.pendingLanes|=b,b!==536870912&&(y.suspendedLanes=0,y.pingedLanes=0),y=y.eventTimes,b=31-mr(b),y[b]=O}function dc(y,b){var O=y.pendingLanes&~b;y.pendingLanes=b,y.suspendedLanes=0,y.pingedLanes=0,y.expiredLanes&=b,y.mutableReadLanes&=b,y.entangledLanes&=b,b=y.entanglements;var z=y.eventTimes;for(y=y.expirationTimes;0<O;){var K=31-mr(O),te=1<<K;b[K]=0,z[K]=-1,y[K]=-1,O&=~te}}function Vo(y,b){var O=y.entangledLanes|=b;for(y=y.entanglements;O;){var z=31-mr(O),K=1<<z;K&b|y[z]&b&&(y[z]|=b),O&=~K}}var Qr=0;function md(y){return y&=-y,1<y?4<y?(y&268435455)!==0?16:536870912:4:1}var Ko=s.unstable_scheduleCallback,c1=s.unstable_cancelCallback,u1=s.unstable_shouldYield,zf=s.unstable_requestPaint,Hs=s.unstable_now,I0=s.unstable_ImmediatePriority,M0=s.unstable_UserBlockingPriority,L0=s.unstable_NormalPriority,z2=s.unstable_IdlePriority,fc=null,ci=null;function pd(y){if(ci&&typeof ci.onCommitFiberRoot=="function")try{ci.onCommitFiberRoot(fc,y,void 0,(y.current.flags&128)===128)}catch{}}function B0(y,b){return y===b&&(y!==0||1/y===1/b)||y!==y&&b!==b}var bo=typeof Object.is=="function"?Object.is:B0,Ol=null,xd=!1,yd=!1;function $0(y){Ol===null?Ol=[y]:Ol.push(y)}function d1(y){xd=!0,$0(y)}function na(){if(!yd&&Ol!==null){yd=!0;var y=0,b=Qr;try{var O=Ol;for(Qr=1;y<O.length;y++){var z=O[y];do z=z(!0);while(z!==null)}Ol=null,xd=!1}catch(K){throw Ol!==null&&(Ol=Ol.slice(y+1)),Ko(I0,na),K}finally{Qr=b,yd=!1}}return null}var hc=[],Dl=0,Wf=null,tu=0,La=[],ji=0,Ps=null,ui=1,_o="";function So(y,b){hc[Dl++]=tu,hc[Dl++]=Wf,Wf=y,tu=b}function f1(y,b,O){La[ji++]=ui,La[ji++]=_o,La[ji++]=Ps,Ps=y;var z=ui;y=_o;var K=32-mr(z)-1;z&=~(1<<K),O+=1;var te=32-mr(b)+K;if(30<te){var ve=K-K%5;te=(z&(1<<ve)-1).toString(32),z>>=ve,K-=ve,ui=1<<32-mr(b)+K|O<<K|z,_o=te+y}else ui=1<<te|O<<K|z,_o=y}function Hf(y){y.return!==null&&(So(y,1),f1(y,1,0))}function Gf(y){for(;y===Wf;)Wf=hc[--Dl],hc[Dl]=null,tu=hc[--Dl],hc[Dl]=null;for(;y===Ps;)Ps=La[--ji],La[ji]=null,_o=La[--ji],La[ji]=null,ui=La[--ji],La[ji]=null}var sa=null,Ba=null,Rn=!1,Vf=!1,ko=null;function h1(y,b){var O=$i(5,null,null,0);O.elementType="DELETED",O.stateNode=b,O.return=y,b=y.deletions,b===null?(y.deletions=[O],y.flags|=16):b.push(O)}function U0(y,b){switch(y.tag){case 5:return b=Ft(b,y.type,y.pendingProps),b!==null?(y.stateNode=b,sa=y,Ba=ye(b),!0):!1;case 6:return b=zt(b,y.pendingProps),b!==null?(y.stateNode=b,sa=y,Ba=null,!0):!1;case 13:if(b=er(b),b!==null){var O=Ps!==null?{id:ui,overflow:_o}:null;return y.memoizedState={dehydrated:b,treeContext:O,retryLane:1073741824},O=$i(18,null,null,0),O.stateNode=b,O.return=y,y.child=O,sa=y,Ba=null,!0}return!1;default:return!1}}function up(y){return(y.mode&1)!==0&&(y.flags&128)===0}function dp(y){if(Rn){var b=Ba;if(b){var O=b;if(!U0(y,b)){if(up(y))throw Error(i(418));b=be(O);var z=sa;b&&U0(y,b)?h1(z,O):(y.flags=y.flags&-4097|2,Rn=!1,sa=y)}}else{if(up(y))throw Error(i(418));y.flags=y.flags&-4097|2,Rn=!1,sa=y}}}function g1(y){for(y=y.return;y!==null&&y.tag!==5&&y.tag!==3&&y.tag!==13;)y=y.return;sa=y}function z0(y){if(!ge||y!==sa)return!1;if(!Rn)return g1(y),Rn=!0,!1;if(y.tag!==3&&(y.tag!==5||Xe(y.type)&&!J(y.type,y.memoizedProps))){var b=Ba;if(b){if(up(y))throw m1(),Error(i(418));for(;b;)h1(y,b),b=be(b)}}if(g1(y),y.tag===13){if(!ge)throw Error(i(316));if(y=y.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(i(317));Ba=Ye(y)}else Ba=sa?be(y.stateNode):null;return!0}function m1(){for(var y=Ba;y;)y=be(y)}function ru(){ge&&(Ba=sa=null,Vf=Rn=!1)}function fp(y){ko===null?ko=[y]:ko.push(y)}var W2=o.ReactCurrentBatchConfig;function W0(y,b){if(bo(y,b))return!0;if(typeof y!="object"||y===null||typeof b!="object"||b===null)return!1;var O=Object.keys(y),z=Object.keys(b);if(O.length!==z.length)return!1;for(z=0;z<O.length;z++){var K=O[z];if(!wr.call(b,K)||!bo(y[K],b[K]))return!1}return!0}function H2(y){switch(y.tag){case 5:return Ct(y.type);case 16:return Ct("Lazy");case 13:return Ct("Suspense");case 19:return Ct("SuspenseList");case 0:case 2:case 15:return y=yr(y.type,!1),y;case 11:return y=yr(y.type.render,!1),y;case 1:return y=yr(y.type,!0),y;default:return""}}function nu(y,b,O){if(y=O.ref,y!==null&&typeof y!="function"&&typeof y!="object"){if(O._owner){if(O=O._owner,O){if(O.tag!==1)throw Error(i(309));var z=O.stateNode}if(!z)throw Error(i(147,y));var K=z,te=""+y;return b!==null&&b.ref!==null&&typeof b.ref=="function"&&b.ref._stringRef===te?b.ref:(b=function(ve){var Ge=K.refs;ve===null?delete Ge[te]:Ge[te]=ve},b._stringRef=te,b)}if(typeof y!="string")throw Error(i(284));if(!O._owner)throw Error(i(290,y))}return y}function H0(y,b){throw y=Object.prototype.toString.call(b),Error(i(31,y==="[object Object]"?"object with keys {"+Object.keys(b).join(", ")+"}":y))}function p1(y){var b=y._init;return b(y._payload)}function x1(y){function b(dt,qe){if(y){var yt=dt.deletions;yt===null?(dt.deletions=[qe],dt.flags|=16):yt.push(qe)}}function O(dt,qe){if(!y)return null;for(;qe!==null;)b(dt,qe),qe=qe.sibling;return null}function z(dt,qe){for(dt=new Map;qe!==null;)qe.key!==null?dt.set(qe.key,qe):dt.set(qe.index,qe),qe=qe.sibling;return dt}function K(dt,qe){return dt=Pc(dt,qe),dt.index=0,dt.sibling=null,dt}function te(dt,qe,yt){return dt.index=yt,y?(yt=dt.alternate,yt!==null?(yt=yt.index,yt<qe?(dt.flags|=2,qe):yt):(dt.flags|=2,qe)):(dt.flags|=1048576,qe)}function ve(dt){return y&&dt.alternate===null&&(dt.flags|=2),dt}function Ge(dt,qe,yt,rr){return qe===null||qe.tag!==6?(qe=Wd(yt,dt.mode,rr),qe.return=dt,qe):(qe=K(qe,yt),qe.return=dt,qe)}function mt(dt,qe,yt,rr){var _r=yt.type;return _r===d?lr(dt,qe,yt.props.children,rr,yt.key):qe!==null&&(qe.elementType===_r||typeof _r=="object"&&_r!==null&&_r.$$typeof===_&&p1(_r)===qe.type)?(rr=K(qe,yt.props),rr.ref=nu(dt,qe,yt),rr.return=dt,rr):(rr=_g(yt.type,yt.key,yt.props,null,dt.mode,rr),rr.ref=nu(dt,qe,yt),rr.return=dt,rr)}function Wt(dt,qe,yt,rr){return qe===null||qe.tag!==4||qe.stateNode.containerInfo!==yt.containerInfo||qe.stateNode.implementation!==yt.implementation?(qe=Sg(yt,dt.mode,rr),qe.return=dt,qe):(qe=K(qe,yt.children||[]),qe.return=dt,qe)}function lr(dt,qe,yt,rr,_r){return qe===null||qe.tag!==7?(qe=oa(yt,dt.mode,rr,_r),qe.return=dt,qe):(qe=K(qe,yt),qe.return=dt,qe)}function Mr(dt,qe,yt){if(typeof qe=="string"&&qe!==""||typeof qe=="number")return qe=Wd(""+qe,dt.mode,yt),qe.return=dt,qe;if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case l:return yt=_g(qe.type,qe.key,qe.props,null,dt.mode,yt),yt.ref=nu(dt,null,qe),yt.return=dt,yt;case u:return qe=Sg(qe,dt.mode,yt),qe.return=dt,qe;case _:var rr=qe._init;return Mr(dt,rr(qe._payload),yt)}if(ee(qe)||P(qe))return qe=oa(qe,dt.mode,yt,null),qe.return=dt,qe;H0(dt,qe)}return null}function tr(dt,qe,yt,rr){var _r=qe!==null?qe.key:null;if(typeof yt=="string"&&yt!==""||typeof yt=="number")return _r!==null?null:Ge(dt,qe,""+yt,rr);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case l:return yt.key===_r?mt(dt,qe,yt,rr):null;case u:return yt.key===_r?Wt(dt,qe,yt,rr):null;case _:return _r=yt._init,tr(dt,qe,_r(yt._payload),rr)}if(ee(yt)||P(yt))return _r!==null?null:lr(dt,qe,yt,rr,null);H0(dt,yt)}return null}function On(dt,qe,yt,rr,_r){if(typeof rr=="string"&&rr!==""||typeof rr=="number")return dt=dt.get(yt)||null,Ge(qe,dt,""+rr,_r);if(typeof rr=="object"&&rr!==null){switch(rr.$$typeof){case l:return dt=dt.get(rr.key===null?yt:rr.key)||null,mt(qe,dt,rr,_r);case u:return dt=dt.get(rr.key===null?yt:rr.key)||null,Wt(qe,dt,rr,_r);case _:var Gr=rr._init;return On(dt,qe,yt,Gr(rr._payload),_r)}if(ee(rr)||P(rr))return dt=dt.get(yt)||null,lr(qe,dt,rr,_r,null);H0(qe,rr)}return null}function xn(dt,qe,yt,rr){for(var _r=null,Gr=null,Lr=qe,nn=qe=0,Is=null;Lr!==null&&nn<yt.length;nn++){Lr.index>nn?(Is=Lr,Lr=null):Is=Lr.sibling;var tn=tr(dt,Lr,yt[nn],rr);if(tn===null){Lr===null&&(Lr=Is);break}y&&Lr&&tn.alternate===null&&b(dt,Lr),qe=te(tn,qe,nn),Gr===null?_r=tn:Gr.sibling=tn,Gr=tn,Lr=Is}if(nn===yt.length)return O(dt,Lr),Rn&&So(dt,nn),_r;if(Lr===null){for(;nn<yt.length;nn++)Lr=Mr(dt,yt[nn],rr),Lr!==null&&(qe=te(Lr,qe,nn),Gr===null?_r=Lr:Gr.sibling=Lr,Gr=Lr);return Rn&&So(dt,nn),_r}for(Lr=z(dt,Lr);nn<yt.length;nn++)Is=On(Lr,dt,nn,yt[nn],rr),Is!==null&&(y&&Is.alternate!==null&&Lr.delete(Is.key===null?nn:Is.key),qe=te(Is,qe,nn),Gr===null?_r=Is:Gr.sibling=Is,Gr=Is);return y&&Lr.forEach(function(Sa){return b(dt,Sa)}),Rn&&So(dt,nn),_r}function Ga(dt,qe,yt,rr){var _r=P(yt);if(typeof _r!="function")throw Error(i(150));if(yt=_r.call(yt),yt==null)throw Error(i(151));for(var Gr=_r=null,Lr=qe,nn=qe=0,Is=null,tn=yt.next();Lr!==null&&!tn.done;nn++,tn=yt.next()){Lr.index>nn?(Is=Lr,Lr=null):Is=Lr.sibling;var Sa=tr(dt,Lr,tn.value,rr);if(Sa===null){Lr===null&&(Lr=Is);break}y&&Lr&&Sa.alternate===null&&b(dt,Lr),qe=te(Sa,qe,nn),Gr===null?_r=Sa:Gr.sibling=Sa,Gr=Sa,Lr=Is}if(tn.done)return O(dt,Lr),Rn&&So(dt,nn),_r;if(Lr===null){for(;!tn.done;nn++,tn=yt.next())tn=Mr(dt,tn.value,rr),tn!==null&&(qe=te(tn,qe,nn),Gr===null?_r=tn:Gr.sibling=tn,Gr=tn);return Rn&&So(dt,nn),_r}for(Lr=z(dt,Lr);!tn.done;nn++,tn=yt.next())tn=On(Lr,dt,nn,tn.value,rr),tn!==null&&(y&&tn.alternate!==null&&Lr.delete(tn.key===null?nn:tn.key),qe=te(tn,qe,nn),Gr===null?_r=tn:Gr.sibling=tn,Gr=tn);return y&&Lr.forEach(function(Y2){return b(dt,Y2)}),Rn&&So(dt,nn),_r}function rl(dt,qe,yt,rr){if(typeof yt=="object"&&yt!==null&&yt.type===d&&yt.key===null&&(yt=yt.props.children),typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case l:e:{for(var _r=yt.key,Gr=qe;Gr!==null;){if(Gr.key===_r){if(_r=yt.type,_r===d){if(Gr.tag===7){O(dt,Gr.sibling),qe=K(Gr,yt.props.children),qe.return=dt,dt=qe;break e}}else if(Gr.elementType===_r||typeof _r=="object"&&_r!==null&&_r.$$typeof===_&&p1(_r)===Gr.type){O(dt,Gr.sibling),qe=K(Gr,yt.props),qe.ref=nu(dt,Gr,yt),qe.return=dt,dt=qe;break e}O(dt,Gr);break}else b(dt,Gr);Gr=Gr.sibling}yt.type===d?(qe=oa(yt.props.children,dt.mode,rr,yt.key),qe.return=dt,dt=qe):(rr=_g(yt.type,yt.key,yt.props,null,dt.mode,rr),rr.ref=nu(dt,qe,yt),rr.return=dt,dt=rr)}return ve(dt);case u:e:{for(Gr=yt.key;qe!==null;){if(qe.key===Gr)if(qe.tag===4&&qe.stateNode.containerInfo===yt.containerInfo&&qe.stateNode.implementation===yt.implementation){O(dt,qe.sibling),qe=K(qe,yt.children||[]),qe.return=dt,dt=qe;break e}else{O(dt,qe);break}else b(dt,qe);qe=qe.sibling}qe=Sg(yt,dt.mode,rr),qe.return=dt,dt=qe}return ve(dt);case _:return Gr=yt._init,rl(dt,qe,Gr(yt._payload),rr)}if(ee(yt))return xn(dt,qe,yt,rr);if(P(yt))return Ga(dt,qe,yt,rr);H0(dt,yt)}return typeof yt=="string"&&yt!==""||typeof yt=="number"?(yt=""+yt,qe!==null&&qe.tag===6?(O(dt,qe.sibling),qe=K(qe,yt),qe.return=dt,dt=qe):(O(dt,qe),qe=Wd(yt,dt.mode,rr),qe.return=dt,dt=qe),ve(dt)):O(dt,qe)}return rl}var su=x1(!0),y1=x1(!1),G0=qr(null),V0=null,vd=null,hp=null;function gp(){hp=vd=V0=null}function v1(y,b,O){ce?(he(G0,b._currentValue),b._currentValue=O):(he(G0,b._currentValue2),b._currentValue2=O)}function Kf(y){var b=G0.current;Hr(G0),ce?y._currentValue=b:y._currentValue2=b}function au(y,b,O){for(;y!==null;){var z=y.alternate;if((y.childLanes&b)!==b?(y.childLanes|=b,z!==null&&(z.childLanes|=b)):z!==null&&(z.childLanes&b)!==b&&(z.childLanes|=b),y===O)break;y=y.return}}function wd(y,b){V0=y,hp=vd=null,y=y.dependencies,y!==null&&y.firstContext!==null&&((y.lanes&b)!==0&&(Os=!0),y.firstContext=null)}function Pi(y){var b=ce?y._currentValue:y._currentValue2;if(hp!==y)if(y={context:y,memoizedValue:b,next:null},vd===null){if(V0===null)throw Error(i(308));vd=y,V0.dependencies={lanes:0,firstContext:y}}else vd=vd.next=y;return b}var gc=null;function K0(y){gc===null?gc=[y]:gc.push(y)}function mp(y,b,O,z){var K=b.interleaved;return K===null?(O.next=O,K0(b)):(O.next=K.next,K.next=O),b.interleaved=O,Co(y,z)}function Co(y,b){y.lanes|=b;var O=y.alternate;for(O!==null&&(O.lanes|=b),O=y,y=y.return;y!==null;)y.childLanes|=b,O=y.alternate,O!==null&&(O.childLanes|=b),O=y,y=y.return;return O.tag===3?O.stateNode:null}var Fi=!1;function pp(y){y.updateQueue={baseState:y.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function w1(y,b){y=y.updateQueue,b.updateQueue===y&&(b.updateQueue={baseState:y.baseState,firstBaseUpdate:y.firstBaseUpdate,lastBaseUpdate:y.lastBaseUpdate,shared:y.shared,effects:y.effects})}function Rl(y,b){return{eventTime:y,lane:b,tag:0,payload:null,callback:null,next:null}}function Il(y,b,O){var z=y.updateQueue;if(z===null)return null;if(z=z.shared,(Br&2)!==0){var K=z.pending;return K===null?b.next=b:(b.next=K.next,K.next=b),z.pending=b,Co(y,O)}return K=z.interleaved,K===null?(b.next=b,K0(z)):(b.next=K.next,K.next=b),z.interleaved=b,Co(y,O)}function qf(y,b,O){if(b=b.updateQueue,b!==null&&(b=b.shared,(O&4194240)!==0)){var z=b.lanes;z&=y.pendingLanes,O|=z,b.lanes=O,Vo(y,O)}}function bd(y,b){var O=y.updateQueue,z=y.alternate;if(z!==null&&(z=z.updateQueue,O===z)){var K=null,te=null;if(O=O.firstBaseUpdate,O!==null){do{var ve={eventTime:O.eventTime,lane:O.lane,tag:O.tag,payload:O.payload,callback:O.callback,next:null};te===null?K=te=ve:te=te.next=ve,O=O.next}while(O!==null);te===null?K=te=b:te=te.next=b}else K=te=b;O={baseState:z.baseState,firstBaseUpdate:K,lastBaseUpdate:te,shared:z.shared,effects:z.effects},y.updateQueue=O;return}y=O.lastBaseUpdate,y===null?O.firstBaseUpdate=b:y.next=b,O.lastBaseUpdate=b}function mc(y,b,O,z){var K=y.updateQueue;Fi=!1;var te=K.firstBaseUpdate,ve=K.lastBaseUpdate,Ge=K.shared.pending;if(Ge!==null){K.shared.pending=null;var mt=Ge,Wt=mt.next;mt.next=null,ve===null?te=Wt:ve.next=Wt,ve=mt;var lr=y.alternate;lr!==null&&(lr=lr.updateQueue,Ge=lr.lastBaseUpdate,Ge!==ve&&(Ge===null?lr.firstBaseUpdate=Wt:Ge.next=Wt,lr.lastBaseUpdate=mt))}if(te!==null){var Mr=K.baseState;ve=0,lr=Wt=mt=null,Ge=te;do{var tr=Ge.lane,On=Ge.eventTime;if((z&tr)===tr){lr!==null&&(lr=lr.next={eventTime:On,lane:0,tag:Ge.tag,payload:Ge.payload,callback:Ge.callback,next:null});e:{var xn=y,Ga=Ge;switch(tr=b,On=O,Ga.tag){case 1:if(xn=Ga.payload,typeof xn=="function"){Mr=xn.call(On,Mr,tr);break e}Mr=xn;break e;case 3:xn.flags=xn.flags&-65537|128;case 0:if(xn=Ga.payload,tr=typeof xn=="function"?xn.call(On,Mr,tr):xn,tr==null)break e;Mr=a({},Mr,tr);break e;case 2:Fi=!0}}Ge.callback!==null&&Ge.lane!==0&&(y.flags|=64,tr=K.effects,tr===null?K.effects=[Ge]:tr.push(Ge))}else On={eventTime:On,lane:tr,tag:Ge.tag,payload:Ge.payload,callback:Ge.callback,next:null},lr===null?(Wt=lr=On,mt=Mr):lr=lr.next=On,ve|=tr;if(Ge=Ge.next,Ge===null){if(Ge=K.shared.pending,Ge===null)break;tr=Ge,Ge=tr.next,tr.next=null,K.lastBaseUpdate=tr,K.shared.pending=null}}while(!0);if(lr===null&&(mt=Mr),K.baseState=mt,K.firstBaseUpdate=Wt,K.lastBaseUpdate=lr,b=K.shared.interleaved,b!==null){K=b;do ve|=K.lane,K=K.next;while(K!==b)}else te===null&&(K.shared.lanes=0);Ul|=ve,y.lanes=ve,y.memoizedState=Mr}}function b1(y,b,O){if(y=b.effects,b.effects=null,y!==null)for(b=0;b<y.length;b++){var z=y[b],K=z.callback;if(K!==null){if(z.callback=null,z=O,typeof K!="function")throw Error(i(191,K));K.call(z)}}}var pc={},eo=qr(pc),_d=qr(pc),xc=qr(pc);function to(y){if(y===pc)throw Error(i(174));return y}function q0(y,b){he(xc,b),he(_d,y),he(eo,pc),y=L(b),Hr(eo),he(eo,y)}function iu(){Hr(eo),Hr(_d),Hr(xc)}function xp(y){var b=to(xc.current),O=to(eo.current);b=H(O,y.type,b),O!==b&&(he(_d,y),he(eo,b))}function yp(y){_d.current===y&&(Hr(eo),Hr(_d))}var Hn=qr(0);function Y0(y){for(var b=y;b!==null;){if(b.tag===13){var O=b.memoizedState;if(O!==null&&(O=O.dehydrated,O===null||hr(O)||ir(O)))return b}else if(b.tag===19&&b.memoizedProps.revealOrder!==void 0){if((b.flags&128)!==0)return b}else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===y)break;for(;b.sibling===null;){if(b.return===null||b.return===y)return null;b=b.return}b.sibling.return=b.return,b=b.sibling}return null}var vp=[];function wp(){for(var y=0;y<vp.length;y++){var b=vp[y];ce?b._workInProgressVersionPrimary=null:b._workInProgressVersionSecondary=null}vp.length=0}var di=o.ReactCurrentDispatcher,ou=o.ReactCurrentBatchConfig,yc=0,$n=null,ms=null,Fs=null,Sd=!1,Yf=!1,Xf=0,kd=0;function Gs(){throw Error(i(321))}function lu(y,b){if(b===null)return!1;for(var O=0;O<b.length&&O<y.length;O++)if(!bo(y[O],b[O]))return!1;return!0}function Jf(y,b,O,z,K,te){if(yc=te,$n=b,b.memoizedState=null,b.updateQueue=null,b.lanes=0,di.current=y===null||y.memoizedState===null?jp:Pp,y=O(z,K),Yf){te=0;do{if(Yf=!1,Xf=0,25<=te)throw Error(i(301));te+=1,Fs=ms=null,b.updateQueue=null,di.current=Fp,y=O(z,K)}while(Yf)}if(di.current=hu,b=ms!==null&&ms.next!==null,yc=0,Fs=ms=$n=null,Sd=!1,b)throw Error(i(300));return y}function X0(){var y=Xf!==0;return Xf=0,y}function Oi(){var y={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fs===null?$n.memoizedState=Fs=y:Fs=Fs.next=y,Fs}function aa(){if(ms===null){var y=$n.alternate;y=y!==null?y.memoizedState:null}else y=ms.next;var b=Fs===null?$n.memoizedState:Fs.next;if(b!==null)Fs=b,ms=y;else{if(y===null)throw Error(i(310));ms=y,y={memoizedState:ms.memoizedState,baseState:ms.baseState,baseQueue:ms.baseQueue,queue:ms.queue,next:null},Fs===null?$n.memoizedState=Fs=y:Fs=Fs.next=y}return Fs}function cu(y,b){return typeof b=="function"?b(y):b}function J0(y){var b=aa(),O=b.queue;if(O===null)throw Error(i(311));O.lastRenderedReducer=y;var z=ms,K=z.baseQueue,te=O.pending;if(te!==null){if(K!==null){var ve=K.next;K.next=te.next,te.next=ve}z.baseQueue=K=te,O.pending=null}if(K!==null){te=K.next,z=z.baseState;var Ge=ve=null,mt=null,Wt=te;do{var lr=Wt.lane;if((yc&lr)===lr)mt!==null&&(mt=mt.next={lane:0,action:Wt.action,hasEagerState:Wt.hasEagerState,eagerState:Wt.eagerState,next:null}),z=Wt.hasEagerState?Wt.eagerState:y(z,Wt.action);else{var Mr={lane:lr,action:Wt.action,hasEagerState:Wt.hasEagerState,eagerState:Wt.eagerState,next:null};mt===null?(Ge=mt=Mr,ve=z):mt=mt.next=Mr,$n.lanes|=lr,Ul|=lr}Wt=Wt.next}while(Wt!==null&&Wt!==te);mt===null?ve=z:mt.next=Ge,bo(z,b.memoizedState)||(Os=!0),b.memoizedState=z,b.baseState=ve,b.baseQueue=mt,O.lastRenderedState=z}if(y=O.interleaved,y!==null){K=y;do te=K.lane,$n.lanes|=te,Ul|=te,K=K.next;while(K!==y)}else K===null&&(O.lanes=0);return[b.memoizedState,O.dispatch]}function Cd(y){var b=aa(),O=b.queue;if(O===null)throw Error(i(311));O.lastRenderedReducer=y;var z=O.dispatch,K=O.pending,te=b.memoizedState;if(K!==null){O.pending=null;var ve=K=K.next;do te=y(te,ve.action),ve=ve.next;while(ve!==K);bo(te,b.memoizedState)||(Os=!0),b.memoizedState=te,b.baseQueue===null&&(b.baseState=te),O.lastRenderedState=te}return[te,z]}function bp(){}function _p(y,b){var O=$n,z=aa(),K=b(),te=!bo(z.memoizedState,K);if(te&&(z.memoizedState=K,Os=!0),z=z.queue,eg(Cp.bind(null,O,z,y),[y]),z.getSnapshot!==b||te||Fs!==null&&Fs.memoizedState.tag&1){if(O.flags|=2048,uu(9,kp.bind(null,O,z,K,b),void 0,null),_n===null)throw Error(i(349));(yc&30)!==0||Sp(O,b,K)}return K}function Sp(y,b,O){y.flags|=16384,y={getSnapshot:b,value:O},b=$n.updateQueue,b===null?(b={lastEffect:null,stores:null},$n.updateQueue=b,b.stores=[y]):(O=b.stores,O===null?b.stores=[y]:O.push(y))}function kp(y,b,O,z){b.value=O,b.getSnapshot=z,Tp(b)&&Ml(y)}function Cp(y,b,O){return O(function(){Tp(b)&&Ml(y)})}function Tp(y){var b=y.getSnapshot;y=y.value;try{var O=b();return!bo(y,O)}catch{return!0}}function Ml(y){var b=Co(y,1);b!==null&&ba(b,y,1,-1)}function Q0(y){var b=Oi();return typeof y=="function"&&(y=y()),b.memoizedState=b.baseState=y,y={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cu,lastRenderedState:y},b.queue=y,y=y.dispatch=G2.bind(null,$n,y),[b.memoizedState,y]}function uu(y,b,O,z){return y={tag:y,create:b,destroy:O,deps:z,next:null},b=$n.updateQueue,b===null?(b={lastEffect:null,stores:null},$n.updateQueue=b,b.lastEffect=y.next=y):(O=b.lastEffect,O===null?b.lastEffect=y.next=y:(z=O.next,O.next=y,y.next=z,b.lastEffect=y)),y}function _1(){return aa().memoizedState}function Z0(y,b,O,z){var K=Oi();$n.flags|=y,K.memoizedState=uu(1|b,O,void 0,z===void 0?null:z)}function vc(y,b,O,z){var K=aa();z=z===void 0?null:z;var te=void 0;if(ms!==null){var ve=ms.memoizedState;if(te=ve.destroy,z!==null&&lu(z,ve.deps)){K.memoizedState=uu(b,O,te,z);return}}$n.flags|=y,K.memoizedState=uu(1|b,O,te,z)}function S1(y,b){return Z0(8390656,8,y,b)}function eg(y,b){return vc(2048,8,y,b)}function Ep(y,b){return vc(4,2,y,b)}function jn(y,b){return vc(4,4,y,b)}function tg(y,b){if(typeof b=="function")return y=y(),b(y),function(){b(null)};if(b!=null)return y=y(),b.current=y,function(){b.current=null}}function Qf(y,b,O){return O=O!=null?O.concat([y]):null,vc(4,4,tg.bind(null,b,y),O)}function du(){}function Np(y,b){var O=aa();b=b===void 0?null:b;var z=O.memoizedState;return z!==null&&b!==null&&lu(b,z[1])?z[0]:(O.memoizedState=[y,b],y)}function rg(y,b){var O=aa();b=b===void 0?null:b;var z=O.memoizedState;return z!==null&&b!==null&&lu(b,z[1])?z[0]:(y=y(),O.memoizedState=[y,b],y)}function Td(y,b,O){return(yc&21)===0?(y.baseState&&(y.baseState=!1,Os=!0),y.memoizedState=O):(bo(O,b)||(O=cc(),$n.lanes|=O,Ul|=O,y.baseState=!0),b)}function ng(y,b){var O=Qr;Qr=O!==0&&4>O?O:4,y(!0);var z=ou.transition;ou.transition={};try{y(!1),b()}finally{Qr=O,ou.transition=z}}function fu(){return aa().memoizedState}function k1(y,b,O){var z=Rs(y);if(O={lane:z,action:O,hasEagerState:!1,eagerState:null,next:null},C1(y))Ap(b,O);else if(O=mp(y,b,O,z),O!==null){var K=In();ba(O,y,z,K),Zf(O,b,z)}}function G2(y,b,O){var z=Rs(y),K={lane:z,action:O,hasEagerState:!1,eagerState:null,next:null};if(C1(y))Ap(b,K);else{var te=y.alternate;if(y.lanes===0&&(te===null||te.lanes===0)&&(te=b.lastRenderedReducer,te!==null))try{var ve=b.lastRenderedState,Ge=te(ve,O);if(K.hasEagerState=!0,K.eagerState=Ge,bo(Ge,ve)){var mt=b.interleaved;mt===null?(K.next=K,K0(b)):(K.next=mt.next,mt.next=K),b.interleaved=K;return}}catch{}finally{}O=mp(y,b,K,z),O!==null&&(K=In(),ba(O,y,z,K),Zf(O,b,z))}}function C1(y){var b=y.alternate;return y===$n||b!==null&&b===$n}function Ap(y,b){Yf=Sd=!0;var O=y.pending;O===null?b.next=b:(b.next=O.next,O.next=b),y.pending=b}function Zf(y,b,O){if((O&4194240)!==0){var z=b.lanes;z&=y.pendingLanes,O|=z,b.lanes=O,Vo(y,O)}}var hu={readContext:Pi,useCallback:Gs,useContext:Gs,useEffect:Gs,useImperativeHandle:Gs,useInsertionEffect:Gs,useLayoutEffect:Gs,useMemo:Gs,useReducer:Gs,useRef:Gs,useState:Gs,useDebugValue:Gs,useDeferredValue:Gs,useTransition:Gs,useMutableSource:Gs,useSyncExternalStore:Gs,useId:Gs,unstable_isNewReconciler:!1},jp={readContext:Pi,useCallback:function(y,b){return Oi().memoizedState=[y,b===void 0?null:b],y},useContext:Pi,useEffect:S1,useImperativeHandle:function(y,b,O){return O=O!=null?O.concat([y]):null,Z0(4194308,4,tg.bind(null,b,y),O)},useLayoutEffect:function(y,b){return Z0(4194308,4,y,b)},useInsertionEffect:function(y,b){return Z0(4,2,y,b)},useMemo:function(y,b){var O=Oi();return b=b===void 0?null:b,y=y(),O.memoizedState=[y,b],y},useReducer:function(y,b,O){var z=Oi();return b=O!==void 0?O(b):b,z.memoizedState=z.baseState=b,y={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:y,lastRenderedState:b},z.queue=y,y=y.dispatch=k1.bind(null,$n,y),[z.memoizedState,y]},useRef:function(y){var b=Oi();return y={current:y},b.memoizedState=y},useState:Q0,useDebugValue:du,useDeferredValue:function(y){return Oi().memoizedState=y},useTransition:function(){var y=Q0(!1),b=y[0];return y=ng.bind(null,y[1]),Oi().memoizedState=y,[b,y]},useMutableSource:function(){},useSyncExternalStore:function(y,b,O){var z=$n,K=Oi();if(Rn){if(O===void 0)throw Error(i(407));O=O()}else{if(O=b(),_n===null)throw Error(i(349));(yc&30)!==0||Sp(z,b,O)}K.memoizedState=O;var te={value:O,getSnapshot:b};return K.queue=te,S1(Cp.bind(null,z,te,y),[y]),z.flags|=2048,uu(9,kp.bind(null,z,te,O,b),void 0,null),O},useId:function(){var y=Oi(),b=_n.identifierPrefix;if(Rn){var O=_o,z=ui;O=(z&~(1<<32-mr(z)-1)).toString(32)+O,b=":"+b+"R"+O,O=Xf++,0<O&&(b+="H"+O.toString(32)),b+=":"}else O=kd++,b=":"+b+"r"+O.toString(32)+":";return y.memoizedState=b},unstable_isNewReconciler:!1},Pp={readContext:Pi,useCallback:Np,useContext:Pi,useEffect:eg,useImperativeHandle:Qf,useInsertionEffect:Ep,useLayoutEffect:jn,useMemo:rg,useReducer:J0,useRef:_1,useState:function(){return J0(cu)},useDebugValue:du,useDeferredValue:function(y){var b=aa();return Td(b,ms.memoizedState,y)},useTransition:function(){var y=J0(cu)[0],b=aa().memoizedState;return[y,b]},useMutableSource:bp,useSyncExternalStore:_p,useId:fu,unstable_isNewReconciler:!1},Fp={readContext:Pi,useCallback:Np,useContext:Pi,useEffect:eg,useImperativeHandle:Qf,useInsertionEffect:Ep,useLayoutEffect:jn,useMemo:rg,useReducer:Cd,useRef:_1,useState:function(){return Cd(cu)},useDebugValue:du,useDeferredValue:function(y){var b=aa();return ms===null?b.memoizedState=y:Td(b,ms.memoizedState,y)},useTransition:function(){var y=Cd(cu)[0],b=aa().memoizedState;return[y,b]},useMutableSource:bp,useSyncExternalStore:_p,useId:fu,unstable_isNewReconciler:!1};function Di(y,b){if(y&&y.defaultProps){b=a({},b),y=y.defaultProps;for(var O in y)b[O]===void 0&&(b[O]=y[O]);return b}return b}function Op(y,b,O,z){b=y.memoizedState,O=O(z,b),O=O==null?b:a({},b,O),y.memoizedState=O,y.lanes===0&&(y.updateQueue.baseState=O)}var eh={isMounted:function(y){return(y=y._reactInternals)?j(y)===y:!1},enqueueSetState:function(y,b,O){y=y._reactInternals;var z=In(),K=Rs(y),te=Rl(z,K);te.payload=b,O!=null&&(te.callback=O),b=Il(y,te,K),b!==null&&(ba(b,y,K,z),qf(b,y,K))},enqueueReplaceState:function(y,b,O){y=y._reactInternals;var z=In(),K=Rs(y),te=Rl(z,K);te.tag=1,te.payload=b,O!=null&&(te.callback=O),b=Il(y,te,K),b!==null&&(ba(b,y,K,z),qf(b,y,K))},enqueueForceUpdate:function(y,b){y=y._reactInternals;var O=In(),z=Rs(y),K=Rl(O,z);K.tag=2,b!=null&&(K.callback=b),b=Il(y,K,z),b!==null&&(ba(b,y,z,O),qf(b,y,z))}};function T1(y,b,O,z,K,te,ve){return y=y.stateNode,typeof y.shouldComponentUpdate=="function"?y.shouldComponentUpdate(z,te,ve):b.prototype&&b.prototype.isPureReactComponent?!W0(O,z)||!W0(K,te):!0}function E1(y,b,O){var z=!1,K=vt,te=b.contextType;return typeof te=="object"&&te!==null?te=Pi(te):(K=et(b)?Bn:xr.current,z=b.contextTypes,te=(z=z!=null)?An(y,K):vt),b=new b(O,te),y.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=eh,y.stateNode=b,b._reactInternals=y,z&&(y=y.stateNode,y.__reactInternalMemoizedUnmaskedChildContext=K,y.__reactInternalMemoizedMaskedChildContext=te),b}function sg(y,b,O,z){y=b.state,typeof b.componentWillReceiveProps=="function"&&b.componentWillReceiveProps(O,z),typeof b.UNSAFE_componentWillReceiveProps=="function"&&b.UNSAFE_componentWillReceiveProps(O,z),b.state!==y&&eh.enqueueReplaceState(b,b.state,null)}function qo(y,b,O,z){var K=y.stateNode;K.props=O,K.state=y.memoizedState,K.refs={},pp(y);var te=b.contextType;typeof te=="object"&&te!==null?K.context=Pi(te):(te=et(b)?Bn:xr.current,K.context=An(y,te)),K.state=y.memoizedState,te=b.getDerivedStateFromProps,typeof te=="function"&&(Op(y,b,te,O),K.state=y.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof K.getSnapshotBeforeUpdate=="function"||typeof K.UNSAFE_componentWillMount!="function"&&typeof K.componentWillMount!="function"||(b=K.state,typeof K.componentWillMount=="function"&&K.componentWillMount(),typeof K.UNSAFE_componentWillMount=="function"&&K.UNSAFE_componentWillMount(),b!==K.state&&eh.enqueueReplaceState(K,K.state,null),mc(y,O,K,z),K.state=y.memoizedState),typeof K.componentDidMount=="function"&&(y.flags|=4194308)}function gu(y,b){try{var O="",z=b;do O+=H2(z),z=z.return;while(z);var K=O}catch(te){K=`
Error generating stack: `+te.message+`
`+te.stack}return{value:y,source:b,stack:K,digest:null}}function wc(y,b,O){return{value:y,source:null,stack:O??null,digest:b??null}}function ro(y,b){try{console.error(b.value)}catch(O){setTimeout(function(){throw O})}}var th=typeof WeakMap=="function"?WeakMap:Map;function Yo(y,b,O){O=Rl(-1,O),O.tag=3,O.payload={element:null};var z=b.value;return O.callback=function(){rs||(rs=!0,ps=z),ro(y,b)},O}function ag(y,b,O){O=Rl(-1,O),O.tag=3;var z=y.type.getDerivedStateFromError;if(typeof z=="function"){var K=b.value;O.payload=function(){return z(K)},O.callback=function(){ro(y,b)}}var te=y.stateNode;return te!==null&&typeof te.componentDidCatch=="function"&&(O.callback=function(){ro(y,b),typeof z!="function"&&(Eo===null?Eo=new Set([this]):Eo.add(this));var ve=b.stack;this.componentDidCatch(b.value,{componentStack:ve!==null?ve:""})}),O}function N1(y,b,O){var z=y.pingCache;if(z===null){z=y.pingCache=new th;var K=new Set;z.set(b,K)}else K=z.get(b),K===void 0&&(K=new Set,z.set(b,K));K.has(O)||(K.add(O),y=I1.bind(null,y,b,O),b.then(y,y))}function A1(y){do{var b;if((b=y.tag===13)&&(b=y.memoizedState,b=b!==null?b.dehydrated!==null:!0),b)return y;y=y.return}while(y!==null);return null}function bc(y,b,O,z,K){return(y.mode&1)===0?(y===b?y.flags|=65536:(y.flags|=128,O.flags|=131072,O.flags&=-52805,O.tag===1&&(O.alternate===null?O.tag=17:(b=Rl(-1,1),b.tag=2,Il(O,b,1))),O.lanes|=1),y):(y.flags|=65536,y.lanes=K,y)}var rh=o.ReactCurrentOwner,Os=!1;function Vs(y,b,O,z){b.child=y===null?y1(b,null,O,z):su(b,y.child,O,z)}function ig(y,b,O,z,K){O=O.render;var te=b.ref;return wd(b,K),z=Jf(y,b,O,z,te,K),O=X0(),y!==null&&!Os?(b.updateQueue=y.updateQueue,b.flags&=-2053,y.lanes&=~K,Bl(y,b,K)):(Rn&&O&&Hf(b),b.flags|=1,Vs(y,b,z,K),b.child)}function mu(y,b,O,z,K){if(y===null){var te=O.type;return typeof te=="function"&&!Ud(te)&&te.defaultProps===void 0&&O.compare===null&&O.defaultProps===void 0?(b.tag=15,b.type=te,Ll(y,b,te,z,K)):(y=_g(O.type,null,z,b,b.mode,K),y.ref=b.ref,y.return=b,b.child=y)}if(te=y.child,(y.lanes&K)===0){var ve=te.memoizedProps;if(O=O.compare,O=O!==null?O:W0,O(ve,z)&&y.ref===b.ref)return Bl(y,b,K)}return b.flags|=1,y=Pc(te,z),y.ref=b.ref,y.return=b,b.child=y}function Ll(y,b,O,z,K){if(y!==null){var te=y.memoizedProps;if(W0(te,z)&&y.ref===b.ref)if(Os=!1,b.pendingProps=z=te,(y.lanes&K)!==0)(y.flags&131072)!==0&&(Os=!0);else return b.lanes=y.lanes,Bl(y,b,K)}return Xo(y,b,O,z,K)}function Pn(y,b,O){var z=b.pendingProps,K=z.children,te=y!==null?y.memoizedState:null;if(z.mode==="hidden")if((b.mode&1)===0)b.memoizedState={baseLanes:0,cachePool:null,transitions:null},he(Ec,Ds),Ds|=O;else{if((O&1073741824)===0)return y=te!==null?te.baseLanes|O:O,b.lanes=b.childLanes=1073741824,b.memoizedState={baseLanes:y,cachePool:null,transitions:null},b.updateQueue=null,he(Ec,Ds),Ds|=y,null;b.memoizedState={baseLanes:0,cachePool:null,transitions:null},z=te!==null?te.baseLanes:O,he(Ec,Ds),Ds|=z}else te!==null?(z=te.baseLanes|O,b.memoizedState=null):z=O,he(Ec,Ds),Ds|=z;return Vs(y,b,K,O),b.child}function bn(y,b){var O=b.ref;(y===null&&O!==null||y!==null&&y.ref!==O)&&(b.flags|=512,b.flags|=2097152)}function Xo(y,b,O,z,K){var te=et(O)?Bn:xr.current;return te=An(b,te),wd(b,K),O=Jf(y,b,O,z,te,K),z=X0(),y!==null&&!Os?(b.updateQueue=y.updateQueue,b.flags&=-2053,y.lanes&=~K,Bl(y,b,K)):(Rn&&z&&Hf(b),b.flags|=1,Vs(y,b,O,K),b.child)}function ia(y,b,O,z,K){if(et(O)){var te=!0;Et(b)}else te=!1;if(wd(b,K),b.stateNode===null)nh(y,b),E1(b,O,z),qo(b,O,z,K),z=!0;else if(y===null){var ve=b.stateNode,Ge=b.memoizedProps;ve.props=Ge;var mt=ve.context,Wt=O.contextType;typeof Wt=="object"&&Wt!==null?Wt=Pi(Wt):(Wt=et(O)?Bn:xr.current,Wt=An(b,Wt));var lr=O.getDerivedStateFromProps,Mr=typeof lr=="function"||typeof ve.getSnapshotBeforeUpdate=="function";Mr||typeof ve.UNSAFE_componentWillReceiveProps!="function"&&typeof ve.componentWillReceiveProps!="function"||(Ge!==z||mt!==Wt)&&sg(b,ve,z,Wt),Fi=!1;var tr=b.memoizedState;ve.state=tr,mc(b,z,ve,K),mt=b.memoizedState,Ge!==z||tr!==mt||br.current||Fi?(typeof lr=="function"&&(Op(b,O,lr,z),mt=b.memoizedState),(Ge=Fi||T1(b,O,Ge,z,tr,mt,Wt))?(Mr||typeof ve.UNSAFE_componentWillMount!="function"&&typeof ve.componentWillMount!="function"||(typeof ve.componentWillMount=="function"&&ve.componentWillMount(),typeof ve.UNSAFE_componentWillMount=="function"&&ve.UNSAFE_componentWillMount()),typeof ve.componentDidMount=="function"&&(b.flags|=4194308)):(typeof ve.componentDidMount=="function"&&(b.flags|=4194308),b.memoizedProps=z,b.memoizedState=mt),ve.props=z,ve.state=mt,ve.context=Wt,z=Ge):(typeof ve.componentDidMount=="function"&&(b.flags|=4194308),z=!1)}else{ve=b.stateNode,w1(y,b),Ge=b.memoizedProps,Wt=b.type===b.elementType?Ge:Di(b.type,Ge),ve.props=Wt,Mr=b.pendingProps,tr=ve.context,mt=O.contextType,typeof mt=="object"&&mt!==null?mt=Pi(mt):(mt=et(O)?Bn:xr.current,mt=An(b,mt));var On=O.getDerivedStateFromProps;(lr=typeof On=="function"||typeof ve.getSnapshotBeforeUpdate=="function")||typeof ve.UNSAFE_componentWillReceiveProps!="function"&&typeof ve.componentWillReceiveProps!="function"||(Ge!==Mr||tr!==mt)&&sg(b,ve,z,mt),Fi=!1,tr=b.memoizedState,ve.state=tr,mc(b,z,ve,K);var xn=b.memoizedState;Ge!==Mr||tr!==xn||br.current||Fi?(typeof On=="function"&&(Op(b,O,On,z),xn=b.memoizedState),(Wt=Fi||T1(b,O,Wt,z,tr,xn,mt)||!1)?(lr||typeof ve.UNSAFE_componentWillUpdate!="function"&&typeof ve.componentWillUpdate!="function"||(typeof ve.componentWillUpdate=="function"&&ve.componentWillUpdate(z,xn,mt),typeof ve.UNSAFE_componentWillUpdate=="function"&&ve.UNSAFE_componentWillUpdate(z,xn,mt)),typeof ve.componentDidUpdate=="function"&&(b.flags|=4),typeof ve.getSnapshotBeforeUpdate=="function"&&(b.flags|=1024)):(typeof ve.componentDidUpdate!="function"||Ge===y.memoizedProps&&tr===y.memoizedState||(b.flags|=4),typeof ve.getSnapshotBeforeUpdate!="function"||Ge===y.memoizedProps&&tr===y.memoizedState||(b.flags|=1024),b.memoizedProps=z,b.memoizedState=xn),ve.props=z,ve.state=xn,ve.context=mt,z=Wt):(typeof ve.componentDidUpdate!="function"||Ge===y.memoizedProps&&tr===y.memoizedState||(b.flags|=4),typeof ve.getSnapshotBeforeUpdate!="function"||Ge===y.memoizedProps&&tr===y.memoizedState||(b.flags|=1024),z=!1)}return ya(y,b,O,z,te,K)}function ya(y,b,O,z,K,te){bn(y,b);var ve=(b.flags&128)!==0;if(!z&&!ve)return K&&Nt(b,O,!1),Bl(y,b,te);z=b.stateNode,rh.current=b;var Ge=ve&&typeof O.getDerivedStateFromError!="function"?null:z.render();return b.flags|=1,y!==null&&ve?(b.child=su(b,y.child,null,te),b.child=su(b,null,Ge,te)):Vs(y,b,Ge,te),b.memoizedState=z.state,K&&Nt(b,O,!0),b.child}function _c(y){var b=y.stateNode;b.pendingContext?$e(y,b.pendingContext,b.pendingContext!==b.context):b.context&&$e(y,b.context,!1),q0(y,b.containerInfo)}function pu(y,b,O,z,K){return ru(),fp(K),b.flags|=256,Vs(y,b,O,z),b.child}var va={dehydrated:null,treeContext:null,retryLane:0};function Ed(y){return{baseLanes:y,cachePool:null,transitions:null}}function Dp(y,b,O){var z=b.pendingProps,K=Hn.current,te=!1,ve=(b.flags&128)!==0,Ge;if((Ge=ve)||(Ge=y!==null&&y.memoizedState===null?!1:(K&2)!==0),Ge?(te=!0,b.flags&=-129):(y===null||y.memoizedState!==null)&&(K|=1),he(Hn,K&1),y===null)return dp(b),y=b.memoizedState,y!==null&&(y=y.dehydrated,y!==null)?((b.mode&1)===0?b.lanes=1:ir(y)?b.lanes=8:b.lanes=1073741824,null):(ve=z.children,y=z.fallback,te?(z=b.mode,te=b.child,ve={mode:"hidden",children:ve},(z&1)===0&&te!==null?(te.childLanes=0,te.pendingProps=ve):te=zd(ve,z,0,null),y=oa(y,z,O,null),te.return=b,y.return=b,te.sibling=y,b.child=te,b.child.memoizedState=Ed(O),b.memoizedState=va,y):og(b,ve));if(K=y.memoizedState,K!==null&&(Ge=K.dehydrated,Ge!==null))return j1(y,b,ve,z,Ge,K,O);if(te){te=z.fallback,ve=b.mode,K=y.child,Ge=K.sibling;var mt={mode:"hidden",children:z.children};return(ve&1)===0&&b.child!==K?(z=b.child,z.childLanes=0,z.pendingProps=mt,b.deletions=null):(z=Pc(K,mt),z.subtreeFlags=K.subtreeFlags&14680064),Ge!==null?te=Pc(Ge,te):(te=oa(te,ve,O,null),te.flags|=2),te.return=b,z.return=b,z.sibling=te,b.child=z,z=te,te=b.child,ve=y.child.memoizedState,ve=ve===null?Ed(O):{baseLanes:ve.baseLanes|O,cachePool:null,transitions:ve.transitions},te.memoizedState=ve,te.childLanes=y.childLanes&~O,b.memoizedState=va,z}return te=y.child,y=te.sibling,z=Pc(te,{mode:"visible",children:z.children}),(b.mode&1)===0&&(z.lanes=O),z.return=b,z.sibling=null,y!==null&&(O=b.deletions,O===null?(b.deletions=[y],b.flags|=16):O.push(y)),b.child=z,b.memoizedState=null,z}function og(y,b){return b=zd({mode:"visible",children:b},y.mode,0,null),b.return=y,y.child=b}function xu(y,b,O,z){return z!==null&&fp(z),su(b,y.child,null,O),y=og(b,b.pendingProps.children),y.flags|=2,b.memoizedState=null,y}function j1(y,b,O,z,K,te,ve){if(O)return b.flags&256?(b.flags&=-257,z=wc(Error(i(422))),xu(y,b,ve,z)):b.memoizedState!==null?(b.child=y.child,b.flags|=128,null):(te=z.fallback,K=b.mode,z=zd({mode:"visible",children:z.children},K,0,null),te=oa(te,K,ve,null),te.flags|=2,z.return=b,te.return=b,z.sibling=te,b.child=z,(b.mode&1)!==0&&su(b,y.child,null,ve),b.child.memoizedState=Ed(ve),b.memoizedState=va,te);if((b.mode&1)===0)return xu(y,b,ve,null);if(ir(K))return z=Wr(K).digest,te=Error(i(419)),z=wc(te,z,void 0),xu(y,b,ve,z);if(O=(ve&y.childLanes)!==0,Os||O){if(z=_n,z!==null){switch(ve&-ve){case 4:K=2;break;case 16:K=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:K=32;break;case 536870912:K=268435456;break;default:K=0}K=(K&(z.suspendedLanes|ve))!==0?0:K,K!==0&&K!==te.retryLane&&(te.retryLane=K,Co(y,K),ba(z,y,K,-1))}return $d(),z=wc(Error(i(421))),xu(y,b,ve,z)}return hr(K)?(b.flags|=128,b.child=y.child,b=L1.bind(null,y),ue(K,b),null):(y=te.treeContext,ge&&(Ba=_e(K),sa=b,Rn=!0,ko=null,Vf=!1,y!==null&&(La[ji++]=ui,La[ji++]=_o,La[ji++]=Ps,ui=y.id,_o=y.overflow,Ps=b)),b=og(b,z.children),b.flags|=4096,b)}function Jo(y,b,O){y.lanes|=b;var z=y.alternate;z!==null&&(z.lanes|=b),au(y.return,b,O)}function Nd(y,b,O,z,K){var te=y.memoizedState;te===null?y.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:z,tail:O,tailMode:K}:(te.isBackwards=b,te.rendering=null,te.renderingStartTime=0,te.last=z,te.tail=O,te.tailMode=K)}function lg(y,b,O){var z=b.pendingProps,K=z.revealOrder,te=z.tail;if(Vs(y,b,z.children,O),z=Hn.current,(z&2)!==0)z=z&1|2,b.flags|=128;else{if(y!==null&&(y.flags&128)!==0)e:for(y=b.child;y!==null;){if(y.tag===13)y.memoizedState!==null&&Jo(y,O,b);else if(y.tag===19)Jo(y,O,b);else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===b)break e;for(;y.sibling===null;){if(y.return===null||y.return===b)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}z&=1}if(he(Hn,z),(b.mode&1)===0)b.memoizedState=null;else switch(K){case"forwards":for(O=b.child,K=null;O!==null;)y=O.alternate,y!==null&&Y0(y)===null&&(K=O),O=O.sibling;O=K,O===null?(K=b.child,b.child=null):(K=O.sibling,O.sibling=null),Nd(b,!1,K,O,te);break;case"backwards":for(O=null,K=b.child,b.child=null;K!==null;){if(y=K.alternate,y!==null&&Y0(y)===null){b.child=K;break}y=K.sibling,K.sibling=O,O=K,K=y}Nd(b,!0,O,null,te);break;case"together":Nd(b,!1,null,null,void 0);break;default:b.memoizedState=null}return b.child}function nh(y,b){(b.mode&1)===0&&y!==null&&(y.alternate=null,b.alternate=null,b.flags|=2)}function Bl(y,b,O){if(y!==null&&(b.dependencies=y.dependencies),Ul|=b.lanes,(O&b.childLanes)===0)return null;if(y!==null&&b.child!==y.child)throw Error(i(153));if(b.child!==null){for(y=b.child,O=Pc(y,y.pendingProps),b.child=O,O.return=b;y.sibling!==null;)y=y.sibling,O=O.sibling=Pc(y,y.pendingProps),O.return=b;O.sibling=null}return b.child}function Sc(y,b,O){switch(b.tag){case 3:_c(b),ru();break;case 5:xp(b);break;case 1:et(b.type)&&Et(b);break;case 4:q0(b,b.stateNode.containerInfo);break;case 10:v1(b,b.type._context,b.memoizedProps.value);break;case 13:var z=b.memoizedState;if(z!==null)return z.dehydrated!==null?(he(Hn,Hn.current&1),b.flags|=128,null):(O&b.child.childLanes)!==0?Dp(y,b,O):(he(Hn,Hn.current&1),y=Bl(y,b,O),y!==null?y.sibling:null);he(Hn,Hn.current&1);break;case 19:if(z=(O&b.childLanes)!==0,(y.flags&128)!==0){if(z)return lg(y,b,O);b.flags|=128}var K=b.memoizedState;if(K!==null&&(K.rendering=null,K.tail=null,K.lastEffect=null),he(Hn,Hn.current),z)break;return null;case 22:case 23:return b.lanes=0,Pn(y,b,O)}return Bl(y,b,O)}function $a(y){y.flags|=4}function yu(y,b){if(y!==null&&y.child===b.child)return!0;if((b.flags&16)!==0)return!1;for(y=b.child;y!==null;){if((y.flags&12854)!==0||(y.subtreeFlags&12854)!==0)return!1;y=y.sibling}return!0}var kc,Cc,Ua,za;if(ke)kc=function(y,b){for(var O=b.child;O!==null;){if(O.tag===5||O.tag===6)I(y,O.stateNode);else if(O.tag!==4&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===b)break;for(;O.sibling===null;){if(O.return===null||O.return===b)return;O=O.return}O.sibling.return=O.return,O=O.sibling}},Cc=function(){},Ua=function(y,b,O,z,K){if(y=y.memoizedProps,y!==z){var te=b.stateNode,ve=to(eo.current);O=q(te,O,y,z,K,ve),(b.updateQueue=O)&&$a(b)}},za=function(y,b,O,z){O!==z&&$a(b)};else if(re){kc=function(y,b,O,z){for(var K=b.child;K!==null;){if(K.tag===5){var te=K.stateNode;O&&z&&(te=Ve(te,K.type,K.memoizedProps,K)),I(y,te)}else if(K.tag===6)te=K.stateNode,O&&z&&(te=Ze(te,K.memoizedProps,K)),I(y,te);else if(K.tag!==4){if(K.tag===22&&K.memoizedState!==null)te=K.child,te!==null&&(te.return=K),kc(y,K,!0,!0);else if(K.child!==null){K.child.return=K,K=K.child;continue}}if(K===b)break;for(;K.sibling===null;){if(K.return===null||K.return===b)return;K=K.return}K.sibling.return=K.return,K=K.sibling}};var Tc=function(y,b,O,z){for(var K=b.child;K!==null;){if(K.tag===5){var te=K.stateNode;O&&z&&(te=Ve(te,K.type,K.memoizedProps,K)),Oe(y,te)}else if(K.tag===6)te=K.stateNode,O&&z&&(te=Ze(te,K.memoizedProps,K)),Oe(y,te);else if(K.tag!==4){if(K.tag===22&&K.memoizedState!==null)te=K.child,te!==null&&(te.return=K),Tc(y,K,!0,!0);else if(K.child!==null){K.child.return=K,K=K.child;continue}}if(K===b)break;for(;K.sibling===null;){if(K.return===null||K.return===b)return;K=K.return}K.sibling.return=K.return,K=K.sibling}};Cc=function(y,b){var O=b.stateNode;if(!yu(y,b)){y=O.containerInfo;var z=kt(y);Tc(z,b,!1,!1),O.pendingChildren=z,$a(b),at(y,z)}},Ua=function(y,b,O,z,K){var te=y.stateNode,ve=y.memoizedProps;if((y=yu(y,b))&&ve===z)b.stateNode=te;else{var Ge=b.stateNode,mt=to(eo.current),Wt=null;ve!==z&&(Wt=q(Ge,O,ve,z,K,mt)),y&&Wt===null?b.stateNode=te:(te=Me(te,Wt,O,ve,z,b,y,Ge),B(te,O,z,K,mt)&&$a(b),b.stateNode=te,y?$a(b):kc(te,b,!1,!1))}},za=function(y,b,O,z){O!==z?(y=to(xc.current),O=to(eo.current),b.stateNode=se(z,y,O,b),$a(b)):b.stateNode=y.stateNode}}else Cc=function(){},Ua=function(){},za=function(){};function Ri(y,b){if(!Rn)switch(y.tailMode){case"hidden":b=y.tail;for(var O=null;b!==null;)b.alternate!==null&&(O=b),b=b.sibling;O===null?y.tail=null:O.sibling=null;break;case"collapsed":O=y.tail;for(var z=null;O!==null;)O.alternate!==null&&(z=O),O=O.sibling;z===null?b||y.tail===null?y.tail=null:y.tail.sibling=null:z.sibling=null}}function Un(y){var b=y.alternate!==null&&y.alternate.child===y.child,O=0,z=0;if(b)for(var K=y.child;K!==null;)O|=K.lanes|K.childLanes,z|=K.subtreeFlags&14680064,z|=K.flags&14680064,K.return=y,K=K.sibling;else for(K=y.child;K!==null;)O|=K.lanes|K.childLanes,z|=K.subtreeFlags,z|=K.flags,K.return=y,K=K.sibling;return y.subtreeFlags|=z,y.childLanes=O,b}function vu(y,b,O){var z=b.pendingProps;switch(Gf(b),b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Un(b),null;case 1:return et(b.type)&&we(),Un(b),null;case 3:return O=b.stateNode,iu(),Hr(br),Hr(xr),wp(),O.pendingContext&&(O.context=O.pendingContext,O.pendingContext=null),(y===null||y.child===null)&&(z0(b)?$a(b):y===null||y.memoizedState.isDehydrated&&(b.flags&256)===0||(b.flags|=1024,ko!==null&&(wg(ko),ko=null))),Cc(y,b),Un(b),null;case 5:yp(b),O=to(xc.current);var K=b.type;if(y!==null&&b.stateNode!=null)Ua(y,b,K,z,O),y.ref!==b.ref&&(b.flags|=512,b.flags|=2097152);else{if(!z){if(b.stateNode===null)throw Error(i(166));return Un(b),null}if(y=to(eo.current),z0(b)){if(!ge)throw Error(i(175));y=Se(b.stateNode,b.type,b.memoizedProps,O,y,b,!Vf),b.updateQueue=y,y!==null&&$a(b)}else{var te=W(K,z,O,y,b);kc(te,b,!1,!1),b.stateNode=te,B(te,K,z,O,y)&&$a(b)}b.ref!==null&&(b.flags|=512,b.flags|=2097152)}return Un(b),null;case 6:if(y&&b.stateNode!=null)za(y,b,y.memoizedProps,z);else{if(typeof z!="string"&&b.stateNode===null)throw Error(i(166));if(y=to(xc.current),O=to(eo.current),z0(b)){if(!ge)throw Error(i(176));if(y=b.stateNode,O=b.memoizedProps,(z=He(y,O,b,!Vf))&&(K=sa,K!==null))switch(K.tag){case 3:ut(K.stateNode.containerInfo,y,O,(K.mode&1)!==0);break;case 5:ft(K.type,K.memoizedProps,K.stateNode,y,O,(K.mode&1)!==0)}z&&$a(b)}else b.stateNode=se(z,y,O,b)}return Un(b),null;case 13:if(Hr(Hn),z=b.memoizedState,y===null||y.memoizedState!==null&&y.memoizedState.dehydrated!==null){if(Rn&&Ba!==null&&(b.mode&1)!==0&&(b.flags&128)===0)m1(),ru(),b.flags|=98560,K=!1;else if(K=z0(b),z!==null&&z.dehydrated!==null){if(y===null){if(!K)throw Error(i(318));if(!ge)throw Error(i(344));if(K=b.memoizedState,K=K!==null?K.dehydrated:null,!K)throw Error(i(317));it(K,b)}else ru(),(b.flags&128)===0&&(b.memoizedState=null),b.flags|=4;Un(b),K=!1}else ko!==null&&(wg(ko),ko=null),K=!0;if(!K)return b.flags&65536?b:null}return(b.flags&128)!==0?(b.lanes=O,b):(O=z!==null,O!==(y!==null&&y.memoizedState!==null)&&O&&(b.child.flags|=8192,(b.mode&1)!==0&&(y===null||(Hn.current&1)!==0?Wn===0&&(Wn=3):$d())),b.updateQueue!==null&&(b.flags|=4),Un(b),null);case 4:return iu(),Cc(y,b),y===null&&je(b.stateNode.containerInfo),Un(b),null;case 10:return Kf(b.type._context),Un(b),null;case 17:return et(b.type)&&we(),Un(b),null;case 19:if(Hr(Hn),K=b.memoizedState,K===null)return Un(b),null;if(z=(b.flags&128)!==0,te=K.rendering,te===null)if(z)Ri(K,!1);else{if(Wn!==0||y!==null&&(y.flags&128)!==0)for(y=b.child;y!==null;){if(te=Y0(y),te!==null){for(b.flags|=128,Ri(K,!1),y=te.updateQueue,y!==null&&(b.updateQueue=y,b.flags|=4),b.subtreeFlags=0,y=O,O=b.child;O!==null;)z=O,K=y,z.flags&=14680066,te=z.alternate,te===null?(z.childLanes=0,z.lanes=K,z.child=null,z.subtreeFlags=0,z.memoizedProps=null,z.memoizedState=null,z.updateQueue=null,z.dependencies=null,z.stateNode=null):(z.childLanes=te.childLanes,z.lanes=te.lanes,z.child=te.child,z.subtreeFlags=0,z.deletions=null,z.memoizedProps=te.memoizedProps,z.memoizedState=te.memoizedState,z.updateQueue=te.updateQueue,z.type=te.type,K=te.dependencies,z.dependencies=K===null?null:{lanes:K.lanes,firstContext:K.firstContext}),O=O.sibling;return he(Hn,Hn.current&1|2),b.child}y=y.sibling}K.tail!==null&&Hs()>uh&&(b.flags|=128,z=!0,Ri(K,!1),b.lanes=4194304)}else{if(!z)if(y=Y0(te),y!==null){if(b.flags|=128,z=!0,y=y.updateQueue,y!==null&&(b.updateQueue=y,b.flags|=4),Ri(K,!0),K.tail===null&&K.tailMode==="hidden"&&!te.alternate&&!Rn)return Un(b),null}else 2*Hs()-K.renderingStartTime>uh&&O!==1073741824&&(b.flags|=128,z=!0,Ri(K,!1),b.lanes=4194304);K.isBackwards?(te.sibling=b.child,b.child=te):(y=K.last,y!==null?y.sibling=te:b.child=te,K.last=te)}return K.tail!==null?(b=K.tail,K.rendering=b,K.tail=b.sibling,K.renderingStartTime=Hs(),b.sibling=null,y=Hn.current,he(Hn,z?y&1|2:y&1),b):(Un(b),null);case 22:case 23:return bg(),O=b.memoizedState!==null,y!==null&&y.memoizedState!==null!==O&&(b.flags|=8192),O&&(b.mode&1)!==0?(Ds&1073741824)!==0&&(Un(b),ke&&b.subtreeFlags&6&&(b.flags|=8192)):Un(b),null;case 24:return null;case 25:return null}throw Error(i(156,b.tag))}function P1(y,b){switch(Gf(b),b.tag){case 1:return et(b.type)&&we(),y=b.flags,y&65536?(b.flags=y&-65537|128,b):null;case 3:return iu(),Hr(br),Hr(xr),wp(),y=b.flags,(y&65536)!==0&&(y&128)===0?(b.flags=y&-65537|128,b):null;case 5:return yp(b),null;case 13:if(Hr(Hn),y=b.memoizedState,y!==null&&y.dehydrated!==null){if(b.alternate===null)throw Error(i(340));ru()}return y=b.flags,y&65536?(b.flags=y&-65537|128,b):null;case 19:return Hr(Hn),null;case 4:return iu(),null;case 10:return Kf(b.type._context),null;case 22:case 23:return bg(),null;case 24:return null;default:return null}}var Ad=!1,Ks=!1,Ii=typeof WeakSet=="function"?WeakSet:Set,Zt=null;function pn(y,b){var O=y.ref;if(O!==null)if(typeof O=="function")try{O(null)}catch(z){Mn(y,b,z)}else O.current=null}function Mi(y,b,O){try{O()}catch(z){Mn(y,b,z)}}var Rp=!1;function F1(y,b){for(M(y.containerInfo),Zt=b;Zt!==null;)if(y=Zt,b=y.child,(y.subtreeFlags&1028)!==0&&b!==null)b.return=y,Zt=b;else for(;Zt!==null;){y=Zt;try{var O=y.alternate;if((y.flags&1024)!==0)switch(y.tag){case 0:case 11:case 15:break;case 1:if(O!==null){var z=O.memoizedProps,K=O.memoizedState,te=y.stateNode,ve=te.getSnapshotBeforeUpdate(y.elementType===y.type?z:Di(y.type,z),K);te.__reactInternalSnapshotBeforeUpdate=ve}break;case 3:ke&&Fe(y.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(Ge){Mn(y,y.return,Ge)}if(b=y.sibling,b!==null){b.return=y.return,Zt=b;break}Zt=y.return}return O=Rp,Rp=!1,O}function wu(y,b,O){var z=b.updateQueue;if(z=z!==null?z.lastEffect:null,z!==null){var K=z=z.next;do{if((K.tag&y)===y){var te=K.destroy;K.destroy=void 0,te!==void 0&&Mi(b,O,te)}K=K.next}while(K!==z)}}function jd(y,b){if(b=b.updateQueue,b=b!==null?b.lastEffect:null,b!==null){var O=b=b.next;do{if((O.tag&y)===y){var z=O.create;O.destroy=z()}O=O.next}while(O!==b)}}function cg(y){var b=y.ref;if(b!==null){var O=y.stateNode;switch(y.tag){case 5:y=ne(O);break;default:y=O}typeof b=="function"?b(y):b.current=y}}function sh(y){var b=y.alternate;b!==null&&(y.alternate=null,sh(b)),y.child=null,y.deletions=null,y.sibling=null,y.tag===5&&(b=y.stateNode,b!==null&&Ue(b)),y.stateNode=null,y.return=null,y.dependencies=null,y.memoizedProps=null,y.memoizedState=null,y.pendingProps=null,y.stateNode=null,y.updateQueue=null}function Ip(y){return y.tag===5||y.tag===3||y.tag===4}function bu(y){e:for(;;){for(;y.sibling===null;){if(y.return===null||Ip(y.return))return null;y=y.return}for(y.sibling.return=y.return,y=y.sibling;y.tag!==5&&y.tag!==6&&y.tag!==18;){if(y.flags&2||y.child===null||y.tag===4)continue e;y.child.return=y,y=y.child}if(!(y.flags&2))return y.stateNode}}function ah(y,b,O){var z=y.tag;if(z===5||z===6)y=y.stateNode,b?Vt(O,y,b):ct(O,y);else if(z!==4&&(y=y.child,y!==null))for(ah(y,b,O),y=y.sibling;y!==null;)ah(y,b,O),y=y.sibling}function Mp(y,b,O){var z=y.tag;if(z===5||z===6)y=y.stateNode,b?jt(O,y,b):Be(O,y);else if(z!==4&&(y=y.child,y!==null))for(Mp(y,b,O),y=y.sibling;y!==null;)Mp(y,b,O),y=y.sibling}var ls=null,fi=!1;function To(y,b,O){for(O=O.child;O!==null;)ug(y,b,O),O=O.sibling}function ug(y,b,O){if(ci&&typeof ci.onCommitFiberUnmount=="function")try{ci.onCommitFiberUnmount(fc,O)}catch{}switch(O.tag){case 5:Ks||pn(O,b);case 6:if(ke){var z=ls,K=fi;ls=null,To(y,b,O),ls=z,fi=K,ls!==null&&(fi?Dr(ls,O.stateNode):fr(ls,O.stateNode))}else To(y,b,O);break;case 18:ke&&ls!==null&&(fi?Ee(ls,O.stateNode):Te(ls,O.stateNode));break;case 4:ke?(z=ls,K=fi,ls=O.stateNode.containerInfo,fi=!0,To(y,b,O),ls=z,fi=K):(re&&(z=O.stateNode.containerInfo,K=kt(z),Ce(z,K)),To(y,b,O));break;case 0:case 11:case 14:case 15:if(!Ks&&(z=O.updateQueue,z!==null&&(z=z.lastEffect,z!==null))){K=z=z.next;do{var te=K,ve=te.destroy;te=te.tag,ve!==void 0&&((te&2)!==0||(te&4)!==0)&&Mi(O,b,ve),K=K.next}while(K!==z)}To(y,b,O);break;case 1:if(!Ks&&(pn(O,b),z=O.stateNode,typeof z.componentWillUnmount=="function"))try{z.props=O.memoizedProps,z.state=O.memoizedState,z.componentWillUnmount()}catch(Ge){Mn(O,b,Ge)}To(y,b,O);break;case 21:To(y,b,O);break;case 22:O.mode&1?(Ks=(z=Ks)||O.memoizedState!==null,To(y,b,O),Ks=z):To(y,b,O);break;default:To(y,b,O)}}function _u(y){var b=y.updateQueue;if(b!==null){y.updateQueue=null;var O=y.stateNode;O===null&&(O=y.stateNode=new Ii),b.forEach(function(z){var K=V2.bind(null,y,z);O.has(z)||(O.add(z),z.then(K,K))})}}function no(y,b){var O=b.deletions;if(O!==null)for(var z=0;z<O.length;z++){var K=O[z];try{var te=y,ve=b;if(ke){var Ge=ve;e:for(;Ge!==null;){switch(Ge.tag){case 5:ls=Ge.stateNode,fi=!1;break e;case 3:ls=Ge.stateNode.containerInfo,fi=!0;break e;case 4:ls=Ge.stateNode.containerInfo,fi=!0;break e}Ge=Ge.return}if(ls===null)throw Error(i(160));ug(te,ve,K),ls=null,fi=!1}else ug(te,ve,K);var mt=K.alternate;mt!==null&&(mt.return=null),K.return=null}catch(Wt){Mn(K,b,Wt)}}if(b.subtreeFlags&12854)for(b=b.child;b!==null;)ih(b,y),b=b.sibling}function ih(y,b){var O=y.alternate,z=y.flags;switch(y.tag){case 0:case 11:case 14:case 15:if(no(b,y),Li(y),z&4){try{wu(3,y,y.return),jd(3,y)}catch(tr){Mn(y,y.return,tr)}try{wu(5,y,y.return)}catch(tr){Mn(y,y.return,tr)}}break;case 1:no(b,y),Li(y),z&512&&O!==null&&pn(O,O.return);break;case 5:if(no(b,y),Li(y),z&512&&O!==null&&pn(O,O.return),ke){if(y.flags&32){var K=y.stateNode;try{zr(K)}catch(tr){Mn(y,y.return,tr)}}if(z&4&&(K=y.stateNode,K!=null)){var te=y.memoizedProps;if(O=O!==null?O.memoizedProps:te,z=y.type,b=y.updateQueue,y.updateQueue=null,b!==null)try{Tt(K,b,z,O,te,y)}catch(tr){Mn(y,y.return,tr)}}}break;case 6:if(no(b,y),Li(y),z&4&&ke){if(y.stateNode===null)throw Error(i(162));K=y.stateNode,te=y.memoizedProps,O=O!==null?O.memoizedProps:te;try{We(K,O,te)}catch(tr){Mn(y,y.return,tr)}}break;case 3:if(no(b,y),Li(y),z&4){if(ke&&ge&&O!==null&&O.memoizedState.isDehydrated)try{oe(b.containerInfo)}catch(tr){Mn(y,y.return,tr)}if(re){K=b.containerInfo,te=b.pendingChildren;try{Ce(K,te)}catch(tr){Mn(y,y.return,tr)}}}break;case 4:if(no(b,y),Li(y),z&4&&re){te=y.stateNode,K=te.containerInfo,te=te.pendingChildren;try{Ce(K,te)}catch(tr){Mn(y,y.return,tr)}}break;case 13:no(b,y),Li(y),K=y.child,K.flags&8192&&(te=K.memoizedState!==null,K.stateNode.isHidden=te,!te||K.alternate!==null&&K.alternate.memoizedState!==null||(Id=Hs())),z&4&&_u(y);break;case 22:var ve=O!==null&&O.memoizedState!==null;if(y.mode&1?(Ks=(O=Ks)||ve,no(b,y),Ks=O):no(b,y),Li(y),z&8192){if(O=y.memoizedState!==null,(y.stateNode.isHidden=O)&&!ve&&(y.mode&1)!==0)for(Zt=y,z=y.child;z!==null;){for(b=Zt=z;Zt!==null;){ve=Zt;var Ge=ve.child;switch(ve.tag){case 0:case 11:case 14:case 15:wu(4,ve,ve.return);break;case 1:pn(ve,ve.return);var mt=ve.stateNode;if(typeof mt.componentWillUnmount=="function"){var Wt=ve,lr=ve.return;try{var Mr=Wt;mt.props=Mr.memoizedProps,mt.state=Mr.memoizedState,mt.componentWillUnmount()}catch(tr){Mn(Wt,lr,tr)}}break;case 5:pn(ve,ve.return);break;case 22:if(ve.memoizedState!==null){hg(b);continue}}Ge!==null?(Ge.return=ve,Zt=Ge):hg(b)}z=z.sibling}if(ke){e:if(z=null,ke)for(b=y;;){if(b.tag===5){if(z===null){z=b;try{K=b.stateNode,O?or(K):me(b.stateNode,b.memoizedProps)}catch(tr){Mn(y,y.return,tr)}}}else if(b.tag===6){if(z===null)try{te=b.stateNode,O?nr(te):Ae(te,b.memoizedProps)}catch(tr){Mn(y,y.return,tr)}}else if((b.tag!==22&&b.tag!==23||b.memoizedState===null||b===y)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===y)break e;for(;b.sibling===null;){if(b.return===null||b.return===y)break e;z===b&&(z=null),b=b.return}z===b&&(z=null),b.sibling.return=b.return,b=b.sibling}}}break;case 19:no(b,y),Li(y),z&4&&_u(y);break;case 21:break;default:no(b,y),Li(y)}}function Li(y){var b=y.flags;if(b&2){try{if(ke){e:{for(var O=y.return;O!==null;){if(Ip(O)){var z=O;break e}O=O.return}throw Error(i(160))}switch(z.tag){case 5:var K=z.stateNode;z.flags&32&&(zr(K),z.flags&=-33);var te=bu(y);Mp(y,te,K);break;case 3:case 4:var ve=z.stateNode.containerInfo,Ge=bu(y);ah(y,Ge,ve);break;default:throw Error(i(161))}}}catch(mt){Mn(y,y.return,mt)}y.flags&=-3}b&4096&&(y.flags&=-4097)}function Pd(y,b,O){Zt=y,dg(y)}function dg(y,b,O){for(var z=(y.mode&1)!==0;Zt!==null;){var K=Zt,te=K.child;if(K.tag===22&&z){var ve=K.memoizedState!==null||Ad;if(!ve){var Ge=K.alternate,mt=Ge!==null&&Ge.memoizedState!==null||Ks;Ge=Ad;var Wt=Ks;if(Ad=ve,(Ks=mt)&&!Wt)for(Zt=K;Zt!==null;)ve=Zt,mt=ve.child,ve.tag===22&&ve.memoizedState!==null?gg(K):mt!==null?(mt.return=ve,Zt=mt):gg(K);for(;te!==null;)Zt=te,dg(te),te=te.sibling;Zt=K,Ad=Ge,Ks=Wt}fg(y)}else(K.subtreeFlags&8772)!==0&&te!==null?(te.return=K,Zt=te):fg(y)}}function fg(y){for(;Zt!==null;){var b=Zt;if((b.flags&8772)!==0){var O=b.alternate;try{if((b.flags&8772)!==0)switch(b.tag){case 0:case 11:case 15:Ks||jd(5,b);break;case 1:var z=b.stateNode;if(b.flags&4&&!Ks)if(O===null)z.componentDidMount();else{var K=b.elementType===b.type?O.memoizedProps:Di(b.type,O.memoizedProps);z.componentDidUpdate(K,O.memoizedState,z.__reactInternalSnapshotBeforeUpdate)}var te=b.updateQueue;te!==null&&b1(b,te,z);break;case 3:var ve=b.updateQueue;if(ve!==null){if(O=null,b.child!==null)switch(b.child.tag){case 5:O=ne(b.child.stateNode);break;case 1:O=b.child.stateNode}b1(b,ve,O)}break;case 5:var Ge=b.stateNode;O===null&&b.flags&4&&nt(Ge,b.type,b.memoizedProps,b);break;case 6:break;case 4:break;case 12:break;case 13:if(ge&&b.memoizedState===null){var mt=b.alternate;if(mt!==null){var Wt=mt.memoizedState;if(Wt!==null){var lr=Wt.dehydrated;lr!==null&&fe(lr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}Ks||b.flags&512&&cg(b)}catch(Mr){Mn(b,b.return,Mr)}}if(b===y){Zt=null;break}if(O=b.sibling,O!==null){O.return=b.return,Zt=O;break}Zt=b.return}}function hg(y){for(;Zt!==null;){var b=Zt;if(b===y){Zt=null;break}var O=b.sibling;if(O!==null){O.return=b.return,Zt=O;break}Zt=b.return}}function gg(y){for(;Zt!==null;){var b=Zt;try{switch(b.tag){case 0:case 11:case 15:var O=b.return;try{jd(4,b)}catch(mt){Mn(b,O,mt)}break;case 1:var z=b.stateNode;if(typeof z.componentDidMount=="function"){var K=b.return;try{z.componentDidMount()}catch(mt){Mn(b,K,mt)}}var te=b.return;try{cg(b)}catch(mt){Mn(b,te,mt)}break;case 5:var ve=b.return;try{cg(b)}catch(mt){Mn(b,ve,mt)}}}catch(mt){Mn(b,b.return,mt)}if(b===y){Zt=null;break}var Ge=b.sibling;if(Ge!==null){Ge.return=b.return,Zt=Ge;break}Zt=b.return}}var $l=0,Wa=1,Qo=2,Fd=3,oh=4;if(typeof Symbol=="function"&&Symbol.for){var Bi=Symbol.for;$l=Bi("selector.component"),Wa=Bi("selector.has_pseudo_class"),Qo=Bi("selector.role"),Fd=Bi("selector.test_id"),oh=Bi("selector.text")}function Zo(y){var b=Ne(y);if(b!=null){if(typeof b.memoizedProps["data-testname"]!="string")throw Error(i(364));return b}if(y=xt(y),y===null)throw Error(i(362));return y.stateNode.current}function lh(y,b){switch(b.$$typeof){case $l:if(y.type===b.value)return!0;break;case Wa:e:{b=b.value,y=[y,0];for(var O=0;O<y.length;){var z=y[O++],K=y[O++],te=b[K];if(z.tag!==5||!Rt(z)){for(;te!=null&&lh(z,te);)K++,te=b[K];if(K===b.length){b=!0;break e}else for(z=z.child;z!==null;)y.push(z,K),z=z.sibling}}b=!1}return b;case Qo:if(y.tag===5&&Mt(y.stateNode,b.value))return!0;break;case oh:if((y.tag===5||y.tag===6)&&(y=pt(y),y!==null&&0<=y.indexOf(b.value)))return!0;break;case Fd:if(y.tag===5&&(y=y.memoizedProps["data-testname"],typeof y=="string"&&y.toLowerCase()===b.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function mg(y){switch(y.$$typeof){case $l:return"<"+(F(y.value)||"Unknown")+">";case Wa:return":has("+(mg(y)||"")+")";case Qo:return'[role="'+y.value+'"]';case oh:return'"'+y.value+'"';case Fd:return'[data-testname="'+y.value+'"]';default:throw Error(i(365))}}function el(y,b){var O=[];y=[y,0];for(var z=0;z<y.length;){var K=y[z++],te=y[z++],ve=b[te];if(K.tag!==5||!Rt(K)){for(;ve!=null&&lh(K,ve);)te++,ve=b[te];if(te===b.length)O.push(K);else for(K=K.child;K!==null;)y.push(K,te),K=K.sibling}}return O}function tl(y,b){if(!wt)throw Error(i(363));y=Zo(y),y=el(y,b),b=[],y=Array.from(y);for(var O=0;O<y.length;){var z=y[O++];if(z.tag===5)Rt(z)||b.push(z.stateNode);else for(z=z.child;z!==null;)y.push(z),z=z.sibling}return b}var pg=Math.ceil,ch=o.ReactCurrentDispatcher,Od=o.ReactCurrentOwner,ts=o.ReactCurrentBatchConfig,Br=0,_n=null,zn=null,cs=0,Ds=0,Ec=qr(0),Wn=0,Dd=null,Ul=0,Fn=0,Rd=0,Su=null,wa=null,Id=0,uh=1/0,Ha=null;function vn(){uh=Hs()+500}var rs=!1,ps=null,Eo=null,Nc=!1,so=null,xg=0,xs=0,dh=null,Md=-1,Ld=0;function In(){return(Br&6)!==0?Hs():Md!==-1?Md:Md=Hs()}function Rs(y){return(y.mode&1)===0?1:(Br&2)!==0&&cs!==0?cs&-cs:W2.transition!==null?(Ld===0&&(Ld=cc()),Ld):(y=Qr,y!==0?y:Ke())}function ba(y,b,O,z){if(50<xs)throw xs=0,dh=null,Error(i(185));Zi(y,O,z),((Br&2)===0||y!==_n)&&(y===_n&&((Br&2)===0&&(Fn|=O),Wn===4&&zl(y,cs)),_a(y,z),O===1&&Br===0&&(b.mode&1)===0&&(vn(),xd&&na()))}function _a(y,b){var O=y.callbackNode;li(y,b);var z=Nr(y,y===_n?cs:0);if(z===0)O!==null&&c1(O),y.callbackNode=null,y.callbackPriority=0;else if(b=z&-z,y.callbackPriority!==b){if(O!=null&&c1(O),b===1)y.tag===0?d1(Lp.bind(null,y)):$0(Lp.bind(null,y)),It?rt(function(){(Br&6)===0&&na()}):Ko(I0,na),O=null;else{switch(md(z)){case 1:O=I0;break;case 4:O=M0;break;case 16:O=L0;break;case 536870912:O=z2;break;default:O=L0}O=Gp(O,yg.bind(null,y))}y.callbackPriority=b,y.callbackNode=O}}function yg(y,b){if(Md=-1,Ld=0,(Br&6)!==0)throw Error(i(327));var O=y.callbackNode;if(Wl()&&y.callbackNode!==O)return null;var z=Nr(y,y===_n?cs:0);if(z===0)return null;if((z&30)!==0||(z&y.expiredLanes)!==0||b)b=ku(y,z);else{b=z;var K=Br;Br|=2;var te=$p();(_n!==y||cs!==b)&&(Ha=null,vn(),Ac(y,b));do try{Up();break}catch(Ge){Bd(y,Ge)}while(!0);gp(),ch.current=te,Br=K,zn!==null?b=0:(_n=null,cs=0,b=Wn)}if(b!==0){if(b===2&&(K=Go(y),K!==0&&(z=K,b=vg(y,K))),b===1)throw O=Dd,Ac(y,0),zl(y,z),_a(y,Hs()),O;if(b===6)zl(y,z);else{if(K=y.current.alternate,(z&30)===0&&!O1(K)&&(b=ku(y,z),b===2&&(te=Go(y),te!==0&&(z=te,b=vg(y,te))),b===1))throw O=Dd,Ac(y,0),zl(y,z),_a(y,Hs()),O;switch(y.finishedWork=K,y.finishedLanes=z,b){case 0:case 1:throw Error(i(345));case 2:jc(y,wa,Ha);break;case 3:if(zl(y,z),(z&130023424)===z&&(b=Id+500-Hs(),10<b)){if(Nr(y,0)!==0)break;if(K=y.suspendedLanes,(K&z)!==z){In(),y.pingedLanes|=y.suspendedLanes&K;break}y.timeoutHandle=X(jc.bind(null,y,wa,Ha),b);break}jc(y,wa,Ha);break;case 4:if(zl(y,z),(z&4194240)===z)break;for(b=y.eventTimes,K=-1;0<z;){var ve=31-mr(z);te=1<<ve,ve=b[ve],ve>K&&(K=ve),z&=~te}if(z=K,z=Hs()-z,z=(120>z?120:480>z?480:1080>z?1080:1920>z?1920:3e3>z?3e3:4320>z?4320:1960*pg(z/1960))-z,10<z){y.timeoutHandle=X(jc.bind(null,y,wa,Ha),z);break}jc(y,wa,Ha);break;case 5:jc(y,wa,Ha);break;default:throw Error(i(329))}}}return _a(y,Hs()),y.callbackNode===O?yg.bind(null,y):null}function vg(y,b){var O=Su;return y.current.memoizedState.isDehydrated&&(Ac(y,b).flags|=256),y=ku(y,b),y!==2&&(b=wa,wa=O,b!==null&&wg(b)),y}function wg(y){wa===null?wa=y:wa.push.apply(wa,y)}function O1(y){for(var b=y;;){if(b.flags&16384){var O=b.updateQueue;if(O!==null&&(O=O.stores,O!==null))for(var z=0;z<O.length;z++){var K=O[z],te=K.getSnapshot;K=K.value;try{if(!bo(te(),K))return!1}catch{return!1}}}if(O=b.child,b.subtreeFlags&16384&&O!==null)O.return=b,b=O;else{if(b===y)break;for(;b.sibling===null;){if(b.return===null||b.return===y)return!0;b=b.return}b.sibling.return=b.return,b=b.sibling}}return!0}function zl(y,b){for(b&=~Rd,b&=~Fn,y.suspendedLanes|=b,y.pingedLanes&=~b,y=y.expirationTimes;0<b;){var O=31-mr(b),z=1<<O;y[O]=-1,b&=~z}}function Lp(y){if((Br&6)!==0)throw Error(i(327));Wl();var b=Nr(y,0);if((b&1)===0)return _a(y,Hs()),null;var O=ku(y,b);if(y.tag!==0&&O===2){var z=Go(y);z!==0&&(b=z,O=vg(y,z))}if(O===1)throw O=Dd,Ac(y,0),zl(y,b),_a(y,Hs()),O;if(O===6)throw Error(i(345));return y.finishedWork=y.current.alternate,y.finishedLanes=b,jc(y,wa,Ha),_a(y,Hs()),null}function Bp(y){so!==null&&so.tag===0&&(Br&6)===0&&Wl();var b=Br;Br|=1;var O=ts.transition,z=Qr;try{if(ts.transition=null,Qr=1,y)return y()}finally{Qr=z,ts.transition=O,Br=b,(Br&6)===0&&na()}}function bg(){Ds=Ec.current,Hr(Ec)}function Ac(y,b){y.finishedWork=null,y.finishedLanes=0;var O=y.timeoutHandle;if(O!==le&&(y.timeoutHandle=le,ie(O)),zn!==null)for(O=zn.return;O!==null;){var z=O;switch(Gf(z),z.tag){case 1:z=z.type.childContextTypes,z!=null&&we();break;case 3:iu(),Hr(br),Hr(xr),wp();break;case 5:yp(z);break;case 4:iu();break;case 13:Hr(Hn);break;case 19:Hr(Hn);break;case 10:Kf(z.type._context);break;case 22:case 23:bg()}O=O.return}if(_n=y,zn=y=Pc(y.current,null),cs=Ds=b,Wn=0,Dd=null,Rd=Fn=Ul=0,wa=Su=null,gc!==null){for(b=0;b<gc.length;b++)if(O=gc[b],z=O.interleaved,z!==null){O.interleaved=null;var K=z.next,te=O.pending;if(te!==null){var ve=te.next;te.next=K,z.next=ve}O.pending=z}gc=null}return y}function Bd(y,b){do{var O=zn;try{if(gp(),di.current=hu,Sd){for(var z=$n.memoizedState;z!==null;){var K=z.queue;K!==null&&(K.pending=null),z=z.next}Sd=!1}if(yc=0,Fs=ms=$n=null,Yf=!1,Xf=0,Od.current=null,O===null||O.return===null){Wn=1,Dd=b,zn=null;break}e:{var te=y,ve=O.return,Ge=O,mt=b;if(b=cs,Ge.flags|=32768,mt!==null&&typeof mt=="object"&&typeof mt.then=="function"){var Wt=mt,lr=Ge,Mr=lr.tag;if((lr.mode&1)===0&&(Mr===0||Mr===11||Mr===15)){var tr=lr.alternate;tr?(lr.updateQueue=tr.updateQueue,lr.memoizedState=tr.memoizedState,lr.lanes=tr.lanes):(lr.updateQueue=null,lr.memoizedState=null)}var On=A1(ve);if(On!==null){On.flags&=-257,bc(On,ve,Ge,te,b),On.mode&1&&N1(te,Wt,b),b=On,mt=Wt;var xn=b.updateQueue;if(xn===null){var Ga=new Set;Ga.add(mt),b.updateQueue=Ga}else xn.add(mt);break e}else{if((b&1)===0){N1(te,Wt,b),$d();break e}mt=Error(i(426))}}else if(Rn&&Ge.mode&1){var rl=A1(ve);if(rl!==null){(rl.flags&65536)===0&&(rl.flags|=256),bc(rl,ve,Ge,te,b),fp(gu(mt,Ge));break e}}te=mt=gu(mt,Ge),Wn!==4&&(Wn=2),Su===null?Su=[te]:Su.push(te),te=ve;do{switch(te.tag){case 3:te.flags|=65536,b&=-b,te.lanes|=b;var dt=Yo(te,mt,b);bd(te,dt);break e;case 1:Ge=mt;var qe=te.type,yt=te.stateNode;if((te.flags&128)===0&&(typeof qe.getDerivedStateFromError=="function"||yt!==null&&typeof yt.componentDidCatch=="function"&&(Eo===null||!Eo.has(yt)))){te.flags|=65536,b&=-b,te.lanes|=b;var rr=ag(te,Ge,b);bd(te,rr);break e}}te=te.return}while(te!==null)}Wp(O)}catch(_r){b=_r,zn===O&&O!==null&&(zn=O=O.return);continue}break}while(!0)}function $p(){var y=ch.current;return ch.current=hu,y===null?hu:y}function $d(){(Wn===0||Wn===3||Wn===2)&&(Wn=4),_n===null||(Ul&268435455)===0&&(Fn&268435455)===0||zl(_n,cs)}function ku(y,b){var O=Br;Br|=2;var z=$p();(_n!==y||cs!==b)&&(Ha=null,Ac(y,b));do try{D1();break}catch(K){Bd(y,K)}while(!0);if(gp(),Br=O,ch.current=z,zn!==null)throw Error(i(261));return _n=null,cs=0,Wn}function D1(){for(;zn!==null;)zp(zn)}function Up(){for(;zn!==null&&!u1();)zp(zn)}function zp(y){var b=B1(y.alternate,y,Ds);y.memoizedProps=y.pendingProps,b===null?Wp(y):zn=b,Od.current=null}function Wp(y){var b=y;do{var O=b.alternate;if(y=b.return,(b.flags&32768)===0){if(O=vu(O,b,Ds),O!==null){zn=O;return}}else{if(O=P1(O,b),O!==null){O.flags&=32767,zn=O;return}if(y!==null)y.flags|=32768,y.subtreeFlags=0,y.deletions=null;else{Wn=6,zn=null;return}}if(b=b.sibling,b!==null){zn=b;return}zn=b=y}while(b!==null);Wn===0&&(Wn=5)}function jc(y,b,O){var z=Qr,K=ts.transition;try{ts.transition=null,Qr=1,R1(y,b,O,z)}finally{ts.transition=K,Qr=z}return null}function R1(y,b,O,z){do Wl();while(so!==null);if((Br&6)!==0)throw Error(i(327));O=y.finishedWork;var K=y.finishedLanes;if(O===null)return null;if(y.finishedWork=null,y.finishedLanes=0,O===y.current)throw Error(i(177));y.callbackNode=null,y.callbackPriority=0;var te=O.lanes|O.childLanes;if(dc(y,te),y===_n&&(zn=_n=null,cs=0),(O.subtreeFlags&2064)===0&&(O.flags&2064)===0||Nc||(Nc=!0,Gp(L0,function(){return Wl(),null})),te=(O.flags&15990)!==0,(O.subtreeFlags&15990)!==0||te){te=ts.transition,ts.transition=null;var ve=Qr;Qr=1;var Ge=Br;Br|=4,Od.current=null,F1(y,O),ih(O,y),V(y.containerInfo),y.current=O,Pd(O),zf(),Br=Ge,Qr=ve,ts.transition=te}else y.current=O;if(Nc&&(Nc=!1,so=y,xg=K),te=y.pendingLanes,te===0&&(Eo=null),pd(O.stateNode),_a(y,Hs()),b!==null)for(z=y.onRecoverableError,O=0;O<b.length;O++)K=b[O],z(K.value,{componentStack:K.stack,digest:K.digest});if(rs)throw rs=!1,y=ps,ps=null,y;return(xg&1)!==0&&y.tag!==0&&Wl(),te=y.pendingLanes,(te&1)!==0?y===dh?xs++:(xs=0,dh=y):xs=0,na(),null}function Wl(){if(so!==null){var y=md(xg),b=ts.transition,O=Qr;try{if(ts.transition=null,Qr=16>y?16:y,so===null)var z=!1;else{if(y=so,so=null,xg=0,(Br&6)!==0)throw Error(i(331));var K=Br;for(Br|=4,Zt=y.current;Zt!==null;){var te=Zt,ve=te.child;if((Zt.flags&16)!==0){var Ge=te.deletions;if(Ge!==null){for(var mt=0;mt<Ge.length;mt++){var Wt=Ge[mt];for(Zt=Wt;Zt!==null;){var lr=Zt;switch(lr.tag){case 0:case 11:case 15:wu(8,lr,te)}var Mr=lr.child;if(Mr!==null)Mr.return=lr,Zt=Mr;else for(;Zt!==null;){lr=Zt;var tr=lr.sibling,On=lr.return;if(sh(lr),lr===Wt){Zt=null;break}if(tr!==null){tr.return=On,Zt=tr;break}Zt=On}}}var xn=te.alternate;if(xn!==null){var Ga=xn.child;if(Ga!==null){xn.child=null;do{var rl=Ga.sibling;Ga.sibling=null,Ga=rl}while(Ga!==null)}}Zt=te}}if((te.subtreeFlags&2064)!==0&&ve!==null)ve.return=te,Zt=ve;else e:for(;Zt!==null;){if(te=Zt,(te.flags&2048)!==0)switch(te.tag){case 0:case 11:case 15:wu(9,te,te.return)}var dt=te.sibling;if(dt!==null){dt.return=te.return,Zt=dt;break e}Zt=te.return}}var qe=y.current;for(Zt=qe;Zt!==null;){ve=Zt;var yt=ve.child;if((ve.subtreeFlags&2064)!==0&&yt!==null)yt.return=ve,Zt=yt;else e:for(ve=qe;Zt!==null;){if(Ge=Zt,(Ge.flags&2048)!==0)try{switch(Ge.tag){case 0:case 11:case 15:jd(9,Ge)}}catch(_r){Mn(Ge,Ge.return,_r)}if(Ge===ve){Zt=null;break e}var rr=Ge.sibling;if(rr!==null){rr.return=Ge.return,Zt=rr;break e}Zt=Ge.return}}if(Br=K,na(),ci&&typeof ci.onPostCommitFiberRoot=="function")try{ci.onPostCommitFiberRoot(fc,y)}catch{}z=!0}return z}finally{Qr=O,ts.transition=b}}return!1}function Hp(y,b,O){b=gu(O,b),b=Yo(y,b,1),y=Il(y,b,1),b=In(),y!==null&&(Zi(y,1,b),_a(y,b))}function Mn(y,b,O){if(y.tag===3)Hp(y,y,O);else for(;b!==null;){if(b.tag===3){Hp(b,y,O);break}else if(b.tag===1){var z=b.stateNode;if(typeof b.type.getDerivedStateFromError=="function"||typeof z.componentDidCatch=="function"&&(Eo===null||!Eo.has(z))){y=gu(O,y),y=ag(b,y,1),b=Il(b,y,1),y=In(),b!==null&&(Zi(b,1,y),_a(b,y));break}}b=b.return}}function I1(y,b,O){var z=y.pingCache;z!==null&&z.delete(b),b=In(),y.pingedLanes|=y.suspendedLanes&O,_n===y&&(cs&O)===O&&(Wn===4||Wn===3&&(cs&130023424)===cs&&500>Hs()-Id?Ac(y,0):Rd|=O),_a(y,b)}function M1(y,b){b===0&&((y.mode&1)===0?b=1:(b=es,es<<=1,(es&130023424)===0&&(es=4194304)));var O=In();y=Co(y,b),y!==null&&(Zi(y,b,O),_a(y,O))}function L1(y){var b=y.memoizedState,O=0;b!==null&&(O=b.retryLane),M1(y,O)}function V2(y,b){var O=0;switch(y.tag){case 13:var z=y.stateNode,K=y.memoizedState;K!==null&&(O=K.retryLane);break;case 19:z=y.stateNode;break;default:throw Error(i(314))}z!==null&&z.delete(b),M1(y,O)}var B1;B1=function(y,b,O){if(y!==null)if(y.memoizedProps!==b.pendingProps||br.current)Os=!0;else{if((y.lanes&O)===0&&(b.flags&128)===0)return Os=!1,Sc(y,b,O);Os=(y.flags&131072)!==0}else Os=!1,Rn&&(b.flags&1048576)!==0&&f1(b,tu,b.index);switch(b.lanes=0,b.tag){case 2:var z=b.type;nh(y,b),y=b.pendingProps;var K=An(b,xr.current);wd(b,O),K=Jf(null,b,z,y,K,O);var te=X0();return b.flags|=1,typeof K=="object"&&K!==null&&typeof K.render=="function"&&K.$$typeof===void 0?(b.tag=1,b.memoizedState=null,b.updateQueue=null,et(z)?(te=!0,Et(b)):te=!1,b.memoizedState=K.state!==null&&K.state!==void 0?K.state:null,pp(b),K.updater=eh,b.stateNode=K,K._reactInternals=b,qo(b,z,y,O),b=ya(null,b,z,!0,te,O)):(b.tag=0,Rn&&te&&Hf(b),Vs(null,b,K,O),b=b.child),b;case 16:z=b.elementType;e:{switch(nh(y,b),y=b.pendingProps,K=z._init,z=K(z._payload),b.type=z,K=b.tag=K2(z),y=Di(z,y),K){case 0:b=Xo(null,b,z,y,O);break e;case 1:b=ia(null,b,z,y,O);break e;case 11:b=ig(null,b,z,y,O);break e;case 14:b=mu(null,b,z,Di(z.type,y),O);break e}throw Error(i(306,z,""))}return b;case 0:return z=b.type,K=b.pendingProps,K=b.elementType===z?K:Di(z,K),Xo(y,b,z,K,O);case 1:return z=b.type,K=b.pendingProps,K=b.elementType===z?K:Di(z,K),ia(y,b,z,K,O);case 3:e:{if(_c(b),y===null)throw Error(i(387));z=b.pendingProps,te=b.memoizedState,K=te.element,w1(y,b),mc(b,z,null,O);var ve=b.memoizedState;if(z=ve.element,ge&&te.isDehydrated)if(te={element:z,isDehydrated:!1,cache:ve.cache,pendingSuspenseBoundaries:ve.pendingSuspenseBoundaries,transitions:ve.transitions},b.updateQueue.baseState=te,b.memoizedState=te,b.flags&256){K=gu(Error(i(423)),b),b=pu(y,b,z,O,K);break e}else if(z!==K){K=gu(Error(i(424)),b),b=pu(y,b,z,O,K);break e}else for(ge&&(Ba=xe(b.stateNode.containerInfo),sa=b,Rn=!0,ko=null,Vf=!1),O=y1(b,null,z,O),b.child=O;O;)O.flags=O.flags&-3|4096,O=O.sibling;else{if(ru(),z===K){b=Bl(y,b,O);break e}Vs(y,b,z,O)}b=b.child}return b;case 5:return xp(b),y===null&&dp(b),z=b.type,K=b.pendingProps,te=y!==null?y.memoizedProps:null,ve=K.children,J(z,K)?ve=null:te!==null&&J(z,te)&&(b.flags|=32),bn(y,b),Vs(y,b,ve,O),b.child;case 6:return y===null&&dp(b),null;case 13:return Dp(y,b,O);case 4:return q0(b,b.stateNode.containerInfo),z=b.pendingProps,y===null?b.child=su(b,null,z,O):Vs(y,b,z,O),b.child;case 11:return z=b.type,K=b.pendingProps,K=b.elementType===z?K:Di(z,K),ig(y,b,z,K,O);case 7:return Vs(y,b,b.pendingProps,O),b.child;case 8:return Vs(y,b,b.pendingProps.children,O),b.child;case 12:return Vs(y,b,b.pendingProps.children,O),b.child;case 10:e:{if(z=b.type._context,K=b.pendingProps,te=b.memoizedProps,ve=K.value,v1(b,z,ve),te!==null)if(bo(te.value,ve)){if(te.children===K.children&&!br.current){b=Bl(y,b,O);break e}}else for(te=b.child,te!==null&&(te.return=b);te!==null;){var Ge=te.dependencies;if(Ge!==null){ve=te.child;for(var mt=Ge.firstContext;mt!==null;){if(mt.context===z){if(te.tag===1){mt=Rl(-1,O&-O),mt.tag=2;var Wt=te.updateQueue;if(Wt!==null){Wt=Wt.shared;var lr=Wt.pending;lr===null?mt.next=mt:(mt.next=lr.next,lr.next=mt),Wt.pending=mt}}te.lanes|=O,mt=te.alternate,mt!==null&&(mt.lanes|=O),au(te.return,O,b),Ge.lanes|=O;break}mt=mt.next}}else if(te.tag===10)ve=te.type===b.type?null:te.child;else if(te.tag===18){if(ve=te.return,ve===null)throw Error(i(341));ve.lanes|=O,Ge=ve.alternate,Ge!==null&&(Ge.lanes|=O),au(ve,O,b),ve=te.sibling}else ve=te.child;if(ve!==null)ve.return=te;else for(ve=te;ve!==null;){if(ve===b){ve=null;break}if(te=ve.sibling,te!==null){te.return=ve.return,ve=te;break}ve=ve.return}te=ve}Vs(y,b,K.children,O),b=b.child}return b;case 9:return K=b.type,z=b.pendingProps.children,wd(b,O),K=Pi(K),z=z(K),b.flags|=1,Vs(y,b,z,O),b.child;case 14:return z=b.type,K=Di(z,b.pendingProps),K=Di(z.type,K),mu(y,b,z,K,O);case 15:return Ll(y,b,b.type,b.pendingProps,O);case 17:return z=b.type,K=b.pendingProps,K=b.elementType===z?K:Di(z,K),nh(y,b),b.tag=1,et(z)?(y=!0,Et(b)):y=!1,wd(b,O),E1(b,z,K),qo(b,z,K,O),ya(null,b,z,!0,y,O);case 19:return lg(y,b,O);case 22:return Pn(y,b,O)}throw Error(i(156,b.tag))};function Gp(y,b){return Ko(y,b)}function $1(y,b,O,z){this.tag=y,this.key=O,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=b,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=z,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $i(y,b,O,z){return new $1(y,b,O,z)}function Ud(y){return y=y.prototype,!(!y||!y.isReactComponent)}function K2(y){if(typeof y=="function")return Ud(y)?1:0;if(y!=null){if(y=y.$$typeof,y===v)return 11;if(y===k)return 14}return 2}function Pc(y,b){var O=y.alternate;return O===null?(O=$i(y.tag,b,y.key,y.mode),O.elementType=y.elementType,O.type=y.type,O.stateNode=y.stateNode,O.alternate=y,y.alternate=O):(O.pendingProps=b,O.type=y.type,O.flags=0,O.subtreeFlags=0,O.deletions=null),O.flags=y.flags&14680064,O.childLanes=y.childLanes,O.lanes=y.lanes,O.child=y.child,O.memoizedProps=y.memoizedProps,O.memoizedState=y.memoizedState,O.updateQueue=y.updateQueue,b=y.dependencies,O.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext},O.sibling=y.sibling,O.index=y.index,O.ref=y.ref,O}function _g(y,b,O,z,K,te){var ve=2;if(z=y,typeof y=="function")Ud(y)&&(ve=1);else if(typeof y=="string")ve=5;else e:switch(y){case d:return oa(O.children,K,te,b);case h:ve=8,K|=8;break;case g:return y=$i(12,O,b,K|2),y.elementType=g,y.lanes=te,y;case w:return y=$i(13,O,b,K),y.elementType=w,y.lanes=te,y;case C:return y=$i(19,O,b,K),y.elementType=C,y.lanes=te,y;case N:return zd(O,K,te,b);default:if(typeof y=="object"&&y!==null)switch(y.$$typeof){case p:ve=10;break e;case x:ve=9;break e;case v:ve=11;break e;case k:ve=14;break e;case _:ve=16,z=null;break e}throw Error(i(130,y==null?y:typeof y,""))}return b=$i(ve,O,b,K),b.elementType=y,b.type=z,b.lanes=te,b}function oa(y,b,O,z){return y=$i(7,y,z,b),y.lanes=O,y}function zd(y,b,O,z){return y=$i(22,y,z,b),y.elementType=N,y.lanes=O,y.stateNode={isHidden:!1},y}function Wd(y,b,O){return y=$i(6,y,null,b),y.lanes=O,y}function Sg(y,b,O){return b=$i(4,y.children!==null?y.children:[],y.key,b),b.lanes=O,b.stateNode={containerInfo:y.containerInfo,pendingChildren:null,implementation:y.implementation},b}function U1(y,b,O,z,K){this.tag=b,this.containerInfo=y,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=le,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=uc(0),this.expirationTimes=uc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uc(0),this.identifierPrefix=z,this.onRecoverableError=K,ge&&(this.mutableSourceEagerHydrationData=null)}function Vp(y,b,O,z,K,te,ve,Ge,mt){return y=new U1(y,b,O,Ge,mt),b===1?(b=1,te===!0&&(b|=8)):b=0,te=$i(3,null,null,b),y.current=te,te.stateNode=y,te.memoizedState={element:z,isDehydrated:O,cache:null,transitions:null,pendingSuspenseBoundaries:null},pp(te),y}function kg(y){if(!y)return vt;y=y._reactInternals;e:{if(j(y)!==y||y.tag!==1)throw Error(i(170));var b=y;do{switch(b.tag){case 3:b=b.stateNode.context;break e;case 1:if(et(b.type)){b=b.stateNode.__reactInternalMemoizedMergedChildContext;break e}}b=b.return}while(b!==null);throw Error(i(171))}if(y.tag===1){var O=y.type;if(et(O))return Le(y,O,b)}return b}function Cu(y){var b=y._reactInternals;if(b===void 0)throw typeof y.render=="function"?Error(i(188)):(y=Object.keys(y).join(","),Error(i(268,y)));return y=Y(b),y===null?null:y.stateNode}function Cg(y,b){if(y=y.memoizedState,y!==null&&y.dehydrated!==null){var O=y.retryLane;y.retryLane=O!==0&&O<b?O:b}}function Hd(y,b){Cg(y,b),(y=y.alternate)&&Cg(y,b)}function q2(y){return y=Y(y),y===null?null:y.stateNode}function z1(){return null}return r.attemptContinuousHydration=function(y){if(y.tag===13){var b=Co(y,134217728);if(b!==null){var O=In();ba(b,y,134217728,O)}Hd(y,134217728)}},r.attemptDiscreteHydration=function(y){if(y.tag===13){var b=Co(y,1);if(b!==null){var O=In();ba(b,y,1,O)}Hd(y,1)}},r.attemptHydrationAtCurrentPriority=function(y){if(y.tag===13){var b=Rs(y),O=Co(y,b);if(O!==null){var z=In();ba(O,y,b,z)}Hd(y,b)}},r.attemptSynchronousHydration=function(y){switch(y.tag){case 3:var b=y.stateNode;if(b.current.memoizedState.isDehydrated){var O=Jr(b.pendingLanes);O!==0&&(Vo(b,O|1),_a(b,Hs()),(Br&6)===0&&(vn(),na()))}break;case 13:Bp(function(){var z=Co(y,1);if(z!==null){var K=In();ba(z,y,1,K)}}),Hd(y,1)}},r.batchedUpdates=function(y,b){var O=Br;Br|=1;try{return y(b)}finally{Br=O,Br===0&&(vn(),xd&&na())}},r.createComponentSelector=function(y){return{$$typeof:$l,value:y}},r.createContainer=function(y,b,O,z,K,te,ve){return Vp(y,b,!1,null,O,z,K,te,ve)},r.createHasPseudoClassSelector=function(y){return{$$typeof:Wa,value:y}},r.createHydrationContainer=function(y,b,O,z,K,te,ve,Ge,mt){return y=Vp(O,z,!0,y,K,te,ve,Ge,mt),y.context=kg(null),O=y.current,z=In(),K=Rs(O),te=Rl(z,K),te.callback=b??null,Il(O,te,K),y.current.lanes=K,Zi(y,K,z),_a(y,z),y},r.createPortal=function(y,b,O){var z=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:z==null?null:""+z,children:y,containerInfo:b,implementation:O}},r.createRoleSelector=function(y){return{$$typeof:Qo,value:y}},r.createTestNameSelector=function(y){return{$$typeof:Fd,value:y}},r.createTextSelector=function(y){return{$$typeof:oh,value:y}},r.deferredUpdates=function(y){var b=Qr,O=ts.transition;try{return ts.transition=null,Qr=16,y()}finally{Qr=b,ts.transition=O}},r.discreteUpdates=function(y,b,O,z,K){var te=Qr,ve=ts.transition;try{return ts.transition=null,Qr=1,y(b,O,z,K)}finally{Qr=te,ts.transition=ve,Br===0&&vn()}},r.findAllNodes=tl,r.findBoundingRects=function(y,b){if(!wt)throw Error(i(363));b=tl(y,b),y=[];for(var O=0;O<b.length;O++)y.push(lt(b[O]));for(b=y.length-1;0<b;b--){O=y[b];for(var z=O.x,K=z+O.width,te=O.y,ve=te+O.height,Ge=b-1;0<=Ge;Ge--)if(b!==Ge){var mt=y[Ge],Wt=mt.x,lr=Wt+mt.width,Mr=mt.y,tr=Mr+mt.height;if(z>=Wt&&te>=Mr&&K<=lr&&ve<=tr){y.splice(b,1);break}else if(z!==Wt||O.width!==mt.width||tr<te||Mr>ve){if(!(te!==Mr||O.height!==mt.height||lr<z||Wt>K)){Wt>z&&(mt.width+=Wt-z,mt.x=z),lr<K&&(mt.width=K-Wt),y.splice(b,1);break}}else{Mr>te&&(mt.height+=Mr-te,mt.y=te),tr<ve&&(mt.height=ve-Mr),y.splice(b,1);break}}}return y},r.findHostInstance=Cu,r.findHostInstanceWithNoPortals=function(y){return y=U(y),y=y!==null?ae(y):null,y===null?null:y.stateNode},r.findHostInstanceWithWarning=function(y){return Cu(y)},r.flushControlled=function(y){var b=Br;Br|=1;var O=ts.transition,z=Qr;try{ts.transition=null,Qr=1,y()}finally{Qr=z,ts.transition=O,Br=b,Br===0&&(vn(),na())}},r.flushPassiveEffects=Wl,r.flushSync=Bp,r.focusWithin=function(y,b){if(!wt)throw Error(i(363));for(y=Zo(y),b=el(y,b),b=Array.from(b),y=0;y<b.length;){var O=b[y++];if(!Rt(O)){if(O.tag===5&&Qe(O.stateNode))return!0;for(O=O.child;O!==null;)b.push(O),O=O.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Qr},r.getFindAllNodesFailureDescription=function(y,b){if(!wt)throw Error(i(363));var O=0,z=[];y=[Zo(y),0];for(var K=0;K<y.length;){var te=y[K++],ve=y[K++],Ge=b[ve];if((te.tag!==5||!Rt(te))&&(lh(te,Ge)&&(z.push(mg(Ge)),ve++,ve>O&&(O=ve)),ve<b.length))for(te=te.child;te!==null;)y.push(te,ve),te=te.sibling}if(O<b.length){for(y=[];O<b.length;O++)y.push(mg(b[O]));return`findAllNodes was able to match part of the selector:
  `+(z.join(" > ")+`

No matching component was found for:
  `)+y.join(" > ")}return null},r.getPublicRootInstance=function(y){if(y=y.current,!y.child)return null;switch(y.child.tag){case 5:return ne(y.child.stateNode);default:return y.child.stateNode}},r.injectIntoDevTools=function(y){if(y={bundleType:y.bundleType,version:y.version,rendererPackageName:y.rendererPackageName,rendererConfig:y.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:q2,findFiberByHostInstance:y.findFiberByHostInstance||z1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")y=!1;else{var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)y=!0;else{try{fc=b.inject(y),ci=b}catch{}y=!!b.checkDCE}}return y},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(y,b,O,z){if(!wt)throw Error(i(363));y=tl(y,b);var K=Re(y,O,z).disconnect;return{disconnect:function(){K()}}},r.registerMutableSourceForHydration=function(y,b){var O=b._getVersion;O=O(b._source),y.mutableSourceEagerHydrationData==null?y.mutableSourceEagerHydrationData=[b,O]:y.mutableSourceEagerHydrationData.push(b,O)},r.runWithPriority=function(y,b){var O=Qr;try{return Qr=y,b()}finally{Qr=O}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(y,b,O,z){var K=b.current,te=In(),ve=Rs(K);return O=kg(O),b.context===null?b.context=O:b.pendingContext=O,b=Rl(te,ve),b.payload={element:y},z=z===void 0?null:z,z!==null&&(b.callback=z),y=Il(K,b,ve),y!==null&&(ba(y,K,ve,te),qf(y,K,ve)),ve},r}),YS}var mP;function yZ(){return mP||(mP=1,qS.exports=xZ()),qS.exports}var vZ=yZ();const wZ=Nl(vZ);var XS={exports:{}},Zd={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pP;function bZ(){return pP||(pP=1,Zd.ConcurrentRoot=1,Zd.ContinuousEventPriority=4,Zd.DefaultEventPriority=16,Zd.DiscreteEventPriority=1,Zd.IdleEventPriority=536870912,Zd.LegacyRoot=0),Zd}var xP;function _Z(){return xP||(xP=1,XS.exports=bZ()),XS.exports}var vL=_Z(),SZ=Xr();const yP={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let vP=!1,wP=!1;const ZN=".react-konva-event";let wL=!1;function kZ(e){wL=e}const CZ=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,TZ=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,EZ={};function B_(e,t,r=EZ){if(!vP&&"zIndex"in t&&(console.warn(TZ),vP=!0),!wP&&t.draggable){var n=t.x!==void 0||t.y!==void 0,s=t.onDragEnd||t.onDragMove;n&&!s&&(console.warn(CZ),wP=!0)}for(var a in r)if(!yP[a]){var i=a.slice(0,2)==="on",o=r[a]!==t[a];if(i&&o){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),e.off(l,r[a])}var u=!t.hasOwnProperty(a);u&&e.setAttr(a,void 0)}var d=wL||t._useStrictMode,h={},g=!1;const p={};for(var a in t)if(!yP[a]){var i=a.slice(0,2)==="on",x=r[a]!==t[a];if(i&&x){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),t[a]&&(p[l]=t[a])}!i&&(t[a]!==r[a]||d&&t[a]!==e.getAttr(a))&&(g=!0,h[a]=t[a])}g&&(e.setAttrs(h),jf(e));for(var l in p)e.on(l+ZN,p[l])}function jf(e){if(!SZ.Konva.autoDrawEnabled){var t=e.getLayer()||e.getStage();t&&t.batchDraw()}}var JS=dN();const bL={},NZ={};$y.Node.prototype._applyProps=B_;function AZ(e,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}e.add(t),jf(e)}function jZ(e,t,r){let n=$y[e];n||(console.error(`Konva has no node with the type ${e}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${e}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=$y.Group);const s={},a={};for(var i in t){var o=i.slice(0,2)==="on";o?a[i]=t[i]:s[i]=t[i]}const l=new n(s);return B_(l,a),l}function PZ(e,t,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${e}"`)}function FZ(e,t,r){return!1}function OZ(e){return e}function DZ(){return null}function RZ(){return null}function IZ(e,t,r,n){return NZ}function MZ(){}function LZ(e){}function BZ(e,t){return!1}function $Z(){return bL}function UZ(){return bL}const zZ=setTimeout,WZ=clearTimeout,HZ=-1;function GZ(e,t){return!1}const VZ=!1,KZ=!0,qZ=!0;function YZ(e,t){t.parent===e?t.moveToTop():e.add(t),jf(e)}function XZ(e,t){t.parent===e?t.moveToTop():e.add(t),jf(e)}function _L(e,t,r){t._remove(),e.add(t),t.setZIndex(r.getZIndex()),jf(e)}function JZ(e,t,r){_L(e,t,r)}function QZ(e,t){t.destroy(),t.off(ZN),jf(e)}function ZZ(e,t){t.destroy(),t.off(ZN),jf(e)}function eee(e,t,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function tee(e,t,r){}function ree(e,t,r,n,s){B_(e,s,n)}function nee(e){e.hide(),jf(e)}function see(e){}function aee(e,t){(t.visible==null||t.visible)&&e.show()}function iee(e,t){}function oee(e){}function lee(){}const cee=()=>vL.DefaultEventPriority,uee=Object.freeze(Object.defineProperty({__proto__:null,appendChild:YZ,appendChildToContainer:XZ,appendInitialChild:AZ,cancelTimeout:WZ,clearContainer:oee,commitMount:tee,commitTextUpdate:eee,commitUpdate:ree,createInstance:jZ,createTextInstance:PZ,detachDeletedInstance:lee,finalizeInitialChildren:FZ,getChildHostContext:UZ,getCurrentEventPriority:cee,getPublicInstance:OZ,getRootHostContext:$Z,hideInstance:nee,hideTextInstance:see,idlePriority:JS.unstable_IdlePriority,insertBefore:_L,insertInContainerBefore:JZ,isPrimaryRenderer:VZ,noTimeout:HZ,now:JS.unstable_now,prepareForCommit:DZ,preparePortalMount:RZ,prepareUpdate:IZ,removeChild:QZ,removeChildFromContainer:ZZ,resetAfterCommit:MZ,resetTextContent:LZ,run:JS.unstable_runWithPriority,scheduleTimeout:zZ,shouldDeprioritizeSubtree:BZ,shouldSetTextContent:GZ,supportsMutation:qZ,unhideInstance:aee,unhideTextInstance:iee,warnsIfNotActing:KZ},Symbol.toStringTag,{value:"Module"}));var dee=Object.defineProperty,fee=Object.defineProperties,hee=Object.getOwnPropertyDescriptors,bP=Object.getOwnPropertySymbols,gee=Object.prototype.hasOwnProperty,mee=Object.prototype.propertyIsEnumerable,_P=(e,t,r)=>t in e?dee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,SP=(e,t)=>{for(var r in t||(t={}))gee.call(t,r)&&_P(e,r,t[r]);if(bP)for(var r of bP(t))mee.call(t,r)&&_P(e,r,t[r]);return e},pee=(e,t)=>fee(e,hee(t)),kP,CP;typeof window<"u"&&((kP=window.document)!=null&&kP.createElement||((CP=window.navigator)==null?void 0:CP.product)==="ReactNative")?S.useLayoutEffect:S.useEffect;function SL(e,t,r){if(!e)return;if(r(e)===!0)return e;let n=e.child;for(;n;){const s=SL(n,t,r);if(s)return s;n=n.sibling}}function kL(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const TP=console.error;console.error=function(){const e=[...arguments].join("");if(e?.startsWith("Warning:")&&e.includes("useContext")){console.error=TP;return}return TP.apply(this,arguments)};const e4=kL(S.createContext(null));class CL extends S.Component{render(){return S.createElement(e4.Provider,{value:this._reactInternals},this.props.children)}}function xee(){const e=S.useContext(e4);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=S.useId();return S.useMemo(()=>{for(const n of[e,e?.alternate]){if(!n)continue;const s=SL(n,!1,a=>{let i=a.memoizedState;for(;i;){if(i.memoizedState===t)return!0;i=i.next}});if(s)return s}},[e,t])}function yee(){const e=xee(),[t]=S.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&typeof r.type=="object"){const s=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;s&&s!==e4&&!t.has(s)&&t.set(s,S.useContext(kL(s)))}r=r.return}return t}function TL(){const e=yee();return S.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>S.createElement(t,null,S.createElement(r.Provider,pee(SP({},n),{value:e.get(r)}))),t=>S.createElement(CL,SP({},t))),[e])}function vee(e){const t=Ss.useRef({});return Ss.useLayoutEffect(()=>{t.current=e}),Ss.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const wee=e=>{const t=Ss.useRef(null),r=Ss.useRef(null),n=Ss.useRef(null),s=vee(e),a=TL(),i=o=>{const{forwardedRef:l}=e;l&&(typeof l=="function"?l(o):l.current=o)};return Ss.useLayoutEffect(()=>(r.current=new $y.Stage({width:e.width,height:e.height,container:t.current}),i(r.current),n.current=Xg.createContainer(r.current,vL.LegacyRoot,!1,null),Xg.updateContainer(Ss.createElement(a,{},e.children),n.current),()=>{$y.isBrowser&&(i(null),Xg.updateContainer(null,n.current,null),r.current.destroy())}),[]),Ss.useLayoutEffect(()=>{i(r.current),B_(r.current,e,s),Xg.updateContainer(Ss.createElement(a,{},e.children),n.current,null)}),Ss.createElement("div",{ref:t,id:e.id,accessKey:e.accessKey,className:e.className,role:e.role,style:e.style,tabIndex:e.tabIndex,title:e.title})},Xh="Layer",bee="FastLayer",Zl="Group",_ee="Label",Pa="Rect",hf="Circle",See="Ellipse",kee="Wedge",Ja="Line",Cee="Sprite",EL="Image",Bc="Text",Tee="TextPath",Eee="Star",Nee="Ring",Aee="Arc",jee="Tag",Pee="Path",Fee="RegularPolygon",PT="Arrow",Oee="Shape",NL="Transformer",Dee="18.2.13",Xg=wZ(uee);Xg.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Ss.version,rendererPackageName:"react-konva"});const Jh=Ss.forwardRef((e,t)=>Ss.createElement(CL,{},Ss.createElement(wee,{...e,forwardedRef:t}))),Ree=kZ,Iee=Object.freeze(Object.defineProperty({__proto__:null,Arc:Aee,Arrow:PT,Circle:hf,Ellipse:See,FastLayer:bee,Group:Zl,Image:EL,KonvaRenderer:Xg,Label:_ee,Layer:Xh,Line:Ja,Path:Pee,Rect:Pa,RegularPolygon:Fee,Ring:Nee,Shape:Oee,Sprite:Cee,Stage:Jh,Star:Eee,Tag:jee,Text:Bc,TextPath:Tee,Transformer:NL,Wedge:kee,useContextBridge:TL,useStrictMode:Ree,version:Dee},Symbol.toStringTag,{value:"Module"})),At=({children:e,hover:t=!0,className:r="",paddingClass:n="p-6",...s})=>{const a=`
    bg-white rounded-xl shadow-md border border-gray-200 ${n}
    ${t?"hover:shadow-lg hover:-translate-y-1 transition-all duration-200":""}
    ${r}
  `;return c.jsx(st.div,{className:a,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},...s,children:e})},Mee=({children:e,className:t=""})=>c.jsx("div",{className:`border-b border-gray-200 pb-4 mb-4 ${t}`,children:e}),Lee=({children:e,className:t=""})=>c.jsx("h3",{className:`text-xl font-semibold text-gray-800 ${t}`,children:e}),Bee=({children:e,className:t=""})=>c.jsx("div",{className:`py-4 ${t}`,children:e}),$ee=({children:e,className:t=""})=>c.jsx("div",{className:`border-t border-gray-200 pt-4 mt-4 ${t}`,children:e});At.Header=Mee;At.Title=Lee;At.Body=Bee;At.Footer=$ee;const da=({isOpen:e=!1,onClose:t,title:r="",children:n,size:s="medium",showCloseButton:a=!0,closeOnBackdropClick:i=!0,className:o="",...l})=>{const u=h=>{i&&h.target===h.currentTarget&&t()};Ss.useEffect(()=>{const h=x=>{x.key==="Escape"&&t()},g=window;g.__modalOpenCount||(g.__modalOpenCount=0);let p;return e&&(document.addEventListener("keydown",h),p=document.body.style.overflow,g.__modalOpenCount===0&&(document.body.style.overflow="hidden"),g.__modalOpenCount+=1),()=>{document.removeEventListener("keydown",h),g.__modalOpenCount&&g.__modalOpenCount>0&&(g.__modalOpenCount-=1),g.__modalOpenCount===0&&(p!==void 0?document.body.style.overflow=p||"":document.body.style.overflow="")}},[e,t]);const d={small:"max-w-md",medium:"max-w-lg",large:"max-w-4xl"};return e?c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:u,role:"dialog","aria-modal":"true","aria-label":r,...l,children:c.jsxs("div",{className:`
          bg-white rounded-xl shadow-md border border-gray-200 p-8
          hover:shadow-lg hover:-translate-y-1 transition-all duration-200
          w-full ${d[s]} mx-auto
          ${o}
        `,onClick:h=>h.stopPropagation(),children:[(r||a)&&c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r&&c.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:r}),a&&c.jsx("button",{onClick:t,className:"text-red-500 hover:text-red-700 hover:bg-red-50 transition-all duration-200 rounded-full p-2 text-2xl font-bold leading-none","aria-label":"Close modal",children:""})]}),c.jsx("div",{className:"space-y-6",children:n})]})}):null},Uee=e=>{const[t,r]=S.useState({width:800,height:600}),n=S.useRef(null),s=S.useCallback(()=>{if(e.current){e.current.getBoundingClientRect();const a=Math.min(1200,window.innerWidth*.8),i=Math.min(800,window.innerHeight*.6),o=4/3;let l=a,u=l/o;u>i&&(u=i,l=u*o),r({width:l,height:u})}},[e]);return S.useEffect(()=>(s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)),[s]),{canvasSize:t,stageRef:n,updateCanvasSize:s}},zee=e=>{const[t,r]=S.useState({width:800,height:600}),[n,s]=S.useState({}),a=S.useCallback(()=>{if(e.current){const o=e.current.getBoundingClientRect();r({width:o.width,height:Math.max(400,o.height)})}},[e]),i=S.useCallback(o=>o<480?{stageHeight:300,blockMinSize:50,fontSize:12,padding:10,touchTargetSize:44,arrowThickness:4}:o<768?{stageHeight:400,blockMinSize:60,fontSize:14,padding:15,touchTargetSize:44,arrowThickness:4}:o<1024?{stageHeight:500,blockMinSize:70,fontSize:16,padding:20,touchTargetSize:40,arrowThickness:3}:{stageHeight:600,blockMinSize:80,fontSize:18,padding:25,touchTargetSize:32,arrowThickness:2},[]);return S.useEffect(()=>{const o=i(t.width);s(o)},[t.width,i]),S.useEffect(()=>{a();const o=()=>{a()};return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[a]),{containerSize:t,responsiveSettings:n,updateSize:a}},EP={convertToOriginal:(e,t,r)=>r?{x:Number(((e-r.x)/r.scale).toFixed(4)),y:Number(((t-r.y)/r.scale).toFixed(4))}:{x:e,y:t},convertToCanvas:(e,t,r)=>r?{x:Number((r.x+e*r.scale).toFixed(4)),y:Number((r.y+t*r.scale).toFixed(4))}:{x:e,y:t},isPointInImage:(e,t)=>t?e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height:!1,calculateImageScale:(e,t)=>{if(!e||!t)return 1;const r=40,n=t.width-r,s=t.height-r;return Math.min(n/e.width,s/e.height)},calculateImageInfo:(e,t)=>{if(!e||!t)return null;const r=40,n=t.width-r,s=t.height-r,a=Math.min(n/e.width,s/e.height),i=e.width*a,o=e.height*a,l=(t.width-i)/2,u=(t.height-o)/2;return{x:l,y:u,width:i,height:o,scale:a,originalWidth:e.width,originalHeight:e.height}}},Wee=e=>{const t=S.useCallback((n,s)=>EP.convertToOriginal(n,s,e),[e]),r=S.useCallback((n,s)=>EP.convertToCanvas(n,s,e),[e]);return{convertToOriginal:t,convertToCanvas:r}},zx={create:(e,t,r,n,s)=>({id:s,x:e-r/2,y:t-n/2,width:Math.max(r,30),height:Math.max(n,10),fill:"rgba(0, 123, 255, 0.15)",stroke:"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),validate:e=>e.width>0&&e.height>0,findAtPosition:(e,t,r)=>e.find(n=>t>=n.x&&t<=n.x+n.width&&r>=n.y&&r<=n.y+n.height),generateId:()=>`block_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},Lg={create:(e,t,r,n,s,a,i)=>({id:i,startX:e,startY:t,endX:r,endY:n,startBlock:s,endBlock:a,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,pointerLength:10,pointerWidth:10}),snapToNearestBlock:(e,t,r,n=60)=>{let s=null,a=1/0;for(const i of r){const o=i.x+i.width/2,l=i.y+i.height/2,u=Math.sqrt(Math.pow(e-o,2)+Math.pow(t-l,2));u<=n&&u<a&&(a=u,s=i)}return s?{x:s.x+s.width/2,y:s.y+s.height/2,blockId:s.id,block:s,distance:a}:null},validate:(e,t,r,n,s)=>Lg.snapToNearestBlock(e,t,s)!==null,generateId:()=>`arrow_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},QS={create:(e,t,r)=>({id:r,blockId:e,word:t}),update:(e,t,r)=>e.map(n=>n.blockId===t?{...n,word:r}:n),delete:(e,t)=>e.filter(r=>r.blockId!==t),generateId:e=>`word_${e}`,validate:e=>e&&e.trim().length>0},Hee=async e=>{const t=[];if(e.size>512e3){const n=(e.size/1024).toFixed(1);t.push(`Image is too large (${n}KB). Maximum allowed size is 500KB. Please compress or resize your image.`)}return new Promise(n=>{const s=new Image;s.onload=()=>{(s.width>4e3||s.height>4e3)&&t.push(`Image is too large (${s.width}x${s.height} pixels). Maximum allowed dimensions are 4000x4000 pixels. Please resize your image.`),n({valid:t.length===0,errors:t,dimensions:{width:s.width,height:s.height}})},s.onerror=()=>{t.push("Invalid image file"),n({valid:!1,errors:t})},s.src=URL.createObjectURL(e)})},Gee=(e,t=500)=>new Promise(r=>{const n=document.createElement("canvas"),s=n.getContext("2d"),a=new Image;a.onload=()=>{let{width:i,height:o}=a;const l=2e3;if(i>l||o>l){const h=Math.min(l/i,l/o);i*=h,o*=h}n.width=i,n.height=o,s.drawImage(a,0,0,i,o);let u=.8;const d=()=>{n.toBlob(h=>{h.size<=t*1024||u<=.1?r(h):(u-=.1,d())},"image/jpeg",u)};d()},a.onerror=()=>{r(e)},a.src=URL.createObjectURL(e)}),Vee=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=s=>t(s.target.result),n.onerror=s=>r(s),n.readAsDataURL(e)}),Kee=()=>{const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);return{blockMinSize:e?60:40,arrowThickness:e?4:2,touchTargetSize:e?44:32,doubleTapDelay:e?300:200,isMobile:e}},qee={testData:{blocks:[],words:[],arrows:[],imageUrl:null},canvas:{size:{width:800,height:600},image:null,imageInfo:null,selectedTool:"edit"},creation:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null},ui:{selectedBlock:null,showWordPanel:!1,isLoading:!1,error:null,showImageSizeModal:!1,imageSizeError:null}},Yee=(e,t)=>{switch(t.type){case"SET_CANVAS_SIZE":return{...e,canvas:{...e.canvas,size:t.payload}};case"SET_IMAGE":return{...e,canvas:{...e.canvas,image:t.payload}};case"SET_IMAGE_INFO":return{...e,canvas:{...e.canvas,imageInfo:t.payload}};case"SET_SELECTED_TOOL":return{...e,canvas:{...e.canvas,selectedTool:t.payload}};case"ADD_BLOCK":return{...e,testData:{...e.testData,blocks:[...e.testData.blocks,t.payload]}};case"ADD_WORD":return{...e,testData:{...e.testData,words:[...e.testData.words,t.payload]}};case"ADD_ARROW":return{...e,testData:{...e.testData,arrows:[...e.testData.arrows,t.payload]}};case"UPDATE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.map(r=>r.id===t.payload.id?{...r,...t.payload.updates}:r)}};case"DELETE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.filter(r=>r.id!==t.payload),words:e.testData.words.filter(r=>r.blockId!==t.payload),arrows:e.testData.arrows.filter(r=>r.startBlock!==t.payload&&r.endBlock!==t.payload)}};case"UPDATE_WORDS":return{...e,testData:{...e.testData,words:t.payload}};case"SET_CREATION_STATE":return{...e,creation:{...e.creation,...t.payload}};case"SET_UI_STATE":return{...e,ui:{...e.ui,...t.payload}};case"SET_LOADING":return{...e,ui:{...e.ui,isLoading:t.payload}};case"SET_ERROR":return{...e,ui:{...e.ui,error:t.payload}};case"SHOW_IMAGE_SIZE_MODAL":return{...e,ui:{...e.ui,showImageSizeModal:!0,imageSizeError:t.payload}};case"HIDE_IMAGE_SIZE_MODAL":return{...e,ui:{...e.ui,showImageSizeModal:!1,imageSizeError:null}};case"RESET_TESTDATA":return{...e,testData:{blocks:[],words:[],arrows:[],imageUrl:e.testData.imageUrl}};default:return e}},Xee=({testName:e="",showQuestionCount:t=!0,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const[o,l]=S.useReducer(Yee,qee),{showNotification:u}=Da(),{makeAuthenticatedRequest:d}=Wo(),{user:h}=Qn(),g=S.useRef(null),p=S.useRef(null),x=S.useRef(null),v=S.useRef({}),w=S.useRef({}),{canvasSize:C,stageRef:k}=Uee(g),{containerSize:_,responsiveSettings:N}=zee(g),[E,P]=S.useState(null);S.useEffect(()=>{if(!o.canvas.image||!g.current)return;const W=g.current?.clientWidth||800,I=g.current?.clientHeight||600,B=W/o.canvas.image.width,q=I/o.canvas.image.height,J=Math.min(B,q,1),se=o.canvas.image.width*J,X=o.canvas.image.height*J,ie=(W-se)/2,le=(I-X)/2;P({x:ie,y:le,width:se,height:X,scaleX:J,scaleY:J,scale:J,image:o.canvas.image})},[o.canvas.image,g.current?.clientWidth,g.current?.clientHeight]);const{convertToOriginal:F}=Wee(E);S.useEffect(()=>{l({type:"SET_CANVAS_SIZE",payload:C})},[C]),S.useEffect(()=>{E&&l({type:"SET_IMAGE_INFO",payload:E})},[E]),S.useEffect(()=>{const W=x.current;if(!W)return;const I=o.ui.selectedBlock?.id?v.current[o.ui.selectedBlock.id]:null;I?(W.nodes([I]),W.getLayer()?.batchDraw()):(W.nodes([]),W.getLayer()?.batchDraw())},[o.ui.selectedBlock]);const A=S.useCallback(()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:null}}),l({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null}}),l({type:"RESET_TESTDATA"}),l({type:"SET_ERROR",payload:null})},[]),j=S.useCallback(async W=>{const I=W.target.files[0];if(!I){u("Please select a file","error");return}try{l({type:"SET_LOADING",payload:!0});const B=await Hee(I);if(!B.valid){l({type:"SHOW_IMAGE_SIZE_MODAL",payload:{errors:B.errors,fileSize:(I.size/1024).toFixed(1),dimensions:B.dimensions}});return}let q=I;if(I.size>500*1024){u("Image is large, compressing to meet size requirements...","info");try{q=await Gee(I,500);const X=(I.size/1024).toFixed(1),ie=(q.size/1024).toFixed(1);u(`Image compressed from ${X}KB to ${ie}KB`,"success")}catch{u("Failed to compress image. Please try a smaller image.","error");return}}const J=await Vee(q),se=new Image;se.crossOrigin="anonymous",se.onload=()=>{l({type:"SET_IMAGE",payload:se}),l({type:"SET_UI_STATE",payload:{imageUrl:J}}),u("Image uploaded successfully!","success")},se.onerror=()=>{u("Failed to load image","error")},se.src=J}catch(B){console.error("Image upload error:",B),u("Error processing image","error")}finally{l({type:"SET_LOADING",payload:!1})}},[u]),R=S.useCallback(W=>{const I=k.current;if(!I)return;const B=I.getPointerPosition();if(B){if(o.canvas.selectedTool==="create"){const q=zx.findAtPosition(o.testData.blocks,B.x,B.y);if(q){l({type:"SET_UI_STATE",payload:{selectedBlock:q}});return}l({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!0,blockCreationStart:{x:B.x,y:B.y}}})}else if(o.canvas.selectedTool==="edit"){const q=zx.findAtPosition(o.testData.blocks,B.x,B.y);l(q?{type:"SET_UI_STATE",payload:{selectedBlock:q}}:{type:"SET_UI_STATE",payload:{selectedBlock:null}})}else if(o.canvas.selectedTool==="arrow"){const q=W.target===I,J=zx.findAtPosition(o.testData.blocks,B.x,B.y);(q||!J)&&l({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!0,arrowStart:{x:B.x,y:B.y}}})}}},[o.canvas.selectedTool,E,o.testData.blocks]),U=S.useCallback(W=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const I=k.current;if(!I)return;const B=I.getPointerPosition();if(!B)return;const q=Math.abs(B.x-o.creation.blockCreationStart.x),J=Math.abs(B.y-o.creation.blockCreationStart.y),se=10,X=Math.max(q,se),ie=Math.max(J,se);l({type:"SET_CREATION_STATE",payload:{previewBlock:{x:Math.min(B.x,o.creation.blockCreationStart.x),y:Math.min(B.y,o.creation.blockCreationStart.y),width:X,height:ie,fill:"rgba(0, 123, 255, 0.3)",stroke:"#007bff",strokeWidth:2,dash:[5,5],opacity:.7}}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const I=k.current;if(!I)return;const B=I.getPointerPosition();if(!B)return;l({type:"SET_CREATION_STATE",payload:{previewArrow:{startX:o.creation.arrowStart.x,startY:o.creation.arrowStart.y,endX:B.x,endY:B.y,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,dash:[5,5],opacity:.7}}})}},[o.creation]),Y=S.useCallback(W=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const I=k.current;if(!I)return;const B=I.getPointerPosition();if(!B)return;const q=Math.abs(B.x-o.creation.blockCreationStart.x),J=Math.abs(B.y-o.creation.blockCreationStart.y),se=10,X=Math.max(q,se),ie=Math.max(J,se),le=Math.min(B.x,o.creation.blockCreationStart.x)+X/2,ce=Math.min(B.y,o.creation.blockCreationStart.y)+ie/2,ke=zx.generateId(),re=zx.create(le,ce,X,ie,ke),ge=QS.create(ke,`Word ${o.testData.blocks.length+1}`,QS.generateId(ke));l({type:"ADD_BLOCK",payload:re}),l({type:"ADD_WORD",payload:ge}),l({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,blockCreationStart:null,previewBlock:null}}),o.testData.blocks.length===0&&l({type:"SET_UI_STATE",payload:{showWordPanel:!0}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const I=k.current;if(!I)return;const B=I.getPointerPosition();if(!B)return;if(Lg.validate(o.creation.arrowStart.x,o.creation.arrowStart.y,B.x,B.y,o.testData.blocks)){const q=Lg.snapToNearestBlock(o.creation.arrowStart.x,o.creation.arrowStart.y,o.testData.blocks),J=Lg.snapToNearestBlock(B.x,B.y,o.testData.blocks),se=q?q.x:o.creation.arrowStart.x,X=q?q.y:o.creation.arrowStart.y,ie=J?J.x:B.x,le=J?J.y:B.y,ce=Lg.generateId(),ke=Kee(),re=Lg.create(se,X,ie,le,q?q.blockId:null,J?J.blockId:null,ce,{strokeWidth:ke.arrowThickness,isMobile:ke.isMobile});l({type:"ADD_ARROW",payload:re}),u("Arrow created successfully!","success")}else u("Arrow must start near a block!","error");l({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!1,arrowStart:null,previewArrow:null}})}},[o.creation,o.testData.blocks,u]),Z=S.useCallback(W=>{W.evt.preventDefault(),R(W)},[R]),ae=S.useCallback(W=>{W.evt.preventDefault(),U(W)},[U]),ee=S.useCallback(W=>{W.evt.preventDefault(),Y(W)},[Y]),ne=S.useCallback(async()=>{console.log(" [MatchingTestCreator] handleSaveTest clicked");const W=L();if(Object.keys(W).length>0){console.warn(" [MatchingTestCreator] Validation errors:",W),u("Please fix validation errors before saving","error");return}try{console.log(" [MatchingTestCreator] Preparing data to save...",{blocks:o.testData.blocks.length,words:o.testData.words.length,arrows:o.testData.arrows.length,imageUrl:o.ui.imageUrl?"present":"missing"}),l({type:"SET_LOADING",payload:!0});let I=o.ui.imageUrl;if(o.ui.imageUrl&&o.ui.imageUrl.startsWith("data:")){const q=await d("/.netlify/functions/upload-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataUrl:o.ui.imageUrl,folder:"matching_tests"})}),J=await q.json();if(q.ok&&J.success&&J.url)I=J.url;else throw new Error(J.message||"Upload failed")}const B=o.testData.blocks.map((q,J)=>{let se;if(E){const le=F(q.x,q.y),ce=F(q.x+q.width,q.y+q.height);se={x:le.x,y:le.y,width:Number((ce.x-le.x).toFixed(4)),height:Number((ce.y-le.y).toFixed(4))}}else se={x:Number(q.x.toFixed(4)),y:Number(q.y.toFixed(4)),width:Number(q.width.toFixed(4)),height:Number(q.height.toFixed(4))};const X=o.testData.words.find(le=>le.blockId===q.id),ie=o.testData.arrows.find(le=>le.startBlock===q.id);return{question_id:J+1,word:X?.word||`Word ${J+1}`,block_coordinates:se,has_arrow:!!ie,arrow:ie&&E?(()=>{const le=F(ie.startX,ie.startY),ce=F(ie.endX,ie.endY),ke=le.x/E.originalWidth*100,re=le.y/E.originalHeight*100,ge=ce.x/E.originalWidth*100,Ne=ce.y/E.originalHeight*100;return{start_x:Number(le.x.toFixed(4)),start_y:Number(le.y.toFixed(4)),end_x:Number(ce.x.toFixed(4)),end_y:Number(ce.y.toFixed(4)),rel_start_x:Number(ke.toFixed(4)),rel_start_y:Number(re.toFixed(4)),rel_end_x:Number(ge.toFixed(4)),rel_end_y:Number(Ne.toFixed(4)),image_width:E.originalWidth,image_height:E.originalHeight,style:ie.style||{color:"#dc3545",thickness:3}}})():null}});r&&(console.log(" [MatchingTestCreator] Calling onTestSaved with processed data"),r({success:!0,message:"Test data prepared for assignment",blocks:o.testData.blocks,words:o.testData.words,arrows:o.testData.arrows,imageUrl:I,processedQuestions:B}))}catch(I){console.error("Save error:",I),u(`Error saving test: ${I.message}`,"error")}finally{l({type:"SET_LOADING",payload:!1})}},[o.testData,o.ui.imageUrl,E,F,d,r,u,e,h]),L=S.useCallback(()=>{const W={};return e.trim()||(W.testName="Test name is required"),o.testData.blocks.length===0&&(W.blocks="At least one block is required"),W},[e,o.testData.blocks.length]),H=()=>c.jsxs("div",{className:"flex flex-wrap gap-2 p-4 bg-gray-50 border-b",children:[c.jsx(Je,{onClick:()=>l({type:"SET_SELECTED_TOOL",payload:"create"}),variant:o.canvas.selectedTool==="create"?"primary":"secondary",size:"sm",children:" Create Blocks"}),c.jsx(Je,{onClick:()=>l({type:"SET_SELECTED_TOOL",payload:"edit"}),variant:o.canvas.selectedTool==="edit"?"primary":"secondary",size:"sm",children:" Edit Blocks"}),c.jsx(Je,{onClick:()=>l({type:"SET_SELECTED_TOOL",payload:"arrow"}),variant:o.canvas.selectedTool==="arrow"?"primary":"secondary",size:"sm",children:" Draw Arrows"}),c.jsx(Je,{onClick:A,variant:"secondary",size:"sm",children:" Reset"}),c.jsx(Je,{onClick:()=>p.current?.click(),variant:"secondary",size:"sm",children:" Upload Image"}),c.jsx("div",{className:"text-xs text-gray-500 text-center col-span-full",children:"Max size: 500KB  Max dimensions: 4000x4000px"})]}),M=()=>c.jsx(Jh,{width:_.width,height:N.stageHeight,ref:k,onMouseDown:R,onMouseMove:U,onMouseUp:Y,onTouchStart:Z,onTouchMove:ae,onTouchEnd:ee,className:o.canvas.selectedTool==="arrow"||o.canvas.selectedTool==="create"?"cursor-crosshair":"cursor-default",children:c.jsxs(Xh,{children:[o.canvas.image&&E&&c.jsx(EL,{image:o.canvas.image,x:E.x,y:E.y,width:E.width,height:E.height}),o.testData.blocks.map(W=>c.jsxs(Zl,{ref:I=>{I&&(w.current[W.id]=I)},draggable:o.canvas.selectedTool==="edit",x:W.x,y:W.y,onMouseEnter:I=>{const B=I.target.getStage()?.container();B&&(B.style.cursor=o.ui.selectedBlock?.id===W.id?"nwse-resize":"move")},onMouseLeave:I=>{const B=I.target.getStage()?.container();B&&(B.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onDragStart:()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:W}})},onDragEnd:I=>{const{x:B,y:q}=I.target.position();l({type:"UPDATE_BLOCK",payload:{id:W.id,updates:{x:B,y:q}}})},onClick:()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:W}})},onTap:()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:W}})},children:[c.jsx(Pa,{ref:I=>{I&&(v.current[W.id]=I)},width:W.width,height:W.height,fill:W.fill,stroke:W.stroke,strokeWidth:W.strokeWidth,cornerRadius:W.cornerRadius,shadowColor:W.shadowColor,shadowBlur:W.shadowBlur,shadowOffset:W.shadowOffset,shadowOpacity:W.shadowOpacity,draggable:o.canvas.selectedTool==="edit",onDragEnd:I=>{const{x:B,y:q}=I.target.getParent().position();l({type:"UPDATE_BLOCK",payload:{id:W.id,updates:{x:B,y:q}}})},onMouseEnter:I=>{const B=I.target.getStage()?.container();B&&(B.style.cursor=o.ui.selectedBlock?.id===W.id?"nwse-resize":"move")},onMouseLeave:I=>{const B=I.target.getStage()?.container();B&&(B.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onTransformEnd:I=>{const B=v.current[W.id];if(!B)return;const q=Math.max(10,B.width()*B.scaleX()),J=Math.max(10,B.height()*B.scaleY());B.scaleX(1),B.scaleY(1),l({type:"UPDATE_BLOCK",payload:{id:W.id,updates:{width:q,height:J}}})}}),c.jsx(Bc,{x:2,y:2,text:`${o.testData.blocks.indexOf(W)+1}`,fontSize:Math.min(N.fontSize,Math.max(8,W.width/4)),fontFamily:"Arial",fill:"#333",fontStyle:"bold",listening:!1})]},W.id)),c.jsx(NL,{ref:x,rotateEnabled:!1,flipEnabled:!1,boundBoxFunc:(W,I)=>({...I,width:Math.max(I.width,10),height:Math.max(I.height,10)})}),o.testData.arrows.map(W=>c.jsx(PT,{points:[W.startX,W.startY,W.endX,W.endY],stroke:W.stroke,fill:W.fill,strokeWidth:W.strokeWidth||N.arrowThickness,pointerLength:W.pointerLength,pointerWidth:W.pointerWidth},W.id)),o.creation.previewBlock&&c.jsx(Pa,{x:o.creation.previewBlock.x,y:o.creation.previewBlock.y,width:o.creation.previewBlock.width,height:o.creation.previewBlock.height,fill:o.creation.previewBlock.fill,stroke:o.creation.previewBlock.stroke,strokeWidth:o.creation.previewBlock.strokeWidth,dash:o.creation.previewBlock.dash,opacity:o.creation.previewBlock.opacity}),o.creation.previewArrow&&c.jsx(PT,{points:[o.creation.previewArrow.startX,o.creation.previewArrow.startY,o.creation.previewArrow.endX,o.creation.previewArrow.endY],stroke:o.creation.previewArrow.stroke,fill:o.creation.previewArrow.fill,strokeWidth:o.creation.previewArrow.strokeWidth,dash:o.creation.previewArrow.dash,opacity:o.creation.previewArrow.opacity})]})}),V=S.useMemo(()=>o.testData.blocks.length===0?null:c.jsxs("div",{className:"word-panel bg-gray-50 border-t border-gray-200 p-4 w-full",style:{height:"min(400px, 40vh)",overflowY:"auto"},children:[c.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Words (Auto-created with blocks)"}),c.jsx("div",{className:"space-y-2",children:o.testData.words.map(W=>{const I=o.testData.blocks.find(B=>B.id===W.blockId);return c.jsxs("div",{className:"p-2 bg-white rounded border",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsxs("span",{className:"text-xs text-gray-500",children:["Block ",o.testData.blocks.indexOf(I)+1]}),c.jsx("button",{onClick:()=>l({type:"DELETE_BLOCK",payload:I.id}),className:"text-red-500 hover:text-red-700 text-xs",children:""})]}),c.jsx("input",{type:"text",value:W.word,onChange:B=>{const q=QS.update(o.testData.words,W.blockId,B.target.value);l({type:"UPDATE_WORDS",payload:q})},className:"w-full text-sm px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Enter word text"})]},W.blockId)})})]}),[o.testData.words,o.testData.blocks]);return c.jsxs(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex flex-col h-screen bg-gray-100",children:[c.jsx("div",{className:"bg-white shadow-sm border-b p-4",children:c.jsx("div",{className:"flex items-center justify-between",children:c.jsx("div",{children:c.jsx("div",{className:"mt-2 text-sm text-gray-600",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("span",{children:[c.jsx("strong",{children:"Test Name:"})," ",e||"Untitled Test"]}),c.jsxs("span",{children:[c.jsx("strong",{children:"Questions:"})," ",o.testData.blocks.length," (auto-generated from blocks)"]})]})})})})}),H(),c.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[c.jsx("div",{ref:g,className:"bg-white border overflow-auto",style:{minHeight:`${N.stageHeight}px`,maxHeight:"calc(100vh - 200px)",height:"auto",padding:`${N.padding}px`},children:M()}),V]}),c.jsx("div",{className:"bg-white border-t p-4",children:c.jsx("div",{className:"flex justify-center",children:c.jsx(Je,{onClick:ne,disabled:a||o.ui.isLoading,variant:"primary",size:"lg",children:a||o.ui.isLoading?c.jsx(Ur,{size:"sm"}):"Save Test"})})}),c.jsx("input",{ref:p,type:"file",accept:"image/*,application/pdf",onChange:j,className:"hidden"}),c.jsx(da,{isOpen:o.ui.showImageSizeModal,onClose:()=>l({type:"HIDE_IMAGE_SIZE_MODAL"}),title:" Image Too Large",size:"medium",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx("span",{className:"text-red-600 text-2xl mr-2",children:""}),c.jsx("h4",{className:"text-lg font-semibold text-red-800",children:"Image Size Issues"})]}),c.jsx("div",{className:"text-red-700",children:o.ui.imageSizeError?.errors.map((W,I)=>c.jsxs("div",{className:"mb-2",children:[" ",W]},I))})]}),c.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[c.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:" Current Image Details:"}),c.jsxs("div",{className:"text-blue-700 space-y-1",children:[c.jsxs("div",{children:[" File size: ",o.ui.imageSizeError?.fileSize,"KB"]}),o.ui.imageSizeError?.dimensions&&c.jsxs("div",{children:[" Dimensions: ",o.ui.imageSizeError.dimensions.width,"  ",o.ui.imageSizeError.dimensions.height," pixels"]})]})]}),c.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[c.jsx("h5",{className:"font-semibold text-green-800 mb-2",children:" Requirements:"}),c.jsxs("div",{className:"text-green-700 space-y-1",children:[c.jsx("div",{children:" Maximum file size: 500KB"}),c.jsx("div",{children:" Maximum dimensions: 4000  4000 pixels"}),c.jsx("div",{children:" Supported formats: All image formats (JPEG, PNG, WebP, etc.)"})]})]}),c.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[c.jsx("h5",{className:"font-semibold text-yellow-800 mb-2",children:" How to Fix:"}),c.jsxs("div",{className:"text-yellow-700 space-y-1",children:[c.jsx("div",{children:" Use an image editor to resize your image"}),c.jsx("div",{children:" Compress the image using online tools"}),c.jsx("div",{children:" Try a different image with smaller dimensions"})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[c.jsx(Je,{onClick:()=>l({type:"HIDE_IMAGE_SIZE_MODAL"}),variant:"secondary",children:"Close"}),c.jsx(Je,{onClick:()=>{l({type:"HIDE_IMAGE_SIZE_MODAL"}),p.current?.click()},variant:"primary",children:"Try Another Image"})]})]})})]})},Lm=S.createContext(null);function Jee(e,t){return{getTheme:function(){return t??null}}}function Qc(){const e=S.useContext(Lm);return e==null&&(function(t,...r){const n=new URL("https://lexical.dev/docs/error"),s=new URLSearchParams;s.append("code",t);for(const a of r)s.append("v",a);throw n.search=s.toString(),Error(`Minified Lexical error #${t}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(8),e}function $t(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const lc=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Qee=lc&&"documentMode"in document?document.documentMode:null,Lc=lc&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),Qh=lc&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),mb=!(!lc||!("InputEvent"in window)||Qee)&&"getTargetRanges"in new window.InputEvent("input"),Uy=lc&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),xm=lc&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,Zee=lc&&/Android/.test(navigator.userAgent),AL=lc&&/^(?=.*Chrome).*/i.test(navigator.userAgent),NP=lc&&Zee&&AL,pb=lc&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!AL;function jL(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}const ete=1,tte=3,rte=9,nte=11,Zh=0,PL=1,ym=2,ste=0,ate=1,ite=2,xb=4,yb=8,t4=128,ote=1792|(112|(3|xb|yb)|t4),r4=1,n4=2,s4=3,a4=4,i4=5,o4=6,$_=Uy||xm||pb?"":"",Xu=`

`,lte=Qh?"":$_,e0={bold:1,capitalize:1024,code:16,highlight:t4,italic:2,lowercase:256,strikethrough:xb,subscript:32,superscript:64,underline:yb,uppercase:512},cte={directionless:1,unmergeable:2},AP={center:n4,end:o4,justify:a4,left:r4,right:s4,start:i4},ute={[n4]:"center",[o4]:"end",[a4]:"justify",[r4]:"left",[s4]:"right",[i4]:"start"},dte={normal:0,segmented:2,token:1},fte={[ste]:"normal",[ite]:"segmented",[ate]:"token"},jP="$config";function FL(e,t,r,n,s,a){let i=e.getFirstChild();for(;i!==null;){const o=i.__key;i.__parent===t&&(bt(i)&&FL(i,o,r,n,s,a),r.has(o)||a.delete(o),s.push(o)),i=i.getNextSibling()}}const hte=100;let FT=!1,l4=0;function gte(e){l4=e.timeStamp}function ZS(e,t,r){const n=e.nodeName==="BR",s=t.__lexicalLineBreak;return s&&(e===s||n&&e.previousSibling===s)||n&&X_(e,r)!==void 0}function mte(e,t,r){const n=ic(_l(r));let s=null,a=null;n!==null&&n.anchorNode===e&&(s=n.anchorOffset,a=n.focusOffset);const i=e.nodeValue;i!==null&&N4(t,i,s,a,!1)}function pte(e,t,r){if(Dt(e)){const n=e.anchor.getNode();if(n.is(r)&&e.format!==n.getFormat())return!1}return sd(t)&&r.isAttached()}function xte(e,t,r,n){for(let s=e;s&&!xre(s);s=Ov(s)){const a=X_(s,t);if(a!==void 0){const i=Zs(a,r);if(i)return gn(i)||!qn(s)?void 0:[s,i]}else if(s===n)return[n,N9(r)]}}function OL(e,t,r){FT=!0;const n=performance.now()-l4>hte;try{Fo(e,(()=>{const s=Xt()||(function(g){return g.getEditorState().read((()=>{const p=Xt();return p!==null?p.clone():null}))})(e),a=new Map,i=e.getRootElement(),o=e._editorState,l=e._blockCursorElement;let u=!1,d="";for(let g=0;g<t.length;g++){const p=t[g],x=p.type,v=p.target,w=xte(v,e,o,i);if(!w)continue;const[C,k]=w;if(x==="characterData")n&&Jt(k)&&sd(v)&&pte(s,v,k)&&mte(v,k,e);else if(x==="childList"){u=!0;const _=p.addedNodes;for(let P=0;P<_.length;P++){const F=_[P],A=T9(F),j=F.parentNode;if(j!=null&&F!==l&&A===null&&!ZS(F,j,e)){if(Qh){const R=(qn(F)?F.innerText:null)||F.nodeValue;R&&(d+=R)}j.removeChild(F)}}const N=p.removedNodes,E=N.length;if(E>0){let P=0;for(let F=0;F<E;F++){const A=N[F];(ZS(A,v,e)||l===A)&&(v.appendChild(A),P++)}E!==P&&a.set(C,k)}}}if(a.size>0)for(const[g,p]of a)p.reconcileObservedMutation(g,e);const h=r.takeRecords();if(h.length>0){for(let g=0;g<h.length;g++){const p=h[g],x=p.addedNodes,v=p.target;for(let w=0;w<x.length;w++){const C=x[w],k=C.parentNode;k==null||C.nodeName!=="BR"||ZS(C,v,e)||k.removeChild(C)}}r.takeRecords()}s!==null&&(u&&ai(s),Qh&&F9(e)&&s.insertRawText(d))}))}finally{FT=!1}}function DL(e){const t=e._observer;t!==null&&OL(e,t.takeRecords(),t)}function RL(e){(function(t){l4===0&&_l(t).addEventListener("textInput",gte,!0)})(e),e._observer=new MutationObserver(((t,r)=>{OL(e,t,r)}))}function yte(e){const t=new Map,r=new Set;for(let n=typeof e=="function"?e:e.replace;n.prototype&&n.prototype.getType!==void 0;n=Object.getPrototypeOf(n)){const{ownNodeConfig:s}=O4(n);if(s&&s.stateConfigs)for(const a of s.stateConfigs){let i;"stateConfig"in a?(i=a.stateConfig,a.flat&&r.add(i.key)):i=a,t.set(i.key,i)}}return{flatKeys:r,sharedConfigMap:t}}let vte=class IL{constructor(t,r,n=void 0,s=new Map,a=void 0){this.node=t,this.sharedNodeState=r,this.unknownState=n,this.knownState=s;const{sharedConfigMap:i}=this.sharedNodeState,o=a!==void 0?a:(function(l,u,d){let h=d.size;if(u)for(const g in u){const p=l.get(g);p&&d.has(p)||h++}return h})(i,n,s);this.size=o}getValue(t){const r=this.knownState.get(t);if(r!==void 0)return r;this.sharedNodeState.sharedConfigMap.set(t.key,t);let n=t.defaultValue;if(this.unknownState&&t.key in this.unknownState){const s=this.unknownState[t.key];s!==void 0&&(n=t.parse(s)),this.updateFromKnown(t,n)}return n}getInternalState(){return[this.unknownState,this.knownState]}toJSON(){const t={...this.unknownState},r={};for(const[n,s]of this.knownState)n.isEqual(s,n.defaultValue)?delete t[n.key]:t[n.key]=n.unparse(s);for(const n of this.sharedNodeState.flatKeys)n in t&&(r[n]=t[n],delete t[n]);return PP(t)&&(r.$=t),r}getWritable(t){if(this.node===t)return this;const{sharedNodeState:r,unknownState:n}=this,s=new Map(this.knownState);return new IL(t,r,(function(a,i,o){let l;if(o)for(const[u,d]of Object.entries(o)){const h=a.get(u);h?i.has(h)||i.set(h,h.parse(d)):(l=l||{},l[u]=d)}return l})(r.sharedConfigMap,s,n),s,this.size)}updateFromKnown(t,r){const n=t.key;this.sharedNodeState.sharedConfigMap.set(n,t);const{knownState:s,unknownState:a}=this;s.has(t)||a&&n in a||(a&&(delete a[n],this.unknownState=PP(a)),this.size++),s.set(t,r)}updateFromUnknown(t,r){const n=this.sharedNodeState.sharedConfigMap.get(t);n?this.updateFromKnown(n,n.parse(r)):(this.unknownState=this.unknownState||{},t in this.unknownState||this.size++,this.unknownState[t]=r)}updateFromJSON(t){const{knownState:r}=this;for(const n of r.keys())r.set(n,n.defaultValue);if(this.size=r.size,this.unknownState=void 0,t)for(const[n,s]of Object.entries(t))this.updateFromUnknown(n,s)}};function wte(e){const t=e.getWritable(),r=t.__state?t.__state.getWritable(t):new vte(t,ML(t));return t.__state=r,r}function ML(e){return e.__state?e.__state.sharedNodeState:S9(Dv(),e.getType()).sharedNodeState}function PP(e){if(e)for(const t in e)return e}function FP(e,t,r){for(const[n,s]of t.knownState){if(e.has(n.key))continue;e.add(n.key);const a=r?r.getValue(n):n.defaultValue;if(a!==s&&!n.isEqual(a,s))return!0}return!1}function OP(e,t,r){const{unknownState:n}=t,s=r?r.unknownState:void 0;if(n){for(const[a,i]of Object.entries(n))if(!e.has(a)&&(e.add(a),i!==(s?s[a]:void 0)))return!0}return!1}function DP(e,t){const r=e.__state;return r&&r.node===e?r.getWritable(t):r}function RP(e,t){const r=e.__mode,n=e.__format,s=e.__style,a=t.__mode,i=t.__format,o=t.__style,l=e.__state,u=t.__state;return(r===null||r===a)&&(n===null||n===i)&&(s===null||s===o)&&(e.__state===null||l===u||(function(d,h){if(d===h)return!0;if(d&&h&&d.size!==h.size)return!1;const g=new Set;return!(d&&FP(g,d,h)||h&&FP(g,h,d)||d&&OP(g,d,h)||h&&OP(g,h,d))})(l,u))}function IP(e,t){const r=e.mergeWithSibling(t),n=gs()._normalizedNodes;return n.add(e.__key),n.add(t.__key),r}function MP(e){let t,r,n=e;if(n.__text!==""||!n.isSimpleText()||n.isUnmergeable()){for(;(t=n.getPreviousSibling())!==null&&Jt(t)&&t.isSimpleText()&&!t.isUnmergeable();){if(t.__text!==""){if(RP(t,n)){n=IP(t,n);break}break}t.remove()}for(;(r=n.getNextSibling())!==null&&Jt(r)&&r.isSimpleText()&&!r.isUnmergeable();){if(r.__text!==""){if(RP(n,r)){n=IP(n,r);break}break}r.remove()}}else n.remove()}function vb(e){return LP(e.anchor),LP(e.focus),e}function LP(e){for(;e.type==="element";){const t=e.getNode(),r=e.offset;let n,s;if(r===t.getChildrenSize()?(n=t.getChildAtIndex(r-1),s=!0):(n=t.getChildAtIndex(r),s=!1),Jt(n)){e.set(n.__key,s?n.getTextContentSize():0,"text",!0);break}if(!bt(n))break;e.set(n.__key,s?n.getChildrenSize():0,"element",!0)}}let t0,Ci,zy,U_,OT,DT,r0,rc,RT,Wy,ua="",Ic=null,Mc="",Ou="",Bg=!1,wb=!1;function bb(e,t){const r=r0.get(e);if(t!==null){const n=BT(e);n.parentNode===t&&t.removeChild(n)}if(rc.has(e)||Ci._keyToDOMMap.delete(e),bt(r)){const n=Sb(r,r0);IT(n,0,n.length-1,null)}r!==void 0&&A4(Wy,zy,U_,r,"destroyed")}function IT(e,t,r,n){let s=t;for(;s<=r;++s){const a=e[s];a!==void 0&&bb(a,n)}}function vh(e,t){e.setProperty("text-align",t)}const bte="40px";function LL(e,t){const r=t0.theme.indent;if(typeof r=="string"){const s=e.classList.contains(r);t>0&&!s?e.classList.add(r):t<1&&s&&e.classList.remove(r)}const n=getComputedStyle(e).getPropertyValue("--lexical-indent-base-value")||bte;e.style.setProperty("padding-inline-start",t===0?"":`calc(${t} * ${n})`)}function BL(e,t){const r=e.style;t===0?vh(r,""):t===r4?vh(r,"left"):t===n4?vh(r,"center"):t===s4?vh(r,"right"):t===a4?vh(r,"justify"):t===i4?vh(r,"start"):t===o4&&vh(r,"end")}function MT(e,t){const r=(function(n){const s=n.__dir;if(s!==null)return s;if(ga(n))return null;const a=n.getParentOrThrow();return ga(a)&&a.__dir===null?"auto":null})(t);r!==null?e.dir=r:e.removeAttribute("dir")}function _b(e,t){const r=rc.get(e);r===void 0&&$t(60);const n=r.createDOM(t0,Ci);if((function(s,a,i){const o=i._keyToDOMMap;(function(l,u,d){const h=`__lexicalKey_${u._key}`;l[h]=d})(a,i,s),o.set(s,a)})(e,n,Ci),Jt(r)?n.setAttribute("data-lexical-text","true"):gn(r)&&n.setAttribute("data-lexical-decorator","true"),bt(r)){const s=r.__indent,a=r.__size;if(MT(n,r),s!==0&&LL(n,s),a!==0){const o=a-1;LT(Sb(r,rc),r,0,o,r.getDOMSlot(n))}const i=r.__format;i!==0&&BL(n,i),r.isInline()||$L(null,r,n),J_(r)&&(ua+=Xu,Ou+=Xu)}else{const s=r.getTextContent();if(gn(r)){const a=r.decorate(Ci,t0);a!==null&&UL(e,a),n.contentEditable="false"}ua+=s,Ou+=s}return t!==null&&t.insertChild(n),A4(Wy,zy,U_,r,"created"),n}function LT(e,t,r,n,s){const a=ua;ua="";let i=r;for(;i<=n;++i){_b(e[i],s);const o=rc.get(e[i]);o!==null&&Jt(o)&&(Ic===null&&(Ic=o.getFormat()),Mc===""&&(Mc=o.getStyle()))}J_(t)&&(ua+=Xu),s.element.__lexicalTextContent=ua,ua=a+ua}function BP(e,t){if(e){const r=e.__last;if(r){const n=t.get(r);if(n)return zu(n)?"line-break":gn(n)&&n.isInline()?"decorator":null}return"empty"}return null}function $L(e,t,r){const n=BP(e,r0),s=BP(t,rc);n!==s&&t.getDOMSlot(r).setManagedLineBreak(s)}function _te(e,t,r){var n;Ic=null,Mc="",(function(s,a,i){const o=ua,l=s.__size,u=a.__size;ua="";const d=i.element;if(l===1&&u===1){const h=s.__first,g=a.__first;if(h===g)sy(h,d);else{const x=BT(h),v=_b(g,null);try{d.replaceChild(v,x)}catch(w){if(typeof w=="object"&&w!=null){const C=`${w.toString()} Parent: ${d.tagName}, new child: {tag: ${v.tagName} key: ${g}}, old child: {tag: ${x.tagName}, key: ${h}}.`;throw new Error(C)}throw w}bb(h,null)}const p=rc.get(g);Jt(p)&&(Ic===null&&(Ic=p.getFormat()),Mc===""&&(Mc=p.getStyle()))}else{const h=Sb(s,r0),g=Sb(a,rc);if(h.length!==l&&$t(227),g.length!==u&&$t(228),l===0)u!==0&&LT(g,a,0,u-1,i);else if(u===0){if(l!==0){const p=i.after==null&&i.before==null&&i.element.__lexicalLineBreak==null;IT(h,0,l-1,p?null:d),p&&(d.textContent="")}}else(function(p,x,v,w,C,k){const _=w-1,N=C-1;let E,P,F=k.getFirstChild(),A=0,j=0;for(;A<=_&&j<=N;){const Y=x[A],Z=v[j];if(Y===Z)F=ek(sy(Z,k.element)),A++,j++;else{E===void 0&&(E=new Set(x)),P===void 0&&(P=new Set(v));const ee=P.has(Y),ne=E.has(Z);if(ee)if(ne){const L=n0(Ci,Z);L===F?F=ek(sy(Z,k.element)):(k.withBefore(F).insertChild(L),sy(Z,k.element)),A++,j++}else _b(Z,k.withBefore(F)),j++;else F=ek(BT(Y)),bb(Y,k.element),A++}const ae=rc.get(Z);ae!==null&&Jt(ae)&&(Ic===null&&(Ic=ae.getFormat()),Mc===""&&(Mc=ae.getStyle()))}const R=A>_,U=j>N;if(R&&!U){const Y=v[N+1],Z=Y===void 0?null:Ci.getElementByKey(Y);LT(v,p,j,N,k.withBefore(Z))}else U&&!R&&IT(x,A,_,k.element)})(a,h,g,l,u,i)}J_(a)&&(ua+=Xu),d.__lexicalTextContent=ua,ua=o+ua})(e,t,t.getDOMSlot(r)),n=t,Ic==null||Ic===n.__textFormat||wb||n.setTextFormat(Ic),(function(s){Mc===""||Mc===s.__textStyle||wb||s.setTextStyle(Mc)})(t)}function Sb(e,t){const r=[];let n=e.__first;for(;n!==null;){const s=t.get(n);s===void 0&&$t(101),r.push(n),n=s.__next}return r}function sy(e,t){const r=r0.get(e);let n=rc.get(e);r!==void 0&&n!==void 0||$t(61);const s=Bg||DT.has(e)||OT.has(e),a=n0(Ci,e);if(r===n&&!s){if(bt(r)){const i=a.__lexicalTextContent;i!==void 0&&(ua+=i,Ou+=i)}else{const i=r.getTextContent();Ou+=i,ua+=i}return a}if(r!==n&&s&&A4(Wy,zy,U_,n,"updated"),n.updateDOM(r,a,t0)){const i=_b(e,null);return t===null&&$t(62),t.replaceChild(i,a),bb(e,null),i}if(bt(r)&&bt(n)){const i=n.__indent;(Bg||i!==r.__indent)&&LL(a,i);const o=n.__format;if((Bg||o!==r.__format)&&BL(a,o),s&&(_te(r,n,a),ga(n)||n.isInline()||$L(r,n,a)),J_(n)&&(ua+=Xu,Ou+=Xu),(Bg||n.__dir!==r.__dir)&&(MT(a,n),ga(n)&&!Bg))for(const l of n.getChildren())bt(l)&&MT(n0(Ci,l.getKey()),l)}else{const i=n.getTextContent();if(gn(n)){const o=n.decorate(Ci,t0);o!==null&&UL(e,o)}ua+=i,Ou+=i}if(!wb&&ga(n)&&n.__cachedText!==Ou){const i=n.getWritable();i.__cachedText=Ou,n=i}return a}function UL(e,t){let r=Ci._pendingDecorators;const n=Ci._decorators;if(r===null){if(n[e]===t)return;r=E9(Ci)}r[e]=t}function ek(e){let t=e.nextSibling;return t!==null&&t===Ci._blockCursorElement&&(t=t.nextSibling),t}function Ste(e,t,r,n,s,a){ua="",Ou="",Bg=n===ym,Ci=r,t0=r._config,zy=r._nodes,U_=Ci._listeners.mutation,OT=s,DT=a,r0=e._nodeMap,rc=t._nodeMap,wb=t._readOnly,RT=new Map(r._keyToDOMMap);const i=new Map;return Wy=i,sy("root",null),Ci=void 0,zy=void 0,OT=void 0,DT=void 0,r0=void 0,rc=void 0,t0=void 0,RT=void 0,Wy=void 0,i}function BT(e){const t=RT.get(e);return t===void 0&&$t(75,e),t}function jr(e){return{type:e}}const zL=jr("SELECTION_CHANGE_COMMAND"),kte=jr("SELECTION_INSERT_CLIPBOARD_NODES_COMMAND"),c4=jr("CLICK_COMMAND"),Bh=jr("DELETE_CHARACTER_COMMAND"),rm=jr("INSERT_LINE_BREAK_COMMAND"),Hy=jr("INSERT_PARAGRAPH_COMMAND"),nm=jr("CONTROLLED_TEXT_INSERTION_COMMAND"),u4=jr("PASTE_COMMAND"),$T=jr("REMOVE_TEXT_COMMAND"),Gy=jr("DELETE_WORD_COMMAND"),Vy=jr("DELETE_LINE_COMMAND"),ki=jr("FORMAT_TEXT_COMMAND"),d4=jr("UNDO_COMMAND"),f4=jr("REDO_COMMAND"),Cte=jr("KEYDOWN_COMMAND"),WL=jr("KEY_ARROW_RIGHT_COMMAND"),Tte=jr("MOVE_TO_END"),HL=jr("KEY_ARROW_LEFT_COMMAND"),Ete=jr("MOVE_TO_START"),GL=jr("KEY_ARROW_UP_COMMAND"),VL=jr("KEY_ARROW_DOWN_COMMAND"),kb=jr("KEY_ENTER_COMMAND"),KL=jr("KEY_SPACE_COMMAND"),qL=jr("KEY_BACKSPACE_COMMAND"),YL=jr("KEY_ESCAPE_COMMAND"),XL=jr("KEY_DELETE_COMMAND"),JL=jr("KEY_TAB_COMMAND"),Nte=jr("INSERT_TAB_COMMAND"),Ate=jr("INDENT_CONTENT_COMMAND"),$P=jr("OUTDENT_CONTENT_COMMAND"),QL=jr("DROP_COMMAND"),ZL=jr("FORMAT_ELEMENT_COMMAND"),e9=jr("DRAGSTART_COMMAND"),t9=jr("DRAGOVER_COMMAND"),jte=jr("DRAGEND_COMMAND"),z_=jr("COPY_COMMAND"),h4=jr("CUT_COMMAND"),UT=jr("SELECT_ALL_COMMAND"),Pte=jr("CLEAR_EDITOR_COMMAND"),Fte=jr("CLEAR_HISTORY_COMMAND"),hw=jr("CAN_REDO_COMMAND"),gw=jr("CAN_UNDO_COMMAND"),Ote=jr("FOCUS_COMMAND"),Dte=jr("BLUR_COMMAND"),Rte=jr("KEY_MODIFIER_COMMAND"),Au=Object.freeze({}),zT=30,WT=[["keydown",function(e,t){if(xy=e.timeStamp,r9=e.key,!t.isComposing()&&!ar(t,Cte,e)&&e.key!=null){if(tk&&g8(e))return Fo(t,(()=>{mw(t,rk)})),tk=!1,void(rk="");if((function(r){return Sn(r,"ArrowRight",{shiftKey:"any"})})(e))ar(t,WL,e);else if((function(r){return Sn(r,"ArrowRight",Pu)})(e))ar(t,Tte,e);else if((function(r){return Sn(r,"ArrowLeft",{shiftKey:"any"})})(e))ar(t,HL,e);else if((function(r){return Sn(r,"ArrowLeft",Pu)})(e))ar(t,Ete,e);else if((function(r){return Sn(r,"ArrowUp",{altKey:"any",shiftKey:"any"})})(e))ar(t,GL,e);else if((function(r){return Sn(r,"ArrowDown",{altKey:"any",shiftKey:"any"})})(e))ar(t,VL,e);else if((function(r){return Sn(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any",shiftKey:!0})})(e))yy=!0,ar(t,kb,e);else if((function(r){return r.key===" "})(e))ar(t,KL,e);else if((function(r){return Lc&&Sn(r,"o",{ctrlKey:!0})})(e))e.preventDefault(),yy=!0,ar(t,rm,!0);else if((function(r){return Sn(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any"})})(e))yy=!1,ar(t,kb,e);else if((function(r){return Sn(r,"Backspace",{shiftKey:"any"})||Lc&&Sn(r,"h",{ctrlKey:!0})})(e))g8(e)?ar(t,qL,e):(e.preventDefault(),ar(t,Bh,!0));else if((function(r){return r.key==="Escape"})(e))ar(t,YL,e);else if((function(r){return Sn(r,"Delete",{})||Lc&&Sn(r,"d",{ctrlKey:!0})})(e))(function(r){return r.key==="Delete"})(e)?ar(t,XL,e):(e.preventDefault(),ar(t,Bh,!1));else if((function(r){return Sn(r,"Backspace",h8)})(e))e.preventDefault(),ar(t,Gy,!0);else if((function(r){return Sn(r,"Delete",h8)})(e))e.preventDefault(),ar(t,Gy,!1);else if((function(r){return Lc&&Sn(r,"Backspace",{metaKey:!0})})(e))e.preventDefault(),ar(t,Vy,!0);else if((function(r){return Lc&&(Sn(r,"Delete",{metaKey:!0})||Sn(r,"k",{ctrlKey:!0}))})(e))e.preventDefault(),ar(t,Vy,!1);else if((function(r){return Sn(r,"b",Pu)})(e))e.preventDefault(),ar(t,ki,"bold");else if((function(r){return Sn(r,"u",Pu)})(e))e.preventDefault(),ar(t,ki,"underline");else if((function(r){return Sn(r,"i",Pu)})(e))e.preventDefault(),ar(t,ki,"italic");else if((function(r){return Sn(r,"Tab",{shiftKey:"any"})})(e))ar(t,JL,e);else if((function(r){return Sn(r,"z",Pu)})(e))e.preventDefault(),ar(t,d4,void 0);else if((function(r){return Lc?Sn(r,"z",{metaKey:!0,shiftKey:!0}):Sn(r,"y",{ctrlKey:!0})||Sn(r,"z",{ctrlKey:!0,shiftKey:!0})})(e))e.preventDefault(),ar(t,f4,void 0);else{const r=t._editorState._selection;r===null||Dt(r)?m8(e)&&(e.preventDefault(),ar(t,UT,e)):(function(n){return Sn(n,"c",Pu)})(e)?(e.preventDefault(),ar(t,z_,e)):(function(n){return Sn(n,"x",Pu)})(e)?(e.preventDefault(),ar(t,h4,e)):m8(e)&&(e.preventDefault(),ar(t,UT,e))}(function(r){return r.ctrlKey||r.shiftKey||r.altKey||r.metaKey})(e)&&ar(t,Rte,e)}}],["pointerdown",function(e,t){const r=e.target,n=e.pointerType;zm(r)&&n!=="touch"&&n!=="pen"&&e.button===0&&Fo(t,(()=>{u8(r)||(GT=!0)}))}],["compositionstart",function(e,t){Fo(t,(()=>{const r=Xt();if(Dt(r)&&!t.isComposing()){const n=r.anchor,s=r.anchor.getNode();ti(n.key),(e.timeStamp<xy+zT||n.type==="element"||!r.isCollapsed()||s.getFormat()!==r.format||Jt(s)&&s.getStyle()!==r.style)&&ar(t,nm,lte)}}))}],["compositionend",function(e,t){Qh?Wx=!0:xm||!Uy&&!pb?Fo(t,(()=>{mw(t,e.data)})):(tk=!0,rk=e.data)}],["input",function(e,t){e.stopPropagation(),Fo(t,(()=>{if(qn(e.target)&&u8(e.target))return;const r=Xt(),n=e.data,s=o9(e);if(n!=null&&Dt(r)&&a9(r,s,n,e.timeStamp,!1)){Wx&&(mw(t,n),Wx=!1);const a=r.anchor.getNode(),i=ic(_l(t));if(i===null)return;const o=r.isBackward(),l=o?r.anchor.offset:r.focus.offset,u=o?r.focus.offset:r.anchor.offset;mb&&!r.isCollapsed()&&Jt(a)&&i.anchorNode!==null&&a.getTextContent().slice(0,l)+n+a.getTextContent().slice(l+u)===P9(i.anchorNode)||ar(t,nm,n);const d=n.length;Qh&&d>1&&e.inputType==="insertCompositionText"&&!t.isComposing()&&(r.anchor.offset-=d),Uy||xm||pb||!t.isComposing()||(xy=0,ti(null))}else E4(!1,t,n!==null?n:void 0),Wx&&(mw(t,n||void 0),Wx=!1);(function(){ei();const a=gs();DL(a)})()}),{event:e}),$g=null}],["click",function(e,t){Fo(t,(()=>{const r=Xt(),n=ic(_l(t)),s=Um();if(n){if(Dt(r)){const a=r.anchor,i=a.getNode();if(a.type==="element"&&a.offset===0&&r.isCollapsed()&&!ga(i)&&is().getChildrenSize()===1&&i.getTopLevelElementOrThrow().isEmpty()&&s!==null&&r.is(s))n.removeAllRanges(),r.dirty=!0;else if(e.detail===3&&!r.isCollapsed()&&i!==r.focus.getNode()){const o=(function(l,u){let d=l;for(;d!==is()&&d!=null;){if(u(d))return d;d=d.getParent()}return null})(i,(l=>bt(l)&&!l.isInline()));bt(o)&&o.select(0)}}else if(e.pointerType==="touch"||e.pointerType==="pen"){const a=n.anchorNode;(qn(a)||sd(a))&&ai(p4(s,n,t,e))}}ar(t,c4,e)}))}],["cut",Au],["copy",Au],["dragstart",Au],["dragover",Au],["dragend",Au],["paste",Au],["focus",Au],["blur",Au],["drop",Au]];mb&&WT.push(["beforeinput",(e,t)=>(function(r,n){const s=r.inputType,a=o9(r);s==="deleteCompositionText"||Qh&&F9(n)||s!=="insertCompositionText"&&Fo(n,(()=>{const i=Xt();if(s==="deleteContentBackward"){if(i===null){const p=Um();if(!Dt(p))return;ai(p.clone())}if(Dt(i)){const p=i.anchor.key===i.focus.key;if(o=r.timeStamp,r9==="MediaLast"&&o<xy+zT&&n.isComposing()&&p){if(ti(null),xy=0,setTimeout((()=>{Fo(n,(()=>{ti(null)}))}),zT),Dt(i)){const x=i.anchor.getNode();x.markDirty(),Jt(x)||$t(142),i9(i,x)}}else{ti(null),r.preventDefault();const x=i.anchor.getNode(),v=x.getTextContent(),w=x.canInsertTextAfter(),C=i.anchor.offset===0&&i.focus.offset===v.length;let k=NP&&p&&!C&&w;if(k&&i.isCollapsed()&&(k=!gn(XT(i.anchor,!0))),!k){ar(n,Bh,!0);const _=Xt();NP&&Dt(_)&&_.isCollapsed()&&(Th=_,setTimeout((()=>Th=null)))}}return}}var o;if(!Dt(i))return;const l=r.data;$g!==null&&E4(!1,n,$g),i.dirty&&$g===null||!i.isCollapsed()||ga(i.anchor.getNode())||a===null||i.applyDOMRange(a),$g=null;const u=i.anchor,d=i.focus,h=u.getNode(),g=d.getNode();if(s!=="insertText"&&s!=="insertTranspose")switch(r.preventDefault(),s){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":ar(n,nm,r);break;case"insertFromComposition":ti(null),ar(n,nm,r);break;case"insertLineBreak":ti(null),ar(n,rm,!1);break;case"insertParagraph":ti(null),yy&&!xm?(yy=!1,ar(n,rm,!1)):ar(n,Hy,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":ar(n,u4,r);break;case"deleteByComposition":(function(p,x){return p!==x||bt(p)||bt(x)||!$h(p)||!$h(x)})(h,g)&&ar(n,$T,r);break;case"deleteByDrag":case"deleteByCut":ar(n,$T,r);break;case"deleteContent":ar(n,Bh,!1);break;case"deleteWordBackward":ar(n,Gy,!0);break;case"deleteWordForward":ar(n,Gy,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":ar(n,Vy,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":ar(n,Vy,!1);break;case"formatStrikeThrough":ar(n,ki,"strikethrough");break;case"formatBold":ar(n,ki,"bold");break;case"formatItalic":ar(n,ki,"italic");break;case"formatUnderline":ar(n,ki,"underline");break;case"historyUndo":ar(n,d4,void 0);break;case"historyRedo":ar(n,f4,void 0)}else{if(l===`
`)r.preventDefault(),ar(n,rm,!1);else if(l===Xu)r.preventDefault(),ar(n,Hy,void 0);else if(l==null&&r.dataTransfer){const p=r.dataTransfer.getData("text/plain");r.preventDefault(),i.insertRawText(p)}else l!=null&&a9(i,a,l,r.timeStamp,!0)?(r.preventDefault(),ar(n,nm,l)):$g=l;n9=r.timeStamp}}))})(e,t)]);let xy=0,r9=null,n9=0,$g=null;const Cb=new WeakMap;let HT=!1,GT=!1,yy=!1,Wx=!1,tk=!1,rk="",Th=null,s9=[0,"",0,"root",0];function a9(e,t,r,n,s){const a=e.anchor,i=e.focus,o=a.getNode(),l=gs(),u=ic(_l(l)),d=u!==null?u.anchorNode:null,h=a.key,g=l.getElementByKey(h),p=r.length;return h!==i.key||!Jt(o)||(!s&&(!mb||n9<n+50)||o.isDirty()&&p<2||A9(r))&&a.offset!==i.offset&&!o.isComposing()||Fu(o)||o.isDirty()&&p>1||(s||!mb)&&g!==null&&!o.isComposing()&&d!==vm(g)||u!==null&&t!==null&&(!t.collapsed||t.startContainer!==u.anchorNode||t.startOffset!==u.anchorOffset)||o.getFormat()!==e.format||o.getStyle()!==e.style||(function(x,v){if(v.isSegmented())return!0;if(!x.isCollapsed())return!1;const w=x.anchor.offset,C=v.getParentOrThrow(),k=$h(v);return w===0?!v.canInsertTextBefore()||!C.canInsertTextBefore()&&!v.isComposing()||k||(function(_){const N=_.getPreviousSibling();return(Jt(N)||bt(N)&&N.isInline())&&!N.canInsertTextAfter()})(v):w===v.getTextContentSize()&&(!v.canInsertTextAfter()||!C.canInsertTextAfter()&&!v.isComposing()||k)})(e,o)}function UP(e,t){return sd(e)&&e.nodeValue!==null&&t!==0&&t!==e.nodeValue.length}function zP(e,t,r){const{anchorNode:n,anchorOffset:s,focusNode:a,focusOffset:i}=e;HT&&(HT=!1,UP(n,s)&&UP(a,i)&&!Th)||Fo(t,(()=>{if(!r)return void ai(null);if(!Fv(t,n,a))return;let o=Xt();if(Th&&Dt(o)&&o.isCollapsed()){const l=o.anchor,u=Th.anchor;(l.key===u.key&&l.offset===u.offset+1||l.offset===1&&u.getNode().is(l.getNode().getPreviousSibling()))&&(o=Th.clone(),ai(o))}if(Th=null,Dt(o)){const l=o.anchor,u=l.getNode();if(o.isCollapsed()){e.type==="Range"&&e.anchorNode===e.focusNode&&(o.dirty=!0);const d=_l(t).event,h=d?d.timeStamp:performance.now(),[g,p,x,v,w]=s9,C=is(),k=t.isComposing()===!1&&C.getTextContent()==="";if(h<w+200&&l.offset===x&&l.key===v)tb(o,g,p);else if(l.type==="text")Jt(u)||$t(141),i9(o,u);else if(l.type==="element"&&!k){bt(u)||$t(259);const _=l.getNode();_.isEmpty()?(function(N,E){const P=E.getTextFormat(),F=E.getTextStyle();tb(N,P,F)})(o,_):tb(o,0,"")}}else{const d=l.key,h=o.focus.key,g=o.getNodes(),p=g.length,x=o.isBackward(),v=x?i:s,w=x?s:i,C=x?h:d,k=x?d:h;let _=ote,N=!1;for(let E=0;E<p;E++){const P=g[E],F=P.getTextContentSize();if(Jt(P)&&F!==0&&!(E===0&&P.__key===C&&v===F||E===p-1&&P.__key===k&&w===0)&&(N=!0,_&=P.getFormat(),_===0))break}o.format=N?_:0}}ar(t,zL,void 0)}))}function tb(e,t,r){e.format===t&&e.style===r||(e.format=t,e.style=r,e.dirty=!0)}function i9(e,t){tb(e,t.getFormat(),t.getStyle())}function o9(e){if(!e.getTargetRanges)return null;const t=e.getTargetRanges();return t.length===0?null:t[0]}function mw(e,t){const r=e._compositionKey;if(ti(null),r!==null&&t!=null){if(t===""){const n=Zs(r),s=vm(e.getElementByKey(r));return void(s!==null&&s.nodeValue!==null&&Jt(n)&&N4(n,s.nodeValue,null,null,!0))}if(t[t.length-1]===`
`){const n=Xt();if(Dt(n)){const s=n.focus;return n.anchor.set(s.key,s.offset,s.type),void ar(e,kb,null)}}}E4(!0,e,t)}function l9(e){let t=e.__lexicalEventHandles;return t===void 0&&(t=[],e.__lexicalEventHandles=t),t}const sm=new Map;function c9(e){const t=gre(e.target);if(t===null)return;const r=k9(t.anchorNode);if(r===null)return;GT&&(GT=!1,Fo(r,(()=>{const l=Um(),u=t.anchorNode;(qn(u)||sd(u))&&ai(p4(l,t,r,e))})));const n=T4(r),s=n[n.length-1],a=s._key,i=sm.get(a),o=i||s;o!==r&&zP(t,o,!1),zP(t,r,!0),r!==s?sm.set(a,r):i&&sm.delete(a)}function WP(e){e._lexicalHandled=!0}function HP(e){return e._lexicalHandled===!0}function Ite(e){const t=e.ownerDocument,r=Cb.get(t);if(r===void 0)return;const n=r-1;n>=0||$t(164),Cb.set(t,n),n===0&&t.removeEventListener("selectionchange",c9);const s=Y_(e);C4(s)?((function(i){if(i._parentEditor!==null){const o=T4(i),l=o[o.length-1]._key;sm.get(l)===i&&sm.delete(l)}else sm.delete(i._key)})(s),e.__lexicalEditor=null):s&&$t(198);const a=l9(e);for(let i=0;i<a.length;i++)a[i]();e.__lexicalEventHandles=[]}function VT(e,t,r){ei();const n=e.__key,s=e.getParent();if(s===null)return;const a=(function(o){const l=Xt();if(!Dt(l)||!bt(o))return l;const{anchor:u,focus:d}=l,h=u.getNode(),g=d.getNode();return JT(h,o)&&u.set(o.__key,0,"element"),JT(g,o)&&d.set(o.__key,0,"element"),l})(e);let i=!1;if(Dt(a)&&t){const o=a.anchor,l=a.focus;o.key===n&&(Eb(o,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0),l.key===n&&(Eb(l,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0)}else pi(a)&&t&&e.isSelected()&&e.selectPrevious();if(Dt(a)&&t&&!i){const o=e.getIndexWithinParent();Uh(e),Tb(a,s,o,-1)}else Uh(e);r||qi(s)||s.canBeEmpty()||!s.isEmpty()||VT(s,t),t&&a&&ga(s)&&s.isEmpty()&&s.selectEnd()}class Bm{static getType(){const{ownNodeType:t}=O4(this);return t===void 0&&$t(64,this.name),t}static clone(t){$t(65,this.name)}$config(){return{}}config(t,r){const n=r.extends||Object.getPrototypeOf(this.constructor);return Object.assign(r,{extends:n,type:t}),{[t]:r}}afterCloneFrom(t){this.__key===t.__key?(this.__parent=t.__parent,this.__next=t.__next,this.__prev=t.__prev,this.__state=t.__state):t.__state&&(this.__state=t.__state.getWritable(this))}constructor(t){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,Object.defineProperty(this,"__state",{configurable:!0,enumerable:!1,value:void 0,writable:!0}),ire(this,t)}getType(){return this.__type}isInline(){$t(137,this.constructor.name)}isAttached(){let t=this.__key;for(;t!==null;){if(t==="root")return!0;const r=Zs(t);if(r===null)break;t=r.__parent}return!1}isSelected(t){const r=t||Xt();if(r==null)return!1;const n=r.getNodes().some((s=>s.__key===this.__key));if(Jt(this))return n;if(Dt(r)&&r.anchor.type==="element"&&r.focus.type==="element"){if(r.isCollapsed())return!1;const s=this.getParent();if(gn(this)&&this.isInline()&&s){const a=r.isBackward()?r.focus:r.anchor;if(s.is(a.getNode())&&a.offset===s.getChildrenSize()&&this.is(s.getLastChild()))return!1}}return n}getKey(){return this.__key}getIndexWithinParent(){const t=this.getParent();if(t===null)return-1;let r=t.getFirstChild(),n=0;for(;r!==null;){if(this.is(r))return n;n++,r=r.getNextSibling()}return-1}getParent(){const t=this.getLatest().__parent;return t===null?null:Zs(t)}getParentOrThrow(){const t=this.getParent();return t===null&&$t(66,this.__key),t}getTopLevelElement(){let t=this;for(;t!==null;){const r=t.getParent();if(qi(r))return bt(t)||t===this&&gn(t)||$t(194),t;t=r}return null}getTopLevelElementOrThrow(){const t=this.getTopLevelElement();return t===null&&$t(67,this.__key),t}getParents(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r),r=r.getParent();return t}getParentKeys(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r.__key),r=r.getParent();return t}getPreviousSibling(){const t=this.getLatest().__prev;return t===null?null:Zs(t)}getPreviousSiblings(){const t=[],r=this.getParent();if(r===null)return t;let n=r.getFirstChild();for(;n!==null&&!n.is(this);)t.push(n),n=n.getNextSibling();return t}getNextSibling(){const t=this.getLatest().__next;return t===null?null:Zs(t)}getNextSiblings(){const t=[];let r=this.getNextSibling();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getCommonAncestor(t){const r=bt(this)?this:this.getParent(),n=bt(t)?t:t.getParent(),s=r&&n?nb(r,n):null;return s?s.commonAncestor:null}is(t){return t!=null&&this.__key===t.__key}isBefore(t){const r=nb(this,t);return r!==null&&(r.type==="descendant"||(r.type==="branch"?I9(r)===-1:(r.type!=="same"&&r.type!=="ancestor"&&$t(279),!1)))}isParentOf(t){const r=nb(this,t);return r!==null&&r.type==="ancestor"}getNodesBetween(t){const r=this.isBefore(t),n=[],s=new Set;let a=this;for(;a!==null;){const i=a.__key;if(s.has(i)||(s.add(i),n.push(a)),a===t)break;const o=bt(a)?r?a.getFirstChild():a.getLastChild():null;if(o!==null){a=o;continue}const l=r?a.getNextSibling():a.getPreviousSibling();if(l!==null){a=l;continue}const u=a.getParentOrThrow();if(s.has(u.__key)||n.push(u),u===t)break;let d=null,h=u;do{if(h===null&&$t(68),d=r?h.getNextSibling():h.getPreviousSibling(),h=h.getParent(),h===null)break;d!==null||s.has(h.__key)||n.push(h)}while(d===null);a=d}return r||n.reverse(),n}isDirty(){const t=gs()._dirtyLeaves;return t!==null&&t.has(this.__key)}getLatest(){const t=Zs(this.__key);return t===null&&$t(113),t}getWritable(){ei();const t=Ff(),r=gs(),n=t._nodeMap,s=this.__key,a=this.getLatest(),i=r._cloneNotNeeded,o=Xt();if(o!==null&&o.setCachedNodes(null),i.has(s))return jb(a),a;const l=P4(a);return i.add(s),jb(l),n.set(s,l),l}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(t,r){$t(70)}updateDOM(t,r,n){$t(71)}exportDOM(t){return{element:this.createDOM(t._config,t)}}exportJSON(){const t=this.__state?this.__state.toJSON():void 0;return{type:this.__type,version:1,...t}}static importJSON(t){$t(18,this.name)}updateFromJSON(t){return(function(r,n){const s=r.getWritable(),a=n.$;let i=a;for(const o of ML(s).flatKeys)o in n&&(i!==void 0&&i!==a||(i={...a}),i[o]=n[o]);return(s.__state||i)&&wte(r).updateFromJSON(i),s})(this,t)}static transform(){return null}remove(t){VT(this,!0,t)}replace(t,r){ei();let n=Xt();n!==null&&(n=n.clone()),lk(this,t);const s=this.getLatest(),a=this.__key,i=t.__key,o=t.getWritable(),l=this.getParentOrThrow().getWritable(),u=l.__size;Uh(o);const d=s.getPreviousSibling(),h=s.getNextSibling(),g=s.__prev,p=s.__next,x=s.__parent;if(VT(s,!1,!0),d===null?l.__first=i:d.getWritable().__next=i,o.__prev=g,h===null?l.__last=i:h.getWritable().__prev=i,o.__next=p,o.__parent=x,l.__size=u,r&&(bt(this)&&bt(o)||$t(139),this.getChildren().forEach((v=>{o.append(v)}))),Dt(n)){ai(n);const v=n.anchor,w=n.focus;v.key===a&&qP(v,o),w.key===a&&qP(w,o)}return lf()===a&&ti(i),o}insertAfter(t,r=!0){ei(),lk(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.getParent(),i=Xt();let o=!1,l=!1;if(a!==null){const p=t.getIndexWithinParent();if(Uh(s),Dt(i)){const x=a.__key,v=i.anchor,w=i.focus;o=v.type==="element"&&v.key===x&&v.offset===p+1,l=w.type==="element"&&w.key===x&&w.offset===p+1}}const u=this.getNextSibling(),d=this.getParentOrThrow().getWritable(),h=s.__key,g=n.__next;if(u===null?d.__last=h:u.getWritable().__prev=h,d.__size++,n.__next=h,s.__next=g,s.__prev=n.__key,s.__parent=n.__parent,r&&Dt(i)){const p=this.getIndexWithinParent();Tb(i,d,p+1);const x=d.__key;o&&i.anchor.set(x,p+2,"element"),l&&i.focus.set(x,p+2,"element")}return t}insertBefore(t,r=!0){ei(),lk(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.__key;Uh(s);const i=this.getPreviousSibling(),o=this.getParentOrThrow().getWritable(),l=n.__prev,u=this.getIndexWithinParent();i===null?o.__first=a:i.getWritable().__next=a,o.__size++,n.__prev=a,s.__prev=l,s.__next=n.__key,s.__parent=n.__parent;const d=Xt();return r&&Dt(d)&&Tb(d,this.getParentOrThrow(),u),t}isParentRequired(){return!1}createParentElementNode(){return Kn()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(t,r){ei();const n=this.getPreviousSibling(),s=this.getParentOrThrow();if(n===null)return s.select(0,0);if(bt(n))return n.select();if(!Jt(n)){const a=n.getIndexWithinParent()+1;return s.select(a,a)}return n.select(t,r)}selectNext(t,r){ei();const n=this.getNextSibling(),s=this.getParentOrThrow();if(n===null)return s.select();if(bt(n))return n.select(0,0);if(!Jt(n)){const a=n.getIndexWithinParent();return s.select(a,a)}return n.select(t,r)}markDirty(){this.getWritable()}reconcileObservedMutation(t,r){this.markDirty()}}class Ev extends Bm{static getType(){return"linebreak"}static clone(t){return new Ev(t.__key)}constructor(t){super(t)}getTextContent(){return`
`}createDOM(){return document.createElement("br")}updateDOM(){return!1}isInline(){return!0}static importDOM(){return{br:t=>(function(r){const n=r.parentElement;if(n!==null&&Pb(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&pw(s)){const a=n.lastChild;if(a===r||a.previousSibling===r&&pw(a))return!0}}return!1})(t)||(function(r){const n=r.parentElement;if(n!==null&&Pb(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&pw(s))return!1;const a=n.lastChild;if(a===r||a.previousSibling===r&&pw(a))return!0}return!1})(t)?null:{conversion:Mte,priority:0}}}static importJSON(t){return qc().updateFromJSON(t)}}function Mte(e){return{node:qc()}}function qc(){return Ji(new Ev)}function zu(e){return e instanceof Ev}function pw(e){return sd(e)&&/^( |\t|\r?\n)+$/.test(e.textContent||"")}function nk(e,t){return 16&t?"code":t&t4?"mark":32&t?"sub":64&t?"sup":null}function sk(e,t){return 1&t?"strong":2&t?"em":"span"}function u9(e,t,r,n,s){const a=n.classList;let i=am(s,"base");i!==void 0&&a.add(...i),i=am(s,"underlineStrikethrough");let o=!1;const l=t&yb&&t&xb;i!==void 0&&(r&yb&&r&xb?(o=!0,l||a.add(...i)):l&&a.remove(...i));for(const u in e0){const d=e0[u];if(i=am(s,u),i!==void 0)if(r&d){if(o&&(u==="underline"||u==="strikethrough")){t&d&&a.remove(...i);continue}t&d&&(!l||u!=="underline")&&u!=="strikethrough"||a.add(...i)}else t&d&&a.remove(...i)}}function d9(e,t,r){const n=t.firstChild,s=r.isComposing(),a=e+(s?$_:"");if(n==null)t.textContent=a;else{const i=n.nodeValue;if(i!==a)if(s||Qh){const[o,l,u]=(function(d,h){const g=d.length,p=h.length;let x=0,v=0;for(;x<g&&x<p&&d[x]===h[x];)x++;for(;v+x<g&&v+x<p&&d[g-v-1]===h[p-v-1];)v++;return[x,g-x-v,h.slice(x,p-v)]})(i,a);l!==0&&n.deleteData(o,l),n.insertData(o,u)}else n.nodeValue=a}}function GP(e,t,r,n,s,a){d9(s,e,t);const i=a.theme.text;i!==void 0&&u9(0,0,n,e,i)}function xw(e,t){const r=document.createElement(t);return r.appendChild(e),r}class Pf extends Bm{static getType(){return"text"}static clone(t){return new Pf(t.__text,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__text=t.__text,this.__format=t.__format,this.__style=t.__style,this.__mode=t.__mode,this.__detail=t.__detail}constructor(t="",r){super(r),this.__text=t,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const t=this.getLatest();return fte[t.__mode]}getStyle(){return this.getLatest().__style}isToken(){return this.getLatest().__mode===1}isComposing(){return this.__key===lf()}isSegmented(){return this.getLatest().__mode===2}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(t){const r=e0[t];return!!(this.getFormat()&r)}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(){return this.getLatest().__text}getFormatFlags(t,r){return Ab(this.getLatest().__format,t,r)}canHaveFormat(){return!0}isInline(){return!0}createDOM(t,r){const n=this.__format,s=nk(0,n),a=sk(0,n),i=s===null?a:s,o=document.createElement(i);let l=o;this.hasFormat("code")&&o.setAttribute("spellcheck","false"),s!==null&&(l=document.createElement(a),o.appendChild(l)),GP(l,this,0,n,this.__text,t);const u=this.__style;return u!==""&&(o.style.cssText=u),o}updateDOM(t,r,n){const s=this.__text,a=t.__format,i=this.__format,o=nk(0,a),l=nk(0,i),u=sk(0,a),d=sk(0,i);if((o===null?u:o)!==(l===null?d:l))return!0;if(o===l&&u!==d){const v=r.firstChild;v==null&&$t(48);const w=document.createElement(d);return GP(w,this,0,i,s,n),r.replaceChild(w,v),!1}let h=r;l!==null&&o!==null&&(h=r.firstChild,h==null&&$t(49)),d9(s,h,this);const g=n.theme.text;g!==void 0&&a!==i&&u9(0,a,i,h,g);const p=t.__style,x=this.__style;return p!==x&&(r.style.cssText=x),!1}static importDOM(){return{"#text":()=>({conversion:Ute,priority:0}),b:()=>({conversion:Bte,priority:0}),code:()=>({conversion:ju,priority:0}),em:()=>({conversion:ju,priority:0}),i:()=>({conversion:ju,priority:0}),mark:()=>({conversion:ju,priority:0}),s:()=>({conversion:ju,priority:0}),span:()=>({conversion:Lte,priority:0}),strong:()=>({conversion:ju,priority:0}),sub:()=>({conversion:ju,priority:0}),sup:()=>({conversion:ju,priority:0}),u:()=>({conversion:ju,priority:0})}}static importJSON(t){return _s().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTextContent(t.text).setFormat(t.format).setDetail(t.detail).setMode(t.mode).setStyle(t.style)}exportDOM(t){let{element:r}=super.exportDOM(t);return qn(r)||$t(132),r.style.whiteSpace="pre-wrap",this.hasFormat("lowercase")?r.style.textTransform="lowercase":this.hasFormat("uppercase")?r.style.textTransform="uppercase":this.hasFormat("capitalize")&&(r.style.textTransform="capitalize"),this.hasFormat("bold")&&(r=xw(r,"b")),this.hasFormat("italic")&&(r=xw(r,"i")),this.hasFormat("strikethrough")&&(r=xw(r,"s")),this.hasFormat("underline")&&(r=xw(r,"u")),{element:r}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),...super.exportJSON()}}selectionTransform(t,r){}setFormat(t){const r=this.getWritable();return r.__format=typeof t=="string"?e0[t]:t,r}setDetail(t){const r=this.getWritable();return r.__detail=typeof t=="string"?cte[t]:t,r}setStyle(t){const r=this.getWritable();return r.__style=t,r}toggleFormat(t){const r=Ab(this.getFormat(),t,null);return this.setFormat(r)}toggleDirectionless(){const t=this.getWritable();return t.__detail^=1,t}toggleUnmergeable(){const t=this.getWritable();return t.__detail^=2,t}setMode(t){const r=dte[t];if(this.__mode===r)return this;const n=this.getWritable();return n.__mode=r,n}setTextContent(t){if(this.__text===t)return this;const r=this.getWritable();return r.__text=t,r}select(t,r){ei();let n=t,s=r;const a=Xt(),i=this.getTextContent(),o=this.__key;if(typeof i=="string"){const l=i.length;n===void 0&&(n=l),s===void 0&&(s=l)}else n=0,s=0;if(!Dt(a))return g9(o,n,o,s,"text","text");{const l=lf();l!==a.anchor.key&&l!==a.focus.key||ti(o),a.setTextNodeRange(this,n,this,s)}return a}selectStart(){return this.select(0,0)}selectEnd(){const t=this.getTextContentSize();return this.select(t,t)}spliceText(t,r,n,s){const a=this.getWritable(),i=a.__text,o=n.length;let l=t;l<0&&(l=o+l,l<0&&(l=0));const u=Xt();if(s&&Dt(u)){const h=t+o;u.setTextNodeRange(a,h,a,h)}const d=i.slice(0,l)+n+i.slice(l+r);return a.__text=d,a}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...t){ei();const r=this.getLatest(),n=r.getTextContent();if(n==="")return[];const s=r.__key,a=lf(),i=n.length;t.sort(((A,j)=>A-j)),t.push(i);const o=[],l=t.length;for(let A=0,j=0;A<i&&j<=l;j++){const R=t[j];R>A&&(o.push(n.slice(A,R)),A=R)}const u=o.length;if(u===1)return[r];const d=o[0],h=r.getParent();let g;const p=r.getFormat(),x=r.getStyle(),v=r.__detail;let w=!1,C=null,k=null;const _=Xt();if(Dt(_)){const[A,j]=_.isBackward()?[_.focus,_.anchor]:[_.anchor,_.focus];A.type==="text"&&A.key===s&&(C=A),j.type==="text"&&j.key===s&&(k=j)}r.isSegmented()?(g=_s(d),g.__format=p,g.__style=x,g.__detail=v,g.__state=DP(r,g),w=!0):g=r.setTextContent(d);const N=[g];for(let A=1;A<u;A++){const j=_s(o[A]);j.__format=p,j.__style=x,j.__detail=v,j.__state=DP(r,j);const R=j.__key;a===s&&ti(R),N.push(j)}const E=C?C.offset:null,P=k?k.offset:null;let F=0;for(const A of N){if(!C&&!k)break;const j=F+A.getTextContentSize();if(C!==null&&E!==null&&E<=j&&E>=F&&(C.set(A.getKey(),E-F,"text"),E<j&&(C=null)),k!==null&&P!==null&&P<=j&&P>=F){k.set(A.getKey(),P-F,"text");break}F=j}if(h!==null){(function(R){const U=R.getPreviousSibling(),Y=R.getNextSibling();U!==null&&jb(U),Y!==null&&jb(Y)})(this);const A=h.getWritable(),j=this.getIndexWithinParent();w?(A.splice(j,0,N),this.remove()):A.splice(j,1,N),Dt(_)&&Tb(_,h,j,u-1)}return N}mergeWithSibling(t){const r=t===this.getPreviousSibling();r||t===this.getNextSibling()||$t(50);const n=this.__key,s=t.__key,a=this.__text,i=a.length;lf()===s&&ti(n);const o=Xt();if(Dt(o)){const h=o.anchor,g=o.focus;h!==null&&h.key===s&&t8(h,r,n,t,i),g!==null&&g.key===s&&t8(g,r,n,t,i)}const l=t.__text,u=r?l+a:a+l;this.setTextContent(u);const d=this.getWritable();return t.remove(),d}isTextEntity(){return!1}}function Lte(e){return{forChild:g4(e.style),node:null}}function Bte(e){const t=e,r=t.style.fontWeight==="normal";return{forChild:g4(t.style,r?void 0:"bold"),node:null}}const VP=new WeakMap;function $te(e){if(!qn(e))return!1;if(e.nodeName==="PRE")return!0;const t=e.style.whiteSpace;return typeof t=="string"&&t.startsWith("pre")}function Ute(e){const t=e;e.parentElement===null&&$t(129);let r=t.textContent||"";if((function(n){let s,a=n.parentNode;const i=[n];for(;a!==null&&(s=VP.get(a))===void 0&&!$te(a);)i.push(a),a=a.parentNode;const o=s===void 0?a:s;for(let l=0;l<i.length;l++)VP.set(i[l],o);return o})(t)!==null){const n=r.split(/(\r?\n|\t)/),s=[],a=n.length;for(let i=0;i<a;i++){const o=n[i];o===`
`||o===`\r
`?s.push(qc()):o==="	"?s.push($m()):o!==""&&s.push(_s(o))}return{node:s}}if(r=r.replace(/\r/g,"").replace(/[ \t\n]+/g," "),r==="")return{node:null};if(r[0]===" "){let n=t,s=!0;for(;n!==null&&(n=KP(n,!1))!==null;){const a=n.textContent||"";if(a.length>0){/[ \t\n]$/.test(a)&&(r=r.slice(1)),s=!1;break}}s&&(r=r.slice(1))}if(r[r.length-1]===" "){let n=t,s=!0;for(;n!==null&&(n=KP(n,!0))!==null;)if((n.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){s=!1;break}s&&(r=r.slice(0,r.length-1))}return r===""?{node:null}:{node:_s(r)}}function KP(e,t){let r=e;for(;;){let n;for(;(n=t?r.nextSibling:r.previousSibling)===null;){const a=r.parentElement;if(a===null)return null;r=a}if(r=n,qn(r)){const a=r.style.display;if(a===""&&!eE(r)||a!==""&&!a.startsWith("inline"))return null}let s=r;for(;(s=t?r.firstChild:r.lastChild)!==null;)r=s;if(sd(r))return r;if(r.nodeName==="BR")return null}}const zte={code:"code",em:"italic",i:"italic",mark:"highlight",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function ju(e){const t=zte[e.nodeName.toLowerCase()];return t===void 0?{node:null}:{forChild:g4(e.style,t),node:null}}function _s(e=""){return Ji(new Pf(e))}function Jt(e){return e instanceof Pf}function g4(e,t){const r=e.fontWeight,n=e.textDecoration.split(" "),s=r==="700"||r==="bold",a=n.includes("line-through"),i=e.fontStyle==="italic",o=n.includes("underline"),l=e.verticalAlign;return u=>(Jt(u)&&(s&&!u.hasFormat("bold")&&u.toggleFormat("bold"),a&&!u.hasFormat("strikethrough")&&u.toggleFormat("strikethrough"),i&&!u.hasFormat("italic")&&u.toggleFormat("italic"),o&&!u.hasFormat("underline")&&u.toggleFormat("underline"),l!=="sub"||u.hasFormat("subscript")||u.toggleFormat("subscript"),l!=="super"||u.hasFormat("superscript")||u.toggleFormat("superscript"),t&&!u.hasFormat(t)&&u.toggleFormat(t)),u)}class Nv extends Pf{static getType(){return"tab"}static clone(t){return new Nv(t.__key)}constructor(t){super("	",t),this.__detail=2}static importDOM(){return null}createDOM(t){const r=super.createDOM(t),n=am(t.theme,"tab");return n!==void 0&&r.classList.add(...n),r}static importJSON(t){return $m().updateFromJSON(t)}setTextContent(t){return t!=="	"&&t!==""&&$t(126),super.setTextContent("	")}spliceText(t,r,n,s){return n===""&&r===0||n==="	"&&r===1||$t(286),this}setDetail(t){return t!==2&&$t(127),this}setMode(t){return t!=="normal"&&$t(128),this}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function $m(){return Ji(new Nv)}function W_(e){return e instanceof Nv}class Wte{constructor(t,r,n){this._selection=null,this.key=t,this.offset=r,this.type=n}is(t){return this.key===t.key&&this.offset===t.offset&&this.type===t.type}isBefore(t){return this.key===t.key?this.offset<t.offset:R9(xl(Ju(this,"next")),xl(Ju(t,"next")))<0}getNode(){const t=Zs(this.key);return t===null&&$t(20),t}set(t,r,n,s){const a=this._selection,i=this.key;s&&this.key===t&&this.offset===r&&this.type===n||(this.key=t,this.offset=r,this.type=n,Av()||(lf()===i&&ti(t),a!==null&&(a.setCachedNodes(null),a.dirty=!0)))}}function Yc(e,t,r){return new Wte(e,t,r)}function ak(e,t){let r=t.__key,n=e.offset,s="element";if(Jt(t)){s="text";const a=t.getTextContentSize();n>a&&(n=a)}else if(!bt(t)){const a=t.getNextSibling();if(Jt(a))r=a.__key,n=0,s="text";else{const i=t.getParent();i&&(r=i.__key,n=t.getIndexWithinParent()+1)}}e.set(r,n,s)}function qP(e,t){if(bt(t)){const r=t.getLastDescendant();bt(r)||Jt(r)?ak(e,r):ak(e,t)}else ak(e,t)}class H_{constructor(t){this._cachedNodes=null,this._nodes=t,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){if(!pi(t))return!1;const r=this._nodes,n=t._nodes;return r.size===n.size&&Array.from(r).every((s=>n.has(s)))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(t){this.dirty=!0,this._nodes.add(t),this._cachedNodes=null}delete(t){this.dirty=!0,this._nodes.delete(t),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(t){return this._nodes.has(t)}clone(){return new H_(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(t){}insertText(){}insertNodes(t){const r=this.getNodes(),n=r.length,s=r[n-1];let a;if(Jt(s))a=s.select();else{const i=s.getIndexWithinParent()+1;a=s.getParentOrThrow().select(i,i)}a.insertNodes(t);for(let i=0;i<n;i++)r[i].remove()}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=this._nodes,n=[];for(const s of r){const a=Zs(s);a!==null&&n.push(a)}return Av()||(this._cachedNodes=n),n}getTextContent(){const t=this.getNodes();let r="";for(let n=0;n<t.length;n++)r+=t[n].getTextContent();return r}deleteNodes(){const t=this.getNodes();if((Xt()||Um())===this&&t[0]){const r=si(t[0],"next");Ere(_f(r,r))}for(const r of t)r.remove()}}function Dt(e){return e instanceof _0}class _0{constructor(t,r,n,s){this.anchor=t,this.focus=r,t._selection=this,r._selection=this,this._cachedNodes=null,this.format=n,this.style=s,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){return!!Dt(t)&&this.anchor.is(t.anchor)&&this.focus.is(t.focus)&&this.format===t.format&&this.style===t.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=(function(n){const s=[],[a,i]=n.getTextSlices();a&&s.push(a.caret.origin);const o=new Set,l=new Set;for(const u of n)if(Vc(u)){const{origin:d}=u;s.length===0?o.add(d):(l.add(d),s.push(d))}else{const{origin:d}=u;bt(d)&&l.has(d)||s.push(d)}if(i&&s.push(i.caret.origin),i0(n.focus)&&bt(n.focus.origin)&&n.focus.getNodeAtCaret()===null)for(let u=Sl(n.focus.origin,"previous");Vc(u)&&o.has(u.origin)&&!u.origin.isEmpty()&&u.origin.is(s[s.length-1]);u=I4(u))o.delete(u.origin),s.pop();for(;s.length>1;){const u=s[s.length-1];if(!bt(u)||l.has(u)||u.isEmpty()||o.has(u))break;s.pop()}if(s.length===0&&n.isCollapsed()){const u=xl(n.anchor),d=xl(n.anchor.getFlipped()),h=p=>gf(p)?p.origin:p.getNodeAtCaret(),g=h(u)||h(d)||(n.anchor.getNodeAtCaret()?u.origin:d.origin);s.push(g)}return s})(L9(b8(this),"next"));return Av()||(this._cachedNodes=r),r}setTextNodeRange(t,r,n,s){this.anchor.set(t.__key,r,"text"),this.focus.set(n.__key,s,"text")}getTextContent(){const t=this.getNodes();if(t.length===0)return"";const r=t[0],n=t[t.length-1],s=this.anchor,a=this.focus,i=s.isBefore(a),[o,l]=KT(this);let u="",d=!0;for(let h=0;h<t.length;h++){const g=t[h];if(bt(g)&&!g.isInline())d||(u+=`
`),d=!g.isEmpty();else if(d=!1,Jt(g)){let p=g.getTextContent();g===r?g===n?s.type==="element"&&a.type==="element"&&a.offset!==s.offset||(p=o<l?p.slice(o,l):p.slice(l,o)):p=i?p.slice(o):p.slice(l):g===n&&(p=i?p.slice(0,l):p.slice(0,o)),u+=p}else!gn(g)&&!zu(g)||g===n&&this.isCollapsed()||(u+=g.getTextContent())}return u}applyDOMRange(t){const r=gs(),n=r.getEditorState()._selection,s=h9(t.startContainer,t.startOffset,t.endContainer,t.endOffset,r,n);if(s===null)return;const[a,i]=s;this.anchor.set(a.key,a.offset,a.type,!0),this.focus.set(i.key,i.offset,i.type,!0),vb(this)}clone(){const t=this.anchor,r=this.focus;return new _0(Yc(t.key,t.offset,t.type),Yc(r.key,r.offset,r.type),this.format,this.style)}toggleFormat(t){this.format=Ab(this.format,t,null),this.dirty=!0}setFormat(t){this.format=t,this.dirty=!0}setStyle(t){this.style=t,this.dirty=!0}hasFormat(t){const r=e0[t];return!!(this.format&r)}insertRawText(t){const r=t.split(/(\r?\n|\t)/),n=[],s=r.length;for(let a=0;a<s;a++){const i=r[a];i===`
`||i===`\r
`?n.push(qc()):i==="	"?n.push($m()):n.push(_s(i))}this.insertNodes(n)}insertText(t){const r=this.anchor,n=this.focus,s=this.format,a=this.style;let i=r,o=n;!this.isCollapsed()&&n.isBefore(r)&&(i=n,o=r),i.type==="element"&&(function(w,C,k,_){const N=w.getNode(),E=N.getChildAtIndex(w.offset),P=_s();if(P.setFormat(k),P.setStyle(_),b4(E))E.splice(0,0,[P]);else{const F=ga(N)?Kn().append(P):P;E===null?N.append(F):E.insertBefore(F)}w.is(C)&&C.set(P.__key,0,"text"),w.set(P.__key,0,"text")})(i,o,s,a),o.type==="element"&&l0(o,xl(Ju(o,"next")));const l=i.offset;let u=o.offset;const d=this.getNodes(),h=d.length;let g=d[0];Jt(g)||$t(26);const p=g.getTextContent().length,x=g.getParentOrThrow();let v=d[h-1];if(h===1&&o.type==="element"&&(u=p,o.set(i.key,u,"text")),this.isCollapsed()&&l===p&&(Fu(g)||!g.canInsertTextAfter()||!x.canInsertTextAfter()&&g.getNextSibling()===null)){let w=g.getNextSibling();if(Jt(w)&&w.canInsertTextBefore()&&!Fu(w)||(w=_s(),w.setFormat(s),w.setStyle(a),x.canInsertTextAfter()?g.insertAfter(w):x.insertAfter(w)),w.select(0,0),g=w,t!=="")return void this.insertText(t)}else if(this.isCollapsed()&&l===0&&(Fu(g)||!g.canInsertTextBefore()||!x.canInsertTextBefore()&&g.getPreviousSibling()===null)){let w=g.getPreviousSibling();if(Jt(w)&&!Fu(w)||(w=_s(),w.setFormat(s),x.canInsertTextBefore()?g.insertBefore(w):x.insertBefore(w)),w.select(),g=w,t!=="")return void this.insertText(t)}else if(g.isSegmented()&&l!==p){const w=_s(g.getTextContent());w.setFormat(s),g.replace(w),g=w}else if(!this.isCollapsed()&&t!==""){const w=v.getParent();if(!x.canInsertTextBefore()||!x.canInsertTextAfter()||bt(w)&&(!w.canInsertTextBefore()||!w.canInsertTextAfter()))return this.insertText(""),f9(this.anchor,this.focus,null),void this.insertText(t)}if(h===1){if($h(g)){const _=_s(t);return _.select(),void g.replace(_)}const w=g.getFormat(),C=g.getStyle();if(l!==u||w===s&&C===a){if(W_(g)){const _=_s(t);return _.setFormat(s),_.setStyle(a),_.select(),void g.replace(_)}}else{if(g.getTextContent()!==""){const _=_s(t);if(_.setFormat(s),_.setStyle(a),_.select(),l===0)g.insertBefore(_,!1);else{const[N]=g.splitText(l);N.insertAfter(_,!1)}return void(_.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length))}g.setFormat(s),g.setStyle(a)}const k=u-l;g=g.spliceText(l,k,t,!0),g.getTextContent()===""?g.remove():this.anchor.type==="text"&&(g.isComposing()?this.anchor.offset-=t.length:(this.format=w,this.style=C))}else{const w=new Set([...g.getParentKeys(),...v.getParentKeys()]),C=bt(g)?g:g.getParentOrThrow();let k=bt(v)?v:v.getParentOrThrow(),_=v;if(!C.is(k)&&k.isInline())do _=k,k=k.getParentOrThrow();while(k.isInline());if(o.type==="text"&&(u!==0||v.getTextContent()==="")||o.type==="element"&&v.getIndexWithinParent()<u)if(Jt(v)&&!$h(v)&&u!==v.getTextContentSize()){if(v.isSegmented()){const A=_s(v.getTextContent());v.replace(A),v=A}ga(o.getNode())||o.type!=="text"||(v=v.spliceText(0,u,"")),w.add(v.__key)}else{const A=v.getParentOrThrow();A.canBeEmpty()||A.getChildrenSize()!==1?v.remove():A.remove()}else w.add(v.__key);const N=k.getChildren(),E=new Set(d),P=C.is(k),F=C.isInline()&&g.getNextSibling()===null?C:g;for(let A=N.length-1;A>=0;A--){const j=N[A];if(j.is(g)||bt(j)&&j.isParentOf(g))break;j.isAttached()&&(!E.has(j)||j.is(_)?P||F.insertAfter(j,!1):j.remove())}if(!P){let A=k,j=null;for(;A!==null;){const R=A.getChildren(),U=R.length;(U===0||R[U-1].is(j))&&(w.delete(A.__key),j=A),A=A.getParent()}}if($h(g))if(l===p)g.select();else{const A=_s(t);A.select(),g.replace(A)}else g=g.spliceText(l,p-l,t,!0),g.getTextContent()===""?g.remove():g.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length);for(let A=1;A<h;A++){const j=d[A],R=j.__key;w.has(R)||j.remove()}}}removeText(){const t=Xt()===this;sb(this,Nre(b8(this))),t&&Xt()!==this&&ai(this)}formatText(t,r=null){if(this.isCollapsed())return this.toggleFormat(t),void ti(null);const n=this.getNodes(),s=[];for(const N of n)Jt(N)&&s.push(N);const a=N=>{n.forEach((E=>{if(bt(E)){const P=E.getFormatFlags(t,N);E.setTextFormat(P)}}))},i=s.length;if(i===0)return this.toggleFormat(t),ti(null),void a(r);const o=this.anchor,l=this.focus,u=this.isBackward(),d=u?l:o,h=u?o:l;let g=0,p=s[0],x=d.type==="element"?0:d.offset;if(d.type==="text"&&x===p.getTextContentSize()&&(g=1,p=s[1],x=0),p==null)return;const v=p.getFormatFlags(t,r);a(v);const w=i-1;let C=s[w];const k=h.type==="text"?h.offset:C.getTextContentSize();if(p.is(C)){if(x===k)return;if(Fu(p)||x===0&&k===p.getTextContentSize())p.setFormat(v);else{const N=p.splitText(x,k),E=x===0?N[0]:N[1];E.setFormat(v),d.type==="text"&&d.set(E.__key,0,"text"),h.type==="text"&&h.set(E.__key,k-x,"text")}return void(this.format=v)}x===0||Fu(p)||([,p]=p.splitText(x),x=0),p.setFormat(v);const _=C.getFormatFlags(t,v);k>0&&(k===C.getTextContentSize()||Fu(C)||([C]=C.splitText(k)),C.setFormat(_));for(let N=g+1;N<w;N++){const E=s[N],P=E.getFormatFlags(t,_);E.setFormat(P)}d.type==="text"&&d.set(p.__key,x,"text"),h.type==="text"&&h.set(C.__key,k,"text"),this.format=v|_}insertNodes(t){if(t.length===0)return;if(this.isCollapsed()||this.removeText(),this.anchor.key==="root"){this.insertParagraph();const x=Xt();return Dt(x)||$t(134),x.insertNodes(t)}const r=(this.isBackward()?this.focus:this.anchor).getNode(),n=uk(r,pl),s=t[t.length-1];if(bt(n)&&"__language"in n){if("__language"in t[0])this.insertText(t[0].getTextContent());else{const x=ik(this);n.splice(x,0,t),s.selectEnd()}return}if(!t.some((x=>(bt(x)||gn(x))&&!x.isInline()))){bt(n)||$t(211,r.constructor.name,r.getType());const x=ik(this);return n.splice(x,0,t),void s.selectEnd()}const a=(function(x){const v=Kn();let w=null;for(let C=0;C<x.length;C++){const k=x[C],_=zu(k);if(_||gn(k)&&k.isInline()||bt(k)&&k.isInline()||Jt(k)||k.isParentRequired()){if(w===null&&(w=k.createParentElementNode(),v.append(w),_))continue;w!==null&&w.append(k)}else v.append(k),w=null}return v})(t),i=a.getLastDescendant(),o=a.getChildren(),l=!bt(n)||!n.isEmpty()?this.insertParagraph():null,u=o[o.length-1];let d=o[0];var h;bt(h=d)&&pl(h)&&!h.isEmpty()&&bt(n)&&(!n.isEmpty()||n.canMergeWhenEmpty())&&(bt(n)||$t(211,r.constructor.name,r.getType()),n.append(...d.getChildren()),d=o[1]),d&&(n===null&&$t(212,r.constructor.name,r.getType()),(function(x,v,w){const C=v.getParentOrThrow().getLastChild();let k=v;const _=[v];for(;k!==C;)k.getNextSibling()||$t(140),k=k.getNextSibling(),_.push(k);let N=x;for(const E of _)N=N.insertAfter(E)})(n,d));const g=uk(i,pl);l&&bt(g)&&(l.canMergeWhenEmpty()||pl(u))&&(g.append(...l.getChildren()),l.remove()),bt(n)&&n.isEmpty()&&n.remove(),i.selectEnd();const p=bt(n)?n.getLastChild():null;zu(p)&&g!==n&&p.remove()}insertParagraph(){if(this.anchor.key==="root"){const i=Kn();return is().splice(this.anchor.offset,0,[i]),i.select(),i}const t=ik(this),r=uk(this.anchor.getNode(),pl);bt(r)||$t(213);const n=r.getChildAtIndex(t),s=n?[n,...n.getNextSiblings()]:[],a=r.insertNewAfter(this,!1);return a?(a.append(...s),a.selectStart(),a):null}insertLineBreak(t){const r=qc();if(this.insertNodes([r]),t){const n=r.getParentOrThrow(),s=r.getIndexWithinParent();n.select(s,s)}}extract(){const t=this.getNodes(),r=t.length,n=r-1,s=this.anchor,a=this.focus;let i=t[0],o=t[n];const[l,u]=KT(this);if(r===0)return[];if(r===1){if(Jt(i)&&!this.isCollapsed()){const h=l>u?u:l,g=l>u?l:u,p=i.splitText(h,g),x=h===0?p[0]:p[1];return x!=null?[x]:[]}return[i]}const d=s.isBefore(a);if(Jt(i)){const h=d?l:u;h===i.getTextContentSize()?t.shift():h!==0&&([,i]=i.splitText(h),t[0]=i)}if(Jt(o)){const h=o.getTextContent().length,g=d?u:l;g===0?t.pop():g!==h&&([o]=o.splitText(g),t[n]=o)}return t}modify(t,r,n){if(r8(this,t,r,n))return;const s=t==="move",a=gs(),i=ic(_l(a));if(!i)return;const o=a._blockCursorElement,l=a._rootElement,u=this.focus.getNode();if(l===null||o===null||!bt(u)||u.isInline()||u.canBeEmpty()||QT(o,a,l),this.dirty){let d=n0(a,this.anchor.key),h=n0(a,this.focus.key);this.anchor.type==="text"&&(d=vm(d)),this.focus.type==="text"&&(h=vm(h)),d&&h&&m9(i,d,this.anchor.offset,h,this.focus.offset)}if((function(d,h,g,p){d.modify(h,g,p)})(i,t,r?"backward":"forward",n),i.rangeCount>0){const d=i.getRangeAt(0),h=this.anchor.getNode(),g=ga(h)?h:fre(h);if(this.applyDOMRange(d),this.dirty=!0,!s){const p=this.getNodes(),x=[];let v=!1;for(let w=0;w<p.length;w++){const C=p[w];JT(C,g)?x.push(C):v=!0}if(v&&x.length>0)if(r){const w=x[0];bt(w)?w.selectStart():w.getParentOrThrow().selectStart()}else{const w=x[x.length-1];bt(w)?w.selectEnd():w.getParentOrThrow().selectEnd()}i.anchorNode===d.startContainer&&i.anchorOffset===d.startOffset||(function(w){const C=w.focus,k=w.anchor,_=k.key,N=k.offset,E=k.type;k.set(C.key,C.offset,C.type,!0),C.set(_,N,E,!0)})(this)}}n==="lineboundary"&&r8(this,t,r,n,"decorators")}forwardDeletion(t,r,n){if(!n&&(t.type==="element"&&bt(r)&&t.offset===r.getChildrenSize()||t.type==="text"&&t.offset===r.getTextContentSize())){const s=r.getParent(),a=r.getNextSibling()||(s===null?null:s.getNextSibling());if(bt(a)&&a.isShadowRoot())return!0}return!1}deleteCharacter(t){const r=this.isCollapsed();if(this.isCollapsed()){const n=this.anchor;let s=n.getNode();if(this.forwardDeletion(n,s,t))return;const a=L4(Ju(n,t?"previous":"next"));if(a.getTextSlices().every((o=>o===null||o.distance===0))){let o={type:"initial"};for(const l of a.iterNodeCarets("shadowRoot"))if(Vc(l)){if(!l.origin.isInline()){if(l.origin.isShadowRoot()){if(o.type==="merge-block")break;if(bt(a.anchor.origin)&&a.anchor.origin.isEmpty()){const u=xl(l);sb(this,_f(u,u)),a.anchor.origin.remove()}return}o.type!=="merge-next-block"&&o.type!=="merge-block"||(o={block:o.block,caret:l,type:"merge-block"})}}else{if(o.type==="merge-block")break;if(i0(l)){if(bt(l.origin)){if(l.origin.isInline()){if(!l.origin.isParentOf(a.anchor.origin))break}else o={block:l.origin,type:"merge-next-block"};continue}if(gn(l.origin)){if(!l.origin.isIsolated())if(o.type==="merge-next-block"&&(l.origin.isKeyboardSelectable()||!l.origin.isInline())&&bt(a.anchor.origin)&&a.anchor.origin.isEmpty()){a.anchor.origin.remove();const u=m4();u.add(l.origin.getKey()),ai(u)}else l.origin.remove();return}break}}if(o.type==="merge-block"){const{caret:l,block:u}=o;return sb(this,_f(!l.origin.isEmpty()&&u.isEmpty()?$4(si(u,l.direction)):a.anchor,l)),this.removeText()}}const i=this.focus;if(this.modify("extend",t,"character"),this.isCollapsed()){if(t&&n.offset===0&&XP(this,n.getNode()))return}else{const o=i.type==="text"?i.getNode():null;if(s=n.type==="text"?n.getNode():null,o!==null&&o.isSegmented()){const l=i.offset,u=o.getTextContentSize();if(o.is(s)||t&&l!==u||!t&&l!==0)return void JP(o,t,l)}else if(s!==null&&s.isSegmented()){const l=n.offset,u=s.getTextContentSize();if(s.is(o)||t&&l!==0||!t&&l!==u)return void JP(s,t,l)}(function(l,u){const d=l.anchor,h=l.focus,g=d.getNode(),p=h.getNode();if(g===p&&d.type==="text"&&h.type==="text"){const x=d.offset,v=h.offset,w=x<v,C=w?x:v,k=w?v:x,_=k-1;C!==_&&(function(N){return!(A9(N)||Hte(N))})(g.getTextContent().slice(C,k))&&(u?h.set(h.key,_,h.type):d.set(d.key,_,d.type))}})(this,t)}}if(this.removeText(),t&&!r&&this.isCollapsed()&&this.anchor.type==="element"&&this.anchor.offset===0){const n=this.anchor.getNode();n.isEmpty()&&ga(n.getParent())&&n.getPreviousSibling()===null&&XP(this,n)}}deleteLine(t){this.isCollapsed()&&this.modify("extend",t,"lineboundary"),this.isCollapsed()?this.deleteCharacter(t):this.removeText()}deleteWord(t){if(this.isCollapsed()){const r=this.anchor,n=r.getNode();if(this.forwardDeletion(r,n,t))return;this.modify("extend",t,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function pi(e){return e instanceof H_}function YP(e){const t=e.offset;if(e.type==="text")return t;const r=e.getNode();return t===r.getChildrenSize()?r.getTextContent().length:0}function KT(e){const t=e.getStartEndPoints();if(t===null)return[0,0];const[r,n]=t;return r.type==="element"&&n.type==="element"&&r.key===n.key&&r.offset===n.offset?[0,0]:[YP(r),YP(n)]}function XP(e,t){for(let r=t;r;r=r.getParent()){if(bt(r)){if(r.collapseAtStart(e))return!0;if(qi(r))break}if(r.getPreviousSibling())break}return!1}const Hte=(()=>{try{const e=new RegExp("\\p{Emoji}","u"),t=e.test.bind(e);if(t("")&&t("#")&&t(""))return t}catch{}return()=>!1})();function JP(e,t,r){const n=e,s=n.getTextContent().split(/(?=\s)/g),a=s.length;let i=0,o=0;for(let u=0;u<a;u++){const d=u===a-1;if(o=i,i+=s[u].length,t&&i===r||i>r||d){s.splice(u,1),d&&(o=void 0);break}}const l=s.join("").trim();l===""?n.remove():(n.setTextContent(l),n.select(o,o))}function QP(e,t,r,n){let s,a=t;if(qn(e)){let i=!1;const o=e.childNodes,l=o.length,u=n._blockCursorElement;a===l&&(i=!0,a=l-1);let d=o[a],h=!1;if(d===u)d=o[a+1],h=!0;else if(u!==null){const g=u.parentNode;e===g&&t>Array.prototype.indexOf.call(g.children,u)&&a--}if(s=Jg(d),Jt(s))a=mf(s,i?"next":"previous");else{let g=Jg(e);if(g===null)return null;if(bt(g)){const p=n.getElementByKey(g.getKey());p===null&&$t(214),[g,a]=g.getDOMSlot(p).resolveChildIndex(g,p,e,t),bt(g)||$t(215),i&&a>=g.getChildrenSize()&&(a=Math.max(0,g.getChildrenSize()-1));let v=g.getChildAtIndex(a);if(bt(v)&&(function(w,C,k){const _=w.getParent();return k===null||_===null||!_.canBeEmpty()||_!==k.getNode()})(v,0,r)){const w=i?v.getLastDescendant():v.getFirstDescendant();w===null?g=v:(v=w,g=bt(v)?v:v.getParentOrThrow()),a=0}Jt(v)?(s=v,g=null,a=mf(v,i?"next":"previous")):v!==g&&i&&!h&&(bt(g)||$t(216),a=Math.min(g.getChildrenSize(),a+1))}else{const p=g.getIndexWithinParent();a=t===0&&gn(g)&&Jg(e)===g?p:p+1,g=g.getParentOrThrow()}if(bt(g))return Yc(g.__key,a,"element")}}else s=Jg(e);return Jt(s)?Yc(s.__key,mf(s,a,"clamp"),"text"):null}function ZP(e,t,r){const n=e.offset,s=e.getNode();if(n===0){const a=s.getPreviousSibling(),i=s.getParent();if(t){if((r||!t)&&a===null&&bt(i)&&i.isInline()){const o=i.getPreviousSibling();Jt(o)&&e.set(o.__key,o.getTextContent().length,"text")}}else bt(a)&&!r&&a.isInline()?e.set(a.__key,a.getChildrenSize(),"element"):Jt(a)&&e.set(a.__key,a.getTextContent().length,"text")}else if(n===s.getTextContent().length){const a=s.getNextSibling(),i=s.getParent();if(t&&bt(a)&&a.isInline())e.set(a.__key,0,"element");else if((r||t)&&a===null&&bt(i)&&i.isInline()&&!i.canInsertTextAfter()){const o=i.getNextSibling();Jt(o)&&e.set(o.__key,0,"text")}}}function f9(e,t,r){if(e.type==="text"&&t.type==="text"){const n=e.isBefore(t),s=e.is(t);ZP(e,n,s),ZP(t,!n,s),s&&t.set(e.key,e.offset,e.type);const a=gs();if(a.isComposing()&&a._compositionKey!==e.key&&Dt(r)){const i=r.anchor,o=r.focus;e.set(i.key,i.offset,i.type,!0),t.set(o.key,o.offset,o.type,!0)}}}function h9(e,t,r,n,s,a){if(e===null||r===null||!Fv(s,e,r))return null;const i=QP(e,t,Dt(a)?a.anchor:null,s);if(i===null)return null;const o=QP(r,n,Dt(a)?a.focus:null,s);if(o===null)return null;if(i.type==="element"&&o.type==="element"){const l=Jg(e),u=Jg(r);if(gn(l)&&gn(u))return null}return f9(i,o,a),[i,o]}function qT(e){return bt(e)&&!e.isInline()}function g9(e,t,r,n,s,a){const i=Ff(),o=new _0(Yc(e,t,s),Yc(r,n,a),0,"");return o.dirty=!0,i._selection=o,o}function G_(){const e=Yc("root",0,"element"),t=Yc("root",0,"element");return new _0(e,t,0,"")}function m4(){return new H_(new Set)}function p4(e,t,r,n){const s=r._window;if(s===null)return null;const a=n||s.event,i=a?a.type:void 0,o=i==="selectionchange",l=!FT&&(o||i==="beforeinput"||i==="compositionstart"||i==="compositionend"||i==="click"&&a&&a.detail===3||i==="drop"||i===void 0);let u,d,h,g;if(Dt(e)&&!l)return e.clone();if(t===null)return null;if(u=t.anchorNode,d=t.focusNode,h=t.anchorOffset,g=t.focusOffset,o&&Dt(e)&&!Fv(r,u,d))return e.clone();const p=h9(u,h,d,g,r,e);if(p===null)return null;const[x,v]=p;return new _0(x,v,Dt(e)?e.format:0,Dt(e)?e.style:"")}function Xt(){return Ff()._selection}function Um(){return gs()._editorState._selection}function Tb(e,t,r,n=1){const s=e.anchor,a=e.focus,i=s.getNode(),o=a.getNode();if(!t.is(i)&&!t.is(o))return;const l=t.__key;if(e.isCollapsed()){const u=s.offset;if(r<=u&&n>0||r<u&&n<0){const d=Math.max(0,u+n);s.set(l,d,"element"),a.set(l,d,"element"),e8(e)}}else{const u=e.isBackward(),d=u?a:s,h=d.getNode(),g=u?s:a,p=g.getNode();if(t.is(h)){const x=d.offset;(r<=x&&n>0||r<x&&n<0)&&d.set(l,Math.max(0,x+n),"element")}if(t.is(p)){const x=g.offset;(r<=x&&n>0||r<x&&n<0)&&g.set(l,Math.max(0,x+n),"element")}}e8(e)}function e8(e){const t=e.anchor,r=t.offset,n=e.focus,s=n.offset,a=t.getNode(),i=n.getNode();if(e.isCollapsed()){if(!bt(a))return;const o=a.getChildrenSize(),l=r>=o,u=l?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(Jt(u)){let d=0;l&&(d=u.getTextContentSize()),t.set(u.__key,d,"text"),n.set(u.__key,d,"text")}}else{if(bt(a)){const o=a.getChildrenSize(),l=r>=o,u=l?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(Jt(u)){let d=0;l&&(d=u.getTextContentSize()),t.set(u.__key,d,"text")}}if(bt(i)){const o=i.getChildrenSize(),l=s>=o,u=l?i.getChildAtIndex(o-1):i.getChildAtIndex(s);if(Jt(u)){let d=0;l&&(d=u.getTextContentSize()),n.set(u.__key,d,"text")}}}}function Eb(e,t,r,n,s){let a=null,i=0,o=null;n!==null?(a=n.__key,Jt(n)?(i=n.getTextContentSize(),o="text"):bt(n)&&(i=n.getChildrenSize(),o="element")):s!==null&&(a=s.__key,Jt(s)?o="text":bt(s)&&(o="element")),a!==null&&o!==null?e.set(a,i,o):(i=t.getIndexWithinParent(),i===-1&&(i=r.getChildrenSize()),e.set(r.__key,i,"element"))}function t8(e,t,r,n,s){e.type==="text"?e.set(r,e.offset+(t?0:s),"text"):e.offset>n.getIndexWithinParent()&&e.set(e.key,e.offset-1,"element")}function m9(e,t,r,n,s){try{e.setBaseAndExtent(t,r,n,s)}catch{}}function Gte(e,t,r,n,s,a,i){const o=n.anchorNode,l=n.focusNode,u=n.anchorOffset,d=n.focusOffset,h=document.activeElement;if(s.has(b9)&&h!==a||h!==null&&k4(h))return;if(!Dt(t))return void(e!==null&&Fv(r,o,l)&&n.removeAllRanges());const g=t.anchor,p=t.focus,x=g.key,v=p.key,w=n0(r,x),C=n0(r,v),k=g.offset,_=p.offset,N=t.format,E=t.style,P=t.isCollapsed();let F=w,A=C,j=!1;if(g.type==="text"){F=vm(w);const ee=g.getNode();j=ee.getFormat()!==N||ee.getStyle()!==E}else Dt(e)&&e.anchor.type==="text"&&(j=!0);var R,U,Y,Z,ae;if(p.type==="text"&&(A=vm(C)),F!==null&&A!==null&&(P&&(e===null||j||Dt(e)&&(e.format!==N||e.style!==E))&&(R=N,U=E,Y=k,Z=x,ae=performance.now(),s9=[R,U,Y,Z,ae]),u!==k||d!==_||o!==F||l!==A||n.type==="Range"&&P||(h!==null&&a.contains(h)||a.focus({preventScroll:!0}),g.type==="element"))){if(m9(n,F,k,A,_),!s.has(Qte)&&t.isCollapsed()&&a!==null&&a===document.activeElement){const ee=Dt(t)&&t.anchor.type==="element"?F.childNodes[k]||null:n.rangeCount>0?n.getRangeAt(0):null;if(ee!==null){let ne;if(ee instanceof Text){const L=document.createRange();L.selectNode(ee),ne=L.getBoundingClientRect()}else ne=ee.getBoundingClientRect();(function(L,H,M){const V=O9(M),W=j4(V);if(V===null||W===null)return;let{top:I,bottom:B}=H,q=0,J=0,se=M;for(;se!==null;){const X=se===V.body;if(X)q=0,J=_l(L).innerHeight;else{const le=se.getBoundingClientRect();q=le.top,J=le.bottom}let ie=0;if(I<q?ie=-(q-I):B>J&&(ie=B-J),ie!==0)if(X)W.scrollBy(0,ie);else{const le=se.scrollTop;se.scrollTop+=ie;const ce=se.scrollTop-le;I-=ce,B-=ce}if(X)break;se=Ov(se)}})(r,ne,a)}}HT=!0}}function Vte(e){let t=Xt()||Um();t===null&&(t=is().selectEnd()),t.insertNodes(e)}function ik(e){let t=e;e.isCollapsed()||t.removeText();const r=Xt();Dt(r)&&(t=r),Dt(t)||$t(161);const n=t.anchor;let s=n.getNode(),a=n.offset;for(;!pl(s);){const i=s;if([s,a]=Kte(s,a),i.is(s))break}return a}function Kte(e,t){const r=e.getParent();if(!r){const s=Kn();return is().append(s),s.select(),[is(),0]}if(Jt(e)){const s=e.splitText(t);if(s.length===0)return[r,e.getIndexWithinParent()];const a=t===0?0:1;return[r,s[0].getIndexWithinParent()+a]}if(!bt(e)||t===0)return[r,e.getIndexWithinParent()];const n=e.getChildAtIndex(t);if(n){const s=new _0(Yc(e.__key,t,"element"),Yc(e.__key,t,"element"),0,""),a=e.insertNewAfter(s);a&&a.append(n,...n.getNextSiblings())}return[r,e.getIndexWithinParent()+1]}function r8(e,t,r,n,s="decorators-and-blocks"){if(t==="move"&&n==="character"&&!e.isCollapsed()){const[d,h]=r===e.isBackward()?[e.focus,e.anchor]:[e.anchor,e.focus];return h.set(d.key,d.offset,d.type),!0}const a=Ju(e.focus,r?"previous":"next"),i=n==="lineboundary",o=t==="move";let l=a,u=s==="decorators-and-blocks";if(!M9(l)){for(const d of l){u=!1;const{origin:h}=d;if(!gn(h)||h.isIsolated()||(l=d,!i||!h.isInline()))break}if(u)for(const d of L4(a).iterNodeCarets(t==="extend"?"shadowRoot":"root")){if(Vc(d))d.origin.isInline()||(l=d);else{if(bt(d.origin))continue;gn(d.origin)&&!d.origin.isInline()&&(l=d)}break}}if(l===a)return!1;if(o&&!i&&gn(l.origin)&&l.origin.isKeyboardSelectable()){const d=m4();return d.add(l.origin.getKey()),ai(d),!0}return l=xl(l),o&&l0(e.anchor,l),l0(e.focus,l),u||!i}let Na=null,Aa=null,mo=!1,ok=!1,rb=0;const n8={characterData:!0,childList:!0,subtree:!0};function Av(){return mo||Na!==null&&Na._readOnly}function ei(){mo&&$t(13)}function p9(){rb>99&&$t(14)}function Ff(){return Na===null&&$t(195,x9()),Na}function gs(){return Aa===null&&$t(196,x9()),Aa}function x9(){let e=0;const t=new Set,r=q_.version;if(typeof window<"u")for(const s of document.querySelectorAll("[contenteditable]")){const a=Y_(s);if(C4(a))e++;else if(a){let i=String(a.constructor.version||"<0.17.1");i===r&&(i+=" (separately built, likely a bundler configuration issue)"),t.add(i)}}let n=` Detected on the page: ${e} compatible editor(s) with version ${r}`;return t.size&&(n+=` and incompatible editors with versions ${Array.from(t).join(", ")}`),n}function qte(){return Aa}function s8(e,t,r){const n=t.__type,s=S9(e,n);let a=r.get(n);a===void 0&&(a=Array.from(s.transforms),r.set(n,a));const i=a.length;for(let o=0;o<i&&(a[o](t),t.isAttached());o++);}function a8(e,t){return e!==void 0&&e.__key!==t&&e.isAttached()}function y9(e,t){if(!t)return;const r=e._updateTags;let n=t;Array.isArray(t)||(n=[t]);for(const s of n)r.add(s)}function Yte(e){return x4(e,gs()._nodes)}function x4(e,t){const r=e.type,n=t.get(r);n===void 0&&$t(17,r);const s=n.klass;e.type!==s.getType()&&$t(18,s.name);const a=s.importJSON(e),i=e.children;if(bt(a)&&Array.isArray(i))for(let o=0;o<i.length;o++){const l=x4(i[o],t);a.append(l)}return a}function i8(e,t,r){const n=Na,s=mo,a=Aa;Na=t,mo=!0,Aa=e;try{return r()}finally{Na=n,mo=s,Aa=a}}function Du(e,t){const r=e._pendingEditorState,n=e._rootElement,s=e._headless||n===null;if(r===null)return;const a=e._editorState,i=a._selection,o=r._selection,l=e._dirtyType!==Zh,u=Na,d=mo,h=Aa,g=e._updating,p=e._observer;let x=null;if(e._pendingEditorState=null,e._editorState=r,!s&&l&&p!==null){Aa=e,Na=r,mo=!1,e._updating=!0;try{const P=e._dirtyType,F=e._dirtyElements,A=e._dirtyLeaves;p.disconnect(),x=Ste(a,r,e,P,F,A)}catch(P){if(P instanceof Error&&e._onError(P),ok)throw P;return _9(e,null,n,r),RL(e),e._dirtyType=ym,ok=!0,Du(e,a),void(ok=!1)}finally{p.observe(n,n8),e._updating=g,Na=u,mo=d,Aa=h}}r._readOnly||(r._readOnly=!0);const v=e._dirtyLeaves,w=e._dirtyElements,C=e._normalizedNodes,k=e._updateTags,_=e._deferred;l&&(e._dirtyType=Zh,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements=new Map,e._normalizedNodes=new Set,e._updateTags=new Set),(function(P,F){const A=P._decorators;let j=P._pendingDecorators||A;const R=F._nodeMap;let U;for(U in j)R.has(U)||(j===A&&(j=E9(P)),delete j[U])})(e,r);const N=s?null:ic(_l(e));if(e._editable&&N!==null&&(l||o===null||o.dirty)&&n!==null&&!k.has(Zte)){Aa=e,Na=r;try{if(p!==null&&p.disconnect(),l||o===null||o.dirty){const P=e._blockCursorElement;P!==null&&QT(P,e,n),Gte(i,o,e,N,k,n)}(function(P,F,A){let j=P._blockCursorElement;if(Dt(A)&&A.isCollapsed()&&A.anchor.type==="element"&&F.contains(document.activeElement)){const R=A.anchor,U=R.getNode(),Y=R.offset;let Z=!1,ae=null;if(Y===U.getChildrenSize())ck(U.getChildAtIndex(Y-1))&&(Z=!0);else{const ee=U.getChildAtIndex(Y);if(ee!==null&&ck(ee)){const ne=ee.getPreviousSibling();(ne===null||ck(ne))&&(Z=!0,ae=P.getElementByKey(ee.__key))}}if(Z){const ee=P.getElementByKey(U.__key);return j===null&&(P._blockCursorElement=j=(function(ne){const L=ne.theme,H=document.createElement("div");H.contentEditable="false",H.setAttribute("data-lexical-cursor","true");let M=L.blockCursor;if(M!==void 0){if(typeof M=="string"){const V=jL(M);M=L.blockCursor=V}M!==void 0&&H.classList.add(...M)}return H})(P._config)),F.style.caretColor="transparent",void(ae===null?ee.appendChild(j):ee.insertBefore(j,ae))}}j!==null&&QT(j,P,F)})(e,n,o)}finally{p!==null&&p.observe(n,n8),Aa=h,Na=u}}x!==null&&(function(P,F,A,j,R){const U=Array.from(P._listeners.mutation),Y=U.length;for(let Z=0;Z<Y;Z++){const[ae,ee]=U[Z];for(const ne of ee){const L=F.get(ne);L!==void 0&&ae(L,{dirtyLeaves:j,prevEditorState:R,updateTags:A})}}})(e,x,k,v,a),Dt(o)||o===null||i!==null&&i.is(o)||e.dispatchCommand(zL,void 0);const E=e._pendingDecorators;E!==null&&(e._decorators=E,e._pendingDecorators=null,vy("decorator",e,!0,E)),(function(P,F,A){const j=d8(F),R=d8(A);j!==R&&vy("textcontent",P,!0,R)})(e,t||a,r),vy("update",e,!0,{dirtyElements:w,dirtyLeaves:v,editorState:r,mutatedNodes:x,normalizedNodes:C,prevEditorState:t||a,tags:k}),(function(P,F){if(P._deferred=[],F.length!==0){const A=P._updating;P._updating=!0;try{for(let j=0;j<F.length;j++)F[j]()}finally{P._updating=A}}})(e,_),(function(P){const F=P._updates;if(F.length!==0){const A=F.shift();if(A){const[j,R]=A;V_(P,j,R)}}})(e)}function vy(e,t,r,...n){const s=t._updating;t._updating=r;try{const a=Array.from(t._listeners[e]);for(let i=0;i<a.length;i++)a[i].apply(null,n)}finally{t._updating=s}}function o8(e,t){const r=e._updates;let n=t||!1;for(;r.length!==0;){const s=r.shift();if(s){const[a,i]=s,o=e._pendingEditorState;let l;i!==void 0&&(l=i.onUpdate,i.skipTransforms&&(n=!0),i.discrete&&(o===null&&$t(191),o._flushSync=!0),l&&e._deferred.push(l),y9(e,i.tag)),o==null?V_(e,a,i):a()}}return n}function V_(e,t,r){const n=e._updateTags;let s,a=!1,i=!1;r!==void 0&&(s=r.onUpdate,y9(e,r.tag),a=r.skipTransforms||!1,i=r.discrete||!1),s&&e._deferred.push(s);const o=e._editorState;let l=e._pendingEditorState,u=!1;(l===null||l._readOnly)&&(l=e._pendingEditorState=v9(l||o),u=!0),l._flushSync=i;const d=Na,h=mo,g=Aa,p=e._updating;Na=l,mo=!1,e._updating=!0,Aa=e;const x=e._headless||e.getRootElement()===null;_4(null);try{u&&(x?o._selection!==null&&(l._selection=o._selection.clone()):l._selection=(function(k,_){const N=k.getEditorState()._selection,E=ic(_l(k));return Dt(N)||N==null?p4(N,E,k,_):N.clone()})(e,r&&r.event||null));const w=e._compositionKey;t(),a=o8(e,a),(function(k,_){const N=_.getEditorState()._selection,E=k._selection;if(Dt(E)){const P=E.anchor,F=E.focus;let A;if(P.type==="text"&&(A=P.getNode(),A.selectionTransform(N,E)),F.type==="text"){const j=F.getNode();A!==j&&j.selectionTransform(N,E)}}})(l,e),e._dirtyType!==Zh&&(a?(function(k,_){const N=_._dirtyLeaves,E=k._nodeMap;for(const P of N){const F=E.get(P);Jt(F)&&F.isAttached()&&F.isSimpleText()&&!F.isUnmergeable()&&MP(F)}})(l,e):(function(k,_){const N=_._dirtyLeaves,E=_._dirtyElements,P=k._nodeMap,F=lf(),A=new Map;let j=N,R=j.size,U=E,Y=U.size;for(;R>0||Y>0;){if(R>0){_._dirtyLeaves=new Set;for(const Z of j){const ae=P.get(Z);Jt(ae)&&ae.isAttached()&&ae.isSimpleText()&&!ae.isUnmergeable()&&MP(ae),ae!==void 0&&a8(ae,F)&&s8(_,ae,A),N.add(Z)}if(j=_._dirtyLeaves,R=j.size,R>0){rb++;continue}}_._dirtyLeaves=new Set,_._dirtyElements=new Map,U.delete("root")&&U.set("root",!0);for(const Z of U){const ae=Z[0],ee=Z[1];if(E.set(ae,ee),!ee)continue;const ne=P.get(ae);ne!==void 0&&a8(ne,F)&&s8(_,ne,A)}j=_._dirtyLeaves,R=j.size,U=_._dirtyElements,Y=U.size,rb++}_._dirtyLeaves=N,_._dirtyElements=E})(l,e),o8(e),(function(k,_,N,E){const P=k._nodeMap,F=_._nodeMap,A=[];for(const[j]of E){const R=F.get(j);R!==void 0&&(R.isAttached()||(bt(R)&&FL(R,j,P,F,A,E),P.has(j)||E.delete(j),A.push(j)))}for(const j of A)F.delete(j);for(const j of N){const R=F.get(j);R===void 0||R.isAttached()||(P.has(j)||N.delete(j),F.delete(j))}})(o,l,e._dirtyLeaves,e._dirtyElements)),w!==e._compositionKey&&(l._flushSync=!0);const C=l._selection;if(Dt(C)){const k=l._nodeMap,_=C.anchor.key,N=C.focus.key;k.get(_)!==void 0&&k.get(N)!==void 0||$t(19)}else pi(C)&&C._nodes.size===0&&(l._selection=null)}catch(w){return w instanceof Error&&e._onError(w),e._pendingEditorState=o,e._dirtyType=ym,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),void Du(e)}finally{Na=d,mo=h,Aa=g,e._updating=p,rb=0}e._dirtyType!==Zh||e._deferred.length>0||(function(w,C){const k=C.getEditorState()._selection,_=w._selection;if(_!==null){if(_.dirty||!_.is(k))return!0}else if(k!==null)return!0;return!1})(l,e)?l._flushSync?(l._flushSync=!1,Du(e)):u&&sre((()=>{Du(e)})):(l._flushSync=!1,u&&(n.clear(),e._deferred=[],e._pendingEditorState=null))}function Fo(e,t,r){Aa===e&&r===void 0?t():V_(e,t,r)}class wy{constructor(t,r,n){this.element=t,this.before=r||null,this.after=n||null}withBefore(t){return new wy(this.element,t,this.after)}withAfter(t){return new wy(this.element,this.before,t)}withElement(t){return this.element===t?this:new wy(t,this.before,this.after)}insertChild(t){const r=this.before||this.getManagedLineBreak();return r!==null&&r.parentElement!==this.element&&$t(222),this.element.insertBefore(t,r),this}removeChild(t){return t.parentElement!==this.element&&$t(223),this.element.removeChild(t),this}replaceChild(t,r){return r.parentElement!==this.element&&$t(224),this.element.replaceChild(t,r),this}getFirstChild(){const t=this.after?this.after.nextSibling:this.element.firstChild;return t===this.before||t===this.getManagedLineBreak()?null:t}getManagedLineBreak(){return this.element.__lexicalLineBreak||null}setManagedLineBreak(t){if(t===null)this.removeManagedLineBreak();else{const r=t==="decorator"&&(xm||Uy);this.insertManagedLineBreak(r)}}removeManagedLineBreak(){const t=this.getManagedLineBreak();if(t){const r=this.element,n=t.nodeName==="IMG"?t.nextSibling:null;n&&r.removeChild(n),r.removeChild(t),r.__lexicalLineBreak=void 0}}insertManagedLineBreak(t){const r=this.getManagedLineBreak();if(r){if(t===(r.nodeName==="IMG"))return;this.removeManagedLineBreak()}const n=this.element,s=this.before,a=document.createElement("br");if(n.insertBefore(a,s),t){const i=document.createElement("img");i.setAttribute("data-lexical-linebreak","true"),i.style.cssText="display: inline !important; border: 0px !important; margin: 0px !important;",i.alt="",n.insertBefore(i,a),n.__lexicalLineBreak=i}else n.__lexicalLineBreak=a}getFirstChildOffset(){let t=0;for(let r=this.after;r!==null;r=r.previousSibling)t++;return t}resolveChildIndex(t,r,n,s){if(n===this.element){const l=this.getFirstChildOffset();return[t,Math.min(l+t.getChildrenSize(),Math.max(l,s))]}const a=l8(r,n);a.push(s);const i=l8(r,this.element);let o=t.getIndexWithinParent();for(let l=0;l<i.length;l++){const u=a[l],d=i[l];if(u===void 0||u<d)break;if(u>d){o+=1;break}}return[t.getParentOrThrow(),o]}}function l8(e,t){const r=[];let n=t;for(;n!==e&&n!==null;n=n.parentNode){let s=0;for(let a=n.previousSibling;a!==null;a=a.previousSibling)s++;r.push(s)}return n!==e&&$t(225),r.reverse()}class Ei extends Bm{constructor(t){super(t),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__style="",this.__indent=0,this.__dir=null,this.__textFormat=0,this.__textStyle=""}afterCloneFrom(t){super.afterCloneFrom(t),this.__key===t.__key&&(this.__first=t.__first,this.__last=t.__last,this.__size=t.__size),this.__indent=t.__indent,this.__format=t.__format,this.__style=t.__style,this.__dir=t.__dir,this.__textFormat=t.__textFormat,this.__textStyle=t.__textStyle}getFormat(){return this.getLatest().__format}getFormatType(){const t=this.getFormat();return ute[t]||""}getStyle(){return this.getLatest().__style}getIndent(){return this.getLatest().__indent}getChildren(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getChildrenKeys(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r.__key),r=r.getNextSibling();return t}getChildrenSize(){return this.getLatest().__size}isEmpty(){return this.getChildrenSize()===0}isDirty(){const t=gs()._dirtyElements;return t!==null&&t.has(this.__key)}isLastChild(){const t=this.getLatest(),r=this.getParentOrThrow().getLastChild();return r!==null&&r.is(t)}getAllTextNodes(){const t=[];let r=this.getFirstChild();for(;r!==null;){if(Jt(r)&&t.push(r),bt(r)){const n=r.getAllTextNodes();t.push(...n)}r=r.getNextSibling()}return t}getFirstDescendant(){let t=this.getFirstChild();for(;bt(t);){const r=t.getFirstChild();if(r===null)break;t=r}return t}getLastDescendant(){let t=this.getLastChild();for(;bt(t);){const r=t.getLastChild();if(r===null)break;t=r}return t}getDescendantByIndex(t){const r=this.getChildren(),n=r.length;if(t>=n){const a=r[n-1];return bt(a)&&a.getLastDescendant()||a||null}const s=r[t];return bt(s)&&s.getFirstDescendant()||s||null}getFirstChild(){const t=this.getLatest().__first;return t===null?null:Zs(t)}getFirstChildOrThrow(){const t=this.getFirstChild();return t===null&&$t(45,this.__key),t}getLastChild(){const t=this.getLatest().__last;return t===null?null:Zs(t)}getLastChildOrThrow(){const t=this.getLastChild();return t===null&&$t(96,this.__key),t}getChildAtIndex(t){const r=this.getChildrenSize();let n,s;if(t<r/2){for(n=this.getFirstChild(),s=0;n!==null&&s<=t;){if(s===t)return n;n=n.getNextSibling(),s++}return null}for(n=this.getLastChild(),s=r-1;n!==null&&s>=t;){if(s===t)return n;n=n.getPreviousSibling(),s--}return null}getTextContent(){let t="";const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContent(),bt(a)&&s!==n-1&&!a.isInline()&&(t+=Xu)}return t}getTextContentSize(){let t=0;const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContentSize(),bt(a)&&s!==n-1&&!a.isInline()&&(t+=Xu.length)}return t}getDirection(){return this.getLatest().__dir}getTextFormat(){return this.getLatest().__textFormat}hasFormat(t){if(t!==""){const r=AP[t];return!!(this.getFormat()&r)}return!1}hasTextFormat(t){const r=e0[t];return!!(this.getTextFormat()&r)}getFormatFlags(t,r){return Ab(this.getLatest().__textFormat,t,r)}getTextStyle(){return this.getLatest().__textStyle}select(t,r){ei();const n=Xt();let s=t,a=r;const i=this.getChildrenSize();if(!this.canBeEmpty()){if(t===0&&r===0){const l=this.getFirstChild();if(Jt(l)||bt(l))return l.select(0,0)}else if(!(t!==void 0&&t!==i||r!==void 0&&r!==i)){const l=this.getLastChild();if(Jt(l)||bt(l))return l.select()}}s===void 0&&(s=i),a===void 0&&(a=i);const o=this.__key;return Dt(n)?(n.anchor.set(o,s,"element"),n.focus.set(o,a,"element"),n.dirty=!0,n):g9(o,s,o,a,"element","element")}selectStart(){const t=this.getFirstDescendant();return t?t.selectStart():this.select()}selectEnd(){const t=this.getLastDescendant();return t?t.selectEnd():this.select()}clear(){const t=this.getWritable();return this.getChildren().forEach((r=>r.remove())),t}append(...t){return this.splice(this.getChildrenSize(),0,t)}setDirection(t){const r=this.getWritable();return r.__dir=t,r}setFormat(t){return this.getWritable().__format=t!==""?AP[t]:0,this}setStyle(t){return this.getWritable().__style=t||"",this}setTextFormat(t){const r=this.getWritable();return r.__textFormat=t,r}setTextStyle(t){const r=this.getWritable();return r.__textStyle=t,r}setIndent(t){return this.getWritable().__indent=t,this}splice(t,r,n){const s=n.length,a=this.getChildrenSize(),i=this.getWritable();t+r<=a||$t(226,String(t),String(r),String(a));const o=i.__key,l=[],u=[],d=this.getChildAtIndex(t+r);let h=null,g=a-r+s;if(t!==0)if(t===a)h=this.getLastChild();else{const x=this.getChildAtIndex(t);x!==null&&(h=x.getPreviousSibling())}if(r>0){let x=h===null?this.getFirstChild():h.getNextSibling();for(let v=0;v<r;v++){x===null&&$t(100);const w=x.getNextSibling(),C=x.__key;Uh(x.getWritable()),u.push(C),x=w}}let p=h;for(let x=0;x<s;x++){const v=n[x];p!==null&&v.is(p)&&(h=p=p.getPreviousSibling());const w=v.getWritable();w.__parent===o&&g--,Uh(w);const C=v.__key;if(p===null)i.__first=C,w.__prev=null;else{const k=p.getWritable();k.__next=C,w.__prev=k.__key}v.__key===o&&$t(76),w.__parent=o,l.push(C),p=v}if(t+r===a)p!==null&&(p.getWritable().__next=null,i.__last=p.__key);else if(d!==null){const x=d.getWritable();if(p!==null){const v=p.getWritable();x.__prev=p.__key,v.__next=d.__key}else x.__prev=null}if(i.__size=g,u.length){const x=Xt();if(Dt(x)){const v=new Set(u),w=new Set(l),{anchor:C,focus:k}=x;c8(C,v,w)&&Eb(C,C.getNode(),this,h,d),c8(k,v,w)&&Eb(k,k.getNode(),this,h,d),g!==0||this.canBeEmpty()||qi(this)||this.remove()}}return i}getDOMSlot(t){return new wy(t)}exportDOM(t){const{element:r}=super.exportDOM(t);if(qn(r)){const n=this.getIndent();n>0&&(r.style.paddingInlineStart=40*n+"px");const s=this.getDirection();s&&(r.dir=s)}return{element:r}}exportJSON(){const t={children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),...super.exportJSON()},r=this.getTextFormat(),n=this.getTextStyle();return r!==0&&(t.textFormat=r),n!==""&&(t.textStyle=n),t}updateFromJSON(t){return super.updateFromJSON(t).setFormat(t.format).setIndent(t.indent).setDirection(t.direction).setTextFormat(t.textFormat||0).setTextStyle(t.textStyle||"")}insertNewAfter(t,r){return null}canIndent(){return!0}collapseAtStart(t){return!1}excludeFromCopy(t){return!1}canReplaceWith(t){return!0}canInsertAfter(t){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(t){return!1}extractWithChild(t,r,n){return!1}canMergeWhenEmpty(){return!1}reconcileObservedMutation(t,r){const n=this.getDOMSlot(t);let s=n.getFirstChild();for(let a=this.getFirstChild();a;a=a.getNextSibling()){const i=r.getElementByKey(a.getKey());i!==null&&(s==null?(n.insertChild(i),s=i):s!==i&&n.replaceChild(i,s),s=s.nextSibling)}}}function bt(e){return e instanceof Ei}function c8(e,t,r){let n=e.getNode();for(;n;){const s=n.__key;if(t.has(s)&&!r.has(s))return!0;n=n.getParent()}return!1}class y4 extends Bm{decorate(t,r){$t(47)}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function gn(e){return e instanceof y4}class jv extends Ei{static getType(){return"root"}static clone(){return new jv}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){$t(51)}getTextContent(){const t=this.__cachedText;return!Av()&&gs()._dirtyType!==Zh||t===null?super.getTextContent():t}remove(){$t(52)}replace(t){$t(53)}insertBefore(t){$t(54)}insertAfter(t){$t(55)}updateDOM(t,r){return!1}splice(t,r,n){for(const s of n)bt(s)||gn(s)||$t(282);return super.splice(t,r,n)}static importJSON(t){return is().updateFromJSON(t)}collapseAtStart(){return!0}}function ga(e){return e instanceof jv}function v9(e){return new K_(new Map(e._nodeMap))}function v4(){return new K_(new Map([["root",new jv]]))}function w9(e){const t=e.exportJSON(),r=e.constructor;if(t.type!==r.getType()&&$t(130,r.name),bt(e)){const n=t.children;Array.isArray(n)||$t(59,r.name);const s=e.getChildren();for(let a=0;a<s.length;a++){const i=w9(s[a]);n.push(i)}}return t}class K_{constructor(t,r){this._nodeMap=t,this._selection=r||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(t,r){return i8(r&&r.editor||null,this,t)}clone(t){const r=new K_(this._nodeMap,t===void 0?this._selection:t);return r._readOnly=!0,r}toJSON(){return i8(null,this,(()=>({root:w9(is())})))}}const Nb="historic",Xte="history-push",by="history-merge",Jte="paste",b9="collaboration",Qte="skip-scroll-into-view",Zte="skip-dom-selection";class w4 extends Ei{static getType(){return"artificial"}createDOM(t){return document.createElement("div")}}class Pv extends Ei{static getType(){return"paragraph"}static clone(t){return new Pv(t.__key)}createDOM(t){const r=document.createElement("p"),n=am(t.theme,"paragraph");return n!==void 0&&r.classList.add(...n),r}updateDOM(t,r,n){return!1}static importDOM(){return{p:t=>({conversion:ere,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if(qn(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n)}return{element:r}}static importJSON(t){return Kn().updateFromJSON(t)}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle()}}insertNewAfter(t,r){const n=Kn();n.setTextFormat(t.format),n.setTextStyle(t.style);const s=this.getDirection();return n.setDirection(s),n.setFormat(this.getFormatType()),n.setStyle(this.getStyle()),this.insertAfter(n,r),n}collapseAtStart(){const t=this.getChildren();if(t.length===0||Jt(t[0])&&t[0].getTextContent().trim()===""){if(this.getNextSibling()!==null)return this.selectNext(),this.remove(),!0;if(this.getPreviousSibling()!==null)return this.selectPrevious(),this.remove(),!0}return!1}}function ere(e){const t=Kn();return e.style&&(t.setFormat(e.style.textAlign),F4(e,t)),{node:t}}function Kn(){return Ji(new Pv)}function b4(e){return e instanceof Pv}const on=0,Ug=1,tre=4;function _9(e,t,r,n){const s=e._keyToDOMMap;s.clear(),e._editorState=v4(),e._pendingEditorState=n,e._compositionKey=null,e._dirtyType=Zh,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),e._normalizedNodes=new Set,e._updateTags=new Set,e._updates=[],e._blockCursorElement=null;const a=e._observer;a!==null&&(a.disconnect(),e._observer=null),t!==null&&(t.textContent=""),r!==null&&(r.textContent="",s.set("root",r))}function rre(e){const t=e||{},r=qte(),n=t.theme||{},s=e===void 0?r:t.parentEditor||null,a=t.disableEvents||!1,i=v4(),o=t.namespace||(s!==null?s._config.namespace:j9()),l=t.editorState,u=[jv,Pf,Ev,Nv,Pv,w4,...t.nodes||[]],{onError:d,html:h}=t,g=t.editable===void 0||t.editable;let p;if(e===void 0&&r!==null)p=r._nodes;else{p=new Map;for(let v=0;v<u.length;v++){let w=u[v],C=null,k=null;if(typeof w!="function"){const F=w;w=F.replace,C=F.with,k=F.withKlass||null}const{ownNodeConfig:_}=O4(w),N=w.getType(),E=w.transform(),P=new Set;_&&_.$transform&&P.add(_.$transform),E!==null&&P.add(E),p.set(N,{exportDOM:h&&h.export?h.export.get(w):void 0,klass:w,replace:C,replaceWithKlass:k,sharedNodeState:yte(u[v]),transforms:P})}}const x=new q_(i,s,p,{disableEvents:a,namespace:o,theme:n},d||console.error,(function(v,w){const C=new Map,k=new Set,_=N=>{Object.keys(N).forEach((E=>{let P=C.get(E);P===void 0&&(P=[],C.set(E,P)),P.push(N[E])}))};return v.forEach((N=>{const E=N.klass.importDOM;if(E==null||k.has(E))return;k.add(E);const P=E.call(N.klass);P!==null&&_(P)})),w&&_(w),C})(p,h?h.import:void 0),g,e);return l!==void 0&&(x._pendingEditorState=l,x._dirtyType=ym),x}class q_{constructor(t,r,n,s,a,i,o,l){this._createEditorArgs=l,this._parentEditor=r,this._rootElement=null,this._editorState=t,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=s,this._nodes=n,this._decorators={},this._pendingDecorators=null,this._dirtyType=Zh,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=j9(),this._onError=a,this._htmlConversions=i,this._editable=o,this._headless=r!==null&&r._headless,this._window=null,this._blockCursorElement=null}isComposing(){return this._compositionKey!=null}registerUpdateListener(t){const r=this._listeners.update;return r.add(t),()=>{r.delete(t)}}registerEditableListener(t){const r=this._listeners.editable;return r.add(t),()=>{r.delete(t)}}registerDecoratorListener(t){const r=this._listeners.decorator;return r.add(t),()=>{r.delete(t)}}registerTextContentListener(t){const r=this._listeners.textcontent;return r.add(t),()=>{r.delete(t)}}registerRootListener(t){const r=this._listeners.root;return t(this._rootElement,null),r.add(t),()=>{t(null,this._rootElement),r.delete(t)}}registerCommand(t,r,n){n===void 0&&$t(35);const s=this._commands;s.has(t)||s.set(t,[new Set,new Set,new Set,new Set,new Set]);const a=s.get(t);a===void 0&&$t(36,String(t));const i=a[n];return i.add(r),()=>{i.delete(r),a.every((o=>o.size===0))&&s.delete(t)}}registerMutationListener(t,r,n){const s=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(t)).klass,a=this._listeners.mutation;let i=a.get(r);i===void 0&&(i=new Set,a.set(r,i)),i.add(s);const o=n&&n.skipInitialization;return o!==void 0&&o||this.initializeMutationListener(r,s),()=>{i.delete(s),i.size===0&&a.delete(r)}}getRegisteredNode(t){const r=this._nodes.get(t.getType());return r===void 0&&$t(37,t.name),r}resolveRegisteredNodeAfterReplacements(t){for(;t.replaceWithKlass;)t=this.getRegisteredNode(t.replaceWithKlass);return t}initializeMutationListener(t,r){const n=this._editorState,s=y8(n).get(r.getType());if(!s)return;const a=new Map;for(const i of s.keys())a.set(i,"created");a.size>0&&t(a,{dirtyLeaves:new Set,prevEditorState:n,updateTags:new Set(["registerMutationListener"])})}registerNodeTransformToKlass(t,r){const n=this.getRegisteredNode(t);return n.transforms.add(r),n}registerNodeTransform(t,r){const n=this.registerNodeTransformToKlass(t,r),s=[n],a=n.replaceWithKlass;if(a!=null){const i=this.registerNodeTransformToKlass(a,r);s.push(i)}return(function(i,o){const l=y8(i.getEditorState()),u=[];for(const d of o){const h=l.get(d);h&&u.push(h)}u.length!==0&&i.update((()=>{for(const d of u)for(const h of d.keys()){const g=Zs(h);g&&g.markDirty()}}),i._pendingEditorState===null?{tag:by}:void 0)})(this,s.map((i=>i.klass.getType()))),()=>{s.forEach((i=>i.transforms.delete(r)))}}hasNode(t){return this._nodes.has(t.getType())}hasNodes(t){return t.every(this.hasNode.bind(this))}dispatchCommand(t,r){return ar(this,t,r)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(t){const r=this._rootElement;if(t!==r){const n=am(this._config.theme,"root"),s=this._pendingEditorState||this._editorState;if(this._rootElement=t,_9(this,r,t,s),r!==null&&(this._config.disableEvents||Ite(r),n!=null&&r.classList.remove(...n)),t!==null){const a=j4(t),i=t.style;i.userSelect="text",i.whiteSpace="pre-wrap",i.wordBreak="break-word",t.setAttribute("data-lexical-editor","true"),this._window=a,this._dirtyType=ym,RL(this),this._updateTags.add(by),Du(this),this._config.disableEvents||(function(o,l){const u=o.ownerDocument,d=Cb.get(u);(d===void 0||d<1)&&u.addEventListener("selectionchange",c9),Cb.set(u,(d||0)+1),o.__lexicalEditor=l;const h=l9(o);for(let g=0;g<WT.length;g++){const[p,x]=WT[g],v=typeof x=="function"?w=>{HP(w)||(WP(w),(l.isEditable()||p==="click")&&x(w,l))}:w=>{if(HP(w))return;WP(w);const C=l.isEditable();switch(p){case"cut":return C&&ar(l,h4,w);case"copy":return ar(l,z_,w);case"paste":return C&&ar(l,u4,w);case"dragstart":return C&&ar(l,e9,w);case"dragover":return C&&ar(l,t9,w);case"dragend":return C&&ar(l,jte,w);case"focus":return C&&ar(l,Ote,w);case"blur":return C&&ar(l,Dte,w);case"drop":return C&&ar(l,QL,w)}};o.addEventListener(p,v),h.push((()=>{o.removeEventListener(p,v)}))}})(t,this),n!=null&&t.classList.add(...n)}else this._window=null,this._updateTags.add(by),Du(this);vy("root",this,!1,t,r)}}getElementByKey(t){return this._keyToDOMMap.get(t)||null}getEditorState(){return this._editorState}setEditorState(t,r){t.isEmpty()&&$t(38);let n=t;n._readOnly&&(n=v9(t),n._selection=t._selection?t._selection.clone():null),DL(this);const s=this._pendingEditorState,a=this._updateTags,i=r!==void 0?r.tag:null;s===null||s.isEmpty()||(i!=null&&a.add(i),Du(this)),this._pendingEditorState=n,this._dirtyType=ym,this._dirtyElements.set("root",!1),this._compositionKey=null,i!=null&&a.add(i),this._updating||Du(this)}parseEditorState(t,r){return(function(n,s,a){const i=v4(),o=Na,l=mo,u=Aa,d=s._dirtyElements,h=s._dirtyLeaves,g=s._cloneNotNeeded,p=s._dirtyType;s._dirtyElements=new Map,s._dirtyLeaves=new Set,s._cloneNotNeeded=new Set,s._dirtyType=0,Na=i,mo=!1,Aa=s,_4(null);try{const x=s._nodes;x4(n.root,x),a&&a(),i._readOnly=!0}catch(x){x instanceof Error&&s._onError(x)}finally{s._dirtyElements=d,s._dirtyLeaves=h,s._cloneNotNeeded=g,s._dirtyType=p,Na=o,mo=l,Aa=u}return i})(typeof t=="string"?JSON.parse(t):t,this,r)}read(t){return Du(this),this.getEditorState().read(t,{editor:this})}update(t,r){(function(n,s,a){n._updating?n._updates.push([s,a]):V_(n,s,a)})(this,t,r)}focus(t,r={}){const n=this._rootElement;n!==null&&(n.setAttribute("autocapitalize","off"),Fo(this,(()=>{const s=Xt(),a=is();s!==null?s.dirty||ai(s.clone()):a.getChildrenSize()!==0&&(r.defaultSelection==="rootStart"?a.selectStart():a.selectEnd()),cre("focus"),ure((()=>{n.removeAttribute("autocapitalize"),t&&t()}))})),this._pendingEditorState===null&&n.removeAttribute("autocapitalize"))}blur(){const t=this._rootElement;t!==null&&t.blur();const r=ic(this._window);r!==null&&r.removeAllRanges()}isEditable(){return this._editable}setEditable(t){this._editable!==t&&(this._editable=t,vy("editable",this,!0,t))}toJSON(){return{editorState:this._editorState.toJSON()}}}q_.version="0.35.0+prod.esm";let YT=null;function _4(e){YT=e}let nre=1;function S9(e,t){const r=S4(e,t);return r===void 0&&$t(30,t),r}function S4(e,t){return e._nodes.get(t)}const sre=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)};function u8(e){return gn(bf(e))}function k4(e){const t=document.activeElement;if(!qn(t))return!1;const r=t.nodeName;return gn(bf(e))&&(r==="INPUT"||r==="TEXTAREA"||t.contentEditable==="true"&&Y_(t)==null)}function Fv(e,t,r){const n=e.getRootElement();try{return n!==null&&n.contains(t)&&n.contains(r)&&t!==null&&!k4(t)&&k9(t)===e}catch{return!1}}function C4(e){return e instanceof q_}function k9(e){let t=e;for(;t!=null;){const r=Y_(t);if(C4(r))return r;t=Ov(t)}return null}function Y_(e){return e?e.__lexicalEditor:null}function $h(e){return W_(e)||e.isToken()}function Fu(e){return $h(e)||e.isSegmented()}function sd(e){return zm(e)&&e.nodeType===tte}function are(e){return zm(e)&&e.nodeType===rte}function vm(e){let t=e;for(;t!=null;){if(sd(t))return t;t=t.firstChild}return null}function Ab(e,t,r){const n=e0[t];if(r!==null&&(e&n)==(r&n))return e;let s=e^n;return t==="subscript"?s&=-65:t==="superscript"?s&=-33:t==="lowercase"?(s&=-513,s&=-1025):t==="uppercase"?(s&=-257,s&=-1025):t==="capitalize"&&(s&=-257,s&=-513),s}function C9(e){return Jt(e)||zu(e)||gn(e)}function ire(e,t){const r=(function(){const i=YT;return YT=null,i})();if((t=t||r&&r.__key)!=null)return void(e.__key=t);ei(),p9();const n=gs(),s=Ff(),a=""+nre++;s._nodeMap.set(a,e),bt(e)?n._dirtyElements.set(a,!0):n._dirtyLeaves.add(a),n._cloneNotNeeded.add(a),n._dirtyType=PL,e.__key=a}function Uh(e){const t=e.getParent();if(t!==null){const r=e.getWritable(),n=t.getWritable(),s=e.getPreviousSibling(),a=e.getNextSibling(),i=a!==null?a.__key:null,o=s!==null?s.__key:null,l=s!==null?s.getWritable():null,u=a!==null?a.getWritable():null;s===null&&(n.__first=i),a===null&&(n.__last=o),l!==null&&(l.__next=i),u!==null&&(u.__prev=o),r.__prev=null,r.__next=null,r.__parent=null,n.__size--}}function jb(e){p9();const t=e.getLatest(),r=t.__parent,n=Ff(),s=gs(),a=n._nodeMap,i=s._dirtyElements;r!==null&&(function(l,u,d){let h=l;for(;h!==null;){if(d.has(h))return;const g=u.get(h);if(g===void 0)break;d.set(h,!1),h=g.__parent}})(r,a,i);const o=t.__key;s._dirtyType=PL,bt(e)?i.set(o,!0):s._dirtyLeaves.add(o)}function ti(e){ei();const t=gs(),r=t._compositionKey;if(e!==r){if(t._compositionKey=e,r!==null){const n=Zs(r);n!==null&&n.getWritable()}if(e!==null){const n=Zs(e);n!==null&&n.getWritable()}}}function lf(){return Av()?null:gs()._compositionKey}function Zs(e,t){const r=(t||Ff())._nodeMap.get(e);return r===void 0?null:r}function T9(e,t){const r=X_(e,gs());return r!==void 0?Zs(r,t):null}function X_(e,t){return e[`__lexicalKey_${t._key}`]}function bf(e,t){let r=e;for(;r!=null;){const n=T9(r,t);if(n!==null)return n;r=Ov(r)}return null}function E9(e){const t=e._decorators,r=Object.assign({},t);return e._pendingDecorators=r,r}function d8(e){return e.read((()=>is().getTextContent()))}function is(){return N9(Ff())}function N9(e){return e._nodeMap.get("root")}function ai(e){ei();const t=Ff();e!==null&&(e.dirty=!0,e.setCachedNodes(null)),t._selection=e}function Jg(e){const t=gs(),r=(function(n,s){let a=n;for(;a!=null;){const i=X_(a,s);if(i!==void 0)return i;a=Ov(a)}return null})(e,t);return r===null?e===t.getRootElement()?Zs("root"):null:Zs(r)}function A9(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(e)}function T4(e){const t=[];let r=e;for(;r!==null;)t.push(r),r=r._parentEditor;return t}function j9(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,5)}function P9(e){return sd(e)?e.nodeValue:null}function E4(e,t,r){const n=ic(_l(t));if(n===null)return;const s=n.anchorNode;let{anchorOffset:a,focusOffset:i}=n;if(s!==null){let o=P9(s);const l=bf(s);if(o!==null&&Jt(l)){if(o===$_&&r){const u=r.length;o=r,a=u,i=u}o!==null&&N4(l,o,a,i,e)}}}function N4(e,t,r,n,s){let a=e;if(a.isAttached()&&(s||!a.isDirty())){const i=a.isComposing();let o=t;(i||s)&&t[t.length-1]===$_&&(o=t.slice(0,-1));const l=a.getTextContent();if(s||o!==l){if(o===""){if(ti(null),Uy||xm||pb)a.remove();else{const v=gs();setTimeout((()=>{v.update((()=>{a.isAttached()&&a.remove()}))}),20)}return}const u=a.getParent(),d=Um(),h=a.getTextContentSize(),g=lf(),p=a.getKey();if(a.isToken()||g!==null&&p===g&&!i||Dt(d)&&(u!==null&&!u.canInsertTextBefore()&&d.anchor.offset===0||d.anchor.key===e.__key&&d.anchor.offset===0&&!a.canInsertTextBefore()&&!i||d.focus.key===e.__key&&d.focus.offset===h&&!a.canInsertTextAfter()&&!i))return void a.markDirty();const x=Xt();if(!Dt(x)||r===null||n===null)return void f8(a,o,x);if(x.setTextNodeRange(a,r,a,n),a.isSegmented()){const v=_s(a.getTextContent());a.replace(v),a=v}f8(a,o,x)}}}function f8(e,t,r){if(e.setTextContent(t),Dt(r)){const n=e.getKey();for(const s of["anchor","focus"]){const a=r[s];a.type==="text"&&a.key===n&&(a.offset=mf(e,a.offset,"clamp"))}}}function yw(e,t,r){const n=t[r]||!1;return n==="any"||n===e[r]}function ore(e,t){return yw(e,t,"altKey")&&yw(e,t,"ctrlKey")&&yw(e,t,"shiftKey")&&yw(e,t,"metaKey")}function Sn(e,t,r){return ore(e,r)&&e.key.toLowerCase()===t.toLowerCase()}const Pu={ctrlKey:!Lc,metaKey:Lc},h8={altKey:Lc,ctrlKey:!Lc};function g8(e){return e.key==="Backspace"}function m8(e){return Sn(e,"a",Pu)}function lre(e){const t=is();if(Dt(e)){const r=e.anchor,n=e.focus,s=r.getNode().getTopLevelElementOrThrow().getParentOrThrow();return r.set(s.getKey(),0,"element"),n.set(s.getKey(),s.getChildrenSize(),"element"),vb(e),e}{const r=t.select(0,t.getChildrenSize());return ai(vb(r)),r}}function am(e,t){e.__lexicalClassNameCache===void 0&&(e.__lexicalClassNameCache={});const r=e.__lexicalClassNameCache,n=r[t];if(n!==void 0)return n;const s=e[t];if(typeof s=="string"){const a=jL(s);return r[t]=a,a}return s}function A4(e,t,r,n,s){if(r.size===0)return;const a=n.__type,i=n.__key,o=t.get(a);o===void 0&&$t(33,a);const l=o.klass;let u=e.get(l);u===void 0&&(u=new Map,e.set(l,u));const d=u.get(i),h=d==="destroyed"&&s==="created";(d===void 0||h)&&u.set(i,h?"updated":s)}function p8(e,t,r){const n=e.getParent();let s=r,a=e;return n!==null&&(t&&r===0?(s=a.getIndexWithinParent(),a=n):t||r!==a.getChildrenSize()||(s=a.getIndexWithinParent()+1,a=n)),a.getChildAtIndex(t?s-1:s)}function XT(e,t){const r=e.offset;if(e.type==="element")return p8(e.getNode(),t,r);{const n=e.getNode();if(t&&r===0||!t&&r===n.getTextContentSize()){const s=t?n.getPreviousSibling():n.getNextSibling();return s===null?p8(n.getParentOrThrow(),t,n.getIndexWithinParent()+(t?0:1)):s}}return null}function F9(e){const t=_l(e).event,r=t&&t.inputType;return r==="insertFromPaste"||r==="insertFromPasteAsQuotation"}function ar(e,t,r){return(function(n,s,a){const i=T4(n);for(let o=4;o>=0;o--)for(let l=0;l<i.length;l++){const u=i[l],d=u._commands.get(s);if(d!==void 0){const h=d[o];if(h!==void 0){const g=Array.from(h),p=g.length;let x=!1;if(Fo(u,(()=>{for(let v=0;v<p;v++)if(g[v](a,n))return void(x=!0)})),x)return x}}}return!1})(e,t,r)}function J_(e){return!ga(e)&&!e.isLastChild()&&!e.isInline()}function n0(e,t){const r=e._keyToDOMMap.get(t);return r===void 0&&$t(75,t),r}function Ov(e){const t=e.assignedSlot||e.parentElement;return ZT(t)?t.host:t}function O9(e){return are(e)?e:qn(e)?e.ownerDocument:null}function cre(e){ei(),gs()._updateTags.add(e)}function ure(e){ei(),gs()._deferred.push(e)}function JT(e,t){let r=e.getParent();for(;r!==null;){if(r.is(t))return!0;r=r.getParent()}return!1}function j4(e){const t=O9(e);return t?t.defaultView:null}function _l(e){const t=e._window;return t===null&&$t(78),t}function dre(e){return bt(e)&&e.isInline()||gn(e)&&e.isInline()}function fre(e){let t=e.getParentOrThrow();for(;t!==null;){if(qi(t))return t;t=t.getParentOrThrow()}return t}function qi(e){return ga(e)||bt(e)&&e.isShadowRoot()}function Ji(e){const t=gs(),r=e.getType(),n=S4(t,r);n===void 0&&$t(200,e.constructor.name,r);const{replace:s,replaceWithKlass:a}=n;if(s!==null){const i=s(e),o=i.constructor;return a!==null?i instanceof a||$t(201,a.name,a.getType(),o.name,o.getType(),e.constructor.name,r):i instanceof e.constructor&&o!==e.constructor||$t(202,o.name,o.getType(),e.constructor.name,r),i.__key===e.__key&&$t(203,e.constructor.name,r,o.name,o.getType()),i}return e}function lk(e,t){!ga(e.getParent())||bt(t)||gn(t)||$t(99)}function hre(e){const t=Zs(e);return t===null&&$t(63,e),t}function ck(e){return(gn(e)||bt(e)&&!e.canBeEmpty())&&!e.isInline()}function QT(e,t,r){r.style.removeProperty("caret-color"),t._blockCursorElement=null;const n=e.parentElement;n!==null&&n.removeChild(e)}function ic(e){return lc?(e||window).getSelection():null}function gre(e){const t=j4(e);return t?t.getSelection():null}function D9(e){return qn(e)&&e.tagName==="A"}function qn(e){return zm(e)&&e.nodeType===ete}function zm(e){return typeof e=="object"&&e!==null&&"nodeType"in e&&typeof e.nodeType=="number"}function ZT(e){return zm(e)&&e.nodeType===nte}function eE(e){const t=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|mark|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return e.nodeName.match(t)!==null}function Pb(e){const t=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return e.nodeName.match(t)!==null}function pl(e){if(gn(e)&&!e.isInline())return!0;if(!bt(e)||qi(e))return!1;const t=e.getFirstChild(),r=t===null||zu(t)||Jt(t)||t.isInline();return!e.isInline()&&e.canBeEmpty()!==!1&&r}function uk(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function Dv(){return gs()}const x8=new WeakMap,mre=new Map;function y8(e){if(!e._readOnly&&e.isEmpty())return mre;e._readOnly||$t(192);let t=x8.get(e);return t||(t=(function(r){const n=new Map;for(const[s,a]of r._nodeMap){const i=a.__type;let o=n.get(i);o||(o=new Map,n.set(i,o)),o.set(s,a)}return n})(e),x8.set(e,t)),t}function P4(e){const t=e.constructor.clone(e);return t.afterCloneFrom(e),t}function F4(e,t){const r=parseInt(e.style.paddingInlineStart,10)||0,n=Math.round(r/40);t.setIndent(n)}function pre(e){e.__lexicalUnmanaged=!0}function xre(e){return e.__lexicalUnmanaged===!0}function Hx(e,t){return(function(r,n){return Object.prototype.hasOwnProperty.call(r,n)})(e,t)&&e[t]!==Bm[t]}function O4(e){const t=jP in e.prototype?e.prototype[jP]():void 0,r=(function(i){return i===y4||i===Ei||i===Bm})(e),n=!r&&Hx(e,"getType")?e.getType():void 0;let s,a=n;if(t)if(n)s=t[n];else for(const[i,o]of Object.entries(t))a=i,s=o;if(!r&&a&&(Hx(e,"getType")||(e.getType=()=>a),Hx(e,"clone")||(e.clone=i=>(_4(i),new e)),Hx(e,"importJSON")||(e.importJSON=s&&s.$importJSON||(i=>new e().updateFromJSON(i))),!Hx(e,"importDOM")&&s)){const{importDOM:i}=s;i&&(e.importDOM=()=>i)}return{ownNodeConfig:s,ownNodeType:a}}function yre(e){const t=Dv();return ei(),new(t.resolveRegisteredNodeAfterReplacements(t.getRegisteredNode(e))).klass}const vre={next:"previous",previous:"next"};class D4{constructor(t){this.origin=t}[Symbol.iterator](){return B4({hasNext:i0,initial:this.getAdjacentCaret(),map:t=>t,step:t=>t.getAdjacentCaret()})}getAdjacentCaret(){return si(this.getNodeAtCaret(),this.direction)}getSiblingCaret(){return si(this.origin,this.direction)}remove(){const t=this.getNodeAtCaret();return t&&t.remove(),this}replaceOrInsert(t,r){const n=this.getNodeAtCaret();return t.is(this.origin)||t.is(n)||(n===null?this.insert(t):n.replace(t,r)),this}splice(t,r,n="next"){const s=n===this.direction?r:Array.from(r).reverse();let a=this;const i=this.getParentAtCaret(),o=new Map;for(let l=a.getAdjacentCaret();l!==null&&o.size<t;l=l.getAdjacentCaret()){const u=l.origin.getWritable();o.set(u.getKey(),u)}for(const l of s){if(o.size>0){const u=a.getNodeAtCaret();if(u){if(o.delete(u.getKey()),o.delete(l.getKey()),!(u.is(l)||a.origin.is(l))){const d=l.getParent();d&&d.is(i)&&l.remove(),u.replace(l)}}else u===null&&$t(263,Array.from(o).join(" "))}else a.insert(l);a=si(l,this.direction)}for(const l of o.values())l.remove();return this}}class Ky extends D4{type="child";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:Sl(t,this.direction)}getParentCaret(t="root"){return si(R4(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=Wm(this.direction);return si(this.getNodeAtCaret(),t)||Sl(this.origin,t)}getParentAtCaret(){return this.origin}getChildCaret(){return this}isSameNodeCaret(t){return t instanceof Ky&&this.direction===t.direction&&this.origin.is(t.origin)}isSamePointCaret(t){return this.isSameNodeCaret(t)}}const wre={root:ga,shadowRoot:qi};function Wm(e){return vre[e]}function R4(e,t="root"){return wre[t](e)?null:e}class s0 extends D4{type="sibling";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:si(t,this.direction)}getSiblingCaret(){return this}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return bt(this.origin)?Sl(this.origin,this.direction):null}getParentCaret(t="root"){return si(R4(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=Wm(this.direction);return si(this.getNodeAtCaret(),t)||Sl(this.origin.getParentOrThrow(),t)}isSamePointCaret(t){return t instanceof s0&&this.direction===t.direction&&this.origin.is(t.origin)}isSameNodeCaret(t){return(t instanceof s0||t instanceof a0)&&this.direction===t.direction&&this.origin.is(t.origin)}}class a0 extends D4{type="text";constructor(t,r){super(t),this.offset=r}getLatest(){const t=this.origin.getLatest();return t===this.origin?this:o0(t,this.direction,this.offset)}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return null}getParentCaret(t="root"){return si(R4(this.getParentAtCaret(),t),this.direction)}getFlipped(){return o0(this.origin,Wm(this.direction),this.offset)}isSamePointCaret(t){return t instanceof a0&&this.direction===t.direction&&this.origin.is(t.origin)&&this.offset===t.offset}isSameNodeCaret(t){return(t instanceof s0||t instanceof a0)&&this.direction===t.direction&&this.origin.is(t.origin)}getSiblingCaret(){return si(this.origin,this.direction)}}function gf(e){return e instanceof a0}function i0(e){return e instanceof s0}function Vc(e){return e instanceof Ky}const bre={next:class extends a0{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends a0{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},_re={next:class extends s0{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends s0{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},Sre={next:class extends Ky{direction="next";getNodeAtCaret(){return this.origin.getFirstChild()}insert(e){return this.origin.splice(0,0,[e]),this}},previous:class extends Ky{direction="previous";getNodeAtCaret(){return this.origin.getLastChild()}insert(e){return this.origin.splice(this.origin.getChildrenSize(),0,[e]),this}}};function si(e,t){return e?new _re[t](e):null}function o0(e,t,r){return e?new bre[t](e,mf(e,r)):null}function mf(e,t,r="error"){const n=e.getTextContentSize();let s=t==="next"?n:t==="previous"?0:t;return(s<0||s>n)&&(r!=="clamp"&&(function(a,...i){const o=new URL("https://lexical.dev/docs/error"),l=new URLSearchParams;l.append("code",a);for(const u of i)l.append("v",u);o.search=l.toString(),console.warn(`Minified Lexical warning #${a}; visit ${o.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(284,String(t),String(n),e.getKey()),s=s<0?0:n),s}function v8(e,t){return new Cre(e,t)}function Sl(e,t){return bt(e)?new Sre[t](e):null}function kre(e){return e&&e.getChildCaret()||e}function I4(e){return e&&kre(e.getAdjacentCaret())}class M4{type="node-caret-range";constructor(t,r,n){this.anchor=t,this.focus=r,this.direction=n}getLatest(){const t=this.anchor.getLatest(),r=this.focus.getLatest();return t===this.anchor&&r===this.focus?this:new M4(t,r,this.direction)}isCollapsed(){return this.anchor.isSamePointCaret(this.focus)}getTextSlices(){const t=s=>{const a=this[s].getLatest();return gf(a)?(function(i,o){const{direction:l,origin:u}=i,d=mf(u,o==="focus"?Wm(l):l);return v8(i,d-i.offset)})(a,s):null},r=t("anchor"),n=t("focus");if(r&&n){const{caret:s}=r,{caret:a}=n;if(s.isSameNodeCaret(a))return[v8(s,a.offset-s.offset),null]}return[r,n]}iterNodeCarets(t="root"){const r=gf(this.anchor)?this.anchor.getSiblingCaret():this.anchor.getLatest(),n=this.focus.getLatest(),s=gf(n),a=i=>i.isSameNodeCaret(n)?null:I4(i)||i.getParentCaret(t);return B4({hasNext:i=>i!==null&&!(s&&n.isSameNodeCaret(i)),initial:r.isSameNodeCaret(n)?null:a(r),map:i=>i,step:a})}[Symbol.iterator](){return this.iterNodeCarets("root")}}class Cre{type="slice";constructor(t,r){this.caret=t,this.distance=r}getSliceIndices(){const{distance:t,caret:{offset:r}}=this,n=r+t;return n<r?[n,r]:[r,n]}getTextContent(){const[t,r]=this.getSliceIndices();return this.caret.origin.getTextContent().slice(t,r)}getTextContentSize(){return Math.abs(this.distance)}removeTextSlice(){const{caret:{origin:t,direction:r}}=this,[n,s]=this.getSliceIndices(),a=t.getTextContent();return o0(t.setTextContent(a.slice(0,n)+a.slice(s)),r,n)}}function L4(e){return _f(e,si(is(),e.direction))}function Tre(e){return _f(e,e)}function _f(e,t){return e.direction!==t.direction&&$t(265),new M4(e,t,e.direction)}function B4(e){const{initial:t,hasNext:r,step:n,map:s}=e;let a=t;return{[Symbol.iterator](){return this},next(){if(!r(a))return{done:!0,value:void 0};const i={done:!1,value:s(a)};return a=n(a),i}}}function R9(e,t){const r=nb(e.origin,t.origin);switch(r===null&&$t(275,e.origin.getKey(),t.origin.getKey()),r.type){case"same":{const n=e.type==="text",s=t.type==="text";return n&&s?(function(a,i){return Math.sign(a-i)})(e.offset,t.offset):e.type===t.type?0:n?-1:s?1:e.type==="child"?-1:1}case"ancestor":return e.type==="child"?-1:1;case"descendant":return t.type==="child"?1:-1;case"branch":return I9(r)}}function I9(e){const{a:t,b:r}=e,n=t.__key,s=r.__key;let a=t,i=r;for(;a&&i;a=a.getNextSibling(),i=i.getNextSibling()){if(a.__key===s)return-1;if(i.__key===n)return 1}return a===null?1:-1}function vw(e,t){return t.is(e)}function w8(e){return bt(e)?[e.getLatest(),null]:[e.getParent(),e.getLatest()]}function nb(e,t){if(e.is(t))return{commonAncestor:e,type:"same"};const r=new Map;for(let[n,s]=w8(e);n;s=n,n=n.getParent())r.set(n,s);for(let[n,s]=w8(t);n;s=n,n=n.getParent()){const a=r.get(n);if(a!==void 0)return a===null?(vw(e,n)||$t(276),{commonAncestor:n,type:"ancestor"}):s===null?(vw(t,n)||$t(277),{commonAncestor:n,type:"descendant"}):((bt(a)||vw(e,a))&&(bt(s)||vw(t,s))&&n.is(a.getParent())&&n.is(s.getParent())||$t(278),{a,b:s,commonAncestor:n,type:"branch"})}return null}function Ju(e,t){const{type:r,key:n,offset:s}=e,a=hre(e.key);return r==="text"?(Jt(a)||$t(266,a.getType(),n),o0(a,t,s)):(bt(a)||$t(267,a.getType(),n),Are(a,e.offset,t))}function l0(e,t){const{origin:r,direction:n}=t,s=n==="next";gf(t)?e.set(r.getKey(),t.offset,"text"):i0(t)?Jt(r)?e.set(r.getKey(),mf(r,n),"text"):e.set(r.getParentOrThrow().getKey(),r.getIndexWithinParent()+(s?1:0),"element"):(Vc(t)&&bt(r)||$t(268),e.set(r.getKey(),s?0:r.getChildrenSize(),"element"))}function Ere(e){const t=Xt(),r=Dt(t)?t:G_();return sb(r,e),ai(r),r}function sb(e,t){l0(e.anchor,t.anchor),l0(e.focus,t.focus)}function b8(e){const{anchor:t,focus:r}=e,n=Ju(t,"next"),s=Ju(r,"next"),a=R9(n,s)<=0?"next":"previous";return _f(wm(n,a),wm(s,a))}function $4(e){const{direction:t,origin:r}=e,n=si(r,Wm(t)).getNodeAtCaret();return n?si(n,t):Sl(r.getParentOrThrow(),t)}function _8(e,t="root"){const r=[e];for(let n=Vc(e)?e.getParentCaret(t):e.getSiblingCaret();n!==null;n=n.getParentCaret(t))r.push($4(n));return r}function dk(e){return!!e&&e.origin.isAttached()}function Nre(e,t="removeEmptySlices"){if(e.isCollapsed())return e;const r="root",n="next";let s=t;const a=L9(e,n),i=_8(a.anchor,r),o=_8(a.focus.getFlipped(),r),l=new Set,u=[];for(const x of a.iterNodeCarets(r))if(Vc(x))l.add(x.origin.getKey());else if(i0(x)){const{origin:v}=x;bt(v)&&!l.has(v.getKey())||u.push(v)}for(const x of u)x.remove();for(const x of a.getTextSlices()){if(!x)continue;const{origin:v}=x.caret,w=v.getTextContentSize(),C=$4(si(v,n)),k=v.getMode();if(Math.abs(x.distance)===w&&s==="removeEmptySlices"||k==="token"&&x.distance!==0)C.remove();else if(x.distance!==0){s="removeEmptySlices";let _=x.removeTextSlice();const N=x.caret.origin;if(k==="segmented"){const E=_.origin,P=_s(E.getTextContent()).setStyle(E.getStyle()).setFormat(E.getFormat());C.replaceOrInsert(P),_=o0(P,n,_.offset)}N.is(i[0].origin)&&(i[0]=_),N.is(o[0].origin)&&(o[0]=_.getFlipped())}}let d,h;for(const x of i)if(dk(x)){d=xl(x);break}for(const x of o)if(dk(x)){h=xl(x);break}const g=(function(x,v,w){if(!x||!v)return null;const C=x.getParentAtCaret(),k=v.getParentAtCaret();if(!C||!k)return null;const _=C.getParents().reverse();_.push(C);const N=k.getParents().reverse();N.push(k);const E=Math.min(_.length,N.length);let P;for(P=0;P<E&&_[P]===N[P];P++);const F=(R,U)=>{let Y;for(let Z=P;Z<R.length;Z++){const ae=R[Z];if(qi(ae))return;!Y&&U(ae)&&(Y=ae)}return Y},A=F(_,pl),j=A&&F(N,(R=>w.has(R.getKey())&&pl(R)));return A&&j?[A,j]:null})(d,h,l);if(g){const[x,v]=g;Sl(x,"previous").splice(0,v.getChildren()),v.remove()}const p=[d,h,...i,...o].find(dk);if(p)return Tre(wm(xl(p),e.direction));$t(269,JSON.stringify(i.map((x=>x.origin.__key))))}function xl(e){const t=(function(s){let a=s;for(;Vc(a);){const i=I4(a);if(!Vc(i))break;a=i}return a})(e.getLatest()),{direction:r}=t;if(Jt(t.origin))return gf(t)?t:o0(t.origin,r,r);const n=t.getAdjacentCaret();return i0(n)&&Jt(n.origin)?o0(n.origin,r,Wm(r)):t}function M9(e){return gf(e)&&e.offset!==mf(e.origin,e.direction)}function wm(e,t){return e.direction===t?e:e.getFlipped()}function L9(e,t){return e.direction===t?e:_f(wm(e.focus,t),wm(e.anchor,t))}function Are(e,t,r){let n=Sl(e,"next");for(let s=0;s<t;s++){const a=n.getAdjacentCaret();if(a===null)break;n=a}return wm(n,r)}const B9=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,jre=B9?S.useLayoutEffect:S.useEffect,ww={tag:by};function $9({initialConfig:e,children:t}){const r=S.useMemo((()=>{const{theme:n,namespace:s,nodes:a,onError:i,editorState:o,html:l}=e,u=Jee(null,n),d=rre({editable:e.editable,html:l,namespace:s,nodes:a,onError:h=>i(h,d),theme:n});return(function(h,g){if(g!==null){if(g===void 0)h.update((()=>{const p=is();if(p.isEmpty()){const x=Kn();p.append(x);const v=B9?document.activeElement:null;(Xt()!==null||v!==null&&v===h.getRootElement())&&x.select()}}),ww);else if(g!==null)switch(typeof g){case"string":{const p=h.parseEditorState(g);h.setEditorState(p,ww);break}case"object":h.setEditorState(g,ww);break;case"function":h.update((()=>{is().isEmpty()&&g(h)}),ww)}}})(d,o),[d,u]}),[]);return jre((()=>{const n=e.editable,[s]=r;s.setEditable(n===void 0||n)}),[]),c.jsx(Lm.Provider,{value:r,children:t})}const Pre=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?S.useLayoutEffect:S.useEffect;function Fre(e){return{initialValueFn:()=>e.isEditable(),subscribe:t=>e.registerEditableListener(t)}}function Ore(){return(function(e){const[t]=Qc(),r=S.useMemo((()=>e(t)),[t,e]),[n,s]=S.useState((()=>r.initialValueFn())),a=S.useRef(n);return Pre((()=>{const{initialValueFn:i,subscribe:o}=r,l=i();return a.current!==l&&(a.current=l,s(l)),o((u=>{a.current=u,s(u)}))}),[r,e]),n})(Fre)}function Dre(){return is().getTextContent()}function Rre(e,t=!0){if(e)return!1;let r=Dre();return t&&(r=r.trim()),r===""}function Ire(e){if(!Rre(e,!1))return!1;const t=is().getChildren(),r=t.length;if(r>1)return!1;for(let n=0;n<r;n++){const s=t[n];if(gn(s))return!1;if(bt(s)){if(!b4(s)||s.__indent!==0)return!1;const a=s.getChildren(),i=a.length;for(let o=0;o<i;o++){const l=a[n];if(!Jt(l))return!1}}}return!0}function U9(e){return()=>Ire(e)}const tE=new Map;function z9(e){const t={};if(!e)return t;const r=e.split(";");for(const n of r)if(n!==""){const[s,a]=n.split(/:([^]+)/);s&&a&&(t[s.trim()]=a.trim())}return t}function S8(e){let t=tE.get(e);return t===void 0&&(t=z9(e),tE.set(e,t)),t}function W9(e){const t=Dv().getElementByKey(e.getKey());if(t===null)return null;const r=t.ownerDocument.defaultView;return r===null?null:r.getComputedStyle(t)}function H9(e){return W9(ga(e)?e:e.getParentOrThrow())}function k8(e){const t=H9(e);return t!==null&&t.direction==="rtl"}function G9(e,t){const r=e.getStartEndPoints();if(t.isSelected(e)&&!Fu(t)&&r!==null){const[n,s]=r,a=e.isBackward(),i=n.getNode(),o=s.getNode(),l=t.is(i),u=t.is(o);if(l||u){const[d,h]=KT(e),g=i.is(o),p=t.is(a?o:i),x=t.is(a?i:o);let v,w=0;g?(w=d>h?h:d,v=d>h?d:h):p?(w=a?h:d,v=void 0):x&&(w=0,v=a?d:h),t.__text=t.__text.slice(w,v)}}return t}function Mre(e){const t=e.getStyle(),r=z9(t);tE.set(t,r)}function Lre(e,t){const r=e.getFormatType(),n=e.getIndent();r!==t.getFormatType()&&t.setFormat(r),n!==t.getIndent()&&t.setIndent(n)}function im(e,t,r=Lre){if(e===null)return;const n=e.getStartEndPoints(),s=new Map;let a=null;if(n){const[i,o]=n;a=G_(),a.anchor.set(i.key,i.offset,i.type),a.focus.set(o.key,o.offset,o.type);const l=fk(i.getNode(),pl),u=fk(o.getNode(),pl);bt(l)&&s.set(l.getKey(),l),bt(u)&&s.set(u.getKey(),u)}for(const i of e.getNodes())if(bt(i)&&pl(i))s.set(i.getKey(),i);else if(n===null){const o=fk(i,pl);bt(o)&&s.set(o.getKey(),o)}for(const[i,o]of s){const l=t();r(o,l),o.replace(l,!0),a&&(i===a.anchor.key&&a.anchor.set(l.getKey(),a.anchor.offset,a.anchor.type),i===a.focus.key&&a.focus.set(l.getKey(),a.focus.offset,a.focus.type))}a&&e.is(Xt())&&ai(a)}function V9(e){const t=K9(e);return t!==null&&t.writingMode==="vertical-rl"}function K9(e){const t=e.anchor.getNode();return bt(t)?W9(t):H9(t)}function C8(e,t){let r=V9(e)?!t:t;q9(e)&&(r=!r);const n=Ju(e.focus,r?"previous":"next");if(M9(n))return!1;for(const s of L4(n)){if(Vc(s))return!s.origin.isInline();if(!bt(s.origin)){if(gn(s.origin))return!0;break}}return!1}function Bre(e,t,r,n){e.modify(t?"extend":"move",r,n)}function q9(e){const t=K9(e);return t!==null&&t.direction==="rtl"}function T8(e,t,r){const n=q9(e);let s;s=V9(e)||n?!r:r,Bre(e,t,s,"character")}function fk(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function $re(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const Y9=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Ure=Y9&&"documentMode"in document?document.documentMode:null;!(!Y9||!("InputEvent"in window)||Ure)&&"getTargetRanges"in new window.InputEvent("input");function X9(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}function S0(...e){return()=>{for(let t=e.length-1;t>=0;t--)e[t]();e.length=0}}function fa(e,...t){const r=X9(...t);r.length>0&&e.classList.add(...r)}function pf(e,...t){const r=X9(...t);r.length>0&&e.classList.remove(...r)}function zre(e){return e?e.getAdjacentCaret():null}function Wre(e,t){let r=e;for(;r!=null;){if(r instanceof t)return r;r=r.getParent()}return null}function Hre(e){const t=Q_(e,(r=>bt(r)&&!r.isInline()));return bt(t)||$re(4,e.__key),t}const Q_=(e,t)=>{let r=e;for(;r!==is()&&r!=null;){if(t(r))return r;r=r.getParent()}return null};function jh(e,t){return e!==null&&Object.getPrototypeOf(e).constructor.name===t.name}function J9(e,t){const r=[],n=Array.from(e).reverse();for(let s=n.pop();s!==void 0;s=n.pop())if(t(s))r.push(s);else if(bt(s))for(const a of Gre(s))n.push(a);return r}function Gre(e){return Vre(Sl(e,"previous"))}function Vre(e){return B4({hasNext:i0,initial:e.getAdjacentCaret(),map:t=>t.origin.getLatest(),step:t=>t.getAdjacentCaret()})}function Kre(e){const t=window.location.origin,r=n=>{if(n.origin!==t)return;const s=e.getRootElement();if(document.activeElement!==s)return;const a=n.data;if(typeof a=="string"){let i;try{i=JSON.parse(a)}catch{return}if(i&&i.protocol==="nuanria_messaging"&&i.type==="request"){const o=i.payload;if(o&&o.functionId==="makeChanges"){const l=o.args;if(l){const[u,d,h,g,p,x]=l;e.update((()=>{const v=Xt();if(Dt(v)){const w=v.anchor;let C=w.getNode(),k=0,_=0;if(Jt(C)&&u>=0&&d>=0&&(k=u,_=u+d,v.setTextNodeRange(C,k,C,_)),k===_&&h===""||(v.insertRawText(h),C=w.getNode()),Jt(C)){k=g,_=g+p;const N=C.getTextContentSize();k=k>N?N:k,_=_>N?N:_,v.setTextNodeRange(C,k,C,_)}n.stopImmediatePropagation()}}))}}}}};return window.addEventListener("message",r,!0),()=>{window.removeEventListener("message",r,!0)}}function qre(e,t){const r=t.body?t.body.childNodes:[];let n=[];const s=[];for(let a=0;a<r.length;a++){const i=r[a];if(!Z9.has(i.nodeName)){const o=eB(i,e,s,!1);o!==null&&(n=n.concat(o))}}return(function(a){for(const i of a)i.getNextSibling()instanceof w4&&i.insertAfter(qc());for(const i of a){const o=i.getChildren();for(const l of o)i.insertBefore(l);i.remove()}})(s),n}function Yre(e,t){if(typeof document>"u"||typeof window>"u"&&global.window===void 0)throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");const r=document.createElement("div"),n=is().getChildren();for(let s=0;s<n.length;s++)Q9(e,n[s],r,t);return r.innerHTML}function Q9(e,t,r,n=null){let s=n===null||t.isSelected(n);const a=bt(t)&&t.excludeFromCopy("html");let i=t;if(n!==null){let p=P4(t);p=Jt(p)&&n!==null?G9(n,p):p,i=p}const o=bt(i)?i.getChildren():[],l=S4(e,i.getType());let u;u=l&&l.exportDOM!==void 0?l.exportDOM(e,i):i.exportDOM(e);const{element:d,after:h}=u;if(!d)return!1;const g=document.createDocumentFragment();for(let p=0;p<o.length;p++){const x=o[p],v=Q9(e,x,g,n);!s&&bt(t)&&v&&t.extractWithChild(x,n,"html")&&(s=!0)}if(s&&!a){if((qn(d)||ZT(d))&&d.append(g),r.append(d),h){const p=h.call(i,d);p&&(ZT(d)?d.replaceChildren(p):d.replaceWith(p))}}else r.append(g);return s}const Z9=new Set(["STYLE","SCRIPT"]);function eB(e,t,r,n,s=new Map,a){let i=[];if(Z9.has(e.nodeName))return i;let o=null;const l=(function(x,v){const{nodeName:w}=x,C=v._htmlConversions.get(w.toLowerCase());let k=null;if(C!==void 0)for(const _ of C){const N=_(x);N!==null&&(k===null||(k.priority||0)<=(N.priority||0))&&(k=N)}return k!==null?k.conversion:null})(e,t),u=l?l(e):null;let d=null;if(u!==null){d=u.after;const x=u.node;if(o=Array.isArray(x)?x[x.length-1]:x,o!==null){for(const[,v]of s)if(o=v(o,a),!o)break;o&&i.push(...Array.isArray(x)?x:[o])}u.forChild!=null&&s.set(e.nodeName,u.forChild)}const h=e.childNodes;let g=[];const p=(o==null||!qi(o))&&(o!=null&&qT(o)||n);for(let x=0;x<h.length;x++)g.push(...eB(h[x],t,r,p,new Map(s),o));return d!=null&&(g=d(g)),Pb(e)&&(g=Xre(e,g,p?()=>{const x=new w4;return r.push(x),x}:Kn)),o==null?g.length>0?i=i.concat(g):Pb(e)&&(function(x){return x.nextSibling==null||x.previousSibling==null?!1:eE(x.nextSibling)&&eE(x.previousSibling)})(e)&&(i=i.concat(qc())):bt(o)&&o.append(...g),i}function Xre(e,t,r){const n=e.style.textAlign,s=[];let a=[];for(let i=0;i<t.length;i++){const o=t[i];if(qT(o))n&&!o.getFormat()&&o.setFormat(n),s.push(o);else if(a.push(o),i===t.length-1||i<t.length-1&&qT(t[i+1])){const l=r();l.setFormat(n),l.append(...a),s.push(l),a=[]}}return s}function Fb(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function Jre(e,t=Xt()){return t==null&&Fb(166),Dt(t)&&t.isCollapsed()||t.getNodes().length===0?"":Yre(e,t)}function Qre(e,t=Xt()){return t==null&&Fb(166),Dt(t)&&t.isCollapsed()||t.getNodes().length===0?null:JSON.stringify(Zre(e,t))}function E8(e,t,r){const n=e.getData("application/x-lexical-editor");if(n)try{const o=JSON.parse(n);if(o.namespace===r._config.namespace&&Array.isArray(o.nodes))return N8(r,ene(o.nodes),t)}catch{}const s=e.getData("text/html"),a=e.getData("text/plain");if(s&&a!==s)try{const o=new DOMParser().parseFromString((function(l){return window.trustedTypes&&window.trustedTypes.createPolicy?window.trustedTypes.createPolicy("lexical",{createHTML:u=>u}).createHTML(l):l})(s),"text/html");return N8(r,qre(r,o),t)}catch{}const i=a||e.getData("text/uri-list");if(i!=null)if(Dt(t)){const o=i.split(/(\r?\n|\t)/);o[o.length-1]===""&&o.pop();for(let l=0;l<o.length;l++){const u=Xt();if(Dt(u)){const d=o[l];d===`
`||d===`\r
`?u.insertParagraph():d==="	"?u.insertNodes([$m()]):u.insertText(d)}}}else t.insertRawText(i)}function N8(e,t,r){e.dispatchCommand(kte,{nodes:t,selection:r})||(r.insertNodes(t),(function(n){if(Dt(n)&&n.isCollapsed()){const s=n.anchor;let a=null;const i=Ju(s,"previous");if(i)if(gf(i))a=i.origin;else{const o=_f(i,Sl(is(),"next").getFlipped());for(const l of o){if(Jt(l.origin)){a=l.origin;break}if(bt(l.origin)&&!l.origin.isInline())break}}if(a&&Jt(a)){const o=a.getFormat(),l=a.getStyle();n.format===o&&n.style===l||(n.format=o,n.style=l,n.dirty=!0)}}})(r))}function tB(e,t,r,n=[]){let s=t===null||r.isSelected(t);const a=bt(r)&&r.excludeFromCopy("html");let i=r;if(t!==null){let u=P4(r);u=Jt(u)&&t!==null?G9(t,u):u,i=u}const o=bt(i)?i.getChildren():[],l=(function(u){const d=u.exportJSON(),h=u.constructor;if(d.type!==h.getType()&&Fb(58,h.name),bt(u)){const g=d.children;Array.isArray(g)||Fb(59,h.name)}return d})(i);if(Jt(i)){const u=i.__text;u.length>0?l.text=u:s=!1}for(let u=0;u<o.length;u++){const d=o[u],h=tB(e,t,d,l.children);!s&&bt(r)&&h&&r.extractWithChild(d,t,"clone")&&(s=!0)}if(s&&!a)n.push(l);else if(Array.isArray(l.children))for(let u=0;u<l.children.length;u++){const d=l.children[u];n.push(d)}return s}function Zre(e,t){const r=[],n=is().getChildren();for(let s=0;s<n.length;s++)tB(e,t,n[s],r);return{namespace:e._config.namespace,nodes:r}}function ene(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r],s=Yte(n);Jt(s)&&Mre(s),t.push(s)}return t}let Pg=null;async function A8(e,t,r){if(Pg!==null)return!1;if(t!==null)return new Promise(((u,d)=>{e.update((()=>{u(j8(e,t,r))}))}));const n=e.getRootElement(),s=e._window||window,a=window.document,i=ic(s);if(n===null||i===null)return!1;const o=a.createElement("span");o.style.cssText="position: fixed; top: -1000px;",o.append(a.createTextNode("#")),n.append(o);const l=new Range;return l.setStart(o,0),l.setEnd(o,1),i.removeAllRanges(),i.addRange(l),new Promise(((u,d)=>{const h=e.registerCommand(z_,(g=>(jh(g,ClipboardEvent)&&(h(),Pg!==null&&(window.clearTimeout(Pg),Pg=null),u(j8(e,g,r))),!0)),tre);Pg=window.setTimeout((()=>{h(),Pg=null,u(!1)}),50),a.execCommand("copy"),o.remove()}))}function j8(e,t,r){if(r===void 0){const s=ic(e._window);if(!s)return!1;const a=s.anchorNode,i=s.focusNode;if(a!==null&&i!==null&&!Fv(e,a,i))return!1;const o=Xt();if(o===null)return!1;r=rne(o)}t.preventDefault();const n=t.clipboardData;return n!==null&&(nne(n,r),!0)}const tne=[["text/html",Jre],["application/x-lexical-editor",Qre]];function rne(e=Xt()){const t={"text/plain":e?e.getTextContent():""};if(e){const r=Dv();for(const[n,s]of tne){const a=s(r,e);a!==null&&(t[n]=a)}}return t}function nne(e,t){for(const r in t){const n=t[r];n!==void 0&&e.setData(r,n)}}function P8(e,t){if(document.caretRangeFromPoint!==void 0){const r=document.caretRangeFromPoint(e,t);return r===null?null:{node:r.startContainer,offset:r.startOffset}}if(document.caretPositionFromPoint!=="undefined"){const r=document.caretPositionFromPoint(e,t);return r===null?null:{node:r.offsetNode,offset:r.offset}}return null}const Hm=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,sne=Hm&&"documentMode"in document?document.documentMode:null,ane=!(!Hm||!("InputEvent"in window)||sne)&&"getTargetRanges"in new window.InputEvent("input"),ine=Hm&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),F8=Hm&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,one=Hm&&/^(?=.*Chrome).*/i.test(navigator.userAgent),lne=Hm&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!one,O8=jr("DRAG_DROP_PASTE_FILE");let Rv=class rB extends Ei{static getType(){return"quote"}static clone(t){return new rB(t.__key)}createDOM(t){const r=document.createElement("blockquote");return fa(r,t.theme.quote),r}updateDOM(t,r){return!1}static importDOM(){return{blockquote:t=>({conversion:cne,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if(qn(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return Iv().updateFromJSON(t)}insertNewAfter(t,r){const n=Kn(),s=this.getDirection();return n.setDirection(s),this.insertAfter(n,r),n}collapseAtStart(){const t=Kn();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}canMergeWhenEmpty(){return!0}};function Iv(){return Ji(new Rv)}function D8(e){return e instanceof Rv}let Mv=class nB extends Ei{static getType(){return"heading"}static clone(t){return new nB(t.__tag,t.__key)}constructor(t,r){super(r),this.__tag=t}getTag(){return this.__tag}setTag(t){const r=this.getWritable();return this.__tag=t,r}createDOM(t){const r=this.__tag,n=document.createElement(r),s=t.theme.heading;if(s!==void 0){const a=s[r];fa(n,a)}return n}updateDOM(t,r,n){return t.__tag!==this.__tag}static importDOM(){return{h1:t=>({conversion:Fg,priority:0}),h2:t=>({conversion:Fg,priority:0}),h3:t=>({conversion:Fg,priority:0}),h4:t=>({conversion:Fg,priority:0}),h5:t=>({conversion:Fg,priority:0}),h6:t=>({conversion:Fg,priority:0}),p:t=>{const r=t.firstChild;return r!==null&&R8(r)?{conversion:()=>({node:null}),priority:3}:null},span:t=>R8(t)?{conversion:r=>({node:cf("h1")}),priority:3}:null}}exportDOM(t){const{element:r}=super.exportDOM(t);if(qn(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return cf(t.tag).updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTag(t.tag)}exportJSON(){return{...super.exportJSON(),tag:this.getTag()}}insertNewAfter(t,r=!0){const n=t?t.anchor.offset:0,s=this.getLastDescendant(),a=!s||t&&t.anchor.key===s.getKey()&&n===s.getTextContentSize()||!t?Kn():cf(this.getTag()),i=this.getDirection();if(a.setDirection(i),this.insertAfter(a,r),n===0&&!this.isEmpty()&&t){const o=Kn();o.select(),this.replace(o,!0)}return a}collapseAtStart(){const t=this.isEmpty()?Kn():cf(this.getTag());return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}extractWithChild(){return!0}};function R8(e){return e.nodeName.toLowerCase()==="span"&&e.style.fontSize==="26pt"}function Fg(e){const t=e.nodeName.toLowerCase();let r=null;return t!=="h1"&&t!=="h2"&&t!=="h3"&&t!=="h4"&&t!=="h5"&&t!=="h6"||(r=cf(t),e.style!==null&&(F4(e,r),r.setFormat(e.style.textAlign))),{node:r}}function cne(e){const t=Iv();return e.style!==null&&(t.setFormat(e.style.textAlign),F4(e,t)),{node:t}}function cf(e="h1"){return Ji(new Mv(e))}function une(e){return e instanceof Mv}function bw(e){let t=null;if(jh(e,DragEvent)?t=e.dataTransfer:jh(e,ClipboardEvent)&&(t=e.clipboardData),t===null)return[!1,[],!1];const r=t.types,n=r.includes("Files"),s=r.includes("text/html")||r.includes("text/plain");return[n,Array.from(t.files),s]}function I8(e){const t=Xt();if(!Dt(t))return!1;const r=new Set,n=t.getNodes();for(let s=0;s<n.length;s++){const a=n[s],i=a.getKey();if(r.has(i))continue;const o=Q_(a,(u=>bt(u)&&!u.isInline()));if(o===null)continue;const l=o.getKey();o.canIndent()&&!r.has(l)&&(r.add(l),e(o))}return r.size>0}function M8(e){const t=bf(e);return gn(t)}function hk(e){for(const t of["lowercase","uppercase","capitalize"])e.hasFormat(t)&&e.toggleFormat(t)}function dne(e){return S0(e.registerCommand(c4,(t=>{const r=Xt();return!!pi(r)&&(r.clear(),!0)}),on),e.registerCommand(Bh,(t=>{const r=Xt();return Dt(r)?(r.deleteCharacter(t),!0):!!pi(r)&&(r.deleteNodes(),!0)}),on),e.registerCommand(Gy,(t=>{const r=Xt();return!!Dt(r)&&(r.deleteWord(t),!0)}),on),e.registerCommand(Vy,(t=>{const r=Xt();return!!Dt(r)&&(r.deleteLine(t),!0)}),on),e.registerCommand(nm,(t=>{const r=Xt();if(typeof t=="string")r!==null&&r.insertText(t);else{if(r===null)return!1;const n=t.dataTransfer;if(n!=null)E8(n,r,e);else if(Dt(r)){const s=t.data;return s&&r.insertText(s),!0}}return!0}),on),e.registerCommand($T,(()=>{const t=Xt();return!!Dt(t)&&(t.removeText(),!0)}),on),e.registerCommand(ki,(t=>{const r=Xt();return!!Dt(r)&&(r.formatText(t),!0)}),on),e.registerCommand(ZL,(t=>{const r=Xt();if(!Dt(r)&&!pi(r))return!1;const n=r.getNodes();for(const s of n){const a=Q_(s,(i=>bt(i)&&!i.isInline()));a!==null&&a.setFormat(t)}return!0}),on),e.registerCommand(rm,(t=>{const r=Xt();return!!Dt(r)&&(r.insertLineBreak(t),!0)}),on),e.registerCommand(Hy,(()=>{const t=Xt();return!!Dt(t)&&(t.insertParagraph(),!0)}),on),e.registerCommand(Nte,(()=>(Vte([$m()]),!0)),on),e.registerCommand(Ate,(()=>I8((t=>{const r=t.getIndent();t.setIndent(r+1)}))),on),e.registerCommand($P,(()=>I8((t=>{const r=t.getIndent();r>0&&t.setIndent(Math.max(0,r-1))}))),on),e.registerCommand(GL,(t=>{const r=Xt();if(pi(r)){const n=r.getNodes();if(n.length>0)return n[0].selectPrevious(),!0}else if(Dt(r)){const n=XT(r.focus,!0);if(!t.shiftKey&&gn(n)&&!n.isIsolated()&&!n.isInline())return n.selectPrevious(),t.preventDefault(),!0}return!1}),on),e.registerCommand(VL,(t=>{const r=Xt();if(pi(r)){const n=r.getNodes();if(n.length>0)return n[0].selectNext(0,0),!0}else if(Dt(r)){if((function(s){const a=s.focus;return a.key==="root"&&a.offset===is().getChildrenSize()})(r))return t.preventDefault(),!0;const n=XT(r.focus,!1);if(!t.shiftKey&&gn(n)&&!n.isIsolated()&&!n.isInline())return n.selectNext(),t.preventDefault(),!0}return!1}),on),e.registerCommand(HL,(t=>{const r=Xt();if(pi(r)){const n=r.getNodes();if(n.length>0)return t.preventDefault(),k8(n[0])?n[0].selectNext(0,0):n[0].selectPrevious(),!0}if(!Dt(r))return!1;if(C8(r,!0)){const n=t.shiftKey;return t.preventDefault(),T8(r,n,!0),!0}return!1}),on),e.registerCommand(WL,(t=>{const r=Xt();if(pi(r)){const s=r.getNodes();if(s.length>0)return t.preventDefault(),k8(s[0])?s[0].selectPrevious():s[0].selectNext(0,0),!0}if(!Dt(r))return!1;const n=t.shiftKey;return!!C8(r,!1)&&(t.preventDefault(),T8(r,n,!1),!0)}),on),e.registerCommand(qL,(t=>{if(M8(t.target))return!1;const r=Xt();if(Dt(r)){if((function(n){if(!n.isCollapsed())return!1;const{anchor:s}=n;if(s.offset!==0)return!1;const a=s.getNode();if(ga(a))return!1;const i=Hre(a);return i.getIndent()>0&&(i.is(a)||a.is(i.getFirstDescendant()))})(r))return t.preventDefault(),e.dispatchCommand($P,void 0);if(F8&&navigator.language==="ko-KR")return!1}else if(!pi(r))return!1;return t.preventDefault(),e.dispatchCommand(Bh,!0)}),on),e.registerCommand(XL,(t=>{if(M8(t.target))return!1;const r=Xt();return!(!Dt(r)&&!pi(r))&&(t.preventDefault(),e.dispatchCommand(Bh,!1))}),on),e.registerCommand(kb,(t=>{const r=Xt();if(!Dt(r))return!1;if(hk(r),t!==null){if((F8||ine||lne)&&ane)return!1;if(t.preventDefault(),t.shiftKey)return e.dispatchCommand(rm,!1)}return e.dispatchCommand(Hy,void 0)}),on),e.registerCommand(YL,(()=>{const t=Xt();return!!Dt(t)&&(e.blur(),!0)}),on),e.registerCommand(QL,(t=>{const[,r]=bw(t);if(r.length>0){const s=P8(t.clientX,t.clientY);if(s!==null){const{offset:a,node:i}=s,o=bf(i);if(o!==null){const l=G_();if(Jt(o))l.anchor.set(o.getKey(),a,"text"),l.focus.set(o.getKey(),a,"text");else{const d=o.getParentOrThrow().getKey(),h=o.getIndexWithinParent()+1;l.anchor.set(d,h,"element"),l.focus.set(d,h,"element")}const u=vb(l);ai(u)}e.dispatchCommand(O8,r)}return t.preventDefault(),!0}const n=Xt();return!!Dt(n)}),on),e.registerCommand(e9,(t=>{const[r]=bw(t),n=Xt();return!(r&&!Dt(n))}),on),e.registerCommand(t9,(t=>{const[r]=bw(t),n=Xt();if(r&&!Dt(n))return!1;const s=P8(t.clientX,t.clientY);if(s!==null){const a=bf(s.node);gn(a)&&t.preventDefault()}return!0}),on),e.registerCommand(UT,(()=>(lre(),!0)),on),e.registerCommand(z_,(t=>(A8(e,jh(t,ClipboardEvent)?t:null),!0)),on),e.registerCommand(h4,(t=>((async function(r,n){await A8(n,jh(r,ClipboardEvent)?r:null),n.update((()=>{const s=Xt();Dt(s)?s.removeText():pi(s)&&s.getNodes().forEach((a=>a.remove()))}))})(t,e),!0)),on),e.registerCommand(u4,(t=>{const[,r,n]=bw(t);return r.length>0&&!n?(e.dispatchCommand(O8,r),!0):zm(t.target)&&k4(t.target)?!1:Xt()!==null&&((function(s,a){s.preventDefault(),a.update((()=>{const i=Xt(),o=jh(s,InputEvent)||jh(s,KeyboardEvent)?null:s.clipboardData;o!=null&&i!==null&&E8(o,i,a)}),{tag:Jte})})(t,e),!0)}),on),e.registerCommand(KL,(t=>{const r=Xt();return Dt(r)&&hk(r),!1}),on),e.registerCommand(JL,(t=>{const r=Xt();return Dt(r)&&hk(r),!1}),on))}const rE=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?S.useLayoutEffect:S.useEffect;function L8(e){return e.getEditorState().read(U9(e.isComposing()))}function sB({contentEditable:e,placeholder:t=null,ErrorBoundary:r}){const[n]=Qc(),s=(function(a,i){const[o,l]=S.useState((()=>a.getDecorators()));return rE((()=>a.registerDecoratorListener((u=>{aT.flushSync((()=>{l(u)}))}))),[a]),S.useEffect((()=>{l(a.getDecorators())}),[a]),S.useMemo((()=>{const u=[],d=Object.keys(o);for(let h=0;h<d.length;h++){const g=d[h],p=c.jsx(i,{onError:v=>a._onError(v),children:c.jsx(S.Suspense,{fallback:null,children:o[g]})}),x=a.getElementByKey(g);x!==null&&u.push(aT.createPortal(p,x,g))}return u}),[i,o,a])})(n,r);return(function(a){rE((()=>S0(dne(a),Kre(a))),[a])})(n),c.jsxs(c.Fragment,{children:[e,c.jsx(fne,{content:t}),s]})}function fne({content:e}){const[t]=Qc(),r=(function(s){const[a,i]=S.useState((()=>L8(s)));return rE((()=>{function o(){const l=L8(s);i(l)}return o(),S0(s.registerUpdateListener((()=>{o()})),s.registerEditableListener((()=>{o()})))}),[s]),a})(t),n=Ore();return r?typeof e=="function"?e(n):e:null}const aB=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?S.useLayoutEffect:S.useEffect;function hne({editor:e,ariaActiveDescendant:t,ariaAutoComplete:r,ariaControls:n,ariaDescribedBy:s,ariaErrorMessage:a,ariaExpanded:i,ariaInvalid:o,ariaLabel:l,ariaLabelledBy:u,ariaMultiline:d,ariaOwns:h,ariaRequired:g,autoCapitalize:p,className:x,id:v,role:w="textbox",spellCheck:C=!0,style:k,tabIndex:_,"data-testid":N,...E},P){const[F,A]=S.useState(e.isEditable()),j=S.useCallback((U=>{U&&U.ownerDocument&&U.ownerDocument.defaultView?e.setRootElement(U):e.setRootElement(null)}),[e]),R=S.useMemo((()=>(function(...U){return Y=>{U.forEach((Z=>{typeof Z=="function"?Z(Y):Z!=null&&(Z.current=Y)}))}})(P,j)),[j,P]);return aB((()=>(A(e.isEditable()),e.registerEditableListener((U=>{A(U)})))),[e]),c.jsx("div",{"aria-activedescendant":F?t:void 0,"aria-autocomplete":F?r:"none","aria-controls":F?n:void 0,"aria-describedby":s,...a!=null?{"aria-errormessage":a}:{},"aria-expanded":F&&w==="combobox"?!!i:void 0,...o!=null?{"aria-invalid":o}:{},"aria-label":l,"aria-labelledby":u,"aria-multiline":d,"aria-owns":F?h:void 0,"aria-readonly":!F||void 0,"aria-required":g,autoCapitalize:p,className:x,contentEditable:F,"data-testid":N,id:v,ref:R,role:w,spellCheck:C,style:k,tabIndex:_,...E})}const gne=S.forwardRef(hne);function B8(e){return e.getEditorState().read(U9(e.isComposing()))}const iB=S.forwardRef(mne);function mne(e,t){const{placeholder:r,...n}=e,[s]=Qc();return c.jsxs(c.Fragment,{children:[c.jsx(gne,{editor:s,...n,ref:t}),r!=null&&c.jsx(pne,{editor:s,content:r})]})}function pne({content:e,editor:t}){const r=(function(i){const[o,l]=S.useState((()=>B8(i)));return aB((()=>{function u(){const d=B8(i);l(d)}return u(),S0(i.registerUpdateListener((()=>{u()})),i.registerEditableListener((()=>{u()})))}),[i]),o})(t),[n,s]=S.useState(t.isEditable());if(S.useLayoutEffect((()=>(s(t.isEditable()),t.registerEditableListener((i=>{s(i)})))),[t]),!r)return null;let a=null;return typeof e=="function"?a=e(n):e!==null&&(a=e),a===null?null:c.jsx("div",{"aria-hidden":!0,children:a})}const _w=0,nE=1,sE=2,Xl=0,xne=1,$8=2,yne=3,vne=4;function wne(e,t,r,n,s){if(e===null||r.size===0&&n.size===0&&!s)return Xl;const a=t._selection,i=e._selection;if(s)return xne;if(!(Dt(a)&&Dt(i)&&i.isCollapsed()&&a.isCollapsed()))return Xl;const o=(function(C,k,_){const N=C._nodeMap,E=[];for(const P of k){const F=N.get(P);F!==void 0&&E.push(F)}for(const[P,F]of _){if(!F)continue;const A=N.get(P);A===void 0||ga(A)||E.push(A)}return E})(t,r,n);if(o.length===0)return Xl;if(o.length>1){const C=t._nodeMap,k=C.get(a.anchor.key),_=C.get(i.anchor.key);return k&&_&&!e._nodeMap.has(k.__key)&&Jt(k)&&k.__text.length===1&&a.anchor.offset===1?$8:Xl}const l=o[0],u=e._nodeMap.get(l.__key);if(!Jt(u)||!Jt(l)||u.__mode!==l.__mode)return Xl;const d=u.__text,h=l.__text;if(d===h)return Xl;const g=a.anchor,p=i.anchor;if(g.key!==p.key||g.type!=="text")return Xl;const x=g.offset,v=p.offset,w=h.length-d.length;return w===1&&v===x-1?$8:w===-1&&v===x+1?yne:w===-1&&v===x?vne:Xl}function bne(e,t){let r=Date.now(),n=Xl;return(s,a,i,o,l,u)=>{const d=Date.now();if(u.has(Nb))return n=Xl,r=d,sE;const h=wne(s,a,o,l,e.isComposing()),g=(()=>{const p=i===null||i.editor===e,x=u.has(Xte);if(!x&&p&&u.has(by))return _w;if(s===null)return nE;const v=a._selection;return o.size>0||l.size>0?x===!1&&h!==Xl&&h===n&&d<r+t&&p||o.size===1&&(function(w,C,k){const _=C._nodeMap.get(w),N=k._nodeMap.get(w),E=C._selection,P=k._selection;return!(Dt(E)&&Dt(P)&&E.anchor.type==="element"&&E.focus.type==="element"&&P.anchor.type==="text"&&P.focus.type==="text"||!Jt(_)||!Jt(N)||_.__parent!==N.__parent)&&JSON.stringify(C.read((()=>_.exportJSON())))===JSON.stringify(k.read((()=>N.exportJSON())))})(Array.from(o)[0],s,a)?_w:nE:v!==null?_w:sE})();return r=d,n=h,g}}function U8(e){e.undoStack=[],e.redoStack=[],e.current=null}function _ne(e,t,r){const n=bne(e,r);return S0(e.registerCommand(d4,(()=>((function(a,i){const o=i.redoStack,l=i.undoStack;if(l.length!==0){const u=i.current,d=l.pop();u!==null&&(o.push(u),a.dispatchCommand(hw,!0)),l.length===0&&a.dispatchCommand(gw,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:Nb})}})(e,t),!0)),on),e.registerCommand(f4,(()=>((function(a,i){const o=i.redoStack,l=i.undoStack;if(o.length!==0){const u=i.current;u!==null&&(l.push(u),a.dispatchCommand(gw,!0));const d=o.pop();o.length===0&&a.dispatchCommand(hw,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:Nb})}})(e,t),!0)),on),e.registerCommand(Pte,(()=>(U8(t),!1)),on),e.registerCommand(Fte,(()=>(U8(t),e.dispatchCommand(hw,!1),e.dispatchCommand(gw,!1),!0)),on),e.registerUpdateListener((({editorState:a,prevEditorState:i,dirtyLeaves:o,dirtyElements:l,tags:u})=>{const d=t.current,h=t.redoStack,g=t.undoStack,p=d===null?null:d.editorState;if(d!==null&&a===p)return;const x=n(i,a,d,o,l,u);if(x===nE)h.length!==0&&(t.redoStack=[],e.dispatchCommand(hw,!1)),d!==null&&(g.push({...d}),e.dispatchCommand(gw,!0));else if(x===sE)return;t.current={editor:e,editorState:a}})))}function Sne(){return{current:null,redoStack:[],undoStack:[]}}function oB({delay:e,externalHistoryState:t}){const[r]=Qc();return(function(n,s,a=1e3){const i=S.useMemo((()=>s||Sne()),[s]);S.useEffect((()=>_ne(n,i,a)),[a,n,i])})(r,t,e),null}function lB({defaultSelection:e}){const[t]=Qc();return S.useEffect((()=>{t.focus((()=>{const r=document.activeElement,n=t.getRootElement();n===null||r!==null&&n.contains(r)||n.focus({preventScroll:!0})}),{defaultSelection:e})}),[e,t]),null}function aE(e,t){return aE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},aE(e,t)}var z8={error:null},kne=(function(e){var t,r;function n(){for(var a,i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return(a=e.call.apply(e,[this].concat(o))||this).state=z8,a.resetErrorBoundary=function(){for(var u,d=arguments.length,h=new Array(d),g=0;g<d;g++)h[g]=arguments[g];a.props.onReset==null||(u=a.props).onReset.apply(u,h),a.reset()},a}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,aE(t,r),n.getDerivedStateFromError=function(a){return{error:a}};var s=n.prototype;return s.reset=function(){this.setState(z8)},s.componentDidCatch=function(a,i){var o,l;(o=(l=this.props).onError)==null||o.call(l,a,i)},s.componentDidUpdate=function(a,i){var o,l,u,d,h=this.state.error,g=this.props.resetKeys;h!==null&&i.error!==null&&((u=a.resetKeys)===void 0&&(u=[]),(d=g)===void 0&&(d=[]),u.length!==d.length||u.some((function(p,x){return!Object.is(p,d[x])})))&&((o=(l=this.props).onResetKeysChange)==null||o.call(l,a.resetKeys,g),this.reset())},s.render=function(){var a=this.state.error,i=this.props,o=i.fallbackRender,l=i.FallbackComponent,u=i.fallback;if(a!==null){var d={error:a,resetErrorBoundary:this.resetErrorBoundary};if(S.isValidElement(u))return u;if(typeof o=="function")return o(d);if(l)return S.createElement(l,d);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},n})(S.Component);function cB({children:e,onError:t}){return c.jsx(kne,{fallback:c.jsx("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"},children:"An error was thrown."}),onError:t,children:e})}const U4=/^(\d+(?:\.\d+)?)px$/,om={BOTH:3,NO_STATUS:0,ROW:1};class Gm extends Ei{static getType(){return"tablecell"}static clone(t){return new Gm(t.__headerState,t.__colSpan,t.__width,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__rowSpan=t.__rowSpan,this.__backgroundColor=t.__backgroundColor,this.__verticalAlign=t.__verticalAlign}static importDOM(){return{td:t=>({conversion:W8,priority:0}),th:t=>({conversion:W8,priority:0})}}static importJSON(t){return uB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeaderStyles(t.headerState).setColSpan(t.colSpan||1).setRowSpan(t.rowSpan||1).setWidth(t.width||void 0).setBackgroundColor(t.backgroundColor||null).setVerticalAlign(t.verticalAlign||void 0)}constructor(t=om.NO_STATUS,r=1,n,s){super(s),this.__colSpan=r,this.__rowSpan=1,this.__headerState=t,this.__width=n,this.__backgroundColor=null,this.__verticalAlign=void 0}createDOM(t){const r=document.createElement(this.getTag());return this.__width&&(r.style.width=`${this.__width}px`),this.__colSpan>1&&(r.colSpan=this.__colSpan),this.__rowSpan>1&&(r.rowSpan=this.__rowSpan),this.__backgroundColor!==null&&(r.style.backgroundColor=this.__backgroundColor),iE(this.__verticalAlign)&&(r.style.verticalAlign=this.__verticalAlign),fa(r,t.theme.tableCell,this.hasHeader()&&t.theme.tableCellHeader),r}exportDOM(t){const r=super.exportDOM(t);if(qn(r.element)){const n=r.element;n.setAttribute("data-temporary-table-cell-lexical-key",this.getKey()),n.style.border="1px solid black",this.__colSpan>1&&(n.colSpan=this.__colSpan),this.__rowSpan>1&&(n.rowSpan=this.__rowSpan),n.style.width=`${this.getWidth()||75}px`,n.style.verticalAlign=this.getVerticalAlign()||"top",n.style.textAlign="start",this.__backgroundColor===null&&this.hasHeader()&&(n.style.backgroundColor="#f2f3f5")}return r}exportJSON(){return{...super.exportJSON(),...iE(this.__verticalAlign)&&{verticalAlign:this.__verticalAlign},backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,width:this.getWidth()}}getColSpan(){return this.getLatest().__colSpan}setColSpan(t){const r=this.getWritable();return r.__colSpan=t,r}getRowSpan(){return this.getLatest().__rowSpan}setRowSpan(t){const r=this.getWritable();return r.__rowSpan=t,r}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(t,r=om.BOTH){const n=this.getWritable();return n.__headerState=t&r|n.__headerState&~r,n}getHeaderStyles(){return this.getLatest().__headerState}setWidth(t){const r=this.getWritable();return r.__width=t,r}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(t){const r=this.getWritable();return r.__backgroundColor=t,r}getVerticalAlign(){return this.getLatest().__verticalAlign}setVerticalAlign(t){const r=this.getWritable();return r.__verticalAlign=t||void 0,r}toggleHeaderStyle(t){const r=this.getWritable();return(r.__headerState&t)===t?r.__headerState-=t:r.__headerState+=t,r}hasHeaderState(t){return(this.getHeaderStyles()&t)===t}hasHeader(){return this.getLatest().__headerState!==om.NO_STATUS}updateDOM(t){return t.__headerState!==this.__headerState||t.__width!==this.__width||t.__colSpan!==this.__colSpan||t.__rowSpan!==this.__rowSpan||t.__backgroundColor!==this.__backgroundColor||t.__verticalAlign!==this.__verticalAlign}isShadowRoot(){return!0}collapseAtStart(){return!0}canBeEmpty(){return!1}canIndent(){return!1}}function iE(e){return e==="middle"||e==="bottom"}function W8(e){const t=e,r=e.nodeName.toLowerCase();let n;U4.test(t.style.width)&&(n=parseFloat(t.style.width));const s=uB(r==="th"?om.ROW:om.NO_STATUS,t.colSpan,n);s.__rowSpan=t.rowSpan;const a=t.style.backgroundColor;a!==""&&(s.__backgroundColor=a);const i=t.style.verticalAlign;iE(i)&&(s.__verticalAlign=i);const o=t.style,l=(o&&o.textDecoration||"").split(" "),u=o.fontWeight==="700"||o.fontWeight==="bold",d=l.includes("line-through"),h=o.fontStyle==="italic",g=l.includes("underline");return{after:p=>{const x=[];let v=null;const w=()=>{if(v){const C=v.getFirstChild();zu(C)&&v.getChildrenSize()===1&&C.remove()}};for(const C of p)dre(C)||Jt(C)||zu(C)?(Jt(C)&&(u&&C.toggleFormat("bold"),d&&C.toggleFormat("strikethrough"),h&&C.toggleFormat("italic"),g&&C.toggleFormat("underline")),v?v.append(C):(v=Kn().append(C),x.push(v))):(x.push(C),w(),v=null);return w(),x.length===0&&x.push(Kn()),x},node:s}}function uB(e=om.NO_STATUS,t=1,r){return Ji(new Gm(e,t,r))}function qy(e){return e instanceof Gm}function oE(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}class Vm extends Ei{static getType(){return"tablerow"}static clone(t){return new Vm(t.__height,t.__key)}static importDOM(){return{tr:t=>({conversion:Cne,priority:0})}}static importJSON(t){return dB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeight(t.height)}constructor(t,r){super(r),this.__height=t}exportJSON(){const t=this.getHeight();return{...super.exportJSON(),...t===void 0?void 0:{height:t}}}createDOM(t){const r=document.createElement("tr");return this.__height&&(r.style.height=`${this.__height}px`),fa(r,t.theme.tableRow),r}extractWithChild(t,r,n){return n==="html"}isShadowRoot(){return!0}setHeight(t){const r=this.getWritable();return r.__height=t,r}getHeight(){return this.getLatest().__height}updateDOM(t){return t.__height!==this.__height}canBeEmpty(){return!1}canIndent(){return!1}}function Cne(e){const t=e;let r;return U4.test(t.style.height)&&(r=parseFloat(t.style.height)),{after:n=>J9(n,qy),node:dB(r)}}function dB(e){return Ji(new Vm(e))}function fB(e){return e instanceof Vm}const hB=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Tne=hB&&"documentMode"in document?document.documentMode:null;hB&&"InputEvent"in window&&!Tne&&new window.InputEvent("input");function Ene(e,t,r){const n=[];let s=null,a=null;function i(l){let u=n[l];return u===void 0&&(n[l]=u=[]),u}const o=e.getChildren();for(let l=0;l<o.length;l++){const u=o[l];fB(u)||oE(209);const d=i(l);for(let h=u.getFirstChild(),g=0;h!=null;h=h.getNextSibling()){for(qy(h)||oE(147);d[g]!==void 0;)g++;const p={cell:h,startColumn:g,startRow:l},{__rowSpan:x,__colSpan:v}=h;for(let w=0;w<x&&!(l+w>=o.length);w++){const C=i(l+w);for(let k=0;k<v;k++)C[g+k]=p}}}return[n,s,a]}function Gx(e){return qn(e)&&e.nodeName==="TABLE"}function Nne(e,t){for(let r=t,n=null;r!==null;r=r.getParent()){if(e.is(r))return n;qy(r)&&(n=r)}return null}function Ane(e,t,r){return Nne(e,bf(t,r))}function H8(e,t,r){if(!t.theme.tableAlignment)return;const n=[],s=[];for(const a of["center","right"]){const i=t.theme.tableAlignment[a];i&&(a===r?s:n).push(i)}pf(e,...n),fa(e,...s)}const jne=new WeakSet;function G8(e=Dv()){return jne.has(e)}class Lv extends Ei{static getType(){return"table"}getColWidths(){return this.getLatest().__colWidths}setColWidths(t){const r=this.getWritable();return r.__colWidths=t,r}static clone(t){return new Lv(t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__colWidths=t.__colWidths,this.__rowStriping=t.__rowStriping,this.__frozenColumnCount=t.__frozenColumnCount,this.__frozenRowCount=t.__frozenRowCount}static importDOM(){return{table:t=>({conversion:Pne,priority:1})}}static importJSON(t){return gB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setRowStriping(t.rowStriping||!1).setFrozenColumns(t.frozenColumnCount||0).setFrozenRows(t.frozenRowCount||0).setColWidths(t.colWidths)}constructor(t){super(t),this.__rowStriping=!1,this.__frozenColumnCount=0,this.__frozenRowCount=0}exportJSON(){return{...super.exportJSON(),colWidths:this.getColWidths(),frozenColumnCount:this.__frozenColumnCount?this.__frozenColumnCount:void 0,frozenRowCount:this.__frozenRowCount?this.__frozenRowCount:void 0,rowStriping:this.__rowStriping?this.__rowStriping:void 0}}extractWithChild(t,r,n){return n==="html"}getDOMSlot(t){const r=Gx(t)?t:t.querySelector("table");return Gx(r)||oE(229),super.getDOMSlot(t).withElement(r).withAfter(r.querySelector("colgroup"))}createDOM(t,r){const n=document.createElement("table");this.__style&&(n.style.cssText=this.__style);const s=document.createElement("colgroup");if(n.appendChild(s),pre(s),fa(n,t.theme.table),this.updateTableElement(null,n,t),G8(r)){const a=document.createElement("div"),i=t.theme.tableScrollableWrapper;return i?fa(a,i):a.style.cssText="overflow-x: auto;",a.appendChild(n),this.updateTableWrapper(null,a,n,t),a}return n}updateTableWrapper(t,r,n,s){this.__frozenColumnCount!==(t?t.__frozenColumnCount:0)&&(function(a,i,o,l){l>0?(fa(a,o.theme.tableFrozenColumn),i.setAttribute("data-lexical-frozen-column","true")):(pf(a,o.theme.tableFrozenColumn),i.removeAttribute("data-lexical-frozen-column"))})(r,n,s,this.__frozenColumnCount),this.__frozenRowCount!==(t?t.__frozenRowCount:0)&&(function(a,i,o,l){l>0?(fa(a,o.theme.tableFrozenRow),i.setAttribute("data-lexical-frozen-row","true")):(pf(a,o.theme.tableFrozenRow),i.removeAttribute("data-lexical-frozen-row"))})(r,n,s,this.__frozenRowCount)}updateTableElement(t,r,n){this.__style!==(t?t.__style:"")&&(r.style.cssText=this.__style),this.__rowStriping!==(!!t&&t.__rowStriping)&&(function(s,a,i){i?(fa(s,a.theme.tableRowStriping),s.setAttribute("data-lexical-row-striping","true")):(pf(s,a.theme.tableRowStriping),s.removeAttribute("data-lexical-row-striping"))})(r,n,this.__rowStriping),(function(s,a,i,o){const l=s.querySelector("colgroup");if(!l)return;const u=[];for(let d=0;d<i;d++){const h=document.createElement("col"),g=o&&o[d];g&&(h.style.width=`${g}px`),u.push(h)}l.replaceChildren(...u)})(r,0,this.getColumnCount(),this.getColWidths()),H8(r,n,this.getFormatType())}updateDOM(t,r,n){const s=this.getDOMSlot(r).element;return r===s===G8()||(qn(a=r)&&a.nodeName==="DIV"&&this.updateTableWrapper(t,r,s,n),this.updateTableElement(t,s,n),!1);var a}exportDOM(t){const r=super.exportDOM(t),{element:n}=r;return{after:s=>{if(r.after&&(s=r.after(s)),!Gx(s)&&qn(s)&&(s=s.querySelector("table")),!Gx(s))return null;H8(s,t._config,this.getFormatType());const[a]=Ene(this),i=new Map;for(const d of a)for(const h of d){const g=h.cell.getKey();i.has(g)||i.set(g,{colSpan:h.cell.getColSpan(),startColumn:h.startColumn})}const o=new Set;for(const d of s.querySelectorAll(":scope > tr > [data-temporary-table-cell-lexical-key]")){const h=d.getAttribute("data-temporary-table-cell-lexical-key");if(h){const g=i.get(h);if(d.removeAttribute("data-temporary-table-cell-lexical-key"),g){i.delete(h);for(let p=0;p<g.colSpan;p++)o.add(p+g.startColumn)}}}const l=s.querySelector(":scope > colgroup");if(l){const d=Array.from(s.querySelectorAll(":scope > colgroup > col")).filter(((h,g)=>o.has(g)));l.replaceChildren(...d)}const u=s.querySelectorAll(":scope > tr");if(u.length>0){const d=document.createElement("tbody");for(const h of u)d.appendChild(h);s.append(d)}return s},element:!Gx(n)&&qn(n)?n.querySelector("table"):n}}canBeEmpty(){return!1}isShadowRoot(){return!0}getCordsFromCellNode(t,r){const{rows:n,domRows:s}=r;for(let a=0;a<n;a++){const i=s[a];if(i!=null)for(let o=0;o<i.length;o++){const l=i[o];if(l==null)continue;const{elem:u}=l,d=Ane(this,u);if(d!==null&&t.is(d))return{x:o,y:a}}}throw new Error("Cell not found in table.")}getDOMCellFromCords(t,r,n){const{domRows:s}=n,a=s[r];if(a==null)return null;const i=a[t<a.length?t:a.length-1];return i??null}getDOMCellFromCordsOrThrow(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(!s)throw new Error("Cell not found at cords.");return s}getCellNodeFromCords(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(s==null)return null;const a=bf(s.elem);return qy(a)?a:null}getCellNodeFromCordsOrThrow(t,r,n){const s=this.getCellNodeFromCords(t,r,n);if(!s)throw new Error("Node at cords not TableCellNode.");return s}getRowStriping(){return!!this.getLatest().__rowStriping}setRowStriping(t){const r=this.getWritable();return r.__rowStriping=t,r}setFrozenColumns(t){const r=this.getWritable();return r.__frozenColumnCount=t,r}getFrozenColumns(){return this.getLatest().__frozenColumnCount}setFrozenRows(t){const r=this.getWritable();return r.__frozenRowCount=t,r}getFrozenRows(){return this.getLatest().__frozenRowCount}canSelectBefore(){return!0}canIndent(){return!1}getColumnCount(){const t=this.getFirstChild();if(!t)return 0;let r=0;return t.getChildren().forEach((n=>{qy(n)&&(r+=n.getColSpan())})),r}}function Pne(e){const t=gB();e.hasAttribute("data-lexical-row-striping")&&t.setRowStriping(!0),e.hasAttribute("data-lexical-frozen-column")&&t.setFrozenColumns(1),e.hasAttribute("data-lexical-frozen-row")&&t.setFrozenRows(1);const r=e.querySelector(":scope > colgroup");if(r){let n=[];for(const s of r.querySelectorAll(":scope > col")){let a=s.style.width||"";if(!U4.test(a)&&(a=s.getAttribute("width")||"",!/^\d+$/.test(a))){n=void 0;break}n.push(parseFloat(a))}n&&t.setColWidths(n)}return{after:n=>J9(n,fB),node:t}}function gB(){return Ji(new Lv)}function uf(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function lE(e){let t=1,r=e.getParent();for(;r!=null;){if(yn(r)){const n=r.getParent();if($r(n)){t++,r=n.getParent();continue}uf(40)}return t}return t}function cE(e){let t=e.getParent();$r(t)||uf(40);let r=t;for(;r!==null;)r=r.getParent(),$r(r)&&(t=r);return t}function mB(e){let t=[];const r=e.getChildren().filter(yn);for(let n=0;n<r.length;n++){const s=r[n],a=s.getFirstChild();$r(a)?t=t.concat(mB(a)):t.push(s)}return t}function $c(e){return yn(e)&&$r(e.getFirstChild())}function V8(e){return $o().append(e)}function pB(e,t){return yn(e)&&(t.length===0||t.length===1&&e.is(t[0])&&e.getChildrenSize()===0)}function K8(e){const t=Xt();if(t!==null){let r=t.getNodes();if(Dt(t)){const s=t.getStartEndPoints();s===null&&uf(143);const[a]=s,i=a.getNode(),o=i.getParent();if(qi(i)){const l=i.getFirstChild();if(l)r=l.selectStart().getNodes();else{const u=Kn();i.append(u),r=u.select().getNodes()}}else if(pB(i,r)){const l=po(e);if(qi(o)){i.replace(l);const u=$o();bt(i)&&(u.setFormat(i.getFormatType()),u.setIndent(i.getIndent())),l.append(u)}else if(yn(i)){const u=i.getParentOrThrow();c0(l,u.getChildren()),u.replace(l)}return}}const n=new Set;for(let s=0;s<r.length;s++){const a=r[s];if(bt(a)&&a.isEmpty()&&!yn(a)&&!n.has(a.getKey())){q8(a,e);continue}let i=C9(a)?a.getParent():yn(a)&&a.isEmpty()?a:null;for(;i!=null;){const o=i.getKey();if($r(i)){if(!n.has(o)){const l=po(e);c0(l,i.getChildren()),i.replace(l),n.add(o)}break}{const l=i.getParent();if(qi(l)&&!n.has(o)){n.add(o),q8(i,e);break}i=l}}}}}function c0(e,t){e.splice(e.getChildrenSize(),0,t)}function q8(e,t){if($r(e))return e;const r=e.getPreviousSibling(),n=e.getNextSibling(),s=$o();let a;if(c0(s,e.getChildren()),$r(r)&&t===r.getListType())r.append(s),$r(n)&&t===n.getListType()&&(c0(r,n.getChildren()),n.remove()),a=r;else if($r(n)&&t===n.getListType())n.getFirstChildOrThrow().insertBefore(s),a=n;else{const i=po(t);i.append(s),e.replace(i),a=i}return s.setFormat(e.getFormatType()),s.setIndent(e.getIndent()),e.remove(),a}function z4(e,t){const r=e.getLastChild(),n=t.getFirstChild();r&&n&&$c(r)&&$c(n)&&(z4(r.getFirstChild(),n.getFirstChild()),n.remove());const s=t.getChildren();s.length>0&&e.append(...s),t.remove()}function Fne(){const e=Xt();if(Dt(e)){const t=new Set,r=e.getNodes(),n=e.anchor.getNode();if(pB(n,r))t.add(cE(n));else for(let s=0;s<r.length;s++){const a=r[s];if(C9(a)){const i=Wre(a,ad);i!=null&&t.add(cE(i))}}for(const s of t){let a=s;const i=mB(s);for(const o of i){const l=Kn().setTextStyle(e.style).setTextFormat(e.format);c0(l,o.getChildren()),a.insertAfter(l),a=l,o.__key===e.anchor.key&&l0(e.anchor,xl(Sl(l,"next"))),o.__key===e.focus.key&&l0(e.focus,xl(Sl(l,"next"))),o.remove()}s.remove()}}}function xB(e){const t=e.getListType()!=="check";let r=e.getStart();for(const n of e.getChildren())yn(n)&&(n.getValue()!==r&&n.setValue(r),t&&n.getLatest().__checked!=null&&n.setChecked(void 0),$r(n.getFirstChild())||r++)}function One(e){const t=new Set;if($c(e)||t.has(e.getKey()))return;const r=e.getParent(),n=e.getNextSibling(),s=e.getPreviousSibling();if($c(n)&&$c(s)){const a=s.getFirstChild();if($r(a)){a.append(e);const i=n.getFirstChild();$r(i)&&(c0(a,i.getChildren()),n.remove(),t.add(n.getKey()))}}else if($c(n)){const a=n.getFirstChild();if($r(a)){const i=a.getFirstChild();i!==null&&i.insertBefore(e)}}else if($c(s)){const a=s.getFirstChild();$r(a)&&a.append(e)}else if($r(r)){const a=$o().setTextFormat(e.getTextFormat()).setTextStyle(e.getTextStyle()),i=po(r.getListType()).setTextFormat(r.getTextFormat()).setTextStyle(r.getTextStyle());a.append(i),i.append(e),s?s.insertAfter(a):n?n.insertBefore(a):r.append(a)}}function Dne(e){if($c(e))return;const t=e.getParent(),r=t?t.getParent():void 0;if($r(r?r.getParent():void 0)&&yn(r)&&$r(t)){const n=t?t.getFirstChild():void 0,s=t?t.getLastChild():void 0;if(e.is(n))r.insertBefore(e),t.isEmpty()&&r.remove();else if(e.is(s))r.insertAfter(e),t.isEmpty()&&r.remove();else{const a=t.getListType(),i=$o(),o=po(a);i.append(o),e.getPreviousSiblings().forEach((d=>o.append(d)));const l=$o(),u=po(a);l.append(u),c0(u,e.getNextSiblings()),r.insertBefore(i),r.insertAfter(l),r.replace(e)}}}function Rne(){const e=Xt();if(!Dt(e)||!e.isCollapsed())return!1;const t=e.anchor.getNode();if(!yn(t)||t.getChildrenSize()!==0)return!1;const r=cE(t),n=t.getParent();$r(n)||uf(40);const s=n.getParent();let a;if(qi(s))a=Kn(),r.insertAfter(a);else{if(!yn(s))return!1;a=$o(),s.insertAfter(a)}a.setTextStyle(e.style).setTextFormat(e.format).select();const i=t.getNextSiblings();if(i.length>0){const o=po(n.getListType());if(yn(a)){const l=$o();l.append(o),a.insertAfter(l)}else a.insertAfter(o);o.append(...i)}return(function(o){let l=o;for(;l.getNextSibling()==null&&l.getPreviousSibling()==null;){const u=l.getParent();if(u==null||!yn(u)&&!$r(u))break;l=u}l.remove()})(t),!0}function Ob(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}let ad=class extends Ei{$config(){return this.config("listitem",{$transform:t=>{if(t.__checked==null)return;const r=t.getParent();$r(r)&&r.getListType()!=="check"&&t.getChecked()!=null&&t.setChecked(void 0)},extends:Ei,importDOM:{li:()=>({conversion:Ine,priority:0})}})}constructor(t=1,r=void 0,n){super(n),this.__value=t===void 0?1:t,this.__checked=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__value=t.__value,this.__checked=t.__checked}createDOM(t){const r=document.createElement("li");return this.updateListItemDOM(null,r,t),r}updateListItemDOM(t,r,n){const s=this.getParent();$r(s)&&s.getListType()==="check"&&(function(o,l,u,d){$r(l.getFirstChild())?(o.removeAttribute("role"),o.removeAttribute("tabIndex"),o.removeAttribute("aria-checked")):(o.setAttribute("role","checkbox"),o.setAttribute("tabIndex","-1"),u&&l.__checked===u.__checked||o.setAttribute("aria-checked",l.getChecked()?"true":"false"))})(r,this,t),r.value=this.__value,(function(o,l,u){const d=[],h=[],g=l.list,p=g?g.listitem:void 0;let x;if(g&&g.nested&&(x=g.nested.listitem),p!==void 0&&d.push(...Ob(p)),g){const v=u.getParent(),w=$r(v)&&v.getListType()==="check",C=u.getChecked();w&&!C||h.push(g.listitemUnchecked),w&&C||h.push(g.listitemChecked),w&&d.push(C?g.listitemChecked:g.listitemUnchecked)}if(x!==void 0){const v=Ob(x);u.getChildren().some((w=>$r(w)))?d.push(...v):h.push(...v)}h.length>0&&pf(o,...h),d.length>0&&fa(o,...d)})(r,n.theme,this);const a=t?t.__style:"",i=this.__style;a!==i&&(i===""?r.removeAttribute("style"):r.style.cssText=i),(function(o,l,u){const d=S8(l.__textStyle);for(const h in d)o.style.setProperty(`--listitem-marker-${h}`,d[h]);if(u)for(const h in S8(u.__textStyle))h in d||o.style.removeProperty(`--listitem-marker-${h}`)})(r,this,t)}updateDOM(t,r,n){const s=r;return this.updateListItemDOM(t,s,n),!1}updateFromJSON(t){return super.updateFromJSON(t).setValue(t.value).setChecked(t.checked)}exportDOM(t){const r=this.createDOM(t._config),n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();return s&&(r.dir=s),{element:r}}exportJSON(){return{...super.exportJSON(),checked:this.getChecked(),value:this.getValue()}}append(...t){for(let r=0;r<t.length;r++){const n=t[r];if(bt(n)&&this.canMergeWith(n)){const s=n.getChildren();this.append(...s),n.remove()}else super.append(n)}return this}replace(t,r){if(yn(t))return super.replace(t);this.setIndent(0);const n=this.getParentOrThrow();if(!$r(n))return t;if(n.__first===this.getKey())n.insertBefore(t);else if(n.__last===this.getKey())n.insertAfter(t);else{const s=po(n.getListType());let a=this.getNextSibling();for(;a;){const i=a;a=a.getNextSibling(),s.append(i)}n.insertAfter(t),t.insertAfter(s)}return r&&(bt(t)||uf(139),this.getChildren().forEach((s=>{t.append(s)}))),this.remove(),n.getChildrenSize()===0&&n.remove(),t}insertAfter(t,r=!0){const n=this.getParentOrThrow();if($r(n)||uf(39),yn(t))return super.insertAfter(t,r);const s=this.getNextSiblings();if(n.insertAfter(t,r),s.length!==0){const a=po(n.getListType());s.forEach((i=>a.append(i))),t.insertAfter(a,r)}return t}remove(t){const r=this.getPreviousSibling(),n=this.getNextSibling();super.remove(t),r&&n&&$c(r)&&$c(n)&&(z4(r.getFirstChild(),n.getFirstChild()),n.remove())}insertNewAfter(t,r=!0){const n=$o().updateFromJSON(this.exportJSON()).setChecked(!this.getChecked()&&void 0);return this.insertAfter(n,r),n}collapseAtStart(t){const r=Kn();this.getChildren().forEach((i=>r.append(i)));const n=this.getParentOrThrow(),s=n.getParentOrThrow(),a=yn(s);if(n.getChildrenSize()===1)if(a)n.remove(),s.select();else{n.insertBefore(r),n.remove();const i=t.anchor,o=t.focus,l=r.getKey();i.type==="element"&&i.getNode().is(this)&&i.set(l,i.offset,"element"),o.type==="element"&&o.getNode().is(this)&&o.set(l,o.offset,"element")}else n.insertBefore(r),this.remove();return!0}getValue(){return this.getLatest().__value}setValue(t){const r=this.getWritable();return r.__value=t,r}getChecked(){const t=this.getLatest();let r;const n=this.getParent();return $r(n)&&(r=n.getListType()),r==="check"?!!t.__checked:void 0}setChecked(t){const r=this.getWritable();return r.__checked=t,r}toggleChecked(){const t=this.getWritable();return t.setChecked(!t.__checked)}getIndent(){const t=this.getParent();if(t===null||!this.isAttached())return this.getLatest().__indent;let r=t.getParentOrThrow(),n=0;for(;yn(r);)r=r.getParentOrThrow().getParentOrThrow(),n++;return n}setIndent(t){typeof t!="number"&&uf(117),(t=Math.floor(t))>=0||uf(199);let r=this.getIndent();for(;r!==t;)r<t?(One(this),r++):(Dne(this),r--);return this}canInsertAfter(t){return yn(t)}canReplaceWith(t){return yn(t)}canMergeWith(t){return yn(t)||b4(t)}extractWithChild(t,r){if(!Dt(r))return!1;const n=r.anchor.getNode(),s=r.focus.getNode();return this.isParentOf(n)&&this.isParentOf(s)&&this.getTextContent().length===r.getTextContent().length}isParentRequired(){return!0}createParentElementNode(){return po("bullet")}canMergeWhenEmpty(){return!0}};function Ine(e){if(e.classList.contains("task-list-item")){for(const r of e.children)if(r.tagName==="INPUT")return Mne(r)}const t=e.getAttribute("aria-checked");return{node:$o(t==="true"||t!=="false"&&void 0)}}function Mne(e){return e.getAttribute("type")!=="checkbox"?{node:null}:{node:$o(e.hasAttribute("checked"))}}function $o(e){return Ji(new ad(void 0,e))}function yn(e){return e instanceof ad}let Of=class extends Ei{$config(){return this.config("list",{$transform:t=>{(function(r){const n=r.getNextSibling();$r(n)&&r.getListType()===n.getListType()&&z4(r,n)})(t),xB(t)},extends:Ei,importDOM:{ol:()=>({conversion:X8,priority:0}),ul:()=>({conversion:X8,priority:0})}})}constructor(t="number",r=1,n){super(n);const s=Bne[t]||t;this.__listType=s,this.__tag=s==="number"?"ol":"ul",this.__start=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__listType=t.__listType,this.__tag=t.__tag,this.__start=t.__start}getTag(){return this.getLatest().__tag}setListType(t){const r=this.getWritable();return r.__listType=t,r.__tag=t==="number"?"ol":"ul",r}getListType(){return this.getLatest().__listType}getStart(){return this.getLatest().__start}setStart(t){const r=this.getWritable();return r.__start=t,r}createDOM(t,r){const n=this.__tag,s=document.createElement(n);return this.__start!==1&&s.setAttribute("start",String(this.__start)),s.__lexicalListType=this.__listType,Y8(s,t.theme,this),s}updateDOM(t,r,n){return t.__tag!==this.__tag||(Y8(r,n.theme,this),!1)}updateFromJSON(t){return super.updateFromJSON(t).setListType(t.listType).setStart(t.start)}exportDOM(t){const r=this.createDOM(t._config,t);return qn(r)&&(this.__start!==1&&r.setAttribute("start",String(this.__start)),this.__listType==="check"&&r.setAttribute("__lexicalListType","check")),{element:r}}exportJSON(){return{...super.exportJSON(),listType:this.getListType(),start:this.getStart(),tag:this.getTag()}}canBeEmpty(){return!1}canIndent(){return!1}splice(t,r,n){let s=n;for(let a=0;a<n.length;a++){const i=n[a];yn(i)||(s===n&&(s=[...n]),s[a]=$o().append(!bt(i)||$r(i)||i.isInline()?i:_s(i.getTextContent())))}return super.splice(t,r,s)}extractWithChild(t){return yn(t)}};function Y8(e,t,r){const n=[],s=[],a=t.list;if(a!==void 0){const i=a[`${r.__tag}Depth`]||[],o=lE(r)-1,l=o%i.length,u=i[l],d=a[r.__tag];let h;const g=a.nested,p=a.checklist;if(g!==void 0&&g.list&&(h=g.list),d!==void 0&&n.push(d),p!==void 0&&r.__listType==="check"&&n.push(p),u!==void 0){n.push(...Ob(u));for(let x=0;x<i.length;x++)x!==l&&s.push(r.__tag+x)}if(h!==void 0){const x=Ob(h);o>1?n.push(...x):s.push(...x)}}s.length>0&&pf(e,...s),n.length>0&&fa(e,...n)}function Lne(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];if(yn(n)){t.push(n);const s=n.getChildren();s.length>1&&s.forEach((a=>{$r(a)&&t.push(V8(a))}))}else t.push(V8(n))}return t}function X8(e){const t=e.nodeName.toLowerCase();let r=null;return t==="ol"?r=po("number",e.start):t==="ul"&&(r=(function(n){if(n.getAttribute("__lexicallisttype")==="check"||n.classList.contains("contains-task-list"))return!0;for(const s of n.childNodes)if(qn(s)&&s.hasAttribute("aria-checked"))return!0;return!1})(e)?po("check"):po("bullet")),{after:Lne,node:r}}const Bne={ol:"number",ul:"bullet"};function po(e="number",t=1){return Ji(new Of(e,t))}function $r(e){return e instanceof Of}const $ne=jr("UPDATE_LIST_START_COMMAND"),W4=jr("INSERT_UNORDERED_LIST_COMMAND"),H4=jr("INSERT_ORDERED_LIST_COMMAND"),G4=jr("REMOVE_LIST_COMMAND");function Une(e){return S0(e.registerCommand(H4,(()=>(K8("number"),!0)),Ug),e.registerCommand($ne,(t=>{const{listNodeKey:r,newStart:n}=t,s=Zs(r);return!!$r(s)&&(s.getListType()==="number"&&(s.setStart(n),xB(s)),!0)}),Ug),e.registerCommand(W4,(()=>(K8("bullet"),!0)),Ug),e.registerCommand(G4,(()=>(Fne(),!0)),Ug),e.registerCommand(Hy,(()=>Rne()),Ug),e.registerNodeTransform(ad,(t=>{const r=t.getFirstChild();if(r){if(Jt(r)){const n=r.getStyle(),s=r.getFormat();t.getTextStyle()!==n&&t.setTextStyle(n),t.getTextFormat()!==s&&t.setTextFormat(s)}}else{const n=Xt();Dt(n)&&(n.style!==t.getTextStyle()||n.format!==t.getTextFormat())&&n.isCollapsed()&&t.is(n.anchor.getNode())&&t.setTextStyle(n.style).setTextFormat(n.format)}})),e.registerNodeTransform(Pf,(t=>{const r=t.getParent();if(yn(r)&&t.is(r.getFirstChild())){const n=t.getStyle(),s=t.getFormat();n===r.getTextStyle()&&s===r.getTextFormat()||r.setTextStyle(n).setTextFormat(s)}})))}function zne(e){const t=r=>{const n=r.getParent();if($r(r.getFirstChild())||!$r(n))return;const s=Q_(r,(a=>yn(a)&&$r(a.getParent())&&yn(a.getPreviousSibling())));if(s===null&&r.getIndent()>0)r.setIndent(0);else if(yn(s)){const a=s.getPreviousSibling();if(yn(a)){const i=(function(l){let u=l,d=u.getFirstChild();for(;$r(d);){const h=d.getLastChild();if(!yn(h))break;u=h,d=u.getFirstChild()}return u})(a),o=i.getParent();if($r(o)){const l=lE(o);l+1<lE(n)&&r.setIndent(l)}}}};return e.registerNodeTransform(Of,(r=>{const n=[r];for(;n.length>0;){const s=n.shift();if($r(s)){for(const a of s.getChildren())if(yn(a)){t(a);const i=a.getFirstChild();$r(i)&&n.push(i)}}}}))}var gk={exports:{}},J8;function Wne(){return J8||(J8=1,(function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var r=(function(n){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,a=0,i={},o={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function k(_){return _ instanceof l?new l(_.type,k(_.content),_.alias):Array.isArray(_)?_.map(k):_.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(k){return Object.prototype.toString.call(k).slice(8,-1)},objId:function(k){return k.__id||Object.defineProperty(k,"__id",{value:++a}),k.__id},clone:function k(_,N){N=N||{};var E,P;switch(o.util.type(_)){case"Object":if(P=o.util.objId(_),N[P])return N[P];E={},N[P]=E;for(var F in _)_.hasOwnProperty(F)&&(E[F]=k(_[F],N));return E;case"Array":return P=o.util.objId(_),N[P]?N[P]:(E=[],N[P]=E,_.forEach(function(A,j){E[j]=k(A,N)}),E);default:return _}},getLanguage:function(k){for(;k;){var _=s.exec(k.className);if(_)return _[1].toLowerCase();k=k.parentElement}return"none"},setLanguage:function(k,_){k.className=k.className.replace(RegExp(s,"gi"),""),k.classList.add("language-"+_)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(E){var k=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(E.stack)||[])[1];if(k){var _=document.getElementsByTagName("script");for(var N in _)if(_[N].src==k)return _[N]}return null}},isActive:function(k,_,N){for(var E="no-"+_;k;){var P=k.classList;if(P.contains(_))return!0;if(P.contains(E))return!1;k=k.parentElement}return!!N}},languages:{plain:i,plaintext:i,text:i,txt:i,extend:function(k,_){var N=o.util.clone(o.languages[k]);for(var E in _)N[E]=_[E];return N},insertBefore:function(k,_,N,E){E=E||o.languages;var P=E[k],F={};for(var A in P)if(P.hasOwnProperty(A)){if(A==_)for(var j in N)N.hasOwnProperty(j)&&(F[j]=N[j]);N.hasOwnProperty(A)||(F[A]=P[A])}var R=E[k];return E[k]=F,o.languages.DFS(o.languages,function(U,Y){Y===R&&U!=k&&(this[U]=F)}),F},DFS:function k(_,N,E,P){P=P||{};var F=o.util.objId;for(var A in _)if(_.hasOwnProperty(A)){N.call(_,A,_[A],E||A);var j=_[A],R=o.util.type(j);R==="Object"&&!P[F(j)]?(P[F(j)]=!0,k(j,N,null,P)):R==="Array"&&!P[F(j)]&&(P[F(j)]=!0,k(j,N,A,P))}}},plugins:{},highlightAll:function(k,_){o.highlightAllUnder(document,k,_)},highlightAllUnder:function(k,_,N){var E={callback:N,container:k,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",E),E.elements=Array.prototype.slice.apply(E.container.querySelectorAll(E.selector)),o.hooks.run("before-all-elements-highlight",E);for(var P=0,F;F=E.elements[P++];)o.highlightElement(F,_===!0,E.callback)},highlightElement:function(k,_,N){var E=o.util.getLanguage(k),P=o.languages[E];o.util.setLanguage(k,E);var F=k.parentElement;F&&F.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(F,E);var A=k.textContent,j={element:k,language:E,grammar:P,code:A};function R(Y){j.highlightedCode=Y,o.hooks.run("before-insert",j),j.element.innerHTML=j.highlightedCode,o.hooks.run("after-highlight",j),o.hooks.run("complete",j),N&&N.call(j.element)}if(o.hooks.run("before-sanity-check",j),F=j.element.parentElement,F&&F.nodeName.toLowerCase()==="pre"&&!F.hasAttribute("tabindex")&&F.setAttribute("tabindex","0"),!j.code){o.hooks.run("complete",j),N&&N.call(j.element);return}if(o.hooks.run("before-highlight",j),!j.grammar){R(o.util.encode(j.code));return}if(_&&n.Worker){var U=new Worker(o.filename);U.onmessage=function(Y){R(Y.data)},U.postMessage(JSON.stringify({language:j.language,code:j.code,immediateClose:!0}))}else R(o.highlight(j.code,j.grammar,j.language))},highlight:function(k,_,N){var E={code:k,grammar:_,language:N};if(o.hooks.run("before-tokenize",E),!E.grammar)throw new Error('The language "'+E.language+'" has no grammar.');return E.tokens=o.tokenize(E.code,E.grammar),o.hooks.run("after-tokenize",E),l.stringify(o.util.encode(E.tokens),E.language)},tokenize:function(k,_){var N=_.rest;if(N){for(var E in N)_[E]=N[E];delete _.rest}var P=new h;return g(P,P.head,k),d(k,P,_,P.head,0),x(P)},hooks:{all:{},add:function(k,_){var N=o.hooks.all;N[k]=N[k]||[],N[k].push(_)},run:function(k,_){var N=o.hooks.all[k];if(!(!N||!N.length))for(var E=0,P;P=N[E++];)P(_)}},Token:l};n.Prism=o;function l(k,_,N,E){this.type=k,this.content=_,this.alias=N,this.length=(E||"").length|0}l.stringify=function k(_,N){if(typeof _=="string")return _;if(Array.isArray(_)){var E="";return _.forEach(function(R){E+=k(R,N)}),E}var P={type:_.type,content:k(_.content,N),tag:"span",classes:["token",_.type],attributes:{},language:N},F=_.alias;F&&(Array.isArray(F)?Array.prototype.push.apply(P.classes,F):P.classes.push(F)),o.hooks.run("wrap",P);var A="";for(var j in P.attributes)A+=" "+j+'="'+(P.attributes[j]||"").replace(/"/g,"&quot;")+'"';return"<"+P.tag+' class="'+P.classes.join(" ")+'"'+A+">"+P.content+"</"+P.tag+">"};function u(k,_,N,E){k.lastIndex=_;var P=k.exec(N);if(P&&E&&P[1]){var F=P[1].length;P.index+=F,P[0]=P[0].slice(F)}return P}function d(k,_,N,E,P,F){for(var A in N)if(!(!N.hasOwnProperty(A)||!N[A])){var j=N[A];j=Array.isArray(j)?j:[j];for(var R=0;R<j.length;++R){if(F&&F.cause==A+","+R)return;var U=j[R],Y=U.inside,Z=!!U.lookbehind,ae=!!U.greedy,ee=U.alias;if(ae&&!U.pattern.global){var ne=U.pattern.toString().match(/[imsuy]*$/)[0];U.pattern=RegExp(U.pattern.source,ne+"g")}for(var L=U.pattern||U,H=E.next,M=P;H!==_.tail&&!(F&&M>=F.reach);M+=H.value.length,H=H.next){var V=H.value;if(_.length>k.length)return;if(!(V instanceof l)){var W=1,I;if(ae){if(I=u(L,M,k,Z),!I||I.index>=k.length)break;var se=I.index,B=I.index+I[0].length,q=M;for(q+=H.value.length;se>=q;)H=H.next,q+=H.value.length;if(q-=H.value.length,M=q,H.value instanceof l)continue;for(var J=H;J!==_.tail&&(q<B||typeof J.value=="string");J=J.next)W++,q+=J.value.length;W--,V=k.slice(M,q),I.index-=M}else if(I=u(L,0,V,Z),!I)continue;var se=I.index,X=I[0],ie=V.slice(0,se),le=V.slice(se+X.length),ce=M+V.length;F&&ce>F.reach&&(F.reach=ce);var ke=H.prev;ie&&(ke=g(_,ke,ie),M+=ie.length),p(_,ke,W);var re=new l(A,Y?o.tokenize(X,Y):X,ee,X);if(H=g(_,ke,re),le&&g(_,H,le),W>1){var ge={cause:A+","+R,reach:ce};d(k,_,N,H.prev,M,ge),F&&ge.reach>F.reach&&(F.reach=ge.reach)}}}}}}function h(){var k={value:null,prev:null,next:null},_={value:null,prev:k,next:null};k.next=_,this.head=k,this.tail=_,this.length=0}function g(k,_,N){var E=_.next,P={value:N,prev:_,next:E};return _.next=P,E.prev=P,k.length++,P}function p(k,_,N){for(var E=_.next,P=0;P<N&&E!==k.tail;P++)E=E.next;_.next=E,E.prev=_,k.length-=P}function x(k){for(var _=[],N=k.head.next;N!==k.tail;)_.push(N.value),N=N.next;return _}if(!n.document)return n.addEventListener&&(o.disableWorkerMessageHandler||n.addEventListener("message",function(k){var _=JSON.parse(k.data),N=_.language,E=_.code,P=_.immediateClose;n.postMessage(o.highlight(E,o.languages[N],N)),P&&n.close()},!1)),o;var v=o.util.currentScript();v&&(o.filename=v.src,v.hasAttribute("data-manual")&&(o.manual=!0));function w(){o.manual||o.highlightAll()}if(!o.manual){var C=document.readyState;C==="loading"||C==="interactive"&&v&&v.defer?document.addEventListener("DOMContentLoaded",w):window.requestAnimationFrame?window.requestAnimationFrame(w):window.setTimeout(w,16)}return o})(t);e.exports&&(e.exports=r),typeof cb<"u"&&(cb.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(n){n.type==="entity"&&(n.attributes.title=n.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(s,a){var i={};i["language-"+a]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[a]},i.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:i}};o["language-"+a]={pattern:/[\s\S]+/,inside:r.languages[a]};var l={};l[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},r.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(n,s){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+n+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:r.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,(function(n){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;n.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},n.languages.css.atrule.inside.rest=n.languages.css;var a=n.languages.markup;a&&(a.tag.addInlined("style","css"),a.tag.addAttribute("style","css"))})(r),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,(function(){if(typeof r>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var n="Loading",s=function(v,w){return" Error "+v+" while fetching file: "+w},a=" Error: File does not exist or is empty",i={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",u="loaded",d="failed",h="pre[data-src]:not(["+o+'="'+u+'"]):not(['+o+'="'+l+'"])';function g(v,w,C){var k=new XMLHttpRequest;k.open("GET",v,!0),k.onreadystatechange=function(){k.readyState==4&&(k.status<400&&k.responseText?w(k.responseText):k.status>=400?C(s(k.status,k.statusText)):C(a))},k.send(null)}function p(v){var w=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(v||"");if(w){var C=Number(w[1]),k=w[2],_=w[3];return k?_?[C,Number(_)]:[C,void 0]:[C,C]}}r.hooks.add("before-highlightall",function(v){v.selector+=", "+h}),r.hooks.add("before-sanity-check",function(v){var w=v.element;if(w.matches(h)){v.code="",w.setAttribute(o,l);var C=w.appendChild(document.createElement("CODE"));C.textContent=n;var k=w.getAttribute("data-src"),_=v.language;if(_==="none"){var N=(/\.(\w+)$/.exec(k)||[,"none"])[1];_=i[N]||N}r.util.setLanguage(C,_),r.util.setLanguage(w,_);var E=r.plugins.autoloader;E&&E.loadLanguages(_),g(k,function(P){w.setAttribute(o,u);var F=p(w.getAttribute("data-range"));if(F){var A=P.split(/\r\n?|\n/g),j=F[0],R=F[1]==null?A.length:F[1];j<0&&(j+=A.length),j=Math.max(0,Math.min(j-1,A.length)),R<0&&(R+=A.length),R=Math.max(0,Math.min(R,A.length)),P=A.slice(j,R).join(`
`),w.hasAttribute("data-start")||w.setAttribute("data-start",String(j+1))}C.textContent=P,r.highlightElement(C)},function(P){w.setAttribute(o,d),C.textContent=P})}}),r.plugins.fileHighlight={highlight:function(w){for(var C=(w||document).querySelectorAll(h),k=0,_;_=C[k++];)r.highlightElement(_)}};var x=!1;r.fileHighlight=function(){x||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),x=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}})()})(gk)),gk.exports}Wne();Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript;Prism.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]};Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity;Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup;Prism.hooks.add("wrap",function(e){e.type==="entity"&&(e.attributes.title=e.content.replace(/&amp;/,"&"))});Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function(t,r){var n={};n["language-"+r]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[r]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var s={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};s["language-"+r]={pattern:/[\s\S]+/,inside:Prism.languages[r]};var a={};a[t]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return t}),"i"),lookbehind:!0,greedy:!0,inside:s},Prism.languages.insertBefore("markup","cdata",a)}});Object.defineProperty(Prism.languages.markup.tag,"addAttribute",{value:function(e,t){Prism.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:Prism.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}});Prism.languages.html=Prism.languages.markup;Prism.languages.mathml=Prism.languages.markup;Prism.languages.svg=Prism.languages.markup;Prism.languages.xml=Prism.languages.extend("markup",{});Prism.languages.ssml=Prism.languages.xml;Prism.languages.atom=Prism.languages.xml;Prism.languages.rss=Prism.languages.xml;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function r(d){return d=d.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+d+")")}var n=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return n}),a=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+a+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+a+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(n),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+a+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(n),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:r(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:r(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:r(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:r(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(d){["url","bold","italic","strike","code-snippet"].forEach(function(h){d!==h&&(e.languages.markdown[d].inside.content.inside[h]=e.languages.markdown[h])})}),e.hooks.add("after-tokenize",function(d){if(d.language!=="markdown"&&d.language!=="md")return;function h(g){if(!(!g||typeof g=="string"))for(var p=0,x=g.length;p<x;p++){var v=g[p];if(v.type!=="code"){h(v.content);continue}var w=v.content[1],C=v.content[3];if(w&&C&&w.type==="code-language"&&C.type==="code-block"&&typeof w.content=="string"){var k=w.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");k=(/[a-z][\w-]*/i.exec(k)||[""])[0].toLowerCase();var _="language-"+k;C.alias?typeof C.alias=="string"?C.alias=[C.alias,_]:C.alias.push(_):C.alias=[_]}}}h(d.tokens)}),e.hooks.add("wrap",function(d){if(d.type==="code-block"){for(var h="",g=0,p=d.classes.length;g<p;g++){var x=d.classes[g],v=/language-(.+)/.exec(x);if(v){h=v[1];break}}var w=e.languages[h];if(w)d.content=e.highlight(u(d.content),w,h);else if(h&&h!=="none"&&e.plugins.autoloader){var C="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);d.attributes.id=C,e.plugins.autoloader.loadLanguages(h,function(){var k=document.getElementById(C);k&&(k.innerHTML=e.highlight(k.textContent,e.languages[h],h))})}}});var i=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;function u(d){var h=d.replace(i,"");return h=h.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(g,p){if(p=p.toLowerCase(),p[0]==="#"){var x;return p[1]==="x"?x=parseInt(p.slice(2),16):x=Number(p.slice(1)),l(x)}else{var v=o[p];return v||g}}),h}e.languages.md=e.languages.markdown})(Prism);Prism.languages.c=Prism.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/});Prism.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}});Prism.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},Prism.languages.c.string],char:Prism.languages.c.char,comment:Prism.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:Prism.languages.c}}}});Prism.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/});delete Prism.languages.c.boolean;(function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var r=e.languages.markup;r&&(r.tag.addInlined("style","css"),r.tag.addAttribute("style","css"))})(Prism);Prism.languages.objectivec=Prism.languages.extend("c",{string:{pattern:/@?"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},keyword:/\b(?:asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|in|inline|int|long|register|return|self|short|signed|sizeof|static|struct|super|switch|typedef|typeof|union|unsigned|void|volatile|while)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/});delete Prism.languages.objectivec["class-name"];Prism.languages.objc=Prism.languages.objectivec;Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};(function(e){var t=e.languages.powershell={comment:[{pattern:/(^|[^`])<#[\s\S]*?#>/,lookbehind:!0},{pattern:/(^|[^`])#.*/,lookbehind:!0}],string:[{pattern:/"(?:`[\s\S]|[^`"])*"/,greedy:!0,inside:null},{pattern:/'(?:[^']|'')*'/,greedy:!0}],namespace:/\[[a-z](?:\[(?:\[[^\]]*\]|[^\[\]])*\]|[^\[\]])*\]/i,boolean:/\$(?:false|true)\b/i,variable:/\$\w+\b/,function:[/\b(?:Add|Approve|Assert|Backup|Block|Checkpoint|Clear|Close|Compare|Complete|Compress|Confirm|Connect|Convert|ConvertFrom|ConvertTo|Copy|Debug|Deny|Disable|Disconnect|Dismount|Edit|Enable|Enter|Exit|Expand|Export|Find|ForEach|Format|Get|Grant|Group|Hide|Import|Initialize|Install|Invoke|Join|Limit|Lock|Measure|Merge|Move|New|Open|Optimize|Out|Ping|Pop|Protect|Publish|Push|Read|Receive|Redo|Register|Remove|Rename|Repair|Request|Reset|Resize|Resolve|Restart|Restore|Resume|Revoke|Save|Search|Select|Send|Set|Show|Skip|Sort|Split|Start|Step|Stop|Submit|Suspend|Switch|Sync|Tee|Test|Trace|Unblock|Undo|Uninstall|Unlock|Unprotect|Unpublish|Unregister|Update|Use|Wait|Watch|Where|Write)-[a-z]+\b/i,/\b(?:ac|cat|chdir|clc|cli|clp|clv|compare|copy|cp|cpi|cpp|cvpa|dbp|del|diff|dir|ebp|echo|epal|epcsv|epsn|erase|fc|fl|ft|fw|gal|gbp|gc|gci|gcs|gdr|gi|gl|gm|gp|gps|group|gsv|gu|gv|gwmi|iex|ii|ipal|ipcsv|ipsn|irm|iwmi|iwr|kill|lp|ls|measure|mi|mount|move|mp|mv|nal|ndr|ni|nv|ogv|popd|ps|pushd|pwd|rbp|rd|rdr|ren|ri|rm|rmdir|rni|rnp|rp|rv|rvpa|rwmi|sal|saps|sasv|sbp|sc|select|set|shcm|si|sl|sleep|sls|sort|sp|spps|spsv|start|sv|swmi|tee|trcm|type|write)\b/i],keyword:/\b(?:Begin|Break|Catch|Class|Continue|Data|Define|Do|DynamicParam|Else|ElseIf|End|Exit|Filter|Finally|For|ForEach|From|Function|If|InlineScript|Parallel|Param|Process|Return|Sequence|Switch|Throw|Trap|Try|Until|Using|Var|While|Workflow)\b/i,operator:{pattern:/(^|\W)(?:!|-(?:b?(?:and|x?or)|as|(?:Not)?(?:Contains|In|Like|Match)|eq|ge|gt|is(?:Not)?|Join|le|lt|ne|not|Replace|sh[lr])\b|-[-=]?|\+[+=]?|[*\/%]=?)/i,lookbehind:!0},punctuation:/[|{}[\];(),.]/};t.string[0].inside={function:{pattern:/(^|[^`])\$\((?:\$\([^\r\n()]*\)|(?!\$\()[^\r\n)])*\)/,lookbehind:!0,inside:t},boolean:t.boolean,variable:t.variable}})(Prism);var Q8={},Z8;function Hne(){return Z8||(Z8=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),Q8}Hne();var eF={},tF;function Gne(){return tF||(tF=1,(function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,r=0;r<2;r++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string})(Prism)),eF}Gne();Prism.languages.swift={comment:{pattern:/(^|[^\\:])(?:\/\/.*|\/\*(?:[^/*]|\/(?!\*)|\*(?!\/)|\/\*(?:[^*]|\*(?!\/))*\*\/)*\*\/)/,lookbehind:!0,greedy:!0},"string-literal":[{pattern:RegExp(/(^|[^"#])/.source+"(?:"+/"(?:\\(?:\((?:[^()]|\([^()]*\))*\)|\r\n|[^(])|[^\\\r\n"])*"/.source+"|"+/"""(?:\\(?:\((?:[^()]|\([^()]*\))*\)|[^(])|[^\\"]|"(?!""))*"""/.source+")"+/(?!["#])/.source),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\\($/,alias:"punctuation"},punctuation:/\\(?=[\r\n])/,string:/[\s\S]+/}},{pattern:RegExp(/(^|[^"#])(#+)/.source+"(?:"+/"(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|\r\n|[^#])|[^\\\r\n])*?"/.source+"|"+/"""(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|[^#])|[^\\])*?"""/.source+")\\2"),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\#+\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\#+\($/,alias:"punctuation"},string:/[\s\S]+/}}],directive:{pattern:RegExp(/#/.source+"(?:"+(/(?:elseif|if)\b/.source+"(?:[ 	]*"+/(?:![ \t]*)?(?:\b\w+\b(?:[ \t]*\((?:[^()]|\([^()]*\))*\))?|\((?:[^()]|\([^()]*\))*\))(?:[ \t]*(?:&&|\|\|))?/.source+")+")+"|"+/(?:else|endif)\b/.source+")"),alias:"property",inside:{"directive-name":/^#\w+/,boolean:/\b(?:false|true)\b/,number:/\b\d+(?:\.\d+)*\b/,operator:/!|&&|\|\||[<>]=?/,punctuation:/[(),]/}},literal:{pattern:/#(?:colorLiteral|column|dsohandle|file(?:ID|Literal|Path)?|function|imageLiteral|line)\b/,alias:"constant"},"other-directive":{pattern:/#\w+\b/,alias:"property"},attribute:{pattern:/@\w+/,alias:"atrule"},"function-definition":{pattern:/(\bfunc\s+)\w+/,lookbehind:!0,alias:"function"},label:{pattern:/\b(break|continue)\s+\w+|\b[a-zA-Z_]\w*(?=\s*:\s*(?:for|repeat|while)\b)/,lookbehind:!0,alias:"important"},keyword:/\b(?:Any|Protocol|Self|Type|actor|as|assignment|associatedtype|associativity|async|await|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic|else|enum|extension|fallthrough|fileprivate|final|for|func|get|guard|higherThan|if|import|in|indirect|infix|init|inout|internal|is|isolated|lazy|left|let|lowerThan|mutating|none|nonisolated|nonmutating|open|operator|optional|override|postfix|precedencegroup|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|set|some|static|struct|subscript|super|switch|throw|throws|try|typealias|unowned|unsafe|var|weak|where|while|willSet)\b/,boolean:/\b(?:false|true)\b/,nil:{pattern:/\bnil\b/,alias:"constant"},"short-argument":/\$\d+\b/,omit:{pattern:/\b_\b/,alias:"keyword"},number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,"class-name":/\b[A-Z](?:[A-Z_\d]*[a-z]\w*)?\b/,function:/\b[a-z_]\w*(?=\s*\()/i,constant:/\b(?:[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,operator:/[-+*/%=!<>&|^~?]+|\.[.\-+*/%=!<>&|^~?]+/,punctuation:/[{}[\]();,.:\\]/};Prism.languages.swift["string-literal"].forEach(function(e){e.inside.interpolation.inside=Prism.languages.swift});var rF={},nF;function Vne(){return nF||(nF=1,(function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript})(Prism)),rF}Vne();var sF={},aF;function Kne(){return aF||(aF=1,(function(e){var t=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,r=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,n={pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};e.languages.java=e.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[n,{pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:n.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+r+/[A-Z]\w*\b/.source),lookbehind:!0,inside:n.inside}],keyword:t,function:[e.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),e.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),e.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":n,keyword:t,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+r+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:n.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+r+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:n.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0,inside:{punctuation:/\./}}})})(Prism)),sF}Kne();var iF={},oF;function qne(){return oF||(oF=1,(function(e){var t=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,r=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,function(){return t.source});e.languages.cpp=e.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:t,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),e.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,function(){return r})+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),e.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e.languages.cpp}}}}),e.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),e.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:e.languages.extend("cpp",{})}}),e.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},e.languages.cpp["base-clause"])})(Prism)),iF}qne();function yB(e,t){for(const r of e.childNodes){if(qn(r)&&r.tagName===t)return!0;yB(r,t)}return!1}const ay="data-language",Vx="data-highlight-language",Sw="data-theme";class k0 extends Ei{static getType(){return"code"}static clone(t){return new k0(t.__language,t.__key)}constructor(t,r){super(r),this.__language=t||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(t){super.afterCloneFrom(t),this.__language=t.__language,this.__theme=t.__theme,this.__isSyntaxHighlightSupported=t.__isSyntaxHighlightSupported}createDOM(t){const r=document.createElement("code");fa(r,t.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(ay,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(Vx,n));const s=this.getTheme();s&&r.setAttribute(Sw,s);const a=this.getStyle();return a&&r.setAttribute("style",a),r}updateDOM(t,r,n){const s=this.__language,a=t.__language;s?s!==a&&r.setAttribute(ay,s):a&&r.removeAttribute(ay);const i=this.__isSyntaxHighlightSupported;t.__isSyntaxHighlightSupported&&a?i&&s?s!==a&&r.setAttribute(Vx,s):r.removeAttribute(Vx):i&&s&&r.setAttribute(Vx,s);const o=this.__theme,l=t.__theme;o?o!==l&&r.setAttribute(Sw,o):l&&r.removeAttribute(Sw);const u=this.__style,d=t.__style;return u?u!==d&&r.setAttribute("style",u):d&&r.removeAttribute("style"),!1}exportDOM(t){const r=document.createElement("pre");fa(r,t._config.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(ay,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(Vx,n));const s=this.getTheme();s&&r.setAttribute(Sw,s);const a=this.getStyle();return a&&r.setAttribute("style",a),{element:r}}static importDOM(){return{code:t=>t.textContent!=null&&(/\r?\n/.test(t.textContent)||yB(t,"BR"))?{conversion:lF,priority:1}:null,div:()=>({conversion:Yne,priority:1}),pre:()=>({conversion:lF,priority:0}),table:t=>mk(t)?{conversion:Xne,priority:3}:null,td:t=>{const r=t,n=r.closest("table");return r.classList.contains("js-file-line")||n&&mk(n)?{conversion:cF,priority:3}:null},tr:t=>{const r=t.closest("table");return r&&mk(r)?{conversion:cF,priority:3}:null}}}static importJSON(t){return Lu().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setLanguage(t.language).setTheme(t.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(t,r=!0){const n=this.getChildren(),s=n.length;if(s>=2&&n[s-1].getTextContent()===`
`&&n[s-2].getTextContent()===`
`&&t.isCollapsed()&&t.anchor.key===this.__key&&t.anchor.offset===s){n[s-1].remove(),n[s-2].remove();const l=Kn();return this.insertAfter(l,r),l}const{anchor:a,focus:i}=t,o=(a.isBefore(i)?a:i).getNode();if(Jt(o)){let l=Qne(o);const u=[];for(;;)if(W_(l))u.push($m()),l=l.getNextSibling();else{if(!bB(l))break;{let w=0;const C=l.getTextContent(),k=l.getTextContentSize();for(;w<k&&C[w]===" ";)w++;if(w!==0&&u.push(wB(" ".repeat(w))),w!==k)break;l=l.getNextSibling()}}const d=o.splitText(a.offset)[0],h=a.offset===0?0:1,g=d.getIndexWithinParent()+h,p=o.getParentOrThrow(),x=[qc(),...u];p.splice(g,0,x);const v=u[u.length-1];v?v.select():a.offset===0?d.selectPrevious():d.getNextSibling().selectNext(0,0)}if(V4(o)){const{offset:l}=t.anchor;o.splice(l,0,[qc()]),o.select(l+1,l+1)}return null}canIndent(){return!1}collapseAtStart(){const t=Kn();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}setLanguage(t){const r=this.getWritable();return r.__language=t||void 0,r}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(t){const r=this.getWritable();return r.__isSyntaxHighlightSupported=t,r}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(t){const r=this.getWritable();return r.__theme=t||void 0,r}getTheme(){return this.getLatest().__theme}}function Lu(e,t){return yre(k0).setLanguage(e).setTheme(t)}function V4(e){return e instanceof k0}function lF(e){return{node:Lu(e.getAttribute(ay))}}function Yne(e){const t=e,r=uF(t);return r||(function(n){let s=n.parentElement;for(;s!==null;){if(uF(s))return!0;s=s.parentElement}return!1})(t)?{node:r?Lu():null}:{node:null}}function Xne(){return{node:Lu()}}function cF(){return{node:null}}function uF(e){return e.style.fontFamily.match("monospace")!==null}function mk(e){return e.classList.contains("js-file-line-container")}let Z_=class vB extends Pf{constructor(t="",r,n){super(t,n),this.__highlightType=r}static getType(){return"code-highlight"}static clone(t){return new vB(t.__text,t.__highlightType||void 0,t.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(t){const r=this.getWritable();return r.__highlightType=t||void 0,r}canHaveFormat(){return!1}createDOM(t){const r=super.createDOM(t),n=pk(t.theme,this.__highlightType);return fa(r,n),r}updateDOM(t,r,n){const s=super.updateDOM(t,r,n),a=pk(n.theme,t.__highlightType),i=pk(n.theme,this.__highlightType);return a!==i&&(a&&pf(r,a),i&&fa(r,i)),s}static importJSON(t){return wB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHighlightType(t.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(t){return this}isParentRequired(){return!0}createParentElementNode(){return Lu()}};function pk(e,t){return t&&e&&e.codeHighlight&&e.codeHighlight[t]}function wB(e="",t){return Ji(new Z_(e,t))}function bB(e){return e instanceof Z_}function Jne(e,t){let r=e;for(let n=si(e,t);n&&(bB(n.origin)||W_(n.origin));n=zre(n))r=n.origin;return r}function Qne(e){return Jne(e,"previous")}(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach((function(r){var n=t[r],s=[];/^\w+$/.test(r)||s.push(/\w+/.exec(r)[0]),r==="diff"&&s.push("bold"),e.languages.diff[r]={pattern:RegExp("^(?:["+n+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(r)[0]}}}})),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);const Zne=new Set(["http:","https:","mailto:","sms:","tel:"]);class Df extends Ei{static getType(){return"link"}static clone(t){return new Df(t.__url,{rel:t.__rel,target:t.__target,title:t.__title},t.__key)}constructor(t="",r={},n){super(n);const{target:s=null,rel:a=null,title:i=null}=r;this.__url=t,this.__target=s,this.__rel=a,this.__title=i}createDOM(t){const r=document.createElement("a");return this.updateLinkDOM(null,r,t),fa(r,t.theme.link),r}updateLinkDOM(t,r,n){if(D9(r)){t&&t.__url===this.__url||(r.href=this.sanitizeUrl(this.__url));for(const s of["target","rel","title"]){const a=`__${s}`,i=this[a];t&&t[a]===i||(i?r[s]=i:r.removeAttribute(s))}}}updateDOM(t,r,n){return this.updateLinkDOM(t,r,n),!1}static importDOM(){return{a:t=>({conversion:ese,priority:1})}}static importJSON(t){return Db().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setURL(t.url).setRel(t.rel||null).setTarget(t.target||null).setTitle(t.title||null)}sanitizeUrl(t){t=fF(t);try{const r=new URL(fF(t));if(!Zne.has(r.protocol))return"about:blank"}catch{return t}return t}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),url:this.getURL()}}getURL(){return this.getLatest().__url}setURL(t){const r=this.getWritable();return r.__url=t,r}getTarget(){return this.getLatest().__target}setTarget(t){const r=this.getWritable();return r.__target=t,r}getRel(){return this.getLatest().__rel}setRel(t){const r=this.getWritable();return r.__rel=t,r}getTitle(){return this.getLatest().__title}setTitle(t){const r=this.getWritable();return r.__title=t,r}insertNewAfter(t,r=!0){const n=Db(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(n,r),n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(t,r,n){if(!Dt(r))return!1;const s=r.anchor.getNode(),a=r.focus.getNode();return this.isParentOf(s)&&this.isParentOf(a)&&r.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}}function ese(e){let t=null;if(D9(e)){const r=e.textContent;(r!==null&&r!==""||e.children.length>0)&&(t=Db(e.getAttribute("href")||"",{rel:e.getAttribute("rel"),target:e.getAttribute("target"),title:e.getAttribute("title")}))}return{node:t}}function Db(e="",t){return Ji(new Df(e,t))}function tse(e){return e instanceof Df}class Km extends Df{constructor(t="",r={},n){super(t,r,n),this.__isUnlinked=r.isUnlinked!==void 0&&r.isUnlinked!==null&&r.isUnlinked}static getType(){return"autolink"}static clone(t){return new Km(t.__url,{isUnlinked:t.__isUnlinked,rel:t.__rel,target:t.__target,title:t.__title},t.__key)}getIsUnlinked(){return this.__isUnlinked}setIsUnlinked(t){const r=this.getWritable();return r.__isUnlinked=t,r}createDOM(t){return this.__isUnlinked?document.createElement("span"):super.createDOM(t)}updateDOM(t,r,n){return super.updateDOM(t,r,n)||t.__isUnlinked!==this.__isUnlinked}static importJSON(t){return dF().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setIsUnlinked(t.isUnlinked||!1)}static importDOM(){return null}exportJSON(){return{...super.exportJSON(),isUnlinked:this.__isUnlinked}}insertNewAfter(t,r=!0){const n=this.getParentOrThrow().insertNewAfter(t,r);if(bt(n)){const s=dF(this.__url,{isUnlinked:this.__isUnlinked,rel:this.__rel,target:this.__target,title:this.__title});return n.append(s),s}return null}}function dF(e="",t){return Ji(new Km(e,t))}function rse(e){return e instanceof Km}const nse=/^\+?[0-9\s()-]{5,}$/;function fF(e){return e.match(/^[a-z][a-z0-9+.-]*:/i)||e.match(/^[/#.]/)?e:e.includes("@")?`mailto:${e}`:nse.test(e)?`tel:${e}`:`https://${e}`}function uE(e,t){const r={};for(const n of e){const s=t(n);s&&(r[s]?r[s].push(n):r[s]=[n])}return r}function sse(e){const t=uE(e,(r=>r.type));return{element:t.element||[],multilineElement:t["multiline-element"]||[],textFormat:t["text-format"]||[],textMatch:t["text-match"]||[]}}const hF=/[!-/:-@[-`{-~\s]/;function ase(e){return Jt(e)&&!e.hasFormat("code")}function ise(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function gF(e,t,r){const n=r.length;for(let s=t;s>=n;s--){const a=s-n;if(_B(e,a,r,0,n)&&e[a+n]!==" ")return a}return-1}function _B(e,t,r,n,s){for(let a=0;a<s;a++)if(e[t+a]!==r[n+a])return!1;return!0}function ose(e,t=e2){const r=sse(t),n=uE(r.textFormat,(({tag:i})=>i[i.length-1])),s=uE(r.textMatch,(({trigger:i})=>i));for(const i of t){const o=i.type;if(o==="element"||o==="text-match"||o==="multiline-element"){const l=i.dependencies;for(const u of l)e.hasNode(u)||ise(173,u.getType())}}const a=(i,o,l)=>{(function(u,d,h,g){const p=u.getParent();if(!qi(p)||u.getFirstChild()!==d)return!1;const x=d.getTextContent();if(x[h-1]!==" ")return!1;for(const{regExp:v,replace:w}of g){const C=x.match(v);if(C&&C[0].length===(C[0].endsWith(" ")?h:h-1)){const k=d.getNextSiblings(),[_,N]=d.splitText(h);if(w(u,N?[N,...k]:k,C,!1)!==!1)return _.remove(),!0}}return!1})(i,o,l,r.element)||(function(u,d,h,g){const p=u.getParent();if(!qi(p)||u.getFirstChild()!==d)return!1;const x=d.getTextContent();if(x[h-1]!==" ")return!1;for(const{regExpStart:v,replace:w,regExpEnd:C}of g){if(C&&!("optional"in C)||C&&"optional"in C&&!C.optional)continue;const k=x.match(v);if(k&&k[0].length===(k[0].endsWith(" ")?h:h-1)){const _=d.getNextSiblings(),[N,E]=d.splitText(h);if(w(u,E?[E,..._]:_,k,null,null,!1)!==!1)return N.remove(),!0}}return!1})(i,o,l,r.multilineElement)||(function(u,d,h){let g=u.getTextContent();const p=h[g[d-1]];if(p==null)return!1;d<g.length&&(g=g.slice(0,d));for(const x of p){if(!x.replace||!x.regExp)continue;const v=g.match(x.regExp);if(v===null)continue;const w=v.index||0,C=w+v[0].length;let k;return w===0?[k]=u.splitText(C):[,k]=u.splitText(w,C),k.selectNext(0,0),x.replace(k,v),!0}return!1})(o,l,s)||(function(u,d,h){const g=u.getTextContent(),p=d-1,x=g[p],v=h[x];if(!v)return!1;for(const w of v){const{tag:C}=w,k=C.length,_=p-k+1;if(k>1&&!_B(g,_,C,0,k)||g[_-1]===" ")continue;const N=g[p+1];if(w.intraword===!1&&N&&!hF.test(N))continue;const E=u;let P=E,F=gF(g,_,C),A=P;for(;F<0&&(A=A.getPreviousSibling())&&!zu(A);)if(Jt(A)){if(A.hasFormat("code"))continue;const L=A.getTextContent();P=A,F=gF(L,L.length,C)}if(F<0||P===E&&F+k===_)continue;const j=P.getTextContent();if(F>0&&j[F-1]===x)continue;const R=j[F-1];if(w.intraword===!1&&R&&!hF.test(R))continue;const U=E.getTextContent(),Y=U.slice(0,_)+U.slice(p+1);E.setTextContent(Y);const Z=P===E?Y:j;P.setTextContent(Z.slice(0,F)+Z.slice(F+k));const ae=Xt(),ee=G_();ai(ee);const ne=p-k*(P===E?2:1)+1;ee.anchor.set(P.__key,F,"text"),ee.focus.set(E.__key,ne,"text");for(const L of w.format)ee.hasFormat(L)||ee.formatText(L);ee.anchor.set(ee.focus.key,ee.focus.offset,ee.focus.type);for(const L of w.format)ee.hasFormat(L)&&ee.toggleFormat(L);return Dt(ae)&&(ee.format=ae.format),!0}})(o,l,n)};return e.registerUpdateListener((({tags:i,dirtyLeaves:o,editorState:l,prevEditorState:u})=>{if(i.has(b9)||i.has(Nb)||e.isComposing())return;const d=l.read(Xt),h=u.read(Xt);if(!Dt(h)||!Dt(d)||!d.isCollapsed()||d.is(h))return;const g=d.anchor.key,p=d.anchor.offset,x=l._nodeMap.get(g);!Jt(x)||!o.has(g)||p!==1&&p>h.anchor.offset+1||e.update((()=>{if(!ase(x))return;const v=x.getParent();v===null||V4(v)||a(v,x,d.anchor.offset)}))}))}const lse=/^(\s*)(\d{1,})\.\s/,cse=/^(\s*)[-*+]\s/,use=/^(#{1,6})\s/,dse=/^>\s/,fse=/^[ \t]*```([\w-]+)?/,hse=/[ \t]*```$/,SB=e=>(t,r,n,s)=>{const a=e(n);a.append(...r),t.replace(a),s||a.select(0,0)},kB=e=>(t,r,n,s)=>{const a=t.getPreviousSibling(),i=t.getNextSibling(),o=$o(e==="check"?n[3]==="x":void 0);if($r(i)&&i.getListType()===e){const u=i.getFirstChild();u!==null?u.insertBefore(o):i.append(o),t.remove()}else if($r(a)&&a.getListType()===e)a.append(o),t.remove();else{const u=po(e,e==="number"?Number(n[2]):void 0);u.append(o),t.replace(u)}o.append(...r),s||o.select(0,0);const l=(function(u){const d=u.match(/\t/g),h=u.match(/ /g);let g=0;return d&&(g+=d.length),h&&(g+=Math.floor(h.length/4)),g})(n[1]);l&&o.setIndent(l)},K4=(e,t,r)=>{const n=[],s=e.getChildren();let a=0;for(const i of s)if(yn(i)){if(i.getChildrenSize()===1){const d=i.getFirstChild();if($r(d)){n.push(K4(d,t,r+1));continue}}const o=" ".repeat(4*r),l=e.getListType(),u=l==="number"?`${e.getStart()+a}. `:l==="check"?`- [${i.getChecked()?"x":" "}] `:"- ";n.push(o+u+t(i)),a++}return n.join(`
`)},gse={dependencies:[Mv],export:(e,t)=>{if(!une(e))return null;const r=Number(e.getTag().slice(1));return"#".repeat(r)+" "+t(e)},regExp:use,replace:SB((e=>{const t="h"+e[1].length;return cf(t)})),type:"element"},mse={dependencies:[Rv],export:(e,t)=>{if(!D8(e))return null;const r=t(e).split(`
`),n=[];for(const s of r)n.push("> "+s);return n.join(`
`)},regExp:dse,replace:(e,t,r,n)=>{if(n){const a=e.getPreviousSibling();if(D8(a))return a.splice(a.getChildrenSize(),0,[qc(),...t]),void e.remove()}const s=Iv();s.append(...t),e.replace(s),n||s.select(0,0)},type:"element"},pse={dependencies:[k0],export:e=>{if(!V4(e))return null;const t=e.getTextContent();return"```"+(e.getLanguage()||"")+(t?`
`+t:"")+"\n```"},regExpEnd:{optional:!0,regExp:hse},regExpStart:fse,replace:(e,t,r,n,s,a)=>{let i,o;if(!t&&s){if(s.length===1)n?(i=Lu(),o=r[1]+s[0]):(i=Lu(r[1]),o=s[0].startsWith(" ")?s[0].slice(1):s[0]);else{if(i=Lu(r[1]),s[0].trim().length===0)for(;s.length>0&&!s[0].length;)s.shift();else s[0]=s[0].startsWith(" ")?s[0].slice(1):s[0];for(;s.length>0&&!s[s.length-1].length;)s.pop();o=s.join(`
`)}const l=_s(o);i.append(l),e.append(i)}else t&&SB((l=>Lu(l?l[1]:void 0)))(e,t,r,a)},type:"multiline-element"},xse={dependencies:[Of,ad],export:(e,t)=>$r(e)?K4(e,t,0):null,regExp:cse,replace:kB("bullet"),type:"element"},yse={dependencies:[Of,ad],export:(e,t)=>$r(e)?K4(e,t,0):null,regExp:lse,replace:kB("number"),type:"element"},vse={format:["code"],tag:"`",type:"text-format"},wse={format:["highlight"],tag:"==",type:"text-format"},bse={format:["bold","italic"],tag:"***",type:"text-format"},_se={format:["bold","italic"],intraword:!1,tag:"___",type:"text-format"},Sse={format:["bold"],tag:"**",type:"text-format"},kse={format:["bold"],intraword:!1,tag:"__",type:"text-format"},Cse={format:["strikethrough"],tag:"~~",type:"text-format"},Tse={format:["italic"],tag:"*",type:"text-format"},Ese={format:["italic"],intraword:!1,tag:"_",type:"text-format"},Nse={dependencies:[Df],export:(e,t,r)=>{if(!tse(e)||rse(e))return null;const n=e.getTitle(),s=t(e);return n?`[${s}](${e.getURL()} "${n}")`:`[${s}](${e.getURL()})`},importRegExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))/,regExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))$/,replace:(e,t)=>{const[,r,n,s]=t,a=Db(n,{title:s}),i=r.split("[").length-1,o=r.split("]").length-1;let l=r,u="";if(i<o)return;if(i>o){const h=r.split("[");u="["+h[0],l=h.slice(1).join("[")}const d=_s(l);return d.setFormat(e.getFormat()),a.append(d),e.replace(a),u&&a.insertBefore(_s(u)),d},trigger:")",type:"text-match"},Ase=[gse,mse,xse,yse],jse=[pse],Pse=[vse,bse,_se,Sse,kse,wse,Tse,Ese,Cse],Fse=[Nse],e2=[...Ase,...jse,...Pse,...Fse];function mF(e,t){return e.getEditorState().read((()=>{const r=Zs(t);return r!==null&&r.isSelected()}))}function Ose(e){const[t]=Qc(),[r,n]=S.useState((()=>mF(t,e)));return S.useEffect((()=>{let s=!0;const a=t.registerUpdateListener((()=>{s&&n(mF(t,e))}));return()=>{s=!1,a()}}),[t,e]),[r,S.useCallback((s=>{t.update((()=>{let a=Xt();pi(a)||(a=m4(),ai(a)),pi(a)&&(s?a.add(e):a.delete(e))}))}),[t,e]),S.useCallback((()=>{t.update((()=>{const s=Xt();pi(s)&&s.clear()}))}),[t])]}function Dse({nodeKey:e}){const[t]=Qc(),[r,n,s]=Ose(e);return S.useEffect((()=>S0(t.registerCommand(c4,(a=>{const i=t.getElementByKey(e);return a.target===i&&(a.shiftKey||s(),n(!r),!0)}),Ug))),[s,t,r,e,n]),S.useEffect((()=>{const a=t.getElementByKey(e),i=t._config.theme.hrSelected??"selected";a!==null&&(r?fa(a,i):pf(a,i))}),[t,r,e]),null}class Bv extends y4{static getType(){return"horizontalrule"}static clone(t){return new Bv(t.__key)}static importJSON(t){return q4().updateFromJSON(t)}static importDOM(){return{hr:()=>({conversion:Rse,priority:0})}}exportDOM(){return{element:document.createElement("hr")}}createDOM(t){const r=document.createElement("hr");return fa(r,t.theme.hr),r}getTextContent(){return`
`}isInline(){return!1}updateDOM(){return!1}decorate(){return c.jsx(Dse,{nodeKey:this.__key})}}function Rse(){return{node:q4()}}function q4(){return Ji(new Bv)}function Ise(e){return e instanceof Bv}const Mse=[{dependencies:[Bv],export:e=>Ise(e)?"***":null,regExp:/^(---|\*\*\*|___)\s?$/,replace:(e,t,r,n)=>{const s=q4();n||e.getNextSibling()!=null?e.replace(s):e.insertBefore(s),s.selectNext()},type:"element"},...e2];function CB({transformers:e=Mse}){const[t]=Qc();return S.useEffect((()=>ose(t,e)),[t,e]),null}function TB({hasStrictIndent:e=!1}){const[t]=Qc();return S.useEffect((()=>{if(!t.hasNodes([Of,ad]))throw new Error("ListPlugin: ListNode and/or ListItemNode not registered on editor")}),[t]),S.useEffect((()=>{if(e)return zne(t)}),[t,e]),(function(r){S.useEffect((()=>Une(r)),[r])})(t),null}const Lse=({onChange:e})=>{const[t]=S.useContext(Lm)||[];return S.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{is().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},Bse=()=>{const[e]=S.useContext(Lm)||[],t=S.useCallback(()=>{e&&e.dispatchCommand(ki,"bold")},[e]),r=S.useCallback(()=>{e&&e.dispatchCommand(ki,"italic")},[e]),n=S.useCallback(()=>{e&&e.dispatchCommand(ki,"underline")},[e]),s=S.useCallback(()=>{e&&e.dispatchCommand(ki,"strikethrough")},[e]),a=S.useCallback(p=>{e&&e.update(()=>{const x=Xt();Dt(x)&&im(x,()=>cf(p))})},[e]),i=S.useCallback(()=>{e&&e.update(()=>{const p=Xt();Dt(p)&&im(p,()=>Kn())})},[e]);S.useCallback(()=>{e&&e.update(()=>{const p=Xt();Dt(p)&&im(p,()=>Iv())})},[e]);const o=S.useCallback(()=>{e&&e.dispatchCommand(W4)},[e]),l=S.useCallback(()=>{e&&e.dispatchCommand(H4)},[e]),u=S.useCallback(()=>{e&&e.dispatchCommand(G4)},[e]),d=S.useCallback(p=>{e&&e.update(()=>{const x=Xt();Dt(x)&&x.getNodes().forEach(v=>{Jt(v)&&v.setStyle(`color: ${p}`)})})},[e]),h=S.useCallback(p=>{e&&e.update(()=>{const x=Xt();Dt(x)&&x.getNodes().forEach(w=>{if(Jt(w)){const C=w.getStyle(),k=C?C.replace(/font-size:\s*\d+px;?\s*/g,"").trim():"",_=k?`${k}; font-size: ${p}px;`:`font-size: ${p}px;`;w.setStyle(_)}})})},[e]),g=S.useCallback(p=>{e&&e.dispatchCommand(ZL,p)},[e]);return c.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:t,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),c.jsx("button",{type:"button",onClick:r,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),c.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),c.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:()=>a("h1"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),c.jsx("button",{type:"button",onClick:()=>a("h2"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),c.jsx("button",{type:"button",onClick:()=>a("h3"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),c.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:o,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:" List"}),c.jsx("button",{type:"button",onClick:l,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1. List"}),c.jsx("button",{type:"button",onClick:u,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:"No List"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("span",{className:"text-xs text-gray-600",children:"Color:"}),c.jsx("button",{type:"button",onClick:()=>d("#000000"),className:"w-6 h-6 bg-black border border-gray-300 rounded hover:bg-gray-800",title:"Black"}),c.jsx("button",{type:"button",onClick:()=>d("#ff0000"),className:"w-6 h-6 bg-red-500 border border-gray-300 rounded hover:bg-red-600",title:"Red"}),c.jsx("button",{type:"button",onClick:()=>d("#0000ff"),className:"w-6 h-6 bg-blue-500 border border-gray-300 rounded hover:bg-blue-600",title:"Blue"}),c.jsx("button",{type:"button",onClick:()=>d("#008000"),className:"w-6 h-6 bg-green-500 border border-gray-300 rounded hover:bg-green-600",title:"Green"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("span",{className:"text-xs text-gray-600",children:"Size:"}),c.jsx("button",{type:"button",onClick:()=>h(12),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Small",children:"12px"}),c.jsx("button",{type:"button",onClick:()=>h(16),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Normal",children:"16px"}),c.jsx("button",{type:"button",onClick:()=>h(20),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Large",children:"20px"}),c.jsx("button",{type:"button",onClick:()=>h(24),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Extra Large",children:"24px"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-xs text-gray-600",children:"Align:"}),c.jsx("button",{type:"button",onClick:()=>g("left"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Left",children:""}),c.jsx("button",{type:"button",onClick:()=>g("center"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Center",children:""}),c.jsx("button",{type:"button",onClick:()=>g("right"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Right",children:""})]})]})},$se=({value:e,onChange:t,placeholder:r})=>{const n={namespace:"LexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Mv,Of,ad,Rv,k0,Z_,Lv,Gm,Vm,Km,Df],onError:s=>{console.error("Lexical error:",s)},editorState:e?(()=>{try{const s=JSON.parse(e);return JSON.stringify(s)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return c.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:c.jsxs($9,{initialConfig:n,children:[c.jsx(Bse,{}),c.jsx(Lse,{onChange:t}),c.jsxs("div",{className:"relative",children:[c.jsx(sB,{contentEditable:c.jsx(iB,{className:"p-4 min-h-32 focus:outline-none",placeholder:r}),placeholder:c.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:cB}),c.jsx(oB,{}),c.jsx(lB,{}),c.jsx(TB,{}),c.jsx(CB,{transformers:e2})]})]})})},Use=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=Qn(),{post:o}=Wo(),{showNotification:l}=Da(),[u,d]=S.useState({test_name:e,num_questions:1,passing_score:100,questions:[{id:1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048}]}),[h,g]=S.useState({isLoading:!1,error:null,showPreview:!0});S.useEffect(()=>{d(C=>({...C,test_name:e||""}))},[e]);const p=()=>{if(u.num_questions>=3){g(_=>({..._,error:"Maximum 3 questions allowed for performance reasons"}));return}const k={id:Math.max(...u.questions.map(_=>_.id))+1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048};d(_=>({..._,num_questions:_.num_questions+1,questions:[..._.questions,k]}))},x=C=>{u.questions.length<=1||d(k=>({...k,num_questions:k.num_questions-1,questions:k.questions.filter(_=>_.id!==C)}))},v=(C,k)=>{d(_=>({..._,questions:_.questions.map(N=>N.id===C?{...N,question_json:k}:N)}))},w=async()=>{if(!u.test_name.trim()){g(C=>({...C,error:"Test name is required"}));return}if(u.questions.some(C=>!C.question_json.trim())){g(C=>({...C,error:"All questions must have content"}));return}g(C=>({...C,isLoading:!0,error:null}));try{const C={test_name:u.test_name,num_questions:u.num_questions,passing_score:u.passing_score,questions:u.questions.map((k,_)=>({question_id:_+1,question_json:k.question_json,canvas_width:k.canvas_width,canvas_height:k.canvas_height,max_canvas_width:k.max_canvas_width,max_canvas_height:k.max_canvas_height}))};t&&t(C)}catch(C){console.error("Error preparing drawing test:",C),g(k=>({...k,error:"Failed to prepare drawing test. Please try again."})),l("Failed to prepare drawing test","error")}finally{g(C=>({...C,isLoading:!1}))}};return c.jsxs("div",{className:"drawing-test-creator max-w-4xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Drawing Test"}),c.jsx("p",{className:"text-gray-600",children:"Create a test where students draw based on your instructions"})]}),c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Drawing Questions (",u.num_questions,"/3)"]}),c.jsx("p",{className:"text-sm text-gray-500",children:"Maximum 3 questions for optimal performance"})]}),c.jsxs(Je,{onClick:p,disabled:u.num_questions>=3,variant:"primary",size:"sm",className:"flex items-center gap-2",children:[c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:c.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Question"]})]}),c.jsx("div",{className:"space-y-4",children:u.questions.map((C,k)=>c.jsxs(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsxs("h4",{className:"text-md font-medium text-gray-800",children:["Text ",k+1]}),u.questions.length>1&&c.jsx(Je,{onClick:()=>x(C.id),variant:"secondary",size:"sm",className:"text-red-600 hover:text-red-700",children:c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:c.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Content *"}),c.jsx($se,{value:C.question_json,onChange:_=>v(C.id,_),placeholder:""})]})]},C.id))})]}),h.error&&c.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-700",children:h.error}),c.jsxs("div",{className:"flex justify-end gap-3",children:[c.jsx(Je,{onClick:r,variant:"secondary",disabled:h.isLoading,children:"Cancel"}),c.jsx(Je,{onClick:w,variant:"primary",disabled:h.isLoading||!u.test_name.trim(),className:"flex items-center gap-2",children:h.isLoading?c.jsxs(c.Fragment,{children:[c.jsx(Ur,{size:"sm",color:"white"}),"Saving..."]}):"Save Test"})]})]})},zse=({onChange:e})=>{const[t]=S.useContext(Lm)||[];return S.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{is().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},Wse=({onAddBlank:e,blankCount:t})=>{const[r]=S.useContext(Lm)||[],n=S.useCallback(()=>{r&&r.dispatchCommand(ki,"bold")},[r]),s=S.useCallback(()=>{r&&r.dispatchCommand(ki,"italic")},[r]),a=S.useCallback(()=>{r&&r.dispatchCommand(ki,"underline")},[r]),i=S.useCallback(()=>{r&&r.dispatchCommand(ki,"strikethrough")},[r]),o=S.useCallback(x=>{r&&r.update(()=>{const v=Xt();Dt(v)&&im(v,()=>cf(x))})},[r]),l=S.useCallback(()=>{r&&r.update(()=>{const x=Xt();Dt(x)&&im(x,()=>Kn())})},[r]),u=S.useCallback(()=>{r&&r.update(()=>{const x=Xt();Dt(x)&&im(x,()=>Iv())})},[r]),d=S.useCallback(()=>{r&&r.dispatchCommand(W4)},[r]),h=S.useCallback(()=>{r&&r.dispatchCommand(H4)},[r]),g=S.useCallback(()=>{r&&r.dispatchCommand(G4)},[r]),p=S.useCallback(()=>{!r||!e||(r.update(()=>{const x=Xt();if(Dt(x)){const w=`${t+1}_________`,C=_s(w);C.setStyle("background-color: #f0f9ff; border: 1px dashed #3b82f6; padding: 2px 4px; border-radius: 4px; font-family: monospace;"),x.insertNodes([C])}}),e())},[r,e,t]);return c.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),c.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),c.jsx("button",{type:"button",onClick:a,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),c.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:()=>o("h1"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),c.jsx("button",{type:"button",onClick:()=>o("h2"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),c.jsx("button",{type:"button",onClick:()=>o("h3"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),c.jsx("button",{type:"button",onClick:l,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"}),c.jsx("button",{type:"button",onClick:u,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Quote",children:'"'})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:d,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:""}),c.jsx("button",{type:"button",onClick:h,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1."}),c.jsx("button",{type:"button",onClick:g,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:""})]}),e&&c.jsx("div",{className:"flex items-center gap-1 border-l border-gray-300 pl-2",children:c.jsxs("button",{type:"button",onClick:p,className:"px-3 py-1 text-sm font-medium bg-blue-500 text-white border border-blue-600 rounded hover:bg-blue-600 transition-colors",title:"Add Blank",children:[c.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",className:"inline mr-1",children:c.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Blank"]})})]})},Hse=({value:e,onChange:t,placeholder:r,onAddBlank:n,blankCount:s=0})=>{const a={namespace:"FillBlanksLexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Mv,Of,ad,Rv,k0,Z_,Lv,Gm,Vm,Km,Df],onError:i=>{console.error("Lexical error:",i)},editorState:e?(()=>{try{const i=JSON.parse(e);return JSON.stringify(i)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return c.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:c.jsxs($9,{initialConfig:a,children:[c.jsx(Wse,{onAddBlank:n,blankCount:s}),c.jsx(zse,{onChange:t}),c.jsxs("div",{className:"relative",children:[c.jsx(sB,{contentEditable:c.jsx(iB,{className:"p-4 min-h-32 focus:outline-none"}),placeholder:c.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:cB}),c.jsx(oB,{}),c.jsx(lB,{}),c.jsx(TB,{}),c.jsx(CB,{transformers:e2})]})]})})},Gse=({testName:e="",allowedTime:t=null,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const{user:o}=Qn(),{post:l}=Wo(),{showNotification:u}=Da(),[d,h]=S.useState({test_name:e,test_text:"",num_questions:1,num_blanks:0,passing_score:100,separate_type:!0,allowed_time:t,blanks:[]}),[g,p]=S.useState({isLoading:!1,error:null,showPreview:!0});S.useEffect(()=>{h(F=>({...F,test_name:e||"",allowed_time:t}))},[e,t]);const x=F=>{h(A=>({...A,test_text:F}))},v=()=>{const A={id:d.blanks.length+1,position:0,question:"",options:["","","",""],correct_answer:""};h(j=>({...j,blanks:[...j.blanks,A],num_blanks:j.num_blanks+1}))},w=F=>{h(A=>({...A,blanks:A.blanks.filter(j=>j.id!==F),num_blanks:A.num_blanks-1}))},C=F=>{h(A=>({...A,blanks:A.blanks.map(j=>j.id===F?{...j,options:[...j.options,""]}:j)}))},k=(F,A)=>{h(j=>({...j,blanks:j.blanks.map(R=>R.id===F?{...R,options:R.options.filter((U,Y)=>Y!==A),correct_answer:R.correct_answer===String.fromCharCode(65+A)?"":R.correct_answer}:R)}))},_=(F,A,j)=>{h(R=>({...R,blanks:R.blanks.map(U=>U.id===F?{...U,options:U.options.map((Y,Z)=>Z===A?j:Y)}:U)}))},N=(F,A)=>{console.log(" [DEBUG] updateBlankQuestion called:",{blankId:F,question:A}),h(j=>({...j,blanks:j.blanks.map(R=>R.id===F?{...R,question:A}:R)})),console.log(" [DEBUG] updateBlankQuestion completed")},E=(F,A)=>{h(j=>({...j,blanks:j.blanks.map(R=>R.id===F?{...R,correct_answer:A}:R)}))},P=async()=>{if(!d.test_name.trim()){p(F=>({...F,error:"Test name is required"}));return}if(!d.test_text.trim()){p(F=>({...F,error:"Test text is required"}));return}if(d.blanks.length===0){p(F=>({...F,error:"At least one blank is required"}));return}if(console.log(" [DEBUG] Validating blanks:",d.blanks),d.blanks.forEach((F,A)=>{console.log(` [DEBUG] Blank ${A+1}:`,{question:F.question,questionTrimmed:F.question?.trim(),correct_answer:F.correct_answer,options:F.options})}),d.separate_type===!1){if(d.blanks.some(F=>!F.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing correct answer"),p(F=>({...F,error:"All blanks must have correct answers"}));return}}else if(d.blanks.some(F=>!F.question.trim()||!F.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing question or correct answer"),p(F=>({...F,error:"All blanks must have question text and correct answer"}));return}console.log(" [DEBUG] Validation passed - all blanks have question and correct answer"),p(F=>({...F,isLoading:!0,error:null}));try{const F={test_name:d.test_name,test_text:d.test_text,num_questions:d.blanks.length,num_blanks:d.blanks.length,separate_type:d.separate_type,passing_score:d.passing_score,allowed_time:d.allowed_time,blanks:d.blanks.map((A,j)=>({question_id:j+1,question_json:A.question,question:A.question,options:A.options,correct_answer:A.correct_answer,blank_positions:{},blank_options:A.options||[],correct_answers:[A.correct_answer]}))};console.log(" [DEBUG] Calling onTestSaved with data:",F),r?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),r(F),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(F){console.error("Error preparing fill blanks test:",F),p(A=>({...A,error:"Failed to prepare fill blanks test. Please try again."})),u("Failed to prepare fill blanks test","error")}finally{p(F=>({...F,isLoading:!1}))}};return c.jsxs("div",{className:"fill-blanks-test-creator max-w-4xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Fill Blanks Test"}),c.jsx("p",{className:"text-gray-600",children:"Create a test with text content and multiple choice blanks"}),g.error&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-red-600 text-sm",children:g.error})})]}),c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${d.separate_type===!0?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>h(F=>({...F,separate_type:!0})),children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx("input",{type:"radio",checked:d.separate_type===!0,onChange:()=>h(F=>({...F,separate_type:!0})),className:"mr-3"}),c.jsx("h4",{className:"font-medium",children:"Separate Mode"})]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Multiple choice questions below the text"})]}),c.jsxs("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${d.separate_type===!1?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>h(F=>({...F,separate_type:!1})),children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx("input",{type:"radio",checked:d.separate_type===!1,onChange:()=>h(F=>({...F,separate_type:!1})),className:"mr-3"}),c.jsx("h4",{className:"font-medium",children:"Inline Mode"})]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Dropdown for option inside the text"})]})]}),c.jsx(Hse,{value:d.test_text,onChange:x,placeholder:"Type your text here. Use the 'Add Blank' button in the toolbar to insert blanks.",onAddBlank:v,blankCount:d.blanks.length})]}),d.separate_type===!0&&c.jsx("div",{className:"space-y-4",children:d.blanks.map((F,A)=>c.jsxs(At,{className:"p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-md font-medium",children:["Blank ",F.id," Configuration"]}),c.jsx(Je,{variant:"danger",size:"small",onClick:()=>w(F.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Question Text for Blank ",F.id," *"]}),c.jsx("input",{type:"text",placeholder:"Enter question text for this blank",value:F.question,onChange:j=>N(F.id,j.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),F.options.map((j,R)=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+R)}),c.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+R)}`,value:j||"",onChange:U=>_(F.id,R,U.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),F.options.length>2&&c.jsx(Je,{variant:"danger",size:"small",onClick:()=>k(F.id,R),className:"px-2 py-1 text-sm",children:""})]},R)),F.options.length<6&&c.jsx(Je,{variant:"secondary",size:"small",onClick:()=>C(F.id),className:"w-full",children:"+ Add Option"})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),c.jsxs("select",{value:F.correct_answer||"",onChange:j=>E(F.id,j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[c.jsx("option",{value:"",children:"Select correct answer"}),F.options.filter(j=>j.trim().length>0).map((j,R)=>c.jsxs("option",{value:String.fromCharCode(65+R),children:[String.fromCharCode(65+R),") ",j]},R))]})]})]},F.id))}),d.separate_type===!1&&c.jsx("div",{className:"space-y-4",children:d.blanks.map((F,A)=>c.jsxs(At,{className:"p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-md font-medium",children:["Blank ",F.id," Options"]}),c.jsx(Je,{variant:"danger",size:"small",onClick:()=>w(F.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),F.options.map((j,R)=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+R)}),c.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+R)}`,value:j||"",onChange:U=>_(F.id,R,U.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),F.options.length>2&&c.jsx(Je,{variant:"danger",size:"small",onClick:()=>k(F.id,R),className:"px-2 py-1 text-sm",children:""})]},R)),F.options.length<6&&c.jsx(Je,{variant:"secondary",size:"small",onClick:()=>C(F.id),className:"w-full",children:"+ Add Option"})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),c.jsxs("select",{value:F.correct_answer||"",onChange:j=>E(F.id,j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[c.jsx("option",{value:"",children:"Select correct answer"}),F.options.filter(j=>j.trim().length>0).map((j,R)=>c.jsxs("option",{value:String.fromCharCode(65+R),children:[String.fromCharCode(65+R),") ",j]},R))]})]})]},F.id))}),c.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[c.jsx(Je,{onClick:n,variant:"secondary",disabled:a,children:"Cancel"}),c.jsx(Je,{onClick:P,variant:"primary",disabled:a||d.blanks.length===0,children:a?c.jsx(Ur,{size:"sm"}):"Save Test"})]})]})},Vse=[{value:"A1",label:"A1 (Beginner)",description:"Basic vocabulary, simple sentences"},{value:"A2",label:"A2 (Elementary)",description:"Everyday vocabulary, present/past tenses"},{value:"B1",label:"B1 (Intermediate)",description:"Varied vocabulary, complex sentences"},{value:"B2",label:"B2 (Upper-Intermediate)",description:"Advanced vocabulary, sophisticated structures"},{value:"C1",label:"C1 (Advanced)",description:"Nuanced vocabulary, complex discourse"},{value:"C2",label:"C2 (Proficiency)",description:"Native-like fluency and accuracy"}],Kse=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{showNotification:i}=Da(),[o,l]=S.useState({min_words:50,questions:[{question_id:1,prompt:"",expected_duration:null,difficulty_level:"B1"}]}),[u,d]=S.useState(!1),h=S.useCallback((C,k)=>{l(_=>({..._,[C]:k}))},[]),g=S.useCallback((C,k,_)=>{l(N=>({...N,questions:N.questions.map((E,P)=>P===C?{...E,[k]:_}:E)}))},[]),p=S.useCallback(()=>{l(C=>({...C,questions:[...C.questions,{question_id:C.questions.length+1,prompt:"",expected_duration:null,difficulty_level:"B1"}]}))},[]),x=S.useCallback(C=>{o.questions.length>1&&l(k=>({...k,questions:k.questions.filter((_,N)=>N!==C)}))},[o.questions.length]),v=S.useCallback(()=>{const C={};return o.min_words<10&&(C.min_words="Minimum word count must be at least 10 words"),o.questions.forEach((k,_)=>{k.prompt.trim()||(C[`question_${_}_prompt`]="Question prompt is required")}),C},[o]),w=S.useCallback(async C=>{C.preventDefault();const k=v();if(Object.keys(k).length>0){i("Please fix the validation errors","error");return}d(!0);try{const _={test_name:e,time_limit:300,min_duration:30,max_duration:600,max_attempts:3,min_words:o.min_words,passing_score:50,allowed_time:null,questions:o.questions.map((N,E)=>({question_id:E+1,prompt:N.prompt,expected_duration:N.expected_duration,difficulty_level:N.difficulty_level}))};console.log(" [DEBUG] Calling onTestSaved with data:",_),t?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),t(_),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(_){console.error("Error preparing speaking test:",_),i("Failed to prepare speaking test","error")}finally{d(!1)}},[o,v,i,t,e]);return u||s?c.jsxs("div",{className:"flex items-center justify-center p-8",children:[c.jsx(Ur,{}),c.jsx("span",{className:"ml-2",children:"Creating speaking test..."})]}):c.jsxs("div",{className:"speaking-test-creator max-w-4xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Speaking Test"}),c.jsx("p",{className:"text-gray-600",children:"Create a speaking test where students record audio responses with AI-powered feedback"})]}),c.jsxs("form",{onSubmit:w,className:"space-y-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Scoring Settings"}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Word Count *"}),c.jsx("input",{type:"number",min:"10",max:"1000",value:o.min_words,onChange:C=>h("min_words",parseInt(C.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.min_words&&c.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.min_words})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Questions"}),c.jsx(Je,{type:"button",variant:"outline",onClick:p,children:"Add Question"})]}),o.questions.length>1&&c.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:c.jsxs("div",{className:"flex items-start",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Multiple Questions Detected"}),c.jsx("div",{className:"mt-1 text-sm text-blue-700",children:c.jsxs("p",{children:["You have ",o.questions.length," questions in this test.",c.jsx("strong",{children:" Only one question will be randomly selected"})," and shown to each student. This ensures fair distribution across your question pool."]})})]})]})}),o.questions.map((C,k)=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsxs("h4",{className:"font-medium",children:["Question ",k+1]}),o.questions.length>1&&c.jsx(Je,{type:"button",variant:"outline",size:"sm",onClick:()=>x(k),className:"text-red-600 hover:text-red-700",children:"Remove"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Prompt *"}),c.jsx("textarea",{value:C.prompt,onChange:_=>g(k,"prompt",_.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Enter the question prompt for students"}),a[`question_${k}_prompt`]&&c.jsx("p",{className:"text-red-500 text-sm mt-1",children:a[`question_${k}_prompt`]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected Duration (seconds)"}),c.jsx("input",{type:"number",min:"10",max:"600",value:C.expected_duration||"",onChange:_=>g(k,"expected_duration",_.target.value?parseInt(_.target.value):null),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CEFR Level"}),c.jsx("select",{value:C.difficulty_level,onChange:_=>g(k,"difficulty_level",_.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:Vse.map(_=>c.jsxs("option",{value:_.value,children:[_.label," - ",_.description]},_.value))}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the appropriate CEFR level for this question. This will be used by AI to evaluate students appropriately."})]})]})]})]},k))]}),c.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[c.jsx(Je,{type:"button",variant:"secondary",onClick:r,children:"Cancel"}),c.jsx(Je,{type:"submit",variant:"primary",disabled:u||s,children:u||s?"Creating...":"Create Speaking Test"})]})]})]})},EB=(e,t)=>{const[r,n]=S.useState(()=>{try{const i=window.localStorage.getItem(e);return i?JSON.parse(i):t}catch(i){return console.error(`Error reading localStorage key "${e}":`,i),t}}),s=S.useCallback(i=>{try{const o=i instanceof Function?i(r):i;n(o),window.localStorage.setItem(e,JSON.stringify(o))}catch(o){console.error(`Error setting localStorage key "${e}":`,o)}},[e,r]),a=S.useCallback(()=>{try{window.localStorage.removeItem(e),n(t)}catch(i){console.error(`Error removing localStorage key "${e}":`,i)}},[e,t]);return[r,s,a]},t2=()=>{const e=S.useCallback((l,u=null)=>{try{const d=window.localStorage.getItem(l);return d?JSON.parse(d):u}catch(d){return console.error(`Error reading localStorage key "${l}":`,d),u}},[]),t=S.useCallback((l,u)=>{try{window.localStorage.setItem(l,JSON.stringify(u))}catch(d){console.error(`Error setting localStorage key "${l}":`,d)}},[]),r=S.useCallback(l=>{try{window.localStorage.removeItem(l)}catch(u){console.error(`Error removing localStorage key "${l}":`,u)}},[]),n=S.useCallback(()=>{if(confirm("Are you sure you want to clear all local storage? This cannot be undone."))try{window.localStorage.clear(),window.showNotification?window.showNotification("All local storage cleared!","success"):console.log("All local storage cleared!")}catch(l){console.error("Error clearing localStorage:",l)}},[]),s=S.useCallback(()=>{try{const l={};for(let g=0;g<window.localStorage.length;g++){const p=window.localStorage.key(g);p&&(l[p]=window.localStorage.getItem(p))}const u=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),d=URL.createObjectURL(u),h=document.createElement("a");h.href=d,h.download="localStorage_backup.json",h.click(),URL.revokeObjectURL(d),window.showNotification?window.showNotification("Local storage exported!","success"):console.log("Local storage exported!")}catch(l){console.error("Error exporting localStorage data:",l)}},[]),a=S.useCallback(()=>{try{window.localStorage.clear()}catch(l){console.error("Error clearing localStorage:",l)}},[]),i=S.useCallback(()=>{try{const l={};for(let u=0;u<window.localStorage.length;u++){const d=window.localStorage.key(u);d&&(l[d]=window.localStorage.getItem(d))}return l}catch(l){return console.error("Error exporting localStorage data:",l),{}}},[]),o=S.useCallback(l=>{try{Object.entries(l).forEach(([u,d])=>{window.localStorage.setItem(u,d)})}catch(u){console.error("Error importing localStorage data:",u)}},[]);return{getItem:e,setItem:t,removeItem:r,clearAll:a,clearAllLocalStorage:n,exportLocalStorage:s,exportData:i,importData:o}},qse=({question:e,testId:t,testType:r="true_false",mode:n="student",displayNumber:s,studentAnswer:a,onAnswerChange:i,onQuestionChange:o,onSave:l,isEditing:u=!1,isSaving:d=!1,validationErrors:h={},showCorrectAnswers:g=!1,studentId:p=null})=>{const{getItem:x,setItem:v}=t2();Da(),S.useRef(null);const[w,C]=S.useState(""),[k,_]=S.useState(""),[N,E]=S.useState(""),[P,F]=S.useState(!1),[A,j]=S.useState(!0),[R,U]=S.useState(""),[Y,Z]=S.useState(!1),[ae,ee]=S.useState(null);S.useEffect(()=>{if(e&&(E(e.question||""),_(e.correct_answer||""),n==="student"&&p)){const se=x(`test_progress_${p}_${r}_${t}_${e.question_id}`);se&&C(se)}},[e,t,r,n,x]),S.useEffect(()=>{n==="student"&&a!==void 0&&a!==null&&(console.log(" TrueFalseQuestion syncing with parent studentAnswer:",a),C(a))},[a,n]),S.useEffect(()=>{if(n==="student"&&w&&t&&e?.question_id&&p){const se=setTimeout(()=>{Z(!0),v(`test_progress_${p}_${r}_${t}_${e.question_id}`,w),ee(new Date().toLocaleTimeString()),setTimeout(()=>Z(!1),1e3)},1e3);return()=>clearTimeout(se)}},[w,t,r,e?.question_id,n,p,v]),S.useEffect(()=>{if(n==="teacher"&&(N||k)){const se=setTimeout(()=>{Z(!0);const X={question:N,correct_answer:k,timestamp:Date.now()};v(`teacher_form_${r}_${t}`,X),ee(new Date().toLocaleTimeString()),setTimeout(()=>Z(!1),1e3)},2e3);return()=>clearTimeout(se)}},[N,k,t,r,n,v]);const ne=S.useCallback(se=>{n==="student"&&(C(se),i&&i(e.question_id,se),M(se))},[n,e?.question_id,i]),L=S.useCallback(se=>{E(se),o&&o(e.question_id,se),V(se)},[e?.question_id,o]),H=S.useCallback(se=>{_(se),o&&o(e.question_id,{...e,correct_answer:se}),W(se)},[e,o]),M=S.useCallback(se=>{if(n==="student"){if(!se){j(!1),U("Please select an answer");return}j(!0),U("")}},[n]),V=S.useCallback(se=>{if(n==="teacher"){if(!se||se.trim().length<10){j(!1),U("Question must be at least 10 characters long");return}j(!0),U("")}},[n]),W=S.useCallback(se=>{if(n==="teacher"){if(!se){j(!1),U("Please select a correct answer");return}j(!0),U("")}},[n]),I=S.useCallback(()=>{if(n!=="teacher"||!l)return;const se={question_id:e.question_id,question:N,correct_answer:k,type:"true_false"};l(se)},[n,l,e?.question_id,N,k]),B=S.useCallback(se=>se?se.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]),q=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:e?.question_id]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[Y&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(Ur,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),ae&&!Y&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",ae]})]})]}),c.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:B(N)}}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${w==="true"?"border-blue-500 bg-blue-50":"border-gray-200"} ${g&&k==="true"?"ring-2 ring-green-400":""}`,children:[c.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"true",checked:w==="true",onChange:()=>ne("true"),className:"sr-only","aria-label":"True"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${w==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:w==="true"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${w==="false"?"border-blue-500 bg-blue-50":"border-gray-200"} ${g&&k==="false"?"ring-2 ring-green-400":""}`,children:[c.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"false",checked:w==="false",onChange:()=>ne("false"),className:"sr-only","aria-label":"False"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${w==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:w==="false"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]}),!A&&R&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:R})]}),J=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[Y&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(Ur,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),ae&&!Y&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",ae]})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),c.jsx("textarea",{id:`question_${e?.question_id}`,value:N,onChange:se=>L(se.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Correct Answer *"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${k==="true"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[c.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"true",checked:k==="true",onChange:()=>H("true"),className:"sr-only","aria-label":"True"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${k==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:k==="true"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${k==="false"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[c.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"false",checked:k==="false",onChange:()=>H("false"),className:"sr-only","aria-label":"False"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${k==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:k==="false"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]})]})]}),!A&&R&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:R}),c.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:c.jsx(Je,{variant:"success",onClick:I,disabled:!A||d,className:"w-full sm:w-auto",children:d?c.jsx(Ur,{size:"small"}):"Save Question"})})]});return c.jsx("div",{className:"true-false-question-container",children:n==="student"?q():J()})},Yse=({question:e,testId:t,testType:r="multiple_choice",mode:n="student",studentAnswer:s,onAnswerChange:a,onQuestionChange:i,onOptionAdd:o,onOptionRemove:l,onSave:u,isEditing:d=!1,isSaving:h=!1,validationErrors:g={},showCorrectAnswers:p=!1,studentId:x=null,displayNumber:v})=>{const{getItem:w,setItem:C}=t2(),{showNotification:k}=Da();S.useRef(null);const[_,N]=S.useState(""),[E,P]=S.useState(["","","",""]),[F,A]=S.useState(""),[j,R]=S.useState(""),[U,Y]=S.useState(!1),[Z,ae]=S.useState(!0),[ee,ne]=S.useState(""),[L,H]=S.useState(!1),[M,V]=S.useState(null);S.useEffect(()=>{if(e&&(R(e.question||""),P(e.options||["","","",""]),A(e.correct_answer||""),n==="student"&&x)){const Ne=w(`test_progress_${x}_${r}_${t}_${e.question_id}`);Ne&&N(Ne)}},[e,t,r,n,w]),S.useEffect(()=>{n==="student"&&s!==void 0&&s!==null&&(console.log(" MultipleChoiceQuestion syncing with parent studentAnswer:",s),N(s))},[s,n]),S.useEffect(()=>{if(n==="student"&&_&&t&&e?.question_id&&x){const Ne=setTimeout(()=>{H(!0),C(`test_progress_${x}_${r}_${t}_${e.question_id}`,_),V(new Date().toLocaleTimeString()),setTimeout(()=>H(!1),1e3)},1e3);return()=>clearTimeout(Ne)}},[_,t,r,e?.question_id,n,x,C]),S.useEffect(()=>{if(n==="teacher"&&(j||E.some(Ne=>Ne.trim()))){const Ne=setTimeout(()=>{H(!0);const je={question:j,options:E,correct_answer:F,timestamp:Date.now()};C(`teacher_form_${r}_${t}`,je),V(new Date().toLocaleTimeString()),setTimeout(()=>H(!1),1e3)},2e3);return()=>clearTimeout(Ne)}},[j,E,F,t,r,n,C]),S.useCallback(Ne=>{if(n!=="student")return;const je=String(Ne);N(je),a&&a(e.question_id,je),se(je)},[n,e?.question_id,a]);const W=S.useCallback(Ne=>{R(Ne),i&&i(e.question_id,Ne),X(Ne)},[e?.question_id,i]),I=S.useCallback((Ne,je)=>{const Ke=[...E];Ke[Ne]=je,P(Ke),i&&i(e.question_id,{...e,options:Ke}),ie(Ke)},[E,e,i]),B=S.useCallback(Ne=>{A(Ne),i&&i(e.question_id,{...e,correct_answer:Ne}),le(Ne)},[e,i]),q=S.useCallback(()=>{if(E.length<6){const Ne=[...E,""];P(Ne),o&&o(e.question_id,Ne)}else k("Maximum 6 options allowed","warning")},[E,e?.question_id,o,k]),J=S.useCallback(Ne=>{if(E.length>2){const je=E.filter((Ke,Ue)=>Ue!==Ne);if(P(je),F===String.fromCharCode(65+Ne))A("");else if(F&&String.fromCharCode(65+Ne)<F){const Ke=String.fromCharCode(65+Ne-1);A(Ke)}l&&l(e.question_id,je)}else k("Minimum 2 options required","warning")},[E,F,e?.question_id,l,k]),se=S.useCallback(Ne=>{if(n==="student"){if(!Ne){ae(!1),ne("Please select an answer");return}ae(!0),e?.correct_answer&&Ne===e.correct_answer?ne(" Correct answer!"):e?.correct_answer?ne(" Incorrect answer"):ne("Answer selected")}},[n,e?.correct_answer]),X=S.useCallback(Ne=>!Ne||Ne.trim().length<10?(ae(!1),ne("Question must be at least 10 characters long"),!1):(ae(!0),ne(""),!0),[]),ie=S.useCallback(Ne=>{if(n!=="teacher")return;if(Ne.filter(Ke=>Ke.trim().length>0).length<2){ae(!1),ne("At least 2 options must be filled");return}if(Ne.some(Ke=>Ke.trim().length>0&&Ke.trim().length<3)){ae(!1),ne("Each option must be at least 3 characters long");return}ae(!0),ne("")},[n]),le=S.useCallback(Ne=>{if(n==="teacher"){if(!Ne){ae(!1),ne("Please select a correct answer");return}ae(!0),ne("")}},[n]),ce=S.useCallback(()=>{if(n!=="teacher"||!u)return;const Ne={question_id:e.question_id,question:j,options:E.filter(je=>je.trim().length>0),correct_answer:F,type:"multiple_choice"};u(Ne)},[n,u,e?.question_id,j,E,F]),ke=S.useCallback(Ne=>Ne?Ne.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]);return n==="teacher"?c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[L&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(Ur,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),M&&!L&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",M]})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),c.jsx("textarea",{id:`question_${e?.question_id}`,value:j,onChange:Ne=>W(Ne.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Answer Options *"}),c.jsx(Je,{variant:"secondary",size:"small",onClick:q,disabled:E.length>=6,className:"px-3 py-1 text-sm",children:"+ Add Option"})]}),c.jsx("div",{className:"space-y-3",children:E.map((Ne,je)=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+je)}),c.jsx("input",{type:"text",value:Ne,onChange:Ke=>I(je,Ke.target.value),placeholder:`Option ${String.fromCharCode(65+je)}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0}),E.length>2&&c.jsx(Je,{variant:"danger",size:"small",onClick:()=>J(je),className:"px-2 py-1 text-sm",children:""})]},je))})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:`correct_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),c.jsxs("select",{id:`correct_${e?.question_id}`,value:F,onChange:Ne=>B(Ne.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0,children:[c.jsx("option",{value:"",children:"Select correct answer"}),E.map((Ne,je)=>{if(!Ne.trim())return null;const Ke=String.fromCharCode(65+je);return c.jsxs("option",{value:Ke,children:[Ke,") ",Ne]},je)})]})]})]}),!Z&&ee&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:ee}),c.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:c.jsx(Je,{variant:"success",onClick:ce,disabled:!Z||h,className:"w-full sm:w-auto",children:h?c.jsx(Ur,{size:"small"}):"Save Question"})})]}):c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof v=="number"?v:e?.question_id]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[L&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(Ur,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),M&&!L&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",M]})]})]}),c.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:ke(j)}}),c.jsx("div",{className:"space-y-3",children:E.map((Ne,je)=>c.jsxs("label",{className:`flex items-center p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ${_===String.fromCharCode(65+je)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[c.jsx("input",{type:"radio",name:`mcq_${t}_${e?.question_id}`,value:String.fromCharCode(65+je),checked:_===String.fromCharCode(65+je),onChange:Ke=>{N(Ke.target.value),a&&a(e?.question_id,Ke.target.value)},className:"mr-3"}),c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600 mr-3",children:String.fromCharCode(65+je)}),c.jsx("span",{className:"flex-1",children:Ne||`Option ${String.fromCharCode(65+je)}`})]},je))}),!Z&&ee&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:ee})]})},Xse=({question:e,testId:t,testType:r="input",mode:n="student",displayNumber:s,studentAnswer:a,onAnswerChange:i,onQuestionChange:o,onAnswerAdd:l,onAnswerRemove:u,onSave:d,isEditing:h=!1,isSaving:g=!1,validationErrors:p={},showCorrectAnswers:x=!1,studentId:v=null})=>{const{getItem:w,setItem:C}=t2(),{showNotification:k}=Da(),_=S.useRef(null),[N,E]=S.useState(""),[P,F]=S.useState([""]),[A,j]=S.useState(!1),[R,U]=S.useState(!0),[Y,Z]=S.useState(""),[ae,ee]=S.useState(!1);S.useEffect(()=>{if(n==="student"&&e?.question_id&&t&&r&&v){const X=`test_progress_${v}_${r}_${t}_${e.question_id}`,ie=w(X);ie&&E(ie)}},[e?.question_id,r,t,n,v,w]),S.useEffect(()=>{n==="student"&&a!==void 0&&a!==null&&(console.log(" InputQuestion syncing with parent studentAnswer:",a),E(a))},[a,n]),S.useEffect(()=>{n==="teacher"&&e?.answers&&F(e.answers.length>0?e.answers:[""])},[e?.answers,n]),S.useEffect(()=>{if(n==="student"&&N&&e?.question_id&&t&&r&&v){const X=setTimeout(()=>{ee(!0),C(`test_progress_${v}_${r}_${t}_${e.question_id}`,N),setTimeout(()=>ee(!1),1e3)},1e3);return()=>clearTimeout(X)}},[N,e?.question_id,r,t,n,v,C]),S.useEffect(()=>{if(n==="teacher"&&P&&o){const X=setTimeout(()=>{o({...e,answers:P.filter(ie=>ie.trim())})},500);return()=>clearTimeout(X)}},[P,e,n,o]);const ne=S.useCallback(X=>{E(X);const ie=X.trim().length>0;U(ie),Z(ie?"":"Please enter an answer"),i&&i(e.question_id,X)},[e?.question_id,i]),L=S.useCallback((X,ie)=>{const le=[...P];le[X]=ie,F(le),i&&i(e.question_id,le)},[P,e?.question_id,i]),H=S.useCallback(()=>{if(n==="teacher"){const X=[...P,""];F(X),l&&l(e.question_id,X)}},[P,e?.question_id,n,l]),M=S.useCallback(X=>{if(n==="teacher"&&P.length>1){const ie=P.filter((le,ce)=>ce!==X);F(ie),u&&u(e.question_id,ie)}},[P,e?.question_id,n,u]),V=S.useCallback(()=>{if(n==="student"){const X=N.trim().length>0;return U(X),Z(X?"":"Please enter an answer"),X}else if(n==="teacher"){const X=P.some(ie=>ie.trim().length>0);return U(X),Z(X?"":"Please enter at least one correct answer"),X}return!0},[N,P,n]),W=S.useCallback(X=>X?X.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>"):"",[]),I=S.useCallback(()=>{j(!0)},[]),B=S.useCallback(()=>{j(!1),V()},[V]),q=S.useCallback(X=>{X.key==="Enter"&&n==="student"&&N.trim()&&(C(`test_progress_${r}_${t}_${e.question_id}`,N),k("Answer saved","success"))},[N,r,t,e?.question_id,n,C,k]),J=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:e.question_id]}),ae&&c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[c.jsx(Ur,{size:"small"}),c.jsx("span",{children:"Saving..."})]})]}),c.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:W(e.question)}}),c.jsx("div",{className:"space-y-3",children:c.jsx("input",{ref:_,type:"text",id:`input_${e.question_id}`,placeholder:"Enter your answer here...",value:N,onChange:X=>ne(X.target.value),onFocus:I,onBlur:B,onKeyPress:q,className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${R?A?"border-blue-500":"border-gray-300 hover:border-gray-400":"border-red-300 focus:border-red-500 focus:ring-red-500"}`,"data-question-id":e.question_id,"aria-label":`Answer for question ${e.question_id}`,"aria-invalid":!R,"aria-describedby":R?void 0:`error-${e.question_id}`})}),x&&e.correct_answers&&c.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[c.jsx("h5",{className:"text-sm font-semibold text-green-800 mb-2",children:"Correct Answers:"}),c.jsx("ul",{className:"space-y-1",children:e.correct_answers.map((X,ie)=>c.jsxs("li",{className:"text-green-700 text-sm",children:[" ",X]},ie))})]})]}),se=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e.question_id||"New"]}),g&&c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[c.jsx(Ur,{size:"small"}),c.jsx("span",{children:"Saving..."})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:`question_${e.question_id||"new"}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),c.jsx("input",{type:"text",id:`question_${e.question_id||"new"}`,value:e.question||"",onChange:X=>o&&o({...e,question:X.target.value}),placeholder:"Enter question text",className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${p.question?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 hover:border-gray-400 focus:border-blue-500"}`}),p.question&&c.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:p.question})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Correct Answers *"}),c.jsx(Je,{type:"button",variant:"secondary",size:"small",onClick:H,className:"px-3 py-1 text-sm",children:"+ Add Answer"})]}),c.jsx("div",{className:"space-y-3",children:P.map((X,ie)=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:ie+1}),c.jsx("input",{type:"text",value:X,onChange:le=>L(ie,le.target.value),placeholder:`Correct answer ${ie+1}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200","data-question-id":e.question_id,"data-answer-index":ie}),P.length>1&&c.jsx(Je,{type:"button",variant:"danger",size:"small",onClick:()=>M(ie),className:"px-2 py-1 text-sm",children:" Remove"})]},ie))}),p.answers&&c.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:p.answers})]})]}),d&&c.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:c.jsx(Je,{type:"button",variant:"success",onClick:d,disabled:g,className:"w-full sm:w-auto",children:g?c.jsx(Ur,{size:"small"}):"Save Question"})})]});return c.jsx("div",{className:`input-question-container ${n} ${A?"focused":""}`,children:n==="student"?J():se()})},qm=(e,t,r)=>{const[n,s]=S.useState(!1),[a,i]=S.useState(0),[o,l]=S.useState(!1),u=S.useRef(!1);S.useEffect(()=>{if(!e||!t||!r)return;const w=`anti_cheating_${r}_${e}_${t}`,C=Es(w);C&&(i(C.tabSwitches||0),l(C.isCheating||!1))},[e,t,r]);const d=S.useCallback(()=>{if(console.log(" handleTabSwitch called - isTracking:",u.current),!u.current){console.log(" Not tracking, returning early");return}console.log(" Tab switch detected - starting 7 second timer...");const w=Date.now();setTimeout(()=>{const C=Date.now()-w;console.log(" Timer completed - time hidden:",C,"ms"),C>=6500?(console.log(" Tab was hidden for sufficient time - counting as tab switch"),i(k=>{const _=k+1,N=_>=2;console.log(" Tab switch count updated:",{newCount:_,cheating:N}),l(N);const E=`anti_cheating_${r}_${e}_${t}`;return us(E,{tabSwitches:_,isCheating:N},120*1e3),_})):console.log(" Tab was not hidden long enough - not counting as switch")},7e3)},[e,t,r]),h=S.useCallback(()=>{u.current&&(console.log(" Visibility change detected:",{hidden:document.hidden,isTracking:u.current}),document.hidden?d():console.log(" Tab became visible"))},[d]),g=S.useCallback(()=>{console.log(" startTracking called - setting up anti-cheating detection"),console.log(" Current document.hidden state:",document.hidden),console.log(" Current document.visibilityState:",document.visibilityState),s(!0),u.current=!0,document.addEventListener("visibilitychange",h),console.log(" Anti-cheating event listeners added (visibilitychange only)")},[h]),p=S.useCallback(()=>{console.log(" stopTracking called - removing anti-cheating detection"),s(!1),u.current=!1,document.removeEventListener("visibilitychange",h),console.log(" Anti-cheating event listeners removed")},[h]),x=S.useCallback(()=>{const w={caught_cheating:o,visibility_change_times:a};return console.log(" getCheatingData called:",w),w},[o,a]),v=S.useCallback(()=>{r&&e&&t&&Dm(r,e,t),i(0),l(!1),console.log(" Anti-cheating data deleted from localStorage")},[r,e,t]);return{startTracking:g,stopTracking:p,clearData:v,getCheatingData:x,tabSwitches:a,isCheating:o,isTracking:n}},Jse=({testData:e,onTestComplete:t,onBackToCabinet:r,isTestComplete:n=!1,testScore:s=null})=>{const[a,i]=S.useState(null),[o,l]=S.useState(null);S.useEffect(()=>{(async()=>{try{const[pt,Rt]=await Promise.all([Gi(()=>Promise.resolve().then(()=>Iee),void 0),Gi(()=>Promise.resolve().then(()=>gZ),void 0)]);i(pt),l(Rt.default)}catch(pt){console.error("Failed to load Konva:",pt)}})()},[]);const u=()=>a?{Stage:a.Stage,Layer:a.Layer,Rect:a.Rect,Arrow:a.Arrow,KonvaImage:a.Image,KonvaText:a.Text,Group:a.Group}:null,[d,h]=S.useState({}),[g,p]=S.useState({}),[x,v]=S.useState(0),[w,C]=S.useState(!1),[k,_]=S.useState(null),[N,E]=S.useState(0),[P,F]=S.useState(0),[A,j]=S.useState(null),[R,U]=S.useState(null),[Y,Z]=S.useState(!1),[ae,ee]=S.useState(!1),[ne,L]=S.useState(!1),{showNotification:H}=Da(),{makeAuthenticatedRequest:M}=Wo(),{user:V}=Qn(),{startTracking:W,stopTracking:I,getCheatingData:B,clearData:q}=qm("matching_type",e?.id,V?.student_id||V?.id),J=S.useRef(null),se=S.useRef(null),X=S.useRef(null),ie=S.useRef(0),[le,ce]=S.useState(400);S.useRef({});const ke=S.useCallback(()=>{Z(!0)},[]),re=S.useCallback(()=>{p({}),h({}),Z(!1)},[]),ge=S.useCallback(()=>{ee(!0)},[]),Ne=S.useCallback(()=>{ee(!1),r()},[r]),je=S.useMemo(()=>{if(!e)return null;const lt=e.blocks.map(Mt=>{let Qe=Mt.coordinates;if(typeof Qe=="string")try{Qe=JSON.parse(Qe)}catch(Re){console.error(" Failed to parse coordinates:",Re),Qe={x:0,y:0,width:100,height:100}}return Qe={x:(typeof Qe.x=="number"?Qe.x:Number(Qe.x))||0,y:(typeof Qe.y=="number"?Qe.y:Number(Qe.y))||0,width:(typeof Qe.width=="number"?Qe.width:Number(Qe.width))||30,height:(typeof Qe.height=="number"?Qe.height:Number(Qe.height))||10},{id:Mt.id,word:Mt.word,coordinates:Qe,hasArrow:Mt.hasArrow,arrow:Mt.arrow}}),pt=Array.isArray(e.arrows)?e.arrows:[],Rt=e.words.map(Mt=>({id:Mt.id,word:Mt.word,blockId:null,isPlaced:!1,isCorrect:!1}));return{blocks:lt,arrows:pt,words:Rt}},[e]);S.useEffect(()=>{if(!e?.image_url)return;const lt=new Image;lt.crossOrigin="anonymous",lt.onload=()=>{console.log(" Image loaded successfully"),E(lt.width),F(lt.height);const pt=J.current?.clientWidth||800,Rt=J.current?.clientHeight||600,Mt=pt/lt.width,Qe=Rt/lt.height,Re=Math.min(Mt,Qe,1),Be=lt.width*Re,ct=lt.height*Re,We=(pt-Be)/2,nt=(Rt-ct)/2;_({x:We,y:nt,width:Be,height:ct,scaleX:Re,scaleY:Re,scale:Re,image:lt}),ie.current=J.current?.clientWidth||800,console.log(" Image info calculated:",{x:We,y:nt,width:Be,height:ct,scaleX:Re,scaleY:Re})},lt.onerror=()=>{console.error(" Failed to load image"),H("Failed to load test image","error")},lt.src=e.image_url},[e?.image_url,H]),S.useEffect(()=>{if(!je||!k)return;const lt=ie.current||J.current?.clientWidth||800,pt=12,Rt=38;let Mt=k.x,Qe=k.y+k.height+pt;const Re=k.x+k.width,Be={};je.words.forEach(nt=>{if(!Object.prototype.hasOwnProperty.call(g,nt.id)){const Tt=typeof nt.word=="string"?nt.word:"",jt=Math.max(60,Tt.length*8+20);Mt+jt>Math.min(lt-pt,Re)&&(Mt=k.x,Qe+=Rt),d[nt.id]||(Be[nt.id]={x:Mt,y:Qe}),Mt+=jt+pt}}),Object.keys(Be).length&&h(nt=>({...nt,...Be}));const ct=Object.values(Be).reduce((nt,Tt)=>Math.max(nt,Tt.y),Qe),We=Math.max(k.y+k.height+pt,ct+Rt+pt);ce(Math.max(400,Math.ceil(We)))},[je,k,g,d]);const Ke=S.useCallback(()=>{if(!k||!je)return[];const lt=u();return lt?je.blocks.map(pt=>{const Rt=pt.coordinates;let Mt,Qe,Re,Be;Mt=k.x+Rt.x*(k.scale??k.scaleX),Qe=k.y+Rt.y*(k.scale??k.scaleY),Re=Rt.width*(k.scale??k.scaleX),Be=Rt.height*(k.scale??k.scaleY);const ct=g[pt.id];return c.jsxs(lt.Group,{children:[c.jsx(lt.Rect,{x:Mt,y:Qe,width:Re,height:Be,fill:ct?"rgba(40, 167, 69, 0.4)":A===pt.id?"rgba(0, 123, 255, 0.25)":"rgba(0, 123, 255, 0.15)",stroke:ct?"#28a745":A===pt.id?"#0056b3":"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:ct?"rgba(40, 167, 69, 0.3)":"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),ct&&c.jsx(lt.KonvaText,{x:Mt+5,y:Qe+Be/2-10,width:Re-10,height:20,text:je.words.find(We=>We.id===ct)?.word||"",fontSize:Math.min(12,Re/8),fontFamily:"Arial",fill:"#2c3e50",align:"center",verticalAlign:"middle",listening:!1})]},pt.id)}):[]},[k,je,g,a]),Ue=S.useCallback(()=>{if(!k||!je)return[];const lt=u();return lt?(console.log(" Processing arrows:",je.arrows),je.arrows.map(pt=>{if(console.log(" Arrow data:",pt),!pt.start||!pt.end)return console.warn(" Arrow missing start/end coordinates:",pt),null;let Rt,Mt,Qe,Re;if(pt.rel_start_x!==null&&pt.rel_start_y!==null&&pt.rel_end_x!==null&&pt.rel_end_y!==null&&pt.image_width&&pt.image_height&&pt.image_width>0&&pt.image_height>0){const Be=pt.image_width,ct=pt.image_height,We=k.width/Be,nt=k.height/ct;Rt=k.x+Number(pt.rel_start_x)/100*Be*We,Mt=k.y+Number(pt.rel_start_y)/100*ct*nt,Qe=k.x+Number(pt.rel_end_x)/100*Be*We,Re=k.y+Number(pt.rel_end_y)/100*ct*nt}else{const Be=k.scale??k.scaleX??1,ct=Number(pt.start.x),We=Number(pt.start.y),nt=Number(pt.end.x),Tt=Number(pt.end.y);ct<=k.width+1&&nt<=k.width+1&&We<=k.height+1&&Tt<=k.height+1?(Rt=k.x+(isNaN(ct)?0:ct),Mt=k.y+(isNaN(We)?0:We),Qe=k.x+(isNaN(nt)?0:nt),Re=k.y+(isNaN(Tt)?0:Tt)):(Rt=k.x+(isNaN(ct)?0:ct)*Be,Mt=k.y+(isNaN(We)?0:We)*Be,Qe=k.x+(isNaN(nt)?0:nt)*Be,Re=k.y+(isNaN(Tt)?0:Tt)*Be)}return c.jsx(lt.Arrow,{points:[Rt,Mt,Qe,Re],stroke:pt.style?.color||"#dc3545",fill:pt.style?.color||"#dc3545",strokeWidth:pt.style?.thickness||3,pointerLength:10,pointerWidth:10},pt.id)}).filter(Boolean)):[]},[k,je,a]),It=S.useCallback(()=>{if(!je)return[];const lt=u();return lt?je.words.map(pt=>{const Rt=d[pt.id]||{x:0,y:0},Mt=typeof pt.word=="string"?pt.word:"",Qe=Math.max(60,Mt.length*8+20);return Object.values(g).includes(pt.id)?null:c.jsxs(lt.Group,{x:Rt.x,y:Rt.y,draggable:!0,onDragEnd:Be=>rt(Be,pt.id),children:[c.jsx(lt.Rect,{width:Qe,height:34,fill:"#ffffff",stroke:"#ced4da",strokeWidth:1,cornerRadius:4,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5,shadowOffset:{x:0,y:2},shadowOpacity:.3,listening:!0}),c.jsx(lt.KonvaText,{text:Mt,fontSize:14,fontFamily:"Arial",fill:"#343a40",padding:8,align:"center",verticalAlign:"middle",width:Qe,height:34,listening:!1})]},pt.id)}):[]},[je,d,g,k,a]),rt=S.useCallback((lt,pt)=>{const Rt=lt.target.x(),Mt=lt.target.y();if(h(jt=>({...jt,[pt]:{x:Rt,y:Mt}})),!k||!je)return;const Qe=je.words.find(jt=>jt.id===pt);if(!Qe)return;const Re=typeof Qe.word=="string"?Qe.word:"",Be=Math.max(60,Re.length*8+20),ct={x:Rt,y:Mt,width:Be,height:34},We=k.scale??k.scaleX??1,nt=(jt,Vt)=>!(Vt.x>jt.x+jt.width||Vt.x+Vt.width<jt.x||Vt.y>jt.y+jt.height||Vt.y+Vt.height<jt.y),Tt=je.blocks.find(jt=>{const Vt=jt.coordinates,fr={x:k.x+Vt.x*We,y:k.y+Vt.y*We,width:Vt.width*We,height:Vt.height*We};return nt(ct,fr)});if(Tt){p(or=>({...or,[Tt.id]:pt}));const jt=Tt.coordinates,Vt=k.x+jt.x*We,fr=k.y+jt.y*We,Dr=jt.width*We,zr=jt.height*We;h(or=>({...or,[pt]:{x:Vt+(Dr-Be)/2,y:fr+(zr-34)/2}})),H(`Word "${Qe.word}" placed in block`,"success")}},[k,je,H]),wt=S.useCallback(()=>{if(!je)return 0;const lt=je.words.length,pt=Object.keys(g).length;return lt>0?pt/lt*100:0},[je,g]);S.useEffect(()=>{const lt=wt();v(lt)},[wt]),S.useEffect(()=>{if(e&&!R){const lt=new Date;U(lt),console.log(" Test timer started at:",lt.toISOString()),W(),console.log(" Anti-cheating tracking started")}},[e,R,W]);const xt=S.useCallback(async()=>{if(je){C(!0);try{const lt=je.words.length;let pt=0;console.log(" Scoring check - placedWords:",g),console.log(" Scoring check - blocks:",je.blocks.map(nr=>({id:nr.id,word:nr.word}))),console.log(" Scoring check - words:",je.words.map(nr=>({id:nr.id,word:nr.word}))),je.blocks.forEach(nr=>{const me=g[nr.id];if(console.log(` Block ${nr.id} (expects "${nr.word}") has placed word ID: ${me}`),me){const Ae=je.words.find(Fe=>Fe.id===me);console.log(" Placed word:",Ae),Ae&&Ae.word===nr.word?(pt++,console.log(` Correct! Block ${nr.id} has correct word "${Ae.word}"`)):console.log(` Incorrect! Block ${nr.id} expected "${nr.word}" but got "${Ae?.word||"nothing"}"`)}else console.log(` Block ${nr.id} has no word placed`)});const Rt=pt,Mt=lt;console.log(` Final Score: ${Rt}/${Mt} (${Math.round(Rt/Mt*100)}%)`);const Qe=new Date,Re=R?Math.round((Qe-R)/1e3):0,Be=R?R.toISOString():Qe.toISOString();console.log(" Test timing:",{startedAt:Be,endTime:Qe.toISOString(),timeTaken:`${Re} seconds`});const ct=B();console.log(" Anti-cheating data for submission:",ct);const We=V.student_id,nt=`retest_assignment_id_${We}_matching_type_${e.id}`,Tt=localStorage.getItem(nt),{academicCalendarService:jt}=await Gi(async()=>{const{academicCalendarService:nr}=await Promise.resolve().then(()=>n2);return{academicCalendarService:nr}},void 0);await jt.loadAcademicCalendar();const fr=jt.getCurrentTerm()?.id;if(!fr)throw new Error("No current academic period found");const Dr={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:We,academic_period_id:fr,answers:g,score:Rt,maxScore:Mt,time_taken:Re,started_at:Be,submitted_at:Qe.toISOString(),caught_cheating:ct.caught_cheating,visibility_change_times:ct.visibility_change_times,retest_assignment_id:Tt?Number(Tt):null,parent_test_id:e.id};console.log(" Submitting test data:",Dr);const or=await(await M("/.netlify/functions/submit-matching-type-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Dr)})).json();if(console.log(" Submission response:",or),or.success){if(H("Test submitted successfully!","success"),I(),q(),V?.student_id&&Dm(V.student_id,"matching_type",e.id),V?.student_id){const me=`test_completed_${V.student_id}_matching_type_${e.id}`;localStorage.setItem(me,"true"),console.log(" Test marked as completed in localStorage:",me)}if(V?.student_id){const{setCachedData:me,CACHE_TTL:Ae}=await Gi(async()=>{const{setCachedData:Me,CACHE_TTL:kt}=await Promise.resolve().then(()=>Hg);return{setCachedData:Me,CACHE_TTL:kt}},void 0),Fe=`student_results_table_${V.student_id}`;me(Fe,or,Ae.student_results_table),console.log(" Test results cached with key:",Fe)}const nr=`retest1_${We}_matching_type_${e.id}`;localStorage.removeItem(nr),localStorage.removeItem(nt),t&&t(Rt)}else throw new Error(or.message||"Failed to submit test")}catch(lt){console.error(" Error submitting test:",lt),H(`Error submitting test: ${lt.message}`,"error")}finally{C(!1)}}},[je,g,e,V,R,M,H,t]);return!e||!je?c.jsx(Ur,{}):c.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:c.jsxs("div",{className:"max-w-6xl mx-auto",children:[c.jsx("div",{className:"flex justify-end mb-2",children:c.jsx(Je,{onClick:ge,variant:"outline",size:"sm",children:"Back to Cabinet"})}),c.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("div",{children:c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e.test_name})}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-sm text-gray-500",children:"Progress"}),c.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(x),"%"]})]})]}),c.jsx("div",{className:"mt-4 w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${x}%`}})})]}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:c.jsx("div",{className:"lg:col-span-3",children:c.jsxs(At,{className:"p-4",children:[c.jsx("div",{className:"mb-4 text-center",children:c.jsx(Je,{onClick:ke,variant:"secondary",children:"Reset"})}),c.jsx("div",{ref:J,className:"w-full bg-gray-100 rounded-lg overflow-hidden",style:{height:`${le}px`},children:k&&a?(()=>{const{Stage:lt,Layer:pt,KonvaImage:Rt}=u();return c.jsxs(lt,{ref:se,width:J.current?.clientWidth||800,height:le,children:[c.jsxs(pt,{children:[c.jsx(Rt,{ref:X,image:k.image,x:k.x,y:k.y,width:k.width,height:k.height,listening:!1}),Ke(),Ue()]}),c.jsx(pt,{listening:!0,children:It()})]})})():k?c.jsxs("div",{className:"flex items-center justify-center h-full",children:[c.jsx(Ur,{size:"lg"}),c.jsx("span",{className:"ml-2 text-gray-600",children:"Loading Konva canvas..."})]}):null}),c.jsx("div",{className:"mt-4 text-center",children:c.jsx(Je,{onClick:()=>L(!0),disabled:w||x<100,children:w?"Submitting...":"Submit Test"})})]})})}),c.jsx(da,{isOpen:Y,onClose:()=>Z(!1),title:"Reset Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and placed words."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Je,{onClick:()=>Z(!1),variant:"secondary",children:"Cancel"}),c.jsx(Je,{onClick:re,variant:"primary",children:"Reset"})]})]})}),c.jsx(da,{isOpen:ae,onClose:()=>ee(!1),title:"Exit Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet? Your progress will be saved but you will exit the test."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Je,{onClick:()=>ee(!1),variant:"secondary",children:"Cancel"}),c.jsx(Je,{onClick:Ne,variant:"primary",children:"Go Back"})]})]})}),c.jsx(da,{isOpen:ne,onClose:()=>L(!1),title:"Submit Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Je,{onClick:()=>L(!1),variant:"secondary",children:"Cancel"}),c.jsx(Je,{onClick:()=>{L(!1),xt()},variant:"primary",children:"Submit"})]})]})})]})})},Qse=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=Qn(),{makeAuthenticatedRequest:o}=Wo(),{showNotification:l}=Da(),[u,d]=S.useState([{leftWord:"",rightWord:""},{leftWord:"",rightWord:""},{leftWord:"",rightWord:""}]),[h,g]=S.useState("drag"),[p,x]=S.useState(!1),[v,w]=S.useState(null),C=S.useCallback(()=>{d(F=>[...F,{leftWord:"",rightWord:""}])},[]),k=S.useCallback(F=>{u.length>1&&d(A=>A.filter((j,R)=>R!==F))},[u.length]),_=S.useCallback((F,A)=>{d(j=>j.map((R,U)=>U===F?{...R,leftWord:A}:R))},[]),N=S.useCallback((F,A)=>{d(j=>j.map((R,U)=>U===F?{...R,rightWord:A}:R))},[]),E=S.useCallback(()=>u.every(F=>F.leftWord.trim()&&F.rightWord.trim()),[u]),P=S.useCallback(async()=>{if(!E()){l("Please fill in all word pairs","error");return}x(!0),w(null);try{const F=u.map((j,R)=>({question_id:R+1,left_word:j.leftWord.trim(),right_word:j.rightWord.trim()})),A={test_name:e,num_questions:F.length,interaction_type:h,questions:F};console.log(" Saving word matching test:",A),t({testName:e,numQuestions:F.length,interactionType:h,wordPairs:u,questions:F})}catch(F){console.error("Error saving word matching test:",F),w(F.message),l("Failed to save test: "+F.message,"error")}finally{x(!1)}},[e,u,h,E,o,l,t]);return c.jsxs(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-6xl mx-auto p-0",children:[c.jsx(At,{className:"mb-6",children:c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Choose Interaction Type"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${h==="drag"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>g("drag"),children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx("input",{type:"radio",checked:h==="drag",onChange:()=>g("drag"),className:"mr-3"}),c.jsx("h4",{className:"font-medium",children:"Drag & Drop"})]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Students drag words from left list to right list"}),c.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" Easier for younger students",c.jsx("br",{})," Visual feedback on placement",c.jsx("br",{})," Mobile-friendly"]})]}),c.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${h==="arrow"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>g("arrow"),children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx("input",{type:"radio",checked:h==="arrow",onChange:()=>g("arrow"),className:"mr-3"}),c.jsx("h4",{className:"font-medium",children:"Draw Arrows"})]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Students draw arrows connecting matching words"}),c.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" More challenging",c.jsx("br",{})," Better for visual learners",c.jsx("br",{})," Requires precision"]})]})]})]})}),c.jsx(At,{className:"mb-6",children:c.jsxs("div",{className:"word-pairs-section",children:[c.jsxs("div",{className:"pairs-header flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Word Pairs"}),c.jsx(Je,{onClick:C,size:"sm",children:"+ Add Pair"})]}),c.jsx("div",{className:"pairs-list space-y-3 p-0 md:p-4",children:u.map((F,A)=>c.jsxs("div",{className:"word-pair-row flex items-center space-x-2 md:space-x-4 p-2 md:p-4 bg-gray-50 rounded-lg border",children:[c.jsx("div",{className:"pair-number flex-shrink-0",children:c.jsx("span",{className:"number-badge w-6 h-6 md:w-8 md:h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs md:text-sm font-semibold",children:A+1})}),c.jsx("div",{className:"left-word flex-1",children:c.jsx("input",{type:"text",value:F.leftWord,onChange:j=>_(A,j.target.value),placeholder:"Left word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),c.jsx("div",{className:"pair-arrow flex-shrink-0 text-gray-500 text-lg md:text-xl",children:""}),c.jsx("div",{className:"right-word flex-1",children:c.jsx("input",{type:"text",value:F.rightWord,onChange:j=>N(A,j.target.value),placeholder:"Right word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),c.jsx("div",{className:"pair-actions flex-shrink-0",children:c.jsx(Je,{onClick:()=>k(A),variant:"outline",size:"sm",className:"remove-btn w-6 h-6 md:w-8 md:h-8 p-0 text-red-500 hover:bg-red-50",disabled:u.length<=1,children:""})})]},A))})]})}),c.jsx(At,{className:"mb-6",children:c.jsxs("div",{className:"preview-section",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Preview"}),c.jsx("div",{className:"preview-pairs space-y-2",children:u.map((F,A)=>c.jsxs("div",{className:"preview-pair flex items-center space-x-2 text-sm",children:[c.jsxs("span",{className:"preview-number font-semibold text-blue-600",children:[A+1,"."]}),c.jsx("span",{className:"preview-left px-2 py-1 bg-white rounded border",children:F.leftWord||"Left word"}),c.jsx("span",{className:"preview-arrow text-gray-500",children:""}),c.jsx("span",{className:"preview-right px-2 py-1 bg-white rounded border",children:F.rightWord||"Right word"})]},A))})]})}),c.jsxs("div",{className:"flex justify-center space-x-4",children:[c.jsx(Je,{onClick:P,disabled:!E()||p,className:"px-8",children:p?c.jsxs(c.Fragment,{children:[c.jsx(Ur,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test"}),c.jsx(Je,{onClick:r,variant:"secondary",children:"Cancel"})]}),v&&c.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-red-600",children:v})})]})},Zse=(e,t)=>{const[r,n,s]=EB(`test_progress_${e}_${t}`,{}),[a,i]=S.useState(!1),[o,l]=S.useState(0),[u,d]=S.useState(0),[h,g]=S.useState(!1),[p,x]=S.useState(null),v=S.useRef(null),w=S.useRef(null),C=S.useCallback((M,V)=>{if(!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}n(W=>({...W,[M]:V})),console.log(`Saved progress for question ${M}:`,V)},[n]),k=S.useCallback(M=>!window.tokenManager||!window.tokenManager.isAuthenticated()?(console.warn("[WARN] Cannot get progress: No valid JWT token"),null):r[M]||null,[r]),_=S.useCallback(()=>{if(console.log(`[DEBUG] clearTestProgress called with testType: ${e}, testId: ${t}`),!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const M=`test_progress_${e}_${t}`;console.log(`[DEBUG] Removing localStorage key: ${M}`);const V=Object.keys(r).length>0;s(),console.log(V?`[DEBUG] Progress cleared for test ${e}_${t}`:`[DEBUG] No progress found to clear for test ${e}_${t}`)},[s,e,t,r]),N=S.useCallback(()=>{v.current&&(N(v.current),v.current=null),w.current&&(N(w.current),w.current=null)},[]),E=S.useCallback(()=>{console.log(`[DEBUG] setupProgressTrackingForPage called with testType: ${e}, testId: ${t}`),w.current=setInterval(()=>{console.log("[DEBUG] Auto-saving progress..."),R()},3e4),console.log("[DEBUG] Progress tracking interval set up (30 seconds)")},[e,t]),P=S.useCallback(()=>{console.log(`[DEBUG] updateProgressDisplayForPage called with testType: ${e}, testId: ${t}`);const M=j(),V=u>0?Math.round(M/u*100):0;return console.log(`[DEBUG] Progress: ${M}/${u} questions answered`),console.log(`[DEBUG] Progress bar updated: ${V}%`),{answeredQuestions:M,totalQuestions:u,percentage:V}},[e,t,u]),F=S.useCallback(()=>{console.log("[DEBUG] updateSubmitButtonStateForPage called");const M=j();console.log(`[DEBUG] Submit button state check: ${M}/${u} questions answered`);const V=M===u&&u>0;return console.log(V?"[DEBUG] Submit button enabled - all questions answered":"[DEBUG] Submit button disabled - not all questions answered"),V},[u]),A=S.useCallback(()=>{console.log(`[DEBUG] loadSavedProgressForPage called with testType: ${e}, testId: ${t}`);try{if(console.log("[DEBUG] Loaded progress from localStorage:",r),Object.keys(r).length===0){console.log("[DEBUG] No saved progress found");return}const M=Object.keys(r).length;l(M),console.log(`[DEBUG] Restored ${M} answered questions`)}catch(M){console.error("[ERROR] Failed to load saved progress:",M),x(M.message)}},[e,t,r]),j=S.useCallback(()=>{console.log(`[DEBUG] getAnsweredQuestionsCountForPage called with testType: ${e}`);const M=Object.keys(r).length;return l(M),console.log(`[DEBUG] Found ${M} answered questions`),M},[e,r]),R=S.useCallback(()=>{console.log(`[DEBUG] saveProgressForPage called with testType: ${e}, testId: ${t}`);try{console.log("[DEBUG] Progress saved:",r)}catch(M){console.error("[ERROR] Failed to save progress:",M),x(M.message)}},[e,t,r]),U=S.useCallback(()=>{try{const M=`test_completed_${e}_${t}`,V=localStorage.getItem(M)==="true";return i(V),V}catch(M){return console.error("Error checking test completion:",M),!1}},[e,t]),Y=S.useCallback(()=>{try{const M=`test_completed_${e}_${t}`;localStorage.setItem(M,"true"),i(!0),console.log(`Test ${e}_${t} marked as completed`)}catch(M){console.error("Error marking test completed:",M)}},[e,t]),Z=S.useCallback(()=>{console.log("Marking test completed in UI:",{testType:e,testId:t}),Y()},[e,t,Y]),ae=S.useCallback(M=>{try{const V=`test_creation_state_${e}_${t}`;localStorage.setItem(V,JSON.stringify(M)),console.log("Test creation state saved:",M)}catch(V){console.error("Error saving test creation state:",V)}},[e,t]),ee=S.useCallback(()=>{try{const M=`test_creation_state_${e}_${t}`;localStorage.removeItem(M),console.log("Test creation state cleared")}catch(M){console.error("Error clearing test creation state:",M)}},[e,t]),ne=S.useCallback((M,V)=>{try{const W=`test_step_${e}_${t}_${M}`;localStorage.setItem(W,JSON.stringify(V)),console.log(`Step ${M} data saved:`,V)}catch(W){console.error(`Error saving step ${M} data:`,W)}},[e,t]),L=S.useCallback(M=>{try{const V=`test_step_${e}_${t}_${M}`,W=localStorage.getItem(V);return W?JSON.parse(W):null}catch(V){return console.error(`Error restoring step ${M} data:`,V),null}},[e,t]),H=S.useCallback(()=>{try{const M=`test_creation_state_${e}_${t}`,V=localStorage.getItem(M);return V?JSON.parse(V):null}catch(M){return console.error("Error restoring test creation state:",M),null}},[e,t]);return S.useEffect(()=>()=>{N()},[e,t,E,A,N]),S.useEffect(()=>{j()},[r,j]),{progress:r,isCompleted:a,answeredCount:o,totalQuestions:u,isLoading:h,error:p,saveProgress:C,getProgress:k,clearProgress:_,clearInterval:N,setupProgressTracking:E,updateProgress:P,updateSubmitButton:F,loadProgress:A,getAnsweredCount:j,saveProgressForPage:R,checkCompleted:U,markCompleted:Y,markCompletedUI:Z,saveState:ae,clearState:ee,saveStepData:ne,restoreStepData:L,restoreState:H,setTotalQuestions:d,setError:x}},eae=({testData:e,onTestComplete:t,onBackToCabinet:r})=>{const{user:n}=Qn(),{makeAuthenticatedRequest:s}=Wo(),[a,i]=S.useState({width:window.innerWidth,height:window.innerHeight});S.useEffect(()=>{const Qe=()=>{i({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",Qe),()=>window.removeEventListener("resize",Qe)},[]);const{getCheatingData:o,stopTracking:l,clearData:u}=qm(),[d,h]=S.useState(null),[g,p]=S.useState({}),[x,v]=S.useState(null),w=S.useRef(null),[C,k]=S.useState(800),_={VERY_SMALL:400,MOBILE:600,TABLET:900},N={VERY_SMALL:.6,MOBILE:.8,TABLET:.9,DESKTOP:1},E={CANVAS_HEIGHT:400,BLOCK_WIDTH:140,BLOCK_HEIGHT:50,BLOCK_SPACING:80,MARGIN:50},P=a.width<_.VERY_SMALL,F=a.width>=_.VERY_SMALL&&a.width<_.MOBILE,A=a.width>=_.MOBILE&&a.width<_.TABLET;a.width>=_.TABLET;const j=P?N.VERY_SMALL:F?N.MOBILE:A?N.TABLET:N.DESKTOP;S.useEffect(()=>{const Qe=()=>{if(w.current){const Be=w.current.clientWidth;console.log(" Container width detected:",Be),Be>0&&k(Be)}};Qe();const Re=[setTimeout(Qe,50),setTimeout(Qe,100),setTimeout(Qe,200),setTimeout(Qe,500)];return window.addEventListener("resize",Qe),()=>{Re.forEach(Be=>clearTimeout(Be)),window.removeEventListener("resize",Qe)}},[d]);const R=E.BLOCK_WIDTH*j,U=E.BLOCK_HEIGHT*j,Y=E.BLOCK_SPACING*j,Z=E.MARGIN*j,ae=Z;console.log(" Mobile Debug:",{screenWidth:a.width,containerWidth:w.current?.clientWidth,canvasWidth:C,scale:j,blockWidth:R,margin:Z,leftBlockX:ae,displayDataLoaded:!!d});const ee=ae+R+20+R+Z,ne=ee<=C;let L,H=R,M=U;if(ne)L=Math.min(Math.max(ae+R+20,C-R-Z),C-R-Z);else{const Qe=C-Z*2,Re=Math.floor((Qe-20)/2);H=Math.max(60,Re),M=Math.max(30,M*(H/R)),L=ae+H+20,console.log(" Very small screen - adjusted block size:",{availableWidth:Qe,maxBlockWidth:Re,actualBlockWidth:H,actualBlockHeight:M})}console.log(" Right Block Position:",{rightBlockX:L,rightBlockRightEdge:L+H,canvasWidth:C,fits:L+H<=C,canFitSideBySide:ne,minRequiredWidth:ee});const V=Z,W={DRAGGED_WORD:Math.max(8,14*j),ORIGINAL_WORD:Math.max(10,16*j),LEFT_WORD:Math.max(10,14*j)},I=Math.max(1,3*j),B=S.useCallback((Qe,Re,Be)=>{if(!Qe)return M;const ct=Re*.55,We=Math.floor(Be/ct),nt=Math.ceil(Qe.length/We),Tt=Re*1.1,jt=12*j,Vt=nt*Tt+jt,fr=Math.max(M*.8,30*j);return Math.max(fr,Vt)},[M,j]),J=S.useCallback(()=>{if(!d?.leftWords||!d?.rightWords)return E.CANVAS_HEIGHT*j;let Qe=Z*2;for(let Be=0;Be<d.leftWords.length;Be++){const ct=d.leftWords[Be],We=d.rightWords[Be],nt=B(ct,W.LEFT_WORD,H),Tt=B(We,W.ORIGINAL_WORD,H),jt=Math.max(nt,Tt);Qe+=jt,Be<d.leftWords.length-1&&(Qe+=20*j)}const Re=E.CANVAS_HEIGHT*j;return Math.max(Re,Qe)},[d,B,W,H,Z,j])();S.useCallback((Qe,Re)=>{if(!Qe||!Re)return Y;const Be=Qe.map((nt,Tt)=>{const jt=Re[Tt],Vt=B(nt,W.LEFT_WORD,H),fr=B(jt,W.ORIGINAL_WORD,H);return Math.max(Vt,fr)}),ct=Math.max(...Be),We=20*j;return ct+We},[Y,B,W,H,j]);const X=S.useCallback(()=>{if(!d?.leftWords||!d?.rightWords)return[];const Qe=[];let Re=Z;for(let Be=0;Be<d.leftWords.length;Be++){const ct=d.leftWords[Be],We=d.rightWords[Be],nt=B(ct,W.LEFT_WORD,H),Tt=B(We,W.ORIGINAL_WORD,H),jt=Math.max(nt,Tt);Qe.push({y:Re,leftHeight:nt,rightHeight:Tt,rowHeight:jt}),Re+=jt+20*j}return Qe},[d,B,W,H,Z,j])(),[ie,le]=S.useState([]),[ce,ke]=S.useState(!1),[re,ge]=S.useState(!1),[Ne,je]=S.useState(null),[Ke,Ue]=S.useState(!1),[It,rt]=S.useState(!1);S.useEffect(()=>{if(e){if(console.log(" WordMatchingStudent: Initializing test data:",e),console.log(" Interaction type:",e.interaction_type),console.log(" Left words:",e.leftWords),console.log(" Right words:",e.rightWords),console.log(" Correct pairs:",e.correctPairs),!Array.isArray(e.leftWords)||!Array.isArray(e.rightWords)){console.error(" Invalid data structure - leftWords or rightWords not arrays:",{leftWords:e.leftWords,rightWords:e.rightWords});return}if(h(e),je(new Date),n?.student_id){const Qe=`test_progress_${n.student_id}_word_matching_${e.id}`,Re=Es(Qe);Re&&(p(Re.answers||{}),le(Re.arrows||[]),je(new Date(Re.startTime)),console.log(" Test progress restored:",Re))}}},[e,n?.student_id]),S.useEffect(()=>{if(d&&Ne&&n?.student_id){const Qe=setInterval(()=>{const Re={answers:g,arrows:ie,startTime:Ne.toISOString()},Be=`test_progress_${n.student_id}_word_matching_${e.id}`;us(Be,Re,Ts.test_progress),console.log(" Progress auto-saved")},3e4);return()=>clearInterval(Qe)}},[d,g,ie,Ne,n?.student_id,e?.id]);const wt=S.useCallback((Qe,Re)=>{if(console.log(" handleWordClick called:",{side:Qe,index:Re,interactionType:e?.interaction_type,selectedWord:x}),e?.interaction_type!=="arrow"){console.log(" Not arrow mode, ignoring click");return}if(x){if(x.side===Qe&&x.index===Re)console.log(" Deselecting word"),v(null);else if(x.side!==Qe){console.log(" Creating arrow connection:",{startWord:x,endWord:{side:Qe,index:Re}});const Be={id:Date.now().toString(),startWord:x,endWord:{side:Qe,index:Re},color:"#3B82F6"};le(ct=>{const We=[...ct,Be];return console.log(" Updated arrows:",We),We}),p(ct=>{const We={...ct,[x.index]:Re};return console.log(" Updated answers:",We),We}),v(null)}}else console.log(" Selecting word:",{side:Qe,index:Re}),v({side:Qe,index:Re})},[x,e?.interaction_type]);S.useCallback((Qe,Re)=>{e.interaction_type==="drag"&&p(Be=>({...Be,[Qe]:Re}))},[e?.interaction_type]);const xt=S.useCallback(()=>{Ue(!0)},[]),lt=S.useCallback(()=>{p({}),le([]),v(null),Ue(!1)},[]),pt=S.useCallback(()=>{rt(!0)},[]),Rt=S.useCallback(()=>{rt(!1),r&&r()},[r]),Mt=S.useCallback(async()=>{if(d){ke(!0);try{const Qe=d?.leftWords?.length||0;let Re=0,Be={};e.interaction_type==="drag"?Object.entries(g).forEach(([kt,Oe])=>{const at=d?.correctPairs?.[kt];Oe===at&&Re++,Be[kt]=Oe}):ie.forEach(kt=>{const Oe=kt.startWord.side==="left"?kt.startWord.index:kt.endWord.index,at=kt.startWord.side==="right"?kt.startWord.index:kt.endWord.index;d?.correctPairs?.[Oe]===at&&Re++,Be[Oe]=at});const ct=Re,We=Qe;console.log(` Final Score: ${ct}/${We} (${Math.round(ct/We*100)}%)`);const nt=new Date,Tt=Ne?Math.round((nt-Ne)/1e3):0,jt=Ne?Ne.toISOString():nt.toISOString(),Vt=o(),fr=n.student_id,Dr=`retest_assignment_id_${fr}_word_matching_${e.id}`,zr=localStorage.getItem(Dr),{academicCalendarService:or}=await Gi(async()=>{const{academicCalendarService:kt}=await Promise.resolve().then(()=>n2);return{academicCalendarService:kt}},void 0);await or.loadAcademicCalendar();const me=or.getCurrentTerm()?.id;if(!me)throw new Error("No current academic period found");const Ae={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:fr,academic_period_id:me,parent_test_id:e.id,retest_assignment_id:zr?Number(zr):null,interaction_type:e.interaction_type,answers:Be,score:ct,maxScore:We,time_taken:Tt,started_at:jt,submitted_at:nt.toISOString(),caught_cheating:Vt.caught_cheating,visibility_change_times:Vt.visibility_change_times};console.log(" Submission data being sent:",Ae),console.log(" TestData structure:",e),console.log(" Submitting test results...");const Fe=await s("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ae)});console.log(" Submission response received:",Fe.status);const Me=await Fe.json();if(Me.success){if(l(),u(),n?.student_id){const kt=`test_completed_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(kt,"true"),console.log(" Test marked as completed in localStorage:",kt);const Oe=`retest1_${fr}_word_matching_${e.id}`;localStorage.removeItem(Oe),localStorage.removeItem(Dr),Dm(n.student_id,"word_matching",e.id),console.log(" Test data cleared from cache");const at=`student_results_table_${n.student_id}`;us(at,Me,Ts.student_results_table),console.log(" Test results cached with key:",at)}t&&t(ct),ke(!1)}else throw new Error(Me.message||"Failed to submit test")}catch(Qe){console.error("Error submitting test:",Qe),ke(!1)}}},[d,g,ie,e,n,Ne,o,l,u,s,t]);return d?c.jsxs(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-4xl mx-auto p-6",children:[c.jsx(da,{isOpen:ce,onClose:()=>{},title:"Submitting",size:"small",children:c.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[c.jsx(Ur,{size:"lg",className:"mb-3"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Submitting test..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your results"})]})}),c.jsx("div",{className:"flex justify-end mb-2",children:c.jsx(Je,{onClick:pt,variant:"outline",size:"sm",disabled:ce,children:"Back to Cabinet"})}),c.jsx(At,{className:"mb-6",children:c.jsxs("div",{className:"text-left",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:e.test_name}),c.jsx("p",{className:"text-gray-600",children:e.interaction_type==="drag"?"Drag words from left to right to match them":"Click on the word or phrase on the left, then click on the matching word or phrase on the right to connect them"})]})}),e.interaction_type==="drag"?c.jsx(At,{className:"mb-6",children:c.jsx("div",{ref:w,className:"relative w-full",children:c.jsx(Jh,{width:C,height:J,className:`border-2 border-gray-200 rounded-lg ${ce?"pointer-events-none opacity-50":""}`,children:c.jsxs(Xh,{children:[d.leftWords.map((Qe,Re)=>{const Be=g[Re]!==void 0,ct=B(Qe,W.LEFT_WORD,H),We=X[Re],nt=We?We.y:V+Re*Y;return c.jsxs(Zl,{x:ae,y:nt,draggable:!Be,onDragStart:Tt=>{Tt.target.moveToTop()},onDragEnd:Tt=>{Tt.target.getStage();const jt=d.rightWords,Vt=H+60,fr=M+30,Dr=L-30,zr=V-15;console.log(" Drop detection - Word dropped at:",Tt.target.x(),Tt.target.y());for(let or=0;or<jt.length;or++){const nr=X[or],me=nr?nr.y:zr+or*Y,Ae=Dr,Fe=Dr+Vt,Me=me,kt=me+fr;if(console.log(` Checking drop zone ${or}:`,{left:Ae,right:Fe,top:Me,bottom:kt,word:jt[or]}),Tt.target.x()>=Ae&&Tt.target.x()<=Fe&&Tt.target.y()>=Me&&Tt.target.y()<=kt){console.log(` Match found! Word "${d.leftWords[Re]}" matched with "${jt[or]}"`),p(Oe=>({...Oe,[Re]:or}));break}}console.log(" No match found, resetting position"),Tt.target.position({x:ae,y:nt})},children:[c.jsx(Pa,{width:H,height:ct,fill:Be?"#e5e7eb":"#3b82f6",stroke:Be?"#9ca3af":"#1d4ed8",strokeWidth:2,cornerRadius:8,opacity:Be?.5:1}),c.jsx(Bc,{text:Qe,x:H/2,y:ct/2,fontSize:W.LEFT_WORD,fontFamily:"Arial",fill:Be?"#dc2626":"white",align:"center",verticalAlign:"middle",width:H,offsetX:H/2,offsetY:ct/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${Re}`)}),d.rightWords.map((Qe,Re)=>{const Be=B(Qe,W.ORIGINAL_WORD,H),ct=X[Re],We=ct?ct.y:V+Re*Y,nt=Object.keys(g).find(Tt=>g[Tt]===Re);return c.jsxs(Zl,{x:L,y:We,children:[c.jsx(Pa,{width:H,height:Be,fill:nt?"#10b981":"#f3f4f6",stroke:nt?"#059669":"#d1d5db",strokeWidth:2,cornerRadius:8}),c.jsx(Bc,{text:Qe,x:H/2,y:Be/2,fontSize:W.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:H,offsetX:H/2,offsetY:Be/2,wrap:"word",ellipsis:!0,listening:!1}),nt&&c.jsx(Bc,{text:d.leftWords[nt],x:H/2,y:Be/4,fontSize:W.DRAGGED_WORD,fontFamily:"Arial",fill:"#dc2626",align:"center",verticalAlign:"middle",width:H,offsetX:H/2,offsetY:Be/8,wrap:"word",ellipsis:!0})]},`right-${Re}`)})]})})})}):c.jsx(At,{className:"mb-6",children:c.jsx("div",{ref:w,className:"relative w-full",children:c.jsx(Jh,{width:C,height:J,className:`border-2 border-gray-200 rounded-lg ${ce?"pointer-events-none opacity-50":""}`,children:c.jsxs(Xh,{children:[d?.leftWords?.map((Qe,Re)=>{const Be=B(Qe,W.LEFT_WORD,H),ct=X[Re],We=ct?ct.y:V+Re*Y,nt=x?.side==="left"&&x?.index===Re;return c.jsxs(Zl,{x:ae,y:We,onClick:()=>wt("left",Re),children:[c.jsx(Pa,{width:H,height:Be,fill:nt?"#3b82f6":"#f3f4f6",stroke:nt?"#1d4ed8":"#d1d5db",strokeWidth:nt?3:2,cornerRadius:8}),c.jsx(Bc,{text:Qe,x:H/2,y:Be/2,fontSize:W.LEFT_WORD,fontFamily:"Arial",fill:nt?"white":"#374151",align:"center",verticalAlign:"middle",width:H,offsetX:H/2,offsetY:Be/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${Re}`)}),d?.rightWords?.map((Qe,Re)=>{const Be=B(Qe,W.ORIGINAL_WORD,H),ct=X[Re],We=ct?ct.y:V+Re*Y,nt=x?.side==="right"&&x?.index===Re;return c.jsxs(Zl,{x:L,y:We,onClick:()=>wt("right",Re),children:[c.jsx(Pa,{width:H,height:Be,fill:nt?"#3b82f6":"#f3f4f6",stroke:nt?"#1d4ed8":"#d1d5db",strokeWidth:nt?3:2,cornerRadius:8}),c.jsx(Bc,{text:Qe,x:H/2,y:Be/2,fontSize:W.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:H,offsetX:H/2,offsetY:Be/2,wrap:"word",ellipsis:!0,listening:!1})]},`right-${Re}`)}),ie.map((Qe,Re)=>{const Be=d?.leftWords?.[Qe.startWord.index],ct=d?.rightWords?.[Qe.endWord.index],We=B(Be,W.LEFT_WORD,H),nt=B(ct,W.ORIGINAL_WORD,H),Tt=X[Qe.startWord.index],jt=X[Qe.endWord.index],Vt=Tt?Tt.y+We/2:V+Qe.startWord.index*Y+We/2,fr=jt?jt.y+nt/2:V+Qe.endWord.index*Y+nt/2;return c.jsx(Ja,{points:[ae+H+20,Vt,L-20,fr],stroke:Qe.color||"#3b82f6",strokeWidth:I,lineCap:"round",lineJoin:"round"},Re)})]})})})}),c.jsx(At,{children:c.jsxs("div",{className:`submit-section flex justify-center space-x-4 ${ce?"pointer-events-none opacity-50":""}`,children:[c.jsx(Je,{onClick:xt,variant:"outline",disabled:ce,children:"Reset"}),c.jsx(Je,{onClick:()=>ge(!0),disabled:ce,className:"px-8",children:ce?c.jsxs(c.Fragment,{children:[c.jsx(Ur,{size:"sm",color:"white",className:"mr-2"}),"Submitting..."]}):"Submit Test"})]})}),c.jsx(da,{isOpen:Ke&&!ce,onClose:()=>Ue(!1),title:"Reset Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and answers."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Je,{onClick:()=>Ue(!1),variant:"secondary",children:"Cancel"}),c.jsx(Je,{onClick:lt,variant:"primary",children:"Reset"})]})]})}),c.jsx(da,{isOpen:It,onClose:()=>rt(!1),title:"Exit Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to leave the test? Your progress will be saved."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Je,{onClick:()=>rt(!1),variant:"secondary",children:"Cancel"}),c.jsx(Je,{onClick:Rt,variant:"primary",children:"Leave"})]})]})}),c.jsx(da,{isOpen:re,onClose:()=>ge(!1),title:"Submit Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Je,{onClick:()=>ge(!1),variant:"secondary",children:"Cancel"}),c.jsx(Je,{onClick:()=>{ge(!1),Mt()},variant:"primary",children:"Submit"})]})]})})]}):c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsx(Ur,{size:"lg"})})},tae=({id:e,x:t,y:r,width:n,height:s,text:a,fontSize:i,color:o,isSelected:l,onSelect:u,onUpdate:d,onDelete:h})=>{const[g,p]=S.useState(!1),x=S.useRef(!1),v=S.useRef(null),w=S.useRef({x:0,y:0}),C=S.useRef(null),k=5,_=()=>{x.current=!0,p(!0)},N=()=>{if(x.current=!1,p(!1),C.current)try{C.current.draggable(!1)}catch{}},E=()=>{v.current&&(clearTimeout(v.current),v.current=null)};S.useEffect(()=>()=>{E()},[]),S.useEffect(()=>{if(C.current)try{C.current.draggable(x.current)}catch{}},[g]);const P=A=>{A.cancelBubble=!0,d(e,{isEditing:!0})},F=A=>{d(e,{x:A.target.x(),y:A.target.y()})};return c.jsxs(Zl,{ref:C,x:t,y:r,draggable:g,dragBoundFunc:A=>x.current?A:{x:t,y:r},name:"textbox-group",onClick:A=>{A.cancelBubble=!0,u(e)},onTap:A=>{A.cancelBubble=!0,u(e),E()},onDblClick:P,onDblTap:P,onPointerDown:A=>{A.cancelBubble=!0;const j=A.evt||{};w.current={x:j.clientX??0,y:j.clientY??0},E(),v.current=setTimeout(()=>{_()},400)},onPointerMove:A=>{if(!v.current)return;const j=A.evt||{},R=Math.abs((j.clientX??0)-w.current.x),U=Math.abs((j.clientY??0)-w.current.y);(R>k||U>k)&&E()},onPointerUp:A=>{A.cancelBubble=!0,E(),N()},onPointerLeave:()=>{E(),N()},onDragEnd:A=>{F(A),N()},children:[c.jsx(Pa,{width:n,height:s,fill:l?"#fef3c7":"#ffffff",stroke:l?"#f59e0b":"#d1d5db",strokeWidth:l?2:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1},name:"textbox-rect",onTap:A=>{A.cancelBubble=!0,u(e),E()},onDblTap:A=>{A.cancelBubble=!0,P(A)}}),c.jsx(Bc,{text:a,width:n,height:s,padding:8,align:"left",verticalAlign:"top",fontSize:i,fill:o,wrap:"word",name:"textbox-text",onTap:A=>{A.cancelBubble=!0,u(e),E()},onDblTap:A=>{A.cancelBubble=!0,P(A)}})]})},rae=({x:e,y:t,width:r,height:n,initialText:s,onSave:a,onCancel:i})=>{const o=S.useRef(null);S.useEffect(()=>{o.current&&(o.current.focus(),o.current.select())},[]);const l=u=>{u.key==="Enter"&&!u.shiftKey?(u.preventDefault(),a(o.current.value)):u.key==="Escape"&&i()};return c.jsx("textarea",{ref:o,defaultValue:s,style:{position:"absolute",top:t,left:e,width:r,height:n,fontSize:"14px",border:"2px solid #f59e0b",borderRadius:"6px",padding:"8px",background:"white",resize:"none",outline:"none",fontFamily:"inherit",lineHeight:"1.4",zIndex:1e3},onKeyDown:l,onBlur:()=>a(o.current.value)})},nae=({width:e,height:t,lines:r,onDrawingChange:n,currentTool:s,currentColor:a,currentThickness:i,zoom:o,onZoomChange:l,isPanning:u,isFullscreen:d,constrainPanPosition:h,handleWheel:g,stageRef:p,setIsPanning:x,responsiveDimensions:v,canvasSize:w,question:C,textBoxes:k,setTextBoxes:_,selectedTextBox:N,setSelectedTextBox:E,handleTextBoxSelect:P,handleTextBoxUpdate:F,handleTextBoxDelete:A,isEditingText:j,editingTextBox:R,setIsEditingText:U,setEditingTextBox:Y,setCurrentTool:Z})=>{const[ae,ee]=S.useState(!1),[ne,L]=S.useState([]),[H,M]=S.useState(null),[V,W]=S.useState(null),I=S.useRef(null),[B,q]=S.useState(.25),[J,se]=S.useState({x:0,y:0}),X=S.useRef(null),ie=S.useRef(null),le=S.useRef(!1),ce=6;S.useEffect(()=>{const Ce=()=>{const Ve=I.current;if(!Ve)return;const Ze=Ve.clientWidth||1,Ft=Ve.clientHeight||1,zt=Math.min(Ze/(w.width||1),Ft/(w.height||1));q(Math.min(zt,1))};return Ce(),window.addEventListener("resize",Ce),()=>window.removeEventListener("resize",Ce)},[w.width,w.height,d]);const ke=Ce=>{const Ve=p.current,Ze=Ve.getPointerPosition();if(s==="pan"){if(Me(Ce.target))try{Ve.draggable(!1),le.current=!0}catch{}return}if(s==="text"){const zt={x:(Ze.x-Ve.x())/Ve.scaleX(),y:(Ze.y-Ve.y())/Ve.scaleY()};X.current={...zt},ie.current={x:Ze.x,y:Ze.y};return}ee(!0);const Ft={x:(Ze.x-Ve.x())/Ve.scaleX(),y:(Ze.y-Ve.y())/Ve.scaleY()};W(Ft),s==="pencil"?L([{x:Ft.x,y:Ft.y,color:a,thickness:i}]):s==="eraser"?L([{x:Ft.x,y:Ft.y,color:a,thickness:i,tool:"eraser"}]):["line","rectangle","circle"].includes(s)&&M({type:s,startX:Ft.x,startY:Ft.y,endX:Ft.x,endY:Ft.y,color:a,thickness:i})},re=Ce=>{const Ve=p.current,Ze=Ve.getPointerPosition(),Ft={x:(Ze.x-Ve.x())/Ve.scaleX(),y:(Ze.y-Ve.y())/Ve.scaleY()};if(se(Ft),s!=="pan"){if(s==="text"&&X.current&&ie.current){const zt=Math.abs(Ze.x-ie.current.x),er=Math.abs(Ze.y-ie.current.y);(zt>ce||er>ce)&&(X.current=null)}if(ae)if(s==="pencil"){const zt=[...ne,{x:Ft.x,y:Ft.y,color:a,thickness:i}];L(zt)}else if(s==="eraser"){const zt=[...ne,{x:Ft.x,y:Ft.y,color:a,thickness:i,tool:"eraser"}];L(zt)}else["line","rectangle","circle"].includes(s)&&H&&M({...H,endX:Ft.x,endY:Ft.y})}},ge=Ce=>{const Ve=p.current;if(s==="pan"){if(le.current){try{Ve.draggable(!0)}catch{}le.current=!1}return}if(s==="text"&&X.current){const Ze=Ce&&Ce.target;if(Ze&&typeof Ze.name=="function"&&Ze.name()==="canvas-bg"){const zt={id:Date.now(),x:X.current.x,y:X.current.y,width:150,height:60,text:"Double-click to edit",fontSize:14,color:"#000000"};_(er=>[...er,zt]),E(zt.id)}X.current=null,ie.current=null}if(ae){if(s==="pencil"){const Ze=[...r,ne];n(Ze),L([])}else if(s==="eraser"){const Ze=[...r,ne];n(Ze),L([])}else if(["line","rectangle","circle"].includes(s)&&H){const Ze=[...r,H];n(Ze),M(null)}ee(!1),W(null)}},[Ne,je]=S.useState(null),[Ke,Ue]=S.useState(null),[It,rt]=S.useState(!1),[wt,xt]=S.useState(null),[lt,pt]=S.useState(!1),[Rt,Mt]=S.useState(!1),[Qe,Re]=S.useState([]),[Be,ct]=S.useState(null),[We,nt]=S.useState({totalGestures:0,zoomGestures:0,panGestures:0,combinedGestures:0,averageResponseTime:0});let Tt=null;const Vt=(window.devicePixelRatio||1)>1.5,fr={scaleDelta:Vt?.03:.04,centerDelta:Vt?4:6,minTouchDistance:8,gestureHysteresis:.02},Dr=()=>{pt(!1),xt(null),je(null),Ue(null),ee(!1),W(null),Mt(!1),ct(null),Tt&&(cancelAnimationFrame(Tt),Tt=null),p.current&&p.current.stop()},zr=Ce=>{if(Ce.length<2)return 0;const Ve=Ce[0],Ze=Ce[1];return Math.sqrt(Math.pow(Ze.clientX-Ve.clientX,2)+Math.pow(Ze.clientY-Ve.clientY,2))},or=Ce=>{if(Ce.length<2)return null;const Ve=Ce[0],Ze=Ce[1];return{x:(Ve.clientX+Ze.clientX)/2,y:(Ve.clientY+Ze.clientY)/2}},nr=Ce=>{Re(Ve=>[...Ve,{type:Ce,timestamp:Date.now()}].slice(-5))},me=()=>{const Ce=Date.now(),Ve=Qe.filter(zt=>Ce-zt.timestamp<500);if(Ve.length<2)return 0;const Ze=Ve[Ve.length-1],Ft=Ve[Ve.length-2];return Ze.type===Ft.type?fr.gestureHysteresis:0},Ae=(Ce,Ve)=>{nt(Ze=>({totalGestures:Ze.totalGestures+1,zoomGestures:Ce.includes("zoom")?Ze.zoomGestures+1:Ze.zoomGestures,panGestures:Ce.includes("pan")?Ze.panGestures+1:Ze.panGestures,combinedGestures:Ce==="zoom+pan"?Ze.combinedGestures+1:Ze.combinedGestures,averageResponseTime:(Ze.averageResponseTime+Ve)/2}))},Fe=(Ce,Ve,Ze,Ft)=>{const zt=p.current,er=zt.scaleX(),hr=zt.position();let ir=er,Wr=hr;if(Ce){const ye=Ze/Ne,xe=er*ye,_e=C?.max_canvas_width||1536,Se=C?.max_canvas_height||2048,He=_e/w.width,it=Se/w.height,Ye=Math.min(He,it,1);ir=Math.max(.25,Math.min(Ye,xe));const oe=Ft,fe={x:(oe.x-zt.x())/er,y:(oe.y-zt.y())/er};Wr={x:oe.x-fe.x*ir,y:oe.y-fe.y*ir}}if(Ve){const ye=Ft.x-Ke.x,xe=Ft.y-Ke.y;Ce?Wr={x:Wr.x+ye,y:Wr.y+xe}:Wr={x:hr.x+ye,y:hr.y+xe}}Tt||(Tt=requestAnimationFrame(()=>{zt.scale({x:ir,y:ir}),zt.position(Wr),zt.batchDraw(),Tt=null})),Ce&&Ve?(xt("zoom+pan"),Mt(!0)):Ce?(xt("zoom"),Mt(!0)):Ve&&xt("pan");const be=Date.now()-(Be||Date.now());Ae(Ce&&Ve?"zoom+pan":Ce?"zoom":"pan",be),console.log(" Combined gesture",{doZoom:Ce,doPan:Ve,scale:ir.toFixed(2),pos:Wr})},Me=Ce=>{if(!Ce||typeof Ce.name!="function")return!1;if((Ce.name()||"").includes("textbox-"))return!0;const Ze=Ce.getParent&&Ce.getParent();return Ze&&typeof Ze.name=="function"&&(Ze.name()||"").includes("textbox-")},kt=Ce=>{const Ve=Ce.evt.touches,Ze=Ce.target;if(Me(Ze)){if(s==="pan"&&p.current)try{p.current.draggable(!1),le.current=!0}catch{}return}Ve.length===2?(Ce.evt.preventDefault(),pt(!0),xt(null),je(zr(Ve)),Ue(or(Ve)),ee(!1),ct(Date.now())):Ve.length===1&&(pt(!1),xt(null),ke(Ce))},Oe=Ce=>{const Ve=Ce.evt.touches,Ze=Ce.target;if(!Me(Ze))if(Ve.length===2&&lt){Ce.evt.preventDefault();const Ft=p.current,zt=zr(Ve),er=or(Ve);if(Ne&&Ke&&Ft&&zt>fr.minTouchDistance){const hr=Math.abs(zt/Ne-1),ir=Math.sqrt(Math.pow(er.x-Ke.x,2)+Math.pow(er.y-Ke.y,2)),Wr=me(),ue=fr.scaleDelta-Wr,be=fr.centerDelta-Wr*10,ye=hr>ue,xe=ir>be;(ye||xe)&&(Fe(ye,xe,zt,er),ye&&xe?nr("zoom+pan"):ye?nr("zoom"):xe&&nr("pan")),console.log(" Gesture Debug",{scaleDelta:hr.toFixed(3),centerDelta:ir.toFixed(1),doZoom:ye,doPan:xe,hysteresis:Wr.toFixed(3),adjustedScaleDelta:ue.toFixed(3),adjustedCenterDelta:be.toFixed(1),gestureHistory:Qe.slice(-3)})}je(zt),Ue(er)}else Ve.length===1&&!lt&&(Ce.evt.preventDefault(),re())},at=Ce=>{const Ve=Ce.evt.touches,Ze=Ce.target;Me(Ze)||(Ve.length===0?(ge(Ce),Dr(),Mt(!1)):Ve.length===1&&(pt(!1),xt(null),je(null),Ue(null),Mt(!1)))};return c.jsx("div",{className:"relative w-full block sm:flex sm:justify-center",children:c.jsx("div",{className:"w-full max-w-full block sm:flex sm:justify-center",children:c.jsxs("div",{className:"relative",style:{border:d&&(v.width<window.innerWidth-40||v.height<window.innerHeight-40)?"2px solid #000000":"none",borderRadius:"8px",overflow:"hidden"},children:[c.jsx("div",{ref:I,className:"w-full h-full",style:{touchAction:"manipulation"},children:c.jsx(Jh,{ref:p,width:v.width,height:v.height,scaleX:d?v.zoom:o,scaleY:d?v.zoom:o,onMouseDown:ke,onMousemove:re,onMouseup:ge,onTouchStart:kt,onTouchMove:Oe,onTouchEnd:at,onWheel:g||(()=>{}),onDragStart:()=>{console.log(" Drag started"),s==="pan"&&x(!0)},onDragEnd:()=>{if(console.log(" Drag ended"),s==="pan"&&(x(!1),h)){const Ce=p.current,Ve=I.current,Ze=Ve?.clientWidth||v.width,Ft=Ve?.clientHeight||v.height,zt=w.width*Ce.scaleX(),er=w.height*Ce.scaleY(),hr=Ce.x(),ir=Ce.y();(hr>Ze||hr<-zt||ir>Ft||ir<-er)&&h(Ce)}},draggable:s==="pan"&&o>.25,className:`border-0 rounded-none shadow-none sm:border sm:rounded-lg sm:shadow-sm ${s==="pan"?"cursor-grab":u?"cursor-grabbing":"cursor-crosshair"}`,style:{width:"100%",height:"auto"},onLoad:()=>{console.log(" DrawingTestStudent - Stage loaded with dimensions:",v.width,"x",v.height),console.log(" DrawingTestStudent - Canvas size:",w.width,"x",w.height),console.log(" DrawingTestStudent - Current zoom level:",o),console.log(" DrawingTestStudent - Effective display size:",Math.round(w.width*o),"x",Math.round(w.height*o)),console.log(" DrawingTestStudent - Total pixels displayed:",Math.round(w.width*o*w.height*o))},children:c.jsxs(Xh,{children:[c.jsx(Pa,{x:0,y:0,width:w.width,height:w.height,fill:"white",name:"canvas-bg"}),r.map((Ce,Ve)=>{if(Array.isArray(Ce)){const Ze=Ce[0]?.tool==="eraser";return c.jsx(Ja,{points:Ce.flatMap(Ft=>[Ft.x,Ft.y]),stroke:Ze?"black":Ce[0]?.color||"#000000",strokeWidth:Ze?(Ce[0]?.thickness||2)*7:Ce[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:Ze?"destination-out":"source-over"},Ve)}else{if(Ce.type==="line")return c.jsx(Ja,{points:[Ce.startX,Ce.startY,Ce.endX,Ce.endY],stroke:Ce.color,strokeWidth:Ce.thickness,lineCap:"round"},Ve);if(Ce.type==="rectangle"){const Ze=Math.abs(Ce.endX-Ce.startX),Ft=Math.abs(Ce.endY-Ce.startY),zt=Math.min(Ce.startX,Ce.endX),er=Math.min(Ce.startY,Ce.endY);return c.jsx(Pa,{x:zt,y:er,width:Ze,height:Ft,stroke:Ce.color,strokeWidth:Ce.thickness,fill:"transparent"},Ve)}else if(Ce.type==="circle"){const Ze=Math.sqrt(Math.pow(Ce.endX-Ce.startX,2)+Math.pow(Ce.endY-Ce.startY,2))/2,Ft=(Ce.startX+Ce.endX)/2,zt=(Ce.startY+Ce.endY)/2;return c.jsx(hf,{x:Ft,y:zt,radius:Ze,stroke:Ce.color,strokeWidth:Ce.thickness,fill:"transparent"},Ve)}}return null}),k.map(Ce=>c.jsx(tae,{...Ce,isSelected:N===Ce.id,onSelect:P,onUpdate:F,onDelete:A},Ce.id)),s==="pencil"&&c.jsx(Ja,{points:ne.flatMap(Ce=>[Ce.x,Ce.y]),stroke:a,strokeWidth:i,tension:.5,lineCap:"round",lineJoin:"round"}),s==="eraser"&&c.jsx(Ja,{points:ne.flatMap(Ce=>[Ce.x,Ce.y]),stroke:"black",strokeWidth:i*7,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:"destination-out"}),H&&H.type==="line"&&c.jsx(Ja,{points:[H.startX,H.startY,H.endX,H.endY],stroke:H.color,strokeWidth:H.thickness,lineCap:"round"}),H&&H.type==="rectangle"&&c.jsx(Pa,{x:Math.min(H.startX,H.endX),y:Math.min(H.startY,H.endY),width:Math.abs(H.endX-H.startX),height:Math.abs(H.endY-H.startY),stroke:H.color,strokeWidth:H.thickness,fill:"transparent"}),H&&H.type==="circle"&&c.jsx(hf,{x:(H.startX+H.endX)/2,y:(H.startY+H.endY)/2,radius:Math.sqrt(Math.pow(H.endX-H.startX,2)+Math.pow(H.endY-H.startY,2))/2,stroke:H.color,strokeWidth:H.thickness,fill:"transparent"}),s==="eraser"&&c.jsx(hf,{x:J.x,y:J.y,radius:i*7/2,stroke:"#666666",strokeWidth:2,fill:"rgba(102, 102, 102, 0.2)",dash:[5,5],listening:!1}),s==="pencil"&&c.jsx(Ja,{points:[J.x-10,J.y,J.x+10,J.y,J.x,J.y-10,J.x,J.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="line"&&c.jsx(Ja,{points:[J.x-10,J.y,J.x+10,J.y,J.x,J.y-10,J.x,J.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="rectangle"&&c.jsx(Ja,{points:[J.x-10,J.y,J.x+10,J.y,J.x,J.y-10,J.x,J.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="circle"&&c.jsx(Ja,{points:[J.x-10,J.y,J.x+10,J.y,J.x,J.y-10,J.x,J.y+10],stroke:"#666666",strokeWidth:1,listening:!1})]})})}),j&&R&&c.jsx(rae,{x:R.x,y:R.y,width:R.width,height:R.height,initialText:R.text,onSave:Ce=>{F(R.id,{text:Ce}),U(!1),Y(null)},onCancel:()=>{U(!1),Y(null)}}),c.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1",children:[c.jsx("button",{onClick:()=>{const Ce=p.current,Ve=Ce.scaleX(),Ze=C?.max_canvas_width||1536,Ft=C?.max_canvas_height||2048,zt=Ze/w.width,er=Ft/w.height,hr=Math.min(zt,er,5),ir=Math.min(hr,Ce.scaleX()*1.2);Ce.scale({x:ir,y:ir}),Ce.batchDraw(),console.log(" DrawingTestStudent - Zoom In button:",Ve.toFixed(2),"->",ir.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(w.width*ir),"x",Math.round(w.height*ir)),console.log(" DrawingTestStudent - New resolution:",Math.round(w.width*ir*w.height*ir),"pixels"),l(ir)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom In",children:"+"}),c.jsx("button",{onClick:()=>{const Ce=p.current,Ve=Ce.scaleX(),Ze=Math.max(.25,Ce.scaleX()*.8);Ce.scale({x:Ze,y:Ze}),Ce.batchDraw(),console.log(" DrawingTestStudent - Zoom Out button:",Ve.toFixed(2),"->",Ze.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(w.width*Ze),"x",Math.round(w.height*Ze)),console.log(" DrawingTestStudent - New resolution:",Math.round(w.width*Ze*w.height*Ze),"pixels"),l(Ze)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom Out",children:""}),c.jsx("button",{onClick:()=>{const Ce=p.current,Ve=Ce.scaleX();Ce.scale({x:1,y:1}),Ce.position({x:0,y:0}),Ce.batchDraw(),console.log(" DrawingTestStudent - Reset zoom:",Ve.toFixed(2),"-> 1.00"),console.log(" DrawingTestStudent - Reset effective size:",w.width,"x",w.height),console.log(" DrawingTestStudent - Reset resolution:",w.width*w.height,"pixels"),l(1)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 text-xs",title:"Reset Zoom",children:"1:1"})]}),c.jsxs("div",{className:"absolute bottom-2 left-2 bg-white border border-gray-300 rounded px-2 py-1 text-xs text-gray-600 shadow-sm",children:[Math.round(o*100),"%"]})]})})})},sae=({content:e})=>{if(!e)return c.jsx("div",{className:"text-gray-500 italic",children:"No instructions provided"});const t=n=>{if(!n)return"";if(n.type==="text"){let s=n.text||"";if(n.format&&(n.format&1&&(s=`<strong>${s}</strong>`),n.format&2&&(s=`<em>${s}</em>`),n.format&8&&(s=`<u>${s}</u>`),n.format&16&&(s=`<s>${s}</s>`)),n.style){const a=n.style.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}if(n.textStyle){const a=n.textStyle.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}return s}if(n.type==="paragraph"){const s=n.children?n.children.map(t).join(""):"";let a="text-left";return n.format&&(n.format==="center"?a="text-center":n.format==="right"?a="text-right":n.format==="left"&&(a="text-left")),`<p class="${a}">${s}</p>`}if(n.type==="heading"){const s=n.tag||"h1",a=n.children?n.children.map(t).join(""):"";return`<${s}>${a}</${s}>`}if(n.type==="list"){const s=n.listType==="bullet"?"ul":"ol",a=n.children?n.children.map(i=>{if(i.type==="listitem"){const o=i.children?i.children.map(t).join(""):"";let l="margin: 4px 0; display: list-item;";return i.format&&(i.format==="center"?l+=" text-align: center;":i.format==="right"?l+=" text-align: right;":i.format==="left"&&(l+=" text-align: left;")),`<li style="${l}">${o}</li>`}return""}).join(""):"";return`<${s} style="margin: 8px 0; padding-left: 20px; list-style-type: ${n.listType==="bullet"?"disc":"decimal"}; display: block;">${a}</${s}>`}return n.children?n.children.map(t).join(""):""};let r=e;if(typeof e=="string"&&e.startsWith("{"))try{const n=JSON.parse(e);n.text?r=n.text:n.content?r=n.content:n.root&&n.root.children&&(r=n.root.children.map(t).join(""))}catch(n){console.log("Failed to parse Lexical content:",n)}return c.jsx("div",{className:"max-w-none rich-text-content",style:{lineHeight:"1.6",fontSize:"14px"},dangerouslySetInnerHTML:{__html:r}})},aae=({question:e,questionIndex:t,studentAnswer:r,onAnswerChange:n,mode:s,testId:a,testType:i})=>{Da();const[o,l]=S.useState([]),[u,d]=S.useState(!0),[h,g]=S.useState("pencil"),[p,x]=S.useState("#000000"),[v,w]=S.useState(2),[C,k]=S.useState([]),[_,N]=S.useState(-1),[E,P]=S.useState({width:600,height:800}),[F,A]=S.useState(1),[j,R]=S.useState(!1),[U,Y]=S.useState(!1),[Z,ae]=S.useState(!1),[ee,ne]=S.useState([]),[L,H]=S.useState(null),[M,V]=S.useState(!1),[W,I]=S.useState(null),B=_>0,q=_<C.length-1,[J,se]=S.useState(!1),X=S.useRef(null),ie=S.useRef(null),[le,ce]=S.useState({width:600,height:800}),ke=S.useRef(!1),[re,ge]=S.useState(.25),Ne=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#008000","#808080","#FFC0CB","#A52A2A","#000080"];S.useEffect(()=>{const Re=()=>{ae(window.innerWidth>=1024)};return Re(),window.addEventListener("resize",Re),()=>window.removeEventListener("resize",Re)},[]),S.useEffect(()=>{if(e){const Re=e.max_canvas_width||1536,Be=e.max_canvas_height||2048,ct=e.canvas_width||600,We=e.canvas_height||800;if(P({width:Re,height:Be}),ke.current)console.log(" DrawingTestStudent - Preserving user zoom:",F.toFixed(2));else{A(1),ke.current=!0;const Tt=(ct-Re*1)/2,jt=(We-Be*1)/2;if(!isNaN(Tt)&&!isNaN(jt)&&X.current){const Vt={x:Tt,y:jt};X.current.position(Vt),X.current.batchDraw()}console.log(" DrawingTestStudent - Canvas size set:",Re,"x",Be),console.log(" DrawingTestStudent - Viewport size:",ct,"x",We),console.log(" DrawingTestStudent - Initial zoom:",1 .toFixed(2)),console.log(" DrawingTestStudent - Image resolution:",Re*Be,"pixels"),console.log(" DrawingTestStudent - Aspect ratio:",(Re/Be).toFixed(2))}if(r&&typeof r=="string")try{const nt=JSON.parse(r);nt.lines?l(nt.lines):l(nt),nt.textBoxes&&ne(nt.textBoxes)}catch{console.log("No valid drawing data found")}d(!1)}},[e,r]),S.useEffect(()=>{const Re=()=>{const Be=ie.current;if(!Be)return;const ct=Be.clientWidth||1,We=Be.clientHeight||1,nt=Math.min(ct/(E.width||1),We/(E.height||1));ge(Math.min(nt,1))};return Re(),window.addEventListener("resize",Re),()=>window.removeEventListener("resize",Re)},[E.width,E.height,J]);const je=Re=>{l(Re);const Be={lines:Re,textBoxes:ee};n(e.question_id,JSON.stringify(Be)),Ke(Re,ee)},Ke=(Re,Be=ee)=>{const ct=C.slice(0,_+1);ct.push({lines:[...Re],textBoxes:[...Be]}),k(ct),N(ct.length-1)},Ue=()=>{if(B){const Re=_-1,Be=C[Re];if(Be&&typeof Be=="object"&&Be.lines){l([...Be.lines]),ne([...Be.textBoxes]);const ct={lines:Be.lines,textBoxes:Be.textBoxes};n(e.question_id,JSON.stringify(ct))}else{const ct=Be||[];l([...ct]),n(e.question_id,JSON.stringify(ct))}N(Re)}},It=()=>{if(q){const Re=_+1,Be=C[Re];if(Be&&typeof Be=="object"&&Be.lines){l([...Be.lines]),ne([...Be.textBoxes]);const ct={lines:Be.lines,textBoxes:Be.textBoxes};n(e.question_id,JSON.stringify(ct))}else{const ct=Be||[];l([...ct]),n(e.question_id,JSON.stringify(ct))}N(Re)}},rt=()=>{l([]),ne([]),H(null),n(e.question_id,"")},wt=Re=>{H(Re)},xt=(Re,Be)=>{const ct=ee.map(nt=>nt.id===Re?{...nt,...Be}:nt);ne(ct),Ke(o,ct);const We={lines:o,textBoxes:ct};if(n(e.question_id,JSON.stringify(We)),Be.isEditing){const nt=ee.find(Tt=>Tt.id===Re);I(nt),V(!0)}},lt=Re=>{const Be=ee.filter(We=>We.id!==Re);ne(Be),L===Re&&H(null),Ke(o,Be);const ct={lines:o,textBoxes:Be};n(e.question_id,JSON.stringify(ct))},pt=()=>{if(J){const ct=e?.canvas_width||600,We=e?.canvas_height||800,nt=window.innerWidth-40,Tt=window.innerHeight-40,jt=nt/ct,Vt=Tt/We,fr=Math.min(jt,Vt,1);return{width:ct,height:We,zoom:fr}}const Re=e?.canvas_width||600,Be=e?.canvas_height||800;return{width:Re,height:Be,zoom:1}};S.useEffect(()=>{const Re=()=>{ce(pt())};return Re(),window.addEventListener("resize",Re),()=>window.removeEventListener("resize",Re)},[J,E]);const Rt=Re=>{Re.evt.preventDefault();const Be=X.current,ct=Be.scaleX(),We=Be.getPointerPosition(),nt={x:(We.x-Be.x())/ct,y:(We.y-Be.y())/ct},Tt=Re.evt.deltaY>0?ct*.9:ct*1.1,jt=e?.max_canvas_width||1536,Vt=e?.max_canvas_height||2048,fr=jt/E.width,Dr=Vt/E.height,zr=Math.min(fr,Dr,1),or=Math.max(re,Math.min(zr,Tt)),nr={x:We.x-nt.x*or,y:We.y-nt.y*or};if(or<=re&&ie.current){const me=ie.current.clientWidth||1,Ae=ie.current.clientHeight||1;nr.x=(me-E.width*or)/2,nr.y=(Ae-E.height*or)/2}Be.scale({x:or,y:or}),Be.position(nr),Be.batchDraw(),console.log(" DrawingTestStudent - Wheel zoom:",ct.toFixed(2),"->",or.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(E.width*or),"x",Math.round(E.height*or)),console.log(" DrawingTestStudent - New resolution:",Math.round(E.width*or*E.height*or),"pixels"),A(or),ke.current=!0},Mt=Re=>{const Be=Re.scaleX(),ct=ie.current,We=ct?.clientWidth||le.width,nt=ct?.clientHeight||le.height,Tt=E.width*Be,jt=E.height*Be;if(Be<=re){const Fe=(We-Tt)/2,Me=(nt-jt)/2;Re.position({x:Fe,y:Me}),Re.batchDraw();return}if(Tt<=We&&jt<=nt){const Fe=(We-Tt)/2,Me=(nt-jt)/2;Re.position({x:Fe,y:Me}),Re.batchDraw();return}const Vt=Math.max(0,Tt-We),fr=Math.max(0,jt-nt),Dr=-Vt,zr=-fr,or=Re.x(),nr=Re.y(),me=Math.max(Dr,Math.min(Vt,or)),Ae=Math.max(zr,Math.min(fr,nr));(me!==or||Ae!==nr)&&(Re.position({x:me,y:Ae}),Re.batchDraw())},Qe=()=>{if(J)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();else{const Re=ie.current;Re&&(Re.requestFullscreen?Re.requestFullscreen():Re.webkitRequestFullscreen?Re.webkitRequestFullscreen():Re.msRequestFullscreen&&Re.msRequestFullscreen())}};return S.useEffect(()=>{const Re=()=>{se(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",Re),document.addEventListener("webkitfullscreenchange",Re),document.addEventListener("msfullscreenchange",Re),()=>{document.removeEventListener("fullscreenchange",Re),document.removeEventListener("webkitfullscreenchange",Re),document.removeEventListener("msfullscreenchange",Re)}},[]),S.useEffect(()=>()=>{X.current&&X.current.stop()},[]),u?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx(Ur,{})}):e?c.jsxs("div",{className:`drawing-question w-full max-w-full mx-0 p-0 sm:p-2 ${J?"fixed inset-0 z-50 bg-white overflow-y-auto":""}`,children:[!J&&c.jsx("div",{className:"mb-4",children:c.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",t+1]})}),!J&&e.question_json&&e.question_json.trim()&&c.jsxs("div",{className:"mb-2 p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Task:"}),c.jsx("div",{className:"text-gray-700",children:c.jsx(sae,{content:e.question_json})})]}),!J&&c.jsx(At,{className:"p-1 sm:p-2 mb-2",children:c.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-wrap",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"hidden sm:block text-sm text-gray-700",children:"Tool:"}),c.jsxs("div",{className:"flex flex-nowrap sm:flex-wrap gap-1 overflow-x-auto",children:[c.jsx("button",{onClick:()=>g("pencil"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="pencil"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pencil (Freehand drawing)",children:""}),c.jsx("button",{onClick:()=>g("line"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="line"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Line",children:""}),c.jsx("button",{onClick:()=>g("rectangle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="rectangle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Rectangle",children:""}),c.jsx("button",{onClick:()=>g("circle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="circle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Circle",children:""}),c.jsx("button",{onClick:()=>g("eraser"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="eraser"?"bg-red-500 text-white border-red-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Eraser",children:""}),c.jsx("button",{onClick:()=>g("text"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="text"?"bg-green-500 text-white border-green-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Text Box",children:""}),c.jsx("button",{onClick:()=>g("pan"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${h==="pan"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pan (Move canvas)",children:""})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"text-sm text-gray-700",children:"History:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:Ue,disabled:!B,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${B?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Undo (Ctrl+Z)",children:""}),c.jsx("button",{onClick:It,disabled:!q,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${q?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Redo (Ctrl+Y)",children:""})]})]}),c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>R(!j),className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 sm:py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[c.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:p}}),c.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:"Color"})]}),j&&c.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-white border border-gray-300 rounded-lg shadow-lg z-30 min-w-max",children:c.jsx("div",{className:"flex flex-wrap gap-2 max-w-xs",children:Ne.map(Re=>c.jsx("button",{onClick:()=>{x(Re),R(!1)},className:`w-10 h-10 rounded border-2 hover:scale-110 transition-transform flex-shrink-0 ${p===Re?"border-gray-800":"border-gray-300"}`,style:{backgroundColor:Re},title:Re},Re))})})]}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[c.jsx("label",{className:"text-xs sm:text-sm text-gray-700",children:"Thickness:"}),c.jsx("input",{type:"range",min:"1",max:"10",value:v,onChange:Re=>w(parseInt(Re.target.value)),className:"w-16 sm:w-20"}),c.jsxs("span",{className:"text-xs text-gray-500 w-6 sm:w-8",children:[v,"px"]})]}),c.jsx(Je,{onClick:rt,variant:"secondary",size:"sm",children:"Clear"})]})}),c.jsx(At,{paddingClass:"p-0 sm:p-2",children:c.jsxs("div",{ref:ie,className:"w-full drawing-canvas-container relative p-0 m-0",children:[c.jsx(nae,{width:E.width,height:E.height,lines:o,onDrawingChange:je,currentTool:h,currentColor:p,currentThickness:v,zoom:F,onZoomChange:A,isPanning:U,isFullscreen:J,constrainPanPosition:Mt,handleWheel:Rt,stageRef:X,setIsPanning:Y,responsiveDimensions:le,canvasSize:E,question:e,textBoxes:ee,setTextBoxes:ne,selectedTextBox:L,setSelectedTextBox:H,handleTextBoxSelect:wt,handleTextBoxUpdate:xt,handleTextBoxDelete:lt,isEditingText:M,editingTextBox:W,setIsEditingText:V,setEditingTextBox:I,setCurrentTool:g}),c.jsx("button",{onClick:Qe,className:"absolute top-2 left-2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white p-2 rounded-lg transition-all duration-200 z-10",title:J?"Exit Fullscreen":"Enter Fullscreen",children:J?c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})}):c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]})})]}):c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"text-center",children:c.jsx("p",{className:"text-gray-500",children:"No drawing question data available"})})})},xk={enhanceUserData(e,t){const r={id:e.id||e.student_id||e.teacher_id,username:e.username||e.student_id,name:e.name||e.first_name,surname:e.surname||e.last_name,nickname:e.nickname,role:t,is_active:e.is_active!==void 0?e.is_active:!0,created_at:e.created_at,updated_at:e.updated_at};switch(t){case"student":return{...r,student_id:e.student_id,grade:e.grade,class:e.class,number:e.number,subjects:e.subjects||[]};case"teacher":return{...r,teacher_id:e.teacher_id,first_name:e.first_name,last_name:e.last_name,email:e.email,phone:e.phone,subjects:e.subjects||[]};case"admin":return{...r,admin_id:e.admin_id,permissions:e.permissions||["all"]};default:return r}},async studentLogin(e){console.log("Trying student login...");try{const t=await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:e.username,password:e.password})}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.student,role:"student",response:t};throw new Error(r.message||"Student login failed")}catch(t){throw console.error("Student login error:",t),new Error(t.message||"Student login failed")}},async teacherLogin(e){console.log("Trying teacher login...");try{const t=await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.teacher,role:"teacher",response:t};throw new Error(r.message||"Teacher login failed")}catch(t){throw console.error("Teacher login error:",t),new Error(t.message||"Teacher login failed")}},async adminLogin(e){console.log("Trying admin login...");try{const t=await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.admin,role:"admin",response:t};throw new Error(r.message||"Admin login failed")}catch(t){throw console.error("Admin login error:",t),new Error(t.message||"Admin login failed")}},async login(e){const{username:t,password:r}=e;console.log("Attempting login with:",t,r);try{if(t==="admin"){const o=await this.adminLogin(e),l=await o.json();return await this.handleLoginResponse(o,"admin",l)}const n=await this.teacherLogin(e),s=await n.json();if(n.ok&&s.success)return await this.handleLoginResponse(n,"teacher",s);const a=await this.studentLogin(e),i=await a.json();return a.ok&&i.success?await this.handleLoginResponse(a,"student",i):(this.handleLoginFailure(),{success:!1,message:"Login failed. Please check your credentials and try again."})}catch(n){return console.error("Login error:",n),this.handleLoginFailure(),{success:!1,message:n.message||"Login failed"}}},async handleLoginResponse(e,t,r){if(e.ok&&r.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),this.handleLoginFailure(),{success:!1,message:"JWT system not available"};if(r.accessToken&&r.role)try{window.tokenManager.setTokens(r.accessToken,r.role),window.roleBasedLoader.setupAccessAfterLogin()}catch(n){return console.error("[ERROR] Failed to initialize JWT system:",n),this.handleLoginFailure(),{success:!1,message:"Failed to initialize JWT system"}}return this.resetLoginForm(),await this.handlePostLoginActions(r,t),{success:!0,data:r,role:t}}return{success:!1,message:"Login failed"}},async handlePostLoginActions(e,t){console.log(`Handling post-login actions for role: ${t}`);try{switch(t){case"student":e.student&&(this.populateStudentInfo(e.student),window.loadStudentData&&await window.loadStudentData());break;case"teacher":e.teacher&&(this.populateTeacherInfo(e.teacher),window.loadTeacherData&&await window.loadTeacherData());break;case"admin":e.admin&&window.loadAdminData&&await window.loadAdminData();break;default:console.warn(`Unknown role for post-login actions: ${t}`)}}catch(r){console.error("Error in post-login actions:",r)}},handleLoginFailure(){console.log("All login attempts failed"),this.resetLoginForm(),window.showNotification&&window.showNotification("Login failed. Please check your credentials and try again.","error")},resetLoginForm(){const e=document.getElementById("unifiedLoginForm");if(e){e.querySelectorAll("input").forEach(n=>{n.disabled=!1,n.style.opacity="1",n.style.cursor="text",n.removeAttribute("readonly"),n.style.pointerEvents="auto"});const r=e.querySelector('button[type="submit"]');r&&(r.disabled=!1,r.style.opacity="1",r.style.cursor="pointer",r.style.pointerEvents="auto",r.innerHTML="Login"),e.classList.remove("test-submitting","disabled"),e.style.pointerEvents="auto",console.log("Login form reset successfully - all inputs re-enabled")}},async logout(){console.log(" Logout initiated...");try{return window.tokenManager&&window.tokenManager.logout(),window.roleBasedLoader&&window.roleBasedLoader.reloadRoleAccess(),window.clearTestLocalStorage&&window.clearTestLocalStorage(),this.resetInterfaceAfterSessionClear(),console.log(" Logout completed - user session cleared, test data cleared, and interface reset"),{success:!0}}catch(e){return console.error("Logout error:",e),this.resetInterfaceAfterSessionClear(),{success:!0}}},resetInterfaceAfterSessionClear(){try{window.forceLogout=!0,window.preventAutoLogin=!0,window.isClearingSession=!0,window.forceLogoutComplete=!0,document.querySelectorAll(".section").forEach(s=>{s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0"}),document.querySelectorAll('[id$="-cabinet"], [id$="-container"], [id*="cabinet"], [id*="container"]').forEach(s=>{s.id&&s.id!=="login-section"&&(s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0")}),document.body.classList.remove("student-logged-in","teacher-logged-in","admin-logged-in"),document.body.classList.add("force-logout");const r=document.getElementById("login-section");r&&(r.classList.add("active"),r.style.display="block",r.style.visibility="visible",r.style.opacity="1"),document.querySelectorAll("input, select, textarea").forEach(s=>{s.type!=="hidden"&&(s.value="",s.checked=!1)}),console.log(" Interface reset to login state")}catch(e){console.error("Error resetting interface:",e),localStorage.clear(),sessionStorage.clear(),window.location.reload()}},async changePassword(e){try{return{success:!0,message:(await vs.post("/auth/change-password",{currentPassword:e.currentPassword,newPassword:e.newPassword,confirmPassword:e.confirmPassword})).data.message}}catch(t){throw new Error(t.response?.data?.message||"Password change failed")}},async verifyToken(e){try{const t=await vs.get("/auth/verify",{headers:{Authorization:`Bearer ${e}`}});return{success:!0,valid:t.data.valid,user:t.data.user}}catch(t){return{success:!1,valid:!1,error:t.message}}},async refreshToken(e){try{const t=await vs.post("/auth/refresh",{refreshToken:e});return{success:!0,token:t.data.token,refreshToken:t.data.refreshToken}}catch(t){throw new Error(t.response?.data?.message||"Token refresh failed")}},async getUserProfile(){try{return{success:!0,user:(await vs.get("/auth/profile")).data.user}}catch(e){throw new Error(e.response?.data?.message||"Failed to get user profile")}},async updateUserProfile(e){try{return{success:!0,user:(await vs.put("/auth/profile",e)).data.user}}catch(t){throw new Error(t.response?.data?.message||"Failed to update user profile")}},populateStudentInfo(e){console.log("=== populateStudentInfo called ==="),console.log("Student object:",e);const t=document.getElementById("studentName");if(t){const s=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=s,console.log("Set student name to:",s)}const r=document.getElementById("studentGrade");r&&(r.textContent=e?.grade||"",console.log("Set student grade to:",e?.grade));const n=document.getElementById("studentClass");n&&(n.textContent=e?.class||"",console.log("Set student class to:",e?.class)),console.log("Student info populated successfully")},populateTeacherInfo(e){console.log("=== populateTeacherInfo called ==="),console.log("Teacher object:",e);const t=document.getElementById("teacherName");if(t){const n=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=n,console.log("Set teacher name to:",n)}const r=document.getElementById("teacherUsername");r&&(r.textContent=e?.username||"",console.log("Set teacher username to:",e?.username)),console.log("Teacher info populated successfully")},getCurrentTeacherId(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.sub?e.role==="teacher"?(console.log(`[DEBUG] Found teacher ID from JWT: ${e.sub}`),e.sub):(console.warn(`[WARN] Unsupported role for teacher function: ${e.role}`),null):(console.warn("[WARN] No teacher ID found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher ID from JWT:",e),null}},getCurrentAdmin(){const e=window.tokenManager?.getToken();if(!e)return null;const t=window.tokenManager.decodeToken(e);if(!t||t.role!=="admin")throw new Error("getCurrentAdmin() called by non-admin user");return{id:t.sub,username:t.username,role:t.role}},getCurrentTeacherUsername(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.username?(console.log(`[DEBUG] Found teacher username from JWT: ${e.username}`),e.username):(console.warn("[WARN] No teacher username found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher username from JWT:",e),null}},isAdmin(){try{const e=window.tokenManager?.getToken();if(!e)return!1;const t=window.tokenManager.decodeToken(e);return t&&t.role==="admin"}catch(e){return console.error("[ERROR] Error checking admin status:",e),!1}},getCurrentAdminId(){try{const e=this.getCurrentAdmin();return e?e.id:null}catch(e){return console.error("[ERROR] Error getting admin ID:",e),null}}},iae=()=>{const e=vo(),{login:t,setUserData:r,isAuthenticated:n,user:s}=Qn(),[a,i]=S.useState({username:"",password:""}),[o,l]=S.useState(!1),[u,d]=S.useState(""),[h,g]=S.useState([]),[p,x]=S.useState(!1);S.useEffect(()=>{v()},[]);const v=S.useCallback(()=>{console.log("Checking for existing JWT session...");try{(window.forceLogout||window.preventAutoLogin)&&(window.forceLogout=!1,window.preventAutoLogin=!1)}catch{}if(window.tokenManager&&window.tokenManager.isAuthenticated()){console.log("JWT session valid, checking user role...");try{const U=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());U&&U.role?console.log("User role from JWT:",U.role):console.log("No valid role found in JWT, showing login")}catch(U){console.error("Error decoding JWT token:",U)}}else console.log("No valid JWT session found, showing login")},[]),w=S.useCallback(async U=>{if(U.preventDefault(),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),A("Please wait for the logout process to complete.","warning");return}const{username:Y,password:Z}=a;if(!Y||!Z){d("Please enter both username and password");return}l(!0),d("");try{let ae,ee;Y==="admin"?(ae=await xk.adminLogin({username:Y,password:Z}),ee=Hi.ADMIN):/^\d+$/.test(Y)?(ae=await xk.studentLogin({username:Y,password:Z}),ee=Hi.STUDENT):(ae=await xk.teacherLogin({username:Y,password:Z}),ee=Hi.TEACHER);let ne,L;if(ae.response?(ne=ae,L=ae.response):(ne=await ae.json(),L=ae),await C(L,ee,ne)){A("Login successful!","success");try{if("credentials"in navigator&&window.PasswordCredential&&a?.username&&a?.password){const H=new window.PasswordCredential({id:String(a.username),password:String(a.password)});await navigator.credentials.store(H)}}catch{}try{window.forceLogout=!1,window.preventAutoLogin=!1}catch{}}}catch(ae){console.error("Login error:",ae),d("Invalid username or password")}finally{l(!1)}},[a]),C=S.useCallback(async(U,Y,Z)=>{if(U.ok&&Z.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),P(),!1;try{Z.token&&(window.tokenManager.setTokens(Z.token,Y),Z.refreshToken&&window.tokenManager.setRefreshToken(Z.refreshToken),console.log("JWT token stored successfully"));const ae={...Z.data,...Z,role:Y};return r(ae),await k(ae),!0}catch(ae){return console.error("Error handling login response:",ae),P(ae),!1}}else return console.error("Login failed:",Z.error||"Unknown error"),d(Z.error||"Login failed. Please check your credentials."),!1},[t]),k=S.useCallback(async U=>{if(console.log("Handling post-login actions for role:",U.role),p){console.log(" Post-login already handled, skipping");return}x(!0);try{switch(U.role){case Hi.STUDENT:await _(U),e("/student");break;case Hi.TEACHER:await N(U),e("/teacher");break;case Hi.ADMIN:await E(U),e("/admin");break;default:console.error("Unknown user role:",U.role),P()}}catch(Y){console.error("Error in post-login actions:",Y),P(Y)}},[e,p]);S.useEffect(()=>{n||x(!1)},[n]);const _=S.useCallback(async U=>{console.log("Populating student info:",U)},[]),N=S.useCallback(async U=>{console.log("Populating teacher info:",U)},[]),E=S.useCallback(async U=>{console.log("Populating admin info:",U)},[]),P=S.useCallback((U=null)=>{console.error("Login failure:",U),d("Login failed. Please check your credentials and try again."),F()},[]),F=S.useCallback(()=>{i({username:"",password:""}),d(""),l(!1)},[]),A=S.useCallback((U,Y)=>{const Z={id:Date.now(),message:U,type:Y,timestamp:new Date};g(ae=>[...ae,Z]),setTimeout(()=>{g(ae=>ae.filter(ee=>ee.id!==Z.id))},C0.NOTIFICATION_DURATION)},[]),j=S.useCallback(U=>{const{name:Y,value:Z}=U.target;i(ae=>({...ae,[Y]:Z})),u&&d("")},[u]),R=S.useCallback(U=>{U.key==="Enter"&&!o&&w(U)},[w,o]);return c.jsxs(st.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsxs(st.div,{className:"w-full max-w-md",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsxs(st.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsx(st.div,{className:"flex justify-center mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.5,type:"spring"},children:c.jsx("img",{src:"/pics/logo_mws.png",alt:"MWS Logo",className:"h-16 w-16 object-contain"})}),c.jsx(st.h1,{className:"text-3xl font-bold text-gray-900 mb-2",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.3},children:"Mathayom Watsing School"}),c.jsx(st.p,{className:"text-lg text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.3},children:"Test Management System"})]}),c.jsxs(st.div,{className:"bg-white rounded-xl shadow-2xl p-8",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.7,duration:.5,type:"spring"},children:[c.jsx(st.h2,{className:"text-2xl font-semibold text-gray-900 text-center mb-6",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.8,duration:.3},children:"Login"}),c.jsxs("form",{onSubmit:w,className:"space-y-6",children:[c.jsxs(st.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.9,duration:.3},children:[c.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),c.jsx(st.input,{type:"text",id:"username",name:"username",value:a.username,onChange:j,onKeyDown:R,placeholder:"Enter your username",required:!0,autoComplete:"username",autoCapitalize:"none",spellCheck:!1,disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),c.jsxs(st.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1,duration:.3},children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),c.jsx(st.input,{type:"password",id:"password",name:"password",value:a.password,onChange:j,onKeyDown:R,placeholder:"Enter your password",required:!0,autoComplete:"current-password",disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),c.jsx(fo,{children:u&&c.jsx(st.div,{id:"error-message",className:"bg-red-50 border border-red-200 rounded-lg p-3",role:"alert","aria-live":"polite",initial:{opacity:0,height:0,y:-10},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:-10},transition:{duration:.3},children:c.jsx("p",{className:"text-sm text-red-600",children:u})})}),c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.1,duration:.3},children:c.jsx(Je,{type:"submit",variant:"primary",size:"lg",disabled:o,className:"w-full",children:o?c.jsxs(c.Fragment,{children:[c.jsx(Ur,{size:"sm",className:"mr-2"}),"Logging in..."]}):"Login"})})]})]})]}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:c.jsx(fo,{children:h.map(U=>c.jsx(st.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{duration:.3,type:"spring"},children:c.jsx(ac,{type:U.type,message:U.message,onClose:()=>g(Y=>Y.filter(Z=>Z.id!==U.id))})},U.id))})})]})},ns={async getStudentData(){console.log("getStudentData called - loading student subjects");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-subjects")).json();if(t.success)return console.log("Student data loaded successfully:",t.subjects),t.subjects;throw new Error(t.error||"Failed to load student data")}catch(e){throw console.error("Error loading student data:",e),e}},getStudentSubjects(e){return console.log("getStudentSubjects called with subjects:",e),e.map(t=>({id:t.id||t.subject_id,name:t.subject,grade:t.grade,class:t.class,testResults:t.test_results||[]}))},async getTeacherData(){console.log("getTeacherData called - loading teacher subjects");try{const e=await this.getCurrentTeacherId();if(!e)throw new Error("No valid teacher session found");const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-subjects")).json();if(r.success)return console.log("Teacher data loaded successfully:",r.subjects),{teacher_id:e,subjects:r.subjects,hasSubjects:r.subjects.length>0};throw new Error(r.error||"Failed to load teacher data")}catch(e){throw console.error("Error loading teacher data:",e),e}},getTeacherSubjects(e){return console.log("getTeacherSubjects called with subjects:",e),e.map(t=>{let r=[];return t.classes&&Array.isArray(t.classes)&&(r=t.classes.map(n=>({grade:n.grade,class:n.class,className:n.class}))),{id:t.subject_id,name:t.subject,classes:r,assignments:t.assignments||[],description:t.description||""}})},getGradeButtons(){return console.log("getGradeButtons called"),["M1","M2","M3","M4","M5","M6"].map(t=>({id:t,name:t,classes:this.generateClassButtons(t)}))},generateClassButtons(e){const t=[];for(let r=1;r<=10;r++)t.push({id:`${e}_${r}`,name:`${e}/${r}`,grade:e,class:r});return t},async getAdminData(){console.log("getAdminData called - loading admin data");try{if(!await this.getCurrentAdminId())throw new Error("No valid admin session found");const[t,r,n]=await Promise.allSettled([this.getAllTeachers(),this.getAllSubjects(),this.getAllUsers()]);return{teachers:t.status==="fulfilled"?t.value:[],subjects:r.status==="fulfilled"?r.value:[],users:n.status==="fulfilled"?n.value:[],loadedAt:new Date().toISOString()}}catch(e){throw console.error("Error loading admin data:",e),e}},async saveTeacherSubjects(e){console.log("saveTeacherSubjects called with subjects:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-teacher-subjects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subjects:e})})).json();if(r.success)return console.log("Teacher subjects saved successfully"),r;throw new Error(r.error||"Failed to save teacher subjects")}catch(t){throw console.error("Error saving teacher subjects:",t),t}},async deleteTeacherSubject(e){console.log("deleteTeacherSubject called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/delete-teacher-subject",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher subject assignment deleted successfully"),r;throw new Error(r.error||"Failed to delete teacher subject assignment")}catch(t){throw console.error("Error deleting teacher subject assignment:",t),t}},async getSubjectsDropdown(){console.log("getSubjectsDropdown called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("Subjects dropdown data loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,value:r.subject_name}));throw new Error(t.error||"Failed to load subjects dropdown")}catch(e){throw console.error("Error loading subjects dropdown:",e),e}},async getGradesAndClasses(){console.log("getGradesAndClasses called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-grades-classes")).json();if(t.success)return console.log("Grades and classes loaded successfully"),t.data;throw new Error(t.message||"Failed to load grades and classes")}catch(e){throw console.error("Error loading grades and classes:",e),e}},async saveSubjectClasses(e,t){console.log("saveSubjectClasses called with subjectId:",e,"classes:",t);try{const r=await this.getCurrentTeacherId();if(!r)throw new Error("No valid teacher session found");const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-subject-classes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacher_id:r,subject_id:e,classes:t})})).json();if(s.success)return console.log("Subject classes saved successfully"),s;throw new Error(s.error||"Failed to save subject classes")}catch(r){throw console.error("Error saving subject classes:",r),r}},async getAllSubjects(){console.log("getAllSubjects called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("All subjects loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,description:r.description||"",created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all subjects")}catch(e){throw console.error("Error loading all subjects:",e),e}},async getSubjectsForSelection(){console.log("getSubjectsForSelection called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-subjects")).json();if(t.success)return console.log("Subjects for selection loaded successfully"),t.subjects;throw new Error(t.message||"Failed to load subjects for selection")}catch(e){throw console.error("Error loading subjects for selection:",e),e}},async addAcademicYear(e){console.log("addAcademicYear called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/add-academic-year",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Academic year added successfully"),r;throw new Error(r.error||"Failed to add academic year")}catch(t){throw console.error("Error adding academic year:",t),t}},async getAllUsers(){console.log("getAllUsers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-users")).json();if(t.success)return console.log("All users loaded successfully"),t.users.map(r=>({id:r.id,student_id:r.student_id,grade:r.grade,class:r.class,number:r.number,name:r.name,surname:r.surname,nickname:r.nickname,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all users")}catch(e){throw console.error("Error loading all users:",e),e}},async getAllTeachers(){console.log("getAllTeachers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-teachers")).json();if(t.success)return console.log("All teachers loaded successfully"),t.teachers.map(r=>({id:r.id,teacher_id:r.teacher_id,username:r.username,name:r.name,surname:r.surname,email:r.email,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all teachers")}catch(e){throw console.error("Error loading all teachers:",e),e}},async createUser(e){console.log("createUser called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("User created successfully"),r;throw new Error(r.error||"Failed to create user")}catch(t){throw console.error("Error creating user:",t),t}},async updateUser(e,t){console.log("updateUser called with userId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-user/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("User updated successfully"),n;throw new Error(n.error||"Failed to update user")}catch(r){throw console.error("Error updating user:",r),r}},async createTeacher(e){console.log("createTeacher called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-teacher",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher created successfully"),r;throw new Error(r.error||"Failed to create teacher")}catch(t){throw console.error("Error creating teacher:",t),t}},async updateTeacher(e,t){console.log("updateTeacher called with teacherId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-teacher/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("Teacher updated successfully"),n;throw new Error(n.error||"Failed to update teacher")}catch(r){throw console.error("Error updating teacher:",r),r}},async updateStudentInfo(e){console.log("updateStudentInfo called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-student-info",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Student info updated successfully"),r;throw new Error(r.error||"Failed to update student info")}catch(t){throw console.error("Error updating student info:",t),t}},async changePassword(e){console.log("changePassword called");let t;if(e.studentId)t="/.netlify/functions/change-student-password";else if(e.username)t="/.netlify/functions/change-teacher-password";else throw new Error("Invalid password data: missing studentId or username");try{const n=await(await window.tokenManager.makeAuthenticatedRequest(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(n.success)return console.log("Password changed successfully"),n;throw new Error(n.error||"Failed to change password")}catch(r){throw console.error("Error changing password:",r),r}},async getCurrentTeacherId(){try{const e=localStorage.getItem("accessToken");if(!e)return null;const t=JSON.parse(atob(e.split(".")[1]));return t.teacher_id||t.sub||null}catch(e){return console.error("Error getting current teacher ID:",e),null}},async getCurrentAdminId(){try{const e=localStorage.getItem("accessToken");if(!e)return null;const t=JSON.parse(atob(e.split(".")[1]));return t.admin_id||t.sub||null}catch(e){return console.error("Error getting current admin ID:",e),null}}},NB=S.createContext(),AB=({children:e})=>{const[t,r]=S.useState(null),[n,s]=S.useState([]),[a,i]=S.useState([]),[o,l]=S.useState([]),[u,d]=S.useState([]),[h,g]=S.useState([]),[p,x]=S.useState([]),[v,w]=S.useState([]),[C,k]=S.useState(!1),[_,N]=S.useState(null),[E,P]=S.useState(!1),[F,A]=S.useState(!1),[j,R]=S.useState(!1),[U,Y]=S.useState(null),[Z,ae]=S.useState(null),[ee,ne]=S.useState(null),L=S.useCallback(async()=>{try{k(!0),N(null);const Ae=`student_subjects_${t?.student_id||t?.id||""}`;console.log(" UserContext: Checking cache for key:",Ae);const Fe=Es(Ae);if(Fe){console.log(" UserContext: Cache HIT! Using cached student data"),s(Fe),H(Fe);return}console.log(" UserContext: Cache MISS! Fetching from API");const Me=await ns.getStudentData();if(Me)s(Me),H(Me),console.log(" UserContext: Caching student data with key:",Ae),us(Ae,Me,Ts.student_subjects);else throw new Error("No subjects data received")}catch(me){N(me.message||"Failed to load student data"),console.error("Error loading student data:",me)}finally{k(!1)}},[t?.student_id,t?.id]),H=me=>{console.log("Displaying student subjects:",me),s(me)},M=S.useCallback(async()=>{try{if(k(!0),N(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid teacher session found in loadTeacherData, redirecting to login"),N("No valid teacher session found");return}const Ae=`teacher_subjects_${t?.teacher_id||t?.id||""}`,Fe=Es(Ae);if(Fe){s(Fe),Fe.length===0?Vt():V(Fe);return}const Me=await ns.getTeacherSubjects();if(Me.success)s(Me.subjects),us(Ae,Me.subjects,Ts.teacher_subjects),Me.subjects.length===0?Vt():V(Me.subjects);else throw new Error(Me.message||"Failed to load teacher data")}catch(me){N(me.message||"Failed to load teacher data"),console.error("Error loading teacher data:",me)}finally{k(!1)}},[t?.teacher_id,t?.id]),V=me=>{console.log("Showing main cabinet with subjects:",me),s(me)},W=me=>{console.log("Displaying grade buttons:",me),l(me)},I=async()=>{try{if(k(!0),N(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid admin session found in loadAdminData, redirecting to login"),N("No valid admin session found");return}await Promise.all([ge(),xt(),se()])}catch(me){N(me.message||"Failed to load admin data"),console.error("Error loading admin data:",me)}finally{k(!1)}},B=me=>{console.log(" populateStudentInfoDirectly called with:",me);try{r(me),console.log(" Set student profile:",me)}catch(Ae){console.error("Error populating student info:",Ae)}},q=me=>{console.log("=== populateStudentInfo called ==="),r(me)},J=me=>{console.log("=== populateTeacherInfo called ==="),r(me)},se=S.useCallback(async()=>{try{k(!0);const me="admin_users_",Ae=Es(me);if(Ae){d(Ae),X(Ae);return}const Fe=await ns.getAllUsers();if(Fe.success)d(Fe.users),X(Fe.users),us(me,Fe.users,Ts.admin_users);else throw new Error(Fe.message||"Failed to load users")}catch(me){N(me.message||"Failed to load users"),console.error("Error loading users:",me)}finally{k(!1)}},[]),X=me=>{console.log("Displaying all users:",me),d(me)},ie=(me,Ae)=>{console.log("Displaying users table:",me,Ae),d(me)},le=()=>{console.log("Toggling users content")},ce=()=>{console.log("Showing add user form"),P(!0)},ke=()=>{console.log("Hiding add user form"),P(!1)},re=me=>{console.log("Editing user row:",me);const Ae=u.find(Fe=>Fe.id===me);Y(Ae)},ge=S.useCallback(async()=>{try{const me="admin_teachers_",Ae=Es(me);if(Ae){g(Ae),Ne(Ae);return}const Fe=await ns.getAllTeachers();if(Fe.success)g(Fe.teachers),Ne(Fe.teachers),us(me,Fe.teachers,Ts.admin_teachers);else throw new Error(Fe.message||"Failed to load teachers")}catch(me){N(me.message||"Failed to load teachers"),console.error("Error loading teachers:",me)}},[]),Ne=me=>{console.log("Displaying all teachers:",me),g(me)},je=(me,Ae)=>{console.log("Displaying teachers table:",me,Ae),g(me)},Ke=()=>{console.log("Toggling teachers content")},Ue=()=>{console.log("Showing add teacher form"),A(!0)},It=()=>{console.log("Hiding add teacher form"),A(!1)},rt=me=>{console.log("Editing teacher:",me);const Ae=h.find(Fe=>Fe.id===me);ae(Ae)},wt=me=>{console.log("Editing teacher row:",me);const Ae=h.find(Fe=>Fe.id===me);ae(Ae)},xt=S.useCallback(async()=>{try{const me="admin_subjects_",Ae=Es(me);if(Ae){x(Ae),lt(Ae);return}const Fe=await ns.getAllSubjects();if(Fe.success)x(Fe.subjects),lt(Fe.subjects),us(me,Fe.subjects,Ts.admin_subjects);else throw new Error(Fe.message||"Failed to load subjects")}catch(me){N(me.message||"Failed to load subjects"),console.error("Error loading subjects:",me)}},[]),lt=me=>{console.log("Displaying all subjects:",me),x(me)},pt=(me,Ae)=>{console.log("Displaying subjects table:",me,Ae),x(me)},Rt=()=>{console.log("Toggling subjects content")},Mt=()=>{console.log("Showing add subject form"),R(!0)},Qe=()=>{console.log("Hiding add subject form"),R(!1)},Re=me=>{console.log("Editing subject row:",me);const Ae=p.find(Fe=>Fe.id===me);ne(Ae)},Be=me=>{console.log("Displaying academic year:",me),w(me)},ct=()=>{console.log("Showing add academic year form")},We=()=>{console.log("Hiding add academic year form")},nt=me=>{console.log("Handling add academic year:",me)},Tt=()=>{console.log("Toggling academic year content")},jt=()=>{console.log("Showing academic year editor")},Vt=()=>{console.log("Showing subject selection")},fr=()=>{console.log("Showing main cabinet")},Dr=me=>{r(Ae=>({...Ae,...me}))},zr=()=>{r(null),s([]),i([]),l([]),d([]),g([]),x([]),w([]),N(null)},or=S.useCallback(me=>{zr(),me&&gN(me)},[]),nr={userProfile:t,userSubjects:n,userClasses:a,userGrades:o,allUsers:u,allTeachers:h,allSubjects:p,academicYears:v,isLoading:C,error:_,showUserForm:E,showTeacherForm:F,showSubjectForm:j,editingUser:U,editingTeacher:Z,editingSubject:ee,loadStudentData:L,displayStudentSubjects:H,populateStudentInfoDirectly:B,populateStudentInfo:q,loadTeacherData:M,showMainCabinetWithSubjects:V,displayGradeButtons:W,populateTeacherInfo:J,showSubjectSelection:Vt,showMainCabinet:fr,loadAdminData:I,getAllUsers:se,displayAllUsers:X,displayUsersTable:ie,toggleUsersContent:le,showAddUserForm:ce,hideAddUserForm:ke,editUserRow:re,loadAllTeachers:ge,displayAllTeachers:Ne,displayTeachersTable:je,toggleTeachersContent:Ke,showAddTeacherForm:Ue,hideAddTeacherForm:It,editTeacher:rt,editTeacherRow:wt,loadAllSubjects:xt,displayAllSubjects:lt,displaySubjectsTable:pt,toggleSubjectsContent:Rt,showAddSubjectForm:Mt,hideAddSubjectForm:Qe,editSubjectRow:Re,displayAcademicYear:Be,showAddAcademicYearForm:ct,hideAddAcademicYearForm:We,handleAddAcademicYear:nt,toggleAcademicYearContent:Tt,showAcademicYearEditor:jt,updateUserProfile:Dr,clearUserData:zr,clearUserDataWithCache:or,setUserProfile:r,setUserSubjects:s,setUserClasses:i,setUserGrades:l,setAllUsers:d,setAllTeachers:g,setAllSubjects:x,setAcademicYears:w,setError:N};return c.jsx(NB.Provider,{value:nr,children:e})},r2=()=>{const e=S.useContext(NB);if(!e)throw new Error("useUser must be used within a UserProvider");return e},Kx={STUDENT_LOGIN:"/.netlify/functions/student-login",TEACHER_LOGIN:"/.netlify/functions/teacher-login",ADMIN_LOGIN:"/.netlify/functions/admin-login",CHANGE_PASSWORD:"/.netlify/functions/change-password",GET_TEST_QUESTIONS:"/.netlify/functions/get-test-questions",SUBMIT_MULTIPLE_CHOICE_TEST:"/.netlify/functions/submit-multiple-choice-test",SUBMIT_TRUE_FALSE_TEST:"/.netlify/functions/submit-true-false-test",SUBMIT_INPUT_TEST:"/.netlify/functions/submit-input-test",SUBMIT_MATCHING_TEST:"/.netlify/functions/submit-matching-test",SUBMIT_DRAWING_TEST:"/.netlify/functions/submit-drawing-test",GET_STUDENT_SUBJECTS:"/.netlify/functions/get-student-subjects",GET_TEACHER_SUBJECTS:"/.netlify/functions/get-teacher-subjects",GET_ALL_USERS:"/.netlify/functions/get-all-users",GET_ALL_TEACHERS:"/.netlify/functions/get-all-teachers",GET_ALL_SUBJECTS:"/.netlify/functions/get-all-subjects",GET_ACADEMIC_YEAR:"/.netlify/functions/get-academic-year",SAVE_MULTIPLE_CHOICE_TEST:"/.netlify/functions/save-multiple-choice-test",SAVE_TRUE_FALSE_TEST:"/.netlify/functions/save-true-false-test",SAVE_INPUT_TEST:"/.netlify/functions/save-input-test",SAVE_MATCHING_TEST:"/.netlify/functions/save-matching-test",SAVE_DRAWING_TEST:"/.netlify/functions/save-drawing-test",UPDATE_DRAWING_TEST_SCORE:"/.netlify/functions/update-drawing-test-score",UPDATE_SPEAKING_TEST_SCORE:"/.netlify/functions/update-speaking-test-score",ASSIGN_TEST_TO_CLASSES:"/.netlify/functions/assign-test-to-classes",GET_TEACHER_ACTIVE_TESTS:"/.netlify/functions/get-teacher-active-tests",GET_STUDENT_ACTIVE_TESTS:"/.netlify/functions/get-student-active-tests"},Cn={MULTIPLE_CHOICE:"multiple_choice",TRUE_FALSE:"true_false",INPUT:"input",MATCHING:"matching_type",WORD_MATCHING:"word_matching",DRAWING:"drawing",FILL_BLANKS:"fill_blanks"},Hi={STUDENT:"student",TEACHER:"teacher",ADMIN:"admin"};Array.from({length:10},(e,t)=>t+1);const C0={NOTIFICATION_DURATION:3e3},xf=(e,t,r)=>{if(!e||!Array.isArray(e)||e.length===0)return{score:0,total:0,percentage:0};let n=0;return e.forEach((s,a)=>{const i=Array.isArray(t)?t[a]:t[String(s.question_id||s.id||a)];i!=null&&bm(s,i,r)&&n++}),{score:n,total:e.length,percentage:Math.round(n/e.length*100)}},Yy=(e,t)=>{console.log(" Getting correct answer for question:",e,"testType:",t);let r="";switch(t){case Cn.TRUE_FALSE:r=e.correct_answer?"true":"false",console.log(" TRUE_FALSE correct_answer from question:",r,typeof r);break;case Cn.MULTIPLE_CHOICE:const n=e.correct_answer.charCodeAt(0)-65,s=`option_${String.fromCharCode(97+n)}`,a=e[s];a?r=a:r=`Option ${e.correct_answer}`;break;case Cn.INPUT:e.correct_answers&&Array.isArray(e.correct_answers)?r=e.correct_answers.join(", "):r=e.correct_answer||"Unknown";break;case Cn.MATCHING:r=e.correct_answer||e.answer;break;case Cn.WORD_MATCHING:r=e.correct_answer||e.answer;break;case Cn.DRAWING:r="Drawing required";break;case Cn.FILL_BLANKS:e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?r=e.correct_answers[0]:r=e.correct_answer||"Unknown";break;default:r="Unknown"}return console.log(" Correct answer:",r),r},bm=(e,t,r)=>{if(console.log("[DEBUG] checkAnswerCorrectness called for question:",e,"studentAnswer:",t,"testType:",r),!t||t==="")return console.log("[DEBUG] No student answer provided"),!1;let n=!1;switch(r){case Cn.TRUE_FALSE:n=t.toLowerCase()==="true"===e.correct_answer;break;case Cn.MULTIPLE_CHOICE:let a="";if(typeof t=="string"){const o=t.trim();if(/^[a-z]$/i.test(o))a=o.toUpperCase();else if(/^\d+$/.test(o)){const l=parseInt(o,10),u=l>=0?l:NaN;Number.isNaN(u)||(a=String.fromCharCode(65+u))}}else if(typeof t=="number"){const o=t;Number.isNaN(o)||(a=String.fromCharCode(65+o))}n=a!==""&&a===String(e.correct_answer||"").toUpperCase();break;case Cn.INPUT:if(e.correct_answers&&Array.isArray(e.correct_answers)){const o=t.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();n=e.correct_answers.some(l=>{const u=l.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();return o===u?!0:u&&o.includes(u)?u.length===1?o.startsWith(u)||o.endsWith(u):!0:!1})}else{const o=t.toLowerCase().trim(),l=e.correct_answer.toLowerCase().trim();o===l?n=!0:l&&o.includes(l)?l.length===1?n=o.startsWith(l)||o.endsWith(l):n=!0:n=!1}break;case Cn.MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const o=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(o)===JSON.stringify(e.correct_answer)}break;case Cn.WORD_MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const o=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(o)===JSON.stringify(e.correct_answer)}break;case Cn.DRAWING:console.warn("Drawing tests should not be auto-scored!"),n=!1;break;case Cn.FILL_BLANKS:const i=e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?e.correct_answers[0]:e.correct_answer;if(i&&t){let o="";if(typeof t=="string"){const l=t.trim();if(/^[a-z]$/i.test(l))o=l.toUpperCase();else if(/^\d+$/.test(l)){const u=parseInt(l,10),d=u>=0?u:NaN;Number.isNaN(d)||(o=String.fromCharCode(65+d))}}else if(typeof t=="number"){const l=t;Number.isNaN(l)||(o=String.fromCharCode(65+l))}n=o!==""&&o===String(i||"").toUpperCase()}break;default:console.warn(`[WARN] Unknown test type for answer checking: ${r}`),n=!1}return console.log(`[DEBUG] Answer correctness: ${n}`),n};class oae{constructor(){this.academicCalendar=null,this.loaded=!1}async loadAcademicCalendar(){if(this.loaded)return this.academicCalendar;try{const t=async n=>{const s=await fetch(n,{headers:{Accept:"application/json"},credentials:"include"}),a=s.headers&&s.headers.get&&s.headers.get("content-type")||"";if(!s.ok)throw new Error(`HTTP ${s.status}`);if(!a.includes("application/json"))throw new Error("Non-JSON response");return await s.json()};let r=null;if(r=await t("/academic_year.json"),!Array.isArray(r))throw new Error("Invalid academic calendar format");return this.academicCalendar=r,this.loaded=!0,console.log(" Academic calendar loaded:",this.academicCalendar.length,"terms"),this.academicCalendar}catch(t){return console.error(" Error loading academic calendar:",t),null}}getCurrentTerm(){if(!this.academicCalendar)return null;const t=new Date;return this.academicCalendar.find(n=>{const s=new Date(n.start_date),a=new Date(n.end_date);return t>=s&&t<=a})}getCurrentSemester(){const t=this.getCurrentTerm();if(!t)return null;const r=t.semester,n=this.academicCalendar.filter(s=>s.semester===r&&s.academic_year===t.academic_year);return{semester:r,currentTerm:t,allTerms:n}}getCurrentAcademicPeriodId(){return this.getCurrentTerm()?.id||null}getSemesterTerms(t){return this.academicCalendar?this.academicCalendar.filter(r=>r.semester===t):[]}getAcademicYearTerms(t){return this.academicCalendar?this.academicCalendar.filter(r=>r.academic_year===t):[]}getCurrentSemesterWithTerms(){const t=this.getCurrentSemester();if(!t)return null;const{semester:r,currentTerm:n,allTerms:s}=t;return{semester:r,currentTerm:n,allTerms:s,terms:s.map(a=>({id:a.id,term:a.term,start_date:a.start_date,end_date:a.end_date,isCurrent:a.id===n.id,label:`Term ${a.term}${a.id===n.id?" (Current)":""}`}))}}getCurrentSemesterTerms(){const t=this.getCurrentSemester();if(!t)return null;const{semester:r,currentTerm:n,allTerms:s}=t;return{semester:r,currentTerm:n,terms:s.map(a=>({id:a.id,term:a.term,start_date:a.start_date,end_date:a.end_date,isCurrent:a.id===n.id,label:`Term ${a.term}${a.id===n.id?" (Current)":""}`}))}}getTermById(t){return this.academicCalendar?this.academicCalendar.find(r=>r.id===t):null}isCurrentTerm(t){return this.getCurrentTerm()?.id===t}getAcademicYears(){return this.academicCalendar?[...new Set(this.academicCalendar.map(r=>r.academic_year))].sort():[]}getAcademicYearSemesterTerms(t,r){return this.academicCalendar?this.academicCalendar.filter(n=>n.academic_year===t&&n.semester===r):[]}}const Qu=new oae,n2=Object.freeze(Object.defineProperty({__proto__:null,academicCalendarService:Qu},Symbol.toStringTag,{value:"Module"})),cn={async getTestInfo(e,t){console.log(`[DEBUG] getTestInfo called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test info from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test info data received:",s),s.success)return console.log("[DEBUG] Test info retrieved successfully"),s.test_info;throw new Error(s.error||"Failed to get test info")}catch(r){throw console.error("[ERROR] Failed to get test info:",r),r}},async getTestQuestions(e,t){console.log(`[DEBUG] getTestQuestions called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test questions from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test questions data received:",s),s.success)return console.log("[DEBUG] Test questions retrieved successfully"),s.questions;throw new Error(s.error||"Failed to get test questions")}catch(r){throw console.error("[ERROR] Failed to get test questions:",r),r}},async getActiveTests(){console.log("getActiveTests called - extracting studentId from JWT token");try{const e="/.netlify/functions/get-student-active-tests";console.log("[DEBUG] Fetching active tests from:",e);const t=await window.tokenManager.makeAuthenticatedRequest(e);if(console.log("[DEBUG] Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(console.log("[DEBUG] Active tests data received:",r),r.success)return console.log("[DEBUG] Active tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get active tests")}catch(e){throw console.error("[ERROR] Failed to get active tests:",e),e}},async getTeacherTests(e=!1){console.log("getTeacherTests called - extracting teacherId from JWT token");try{const t="/.netlify/functions/get-teacher-active-tests",r=e?`${t}?ts=${Date.now()}`:t;console.log("[DEBUG] Fetching teacher tests from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Teacher tests data received:",s),s.success)return console.log("[DEBUG] Teacher tests retrieved successfully"),s.tests;throw new Error(s.error||"Failed to get teacher tests")}catch(t){throw console.error("[ERROR] Failed to get teacher tests:",t),t}},async submitTest(e,t,r,n={},s=null){console.log("Submitting test:",{testType:e,testId:t});try{if(Object.keys(r).length===0)throw new Error("Please answer at least one question before submitting.");let a;try{const N=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`)).json();if(N.success)a=N.test_info;else throw new Error("Failed to get test information")}catch(_){console.error("Error getting test info:",_);const N=await this.getTestQuestions(e,t);a={test_name:`Test ${t}`,num_questions:N.length}}const i=await this.getTestQuestions(e,t);let o,l;if(e==="drawing")o=null,l=null;else{const _=n?.answers_by_id?n.answers_by_id:r;o=xf(i,_,e).score,l=a.num_questions}const u=this.transformAnswersForSubmission(r,e),d=a.teacher_id||null,h=a.subject_id||null,g=s?.student_id||s?.id||(window.tokenManager?.getCurrentUser?window.tokenManager.getCurrentUser()?.student_id||window.tokenManager.getCurrentUser()?.id:null);await Qu.loadAcademicCalendar();const x=Qu.getCurrentTerm()?.id;if(!x)throw new Error("No current academic period found");const v={test_id:t,test_name:a.test_name,test_type:e,teacher_id:d,subject_id:h,student_id:g,academic_period_id:x,answers:u,score:o,maxScore:l,time_taken:n.time_taken||null,started_at:n.started_at||null,submitted_at:n.submitted_at||new Date().toISOString(),caught_cheating:n.caught_cheating||!1,visibility_change_times:n.visibility_change_times||0,answers_by_id:n.answers_by_id||null,question_order:n.question_order||null,retest_assignment_id:n.retest_assignment_id||null,parent_test_id:n.parent_test_id||t};console.log(" testService retest_assignment_id:",n.retest_assignment_id),console.log(" testService timingData:",n),console.log(" testService commonData.retest_assignment_id:",v.retest_assignment_id);let w;switch(e){case"multiple_choice":w="/.netlify/functions/submit-multiple-choice-test";break;case"true_false":w="/.netlify/functions/submit-true-false-test";break;case"input":w="/.netlify/functions/submit-input-test";break;case"matching_type":w="/.netlify/functions/submit-matching-type-test";break;case"word_matching":w="/.netlify/functions/submit-word-matching-test";break;case"drawing":w="/.netlify/functions/submit-drawing-test";break;case"fill_blanks":w="/.netlify/functions/submit-fill-blanks-test";break;default:throw new Error(`Unsupported test type: ${e}`)}console.log("Submitting to:",w),console.log("Submission data:",v),console.log("Submission data JSON:",JSON.stringify(v,null,2)),console.log(" Final submission retest_assignment_id:",v.retest_assignment_id);const C=await window.tokenManager.makeAuthenticatedRequest(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)});if(!C.ok)throw new Error(`HTTP error! status: ${C.status}`);const k=await C.json();if(console.log("Test submission result:",k),k.success)return this.clearTestProgress(e,t),{success:!0,score:o,maxScore:l,result:k};throw new Error(k.error||"Failed to submit test")}catch(a){throw console.error("Error submitting test:",a),a}},async createTest(e){try{return(await vs.post("/tests/create",e)).data}catch(t){throw new Error(t.message||"Failed to create test")}},async updateTest(e,t,r){try{return(await vs.put(`/tests/${e}/${t}`,r)).data}catch(n){throw new Error(n.message||"Failed to update test")}},async deleteTest(e,t){try{return(await vs.delete(`/tests/${e}/${t}`)).data}catch(r){throw new Error(r.message||"Failed to delete test")}},async duplicateTest(e,t){try{return(await vs.post(`/tests/${e}/${t}/duplicate`)).data}catch(r){throw new Error(r.message||"Failed to duplicate test")}},async publishTest(e,t){try{return(await vs.post(`/tests/${e}/${t}/publish`)).data}catch(r){throw new Error(r.message||"Failed to publish test")}},async unpublishTest(e,t){try{return(await vs.post(`/tests/${e}/${t}/unpublish`)).data}catch(r){throw new Error(r.message||"Failed to unpublish test")}},async removeClassAssignment(e,t,r){try{return(await vs.delete(`/tests/${e}/${t}/assignments/${r}`)).data}catch(n){throw new Error(n.message||"Failed to remove class assignment")}},async getTestStatistics(e,t){try{return(await vs.get(`/tests/${e}/${t}/statistics`)).data}catch(r){throw new Error(r.message||"Failed to get test statistics")}},async exportTest(e,t,r="json"){try{return(await vs.get(`/tests/${e}/${t}/export?format=${r}`)).data}catch(n){throw new Error(n.message||"Failed to export test")}},async importTest(e,t){try{return(await vs.uploadFile(`/tests/import?type=${t}`,e)).data}catch(r){throw new Error(r.message||"Failed to import test")}},async getTestResults(e,t){try{return(await vs.get(`/tests/${e}/${t}/results`)).data}catch(r){throw new Error(r.message||"Failed to get test results")}},async getStudentTestResults(){try{console.log("[DEBUG] Fetching student test results from: /.netlify/functions/get-student-test-results");const e=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-test-results");if(console.log("[DEBUG] Response status:",e.status),!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();if(console.log("[DEBUG] Student test results data received:",t),t.success)return console.log("[DEBUG] Student test results retrieved successfully"),t;throw new Error(t.error||"Failed to get student test results")}catch(e){throw console.error("[ERROR] Failed to get student test results:",e),new Error(e.message||"Failed to get student test results")}},async getClassResults(e,t,r){try{return(await vs.get(`/tests/class-results/${e}/${t}/${r}`)).data}catch(n){throw new Error(n.message||"Failed to get class results")}},async saveTestProgress(e,t,r){try{return(await vs.post(`/tests/${e}/${t}/progress`,{progress:r})).data}catch(n){throw new Error(n.message||"Failed to save test progress")}},async getTestProgress(e,t){try{return(await vs.get(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to get test progress")}},async clearTestProgress(e,t){try{return(await vs.delete(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to clear test progress")}},async validateTestData(e){try{return(await vs.post("/tests/validate",e)).data}catch(t){throw new Error(t.message||"Failed to validate test data")}},async getTestPreview(e,t){try{return(await vs.get(`/tests/${e}/${t}/preview`)).data}catch(r){throw new Error(r.message||"Failed to get test preview")}},isAnswerCorrect(e,t,r,n){switch(n){case"multiple_choice":return String.fromCharCode(65+parseInt(t))===r.correct_answer;case"true_false":return t.toLowerCase()==="true"===r.correct_answer;case"input":const i=r.correct_answers||[],o=t.toLowerCase().trim();return i.some(l=>{const u=l.toLowerCase().trim();return o===u?!0:u&&o.includes(u)?u.length===1?o.startsWith(u)||o.endsWith(u):!0:!1});case"matching_type":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"word_matching":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"drawing":return t&&t!=="No answer";default:return!1}},transformAnswersForSubmission(e,t){switch(t){case"multiple_choice":return e;case"true_false":return e;case"input":return e;case"matching_type":return e;case"word_matching":return e;case"drawing":if(Array.isArray(e)&&e.length>0)try{const r=e[0];return typeof r=="string"&&r.startsWith("[")?JSON.parse(r):e}catch(r){return console.warn("Failed to parse drawing answers:",r),e}return e;default:return e}},async markTestCompleted(e,t){try{console.log(`[DEBUG] markTestCompleted called with testType: ${e}, testId: ${t}`);const r=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/mark-test-completed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_type:e,test_id:t})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();if(console.log("[DEBUG] Mark test completed response:",n),n.success)return console.log(`Test ${e}_${t} marked as completed successfully`),{success:!0,message:n.message};throw new Error(n.error||"Failed to mark test as completed")}catch(r){throw console.error("Error marking test completed:",r),r}},clearTestProgress(e,t){try{const r=`test_progress_${e}_${t}`;localStorage.removeItem(r),console.log(`Test progress cleared for ${e}_${t}`)}catch(r){console.error("Error clearing test progress:",r)}},async saveMultipleChoiceTest(e){console.log("[DEBUG] saveMultipleChoiceTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-multiple-choice-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save multiple choice test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving multiple choice test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveTrueFalseTest(e){console.log("[DEBUG] saveTrueFalseTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-true-false-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save true/false test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving true/false test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveInputTest(e){console.log("[DEBUG] saveInputTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-input-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save input test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving input test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveMatchingTest(e){console.log("[DEBUG] saveMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"matching_type",num_questions:e.num_blocks})})).json();return console.log("[DEBUG] Save matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveWordMatchingTest(e){console.log("[DEBUG] saveWordMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"word_matching"})})).json();return console.log("[DEBUG] Save word matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving word matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveDrawingTest(e){console.log("[DEBUG] saveDrawingTest called with:",e);try{const t={...e,test_type:"drawing"},n=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save drawing test response:",n),n.success?{success:!0,data:{test_id:n.test_id}}:{success:!1,message:n.message||"Failed to save test"}}catch(t){return console.error("Error saving drawing test:",t),{success:!1,message:"Error saving test: "+t.message}}},async getDrawingTest(e){console.log("[DEBUG] getDrawingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-drawing-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get drawing test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting drawing test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitDrawingTest(e,t,r,n){console.log("[DEBUG] submitDrawingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-drawing-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit drawing test response:",a),a.success?{success:!0,data:a.data}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting drawing test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async updateDrawingTestScore(e,t,r){console.log("[DEBUG] updateDrawingTestScore called with:",{resultId:e,score:t,maxScore:r});try{const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-drawing-test-score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({result_id:e,score:t,max_score:r})})).json();return console.log("[DEBUG] Update drawing test score response:",s),s.success?{success:!0,data:s.data}:{success:!1,message:s.message||"Failed to update score"}}catch(n){return console.error("Error updating drawing test score:",n),{success:!1,message:"Error updating score: "+n.message}}},async getWordMatchingTest(e){console.log("[DEBUG] getWordMatchingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-word-matching-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get word matching test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting word matching test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitWordMatchingTest(e,t,r,n){console.log("[DEBUG] submitWordMatchingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit word matching test response:",a),a.success?{success:!0,result:a.result}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting word matching test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async assignTestToClasses(e){console.log("[DEBUG] assignTestToClasses called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save test with assignments response:",r),r.success?{success:!0,message:"Test assigned successfully"}:{success:!1,message:r.message||"Failed to assign test"}}catch(t){return console.error("Error assigning test to classes:",t),{success:!1,message:"Error assigning test: "+t.message}}},async removeClassAssignment(e){console.log("[DEBUG] removeClassAssignment called with assignmentId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/remove-class-assignment?assignment_id=${e}`,{method:"DELETE"})).json();return console.log("[DEBUG] Remove class assignment response:",r),r.success?{success:!0,message:"Assignment removed successfully"}:{success:!1,message:r.message||"Failed to remove assignment"}}catch(t){return console.error("Error removing class assignment:",t),{success:!1,message:"Error removing assignment: "+t.message}}}},jB=S.createContext(),PB=({children:e})=>{const[t,r]=S.useState(null),[n,s]=S.useState([]),[a,i]=S.useState({}),[o,l]=S.useState({}),[u,d]=S.useState(!1),[h,g]=S.useState(null),[p,x]=S.useState([]),[v,w]=S.useState(!1),[C,k]=S.useState(null),[_,N]=S.useState({isOpen:!1,testType:null,testId:null,testName:null,questions:[]}),[E,P]=S.useState(null),[F,A]=S.useState(0),{getItem:j,setItem:R,removeItem:U}=EB();S.useEffect(()=>{let me;return u&&E&&(me=setInterval(()=>{const Ae=Math.floor((Date.now()-E)/1e3);A(Ae)},1e3)),()=>{me&&clearInterval(me)}},[u,E]);const Y=async(me,Ae)=>{try{w(!0),k(null),console.log(`[DEBUG] loadTestForPage called with testType: ${me}, testId: ${Ae}`);const Fe=await cn.getTestInfo(me,Ae);console.log("[DEBUG] Test info retrieved:",Fe);const Me=await cn.getTestQuestions(me,Ae);console.log("[DEBUG] Test questions retrieved:",Me),r({...Fe,testType:me,testId:Ae}),s(Me),d(!0),P(Date.now()),A(0),Z(me,Ae),console.log("[DEBUG] Test loaded successfully")}catch(Fe){k(Fe.message||"Failed to load test"),console.error("Error loading test:",Fe)}finally{w(!1)}},Z=(me,Ae)=>{try{const Fe=`test_progress_${me}_${Ae}`,Me=j(Fe);Me&&(i(Me.answers||{}),l(Me.progress||{}))}catch(Fe){console.error("Error loading saved progress:",Fe)}},ae=(me,Ae,Fe,Me)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}const Oe=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${me}_${Ae}`,at={...a,[Fe]:Me},Ce={...o,[Fe]:{answered:!0,timestamp:Date.now()}};i(at),l(Ce),R(Oe,{answers:at,progress:Ce,lastSaved:Date.now()}),console.log(`Saved progress for question ${Fe}:`,Me)}catch(kt){console.error("Error saving test progress:",kt)}},ee=(me,Ae,Fe)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated())return console.warn("[WARN] Cannot get progress: No valid JWT token"),null;const kt=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${me}_${Ae}`;return j(kt)?.answers?.[Fe]||null}catch(Me){return console.error("Error getting test progress:",Me),null}},ne=(me,Ae)=>{try{if(console.log(`[DEBUG] clearTestProgress called with testType: ${me}, testId: ${Ae}`),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const Fe=window.tokenManager?.getDecodedToken()?.sub||"unknown",Me=`test_progress_${Fe}_${me}_${Ae}`;console.log(`[DEBUG] Removing localStorage key: ${Me}`);const kt=j(Me)!==null;U(Me),i({}),l({});for(let Oe=0;Oe<localStorage.length;Oe++){const at=localStorage.key(Oe);at&&at.startsWith(`test_progress_${Fe}_${me}_${Ae}_`)&&(localStorage.removeItem(at),console.log(`[DEBUG] Cleared individual question key: ${at}`))}console.log(kt?`[DEBUG] Progress cleared for test ${me}_${Ae}`:`[DEBUG] No progress found to clear for test ${me}_${Ae}`)}catch(Fe){console.error("Error clearing test progress:",Fe)}},L=async(me,Ae,Fe="")=>{try{w(!0),k(null),console.log("Submitting test:",{testType:me,testId:Ae});const Me=se(me,Ae);if(Object.keys(Me).length===0){k("Please answer at least one question before submitting.");return}let kt;try{kt=await cn.getTestInfo(me,Ae)}catch(zt){console.error("Error getting test info:",zt);const er=await cn.getTestQuestions(me,Ae);kt={test_name:`Test ${Ae}`,num_questions:er.length}}const Oe=await cn.getTestQuestions(me,Ae),at=xf(Oe,Me,me),Ce=kt.num_questions,Ve=ie(Me,me),Ze={test_id:Ae,test_name:kt.test_name,score:at,maxScore:Ce,answers:Ve},Ft=await cn.submitTest(me,Ae,Ze);if(Ft.success){if(g(Ft.result),W(me,Ae,Fe),ne(me,Ae),Fe){const zt=`student_results_table_${Fe}`;me!=="drawing"?(console.log(" TestContext: Caching test results after submission with key:",zt),us(zt,Ft.result,Ts.student_results_table)):console.log(" TestContext: Skipping cache for drawing test submission (teacher-scored).")}return Fe&&Dm(Fe,me,Ae),d(!1),Ft.results}else throw new Error(Ft.message||"Test submission failed")}catch(Me){throw k(Me.message||"Failed to submit test"),Me}finally{w(!1)}},H=(me,Ae,Fe)=>{g({testType:me,testId:Ae,answers:Fe}),d(!1)},M=()=>{r(null),s([]),i({}),l({}),d(!1),g(null),k(null),P(null),A(0)},V=(me,Ae,Fe="")=>{try{const Me=`test_completed_${Fe}_${me}_${Ae}`;return j(Me)===!0}catch(Me){return console.error("Error checking test completion:",Me),!1}},W=(me,Ae,Fe="")=>{try{const Me=`test_completed_${Fe}_${me}_${Ae}`;R(Me,!0)}catch(Me){console.error("Error marking test completed:",Me)}},I=me=>Object.keys(a).length,B=()=>{const me=I(t?.testType),Ae=n.length;return{canSubmit:me===Ae,answeredCount:me,totalQuestions:Ae}},q=()=>{t&&ne(t.testType,t.testId),M()},J=(me="")=>{try{const Ae=`student_results_table_${me}`;console.log(" TestContext: Clearing test results cache:",Ae),localStorage.removeItem(Ae),console.log(" TestContext: Test results cache cleared")}catch(Ae){console.error("Error clearing test results cache:",Ae)}},se=(me,Ae)=>({...a}),X=(me,Ae,Fe=null)=>{try{if(!me)return"No answer";switch(Ae){case"true_false":return me?"True":"False";case"multiple_choice":if(Fe&&typeof me=="string"&&!isNaN(parseInt(me))){const Me=parseInt(me),kt=`option_${String.fromCharCode(97+Me)}`,Oe=Fe[kt];if(Oe)return Oe}return String(me).toUpperCase();case"input":return String(me);case"matching_type":return typeof me=="object"?Object.entries(me).map(([Me,kt])=>`${Me}  ${kt}`).join(", "):String(me);case"word_matching":return typeof me=="object"?Object.entries(me).map(([Me,kt])=>`${Me}  ${kt}`).join(", "):String(me);case"drawing":return"Drawing submitted";default:return String(me)}}catch(Me){return console.error("Error formatting student answer:",Me),"Error displaying answer"}},ie=(me,Ae)=>{try{if(!me||typeof me!="object")return{};const Fe={};return Object.entries(me).forEach(([Me,kt])=>{if(kt!=null)switch(Ae){case"true_false":Fe[Me]=!!kt;break;case"multiple_choice":Fe[Me]=String(kt).toUpperCase();break;case"input":Fe[Me]=String(kt).trim();break;case"matching_type":typeof kt=="object"?Fe[Me]=kt:Fe[Me]=String(kt);break;case"word_matching":typeof kt=="object"?Fe[Me]=kt:Fe[Me]=String(kt);break;case"drawing":Fe[Me]=kt;break;default:Fe[Me]=kt}}),Fe}catch(Fe){return console.error("Error transforming answers for submission:",Fe),me||{}}},le=S.useCallback(async(me="")=>{try{w(!0);const Ae=`student_active_tests_${me}`,Fe=Es(Ae);if(Fe)return x(Fe),Fe;const Me=await cn.getActiveTests();return x(Me),us(Ae,Me,Ts.student_active_tests),Me}catch(Ae){return k(Ae.message||"Failed to load active tests"),x([]),[]}finally{w(!1)}},[]),ce=async()=>{try{return w(!0),await cn.getTeacherTests()}catch(me){return k(me.message||"Failed to load teacher tests"),[]}finally{w(!1)}},ke=async me=>{try{return w(!0),await cn.createTest(me)}catch(Ae){throw k(Ae.message||"Failed to create test"),Ae}finally{w(!1)}},re=async(me,Ae)=>{try{return w(!0),await cn.deleteTest(me,Ae)}catch(Fe){throw k(Fe.message||"Failed to delete test"),Fe}finally{w(!1)}},ge=async(me,Ae)=>{try{return await cn.getTestInfo(me,Ae)}catch(Fe){throw console.error("Error getting test info:",Fe),Fe}},Ne=async(me,Ae)=>{try{return await cn.getTestQuestions(me,Ae)}catch(Fe){throw console.error("Error getting test questions:",Fe),Fe}},je=async(me,Ae,Fe)=>{try{console.log("Showing test results:",{testType:me,testId:Ae,studentAnswers:Fe});const Me=await ge(me,Ae),kt=await Ne(me,Ae);It(Me,kt,me,Fe),d(!1),console.log("Test results displayed successfully")}catch(Me){console.error("Error showing test results:",Me),k("Failed to display test results"),g({testType:me,testId:Ae,answers:Fe,showResults:!0,error:"Could not load detailed results"}),d(!1)}},Ke=async(me,Ae,Fe)=>{try{w(!0);const Me=await ge(me,Ae),kt=await Ne(me,Ae);It(Me,kt,me,Fe)}catch(Me){k(Me.message||"Failed to load test results")}finally{w(!1)}},Ue=S.useCallback(async(me="")=>{try{w(!0);const Ae=`student_results_table_${me}`;console.log(" TestContext: Checking cache for key:",Ae);const Fe=Es(Ae);if(Fe)return console.log(" TestContext: Cache HIT! Using cached test results"),g(Fe),Fe;console.log(" TestContext: Cache MISS! Fetching from API");const Me=await cn.getStudentTestResults();return console.log(" TestContext: Test results loaded:",Me),console.log(" TestContext: Results data:",Me?.results||Me),console.log(" TestContext: Results length:",Me?.results?.length||0),g(Me),console.log(" TestContext: Caching test results with key:",Ae),console.log(" TestContext: Results being cached:",Me),console.log(" TestContext: Results.results being cached:",Me.results),us(Ae,Me,Ts.student_results_table),Me}catch(Ae){throw console.error("Error loading test results:",Ae),k(Ae.message||"Failed to load test results"),Ae}finally{w(!1)}},[]),It=(me,Ae,Fe,Me)=>{try{console.log("Displaying test results:",{testInfo:me,questions:Ae,testType:Fe,studentAnswers:Me});const kt=xf(Ae,Me,Fe),Oe=me?.num_questions||Ae?.length||0,at=Oe>0?Math.round(kt/Oe*100):0,Ce=at>=60,Ve=Ae.map((Ze,Ft)=>{const zt=Ze.question_id||Ze.id,er=Me[zt],hr=bm(Ze,er,Fe);return{questionNumber:Ft+1,question:Ze.question||Ze.question_text,userAnswer:X(er,Fe),correctAnswer:Yy(Ze,Fe),isCorrect:hr,questionType:Fe}});g({testInfo:me,questions:Ae,testType:Fe,studentAnswers:Me,showResults:!0,score:kt,totalQuestions:Oe,percentage:at,passed:Ce,questionAnalysis:Ve,timestamp:new Date().toISOString()}),l(Ze=>({...Ze,score:kt,totalQuestions:Oe,percentage:at,passed:Ce,lastUpdated:Date.now()})),rt(),console.log(`Test results displayed: ${kt}/${Oe} (${at}%) - ${Ce?"PASSED":"FAILED"}`)}catch(kt){console.error("Error displaying test results:",kt),k("Failed to display test results")}},rt=S.useCallback(()=>{try{console.log("Setting up test results page event listeners");const me=Oe=>{if(Oe.key==="Escape"&&q(),Oe.ctrlKey&&Oe.key==="p"&&(Oe.preventDefault(),window.print()),Oe.key==="Enter"&&h&&!h.passed){const at=document.getElementById("retake-test-button");at&&at.click()}},Ae=()=>{window.print()},Fe=()=>{if(h){const Oe=`Test: ${h.testInfo?.test_name||"Test"}
Score: ${h.score}/${h.totalQuestions} (${h.percentage}%)
Status: ${h.passed?"PASSED":"FAILED"}
Completed: ${new Date(h.timestamp).toLocaleString()}`;navigator.clipboard.writeText(Oe).then(()=>{console.log("Results copied to clipboard")}).catch(at=>{console.error("Failed to copy results:",at)})}};document.addEventListener("keydown",me);const Me=document.getElementById("print-results");Me&&Me.addEventListener("click",Ae);const kt=document.getElementById("copy-results");return kt&&kt.addEventListener("click",Fe),()=>{document.removeEventListener("keydown",me),Me&&Me.removeEventListener("click",Ae),kt&&kt.removeEventListener("click",Fe)}}catch(me){console.error("Error setting up test results page event listeners:",me)}},[q,h]),wt=async(me,Ae,Fe)=>{try{w(!0),k(null),console.log("Viewing test details:",{testType:me,testId:Ae,testName:Fe}),N({isOpen:!0,testType:me,testId:Ae,testName:Fe,questions:[],isLoading:!0});const Me=await cn.getTestQuestions(me,Ae);Me&&Me.length>0?(N({isOpen:!0,testType:me,testId:Ae,testName:Fe,questions:Me,isLoading:!1}),console.log(`Test details loaded: ${Me.length} questions`)):(k("Could not load test questions. Please try again."),N({isOpen:!0,testType:me,testId:Ae,testName:Fe,questions:[],isLoading:!1,error:"No questions available for this test"}))}catch(Me){console.error("Error loading test details:",Me),k("Error loading test details. Please try again."),N({isOpen:!0,testType:me,testId:Ae,testName:Fe,questions:[],isLoading:!1,error:Me.message||"Failed to load test details"})}finally{w(!1)}},xt=(me,Ae,Fe,Me)=>{try{console.log("Showing test details modal:",{testType:me,testId:Ae,testName:Fe,questions:Me}),N({isOpen:!0,testType:me,testId:Ae,testName:Fe,questions:Me||[],isLoading:!1,error:null})}catch(kt){console.error("Error showing test details modal:",kt),k("Failed to show test details modal")}},lt=()=>{try{console.log("Closing test details modal"),N({isOpen:!1,testType:null,testId:null,testName:null,questions:[],isLoading:!1,error:null})}catch(me){console.error("Error closing test details modal:",me)}},pt=(me,Ae)=>{try{switch(Ae){case"multiple_choice":return c.jsxs("div",{className:"answer-options",children:[c.jsx("p",{children:c.jsx("strong",{children:"Options:"})}),c.jsxs("p",{children:["A) ",me.option_a||"No text"]}),c.jsxs("p",{children:["B) ",me.option_b||"No text"]}),me.option_c&&c.jsxs("p",{children:["C) ",me.option_c]}),me.option_d&&c.jsxs("p",{children:["D) ",me.option_d]}),me.option_e&&c.jsxs("p",{children:["E) ",me.option_e]}),me.option_f&&c.jsxs("p",{children:["F) ",me.option_f]}),c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",me.correct_answer||"Not specified"]})})]});case"true_false":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",me.correct_answer?"True":"False"]})})});case"input":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",me.correct_answer||"Not specified"]})})});case"matching_type":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",me.correct_answer?JSON.stringify(me.correct_answer):"Not specified"]})})});case"word_matching":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",me.correct_answer?JSON.stringify(me.correct_answer):"Not specified"]})})});default:return c.jsx("p",{children:"Unknown question type"})}}catch(Fe){return console.error("Error formatting question answer display:",Fe),c.jsx("p",{children:"Error displaying question"})}},Rt=(me,Ae)=>{try{console.log("Navigating to test:",{testType:me,testId:Ae}),r({testType:me,testId:Ae}),d(!0),Y(me,Ae)}catch(Fe){console.error("Error navigating to test:",Fe),k("Failed to navigate to test")}},Mt=()=>{try{console.log("Hiding test sections"),r(null),s([]),i({}),l({}),d(!1),g(null),k(null)}catch(me){console.error("Error hiding test sections:",me)}},Qe=(me,Ae,Fe,Me)=>{try{console.log("Displaying test on page:",{testInfo:me,questions:Ae,testType:Fe,testId:Me}),r({...me,testType:Fe,testId:Me}),s(Ae),d(!0),Z(Fe,Me),jt(Fe,Me),nt(Fe,Me)}catch(kt){console.error("Error displaying test on page:",kt),k("Failed to display test on page")}},Re=(me,Ae,Fe)=>{try{return console.log("Rendering questions for page:",{questions:me,testType:Ae,testId:Fe}),!me||!Array.isArray(me)?(console.warn("Invalid questions array for rendering"),[]):me.map((Me,kt)=>{const Oe=at=>{const Ce={...a,[Me.question_id]:at};i(Ce),ae(Ae,Fe,Me.question_id,at)};return{question:Me,index:kt,testType:Ae,testId:Fe,studentAnswer:a[Me.question_id]||"",onAnswerChange:Oe}})}catch(Me){return console.error("Error rendering questions for page:",Me),[]}},Be=S.useCallback((me,Ae)=>{try{if(!me||!Ae){console.warn("Cannot save progress: missing testType or testId");return}const Fe=`test_progress_${me}_${Ae}`,Me={answers:a,progress:o,lastSaved:Date.now(),testType:me,testId:Ae};R(Fe,Me),console.log(`Progress saved for test ${me}_${Ae}:`,Me)}catch(Fe){console.error("Error saving progress for page:",Fe)}},[a,o,R]),ct=S.useCallback(me=>{try{return!a||Object.keys(a).length===0?0:Object.values(a).filter(Fe=>Fe==null?!1:typeof Fe=="string"?Fe.trim()!=="":typeof Fe=="object"?Object.keys(Fe).length>0:!0).length}catch(Ae){return console.error("Error getting answered questions count for page:",Ae),0}},[a]),We=S.useCallback((me,Ae)=>{try{console.log("Updating progress display for page:",{testType:me,testId:Ae});const Fe=ct(me),Me=n.length,kt=Me>0?Math.round(Fe/Me*100):0,Oe=Fe===Me&&Me>0;l(Ze=>({...Ze,answeredCount:Fe,totalQuestions:Me,percentage:kt,canSubmit:Oe,remainingQuestions:Me-Fe,lastUpdated:Date.now()}));const at=document.getElementById("progress-bar"),Ce=document.getElementById("progress-text"),Ve=document.getElementById("submit-test-button");return at&&(at.style.width=`${kt}%`,at.className=at.className.replace(/bg-\w+-\d+/,""),kt>=100?at.classList.add("bg-green-500"):kt>=80?at.classList.add("bg-blue-500"):kt>=60?at.classList.add("bg-yellow-500"):kt>=40?at.classList.add("bg-orange-500"):at.classList.add("bg-red-500")),Ce&&(Ce.textContent=`${Fe}/${Me} questions answered (${kt}%)`),Ve&&(Ve.disabled=!Oe,Oe?(Ve.textContent=" Submit Test",Ve.classList.remove("bg-gray-400"),Ve.classList.add("bg-green-600","hover:bg-green-700")):(Ve.textContent=` Complete ${Me-Fe} more question${Me-Fe!==1?"s":""}`,Ve.classList.remove("bg-green-600","hover:bg-green-700"),Ve.classList.add("bg-gray-400"))),{answeredCount:Fe,totalQuestions:Me,percentage:kt,canSubmit:Oe}}catch(Fe){return console.error("Error updating progress display for page:",Fe),{answeredCount:0,totalQuestions:0,percentage:0,canSubmit:!1}}},[n.length,ct]),nt=S.useCallback((me,Ae)=>{try{console.log("Setting up test page event listeners:",{testType:me,testId:Ae});const Fe=setInterval(()=>{Object.keys(a).length>0&&(Be(me,Ae),console.log("Auto-saved progress for test:",me,Ae))},3e4),Me=setInterval(()=>{We(me,Ae)},2e3),kt=Ze=>{Ze.key==="Escape"&&window.confirm("Are you sure you want to exit the test? Your progress will be saved.")&&q(),Ze.ctrlKey&&Ze.key==="s"&&(Ze.preventDefault(),Be(me,Ae),console.log("Manual save triggered")),Ze.key},Oe=Ze=>{Object.keys(a).length>0&&(Ze.preventDefault(),Ze.returnValue="Your test progress will be saved. Are you sure you want to leave?")},at=()=>{document.hidden&&(console.log("Tab became hidden - saving progress"),Be(me,Ae))},Ce=()=>{console.log("Window focused - updating progress"),We(me,Ae)},Ve=()=>{console.log("Window blurred - saving progress"),Be(me,Ae)};return document.addEventListener("keydown",kt),window.addEventListener("beforeunload",Oe),document.addEventListener("visibilitychange",at),window.addEventListener("focus",Ce),window.addEventListener("blur",Ve),window.testIntervals||(window.testIntervals={}),window.testIntervals[`autosave_${me}_${Ae}`]=Fe,window.testIntervals[`progress_${me}_${Ae}`]=Me,()=>{clearInterval(Fe),clearInterval(Me),document.removeEventListener("keydown",kt),window.removeEventListener("beforeunload",Oe),document.removeEventListener("visibilitychange",at),window.removeEventListener("focus",Ce),window.removeEventListener("blur",Ve),window.testIntervals&&(delete window.testIntervals[`autosave_${me}_${Ae}`],delete window.testIntervals[`progress_${me}_${Ae}`])}}catch(Fe){console.error("Error setting up test page event listeners:",Fe)}},[a,Be,We,q]),Tt=S.useCallback(()=>{try{const me=ct(t?.testType),Ae=n.length,Fe=me===Ae&&Ae>0,Me=document.getElementById("submit-test-button");return Me&&(Me.disabled=!Fe,Me.textContent=Fe?"Submit Test":`Complete ${Ae-me} more questions`),{canSubmit:Fe,answeredCount:me,totalQuestions:Ae}}catch(me){return console.error("Error updating submit button state for page:",me),{canSubmit:!1,answeredCount:0,totalQuestions:0}}},[t,n.length,ct]),jt=S.useCallback((me,Ae)=>{try{console.log("Setting up progress tracking for page:",{testType:me,testId:Ae});const Fe=setInterval(()=>{We(me,Ae),Tt()},1e3),Me=setInterval(()=>{Object.keys(a).length>0&&Be(me,Ae)},3e4);return window.testIntervals||(window.testIntervals={}),window.testIntervals[`progress_${me}_${Ae}`]=Fe,window.testIntervals[`autosave_${me}_${Ae}`]=Me,()=>{clearInterval(Fe),clearInterval(Me),window.testIntervals&&(delete window.testIntervals[`progress_${me}_${Ae}`],delete window.testIntervals[`autosave_${me}_${Ae}`])}}catch(Fe){console.error("Error setting up progress tracking for page:",Fe)}},[a,We,Tt,Be]),Vt=S.useCallback(async(me,Ae)=>{const Fe=document.getElementById("submit-test-button");try{const Me=ct(me),kt=n.length;if(Me<kt){k(`Please answer all ${kt} questions before submitting.`);return}if(!window.confirm("Are you sure you want to submit your test? This action cannot be undone."))return;Fe&&(Fe.disabled=!0,Fe.innerHTML=`
          <div class="flex items-center justify-center space-x-2">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
            <span>Submitting...</span>
          </div>
        `),await L(me,Ae)&&(ne(me,Ae),H(me,Ae,a),console.log("Test submitted successfully!"))}catch(Me){console.error("Error submitting test from page:",Me),k("Failed to submit test. Please try again."),Fe&&(Fe.disabled=!1,Fe.textContent="Submit Test")}},[ct,n.length,L,ne,H,a]),fr=S.useCallback(()=>{try{if(!t)return null;const me=["true_false","multiple_choice","input","matching_type","word_matching"];return me.includes(t.testType)?t.testType:me.includes(t.test_type)?t.test_type:null}catch(me){return console.error("Error getting current test type:",me),null}},[t]),Dr=S.useCallback((me,Ae)=>{try{console.log("Clearing progress tracking interval:",{testType:me,testId:Ae});const Fe=`progress_interval_${me}_${Ae}`,Me=`autosave_interval_${me}_${Ae}`;window.testIntervals&&(window.testIntervals[Fe]&&(clearInterval(window.testIntervals[Fe]),delete window.testIntervals[Fe]),window.testIntervals[Me]&&(clearInterval(window.testIntervals[Me]),delete window.testIntervals[Me])),console.log(`Cleared progress tracking intervals for test ${me}_${Ae}`)}catch(Fe){console.error("Error clearing progress tracking interval:",Fe)}},[]),nr={currentTest:t,testQuestions:n,studentAnswers:a,testProgress:o,isTestActive:u,testResults:h,activeTests:p,isLoading:v,error:C,testDetailsModal:_,testStartTime:E,timeElapsed:F,loadTestForPage:Y,submitTest:L,navigateToTestResults:H,navigateBackToCabinet:M,clearTestDataAndReturnToCabinet:q,saveTestProgress:ae,getTestProgress:ee,clearTestProgress:ne,loadSavedProgressForPage:Z,isTestCompleted:V,markTestCompleted:W,markTestCompletedInUI:(me,Ae)=>{console.log("Marking test completed in UI:",{testType:me,testId:Ae}),W(me,Ae)},getAnsweredQuestionsCount:I,updateSubmitButtonState:B,updateSubmitButtonStateForPage:Tt,loadStudentActiveTests:le,loadActiveTests:le,loadTeacherActiveTests:ce,getTestInfo:ge,getTestQuestions:Ne,createTest:ke,deleteTest:re,showTestResults:je,loadTestResults:Ue,loadTestResultsForPage:Ke,displayTestResultsOnPage:It,setupTestResultsPageEventListeners:rt,clearTestResultsCache:J,viewTestDetails:wt,showTestDetailsModal:xt,closeTestDetailsModal:lt,getQuestionAnswerDisplay:pt,navigateToTest:Rt,hideTestSections:Mt,displayTestOnPage:Qe,renderQuestionsForPage:Re,setupTestPageEventListeners:nt,setupProgressTrackingForPage:jt,updateProgressDisplayForPage:We,submitTestFromPage:Vt,getAnsweredQuestionsCountForPage:ct,getCurrentTestType:fr,saveProgressForPage:Be,clearProgressTrackingInterval:Dr,collectTestAnswers:se,calculateTestScore:xf,checkAnswerCorrectness:bm,formatStudentAnswerForDisplay:X,getCorrectAnswer:Yy,transformAnswersForSubmission:ie,clearAllTestData:()=>{try{console.log("Clearing old test data from localStorage (older than 15 days)...");const Ae=Date.now()-360*60*60*1e3,Fe=[];for(let Me=0;Me<localStorage.length;Me++){const kt=localStorage.key(Me);if(!(!kt||!((kt.startsWith("test_")||kt.startsWith("student_")||kt.startsWith("teacher_")||kt.startsWith("admin_")||kt.includes("progress")||kt.includes("answers"))&&!kt.includes("test_completed_"))))try{const at=localStorage.getItem(kt);if(!at){Fe.push(kt);continue}let Ce=null;if(at.startsWith("{")||at.startsWith("[")){const Ve=JSON.parse(at),Ze=Ve.timestamp||Ve.lastSaved||Ve.lastTickAt||Ve.createdAt||Ve.updatedAt||Ve.startedAt||Ve.started_at||Ve.created_at;Ze&&(Ce=new Date(Ze).getTime())}if(!Ce){const Ve=`${kt}__ts`,Ze=localStorage.getItem(Ve);Ze&&(Ce=parseInt(Ze)||null)}if(!Ce)continue;Ce<Ae&&Fe.push(kt)}catch{continue}}return Fe.forEach(Me=>{console.log(`Removing old localStorage key: ${Me}`),U(Me)}),console.log(`Cleared ${Fe.length} old test-related items from localStorage`),{success:!0,clearedCount:Fe.length}}catch(me){return console.error("Error clearing old test data:",me),{success:!1,error:me.message}}},setCurrentTest:r,setTestQuestions:s,setStudentAnswers:i,setTestProgress:l,setIsTestActive:d,setTestResults:g,setError:k};return c.jsx(jB.Provider,{value:nr,children:e})},$v=()=>{const e=S.useContext(jB);if(!e)throw new Error("useTest must be used within a TestProvider");return e},iy=window.location.hostname==="mathayomwatsing.netlify.app";iy&&(console.log=()=>{},console.debug=()=>{},console.info=()=>{},console.warn=()=>{});const pe={debug:(e,...t)=>{iy||console.log(e,...t)},warn:(e,...t)=>{iy||console.warn(e,...t)},error:(e,...t)=>{console.error(e,...t)},info:(e,...t)=>{iy||console.info(e,...t)},isEnabled:()=>!iy},Uv=({testResults:e,onBackToCabinet:t,onRetakeTest:r,isLoading:n=!1,caught_cheating:s=!1,visibility_change_times:a=0})=>{if(!e||!e.showResults)return c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"text-center",children:c.jsx("p",{className:"text-gray-500",children:"No test results to display"})})});const{testInfo:i,testType:o,score:l,totalQuestions:u,percentage:d,passed:h,questionAnalysis:g,timestamp:p}=e,x=C=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[C]||C,v=C=>C>=80?"text-green-600 bg-green-50":C>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",w=C=>C?"text-green-600 bg-green-100 border-green-200":"text-red-600 bg-red-100 border-red-200";return n?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading test results..."})]})}):c.jsx("div",{className:"bg-gray-50 py-8 overflow-y-auto",children:c.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs(st.div,{className:"bg-white rounded-lg shadow-lg p-6 mb-6",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(e?.caught_cheating||s)&&c.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mb-6",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),c.jsx("div",{className:"ml-3",children:c.jsxs("p",{className:"text-sm text-red-700",children:[c.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",e?.visibility_change_times||a||0," times during the test."]})})]})}),c.jsxs("div",{className:"flex justify-between items-start mb-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Test Results"}),c.jsx("h2",{className:"text-xl text-gray-700 mb-1",children:i?.test_name||"Test"}),c.jsxs("p",{className:"text-sm text-gray-500",children:[x(o),"  Completed on ",new Date(p).toLocaleDateString()]})]}),c.jsx("div",{className:"text-right",children:c.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium border ${w(h)}`,children:h?" PASSED":" FAILED"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsx("div",{className:"text-3xl font-bold text-gray-900",children:l}),c.jsx("div",{className:"text-sm text-gray-600",children:"Correct Answers"})]}),c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsx("div",{className:"text-3xl font-bold text-gray-900",children:u}),c.jsx("div",{className:"text-sm text-gray-600",children:"Total Questions"})]}),c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:`text-3xl font-bold ${v(d).split(" ")[0]}`,children:[d,"%"]}),c.jsx("div",{className:"text-sm text-gray-600",children:"Score"})]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-6",children:c.jsx(st.div,{className:`h-3 rounded-full ${v(d).split(" ")[1]}`,initial:{width:0},animate:{width:`${d}%`},transition:{duration:1,ease:"easeOut"}})}),c.jsx("div",{className:"flex flex-wrap gap-3",children:c.jsx(Je,{onClick:t,variant:"primary",className:"flex items-center gap-2",children:" Back to Cabinet"})})]}),o!=="matching_type"&&o!=="word_matching"&&c.jsxs(st.div,{className:"bg-white rounded-lg shadow-lg p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[c.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Question Review"}),c.jsx("div",{className:"space-y-4",children:g.map((C,k)=>c.jsxs(st.div,{className:`p-4 rounded-lg border-2 ${C.isCorrect?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:k*.1},children:[c.jsxs("div",{className:"flex items-start justify-between mb-3",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:["Question ",C.questionNumber]}),c.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${C.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:C.isCorrect?" Correct":" Incorrect"})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Question:"}),c.jsx("p",{className:"text-gray-700 bg-gray-100 p-3 rounded",children:C.question})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Your Answer:"}),c.jsx("p",{className:`p-3 rounded ${C.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:C.userAnswer||"No answer provided"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Correct Answer:"}),c.jsx("p",{className:"bg-blue-100 text-blue-800 p-3 rounded",children:C.correctAnswer})]})]})]},k))})]}),c.jsxs(st.div,{className:"bg-white rounded-lg shadow-lg p-6 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[c.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Summary Statistics"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-blue-600",children:g.filter(C=>C.isCorrect).length}),c.jsx("div",{className:"text-sm text-blue-600",children:"Correct"})]}),c.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-red-600",children:g.filter(C=>!C.isCorrect).length}),c.jsx("div",{className:"text-sm text-red-600",children:"Incorrect"})]}),c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:"text-2xl font-bold text-gray-600",children:[Math.round(g.filter(C=>C.isCorrect).length/u*100),"%"]}),c.jsx("div",{className:"text-sm text-gray-600",children:"Accuracy"})]}),c.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-purple-600",children:u}),c.jsx("div",{className:"text-sm text-purple-600",children:"Total"})]})]})]})]})})},FB=({isOpen:e,onClose:t,testType:r,testId:n,testName:s,questions:a=[],isLoading:i=!1})=>{if(!e)return null;const o=h=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[h]||h,l=h=>({multiple_choice:"",true_false:"",input:"",matching_type:""})[h]||"",u=(h,g)=>{switch(g){case"multiple_choice":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),c.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[h.option_a&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"A"}),c.jsx("span",{className:"text-gray-700",children:h.option_a})]}),h.option_b&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"B"}),c.jsx("span",{className:"text-gray-700",children:h.option_b})]}),h.option_c&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"C"}),c.jsx("span",{className:"text-gray-700",children:h.option_c})]}),h.option_d&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"D"}),c.jsx("span",{className:"text-gray-700",children:h.option_d})]}),h.option_e&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"E"}),c.jsx("span",{className:"text-gray-700",children:h.option_e})]}),h.option_f&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),c.jsx("span",{className:"text-gray-700",children:h.option_f})]})]})]});case"true_false":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"T"}),c.jsx("span",{className:"text-gray-700",children:"True"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),c.jsx("span",{className:"text-gray-700",children:"False"})]})]})]});case"input":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Answer Format:"}),c.jsx("div",{className:"bg-gray-100 p-3 rounded",children:c.jsx("span",{className:"text-gray-600 italic",children:"Type your answer in the text input field"})})]});case"matching_type":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Instructions:"}),c.jsx("div",{className:"bg-gray-100 p-3 rounded",children:c.jsx("span",{className:"text-gray-600 italic",children:"Match the items by connecting them with lines or selecting pairs"})})]});default:return null}},d=(h,g)=>{if(!h.correct_answer)return null;let p="";switch(g){case"multiple_choice":p=h.correct_answer.toUpperCase();break;case"true_false":p=h.correct_answer?"True":"False";break;case"input":p=h.correct_answer;break;case"matching_type":p=typeof h.correct_answer=="object"?JSON.stringify(h.correct_answer):h.correct_answer;break;default:p=String(h.correct_answer)}return c.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded",children:[c.jsx("p",{className:"font-medium text-green-800 mb-1",children:"Correct Answer:"}),c.jsx("p",{className:"text-green-700 font-mono",children:p})]})};return c.jsx(fo,{children:c.jsxs(st.div,{className:"fixed inset-0 z-50 overflow-y-auto",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[c.jsx(st.div,{className:"fixed inset-0 bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t}),c.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:c.jsxs(st.div,{className:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.3},children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("span",{className:"text-2xl",children:l(r)}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s||"Test Details"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[o(r),"  ",a.length," Questions"]})]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Je,{onClick:()=>window.print(),variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Print"}),c.jsx(Je,{onClick:t,variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Close"})]})]}),c.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:i?c.jsx("div",{className:"flex items-center justify-center py-12",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading test details..."})]})}):a.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx("div",{className:"text-6xl mb-4",children:""}),c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Questions Available"}),c.jsx("p",{className:"text-gray-500",children:"This test doesn't have any questions yet."})]}):c.jsx("div",{className:"space-y-6",children:a.map((h,g)=>c.jsxs(st.div,{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:g*.1,duration:.3},children:[c.jsx("div",{className:"flex items-start justify-between mb-4",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full",children:["Question ",g+1]}),c.jsx("span",{className:"text-gray-500 text-sm",children:o(r)})]})}),c.jsx("div",{className:"mb-4",children:c.jsx("p",{className:"text-gray-800 font-medium text-lg leading-relaxed",children:h.question||h.question_text})}),u(h,r),d(h,r)]},h.id||h.question_id||g))})}),c.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[c.jsx("div",{className:"text-sm text-gray-600",children:a.length>0&&c.jsxs("span",{children:["Showing ",a.length," question",a.length!==1?"s":""]})}),c.jsx("div",{className:"flex items-center space-x-3",children:c.jsx(Je,{onClick:t,variant:"primary",className:"flex items-center space-x-2",children:"Close"})})]})]})})]})})},lae=({answeredCount:e=0,totalQuestions:t=0,timeElapsed:r=0,onSubmitTest:n,isSubmitting:s=!1,canSubmit:a=!1,className:i=""})=>{const o=t>0?Math.round(e/t*100):0,l=t-e,u=g=>{const p=Math.floor(g/3600),x=Math.floor(g%3600/60),v=g%60;return p>0?`${p}:${x.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}`:`${x}:${v.toString().padStart(2,"0")}`},d=g=>g>=100?"bg-green-500":g>=80?"bg-blue-500":g>=60?"bg-yellow-500":g>=40?"bg-orange-500":"bg-red-500",h=g=>g>=100?"text-green-600":g>=80?"text-blue-600":g>=60?"text-yellow-600":g>=40?"text-orange-600":"text-red-600";return c.jsxs("div",{className:`bg-white rounded-lg shadow-lg p-6 ${i}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Progress"}),c.jsx("div",{className:"flex items-center space-x-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-2xl",children:""}),c.jsx("span",{className:"text-sm font-mono text-gray-600",children:u(r)})]})})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),c.jsxs("span",{className:`text-sm font-semibold ${h(o)}`,children:[o,"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:c.jsx(st.div,{className:`h-full ${d(o)} transition-colors duration-300`,initial:{width:0},animate:{width:`${o}%`},transition:{duration:.5,ease:"easeOut"}})})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 mb-4",children:[c.jsxs("div",{className:"text-center p-2 sm:p-3 bg-blue-50 rounded-lg",children:[c.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:e}),c.jsx("div",{className:"text-xs text-blue-600",children:"Answered"})]}),c.jsxs("div",{className:"text-center p-2 sm:p-3 bg-gray-50 rounded-lg",children:[c.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-600",children:l}),c.jsx("div",{className:"text-xs text-gray-600",children:"Remaining"})]}),c.jsxs("div",{className:"text-center p-2 sm:p-3 bg-purple-50 rounded-lg",children:[c.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:t}),c.jsx("div",{className:"text-xs text-purple-600",children:"Total"})]})]}),c.jsx("div",{className:"mb-4",children:e===t?c.jsx(st.div,{className:"flex items-center justify-center p-3 bg-green-50 border border-green-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:c.jsx("span",{className:"text-green-600 font-medium",children:" All questions answered! Ready to submit."})}):l===1?c.jsx(st.div,{className:"flex items-center justify-center p-3 bg-yellow-50 border border-yellow-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:c.jsx("span",{className:"text-yellow-600 font-medium",children:"Almost there! 1 question remaining."})}):c.jsx("div",{className:"flex items-center justify-center p-3 bg-gray-50 border border-gray-200 rounded-lg",children:c.jsxs("span",{className:"text-gray-600 font-medium",children:[l," questions remaining"]})})}),a&&c.jsx("div",{className:"flex justify-center",children:c.jsx(st.button,{onClick:n,disabled:s,className:`px-8 py-3 rounded-lg font-semibold text-white transition-all duration-300 ${s?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 shadow-lg hover:shadow-xl"}`,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},children:s?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),c.jsx("span",{children:"Submitting..."})]}):c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{children:""}),c.jsx("span",{children:"Submit Test"})]})})})]})},cae=({testText:e,blanks:t,separateType:r=!0,testId:n,testName:s="Unknown Test",teacherId:a="Unknown Teacher",subjectId:i,onTestComplete:o,onAnswerChange:l})=>{if(console.log(" FillBlanksTestStudent Props Debug:"),console.log("- testText:",e),console.log("- blanks:",t),console.log("- separateType:",r),console.log("- testId:",n),console.log("- testName:",s),console.log("- teacherId:",a),console.log("- subjectId:",i),!e||!t||!Array.isArray(t))return console.log(" FillBlanksTestStudent: Missing test data"),c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(At,{className:"max-w-md w-full",children:c.jsxs(At.Body,{className:"text-center",children:[c.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load fill blanks test data"}),c.jsx(Je,{onClick:()=>window.history.back(),variant:"primary",children:"Back to Dashboard"})]})})});const[u,d]=S.useState({}),[h,g]=S.useState(!1),[p,x]=S.useState(null),[v,w]=S.useState(null),[C,k]=S.useState(!1),[_,N]=S.useState(null),{showNotification:E}=Da(),{makeAuthenticatedRequest:P}=Wo(),{user:F}=Qn(),{startTracking:A,stopTracking:j,getCheatingData:R,clearData:U}=qm("fill_blanks",n,F?.student_id||F?.id);t2();const Y=S.useCallback((ne,L)=>{try{let H=ne;if(typeof ne=="string"&&ne.startsWith("{"))try{const I=JSON.parse(ne);I.root&&I.root.children&&(H=I.root.children.map(B=>B.children?B.children.map(q=>q.style&&q.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":q.text||"").join(""):"").join(" "))}catch(I){console.error("Error parsing Lexical JSON:",I)}let M=H;L.forEach((I,B)=>{const q=`[${B+1}_________]`;M=M.replace("[BLANK_PLACEHOLDER]",q)});const W=M.split(/(\[\d+_________\])/).map((I,B)=>I.match(/\[\d+_________\]/)?c.jsx("span",{className:"inline-block px-3 py-1 mx-1 bg-purple-100 text-purple-800 border-2 border-purple-400 rounded-lg font-mono font-bold shadow-sm",children:I},B):c.jsx("span",{children:I},B));return c.jsx("div",{className:"prose max-w-none mb-6",children:c.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:W})})}catch(H){return console.error("Error rendering text with blanks:",H),c.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[]),Z=S.useCallback((ne,L)=>{try{let H=ne;if(typeof ne=="string"&&ne.startsWith("{"))try{const I=JSON.parse(ne);I.root&&I.root.children&&(H=I.root.children.map(B=>B.children?B.children.map(q=>q.style&&q.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":q.text||"").join(""):"").join(" "))}catch(I){console.error("Error parsing Lexical JSON:",I)}const M=[];L.forEach((I,B)=>{const q=u[I.id],J=q?I.options[q.charCodeAt(0)-65]:null,se=J?c.jsx("span",{className:"inline-block px-3 py-2 bg-green-100 text-green-800 rounded-lg border-2 border-green-400 cursor-pointer hover:bg-green-200 hover:border-green-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>w(I.id),children:J},B):c.jsxs("span",{className:"inline-block px-3 py-2 bg-purple-100 text-purple-800 rounded-lg border-2 border-purple-400 cursor-pointer hover:bg-purple-200 hover:border-purple-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>w(I.id),children:[B+1,"_________"]},B);M.push(se),H=H.replace("[BLANK_PLACEHOLDER]",`__BLANK_${I.id}__`)});const V=H.split(/__BLANK_\d+__/),W=[];for(let I=0;I<V.length;I++)V[I]&&W.push(c.jsx("span",{children:V[I]},`text-${I}`)),I<M.length&&W.push(M[I]);return c.jsx("div",{className:"prose max-w-none mb-6",children:c.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:W})})}catch(H){return console.error("Error rendering text with inline blanks:",H),c.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[u]),ae=S.useCallback((ne,L)=>{const H={...u,[ne]:L};d(H),l&&l(ne,L)},[u,l]),ee=S.useCallback(ne=>c.jsx("div",{className:"space-y-6",children:ne.map((L,H)=>{const M=L.blank_options||L.options||[];L.correct_answers;const V=L.question_json||L.question||`Blank ${H+1}`;return console.log(` Blank ${H+1} question text:`,V),c.jsxs(At,{className:"p-4",children:[c.jsxs("div",{className:"mb-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",H+1]}),c.jsx("p",{className:"text-gray-600 mb-4",children:V})]}),c.jsx("div",{className:"space-y-3",children:M.filter(W=>W&&W.trim().length>0).map((W,I)=>c.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-gray-50 p-2 rounded-lg transition-colors",children:[c.jsx("input",{type:"radio",name:`blank_${L.question_id||L.id||H}`,value:String.fromCharCode(65+I),checked:u[L.question_id||L.id||H]===String.fromCharCode(65+I),onChange:B=>ae(L.question_id||L.id||H,B.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),c.jsxs("span",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+I)}),c.jsx("span",{className:"text-gray-700",children:W})]})]},I))})]},L.question_id||L.id||H)})}),[u,ae]);return S.useEffect(()=>{if(n&&F?.student_id){x(new Date),A(),console.log(" Anti-cheating tracking started for fill blanks test");const L=`test_progress_${F.student_id}_fill_blanks_${n}`,H=Es(L);H&&(d(H.answers||{}),x(new Date(H.startTime)),console.log(" Fill blanks test progress restored:",H))}},[n,F?.student_id,t,A]),S.useEffect(()=>{if(p&&F?.student_id&&n){const ne=setInterval(()=>{const L={answers:u,startTime:p.toISOString()},H=`test_progress_${F.student_id}_fill_blanks_${n}`;us(H,L,Ts.test_progress),console.log(" Fill blanks progress auto-saved")},3e4);return()=>clearInterval(ne)}},[p,u,F?.student_id,n]),S.useEffect(()=>()=>{j(),U(),console.log(" Fill blanks test component unmounted - anti-cheating cleanup")},[j,U]),S.useCallback(async()=>{g(!0);try{const ne=t.length;let L=0;t.forEach((ge,Ne)=>{const je=u[ge.id];je&&je===ge.correct_answer&&L++});const H=L,M=ne;console.log(` Fill Blanks Score: ${H}/${M} (${Math.round(H/M*100)}%)`);const V=new Date,W=p?Math.round((V-p)/1e3):0,I=p?p.toISOString():V.toISOString(),B=R();console.log(" Anti-cheating data for fill blanks submission:",B);const q=F.student_id,J=`retest_assignment_id_${q}_fill_blanks_${n}`,se=localStorage.getItem(J),{academicCalendarService:X}=await Gi(async()=>{const{academicCalendarService:ge}=await Promise.resolve().then(()=>n2);return{academicCalendarService:ge}},void 0);await X.loadAcademicCalendar();const le=X.getCurrentTerm()?.id;if(!le)throw new Error("No current academic period found");const ce={test_id:n,test_name:s,teacher_id:a||null,subject_id:i||null,student_id:q,academic_period_id:le,parent_test_id:n,retest_assignment_id:se?Number(se):null,answers:u,score:H,maxScore:M,time_taken:W,started_at:I,submitted_at:V.toISOString(),caught_cheating:B.caught_cheating,visibility_change_times:B.visibility_change_times};console.log(" Submitting fill blanks test:",ce);const re=await(await P("/.netlify/functions/submit-fill-blanks-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ce)})).json();if(re.success){if(E("Test submitted successfully!","success"),j(),U(),console.log(" Anti-cheating tracking stopped and data cleared for fill blanks test"),F?.student_id&&(Dm(F.student_id,"fill_blanks",n),console.log(" Fill blanks test data cleared from cache")),F?.student_id){const ge=`test_completed_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(ge,"true"),console.log(" Fill blanks test marked as completed in localStorage:",ge);const Ne=`retest1_${q}_fill_blanks_${n}`;localStorage.removeItem(Ne),localStorage.removeItem(J)}if(F?.student_id){const ge=`student_results_table_${F.student_id}`;us(ge,re,Ts.student_results_table),console.log(" Fill blanks test results cached with key:",ge)}setShowSubmitModal(!1),setTimeout(()=>{o&&o(H)},2e3)}else throw new Error(re.message||"Failed to submit test")}catch(ne){console.error("Error submitting test:",ne),E("Error submitting test. Please try again.","error")}finally{g(!1)}},[u,t,n,s,a,i,p,R,j,U,P,E,o,F]),c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:c.jsxs(At,{children:[h&&c.jsx(At.Header,{children:c.jsx("div",{className:"flex items-center justify-center",children:c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[c.jsx(Ur,{size:"small"}),c.jsx("span",{children:"Submitting..."})]})})}),c.jsx(At.Body,{children:r===!0?c.jsxs(c.Fragment,{children:[Y(e,t),ee(t)]}):c.jsx(c.Fragment,{children:Z(e,t)})}),r===!1&&v&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Select Answer"}),c.jsx("div",{className:"space-y-2",children:t.find(ne=>ne.id===v)?.options.filter(ne=>ne.trim().length>0).map((ne,L)=>c.jsxs("button",{onClick:()=>{ae(v,String.fromCharCode(65+L)),w(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-100 rounded-lg border border-gray-200",children:[c.jsxs("span",{className:"font-semibold text-blue-600 mr-2",children:[String.fromCharCode(65+L),")"]}),ne]},L))}),c.jsx("div",{className:"mt-4 flex justify-end",children:c.jsx(Je,{onClick:()=>w(null),variant:"secondary",size:"sm",children:"Cancel"})})]})}),c.jsx(At.Footer,{children:c.jsx("div",{className:"flex gap-3"})})]})})};let uae=class{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}setToken(t){localStorage.setItem(this.tokenKey,t)}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){this.setToken(t),this.setUserData({role:r}),localStorage.setItem("accessToken",t)}isAuthenticated(){const t=this.getToken();if(!t)return!1;try{const r=JSON.parse(atob(t.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const t=this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(t,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json();return this.setToken(n.accessToken),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(t){try{return JSON.parse(atob(t.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}};const _m=new uae;window.tokenManager=_m;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{_m.init()}):_m.init());const OB=async(e,t,r,n,s=!1)=>{try{console.log(" Fetching teacher student results:",{teacherId:e,grade:t,className:r,termId:n,forceRefresh:s});const a=s?`&_t=${Date.now()}`:"",o=await(await _m.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-student-results?teacher_id=${e}&grade=${t}&class=${r}&academic_period_id=${n}${a}`,{cache:s?"no-cache":"default",headers:s?{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"}:{}})).json();if(o.success)return console.log(" Teacher student results loaded:",o.results.length,"results"),console.log(" Students loaded:",o.students?.length||0,"students"),{success:!0,results:o.results,students:o.students||[],count:o.results.length,student_count:o.student_count||0};throw new Error(o.error||"Failed to load teacher student results")}catch(a){return console.error("Error fetching teacher student results:",a),{success:!1,error:a.message,results:[]}}},DB=async(e,t)=>{try{console.log(" Fetching student results view:",{studentId:e,academicPeriodId:t});const r=t?`&academic_period_id=${t}`:"",s=await(await _m.makeAuthenticatedRequest(`/.netlify/functions/get-student-results-view?student_id=${e}${r}`)).json();if(s.success)return console.log(" Student results view loaded:",s.results.length,"results"),{success:!0,results:s.results,count:s.results.length};throw new Error(s.error||"Failed to load student results view")}catch(r){return console.error("Error fetching student results view:",r),{success:!1,error:r.message,results:[]}}},dae=async(e,t,r,n)=>{try{console.log(" Fetching class summary:",{teacherId:e,grade:t,className:r,academicPeriodId:n});const a=await(await _m.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary?teacher_id=${e}&grade=${t}&class=${r}&academic_period_id=${n}`)).json();if(a.success)return console.log(" Class summary loaded:",a.summary),{success:!0,summary:a.summary,hasData:!!a.summary};throw new Error(a.error||"Failed to load class summary")}catch(s){return console.error("Error fetching class summary:",s),{success:!1,error:s.message,summary:null}}},fae=async(e,t,r,n,s={})=>{try{const a=await OB(e,t,r,n);if(!a.success)return a;let i=a.results;return s.subject&&(i=i.filter(o=>o.subject&&o.subject.toLowerCase().includes(s.subject.toLowerCase()))),s.testType&&(i=i.filter(o=>o.test_type===s.testType)),s.minScore!==void 0&&(i=i.filter(o=>o.score/o.max_score*100>=s.minScore)),s.maxScore!==void 0&&(i=i.filter(o=>o.score/o.max_score*100<=s.maxScore)),s.passed!==void 0&&(i=i.filter(o=>o.score>=o.passing_score===s.passed)),{success:!0,results:i,count:i.length,originalCount:a.results.length}}catch(a){return console.error("Error filtering teacher student results:",a),{success:!1,error:a.message,results:[]}}},hae=async(e,t,r={})=>{try{const n=await DB(e,t);if(!n.success)return n;let s=n.results;return r.subject&&(s=s.filter(a=>a.subject&&a.subject.toLowerCase().includes(r.subject.toLowerCase()))),r.testType&&(s=s.filter(a=>a.test_type===r.testType)),r.semester&&(s=s.filter(a=>a.semester===r.semester)),r.passed!==void 0&&(s=s.filter(a=>a.score>=a.passing_score===r.passed)),{success:!0,results:s,count:s.length,originalCount:n.results.length}}catch(n){return console.error("Error filtering student results view:",n),{success:!1,error:n.message,results:[]}}},gae={getTeacherStudentResults:OB,getStudentResultsView:DB,getClassSummary:dae,getTeacherStudentResultsFiltered:fae,getStudentResultsViewFiltered:hae};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mae=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),pae=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),pF=e=>{const t=pae(e);return t.charAt(0).toUpperCase()+t.slice(1)},RB=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),xae=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var yae={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vae=S.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},l)=>S.createElement("svg",{ref:l,...yae,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:RB("lucide",s),...!a&&!xae(o)&&{"aria-hidden":"true"},...o},[...i.map(([u,d])=>S.createElement(u,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ym=(e,t)=>{const r=S.forwardRef(({className:n,...s},a)=>S.createElement(vae,{ref:a,iconNode:t,className:RB(`lucide-${mae(pF(e))}`,`lucide-${e}`,n),...s}));return r.displayName=pF(e),r};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wae=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],bae=Ym("download",wae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ae=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Sae=Ym("maximize-2",_ae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kae=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Cae=Ym("rotate-cw",kae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tae=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],IB=Ym("x",Tae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eae=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Nae=Ym("zoom-in",Eae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aae=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],jae=Ym("zoom-out",Aae),Kl={WIDTH:1536,HEIGHT:2048,ASPECT_RATIO:1536/2048},MB={MIN:.25,MAX:1,INITIAL:.25,STEP:.1},wh={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",ERASER:"eraser"},xF={CURSOR_COLOR:"#ff0000",CURSOR_OPACITY:.3},yF={ERASER_TO_THICKNESS_RATIO:2.5,THICKNESS_TO_ERASER_RATIO:.4},Rb={MAX_ENTRIES:10,MAX_MEMORY_KB:500,COMPRESSION_THRESHOLD:200},LB=e=>{try{const t=JSON.stringify(e);return new Blob([t]).size/1024}catch(t){return console.warn("Error calculating memory usage:",t),0}},Pae=e=>Array.isArray(e)?e.map(t=>Array.isArray(t)?Fae(t):t):e,Fae=e=>{if(e.length<=2)return e;const t=[e[0]],r=2;for(let n=1;n<e.length-1;n++){const s=e[n-1],a=e[n];e[n+1],Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))>r&&t.push(a)}return t.push(e[e.length-1]),t},Oae=(e,t=Date.now())=>{const r=LB(e);return{data:[...e],timestamp:t,memoryUsage:r,compressed:r>Rb.COMPRESSION_THRESHOLD}},vF=(e,t,r)=>{const n=Oae(t),s=LB(t),a=e.slice(0,r+1);a.push(n);let i=a;return s>Rb.MAX_MEMORY_KB&&(i=Dae(a)),i.length>Rb.MAX_ENTRIES&&(i=i.slice(-10)),{history:i,index:i.length-1}},Dae=e=>e.map(t=>t.memoryUsage>Rb.COMPRESSION_THRESHOLD?{...t,data:Pae(t.data),compressed:!0}:t),wF=(e,t)=>{if(t<0||t>=e.length)return[];const r=e[t];return r?r.compressed?Rae(r.data):[...r.data]:[]},Rae=e=>[...e],bF=e=>e>0,_F=(e,t)=>e<t-1,Iae=()=>({history:[],index:-1}),Mae=()=>{const[e,t]=S.useState({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null}),[r,n]=S.useState([]),[s,a]=S.useState([]),i=S.useCallback(E=>{t(P=>({...P,...E}))},[]),o=S.useCallback(()=>{t({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null})},[]),l=S.useCallback(E=>{const P={x:E.x,y:E.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(F=>({...F,isDrawing:!0,currentLine:[P]})):["line","rectangle","circle"].includes(e.currentTool)&&t(F=>({...F,isDrawing:!0,currentShape:{type:e.currentTool,startX:E.x,startY:E.y,endX:E.x,endY:E.y,color:e.currentColor,thickness:e.currentThickness}}))},[e.currentTool,e.currentColor,e.currentThickness]),u=S.useCallback(E=>{if(!e.isDrawing)return;const P={x:E.x,y:E.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(F=>({...F,currentLine:[...F.currentLine,P]})):e.currentShape&&t(F=>({...F,currentShape:{...F.currentShape,endX:E.x,endY:E.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape]),d=S.useCallback(()=>{if(!e.isDrawing)return;let E=r;if(e.currentTool==="pencil"&&e.currentLine.length>0?(E=[...r,e.currentLine],n(E)):e.currentShape&&(E=[...r,e.currentShape],n(E)),E!==r){const P=vF(e.drawingHistory,E,e.historyIndex);t(F=>({...F,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:P.history,historyIndex:P.index}))}else t(P=>({...P,isDrawing:!1,currentLine:[],currentShape:null}))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape,r,e.drawingHistory,e.historyIndex]),h=S.useCallback(E=>Math.round(E*yF.ERASER_TO_THICKNESS_RATIO),[]),g=S.useCallback(E=>Math.round(E*yF.THICKNESS_TO_ERASER_RATIO),[]),p=S.useCallback(E=>{t(P=>({...P,currentThickness:E,eraserSize:h(E)}))},[h]),x=S.useCallback(E=>{t(P=>({...P,eraserSize:E,currentThickness:g(E)}))},[g]),v=S.useCallback(E=>{const P=vF(e.drawingHistory,E,e.historyIndex);t(F=>({...F,drawingHistory:P.history,historyIndex:P.index}))},[e.drawingHistory,e.historyIndex]),w=S.useCallback(()=>{if(bF(e.historyIndex)){const E=e.historyIndex-1,P=wF(e.drawingHistory,E);n([...P]),t(F=>({...F,historyIndex:E}))}},[e.historyIndex,e.drawingHistory]),C=S.useCallback(()=>{if(_F(e.historyIndex,e.drawingHistory.length)){const E=e.historyIndex+1,P=wF(e.drawingHistory,E);n([...P]),t(F=>({...F,historyIndex:E}))}},[e.historyIndex,e.drawingHistory]),k=S.useCallback(()=>{const E=Iae();t(P=>({...P,drawingHistory:E.history,historyIndex:E.index}))},[]),_=bF(e.historyIndex),N=_F(e.historyIndex,e.drawingHistory.length);return{drawingState:e,setDrawingState:t,drawingData:r,setDrawingData:n,textBoxes:s,setTextBoxes:a,updateDrawingState:i,resetDrawingState:o,startDrawing:l,continueDrawing:u,finishDrawing:d,handleThicknessChange:p,handleEraserSizeChange:x,saveToHistoryState:v,undo:w,redo:C,clearHistoryState:k,canUndoState:_,canRedoState:N}},SF={SCALE_DELTA:.05,CENTER_DELTA:20},Qg=e=>{if(e.length<2)return 0;const t=e[0],r=e[1];return Math.sqrt(Math.pow(r.clientX-t.clientX,2)+Math.pow(r.clientY-t.clientY,2))},rf=e=>{if(e.length<2)return null;const t=e[0],r=e[1];return{x:(t.clientX+r.clientX)/2,y:(t.clientY+r.clientY)/2}},Lae=(e,t)=>{if(e.length!==2||!t)return null;const r=Qg(e),n=Qg(t),s=rf(e),a=rf(t);if(n===0)return null;const i=Math.abs(r/n-1),o=Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2));return i>SF.SCALE_DELTA?"zoom":o>SF.CENTER_DELTA?"pan":null},Bae=e=>{let t;return function(){const r=arguments,n=this;t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{e.apply(n,r),t=null})}},zg=(e,t)=>{const r=t.getPointerPosition();return{x:(r.x-t.x())/t.scaleX(),y:(r.y-t.y())/t.scaleY()}},il={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",PAN:"pan"},Ib={color:"#000000",thickness:2},kF=(e,t,r)=>({x:e.x,y:e.y,color:t||Ib.color,thickness:r||Ib.thickness}),$ae=(e,t,r,n,s)=>({type:e,startX:t.x,startY:t.y,endX:r.x,endY:r.y,color:n||Ib.color,thickness:s||Ib.thickness}),BB=(e,t,r,n,s,a)=>{const i=e-r,o=t-n,l=s-r,u=a-n,d=i*l+o*u,h=l*l+u*u;let g=-1;h!==0&&(g=d/h);let p,x;g<0?(p=r,x=n):g>1?(p=s,x=a):(p=r+g*l,x=n+g*u);const v=e-p,w=t-x;return Math.sqrt(v*v+w*w)},Uae=(e,t)=>{if(t.length===0)return[e];const r=t.sort((a,i)=>a.index-i.index),n=[];let s=0;for(const a of r)a.index>s&&n.push(e.slice(s,a.index+1)),s=a.index+1;return s<e.length&&n.push(e.slice(s)),n.filter(a=>a.length>0)},zae=(e,t,r,n)=>{const s=[],a=r/2;for(let i=0;i<n.length-1;i++){const o=n[i],l=n[i+1],u=BB(e,t,o.x,o.y,l.x,l.y);u<=a&&s.push({index:i,point:{x:o.x,y:o.y},distance:u})}return s},Wae=(e,t,r,n)=>{const s=zae(t,r,n,e);return s.length===0?[e]:Uae(e,s)},Hae=(e,t,r,n)=>{if(n.type==="rectangle"){const s=Math.min(n.startX,n.endX),a=Math.min(n.startY,n.endY),i=Math.abs(n.endX-n.startX),o=Math.abs(n.endY-n.startY);return e>=s&&e<=s+i&&t>=a&&t<=a+o}else if(n.type==="circle"){const s=(n.startX+n.endX)/2,a=(n.startY+n.endY)/2,i=Math.sqrt(Math.pow(n.endX-n.startX,2)+Math.pow(n.endY-n.startY,2))/2;return Math.sqrt(Math.pow(e-s,2)+Math.pow(t-a,2))<=i}return!1},CF=(e,t,r,n)=>{const s=[];for(const a of n)if(Array.isArray(a)){const i=Wae(a,e,t,r);s.push(...i)}else a.type==="line"?BB(e,t,a.startX,a.startY,a.endX,a.endY)>r/2&&s.push(a):(a.type==="rectangle"||a.type==="circle")&&(Hae(e,t,r,a)||s.push(a));return s},Gae=(e,t,r,n,s,a,i,o,l)=>{const[u,d]=S.useState({isActive:!1,type:null,lastDistance:null,lastCenter:null}),h=S.useCallback(P=>{if(P.evt.preventDefault(),P.evt.stopPropagation(),e.currentTool===il.PAN)return;const F=P.target.getStage(),A=zg(P,F),j=kF(A,e.currentColor,e.currentThickness);e.currentTool===il.PENCIL?t(R=>({...R,isDrawing:!0,currentLine:[j]})):[il.LINE,il.RECTANGLE,il.CIRCLE].includes(e.currentTool)&&t(R=>({...R,isDrawing:!0,currentShape:$ae(e.currentTool,A,A,e.currentColor,e.currentThickness)}))},[e.currentTool,e.currentColor,e.currentThickness,t]),g=S.useCallback(P=>{const F=CF(P.x,P.y,e.eraserSize,r);n(F),s(F)},[e.eraserSize,r,n,s]),p=S.useCallback(P=>{o&&(a(),v("Undo",P))},[o,a]),x=S.useCallback(P=>{l&&(i(),v("Redo",P))},[l,i]),v=S.useCallback((P,F)=>{const A=F.target.getStage(),j=zg(F,A),R=new Konva.Circle({x:j.x,y:j.y,radius:20,stroke:"#4CAF50",strokeWidth:3,opacity:.8,listening:!1});A.add(R),R.to({scaleX:2,scaleY:2,opacity:0,duration:.3,onFinish:()=>{R.destroy()}})},[]),w=S.useCallback(P=>{if(P.evt.preventDefault(),P.evt.stopPropagation(),!e.isDrawing)return;const F=P.target.getStage(),A=zg(P,F),j=kF(A,e.currentColor,e.currentThickness);e.currentTool===il.PENCIL?t(R=>({...R,currentLine:[...R.currentLine,j]})):e.currentShape&&t(R=>({...R,currentShape:{...R.currentShape,endX:A.x,endY:A.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape,t]),C=S.useCallback(P=>{P&&P.evt&&(P.evt.preventDefault(),P.evt.stopPropagation()),e.isDrawing&&(e.currentTool===il.PENCIL&&e.currentLine.length>0?n(F=>[...F,e.currentLine]):e.currentShape&&n(F=>[...F,e.currentShape]),t(F=>({...F,isDrawing:!1,currentLine:[],currentShape:null})))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape,n,t]),k=S.useCallback(P=>{P.evt.preventDefault(),P.evt.stopPropagation();const F=P.evt.touches;if(F.length===2)d({isActive:!0,type:"pan",lastDistance:Qg(F),lastCenter:rf(F)});else if(F.length===1)if(e.currentTool===il.ERASER){const A=P.target.getStage(),j=zg(P,A);g(j)}else e.currentTool===il.UNDO?p(P):e.currentTool===il.REDO?x(P):h(P)},[Qg,rf,h,e.currentTool,g,p,x]),_=S.useCallback(Bae(P=>{P.evt.preventDefault(),P.evt.stopPropagation();const F=P.evt.touches;if(F.length===2&&u.isActive){const A=Lae(F,u);if(A==="zoom"){const j=Qg(F),R=rf(F),U=j/u.lastDistance,Y=Math.max(.25,Math.min(1,e.zoom*U));t(Z=>({...Z,zoom:Y,position:{x:R.x-(R.x-Z.position.x)*(Y/Z.zoom),y:R.y-(R.y-Z.position.y)*(Y/Z.zoom)}}))}else if(A==="pan"){const j=rf(F),R=j.x-u.lastCenter.x,U=j.y-u.lastCenter.y;t(Y=>({...Y,position:{x:Y.position.x+R,y:Y.position.y+U}}))}d(j=>({...j,lastDistance:Qg(F),lastCenter:rf(F)}))}else if(F.length===1)if(e.currentTool===il.ERASER){const A=P.target.getStage(),j=zg(P,A),R=CF(j.x,j.y,e.eraserSize,r);n(R)}else if(e.currentTool===il.PAN){const A=rf(F),j=A.x-u.lastCenter.x,R=A.y-u.lastCenter.y;t(U=>({...U,position:{x:U.position.x+j,y:U.position.y+R}})),d(U=>({...U,lastCenter:A}))}else w(P)}),[u,e.zoom,t,w]),N=S.useCallback(P=>{_(P)},[_]),E=S.useCallback(P=>{P.evt.preventDefault(),P.evt.stopPropagation();const F=P.evt.touches;F.length===0?(C(P),d({isActive:!1,type:null,lastDistance:null,lastCenter:null})):F.length===1&&d(A=>({...A,isActive:!1}))},[C]);return{handleTouchStart:k,handleTouchMove:N,handleTouchEnd:E,handleEraserStart:g,handleUndoTouch:p,handleRedoTouch:x,showTouchFeedback:v}},Vae=(e,t)=>{const[r,n]=S.useState(e.MIN),[s,a]=S.useState({x:0,y:0}),i=S.useCallback((g,p,x)=>{const v=Math.max(e.MIN,Math.min(e.MAX,g));if(p){const w=v/r,C={x:p.x-(p.x-s.x)*w,y:p.y-(p.y-s.y)*w};return{zoom:v,position:C}}else{const w=t.width*v,C=t.height*v,k={x:(x.width-w)/2,y:(x.height-C)/2};return{zoom:v,position:k}}},[r,s,e,t]),o=S.useCallback(()=>{const g=Math.min(r*(1+e.STEP),e.MAX);n(g)},[r,e]),l=S.useCallback(()=>{const g=Math.max(r/(1+e.STEP),e.MIN);n(g)},[r,e]),u=S.useCallback((g,p,x)=>{const v=i(g,p,x);n(v.zoom),a(v.position)},[i]),d=S.useCallback((g,p)=>{a(x=>({x:x.x+g,y:x.y+p}))},[]),h=S.useCallback(()=>{n(e.INITIAL),a({x:0,y:0})},[e.INITIAL]);return{zoom:r,setZoom:n,position:s,setPosition:a,handleZoomIn:o,handleZoomOut:l,handleZoomToPoint:u,handlePan:d,resetZoom:h}},Kae=e=>{const[t,r]=S.useState([]),[n,s]=S.useState(0),a=S.useCallback(h=>{if(console.log("parseDrawingData - input drawing:",h),console.log("parseDrawingData - drawing.answers:",h?.answers),!h?.answers)return console.log("parseDrawingData - no answers found, returning empty array"),[];try{if(typeof h.answers=="string"){console.log("parseDrawingData - parsing string answers");const g=JSON.parse(h.answers);return console.log("parseDrawingData - parsed string result:",g),g&&typeof g=="object"&&g.lines&&console.log("parseDrawingData - new format detected with lines and textBoxes"),g}if(h.answers&&typeof h.answers=="object"&&h.answers.lines)return console.log("parseDrawingData - answers is new format object"),h.answers;if(Array.isArray(h.answers)){if(console.log("parseDrawingData - answers is array"),h.answers.every(p=>typeof p=="string"))try{const p=h.answers.map(x=>{try{return JSON.parse(x)}catch{return x}});return console.log("parseDrawingData - parsed array elements"),p}catch{return console.log("parseDrawingData - failed to parse array elements, returning raw"),h.answers}return h.answers}return console.log("parseDrawingData - answers is neither string nor array, returning empty array"),[]}catch(g){return console.error("Error parsing drawing data:",g),[]}},[]),i=S.useCallback(h=>{if(console.log("processQuestions - input answers:",h),console.log("processQuestions - answers type:",typeof h),console.log("processQuestions - answers isArray:",Array.isArray(h)),h&&typeof h=="object"&&h.lines){console.log("processQuestions - new format detected with lines and textBoxes"),console.log("processQuestions - lines count:",h.lines?.length),console.log("processQuestions - textBoxes count:",h.textBoxes?.length);const p=o(h.lines);return console.log("processQuestions - canvas groups:",p),console.log("processQuestions - number of canvas groups:",p.length),p.map((x,v)=>(console.log(`processQuestions - canvas ${v} strokes:`,x),console.log(`processQuestions - canvas ${v} stroke count:`,x.length),{questionNumber:v+1,drawingData:x,textBoxes:h.textBoxes||[]}))}if(Array.isArray(h)&&h.every(p=>p&&typeof p=="object"&&p.lines))return console.log("processQuestions - array of {lines,textBoxes} detected"),h.map((p,x)=>({questionNumber:x+1,drawingData:p.lines||[],textBoxes:p.textBoxes||[]}));if(!Array.isArray(h))return console.log("processQuestions - answers is not array or object, returning empty array"),[];console.log("processQuestions - processing",h.length,"answers (old format)");const g=o(h);return console.log("processQuestions - canvas groups:",g),console.log("processQuestions - number of canvas groups:",g.length),g.map((p,x)=>(console.log(`processQuestions - canvas ${x} strokes:`,p),console.log(`processQuestions - canvas ${x} stroke count:`,p.length),{questionNumber:x+1,drawingData:p,textBoxes:[]}))},[]),o=S.useCallback(h=>{console.log("groupStrokesByCanvas - input answers:",h);const g=l(h);return console.log("groupStrokesByCanvas - using strategy:",g),g==="by_question_boundary"?u(h):g==="by_stroke_type"?d(h):[h]},[]),l=S.useCallback(h=>{console.log("determineGroupingStrategy - analyzing answers:",h);let g=0,p=0;return h.forEach(x=>{Array.isArray(x)?g++:typeof x=="object"&&p++}),console.log("determineGroupingStrategy - arrayCount:",g,"objectCount:",p),g>0&&p>0?"by_stroke_type":h.length>3?"by_question_boundary":"single_canvas"},[]),u=S.useCallback(h=>{console.log("groupByQuestionBoundary - grouping answers:",h);const g=[];let p=[];const x=Math.ceil(h.length/2);for(let v=0;v<h.length;v++)p.push(h[v]),(v+1)%x===0&&v<h.length-1&&(g.push([...p]),p=[]);return p.length>0&&g.push(p),console.log("groupByQuestionBoundary - result:",g),g},[]),d=S.useCallback(h=>{console.log("groupByStrokeType - grouping answers:",h);const g=[],p=[];h.forEach(v=>{Array.isArray(v)?g.push(v):typeof v=="object"&&p.push(v)});const x=[];return g.length>0&&x.push(g),p.length>0&&x.push(p),console.log("groupByStrokeType - result:",x),x},[]);return S.useEffect(()=>{if(e){console.log("useDataParsing - drawing object:",e),console.log("useDataParsing - drawing.answers:",e.answers),console.log("useDataParsing - drawing.answers type:",typeof e.answers),console.log("useDataParsing - drawing.answers length:",e.answers?.length);const h=a(e);console.log("useDataParsing - parsed answers:",h),console.log("useDataParsing - parsed answers type:",typeof h),console.log("useDataParsing - parsed answers length:",h?.length);const g=i(h);console.log("useDataParsing - processed questions:",g),console.log("useDataParsing - processed questions length:",g?.length),g.length>0&&(console.log("useDataParsing - first question drawingData:",g[0]?.drawingData),console.log("useDataParsing - first question drawingData length:",g[0]?.drawingData?.length)),r(g),s(0)}},[e,a,i]),{questionsData:t,setQuestionsData:r,currentQuestionIndex:n,setCurrentQuestionIndex:s,parseDrawingData:a,processQuestions:i}},TF={MIN:.25,INITIAL:1},qae=(e,t)=>{const[r,n]=S.useState(!1),[s,a]=S.useState(null),i=S.useCallback(()=>{document.fullscreenElement||(a({zoom:e.zoom,position:{...e.position}}),document.documentElement.requestFullscreen().then(()=>{n(!0),t(l=>({...l,zoom:TF.MIN,position:{x:0,y:0},isFullscreen:!0}))}).catch(l=>{console.error("Error entering fullscreen:",l)}))},[e.zoom,e.position,t]),o=S.useCallback(()=>{document.fullscreenElement&&document.exitFullscreen().then(()=>{n(!1),s?(t(l=>({...l,zoom:s.zoom,position:s.position,isFullscreen:!1})),a(null)):t(l=>({...l,zoom:TF.INITIAL,position:{x:0,y:0},isFullscreen:!1}))}).catch(l=>{console.error("Error exiting fullscreen:",l)})},[s,t]);return{isFullscreen:r,enterFullscreen:i,exitFullscreen:o}},$B=S.forwardRef(({drawingData:e,textBoxes:t=[],drawingState:r,canvasSize:n,zoom:s,position:a,onTouchStart:i,onTouchMove:o,onTouchEnd:l,mousePosition:u,isMouseOverCanvas:d,isEraserDrawing:h},g)=>{const p=S.useRef(null),[x,v]=S.useState(.25),[w,C]=S.useState(null),[k,_]=S.useState({x:0,y:0}),[N,E]=S.useState(!1),P=S.useCallback(({x:V,y:W,size:I,visible:B,isDrawing:q})=>!B||!V||!W?null:c.jsx(hf,{x:V,y:W,radius:I/2,stroke:xF.CURSOR_COLOR,strokeWidth:2,dash:[5,5],opacity:q?.8:xF.CURSOR_OPACITY,listening:!1,zIndex:1e3}),[]),F=S.useCallback(V=>{if(r.currentTool===wh.ERASER){const W=V.target.getStage(),I=zg(V,W);_(I)}},[r.currentTool]),A=S.useCallback(()=>{r.currentTool===wh.ERASER&&E(!0)},[r.currentTool]),j=S.useCallback(()=>{E(!1)},[]);S.useEffect(()=>{const V=g.current;if(V)return V.on("mousemove",F),V.on("mouseenter",A),V.on("mouseleave",j),()=>{V.off("mousemove",F),V.off("mouseenter",A),V.off("mouseleave",j)}},[F,A,j,g]),S.useEffect(()=>{const V=n.width??n.WIDTH,W=n.height??n.HEIGHT,I=()=>{const B=p.current;if(!B)return;const q=B.clientWidth||1,J=B.clientHeight||1,se=Math.abs(r.rotation%180)===90,X=se?W:V,ie=se?V:W,le=Math.min(q/(X||1),J/(ie||1));v(Math.min(le,1))};return I(),window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)},[n.width,n.height,n.WIDTH,n.HEIGHT,r.rotation]);const R=S.useMemo(()=>{const V=p.current;if(!V||!w)return 0;const W=V.clientWidth||1,I=V.clientHeight||1,B=Math.min(W/Math.max(w.width,1),I/Math.max(w.height,1));return Math.min(B,MB.MAX)},[w]),U=S.useMemo(()=>Math.max(s,x||1),[s,x]),Y=S.useMemo(()=>{const V=n.width??n.WIDTH,W=n.height??n.HEIGHT;if(!p.current)return{x:0,y:0};const I=p.current.clientWidth||1,B=p.current.clientHeight||1,q=(I-V*U)/2,J=(B-W*U)/2;return s<=x?{x:q,y:J}:{x:a.x!==void 0?a.x:q,y:a.y!==void 0?a.y:J}},[a,s,x,U,n.width,n.height,w,R]);S.useEffect(()=>{if(!Array.isArray(e)||e.length===0){C(null);return}let V=1/0,W=1/0,I=-1/0,B=-1/0;const q=(ie,le)=>{Number.isFinite(ie)&&Number.isFinite(le)&&(ie<V&&(V=ie),le<W&&(W=le),ie>I&&(I=ie),le>B&&(B=le))};if(e.forEach(ie=>{if(Array.isArray(ie))ie.forEach(le=>q(le.x,le.y));else if(ie&&typeof ie=="object"){if(ie.type==="line")q(ie.startX,ie.startY),q(ie.endX,ie.endY);else if(ie.type==="rectangle")q(ie.startX,ie.startY),q(ie.endX,ie.endY);else if(ie.type==="circle"){const le=Math.sqrt(Math.pow(ie.endX-ie.startX,2)+Math.pow(ie.endY-ie.startY,2))/2,ce=(ie.startX+ie.endX)/2,ke=(ie.startY+ie.endY)/2;q(ce-le,ke-le),q(ce+le,ke+le)}}}),!Number.isFinite(V)||!Number.isFinite(W)||!Number.isFinite(I)||!Number.isFinite(B)){C(null);return}const J=16,se=Math.max(1,I-V+J*2),X=Math.max(1,B-W+J*2);C({minX:V-J,minY:W-J,width:se,height:X})},[e]),S.useEffect(()=>{console.log("CanvasViewer - drawingData:",e),console.log("CanvasViewer - drawingData length:",e?.length),console.log("CanvasViewer - textBoxes:",t),console.log("CanvasViewer - textBoxes length:",t?.length),e&&e.length>0&&console.log("CanvasViewer - first item:",e[0]),t&&t.length>0&&console.log("CanvasViewer - first textBox:",t[0])},[e,t]),S.useEffect(()=>{const V=n.width??n.WIDTH,W=n.height??n.HEIGHT;console.log("CanvasViewer - canvas dimensions:",{width:V,height:W}),console.log("CanvasViewer - zoom:",s,"fitZoom:",x,"displayScale:",U),console.log("CanvasViewer - stagePosition:",Y)},[n,s,x,U,Y]);const Z=(V,W)=>{if(console.log(`CanvasViewer - rendering element ${W}:`,V),Array.isArray(V))return console.log(`CanvasViewer - rendering line with ${V.length} points`),c.jsx(Ja,{points:V.flatMap(I=>[I.x,I.y]),stroke:V[0]?.color||"#000000",strokeWidth:V[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},W);if(V.type==="line")return c.jsx(Ja,{points:[V.startX,V.startY,V.endX,V.endY],stroke:V.color,strokeWidth:V.thickness,lineCap:"round"},W);if(V.type==="rectangle"){const I=Math.abs(V.endX-V.startX),B=Math.abs(V.endY-V.startY),q=Math.min(V.startX,V.endX),J=Math.min(V.startY,V.endY);return c.jsx(Pa,{x:q,y:J,width:I,height:B,stroke:V.color,strokeWidth:V.thickness,fill:"transparent"},W)}else if(V.type==="circle"){const I=Math.sqrt(Math.pow(V.endX-V.startX,2)+Math.pow(V.endY-V.startY,2))/2,B=(V.startX+V.endX)/2,q=(V.startY+V.endY)/2;return c.jsx(hf,{x:B,y:q,radius:I,stroke:V.color,strokeWidth:V.thickness,fill:"transparent"},W)}return null},ae=()=>{if(!r.isDrawing)return null;if(r.currentTool===wh.PENCIL&&r.currentLine.length>0)return c.jsx(Ja,{points:r.currentLine.flatMap(V=>[V.x,V.y]),stroke:r.currentColor,strokeWidth:r.currentThickness,tension:.5,lineCap:"round",lineJoin:"round"});if(r.currentShape){const{type:V,startX:W,startY:I,endX:B,endY:q,color:J,thickness:se}=r.currentShape;if(V===wh.LINE)return c.jsx(Ja,{points:[W,I,B,q],stroke:J,strokeWidth:se,lineCap:"round"});if(V===wh.RECTANGLE){const X=Math.abs(B-W),ie=Math.abs(q-I),le=Math.min(W,B),ce=Math.min(I,q);return c.jsx(Pa,{x:le,y:ce,width:X,height:ie,stroke:J,strokeWidth:se,fill:"transparent"})}else if(V===wh.CIRCLE){const X=Math.sqrt(Math.pow(B-W,2)+Math.pow(q-I,2))/2,ie=(W+B)/2,le=(I+q)/2;return c.jsx(hf,{x:ie,y:le,radius:X,stroke:J,strokeWidth:se,fill:"transparent"})}}return null},ee=r.isFullscreen?{position:"fixed",inset:0,width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",zIndex:60}:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent"},ne={transform:`rotate(${r.rotation}deg)`,transformOrigin:"center center"},L=S.useCallback(V=>{V.preventDefault(),V.stopPropagation()},[]),H=S.useCallback(V=>{V.preventDefault(),V.stopPropagation()},[]),M=S.useCallback(V=>{V.preventDefault(),V.stopPropagation()},[]);return c.jsx("div",{style:{...ee,touchAction:"none",WebkitTouchCallout:"none"},ref:p,className:"select-none",onTouchStart:L,onTouchMove:H,onTouchEnd:M,children:c.jsx("div",{style:{...ne,touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onTouchStart:L,onTouchMove:H,onTouchEnd:M,children:c.jsx(Jh,{ref:g,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),scaleX:U,scaleY:U,x:Y.x,y:Y.y,onTouchStart:i,onTouchMove:o,onTouchEnd:l,children:c.jsxs(Xh,{children:[c.jsx(Pa,{x:0,y:0,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),fill:"white"}),e.map((V,W)=>(console.log(`CanvasViewer - mapping item ${W}:`,V),Z(V,W))),t&&t.map((V,W)=>c.jsx(Pa,{x:V.x,y:V.y,width:V.width,height:V.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}},`textbox-${W}`)),t&&t.map((V,W)=>c.jsx(Bc,{x:V.x+8,y:V.y+8,width:V.width-16,height:V.height-16,text:V.text,fontSize:V.fontSize||14,fill:V.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"},`text-${W}`)),ae(),r.currentTool===wh.ERASER&&c.jsx(P,{x:k.x,y:k.y,size:r.eraserSize,visible:N,isDrawing:h})]})})})})});$B.displayName="CanvasViewer";function Yae({containerRef:e,canvasSize:t,rotation:r=0}){const[n,s]=S.useState(1),[a,i]=S.useState({x:0,y:0}),o=S.useRef({width:1,height:1}),l=S.useRef(.01),u=S.useRef(0),d=S.useRef(!1),h=S.useCallback(()=>{const N=t?.width??t?.WIDTH??0,E=t?.height??t?.HEIGHT??0,P=Math.abs(r%180)===90;return{width:P?E:N,height:P?N:E}},[t,r]),g=S.useCallback(()=>{const N=e?.current;if(!N)return{width:1,height:1};const E=N.clientWidth||1,P=N.clientHeight||1;return o.current={width:E,height:P},{width:E,height:P}},[e]),p=S.useCallback(()=>{const{width:N,height:E}=o.current,{width:P,height:F}=h(),A=N/Math.max(P,1),j=E/Math.max(F,1);return Math.min(A,j,1)*.98},[h]),x=S.useCallback(N=>{const{width:E,height:P}=o.current,{width:F,height:A}=h(),j=Math.max(l.current,Math.min(N,1.5));let R=(E-F*j)/2,U=(P-A*j)/2;const Y=E-F*j,Z=P-A*j;R=Math.min(Math.max(0,R),Math.max(0,Y)),U=Math.min(Math.max(0,U),Math.max(0,Z));try{console.log("[Camera] centerAtScale",{targetScale:N,clampedScale:j,container:{containerW:E,containerH:P},canvas:{canvasW:F,canvasH:A},translate:{x:R,y:U},rotation:r})}catch{}i({x:R,y:U}),s(j)},[h]),v=S.useCallback(()=>{const{width:N,height:E}=g(),{width:P,height:F}=h(),A=p();let j=(N-P*A)/2,R=(E-F*A)/2;const U=N-P*A,Y=E-F*A;j=Math.min(Math.max(0,j),Math.max(0,U)),R=Math.min(Math.max(0,R),Math.max(0,Y));try{console.log("[Camera] fitCanvas",{scale:A,container:{containerW:N,containerH:E},canvas:{canvasW:P,canvasH:F},translate:{x:j,y:R},rotation:r})}catch{}s(A),i({x:j,y:R}),l.current=A,d.current=!1},[h,g,p]),w=S.useCallback(()=>{const{width:N,height:E}=g(),{width:P,height:F}=h(),A=(N-P)/2,j=(E-F)/2;s(1),i({x:A,y:j})},[h,g]),C=S.useCallback((N,E)=>{const{width:P,height:F}=o.current,{width:A,height:j}=h(),R=Math.max(l.current,Math.min(N,1.5));if(E&&Number.isFinite(E.x)&&Number.isFinite(E.y)){const U={x:(E.x-a.x)/n,y:(E.y-a.y)/n},Y=E.x-U.x*R,Z=E.y-U.y*R;try{console.log("[Camera] zoomTo(pointer) ->",{from:n,to:R})}catch{}s(R),i({x:Y,y:Z}),u.current=Date.now()+400,d.current=!0}else{let U=(P-A*R)/2,Y=(F-j*R)/2;const Z=P-A*R,ae=F-j*R;U=Math.min(Math.max(0,U),Math.max(0,Z)),Y=Math.min(Math.max(0,Y),Math.max(0,ae));try{console.log("[Camera] zoomTo(center) ->",{from:n,to:R})}catch{}s(R),i({x:U,y:Y}),u.current=Date.now()+400,d.current=!0}},[h,n,a]),k=S.useCallback((N,E)=>{const P=n*N,{width:F,height:A}=o.current,j={x:F/2,y:A/2};C(P,E||j)},[n,C]),_=S.useCallback((N,E)=>{i(P=>({x:P.x+N,y:P.y+E})),u.current=Date.now()+200,d.current=!0},[]);return S.useEffect(()=>{const N=e?.current;if(!N)return;const E=new ResizeObserver(()=>{g();const P=p();if(l.current=P,!(Date.now()<u.current)&&!d.current){try{console.log("[Camera] resize centerAtScale",{scale:n})}catch{}x(n)}});return E.observe(N),g(),()=>E.disconnect()},[e,g,p,x,n]),S.useEffect(()=>{d.current=!1,l.current=p(),x(n)},[r,t?.width,t?.height,t?.WIDTH,t?.HEIGHT,p,x,n]),S.useMemo(()=>({scale:n,translate:a,setScale:s,setTranslate:i,centerAtScale:x,fitCanvas:v,oneToOne:w,zoomTo:C,zoomByFactor:k,panBy:_}),[n,a,x,v,w,C,k,_])}const qx=new Map,UB=S.forwardRef(({drawingData:e,textBoxes:t=[],canvasSize:r,rotation:n=0,onScaleChange:s,persistKey:a="viewer",onTextBoxEdit:i},o)=>{const l=S.useRef(null),u=S.useRef(null),d=Yae({containerRef:l,canvasSize:r,rotation:n}),[h,g]=S.useState({width:1,height:1}),p=S.useRef(null),x=S.useRef(null),[v,w]=S.useState(null);S.useEffect(()=>{console.log("[ViewerCanvas] drawingData received:",e),console.log("[ViewerCanvas] drawingData length:",e?.length),e&&e.length>0&&console.log("[ViewerCanvas] First drawing element:",e[0]),console.log("[ViewerCanvas] textBoxes:",t),console.log("[ViewerCanvas] textBoxes length:",t?.length)},[e]),S.useEffect(()=>{typeof s=="function"&&s(d.scale);try{console.log("[ViewerCanvas] scale changed",{scale:d.scale})}catch{}if(a){const M=qx.get(a)||{};qx.set(a,{...M,scale:d.scale})}},[d.scale,s]),S.useEffect(()=>{if(a){const M=qx.get(a)||{};qx.set(a,{...M,translate:{x:d.translate.x,y:d.translate.y}})}},[a,d.translate.x,d.translate.y]),S.useImperativeHandle(o,()=>({zoomIn:M=>d.zoomByFactor(1.1,M),zoomOut:M=>d.zoomByFactor(1/1.1,M),fitCanvas:()=>d.fitCanvas(),oneToOne:()=>d.oneToOne(),getScale:()=>d.scale,getStage:()=>u.current,getPointerPosition:()=>u.current?.getPointerPosition?.(),exportPNGFullCanvas:()=>{const M=u.current;if(!M)return null;const V=r?.width??r?.WIDTH??1536,W=r?.height??r?.HEIGHT??2048,I={scaleX:M.scaleX(),scaleY:M.scaleY(),x:M.x(),y:M.y(),width:M.width(),height:M.height()},B=p.current,q=x.current,J=B?{x:B.x(),y:B.y(),scaleX:B.scaleX(),scaleY:B.scaleY()}:null,se=q?{x:q.x(),y:q.y(),rotation:q.rotation()}:null;try{return M.scale({x:1,y:1}),M.position({x:0,y:0}),M.size({width:V,height:W}),B&&(B.position({x:0,y:0}),B.scale({x:1,y:1})),q&&(q.position({x:0,y:0}),q.rotation(0)),M.batchDraw(),M.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:V,height:W})}finally{q&&se&&(q.position({x:se.x,y:se.y}),q.rotation(se.rotation)),B&&J&&(B.position({x:J.x,y:J.y}),B.scale({x:J.scaleX,y:J.scaleY})),M.scale({x:I.scaleX,y:I.scaleY}),M.position({x:I.x,y:I.y}),M.size({width:I.width,height:I.height}),M.batchDraw()}}}),[d]),S.useEffect(()=>{const M=l.current;if(!M)return;const V=()=>{g({width:M.clientWidth||1,height:M.clientHeight||1})};V();const W=new ResizeObserver(V);return W.observe(M),()=>W.disconnect()},[]),S.useEffect(()=>{if(!Array.isArray(e)||e.length===0){w(null);return}let M=1/0,V=1/0,W=-1/0,I=-1/0;const B=(X,ie)=>{Number.isFinite(X)&&Number.isFinite(ie)&&(X<M&&(M=X),ie<V&&(V=ie),X>W&&(W=X),ie>I&&(I=ie))};if(e.forEach(X=>{if(Array.isArray(X))X.forEach(ie=>B(ie.x,ie.y));else if(X&&typeof X=="object"){if(X.type==="line")B(X.startX,X.startY),B(X.endX,X.endY);else if(X.type==="rectangle")B(X.startX,X.startY),B(X.endX,X.endY);else if(X.type==="circle"){const ie=Math.hypot(X.endX-X.startX,X.endY-X.startY)/2,le=(X.startX+X.endX)/2,ce=(X.startY+X.endY)/2;B(le-ie,ce-ie),B(le+ie,ce+ie)}}}),!Number.isFinite(M)||!Number.isFinite(V)||!Number.isFinite(W)||!Number.isFinite(I)){w(null);return}const q=16,J=Math.max(1,W-M+q*2),se=Math.max(1,I-V+q*2);w({minX:M-q,minY:V-q,width:J,height:se,centerX:M-q+J/2,centerY:V-q+se/2})},[e]);const C=S.useMemo(()=>{if(!v)return{scale:1,x:0,y:0};const M=r?.width??r?.WIDTH??1536,V=r?.height??r?.HEIGHT??2048,W=Math.min(M/Math.max(1,v.width),V/Math.max(1,v.height),1),I=v.width*W,B=v.height*W,q=(M-I)/2,J=(V-B)/2,se=q-v.minX*W,X=J-v.minY*W;return{scale:W,x:se,y:X}},[v,r?.width,r?.height,r?.WIDTH,r?.HEIGHT]),k=S.useRef(!1);S.useEffect(()=>{if(k.current)return;const M=a?qx.get(a):null;M&&Number.isFinite(M.scale)&&M.translate&&Number.isFinite(M.translate.x)&&Number.isFinite(M.translate.y)?(d.setScale(M.scale),d.setTranslate(M.translate)):d.fitCanvas(),k.current=!0},[a,d]),S.useEffect(()=>{try{console.log("[ViewerCanvas] rotation changed",{rotation:n,scale:d.scale,translate:d.translate})}catch{}d.fitCanvas()},[n]),S.useEffect(()=>{d.centerAtScale(d.scale)},[n]);const _=M=>{M.evt.preventDefault();const V=u.current;if(!V)return;const W=V.getPointerPosition(),I=Math.pow(1.0015,-M.evt.deltaY);d.zoomByFactor(I,W)},N=S.useRef(!1),E=S.useRef({x:0,y:0}),P=()=>{const M=l.current;if(!M)return 1;const V=M.clientWidth||1,W=M.clientHeight||1,I=r?.width??r?.WIDTH??1,B=r?.height??r?.HEIGHT??1,q=Math.abs(n%180)===90,J=q?B:I,se=q?I:B,X=Math.min(V/J,W/se);return Math.min(X,1)},F=M=>{const V=P();d.scale<=V||(N.current=!0,E.current={x:M.evt.clientX,y:M.evt.clientY})},A=M=>{if(!N.current)return;const V=M.evt.clientX-E.current.x,W=M.evt.clientY-E.current.y;E.current={x:M.evt.clientX,y:M.evt.clientY},d.panBy(V,W)},j=()=>{N.current=!1},R=1536,U=2048,Y=(M,V)=>{if(console.log(`[ViewerCanvas] Rendering drawing element ${V}:`,M),Array.isArray(M))return console.log(`[ViewerCanvas] Array item with ${M.length} points:`,M.slice(0,3)),c.jsx(Ja,{points:M.flatMap(W=>[W.x,W.y]),stroke:M[0]?.color||"#000000",strokeWidth:M[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},V);if(M?.type==="line")return c.jsx(Ja,{points:[M.startX,M.startY,M.endX,M.endY],stroke:M.color,strokeWidth:M.thickness,lineCap:"round"},V);if(M?.type==="rectangle"){const W=Math.abs(M.endX-M.startX),I=Math.abs(M.endY-M.startY),B=Math.min(M.startX,M.endX),q=Math.min(M.startY,M.endY);return c.jsx(Pa,{x:B,y:q,width:W,height:I,stroke:M.color,strokeWidth:M.thickness,fill:"transparent"},V)}else if(M?.type==="circle"){const W=Math.sqrt(Math.pow(M.endX-M.startX,2)+Math.pow(M.endY-M.startY,2))/2,I=(M.startX+M.endX)/2,B=(M.startY+M.endY)/2;return c.jsx(hf,{x:I,y:B,radius:W,stroke:M.color,strokeWidth:M.thickness,fill:"transparent"},V)}return null},Z=S.useRef(new Map),ae=S.useRef(null),ee=S.useRef({x:0,y:0}),ne=S.useCallback(M=>{const V=l.current;V&&(V.setPointerCapture?.(M.pointerId),Z.current.set(M.pointerId,{x:M.clientX,y:M.clientY}),E.current={x:M.clientX,y:M.clientY})},[]),L=S.useCallback(M=>{const V=Z.current;if(V.has(M.pointerId)){if(V.set(M.pointerId,{x:M.clientX,y:M.clientY}),V.size===2){const W=Array.from(V.values()),I=W[1].x-W[0].x,B=W[1].y-W[0].y,q=Math.hypot(I,B),J={x:(W[0].x+W[1].x)/2,y:(W[0].y+W[1].y)/2},se=u.current,X=se&&se.getPointerPosition()||J;if(ae.current!=null){const ie=q/Math.max(1,ae.current);d.zoomByFactor(ie,X)}ae.current=q,ee.current=X}else if(V.size===1){const W=P();if(d.scale<=W)return;const I=M.clientX-E.current.x,B=M.clientY-E.current.y;E.current={x:M.clientX,y:M.clientY},d.panBy(I,B)}}},[]),H=S.useCallback(M=>{const V=l.current;V&&(V.releasePointerCapture?.(M.pointerId),Z.current.delete(M.pointerId),Z.current.size<2&&(ae.current=null),N.current=!1)},[]);return c.jsx("div",{ref:l,style:{width:"100%",height:"100%",display:"block",backgroundColor:"transparent",touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onPointerDown:ne,onPointerMove:L,onPointerUp:H,children:c.jsx(Jh,{ref:u,width:h.width,height:h.height,onWheel:_,onMouseDown:F,onMouseMove:A,onMouseUp:j,onMouseLeave:j,children:c.jsx(Xh,{children:c.jsx(Zl,{ref:p,x:d.translate.x,y:d.translate.y,scaleX:d.scale,scaleY:d.scale,children:(()=>{const M=(n%360+360)%360;let V=0,W=0;M===90?V=U:M===180?(V=R,W=U):M===270&&(W=R);try{console.log("[ViewerCanvas] rotatedGroup offset",{rotation:n,norm:M,tx:V,ty:W,canvasW:R,canvasH:U})}catch{}return c.jsxs(Zl,{ref:x,x:V,y:W,rotation:n,children:[c.jsx(Pa,{x:0,y:0,width:R,height:U,fill:"white"}),c.jsxs(Zl,{x:C.x,y:C.y,scaleX:C.scale,scaleY:C.scale,children:[Array.isArray(e)?(console.log("[ViewerCanvas] Rendering",e.length,"drawing elements"),e.map((I,B)=>Y(I,B))):null,Array.isArray(t)&&t.map((I,B)=>c.jsxs(Zl,{x:I.x,y:I.y,children:[c.jsx(Pa,{width:I.width,height:I.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}}),c.jsx(Bc,{text:I.text,x:8,y:8,width:Math.max(0,(I.width||0)-16),height:Math.max(0,(I.height||0)-16),fontSize:I.fontSize||14,fill:I.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"})]},`tb-${B}`))]})]})})()})})})})});UB.displayName="ViewerCanvas";const Xae=({zoom:e,onZoomIn:t,onZoomOut:r,onRotate:n,onDownload:s,onFullscreen:a,isFullscreen:i})=>c.jsxs("div",{className:"absolute top-4 right-4 flex flex-col space-y-2 items-center justify-center",children:[c.jsx(Je,{onClick:t,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom In",children:c.jsx(Nae,{className:"w-4 h-4 mx-auto my-auto"})}),c.jsx(Je,{onClick:r,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom Out",children:c.jsx(jae,{className:"w-4 h-4 mx-auto my-auto"})}),c.jsx(Je,{onClick:n,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Rotate",children:c.jsx(Cae,{className:"w-4 h-4 mx-auto my-auto"})}),c.jsx(Je,{onClick:s,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Download",children:c.jsx(bae,{className:"w-4 h-4 mx-auto my-auto"})}),c.jsx(Je,{onClick:a,variant:"secondary",size:"icon",className:"w-10 h-10",title:i?"Exit Fullscreen":"Enter Fullscreen",children:i?c.jsx(IB,{className:"w-4 h-4 mx-auto my-auto"}):c.jsx(Sae,{className:"w-4 h-4 mx-auto my-auto"})})]}),Jae=({currentQuestion:e,totalQuestions:t,onPrevious:r,onNext:n,drawingDataLength:s})=>t<=1?null:c.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Je,{onClick:r,disabled:e===0,variant:"outline",size:"sm",children:"Previous"}),c.jsxs("span",{className:"text-sm text-gray-600",children:["Question ",e+1," of ",t]}),c.jsx(Je,{onClick:n,disabled:e===t-1,variant:"outline",size:"sm",children:"Next"})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[s," lines"]})]})}),zB=({drawing:e,isOpen:t,onClose:r,onScoreChange:n,onMaxScoreChange:s,isTeacherView:a=!1,onSaveScore:i})=>{const{drawingState:o,setDrawingState:l,drawingData:u,setDrawingData:d,textBoxes:h,setTextBoxes:g,saveToHistoryState:p,undo:x,redo:v,canUndoState:w,canRedoState:C}=Mae(),{questionsData:k,currentQuestionIndex:_,setCurrentQuestionIndex:N}=Kae(e),{zoom:E,position:P,handleZoomIn:F,handleZoomOut:A}=Vae(MB,Kl),{isFullscreen:j,enterFullscreen:R,exitFullscreen:U}=qae(o,l),{handleTouchStart:Y,handleTouchMove:Z,handleTouchEnd:ae}=Gae(o,l,u,d,p,x,v,w,C),ee=S.useRef(null),ne=S.useRef(null),[L,H]=S.useState(1),[M,V]=S.useState(""),[W,I]=S.useState("");S.useEffect(()=>{if(console.log("DrawingModal - questionsData:",k),console.log("DrawingModal - currentQuestionIndex:",_),k.length>0){const ce=k[_]?.drawingData||[],ke=k[_]?.textBoxes||[];console.log("DrawingModal - setting drawingData:",ce),console.log("DrawingModal - setting textBoxes:",ke),d(ce),g(ke)}},[k,_,d,g]),S.useEffect(()=>{t&&e&&(V((Number.isFinite(e.score)?e.score:0).toString()),I("10"))},[t,e]);const B=()=>{_>0&&N(_-1)},q=()=>{_<k.length-1&&N(_+1)},J=()=>{w&&x()},se=()=>{C&&v()};S.useEffect(()=>{const ce=ke=>{(ke.ctrlKey||ke.metaKey)&&(ke.key==="z"&&!ke.shiftKey?(ke.preventDefault(),J()):(ke.key==="y"||ke.key==="z"&&ke.shiftKey)&&(ke.preventDefault(),se()))};return document.addEventListener("keydown",ce),()=>document.removeEventListener("keydown",ce)},[J,se]);const X=()=>{l(ce=>({...ce,rotation:(ce.rotation+90)%360}))},ie=()=>{if(a&&ne.current){const ge=ne.current.exportPNGFullCanvas();if(!ge)return;const Ne=document.createElement("a");Ne.href=ge,Ne.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(Ne),Ne.click(),document.body.removeChild(Ne);return}const ce=ee.current;if(!ce)return;const ke=ce.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:Kl.WIDTH,height:Kl.HEIGHT}),re=document.createElement("a");re.href=ke,re.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(re),re.click(),document.body.removeChild(re)},le=async()=>{if(!a)return r();const ce=parseInt(M,10),ke=10;Number.isFinite(ce)&&(typeof i=="function"?await i({resultId:e.id,score:Math.max(0,Math.min(10,ce)),maxScore:ke}):(n&&n(e.id,ce),s&&s(e.id,ke))),r()};return!t||!e?null:c.jsx(fo,{children:c.jsx(st.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,children:c.jsxs(st.div,{className:"bg-white rounded-lg shadow-xl max-w-4xl h-[90vh] w-full mx-4 flex flex-col select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:ce=>ce.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Drawing Submission"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[e.name," ",e.surname," - ",e.test_name]})]}),c.jsx(Je,{onClick:r,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-600",children:c.jsx(IB,{className:"w-5 h-5"})})]}),k.length>1&&c.jsx(Jae,{currentQuestion:_,totalQuestions:k.length,onPrevious:B,onNext:q,drawingDataLength:k[_]?.drawingData?.length||0}),c.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[c.jsxs("div",{className:"flex-1 min-h-0 relative overflow-hidden bg-gray-100 p-0 sm:p-4 select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},children:[a?c.jsx(UB,{ref:ne,drawingData:u,textBoxes:h,canvasSize:{width:Kl.WIDTH,height:Kl.HEIGHT,WIDTH:Kl.WIDTH,HEIGHT:Kl.HEIGHT},rotation:o.rotation,onScaleChange:H}):c.jsx($B,{ref:ee,drawingData:u,textBoxes:h,drawingState:o,canvasSize:{width:Kl.WIDTH,height:Kl.HEIGHT,WIDTH:Kl.WIDTH,HEIGHT:Kl.HEIGHT},zoom:E,position:P,onTouchStart:Y,onTouchMove:Z,onTouchEnd:ae,mousePosition:{x:0,y:0},isMouseOverCanvas:!1,isEraserDrawing:!1}),c.jsx(Xae,{zoom:a?L:E,onZoomIn:()=>{if(a&&ne.current){try{console.log("[ZoomButton] ZoomIn click (teacher)",{before:ne.current.getScale?.()})}catch{}ne.current.zoomIn(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomIn after",{after:ne.current.getScale?.()})}catch{}},0)}else F()},onZoomOut:()=>{if(a&&ne.current){try{console.log("[ZoomButton] ZoomOut click (teacher)",{before:ne.current.getScale?.()})}catch{}ne.current.zoomOut(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomOut after",{after:ne.current.getScale?.()})}catch{}},0)}else A()},onRotate:X,onDownload:ie,onFullscreen:j?U:R,isFullscreen:j}),c.jsxs("div",{className:"absolute bottom-4 left-4 bg-gray-800 bg-opacity-70 text-white px-3 py-1 rounded-full text-sm",children:[Math.round((a?L:E)*100),"%"]})]}),a&&c.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Score:"}),c.jsx("input",{type:"number",min:"0",max:10,value:M,onChange:ce=>V(ce.target.value),className:"w-20 px-3 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Max:"}),c.jsx("input",{type:"number",value:10,disabled:!0,className:"w-20 px-3 py-1 text-sm border border-gray-300 rounded bg-gray-100"})]}),c.jsx(Je,{onClick:le,variant:"primary",size:"sm",children:"Save"})]})})]})]})})})},WB=({testType:e,testId:t,studentAnswers:r,onBackToCabinet:n,compact:s=!1,showAll:a=!1,onToggleShowAll:i,maxInitial:o=3})=>{const l=vo(),{user:u,isAuthenticated:d}=Qn(),{testResults:h,loadTestResults:g}=$v(),[p,x]=S.useState(!0),[v,w]=S.useState(""),[C,k]=S.useState([]),[_,N]=S.useState([]),[E,P]=S.useState(null),[F,A]=S.useState([]),[j,R]=S.useState(0),[U,Y]=S.useState(0),[Z,ae]=S.useState(!1),[ee,ne]=S.useState(null),L=S.useCallback(X=>{const ie=X.best_retest_score||X.score,le=X.best_retest_max_score||X.max_score,ce=Math.round(ie/le*100);return{score:ie,maxScore:le,percentage:ce}},[]);S.useEffect(()=>{H()},[e,t]),S.useEffect(()=>{!e&&!t&&(h&&h.results?(pe.debug(" Using cached test results from TestContext"),N(h.results),x(!1)):V())},[e,t,h]);const H=S.useCallback(async()=>{pe.debug(" Initializing Student Results...");try{if(x(!0),w(""),!d||!u){pe.debug(" User not authenticated"),w("User not authenticated");return}if(u.role!==Hi.STUDENT){pe.error(" Invalid user role for student results:",u.role),w("Access denied. Student role required.");return}pe.debug(" Loading test results..."),await g(u?.student_id||u?.id||""),e&&t&&r&&(pe.debug(" Loading specific test results..."),await M(e,t,r)),pe.debug(" Student Results initialization complete!")}catch(X){pe.error(" Error initializing student results:",X),w("Failed to initialize student results")}finally{x(!1)}},[d,u,e,t,r,g]),M=S.useCallback(async(X,ie,le)=>{pe.debug(" Loading specific test results:",X,ie);try{const ce=await cn.getTestInfo(X,ie);pe.debug(" Test info loaded:",ce),P(ce);const ke=await cn.getTestQuestions(X,ie);pe.debug(" Test questions loaded:",ke),A(ke);const re=xf(ke,le,X).score,ge=ke.length>0?Math.round(re/ke.length*100):0;R(re),Y(ge),pe.debug(" Test results calculated:",{score:re,percentage:ge})}catch(ce){throw pe.error(" Error loading specific test results:",ce),ce}},[]),V=S.useCallback(async(X=0)=>{pe.debug(" Loading all student results using existing test results API...",X>0?`(retry ${X})`:"");try{if(!(u?.student_id||u?.sub))throw new Error("Student ID not found");const le=await cn.getStudentTestResults();if(le.success){pe.debug(" All student results loaded:",le.results.length,"results");const ce=le.results.map(ke=>({...ke,caught_cheating:ke.caught_cheating||!1,visibility_change_times:ke.visibility_change_times||0}));N(ce),ne(new Date),le.results.length===0&&X===0&&(pe.debug(" No results found, retrying in 2 seconds..."),setTimeout(()=>{V(1)},2e3))}else throw new Error(le.error||"Failed to load student results")}catch(ie){pe.error(" Error loading all student results:",ie),w(ie.message)}},[u]),W=S.useCallback(X=>({"Listening and Speaking":"L&S","Reading and Writing":"R&W","English for Career":"Eng for Career","Science Fundamental":"Science F","Science Supplementary":"Science S","Math Fundamental":"Math F","Math Supplementary":"Math S","English for Communication":"Eng for Comm"})[X]||X,[]),I=S.useCallback(X=>{if(!X||X.length===0)return c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No results available"})});const ie=a?X:X.slice(0,o);return c.jsxs("div",{className:"overflow-x-auto",children:[c.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Result"}),c.jsx("th",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ie.map((le,ce)=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs font-medium text-gray-900",children:c.jsx("span",{className:"bg-blue-100 text-blue-800 px-0.5 sm:px-2 py-0.5 rounded text-xs",children:W(le.subject)})}),c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-12 sm:max-w-none",children:le.teacher_name}),c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-16 sm:max-w-none",children:le.test_name}),c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500",children:c.jsx("div",{className:"flex flex-col items-center space-y-1",children:le.test_type==="drawing"?le.score!==null?c.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${(()=>{const{score:ke,maxScore:re,percentage:ge}=L(le);return ge>=80?"bg-green-100 text-green-800":ge>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"})()}`,children:(()=>{const{score:ke,maxScore:re,percentage:ge}=L(le);return`${ke}/${re} (${ge}%)`})()}):c.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):le.test_type==="speaking"?le.score!==null?c.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${(()=>{const{score:ke,maxScore:re,percentage:ge}=L(le);return ge>=80?"bg-green-100 text-green-800":ge>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"})()}`,children:(()=>{const{score:ke,maxScore:re,percentage:ge}=L(le);return`${ke}/${re} (${ge}%)`})()}):c.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):c.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${(()=>{const{score:ke,maxScore:re,percentage:ge}=L(le);return ge>=80?"bg-green-100 text-green-800":ge>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"})()}`,children:(()=>{const{score:ke,maxScore:re,percentage:ge}=L(le);return`${ke}/${re} (${ge}%)`})()})})}),c.jsx("td",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:new Date(le.submitted_at).toLocaleDateString()})]},ce))})]}),X.length>o&&i&&c.jsx("div",{className:"text-center pt-4",children:c.jsx("button",{onClick:i,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:a?"Show Less":`Show ${X.length-o} More`})})]})},[W,a,o,i]),B=S.useCallback((X,ie)=>{if(pe.debug(" formatAnswer called with:",{answer:X,testType:ie,answerType:typeof X}),!X)return"No answer";switch(ie){case"true_false":const le=typeof X=="boolean"?X:X==="true";return pe.debug(" Boolean answer processed:",le),le?"True":"False";case"multiple_choice":return X.toUpperCase();case"input":return X;case"word_matching":return typeof X=="object"?Object.entries(X).map(([ce,ke])=>`${ce}  ${ke}`).join(", "):X;case"drawing":return"Drawing submitted";default:return X}},[]),q=S.useCallback(()=>!E||!F||!r?null:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:["Test Results: ",E.test_name||E.title||"Test"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-3xl font-bold text-blue-600",children:j}),c.jsx("p",{className:"text-sm text-gray-500",children:"Correct Answers"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-3xl font-bold text-gray-900",children:F.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Total Questions"})]}),c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:`text-3xl font-bold ${U>=80?"text-green-600":U>=60?"text-yellow-600":"text-red-600"}`,children:[U,"%"]}),c.jsx("p",{className:"text-sm text-gray-500",children:"Score"})]})]})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Questions Review"}),c.jsx("div",{className:"space-y-4",children:F.map((X,ie)=>{const le=r[ie],ce=Yy(X,e),ke=bm(X,le,e);return c.jsxs("div",{className:`border rounded-lg p-4 ${ke?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsxs("h4",{className:"font-medium text-gray-900",children:["Question ",ie+1]}),c.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${ke?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:ke?"Correct":"Incorrect"})]}),c.jsx("p",{className:"text-gray-700 mb-3",children:X.question}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Your Answer:"}),c.jsx("p",{className:"text-sm text-gray-900",children:B(le,e)})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Correct Answer:"}),c.jsx("p",{className:"text-sm text-gray-900",children:B(ce,e)})]})]})]},ie)})})]})]}),[E,F,r,e,j,U,Yy,bm,B]),J=S.useCallback(()=>{if(!_||_.length===0)return c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No test results available yet."})});const X={};return _.forEach(ie=>{const le=ie.subject||"Unknown Subject";X[le]||(X[le]=[]),X[le].push(ie)}),c.jsx("div",{className:"space-y-6",children:Object.entries(X).map(([ie,le])=>c.jsxs("div",{className:"bg-white rounded-lg shadow",children:[c.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ie})}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:le.map((ce,ke)=>{const{score:re,maxScore:ge,percentage:Ne}=L(ce),je=Ne>=80?"text-green-600":Ne>=60?"text-yellow-600":"text-red-600";return c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:ce.test_name}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ce.teacher_name||"Unknown"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c.jsxs("span",{className:je,children:[re,"/",ge," (",Ne,"%)"]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(ce.submitted_at).toLocaleDateString()})]},ke)})})]})})]},ie))})},[_]);S.useCallback(()=>{pe.debug(" Clearing test data and returning to cabinet..."),P(null),A([]),setStudentAnswers(null),R(0),Y(0),ae(!1),n?n():l("/student")},[n,l]);const se=S.useCallback(()=>{pe.debug(" Navigating back to cabinet..."),n?n():l("/student")},[n,l]);return S.useCallback((X,ie)=>{const le={id:Date.now(),message:X,type:ie,timestamp:new Date};k(ce=>[...ce,le]),setTimeout(()=>{k(ce=>ce.filter(ke=>ke.id!==le.id))},C0.NOTIFICATION_DURATION)},[]),p?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(Ur,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Student Results..."})]})}):v?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:v}),c.jsx(Je,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?c.jsxs("div",{children:[p?c.jsxs("div",{className:"text-center py-8",children:[c.jsx(Ur,{size:"md"}),c.jsx("p",{className:"mt-2 text-gray-600",children:"Loading results..."})]}):v?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-red-500 text-4xl mb-2",children:""}),c.jsx("p",{className:"text-red-600",children:v})]}):I(_),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:C.map(X=>c.jsx(ac,{type:X.type,message:X.message,onClose:()=>k(ie=>ie.filter(le=>le.id!==X.id))},X.id))})]}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Results"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",ee?ee.toLocaleString():"Never"]})]}),c.jsxs("div",{className:"flex space-x-3",children:[E&&c.jsx(Je,{variant:"outline",onClick:()=>ae(!Z),children:Z?"Hide Details":"Show Details"}),c.jsx(Je,{variant:"outline",onClick:se,children:"Back to Cabinet"})]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:Z&&E?q():J()}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:C.map(X=>c.jsx(ac,{type:X.type,message:X.message,onClose:()=>k(ie=>ie.filter(le=>le.id!==X.id))},X.id))}),selectedDrawing&&c.jsx(zB,{drawing:selectedDrawing,isOpen:isDrawingModalOpen,onClose:()=>setIsDrawingModalOpen(!1)})]})},Qae=({isMenuOpen:e,onToggleMenu:t,onShowPasswordChange:r})=>{const n=vo(),{user:s,isAuthenticated:a,logout:i}=Qn(),{studentData:o,loadStudentData:l}=r2(),{activeTests:u,testResults:d,loadActiveTests:h,loadTestResults:g,viewTestDetails:p,testDetailsModal:x,closeTestDetailsModal:v}=$v(),[w,C]=S.useState(!0),[k,_]=S.useState(""),[N,E]=S.useState([]),[P,F]=S.useState(null),[A,j]=S.useState(!1),[R,U]=S.useState(null),[Y,Z]=S.useState(null),[ae,ee]=S.useState(new Set),[ne,L]=S.useState(!1),[H,M]=S.useState(!1),[V,W]=S.useState(!1),[I,B]=S.useState(!1);S.useEffect(()=>{q()},[]),S.useEffect(()=>()=>{W(!1)},[]),S.useEffect(()=>{if(V){const ge=setTimeout(()=>{W(!1)},1e3);return()=>clearTimeout(ge)}},[V]);const q=S.useCallback(async()=>{pe.debug(" Initializing Student Cabinet...");try{if(C(!0),_(""),!a||!s){pe.debug(" User not authenticated, redirecting to login"),n("/login");return}if(s.role!==Hi.STUDENT){pe.error(" Invalid user role for student cabinet:",s.role),_("Access denied. Student role required.");return}pe.debug(" Loading active tests (single API call)...");const ge=s?.student_id||s?.id||"";if(J(ge)){pe.debug(" Cache refresh triggered - clearing cache");try{const je=`student_active_tests_${ge}`,Ke=`student_results_table_${ge}`;localStorage.removeItem(je),localStorage.removeItem(Ke)}catch{}}else pe.debug(" Using existing cache - no refresh needed");try{localStorage.removeItem(`student_active_tests_${ge}`)}catch{}await h(ge),pe.debug(" Student Cabinet initialization complete!")}catch(ge){pe.error(" Error initializing student cabinet:",ge),_("Failed to initialize student cabinet")}finally{C(!1)}},[a,s,n]),J=S.useCallback(ge=>{if(window.studentCabinetRefreshRequested)return window.studentCabinetRefreshRequested=!1,pe.debug(" Manual refresh requested"),!0;if(window.recentTestCompleted)return window.recentTestCompleted=!1,pe.debug(" Test completed - cache refresh triggered"),!0;const Ne=localStorage.getItem(`last_cabinet_refresh_${ge}`);if(Ne&&Date.now()-parseInt(Ne)>1800*1e3)return pe.debug(" Time-based refresh triggered"),!0;try{for(let je=0;je<localStorage.length;je++){const Ke=localStorage.key(je);if(Ke&&Ke.startsWith(`retest_assignment_id_${ge}_`))return pe.debug(" Retest assignment key detected, forcing cache refresh:",Ke),!0}}catch{}return pe.debug(" No refresh triggers - using existing cache"),!1},[]);S.useCallback(async()=>{pe.debug(" Calculating average score...");try{if(d&&d.length>0){const ge=d.reduce((je,Ke)=>{const Ue=Ke.best_retest_score||Ke.score,It=Ke.best_retest_max_score||Ke.max_score;return typeof Ue=="number"&&typeof It=="number"&&It>0?je+Math.round(Ue/It*100):je},0),Ne=Math.round(ge/d.length);Z(Ne),pe.debug(" Average score calculated:",Ne)}}catch(ge){pe.error(" Error calculating average score:",ge)}},[d]),S.useEffect(()=>{if(V){pe.debug(" Skipping completed tests initialization during navigation");return}const ge=s?.student_id||s?.id;if(!ge){pe.debug(" Student ID not available yet, skipping localStorage initialization");return}const Ne=new Set;for(let je=0;je<localStorage.length;je++){const Ke=localStorage.key(je);if(Ke&&Ke.startsWith(`test_completed_${ge}_`)&&localStorage.getItem(Ke)==="true"){const It=Ke.replace(`test_completed_${ge}_`,"").split("_");if(It.length>=2){const rt=It[0],wt=It.slice(1).join("_"),xt=`${rt}_${wt}`;Ne.add(xt),pe.debug(" Found completed test in localStorage:",xt)}}}ee(Ne),B(!0),pe.debug(" Initialized completed tests from localStorage:",Array.from(Ne))},[s?.student_id,s?.id,V]),S.useEffect(()=>{pe.debug(" testResults structure:",d);const ge=d?.results||d;if(pe.debug(" resultsArray:",ge),ge&&ge.length>0){const Ne=s?.student_id||s?.id||"",je=new Set;ge.forEach(Ke=>{const Ue=`${Ke.test_type}_${Ke.test_id}`;je.add(Ue),localStorage.setItem(`test_completed_${Ne}_${Ke.test_type}_${Ke.test_id}`,"true")}),ee(Ke=>{const Ue=new Set([...Ke,...je]);return pe.debug(" Updated completed tests (merged):",Array.from(Ue)),Ue})}},[d,s?.student_id,s?.id]);const se=S.useCallback(async(ge,Ne,je=!1,Ke=null)=>{pe.debug(" Checking test completion:",ge,Ne,"retestAvailable:",je);try{const Ue=s?.student_id||s?.id||"";if(je){pe.debug(" Retest available from backend, checking attempt limits.");const xt=[];for(let Rt=1;Rt<=10;Rt++){const Mt=`retest_attempt${Rt}_${Ue}_${ge}_${Ne}`;localStorage.getItem(Mt)==="true"&&xt.push(Mt)}const lt=xt.length,pt=Ke?.retest_attempts_left||Ke?.max_attempts||3;return pe.debug(" Current attempts:",lt,"Max attempts:",pt,"Attempt keys:",xt),lt>=pt?(pe.debug(" Maximum retest attempts reached in localStorage"),!0):(pe.debug(" Retest attempts available, allowing start."),!1)}const It=`test_completed_${Ue}_${ge}_${Ne}`,rt=localStorage.getItem(It);if(pe.debug(" localStorage key:",It),pe.debug(" localStorage value:",rt),ge==="word_matching"){pe.debug(" Debug: All localStorage keys for student",Ue);for(let xt=0;xt<localStorage.length;xt++){const lt=localStorage.key(xt);lt&&lt.includes(Ue)&&lt.includes("word_matching")&&pe.debug(" Found word_matching key:",lt,"=",localStorage.getItem(lt))}}if(rt==="true")return pe.debug(" Found completion status in local storage:",rt),!0;const wt=d?.results||d;return wt&&wt.length>0&&(pe.debug(" Checking database results:",wt.length,"results"),wt.some(lt=>(pe.debug(" Checking result:",lt.test_type,lt.test_id,"vs",ge,Ne),lt.test_type===ge&&lt.test_id===Ne)))?(pe.debug(" Found completion status in database results"),localStorage.setItem(It,"true"),!0):(pe.debug(" Test not completed according to local storage or database"),!1)}catch(Ue){return pe.error(" Error checking test completion:",Ue),!1}},[d,s?.student_id,s?.id]),X=S.useCallback((ge,Ne)=>{const je={id:Date.now(),message:ge,type:Ne,timestamp:new Date};E(Ke=>[...Ke,je]),setTimeout(()=>{E(Ke=>Ke.filter(Ue=>Ue.id!==je.id))},C0.NOTIFICATION_DURATION)},[]),ie=S.useCallback(async ge=>{pe.debug(" Showing test details:",ge);try{await p(ge.test_type,ge.test_id,ge.test_name)}catch(Ne){pe.error("Error loading test details:",Ne),X("Failed to load test details","error")}},[p,X]),le=S.useCallback(ge=>{pe.debug(" Starting test:",ge);const Ne=`${ge.test_type}_${ge.test_id}`;if(ae.has(Ne)&&!ge?.retest_available){X("This test has already been completed","warning");return}if(pe.debug(" Checking retest conditions:"),pe.debug(" test.retest_available:",ge?.retest_available),pe.debug(" testKey:",Ne),pe.debug(" completedTests.has(testKey):",ae.has(Ne)),pe.debug(" completedTests:",Array.from(ae)),ge?.retest_available){const je=s?.student_id||s?.id||"",Ke=`retest1_${je}_${ge.test_type}_${ge.test_id}`;localStorage.setItem(Ke,"true"),pe.debug(" Set retest key:",Ke);try{const Ue=`test_completed_${je}_${ge.test_type}_${ge.test_id}`;localStorage.removeItem(Ue);const It=`${ge.test_type}_${ge.test_id}`;localStorage.removeItem(It),pe.debug(" Cleared completion keys for retest:",Ue,It);const rt=`retest_in_progress_${je}_${ge.test_type}_${ge.test_id}`;localStorage.setItem(rt,"1"),pe.debug(" Set in-progress retest lock:",rt);try{const wt=`anti_cheating_${je}_${ge.test_type}_${ge.test_id}`;localStorage.removeItem(wt);const xt=`speaking_test_data_${je}_${ge.test_id}`;localStorage.removeItem(xt);const lt=`speaking_progress_${ge.test_id}`;localStorage.removeItem(lt);const pt=`_${je}_${ge.test_type}_${ge.test_id}`,Rt=[];for(let Qe=0;Qe<localStorage.length;Qe++){const Re=localStorage.key(Qe);Re&&(Re.endsWith(pt)||Re.includes(`answers_${je}_${ge.test_type}_${ge.test_id}`)||Re.includes(`progress_${je}_${ge.test_type}_${ge.test_id}`)||Re.includes(`state_${je}_${ge.test_type}_${ge.test_id}`)||Re.includes(`selected_${je}_${ge.test_type}_${ge.test_id}`))&&Rt.push(Re)}Rt.forEach(Qe=>localStorage.removeItem(Qe)),pe.debug(" Cleared generic cached keys for retest start:",Rt);const Mt=`retest_attempts_${je}_${ge.test_type}_${ge.test_id}`;pe.debug(" Cleared per-test cached keys for retest start:",{antiCheatKey:wt,speakingCacheKey:xt,speakingProgressKey:lt})}catch{}}catch{}if(pe.debug(" Test retest_assignment_id:",ge.retest_assignment_id),pe.debug(" Test retest_assignment_id type:",typeof ge.retest_assignment_id),ge?.retest_assignment_id){const Ue=`retest_assignment_id_${je}_${ge.test_type}_${ge.test_id}`;localStorage.setItem(Ue,String(ge.retest_assignment_id)),pe.debug(" Set retest assignment ID:",Ue,"=",ge.retest_assignment_id)}else pe.debug(" No retest assignment ID found in test data")}else pe.debug(" Retest assignment ID storage skipped - retest not available");if(W(!0),pe.debug(" Set isStartingTest to true for test:",ge.test_type),ge.test_type==="matching_type"){pe.debug(" Redirecting to matching test page for testId:",ge.test_id),n(`/student/matching-test/${ge.test_id}`);return}if(ge.test_type==="word_matching"){pe.debug(" Redirecting to word matching test page for testId:",ge.test_id),n(`/student/word-matching-test/${ge.test_id}`);return}if(ge.test_type==="speaking"){pe.debug(" Redirecting to speaking test page for testId:",ge.test_id),n(`/student/speaking-test/${ge.test_id}`);return}n(`/student/test/${ge.test_type}/${ge.test_id}`)},[n,ae,X,s?.student_id,s?.id]),ce=S.useCallback(()=>{L(ge=>!ge)},[]),ke=S.useCallback(()=>{M(ge=>!ge)},[]),re=S.useCallback(async ge=>{if(pe.debug(" Starting test:",ge),V){pe.debug(" Test already starting, ignoring click");return}try{if(await se(ge.test_type,ge.test_id,ge?.retest_available,ge)&&!ge?.retest_available){X("This test has already been completed","warning");return}le(ge)}catch(Ne){pe.error(" Error starting test:",Ne),X("Failed to start test. Please try again.","error")}},[se,le,X,V]);return S.useCallback(ge=>{pe.debug(" Viewing test details:",ge),ie(ge)},[ie]),w?c.jsx(st.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:c.jsxs(st.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx(Ur,{size:"lg"}),c.jsx(st.p,{className:"mt-4 text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.3},children:"Loading Student Cabinet..."})]})}):k?c.jsx(st.div,{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:c.jsx(st.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:c.jsxs(st.div,{className:"bg-white border border-red-200 rounded-xl p-8 max-w-md shadow-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,duration:.3},children:[c.jsx(st.div,{className:"text-4xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.3,type:"spring"},children:""}),c.jsx("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Cabinet Error"}),c.jsx("p",{className:"text-red-600 mb-6",children:k}),c.jsx(Je,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):c.jsxs(st.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsx(st.div,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-6",children:[c.jsxs(st.div,{className:"flex items-center space-x-4",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(st.div,{className:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:c.jsx("span",{className:"text-white font-semibold text-xl",children:s?.name?.charAt(0)||"S"})})}),c.jsxs("div",{children:[c.jsxs("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold text-white",children:[s?.name," ",s?.surname]}),c.jsxs("p",{className:"text-blue-100 text-sm sm:text-base md:text-lg",children:["Grade ",s?.grade," - Class ",s?.class]})]})]}),c.jsxs(st.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsxs("button",{onClick:t,className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",style:{zIndex:1e3},children:[c.jsx("span",{className:"hidden sm:inline",children:"Menu"}),c.jsx(st.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:e?180:0},transition:{duration:.2},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),c.jsx(fo,{children:e&&c.jsx(st.div,{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:c.jsxs("div",{className:"py-2",children:[c.jsx(st.button,{onClick:r,className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),c.jsx(st.button,{onClick:()=>{t(),i()},className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),c.jsxs(st.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:[c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:c.jsx("div",{className:"lg:col-span-1 space-y-6",children:Y!==null&&c.jsx(st.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7,duration:.5},children:c.jsxs(At,{children:[c.jsx(At.Header,{children:c.jsx(At.Title,{children:"Average Score"})}),c.jsx(At.Body,{children:c.jsxs(st.div,{className:"text-center",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.8,duration:.3},children:[c.jsxs(st.div,{className:"text-4xl font-bold text-blue-600 mb-2",initial:{scale:0},animate:{scale:1},transition:{delay:.9,duration:.5,type:"spring"},children:[Y,"%"]}),c.jsx("p",{className:"text-sm text-gray-500",children:"Overall Performance"})]})})]})})})}),c.jsxs("div",{className:"space-y-6",children:[c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:c.jsxs(At,{children:[c.jsx(At.Header,{children:c.jsx(At.Title,{className:"text-center",children:"Active Tests"})}),c.jsx(At.Body,{children:u&&u.length>0?c.jsxs("div",{className:"relative",children:[pe.debug(" Rendering overlay, isStartingTest:",V),V&&c.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50 rounded-lg border-2 border-blue-200",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Starting test..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait..."})]})}),c.jsxs("div",{className:"space-y-4",children:[(ne?u:u.slice(0,3)).map((ge,Ne)=>c.jsx(st.div,{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:ne?0:.7+Ne*.1,duration:.3},whileHover:{scale:1.02},children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsx("div",{className:"flex-1",children:c.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[c.jsx("h3",{className:"text-sm sm:text-lg font-medium text-gray-900 w-16 sm:w-auto break-words leading-tight line-clamp-2 sm:line-clamp-none",children:ge.test_name}),c.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:ge.subject}),c.jsx("span",{className:"text-gray-500",children:ge.teacher_name}),c.jsxs("span",{className:"text-gray-500",children:[c.jsx("span",{className:"sm:hidden",children:new Date(ge.assigned_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}),c.jsx("span",{className:"hidden sm:inline",children:new Date(ge.assigned_at).toLocaleDateString()})]})]})}),c.jsx("div",{className:"flex space-x-2 ml-4",children:(()=>{const je=`${ge.test_type}_${ge.test_id}`,Ke=ae.has(je);if(!I)return c.jsx(Je,{variant:"secondary",size:"sm",disabled:!0,className:"bg-gray-100 text-gray-500 border-gray-200",children:"Loading..."});if(Ke&&ge?.retest_available){const Ue=s?.student_id||s?.id||"";let It=!1;try{const rt=localStorage.getItem(`retest_attempts_${Ue}_${ge.test_type}_${ge.test_id}`);if(rt){const wt=JSON.parse(rt);typeof wt?.used=="number"&&typeof wt?.max=="number"&&wt.used>=wt.max&&(It=!0)}}catch{}return It?c.jsx(Je,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):c.jsx(Je,{variant:"primary",size:"sm",onClick:()=>re(ge),disabled:V,children:"Start Retest"})}return Ke?c.jsx(Je,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):(pe.debug(" Button render, isStartingTest:",V,"test:",ge.test_type),c.jsx(Je,{variant:"primary",size:"sm",onClick:()=>re(ge),disabled:V,children:"Start Test"}))})()})]})},`${ge.test_type}_${ge.test_id}`)),u.length>3&&c.jsx("div",{className:"text-center pt-2",children:c.jsx("button",{onClick:ce,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:ne?"Show Less":`Show ${u.length-3} More`})})]})]}):c.jsxs(st.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.3},children:[c.jsx(st.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.8,duration:.5,type:"spring"},children:""}),c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Active Tests"}),c.jsx("p",{className:"text-gray-500",children:"No active tests available for your class at the moment."})]})})]})}),c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:c.jsxs(At,{children:[c.jsx(At.Header,{children:c.jsx(At.Title,{children:"Test Results"})}),c.jsx(At.Body,{children:d&&d.showResults?c.jsx(Uv,{testResults:d,onBackToCabinet:()=>{setTestResults(null)},onRetakeTest:(ge,Ne)=>{h(),setTestResults(null)},isLoading:w}):c.jsx(WB,{compact:!0,showAll:H,onToggleShowAll:ke,maxInitial:3})})]})})]})]}),c.jsx(FB,{isOpen:x.isOpen,onClose:v,testType:x.testType,testId:x.testId,testName:x.testName,questions:x.questions||[],isLoading:x.isLoading||!1}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:N.map(ge=>c.jsx(ac,{type:ge.type,message:ge.message,onClose:()=>E(Ne=>Ne.filter(je=>je.id!==ge.id))},ge.id))})]})},Zae=({testInfo:e,questions:t,testType:r,studentAnswers:n,onBackToCabinet:s,checkAnswerCorrectness:a,formatStudentAnswerForDisplay:i,getCorrectAnswer:o})=>{const[l,u]=S.useState(0),[d,h]=S.useState(0),[g,p]=S.useState(!0);if(S.useEffect(()=>{const w=()=>{try{const C=xf(t,n,r).score,k=e?.num_questions||t?.length||0,_=k>0?Math.round(C/k*100):0;u(C),h(_),p(!1)}catch(C){console.error("Error calculating test results:",C),u(0),h(0),p(!1)}};t&&t.length>0?w():p(!1)},[t,n,r,e,xf]),g)return c.jsx("div",{className:"flex justify-center items-center min-h-64",children:c.jsx("div",{className:"text-lg",children:"Calculating results..."})});const x=e?.num_questions||t?.length||0,v=e?.test_name||e?.title||"Test";return c.jsxs("div",{className:"test-results-page max-w-4xl mx-auto p-6 overflow-y-auto min-h-screen",children:[c.jsx(At,{className:"mb-6",children:c.jsxs("div",{className:"results-header text-center",children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:["Test Results: ",v]}),c.jsx("p",{className:"text-gray-600",children:r==="matching_type"?"Matching Test":r==="multiple_choice"?"Multiple Choice Test":r==="true_false"?"True/False Test":r==="input"?"Input Test":r==="drawing"?"Drawing Test":"Test"})]})}),c.jsx(At,{className:"mb-6",children:c.jsxs("div",{className:"results-summary",children:[c.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 text-center",children:["Your Score: ",l," / ",x," (",d,"%)"]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-4",children:c.jsx("div",{className:`h-4 rounded-full transition-all duration-500 ${d>=80?"bg-green-500":d>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${d}%`}})}),c.jsx("div",{className:"text-center",children:c.jsx("p",{className:`text-lg font-medium ${d>=80?"text-green-600":d>=60?"text-yellow-600":"text-red-600"}`,children:d>=80?"Excellent!":d>=60?"Good job!":"Keep practicing!"})})]})}),t&&t.length>0&&c.jsx(At,{className:"mb-6",children:c.jsxs("div",{className:"questions-review",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Question Review"}),c.jsx("div",{className:"space-y-4",children:t.map((w,C)=>{const k=n[String(w.question_id)]||"No answer";console.log(" TestResultsDisplay - Question",C+1,":",{question:w,studentAnswer:k,testType:r});const _=a(w,k,r);return console.log(" TestResultsDisplay - isCorrect result:",_),c.jsxs("div",{className:`question-review p-4 rounded-lg border-2 ${_?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[c.jsxs("div",{className:"question-review-header flex justify-between items-start mb-3",children:[c.jsxs("h4",{className:"text-lg font-medium text-gray-800",children:["Question ",C+1]}),c.jsx("span",{className:`text-2xl font-bold ${_?"text-green-600":"text-red-600"}`,children:_?"":""})]}),c.jsx("div",{className:"question-text mb-3",children:c.jsx("p",{className:"text-gray-700 font-medium",children:w.question})}),c.jsxs("div",{className:"answer-section space-y-2",children:[c.jsxs("p",{className:"student-answer",children:[c.jsx("strong",{className:"text-gray-600",children:"Your Answer:"})," ",c.jsx("span",{className:`font-medium ${_?"text-green-700":"text-red-700"}`,children:i(k,r,w)})]}),!_&&c.jsxs("p",{className:"correct-answer",children:[c.jsx("strong",{className:"text-gray-600",children:"Correct Answer:"})," ",c.jsx("span",{className:"text-green-700 font-medium",children:r==="multiple_choice"?String(w.correct_answer||"").toUpperCase():i(o(w,r),r,w)})]})]})]},w.question_id||C)})})]})}),c.jsx(At,{children:c.jsx("div",{className:"results-actions text-center",children:c.jsx(Je,{onClick:s,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 text-lg font-medium",children:"Back to Cabinet"})})})]})};class eie{constructor(){this.activeRequests=new Map,this.completedRequests=new Map,this.maxCacheSize=100,this.cacheTimeout=3e4}generateKey(t,r,n={}){const s=Object.keys(n).sort().reduce((a,i)=>(a[i]=n[i],a),{});return`${t}_${r}_${JSON.stringify(s)}`}isRequestInProgress(t){return this.activeRequests.has(t)}getCachedResult(t){const r=this.completedRequests.get(t);return r&&Date.now()-r.timestamp<this.cacheTimeout?r.result:null}startRequest(t,r){return this.activeRequests.set(t,r),r.finally(()=>{this.activeRequests.delete(t)}),r}cacheResult(t,r){if(this.completedRequests.size>=this.maxCacheSize){const n=this.completedRequests.keys().next().value;this.completedRequests.delete(n)}this.completedRequests.set(t,{result:r,timestamp:Date.now()})}async deduplicateApiCall(t,r,n,s){const a=this.generateKey(t,r,n);if(this.isRequestInProgress(a))return console.log(" API deduplication: Request already in progress, waiting...",a),this.activeRequests.get(a);const i=this.getCachedResult(a);if(i)return console.log(" API deduplication: Using cached result",a),i;console.log(" API deduplication: Making new request",a);const o=this.startRequest(a,s());try{const l=await o;return this.cacheResult(a,l),l}catch(l){throw l}}clearCache(){this.activeRequests.clear(),this.completedRequests.clear(),console.log(" API deduplication: Cache cleared")}}const EF=new eie,tie=(e,t)=>{let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>e.apply(null,n),t)}},rie=({onBackToCabinet:e,currentTest:t})=>{const r=vo(),{user:n,isAuthenticated:s}=Qn(),{activeTests:a,loadActiveTests:i}=$v(),o=S.useCallback(tie((Oe,at,Ce)=>{try{if(window.skipInitialProgressSave&&Ce.answers&&Ce.answers.length===0){pe.debug(" Skipping empty progress save during restoration"),window.skipInitialProgressSave=!1;return}const Ze=`test_progress_${n?.student_id||n?.id||"unknown"}_${Oe}_${at}`,Ft=localStorage.getItem(Ze);if(Ft&&Ce.answers&&Ce.answers.length===0)try{const zt=JSON.parse(Ft);if(zt.answers&&zt.answers.length>0){pe.debug(" Skipping empty progress save - existing progress is better:",zt.answers);return}}catch{}localStorage.setItem(Ze,JSON.stringify(Ce)),pe.debug(`Saved test progress for ${Oe}_${at}:`,Ce)}catch(Ve){pe.error("Error saving test progress:",Ve)}},1e3),[n?.student_id,n?.id]),l=S.useCallback((Oe,at,Ce)=>{o(Oe,at,Ce)},[o]),u=S.useCallback((Oe,at)=>{try{const Ve=`test_progress_${n?.student_id||n?.id||"unknown"}_${Oe}_${at}`,Ze=localStorage.getItem(Ve);return Ze?JSON.parse(Ze):null}catch(Ce){return pe.error("Error getting test progress:",Ce),null}},[n?.student_id,n?.id]),d=S.useCallback((Oe,at)=>{try{const Ce=n?.student_id||n?.id||"unknown",Ve=`test_progress_${Ce}_${Oe}_${at}`;localStorage.removeItem(Ve);for(let Ze=0;Ze<localStorage.length;Ze++){const Ft=localStorage.key(Ze);Ft&&Ft.startsWith(`test_progress_${Ce}_${Oe}_${at}_`)&&(localStorage.removeItem(Ft),pe.debug(` Cleared individual question key: ${Ft}`))}pe.debug(`Cleared test progress for ${Oe}_${at}`)}catch(Ce){pe.error("Error clearing test progress:",Ce)}},[n?.student_id,n?.id]),[h,g]=S.useState(!0),[p,x]=S.useState(!1),[v,w]=S.useState(""),[C,k]=S.useState(!1),[_,N]=S.useState(""),[E,P]=S.useState([]),[F,A]=S.useState(t?"test":"list"),[j,R]=S.useState(null),[U,Y]=S.useState(null),[Z,ae]=S.useState(null),[ee,ne]=S.useState([]),[L,H]=S.useState([]),[M,V]=S.useState(0),[W,I]=S.useState(0),[B,q]=S.useState(null),J=Ss.useRef(null),se=Ss.useRef(null),[X,ie]=S.useState(!1),[le,ce]=S.useState(!1),[ke,re]=S.useState(null),[ge,Ne]=S.useState(null),[je,Ke]=S.useState(!1),[Ue,It]=S.useState(!1),[rt,wt]=S.useState({isInitialized:!1,initializationId:null,lastTestId:null,initializationCount:0}),[xt,lt]=S.useState({isRestored:!1,restoredTestId:null,restorationCount:0}),{startTracking:pt,stopTracking:Rt,getCheatingData:Mt,clearData:Qe,isCheating:Re,tabSwitches:Be}=qm(j?.test_type,j?.test_id,n?.student_id||n?.id);S.useEffect(()=>{(()=>{const at=[];for(let Ce=0;Ce<localStorage.length;Ce++){const Ve=localStorage.key(Ce);if(Ve&&Ve.startsWith("test_progress_")&&!Ve.includes("_51712_")&&!Ve.includes("_51736_")){const Ze=Ve.split("_");Ze.length===4&&Ze[0]==="test"&&Ze[1]==="progress"&&at.push(Ve)}}at.forEach(Ce=>{localStorage.removeItem(Ce),pe.debug(" Cleared old cache key:",Ce)})})()},[]);const ct=S.useCallback(()=>{const Oe=j?.test_id,at=n?.student_id||n?.id;if(!at||!Oe)return pe.debug(" Skipping initialization - missing required data:",{studentId:at,currentTestId:Oe}),!1;const Ce=`${at}_${Oe}_${Date.now()}`;return rt.isInitialized&&rt.lastTestId===Oe?(pe.debug(" Already initialized for this test - skipping"),!1):rt.initializationId?(pe.debug(" Initialization in progress - skipping duplicate"),!1):(pe.debug(" Starting initialization:",Ce),wt({isInitialized:!1,initializationId:Ce,lastTestId:Oe}),!0)},[rt,j,n?.student_id,n?.id]),We=S.useCallback(()=>{wt(Oe=>({...Oe,isInitialized:!0,initializationId:null})),pe.debug(" Initialization completed")},[]),nt=S.useCallback(async()=>{pe.debug(" Initializing Student Tests...");try{if(g(!0),N(""),!s||!n){pe.debug(" User not authenticated"),N("User not authenticated");return}if(n.role!==Hi.STUDENT){pe.error(" Invalid user role for student tests:",n.role),N("Access denied. Student role required.");return}pe.debug(" Loading active tests..."),await i(),We(),pe.debug(" Student Tests initialization complete!")}catch(Oe){pe.error(" Error initializing student tests:",Oe),N("Failed to initialize student tests")}finally{g(!1)}},[s,n,i,We]);S.useEffect(()=>{ct()&&nt()},[ct,nt]),S.useEffect(()=>{t&&(pe.debug(" Auto-starting test from prop:",t),k(!0),Vt(t))},[t]),S.useCallback(async()=>{pe.debug(" Loading student active tests...");try{const Oe=await cn.getActiveTests();pe.debug(" Active tests loaded:",Oe);const at=Oe.map(Ce=>({...Ce,subject_id:Ce.subject_id||Ce.subjectId,teacher_id:Ce.teacher_id||Ce.teacherId,is_active:Ce.is_active!==void 0?Ce.is_active:!0,created_at:Ce.created_at||Ce.createdAt,updated_at:Ce.updated_at||Ce.updatedAt}));return Ne(new Date),at}catch(Oe){throw pe.error(" Error loading active tests:",Oe),Oe}},[]),S.useCallback(async(Oe,at)=>{pe.debug(" Checking test completion:",Oe,at);try{const Ce=u(Oe,at);return Ce&&Ce.completed}catch(Ce){return pe.error(" Error checking test completion:",Ce),!1}},[u]),S.useEffect(()=>{if(ee.length>0&&j?.test_id){const Oe=setTimeout(()=>{let at=!1;const Ce=new Array(ee.length).fill("");if(ee.forEach((Ve,Ze)=>{const zt=`test_progress_${n?.student_id||n?.id||"unknown"}_${U}_${j?.test_id}_${Ve.question_id}`,er=localStorage.getItem(zt);if(er){const hr=er.replace(/^"(.*)"$/,"$1");Ce[Ze]=hr,at=!0}}),at){H(Ce);const Ve=Ce.filter(Ft=>Ft&&typeof Ft=="string"&&Ft.trim()!=="").length,Ze=ee.length>0?Ve/ee.length*100:0;V(Ze)}},100);return()=>clearTimeout(Oe)}},[ee,U,j?.test_id]);const Tt=S.useCallback(async(Oe,at)=>{pe.debug(" Marking test as completed:",Oe,at);try{const Ce=u(Oe,at)||{};Ce.completed=!0,Ce.completedAt=new Date().toISOString(),l(Oe,at,Ce);const Ze=`test_completed_${n?.student_id||n?.id||""}_${Oe}_${at}`;localStorage.setItem(Ze,"true"),pe.debug(" Test completion marked in localStorage:",Ze),pe.debug(" localStorage value after setting:",localStorage.getItem(Ze)),me("Test marked as completed","success")}catch(Ce){pe.error(" Error marking test as completed:",Ce),me("Failed to mark test as completed","error")}},[u,l]),jt=S.useCallback(Oe=>{pe.debug(" Showing test details:",Oe),re(Oe),ce(!0)},[]),Vt=S.useCallback(async Oe=>{pe.debug(" Starting test:",Oe);let at=Date.now(),Ce;try{w(""),x(!0),at=Date.now();const Ve=()=>{const Ee=Date.now()-at,ut=Math.max(0,250-Ee);setTimeout(()=>{g(!1),x(!1)},ut)};let Ze=!1;Ce=setTimeout(()=>{Ze=!0,w("Loading is taking longer than expected...")},15e3);const zt=`test_completed_${n?.student_id||n?.id||""}_${Oe.test_type}_${Oe.test_id}`,er=localStorage.getItem(zt)==="true";if(er&&!Oe?.retest_available){pe.debug(" Test already completed, redirecting to main cabinet"),me("This test has already been completed","info"),r("/student");return}if(er&&Oe?.retest_available&&pe.debug(" Test completed but retest available, allowing retest"),Oe.test_type===Cn.MATCHING){pe.debug(" Redirecting to matching test page for testId:",Oe.test_id),r(`/student/matching-test/${Oe.test_id}`);return}if(Oe.test_type===Cn.WORD_MATCHING){pe.debug(" Redirecting to word matching test page for testId:",Oe.test_id),r(`/student/word-matching-test/${Oe.test_id}`);return}R(Oe),Y(Oe.test_type),lt({isRestored:!1,restoredTestId:null,restorationCount:0});const[hr,ir]=await Promise.all([EF.deduplicateApiCall("GET",`test-info-${Oe.test_type}-${Oe.test_id}`,{testType:Oe.test_type,testId:Oe.test_id},()=>cn.getTestInfo(Oe.test_type,Oe.test_id)),EF.deduplicateApiCall("GET",`test-questions-${Oe.test_type}-${Oe.test_id}`,{testType:Oe.test_type,testId:Oe.test_id},()=>cn.getTestQuestions(Oe.test_type,Oe.test_id))]);ae(hr);let Wr=ir;try{if(!!hr?.is_shuffled){const Xe=n?.student_id||n?.id||"unknown",ut=`${Xe}:${Oe.test_type}:${Oe.test_id}`,ft=Array.from(ut).reduce((Ht,yr)=>(Ht<<5)-Ht+yr.charCodeAt(0),0)>>>0,Kt=`test_shuffle_order_${Xe}_${Oe.test_type}_${Oe.test_id}`,Ct=localStorage.getItem(Kt);if(Ct){const Ht=JSON.parse(Ct),yr=new Map(ir.map(wr=>[wr.question_id,wr]));Wr=Ht.map(wr=>yr.get(wr)).filter(Boolean)}else{const yr=function(vr){return function(){var Er=vr+=1831565813;return Er=Math.imul(Er^Er>>>15,Er|1),Er^=Er+Math.imul(Er^Er>>>7,Er|61),((Er^Er>>>14)>>>0)/4294967296}}(ft);Wr=[...ir];for(let vr=Wr.length-1;vr>0;vr--){const Er=Math.floor(yr()*(vr+1));[Wr[vr],Wr[Er]]=[Wr[Er],Wr[vr]]}const wr=Wr.map(vr=>vr.question_id);localStorage.setItem(Kt,JSON.stringify(wr))}}}catch(Ee){pe.error("Shuffle error (ignored):",Ee)}ne(Wr),Ve();const ue=Oe.test_id;if(xt.isRestored&&xt.restoredTestId===ue){pe.debug(" Progress already restored for this test - skipping");return}pe.debug(" Starting progress restoration for test:",Oe.test_type,Oe.test_id),lt(Ee=>({...Ee,restorationCount:Ee.restorationCount+1}));const be=n?.student_id||n?.id||"unknown",ye=`test_progress_${be}_${Oe.test_type}_${Oe.test_id}`,xe=localStorage.getItem(ye);pe.debug(" Checking main progress key:",ye),pe.debug(" Main progress data:",xe);let _e=new Array(ir.length).fill("");if(xe)try{const Ee=JSON.parse(xe);pe.debug(" Parsed progress data:",Ee),Ee.answers&&Array.isArray(Ee.answers)&&(_e=Ee.answers,pe.debug(" Loaded answers from main progress:",_e))}catch(Ee){pe.error(" Error parsing main progress:",Ee)}ir.forEach((Ee,Xe)=>{const ut=`test_progress_${be}_${Oe.test_type}_${Oe.test_id}_${Ee.question_id}`,ft=localStorage.getItem(ut);if(pe.debug(` Checking individual answer for question ${Ee.question_id}:`,ft),ft){const Kt=ft.replace(/^"(.*)"$/,"$1");_e[Xe]=Kt,pe.debug(` Loaded individual answer for question ${Ee.question_id}:`,Kt)}}),pe.debug(" Final initial answers after loading all sources:",_e);const Se=_e.filter(Ee=>Ee&&typeof Ee=="string"&&Ee.trim()!=="").length;if(Se>0){pe.debug(` Restoring progress: ${Se}/${ir.length} questions answered`),H(_e);const Ee=ir.length>0?Se/ir.length*100:0;V(Ee),pe.debug(` Progress restored: ${Ee}% complete`)}else pe.debug(" No existing progress found - starting fresh"),H(_e),V(0);lt(Ee=>({...Ee,isRestored:!0,restoredTestId:ue})),Se>0&&(pe.debug(" Existing progress found - preventing overwrite during initialization"),window.skipInitialProgressSave=!0);const He=Number(hr?.allowed_time||0),it=n?.student_id||n?.id||"unknown";if(J.current=`test_timer_${it}_${Oe.test_type}_${Oe.test_id}`,He>0)try{const Ee=localStorage.getItem(J.current),Xe=Date.now();if(Ee){const ut=JSON.parse(Ee),ft=Math.floor((Xe-new Date(ut.lastTickAt).getTime())/1e3),Kt=Math.max(0,Number(ut.remainingSeconds||He)-Math.max(0,ft));I(Kt),se.current=Xe}else I(He),se.current=Xe,localStorage.setItem(J.current,JSON.stringify({remainingSeconds:He,lastTickAt:new Date(Xe).toISOString(),startedAt:new Date(Xe).toISOString()}))}catch(Ee){pe.error("Timer cache init error:",Ee),I(He)}else I(0);const Ye=new Date;q(Ye),pe.debug(" Test timer started at:",Ye.toISOString());const oe=n?.student_id||n?.id||"unknown",fe=`anti_cheating_${oe}_${Oe.test_type}_${Oe.test_id}`,Te=localStorage.getItem(fe);if(pe.debug(" Checking for anti-cheating data with key:",fe),pe.debug(" Key format: anti_cheating_{studentId}_{testType}_{testId}"),pe.debug(" Current test details:",{testType:Oe.test_type,testId:Oe.test_id,studentId:oe}),Te)try{const Ee=JSON.parse(Te);pe.debug(" Found existing anti-cheating data for THIS test:",Ee),pe.debug(" Visibility change times for this test:",Ee.tabSwitches||0),pe.debug(" Cheating status for this test:",Ee.isCheating||!1),Ee.isCheating&&(pe.debug(" WARNING: Student has been flagged for cheating in THIS test!"),pe.debug(" Tab switches detected in this test:",Ee.tabSwitches),me(` Warning: Suspicious activity detected in this test (${Ee.tabSwitches} tab switches). Continued violations may result in test disqualification.`,"warning"))}catch(Ee){pe.error(" Error parsing existing anti-cheating data:",Ee)}else pe.debug(" No existing anti-cheating data found for this test - starting fresh");pt(),pe.debug(" Anti-cheating tracking started"),A("test"),pe.debug(" Test started successfully")}catch(Ve){pe.error(" Error starting test:",Ve),me("Failed to start test","error"),w("Failed to load test data. Please try again.")}finally{const Ve=Date.now()-at,Ft=Math.max(0,250-Ve);setTimeout(()=>{g(!1),x(!1)},Ft),k(!1);try{Ce&&clearTimeout(Ce)}catch{}}},[u]),fr=S.useCallback(async()=>{if(!j||!Z||!ee||!L){me("No test data to submit","error");return}pe.debug(" Submitting test:",j);try{ie(!0);const Oe=xf(ee,L,j.test_type),at=new Date,Ce=B?Math.round((at-B)/1e3):0,Ve=B?B.toISOString():at.toISOString();pe.debug(" Test timing:",{startedAt:Ve,endTime:at.toISOString(),timeTaken:`${Ce} seconds`});const Ze=Mt();pe.debug(" Anti-cheating data for submission:",Ze);const Ft={};ee.forEach((er,hr)=>{Ft[er.question_id]=L[hr]??""}),j.test_type==="drawing"&&(pe.debug(" Drawing test answers being submitted:",L),pe.debug(" Drawing test answers type:",typeof L[0]),pe.debug(" Drawing test answers content:",L[0]));const zt=await cn.submitTest(j.test_type,j.test_id,L,{time_taken:(()=>{const er=Number(Z?.allowed_time||0);return er>0?Math.min(Ce,er):Ce})(),started_at:Ve,submitted_at:at.toISOString(),answers_by_id:Ft,question_order:ee.map(er=>er.question_id),caught_cheating:Ze.caught_cheating,visibility_change_times:Ze.visibility_change_times,retest_assignment_id:(()=>{const hr=`retest_assignment_id_${n?.student_id||n?.id||""}_${j.test_type}_${j.test_id}`,ir=localStorage.getItem(hr);return pe.debug(" Frontend retest key:",hr),pe.debug(" Frontend retest assignment ID from localStorage:",ir),pe.debug(" Frontend retest assignment ID converted:",ir?Number(ir):null),pe.debug(" Frontend current test data:",j),pe.debug(" Frontend current test retest_assignment_id:",j.retest_assignment_id),ir?Number(ir):null})(),parent_test_id:j.test_id},n);if(pe.debug(" Test submission result:",zt),zt.success){window.recentTestCompleted=!0,pe.debug(" Test completed - cache refresh triggered");const er=n?.student_id||n?.id||"",hr=`retest1_${er}_${j.test_type}_${j.test_id}`;if(localStorage.getItem(hr)==="true"){const xe=j?.retest_attempts_left||j?.max_attempts||3;if((zt?.percentage_score??0)>=50){const Se=`retest_attempt${xe}_${er}_${j.test_type}_${j.test_id}`;localStorage.setItem(Se,"true"),pe.debug(" Passed retest, marking last-slot key:",Se),localStorage.removeItem(hr)}else{let Se=1;for(let it=1;it<=10;it++){const Ye=`retest_attempt${it}_${er}_${j.test_type}_${j.test_id}`;if(localStorage.getItem(Ye)!=="true"){Se=it;break}}const He=`retest_attempt${Se}_${er}_${j.test_type}_${j.test_id}`;localStorage.setItem(He,"true"),pe.debug(" Marked retest attempt as completed:",He),Se>=xe&&localStorage.removeItem(hr)}}if(pe.debug(" Marking test as completed..."),await Tt(j.test_type,j.test_id),j.test_type!=="drawing"){pe.debug(" Caching test results after submission...");const _e=`student_results_table_${n?.student_id||n?.id||"unknown"}`,{setCachedData:Se,CACHE_TTL:He}=await Gi(async()=>{const{setCachedData:it,CACHE_TTL:Ye}=await Promise.resolve().then(()=>Hg);return{setCachedData:it,CACHE_TTL:Ye}},void 0);Se(_e,zt,He.student_results_table),pe.debug(" Test results cached with key:",_e)}else pe.debug(" Drawing test submitted - not caching results (will appear after teacher grades)");pe.debug(" Clearing test progress..."),d(j.test_type,j.test_id);try{const xe=n?.student_id||n?.id||"unknown",_e=`test_timer_${xe}_${j.test_type}_${j.test_id}`;localStorage.removeItem(_e);const Se=`test_shuffle_order_${xe}_${j.test_type}_${j.test_id}`;localStorage.removeItem(Se)}catch{}if(n?.student_id){const xe=`test_completed_${n.student_id}_${j.test_type}_${j.test_id}`;localStorage.setItem(xe,"true"),pe.debug(" Test marked as completed in localStorage:",xe)}try{const xe=n?.student_id||n?.id||"",_e=`retest1_${xe}_${j.test_type}_${j.test_id}`,Se=`retest_assignment_id_${xe}_${j.test_type}_${j.test_id}`;localStorage.removeItem(_e),localStorage.removeItem(Se),pe.debug(" Cleared retest keys:",_e,Se)}catch(xe){pe.warn("Failed to clear retest keys:",xe)}pe.debug(" Clearing test progress and anti-cheating data for THIS test only...");const Wr=n?.student_id||n?.id||"unknown",ue=[],be=`test_progress_${Wr}_${j.test_type}_${j.test_id}`,ye=`anti_cheating_${Wr}_${j.test_type}_${j.test_id}`;for(let xe=0;xe<localStorage.length;xe++){const _e=localStorage.key(xe);_e&&(_e===be||_e===ye)&&ue.push(_e)}ue.forEach(xe=>{localStorage.removeItem(xe),pe.debug(` Cleared for THIS test only: ${xe}`)}),pe.debug(" Clearing anti-cheating data..."),Rt(),Qe(),j.test_type!=="drawing"?A("results"):r("/student"),me("Test submitted successfully!","success"),pe.debug(" Test submitted successfully")}else throw pe.error(" Test submission failed:",zt.error),new Error(zt.error||"Failed to submit test")}catch(Oe){pe.error(" Error submitting test:",Oe),me("Failed to submit test","error")}finally{ie(!1)}},[j,Z,ee,L,Tt,d]);S.useCallback(()=>(pe.debug(" Collecting test answers..."),L),[L]);const Dr=S.useCallback(()=>{if(!ee||!L)return;const Oe=L.filter(Ce=>Ce&&typeof Ce=="string"&&Ce.trim()!=="").length,at=ee.length>0?Oe/ee.length*100:0;if(V(at),pe.debug(` Progress updated: ${Oe}/${ee.length} questions answered (${Math.round(at)}%)`),j){const Ce={answers:L,progress:at,lastSaved:new Date().toISOString()};l(j.test_type,j.test_id,Ce)}},[ee,L,j,l]);S.useEffect(()=>{Dr()},[Dr]);const zr=S.useCallback(()=>{if(!L)return 0;const Oe=L.filter(at=>at&&typeof at=="string"&&at.trim()!=="").length;return pe.debug(" getAnsweredCount:",{studentAnswers:L,answeredCount:Oe,totalQuestions:ee?.length}),Oe},[L,ee]),or=S.useCallback(()=>{if(pe.debug(" Navigating back to cabinet..."),j&&n?.student_id){pe.debug(" Cabinet navigation detected - counting as cheating attempt");const at=`anti_cheating_${n?.student_id||n?.id||"unknown"}_${j.test_type}_${j.test_id}`,Ce=localStorage.getItem(at);let Ve=0,Ze=!1;if(Ce)try{const hr=JSON.parse(Ce);Ve=hr.tabSwitches||0,Ze=hr.isCheating||!1}catch(hr){pe.error(" Error parsing existing anti-cheating data:",hr)}const Ft=Ve+1,zt=Ft>=2;pe.debug(` Tab switch count: ${Ve}  ${Ft} (cheating: ${zt})`);const er={tabSwitches:Ft,isCheating:zt,lastUpdated:new Date().toISOString()};localStorage.setItem(at,JSON.stringify(er)),pe.debug(" Anti-cheating data updated for cabinet navigation:",er)}e?e():r("/student")},[e,r,j,n?.student_id]);S.useCallback(()=>{pe.debug(" Showing test results..."),A("results")},[]);const nr=S.useCallback((Oe,at,Ce=null)=>{switch(pe.debug(" Formatting student answer for display:",Oe,"testType:",at,"question:",Ce),at){case Cn.MULTIPLE_CHOICE:if(Oe.toString().startsWith("Option "))return Oe;if(Ce&&typeof Oe=="string"&&!isNaN(parseInt(Oe))){const Ve=parseInt(Oe),Ze=`option_${String.fromCharCode(97+Ve)}`,Ft=Ce[Ze];if(Ft)return pe.debug(" Converted",Oe,"to option text:",Ft),Ft;{const zt=String.fromCharCode(65+Ve);return pe.debug(" Converted",Oe,"to",zt),zt}}else{if(typeof Oe=="string"&&isNaN(parseInt(Oe)))return pe.debug(" Already formatted text:",Oe),Oe;{const Ve=String.fromCharCode(65+parseInt(Oe));return pe.debug(" Converted",Oe,"to",Ve),Ve}}case Cn.TRUE_FALSE:return Oe==="true"?"True":"False";case Cn.INPUT:return Oe;case Cn.MATCHING:return typeof Oe=="object"?JSON.stringify(Oe):Oe;case Cn.WORD_MATCHING:return typeof Oe=="object"?JSON.stringify(Oe):Oe;case Cn.DRAWING:return Oe&&Oe.trim()!==""?"Drawing submitted":"No drawing";case Cn.FILL_BLANKS:return Oe;default:return pe.warn(" Unknown test type for answer formatting:",at),Oe}},[]),me=S.useCallback((Oe,at)=>{const Ce={id:Date.now(),message:Oe,type:at,timestamp:new Date};P(Ve=>[...Ve,Ce]),setTimeout(()=>{P(Ve=>Ve.filter(Ze=>Ze.id!==Ce.id))},C0.NOTIFICATION_DURATION)},[]);S.useEffect(()=>{Dr()},[Dr]),S.useEffect(()=>{if(F!=="test")return;const Oe=Number(Z?.allowed_time||0);if(!Oe)return;const at=setInterval(()=>{I(Ce=>{const Ve=Math.max(0,Ce-1);try{const Ze=Date.now();se.current||(se.current=Ze),J.current&&localStorage.setItem(J.current,JSON.stringify({remainingSeconds:Ve,lastTickAt:new Date(Ze).toISOString(),startedAt:B?B.toISOString():new Date(Ze-(Oe-Ve)*1e3).toISOString()}))}catch{}return Ve===0&&fr(),Ve})},1e3);return()=>clearInterval(at)},[F,Z?.allowed_time,fr,B]);const Ae=S.useCallback((Oe,at)=>{if(!Oe)return null;const Ce=(Ve,Ze)=>{const Ft=[...L];Ft[at]=Ze,H(Ft),pe.debug(` Answer changed: question ${Ve} = ${Ze}`),pe.debug(" Updated studentAnswers:",Ft)};switch(j.test_type){case Cn.TRUE_FALSE:return c.jsx(qse,{question:Oe,questionIndex:at,studentAnswer:L[at]||"",onAnswerChange:Ce,mode:"student",testId:j?.test_id,testType:U,displayNumber:at+1});case Cn.MULTIPLE_CHOICE:return c.jsx(Yse,{question:Oe,questionIndex:at,studentAnswer:L[at]||"",onAnswerChange:Ce,mode:"student",testId:j?.test_id,testType:U,displayNumber:at+1});case Cn.INPUT:return c.jsx(Xse,{question:Oe,questionIndex:at,studentAnswer:L[at]||"",onAnswerChange:Ce,mode:"student",testId:j?.test_id,testType:U,displayNumber:at+1});case Cn.MATCHING:return pe.error("Matching test reached renderQuestion - this should not happen"),c.jsxs("div",{className:"text-center p-8",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-600 mb-4",children:"Matching Test"}),c.jsx("p",{className:"text-gray-500 mb-4",children:"Redirecting to matching test page..."}),c.jsx(Je,{onClick:()=>r("/student"),variant:"primary",children:"Back to Dashboard"})]});case Cn.DRAWING:return c.jsx(aae,{question:Oe,questionIndex:at,studentAnswer:L[at]||"",onAnswerChange:Ce,mode:"student",testId:j?.test_id,testType:U});case Cn.FILL_BLANKS:return at===0?c.jsx(cae,{testText:Z?.test_text,blanks:(ee||[]).map((Ve,Ze)=>({id:Ve.question_id||Ze+1,options:Ve.blank_options||[],correct_answer:Ve.correct_answers?.[0]||Ve.correct_answer,question:Ve.question_json||""})),separateType:Z?.separate_type,testId:j?.test_id,testName:Z?.test_name||j?.test_name,teacherId:Z?.teacher_id||j?.teacher_id,subjectId:Z?.subject_id||j?.subject_id,onTestComplete:fr,onAnswerChange:(Ve,Ze)=>{const Ft=ee.findIndex(zt=>zt.question_id===Ve);if(Ft!==-1){const zt=[...L];zt[Ft]=Ze,H(zt),pe.debug(` Fill Blanks answer changed: question ${Ve} = ${Ze}`)}}},`fill-blanks-${j?.test_id}-${Z?.test_name}`):null;default:return c.jsx("div",{children:"Unsupported question type"})}},[j,L,U]);function Fe(){return!j||!Z||!ee?null:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("div",{className:"flex justify-between items-center mb-4",children:c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:Z.test_name||Z.title||"Test"})}),c.jsx("div",{className:"mb-4",children:c.jsx(lae,{answeredCount:zr(),totalQuestions:ee.length,percentage:Math.round(M),timeElapsed:Number(Z?.allowed_time||0)>0?W:0,showDetails:!0})})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Answer all questions below:"}),c.jsx("div",{className:"space-y-8",children:ee.map((Oe,at)=>c.jsx("div",{className:"question-container",children:Ae(Oe,at)},Oe.question_id||at))})]}),c.jsx("div",{className:"flex justify-center",children:c.jsx(Je,{variant:"primary",size:"lg",onClick:()=>Ke(!0),disabled:X||zr()<ee.length,loading:X,children:X?"Submitting...":`Submit Test (${zr()}/${ee.length})`})})]})}if(h)return c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(Ur,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:t?"Starting Test...":"Loading Student Tests..."})]})});if(_)return c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Tests Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:_}),c.jsx(Je,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return c.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[c.jsx(da,{isOpen:Ue,onClose:()=>It(!1),title:"Exit Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet?"}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Je,{onClick:()=>It(!1),variant:"secondary",children:"Cancel"}),c.jsx(Je,{onClick:()=>{It(!1),or()},variant:"primary",children:"Go Back"})]})]})}),c.jsx(da,{isOpen:je,onClose:()=>Ke(!1),title:"Submit Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Je,{onClick:()=>Ke(!1),variant:"secondary",children:"Cancel"}),c.jsx(Je,{onClick:()=>{Ke(!1),fr()},variant:"primary",children:"Submit"})]})]})}),c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsx("div",{children:c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Test"})}),c.jsx(Je,{variant:"outline",onClick:()=>It(!0),children:"Back to Cabinet"})]})})}),Re&&F==="results"&&c.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mx-4 sm:mx-6 lg:mx-8 mt-4",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),c.jsx("div",{className:"ml-3",children:c.jsxs("p",{className:"text-sm text-red-700",children:[c.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",Be," times during the test."]})})]})}),c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 overflow-y-auto",children:[!t&&F==="list"&&Me(),F==="test"&&Fe(),F==="results"&&kt()]}),F==="test"&&p&&c.jsxs("div",{className:"fixed inset-0 bg-white/80 backdrop-blur-[1px] flex flex-col items-center justify-center z-50",children:[c.jsx(Ur,{size:"lg"}),c.jsx("p",{className:"mt-3 text-gray-700",children:"Preparing your test"}),v&&c.jsx("div",{className:"mt-3 text-sm text-gray-500",children:v})]}),c.jsx(FB,{isOpen:le,onClose:()=>ce(!1),testType:ke?.test_type,testId:ke?.test_id,testName:ke?.test_name,questions:ke?.questions,isLoading:h}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:E.map(Oe=>c.jsx(ac,{type:Oe.type,message:Oe.message,onClose:()=>P(at=>at.filter(Ce=>Ce.id!==Oe.id))},Oe.id))})]});function Me(){return!a||a.length===0?c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No active tests available for your class."})}):c.jsx("div",{className:"space-y-6",children:a.map((Oe,at)=>c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:Oe.test_name}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Subject:"})," ",Oe.subject]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Teacher:"})," ",Oe.teacher_name]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Type:"})," ",Oe.test_type]})]}),c.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Assigned: ",new Date(Oe.assigned_at).toLocaleDateString()]})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx(Je,{variant:"outline",onClick:()=>jt(Oe),disabled:C||h,children:"View Details"}),c.jsx(Je,{variant:"primary",onClick:()=>Vt(Oe),disabled:C||h,children:C?"Starting...":"Start Test"})]})]})},at))})}function kt(){if(!j||!Z||!ee||!L)return null;const Oe={};return L.forEach((at,Ce)=>{if(ee[Ce]){const Ve=ee[Ce].question_id||ee[Ce].id||Ce;Oe[String(Ve)]=at,pe.debug(" Converting answer:",{index:Ce,questionId:Ve,answer:at,question:ee[Ce]})}}),pe.debug(" Final answersObject:",Oe),pe.debug(" Questions structure:",ee.map(at=>({id:at.question_id,correct_answer:at.correct_answer}))),c.jsx(Zae,{testInfo:Z,questions:ee,testType:j.test_type,studentAnswers:Oe,onBackToCabinet:or,checkAnswerCorrectness:bm,formatStudentAnswerForDisplay:nr,getCorrectAnswer:Yy})}},nie=()=>{const{testId:e}=F_(),t=vo(),{user:r}=Qn(),{makeAuthenticatedRequest:n}=Wo(),{showNotification:s}=Da(),[a,i]=S.useState(null),[o,l]=S.useState(!0),[u,d]=S.useState(null),[h,g]=S.useState(null),[p,x]=S.useState(!1);qm("matching_type",a?.id);const v=S.useCallback(()=>{if(!r?.student_id||!e)return!1;const N=`test_completed_${r.student_id}_matching_type_${e}`,E=localStorage.getItem(N)==="true",P=`retest1_${r.student_id}_matching_type_${e}`,F=localStorage.getItem(P)==="true";return E&&!F?(pe.debug(" Test already completed, redirecting to cabinet"),s("This test has already been completed","info"),t("/student"),!0):!1},[r?.student_id,e,t,s]),w=S.useCallback(async()=>{if(!e){d("Test ID is required"),l(!1);return}if(!v())try{l(!0),d(null);const N=await n(`/.netlify/functions/get-matching-type-test?test_id=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!N.ok)throw new Error("Failed to load test data");const E=await N.json();if(!E.success)throw new Error(E.message||"Failed to load test");const P=E.data;pe.debug(" Test data from get-matching-type-test:",P);const F=await n(`/.netlify/functions/get-test-questions?test_id=${e}&test_type=matching_type`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!F.ok)throw new Error("Failed to load test questions");const A=await F.json();if(!A.success)throw new Error(A.message||"Failed to load test questions");pe.debug(" Questions data from get-test-questions:",A);const j={id:P.test_id,test_name:P.test_name,teacher_id:P.teacher_id,subject_id:P.subject_id,image_url:P.image_url,image:null,blocks:(()=>{if(Array.isArray(A.questions)&&A.questions.length>0){const R=A.questions[0];return Array.isArray(R.blocks)?R.blocks.map((U,Y)=>{let Z=U.block_coordinates||U.coordinates||(typeof U.x=="number"?{x:U.x,y:U.y,width:U.width,height:U.height}:null);if(typeof Z=="string")try{Z=JSON.parse(Z)}catch{Z=null}return(!Z||typeof Z!="object")&&(Z={x:0,y:0,width:30,height:10}),Z={x:(typeof Z.x=="number"?Z.x:Number(Z.x))||0,y:(typeof Z.y=="number"?Z.y:Number(Z.y))||0,width:(typeof Z.width=="number"?Z.width:Number(Z.width))||30,height:(typeof Z.height=="number"?Z.height:Number(Z.height))||10},{id:U.block_id||U.question_id||U.id||Y+1,word:U.word||`Word ${Y+1}`,coordinates:Z,hasArrow:!!U.has_arrow,arrow:U.arrow||null}}):A.questions.map(U=>{pe.debug(" Processing question:",U);let Y;try{Y=typeof U.block_coordinates=="string"?JSON.parse(U.block_coordinates):U.block_coordinates}catch{Y={x:0,y:0,width:100,height:100}}return(!Y||typeof Y!="object")&&(Y={x:0,y:0,width:100,height:100}),Y={x:(typeof Y.x=="number"?Y.x:Number(Y.x))||0,y:(typeof Y.y=="number"?Y.y:Number(Y.y))||0,width:(typeof Y.width=="number"?Y.width:Number(Y.width))||100,height:(typeof Y.height=="number"?Y.height:Number(Y.height))||100},{id:U.question_id,word:U.word,coordinates:Y,hasArrow:U.has_arrow,arrow:U.arrow}})}return[]})(),words:(()=>{if(Array.isArray(A.questions)&&A.questions.length>0){const R=A.questions[0];if(Array.isArray(R.words)){const U=R.words,Y=Array.isArray(R.blocks)?R.blocks:[];return typeof U[0]=="string"?U.map((ae,ee)=>({id:`w_${Y[ee]?.question_id||Y[ee]?.block_id||A.questions[ee]?.question_id||ee+1}_${ee}`,word:String(ae),blockId:null,isPlaced:!1,isCorrect:!1})):U.map((ae,ee)=>({id:`w_${ae.question_id||ae.id||ee+1}_${ee}`,word:ae.word||String(ae.text||""),blockId:null,isPlaced:!1,isCorrect:!1}))}return A.questions.map(U=>({id:`w_${U.question_id}`,word:U.word,blockId:null,isPlaced:!1,isCorrect:!1}))}return[]})(),arrows:P.arrows?P.arrows.map(R=>(pe.debug(" Processing arrow:",R),{id:R.id,questionId:R.question_id,blockId:R.block_id||R.question_id,start:{x:Number(R.start_x)||0,y:Number(R.start_y)||0},end:{x:Number(R.end_x)||0,y:Number(R.end_y)||0},rel_start_x:R.rel_start_x!==null?Number(R.rel_start_x):null,rel_start_y:R.rel_start_y!==null?Number(R.rel_start_y):null,rel_end_x:R.rel_end_x!==null?Number(R.rel_end_x):null,rel_end_y:R.rel_end_y!==null?Number(R.rel_end_y):null,image_width:R.image_width?Number(R.image_width):null,image_height:R.image_height?Number(R.image_height):null,style:(typeof R.style=="string"?JSON.parse(R.style):R.style)||{color:"#dc3545",thickness:3}})):[]};if(P.image_url){const R=new Image;R.crossOrigin="anonymous",R.onload=()=>{j.image=R,i(j),l(!1)},R.onerror=()=>{pe.warn("Failed to load test image"),i(j),l(!1)},R.src=P.image_url}else i(j),l(!1)}catch(N){pe.error("Error loading test data:",N),d(N.message||"Failed to load test"),l(!1)}},[e,n]);S.useEffect(()=>{r?.student_id&&w()},[w,r?.student_id]);const C=S.useCallback(async N=>{pe.debug("Test completed:",N),s("Test completed successfully!","success");const E=parseInt(N)||0,P=a?.blocks?.length||a?.words?.length||0,F=P>0?Math.round(E/P*100):0,A={showResults:!0,testInfo:{test_name:a?.test_name||"Test",id:a?.id,test_id:a?.id},testType:"matching_type",score:E,totalQuestions:P,percentage:F,passed:F>=60,questionAnalysis:a?.questions?.map((j,R)=>({questionNumber:R+1,isCorrect:R<E,userAnswer:R<E?`Matched: ${j.word}`:"Not answered",correctAnswer:`Match: ${j.word}`}))||Array.from({length:P},(j,R)=>({questionNumber:R+1,isCorrect:R<E,userAnswer:R<E?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};pe.debug(" Using test results data:",A),g(A),x(!0)},[a,s]),k=S.useCallback(()=>{t("/student")},[t]),_=S.useCallback(()=>{x(!1),g(null),w()},[w]);return o?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(At,{className:"max-w-md w-full",children:c.jsxs(At.Body,{className:"text-center",children:[c.jsx(Ur,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading test..."})]})})}):u?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(At,{className:"max-w-md w-full",children:c.jsxs(At.Body,{className:"text-center",children:[c.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Test"}),c.jsx("p",{className:"text-gray-600 mb-4",children:u}),c.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})}):a?p&&h?c.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:c.jsx(Uv,{testResults:h,onBackToCabinet:k,onRetakeTest:_,isLoading:!1})}):c.jsx(Jse,{testData:a,onTestComplete:C,onBackToCabinet:k}):c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(At,{className:"max-w-md w-full",children:c.jsxs(At.Body,{className:"text-center",children:[c.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load test data"}),c.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})})},sie=()=>{const{testId:e}=F_(),t=vo(),{user:r}=Qn(),{makeAuthenticatedRequest:n}=Wo(),{showNotification:s}=Da(),[a,i]=S.useState(null),[o,l]=S.useState(!0),[u,d]=S.useState(null),[h,g]=S.useState(null),[p,x]=S.useState(!1),v=S.useCallback(()=>{if(!r?.student_id||!e)return!1;const _=`test_completed_${r.student_id}_word_matching_${e}`,N=`retest1_${r.student_id}_word_matching_${e}`;return localStorage.getItem(N)==="true"?!1:localStorage.getItem(_)==="true"},[r?.student_id,e]),w=S.useCallback(async()=>{if(!e){d("Test ID is required"),l(!1);return}if(v()){s("This test has already been completed","warning"),t("/student");return}l(!0),d(null);try{const _=`word_matching_test_${e}`,N=Es(_);if(N){if(pe.debug(" Word matching test loaded from cache:",N),N.id){let F=N,A=Array.isArray(F.correctPairs)?F.correctPairs:F.correctPairs&&typeof F.correctPairs=="object"?Object.keys(F.correctPairs).map(j=>[Number(j),F.correctPairs[j]]).sort((j,R)=>j[0]-R[0]).map(([,j])=>j):null;if(Array.isArray(F.leftWords)&&Array.isArray(F.rightWords)&&Array.isArray(A)){const j=F.rightWords.map((ee,ne)=>ne),R=F.leftWords.map((ee,ne)=>ne);for(let ee=j.length-1;ee>0;ee--){const ne=Math.floor(Math.random()*(ee+1));[j[ee],j[ne]]=[j[ne],j[ee]]}for(let ee=R.length-1;ee>0;ee--){const ne=Math.floor(Math.random()*(ee+1));[R[ee],R[ne]]=[R[ne],R[ee]]}const U=j.map(ee=>F.rightWords[ee]),Y=R.map(ee=>F.leftWords[ee]),Z=new Map(j.map((ee,ne)=>[ee,ne])),ae=R.map(ee=>{const ne=A[ee];return Z.get(ne)});F={...F,leftWords:Y,rightWords:U,correctPairs:ae}}i(F)}else{let A={id:N.test_id,test_id:N.test_id,test_name:N.test_name,teacher_id:N.teacher_id,subject_id:N.subject_id,num_questions:N.num_questions,interaction_type:N.interaction_type,passing_score:N.passing_score,created_at:N.created_at,updated_at:N.updated_at,leftWords:N.leftWords,rightWords:N.rightWords,correctPairs:N.correctPairs,originalPairs:N.originalPairs},j=Array.isArray(A.correctPairs)?A.correctPairs:A.correctPairs&&typeof A.correctPairs=="object"?Object.keys(A.correctPairs).map(R=>[Number(R),A.correctPairs[R]]).sort((R,U)=>R[0]-U[0]).map(([,R])=>R):null;if(Array.isArray(A.leftWords)&&Array.isArray(A.rightWords)&&Array.isArray(j)){const R=A.rightWords.map((ne,L)=>L),U=A.leftWords.map((ne,L)=>L);for(let ne=R.length-1;ne>0;ne--){const L=Math.floor(Math.random()*(ne+1));[R[ne],R[L]]=[R[L],R[ne]]}for(let ne=U.length-1;ne>0;ne--){const L=Math.floor(Math.random()*(ne+1));[U[ne],U[L]]=[U[L],U[ne]]}const Y=R.map(ne=>A.rightWords[ne]),Z=U.map(ne=>A.leftWords[ne]),ae=new Map(R.map((ne,L)=>[ne,L])),ee=U.map(ne=>{const L=j[ne];return ae.get(L)});A={...A,leftWords:Z,rightWords:Y,correctPairs:ee}}i(A)}l(!1);return}const P=await(await n(`/.netlify/functions/get-word-matching-test?test_id=${e}`)).json();if(P.success){const F={id:P.data.test_id,test_id:P.data.test_id,test_name:P.data.test_name,teacher_id:P.data.teacher_id,subject_id:P.data.subject_id,num_questions:P.data.num_questions,interaction_type:P.data.interaction_type,passing_score:P.data.passing_score,created_at:P.data.created_at,updated_at:P.data.updated_at,leftWords:P.data.leftWords,rightWords:P.data.rightWords,correctPairs:P.data.correctPairs,originalPairs:P.data.originalPairs};let A=F,j=Array.isArray(A.correctPairs)?A.correctPairs:A.correctPairs&&typeof A.correctPairs=="object"?Object.keys(A.correctPairs).map(R=>[Number(R),A.correctPairs[R]]).sort((R,U)=>R[0]-U[0]).map(([,R])=>R):null;if(Array.isArray(A.leftWords)&&Array.isArray(A.rightWords)&&Array.isArray(j)){const R=A.rightWords.map((ne,L)=>L),U=A.leftWords.map((ne,L)=>L);for(let ne=R.length-1;ne>0;ne--){const L=Math.floor(Math.random()*(ne+1));[R[ne],R[L]]=[R[L],R[ne]]}for(let ne=U.length-1;ne>0;ne--){const L=Math.floor(Math.random()*(ne+1));[U[ne],U[L]]=[U[L],U[ne]]}const Y=R.map(ne=>A.rightWords[ne]),Z=U.map(ne=>A.leftWords[ne]),ae=new Map(R.map((ne,L)=>[ne,L])),ee=U.map(ne=>{const L=j[ne];return ae.get(L)});A={...A,leftWords:Z,rightWords:Y,correctPairs:ee}}i(A),us(_,A,Ts.word_matching_test),pe.debug(" Word matching test loaded from API and cached:",F)}else throw new Error(P.message||"Failed to load test")}catch(_){pe.error("Error loading word matching test:",_),d(_.message),s("Failed to load test: "+_.message,"error")}finally{l(!1)}},[e,v,n,s,t]),C=S.useCallback(async _=>{pe.debug("Test completed:",_),s("Test completed successfully!","success");const N=parseInt(_)||0,E=a?.num_questions||0,P=E>0?Math.round(N/E*100):0,F={showResults:!0,testInfo:{test_name:a?.test_name||"Test",id:a?.id,test_id:a?.id},testType:"word_matching",score:N,totalQuestions:E,percentage:P,passed:P>=60,questionAnalysis:Array.isArray(a?.correctPairs)?a.correctPairs.map((A,j)=>({questionNumber:j+1,isCorrect:j<N,userAnswer:j<N?`${A.left}  ${A.right}`:"Not answered",correctAnswer:`${A.left}  ${A.right}`})):Array.from({length:E},(A,j)=>({questionNumber:j+1,isCorrect:j<N,userAnswer:j<N?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};pe.debug(" Using test results data:",F),g(F),x(!0)},[a,s]),k=S.useCallback(()=>{t("/student")},[t]);return S.useEffect(()=>{w()},[w]),o?c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsxs(At,{className:"p-8 text-center",children:[c.jsx(Ur,{size:"lg",className:"mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading word matching test..."})]})}):u?c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsx(At,{className:"p-8 text-center",children:c.jsxs("div",{className:"text-red-600 mb-4",children:[c.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error Loading Test"}),c.jsx("p",{className:"text-gray-600 mb-4",children:u}),c.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})}):a?p&&h?c.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:c.jsx(Uv,{testResults:h,onBackToCabinet:()=>{g(null),x(!1),t("/student")},onRetakeTest:(_,N)=>{g(null),x(!1),w()},isLoading:!1})}):c.jsx(st.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"min-h-screen bg-gray-50 py-8",children:c.jsx(eae,{testData:a,onTestComplete:C,onBackToCabinet:k})}):c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsx(At,{className:"p-8 text-center",children:c.jsxs("div",{className:"text-gray-600 mb-4",children:[c.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Test Not Found"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"The requested test could not be found."}),c.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})})},aie=S.forwardRef(({onRecordingComplete:e,minDuration:t=0,maxDuration:r=600,minWords:n=50,maxAttempts:s=3,currentAttempt:a=1},i)=>{const[o,l]=S.useState(!1),[u,d]=S.useState(!1),[h,g]=S.useState(0),[p,x]=S.useState(null),[v,w]=S.useState(null),[C,k]=S.useState("good"),_=S.useRef(null),N=S.useRef([]),E=S.useRef(null),P=S.useRef(null),F=S.useRef(null),A=S.useRef(null),j=S.useRef(null);S.useImperativeHandle(i,()=>({startRecording:()=>R(),stopRecording:()=>U(),pauseRecording:()=>Y(),resumeRecording:()=>Z()}));const R=S.useCallback(async()=>{try{if(w(null),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox.");if(!window.isSecureContext&&!window.location.hostname.includes("localhost"))throw new Error("Microphone access requires HTTPS. Please use a secure connection.");const H=window.AudioContext||window.webkitAudioContext;F.current||(F.current=new H),F.current.state!=="running"&&await F.current.resume().catch(()=>{}),console.log(" Requesting microphone permission...");const M=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,channelCount:1}});console.log(" Microphone permission granted"),E.current=M;try{let q=document.getElementById("ios-audio-sink");q||(q=document.createElement("audio"),q.id="ios-audio-sink",q.muted=!0,q.playsInline=!0,q.style.display="none",document.body.appendChild(q)),q.srcObject=M,await q.play().catch(()=>{})}catch{}const V=F.current.createAnalyser();F.current.createMediaStreamSource(M).connect(V),V.fftSize=256,A.current=V,ae();let I="audio/webm;codecs=opus";typeof MediaRecorder<"u"&&MediaRecorder.isTypeSupported&&!MediaRecorder.isTypeSupported(I)&&(MediaRecorder.isTypeSupported("audio/mp4")?I="audio/mp4":MediaRecorder.isTypeSupported("audio/aac")?I="audio/aac":I="");const B=new MediaRecorder(M,I?{mimeType:I}:void 0);_.current=B,N.current=[],B.ondataavailable=q=>{q.data.size>0&&N.current.push(q.data)},B.onstop=()=>{const q=I&&I.startsWith("audio/")?I:"audio/webm",J=new Blob(N.current,{type:q});x(J),e(J,h),E.current&&E.current.getTracks().forEach(se=>se.stop()),j.current&&cancelAnimationFrame(j.current)},B.start(1e3),l(!0),g(0),P.current=setInterval(()=>{g(q=>{const J=q+1;return J>=r&&U(),J})},1e3)}catch(H){console.error("Error starting recording:",H);const M=/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1;H.name==="NotAllowedError"?w(M?"Microphone access denied. Please go to Settings > Safari > Microphone and allow access, then refresh the page.":"Microphone access denied. Please allow microphone access in your browser settings and try again."):H.name==="NotFoundError"?w("No microphone found. Please connect a microphone and try again."):H.name==="NotSupportedError"?w("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox."):H.message.includes("HTTPS")?w("Microphone access requires HTTPS. Please use a secure connection."):w(`Failed to access microphone: ${H.message}`)}},[r]),U=S.useCallback(()=>{if(_.current&&o&&(_.current.stop(),l(!1),d(!1),P.current&&clearInterval(P.current),h<t)){w(`Recording must be at least ${t} seconds long.`);return}},[o,h,t,p,e]),Y=S.useCallback(()=>{_.current&&o&&!u&&(_.current.pause(),d(!0),P.current&&clearInterval(P.current))},[o,u]),Z=S.useCallback(()=>{_.current&&o&&u&&(_.current.resume(),d(!1),P.current=setInterval(()=>{g(H=>{const M=H+1;return M>=r&&U(),M})},1e3))},[o,u,r,U]),ae=S.useCallback(()=>{if(!A.current)return;const H=A.current,M=new Uint8Array(H.frequencyBinCount),V=()=>{H.getByteFrequencyData(M);const W=M.reduce((I,B)=>I+B,0)/M.length;W<10?k("poor"):W<30?k("fair"):k("good"),o&&(j.current=requestAnimationFrame(V))};V()},[o]),ee=H=>{const M=Math.floor(H/60),V=H%60;return`${M}:${V.toString().padStart(2,"0")}`},ne=()=>{switch(C){case"poor":return"text-red-600";case"fair":return"text-yellow-600";case"good":return"text-green-600";default:return"text-gray-600"}},L=()=>{switch(C){case"poor":return"Poor audio quality - speak closer to microphone";case"fair":return"Fair audio quality - good for recording";case"good":return"Excellent audio quality";default:return"Monitoring audio quality..."}};return c.jsxs("div",{className:"audio-recorder bg-white rounded-lg shadow-lg p-3 sm:p-6",children:[c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Record Your Response"}),c.jsx("p",{className:"text-gray-600",children:"Speak clearly and at a normal pace. You can pause and resume if needed."})]}),c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:ee(h)}),c.jsx("div",{className:`text-sm ${ne()}`,children:L()}),u&&c.jsx("div",{className:"text-yellow-600 font-semibold mt-2",children:" Recording Paused"})]}),o&&c.jsx("div",{className:"mb-6",children:c.jsx("div",{className:"flex justify-center items-center space-x-1 h-8",children:Array.from({length:20},(H,M)=>c.jsx("div",{className:"bg-blue-400 rounded-sm",style:{width:"4px",height:`${Math.random()*20+4}px`,animation:"pulse 0.5s ease-in-out infinite"}},M))})}),c.jsx("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-center mb-6",children:o?c.jsxs(c.Fragment,{children:[u?c.jsxs("button",{onClick:Z,className:"w-full sm:w-auto bg-green-600 text-white px-6 py-4 rounded-full hover:bg-green-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[c.jsx("span",{className:"text-xl",children:""}),c.jsx("span",{children:"Resume"})]}):c.jsxs("button",{onClick:Y,className:"w-full sm:w-auto bg-yellow-600 text-white px-6 py-4 rounded-full hover:bg-yellow-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[c.jsx("span",{className:"text-xl",children:""}),c.jsx("span",{children:"Pause"})]}),c.jsxs("button",{onClick:U,className:"w-full sm:w-auto bg-gray-600 text-white px-6 py-4 rounded-full hover:bg-gray-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[c.jsx("span",{className:"text-xl",children:""}),c.jsx("span",{children:"Stop & Submit"})]})]}):c.jsxs("button",{onClick:R,className:"w-full sm:w-auto bg-red-600 text-white px-6 py-4 rounded-full hover:bg-red-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[c.jsx("span",{className:"text-xl",children:""}),c.jsx("span",{children:"Start Recording"})]})}),v&&c.jsx("div",{className:"mt-4 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-red-800",children:v})}),c.jsxs("div",{className:"mt-4 text-center text-sm text-gray-600",children:["Attempt ",a," of ",s,a<s&&c.jsx("span",{className:"ml-2 text-blue-600",children:"(You can re-record if needed)"})]})]})}),HB=({audioBlob:e,audioUrl:t,recordingTime:r,className:n=""})=>{const[s,a]=S.useState(!1),[i,o]=S.useState(0),[l,u]=S.useState(0),[d,h]=S.useState(1),[g,p]=S.useState(1),[x,v]=S.useState(!0),[w,C]=S.useState(""),[k,_]=S.useState(!1),[N,E]=S.useState(null),[P,F]=S.useState(!1),A=S.useRef(null),j=S.useRef(null),R=S.useRef(!1);S.useEffect(()=>()=>{R.current=!0},[]),S.useEffect(()=>{let M=!1;if(t)M||C(t);else if(e){if(!e||e.size===0){M||v(!1);return}if(!(e instanceof Blob)){console.error("audioBlob is not a Blob:",typeof e,e),M||v(!1);return}const V=URL.createObjectURL(e);return M||C(V),()=>{M=!0,URL.revokeObjectURL(V)}}return()=>{M=!0}},[e,t]),S.useEffect(()=>{let M=!1;const V=I=>{try{const B=new URL(I);return/\/storage\/v1\/object\/public\//.test(B.pathname)}catch{return!1}};async function W(I){if(!I||P||/\/object\/sign\//.test(I)||!V(I))return I;try{const q=new URL(I).pathname.replace(/^\/storage\/v1\/object\/public\//,""),J=q.split("/")[0],se=q.substring(J.length+1),X=await fetch(`/.netlify/functions/get-speaking-test-new?action=sign-audio&bucket=${encodeURIComponent(J)}&file_path=${encodeURIComponent(se)}`);if(X.ok){const{url:ie}=await X.json();if(!M&&!R.current){F(!0);try{await fetch(ie,{headers:{Range:"bytes=0-1"},mode:"cors"})}catch{}C(ie)}return ie}}catch{}return I}return(async()=>{if(t){const I=await W(t);try{await fetch(I,{headers:{Range:"bytes=0-1"},mode:"cors"})}catch{}!M&&!R.current&&!P&&C(I)}})(),()=>{M=!0}},[t,P]),S.useEffect(()=>{let M=!1;return w&&(M||(_(!1),E(null),v(!0))),()=>{M=!0}},[w]),S.useEffect(()=>{if(A.current&&w){const M=A.current;let V=!1;try{M.src=w}catch{}M.load();const W=()=>{if(V||R.current)return;let re=M.duration;if(re===1/0)try{M.currentTime=1e101,M.ontimeupdate=()=>{if(V||R.current)return;M.ontimeupdate=null;const ge=M.duration;V||(u(isFinite(ge)&&ge>0?ge:0),M.currentTime=0,v(!1))};return}catch(ge){console.warn("Seek trick failed:",ge)}if(isNaN(re)||!isFinite(re)||re<=0){const ge=M.seekable&&M.seekable.length>0&&isFinite(M.seekable.end(0)),Ne=!ge&&M.buffered&&M.buffered.length>0&&isFinite(M.buffered.end(M.buffered.length-1));ge?re=M.seekable.end(0):Ne&&(re=M.buffered.end(M.buffered.length-1))}isNaN(re)||!isFinite(re)||re<=0?(console.warn("Invalid audio duration after fallbacks:",re),r&&r>0?V||u(r):V||u(0)):V||u(re),V||v(!1)},I=()=>{V||R.current||W()},B=()=>{V||R.current||W()},q=()=>{V||R.current||W()},J=()=>{V||R.current||W()},se=()=>{V||R.current||o(M.currentTime)},X=()=>{V||R.current||(a(!1),o(0))},ie=()=>{V||R.current||a(!0)},le=()=>{V||R.current||a(!1)},ce=re=>{if(V||R.current)return;console.error("Audio loading error:",re),console.error("Audio error details:",{error:M.error,networkState:M.networkState,readyState:M.readyState,src:M.src,currentSrc:M.currentSrc});const ge=M.error?.code;ge===4&&_(!0),E(M.error||{code:ge}),v(!1)},ke=setTimeout(()=>{V||R.current||M.readyState===0&&v(!1)},6e3);return M.addEventListener("loadedmetadata",I),M.addEventListener("durationchange",B),M.addEventListener("canplay",q),M.addEventListener("canplaythrough",J),M.addEventListener("timeupdate",se),M.addEventListener("ended",X),M.addEventListener("play",ie),M.addEventListener("pause",le),M.addEventListener("error",ce),()=>{V=!0,clearTimeout(ke),M.removeEventListener("loadedmetadata",I),M.removeEventListener("durationchange",B),M.removeEventListener("canplay",q),M.removeEventListener("canplaythrough",J),M.removeEventListener("timeupdate",se),M.removeEventListener("ended",X),M.removeEventListener("play",ie),M.removeEventListener("pause",le),M.removeEventListener("error",ce),M.pause(),M.src="",M.load()}}},[w,r]),S.useEffect(()=>{let M=!1;return r&&r>0&&(isNaN(l)||!isFinite(l)||l<=0)&&(M||u(r)),()=>{M=!0}},[r,l]);const U=()=>{A.current&&(s?A.current.pause():A.current.play().catch(M=>{console.error("Play failed:",M)}))},Y=M=>{if(A.current&&j.current&&l>0){const V=j.current.getBoundingClientRect(),W=M.clientX-V.left,I=V.width,B=Math.max(0,Math.min(l,W/I*l));isFinite(B)&&B>=0&&(A.current.currentTime=B,o(B))}},Z=M=>{const V=parseFloat(M.target.value);h(V),A.current&&(A.current.volume=V)},ae=M=>{const V=parseFloat(M.target.value);p(V),A.current&&(A.current.playbackRate=V)},ee=M=>{if(isNaN(M))return"0:00";const V=Math.floor(M/60),W=Math.floor(M%60);return`${V}:${W.toString().padStart(2,"0")}`};if(!e&&!t)return c.jsx("div",{className:`audio-player ${n}`,children:c.jsx("div",{className:"text-center text-gray-500 py-8",children:"No audio available"})});const L=(M=>{try{const W=(M||"").toLowerCase().split("?")[0].split("#")[0];return W.endsWith(".webm")?"audio/webm":W.endsWith(".mp3")?"audio/mpeg":W.endsWith(".m4a")?"audio/mp4":W.endsWith(".aac")?"audio/aac":W.endsWith(".wav")?"audio/wav":void 0}catch{return}})(w||t),H=Ss.useMemo(()=>typeof window>"u"?!0:document.createElement("audio").canPlayType("audio/webm")!=="",[]);return c.jsxs("div",{className:`audio-player bg-gray-50 rounded-lg p-4 ${n}`,children:[c.jsx("audio",{ref:A,preload:"metadata",controls:!1,style:{display:"none"},crossOrigin:"anonymous",children:c.jsx("source",{src:w,type:L})}),x?c.jsxs("div",{className:"text-center py-4",children:[c.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),c.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Loading audio..."})]}):k?c.jsxs("div",{className:"text-center py-4",children:[c.jsx("p",{className:"text-sm text-red-600",children:"This audio format isn't supported by your browser."}),w?c.jsx("a",{href:w,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline text-sm",children:"Open in new tab"}):null,L?c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Detected type: ",L]}):null,c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Browser WebM support: ",H?"Yes":"No",!H&&" - Try using Chrome, Firefox, or Edge"]}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Preferred format: WebM"})]}):N?c.jsxs("div",{className:"text-center py-4",children:[c.jsx("p",{className:"text-sm text-red-600",children:"Playback failed. Please try opening the audio directly."}),w?c.jsx("a",{href:w,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline text-sm",children:"Open in new tab"}):null,L?c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Detected type: ",L]}):null]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("div",{ref:j,className:"w-full bg-gray-200 rounded-full h-3 cursor-pointer hover:h-4 transition-all min-h-[24px]",onClick:Y,children:c.jsx("div",{className:"bg-blue-600 h-3 rounded-full transition-all",style:{width:`${i/l*100}%`}})}),c.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mt-2 font-medium",children:[c.jsx("span",{children:ee(i)}),c.jsx("span",{children:ee(l)})]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("button",{onClick:U,className:"bg-blue-600 text-white p-3 rounded-full hover:bg-blue-700 transition-colors min-h-[44px] min-w-[44px] flex items-center justify-center",children:s?c.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}):c.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.617 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.617l3.766-3.793a1 1 0 011.617.793zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z",clipRule:"evenodd"})}),c.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:d,onChange:Z,className:"w-24 h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer min-h-[20px]"}),c.jsxs("span",{className:"text-sm text-gray-600 w-10 font-medium",children:[Math.round(d*100),"%"]})]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Speed:"}),c.jsxs("select",{value:g,onChange:ae,className:"text-sm border border-gray-300 rounded px-2 py-1",children:[c.jsx("option",{value:"0.5",children:"0.5x"}),c.jsx("option",{value:"0.75",children:"0.75x"}),c.jsx("option",{value:"1",children:"1x"}),c.jsx("option",{value:"1.25",children:"1.25x"}),c.jsx("option",{value:"1.5",children:"1.5x"}),c.jsx("option",{value:"2",children:"2x"})]})]})]})]})]})},iie=({transcript:e,scores:t,audioBlob:r,recordingTime:n,onReRecord:s,onFinalSubmit:a,canReRecord:i,attemptNumber:o,maxAttempts:l,isSubmitting:u=!1})=>{const[d,h]=S.useState(!1);console.log(" FeedbackDisplay received recordingTime:",n);const g=(w,C)=>{const k=w/C*100;return k>=80?"text-green-600":k>=60?"text-yellow-600":"text-red-600"},p=(w,C)=>{const k=w/C*100;return k>=90?"A+":k>=80?"A":k>=70?"B":k>=60?"C":k>=50?"D":"F"},x=()=>p(t?.overall_score||0,100),v=()=>g(t?.overall_score||0,100);return console.log(" FeedbackDisplay received scores:",t),console.log(" Individual score values:",{grammar_score:t?.grammar_score,vocabulary_score:t?.vocabulary_score,pronunciation_score:t?.pronunciation_score,fluency_score:t?.fluency_score,content_score:t?.content_score}),c.jsxs("div",{className:"feedback-display bg-white rounded-lg shadow-lg p-3 sm:p-6",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Speaking Test Results"}),c.jsx("p",{className:"text-gray-600",children:"Review your performance and decide whether to submit or re-record."})]}),c.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 p-3 sm:p-6 rounded-lg mb-6",children:c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:`text-4xl font-bold ${v()}`,children:[t?.overall_score||0,"/100"]}),c.jsxs("div",{className:`text-2xl font-semibold ${v()} mt-2`,children:["Grade: ",x()]}),c.jsx("div",{className:"text-gray-600 mt-2",children:t?.overall_score>=80?"Excellent work!":t?.overall_score>=60?"Good job!":t?.overall_score>=50?"Not bad, but could be better.":"Keep practicing!"})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"font-semibold text-gray-700",children:"Grammar"}),c.jsxs("span",{className:`font-bold ${g(t?.grammar_score||0,25)}`,children:[t?.grammar_score||0,"/25"]})]}),c.jsxs("div",{className:"text-sm text-gray-600",children:[t?.grammar_mistakes||0," mistakes found"]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:c.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${Math.min((t?.grammar_score||0)/25*100,100)}%`}})})]}),c.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"font-semibold text-gray-700",children:"Vocabulary"}),c.jsxs("span",{className:`font-bold ${g(t?.vocabulary_score||0,20)}`,children:[t?.vocabulary_score||0,"/20"]})]}),c.jsxs("div",{className:"text-sm text-gray-600",children:[t?.vocabulary_mistakes||0," vocabulary issues"]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:c.jsx("div",{className:"bg-purple-600 h-2 rounded-full",style:{width:`${Math.min((t?.vocabulary_score||0)/20*100,100)}%`}})})]}),c.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"font-semibold text-gray-700",children:"Pronunciation"}),c.jsxs("span",{className:`font-bold ${g(t?.pronunciation_score||0,15)}`,children:[t?.pronunciation_score||0,"/15"]})]}),c.jsx("div",{className:"text-sm text-gray-600",children:"Clarity and accuracy"}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:c.jsx("div",{className:"bg-orange-600 h-2 rounded-full",style:{width:`${Math.min((t?.pronunciation_score||0)/15*100,100)}%`}})})]}),c.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"font-semibold text-gray-700",children:"Fluency"}),c.jsxs("span",{className:`font-bold ${g(t?.fluency_score||0,20)}`,children:[t?.fluency_score||0,"/20"]})]}),c.jsx("div",{className:"text-sm text-gray-600",children:"Pace, pauses, and flow"}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:c.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min((t?.fluency_score||0)/20*100,100)}%`}})})]}),c.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"font-semibold text-gray-700",children:"Content"}),c.jsxs("span",{className:`font-bold ${g(t?.content_score||0,20)}`,children:[t?.content_score||0,"/20"]})]}),c.jsx("div",{className:"text-sm text-gray-600",children:"How well addressed the prompt"}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:c.jsx("div",{className:"bg-indigo-600 h-2 rounded-full",style:{width:`${Math.min((t?.content_score||0)/20*100,100)}%`}})})]}),c.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"font-semibold text-gray-700",children:"Word Count"}),c.jsxs("span",{className:"font-bold text-gray-700",children:[t?.word_count||0," words"]})]}),c.jsx("div",{className:"text-sm text-gray-600",children:"Total words spoken"}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:c.jsx("div",{className:"bg-gray-600 h-2 rounded-full",style:{width:`${Math.min((t?.word_count||0)/100*100,100)}%`}})})]})]}),r&&c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Your Recording"}),c.jsx(HB,{audioBlob:r,recordingTime:n})]}),t?.feedback&&c.jsx("div",{className:"mb-6 bg-gradient-to-r from-green-50 to-blue-50 p-3 sm:p-6 rounded-lg border border-green-200",children:c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx("span",{className:"text-green-600 text-2xl",children:""}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"font-semibold text-green-800 mb-3 text-lg",children:"AI Feedback"}),c.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.feedback})]})]})}),t?.improved_transcript&&c.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4",children:[c.jsxs("div",{className:"flex items-start space-x-2 mb-3",children:[c.jsx("span",{className:"text-green-600 text-lg",children:""}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-green-800 mb-2",children:"Improved Version"}),c.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Here's how your response could be improved with better grammar and vocabulary:"})]})]}),c.jsx("div",{className:"bg-white border border-green-200 rounded p-3",children:c.jsx("p",{className:"text-gray-800 leading-relaxed",children:t.improved_transcript})})]}),c.jsx("div",{className:"mb-6",children:c.jsx("button",{onClick:()=>h(!d),className:"text-blue-600 hover:text-blue-800 text-sm",children:d?"Hide Details":"Show Details"})}),d&&c.jsxs("div",{className:"mb-6 bg-blue-50 p-3 sm:p-4 rounded-lg",children:[c.jsx("h4",{className:"font-semibold mb-3",children:"Detailed Analysis"}),c.jsxs("div",{className:"space-y-3 text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Word Count Analysis:"}),c.jsxs("span",{className:"ml-2 text-gray-700",children:["You spoke ",t?.word_count||0," words.",t?.word_count>=50?" Great job meeting the minimum requirement!":" Consider speaking more to meet the minimum word requirement."]})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Grammar Analysis:"}),c.jsx("span",{className:"ml-2 text-gray-700",children:t?.grammar_mistakes===0?"Perfect grammar!":`Found ${t?.grammar_mistakes||0} grammar ${t?.grammar_mistakes===1?"mistake":"mistakes"}.`}),t?.grammar_corrections&&t.grammar_corrections.length>0&&c.jsx("div",{className:"mt-2 space-y-2",children:t.grammar_corrections.map((w,C)=>c.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-2 sm:p-3",children:c.jsxs("div",{className:"flex items-start space-x-2",children:[c.jsx("span",{className:"text-red-600 font-mono text-sm",children:""}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-medium text-red-600",children:w.mistake}),c.jsx("span",{className:"mx-2",children:""}),c.jsx("span",{className:"font-medium text-green-600",children:w.correction})]}),c.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[c.jsx("strong",{children:"Explanation:"})," ",w.explanation]})]})]})},C))})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Vocabulary Analysis:"}),c.jsx("span",{className:"ml-2 text-gray-700",children:t?.vocabulary_mistakes===0?"Excellent vocabulary usage!":`Found ${t?.vocabulary_mistakes||0} vocabulary ${t?.vocabulary_mistakes===1?"issue":"issues"}.`}),t?.vocabulary_corrections&&t.vocabulary_corrections.length>0&&c.jsx("div",{className:"mt-2 space-y-2",children:t.vocabulary_corrections.map((w,C)=>c.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded p-2 sm:p-3",children:c.jsxs("div",{className:"flex items-start space-x-2",children:[c.jsx("span",{className:"text-purple-600 font-mono text-sm",children:""}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-medium text-purple-600",children:w.mistake}),c.jsx("span",{className:"mx-2",children:""}),c.jsx("span",{className:"font-medium text-green-600",children:w.correction})]}),c.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[c.jsx("strong",{children:"Explanation:"})," ",w.explanation]})]})]})},C))})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Pronunciation Analysis:"}),c.jsx("span",{className:"ml-2 text-gray-700",children:t?.pronunciation_corrections&&t.pronunciation_corrections.length>0?`Found ${t.pronunciation_corrections.length} pronunciation ${t.pronunciation_corrections.length===1?"tip":"tips"} to help improve clarity.`:"Great pronunciation! Your speech was clear and easy to understand."})]}),t?.pronunciation_corrections&&t.pronunciation_corrections.length>0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Pronunciation Tips:"}),c.jsx("div",{className:"mt-2 space-y-2",children:t.pronunciation_corrections.map((w,C)=>c.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded p-2 sm:p-3",children:c.jsxs("div",{className:"flex items-start space-x-2",children:[c.jsx("span",{className:"text-orange-600 font-mono text-sm",children:""}),c.jsx("div",{className:"flex-1",children:c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-medium text-orange-700",children:w.word}),c.jsx("span",{className:"mx-2",children:""}),c.jsx("span",{className:"font-medium text-green-700",children:w.correction})]})})]})},C))})]}),t?.language_use_corrections&&t.language_use_corrections.length>0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Language Use Suggestions:"}),c.jsx("div",{className:"mt-2 space-y-2",children:t.language_use_corrections.map((w,C)=>c.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded p-2 sm:p-3",children:c.jsxs("div",{className:"flex items-start space-x-2",children:[c.jsx("span",{className:"text-blue-600 font-mono text-sm",children:""}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-medium text-blue-700",children:w.mistake}),c.jsx("span",{className:"mx-2",children:""}),c.jsx("span",{className:"font-medium text-green-700",children:w.suggestion})]}),w.explanation&&c.jsxs("div",{className:"text-xs text-blue-700 mt-1",children:[c.jsx("strong",{children:"Why:"})," ",w.explanation]})]})]})},C))})]})]})]}),c.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:["Attempt ",o," of ",l]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-center justify-center",children:[i&&c.jsxs("button",{onClick:s,className:"w-full sm:w-auto bg-yellow-600 text-white px-4 py-2.5 rounded-lg hover:bg-yellow-700 flex items-center justify-center space-x-2 min-h-[40px] text-base font-medium",children:[c.jsx("span",{children:""}),c.jsx("span",{children:"Re-record"})]}),c.jsx("button",{onClick:a,disabled:u,className:`w-full sm:w-auto px-4 py-2.5 rounded-lg flex items-center justify-center space-x-2 min-h-[40px] text-base font-medium ${u?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"} text-white`,children:u?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),c.jsx("span",{children:"Submitting..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("span",{children:""}),c.jsx("span",{children:"Submit Final"})]})})]}),!i&&c.jsx("div",{className:"mt-4 p-2 sm:p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:c.jsxs("p",{className:"text-yellow-800 text-sm",children:[c.jsx("strong",{children:"Maximum attempts reached."}),' This is your final attempt. Click "Submit Final" to complete the test.']})})]})},oie=({testData:e,onComplete:t,onExit:r,onTestComplete:n})=>{const[s,a]=S.useState("recording"),[i,o]=S.useState(null),[l,u]=S.useState(""),[d,h]=S.useState(null),[g,p]=S.useState(!1),[x,v]=S.useState(!1),[w,C]=S.useState(!1),[k,_]=S.useState(null),[N,E]=S.useState(1),[P]=S.useState(e.max_attempts||3),[F,A]=S.useState(!1),[j,R]=S.useState(0),[U,Y]=S.useState(!1),[Z,ae]=S.useState(0),[ee,ne]=S.useState(null),L=Wo(),{user:H}=Qn(),{makeAuthenticatedRequest:M}=L,V=S.useRef(null);S.useEffect(()=>{if(e?.test_id&&H?.student_id){const ce=`speaking_attempts_${H.student_id}_${e.test_id}`,ke=localStorage.getItem(ce);if(ke){const re=parseInt(ke,10);re>0&&re<=P&&(E(re),console.log(" Loaded attempts from localStorage:",re))}}},[e,H,P]),S.useEffect(()=>{if(e&&!ee){const ce=new Date;ne(ce),console.log(" Speaking test timer started at:",ce.toISOString())}},[e,ee]),S.useEffect(()=>{let ce=0;s==="recording"?ce=25:s==="processing"?ce=50:s==="feedback"?ce=75:s==="completed"&&(ce=100),ae(ce)},[s]),S.useEffect(()=>{(async()=>{try{if(!window.isSecureContext&&!window.location.hostname.includes("localhost")){_("Microphone access requires HTTPS. Please use a secure connection.");return}if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){_("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox.");return}if(navigator.permissions)try{(await navigator.permissions.query({name:"microphone"})).state==="granted"?(A(!0),console.log(" Microphone permission already granted")):console.log(" Microphone permission not yet granted - user will need to click record button")}catch(ke){console.log(" Could not check microphone permission status:",ke)}}catch(ke){console.error(" Error checking microphone permission:",ke)}})()},[]),S.useEffect(()=>{const ce=setInterval(()=>{i&&s==="recording"&&W()},3e4);return()=>clearInterval(ce)},[i,s]);const W=S.useCallback(async()=>{try{const ce={test_id:e.test_id,audio_blob:i?await I(i):null,attempt_number:N,step:s,timestamp:new Date().toISOString()};localStorage.setItem(`speaking_progress_${e.test_id}`,JSON.stringify(ce))}catch(ce){console.error("Failed to save progress:",ce)}},[e.test_id,i,N,s]),I=ce=>new Promise((ke,re)=>{const ge=new FileReader;ge.onloadend=()=>{const je=ge.result.split(",")[1];ke(je)},ge.onerror=re,ge.readAsDataURL(ce)}),B=S.useCallback(ce=>{if(e?.test_id&&H?.student_id){const ke=`speaking_attempts_${H.student_id}_${e.test_id}`;localStorage.setItem(ke,ce.toString()),console.log(" Saved attempts to localStorage:",ce)}},[e,H]),q=S.useCallback(async(ce,ke,re,ge,Ne)=>{if(e?.test_id&&H?.student_id)try{const{setCachedData:je,CACHE_TTL:Ke}=await Gi(async()=>{const{setCachedData:wt,CACHE_TTL:xt}=await Promise.resolve().then(()=>Hg);return{setCachedData:wt,CACHE_TTL:xt}},void 0),Ue=`speaking_test_data_${H.student_id}_${e.test_id}`,rt={audioBlob:ce?await I(ce):null,transcript:ke,scores:re,recordingTime:ge,currentStep:Ne,timestamp:Date.now()};je(Ue,rt,Ke.speaking_test_data),console.log(" Saved speaking test data to cache:",Ue)}catch(je){console.error("Failed to save speaking test data to cache:",je)}},[e,H]),J=S.useCallback(async()=>{if(e?.test_id&&H?.student_id)try{const{getCachedData:ce}=await Gi(async()=>{const{getCachedData:ge}=await Promise.resolve().then(()=>Hg);return{getCachedData:ge}},void 0),ke=`speaking_test_data_${H.student_id}_${e.test_id}`,re=ce(ke);if(re){if(console.log(" Loaded speaking test data from cache:",re),re.audioBlob){const ge=new Blob([Uint8Array.from(atob(re.audioBlob),Ne=>Ne.charCodeAt(0))],{type:"audio/webm"});o(ge)}return re.transcript&&u(re.transcript),re.scores&&h(re.scores),re.recordingTime&&R(re.recordingTime),re.currentStep&&a(re.currentStep),!0}}catch(ce){console.error("Failed to load speaking test data from cache:",ce)}return!1},[e,H]);S.useEffect(()=>{if(e?.test_id&&H?.student_id){try{const ce=H.student_id,ke=`retest_assignment_id_${ce}_speaking_${e.test_id}`,re=`retest_in_progress_${ce}_speaking_${e.test_id}`;if(!!localStorage.getItem(ke)||!!localStorage.getItem(re)){const Ne=`speaking_test_data_${ce}_${e.test_id}`,je=`anti_cheating_${ce}_speaking_${e.test_id}`,Ke=`speaking_progress_${e.test_id}`;localStorage.removeItem(Ne),localStorage.removeItem(je),localStorage.removeItem(Ke),console.log(" Cleared speaking per-test cache for retest start:",{cacheKey:Ne,antiCheatKey:je,progressKey:Ke})}}catch{}J()}},[e,H,J]),S.useEffect(()=>{e?.test_id&&H?.student_id&&(i||l||d)&&q(i,l,d,j,s)},[i,l,d,j,s,e,H,q]);const se=S.useCallback(async(ce,ke)=>{if(U){console.log(" Already processing, skipping duplicate call");return}console.log(" Recording completed, duration:",ke),Y(!0),o(ce),R(ke),a("processing"),_(null);try{const re=await I(ce),ge=new Date,Ne=e.start_time?Math.round((ge-e.start_time)/1e3):0,je=e.start_time?new Date(e.start_time).toISOString():ge.toISOString(),Ke=H.student_id,Ue=`retest_assignment_id_${Ke}_speaking_${e.test_id}`,It=localStorage.getItem(Ue),rt={test_id:e.test_id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:Ke,question_id:e.question_id||1,audio_blob:re,audio_duration:ce.duration||0,time_taken:Ne,started_at:je,submitted_at:ge.toISOString(),caught_cheating:!1,visibility_change_times:0,is_completed:!0,retest_assignment_id:It?Number(It):null,parent_test_id:e.test_id};console.log(" Submitting speaking test:",rt),console.log(" Processing audio with AI...");try{const xt=await(await M("/.netlify/functions/process-speaking-audio-ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e.test_id,question_id:e.question_id||1,audio_blob:re})})).json();if(xt.success){console.log(" AI Analysis Result:",xt),u(xt.transcript);const lt=xt.transcript?xt.transcript.split(/\s+/).filter(Mt=>Mt.length>0).length:0;console.log(" Word Count Verification:",{aiCount:xt.word_count,actualCount:lt,transcript:xt.transcript});const pt=lt,Rt={overall_score:xt.overall_score,word_count:pt,grammar_score:xt.grammar_score,vocabulary_score:xt.vocabulary_score,pronunciation_score:xt.pronunciation_score,fluency_score:xt.fluency_score,content_score:xt.content_score,grammar_mistakes:xt.grammar_mistakes,vocabulary_mistakes:xt.vocabulary_mistakes,feedback:xt.feedback,improved_transcript:xt.improved_transcript,grammar_corrections:xt.grammar_corrections||[],vocabulary_corrections:xt.vocabulary_corrections||[],language_use_corrections:xt.language_use_corrections||[],pronunciation_corrections:xt.pronunciation_corrections||[],ai_feedback:xt.ai_feedback||null};console.log(" Mapped Scores:",Rt),console.log(" Individual scores check:",{grammar_score:xt.grammar_score,vocabulary_score:xt.vocabulary_score,pronunciation_score:xt.pronunciation_score,fluency_score:xt.fluency_score,content_score:xt.content_score}),h(Rt),a("feedback")}else throw new Error(xt.message||"Failed to process audio with AI");localStorage.removeItem(`speaking_progress_${e.test_id}`)}catch(wt){console.error("Speaking test submission error:",wt),wt.message.includes("No valid authentication token found")?(_("Your session has expired. Please refresh the page and try again."),setTimeout(()=>{window.location.reload()},3e3)):_(wt.message),a("recording")}}catch(re){console.error("Speaking test submission error:",re),_(re.message),a("recording")}finally{Y(!1)}},[e,H,M,N,B,U]);S.useEffect(()=>{s==="processing"&&!l&&!d&&(console.log(' Detected stuck "processing" state on reload. Attempting recovery...'),i?(console.log(" Resuming processing from cached audio blob..."),se(i,j)):(console.log(" No cached audio blob found. Resetting to recording step."),a("recording")))},[s,l,d,i,j,se]);const X=S.useCallback(()=>{if(N<P){o(null),u(""),h(null),_(null),Y(!1);const ce=N+1;E(ce),B(ce),a("recording")}else _("Maximum attempts reached")},[N,P,B]),ie=S.useCallback(async()=>{if(!(!l||!d)){p(!0);try{const ce=new Date,ke=e.start_time?Math.round((ce-e.start_time)/1e3):0,re=e.start_time?new Date(e.start_time).toISOString():ce.toISOString(),ge=H.student_id,Ne=`retest_assignment_id_${ge}_speaking_${e.test_id}`,je=localStorage.getItem(Ne),{academicCalendarService:Ke}=await Gi(async()=>{const{academicCalendarService:lt}=await Promise.resolve().then(()=>n2);return{academicCalendarService:lt}},void 0);await Ke.loadAcademicCalendar();const It=Ke.getCurrentTerm()?.id;if(!It)throw new Error("No current academic period found");const rt={test_id:e.test_id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:ge,academic_period_id:It,question_id:e.question_id||1,audio_blob:i?await I(i):null,audio_duration:i?.duration||0,time_taken:ke,started_at:re,submitted_at:ce.toISOString(),caught_cheating:!1,visibility_change_times:0,is_completed:!0,retest_assignment_id:je?Number(je):null,parent_test_id:e.test_id,transcript:l,scores:d,final_submission:!0};console.log(" Final submission:",rt),console.log(" Making final submission request...");const wt=await M("/.netlify/functions/submit-speaking-test-final",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(rt)});console.log(" Final submission response status:",wt.status);const xt=await wt.json();if(console.log(" Final submission result:",xt),xt.success){if(H?.student_id){const We=`test_completed_${H.student_id}_speaking_${e.test_id}`;localStorage.setItem(We,"true"),console.log(" Speaking test marked as completed in localStorage:",We);const nt=`retest_in_progress_${H.student_id}_speaking_${e.test_id}`;localStorage.removeItem(nt),console.log(" Cleared in-progress retest lock:",nt);const Tt=`speaking_attempts_${H.student_id}_${e.test_id}`;localStorage.removeItem(Tt),console.log(" Cleared attempts from localStorage upon submission");const{clearTestData:jt}=await Gi(async()=>{const{clearTestData:Vt}=await Promise.resolve().then(()=>Hg);return{clearTestData:Vt}},void 0);jt(H.student_id,"speaking_test_data",e.test_id),console.log(" Cleared speaking test data from cache upon submission");try{const Vt=`anti_cheating_${H.student_id}_speaking_${e.test_id}`;localStorage.removeItem(Vt),console.log(" Cleared anti-cheating key:",Vt)}catch{}}console.log(" Caching speaking test results after submission...");const pt=`student_results_table_${H?.student_id||H?.id||"unknown"}`,{setCachedData:Rt,getCachedData:Mt,CACHE_TTL:Qe,clearTestData:Re}=await Gi(async()=>{const{setCachedData:We,getCachedData:nt,CACHE_TTL:Tt,clearTestData:jt}=await Promise.resolve().then(()=>Hg);return{setCachedData:We,getCachedData:nt,CACHE_TTL:Tt,clearTestData:jt}},void 0),Be={id:Date.now(),test_id:e.test_id,test_type:"speaking",test_name:e.test_name,score:Math.round(d.overall_score/10),max_score:10,percentage:d.overall_score,caught_cheating:!1,visibility_change_times:0,is_completed:!0,submitted_at:new Date().toISOString(),subject:"Listening and Speaking",teacher_name:e.teacher_name||"Unknown"};let ct={success:!0,results:[],count:0};try{const We=Mt(pt);We&&Array.isArray(We.results)&&(ct.results=We.results.slice())}catch{}ct.results.unshift(Be),ct.count=ct.results.length,Rt(pt,ct,Qe.student_results_table),console.log(" Speaking test results cached (merged) with key:",pt),H?.student_id&&Re(H.student_id,"speaking",e.test_id);try{const We=`retest_attempts_${H.student_id}_speaking_${e.test_id}`,nt=localStorage.getItem(We);let Tt=0;if(nt)try{Tt=JSON.parse(nt)?.used||0}catch{Tt=0}const jt={used:Tt+1,max:P};localStorage.setItem(We,JSON.stringify(jt));const Vt=`retest1_${H.student_id}_speaking_${e.test_id}`,fr=`retest_assignment_id_${H.student_id}_speaking_${e.test_id}`;localStorage.removeItem(Vt),localStorage.removeItem(fr),console.log(" Updated retest attempts meta and cleared retest keys:",jt)}catch(We){console.warn(" Failed to update retest attempts meta/keys",We)}try{n&&n(d.overall_score),typeof r=="function"&&r()}catch{}return}else throw new Error(xt.message||"Failed to submit speaking test")}catch(ce){console.error("Speaking test submission error:",ce),_(ce.message)}finally{p(!1)}}},[e,H,M,l,d,i,N,t]);S.useCallback(()=>{a("completed"),t({test_id:e.test_id,transcript:l,scores:d,attempt_number:N})},[e.test_id,l,d,N,t]);const le=()=>{switch(s){case"recording":return c.jsxs("div",{className:"speaking-test-recording",children:[c.jsx("h2",{className:"text-2xl font-bold mb-4 text-center",children:e.test_name}),c.jsxs("div",{className:"mb-6 text-center",children:[c.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Instructions:"}),c.jsx("p",{className:"text-gray-700 mb-4",children:e.prompt}),c.jsx("div",{className:"bg-blue-50 p-3 sm:p-4 rounded-lg",children:c.jsxs("p",{className:"text-sm text-blue-800",children:[c.jsx("strong",{children:"Requirements:"})," Minimum ",e.min_words||50," words, 0-",e.max_duration||600," seconds duration"]})})]}),c.jsx(aie,{ref:V,onRecordingComplete:se,minDuration:0,maxDuration:e.max_duration||600,minWords:e.min_words||50,maxAttempts:P,currentAttempt:N}),k&&c.jsx("div",{className:"mt-4 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-red-800",children:k})})]});case"processing":return c.jsxs("div",{className:"transcription-status bg-white rounded-lg shadow-lg p-4 sm:p-8 text-center",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("div",{className:"text-6xl mb-4",children:""}),c.jsx("h3",{className:"text-2xl font-semibold mb-2",children:"Processing Your Speech"}),c.jsx("p",{className:"text-lg text-blue-600",children:"Please wait while we process your audio..."})]}),c.jsxs("div",{className:"inline-flex space-x-1",children:[c.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),c.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),c.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]});case"feedback":return console.log(" Rendering feedback step with Submit Final button"),c.jsx(iie,{transcript:l,scores:d,audioBlob:i,recordingTime:j,onReRecord:X,onFinalSubmit:()=>v(!0),canReRecord:N<P,attemptNumber:N,maxAttempts:P,isSubmitting:g});case"completed":const ce={showResults:!0,testInfo:{test_name:e?.test_name||"Speaking Test",id:e?.test_id,test_id:e?.test_id},testType:"speaking",score:d?.overall_score||0,totalQuestions:1,percentage:d?.overall_score||0,passed:(d?.overall_score||0)>=50,questionAnalysis:[{questionNumber:1,userAnswer:l,correctAnswer:"Speaking test completed",isCorrect:!0,score:d?.overall_score||0,maxScore:100,feedback:`Word Count: ${d?.word_count||0}, Grammar: ${d?.grammar_score||0}/40, Vocabulary: ${d?.vocab_score||0}/30`}],timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};return c.jsx("div",{className:"speaking-test-completed",children:c.jsx(Uv,{testResults:ce,onBackToCabinet:()=>C(!0),onRetakeTest:()=>{a("recording"),u(""),h(null),o(null),E(1)},isLoading:!1})});default:return null}};return c.jsxs("div",{children:[c.jsx(da,{isOpen:x&&!g,onClose:()=>v(!1),title:"Submit Speaking Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Je,{onClick:()=>v(!1),variant:"secondary",children:"Cancel"}),c.jsx(Je,{onClick:()=>{v(!1),ie()},variant:"primary",children:"Submit"})]})]})}),c.jsx(da,{isOpen:w,onClose:()=>C(!1),title:"Exit Speaking Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet?"}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Je,{onClick:()=>C(!1),variant:"secondary",children:"Cancel"}),c.jsx(Je,{onClick:()=>{C(!1),typeof r=="function"&&r()},variant:"primary",children:"Go Back"})]})]})}),c.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-3 sm:p-6",children:[k&&c.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-red-800",children:k})}),le()]})]})},lie=e=>function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296},cie=(e,t,r)=>{if(e.length===1)return e[0];const n=`${r}:speaking:${t}`,s=Array.from(n).reduce((o,l)=>(o<<5)-o+l.charCodeAt(0),0)>>>0,a=lie(s),i=Math.floor(a()*e.length);return e[i]},uie=()=>{const{testId:e}=F_(),t=vo(),{user:r}=Qn(),n=Wo(),{showNotification:s}=Da(),[a,i]=S.useState(null),[o,l]=S.useState([]),[u,d]=S.useState(null),[h,g]=S.useState(!0),[p,x]=S.useState(null),[v,w]=S.useState(!1),[C,k]=S.useState(null),[_,N]=S.useState(!1),{startTracking:E,stopTracking:P}=qm("speaking",e,r?.student_id||r?.id);S.useEffect(()=>{F(),A()},[e]),S.useEffect(()=>{if(a&&!v){pe.debug(" Speaking test - initializing anti-cheating tracking");const Y=r?.student_id||r?.id||"unknown",Z=`anti_cheating_${Y}_speaking_${e}`,ae=localStorage.getItem(Z);if(pe.debug(" Checking for anti-cheating data with key:",Z),pe.debug(" Key format: anti_cheating_{studentId}_{testType}_{testId}"),pe.debug(" Current test details:",{testType:"speaking",testId:e,studentId:Y}),ae)try{const ee=JSON.parse(ae);pe.debug(" Found existing anti-cheating data for THIS speaking test:",ee),pe.debug(" Visibility change times for this test:",ee.tabSwitches||0),pe.debug(" Cheating status for this test:",ee.isCheating||!1),ee.isCheating&&(pe.debug(" WARNING: Student has been flagged for cheating in THIS speaking test!"),pe.debug(" Tab switches detected in this test:",ee.tabSwitches),s(` Warning: Suspicious activity detected in this speaking test (${ee.tabSwitches} tab switches). Continued violations may result in test disqualification.`,"warning"))}catch(ee){pe.error(" Error parsing existing anti-cheating data:",ee)}else pe.debug(" No existing anti-cheating data found for this speaking test - starting fresh");E(),pe.debug(" Anti-cheating tracking started for speaking test")}return()=>{a&&(pe.debug(" Cleaning up anti-cheating tracking for speaking test"),P())}},[a,v,e,r?.student_id,r?.id,E,P,s]);const F=async()=>{try{g(!0);const Y=await n.getSpeakingTest(e);if(Y.success)i(Y.test);else throw new Error(Y.message||"Failed to load test");const Z=await n.getSpeakingTestQuestions(e);if(Z.success){const ae=Z.questions;l(ae);const ee=r?.student_id||r?.id,ne=cie(ae,e,ee);d(ne),pe.debug(" Selected question for student:",{studentId:ee,testId:e,totalQuestions:ae.length,selectedQuestion:ne?.id,selectedPrompt:ne?.prompt?.substring(0,50)+"..."})}}catch(Y){pe.error("Error loading test data:",Y),x(Y.message)}finally{g(!1)}},A=()=>{const Z=`test_completed_${r?.student_id||r?.id}_speaking_${e}`;if(localStorage.getItem(Z)==="true"){w(!0);const ee=localStorage.getItem(`speaking_test_result_${e}`);ee&&k(JSON.parse(ee))}},j=async Y=>{try{w(!0),k(Y),localStorage.setItem(`speaking_test_result_${e}`,JSON.stringify(Y)),window.dispatchEvent(new CustomEvent("testCompleted",{detail:{testId:e,testType:"speaking"}})),setTimeout(()=>{t("/student")},2e3)}catch(Z){pe.error("Error handling test completion:",Z)}},R=()=>{if(pe.debug(" Navigating back to cabinet from speaking test..."),a&&r?.student_id){pe.debug(" Cabinet navigation detected - counting as cheating attempt");const Z=`anti_cheating_${r?.student_id||r?.id||"unknown"}_speaking_${e}`,ae=localStorage.getItem(Z);let ee=0,ne=!1;if(ae)try{const V=JSON.parse(ae);ee=V.tabSwitches||0,ne=V.isCheating||!1}catch(V){pe.error(" Error parsing existing anti-cheating data:",V)}const L=ee+1,H=L>=2;pe.debug(` Tab switch count: ${ee}  ${L} (cheating: ${H})`);const M={tabSwitches:L,isCheating:H,lastUpdated:new Date().toISOString()};localStorage.setItem(Z,JSON.stringify(M)),pe.debug(" Anti-cheating data updated for cabinet navigation:",M)}t("/student")};if(h)return c.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsx("div",{children:c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),c.jsx(Je,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),c.jsx("p",{className:"text-gray-600 mt-4",children:"Loading speaking test..."})]})})})]});if(p)return c.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsx("div",{children:c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),c.jsx(Je,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-red-600 text-6xl mb-4",children:""}),c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Test"}),c.jsx("p",{className:"text-gray-600 mb-6",children:p})]})})})]});if(v&&C)return c.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsx("div",{children:c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test Results"})}),c.jsx(Je,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsx(Uv,{testType:"speaking",testData:a,result:C,onRetake:()=>{w(!1),k(null);const Y=JSON.parse(localStorage.getItem("userData")||"{}").student_id;localStorage.removeItem(`test_completed_${Y}_speaking_${e}`)}})})]});if(!a||o.length===0)return c.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsx("div",{children:c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),c.jsx(Je,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"No Test Data"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Unable to load test information"})]})})})]});const U=u;return c.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[c.jsx(da,{isOpen:_,onClose:()=>N(!1),title:"Exit Speaking Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet?"}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Je,{onClick:()=>N(!1),variant:"secondary",children:"Cancel"}),c.jsx(Je,{onClick:()=>{N(!1),R()},variant:"primary",children:"Go Back"})]})]})}),c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsx("div",{children:c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),c.jsx(Je,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.length>1&&u&&c.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-start",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:c.jsx("span",{className:"text-white text-xs font-bold",children:"i"})})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Question Selection"}),c.jsx("div",{className:"mt-1 text-sm text-blue-700",children:c.jsxs("p",{children:["This test has ",o.length," questions. You have been assigned ",c.jsxs("strong",{children:["Question ",u.question_number]}),"."]})})]})]})}),c.jsx(oie,{testData:{...a,test_id:parseInt(e),question_id:U?.id,prompt:U?.prompt,start_time:Date.now()},onComplete:j,onExit:R,onTestComplete:j})]})]})},die=()=>{const{testType:e,testId:t}=F_(),r=vo(),{activeTests:n}=$v(),s=()=>{r("/student")},a=n.find(i=>i.test_type===e&&i.test_id===parseInt(t));return c.jsx(rie,{onBackToCabinet:s,currentTest:a||{test_type:e,test_id:parseInt(t)}})},fie=()=>{const e=vo(),{user:t,isAuthenticated:r,isLoading:n}=Qn(),[s,a]=S.useState(!1),[i,o]=S.useState(!0),[l,u]=S.useState(""),[d,h]=S.useState([]),[g,p]=S.useState(!1),[x,v]=S.useState(!1),[w,C]=S.useState({currentPassword:"",newPassword:"",confirmPassword:""}),k=S.useCallback(async()=>{pe.debug(" Initializing Student Application...");try{if(o(!0),u(""),!r||!t){pe.debug(" User not authenticated, redirecting to login"),e("/login");return}if(t.role!==Hi.STUDENT){pe.error(" Invalid user role for student app:",t.role),u("Access denied. Student role required.");return}pe.debug(" Initializing event listeners..."),_(),pe.debug(" Setting up back to cabinet button listeners..."),N(),pe.debug(" Setting up password change form listener..."),E(),pe.debug(" Loading student data..."),await P(),pe.debug(" Exposing student functions globally..."),F(),pe.debug(" Populating student info from user data..."),Z(t),a(!0),pe.debug(" Student Application initialization complete!")}catch(ne){pe.error(" Error initializing student app:",ne),u("Failed to initialize student application")}finally{o(!1)}},[r,t,e]);S.useEffect(()=>{n||k()},[n,r,t,k]);const _=S.useCallback(()=>{pe.debug(" Setting up student event listeners...");const ne=H=>{g&&!H.target.closest(".student-menu")&&p(!1)},L=H=>{H.key==="Escape"&&g&&p(!1)};return document.addEventListener("click",ne),document.addEventListener("keydown",L),()=>{document.removeEventListener("click",ne),document.removeEventListener("keydown",L)}},[g]),N=S.useCallback(()=>{pe.debug(" Setting up back to cabinet listeners...")},[]),E=S.useCallback(()=>{pe.debug(" Setting up password change form...")},[]),P=S.useCallback(async()=>{pe.debug(" Loading student data...");try{pe.debug(" Student data loaded successfully")}catch(ne){throw pe.error(" Error loading student data:",ne),ne}},[]),F=S.useCallback(()=>{pe.debug(" Exposing student functions globally..."),window.toggleStudentMenu=A,window.showChangePasswordTab=j,window.hideChangePasswordTab=R,window.navigateBackToCabinet=Y,window.handlePasswordChange=U,window.populateStudentInfoDirectly=Z,pe.debug(" All student functions exposed globally")},[]),A=S.useCallback(()=>{pe.debug(" toggleStudentMenu called"),p(ne=>{const L=!ne;return pe.debug(" Menu state changed from",ne,"to",L),L}),pe.debug(" Toggled dropdown menu")},[]),j=S.useCallback(()=>{pe.debug(" showChangePasswordTab called"),v(!0),p(!1)},[]),R=S.useCallback(()=>{pe.debug(" hideChangePasswordTab called"),v(!1),C({currentPassword:"",newPassword:"",confirmPassword:""})},[]),U=S.useCallback(async ne=>{ne.preventDefault(),pe.debug(" handlePasswordChange called");const{currentPassword:L,newPassword:H,confirmPassword:M}=w;if(!L||!H||!M){ae("Please fill in all fields","error");return}if(H!==M){ae("New passwords do not match","error");return}if(H.length<6){ae("New password must be at least 6 characters long","error");return}const V=/[a-zA-Z]/.test(H),W=/[0-9]/.test(H);if(!V||!W){ae("New password must contain both letters and numbers","error");return}if(!t||!t.student_id){ae("Session expired. Please login again.","error");return}const I=t.student_id;if(window.confirm("Are you sure you want to change your password?"))try{o(!0);const B=await ns.changePassword({studentId:I,currentPassword:L,newPassword:H});B.success?(ae("Password changed successfully!","success"),R()):ae(B.message||"Failed to change password","error")}catch(B){pe.error("Password change error:",B),ae("Failed to change password. Please try again.","error")}finally{o(!1)}},[w,t]),Y=S.useCallback(()=>{if(pe.debug("[DEBUG] navigateBackToCabinet called"),!r||!t){pe.warn("[WARN] No valid user found, redirecting to login"),e("/login");return}t.role===Hi.STUDENT?(pe.debug("[DEBUG] Navigating to student cabinet"),e("/student")):(pe.warn("[WARN] Unknown user role, redirecting to login"),e("/login"))},[r,t,e]),Z=S.useCallback(ne=>{pe.debug(" populateStudentInfoDirectly called with:",ne);try{pe.debug(" Student info populated successfully")}catch(L){pe.error(" Error populating student info:",L)}},[]),ae=S.useCallback((ne,L)=>{const H={id:Date.now(),message:ne,type:L,timestamp:new Date};h(M=>[...M,H]),setTimeout(()=>{h(M=>M.filter(V=>V.id!==H.id))},C0.NOTIFICATION_DURATION)},[]),ee=S.useCallback(ne=>{const{name:L,value:H}=ne.target;C(M=>({...M,[L]:H}))},[]);return i?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(Ur,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Initializing Student Application..."})]})}):l?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Initialization Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:l}),c.jsx(Je,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?c.jsxs("div",{className:"bg-gray-50",children:[c.jsxs(hN,{children:[c.jsx(ks,{path:"/",element:c.jsxs("div",{className:"student-app",children:[c.jsx(Qae,{isMenuOpen:g,onToggleMenu:A,onShowPasswordChange:j}),x&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Change Password"}),c.jsxs("form",{onSubmit:U,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),c.jsx("input",{type:"password",id:"currentPassword",name:"currentPassword",value:w.currentPassword,onChange:ee,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),c.jsx("input",{type:"password",id:"newPassword",name:"newPassword",value:w.newPassword,onChange:ee,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),c.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:w.confirmPassword,onChange:ee,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),c.jsxs("div",{className:"flex space-x-3 pt-4",children:[c.jsx(Je,{type:"button",variant:"secondary",onClick:R,className:"flex-1",children:"Cancel"}),c.jsx(Je,{type:"submit",variant:"primary",disabled:i,className:"flex-1",children:i?c.jsxs(c.Fragment,{children:[c.jsx(Ur,{size:"sm",className:"mr-2"}),"Changing..."]}):"Change Password"})]})]})]})})]})}),c.jsx(ks,{path:"/test/:testType/:testId",element:c.jsx(die,{})}),c.jsx(ks,{path:"matching-test/:testId",element:c.jsx(nie,{})}),c.jsx(ks,{path:"word-matching-test/:testId",element:c.jsx(sie,{})}),c.jsx(ks,{path:"speaking-test/:testId",element:c.jsx(uie,{})}),c.jsx(ks,{path:"/results",element:c.jsx(WB,{})})]}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:d.map(ne=>c.jsx(ac,{type:ne.type,message:ne.message,onClose:()=>h(L=>L.filter(H=>H.id!==ne.id))},ne.id))})]}):c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(Ur,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Setting up Student Application..."})]})})},hie=()=>c.jsx(OM,{children:c.jsx(PB,{children:c.jsx(AB,{children:c.jsx(fie,{})})})}),gie=({result:e,isOpen:t,onClose:r,initialTab:n="overview",editingSpeakingScore:s,tempSpeakingScore:a,isSavingSpeakingScore:i,onStartSpeakingScoreEdit:o,onSaveSpeakingScore:l,onCancelSpeakingScoreEdit:u,onTempSpeakingScoreChange:d})=>{const[h,g]=S.useState(n),p=S.useRef(!1);if(S.useEffect(()=>()=>{p.current=!0},[]),S.useEffect(()=>{t&&g(n)},[t,n]),!t||!e)return null;const x={test_id:e.test_id,test_name:e.test_name,subject_id:e.subject_id};let v=e?.__audioUrl||void 0;const w=v?void 0:e?.answers;typeof w=="string"?v=w:w&&typeof w=="object"&&(v=w.audio_url),S.useEffect(()=>{console.log("[SpeakingReview] Transcript sources",{fromResult:e?.transcript,fromAnswersObject:typeof w=="object"&&w?.transcript?w.transcript:void 0,hasAnswers:!!w,test_id:e?.test_id,student_id:e?.student_id})},[e?.test_id,e?.student_id]);const[C,k]=S.useState("");S.useEffect(()=>{const N=new AbortController;let E=!1;const P=e?.__studentId||e?.student_id;return!e?.transcript&&!(typeof w=="object"&&w?.transcript)&&e?.test_id&&P&&(async()=>{try{const F=`/.netlify/functions/get-speaking-test-new?action=transcript&test_id=${encodeURIComponent(e.test_id)}&student_id=${encodeURIComponent(P)}`;console.log("[SpeakingReview] Fetching transcript from API:",{url:F});const A=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token"),j=await fetch(F,{headers:{Authorization:A?`Bearer ${A}`:""},signal:N.signal});console.log("[SpeakingReview] Transcript API response:",{ok:j.ok,status:j.status});const R=await j.json().catch(()=>({}));console.log("[SpeakingReview] Transcript API body:",R),!E&&!p.current&&(j.ok?k(R.transcript||""):console.warn("[SpeakingReview] Transcript API failed:",R?.error||"unknown error"))}catch(F){F.name!=="AbortError"&&!p.current&&console.error("[SpeakingReview] Transcript fetch error:",F)}})(),()=>{E=!0;try{N.abort()}catch{}}},[e]);const _={score:e.score,max_score:e.max_score,percentage:e.percentage,audio_url:v,transcript:e.transcript||C||(typeof w=="object"&&w?.transcript?w.transcript:void 0),time_taken:e.time_taken,started_at:e.started_at,submitted_at:e.submitted_at};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[c.jsxs("div",{className:"bg-blue-600 text-white px-6 py-4 flex justify-between items-center",children:[c.jsxs("h2",{className:"text-xl font-semibold",children:["Speaking Test Review - ",x.test_name]}),c.jsx("button",{onClick:r,className:"text-white hover:text-gray-200 text-2xl font-bold",children:""})]}),c.jsx("div",{className:"border-b border-gray-200",children:c.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"audio",label:"Audio"},{id:"transcript",label:"Transcript"},{id:"analysis",label:"AI Analysis"},{id:"scoring",label:"Scoring"}].map(N=>c.jsx("button",{onClick:()=>g(N.id),className:`py-4 px-1 border-b-2 font-medium text-sm ${h===N.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:N.label},N.id))})}),c.jsxs("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:[h==="overview"&&c.jsx("div",{className:"space-y-4",children:c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Test Name"}),c.jsx("p",{className:"mt-1 text-sm text-gray-900",children:x.test_name})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Score"}),c.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[_.score," / ",_.max_score]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Time Taken"}),c.jsx("p",{className:"mt-1 text-sm text-gray-900",children:_.time_taken?`${Math.floor(_.time_taken/60)}:${(_.time_taken%60).toString().padStart(2,"0")}`:"N/A"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Submitted At"}),c.jsx("p",{className:"mt-1 text-sm text-gray-900",children:_.submitted_at?new Date(_.submitted_at).toLocaleString():"N/A"})]})]})}),h==="audio"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Audio Recording"}),_.audio_url?c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Click the play button to listen to the student's recording:"}),c.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:c.jsx(HB,{audioUrl:_.audio_url,className:"w-full"})})]}):c.jsx("div",{className:"text-center py-8 text-gray-500",children:c.jsx("p",{children:"No audio recording available"})})]}),h==="transcript"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Transcript"}),_.transcript?c.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:c.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:_.transcript})}):c.jsx("div",{className:"text-center py-8 text-gray-500",children:c.jsx("p",{children:"No transcript available"})})]}),h==="analysis"&&c.jsxs("div",{className:"space-y-6",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"AI Analysis Results"}),(()=>{let N=e.ai_feedback;if(N&&typeof N=="string")try{N=JSON.parse(N)}catch{N=null}return N?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[c.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-4",children:"Overall Performance"}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-3xl font-bold text-gray-800",children:N.overall_score||0}),c.jsx("div",{className:"text-sm text-gray-600",children:"Overall Score (0-100)"})]})]}),c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-4",children:"Category Breakdown"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[N.grammar_score||0,"/25"]}),c.jsx("div",{className:"text-xs text-gray-600",children:"Grammar"})]}),c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-lg font-bold text-green-600",children:[N.vocabulary_score||0,"/20"]}),c.jsx("div",{className:"text-xs text-gray-600",children:"Vocabulary"})]}),c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[N.pronunciation_score||0,"/15"]}),c.jsx("div",{className:"text-xs text-gray-600",children:"Pronunciation"})]}),c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-lg font-bold text-orange-600",children:[N.fluency_score||0,"/20"]}),c.jsx("div",{className:"text-xs text-gray-600",children:"Fluency"})]}),c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-lg font-bold text-red-600",children:[N.content_score||0,"/20"]}),c.jsx("div",{className:"text-xs text-gray-600",children:"Content"})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Performance Metrics"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Word Count:"}),c.jsx("span",{className:"text-sm font-medium",children:N.word_count||0})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Grammar Mistakes:"}),c.jsx("span",{className:"text-sm font-medium text-red-600",children:N.grammar_mistakes||0})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Vocabulary Issues:"}),c.jsx("span",{className:"text-sm font-medium text-red-600",children:N.vocabulary_mistakes||0})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Difficulty Level:"}),c.jsx("span",{className:"text-sm font-medium",children:N.difficulty_level||"N/A"})]})]})]}),c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"AI Feedback"}),N.feedback?c.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:c.jsx("p",{className:"text-sm text-gray-700",children:N.feedback})}):c.jsx("div",{className:"text-center py-4 text-gray-500",children:c.jsx("p",{className:"text-sm",children:"No AI feedback available"})})]})]}),N.improved_transcript&&c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Improved Transcript"}),c.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:c.jsx("p",{className:"text-sm text-gray-700",children:N.improved_transcript})})]}),N.grammar_corrections&&N.grammar_corrections.length>0&&c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Grammar Corrections"}),c.jsx("div",{className:"space-y-3",children:N.grammar_corrections.map((E,P)=>c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-medium text-red-800",children:"Mistake:"})," ",E.mistake]}),c.jsxs("div",{className:"text-sm mt-1",children:[c.jsx("span",{className:"font-medium text-green-800",children:"Correction:"})," ",E.correction]}),E.explanation&&c.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[c.jsx("span",{className:"font-medium",children:"Explanation:"})," ",E.explanation]})]},P))})]}),N.vocabulary_corrections&&N.vocabulary_corrections.length>0&&c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Vocabulary Improvements"}),c.jsx("div",{className:"space-y-3",children:N.vocabulary_corrections.map((E,P)=>c.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-medium text-yellow-800",children:"Original:"})," ",E.mistake]}),c.jsxs("div",{className:"text-sm mt-1",children:[c.jsx("span",{className:"font-medium text-green-800",children:"Better:"})," ",E.correction]}),E.explanation&&c.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[c.jsx("span",{className:"font-medium",children:"Explanation:"})," ",E.explanation]})]},P))})]}),N.language_use_corrections&&N.language_use_corrections.length>0&&c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Language Use Suggestions"}),c.jsx("div",{className:"space-y-3",children:N.language_use_corrections.map((E,P)=>c.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"font-medium text-blue-800",children:"Original:"})," ",E.mistake]}),c.jsxs("div",{className:"text-sm mt-1",children:[c.jsx("span",{className:"font-medium text-blue-800",children:"Suggestion:"})," ",E.suggestion]}),E.explanation&&c.jsx("div",{className:"text-xs text-blue-700 mt-1",children:E.explanation})]},P))})]})]}):c.jsx("div",{className:"text-center py-8 text-gray-500",children:c.jsx("p",{children:"No AI analysis available for this result"})})})()]}),h==="scoring"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 text-center",children:"Score Details"}),s?c.jsxs("div",{className:"space-y-4 text-center",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 place-items-center",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Score"}),c.jsx("input",{type:"number",min:"0",max:_.max_score,value:a,onChange:N=>d(N.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Max Score"}),c.jsxs("p",{className:"mt-1 text-sm text-gray-900 text-center",children:[_.max_score," (Fixed)"]})]})]}),c.jsxs("div",{className:"flex justify-center space-x-3",children:[c.jsx("button",{onClick:l,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:i?"Saving...":"Save Score"}),c.jsx("button",{onClick:u,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Cancel"})]})]}):c.jsxs("div",{className:"space-y-4 text-center",children:[c.jsx("div",{className:"grid grid-cols-1 place-items-center gap-2",children:c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Current Score"}),c.jsxs("p",{className:"mt-1 text-sm text-gray-900 text-center",children:[_.score," / ",_.max_score]})]})}),c.jsx("button",{onClick:()=>o(e.id,_.score),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 mx-auto",children:"Edit Score"})]})]})]}),c.jsx("div",{className:"bg-gray-50 px-6 py-4 flex justify-end space-x-3",children:c.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Close"})})]})})};class NF extends Ss.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){if(console.error("ErrorBoundary caught an error:",t,r),t.message&&t.message.includes("Minified React error #300")){console.warn("React error #300 caught and handled by ErrorBoundary");return}}render(){return this.state.hasError?c.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[c.jsx("h3",{className:"text-red-800 font-medium",children:"Something went wrong"}),c.jsx("p",{className:"text-red-600 text-sm mt-1",children:"An error occurred while rendering this component."})]}):this.props.children}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Mb={};Mb.version="0.18.5";var GB=1252,mie=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Y4={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},X4=function(e){mie.indexOf(e)!=-1&&(GB=Y4[0]=e)};function pie(){X4(1252)}var ec=function(e){X4(e)};function J4(){ec(1200),pie()}function AF(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function xie(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function VB(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var oy=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?xie(e.slice(2)):t==254&&r==255?VB(e.slice(2)):t==65279?e.slice(1):e},kw=function(t){return String.fromCharCode(t)},jF=function(t){return String.fromCharCode(t)},Xy,df="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Jy(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,s=e.charCodeAt(u++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),t+=df.charAt(a)+df.charAt(i)+df.charAt(o)+df.charAt(l);return t}function Uo(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=df.indexOf(e.charAt(u++)),i=df.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=df.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=df.indexOf(e.charAt(u++)),s=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var Yr=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),id=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Sf(e){return Yr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function PF(e){return Yr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Io=function(t){return Yr?id(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function s2(e){if(typeof ArrayBuffer>"u")return Io(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Rf(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function yie(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Q4(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Q4(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ja=Yr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:id(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function vie(e){for(var t=[],r=0,n=e.length+250,s=Sf(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Sf(65535),n=65530)}return t.push(s.slice(0,r)),ja(t)}var Yi=/\u0000/g,ly=/[\u0001-\u0006]/g;function lm(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function tc(e,t){var r=""+e;return r.length>=t?r:Cs("0",t-r.length)+r}function Z4(e,t){var r=""+e;return r.length>=t?r:Cs(" ",t-r.length)+r}function Lb(e,t){var r=""+e;return r.length>=t?r:r+Cs(" ",t-r.length)}function wie(e,t){var r=""+Math.round(e);return r.length>=t?r:Cs("0",t-r.length)+r}function bie(e,t){var r=""+e;return r.length>=t?r:Cs("0",t-r.length)+r}var FF=Math.pow(2,32);function Og(e,t){if(e>FF||e<-FF)return wie(e,t);var r=Math.round(e);return bie(r,t)}function Bb(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var OF=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],yk=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function _ie(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ar={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},DF={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Sie={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $b(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,l=1,u=0,d=0,h=Math.floor(s);u<t&&(h=Math.floor(s),o=h*i+a,d=h*u+l,!(s-h<5e-8));)s=1/(s-h),a=i,i=o,l=u,u=d;if(d>t&&(u>t?(d=l,o=a):(d=u,o=i)),!r)return[0,n*o,d];var g=Math.floor(n*o/d);return[g,n*o-g*d,d]}function Ph(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=Aie(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var KB=new Date(1899,11,31,0,0,0),kie=KB.getTime(),Cie=new Date(1900,2,1,0,0,0);function qB(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Cie&&(r+=1440*60*1e3),(r-(kie+(e.getTimezoneOffset()-KB.getTimezoneOffset())*6e4))/(1440*60*1e3)}function e3(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Tie(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Eie(e){var t=e<0?12:11,r=e3(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Nie(e){var t=e3(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Qy(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Eie(e):t===10?r=e.toFixed(10).substr(0,12):r=Nie(e),e3(Tie(r.toUpperCase()))}function u0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Qy(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return kl(14,qB(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Aie(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function jie(e,t,r,n){var s="",a=0,i=0,o=r.y,l,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return yk[r.m-1][1];case 5:return yk[r.m-1][0];default:return yk[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return OF[r.q][0];default:return OF[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?tc(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=tc(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var d=u>0?tc(l,u):"";return d}function ff(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var YB=/%/g;function Pie(e,t,r){var n=t.replace(YB,""),s=t.length-n.length;return Wu(e,n,r*Math.pow(10,2*s))+Cs("%",s)}function Fie(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Wu(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function XB(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+XB(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,d){return l+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var JB=/# (\?+)( ?)\/( ?)(\d+)/;function Oie(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Cs(" ",e[1].length+1+e[4].length):Z4(i,e[1].length)+e[2]+"/"+e[3]+tc(o,e[4].length))}function Die(e,t,r){return r+(t===0?"":""+t)+Cs(" ",e[1].length+2+e[4].length)}var QB=/^#*0*\.([0#]+)/,ZB=/\).*[0#]/,e$=/\(###\) ###\\?-####/;function zi(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function RF(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function IF(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Rie(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Iie(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ll(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZB)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ll("n",n,r):"("+ll("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Fie(e,t,r);if(t.indexOf("%")!==-1)return Pie(e,t,r);if(t.indexOf("E")!==-1)return XB(t,r);if(t.charCodeAt(0)===36)return"$"+ll(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Og(l,t.length);if(t.match(/^[#?]+$/))return s=Og(r,0),s==="0"&&(s=""),s.length>t.length?s:zi(t.substr(0,t.length-s.length))+s;if(a=t.match(JB))return Oie(a,l,u);if(t.match(/^#+0+$/))return u+Og(l,t.length-t.indexOf("0"));if(a=t.match(QB))return s=RF(r,a[1].length).replace(/^([^\.]+)$/,"$1."+zi(a[1])).replace(/\.$/,"."+zi(a[1])).replace(/\.(\d*)$/,function(x,v){return"."+v+Cs("0",zi(a[1]).length-v.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+RF(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+ff(Og(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ll(e,t,-r):ff(""+(Math.floor(r)+Rie(r,a[1].length)))+"."+tc(IF(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return ll(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=lm(ll(e,t.replace(/[\\-]/g,""),r)),i=0,lm(lm(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(e$))return s=ll(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=$b(l,Math.pow(10,i)-1,!1),s=""+u,d=Wu("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=Lb(o[2],i),d.length<a[4].length&&(d=zi(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=$b(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Z4(o[1],i)+a[2]+"/"+a[3]+Lb(o[2],i):Cs(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=Og(r,0),t.length<=s.length?s:zi(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=t.indexOf(".")-i,g=t.length-s.length-h;return zi(t.substr(0,h)+s+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=IF(r,a[1].length),r<0?"-"+ll(e,t,-r):ff(Iie(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?tc(0,3-x.length):"")+x})+"."+tc(i,a[1].length);switch(t){case"###,##0.00":return ll(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=ff(Og(l,0));return p!=="0"?u+p:"";case"###,###.00":return ll(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ll(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Mie(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Wu(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Lie(e,t,r){var n=t.replace(YB,""),s=t.length-n.length;return Wu(e,n,r*Math.pow(10,2*s))+Cs("%",s)}function t$(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+t$(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,d){return l+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Dc(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZB)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Dc("n",n,r):"("+Dc("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Mie(e,t,r);if(t.indexOf("%")!==-1)return Lie(e,t,r);if(t.indexOf("E")!==-1)return t$(t,r);if(t.charCodeAt(0)===36)return"$"+Dc(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+tc(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:zi(t.substr(0,t.length-s.length))+s;if(a=t.match(JB))return Die(a,l,u);if(t.match(/^#+0+$/))return u+tc(l,t.length-t.indexOf("0"));if(a=t.match(QB))return s=(""+r).replace(/^([^\.]+)$/,"$1."+zi(a[1])).replace(/\.$/,"."+zi(a[1])),s=s.replace(/\.(\d*)$/,function(x,v){return"."+v+Cs("0",zi(a[1]).length-v.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+ff(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Dc(e,t,-r):ff(""+r)+"."+Cs("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Dc(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=lm(Dc(e,t.replace(/[\\-]/g,""),r)),i=0,lm(lm(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(e$))return s=Dc(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=$b(l,Math.pow(10,i)-1,!1),s=""+u,d=Wu("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=Lb(o[2],i),d.length<a[4].length&&(d=zi(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=$b(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Z4(o[1],i)+a[2]+"/"+a[3]+Lb(o[2],i):Cs(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:zi(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=t.indexOf(".")-i,g=t.length-s.length-h;return zi(t.substr(0,h)+s+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Dc(e,t,-r):ff(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?tc(0,3-x.length):"")+x})+"."+tc(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=ff(""+l);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return Dc(e,t.slice(0,t.lastIndexOf(".")),r)+zi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Wu(e,t,r){return(r|0)===r?Dc(e,t,r):ll(e,t,r)}function Bie(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var r$=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Xm(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Bb(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(r$))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function $ie(e,t,r,n){for(var s=[],a="",i=0,o="",l="t",u,d,h,g="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Bb(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(h=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(h);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=e.charAt(++i),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=Ph(t,r,e.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Ph(t,r),u==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var v={t:o,v:o};if(u==null&&(u=Ph(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(v.v=u.H>=12?"P":"A"),v.t="T",g="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(v.v=u.H>=12?"PM":"AM"),v.t="T",i+=5,g="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(v.v=u.H>=12?"":""),v.t="T",i+=5,g="h"):(v.t="t",++i),u==null&&v.t==="T")return"";s[s.length]=v,l=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(r$)){if(u==null&&(u=Ph(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Xm(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var w=0,C=0,k;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=g,l="h",w<1&&(w=1);break;case"s":(k=s[i].v.match(/\.0+$/))&&(C=Math.max(C,k[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[i].v.match(/[Hh]/)&&(w=1),w<2&&s[i].v.match(/[Mm]/)&&(w=2),w<3&&s[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",N;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=jie(s[i].t.charCodeAt(0),s[i].v,u,C),s[i].t="t";break;case"n":case"?":for(N=i+1;s[N]!=null&&((o=s[N].t)==="?"||o==="D"||(o===" "||o==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[i].v+=s[N].v,s[N]={v:"",t:";"},++N;_+=s[i].v,i=N-1;break;case"G":s[i].t="t",s[i].v=u0(t,r);break}var E="",P,F;if(_.length>0){_.charCodeAt(0)==40?(P=t<0&&_.charCodeAt(0)===45?-t:t,F=Wu("n",_,P)):(P=t<0&&n>1?-t:t,F=Wu("n",_,P),P<0&&s[0]&&s[0].t=="t"&&(F=F.substr(1),s[0].v="-"+s[0].v)),N=F.length-1;var A=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){A=i;break}var j=s.length;if(A===s.length&&F.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(N>=s[i].v.length-1?(N-=s[i].v.length,s[i].v=F.substr(N+1,s[i].v.length)):N<0?s[i].v="":(s[i].v=F.substr(0,N+1),N=-1),s[i].t="t",j=i);N>=0&&j<s.length&&(s[j].v=F.substr(0,N+1)+s[j].v)}else if(A!==s.length&&F.indexOf("E")===-1){for(N=F.indexOf(".")-1,i=A;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===A?s[i].v.indexOf(".")-1:s[i].v.length-1,E=s[i].v.substr(d+1);d>=0;--d)N>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(E=F.charAt(N--)+E);s[i].v=E,s[i].t="t",j=i}for(N>=0&&j<s.length&&(s[j].v=F.substr(0,N+1)+s[j].v),N=F.indexOf(".")+1,i=A;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==A)){for(d=s[i].v.indexOf(".")>-1&&i===A?s[i].v.indexOf(".")+1:0,E=s[i].v.substr(0,d);d<s[i].v.length;++d)N<F.length&&(E+=F.charAt(N++));s[i].v=E,s[i].t="t",j=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(P=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=Wu(s[i].t,s[i].v,P),s[i].t="t");var R="";for(i=0;i!==s.length;++i)s[i]!=null&&(R+=s[i].v);return R}var MF=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function LF(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Uie(e,t){var r=Bie(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(MF),o=r[1].match(MF);return LF(t,i)?[n,r[0]]:LF(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function kl(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ar)[e],n==null&&(n=r.table&&r.table[DF[e]]||Ar[DF[e]]),n==null&&(n=Sie[e]||"General");break}if(Bb(n,0))return u0(t,r);t instanceof Date&&(t=qB(t,r.date1904));var s=Uie(n,t);if(Bb(s[1]))return u0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return $ie(s[1],t,r,s[0])}function Hu(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ar[r]==null){t<0&&(t=r);continue}if(Ar[r]==e){t=r;break}}t<0&&(t=391)}return Ar[t]=e,t}function a2(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Hu(e[t],t)}function Jm(){Ar=_ie()}var zie={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},n$=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Wie(e){var t=typeof e=="number"?Ar[e]:e;return t=t.replace(n$,"(\\d+)"),new RegExp("^"+t+"$")}function Hie(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(t.match(n$)||[]).forEach(function(h,g){var p=parseInt(r[g+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var Gie=(function(){var e={};e.version="1.2.0";function t(){for(var F=0,A=new Array(256),j=0;j!=256;++j)F=j,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,A[j]=F;return typeof Int32Array<"u"?new Int32Array(A):A}var r=t();function n(F){var A=0,j=0,R=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)U[R]=F[R];for(R=0;R!=256;++R)for(j=F[R],A=256+R;A<4096;A+=256)j=U[A]=j>>>8^F[j&255];var Y=[];for(R=1;R!=16;++R)Y[R-1]=typeof Int32Array<"u"?U.subarray(R*256,R*256+256):U.slice(R*256,R*256+256);return Y}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],u=s[4],d=s[5],h=s[6],g=s[7],p=s[8],x=s[9],v=s[10],w=s[11],C=s[12],k=s[13],_=s[14];function N(F,A){for(var j=A^-1,R=0,U=F.length;R<U;)j=j>>>8^r[(j^F.charCodeAt(R++))&255];return~j}function E(F,A){for(var j=A^-1,R=F.length-15,U=0;U<R;)j=_[F[U++]^j&255]^k[F[U++]^j>>8&255]^C[F[U++]^j>>16&255]^w[F[U++]^j>>>24]^v[F[U++]]^x[F[U++]]^p[F[U++]]^g[F[U++]]^h[F[U++]]^d[F[U++]]^u[F[U++]]^l[F[U++]]^o[F[U++]]^i[F[U++]]^a[F[U++]]^r[F[U++]];for(R+=15;U<R;)j=j>>>8^r[(j^F[U++])&255];return~j}function P(F,A){for(var j=A^-1,R=0,U=F.length,Y=0,Z=0;R<U;)Y=F.charCodeAt(R++),Y<128?j=j>>>8^r[(j^Y)&255]:Y<2048?(j=j>>>8^r[(j^(192|Y>>6&31))&255],j=j>>>8^r[(j^(128|Y&63))&255]):Y>=55296&&Y<57344?(Y=(Y&1023)+64,Z=F.charCodeAt(R++)&1023,j=j>>>8^r[(j^(240|Y>>8&7))&255],j=j>>>8^r[(j^(128|Y>>2&63))&255],j=j>>>8^r[(j^(128|Z>>6&15|(Y&3)<<4))&255],j=j>>>8^r[(j^(128|Z&63))&255]):(j=j>>>8^r[(j^(224|Y>>12&15))&255],j=j>>>8^r[(j^(128|Y>>6&63))&255],j=j>>>8^r[(j^(128|Y&63))&255]);return~j}return e.table=r,e.bstr=N,e.buf=E,e.str=P,e})(),Sr=(function(){var t={};t.version="1.2.1";function r(ue,be){for(var ye=ue.split("/"),xe=be.split("/"),_e=0,Se=0,He=Math.min(ye.length,xe.length);_e<He;++_e){if(Se=ye[_e].length-xe[_e].length)return Se;if(ye[_e]!=xe[_e])return ye[_e]<xe[_e]?-1:1}return ye.length-xe.length}function n(ue){if(ue.charAt(ue.length-1)=="/")return ue.slice(0,-1).indexOf("/")===-1?ue:n(ue.slice(0,-1));var be=ue.lastIndexOf("/");return be===-1?ue:ue.slice(0,be+1)}function s(ue){if(ue.charAt(ue.length-1)=="/")return s(ue.slice(0,-1));var be=ue.lastIndexOf("/");return be===-1?ue:ue.slice(be+1)}function a(ue,be){typeof be=="string"&&(be=new Date(be));var ye=be.getHours();ye=ye<<6|be.getMinutes(),ye=ye<<5|be.getSeconds()>>>1,ue.write_shift(2,ye);var xe=be.getFullYear()-1980;xe=xe<<4|be.getMonth()+1,xe=xe<<5|be.getDate(),ue.write_shift(2,xe)}function i(ue){var be=ue.read_shift(2)&65535,ye=ue.read_shift(2)&65535,xe=new Date,_e=ye&31;ye>>>=5;var Se=ye&15;ye>>>=4,xe.setMilliseconds(0),xe.setFullYear(ye+1980),xe.setMonth(Se-1),xe.setDate(_e);var He=be&31;be>>>=5;var it=be&63;return be>>>=6,xe.setHours(be),xe.setMinutes(it),xe.setSeconds(He<<1),xe}function o(ue){Za(ue,0);for(var be={},ye=0;ue.l<=ue.length-4;){var xe=ue.read_shift(2),_e=ue.read_shift(2),Se=ue.l+_e,He={};switch(xe){case 21589:ye=ue.read_shift(1),ye&1&&(He.mtime=ue.read_shift(4)),_e>5&&(ye&2&&(He.atime=ue.read_shift(4)),ye&4&&(He.ctime=ue.read_shift(4))),He.mtime&&(He.mt=new Date(He.mtime*1e3));break}ue.l=Se,be[xe]=He}return be}var l;function u(){return l||(l={})}function d(ue,be){if(ue[0]==80&&ue[1]==75)return me(ue,be);if((ue[0]|32)==109&&(ue[1]|32)==105)return Ze(ue,be);if(ue.length<512)throw new Error("CFB file size "+ue.length+" < 512");var ye=3,xe=512,_e=0,Se=0,He=0,it=0,Ye=0,oe=[],fe=ue.slice(0,512);Za(fe,0);var Te=h(fe);switch(ye=Te[0],ye){case 3:xe=512;break;case 4:xe=4096;break;case 0:if(Te[1]==0)return me(ue,be);default:throw new Error("Major Version: Expected 3 or 4 saw "+ye)}xe!==512&&(fe=ue.slice(0,xe),Za(fe,28));var Ee=ue.slice(0,xe);g(fe,ye);var Xe=fe.read_shift(4,"i");if(ye===3&&Xe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Xe);fe.l+=4,He=fe.read_shift(4,"i"),fe.l+=4,fe.chk("00100000","Mini Stream Cutoff Size: "),it=fe.read_shift(4,"i"),_e=fe.read_shift(4,"i"),Ye=fe.read_shift(4,"i"),Se=fe.read_shift(4,"i");for(var ut=-1,ft=0;ft<109&&(ut=fe.read_shift(4,"i"),!(ut<0));++ft)oe[ft]=ut;var Kt=p(ue,xe);w(Ye,Se,Kt,xe,oe);var Ct=k(Kt,He,oe,xe);Ct[He].name="!Directory",_e>0&&it!==Z&&(Ct[it].name="!MiniFAT"),Ct[oe[0]].name="!FAT",Ct.fat_addrs=oe,Ct.ssz=xe;var Ht={},yr=[],wr=[],vr=[];_(He,Ct,Kt,yr,_e,Ht,wr,it),x(wr,vr,yr),yr.shift();var Er={FileIndex:wr,FullPaths:vr};return be&&be.raw&&(Er.raw={header:Ee,sectors:Kt}),Er}function h(ue){if(ue[ue.l]==80&&ue[ue.l+1]==75)return[0,0];ue.chk(ae,"Header Signature: "),ue.l+=16;var be=ue.read_shift(2,"u");return[ue.read_shift(2,"u"),be]}function g(ue,be){var ye=9;switch(ue.l+=2,ye=ue.read_shift(2)){case 9:if(be!=3)throw new Error("Sector Shift: Expected 9 saw "+ye);break;case 12:if(be!=4)throw new Error("Sector Shift: Expected 12 saw "+ye);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ye)}ue.chk("0600","Mini Sector Shift: "),ue.chk("000000000000","Reserved: ")}function p(ue,be){for(var ye=Math.ceil(ue.length/be)-1,xe=[],_e=1;_e<ye;++_e)xe[_e-1]=ue.slice(_e*be,(_e+1)*be);return xe[ye-1]=ue.slice(ye*be),xe}function x(ue,be,ye){for(var xe=0,_e=0,Se=0,He=0,it=0,Ye=ye.length,oe=[],fe=[];xe<Ye;++xe)oe[xe]=fe[xe]=xe,be[xe]=ye[xe];for(;it<fe.length;++it)xe=fe[it],_e=ue[xe].L,Se=ue[xe].R,He=ue[xe].C,oe[xe]===xe&&(_e!==-1&&oe[_e]!==_e&&(oe[xe]=oe[_e]),Se!==-1&&oe[Se]!==Se&&(oe[xe]=oe[Se])),He!==-1&&(oe[He]=xe),_e!==-1&&xe!=oe[xe]&&(oe[_e]=oe[xe],fe.lastIndexOf(_e)<it&&fe.push(_e)),Se!==-1&&xe!=oe[xe]&&(oe[Se]=oe[xe],fe.lastIndexOf(Se)<it&&fe.push(Se));for(xe=1;xe<Ye;++xe)oe[xe]===xe&&(Se!==-1&&oe[Se]!==Se?oe[xe]=oe[Se]:_e!==-1&&oe[_e]!==_e&&(oe[xe]=oe[_e]));for(xe=1;xe<Ye;++xe)if(ue[xe].type!==0){if(it=xe,it!=oe[it])do it=oe[it],be[xe]=be[it]+"/"+be[xe];while(it!==0&&oe[it]!==-1&&it!=oe[it]);oe[xe]=-1}for(be[0]+="/",xe=1;xe<Ye;++xe)ue[xe].type!==2&&(be[xe]+="/")}function v(ue,be,ye){for(var xe=ue.start,_e=ue.size,Se=[],He=xe;ye&&_e>0&&He>=0;)Se.push(be.slice(He*Y,He*Y+Y)),_e-=Y,He=Eh(ye,He*4);return Se.length===0?_t(0):ja(Se).slice(0,ue.size)}function w(ue,be,ye,xe,_e){var Se=Z;if(ue===Z){if(be!==0)throw new Error("DIFAT chain shorter than expected")}else if(ue!==-1){var He=ye[ue],it=(xe>>>2)-1;if(!He)return;for(var Ye=0;Ye<it&&(Se=Eh(He,Ye*4))!==Z;++Ye)_e.push(Se);w(Eh(He,xe-4),be-1,ye,xe,_e)}}function C(ue,be,ye,xe,_e){var Se=[],He=[];_e||(_e=[]);var it=xe-1,Ye=0,oe=0;for(Ye=be;Ye>=0;){_e[Ye]=!0,Se[Se.length]=Ye,He.push(ue[Ye]);var fe=ye[Math.floor(Ye*4/xe)];if(oe=Ye*4&it,xe<4+oe)throw new Error("FAT boundary crossed: "+Ye+" 4 "+xe);if(!ue[fe])break;Ye=Eh(ue[fe],oe)}return{nodes:Se,data:XF([He])}}function k(ue,be,ye,xe){var _e=ue.length,Se=[],He=[],it=[],Ye=[],oe=xe-1,fe=0,Te=0,Ee=0,Xe=0;for(fe=0;fe<_e;++fe)if(it=[],Ee=fe+be,Ee>=_e&&(Ee-=_e),!He[Ee]){Ye=[];var ut=[];for(Te=Ee;Te>=0;){ut[Te]=!0,He[Te]=!0,it[it.length]=Te,Ye.push(ue[Te]);var ft=ye[Math.floor(Te*4/xe)];if(Xe=Te*4&oe,xe<4+Xe)throw new Error("FAT boundary crossed: "+Te+" 4 "+xe);if(!ue[ft]||(Te=Eh(ue[ft],Xe),ut[Te]))break}Se[Ee]={nodes:it,data:XF([Ye])}}return Se}function _(ue,be,ye,xe,_e,Se,He,it){for(var Ye=0,oe=xe.length?2:0,fe=be[ue].data,Te=0,Ee=0,Xe;Te<fe.length;Te+=128){var ut=fe.slice(Te,Te+128);Za(ut,64),Ee=ut.read_shift(2),Xe=o3(ut,0,Ee-oe),xe.push(Xe);var ft={name:Xe,type:ut.read_shift(1),color:ut.read_shift(1),L:ut.read_shift(4,"i"),R:ut.read_shift(4,"i"),C:ut.read_shift(4,"i"),clsid:ut.read_shift(16),state:ut.read_shift(4,"i"),start:0,size:0},Kt=ut.read_shift(2)+ut.read_shift(2)+ut.read_shift(2)+ut.read_shift(2);Kt!==0&&(ft.ct=N(ut,ut.l-8));var Ct=ut.read_shift(2)+ut.read_shift(2)+ut.read_shift(2)+ut.read_shift(2);Ct!==0&&(ft.mt=N(ut,ut.l-8)),ft.start=ut.read_shift(4,"i"),ft.size=ut.read_shift(4,"i"),ft.size<0&&ft.start<0&&(ft.size=ft.type=0,ft.start=Z,ft.name=""),ft.type===5?(Ye=ft.start,_e>0&&Ye!==Z&&(be[Ye].name="!StreamData")):ft.size>=4096?(ft.storage="fat",be[ft.start]===void 0&&(be[ft.start]=C(ye,ft.start,be.fat_addrs,be.ssz)),be[ft.start].name=ft.name,ft.content=be[ft.start].data.slice(0,ft.size)):(ft.storage="minifat",ft.size<0?ft.size=0:Ye!==Z&&ft.start!==Z&&be[Ye]&&(ft.content=v(ft,be[Ye].data,(be[it]||{}).data))),ft.content&&Za(ft.content,0),Se[Xe]=ft,He.push(ft)}}function N(ue,be){return new Date((Do(ue,be+4)/1e7*Math.pow(2,32)+Do(ue,be)/1e7-11644473600)*1e3)}function E(ue,be){return u(),d(l.readFileSync(ue),be)}function P(ue,be){var ye=be&&be.type;switch(ye||Yr&&Buffer.isBuffer(ue)&&(ye="buffer"),ye||"base64"){case"file":return E(ue,be);case"base64":return d(Io(Uo(ue)),be);case"binary":return d(Io(ue),be)}return d(ue,be)}function F(ue,be){var ye=be||{},xe=ye.root||"Root Entry";if(ue.FullPaths||(ue.FullPaths=[]),ue.FileIndex||(ue.FileIndex=[]),ue.FullPaths.length!==ue.FileIndex.length)throw new Error("inconsistent CFB structure");ue.FullPaths.length===0&&(ue.FullPaths[0]=xe+"/",ue.FileIndex[0]={name:xe,type:5}),ye.CLSID&&(ue.FileIndex[0].clsid=ye.CLSID),A(ue)}function A(ue){var be="Sh33tJ5";if(!Sr.find(ue,"/"+be)){var ye=_t(4);ye[0]=55,ye[1]=ye[3]=50,ye[2]=54,ue.FileIndex.push({name:be,type:2,content:ye,size:4,L:69,R:69,C:69}),ue.FullPaths.push(ue.FullPaths[0]+be),j(ue)}}function j(ue,be){F(ue);for(var ye=!1,xe=!1,_e=ue.FullPaths.length-1;_e>=0;--_e){var Se=ue.FileIndex[_e];switch(Se.type){case 0:xe?ye=!0:(ue.FileIndex.pop(),ue.FullPaths.pop());break;case 1:case 2:case 5:xe=!0,isNaN(Se.R*Se.L*Se.C)&&(ye=!0),Se.R>-1&&Se.L>-1&&Se.R==Se.L&&(ye=!0);break;default:ye=!0;break}}if(!(!ye&&!be)){var He=new Date(1987,1,19),it=0,Ye=Object.create?Object.create(null):{},oe=[];for(_e=0;_e<ue.FullPaths.length;++_e)Ye[ue.FullPaths[_e]]=!0,ue.FileIndex[_e].type!==0&&oe.push([ue.FullPaths[_e],ue.FileIndex[_e]]);for(_e=0;_e<oe.length;++_e){var fe=n(oe[_e][0]);xe=Ye[fe],xe||(oe.push([fe,{name:s(fe).replace("/",""),type:1,clsid:ne,ct:He,mt:He,content:null}]),Ye[fe]=!0)}for(oe.sort(function(Xe,ut){return r(Xe[0],ut[0])}),ue.FullPaths=[],ue.FileIndex=[],_e=0;_e<oe.length;++_e)ue.FullPaths[_e]=oe[_e][0],ue.FileIndex[_e]=oe[_e][1];for(_e=0;_e<oe.length;++_e){var Te=ue.FileIndex[_e],Ee=ue.FullPaths[_e];if(Te.name=s(Ee).replace("/",""),Te.L=Te.R=Te.C=-(Te.color=1),Te.size=Te.content?Te.content.length:0,Te.start=0,Te.clsid=Te.clsid||ne,_e===0)Te.C=oe.length>1?1:-1,Te.size=0,Te.type=5;else if(Ee.slice(-1)=="/"){for(it=_e+1;it<oe.length&&n(ue.FullPaths[it])!=Ee;++it);for(Te.C=it>=oe.length?-1:it,it=_e+1;it<oe.length&&n(ue.FullPaths[it])!=n(Ee);++it);Te.R=it>=oe.length?-1:it,Te.type=1}else n(ue.FullPaths[_e+1]||"")==n(Ee)&&(Te.R=_e+1),Te.type=2}}}function R(ue,be){var ye=be||{};if(ye.fileType=="mad")return Ft(ue,ye);switch(j(ue),ye.fileType){case"zip":return Fe(ue,ye)}var xe=(function(Xe){for(var ut=0,ft=0,Kt=0;Kt<Xe.FileIndex.length;++Kt){var Ct=Xe.FileIndex[Kt];if(Ct.content){var Ht=Ct.content.length;Ht>0&&(Ht<4096?ut+=Ht+63>>6:ft+=Ht+511>>9)}}for(var yr=Xe.FullPaths.length+3>>2,wr=ut+7>>3,vr=ut+127>>7,Er=wr+ft+yr+vr,qr=Er+127>>7,Hr=qr<=109?0:Math.ceil((qr-109)/127);Er+qr+Hr+127>>7>qr;)Hr=++qr<=109?0:Math.ceil((qr-109)/127);var he=[1,Hr,qr,vr,yr,ft,ut,0];return Xe.FileIndex[0].size=ut<<6,he[7]=(Xe.FileIndex[0].start=he[0]+he[1]+he[2]+he[3]+he[4]+he[5])+(he[6]+7>>3),he})(ue),_e=_t(xe[7]<<9),Se=0,He=0;{for(Se=0;Se<8;++Se)_e.write_shift(1,ee[Se]);for(Se=0;Se<8;++Se)_e.write_shift(2,0);for(_e.write_shift(2,62),_e.write_shift(2,3),_e.write_shift(2,65534),_e.write_shift(2,9),_e.write_shift(2,6),Se=0;Se<3;++Se)_e.write_shift(2,0);for(_e.write_shift(4,0),_e.write_shift(4,xe[2]),_e.write_shift(4,xe[0]+xe[1]+xe[2]+xe[3]-1),_e.write_shift(4,0),_e.write_shift(4,4096),_e.write_shift(4,xe[3]?xe[0]+xe[1]+xe[2]-1:Z),_e.write_shift(4,xe[3]),_e.write_shift(-4,xe[1]?xe[0]-1:Z),_e.write_shift(4,xe[1]),Se=0;Se<109;++Se)_e.write_shift(-4,Se<xe[2]?xe[1]+Se:-1)}if(xe[1])for(He=0;He<xe[1];++He){for(;Se<236+He*127;++Se)_e.write_shift(-4,Se<xe[2]?xe[1]+Se:-1);_e.write_shift(-4,He===xe[1]-1?Z:He+1)}var it=function(Xe){for(He+=Xe;Se<He-1;++Se)_e.write_shift(-4,Se+1);Xe&&(++Se,_e.write_shift(-4,Z))};for(He=Se=0,He+=xe[1];Se<He;++Se)_e.write_shift(-4,L.DIFSECT);for(He+=xe[2];Se<He;++Se)_e.write_shift(-4,L.FATSECT);it(xe[3]),it(xe[4]);for(var Ye=0,oe=0,fe=ue.FileIndex[0];Ye<ue.FileIndex.length;++Ye)fe=ue.FileIndex[Ye],fe.content&&(oe=fe.content.length,!(oe<4096)&&(fe.start=He,it(oe+511>>9)));for(it(xe[6]+7>>3);_e.l&511;)_e.write_shift(-4,L.ENDOFCHAIN);for(He=Se=0,Ye=0;Ye<ue.FileIndex.length;++Ye)fe=ue.FileIndex[Ye],fe.content&&(oe=fe.content.length,!(!oe||oe>=4096)&&(fe.start=He,it(oe+63>>6)));for(;_e.l&511;)_e.write_shift(-4,L.ENDOFCHAIN);for(Se=0;Se<xe[4]<<2;++Se){var Te=ue.FullPaths[Se];if(!Te||Te.length===0){for(Ye=0;Ye<17;++Ye)_e.write_shift(4,0);for(Ye=0;Ye<3;++Ye)_e.write_shift(4,-1);for(Ye=0;Ye<12;++Ye)_e.write_shift(4,0);continue}fe=ue.FileIndex[Se],Se===0&&(fe.start=fe.size?fe.start-1:Z);var Ee=Se===0&&ye.root||fe.name;if(oe=2*(Ee.length+1),_e.write_shift(64,Ee,"utf16le"),_e.write_shift(2,oe),_e.write_shift(1,fe.type),_e.write_shift(1,fe.color),_e.write_shift(-4,fe.L),_e.write_shift(-4,fe.R),_e.write_shift(-4,fe.C),fe.clsid)_e.write_shift(16,fe.clsid,"hex");else for(Ye=0;Ye<4;++Ye)_e.write_shift(4,0);_e.write_shift(4,fe.state||0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,fe.start),_e.write_shift(4,fe.size),_e.write_shift(4,0)}for(Se=1;Se<ue.FileIndex.length;++Se)if(fe=ue.FileIndex[Se],fe.size>=4096)if(_e.l=fe.start+1<<9,Yr&&Buffer.isBuffer(fe.content))fe.content.copy(_e,_e.l,0,fe.size),_e.l+=fe.size+511&-512;else{for(Ye=0;Ye<fe.size;++Ye)_e.write_shift(1,fe.content[Ye]);for(;Ye&511;++Ye)_e.write_shift(1,0)}for(Se=1;Se<ue.FileIndex.length;++Se)if(fe=ue.FileIndex[Se],fe.size>0&&fe.size<4096)if(Yr&&Buffer.isBuffer(fe.content))fe.content.copy(_e,_e.l,0,fe.size),_e.l+=fe.size+63&-64;else{for(Ye=0;Ye<fe.size;++Ye)_e.write_shift(1,fe.content[Ye]);for(;Ye&63;++Ye)_e.write_shift(1,0)}if(Yr)_e.l=_e.length;else for(;_e.l<_e.length;)_e.write_shift(1,0);return _e}function U(ue,be){var ye=ue.FullPaths.map(function(Ye){return Ye.toUpperCase()}),xe=ye.map(function(Ye){var oe=Ye.split("/");return oe[oe.length-(Ye.slice(-1)=="/"?2:1)]}),_e=!1;be.charCodeAt(0)===47?(_e=!0,be=ye[0].slice(0,-1)+be):_e=be.indexOf("/")!==-1;var Se=be.toUpperCase(),He=_e===!0?ye.indexOf(Se):xe.indexOf(Se);if(He!==-1)return ue.FileIndex[He];var it=!Se.match(ly);for(Se=Se.replace(Yi,""),it&&(Se=Se.replace(ly,"!")),He=0;He<ye.length;++He)if((it?ye[He].replace(ly,"!"):ye[He]).replace(Yi,"")==Se||(it?xe[He].replace(ly,"!"):xe[He]).replace(Yi,"")==Se)return ue.FileIndex[He];return null}var Y=64,Z=-2,ae="d0cf11e0a1b11ae1",ee=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",L={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Z,FREESECT:-1,HEADER_SIGNATURE:ae,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function H(ue,be,ye){u();var xe=R(ue,ye);l.writeFileSync(be,xe)}function M(ue){for(var be=new Array(ue.length),ye=0;ye<ue.length;++ye)be[ye]=String.fromCharCode(ue[ye]);return be.join("")}function V(ue,be){var ye=R(ue,be);switch(be&&be.type||"buffer"){case"file":return u(),l.writeFileSync(be.filename,ye),ye;case"binary":return typeof ye=="string"?ye:M(ye);case"base64":return Jy(typeof ye=="string"?ye:M(ye));case"buffer":if(Yr)return Buffer.isBuffer(ye)?ye:id(ye);case"array":return typeof ye=="string"?Io(ye):ye}return ye}var W;function I(ue){try{var be=ue.InflateRaw,ye=new be;if(ye._processChunk(new Uint8Array([3,0]),ye._finishFlushFlag),ye.bytesRead)W=ue;else throw new Error("zlib does not expose bytesRead")}catch(xe){console.error("cannot use native zlib: "+(xe.message||xe))}}function B(ue,be){if(!W)return or(ue,be);var ye=W.InflateRaw,xe=new ye,_e=xe._processChunk(ue.slice(ue.l),xe._finishFlushFlag);return ue.l+=xe.bytesRead,_e}function q(ue){return W?W.deflateRawSync(ue):We(ue)}var J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],X=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(ue){var be=(ue<<1|ue<<11)&139536|(ue<<5|ue<<15)&558144;return(be>>16|be>>8|be)&255}for(var le=typeof Uint8Array<"u",ce=le?new Uint8Array(256):[],ke=0;ke<256;++ke)ce[ke]=ie(ke);function re(ue,be){var ye=ce[ue&255];return be<=8?ye>>>8-be:(ye=ye<<8|ce[ue>>8&255],be<=16?ye>>>16-be:(ye=ye<<8|ce[ue>>16&255],ye>>>24-be))}function ge(ue,be){var ye=be&7,xe=be>>>3;return(ue[xe]|(ye<=6?0:ue[xe+1]<<8))>>>ye&3}function Ne(ue,be){var ye=be&7,xe=be>>>3;return(ue[xe]|(ye<=5?0:ue[xe+1]<<8))>>>ye&7}function je(ue,be){var ye=be&7,xe=be>>>3;return(ue[xe]|(ye<=4?0:ue[xe+1]<<8))>>>ye&15}function Ke(ue,be){var ye=be&7,xe=be>>>3;return(ue[xe]|(ye<=3?0:ue[xe+1]<<8))>>>ye&31}function Ue(ue,be){var ye=be&7,xe=be>>>3;return(ue[xe]|(ye<=1?0:ue[xe+1]<<8))>>>ye&127}function It(ue,be,ye){var xe=be&7,_e=be>>>3,Se=(1<<ye)-1,He=ue[_e]>>>xe;return ye<8-xe||(He|=ue[_e+1]<<8-xe,ye<16-xe)||(He|=ue[_e+2]<<16-xe,ye<24-xe)||(He|=ue[_e+3]<<24-xe),He&Se}function rt(ue,be,ye){var xe=be&7,_e=be>>>3;return xe<=5?ue[_e]|=(ye&7)<<xe:(ue[_e]|=ye<<xe&255,ue[_e+1]=(ye&7)>>8-xe),be+3}function wt(ue,be,ye){var xe=be&7,_e=be>>>3;return ye=(ye&1)<<xe,ue[_e]|=ye,be+1}function xt(ue,be,ye){var xe=be&7,_e=be>>>3;return ye<<=xe,ue[_e]|=ye&255,ye>>>=8,ue[_e+1]=ye,be+8}function lt(ue,be,ye){var xe=be&7,_e=be>>>3;return ye<<=xe,ue[_e]|=ye&255,ye>>>=8,ue[_e+1]=ye&255,ue[_e+2]=ye>>>8,be+16}function pt(ue,be){var ye=ue.length,xe=2*ye>be?2*ye:be+5,_e=0;if(ye>=be)return ue;if(Yr){var Se=PF(xe);if(ue.copy)ue.copy(Se);else for(;_e<ue.length;++_e)Se[_e]=ue[_e];return Se}else if(le){var He=new Uint8Array(xe);if(He.set)He.set(ue);else for(;_e<ye;++_e)He[_e]=ue[_e];return He}return ue.length=xe,ue}function Rt(ue){for(var be=new Array(ue),ye=0;ye<ue;++ye)be[ye]=0;return be}function Mt(ue,be,ye){var xe=1,_e=0,Se=0,He=0,it=0,Ye=ue.length,oe=le?new Uint16Array(32):Rt(32);for(Se=0;Se<32;++Se)oe[Se]=0;for(Se=Ye;Se<ye;++Se)ue[Se]=0;Ye=ue.length;var fe=le?new Uint16Array(Ye):Rt(Ye);for(Se=0;Se<Ye;++Se)oe[_e=ue[Se]]++,xe<_e&&(xe=_e),fe[Se]=0;for(oe[0]=0,Se=1;Se<=xe;++Se)oe[Se+16]=it=it+oe[Se-1]<<1;for(Se=0;Se<Ye;++Se)it=ue[Se],it!=0&&(fe[Se]=oe[it+16]++);var Te=0;for(Se=0;Se<Ye;++Se)if(Te=ue[Se],Te!=0)for(it=re(fe[Se],xe)>>xe-Te,He=(1<<xe+4-Te)-1;He>=0;--He)be[it|He<<Te]=Te&15|Se<<4;return xe}var Qe=le?new Uint16Array(512):Rt(512),Re=le?new Uint16Array(32):Rt(32);if(!le){for(var Be=0;Be<512;++Be)Qe[Be]=0;for(Be=0;Be<32;++Be)Re[Be]=0}(function(){for(var ue=[],be=0;be<32;be++)ue.push(5);Mt(ue,Re,32);var ye=[];for(be=0;be<=143;be++)ye.push(8);for(;be<=255;be++)ye.push(9);for(;be<=279;be++)ye.push(7);for(;be<=287;be++)ye.push(8);Mt(ye,Qe,288)})();var ct=(function(){for(var be=le?new Uint8Array(32768):[],ye=0,xe=0;ye<X.length-1;++ye)for(;xe<X[ye+1];++xe)be[xe]=ye;for(;xe<32768;++xe)be[xe]=29;var _e=le?new Uint8Array(259):[];for(ye=0,xe=0;ye<se.length-1;++ye)for(;xe<se[ye+1];++xe)_e[xe]=ye;function Se(it,Ye){for(var oe=0;oe<it.length;){var fe=Math.min(65535,it.length-oe),Te=oe+fe==it.length;for(Ye.write_shift(1,+Te),Ye.write_shift(2,fe),Ye.write_shift(2,~fe&65535);fe-- >0;)Ye[Ye.l++]=it[oe++]}return Ye.l}function He(it,Ye){for(var oe=0,fe=0,Te=le?new Uint16Array(32768):[];fe<it.length;){var Ee=Math.min(65535,it.length-fe);if(Ee<10){for(oe=rt(Ye,oe,+(fe+Ee==it.length)),oe&7&&(oe+=8-(oe&7)),Ye.l=oe/8|0,Ye.write_shift(2,Ee),Ye.write_shift(2,~Ee&65535);Ee-- >0;)Ye[Ye.l++]=it[fe++];oe=Ye.l*8;continue}oe=rt(Ye,oe,+(fe+Ee==it.length)+2);for(var Xe=0;Ee-- >0;){var ut=it[fe];Xe=(Xe<<5^ut)&32767;var ft=-1,Kt=0;if((ft=Te[Xe])&&(ft|=fe&-32768,ft>fe&&(ft-=32768),ft<fe))for(;it[ft+Kt]==it[fe+Kt]&&Kt<250;)++Kt;if(Kt>2){ut=_e[Kt],ut<=22?oe=xt(Ye,oe,ce[ut+1]>>1)-1:(xt(Ye,oe,3),oe+=5,xt(Ye,oe,ce[ut-23]>>5),oe+=3);var Ct=ut<8?0:ut-4>>2;Ct>0&&(lt(Ye,oe,Kt-se[ut]),oe+=Ct),ut=be[fe-ft],oe=xt(Ye,oe,ce[ut]>>3),oe-=3;var Ht=ut<4?0:ut-2>>1;Ht>0&&(lt(Ye,oe,fe-ft-X[ut]),oe+=Ht);for(var yr=0;yr<Kt;++yr)Te[Xe]=fe&32767,Xe=(Xe<<5^it[fe])&32767,++fe;Ee-=Kt-1}else ut<=143?ut=ut+48:oe=wt(Ye,oe,1),oe=xt(Ye,oe,ce[ut]),Te[Xe]=fe&32767,++fe}oe=xt(Ye,oe,0)-1}return Ye.l=(oe+7)/8|0,Ye.l}return function(Ye,oe){return Ye.length<8?Se(Ye,oe):He(Ye,oe)}})();function We(ue){var be=_t(50+Math.floor(ue.length*1.1)),ye=ct(ue,be);return be.slice(0,ye)}var nt=le?new Uint16Array(32768):Rt(32768),Tt=le?new Uint16Array(32768):Rt(32768),jt=le?new Uint16Array(128):Rt(128),Vt=1,fr=1;function Dr(ue,be){var ye=Ke(ue,be)+257;be+=5;var xe=Ke(ue,be)+1;be+=5;var _e=je(ue,be)+4;be+=4;for(var Se=0,He=le?new Uint8Array(19):Rt(19),it=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ye=1,oe=le?new Uint8Array(8):Rt(8),fe=le?new Uint8Array(8):Rt(8),Te=He.length,Ee=0;Ee<_e;++Ee)He[J[Ee]]=Se=Ne(ue,be),Ye<Se&&(Ye=Se),oe[Se]++,be+=3;var Xe=0;for(oe[0]=0,Ee=1;Ee<=Ye;++Ee)fe[Ee]=Xe=Xe+oe[Ee-1]<<1;for(Ee=0;Ee<Te;++Ee)(Xe=He[Ee])!=0&&(it[Ee]=fe[Xe]++);var ut=0;for(Ee=0;Ee<Te;++Ee)if(ut=He[Ee],ut!=0){Xe=ce[it[Ee]]>>8-ut;for(var ft=(1<<7-ut)-1;ft>=0;--ft)jt[Xe|ft<<ut]=ut&7|Ee<<3}var Kt=[];for(Ye=1;Kt.length<ye+xe;)switch(Xe=jt[Ue(ue,be)],be+=Xe&7,Xe>>>=3){case 16:for(Se=3+ge(ue,be),be+=2,Xe=Kt[Kt.length-1];Se-- >0;)Kt.push(Xe);break;case 17:for(Se=3+Ne(ue,be),be+=3;Se-- >0;)Kt.push(0);break;case 18:for(Se=11+Ue(ue,be),be+=7;Se-- >0;)Kt.push(0);break;default:Kt.push(Xe),Ye<Xe&&(Ye=Xe);break}var Ct=Kt.slice(0,ye),Ht=Kt.slice(ye);for(Ee=ye;Ee<286;++Ee)Ct[Ee]=0;for(Ee=xe;Ee<30;++Ee)Ht[Ee]=0;return Vt=Mt(Ct,nt,286),fr=Mt(Ht,Tt,30),be}function zr(ue,be){if(ue[0]==3&&!(ue[1]&3))return[Sf(be),2];for(var ye=0,xe=0,_e=PF(be||1<<18),Se=0,He=_e.length>>>0,it=0,Ye=0;(xe&1)==0;){if(xe=Ne(ue,ye),ye+=3,xe>>>1)xe>>1==1?(it=9,Ye=5):(ye=Dr(ue,ye),it=Vt,Ye=fr);else{ye&7&&(ye+=8-(ye&7));var oe=ue[ye>>>3]|ue[(ye>>>3)+1]<<8;if(ye+=32,oe>0)for(!be&&He<Se+oe&&(_e=pt(_e,Se+oe),He=_e.length);oe-- >0;)_e[Se++]=ue[ye>>>3],ye+=8;continue}for(;;){!be&&He<Se+32767&&(_e=pt(_e,Se+32767),He=_e.length);var fe=It(ue,ye,it),Te=xe>>>1==1?Qe[fe]:nt[fe];if(ye+=Te&15,Te>>>=4,(Te>>>8&255)===0)_e[Se++]=Te;else{if(Te==256)break;Te-=257;var Ee=Te<8?0:Te-4>>2;Ee>5&&(Ee=0);var Xe=Se+se[Te];Ee>0&&(Xe+=It(ue,ye,Ee),ye+=Ee),fe=It(ue,ye,Ye),Te=xe>>>1==1?Re[fe]:Tt[fe],ye+=Te&15,Te>>>=4;var ut=Te<4?0:Te-2>>1,ft=X[Te];for(ut>0&&(ft+=It(ue,ye,ut),ye+=ut),!be&&He<Xe&&(_e=pt(_e,Xe+100),He=_e.length);Se<Xe;)_e[Se]=_e[Se-ft],++Se}}}return be?[_e,ye+7>>>3]:[_e.slice(0,Se),ye+7>>>3]}function or(ue,be){var ye=ue.slice(ue.l||0),xe=zr(ye,be);return ue.l+=xe[1],xe[0]}function nr(ue,be){if(ue)typeof console<"u"&&console.error(be);else throw new Error(be)}function me(ue,be){var ye=ue;Za(ye,0);var xe=[],_e=[],Se={FileIndex:xe,FullPaths:_e};F(Se,{root:be.root});for(var He=ye.length-4;(ye[He]!=80||ye[He+1]!=75||ye[He+2]!=5||ye[He+3]!=6)&&He>=0;)--He;ye.l=He+4,ye.l+=4;var it=ye.read_shift(2);ye.l+=6;var Ye=ye.read_shift(4);for(ye.l=Ye,He=0;He<it;++He){ye.l+=20;var oe=ye.read_shift(4),fe=ye.read_shift(4),Te=ye.read_shift(2),Ee=ye.read_shift(2),Xe=ye.read_shift(2);ye.l+=8;var ut=ye.read_shift(4),ft=o(ye.slice(ye.l+Te,ye.l+Te+Ee));ye.l+=Te+Ee+Xe;var Kt=ye.l;ye.l=ut+4,Ae(ye,oe,fe,Se,ft),ye.l=Kt}return Se}function Ae(ue,be,ye,xe,_e){ue.l+=2;var Se=ue.read_shift(2),He=ue.read_shift(2),it=i(ue);if(Se&8257)throw new Error("Unsupported ZIP encryption");for(var Ye=ue.read_shift(4),oe=ue.read_shift(4),fe=ue.read_shift(4),Te=ue.read_shift(2),Ee=ue.read_shift(2),Xe="",ut=0;ut<Te;++ut)Xe+=String.fromCharCode(ue[ue.l++]);if(Ee){var ft=o(ue.slice(ue.l,ue.l+Ee));(ft[21589]||{}).mt&&(it=ft[21589].mt),((_e||{})[21589]||{}).mt&&(it=_e[21589].mt)}ue.l+=Ee;var Kt=ue.slice(ue.l,ue.l+oe);switch(He){case 8:Kt=B(ue,fe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+He)}var Ct=!1;Se&8&&(Ye=ue.read_shift(4),Ye==134695760&&(Ye=ue.read_shift(4),Ct=!0),oe=ue.read_shift(4),fe=ue.read_shift(4)),oe!=be&&nr(Ct,"Bad compressed size: "+be+" != "+oe),fe!=ye&&nr(Ct,"Bad uncompressed size: "+ye+" != "+fe),er(xe,Xe,Kt,{unsafe:!0,mt:it})}function Fe(ue,be){var ye=be||{},xe=[],_e=[],Se=_t(1),He=ye.compression?8:0,it=0,Ye=0,oe=0,fe=0,Te=0,Ee=ue.FullPaths[0],Xe=Ee,ut=ue.FileIndex[0],ft=[],Kt=0;for(Ye=1;Ye<ue.FullPaths.length;++Ye)if(Xe=ue.FullPaths[Ye].slice(Ee.length),ut=ue.FileIndex[Ye],!(!ut.size||!ut.content||Xe=="Sh33tJ5")){var Ct=fe,Ht=_t(Xe.length);for(oe=0;oe<Xe.length;++oe)Ht.write_shift(1,Xe.charCodeAt(oe)&127);Ht=Ht.slice(0,Ht.l),ft[Te]=Gie.buf(ut.content,0);var yr=ut.content;He==8&&(yr=q(yr)),Se=_t(30),Se.write_shift(4,67324752),Se.write_shift(2,20),Se.write_shift(2,it),Se.write_shift(2,He),ut.mt?a(Se,ut.mt):Se.write_shift(4,0),Se.write_shift(-4,ft[Te]),Se.write_shift(4,yr.length),Se.write_shift(4,ut.content.length),Se.write_shift(2,Ht.length),Se.write_shift(2,0),fe+=Se.length,xe.push(Se),fe+=Ht.length,xe.push(Ht),fe+=yr.length,xe.push(yr),Se=_t(46),Se.write_shift(4,33639248),Se.write_shift(2,0),Se.write_shift(2,20),Se.write_shift(2,it),Se.write_shift(2,He),Se.write_shift(4,0),Se.write_shift(-4,ft[Te]),Se.write_shift(4,yr.length),Se.write_shift(4,ut.content.length),Se.write_shift(2,Ht.length),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(4,0),Se.write_shift(4,Ct),Kt+=Se.l,_e.push(Se),Kt+=Ht.length,_e.push(Ht),++Te}return Se=_t(22),Se.write_shift(4,101010256),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,Te),Se.write_shift(2,Te),Se.write_shift(4,Kt),Se.write_shift(4,fe),Se.write_shift(2,0),ja([ja(xe),ja(_e),Se])}var Me={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function kt(ue,be){if(ue.ctype)return ue.ctype;var ye=ue.name||"",xe=ye.match(/\.([^\.]+)$/);return xe&&Me[xe[1]]||be&&(xe=(ye=be).match(/[\.\\]([^\.\\])+$/),xe&&Me[xe[1]])?Me[xe[1]]:"application/octet-stream"}function Oe(ue){for(var be=Jy(ue),ye=[],xe=0;xe<be.length;xe+=76)ye.push(be.slice(xe,xe+76));return ye.join(`\r
`)+`\r
`}function at(ue){var be=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var fe=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(fe.length==1?"0"+fe:fe)});be=be.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),be.charAt(0)==`
`&&(be="=0D"+be.slice(1)),be=be.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ye=[],xe=be.split(`\r
`),_e=0;_e<xe.length;++_e){var Se=xe[_e];if(Se.length==0){ye.push("");continue}for(var He=0;He<Se.length;){var it=76,Ye=Se.slice(He,He+it);Ye.charAt(it-1)=="="?it--:Ye.charAt(it-2)=="="?it-=2:Ye.charAt(it-3)=="="&&(it-=3),Ye=Se.slice(He,He+it),He+=it,He<Se.length&&(Ye+="="),ye.push(Ye)}}return ye.join(`\r
`)}function Ce(ue){for(var be=[],ye=0;ye<ue.length;++ye){for(var xe=ue[ye];ye<=ue.length&&xe.charAt(xe.length-1)=="=";)xe=xe.slice(0,xe.length-1)+ue[++ye];be.push(xe)}for(var _e=0;_e<be.length;++_e)be[_e]=be[_e].replace(/[=][0-9A-Fa-f]{2}/g,function(Se){return String.fromCharCode(parseInt(Se.slice(1),16))});return Io(be.join(`\r
`))}function Ve(ue,be,ye){for(var xe="",_e="",Se="",He,it=0;it<10;++it){var Ye=be[it];if(!Ye||Ye.match(/^\s*$/))break;var oe=Ye.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":xe=oe[2].trim();break;case"content-type":Se=oe[2].trim();break;case"content-transfer-encoding":_e=oe[2].trim();break}}switch(++it,_e.toLowerCase()){case"base64":He=Io(Uo(be.slice(it).join("")));break;case"quoted-printable":He=Ce(be.slice(it));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+_e)}var fe=er(ue,xe.slice(ye.length),He,{unsafe:!0});Se&&(fe.ctype=Se)}function Ze(ue,be){if(M(ue.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ye=be&&be.root||"",xe=(Yr&&Buffer.isBuffer(ue)?ue.toString("binary"):M(ue)).split(`\r
`),_e=0,Se="";for(_e=0;_e<xe.length;++_e)if(Se=xe[_e],!!/^Content-Location:/i.test(Se)&&(Se=Se.slice(Se.indexOf("file")),ye||(ye=Se.slice(0,Se.lastIndexOf("/")+1)),Se.slice(0,ye.length)!=ye))for(;ye.length>0&&(ye=ye.slice(0,ye.length-1),ye=ye.slice(0,ye.lastIndexOf("/")+1),Se.slice(0,ye.length)!=ye););var He=(xe[1]||"").match(/boundary="(.*?)"/);if(!He)throw new Error("MAD cannot find boundary");var it="--"+(He[1]||""),Ye=[],oe=[],fe={FileIndex:Ye,FullPaths:oe};F(fe);var Te,Ee=0;for(_e=0;_e<xe.length;++_e){var Xe=xe[_e];Xe!==it&&Xe!==it+"--"||(Ee++&&Ve(fe,xe.slice(Te,_e),ye),Te=_e)}return fe}function Ft(ue,be){var ye=be||{},xe=ye.boundary||"SheetJS";xe="------="+xe;for(var _e=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+xe.slice(2)+'"',"","",""],Se=ue.FullPaths[0],He=Se,it=ue.FileIndex[0],Ye=1;Ye<ue.FullPaths.length;++Ye)if(He=ue.FullPaths[Ye].slice(Se.length),it=ue.FileIndex[Ye],!(!it.size||!it.content||He=="Sh33tJ5")){He=He.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Kt){return"_x"+Kt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Kt){return"_u"+Kt.charCodeAt(0).toString(16)+"_"});for(var oe=it.content,fe=Yr&&Buffer.isBuffer(oe)?oe.toString("binary"):M(oe),Te=0,Ee=Math.min(1024,fe.length),Xe=0,ut=0;ut<=Ee;++ut)(Xe=fe.charCodeAt(ut))>=32&&Xe<128&&++Te;var ft=Te>=Ee*4/5;_e.push(xe),_e.push("Content-Location: "+(ye.root||"file:///C:/SheetJS/")+He),_e.push("Content-Transfer-Encoding: "+(ft?"quoted-printable":"base64")),_e.push("Content-Type: "+kt(it,He)),_e.push(""),_e.push(ft?at(fe):Oe(fe))}return _e.push(xe+`--\r
`),_e.join(`\r
`)}function zt(ue){var be={};return F(be,ue),be}function er(ue,be,ye,xe){var _e=xe&&xe.unsafe;_e||F(ue);var Se=!_e&&Sr.find(ue,be);if(!Se){var He=ue.FullPaths[0];be.slice(0,He.length)==He?He=be:(He.slice(-1)!="/"&&(He+="/"),He=(He+be).replace("//","/")),Se={name:s(be),type:2},ue.FileIndex.push(Se),ue.FullPaths.push(He),_e||Sr.utils.cfb_gc(ue)}return Se.content=ye,Se.size=ye?ye.length:0,xe&&(xe.CLSID&&(Se.clsid=xe.CLSID),xe.mt&&(Se.mt=xe.mt),xe.ct&&(Se.ct=xe.ct)),Se}function hr(ue,be){F(ue);var ye=Sr.find(ue,be);if(ye){for(var xe=0;xe<ue.FileIndex.length;++xe)if(ue.FileIndex[xe]==ye)return ue.FileIndex.splice(xe,1),ue.FullPaths.splice(xe,1),!0}return!1}function ir(ue,be,ye){F(ue);var xe=Sr.find(ue,be);if(xe){for(var _e=0;_e<ue.FileIndex.length;++_e)if(ue.FileIndex[_e]==xe)return ue.FileIndex[_e].name=s(ye),ue.FullPaths[_e]=ye,!0}return!1}function Wr(ue){j(ue,!0)}return t.find=U,t.read=P,t.parse=d,t.write=V,t.writeFile=H,t.utils={cfb_new:zt,cfb_add:er,cfb_del:hr,cfb_mov:ir,cfb_gc:Wr,ReadShift:_y,CheckField:C$,prep_blob:Za,bconcat:ja,use_zlib:I,_deflateRaw:We,_inflateRaw:or,consts:L},t})();function Vie(e){return typeof e=="string"?s2(e):Array.isArray(e)?yie(e):e}function zv(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=s2(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Uc(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([Vie(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Rf(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Kie(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function As(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function BF(e,t){for(var r=[],n=As(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function i2(e){for(var t=[],r=As(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function o2(e){for(var t=[],r=As(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function qie(e){for(var t=[],r=As(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Ub=new Date(1899,11,30,0,0,0);function ma(e,t){var r=e.getTime(),n=Ub.getTime()+(e.getTimezoneOffset()-Ub.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var s$=new Date,Yie=Ub.getTime()+(s$.getTimezoneOffset()-Ub.getTimezoneOffset())*6e4,$F=s$.getTimezoneOffset();function l2(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Yie),t.getTimezoneOffset()!==$F&&t.setTime(t.getTime()+(t.getTimezoneOffset()-$F)*6e4),t}function Xie(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var UF=new Date("2017-02-19T19:06:09.000Z"),a$=isNaN(UF.getFullYear())?new Date("2/19/17"):UF,Jie=a$.getFullYear()==2017;function Yn(e,t){var r=new Date(e);if(Jie)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(a$.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function d0(e,t){if(Yr&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Uc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Uc(VB(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Uc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Uc(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Xn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Xn(e[r]));return t}function Cs(e,t){for(var r="";r.length<t;)r+=e;return r}function nc(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var Qie=["january","february","march","april","may","june","july","august","september","october","november","december"];function Sm(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Qie.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Zie=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}})();function i$(e){return e?e.content&&e.type?d0(e.content,!0):e.data?oy(e.data):e.asNodeBuffer&&Yr?oy(e.asNodeBuffer().toString("binary")):e.asBinary?oy(e.asBinary()):e._data&&e._data.getContent?oy(d0(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function o$(e){if(!e)return null;if(e.data)return AF(e.data);if(e.asNodeBuffer&&Yr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?AF(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function eoe(e){return e&&e.name.slice(-4)===".bin"?o$(e):i$(e)}function hl(e,t){for(var r=e.FullPaths||As(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function t3(e,t){var r=hl(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Xs(e,t,r){if(!r)return eoe(t3(e,t));if(!t)return null;try{return Xs(e,t)}catch{return null}}function Mo(e,t,r){if(!r)return i$(t3(e,t));if(!t)return null;try{return Mo(e,t)}catch{return null}}function toe(e,t,r){return o$(t3(e,t))}function zF(e){for(var t=e.FullPaths||As(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Kr(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Yr?n=id(r):n=vie(r),Sr.utils.cfb_add(e,t,n)}Sr.utils.cfb_add(e,t,r)}else e.file(t,r)}function r3(){return Sr.utils.cfb_new()}function l$(e,t){switch(t.type){case"base64":return Sr.read(e,{type:"base64"});case"binary":return Sr.read(e,{type:"binary"});case"buffer":case"array":return Sr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function cy(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Ws=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,roe=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,WF=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,noe=/<[^>]*>/g,Ai=Ws.match(WF)?WF:noe,soe=/<\w*:/,aoe=/<(\/?)\w+:/;function Or(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(roe),o=0,l="",u=0,d="",h="",g=1;if(i)for(u=0;u!=i.length;++u){for(h=i[u],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(d=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(g=(s=h.charCodeAt(a+1))==34||s==39?1:0,l=h.slice(a+1+g,h.length-g),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,n[d.toLowerCase()]=l;else{var p=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[p]&&d.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Zc(e){return e.replace(aoe,"<$1")}var c$={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},n3=i2(c$),un=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,l){return c$[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}})(),s3=/[&<>'"]/g,ioe=/[\u0000-\u0008\u000b-\u001f]/g;function Nn(e){var t=e+"";return t.replace(s3,function(r){return n3[r]}).replace(ioe,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function HF(e){return Nn(e).replace(/ /g,"_x0020_")}var u$=/[\u0000-\u001f]/g;function a3(e){var t=e+"";return t.replace(s3,function(r){return n3[r]}).replace(/\n/g,"<br/>").replace(u$,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function ooe(e){var t=e+"";return t.replace(s3,function(r){return n3[r]}).replace(u$,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var GF=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function loe(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Vn(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function vk(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function VF(e){var t=Sf(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function KF(e){return id(e,"binary").toString("utf8")}var Cw="foo bar baz",Dn=Yr&&(KF(Cw)==vk(Cw)&&KF||VF(Cw)==vk(Cw)&&VF)||vk,Uc=Yr?function(e){return id(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Zy=(function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),d$=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}})(),coe=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),uoe=/<\/?(?:vt:)?variant>/g,doe=/<(?:vt:)([^>]*)>([\s\S]*)</;function qF(e,t){var r=Or(e),n=e.match(coe(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(uoe,"").match(doe);i&&s.push({v:Dn(i[2]),t:i[1]})}),s}var f$=/(^\s|\s$|\n)/;function ri(e,t){return"<"+e+(t.match(f$)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ev(e){return As(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function qt(e,t,r){return"<"+e+(r!=null?ev(r):"")+(t!=null?(t.match(f$)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function dE(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function foe(e,t){switch(typeof e){case"string":var r=qt("vt:lpwstr",Nn(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return qt((e|0)==e?"vt:i4":"vt:r8",Nn(String(e)));case"boolean":return qt("vt:bool",e?"true":"false")}if(e instanceof Date)return qt("vt:filetime",dE(e));throw new Error("Unable to serialize "+e)}function i3(e){if(Yr&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Dn(Rf(Q4(e)));throw new Error("Bad input format: expected Buffer or string")}var tv=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ha={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},T0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Oo={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function hoe(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function goe(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var YF=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},XF=Yr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:id(t)})):YF(e)}:YF,JF=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Bu(e,s)));return n.join("").replace(Yi,"")},o3=Yr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Yi,""):JF(e,t,r)}:JF,QF=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},h$=Yr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):QF(e,t,r)}:QF,ZF=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Wg(e,s)));return n.join("")},Wv=Yr?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):ZF(t,r,n)}:ZF,g$=function(e,t){var r=Do(e,t);return r>0?Wv(e,t+4,t+4+r-1):""},m$=g$,p$=function(e,t){var r=Do(e,t);return r>0?Wv(e,t+4,t+4+r-1):""},x$=p$,y$=function(e,t){var r=2*Do(e,t);return r>0?Wv(e,t+4,t+4+r-1):""},v$=y$,w$=function(t,r){var n=Do(t,r);return n>0?o3(t,r+4,r+4+n):""},b$=w$,_$=function(e,t){var r=Do(e,t);return r>0?Wv(e,t+4,t+4+r):""},S$=_$,k$=function(e,t){return hoe(e,t)},zb=k$,l3=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Yr&&(m$=function(t,r){if(!Buffer.isBuffer(t))return g$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},x$=function(t,r){if(!Buffer.isBuffer(t))return p$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},v$=function(t,r){if(!Buffer.isBuffer(t))return y$(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},b$=function(t,r){if(!Buffer.isBuffer(t))return w$(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},S$=function(t,r){if(!Buffer.isBuffer(t))return _$(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},zb=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):k$(t,r)},l3=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Wg=function(e,t){return e[t]},Bu=function(e,t){return e[t+1]*256+e[t]},moe=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Do=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Eh=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},poe=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function _y(e,t){var r="",n,s,a=[],i,o,l,u;switch(t){case"dbcs":if(u=this.l,Yr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Bu(this,u)),u+=2;e*=2;break;case"utf8":r=Wv(this,this.l,this.l+e);break;case"utf16le":e*=2,r=o3(this,this.l,this.l+e);break;case"wstr":return _y.call(this,e,"dbcs");case"lpstr-ansi":r=m$(this,this.l),e=4+Do(this,this.l);break;case"lpstr-cp":r=x$(this,this.l),e=4+Do(this,this.l);break;case"lpwstr":r=v$(this,this.l),e=4+2*Do(this,this.l);break;case"lpp4":e=4+Do(this,this.l),r=b$(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Do(this,this.l),r=S$(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Wg(this,this.l+e++))!==0;)a.push(kw(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=Bu(this,this.l+e))!==0;)a.push(kw(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Wg(this,u),this.l=u+1,o=_y.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(kw(Bu(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Wg(this,u),this.l=u+1,o=_y.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(kw(Wg(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=Wg(this,this.l),this.l++,n;case 2:return n=(t==="i"?moe:Bu)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Eh:poe)(this,this.l),this.l+=4,n):(s=Do(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=zb(this,this.l):s=zb([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=h$(this,this.l,e);break}}return this.l+=e,r}var xoe=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},yoe=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},voe=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function woe(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)voe(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,xoe(this,t,this.l);break;case 8:if(n=8,r==="f"){goe(this,t,this.l);break}case 16:break;case-4:n=4,yoe(this,t,this.l);break}return this.l+=n,this}function C$(e,t){var r=h$(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Za(e,t){e.l=t,e.read_shift=_y,e.chk=C$,e.write_shift=woe}function Ni(e,t){e.l+=t}function _t(e){var t=Sf(e);return Za(t,0),t}function od(e,t,r){if(e){var n,s,a;Za(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=ov[o]||ov[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;l=e.l+a;var d=u.f&&u.f(e,a,r);if(e.l=l,t(d,u,o))return}}}function xo(){var e=[],t=Yr?256:2048,r=function(u){var d=_t(u);return Za(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},i=function(){return s(),ja(e)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function Ot(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=ov[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&l3(r)&&e.push(r)}}function Sy(e,t,r){var n=Xn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function eO(e,t,r){var n=Xn(e);return n.s=Sy(n.s,t.s,r),n.e=Sy(n.e,t.s,r),n}function ky(e,t){if(e.cRel&&e.c<0)for(e=Xn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Xn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Pr(e);return!e.cRel&&e.cRel!=null&&(r=Soe(r)),!e.rRel&&e.rRel!=null&&(r=boe(r)),r}function wk(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+fs(e.s.c)+":"+(e.e.cRel?"":"$")+fs(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Us(e.s.r)+":"+(e.e.rRel?"":"$")+Us(e.e.r):ky(e.s,t.biff)+":"+ky(e.e,t.biff)}function c3(e){return parseInt(_oe(e),10)-1}function Us(e){return""+(e+1)}function boe(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function _oe(e){return e.replace(/\$(\d+)$/,"$1")}function u3(e){for(var t=koe(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function fs(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Soe(e){return e.replace(/^([A-Z])/,"$$$1")}function koe(e){return e.replace(/^\$([A-Z])/,"$1")}function Coe(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function hs(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Pr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function yo(e){var t=e.indexOf(":");return t==-1?{s:hs(e),e:hs(e)}:{s:hs(e.slice(0,t)),e:hs(e.slice(t+1))}}function Vr(e,t){return typeof t>"u"||typeof t=="number"?Vr(e.s,e.e):(typeof e!="string"&&(e=Pr(e)),typeof t!="string"&&(t=Pr(t)),e==t?e:e+":"+t)}function dn(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function tO(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=kl(e.z,r?ma(t):t)}catch{}try{return e.w=kl((e.XF||{}).numFmtId||(r?14:0),r?ma(t):t)}catch{return""+t}}function Zu(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ld[e.v]||e.v:t==null?tO(e,e.v):tO(e,t))}function If(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function T$(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?hs(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=dn(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[h].length;++g)if(!(typeof t[h][g]>"u")){var p={v:t[h][g]},x=i+h,v=o+g;if(u.s.r>x&&(u.s.r=x),u.s.c>v&&(u.s.c=v),u.e.r<x&&(u.e.r=x),u.e.c<v&&(u.e.c=v),t[h][g]&&typeof t[h][g]=="object"&&!Array.isArray(t[h][g])&&!(t[h][g]instanceof Date))p=t[h][g];else if(Array.isArray(p.v)&&(p.f=t[h][g][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Ar[14],n.cellDates?(p.t="d",p.w=kl(p.z,ma(p.v))):(p.t="n",p.v=ma(p.v),p.w=kl(p.z,p.v))):p.t="s";if(s)a[x]||(a[x]=[]),a[x][v]&&a[x][v].z&&(p.z=a[x][v].z),a[x][v]=p;else{var w=Pr({c:v,r:x});a[w]&&a[w].z&&(p.z=a[w].z),a[w]=p}}}return u.s.c<1e7&&(a["!ref"]=Vr(u)),a}function Qm(e,t){return T$(null,e,t)}function Toe(e){return e.read_shift(4,"i")}function sc(e,t){return t||(t=_t(4)),t.write_shift(4,e),t}function Ti(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Fa(e,t){var r=!1;return t==null&&(r=!0,t=_t(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Eoe(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Noe(e,t){return t||(t=_t(4)),t.write_shift(2,0),t.write_shift(2,0),t}function d3(e,t){var r=e.l,n=e.read_shift(1),s=Ti(e),a=[],i={t:s,h:s};if((n&1)!==0){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(Eoe(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function Aoe(e,t){var r=!1;return t==null&&(r=!0,t=_t(15+4*e.t.length)),t.write_shift(1,0),Fa(e.t,t),r?t.slice(0,t.l):t}var joe=d3;function Poe(e,t){var r=!1;return t==null&&(r=!0,t=_t(23+4*e.t.length)),t.write_shift(1,1),Fa(e.t,t),t.write_shift(4,1),Noe({},t),r?t.slice(0,t.l):t}function Al(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function E0(e,t){return t==null&&(t=_t(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function N0(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function A0(e,t){return t==null&&(t=_t(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Foe=Ti,E$=Fa;function f3(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Wb(e,t){var r=!1;return t==null&&(r=!0,t=_t(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Ooe=Ti,fE=f3,h3=Wb;function g3(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?zb([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Eh(t,0)>>2;return r?s/100:s}function N$(e,t){t==null&&(t=_t(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function A$(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Doe(e,t){return t||(t=_t(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var j0=A$,Zm=Doe;function _i(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function f0(e,t){return(t||_t(8)).write_shift(8,e,"f")}function Roe(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=zh[s];u&&(t.rgb=nv(u));break;case 2:t.rgb=nv([i,o,l]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Hb(e,t){if(t||(t=_t(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Ioe(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Moe(e,t){t||(t=_t(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function j$(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Loe(e){return j$(e,1)}function Boe(e){return j$(e,2)}var m3=2,co=3,Tw=11,rO=12,Gb=19,Ew=64,$oe=65,Uoe=71,zoe=4108,Woe=4126,Ta=80,P$=81,Hoe=[Ta,P$],hE={1:{n:"CodePage",t:m3},2:{n:"Category",t:Ta},3:{n:"PresentationFormat",t:Ta},4:{n:"ByteCount",t:co},5:{n:"LineCount",t:co},6:{n:"ParagraphCount",t:co},7:{n:"SlideCount",t:co},8:{n:"NoteCount",t:co},9:{n:"HiddenCount",t:co},10:{n:"MultimediaClipCount",t:co},11:{n:"ScaleCrop",t:Tw},12:{n:"HeadingPairs",t:zoe},13:{n:"TitlesOfParts",t:Woe},14:{n:"Manager",t:Ta},15:{n:"Company",t:Ta},16:{n:"LinksUpToDate",t:Tw},17:{n:"CharacterCount",t:co},19:{n:"SharedDoc",t:Tw},22:{n:"HyperlinksChanged",t:Tw},23:{n:"AppVersion",t:co,p:"version"},24:{n:"DigSig",t:$oe},26:{n:"ContentType",t:Ta},27:{n:"ContentStatus",t:Ta},28:{n:"Language",t:Ta},29:{n:"Version",t:Ta},255:{},2147483648:{n:"Locale",t:Gb},2147483651:{n:"Behavior",t:Gb},1919054434:{}},gE={1:{n:"CodePage",t:m3},2:{n:"Title",t:Ta},3:{n:"Subject",t:Ta},4:{n:"Author",t:Ta},5:{n:"Keywords",t:Ta},6:{n:"Comments",t:Ta},7:{n:"Template",t:Ta},8:{n:"LastAuthor",t:Ta},9:{n:"RevNumber",t:Ta},10:{n:"EditTime",t:Ew},11:{n:"LastPrinted",t:Ew},12:{n:"CreatedDate",t:Ew},13:{n:"ModifiedDate",t:Ew},14:{n:"PageCount",t:co},15:{n:"WordCount",t:co},16:{n:"CharCount",t:co},17:{n:"Thumbnail",t:Uoe},18:{n:"Application",t:Ta},19:{n:"DocSecurity",t:co},255:{},2147483648:{n:"Locale",t:Gb},2147483651:{n:"Behavior",t:Gb},1919054434:{}},nO={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Goe=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Voe(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Koe=Voe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),zh=Xn(Koe),ld={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},F$={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},mE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Nw={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function p3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function qoe(e){var t=p3();if(!e||!e.match)return t;var r={};if((e.match(Ai)||[]).forEach(function(n){var s=Or(n);switch(s[0].replace(soe,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[mE[s.ContentType]]!==void 0&&t[mE[s.ContentType]].push(s.PartName);break}}),t.xmlns!==ha.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function O$(e,t){var r=qie(mE),n=[],s;n[n.length]=Ws,n[n.length]=qt("Types",null,{xmlns:ha.CT,"xmlns:xsd":ha.xsd,"xmlns:xsi":ha.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return qt("Default",null,{Extension:l[0],ContentType:l[1]})}));var a=function(l){e[l]&&e[l].length>0&&(s=e[l][0],n[n.length]=qt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Nw[l][t.bookType]||Nw[l].xlsx}))},i=function(l){(e[l]||[]).forEach(function(u){n[n.length]=qt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Nw[l][t.bookType]||Nw[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(u){n[n.length]=qt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var en={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function rv(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Cy(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Ai)||[]).forEach(function(s){var a=Or(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:cy(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function cm(e){var t=[Ws,qt("Relationships",null,{xmlns:ha.RELS})];return As(e["!id"]).forEach(function(r){t[t.length]=qt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Tn(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[en.HLINK,en.XPATH,en.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var Yoe="application/vnd.oasis.opendocument.spreadsheet";function Xoe(e,t){for(var r=i3(e),n,s;n=tv.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Or(n[0],!1),s.path=="/"&&s.type!==Yoe)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function Joe(e){var t=[Ws];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function sO(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Qoe(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Zoe(e){var t=[Ws];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(sO(e[r][0],e[r][1])),t.push(Qoe("",e[r][0]));return t.push(sO("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function D$(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Mb.version+"</meta:generator></office:meta></office:document-meta>"}var bl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ele=(function(){for(var e=new Array(bl.length),t=0;t<bl.length;++t){var r=bl[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function R$(e){var t={};e=Dn(e);for(var r=0;r<bl.length;++r){var n=bl[r],s=e.match(ele[r]);s!=null&&s.length>0&&(t[n[1]]=un(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Yn(t[n[1]]))}return t}function bk(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Nn(t),n[n.length]=r?qt(e,t,r):ri(e,t))}function I$(e,t){var r=t||{},n=[Ws,qt("cp:coreProperties",null,{"xmlns:cp":ha.CORE_PROPS,"xmlns:dc":ha.dc,"xmlns:dcterms":ha.dcterms,"xmlns:dcmitype":ha.dcmitype,"xmlns:xsi":ha.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&bk("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:dE(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&bk("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:dE(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=bl.length;++a){var i=bl[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&bk(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Wh=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],M$=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function L$(e,t,r,n){var s=[];if(typeof e=="string")s=qF(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(d){return{v:d}}));var i=typeof t=="string"?qF(t,n).map(function(d){return d.v}):t,o=0,l=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(l=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function tle(e,t,r){var n={};return t||(t={}),e=Dn(e),Wh.forEach(function(s){var a=(e.match(Zy(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=un(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&L$(n.HeadingPairs,n.TitlesOfParts,t,r),t}function B$(e){var t=[],r=qt;return e||(e={}),e.Application="SheetJS",t[t.length]=Ws,t[t.length]=qt("Properties",null,{xmlns:ha.EXT_PROPS,"xmlns:vt":ha.vt}),Wh.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Nn(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Nn(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var rle=/<[^>]+>[^<]*/g;function nle(e,t){var r={},n="",s=e.match(rle);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Or(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=un(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),u=l[0].slice(4),d=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=un(d);break;case"bool":r[n]=Vn(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Yn(d);break;case"cy":case"error":r[n]=un(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function $$(e){var t=[Ws,qt("Properties",null,{xmlns:ha.CUST_PROPS,"xmlns:vt":ha.vt})];if(!e)return t.join("");var r=1;return As(e).forEach(function(s){++r,t[t.length]=qt("property",foe(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Nn(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var pE={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},_k;function sle(e,t,r){_k||(_k=i2(pE)),t=_k[t]||t,e[t]=r}function ale(e,t){var r=[];return As(pE).map(function(n){for(var s=0;s<bl.length;++s)if(bl[s][1]==n)return bl[s];for(s=0;s<Wh.length;++s)if(Wh[s][1]==n)return Wh[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(ri(pE[n[1]]||n[1],s))}}),qt("DocumentProperties",r.join(""),{xmlns:Oo.o})}function ile(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&As(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<bl.length;++i)if(a==bl[i][1])return;for(i=0;i<Wh.length;++i)if(a==Wh[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),s.push(qt(HF(a),o,{"dt:dt":l}))}}),t&&As(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(qt(HF(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Oo.o+'">'+s.join("")+"</"+n+">"}function x3(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function ole(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=_t(8);return i.write_shift(4,n),i.write_shift(4,s),i}function U$(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function z$(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function W$(e,t,r){return t===31?z$(e):U$(e,t,r)}function xE(e,t,r){return W$(e,t,r===!1?0:4)}function lle(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return W$(e,t,0)}function cle(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Yi,""),e.l-s&2&&(e.l+=2)}return r}function ule(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Yi,"");return r}function dle(e){var t=e.l,r=Vb(e,P$);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Vb(e,co);return[r,n]}function fle(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(dle(e));return r}function aO(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Yi,"").replace(ly,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function H$(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function hle(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Vb(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==rO&&n!==t&&Hoe.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===rO?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return U$(e,n,4).replace(Yi,"");case 31:return z$(e);case 64:return x3(e);case 65:return H$(e);case 71:return hle(e);case 80:return xE(e,n,!a.raw).replace(Yi,"");case 81:return lle(e,n).replace(Yi,"");case 4108:return fle(e);case 4126:case 4127:return n==4127?cle(e):ule(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function iO(e,t){var r=_t(4),n=_t(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=_t(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=ole(t);break;case 31:case 80:for(n=_t(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ja([r,n])}function oO(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,l=-1,u={};for(i=0;i!=s;++i){var d=e.read_shift(4),h=e.read_shift(4);a[i]=[d,h+r]}a.sort(function(k,_){return k[1]-_[1]});var g={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var p=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(p=!1,e.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[a[i][0]];if(g[x.n]=Vb(e,x.t,{raw:!0}),x.p==="version"&&(g[x.n]=String(g[x.n]>>16)+"."+("0000"+String(g[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(g[x.n]){case 0:g[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ec(o=g[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[x.n])}}else if(a[i][0]===1){if(o=g.CodePage=Vb(e,m3),ec(o),l!==-1){var v=e.l;e.l=a[l][1],u=aO(e,o),e.l=v}}else if(a[i][0]===0){if(o===0){l=i,e.l=a[i+1][1];continue}u=aO(e,o)}else{var w=u[a[i][0]],C;switch(e[e.l]){case 65:e.l+=4,C=H$(e);break;case 30:e.l+=4,C=xE(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,C=xE(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,C=e.read_shift(4,"i");break;case 19:e.l+=4,C=e.read_shift(4);break;case 5:e.l+=4,C=e.read_shift(8,"f");break;case 11:e.l+=4,C=Ls(e,4);break;case 64:e.l+=4,C=Yn(x3(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[w]=C}}return e.l=r+n,g}var G$=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function gle(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function lO(e,t,r){var n=_t(8),s=[],a=[],i=8,o=0,l=_t(8),u=_t(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),a.push(l),s.push(u),i+=8+l.length,!t){u=_t(8),u.write_shift(4,0),s.unshift(u);var d=[_t(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(l=_t(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=ja(d),a.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(G$.indexOf(e[o][0])>-1||M$.indexOf(e[o][0])>-1)&&e[o][1]!=null){var g=e[o][1],p=0;if(t){p=+t[e[o][0]];var x=r[p];if(x.p=="version"&&typeof g=="string"){var v=g.split(".");g=(+v[0]<<16)+(+v[1]||0)}l=iO(x.t,g)}else{var w=gle(g);w==-1&&(w=31,g=String(g)),l=iO(w,g)}a.push(l),u=_t(8),u.write_shift(4,t?p:2+o),s.push(u),i+=8+l.length}var C=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,C),C+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),ja([n].concat(s).concat(a))}function cO(e,t,r){var n=e.content;if(!n)return{};Za(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==Sr.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var h=oO(n,t),g={SystemIdentifier:u};for(var p in h)g[p]=h[p];if(g.FMTID=a,s===1)return g;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=oO(n,null)}catch{}for(p in x)g[p]=x[p];return g.FMTID=[a,i],g}function uO(e,t,r,n,s,a){var i=_t(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Sr.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var l=lO(e,r,n);if(o.push(l),s){var u=lO(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+l.length),o.push(u)}return ja(o)}function ef(e,t){return e.read_shift(t),null}function mle(e,t){t||(t=_t(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function ple(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Ls(e,t){return e.read_shift(t)===1}function Wi(e,t){return t||(t=_t(2)),t.write_shift(2,+!!e),t}function Js(e){return e.read_shift(2,"u")}function gl(e,t){return t||(t=_t(2)),t.write_shift(2,e),t}function V$(e,t){return ple(e,t,Js)}function xle(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function K$(e,t,r){return r||(r=_t(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Hv(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function yle(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*i),n&&(e.l+=o),l.t=d,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function vle(e){var t=e.t||"",r=_t(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=_t(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return ja(s)}function h0(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Gv(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):h0(e,n,r)}function P0(e,t,r){if(r.biff>5)return Gv(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function q$(e,t,r){return r||(r=_t(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function wle(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function ble(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Yi,"");return n&&(e.l+=24),s}function _le(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Yi,"");return r+i}function Sle(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return ble(e);case"0303000000000000c000000000000046":return _le(e);default:throw new Error("Unsupported Moniker "+r)}}function Aw(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Yi,""):"";return r}function dO(e,t){t||(t=_t(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function kle(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,l,u="",d,h;s&16&&(a=Aw(e,r-e.l)),s&128&&(i=Aw(e,r-e.l)),(s&257)===257&&(o=Aw(e,r-e.l)),(s&257)===1&&(l=Sle(e,r-e.l)),s&8&&(u=Aw(e,r-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(h=x3(e)),e.l=r;var g=i||o||l||"";g&&u&&(g+="#"+u),g||(g="#"+u),s&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var p={Target:g};return d&&(p.guid=d),h&&(p.time=h),a&&(p.Tooltip=a),p}function Cle(e){var t=_t(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),dO(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&dO(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Y$(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function X$(e,t){var r=Y$(e);return r[3]=0,r}function eu(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function g0(e,t,r,n){return n||(n=_t(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Tle(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Ele(e,t,r){return t===0?"":P0(e,t,r)}function Nle(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function J$(e){var t=e.read_shift(2),r=g3(e);return[t,r]}function Ale(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=Hv(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function c2(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function Q$(e,t){return t||(t=_t(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Z$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var jle=Z$;function eU(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Ple(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Fle(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function mi(e){e.l+=2,e.l+=e.read_shift(2)}var Ole={0:mi,4:mi,5:mi,6:mi,7:Fle,8:mi,9:mi,10:mi,11:mi,12:mi,13:Ple,14:mi,15:mi,16:mi,17:mi,18:mi,19:mi,20:mi,21:eU};function Dle(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(Ole[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function jw(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function y3(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=_t(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function Rle(e,t){return t===0||e.read_shift(2),1200}function Ile(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=P0(e,0,r);return e.read_shift(t+n-e.l),s}function Mle(e,t){var r=!t||t.biff==8,n=_t(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Lle(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Ble(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Hv(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function $le(e,t){var r=!t||t.biff>=8?2:1,n=_t(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function Ule(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(yle(e));return a.Count=n,a.Unique=s,a}function zle(e,t){var r=_t(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=vle(e[s]);var a=ja([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function Wle(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Hle(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Gle(e){var t=Tle(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Vle(e){return e.read_shift(2),e.read_shift(4)}function fO(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function Kle(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:u}}function qle(){var e=_t(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Yle(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Xle(e){var t=_t(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Jle(){}function Qle(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Hv(e,0,r),n}function Zle(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=_t(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function ece(e){var t=eu(e);return t.isst=e.read_shift(4),t}function tce(e,t,r,n){var s=_t(10);return g0(e,t,n,s),s.write_shift(4,r),s}function rce(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=eu(e);r.biff==2&&e.l++;var a=Gv(e,n-e.l,r);return s.val=a,s}function nce(e,t,r,n,s){var a=!s||s.biff==8,i=_t(8+ +a+(1+a)*r.length);return g0(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function sce(e,t,r){var n=e.read_shift(2),s=P0(e,0,r);return[n,s]}function ace(e,t,r,n){var s=r&&r.biff==5;n||(n=_t(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var ice=P0;function hO(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function oce(e,t){var r=t.biff==8||!t.biff?4:2,n=_t(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function lce(e){var t=e.read_shift(2),r=e.read_shift(2),n=J$(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function cce(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(J$(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function uce(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function dce(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return s.patternType=Goe[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function fce(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=dce(e,t,n.fStyle,r),n}function gO(e,t,r,n){var s=r&&r.biff==5;n||(n=_t(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function hce(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function gce(e){var t=_t(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function mO(e,t,r){var n=eu(e);(r.biff==2||t==9)&&++e.l;var s=xle(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function mce(e,t,r,n,s,a){var i=_t(8);return g0(e,t,n,i),K$(r,a,i),i}function pce(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=eu(e),s=_i(e);return n.val=s,n}function xce(e,t,r,n){var s=_t(14);return g0(e,t,n,s),f0(r,s),s}var pO=Ele;function yce(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=h0(e,a),o=[];n>e.l;)o.push(Gv(e));return[a,s,i,o]}function xO(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=Ale(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var vce=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function yO(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=h0(e,i,r);s&32&&(u=vce[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var h=n==e.l||o===0||!(d>0)?[]:Dhe(e,d,r,o);return{chKey:a,Name:u,itab:l,rgce:h}}function tU(e,t,r){if(r.biff<8)return wce(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(Nle(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function wce(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Hv(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function bce(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=h0(e,n,r),i=h0(e,s,r);return[a,i]}function _ce(e,t,r){var n=Z$(e);e.l++;var s=e.read_shift(1);return t-=8,[Rhe(e,t,r),s,n]}function vO(e,t,r){var n=jle(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Fhe(e,t,r)]}function Sce(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function kce(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=P0(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function Cce(e,t,r){return kce(e,t,r)}function Tce(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(c2(e));return r}function Ece(e){var t=_t(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Q$(e[r],t);return t}function Nce(e,t,r){if(r&&r.biff<8)return jce(e,t,r);var n=eU(e),s=Dle(e,t-22,n[1]);return{cmo:n,ft:s}}var Ace={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function jce(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Ace[n]||Ni)(e,t,r)),{cmo:[s,n,a],ft:i}}function Pce(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=wle(e,6,r);var o=e.read_shift(2);e.read_shift(2),Js(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],h=h0(e,e.lens[u+1]-e.lens[u]-1);if(s+=h,s.length>=(d?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function Fce(e,t){var r=c2(e);e.l+=16;var n=kle(e,t-24);return[r,n]}function Oce(e){var t=_t(24),r=hs(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return ja([t,Cle(e[1])])}function Dce(e,t){e.read_shift(2);var r=c2(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Yi,""),[r,n]}function Rce(e){var t=e[1].Tooltip,r=_t(10+2*(t.length+1));r.write_shift(2,2048);var n=hs(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function Ice(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=nO[r]||r,r=e.read_shift(2),t[1]=nO[r]||r,t}function Mce(e){return e||(e=_t(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Lce(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(X$(e));return r}function Bce(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(X$(e));return r}function $ce(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function rU(e,t,r){if(!r.cellStyles)return Ni(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function Uce(e,t){var r=_t(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function zce(e,t){var r={};return t<32||(e.l+=16,r.header=_i(e),r.footer=_i(e),e.l+=2),r}function Wce(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function Hce(e){for(var t=_t(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Gce=eu,Vce=V$,Kce=Gv;function qce(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function Yce(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=eu(e);++e.l;var s=P0(e,t-7,r);return n.t="str",n.val=s,n}function Xce(e){var t=eu(e);++e.l;var r=_i(e);return t.t="n",t.val=r,t}function Jce(e,t,r){var n=_t(15);return Yv(n,e,t),n.write_shift(8,r,"f"),n}function Qce(e){var t=eu(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Zce(e,t,r){var n=_t(9);return Yv(n,e,t),n.write_shift(2,r),n}function eue(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function tue(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function rue(e,t,r){var n=e.l+t,s=eu(e),a=e.read_shift(2),i=h0(e,a,r);return e.l=n,s.t="str",s.val=i,s}var nue=[2,3,48,49,131,139,140,245],yE=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=i2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],d=Sf(1);switch(l.type){case"base64":d=Io(Uo(o));break;case"binary":d=Io(o);break;case"buffer":case"array":d=o;break}Za(d,0);var h=d.read_shift(1),g=!!(h&136),p=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,g=!0;break;case 49:p=!0,g=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var v=0,w=521;h==2&&(v=d.read_shift(2)),d.l+=3,h!=2&&(v=d.read_shift(4)),v>1048576&&(v=1e6),h!=2&&(w=d.read_shift(2));var C=d.read_shift(2),k=l.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(k=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var _=[],N={},E=Math.min(d.length,h==2?521:w-10-(p?264:0)),P=x?32:11;d.l<E&&d[d.l]!=13;)switch(N={},N.name=Xy.utils.decode(k,d.slice(d.l,d.l+P)).replace(/[\u0000\r\n].*$/g,""),d.l+=P,N.type=String.fromCharCode(d.read_shift(1)),h!=2&&!x&&(N.offset=d.read_shift(4)),N.len=d.read_shift(1),h==2&&(N.offset=d.read_shift(2)),N.dec=d.read_shift(1),N.name.length&&_.push(N),h!=2&&(d.l+=x?13:14),N.type){case"B":(!p||N.len!=8)&&l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var F=0,A=0;for(u[0]=[],A=0;A!=_.length;++A)u[0][A]=_[A].name;for(;v-- >0;){if(d[d.l]===42){d.l+=C;continue}for(++d.l,u[++F]=[],A=0,A=0;A!=_.length;++A){var j=d.slice(d.l,d.l+_[A].len);d.l+=_[A].len,Za(j,0);var R=Xy.utils.decode(k,j);switch(_[A].type){case"C":R.trim().length&&(u[F][A]=R.replace(/\s+$/,""));break;case"D":R.length===8?u[F][A]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):u[F][A]=R;break;case"F":u[F][A]=parseFloat(R.trim());break;case"+":case"I":u[F][A]=x?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":u[F][A]=!0;break;case"N":case"F":u[F][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[F][A]="##MEMO##"+(x?parseInt(R.trim(),10):j.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(u[F][A]=+R||0);break;case"@":u[F][A]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":u[F][A]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":u[F][A]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[F][A]=-j.read_shift(-8,"f");break;case"B":if(p&&_[A].len==8){u[F][A]=j.read_shift(8,"f");break}case"G":case"P":j.l+=_[A].len;break;case"0":if(_[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[A].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=_,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Qm(r(o,u),u);return d["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,d}function s(o,l){try{return If(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var u=l||{};if(+u.codepage>=0&&ec(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=xo(),h=Yb(o,{header:1,raw:!0,cellDates:!0}),g=h[0],p=h.slice(1),x=o["!cols"]||[],v=0,w=0,C=0,k=1;for(v=0;v<g.length;++v){if(((x[v]||{}).DBF||{}).name){g[v]=x[v].DBF.name,++C;continue}if(g[v]!=null){if(++C,typeof g[v]=="number"&&(g[v]=g[v].toString(10)),typeof g[v]!="string")throw new Error("DBF Invalid column name "+g[v]+" |"+typeof g[v]+"|");if(g.indexOf(g[v])!==v){for(w=0;w<1024;++w)if(g.indexOf(g[v]+"_"+w)==-1){g[v]+="_"+w;break}}}}var _=dn(o["!ref"]),N=[],E=[],P=[];for(v=0;v<=_.e.c-_.s.c;++v){var F="",A="",j=0,R=[];for(w=0;w<p.length;++w)p[w][v]!=null&&R.push(p[w][v]);if(R.length==0||g[v]==null){N[v]="?";continue}for(w=0;w<R.length;++w){switch(typeof R[w]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=R[w]instanceof Date?"D":"C";break;default:A="C"}j=Math.max(j,String(R[w]).length),F=F&&F!=A?"C":A}j>250&&(j=250),A=((x[v]||{}).DBF||{}).type,A=="C"&&x[v].DBF.len>j&&(j=x[v].DBF.len),F=="B"&&A=="N"&&(F="N",P[v]=x[v].DBF.dec,j=x[v].DBF.len),E[v]=F=="C"||A=="N"?j:a[F]||0,k+=E[v],N[v]=F}var U=d.next(32);for(U.write_shift(4,318902576),U.write_shift(4,p.length),U.write_shift(2,296+32*C),U.write_shift(2,k),v=0;v<4;++v)U.write_shift(4,0);for(U.write_shift(4,0|(+t[GB]||3)<<8),v=0,w=0;v<g.length;++v)if(g[v]!=null){var Y=d.next(32),Z=(g[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Y.write_shift(1,Z,"sbcs"),Y.write_shift(1,N[v]=="?"?"C":N[v],"sbcs"),Y.write_shift(4,w),Y.write_shift(1,E[v]||a[N[v]]||0),Y.write_shift(1,P[v]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),w+=E[v]||a[N[v]]||0}var ae=d.next(264);for(ae.write_shift(4,13),v=0;v<65;++v)ae.write_shift(4,0);for(v=0;v<p.length;++v){var ee=d.next(k);for(ee.write_shift(1,0),w=0;w<g.length;++w)if(g[w]!=null)switch(N[w]){case"L":ee.write_shift(1,p[v][w]==null?63:p[v][w]?84:70);break;case"B":ee.write_shift(8,p[v][w]||0,"f");break;case"N":var ne="0";for(typeof p[v][w]=="number"&&(ne=p[v][w].toFixed(P[w]||0)),C=0;C<E[w]-ne.length;++C)ee.write_shift(1,32);ee.write_shift(1,ne,"sbcs");break;case"D":p[v][w]?(ee.write_shift(4,("0000"+p[v][w].getFullYear()).slice(-4),"sbcs"),ee.write_shift(2,("00"+(p[v][w].getMonth()+1)).slice(-2),"sbcs"),ee.write_shift(2,("00"+p[v][w].getDate()).slice(-2),"sbcs")):ee.write_shift(8,"00000000","sbcs");break;case"C":var L=String(p[v][w]!=null?p[v][w]:"").slice(0,E[w]);for(ee.write_shift(1,L,"sbcs"),C=0;C<E[w]-L.length;++C)ee.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}})(),nU=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+As(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,p){var x=e[p];return typeof x=="number"?jF(x):x},n=function(g,p,x){var v=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return v==59?g:jF(v)};e["|"]=254;function s(g,p){switch(p.type){case"base64":return a(Uo(g),p);case"binary":return a(g,p);case"buffer":return a(Yr&&Buffer.isBuffer(g)?g.toString("binary"):Rf(g),p);case"array":return a(d0(g),p)}throw new Error("Unrecognized type "+p.type)}function a(g,p){var x=g.split(/[\n\r]+/),v=-1,w=-1,C=0,k=0,_=[],N=[],E=null,P={},F=[],A=[],j=[],R=0,U;for(+p.codepage>=0&&ec(+p.codepage);C!==x.length;++C){R=0;var Y=x[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Z=Y.replace(/;;/g,"\0").split(";").map(function(J){return J.replace(/\u0000/g,";")}),ae=Z[0],ee;if(Y.length>0)switch(ae){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Z[1].charAt(0)=="P"&&N.push(Y.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,L=!1,H=!1,M=!1,V=-1,W=-1;for(k=1;k<Z.length;++k)switch(Z[k].charAt(0)){case"A":break;case"X":w=parseInt(Z[k].slice(1))-1,L=!0;break;case"Y":for(v=parseInt(Z[k].slice(1))-1,L||(w=0),U=_.length;U<=v;++U)_[U]=[];break;case"K":ee=Z[k].slice(1),ee.charAt(0)==='"'?ee=ee.slice(1,ee.length-1):ee==="TRUE"?ee=!0:ee==="FALSE"?ee=!1:isNaN(nc(ee))?isNaN(Sm(ee).getDate())||(ee=Yn(ee)):(ee=nc(ee),E!==null&&Xm(E)&&(ee=l2(ee))),ne=!0;break;case"E":M=!0;var I=um(Z[k].slice(1),{r:v,c:w});_[v][w]=[_[v][w],I];break;case"S":H=!0,_[v][w]=[_[v][w],"S5S"];break;case"G":break;case"R":V=parseInt(Z[k].slice(1))-1;break;case"C":W=parseInt(Z[k].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+Y)}if(ne&&(_[v][w]&&_[v][w].length==2?_[v][w][0]=ee:_[v][w]=ee,E=null),H){if(M)throw new Error("SYLK shared formula cannot have own formula");var B=V>-1&&_[V][W];if(!B||!B[1])throw new Error("SYLK shared formula cannot find base");_[v][w][1]=bU(B[1],{r:v-V,c:w-W})}break;case"F":var q=0;for(k=1;k<Z.length;++k)switch(Z[k].charAt(0)){case"X":w=parseInt(Z[k].slice(1))-1,++q;break;case"Y":for(v=parseInt(Z[k].slice(1))-1,U=_.length;U<=v;++U)_[U]=[];break;case"M":R=parseInt(Z[k].slice(1))/20;break;case"F":break;case"G":break;case"P":E=N[parseInt(Z[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=Z[k].slice(1).split(" "),U=parseInt(j[0],10);U<=parseInt(j[1],10);++U)R=parseInt(j[2],10),A[U-1]=R===0?{hidden:!0}:{wch:R},kf(A[U-1]);break;case"C":w=parseInt(Z[k].slice(1))-1,A[w]||(A[w]={});break;case"R":v=parseInt(Z[k].slice(1))-1,F[v]||(F[v]={}),R>0?(F[v].hpt=R,F[v].hpx=Cm(R)):R===0&&(F[v].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+Y)}q<1&&(E=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+Y)}}return F.length>0&&(P["!rows"]=F),A.length>0&&(P["!cols"]=A),p&&p.sheetRows&&(_=_.slice(0,p.sheetRows)),[_,P]}function i(g,p){var x=s(g,p),v=x[0],w=x[1],C=Qm(v,p);return As(w).forEach(function(k){C[k]=w[k]}),C}function o(g,p){return If(i(g,p),p)}function l(g,p,x,v){var w="C;Y"+(x+1)+";X"+(v+1)+";K";switch(g.t){case"n":w+=g.v||0,g.f&&!g.F&&(w+=";E"+k3(g.f,{r:x,c:v}));break;case"b":w+=g.v?"TRUE":"FALSE";break;case"e":w+=g.w||g.v;break;case"d":w+='"'+(g.w||g.v)+'"';break;case"s":w+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(g,p){p.forEach(function(x,v){var w="F;W"+(v+1)+" "+(v+1)+" ";x.hidden?w+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=sv(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=av(x.wpx)),typeof x.wch=="number"&&(w+=Math.round(x.wch))),w.charAt(w.length-1)!=" "&&g.push(w)})}function d(g,p){p.forEach(function(x,v){var w="F;";x.hidden?w+="M0;":x.hpt?w+="M"+20*x.hpt+";":x.hpx&&(w+="M"+20*iv(x.hpx)+";"),w.length>2&&g.push(w+"R"+(v+1))})}function h(g,p){var x=["ID;PWXL;N;E"],v=[],w=dn(g["!ref"]),C,k=Array.isArray(g),_=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),g["!cols"]&&u(x,g["!cols"]),g["!rows"]&&d(x,g["!rows"]),x.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var E=w.s.c;E<=w.e.c;++E){var P=Pr({r:N,c:E});C=k?(g[N]||[])[E]:g[P],!(!C||C.v==null&&(!C.f||C.F))&&v.push(l(C,g,N,E))}return x.join(_)+_+v.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:i,from_sheet:h}})(),sU=(function(){function e(a,i){switch(i.type){case"base64":return t(Uo(a),i);case"binary":return t(a,i);case"buffer":return t(Yr&&Buffer.isBuffer(a)?a.toString("binary"):Rf(a),i);case"array":return t(d0(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),l=-1,u=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++l]=[],u=0;continue}if(!(l<0)){var g=o[d].trim().split(","),p=g[0],x=g[1];++d;for(var v=o[d]||"";(v.match(/["]/g)||[]).length&1&&d<o.length-1;)v+=`
`+o[++d];switch(v=v.trim(),+p){case-1:if(v==="BOT"){h[++l]=[],u=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?h[l][u]=!0:v==="FALSE"?h[l][u]=!1:isNaN(nc(x))?isNaN(Sm(x).getDate())?h[l][u]=x:h[l][u]=Yn(x):h[l][u]=nc(x),++u;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),h[l][u++]=v!==""?v:null;break}if(v==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function r(a,i){return Qm(e(a,i),i)}function n(a,i){return If(r(a,i),i)}var s=(function(){var a=function(l,u,d,h,g){l.push(u),l.push(d+","+h),l.push('"'+g.replace(/"/g,'""')+'"')},i=function(l,u,d,h){l.push(u+","+d),l.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var u=[],d=dn(l["!ref"]),h,g=Array.isArray(l);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){i(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var v=Pr({r:p,c:x});if(h=g?(l[p]||[])[x]:l[v],!h){i(u,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?i(u,1,0,"="+h.f):i(u,1,0,""):i(u,0,w,"V");break;case"b":i(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=kl(h.z||Ar[14],ma(Yn(h.v)))),i(u,0,h.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var C=`\r
`,k=u.join(C);return k}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),aU=(function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,g){for(var p=h.split(`
`),x=-1,v=-1,w=0,C=[];w!==p.length;++w){var k=p[w].trim().split(":");if(k[0]==="cell"){var _=hs(k[1]);if(C.length<=_.r)for(x=C.length;x<=_.r;++x)C[x]||(C[x]=[]);switch(x=_.r,v=_.c,k[2]){case"t":C[x][v]=e(k[3]);break;case"v":C[x][v]=+k[3];break;case"vtf":var N=k[k.length-1];case"vtc":switch(k[3]){case"nl":C[x][v]=!!+k[4];break;default:C[x][v]=+k[4];break}k[2]=="vtf"&&(C[x][v]=[C[x][v],N])}}}return g&&g.sheetRows&&(C=C.slice(0,g.sheetRows)),C}function n(h,g){return Qm(r(h,g),g)}function s(h,g){return If(n(h,g),g)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var g=[],p=[],x,v="",w=yo(h["!ref"]),C=Array.isArray(h),k=w.s.r;k<=w.e.r;++k)for(var _=w.s.c;_<=w.e.c;++_)if(v=Pr({r:k,c:_}),x=C?(h[k]||[])[_]:h[v],!(!x||x.v==null||x.t==="z")){switch(p=["cell",v,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var N=ma(Yn(x.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=x.w||kl(x.z||Ar[14],N);break;case"e":continue}g.push(p.join(":"))}return g.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(h){return[a,i,o,i,u(h),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}})(),km=(function(){function e(d,h,g,p,x){x.raw?h[g][p]=d:d===""||(d==="TRUE"?h[g][p]=!0:d==="FALSE"?h[g][p]=!1:isNaN(nc(d))?isNaN(Sm(d).getDate())?h[g][p]=d:h[g][p]=Yn(d):h[g][p]=nc(d))}function t(d,h){var g=h||{},p=[];if(!d||d.length===0)return p;for(var x=d.split(/[\r\n]/),v=x.length-1;v>=0&&x[v].length===0;)--v;for(var w=10,C=0,k=0;k<=v;++k)C=x[k].indexOf(" "),C==-1?C=x[k].length:C++,w=Math.max(w,C);for(k=0;k<=v;++k){p[k]=[];var _=0;for(e(x[k].slice(0,w).trim(),p,k,_,g),_=1;_<=(x[k].length-w)/10+1;++_)e(x[k].slice(w+(_-1)*10,w+_*10).trim(),p,k,_,g)}return g.sheetRows&&(p=p.slice(0,g.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var h={},g=!1,p=0,x=0;p<d.length;++p)(x=d.charCodeAt(p))==34?g=!g:!g&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p]);if(!x.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p])}return x.sort(function(v,w){return v[0]-w[0]||n[v[1]]-n[w[1]]}),r[x.pop()[1]]||44}function a(d,h){var g=h||{},p="",x=g.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=s(d.slice(0,1024)):g&&g.FS?p=g.FS:p=s(d.slice(0,1024));var w=0,C=0,k=0,_=0,N=0,E=p.charCodeAt(0),P=!1,F=0,A=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var j=g.dateNF!=null?Wie(g.dateNF):null;function R(){var U=d.slice(_,N),Y={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)Y.t="z";else if(g.raw)Y.t="s",Y.v=U;else if(U.trim().length===0)Y.t="s",Y.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(Y.t="s",Y.v=U.slice(2,-1).replace(/""/g,'"')):yfe(U)?(Y.t="n",Y.f=U.slice(1)):(Y.t="s",Y.v=U);else if(U=="TRUE")Y.t="b",Y.v=!0;else if(U=="FALSE")Y.t="b",Y.v=!1;else if(!isNaN(k=nc(U)))Y.t="n",g.cellText!==!1&&(Y.w=U),Y.v=k;else if(!isNaN(Sm(U).getDate())||j&&U.match(j)){Y.z=g.dateNF||Ar[14];var Z=0;j&&U.match(j)&&(U=Hie(U,g.dateNF,U.match(j)||[]),Z=1),g.cellDates?(Y.t="d",Y.v=Yn(U,Z)):(Y.t="n",Y.v=ma(Yn(U,Z))),g.cellText!==!1&&(Y.w=kl(Y.z,Y.v instanceof Date?ma(Y.v):Y.v)),g.cellNF||delete Y.z}else Y.t="s",Y.v=U;if(Y.t=="z"||(g.dense?(x[w]||(x[w]=[]),x[w][C]=Y):x[Pr({c:C,r:w})]=Y),_=N+1,A=d.charCodeAt(_),v.e.c<C&&(v.e.c=C),v.e.r<w&&(v.e.r=w),F==E)++C;else if(C=0,++w,g.sheetRows&&g.sheetRows<=w)return!0}e:for(;N<d.length;++N)switch(F=d.charCodeAt(N)){case 34:A===34&&(P=!P);break;case E:case 10:case 13:if(!P&&R())break e;break}return N-_>0&&R(),x["!ref"]=Vr(v),x}function i(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,h):Qm(t(d,h),h)}function o(d,h){var g="",p=h.type=="string"?[0,0,0,0]:F3(d,h);switch(h.type){case"base64":g=Uo(d);break;case"binary":g=d;break;case"buffer":h.codepage==65001?g=d.toString("utf8"):h.codepage&&typeof Xy<"u"||(g=Yr&&Buffer.isBuffer(d)?d.toString("binary"):Rf(d));break;case"array":g=d0(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?g=Dn(g.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?g=Dn(g):h.type=="binary"&&typeof Xy<"u",g.slice(0,19)=="socialcalc:version:"?aU.to_sheet(h.type=="string"?g:Dn(g),h):i(g,h)}function l(d,h){return If(o(d,h),h)}function u(d){for(var h=[],g=dn(d["!ref"]),p,x=Array.isArray(d),v=g.s.r;v<=g.e.r;++v){for(var w=[],C=g.s.c;C<=g.e.c;++C){var k=Pr({r:v,c:C});if(p=x?(d[v]||[])[C]:d[k],!p||p.v==null){w.push("          ");continue}for(var _=(p.w||(Zu(p),p.w)||"").slice(0,10);_.length<10;)_+=" ";w.push(_+(C===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}})();function sue(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=nU.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return km.to_workbook(e,t)}}var Hh=(function(){function e(I,B,q){if(I){Za(I,I.l||0);for(var J=q.Enum||V;I.l<I.length;){var se=I.read_shift(2),X=J[se]||J[65535],ie=I.read_shift(2),le=I.l+ie,ce=X.f&&X.f(I,ie,q);if(I.l=le,B(ce,X,se))return}}}function t(I,B){switch(B.type){case"base64":return r(Io(Uo(I)),B);case"binary":return r(Io(I),B);case"buffer":case"array":return r(I,B)}throw"Unsupported type "+B.type}function r(I,B){if(!I)return I;var q=B||{},J=q.dense?[]:{},se="Sheet1",X="",ie=0,le={},ce=[],ke=[],re={s:{r:0,c:0},e:{r:0,c:0}},ge=q.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)q.Enum=V,e(I,function(Ue,It,rt){switch(rt){case 0:q.vers=Ue,Ue>=4096&&(q.qpro=!0);break;case 6:re=Ue;break;case 204:Ue&&(X=Ue);break;case 222:X=Ue;break;case 15:case 51:q.qpro||(Ue[1].v=Ue[1].v.slice(1));case 13:case 14:case 16:rt==14&&(Ue[2]&112)==112&&(Ue[2]&15)>1&&(Ue[2]&15)<15&&(Ue[1].z=q.dateNF||Ar[14],q.cellDates&&(Ue[1].t="d",Ue[1].v=l2(Ue[1].v))),q.qpro&&Ue[3]>ie&&(J["!ref"]=Vr(re),le[se]=J,ce.push(se),J=q.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},ie=Ue[3],se=X||"Sheet"+(ie+1),X="");var wt=q.dense?(J[Ue[0].r]||[])[Ue[0].c]:J[Pr(Ue[0])];if(wt){wt.t=Ue[1].t,wt.v=Ue[1].v,Ue[1].z!=null&&(wt.z=Ue[1].z),Ue[1].f!=null&&(wt.f=Ue[1].f);break}q.dense?(J[Ue[0].r]||(J[Ue[0].r]=[]),J[Ue[0].r][Ue[0].c]=Ue[1]):J[Pr(Ue[0])]=Ue[1];break}},q);else if(I[2]==26||I[2]==14)q.Enum=W,I[2]==14&&(q.qpro=!0,I.l=0),e(I,function(Ue,It,rt){switch(rt){case 204:se=Ue;break;case 22:Ue[1].v=Ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ue[3]>ie&&(J["!ref"]=Vr(re),le[se]=J,ce.push(se),J=q.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},ie=Ue[3],se="Sheet"+(ie+1)),ge>0&&Ue[0].r>=ge)break;q.dense?(J[Ue[0].r]||(J[Ue[0].r]=[]),J[Ue[0].r][Ue[0].c]=Ue[1]):J[Pr(Ue[0])]=Ue[1],re.e.c<Ue[0].c&&(re.e.c=Ue[0].c),re.e.r<Ue[0].r&&(re.e.r=Ue[0].r);break;case 27:Ue[14e3]&&(ke[Ue[14e3][0]]=Ue[14e3][1]);break;case 1537:ke[Ue[0]]=Ue[1],Ue[0]==ie&&(se=Ue[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(J["!ref"]=Vr(re),le[X||se]=J,ce.push(X||se),!ke.length)return{SheetNames:ce,Sheets:le};for(var Ne={},je=[],Ke=0;Ke<ke.length;++Ke)le[ce[Ke]]?(je.push(ke[Ke]||ce[Ke]),Ne[ke[Ke]]=le[ke[Ke]]||le[ce[Ke]]):(je.push(ke[Ke]),Ne[ke[Ke]]={"!ref":"A1"});return{SheetNames:je,Sheets:Ne}}function n(I,B){var q=B||{};if(+q.codepage>=0&&ec(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var J=xo(),se=dn(I["!ref"]),X=Array.isArray(I),ie=[];Yt(J,0,a(1030)),Yt(J,6,l(se));for(var le=Math.min(se.e.r,8191),ce=se.s.r;ce<=le;++ce)for(var ke=Us(ce),re=se.s.c;re<=se.e.c;++re){ce===se.s.r&&(ie[re]=fs(re));var ge=ie[re]+ke,Ne=X?(I[ce]||[])[re]:I[ge];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")(Ne.v|0)==Ne.v&&Ne.v>=-32768&&Ne.v<=32767?Yt(J,13,p(ce,re,Ne.v)):Yt(J,14,v(ce,re,Ne.v));else{var je=Zu(Ne);Yt(J,15,h(ce,re,je.slice(0,239)))}}return Yt(J,1),J.end()}function s(I,B){var q=B||{};if(+q.codepage>=0&&ec(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var J=xo();Yt(J,0,i(I));for(var se=0,X=0;se<I.SheetNames.length;++se)(I.Sheets[I.SheetNames[se]]||{})["!ref"]&&Yt(J,27,M(I.SheetNames[se],X++));var ie=0;for(se=0;se<I.SheetNames.length;++se){var le=I.Sheets[I.SheetNames[se]];if(!(!le||!le["!ref"])){for(var ce=dn(le["!ref"]),ke=Array.isArray(le),re=[],ge=Math.min(ce.e.r,8191),Ne=ce.s.r;Ne<=ge;++Ne)for(var je=Us(Ne),Ke=ce.s.c;Ke<=ce.e.c;++Ke){Ne===ce.s.r&&(re[Ke]=fs(Ke));var Ue=re[Ke]+je,It=ke?(le[Ne]||[])[Ke]:le[Ue];if(!(!It||It.t=="z"))if(It.t=="n")Yt(J,23,R(Ne,Ke,ie,It.v));else{var rt=Zu(It);Yt(J,22,F(Ne,Ke,ie,rt.slice(0,239)))}}++ie}}return Yt(J,1),J.end()}function a(I){var B=_t(2);return B.write_shift(2,I),B}function i(I){var B=_t(26);B.write_shift(2,4096),B.write_shift(2,4),B.write_shift(4,0);for(var q=0,J=0,se=0,X=0;X<I.SheetNames.length;++X){var ie=I.SheetNames[X],le=I.Sheets[ie];if(!(!le||!le["!ref"])){++se;var ce=yo(le["!ref"]);q<ce.e.r&&(q=ce.e.r),J<ce.e.c&&(J=ce.e.c)}}return q>8191&&(q=8191),B.write_shift(2,q),B.write_shift(1,se),B.write_shift(1,J),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(1,1),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(4,0),B}function o(I,B,q){var J={s:{c:0,r:0},e:{c:0,r:0}};return B==8&&q.qpro?(J.s.c=I.read_shift(1),I.l++,J.s.r=I.read_shift(2),J.e.c=I.read_shift(1),I.l++,J.e.r=I.read_shift(2),J):(J.s.c=I.read_shift(2),J.s.r=I.read_shift(2),B==12&&q.qpro&&(I.l+=2),J.e.c=I.read_shift(2),J.e.r=I.read_shift(2),B==12&&q.qpro&&(I.l+=2),J.s.c==65535&&(J.s.c=J.e.c=J.s.r=J.e.r=0),J)}function l(I){var B=_t(8);return B.write_shift(2,I.s.c),B.write_shift(2,I.s.r),B.write_shift(2,I.e.c),B.write_shift(2,I.e.r),B}function u(I,B,q){var J=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(J[0].c=I.read_shift(1),J[3]=I.read_shift(1),J[0].r=I.read_shift(2),I.l+=2):(J[2]=I.read_shift(1),J[0].c=I.read_shift(2),J[0].r=I.read_shift(2)),J}function d(I,B,q){var J=I.l+B,se=u(I,B,q);if(se[1].t="s",q.vers==20768){I.l++;var X=I.read_shift(1);return se[1].v=I.read_shift(X,"utf8"),se}return q.qpro&&I.l++,se[1].v=I.read_shift(J-I.l,"cstr"),se}function h(I,B,q){var J=_t(7+q.length);J.write_shift(1,255),J.write_shift(2,B),J.write_shift(2,I),J.write_shift(1,39);for(var se=0;se<J.length;++se){var X=q.charCodeAt(se);J.write_shift(1,X>=128?95:X)}return J.write_shift(1,0),J}function g(I,B,q){var J=u(I,B,q);return J[1].v=I.read_shift(2,"i"),J}function p(I,B,q){var J=_t(7);return J.write_shift(1,255),J.write_shift(2,B),J.write_shift(2,I),J.write_shift(2,q,"i"),J}function x(I,B,q){var J=u(I,B,q);return J[1].v=I.read_shift(8,"f"),J}function v(I,B,q){var J=_t(13);return J.write_shift(1,255),J.write_shift(2,B),J.write_shift(2,I),J.write_shift(8,q,"f"),J}function w(I,B,q){var J=I.l+B,se=u(I,B,q);if(se[1].v=I.read_shift(8,"f"),q.qpro)I.l=J;else{var X=I.read_shift(2);N(I.slice(I.l,I.l+X),se),I.l+=X}return se}function C(I,B,q){var J=B&32768;return B&=-32769,B=(J?I:0)+(B>=8192?B-16384:B),(J?"":"$")+(q?fs(B):Us(B))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(I,B){Za(I,0);for(var q=[],J=0,se="",X="",ie="",le="";I.l<I.length;){var ce=I[I.l++];switch(ce){case 0:q.push(I.read_shift(8,"f"));break;case 1:X=C(B[0].c,I.read_shift(2),!0),se=C(B[0].r,I.read_shift(2),!1),q.push(X+se);break;case 2:{var ke=C(B[0].c,I.read_shift(2),!0),re=C(B[0].r,I.read_shift(2),!1);X=C(B[0].c,I.read_shift(2),!0),se=C(B[0].r,I.read_shift(2),!1),q.push(ke+re+":"+X+se)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(I.read_shift(2));break;case 6:{for(var ge="";ce=I[I.l++];)ge+=String.fromCharCode(ce);q.push('"'+ge.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:le=q.pop(),ie=q.pop(),q.push(["AND","OR"][ce-20]+"("+ie+","+le+")");break;default:if(ce<32&&_[ce])le=q.pop(),ie=q.pop(),q.push(ie+_[ce]+le);else if(k[ce]){if(J=k[ce][1],J==69&&(J=I[I.l++]),J>q.length){console.error("WK1 bad formula parse 0x"+ce.toString(16)+":|"+q.join("|")+"|");return}var Ne=q.slice(-J);q.length-=J,q.push(k[ce][0]+"("+Ne.join(",")+")")}else return ce<=7?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=24?console.error("WK1 unsupported op "+ce.toString(16)):ce<=30?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=115?console.error("WK1 unsupported function opcode "+ce.toString(16)):console.error("WK1 unrecognized opcode "+ce.toString(16))}}q.length==1?B[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function E(I){var B=[{c:0,r:0},{t:"n",v:0},0];return B[0].r=I.read_shift(2),B[3]=I[I.l++],B[0].c=I[I.l++],B}function P(I,B){var q=E(I);return q[1].t="s",q[1].v=I.read_shift(B-4,"cstr"),q}function F(I,B,q,J){var se=_t(6+J.length);se.write_shift(2,I),se.write_shift(1,q),se.write_shift(1,B),se.write_shift(1,39);for(var X=0;X<J.length;++X){var ie=J.charCodeAt(X);se.write_shift(1,ie>=128?95:ie)}return se.write_shift(1,0),se}function A(I,B){var q=E(I);q[1].v=I.read_shift(2);var J=q[1].v>>1;if(q[1].v&1)switch(J&7){case 0:J=(J>>3)*5e3;break;case 1:J=(J>>3)*500;break;case 2:J=(J>>3)/20;break;case 3:J=(J>>3)/200;break;case 4:J=(J>>3)/2e3;break;case 5:J=(J>>3)/2e4;break;case 6:J=(J>>3)/16;break;case 7:J=(J>>3)/64;break}return q[1].v=J,q}function j(I,B){var q=E(I),J=I.read_shift(4),se=I.read_shift(4),X=I.read_shift(2);if(X==65535)return J===0&&se===3221225472?(q[1].t="e",q[1].v=15):J===0&&se===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var ie=X&32768;return X=(X&32767)-16446,q[1].v=(1-ie*2)*(se*Math.pow(2,X+32)+J*Math.pow(2,X)),q}function R(I,B,q,J){var se=_t(14);if(se.write_shift(2,I),se.write_shift(1,q),se.write_shift(1,B),J==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var X=0,ie=0,le=0,ce=0;return J<0&&(X=1,J=-J),ie=Math.log2(J)|0,J/=Math.pow(2,ie-31),ce=J>>>0,(ce&2147483648)==0&&(J/=2,++ie,ce=J>>>0),J-=ce,ce|=2147483648,ce>>>=0,J*=Math.pow(2,32),le=J>>>0,se.write_shift(4,le),se.write_shift(4,ce),ie+=16383+(X?32768:0),se.write_shift(2,ie),se}function U(I,B){var q=j(I);return I.l+=B-14,q}function Y(I,B){var q=E(I),J=I.read_shift(4);return q[1].v=J>>6,q}function Z(I,B){var q=E(I),J=I.read_shift(8,"f");return q[1].v=J,q}function ae(I,B){var q=Z(I);return I.l+=B-10,q}function ee(I,B){return I[I.l+B-1]==0?I.read_shift(B,"cstr"):""}function ne(I,B){var q=I[I.l++];q>B-1&&(q=B-1);for(var J="";J.length<q;)J+=String.fromCharCode(I[I.l++]);return J}function L(I,B,q){if(!(!q.qpro||B<21)){var J=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var se=I.read_shift(B-21,"cstr");return[J,se]}}function H(I,B){for(var q={},J=I.l+B;I.l<J;){var se=I.read_shift(2);if(se==14e3){for(q[se]=[0,""],q[se][0]=I.read_shift(2);I[I.l];)q[se][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return q}function M(I,B){var q=_t(5+I.length);q.write_shift(2,14e3),q.write_shift(2,B);for(var J=0;J<I.length;++J){var se=I.charCodeAt(J);q[q.l++]=se>127?95:se}return q[q.l++]=0,q}var V={0:{n:"BOF",f:Js},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ee},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},W={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:H},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Y},38:{n:"??"},39:{n:"NUMBER27",f:Z},40:{n:"FORMULA28",f:ae},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:L},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}})();function aue(e){var t={},r=e.match(Ai),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Or(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=Y4[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var iue=(function(){var e=Zy("t"),t=Zy("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:un(i[1])},l=a.match(t);return l&&(o.s=aue(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}})(),oue=(function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}})(),lue=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,cue=/<(?:\w+:)?r>/,uue=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function v3(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=un(Dn(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Dn(e),r&&(n.h=a3(n.t))):e.match(cue)&&(n.r=Dn(e),n.t=un(Dn((e.replace(uue,"").match(lue)||[]).join("").replace(Ai,""))),r&&(n.h=oue(iue(n.r)))),n):{t:""}}var due=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,fue=/<(?:\w+:)?(?:si|sstItem)>/g,hue=/<\/(?:\w+:)?(?:si|sstItem)>/;function gue(e,t){var r=[],n="";if(!e)return r;var s=e.match(due);if(s){n=s[2].replace(fue,"").split(hue);for(var a=0;a!=n.length;++a){var i=v3(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=Or(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var mue=/^\s|\s$|[\t\n\r]/;function iU(e,t){if(!t.bookSST)return"";var r=[Ws];r[r.length]=qt("sst",null,{xmlns:T0[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(mue)&&(a+=' xml:space="preserve"'),a+=">"+Nn(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function pue(e){return[e.read_shift(4),e.read_shift(4)]}function xue(e,t){var r=[],n=!1;return od(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function yue(e,t){return t||(t=_t(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var vue=Aoe;function wue(e){var t=xo();Ot(t,159,yue(e));for(var r=0;r<e.length;++r)Ot(t,19,vue(e[r]));return Ot(t,160),t.end()}function oU(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Gu(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function bue(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Gu(e,4),t.U=Gu(e,4),t.W=Gu(e,4),t}function _ue(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Sue(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(_ue(e));return t}function kue(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Cue(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Gu(e,4),t.U=Gu(e,4),t.W=Gu(e,4),t}function Tue(e){var t=Cue(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function lU(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function cU(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Eue(e){var t=Gu(e);switch(t.Minor){case 2:return[t.Minor,Nue(e)];case 3:return[t.Minor,Aue()];case 4:return[t.Minor,jue(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Nue(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=lU(e,r),s=cU(e,e.length-e.l);return{t:"Std",h:n,v:s}}function Aue(){throw new Error("File is password-protected: ECMA-376 Extensible")}function jue(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Ai,function(a){var i=Or(a);switch(Zc(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Pue(e,t){var r={},n=r.EncryptionVersionInfo=Gu(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=lU(e,s),t-=s,r.EncryptionVerifier=cU(e,t),r}function Fue(e){var t={},r=t.EncryptionVersionInfo=Gu(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function w3(e){var t=0,r,n=oU(e),s=n.length+1,a,i,o,l,u;for(r=Sf(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=(t&16384)===0?0:1,l=t<<1&32767,u=o|l,t=u^i;return t^52811}var uU=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],l=104,u=i.length-1;u>=0;--u)for(var d=i[u],h=0;h!=7;++h)d&64&&(o^=r[l]),d*=2,--l;return o};return function(i){for(var o=oU(i),l=a(o),u=o.length,d=Sf(16),h=0;h!=16;++h)d[h]=0;var g,p,x;for((u&1)===1&&(g=l>>8,d[u]=s(e[0],g),--u,g=l&255,p=o[o.length-1],d[u]=s(p,g));u>0;)--u,g=l>>8,d[u]=s(o[u],g),--u,g=l&255,d[u]=s(o[u],g);for(u=15,x=15-o.length;x>0;)g=l>>8,d[u]=s(e[x],g),--u,--x,g=l&255,d[u]=s(o[u],g),--u,--x;return d}})(),Oue=function(e,t,r,n,s){s||(s=t),n||(n=uU(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},Due=function(e){var t=0,r=uU(e);return function(n){var s=Oue("",n,t,r);return t=s[1],s[0]}};function Rue(e,t,r,n){var s={key:Js(e),verificationBytes:Js(e)};return r.password&&(s.verifier=w3(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=Due(r.password)),s}function Iue(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Fue(e):n.Data=Pue(e,t),n}function Mue(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Iue(e,t-2,n):Rue(e,r.biff>=8?t:t-2,r,n),n}var dU=(function(){function e(s,a){switch(a.type){case"base64":return t(Uo(s),a);case"binary":return t(s,a);case"buffer":return t(Yr&&Buffer.isBuffer(s)?s.toString("binary"):Rf(s),a);case"array":return t(d0(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var g=/\\\w+\b/g,p=0,x,v=-1;x=g.exec(d);){switch(x[0]){case"\\cell":var w=d.slice(p,g.lastIndex-x[0].length);if(w[0]==" "&&(w=w.slice(1)),++v,w.length){var C={v:w,t:"s"};Array.isArray(o)?o[h][v]=C:o[Pr({r:h,c:v})]=C}break}p=g.lastIndex}v>u.e.c&&(u.e.c=v)}),o["!ref"]=Vr(u),o}function r(s,a){return If(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=dn(s["!ref"]),o,l=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var h=Pr({r:u,c:d});o=l?(s[u]||[])[d]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Zu(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function Lue(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function nv(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Bue(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,l=0,u=s+a;switch(l=i/(u>1?2-u:u),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,u/2]}function $ue(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function Kb(e,t){if(t===0)return e;var r=Bue(Lue(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),nv($ue(r))}var fU=6,Uue=15,zue=1,wi=fU;function sv(e){return Math.floor((e+Math.round(128/wi)/256)*wi)}function av(e){return Math.floor((e-5)/wi*100+.5)/100}function qb(e){return Math.round((e*wi+5)/wi*256)/256}function Sk(e){return qb(av(sv(e)))}function b3(e){var t=Math.abs(e-Sk(e)),r=wi;if(t>.005)for(wi=zue;wi<Uue;++wi)Math.abs(e-Sk(e))<=t&&(t=Math.abs(e-Sk(e)),r=wi);wi=r}function kf(e){e.width?(e.wpx=sv(e.width),e.wch=av(e.wpx),e.MDW=wi):e.wpx?(e.wch=av(e.wpx),e.width=qb(e.wch),e.MDW=wi):typeof e.wch=="number"&&(e.width=qb(e.wch),e.wpx=sv(e.width),e.MDW=wi),e.customWidth&&delete e.customWidth}var Wue=96,hU=Wue;function iv(e){return e*96/hU}function Cm(e){return e*hU/96}var Hue={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Gue(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Ai)||[]).forEach(function(i){var o=Or(i);switch(Zc(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Vn(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Vn(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function Vue(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Ai)||[]).forEach(function(i){var o=Or(i);switch(Zc(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function Kue(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Ai)||[]).forEach(function(i){var o=Or(i);switch(Zc(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Dn(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Vn(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Vn(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Vn(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Vn(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Vn(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Vn(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Vn(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Y4[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Vn(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=zh[s.color.index];s.color.index==81&&(l=zh[1]),l||(l=zh[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Kb(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function que(e,t,r){t.NumberFmt=[];for(var n=As(Ar),s=0;s<n.length;++s)t.NumberFmt[n[s]]=Ar[n[s]];var a=e[0].match(Ai);if(a)for(s=0;s<a.length;++s){var i=Or(a[s]);switch(Zc(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=un(Dn(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Hu(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function Yue(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=qt("numFmt",null,{numFmtId:n,formatCode:Nn(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=qt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Pw=["numFmtId","fillId","fontId","borderId","xfId"],Fw=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Xue(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Ai)||[]).forEach(function(a){var i=Or(a),o=0;switch(Zc(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Pw.length;++o)n[Pw[o]]&&(n[Pw[o]]=parseInt(n[Pw[o]],10));for(o=0;o<Fw.length;++o)n[Fw[o]]&&(n[Fw[o]]=Vn(n[Fw[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Vn(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function Jue(e){var t=[];return t[t.length]=qt("cellXfs",null),e.forEach(function(r){t[t.length]=qt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=qt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Que=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&que(h,d,u),(h=o.match(s))&&Kue(h,d,l,u),(h=o.match(n))&&Vue(h,d,l,u),(h=o.match(a))&&Gue(h,d,l,u),(h=o.match(r))&&Xue(h,d,u),d}})();function gU(e,t){var r=[Ws,qt("styleSheet",null,{xmlns:T0[0],"xmlns:vt":ha.vt})],n;return e.SSF&&(n=Yue(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Jue(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Zue(e,t){var r=e.read_shift(2),n=Ti(e);return[r,n]}function ede(e,t,r){r||(r=_t(6+4*t.length)),r.write_shift(2,e),Fa(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function tde(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=Ioe(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=Roe(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ti(e),n}function rde(e,t){t||(t=_t(153)),t.write_shift(2,e.sz*20),Moe(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Hb(e.color,t);var n=0;return n=2,t.write_shift(1,n),Fa(e.name,t),t.length>t.l?t.slice(0,t.l):t}var nde=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],kk,sde=Ni;function wO(e,t){t||(t=_t(84)),kk||(kk=i2(nde));var r=kk[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Hb({auto:1},t),Hb({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function ade(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function mU(e,t,r){r||(r=_t(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Yx(e,t){return t||(t=_t(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var ide=Ni;function ode(e,t){return t||(t=_t(51)),t.write_shift(1,0),Yx(null,t),Yx(null,t),Yx(null,t),Yx(null,t),Yx(null,t),t.length>t.l?t.slice(0,t.l):t}function lde(e,t){return t||(t=_t(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Wb(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function cde(e,t,r){var n=_t(2052);return n.write_shift(4,e),Wb(t,n),Wb(r,n),n.length>n.l?n.slice(0,n.l):n}function ude(e,t,r){var n={};n.NumberFmt=[];for(var s in Ar)n.NumberFmt[s]=Ar[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return od(e,function(l,u,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],Hu(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Kb(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function dde(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(Ot(e,615,sc(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Ot(e,44,ede(s,t[s]))}),Ot(e,616))}}function fde(e){var t=1;Ot(e,611,sc(t)),Ot(e,43,rde({sz:12,color:{theme:1},name:"Calibri",family:2})),Ot(e,612)}function hde(e){var t=2;Ot(e,603,sc(t)),Ot(e,45,wO({patternType:"none"})),Ot(e,45,wO({patternType:"gray125"})),Ot(e,604)}function gde(e){var t=1;Ot(e,613,sc(t)),Ot(e,46,ode()),Ot(e,614)}function mde(e){var t=1;Ot(e,626,sc(t)),Ot(e,47,mU({numFmtId:0},65535)),Ot(e,627)}function pde(e,t){Ot(e,617,sc(t.length)),t.forEach(function(r){Ot(e,47,mU(r,0))}),Ot(e,618)}function xde(e){var t=1;Ot(e,619,sc(t)),Ot(e,48,lde({xfId:0,name:"Normal"})),Ot(e,620)}function yde(e){var t=0;Ot(e,505,sc(t)),Ot(e,506)}function vde(e){var t=0;Ot(e,508,cde(t,"TableStyleMedium9","PivotStyleMedium4")),Ot(e,509)}function wde(e,t){var r=xo();return Ot(r,278),dde(r,e.SSF),fde(r),hde(r),gde(r),mde(r),pde(r,t.cellXfs),xde(r),yde(r),vde(r),Ot(r,279),r.end()}var bde=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function _de(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Ai)||[]).forEach(function(s){var a=Or(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[bde.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Sde(){}function kde(){}var Cde=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Tde=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Ede=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Nde(e,t,r){t.themeElements={};var n;[["clrScheme",Cde,_de],["fontScheme",Tde,Sde],["fmtScheme",Ede,kde]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var Ade=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function pU(e,t){(!e||e.length===0)&&(e=_3());var r,n={};if(!(r=e.match(Ade)))throw new Error("themeElements not found in theme");return Nde(r[0],n,t),n.raw=e,n}function _3(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Ws];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function jde(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=l$(a,{type:"array"})}catch{return}var o=Mo(i,"theme/theme/theme1.xml",!0);if(o)return pU(o,r)}}function Pde(e){return e.read_shift(4)}function Fde(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Ode(e,4);break;case 2:t.xclrValue=Y$(e);break;case 3:t.xclrValue=Pde(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Ode(e,t){return Ni(e,t)}function Dde(e,t){return Ni(e,t)}function Rde(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Fde(e);break;case 6:n[1]=Dde(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Ide(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(Rde(e,r-e.l));return{ixfe:n,ext:a}}function Mde(e,t){t.forEach(function(r){r[0]})}function Lde(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ti(e)}}function Bde(e){var t=_t(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Fa(e.name,t),t.slice(0,t.l)}function $de(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Ude(e){var t=_t(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function zde(e,t){var r=_t(8+2*t.length);return r.write_shift(4,e),Fa(t,r),r.slice(0,r.l)}function Wde(e){return e.l+=4,e.read_shift(4)!=0}function Hde(e,t){var r=_t(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Gde(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return od(e,function(l,u,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function Vde(){var e=xo();return Ot(e,332),Ot(e,334,sc(1)),Ot(e,335,Bde({name:"XLDAPR",version:12e4,flags:3496657072})),Ot(e,336),Ot(e,339,zde(1,"XLDAPR")),Ot(e,52),Ot(e,35,sc(514)),Ot(e,4096,sc(0)),Ot(e,4097,gl(1)),Ot(e,36),Ot(e,53),Ot(e,340),Ot(e,337,Hde(1)),Ot(e,51,Ude([[1,0]])),Ot(e,338),Ot(e,333),e.end()}function Kde(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(Ai,function(o){var l=Or(o);switch(Zc(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function xU(){var e=[Ws];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function qde(e){var t=[];if(!e)return t;var r=1;return(e.match(Ai)||[]).forEach(function(n){var s=Or(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function Yde(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Pr(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Xde(e,t,r){var n=[];return od(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function Jde(e,t,r,n){if(!e)return e;var s=n||{},a=!1;od(e,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function Qde(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Zg=1024;function yU(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[qt("xml",null,{"xmlns:v":Oo.v,"xmlns:o":Oo.o,"xmlns:x":Oo.x,"xmlns:mv":Oo.mv}).replace(/\/>/,">"),qt("o:shapelayout",qt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),qt("v:shapetype",[qt("v:stroke",null,{joinstyle:"miter"}),qt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Zg<e*1e3;)Zg+=1e3;return t.forEach(function(a){var i=hs(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?qt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=qt("v:fill",l,o),d={on:"t",obscured:"t"};++Zg,s=s.concat(["<v:shape"+ev({id:"_x0000_s"+Zg,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,qt("v:shadow",null,d),qt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ri("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),ri("x:AutoFill","False"),ri("x:Row",String(i.r)),ri("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function bO(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=hs(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var l=dn(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=Vr(l);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var h=a.c.length-1;h>=0;--h){if(!r&&a.c[h].T)return;r&&!a.c[h].T&&a.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(d.a==n[h].id){d.a=n[h].name||d.a;break}}a.c.push(d)})}function Zde(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Or(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=hs(l.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var h=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!h&&!!h[1]&&v3(h[1])||{r:"",t:"",h:""};u.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),u.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=g.h),n.push(u)}}}}),n}function vU(e){var t=[Ws,qt("comments",null,{xmlns:T0[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=Nn(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(s=r.indexOf(Nn(l.a))),a.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(ri("t",Nn(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(ri("t",Nn(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function efe(e,t){var r=[],n=!1,s={},a=0;return e.replace(Ai,function(o,l){var u=Or(o);switch(Zc(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function tfe(e,t,r){var n=[Ws,qt("ThreadedComments",null,{xmlns:ha.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=l.id:l.parentId=a,i.ID=l.id,i.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(qt("threadedComment",ri("text",i.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function rfe(e,t){var r=[],n=!1;return e.replace(Ai,function(a){var i=Or(a);switch(Zc(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function nfe(e){var t=[Ws,qt("personList",null,{xmlns:ha.TCMNT,"xmlns:x":T0[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(qt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function sfe(e){var t={};t.iauthor=e.read_shift(4);var r=j0(e);return t.rfx=r.s,t.ref=Pr(r.s),e.l+=16,t}function afe(e,t){return t==null&&(t=_t(36)),t.write_shift(4,e[1].iauthor),Zm(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var ife=Ti;function ofe(e){return Fa(e.slice(0,54))}function lfe(e,t){var r=[],n=[],s={},a=!1;return od(e,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function cfe(e){var t=xo(),r=[];return Ot(t,628),Ot(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Ot(t,632,ofe(s.a)))})}),Ot(t,631),Ot(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:hs(n[0]),e:hs(n[0])};Ot(t,635,afe([a,s])),s.t&&s.t.length>0&&Ot(t,637,Poe(s)),Ot(t,636),delete s.iauthor})}),Ot(t,634),Ot(t,629),t.end()}var ufe="application/vnd.ms-office.vbaProject";function dfe(e){var t=Sr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Sr.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Sr.write(t)}function ffe(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Sr.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var wU=["xlsb","xlsm","xlam","biff8","xla"];function hfe(){return{"!type":"dialog"}}function gfe(){return{"!type":"dialog"}}function mfe(){return{"!type":"macro"}}function pfe(){return{"!type":"macro"}}var um=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=t.c:--d,l?u+=t.r:--u,s+(o?"":"$")+fs(d)+(l?"":"$")+Us(u)}return function(s,a){return t=a,s.replace(e,r)}})(),S3=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,k3=(function(){return function(t,r){return t.replace(S3,function(n,s,a,i,o,l){var u=u3(i)-(a?0:r.c),d=c3(l)-(o?0:r.r),h=d==0?"":o?d+1:"["+d+"]",g=u==0?"":a?u+1:"["+u+"]";return s+"R"+h+"C"+g})}})();function bU(e,t){return e.replace(S3,function(r,n,s,a,i,o){return n+(s=="$"?s+a:fs(u3(a)+t.c))+(i=="$"?i+o:Us(c3(o)+t.r))})}function xfe(e,t,r){var n=yo(t),s=n.s,a=hs(r),i={r:a.r-s.r,c:a.c-s.c};return bU(e,i)}function yfe(e){return e.length!=1}function _O(e){return e.replace(/_xlfn\./g,"")}function Ys(e){e.l+=1}function Cf(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function _U(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return SU(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=Cf(e),o=Cf(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function SU(e){var t=Cf(e),r=Cf(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function vfe(e,t,r){if(r.biff<8)return SU(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Cf(e),i=Cf(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function kU(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return wfe(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Cf(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function wfe(e){var t=Cf(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function bfe(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function _fe(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Sfe(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function Sfe(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function kfe(e,t,r){var n=(e[e.l++]&96)>>5,s=_U(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function Cfe(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=_U(e,a,r);return[n,s,i]}function Tfe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Efe(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function Nfe(e,t,r){var n=(e[e.l++]&96)>>5,s=vfe(e,t-1,r);return[n,s]}function Afe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function SO(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function jfe(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function Pfe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Ffe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Ofe(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Dfe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function CU(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Rfe(e){return e.read_shift(2),CU(e)}function Ife(e){return e.read_shift(2),CU(e)}function Mfe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=kU(e,0,r);return[n,s]}function Lfe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=_fe(e,0,r);return[n,s]}function Bfe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=kU(e,0,r);return[n,s,a]}function $fe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[Whe[s],NU[s],n]}function Ufe(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:zfe(e);return[s,(a[0]===0?NU:zhe)[a[1]]]}function zfe(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Wfe(e,t,r){e.l+=r&&r.biff==2?3:4}function Hfe(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Gfe(e){return e.l++,ld[e.read_shift(1)]}function Vfe(e){return e.l++,e.read_shift(2)}function Kfe(e){return e.l++,e.read_shift(1)!==0}function qfe(e){return e.l++,_i(e)}function Yfe(e,t,r){return e.l++,Hv(e,t-1,r)}function Xfe(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ls(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ld[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=_i(e);break;case 2:r[1]=P0(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Jfe(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?j0:c2)(e));return s}function Qfe(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=Xfe(e,r.biff);return i}function Zfe(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function ehe(e,t,r){if(r.biff==5)return the(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function the(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function rhe(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function nhe(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function she(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function ahe(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var ihe=Ni,ohe=Ni,lhe=Ni;function Vv(e,t,r){return e.l+=2,[bfe(e)]}function C3(e){return e.l+=6,[]}var che=Vv,uhe=C3,dhe=C3,fhe=Vv;function TU(e){return e.l+=2,[Js(e),e.read_shift(2)&1]}var hhe=Vv,ghe=TU,mhe=C3,phe=Vv,xhe=Vv,yhe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function vhe(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=yhe[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function whe(e){return e.l+=2,[e.read_shift(4)]}function bhe(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function _he(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function She(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function khe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Che(e){return e.l+=4,[0,0]}var kO={1:{n:"PtgExp",f:Hfe},2:{n:"PtgTbl",f:lhe},3:{n:"PtgAdd",f:Ys},4:{n:"PtgSub",f:Ys},5:{n:"PtgMul",f:Ys},6:{n:"PtgDiv",f:Ys},7:{n:"PtgPower",f:Ys},8:{n:"PtgConcat",f:Ys},9:{n:"PtgLt",f:Ys},10:{n:"PtgLe",f:Ys},11:{n:"PtgEq",f:Ys},12:{n:"PtgGe",f:Ys},13:{n:"PtgGt",f:Ys},14:{n:"PtgNe",f:Ys},15:{n:"PtgIsect",f:Ys},16:{n:"PtgUnion",f:Ys},17:{n:"PtgRange",f:Ys},18:{n:"PtgUplus",f:Ys},19:{n:"PtgUminus",f:Ys},20:{n:"PtgPercent",f:Ys},21:{n:"PtgParen",f:Ys},22:{n:"PtgMissArg",f:Ys},23:{n:"PtgStr",f:Yfe},26:{n:"PtgSheet",f:bhe},27:{n:"PtgEndSheet",f:_he},28:{n:"PtgErr",f:Gfe},29:{n:"PtgBool",f:Kfe},30:{n:"PtgInt",f:Vfe},31:{n:"PtgNum",f:qfe},32:{n:"PtgArray",f:Afe},33:{n:"PtgFunc",f:$fe},34:{n:"PtgFuncVar",f:Ufe},35:{n:"PtgName",f:Zfe},36:{n:"PtgRef",f:Mfe},37:{n:"PtgArea",f:kfe},38:{n:"PtgMemArea",f:rhe},39:{n:"PtgMemErr",f:ihe},40:{n:"PtgMemNoMem",f:ohe},41:{n:"PtgMemFunc",f:nhe},42:{n:"PtgRefErr",f:she},43:{n:"PtgAreaErr",f:Tfe},44:{n:"PtgRefN",f:Lfe},45:{n:"PtgAreaN",f:Nfe},46:{n:"PtgMemAreaN",f:She},47:{n:"PtgMemNoMemN",f:khe},57:{n:"PtgNameX",f:ehe},58:{n:"PtgRef3d",f:Bfe},59:{n:"PtgArea3d",f:Cfe},60:{n:"PtgRefErr3d",f:ahe},61:{n:"PtgAreaErr3d",f:Efe},255:{}},The={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ehe={1:{n:"PtgElfLel",f:TU},2:{n:"PtgElfRw",f:phe},3:{n:"PtgElfCol",f:che},6:{n:"PtgElfRwV",f:xhe},7:{n:"PtgElfColV",f:fhe},10:{n:"PtgElfRadical",f:hhe},11:{n:"PtgElfRadicalS",f:mhe},13:{n:"PtgElfColS",f:uhe},15:{n:"PtgElfColSV",f:dhe},16:{n:"PtgElfRadicalLel",f:ghe},25:{n:"PtgList",f:vhe},29:{n:"PtgSxName",f:whe},255:{}},Nhe={0:{n:"PtgAttrNoop",f:Che},1:{n:"PtgAttrSemi",f:Dfe},2:{n:"PtgAttrIf",f:Ffe},4:{n:"PtgAttrChoose",f:jfe},8:{n:"PtgAttrGoto",f:Pfe},16:{n:"PtgAttrSum",f:Wfe},32:{n:"PtgAttrBaxcel",f:SO},33:{n:"PtgAttrBaxcel",f:SO},64:{n:"PtgAttrSpace",f:Rfe},65:{n:"PtgAttrSpaceSemi",f:Ife},128:{n:"PtgAttrIfError",f:Ofe},255:{}};function Kv(e,t,r,n){if(n.biff<8)return Ni(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Qfe(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Jfe(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Ni(e,t)),a}function qv(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=kO[a]||kO[The[a]],(a===24||a===25)&&(s=(a===24?Ehe:Nhe)[e[e.l+1]]),!s||!s.f?Ni(e,t):i.push([s.n,s.f(e,t,r)]);return i}function Ahe(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var jhe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Phe(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function EU(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function CO(e,t,r){var n=EU(e,t,r);return n=="#REF"?n:Phe(n,r)}function vi(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,u,d,h=0,g=0,p,x="";if(!e[0]||!e[0][0])return"";for(var v=-1,w="",C=0,k=e[0].length;C<k;++C){var _=e[0][C];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),v>=0){switch(e[0][v][1][0]){case 0:w=Cs(" ",e[0][v][1][1]);break;case 1:w=Cs("\r",e[0][v][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}u=u+w,v=-1}o.push(u+jhe[_[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Sy(_[1][1],i,s),o.push(ky(d,a));break;case"PtgRefN":d=r?Sy(_[1][1],r,s):_[1][1],o.push(ky(d,a));break;case"PtgRef3d":h=_[1][1],d=Sy(_[1][2],i,s),x=CO(n,h,s),o.push(x+"!"+ky(d,a));break;case"PtgFunc":case"PtgFuncVar":var N=_[1][0],E=_[1][1];N||(N=0),N&=127;var P=N==0?[]:o.slice(-N);o.length-=N,E==="User"&&(E=P.shift()),o.push(E+"("+P.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":p=eO(_[1][1],r?{s:r}:i,s),o.push(wk(p,s));break;case"PtgArea":p=eO(_[1][1],i,s),o.push(wk(p,s));break;case"PtgArea3d":h=_[1][1],p=_[1][2],x=CO(n,h,s),o.push(x+"!"+wk(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=_[1][2];var F=(n.names||[])[g-1]||(n[0]||[])[g],A=F?F.Name:"SH33TJSNAME"+String(g);A&&A.slice(0,6)=="_xlfn."&&!s.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var j=_[1][1];g=_[1][2];var R;if(s.biff<=5)j<0&&(j=-j),n[j]&&(R=n[j][g]);else{var U="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][g]&&n[j][g].itab>0&&(U=n.SheetNames[n[j][g].itab-1]+"!"):U=n.SheetNames[g-1]+"!"),n[j]&&n[j][g])U+=n[j][g].Name;else if(n[0]&&n[0][g])U+=n[0][g].Name;else{var Y=(EU(n,j,s)||"").split(";;");Y[g-1]?U=Y[g-1]:U+="SH33TJSERRX"}o.push(U);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var Z="(",ae=")";if(v>=0){switch(w="",e[0][v][1][0]){case 2:Z=Cs(" ",e[0][v][1][1])+Z;break;case 3:Z=Cs("\r",e[0][v][1][1])+Z;break;case 4:ae=Cs(" ",e[0][v][1][1])+ae;break;case 5:ae=Cs("\r",e[0][v][1][1])+ae;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}o.push(Z+o.pop()+ae);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var ee={c:r.c,r:r.r};if(n.sharedf[Pr(d)]){var ne=n.sharedf[Pr(d)];o.push(vi(ne,i,ee,n,s))}else{var L=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(vi(u[1],i,ee,n,s)),L=!0;break}L||o.push(_[1])}break;case"PtgArray":o.push("{"+Ahe(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var H=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&H.indexOf(e[0][C][0])==-1){_=e[0][v];var M=!0;switch(_[1][0]){case 4:M=!1;case 0:w=Cs(" ",_[1][1]);break;case 5:M=!1;case 1:w=Cs("\r",_[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((M?w:"")+o.pop()+(M?"":w)),v=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function Fhe(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Ni(e,t-2)];var o=qv(e,i,r);return t!==i+s&&(a=Kv(e,t-i-s,o,r)),e.l=n,[o,a]}function Ohe(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Ni(e,t-2)];var o=qv(e,i,r);return t!==i+s&&(a=Kv(e,t-i-s,o,r)),e.l=n,[o,a]}function Dhe(e,t,r,n){var s=e.l+t,a=qv(e,n,r),i;return s!==e.l&&(i=Kv(e,s-e.l,a,r)),[a,i]}function Rhe(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=qv(e,a,r);return a==65535?[[],Ni(e,t-2)]:(t!==a+2&&(s=Kv(e,n-a-2,i,r)),[i,s])}function Ihe(e){var t;if(Bu(e,e.l+6)!==65535)return[_i(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Mhe(e){if(e==null){var t=_t(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return f0(e);return f0(0)}function Ck(e,t,r){var n=e.l+t,s=eu(e);r.biff==2&&++e.l;var a=Ihe(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Ohe(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function Lhe(e,t,r,n,s){var a=g0(t,r,s),i=Mhe(e.v),o=_t(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=_t(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var h=ja([a,i,o,u]);return h}function u2(e,t,r){var n=e.read_shift(4),s=qv(e,n,r),a=e.read_shift(4),i=a>0?Kv(e,a,s,r):null;return[s,i]}var Bhe=u2,d2=u2,$he=u2,Uhe=u2,zhe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},NU={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Whe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function TO(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Hhe(e){var t="of:="+e.replace(S3,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Tk(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Ghe(e){return e.replace(/\./,"!")}var Ty={},dm={},Ey=typeof Map<"u";function T3(e,t,r){var n=0,s=e.length;if(r){if(Ey?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Ey?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Ey?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function f2(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(wi=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=av(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=qb(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Gh(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Mf(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Hu(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function AU(e,t,r,n,s,a){try{n.cellNF&&(e.z=Ar[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Yn(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ar[t]==null&&Hu(zie[t]||"General",t),e.t==="e")e.w=e.w||ld[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Qy(e.v);else if(e.t==="d"){var i=ma(e.v);(i|0)===i?e.w=i.toString(10):e.w=Qy(i)}else{if(e.v===void 0)return"";e.w=u0(e.v,dm)}else e.t==="d"?e.w=kl(t,ma(e.v),dm):e.w=kl(t,e.v,dm)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Kb(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Kb(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function Vhe(e,t,r){if(e&&e["!ref"]){var n=dn(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Khe(e,t){var r=dn(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Vr(r))}var qhe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Yhe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Xhe=/<(?:\w:)?hyperlink [^>]*>/mg,Jhe=/"(\w*:\w*)"/,Qhe=/<(?:\w:)?col\b[^>]*[\/]?>/g,Zhe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,e0e=/<(?:\w:)?pageMargins[^>]*\/>/g,jU=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,t0e=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,r0e=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function n0e(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",h=e.match(Yhe);h?(u=e.slice(0,h.index),d=e.slice(h.index+h[0].length)):u=d=e;var g=u.match(jU);g?E3(g[0],o,s,r):(g=u.match(t0e))&&a0e(g[0],g[1]||"",o,s,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=u.slice(p,p+50).match(Jhe);x&&Khe(o,x[1])}var v=u.match(r0e);v&&v[1]&&y0e(v[1],s);var w=[];if(t.cellStyles){var C=u.match(Qhe);C&&h0e(w,C)}h&&b0e(h[1],o,t,l,a,i);var k=d.match(Zhe);k&&(o["!autofilter"]=m0e(k[0]));var _=[],N=d.match(qhe);if(N)for(p=0;p!=N.length;++p)_[p]=dn(N[p].slice(N[p].indexOf('"')+1));var E=d.match(Xhe);E&&u0e(o,E,n);var P=d.match(e0e);if(P&&(o["!margins"]=d0e(Or(P[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Vr(l)),t.sheetRows>0&&o["!ref"]){var F=dn(o["!ref"]);t.sheetRows<=+F.e.r&&(F.e.r=t.sheetRows-1,F.e.r>l.e.r&&(F.e.r=l.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>l.e.c&&(F.e.c=l.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Vr(F))}return w.length>0&&(o["!cols"]=w),_.length>0&&(o["!merges"]=_),o}function s0e(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Vr(e[r])+'"/>';return t+"</mergeCells>"}function E3(e,t,r,n){var s=Or(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=un(Dn(s.codeName)))}function a0e(e,t,r,n,s){E3(e.slice(0,e.indexOf(">")),r,n,s)}function i0e(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}a=!0,i.codeName=Uc(Nn(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+qt("outlinePr",null,u)}!a&&!o||(s[s.length]=qt("sheetPr",o,i))}var o0e=["objects","scenarios","selectLockedCells","selectUnlockedCells"],l0e=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function c0e(e){var t={sheet:1};return o0e.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),l0e.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=w3(e.password).toString(16).toUpperCase()),qt("sheetProtection",null,t)}function u0e(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=Or(Dn(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+un(a.location))):(a.Target="#"+un(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=dn(a.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var d=Pr({c:u,r:l});n?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function d0e(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function f0e(e){return Gh(e),qt("pageMargins",null,e)}function h0e(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Or(t[n],!0);s.hidden&&(s.hidden=Vn(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,b3(s.width)),kf(s);a<=i;)e[a++]=Xn(s)}}function g0e(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=qt("col",null,f2(s,n)));return r[r.length]="</cols>",r.join("")}function m0e(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function p0e(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Vr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=yo(s);i.s.r==i.e.r&&(i.e.r=yo(t["!ref"]).e.r,s=Vr(i));for(var o=0;o<a.length;++o){var l=a[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),qt("autoFilter",null,{ref:s})}var x0e=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function y0e(e,t){t.Views||(t.Views=[{}]),(e.match(x0e)||[]).forEach(function(r,n){var s=Or(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Vn(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function v0e(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),qt("sheetViews",qt("sheetView",null,s),{})}function w0e(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=ld[e.v];break;case"d":n&&n.cellDates?s=Yn(e.v,-1).toISOString():(e=Xn(e),e.t="n",s=""+(e.v=ma(Yn(e.v)))),typeof e.z>"u"&&(e.z=Ar[14]);break;default:s=e.v;break}var o=ri("v",Nn(s)),l={r:t},u=Mf(n.cellXfs,e,n);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=ri("v",""+T3(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=qt("f",Nn(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),qt("c",o,l)}var b0e=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Zy("v"),i=Zy("f");return function(l,u,d,h,g,p){for(var x=0,v="",w=[],C=[],k=0,_=0,N=0,E="",P,F,A=0,j=0,R,U,Y=0,Z=0,ae=Array.isArray(p.CellXf),ee,ne=[],L=[],H=Array.isArray(u),M=[],V={},W=!1,I=!!d.sheetStubs,B=l.split(t),q=0,J=B.length;q!=J;++q){v=B[q].trim();var se=v.length;if(se!==0){var X=0;e:for(x=0;x<se;++x)switch(v[x]){case">":if(v[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(F=Or(v.slice(X,x),!0),A=F.r!=null?parseInt(F.r,10):A+1,j=-1,d.sheetRows&&d.sheetRows<A)continue;V={},W=!1,F.ht&&(W=!0,V.hpt=parseFloat(F.ht),V.hpx=Cm(V.hpt)),F.hidden=="1"&&(W=!0,V.hidden=!0),F.outlineLevel!=null&&(W=!0,V.level=+F.outlineLevel),W&&(M[A-1]=V)}break;case"<":X=x;break}if(X>=x)break;if(F=Or(v.slice(X,x),!0),A=F.r!=null?parseInt(F.r,10):A+1,j=-1,!(d.sheetRows&&d.sheetRows<A)){h.s.r>A-1&&(h.s.r=A-1),h.e.r<A-1&&(h.e.r=A-1),d&&d.cellStyles&&(V={},W=!1,F.ht&&(W=!0,V.hpt=parseFloat(F.ht),V.hpx=Cm(V.hpt)),F.hidden=="1"&&(W=!0,V.hidden=!0),F.outlineLevel!=null&&(W=!0,V.level=+F.outlineLevel),W&&(M[A-1]=V)),w=v.slice(x).split(e);for(var ie=0;ie!=w.length&&w[ie].trim().charAt(0)=="<";++ie);for(w=w.slice(ie),x=0;x!=w.length;++x)if(v=w[x].trim(),v.length!==0){if(C=v.match(r),k=x,_=0,N=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,C!=null&&C.length===2){for(k=0,E=C[1],_=0;_!=E.length&&!((N=E.charCodeAt(_)-64)<1||N>26);++_)k=26*k+N;--k,j=k}else++j;for(_=0;_!=v.length&&v.charCodeAt(_)!==62;++_);if(++_,F=Or(v.slice(0,_),!0),F.r||(F.r=Pr({r:A-1,c:j})),E=v.slice(_),P={t:""},(C=E.match(a))!=null&&C[1]!==""&&(P.v=un(C[1])),d.cellFormula){if((C=E.match(i))!=null&&C[1]!==""){if(P.f=un(Dn(C[1])).replace(/\r\n/g,`
`),d.xlfn||(P.f=_O(P.f)),C[0].indexOf('t="array"')>-1)P.F=(E.match(s)||[])[1],P.F.indexOf(":")>-1&&ne.push([dn(P.F),P.F]);else if(C[0].indexOf('t="shared"')>-1){U=Or(C[0]);var le=un(Dn(C[1]));d.xlfn||(le=_O(le)),L[parseInt(U.si,10)]=[U,le,F.r]}}else(C=E.match(/<f[^>]*\/>/))&&(U=Or(C[0]),L[U.si]&&(P.f=xfe(L[U.si][1],L[U.si][2],F.r)));var ce=hs(F.r);for(_=0;_<ne.length;++_)ce.r>=ne[_][0].s.r&&ce.r<=ne[_][0].e.r&&ce.c>=ne[_][0].s.c&&ce.c<=ne[_][0].e.c&&(P.F=ne[_][1])}if(F.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(I)P.t="z";else continue;else P.t=F.t||"n";switch(h.s.c>j&&(h.s.c=j),h.e.c<j&&(h.e.c=j),P.t){case"n":if(P.v==""||P.v==null){if(!I)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!I)continue;P.t="z"}else R=Ty[parseInt(P.v,10)],P.v=R.t,P.r=R.r,d.cellHTML&&(P.h=R.h);break;case"str":P.t="s",P.v=P.v!=null?Dn(P.v):"",d.cellHTML&&(P.h=a3(P.v));break;case"inlineStr":C=E.match(n),P.t="s",C!=null&&(R=v3(C[1]))?(P.v=R.t,d.cellHTML&&(P.h=R.h)):P.v="";break;case"b":P.v=Vn(P.v);break;case"d":d.cellDates?P.v=Yn(P.v,1):(P.v=ma(Yn(P.v,1)),P.t="n");break;case"e":(!d||d.cellText!==!1)&&(P.w=P.v),P.v=F$[P.v];break}if(Y=Z=0,ee=null,ae&&F.s!==void 0&&(ee=p.CellXf[F.s],ee!=null&&(ee.numFmtId!=null&&(Y=ee.numFmtId),d.cellStyles&&ee.fillId!=null&&(Z=ee.fillId))),AU(P,Y,Z,d,g,p),d.cellDates&&ae&&P.t=="n"&&Xm(Ar[Y])&&(P.t="d",P.v=l2(P.v)),F.cm&&d.xlmeta){var ke=(d.xlmeta.Cell||[])[+F.cm-1];ke&&ke.type=="XLDAPR"&&(P.D=!0)}if(H){var re=hs(F.r);u[re.r]||(u[re.r]=[]),u[re.r][re.c]=P}else u[F.r]=P}}}}M.length>0&&(u["!rows"]=M)}})();function _0e(e,t,r,n){var s=[],a=[],i=dn(e["!ref"]),o="",l,u="",d=[],h=0,g=0,p=e["!rows"],x=Array.isArray(e),v={r:u},w,C=-1;for(g=i.s.c;g<=i.e.c;++g)d[g]=fs(g);for(h=i.s.r;h<=i.e.r;++h){for(a=[],u=Us(h),g=i.s.c;g<=i.e.c;++g){l=d[g]+u;var k=x?(e[h]||[])[g]:e[l];k!==void 0&&(o=w0e(k,l,e,t))!=null&&a.push(o)}(a.length>0||p&&p[h])&&(v={r:u},p&&p[h]&&(w=p[h],w.hidden&&(v.hidden=1),C=-1,w.hpx?C=iv(w.hpx):w.hpt&&(C=w.hpt),C>-1&&(v.ht=C,v.customHeight=1),w.level&&(v.outlineLevel=w.level)),s[s.length]=qt("row",a.join(""),v))}if(p)for(;h<p.length;++h)p&&p[h]&&(v={r:h+1},w=p[h],w.hidden&&(v.hidden=1),C=-1,w.hpx?C=iv(w.hpx):w.hpt&&(C=w.hpt),C>-1&&(v.ht=C,v.customHeight=1),w.level&&(v.outlineLevel=w.level),s[s.length]=qt("row","",v));return s.join("")}function PU(e,t,r,n){var s=[Ws,qt("worksheet",null,{xmlns:T0[0],"xmlns:r":ha.r})],a=r.SheetNames[e],i=0,o="",l=r.Sheets[a];l==null&&(l={});var u=l["!ref"]||"A1",d=dn(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Vr(d)}n||(n={}),l["!comments"]=[];var h=[];i0e(l,r,e,t,s),s[s.length]=qt("dimension",null,{ref:u}),s[s.length]=v0e(l,t,e,r),t.sheetFormat&&(s[s.length]=qt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(s[s.length]=g0e(l,l["!cols"])),s[i=s.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=_0e(l,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),l["!protect"]&&(s[s.length]=c0e(l["!protect"])),l["!autofilter"]!=null&&(s[s.length]=p0e(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(s[s.length]=s0e(l["!merges"]));var g=-1,p,x=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(v){v[1].Target&&(p={ref:v[0]},v[1].Target.charAt(0)!="#"&&(x=Tn(n,-1,Nn(v[1].Target).replace(/#.*$/,""),en.HLINK),p["r:id"]="rId"+x),(g=v[1].Target.indexOf("#"))>-1&&(p.location=Nn(v[1].Target.slice(g+1))),v[1].Tooltip&&(p.tooltip=Nn(v[1].Tooltip)),s[s.length]=qt("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(s[s.length]=f0e(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=ri("ignoredErrors",qt("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(x=Tn(n,-1,"../drawings/drawing"+(e+1)+".xml",en.DRAW),s[s.length]=qt("drawing",null,{"r:id":"rId"+x}),l["!drawing"]=h),l["!comments"].length>0&&(x=Tn(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",en.VML),s[s.length]=qt("legacyDrawing",null,{"r:id":"rId"+x}),l["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function S0e(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function k0e(e,t,r){var n=_t(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=iv(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var h=-1,g=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Pr(u)];x&&(h<0&&(h=p),g=p)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,g))}var v=n.l;return n.l=l,n.write_shift(4,o),n.l=v,n.length>n.l?n.slice(0,n.l):n}function C0e(e,t,r,n){var s=k0e(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&Ot(e,0,s)}var T0e=j0,E0e=Zm;function N0e(){}function A0e(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Foe(e),r}function j0e(e,t,r){r==null&&(r=_t(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return Hb({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),E$(e,r),r.slice(0,r.l)}function P0e(e){var t=Al(e);return[t]}function F0e(e,t,r){return r==null&&(r=_t(8)),E0(t,r)}function O0e(e){var t=N0(e);return[t]}function D0e(e,t,r){return r==null&&(r=_t(4)),A0(t,r)}function R0e(e){var t=Al(e),r=e.read_shift(1);return[t,r,"b"]}function I0e(e,t,r){return r==null&&(r=_t(9)),E0(t,r),r.write_shift(1,e.v?1:0),r}function M0e(e){var t=N0(e),r=e.read_shift(1);return[t,r,"b"]}function L0e(e,t,r){return r==null&&(r=_t(5)),A0(t,r),r.write_shift(1,e.v?1:0),r}function B0e(e){var t=Al(e),r=e.read_shift(1);return[t,r,"e"]}function $0e(e,t,r){return r==null&&(r=_t(9)),E0(t,r),r.write_shift(1,e.v),r}function U0e(e){var t=N0(e),r=e.read_shift(1);return[t,r,"e"]}function z0e(e,t,r){return r==null&&(r=_t(8)),A0(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function W0e(e){var t=Al(e),r=e.read_shift(4);return[t,r,"s"]}function H0e(e,t,r){return r==null&&(r=_t(12)),E0(t,r),r.write_shift(4,t.v),r}function G0e(e){var t=N0(e),r=e.read_shift(4);return[t,r,"s"]}function V0e(e,t,r){return r==null&&(r=_t(8)),A0(t,r),r.write_shift(4,t.v),r}function K0e(e){var t=Al(e),r=_i(e);return[t,r,"n"]}function q0e(e,t,r){return r==null&&(r=_t(16)),E0(t,r),f0(e.v,r),r}function FU(e){var t=N0(e),r=_i(e);return[t,r,"n"]}function Y0e(e,t,r){return r==null&&(r=_t(12)),A0(t,r),f0(e.v,r),r}function X0e(e){var t=Al(e),r=g3(e);return[t,r,"n"]}function J0e(e,t,r){return r==null&&(r=_t(12)),E0(t,r),N$(e.v,r),r}function Q0e(e){var t=N0(e),r=g3(e);return[t,r,"n"]}function Z0e(e,t,r){return r==null&&(r=_t(8)),A0(t,r),N$(e.v,r),r}function ege(e){var t=Al(e),r=d3(e);return[t,r,"is"]}function tge(e){var t=Al(e),r=Ti(e);return[t,r,"str"]}function rge(e,t,r){return r==null&&(r=_t(12+4*e.v.length)),E0(t,r),Fa(e.v,r),r.length>r.l?r.slice(0,r.l):r}function nge(e){var t=N0(e),r=Ti(e);return[t,r,"str"]}function sge(e,t,r){return r==null&&(r=_t(8+4*e.v.length)),A0(t,r),Fa(e.v,r),r.length>r.l?r.slice(0,r.l):r}function age(e,t,r){var n=e.l+t,s=Al(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=d2(e,n-e.l,r);i[3]=vi(o,null,s,r.supbooks,r)}else e.l=n;return i}function ige(e,t,r){var n=e.l+t,s=Al(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=d2(e,n-e.l,r);i[3]=vi(o,null,s,r.supbooks,r)}else e.l=n;return i}function oge(e,t,r){var n=e.l+t,s=Al(e);s.r=r["!row"];var a=_i(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=d2(e,n-e.l,r);i[3]=vi(o,null,s,r.supbooks,r)}else e.l=n;return i}function lge(e,t,r){var n=e.l+t,s=Al(e);s.r=r["!row"];var a=Ti(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=d2(e,n-e.l,r);i[3]=vi(o,null,s,r.supbooks,r)}else e.l=n;return i}var cge=j0,uge=Zm;function dge(e,t){return t==null&&(t=_t(4)),t.write_shift(4,e),t}function fge(e,t){var r=e.l+t,n=j0(e),s=f3(e),a=Ti(e),i=Ti(e),o=Ti(e);e.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function hge(e,t){var r=_t(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Zm({s:hs(e[0]),e:hs(e[0])},r),h3("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Fa(s||"",r),Fa(e[1].Tooltip||"",r),Fa("",r),r.slice(0,r.l)}function gge(){}function mge(e,t,r){var n=e.l+t,s=A$(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=Bhe(e,n-e.l,r);i[1]=o}else e.l=n;return i}function pge(e,t,r){var n=e.l+t,s=j0(e),a=[s];if(r.cellFormula){var i=Uhe(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function xge(e,t,r){r==null&&(r=_t(18));var n=f2(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var OU=["left","right","top","bottom","header","footer"];function yge(e){var t={};return OU.forEach(function(r){t[r]=_i(e)}),t}function vge(e,t){return t==null&&(t=_t(48)),Gh(e),OU.forEach(function(r){f0(e[r],t)}),t}function wge(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function bge(e,t,r){r==null&&(r=_t(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function _ge(e){var t=_t(24);return t.write_shift(4,4),t.write_shift(4,1),Zm(e,t),t}function Sge(e,t){return t==null&&(t=_t(66)),t.write_shift(2,e.password?w3(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function kge(){}function Cge(){}function Tge(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,g=!1,p,x,v,w,C,k,_,N,E,P=[];o.biff=12,o["!row"]=0;var F=0,A=!1,j=[],R={},U=o.supbooks||s.supbooks||[[]];if(U.sharedf=R,U.arrayf=j,U.SheetNames=s.SheetNames||s.Sheets.map(function(H){return H.name}),!o.supbooks&&(o.supbooks=U,s.Names))for(var Y=0;Y<s.Names.length;++Y)U[0][Y+1]=s.Names[Y];var Z=[],ae=[],ee=!1;ov[16]={n:"BrtShortReal",f:FU};var ne;if(od(e,function(M,V,W){if(!g)switch(W){case 148:u=M;break;case 0:p=M,o.sheetRows&&o.sheetRows<=p.r&&(g=!0),N=Us(w=p.r),o["!row"]=p.r,(M.hidden||M.hpt||M.level!=null)&&(M.hpt&&(M.hpx=Cm(M.hpt)),ae[M.r]=M);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:M[2]},M[2]){case"n":x.v=M[1];break;case"s":_=Ty[M[1]],x.v=_.t,x.r=_.r;break;case"b":x.v=!!M[1];break;case"e":x.v=M[1],o.cellText!==!1&&(x.w=ld[x.v]);break;case"str":x.t="s",x.v=M[1];break;case"is":x.t="s",x.v=M[1].t;break}if((v=i.CellXf[M[0].iStyleRef])&&AU(x,v.numFmtId,null,o,a,i),C=M[0].c==-1?C+1:M[0].c,o.dense?(l[w]||(l[w]=[]),l[w][C]=x):l[fs(C)+N]=x,o.cellFormula){for(A=!1,F=0;F<j.length;++F){var I=j[F];p.r>=I[0].s.r&&p.r<=I[0].e.r&&C>=I[0].s.c&&C<=I[0].e.c&&(x.F=Vr(I[0]),A=!0)}!A&&M.length>3&&(x.f=M[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>C&&(d.s.c=C),d.e.r<p.r&&(d.e.r=p.r),d.e.c<C&&(d.e.c=C),o.cellDates&&v&&x.t=="n"&&Xm(Ar[v.numFmtId])){var B=Ph(x.v);B&&(x.t="d",x.v=new Date(B.y,B.m-1,B.d,B.H,B.M,B.S,B.u))}ne&&(ne.type=="XLDAPR"&&(x.D=!0),ne=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;x={t:"z",v:void 0},C=M[0].c==-1?C+1:M[0].c,o.dense?(l[w]||(l[w]=[]),l[w][C]=x):l[fs(C)+N]=x,d.s.r>p.r&&(d.s.r=p.r),d.s.c>C&&(d.s.c=C),d.e.r<p.r&&(d.e.r=p.r),d.e.c<C&&(d.e.c=C),ne&&(ne.type=="XLDAPR"&&(x.D=!0),ne=void 0);break;case 176:P.push(M);break;case 49:ne=((o.xlmeta||{}).Cell||[])[M-1];break;case 494:var q=n["!id"][M.relId];for(q?(M.Target=q.Target,M.loc&&(M.Target+="#"+M.loc),M.Rel=q):M.relId==""&&(M.Target="#"+M.loc),w=M.rfx.s.r;w<=M.rfx.e.r;++w)for(C=M.rfx.s.c;C<=M.rfx.e.c;++C)o.dense?(l[w]||(l[w]=[]),l[w][C]||(l[w][C]={t:"z",v:void 0}),l[w][C].l=M):(k=Pr({c:C,r:w}),l[k]||(l[k]={t:"z",v:void 0}),l[k].l=M);break;case 426:if(!o.cellFormula)break;j.push(M),E=o.dense?l[w][C]:l[fs(C)+N],E.f=vi(M[1],d,{r:p.r,c:C},U,o),E.F=Vr(M[0]);break;case 427:if(!o.cellFormula)break;R[Pr(M[0].s)]=M[1],E=o.dense?l[w][C]:l[fs(C)+N],E.f=vi(M[1],d,{r:p.r,c:C},U,o);break;case 60:if(!o.cellStyles)break;for(;M.e>=M.s;)Z[M.e--]={width:M.w/256,hidden:!!(M.flags&1),level:M.level},ee||(ee=!0,b3(M.w/256)),kf(Z[M.e+1]);break;case 161:l["!autofilter"]={ref:Vr(M)};break;case 476:l["!margins"]=M;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),M.name&&(s.Sheets[r].CodeName=M.name),(M.above||M.left)&&(l["!outline"]={above:M.above,left:M.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),M.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!V.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+W.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=Vr(u||d)),o.sheetRows&&l["!ref"]){var L=dn(l["!ref"]);o.sheetRows<=+L.e.r&&(L.e.r=o.sheetRows-1,L.e.r>d.e.r&&(L.e.r=d.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>d.e.c&&(L.e.c=d.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Vr(L))}return P.length>0&&(l["!merges"]=P),Z.length>0&&(l["!cols"]=Z),ae.length>0&&(l["!rows"]=ae),l}function Ege(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Xn(t),t.z=t.z||Ar[14],t.v=ma(Yn(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Mf(s.cellXfs,t,s),t.l&&a["!links"].push([Pr(l),t.l]),t.c&&a["!comments"].push([Pr(l),t.c]),t.t){case"s":case"str":return s.bookSST?(o=T3(s.Strings,t.v,s.revStrings),l.t="s",l.v=o,i?Ot(e,18,V0e(t,l)):Ot(e,7,H0e(t,l))):(l.t="str",i?Ot(e,17,sge(t,l)):Ot(e,6,rge(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?Ot(e,13,Z0e(t,l)):Ot(e,2,J0e(t,l)):i?Ot(e,16,Y0e(t,l)):Ot(e,5,q0e(t,l)),!0;case"b":return l.t="b",i?Ot(e,15,L0e(t,l)):Ot(e,4,I0e(t,l)),!0;case"e":return l.t="e",i?Ot(e,14,z0e(t,l)):Ot(e,3,$0e(t,l)),!0}return i?Ot(e,12,D0e(t,l)):Ot(e,1,F0e(t,l)),!0}function Nge(e,t,r,n){var s=dn(t["!ref"]||"A1"),a,i="",o=[];Ot(e,145);var l=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){i=Us(d),C0e(e,t,s,d);var h=!1;if(d<=s.e.r)for(var g=s.s.c;g<=s.e.c;++g){d===s.s.r&&(o[g]=fs(g)),a=o[g]+i;var p=l?(t[d]||[])[g]:t[a];if(!p){h=!1;continue}h=Ege(e,p,d,g,n,t,h)}}Ot(e,146)}function Age(e,t){!t||!t["!merges"]||(Ot(e,177,dge(t["!merges"].length)),t["!merges"].forEach(function(r){Ot(e,176,uge(r))}),Ot(e,178))}function jge(e,t){!t||!t["!cols"]||(Ot(e,390),t["!cols"].forEach(function(r,n){r&&Ot(e,60,xge(n,r))}),Ot(e,391))}function Pge(e,t){!t||!t["!ref"]||(Ot(e,648),Ot(e,649,_ge(dn(t["!ref"]))),Ot(e,650))}function Fge(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Tn(r,-1,n[1].Target.replace(/#.*$/,""),en.HLINK);Ot(e,494,hge(n,s))}}),delete t["!links"]}function Oge(e,t,r,n){if(t["!comments"].length>0){var s=Tn(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",en.VML);Ot(e,551,h3("rId"+s)),t["!legacy"]=s}}function Dge(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Vr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=yo(a);o.s.r==o.e.r&&(o.e.r=yo(t["!ref"]).e.r,a=Vr(o));for(var l=0;l<i.length;++l){var u=i[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ot(e,161,Zm(dn(a))),Ot(e,162)}}function Rge(e,t,r){Ot(e,133),Ot(e,137,bge(t,r)),Ot(e,138),Ot(e,134)}function Ige(e,t){t["!protect"]&&Ot(e,535,Sge(t["!protect"]))}function Mge(e,t,r,n){var s=xo(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=dn(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Ot(s,129),(r.vbaraw||i["!outline"])&&Ot(s,147,j0e(o,i["!outline"])),Ot(s,148,E0e(l)),Rge(s,i,r.Workbook),jge(s,i),Nge(s,i,e,t),Ige(s,i),Dge(s,i,r,e),Age(s,i),Fge(s,i,n),i["!margins"]&&Ot(s,476,vge(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Pge(s,i),Oge(s,i,e,n),Ot(s,130),s.end()}function Lge(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=un((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function Bge(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,l=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var g=Lge(h);d.s.r=d.s.c=0,d.e.c=o,u=fs(o),g[0].forEach(function(p,x){i[u+Us(x)]={t:"n",v:p,z:g[1]},l=x}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(i["!ref"]=Vr(d)),i}function $ge(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(jU);return o&&E3(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function Uge(e,t){e.l+=10;var r=Ti(e);return{name:r}}function zge(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return od(e,function(l,u,d){switch(d){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var N3=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Wge=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Hge=[],Gge=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function EO(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Vn(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function NO(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Vn(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function DU(e){NO(e.WBProps,N3),NO(e.CalcPr,Gge),EO(e.WBView,Wge),EO(e.Sheets,Hge),dm.date1904=Vn(e.WBProps.date1904)}function Vge(e){return!e.Workbook||!e.Workbook.WBProps?"false":Vn(e.Workbook.WBProps.date1904)?"true":"false"}var Kge="][*?/\\".split("");function RU(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Kge.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function qge(e,t,r){e.forEach(function(n,s){RU(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function Yge(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];qge(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Vhe(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Xge=/<\w+:workbook/;function Jge(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(Ai,function(l,u){var d=Or(l);switch(Zc(d[0])){case"<?xml":break;case"<workbook":l.match(Xge)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":N3.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Vn(d[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:r.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(r.WBProps.CodeName=Dn(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=un(Dn(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Dn(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Vn(d.hidden||"0")&&(a.Hidden=!0),i=u+l.length;break;case"</definedName>":a.Ref=un(Dn(e.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),T0.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return DU(r),r}function IU(e){var t=[Ws];t[t.length]=qt("workbook",null,{xmlns:T0[0],"xmlns:r":ha.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(N3.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=qt("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:Nn(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=qt("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=qt("definedName",Nn(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Qge(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=fE(e),r.name=Ti(e),r}function Zge(e,t){return t||(t=_t(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),h3(e.strRelID,t),Fa(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function eme(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Ti(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function tme(e,t){t||(t=_t(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),E$(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function rme(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function nme(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=Ooe(e),i=$he(e,0,r),o=f3(e);e.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function sme(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],ov[16]={n:"BrtFRTArchID$",f:rme},od(e,function(l,u,d){switch(d){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=vi(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,l]):i[0]=[d,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),DU(r),r.Names=a,r.supbooks=i,r}function ame(e,t){Ot(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ot(e,156,Zge(s))}Ot(e,144)}function ime(e,t){t||(t=_t(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Fa("SheetJS",t),Fa(Mb.version,t),Fa(Mb.version,t),Fa("7262",t),t.length>t.l?t.slice(0,t.l):t}function ome(e,t){t||(t=_t(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function lme(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(Ot(e,135),Ot(e,158,ome(s)),Ot(e,136))}}function cme(e,t){var r=xo();return Ot(r,131),Ot(r,128,ime()),Ot(r,153,tme(e.Workbook&&e.Workbook.WBProps||null)),lme(r,e),ame(r,e),Ot(r,132),r.end()}function ume(e,t,r){return t.slice(-4)===".bin"?sme(e,r):Jge(e,r)}function dme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?Tge(e,n,r,s,a,i,o):n0e(e,n,r,s,a,i,o)}function fme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?zge(e,n,r,s,a):$ge(e,n,r,s,a)}function hme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?mfe():pfe()}function gme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?hfe():gfe()}function mme(e,t,r,n){return t.slice(-4)===".bin"?ude(e,r,n):Que(e,r,n)}function pme(e,t,r){return pU(e,r)}function xme(e,t,r){return t.slice(-4)===".bin"?xue(e,r):gue(e,r)}function yme(e,t,r){return t.slice(-4)===".bin"?lfe(e,r):Zde(e,r)}function vme(e,t,r){return t.slice(-4)===".bin"?Xde(e):qde(e)}function wme(e,t,r,n){return r.slice(-4)===".bin"?Jde(e,t,r,n):void 0}function bme(e,t,r){return t.slice(-4)===".bin"?Gde(e,t,r):Kde(e,t,r)}function _me(e,t,r){return(t.slice(-4)===".bin"?cme:IU)(e)}function Sme(e,t,r,n,s){return(t.slice(-4)===".bin"?Mge:PU)(e,r,n,s)}function kme(e,t,r){return(t.slice(-4)===".bin"?wde:gU)(e,r)}function Cme(e,t,r){return(t.slice(-4)===".bin"?wue:iU)(e,r)}function Tme(e,t,r){return(t.slice(-4)===".bin"?cfe:vU)(e)}function Eme(e){return(e.slice(-4)===".bin"?Vde:xU)()}var MU=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,LU=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ql(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(MU),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(LU),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function Nme(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(MU),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(LU),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var Ny;function Ame(e,t){var r=Ny[e]||un(e);return r==="General"?u0(t):kl(r,t)}function jme(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Vn(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Yn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[un(t)]=s}function Pme(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ld[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Qy(e.v):e.w=u0(e.v):e.w=Ame(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=Ny[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Xm(n)){var s=Ph(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function Fme(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Hue[n.Pattern]||n.Pattern)}e[t.ID]=t}function Ome(e,t,r,n,s,a,i,o,l,u){var d="General",h=n.StyleID,g={};u=u||{};var p=[],x=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&i&&(h=i.StyleID);a[h]!==void 0&&(a[h].nf&&(d=a[h].nf),a[h].Interior&&p.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Vn(e);break;case"String":n.t="s",n.r=GF(un(e)),n.v=e.indexOf("<")>-1?un(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Yn(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=un(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=F$[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=GF(t||e));break}if(Pme(n,d,u),u.cellFormula!==!1)if(n.Formula){var v=un(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=um(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=um("RC:RC",s):n.ArrayRange&&(n.F=um(n.ArrayRange,s),l.push([dn(n.F),n.F]))}else for(x=0;x<l.length;++x)s.r>=l[x][0].s.r&&s.r<=l[x][0].e.r&&s.c>=l[x][0].s.c&&s.c<=l[x][0].e.c&&(n.F=l[x][1]);u.cellStyles&&(p.forEach(function(w){!g.patternType&&w.patternType&&(g.patternType=w.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Dme(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Ek(e,t){var r=t||{};Jm();var n=oy(i3(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Dn(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Xn(r);return i.type="string",km.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(It){s.indexOf("<"+It)>=0&&(a=!0)}),a)return vpe(n,r);Ny={"General Number":"General","General Date":Ar[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ar[15],"Short Date":Ar[14],"Long Time":Ar[19],"Medium Time":Ar[18],"Short Time":Ar[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ar[2],Standard:Ar[4],Percent:Ar[10],Scientific:Ar[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,d={},h=[],g=r.dense?[]:{},p="",x={},v={},w=ql('<Data ss:Type="String">'),C=0,k=0,_=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},P={},F="",A=0,j=[],R={},U={},Y=0,Z=[],ae=[],ee={},ne=[],L,H=!1,M=[],V=[],W={},I=0,B=0,q={Sheets:[],WBProps:{date1904:!1}},J={};tv.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var se="";o=tv.exec(n);)switch(o[3]=(se=o[3]).toLowerCase()){case"data":if(se=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?Ome(n.slice(C,o.index),F,w,l[l.length-1][0]=="comment"?ee:x,{c:k,r:_},E,ne[k],v,M,r):(F="",w=ql(o[0]),C=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ae.length>0&&(x.c=ae),(!r.sheetRows||r.sheetRows>_)&&x.v!==void 0&&(r.dense?(g[_]||(g[_]=[]),g[_][k]=x):g[fs(k)+Us(_)]=x),x.HRef&&(x.l={Target:un(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(I=k+(parseInt(x.MergeAcross,10)|0),B=_+(parseInt(x.MergeDown,10)|0),j.push({s:{c:k,r:_},e:{c:I,r:B}})),!r.sheetStubs)x.MergeAcross?k=I+1:++k;else if(x.MergeAcross||x.MergeDown){for(var X=k;X<=I;++X)for(var ie=_;ie<=B;++ie)(X>k||ie>_)&&(r.dense?(g[ie]||(g[ie]=[]),g[ie][X]={t:"z"}):g[fs(X)+Us(ie)]={t:"z"});k=I+1}else++k;else x=Nme(o[0]),x.Index&&(k=+x.Index-1),k<N.s.c&&(N.s.c=k),k>N.e.c&&(N.e.c=k),o[0].slice(-2)==="/>"&&++k,ae=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<N.s.r&&(N.s.r=_),_>N.e.r&&(N.e.r=_),o[0].slice(-2)==="/>"&&(v=ql(o[0]),v.Index&&(_=+v.Index-1)),k=0,++_):(v=ql(o[0]),v.Index&&(_=+v.Index-1),W={},(v.AutoFitHeight=="0"||v.Height)&&(W.hpx=parseInt(v.Height,10),W.hpt=iv(W.hpx),V[_]=W),v.Hidden=="1"&&(W.hidden=!0,V[_]=W));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));h.push(p),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(g["!ref"]=Vr(N),r.sheetRows&&r.sheetRows<=N.e.r&&(g["!fullref"]=g["!ref"],N.e.r=r.sheetRows-1,g["!ref"]=Vr(N))),j.length&&(g["!merges"]=j),ne.length>0&&(g["!cols"]=ne),V.length>0&&(g["!rows"]=V),d[p]=g}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=k=0,l.push([o[3],!1]),u=ql(o[0]),p=un(u.Name),g=r.dense?[]:{},j=[],M=[],V=[],J={name:p,Hidden:0},q.Sheets.push(J);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ne=[],H=!1}break;case"style":o[1]==="/"?Fme(E,P,r):P=ql(o[0]);break;case"numberformat":P.nf=un(ql(o[0]).Format||"General"),Ny[P.nf]&&(P.nf=Ny[P.nf]);for(var le=0;le!=392&&Ar[le]!=P.nf;++le);if(le==392){for(le=57;le!=392;++le)if(Ar[le]==null){Hu(P.nf,le);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(L=ql(o[0]),L.Hidden&&(L.hidden=!0,delete L.Hidden),L.Width&&(L.wpx=parseInt(L.Width,10)),!H&&L.wpx>10){H=!0,wi=fU;for(var ce=0;ce<ne.length;++ce)ne[ce]&&kf(ne[ce])}H&&kf(L),ne[L.Index-1||ne.length]=L;for(var ke=0;ke<+L.Span;++ke)ne[ne.length]=Xn(L);break;case"namedrange":if(o[1]==="/")break;q.Names||(q.Names=[]);var re=Or(o[0]),ge={Name:re.Name,Ref:um(re.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(ge.Sheet=q.Sheets.length-1),q.Names.push(ge);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?F+=n.slice(A,o.index):A=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;P.Interior=ql(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?sle(R,se,n.slice(Y,o.index)):Y=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));Dme(ee),ae.push(ee)}else l.push([o[3],!1]),u=ql(o[0]),ee={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ne=ql(o[0]);g["!autofilter"]={ref:um(Ne.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return OO(n,r);var je=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:je=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:je=!1}break;case"excelworkbook":switch(o[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:je=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:je=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(Y,o.index)){case"SheetHidden":J.Hidden=1;break;case"SheetVeryHidden":J.Hidden=2;break}else Y=o.index+o[0].length;break;case"header":g["!margins"]||Gh(g["!margins"]={},"xlml"),isNaN(+Or(o[0]).Margin)||(g["!margins"].header=+Or(o[0]).Margin);break;case"footer":g["!margins"]||Gh(g["!margins"]={},"xlml"),isNaN(+Or(o[0]).Margin)||(g["!margins"].footer=+Or(o[0]).Margin);break;case"pagemargins":var Ke=Or(o[0]);g["!margins"]||Gh(g["!margins"]={},"xlml"),isNaN(+Ke.Top)||(g["!margins"].top=+Ke.Top),isNaN(+Ke.Left)||(g["!margins"].left=+Ke.Left),isNaN(+Ke.Right)||(g["!margins"].right=+Ke.Right),isNaN(+Ke.Bottom)||(g["!margins"].bottom=+Ke.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:je=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:je=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:je=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:je=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:je=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:je=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:je=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:je=!1}break;case"smarttags":break;default:je=!1;break}if(je||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?jme(U,se,Z,n.slice(Y,o.index)):(Z=o,Y=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Ue={};return!r.bookSheets&&!r.bookProps&&(Ue.Sheets=d),Ue.SheetNames=h,Ue.Workbook=q,Ue.SSF=Xn(Ar),Ue.Props=R,Ue.Custprops=U,Ue}function vE(e,t){switch(j3(t=t||{}),t.type||"base64"){case"base64":return Ek(Uo(e),t);case"binary":case"buffer":case"file":return Ek(e,t);case"array":return Ek(Rf(e),t)}}function Rme(e,t){var r=[];return e.Props&&r.push(ale(e.Props,t)),e.Custprops&&r.push(ile(e.Props,e.Custprops)),r.join("")}function Ime(){return""}function Mme(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(qt("NumberFormat",null,{"ss:Format":Nn(Ar[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(qt("Style",a.join(""),i))}),qt("Styles",r.join(""))}function BU(e){return qt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+k3(e.Ref,{r:0,c:0})})}function Lme(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(BU(s)))}return qt("Names",r.join(""))}function Bme(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(BU(o)))}return a.join("")}function $me(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(qt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(qt("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(qt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(qt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(ri("ProtectContents","True")),e["!protect"].objects&&s.push(ri("ProtectObjects","True")),e["!protect"].scenarios&&s.push(ri("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(ri("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(ri("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":qt("WorksheetOptions",s.join(""),{xmlns:Oo.x})}function Ume(e){return e.map(function(t){var r=loe(t.t||""),n=qt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return qt("Comment",n,{"ss:Author":t.a})}).join("")}function zme(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Nn(k3(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=hs(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Nn(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Nn(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var h="",g="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",g=String(e.v);break;case"b":h="Boolean",g=e.v?"1":"0";break;case"e":h="Error",g=ld[e.v];break;case"d":h="DateTime",g=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ar[14]);break;case"s":h="String",g=ooe(e.v||"");break}var p=Mf(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=i.c+1;var x=e.v!=null?g:"",v=e.t=="z"?"":'<Data ss:Type="'+h+'">'+x+"</Data>";return(e.c||[]).length>0&&(v+=Ume(e.c)),qt("Cell",v,o)}function Wme(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Cm(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Hme(e,t,r,n){if(!e["!ref"])return"";var s=dn(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(w,C){kf(w);var k=!!w.width,_=f2(C,w),N={"ss:Index":C+1};k&&(N["ss:Width"]=sv(_.width)),w.hidden&&(N["ss:Hidden"]="1"),o.push(qt("Column",null,N))});for(var l=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[Wme(u,(e["!rows"]||[])[u])],h=s.s.c;h<=s.e.c;++h){var g=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>h)&&!(a[i].s.r>u)&&!(a[i].e.c<h)&&!(a[i].e.r<u)){(a[i].s.c!=h||a[i].s.r!=u)&&(g=!0);break}if(!g){var p={r:u,c:h},x=Pr(p),v=l?(e[u]||[])[h]:e[x];d.push(zme(v,x,e,t,r,n,p))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function Gme(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?Bme(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?Hme(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push($me(a,t,e,r)),n.join("")}function Vme(e,t){t||(t={}),e.SSF||(e.SSF=Xn(Ar)),e.SSF&&(Jm(),a2(e.SSF),t.revssf=o2(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Mf(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Rme(e,t)),r.push(Ime()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(qt("Worksheet",Gme(n,t,e),{"ss:Name":Nn(e.SheetNames[n])}));return r[2]=Mme(e,t),r[3]=Lme(e),Ws+qt("Workbook",r.join(""),{xmlns:Oo.ss,"xmlns:o":Oo.o,"xmlns:x":Oo.x,"xmlns:ss":Oo.ss,"xmlns:dt":Oo.dt,"xmlns:html":Oo.html})}function Kme(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Loe(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Boe(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var qme=[60,1084,2066,2165,2175];function Yme(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=Bu(r,r.l),u=wE[l],d=0;u!=null&&qme.indexOf(l)>-1;)a=Bu(r,r.l+2),d=r.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),o=r.slice(d,r.l+4+a),i.push(o),r.l+=4+a,u=wE[l=Bu(r,r.l)];var h=ja(i);Za(h,0);var g=0;h.lens=[];for(var p=0;p<i.length;++p)h.lens.push(g),g+=i[p].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,s)}function Oc(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ar[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ld[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Qy(e.v):e.w=u0(e.v):e.w=kl(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Xm(Ar[n]||String(n))){var s=Ph(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Ow(e,t,r){return{v:e,ixfe:t,t:r}}function Xme(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,l=[],u="",d={},h,g="",p,x,v,w,C={},k=[],_,N,E=[],P=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},j=function(We){return We<8?zh[We]:We<64&&P[We-8]||zh[We]},R=function(We,nt,Tt){var jt=nt.XF.data;if(!(!jt||!jt.patternType||!Tt||!Tt.cellStyles)){nt.s={},nt.s.patternType=jt.patternType;var Vt;(Vt=nv(j(jt.icvFore)))&&(nt.s.fgColor={rgb:Vt}),(Vt=nv(j(jt.icvBack)))&&(nt.s.bgColor={rgb:Vt})}},U=function(We,nt,Tt){if(!(W>1)&&!(Tt.sheetRows&&We.r>=Tt.sheetRows)){if(Tt.cellStyles&&nt.XF&&nt.XF.data&&R(We,nt,Tt),delete nt.ixfe,delete nt.XF,h=We,g=Pr(We),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),We.r<i.s.r&&(i.s.r=We.r),We.c<i.s.c&&(i.s.c=We.c),We.r+1>i.e.r&&(i.e.r=We.r+1),We.c+1>i.e.c&&(i.e.c=We.c+1),Tt.cellFormula&&nt.f){for(var jt=0;jt<k.length;++jt)if(!(k[jt][0].s.c>We.c||k[jt][0].s.r>We.r)&&!(k[jt][0].e.c<We.c||k[jt][0].e.r<We.r)){nt.F=Vr(k[jt][0]),(k[jt][0].s.c!=We.c||k[jt][0].s.r!=We.r)&&delete nt.f,nt.f&&(nt.f=""+vi(k[jt][1],i,We,M,Y));break}}Tt.dense?(s[We.r]||(s[We.r]=[]),s[We.r][We.c]=nt):s[g]=nt}},Y={enc:!1,sbcch:0,snames:[],sharedf:C,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Y.password=t.password);var Z,ae=[],ee=[],ne=[],L=[],H=!1,M=[];M.SheetNames=Y.snames,M.sharedf=Y.sharedf,M.arrayf=Y.arrayf,M.names=[],M.XTI=[];var V=0,W=0,I=0,B=[],q=[],J;Y.codepage=1200,ec(1200);for(var se=!1;e.l<e.length-1;){var X=e.l,ie=e.read_shift(2);if(ie===0&&V===10)break;var le=e.l===e.length?0:e.read_shift(2),ce=wE[ie];if(ce&&ce.f){if(t.bookSheets&&V===133&&ie!==133)break;if(V=ie,ce.r===2||ce.r==12){var ke=e.read_shift(2);if(le-=2,!Y.enc&&ke!==ie&&((ke&255)<<8|ke>>8)!==ie)throw new Error("rt mismatch: "+ke+"!="+ie);ce.r==12&&(e.l+=10,le-=10)}var re={};if(ie===10?re=ce.f(e,le,Y):re=Yme(ie,ce,e,le,Y),W==0&&[9,521,1033,2057].indexOf(V)===-1)continue;switch(ie){case 34:r.opts.Date1904=F.WBProps.date1904=re;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Y.enc||(e.l=0),Y.enc=re,!t.password)throw new Error("File is password-protected");if(re.valid==null)throw new Error("Encryption scheme unsupported");if(!re.valid)throw new Error("Password is incorrect");break;case 92:Y.lastuser=re;break;case 66:var ge=Number(re);switch(ge){case 21010:ge=1200;break;case 32768:ge=1e4;break;case 32769:ge=1252;break}ec(Y.codepage=ge),se=!0;break;case 317:Y.rrtabid=re;break;case 25:Y.winlocked=re;break;case 439:r.opts.RefreshAll=re;break;case 12:r.opts.CalcCount=re;break;case 16:r.opts.CalcDelta=re;break;case 17:r.opts.CalcIter=re;break;case 13:r.opts.CalcMode=re;break;case 14:r.opts.CalcPrecision=re;break;case 95:r.opts.CalcSaveRecalc=re;break;case 15:Y.CalcRefMode=re;break;case 2211:r.opts.FullCalc=re;break;case 129:re.fDialog&&(s["!type"]="dialog"),re.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),re.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:E.push(re);break;case 430:M.push([re]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(re);break;case 24:case 536:J={Name:re.Name,Ref:vi(re.rgce,i,null,M,Y)},re.itab>0&&(J.Sheet=re.itab-1),M.names.push(J),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(re),re.Name=="_xlnm._FilterDatabase"&&re.itab>0&&re.rgce&&re.rgce[0]&&re.rgce[0][0]&&re.rgce[0][0][0]=="PtgArea3d"&&(q[re.itab-1]={ref:Vr(re.rgce[0][0][1][2])});break;case 22:Y.ExternCount=re;break;case 23:M.length==0&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(re),M.XTI=M.XTI.concat(re);break;case 2196:if(Y.biff<8)break;J!=null&&(J.Comment=re[1]);break;case 18:s["!protect"]=re;break;case 19:re!==0&&Y.WTF&&console.error("Password verifier: "+re);break;case 133:a[re.pos]=re,Y.snames.push(re.name);break;case 10:{if(--W)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Vr(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ne=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Vr(i),i.e.r=Ne}i.e.r++,i.e.c++}ae.length>0&&(s["!merges"]=ae),ee.length>0&&(s["!objects"]=ee),ne.length>0&&(s["!cols"]=ne),L.length>0&&(s["!rows"]=L),F.Sheets.push(A)}u===""?d=s:n[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Y.biff===8&&(Y.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[re.BIFFVer]||8),Y.biffguess=re.BIFFVer==0,re.BIFFVer==0&&re.dt==4096&&(Y.biff=5,se=!0,ec(Y.codepage=28591)),Y.biff==8&&re.BIFFVer==0&&re.dt==16&&(Y.biff=2),W++)break;if(s=t.dense?[]:{},Y.biff<8&&!se&&(se=!0,ec(Y.codepage=t.codepage||1252)),Y.biff<5||re.BIFFVer==0&&re.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var je={pos:e.l-le,name:u};a[je.pos]=je,Y.snames.push(u)}else u=(a[X]||{name:""}).name;re.dt==32&&(s["!type"]="chart"),re.dt==64&&(s["!type"]="macro"),ae=[],ee=[],Y.arrayf=k=[],ne=[],L=[],H=!1,A={Hidden:(a[X]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[re.r]||[])[re.c]:s[Pr({c:re.c,r:re.r})])&&++re.c,_={ixfe:re.ixfe,XF:E[re.ixfe]||{},v:re.val,t:"n"},I>0&&(_.z=B[_.ixfe>>8&63]),Oc(_,t,r.opts.Date1904),U({c:re.c,r:re.r},_,t);break;case 5:case 517:_={ixfe:re.ixfe,XF:E[re.ixfe],v:re.val,t:re.t},I>0&&(_.z=B[_.ixfe>>8&63]),Oc(_,t,r.opts.Date1904),U({c:re.c,r:re.r},_,t);break;case 638:_={ixfe:re.ixfe,XF:E[re.ixfe],v:re.rknum,t:"n"},I>0&&(_.z=B[_.ixfe>>8&63]),Oc(_,t,r.opts.Date1904),U({c:re.c,r:re.r},_,t);break;case 189:for(var Ke=re.c;Ke<=re.C;++Ke){var Ue=re.rkrec[Ke-re.c][0];_={ixfe:Ue,XF:E[Ue],v:re.rkrec[Ke-re.c][1],t:"n"},I>0&&(_.z=B[_.ixfe>>8&63]),Oc(_,t,r.opts.Date1904),U({c:Ke,r:re.r},_,t)}break;case 6:case 518:case 1030:{if(re.val=="String"){o=re;break}if(_=Ow(re.val,re.cell.ixfe,re.tt),_.XF=E[_.ixfe],t.cellFormula){var It=re.formula;if(It&&It[0]&&It[0][0]&&It[0][0][0]=="PtgExp"){var rt=It[0][0][1][0],wt=It[0][0][1][1],xt=Pr({r:rt,c:wt});C[xt]?_.f=""+vi(re.formula,i,re.cell,M,Y):_.F=((t.dense?(s[rt]||[])[wt]:s[xt])||{}).F}else _.f=""+vi(re.formula,i,re.cell,M,Y)}I>0&&(_.z=B[_.ixfe>>8&63]),Oc(_,t,r.opts.Date1904),U(re.cell,_,t),o=re}break;case 7:case 519:if(o)o.val=re,_=Ow(re,o.cell.ixfe,"s"),_.XF=E[_.ixfe],t.cellFormula&&(_.f=""+vi(o.formula,i,o.cell,M,Y)),I>0&&(_.z=B[_.ixfe>>8&63]),Oc(_,t,r.opts.Date1904),U(o.cell,_,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(re);var lt=Pr(re[0].s);if(p=t.dense?(s[re[0].s.r]||[])[re[0].s.c]:s[lt],t.cellFormula&&p){if(!o||!lt||!p)break;p.f=""+vi(re[1],i,re[0],M,Y),p.F=Vr(re[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!o)break;C[Pr(o.cell)]=re[0],p=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[Pr(o.cell)],(p||{}).f=""+vi(re[0],i,h,M,Y)}}break;case 253:_=Ow(l[re.isst].t,re.ixfe,"s"),l[re.isst].h&&(_.h=l[re.isst].h),_.XF=E[_.ixfe],I>0&&(_.z=B[_.ixfe>>8&63]),Oc(_,t,r.opts.Date1904),U({c:re.c,r:re.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:re.ixfe,XF:E[re.ixfe],t:"z"},I>0&&(_.z=B[_.ixfe>>8&63]),Oc(_,t,r.opts.Date1904),U({c:re.c,r:re.r},_,t));break;case 190:if(t.sheetStubs)for(var pt=re.c;pt<=re.C;++pt){var Rt=re.ixfe[pt-re.c];_={ixfe:Rt,XF:E[Rt],t:"z"},I>0&&(_.z=B[_.ixfe>>8&63]),Oc(_,t,r.opts.Date1904),U({c:pt,r:re.r},_,t)}break;case 214:case 516:case 4:_=Ow(re.val,re.ixfe,"s"),_.XF=E[_.ixfe],I>0&&(_.z=B[_.ixfe>>8&63]),Oc(_,t,r.opts.Date1904),U({c:re.c,r:re.r},_,t);break;case 0:case 512:W===1&&(i=re);break;case 252:l=re;break;case 1054:if(Y.biff==4){B[I++]=re[1];for(var Mt=0;Mt<I+163&&Ar[Mt]!=re[1];++Mt);Mt>=163&&Hu(re[1],I+163)}else Hu(re[1],re[0]);break;case 30:{B[I++]=re;for(var Qe=0;Qe<I+163&&Ar[Qe]!=re;++Qe);Qe>=163&&Hu(re,I+163)}break;case 229:ae=ae.concat(re);break;case 93:ee[re.cmo[0]]=Y.lastobj=re;break;case 438:Y.lastobj.TxO=re;break;case 127:Y.lastobj.ImData=re;break;case 440:for(w=re[0].s.r;w<=re[0].e.r;++w)for(v=re[0].s.c;v<=re[0].e.c;++v)p=t.dense?(s[w]||[])[v]:s[Pr({c:v,r:w})],p&&(p.l=re[1]);break;case 2048:for(w=re[0].s.r;w<=re[0].e.r;++w)for(v=re[0].s.c;v<=re[0].e.c;++v)p=t.dense?(s[w]||[])[v]:s[Pr({c:v,r:w})],p&&p.l&&(p.l.Tooltip=re[1]);break;case 28:{if(Y.biff<=5&&Y.biff>=2)break;p=t.dense?(s[re[0].r]||[])[re[0].c]:s[Pr(re[0])];var Re=ee[re[2]];p||(t.dense?(s[re[0].r]||(s[re[0].r]=[]),p=s[re[0].r][re[0].c]={t:"z"}):p=s[Pr(re[0])]={t:"z"},i.e.r=Math.max(i.e.r,re[0].r),i.s.r=Math.min(i.s.r,re[0].r),i.e.c=Math.max(i.e.c,re[0].c),i.s.c=Math.min(i.s.c,re[0].c)),p.c||(p.c=[]),x={a:re[1],t:Re.TxO.t},p.c.push(x)}break;case 2173:Mde(E[re.ixfe],re.ext);break;case 125:{if(!Y.cellStyles)break;for(;re.e>=re.s;)ne[re.e--]={width:re.w/256,level:re.level||0,hidden:!!(re.flags&1)},H||(H=!0,b3(re.w/256)),kf(ne[re.e+1])}break;case 520:{var Be={};re.level!=null&&(L[re.r]=Be,Be.level=re.level),re.hidden&&(L[re.r]=Be,Be.hidden=!0),re.hpt&&(L[re.r]=Be,Be.hpt=re.hpt,Be.hpx=Cm(re.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Gh(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=re;break;case 161:s["!margins"]||Gh(s["!margins"]={}),s["!margins"].header=re.header,s["!margins"].footer=re.footer;break;case 574:re.RTL&&(F.Views[0].RTL=!0);break;case 146:P=re;break;case 2198:Z=re;break;case 140:N=re;break;case 442:u?A.CodeName=re||A.name:F.WBProps.CodeName=re||"ThisWorkbook";break}}else ce||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),e.l+=le}return r.SheetNames=As(a).sort(function(ct,We){return Number(ct)-Number(We)}).map(function(ct){return a[ct].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&q.forEach(function(ct,We){r.Sheets[r.SheetNames[We]]["!autofilter"]=ct}),r.Strings=l,r.SSF=Xn(Ar),Y.enc&&(r.Encryption=Y.enc),Z&&(r.Themes=Z),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),M.names.length>0&&(F.Names=M.names),r.Workbook=F,r}var Ay={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Jme(e,t,r){var n=Sr.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=cO(n,hE,Ay.DSI);for(var a in s)t[a]=s[a]}catch(u){if(r.WTF)throw u}var i=Sr.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=cO(i,gE,Ay.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(L$(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Qme(e,t){var r=[],n=[],s=[],a=0,i,o=BF(hE,"n"),l=BF(gE,"n");if(e.Props)for(i=As(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(l,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=As(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(l,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var u=[];for(a=0;a<s.length;++a)G$.indexOf(s[a][0])>-1||M$.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&Sr.utils.cfb_add(t,"/SummaryInformation",uO(n,Ay.SI,l,gE)),(r.length||u.length)&&Sr.utils.cfb_add(t,"/DocumentSummaryInformation",uO(r,Ay.DSI,o,hE,u.length?u:null,Ay.UDI))}function $U(e,t){t||(t={}),j3(t),J4(),t.codepage&&X4(t.codepage);var r,n;if(e.FullPaths){if(Sr.find(e,"/encryption"))throw new Error("File is password-protected");r=Sr.find(e,"!CompObj"),n=Sr.find(e,"/Workbook")||Sr.find(e,"/Book")}else{switch(t.type){case"base64":e=Io(Uo(e));break;case"binary":e=Io(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Za(e,0),n={content:e}}var s,a;if(r&&Kme(r),t.bookProps&&!t.bookSheets)s={};else{var i=Yr?"buffer":"array";if(n&&n.content)s=Xme(n.content,t);else if((a=Sr.find(e,"PerfectOffice_MAIN"))&&a.content)s=Hh.to_workbook(a.content,(t.type=i,t));else if((a=Sr.find(e,"NativeContent_MAIN"))&&a.content)s=Hh.to_workbook(a.content,(t.type=i,t));else throw(a=Sr.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Sr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=dfe(e))}var o={};return e.FullPaths&&Jme(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function Zme(e,t){var r=t||{},n=Sr.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Sr.utils.cfb_add(n,s,UU(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Qme(e,n),r.biff==8&&e.vbaraw&&ffe(n,Sr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var ov={0:{f:S0e},1:{f:P0e},2:{f:X0e},3:{f:B0e},4:{f:R0e},5:{f:K0e},6:{f:tge},7:{f:W0e},8:{f:lge},9:{f:oge},10:{f:age},11:{f:ige},12:{f:O0e},13:{f:Q0e},14:{f:U0e},15:{f:M0e},16:{f:FU},17:{f:nge},18:{f:G0e},19:{f:d3},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:nme},40:{},42:{},43:{f:tde},44:{f:Zue},45:{f:sde},46:{f:ide},47:{f:ade},48:{},49:{f:Toe},50:{},51:{f:$de},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rU},62:{f:ege},63:{f:Yde},64:{f:kge},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ni,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:wge},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:A0e},148:{f:T0e,p:16},151:{f:gge},152:{},153:{f:eme},154:{},155:{},156:{f:Qge},157:{},158:{},159:{T:1,f:pue},160:{T:-1},161:{T:1,f:j0},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:cge},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Lde},336:{T:-1},337:{f:Wde,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:fE},357:{},358:{},359:{},360:{T:1},361:{},362:{f:tU},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:mge},427:{f:pge},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:yge},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:N0e},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:fge},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:fE},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ife},633:{T:1},634:{T:-1},635:{T:1,f:sfe},636:{T:-1},637:{f:joe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Uge},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Cge},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},wE={6:{f:Ck},10:{f:ef},12:{f:Js},13:{f:Js},14:{f:Ls},15:{f:Ls},16:{f:_i},17:{f:Ls},18:{f:Ls},19:{f:Js},20:{f:pO},21:{f:pO},23:{f:tU},24:{f:yO},25:{f:Ls},26:{},27:{},28:{f:Cce},29:{},34:{f:Ls},35:{f:xO},38:{f:_i},39:{f:_i},40:{f:_i},41:{f:_i},42:{f:Ls},43:{f:Ls},47:{f:Mue},49:{f:Qle},51:{f:Js},60:{},61:{f:Kle},64:{f:Ls},65:{f:Jle},66:{f:Js},77:{},80:{},81:{},82:{},85:{f:Js},89:{},90:{},91:{},92:{f:Ile},93:{f:Nce},94:{},95:{f:Ls},96:{},97:{},99:{f:Ls},125:{f:rU},128:{f:hce},129:{f:Lle},130:{f:Js},131:{f:Ls},132:{f:Ls},133:{f:Ble},134:{},140:{f:Ice},141:{f:Js},144:{},146:{f:Bce},151:{},152:{},153:{},154:{},155:{},156:{f:Js},157:{},158:{},160:{f:Vce},161:{f:zce},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:cce},190:{f:uce},193:{f:ef},197:{},198:{},199:{},200:{},201:{},202:{f:Ls},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Js},220:{},221:{f:Ls},222:{},224:{f:fce},225:{f:Rle},226:{f:ef},227:{},229:{f:Tce},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Ule},253:{f:ece},255:{f:Wle},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:V$},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ls},353:{f:ef},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:yce},431:{f:Ls},432:{},433:{},434:{},437:{},438:{f:Pce},439:{f:Ls},440:{f:Fce},441:{},442:{f:Gv},443:{},444:{f:Js},445:{},446:{},448:{f:ef},449:{f:Vle,r:2},450:{f:ef},512:{f:hO},513:{f:Gce},515:{f:pce},516:{f:rce},517:{f:mO},519:{f:Kce},520:{f:Hle},523:{},545:{f:vO},549:{f:fO},566:{},574:{f:Yle},638:{f:lce},659:{},1048:{},1054:{f:sce},1084:{},1212:{f:_ce},2048:{f:Dce},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:jw},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ef},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:$ce,r:12},2173:{f:Ide,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ls,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:bce,r:12},2197:{},2198:{f:jde,r:12},2199:{},2200:{},2201:{},2202:{f:Sce,r:12},2203:{f:ef},2204:{},2205:{},2206:{},2207:{},2211:{f:Gle},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Js},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Wce},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Lce},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:hO},1:{},2:{f:Qce},3:{f:Xce},4:{f:Yce},5:{f:mO},7:{f:eue},8:{},9:{f:jw},11:{},22:{f:Js},30:{f:ice},31:{},32:{},33:{f:vO},36:{},37:{f:fO},50:{f:tue},62:{},52:{},67:{},68:{f:Js},69:{},86:{},126:{},127:{f:qce},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:rue},223:{},234:{},354:{},421:{},518:{f:Ck},521:{f:jw},536:{f:yO},547:{f:xO},561:{},579:{},1030:{f:Ck},1033:{f:jw},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Yt(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&l3(r)&&e.push(r)}}function epe(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return Yt(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,l=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u;l<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u}}}function Yv(e,t,r){return e||(e=_t(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function tpe(e,t,r,n){var s=_t(9);return Yv(s,e,t),K$(r,n||"b",s),s}function rpe(e,t,r){var n=_t(8+2*r.length);return Yv(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function npe(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?ma(Yn(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Yt(e,2,Zce(r,n,s)):Yt(e,3,Jce(r,n,s));return;case"b":case"e":Yt(e,5,tpe(r,n,t.v,t.t));return;case"s":case"str":Yt(e,4,rpe(r,n,(t.v||"").slice(0,255)));return}Yt(e,1,Yv(null,r,n))}function spe(e,t,r,n){var s=Array.isArray(t),a=dn(t["!ref"]||"A1"),i,o="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=Vr(a)}for(var u=a.s.r;u<=a.e.r;++u){o=Us(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(l[d]=fs(d)),i=l[d]+o;var h=s?(t[u]||[])[d]:t[i];h&&npe(e,h,u,d)}}}function ape(e,t){for(var r=t||{},n=xo(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Yt(n,r.biff==4?1033:r.biff==3?521:9,y3(e,16,r)),spe(n,e.Sheets[e.SheetNames[s]],s,r),Yt(n,10),n.end()}function ipe(e,t,r){Yt(e,49,Zle({sz:12,name:"Arial"},r))}function ope(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Yt(e,1054,ace(s,t[s],r))})}function lpe(e,t){var r=_t(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Yt(e,2151,r),r=_t(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Q$(dn(t["!ref"]||"A1"),r),r.write_shift(4,4),Yt(e,2152,r)}function cpe(e,t){for(var r=0;r<16;++r)Yt(e,224,gO({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Yt(e,224,gO(n,0,t))})}function upe(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Yt(e,440,Oce(n)),n[1].Tooltip&&Yt(e,2048,Rce(n))}delete t["!links"]}function dpe(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&Yt(e,125,Uce(f2(s,n),s))})}}function fpe(e,t,r,n,s){var a=16+Mf(s.cellXfs,t,s);if(t.v==null&&!t.bf){Yt(e,513,g0(r,n,a));return}if(t.bf)Yt(e,6,Lhe(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?ma(Yn(t.v)):t.v;Yt(e,515,xce(r,n,i,a));break;case"b":case"e":Yt(e,517,mce(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=T3(s.Strings,t.v,s.revStrings);Yt(e,253,tce(r,n,o,a))}else Yt(e,516,nce(r,n,(t.v||"").slice(0,255),a,s));break;default:Yt(e,513,g0(r,n,a))}}function hpe(e,t,r){var n=xo(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},l=Array.isArray(a),u=t.biff==8,d,h="",g=[],p=dn(a["!ref"]||"A1"),x=u?65536:16384;if(p.e.c>255||p.e.r>=x){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}Yt(n,2057,y3(r,16,t)),Yt(n,13,gl(1)),Yt(n,12,gl(100)),Yt(n,15,Wi(!0)),Yt(n,17,Wi(!1)),Yt(n,16,f0(.001)),Yt(n,95,Wi(!0)),Yt(n,42,Wi(!1)),Yt(n,43,Wi(!1)),Yt(n,130,gl(1)),Yt(n,128,gce()),Yt(n,131,Wi(!1)),Yt(n,132,Wi(!1)),u&&dpe(n,a["!cols"]),Yt(n,512,oce(p,t)),u&&(a["!links"]=[]);for(var v=p.s.r;v<=p.e.r;++v){h=Us(v);for(var w=p.s.c;w<=p.e.c;++w){v===p.s.r&&(g[w]=fs(w)),d=g[w]+h;var C=l?(a[v]||[])[w]:a[d];C&&(fpe(n,C,v,w,t),u&&C.l&&a["!links"].push([d,C.l]))}}var k=o.CodeName||o.name||s;return u&&Yt(n,574,Xle((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&Yt(n,229,Ece(a["!merges"])),u&&upe(n,a),Yt(n,442,q$(k)),u&&lpe(n,a),Yt(n,10),n.end()}function gpe(e,t,r){var n=xo(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,l=r.biff==5;if(Yt(n,2057,y3(e,5,r)),r.bookType=="xla"&&Yt(n,135),Yt(n,225,o?gl(1200):null),Yt(n,193,mle(2)),l&&Yt(n,191),l&&Yt(n,192),Yt(n,226),Yt(n,92,Mle("SheetJS",r)),Yt(n,66,gl(o?1200:1252)),o&&Yt(n,353,gl(0)),o&&Yt(n,448),Yt(n,317,Hce(e.SheetNames.length)),o&&e.vbaraw&&Yt(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";Yt(n,442,q$(u))}Yt(n,156,gl(17)),Yt(n,25,Wi(!1)),Yt(n,18,Wi(!1)),Yt(n,19,gl(0)),o&&Yt(n,431,Wi(!1)),o&&Yt(n,444,gl(0)),Yt(n,61,qle()),Yt(n,64,Wi(!1)),Yt(n,141,gl(0)),Yt(n,34,Wi(Vge(e)=="true")),Yt(n,14,Wi(!0)),o&&Yt(n,439,Wi(!1)),Yt(n,218,gl(0)),ipe(n,e,r),ope(n,e.SSF,r),cpe(n,r),o&&Yt(n,352,Wi(!1));var d=n.end(),h=xo();o&&Yt(h,140,Mce()),o&&r.Strings&&epe(h,252,zle(r.Strings)),Yt(h,10);var g=h.end(),p=xo(),x=0,v=0;for(v=0;v<e.SheetNames.length;++v)x+=(o?12:11)+(o?2:1)*e.SheetNames[v].length;var w=d.length+x+g.length;for(v=0;v<e.SheetNames.length;++v){var C=a[v]||{};Yt(p,133,$le({pos:w,hs:C.Hidden||0,dt:0,name:e.SheetNames[v]},r)),w+=t[v].length}var k=p.end();if(x!=k.length)throw new Error("BS8 "+x+" != "+k.length);var _=[];return d.length&&_.push(d),k.length&&_.push(k),g.length&&_.push(g),ja(_)}function mpe(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Xn(Ar)),e&&e.SSF&&(Jm(),a2(e.SSF),r.revssf=o2(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,P3(r),r.cellXfs=[],Mf(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=hpe(s,r,e);return n.unshift(gpe(e,n,r)),ja(n)}function UU(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=yo(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return mpe(e,t);case 4:case 3:case 2:return ape(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function AO(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,l=Zie(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,h=0,g=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<l.length;++i){var v=l[i].trim(),w=v.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(w!="<td"&&w!="<th")){var C=v.split(/<\/t[dh]>/i);for(o=0;o<C.length;++o){var k=C[o].trim();if(k.match(/<t[dh]/i)){for(var _=k,N=0;_.charAt(0)=="<"&&(N=_.indexOf(">"))>-1;)_=_.slice(N+1);for(var E=0;E<x.length;++E){var P=x[E];P.s.c==d&&P.s.r<u&&u<=P.e.r&&(d=P.e.c+1,E=-1)}var F=Or(k.slice(0,k.indexOf(">")));g=F.colspan?+F.colspan:1,((h=+F.rowspan)>1||g>1)&&x.push({s:{r:u,c:d},e:{r:u+(h||1)-1,c:d+g-1}});var A=F.t||F["data-t"]||"";if(!_.length){d+=g;continue}if(_=d$(_),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!_.length){d+=g;continue}var j={t:"s",v:_};r.raw||!_.trim().length||A=="s"||(_==="TRUE"?j={t:"b",v:!0}:_==="FALSE"?j={t:"b",v:!1}:isNaN(nc(_))?isNaN(Sm(_).getDate())||(j={t:"d",v:Yn(_)},r.cellDates||(j={t:"n",v:ma(j.v)}),j.z=r.dateNF||Ar[14]):j={t:"n",v:nc(_)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=j):n[Pr({r:u,c:d})]=j,d+=g}}}}return n["!ref"]=Vr(p),x.length&&(n["!merges"]=x),n}function ppe(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,l=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var d=Pr({r,c:i}),h=n.dense?(e[r]||[])[i]:e[d],g=h&&h.v!=null&&(h.h||a3(h.w||(Zu(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?g='<span contenteditable="true">'+g+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+h.l.Target+'">'+g+"</a>")),p.id=(n.id||"sjs")+"-"+d,a.push(qt("td",g,p))}}var x="<tr>";return x+a.join("")+"</tr>"}var xpe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ype="</body></html>";function vpe(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return If(AO(r[0],t),t);var n=D3();return r.forEach(function(s,a){R3(n,AO(s,t),"Sheet"+(a+1))}),n}function wpe(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function zU(e,t){var r=t||{},n=r.header!=null?r.header:xpe,s=r.footer!=null?r.footer:ype,a=[n],i=yo(e["!ref"]);r.dense=Array.isArray(e),a.push(wpe(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(ppe(e,i,o,r));return a.push("</table>"+s),a.join("")}function WU(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?hs(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var d=yo(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var h=[],g=0,p=e["!rows"]||(e["!rows"]=[]),x=0,v=0,w=0,C=0,k=0,_=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&v<l;++x){var N=o[x];if(jO(N)){if(n.display)continue;p[v]={hidden:!0}}var E=N.children;for(w=C=0;w<E.length;++w){var P=E[w];if(!(n.display&&jO(P))){var F=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):d$(P.innerHTML),A=P.getAttribute("data-z")||P.getAttribute("z");for(g=0;g<h.length;++g){var j=h[g];j.s.c==C+a&&j.s.r<v+s&&v+s<=j.e.r&&(C=j.e.c+1-a,g=-1)}_=+P.getAttribute("colspan")||1,((k=+P.getAttribute("rowspan")||1)>1||_>1)&&h.push({s:{r:v+s,c:C+a},e:{r:v+s+(k||1)-1,c:C+a+(_||1)-1}});var R={t:"s",v:F},U=P.getAttribute("data-t")||P.getAttribute("t")||"";F!=null&&(F.length==0?R.t=U||"z":n.raw||F.trim().length==0||U=="s"||(F==="TRUE"?R={t:"b",v:!0}:F==="FALSE"?R={t:"b",v:!1}:isNaN(nc(F))?isNaN(Sm(F).getDate())||(R={t:"d",v:Yn(F)},n.cellDates||(R={t:"n",v:ma(R.v)}),R.z=n.dateNF||Ar[14]):R={t:"n",v:nc(F)})),R.z===void 0&&A!=null&&(R.z=A);var Y="",Z=P.getElementsByTagName("A");if(Z&&Z.length)for(var ae=0;ae<Z.length&&!(Z[ae].hasAttribute("href")&&(Y=Z[ae].getAttribute("href"),Y.charAt(0)!="#"));++ae);Y&&Y.charAt(0)!="#"&&(R.l={Target:Y}),n.dense?(e[v+s]||(e[v+s]=[]),e[v+s][C+a]=R):e[Pr({c:C+a,r:v+s})]=R,u.e.c<C+a&&(u.e.c=C+a),C+=_}}++v}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,v-1+s),e["!ref"]=Vr(u),v>=l&&(e["!fullref"]=Vr((u.e.r=o.length-x+v-1+s,u))),e}function HU(e,t){var r=t||{},n=r.dense?[]:{};return WU(n,e,t)}function bpe(e,t){return If(HU(e,t),t)}function jO(e){var t="",r=_pe(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function _pe(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Spe(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=un(t.replace(/<[^>]*>/g,""));return[r]}var PO={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function GU(e,t){var r=t||{},n=i3(e),s=[],a,i,o={name:""},l="",u=0,d,h,g={},p=[],x=r.dense?[]:{},v,w,C={value:""},k="",_=0,N=[],E=-1,P=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,j={},R=[],U={},Y=0,Z=0,ae=[],ee=1,ne=1,L=[],H={Names:[]},M={},V=["",""],W=[],I={},B="",q=0,J=!1,se=!1,X=0;for(tv.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=tv.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?x["!ref"]=Vr(F):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=F.e.r&&(x["!fullref"]=x["!ref"],F.e.r=r.sheetRows-1,x["!ref"]=Vr(F)),R.length&&(x["!merges"]=R),ae.length&&(x["!rows"]=ae),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),g[d.name]=x,se=!1):v[0].charAt(v[0].length-2)!=="/"&&(d=Or(v[0],!1),E=P=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,x=r.dense?[]:{},R=[],ae=[],se=!0);break;case"table-row-group":v[1]==="/"?--A:++A;break;case"table-row":case"":if(v[1]==="/"){E+=ee,ee=1;break}if(h=Or(v[0],!1),h.?E=h.-1:E==-1&&(E=0),ee=+h["number-rows-repeated"]||1,ee<10)for(X=0;X<ee;++X)A>0&&(ae[E+X]={level:A});P=-1;break;case"covered-table-cell":v[1]!=="/"&&++P,r.sheetStubs&&(r.dense?(x[E]||(x[E]=[]),x[E][P]={t:"z"}):x[Pr({r:E,c:P})]={t:"z"}),k="",N=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++P,C=Or(v[0],!1),ne=parseInt(C["number-columns-repeated"]||"1",10),w={t:"z",v:null},C.formula&&r.cellFormula!=!1&&(w.f=TO(un(C.formula))),(C.||C["value-type"])=="string"&&(w.t="s",w.v=un(C["string-value"]||""),r.dense?(x[E]||(x[E]=[]),x[E][P]=w):x[Pr({r:E,c:P})]=w),P+=ne-1;else if(v[1]!=="/"){++P,k="",_=0,N=[],ne=1;var ie=ee?E+ee-1:E;if(P>F.e.c&&(F.e.c=P),P<F.s.c&&(F.s.c=P),E<F.s.r&&(F.s.r=E),ie>F.e.r&&(F.e.r=ie),C=Or(v[0],!1),W=[],I={},w={t:C.||C["value-type"],v:null},r.cellFormula)if(C.formula&&(C.formula=un(C.formula)),C["number-matrix-columns-spanned"]&&C["number-matrix-rows-spanned"]&&(Y=parseInt(C["number-matrix-rows-spanned"],10)||0,Z=parseInt(C["number-matrix-columns-spanned"],10)||0,U={s:{r:E,c:P},e:{r:E+Y-1,c:P+Z-1}},w.F=Vr(U),L.push([U,w.F])),C.formula)w.f=TO(C.formula);else for(X=0;X<L.length;++X)E>=L[X][0].s.r&&E<=L[X][0].e.r&&P>=L[X][0].s.c&&P<=L[X][0].e.c&&(w.F=L[X][1]);switch((C["number-columns-spanned"]||C["number-rows-spanned"])&&(Y=parseInt(C["number-rows-spanned"],10)||0,Z=parseInt(C["number-columns-spanned"],10)||0,U={s:{r:E,c:P},e:{r:E+Y-1,c:P+Z-1}},R.push(U)),C["number-columns-repeated"]&&(ne=parseInt(C["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Vn(C["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(C.value);break;case"percentage":w.t="n",w.v=parseFloat(C.value);break;case"currency":w.t="n",w.v=parseFloat(C.value);break;case"date":w.t="d",w.v=Yn(C["date-value"]),r.cellDates||(w.t="n",w.v=ma(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=Xie(C["time-value"])/86400,r.cellDates&&(w.t="d",w.v=l2(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(C.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",C["string-value"]!=null&&(k=un(C["string-value"]),N=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(J=!1,w.t==="s"&&(w.v=k||"",N.length&&(w.R=N),J=_==0),M.Target&&(w.l=M),W.length>0&&(w.c=W,W=[]),k&&r.cellText!==!1&&(w.w=k),J&&(w.t="z",delete w.v),(!J||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var le=0;le<ee;++le){if(ne=parseInt(C["number-columns-repeated"]||"1",10),r.dense)for(x[E+le]||(x[E+le]=[]),x[E+le][P]=le==0?w:Xn(w);--ne>0;)x[E+le][P+ne]=Xn(w);else for(x[Pr({r:E+le,c:P})]=w;--ne>0;)x[Pr({r:E+le,c:P+ne})]=Xn(w);F.e.c<=P&&(F.e.c=P)}ne=parseInt(C["number-columns-repeated"]||"1",10),P+=ne-1,ne=0,w={},k="",N=[]}M={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a;I.t=k,N.length&&(I.R=N),I.a=B,W.push(I)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);B="",q=0,k="",_=0,N=[];break;case"creator":v[1]==="/"?B=n.slice(q,v.index):q=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);k="",_=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(j[o.name]=l,(a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&(l="",o=Or(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Or(v[0],!1),l+=PO[v[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Or(v[0],!1),l+=PO[v[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,v.index);break}else u=v.index+v[0].length;break;case"named-range":i=Or(v[0],!1),V=Tk(i["cell-range-address"]);var ce={Name:i.name,Ref:V[0]+"!"+V[1]};se&&(ce.Sheet=p.length),H.Names.push(ce);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!C||!C["string-value"])){var ke=Spe(n.slice(_,v.index));k=(k.length>0?k+`
`:"")+ke[0]}else Or(v[0],!1),_=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{V=Tk(Or(v[0])["target-range-address"]),g[V[0]]["!autofilter"]={ref:V[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(M=Or(v[0],!1),!M.href)break;M.Target=un(M.href),delete M.href,M.Target.charAt(0)=="#"&&M.Target.indexOf(".")>-1?(V=Tk(M.Target.slice(1)),M.Target="#"+V[0]+"!"+V[1]):M.Target.match(/^\.\.[\\\/]/)&&(M.Target=M.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var re={Sheets:g,SheetNames:p,Workbook:H};return r.bookSheets&&delete re.Sheets,re}function FO(e,t){t=t||{},hl(e,"META-INF/manifest.xml")&&Xoe(Xs(e,"META-INF/manifest.xml"),t);var r=Mo(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=GU(Dn(r),t);return hl(e,"meta.xml")&&(n.Props=R$(Xs(e,"meta.xml"))),n}function OO(e,t){return GU(e,t)}var kpe=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ev({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ws+t}})(),DO=(function(){var e=function(a){return Nn(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var l=[];l.push('      <table:table table:name="'+Nn(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,h=yo(a["!ref"]||"A1"),g=a["!merges"]||[],p=0,x=Array.isArray(a);if(a["!cols"])for(d=0;d<=h.e.c;++d)l.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var v="",w=a["!rows"]||[];for(u=0;u<h.s.r;++u)v=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+v+`></table:table-row>
`);for(;u<=h.e.r;++u){for(v=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+v+`>
`),d=0;d<h.s.c;++d)l.push(t);for(;d<=h.e.c;++d){var C=!1,k={},_="";for(p=0;p!=g.length;++p)if(!(g[p].s.c>d)&&!(g[p].s.r>u)&&!(g[p].e.c<d)&&!(g[p].e.r<u)){(g[p].s.c!=d||g[p].s.r!=u)&&(C=!0),k["table:number-columns-spanned"]=g[p].e.c-g[p].s.c+1,k["table:number-rows-spanned"]=g[p].e.r-g[p].s.r+1;break}if(C){l.push(r);continue}var N=Pr({r:u,c:d}),E=x?(a[u]||[])[d]:a[N];if(E&&E.f&&(k["table:formula"]=Nn(Hhe(E.f)),E.F&&E.F.slice(0,N.length)==N)){var P=yo(E.F);k["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,k["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!E){l.push(t);continue}switch(E.t){case"b":_=E.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=E.v?"true":"false";break;case"n":_=E.w||String(E.v||0),k["office:value-type"]="float",k["office:value"]=E.v||0;break;case"s":case"str":_=E.v==null?"":E.v,k["office:value-type"]="string";break;case"d":_=E.w||Yn(E.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=Yn(E.v).toISOString(),k["table:style-name"]="ce1";break;default:l.push(t);continue}var F=e(_);if(E.l&&E.l.Target){var A=E.l.Target;A=A.charAt(0)=="#"?"#"+Ghe(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),F=qt("text:a",F,{"xlink:href":A.replace(/&/g,"&amp;")})}l.push("          "+qt("table:table-cell",qt("text:p",F,{}),k)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var h=u["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;kf(h),h.ods=o;var g=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),a.push(`  </style:style>
`),++o}}});var l=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=l;var h=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var l=[Ws],u=ev({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=ev({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+d+`>
`),l.push(D$().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),s(l,i),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=i.SheetNames.length;++h)l.push(n(i.Sheets[i.SheetNames[h]],i,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function VU(e,t){if(t.bookType=="fods")return DO(e,t);var r=r3(),n="",s=[],a=[];return n="mimetype",Kr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Kr(r,n,DO(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Kr(r,n,kpe(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Kr(r,n,Ws+D$()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Kr(r,n,Zoe(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Kr(r,n,Joe(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function m0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function bE(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Dn(Rf(e))}function Cpe(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Io(Uc(e))}function Tpe(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Tf(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function RO(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Epe(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Npe(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function lv(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function kn(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ns(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function hn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=lv(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=lv(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function qa(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(kn(n*8+s.type)),s.type==2&&t.push(kn(s.data.length)),t.push(s.data))})}),Tf(t)}function A3(e,t){return e?.map(function(r){return t(r.data)})||[]}function cl(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=lv(e,n),a=hn(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:Ns(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=hn(o.data),u=Ns(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=Ns(a[3][0].data)>>>0>0),r.push(i)}return r}function Dg(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:kn(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:kn(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:kn(i.data.length)}],n[2].push({data:qa(i.meta),type:2})});var a=qa(n);t.push(kn(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),Tf(t)}function Ape(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=lv(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Tf(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(s.push(s[0].slice(-l)),u-=l;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-l,-l+u))}}var d=Tf(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function ul(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Ape(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Tf(t)}function Rg(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=kn(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Tf(t)}function jpe(e,t,r,n){var s=m0(e),a=s.getUint32(4,!0),i=(n>1?12:8)+RO(a&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,d=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=RO(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:t[l]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:t[l]};else if(!isNaN(u))h={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function Ppe(e,t,r){var n=m0(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(l=Epe(e,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(i>-1)h={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return h}function Nk(e,t){var r=new Uint8Array(32),n=m0(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,Npe(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function Ak(e,t){var r=new Uint8Array(32),n=m0(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function Fpe(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return jpe(e,t,r,e[0]);case 5:return Ppe(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function yi(e){var t=hn(e);return lv(t[1][0].data)}function IO(e,t){var r=hn(t.data),n=Ns(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=hn(i.data),l=Ns(o[1][0].data)>>>0;switch(n){case 1:a[l]=bE(o[3][0].data);break;case 8:{var u=e[yi(o[9][0].data)][0],d=hn(u.data),h=e[yi(d[1][0].data)][0],g=Ns(h.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var p=hn(h.data);a[l]=p[3].map(function(x){return bE(x.data)}).join("")}break}}),a}function Ope(e,t){var r,n,s,a,i,o,l,u,d,h,g,p,x,v,w=hn(e),C=Ns(w[1][0].data)>>>0,k=Ns(w[2][0].data)>>>0,_=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Ns(w[8][0].data)>0||!1,N,E;if((a=(s=w[7])==null?void 0:s[0])!=null&&a.data&&t!=0)N=(o=(i=w[7])==null?void 0:i[0])==null?void 0:o.data,E=(u=(l=w[6])==null?void 0:l[0])==null?void 0:u.data;else if((h=(d=w[4])==null?void 0:d[0])!=null&&h.data&&t!=1)N=(p=(g=w[4])==null?void 0:g[0])==null?void 0:p.data,E=(v=(x=w[3])==null?void 0:x[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var P=_?4:1,F=m0(N),A=[],j=0;j<N.length/2;++j){var R=F.getUint16(j*2,!0);R<65535&&A.push([j,R])}if(A.length!=k)throw"Expected ".concat(k," cells, found ").concat(A.length);var U=[];for(j=0;j<A.length-1;++j)U[A[j][0]]=E.subarray(A[j][1]*P,A[j+1][1]*P);return A.length>=1&&(U[A[A.length-1][0]]=E.subarray(A[A.length-1][1]*P)),{R:C,cells:U}}function Dpe(e,t){var r,n=hn(t.data),s=(r=n?.[7])!=null&&r[0]?Ns(n[7][0].data)>>>0>0?1:0:-1,a=A3(n[5],function(i){return Ope(i,s)});return{nrows:Ns(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=l}),i},[])}}function Rpe(e,t,r){var n,s=hn(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Ns(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Ns(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Vr(a);var i=hn(s[4][0].data),o=IO(e,e[yi(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?IO(e,e[yi(i[17][0].data)][0]):[],u=hn(i[3][0].data),d=0;u[1].forEach(function(h){var g=hn(h.data),p=e[yi(g[2][0].data)][0],x=Ns(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var v=Dpe(e,p);v.data.forEach(function(w,C){w.forEach(function(k,_){var N=Pr({r:d+C,c:_}),E=Fpe(k,o,l);E&&(r[N]=E)})}),d+=v.nrows})}function Ipe(e,t){var r=hn(t.data),n={"!ref":"A1"},s=e[yi(r[2][0].data)],a=Ns(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return Rpe(e,s[0],n),n}function Mpe(e,t){var r,n=hn(t.data),s={name:(r=n[1])!=null&&r[0]?bE(n[1][0].data):"",sheets:[]},a=A3(n[2],yi);return a.forEach(function(i){e[i].forEach(function(o){var l=Ns(o.meta[1][0].data);l==6e3&&s.sheets.push(Ipe(e,o))})}),s}function Lpe(e,t){var r=D3(),n=hn(t.data),s=A3(n[1],yi);if(s.forEach(function(a){e[a].forEach(function(i){var o=Ns(i.meta[1][0].data);if(o==2){var l=Mpe(e,i);l.sheets.forEach(function(u,d){R3(r,u,d==0?l.name:l.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function jk(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=ul(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var d;try{d=cl(u)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){a[h.id]=h.messages,i.push(h.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Ns(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(u){var d=Ns(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Lpe(a,o)}function Bpe(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&Ns(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=m0(e[7][0].data),d=0,h=[],g=m0(e[4][0].data),p=0,x=[],v=0;v<t.length;++v){if(t[v]==null){u.setUint16(v*2,65535,!0),g.setUint16(v*2,65535);continue}u.setUint16(v*2,d,!0),g.setUint16(v*2,p,!0);var w,C;switch(typeof t[v]){case"string":w=Nk({t:"s",v:t[v]},r),C=Ak({t:"s",v:t[v]},r);break;case"number":w=Nk({t:"n",v:t[v]},r),C=Ak({t:"n",v:t[v]},r);break;case"boolean":w=Nk({t:"b",v:t[v]},r),C=Ak({t:"b",v:t[v]},r);break;default:throw new Error("Unsupported value "+t[v])}h.push(w),d+=w.length,x.push(C),p+=C.length,++l}for(e[2][0].data=kn(l);v<e[7][0].data.length/2;++v)u.setUint16(v*2,65535,!0),g.setUint16(v*2,65535,!0);return e[6][0].data=Tf(h),e[3][0].data=Tf(x),l}function $pe(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=yo(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Vr(n)));var a=Yb(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(B){return B.forEach(function(q){typeof q=="string"&&i.push(q)})});var o={},l=[],u=Sr.read(t.numbers,{type:"base64"});u.FileIndex.map(function(B,q){return[B,u.FullPaths[q]]}).forEach(function(B){var q=B[0],J=B[1];if(q.type==2&&q.name.match(/\.iwa/)){var se=q.content,X=ul(se),ie=cl(X);ie.forEach(function(le){l.push(le.id),o[le.id]={deps:[],location:J,type:Ns(le.messages[0].meta[1][0].data)}})}}),l.sort(function(B,q){return B-q});var d=l.filter(function(B){return B>1}).map(function(B){return[B,kn(B)]});u.FileIndex.map(function(B,q){return[B,u.FullPaths[q]]}).forEach(function(B){var q=B[0];if(B[1],!!q.name.match(/\.iwa/)){var J=cl(ul(q.content));J.forEach(function(se){se.messages.forEach(function(X){d.forEach(function(ie){se.messages.some(function(le){return Ns(le.meta[1][0].data)!=11006&&Tpe(le.data,ie[1])})&&o[ie[0]].deps.push(se.id)})})})}});for(var h=Sr.find(u,o[1].location),g=cl(ul(h.content)),p,x=0;x<g.length;++x){var v=g[x];v.id==1&&(p=v)}var w=yi(hn(p.messages[0].data)[1][0].data);for(h=Sr.find(u,o[w].location),g=cl(ul(h.content)),x=0;x<g.length;++x)v=g[x],v.id==w&&(p=v);for(w=yi(hn(p.messages[0].data)[2][0].data),h=Sr.find(u,o[w].location),g=cl(ul(h.content)),x=0;x<g.length;++x)v=g[x],v.id==w&&(p=v);for(w=yi(hn(p.messages[0].data)[2][0].data),h=Sr.find(u,o[w].location),g=cl(ul(h.content)),x=0;x<g.length;++x)v=g[x],v.id==w&&(p=v);var C=hn(p.messages[0].data);{C[6][0].data=kn(n.e.r+1),C[7][0].data=kn(n.e.c+1);var k=yi(C[46][0].data),_=Sr.find(u,o[k].location),N=cl(ul(_.content));{for(var E=0;E<N.length&&N[E].id!=k;++E);if(N[E].id!=k)throw"Bad ColumnRowUIDMapArchive";var P=hn(N[E].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var F=0;F<=n.e.c;++F){var A=[];A[1]=A[2]=[{type:0,data:kn(F+420690)}],P[1].push({type:2,data:qa(A)}),P[2].push({type:0,data:kn(F)}),P[3].push({type:0,data:kn(F)})}P[4]=[],P[5]=[],P[6]=[];for(var j=0;j<=n.e.r;++j)A=[],A[1]=A[2]=[{type:0,data:kn(j+726270)}],P[4].push({type:2,data:qa(A)}),P[5].push({type:0,data:kn(j)}),P[6].push({type:0,data:kn(j)});N[E].messages[0].data=qa(P)}_.content=Rg(Dg(N)),_.size=_.content.length,delete C[46];var R=hn(C[4][0].data);{R[7][0].data=kn(n.e.r+1);var U=hn(R[1][0].data),Y=yi(U[2][0].data);_=Sr.find(u,o[Y].location),N=cl(ul(_.content));{if(N[0].id!=Y)throw"Bad HeaderStorageBucket";var Z=hn(N[0].messages[0].data);for(j=0;j<a.length;++j){var ae=hn(Z[2][0].data);ae[1][0].data=kn(j),ae[4][0].data=kn(a[j].length),Z[2][j]={type:Z[2][0].type,data:qa(ae)}}N[0].messages[0].data=qa(Z)}_.content=Rg(Dg(N)),_.size=_.content.length;var ee=yi(R[2][0].data);_=Sr.find(u,o[ee].location),N=cl(ul(_.content));{if(N[0].id!=ee)throw"Bad HeaderStorageBucket";for(Z=hn(N[0].messages[0].data),F=0;F<=n.e.c;++F)ae=hn(Z[2][0].data),ae[1][0].data=kn(F),ae[4][0].data=kn(n.e.r+1),Z[2][F]={type:Z[2][0].type,data:qa(ae)};N[0].messages[0].data=qa(Z)}_.content=Rg(Dg(N)),_.size=_.content.length;var ne=yi(R[4][0].data);(function(){for(var B=Sr.find(u,o[ne].location),q=cl(ul(B.content)),J,se=0;se<q.length;++se){var X=q[se];X.id==ne&&(J=X)}var ie=hn(J.messages[0].data);{ie[3]=[];var le=[];i.forEach(function(re,ge){le[1]=[{type:0,data:kn(ge)}],le[2]=[{type:0,data:kn(1)}],le[3]=[{type:2,data:Cpe(re)}],ie[3].push({type:2,data:qa(le)})})}J.messages[0].data=qa(ie);var ce=Dg(q),ke=Rg(ce);B.content=ke,B.size=B.content.length})();var L=hn(R[3][0].data);{var H=L[1][0];delete L[2];var M=hn(H.data);{var V=yi(M[2][0].data);(function(){for(var B=Sr.find(u,o[V].location),q=cl(ul(B.content)),J,se=0;se<q.length;++se){var X=q[se];X.id==V&&(J=X)}var ie=hn(J.messages[0].data);{delete ie[6],delete L[7];var le=new Uint8Array(ie[5][0].data);ie[5]=[];for(var ce=0,ke=0;ke<=n.e.r;++ke){var re=hn(le);ce+=Bpe(re,a[ke],i),re[1][0].data=kn(ke),ie[5].push({data:qa(re),type:2})}ie[1]=[{type:0,data:kn(n.e.c+1)}],ie[2]=[{type:0,data:kn(n.e.r+1)}],ie[3]=[{type:0,data:kn(ce)}],ie[4]=[{type:0,data:kn(n.e.r+1)}]}J.messages[0].data=qa(ie);var ge=Dg(q),Ne=Rg(ge);B.content=Ne,B.size=B.content.length})()}H.data=qa(M)}R[3][0].data=qa(L)}C[4][0].data=qa(R)}p.messages[0].data=qa(C);var W=Dg(g),I=Rg(W);return h.content=I,h.size=h.content.length,u}function KU(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function j3(e){KU([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function P3(e){KU([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Upe(e){return en.WS.indexOf(e)>-1?"sheet":e==en.CS?"chart":e==en.DS?"dialog":e==en.MS?"macro":e&&e.length?e:"sheet"}function zpe(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Upe(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Wpe(e,t,r,n,s,a,i,o,l,u,d,h){try{a[n]=Cy(Mo(e,r,!0),t);var g=Xs(e,t),p;switch(o){case"sheet":p=dme(g,t,s,l,a[n],u,d,h);break;case"chart":if(p=fme(g,t,s,l,a[n],u,d,h),!p||!p["!drawel"])break;var x=cy(p["!drawel"].Target,t),v=rv(x),w=Qde(Mo(e,x,!0),Cy(Mo(e,v,!0),x)),C=cy(w,x),k=rv(C);p=Bge(Mo(e,C,!0),C,l,Cy(Mo(e,k,!0),C),u,p);break;case"macro":p=hme(g,t,s,l,a[n],u,d,h);break;case"dialog":p=gme(g,t,s,l,a[n],u,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var _=[];a&&a[n]&&As(a[n]).forEach(function(N){var E="";if(a[n][N].Type==en.CMNT){E=cy(a[n][N].Target,t);var P=yme(Xs(e,E,!0),E,l);if(!P||!P.length)return;bO(p,P,!1)}a[n][N].Type==en.TCMNT&&(E=cy(a[n][N].Target,t),_=_.concat(efe(Xs(e,E,!0),l)))}),_&&_.length&&bO(p,_,!0,l.people||[])}catch(N){if(l.WTF)throw N}}function ol(e){return e.charAt(0)=="/"?e.slice(1):e}function Hpe(e,t){if(Jm(),t=t||{},j3(t),hl(e,"META-INF/manifest.xml")||hl(e,"objectdata.xml"))return FO(e,t);if(hl(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof jk<"u"){if(e.FileIndex)return jk(e);var r=Sr.utils.cfb_new();return zF(e).forEach(function(ae){Kr(r,ae,toe(e,ae))}),jk(r)}throw new Error("Unsupported NUMBERS file")}if(!hl(e,"[Content_Types].xml"))throw hl(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):hl(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=zF(e),s=qoe(Mo(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Xs(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Xs(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(Ty=[],s.sst)try{Ty=xme(Xs(e,ol(s.sst)),s.sst,t)}catch(ae){if(t.WTF)throw ae}t.cellStyles&&s.themes.length&&(l=pme(Mo(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=mme(Xs(e,ol(s.style)),s.style,l,t))}s.links.map(function(ae){try{var ee=Cy(Mo(e,rv(ol(ae))),ae);return wme(Xs(e,ol(ae)),ee,ae,t)}catch{}});var d=ume(Xs(e,ol(s.workbooks[0])),s.workbooks[0],t),h={},g="";s.coreprops.length&&(g=Xs(e,ol(s.coreprops[0]),!0),g&&(h=R$(g)),s.extprops.length!==0&&(g=Xs(e,ol(s.extprops[0]),!0),g&&tle(g,h,t)));var p={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(g=Mo(e,ol(s.custprops[0]),!0),g&&(p=nle(g,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(ee){return ee.name}):h.Worksheets&&h.SheetNames.length>0&&(i=h.SheetNames),t.bookProps&&(x.Props=h,x.Custprops=p),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var v={};t.bookDeps&&s.calcchain&&(v=vme(Xs(e,ol(s.calcchain)),s.calcchain));var w=0,C={},k,_;{var N=d.Sheets;h.Worksheets=N.length,h.SheetNames=[];for(var E=0;E!=N.length;++E)h.SheetNames[E]=N[E].name}var P=a?"bin":"xml",F=s.workbooks[0].lastIndexOf("/"),A=(s.workbooks[0].slice(0,F+1)+"_rels/"+s.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");hl(e,A)||(A="xl/_rels/workbook."+P+".rels");var j=Cy(Mo(e,A,!0),A.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=bme(Xs(e,ol(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=rfe(Xs(e,ol(s.people[0])),t)),j&&(j=zpe(j,d.Sheets));var R=Xs(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var U="sheet";if(j&&j[w]?(k="xl/"+j[w][1].replace(/[\/]?xl\//,""),hl(e,k)||(k=j[w][1]),hl(e,k)||(k=A.replace(/_rels\/.*$/,"")+j[w][1]),U=j[w][2]):(k="xl/worksheets/sheet"+(w+1-R)+"."+P,k=k.replace(/sheet0\./,"sheet.")),_=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Y=!1,Z=0;Z!=t.sheets.length;++Z)typeof t.sheets[Z]=="number"&&t.sheets[Z]==w&&(Y=1),typeof t.sheets[Z]=="string"&&t.sheets[Z].toLowerCase()==h.SheetNames[w].toLowerCase()&&(Y=1);if(!Y)continue e}}Wpe(e,k,_,h.SheetNames[w],w,C,i,U,t,d,l,u)}return x={Directory:s,Workbook:d,Props:h,Custprops:p,Deps:v,Sheets:i,SheetNames:h.SheetNames,Strings:Ty,Styles:u,Themes:l,SSF:Xn(Ar)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(ae,ee){ae=ae.replace(/^Root Entry[\/]/,""),x.keys.push(ae),x.files[ae]=e.FileIndex[ee]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=Xs(e,ol(s.vba[0]),!0):s.defaults&&s.defaults.bin===ufe&&(x.vbaraw=Xs(e,"xl/vbaProject.bin",!0))),x}function Gpe(e,t){var r=t||{},n="Workbook",s=Sr.find(e,n);try{if(n="/!DataSpaces/Version",s=Sr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(bue(s.content),n="/!DataSpaces/DataSpaceMap",s=Sr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Sue(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Sr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=kue(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Sr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Tue(s.content)}catch{}if(n="/EncryptionInfo",s=Sr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Eue(s.content);if(n="/EncryptedPackage",s=Sr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Vpe(e,t){return t.bookType=="ods"?VU(e,t):t.bookType=="numbers"?$pe(e,t):t.bookType=="xlsb"?Kpe(e,t):qpe(e,t)}function Kpe(e,t){Zg=1024,e&&!e.SSF&&(e.SSF=Xn(Ar)),e&&e.SSF&&(Jm(),a2(e.SSF),t.revssf=o2(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ey?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=wU.indexOf(t.bookType)>-1,s=p3();P3(t=t||{});var a=r3(),i="",o=0;if(t.cellXfs=[],Mf(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Kr(a,i,I$(e.Props,t)),s.coreprops.push(i),Tn(t.rels,2,i,en.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Kr(a,i,B$(e.Props)),s.extprops.push(i),Tn(t.rels,3,i,en.EXT_PROPS),e.Custprops!==e.Props&&As(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Kr(a,i,$$(e.Custprops)),s.custprops.push(i),Tn(t.rels,4,i,en.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],g=(h||{})["!type"]||"sheet";switch(g){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Kr(a,i,Sme(o-1,i,t,e,d)),s.sheets.push(i),Tn(t.wbrels,-1,"worksheets/sheet"+o+"."+r,en.WS[0])}if(h){var p=h["!comments"],x=!1,v="";p&&p.length>0&&(v="xl/comments"+o+"."+r,Kr(a,v,Tme(p,v)),s.comments.push(v),Tn(d,-1,"../comments"+o+"."+r,en.CMNT),x=!0),h["!legacy"]&&x&&Kr(a,"xl/drawings/vmlDrawing"+o+".vml",yU(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Kr(a,rv(i),cm(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Kr(a,i,Cme(t.Strings,i,t)),s.strs.push(i),Tn(t.wbrels,-1,"sharedStrings."+r,en.SST)),i="xl/workbook."+r,Kr(a,i,_me(e,i)),s.workbooks.push(i),Tn(t.rels,1,i,en.WB),i="xl/theme/theme1.xml",Kr(a,i,_3(e.Themes,t)),s.themes.push(i),Tn(t.wbrels,-1,"theme/theme1.xml",en.THEME),i="xl/styles."+r,Kr(a,i,kme(e,i,t)),s.styles.push(i),Tn(t.wbrels,-1,"styles."+r,en.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Kr(a,i,e.vbaraw),s.vba.push(i),Tn(t.wbrels,-1,"vbaProject.bin",en.VBA)),i="xl/metadata."+r,Kr(a,i,Eme(i)),s.metadata.push(i),Tn(t.wbrels,-1,"metadata."+r,en.XLMETA),Kr(a,"[Content_Types].xml",O$(s,t)),Kr(a,"_rels/.rels",cm(t.rels)),Kr(a,"xl/_rels/workbook."+r+".rels",cm(t.wbrels)),delete t.revssf,delete t.ssf,a}function qpe(e,t){Zg=1024,e&&!e.SSF&&(e.SSF=Xn(Ar)),e&&e.SSF&&(Jm(),a2(e.SSF),t.revssf=o2(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ey?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=wU.indexOf(t.bookType)>-1,s=p3();P3(t=t||{});var a=r3(),i="",o=0;if(t.cellXfs=[],Mf(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Kr(a,i,I$(e.Props,t)),s.coreprops.push(i),Tn(t.rels,2,i,en.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Kr(a,i,B$(e.Props)),s.extprops.push(i),Tn(t.rels,3,i,en.EXT_PROPS),e.Custprops!==e.Props&&As(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Kr(a,i,$$(e.Custprops)),s.custprops.push(i),Tn(t.rels,4,i,en.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},g=e.Sheets[e.SheetNames[o-1]],p=(g||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Kr(a,i,PU(o-1,t,e,h)),s.sheets.push(i),Tn(t.wbrels,-1,"worksheets/sheet"+o+"."+r,en.WS[0])}if(g){var x=g["!comments"],v=!1,w="";if(x&&x.length>0){var C=!1;x.forEach(function(k){k[1].forEach(function(_){_.T==!0&&(C=!0)})}),C&&(w="xl/threadedComments/threadedComment"+o+"."+r,Kr(a,w,tfe(x,d,t)),s.threadedcomments.push(w),Tn(h,-1,"../threadedComments/threadedComment"+o+"."+r,en.TCMNT)),w="xl/comments"+o+"."+r,Kr(a,w,vU(x)),s.comments.push(w),Tn(h,-1,"../comments"+o+"."+r,en.CMNT),v=!0}g["!legacy"]&&v&&Kr(a,"xl/drawings/vmlDrawing"+o+".vml",yU(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}h["!id"].rId1&&Kr(a,rv(i),cm(h))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Kr(a,i,iU(t.Strings,t)),s.strs.push(i),Tn(t.wbrels,-1,"sharedStrings."+r,en.SST)),i="xl/workbook."+r,Kr(a,i,IU(e)),s.workbooks.push(i),Tn(t.rels,1,i,en.WB),i="xl/theme/theme1.xml",Kr(a,i,_3(e.Themes,t)),s.themes.push(i),Tn(t.wbrels,-1,"theme/theme1.xml",en.THEME),i="xl/styles."+r,Kr(a,i,gU(e,t)),s.styles.push(i),Tn(t.wbrels,-1,"styles."+r,en.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Kr(a,i,e.vbaraw),s.vba.push(i),Tn(t.wbrels,-1,"vbaProject.bin",en.VBA)),i="xl/metadata."+r,Kr(a,i,xU()),s.metadata.push(i),Tn(t.wbrels,-1,"metadata."+r,en.XLMETA),d.length>1&&(i="xl/persons/person.xml",Kr(a,i,nfe(d)),s.people.push(i),Tn(t.wbrels,-1,"persons/person.xml",en.PEOPLE)),Kr(a,"[Content_Types].xml",O$(s,t)),Kr(a,"_rels/.rels",cm(t.rels)),Kr(a,"xl/_rels/workbook."+r+".rels",cm(t.wbrels)),delete t.revssf,delete t.ssf,a}function F3(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Uo(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Ype(e,t){return Sr.find(e,"EncryptedPackage")?Gpe(e,t):$U(e,t)}function Xpe(e,t){var r,n=e,s=t||{};return s.type||(s.type=Yr&&Buffer.isBuffer(e)?"buffer":"base64"),r=l$(n,s),Hpe(r,s)}function qU(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return vE(e.slice(r),t);default:break e}return km.to_workbook(e,t)}function Jpe(e,t){var r="",n=F3(e,t);switch(t.type){case"base64":r=Uo(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=d0(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Dn(r)),t.type="binary",qU(r,t)}function Qpe(e,t){var r=e;return t.type=="base64"&&(r=Uo(r)),r=Xy.utils.decode(1200,r.slice(2),"str"),t.type="binary",qU(r,t)}function Zpe(e){return e.match(/[^\x00-\x7F]/)?Uc(e):e}function Pk(e,t,r,n){return n?(r.type="string",km.to_workbook(e,r)):km.to_workbook(t,r)}function _E(e,t){J4();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return _E(new Uint8Array(e),(r=Xn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),dm={},r.dateNF&&(dm.dateNF=r.dateNF),r.type||(r.type=Yr&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Yr?"buffer":"binary",n=Kie(e),typeof Uint8Array<"u"&&!Yr&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=Zpe(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Xn(r),r.type="array",_E(Q4(n),r)}switch((s=F3(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Ype(Sr.read(n,r),r);break;case 9:if(s[1]<=8)return $U(n,r);break;case 60:return vE(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return sue(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return sU.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Xpe(n,r):Pk(e,n,r,a);case 239:return s[3]===60?vE(n,r):Pk(e,n,r,a);case 255:if(s[1]===254)return Qpe(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Hh.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Hh.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return yE.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return dU.to_workbook(n,r);break;case 10:case 13:case 32:return Jpe(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return nue.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?yE.to_workbook(n,r):Pk(e,n,r,a)}function YU(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return zv(t.file,Sr.write(e,{type:Yr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Sr.write(e,t)}function exe(e,t){var r=Xn(t||{}),n=Vpe(e,r);return txe(n,r)}function txe(e,t){var r={},n=Yr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Sr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(s2(s))}return t.password&&typeof encrypt_agile<"u"?YU(encrypt_agile(s,t.password),t):t.type==="file"?zv(t.file,s):t.type=="string"?Dn(s):s}function rxe(e,t){var r=t||{},n=Zme(e,r);return YU(n,r)}function Rc(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Jy(Uc(n));case"binary":return Uc(n);case"string":return e;case"file":return zv(t.file,n,"utf8");case"buffer":return Yr?id(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Rc(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function nxe(e,t){switch(t.type){case"base64":return Jy(e);case"binary":return e;case"string":return e;case"file":return zv(t.file,e,"binary");case"buffer":return Yr?id(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Dw(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Jy(r):t.type=="string"?Dn(r):r;case"file":return zv(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function XU(e,t){J4(),Yge(e);var r=Xn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=XU(e,r);return r.type="array",s2(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Rc(Vme(e,r),r);case"slk":case"sylk":return Rc(nU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Rc(zU(e.Sheets[e.SheetNames[s]],r),r);case"txt":return nxe(JU(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Rc(O3(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Rc(sU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Dw(yE.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Rc(km.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Rc(dU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Rc(aU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Rc(VU(e,r),r);case"wk1":return Dw(Hh.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Dw(Hh.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Dw(UU(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),rxe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return exe(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function sxe(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function axe(e,t,r){var n={};return n.type="file",n.file=t,sxe(n),XU(e,n)}function ixe(e,t,r,n,s,a,i,o){var l=Us(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,g=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=i?e[r][p]:e[n[p]+l];if(x===void 0||x.t===void 0){if(u===void 0)continue;a[p]!=null&&(g[a[p]]=u);continue}var v=x.v;switch(x.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[p]!=null){if(v==null)if(x.t=="e"&&v===null)g[a[p]]=null;else if(u!==void 0)g[a[p]]=u;else if(d&&v===null)g[a[p]]=null;else continue;else g[a[p]]=d&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?v:Zu(x,v,o);v!=null&&(h=!1)}}return{row:g,isempty:h}}function Yb(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":l=dn(d);break;case"number":l=dn(e["!ref"]),l.s.r=d;break;default:l=d}n>0&&(s=0);var h=Us(l.s.r),g=[],p=[],x=0,v=0,w=Array.isArray(e),C=l.s.r,k=0,_={};w&&!e[C]&&(e[C]=[]);var N=u.skipHidden&&e["!cols"]||[],E=u.skipHidden&&e["!rows"]||[];for(k=l.s.c;k<=l.e.c;++k)if(!(N[k]||{}).hidden)switch(g[k]=fs(k),r=w?e[C][k]:e[g[k]+h],n){case 1:a[k]=k-l.s.c;break;case 2:a[k]=g[k];break;case 3:a[k]=u.header[k-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Zu(r,null,u),v=_[i]||0,!v)_[i]=1;else{do o=i+"_"+v++;while(_[o]);_[i]=v,_[o]=1}a[k]=o}for(C=l.s.r+s;C<=l.e.r;++C)if(!(E[C]||{}).hidden){var P=ixe(e,l,C,g,n,a,w,u);(P.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[x++]=P.row)}return p.length=x,p}var MO=/"/g;function oxe(e,t,r,n,s,a,i,o){for(var l=!0,u=[],d="",h=Us(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var p=o.dense?(e[r]||[])[g]:e[n[g]+h];if(p==null)d="";else if(p.v!=null){l=!1,d=""+(o.rawNumbers&&p.t=="n"?p.v:Zu(p,null,o));for(var x=0,v=0;x!==d.length;++x)if((v=d.charCodeAt(x))===s||v===a||v===34||o.forceQuotes){d='"'+d.replace(MO,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(l=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(MO,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&l?null:u.join(i)}function O3(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=dn(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",h=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(g[x]||{}).hidden||(h[x]=fs(x));for(var v=0,w=s.s.r;w<=s.e.r;++w)(p[w]||{}).hidden||(d=oxe(e,s,w,h,i,l,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((v++?o:"")+d)));return delete n.dense,r.join("")}function JU(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=O3(e,t);return r}function lxe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=dn(e["!ref"]),a="",i=[],o,l=[],u=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=fs(o);for(var d=s.s.r;d<=s.e.r;++d)for(a=Us(d),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=u?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function QU(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?hs(n.origin):n.origin;i=l.r,o=l.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var h=dn(a["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),i==-1&&(i=h.e.r+1,d.e.r=i+t.length-1+s)}else i==-1&&(i=0,d.e.r=t.length-1+s);var g=n.header||[],p=0;t.forEach(function(v,w){As(v).forEach(function(C){(p=g.indexOf(C))==-1&&(g[p=g.length]=C);var k=v[C],_="z",N="",E=Pr({c:o+p,r:i+w+s});u=cv(a,E),k&&typeof k=="object"&&!(k instanceof Date)?a[E]=k:(typeof k=="number"?_="n":typeof k=="boolean"?_="b":typeof k=="string"?_="s":k instanceof Date?(_="d",n.cellDates||(_="n",k=ma(k)),N=n.dateNF||Ar[14]):k===null&&n.nullError&&(_="e",k=0),u?(u.t=_,u.v=k,delete u.w,delete u.R,N&&(u.z=N)):a[E]=u={t:_,v:k},N&&(u.z=N))})}),d.e.c=Math.max(d.e.c,o+g.length-1);var x=Us(i);if(s)for(p=0;p<g.length;++p)a[fs(p+o)+x]={t:"s",v:g[p]};return a["!ref"]=Vr(d),a}function cxe(e,t){return QU(null,e,t)}function cv(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=hs(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?cv(e,Pr(t)):cv(e,Pr({r:t,c:r||0}))}function uxe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function D3(){return{SheetNames:[],Sheets:{}}}function R3(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(RU(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function dxe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=uxe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function fxe(e,t){return e.z=t,e}function ZU(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function hxe(e,t,r){return ZU(e,"#"+t,r)}function gxe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function mxe(e,t,r,n){for(var s=typeof t!="string"?t:dn(t),a=typeof t=="string"?t:Vr(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=cv(e,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return e}var ab={encode_col:fs,encode_row:Us,encode_cell:Pr,encode_range:Vr,decode_col:u3,decode_row:c3,split_cell:Coe,decode_cell:hs,decode_range:yo,format_cell:Zu,sheet_add_aoa:T$,sheet_add_json:QU,sheet_add_dom:WU,aoa_to_sheet:Qm,json_to_sheet:cxe,table_to_sheet:HU,table_to_book:bpe,sheet_to_csv:O3,sheet_to_txt:JU,sheet_to_json:Yb,sheet_to_html:zU,sheet_to_formulae:lxe,sheet_to_row_object_array:Yb,sheet_get_cell:cv,book_new:D3,book_append_sheet:R3,book_set_sheet_visibility:dxe,cell_set_number_format:fxe,cell_set_hyperlink:ZU,cell_set_internal_link:hxe,cell_add_comment:gxe,sheet_set_array_formula:mxe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const ez=({onBackToCabinet:e,selectedGrade:t,selectedClass:r,openRetestModal:n,forceRefreshOnMount:s=!1})=>{vo(),P_();const{user:a,isAuthenticated:i}=Qn(),{showNotification:o}=Da(),l=S.useCallback(et=>{let we=null;if(typeof et?.percentage=="number"&&!Number.isNaN(et.percentage))return we=Math.round(et.percentage),console.debug("[TeacherResults] Using provided percentage",{percentage:et.percentage,rounded:we,result:et}),we;const $e=et?.retest_best_score??et?.score,Le=et?.retest_best_max_score??et?.max_score,Et=Number($e??0),Nt=Number(Le??0);return Nt>0&&(we=Math.round(Et/Nt*100)),we},[]);S.useCallback(et=>{const we=l(et);return we===null?"text-gray-600":we<50?"text-red-600 font-semibold":we<70?"text-yellow-600":"text-green-600"},[l]),S.useCallback(et=>{const we=l(et);return we!==null&&we<50},[l]);const[u,d]=S.useState(null),[h,g]=S.useState(!0),[p,x]=S.useState(""),[v,w]=S.useState([]),[C,k]=S.useState(null),[_,N]=S.useState(!1),[E,P]=S.useState([]),[F,A]=S.useState([]),[j,R]=S.useState([1,2]),[U,Y]=S.useState(null),[Z,ae]=S.useState(null),[ee,ne]=S.useState(null),[L,H]=S.useState("main"),[M,V]=S.useState(null),[W,I]=S.useState(null),B=M||t,q=W||r,[J,se]=S.useState(null),[X,ie]=S.useState({}),[le,ce]=S.useState(!1),[ke,re]=S.useState(new Set),[ge,Ne]=S.useState(!0),[je,Ke]=S.useState(null),[Ue,It]=S.useState(null),[rt,wt]=S.useState(!1),[xt,lt]=S.useState(!1),[pt,Rt]=S.useState(!1),Mt=S.useRef(null),[Qe,Re]=S.useState(null),[Be,ct]=S.useState(!1),[We,nt]=S.useState(null),[Tt,jt]=S.useState(!1),[Vt,fr]=S.useState(null),[Dr,zr]=S.useState(""),[or,nr]=S.useState(""),[me,Ae]=S.useState(!1),[Fe,Me]=S.useState(!1),[kt,Oe]=S.useState(null),[at,Ce]=S.useState(""),[Ve,Ze]=S.useState(!1),[Ft,zt]=S.useState(new Set),[er,hr]=S.useState({}),[ir,Wr]=S.useState(!1),[ue,be]=S.useState(null),[ye,xe]=S.useState(""),[_e,Se]=S.useState(!1),He=S.useRef(new Set),it=S.useRef({}),Ye=S.useRef(null);S.useEffect(()=>{console.log(" editingColumns state changed:",Array.from(Ft)),He.current=Ft},[Ft]),S.useEffect(()=>{console.log(" columnScores state changed:",er),it.current=er},[er]);const oe=S.useCallback(et=>{console.log(" Toggling test collapse for:",et),re(we=>{const $e=new Set(we);return $e.has(et)?($e.delete(et),console.log(" Expanding test:",et)):($e.add(et),console.log(" Collapsing test:",et)),console.log(" New collapsed tests:",Array.from($e)),$e})},[]),fe=S.useCallback(()=>{if(Mt.current){const{scrollLeft:et,scrollWidth:we,clientWidth:$e}=Mt.current;lt(et>0),Rt(et<we-$e-1)}},[]);S.useEffect(()=>{Ee()},[]),S.useEffect(()=>{if(U&&Mt.current){const et=setTimeout(fe,100);return()=>clearTimeout(et)}},[U,fe]),S.useEffect(()=>{console.log(" Current collapsed tests state:",Array.from(ke))},[ke]);const Te=S.useCallback(async(et,we=!1)=>{try{ce(!0);const $e=a?.teacher_id,Le=`${B}/${q}`,Et=await gae.getTeacherStudentResults($e,B,Le,et,we);if(Et.success){console.log(" Results loaded for term:",et,Et.results?.length||0,"results"),console.log(" Students loaded:",Et.students?.length||0,"students");const Nt=[],mr=new Set,an=new Set;Et.results&&Et.results.length>0&&Et.results.forEach(Pt=>{Pt.test_name&&!mr.has(Pt.test_name)&&(mr.add(Pt.test_name),Nt.push({test_name:Pt.test_name,test_type:Pt.test_type,subject:Pt.subject})),Pt.subject&&an.add(Pt.subject)});const ht=(Et.students||[]).map(Pt=>{const es={};return(Et.results||[]).filter(Nr=>Nr.student_id===Pt.student_id).forEach(Nr=>{Nr.test_name&&(es[Nr.test_name]={id:Nr.id,test_type:Nr.test_type,test_id:Nr.test_id,subject_id:Nr.subject_id,score:Nr.score,max_score:Nr.max_score,retest_offered:Nr.retest_offered,caught_cheating:Nr.caught_cheating,visibility_change_times:Nr.visibility_change_times,answers:Nr.answers,ai_feedback:Nr.ai_feedback,name:Nr.name,surname:Nr.surname,test_name:Nr.test_name})}),{...Pt,...es}}),Qt={results:Et.results||[],students:ht,class:ht,unique_tests:Nt,subjects:Array.from(an),count:Et.count||0,student_count:Et.student_count||0};console.log(" Processed results data:",{uniqueTests:Nt.length,subjects:Array.from(an),resultsCount:Et.results?.length||0,studentsWithScores:ht.length,sampleStudent:ht[0]}),Y(Qt),ie(Qt),ne(new Date)}}catch($e){console.error(" Error loading results for term:",$e),Y(null),ie(null)}finally{ce(!1)}},[a,B,q]);S.useEffect(()=>{(async()=>{try{wt(!0),await Qu.loadAcademicCalendar();const we=Qu.getCurrentSemesterTerms();It(we),we?.currentTerm&&(Ke(we.currentTerm.id),B&&q&&Te(we.currentTerm.id,s))}catch(we){console.error(" Error initializing academic calendar:",we)}finally{wt(!1)}})()},[B,q,Te,s]),S.useEffect(()=>{t&&r&&(console.log(" Props detected:",{grade:t,class:r}),Ue?.currentTerm&&(Ke(Ue.currentTerm.id),Te(Ue.currentTerm.id,s)))},[t,r,Ue,Te,s]);const Ee=S.useCallback(async()=>{console.log(" Initializing teacher results...");try{if(g(!0),x(""),!i||!a){console.log(" User not authenticated"),x("User not authenticated");return}if(a.role!==Hi.TEACHER){console.error(" Invalid user role for teacher results:",a.role),x("Access denied. Teacher role required.");return}console.log(" Loading teacher assignments..."),await Xe(),console.log(" TODO: Load academic calendar service"),console.log(" Teacher results initialization complete!")}catch(et){console.error(" Error initializing teacher results:",et),x("Failed to initialize teacher results")}finally{g(!1)}},[i,a]),Xe=S.useCallback(async()=>{console.log(" Loading teacher assignments...");try{const et=`teacher_data_${a?.teacher_id||a?.id||""}`;let we=Es(et);we&&we.subjects&&we.subjects.length>0&&(we.subjects.some(ht=>ht.subject&&ht.classes&&ht.classes.length>0)||(console.log(" Cached data has invalid subject structure, forcing refresh"),localStorage.removeItem(et),we=null)),we?console.log(" Cache HIT! Using cached teacher data"):(console.log(" Cache MISS! Fetching teacher data from API"),we=await ns.getTeacherData(),console.log(" Teacher data loaded:",we),us(et,we,Ts.teacher_subjects)),d(we);const $e=[];we&&we.subjects&&(console.log(" Teacher subjects structure:",we.subjects),we.subjects.forEach(an=>{console.log(" Processing subject:",an),an.classes&&an.classes.forEach(ht=>{ht.grade&&ht.class&&$e.push({grade:ht.grade,class:ht.class,subject:an.subject||an.name||"Unknown Subject"})})})),A($e),console.log(" Available classes from teacher data:",$e);const Le=`teacher_tests_${a?.teacher_id||a?.id||""}`,Et=Es(Le);Et&&Et.some(an=>an.test_type==="drawing")&&(console.log(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(Le));let Nt=Es(Le);Nt?console.log(" Cache HIT! Using cached teacher tests"):(console.log(" Cache MISS! Fetching teacher tests from API"),Nt=await cn.getTeacherTests(),console.log(" Teacher tests loaded:",Nt),us(Le,Nt,Ts.teacher_tests));const mr=Nt.flatMap(an=>an.assignments||[]);w(mr),console.log(" Raw assignments data:",mr),console.log(" Teacher assignments loaded:",mr.length)}catch(et){console.error(" Error loading teacher assignments:",et),o("Failed to load teacher assignments","error")}},[o]),ut=S.useCallback(async(et,we)=>{console.log(" Showing classes for grade:",et,"class:",we),V(et),I(we),k(null),Y(null),et&&we&&console.log(" TODO: Implement academic calendar service for term selection")},[]);S.useCallback((et,we)=>{console.log(" Showing semesters for class:",et,we),k(null),Y(null),console.log(" TODO: Implement academic calendar service for term selection")},[]),S.useCallback((et,we)=>{console.log(" Class clicked:",et,we),N(!0),console.log(" TODO: Implement academic calendar service for term selection")},[]);const ft=S.useCallback(async(et,we=!1)=>{!B||!q||(console.log(" Loading results for semester:",et,"forceRefresh:",we),k(et),Ue?.currentTerm&&await Te(Ue.currentTerm.id,we))},[B,q,Ue,Te]),Kt=S.useCallback(()=>Ue?c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Current Semester: ",Ue?.semester===1?"Semester 1":"Semester 2"]}),c.jsx("div",{className:"flex space-x-4",children:Ue?.terms.map(et=>c.jsx(st.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${et.isCurrent?"bg-blue-600 text-white shadow-lg":je===et.id?"bg-green-500 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>{Ke(et.id),Te(et.id)},whileHover:{scale:1.05},whileTap:{scale:.95},children:et.label},et.id))})]}):c.jsx("div",{className:"flex space-x-4 mb-6",children:c.jsx("div",{className:"px-6 py-3 rounded-lg bg-gray-200 text-gray-500",children:"Loading terms..."})}),[Ue,je,Te]);S.useCallback(et=>et.reduce((we,$e)=>(we[$e.student_id]||(we[$e.student_id]=[]),we[$e.student_id].push($e),we),{}),[]),S.useCallback(et=>{if(et.length===0)return 0;const we=et.reduce(($e,Le)=>$e+(Le.percentage||0),0);return Math.round(we/et.length)},[]),S.useCallback(et=>{et.score<et.passing_score&&window.confirm("Give another try?")&&Ct(et.student_id,et.test_id)},[]);const Ct=S.useCallback(async(et,we)=>{try{(await fetch("/.netlify/functions/reset-test-attempt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:et,testId:we})})).ok&&(q&&ft(C,!0),o("Test made accessible to student","success"))}catch($e){console.error("Error resetting test attempt:",$e),o("Failed to reset test attempt","error")}},[q,C,ft,o]),Ht=S.useCallback((et,we)=>{if(et===null||we===null)return"";const $e=Math.round(et/we*100);return $e>=80?"text-green-600 bg-green-50":$e>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50"},[]),yr=S.useCallback(et=>{Re(et),ct(!0)},[]),wr=S.useCallback((et,we="overview",$e)=>{try{const Et=!!et?.ai_feedback,Nt=typeof et?.ai_feedback;let mr=[];if(Et)if(Nt==="string")try{mr=Object.keys(JSON.parse(et.ai_feedback))}catch{mr=["<invalid json>"]}else Nt==="object"&&(mr=Object.keys(et.ai_feedback||{}));console.log("[AI DEBUG] Opening speaking result",{hasAi:Et,aiType:Nt,aiKeys:mr})}catch{}const Le={...et,__initialTab:we};$e&&(Le.__audioUrl=$e),nt(Le),jt(!0)},[]);S.useCallback((et,we,$e)=>{fr({resultId:et,score:we,maxScore:$e}),zr(we?.toString()||""),nr($e?.toString()||""),Me(!0)},[]),S.useCallback(et=>{zr(et)},[]),S.useCallback(et=>{nr(et)},[]),S.useCallback(async()=>{if(Vt){Ae(!0);try{const et={resultId:Vt.resultId,score:parseInt(Dr)||0,maxScore:parseInt(or)||1};(await fetch(Kx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(et)})).ok?(o("Score updated successfully","success"),q&&ft(C,!0),fr(null),zr(""),nr(""),Me(!1)):o("Failed to update score","error")}catch(et){console.error("Error updating score:",et),o("Failed to update score","error")}finally{Ae(!1)}}},[Vt,Dr,or,q,C,ft,o]),S.useCallback(()=>{fr(null),zr(""),nr(""),Me(!1)},[]);const vr=S.useCallback((et,we)=>{Oe({resultId:et,score:we}),Ce(we.toString())},[]),Er=S.useCallback(async()=>{if(kt){Ze(!0);try{const et={resultId:kt.resultId,score:parseInt(at)||0},we=await fetch(Kx.UPDATE_SPEAKING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(et)});if(we.ok){const $e=await we.json();o("Speaking test score updated successfully","success"),We&&nt(Le=>({...Le,score:$e.score,percentage:$e.percentage})),q&&ft(C,!0),Oe(null),Ce("")}else{const $e=await we.json();o($e.error||"Failed to update speaking test score","error")}}catch(et){console.error("Error updating speaking test score:",et),o("Failed to update speaking test score","error")}finally{Ze(!1)}}},[kt,at,q,C,ft,o]),qr=S.useCallback(()=>{Oe(null),Ce("")},[]),Hr=(et,we)=>{console.log(" Starting column editing for drawing test:",et),console.log(" Current editingColumns before update:",Array.from(Ft)),console.log(" Results data passed to function:",we),zt($e=>{const Le=new Set($e).add(et);return console.log(" Updated editingColumns:",Array.from(Le)),Le}),console.log(" Initializing column scores for test:",et),console.log(" Results data:",we),console.log(" Results.class:","null"),console.log(" No results or class data available")},he=S.useCallback(et=>{zt(we=>{const $e=new Set(we);return $e.delete(et),$e}),hr(we=>{const $e={...we};return delete $e[et],$e})},[]),vt=S.useCallback((et,we,$e,Le)=>{const Et=Le.toString();it.current[et]||(it.current[et]={}),it.current[et][we]||(it.current[et][we]={}),it.current[et][we][$e]=Et;const Nt=parseInt(Le)||0;hr(mr=>({...mr,[et]:{...mr[et],[we]:{...mr[et]?.[we],[$e]:Nt}}}))},[]);S.useCallback(async et=>{if(it.current[et]){Wr(!0);try{const we=Object.entries(it.current[et]).map(([Nt,mr])=>({resultId:mr.resultId,score:parseInt(mr.score)||0,maxScore:parseInt(mr.maxScore)||100}));console.log(" Saving column scores for",et,":",we);const $e=we.map(Nt=>(console.log(" Sending update:",Nt),fetch(Kx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Nt)})));(await Promise.all($e)).every(Nt=>Nt.ok)?(o(`Scores updated successfully for ${et}`,"success"),q&&ft(C,!0),he(et)):o("Failed to update some scores","error")}catch(we){console.error("Error updating column scores:",we),o("Failed to update scores","error")}finally{Wr(!1)}}},[er,q,C,ft,o,he]);const xr=S.useCallback((et,we,$e)=>!we||we.length===0?c.jsx(st.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:c.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):c.jsx(st.div,{className:"relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:c.jsxs(st.div,{className:"bg-white rounded-lg shadow-lg overflow-hidden",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4,delay:.1},children:[c.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:Le=>{Mt.current&&(Mt.current.scrollLeft=Le.target.scrollLeft)},children:c.jsx("div",{className:"min-w-full h-1",children:c.jsx("div",{className:"h-1",style:{width:`${($e.length+5)*120}px`}})})}),c.jsx("div",{ref:Mt,className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:Le=>{fe(Le);const Et=Le.target.previousElementSibling;Et&&(Et.scrollLeft=Le.target.scrollLeft)},children:c.jsxs("table",{className:"min-w-full border-collapse text-sm min-w-max",children:[c.jsx("thead",{children:c.jsxs(st.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-20 text-center",children:"Student ID"}),c.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 ${ge?"w-8 min-w-[32px] max-w-[32px] bg-gray-100 cursor-pointer select-none":"min-w-[180px] bg-blue-50 cursor-pointer select-none"}`,onClick:Le=>{Le.preventDefault(),Le.stopPropagation(),Ne(!ge)},title:"Toggle student name columns",children:ge?c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"truncate",title:"Student Name",children:"Student Name"}),c.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-16 text-center",children:"No."}),c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[100px]",children:"Nickname"}),$e.map((Le,Et)=>{const Nt=ke.has(Le.test_name),mr=Le.test_type==="drawing",an=He.current.has(Le.test_name);return console.log(` Rendering test ${Le.test_name}:`,{isDrawingTest:mr,isEditingColumn:an,editingColumns:Array.from(He.current),test_type:Le.test_type}),c.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 cursor-pointer hover:bg-blue-200 transition-colors select-none ${Nt?"w-8 min-w-[32px] max-w-[32px] bg-gray-100":"min-w-[100px] bg-blue-50"}`,onClick:ht=>{ht.preventDefault(),ht.stopPropagation(),oe(Le.test_name)},children:Nt?c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"truncate",title:Le.test_name,children:Le.test_name.length>8?Le.test_name.substring(0,8)+"...":Le.test_name}),c.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})},Et)})]})}),c.jsx("tbody",{children:c.jsx(fo,{children:we.map((Le,Et)=>c.jsxs(st.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${Et%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1+Et*.05,ease:"easeOut"},whileHover:{scale:1.01,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.99},children:[c.jsx(st.td,{className:"border-b border-gray-100 px-4 py-4 text-center font-semibold text-gray-900",whileHover:{scale:1.05},transition:{duration:.2},children:Le.student_id}),ge?c.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Nt=>{Nt.preventDefault(),Nt.stopPropagation(),Ne(!1)},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}):c.jsxs(c.Fragment,{children:[c.jsx(st.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:Le.name}),c.jsx(st.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:Le.surname})]}),c.jsx(st.td,{className:"border-b border-gray-100 px-4 py-4 text-center text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:Le.number??Et+1}),c.jsx(st.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-600",whileHover:{scale:1.02},transition:{duration:.2},children:Le.nickname||"-"}),$e.map((Nt,mr)=>{const an=ke.has(Nt.test_name),ht=Le[Nt.test_name];return an?(console.log(" Rendering collapsed column for test:",Nt.test_name),c.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Qt=>{Qt.preventDefault(),Qt.stopPropagation(),console.log(" Clicked on collapsed arrow for:",Nt.test_name),oe(Nt.test_name)},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},mr)):c.jsx(st.td,{className:"border-b border-gray-100 px-2 py-4 text-sm min-w-[100px]",initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},transition:{duration:.3},whileHover:{scale:1.02},onClick:Qt=>{if(console.debug("[TeacherResults] Main table TD clicked",{testResult:ht,student:Le.student_id}),ht?.retest_offered){o("Retest is already offered","info");return}const Pt=l(ht);Pt!==null&&Pt<50&&(console.debug("[TeacherResults] Main table TD -> opening retest modal",{studentId:Le.student_id,test:Nt}),n({failedStudentIds:[Le.student_id],test_type:Nt.test_type,original_test_id:ht?.test_id||Nt.test_id,subject_id:ht?.subject_id||Nt.subject_id,grade:t,class:r}))},children:ht&&ht.test_type==="drawing"?c.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[c.jsx("button",{onClick:()=>yr(ht),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"View Drawing"}),(()=>{const Qt=`${Nt.test_name}|${Le.student_id}`,Pt=ue===Qt,es=Number.isFinite(ht?.score)?ht.score:0;if(!Pt){const Jr=l(ht),Nr=Jr!==null&&Jr<50,os=Jr!==null&&Jr>=50&&Jr<70,li=ht?.retest_offered===!0,Go=Jr===null?"text-gray-600":Nr?"text-red-600 font-semibold":os?"text-yellow-600":"text-green-600";return c.jsxs(st.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${Go} ${Nr?"cursor-pointer hover:opacity-90":""} ${li?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Nr?{color:"#b91c1c"}:void 0,whileHover:{scale:Nr?1.1:1.05},transition:{duration:.2},onClick:()=>{Nr&&!li?n({failedStudentIds:[Le.student_id],test_type:Nt.test_type,original_test_id:ht?.test_id||Nt.test_id,subject_id:ht?.subject_id||Nt.subject_id,grade:t,class:r}):(be(Qt),xe(String(es)))},title:li?"Retest offered":Nr?"Offer retest":"Click to edit score",children:[(()=>{const cc=ht.retest_best_score??ht.score,uc=ht.retest_best_max_score??ht.max_score;return c.jsxs(c.Fragment,{children:[c.jsx("span",{className:Nr?"text-red-700":"",children:cc}),"/",c.jsx("span",{children:uc})]})})(),ht.caught_cheating&&c.jsx("span",{className:"ml-1",children:""})]})}return c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"number",min:"0",max:10,value:ye,onChange:Jr=>xe(Jr.target.value),onBlur:async()=>{const Jr=Math.max(0,Math.min(10,parseFloat(ye||"0")));Se(!0);try{const Nr={resultId:ht?.id,score:Jr,maxScore:10},os=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token");if(!(await fetch(Kx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:os?`Bearer ${os}`:""},body:JSON.stringify(Nr)})).ok)throw new Error("Failed to save")}catch{}finally{Se(!1),be(null),ft(C,!0)}},onKeyDown:async Jr=>{Jr.key==="Enter"?Jr.currentTarget.blur():Jr.key==="Escape"&&be(null)},className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",disabled:_e}),c.jsx("span",{className:"text-xs text-gray-500",children:"/"}),c.jsx("input",{type:"number",value:10,className:"w-12 px-2 py-1 text-xs border border-gray-300 bg-gray-100 rounded",disabled:!0})]})})(),ht.caught_cheating&&ht.visibility_change_times&&c.jsxs("span",{className:"text-xs text-red-600",children:["(",ht.visibility_change_times,")"]})]}):ht&&(ht.test_type==="speaking"||Nt.test_type==="speaking")?c.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[(()=>{const Qt=ht?.answers;let Pt;if(typeof Qt=="string")if(/^https?:\/\//i.test(Qt))Pt=Qt;else try{Pt=JSON.parse(Qt)?.audio_url}catch{}else Qt&&typeof Qt=="object"&&(Pt=Qt.audio_url);return!Pt&&ht?.audio_url&&(Pt=ht.audio_url),c.jsx(c.Fragment,{children:c.jsx("button",{onClick:()=>wr({...ht,__studentId:Le.student_id},"audio",Pt),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"Results"})})})(),(()=>{const Qt=He.current.has(Nt.test_name);return console.log(` Score cell for ${Nt.test_name}:`,{isEditing:Qt,editingColumns:Array.from(He.current),test_name:Nt.test_name}),Qt})()?c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"number",min:"0",max:ht.max_score||100,value:it.current[Nt.test_name]?.[Le.student_id]?.score||ht.score||"",onChange:Qt=>vt(Nt.test_name,Le.student_id,"score",Qt.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),c.jsx("span",{className:"text-xs text-gray-500",children:"/"}),c.jsx("input",{type:"number",min:"1",value:it.current[Nt.test_name]?.[Le.student_id]?.maxScore||ht.max_score||100,onChange:Qt=>vt(Nt.test_name,Le.student_id,"maxScore",Qt.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):c.jsxs("div",{className:"px-2 py-1 rounded-full text-xs font-medium",onDoubleClick:()=>{console.log(" Double-clicked on speaking test score:",Nt.test_name),console.log(" Results state at double-click:",U),console.log(" Test result:",ht),console.log(" Student:",Le),console.log(" Test:",Nt),ht&&ht.id?(console.log(" Starting column editing for speaking test:",Nt.test_name),Hr(Nt.test_name)):console.log(" No test result ID found, cannot edit")},title:"Double-click to edit scores",children:[(()=>{const Qt=l(ht),Pt=Qt!==null&&Qt<50,es=Qt!==null&&Qt>=50&&Qt<70,Jr=ht.retest_offered,Nr=Qt===null?"text-gray-600":Pt?"text-red-600 font-semibold":es?"text-yellow-600":"text-green-600";return c.jsxs(st.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${Nr} ${Pt?"cursor-pointer hover:opacity-90":""} ${Jr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Pt?{color:"#b91c1c"}:void 0,whileHover:{scale:Pt?1.1:1.05},transition:{duration:.2},onClick:()=>{Pt&&!Jr&&(console.log(" Offering retest for speaking test:",Nt.test_name),n({failedStudentIds:[Le.student_id],test_type:Nt.test_type,original_test_id:ht?.test_id||Nt.test_id,subject_id:ht?.subject_id||Nt.subject_id,grade:t,class:r}))},title:Jr?"Retest offered":Pt?"Offer retest":"",children:[(()=>{const os=ht.retest_best_score??ht.score,li=ht.retest_best_max_score??ht.max_score;return c.jsxs(c.Fragment,{children:[c.jsx("span",{className:Pt?"text-red-700":"",children:os}),"/",c.jsx("span",{children:li})]})})(),ht.caught_cheating&&c.jsx("span",{className:"ml-1",children:""})]})})(),ht.caught_cheating&&ht.visibility_change_times&&c.jsxs("span",{className:"text-xs text-red-600",children:["(",ht.visibility_change_times,")"]})]})]}):ht&&ht.score!==null&&ht.score!==void 0?c.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[(()=>{const Qt=l(ht),Pt=Qt!==null&&Qt<50,es=Qt!==null&&Qt>=50&&Qt<70,Jr=Qt===null?"text-gray-600":Pt?"text-red-600 font-semibold":es?"text-yellow-600":"text-green-600",Nr=ht?.retest_offered===!0;return c.jsxs(st.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${Jr} ${Pt?"cursor-pointer hover:opacity-90":""} ${Nr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Pt?{color:"#b91c1c"}:void 0,whileHover:{scale:Pt?1.1:1.05},transition:{duration:.2},onClick:os=>{if(os.preventDefault(),os.stopPropagation(),ht?.retest_offered){o("Retest is already offered","info");return}Pt&&n({failedStudentIds:[Le.student_id],test_type:Nt.test_type,original_test_id:ht?.test_id||Nt.test_id,subject_id:ht?.subject_id||Nt.subject_id,grade:t,class:r})},title:Nr?"Retest offered":Pt?"Offer retest":"",children:[(()=>{const os=ht.retest_best_score??ht.score,li=ht.retest_best_max_score??ht.max_score;return c.jsxs(c.Fragment,{children:[c.jsx("span",{className:Pt?"text-red-700":"",children:os}),"/",c.jsx("span",{children:li})]})})(),ht.caught_cheating&&c.jsx("span",{className:"ml-1",children:""})]})})(),ht.caught_cheating&&ht.visibility_change_times&&c.jsxs("span",{className:"text-xs text-red-600",children:["(",ht.visibility_change_times,")"]})]}):c.jsx("span",{className:"text-gray-400",children:"-"})},mr)})]},Et))})})]})})]})}),[Ht,ke,oe,ge]),br=S.useCallback((et,we,$e)=>!we||we.length===0?c.jsx(st.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:c.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):c.jsx(st.div,{className:"w-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},children:c.jsx(st.div,{className:"overflow-x-auto -mx-4 px-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.1},children:c.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden min-w-max",children:c.jsxs("table",{className:"w-full border-collapse text-xs min-w-max",children:[c.jsx("thead",{children:c.jsxs(st.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.2,delay:.2},children:[c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-16 text-center",children:"ID"}),c.jsx("th",{className:`border-b border-gray-200 px-2 py-3 text-left font-semibold text-gray-700 ${ge?"w-8 min-w-[32px] max-w-[32px] bg-gray-100 cursor-pointer select-none":"min-w-[160px] bg-blue-50 cursor-pointer select-none"}`,onClick:Le=>{Le.preventDefault(),Le.stopPropagation(),Ne(!ge)},title:"Toggle student name columns",children:ge?c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-3 h-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"truncate",title:"Student Name",children:"Student Name"}),c.jsx("svg",{className:"w-3 h-3 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-12 text-center",children:"No."}),c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[80px]",children:"Nickname"}),$e.map((Le,Et)=>(Le.test_type,He.current.has(Le.test_name),c.jsx(st.th,{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.3+Et*.05},children:c.jsx("div",{className:"flex flex-col space-y-1",children:c.jsx("span",{className:"text-xs",children:Le.test_name.length>10?Le.test_name.substring(0,10)+"...":Le.test_name})})},Et)))]})}),c.jsx("tbody",{children:c.jsx(fo,{children:we.map((Le,Et)=>c.jsxs(st.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${Et%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.1+Et*.03,ease:"easeOut"},whileHover:{scale:1.005,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.995},children:[c.jsx(st.td,{className:"border-b border-gray-100 px-3 py-3 text-center font-semibold text-gray-900",whileHover:{scale:1.03},transition:{duration:.15},children:Le.student_id}),ge?c.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-xs w-8 min-w-[32px] max-w-[32px]",children:c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-3 h-3 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Nt=>{Nt.preventDefault(),Nt.stopPropagation(),Ne(!1)},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}):c.jsxs(c.Fragment,{children:[c.jsx(st.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:Le.name}),c.jsx(st.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:Le.surname})]}),c.jsx(st.td,{className:"border-b border-gray-100 px-3 py-3 text-center text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:Le.number??Et+1}),c.jsx(st.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-600 whitespace-normal break-words",whileHover:{scale:1.01},transition:{duration:.15},children:Le.nickname||"-"}),$e.map((Nt,mr)=>{const an=ke.has(Nt.test_name),ht=Le[Nt.test_name];return an?c.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-sm w-8 min-w-[32px] max-w-[32px]",children:c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Qt=>{Qt.preventDefault(),Qt.stopPropagation(),oe(Nt.test_name)},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},mr):c.jsx(st.td,{className:"border-b border-gray-100 px-3 py-3 text-sm",whileHover:{scale:1.01},transition:{duration:.15},onClick:Qt=>{console.debug("[TeacherResults] TD clicked",{testResult:ht,student:Le.student_id});const Pt=l(ht);if(Pt!==null&&Pt<50){if(ht?.retest_offered){o("Retest is already offered","info");return}console.debug("[TeacherResults] TD -> opening retest modal",{studentId:Le.student_id}),n({failedStudentIds:[Le.student_id],test_type:ht.test_type,original_test_id:ht.test_id,subject_id:ht.subject_id,grade:t,class:r})}},children:ht&&(ht.test_type==="drawing"||Nt.test_type==="drawing"||ht.test_type==="speaking"||Nt.test_type==="speaking"||ht.score!==null&&ht.score!==void 0)?c.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[ht.test_type==="drawing"?c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>yr(ht),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View"}),He.current.has(Nt.test_name)?c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"number",min:"0",max:ht.max_score||100,value:it.current[Nt.test_name]?.[Le.student_id]?.score||ht.score||"",onChange:Qt=>vt(Nt.test_name,Le.student_id,"score",Qt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),c.jsx("span",{className:"text-xs text-gray-500",children:"/"}),c.jsx("input",{type:"number",min:"1",value:it.current[Nt.test_name]?.[Le.student_id]?.maxScore||ht.max_score||100,onChange:Qt=>vt(Nt.test_name,Le.student_id,"maxScore",Qt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):(()=>{const Qt=l(ht),Pt=Qt!==null&&Qt<50,es=Qt!==null&&Qt>=50&&Qt<70,Jr=ht.retest_offered,Nr=Qt===null?"text-gray-600":Pt?"text-red-600 font-semibold":es?"text-yellow-600":"text-green-600";return c.jsxs(st.div,{className:`px-1 py-0.5 rounded text-xs font-medium ${Nr} ${Pt?"cursor-pointer hover:opacity-90":""} ${Jr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Pt?{color:"#b91c1c"}:void 0,whileHover:{scale:Pt?1.05:1},transition:{duration:.15},onDoubleClick:()=>Hr(Nt.test_name),onClick:Pt?os=>{if(os.preventDefault(),os.stopPropagation(),ht?.retest_offered){o("Retest is already offered","info");return}n({failedStudentIds:[Le.student_id],test_type:Nt.test_type,original_test_id:ht?.test_id||Nt.test_id,subject_id:ht?.subject_id||Nt.subject_id,grade:t,class:r})}:void 0,title:Jr?"Retest offered":Pt?"Offer retest":"Double-click to edit column",children:[c.jsx("span",{className:Pt?"text-red-700":"",children:ht.score}),"/",c.jsx("span",{children:ht.max_score}),ht.caught_cheating&&c.jsx("span",{className:"ml-1",children:""})]})})()]}):ht.test_type==="speaking"||Nt.test_type==="speaking"?c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>wr({...ht,__studentId:Le.student_id},"audio"),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View Audio"}),kt&&kt.resultId===ht.result_id?c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"number",min:"0",max:ht.max_score||100,value:at,onChange:Qt=>Ce(Qt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),c.jsx("button",{onClick:()=>Er(),disabled:Ve,className:"px-1 py-0.5 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50",children:Ve?"Saving...":"Save"}),c.jsx("button",{onClick:()=>qr(),disabled:Ve,className:"px-1 py-0.5 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):(()=>{const Qt=l(ht),Pt=Qt!==null&&Qt<50,es=Qt!==null&&Qt>=50&&Qt<70,Jr=ht.retest_offered,Nr=Qt===null?"text-gray-600":Pt?"text-red-600 font-semibold":es?"text-yellow-600":"text-green-600";return c.jsxs(st.div,{className:`px-1 py-0.5 rounded text-xs font-medium ${Nr} ${Pt?"cursor-pointer hover:opacity-90":""} ${Jr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Pt?{color:"#b91c1c"}:void 0,whileHover:{scale:Pt?1.05:1},transition:{duration:.15},onDoubleClick:()=>{Oe({resultId:ht.result_id,score:ht.score}),Ce(ht.score?.toString()||"")},onClick:Pt?os=>{if(os.preventDefault(),os.stopPropagation(),ht?.retest_offered){o("Retest is already offered","info");return}n({failedStudentIds:[Le.student_id],test_type:Nt.test_type,original_test_id:ht?.test_id||Nt.test_id,subject_id:ht?.subject_id||Nt.subject_id,grade:t,class:r})}:void 0,title:Jr?"Retest offered":Pt?"Offer retest":"Double-click to edit score",children:[c.jsx("span",{className:Pt?"text-red-700":"",children:ht.score||0}),"/",c.jsx("span",{children:ht.max_score||100}),ht.caught_cheating&&c.jsx("span",{className:"ml-1",children:""})]})})()]}):(()=>{const Qt=l(ht),Pt=Qt!==null&&Qt<50,es=Qt!==null&&Qt>=50&&Qt<70,Jr=Qt!==null&&Qt>=70,Nr=ht?.retest_offered===!0;console.debug("[TeacherResults] Render pill",{studentId:Le.student_id,pct:Qt,isRed:Pt,isYellow:es,isGreen:Jr,score:ht.score,max:ht.max_score,percentageField:ht.percentage});const li=`px-1 py-0.5 rounded text-xs font-medium ${Qt===null?"text-gray-600":Pt?"text-red-600 font-semibold":es?"text-yellow-600":"text-green-600"} ${Pt?"cursor-pointer hover:opacity-90 pointer-events-auto":""} ${Nr?"bg-blue-50 text-blue-700 border border-blue-200":""}`;return c.jsxs(st.div,{className:li,style:Pt?{color:"#b91c1c"}:void 0,whileHover:{scale:Pt?1.05:1},transition:{duration:.15},onClick:Pt?Go=>{if(Go.preventDefault(),Go.stopPropagation(),ht?.retest_offered){o("Retest is already offered","info");return}const cc=window.getComputedStyle(Go.currentTarget).color;console.debug("[TeacherResults] Red pill clicked -> opening retest modal",{studentId:Le.student_id,className:li,computedColor:cc}),n({failedStudentIds:[Le.student_id],test_type:Nt.test_type,original_test_id:ht?.test_id||Nt.test_id,subject_id:ht?.subject_id||Nt.subject_id,grade:t,class:r})}:void 0,title:Nr?"Retest offered":Pt?"Offer retest":"",children:[c.jsx("span",{className:Pt?"text-red-700":"",children:ht.score}),"/",c.jsx("span",{children:ht.max_score}),ht.caught_cheating&&c.jsx("span",{className:"ml-1",children:""})]})})(),ht.caught_cheating&&ht.visibility_change_times&&c.jsxs("span",{className:"text-xs text-red-600",children:["(",ht.visibility_change_times,")"]})]}):c.jsx("span",{className:"text-gray-400",children:"-"})},mr)})]},Et))})})]})})})}),[Ht,ke,oe,ge]),Bn=S.useCallback(()=>{if(!U)return null;console.log(" renderResults - results:",U),console.log(" renderResults - results.class:",U.class),console.log(" renderResults - results.unique_tests:",U.unique_tests);const et=U.class&&Array.isArray(U.class)&&U.class.length>0;if(console.log(" renderResults - hasStudentData:",et),!et)return console.log(" renderResults - No student data, showing no students message"),c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No students found for this class and semester."})});const we=U.unique_tests||[];return console.log(" renderResults - uniqueTests:",we),Ye.current=U,c.jsxs("div",{className:"space-y-6",children:[c.jsxs(st.div,{className:"bg-gradient-to-r from-red-500 to-pink-500 rounded-lg p-6 text-white",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[c.jsxs(st.h2,{className:"text-2xl font-bold mb-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.1},children:["Test Results - Grade M",B,", Class ",B,"/",q,", Semester ",C]}),c.jsxs(st.p,{className:"text-cyan-100",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.2},children:["Viewing results for ",U.subjects?.length||0," subject(s)"]}),c.jsxs(st.div,{className:"mt-4 flex gap-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:[c.jsx("button",{onClick:()=>{const $e=U.unique_tests?.map(Le=>Le.test_name)||[];re(new Set($e))},className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Collapse All Tests"}),c.jsx("button",{onClick:()=>re(new Set),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Expand All Tests"})]})]}),c.jsxs(st.div,{className:"bg-white rounded-lg shadow p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},children:[c.jsx(st.h3,{className:"text-lg font-semibold text-gray-900 mb-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},children:"Class Results"}),c.jsx("div",{className:"hidden md:block",children:xr("All Subjects",U.class,we)}),c.jsx("div",{className:"md:hidden",children:br("All Subjects",U.class,we)})]})]})},[U,xr,B,q,C]),An=S.useCallback(()=>{if(!U||!U.class||!U.unique_tests)return;const et=["Student ID","Name","Surname","No.","Nickname",...U.unique_tests.map(mr=>mr.test_name)],we=U.class.map((mr,an)=>{const ht=[];return ht.push(mr.student_id),ht.push(mr.name),ht.push(mr.surname),ht.push(mr.number??an+1),ht.push(mr.nickname||"-"),U.unique_tests.forEach(Qt=>{const Pt=mr[Qt.test_name];Pt&&Pt.score!==null&&Pt.score!==void 0?ht.push(`${Pt.score}/${Pt.max_score}`):ht.push("-")}),ht}),$e=ab.aoa_to_sheet([et,...we]),Le=ab.book_new(),Et=[{wch:10},{wch:15},{wch:15},{wch:6},{wch:12},...U.unique_tests.map(()=>({wch:15}))];$e["!cols"]=Et,ab.book_append_sheet(Le,$e,"Class Results");const Nt=`class-results-${B}-${q}-semester-${C}.xlsx`;axe(Le,Nt),o("Excel file exported successfully!","success")},[U,B,q,C,o]);return h?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(Ur,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Results..."})]})}):p?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:p}),c.jsx(Je,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsx("div",{className:"flex justify-between items-center py-4",children:c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Class Results"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",ee?ee.toLocaleString():"Never"]})]})})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Class"}),F.length>0?(()=>{const et=F.reduce((we,$e)=>{const Le=$e.subject||"Unknown Subject";return we[Le]||(we[Le]=[]),we[Le].push($e),we},{});return c.jsx("div",{className:"space-y-6",children:Object.entries(et).map(([we,$e])=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsxs("h3",{className:"text-md font-semibold text-gray-800 mb-3 flex flex-col sm:flex-row sm:items-center items-center",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),we]}),c.jsxs("span",{className:"ml-0 sm:ml-2 text-sm text-gray-500 mt-1 sm:mt-0",children:["(",$e.length," classes)"]})]}),c.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:$e.map((Le,Et)=>c.jsxs(Je,{variant:B===Le.grade&&q===Le.class?"primary":"outline",onClick:()=>ut(Le.grade,Le.class),className:"px-3 py-1 text-xs font-medium min-w-[60px]",children:[Le.grade,"/",Le.class]},`${Le.grade}-${Le.class}-${Et}`))})]},we))})})():c.jsx("p",{className:"text-gray-500",children:"No classes available"})]}),q&&Kt(),q&&U&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[B," ",q," - Test Results ",je?`(Term ${Ue?.terms.find(et=>et.id===je)?.term})`:""]}),c.jsx("div",{className:"flex space-x-3",children:c.jsxs("button",{type:"button",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-2",onClick:An,children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-4 h-4 object-contain"}),c.jsx("span",{className:"font-medium text-sm",children:"Export Excel"})]})})]}),Bn()]}),q&&!U&&c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsx("div",{className:"flex items-center justify-center py-8",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-gray-200 border-t-blue-500"}),c.jsx("span",{className:"text-gray-600",children:"Loading results"})]})})})]})}),Qe&&Be&&c.jsx(NF,{children:c.jsx(zB,{drawing:Qe,isOpen:Be,onClose:()=>ct(!1),isTeacherView:!0,onSaveScore:async({resultId:et,score:we,maxScore:$e})=>{try{const Le=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token");if(!(await fetch(Kx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:Le?`Bearer ${Le}`:""},body:JSON.stringify({resultId:et,score:we,maxScore:$e})})).ok)throw new Error("Failed to save");await ft(C,!0)}catch{o("Failed to save drawing score","error")}}})}),We&&Tt&&c.jsx(NF,{children:c.jsx(gie,{result:We,isOpen:Tt,onClose:()=>jt(!1),initialTab:We.__initialTab||"overview",editingSpeakingScore:kt,tempSpeakingScore:at,isSavingSpeakingScore:Ve,onStartSpeakingScoreEdit:vr,onSaveSpeakingScore:Er,onCancelSpeakingScoreEdit:qr,onTempSpeakingScoreChange:Ce})})]})},pxe={getTestPerformance:async(e,t=null)=>{try{await Qu.loadAcademicCalendar();const n=Qu.getCurrentTerm()?.id;if(!n)throw new Error("No current academic period found");console.log(` Fetching test performance for teacher ${e}, period ${n}, class: ${t||"all"}`);let s=`/.netlify/functions/get-test-performance?teacher_id=${e}&academic_period_id=${n}`;if(t){const[o,l]=t.split("/"),u=o.startsWith("M")?o:`M${o}`;s+=`&grade=${u}&class=${l}`}const a=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const i=await a.json();if(!i.success)throw new Error(i.error||"Failed to fetch performance data");return console.log(` Performance data loaded: ${i.count} tests`),i.data}catch(r){throw console.error(" Error fetching test performance:",r),r}}};function tz(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=tz(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Jn(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=tz(e))&&(n&&(n+=" "),n+=t);return n}var Fk={},Ok={},LO;function xxe(){return LO||(LO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Ok)),Ok}var Dk={},BO;function rz(){return BO||(BO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Dk)),Dk}var Rk={},$O;function nz(){return $O||($O=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(Rk)),Rk}var Ik={},UO;function I3(){return UO||(UO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){const n=[],s=r.length;if(s===0)return n;let a=0,i="",o="",l=!1;for(r.charCodeAt(0)===46&&(n.push(""),a++);a<s;){const u=r[a];o?u==="\\"&&a+1<s?(a++,i+=r[a]):u===o?o="":i+=u:l?u==='"'||u==="'"?o=u:u==="]"?(l=!1,n.push(i),i=""):i+=u:u==="["?(l=!0,i&&(n.push(i),i="")):u==="."?i&&(n.push(i),i=""):i+=u,a++}return i&&n.push(i),n}e.toPath=t})(Ik)),Ik}var zO;function M3(){return zO||(zO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xxe(),r=rz(),n=nz(),s=I3();function a(o,l,u){if(o==null)return u;switch(typeof l){case"string":{if(t.isUnsafeProperty(l))return u;const d=o[l];return d===void 0?r.isDeepKey(l)?a(o,s.toPath(l),u):u:d}case"number":case"symbol":{typeof l=="number"&&(l=n.toKey(l));const d=o[l];return d===void 0?u:d}default:{if(Array.isArray(l))return i(o,l,u);if(Object.is(l?.valueOf(),-0)?l="-0":l=String(l),t.isUnsafeProperty(l))return u;const d=o[l];return d===void 0?u:d}}}function i(o,l,u){if(l.length===0)return u;let d=o;for(let h=0;h<l.length;h++){if(d==null||t.isUnsafeProperty(l[h]))return u;d=d[l[h]]}return d===void 0?u:d}e.get=a})(Fk)),Fk}var Mk,WO;function yxe(){return WO||(WO=1,Mk=M3().get),Mk}var vxe=yxe();const h2=Nl(vxe);var Lk={exports:{}},wn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HO;function wxe(){if(HO)return wn;HO=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,s=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,i=e?Symbol.for("react.provider"):60109,o=e?Symbol.for("react.context"):60110,l=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,d=e?Symbol.for("react.forward_ref"):60112,h=e?Symbol.for("react.suspense"):60113,g=e?Symbol.for("react.suspense_list"):60120,p=e?Symbol.for("react.memo"):60115,x=e?Symbol.for("react.lazy"):60116,v=e?Symbol.for("react.block"):60121,w=e?Symbol.for("react.fundamental"):60117,C=e?Symbol.for("react.responder"):60118,k=e?Symbol.for("react.scope"):60119;function _(E){if(typeof E=="object"&&E!==null){var P=E.$$typeof;switch(P){case t:switch(E=E.type,E){case l:case u:case n:case a:case s:case h:return E;default:switch(E=E&&E.$$typeof,E){case o:case d:case x:case p:case i:return E;default:return P}}case r:return P}}}function N(E){return _(E)===u}return wn.AsyncMode=l,wn.ConcurrentMode=u,wn.ContextConsumer=o,wn.ContextProvider=i,wn.Element=t,wn.ForwardRef=d,wn.Fragment=n,wn.Lazy=x,wn.Memo=p,wn.Portal=r,wn.Profiler=a,wn.StrictMode=s,wn.Suspense=h,wn.isAsyncMode=function(E){return N(E)||_(E)===l},wn.isConcurrentMode=N,wn.isContextConsumer=function(E){return _(E)===o},wn.isContextProvider=function(E){return _(E)===i},wn.isElement=function(E){return typeof E=="object"&&E!==null&&E.$$typeof===t},wn.isForwardRef=function(E){return _(E)===d},wn.isFragment=function(E){return _(E)===n},wn.isLazy=function(E){return _(E)===x},wn.isMemo=function(E){return _(E)===p},wn.isPortal=function(E){return _(E)===r},wn.isProfiler=function(E){return _(E)===a},wn.isStrictMode=function(E){return _(E)===s},wn.isSuspense=function(E){return _(E)===h},wn.isValidElementType=function(E){return typeof E=="string"||typeof E=="function"||E===n||E===u||E===a||E===s||E===h||E===g||typeof E=="object"&&E!==null&&(E.$$typeof===x||E.$$typeof===p||E.$$typeof===i||E.$$typeof===o||E.$$typeof===d||E.$$typeof===w||E.$$typeof===C||E.$$typeof===k||E.$$typeof===v)},wn.typeOf=_,wn}var GO;function bxe(){return GO||(GO=1,Lk.exports=wxe()),Lk.exports}bxe();var yl=e=>e===0?0:e>0?1:-1,Cl=e=>typeof e=="number"&&e!=+e,Fh=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Ir=e=>(typeof e=="number"||e instanceof Number)&&!Cl(e),Xc=e=>Ir(e)||typeof e=="string",_xe=0,uv=e=>{var t=++_xe;return"".concat(e||"").concat(t)},Ef=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ir(t)&&typeof t!="string")return n;var a;if(Fh(t)){if(r==null)return n;var i=t.indexOf("%");a=r*parseFloat(t.slice(0,i))/100}else a=+t;return Cl(a)&&(a=n),s&&r!=null&&a>r&&(a=r),a},sz=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function Ru(e,t,r){return Ir(e)&&Ir(t)?e+r*(t-e):t}function az(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):h2(n,t))===r)}var Oa=e=>e===null||typeof e>"u",L3=e=>Oa(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),Sxe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function B3(e){if(typeof e!="string")return!1;var t=Sxe;return t.includes(e)}var kxe=["viewBox","children"],VO=["points","pathLength"],Bk={svg:kxe,polygon:VO,polyline:VO},$3=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(S.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(s=>{B3(s)&&(n[s]=(a=>r[s](r,a)))}),n},Cxe=(e,t,r)=>n=>(e(t,r,n),null),Txe=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(s=>{var a=e[s];B3(s)&&typeof a=="function"&&(n||(n={}),n[s]=Cxe(a,t,r))}),n},Exe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function iz(e){if(typeof e!="string")return!1;var t=Exe;return t.includes(e)}function F0(e){var t=Object.entries(e).filter(r=>{var[n]=r;return iz(n)});return Object.fromEntries(t)}var oz=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,Nxe=(e,t,r,n)=>{var s;if(typeof t=="symbol"||typeof t=="number")return!0;var a=(s=n&&Bk?.[n])!==null&&s!==void 0?s:[],i=t.startsWith("data-"),o=typeof e!="function"&&(!!n&&a.includes(t)||iz(t)),l=!!r&&B3(t);return i||o||l},ii=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(S.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var s={};return Object.keys(n).forEach(a=>{var i;Nxe((i=n)===null||i===void 0?void 0:i[a],a,t,r)&&(s[a]=n[a])}),s},Axe=["children","width","height","viewBox","className","style","title","desc"];function SE(){return SE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},SE.apply(null,arguments)}function jxe(e,t){if(e==null)return{};var r,n,s=Pxe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function Pxe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var lz=S.forwardRef((e,t)=>{var{children:r,width:n,height:s,viewBox:a,className:i,style:o,title:l,desc:u}=e,d=jxe(e,Axe),h=a||{width:n,height:s,x:0,y:0},g=Jn("recharts-surface",i);return S.createElement("svg",SE({},ii(d,!0,"svg"),{className:g,width:n,height:s,style:o,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:t}),S.createElement("title",null,l),S.createElement("desc",null,u),r)}),Fxe=["children","className"];function kE(){return kE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kE.apply(null,arguments)}function Oxe(e,t){if(e==null)return{};var r,n,s=Dxe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function Dxe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ep=S.forwardRef((e,t)=>{var{children:r,className:n}=e,s=Oxe(e,Fxe),a=Jn("recharts-layer",n);return S.createElement("g",kE({className:a},ii(s,!0),{ref:t}),r)}),Rxe=S.createContext(null);function ws(e){return function(){return e}}const CE=Math.PI,TE=2*CE,Sh=1e-6,Ixe=TE-Sh;function cz(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Mxe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return cz;const r=10**t;return function(n){this._+=n[0];for(let s=1,a=n.length;s<a;++s)this._+=Math.round(arguments[s]*r)/r+n[s]}}class Lxe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?cz:Mxe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,s){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+s}`}bezierCurveTo(t,r,n,s,a,i){this._append`C${+t},${+r},${+n},${+s},${this._x1=+a},${this._y1=+i}`}arcTo(t,r,n,s,a){if(t=+t,r=+r,n=+n,s=+s,a=+a,a<0)throw new Error(`negative radius: ${a}`);let i=this._x1,o=this._y1,l=n-t,u=s-r,d=i-t,h=o-r,g=d*d+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(g>Sh)if(!(Math.abs(h*l-u*d)>Sh)||!a)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-i,x=s-o,v=l*l+u*u,w=p*p+x*x,C=Math.sqrt(v),k=Math.sqrt(g),_=a*Math.tan((CE-Math.acos((v+g-w)/(2*C*k)))/2),N=_/k,E=_/C;Math.abs(N-1)>Sh&&this._append`L${t+N*d},${r+N*h}`,this._append`A${a},${a},0,0,${+(h*p>d*x)},${this._x1=t+E*l},${this._y1=r+E*u}`}}arc(t,r,n,s,a,i){if(t=+t,r=+r,n=+n,i=!!i,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(s),l=n*Math.sin(s),u=t+o,d=r+l,h=1^i,g=i?s-a:a-s;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Sh||Math.abs(this._y1-d)>Sh)&&this._append`L${u},${d}`,n&&(g<0&&(g=g%TE+TE),g>Ixe?this._append`A${n},${n},0,1,${h},${t-o},${r-l}A${n},${n},0,1,${h},${this._x1=u},${this._y1=d}`:g>Sh&&this._append`A${n},${n},0,${+(g>=CE)},${h},${this._x1=t+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(t,r,n,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+s}h${-n}Z`}toString(){return this._}}function uz(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new Lxe(t)}function U3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function dz(e){this._context=e}dz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function g2(e){return new dz(e)}function fz(e){return e[0]}function hz(e){return e[1]}function gz(e,t){var r=ws(!0),n=null,s=g2,a=null,i=uz(o);e=typeof e=="function"?e:e===void 0?fz:ws(e),t=typeof t=="function"?t:t===void 0?hz:ws(t);function o(l){var u,d=(l=U3(l)).length,h,g=!1,p;for(n==null&&(a=s(p=i())),u=0;u<=d;++u)!(u<d&&r(h=l[u],u,l))===g&&((g=!g)?a.lineStart():a.lineEnd()),g&&a.point(+e(h,u,l),+t(h,u,l));if(p)return a=null,p+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:ws(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:ws(+l),o):t},o.defined=function(l){return arguments.length?(r=typeof l=="function"?l:ws(!!l),o):r},o.curve=function(l){return arguments.length?(s=l,n!=null&&(a=s(n)),o):s},o.context=function(l){return arguments.length?(l==null?n=a=null:a=s(n=l),o):n},o}function Rw(e,t,r){var n=null,s=ws(!0),a=null,i=g2,o=null,l=uz(u);e=typeof e=="function"?e:e===void 0?fz:ws(+e),t=typeof t=="function"?t:ws(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?hz:ws(+r);function u(h){var g,p,x,v=(h=U3(h)).length,w,C=!1,k,_=new Array(v),N=new Array(v);for(a==null&&(o=i(k=l())),g=0;g<=v;++g){if(!(g<v&&s(w=h[g],g,h))===C)if(C=!C)p=g,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),x=g-1;x>=p;--x)o.point(_[x],N[x]);o.lineEnd(),o.areaEnd()}C&&(_[g]=+e(w,g,h),N[g]=+t(w,g,h),o.point(n?+n(w,g,h):_[g],r?+r(w,g,h):N[g]))}if(k)return o=null,k+""||null}function d(){return gz().defined(s).curve(i).context(a)}return u.x=function(h){return arguments.length?(e=typeof h=="function"?h:ws(+h),n=null,u):e},u.x0=function(h){return arguments.length?(e=typeof h=="function"?h:ws(+h),u):e},u.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:ws(+h),u):n},u.y=function(h){return arguments.length?(t=typeof h=="function"?h:ws(+h),r=null,u):t},u.y0=function(h){return arguments.length?(t=typeof h=="function"?h:ws(+h),u):t},u.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:ws(+h),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(h){return arguments.length?(s=typeof h=="function"?h:ws(!!h),u):s},u.curve=function(h){return arguments.length?(i=h,a!=null&&(o=i(a)),u):i},u.context=function(h){return arguments.length?(h==null?a=o=null:o=i(a=h),u):a},u}class mz{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function Bxe(e){return new mz(e,!0)}function $xe(e){return new mz(e,!1)}function Xb(){}function Jb(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function pz(e){this._context=e}pz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Jb(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Jb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Uxe(e){return new pz(e)}function xz(e){this._context=e}xz.prototype={areaStart:Xb,areaEnd:Xb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Jb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function zxe(e){return new xz(e)}function yz(e){this._context=e}yz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Jb(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Wxe(e){return new yz(e)}function vz(e){this._context=e}vz.prototype={areaStart:Xb,areaEnd:Xb,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Hxe(e){return new vz(e)}function KO(e){return e<0?-1:1}function qO(e,t,r){var n=e._x1-e._x0,s=t-e._x1,a=(e._y1-e._y0)/(n||s<0&&-0),i=(r-e._y1)/(s||n<0&&-0),o=(a*s+i*n)/(n+s);return(KO(a)+KO(i))*Math.min(Math.abs(a),Math.abs(i),.5*Math.abs(o))||0}function YO(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function $k(e,t,r){var n=e._x0,s=e._y0,a=e._x1,i=e._y1,o=(a-n)/3;e._context.bezierCurveTo(n+o,s+o*t,a-o,i-o*r,a,i)}function Qb(e){this._context=e}Qb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:$k(this,this._t0,YO(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,$k(this,YO(this,r=qO(this,e,t)),r);break;default:$k(this,this._t0,r=qO(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function wz(e){this._context=new bz(e)}(wz.prototype=Object.create(Qb.prototype)).point=function(e,t){Qb.prototype.point.call(this,t,e)};function bz(e){this._context=e}bz.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,s,a){this._context.bezierCurveTo(t,e,n,r,a,s)}};function Gxe(e){return new Qb(e)}function Vxe(e){return new wz(e)}function _z(e){this._context=e}_z.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=XO(e),s=XO(t),a=0,i=1;i<r;++a,++i)this._context.bezierCurveTo(n[0][a],s[0][a],n[1][a],s[1][a],e[i],t[i]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function XO(e){var t,r=e.length-1,n,s=new Array(r),a=new Array(r),i=new Array(r);for(s[0]=0,a[0]=2,i[0]=e[0]+2*e[1],t=1;t<r-1;++t)s[t]=1,a[t]=4,i[t]=4*e[t]+2*e[t+1];for(s[r-1]=2,a[r-1]=7,i[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=s[t]/a[t-1],a[t]-=n,i[t]-=n*i[t-1];for(s[r-1]=i[r-1]/a[r-1],t=r-2;t>=0;--t)s[t]=(i[t]-s[t+1])/a[t];for(a[r-1]=(e[r]+s[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-s[t+1];return[s,a]}function Kxe(e){return new _z(e)}function m2(e,t){this._context=e,this._t=t}m2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function qxe(e){return new m2(e,.5)}function Yxe(e){return new m2(e,0)}function Xxe(e){return new m2(e,1)}function Tm(e,t){if((i=e.length)>1)for(var r=1,n,s,a=e[t[0]],i,o=a.length;r<i;++r)for(s=a,a=e[t[r]],n=0;n<o;++n)a[n][1]+=a[n][0]=isNaN(s[n][1])?s[n][0]:s[n][1]}function EE(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Jxe(e,t){return e[t]}function Qxe(e){const t=[];return t.key=e,t}function Zxe(){var e=ws([]),t=EE,r=Tm,n=Jxe;function s(a){var i=Array.from(e.apply(this,arguments),Qxe),o,l=i.length,u=-1,d;for(const h of a)for(o=0,++u;o<l;++o)(i[o][u]=[0,+n(h,i[o].key,u,a)]).data=h;for(o=0,d=U3(t(i));o<l;++o)i[d[o]].index=o;return r(i,d),i}return s.keys=function(a){return arguments.length?(e=typeof a=="function"?a:ws(Array.from(a)),s):e},s.value=function(a){return arguments.length?(n=typeof a=="function"?a:ws(+a),s):n},s.order=function(a){return arguments.length?(t=a==null?EE:typeof a=="function"?a:ws(Array.from(a)),s):t},s.offset=function(a){return arguments.length?(r=a??Tm,s):r},s}function eye(e,t){if((n=e.length)>0){for(var r,n,s=0,a=e[0].length,i;s<a;++s){for(i=r=0;r<n;++r)i+=e[r][s][1]||0;if(i)for(r=0;r<n;++r)e[r][s][1]/=i}Tm(e,t)}}function tye(e,t){if((s=e.length)>0){for(var r=0,n=e[t[0]],s,a=n.length;r<a;++r){for(var i=0,o=0;i<s;++i)o+=e[i][r][1]||0;n[r][1]+=n[r][0]=-o/2}Tm(e,t)}}function rye(e,t){if(!(!((i=e.length)>0)||!((a=(s=e[t[0]]).length)>0))){for(var r=0,n=1,s,a,i;n<a;++n){for(var o=0,l=0,u=0;o<i;++o){for(var d=e[t[o]],h=d[n][1]||0,g=d[n-1][1]||0,p=(h-g)/2,x=0;x<o;++x){var v=e[t[x]],w=v[n][1]||0,C=v[n-1][1]||0;p+=w-C}l+=h,u+=p*h}s[n-1][1]+=s[n-1][0]=r,l&&(r-=u/l)}s[n-1][1]+=s[n-1][0]=r,Tm(e,t)}}var Uk={},zk={},JO;function nye(){return JO||(JO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const s=new Map;for(let a=0;a<r.length;a++){const i=r[a],o=n(i);s.has(o)||s.set(o,i)}return Array.from(s.values())}e.uniqBy=t})(zk)),zk}var Wk={},QO;function Sz(){return QO||(QO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Wk)),Wk}var Hk={},Gk={},Vk={},ZO;function sye(){return ZO||(ZO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Vk)),Vk}var eD;function z3(){return eD||(eD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sye();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(Gk)),Gk}var Kk={},tD;function aye(){return tD||(tD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(Kk)),Kk}var rD;function iye(){return rD||(rD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=z3(),r=aye();function n(s){return r.isObjectLike(s)&&t.isArrayLike(s)}e.isArrayLikeObject=n})(Hk)),Hk}var qk={},Yk={},nD;function oye(){return nD||(nD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=M3();function r(n){return function(s){return t.get(s,n)}}e.property=r})(Yk)),Yk}var Xk={},Jk={},Qk={},Zk={},sD;function kz(){return sD||(sD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Zk)),Zk}var eC={},aD;function Cz(){return aD||(aD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(eC)),eC}var tC={},iD;function Tz(){return iD||(iD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(tC)),tC}var oD;function lye(){return oD||(oD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=W3(),r=kz(),n=Cz(),s=Tz();function a(h,g,p){return typeof p!="function"?t.isMatch(h,g):i(h,g,function x(v,w,C,k,_,N){const E=p(v,w,C,k,_,N);return E!==void 0?!!E:i(v,w,x,N)},new Map)}function i(h,g,p,x){if(g===h)return!0;switch(typeof g){case"object":return o(h,g,p,x);case"function":return Object.keys(g).length>0?i(h,{...g},p,x):s.eq(h,g);default:return r.isObject(h)?typeof g=="string"?g==="":!0:s.eq(h,g)}}function o(h,g,p,x){if(g==null)return!0;if(Array.isArray(g))return u(h,g,p,x);if(g instanceof Map)return l(h,g,p,x);if(g instanceof Set)return d(h,g,p,x);const v=Object.keys(g);if(h==null)return v.length===0;if(v.length===0)return!0;if(x&&x.has(g))return x.get(g)===h;x&&x.set(g,h);try{for(let w=0;w<v.length;w++){const C=v[w];if(!n.isPrimitive(h)&&!(C in h)||g[C]===void 0&&h[C]!==void 0||g[C]===null&&h[C]!==null||!p(h[C],g[C],C,h,g,x))return!1}return!0}finally{x&&x.delete(g)}}function l(h,g,p,x){if(g.size===0)return!0;if(!(h instanceof Map))return!1;for(const[v,w]of g.entries()){const C=h.get(v);if(p(C,w,v,h,g,x)===!1)return!1}return!0}function u(h,g,p,x){if(g.length===0)return!0;if(!Array.isArray(h))return!1;const v=new Set;for(let w=0;w<g.length;w++){const C=g[w];let k=!1;for(let _=0;_<h.length;_++){if(v.has(_))continue;const N=h[_];let E=!1;if(p(N,C,w,h,g,x)&&(E=!0),E){v.add(_),k=!0;break}}if(!k)return!1}return!0}function d(h,g,p,x){return g.size===0?!0:h instanceof Set?u([...h],[...g],p,x):!1}e.isMatchWith=a,e.isSetMatch=d})(Qk)),Qk}var lD;function W3(){return lD||(lD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lye();function r(n,s){return t.isMatchWith(n,s,()=>{})}e.isMatch=r})(Jk)),Jk}var rC={},nC={},sC={},cD;function cye(){return cD||(cD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(sC)),sC}var aC={},uD;function Ez(){return uD||(uD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(aC)),aC}var iC={},dD;function Nz(){return dD||(dD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",s="[object Boolean]",a="[object Arguments]",i="[object Symbol]",o="[object Date]",l="[object Map]",u="[object Set]",d="[object Array]",h="[object Function]",g="[object ArrayBuffer]",p="[object Object]",x="[object Error]",v="[object DataView]",w="[object Uint8Array]",C="[object Uint8ClampedArray]",k="[object Uint16Array]",_="[object Uint32Array]",N="[object BigUint64Array]",E="[object Int8Array]",P="[object Int16Array]",F="[object Int32Array]",A="[object BigInt64Array]",j="[object Float32Array]",R="[object Float64Array]";e.argumentsTag=a,e.arrayBufferTag=g,e.arrayTag=d,e.bigInt64ArrayTag=A,e.bigUint64ArrayTag=N,e.booleanTag=s,e.dataViewTag=v,e.dateTag=o,e.errorTag=x,e.float32ArrayTag=j,e.float64ArrayTag=R,e.functionTag=h,e.int16ArrayTag=P,e.int32ArrayTag=F,e.int8ArrayTag=E,e.mapTag=l,e.numberTag=n,e.objectTag=p,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=i,e.uint16ArrayTag=k,e.uint32ArrayTag=_,e.uint8ArrayTag=w,e.uint8ClampedArrayTag=C})(iC)),iC}var oC={},fD;function uye(){return fD||(fD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(oC)),oC}var hD;function Az(){return hD||(hD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cye(),r=Ez(),n=Nz(),s=Cz(),a=uye();function i(d,h){return o(d,void 0,d,new Map,h)}function o(d,h,g,p=new Map,x=void 0){const v=x?.(d,h,g,p);if(v!==void 0)return v;if(s.isPrimitive(d))return d;if(p.has(d))return p.get(d);if(Array.isArray(d)){const w=new Array(d.length);p.set(d,w);for(let C=0;C<d.length;C++)w[C]=o(d[C],C,g,p,x);return Object.hasOwn(d,"index")&&(w.index=d.index),Object.hasOwn(d,"input")&&(w.input=d.input),w}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const w=new RegExp(d.source,d.flags);return w.lastIndex=d.lastIndex,w}if(d instanceof Map){const w=new Map;p.set(d,w);for(const[C,k]of d)w.set(C,o(k,C,g,p,x));return w}if(d instanceof Set){const w=new Set;p.set(d,w);for(const C of d)w.add(o(C,void 0,g,p,x));return w}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(a.isTypedArray(d)){const w=new(Object.getPrototypeOf(d)).constructor(d.length);p.set(d,w);for(let C=0;C<d.length;C++)w[C]=o(d[C],C,g,p,x);return w}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const w=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return p.set(d,w),l(w,d,g,p,x),w}if(typeof File<"u"&&d instanceof File){const w=new File([d],d.name,{type:d.type});return p.set(d,w),l(w,d,g,p,x),w}if(d instanceof Blob){const w=new Blob([d],{type:d.type});return p.set(d,w),l(w,d,g,p,x),w}if(d instanceof Error){const w=new d.constructor;return p.set(d,w),w.message=d.message,w.name=d.name,w.stack=d.stack,w.cause=d.cause,l(w,d,g,p,x),w}if(typeof d=="object"&&u(d)){const w=Object.create(Object.getPrototypeOf(d));return p.set(d,w),l(w,d,g,p,x),w}return d}function l(d,h,g=d,p,x){const v=[...Object.keys(h),...t.getSymbols(h)];for(let w=0;w<v.length;w++){const C=v[w],k=Object.getOwnPropertyDescriptor(d,C);(k==null||k.writable)&&(d[C]=o(h[C],C,g,p,x))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=i,e.cloneDeepWithImpl=o,e.copyProperties=l})(nC)),nC}var gD;function dye(){return gD||(gD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Az();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(rC)),rC}var mD;function fye(){return mD||(mD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=W3(),r=dye();function n(s){return s=r.cloneDeep(s),a=>t.isMatch(a,s)}e.matches=n})(Xk)),Xk}var lC={},cC={},uC={},pD;function hye(){return pD||(pD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Az(),r=Nz();function n(s,a){return t.cloneDeepWith(s,(i,o,l,u)=>{const d=a?.(i,o,l,u);if(d!==void 0)return d;if(typeof s=="object")switch(Object.prototype.toString.call(s)){case r.numberTag:case r.stringTag:case r.booleanTag:{const h=new s.constructor(s?.valueOf());return t.copyProperties(h,s),h}case r.argumentsTag:{const h={};return t.copyProperties(h,s),h.length=s.length,h[Symbol.iterator]=s[Symbol.iterator],h}default:return}})}e.cloneDeepWith=n})(uC)),uC}var xD;function gye(){return xD||(xD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=hye();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(cC)),cC}var dC={},fC={},yD;function jz(){return yD||(yD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,s=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<s;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(fC)),fC}var hC={},vD;function mye(){return vD||(vD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ez();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(hC)),hC}var wD;function pye(){return wD||(wD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rz(),r=jz(),n=mye(),s=I3();function a(i,o){let l;if(Array.isArray(o)?l=o:typeof o=="string"&&t.isDeepKey(o)&&i?.[o]==null?l=s.toPath(o):l=[o],l.length===0)return!1;let u=i;for(let d=0;d<l.length;d++){const h=l[d];if((u==null||!Object.hasOwn(u,h))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(h)&&h<u.length))return!1;u=u[h]}return!0}e.has=a})(dC)),dC}var bD;function xye(){return bD||(bD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=W3(),r=nz(),n=gye(),s=M3(),a=pye();function i(o,l){switch(typeof o){case"object":{Object.is(o?.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return l=n.cloneDeep(l),function(u){const d=s.get(u,o);return d===void 0?a.has(u,o):l===void 0?d===void 0:t.isMatch(d,l)}}e.matchesProperty=i})(lC)),lC}var _D;function yye(){return _D||(_D=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Sz(),r=oye(),n=fye(),s=xye();function a(i){if(i==null)return t.identity;switch(typeof i){case"function":return i;case"object":return Array.isArray(i)&&i.length===2?s.matchesProperty(i[0],i[1]):n.matches(i);case"string":case"symbol":case"number":return r.property(i)}}e.iteratee=a})(qk)),qk}var SD;function vye(){return SD||(SD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=nye(),r=Sz(),n=iye(),s=yye();function a(i,o=r.identity){return n.isArrayLikeObject(i)?t.uniqBy(Array.from(i),s.iteratee(o)):[]}e.uniqBy=a})(Uk)),Uk}var gC,kD;function wye(){return kD||(kD=1,gC=vye().uniqBy),gC}var bye=wye();const CD=Nl(bye);function _ye(e,t,r){return t===!0?CD(e,r):typeof t=="function"?CD(e,t):e}var mC={exports:{}},pC={},xC={exports:{}},yC={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TD;function Sye(){if(TD)return yC;TD=1;var e=b0();function t(h,g){return h===g&&(h!==0||1/h===1/g)||h!==h&&g!==g}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,s=e.useEffect,a=e.useLayoutEffect,i=e.useDebugValue;function o(h,g){var p=g(),x=n({inst:{value:p,getSnapshot:g}}),v=x[0].inst,w=x[1];return a(function(){v.value=p,v.getSnapshot=g,l(v)&&w({inst:v})},[h,p,g]),s(function(){return l(v)&&w({inst:v}),h(function(){l(v)&&w({inst:v})})},[h]),i(p),p}function l(h){var g=h.getSnapshot;h=h.value;try{var p=g();return!r(h,p)}catch{return!0}}function u(h,g){return g()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return yC.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,yC}var ED;function kye(){return ED||(ED=1,xC.exports=Sye()),xC.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ND;function Cye(){if(ND)return pC;ND=1;var e=b0(),t=kye();function r(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var n=typeof Object.is=="function"?Object.is:r,s=t.useSyncExternalStore,a=e.useRef,i=e.useEffect,o=e.useMemo,l=e.useDebugValue;return pC.useSyncExternalStoreWithSelector=function(u,d,h,g,p){var x=a(null);if(x.current===null){var v={hasValue:!1,value:null};x.current=v}else v=x.current;x=o(function(){function C(P){if(!k){if(k=!0,_=P,P=g(P),p!==void 0&&v.hasValue){var F=v.value;if(p(F,P))return N=F}return N=P}if(F=N,n(_,P))return F;var A=g(P);return p!==void 0&&p(F,A)?(_=P,F):(_=P,N=A)}var k=!1,_,N,E=h===void 0?null:h;return[function(){return C(d())},E===null?void 0:function(){return C(E())}]},[d,h,g,p]);var w=s(u,x[0],x[1]);return i(function(){v.hasValue=!0,v.value=w},[w]),l(w),w},pC}var AD;function Tye(){return AD||(AD=1,mC.exports=Cye()),mC.exports}var Eye=Tye(),H3=S.createContext(null),Nye=e=>e,Qi=()=>{var e=S.useContext(H3);return e?e.store.dispatch:Nye},ib=()=>{},Aye=()=>ib,jye=(e,t)=>e===t;function Tr(e){var t=S.useContext(H3);return Eye.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:Aye,t?t.store.getState:ib,t?t.store.getState:ib,t?e:ib,jye)}function Pye(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Fye(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Oye(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var jD=e=>Array.isArray(e)?e:[e];function Dye(e){const t=Array.isArray(e[0])?e[0]:e;return Oye(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Rye(e,t){const r=[],{length:n}=e;for(let s=0;s<n;s++)r.push(e[s].apply(null,t));return r}var Iye=class{constructor(e){this.value=e}deref(){return this.value}},Mye=typeof WeakRef<"u"?WeakRef:Iye,Lye=0,PD=1;function Iw(){return{s:Lye,v:void 0,o:null,p:null}}function Pz(e,t={}){let r=Iw();const{resultEqualityCheck:n}=t;let s,a=0;function i(){let o=r;const{length:l}=arguments;for(let h=0,g=l;h<g;h++){const p=arguments[h];if(typeof p=="function"||typeof p=="object"&&p!==null){let x=o.o;x===null&&(o.o=x=new WeakMap);const v=x.get(p);v===void 0?(o=Iw(),x.set(p,o)):o=v}else{let x=o.p;x===null&&(o.p=x=new Map);const v=x.get(p);v===void 0?(o=Iw(),x.set(p,o)):o=v}}const u=o;let d;if(o.s===PD)d=o.v;else if(d=e.apply(null,arguments),a++,n){const h=s?.deref?.()??s;h!=null&&n(h,d)&&(d=h,a!==0&&a--),s=typeof d=="object"&&d!==null||typeof d=="function"?new Mye(d):d}return u.s=PD,u.v=d,d}return i.clearCache=()=>{r=Iw(),i.resetResultsCount()},i.resultsCount=()=>a,i.resetResultsCount=()=>{a=0},i}function Bye(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...s)=>{let a=0,i=0,o,l={},u=s.pop();typeof u=="object"&&(l=u,u=s.pop()),Pye(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...l},{memoize:h,memoizeOptions:g=[],argsMemoize:p=Pz,argsMemoizeOptions:x=[]}=d,v=jD(g),w=jD(x),C=Dye(s),k=h(function(){return a++,u.apply(null,arguments)},...v),_=p(function(){i++;const E=Rye(C,arguments);return o=k.apply(null,E),o},...w);return Object.assign(_,{resultFunc:u,memoizedResultFunc:k,dependencies:C,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>o,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:h,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var St=Bye(Pz),$ye=Object.assign((e,t=St)=>{Fye(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(a=>e[a]);return t(n,(...a)=>a.reduce((i,o,l)=>(i[r[l]]=o,i),{}))},{withTypes:()=>$ye}),vC={},wC={},bC={},FD;function Uye(){return FD||(FD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,s,a)=>{if(n!==s){const i=t(n),o=t(s);if(i===o&&i===0){if(n<s)return a==="desc"?1:-1;if(n>s)return a==="desc"?-1:1}return a==="desc"?o-i:i-o}return 0};e.compareValues=r})(bC)),bC}var _C={},SC={},OD;function Fz(){return OD||(OD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(SC)),SC}var DD;function zye(){return DD||(DD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fz(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function s(a,i){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||t.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||i!=null&&Object.hasOwn(i,a)}e.isKey=s})(_C)),_C}var RD;function Wye(){return RD||(RD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Uye(),r=zye(),n=I3();function s(a,i,o,l){if(a==null)return[];o=l?void 0:o,Array.isArray(a)||(a=Object.values(a)),Array.isArray(i)||(i=i==null?[null]:[i]),i.length===0&&(i=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(p=>String(p));const u=(p,x)=>{let v=p;for(let w=0;w<x.length&&v!=null;++w)v=v[x[w]];return v},d=(p,x)=>x==null||p==null?x:typeof p=="object"&&"key"in p?Object.hasOwn(x,p.key)?x[p.key]:u(x,p.path):typeof p=="function"?p(x):Array.isArray(p)?u(x,p):typeof x=="object"?x[p]:x,h=i.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:n.toPath(p)}));return a.map(p=>({original:p,criteria:h.map(x=>d(x,p))})).slice().sort((p,x)=>{for(let v=0;v<h.length;v++){const w=t.compareValues(p.criteria[v],x.criteria[v],o[v]);if(w!==0)return w}return 0}).map(p=>p.original)}e.orderBy=s})(wC)),wC}var kC={},ID;function Hye(){return ID||(ID=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const s=[],a=Math.floor(n),i=(o,l)=>{for(let u=0;u<o.length;u++){const d=o[u];Array.isArray(d)&&l<a?i(d,l+1):s.push(d)}};return i(r,0),s}e.flatten=t})(kC)),kC}var CC={},MD;function Oz(){return MD||(MD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jz(),r=z3(),n=kz(),s=Tz();function a(i,o,l){return n.isObject(l)&&(typeof o=="number"&&r.isArrayLike(l)&&t.isIndex(o)&&o<l.length||typeof o=="string"&&o in l)?s.eq(l[o],i):!1}e.isIterateeCall=a})(CC)),CC}var LD;function Gye(){return LD||(LD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Wye(),r=Hye(),n=Oz();function s(a,...i){const o=i.length;return o>1&&n.isIterateeCall(a,i[0],i[1])?i=[]:o>2&&n.isIterateeCall(i[0],i[1],i[2])&&(i=[i[0]]),t.orderBy(a,r.flatten(i),["asc"])}e.sortBy=s})(vC)),vC}var TC,BD;function Vye(){return BD||(BD=1,TC=Gye().sortBy),TC}var Kye=Vye();const p2=Nl(Kye);var Dz=e=>e.legend.settings,qye=e=>e.legend.size,Yye=e=>e.legend.payload;St([Yye,Dz],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?p2(n,r):n});var Mw=1;function Xye(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=S.useState({height:0,left:0,top:0,width:0}),n=S.useCallback(s=>{if(s!=null){var a=s.getBoundingClientRect(),i={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(i.height-t.height)>Mw||Math.abs(i.left-t.left)>Mw||Math.abs(i.top-t.top)>Mw||Math.abs(i.width-t.width)>Mw)&&r({height:i.height,left:i.left,top:i.top,width:i.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function Ya(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Jye=typeof Symbol=="function"&&Symbol.observable||"@@observable",$D=Jye,EC=()=>Math.random().toString(36).substring(7).split("").join("."),Qye={INIT:`@@redux/INIT${EC()}`,REPLACE:`@@redux/REPLACE${EC()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${EC()}`},Zb=Qye;function G3(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function Rz(e,t,r){if(typeof e!="function")throw new Error(Ya(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Ya(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Ya(1));return r(Rz)(e,t)}let n=e,s=t,a=new Map,i=a,o=0,l=!1;function u(){i===a&&(i=new Map,a.forEach((w,C)=>{i.set(C,w)}))}function d(){if(l)throw new Error(Ya(3));return s}function h(w){if(typeof w!="function")throw new Error(Ya(4));if(l)throw new Error(Ya(5));let C=!0;u();const k=o++;return i.set(k,w),function(){if(C){if(l)throw new Error(Ya(6));C=!1,u(),i.delete(k),a=null}}}function g(w){if(!G3(w))throw new Error(Ya(7));if(typeof w.type>"u")throw new Error(Ya(8));if(typeof w.type!="string")throw new Error(Ya(17));if(l)throw new Error(Ya(9));try{l=!0,s=n(s,w)}finally{l=!1}return(a=i).forEach(k=>{k()}),w}function p(w){if(typeof w!="function")throw new Error(Ya(10));n=w,g({type:Zb.REPLACE})}function x(){const w=h;return{subscribe(C){if(typeof C!="object"||C===null)throw new Error(Ya(11));function k(){const N=C;N.next&&N.next(d())}return k(),{unsubscribe:w(k)}},[$D](){return this}}}return g({type:Zb.INIT}),{dispatch:g,subscribe:h,getState:d,replaceReducer:p,[$D]:x}}function Zye(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Zb.INIT})>"u")throw new Error(Ya(12));if(typeof r(void 0,{type:Zb.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Ya(13))})}function Iz(e){const t=Object.keys(e),r={};for(let a=0;a<t.length;a++){const i=t[a];typeof e[i]=="function"&&(r[i]=e[i])}const n=Object.keys(r);let s;try{Zye(r)}catch(a){s=a}return function(i={},o){if(s)throw s;let l=!1;const u={};for(let d=0;d<n.length;d++){const h=n[d],g=r[h],p=i[h],x=g(p,o);if(typeof x>"u")throw o&&o.type,new Error(Ya(14));u[h]=x,l=l||x!==p}return l=l||n.length!==Object.keys(i).length,l?u:i}}function e_(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function eve(...e){return t=>(r,n)=>{const s=t(r,n);let a=()=>{throw new Error(Ya(15))};const i={getState:s.getState,dispatch:(l,...u)=>a(l,...u)},o=e.map(l=>l(i));return a=e_(...o)(s.dispatch),{...s,dispatch:a}}}function Mz(e){return G3(e)&&"type"in e&&typeof e.type=="string"}var Lz=Symbol.for("immer-nothing"),UD=Symbol.for("immer-draftable"),zo=Symbol.for("immer-state");function Jl(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Em=Object.getPrototypeOf;function p0(e){return!!e&&!!e[zo]}function ed(e){return e?Bz(e)||Array.isArray(e)||!!e[UD]||!!e.constructor?.[UD]||Xv(e)||y2(e):!1}var tve=Object.prototype.constructor.toString();function Bz(e){if(!e||typeof e!="object")return!1;const t=Em(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===tve}function t_(e,t){x2(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function x2(e){const t=e[zo];return t?t.type_:Array.isArray(e)?1:Xv(e)?2:y2(e)?3:0}function NE(e,t){return x2(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function $z(e,t,r){const n=x2(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function rve(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Xv(e){return e instanceof Map}function y2(e){return e instanceof Set}function kh(e){return e.copy_||e.base_}function AE(e,t){if(Xv(e))return new Map(e);if(y2(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Bz(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[zo];let s=Reflect.ownKeys(n);for(let a=0;a<s.length;a++){const i=s[a],o=n[i];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Em(e),n)}else{const n=Em(e);if(n!==null&&r)return{...e};const s=Object.create(n);return Object.assign(s,e)}}function V3(e,t=!1){return v2(e)||p0(e)||!ed(e)||(x2(e)>1&&Object.defineProperties(e,{set:{value:Lw},add:{value:Lw},clear:{value:Lw},delete:{value:Lw}}),Object.freeze(e),t&&Object.values(e).forEach(r=>V3(r,!0))),e}function Lw(){Jl(2)}function v2(e){return Object.isFrozen(e)}var nve={};function x0(e){const t=nve[e];return t||Jl(0,e),t}var dv;function Uz(){return dv}function sve(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function zD(e,t){t&&(x0("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function jE(e){PE(e),e.drafts_.forEach(ave),e.drafts_=null}function PE(e){e===dv&&(dv=e.parent_)}function WD(e){return dv=sve(dv,e)}function ave(e){const t=e[zo];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function HD(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[zo].modified_&&(jE(t),Jl(4)),ed(e)&&(e=r_(t,e),t.parent_||n_(t,e)),t.patches_&&x0("Patches").generateReplacementPatches_(r[zo].base_,e,t.patches_,t.inversePatches_)):e=r_(t,r,[]),jE(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Lz?e:void 0}function r_(e,t,r){if(v2(t))return t;const n=t[zo];if(!n)return t_(t,(s,a)=>GD(e,n,t,s,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return n_(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const s=n.copy_;let a=s,i=!1;n.type_===3&&(a=new Set(s),s.clear(),i=!0),t_(a,(o,l)=>GD(e,n,s,o,l,r,i)),n_(e,s,!1),r&&e.patches_&&x0("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function GD(e,t,r,n,s,a,i){if(p0(s)){const o=a&&t&&t.type_!==3&&!NE(t.assigned_,n)?a.concat(n):void 0,l=r_(e,s,o);if($z(r,n,l),p0(l))e.canAutoFreeze_=!1;else return}else i&&r.add(s);if(ed(s)&&!v2(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;r_(e,s),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(Xv(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&n_(e,s)}}function n_(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&V3(t,r)}function ive(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Uz(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,a=K3;r&&(s=[n],a=fv);const{revoke:i,proxy:o}=Proxy.revocable(s,a);return n.draft_=o,n.revoke_=i,o}var K3={get(e,t){if(t===zo)return e;const r=kh(e);if(!NE(r,t))return ove(e,r,t);const n=r[t];return e.finalized_||!ed(n)?n:n===NC(e.base_,t)?(AC(e),e.copy_[t]=OE(n,e)):n},has(e,t){return t in kh(e)},ownKeys(e){return Reflect.ownKeys(kh(e))},set(e,t,r){const n=zz(kh(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const s=NC(kh(e),t),a=s?.[zo];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(rve(r,s)&&(r!==void 0||NE(e.base_,t)))return!0;AC(e),FE(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return NC(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,AC(e),FE(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=kh(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Jl(11)},getPrototypeOf(e){return Em(e.base_)},setPrototypeOf(){Jl(12)}},fv={};t_(K3,(e,t)=>{fv[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});fv.deleteProperty=function(e,t){return fv.set.call(this,e,t,void 0)};fv.set=function(e,t,r){return K3.set.call(this,e[0],t,r,e[0])};function NC(e,t){const r=e[zo];return(r?kh(r):e)[t]}function ove(e,t,r){const n=zz(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function zz(e,t){if(!(t in e))return;let r=Em(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Em(r)}}function FE(e){e.modified_||(e.modified_=!0,e.parent_&&FE(e.parent_))}function AC(e){e.copy_||(e.copy_=AE(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var lve=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const a=r;r=t;const i=this;return function(l=a,...u){return i.produce(l,d=>r.call(this,d,...u))}}typeof r!="function"&&Jl(6),n!==void 0&&typeof n!="function"&&Jl(7);let s;if(ed(t)){const a=WD(this),i=OE(t,void 0);let o=!0;try{s=r(i),o=!1}finally{o?jE(a):PE(a)}return zD(a,n),HD(s,a)}else if(!t||typeof t!="object"){if(s=r(t),s===void 0&&(s=t),s===Lz&&(s=void 0),this.autoFreeze_&&V3(s,!0),n){const a=[],i=[];x0("Patches").generateReplacementPatches_(t,s,a,i),n(a,i)}return s}else Jl(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...o)=>this.produceWithPatches(i,l=>t(l,...o));let n,s;return[this.produce(t,r,(i,o)=>{n=i,s=o}),n,s]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){ed(e)||Jl(8),p0(e)&&(e=Vu(e));const t=WD(this),r=OE(e,void 0);return r[zo].isManual_=!0,PE(t),r}finishDraft(e,t){const r=e&&e[zo];(!r||!r.isManual_)&&Jl(9);const{scope_:n}=r;return zD(n,t),HD(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const s=t[r];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}r>-1&&(t=t.slice(r+1));const n=x0("Patches").applyPatches_;return p0(e)?n(e,t):this.produce(e,s=>n(s,t))}};function OE(e,t){const r=Xv(e)?x0("MapSet").proxyMap_(e,t):y2(e)?x0("MapSet").proxySet_(e,t):ive(e,t);return(t?t.scope_:Uz()).drafts_.push(r),r}function Vu(e){return p0(e)||Jl(10,e),Wz(e)}function Wz(e){if(!ed(e)||v2(e))return e;const t=e[zo];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=AE(e,t.scope_.immer_.useStrictShallowCopy_)}else r=AE(e,!0);return t_(r,(n,s)=>{$z(r,n,Wz(s))}),t&&(t.finalized_=!1),r}var cve=new lve,Hz=cve.produce;function Gz(e){return({dispatch:r,getState:n})=>s=>a=>typeof a=="function"?a(r,n,e):s(a)}var uve=Gz(),dve=Gz,fve=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?e_:e_.apply(null,arguments)};function Tl(e,t){function r(...n){if(t){let s=t(...n);if(!s)throw new Error(Bo(0));return{type:e,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>Mz(n)&&n.type===e,r}var Vz=class uy extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,uy.prototype)}static get[Symbol.species](){return uy}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new uy(...t[0].concat(this)):new uy(...t.concat(this))}};function VD(e){return ed(e)?Hz(e,()=>{}):e}function Bw(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function hve(e){return typeof e=="boolean"}var gve=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:s=!0,actionCreatorCheck:a=!0}=t??{};let i=new Vz;return r&&(hve(r)?i.push(uve):i.push(dve(r.extraArgument))),i},mve="RTK_autoBatch",KD=e=>t=>{setTimeout(t,e)},pve=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let s=!0,a=!1,i=!1;const o=new Set,l=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:KD(10):e.type==="callback"?e.queueNotification:KD(e.timeout),u=()=>{i=!1,a&&(a=!1,o.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const h=()=>s&&d(),g=n.subscribe(h);return o.add(d),()=>{g(),o.delete(d)}},dispatch(d){try{return s=!d?.meta?.[mve],a=!s,a&&(i||(i=!0,l(u))),n.dispatch(d)}finally{s=!0}}})},xve=e=>function(r){const{autoBatch:n=!0}=r??{};let s=new Vz(e);return n&&s.push(pve(typeof n=="object"?n:void 0)),s};function yve(e){const t=gve(),{reducer:r=void 0,middleware:n,devTools:s=!0,preloadedState:a=void 0,enhancers:i=void 0}=e||{};let o;if(typeof r=="function")o=r;else if(G3(r))o=Iz(r);else throw new Error(Bo(1));let l;typeof n=="function"?l=n(t):l=t();let u=e_;s&&(u=fve({trace:!1,...typeof s=="object"&&s}));const d=eve(...l),h=xve(d);let g=typeof i=="function"?i(h):h();const p=u(...g);return Rz(o,a,p)}function Kz(e){const t={},r=[];let n;const s={addCase(a,i){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(Bo(28));if(o in t)throw new Error(Bo(29));return t[o]=i,s},addAsyncThunk(a,i){return i.pending&&(t[a.pending.type]=i.pending),i.rejected&&(t[a.rejected.type]=i.rejected),i.fulfilled&&(t[a.fulfilled.type]=i.fulfilled),i.settled&&r.push({matcher:a.settled,reducer:i.settled}),s},addMatcher(a,i){return r.push({matcher:a,reducer:i}),s},addDefaultCase(a){return n=a,s}};return e(s),[t,r,n]}function vve(e){return typeof e=="function"}function wve(e,t){let[r,n,s]=Kz(t),a;if(vve(e))a=()=>VD(e());else{const o=VD(e);a=()=>o}function i(o=a(),l){let u=[r[l.type],...n.filter(({matcher:d})=>d(l)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[s]),u.reduce((d,h)=>{if(h)if(p0(d)){const p=h(d,l);return p===void 0?d:p}else{if(ed(d))return Hz(d,g=>h(g,l));{const g=h(d,l);if(g===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return g}}return d},o)}return i.getInitialState=a,i}var bve="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",_ve=(e=21)=>{let t="",r=e;for(;r--;)t+=bve[Math.random()*64|0];return t},Sve=Symbol.for("rtk-slice-createasyncthunk");function kve(e,t){return`${e}/${t}`}function Cve({creators:e}={}){const t=e?.asyncThunk?.[Sve];return function(n){const{name:s,reducerPath:a=s}=n;if(!s)throw new Error(Bo(11));const i=(typeof n.reducers=="function"?n.reducers(Eve()):n.reducers)||{},o=Object.keys(i),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(_,N){const E=typeof _=="string"?_:_.type;if(!E)throw new Error(Bo(12));if(E in l.sliceCaseReducersByType)throw new Error(Bo(13));return l.sliceCaseReducersByType[E]=N,u},addMatcher(_,N){return l.sliceMatchers.push({matcher:_,reducer:N}),u},exposeAction(_,N){return l.actionCreators[_]=N,u},exposeCaseReducer(_,N){return l.sliceCaseReducersByName[_]=N,u}};o.forEach(_=>{const N=i[_],E={reducerName:_,type:kve(s,_),createNotation:typeof n.reducers=="function"};Ave(N)?Pve(E,N,u,t):Nve(E,N,u)});function d(){const[_={},N=[],E=void 0]=typeof n.extraReducers=="function"?Kz(n.extraReducers):[n.extraReducers],P={..._,...l.sliceCaseReducersByType};return wve(n.initialState,F=>{for(let A in P)F.addCase(A,P[A]);for(let A of l.sliceMatchers)F.addMatcher(A.matcher,A.reducer);for(let A of N)F.addMatcher(A.matcher,A.reducer);E&&F.addDefaultCase(E)})}const h=_=>_,g=new Map,p=new WeakMap;let x;function v(_,N){return x||(x=d()),x(_,N)}function w(){return x||(x=d()),x.getInitialState()}function C(_,N=!1){function E(F){let A=F[_];return typeof A>"u"&&N&&(A=Bw(p,E,w)),A}function P(F=h){const A=Bw(g,N,()=>new WeakMap);return Bw(A,F,()=>{const j={};for(const[R,U]of Object.entries(n.selectors??{}))j[R]=Tve(U,F,()=>Bw(p,F,w),N);return j})}return{reducerPath:_,getSelectors:P,get selectors(){return P(E)},selectSlice:E}}const k={name:s,reducer:v,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:w,...C(a),injectInto(_,{reducerPath:N,...E}={}){const P=N??a;return _.inject({reducerPath:P,reducer:v},E),{...k,...C(P,!0)}}};return k}}function Tve(e,t,r,n){function s(a,...i){let o=t(a);return typeof o>"u"&&n&&(o=r()),e(o,...i)}return s.unwrapped=e,s}var Ho=Cve();function Eve(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function Nve({type:e,reducerName:t,createNotation:r},n,s){let a,i;if("reducer"in n){if(r&&!jve(n))throw new Error(Bo(17));a=n.reducer,i=n.prepare}else a=n;s.addCase(e,a).exposeCaseReducer(t,a).exposeAction(t,i?Tl(e,i):Tl(e))}function Ave(e){return e._reducerDefinitionType==="asyncThunk"}function jve(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Pve({type:e,reducerName:t},r,n,s){if(!s)throw new Error(Bo(18));const{payloadCreator:a,fulfilled:i,pending:o,rejected:l,settled:u,options:d}=r,h=s(e,a,d);n.exposeAction(t,h),i&&n.addCase(h.fulfilled,i),o&&n.addCase(h.pending,o),l&&n.addCase(h.rejected,l),u&&n.addMatcher(h.settled,u),n.exposeCaseReducer(t,{fulfilled:i||$w,pending:o||$w,rejected:l||$w,settled:u||$w})}function $w(){}var Fve="task",qz="listener",Yz="completed",q3="cancelled",Ove=`task-${q3}`,Dve=`task-${Yz}`,DE=`${qz}-${q3}`,Rve=`${qz}-${Yz}`,w2=class{constructor(e){this.code=e,this.message=`${Fve} ${q3} (reason: ${e})`}name="TaskAbortError";message},Y3=(e,t)=>{if(typeof e!="function")throw new TypeError(Bo(32))},s_=()=>{},Xz=(e,t=s_)=>(e.catch(t),e),Jz=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Vh=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Kh=e=>{if(e.aborted){const{reason:t}=e;throw new w2(t)}};function Qz(e,t){let r=s_;return new Promise((n,s)=>{const a=()=>s(new w2(e.reason));if(e.aborted){a();return}r=Jz(e,a),t.finally(()=>r()).then(n,s)}).finally(()=>{r=s_})}var Ive=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof w2?"cancelled":"rejected",error:r}}finally{t?.()}},a_=e=>t=>Xz(Qz(e,t).then(r=>(Kh(e),r))),Zz=e=>{const t=a_(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:fm}=Object,qD={},b2="listenerMiddleware",Mve=(e,t)=>{const r=n=>Jz(e,()=>Vh(n,e.reason));return(n,s)=>{Y3(n);const a=new AbortController;r(a);const i=Ive(async()=>{Kh(e),Kh(a.signal);const o=await n({pause:a_(a.signal),delay:Zz(a.signal),signal:a.signal});return Kh(a.signal),o},()=>Vh(a,Dve));return s?.autoJoin&&t.push(i.catch(s_)),{result:a_(e)(i),cancel(){Vh(a,Ove)}}}},Lve=(e,t)=>{const r=async(n,s)=>{Kh(t);let a=()=>{};const o=[new Promise((l,u)=>{let d=e({predicate:n,effect:(h,g)=>{g.unsubscribe(),l([h,g.getState(),g.getOriginalState()])}});a=()=>{d(),u()}})];s!=null&&o.push(new Promise(l=>setTimeout(l,s,null)));try{const l=await Qz(t,Promise.race(o));return Kh(t),l}finally{a()}};return(n,s)=>Xz(r(n,s))},eW=e=>{let{type:t,actionCreator:r,matcher:n,predicate:s,effect:a}=e;if(t)s=Tl(t).match;else if(r)t=r.type,s=r.match;else if(n)s=n;else if(!s)throw new Error(Bo(21));return Y3(a),{predicate:s,type:t,effect:a}},tW=fm(e=>{const{type:t,predicate:r,effect:n}=eW(e);return{id:_ve(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Bo(22))}}},{withTypes:()=>tW}),YD=(e,t)=>{const{type:r,effect:n,predicate:s}=eW(t);return Array.from(e.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===s)&&a.effect===n)},RE=e=>{e.pending.forEach(t=>{Vh(t,DE)})},Bve=e=>()=>{e.forEach(RE),e.clear()},XD=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},rW=fm(Tl(`${b2}/add`),{withTypes:()=>rW}),$ve=Tl(`${b2}/removeAll`),nW=fm(Tl(`${b2}/remove`),{withTypes:()=>nW}),Uve=(...e)=>{console.error(`${b2}/error`,...e)},Jv=(e={})=>{const t=new Map,{extra:r,onError:n=Uve}=e;Y3(n);const s=d=>(d.unsubscribe=()=>t.delete(d.id),t.set(d.id,d),h=>{d.unsubscribe(),h?.cancelActive&&RE(d)}),a=d=>{const h=YD(t,d)??tW(d);return s(h)};fm(a,{withTypes:()=>a});const i=d=>{const h=YD(t,d);return h&&(h.unsubscribe(),d.cancelActive&&RE(h)),!!h};fm(i,{withTypes:()=>i});const o=async(d,h,g,p)=>{const x=new AbortController,v=Lve(a,x.signal),w=[];try{d.pending.add(x),await Promise.resolve(d.effect(h,fm({},g,{getOriginalState:p,condition:(C,k)=>v(C,k).then(Boolean),take:v,delay:Zz(x.signal),pause:a_(x.signal),extra:r,signal:x.signal,fork:Mve(x.signal,w),unsubscribe:d.unsubscribe,subscribe:()=>{t.set(d.id,d)},cancelActiveListeners:()=>{d.pending.forEach((C,k,_)=>{C!==x&&(Vh(C,DE),_.delete(C))})},cancel:()=>{Vh(x,DE),d.pending.delete(x)},throwIfCancelled:()=>{Kh(x.signal)}})))}catch(C){C instanceof w2||XD(n,C,{raisedBy:"effect"})}finally{await Promise.all(w),Vh(x,Rve),d.pending.delete(x)}},l=Bve(t);return{middleware:d=>h=>g=>{if(!Mz(g))return h(g);if(rW.match(g))return a(g.payload);if($ve.match(g)){l();return}if(nW.match(g))return i(g.payload);let p=d.getState();const x=()=>{if(p===qD)throw new Error(Bo(23));return p};let v;try{if(v=h(g),t.size>0){const w=d.getState(),C=Array.from(t.values());for(const k of C){let _=!1;try{_=k.predicate(g,w,p)}catch(N){_=!1,XD(n,N,{raisedBy:"predicate"})}_&&o(k,g,d,x)}}}finally{p=qD}return v},startListening:a,stopListening:i,clearListeners:l}};function Bo(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var zve={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},sW=Ho({name:"chartLayout",initialState:zve,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,s,a;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(s=t.payload.bottom)!==null&&s!==void 0?s:0,e.margin.left=(a=t.payload.left)!==null&&a!==void 0?a:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:Wve,setLayout:Hve,setChartSize:Gve,setScale:Vve}=sW.actions,Kve=sW.reducer;function JD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function QD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JD(Object(r),!0).forEach(function(n){qve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qve(e,t,r){return(t=Yve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yve(e){var t=Xve(e,"string");return typeof t=="symbol"?t:t+""}function Xve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i_=Math.PI/180,Jve=e=>e*180/Math.PI,ni=(e,t,r,n)=>({x:e+Math.cos(-i_*n)*r,y:t+Math.sin(-i_*n)*r}),Qve=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},Zve=(e,t)=>{var{x:r,y:n}=e,{x:s,y:a}=t;return Math.sqrt((r-s)**2+(n-a)**2)},e1e=(e,t)=>{var{x:r,y:n}=e,{cx:s,cy:a}=t,i=Zve({x:r,y:n},{x:s,y:a});if(i<=0)return{radius:i,angle:0};var o=(r-s)/i,l=Math.acos(o);return n>a&&(l=2*Math.PI-l),{radius:i,angle:Jve(l),angleInRadian:l}},t1e=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),s=Math.floor(r/360),a=Math.min(n,s);return{startAngle:t-a*360,endAngle:r-a*360}},r1e=(e,t)=>{var{startAngle:r,endAngle:n}=t,s=Math.floor(r/360),a=Math.floor(n/360),i=Math.min(s,a);return e+i*360},n1e=(e,t)=>{var{x:r,y:n}=e,{radius:s,angle:a}=e1e({x:r,y:n},t),{innerRadius:i,outerRadius:o}=t;if(s<i||s>o||s===0)return null;var{startAngle:l,endAngle:u}=t1e(t),d=a,h;if(l<=u){for(;d>u;)d-=360;for(;d<l;)d+=360;h=d>=l&&d<=u}else{for(;d>l;)d-=360;for(;d<u;)d+=360;h=d>=u&&d<=l}return h?QD(QD({},t),{},{radius:s,angle:r1e(d,t)}):null};function aW(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function ZD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ml(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZD(Object(r),!0).forEach(function(n){s1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function s1e(e,t,r){return(t=a1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a1e(e){var t=i1e(e,"string");return typeof t=="symbol"?t:t+""}function i1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xi(e,t,r){return Oa(e)||Oa(t)?r:Xc(t)?h2(e,t,r):typeof t=="function"?t(e):r}var o1e=(e,t,r,n,s)=>{var a,i=-1,o=(a=t?.length)!==null&&a!==void 0?a:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&s!=null&&Math.abs(Math.abs(s[1]-s[0])-360)<=1e-6)for(var l=0;l<o;l++){var u=l>0?r[l-1].coordinate:r[o-1].coordinate,d=r[l].coordinate,h=l>=o-1?r[0].coordinate:r[l+1].coordinate,g=void 0;if(yl(d-u)!==yl(h-d)){var p=[];if(yl(h-d)===yl(s[1]-s[0])){g=h;var x=d+s[1]-s[0];p[0]=Math.min(x,(x+u)/2),p[1]=Math.max(x,(x+u)/2)}else{g=u;var v=h+s[1]-s[0];p[0]=Math.min(d,(v+d)/2),p[1]=Math.max(d,(v+d)/2)}var w=[Math.min(d,(g+d)/2),Math.max(d,(g+d)/2)];if(e>w[0]&&e<=w[1]||e>=p[0]&&e<=p[1]){({index:i}=r[l]);break}}else{var C=Math.min(u,h),k=Math.max(u,h);if(e>(C+d)/2&&e<=(k+d)/2){({index:i}=r[l]);break}}}else if(t){for(var _=0;_<o;_++)if(_===0&&e<=(t[_].coordinate+t[_+1].coordinate)/2||_>0&&_<o-1&&e>(t[_].coordinate+t[_-1].coordinate)/2&&e<=(t[_].coordinate+t[_+1].coordinate)/2||_===o-1&&e>(t[_].coordinate+t[_-1].coordinate)/2){({index:i}=t[_]);break}}return i},l1e=(e,t,r)=>{if(t&&r){var{width:n,height:s}=r,{align:a,verticalAlign:i,layout:o}=t;if((o==="vertical"||o==="horizontal"&&i==="middle")&&a!=="center"&&Ir(e[a]))return ml(ml({},e),{},{[a]:e[a]+(n||0)});if((o==="horizontal"||o==="vertical"&&a==="center")&&i!=="middle"&&Ir(e[i]))return ml(ml({},e),{},{[i]:e[i]+(s||0)})}return e},Lf=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",iW=(e,t,r,n)=>{if(n)return e.map(o=>o.coordinate);var s,a,i=e.map(o=>(o.coordinate===t&&(s=!0),o.coordinate===r&&(a=!0),o.coordinate));return s||i.push(t),a||i.push(r),i},oW=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:s,range:a,scale:i,realScaleType:o,isCategorical:l,categoricalDomain:u,tickCount:d,ticks:h,niceTicks:g,axisType:p}=e;if(!i)return null;var x=o==="scaleBand"&&i.bandwidth?i.bandwidth()/2:2,v=s==="category"&&i.bandwidth?i.bandwidth()/x:0;if(v=p==="angleAxis"&&a&&a.length>=2?yl(a[0]-a[1])*2*v:v,h||g){var w=(h||g||[]).map((C,k)=>{var _=n?n.indexOf(C):C;return{coordinate:i(_)+v,value:C,offset:v,index:k}});return w.filter(C=>!Cl(C.coordinate))}return l&&u?u.map((C,k)=>({coordinate:i(C)+v,value:C,index:k,offset:v})):i.ticks&&d!=null?i.ticks(d).map((C,k)=>({coordinate:i(C)+v,value:C,offset:v,index:k})):i.domain().map((C,k)=>({coordinate:i(C)+v,value:n?n[C]:C,index:k,offset:v}))},eR=1e-4,c1e=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),s=Math.min(n[0],n[1])-eR,a=Math.max(n[0],n[1])+eR,i=e(t[0]),o=e(t[r-1]);(i<s||i>a||o<s||o>a)&&e.domain([t[0],t[r-1]])}},u1e=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var s=0,a=0,i=0;i<t;++i){var o=Cl(e[i][r][1])?e[i][r][0]:e[i][r][1];o>=0?(e[i][r][0]=s,e[i][r][1]=s+o,s=e[i][r][1]):(e[i][r][0]=a,e[i][r][1]=a+o,a=e[i][r][1])}},d1e=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var s=0,a=0;a<t;++a){var i=Cl(e[a][r][1])?e[a][r][0]:e[a][r][1];i>=0?(e[a][r][0]=s,e[a][r][1]=s+i,s=e[a][r][1]):(e[a][r][0]=0,e[a][r][1]=0)}},f1e={sign:u1e,expand:eye,none:Tm,silhouette:tye,wiggle:rye,positive:d1e},h1e=(e,t,r)=>{var n=f1e[r],s=Zxe().keys(t).value((a,i)=>+Xi(a,i,0)).order(EE).offset(n);return s(e)};function tR(e){var{axis:t,ticks:r,bandSize:n,entry:s,index:a,dataKey:i}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Oa(s[t.dataKey])){var o=az(r,"value",s[t.dataKey]);if(o)return o.coordinate+n/2}return r[a]?r[a].coordinate+n/2:null}var l=Xi(s,Oa(i)?t.dataKey:i);return Oa(l)?null:t.scale(l)}var g1e=e=>{var t=e.flat(2).filter(Ir);return[Math.min(...t),Math.max(...t)]},m1e=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],p1e=(e,t,r)=>{if(e!=null)return m1e(Object.keys(e).reduce((n,s)=>{var a=e[s],{stackedData:i}=a,o=i.reduce((l,u)=>{var d=aW(u,t,r),h=g1e(d);return[Math.min(l[0],h[0]),Math.max(l[1],h[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},rR=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,nR=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,IE=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var s=p2(t,d=>d.coordinate),a=1/0,i=1,o=s.length;i<o;i++){var l=s[i],u=s[i-1];a=Math.min((l.coordinate||0)-(u.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};function sR(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:s,name:a}=e;return ml(ml({},t),{},{dataKey:r,payload:n,value:s,name:a})}function lW(e,t){if(e)return String(e);if(typeof t=="string")return t}function x1e(e,t,r,n,s){if(r==="horizontal"||r==="vertical"){var a=e>=s.left&&e<=s.left+s.width&&t>=s.top&&t<=s.top+s.height;return a?{x:e,y:t}:null}return n?n1e({x:e,y:t},n):null}var y1e=(e,t,r,n)=>{var s=t.find(u=>u&&u.index===r);if(s){if(e==="horizontal")return{x:s.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:s.coordinate};if(e==="centric"){var a=s.coordinate,{radius:i}=n;return ml(ml(ml({},n),ni(n.cx,n.cy,i,a)),{},{angle:a,radius:i})}var o=s.coordinate,{angle:l}=n;return ml(ml(ml({},n),ni(n.cx,n.cy,o,l)),{},{angle:l,radius:o})}return{x:0,y:0}},v1e=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,cd=e=>e.layout.width,ud=e=>e.layout.height,w1e=e=>e.layout.scale,cW=e=>e.layout.margin,_2=St(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),S2=St(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),b1e="data-recharts-item-index",_1e="data-recharts-item-data-key",Qv=60;function aR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Uw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aR(Object(r),!0).forEach(function(n){S1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function S1e(e,t,r){return(t=k1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k1e(e){var t=C1e(e,"string");return typeof t=="symbol"?t:t+""}function C1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var T1e=e=>e.brush.height;function E1e(e){var t=S2(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var s=typeof n.width=="number"?n.width:Qv;return r+s}return r},0)}function N1e(e){var t=S2(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var s=typeof n.width=="number"?n.width:Qv;return r+s}return r},0)}function A1e(e){var t=_2(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function j1e(e){var t=_2(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var oi=St([cd,ud,cW,T1e,E1e,N1e,A1e,j1e,Dz,qye],(e,t,r,n,s,a,i,o,l,u)=>{var d={left:(r.left||0)+s,right:(r.right||0)+a},h={top:(r.top||0)+i,bottom:(r.bottom||0)+o},g=Uw(Uw({},h),d),p=g.bottom;g.bottom+=n,g=l1e(g,l,u);var x=e-g.left-g.right,v=t-g.top-g.bottom;return Uw(Uw({brushBottom:p},g),{},{width:Math.max(x,0),height:Math.max(v,0)})}),P1e=St(oi,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),uW=St(cd,ud,(e,t)=>({x:0,y:0,width:e,height:t})),F1e=S.createContext(null),jl=()=>S.useContext(F1e)!=null,k2=e=>e.brush,C2=St([k2,oi,cW],(e,t,r)=>({height:e.height,x:Ir(e.x)?e.x:t.left,y:Ir(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:Ir(e.width)?e.width:t.width})),X3=()=>{var e,t=jl(),r=Tr(P1e),n=Tr(C2),s=(e=Tr(k2))===null||e===void 0?void 0:e.padding;return!t||!n||!s?r:{width:n.width-s.left-s.right,height:n.height-s.top-s.bottom,x:s.left,y:s.top}},O1e={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},dW=()=>{var e;return(e=Tr(oi))!==null&&e!==void 0?e:O1e},fW=()=>Tr(cd),hW=()=>Tr(ud),Zn=e=>e.layout.layoutType,J3=()=>Tr(Zn),D1e={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},gW=Ho({name:"legend",initialState:D1e,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=Vu(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:B3e,setLegendSettings:$3e,addLegendPayload:R1e,removeLegendPayload:I1e}=gW.actions,M1e=gW.reducer;function ME(){return ME=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ME.apply(null,arguments)}function iR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function jC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iR(Object(r),!0).forEach(function(n){L1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L1e(e,t,r){return(t=B1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B1e(e){var t=$1e(e,"string");return typeof t=="symbol"?t:t+""}function $1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function U1e(e){return Array.isArray(e)&&Xc(e[0])&&Xc(e[1])?e.join(" ~ "):e}var z1e=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:s={},payload:a,formatter:i,itemSorter:o,wrapperClassName:l,labelClassName:u,label:d,labelFormatter:h,accessibilityLayer:g=!1}=e,p=()=>{if(a&&a.length){var E={padding:0,margin:0},P=(o?p2(a,o):a).map((F,A)=>{if(F.type==="none")return null;var j=F.formatter||i||U1e,{value:R,name:U}=F,Y=R,Z=U;if(j){var ae=j(R,U,F,A,a);if(Array.isArray(ae))[Y,Z]=ae;else if(ae!=null)Y=ae;else return null}var ee=jC({display:"block",paddingTop:4,paddingBottom:4,color:F.color||"#000"},n);return S.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(A),style:ee},Xc(Z)?S.createElement("span",{className:"recharts-tooltip-item-name"},Z):null,Xc(Z)?S.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,S.createElement("span",{className:"recharts-tooltip-item-value"},Y),S.createElement("span",{className:"recharts-tooltip-item-unit"},F.unit||""))});return S.createElement("ul",{className:"recharts-tooltip-item-list",style:E},P)}return null},x=jC({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),v=jC({margin:0},s),w=!Oa(d),C=w?d:"",k=Jn("recharts-default-tooltip",l),_=Jn("recharts-tooltip-label",u);w&&h&&a!==void 0&&a!==null&&(C=h(d,a));var N=g?{role:"status","aria-live":"assertive"}:{};return S.createElement("div",ME({className:k,style:x},N),S.createElement("p",{className:_,style:v},S.isValidElement(C)?C:"".concat(C)),p())},Xx="recharts-tooltip-wrapper",W1e={visibility:"hidden"};function H1e(e){var{coordinate:t,translateX:r,translateY:n}=e;return Jn(Xx,{["".concat(Xx,"-right")]:Ir(r)&&t&&Ir(t.x)&&r>=t.x,["".concat(Xx,"-left")]:Ir(r)&&t&&Ir(t.x)&&r<t.x,["".concat(Xx,"-bottom")]:Ir(n)&&t&&Ir(t.y)&&n>=t.y,["".concat(Xx,"-top")]:Ir(n)&&t&&Ir(t.y)&&n<t.y})}function oR(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:s,position:a,reverseDirection:i,tooltipDimension:o,viewBox:l,viewBoxDimension:u}=e;if(a&&Ir(a[n]))return a[n];var d=r[n]-o-(s>0?s:0),h=r[n]+s;if(t[n])return i[n]?d:h;var g=l[n];if(g==null)return 0;if(i[n]){var p=d,x=g;return p<x?Math.max(h,g):Math.max(d,g)}if(u==null)return 0;var v=h+o,w=g+u;return v>w?Math.max(d,g):Math.max(h,g)}function G1e(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function V1e(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:s,reverseDirection:a,tooltipBox:i,useTranslate3d:o,viewBox:l}=e,u,d,h;return i.height>0&&i.width>0&&r?(d=oR({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:s,reverseDirection:a,tooltipDimension:i.width,viewBox:l,viewBoxDimension:l.width}),h=oR({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:s,reverseDirection:a,tooltipDimension:i.height,viewBox:l,viewBoxDimension:l.height}),u=G1e({translateX:d,translateY:h,useTranslate3d:o})):u=W1e,{cssProperties:u,cssClasses:H1e({translateX:d,translateY:h,coordinate:r})}}function lR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function zw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lR(Object(r),!0).forEach(function(n){LE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LE(e,t,r){return(t=K1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K1e(e){var t=q1e(e,"string");return typeof t=="symbol"?t:t+""}function q1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Y1e extends S.PureComponent{constructor(){super(...arguments),LE(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),LE(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,s,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(s=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&s!==void 0?s:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:s,children:a,coordinate:i,hasPayload:o,isAnimationActive:l,offset:u,position:d,reverseDirection:h,useTranslate3d:g,viewBox:p,wrapperStyle:x,lastBoundingBox:v,innerRef:w,hasPortalFromProps:C}=this.props,{cssClasses:k,cssProperties:_}=V1e({allowEscapeViewBox:r,coordinate:i,offsetTopLeft:u,position:d,reverseDirection:h,tooltipBox:{height:v.height,width:v.width},useTranslate3d:g,viewBox:p}),N=C?{}:zw(zw({transition:l&&t?"transform ".concat(n,"ms ").concat(s):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),E=zw(zw({},N),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},x);return S.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:k,style:E,ref:w},a)}}var X1e=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),tp={devToolsEnabled:!1,isSsr:X1e()},mW=()=>Tr(e=>e.rootProps.accessibilityLayer);function oc(e){return Number.isFinite(e)}function o_(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function BE(){return BE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},BE.apply(null,arguments)}function cR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function uR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cR(Object(r),!0).forEach(function(n){J1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function J1e(e,t,r){return(t=Q1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q1e(e){var t=Z1e(e,"string");return typeof t=="symbol"?t:t+""}function Z1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dR={curveBasisClosed:zxe,curveBasisOpen:Wxe,curveBasis:Uxe,curveBumpX:Bxe,curveBumpY:$xe,curveLinearClosed:Hxe,curveLinear:g2,curveMonotoneX:Gxe,curveMonotoneY:Vxe,curveNatural:Kxe,curveStep:qxe,curveStepAfter:Xxe,curveStepBefore:Yxe},Ww=e=>oc(e.x)&&oc(e.y),Jx=e=>e.x,Qx=e=>e.y,ewe=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(L3(e));return(r==="curveMonotone"||r==="curveBump")&&t?dR["".concat(r).concat(t==="vertical"?"Y":"X")]:dR[r]||g2},twe=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:s,connectNulls:a=!1}=e,i=ewe(t,s),o=a?r.filter(Ww):r,l;if(Array.isArray(n)){var u=a?n.filter(h=>Ww(h)):n,d=o.map((h,g)=>uR(uR({},h),{},{base:u[g]}));return s==="vertical"?l=Rw().y(Qx).x1(Jx).x0(h=>h.base.x):l=Rw().x(Jx).y1(Qx).y0(h=>h.base.y),l.defined(Ww).curve(i),l(d)}return s==="vertical"&&Ir(n)?l=Rw().y(Qx).x1(Jx).x0(n):Ir(n)?l=Rw().x(Jx).y1(Qx).y0(n):l=gz().x(Jx).y(Qx),l.defined(Ww).curve(i),l(o)},pW=e=>{var{className:t,points:r,path:n,pathRef:s}=e;if((!r||!r.length)&&!n)return null;var a=r&&r.length?twe(e):n;return S.createElement("path",BE({},F0(e),$3(e),{className:Jn("recharts-curve",t),d:a===null?void 0:a,ref:s}))},rwe=["x","y","top","left","width","height","className"];function $E(){return $E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$E.apply(null,arguments)}function fR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function nwe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fR(Object(r),!0).forEach(function(n){swe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function swe(e,t,r){return(t=awe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function awe(e){var t=iwe(e,"string");return typeof t=="symbol"?t:t+""}function iwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function owe(e,t){if(e==null)return{};var r,n,s=lwe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function lwe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var cwe=(e,t,r,n,s,a)=>"M".concat(e,",").concat(s,"v").concat(n,"M").concat(a,",").concat(t,"h").concat(r),uwe=e=>{var{x:t=0,y:r=0,top:n=0,left:s=0,width:a=0,height:i=0,className:o}=e,l=owe(e,rwe),u=nwe({x:t,y:r,top:n,left:s,width:a,height:i},l);return!Ir(t)||!Ir(r)||!Ir(a)||!Ir(i)||!Ir(n)||!Ir(s)?null:S.createElement("path",$E({},ii(u,!0),{className:Jn("recharts-cross",o),d:cwe(t,r,a,i,n,s)}))};function dwe(e,t,r,n){var s=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-s:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-s,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function hR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function fwe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hR(Object(r),!0).forEach(function(n){hwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hwe(e,t,r){return(t=gwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gwe(e){var t=mwe(e,"string");return typeof t=="symbol"?t:t+""}function mwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pl(e,t){var r=fwe({},e),n=t,s=Object.keys(t),a=s.reduce((i,o)=>(i[o]===void 0&&n[o]!==void 0&&(i[o]=n[o]),i),r);return a}function pwe(){}function gR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function mR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gR(Object(r),!0).forEach(function(n){xwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xwe(e,t,r){return(t=ywe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ywe(e){var t=vwe(e,"string");return typeof t=="symbol"?t:t+""}function vwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wwe=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),bwe=(e,t,r)=>e.map(n=>"".concat(wwe(n)," ").concat(t,"ms ").concat(r)).join(","),_we=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(s=>n.includes(s))),hv=(e,t)=>Object.keys(t).reduce((r,n)=>mR(mR({},r),{},{[n]:e(n,t[n])}),{});function pR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Qa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pR(Object(r),!0).forEach(function(n){Swe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Swe(e,t,r){return(t=kwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kwe(e){var t=Cwe(e,"string");return typeof t=="symbol"?t:t+""}function Cwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var l_=(e,t,r)=>e+(t-e)*r,UE=e=>{var{from:t,to:r}=e;return t!==r},xW=(e,t,r)=>{var n=hv((s,a)=>{if(UE(a)){var[i,o]=e(a.from,a.to,a.velocity);return Qa(Qa({},a),{},{from:i,velocity:o})}return a},t);return r<1?hv((s,a)=>UE(a)?Qa(Qa({},a),{},{velocity:l_(a.velocity,n[s].velocity,r),from:l_(a.from,n[s].from,r)}):a,t):xW(e,n,r-1)};function Twe(e,t,r,n,s,a){var i,o=n.reduce((g,p)=>Qa(Qa({},g),{},{[p]:{from:e[p],velocity:0,to:t[p]}}),{}),l=()=>hv((g,p)=>p.from,o),u=()=>!Object.values(o).filter(UE).length,d=null,h=g=>{i||(i=g);var p=g-i,x=p/r.dt;o=xW(r,o,x),s(Qa(Qa(Qa({},e),t),l())),i=g,u()||(d=a.setTimeout(h))};return()=>(d=a.setTimeout(h),()=>{d()})}function Ewe(e,t,r,n,s,a,i){var o=null,l=s.reduce((h,g)=>Qa(Qa({},h),{},{[g]:[e[g],t[g]]}),{}),u,d=h=>{u||(u=h);var g=(h-u)/n,p=hv((v,w)=>l_(...w,r(g)),l);if(a(Qa(Qa(Qa({},e),t),p)),g<1)o=i.setTimeout(d);else{var x=hv((v,w)=>l_(...w,r(1)),l);a(Qa(Qa(Qa({},e),t),x))}};return()=>(o=i.setTimeout(d),()=>{o()})}const Nwe=(e,t,r,n,s,a)=>{var i=_we(e,t);return r.isStepper===!0?Twe(e,t,r,i,s,a):Ewe(e,t,r,n,i,s,a)};var c_=1e-4,yW=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],vW=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),xR=(e,t)=>r=>{var n=yW(e,t);return vW(n,r)},Awe=(e,t)=>r=>{var n=yW(e,t),s=[...n.map((a,i)=>a*i).slice(1),0];return vW(s,r)},yR=function(){for(var t,r,n,s,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];if(i.length===1)switch(i[0]){case"linear":[t,n,r,s]=[0,0,1,1];break;case"ease":[t,n,r,s]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,s]=[.42,0,1,1];break;case"ease-out":[t,n,r,s]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,s]=[0,0,.58,1];break;default:{var l=i[0].split("(");l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4&&([t,n,r,s]=l[1].split(")")[0].split(",").map(x=>parseFloat(x)))}}else i.length===4&&([t,n,r,s]=i);var u=xR(t,r),d=xR(n,s),h=Awe(t,r),g=x=>x>1?1:x<0?0:x,p=x=>{for(var v=x>1?1:x,w=v,C=0;C<8;++C){var k=u(w)-v,_=h(w);if(Math.abs(k-v)<c_||_<c_)return d(w);w=g(w-k/_)}return d(w)};return p.isStepper=!1,p},jwe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:s=17}=t,a=(i,o,l)=>{var u=-(i-o)*r,d=l*n,h=l+(u-d)*s/1e3,g=l*s/1e3+i;return Math.abs(g-o)<c_&&Math.abs(h)<c_?[o,0]:[g,h]};return a.isStepper=!0,a.dt=s,a},Pwe=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return yR(e);case"spring":return jwe();default:if(e.split("(")[0]==="cubic-bezier")return yR(e)}return typeof e=="function"?e:null};function Fwe(e){var t,r=()=>null,n=!1,s=null,a=i=>{if(!n){if(Array.isArray(i)){if(!i.length)return;var o=i,[l,...u]=o;if(typeof l=="number"){s=e.setTimeout(a.bind(null,u),l);return}a(l),s=e.setTimeout(a.bind(null,u));return}typeof i=="string"&&(t=i,r(t)),typeof i=="object"&&(t=i,r(t)),typeof i=="function"&&i()}};return{stop:()=>{n=!0},start:i=>{n=!1,s&&(s(),s=null),a(i)},subscribe:i=>(r=i,()=>{r=()=>null}),getTimeoutController:()=>e}}class Owe{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),s=null,a=i=>{i-n>=r?t(i):typeof requestAnimationFrame=="function"&&(s=requestAnimationFrame(a))};return s=requestAnimationFrame(a),()=>{cancelAnimationFrame(s)}}}function Dwe(){return Fwe(new Owe)}var Rwe=S.createContext(Dwe);function Iwe(e,t){var r=S.useContext(Rwe);return S.useMemo(()=>t??r(e),[e,t,r])}var Mwe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},vR={t:0},PC={t:1};function wW(e){var t=Pl(e,Mwe),{isActive:r,canBegin:n,duration:s,easing:a,begin:i,onAnimationEnd:o,onAnimationStart:l,children:u}=t,d=Iwe(t.animationId,t.animationManager),[h,g]=S.useState(r?vR:PC),p=S.useRef(null);return S.useEffect(()=>{r||g(PC)},[r]),S.useEffect(()=>{if(!r||!n)return pwe;var x=Nwe(vR,PC,Pwe(a),s,g,d.getTimeoutController()),v=()=>{p.current=x()};return d.start([l,i,v,s,o]),()=>{d.stop(),p.current&&p.current(),o()}},[r,n,s,a,i,l,o,d]),u(h.t)}function bW(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=S.useRef(uv(t)),n=S.useRef(e);return n.current!==e&&(r.current=uv(t),n.current=e),r.current}function wR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function bR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wR(Object(r),!0).forEach(function(n){Lwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Lwe(e,t,r){return(t=Bwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bwe(e){var t=$we(e,"string");return typeof t=="symbol"?t:t+""}function $we(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function u_(){return u_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u_.apply(null,arguments)}var _R=(e,t,r,n,s)=>{var a=Math.min(Math.abs(r)/2,Math.abs(n)/2),i=n>=0?1:-1,o=r>=0?1:-1,l=n>=0&&r>=0||n<0&&r<0?1:0,u;if(a>0&&s instanceof Array){for(var d=[0,0,0,0],h=0,g=4;h<g;h++)d[h]=s[h]>a?a:s[h];u="M".concat(e,",").concat(t+i*d[0]),d[0]>0&&(u+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(l,",").concat(e+o*d[0],",").concat(t)),u+="L ".concat(e+r-o*d[1],",").concat(t),d[1]>0&&(u+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(l,`,
        `).concat(e+r,",").concat(t+i*d[1])),u+="L ".concat(e+r,",").concat(t+n-i*d[2]),d[2]>0&&(u+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(l,`,
        `).concat(e+r-o*d[2],",").concat(t+n)),u+="L ".concat(e+o*d[3],",").concat(t+n),d[3]>0&&(u+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(l,`,
        `).concat(e,",").concat(t+n-i*d[3])),u+="Z"}else if(a>0&&s===+s&&s>0){var p=Math.min(a,s);u="M ".concat(e,",").concat(t+i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(e+o*p,",").concat(t,`
            L `).concat(e+r-o*p,",").concat(t,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(e+r,",").concat(t+i*p,`
            L `).concat(e+r,",").concat(t+n-i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(e+r-o*p,",").concat(t+n,`
            L `).concat(e+o*p,",").concat(t+n,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(e,",").concat(t+n-i*p," Z")}else u="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return u},Uwe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},zwe=e=>{var t=Pl(e,Uwe),r=S.useRef(null),[n,s]=S.useState(-1);S.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var ae=r.current.getTotalLength();ae&&s(ae)}catch{}},[]);var{x:a,y:i,width:o,height:l,radius:u,className:d}=t,{animationEasing:h,animationDuration:g,animationBegin:p,isAnimationActive:x,isUpdateAnimationActive:v}=t,w=S.useRef(o),C=S.useRef(l),k=S.useRef(a),_=S.useRef(i),N=S.useMemo(()=>({x:a,y:i,width:o,height:l,radius:u}),[a,i,o,l,u]),E=bW(N,"rectangle-");if(a!==+a||i!==+i||o!==+o||l!==+l||o===0||l===0)return null;var P=Jn("recharts-rectangle",d);if(!v)return S.createElement("path",u_({},ii(t,!0),{className:P,d:_R(a,i,o,l,u)}));var F=w.current,A=C.current,j=k.current,R=_.current,U="0px ".concat(n===-1?1:n,"px"),Y="".concat(n,"px 0px"),Z=bwe(["strokeDasharray"],g,typeof h=="string"?h:void 0);return S.createElement(wW,{animationId:E,key:E,canBegin:n>0,duration:g,easing:h,isActive:v,begin:p},ae=>{var ee=Ru(F,o,ae),ne=Ru(A,l,ae),L=Ru(j,a,ae),H=Ru(R,i,ae);r.current&&(w.current=ee,C.current=ne,k.current=L,_.current=H);var M;return x?ae>0?M={transition:Z,strokeDasharray:Y}:M={strokeDasharray:U}:M={strokeDasharray:Y},S.createElement("path",u_({},ii(t,!0),{className:P,d:_R(L,H,ee,ne,u),ref:r,style:bR(bR({},M),t.style)}))})};function _W(e){var{cx:t,cy:r,radius:n,startAngle:s,endAngle:a}=e,i=ni(t,r,n,s),o=ni(t,r,n,a);return{points:[i,o],cx:t,cy:r,radius:n,startAngle:s,endAngle:a}}function zE(){return zE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zE.apply(null,arguments)}var Wwe=(e,t)=>{var r=yl(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},Hw=e=>{var{cx:t,cy:r,radius:n,angle:s,sign:a,isExternal:i,cornerRadius:o,cornerIsExternal:l}=e,u=o*(i?1:-1)+n,d=Math.asin(o/u)/i_,h=l?s:s+a*d,g=ni(t,r,u,h),p=ni(t,r,n,h),x=l?s-a*d:s,v=ni(t,r,u*Math.cos(d*i_),x);return{center:g,circleTangency:p,lineTangency:v,theta:d}},SW=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:s,startAngle:a,endAngle:i}=e,o=Wwe(a,i),l=a+o,u=ni(t,r,s,a),d=ni(t,r,s,l),h="M ".concat(u.x,",").concat(u.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(a>l),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(n>0){var g=ni(t,r,n,a),p=ni(t,r,n,l);h+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(a<=l),`,
            `).concat(g.x,",").concat(g.y," Z")}else h+="L ".concat(t,",").concat(r," Z");return h},Hwe=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:s,cornerRadius:a,forceCornerRadius:i,cornerIsExternal:o,startAngle:l,endAngle:u}=e,d=yl(u-l),{circleTangency:h,lineTangency:g,theta:p}=Hw({cx:t,cy:r,radius:s,angle:l,sign:d,cornerRadius:a,cornerIsExternal:o}),{circleTangency:x,lineTangency:v,theta:w}=Hw({cx:t,cy:r,radius:s,angle:u,sign:-d,cornerRadius:a,cornerIsExternal:o}),C=o?Math.abs(l-u):Math.abs(l-u)-p-w;if(C<0)return i?"M ".concat(g.x,",").concat(g.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):SW({cx:t,cy:r,innerRadius:n,outerRadius:s,startAngle:l,endAngle:u});var k="M ".concat(g.x,",").concat(g.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(C>180),",").concat(+(d<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(v.x,",").concat(v.y,`
  `);if(n>0){var{circleTangency:_,lineTangency:N,theta:E}=Hw({cx:t,cy:r,radius:n,angle:l,sign:d,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),{circleTangency:P,lineTangency:F,theta:A}=Hw({cx:t,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),j=o?Math.abs(l-u):Math.abs(l-u)-E-A;if(j<0&&a===0)return"".concat(k,"L").concat(t,",").concat(r,"Z");k+="L".concat(F.x,",").concat(F.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(P.x,",").concat(P.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(j>180),",").concat(+(d>0),",").concat(_.x,",").concat(_.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(N.x,",").concat(N.y,"Z")}else k+="L".concat(t,",").concat(r,"Z");return k},Gwe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Vwe=e=>{var t=Pl(e,Gwe),{cx:r,cy:n,innerRadius:s,outerRadius:a,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:l,startAngle:u,endAngle:d,className:h}=t;if(a<s||u===d)return null;var g=Jn("recharts-sector",h),p=a-s,x=Ef(i,p,0,!0),v;return x>0&&Math.abs(u-d)<360?v=Hwe({cx:r,cy:n,innerRadius:s,outerRadius:a,cornerRadius:Math.min(x,p/2),forceCornerRadius:o,cornerIsExternal:l,startAngle:u,endAngle:d}):v=SW({cx:r,cy:n,innerRadius:s,outerRadius:a,startAngle:u,endAngle:d}),S.createElement("path",zE({},ii(t,!0),{className:g,d:v}))};function Kwe(e,t,r){var n,s,a,i;if(e==="horizontal")n=t.x,a=n,s=r.top,i=r.top+r.height;else if(e==="vertical")s=t.y,i=s,n=r.left,a=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:o,cy:l,innerRadius:u,outerRadius:d,angle:h}=t,g=ni(o,l,u,h),p=ni(o,l,d,h);n=g.x,s=g.y,a=p.x,i=p.y}else return _W(t);return[{x:n,y:s},{x:a,y:i}]}var FC={},OC={},DC={},SR;function qwe(){return SR||(SR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fz();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(DC)),DC}var kR;function Ywe(){return kR||(kR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qwe();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(OC)),OC}var CR;function Xwe(){return CR||(CR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Oz(),r=Ywe();function n(s,a,i){i&&typeof i!="number"&&t.isIterateeCall(s,a,i)&&(a=i=void 0),s=r.toFinite(s),a===void 0?(a=s,s=0):a=r.toFinite(a),i=i===void 0?s<a?1:-1:r.toFinite(i);const o=Math.max(Math.ceil((a-s)/(i||1)),0),l=new Array(o);for(let u=0;u<o;u++)l[u]=s,s+=i;return l}e.range=n})(FC)),FC}var RC,TR;function Jwe(){return TR||(TR=1,RC=Xwe().range),RC}var Qwe=Jwe();const kW=Nl(Qwe);function yf(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Zwe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Q3(e){let t,r,n;e.length!==2?(t=yf,r=(o,l)=>yf(e(o),l),n=(o,l)=>e(o)-l):(t=e===yf||e===Zwe?e:ebe,r=e,n=e);function s(o,l,u=0,d=o.length){if(u<d){if(t(l,l)!==0)return d;do{const h=u+d>>>1;r(o[h],l)<0?u=h+1:d=h}while(u<d)}return u}function a(o,l,u=0,d=o.length){if(u<d){if(t(l,l)!==0)return d;do{const h=u+d>>>1;r(o[h],l)<=0?u=h+1:d=h}while(u<d)}return u}function i(o,l,u=0,d=o.length){const h=s(o,l,u,d-1);return h>u&&n(o[h-1],l)>-n(o[h],l)?h-1:h}return{left:s,center:i,right:a}}function ebe(){return 0}function CW(e){return e===null?NaN:+e}function*tbe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const rbe=Q3(yf),Zv=rbe.right;Q3(CW).center;class ER extends Map{constructor(t,r=abe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,s]of t)this.set(n,s)}get(t){return super.get(NR(this,t))}has(t){return super.has(NR(this,t))}set(t,r){return super.set(nbe(this,t),r)}delete(t){return super.delete(sbe(this,t))}}function NR({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function nbe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function sbe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function abe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function ibe(e=yf){if(e===yf)return TW;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function TW(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const obe=Math.sqrt(50),lbe=Math.sqrt(10),cbe=Math.sqrt(2);function d_(e,t,r){const n=(t-e)/Math.max(0,r),s=Math.floor(Math.log10(n)),a=n/Math.pow(10,s),i=a>=obe?10:a>=lbe?5:a>=cbe?2:1;let o,l,u;return s<0?(u=Math.pow(10,-s)/i,o=Math.round(e*u),l=Math.round(t*u),o/u<e&&++o,l/u>t&&--l,u=-u):(u=Math.pow(10,s)*i,o=Math.round(e/u),l=Math.round(t/u),o*u<e&&++o,l*u>t&&--l),l<o&&.5<=r&&r<2?d_(e,t,r*2):[o,l,u]}function WE(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[s,a,i]=n?d_(t,e,r):d_(e,t,r);if(!(a>=s))return[];const o=a-s+1,l=new Array(o);if(n)if(i<0)for(let u=0;u<o;++u)l[u]=(a-u)/-i;else for(let u=0;u<o;++u)l[u]=(a-u)*i;else if(i<0)for(let u=0;u<o;++u)l[u]=(s+u)/-i;else for(let u=0;u<o;++u)l[u]=(s+u)*i;return l}function HE(e,t,r){return t=+t,e=+e,r=+r,d_(e,t,r)[2]}function GE(e,t,r){t=+t,e=+e,r=+r;const n=t<e,s=n?HE(t,e,r):HE(e,t,r);return(n?-1:1)*(s<0?1/-s:s)}function AR(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function jR(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function EW(e,t,r=0,n=1/0,s){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(s=s===void 0?TW:ibe(s);n>r;){if(n-r>600){const l=n-r+1,u=t-r+1,d=Math.log(l),h=.5*Math.exp(2*d/3),g=.5*Math.sqrt(d*h*(l-h)/l)*(u-l/2<0?-1:1),p=Math.max(r,Math.floor(t-u*h/l+g)),x=Math.min(n,Math.floor(t+(l-u)*h/l+g));EW(e,t,p,x,s)}const a=e[t];let i=r,o=n;for(Zx(e,r,t),s(e[n],a)>0&&Zx(e,r,n);i<o;){for(Zx(e,i,o),++i,--o;s(e[i],a)<0;)++i;for(;s(e[o],a)>0;)--o}s(e[r],a)===0?Zx(e,r,o):(++o,Zx(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function Zx(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function ube(e,t,r){if(e=Float64Array.from(tbe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return jR(e);if(t>=1)return AR(e);var n,s=(n-1)*t,a=Math.floor(s),i=AR(EW(e,a).subarray(0,a+1)),o=jR(e.subarray(a+1));return i+(o-i)*(s-a)}}function dbe(e,t,r=CW){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,s=(n-1)*t,a=Math.floor(s),i=+r(e[a],a,e),o=+r(e[a+1],a+1,e);return i+(o-i)*(s-a)}}function fbe(e,t,r){e=+e,t=+t,r=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+r;for(var n=-1,s=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(s);++n<s;)a[n]=e+n*r;return a}function Fl(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function dd(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const VE=Symbol("implicit");function Z3(){var e=new ER,t=[],r=[],n=VE;function s(a){let i=e.get(a);if(i===void 0){if(n!==VE)return n;e.set(a,i=t.push(a)-1)}return r[i%r.length]}return s.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new ER;for(const i of a)e.has(i)||e.set(i,t.push(i)-1);return s},s.range=function(a){return arguments.length?(r=Array.from(a),s):r.slice()},s.unknown=function(a){return arguments.length?(n=a,s):n},s.copy=function(){return Z3(t,r).unknown(n)},Fl.apply(s,arguments),s}function eA(){var e=Z3().unknown(void 0),t=e.domain,r=e.range,n=0,s=1,a,i,o=!1,l=0,u=0,d=.5;delete e.unknown;function h(){var g=t().length,p=s<n,x=p?s:n,v=p?n:s;a=(v-x)/Math.max(1,g-l+u*2),o&&(a=Math.floor(a)),x+=(v-x-a*(g-l))*d,i=a*(1-l),o&&(x=Math.round(x),i=Math.round(i));var w=fbe(g).map(function(C){return x+a*C});return r(p?w.reverse():w)}return e.domain=function(g){return arguments.length?(t(g),h()):t()},e.range=function(g){return arguments.length?([n,s]=g,n=+n,s=+s,h()):[n,s]},e.rangeRound=function(g){return[n,s]=g,n=+n,s=+s,o=!0,h()},e.bandwidth=function(){return i},e.step=function(){return a},e.round=function(g){return arguments.length?(o=!!g,h()):o},e.padding=function(g){return arguments.length?(l=Math.min(1,u=+g),h()):l},e.paddingInner=function(g){return arguments.length?(l=Math.min(1,g),h()):l},e.paddingOuter=function(g){return arguments.length?(u=+g,h()):u},e.align=function(g){return arguments.length?(d=Math.max(0,Math.min(1,g)),h()):d},e.copy=function(){return eA(t(),[n,s]).round(o).paddingInner(l).paddingOuter(u).align(d)},Fl.apply(h(),arguments)}function NW(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return NW(t())},e}function hbe(){return NW(eA.apply(null,arguments).paddingInner(1))}function tA(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function AW(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function e1(){}var gv=.7,f_=1/gv,hm="\\s*([+-]?\\d+)\\s*",mv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Kc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gbe=/^#([0-9a-f]{3,8})$/,mbe=new RegExp(`^rgb\\(${hm},${hm},${hm}\\)$`),pbe=new RegExp(`^rgb\\(${Kc},${Kc},${Kc}\\)$`),xbe=new RegExp(`^rgba\\(${hm},${hm},${hm},${mv}\\)$`),ybe=new RegExp(`^rgba\\(${Kc},${Kc},${Kc},${mv}\\)$`),vbe=new RegExp(`^hsl\\(${mv},${Kc},${Kc}\\)$`),wbe=new RegExp(`^hsla\\(${mv},${Kc},${Kc},${mv}\\)$`),PR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};tA(e1,pv,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:FR,formatHex:FR,formatHex8:bbe,formatHsl:_be,formatRgb:OR,toString:OR});function FR(){return this.rgb().formatHex()}function bbe(){return this.rgb().formatHex8()}function _be(){return jW(this).formatHsl()}function OR(){return this.rgb().formatRgb()}function pv(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=gbe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?DR(t):r===3?new go(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Gw(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Gw(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=mbe.exec(e))?new go(t[1],t[2],t[3],1):(t=pbe.exec(e))?new go(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=xbe.exec(e))?Gw(t[1],t[2],t[3],t[4]):(t=ybe.exec(e))?Gw(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=vbe.exec(e))?MR(t[1],t[2]/100,t[3]/100,1):(t=wbe.exec(e))?MR(t[1],t[2]/100,t[3]/100,t[4]):PR.hasOwnProperty(e)?DR(PR[e]):e==="transparent"?new go(NaN,NaN,NaN,0):null}function DR(e){return new go(e>>16&255,e>>8&255,e&255,1)}function Gw(e,t,r,n){return n<=0&&(e=t=r=NaN),new go(e,t,r,n)}function Sbe(e){return e instanceof e1||(e=pv(e)),e?(e=e.rgb(),new go(e.r,e.g,e.b,e.opacity)):new go}function KE(e,t,r,n){return arguments.length===1?Sbe(e):new go(e,t,r,n??1)}function go(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}tA(go,KE,AW(e1,{brighter(e){return e=e==null?f_:Math.pow(f_,e),new go(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?gv:Math.pow(gv,e),new go(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new go(qh(this.r),qh(this.g),qh(this.b),h_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:RR,formatHex:RR,formatHex8:kbe,formatRgb:IR,toString:IR}));function RR(){return`#${Oh(this.r)}${Oh(this.g)}${Oh(this.b)}`}function kbe(){return`#${Oh(this.r)}${Oh(this.g)}${Oh(this.b)}${Oh((isNaN(this.opacity)?1:this.opacity)*255)}`}function IR(){const e=h_(this.opacity);return`${e===1?"rgb(":"rgba("}${qh(this.r)}, ${qh(this.g)}, ${qh(this.b)}${e===1?")":`, ${e})`}`}function h_(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function qh(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Oh(e){return e=qh(e),(e<16?"0":"")+e.toString(16)}function MR(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ql(e,t,r,n)}function jW(e){if(e instanceof Ql)return new Ql(e.h,e.s,e.l,e.opacity);if(e instanceof e1||(e=pv(e)),!e)return new Ql;if(e instanceof Ql)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,s=Math.min(t,r,n),a=Math.max(t,r,n),i=NaN,o=a-s,l=(a+s)/2;return o?(t===a?i=(r-n)/o+(r<n)*6:r===a?i=(n-t)/o+2:i=(t-r)/o+4,o/=l<.5?a+s:2-a-s,i*=60):o=l>0&&l<1?0:i,new Ql(i,o,l,e.opacity)}function Cbe(e,t,r,n){return arguments.length===1?jW(e):new Ql(e,t,r,n??1)}function Ql(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}tA(Ql,Cbe,AW(e1,{brighter(e){return e=e==null?f_:Math.pow(f_,e),new Ql(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?gv:Math.pow(gv,e),new Ql(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,s=2*r-n;return new go(IC(e>=240?e-240:e+120,s,n),IC(e,s,n),IC(e<120?e+240:e-120,s,n),this.opacity)},clamp(){return new Ql(LR(this.h),Vw(this.s),Vw(this.l),h_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=h_(this.opacity);return`${e===1?"hsl(":"hsla("}${LR(this.h)}, ${Vw(this.s)*100}%, ${Vw(this.l)*100}%${e===1?")":`, ${e})`}`}}));function LR(e){return e=(e||0)%360,e<0?e+360:e}function Vw(e){return Math.max(0,Math.min(1,e||0))}function IC(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const rA=e=>()=>e;function Tbe(e,t){return function(r){return e+r*t}}function Ebe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function Nbe(e){return(e=+e)==1?PW:function(t,r){return r-t?Ebe(t,r,e):rA(isNaN(t)?r:t)}}function PW(e,t){var r=t-e;return r?Tbe(e,r):rA(isNaN(e)?t:e)}const BR=(function e(t){var r=Nbe(t);function n(s,a){var i=r((s=KE(s)).r,(a=KE(a)).r),o=r(s.g,a.g),l=r(s.b,a.b),u=PW(s.opacity,a.opacity);return function(d){return s.r=i(d),s.g=o(d),s.b=l(d),s.opacity=u(d),s+""}}return n.gamma=e,n})(1);function Abe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),s;return function(a){for(s=0;s<r;++s)n[s]=e[s]*(1-a)+t[s]*a;return n}}function jbe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Pbe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,s=new Array(n),a=new Array(r),i;for(i=0;i<n;++i)s[i]=rp(e[i],t[i]);for(;i<r;++i)a[i]=t[i];return function(o){for(i=0;i<n;++i)a[i]=s[i](o);return a}}function Fbe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function g_(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Obe(e,t){var r={},n={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?r[s]=rp(e[s],t[s]):n[s]=t[s];return function(a){for(s in r)n[s]=r[s](a);return n}}var qE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,MC=new RegExp(qE.source,"g");function Dbe(e){return function(){return e}}function Rbe(e){return function(t){return e(t)+""}}function Ibe(e,t){var r=qE.lastIndex=MC.lastIndex=0,n,s,a,i=-1,o=[],l=[];for(e=e+"",t=t+"";(n=qE.exec(e))&&(s=MC.exec(t));)(a=s.index)>r&&(a=t.slice(r,a),o[i]?o[i]+=a:o[++i]=a),(n=n[0])===(s=s[0])?o[i]?o[i]+=s:o[++i]=s:(o[++i]=null,l.push({i,x:g_(n,s)})),r=MC.lastIndex;return r<t.length&&(a=t.slice(r),o[i]?o[i]+=a:o[++i]=a),o.length<2?l[0]?Rbe(l[0].x):Dbe(t):(t=l.length,function(u){for(var d=0,h;d<t;++d)o[(h=l[d]).i]=h.x(u);return o.join("")})}function rp(e,t){var r=typeof t,n;return t==null||r==="boolean"?rA(t):(r==="number"?g_:r==="string"?(n=pv(t))?(t=n,BR):Ibe:t instanceof pv?BR:t instanceof Date?Fbe:jbe(t)?Abe:Array.isArray(t)?Pbe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Obe:g_)(e,t)}function nA(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Mbe(e,t){t===void 0&&(t=e,e=rp);for(var r=0,n=t.length-1,s=t[0],a=new Array(n<0?0:n);r<n;)a[r]=e(s,s=t[++r]);return function(i){var o=Math.max(0,Math.min(n-1,Math.floor(i*=n)));return a[o](i-o)}}function Lbe(e){return function(){return e}}function m_(e){return+e}var $R=[0,1];function Ki(e){return e}function YE(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:Lbe(isNaN(t)?NaN:.5)}function Bbe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function $be(e,t,r){var n=e[0],s=e[1],a=t[0],i=t[1];return s<n?(n=YE(s,n),a=r(i,a)):(n=YE(n,s),a=r(a,i)),function(o){return a(n(o))}}function Ube(e,t,r){var n=Math.min(e.length,t.length)-1,s=new Array(n),a=new Array(n),i=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<n;)s[i]=YE(e[i],e[i+1]),a[i]=r(t[i],t[i+1]);return function(o){var l=Zv(e,o,1,n)-1;return a[l](s[l](o))}}function t1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function T2(){var e=$R,t=$R,r=rp,n,s,a,i=Ki,o,l,u;function d(){var g=Math.min(e.length,t.length);return i!==Ki&&(i=Bbe(e[0],e[g-1])),o=g>2?Ube:$be,l=u=null,h}function h(g){return g==null||isNaN(g=+g)?a:(l||(l=o(e.map(n),t,r)))(n(i(g)))}return h.invert=function(g){return i(s((u||(u=o(t,e.map(n),g_)))(g)))},h.domain=function(g){return arguments.length?(e=Array.from(g,m_),d()):e.slice()},h.range=function(g){return arguments.length?(t=Array.from(g),d()):t.slice()},h.rangeRound=function(g){return t=Array.from(g),r=nA,d()},h.clamp=function(g){return arguments.length?(i=g?!0:Ki,d()):i!==Ki},h.interpolate=function(g){return arguments.length?(r=g,d()):r},h.unknown=function(g){return arguments.length?(a=g,h):a},function(g,p){return n=g,s=p,d()}}function sA(){return T2()(Ki,Ki)}function zbe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function p_(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Nm(e){return e=p_(Math.abs(e)),e?e[1]:NaN}function Wbe(e,t){return function(r,n){for(var s=r.length,a=[],i=0,o=e[0],l=0;s>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),a.push(r.substring(s-=o,s+o)),!((l+=o+1)>n));)o=e[i=(i+1)%e.length];return a.reverse().join(t)}}function Hbe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var Gbe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function xv(e){if(!(t=Gbe.exec(e)))throw new Error("invalid format: "+e);var t;return new aA({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}xv.prototype=aA.prototype;function aA(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}aA.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Vbe(e){e:for(var t=e.length,r=1,n=-1,s;r<t;++r)switch(e[r]){case".":n=s=r;break;case"0":n===0&&(n=r),s=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(s+1):e}var FW;function Kbe(e,t){var r=p_(e,t);if(!r)return e+"";var n=r[0],s=r[1],a=s-(FW=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,i=n.length;return a===i?n:a>i?n+new Array(a-i+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+p_(e,Math.max(0,t+a-1))[0]}function UR(e,t){var r=p_(e,t);if(!r)return e+"";var n=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+n:n.length>s+1?n.slice(0,s+1)+"."+n.slice(s+1):n+new Array(s-n.length+2).join("0")}const zR={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:zbe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>UR(e*100,t),r:UR,s:Kbe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function WR(e){return e}var HR=Array.prototype.map,GR=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function qbe(e){var t=e.grouping===void 0||e.thousands===void 0?WR:Wbe(HR.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?WR:Hbe(HR.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(h){h=xv(h);var g=h.fill,p=h.align,x=h.sign,v=h.symbol,w=h.zero,C=h.width,k=h.comma,_=h.precision,N=h.trim,E=h.type;E==="n"?(k=!0,E="g"):zR[E]||(_===void 0&&(_=12),N=!0,E="g"),(w||g==="0"&&p==="=")&&(w=!0,g="0",p="=");var P=v==="$"?r:v==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():"",F=v==="$"?n:/[%p]/.test(E)?i:"",A=zR[E],j=/[defgprs%]/.test(E);_=_===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function R(U){var Y=P,Z=F,ae,ee,ne;if(E==="c")Z=A(U)+Z,U="";else{U=+U;var L=U<0||1/U<0;if(U=isNaN(U)?l:A(Math.abs(U),_),N&&(U=Vbe(U)),L&&+U==0&&x!=="+"&&(L=!1),Y=(L?x==="("?x:o:x==="-"||x==="("?"":x)+Y,Z=(E==="s"?GR[8+FW/3]:"")+Z+(L&&x==="("?")":""),j){for(ae=-1,ee=U.length;++ae<ee;)if(ne=U.charCodeAt(ae),48>ne||ne>57){Z=(ne===46?s+U.slice(ae+1):U.slice(ae))+Z,U=U.slice(0,ae);break}}}k&&!w&&(U=t(U,1/0));var H=Y.length+U.length+Z.length,M=H<C?new Array(C-H+1).join(g):"";switch(k&&w&&(U=t(M+U,M.length?C-Z.length:1/0),M=""),p){case"<":U=Y+U+Z+M;break;case"=":U=Y+M+U+Z;break;case"^":U=M.slice(0,H=M.length>>1)+Y+U+Z+M.slice(H);break;default:U=M+Y+U+Z;break}return a(U)}return R.toString=function(){return h+""},R}function d(h,g){var p=u((h=xv(h),h.type="f",h)),x=Math.max(-8,Math.min(8,Math.floor(Nm(g)/3)))*3,v=Math.pow(10,-x),w=GR[8+x/3];return function(C){return p(v*C)+w}}return{format:u,formatPrefix:d}}var Kw,iA,OW;Ybe({thousands:",",grouping:[3],currency:["$",""]});function Ybe(e){return Kw=qbe(e),iA=Kw.format,OW=Kw.formatPrefix,Kw}function Xbe(e){return Math.max(0,-Nm(Math.abs(e)))}function Jbe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Nm(t)/3)))*3-Nm(Math.abs(e)))}function Qbe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Nm(t)-Nm(e))+1}function DW(e,t,r,n){var s=GE(e,t,r),a;switch(n=xv(n??",f"),n.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=Jbe(s,i))&&(n.precision=a),OW(n,i)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=Qbe(s,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=Xbe(s))&&(n.precision=a-(n.type==="%")*2);break}}return iA(n)}function Bf(e){var t=e.domain;return e.ticks=function(r){var n=t();return WE(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var s=t();return DW(s[0],s[s.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),s=0,a=n.length-1,i=n[s],o=n[a],l,u,d=10;for(o<i&&(u=i,i=o,o=u,u=s,s=a,a=u);d-- >0;){if(u=HE(i,o,r),u===l)return n[s]=i,n[a]=o,t(n);if(u>0)i=Math.floor(i/u)*u,o=Math.ceil(o/u)*u;else if(u<0)i=Math.ceil(i*u)/u,o=Math.floor(o*u)/u;else break;l=u}return e},e}function RW(){var e=sA();return e.copy=function(){return t1(e,RW())},Fl.apply(e,arguments),Bf(e)}function IW(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,m_),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return IW(e).unknown(t)},e=arguments.length?Array.from(e,m_):[0,1],Bf(r)}function MW(e,t){e=e.slice();var r=0,n=e.length-1,s=e[r],a=e[n],i;return a<s&&(i=r,r=n,n=i,i=s,s=a,a=i),e[r]=t.floor(s),e[n]=t.ceil(a),e}function VR(e){return Math.log(e)}function KR(e){return Math.exp(e)}function Zbe(e){return-Math.log(-e)}function e_e(e){return-Math.exp(-e)}function t_e(e){return isFinite(e)?+("1e"+e):e<0?0:e}function r_e(e){return e===10?t_e:e===Math.E?Math.exp:t=>Math.pow(e,t)}function n_e(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function qR(e){return(t,r)=>-e(-t,r)}function oA(e){const t=e(VR,KR),r=t.domain;let n=10,s,a;function i(){return s=n_e(n),a=r_e(n),r()[0]<0?(s=qR(s),a=qR(a),e(Zbe,e_e)):e(VR,KR),t}return t.base=function(o){return arguments.length?(n=+o,i()):n},t.domain=function(o){return arguments.length?(r(o),i()):r()},t.ticks=o=>{const l=r();let u=l[0],d=l[l.length-1];const h=d<u;h&&([u,d]=[d,u]);let g=s(u),p=s(d),x,v;const w=o==null?10:+o;let C=[];if(!(n%1)&&p-g<w){if(g=Math.floor(g),p=Math.ceil(p),u>0){for(;g<=p;++g)for(x=1;x<n;++x)if(v=g<0?x/a(-g):x*a(g),!(v<u)){if(v>d)break;C.push(v)}}else for(;g<=p;++g)for(x=n-1;x>=1;--x)if(v=g>0?x/a(-g):x*a(g),!(v<u)){if(v>d)break;C.push(v)}C.length*2<w&&(C=WE(u,d,w))}else C=WE(g,p,Math.min(p-g,w)).map(a);return h?C.reverse():C},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=xv(l)).precision==null&&(l.trim=!0),l=iA(l)),o===1/0)return l;const u=Math.max(1,n*o/t.ticks().length);return d=>{let h=d/a(Math.round(s(d)));return h*n<n-.5&&(h*=n),h<=u?l(d):""}},t.nice=()=>r(MW(r(),{floor:o=>a(Math.floor(s(o))),ceil:o=>a(Math.ceil(s(o)))})),t}function LW(){const e=oA(T2()).domain([1,10]);return e.copy=()=>t1(e,LW()).base(e.base()),Fl.apply(e,arguments),e}function YR(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function XR(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function lA(e){var t=1,r=e(YR(t),XR(t));return r.constant=function(n){return arguments.length?e(YR(t=+n),XR(t)):t},Bf(r)}function BW(){var e=lA(T2());return e.copy=function(){return t1(e,BW()).constant(e.constant())},Fl.apply(e,arguments)}function JR(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function s_e(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function a_e(e){return e<0?-e*e:e*e}function cA(e){var t=e(Ki,Ki),r=1;function n(){return r===1?e(Ki,Ki):r===.5?e(s_e,a_e):e(JR(r),JR(1/r))}return t.exponent=function(s){return arguments.length?(r=+s,n()):r},Bf(t)}function uA(){var e=cA(T2());return e.copy=function(){return t1(e,uA()).exponent(e.exponent())},Fl.apply(e,arguments),e}function i_e(){return uA.apply(null,arguments).exponent(.5)}function QR(e){return Math.sign(e)*e*e}function o_e(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function $W(){var e=sA(),t=[0,1],r=!1,n;function s(a){var i=o_e(e(a));return isNaN(i)?n:r?Math.round(i):i}return s.invert=function(a){return e.invert(QR(a))},s.domain=function(a){return arguments.length?(e.domain(a),s):e.domain()},s.range=function(a){return arguments.length?(e.range((t=Array.from(a,m_)).map(QR)),s):t.slice()},s.rangeRound=function(a){return s.range(a).round(!0)},s.round=function(a){return arguments.length?(r=!!a,s):r},s.clamp=function(a){return arguments.length?(e.clamp(a),s):e.clamp()},s.unknown=function(a){return arguments.length?(n=a,s):n},s.copy=function(){return $W(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Fl.apply(s,arguments),Bf(s)}function UW(){var e=[],t=[],r=[],n;function s(){var i=0,o=Math.max(1,t.length);for(r=new Array(o-1);++i<o;)r[i-1]=dbe(e,i/o);return a}function a(i){return i==null||isNaN(i=+i)?n:t[Zv(r,i)]}return a.invertExtent=function(i){var o=t.indexOf(i);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},a.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let o of i)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(yf),s()},a.range=function(i){return arguments.length?(t=Array.from(i),s()):t.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return UW().domain(e).range(t).unknown(n)},Fl.apply(a,arguments)}function zW(){var e=0,t=1,r=1,n=[.5],s=[0,1],a;function i(l){return l!=null&&l<=l?s[Zv(n,l,0,r)]:a}function o(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return i}return i.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},i.range=function(l){return arguments.length?(r=(s=Array.from(l)).length-1,o()):s.slice()},i.invertExtent=function(l){var u=s.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},i.unknown=function(l){return arguments.length&&(a=l),i},i.thresholds=function(){return n.slice()},i.copy=function(){return zW().domain([e,t]).range(s).unknown(a)},Fl.apply(Bf(i),arguments)}function WW(){var e=[.5],t=[0,1],r,n=1;function s(a){return a!=null&&a<=a?t[Zv(e,a,0,n)]:r}return s.domain=function(a){return arguments.length?(e=Array.from(a),n=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(a){return arguments.length?(t=Array.from(a),n=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(a){var i=t.indexOf(a);return[e[i-1],e[i]]},s.unknown=function(a){return arguments.length?(r=a,s):r},s.copy=function(){return WW().domain(e).range(t).unknown(r)},Fl.apply(s,arguments)}const LC=new Date,BC=new Date;function pa(e,t,r,n){function s(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return s.floor=a=>(e(a=new Date(+a)),a),s.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),s.round=a=>{const i=s(a),o=s.ceil(a);return a-i<o-a?i:o},s.offset=(a,i)=>(t(a=new Date(+a),i==null?1:Math.floor(i)),a),s.range=(a,i,o)=>{const l=[];if(a=s.ceil(a),o=o==null?1:Math.floor(o),!(a<i)||!(o>0))return l;let u;do l.push(u=new Date(+a)),t(a,o),e(a);while(u<a&&a<i);return l},s.filter=a=>pa(i=>{if(i>=i)for(;e(i),!a(i);)i.setTime(i-1)},(i,o)=>{if(i>=i)if(o<0)for(;++o<=0;)for(;t(i,-1),!a(i););else for(;--o>=0;)for(;t(i,1),!a(i););}),r&&(s.count=(a,i)=>(LC.setTime(+a),BC.setTime(+i),e(LC),e(BC),Math.floor(r(LC,BC))),s.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?s.filter(n?i=>n(i)%a===0:i=>s.count(0,i)%a===0):s)),s}const x_=pa(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);x_.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?pa(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):x_);x_.range;const $u=1e3,vl=$u*60,Uu=vl*60,td=Uu*24,dA=td*7,ZR=td*30,$C=td*365,Dh=pa(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*$u)},(e,t)=>(t-e)/$u,e=>e.getUTCSeconds());Dh.range;const fA=pa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*$u)},(e,t)=>{e.setTime(+e+t*vl)},(e,t)=>(t-e)/vl,e=>e.getMinutes());fA.range;const hA=pa(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*vl)},(e,t)=>(t-e)/vl,e=>e.getUTCMinutes());hA.range;const gA=pa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*$u-e.getMinutes()*vl)},(e,t)=>{e.setTime(+e+t*Uu)},(e,t)=>(t-e)/Uu,e=>e.getHours());gA.range;const mA=pa(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Uu)},(e,t)=>(t-e)/Uu,e=>e.getUTCHours());mA.range;const r1=pa(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*vl)/td,e=>e.getDate()-1);r1.range;const E2=pa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/td,e=>e.getUTCDate()-1);E2.range;const HW=pa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/td,e=>Math.floor(e/td));HW.range;function O0(e){return pa(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*vl)/dA)}const N2=O0(0),y_=O0(1),l_e=O0(2),c_e=O0(3),Am=O0(4),u_e=O0(5),d_e=O0(6);N2.range;y_.range;l_e.range;c_e.range;Am.range;u_e.range;d_e.range;function D0(e){return pa(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/dA)}const A2=D0(0),v_=D0(1),f_e=D0(2),h_e=D0(3),jm=D0(4),g_e=D0(5),m_e=D0(6);A2.range;v_.range;f_e.range;h_e.range;jm.range;g_e.range;m_e.range;const pA=pa(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());pA.range;const xA=pa(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());xA.range;const rd=pa(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());rd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:pa(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});rd.range;const nd=pa(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());nd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:pa(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});nd.range;function GW(e,t,r,n,s,a){const i=[[Dh,1,$u],[Dh,5,5*$u],[Dh,15,15*$u],[Dh,30,30*$u],[a,1,vl],[a,5,5*vl],[a,15,15*vl],[a,30,30*vl],[s,1,Uu],[s,3,3*Uu],[s,6,6*Uu],[s,12,12*Uu],[n,1,td],[n,2,2*td],[r,1,dA],[t,1,ZR],[t,3,3*ZR],[e,1,$C]];function o(u,d,h){const g=d<u;g&&([u,d]=[d,u]);const p=h&&typeof h.range=="function"?h:l(u,d,h),x=p?p.range(u,+d+1):[];return g?x.reverse():x}function l(u,d,h){const g=Math.abs(d-u)/h,p=Q3(([,,w])=>w).right(i,g);if(p===i.length)return e.every(GE(u/$C,d/$C,h));if(p===0)return x_.every(Math.max(GE(u,d,h),1));const[x,v]=i[g/i[p-1][2]<i[p][2]/g?p-1:p];return x.every(v)}return[o,l]}const[p_e,x_e]=GW(nd,xA,A2,HW,mA,hA),[y_e,v_e]=GW(rd,pA,N2,r1,gA,fA);function UC(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function zC(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ey(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function w_e(e){var t=e.dateTime,r=e.date,n=e.time,s=e.periods,a=e.days,i=e.shortDays,o=e.months,l=e.shortMonths,u=ty(s),d=ry(s),h=ty(a),g=ry(a),p=ty(i),x=ry(i),v=ty(o),w=ry(o),C=ty(l),k=ry(l),_={a:L,A:H,b:M,B:V,c:null,d:aI,e:aI,f:W_e,g:Z_e,G:t2e,H:$_e,I:U_e,j:z_e,L:VW,m:H_e,M:G_e,p:W,q:I,Q:lI,s:cI,S:V_e,u:K_e,U:q_e,V:Y_e,w:X_e,W:J_e,x:null,X:null,y:Q_e,Y:e2e,Z:r2e,"%":oI},N={a:B,A:q,b:J,B:se,c:null,d:iI,e:iI,f:i2e,g:p2e,G:y2e,H:n2e,I:s2e,j:a2e,L:qW,m:o2e,M:l2e,p:X,q:ie,Q:lI,s:cI,S:c2e,u:u2e,U:d2e,V:f2e,w:h2e,W:g2e,x:null,X:null,y:m2e,Y:x2e,Z:v2e,"%":oI},E={a:R,A:U,b:Y,B:Z,c:ae,d:nI,e:nI,f:I_e,g:rI,G:tI,H:sI,I:sI,j:F_e,L:R_e,m:P_e,M:O_e,p:j,q:j_e,Q:L_e,s:B_e,S:D_e,u:C_e,U:T_e,V:E_e,w:k_e,W:N_e,x:ee,X:ne,y:rI,Y:tI,Z:A_e,"%":M_e};_.x=P(r,_),_.X=P(n,_),_.c=P(t,_),N.x=P(r,N),N.X=P(n,N),N.c=P(t,N);function P(le,ce){return function(ke){var re=[],ge=-1,Ne=0,je=le.length,Ke,Ue,It;for(ke instanceof Date||(ke=new Date(+ke));++ge<je;)le.charCodeAt(ge)===37&&(re.push(le.slice(Ne,ge)),(Ue=eI[Ke=le.charAt(++ge)])!=null?Ke=le.charAt(++ge):Ue=Ke==="e"?" ":"0",(It=ce[Ke])&&(Ke=It(ke,Ue)),re.push(Ke),Ne=ge+1);return re.push(le.slice(Ne,ge)),re.join("")}}function F(le,ce){return function(ke){var re=ey(1900,void 0,1),ge=A(re,le,ke+="",0),Ne,je;if(ge!=ke.length)return null;if("Q"in re)return new Date(re.Q);if("s"in re)return new Date(re.s*1e3+("L"in re?re.L:0));if(ce&&!("Z"in re)&&(re.Z=0),"p"in re&&(re.H=re.H%12+re.p*12),re.m===void 0&&(re.m="q"in re?re.q:0),"V"in re){if(re.V<1||re.V>53)return null;"w"in re||(re.w=1),"Z"in re?(Ne=zC(ey(re.y,0,1)),je=Ne.getUTCDay(),Ne=je>4||je===0?v_.ceil(Ne):v_(Ne),Ne=E2.offset(Ne,(re.V-1)*7),re.y=Ne.getUTCFullYear(),re.m=Ne.getUTCMonth(),re.d=Ne.getUTCDate()+(re.w+6)%7):(Ne=UC(ey(re.y,0,1)),je=Ne.getDay(),Ne=je>4||je===0?y_.ceil(Ne):y_(Ne),Ne=r1.offset(Ne,(re.V-1)*7),re.y=Ne.getFullYear(),re.m=Ne.getMonth(),re.d=Ne.getDate()+(re.w+6)%7)}else("W"in re||"U"in re)&&("w"in re||(re.w="u"in re?re.u%7:"W"in re?1:0),je="Z"in re?zC(ey(re.y,0,1)).getUTCDay():UC(ey(re.y,0,1)).getDay(),re.m=0,re.d="W"in re?(re.w+6)%7+re.W*7-(je+5)%7:re.w+re.U*7-(je+6)%7);return"Z"in re?(re.H+=re.Z/100|0,re.M+=re.Z%100,zC(re)):UC(re)}}function A(le,ce,ke,re){for(var ge=0,Ne=ce.length,je=ke.length,Ke,Ue;ge<Ne;){if(re>=je)return-1;if(Ke=ce.charCodeAt(ge++),Ke===37){if(Ke=ce.charAt(ge++),Ue=E[Ke in eI?ce.charAt(ge++):Ke],!Ue||(re=Ue(le,ke,re))<0)return-1}else if(Ke!=ke.charCodeAt(re++))return-1}return re}function j(le,ce,ke){var re=u.exec(ce.slice(ke));return re?(le.p=d.get(re[0].toLowerCase()),ke+re[0].length):-1}function R(le,ce,ke){var re=p.exec(ce.slice(ke));return re?(le.w=x.get(re[0].toLowerCase()),ke+re[0].length):-1}function U(le,ce,ke){var re=h.exec(ce.slice(ke));return re?(le.w=g.get(re[0].toLowerCase()),ke+re[0].length):-1}function Y(le,ce,ke){var re=C.exec(ce.slice(ke));return re?(le.m=k.get(re[0].toLowerCase()),ke+re[0].length):-1}function Z(le,ce,ke){var re=v.exec(ce.slice(ke));return re?(le.m=w.get(re[0].toLowerCase()),ke+re[0].length):-1}function ae(le,ce,ke){return A(le,t,ce,ke)}function ee(le,ce,ke){return A(le,r,ce,ke)}function ne(le,ce,ke){return A(le,n,ce,ke)}function L(le){return i[le.getDay()]}function H(le){return a[le.getDay()]}function M(le){return l[le.getMonth()]}function V(le){return o[le.getMonth()]}function W(le){return s[+(le.getHours()>=12)]}function I(le){return 1+~~(le.getMonth()/3)}function B(le){return i[le.getUTCDay()]}function q(le){return a[le.getUTCDay()]}function J(le){return l[le.getUTCMonth()]}function se(le){return o[le.getUTCMonth()]}function X(le){return s[+(le.getUTCHours()>=12)]}function ie(le){return 1+~~(le.getUTCMonth()/3)}return{format:function(le){var ce=P(le+="",_);return ce.toString=function(){return le},ce},parse:function(le){var ce=F(le+="",!1);return ce.toString=function(){return le},ce},utcFormat:function(le){var ce=P(le+="",N);return ce.toString=function(){return le},ce},utcParse:function(le){var ce=F(le+="",!0);return ce.toString=function(){return le},ce}}}var eI={"-":"",_:" ",0:"0"},Ia=/^\s*\d+/,b_e=/^%/,__e=/[\\^$*+?|[\]().{}]/g;function mn(e,t,r){var n=e<0?"-":"",s=(n?-e:e)+"",a=s.length;return n+(a<r?new Array(r-a+1).join(t)+s:s)}function S_e(e){return e.replace(__e,"\\$&")}function ty(e){return new RegExp("^(?:"+e.map(S_e).join("|")+")","i")}function ry(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function k_e(e,t,r){var n=Ia.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function C_e(e,t,r){var n=Ia.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function T_e(e,t,r){var n=Ia.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function E_e(e,t,r){var n=Ia.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function N_e(e,t,r){var n=Ia.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function tI(e,t,r){var n=Ia.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function rI(e,t,r){var n=Ia.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function A_e(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function j_e(e,t,r){var n=Ia.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function P_e(e,t,r){var n=Ia.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function nI(e,t,r){var n=Ia.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function F_e(e,t,r){var n=Ia.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function sI(e,t,r){var n=Ia.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function O_e(e,t,r){var n=Ia.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function D_e(e,t,r){var n=Ia.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function R_e(e,t,r){var n=Ia.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function I_e(e,t,r){var n=Ia.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function M_e(e,t,r){var n=b_e.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function L_e(e,t,r){var n=Ia.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function B_e(e,t,r){var n=Ia.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function aI(e,t){return mn(e.getDate(),t,2)}function $_e(e,t){return mn(e.getHours(),t,2)}function U_e(e,t){return mn(e.getHours()%12||12,t,2)}function z_e(e,t){return mn(1+r1.count(rd(e),e),t,3)}function VW(e,t){return mn(e.getMilliseconds(),t,3)}function W_e(e,t){return VW(e,t)+"000"}function H_e(e,t){return mn(e.getMonth()+1,t,2)}function G_e(e,t){return mn(e.getMinutes(),t,2)}function V_e(e,t){return mn(e.getSeconds(),t,2)}function K_e(e){var t=e.getDay();return t===0?7:t}function q_e(e,t){return mn(N2.count(rd(e)-1,e),t,2)}function KW(e){var t=e.getDay();return t>=4||t===0?Am(e):Am.ceil(e)}function Y_e(e,t){return e=KW(e),mn(Am.count(rd(e),e)+(rd(e).getDay()===4),t,2)}function X_e(e){return e.getDay()}function J_e(e,t){return mn(y_.count(rd(e)-1,e),t,2)}function Q_e(e,t){return mn(e.getFullYear()%100,t,2)}function Z_e(e,t){return e=KW(e),mn(e.getFullYear()%100,t,2)}function e2e(e,t){return mn(e.getFullYear()%1e4,t,4)}function t2e(e,t){var r=e.getDay();return e=r>=4||r===0?Am(e):Am.ceil(e),mn(e.getFullYear()%1e4,t,4)}function r2e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+mn(t/60|0,"0",2)+mn(t%60,"0",2)}function iI(e,t){return mn(e.getUTCDate(),t,2)}function n2e(e,t){return mn(e.getUTCHours(),t,2)}function s2e(e,t){return mn(e.getUTCHours()%12||12,t,2)}function a2e(e,t){return mn(1+E2.count(nd(e),e),t,3)}function qW(e,t){return mn(e.getUTCMilliseconds(),t,3)}function i2e(e,t){return qW(e,t)+"000"}function o2e(e,t){return mn(e.getUTCMonth()+1,t,2)}function l2e(e,t){return mn(e.getUTCMinutes(),t,2)}function c2e(e,t){return mn(e.getUTCSeconds(),t,2)}function u2e(e){var t=e.getUTCDay();return t===0?7:t}function d2e(e,t){return mn(A2.count(nd(e)-1,e),t,2)}function YW(e){var t=e.getUTCDay();return t>=4||t===0?jm(e):jm.ceil(e)}function f2e(e,t){return e=YW(e),mn(jm.count(nd(e),e)+(nd(e).getUTCDay()===4),t,2)}function h2e(e){return e.getUTCDay()}function g2e(e,t){return mn(v_.count(nd(e)-1,e),t,2)}function m2e(e,t){return mn(e.getUTCFullYear()%100,t,2)}function p2e(e,t){return e=YW(e),mn(e.getUTCFullYear()%100,t,2)}function x2e(e,t){return mn(e.getUTCFullYear()%1e4,t,4)}function y2e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?jm(e):jm.ceil(e),mn(e.getUTCFullYear()%1e4,t,4)}function v2e(){return"+0000"}function oI(){return"%"}function lI(e){return+e}function cI(e){return Math.floor(+e/1e3)}var Ig,XW,JW;w2e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function w2e(e){return Ig=w_e(e),XW=Ig.format,Ig.parse,JW=Ig.utcFormat,Ig.utcParse,Ig}function b2e(e){return new Date(e)}function _2e(e){return e instanceof Date?+e:+new Date(+e)}function yA(e,t,r,n,s,a,i,o,l,u){var d=sA(),h=d.invert,g=d.domain,p=u(".%L"),x=u(":%S"),v=u("%I:%M"),w=u("%I %p"),C=u("%a %d"),k=u("%b %d"),_=u("%B"),N=u("%Y");function E(P){return(l(P)<P?p:o(P)<P?x:i(P)<P?v:a(P)<P?w:n(P)<P?s(P)<P?C:k:r(P)<P?_:N)(P)}return d.invert=function(P){return new Date(h(P))},d.domain=function(P){return arguments.length?g(Array.from(P,_2e)):g().map(b2e)},d.ticks=function(P){var F=g();return e(F[0],F[F.length-1],P??10)},d.tickFormat=function(P,F){return F==null?E:u(F)},d.nice=function(P){var F=g();return(!P||typeof P.range!="function")&&(P=t(F[0],F[F.length-1],P??10)),P?g(MW(F,P)):d},d.copy=function(){return t1(d,yA(e,t,r,n,s,a,i,o,l,u))},d}function S2e(){return Fl.apply(yA(y_e,v_e,rd,pA,N2,r1,gA,fA,Dh,XW).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function k2e(){return Fl.apply(yA(p_e,x_e,nd,xA,A2,E2,mA,hA,Dh,JW).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function j2(){var e=0,t=1,r,n,s,a,i=Ki,o=!1,l;function u(h){return h==null||isNaN(h=+h)?l:i(s===0?.5:(h=(a(h)-r)*s,o?Math.max(0,Math.min(1,h)):h))}u.domain=function(h){return arguments.length?([e,t]=h,r=a(e=+e),n=a(t=+t),s=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(h){return arguments.length?(o=!!h,u):o},u.interpolator=function(h){return arguments.length?(i=h,u):i};function d(h){return function(g){var p,x;return arguments.length?([p,x]=g,i=h(p,x),u):[i(0),i(1)]}}return u.range=d(rp),u.rangeRound=d(nA),u.unknown=function(h){return arguments.length?(l=h,u):l},function(h){return a=h,r=h(e),n=h(t),s=r===n?0:1/(n-r),u}}function $f(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function QW(){var e=Bf(j2()(Ki));return e.copy=function(){return $f(e,QW())},dd.apply(e,arguments)}function ZW(){var e=oA(j2()).domain([1,10]);return e.copy=function(){return $f(e,ZW()).base(e.base())},dd.apply(e,arguments)}function eH(){var e=lA(j2());return e.copy=function(){return $f(e,eH()).constant(e.constant())},dd.apply(e,arguments)}function vA(){var e=cA(j2());return e.copy=function(){return $f(e,vA()).exponent(e.exponent())},dd.apply(e,arguments)}function C2e(){return vA.apply(null,arguments).exponent(.5)}function tH(){var e=[],t=Ki;function r(n){if(n!=null&&!isNaN(n=+n))return t((Zv(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let s of n)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(yf),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,s)=>t(s/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(s,a)=>ube(e,a/n))},r.copy=function(){return tH(t).domain(e)},dd.apply(r,arguments)}function P2(){var e=0,t=.5,r=1,n=1,s,a,i,o,l,u=Ki,d,h=!1,g;function p(v){return isNaN(v=+v)?g:(v=.5+((v=+d(v))-a)*(n*v<n*a?o:l),u(h?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,t,r]=v,s=d(e=+e),a=d(t=+t),i=d(r=+r),o=s===a?0:.5/(a-s),l=a===i?0:.5/(i-a),n=a<s?-1:1,p):[e,t,r]},p.clamp=function(v){return arguments.length?(h=!!v,p):h},p.interpolator=function(v){return arguments.length?(u=v,p):u};function x(v){return function(w){var C,k,_;return arguments.length?([C,k,_]=w,u=Mbe(v,[C,k,_]),p):[u(0),u(.5),u(1)]}}return p.range=x(rp),p.rangeRound=x(nA),p.unknown=function(v){return arguments.length?(g=v,p):g},function(v){return d=v,s=v(e),a=v(t),i=v(r),o=s===a?0:.5/(a-s),l=a===i?0:.5/(i-a),n=a<s?-1:1,p}}function rH(){var e=Bf(P2()(Ki));return e.copy=function(){return $f(e,rH())},dd.apply(e,arguments)}function nH(){var e=oA(P2()).domain([.1,1,10]);return e.copy=function(){return $f(e,nH()).base(e.base())},dd.apply(e,arguments)}function sH(){var e=lA(P2());return e.copy=function(){return $f(e,sH()).constant(e.constant())},dd.apply(e,arguments)}function wA(){var e=cA(P2());return e.copy=function(){return $f(e,wA()).exponent(e.exponent())},dd.apply(e,arguments)}function T2e(){return wA.apply(null,arguments).exponent(.5)}const dy=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:eA,scaleDiverging:rH,scaleDivergingLog:nH,scaleDivergingPow:wA,scaleDivergingSqrt:T2e,scaleDivergingSymlog:sH,scaleIdentity:IW,scaleImplicit:VE,scaleLinear:RW,scaleLog:LW,scaleOrdinal:Z3,scalePoint:hbe,scalePow:uA,scaleQuantile:UW,scaleQuantize:zW,scaleRadial:$W,scaleSequential:QW,scaleSequentialLog:ZW,scaleSequentialPow:vA,scaleSequentialQuantile:tH,scaleSequentialSqrt:C2e,scaleSequentialSymlog:eH,scaleSqrt:i_e,scaleSymlog:BW,scaleThreshold:WW,scaleTime:S2e,scaleUtc:k2e,tickFormat:DW},Symbol.toStringTag,{value:"Module"}));var Uf=e=>e.chartData,E2e=St([Uf],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),bA=(e,t,r,n)=>n?E2e(e):Uf(e);function Pm(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(oc(t)&&oc(r))return!0}return!1}function uI(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function N2e(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,s,a;if(oc(r))s=r;else if(typeof r=="function")return;if(oc(n))a=n;else if(typeof n=="function")return;var i=[s,a];if(Pm(i))return i}}function A2e(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Pm(n))return uI(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[s,a]=e,i,o;if(s==="auto")t!=null&&(i=Math.min(...t));else if(Ir(s))i=s;else if(typeof s=="function")try{t!=null&&(i=s(t?.[0]))}catch{}else if(typeof s=="string"&&rR.test(s)){var l=rR.exec(s);if(l==null||t==null)i=void 0;else{var u=+l[1];i=t[0]-u}}else i=t?.[0];if(a==="auto")t!=null&&(o=Math.max(...t));else if(Ir(a))o=a;else if(typeof a=="function")try{t!=null&&(o=a(t?.[1]))}catch{}else if(typeof a=="string"&&nR.test(a)){var d=nR.exec(a);if(d==null||t==null)o=void 0;else{var h=+d[1];o=t[1]+h}}else o=t?.[1];var g=[i,o];if(Pm(g))return t==null?g:uI(g,t,r)}}}var np=1e9,j2e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},SA,as=!0,El="[DecimalError] ",Yh=El+"Invalid argument: ",_A=El+"Exponent out of range: ",sp=Math.floor,Ch=Math.pow,P2e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Lo,Ea=1e7,Gn=7,aH=9007199254740991,w_=sp(aH/Gn),ur={};ur.absoluteValue=ur.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ur.comparedTo=ur.cmp=function(e){var t,r,n,s,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(n=a.d.length,s=e.d.length,t=0,r=n<s?n:s;t<r;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return n===s?0:n>s^a.s<0?1:-1};ur.decimalPlaces=ur.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Gn;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};ur.dividedBy=ur.div=function(e){return Ku(this,new this.constructor(e))};ur.dividedToIntegerBy=ur.idiv=function(e){var t=this,r=t.constructor;return Ln(Ku(t,new r(e),0,1),r.precision)};ur.equals=ur.eq=function(e){return!this.cmp(e)};ur.exponent=function(){return ta(this)};ur.greaterThan=ur.gt=function(e){return this.cmp(e)>0};ur.greaterThanOrEqualTo=ur.gte=function(e){return this.cmp(e)>=0};ur.isInteger=ur.isint=function(){return this.e>this.d.length-2};ur.isNegative=ur.isneg=function(){return this.s<0};ur.isPositive=ur.ispos=function(){return this.s>0};ur.isZero=function(){return this.s===0};ur.lessThan=ur.lt=function(e){return this.cmp(e)<0};ur.lessThanOrEqualTo=ur.lte=function(e){return this.cmp(e)<1};ur.logarithm=ur.log=function(e){var t,r=this,n=r.constructor,s=n.precision,a=s+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Lo))throw Error(El+"NaN");if(r.s<1)throw Error(El+(r.s?"NaN":"-Infinity"));return r.eq(Lo)?new n(0):(as=!1,t=Ku(yv(r,a),yv(e,a),a),as=!0,Ln(t,s))};ur.minus=ur.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?lH(t,e):iH(t,(e.s=-e.s,e))};ur.modulo=ur.mod=function(e){var t,r=this,n=r.constructor,s=n.precision;if(e=new n(e),!e.s)throw Error(El+"NaN");return r.s?(as=!1,t=Ku(r,e,0,1).times(e),as=!0,r.minus(t)):Ln(new n(r),s)};ur.naturalExponential=ur.exp=function(){return oH(this)};ur.naturalLogarithm=ur.ln=function(){return yv(this)};ur.negated=ur.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ur.plus=ur.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?iH(t,e):lH(t,(e.s=-e.s,e))};ur.precision=ur.sd=function(e){var t,r,n,s=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Yh+e);if(t=ta(s)+1,n=s.d.length-1,r=n*Gn+1,n=s.d[n],n){for(;n%10==0;n/=10)r--;for(n=s.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};ur.squareRoot=ur.sqrt=function(){var e,t,r,n,s,a,i,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(El+"NaN")}for(e=ta(o),as=!1,s=Math.sqrt(+o),s==0||s==1/0?(t=zc(o.d),(t.length+e)%2==0&&(t+="0"),s=Math.sqrt(t),e=sp((e+1)/2)-(e<0||e%2),s==1/0?t="5e"+e:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new l(t)):n=new l(s.toString()),r=l.precision,s=i=r+3;;)if(a=n,n=a.plus(Ku(o,a,i+2)).times(.5),zc(a.d).slice(0,i)===(t=zc(n.d)).slice(0,i)){if(t=t.slice(i-3,i+1),s==i&&t=="4999"){if(Ln(a,r+1,0),a.times(a).eq(o)){n=a;break}}else if(t!="9999")break;i+=4}return as=!0,Ln(n,r)};ur.times=ur.mul=function(e){var t,r,n,s,a,i,o,l,u,d=this,h=d.constructor,g=d.d,p=(e=new h(e)).d;if(!d.s||!e.s)return new h(0);for(e.s*=d.s,r=d.e+e.e,l=g.length,u=p.length,l<u&&(a=g,g=p,p=a,i=l,l=u,u=i),a=[],i=l+u,n=i;n--;)a.push(0);for(n=u;--n>=0;){for(t=0,s=l+n;s>n;)o=a[s]+p[n]*g[s-n-1]+t,a[s--]=o%Ea|0,t=o/Ea|0;a[s]=(a[s]+t)%Ea|0}for(;!a[--i];)a.pop();return t?++r:a.shift(),e.d=a,e.e=r,as?Ln(e,h.precision):e};ur.toDecimalPlaces=ur.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Jc(e,0,np),t===void 0?t=n.rounding:Jc(t,0,8),Ln(r,e+ta(r)+1,t))};ur.toExponential=function(e,t){var r,n=this,s=n.constructor;return e===void 0?r=y0(n,!0):(Jc(e,0,np),t===void 0?t=s.rounding:Jc(t,0,8),n=Ln(new s(n),e+1,t),r=y0(n,!0,e+1)),r};ur.toFixed=function(e,t){var r,n,s=this,a=s.constructor;return e===void 0?y0(s):(Jc(e,0,np),t===void 0?t=a.rounding:Jc(t,0,8),n=Ln(new a(s),e+ta(s)+1,t),r=y0(n.abs(),!1,e+ta(n)+1),s.isneg()&&!s.isZero()?"-"+r:r)};ur.toInteger=ur.toint=function(){var e=this,t=e.constructor;return Ln(new t(e),ta(e)+1,t.rounding)};ur.toNumber=function(){return+this};ur.toPower=ur.pow=function(e){var t,r,n,s,a,i,o=this,l=o.constructor,u=12,d=+(e=new l(e));if(!e.s)return new l(Lo);if(o=new l(o),!o.s){if(e.s<1)throw Error(El+"Infinity");return o}if(o.eq(Lo))return o;if(n=l.precision,e.eq(Lo))return Ln(o,n);if(t=e.e,r=e.d.length-1,i=t>=r,a=o.s,i){if((r=d<0?-d:d)<=aH){for(s=new l(Lo),t=Math.ceil(n/Gn+4),as=!1;r%2&&(s=s.times(o),fI(s.d,t)),r=sp(r/2),r!==0;)o=o.times(o),fI(o.d,t);return as=!0,e.s<0?new l(Lo).div(s):Ln(s,n)}}else if(a<0)throw Error(El+"NaN");return a=a<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,as=!1,s=e.times(yv(o,n+u)),as=!0,s=oH(s),s.s=a,s};ur.toPrecision=function(e,t){var r,n,s=this,a=s.constructor;return e===void 0?(r=ta(s),n=y0(s,r<=a.toExpNeg||r>=a.toExpPos)):(Jc(e,1,np),t===void 0?t=a.rounding:Jc(t,0,8),s=Ln(new a(s),e,t),r=ta(s),n=y0(s,e<=r||r<=a.toExpNeg,e)),n};ur.toSignificantDigits=ur.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Jc(e,1,np),t===void 0?t=n.rounding:Jc(t,0,8)),Ln(new n(r),e,t)};ur.toString=ur.valueOf=ur.val=ur.toJSON=ur[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=ta(e),r=e.constructor;return y0(e,t<=r.toExpNeg||t>=r.toExpPos)};function iH(e,t){var r,n,s,a,i,o,l,u,d=e.constructor,h=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),as?Ln(t,h):t;if(l=e.d,u=t.d,i=e.e,s=t.e,l=l.slice(),a=i-s,a){for(a<0?(n=l,a=-a,o=u.length):(n=u,s=i,o=l.length),i=Math.ceil(h/Gn),o=i>o?i+1:o+1,a>o&&(a=o,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(o=l.length,a=u.length,o-a<0&&(a=o,n=u,u=l,l=n),r=0;a;)r=(l[--a]=l[a]+u[a]+r)/Ea|0,l[a]%=Ea;for(r&&(l.unshift(r),++s),o=l.length;l[--o]==0;)l.pop();return t.d=l,t.e=s,as?Ln(t,h):t}function Jc(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Yh+e)}function zc(e){var t,r,n,s=e.length-1,a="",i=e[0];if(s>0){for(a+=i,t=1;t<s;t++)n=e[t]+"",r=Gn-n.length,r&&(a+=nf(r)),a+=n;i=e[t],n=i+"",r=Gn-n.length,r&&(a+=nf(r))}else if(i===0)return"0";for(;i%10===0;)i/=10;return a+i}var Ku=(function(){function e(n,s){var a,i=0,o=n.length;for(n=n.slice();o--;)a=n[o]*s+i,n[o]=a%Ea|0,i=a/Ea|0;return i&&n.unshift(i),n}function t(n,s,a,i){var o,l;if(a!=i)l=a>i?1:-1;else for(o=l=0;o<a;o++)if(n[o]!=s[o]){l=n[o]>s[o]?1:-1;break}return l}function r(n,s,a){for(var i=0;a--;)n[a]-=i,i=n[a]<s[a]?1:0,n[a]=i*Ea+n[a]-s[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,s,a,i){var o,l,u,d,h,g,p,x,v,w,C,k,_,N,E,P,F,A,j=n.constructor,R=n.s==s.s?1:-1,U=n.d,Y=s.d;if(!n.s)return new j(n);if(!s.s)throw Error(El+"Division by zero");for(l=n.e-s.e,F=Y.length,E=U.length,p=new j(R),x=p.d=[],u=0;Y[u]==(U[u]||0);)++u;if(Y[u]>(U[u]||0)&&--l,a==null?k=a=j.precision:i?k=a+(ta(n)-ta(s))+1:k=a,k<0)return new j(0);if(k=k/Gn+2|0,u=0,F==1)for(d=0,Y=Y[0],k++;(u<E||d)&&k--;u++)_=d*Ea+(U[u]||0),x[u]=_/Y|0,d=_%Y|0;else{for(d=Ea/(Y[0]+1)|0,d>1&&(Y=e(Y,d),U=e(U,d),F=Y.length,E=U.length),N=F,v=U.slice(0,F),w=v.length;w<F;)v[w++]=0;A=Y.slice(),A.unshift(0),P=Y[0],Y[1]>=Ea/2&&++P;do d=0,o=t(Y,v,F,w),o<0?(C=v[0],F!=w&&(C=C*Ea+(v[1]||0)),d=C/P|0,d>1?(d>=Ea&&(d=Ea-1),h=e(Y,d),g=h.length,w=v.length,o=t(h,v,g,w),o==1&&(d--,r(h,F<g?A:Y,g))):(d==0&&(o=d=1),h=Y.slice()),g=h.length,g<w&&h.unshift(0),r(v,h,w),o==-1&&(w=v.length,o=t(Y,v,F,w),o<1&&(d++,r(v,F<w?A:Y,w))),w=v.length):o===0&&(d++,v=[0]),x[u++]=d,o&&v[0]?v[w++]=U[N]||0:(v=[U[N]],w=1);while((N++<E||v[0]!==void 0)&&k--)}return x[0]||x.shift(),p.e=l,Ln(p,i?a+ta(p)+1:a)}})();function oH(e,t){var r,n,s,a,i,o,l=0,u=0,d=e.constructor,h=d.precision;if(ta(e)>16)throw Error(_A+ta(e));if(!e.s)return new d(Lo);for(as=!1,o=h,i=new d(.03125);e.abs().gte(.1);)e=e.times(i),u+=5;for(n=Math.log(Ch(2,u))/Math.LN10*2+5|0,o+=n,r=s=a=new d(Lo),d.precision=o;;){if(s=Ln(s.times(e),o),r=r.times(++l),i=a.plus(Ku(s,r,o)),zc(i.d).slice(0,o)===zc(a.d).slice(0,o)){for(;u--;)a=Ln(a.times(a),o);return d.precision=h,t==null?(as=!0,Ln(a,h)):a}a=i}}function ta(e){for(var t=e.e*Gn,r=e.d[0];r>=10;r/=10)t++;return t}function WC(e,t,r){if(t>e.LN10.sd())throw as=!0,r&&(e.precision=r),Error(El+"LN10 precision limit exceeded");return Ln(new e(e.LN10),t)}function nf(e){for(var t="";e--;)t+="0";return t}function yv(e,t){var r,n,s,a,i,o,l,u,d,h=1,g=10,p=e,x=p.d,v=p.constructor,w=v.precision;if(p.s<1)throw Error(El+(p.s?"NaN":"-Infinity"));if(p.eq(Lo))return new v(0);if(t==null?(as=!1,u=w):u=t,p.eq(10))return t==null&&(as=!0),WC(v,u);if(u+=g,v.precision=u,r=zc(x),n=r.charAt(0),a=ta(p),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=zc(p.d),n=r.charAt(0),h++;a=ta(p),n>1?(p=new v("0."+r),a++):p=new v(n+"."+r.slice(1))}else return l=WC(v,u+2,w).times(a+""),p=yv(new v(n+"."+r.slice(1)),u-g).plus(l),v.precision=w,t==null?(as=!0,Ln(p,w)):p;for(o=i=p=Ku(p.minus(Lo),p.plus(Lo),u),d=Ln(p.times(p),u),s=3;;){if(i=Ln(i.times(d),u),l=o.plus(Ku(i,new v(s),u)),zc(l.d).slice(0,u)===zc(o.d).slice(0,u))return o=o.times(2),a!==0&&(o=o.plus(WC(v,u+2,w).times(a+""))),o=Ku(o,new v(h),u),v.precision=w,t==null?(as=!0,Ln(o,w)):o;o=l,s+=2}}function dI(e,t){var r,n,s;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(s=t.length;t.charCodeAt(s-1)===48;)--s;if(t=t.slice(n,s),t){if(s-=n,r=r-n-1,e.e=sp(r/Gn),e.d=[],n=(r+1)%Gn,r<0&&(n+=Gn),n<s){for(n&&e.d.push(+t.slice(0,n)),s-=Gn;n<s;)e.d.push(+t.slice(n,n+=Gn));t=t.slice(n),n=Gn-t.length}else n-=s;for(;n--;)t+="0";if(e.d.push(+t),as&&(e.e>w_||e.e<-w_))throw Error(_A+r)}else e.s=0,e.e=0,e.d=[0];return e}function Ln(e,t,r){var n,s,a,i,o,l,u,d,h=e.d;for(i=1,a=h[0];a>=10;a/=10)i++;if(n=t-i,n<0)n+=Gn,s=t,u=h[d=0];else{if(d=Math.ceil((n+1)/Gn),a=h.length,d>=a)return e;for(u=a=h[d],i=1;a>=10;a/=10)i++;n%=Gn,s=n-Gn+i}if(r!==void 0&&(a=Ch(10,i-s-1),o=u/a%10|0,l=t<0||h[d+1]!==void 0||u%a,l=r<4?(o||l)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||l||r==6&&(n>0?s>0?u/Ch(10,i-s):0:h[d-1])%10&1||r==(e.s<0?8:7))),t<1||!h[0])return l?(a=ta(e),h.length=1,t=t-a-1,h[0]=Ch(10,(Gn-t%Gn)%Gn),e.e=sp(-t/Gn)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(n==0?(h.length=d,a=1,d--):(h.length=d+1,a=Ch(10,Gn-n),h[d]=s>0?(u/Ch(10,i-s)%Ch(10,s)|0)*a:0),l)for(;;)if(d==0){(h[0]+=a)==Ea&&(h[0]=1,++e.e);break}else{if(h[d]+=a,h[d]!=Ea)break;h[d--]=0,a=1}for(n=h.length;h[--n]===0;)h.pop();if(as&&(e.e>w_||e.e<-w_))throw Error(_A+ta(e));return e}function lH(e,t){var r,n,s,a,i,o,l,u,d,h,g=e.constructor,p=g.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new g(e),as?Ln(t,p):t;if(l=e.d,h=t.d,n=t.e,u=e.e,l=l.slice(),i=u-n,i){for(d=i<0,d?(r=l,i=-i,o=h.length):(r=h,n=u,o=l.length),s=Math.max(Math.ceil(p/Gn),o)+2,i>s&&(i=s,r.length=1),r.reverse(),s=i;s--;)r.push(0);r.reverse()}else{for(s=l.length,o=h.length,d=s<o,d&&(o=s),s=0;s<o;s++)if(l[s]!=h[s]){d=l[s]<h[s];break}i=0}for(d&&(r=l,l=h,h=r,t.s=-t.s),o=l.length,s=h.length-o;s>0;--s)l[o++]=0;for(s=h.length;s>i;){if(l[--s]<h[s]){for(a=s;a&&l[--a]===0;)l[a]=Ea-1;--l[a],l[s]+=Ea}l[s]-=h[s]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(t.d=l,t.e=n,as?Ln(t,p):t):new g(0)}function y0(e,t,r){var n,s=ta(e),a=zc(e.d),i=a.length;return t?(r&&(n=r-i)>0?a=a.charAt(0)+"."+a.slice(1)+nf(n):i>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(s<0?"e":"e+")+s):s<0?(a="0."+nf(-s-1)+a,r&&(n=r-i)>0&&(a+=nf(n))):s>=i?(a+=nf(s+1-i),r&&(n=r-s-1)>0&&(a=a+"."+nf(n))):((n=s+1)<i&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-i)>0&&(s+1===i&&(a+="."),a+=nf(n))),e.s<0?"-"+a:a}function fI(e,t){if(e.length>t)return e.length=t,!0}function cH(e){var t,r,n;function s(a){var i=this;if(!(i instanceof s))return new s(a);if(i.constructor=s,a instanceof s){i.s=a.s,i.e=a.e,i.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(Yh+a);if(a>0)i.s=1;else if(a<0)a=-a,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(a===~~a&&a<1e7){i.e=0,i.d=[a];return}return dI(i,a.toString())}else if(typeof a!="string")throw Error(Yh+a);if(a.charCodeAt(0)===45?(a=a.slice(1),i.s=-1):i.s=1,P2e.test(a))dI(i,a);else throw Error(Yh+a)}if(s.prototype=ur,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=cH,s.config=s.set=F2e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return s.config(e),s}function F2e(e){if(!e||typeof e!="object")throw Error(El+"Object expected");var t,r,n,s=["precision",1,np,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<s.length;t+=3)if((n=e[r=s[t]])!==void 0)if(sp(n)===n&&n>=s[t+1]&&n<=s[t+2])this[r]=n;else throw Error(Yh+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Yh+r+": "+n);return this}var SA=cH(j2e);Lo=new SA(1);const En=SA;var O2e=e=>e,uH={},dH=e=>e===uH,hI=e=>function t(){return arguments.length===0||arguments.length===1&&dH(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},fH=(e,t)=>e===1?t:hI(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];var a=n.filter(i=>i!==uH).length;return a>=e?t(...n):fH(e-a,hI(function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];var u=n.map(d=>dH(d)?o.shift():d);return t(...u,...o)}))}),F2=e=>fH(e.length,e),XE=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},D2e=F2((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),R2e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return O2e;var s=r.reverse(),a=s[0],i=s.slice(1);return function(){return i.reduce((o,l)=>l(o),a(...arguments))}},JE=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),hH=e=>{var t=null,r=null;return function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t&&s.every((i,o)=>{var l;return i===((l=t)===null||l===void 0?void 0:l[o])})||(t=s,r=e(...s)),r}};function gH(e){var t;return e===0?t=1:t=Math.floor(new En(e).abs().log(10).toNumber())+1,t}function mH(e,t,r){for(var n=new En(e),s=0,a=[];n.lt(t)&&s<1e5;)a.push(n.toNumber()),n=n.add(r),s++;return a}F2((e,t,r)=>{var n=+e,s=+t;return n+r*(s-n)});F2((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});F2((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var pH=e=>{var[t,r]=e,[n,s]=[t,r];return t>r&&([n,s]=[r,t]),[n,s]},xH=(e,t,r)=>{if(e.lte(0))return new En(0);var n=gH(e.toNumber()),s=new En(10).pow(n),a=e.div(s),i=n!==1?.05:.1,o=new En(Math.ceil(a.div(i).toNumber())).add(r).mul(i),l=o.mul(s);return t?new En(l.toNumber()):new En(Math.ceil(l.toNumber()))},I2e=(e,t,r)=>{var n=new En(1),s=new En(e);if(!s.isint()&&r){var a=Math.abs(e);a<1?(n=new En(10).pow(gH(e)-1),s=new En(Math.floor(s.div(n).toNumber())).mul(n)):a>1&&(s=new En(Math.floor(e)))}else e===0?s=new En(Math.floor((t-1)/2)):r||(s=new En(Math.floor(e)));var i=Math.floor((t-1)/2),o=R2e(D2e(l=>s.add(new En(l-i).mul(n)).toNumber()),XE);return o(0,t)},yH=function(t,r,n,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new En(0),tickMin:new En(0),tickMax:new En(0)};var i=xH(new En(r).sub(t).div(n-1),s,a),o;t<=0&&r>=0?o=new En(0):(o=new En(t).add(r).div(2),o=o.sub(new En(o).mod(i)));var l=Math.ceil(o.sub(t).div(i).toNumber()),u=Math.ceil(new En(r).sub(o).div(i).toNumber()),d=l+u+1;return d>n?yH(t,r,n,s,a+1):(d<n&&(u=r>0?u+(n-d):u,l=r>0?l:l+(n-d)),{step:i,tickMin:o.sub(new En(l).mul(i)),tickMax:o.add(new En(u).mul(i))})};function M2e(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(n,2),[i,o]=pH([t,r]);if(i===-1/0||o===1/0){var l=o===1/0?[i,...XE(0,n-1).map(()=>1/0)]:[...XE(0,n-1).map(()=>-1/0),o];return t>r?JE(l):l}if(i===o)return I2e(i,n,s);var{step:u,tickMin:d,tickMax:h}=yH(i,o,a,s,0),g=mH(d,h.add(new En(.1).mul(u)),u);return t>r?JE(g):g}function L2e(e,t){var[r,n]=e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[a,i]=pH([r,n]);if(a===-1/0||i===1/0)return[r,n];if(a===i)return[a];var o=Math.max(t,2),l=xH(new En(i).sub(a).div(o-1),s,0),u=[...mH(new En(a),new En(i),l),i];return s===!1&&(u=u.map(d=>Math.round(d))),r>n?JE(u):u}var B2e=hH(M2e),$2e=hH(L2e),U2e=e=>e.rootProps.barCategoryGap,O2=e=>e.rootProps.stackOffset,kA=e=>e.options.chartName,CA=e=>e.rootProps.syncId,vH=e=>e.rootProps.syncMethod,TA=e=>e.options.eventEmitter,Iu={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Po={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},D2=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},z2e={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Iu.angleAxisId,includeHidden:!1,name:void 0,reversed:Iu.reversed,scale:Iu.scale,tick:Iu.tick,tickCount:void 0,ticks:void 0,type:Iu.type,unit:void 0},W2e={allowDataOverflow:Po.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Po.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Po.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Po.scale,tick:Po.tick,tickCount:Po.tickCount,ticks:void 0,type:Po.type,unit:void 0},H2e={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Iu.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Iu.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Iu.scale,tick:Iu.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},G2e={allowDataOverflow:Po.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Po.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Po.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Po.scale,tick:Po.tick,tickCount:Po.tickCount,ticks:void 0,type:"category",unit:void 0},EA=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?H2e:z2e,NA=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?G2e:W2e,R2=e=>e.polarOptions,AA=St([cd,ud,oi],Qve),wH=St([R2,AA],(e,t)=>{if(e!=null)return Ef(e.innerRadius,t,0)}),bH=St([R2,AA],(e,t)=>{if(e!=null)return Ef(e.outerRadius,t,t*.8)}),V2e=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},_H=St([R2],V2e);St([EA,_H],D2);var SH=St([AA,wH,bH],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});St([NA,SH],D2);var kH=St([Zn,R2,wH,bH,cd,ud],(e,t,r,n,s,a)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:i,cy:o,startAngle:l,endAngle:u}=t;return{cx:Ef(i,s,s/2),cy:Ef(o,a,a/2),innerRadius:r,outerRadius:n,startAngle:l,endAngle:u,clockWise:!1}}}),ra=(e,t)=>t,I2=(e,t,r)=>r;function CH(e){return e?.id}var xa=e=>{var t=Zn(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},ap=e=>e.tooltip.settings.axisId,Ma=e=>{var t=xa(e),r=ap(e);return n1(e,t,r)},TH=St([Ma],e=>e?.dataKey);function EH(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:s,dataKey:a}=r,i=new Map;return e.forEach(o=>{var l,u=(l=o.data)!==null&&l!==void 0?l:n;if(!(u==null||u.length===0)){var d=CH(o);u.forEach((h,g)=>{var p=a==null||s?g:String(Xi(h,a,null)),x=Xi(h,o.dataKey,0),v;i.has(p)?v=i.get(p):v={},Object.assign(v,{[d]:x}),i.set(p,v)})}}),Array.from(i.values())}function jA(e){return e.stackId!=null&&e.dataKey!=null}function gI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function b_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gI(Object(r),!0).forEach(function(n){K2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function K2e(e,t,r){return(t=q2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q2e(e){var t=Y2e(e,"string");return typeof t=="symbol"?t:t+""}function Y2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QE=[0,"auto"],Ao={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},NH=(e,t)=>e.cartesianAxis.xAxis[t],fd=(e,t)=>{var r=NH(e,t);return r??Ao},jo={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:QE,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Qv},AH=(e,t)=>e.cartesianAxis.yAxis[t],hd=(e,t)=>{var r=AH(e,t);return r??jo},X2e={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},PA=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??X2e},wo=(e,t,r)=>{switch(t){case"xAxis":return fd(e,r);case"yAxis":return hd(e,r);case"zAxis":return PA(e,r);case"angleAxis":return EA(e,r);case"radiusAxis":return NA(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},J2e=(e,t,r)=>{switch(t){case"xAxis":return fd(e,r);case"yAxis":return hd(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},n1=(e,t,r)=>{switch(t){case"xAxis":return fd(e,r);case"yAxis":return hd(e,r);case"angleAxis":return EA(e,r);case"radiusAxis":return NA(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},jH=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function PH(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var FH=e=>e.graphicalItems.cartesianItems,Q2e=St([ra,I2],PH),OH=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),s1=St([FH,wo,Q2e],OH),DH=St([s1],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(jA)),RH=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),IH=St([s1],RH),MH=e=>e.map(t=>t.data).filter(Boolean).flat(1),Z2e=St([s1],MH),LH=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:s}=t;return e.length>0?e:r.slice(n,s+1)},FA=St([Z2e,bA],LH),BH=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:Xi(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(s=>({value:Xi(s,n)}))):e.map(n=>({value:n})),M2=St([FA,wo,s1],BH);function $H(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function R0(e){return e.filter(t=>Xc(t)||t instanceof Date).map(Number).filter(t=>Cl(t)===!1)}function eSe(e,t,r){return!r||typeof t!="number"||Cl(t)?[]:r.length?R0(r.flatMap(n=>{var s=Xi(e,n.dataKey),a,i;if(Array.isArray(s)?[a,i]=s:a=i=s,!(!oc(a)||!oc(i)))return[t-a,t+i]})):[]}var tSe=St([DH,bA,Ma],EH),UH=(e,t,r)=>{var n={},s=t.reduce((a,i)=>(i.stackId==null||(a[i.stackId]==null&&(a[i.stackId]=[]),a[i.stackId].push(i)),a),n);return Object.fromEntries(Object.entries(s).map(a=>{var[i,o]=a,l=o.map(CH);return[i,{stackedData:h1e(e,l,r),graphicalItems:o}]}))},rSe=St([tSe,DH,O2],UH),zH=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:s}=t;if(r!=="zAxis"){var a=p1e(e,n,s);if(!(a!=null&&a[0]===0&&a[1]===0))return a}},nSe=St([rSe,Uf,ra],zH),WH=(e,t,r,n,s)=>r.length>0?e.flatMap(a=>r.flatMap(i=>{var o,l,u=(o=n[i.id])===null||o===void 0?void 0:o.filter(h=>$H(s,h)),d=Xi(a,(l=t.dataKey)!==null&&l!==void 0?l:i.dataKey);return{value:d,errorDomain:eSe(a,d,u)}})).filter(Boolean):t?.dataKey!=null?e.map(a=>({value:Xi(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]})),L2=e=>e.errorBars,HH=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>$H(r,n));St([IH,L2,ra],HH);var sSe=St([FA,wo,IH,L2,ra],WH);function aSe(e){var{value:t}=e;if(Xc(t)||t instanceof Date)return t}var mI=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=R0(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},iSe=(e,t,r)=>{var n=e.map(aSe).filter(s=>s!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&sz(n))?kW(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},OA=e=>{var t;if(e==null||!("domain"in e))return QE;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=R0(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:QE},__=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var s=r.filter(Boolean);if(s.length!==0){var a=s.flat(),i=Math.min(...a),o=Math.max(...a);return[i,o]}},GH=e=>e.referenceElements.dots,ip=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),oSe=St([GH,ra,I2],ip),VH=e=>e.referenceElements.areas,lSe=St([VH,ra,I2],ip),KH=e=>e.referenceElements.lines,cSe=St([KH,ra,I2],ip),qH=(e,t)=>{var r=R0(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},uSe=St(oSe,ra,qH),YH=(e,t)=>{var r=R0(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},dSe=St([lSe,ra],YH),XH=(e,t)=>{var r=R0(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},fSe=St(cSe,ra,XH),hSe=St(uSe,fSe,dSe,(e,t,r)=>__(e,r,t)),gSe=St([wo],OA),JH=(e,t,r,n,s,a,i)=>{var o=N2e(t,e.allowDataOverflow);if(o!=null)return o;var l=a==="vertical"&&i==="xAxis"||a==="horizontal"&&i==="yAxis",u=l?__(r,s,mI(n)):__(s,mI(n));return A2e(t,u,e.allowDataOverflow)},mSe=St([wo,gSe,nSe,sSe,hSe,Zn,ra],JH),pSe=[0,1],QH=(e,t,r,n,s,a,i)=>{if(!((e==null||r==null||r.length===0)&&i===void 0)){var{dataKey:o,type:l}=e,u=Lf(t,a);return u&&o==null?kW(0,r.length):l==="category"?iSe(n,e,u):s==="expand"?pSe:i}},DA=St([wo,Zn,FA,M2,O2,ra,mSe],QH),ZH=(e,t,r,n,s)=>{if(e!=null){var{scale:a,type:i}=e;if(a==="auto")return t==="radial"&&s==="radiusAxis"?"band":t==="radial"&&s==="angleAxis"?"linear":i==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":i==="category"?"band":"linear";if(typeof a=="string"){var o="scale".concat(L3(a));return o in dy?o:"point"}}},a1=St([wo,Zn,jH,kA,ra],ZH);function xSe(e){if(e!=null){if(e in dy)return dy[e]();var t="scale".concat(L3(e));if(t in dy)return dy[t]()}}function RA(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var s=xSe(t);if(s!=null){var a=s.domain(r).range(n);return c1e(a),a}}}var eG=(e,t,r)=>{var n=OA(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Pm(e))return B2e(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Pm(e))return $2e(e,t.tickCount,t.allowDecimals)}},IA=St([DA,n1,a1],eG),tG=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&Pm(t)&&Array.isArray(r)&&r.length>0){var s=t[0],a=r[0],i=t[1],o=r[r.length-1];return[Math.min(s,a),Math.max(i,o)]}return t},ySe=St([wo,DA,IA,ra],tG),vSe=St(M2,wo,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(R0(e.map(o=>o.value))).sort((o,l)=>o-l);if(n.length<2)return 1/0;var s=n[n.length-1]-n[0];if(s===0)return 1/0;for(var a=0;a<n.length-1;a++){var i=n[a+1]-n[a];r=Math.min(r,i)}return r/s}}),rG=St(vSe,Zn,U2e,oi,(e,t,r,n)=>n,(e,t,r,n,s)=>{if(!oc(e))return 0;var a=t==="vertical"?n.height:n.width;if(s==="gap")return e*a/2;if(s==="no-gap"){var i=Ef(r,e*a),o=e*a/2;return o-i-(o-i)/a*i}return 0}),wSe=(e,t)=>{var r=fd(e,t);return r==null||typeof r.padding!="string"?0:rG(e,"xAxis",t,r.padding)},bSe=(e,t)=>{var r=hd(e,t);return r==null||typeof r.padding!="string"?0:rG(e,"yAxis",t,r.padding)},_Se=St(fd,wSe,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:s}=e;return typeof s=="string"?{left:t,right:t}:{left:((r=s.left)!==null&&r!==void 0?r:0)+t,right:((n=s.right)!==null&&n!==void 0?n:0)+t}}),SSe=St(hd,bSe,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:s}=e;return typeof s=="string"?{top:t,bottom:t}:{top:((r=s.top)!==null&&r!==void 0?r:0)+t,bottom:((n=s.bottom)!==null&&n!==void 0?n:0)+t}}),kSe=St([oi,_Se,C2,k2,(e,t,r)=>r],(e,t,r,n,s)=>{var{padding:a}=n;return s?[a.left,r.width-a.right]:[e.left+t.left,e.left+e.width-t.right]}),CSe=St([oi,Zn,SSe,C2,k2,(e,t,r)=>r],(e,t,r,n,s,a)=>{var{padding:i}=s;return a?[n.height-i.bottom,i.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),i1=(e,t,r,n)=>{var s;switch(t){case"xAxis":return kSe(e,r,n);case"yAxis":return CSe(e,r,n);case"zAxis":return(s=PA(e,r))===null||s===void 0?void 0:s.range;case"angleAxis":return _H(e);case"radiusAxis":return SH(e,r);default:return}},nG=St([wo,i1],D2),op=St([wo,a1,ySe,nG],RA);St([s1,L2,ra],HH);function sG(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var B2=(e,t)=>t,$2=(e,t,r)=>r,TSe=St(_2,B2,$2,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(sG)),ESe=St(S2,B2,$2,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(sG)),aG=(e,t)=>({width:e.width,height:t.height}),NSe=(e,t)=>{var r=typeof t.width=="number"?t.width:Qv;return{width:r,height:e.height}},ASe=St(oi,fd,aG),jSe=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},PSe=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},FSe=St(ud,oi,TSe,B2,$2,(e,t,r,n,s)=>{var a={},i;return r.forEach(o=>{var l=aG(t,o);i==null&&(i=jSe(t,n,e));var u=n==="top"&&!s||n==="bottom"&&s;a[o.id]=i-Number(u)*l.height,i+=(u?-1:1)*l.height}),a}),OSe=St(cd,oi,ESe,B2,$2,(e,t,r,n,s)=>{var a={},i;return r.forEach(o=>{var l=NSe(t,o);i==null&&(i=PSe(t,n,e));var u=n==="left"&&!s||n==="right"&&s;a[o.id]=i-Number(u)*l.width,i+=(u?-1:1)*l.width}),a}),DSe=(e,t)=>{var r=fd(e,t);if(r!=null)return FSe(e,r.orientation,r.mirror)},RSe=St([oi,fd,DSe,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var s=r?.[n];return s==null?{x:e.left,y:0}:{x:e.left,y:s}}}),ISe=(e,t)=>{var r=hd(e,t);if(r!=null)return OSe(e,r.orientation,r.mirror)},MSe=St([oi,hd,ISe,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var s=r?.[n];return s==null?{x:0,y:e.top}:{x:s,y:e.top}}}),LSe=St(oi,hd,(e,t)=>{var r=typeof t.width=="number"?t.width:Qv;return{width:r,height:e.height}}),iG=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:s,type:a,dataKey:i}=r,o=Lf(e,n),l=t.map(u=>u.value);if(i&&o&&a==="category"&&s&&sz(l))return l}},MA=St([Zn,M2,wo,ra],iG),oG=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:s,scale:a}=r,i=Lf(e,n);if(i&&(s==="number"||a!=="auto"))return t.map(o=>o.value)}},LA=St([Zn,M2,n1,ra],oG),pI=St([Zn,J2e,a1,op,MA,LA,i1,IA,ra],(e,t,r,n,s,a,i,o,l)=>{if(t==null)return null;var u=Lf(e,l);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:l,categoricalDomain:a,duplicateDomain:s,isCategorical:u,niceTicks:o,range:i,realScaleType:r,scale:n}}),BSe=(e,t,r,n,s,a,i,o,l)=>{if(!(t==null||n==null)){var u=Lf(e,l),{type:d,ticks:h,tickCount:g}=t,p=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,x=d==="category"&&n.bandwidth?n.bandwidth()/p:0;x=l==="angleAxis"&&a!=null&&a.length>=2?yl(a[0]-a[1])*2*x:x;var v=h||s;if(v){var w=v.map((C,k)=>{var _=i?i.indexOf(C):C;return{index:k,coordinate:n(_)+x,value:C,offset:x}});return w.filter(C=>!Cl(C.coordinate))}return u&&o?o.map((C,k)=>({coordinate:n(C)+x,value:C,index:k,offset:x})):n.ticks?n.ticks(g).map(C=>({coordinate:n(C)+x,value:C,offset:x})):n.domain().map((C,k)=>({coordinate:n(C)+x,value:i?i[C]:C,index:k,offset:x}))}},lG=St([Zn,n1,a1,op,IA,i1,MA,LA,ra],BSe),$Se=(e,t,r,n,s,a,i)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var o=Lf(e,i),{tickCount:l}=t,u=0;return u=i==="angleAxis"&&n?.length>=2?yl(n[0]-n[1])*2*u:u,o&&a?a.map((d,h)=>({coordinate:r(d)+u,value:d,index:h,offset:u})):r.ticks?r.ticks(l).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,h)=>({coordinate:r(d)+u,value:s?s[d]:d,index:h,offset:u}))}},cG=St([Zn,n1,op,i1,MA,LA,ra],$Se),uG=St(wo,op,(e,t)=>{if(!(e==null||t==null))return b_(b_({},e),{},{scale:t})}),USe=St([wo,a1,DA,nG],RA);St((e,t,r)=>PA(e,r),USe,(e,t)=>{if(!(e==null||t==null))return b_(b_({},e),{},{scale:t})});var zSe=St([Zn,_2,S2],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),dG=e=>e.options.defaultTooltipEventType,fG=e=>e.options.validateTooltipEventTypes;function hG(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function BA(e,t){var r=dG(e),n=fG(e);return hG(t,r,n)}function WSe(e){return Tr(t=>BA(t,e))}var gG=(e,t)=>{var r,n=Number(t);if(!(Cl(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},HSe=e=>e.tooltip.settings,af={active:!1,index:null,dataKey:void 0,coordinate:void 0},GSe={itemInteraction:{click:af,hover:af},axisInteraction:{click:af,hover:af},keyboardInteraction:af,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},mG=Ho({name:"tooltip",initialState:GSe,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=Vu(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:VSe,removeTooltipEntrySettings:KSe,setTooltipSettingsState:qSe,setActiveMouseOverItemIndex:YSe,mouseLeaveItem:U3e,mouseLeaveChart:pG,setActiveClickItemIndex:z3e,setMouseOverAxisIndex:xG,setMouseClickAxisIndex:XSe,setSyncInteraction:ZE,setKeyboardInteraction:eN}=mG.actions,JSe=mG.reducer;function xI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function qw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xI(Object(r),!0).forEach(function(n){QSe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QSe(e,t,r){return(t=ZSe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZSe(e){var t=eke(e,"string");return typeof t=="symbol"?t:t+""}function eke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tke(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function rke(e){return e.index!=null}var yG=(e,t,r,n)=>{if(t==null)return af;var s=tke(e,t,r);if(s==null)return af;if(s.active)return s;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var a=e.settings.active===!0;if(rke(s)){if(a)return qw(qw({},s),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return qw(qw({},af),{},{coordinate:s.coordinate})},$A=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!oc(n))return r;var s=0,a=1/0;return t.length>0&&(a=t.length-1),String(Math.max(s,Math.min(n,a)))},vG=(e,t,r,n,s,a,i,o)=>{if(!(a==null||o==null)){var l=i[0],u=l==null?void 0:o(l.positions,a);if(u!=null)return u;var d=s?.[Number(a)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}},wG=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var s;return r==="hover"?s=e.itemInteraction.hover.dataKey:s=e.itemInteraction.click.dataKey,s==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(a=>{var i;return((i=a.settings)===null||i===void 0?void 0:i.dataKey)===s})},o1=e=>e.options.tooltipPayloadSearcher,lp=e=>e.tooltip;function yI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function vI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yI(Object(r),!0).forEach(function(n){nke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nke(e,t,r){return(t=ske(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ske(e){var t=ake(e,"string");return typeof t=="symbol"?t:t+""}function ake(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ike(e,t){return e??t}var bG=(e,t,r,n,s,a,i)=>{if(!(t==null||a==null)){var{chartData:o,computedData:l,dataStartIndex:u,dataEndIndex:d}=r,h=[];return e.reduce((g,p)=>{var x,{dataDefinedOnItem:v,settings:w}=p,C=ike(v,o),k=Array.isArray(C)?aW(C,u,d):C,_=(x=w?.dataKey)!==null&&x!==void 0?x:n,N=w?.nameKey,E;if(n&&Array.isArray(k)&&!Array.isArray(k[0])&&i==="axis"?E=az(k,n,s):E=a(k,t,l,N),Array.isArray(E))E.forEach(F=>{var A=vI(vI({},w),{},{name:F.name,unit:F.unit,color:void 0,fill:void 0});g.push(sR({tooltipEntrySettings:A,dataKey:F.dataKey,payload:F.payload,value:Xi(F.payload,F.dataKey),name:F.name}))});else{var P;g.push(sR({tooltipEntrySettings:w,dataKey:_,payload:E,value:Xi(E,_),name:(P=Xi(E,N))!==null&&P!==void 0?P:w?.name}))}return g},h)}},UA=St([Ma,Zn,jH,kA,xa],ZH),oke=St([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),lke=St([xa,ap],PH),l1=St([oke,Ma,lke],OH),cke=St([l1],e=>e.filter(jA)),uke=St([l1],MH),cp=St([uke,Uf],LH),dke=St([cke,Uf,Ma],EH),zA=St([cp,Ma,l1],BH),fke=St([Ma],OA),hke=St([l1],e=>e.filter(jA)),gke=St([dke,hke,O2],UH),mke=St([gke,Uf,xa],zH),pke=St([l1],RH),xke=St([cp,Ma,pke,L2,xa],WH),yke=St([GH,xa,ap],ip),vke=St([yke,xa],qH),wke=St([VH,xa,ap],ip),bke=St([wke,xa],YH),_ke=St([KH,xa,ap],ip),Ske=St([_ke,xa],XH),kke=St([vke,Ske,bke],__),Cke=St([Ma,fke,mke,xke,kke,Zn,xa],JH),_G=St([Ma,Zn,cp,zA,O2,xa,Cke],QH),Tke=St([_G,Ma,UA],eG),Eke=St([Ma,_G,Tke,xa],tG),SG=e=>{var t=xa(e),r=ap(e),n=!1;return i1(e,t,r,n)},kG=St([Ma,SG],D2),CG=St([Ma,UA,Eke,kG],RA),Nke=St([Zn,zA,Ma,xa],iG),Ake=St([Zn,zA,Ma,xa],oG),jke=(e,t,r,n,s,a,i,o)=>{if(t){var{type:l}=t,u=Lf(e,o);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,h=l==="category"&&n.bandwidth?n.bandwidth()/d:0;return h=o==="angleAxis"&&s!=null&&s?.length>=2?yl(s[0]-s[1])*2*h:h,u&&i?i.map((g,p)=>({coordinate:n(g)+h,value:g,index:p,offset:h})):n.domain().map((g,p)=>({coordinate:n(g)+h,value:a?a[g]:g,index:p,offset:h}))}}},gd=St([Zn,Ma,UA,CG,SG,Nke,Ake,xa],jke),WA=St([dG,fG,HSe],(e,t,r)=>hG(r.shared,e,t)),TG=e=>e.tooltip.settings.trigger,HA=e=>e.tooltip.settings.defaultIndex,U2=St([lp,WA,TG,HA],yG),vv=St([U2,cp],$A),EG=St([gd,vv],gG),Pke=St([U2],e=>{if(e)return e.dataKey}),NG=St([lp,WA,TG,HA],wG),Fke=St([cd,ud,Zn,oi,gd,HA,NG,o1],vG),Oke=St([U2,Fke],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Dke=St([U2],e=>e.active),Rke=St([NG,vv,Uf,TH,EG,o1,WA],bG),Ike=St([Rke],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function wI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function bI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wI(Object(r),!0).forEach(function(n){Mke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mke(e,t,r){return(t=Lke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lke(e){var t=Bke(e,"string");return typeof t=="symbol"?t:t+""}function Bke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $ke=()=>Tr(Ma),Uke=()=>{var e=$ke(),t=Tr(gd),r=Tr(CG);return IE(bI(bI({},e),{},{scale:r}),t)},zke=()=>Tr(kA),GA=(e,t)=>t,AG=(e,t,r)=>r,VA=(e,t,r,n)=>n,Wke=St(gd,e=>p2(e,t=>t.coordinate)),KA=St([lp,GA,AG,VA],yG),jG=St([KA,cp],$A),Hke=(e,t,r)=>{if(t!=null){var n=lp(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},PG=St([lp,GA,AG,VA],wG),S_=St([cd,ud,Zn,oi,gd,VA,PG,o1],vG),Gke=St([KA,S_],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),FG=St(gd,jG,gG),Vke=St([PG,jG,Uf,TH,FG,o1,GA],bG),Kke=St([KA],e=>({isActive:e.active,activeIndex:e.index})),qke=(e,t,r,n,s,a,i,o)=>{if(!(!e||!t||!n||!s||!a)){var l=x1e(e.chartX,e.chartY,t,r,o);if(l){var u=v1e(l,t),d=o1e(u,i,a,n,s),h=y1e(t,a,d,l);return{activeIndex:String(d),activeCoordinate:h}}}};function tN(){return tN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tN.apply(null,arguments)}function _I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Yw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_I(Object(r),!0).forEach(function(n){Yke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_I(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yke(e,t,r){return(t=Xke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xke(e){var t=Jke(e,"string");return typeof t=="symbol"?t:t+""}function Jke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qke(e){var{coordinate:t,payload:r,index:n,offset:s,tooltipAxisBandSize:a,layout:i,cursor:o,tooltipEventType:l,chartName:u}=e,d=t,h=r,g=n;if(!o||!d||u!=="ScatterChart"&&l!=="axis")return null;var p,x;if(u==="ScatterChart")p=d,x=uwe;else if(u==="BarChart")p=dwe(i,d,s,a),x=zwe;else if(i==="radial"){var{cx:v,cy:w,radius:C,startAngle:k,endAngle:_}=_W(d);p={cx:v,cy:w,startAngle:k,endAngle:_,innerRadius:C,outerRadius:C},x=Vwe}else p={points:Kwe(i,d,s)},x=pW;var N=typeof o=="object"&&"className"in o?o.className:void 0,E=Yw(Yw(Yw(Yw({stroke:"#ccc",pointerEvents:"none"},s),p),ii(o,!1)),{},{payload:h,payloadIndex:g,className:Jn("recharts-tooltip-cursor",N)});return S.isValidElement(o)?S.cloneElement(o,E):S.createElement(x,E)}function Zke(e){var t=Uke(),r=dW(),n=J3(),s=zke();return S.createElement(Qke,tN({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:s}))}var OG=S.createContext(null),eCe=()=>S.useContext(OG),HC={exports:{}},SI;function tCe(){return SI||(SI=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(l,u,d){this.fn=l,this.context=u,this.once=d||!1}function a(l,u,d,h,g){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new s(d,h||l,g),x=r?r+u:u;return l._events[x]?l._events[x].fn?l._events[x]=[l._events[x],p]:l._events[x].push(p):(l._events[x]=p,l._eventsCount++),l}function i(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,h;if(this._eventsCount===0)return u;for(h in d=this._events)t.call(d,h)&&u.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=r?r+u:u,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var g=0,p=h.length,x=new Array(p);g<p;g++)x[g]=h[g].fn;return x},o.prototype.listenerCount=function(u){var d=r?r+u:u,h=this._events[d];return h?h.fn?1:h.length:0},o.prototype.emit=function(u,d,h,g,p,x){var v=r?r+u:u;if(!this._events[v])return!1;var w=this._events[v],C=arguments.length,k,_;if(w.fn){switch(w.once&&this.removeListener(u,w.fn,void 0,!0),C){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,d),!0;case 3:return w.fn.call(w.context,d,h),!0;case 4:return w.fn.call(w.context,d,h,g),!0;case 5:return w.fn.call(w.context,d,h,g,p),!0;case 6:return w.fn.call(w.context,d,h,g,p,x),!0}for(_=1,k=new Array(C-1);_<C;_++)k[_-1]=arguments[_];w.fn.apply(w.context,k)}else{var N=w.length,E;for(_=0;_<N;_++)switch(w[_].once&&this.removeListener(u,w[_].fn,void 0,!0),C){case 1:w[_].fn.call(w[_].context);break;case 2:w[_].fn.call(w[_].context,d);break;case 3:w[_].fn.call(w[_].context,d,h);break;case 4:w[_].fn.call(w[_].context,d,h,g);break;default:if(!k)for(E=1,k=new Array(C-1);E<C;E++)k[E-1]=arguments[E];w[_].fn.apply(w[_].context,k)}}return!0},o.prototype.on=function(u,d,h){return a(this,u,d,h,!1)},o.prototype.once=function(u,d,h){return a(this,u,d,h,!0)},o.prototype.removeListener=function(u,d,h,g){var p=r?r+u:u;if(!this._events[p])return this;if(!d)return i(this,p),this;var x=this._events[p];if(x.fn)x.fn===d&&(!g||x.once)&&(!h||x.context===h)&&i(this,p);else{for(var v=0,w=[],C=x.length;v<C;v++)(x[v].fn!==d||g&&!x[v].once||h&&x[v].context!==h)&&w.push(x[v]);w.length?this._events[p]=w.length===1?w[0]:w:i(this,p)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&i(this,d)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(HC)),HC.exports}var rCe=tCe();const nCe=Nl(rCe);var wv=new nCe,rN="recharts.syncEvent.tooltip",kI="recharts.syncEvent.brush";function sCe(e,t){if(t){var r=Number.parseInt(t,10);if(!Cl(r))return e?.[r]}}var aCe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},DG=Ho({name:"options",initialState:aCe,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),iCe=DG.reducer,{createEventEmitter:oCe}=DG.actions;function lCe(e){return e.tooltip.syncInteraction}var cCe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},RG=Ho({name:"chartData",initialState:cCe,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:CI,setDataStartEndIndexes:uCe,setComputedData:W3e}=RG.actions,dCe=RG.reducer,fCe=["x","y"];function TI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function bh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TI(Object(r),!0).forEach(function(n){hCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hCe(e,t,r){return(t=gCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gCe(e){var t=mCe(e,"string");return typeof t=="symbol"?t:t+""}function mCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pCe(e,t){if(e==null)return{};var r,n,s=xCe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function xCe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var IG=()=>{};function yCe(){var e=Tr(CA),t=Tr(TA),r=Qi(),n=Tr(vH),s=Tr(gd),a=J3(),i=X3(),o=Tr(l=>l.rootProps.className);S.useEffect(()=>{if(e==null)return IG;var l=(u,d,h)=>{if(t!==h&&e===u){if(n==="index"){var g;if(i&&d!==null&&d!==void 0&&(g=d.payload)!==null&&g!==void 0&&g.coordinate){var p=d.payload.coordinate,{x,y:v}=p,w=pCe(p,fCe),C=bh(bh(bh({},w),typeof x=="number"&&{x:Math.max(i.x,Math.min(x,i.x+i.width))}),typeof v=="number"&&{y:Math.max(i.y,Math.min(v,i.y+i.height))}),k=bh(bh({},d),{},{payload:bh(bh({},d.payload),{},{coordinate:C})});r(k)}else r(d);return}if(s!=null){var _;if(typeof n=="function"){var N={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},E=n(s,N);_=s[E]}else n==="value"&&(_=s.find(Z=>String(Z.value)===d.payload.label));var{coordinate:P}=d.payload;if(_==null||d.payload.active===!1||P==null||i==null){r(ZE({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:F,y:A}=P,j=Math.min(F,i.x+i.width),R=Math.min(A,i.y+i.height),U={x:a==="horizontal"?_.coordinate:j,y:a==="horizontal"?R:_.coordinate},Y=ZE({active:d.payload.active,coordinate:U,dataKey:d.payload.dataKey,index:String(_.index),label:d.payload.label});r(Y)}}};return wv.on(rN,l),()=>{wv.off(rN,l)}},[o,r,t,e,n,s,a,i])}function vCe(){var e=Tr(CA),t=Tr(TA),r=Qi();S.useEffect(()=>{if(e==null)return IG;var n=(s,a,i)=>{t!==i&&e===s&&r(uCe(a))};return wv.on(kI,n),()=>{wv.off(kI,n)}},[r,t,e])}function wCe(){var e=Qi();S.useEffect(()=>{e(oCe())},[e]),yCe(),vCe()}function bCe(e,t,r,n,s,a){var i=Tr(g=>Hke(g,e,t)),o=Tr(TA),l=Tr(CA),u=Tr(vH),d=Tr(lCe),h=d?.active;S.useEffect(()=>{if(!h&&l!=null&&o!=null){var g=ZE({active:a,coordinate:r,dataKey:i,index:s,label:typeof n=="number"?String(n):n});wv.emit(rN,l,g,o)}},[h,r,i,s,n,o,l,u,a])}function EI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function NI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EI(Object(r),!0).forEach(function(n){_Ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Ce(e,t,r){return(t=SCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SCe(e){var t=kCe(e,"string");return typeof t=="symbol"?t:t+""}function kCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CCe(e){return e.dataKey}function TCe(e,t){return S.isValidElement(e)?S.cloneElement(e,t):typeof e=="function"?S.createElement(e,t):S.createElement(z1e,t)}var AI=[],ECe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!tp.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function NCe(e){var t=Pl(e,ECe),{active:r,allowEscapeViewBox:n,animationDuration:s,animationEasing:a,content:i,filterNull:o,isAnimationActive:l,offset:u,payloadUniqBy:d,position:h,reverseDirection:g,useTranslate3d:p,wrapperStyle:x,cursor:v,shared:w,trigger:C,defaultIndex:k,portal:_,axisId:N}=t,E=Qi(),P=typeof k=="number"?String(k):k;S.useEffect(()=>{E(qSe({shared:w,trigger:C,axisId:N,active:r,defaultIndex:P}))},[E,w,C,N,r,P]);var F=X3(),A=mW(),j=WSe(w),{activeIndex:R,isActive:U}=Tr(J=>Kke(J,j,C,P)),Y=Tr(J=>Vke(J,j,C,P)),Z=Tr(J=>FG(J,j,C,P)),ae=Tr(J=>Gke(J,j,C,P)),ee=Y,ne=eCe(),L=r??U,[H,M]=Xye([ee,L]),V=j==="axis"?Z:void 0;bCe(j,C,ae,V,R,L);var W=_??ne;if(W==null)return null;var I=ee??AI;L||(I=AI),o&&I.length&&(I=_ye(ee.filter(J=>J.value!=null&&(J.hide!==!0||t.includeHidden)),d,CCe));var B=I.length>0,q=S.createElement(Y1e,{allowEscapeViewBox:n,animationDuration:s,animationEasing:a,isAnimationActive:l,active:L,coordinate:ae,hasPayload:B,offset:u,position:h,reverseDirection:g,useTranslate3d:p,viewBox:F,wrapperStyle:x,lastBoundingBox:H,innerRef:M,hasPortalFromProps:!!_},TCe(i,NI(NI({},t),{},{payload:I,label:V,active:L,coordinate:ae,accessibilityLayer:A})));return S.createElement(S.Fragment,null,aT.createPortal(q,W),L&&S.createElement(Zke,{cursor:v,tooltipEventType:j,coordinate:ae,payload:ee,index:R}))}var GC={},VC={},KC={},jI;function ACe(){return jI||(jI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:s,edges:a}={}){let i,o=null;const l=a!=null&&a.includes("leading"),u=a==null||a.includes("trailing"),d=()=>{o!==null&&(r.apply(i,o),i=void 0,o=null)},h=()=>{u&&d(),v()};let g=null;const p=()=>{g!=null&&clearTimeout(g),g=setTimeout(()=>{g=null,h()},n)},x=()=>{g!==null&&(clearTimeout(g),g=null)},v=()=>{x(),i=void 0,o=null},w=()=>{d()},C=function(...k){if(s?.aborted)return;i=this,o=k;const _=g==null;p(),l&&_&&d()};return C.schedule=p,C.cancel=v,C.flush=w,s?.addEventListener("abort",v,{once:!0}),C}e.debounce=t})(KC)),KC}var PI;function jCe(){return PI||(PI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ACe();function r(n,s=0,a={}){typeof a!="object"&&(a={});const{leading:i=!1,trailing:o=!0,maxWait:l}=a,u=Array(2);i&&(u[0]="leading"),o&&(u[1]="trailing");let d,h=null;const g=t.debounce(function(...v){d=n.apply(this,v),h=null},s,{edges:u}),p=function(...v){return l!=null&&(h===null&&(h=Date.now()),Date.now()-h>=l)?(d=n.apply(this,v),h=Date.now(),g.cancel(),g.schedule(),d):(g.apply(this,v),d)},x=()=>(g.flush(),d);return p.cancel=g.cancel,p.flush=x,p}e.debounce=r})(VC)),VC}var FI;function PCe(){return FI||(FI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jCe();function r(n,s=0,a={}){const{leading:i=!0,trailing:o=!0}=a;return t.debounce(n,s,{leading:i,maxWait:s,trailing:o})}e.throttle=r})(GC)),GC}var qC,OI;function FCe(){return OI||(OI=1,qC=PCe().throttle),qC}var OCe=FCe();const DCe=Nl(OCe);var jy=function(t,r){for(var n=arguments.length,s=new Array(n>2?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a]};function DI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function YC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DI(Object(r),!0).forEach(function(n){RCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RCe(e,t,r){return(t=ICe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ICe(e){var t=MCe(e,"string");return typeof t=="symbol"?t:t+""}function MCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LCe=S.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:s="100%",height:a="100%",minWidth:i=0,minHeight:o,maxHeight:l,children:u,debounce:d=0,id:h,className:g,onResize:p,style:x={}}=e,v=S.useRef(null),w=S.useRef();w.current=p,S.useImperativeHandle(t,()=>v.current);var[C,k]=S.useState({containerWidth:n.width,containerHeight:n.height}),_=S.useCallback((E,P)=>{k(F=>{var A=Math.round(E),j=Math.round(P);return F.containerWidth===A&&F.containerHeight===j?F:{containerWidth:A,containerHeight:j}})},[]);S.useEffect(()=>{var E=j=>{var R,{width:U,height:Y}=j[0].contentRect;_(U,Y),(R=w.current)===null||R===void 0||R.call(w,U,Y)};d>0&&(E=DCe(E,d,{trailing:!0,leading:!1}));var P=new ResizeObserver(E),{width:F,height:A}=v.current.getBoundingClientRect();return _(F,A),P.observe(v.current),()=>{P.disconnect()}},[_,d]);var N=S.useMemo(()=>{var{containerWidth:E,containerHeight:P}=C;if(E<0||P<0)return null;jy(Fh(s)||Fh(a),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,a),jy(!r||r>0,"The aspect(%s) must be greater than zero.",r);var F=Fh(s)?E:s,A=Fh(a)?P:a;return r&&r>0&&(F?A=F/r:A&&(F=A*r),l&&A>l&&(A=l)),jy(F>0||A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,F,A,s,a,i,o,r),S.Children.map(u,j=>S.cloneElement(j,{width:F,height:A,style:YC({width:F,height:A},j.props.style)}))},[r,u,a,l,o,i,C,s]);return S.createElement("div",{id:h?"".concat(h):void 0,className:Jn("recharts-responsive-container",g),style:YC(YC({},x),{},{width:s,height:a,minWidth:i,minHeight:o,maxHeight:l}),ref:v},S.createElement("div",{style:{width:0,height:0,overflow:"visible"}},N))});function BCe(e,t,r){return(t=$Ce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Ce(e){var t=UCe(e,"string");return typeof t=="symbol"?t:t+""}function UCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class zCe{constructor(t){BCe(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function RI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function WCe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RI(Object(r),!0).forEach(function(n){HCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HCe(e,t,r){return(t=GCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GCe(e){var t=VCe(e,"string");return typeof t=="symbol"?t:t+""}function VCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KCe={cacheSize:2e3,enableCache:!0},MG=WCe({},KCe),II=new zCe(MG.cacheSize),qCe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},MI="recharts_measurement_span";function YCe(e,t){var r=t.fontSize||"",n=t.fontFamily||"",s=t.fontWeight||"",a=t.fontStyle||"",i=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(s,"|").concat(a,"|").concat(i,"|").concat(o)}var LI=(e,t)=>{try{var r=document.getElementById(MI);r||(r=document.createElement("span"),r.setAttribute("id",MI),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,qCe,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Py=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||tp.isSsr)return{width:0,height:0};if(!MG.enableCache)return LI(t,r);var n=YCe(t,r),s=II.get(n);if(s)return s;var a=LI(t,r);return II.set(n,a),a},BI=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,$I=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,XCe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,JCe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,LG={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},QCe=Object.keys(LG),em="NaN";function ZCe(e,t){return e*LG[t]}class uo{static parse(t){var r,[,n,s]=(r=JCe.exec(t))!==null&&r!==void 0?r:[];return new uo(parseFloat(n),s??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Cl(t)&&(this.unit=""),r!==""&&!XCe.test(r)&&(this.num=NaN,this.unit=""),QCe.includes(r)&&(this.num=ZCe(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new uo(NaN,""):new uo(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new uo(NaN,""):new uo(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new uo(NaN,""):new uo(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new uo(NaN,""):new uo(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Cl(this.num)}}function BG(e){if(e.includes(em))return em;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,s,a]=(r=BI.exec(t))!==null&&r!==void 0?r:[],i=uo.parse(n??""),o=uo.parse(a??""),l=s==="*"?i.multiply(o):i.divide(o);if(l.isNaN())return em;t=t.replace(BI,l.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,h,g]=(u=$I.exec(t))!==null&&u!==void 0?u:[],p=uo.parse(d??""),x=uo.parse(g??""),v=h==="+"?p.add(x):p.subtract(x);if(v.isNaN())return em;t=t.replace($I,v.toString())}return t}var UI=/\(([^()]*)\)/;function eTe(e){for(var t=e,r;(r=UI.exec(t))!=null;){var[,n]=r;t=t.replace(UI,BG(n))}return t}function tTe(e){var t=e.replace(/\s+/g,"");return t=eTe(t),t=BG(t),t}function rTe(e){try{return tTe(e)}catch{return em}}function XC(e){var t=rTe(e.slice(5,-1));return t===em?"":t}var nTe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],sTe=["dx","dy","angle","className","breakAll"];function nN(){return nN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nN.apply(null,arguments)}function zI(e,t){if(e==null)return{};var r,n,s=aTe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function aTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var $G=/[ \f\n\r\t\v\u2028\u2029]+/,UG=e=>{var{children:t,breakAll:r,style:n}=e;try{var s=[];Oa(t)||(r?s=t.toString().split(""):s=t.toString().split($G));var a=s.map(o=>({word:o,width:Py(o,n).width})),i=r?0:Py("",n).width;return{wordsWithComputedWidth:a,spaceWidth:i}}catch{return null}},iTe=(e,t,r,n,s)=>{var{maxLines:a,children:i,style:o,breakAll:l}=e,u=Ir(a),d=i,h=function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return U.reduce((Y,Z)=>{var{word:ae,width:ee}=Z,ne=Y[Y.length-1];if(ne&&(n==null||s||ne.width+ee+r<Number(n)))ne.words.push(ae),ne.width+=ee+r;else{var L={words:[ae],width:ee};Y.push(L)}return Y},[])},g=h(t),p=R=>R.reduce((U,Y)=>U.width>Y.width?U:Y);if(!u||s)return g;var x=g.length>a||p(g).width>Number(n);if(!x)return g;for(var v="",w=R=>{var U=d.slice(0,R),Y=UG({breakAll:l,style:o,children:U+v}).wordsWithComputedWidth,Z=h(Y),ae=Z.length>a||p(Z).width>Number(n);return[ae,Z]},C=0,k=d.length-1,_=0,N;C<=k&&_<=d.length-1;){var E=Math.floor((C+k)/2),P=E-1,[F,A]=w(P),[j]=w(E);if(!F&&!j&&(C=E+1),F&&j&&(k=E-1),!F&&j){N=A;break}_++}return N||g},WI=e=>{var t=Oa(e)?[]:e.toString().split($G);return[{words:t}]},oTe=e=>{var{width:t,scaleToFit:r,children:n,style:s,breakAll:a,maxLines:i}=e;if((t||r)&&!tp.isSsr){var o,l,u=UG({breakAll:a,children:n,style:s});if(u){var{wordsWithComputedWidth:d,spaceWidth:h}=u;o=d,l=h}else return WI(n);return iTe({breakAll:a,children:n,maxLines:i,style:s},o,l,t,r)}return WI(n)},HI="#808080",qA=S.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:s="1em",capHeight:a="0.71em",scaleToFit:i=!1,textAnchor:o="start",verticalAnchor:l="end",fill:u=HI}=e,d=zI(e,nTe),h=S.useMemo(()=>oTe({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:i,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,i,d.style,d.width]),{dx:g,dy:p,angle:x,className:v,breakAll:w}=d,C=zI(d,sTe);if(!Xc(r)||!Xc(n)||h.length===0)return null;var k=r+(Ir(g)?g:0),_=n+(Ir(p)?p:0),N;switch(l){case"start":N=XC("calc(".concat(a,")"));break;case"middle":N=XC("calc(".concat((h.length-1)/2," * -").concat(s," + (").concat(a," / 2))"));break;default:N=XC("calc(".concat(h.length-1," * -").concat(s,")"));break}var E=[];if(i){var P=h[0].width,{width:F}=d;E.push("scale(".concat(Ir(F)?F/P:1,")"))}return x&&E.push("rotate(".concat(x,", ").concat(k,", ").concat(_,")")),E.length&&(C.transform=E.join(" ")),S.createElement("text",nN({},ii(C,!0),{ref:t,x:k,y:_,className:Jn("recharts-text",v),textAnchor:o,fill:u.includes("url")?HI:u}),h.map((A,j)=>{var R=A.words.join(w?"":" ");return S.createElement("tspan",{x:k,dy:j===0?N:s,key:"".concat(R,"-").concat(j)},R)}))});qA.displayName="Text";var lTe=["labelRef"];function cTe(e,t){if(e==null)return{};var r,n,s=uTe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function uTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function GI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Bs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GI(Object(r),!0).forEach(function(n){dTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dTe(e,t,r){return(t=fTe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fTe(e){var t=hTe(e,"string");return typeof t=="symbol"?t:t+""}function hTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mu(){return Mu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mu.apply(null,arguments)}var zG=S.createContext(null),gTe=e=>{var{x:t,y:r,width:n,height:s,children:a}=e,i=S.useMemo(()=>({x:t,y:r,width:n,height:s}),[t,r,n,s]);return S.createElement(zG.Provider,{value:i},a)},WG=()=>{var e=S.useContext(zG),t=X3();return e||t},mTe=S.createContext(null),pTe=()=>{var e=S.useContext(mTe),t=Tr(kH);return e||t},xTe=e=>{var{value:t,formatter:r}=e,n=Oa(e.children)?t:e.children;return typeof r=="function"?r(n):n},YA=e=>e!=null&&typeof e=="function",yTe=(e,t)=>{var r=yl(t-e),n=Math.min(Math.abs(t-e),360);return r*n},vTe=(e,t,r,n,s)=>{var{offset:a,className:i}=e,{cx:o,cy:l,innerRadius:u,outerRadius:d,startAngle:h,endAngle:g,clockWise:p}=s,x=(u+d)/2,v=yTe(h,g),w=v>=0?1:-1,C,k;switch(t){case"insideStart":C=h+w*a,k=p;break;case"insideEnd":C=g-w*a,k=!p;break;case"end":C=g+w*a,k=p;break;default:throw new Error("Unsupported position ".concat(t))}k=v<=0?k:!k;var _=ni(o,l,x,C),N=ni(o,l,x,C+(k?1:-1)*359),E="M".concat(_.x,",").concat(_.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(k?0:1,`,
    `).concat(N.x,",").concat(N.y),P=Oa(e.id)?uv("recharts-radial-line-"):e.id;return S.createElement("text",Mu({},n,{dominantBaseline:"central",className:Jn("recharts-radial-bar-label",i)}),S.createElement("defs",null,S.createElement("path",{id:P,d:E})),S.createElement("textPath",{xlinkHref:"#".concat(P)},r))},wTe=(e,t,r)=>{var{cx:n,cy:s,innerRadius:a,outerRadius:i,startAngle:o,endAngle:l}=e,u=(o+l)/2;if(r==="outside"){var{x:d,y:h}=ni(n,s,i+t,u);return{x:d,y:h,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"end"};var g=(a+i)/2,{x:p,y:x}=ni(n,s,g,u);return{x:p,y:x,textAnchor:"middle",verticalAnchor:"middle"}},HG=e=>"cx"in e&&Ir(e.cx),bTe=(e,t)=>{var{parentViewBox:r,offset:n,position:s}=e,a;r!=null&&!HG(r)&&(a=r);var{x:i,y:o,width:l,height:u}=t,d=u>=0?1:-1,h=d*n,g=d>0?"end":"start",p=d>0?"start":"end",x=l>=0?1:-1,v=x*n,w=x>0?"end":"start",C=x>0?"start":"end";if(s==="top"){var k={x:i+l/2,y:o-d*n,textAnchor:"middle",verticalAnchor:g};return Bs(Bs({},k),a?{height:Math.max(o-a.y,0),width:l}:{})}if(s==="bottom"){var _={x:i+l/2,y:o+u+h,textAnchor:"middle",verticalAnchor:p};return Bs(Bs({},_),a?{height:Math.max(a.y+a.height-(o+u),0),width:l}:{})}if(s==="left"){var N={x:i-v,y:o+u/2,textAnchor:w,verticalAnchor:"middle"};return Bs(Bs({},N),a?{width:Math.max(N.x-a.x,0),height:u}:{})}if(s==="right"){var E={x:i+l+v,y:o+u/2,textAnchor:C,verticalAnchor:"middle"};return Bs(Bs({},E),a?{width:Math.max(a.x+a.width-E.x,0),height:u}:{})}var P=a?{width:l,height:u}:{};return s==="insideLeft"?Bs({x:i+v,y:o+u/2,textAnchor:C,verticalAnchor:"middle"},P):s==="insideRight"?Bs({x:i+l-v,y:o+u/2,textAnchor:w,verticalAnchor:"middle"},P):s==="insideTop"?Bs({x:i+l/2,y:o+h,textAnchor:"middle",verticalAnchor:p},P):s==="insideBottom"?Bs({x:i+l/2,y:o+u-h,textAnchor:"middle",verticalAnchor:g},P):s==="insideTopLeft"?Bs({x:i+v,y:o+h,textAnchor:C,verticalAnchor:p},P):s==="insideTopRight"?Bs({x:i+l-v,y:o+h,textAnchor:w,verticalAnchor:p},P):s==="insideBottomLeft"?Bs({x:i+v,y:o+u-h,textAnchor:C,verticalAnchor:g},P):s==="insideBottomRight"?Bs({x:i+l-v,y:o+u-h,textAnchor:w,verticalAnchor:g},P):s&&typeof s=="object"&&(Ir(s.x)||Fh(s.x))&&(Ir(s.y)||Fh(s.y))?Bs({x:i+Ef(s.x,l),y:o+Ef(s.y,u),textAnchor:"end",verticalAnchor:"end"},P):Bs({x:i+l/2,y:o+u/2,textAnchor:"middle",verticalAnchor:"middle"},P)},_Te={offset:5};function sf(e){var t=Pl(e,_Te),{viewBox:r,position:n,value:s,children:a,content:i,className:o="",textBreakAll:l,labelRef:u}=t,d=pTe(),h=WG(),g=n==="center"?h:d??h,p=r||g;if(!p||Oa(s)&&Oa(a)&&!S.isValidElement(i)&&typeof i!="function")return null;var x=Bs(Bs({},t),{},{viewBox:p});if(S.isValidElement(i)){var{labelRef:v}=x,w=cTe(x,lTe);return S.cloneElement(i,w)}var C;if(typeof i=="function"){if(C=S.createElement(i,x),S.isValidElement(C))return C}else C=xTe(t);var k=HG(p),_=ii(t,!0);if(k&&(n==="insideStart"||n==="insideEnd"||n==="end"))return vTe(t,n,C,_,p);var N=k?wTe(p,t.offset,t.position):bTe(t,p);return S.createElement(qA,Mu({ref:u,className:Jn("recharts-label",o)},_,N,{breakAll:l}),C)}sf.displayName="Label";var STe=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?S.createElement(sf,Mu({key:"label-implicit"},n)):Xc(e)?S.createElement(sf,Mu({key:"label-implicit",value:e},n)):S.isValidElement(e)?e.type===sf?S.cloneElement(e,Bs({key:"label-implicit"},n)):S.createElement(sf,Mu({key:"label-implicit",content:e},n)):YA(e)?S.createElement(sf,Mu({key:"label-implicit",content:e},n)):e&&typeof e=="object"?S.createElement(sf,Mu({},e,{key:"label-implicit"},n)):null};function kTe(e){var{label:t}=e,r=WG();return STe(t,r)||null}var JC={},QC={},VI;function CTe(){return VI||(VI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(QC)),QC}var ZC={},KI;function TTe(){return KI||(KI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(ZC)),ZC}var qI;function ETe(){return qI||(qI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=CTe(),r=TTe(),n=z3();function s(a){if(n.isArrayLike(a))return t.last(r.toArray(a))}e.last=s})(JC)),JC}var eT,YI;function NTe(){return YI||(YI=1,eT=ETe().last),eT}var ATe=NTe();const jTe=Nl(ATe);var PTe=["valueAccessor"],FTe=["dataKey","clockWise","id","textBreakAll"];function k_(){return k_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k_.apply(null,arguments)}function XI(e,t){if(e==null)return{};var r,n,s=OTe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function OTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var DTe=e=>Array.isArray(e.value)?jTe(e.value):e.value,GG=S.createContext(void 0),RTe=GG.Provider,VG=S.createContext(void 0);VG.Provider;function ITe(){return S.useContext(GG)}function MTe(){return S.useContext(VG)}function ob(e){var{valueAccessor:t=DTe}=e,r=XI(e,PTe),{dataKey:n,clockWise:s,id:a,textBreakAll:i}=r,o=XI(r,FTe),l=ITe(),u=MTe(),d=l||u;return!d||!d.length?null:S.createElement(ep,{className:"recharts-label-list"},d.map((h,g)=>{var p,x=Oa(n)?t(h,g):Xi(h&&h.payload,n),v=Oa(a)?{}:{id:"".concat(a,"-").concat(g)};return S.createElement(sf,k_({},ii(h,!0),o,v,{fill:(p=r.fill)!==null&&p!==void 0?p:h.fill,parentViewBox:h.parentViewBox,value:x,textBreakAll:i,viewBox:h.viewBox,key:"label-".concat(g),index:g}))}))}ob.displayName="LabelList";function LTe(e){var{label:t}=e;return t?t===!0?S.createElement(ob,{key:"labelList-implicit"}):S.isValidElement(t)||YA(t)?S.createElement(ob,{key:"labelList-implicit",content:t}):typeof t=="object"?S.createElement(ob,k_({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function sN(){return sN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sN.apply(null,arguments)}var KG=e=>{var{cx:t,cy:r,r:n,className:s}=e,a=Jn("recharts-dot",s);return t===+t&&r===+r&&n===+n?S.createElement("circle",sN({},F0(e),$3(e),{className:a,cx:t,cy:r,r:n})):null},BTe={radiusAxis:{},angleAxis:{}},qG=Ho({name:"polarAxis",initialState:BTe,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:H3e,removeRadiusAxis:G3e,addAngleAxis:V3e,removeAngleAxis:K3e}=qG.actions,$Te=qG.reducer;function UTe(e){var{fn:t,args:r}=e,n=Qi(),s=jl();return S.useEffect(()=>{if(!s){var a=t(r);return n(VSe(a)),()=>{n(KSe(a))}}},[t,r,n,s]),null}var zTe=()=>{};function WTe(e){var{legendPayload:t}=e,r=Qi(),n=jl();return S.useEffect(()=>n?zTe:(r(R1e(t)),()=>{r(I1e(t))}),[r,n,t]),null}var tT,HTe=()=>{var[e]=S.useState(()=>uv("uid-"));return e},GTe=(tT=pM.useId)!==null&&tT!==void 0?tT:HTe;function VTe(e,t){var r=GTe();return t||(e?"".concat(e,"-").concat(r):r)}var KTe=S.createContext(void 0),qTe=e=>{var{id:t,type:r,children:n}=e,s=VTe("recharts-".concat(r),t);return S.createElement(KTe.Provider,{value:s},n(s))},YTe={cartesianItems:[],polarItems:[]},YG=Ho({name:"graphicalItems",initialState:YTe,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,s=Vu(e).cartesianItems.indexOf(r);s>-1&&(e.cartesianItems[s]=n)},removeCartesianGraphicalItem(e,t){var r=Vu(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=Vu(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:XTe,replaceCartesianGraphicalItem:JTe,removeCartesianGraphicalItem:QTe,addPolarGraphicalItem:q3e,removePolarGraphicalItem:Y3e}=YG.actions,ZTe=YG.reducer;function eEe(e){var t=Qi(),r=S.useRef(null);return S.useEffect(()=>{r.current===null?t(XTe(e)):r.current!==e&&t(JTe({prev:r.current,next:e})),r.current=e},[t,e]),S.useEffect(()=>()=>{r.current&&(t(QTe(r.current)),r.current=null)},[t]),null}function JI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function QI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JI(Object(r),!0).forEach(function(n){tEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tEe(e,t,r){return(t=rEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rEe(e){var t=nEe(e,"string");return typeof t=="symbol"?t:t+""}function nEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sEe={xAxis:{},yAxis:{},zAxis:{}},XG=Ho({name:"cartesianAxis",initialState:sEe,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=QI(QI({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:aEe,removeXAxis:iEe,addYAxis:oEe,removeYAxis:lEe,addZAxis:X3e,removeZAxis:J3e,updateYAxisWidth:cEe}=XG.actions,uEe=XG.reducer,dEe=St([oi],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),fEe=St([dEe,cd,ud],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),XA=()=>Tr(fEe),hEe=()=>Tr(Ike);function ZI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function eM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZI(Object(r),!0).forEach(function(n){gEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gEe(e,t,r){return(t=mEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mEe(e){var t=pEe(e,"string");return typeof t=="symbol"?t:t+""}function pEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xEe=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:s,dataKey:a}=e;if(s===!1||t.x==null||t.y==null)return null;var i=eM(eM({index:r,dataKey:a,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},ii(s,!1)),$3(s)),o;return S.isValidElement(s)?o=S.cloneElement(s,i):typeof s=="function"?o=s(i):o=S.createElement(KG,i),S.createElement(ep,{className:"recharts-active-dot"},o)};function yEe(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:s}=e,a=Tr(vv),i=hEe();if(t==null||i==null)return null;var o=t.find(l=>i.includes(l.payload));return Oa(o)?null:xEe({point:o,childIndex:Number(a),mainColor:r,dataKey:s,activeDot:n})}var vEe={},JG=Ho({name:"errorBars",initialState:vEe,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:s}=t.payload;e[r]&&(e[r]=e[r].map(a=>a.dataKey===n.dataKey&&a.direction===n.direction?s:a))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(s=>s.dataKey!==n.dataKey||s.direction!==n.direction))}}}),{addErrorBar:Q3e,replaceErrorBar:Z3e,removeErrorBar:eAe}=JG.actions,wEe=JG.reducer,bEe=["children"];function _Ee(e,t){if(e==null)return{};var r,n,s=SEe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function SEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var kEe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},CEe=S.createContext(kEe);function TEe(e){var{children:t}=e,r=_Ee(e,bEe);return S.createElement(CEe.Provider,{value:r},t)}function QG(e,t){var r,n,s=Tr(u=>fd(u,e)),a=Tr(u=>hd(u,t)),i=(r=s?.allowDataOverflow)!==null&&r!==void 0?r:Ao.allowDataOverflow,o=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:jo.allowDataOverflow,l=i||o;return{needClip:l,needClipX:i,needClipY:o}}function EEe(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,s=XA(),{needClipX:a,needClipY:i,needClip:o}=QG(t,r);if(!o)return null;var{x:l,y:u,width:d,height:h}=s;return S.createElement("clipPath",{id:"clipPath-".concat(n)},S.createElement("rect",{x:a?l:l-d/2,y:i?u:u-h/2,width:a?d:d*2,height:i?h:h*2}))}var NEe=e=>{var{chartData:t}=e,r=Qi(),n=jl();return S.useEffect(()=>n?()=>{}:(r(CI(t)),()=>{r(CI(void 0))}),[t,r,n]),null},tM={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},ZG=Ho({name:"brush",initialState:tM,reducers:{setBrushSettings(e,t){return t.payload==null?tM:t.payload}}}),{setBrushSettings:tAe}=ZG.actions,AEe=ZG.reducer;function jEe(e,t,r){return(t=PEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PEe(e){var t=FEe(e,"string");return typeof t=="symbol"?t:t+""}function FEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class JA{static create(t){return new JA(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(t)+a}default:return this.scale(t)}if(r){var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+i}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],s=r[r.length-1];return n<=s?t>=n&&t<=s:t>=s&&t<=n}}jEe(JA,"EPS",1e-4);function OEe(e){return(e%180+180)%180}var DEe=function(t){var{width:r,height:n}=t,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=OEe(s),i=a*Math.PI/180,o=Math.atan(n/r),l=i>o&&i<Math.PI-o?n/Math.sin(i):r/Math.cos(i);return Math.abs(l)},REe={dots:[],areas:[],lines:[]},eV=Ho({name:"referenceElements",initialState:REe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Vu(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Vu(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Vu(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:rAe,removeDot:nAe,addArea:sAe,removeArea:aAe,addLine:iAe,removeLine:oAe}=eV.actions,IEe=eV.reducer,MEe=S.createContext(void 0),LEe=e=>{var{children:t}=e,[r]=S.useState("".concat(uv("recharts"),"-clip")),n=XA();if(n==null)return null;var{x:s,y:a,width:i,height:o}=n;return S.createElement(MEe.Provider,{value:r},S.createElement("defs",null,S.createElement("clipPath",{id:r},S.createElement("rect",{x:s,y:a,height:o,width:i}))),t)};function Fm(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function tV(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],s=0;s<e.length;s+=t)n.push(e[s]);return n}function BEe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return DEe(n,r)}function $Ee(e,t,r){var n=r==="width",{x:s,y:a,width:i,height:o}=e;return t===1?{start:n?s:a,end:n?s+i:a+o}:{start:n?s+i:a+o,end:n?s:a}}function C_(e,t,r,n,s){if(e*t<e*n||e*t>e*s)return!1;var a=r();return e*(t-e*a/2-n)>=0&&e*(t+e*a/2-s)<=0}function UEe(e,t){return tV(e,t+1)}function zEe(e,t,r,n,s){for(var a=(n||[]).slice(),{start:i,end:o}=t,l=0,u=1,d=i,h=function(){var x=n?.[l];if(x===void 0)return{v:tV(n,u)};var v=l,w,C=()=>(w===void 0&&(w=r(x,v)),w),k=x.coordinate,_=l===0||C_(e,k,C,d,o);_||(l=0,d=i,u+=1),_&&(d=k+e*(C()/2+s),l+=u)},g;u<=a.length;)if(g=h(),g)return g.v;return[]}function rM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function xi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rM(Object(r),!0).forEach(function(n){WEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WEe(e,t,r){return(t=HEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HEe(e){var t=GEe(e,"string");return typeof t=="symbol"?t:t+""}function GEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VEe(e,t,r,n,s){for(var a=(n||[]).slice(),i=a.length,{start:o}=t,{end:l}=t,u=function(g){var p=a[g],x,v=()=>(x===void 0&&(x=r(p,g)),x);if(g===i-1){var w=e*(p.coordinate+e*v()/2-l);a[g]=p=xi(xi({},p),{},{tickCoord:w>0?p.coordinate-w*e:p.coordinate})}else a[g]=p=xi(xi({},p),{},{tickCoord:p.coordinate});var C=C_(e,p.tickCoord,v,o,l);C&&(l=p.tickCoord-e*(v()/2+s),a[g]=xi(xi({},p),{},{isShow:!0}))},d=i-1;d>=0;d--)u(d);return a}function KEe(e,t,r,n,s,a){var i=(n||[]).slice(),o=i.length,{start:l,end:u}=t;if(a){var d=n[o-1],h=r(d,o-1),g=e*(d.coordinate+e*h/2-u);i[o-1]=d=xi(xi({},d),{},{tickCoord:g>0?d.coordinate-g*e:d.coordinate});var p=C_(e,d.tickCoord,()=>h,l,u);p&&(u=d.tickCoord-e*(h/2+s),i[o-1]=xi(xi({},d),{},{isShow:!0}))}for(var x=a?o-1:o,v=function(k){var _=i[k],N,E=()=>(N===void 0&&(N=r(_,k)),N);if(k===0){var P=e*(_.coordinate-e*E()/2-l);i[k]=_=xi(xi({},_),{},{tickCoord:P<0?_.coordinate-P*e:_.coordinate})}else i[k]=_=xi(xi({},_),{},{tickCoord:_.coordinate});var F=C_(e,_.tickCoord,E,l,u);F&&(l=_.tickCoord+e*(E()/2+s),i[k]=xi(xi({},_),{},{isShow:!0}))},w=0;w<x;w++)v(w);return i}function QA(e,t,r){var{tick:n,ticks:s,viewBox:a,minTickGap:i,orientation:o,interval:l,tickFormatter:u,unit:d,angle:h}=e;if(!s||!s.length||!n)return[];if(Ir(l)||tp.isSsr){var g;return(g=UEe(s,Ir(l)?l:0))!==null&&g!==void 0?g:[]}var p=[],x=o==="top"||o==="bottom"?"width":"height",v=d&&x==="width"?Py(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},w=(_,N)=>{var E=typeof u=="function"?u(_.value,N):_.value;return x==="width"?BEe(Py(E,{fontSize:t,letterSpacing:r}),v,h):Py(E,{fontSize:t,letterSpacing:r})[x]},C=s.length>=2?yl(s[1].coordinate-s[0].coordinate):1,k=$Ee(a,C,x);return l==="equidistantPreserveStart"?zEe(C,k,w,s,i):(l==="preserveStart"||l==="preserveStartEnd"?p=KEe(C,k,w,s,i,l==="preserveStartEnd"):p=VEe(C,k,w,s,i),p.filter(_=>_.isShow))}var qEe=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:s=0,tickMargin:a=0}=e,i=0;if(t){t.forEach(d=>{if(d){var h=d.getBoundingClientRect();h.width>i&&(i=h.width)}});var o=r?r.getBoundingClientRect().width:0,l=s+a,u=i+l+o+(r?n:0);return Math.round(u)}return 0},YEe=["axisLine","width","height","className","hide","ticks"],XEe=["viewBox"],JEe=["viewBox"];function aN(e,t){if(e==null)return{};var r,n,s=QEe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function QEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function v0(){return v0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},v0.apply(null,arguments)}function nM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ca(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nM(Object(r),!0).forEach(function(n){ZEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZEe(e,t,r){return(t=eNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eNe(e){var t=tNe(e,"string");return typeof t=="symbol"?t:t+""}function tNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZA={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function rNe(e){var{x:t,y:r,width:n,height:s,orientation:a,mirror:i,axisLine:o,otherSvgProps:l}=e;if(!o)return null;var u=ca(ca(ca({},l),ii(o,!1)),{},{fill:"none"});if(a==="top"||a==="bottom"){var d=+(a==="top"&&!i||a==="bottom"&&i);u=ca(ca({},u),{},{x1:t,y1:r+d*s,x2:t+n,y2:r+d*s})}else{var h=+(a==="left"&&!i||a==="right"&&i);u=ca(ca({},u),{},{x1:t+h*n,y1:r,x2:t+h*n,y2:r+s})}return S.createElement("line",v0({},u,{className:Jn("recharts-cartesian-axis-line",h2(o,"className"))}))}function nNe(e,t,r,n,s,a,i,o,l){var u,d,h,g,p,x,v=o?-1:1,w=e.tickSize||i,C=Ir(e.tickCoord)?e.tickCoord:e.coordinate;switch(a){case"top":u=d=e.coordinate,g=r+ +!o*s,h=g-v*w,x=h-v*l,p=C;break;case"left":h=g=e.coordinate,d=t+ +!o*n,u=d-v*w,p=u-v*l,x=C;break;case"right":h=g=e.coordinate,d=t+ +o*n,u=d+v*w,p=u+v*l,x=C;break;default:u=d=e.coordinate,g=r+ +o*s,h=g+v*w,x=h+v*l,p=C;break}return{line:{x1:u,y1:h,x2:d,y2:g},tick:{x:p,y:x}}}function sNe(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function aNe(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function iNe(e){var{option:t,tickProps:r,value:n}=e,s,a=Jn(r.className,"recharts-cartesian-axis-tick-value");if(S.isValidElement(t))s=S.cloneElement(t,ca(ca({},r),{},{className:a}));else if(typeof t=="function")s=t(ca(ca({},r),{},{className:a}));else{var i="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(i=Jn(i,t?.className)),s=S.createElement(qA,v0({},r,{className:i}),n)}return s}function oNe(e){var{ticks:t=[],tick:r,tickLine:n,stroke:s,tickFormatter:a,unit:i,padding:o,tickTextProps:l,orientation:u,mirror:d,x:h,y:g,width:p,height:x,tickSize:v,tickMargin:w,fontSize:C,letterSpacing:k,getTicksConfig:_,events:N}=e,E=QA(ca(ca({},_),{},{ticks:t}),C,k),P=sNe(u,d),F=aNe(u,d),A=F0(_),j=ii(r,!1),R=ca(ca({},A),{},{fill:"none"},ii(n,!1)),U=E.map((Y,Z)=>{var{line:ae,tick:ee}=nNe(Y,h,g,p,x,u,v,d,w),ne=ca(ca(ca(ca({textAnchor:P,verticalAnchor:F},A),{},{stroke:"none",fill:s},j),ee),{},{index:Z,payload:Y,visibleTicksCount:E.length,tickFormatter:a,padding:o},l);return S.createElement(ep,v0({className:"recharts-cartesian-axis-tick",key:"tick-".concat(Y.value,"-").concat(Y.coordinate,"-").concat(Y.tickCoord)},Txe(N,Y,Z)),n&&S.createElement("line",v0({},R,ae,{className:Jn("recharts-cartesian-axis-tick-line",h2(n,"className"))})),r&&S.createElement(iNe,{option:r,tickProps:ne,value:"".concat(typeof a=="function"?a(Y.value,Z):Y.value).concat(i||"")}))});return U.length>0?S.createElement("g",{className:"recharts-cartesian-axis-ticks"},U):null}var lNe=S.forwardRef((e,t)=>{var{axisLine:r,width:n,height:s,className:a,hide:i,ticks:o}=e,l=aN(e,YEe),[u,d]=S.useState(""),[h,g]=S.useState(""),p=S.useRef([]);S.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var v;return qEe({ticks:p.current,label:(v=e.labelRef)===null||v===void 0?void 0:v.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var x=S.useCallback(v=>{if(v){var w=v.getElementsByClassName("recharts-cartesian-axis-tick-value");p.current=Array.from(w);var C=w[0];if(C){var k=window.getComputedStyle(C),_=k.fontSize,N=k.letterSpacing;(_!==u||N!==h)&&(d(_),g(N))}}},[u,h]);return i||n!=null&&n<=0||s!=null&&s<=0?null:S.createElement(ep,{className:Jn("recharts-cartesian-axis",a),ref:x},S.createElement(rNe,{x:e.x,y:e.y,width:n,height:s,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:F0(e)}),S.createElement(oNe,{ticks:o,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:u,letterSpacing:h,getTicksConfig:e,events:l}),S.createElement(gTe,{x:e.x,y:e.y,width:e.width,height:e.height},S.createElement(kTe,{label:e.label}),e.children))}),cNe=S.memo(lNe,(e,t)=>{var{viewBox:r}=e,n=aN(e,XEe),{viewBox:s}=t,a=aN(t,JEe);return Fm(r,s)&&Fm(n,a)}),ej=S.forwardRef((e,t)=>{var r=Pl(e,ZA);return S.createElement(cNe,v0({},r,{ref:t}))});ej.displayName="CartesianAxis";var uNe=["x1","y1","x2","y2","key"],dNe=["offset"],fNe=["xAxisId","yAxisId"],hNe=["xAxisId","yAxisId"];function sM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function bi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sM(Object(r),!0).forEach(function(n){gNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gNe(e,t,r){return(t=mNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mNe(e){var t=pNe(e,"string");return typeof t=="symbol"?t:t+""}function pNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rh(){return Rh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rh.apply(null,arguments)}function T_(e,t){if(e==null)return{};var r,n,s=xNe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function xNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var yNe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:s,width:a,height:i,ry:o}=e;return S.createElement("rect",{x:n,y:s,ry:o,width:a,height:i,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function rV(e,t){var r;if(S.isValidElement(e))r=S.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:s,x2:a,y2:i,key:o}=t,l=T_(t,uNe),u=F0(l),{offset:d}=u,h=T_(u,dNe);r=S.createElement("line",Rh({},h,{x1:n,y1:s,x2:a,y2:i,fill:"none",key:o}))}return r}function vNe(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:s}=e;if(!n||!s||!s.length)return null;var{xAxisId:a,yAxisId:i}=e,o=T_(e,fNe),l=s.map((u,d)=>{var h=bi(bi({},o),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return rV(n,h)});return S.createElement("g",{className:"recharts-cartesian-grid-horizontal"},l)}function wNe(e){var{y:t,height:r,vertical:n=!0,verticalPoints:s}=e;if(!n||!s||!s.length)return null;var{xAxisId:a,yAxisId:i}=e,o=T_(e,hNe),l=s.map((u,d)=>{var h=bi(bi({},o),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return rV(n,h)});return S.createElement("g",{className:"recharts-cartesian-grid-vertical"},l)}function bNe(e){var{horizontalFill:t,fillOpacity:r,x:n,y:s,width:a,height:i,horizontalPoints:o,horizontal:l=!0}=e;if(!l||!t||!t.length)return null;var u=o.map(h=>Math.round(h+s-s)).sort((h,g)=>h-g);s!==u[0]&&u.unshift(0);var d=u.map((h,g)=>{var p=!u[g+1],x=p?s+i-h:u[g+1]-h;if(x<=0)return null;var v=g%t.length;return S.createElement("rect",{key:"react-".concat(g),y:h,x:n,height:x,width:a,stroke:"none",fill:t[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return S.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function _Ne(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:s,y:a,width:i,height:o,verticalPoints:l}=e;if(!t||!r||!r.length)return null;var u=l.map(h=>Math.round(h+s-s)).sort((h,g)=>h-g);s!==u[0]&&u.unshift(0);var d=u.map((h,g)=>{var p=!u[g+1],x=p?s+i-h:u[g+1]-h;if(x<=0)return null;var v=g%r.length;return S.createElement("rect",{key:"react-".concat(g),x:h,y:a,width:x,height:o,stroke:"none",fill:r[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return S.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var SNe=(e,t)=>{var{xAxis:r,width:n,height:s,offset:a}=e;return iW(QA(bi(bi(bi({},ZA),r),{},{ticks:oW(r),viewBox:{x:0,y:0,width:n,height:s}})),a.left,a.left+a.width,t)},kNe=(e,t)=>{var{yAxis:r,width:n,height:s,offset:a}=e;return iW(QA(bi(bi(bi({},ZA),r),{},{ticks:oW(r),viewBox:{x:0,y:0,width:n,height:s}})),a.top,a.top+a.height,t)},CNe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function nV(e){var t=fW(),r=hW(),n=dW(),s=bi(bi({},Pl(e,CNe)),{},{x:Ir(e.x)?e.x:n.left,y:Ir(e.y)?e.y:n.top,width:Ir(e.width)?e.width:n.width,height:Ir(e.height)?e.height:n.height}),{xAxisId:a,yAxisId:i,x:o,y:l,width:u,height:d,syncWithTicks:h,horizontalValues:g,verticalValues:p}=s,x=jl(),v=Tr(j=>pI(j,"xAxis",a,x)),w=Tr(j=>pI(j,"yAxis",i,x));if(!Ir(u)||u<=0||!Ir(d)||d<=0||!Ir(o)||o!==+o||!Ir(l)||l!==+l)return null;var C=s.verticalCoordinatesGenerator||SNe,k=s.horizontalCoordinatesGenerator||kNe,{horizontalPoints:_,verticalPoints:N}=s;if((!_||!_.length)&&typeof k=="function"){var E=g&&g.length,P=k({yAxis:w?bi(bi({},w),{},{ticks:E?g:w.ticks}):void 0,width:t,height:r,offset:n},E?!0:h);jy(Array.isArray(P),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof P,"]")),Array.isArray(P)&&(_=P)}if((!N||!N.length)&&typeof C=="function"){var F=p&&p.length,A=C({xAxis:v?bi(bi({},v),{},{ticks:F?p:v.ticks}):void 0,width:t,height:r,offset:n},F?!0:h);jy(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof A,"]")),Array.isArray(A)&&(N=A)}return S.createElement("g",{className:"recharts-cartesian-grid"},S.createElement(yNe,{fill:s.fill,fillOpacity:s.fillOpacity,x:s.x,y:s.y,width:s.width,height:s.height,ry:s.ry}),S.createElement(bNe,Rh({},s,{horizontalPoints:_})),S.createElement(_Ne,Rh({},s,{verticalPoints:N})),S.createElement(vNe,Rh({},s,{offset:n,horizontalPoints:_,xAxis:v,yAxis:w})),S.createElement(wNe,Rh({},s,{offset:n,verticalPoints:N,xAxis:v,yAxis:w})))}nV.displayName="CartesianGrid";var sV=(e,t,r,n)=>uG(e,"xAxis",t,n),aV=(e,t,r,n)=>cG(e,"xAxis",t,n),iV=(e,t,r,n)=>uG(e,"yAxis",r,n),oV=(e,t,r,n)=>cG(e,"yAxis",r,n),TNe=St([Zn,sV,iV,aV,oV],(e,t,r,n,s)=>Lf(e,"xAxis")?IE(t,n,!1):IE(r,s,!1)),ENe=(e,t,r,n,s)=>s;function NNe(e){return e.type==="line"}var ANe=St([FH,ENe],(e,t)=>e.filter(NNe).find(r=>r.id===t)),jNe=St([Zn,sV,iV,aV,oV,ANe,TNe,bA],(e,t,r,n,s,a,i,o)=>{var{chartData:l,dataStartIndex:u,dataEndIndex:d}=o;if(!(a==null||t==null||r==null||n==null||s==null||n.length===0||s.length===0||i==null)){var{dataKey:h,data:g}=a,p;if(g!=null&&g.length>0?p=g:p=l?.slice(u,d+1),p!=null)return QNe({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:s,dataKey:h,bandSize:i,displayedData:p})}}),PNe=["id"],FNe=["type","layout","connectNulls","needClip"],ONe=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function aM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Ro(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aM(Object(r),!0).forEach(function(n){DNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DNe(e,t,r){return(t=RNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RNe(e){var t=INe(e,"string");return typeof t=="symbol"?t:t+""}function INe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tj(e,t){if(e==null)return{};var r,n,s=MNe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function MNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function w0(){return w0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w0.apply(null,arguments)}var LNe=e=>{var{dataKey:t,name:r,stroke:n,legendType:s,hide:a}=e;return[{inactive:a,dataKey:t,type:s,color:n,value:lW(r,t),payload:e}]};function BNe(e){var{dataKey:t,data:r,stroke:n,strokeWidth:s,fill:a,name:i,hide:o,unit:l}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:s,fill:a,dataKey:t,nameKey:void 0,name:lW(i,t),hide:o,type:e.tooltipType,color:e.stroke,unit:l}}}var lV=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function $Ne(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],s=0;s<t;++s)n=[...n,...r];return n}var UNe=(e,t,r)=>{var n=r.reduce((h,g)=>h+g);if(!n)return lV(t,e);for(var s=Math.floor(e/n),a=e%n,i=t-e,o=[],l=0,u=0;l<r.length;u+=r[l],++l)if(u+r[l]>a){o=[...r.slice(0,l),a-u];break}var d=o.length%2===0?[0,i]:[i];return[...$Ne(r,s),...o,...d].map(h=>"".concat(h,"px")).join(", ")};function zNe(e,t){var r;if(S.isValidElement(e))r=S.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=Jn("recharts-line-dot",typeof e!="boolean"?e.className:"");r=S.createElement(KG,w0({},t,{className:n}))}return r}function WNe(e,t){return e==null?!1:t?!0:e.length===1}function HNe(e){var{clipPathId:t,points:r,props:n}=e,{dot:s,dataKey:a,needClip:i}=n;if(!WNe(r,s))return null;var{id:o}=n,l=tj(n,PNe),u=oz(s),d=F0(l),h=ii(s,!0),g=r.map((x,v)=>{var w=Ro(Ro(Ro({key:"dot-".concat(v),r:3},d),h),{},{index:v,cx:x.x,cy:x.y,dataKey:a,value:x.value,payload:x.payload,points:r});return zNe(s,w)}),p={clipPath:i?"url(#clipPath-".concat(u?"":"dots-").concat(t,")"):void 0};return S.createElement(ep,w0({className:"recharts-line-dots",key:"dots"},p),g)}function GNe(e){var{showLabels:t,children:r,points:n}=e,s=S.useMemo(()=>n?.map(a=>{var i={x:a.x,y:a.y,width:0,height:0};return Ro(Ro({},i),{},{value:a.value,payload:a.payload,viewBox:i,parentViewBox:void 0,fill:void 0})}),[n]);return S.createElement(RTe,{value:t?s:null},r)}function iM(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:s,props:a}=e,{type:i,layout:o,connectNulls:l,needClip:u}=a,d=tj(a,FNe),h=Ro(Ro({},ii(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:n,type:i,layout:o,connectNulls:l,strokeDasharray:s??a.strokeDasharray});return S.createElement(S.Fragment,null,n?.length>1&&S.createElement(pW,w0({},h,{pathRef:r})),S.createElement(HNe,{points:n,clipPathId:t,props:a}))}function VNe(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function KNe(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:s,longestAnimatedLengthRef:a}=e,{points:i,strokeDasharray:o,isAnimationActive:l,animationBegin:u,animationDuration:d,animationEasing:h,animateNewValues:g,width:p,height:x,onAnimationEnd:v,onAnimationStart:w}=r,C=s.current,k=bW(r,"recharts-line-"),[_,N]=S.useState(!1),E=!_,P=S.useCallback(()=>{typeof v=="function"&&v(),N(!1)},[v]),F=S.useCallback(()=>{typeof w=="function"&&w(),N(!0)},[w]),A=VNe(n.current),j=a.current;return S.createElement(GNe,{points:i,showLabels:E},r.children,S.createElement(wW,{animationId:k,begin:u,duration:d,isActive:l,easing:h,onAnimationEnd:P,onAnimationStart:F,key:k},R=>{var U=Ru(j,A+j,R),Y=Math.min(U,A),Z;if(l)if(o){var ae="".concat(o).split(/[,\s]+/gim).map(L=>parseFloat(L));Z=UNe(Y,A,ae)}else Z=lV(A,Y);else Z=o==null?void 0:String(o);if(C){var ee=C.length/i.length,ne=R===1?i:i.map((L,H)=>{var M=Math.floor(H*ee);if(C[M]){var V=C[M];return Ro(Ro({},L),{},{x:Ru(V.x,L.x,R),y:Ru(V.y,L.y,R)})}return g?Ro(Ro({},L),{},{x:Ru(p*2,L.x,R),y:Ru(x/2,L.y,R)}):Ro(Ro({},L),{},{x:L.x,y:L.y})});return s.current=ne,S.createElement(iM,{props:r,points:ne,clipPathId:t,pathRef:n,strokeDasharray:Z})}return R>0&&A>0&&(s.current=i,a.current=Y),S.createElement(iM,{props:r,points:i,clipPathId:t,pathRef:n,strokeDasharray:Z})}),S.createElement(LTe,{label:r.label}))}function qNe(e){var{clipPathId:t,props:r}=e,n=S.useRef(null),s=S.useRef(0),a=S.useRef(null);return S.createElement(KNe,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:s,pathRef:a})}var YNe=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:Xi(e.payload,t)});class XNe extends S.Component{render(){var t,{hide:r,dot:n,points:s,className:a,xAxisId:i,yAxisId:o,top:l,left:u,width:d,height:h,id:g,needClip:p}=this.props;if(r)return null;var x=Jn("recharts-line",a),v=g,{r:w=3,strokeWidth:C=2}=(t=ii(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},k=oz(n),_=w*2+C;return S.createElement(S.Fragment,null,S.createElement(ep,{className:x},p&&S.createElement("defs",null,S.createElement(EEe,{clipPathId:v,xAxisId:i,yAxisId:o}),!k&&S.createElement("clipPath",{id:"clipPath-dots-".concat(v)},S.createElement("rect",{x:u-_/2,y:l-_/2,width:d+_,height:h+_}))),S.createElement(TEe,{xAxisId:i,yAxisId:o,data:s,dataPointFormatter:YNe,errorBarOffset:0},S.createElement(qNe,{props:this.props,clipPathId:v}))),S.createElement(yEe,{activeDot:this.props.activeDot,points:s,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var cV={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!tp.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function JNe(e){var t=Pl(e,cV),{activeDot:r,animateNewValues:n,animationBegin:s,animationDuration:a,animationEasing:i,connectNulls:o,dot:l,hide:u,isAnimationActive:d,label:h,legendType:g,xAxisId:p,yAxisId:x,id:v}=t,w=tj(t,ONe),{needClip:C}=QG(p,x),k=XA(),_=J3(),N=jl(),E=Tr(R=>jNe(R,p,x,N,v));if(_!=="horizontal"&&_!=="vertical"||E==null||k==null)return null;var{height:P,width:F,x:A,y:j}=k;return S.createElement(XNe,w0({},w,{id:v,connectNulls:o,dot:l,activeDot:r,animateNewValues:n,animationBegin:s,animationDuration:a,animationEasing:i,isAnimationActive:d,hide:u,label:h,legendType:g,xAxisId:p,yAxisId:x,points:E,layout:_,height:P,width:F,left:A,top:j,needClip:C}))}function QNe(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:s,yAxisTicks:a,dataKey:i,bandSize:o,displayedData:l}=e;return l.map((u,d)=>{var h=Xi(u,i);if(t==="horizontal"){var g=tR({axis:r,ticks:s,bandSize:o,entry:u,index:d}),p=Oa(h)?null:n.scale(h);return{x:g,y:p,value:h,payload:u}}var x=Oa(h)?null:r.scale(h),v=tR({axis:n,ticks:a,bandSize:o,entry:u,index:d});return x==null||v==null?null:{x,y:v,value:h,payload:u}}).filter(Boolean)}function ZNe(e){var t=Pl(e,cV),r=jl();return S.createElement(qTe,{id:t.id,type:"line"},n=>S.createElement(S.Fragment,null,S.createElement(WTe,{legendPayload:LNe(t)}),S.createElement(UTe,{fn:BNe,args:t}),S.createElement(eEe,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),S.createElement(JNe,w0({},t,{id:n}))))}var uV=S.memo(ZNe);uV.displayName="Line";var e4e=["dangerouslySetInnerHTML","ticks"],t4e=["id"],r4e=["domain"],n4e=["domain"];function iN(){return iN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iN.apply(null,arguments)}function E_(e,t){if(e==null)return{};var r,n,s=s4e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function s4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function a4e(e){var t=Qi();return S.useEffect(()=>(t(aEe(e)),()=>{t(iEe(e))}),[e,t]),null}var i4e=e=>{var{xAxisId:t,className:r}=e,n=Tr(uW),s=jl(),a="xAxis",i=Tr(w=>op(w,a,t,s)),o=Tr(w=>lG(w,a,t,s)),l=Tr(w=>ASe(w,t)),u=Tr(w=>RSe(w,t)),d=Tr(w=>NH(w,t));if(l==null||u==null||d==null)return null;var{dangerouslySetInnerHTML:h,ticks:g}=e,p=E_(e,e4e),{id:x}=d,v=E_(d,t4e);return S.createElement(ej,iN({},p,v,{scale:i,x:u.x,y:u.y,width:l.width,height:l.height,className:Jn("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:o}))},o4e={allowDataOverflow:Ao.allowDataOverflow,allowDecimals:Ao.allowDecimals,allowDuplicatedCategory:Ao.allowDuplicatedCategory,height:Ao.height,hide:!1,mirror:Ao.mirror,orientation:Ao.orientation,padding:Ao.padding,reversed:Ao.reversed,scale:Ao.scale,tickCount:Ao.tickCount,type:Ao.type,xAxisId:0},l4e=e=>{var t,r,n,s,a,i=Pl(e,o4e);return S.createElement(S.Fragment,null,S.createElement(a4e,{interval:(t=i.interval)!==null&&t!==void 0?t:"preserveEnd",id:i.xAxisId,scale:i.scale,type:i.type,padding:i.padding,allowDataOverflow:i.allowDataOverflow,domain:i.domain,dataKey:i.dataKey,allowDuplicatedCategory:i.allowDuplicatedCategory,allowDecimals:i.allowDecimals,tickCount:i.tickCount,includeHidden:(r=i.includeHidden)!==null&&r!==void 0?r:!1,reversed:i.reversed,ticks:i.ticks,height:i.height,orientation:i.orientation,mirror:i.mirror,hide:i.hide,unit:i.unit,name:i.name,angle:(n=i.angle)!==null&&n!==void 0?n:0,minTickGap:(s=i.minTickGap)!==null&&s!==void 0?s:5,tick:(a=i.tick)!==null&&a!==void 0?a:!0,tickFormatter:i.tickFormatter}),S.createElement(i4e,i))},c4e=(e,t)=>{var{domain:r}=e,n=E_(e,r4e),{domain:s}=t,a=E_(t,n4e);return Fm(n,a)?Array.isArray(r)&&r.length===2&&Array.isArray(s)&&s.length===2?r[0]===s[0]&&r[1]===s[1]:Fm({domain:r},{domain:s}):!1},dV=S.memo(l4e,c4e);dV.displayName="XAxis";var u4e=["dangerouslySetInnerHTML","ticks"],d4e=["id"],f4e=["domain"],h4e=["domain"];function oN(){return oN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oN.apply(null,arguments)}function N_(e,t){if(e==null)return{};var r,n,s=g4e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function g4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function m4e(e){var t=Qi();return S.useEffect(()=>(t(oEe(e)),()=>{t(lEe(e))}),[e,t]),null}var p4e=e=>{var{yAxisId:t,className:r,width:n,label:s}=e,a=S.useRef(null),i=S.useRef(null),o=Tr(uW),l=jl(),u=Qi(),d="yAxis",h=Tr(E=>op(E,d,t,l)),g=Tr(E=>LSe(E,t)),p=Tr(E=>MSe(E,t)),x=Tr(E=>lG(E,d,t,l)),v=Tr(E=>AH(E,t));if(S.useLayoutEffect(()=>{if(!(n!=="auto"||!g||YA(s)||S.isValidElement(s)||v==null)){var E=a.current;if(E){var P=E.getCalculatedWidth();Math.round(g.width)!==Math.round(P)&&u(cEe({id:t,width:P}))}}},[x,g,u,s,t,n,v]),g==null||p==null||v==null)return null;var{dangerouslySetInnerHTML:w,ticks:C}=e,k=N_(e,u4e),{id:_}=v,N=N_(v,d4e);return S.createElement(ej,oN({},k,N,{ref:a,labelRef:i,scale:h,x:p.x,y:p.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:g.width,height:g.height,className:Jn("recharts-".concat(d," ").concat(d),r),viewBox:o,ticks:x}))},x4e={allowDataOverflow:jo.allowDataOverflow,allowDecimals:jo.allowDecimals,allowDuplicatedCategory:jo.allowDuplicatedCategory,hide:!1,mirror:jo.mirror,orientation:jo.orientation,padding:jo.padding,reversed:jo.reversed,scale:jo.scale,tickCount:jo.tickCount,type:jo.type,width:jo.width,yAxisId:0},y4e=e=>{var t,r,n,s,a,i=Pl(e,x4e);return S.createElement(S.Fragment,null,S.createElement(m4e,{interval:(t=i.interval)!==null&&t!==void 0?t:"preserveEnd",id:i.yAxisId,scale:i.scale,type:i.type,domain:i.domain,allowDataOverflow:i.allowDataOverflow,dataKey:i.dataKey,allowDuplicatedCategory:i.allowDuplicatedCategory,allowDecimals:i.allowDecimals,tickCount:i.tickCount,padding:i.padding,includeHidden:(r=i.includeHidden)!==null&&r!==void 0?r:!1,reversed:i.reversed,ticks:i.ticks,width:i.width,orientation:i.orientation,mirror:i.mirror,hide:i.hide,unit:i.unit,name:i.name,angle:(n=i.angle)!==null&&n!==void 0?n:0,minTickGap:(s=i.minTickGap)!==null&&s!==void 0?s:5,tick:(a=i.tick)!==null&&a!==void 0?a:!0,tickFormatter:i.tickFormatter}),S.createElement(p4e,i))},v4e=(e,t)=>{var{domain:r}=e,n=N_(e,f4e),{domain:s}=t,a=N_(t,h4e);return Fm(n,a)?Array.isArray(r)&&r.length===2&&Array.isArray(s)&&s.length===2?r[0]===s[0]&&r[1]===s[1]:Fm({domain:r},{domain:s}):!1},fV=S.memo(y4e,v4e);fV.displayName="YAxis";var rT={exports:{}},nT={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oM;function w4e(){if(oM)return nT;oM=1;var e=b0();function t(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,s=e.useRef,a=e.useEffect,i=e.useMemo,o=e.useDebugValue;return nT.useSyncExternalStoreWithSelector=function(l,u,d,h,g){var p=s(null);if(p.current===null){var x={hasValue:!1,value:null};p.current=x}else x=p.current;p=i(function(){function w(E){if(!C){if(C=!0,k=E,E=h(E),g!==void 0&&x.hasValue){var P=x.value;if(g(P,E))return _=P}return _=E}if(P=_,r(k,E))return P;var F=h(E);return g!==void 0&&g(P,F)?(k=E,P):(k=E,_=F)}var C=!1,k,_,N=d===void 0?null:d;return[function(){return w(u())},N===null?void 0:function(){return w(N())}]},[u,d,h,g]);var v=n(l,p[0],p[1]);return a(function(){x.hasValue=!0,x.value=v},[v]),o(v),v},nT}var lM;function b4e(){return lM||(lM=1,rT.exports=w4e()),rT.exports}b4e();function _4e(e){e()}function S4e(){let e=null,t=null;return{clear(){e=null,t=null},notify(){_4e(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const s=t={callback:r,next:null,prev:t};return s.prev?s.prev.next=s:e=s,function(){!n||e===null||(n=!1,s.next?s.next.prev=s.prev:t=s.prev,s.prev?s.prev.next=s.next:e=s.next)}}}}var cM={notify(){},get:()=>[]};function k4e(e,t){let r,n=cM,s=0,a=!1;function i(v){d();const w=n.subscribe(v);let C=!1;return()=>{C||(C=!0,w(),h())}}function o(){n.notify()}function l(){x.onStateChange&&x.onStateChange()}function u(){return a}function d(){s++,r||(r=e.subscribe(l),n=S4e())}function h(){s--,r&&s===0&&(r(),r=void 0,n.clear(),n=cM)}function g(){a||(a=!0,d())}function p(){a&&(a=!1,h())}const x={addNestedSub:i,notifyNestedSubs:o,handleChangeWrapper:l,isSubscribed:u,trySubscribe:g,tryUnsubscribe:p,getListeners:()=>n};return x}var C4e=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",T4e=C4e(),E4e=()=>typeof navigator<"u"&&navigator.product==="ReactNative",N4e=E4e(),A4e=()=>T4e||N4e?S.useLayoutEffect:S.useEffect,j4e=A4e(),P4e=Symbol.for("react-redux-context"),F4e=typeof globalThis<"u"?globalThis:{};function O4e(){if(!S.createContext)return{};const e=F4e[P4e]??=new Map;let t=e.get(S.createContext);return t||(t=S.createContext(null),e.set(S.createContext,t)),t}var D4e=O4e();function R4e(e){const{children:t,context:r,serverState:n,store:s}=e,a=S.useMemo(()=>{const l=k4e(s);return{store:s,subscription:l,getServerState:n?()=>n:void 0}},[s,n]),i=S.useMemo(()=>s.getState(),[s]);j4e(()=>{const{subscription:l}=a;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),i!==s.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[a,i]);const o=r||D4e;return S.createElement(o.Provider,{value:a},t)}var I4e=R4e,M4e=(e,t)=>t,rj=St([M4e,Zn,kH,xa,kG,gd,Wke,oi],qke),nj=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},hV=Tl("mouseClick"),gV=Jv();gV.startListening({actionCreator:hV,effect:(e,t)=>{var r=e.payload,n=rj(t.getState(),nj(r));n?.activeIndex!=null&&t.dispatch(XSe({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var lN=Tl("mouseMove"),mV=Jv();mV.startListening({actionCreator:lN,effect:(e,t)=>{var r=e.payload,n=t.getState(),s=BA(n,n.tooltip.settings.shared),a=rj(n,nj(r));s==="axis"&&(a?.activeIndex!=null?t.dispatch(xG({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate})):t.dispatch(pG()))}});var uM={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},pV=Ho({name:"rootProps",initialState:uM,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:uM.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),L4e=pV.reducer,{updateOptions:B4e}=pV.actions,xV=Ho({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:lAe}=xV.actions,$4e=xV.reducer,yV=Tl("keyDown"),vV=Tl("focus"),sj=Jv();sj.startListening({actionCreator:yV,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:s}=r.tooltip,a=e.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var i=Number($A(s,cp(r))),o=gd(r);if(a==="Enter"){var l=S_(r,"axis","hover",String(s.index));t.dispatch(eN({active:!s.active,activeIndex:s.index,activeDataKey:s.dataKey,activeCoordinate:l}));return}var u=zSe(r),d=u==="left-to-right"?1:-1,h=a==="ArrowRight"?1:-1,g=i+h*d;if(!(o==null||g>=o.length||g<0)){var p=S_(r,"axis","hover",String(g));t.dispatch(eN({active:!0,activeIndex:g.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}});sj.startListening({actionCreator:vV,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:s}=r.tooltip;if(!s.active&&s.index==null){var a="0",i=S_(r,"axis","hover",String(a));t.dispatch(eN({activeDataKey:void 0,active:!0,activeIndex:a,activeCoordinate:i}))}}}});var dl=Tl("externalEvent"),wV=Jv();wV.startListening({actionCreator:dl,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:Oke(r),activeDataKey:Pke(r),activeIndex:vv(r),activeLabel:EG(r),activeTooltipIndex:vv(r),isTooltipActive:Dke(r)};e.payload.handler(n,e.payload.reactEvent)}}});var U4e=St([lp],e=>e.tooltipItemPayloads),z4e=St([U4e,o1,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var s=e.find(o=>o.settings.dataKey===n);if(s!=null){var{positions:a}=s;if(a!=null){var i=t(a,r);return i}}}),bV=Tl("touchMove"),_V=Jv();_V.startListening({actionCreator:bV,effect:(e,t)=>{var r=e.payload,n=t.getState(),s=BA(n,n.tooltip.settings.shared);if(s==="axis"){var a=rj(n,nj({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));a?.activeIndex!=null&&t.dispatch(xG({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if(s==="item"){var i,o=r.touches[0],l=document.elementFromPoint(o.clientX,o.clientY);if(!l||!l.getAttribute)return;var u=l.getAttribute(b1e),d=(i=l.getAttribute(_1e))!==null&&i!==void 0?i:void 0,h=z4e(t.getState(),u,d);t.dispatch(YSe({activeDataKey:d,activeIndex:u,activeCoordinate:h}))}}});var W4e=Iz({brush:AEe,cartesianAxis:uEe,chartData:dCe,errorBars:wEe,graphicalItems:ZTe,layout:Kve,legend:M1e,options:iCe,polarAxis:$Te,polarOptions:$4e,referenceElements:IEe,rootProps:L4e,tooltip:JSe}),H4e=function(t){return yve({reducer:W4e,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([gV.middleware,mV.middleware,sj.middleware,wV.middleware,_V.middleware]),devTools:tp.devToolsEnabled})};function G4e(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,s=jl(),a=S.useRef(null);if(s)return r;a.current==null&&(a.current=H4e(t));var i=H3;return S.createElement(I4e,{context:i,store:a.current},r)}function V4e(e){var{layout:t,width:r,height:n,margin:s}=e,a=Qi(),i=jl();return S.useEffect(()=>{i||(a(Hve(t)),a(Gve({width:r,height:n})),a(Wve(s)))},[a,i,t,r,n,s]),null}function K4e(e){var t=Qi();return S.useEffect(()=>{t(B4e(e))},[t,e]),null}var q4e=["children"];function Y4e(e,t){if(e==null)return{};var r,n,s=X4e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function X4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function A_(){return A_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},A_.apply(null,arguments)}var J4e={width:"100%",height:"100%"},Q4e=S.forwardRef((e,t)=>{var r=fW(),n=hW(),s=mW();if(!o_(r)||!o_(n))return null;var{children:a,otherAttributes:i,title:o,desc:l}=e,u,d;return typeof i.tabIndex=="number"?u=i.tabIndex:u=s?0:void 0,typeof i.role=="string"?d=i.role:d=s?"application":void 0,S.createElement(lz,A_({},i,{title:o,desc:l,role:d,tabIndex:u,width:r,height:n,style:J4e,ref:t}),a)}),Z4e=e=>{var{children:t}=e,r=Tr(C2);if(!r)return null;var{width:n,height:s,y:a,x:i}=r;return S.createElement(lz,{width:n,height:s,x:i,y:a},t)},dM=S.forwardRef((e,t)=>{var{children:r}=e,n=Y4e(e,q4e),s=jl();return s?S.createElement(Z4e,null,r):S.createElement(Q4e,A_({ref:t},n),r)});function e3e(){var e=Qi(),[t,r]=S.useState(null),n=Tr(w1e);return S.useEffect(()=>{if(t!=null){var s=t.getBoundingClientRect(),a=s.width/t.offsetWidth;oc(a)&&a!==n&&e(Vve(a))}},[t,e,n]),r}function fM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function t3e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fM(Object(r),!0).forEach(function(n){r3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function r3e(e,t,r){return(t=n3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n3e(e){var t=s3e(e,"string");return typeof t=="symbol"?t:t+""}function s3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var a3e=S.forwardRef((e,t)=>{var{children:r,className:n,height:s,onClick:a,onContextMenu:i,onDoubleClick:o,onMouseDown:l,onMouseEnter:u,onMouseLeave:d,onMouseMove:h,onMouseUp:g,onTouchEnd:p,onTouchMove:x,onTouchStart:v,style:w,width:C}=e,k=Qi(),[_,N]=S.useState(null),[E,P]=S.useState(null);wCe();var F=e3e(),A=S.useCallback(I=>{F(I),typeof t=="function"&&t(I),N(I),P(I)},[F,t,N,P]),j=S.useCallback(I=>{k(hV(I)),k(dl({handler:a,reactEvent:I}))},[k,a]),R=S.useCallback(I=>{k(lN(I)),k(dl({handler:u,reactEvent:I}))},[k,u]),U=S.useCallback(I=>{k(pG()),k(dl({handler:d,reactEvent:I}))},[k,d]),Y=S.useCallback(I=>{k(lN(I)),k(dl({handler:h,reactEvent:I}))},[k,h]),Z=S.useCallback(()=>{k(vV())},[k]),ae=S.useCallback(I=>{k(yV(I.key))},[k]),ee=S.useCallback(I=>{k(dl({handler:i,reactEvent:I}))},[k,i]),ne=S.useCallback(I=>{k(dl({handler:o,reactEvent:I}))},[k,o]),L=S.useCallback(I=>{k(dl({handler:l,reactEvent:I}))},[k,l]),H=S.useCallback(I=>{k(dl({handler:g,reactEvent:I}))},[k,g]),M=S.useCallback(I=>{k(dl({handler:v,reactEvent:I}))},[k,v]),V=S.useCallback(I=>{k(bV(I)),k(dl({handler:x,reactEvent:I}))},[k,x]),W=S.useCallback(I=>{k(dl({handler:p,reactEvent:I}))},[k,p]);return S.createElement(OG.Provider,{value:_},S.createElement(Rxe.Provider,{value:E},S.createElement("div",{className:Jn("recharts-wrapper",n),style:t3e({position:"relative",cursor:"default",width:C,height:s},w),onClick:j,onContextMenu:ee,onDoubleClick:ne,onFocus:Z,onKeyDown:ae,onMouseDown:L,onMouseEnter:R,onMouseLeave:U,onMouseMove:Y,onMouseUp:H,onTouchEnd:W,onTouchMove:V,onTouchStart:M,ref:A},r)))}),i3e=["children","className","width","height","style","compact","title","desc"];function o3e(e,t){if(e==null)return{};var r,n,s=l3e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function l3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var c3e=S.forwardRef((e,t)=>{var{children:r,className:n,width:s,height:a,style:i,compact:o,title:l,desc:u}=e,d=o3e(e,i3e),h=F0(d);return o?S.createElement(dM,{otherAttributes:h,title:l,desc:u},r):S.createElement(a3e,{className:n,style:i,width:s,height:a,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},S.createElement(dM,{otherAttributes:h,title:l,desc:u,ref:t},S.createElement(LEe,null,r)))}),u3e=["width","height"];function cN(){return cN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cN.apply(null,arguments)}function d3e(e,t){if(e==null)return{};var r,n,s=f3e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function f3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var h3e={top:5,right:5,bottom:5,left:5},g3e={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:h3e,reverseStackOrder:!1,syncMethod:"index"},m3e=S.forwardRef(function(t,r){var n,s=Pl(t.categoricalChartProps,g3e),{width:a,height:i}=s,o=d3e(s,u3e);if(!o_(a)||!o_(i))return null;var{chartName:l,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:h,categoricalChartProps:g}=t,p={chartName:l,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:h,eventEmitter:void 0};return S.createElement(G4e,{preloadedState:{options:p},reduxStoreName:(n=g.id)!==null&&n!==void 0?n:l},S.createElement(NEe,{chartData:g.data}),S.createElement(V4e,{width:a,height:i,layout:s.layout,margin:s.margin}),S.createElement(K4e,{accessibilityLayer:s.accessibilityLayer,barCategoryGap:s.barCategoryGap,maxBarSize:s.maxBarSize,stackOffset:s.stackOffset,barGap:s.barGap,barSize:s.barSize,syncId:s.syncId,syncMethod:s.syncMethod,className:s.className}),S.createElement(c3e,cN({},o,{width:a,height:i,ref:r})))}),p3e=["axis"],x3e=S.forwardRef((e,t)=>S.createElement(m3e,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:p3e,tooltipPayloadSearcher:sCe,categoricalChartProps:e,ref:t}));const y3e=({data:e=[],loading:t=!1,error:r=null})=>{if(t)return c.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"400px"},children:c.jsx("div",{className:"spinner-border text-primary",role:"status",children:c.jsx("span",{className:"visually-hidden",children:"Loading..."})})});if(r)return c.jsxs("div",{className:"alert alert-danger",role:"alert",children:[c.jsx("h5",{className:"alert-heading",children:"Error Loading Performance Data"}),c.jsx("p",{children:r})]});if(!e||e.length===0)return c.jsx("div",{className:"text-center text-muted",style:{height:"400px",display:"flex",alignItems:"center",justifyContent:"center"},children:c.jsxs("div",{children:[c.jsx("h5",{children:"No Test Data Available"}),c.jsx("p",{children:"No tests have been completed yet for the current term."})]})});const n=e.map(s=>({testName:s.test_name,testDate:s.submitted_at,averageScore:parseFloat(s.average_score),totalStudents:s.total_students,testId:s.test_id}));return c.jsxs("div",{className:"test-performance-graph",children:[c.jsx("div",{style:{width:"100%",height:"400px"},children:c.jsx(LCe,{children:c.jsxs(x3e,{data:n,margin:{top:20,right:30,left:20,bottom:20},children:[c.jsx(nV,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),c.jsx(dV,{dataKey:"testDate",tickFormatter:s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric"}),stroke:"#666",fontSize:12}),c.jsx(fV,{domain:[0,100],tickFormatter:s=>`${s}%`,stroke:"#666",fontSize:12}),c.jsx(NCe,{formatter:(s,a)=>[`${parseFloat(s).toFixed(1)}%`,"Average Score"],labelFormatter:s=>{const a=n.find(i=>i.testDate===s);if(a){const i=new Date(s);return`${a.testName} (${i.toLocaleDateString("en-US",{month:"long",day:"numeric"})})`}return s},contentStyle:{backgroundColor:"#fff",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),c.jsx(uV,{type:"monotone",dataKey:"averageScore",stroke:"#007bff",strokeWidth:3,connectNulls:!0,dot:{r:6,fill:"#007bff",stroke:"#fff",strokeWidth:2},activeDot:{r:8,fill:"#ff6b35",stroke:"#fff",strokeWidth:2}})]})})}),c.jsx("div",{className:"mt-3",children:c.jsxs("div",{className:"row",children:[c.jsx("div",{className:"col-md-3",children:c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"text-muted",children:"Total Tests: "}),c.jsx("strong",{children:n.length})]})}),c.jsx("div",{className:"col-md-3",children:c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"text-muted",children:"Average Score: "}),c.jsx("strong",{children:n.length>0?(()=>{const s=n.filter(i=>i.averageScore!==null&&i.averageScore!==void 0&&!isNaN(i.averageScore));return s.length===0?"N/A":`${(s.reduce((i,o)=>i+o.averageScore,0)/s.length).toFixed(1)}%`})():"N/A"})]})}),c.jsx("div",{className:"col-md-3",children:c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"text-muted",children:"Best Test: "}),c.jsx("strong",{children:n.length>0?(()=>{const s=n.filter(a=>a.averageScore!==null&&a.averageScore!==void 0&&!isNaN(a.averageScore));return s.length===0?"N/A":s.reduce((a,i)=>i.averageScore>a.averageScore?i:a).testName})():"N/A"})]})}),c.jsx("div",{className:"col-md-3",children:c.jsxs("div",{className:"text-center",children:[c.jsx("span",{className:"text-muted",children:"Latest Test: "}),c.jsx("strong",{children:n.length>0?n[n.length-1].testName:"N/A"})]})})]})})]})},hM=({onBackToLogin:e})=>{const t=vo(),{user:r,isAuthenticated:n,logout:s,getCurrentTeacherUsername:a}=Qn(),{teacherData:i,loadTeacherData:o}=r2(),{activeTests:l,loadActiveTests:u}=$v(),{showNotification:d,notifications:h}=Da(),[g,p]=S.useState(!0),[x,v]=S.useState(""),[w,C]=S.useState("main"),[k,_]=S.useState([]),[N,E]=S.useState([]),[P,F]=S.useState(null),[A,j]=S.useState(null),[R,U]=S.useState(null),[Y,Z]=S.useState(!1),[ae,ee]=S.useState(!1),[ne,L]=S.useState(null),[H,M]=S.useState(!1),[V,W]=S.useState(null),[I,B]=S.useState(!1),[q,J]=S.useState(null),[se,X]=S.useState(null),[ie,le]=S.useState([]),[ce,ke]=S.useState(!1),[re,ge]=S.useState(null),[Ne,je]=S.useState([]),[Ke,Ue]=S.useState(!1),[It,rt]=S.useState(null),[wt,xt]=S.useState(null),[lt,pt]=S.useState(!1),[Rt,Mt]=S.useState(!1),[Qe,Re]=S.useState(0),[Be,ct]=S.useState(!1),[We,nt]=S.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[Tt,jt]=S.useState([]),[Vt,fr]=S.useState([]),[Dr,zr]=S.useState(!1),[or,nr]=S.useState(!1),[me,Ae]=S.useState(null),[Fe,Me]=S.useState([]),[kt,Oe]=S.useState(!1),[at,Ce]=S.useState("subject");S.useEffect(()=>{Wr()},[]),S.useEffect(()=>{const we=$e=>{lt&&!$e.target.closest(".relative")&&pt(!1),Rt&&!$e.target.closest(".relative")&&Mt(!1)};return document.addEventListener("mousedown",we),()=>{document.removeEventListener("mousedown",we)}},[lt,Rt]);const Ve=S.useCallback(()=>{pe.debug(" showChangePasswordTab called"),ct(!0),pt(!1),Mt(!1)},[]),Ze=S.useCallback(()=>{pe.debug(" hideChangePasswordTab called"),ct(!1),nt({currentPassword:"",newPassword:"",confirmPassword:""})},[]),Ft=S.useCallback(async()=>{if(!r)return;const{currentPassword:we,newPassword:$e,confirmPassword:Le}=We;if(!we||!$e||!Le){d("Please fill in all fields","error");return}if($e!==Le){d("New passwords do not match","error");return}if($e.length<6){d("New password must be at least 6 characters long","error");return}const Et=/[a-zA-Z]/.test($e),Nt=/[0-9]/.test($e);if(!Et||!Nt){d("New password must contain both letters and numbers","error");return}try{const mr=await ns.changePassword({username:r.username,currentPassword:we,newPassword:$e});mr.success?(d("Password changed successfully!","success"),Ze()):d(mr.message||"Failed to change password","error")}catch(mr){pe.error("Password change error:",mr),d("Failed to change password. Please try again.","error")}},[r,We,d]),zt=S.useCallback(we=>{const{name:$e,value:Le}=we.target;nt(Et=>({...Et,[$e]:Le}))},[]),er=S.useCallback(async()=>{pe.debug(" Loading teacher data...");try{const we=await ns.getTeacherData();return pe.debug(" Teacher data loaded:",we),X(new Date),we}catch(we){throw pe.error(" Error loading teacher data:",we),we}},[]),hr=S.useCallback(async(we=null)=>{pe.debug(" Loading teacher subjects...");try{if(!we){const Et=`teacher_subjects_${r?.teacher_id||r?.id||""}`,Nt=Es(Et);if(Nt)return pe.debug(" Using cached teacher subjects"),_(Nt),Nt}let $e=we,Le;if(we?(pe.debug(" Using passed teacher data for subjects"),Le=ns.getTeacherSubjects(we.subjects)):(pe.debug(" No teacher data passed, fetching from API"),$e=await ns.getTeacherData(),pe.debug(" Raw teacher data:",$e),Le=ns.getTeacherSubjects($e.subjects)),pe.debug(" Teacher subjects loaded:",Le),_(Le),!we){const Et=`teacher_subjects_${r?.teacher_id||r?.id||""}`;us(Et,Le,Ts.teacher_subjects)}return pe.debug(" Available classes for performance chart:",Le[0]?.classes||[]),pe.debug(" Performance chart will load when user clicks on a class"),Le}catch($e){throw pe.error(" Error loading teacher subjects:",$e),$e}},[r?.teacher_id,r?.id]),ir=S.useCallback(async()=>{pe.debug(" Loading teacher active tests...");try{const we=`teacher_tests_${r?.teacher_id||r?.id||""}`,$e=Es(we);$e&&$e.some(Nt=>Nt.test_type==="drawing")&&(pe.debug(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(we));const Le=Es(we);if(Le)return pe.debug(" Using cached teacher tests"),E(Le),Le;const Et=await cn.getTeacherTests();return pe.debug(" Teacher tests loaded:",Et),E(Et),us(we,Et,Ts.teacher_tests),Et}catch(we){throw pe.error(" Error loading teacher tests:",we),we}},[r?.teacher_id,r?.id]),Wr=S.useCallback(async()=>{pe.debug(" Initializing Teacher Cabinet...");try{if(p(!0),v(""),!n||!r){pe.debug(" User not authenticated"),v("User not authenticated");return}if(r.role!==Hi.TEACHER){pe.error(" Invalid user role for teacher cabinet:",r.role),v("Access denied. Teacher role required.");return}pe.debug(" Loading teacher data...");const we=await er();pe.debug(" Loading subjects and tests in parallel...");const[$e,Le]=await Promise.allSettled([hr(we),ir()]);let Et=!1;$e.status==="rejected"&&(pe.warn(" Subjects loading failed:",$e.reason),Et=!0),Le.status==="rejected"&&(pe.warn(" Tests loading failed:",Le.reason),Et=!0),Et&&d("Some data failed to load, but you can continue","warning"),pe.debug(" Teacher Cabinet initialization complete!")}catch(we){pe.error(" Error initializing teacher cabinet:",we),v("Failed to initialize teacher cabinet")}finally{p(!1)}},[n,r,er,hr,ir,d]),ue=S.useCallback(()=>{pe.debug(" Showing subject selection prompt..."),Z(!0),be(),Ce("subject")},[]),be=S.useCallback(async()=>{pe.debug(" Loading available subjects..."),zr(!0);try{const we=await ns.getSubjectsForSelection();jt(we),pe.debug(" Available subjects loaded:",we)}catch(we){pe.error(" Error loading available subjects:",we),d("Failed to load subjects","error")}finally{zr(!1)}},[]),ye=S.useCallback(we=>{if(!we){Ae(null);return}const $e=Tt.find(Le=>Le.subject_id==we);$e&&(Ae($e),Me([]),Ce("classes"))},[Tt]),xe=S.useCallback((we,$e)=>{Me(Le=>Le.some(Et=>Et.grade===we&&Et.class===$e)?Le.filter(Et=>!(Et.grade===we&&Et.class===$e)):[...Le,{grade:we,class:$e}])},[]),_e=S.useCallback(()=>{if(!me||Fe.length===0){d("Please select at least one class","warning");return}const we={subject_id:parseInt(me.subject_id),subject_name:me.subject,classes:Fe};fr($e=>[...$e,we]),Ae(null),Me([]),Ce("subject"),d(`Added ${me.subject} with ${Fe.length} classes`,"success")},[me,Fe]),Se=S.useCallback(we=>{fr($e=>$e.filter((Le,Et)=>Et!==we))},[]),He=S.useCallback(async(we,$e,Le)=>{pe.debug(" Deleting teacher subject:",{subjectId:we,grade:$e,classNumber:Le});try{const Et={subjectId:we,grade:$e,class:Le};pe.debug(" Sending delete request with data:",Et);const Nt=await ns.deleteTeacherSubject(Et);if(Nt.success)d("Subject assignment deleted successfully!","success"),await hr();else throw new Error(Nt.error||"Failed to delete subject assignment")}catch(Et){pe.error(" Error deleting subject assignment:",Et),d("Error deleting subject assignment. Please try again.","error")}},[hr,d]),it=S.useCallback((we,$e,Le,Et)=>{J({subjectId:we,subjectName:$e,grade:Le,classNumber:Et}),B(!0)},[]),Ye=S.useCallback(async()=>{q&&(await He(q.subjectId,q.grade,q.classNumber),B(!1),J(null))},[q,He]),oe=S.useCallback(()=>{B(!1),J(null)},[]),fe=S.useCallback(async()=>{if(Vt.length===0){d("Please select at least one subject","warning");return}nr(!0);try{const we=await ns.saveTeacherSubjects(Vt);if(we.success)d("Subjects saved successfully!","success"),Z(!1),fr([]),Ce("subject"),await hr();else throw new Error(we.error||"Failed to save subjects")}catch(we){pe.error(" Error saving teacher subjects:",we),d("Failed to save subjects","error")}finally{nr(!1)}},[Vt,hr]);S.useCallback(async we=>{pe.debug(" Saving teacher subjects:",we);try{const $e=await ns.saveTeacherSubjects(we);if($e.success)d("Subjects saved successfully!","success"),await hr(),Z(!1);else throw new Error($e.error||"Failed to save subjects")}catch($e){pe.error(" Error saving teacher subjects:",$e),d("Failed to save subjects","error")}},[hr]);const Te=S.useCallback(()=>{pe.debug(" Showing active tests..."),C("tests")},[]),Ee=S.useCallback(we=>{pe.debug(" Showing test details:",we),L(we),ee(!0)},[]);S.useCallback(async(we,$e,Le)=>{pe.debug(" Removing class assignment:",we,$e,Le);try{const Et=await cn.removeClassAssignment(we,$e,Le);if(Et.success)d("Assignment removed successfully!","success"),await ir();else throw new Error(Et.error||"Failed to remove assignment")}catch(Et){pe.error(" Error removing class assignment:",Et),d("Failed to remove assignment","error")}},[ir]);const Xe=S.useCallback(async(we,$e)=>{pe.debug(" Marking test as completed:",we,$e),ge($e);try{const Le=await cn.markTestCompleted(we,$e);if(Le.success){d("Test marked as completed!","success");const Et=`teacher_tests_${r?.teacher_id||r?.id||""}`;localStorage.removeItem(Et),pe.debug(" Cleared teacher tests cache"),await ir()}else throw new Error(Le.error||"Failed to mark test as completed")}catch(Le){pe.error(" Error marking test as completed:",Le),d("Failed to mark test as completed","error")}finally{ge(null)}},[ir,d,r?.teacher_id,r?.id]),ut=S.useCallback(async()=>{pe.debug(" Refreshing active tests data...");try{const we=`teacher_tests_${r?.teacher_id||r?.id||""}`;localStorage.removeItem(we),pe.debug(" Cache cleared, forcing fresh API call"),pe.debug(" Making direct API call to get-teacher-active-tests with noCache");const $e=await cn.getTeacherTests(!0);pe.debug(" Direct API call returned:",$e),E($e),pe.debug(" activeTestsData state updated:",$e),d(`Tests refreshed successfully! Found ${$e?.length||0} tests.`,"success")}catch(we){pe.error(" Error refreshing tests:",we),d("Failed to refresh tests","error")}},[r?.teacher_id,r?.id]),ft=S.useCallback(async(we=null)=>{if(r?.teacher_id){Ue(!0),rt(null);try{pe.debug(" Loading test performance data for class:",we);const $e=await pxe.getTestPerformance(r.teacher_id,we);je($e),pe.debug(" Test performance data loaded:",$e.length,"tests")}catch($e){pe.error(" Error loading test performance data:",$e),rt($e.message)}finally{Ue(!1)}}},[r?.teacher_id]);S.useCallback((we,$e)=>{pe.debug(" Showing class results:",we,$e),pe.debug(" Class click - grade:",we,"className:",$e),j(we),U($e),C("results");const Le=`${we}/${$e}`;pe.debug(" Loading performance data for clicked class:",Le),xt(Le),ft(Le)},[ft]);const[Kt,Ct]=S.useState([]),[Ht,yr]=S.useState([]),wr=S.useCallback(async()=>{try{const $e=await(await Gi(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestAssignments(r.teacher_id);Ct($e)}catch(we){pe.warn("Failed to load retests",we)}},[r]);S.useCallback(async we=>{try{const Le=await(await Gi(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestTargets(we);yr(Le)}catch($e){pe.warn("Failed to load retest targets",$e)}},[]);const[vr,Er]=S.useState(!1),[qr,Hr]=S.useState(!1);S.useEffect(()=>{pe.debug("[TeacherCabinet] showRetestModal state changed:",vr)},[vr]);const[he,vt]=S.useState({test_type:"",original_test_id:"",subject_id:"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:[]}),xr=S.useCallback(async we=>{pe.debug("[TeacherCabinet] openRetestModal called with:",we);const{test_type:$e,original_test_id:Le,subject_id:Et,failedStudentIds:Nt=[],grade:mr,class:an}=we||{};vt({test_type:$e||"multiple_choice",original_test_id:Le||"",subject_id:Et||"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:Nt}),mr!==void 0&&j(mr),an!==void 0&&U(an),pe.debug("[TeacherCabinet] Setting showRetestModal to true"),Er(!0)},[]),br=S.useCallback(async()=>{Hr(!0);try{const we=await Gi(()=>import("./retestService-C6b0YDiD.js"),[]),$e=new Date,Le=new Date($e.getTime()+he.window_days*24*60*60*1e3),Et={...he,teacher_id:r.teacher_id,grade:A,class:R,window_start:$e.toISOString(),window_end:Le.toISOString()};pe.debug("[Retest][TeacherCabinet] Prepared payload:",JSON.stringify(Et)),pe.debug("[Retest][TeacherCabinet] Selected students count:",(Et.student_ids||[]).length,"IDs:",Et.student_ids),await we.retestService.createRetestAssignment(Et),d("Retest created","success"),Er(!1),wr(),Re(Nt=>Nt+1)}catch(we){pe.error("Create retest error",we),d(we.message||"Failed to create retest","error")}finally{Hr(!1)}},[he,A,R,wr]);if(g)return c.jsxs("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:[c.jsxs("div",{className:"text-center",children:[c.jsx(Ur,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Cabinet..."})]}),c.jsx("div",{className:"flex flex-wrap gap-2"})]});if(x)return c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Cabinet Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:x}),c.jsx(Je,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return c.jsxs(st.div,{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsx(st.div,{className:"bg-gradient-to-r from-sky-400 to-sky-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-6",children:[c.jsxs(st.div,{className:"flex-1 text-center",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white mb-2",children:"Teacher Cabinet"}),c.jsxs("p",{className:"text-sky-100 text-sm sm:text-base md:text-lg",children:["Welcome, Teacher ",a()||""]})]}),c.jsxs(st.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsx("div",{className:"hidden md:block",children:c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>pt(!lt),className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border border-white/20 text-white hover:bg-white/20 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:[c.jsx("span",{className:"hidden sm:inline text-xs sm:text-sm font-medium",children:"Menu"}),c.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 transition-transform duration-200",style:{transform:lt?"rotate(180deg)":"rotate(0deg)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),lt&&c.jsxs(st.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[c.jsxs("button",{onClick:()=>{pt(!1),Ve()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),c.jsx("span",{children:"Change Password"})]}),c.jsxs("button",{onClick:()=>{pt(!1),e?e():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),c.jsx("span",{children:"Logout"})]})]})]})}),c.jsxs("div",{className:"md:hidden",children:[c.jsx("button",{onClick:()=>Mt(!Rt),className:"flex items-center justify-center w-10 h-10 bg-white/10 border border-white/20 text-white hover:bg-white/20 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),Rt&&c.jsxs(st.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[c.jsxs("div",{className:"px-4 py-2 border-b border-gray-200",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:a()||"Teacher"}),c.jsx("p",{className:"text-xs text-gray-500",children:"Teacher Account"})]}),c.jsxs("button",{onClick:()=>{Mt(!1),Ve()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),c.jsx("span",{children:"Change Password"})]}),c.jsxs("button",{onClick:()=>{Mt(!1),e?e():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),c.jsx("span",{children:"Logout"})]})]})]})]})]})})}),c.jsx(st.div,{className:"bg-white border-b shadow-sm",initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},children:c.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:c.jsx("nav",{className:"flex space-x-1 sm:space-x-8 overflow-x-auto",children:[{key:"main",label:"Main Dashboard",shortLabel:"Dashboard"},{key:"tests",label:"Test Management",shortLabel:"Tests"},{key:"results",label:"Class Results",shortLabel:"Results"},{key:"subjects",label:"Subject Management",shortLabel:"Subjects"}].map((we,$e)=>c.jsxs(st.button,{onClick:()=>we.key==="tests"?Te():C(we.key),className:`py-2 sm:py-4 px-2 sm:px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors duration-200 whitespace-nowrap flex-shrink-0 flex-1 sm:flex-none ${w===we.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5+$e*.1,duration:.3},whileHover:{scale:1.05},whileTap:{scale:.95},children:[c.jsx("span",{className:"sm:hidden",children:we.shortLabel}),c.jsx("span",{className:"hidden sm:inline",children:we.label})]},we.key))})})}),c.jsx(st.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:c.jsxs(fo,{mode:"wait",children:[w==="main"&&c.jsx(st.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Bn()},"main"),w==="subjects"&&c.jsx(st.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:An()},"subjects"),w==="tests"&&c.jsx(st.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:et()},"tests"),w==="results"&&c.jsx(st.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:c.jsx(ez,{selectedGrade:A,selectedClass:R,onBackToCabinet:()=>C("main"),openRetestModal:xr,forceRefreshOnMount:Qe>0},Qe)},"results")]})}),Y&&c.jsx(da,{isOpen:Y,onClose:()=>{Z(!1),Ce("subject"),fr([]),Ae(null),Me([])},title:"Select Subjects and Classes",size:"large",children:c.jsxs("div",{className:"space-y-6 px-4 max-h-[80vh] overflow-y-auto",children:[at==="subject"&&c.jsxs(st.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Step 1: Select Subject"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the subject you want to teach:"}),Dr?c.jsxs("div",{className:"flex items-center justify-center py-8",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),c.jsx("span",{className:"ml-2 text-gray-600",children:"Loading subjects..."})]}):c.jsxs("select",{value:me?.subject_id||"",onChange:we=>ye(we.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"Select a subject"}),Tt.map(we=>c.jsx("option",{value:we.subject_id,children:we.subject},we.subject_id))]})]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx(Je,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),c.jsx(Je,{variant:"primary",onClick:()=>Ce("classes"),disabled:!me,children:"Next: Select Classes"})]})]}),at==="classes"&&me&&c.jsxs(st.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["Step 2: Select Classes for ",me.subject]}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the classes you teach for this subject:"}),c.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:c.jsx("div",{className:"grid grid-cols-3 gap-3",children:[1,2,3,4,5,6,7].map(we=>{let $e;return we===1||we===2||we===3?$e=[15,16]:we===4||we===5||we===6?$e=[13,14]:we===7?$e=[69]:$e=[],c.jsxs("div",{className:"space-y-2",children:[c.jsxs("h4",{className:"font-medium text-gray-700 text-sm",children:["Grade ",we]}),c.jsx("div",{className:"space-y-1",children:$e.map(Le=>c.jsxs("label",{className:"flex items-center space-x-2 py-1",children:[c.jsx("input",{type:"checkbox",checked:Fe.some(Et=>Et.grade===we.toString()&&Et.class===Le.toString()),onChange:()=>xe(we.toString(),Le.toString()),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),c.jsxs("span",{className:"text-xs text-gray-700",children:["Class ",Le]})]},Le))})]},we)})})})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx(Je,{variant:"outline",onClick:()=>Ce("subject"),children:"Back to Subjects"}),c.jsxs("div",{className:"space-x-3",children:[c.jsx(Je,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),c.jsx(Je,{variant:"primary",onClick:_e,disabled:Fe.length===0,children:"Add Subject"})]})]})]}),Vt.length>0&&c.jsxs(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Selected Subjects"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Review your selected subjects and classes:"}),c.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:Vt.map((we,$e)=>c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900",children:we.subject_name}),c.jsxs("p",{className:"text-sm text-gray-600",children:["Classes: ",we.classes.map(Le=>`Grade ${Le.grade} Class ${Le.class}`).join(", ")]})]}),c.jsx("button",{onClick:()=>Se($e),className:"text-red-600 hover:text-red-800 p-1",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},$e))})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx(Je,{variant:"outline",onClick:()=>Ce("subject"),children:"Add More Subjects"}),c.jsxs("div",{className:"space-x-3",children:[c.jsx(Je,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),c.jsx(Je,{variant:"primary",onClick:fe,disabled:or,className:"relative",children:or?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save All Subjects"})]})]})]})]})}),vr&&c.jsxs(da,{isOpen:vr,onClose:()=>Er(!1),title:"Create Retest",size:"medium",children:[c.jsx("div",{className:"space-y-4",children:c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Retest Window"}),c.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:he.window_days,onChange:we=>vt($e=>({...$e,window_days:Number(we.target.value)})),children:[c.jsx("option",{value:1,children:"1 day"}),c.jsx("option",{value:2,children:"2 days"}),c.jsx("option",{value:3,children:"3 days"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Attempts"}),c.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:he.max_attempts,onChange:we=>vt($e=>({...$e,max_attempts:Number(we.target.value)})),children:[c.jsx("option",{value:1,children:"1 attempt"}),c.jsx("option",{value:2,children:"2 attempts"}),c.jsx("option",{value:3,children:"3 attempts"})]}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Students can retry immediately if they fail"})]})]})}),c.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[c.jsx("button",{onClick:()=>Er(!1),disabled:qr,className:"px-4 py-2 text-sm rounded border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),c.jsx("button",{onClick:br,disabled:qr,className:"px-4 py-2 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:qr?c.jsxs(c.Fragment,{children:[c.jsx(Ur,{size:"sm"}),"Creating Retest..."]}):"Create Retest"})]})]}),ae&&ne&&c.jsxs(da,{isOpen:ae,onClose:()=>ee(!1),title:"Test Details",size:"large",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Name:"}),c.jsx("p",{className:"text-sm text-gray-900",children:ne.test_name})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Subject:"}),c.jsx("p",{className:"text-sm text-gray-900",children:ne.subject})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Type:"}),c.jsx("p",{className:"text-sm text-gray-900",children:ne.test_type})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Created:"}),c.jsx("p",{className:"text-sm text-gray-900",children:new Date(ne.created_at).toLocaleDateString()})]}),ne.assignments&&ne.assignments.length>0&&c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Classes:"}),c.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:ne.assignments.map((we,$e)=>c.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:[we.grade,"/",we.class]},$e))})]})]}),c.jsx("div",{className:"flex justify-end space-x-3 mt-6",children:c.jsx(Je,{variant:"outline",onClick:()=>ee(!1),children:"Close"})})]}),I&&q&&c.jsx(da,{isOpen:I,onClose:oe,title:"Delete Subject Assignment",size:"small",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:c.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Subject Assignment"}),c.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Are you sure you want to delete the assignment for"," ",c.jsx("span",{className:"font-semibold text-gray-900",children:q.subjectName})," ","in Grade ",q.grade,", Class ",q.classNumber,"?"]}),c.jsx("p",{className:"text-xs text-red-600",children:"This action cannot be undone."})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[c.jsx(Je,{variant:"outline",onClick:oe,children:"Cancel"}),c.jsx(Je,{variant:"danger",onClick:Ye,children:"Delete Assignment"})]})]})}),c.jsx(st.div,{className:"fixed top-4 right-4 space-y-2 z-50",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.8,duration:.5},children:h.map(we=>c.jsx(st.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.3},children:c.jsx("div",{className:`p-4 rounded-lg shadow-lg ${we.type==="success"?"bg-green-600 text-white":we.type==="error"?"bg-red-600 text-white":we.type==="warning"?"bg-yellow-600 text-white":"bg-blue-600 text-white"}`,children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{children:we.message}),c.jsx("button",{onClick:()=>setNotifications($e=>$e.filter(Le=>Le.id!==we.id)),className:"ml-4 text-white hover:text-gray-200",children:""})]})})},we.id))}),Be&&c.jsx(da,{isOpen:Be,onClose:Ze,title:"Change Password",size:"small",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),c.jsx("input",{type:"password",name:"currentPassword",value:We.currentPassword,onChange:zt,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter current password"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),c.jsx("input",{type:"password",name:"newPassword",value:We.newPassword,onChange:zt,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter new password"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),c.jsx("input",{type:"password",name:"confirmPassword",value:We.confirmPassword,onChange:zt,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Confirm new password"})]}),c.jsxs("div",{className:"flex space-x-3 pt-4",children:[c.jsx(Je,{type:"button",variant:"secondary",onClick:Ze,className:"flex-1",children:"Cancel"}),c.jsx(Je,{type:"button",onClick:Ft,className:"flex-1",children:"Change Password"})]})]})})]});function Bn(){return c.jsxs("div",{className:"space-y-8",children:[c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:c.jsxs(At,{children:[c.jsx(At.Header,{children:c.jsx(At.Title,{children:"My Subjects & Classes"})}),c.jsx(At.Body,{children:k.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned"}),c.jsx("p",{className:"text-gray-500 mb-4",children:"You don't have any subjects assigned yet."}),c.jsx(Je,{variant:"outline",onClick:()=>C("subjects"),children:"Manage Subjects"})]}):c.jsx("div",{className:"space-y-6",children:k.map((we,$e)=>c.jsxs(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+$e*.1,duration:.3},className:"border border-gray-200 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:we.name}),c.jsxs("span",{className:"text-sm text-gray-500",children:[we.classes?.length||0," classes"]})]}),we.classes&&we.classes.length>0?c.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:we.classes.map((Le,Et)=>c.jsx(st.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3+$e*.1+Et*.05,duration:.2},whileHover:{scale:1.05},whileTap:{scale:.95},children:c.jsxs(Je,{variant:"outline",size:"sm",onClick:()=>{j(Le.grade),U(Le.class),C("results")},className:"font-medium",children:[Le.grade,"/",Le.class]})},Et))}):c.jsx("div",{className:"text-center py-4 text-gray-500",children:c.jsx("span",{className:"text-sm",children:"No classes assigned to this subject"})})]},we.id))})})]})}),c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},children:c.jsxs(At,{children:[c.jsxs(At.Header,{children:[c.jsx(At.Title,{children:"Test Performance Overview"}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Test performance over time with average scores"})]}),c.jsx(At.Body,{children:k.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"mb-2",children:c.jsx("img",{src:"/pics/Graph.png",alt:"Performance Graph",className:"w-16 h-16 object-contain mx-auto"})}),c.jsx("p",{className:"text-gray-500",children:"No subjects assigned - no performance data available"})]}):c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex flex-wrap gap-2 border-b border-gray-200",children:(()=>{const we=[];return k.forEach($e=>{$e.classes&&$e.classes.forEach(Le=>{const Et=`${Le.grade}/${Le.class}`;we.find(Nt=>Nt.key===Et)||we.push({key:Et,grade:Le.grade,class:Le.class,subject:$e.name})})}),we})().map((we,$e)=>c.jsxs("button",{onClick:()=>{pe.debug(" Class button clicked:",we.key),xt(we.key),ft(we.key)},className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${wt===we.key?"bg-blue-100 text-blue-700 border-b-2 border-blue-500":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[we.grade,"/",we.class]},we.key))}),wt?c.jsx("div",{className:"mt-4",children:c.jsx(y3e,{data:Ne,loading:Ke,error:It})}):c.jsxs("div",{className:"mt-4 text-center text-muted py-4",children:[c.jsx("div",{className:"mb-2",children:c.jsx("img",{src:"/pics/Graph.png",alt:"Performance Graph",className:"w-16 h-16 object-contain mx-auto"})}),c.jsx("p",{className:"text-gray-500",children:"Select a class above to view test performance data"})]})]})})]})})]})}function An(){return c.jsxs("div",{className:"space-y-8",children:[c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:c.jsx(At,{children:c.jsx(At.Header,{children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx(At.Title,{children:"Subject Management"}),c.jsx(Je,{variant:"primary",onClick:ue,children:"Add Subject"})]})})})}),k.length===0?c.jsx(st.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:c.jsx(At,{children:c.jsx(At.Body,{children:c.jsxs("div",{className:"text-center p-12",children:[c.jsx(st.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No subjects assigned yet"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Add your first subject to get started with creating tests and managing classes."}),c.jsx(Je,{variant:"primary",onClick:ue,size:"lg",children:"Add Your First Subject"})]})})})}):c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:c.jsxs(At,{children:[c.jsx(At.Header,{children:c.jsx(At.Title,{children:"Your Subjects"})}),c.jsx(At.Body,{children:c.jsx("div",{className:"space-y-4",children:k.map((we,$e)=>c.jsx(st.div,{className:"p-4 bg-gray-50 rounded-lg border-l-4 border-green-500",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3+$e*.1,duration:.3},whileHover:{scale:1.02,backgroundColor:"#f9fafb"},children:c.jsx("div",{className:"flex justify-between items-start",children:c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:we.name}),c.jsx("div",{className:"flex flex-wrap gap-2",children:we.classes?.map((Le,Et)=>c.jsxs(st.div,{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-800 text-xs rounded-full px-3 py-1",initial:{scale:0},animate:{scale:1},transition:{delay:.4+$e*.1+Et*.05,duration:.2},whileHover:{scale:1.1},children:[c.jsxs("span",{children:[Le.grade," - ",Le.className]}),c.jsx("button",{onClick:()=>it(we.id,we.name,Le.grade,Le.class),className:"ml-1 text-red-600 hover:text-red-800 transition-colors",title:"Delete this subject assignment",children:c.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},Et))||c.jsx("span",{className:"text-gray-500 text-sm",children:"No classes assigned"})})]})})},$e))})})]})})]})}function et(){return c.jsxs("div",{className:"space-y-8",children:[c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:c.jsx(At,{children:c.jsx(At.Header,{children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx(At.Title,{children:"Active Tests"}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx(Je,{variant:"outline",onClick:ut,children:"Refresh"}),c.jsx(Je,{variant:"primary",onClick:()=>t("/teacher/tests/create"),children:"Create New Test"})]})]})})})}),N.length===0?c.jsx(st.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:c.jsx(At,{children:c.jsx(At.Body,{children:c.jsxs("div",{className:"text-center p-12",children:[c.jsx(st.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No active tests found"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first test to get started with assessments."}),c.jsx(Je,{variant:"primary",onClick:()=>t("/teacher/tests/create"),size:"lg",children:"Create Your First Test"})]})})})}):c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"space-y-4",children:N.map((we,$e)=>c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3+$e*.1,duration:.3},whileHover:{scale:1.01},children:c.jsx(At,{children:c.jsx(At.Body,{children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{className:"flex-1 flex items-center space-x-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 min-w-0 flex-shrink-0",children:we.test_name}),c.jsx("span",{className:"hidden sm:inline-block bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium flex-shrink-0",children:we.test_type}),c.jsxs("div",{className:"hidden sm:flex items-center space-x-4",children:[c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[c.jsx("span",{className:"font-medium",children:"Assignments:"}),c.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:we.assignments?.length||0})]}),we.assignments&&we.assignments.length>0&&c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[c.jsx("span",{className:"font-medium",children:"Classes:"}),c.jsx("div",{className:"flex flex-wrap gap-1",children:we.assignments.map((Le,Et)=>c.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:[Le.grade,"/",Le.class]},Et))})]}),c.jsx("div",{className:"text-sm text-gray-500 flex-shrink-0",children:new Date(we.created_at).toLocaleDateString()})]})]}),c.jsxs("div",{className:"flex gap-2 ml-4 flex-shrink-0",children:[c.jsx("div",{className:"sm:hidden",children:c.jsx(Je,{variant:"outline",onClick:()=>Ee(we),size:"sm",className:"text-xs",title:`Type: ${we.test_type} | Assignments: ${we.assignments?.length||0} | Classes: ${we.assignments?.map(Le=>`${Le.grade}/${Le.class}`).join(", ")||"None"} | ${new Date(we.created_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}`,children:"Details"})}),c.jsx("div",{className:"hidden sm:block",children:c.jsx(Je,{variant:"outline",onClick:()=>Ee(we),size:"sm",children:"Details"})}),c.jsx(Je,{variant:"success",onClick:()=>Xe(we.test_type,we.test_id),size:"sm",disabled:re===we.test_id,children:re===we.test_id?c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Completing..."]}):"Complete"})]})]})})})},$e))})]})}},v3e={multipleChoice:"multiple_choice",trueFalse:"true_false",input:"input",matching:"matching_type",wordMatching:"word_matching",drawing:"drawing",fillBlanks:"fill_blanks",speaking:"speaking"},gM=()=>{const{user:e}=Qn();Zse();const{notifications:t,showNotification:r,removeNotification:n}=Da(),[s,a]=S.useState(!1),[i,o]=S.useState(!1),[l,u]=S.useState("typeSelection"),[d,h]=S.useState(!1),[g,p]=S.useState(null),[x,v]=S.useState([]),[w,C]=S.useState(!1),[k,_]=S.useState(!1),[N,E]=S.useState(!1),[P,F]=S.useState(!1),[A,j]=S.useState({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:"",isShuffled:!1}),[R,U]=S.useState([]),[Y,Z]=S.useState(null);S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null);const ae=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in initializeTestCreation, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" Setting up test creation event listeners..."),W(),console.log(" Test creation initialization complete")},[e,r]),ee=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestTypeSelection, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" showTestTypeSelection called - starting new test creation"),o(!1),console.log(" Reset testAssignmentCompleted flag to false"),a(!0),console.log(" Set isInTestCreation flag to true"),ne(),u("typeSelection"),H("testTypeSelection")},[e,r]),ne=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in disableNavigationButtons, redirecting to login");return}console.log(" Disabling navigation buttons..."),h(!0)},[e]),L=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in enableNavigationButtons, redirecting to login");return}console.log(" Enabling navigation buttons..."),h(!1)},[e]),H=S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveTestCreationState, redirecting to login");return}console.log("  saveTestCreationState called with step:",oe),console.log("  Call stack:",new Error().stack);const fe={multipleChoice:{buttonVisible:!0,hintVisible:!1},trueFalse:{buttonVisible:!0,hintVisible:!1},input:{buttonVisible:!0,hintVisible:!1}},Te={isInTestCreation:!0,currentStep:oe,timestamp:Date.now(),excelState:fe};localStorage.setItem("test_creation_state",JSON.stringify(Te)),console.log(" Saved test creation state:",Te);const Ee={};switch(oe){case"testTypeSelection":break;case"multipleChoiceForm":Ee.testName=A.testName||"",Ee.numQuestions=A.numQuestions||"",Ee.numOptions=A.numOptions||"",Ee.questions=A.questions||{};break;case"trueFalseForm":Ee.testName=A.testName||"",Ee.numQuestions=A.numQuestions||"",Ee.questions=A.questions||{};break;case"inputForm":Ee.testName=A.testName||"",Ee.numQuestions=A.numQuestions||"",Ee.questions=A.questions||{};break;case"formCreation":Ee.testName=A.testName||"",Ee.numQuestions=A.numQuestions||"",Ee.numOptions=A.numOptions||"",Ee.questions=A.questions||{},Ee.enableTimer=!!A.enableTimer,Ee.timerMinutes=A.timerMinutes||"",Ee.isShuffled=!!A.isShuffled;break;case"assignment":case"testAssignment":Ee.testName=A.testName||"",Ee.numQuestions=A.numQuestions||"",Ee.numOptions=A.numOptions||"",Ee.questions=A.questions||{};break;default:console.log(" Unknown step in saveTestCreationState:",oe);break}Object.keys(Ee).length>0&&(localStorage.setItem(`form_data_${oe}`,JSON.stringify(Ee)),console.log(" Saved form data for step:",oe,Ee))},[e,A]),M=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearTestCreationState, redirecting to login");return}localStorage.removeItem("test_creation_state"),localStorage.removeItem("test_creation_form_data");const oe=[];for(let fe=0;fe<localStorage.length;fe++){const Te=localStorage.key(fe);Te&&(Te.includes("test")||Te.includes("form")||Te.includes("question"))&&oe.push(Te)}oe.forEach(fe=>{localStorage.removeItem(fe),console.log(" Removed localStorage key:",fe)}),console.log(" Cleared test creation state from localStorage")},[e]);S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearAllTestFields, redirecting to login");return}console.log(" Clearing all test form fields..."),j({testName:"",numQuestions:0,numOptions:0,questions:{}}),p(null),U([]),Z(null),console.log(" Cleared all test form fields")},[e]);const V=S.useCallback(()=>{console.log(" Resetting Excel upload state..."),nt({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),["multiple-choice","true-false","input","word-matching"].forEach(fe=>{const Te=document.querySelector(`.excel-upload-btn[data-test-type="${fe}"]`);Te&&(Te.style.display="none",console.log(" Excel button hidden for:",fe));const Ee=document.querySelector(`.excel-hint[data-test-type="${fe}"]`);Ee&&(Ee.style.display="none",console.log(" Excel hint hidden for:",fe));const Xe=document.querySelector(`.excel-file-input[data-test-type="${fe}"]`);Xe&&(Xe.value="",console.log(" File input cleared for:",fe))}),console.log(" Excel upload state reset complete")},[]),W=S.useCallback(()=>{console.log(" Setting up auto-save listeners for initial form fields..."),["testName","numQuestions","numOptions","enableTimer","timerMinutes","isShuffled"].forEach(fe=>{const Te=document.getElementById(fe);Te&&Te.addEventListener("input",()=>{console.log(` Auto-save triggered for field: ${fe}`)})}),console.log(" Form auto-save setup complete")},[]);S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveFormDataForStep, redirecting to login");return}console.log("  saveFormDataForStep called with step:",oe),console.log("  Call stack:",new Error().stack);const fe={};switch(oe){case"testTypeSelection":break;case"multipleChoiceForm":fe.testName=A.testName||"",fe.numQuestions=A.numQuestions||"",fe.numOptions=A.numOptions||"",fe.questions=A.questions||{};break;case"trueFalseForm":fe.testName=A.testName||"",fe.numQuestions=A.numQuestions||"",fe.questions=A.questions||{};break;case"inputForm":fe.testName=A.testName||"",fe.numQuestions=A.numQuestions||"",fe.questions=A.questions||{};break;case"formCreation":fe.testName=A.testName||"",fe.numQuestions=A.numQuestions||"",fe.numOptions=A.numOptions||"",fe.questions=A.questions||{};break;default:console.log(" Unknown step for form data save:",oe);return}localStorage.setItem("test_creation_form_data",JSON.stringify({step:oe,data:fe,timestamp:Date.now()})),console.log(" Saved form data for step:",oe,fe)},[e,A]);const I=S.useCallback(async oe=>{console.log(" Restoring form data for step:",oe);try{const fe=localStorage.getItem(`form_data_${oe}`);if(fe){const Te=JSON.parse(fe);console.log(" Restored form data:",Te),j(Ee=>{const Xe={...Ee,...Te};return console.log(" Updated formData with restored data:",Xe),console.log(" Matching test data in restored data:",Xe.matchingTestData),Xe}),Object.keys(Te).forEach(Ee=>{const Xe=document.getElementById(Ee);Xe&&Te[Ee]!==void 0&&(Xe.value=Te[Ee])}),console.log(" Form data restored for step:",oe)}else console.log(" No saved data found for step:",oe)}catch(fe){console.error(" Error restoring form data:",fe)}},[e]),B=S.useCallback(()=>{console.log(" Setting up multiple choice form auto-save..."),["mcNumOptions"].forEach(Te=>{const Ee=document.getElementById(Te);Ee&&Ee.addEventListener("input",()=>{console.log(` Auto-save triggered for MC field: ${Te}`)})}),document.querySelectorAll("#mcQuestionsContainer input, #mcQuestionsContainer textarea, #mcQuestionsContainer select").forEach(Te=>{Te.addEventListener("input",()=>{console.log(" Auto-save triggered for MC question field")})}),console.log(" Multiple choice form auto-save setup complete")},[]),q=S.useCallback(()=>{console.log(" Setting up true/false form auto-save..."),document.querySelectorAll("#tfQuestionsContainer input, #tfQuestionsContainer textarea, #tfQuestionsContainer select").forEach(fe=>{fe.addEventListener("input",()=>{console.log(" Auto-save triggered for TF question field")})}),console.log(" True/false form auto-save setup complete")},[]),J=S.useCallback(()=>{console.log(" Setting up input form auto-save..."),document.querySelectorAll("#inputQuestionsContainer input, #inputQuestionsContainer textarea, #inputQuestionsContainer select").forEach(fe=>{fe.addEventListener("input",()=>{console.log(" Auto-save triggered for Input question field")})}),console.log(" Input form auto-save setup complete")},[]),se=S.useCallback(oe=>{console.log(" showExcelUploadButton called with testType:",oe);const fe=oe==="multiple-choice"?"multipleChoice":oe==="true-false"?"trueFalse":oe==="input"?"input":oe;nt(Te=>({...Te,[fe]:{...Te[fe],buttonVisible:!0}}))},[]),X=S.useCallback(oe=>{console.log(" showExcelHint called with testType:",oe);const fe=oe==="multiple-choice"?"multipleChoice":oe==="true-false"?"trueFalse":oe==="input"?"input":oe;nt(Te=>({...Te,[fe]:{...Te[fe],hintVisible:!0}}))},[]),ie=S.useCallback(async(oe,fe,Te)=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTestAssignmentOptions, redirecting to login");return}console.log("displayTestAssignmentOptions called with:",{classes:oe,testType:fe,testId:Te}),v(oe),console.log(" Test assignment options displayed for:",{testType:fe,testId:Te,classesCount:oe.length})},[e]),le=S.useCallback(async(oe,fe)=>{try{if(console.log("Loading teacher grades and classes for test assignment"),!e||!e.teacher_id){console.error("No valid teacher session found, redirecting to login");return}console.log("Teacher ID:",e.teacher_id);const Ee=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${e.teacher_id}`)).json();console.log("Teacher subjects response:",Ee),Ee.success&&Ee.subjects&&Ee.subjects.length>0?(console.log("Teacher subjects loaded:",Ee.subjects),v(Ee.subjects),ie(Ee.subjects,oe,fe)):(console.log("No teacher subjects found"),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(Te){console.error("Error loading teacher grades and classes:",Te),r("Error loading teacher grades and classes","error")}},[e,r,ie]),ce=S.useCallback(async()=>{if(console.log(" Loading available classes..."),!e||!e.teacher_id){console.error("No valid teacher session found, redirecting to login");return}try{const fe=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${e.teacher_id}`)).json();console.log(" Teacher subjects response:",fe),fe.success&&fe.subjects&&fe.subjects.length>0?(console.log(" Teacher subjects loaded:",fe.subjects),v(fe.subjects)):(console.log("No teacher subjects found"),v([]),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(oe){console.error(" Error loading available classes:",oe),r("Failed to load available classes","error")}},[e,r]);S.useCallback(async(oe,fe)=>{if(i){o(!1);return}if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestAssignment, redirecting to login");return}ne(),H("testAssignment"),Z(fe),p(oe),u("testAssignment"),le(oe,fe),console.log(" Test assignment interface shown for:",{testType:oe,testId:fe})},[i,e,ne,H,le]);const ke=S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTeacherActiveTests, redirecting to login");return}if(console.log(" Displaying teacher active tests:",oe),oe.length===0){Ue([]);return}Ue(oe),console.log(" Active tests displayed:",oe.length,"tests")},[e]);S.useCallback(async(oe,fe)=>{try{console.log(" Loading test questions for:",{testType:oe,testId:fe});const Te=await cn.getTestQuestions(fe,oe);return console.log(" Test questions loaded:",Te),Te}catch(Te){throw console.error("Error loading test questions:",Te),Te}},[]),S.useCallback((oe,fe,Te,Ee)=>{console.log(" Showing teacher test details modal:",{testType:oe,testId:fe,testName:Te,questionsCount:Ee.length}),console.log("Test Details:",{testType:oe,testId:fe,testName:Te,questions:Ee.map(Xe=>({id:Xe.question_id,question:Xe.question,correctAnswer:Xe.correct_answer}))}),r(`Test details for "${Te}" loaded successfully.`,"success")},[r]);const re=S.useCallback(async()=>{console.log(" DEBUG: loadTeacherActiveTests called");try{console.log(" DEBUG: Fetching teacher active tests using JWT authentication...");const oe=await cn.getTeacherTests();console.log(" DEBUG: Tests loaded:",oe),oe&&oe.length>0?(console.log(" DEBUG: Success! Displaying",oe.length,"tests"),ke(oe)):(console.log(" DEBUG: No tests found"),Ue([]))}catch(oe){console.error(" DEBUG: Error loading active tests:",oe),r("Error loading active tests.","error")}},[r,ke]),ge=S.useCallback(()=>{console.log("showTestCreationSuccessMessage called"),r("Test created and assigned successfully!","success"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}}),U([]),o(!1),a(!1),M()},[r,M]),Ne=S.useCallback(async(oe,fe)=>{if(console.log(" === ASSIGN TEST TO CLASSES DEBUG START ==="),console.log(" Test Type:",oe),console.log(" Test ID:",fe),console.log(" Current formData:",A),console.log(" Selected Classes:",R),console.log(" User:",e),!e||!e.teacher_id){console.error(" No valid teacher session found in assignTestToClasses, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}if(console.log(" Teacher ID:",e.teacher_id),R.length===0){console.warn(" No classes selected"),r("Please select at least one class.","warning");return}try{console.log(" Preparing test + assignment request..."),await Qu.loadAcademicCalendar();const Ee=Qu.getCurrentTerm()?.id;if(!Ee)throw new Error("No current academic period found");const Xe=R.map(Ct=>{const Ht={grade:parseInt(Ct.grade),class:parseInt(Ct.class),subject_id:parseInt(Ct.subject_id),academic_period_id:Ee,due_date:null};return console.log(" Created assignment:",Ht),Ht});if(console.log(" Final assignments array:",Xe),oe==="matching"){console.log(" Processing matching test..."),console.log(" Setting isAssigningTest to true for matching test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(vr=>setTimeout(vr,100));const Ct=A.matchingTestData;if(console.log(" Matching test data from formData:",Ct),!Ct){console.error(" Matching test data not found in formData"),r("Matching test data not found. Please recreate the test.","error");return}console.log(" Matching test data found, processing...");let Ht;Ct.processedQuestions?(console.log(" Using pre-processed questions from MatchingTestCreator"),Ht=Ct.processedQuestions):(console.log(" Converting blocks to questions (fallback)..."),console.log(" Blocks:",Ct.blocks),console.log(" Words:",Ct.words),console.log(" Arrows:",Ct.arrows),Ht=Ct.blocks.map((vr,Er)=>{const qr=Ct.words.find(xr=>xr.blockId===vr.id)?.word||`Word ${Er+1}`,Hr=Ct.arrows.some(xr=>xr.startBlock===vr.id),he=Ct.arrows.find(xr=>xr.startBlock===vr.id)||null,vt={question_id:Er+1,word:qr,block_coordinates:{x:vr.x,y:vr.y,width:vr.width,height:vr.height},has_arrow:Hr,arrow:he?{startX:he.startX,startY:he.startY,endX:he.endX,endY:he.endY,style:he.style||{}}:null};return console.log(` Question ${Er+1}:`,vt),vt})),console.log(" Final questions array:",Ht);const yr={teacher_id:e.teacher_id,test_name:A.testName,image_url:Ct.imageUrl,num_blocks:Ct.blocks.length,questions:Ht,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,assignments:Xe};console.log(" Final matching test data payload:",yr),console.log(" Calling testService.saveMatchingTest...");const wr=await cn.saveMatchingTest(yr);console.log(" API Response:",wr),wr.success?(console.log(" Matching test created and assigned successfully!"),r("Matching test created and assigned successfully!","success"),console.log("Matching test created and assigned successfully"),o(!0),je()):(console.error(" Failed to create matching test:",wr.message),r("Error creating and assigning matching test: "+wr.message,"error")),F(!1);return}if(oe==="wordMatching"){console.log(" Processing word matching test..."),console.log(" Setting isAssigningTest to true for word matching test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(vr=>setTimeout(vr,100));const Ct=A.wordMatchingData;if(console.log(" Word matching test data from formData:",Ct),!Ct){console.error(" Word matching test data not found in formData"),r("Word matching test data not found. Please recreate the test.","error");return}console.log(" Word matching test data found, processing...");const Ht=Ct.wordPairs.map((vr,Er)=>({question_id:Er+1,left_word:vr.leftWord,right_word:vr.rightWord}));console.log(" Final word matching questions array:",Ht);const yr={teacher_id:e.teacher_id,test_type:"word_matching",test_name:A.testName,num_questions:Ct.wordPairs.length,interaction_type:Ct.interactionType||"drag",questions:Ht,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,assignments:Xe};console.log(" Final word matching test data payload:",yr),console.log(" Calling testService.assignTestToClasses for word matching...");const wr=await cn.assignTestToClasses(yr);console.log(" API Response:",wr),wr.success?(console.log(" Word matching test created and assigned successfully!"),r("Word matching test created and assigned successfully!","success"),console.log("Word matching test created and assigned successfully"),o(!0),je()):(console.error(" Failed to create word matching test:",wr.message),r("Error creating and assigning word matching test: "+wr.message,"error")),F(!1);return}if(oe==="drawing"){console.log(" Processing drawing test..."),console.log(" Setting isAssigningTest to true for drawing test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(vr=>setTimeout(vr,100));const Ct=A.drawingData;if(console.log(" Drawing test data from formData:",Ct),!Ct){console.error(" Drawing test data not found in formData"),r("Drawing test data not found. Please recreate the test.","error");return}console.log(" Drawing test data found, processing...");const Ht=Ct.questions||[];console.log(" Drawing questions array:",Ht);const yr={teacher_id:e.teacher_id,test_type:"drawing",test_name:A.testName,num_questions:Ct.num_questions,passing_score:Ct.passing_score,questions:Ht,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,assignments:Xe};console.log(" Final drawing test data payload:",yr),console.log(" Calling testService.assignTestToClasses...");const wr=await cn.assignTestToClasses(yr);console.log(" API Response:",wr),wr.success?(console.log(" Drawing test created and assigned successfully!"),r("Drawing test created and assigned successfully!","success"),o(!0),je()):(console.error(" Failed to create drawing test:",wr.message),r("Error creating and assigning drawing test: "+wr.message,"error")),F(!1);return}if(oe==="fillBlanks"){console.log(" Processing fill blanks test..."),console.log(" Setting isAssigningTest to true for fill blanks test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(vr=>setTimeout(vr,100));const Ct=A.fillBlanksData;if(console.log(" Fill blanks test data from formData:",Ct),!Ct){console.error(" Fill blanks test data not found in formData"),r("Fill blanks test data not found. Please recreate the test.","error");return}console.log(" Fill blanks test data found, processing...");const Ht=Ct.blanks||[];console.log(" Fill blanks questions array:",Ht);const yr={teacher_id:e.teacher_id,test_type:"fill_blanks",test_name:A.testName,test_text:Ct.test_text,num_questions:Ct.num_questions,num_blanks:Ct.num_blanks,separate_type:Ct.separate_type,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,questions:Ht,assignments:Xe};console.log(" Final fill blanks test data payload:",yr),console.log(" Calling testService.assignTestToClasses...");const wr=await cn.assignTestToClasses(yr);console.log(" API Response:",wr),wr.success?(console.log(" Fill blanks test created and assigned successfully!"),r("Fill blanks test created and assigned successfully!","success"),o(!0),je()):(console.error(" Failed to create fill blanks test:",wr.message),r("Error creating and assigning fill blanks test: "+wr.message,"error")),F(!1);return}if(oe==="speaking"){console.log(" Processing speaking test..."),console.log(" Setting isAssigningTest to true for speaking test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(vr=>setTimeout(vr,100));const Ct=A.speakingData;if(console.log(" Speaking test data from formData:",Ct),!Ct){console.error(" Speaking test data not found in formData"),r("Speaking test data not found. Please recreate the test.","error");return}console.log(" Speaking test data found, processing...");const Ht={teacher_id:e.teacher_id,test_type:"speaking",test_name:A.testName,time_limit:Ct.time_limit,min_duration:Ct.min_duration,max_duration:Ct.max_duration,max_attempts:Ct.max_attempts,min_words:Ct.min_words,passing_score:Ct.passing_score,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,questions:Ct.questions,assignments:Xe};console.log(" Final speaking test data payload:",Ht),console.log(" Calling save-speaking-test-with-assignments for speaking test...");const wr=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-speaking-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ht)})).json();console.log(" API Response:",wr),wr.success?(console.log(" Speaking test created and assigned successfully!"),r("Speaking test created and assigned successfully!","success"),o(!0),je()):(console.error(" Failed to create speaking test:",wr.message),r("Error creating and assigning speaking test: "+wr.message,"error")),F(!1);return}console.log(" Processing non-matching test..."),console.log(" Form data questions:",A.questions);const ut=Object.keys(A.questions).map(Ct=>{const Ht=A.questions[Ct];console.log(` Processing question ${Ct}:`,Ht);let yr;if(oe==="input")yr={correct_answers:Ht.correct_answers||[Ht.correctAnswer||""]};else if(oe==="trueFalse"){const vr=Ht.correct_answer||Ht.correctAnswer||Ht.correct_answers?.[0]||"";yr={correct_answer:vr==="true"}}else yr={correct_answer:Ht.correctAnswer||Ht.correct_answer||Ht.correct_answers?.[0]||""};const wr={question_id:parseInt(Ct),question:Ht.question,...yr,options:Ht.options||[]};return console.log(` Question ${Ct} correct_answers:`,Ht.correct_answers),console.log(` Question ${Ct} correctAnswer:`,Ht.correctAnswer),console.log(` Converted question ${Ct}:`,wr),wr});console.log(" Final questions array:",ut);const ft={teacher_id:e.teacher_id,test_type:v3e[oe],test_name:A.testName,num_questions:A.numQuestions,num_options:A.numOptions,questions:ut,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,is_shuffled:!!A.isShuffled,assignments:Xe};console.log(" Final test data payload:",ft),console.log(" Setting isAssigningTest to true..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Ct=>setTimeout(Ct,100)),console.log(" Calling testService.assignTestToClasses...");const Kt=await cn.assignTestToClasses(ft);console.log(" API Response:",Kt),Kt.success?(console.log(" Test created and assigned successfully!"),r("Test created and assigned successfully!","success"),console.log("Test created and assigned successfully"),o(!0),je()):(console.error(" Failed to create and assign test:",Kt.message),r("Error creating and assigning test: "+Kt.message,"error"))}catch(Te){console.error(" Exception in assignTestToClasses:",Te),console.error("Error creating and assigning test:",Te),r("Error creating and assigning test. Please try again.","error")}finally{F(!1)}console.log(" === ASSIGN TEST TO CLASSES DEBUG END ===")},[e,R,A,r,ge]),je=S.useCallback(async()=>{console.log("returnToMainCabinet called - restoring main cabinet view");try{a(!1),o(!1),u("typeSelection"),p(null),Z(null),U([]),L(),M(),ge(),console.log(" Returned to main cabinet")}catch(oe){console.error("Error returning to main cabinet:",oe)}},[L,M,ge]),[Ke,Ue]=S.useState([]),[It,rt]=S.useState(!1);S.useCallback(async()=>{console.log(" Refreshing active tests data...");try{await re(),r("Active tests data refreshed.","success")}catch(oe){console.error("Error refreshing active tests data:",oe),r("Error refreshing data.","error")}},[re,r]);const[wt,xt]=S.useState([]),[lt,pt]=S.useState([]),[Rt,Mt]=S.useState(!1),[Qe,Re]=S.useState(!1),Be=S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayExistingSubjectsInSelection, redirecting to login");return}console.log("Displaying existing subjects in selection interface:",oe),xt(oe),console.log(" Existing subjects displayed in selection:",oe.length,"subjects")},[e]);S.useCallback(async()=>{try{console.log("Loading existing subjects...");const oe=await ns.getTeacherSubjects();console.log("Existing subjects loaded:",oe),oe&&oe.length>0?Be(oe):(console.log("No existing subjects found"),xt([]))}catch(oe){console.error("Error loading existing subjects:",oe),r("Error loading subjects.","error")}},[r,Be]);const ct=S.useCallback(oe=>{console.log("Checking for outside click...");const fe=document.getElementById("dropdownMenu"),Te=document.querySelector("[data-menu-button]");fe&&!fe.contains(oe.target)&&!Te?.contains(oe.target)&&(console.log("Outside click detected, closing menu"),fe.classList.remove("show"),document.removeEventListener("click",ct))},[]),[We,nt]=S.useState({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),Tt=S.useCallback((oe,fe)=>{const Te=oe.target.files[0];if(!Te)return;if(!Te.name.match(/\.(xlsx|xls)$/i)){r("Please select a valid Excel file (.xlsx or .xls)","error"),oe.target.value="";return}if(Te.size>5*1024*1024){r("File is too large. Please select a file smaller than 5MB.","error"),oe.target.value="";return}E(!0);const Ee=new FileReader;Ee.onload=function(Xe){try{console.log(" File loaded, processing data...");const ut=new Uint8Array(Xe.target.result),ft=_E(ut,{type:"array"}),Kt=ft.SheetNames[0],Ct=ft.Sheets[Kt],Ht=ab.sheet_to_json(Ct,{header:1});console.log(" Parsed Excel data:",Ht),Vt(Ht,fe),E(!1)}catch(ut){console.error("Error processing Excel file:",ut),r("Error reading Excel file: "+ut.message,"error"),oe.target.value="",E(!1)}},Ee.onerror=function(){r("Failed to read file","error"),oe.target.value="",E(!1)},Ee.readAsArrayBuffer(Te)},[r]),jt=S.useCallback(()=>{console.log(" Initializing Excel upload for all test types...");const oe=document.querySelectorAll(".excel-upload-btn");console.log(` Found ${oe.length} Excel upload buttons`),oe.forEach((fe,Te)=>{const Ee=fe.dataset.testType,Xe=document.querySelector(`.excel-file-input[data-test-type="${Ee}"]`);console.log(` Processing button ${Te+1}: testType=${Ee}, fileInput=${Xe?"found":"not found"}`),Xe?(fe._excelClickHandler&&fe.removeEventListener("click",fe._excelClickHandler),Xe._excelChangeHandler&&Xe.removeEventListener("change",Xe._excelChangeHandler),fe._excelClickHandler=()=>{console.log(` Excel upload button clicked for test type: ${Ee}`),Xe.click()},Xe._excelChangeHandler=ut=>{console.log(` File input changed for test type: ${Ee}`),Tt(ut,Ee)},fe.addEventListener("click",fe._excelClickHandler),Xe.addEventListener("change",Xe._excelChangeHandler),console.log(` Excel upload initialized for test type: ${Ee}`)):console.warn(` File input not found for test type: ${Ee}`)}),console.log(" Excel upload initialization complete")},[Tt]),Vt=S.useCallback((oe,fe)=>{const Te=oe.filter(Ct=>Array.isArray(Ct)&&Ct.length>0&&Ct.some(Ht=>Ht&&Ht.toString().trim()!==""));console.log(" Original Excel data rows:",oe.length),console.log(" Filtered Excel data rows:",Te.length);const Xe=fr(Te,fe).dataRows;if(Xe.length===0){const Ct="No data rows found after header processing. Please check your Excel file.";r(Ct,"error"),alert(Ct),Fe(fe);return}console.log(` Processing Excel data for test type: ${fe}`),console.log(" Data rows after header processing:",Xe);const ut=or(Xe,fe);if(console.log(" Recognition result:",ut),!ut.recognized){console.log(` Excel data recognition failed for test type: ${fe}`);const Ct="Excel data recognition failed. Please check your file format.";r(Ct,"error"),alert(Ct),Fe(fe);return}console.log(` Excel data recognition successful for test type: ${fe}`);const ft=Xe.length,Kt=Ae(fe);if(Kt===0)console.log(` No question count specified, using CSV count: ${ft}`),j(Ct=>({...Ct,numQuestions:ft}));else if(ft!==Kt){const Ct=`Your CSV file has ${ft} data rows, but you specified ${Kt} questions.

Please either:
1. Change your question count to ${ft}, or
2. Fix your CSV file to have exactly ${Kt} data rows

Then try uploading again.`;r(Ct,"error"),Fe(fe);return}Me(Xe,fe)},[r]),fr=S.useCallback((oe,fe)=>{if(oe.length===0)return{hasHeaders:!1,headerRow:null,dataRows:oe};const Te=oe[0],Ee=Dr(fe);if(zr(Te,Ee).isLikelyHeader){const ut=`The first row of your Excel file looks like it contains headers:

"${Te.join(" | ")}"

Does the first row contain column headers?

Click "OK" if YES (headers will be removed)
Click "Cancel" if NO (first row will be treated as data)`;if(window.confirm(ut))return{hasHeaders:!0,headerRow:Te,dataRows:oe.slice(1)}}return{hasHeaders:!1,headerRow:null,dataRows:oe}},[]),Dr=S.useCallback(oe=>{switch(oe){case"multipleChoice":return{keywords:["question","answer","correct","option","a","b","c","d","e","f"],expectedColumns:4};case"trueFalse":return{keywords:["question","answer","correct","true","false"],expectedColumns:2};case"input":return{keywords:["question","answer","correct"],expectedColumns:2};default:return{keywords:[],expectedColumns:0}}},[]),zr=S.useCallback((oe,fe)=>{if(!oe||oe.length===0)return{isLikelyHeader:!1};if(oe.length<fe.expectedColumns)return{isLikelyHeader:!1};const Te=oe.join(" ").toLowerCase(),Ee=fe.keywords.filter(ut=>Te.includes(ut.toLowerCase()));return{isLikelyHeader:Ee.length>fe.keywords.length/2,keywordMatches:Ee}},[]),or=S.useCallback((oe,fe)=>{if(oe.length===0)return r("No data rows found. Please check your Excel file.","error"),{recognized:!1,data:[]};console.log(` Checking data pattern for test type: ${fe}`),console.log(" Excel data to validate:",oe);const Te=nr(oe,fe);if(console.log(" Recognition result:",Te),!Te.matches){const Ee=`Your Excel file doesn't match the expected format.

Required format:
${me(fe)}

Please review your Excel file and make sure it follows this format exactly.

Then try uploading again.`;return console.log(" Data pattern validation failed:",Ee),console.log(" Calling showNotification with message:",Ee),r(Ee,"error"),console.log(" showNotification called"),alert(Ee),{recognized:!1,data:[]}}return console.log(` Data pattern validation passed for test type: ${fe}`),{recognized:!0,data:oe}},[r]),nr=S.useCallback((oe,fe)=>{if(fe==="multipleChoice")for(let Te=0;Te<oe.length;Te++){const Ee=oe[Te];if(Ee.length<4)return{matches:!1,issue:`Row ${Te+1} has ${Ee.length} columns but needs at least 4`};if(!Ee[0]||Ee[0].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no question in column 1`};if(!Ee[1]||Ee[1].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no correct answer in column 2`}}else if(fe==="trueFalse")for(let Te=0;Te<oe.length;Te++){const Ee=oe[Te];if(Ee.length<2)return{matches:!1,issue:`Row ${Te+1} has ${Ee.length} columns but needs at least 2`};if(!Ee[0]||Ee[0].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no question in column 1`};const Xe=Ee[1]?.toString().trim().toLowerCase();if(!Xe||!["true","false","t","f"].includes(Xe))return{matches:!1,issue:`Row ${Te+1} has invalid correct answer in column 2 (must be True/False)`}}else if(fe==="input")for(let Te=0;Te<oe.length;Te++){const Ee=oe[Te];if(Ee.length<2)return{matches:!1,issue:`Row ${Te+1} has ${Ee.length} columns but needs at least 2`};if(!Ee[0]||Ee[0].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no question in column 1`};if(!Ee[1]||Ee[1].toString().trim()==="")return{matches:!1,issue:`Row ${Te+1} has no correct answer in column 2`}}return{matches:!0}},[]),me=S.useCallback(oe=>{switch(oe){case"multipleChoice":return`Column 1: Question
Column 2: Correct Answer (A, B, C, D, E, or F)
Column 3: Option A
Column 4: Option B
Column 5: Option C (optional)
Column 6: Option D (optional)
Column 7: Option E (optional)
Column 8: Option F (optional)`;case"trueFalse":return`Column 1: Question
Column 2: Correct Answer (True or False)`;case"input":return`Column 1: Question
Column 2: Correct Answer`;default:return"Unknown test type"}},[]),Ae=S.useCallback(oe=>A.numQuestions||0,[A.numQuestions]),Fe=S.useCallback(oe=>{console.log(` Clearing file input for test type: ${oe}`)},[]),Me=S.useCallback((oe,fe)=>{switch(console.log(` populateFromExcelForTestType called with testType: ${fe}`),fe){case"multipleChoice":case"multiple-choice":kt(oe);break;case"trueFalse":case"true-false":Oe(oe);break;case"input":at(oe);break;default:console.log(` Unknown test type: ${fe}`)}},[]),kt=S.useCallback(oe=>{console.log(" populateMultipleChoiceFromExcel called with:",oe);const fe=Math.max(...oe.map(Xe=>Xe.length-2)),Te=Math.min(fe,6);console.log(` Excel data has ${fe} option columns, using ${Te} options`),j(Xe=>({...Xe,numOptions:Te}));const Ee={};oe.forEach((Xe,ut)=>{const ft=ut+1;console.log(` Row ${ut+1} data:`,Xe);const Kt={question:(Xe[0]||"").toString().trim(),options:[],correctAnswer:(Xe[1]||"").toString().trim().toUpperCase()};console.log(` Question ${ft} correctAnswer:`,Kt.correctAnswer),["A","B","C","D","E","F"].slice(0,Te).forEach((yr,wr)=>{const vr=(Xe[wr+2]||"").toString().trim();console.log(` Option ${wr} (${yr}):`,vr),Kt.options.push(vr)}),Ee[ft]=Kt}),j(Xe=>{const ut={...Xe,questions:Ee};return console.log(" Updating form data with:",ut),ut}),console.log(" Populated multiple choice questions from Excel:",Ee),r(`Successfully loaded ${oe.length} questions from CSV file!`,"success"),B(),Ce("multiple-choice")},[A.numOptions,B,r]),Oe=S.useCallback(oe=>{console.log(" populateTrueFalseFromExcel called with:",oe);const fe={};oe.forEach((Te,Ee)=>{const Xe=Ee+1,ut={question:(Te[0]||"").toString().trim(),correctAnswer:Te[1]?.toString().trim().toLowerCase()==="true"?"true":"false"};fe[Xe]=ut}),j(Te=>({...Te,questions:fe})),console.log(" Populated true/false questions from Excel:",fe),r(`Successfully loaded ${oe.length} questions from CSV file!`,"success"),q(),Ce("true-false")},[q,r]),at=S.useCallback(oe=>{console.log(" populateInputFromExcel called with:",oe);const fe={};oe.forEach((Te,Ee)=>{const Xe=Ee+1,ut=[];for(let Kt=1;Kt<Te.length;Kt++){const Ct=(Te[Kt]||"").toString().trim();Ct&&ut.push(Ct)}const ft={question:(Te[0]||"").toString().trim(),correctAnswer:ut[0]||"",correct_answers:ut};console.log(` Excel question ${Xe} data:`,ft),fe[Xe]=ft}),j(Te=>({...Te,questions:fe})),console.log(" Populated input questions from Excel:",fe),r(`Successfully loaded ${oe.length} questions from Excel file!`,"success"),J(),Ce("input")},[J,r]),Ce=S.useCallback(oe=>{switch(console.log(` Reattaching form event listeners for test type: ${oe}`),document.querySelectorAll('[data-listener-attached="true"]').forEach(Te=>{Te.removeEventListener("input",()=>{}),Te.removeAttribute("data-listener-attached")}),oe){case"multiple-choice":B();break;case"true-false":q();break;case"input":J();break;default:console.warn("Unknown test type for event listener reattachment:",oe)}console.log(` Form event listeners reattached for test type: ${oe}`)},[B,q,J]),Ve=S.useCallback(()=>{const oe=localStorage.getItem("test_creation_state");if(!oe)return console.log(" No test creation state found in localStorage"),!1;try{const fe=JSON.parse(oe);console.log(" Found test creation state:",fe);const Te=Date.now()-fe.timestamp,Ee=1800*1e3;if(Te>Ee)return console.log(" Test creation state is too old, clearing it"),M(),!1;switch(a(!0),console.log(" Restored isInTestCreation flag to true"),ne(),fe.excelState&&V(),fe.currentStep){case"testTypeSelection":console.log(" Restoring test type selection step"),u("typeSelection");break;case"multipleChoiceForm":console.log(" Restoring multiple choice form step"),p("multipleChoice"),u("formCreation");break;case"trueFalseForm":console.log(" Restoring true/false form step"),p("trueFalse"),u("formCreation");break;case"inputForm":console.log(" Restoring input form step"),p("input"),u("formCreation");break;case"testAssignment":case"assignment":console.log(" Restoring test assignment step"),console.log(" Cannot restore test assignment step without test data, going back to type selection"),u("typeSelection");break;default:console.log(" Unknown step in state, defaulting to type selection"),u("typeSelection")}return I(fe.currentStep),!0}catch(fe){return console.error(" Error restoring test creation state:",fe),M(),!1}},[M,ne,V,I]);S.useEffect(()=>{console.log(" Initializing Teacher Tests..."),ae(),Ve(),ce(),jt()},[ae,Ve,ce,jt]),S.useEffect(()=>{A.numQuestions>0&&g&&g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&(console.log(" Excel upload buttons rendered, initializing event listeners..."),setTimeout(()=>{jt()},100))},[A.numQuestions,g,jt]);const Ze=oe=>{console.log(" Test type selected:",oe),console.log(" Setting testType to:",oe),p(oe),u("formCreation"),j({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:""}),H("formCreation"),setTimeout(()=>{jt()},100)},Ft=(oe,fe)=>{j(Te=>({...Te,[oe]:fe}))},zt=(oe,fe,Te)=>{j(Ee=>({...Ee,questions:{...Ee.questions,[oe]:{...Ee.questions[oe],[fe]:Te}}}))},er=(oe,fe,Te,Ee=0)=>{const Xe={};for(let ut=1;ut<=Te;ut++)oe==="multipleChoice"?Xe[ut]={question:"",options:Array.from({length:Ee},()=>""),correctAnswer:""}:oe==="trueFalse"?Xe[ut]={question:"",correctAnswer:""}:oe==="input"&&(Xe[ut]={question:"",correct_answers:[""]});j(ut=>({...ut,questions:Xe})),oe==="multipleChoice"?(se("multiple-choice"),X("multiple-choice")):oe==="trueFalse"?(se("true-false"),X("true-false")):oe==="input"&&(se("input"),X("input"))},hr=async()=>{if(!g||!A.testName||!A.numQuestions){r("Please fill in all required fields","error");return}console.log(" Test form completed, proceeding to assignment step"),H("testAssignment",A),u("testAssignment"),r("Test form completed! Now select classes and subjects.","success")},ir=(oe,fe,Te,Ee,Xe)=>{U(Te?ut=>[...ut,{grade:oe,class:fe,subject_id:Ee,subject:Xe}]:ut=>ut.filter(ft=>!(ft.grade===oe&&ft.class===fe&&ft.subject_id===Ee)))},Wr=S.useCallback(async oe=>{console.log(" [DEBUG] handleMatchingTestSave called"),console.log(" [DEBUG] Received testData:",oe),console.log(" [DEBUG] Current formData:",A),console.log(" [DEBUG] Current testType:",g),console.log(" [DEBUG] Current user:",e),console.log(" [DEBUG] Current currentStep:",l),_(!0);try{const fe=oe.blocks.map((Xe,ut)=>{const ft=oe.words.find(Ht=>Ht.blockId===Xe.id)?.word||`Word ${ut+1}`,Kt=oe.arrows.some(Ht=>Ht.startBlock===Xe.id),Ct=oe.arrows.find(Ht=>Ht.startBlock===Xe.id)||null;return{question_id:ut+1,word:ft,block_coordinates:{x:Xe.x,y:Xe.y,width:Xe.width,height:Xe.height},has_arrow:Kt,arrow:Ct?{startX:Ct.startX,startY:Ct.startY,endX:Ct.endX,endY:Ct.endY,style:Ct.style||{}}:null}}),Te={teacher_id:e.teacher_id,test_name:A.testName||`Matching Test - ${new Date().toLocaleString()}`,image_url:oe.imageUrl,num_blocks:oe.blocks.length,questions:fe,assignments:[]};console.log(" Sending matching test payload:",Te);const Ee={...A,testName:Te.test_name,numQuestions:Te.num_blocks,numOptions:0,questions:fe.reduce((Xe,ut,ft)=>(Xe[ft+1]={question:ut.word,correctAnswer:ut.word,options:[]},Xe),{}),matchingTestData:oe};console.log(" Assignment form data:",Ee),j(Ee),H("testAssignment",Ee),console.log(" Setting current step to testAssignment"),u("testAssignment"),r("Matching test data saved! Now select classes and subjects.","success")}catch(fe){console.error(" Error saving matching test:",fe),r("Failed to save matching test: "+fe.message,"error")}finally{_(!1)}},[e,A,g,r,H]),ue=S.useCallback(()=>{console.log(" Cancelling matching test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),be=S.useCallback(async oe=>{console.log(" [DEBUG] handleWordMatchingTestSave called"),console.log(" [DEBUG] Received testData:",oe),_(!0);try{j(fe=>({...fe,wordMatchingData:oe,numQuestions:oe.numQuestions||oe.wordPairs?.length||0})),u("testAssignment"),r("Word matching test created! Now assign it to classes.","success")}catch(fe){console.error("Error saving word matching test:",fe),r("Failed to save word matching test: "+fe.message,"error")}finally{_(!1)}},[r]),ye=S.useCallback(()=>{console.log(" Cancelling word matching test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),xe=S.useCallback(async oe=>{console.log(" [DEBUG] handleDrawingTestSave called"),console.log(" [DEBUG] Received testData:",oe),_(!0);try{j(fe=>({...fe,drawingData:oe,numQuestions:oe.num_questions||oe.questions?.length||0})),u("testAssignment"),r("Drawing test created! Now assign it to classes.","success")}catch(fe){console.error(" Error saving drawing test:",fe),r("Error saving drawing test","error")}finally{_(!1)}},[r]),_e=S.useCallback(()=>{console.log(" Cancelling drawing test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),Se=S.useCallback(()=>{console.log(" Cancelling fill blanks test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),He=S.useCallback(async oe=>{console.log(" [DEBUG] handleFillBlanksTestSave called"),console.log(" [DEBUG] Received testData:",oe),_(!0);try{j(fe=>({...fe,fillBlanksData:oe,numQuestions:oe.num_questions||oe.blanks?.length||0})),u("testAssignment"),r("Fill blanks test created! Now assign it to classes.","success")}catch(fe){console.error(" Error saving fill blanks test:",fe),r("Error saving fill blanks test","error")}finally{_(!1)}},[r]),it=S.useCallback(()=>{console.log(" Cancelling speaking test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),Ye=S.useCallback(async oe=>{console.log(" [DEBUG] handleSpeakingTestSave called"),console.log(" [DEBUG] Received testData:",oe),_(!0);try{j(fe=>({...fe,speakingData:oe,numQuestions:oe.questions?.length||0})),u("testAssignment"),r("Speaking test created! Now assign it to classes.","success")}catch(fe){console.error(" Error saving speaking test:",fe),r("Error saving speaking test","error")}finally{_(!1)}},[r]);return c.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[c.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs(fo,{mode:"wait",children:[l==="typeSelection"&&c.jsxs(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs(Je,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),c.jsx("span",{children:"Back to Main"})]}),c.jsx("div",{className:"flex-1"})]}),c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Create New Test"}),c.jsx("p",{className:"text-gray-600",children:"Choose the type of test you want to create"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{type:"multipleChoice",title:"Multiple Choice",description:"Questions with multiple answer options",icon:"/pics/multiple-choice.png"},{type:"trueFalse",title:"True/False",description:"Questions with true or false answers",icon:"/pics/true-false.png"},{type:"input",title:"Input",description:"Questions requiring text input",icon:"/pics/input.png"},{type:"matching",title:"Picture Matching",description:"Labeling pictures",icon:"/pics/matching.png"},{type:"wordMatching",title:"Word Matching",description:"Matching word pairs by dragging or drawing arrows",icon:"/pics/matching-words.png"},{type:"drawing",title:"Drawing Test",description:"Interactive drawing tests with canvas for students",icon:"/pics/drawing.png"},{type:"fillBlanks",title:"Fill Blanks",description:"Text with multiple choice blanks",icon:"/pics/fill-blanks.png"},{type:"speaking",title:"Speaking Test",description:"Audio recording with AI-powered feedback",icon:"/pics/speaking.png"}].map(({type:oe,title:fe,description:Te,icon:Ee})=>c.jsx(st.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"cursor-pointer",onClick:()=>Ze(oe),children:c.jsxs(At,{className:"h-full text-center hover:shadow-lg transition-shadow",children:[c.jsx("div",{className:"mb-3 flex justify-center",children:c.jsx("img",{src:Ee,alt:fe,className:"w-12 h-12 object-contain"})}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:fe}),c.jsx("p",{className:"text-sm text-gray-600",children:Te})]})},oe))})]}),l==="formCreation"&&c.jsxs(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"flex space-x-2",children:c.jsx(Je,{variant:"outline",onClick:ee,children:" Back to Test Types"})}),c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Create ",g==="multipleChoice"?"Multiple Choice":g==="trueFalse"?"True/False":g==="input"?"Input":g==="drawing"?"Drawing":g==="fillBlanks"?"Fill Blanks":g==="wordMatching"?"Word Matching":g==="speaking"?"Speaking":"Picture Matching"," Test"]}),c.jsx("p",{className:"text-gray-600",children:"Fill in the test details and questions"})]})]})}),c.jsx(At,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Information"}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Name"}),c.jsx("input",{type:"text",value:A.testName,onChange:oe=>Ft("testName",oe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter test name"})]}),g!=="matching"&&g!=="wordMatching"&&g!=="drawing"&&g!=="fillBlanks"&&g!=="speaking"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Questions"}),c.jsx("input",{type:"number",min:"1",max:"50",value:A.numQuestions,onChange:oe=>{const fe=parseInt(oe.target.value)||0;Ft("numQuestions",fe),fe>0&&er(g,A.testName,fe,A.numOptions)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of questions"})]}),g==="multipleChoice"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Options per Question"}),c.jsx("input",{type:"number",min:"2",max:"6",value:A.numOptions,onChange:oe=>{const fe=parseInt(oe.target.value)||0;Ft("numOptions",fe),fe>0&&fe<2&&r("Multiple choice tests require at least 2 options per question. Please enter 2 or more.","warning"),A.numQuestions>0&&er(g,A.testName,A.numQuestions,fe)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of options (2-6)"})]}),g!=="speaking"&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("label",{className:"inline-flex items-center space-x-2",children:[c.jsx("input",{type:"checkbox",checked:!!A.enableTimer,onChange:oe=>Ft("enableTimer",oe.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),c.jsx("span",{className:"text-sm text-gray-700",children:"Enable timer for this test"})]}),A.enableTimer&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("label",{className:"text-sm text-gray-700",children:"Time (minutes):"}),c.jsx("input",{type:"number",min:"1",max:"1440",value:A.timerMinutes,onChange:oe=>Ft("timerMinutes",oe.target.value.replace(/[^0-9]/g,"")),className:"w-28 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 30"})]})]}),g!=="drawing"&&g!=="matching"&&g!=="wordMatching"&&g!=="fillBlanks"&&g!=="speaking"&&c.jsx("div",{className:"flex items-center space-x-2",children:c.jsxs("label",{className:"inline-flex items-center space-x-2",children:[c.jsx("input",{type:"checkbox",checked:!!A.isShuffled,onChange:oe=>Ft("isShuffled",oe.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),c.jsx("span",{className:"text-sm text-gray-700",children:"Shuffle questions during test"})]})})]})]})}),g==="matching"&&c.jsx(At,{children:c.jsxs("div",{className:"space-y-4 text-center",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Picture Matching Test"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Upload an image and create interactive matching blocks with words."}),c.jsx(Xee,{testName:A.testName,onTestSaved:Wr,onCancel:ue,onBackToCabinet:je,isSaving:k,validationErrors:{}})]})}),g==="wordMatching"&&c.jsx(At,{children:c.jsxs("div",{className:"space-y-4 text-center",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Word Matching Test"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Create word pairs for students to match by dragging or drawing arrows."}),c.jsx(Qse,{testName:A.testName,onTestSaved:be,onCancel:ye,onBackToCabinet:je,isSaving:k,validationErrors:{}})]})}),g==="drawing"&&c.jsxs(At,{children:[console.log(" Rendering DrawingTestCreator, testType:",g),c.jsx(Use,{testName:A.testName,onTestSaved:xe,onCancel:_e,onBackToCabinet:je,isSaving:k,validationErrors:{}})]}),g==="fillBlanks"&&c.jsxs(At,{children:[console.log(" Rendering FillBlanksTestCreator, testType:",g),c.jsx(Gse,{testName:A.testName,allowedTime:A.enableTimer&&parseInt(A.timerMinutes)||null,onTestSaved:He,onCancel:Se,onBackToCabinet:je,isSaving:k,validationErrors:{}})]}),g==="speaking"&&c.jsxs(At,{children:[console.log(" Rendering SpeakingTestCreator, testType:",g),c.jsx(Kse,{testName:A.testName,onTestSaved:Ye,onCancel:it,onBackToCabinet:je,isSaving:k,validationErrors:{}})]}),g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&g!=="speaking"&&A.numQuestions>0&&c.jsx(At,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Excel Upload"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Upload an Excel file to automatically populate questions, or fill them in manually below."}),c.jsxs("div",{className:"space-y-6",children:[g==="multipleChoice"&&We.multipleChoice?.buttonVisible&&c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"multiple-choice",disabled:N,children:N?c.jsxs(c.Fragment,{children:[c.jsx(Ur,{size:"sm",color:"white"}),c.jsx("span",{className:"font-medium",children:"Processing..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),c.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),c.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"multiple-choice"})]}),c.jsx("div",{className:"w-fit",children:c.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:c.jsxs("div",{className:"text-sm text-blue-800",children:[c.jsx("strong",{children:"Multiple Choice Format:"}),c.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[c.jsx("div",{children:"Column 1: Question"}),c.jsx("div",{children:"Column 2: Correct Answer (A-F)"}),c.jsx("div",{children:"Column 3: Option A text"}),c.jsx("div",{children:"Column 4: Option B text"}),c.jsx("div",{children:"Column 5: Option C text"}),c.jsx("div",{children:"Column 6: Option D text"})]})]})})})]}),g==="trueFalse"&&We.trueFalse?.buttonVisible&&c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"true-false",disabled:N,children:N?c.jsxs(c.Fragment,{children:[c.jsx(Ur,{size:"sm",color:"white"}),c.jsx("span",{className:"font-medium",children:"Processing..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),c.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),c.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"true-false"})]}),c.jsx("div",{className:"w-fit",children:c.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:c.jsxs("div",{className:"text-xs text-blue-800",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Format:"})," Question | Answer (true/false)"]}),c.jsxs("div",{className:"mt-1",children:[c.jsx("strong",{children:"Example:"})," The Earth is round | true"]}),c.jsxs("div",{className:"mt-1",children:[c.jsx("strong",{children:"Note:"})," Headers are optional"]})]})})})]}),g==="input"&&We.input?.buttonVisible&&c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"input",disabled:N,children:N?c.jsxs(c.Fragment,{children:[c.jsx(Ur,{size:"sm",color:"white"}),c.jsx("span",{className:"font-medium",children:"Processing..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),c.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),c.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"input"})]}),c.jsx("div",{className:"w-fit",children:c.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:c.jsxs("div",{className:"text-sm text-blue-800",children:[c.jsx("strong",{children:"Input Test Format:"}),c.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[c.jsx("div",{children:"Column 1: Question"}),c.jsx("div",{children:"Column 2: Answer 1"}),c.jsx("div",{children:"Column 3: Answer 2 (optional)"})]})]})})})]})]})]})}),g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&A.numQuestions>0&&c.jsx(At,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Manual Question Entry"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Fill in the questions manually using the form below."})]})}),A.numQuestions>0&&c.jsx(At,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Questions"}),c.jsx("div",{className:"space-y-6",children:Object.keys(A.questions).map(oe=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Question ",oe]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text"}),c.jsx("textarea",{value:A.questions[oe]?.question||"",onChange:fe=>zt(oe,"question",fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"2",placeholder:"Enter the question text"})]}),g==="multipleChoice"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Answer Options"}),c.jsx("div",{className:"space-y-2",children:A.questions[oe]?.options?.map((fe,Te)=>c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("span",{className:"w-6 text-sm font-medium text-gray-700",children:[String.fromCharCode(65+Te),":"]}),c.jsx("input",{type:"text",value:fe,onChange:Ee=>{const Xe=[...A.questions[oe].options];Xe[Te]=Ee.target.value,zt(oe,"options",Xe)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Option ${String.fromCharCode(65+Te)}`})]},Te))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer"}),g==="multipleChoice"?c.jsx("div",{children:c.jsxs("select",{value:A.questions[oe]?.correctAnswer||"",onChange:fe=>zt(oe,"correctAnswer",fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Select correct answer"}),A.questions[oe]?.options?.map((fe,Te)=>c.jsx("option",{value:String.fromCharCode(65+Te),children:String.fromCharCode(65+Te)},Te))]})}):g==="trueFalse"?c.jsxs("select",{value:A.questions[oe]?.correctAnswer||"",onChange:fe=>zt(oe,"correctAnswer",fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Select correct answer"}),c.jsx("option",{value:"true",children:"True"}),c.jsx("option",{value:"false",children:"False"})]}):c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer(s)"}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("input",{type:"text",value:A.questions[oe]?.correct_answers?.[0]||"",onChange:fe=>{const Ee=[...A.questions[oe]?.correct_answers||[""]];Ee[0]=fe.target.value,zt(oe,"correct_answers",Ee)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter the primary correct answer"}),A.questions[oe]?.correct_answers?.slice(1).map((fe,Te)=>c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("input",{type:"text",value:fe,onChange:Ee=>{const Xe=[...A.questions[oe]?.correct_answers||[]];Xe[Te+1]=Ee.target.value,zt(oe,"correct_answers",Xe)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Alternative answer ${Te+2}`}),c.jsx("button",{type:"button",onClick:()=>{const Ee=[...A.questions[oe]?.correct_answers||[]];Ee.splice(Te+1,1),zt(oe,"correct_answers",Ee)},className:"px-2 py-1 text-red-600 hover:text-red-800 text-sm",children:"Remove"})]},Te))||[],c.jsx("button",{type:"button",onClick:()=>{const Te=[...A.questions[oe]?.correct_answers||[""],""];zt(oe,"correct_answers",Te)},className:"px-3 py-1 text-blue-600 hover:text-blue-800 text-sm border border-blue-300 rounded-md hover:bg-blue-50",children:"+ Add Alternative Answer"})]}),c.jsx("p",{className:"text-xs text-gray-500",children:"You can add multiple correct answers for the same question. Students will get credit for any of them."})]})]})]})]},oe))})]})}),A.testName&&A.numQuestions>0&&c.jsx("div",{className:"flex justify-end",children:c.jsx(Je,{onClick:hr,disabled:k,className:"px-8",children:k?c.jsxs(c.Fragment,{children:[c.jsx(Ur,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test & Continue to Assignment"})})]}),l==="testAssignment"&&c.jsxs(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs(Je,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),c.jsx("span",{children:"Back to Main"})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Assign Test to Classes"}),c.jsx("p",{className:"text-gray-600",children:"Select which classes should take this test"})]})]}),c.jsx(Je,{variant:"outline",onClick:()=>u("formCreation"),children:" Back to Test Form"})]}),c.jsx(At,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Available Classes"}),x.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-6xl mb-4",children:""}),c.jsx("p",{className:"text-gray-500 text-lg",children:"No subjects available for assignment."}),c.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You need to assign subjects to grades and classes first."}),c.jsx("div",{className:"mt-4",children:c.jsx(Je,{onClick:()=>window.location.href="/teacher/subjects",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Go to Subjects Page"})})]}):c.jsx("div",{className:"space-y-6",children:x.map(oe=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:oe.subject}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2",children:oe.classes.map(fe=>c.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:R.some(Te=>Te.grade===fe.grade&&Te.class===fe.class&&Te.subject_id===oe.subject_id),onChange:Te=>ir(fe.grade,fe.class,Te.target.checked,oe.subject_id,oe.subject),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),c.jsxs("span",{className:"text-sm text-gray-700",children:[fe.grade,"/",fe.class]})]},`${fe.grade}-${fe.class}-${oe.subject_id}`))})]},oe.subject_id))})]})}),R.length>0&&c.jsx("div",{className:"flex justify-end",children:c.jsx(Je,{onClick:()=>Ne(g,null),disabled:w,className:"px-8",children:w?c.jsxs(c.Fragment,{children:[c.jsx(Ur,{size:"sm",color:"white",className:"mr-2"}),"Assigning Test..."]}):`Assign Test to ${R.length} Class${R.length>1?"es":""}`})})]})]})}),console.log(" Checking isAssigningTest:",P),P&&c.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Assigning test to classes..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your assignment"})]})}),k&&c.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Saving test..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we save your test"})]})}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:t.map(oe=>c.jsx(ac,{type:oe.type,message:oe.message,duration:oe.duration,onClose:()=>n(oe.id)},oe.id))})]})},w3e=({onDataLoaded:e,onError:t})=>{const r=vo(),{user:n,isAuthenticated:s}=Qn(),{teacherData:a,loadTeacherData:i}=r2(),[o,l]=S.useState(!0),[u,d]=S.useState(""),[h,g]=S.useState([]),[p,x]=S.useState(null),[v,w]=S.useState([]),[C,k]=S.useState([]),[_,N]=S.useState([]),[E,P]=S.useState(null),[F,A]=S.useState(0);S.useEffect(()=>{ae()},[]),S.useCallback(async ne=>{console.log(" Teacher login attempt...");try{const L=await ns.teacherLogin(ne);if(L.success)return Z("Login successful!","success"),await j(),L;throw new Error(L.error||"Login failed")}catch(L){throw console.error(" Teacher login error:",L),Z("Login failed. Please check your credentials.","error"),L}},[]);const j=S.useCallback(async()=>{console.log(" Loading teacher data...");try{if(l(!0),d(""),!s||!n){console.log(" User not authenticated"),d("User not authenticated");return}if(n.role!==Hi.TEACHER){console.error(" Invalid user role for teacher data:",n.role),d("Access denied. Teacher role required.");return}console.log(" Fetching teacher data from service...");const ne=await ns.getTeacherData();if(ne&&ne.success)console.log(" Teacher data loaded successfully:",ne),x(ne.teacher||n),ne.subjects&&(w(ne.subjects),console.log(" Teacher subjects loaded:",ne.subjects.length)),ne.grades&&k(ne.grades),ne.classes&&N(ne.classes),P(new Date),A(L=>L+1),e&&e(ne),Z("Teacher data loaded successfully!","success");else throw new Error(ne?.error||"Failed to load teacher data")}catch(ne){console.error(" Error loading teacher data:",ne);const L=ne.message||"Failed to load teacher data";d(L),t&&t(ne),Z(L,"error")}finally{l(!1)}},[s,n,e,t]),R=S.useCallback(()=>{console.log(" Returning to main cabinet..."),r("/teacher/cabinet")},[r]);S.useCallback(ne=>{console.log(" Showing main cabinet with subjects:",ne),ne&&w(ne),r("/teacher/cabinet")},[r]);const U=S.useCallback(()=>(console.log(" Rendering grade buttons..."),["M1","M2","M3","M4","M5","M6"].map(L=>({id:L,name:`Grade ${L}`,classes:Y(L)}))),[]),Y=S.useCallback(ne=>Array.from({length:10},(H,M)=>M+1).map(H=>({id:`${ne}-${H}`,name:`Class ${H}`,grade:ne,classNumber:H})),[]),Z=S.useCallback((ne,L)=>{const H={id:Date.now(),message:ne,type:L,timestamp:new Date};g(M=>[...M,H]),setTimeout(()=>{g(M=>M.filter(V=>V.id!==H.id))},C0.NOTIFICATION_DURATION)},[]),ae=S.useCallback(async()=>{console.log(" Initializing teacher data..."),await j()},[j]),ee=S.useCallback(async()=>{console.log(" Refreshing teacher data..."),await j()},[j]);return S.useCallback(async ne=>{console.log(" Updating teacher profile:",ne);try{const L=await ns.updateUserProfile(ne);if(L.success)return x(H=>({...H,...ne})),Z("Profile updated successfully!","success"),L;throw new Error(L.error||"Failed to update profile")}catch(L){throw console.error(" Error updating teacher profile:",L),Z("Failed to update profile","error"),L}},[]),S.useCallback(async ne=>{console.log(" Changing teacher password...");try{const L=await ns.changePassword(ne);if(L.success)return Z("Password changed successfully!","success"),L;throw new Error(L.error||"Failed to change password")}catch(L){throw console.error(" Error changing teacher password:",L),Z("Failed to change password","error"),L}},[]),o?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(Ur,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Data..."})]})}):u?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Data Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:u}),c.jsxs("div",{className:"flex space-x-3 justify-center",children:[c.jsx(Je,{variant:"primary",onClick:ee,children:"Retry"}),c.jsx(Je,{variant:"outline",onClick:R,children:"Go Back"})]})]})})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teacher Data"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",E?E.toLocaleString():"Never"," | Version: ",F]})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx(Je,{variant:"outline",onClick:ee,children:"Refresh Data"}),c.jsx(Je,{variant:"outline",onClick:R,children:"Back to Cabinet"})]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teacher Information"}),p?c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Name:"}),c.jsx("p",{className:"text-sm text-gray-900",children:p.name||"N/A"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Username:"}),c.jsx("p",{className:"text-sm text-gray-900",children:p.username||"N/A"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Email:"}),c.jsx("p",{className:"text-sm text-gray-900",children:p.email||"N/A"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Role:"}),c.jsx("p",{className:"text-sm text-gray-900",children:p.role||"N/A"})]})]}):c.jsx("p",{className:"text-gray-500",children:"No teacher information available"})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Subjects (",v.length,")"]}),v.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.map((ne,L)=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsx("h3",{className:"font-medium text-gray-900",children:ne.name}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:ne.description||"No description"}),ne.classes&&ne.classes.length>0&&c.jsxs("div",{className:"mt-2",children:[c.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Classes:"}),c.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:ne.classes.map((H,M)=>c.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:[H.grade," - ",H.className]},M))})]})]},L))}):c.jsx("p",{className:"text-gray-500",children:"No subjects assigned"})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Grade Levels"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:U().map(ne=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:ne.name}),c.jsx("div",{className:"grid grid-cols-5 gap-1",children:ne.classes.map(L=>c.jsx("button",{className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded transition-colors",onClick:()=>console.log("Class clicked:",L),children:L.classNumber},L.id))})]},ne.id))})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Statistics"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-blue-600",children:v.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Subjects"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-green-600",children:C.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Grades"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-yellow-600",children:_.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Classes"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-purple-600",children:F}),c.jsx("p",{className:"text-sm text-gray-500",children:"Data Version"})]})]})]})]})}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:h.map(ne=>c.jsx(ac,{type:ne.type,message:ne.message,onClose:()=>g(L=>L.filter(H=>H.id!==ne.id))},ne.id))})]})},b3e=({onBackToCabinet:e})=>{const t=vo(),{user:r,isAuthenticated:n}=Qn(),{teacherData:s}=r2(),[a,i]=S.useState(!0),[o,l]=S.useState(""),[u,d]=S.useState([]),[h,g]=S.useState([]),[p,x]=S.useState([]),[v,w]=S.useState([]),[C,k]=S.useState(null),[_,N]=S.useState([]),[E,P]=S.useState(!1),[F,A]=S.useState(!1),[j,R]=S.useState(!1),[U,Y]=S.useState(!1),[Z,ae]=S.useState(null),[ee,ne]=S.useState(!0),[L,H]=S.useState(null);S.useEffect(()=>{Ue()},[]),S.useCallback(rt=>{console.log(" Rendering existing subjects:",rt),g(rt)},[]);const M=S.useCallback(()=>{console.log(" Showing subject selection prompt..."),P(!0),ne(!1),V()},[]),V=S.useCallback(async()=>{console.log(" Loading existing subjects...");try{const rt=await ns.getTeacherSubjects();rt.success&&rt.subjects&&rt.subjects.length>0?(console.log(" Existing subjects found:",rt.subjects),W(rt.subjects)):(console.log(" No existing subjects found"),w([]))}catch(rt){console.error(" Error loading existing subjects:",rt),Ke("Failed to load existing subjects","error")}},[]),W=S.useCallback(rt=>{console.log(" Rendering subject selection:",rt);const wt=[];rt.forEach(xt=>{xt.classes&&Array.isArray(xt.classes)&&xt.classes.forEach(lt=>{wt.push({id:`${xt.subject_id}-${lt.grade}-${lt.class}`,subjectId:xt.subject_id,subjectName:xt.subject,grade:lt.grade,class:lt.class,displayText:`${xt.subject} - ${lt.grade}/${lt.class}`})})}),w(wt),console.log(" Processed subjects for selection:",wt)},[]),I=S.useCallback(async rt=>{if(console.log(" Saving teacher subjects:",rt),!rt||rt.length===0){Ke("Please select at least one subject and class combination.","warning");return}try{const wt=rt.reduce((lt,pt)=>{const Rt=lt.find(Mt=>Mt.subject_id===pt.subjectId);return Rt?Rt.classes.push({grade:pt.grade,class:pt.class}):lt.push({subject_id:pt.subjectId,classes:[{grade:pt.grade,class:pt.class}]}),lt},[]);console.log(" Transformed data for backend:",wt);const xt=await ns.saveTeacherSubjects(wt);if(xt.success)Ke("Subjects saved successfully!","success"),P(!1),ne(!0),H(new Date),await V();else throw new Error(xt.error||"Failed to save subjects")}catch(wt){console.error(" Error saving subjects:",wt),Ke("Error saving subjects. Please try again.","error")}},[]),B=S.useCallback(()=>{console.log(" Toggling subject dropdown..."),A(rt=>!rt),R(!1)},[]),q=S.useCallback(async()=>{console.log(" Loading subjects for dropdown...");try{const rt=await ns.getAllSubjects();if(rt.success)x(rt.subjects||[]),console.log(" Available subjects loaded:",rt.subjects?.length||0);else throw new Error(rt.error||"Failed to load subjects")}catch(rt){console.error(" Error loading subjects for dropdown:",rt),Ke("Failed to load subjects","error")}},[]),J=S.useCallback(rt=>{console.log(" Subject selected:",rt);const wt=p.find(xt=>xt.subject_id===parseInt(rt));wt&&(k(wt),R(!0),A(!1),se())},[p]),se=S.useCallback(()=>{console.log(" Loading grades and classes...")},[]),X=S.useCallback((rt,wt)=>{console.log(" Saving classes for subject:",rt,wt);const xt={id:`${rt.subject_id}-${Date.now()}`,subjectId:rt.subject_id,subjectName:rt.subject,grade:wt.grade,class:wt.class,displayText:`${rt.subject} - ${wt.grade}/${wt.class}`};w(lt=>[...lt,xt]),k(null),N([]),R(!1),le(`Added ${rt.subject} for ${wt.grade}/${wt.class}`)},[]),ie=S.useCallback(()=>{console.log(" Resetting subject selection..."),k(null),N([]),A(!1),R(!1)},[]),le=S.useCallback(rt=>{console.log(" Showing message:",rt),Ke(rt,"success")},[]),ce=S.useCallback(rt=>{console.log(" Showing confirmation modal:",rt),ae(rt),Y(!0)},[]),ke=S.useCallback(()=>{console.log(" Hiding confirmation modal..."),Y(!1),ae(null)},[]),re=S.useCallback(()=>{console.log(" Confirming save subjects..."),ke(),I(v)},[v,I,ke]),ge=S.useCallback(()=>{console.log(" Cancelling save subjects..."),ke()},[ke]),Ne=S.useCallback(rt=>{console.log(" Removing subject:",rt),w(wt=>wt.filter(xt=>xt.id!==rt)),Ke("Subject removed","info")},[]);S.useCallback(()=>{console.log(" Showing edit subjects button..."),ne(!0)},[]),S.useCallback(()=>{console.log(" Hiding edit subjects button..."),ne(!1)},[]);const je=S.useCallback(rt=>{console.log(" Generating class buttons for grade:",rt);let wt;return rt===1||rt===2?wt=["15","16"]:rt===3?wt=["15","16"]:rt===4?wt=["13","14"]:rt===5||rt===6?wt=["13","14"]:wt=[],wt.map(xt=>({id:`${rt}-${xt}`,grade:rt,class:xt,displayText:`${rt}/${xt}`}))},[]);S.useCallback((rt,wt)=>{console.log(" Showing class results:",rt,wt),t("/teacher/results")},[t]);const Ke=S.useCallback((rt,wt)=>{const xt={id:Date.now(),message:rt,type:wt,timestamp:new Date};d(lt=>[...lt,xt]),setTimeout(()=>{d(lt=>lt.filter(pt=>pt.id!==xt.id))},C0.NOTIFICATION_DURATION)},[]),Ue=S.useCallback(async()=>{console.log(" Initializing teacher subjects...");try{if(i(!0),l(""),!n||!r){console.log(" User not authenticated"),l("User not authenticated");return}if(r.role!==Hi.TEACHER){console.error(" Invalid user role for teacher subjects:",r.role),l("Access denied. Teacher role required.");return}await V(),await q(),console.log(" Teacher subjects initialization complete!")}catch(rt){console.error(" Error initializing teacher subjects:",rt),l("Failed to initialize teacher subjects")}finally{i(!1)}},[n,r,V,q]),It=S.useCallback(()=>{e?e():t("/teacher/cabinet")},[e,t]);return a?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(Ur,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Subjects..."})]})}):o?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Subjects Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:o}),c.jsx(Je,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Subject Management"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",L?L.toLocaleString():"Never"]})]}),c.jsxs("div",{className:"flex space-x-3",children:[ee&&c.jsx(Je,{variant:"primary",onClick:M,children:"Edit Subjects"}),c.jsx(Je,{variant:"outline",onClick:It,children:"Back to Cabinet"})]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"space-y-6",children:[!E&&c.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Your Assigned Subjects"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your teaching subjects and class assignments"})]}),c.jsx("div",{className:"flex space-x-3",children:c.jsxs(Je,{variant:"primary",onClick:M,className:"px-6 py-2",children:[c.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Subjects"]})})]}),h.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map((rt,wt)=>c.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:rt.subject}),rt.classes&&rt.classes.length>0&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Assigned Classes:"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:rt.classes.map((xt,lt)=>c.jsxs("span",{className:"px-3 py-1 bg-blue-500 text-white text-sm font-medium rounded-full",children:["Grade ",xt.grade," - Class ",xt.class]},lt))})]})]}),c.jsx("div",{className:"ml-4",children:c.jsx(Je,{variant:"outline",size:"sm",onClick:()=>Ne(rt.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]})},wt))}):c.jsxs("div",{className:"text-center py-12",children:[c.jsx("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:c.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned yet"}),c.jsx("p",{className:"text-gray-500 mb-6",children:"Get started by adding your teaching subjects and class assignments"}),c.jsxs(Je,{variant:"primary",onClick:M,className:"px-6 py-3",children:[c.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Your First Subject"]})]})]}),E&&c.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Select Subjects and Classes"}),c.jsx("p",{className:"text-gray-600",children:"Choose the subjects you want to teach and assign them to specific classes"})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:c.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:"1"})}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-lg font-semibold text-gray-900",children:"Select Subject"}),c.jsx("p",{className:"text-gray-600",children:"Choose the subject you want to teach"})]})]}),c.jsxs("div",{className:"relative",children:[c.jsxs(Je,{variant:"outline",onClick:B,className:"w-full justify-between p-4 h-auto text-left border-2 border-gray-200 hover:border-blue-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white rounded-xl shadow-sm",children:[c.jsx("span",{className:"text-gray-900 font-medium",children:C?C.subject:"Select a subject"}),c.jsx("svg",{className:"w-5 h-5 ml-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),F&&c.jsx("div",{className:"absolute z-10 w-full mt-2 bg-white border-2 border-gray-200 rounded-xl shadow-xl max-h-60 overflow-y-auto",children:p.map(rt=>c.jsx("button",{onClick:()=>J(rt.subject_id),className:"w-full px-4 py-4 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 border-b border-gray-100 last:border-b-0",children:c.jsx("span",{className:"text-gray-900 font-medium",children:rt.subject})},rt.subject_id))})]})]}),j&&C&&c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center mb-6",children:[c.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3",children:c.jsx("span",{className:"text-green-600 font-semibold text-sm",children:"2"})}),c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Select Classes for ",C.subject]}),c.jsx("p",{className:"text-gray-600",children:"Choose which classes you want to teach this subject to"})]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(rt=>c.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-2",children:c.jsx("span",{className:"text-white font-bold text-xs",children:rt})}),c.jsxs("h4",{className:"font-semibold text-gray-900",children:["Grade ",rt]})]}),c.jsx("div",{className:"space-y-3",children:je(rt).map(wt=>c.jsx(Je,{variant:"outline",size:"sm",onClick:()=>X(C,wt),className:"w-full text-sm py-2 px-4 border-green-300 hover:border-green-400 hover:bg-green-100 focus:ring-2 focus:ring-green-500 rounded-lg font-medium",children:wt.displayText},wt.id))})]},rt))})]}),v.length>0&&c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-3",children:c.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:"3"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Selected Subjects"}),c.jsx("p",{className:"text-gray-600",children:"Review your subject and class selections"})]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:v.map(rt=>c.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-4 hover:shadow-md transition-shadow duration-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex-1",children:c.jsx("span",{className:"text-sm font-semibold text-purple-900",children:rt.displayText})}),c.jsx(Je,{variant:"outline",size:"sm",onClick:()=>Ne(rt.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300 focus:ring-2 focus:ring-red-500 rounded-lg",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},rt.id))})]}),c.jsxs("div",{className:"flex justify-between items-center pt-6 border-t-2 border-gray-100",children:[c.jsx("div",{className:"text-sm text-gray-500",children:v.length>0?`${v.length} subject${v.length>1?"s":""} selected`:"No subjects selected"}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsxs(Je,{variant:"outline",onClick:()=>{P(!1),ne(!0),ie()},className:"px-6 py-3 text-sm font-medium text-gray-700 bg-white border-2 border-gray-300 hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 rounded-xl",children:[c.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Cancel"]}),c.jsxs(Je,{variant:"primary",onClick:()=>ce({type:"save",data:v}),disabled:v.length===0,className:"px-8 py-3 text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-indigo-600 border border-transparent rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:[c.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),j?"Next: Select Classes":"Save Subjects"]})]})]})]})]})]})}),U&&c.jsx(da,{isOpen:U,onClose:ke,title:"Confirm Save",variant:"confirmation",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to save ",Z?.data?.length||0," subject assignments?"]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx(Je,{variant:"outline",onClick:ge,children:"Cancel"}),c.jsx(Je,{variant:"primary",onClick:re,children:"Save"})]})]})}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:u.map(rt=>c.jsx(ac,{type:rt.type,message:rt.message,onClose:()=>d(wt=>wt.filter(xt=>xt.id!==rt.id))},rt.id))})]})},_3e=()=>{const{user:e,role:t,isAuthenticated:r,isLoading:n}=Qn(),[s,a]=S.useState("cabinet");return!r||t!=="teacher"?c.jsx(gm,{to:"/login",replace:!0}):n?c.jsxs("div",{className:"teacher-app-loading",children:[c.jsx(Ur,{}),c.jsx("p",{children:"Loading teacher interface..."})]}):c.jsx("div",{className:"teacher-app",children:c.jsxs(hN,{children:[c.jsx(ks,{path:"/",element:c.jsx(hM,{})}),c.jsx(ks,{path:"/cabinet",element:c.jsx(hM,{})}),c.jsx(ks,{path:"/tests",element:c.jsx(gM,{})}),c.jsx(ks,{path:"/tests/create",element:c.jsx(gM,{})}),c.jsx(ks,{path:"/data",element:c.jsx(w3e,{})}),c.jsx(ks,{path:"/subjects",element:c.jsx(b3e,{})}),c.jsx(ks,{path:"/results",element:c.jsx(ez,{})}),c.jsx(ks,{path:"*",element:c.jsx(gm,{to:"/teacher",replace:!0})})]})})},De={container:"min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100",mainContainer:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",header:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg",headerContent:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",headerFlex:"flex justify-between items-center",adminInfo:"flex items-center space-x-4",adminAvatar:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",adminText:"text-lg sm:text-xl md:text-2xl font-bold text-white",adminSubtext:"text-purple-100 text-sm sm:text-base md:text-lg",menuContainer:"relative admin-menu",menuButton:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",menuDropdown:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",menuItem:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-purple-50 transition-colors",menuItemLogout:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",cardContainer:"bg-white rounded-xl shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-300",cardHeader:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-indigo-50",cardTitle:"text-xl font-bold text-gray-800",cardBody:"p-6",buttonGroup:"flex flex-wrap gap-3 mb-6",buttonPrimary:"bg-purple-600 hover:bg-purple-700 text-white font-medium px-4 py-2 rounded-lg transition-colors duration-200",buttonSecondary:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium px-4 py-2 rounded-lg transition-colors duration-200",formContainer:"bg-gray-50 rounded-lg p-6 border border-gray-200",formGrid:"grid grid-cols-1 md:grid-cols-2 gap-4",formGroup:"space-y-2",formLabel:"block text-sm font-medium text-gray-700",formInput:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors duration-200",formCheckbox:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded",formActions:"flex space-x-3 pt-4",table:"min-w-full divide-y divide-gray-200",tableHeader:"bg-gray-50",tableHeaderCell:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",tableBody:"bg-white divide-y divide-gray-200",tableRow:"hover:bg-gray-50 transition-colors duration-150",tableCell:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",statusActive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",statusInactive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",modalOverlay:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",modalContent:"bg-white rounded-lg p-6 w-full max-w-md mx-4 shadow-xl",modalTitle:"text-xl font-semibold text-gray-900 mb-4",modalActions:"flex space-x-3 pt-4"},S3e=()=>{const{user:e,isAdmin:t,logout:r}=Qn(),{get:n,post:s,delete:a}=Wo(),i=S.useCallback(async()=>{try{g({type:"info",message:"Checking for overdue assignments..."});const he=await s("/.netlify/functions/check-overdue-assignments",{});if(he&&he.success){const vt=he.overdue_count||0;vt>0?g({type:"success",message:`Found and marked ${vt} overdue assignments as inactive.`}):g({type:"info",message:"No overdue assignments found."})}else g({type:"error",message:he?.error||"Failed to check assignments"})}catch(he){g({type:"error",message:"Failed to check assignments"}),console.error("Check overdue assignments error:",he)}},[s]),[o,l]=S.useState(!1),[u,d]=S.useState(null),[h,g]=S.useState(null),[p,x]=S.useState(!1),[v,w]=S.useState(!1),[C,k]=S.useState(!1),[_,N]=S.useState(!1),[E,P]=S.useState(""),[F,A]=S.useState(null),[j,R]=S.useState({}),[U,Y]=S.useState(null),[Z,ae]=S.useState({}),[ee,ne]=S.useState(null),[L,H]=S.useState({}),[M,V]=S.useState([]),[W,I]=S.useState(""),[B,q]=S.useState(""),[J,se]=S.useState(""),[X,ie]=S.useState(!0),[le,ce]=S.useState(!1),[ke,re]=S.useState([]),[ge,Ne]=S.useState(""),[je,Ke]=S.useState(""),[Ue,It]=S.useState(""),[rt,wt]=S.useState(!1),[xt,lt]=S.useState(!1),[pt,Rt]=S.useState([]),[Mt,Qe]=S.useState([]),[Re,Be]=S.useState([]),[ct,We]=S.useState([]),[nt,Tt]=S.useState(!1),[jt,Vt]=S.useState(!1),[fr,Dr]=S.useState(!1),[zr,or]=S.useState(!1),[nr,me]=S.useState({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),[Ae,Fe]=S.useState({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),[Me,kt]=S.useState({subject_id:"",subject:"",description:"",is_active:!0}),[Oe,at]=S.useState({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""});S.useEffect(()=>{console.log(" AdminCabinet component mounted - initializing..."),Ce()},[]),S.useEffect(()=>{const he=vt=>{rt&&!vt.target.closest(".admin-menu")&&wt(!1)};return document.addEventListener("mousedown",he),()=>{document.removeEventListener("mousedown",he)}},[rt]);const Ce=S.useCallback(async()=>{try{l(!0),await zt(),console.log("Admin app initialized")}catch(he){d("Failed to initialize admin app"),console.error("Admin app initialization error:",he)}finally{l(!1)}},[]),Ve=S.useCallback(()=>{wt(he=>!he)},[]),Ze=S.useCallback(()=>{lt(!0),wt(!1)},[]),Ft=S.useCallback(()=>{lt(!1)},[]),zt=S.useCallback(async()=>{try{await Promise.all([er(),hr(),ir(),Wr()])}catch(he){console.error("Error loading admin data:",he),d("Failed to load admin data")}},[]),er=S.useCallback(async()=>{try{const he="admin_users_",vt=Es(he);if(vt){console.log(" Using cached users data"),Rt(vt);return}const xr=await n("/.netlify/functions/get-all-users");console.log(" Users response:",xr);const br=xr.users||[];Rt(br),us(he,br,Ts.admin_users),console.log(" Users set to state:",br)}catch(he){console.error("Error loading users:",he)}},[n]),hr=S.useCallback(async()=>{try{const he="admin_teachers_",vt=Es(he);if(vt){console.log(" Using cached teachers data"),Qe(vt);return}const xr=await n("/.netlify/functions/get-all-teachers");console.log(" Teachers response:",xr);const br=xr.teachers||[];Qe(br),us(he,br,Ts.admin_teachers),console.log(" Teachers set to state:",br)}catch(he){console.error("Error loading teachers:",he)}},[n]),ir=S.useCallback(async()=>{try{const he="admin_subjects_",vt=Es(he);if(vt){console.log(" Using cached subjects data"),Be(vt);return}const xr=await n("/.netlify/functions/get-all-subjects");console.log(" Subjects response:",xr);const br=xr.subjects||[];Be(br),us(he,br,Ts.admin_subjects),console.log(" Subjects set to state:",br)}catch(he){console.error("Error loading subjects:",he)}},[n]),Wr=S.useCallback(async()=>{try{const he="admin_academic_years_",vt=Es(he);if(vt){console.log(" Using cached academic years data"),We(vt);return}const br=(await n("/.netlify/functions/get-academic-year")).academic_years||[];We(br),us(he,br,Ts.admin_academic_years)}catch(he){console.error("Error loading academic year:",he)}},[n]),ue=S.useCallback(async()=>{try{if(N(!_),!_){const[he,vt]=await Promise.all([n("/.netlify/functions/get-all-tests"),n("/.netlify/functions/get-test-assignments")]);console.log(" Active tests response:",he),console.log(" Assignments response:",vt);const xr=he.tests||[],Bn=(vt.assignments||[]).reduce((et,we)=>{const $e=`${we.test_type}-${we.test_id}`;return et[$e]||(et[$e]=[]),et[$e].push(we),et},{}),An=xr.map(et=>{const we=`${et.test_type}-${et.test_id}`,$e=Bn[we]||[],Le=$e.some(Et=>Et.is_active);return{...et,is_active:Le,assignments:$e}});V(An),console.log(" All tests with status set to state:",An)}}catch(he){console.error("Error loading tests:",he),g({type:"error",message:"Failed to load tests"})}},[n,_]),be=S.useCallback((he,vt)=>{me(xr=>({...xr,[he]:vt}))},[]),ye=S.useCallback((he,vt)=>{Fe(xr=>({...xr,[he]:vt}))},[]),xe=S.useCallback((he,vt)=>{kt(xr=>({...xr,[he]:vt}))},[]);S.useCallback(()=>{console.log(" Testing local storage...");try{const he={test:"data",timestamp:Date.now()};localStorage.setItem("test",JSON.stringify(he));const vt=JSON.parse(localStorage.getItem("test"));console.log(" Local storage test successful:",vt),g({type:"success",message:"Local storage test successful"})}catch(he){console.error(" Local storage test failed:",he),g({type:"error",message:"Local storage test failed"})}},[]),S.useCallback(()=>{console.log(" Clearing local storage...");try{localStorage.clear(),console.log(" Local storage cleared"),g({type:"success",message:"Local storage cleared"})}catch(he){console.error(" Error clearing local storage:",he),g({type:"error",message:"Error clearing local storage"})}},[]),S.useCallback(async()=>{console.log(" Checking teacher subjects...");try{const vt=(await n("/.netlify/functions/get-all-teachers")).data||[];console.log(" Teachers data:",vt),g({type:"success",message:`Found ${vt.length} teachers`})}catch(he){console.error(" Error checking teacher subjects:",he),g({type:"error",message:"Error checking teacher subjects"})}},[n]);const _e=S.useCallback(async he=>{he.preventDefault();try{console.log(" Submitting user:",nr);const vt=await s("/.netlify/functions/add-user",nr);vt.success?(g({type:"success",message:"User added successfully"}),Tt(!1),me({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),er()):g({type:"error",message:vt.message||"Failed to add user"})}catch(vt){console.error(" Error adding user:",vt),g({type:"error",message:"Error adding user"})}},[nr,s,er]),Se=S.useCallback(async he=>{he.preventDefault();try{console.log(" Submitting teacher:",Ae);const vt=await s("/.netlify/functions/add-teacher",Ae);vt.success?(g({type:"success",message:"Teacher added successfully"}),Vt(!1),Fe({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),hr()):g({type:"error",message:vt.message||"Failed to add teacher"})}catch(vt){console.error(" Error adding teacher:",vt),g({type:"error",message:"Error adding teacher"})}},[Ae,s,hr]),He=S.useCallback(async he=>{he.preventDefault();try{console.log(" Submitting subject:",Me);const vt=await s("/.netlify/functions/add-subject",Me);vt.success?(g({type:"success",message:"Subject added successfully"}),Dr(!1),kt({subject_id:"",subject:"",description:"",is_active:!0}),ir()):g({type:"error",message:vt.message||"Failed to add subject"})}catch(vt){console.error(" Error adding subject:",vt),g({type:"error",message:"Error adding subject"})}},[Me,s,ir]),it=S.useCallback(he=>{A(he),R({name:he.name||"",surname:he.surname||"",grade:he.grade||"",class:he.class||"",student_id:he.student_id||"",nickname:he.nickname||"",password:he.password||"",is_active:he.is_active!==void 0?he.is_active:!0})},[]),Ye=S.useCallback(async()=>{try{const he=[];Object.keys(j).forEach(vt=>{vt!=="student_id"&&j[vt]!==F[vt]&&he.push({fieldName:vt,newValue:j[vt]})});for(const vt of he)await s("/.netlify/functions/update-user",{userId:F.student_id,fieldName:vt.fieldName,newValue:vt.newValue});g({type:"success",message:"User updated successfully!"}),A(null),R({}),er()}catch{g({type:"error",message:"Failed to update user"})}},[j,F,s,er]),oe=S.useCallback(async he=>{if(window.confirm("Are you sure you want to delete this user?"))try{(await s("/.netlify/functions/delete-user",{userId:he})).success&&(g({type:"success",message:"User deleted successfully!"}),er())}catch{g({type:"error",message:"Failed to delete user"})}},[s,er]),fe=S.useCallback(he=>{Y(he),ae({teacher_id:he.teacher_id||"",username:he.username||"",password:he.password||"",first_name:he.first_name||"",last_name:he.last_name||"",is_active:he.is_active!==void 0?he.is_active:!0})},[]),Te=S.useCallback(async()=>{try{const he=[];Object.keys(Z).forEach(vt=>{vt!=="teacher_id"&&Z[vt]!==U[vt]&&he.push({fieldName:vt,newValue:Z[vt]})});for(const vt of he)await s("/.netlify/functions/update-teacher",{teacherId:U.teacher_id,fieldName:vt.fieldName,newValue:vt.newValue});g({type:"success",message:"Teacher updated successfully!"}),Y(null),ae({}),hr()}catch{g({type:"error",message:"Failed to update teacher"})}},[Z,U,s,hr]),Ee=S.useCallback(async he=>{if(window.confirm("Are you sure you want to delete this teacher?"))try{(await s("/.netlify/functions/delete-teacher",{teacherId:he})).success&&(g({type:"success",message:"Teacher deleted successfully!"}),hr())}catch{g({type:"error",message:"Failed to delete teacher"})}},[s,hr]),Xe=S.useCallback(he=>{ne(he),H({subject_id:he.subject_id||"",subject:he.subject||""})},[]),ut=S.useCallback(async()=>{try{const he=[];Object.keys(L).forEach(vt=>{vt!=="subject_id"&&L[vt]!==ee[vt]&&he.push({fieldName:vt,newValue:L[vt]})});for(const vt of he)await s("/.netlify/functions/update-subject",{subjectId:ee.subject_id,fieldName:vt.fieldName,newValue:vt.newValue});g({type:"success",message:"Subject updated successfully!"}),ne(null),H({}),ir()}catch{g({type:"error",message:"Failed to update subject"})}},[L,ee,s,ir]),ft=S.useCallback(async he=>{if(window.confirm("Are you sure you want to delete this subject?"))try{const vt=await s("/.netlify/functions/delete-subject",{subjectId:he});vt.success?(g({type:"success",message:"Subject deleted successfully!"}),ir()):g({type:"error",message:vt.message||"Failed to delete subject"})}catch{g({type:"error",message:"Failed to delete subject"})}},[s,ir]),Kt=S.useCallback((he,vt)=>{at(xr=>({...xr,[he]:vt}))},[]),Ct=S.useCallback(async he=>{if(he.preventDefault(),!Oe.startDate||!Oe.endDate||!Oe.teacherId){g({type:"error",message:"Please fill in all required fields (Start Date, End Date, Teacher ID)"});return}if(window.confirm("Are you sure you want to delete all test data for the selected criteria? This action cannot be undone."))try{const vt=await s("/.netlify/functions/delete-test-data",Oe);vt.success?(g({type:"success",message:`Successfully deleted ${vt.deletedCount} test records!`}),or(!1),at({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""})):g({type:"error",message:vt.message||"Failed to delete test data"})}catch{g({type:"error",message:"Failed to delete test data"})}},[Oe,s]),Ht=S.useCallback(async(he,vt,xr)=>{try{const br=await n("/.netlify/functions/get-test-assignments");if(br.success&&br.assignments){const Bn=br.assignments.filter(An=>An.test_id===parseInt(he)&&An.test_type===vt);if(Bn.length===0){g({type:"error",message:"No assignments found for this test"});return}for(const An of Bn){const et=await s("/.netlify/functions/remove-assignment",{teacher_id:xr,assignment_id:An.assignment_id,test_type:vt,test_id:he});if(!et.success){g({type:"error",message:`Failed to complete test: ${et.message}`});return}}g({type:"success",message:"Test marked as complete successfully!"}),await ue()}else g({type:"error",message:"Failed to get test assignments"})}catch(br){console.error("Error completing test:",br),g({type:"error",message:"Failed to complete test"})}},[s,n,ue]),yr=S.useCallback(async(he,vt,xr)=>{try{const br=await n("/.netlify/functions/get-test-assignments");if(br.success&&br.assignments){const Bn=br.assignments.filter(An=>An.test_id===parseInt(he)&&An.test_type===vt);if(Bn.length===0){g({type:"error",message:"No assignments found for this test"});return}for(const An of Bn){const et=await s("/.netlify/functions/remove-assignment",{teacher_id:xr,assignment_id:An.assignment_id,test_type:vt,test_id:he,mark_active:!0});if(!et.success){g({type:"error",message:`Failed to reactivate test: ${et.message}`});return}}g({type:"success",message:"Test marked as active successfully!"}),await ue()}else g({type:"error",message:"Failed to get test assignments"})}catch(br){console.error("Error reactivating test:",br),g({type:"error",message:"Failed to reactivate test"})}},[s,n,ue]),wr=S.useCallback(async()=>{try{if(ce(!le),!le){const he=await n("/.netlify/functions/get-all-tests");console.log(" Actual tests response:",he),re(he.tests||[]),console.log(" Actual tests set to state:",he.tests||[])}}catch(he){console.error("Error loading actual tests:",he),g({type:"error",message:"Failed to load tests"})}},[n,le]),vr=S.useCallback(async(he,vt,xr)=>{try{const br=await s("/.netlify/functions/delete-test",{test_id:he,test_type:vt,teacher_id:xr});br.success?(g({type:"success",message:"Test deleted successfully!"}),await wr()):g({type:"error",message:`Failed to delete test: ${br.message}`})}catch(br){console.error("Error deleting test:",br),g({type:"error",message:"Failed to delete test"})}},[s,wr]),Er=E?pt.filter(he=>he.grade.toString()===E):pt,qr=M.filter(he=>{const vt=!W||he.teacher_id===W,xr=!B||new Date(he.created_at)>=new Date(B),br=!J||new Date(he.created_at)<=new Date(J+"T23:59:59"),Bn=X?he.is_active:!he.is_active;return vt&&xr&&br&&Bn}),Hr=ke.filter(he=>{const vt=!ge||he.teacher_id===ge,xr=!je||new Date(he.created_at)>=new Date(je),br=!Ue||new Date(he.created_at)<=new Date(Ue+"T23:59:59");return vt&&xr&&br});return c.jsxs(st.div,{id:"admin-cabinet-main",className:De.container,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsx(st.div,{className:De.header,initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:c.jsx("div",{className:De.headerContent,children:c.jsxs("div",{className:De.headerFlex,children:[c.jsxs(st.div,{className:De.adminInfo,initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(st.div,{className:De.adminAvatar,initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:c.jsx("span",{className:"text-white font-semibold text-xl",children:e?.username?.charAt(0)||"A"})})}),c.jsxs("div",{children:[c.jsx("h1",{className:De.adminText,children:e?.username||"Administrator"}),c.jsx("p",{className:De.adminSubtext,children:"Administrator Dashboard"})]})]}),c.jsxs(st.div,{className:De.menuContainer,initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsxs("button",{onClick:Ve,className:De.menuButton,style:{zIndex:1e3},children:[c.jsx("span",{className:"hidden sm:inline",children:"Menu"}),c.jsx(st.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:rt?180:0},transition:{duration:.2},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),c.jsx(fo,{children:rt&&c.jsx(st.div,{className:De.menuDropdown,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:c.jsxs("div",{className:"py-2",children:[c.jsx(st.button,{onClick:Ze,className:De.menuItem,whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),c.jsx(st.button,{onClick:()=>{Ve(),r()},className:De.menuItemLogout,whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),o&&c.jsx(Ur,{text:"Loading..."}),u&&c.jsx(ac,{type:"error",message:u,onClose:()=>d(null)}),h&&c.jsx(ac,{type:h.type,message:h.message,onClose:()=>g(null)}),xt&&c.jsx("div",{className:De.modalOverlay,children:c.jsxs("div",{className:De.modalContent,children:[c.jsx("h2",{className:De.modalTitle,children:"Change Password"}),c.jsxs("form",{className:"space-y-4",children:[c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{htmlFor:"currentPassword",className:De.formLabel,children:"Current Password"}),c.jsx("input",{type:"password",id:"currentPassword",className:De.formInput})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{htmlFor:"newPassword",className:De.formLabel,children:"New Password"}),c.jsx("input",{type:"password",id:"newPassword",className:De.formInput})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{htmlFor:"confirmPassword",className:De.formLabel,children:"Confirm New Password"}),c.jsx("input",{type:"password",id:"confirmPassword",className:De.formInput})]}),c.jsxs("div",{className:De.modalActions,children:[c.jsx(Je,{type:"button",variant:"secondary",onClick:Ft,className:"flex-1",children:"Cancel"}),c.jsx(Je,{type:"submit",variant:"primary",className:"flex-1 bg-purple-600 hover:bg-purple-700",children:"Change Password"})]})]})]})}),c.jsx(st.div,{className:De.mainContainer,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:c.jsxs("div",{className:"space-y-6",children:[c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},children:c.jsxs(At,{className:De.cardContainer,children:[c.jsx(At.Header,{className:De.cardHeader,children:c.jsx(At.Title,{className:De.cardTitle,children:"User Management"})}),c.jsxs(At.Body,{className:De.cardBody,children:[c.jsxs("div",{className:De.buttonGroup,children:[c.jsx(Je,{variant:"primary",onClick:()=>Tt(!0),className:De.buttonPrimary,children:"Add User"}),c.jsx(Je,{variant:"secondary",onClick:()=>{er(),x(!p)},className:De.buttonSecondary,children:p?"Hide Users Table":"Get All Users "})]}),c.jsx(fo,{children:nt&&c.jsxs(st.div,{className:De.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New User"}),c.jsxs("form",{onSubmit:_e,className:"space-y-4",children:[c.jsxs("div",{className:De.formGrid,children:[c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Grade"}),c.jsx("input",{type:"text",value:nr.grade,onChange:he=>be("grade",he.target.value),className:De.formInput,placeholder:"Enter grade"})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Class"}),c.jsx("input",{type:"text",value:nr.class,onChange:he=>be("class",he.target.value),className:De.formInput,placeholder:"Enter class"})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Number"}),c.jsx("input",{type:"text",value:nr.number,onChange:he=>be("number",he.target.value),className:De.formInput,placeholder:"Enter number"})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Student ID"}),c.jsx("input",{type:"text",value:nr.student_id,onChange:he=>be("student_id",he.target.value),className:De.formInput,placeholder:"Enter student ID"})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Name"}),c.jsx("input",{type:"text",value:nr.name,onChange:he=>be("name",he.target.value),className:De.formInput,placeholder:"Enter name"})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Surname"}),c.jsx("input",{type:"text",value:nr.surname,onChange:he=>be("surname",he.target.value),className:De.formInput,placeholder:"Enter surname"})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Nickname"}),c.jsx("input",{type:"text",value:nr.nickname,onChange:he=>be("nickname",he.target.value),className:De.formInput,placeholder:"Enter nickname"})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Password"}),c.jsx("input",{type:"password",value:nr.password,onChange:he=>be("password",he.target.value),className:De.formInput,placeholder:"Enter password"})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"userActive",checked:nr.is_active,onChange:he=>be("is_active",he.target.checked),className:De.formCheckbox}),c.jsx("label",{htmlFor:"userActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),c.jsxs("div",{className:De.formActions,children:[c.jsx(Je,{type:"button",variant:"secondary",onClick:()=>Tt(!1),className:De.buttonSecondary,children:"Cancel"}),c.jsx(Je,{type:"submit",variant:"primary",className:De.buttonPrimary,children:"Add User"})]})]})]})}),p&&c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Users (",Er.length," of ",pt.length,")"]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Filter by Grade:"}),c.jsxs("select",{value:E,onChange:he=>P(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"All Grades"}),[...new Set(pt.map(he=>he.grade))].sort().map(he=>c.jsxs("option",{value:he,children:["Grade ",he]},he))]})]})]}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-[600px]",children:c.jsxs("table",{className:De.table,children:[c.jsx("thead",{className:De.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:De.tableHeaderCell,children:"Name"}),c.jsx("th",{className:De.tableHeaderCell,children:"Grade"}),c.jsx("th",{className:De.tableHeaderCell,children:"Class"}),c.jsx("th",{className:De.tableHeaderCell,children:"Student ID"}),c.jsx("th",{className:De.tableHeaderCell,children:"Number"}),c.jsx("th",{className:De.tableHeaderCell,children:"Nickname"}),c.jsx("th",{className:De.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:De.tableBody,children:Er.map((he,vt)=>c.jsxs("tr",{className:De.tableRow,children:[c.jsxs("td",{className:De.tableCell,children:[he.name," ",he.surname]}),c.jsx("td",{className:De.tableCell,children:he.grade}),c.jsx("td",{className:De.tableCell,children:he.class}),c.jsx("td",{className:De.tableCell,children:he.student_id}),c.jsx("td",{className:De.tableCell,children:he.number}),c.jsx("td",{className:De.tableCell,children:he.nickname}),c.jsx("td",{className:De.tableCell,children:c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:()=>it(he),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),c.jsx("button",{onClick:()=>oe(he.student_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},he.id||vt))})]})})})]})]})]})}),c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:c.jsxs(At,{className:De.cardContainer,children:[c.jsxs(At.Header,{className:De.cardHeader,children:[c.jsx(At.Title,{className:De.cardTitle,children:"Teacher Management"}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx("button",{onClick:i,className:"px-3 py-1.5 bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors text-xs whitespace-nowrap",title:"Check and mark overdue assignments (7+ days old) as inactive",children:"Check Overdue Assignments"}),c.jsx(Je,{variant:"primary",onClick:()=>Vt(!0),className:"text-xs whitespace-nowrap",children:"Add Teacher"}),c.jsx(Je,{variant:"secondary",onClick:()=>{hr(),w(!v)},className:"text-xs whitespace-nowrap",children:v?"Hide Teachers Table":"Get All Teachers "})]})]}),c.jsxs(At.Body,{className:De.cardBody,children:[c.jsx(fo,{children:jt&&c.jsxs(st.div,{className:De.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Teacher"}),c.jsxs("form",{onSubmit:Se,className:"space-y-4",children:[c.jsxs("div",{className:De.formGrid,children:[c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Teacher ID"}),c.jsx("input",{type:"text",value:Ae.teacher_id,onChange:he=>ye("teacher_id",he.target.value),className:De.formInput,placeholder:"Enter teacher ID"})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Username"}),c.jsx("input",{type:"text",value:Ae.username,onChange:he=>ye("username",he.target.value),className:De.formInput,placeholder:"Enter username"})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Password"}),c.jsx("input",{type:"password",value:Ae.password,onChange:he=>ye("password",he.target.value),className:De.formInput,placeholder:"Enter password"})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"First Name"}),c.jsx("input",{type:"text",value:Ae.first_name,onChange:he=>ye("first_name",he.target.value),className:De.formInput,placeholder:"Enter first name"})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Last Name"}),c.jsx("input",{type:"text",value:Ae.last_name,onChange:he=>ye("last_name",he.target.value),className:De.formInput,placeholder:"Enter last name"})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"teacherActive",checked:Ae.is_active,onChange:he=>ye("is_active",he.target.checked),className:De.formCheckbox}),c.jsx("label",{htmlFor:"teacherActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),c.jsxs("div",{className:De.formActions,children:[c.jsx(Je,{type:"button",variant:"secondary",onClick:()=>Vt(!1),className:De.buttonSecondary,children:"Cancel"}),c.jsx(Je,{type:"submit",variant:"primary",className:De.buttonPrimary,children:"Add Teacher"})]})]})]})}),F&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit User"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),c.jsx("input",{type:"text",value:j.name,onChange:he=>R({...j,name:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Surname"}),c.jsx("input",{type:"text",value:j.surname,onChange:he=>R({...j,surname:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grade"}),c.jsx("input",{type:"number",value:j.grade,onChange:he=>R({...j,grade:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),c.jsx("input",{type:"number",value:j.class,onChange:he=>R({...j,class:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),c.jsx("input",{type:"text",value:j.student_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Student ID cannot be changed"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nickname"}),c.jsx("input",{type:"text",value:j.nickname,onChange:he=>R({...j,nickname:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),c.jsx("input",{type:"text",value:j.password,onChange:he=>R({...j,password:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"is_active",checked:j.is_active,onChange:he=>R({...j,is_active:he.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),c.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{onClick:()=>{A(null),R({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),c.jsx("button",{onClick:Ye,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update User"})]})]})}),v&&c.jsxs("div",{className:"mt-6",children:[c.jsx("div",{className:"mb-4",children:c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Teachers (",Mt.length,")"]})}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:De.table,children:[c.jsx("thead",{className:De.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:De.tableHeaderCell,children:"Teacher ID"}),c.jsx("th",{className:De.tableHeaderCell,children:"Name"}),c.jsx("th",{className:De.tableHeaderCell,children:"Username"}),c.jsx("th",{className:De.tableHeaderCell,children:"Password"}),c.jsx("th",{className:De.tableHeaderCell,children:"Status"}),c.jsx("th",{className:De.tableHeaderCell,children:"Created"}),c.jsx("th",{className:De.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:De.tableBody,children:Mt.map((he,vt)=>c.jsxs("tr",{className:De.tableRow,children:[c.jsx("td",{className:De.tableCell,children:he.teacher_id}),c.jsxs("td",{className:De.tableCell,children:[he.first_name," ",he.last_name]}),c.jsx("td",{className:De.tableCell,children:he.username}),c.jsx("td",{className:De.tableCell,children:he.password}),c.jsx("td",{className:De.tableCell,children:c.jsx("span",{className:he.is_active?De.statusActive:De.statusInactive,children:he.is_active?"Active":"Inactive"})}),c.jsx("td",{className:De.tableCell,children:new Date(he.created_at).toLocaleDateString()}),c.jsx("td",{className:De.tableCell,children:c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:()=>fe(he),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),c.jsx("button",{onClick:()=>Ee(he.teacher_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},he.teacher_id||vt))})]})})})]})]})]})}),c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7,duration:.5},children:c.jsxs(At,{className:De.cardContainer,children:[c.jsx(At.Header,{className:De.cardHeader,children:c.jsx(At.Title,{className:De.cardTitle,children:"Subject Management"})}),c.jsxs(At.Body,{className:De.cardBody,children:[c.jsxs("div",{className:De.buttonGroup,children:[c.jsx(Je,{variant:"primary",onClick:()=>Dr(!0),className:De.buttonPrimary,children:"Add Subject"}),c.jsx(Je,{variant:"secondary",onClick:()=>{ir(),k(!C)},className:De.buttonSecondary,children:C?"Hide Subjects Table":"Get All Subjects "})]}),c.jsx(fo,{children:fr&&c.jsxs(st.div,{className:De.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Subject"}),c.jsxs("form",{onSubmit:He,className:"space-y-4",children:[c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Subject Name"}),c.jsx("input",{type:"text",value:Me.subject,onChange:he=>xe("subject",he.target.value),className:De.formInput,placeholder:"Enter subject name",required:!0}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Subject ID will be automatically generated"})]}),c.jsxs("div",{className:De.formActions,children:[c.jsx(Je,{type:"button",variant:"secondary",onClick:()=>Dr(!1),className:De.buttonSecondary,children:"Cancel"}),c.jsx(Je,{type:"submit",variant:"primary",className:De.buttonPrimary,children:"Add Subject"})]})]})]})}),U&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Teacher"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teacher ID"}),c.jsx("input",{type:"text",value:Z.teacher_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Teacher ID cannot be changed"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),c.jsx("input",{type:"text",value:Z.username,onChange:he=>ae({...Z,username:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),c.jsx("input",{type:"text",value:Z.password,onChange:he=>ae({...Z,password:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),c.jsx("input",{type:"text",value:Z.first_name,onChange:he=>ae({...Z,first_name:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),c.jsx("input",{type:"text",value:Z.last_name,onChange:he=>ae({...Z,last_name:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"teacher_is_active",checked:Z.is_active,onChange:he=>ae({...Z,is_active:he.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),c.jsx("label",{htmlFor:"teacher_is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{onClick:()=>{Y(null),ae({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),c.jsx("button",{onClick:Te,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update Teacher"})]})]})}),ee&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Subject"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject ID"}),c.jsx("input",{type:"text",value:L.subject_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Subject ID cannot be changed"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),c.jsx("input",{type:"text",value:L.subject,onChange:he=>H({...L,subject:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{onClick:()=>ne(null),className:"px-4 py-2 text-gray-600 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),c.jsx("button",{onClick:ut,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:"Update Subject"})]})]})}),C&&c.jsxs("div",{className:"mt-6",children:[c.jsx("div",{className:"mb-4",children:c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Subjects (",Re.length,")"]})}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:De.table,children:[c.jsx("thead",{className:De.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:De.tableHeaderCell,children:"Subject ID"}),c.jsx("th",{className:De.tableHeaderCell,children:"Subject Name"}),c.jsx("th",{className:De.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:De.tableBody,children:Re.map((he,vt)=>c.jsxs("tr",{className:De.tableRow,children:[c.jsx("td",{className:De.tableCell,children:he.subject_id}),c.jsx("td",{className:De.tableCell,children:he.subject}),c.jsx("td",{className:De.tableCell,children:c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:()=>Xe(he),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),c.jsx("button",{onClick:()=>ft(he.subject_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},he.subject_id||vt))})]})})})]})]})]})}),c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:c.jsxs(At,{className:De.cardContainer,children:[c.jsx(At.Header,{className:De.cardHeader,children:c.jsx(At.Title,{className:De.cardTitle,children:"Test Data Deletion"})}),c.jsxs(At.Body,{className:De.cardBody,children:[c.jsx("div",{className:De.buttonGroup,children:c.jsx(Je,{variant:"danger",onClick:()=>or(!0),className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})}),c.jsx(fo,{children:zr&&c.jsxs(st.div,{className:De.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Delete Test Data by Date Range"}),c.jsxs("form",{onSubmit:Ct,className:"space-y-4",children:[c.jsxs("div",{className:De.formGrid,children:[c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Start Date *"}),c.jsx("input",{type:"date",value:Oe.startDate,onChange:he=>Kt("startDate",he.target.value),className:De.formInput,required:!0})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"End Date *"}),c.jsx("input",{type:"date",value:Oe.endDate,onChange:he=>Kt("endDate",he.target.value),className:De.formInput,required:!0})]})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Teacher ID *"}),c.jsxs("select",{value:Oe.teacherId,onChange:he=>Kt("teacherId",he.target.value),className:De.formInput,required:!0,children:[c.jsx("option",{value:"",children:"Select a teacher"}),Mt.map(he=>c.jsxs("option",{value:he.teacher_id,children:[he.teacher_id," - ",he.first_name," ",he.last_name]},he.teacher_id))]})]}),c.jsxs("div",{className:De.formGroup,children:[c.jsx("label",{className:De.formLabel,children:"Subject (Optional)"}),c.jsxs("select",{value:Oe.subjectId,onChange:he=>Kt("subjectId",he.target.value),className:De.formInput,children:[c.jsx("option",{value:"",children:"All subjects"}),Re.map(he=>c.jsx("option",{value:he.subject_id,children:he.subject},he.subject_id))]})]}),c.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Warning: This action cannot be undone"}),c.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[c.jsx("p",{children:"This will permanently delete:"}),c.jsxs("ul",{className:"list-disc list-inside mt-1",children:[c.jsx("li",{children:"All test records within the date range"}),c.jsx("li",{children:"All test questions and answers"}),c.jsx("li",{children:"All test results and submissions"}),c.jsx("li",{children:"All test assignments"}),c.jsx("li",{children:"Associated Cloudinary images (for matching tests)"})]})]})]})]})}),c.jsxs("div",{className:De.formActions,children:[c.jsx(Je,{type:"button",variant:"secondary",onClick:()=>or(!1),className:De.buttonSecondary,children:"Cancel"}),c.jsx(Je,{type:"submit",variant:"danger",className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})]})]})]})})]})]})}),c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.85,duration:.5},children:c.jsxs(At,{className:De.cardContainer,children:[c.jsx(At.Header,{className:De.cardHeader,children:c.jsx(At.Title,{className:De.cardTitle,children:"Assignments Management"})}),c.jsxs(At.Body,{className:De.cardBody,children:[c.jsx("div",{className:"mb-4",children:c.jsx(Je,{variant:"primary",onClick:ue,className:De.buttonPrimary,children:_?"Hide Assignments Table":"Get All Assignments "})}),_&&c.jsx("div",{className:"mb-6",children:c.jsx("div",{className:"border-b border-gray-200",children:c.jsxs("nav",{className:"-mb-px flex space-x-8",children:[c.jsx("button",{onClick:()=>ie(!0),className:`py-2 px-1 border-b-2 font-medium text-sm ${X?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Active Assignments"}),c.jsx("button",{onClick:()=>ie(!1),className:`py-2 px-1 border-b-2 font-medium text-sm ${X?"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300":"border-purple-500 text-purple-600"}`,children:"Inactive Assignments"})]})})}),_&&c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:[X?"Active":"Inactive"," Assignments (",qr.length," of ",M.filter(he=>X?he.is_active:!he.is_active).length,")"]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("select",{value:W,onChange:he=>I(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"All Teachers"}),Mt.map(he=>c.jsxs("option",{value:he.teacher_id,children:[he.first_name," ",he.last_name]},he.teacher_id))]}),c.jsx("input",{type:"date",value:B,onChange:he=>q(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),c.jsx("input",{type:"date",value:J,onChange:he=>se(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:De.table,children:[c.jsx("thead",{className:De.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:De.tableHeaderCell,children:"Test Name"}),c.jsx("th",{className:De.tableHeaderCell,children:"Type"}),c.jsx("th",{className:De.tableHeaderCell,children:"Teacher"}),c.jsx("th",{className:De.tableHeaderCell,children:"Questions"}),c.jsx("th",{className:De.tableHeaderCell,children:"Created"}),c.jsx("th",{className:De.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:De.tableBody,children:qr.map((he,vt)=>c.jsxs("tr",{className:De.tableRow,children:[c.jsx("td",{className:De.tableCell,children:he.test_name}),c.jsx("td",{className:De.tableCell,children:c.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:he.test_type.replace("_"," ").toUpperCase()})}),c.jsx("td",{className:De.tableCell,children:he.teacher_name}),c.jsx("td",{className:De.tableCell,children:he.num_questions}),c.jsx("td",{className:De.tableCell,children:new Date(he.created_at).toLocaleDateString()}),c.jsx("td",{className:De.tableCell,children:c.jsx("div",{className:"flex space-x-2",children:X?c.jsx("button",{onClick:()=>Ht(he.test_id,he.test_type,he.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-orange-100 text-orange-700 hover:bg-orange-200",children:"Mark Complete"}):c.jsx("button",{onClick:()=>yr(he.test_id,he.test_type,he.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",children:"Mark Active"})})})]},`${he.test_type}-${he.test_id}-${vt}`))})]})})})]})]})]})}),c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:c.jsxs(At,{className:De.cardContainer,children:[c.jsx(At.Header,{className:De.cardHeader,children:c.jsx(At.Title,{className:De.cardTitle,children:"Test Management"})}),c.jsxs(At.Body,{className:De.cardBody,children:[c.jsx("div",{className:"mb-4",children:c.jsx(Je,{variant:"primary",onClick:wr,className:De.buttonPrimary,children:le?"Hide Tests Table":"Get All Tests "})}),le&&c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Tests (",Hr.length," of ",ke.length,")"]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("select",{value:ge,onChange:he=>Ne(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"All Teachers"}),Mt.map(he=>c.jsxs("option",{value:he.teacher_id,children:[he.first_name," ",he.last_name]},he.teacher_id))]}),c.jsx("input",{type:"date",value:je,onChange:he=>Ke(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),c.jsx("input",{type:"date",value:Ue,onChange:he=>It(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:De.table,children:[c.jsx("thead",{className:De.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:De.tableHeaderCell,children:"Test Name"}),c.jsx("th",{className:De.tableHeaderCell,children:"Type"}),c.jsx("th",{className:De.tableHeaderCell,children:"Teacher"}),c.jsx("th",{className:De.tableHeaderCell,children:"Questions"}),c.jsx("th",{className:De.tableHeaderCell,children:"Created"}),c.jsx("th",{className:De.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:De.tableBody,children:Hr.map((he,vt)=>c.jsxs("tr",{className:De.tableRow,children:[c.jsx("td",{className:De.tableCell,children:he.test_name}),c.jsx("td",{className:De.tableCell,children:c.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:he.test_type.replace("_"," ").toUpperCase()})}),c.jsx("td",{className:De.tableCell,children:he.teacher_name}),c.jsx("td",{className:De.tableCell,children:he.num_questions}),c.jsx("td",{className:De.tableCell,children:new Date(he.created_at).toLocaleDateString()}),c.jsx("td",{className:De.tableCell,children:c.jsx("div",{className:"flex space-x-2",children:c.jsx("button",{onClick:()=>vr(he.test_id,he.test_type,he.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200",children:"Delete Test"})})})]},`${he.test_type}-${he.test_id}-${vt}`))})]})})})]})]})]})}),c.jsx(st.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:c.jsxs(At,{className:De.cardContainer,children:[c.jsx(At.Header,{className:De.cardHeader,children:c.jsx(At.Title,{className:De.cardTitle,children:"Debug & Testing"})}),c.jsx(At.Body,{className:De.cardBody})]})})]})})]})},k3e=()=>{const{isAdmin:e,getCurrentAdminId:t,logout:r}=Qn(),{get:n}=Wo(),{showNotification:s}=Da();S.useEffect(()=>{a()},[]);const a=S.useCallback(async()=>{if(console.log(" Initializing Admin Application..."),!e()){console.error(" User is not an admin, redirecting to login"),s("Access Denied: You are not an administrator.","error"),r();return}try{i(),await o(),l(),u(),console.log(" Admin Application initialized successfully"),s("Admin dashboard loaded successfully","success")}catch(d){console.error(" Error initializing admin app:",d),s("Failed to initialize admin dashboard","error")}},[e,t,r,s,n]),i=S.useCallback(()=>{console.log(" Initializing global event listeners...");const d=h=>{h.ctrlKey&&h.key==="k"&&(h.preventDefault(),console.log("Admin search shortcut triggered"))};return document.addEventListener("keydown",d),()=>{document.removeEventListener("keydown",d)}},[]),o=S.useCallback(async()=>{try{console.log(" Loading admin data...");const[d,h,g,p]=await Promise.allSettled([n("/.netlify/functions/get-all-users"),n("/.netlify/functions/get-all-teachers"),n("/.netlify/functions/get-all-subjects"),n("/.netlify/functions/get-academic-year")]);d.status==="fulfilled"&&d.value?.success&&console.log(" Users loaded:",d.value.users?.length||0),h.status==="fulfilled"&&h.value?.success&&console.log(" Teachers loaded:",h.value.teachers?.length||0),g.status==="fulfilled"&&g.value?.success&&console.log(" Subjects loaded:",g.value.subjects?.length||0),p.status==="fulfilled"&&p.value?.success&&console.log(" Academic years loaded:",p.value.academic_years?.length||0),console.log(" Admin data loading completed")}catch(d){throw console.error(" Error loading admin data:",d),d}},[n]),l=S.useCallback(()=>{console.log(" Initializing test deletion functionality..."),console.log(" Test deletion functionality initialized")},[]),u=S.useCallback(()=>{console.log(" Exposing admin functions globally..."),window.toggleSubjectsContent=()=>{const h=document.getElementById("allSubjectsContainer"),g=document.querySelector('button[onclick="toggleSubjectsContent()"]');if(!h){console.error(" allSubjectsContainer not found");return}if(!g){console.error(" Button not found");return}const p=h.style.display!=="none";h.style.display=p?"none":"block",g.textContent=p?"Show Subjects":"Hide Subjects"},window.showAddSubjectForm=()=>{const h=document.getElementById("addSubjectForm");h&&(h.style.display="block")},window.hideAddSubjectForm=()=>{const h=document.getElementById("addSubjectForm"),g=document.getElementById("newSubjectForm");h&&(h.style.display="none"),g&&g.reset()},window.showAddAcademicYearForm=()=>{const h=document.getElementById("addAcademicYearForm");h&&(h.style.display="block")},window.hideAddAcademicYearForm=()=>{const h=document.getElementById("addAcademicYearForm"),g=document.getElementById("newAcademicYearForm");h&&(h.style.display="none"),g&&g.reset()},window.toggleUsersContent=()=>{const h=document.getElementById("allUsersContainer"),g=document.querySelector('button[onclick="toggleUsersContent()"]');if(!h){console.error(" allUsersContainer not found");return}if(!g){console.error(" Button not found");return}const p=h.style.display!=="none";h.style.display=p?"none":"block",g.textContent=p?"Show Users":"Hide Users"},window.showAddUserForm=()=>{const h=document.getElementById("addUserForm");h&&(h.style.display="block")},window.hideAddUserForm=()=>{const h=document.getElementById("addUserForm"),g=document.getElementById("newUserForm");h&&(h.style.display="none"),g&&g.reset()},window.showAddTeacherForm=()=>{const h=document.getElementById("addTeacherForm");h&&(h.style.display="block")},window.hideAddTeacherForm=()=>{const h=document.getElementById("addTeacherForm"),g=document.getElementById("newTeacherForm");h&&(h.style.display="none"),g&&g.reset()},window.toggleTeachersContent=()=>{const h=document.getElementById("allTeachersContainer"),g=document.querySelector('button[onclick="toggleTeachersContent()"]');if(!h){console.error(" allTeachersContainer not found");return}if(!g){console.error(" Button not found");return}const p=h.style.display!=="none";h.style.display=p?"none":"block",g.textContent=p?"Show Teachers":"Hide Teachers"},window.toggleTestsContent=()=>{const h=document.getElementById("allTestsContainer"),g=document.querySelector('button[onclick="toggleTestsContent()"]');if(!h){console.error(" allTestsContainer not found");return}if(!g){console.error(" Button not found");return}const p=h.style.display!=="none";h.style.display=p?"none":"block",g.textContent=p?"Show Tests":"Hide Tests"},window.toggleAssignmentsContent=()=>{const h=document.getElementById("allAssignmentsContainer"),g=document.querySelector('button[onclick="toggleAssignmentsContent()"]');if(!h){console.error(" allAssignmentsContainer not found");return}if(!g){console.error(" Button not found");return}const p=h.style.display!=="none";h.style.display=p?"none":"block",g.textContent=p?"Show Assignments":"Hide Assignments"},window.toggleResultsContent=()=>{const h=document.getElementById("allResultsContainer"),g=document.querySelector('button[onclick="toggleResultsContent()"]');if(!h){console.error(" allResultsContainer not found");return}if(!g){console.error(" Button not found");return}const p=h.style.display!=="none";h.style.display=p?"none":"block",g.textContent=p?"Show Results":"Hide Results"};const d={};window.toggleSection=h=>{console.log(` toggleSection called with sectionId: ${h}`);const g=Date.now();if(d[h]&&g-d[h]<300){console.log(` Ignoring rapid successive call for ${h}`);return}d[h]=g;const p=document.getElementById(h);if(!p){console.error(` Section with id '${h}' not found!`);return}const x=p.style.display!=="none";p.style.display=x?"none":"block";const v=document.querySelector(`button[onclick="toggleSection('${h}')"]`);v&&(v.textContent=x?"Show":"Hide")},window.addClickListeners=()=>{console.log(" Adding click listeners to section headers...");const h=document.querySelectorAll(".section-header");console.log(` Found ${h.length} section headers`),h.forEach((g,p)=>{const x=g.textContent.trim();if(console.log(` Processing header ${p+1}:`,x),g.dataset.listenerAdded==="true"){console.log(` Skipping header ${x} - listener already added`);return}g.addEventListener("click",()=>{const v=g.dataset.sectionId;v&&window.toggleSection(v)}),g.dataset.listenerAdded="true",console.log(` Added click listener to header: ${x}`)})},window.makeFieldEditable=h=>{const g=h.textContent;h.dataset.field;const p=document.createElement("input");p.type="text",p.value=g,p.className="editable-input";const x=document.createElement("button");x.textContent="Save",x.className="btn-save",x.onclick=()=>window.saveField(h,p,x,v);const v=document.createElement("button");v.textContent="Cancel",v.className="btn-cancel",v.onclick=()=>{h.textContent=g,h.style.display="block",p.remove(),x.remove(),v.remove()},h.style.display="none",h.parentNode.insertBefore(p,h),h.parentNode.insertBefore(x,h),h.parentNode.insertBefore(v,h)},window.saveField=(h,g,p,x)=>{const v=g.value.trim(),w=h.dataset.field,C=h.dataset.recordId;if(!v){alert("Field cannot be empty");return}console.log(`Saving field ${w} for record ${C} with value: ${v}`),h.textContent=v,h.style.display="block",g.remove(),p.remove(),x.remove()},window.showTestDataDeletion=()=>console.log("showTestDataDeletion called"),window.hideTestDataDeletionForm=()=>console.log("hideTestDataDeletionForm called"),window.loadTeacherGradesClasses=()=>console.log("loadTeacherGradesClasses called"),window.checkTeacherSubjects=()=>console.log("checkTeacherSubjects called"),window.initializeTestDeletion=()=>console.log("initializeTestDeletion called"),window.handleAssignmentDeletion=()=>console.log("handleAssignmentDeletion called"),window.handleTestDataDeletion=()=>console.log("handleTestDataDeletion called"),window.getSelectedGradesClasses=()=>console.log("getSelectedGradesClasses called"),window.hideAssignmentDeletionForm=()=>console.log("hideAssignmentDeletionForm called"),window.addKeyboardAccessibility=()=>console.log("addKeyboardAccessibility called"),window.testToggleSection=()=>console.log("testToggleSection called"),window.testAllToggles=()=>console.log("testAllToggles called"),window.manualToggleTest=()=>console.log("manualToggleTest called"),window.addEditableFieldListeners=()=>console.log("addEditableFieldListeners called"),window.deleteTest=()=>console.log("deleteTest called"),window.testLocalStorage=()=>{console.log("Testing localStorage...");try{localStorage.setItem("test","value");const h=localStorage.getItem("test");return localStorage.removeItem("test"),console.log(" localStorage is working"),!0}catch(h){return console.error(" localStorage error:",h),!1}},window.clearAllLocalStorage=()=>{console.log("Clearing all localStorage..."),localStorage.clear(),console.log(" localStorage cleared")},window.exportLocalStorage=()=>{console.log("Exporting localStorage...");const h={};for(let v=0;v<localStorage.length;v++){const w=localStorage.key(v);h[w]=localStorage.getItem(w)}const g=new Blob([JSON.stringify(h,null,2)],{type:"application/json"}),p=URL.createObjectURL(g),x=document.createElement("a");x.href=p,x.download="localStorage-backup.json",x.click(),URL.revokeObjectURL(p)},console.log(" Admin functions exposed globally")},[]);return e()?c.jsx(S3e,{}):c.jsxs("div",{className:"admin-error",children:[c.jsx("h2",{children:"Access Denied"}),c.jsx("p",{children:"You don't have permission to access the admin dashboard."}),c.jsx("button",{onClick:r,children:"Return to Login"})]})},sT=({children:e,allowedRoles:t})=>{const{isAuthenticated:r,role:n,isLoading:s}=Qn();return s?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):r?t&&!t.includes(n)?c.jsx(gm,{to:"/unauthorized",replace:!0}):e:c.jsx(gm,{to:"/login",replace:!0})},C3e=()=>c.jsxs("div",{className:"unauthorized-page",children:[c.jsx("h1",{children:"Access Denied"}),c.jsx("p",{children:"You don't have permission to access this page."})]}),T3e=()=>c.jsx(OM,{children:c.jsx(PB,{children:c.jsx(AB,{children:c.jsx(VK,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:c.jsx("div",{className:"app",children:c.jsxs(hN,{children:[c.jsx(ks,{path:"/login",element:c.jsx(iae,{})}),c.jsx(ks,{path:"/unauthorized",element:c.jsx(C3e,{})}),c.jsx(ks,{path:"/student/*",element:c.jsx(sT,{allowedRoles:["student"],children:c.jsx(hie,{})})}),c.jsx(ks,{path:"/teacher/*",element:c.jsx(sT,{allowedRoles:["teacher"],children:c.jsx(_3e,{})})}),c.jsx(ks,{path:"/admin/*",element:c.jsx(sT,{allowedRoles:["admin"],children:c.jsx(k3e,{})})}),c.jsx(ks,{path:"/",element:c.jsx(gm,{to:"/login",replace:!0})}),c.jsx(ks,{path:"*",element:c.jsx(gm,{to:"/login",replace:!0})})]})})})})})});class E3e{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data",this.startIntegrityMonitoring()}startIntegrityMonitoring(){setInterval(()=>{this.performIntegrityCheck()},3e4)}performIntegrityCheck(){const t=localStorage.getItem(this.tokenKey);t&&!this.validateTokenFormat(t)&&(console.warn("Integrity check failed - corrupted token detected"),this.restoreFromBackup()||(console.warn("No valid backup available - clearing authentication"),this.clearAuth()))}getToken(){const t=localStorage.getItem(this.tokenKey);return t&&!this.validateTokenFormat(t)?(console.warn("Corrupted token detected in storage - clearing it"),this.clearAuth(),null):t}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}setToken(t){if(!this.validateTokenFormat(t))return console.error("Invalid token format - refusing to store corrupted token"),!1;try{this.decodeToken(t);const r=localStorage.getItem(this.tokenKey);return r&&localStorage.setItem(`${this.tokenKey}_backup`,r),localStorage.setItem(this.tokenKey,t),console.log("Token stored successfully with backup"),!0}catch(r){return console.error("Failed to store token - token is corrupted:",r),!1}}restoreFromBackup(){const t=localStorage.getItem(`${this.tokenKey}_backup`);return t&&this.validateTokenFormat(t)?(console.log("Restoring token from backup"),localStorage.setItem(this.tokenKey,t),!0):!1}validateTokenFormat(t){if(!t||typeof t!="string")return console.warn("Token validation failed: not a string"),!1;if(!t.includes("."))return console.warn("Token validation failed: not a JWT format"),!1;const r=t.split(".");if(r.length!==3)return console.warn("Token validation failed: not 3 parts"),!1;for(let n=0;n<r.length;n++)try{atob(r[n].replace(/-/g,"+").replace(/_/g,"/"))}catch{return console.warn(`Token validation failed: part ${n} is not valid base64`),!1}return!0}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){return this.setToken(t)?(this.setUserData({role:r}),localStorage.setItem("accessToken",t),!0):(console.error("Failed to set token - token validation failed"),!1)}isAuthenticated(){const t=this.getToken();if(!t)return!1;try{if(typeof t!="string"||!t.includes("."))return console.warn("Invalid token format - not a JWT"),this.clearAuth(),!1;const r=t.split(".");if(r.length!==3)return console.warn("Invalid token format - not 3 parts"),this.clearAuth(),!1;const n=JSON.parse(atob(r[1])),s=Date.now()/1e3;return n.exp>s}catch(r){return console.error("Error decoding token:",r),console.warn("Token appears to be corrupted - clearing authentication"),this.clearAuth(),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){try{localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey),localStorage.removeItem(`${this.tokenKey}_backup`)}catch(t){console.error("Failed to clear localStorage - possible corruption:",t),this.forceClearAllAuthData()}}forceClearAllAuthData(){["auth_token","accessToken","userRole","userData","refresh_token","auth_token_backup"].forEach(r=>{try{localStorage.removeItem(r)}catch(n){console.warn(`Failed to remove ${r}:`,n)}})}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const t=this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(t,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json();return this.setToken(n.token),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(t){try{if(typeof t!="string"||!t.includes("."))return console.warn("Invalid token format - not a JWT"),this.clearAuth(),null;const r=t.split(".");return r.length!==3?(console.warn("Invalid token format - not 3 parts"),this.clearAuth(),null):JSON.parse(atob(r[1]))}catch(r){return console.error("Error decoding token:",r),console.warn("Token appears to be corrupted - clearing authentication"),this.clearAuth(),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}}const uN=new E3e;window.tokenManager=uN;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{uN.init()}):uN.init());class SV{constructor(){this.currentRole=null,this.loadedFunctions=new Set,this.blockedFunctions=new Set,this.initialized=!1,this.retryCount=0,this.maxRetries=20}initialize(){if(this.initialized){console.log("[DEBUG] Role-based loader already initialized, skipping...");return}if(this.retryCount>=this.maxRetries){console.warn("[DEBUG] Max retries reached, stopping role-based loader initialization");return}if(this.retryCount++,(this.retryCount%5===1||this.retryCount===this.maxRetries)&&console.log(`[DEBUG] Role-based loader initializing... (attempt ${this.retryCount}/${this.maxRetries})`),console.log("[DEBUG] Token manager available:",!!window.tokenManager),window.tokenManager&&window.tokenManager.isAuthenticated()){const t=window.tokenManager.getUserRole();console.log("[DEBUG] Role from token manager:",t),console.log("[DEBUG] Access token exists:",!!window.tokenManager.getAccessToken()),t?(this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess()):(console.log("[DEBUG] No role found, waiting for role to be set..."),setTimeout(()=>this.initialize(),500))}else console.log("[DEBUG] Token manager not available or not authenticated, waiting..."),setTimeout(()=>this.initialize(),500)}setupRoleBasedAccess(){this.currentRole||(console.warn("No role detected, defaulting to student access"),this.currentRole="student");let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check:",r),t=!1}console.log(`Role-based loader initialized for: ${this.currentRole}${t?" (admin)":""}`),this.loadRoleSpecificFunctions(),this.setupRoleBasedUI(),this.replaceBlockedFunctions()}loadRoleSpecificFunctions(){this.currentRole==="teacher"?this.loadTeacherFunctions():this.currentRole==="student"&&this.loadStudentFunctions()}loadTeacherFunctions(){console.log("Teacher functions already available in main script")}loadStudentFunctions(){console.log("Student functions already available in main script")}loadFunction(t,r){console.log(`Function ${t} already available in main script for ${r}`),this.loadedFunctions.add(t)}setupRoleBasedUI(){let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check in UI:",r),t=!1}this.currentRole==="student"&&this.hideTeacherElements(),this.currentRole==="teacher"&&!t&&this.hideStudentElements()}hideTeacherElements(){[".teacher-cabinet",".test-creation-panel",".grade-management-panel",".class-management-panel",'[data-role="teacher"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}hideStudentElements(){[".student-cabinet",".test-taking-panel",".results-viewing-panel",'[data-role="student"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}replaceBlockedFunctions(){this.currentRole==="student"?this.blockTeacherFunctions():this.currentRole==="teacher"&&this.blockStudentFunctions()}blockTeacherFunctions(){Object.entries({createTest:()=>this.showAccessDenied("teacher"),assignTest:()=>this.showAccessDenied("teacher"),gradeTest:()=>this.showAccessDenied("teacher"),manageClasses:()=>this.showAccessDenied("teacher"),viewAllResults:()=>this.showAccessDenied("teacher")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}blockStudentFunctions(){Object.entries({takeTest:()=>this.showAccessDenied("student"),submitTest:()=>this.showAccessDenied("student"),viewMyResults:()=>this.showAccessDenied("student")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}showAccessDenied(t){const r=`Access denied. This function requires ${t} role.`;console.warn(r),typeof showNotification=="function"?showNotification(r,"warning"):alert(r)}isFunctionBlocked(t){return this.blockedFunctions.has(t)}isFunctionLoaded(t){return this.loadedFunctions.has(t)}getCurrentRole(){return this.currentRole}hasRole(t){return this.currentRole===t}reloadRoleAccess(){this.initialize()}setupAccessAfterLogin(){if(console.log("[DEBUG] Setting up role-based access after login..."),console.log("[DEBUG] Role-based loader will now initialize (no more retry loop before login)"),!window.tokenManager)return console.error("[ERROR] Token manager not available during setupAccessAfterLogin"),!1;if(!window.tokenManager.isAuthenticated())return console.error("[ERROR] User not authenticated during setupAccessAfterLogin"),!1;const t=window.tokenManager.getUserRole();return t?(console.log("[DEBUG] Setting role after login:",t),this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess(),console.log("[DEBUG] Role-based access setup completed successfully for role:",t),!0):(console.error("[ERROR] No role found in token during setupAccessAfterLogin"),!1)}}window.roleBasedLoader=new SV;typeof lb<"u"&&lb.exports&&(lb.exports=SV);const N3e=()=>{const e={schemaVersion:"2.0",enhancedFeatures:!0,newUserStructure:!0,newTestStructure:!0};localStorage.setItem("app_init_data",JSON.stringify(e))},A3e=()=>{N3e(),eK.createRoot(document.getElementById("root")).render(c.jsx(Ss.StrictMode,{children:c.jsx(T3e,{})}))};A3e()});export default j3e();
